{
    "hands_on_practices": [
        {
            "introduction": "在热耦合流固耦合（FSI）问题中，一个核心概念是温度、结构变形和流体/传热之间的反馈循环。第一个实践  提供了一个清晰、简化的稳态场景下的反馈示例。在此问题中，固体的热膨胀改变了传热路径，这反过来又影响了温度分布，形成一个非线性耦合。解决这个问题需要处理一个非线性方程，这是耦合物理问题中的一个典型挑战。",
            "id": "3954922",
            "problem": "考虑一个一维、稳态、热耦合的流固耦合（FSI）基准问题，该问题捕捉了固体板的热膨胀对通过相邻静止流体层的热传递的影响。一块厚度为 $L_s$、导热系数为 $k_s$ 的平坦固体板将温度为 $T_{hot}$ 的均匀热源与一个初始厚度为 $L_{f0}$、导热系数为 $k_f$ 的静止流体层隔开，该流体层暴露于环境温度 $T_{\\infty}$。结构板发生线性热膨胀，其一部分膨胀伸入流体间隙，从而减小了其有效厚度。具体来说，界面温度为 $T_i$，结构界面向流体中的位移建模为 $w = \\zeta \\alpha_s L_s (T_i - T_{ref})$，其中 $\\alpha_s$ 是固体的线性热膨胀系数，$\\zeta \\in [0,1]$ 是一个无量纲的几何因子，表示厚度膨胀中使界面移动到流体中的部分，而 $T_{ref}$ 是一个参考温度。有效流体间隙厚度为 $L_f^{eff} = L_{f0} - w$，为了物理可行性，该值必须保持为正。通过板的热传递是传导，通过静止流体层的热传递也假定为纯传导。当通过固体的传导热通量等于通过流体的传导热通量时，系统达到稳态。\n\n从傅里叶热传导定律和界面处的能量守恒出发，推导关于界面温度 $T_i$ 的非线性标量方程，该方程强制固体和流体之间的通量连续性，然后对其进行数值求解。使用以下基本依据：\n- 傅里叶热传导定律：通过厚度为 $L$、导热系数为 $k$、两面温度分别为 $T_{1}$ 和 $T_{2}$ 的均质板的热通量为 $q'' = k \\dfrac{T_{1} - T_{2}}{L}$。\n- 界面处的能量守恒：稳态时通过固体的热通量等于通过流体的热通量，因此 $q''_{solid} = q''_{fluid}$。\n- 用于有效间隙变化的线性热膨胀：$w = \\zeta \\alpha_s L_s (T_i - T_{ref})$。\n\n您的任务是编写一个完整的程序，该程序针对一组测试用例，通过找到通量平衡方程的根来求解 $T_i$，计算相应的稳态热通量 $q''$，并计算界面位移 $w$。确保在求根搜索中使用的数值区间内，有效间隙厚度满足 $L_f^{eff} = L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref})  0$。如果上界 $T_{hot}$ 会违反 $L_f^{eff}  0$，则将上界限制为 $T_{upper} = T_{ref} + \\dfrac{L_{f0}}{\\zeta \\alpha_s L_s}$（对于 $\\zeta \\alpha_s L_s  0$）减去一个小的正余量。使用一个稳健的区间法。\n\n使用以下测试套件，参数以国际单位制表示：\n- 案例 $1$（中等属性，非零耦合）：$T_{hot} = 400\\,\\mathrm{K}$，$T_{\\infty} = 300\\,\\mathrm{K}$，$L_s = 0.01\\,\\mathrm{m}$，$L_{f0} = 0.005\\,\\mathrm{m}$，$k_s = 15\\,\\mathrm{W/(m\\cdot K)}$，$k_f = 0.6\\,\\mathrm{W/(m\\cdot K)}$，$\\alpha_s = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$\\zeta = 0.5$，$T_{ref} = 300\\,\\mathrm{K}$。\n- 案例 $2$（解耦边界，刚性结构）：$T_{hot} = 400\\,\\mathrm{K}$，$T_{\\infty} = 300\\,\\mathrm{K}$，$L_s = 0.01\\,\\mathrm{m}$，$L_{f0} = 0.005\\,\\mathrm{m}$，$k_s = 15\\,\\mathrm{W/(m\\cdot K)}$，$k_f = 0.6\\,\\mathrm{W/(m\\cdot K)}$，$\\alpha_s = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$\\zeta = 0$，$T_{ref} = 300\\,\\mathrm{K}$。\n- 案例 $3$（高膨胀分数，薄流体层，低流体导热系数）：$T_{hot} = 500\\,\\mathrm{K}$，$T_{\\infty} = 300\\,\\mathrm{K}$，$L_s = 0.02\\,\\mathrm{m}$，$L_{f0} = 0.001\\,\\mathrm{m}$，$k_s = 30\\,\\mathrm{W/(m\\cdot K)}$，$k_f = 0.03\\,\\mathrm{W/(m\\cdot K)}$，$\\alpha_s = 5.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$\\zeta = 0.9$，$T_{ref} = 300\\,\\mathrm{K}$。\n- 案例 $4$（大间隙，极低流体导热系数）：$T_{hot} = 350\\,\\mathrm{K}$，$T_{\\infty} = 300\\,\\mathrm{K}$，$L_s = 0.02\\,\\mathrm{m}$，$L_{f0} = 0.02\\,\\mathrm{m}$，$k_s = 200\\,\\mathrm{W/(m\\cdot K)}$，$k_f = 0.03\\,\\mathrm{W/(m\\cdot K)}$，$\\alpha_s = 1.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$\\zeta = 0.7$，$T_{ref} = 300\\,\\mathrm{K}$。\n\n对于每个测试用例，您的程序必须计算并返回三元组 $[T_i, q'', w]$。温度使用开尔文，位移使用米，热通量使用瓦特每平方米。所有浮点输出必须四舍五入到六位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素是针对一个测试用例的三值列表 $[T_i, q'', w]$，按从案例 1 到案例 4 的顺序排列。例如，输出必须看起来像 $[[T_{i1},q''_1,w_1],[T_{i2},q''_2,w_2],[T_{i3},q''_3,w_3],[T_{i4},q''_4,w_4]]$，行内没有任何空格。",
            "solution": "用户提供的问题陈述已经过分析和验证。\n\n### 步骤 1：提取已知条件\n- **系统**：一个一维、稳态、热耦合的流固耦合（FSI）系统。\n- **组件**：一块固体板和一个静止流体层。\n- **温度**：\n    - 热源温度：$T_{hot}$\n    - 环境温度：$T_{\\infty}$\n    - 界面温度：$T_i$\n    - 热膨胀参考温度：$T_{ref}$\n- **固体板属性**：\n    - 厚度：$L_s$\n    - 导热系数：$k_s$\n    - 线性热膨胀系数：$\\alpha_s$\n- **流体层属性**：\n    - 初始厚度：$L_{f0}$\n    - 导热系数：$k_f$\n- **耦合参数**：\n    - 膨胀伸出的几何因子：$\\zeta \\in [0, 1]$\n- **控制原理和方程**：\n    1.  **傅里叶热传导定律**：$q'' = k \\frac{T_1 - T_2}{L}$。\n    2.  **能量守恒**：在稳态下，通过固体的热通量等于通过流体的热通量：$q''_{solid} = q''_{fluid}$。\n    3.  **界面位移**：由热膨胀引起的固液界面位移为 $w = \\zeta \\alpha_s L_s (T_i - T_{ref})$。\n    4.  **有效流体厚度**：流体厚度因位移而减小：$L_f^{eff} = L_{f0} - w$。\n    5.  **物理约束**：有效流体厚度必须为正：$L_f^{eff} > 0$。\n- **任务**：\n    1.  推导关于 $T_i$ 的非线性标量方程。\n    2.  使用稳健的区间法数值求解 $T_i$。\n    3.  计算稳态热通量 $q''$ 和界面位移 $w$。\n    4.  通过必要时调整数值搜索区间来处理物理约束 $L_f^{eff} > 0$。\n- **测试用例（国际单位制）**：\n    - **案例 1**：$T_{hot} = 400$, $T_{\\infty} = 300$, $L_s = 0.01$, $L_{f0} = 0.005$, $k_s = 15$, $k_f = 0.6$, $\\alpha_s = 1.2 \\times 10^{-5}$, $\\zeta = 0.5$, $T_{ref} = 300$。\n    - **案例 2**：$T_{hot} = 400$, $T_{\\infty} = 300$, $L_s = 0.01$, $L_{f0} = 0.005$, $k_s = 15$, $k_f = 0.6$, $\\alpha_s = 1.2 \\times 10^{-5}$, $\\zeta = 0$, $T_{ref} = 300$。\n    - **案例 3**：$T_{hot} = 500$, $T_{\\infty} = 300$, $L_s = 0.02$, $L_{f0} = 0.001$, $k_s = 30$, $k_f = 0.03$, $\\alpha_s = 5.0 \\times 10^{-5}$, $\\zeta = 0.9$, $T_{ref} = 300$。\n    - **案例 4**：$T_{hot} = 350$, $T_{\\infty} = 300$, $L_s = 0.02$, $L_{f0} = 0.02$, $k_s = 200$, $k_f = 0.03$, $\\alpha_s = 1.0 \\times 10^{-5}$, $\\zeta = 0.7$, $T_{ref} = 300$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于热传递（傅里叶定律）和固体力学（线性热膨胀）的基本原理。FSI 耦合模型是工程分析中使用的有效且标准的简化方法。所有原理都已广为接受。\n- **适定性**：该问题是适定的。它要求解一个单未知数 $T_i$ 的单非线性方程。它提供了所有必要的参数，并定义了一个清晰的物理约束（$L_f^{eff} > 0$）以及处理它的程序，确保存在唯一且有意义的解。\n- **客观性**：该问题使用精确、客观和定量的语言陈述。没有主观或基于意见的元素。\n- **未检测到缺陷**：该问题没有违反任何无效性标准。它在科学上是合理的，形式上是结构化的，完整的，物理上是现实的，并且是适定的。\n\n### 步骤 3：结论和行动\n该问题是**有效的**。将提供一个解决方案。\n\n### 基于原理的求解推导和算法设计\n\n解决方案首先推导界面温度 $T_i$ 的控制非线性方程，然后概述求解该方程的数值算法。\n\n**1. 控制方程的推导**\n\n系统处于稳态，意味着通过固体层和流体层的热通量是恒定的。\n\n将傅里叶热传导定律应用于固体板，从温度为 $T_{hot}$ 的热源到温度为 $T_i$ 的界面的热通量 $q''_{solid}$ 为：\n$$ q''_{solid} = k_s \\frac{T_{hot} - T_i}{L_s} $$\n\n界面位移 $w$ 是界面温度 $T_i$ 的函数：\n$$ w = \\zeta \\alpha_s L_s (T_i - T_{ref}) $$\n\n该位移减小了流体层的厚度。有效流体厚度 $L_f^{eff}$ 为：\n$$ L_f^{eff} = L_{f0} - w = L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref}) $$\n\n将傅里叶定律应用于静止流体层，从温度为 $T_i$ 的界面到温度为 $T_{\\infty}$ 的环境的热通量 $q''_{fluid}$ 为：\n$$ q''_{fluid} = k_f \\frac{T_i - T_{\\infty}}{L_f^{eff}} = k_f \\frac{T_i - T_{\\infty}}{L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref})} $$\n\n界面处的能量守恒要求流入和流出的通量相等：$q''_{solid} = q''_{fluid}$。\n$$ k_s \\frac{T_{hot} - T_i}{L_s} = k_f \\frac{T_i - T_{\\infty}}{L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref})} $$\n\n这就是关于未知界面温度 $T_i$ 的最终非线性标量方程。\n\n**2. 数值求解方法**\n\n为了求解 $T_i$，我们构建一个求根问题。我们定义一个残差函数 $F(T_i)$，使其根对应于解。设 $F(T_i) = q''_{solid} - q''_{fluid}$。问题是找到 $T_i$ 使得 $F(T_i) = 0$。\n$$ F(T_i) = k_s \\frac{T_{hot} - T_i}{L_s} - k_f \\frac{T_i - T_{\\infty}}{L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref})} = 0 $$\n\n寻找单变量非线性函数根的一种稳健的数值方法是区间法，例如 Brent-Dekker 方法（在 SciPy 中可用作 `scipy.optimize.brentq`）。该方法需要一个区间 $[a, b]$，其中 $F(a)$ 和 $F(b)$ 符号相反。\n\n**3. 确定搜索区间 $[a, b]$**\n\n- **下界 ($a$)**：界面温度的物理下界是环境温度 $T_{\\infty}$。我们设 $a = T_{\\infty}$。在此温度下，通过流体的通量为零，$q''_{fluid}=0$，而通过固体的通量为正，$q''_{solid} > 0$（因为 $T_{hot} > T_{\\infty}$）。因此，$F(a) = F(T_{\\infty}) > 0$。\n\n- **上界 ($b$)**：两个约束适用于 $T_i$ 的上界：\n    1.  **热力学极限**：$T_i$ 不能超过热源温度 $T_{hot}$。在 $T_i = T_{hot}$ 时，固体通量 $q''_{solid} = 0$，而流体通量 $q''_{fluid} > 0$。因此，$F(T_{hot})  0$。\n    2.  **物理极限**：有效流体厚度必须为正：$L_f^{eff} > 0$。这意味着 $L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref}) > 0$。如果耦合乘积 $\\zeta \\alpha_s L_s$ 为正，这对 $T_i$ 设定了一个上限：\n        $$ T_i  T_{ref} + \\frac{L_{f0}}{\\zeta \\alpha_s L_s} \\equiv T_{upper} $$\n        函数 $F(T_i)$ 在 $T_i = T_{upper}$ 处有一条垂直渐近线，当 $T_i$ 从下方趋近 $T_{upper}$ 时，函数趋近于 $-\\infty$。\n\n为确保搜索有效且具有物理意义，区间的上界 $b$ 必须选择为 $b = \\min(T_{hot}, T_{upper} - \\epsilon)$，其中 $\\epsilon$ 是一个小的正余量，以避免在 $T_{upper}$ 处的奇异点。\n\n设 $a = T_{\\infty}$ 和 $b = \\min(T_{hot}, T_{upper} - \\epsilon)$，我们有 $F(a) > 0$ 和 $F(b)  0$，保证在区间 $[a, b]$ 内存在唯一的根，因为 $F(T_i)$ 在此范围内是连续且单调的。\n\n**4. 算法**\n\n每个测试用例的计算过程如下：\n1.  初始化所有物理参数：$T_{hot}$, $T_{\\infty}$, $L_s$, $L_{f0}$, $k_s$, $k_f$, $\\alpha_s$, $\\zeta$, 和 $T_{ref}$。\n2.  如上所述，定义残差函数 $F(T_i)$。\n3.  计算耦合乘积项 $C = \\zeta \\alpha_s L_s$。如果 $C > 0$，计算间隙闭合温度极限 $T_{upper}$。\n4.  将搜索区间的下界设置为 $a = T_{\\infty}$。\n5.  将搜索区间的上界设置为 $b = T_{hot}$。如果 $C > 0$，则将上界更新为 $b = \\min(T_{hot}, T_{upper} - 10^{-9})$。\n6.  使用数值求根器（例如，`scipy.optimize.brentq`）在区间 $[a, b]$ 内求解 $T_i$。\n7.  一旦找到 $T_i$，计算稳态热通量 $q'' = k_s \\frac{T_{hot} - T_i}{L_s}$ 和界面位移 $w = \\zeta \\alpha_s L_s (T_i - T_{ref})$。\n8.  将计算出的 $T_i$、$q''$ 和 $w$ 的值四舍五入到六位小数。\n9.  存储得到的三元组 $[T_i, q'', w]$。\n10. 处理完所有案例后，将收集到的结果格式化为指定的字符串格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves a set of 1D steady-state thermally coupled FSI problems.\n    For each case, it computes the interface temperature, heat flux,\n    and interface displacement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: moderate properties, nonzero coupling\n        (400, 300, 0.01, 0.005, 15, 0.6, 1.2e-5, 0.5, 300),\n        # Case 2: decoupled boundary, stiff structure\n        (400, 300, 0.01, 0.005, 15, 0.6, 1.2e-5, 0, 300),\n        # Case 3: high expansion fraction, thin fluid layer, low fluid conductivity\n        (500, 300, 0.02, 0.001, 30, 0.03, 5.0e-5, 0.9, 300),\n        # Case 4: large gap, very low fluid conductivity\n        (350, 300, 0.02, 0.02, 200, 0.03, 1.0e-5, 0.7, 300),\n    ]\n\n    results = []\n    for case in test_cases:\n        T_hot, T_inf, L_s, L_f0, k_s, k_f, alpha_s, zeta, T_ref = case\n\n        def flux_balance(T_i):\n            \"\"\"\n            Residual function F(T_i) = q_solid - q_fluid.\n            The root of this function is the solution for the interface temperature.\n            \"\"\"\n            # Calculate displacement and effective fluid thickness\n            w = zeta * alpha_s * L_s * (T_i - T_ref)\n            L_f_eff = L_f0 - w\n\n            # Physically, L_f_eff must be positive. If the solver wanders\n            # into a region where L_f_eff = 0, return a large value to repel it.\n            # This is a safeguard; the bracket should prevent this.\n            if L_f_eff = 0:\n                return -np.inf\n\n            # Calculate heat fluxes\n            q_solid = k_s * (T_hot - T_i) / L_s\n            q_fluid = k_f * (T_i - T_inf) / L_f_eff\n            \n            return q_solid - q_fluid\n\n        # Set up the search bracket [a, b] for the root finder\n        # Lower bound is the ambient temperature\n        a = T_inf\n        # Upper bound is the hot source temperature\n        b = T_hot\n\n        # Adjust upper bound to prevent gap closure (L_f_eff = 0)\n        coupling_term = zeta * alpha_s * L_s\n        if coupling_term > 0:\n            # Temperature at which the gap closes\n            T_upper_limit = T_ref + L_f0 / coupling_term\n            # Use a small margin as specified\n            margin = 1e-9\n            b = min(b, T_upper_limit - margin)\n\n        # Solve for the interface temperature T_i using Brent's method\n        T_i_sol = brentq(flux_balance, a, b, xtol=1e-12, rtol=1e-12)\n\n        # Calculate final displacement and heat flux with the solved T_i\n        w_sol = zeta * alpha_s * L_s * (T_i_sol - T_ref)\n        q_sol = k_s * (T_hot - T_i_sol) / L_s\n\n        # Round the results to six decimal places\n        result = [\n            round(T_i_sol, 6),\n            round(q_sol, 6),\n            round(w_sol, 6)\n        ]\n        results.append(result)\n\n    # Format the results into the required string format with no spaces\n    formatted_results = [str(r).replace(' ', '') for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```"
        },
        {
            "introduction": "在理解了稳态耦合之后，我们转向瞬态（随时间变化的）系统。集总电容法是简化瞬态热分析的有力工具。这个实践  将引导您使用此模型，并推导出一个常见时间积分方案的数值稳定性条件。掌握这一概念对于在瞬态仿真中选择合适的时间步长至关重要，它将解析理论与实际的计算约束联系起来。",
            "id": "3954930",
            "problem": "一面厚度为 $l$ 的高导热性薄固体壁将两种不可压缩流体分开：温度为 $T_{1,\\infty}$ 的热流体和温度为 $T_{2,\\infty}$ 的冷流体。壁面材料的密度为 $\\rho_{s}$，比热容为 $c_{p,s}$。由于壁面的高导热性，假设壁面温度在空间上是均匀的，并且在任何时刻都等于 $T_{w}(t)$。两侧的界面热交换遵循牛顿冷却定律：在热侧，流入壁面的热通量为 $q_{1}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right)$；在冷侧，流出壁面的热通量为 $q_{2}(t) = h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)$，其中 $h_{1}$ 和 $h_{2}$ 是恒定的对流换热系数。所有量均按单位壁面面积计算。\n\n从基本原理出发，写出壁面的能量平衡方程，并用它推导出关于 $T_{w}(t)$ 的控制常微分方程。考虑一种分离式流固耦合（FSI）方法，其中壁面温度使用应用于该常微分方程的、时间步长为 $\\Delta t$ 的前向欧拉法进行显式时间推进，而流体侧的热通量 $q_{1}(t)$ 和 $q_{2}(t)$ 在每一步都使用当前的壁面温度进行评估。推导该显式时间积分格式绝对稳定的充要条件，用 $h_{1}$、$h_{2}$、$\\rho_{s}$、$c_{p,s}$ 和 $l$ 表示。\n\n最后，对于一个厚度 $l = 2.0 \\times 10^{-3}\\,\\text{m}$、由 $\\rho_{s} = 2.7 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3}$ 和 $c_{p,s} = 9.0 \\times 10^{2}\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$ 的固体材料制成的壁面，该壁面隔开了一股 $h_{1} = 4.0 \\times 10^{3}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ 的液体流和一股 $h_{2} = 2.0 \\times 10^{2}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ 的空气流，计算为保证绝对稳定所允许的最大时间步长 $\\Delta t_{\\max}$。请将最终的时间步长以秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "首先验证问题的科学合理性、适定性和完整性。所给问题描述了一个使用集总电容法的标准瞬态传热情景，该方法适用于高导热性的薄壁。其物理基础是热力学第一定律（能量守恒）和牛顿冷却定律。数值分析部分涉及前向欧拉法的稳定性，是计算工程中的一个典型课题。所有必需的参数均已提供，并且数值对于所描述的材料和条件是物理上现实的。因此，该问题被认为是有效的。\n\n求解过程分为三部分：首先，推导壁温 $T_w(t)$ 的控制常微分方程（ODE）；其次，推导显式前向欧拉时间积分格式的稳定性条件；第三，使用所提供的数值数据计算最大稳定时间步长 $\\Delta t_{\\max}$。\n\n**第一部分：推导控制常微分方程**\n\n我们从应用于固体壁的能量守恒第一原理开始。壁内储存的内能变化率必须等于进入壁的净传热率。由于问题指定按单位面积处理，我们对一个对应于厚度为 $l$ 的单位面积壁面的控制体建立能量平衡。\n\n单位面积壁面的内能 $E_{w}$ 由 $E_{w} = m' c_{p,s} T_{w}(t)$ 给出，其中 $m'$ 是单位面积的质量。单位面积的质量是材料密度 $\\rho_s$ 和壁厚 $l$ 的乘积，因此 $m' = \\rho_{s} l$。因此，单位面积的内能为 $E_{w} = \\rho_{s} l c_{p,s} T_{w}(t)$。\n\n单位面积内能的变化率为：\n$$\n\\frac{dE_{w}}{dt} = \\frac{d}{dt} \\left( \\rho_{s} l c_{p,s} T_{w}(t) \\right) = \\rho_{s} l c_{p,s} \\frac{dT_{w}}{dt}\n$$\n这是有效的，因为 $\\rho_{s}$、$l$ 和 $c_{p,s}$ 是常数。\n\n进入壁面的净热通量 $q_{net}$ 是从热侧流入的热通量 $q_1(t)$ 减去流向冷侧的热通量 $q_2(t)$。\n$$\nq_{net}(t) = q_{1}(t) - q_{2}(t)\n$$\n使用基于牛顿冷却定律的给定表达式：\n$$\nq_{1}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right)\n$$\n$$\nq_{2}(t) = h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)\n$$\n因此，净热通量为：\n$$\nq_{net}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right) - h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)\n$$\n展开并合并含 $T_w(t)$ 的项：\n$$\nq_{net}(t) = h_{1}T_{1,\\infty} - h_{1}T_{w}(t) - h_{2}T_{w}(t) + h_{2}T_{2,\\infty}\n$$\n$$\nq_{net}(t) = -\\left(h_{1} + h_{2}\\right)T_{w}(t) + \\left(h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}\\right)\n$$\n将能量变化率与净热通量相等，即 $\\frac{dE_{w}}{dt} = q_{net}(t)$，我们得到控制常微分方程：\n$$\n\\rho_{s} l c_{p,s} \\frac{dT_{w}}{dt} = -\\left(h_{1} + h_{2}\\right)T_{w}(t) + \\left(h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}\\right)\n$$\n这就是所求的壁温 $T_w(t)$ 的常微分方程。\n\n**第二部分：前向欧拉格式的稳定性条件**\n\n推导出的常微分方程可以写成标准形式 $\\frac{dy}{dt} = \\lambda y + b$。整理我们的常微分方程：\n$$\n\\frac{dT_{w}}{dt} = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}} T_{w}(t) + \\frac{h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}}{\\rho_{s} l c_{p,s}}\n$$\n这是一个线性一阶常微分方程。为了进行稳定性分析，我们只需考虑方程的齐次部分，它控制着扰动的演化。该方程的形式为 $\\frac{dT_w}{dt} = \\lambda T_w + f(t)$，其中常数 $\\lambda$ 由下式给出：\n$$\n\\lambda = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}}\n$$\n前向欧拉法是一种显式时间积分格式。对于一个常微分方程 $\\frac{dy}{dt} = g(t, y)$，其更新规则为 $y^{n+1} = y^{n} + \\Delta t \\, g(t^{n}, y^{n})$。将此应用于我们关于 $T_w$ 的常微分方程：\n$$\nT_{w}^{n+1} = T_{w}^{n} + \\Delta t \\left( \\lambda T_{w}^{n} + \\frac{h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}}{\\rho_{s} l c_{p,s}} \\right)\n$$\n该数值格式的稳定性取决于它如何传播误差。在时间步 $n$ 的误差 $\\epsilon^n$ 会根据离散化方程的齐次部分演化为在时间步 $n+1$ 的误差 $\\epsilon^{n+1}$：\n$$\n\\epsilon^{n+1} = \\epsilon^{n} + \\Delta t (\\lambda \\epsilon^{n}) = (1 + \\lambda \\Delta t)\\epsilon^{n}\n$$\n项 $G = 1 + \\lambda \\Delta t$ 是放大因子。为了使格式绝对稳定，任何初始误差的量级都不能随时间增长。这要求放大因子的模不大于1：\n$$\n|G| \\leq 1 \\implies |1 + \\lambda \\Delta t| \\leq 1\n$$\n这个不等式可以展开为：\n$$\n-1 \\leq 1 + \\lambda \\Delta t \\leq 1\n$$\n这产生了两个条件：\n1. $1 + \\lambda \\Delta t \\leq 1 \\implies \\lambda \\Delta t \\leq 0$\n2. $-1 \\leq 1 + \\lambda \\Delta t \\implies -2 \\leq \\lambda \\Delta t \\implies \\Delta t \\leq -\\frac{2}{\\lambda}$\n\n由于所有物理参数（$h_1, h_2, \\rho_s, l, c_{p,s}$）都是正的，项 $\\lambda = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}}$ 严格为负。同时，时间步长 $\\Delta t$ 必须为正。因此，乘积 $\\lambda \\Delta t$ 总是负的，第一个条件 $\\lambda \\Delta t \\leq 0$ 总是满足的。\n\n因此，稳定性仅由第二个条件约束：\n$$\n\\Delta t \\leq -\\frac{2}{\\lambda}\n$$\n代入 $\\lambda$ 的表达式：\n$$\n\\Delta t \\leq -2 \\left( -\\frac{\\rho_{s} l c_{p,s}}{h_{1} + h_{2}} \\right)\n$$\n$$\n\\Delta t \\leq \\frac{2 \\rho_{s} l c_{p,s}}{h_{1} + h_{2}}\n$$\n这就是该问题中前向欧拉格式绝对稳定的充要条件。\n\n**第三部分：计算最大时间步长 $\\Delta t_{\\max}$**\n\n允许的最大时间步长 $\\Delta t_{\\max}$ 是此稳定性条件的上界：\n$$\n\\Delta t_{\\max} = \\frac{2 \\rho_{s} l c_{p,s}}{h_{1} + h_{2}}\n$$\n给定以下数值：\n- $l = 2.0 \\times 10^{-3}\\,\\text{m}$\n- $\\rho_{s} = 2.7 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3}$\n- $c_{p,s} = 9.0 \\times 10^{2}\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$\n- $h_{1} = 4.0 \\times 10^{3}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n- $h_{2} = 2.0 \\times 10^{2}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n\n首先，我们计算单位面积壁面的热容，即分子项 $\\rho_{s} l c_{p,s}$：\n$$\n\\rho_{s} l c_{p,s} = (2.7 \\times 10^{3}) \\times (2.0 \\times 10^{-3}) \\times (9.0 \\times 10^{2}) = 4860\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\n接着，我们计算对流换热系数之和：\n$$\nh_{1} + h_{2} = (4.0 \\times 10^{3}) + (2.0 \\times 10^{2}) = 4000 + 200 = 4200\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\n现在，将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\Delta t_{\\max} = \\frac{2 \\times 4860}{4200} = \\frac{9720}{4200}\\,\\text{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{972}{420} = \\frac{81}{35}\\,\\text{s} \\approx 2.3142857... \\,\\text{s}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\n\\Delta t_{\\max} \\approx 2.314 \\, \\text{s}\n$$",
            "answer": "$$\\boxed{2.314}$$"
        },
        {
            "introduction": "最后，我们探讨热效应对系统动态行为的影响。在许多工程应用中，理解温度如何改变结构的固有频率和振动模态对于设计和安全至关重要。这个实践  使用一个简化的双自由度模型，演示如何通过求解一个广义特征值问题来找到这些随温度变化的动态特性，从而深入了解热机械振动现象。",
            "id": "3954904",
            "problem": "考虑一个热耦合系统中流固耦合（FSI）的最小二自由度表示：一个面积为 $A$、厚度为 $h$ 的刚性平板结构封闭一个体积为 $V = A H$ 的刚性流体腔，其中 $H$ 是腔体高度。结构板发生由广义坐标 $u$ 描述的微小横向位移，腔内流体边界发生由广义坐标 $\\eta$ 描述的集总均匀位移。假设系统是无阻尼的，进行小幅振荡，并经历准静态热变化，因此材料属性取决于温度 $T$，但惯性和运动学遵循相同的力学定律。目标是计算耦合的固有频率和相关的振型作为温度的函数。\n\n使用以下基于第一性原理的建模假设：\n- 每个广义坐标的牛顿第二定律：对于 $u$ 和 $\\eta$，合力等于质量乘以加速度。\n- 能量方法：总动能 $T$ 和势能 $U$ 通过对能量关于广义坐标求二阶导数来定义广义刚度矩阵和质量矩阵。\n- 流体可压缩性通过流体体积模量将压力变化与体积应变联系起来。\n- 热变材料属性通过在感兴趣的范围内经过良好测试的线性温度相关近似进行建模。\n\n将动能定义为\n$$\nT = \\tfrac{1}{2} m_s(T) \\dot{u}^2 + \\tfrac{1}{2} m_f(T) \\dot{\\eta}^2,\n$$\n其中 $m_s(T)$ 是结构质量，$m_f(T)$ 是腔内的集总流体惯量。将势能定义为\n$$\nU = \\tfrac{1}{2} k_s(T) u^2 + \\tfrac{1}{2} k_f(T) \\left(u - \\eta\\right)^2,\n$$\n其中 $k_s(T)$ 是有效结构刚度，$k_f(T)$ 是与可压缩性和几何形状相关的有效流体腔刚度。根据这些能量，构建对称的、与温度相关的质量和刚度矩阵\n$$\n\\mathbf{M}(T) = \\begin{bmatrix}\nm_s(T)  0 \\\\\n0  m_f(T)\n\\end{bmatrix}, \\quad\n\\mathbf{K}(T) = \\begin{bmatrix}\nk_s(T) + k_f(T)  -k_f(T) \\\\\n-k_f(T)  k_f(T)\n\\end{bmatrix}.\n$$\n耦合的无阻尼自由振动问题则是一个广义特征值问题\n$$\n\\left[\\mathbf{K}(T) - \\omega^2 \\mathbf{M}(T)\\right] \\mathbf{v} = \\mathbf{0},\n$$\n其中 $\\omega$ 是固有角频率，$\\mathbf{v}$ 是相关的振型向量。通过 $f = \\omega / (2\\pi)$ 以赫兹（Hz）表示固有频率。\n\n使用以下关系计算材料属性的温度依赖性，所有温度 $T$ 的单位为开尔文（$\\mathrm{K}$），参数采用国际单位制（SI）：\n- 结构质量：$m_s(T) = \\rho_s A h$，其中固体密度恒为 $\\rho_s = 7800 \\,\\mathrm{kg/m^3}$。\n- 流体质量：$m_f(T) = \\rho_f(T) A H$，流体密度为\n$$\n\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} \\, (T - T_0)\\right], \\quad \\rho_{f0} = 998 \\,\\mathrm{kg/m^3}, \\quad \\alpha_{\\rho} = 3 \\times 10^{-4} \\,\\mathrm{K^{-1}}, \\quad T_0 = 293.15 \\,\\mathrm{K}.\n$$\n- 结构刚度：$k_s(T) = E(T) \\, \\dfrac{h A}{L_{\\text{eff}}}$，其中\n$$\nE(T) = E_0 \\left[1 - \\alpha_E \\, (T - T_0)\\right], \\quad E_0 = 2.0 \\times 10^{11} \\,\\mathrm{Pa}, \\quad \\alpha_E = 2 \\times 10^{-4} \\,\\mathrm{K^{-1}}, \\quad L_{\\text{eff}} = 0.5 \\,\\mathrm{m}.\n$$\n- 由可压缩性产生的流体腔刚度：$k_f(T) = \\dfrac{K_{\\text{bulk}}(T) \\, A^2}{V} = K_{\\text{bulk}}(T) \\, \\dfrac{A}{H}$，其中\n$$\nK_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K \\, (T - T_0)\\right], \\quad K_0 = 2.2 \\times 10^{9} \\,\\mathrm{Pa}, \\quad \\alpha_K = 5 \\times 10^{-4} \\,\\mathrm{K^{-1}}.\n$$\n\n使用固定的几何参数\n$$\nA = 0.25 \\,\\mathrm{m^2}, \\quad h = 0.01 \\,\\mathrm{m}, \\quad H = 0.2 \\,\\mathrm{m}, \\quad V = A H.\n$$\n\n对于下面测试套件中的每个温度 $T$，构建 $\\mathbf{M}(T)$ 和 $\\mathbf{K}(T)$，求解具有最小特征值 $\\omega^2$ 的两个特征对的广义特征值问题，然后：\n- 报告两个固有频率 $f_1$ 和 $f_2$（单位：赫兹），每个频率四舍五入到六位小数。\n- 报告相关的振型为质量归一化特征向量（归一化使得每个振型都满足 $\\mathbf{v}^\\top \\mathbf{M}(T) \\mathbf{v} = 1$），并选择符号以使结构位移分量 $v_u$ 为正。按 $[v_{1,u}, v_{1,\\eta}, v_{2,u}, v_{2,\\eta}]$ 的顺序输出四个分量，每个分量四舍五入到六位小数。\n\n测试套件温度（单位：开尔文），涵盖基准、升高、降低和高温情况：\n- $T = 293.15$\n- $T = 333.15$\n- $T = 283.15$\n- $T = 373.15$\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号内包含的逗号分隔列表。对于每个温度，输出一个形式为 $[[f_1, f_2], [v_{1,u}, v_{1,\\eta}, v_{2,u}, v_{2,\\eta}]]$ 的嵌套列表。因此，最终输出格式必须为\n$$\n\\left[ \\, [[f_1^{(1)}, f_2^{(1)}], [v_{1,u}^{(1)}, v_{1,\\eta}^{(1)}, v_{2,u}^{(1)}, v_{2,\\eta}^{(1)}]], \\, [[f_1^{(2)}, f_2^{(2)}], [v_{1,u}^{(2)}, v_{1,\\eta}^{(2)}, v_{2,u}^{(2)}, v_{2,\\eta}^{(2)}]], \\, [[f_1^{(3)}, f_2^{(3)}], [v_{1,u}^{(3)}, v_{1,\\eta}^{(3)}, v_{2,u}^{(3)}, v_{2,\\eta}^{(3)}]], \\, [[f_1^{(4)}, f_2^{(4)}], [v_{1,u}^{(4)}, v_{1,\\eta}^{(4)}, v_{2,u}^{(4)}, v_{2,\\eta}^{(4)}]] \\, \\right],\n$$\n其中上标 $\\left( i \\right)$ 按上面列出的顺序索引温度案例。所有数值必须是四舍五入到六位小数的浮点数，频率单位必须是赫兹（Hz）。",
            "solution": "用户提供了一个计算热工领域的问题，具体涉及热耦合系统中的流固耦合。任务是计算一个简化的二自由度模型的随温度变化的固有频率和振型。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n- **系统模型**：一个具有广义坐标 $u$（结构位移）和 $\\eta$（流体位移）的二自由度（2-DOF）无阻尼系统。\n- **动能**：$T = \\tfrac{1}{2} m_s(T) \\dot{u}^2 + \\tfrac{1}{2} m_f(T) \\dot{\\eta}^2$。\n- **势能**：$U = \\tfrac{1}{2} k_s(T) u^2 + \\tfrac{1}{2} k_f(T) \\left(u - \\eta\\right)^2$。\n- **质量矩阵**：$\\mathbf{M}(T) = \\begin{bmatrix} m_s(T)  0 \\\\ 0  m_f(T) \\end{bmatrix}$。\n- **刚度矩阵**：$\\mathbf{K}(T) = \\begin{bmatrix} k_s(T) + k_f(T)  -k_f(T) \\\\ -k_f(T)  k_f(T) \\end{bmatrix}$。\n- **控制方程**：广义特征值问题 $\\left[\\mathbf{K}(T) - \\omega^2 \\mathbf{M}(T)\\right] \\mathbf{v} = \\mathbf{0}$。\n- **频率转换**：$f = \\omega / (2\\pi)$。\n- **几何参数**：面积 $A = 0.25 \\,\\mathrm{m^2}$，结构厚度 $h = 0.01 \\,\\mathrm{m}$，腔体高度 $H = 0.2 \\,\\mathrm{m}$。\n- **材料参数（国际单位制）**：\n    - 恒定固体密度：$\\rho_s = 7800 \\,\\mathrm{kg/m^3}$。\n    - 参考流体密度：$\\rho_{f0} = 998 \\,\\mathrm{kg/m^3}$。\n    - 流体密度热系数：$\\alpha_{\\rho} = 3 \\times 10^{-4} \\,\\mathrm{K^{-1}}$。\n    - 参考杨氏模量：$E_0 = 2.0 \\times 10^{11} \\,\\mathrm{Pa}$。\n    - 杨氏模量热系数：$\\alpha_E = 2 \\times 10^{-4} \\,\\mathrm{K^{-1}}$。\n    - 有效结构长度：$L_{\\text{eff}} = 0.5 \\,\\mathrm{m}$。\n    - 参考流体体积模量：$K_0 = 2.2 \\times 10^{9} \\,\\mathrm{Pa}$。\n    - 体积模量热系数：$\\alpha_K = 5 \\times 10^{-4} \\,\\mathrm{K^{-1}}$。\n    - 参考温度：$T_0 = 293.15 \\,\\mathrm{K}$。\n- **随温度变化的属性**：\n    - 结构质量：$m_s(T) = \\rho_s A h$。\n    - 流体密度：$\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} \\, (T - T_0)\\right]$。\n    - 流体质量：$m_f(T) = \\rho_f(T) A H$。\n    - 杨氏模量：$E(T) = E_0 \\left[1 - \\alpha_E \\, (T - T_0)\\right]$。\n    - 结构刚度：$k_s(T) = E(T) \\, \\dfrac{h A}{L_{\\text{eff}}}$。\n    - 体积模量：$K_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K \\, (T - T_0)\\right]$。\n    - 流体刚度：$k_f(T) = K_{\\text{bulk}}(T) \\, \\dfrac{A}{H}$。\n- **测试套件**：温度 $T \\in \\{293.15, 333.15, 283.15, 373.15\\} \\,\\mathrm{K}$。\n- **输出要求**：\n    - 两个固有频率 $f_1, f_2$，单位为赫兹，按升序排列并四舍五入到 6 位小数。\n    - 两个对应的质量归一化特征向量 $\\mathbf{v}_1, \\mathbf{v}_2$，其中归一化意味着 $\\mathbf{v}^\\top \\mathbf{M}(T) \\mathbf{v} = 1$。\n    - 特征向量符号约定：第一个分量（结构位移）必须为正。\n    - 输出格式：一个列表的列表，`[[[f1, f2], [v1_u, v1_eta, v2_u, v2_eta]], ...]`，针对每个温度，所有值都四舍五入到 6 位小数。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于经典力学（2-DOF 系统的拉格朗日公式）和连续介质力学（线性弹性、流体可压缩性）的基本原理进行阐述。该模型是研究耦合动力学的标准且有效的简化方法。温度依赖性被建模为线性函数，这对于给定范围是常见且可接受的近似。物理常数对于像钢和水这样的常见工程材料是现实的。该阐述具有科学合理性。\n- **适定性**：该问题需要求解形式为 $\\mathbf{K}\\mathbf{v} = \\lambda \\mathbf{M}\\mathbf{v}$ 的广义特征值问题，其中 $\\lambda = \\omega^2$。质量矩阵 $\\mathbf{M}(T)$ 是对角矩阵，其元素为正（质量 $m_s, m_f$ 内在为正）。刚度矩阵 $\\mathbf{K}(T)$ 是对称的。对于给定的温度，刚度常数 $k_s(T)$ 和 $k_f(T)$ 将为正，这使得 $\\mathbf{K}(T)$ 是正定的。一个具有正定刚度矩阵和正定质量矩阵的系统保证有实数、正的特征值 $\\lambda$，从而得到实数、正的固有频率 $\\omega$。因此，对于每个温度都存在唯一且有意义的解。\n- **客观性**：问题使用精确的数学定义和客观的数值数据进行陈述。没有歧义、主观性或基于意见的语言。\n\n**第 3 步：结论与行动**\n\n该问题具有科学依据、适定、客观且自成体系。这是一个有效的问题。我将继续进行求解。\n\n### 求解方案\n\n此问题的求解涉及对每个指定温度 $T$ 的系统性步骤。任务的核心是组装随温度变化的质量矩阵 $\\mathbf{M}(T)$ 和刚度矩阵 $\\mathbf{K}(T)$，然后求解得到的广义特征值问题。\n\n**1. 计算随温度变化的属性**\n首先，对于给定的温度 $T$，我们必须计算随温度变化的物理属性的值。参考温度为 $T_0 = 293.15 \\,\\mathrm{K}$。与此参考的偏差为 $\\Delta T = T - T_0$。\n\n- 流体密度 $\\rho_f(T)$ 由下式给出：\n$$\n\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} (T - T_0)\\right]\n$$\n- 结构材料的杨氏模量 $E(T)$ 由下式给出：\n$$\nE(T) = E_0 \\left[1 - \\alpha_E (T - T_0)\\right]\n$$\n- 流体的体积模量 $K_{\\text{bulk}}(T)$ 由下式给出：\n$$\nK_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K (T - T_0)\\right]\n$$\n\n**2. 计算质量和刚度矩阵的元素**\n使用随温度变化的属性和固定的几何参数，我们计算构成质量和刚度矩阵的四个元素。\n\n- 在此模型中，结构质量 $m_s$ 不随温度变化：\n$$\nm_s = \\rho_s A h\n$$\n- 集总流体质量 $m_f(T)$ 取决于流体密度：\n$$\nm_f(T) = \\rho_f(T) A H\n$$\n- 结构刚度 $k_s(T)$ 取决于杨氏模量：\n$$\nk_s(T) = E(T) \\, \\frac{A h}{L_{\\text{eff}}}\n$$\n- 流体腔刚度 $k_f(T)$ 取决于体积模量：\n$$\nk_f(T) = K_{\\text{bulk}}(T) \\, \\frac{A}{H}\n$$\n\n**3. 组装系统矩阵**\n计算出四个关键参数后，我们组装 $2 \\times 2$ 的质量和刚度矩阵。\n\n- 质量矩阵：\n$$\n\\mathbf{M}(T) = \\begin{bmatrix}\nm_s  0 \\\\\n0  m_f(T)\n\\end{bmatrix}\n$$\n- 刚度矩阵：\n$$\n\\mathbf{K}(T) = \\begin{bmatrix}\nk_s(T) + k_f(T)  -k_f(T) \\\\\n-k_f(T)  k_f(T)\n\\end{bmatrix}\n$$\n\n**4. 求解广义特征值问题**\n核心步骤是求解系统的无阻尼自由振动的广义特征值问题：\n$$\n\\mathbf{K}(T) \\mathbf{v} = \\omega^2 \\mathbf{M}(T) \\mathbf{v}\n$$\n这需要数值求解。标准的数值库为此任务提供了高效稳定的特征求解器。求解得到两个特征值 $\\lambda_1 = \\omega_1^2$ 和 $\\lambda_2 = \\omega_2^2$，它们是固有角频率的平方。对应的特征向量 $\\mathbf{v}_1 = [v_{1,u}, v_{1,\\eta}]^\\top$ 和 $\\mathbf{v}_2 = [v_{2,u}, v_{2,\\eta}]^\\top$ 代表系统的振型。特征值按升序排列，$\\omega_1^2 \\le \\omega_2^2$。\n\n**5. 结果后处理**\n必须对特征求解器的原始结果进行处理，以满足输出规范。\n\n- **频率**：角频率 $\\omega_i$ 使用以下关系转换为以赫兹（Hz）为单位的固有频率 $f_i$：\n$$\nf_i = \\frac{\\omega_i}{2\\pi} = \\frac{\\sqrt{\\lambda_i}}{2\\pi}\n$$\n- **特征向量归一化**：问题要求质量归一化的特征向量，使得对于每个模式 $i$，满足以下条件：\n$$\n\\mathbf{v}_i^\\top \\mathbf{M}(T) \\mathbf{v}_i = 1\n$$\n许多数值求解器，包括 `scipy.linalg.eigh`，可以直接返回相对于质量矩阵 $\\mathbf{M}$ 归一化的特征向量。\n- **符号约定**：为确保每个振型的表示唯一，调整特征向量的符号，使其第一个分量（代表结构位移 $u$）为正。如果计算出的 $v_{i,u}$ 为负，则整个向量 $\\mathbf{v}_i$ 乘以 $-1$。\n\n对测试套件中的每个温度重复此过程。然后收集最终结果，并将其格式化为指定的嵌套列表结构，所有数值都四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the eigenfrequencies and mode shapes for a 2-DOF thermally coupled\n    fluid-structure interaction system at various temperatures.\n    \"\"\"\n    # Define fixed geometric and material parameters in SI units\n    A = 0.25         # Plate area (m^2)\n    h = 0.01         # Plate thickness (m)\n    H = 0.2          # Cavity height (m)\n    rho_s = 7800.0   # Solid density (kg/m^3)\n    L_eff = 0.5      # Effective structural length (m)\n    T_0 = 293.15     # Reference temperature (K)\n\n    # Reference material properties and thermal coefficients\n    rho_f0 = 998.0         # Reference fluid density (kg/m^3) at T_0\n    alpha_rho = 3.0e-4     # Thermal coefficient for fluid density (K^-1)\n    \n    E_0 = 2.0e11           # Reference Young's modulus (Pa) at T_0\n    alpha_E = 2.0e-4       # Thermal coefficient for Young's modulus (K^-1)\n    \n    K_0 = 2.2e9            # Reference fluid bulk modulus (Pa) at T_0\n    alpha_K = 5.0e-4       # Thermal coefficient for bulk modulus (K^-1)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        293.15,  # Baseline\n        333.15,  # Elevated\n        283.15,  # Reduced\n        373.15,  # High temperature\n    ]\n\n    results = []\n    # Structural mass is constant with temperature\n    m_s = rho_s * A * h\n\n    for T in test_cases:\n        # Calculate temperature-dependent properties\n        delta_T = T - T_0\n        \n        rho_f_T = rho_f0 * (1.0 - alpha_rho * delta_T)\n        E_T = E_0 * (1.0 - alpha_E * delta_T)\n        K_bulk_T = K_0 * (1.0 - alpha_K * delta_T)\n        \n        # Calculate elements of mass and stiffness matrices\n        m_f = rho_f_T * A * H\n        k_s = E_T * h * A / L_eff\n        k_f = K_bulk_T * A / H\n        \n        # Assemble mass and stiffness matrices\n        M = np.array([[m_s, 0.0], \n                      [0.0, m_f]])\n        \n        K = np.array([[k_s + k_f, -k_f], \n                      [-k_f, k_f]])\n        \n        # Solve the generalized eigenvalue problem: K*v = lambda*M*v\n        # linalg.eigh returns eigenvalues (lambda = omega^2) sorted in ascending order\n        # and corresponding eigenvectors that are M-normalized (v.T @ M @ v = 1).\n        eigenvalues, eigenvectors = linalg.eigh(K, M)\n        \n        # Convert eigenvalues (omega^2) to frequencies in Hz\n        angular_frequencies = np.sqrt(eigenvalues)\n        frequencies_hz = angular_frequencies / (2.0 * np.pi)\n        \n        f1, f2 = frequencies_hz[0], frequencies_hz[1]\n        \n        # Extract eigenvectors\n        v1 = eigenvectors[:, 0]\n        v2 = eigenvectors[:, 1]\n        \n        # Enforce sign convention: structural component (u, first element) must be positive\n        if v1[0]  0:\n            v1 = -v1\n        if v2[0]  0:\n            v2 = -v2\n            \n        # Format results to six decimal places\n        freq_list = [round(f1, 6), round(f2, 6)]\n        vec_list = [round(v1[0], 6), round(v1[1], 6), round(v2[0], 6), round(v2[1], 6)]\n        \n        # Append the formatted result for this test case\n        case_result = [freq_list, vec_list]\n        results.append(case_result)\n\n    # Convert the list of results to the required string format\n    # The str() representation of a list of lists matches the required format.\n    # We remove spaces for a compact output.\n    output_str_parts = [str(res).replace(\" \", \"\") for res in results]\n    final_output_str = f\"[{','.join(output_str_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}