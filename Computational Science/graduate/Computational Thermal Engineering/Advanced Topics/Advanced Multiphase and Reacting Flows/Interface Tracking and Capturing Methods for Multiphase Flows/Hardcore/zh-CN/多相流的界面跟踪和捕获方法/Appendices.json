{
    "hands_on_practices": [
        {
            "introduction": "在多相流的界面捕捉方法中，最核心的任务之一是精确地对流输运代表相分布的指示函数。本练习将带您回到最基本的数值对流方案，通过一个经典的方波对流问题，运用一阶迎风格式（或称施主单元格式）进行计算。通过这个实践，您将亲手体验界面在离散网格上是如何被输运的，并直观地理解数值扩散这一基本概念，这是评估和改进更高级对流格式的起点。",
            "id": "3964146",
            "problem": "一个一维流体体积法 (VOF) 指示函数 $F(x,t)$，表示液体体积分数，其值界于 $[0,1]$ 之间，满足在恒定速度场 $u$ 下的被动平流守恒律：$\\partial F / \\partial t + \\partial (u F) / \\partial x = 0$。考虑一个具有 $N=12$ 个单元的均匀有限体积网格，采用周期性边界条件，在时间层 $t^{n}$ 的单元平均值为 $F_{i}^{n}$，其中整数索引 $i \\in \\{1,2,\\dots,12\\}$。网格间距为 $\\Delta x = 1.0 \\times 10^{-3}\\ \\mathrm{m}$，速度为 $u = 2.0\\ \\mathrm{m/s}$，时间步长为 $\\Delta t = 3.0 \\times 10^{-4}\\ \\mathrm{s}$。库朗-弗里德里希-列维 (CFL) 数定义为 $\\alpha = u \\Delta t / \\Delta x$。初始数据为方波，\n- 对于 $i \\in \\{4,5,6,7\\}$，$F_{i}^{0} = 1$，\n- 对于所有其他 $i$，$F_{i}^{0} = 0$，\n索引采用周期性规则（例如，$F_{0}^{0} \\equiv F_{12}^{0}$，$F_{13}^{0} \\equiv F_{1}^{0}$）。\n\n使用带有有界一阶迎风（施主单元）数值通量的显式守恒有限体积方法，将解推进一个时间步，并计算单元 $i=8$ 中更新后的体积分数，即 $F_{8}^{1}$，其结果为一个纯数。请以精确数值形式表示最终答案，不带单位且不进行四舍五入。",
            "solution": "该问题要求计算一个由一维线性平流方程控制的流体体积法 (VOF) 指示函数 $F(x,t)$ 的更新后的单元平均值。该问题使用守恒型有限体积法进行离散化。\n\n描述被动标量 $F$ 在恒定速度 $u$ 下平流的控制偏微分方程如下：\n$$\n\\frac{\\partial F}{\\partial t} + \\frac{\\partial (u F)}{\\partial x} = 0\n$$\n由于 $u$ 是常数，方程简化为 $\\frac{\\partial F}{\\partial t} + u \\frac{\\partial F}{\\partial x} = 0$。\n有限体积法从控制体积（单元）$i$ 上的守恒律积分形式开始，该单元从界面 $x_{i-1/2}$ 延伸到 $x_{i+1/2}$，宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。将方程在单元 $i$ 上积分可得：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial F}{\\partial t} \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial (uF)}{\\partial x} \\,dx = 0\n$$\n定义单元平均值 $F_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} F(x,t) \\,dx$，并对空间导数项应用微积分基本定理，我们得到：\n$$\n\\frac{d(F_i \\Delta x)}{dt} + (uF)_{i+1/2} - (uF)_{i-1/2} = 0\n$$\n由于 $\\Delta x$ 是常数，这变为：\n$$\n\\frac{dF_i}{dt} + \\frac{1}{\\Delta x} \\left( (uF)_{i+1/2} - (uF)_{i-1/2} \\right) = 0\n$$\n此处，$(uF)_{i \\pm 1/2}$ 表示在单元界面处的 $F$ 的通量。我们使用显式前向欧拉格式对该方程进行时间离散化：\n$$\n\\frac{F_i^{n+1} - F_i^n}{\\Delta t} + \\frac{1}{\\Delta x} \\left( \\mathcal{F}_{i+1/2} - \\mathcal{F}_{i-1/2} \\right) = 0\n$$\n其中 $F_i^n$ 是时间 $t^n$ 时的单元平均值，$\\mathcal{F}_{i \\pm 1/2}$ 是在时间 $t^n$ 计算的单元面上的数值通量。对 $F_i^{n+1}$ 进行整理，得到守恒更新公式：\n$$\nF_i^{n+1} = F_i^n - \\frac{\\Delta t}{\\Delta x} \\left( \\mathcal{F}_{i+1/2} - \\mathcal{F}_{i-1/2} \\right)\n$$\n该问题指定了数值通量采用一阶迎风（施主单元）格式。给定速度 $u = 2.0\\ \\mathrm{m/s}$，为正值。对于 $u  0$，流动方向从左到右，因此界面处的 $F$ 值取自左侧单元（即“迎风”或“施主”单元）。\n因此，单元 $i$ 的右侧和左侧界面上的数值通量分别为：\n$$\n\\mathcal{F}_{i+1/2} = u F_i^n\n$$\n$$\n\\mathcal{F}_{i-1/2} = u F_{i-1}^n\n$$\n将这些表达式代入更新公式：\n$$\nF_i^{n+1} = F_i^n - \\frac{\\Delta t}{\\Delta x} \\left( u F_i^n - u F_{i-1}^n \\right)\n$$\n我们定义库朗-弗里德里希-列维 (CFL) 数为 $\\alpha = \\frac{u \\Delta t}{\\Delta x}$。更新方程变为：\n$$\nF_i^{n+1} = F_i^n - \\alpha \\left( F_i^n - F_{i-1}^n \\right) = (1 - \\alpha)F_i^n + \\alpha F_{i-1}^n\n$$\n这就是正速度下的一阶迎风格式的显式更新方程。\n\n现在，我们必须根据给定数据计算 $\\alpha$ 的值：\n- 速度：$u = 2.0\\ \\mathrm{m/s}$\n- 时间步长：$\\Delta t = 3.0 \\times 10^{-4}\\ \\mathrm{s}$\n- 网格间距：$\\Delta x = 1.0 \\times 10^{-3}\\ \\mathrm{m}$\n\n$$\n\\alpha = \\frac{(2.0) \\times (3.0 \\times 10^{-4})}{1.0 \\times 10^{-3}} = \\frac{6.0 \\times 10^{-4}}{1.0 \\times 10^{-3}} = 6.0 \\times 10^{-1} = 0.6\n$$\n问题要求计算 $F_8^1$，即从 $n=0$ 开始，经过一个时间步后单元 $i=8$ 中的体积分数。使用 $i=8$ 和 $n=0$ 的更新公式：\n$$\nF_8^1 = (1 - \\alpha)F_8^0 + \\alpha F_7^0\n$$\n我们需要初始值 $F_8^0$ 和 $F_7^0$。问题陈述的初始条件为方波：\n- 对于 $i \\in \\{4, 5, 6, 7\\}$，$F_i^0 = 1$\n- 对于所有其他 $i$，$F_i^0 = 0$\n\n根据此定义：\n- 对于单元 $i=8$，由于 $8 \\notin \\{4, 5, 6, 7\\}$，初始值为 $F_8^0 = 0$。\n- 对于单元 $i=7$，由于 $7 \\in \\{4, 5, 6, 7\\}$，初始值为 $F_7^0 = 1$。\n\n将这些值以及 $\\alpha = 0.6$ 代入 $F_8^1$ 的更新方程：\n$$\nF_8^1 = (1 - 0.6) \\times F_8^0 + 0.6 \\times F_7^0\n$$\n$$\nF_8^1 = (0.4) \\times (0) + 0.6 \\times (1)\n$$\n$$\nF_8^1 = 0 + 0.6\n$$\n$$\nF_8^1 = 0.6\n$$\n经过一个时间步后，单元 $i=8$ 中更新后的体积分数为 $0.6$。对于此特定计算，不需要周期性边界条件，因为单元8的模板（即单元7和8）没有跨越区域边界。",
            "answer": "$$\\boxed{0.6}$$"
        },
        {
            "introduction": "当计算网格单元内同时包含两种或多种流体时，如何确定该单元的等效物理属性（如粘度）是一个关键的建模问题。本练习通过一个层状流动的理想模型，引导您推导并比较两种常用平均方法——算术平均和调和平均——对计算剪切应力的影响。这个分析将揭示，对于串联排列的物理过程（如此处的动量传递），调和平均法能够提供精确的结果，从而为您在复杂多相流模拟中选择合适的物性模型提供深刻的物理洞察。",
            "id": "3964117",
            "problem": "考虑两种不相溶、不可压缩的牛顿流体，在相距为 $H$ 的两个无限大平行板之间进行稳态平面库埃特流。位于 $y=0$ 的下板静止，而位于 $y=H$ 的上板以速度 $U$ 在 $x$ 方向上平移。两流体之间的界面是平面的，位于 $y=fH$ 处，其中 $0f1$。下层流体（$0 \\le y \\le fH$）的动力粘度为 $\\mu_{1}$，上层流体（$fH \\le y \\le H$）的动力粘度为 $\\mu_{2}$。粘度比定义为 $m = \\mu_2/\\mu_1$。假设流动为蠕动流（惯性项可忽略），且流动方向上无压力梯度。在这种情况下，流体中的剪切应力 $\\tau_{xy}$ 是恒定的。\n\n在一个简化的数值模型中，整个区域被视为一个单一的有限体积单元，该单元被赋予一个有效的平均粘度 $\\mu_{\\text{avg}}$。对于给定的板速度 $U$ 和间距 $H$，求解器计算得到的数值剪切应力为 $\\tau_{\\text{num}} = \\mu_{\\text{avg}} (U/H)$。\n\n计算使用以下两种不同平均方法时，数值剪切应力的无量纲相对误差 $E = (\\tau_{\\text{num}} - \\tau_{\\text{true}})/\\tau_{\\text{true}}$：\n1.  **算术平均**：$\\mu_A = f \\mu_1 + (1-f) \\mu_2$\n2.  **调和平均**：$\\mu_H = \\left(\\frac{f}{\\mu_1} + \\frac{1-f}{\\mu_2}\\right)^{-1}$\n\n以 $f$ 和 $m$ 的形式表示每种情况下的误差 $(E_A, E_H)$。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **系统**：两种不相溶、不可压缩的牛顿流体处于稳态平面库埃特流中。\n- **几何**：两个无限大平行板，相距为 $H$。下板位于 $y=0$，上板位于 $y=H$。\n- **运动学**：下板静止，$u(0)=0$。上板以速度 $U$ 移动，$u(H)=U$。\n- **流体 1（下方）**：占据 $0 \\leq y \\leq fH$，动力粘度为 $\\mu_{1}$。\n- **流体 2（上方）**：占据 $fH \\leq y \\leq H$，动力粘度为 $\\mu_{2}$。\n- **界面**：平面，位于 $y=fH$ 处，其中 $0  f  1$。\n- **粘度比**：$m = \\mu_{2}/\\mu_{1}  0$。\n- **流动条件**：惯性可忽略（蠕动流），无压力梯度。\n- **本构定律**：剪切应力 $\\tau_{xy}=\\mu\\,\\frac{du}{dy}$。\n- **数值模型**：单单元、混合属性模型，有效粘度为 $\\mu_{\\text{avg}}$。\n- **平均方法**：\n  - 算术平均：$\\mu_{A} = f\\,\\mu_{1} + (1-f)\\,\\mu_{2}$。\n  - 调和平均：$\\mu_{H} = \\left(f/\\mu_{1} + (1-f)/\\mu_{2}\\right)^{-1}$。\n- **数值应力**：求解器计算 $\\tau_{\\text{num}}=\\mu_{\\text{avg}}\\,\\frac{U}{H}$。\n- **要求输出**：每种平均选择下，以 $f$ 和 $m$ 表示的无量纲相对误差 $E = \\frac{\\tau_{\\text{num}} - \\tau_{\\text{true}}}{\\tau_{\\text{true}}}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础**：该问题描述了层流流体动力学的一个经典案例（分层库埃特流），该案例严格基于在明确定义的简化假设（稳态、不可压缩、无惯性、无压力梯度）下的纳维-斯托克斯方程。用于有效属性的算术和调和平均概念是计算多相流和均匀化理论领域的标准方法。该问题在科学上是合理的。\n- **适定性**：该问题提供了求解速度剖面和剪切应力所需的所有必要边界条件（$u(0)=0$，$u(H)=U$）和界面条件（速度和应力连续）。设置是完整且一致的，确保存在唯一且有意义的解。\n- **客观性**：该问题使用精确、无歧义的数学和物理术语进行陈述。没有主观或基于意见的元素。\n\n### 第 3 步：结论与行动\n该问题被认为是有效的，因为它具有科学基础、适定性和客观性。将推导解答。\n\n### 精确剪切应力 $\\tau_{\\text{true}}$ 的推导\n对于仅有 $x$ 方向速度 $u(y)$ 且无压力梯度的稳态、完全发展的平面流，线性动量守恒方程简化为：\n$$\n\\frac{d}{dy}\\left(\\mu \\frac{du}{dy}\\right) = 0\n$$\n该方程意味着剪切应力 $\\tau_{xy} = \\mu \\frac{du}{dy}$ 在整个区域 $0 \\leq y \\leq H$ 内必须是常数。我们将此常数、精确的剪切应力表示为 $\\tau_{\\text{true}}$。\n\n在每个流体层中，速度梯度是恒定的：\n- 对于流体 1（$0 \\leq y \\leq fH$）：$\\frac{du_1}{dy} = \\frac{\\tau_{\\text{true}}}{\\mu_1}$。\n- 对于流体 2（$fH \\leq y \\leq H$）：$\\frac{du_2}{dy} = \\frac{\\tau_{\\text{true}}}{\\mu_2}$。\n\n对这些方程关于 $y$ 积分，得到速度剖面：\n- $u_1(y) = \\frac{\\tau_{\\text{true}}}{\\mu_1}y + C_1$\n- $u_2(y) = \\frac{\\tau_{\\text{true}}}{\\mu_2}y + C_2$\n\n我们应用边界条件和界面条件来确定常数 $C_1$、$C_2$ 和 $\\tau_{\\text{true}}$。\n1. 下板处的无滑移条件：$u_1(0) = 0$。\n$$\n\\frac{\\tau_{\\text{true}}}{\\mu_1}(0) + C_1 = 0 \\implies C_1 = 0\n$$\n因此，$u_1(y) = \\frac{\\tau_{\\text{true}}}{\\mu_1}y$。\n\n2. 界面 $y=fH$ 处速度连续：$u_1(fH) = u_2(fH)$。\n$$\n\\frac{\\tau_{\\text{true}}}{\\mu_1}(fH) = \\frac{\\tau_{\\text{true}}}{\\mu_2}(fH) + C_2 \\implies C_2 = \\tau_{\\text{true}}fH\\left(\\frac{1}{\\mu_1} - \\frac{1}{\\mu_2}\\right)\n$$\n\n3. 上板处的无滑移条件：$u_2(H) = U$。\n$$\nU = u_2(H) = \\frac{\\tau_{\\text{true}}}{\\mu_2}H + C_2\n$$\n代入 $C_2$ 的表达式：\n$$\nU = \\frac{\\tau_{\\text{true}}}{\\mu_2}H + \\tau_{\\text{true}}fH\\left(\\frac{1}{\\mu_1} - \\frac{1}{\\mu_2}\\right)\n$$\n$$\nU = \\tau_{\\text{true}}H \\left[ \\frac{1}{\\mu_2} + \\frac{f}{\\mu_1} - \\frac{f}{\\mu_2} \\right] = \\tau_{\\text{true}}H \\left[ \\frac{f}{\\mu_1} + \\frac{1-f}{\\mu_2} \\right]\n$$\n求解精确剪切应力 $\\tau_{\\text{true}}$：\n$$\n\\tau_{\\text{true}} = \\frac{U}{H \\left( \\frac{f}{\\mu_1} + \\frac{1-f}{\\mu_2} \\right)}\n$$\n使用粘度比 $m = \\mu_2/\\mu_1$，我们可以写出 $\\mu_2 = m\\mu_1$。\n$$\n\\tau_{\\text{true}} = \\frac{U}{H \\left( \\frac{f}{\\mu_1} + \\frac{1-f}{m\\mu_1} \\right)} = \\frac{U\\mu_1}{H \\left( f + \\frac{1-f}{m} \\right)} = \\frac{U\\mu_1 m}{H (mf + 1 - f)} = \\frac{U\\mu_1 m}{H(1 + f(m-1))}\n$$\n\n### 相对误差 $E$ 的推导\n数值模型假设存在一种粘度为 $\\mu_{\\text{avg}}$ 的单一流体，并预测均匀剪切率为 $\\frac{U}{H}$。数值计算的剪切应力由下式给出：\n$$\n\\tau_{\\text{num}} = \\mu_{\\text{avg}} \\frac{U}{H}\n$$\n相对误差 $E$ 定义为：\n$$\nE = \\frac{\\tau_{\\text{num}} - \\tau_{\\text{true}}}{\\tau_{\\text{true}}} = \\frac{\\tau_{\\text{num}}}{\\tau_{\\text{true}}} - 1\n$$\n代入 $\\tau_{\\text{num}}$ 和 $\\tau_{\\text{true}}$ 的表达式：\n$$\n\\frac{\\tau_{\\text{num}}}{\\tau_{\\text{true}}} = \\frac{\\mu_{\\text{avg}} \\frac{U}{H}}{\\frac{U\\mu_1 m}{H(1 + f(m-1))}} = \\frac{\\mu_{\\text{avg}}}{\\mu_1} \\frac{1 + f(m-1)}{m}\n$$\n所以，误差的通用表达式是：\n$$\nE = \\left(\\frac{\\mu_{\\text{avg}}}{\\mu_1}\\right) \\frac{1 + f(m-1)}{m} - 1\n$$\n\n### 情况 1：算术平均 ($E_A$)\n对于算术平均，$\\mu_{\\text{avg}} = \\mu_A = f\\mu_1 + (1-f)\\mu_2$。\n比值 $\\mu_A/\\mu_1$ 为：\n$$\n\\frac{\\mu_A}{\\mu_1} = \\frac{f\\mu_1 + (1-f)\\mu_2}{\\mu_1} = f + (1-f)\\frac{\\mu_2}{\\mu_1} = f + (1-f)m\n$$\n将此代入误差表达式中：\n$$\nE_A = (f + (1-f)m) \\frac{1 + f(m-1)}{m} - 1\n$$\n$$\nE_A = \\frac{(f(1-m)+m)(1+f(m-1))}{m} - 1\n$$\n展开分子并减去 $m$：\n$$\n\\text{分子} - m = [f(1-m)+m] [1+f(m-1)] - m\n$$\n$$\n= f(1-m) + f^2(1-m)(m-1) + m + mf(m-1) - m\n$$\n$$\n= -f(m-1) - f^2(m-1)^2 + mf(m-1)\n$$\n$$\n= f(m-1)[-1 - f(m-1) + m] = f(m-1)[m-1 - f(m-1)]\n$$\n$$\n= f(m-1)(m-1)(1-f) = f(1-f)(m-1)^2\n$$\n因此，误差为：\n$$\nE_A = \\frac{f(1-f)(m-1)^2}{m}\n$$\n\n### 情况 2：调和平均 ($E_H$)\n对于调和平均，$\\mu_{\\text{avg}} = \\mu_H = \\left(\\frac{f}{\\mu_1} + \\frac{1-f}{\\mu_2}\\right)^{-1}$。\n比值 $\\mu_H/\\mu_1$ 为：\n$$\n\\frac{\\mu_H}{\\mu_1} = \\frac{1}{\\mu_1}\\left(\\frac{f}{\\mu_1} + \\frac{1-f}{\\mu_2}\\right)^{-1} = \\left(\\mu_1\\left(\\frac{f}{\\mu_1} + \\frac{1-f}{m\\mu_1}\\right)\\right)^{-1}\n$$\n$$\n\\frac{\\mu_H}{\\mu_1} = \\left(f + \\frac{1-f}{m}\\right)^{-1} = \\left(\\frac{mf + 1-f}{m}\\right)^{-1} = \\frac{m}{1 + f(m-1)}\n$$\n将此代入通用误差表达式中：\n$$\nE_H = \\left(\\frac{m}{1 + f(m-1)}\\right) \\frac{1 + f(m-1)}{m} - 1\n$$\n$$\nE_H = 1 - 1 = 0\n$$\n调和平均法精确地再现了该问题的真实剪切应力，导致误差为零。这是因为就动量输运而言，流体层是串联排列的，而调和平均值能正确计算串联构型的有效属性。\n\n最终结果是 $(E_A, E_H)$ 对。\n$E_A = \\frac{f(1-f)(m-1)^2}{m}$\n$E_H = 0$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{f(1-f)(m-1)^{2}}{m}  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在包含表面张力的多相流模拟中，“寄生流”或“虚假流”是一个长期存在的数值挑战，它源于压力梯度和表面张力在离散层面上的不平衡。本练习将指导您设计并验证一种“力平衡”的离散格式，旨在从根本上消除静态界面上的这些非物理流动。通过对比平衡与非平衡格式的残差，您将清楚地看到，保持离散算子的一致性对于精确模拟表面张力主导的物理现象至关重要，这也是现代计算多相流方法中的一个前沿主题。",
            "id": "3964091",
            "problem": "考虑一个周期性方形域中的二维、不可混溶、不可压缩、等温的静态构型，其中两相由一个圆形界面分隔。目标是在同位网格上设计并验证一种压力梯度和表面张力的平衡离散化方法，该方法能在没有运动的情况下最小化伪电流。推导和实现应从第一性原理和广为接受的事实出发，而不是将任何目标公式作为给定条件。\n\n物理和数值设置如下。\n\n- 域：边长为 $L$ 的正方形，两个方向均采用周期性边界条件。在无量纲单位中，使用 $L = 1$。\n- 界面：半径为 $R = 0.25$ 的圆，圆心位于 $(x_c, y_c) = (0.5, 0.5)$。\n- 表面张力系数：$\\sigma = 1$（无量纲）。\n- 密度和粘度：取均匀密度 $\\rho = 1$（无量纲），并忽略粘度，因为速度是静态的，粘性项为零。\n- 网格：一个包含 $N \\times N$ 个控制体的均匀同位网格，未知量位于单元中心，单元尺寸为 $\\Delta x = \\Delta y = L / N$。对于整数 $i,j \\in [0, N-1]$，单元中心的坐标为 $(x_i, y_j) = \\big((i+0.5)\\Delta x, (j+0.5)\\Delta y\\big)$。在计算离散导数时应强制执行周期性。\n\n从静态情况下不可压缩流的线性动量基本平衡方程出发，该方程通过 Continuum Surface Force (CSF) 方法引入了表面张力：\n$$\n\\mathbf{0} = -\\nabla p + \\mathbf{f}_\\sigma,\n$$\n其中 $\\mathbf{f}_\\sigma$ 是表面张力密度。对于尖锐界面连续模型，圆的平均曲率 $ \\kappa $ 是一个常数，为 $ \\kappa = 1/R $。在平衡状态下，要实现连续抵消，一个充分条件是将毛细作用贡献表示为压力跳跃，该跳跃通过基于到界面的符号距离 $\\phi$ 的平滑亥维赛函数 $H_\\varepsilon(\\phi)$ 进行编码：\n$$\np(\\mathbf{x}) = p_0 + \\sigma \\kappa \\, H_\\varepsilon(\\phi(\\mathbf{x})), \\quad \\mathbf{f}_\\sigma(\\mathbf{x}) = \\sigma \\kappa \\, \\nabla H_\\varepsilon(\\phi(\\mathbf{x})),\n$$\n因此在连续设定中 $-\\nabla p + \\mathbf{f}_\\sigma = \\mathbf{0}$。这里 $H_\\varepsilon$ 是正则化的亥维赛函数，其平滑半厚度为 $\\varepsilon$，$\\phi(\\mathbf{x})$ 定义为到界面的符号距离（圆内为负，圆外为正）。\n\n您的任务是构建一个同位有限体积/有限差分离散化方法，在离散设定中实现同样的抵消，并达到机器精度。具体而言：\n\n1. 在单元中心上定义符号距离场 $\\phi(x,y) = \\sqrt{(x-x_c)^2+(y-y_c)^2} - R$。\n2. 定义正则化的亥维赛函数 $H_\\varepsilon(\\phi)$，其平滑半厚度为 $\\varepsilon$，如下所示：\n   $$\n   H_\\varepsilon(\\phi) =\n   \\begin{cases}\n   0,  \\phi \\le -\\varepsilon, \\\\\n   \\frac{1}{2}\\left[1 + \\frac{\\phi}{\\varepsilon} + \\frac{1}{\\pi}\\sin\\left(\\pi \\frac{\\phi}{\\varepsilon}\\right)\\right],  |\\phi|  \\varepsilon, \\\\\n   1,  \\phi \\ge \\varepsilon.\n   \\end{cases}\n   $$\n3. 使用解析曲率 $\\kappa = 1/R$（常数）。\n4. 在单元中心上将离散压力场定义为 $p = \\sigma \\kappa H_\\varepsilon(\\phi)$。\n5. 在同位网格上使用带周期性环绕的二阶中心差分定义一个离散梯度算子：\n   $$\n   \\left[\\nabla_h q\\right]_x(i,j) = \\frac{q(i+1,j)-q(i-1,j)}{2\\Delta x}, \\quad\n   \\left[\\nabla_h q\\right]_y(i,j) = \\frac{q(i,j+1)-q(i,j-1)}{2\\Delta y}.\n   $$\n   在平衡离散化中，对压力梯度和亥维赛场的梯度使用相同的算子。\n6. 构建两个离散力残差 $\\mathbf{r}(i,j)$，定义为单位密度下的静态动量平衡中的不匹配量：\n   - 平衡方案：\n     $$\n     \\mathbf{r}_\\text{bal}(i,j) = -\\nabla_h p(i,j) + \\sigma \\kappa \\, \\nabla_h H_\\varepsilon(\\phi)(i,j).\n     $$\n   - 非平衡方案（用于比较）：使用相同的 $\\nabla_h$ 计算 $-\\nabla_h p$，但使用带周期性环绕的一阶向前差分来近似 $\\nabla H_\\varepsilon$，\n     $$\n     \\left[\\nabla^{+} q\\right]_x(i,j) = \\frac{q(i+1,j)-q(i,j)}{\\Delta x}, \\quad\n     \\left[\\nabla^{+} q\\right]_y(i,j) = \\frac{q(i,j+1)-q(i,j)}{\\Delta y},\n     $$\n     并定义\n     $$\n     \\mathbf{r}_\\text{unbal}(i,j) = -\\nabla_h p(i,j) + \\sigma \\kappa \\, \\nabla^{+} H_\\varepsilon(\\phi)(i,j).\n     $$\n7. 对每个残差场，计算所有单元上的最大欧几里得范数，\n   $$\n   \\|\\mathbf{r}\\|_{\\infty,2} = \\max_{i,j} \\sqrt{r_x(i,j)^2 + r_y(i,j)^2}.\n   $$\n\n所有量都是无量纲的；输出中不使用物理单位。\n\n测试套件和要求输出：\n\n- 使用上述域和参数进行以下三个测试用例。对于每个用例，将平滑定义为 $\\varepsilon = \\alpha \\Delta x$，其中 $\\alpha$ 是一个无量纲因子。\n  - A用例（理想路径）：$N = 64$，$\\alpha = 1.5$。\n  - B用例（粗网格边界情况）：$N = 16$，$\\alpha = 1.5$。\n  - C用例（欠解析界面边缘情况）：$N = 32$，$\\alpha = 0.5$。\n- 对于每个用例，计算三个浮点数：平衡残差范数 $\\|\\mathbf{r}_\\text{bal}\\|_{\\infty,2}$、非平衡残差范数 $\\|\\mathbf{r}_\\text{unbal}\\|_{\\infty,2}$ 以及它们的比率 $\\|\\mathbf{r}_\\text{bal}\\|_{\\infty,2} / \\|\\mathbf{r}_\\text{unbal}\\|_{\\infty,2}$。\n\n最终输出格式规范：\n\n- 您的程序应生成单行输出，其中包含按以下顺序排列的九个浮点数列表\n  $$\n  \\big[\\|\\mathbf{r}_\\text{bal}\\|_{\\infty,2}^{(A)}, \\|\\mathbf{r}_\\text{unbal}\\|_{\\infty,2}^{(A)}, \\rho^{(A)}, \\|\\mathbf{r}_\\text{bal}\\|_{\\infty,2}^{(B)}, \\|\\mathbf{r}_\\text{unbal}\\|_{\\infty,2}^{(B)}, \\rho^{(B)}, \\|\\mathbf{r}_\\text{bal}\\|_{\\infty,2}^{(C)}, \\|\\mathbf{r}_\\text{unbal}\\|_{\\infty,2}^{(C)}, \\rho^{(C)}\\big],\n  $$\n  其中 $\\rho^{(\\cdot)}$ 表示相应用例的比率。该列表必须打印为用方括号括起来的逗号分隔列表，不含任何额外文本，例如：“[1.0,2.0,0.5, ...]”。",
            "solution": "问题陈述经评估有效。它在科学上基于多相流计算流体动力学的原理，特别是关于表面张力的数值处理。该问题是适定的、客观的、自洽的，并在验证平衡力离散化方案的特性方面提出了一个非凡的挑战。\n\n主要目标是证明对压力梯度和表面张力进行一致的（或“平衡的”）离散化，对于消除静态界面上的伪电流至关重要。我们从静态、不可压缩动量方程开始，该方程表示压力梯度力与表面张力密度 $\\mathbf{f}_\\sigma$ 之间的平衡：\n$$\n\\mathbf{0} = -\\nabla p + \\mathbf{f}_\\sigma\n$$\n在 Continuum Surface Force (CSF) 模型中，仅作用于界面的表面张力被表示为作用在界面周围一个薄区域内的体积力密度。这是通过使用正则化的狄拉克δ函数实现的，该函数可以表示为正则化亥维赛函数 $H_\\varepsilon(\\phi)$ 的梯度，其中 $\\phi$ 是到界面的符号距离函数。力密度由 $\\mathbf{f}_\\sigma = \\sigma \\kappa \\mathbf{n} \\delta_\\varepsilon(\\phi) = \\sigma \\kappa \\nabla H_\\varepsilon(\\phi)$ 给出，其中 $\\sigma$ 是表面张力系数，$\\kappa$ 是界面平均曲率。\n\n对于静态圆形界面，曲率 $\\kappa$ 是恒定的，等于 $1/R$。杨-拉普拉斯方程规定，界面两侧存在一个等于 $\\sigma \\kappa$ 的压力跳跃。这可以通过将压力场定义为 $p(\\mathbf{x}) = p_0 + \\sigma \\kappa H_\\varepsilon(\\phi(\\mathbf{x}))$ 来连续表示，其中 $p_0$ 是参考压力。由于常数 $p_0$ 的梯度为零，可以将其舍去，动量平衡方程变为：\n$$\n\\mathbf{0} = -\\nabla (\\sigma \\kappa H_\\varepsilon(\\phi)) + \\sigma \\kappa \\nabla H_\\varepsilon(\\phi)\n$$\n由于 $\\sigma$ 和 $\\kappa$ 是常数，梯度算子对乘积满足分配律，得出 $-\\sigma \\kappa \\nabla H_\\varepsilon(\\phi) + \\sigma \\kappa \\nabla H_\\varepsilon(\\phi) = \\mathbf{0}$。这在连续设定中展示了完美的平衡。我们的目标是在离散设定中保持这种平衡。\n\n数值实现过程如下：\n\n1.  **网格和场生成**：我们在域 $[0, L] \\times [0, L]$（其中 $L=1$）上定义一个大小为 $N \\times N$ 的均匀同位网格。单元中心位于 $(x_i, y_j) = ((i+0.5)\\Delta x, (j+0.5)\\Delta y)$，对于 $i,j \\in [0, N-1]$，其中 $\\Delta x = \\Delta y = L/N$。在每个单元中心，我们计算到圆心为 $(x_c, y_c) = (0.5, 0.5)$、半径为 $R=0.25$ 的圆的符号距离函数 $\\phi_{i,j}$：\n    $$\n    \\phi_{i,j} = \\sqrt{(x_i - x_c)^2 + (y_j - y_c)^2} - R\n    $$\n    使用 $\\phi_{i,j}$，我们根据提供的分段公式计算离散的正则化亥维赛场 $H_{\\varepsilon}(\\phi_{i,j})$，平滑宽度为 $\\varepsilon = \\alpha \\Delta x$。\n\n2.  **离散压力和算子**：离散压力场在单元中心定义为 $p_{i,j} = \\sigma \\kappa H_{\\varepsilon}(\\phi_{i,j})$，其中 $\\sigma=1$ 且 $\\kappa = 1/R = 4$。我们使用两种类型的离散梯度算子。二阶中心差分算子 $\\nabla_h$ 定义为：\n    $$\n    \\left[\\nabla_h q\\right]_x(i,j) = \\frac{q_{i+1,j}-q_{i-1,j}}{2\\Delta x}, \\quad\n    \\left[\\nabla_h q\\right]_y(i,j) = \\frac{q_{i,j+1}-q_{i,j-1}}{2\\Delta y}\n    $$\n    一阶向前差分算子 $\\nabla^{+}$ 定义为：\n    $$\n    \\left[\\nabla^{+} q\\right]_x(i,j) = \\frac{q_{i+1,j}-q_{i,j}}{\\Delta x}, \\quad\n    \\left[\\nabla^{+} q\\right]_y(i,j) = \\frac{q_{i,j+1}-q_{i,j}}{\\Delta y}\n    $$\n    通过对索引使用模运算来强制执行周期性（例如，$q_{N,j} = q_{0,j}$）。\n\n3.  **残差计算**：我们计算平衡和非平衡方案的残差。\n    -   **平衡方案**：压力梯度和表面张力都使用相同的算子 $\\nabla_h$ 进行离散化：\n        $$\n        \\mathbf{r}_\\text{bal}(i,j) = -\\nabla_h p_{i,j} + \\sigma \\kappa \\, \\nabla_h H_\\varepsilon(\\phi_{i,j})\n        $$\n        代入 $p_{i,j} = \\sigma \\kappa H_{\\varepsilon}(\\phi_{i,j})$ 并利用离散算子 $\\nabla_h$ 的线性性质：\n        $$\n        \\mathbf{r}_\\text{bal}(i,j) = -\\nabla_h (\\sigma \\kappa H_{\\varepsilon}(\\phi_{i,j})) + \\sigma \\kappa \\, \\nabla_h H_\\varepsilon(\\phi_{i,j}) = -\\sigma \\kappa \\nabla_h H_{\\varepsilon}(\\phi_{i,j}) + \\sigma \\kappa \\, \\nabla_h H_\\varepsilon(\\phi_{i,j}) = \\mathbf{0}\n        $$\n        这种离散抵消在代数上是精确的。任何非零结果都仅由有限精度浮点运算引起，应在机器精度的量级上。\n\n    -   **非平衡方案**：压力梯度使用 $\\nabla_h$ 离散化，而表面张力项则使用 $\\nabla^{+}$ 近似：\n        $$\n        \\mathbf{r}_\\text{unbal}(i,j) = -\\nabla_h p_{i,j} + \\sigma \\kappa \\, \\nabla^{+} H_\\varepsilon(\\phi_{i,j})\n        $$\n        代入 $p_{i,j}$：\n        $$\n        \\mathbf{r}_\\text{unbal}(i,j) = -\\sigma \\kappa \\nabla_h H_{\\varepsilon}(\\phi_{i,j}) + \\sigma \\kappa \\, \\nabla^{+} H_\\varepsilon(\\phi_{i,j}) = \\sigma \\kappa \\left( \\nabla^{+} H_\\varepsilon(\\phi_{i,j}) - \\nabla_h H_\\varepsilon(\\phi_{i,j}) \\right)\n        $$\n        由于 $\\nabla_h$ 和 $\\nabla^{+}$ 是具有不同截断误差的不同离散算子，它们的差值不为零。$\\nabla^{+}$ 的截断误差为 $O(\\Delta x)$，而 $\\nabla_h$ 的截断误差为 $O(\\Delta x^2)$。因此，它们的差值为 $O(\\Delta x)$，导致一个显著的残差，该残差不会随着网格细化而消失，从而在瞬态模拟中引起伪电流。\n\n4.  **范数计算**：对于每个残差场 $\\mathbf{r}(i,j) = (r_x(i,j), r_y(i,j))$，我们计算网格上的最大离散 L2 范数：\n    $$\n    \\|\\mathbf{r}\\|_{\\infty,2} = \\max_{i,j} \\sqrt{r_x(i,j)^2 + r_y(i,j)^2}\n    $$\n    该度量量化了最大局部力不平衡的大小。为每个测试用例计算的结果将定量验证平衡力方法的优越性。对于所有情况，$\\|\\mathbf{r}_\\text{bal}\\|_{\\infty,2}$ 预计将接近机器精度，而 $\\|\\mathbf{r}_\\text{unbal}\\|_{\\infty,2}$ 将大几个数量级。因此，比率 $\\|\\mathbf{r}_\\text{bal}\\|_{\\infty,2} / \\|\\mathbf{r}_\\text{unbal}\\|_{\\infty,2}$ 将会非常小。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the balanced-force discretization problem for three test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (64, 1.5),  # Case A\n        (16, 1.5),  # Case B\n        (32, 0.5),  # Case C\n    ]\n\n    results = []\n    \n    # Common parameters\n    L = 1.0\n    R = 0.25\n    xc, yc = 0.5, 0.5\n    sigma = 1.0\n    kappa = 1.0 / R\n\n    for N, alpha in test_cases:\n        # 1. Grid and Field Generation\n        dx = L / N\n        \n        # Create cell-centered grid coordinates\n        grid_1d = (np.arange(N) + 0.5) * dx\n        x, y = np.meshgrid(grid_1d, grid_1d)\n\n        # Calculate signed distance field\n        phi = np.sqrt((x - xc)**2 + (y - yc)**2) - R\n        \n        # Calculate regularized Heaviside function H_eps\n        eps = alpha * dx\n        H = np.zeros_like(phi)\n        \n        # Region phi >= eps\n        H[phi >= eps] = 1.0\n        \n        # Region |phi|  eps\n        mask = np.abs(phi)  eps\n        phi_masked = phi[mask]\n        H[mask] = 0.5 * (1.0 + phi_masked / eps + (1.0 / np.pi) * np.sin(np.pi * phi_masked / eps))\n\n        # 2. Discrete Pressure\n        p = sigma * kappa * H\n\n        # 3. Discrete Gradient Operators (with periodic boundaries)\n        def grad_central(q, delta):\n            gx = (np.roll(q, -1, axis=1) - np.roll(q, 1, axis=1)) / (2.0 * delta)\n            gy = (np.roll(q, -1, axis=0) - np.roll(q, 1, axis=0)) / (2.0 * delta)\n            return gx, gy\n\n        def grad_forward(q, delta):\n            gx = (np.roll(q, -1, axis=1) - q) / delta\n            gy = (np.roll(q, -1, axis=0) - q) / delta\n            return gx, gy\n\n        # 4. Residual Calculation\n        # Pressure gradient using central differences for both schemes\n        grad_p_x, grad_p_y = grad_central(p, dx)\n\n        # Balanced scheme\n        grad_H_bal_x, grad_H_bal_y = grad_central(H, dx)\n        res_bal_x = -grad_p_x + sigma * kappa * grad_H_bal_x\n        res_bal_y = -grad_p_y + sigma * kappa * grad_H_bal_y\n\n        # Unbalanced scheme\n        grad_H_unbal_x, grad_H_unbal_y = grad_forward(H, dx)\n        res_unbal_x = -grad_p_x + sigma * kappa * grad_H_unbal_x\n        res_unbal_y = -grad_p_y + sigma * kappa * grad_H_unbal_y\n\n        # 5. Norm Computation\n        norm_bal = np.max(np.sqrt(res_bal_x**2 + res_bal_y**2))\n        norm_unbal = np.max(np.sqrt(res_unbal_x**2 + res_unbal_y**2))\n        \n        # Handle potential division by zero if norm_unbal is zero\n        # (unlikely, but good practice)\n        ratio = norm_bal / norm_unbal if norm_unbal != 0 else 0.0\n\n        results.extend([norm_bal, norm_unbal, ratio])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}