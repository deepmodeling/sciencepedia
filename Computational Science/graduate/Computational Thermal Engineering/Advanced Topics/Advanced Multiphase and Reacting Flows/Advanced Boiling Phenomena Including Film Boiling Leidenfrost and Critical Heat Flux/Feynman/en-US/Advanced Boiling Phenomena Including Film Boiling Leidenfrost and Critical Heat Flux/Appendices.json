{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds our study in the fundamental physics governing the onset of boiling. Before vigorous boiling can occur, vapor bubbles must first form and grow from microscopic cavities on a heated surface. This exercise guides you through a first-principles derivation to determine the minimum wall superheat, $\\Delta T_{ONB}$, required to activate a nucleation site of a given size, bridging the gap between macroscopic heat transfer and microscopic surface phenomena . Mastering this derivation provides a critical understanding of how surface tension and thermodynamic properties control the very inception of nucleate boiling.",
            "id": "3935447",
            "problem": "A smooth heated metal surface in contact with liquid water at $1$ atmosphere exhibits the Onset of Nucleate Boiling (ONB) when a vapor bubble can stably grow from a pre-existing surface cavity. Consider a single cavity with mouth radius $r$ that hosts a vapor nucleus. Assume the surrounding liquid is at its saturation temperature $T_{sat}$ and the incipient bubble, initially constrained by the cavity, has a radius comparable to the cavity mouth. The stability of the bubble at ONB requires that the additional pressure inside the bubble needed to balance the capillary pressure is provided by the increase in saturation pressure resulting from the wall superheat $\\Delta T_{ONB} = T_{w}-T_{sat}$, where $T_{w}$ is the wall temperature at ONB.\n\nStarting only from the following fundamental bases:\n- The mechanical equilibrium of a curved interface imposes a capillary (Laplace) pressure jump: $p_{v} - p_{l} = 2\\sigma/r$, where $p_{v}$ is the vapor pressure inside the bubble, $p_{l}$ is the liquid pressure, $\\sigma$ is the liquid-vapor surface tension, and $r$ is the radius of curvature (taken here as the cavity mouth radius).\n- The Clausius–Clapeyron relation for the saturation curve gives $\\mathrm{d}p_{sat}/\\mathrm{d}T = h_{fg}/(T\\,\\Delta v)$, where $p_{sat}(T)$ is the saturation pressure as a function of temperature $T$, $h_{fg}$ is the latent heat of vaporization, and $\\Delta v = v_{v}-v_{l}$ is the specific volume change between vapor and liquid. In saturated boiling of water near atmospheric pressure, take $\\Delta v \\approx v_{v}$ so that $\\mathrm{d}p_{sat}/\\mathrm{d}T \\approx h_{fg}\\rho_{v}/T$, with $\\rho_{v}$ the saturated vapor density.\n\nDerive an expression for the minimum wall superheat $\\Delta T_{ONB}$ required to activate a cavity of radius $r$, and then compute its numerical value for water at $1$ atmosphere with the following properties: $\\sigma=0.058$ $\\mathrm{N/m}$, $h_{fg}=2.26\\times 10^{6}$ $\\mathrm{J/kg}$, $\\rho_{v}=0.6$ $\\mathrm{kg/m^{3}}$, $T_{sat}=373$ $\\mathrm{K}$, and $r=5\\times 10^{-6}$ $\\mathrm{m}$. Express the final superheat in $\\mathrm{K}$ and round your answer to four significant figures. As part of your reasoning, qualitatively comment on the sensitivity of $\\Delta T_{ONB}$ to $r$ based on your derived expression; the final numerical answer need only be the computed $\\Delta T_{ONB}$.",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the principles of thermodynamics and fluid mechanics concerning phase change, is well-posed with sufficient information, and uses objective, formal language. The problem asks for the derivation of a standard model for the onset of nucleate boiling, which is a core concept in boiling heat transfer.\n\nThe fundamental condition for the onset of nucleate boiling (ONB) from a pre-existing cavity is that the vapor nucleus must be in mechanical and thermal equilibrium. This equilibrium is unstable, such that any slight increase in wall temperature will cause the bubble to grow.\n\nThe mechanical equilibrium of the hemispherical vapor nucleus at the mouth of the cavity is governed by the Young-Laplace equation. This equation states that the pressure difference across the curved interface is balanced by surface tension. For a bubble of radius $r$, this is given as:\n$$\np_v - p_l = \\frac{2\\sigma}{r}\n$$\nwhere $p_v$ is the pressure of the vapor inside the nucleus, $p_l$ is the pressure of the liquid surrounding it, and $\\sigma$ is the surface tension. The problem assumes the bubble radius is equal to the cavity mouth radius $r$.\n\nThe thermal condition dictates the pressures involved. The vapor inside the nucleus is assumed to be in thermal equilibrium with the heated wall, which is at a temperature $T_w$. Therefore, the vapor is saturated at this temperature, and its pressure is the corresponding saturation pressure, $p_v = p_{sat}(T_w)$. The surrounding liquid is at the bulk saturation temperature $T_{sat}$, so the pressure in the liquid far from the wall is $p_l = p_{sat}(T_{sat})$. The problem defines the wall superheat as $\\Delta T_{ONB} = T_w - T_{sat}$.\n\nSubstituting these pressure definitions into the Young-Laplace equation yields the core relationship for bubble stability:\n$$\np_{sat}(T_w) - p_{sat}(T_{sat}) = \\frac{2\\sigma}{r}\n$$\nThis equation shows that the pressure difference required to sustain the curved interface must be generated by the increase in saturation pressure due to the wall superheat.\n\nThe wall superheat $\\Delta T_{ONB}$ required for ONB is typically small. This allows us to approximate the change in saturation pressure, $p_{sat}(T_w) - p_{sat}(T_{sat})$, using a first-order Taylor expansion of the saturation pressure function $p_{sat}(T)$ around the temperature $T_{sat}$:\n$$\np_{sat}(T_w) - p_{sat}(T_{sat}) \\approx \\left(\\frac{\\mathrm{d}p_{sat}}{\\mathrm{d}T}\\right)_{T=T_{sat}} (T_w - T_{sat})\n$$\nThe derivative $\\frac{\\mathrm{d}p_{sat}}{\\mathrm{d}T}$ is given by the Clausius-Clapeyron relation. The problem provides the specific form for water near atmospheric pressure:\n$$\n\\frac{\\mathrm{d}p_{sat}}{\\mathrm{d}T} \\approx \\frac{h_{fg}\\rho_v}{T}\n$$\nwhere $h_{fg}$ is the latent heat of vaporization, $\\rho_v$ is the saturated vapor density, and $T$ is the absolute temperature. Evaluating this derivative at $T = T_{sat}$, we have:\n$$\n\\left(\\frac{\\mathrm{d}p_{sat}}{\\mathrm{d}T}\\right)_{T=T_{sat}} \\approx \\frac{h_{fg}\\rho_v}{T_{sat}}\n$$\nSubstituting this into the Taylor expansion for the pressure difference:\n$$\np_{sat}(T_w) - p_{sat}(T_{sat}) \\approx \\frac{h_{fg}\\rho_v}{T_{sat}} (T_w - T_{sat}) = \\frac{h_{fg}\\rho_v}{T_{sat}} \\Delta T_{ONB}\n$$\nNow, we equate the two expressions for the pressure difference: the one from mechanical equilibrium and the one from thermodynamic considerations.\n$$\n\\frac{h_{fg}\\rho_v}{T_{sat}} \\Delta T_{ONB} = \\frac{2\\sigma}{r}\n$$\nSolving this equation for the minimum wall superheat, $\\Delta T_{ONB}$, gives the desired expression:\n$$\n\\Delta T_{ONB} = \\frac{2\\sigma T_{sat}}{h_{fg}\\rho_v r}\n$$\nThis is the well-known Hsu-Rohsenow-Bergles criterion for the incipience of boiling.\n\nQualitatively, this expression reveals the sensitivity of $\\Delta T_{ONB}$ to the cavity radius $r$. The required superheat for activation is inversely proportional to the radius of the nucleation site: $\\Delta T_{ONB} \\propto \\frac{1}{r}$. This means that smaller cavities require a larger wall superheat to become active. As the heat flux to a surface is increased, the wall temperature rises, and progressively smaller cavities are activated, leading to an increase in the number of active nucleation sites.\n\nFinally, we compute the numerical value of $\\Delta T_{ONB}$ using the provided data for water at $1$ atmosphere:\n$\\sigma = 0.058 \\text{ N/m}$\n$T_{sat} = 373 \\text{ K}$\n$h_{fg} = 2.26 \\times 10^{6} \\text{ J/kg}$\n$\\rho_v = 0.6 \\text{ kg/m}^3$\n$r = 5 \\times 10^{-6} \\text{ m}$\n\nSubstituting these values into the derived expression:\n$$\n\\Delta T_{ONB} = \\frac{2(0.058 \\, \\mathrm{N/m})(373 \\, \\mathrm{K})}{(2.26 \\times 10^{6} \\, \\mathrm{J/kg})(0.6 \\, \\mathrm{kg/m^3})(5 \\times 10^{-6} \\, \\mathrm{m})}\n$$\n$$\n\\Delta T_{ONB} = \\frac{43.268 \\, \\mathrm{N \\cdot K / m}}{6.78 \\, \\mathrm{J/m^3}}\n$$\nSince $1 \\, \\mathrm{J} = 1 \\, \\mathrm{N \\cdot m}$, the units become $\\mathrm{N \\cdot K / m} / (\\mathrm{N \\cdot m / m^3}) = \\mathrm{N \\cdot K / m} / (\\mathrm{N/m^2}) = \\mathrm{K}$.\n$$\n\\Delta T_{ONB} = \\frac{43.268}{6.78} \\, \\mathrm{K} \\approx 6.3817109... \\, \\mathrm{K}\n$$\nRounding the result to four significant figures as requested:\n$$\n\\Delta T_{ONB} \\approx 6.382 \\, \\mathrm{K}\n$$",
            "answer": "$$\\boxed{6.382}$$"
        },
        {
            "introduction": "Having explored the initiation of boiling, we now turn to its upper limit, the Critical Heat Flux (CHF). The CHF, represented as $q''_{CHF}$, marks the point where the heat transfer mechanism transitions from efficient nucleate boiling to inefficient film boiling, often with catastrophic consequences in industrial applications. This practice focuses on the practical challenge of prediction uncertainty, using the classic Zuber correlation to explore how small uncertainties in thermophysical properties like surface tension ($\\sigma$) and latent heat ($h_{fg}$) propagate and impact the reliability of our CHF predictions .",
            "id": "3935495",
            "problem": "A hydrodynamic instability analysis of pool boiling leads to the classical Zuber correlation for the critical heat flux (CHF). In this formulation, the critical heat flux is modeled as a product of thermophysical properties and gravity, multiplied by a dimensionless constant that arises from the most dangerous interfacial wavelength. Specifically, consider the following dependence for the CHF:\n$$\nq''_{\\mathrm{CHF}} = C_{Z} h_{fg} \\rho_{v}^{1/2} \\left[ \\sigma g (\\rho_{l} - \\rho_{v}) \\right]^{1/4}\n$$\nwhere $q''_{\\mathrm{CHF}}$ is the critical heat flux, $C_{Z}$ is a dimensionless constant, $h_{fg}$ is the latent heat of vaporization, $\\rho_{v}$ is the vapor density, $\\rho_{l}$ is the liquid density, $\\sigma$ is the surface tension, and $g$ is the gravitational acceleration. Assume that $C_{Z}$, $\\rho_{l}$, and $g$ are known without uncertainty and that only $\\sigma$, $\\rho_{v}$, and $h_{fg}$ are uncertain. Treat the uncertainties $\\delta \\sigma$, $\\delta \\rho_{v}$, and $\\delta h_{fg}$ as small and independent.\n\nUsing first-order total differentiation, derive the dimensionless first-order relative uncertainty of the critical heat flux, $\\delta q''_{CHF}/q''_{CHF}$, expressed explicitly in terms of $\\delta \\sigma/\\sigma$, $\\delta \\rho_{v}/\\rho_{v}$, $\\delta h_{fg}/h_{fg}$, and the ratio $\\rho_{v}/(\\rho_{l}-\\rho_{v})$. Do not perform any numerical evaluation. Express the final result as a single closed-form analytic expression, dimensionless, with no units and no rounding.",
            "solution": "The problem requires deriving the first-order relative uncertainty of the critical heat flux, $q''_{CHF}$, based on the Zuber correlation. We use the standard method of propagating small, independent uncertainties via total differentiation.\n\nThe provided correlation for the critical heat flux is the Zuber model:\n$$\nq''_{\\mathrm{CHF}} = C_{Z} h_{fg} \\rho_{v}^{1/2} \\left[ \\sigma g (\\rho_{l} - \\rho_{v}) \\right]^{1/4}\n$$\nThe problem specifies that $C_{Z}$, $\\rho_{l}$, and $g$ have no uncertainty, while $\\sigma$, $\\rho_{v}$, and $h_{fg}$ have small, independent uncertainties.\n\nTo simplify the differentiation of a function involving products and powers, we first take the natural logarithm:\n$$\n\\ln(q''_{\\mathrm{CHF}}) = \\ln\\left(C_{Z} h_{fg} \\rho_{v}^{1/2} \\left[ \\sigma g (\\rho_{l} - \\rho_{v}) \\right]^{1/4}\\right)\n$$\nUsing logarithm properties, this expands to:\n$$\n\\ln(q''_{\\mathrm{CHF}}) = \\ln(C_{Z}) + \\ln(h_{fg}) + \\frac{1}{2}\\ln(\\rho_{v}) + \\frac{1}{4}\\ln\\left[\\sigma g (\\rho_{l} - \\rho_{v})\\right]\n$$\nFurther expansion gives:\n$$\n\\ln(q''_{\\mathrm{CHF}}) = \\ln(C_{Z}) + \\ln(h_{fg}) + \\frac{1}{2}\\ln(\\rho_{v}) + \\frac{1}{4}\\left[ \\ln(\\sigma) + \\ln(g) + \\ln(\\rho_{l} - \\rho_{v}) \\right]\n$$\nNow, we apply the total differential. For a variable $x$, $d(\\ln x) = dx/x$. For small, first-order uncertainties, we approximate the differential $dx$ with the uncertainty $\\delta x$, giving the relative uncertainty:\n$$\n\\frac{\\delta q''_{\\mathrm{CHF}}}{q''_{\\mathrm{CHF}}} \\approx \\frac{\\delta C_{Z}}{C_{Z}} + \\frac{\\delta h_{fg}}{h_{fg}} + \\frac{1}{2}\\frac{\\delta \\rho_{v}}{\\rho_{v}} + \\frac{1}{4}\\left[ \\frac{\\delta \\sigma}{\\sigma} + \\frac{\\delta g}{g} + \\frac{\\delta(\\rho_{l} - \\rho_{v})}{\\rho_{l} - \\rho_{v}} \\right]\n$$\nAs per the problem statement, $\\delta C_{Z} = 0$, $\\delta \\rho_{l} = 0$, and $\\delta g = 0$. Substituting these zero-uncertainty conditions simplifies the equation:\n$$\n\\frac{\\delta q''_{\\mathrm{CHF}}}{q''_{\\mathrm{CHF}}} = 0 + \\frac{\\delta h_{fg}}{h_{fg}} + \\frac{1}{2}\\frac{\\delta \\rho_{v}}{\\rho_{v}} + \\frac{1}{4}\\left[ \\frac{\\delta \\sigma}{\\sigma} + 0 + \\frac{\\delta(\\rho_{l} - \\rho_{v})}{\\rho_{l} - \\rho_{v}} \\right]\n$$\nNext, we evaluate the term $\\delta(\\rho_{l} - \\rho_{v})$. With $\\delta \\rho_{l} = 0$, this becomes:\n$$\n\\delta(\\rho_{l} - \\rho_{v}) = \\delta \\rho_{l} - \\delta \\rho_{v} = 0 - \\delta \\rho_{v} = -\\delta \\rho_{v}\n$$\nSubstituting this back into the expression for relative uncertainty:\n$$\n\\frac{\\delta q''_{\\mathrm{CHF}}}{q''_{\\mathrm{CHF}}} = \\frac{\\delta h_{fg}}{h_{fg}} + \\frac{1}{2}\\frac{\\delta \\rho_{v}}{\\rho_{v}} + \\frac{1}{4}\\left[ \\frac{\\delta \\sigma}{\\sigma} - \\frac{\\delta \\rho_{v}}{\\rho_{l} - \\rho_{v}} \\right]\n$$\nDistributing the factor of $\\frac{1}{4}$:\n$$\n\\frac{\\delta q''_{\\mathrm{CHF}}}{q''_{\\mathrm{CHF}}} = \\frac{\\delta h_{fg}}{h_{fg}} + \\frac{1}{2}\\frac{\\delta \\rho_{v}}{\\rho_{v}} + \\frac{1}{4}\\frac{\\delta \\sigma}{\\sigma} - \\frac{1}{4}\\frac{\\delta \\rho_{v}}{\\rho_{l} - \\rho_{v}}\n$$\nThe final step is to group terms by the independent relative uncertainties. We collect the terms involving $\\delta \\rho_{v}$:\n$$\n\\frac{\\delta q''_{\\mathrm{CHF}}}{q''_{\\mathrm{CHF}}} = \\frac{1}{4}\\frac{\\delta \\sigma}{\\sigma} + \\frac{\\delta h_{fg}}{h_{fg}} + \\left( \\frac{1}{2}\\frac{\\delta \\rho_{v}}{\\rho_{v}} - \\frac{1}{4}\\frac{\\delta \\rho_{v}}{\\rho_{l} - \\rho_{v}} \\right)\n$$\nTo obtain the desired form, we factor out $\\frac{\\delta \\rho_{v}}{\\rho_{v}}$ from the terms in the parenthesis by multiplying and dividing the second term by $\\rho_{v}$:\n$$\n\\left( \\frac{1}{2} - \\frac{1}{4}\\frac{\\rho_{v}}{\\rho_{l} - \\rho_{v}} \\right) \\frac{\\delta \\rho_{v}}{\\rho_{v}}\n$$\nSubstituting this factored form back gives the final expression for the first-order relative uncertainty of the critical heat flux:\n$$\n\\frac{\\delta q''_{\\mathrm{CHF}}}{q''_{\\mathrm{CHF}}} = \\frac{1}{4}\\frac{\\delta \\sigma}{\\sigma} + \\left(\\frac{1}{2} - \\frac{1}{4}\\frac{\\rho_{v}}{\\rho_{l} - \\rho_{v}}\\right)\\frac{\\delta \\rho_{v}}{\\rho_{v}} + \\frac{\\delta h_{fg}}{h_{fg}}\n$$\nThis is the single, closed-form analytic expression for the relative uncertainty of $q''_{\\mathrm{CHF}}$ in terms of the specified variables and their relative uncertainties.",
            "answer": "$$\n\\boxed{\\frac{1}{4}\\frac{\\delta \\sigma}{\\sigma} + \\left(\\frac{1}{2} - \\frac{1}{4}\\frac{\\rho_{v}}{\\rho_{l} - \\rho_{v}}\\right)\\frac{\\delta \\rho_{v}}{\\rho_{v}} + \\frac{\\delta h_{fg}}{h_{fg}}}\n$$"
        },
        {
            "introduction": "Beyond the CHF lies the fascinating regime of film boiling, famously demonstrated by the Leidenfrost effect where a liquid droplet levitates on its own vapor. Simulating such phenomena is a formidable computational task requiring careful numerical implementation. This practice delves into a core challenge of computational fluid dynamics: mesh resolution. By analyzing a simplified model of the vapor film supporting a Leidenfrost droplet, you will derive the necessary grid spacing, $\\Delta x$, to accurately resolve the sharp physical gradients, a crucial step for any valid numerical simulation in this regime .",
            "id": "3935427",
            "problem": "Consider the propulsion of a Leidenfrost droplet over an asymmetric ratchet in the film-boiling regime. The vapor layer beneath the droplet is modeled by a thin-film equation derived from the incompressible Navier–Stokes equations coupled to an energy balance across the vapor film. Let the following be the fundamental base:\n\n- The incompressible Navier–Stokes equations for the vapor layer: mass conservation $\\nabla \\cdot \\mathbf{u} = 0$ and momentum conservation $\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u} = - \\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\rho \\mathbf{g}$, where $\\rho$ is density, $\\mu$ is dynamic viscosity, $\\mathbf{u}$ is velocity, $p$ is pressure, and $\\mathbf{g}$ is gravitational acceleration.\n- The lubrication (thin-film) approximation for the vapor film with characteristic thickness $h \\ll L$, where $h$ is film thickness and $L$ is the ratchet period, leading to depth-averaged flow driven by pressure gradients and body force.\n- Energy balance across the vapor film dominated by conduction: local evaporation mass flux $m''(x)$ follows $m''(x) = \\dfrac{k_v \\left( T_s - T_{\\text{sat}} \\right)}{h(x) h_{fg}}$, where $k_v$ is thermal conductivity of the vapor, $T_s$ is the surface temperature, $T_{\\text{sat}}$ is the saturation temperature, and $h_{fg}$ is the latent heat.\n- Capillarity couples pressure to interface curvature: $p(x) = p_0 - \\sigma \\dfrac{\\partial^2 h}{\\partial x^2}$, where $\\sigma$ is surface tension and $p_0$ is a reference pressure.\n\nIn the lubrication limit, the steady mass balance with a volumetric generation term (from $m''$) and the momentum balance reduce to a one-dimensional thin-film equation for $h(x)$ over one ratchet period. In computational practice, a coupled solver resolves the droplet interior (incompressible Navier–Stokes) and the vapor layer (lubrication equation), linked by normal and tangential stress balances at the interface and energy flux continuity. For the purpose of designing a mesh to capture film-thickness gradients in the streamwise direction, adopt the following consistently observed representation of the periodic steady-state film profile over one ratchet period $[0,L]$:\n$$\nh(x) = h_0 + A \\sin\\!\\left( \\dfrac{2 \\pi}{L} x \\right) + B \\sin\\!\\left( \\dfrac{4 \\pi}{L} x + \\phi \\right),\n$$\nwhere $h_0$ is a mean offset, $A$ is a fundamental-mode amplitude, $B$ is a first-harmonic amplitude capturing asymmetry, $L$ is the ratchet period, and $\\phi$ is a phase shift determined by the coupled hydrodynamic–thermal solution. The coefficients $h_0$, $A$, $B$, $L$, and $\\phi$ are assumed known from the coupled solution or accurate precomputation.\n\nYour task is to determine a conservative uniform mesh spacing $\\Delta x$ along $x$ that guarantees the following discretization-accuracy requirements when using second-order central finite differences to approximate the first and second derivatives of $h(x)$:\n\n- The absolute truncation error in the numerical approximation of $\\dfrac{\\partial h}{\\partial x}$ over the domain $x \\in [0,L]$ must not exceed $\\varepsilon_1$ times the maximum magnitude of $\\dfrac{\\partial h}{\\partial x}$ over the same domain.\n- The absolute truncation error in the numerical approximation of $\\dfrac{\\partial^2 h}{\\partial x^2}$ over the domain $x \\in [0,L]$ must not exceed $\\varepsilon_2$ times the maximum magnitude of $\\dfrac{\\partial^2 h}{\\partial x^2}$ over the same domain.\n\nYou must derive, from first principles starting at the stated fundamental base and using standard truncation-error analysis for second-order central differences, a computable upper bound on $\\Delta x$ in terms of the supremum norms of the derivatives of $h(x)$ on $[0,L]$. Then, using the harmonic representation of $h(x)$ given above, you must bound the required supremum norms over $[0,L]$ using only the triangle inequality and the wavenumbers present, thereby obtaining an explicit and conservative formula for $\\Delta x$ in terms of $A$, $B$, $L$, and the tolerances $\\varepsilon_1$ and $\\varepsilon_2$. All trigonometric arguments must be in radians.\n\nWrite a complete program that, for each test case below, computes the recommended uniform mesh spacing $\\Delta x$ in micrometers and returns the most restrictive value implied by the two accuracy requirements. Each test case provides $L$ (micrometers), $h_0$ (micrometers), $A$ (micrometers), $B$ (micrometers), $\\phi$ (radians), $\\varepsilon_1$ (dimensionless), and $\\varepsilon_2$ (dimensionless). Use only the properties of $h(x)$ listed above; do not introduce any additional fitting constants or empirical safety factors.\n\nTest suite (each line is one test case with parameters $(L, h_0, A, B, \\phi, \\varepsilon_1, \\varepsilon_2)$):\n- Case $1$: $(300,\\;20,\\;4,\\;1.5,\\;\\pi/3,\\;0.02,\\;0.05)$.\n- Case $2$: $(500,\\;30,\\;0.5,\\;0.2,\\;\\pi/4,\\;0.01,\\;0.02)$.\n- Case $3$: $(120,\\;15,\\;6,\\;2.5,\\;-\\,\\pi/6,\\;0.03,\\;0.05)$.\n- Case $4$: $(400,\\;25,\\;3,\\;0,\\;0,\\;0.02,\\;0.02)$.\n\nRequirements for the output:\n- Express the mesh spacing $\\Delta x$ in micrometers for each test case, rounded to $6$ significant figures.\n- The program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases above (for example, $[d_1,d_2,d_3,d_4]$).\n- Angles must be interpreted in radians. There are no other required physical units in the final numeric output beyond micrometers for $\\Delta x$.\n\nYour solution must start from the stated fundamental laws and core definitions and proceed by rigorous derivation to a final computable formula based only on $A$, $B$, $L$, $\\phi$, $\\varepsilon_1$, and $\\varepsilon_2$. No other external data should be used. The program must implement that formula exactly as derived, using only standard arithmetic and trigonometric constants.",
            "solution": "The problem requires the derivation of a conservative uniform mesh spacing, $\\Delta x$, for discretizing a one-dimensional domain of length $L$. The discretization must satisfy specified accuracy requirements for the numerical approximation of the first and second derivatives of a given function $h(x)$ using second-order central finite differences. The derivation must be based on first principles, starting from the truncation error analysis of the finite difference schemes.\n\nLet the film thickness profile over one ratchet period $x \\in [0,L]$ be given by:\n$$\nh(x) = h_0 + A \\sin\\!\\left( \\frac{2 \\pi}{L} x \\right) + B \\sin\\!\\left( \\frac{4 \\pi}{L} x + \\phi \\right)\n$$\nwhere $h_0$, $A$, $B$, $L$, and $\\phi$ are known constants.\n\nOur derivation proceeds in the following steps:\n1.  Analyze the truncation error for the second-order central difference schemes for the first and second derivatives.\n2.  Formulate the accuracy constraints based on the problem statement.\n3.  Compute the necessary derivatives of $h(x)$ and establish conservative upper bounds for their supremum norms over the domain $[0,L]$ using the triangle inequality.\n4.  Combine these results to derive an explicit formula for the maximum allowable $\\Delta x$.\n\n**1. Truncation Error Analysis**\n\nFor a sufficiently smooth function $f(x)$, the Taylor series expansions around a point $x$ are:\n$$f(x+\\Delta x) = f(x) + f'(x)\\Delta x + \\frac{f''(x)}{2!}(\\Delta x)^2 + \\frac{f'''(x)}{3!}(\\Delta x)^3 + \\frac{f^{(4)}(x)}{4!}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^5)$$\n$$f(x-\\Delta x) = f(x) - f'(x)\\Delta x + \\frac{f''(x)}{2!}(\\Delta x)^2 - \\frac{f'''(x)}{3!}(\\Delta x)^3 + \\frac{f^{(4)}(x)}{4!}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^5)$$\n\nThe second-order central difference approximation for the first derivative, $\\frac{\\partial h}{\\partial x}$, is given by $\\frac{h(x+\\Delta x) - h(x-\\Delta x)}{2\\Delta x}$. The truncation error, $E_1(x)$, is the difference between the exact derivative and its approximation. By subtracting the second Taylor expansion from the first, we find the leading-order term of the truncation error:\n$$E_1(x) = \\frac{\\partial h}{\\partial x} - \\frac{h(x+\\Delta x) - h(x-\\Delta x)}{2\\Delta x} = - \\frac{h'''(x)}{6}(\\Delta x)^2 + \\mathcal{O}((\\Delta x)^4)$$\nThe absolute value of the leading-order error is $|E_1(x)| \\approx \\frac{|h'''(x)|}{6}(\\Delta x)^2$.\n\nThe second-order central difference approximation for the second derivative, $\\frac{\\partial^2 h}{\\partial x^2}$, is given by $\\frac{h(x+\\Delta x) - 2h(x) + h(x-\\Delta x)}{(\\Delta x)^2}$. The truncation error, $E_2(x)$, is found by adding the two Taylor expansions:\n$$E_2(x) = \\frac{\\partial^2 h}{\\partial x^2} - \\frac{h(x+\\Delta x) - 2h(x) + h(x-\\Delta x)}{(\\Delta x)^2} = - \\frac{h^{(4)}(x)}{12}(\\Delta x)^2 + \\mathcal{O}((\\Delta x)^4)$$\nThe absolute value of the leading-order error is $|E_2(x)| \\approx \\frac{|h^{(4)}(x)|}{12}(\\Delta x)^2$.\n\n**2. Formulation of Accuracy Constraints**\n\nThe problem imposes two constraints on the absolute truncation error over the domain $x \\in [0,L]$. We express these using the supremum norm, defined as $\\|f\\|_\\infty = \\sup_{x \\in [0,L]} |f(x)|$.\n\nConstraint 1: The absolute truncation error for $\\frac{\\partial h}{\\partial x}$ must not exceed $\\varepsilon_1$ times the maximum magnitude of $\\frac{\\partial h}{\\partial x}$.\n$$\\|E_1\\|_\\infty \\le \\varepsilon_1 \\left\\| \\frac{\\partial h}{\\partial x} \\right\\|_\\infty$$\nUsing the leading-order error term, this translates to:\n$$\\frac{(\\Delta x)^2}{6} \\|h'''\\|_\\infty \\le \\varepsilon_1 \\|h'\\|_\\infty$$\nThis yields the first condition on $\\Delta x$:\n$$\\Delta x \\le \\sqrt{\\frac{6 \\varepsilon_1 \\|h'\\|_\\infty}{\\|h'''\\|_\\infty}}$$\n\nConstraint 2: The absolute truncation error for $\\frac{\\partial^2 h}{\\partial x^2}$ must not exceed $\\varepsilon_2$ times the maximum magnitude of $\\frac{\\partial^2 h}{\\partial x^2}$.\n$$\\|E_2\\|_\\infty \\le \\varepsilon_2 \\left\\| \\frac{\\partial^2 h}{\\partial x^2} \\right\\|_\\infty$$\nUsing the leading-order error term:\n$$\\frac{(\\Delta x)^2}{12} \\|h^{(4)}\\|_\\infty \\le \\varepsilon_2 \\|h''\\|_\\infty$$\nThis yields the second condition on $\\Delta x$:\n$$\\Delta x \\le \\sqrt{\\frac{12 \\varepsilon_2 \\|h''\\|_\\infty}{\\|h^{(4)}\\|_\\infty}}$$\n\n**3. Derivatives of $h(x)$ and Supremum Norm Bounds**\n\nTo evaluate these conditions, we need the derivatives of $h(x)$ and bounds on their supremum norms. Let $k_1 = \\frac{2\\pi}{L}$ and $k_2 = \\frac{4\\pi}{L} = 2k_1$. The function and its derivatives are:\n$h(x) = h_0 + A \\sin(k_1 x) + B \\sin(k_2 x + \\phi)$\n$h'(x) = A k_1 \\cos(k_1 x) + B k_2 \\cos(k_2 x + \\phi)$\n$h''(x) = -A k_1^2 \\sin(k_1 x) - B k_2^2 \\sin(k_2 x + \\phi)$\n$h'''(x) = -A k_1^3 \\cos(k_1 x) - B k_2^3 \\cos(k_2 x + \\phi)$\n$h^{(4)}(x) = A k_1^4 \\sin(k_1 x) + B k_2^4 \\sin(k_2 x + \\phi)$\n\nAs instructed, we find conservative bounds for the supremum norms using the triangle inequality ($\\|f+g\\|_\\infty \\le \\|f\\|_\\infty + \\|g\\|_\\infty$). Since amplitudes $A$ and $B$ are non-negative, $|A|=A$ and $|B|=B$.\n$\\|h'\\|_\\infty \\le A k_1 \\| \\cos(k_1 x) \\|_\\infty + B k_2 \\| \\cos(k_2 x + \\phi) \\|_\\infty = A k_1 + B k_2$\n$\\|h''\\|_\\infty \\le A k_1^2 \\| \\sin(k_1 x) \\|_\\infty + B k_2^2 \\| \\sin(k_2 x + \\phi) \\|_\\infty = A k_1^2 + B k_2^2$\n$\\|h'''\\|_\\infty \\le A k_1^3 \\| \\cos(k_1 x) \\|_\\infty + B k_2^3 \\| \\cos(k_2 x + \\phi) \\|_\\infty = A k_1^3 + B k_2^3$\n$\\|h^{(4)}\\|_\\infty \\le A k_1^4 \\| \\sin(k_1 x) \\|_\\infty + B k_2^4 \\| \\sin(k_2 x + \\phi) \\|_\\infty = A k_1^4 + B k_2^4$\n\n**4. Derivation of the Mesh Spacing Formula**\n\nWe substitute these conservative bounds into the inequalities for $\\Delta x$.\n\nFor the first constraint, let $\\Delta x_1$ be the upper bound on $\\Delta x$:\n$$(\\Delta x_1)^2 \\le \\frac{6 \\varepsilon_1 (A k_1 + B k_2)}{A k_1^3 + B k_2^3} = \\frac{6 \\varepsilon_1 (A k_1 + B (2k_1))}{A k_1^3 + B (2k_1)^3} = \\frac{6 \\varepsilon_1 k_1 (A + 2B)}{k_1^3 (A + 8B)} = \\frac{6 \\varepsilon_1}{k_1^2} \\frac{A + 2B}{A + 8B}$$\nSubstituting $k_1 = \\frac{2\\pi}{L}$:\n$$(\\Delta x_1)^2 \\le \\frac{6 \\varepsilon_1}{(2\\pi/L)^2} \\frac{A + 2B}{A + 8B} = L^2 \\frac{6 \\varepsilon_1}{4\\pi^2} \\frac{A + 2B}{A + 8B}$$\nThus, the first bound is $\\Delta x_1 = \\frac{L}{2\\pi} \\sqrt{6 \\varepsilon_1 \\frac{A + 2B}{A + 8B}}$.\n\nFor the second constraint, let $\\Delta x_2$ be the upper bound on $\\Delta x$:\n$$(\\Delta x_2)^2 \\le \\frac{12 \\varepsilon_2 (A k_1^2 + B k_2^2)}{A k_1^4 + B k_2^4} = \\frac{12 \\varepsilon_2 (A k_1^2 + B (2k_1)^2)}{A k_1^4 + B (2k_1)^4} = \\frac{12 \\varepsilon_2 k_1^2 (A + 4B)}{k_1^4 (A + 16B)} = \\frac{12 \\varepsilon_2}{k_1^2} \\frac{A + 4B}{A + 16B}$$\nSubstituting $k_1 = \\frac{2\\pi}{L}$:\n$$(\\Delta x_2)^2 \\le \\frac{12 \\varepsilon_2}{(2\\pi/L)^2} \\frac{A + 4B}{A + 16B} = L^2 \\frac{12 \\varepsilon_2}{4\\pi^2} \\frac{A + 4B}{A + 16B}$$\nThus, the second bound is $\\Delta x_2 = \\frac{L}{2\\pi} \\sqrt{12 \\varepsilon_2 \\frac{A + 4B}{A + 16B}}$.\n\nTo satisfy both accuracy requirements simultaneously, the mesh spacing $\\Delta x$ must be smaller than both $\\Delta x_1$ and $\\Delta x_2$. Therefore, the most restrictive (i.e., largest permissible) value for a conservative uniform mesh spacing is:\n$$\\Delta x = \\min(\\Delta x_1, \\Delta x_2)$$\nThe parameters $h_0$ and $\\phi$ do not influence the bounds on the magnitudes of the derivatives and thus do not appear in the final formula for $\\Delta x$. The program below implements this derived formula.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Calculates the recommended uniform mesh spacing for a series of test cases\n    based on discretization-accuracy requirements for a given film thickness profile.\n    \"\"\"\n\n    # Test suite with parameters (L, h_0, A, B, phi, eps1, eps2)\n    test_cases = [\n        (300, 20, 4, 1.5, np.pi/3, 0.02, 0.05),\n        (500, 30, 0.5, 0.2, np.pi/4, 0.01, 0.02),\n        (120, 15, 6, 2.5, -np.pi/6, 0.03, 0.05),\n        (400, 25, 3, 0, 0, 0.02, 0.02),\n    ]\n\n    results = []\n    \n    # Helper function for rounding to a specified number of significant figures.\n    def round_to_sf(x, sf):\n        if x == 0:\n            return 0\n        return round(x, sf - int(math.floor(math.log10(abs(x)))) - 1)\n\n    for case in test_cases:\n        L, h0, A, B, phi, eps1, eps2 = case\n\n        # The derivation shows that h0 and phi do not affect the result.\n        # Amplitudes A and B are non-negative.\n\n        # Calculate the bound from the first derivative accuracy requirement.\n        # Note: A + 8B can only be zero if A=0 and B=0. In this case, h(x) is constant,\n        # derivatives are zero, and the error is always zero. This is not\n        # encountered in the test cases.\n        if A + 8 * B == 0:\n             # For a constant profile, any dx is valid. We can set dx1 to infinity.\n             dx1 = float('inf')\n        else:\n            term1 = (6 * eps1 * (A + 2 * B)) / (A + 8 * B)\n            dx1 = (L / (2 * np.pi)) * np.sqrt(term1)\n\n        # Calculate the bound from the second derivative accuracy requirement.\n        # Note: similar to the above, A + 16B is non-zero for the given cases.\n        if A + 16 * B == 0:\n            dx2 = float('inf')\n        else:\n            term2 = (12 * eps2 * (A + 4 * B)) / (A + 16 * B)\n            dx2 = (L / (2 * np.pi)) * np.sqrt(term2)\n\n        # The recommended mesh spacing is the most restrictive (minimum) of the two.\n        delta_x = min(dx1, dx2)\n\n        # Round the result to 6 significant figures.\n        results.append(round_to_sf(delta_x, 6))\n\n    # Format the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}