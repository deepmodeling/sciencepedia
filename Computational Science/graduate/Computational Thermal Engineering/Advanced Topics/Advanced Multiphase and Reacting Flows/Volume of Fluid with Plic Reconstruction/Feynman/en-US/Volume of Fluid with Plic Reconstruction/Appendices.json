{
    "hands_on_practices": [
        {
            "introduction": "The essence of the Piecewise Linear Interface Construction (PLIC) method is determining an interface's position from the fluid volume fraction ($C$) and its normal vector ($\\mathbf{n}$). This exercise provides a first-principles derivation of this relationship for a simplified but fundamental geometric case. By analytically solving for the plane constant that defines the interface, you will build foundational intuition for the geometric core of PLIC reconstruction. ",
            "id": "3336377",
            "problem": "Consider the Volume of Fluid (VOF) interface capturing strategy with the Piecewise Linear Interface Construction (PLIC) reconstruction in a uniform Cartesian cell. In the PLIC approach, the interface inside a given cell is reconstructed as a plane described by $\\mathbf{n}\\cdot\\mathbf{x}=d$, where $\\mathbf{n}$ is a unit normal vector estimated from the volume fraction field and $d$ is a plane constant chosen to match the known cell volume fraction. This contrasts with interface tracking methods (e.g., front-tracking) that explicitly advect a discretized interface.\n\nLet the cell be the unit cube $\\Omega=[0,1]^{3}$ in Cartesian coordinates and let the estimated unit normal be $\\mathbf{n}=(n_{x},n_{y},n_{z})$ with strictly positive components. The volume fraction $C\\in[0,1]$ denotes the fraction of $\\Omega$ occupied by the fluid on the side $\\mathbf{n}\\cdot\\mathbf{x}\\leq d$. Assume the regime in which the interface plane intersects the coordinate planes at the origin corner only, so that the fluid region $\\{\\,\\mathbf{x}\\in\\Omega:\\mathbf{n}\\cdot\\mathbf{x}\\leq d\\,\\}$ is a tetrahedron touching the origin; this occurs when $0\\leq d\\leq \\min\\{n_{x},n_{y},n_{z}\\}$.\n\nStarting from first principles (geometric or integral definitions of volume), derive the plane constant $d$ in terms of the given volume fraction $C$ and the normal components $n_{x}$, $n_{y}$, $n_{z}$ that yields the correct cut volume in this tetrahedral regime. Express your final answer as a single closed-form analytic expression. No rounding is required, and no units are necessary since the variables are dimensionless.",
            "solution": "The problem asks for the derivation of the plane constant $d$ for a PLIC interface reconstruction within a unit cubic cell, under the specific regime where the fluid-filled region forms a tetrahedron at the origin.\n\nThe problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Cell geometry: Unit cube $\\Omega = [0,1]^3$.\n- Interface plane equation: $\\mathbf{n} \\cdot \\mathbf{x} = d$, where $\\mathbf{n} = (n_x, n_y, n_z)$ is a unit normal vector with $n_x>0$, $n_y>0$, $n_z>0$.\n- Fluid region: $\\{\\mathbf{x} \\in \\Omega : \\mathbf{n} \\cdot \\mathbf{x} \\leq d\\}$.\n- Volume fraction: $C \\in [0,1]$.\n- Geometric regime: The fluid region is a tetrahedron with one vertex at the origin. This holds for $0 \\leq d \\leq \\min\\{n_x, n_y, n_z\\}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is rooted in standard methods of computational fluid dynamics, specifically the Volume of Fluid (VOF) method with PLIC reconstruction. The geometric and mathematical setup is rigorous and based on fundamental principles of analytic geometry.\n- **Well-Posedness**: The problem provides all necessary information to establish a unique relationship between the volume fraction $C$ and the plane constant $d$. The goal is to invert this relationship, which is possible as the volume is a monotonic function of $d$.\n- **Objectivity**: The language is precise and devoid of any subjectivity.\n- **Completeness and Consistency**: The givens are sufficient and consistent. The condition $0 \\leq d \\leq \\min\\{n_x, n_y, n_z\\}$ correctly ensures that the plane's intercepts with the axes lie within the unit cube's boundaries emanating from the origin, thus forming a simple tetrahedron.\n- **Verdict**: The problem is valid.\n\n**Step 3: Derivation of the Solution**\n\nThe derivation proceeds from the geometric definition of the fluid volume.\n\n1.  **Identify the Geometry and Vertices**:\n    The fluid region is defined by the inequalities $x \\ge 0$, $y \\ge 0$, $z \\ge 0$, and $n_x x + n_y y + n_z z \\le d$. This region is a tetrahedron. One vertex of this tetrahedron is the origin, $O=(0,0,0)$. The other three vertices are the points where the plane $\\mathbf{n} \\cdot \\mathbf{x} = d$ intersects the coordinate axes.\n    -   Intersection with the x-axis ($y=0, z=0$):\n        $n_x x = d \\implies x_0 = \\frac{d}{n_x}$. The vertex is $P_x = (\\frac{d}{n_x}, 0, 0)$.\n    -   Intersection with the y-axis ($x=0, z=0$):\n        $n_y y = d \\implies y_0 = \\frac{d}{n_y}$. The vertex is $P_y = (0, \\frac{d}{n_y}, 0)$.\n    -   Intersection with the z-axis ($x=0, y=0$):\n        $n_z z = d \\implies z_0 = \\frac{d}{n_z}$. The vertex is $P_z = (0, 0, \\frac{d}{n_z})$.\n    The problem condition $0 \\leq d \\leq \\min\\{n_x, n_y, n_z\\}$ ensures that these intercepts $x_0, y_0, z_0$ are all less than or equal to $1$, so the tetrahedron lies entirely within the unit cube $\\Omega$.\n\n2.  **Calculate the Volume**:\n    The volume $V$ of a tetrahedron with one vertex at the origin and the other three vertices on the coordinate axes at distances $x_0$, $y_0$, and $z_0$ from the origin is given by the formula:\n    $$ V = \\frac{1}{6} x_0 y_0 z_0 $$\n    Substituting the expressions for the intercepts found in the previous step:\n    $$ V = \\frac{1}{6} \\left(\\frac{d}{n_x}\\right) \\left(\\frac{d}{n_y}\\right) \\left(\\frac{d}{n_z}\\right) $$\n    $$ V = \\frac{d^3}{6 n_x n_y n_z} $$\n\n3.  **Relate Volume to Volume Fraction**:\n    The volume fraction $C$ is the ratio of the fluid volume $V$ to the total volume of the computational cell $V_{\\text{cell}}$. The cell is a unit cube, so its volume is $V_{\\text{cell}} = 1^3 = 1$.\n    Therefore, the volume fraction is numerically equal to the fluid volume:\n    $$ C = \\frac{V}{V_{\\text{cell}}} = \\frac{V}{1} = V $$\n    Equating the expressions for $C$ and $V$:\n    $$ C = \\frac{d^3}{6 n_x n_y n_z} $$\n\n4.  **Solve for the Plane Constant $d$**:\n    The final step is to solve this equation for $d$. We rearrange the equation to isolate $d^3$:\n    $$ d^3 = 6 C n_x n_y n_z $$\n    Taking the cube root of both sides yields the desired expression for $d$ in terms of $C$, $n_x$, $n_y$, and $n_z$:\n    $$ d = (6 C n_x n_y n_z)^{\\frac{1}{3}} $$\n    This is the closed-form analytic expression for the plane constant $d$ in the specified tetrahedral regime.",
            "answer": "$$\\boxed{(6 C n_x n_y n_z)^{\\frac{1}{3}}}$$"
        },
        {
            "introduction": "While the previous problem established the theoretical link between volume fraction and interface position, a practical implementation must be able to compute this clipped volume robustly for any orientation. This coding exercise challenges you to implement and validate a clipping algorithm that is the workhorse of any PLIC scheme. By testing your implementation against a suite of extreme geometric configurations, you will appreciate the numerical subtleties required for a truly production-ready tool. ",
            "id": "4004146",
            "problem": "Consider the Volume of Fluid (VOF) method with Piecewise Linear Interface Construction (PLIC) reconstruction in a Cartesian mesh. In a single computational cell, the reconstructed interface is represented by a linear manifold: a line in two dimensions and a plane in three dimensions. Let the computational cell be the unit square in two dimensions, defined as $\\{(x,y)\\in\\mathbb{R}^2 \\mid 0 \\le x \\le 1, 0 \\le y \\le 1\\}$, and the unit cube in three dimensions, defined as $\\{(x,y,z)\\in\\mathbb{R}^3 \\mid 0 \\le x \\le 1, 0 \\le y \\le 1, 0 \\le z \\le 1\\}$. The PLIC interface is the set of points satisfying $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha$, where $\\mathbf{n}$ is the interface normal vector and $\\alpha$ is a scalar offset, and the liquid phase occupies the half-space $\\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha$ inside the cell. The local volume fraction in the cell must be equal to the measure (area in two dimensions, volume in three dimensions) of the intersection region between the half-space and the unit cell, normalized by the cell measure.\n\nThe objective is to devise and validate robust clipping algorithms that compute the intersection measure for extreme geometric configurations, consistent with conservation of volume fractions and linear interface representation. These algorithms must rely only on the intersection of convex polytopes with a half-space, starting from first principles: (i) conservation of mass implies that the volume fraction equals the fraction of cell measure occupied by the liquid region, (ii) the PLIC interface is linear, and (iii) convex polytopes intersected with half-spaces remain convex.\n\nDefine the following tasks:\n- For two dimensions, compute the area of the intersection set $R_2 = \\{(x,y) \\in [0,1]^2 \\mid n_x x + n_y y \\le \\alpha\\}$.\n- For three dimensions, compute the volume of the intersection set $R_3 = \\{(x,y,z) \\in [0,1]^3 \\mid n_x x + n_y y + n_z z \\le \\alpha\\}$.\n\nYour program must implement geometric clipping from first principles and produce results for the test suite below. The algorithms must be robust against:\n- Nearly tangent cuts where the interface barely intersects the cell, producing tiny sliver measures.\n- Normals aligned with coordinate axes, yielding axis-aligned half-spaces.\n- Cuts that pass close to edges and corners, stressing numerical tolerances.\n\nUse the following test suite. For each test case, compute the intersection measure in the unit cell and compare it to the provided expected value using a pass/fail criterion. All expected values are given in the same units as the measure: area in two dimensions and volume in three dimensions. No physical units or angle units are required.\n\nTwo-dimensional test cases (unit square):\n- Case $1$: $\\mathbf{n} = (1,0)$, $\\alpha = 0.37$, expected area $= 0.37$.\n- Case $2$: $\\mathbf{n} = (1,0)$, $\\alpha = -10^{-12}$, expected area $= 0$.\n- Case $3$: $\\mathbf{n} = (1,0)$, $\\alpha = 1.2$, expected area $= 1$.\n- Case $4$: $\\mathbf{n} = (1,1)$, $\\alpha = 0.5$, expected area $= 0.125$.\n- Case $5$: $\\mathbf{n} = (1,1)$, $\\alpha = 10^{-4}$, expected area $= 5 \\times 10^{-9}$.\n- Case $6$: $\\mathbf{n} = (1,1)$, $\\alpha = 1.99$, expected area $= 0.99995$.\n- Case $7$: $\\mathbf{n} = (0,1)$, $\\alpha = 0.65$, expected area $= 0.65$.\n\nThree-dimensional test cases (unit cube):\n- Case $8$: $\\mathbf{n} = (1,0,0)$, $\\alpha = 0.37$, expected volume $= 0.37$.\n- Case $9$: $\\mathbf{n} = (1,0,0)$, $\\alpha = -10^{-12}$, expected volume $= 0$.\n- Case $10$: $\\mathbf{n} = (1,0,0)$, $\\alpha = 1.2$, expected volume $= 1$.\n- Case $11$: $\\mathbf{n} = (1,1,1)$, $\\alpha = 0.5$, expected volume $= 0.020833333333333332$.\n- Case $12$: $\\mathbf{n} = (1,1,1)$, $\\alpha = 0.01$, expected volume $= 1.6666666666666667 \\times 10^{-7}$.\n- Case $13$: $\\mathbf{n} = (1,1,1)$, $\\alpha = 2.99$, expected volume $= 0.9999998333333334$.\n- Case $14$: $\\mathbf{n} = (0,1,0)$, $\\alpha = 0.65$, expected volume $= 0.65$.\n\nPass/fail criterion:\n- A test passes if the computed measure $m_{\\text{comp}}$ satisfies $\\lvert m_{\\text{comp}} - m_{\\text{exp}} \\rvert \\le \\max(\\varepsilon_{\\text{abs}}, \\varepsilon_{\\text{rel}} \\cdot \\max(1, \\lvert m_{\\text{exp}} \\rvert))$, with $\\varepsilon_{\\text{abs}} = 10^{-9}$ and $\\varepsilon_{\\text{rel}} = 10^{-9}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots,result_{14}]$), where each $result_i$ is a boolean indicating pass or fail for Case $i$ in the order listed above.",
            "solution": "The problem requires the computation of the measure (area in two dimensions, volume in three dimensions) of the intersection of a unit hypercube with a half-space. This is a classic problem in computational geometry, fundamental to the Piecewise Linear Interface Construction (PLIC) scheme within the Volume of Fluid (VOF) method for multiphase flow simulation. The liquid phase is defined by the inequality $\\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha$ within the unit cell $[0,1]^d$, where $d \\in \\{2, 3\\}$. The core of the task is to develop a robust algorithm based on first principles to calculate this measure for various geometric configurations of the interface plane, defined by the normal vector $\\mathbf{n}$ and offset $\\alpha$.\n\nThe solution is derived through a systematic reduction of the general problem to a canonical form for which an analytical solution exists. This approach ensures correctness and robustness.\n\n**1. Foundational Principles**\n\nThe algorithm is built upon the following principles:\n- The unit cell is a convex polytope $[0,1]^d$.\n- The liquid region is the intersection of this convex polytope with a half-space $\\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha$, which results in another convex polytope.\n- The measure of a set is invariant under isometries (e.g., reflections).\n\n**2. Algorithmic Steps**\n\nThe overall algorithm proceeds in several stages:\n\n**Stage 1: Dimensionality Reduction**\nThe normal vector $\\mathbf{n}$ may have zero components. For instance, in three dimensions, if $\\mathbf{n} = (n_x, n_y, 0)$, the interface equation $n_x x + n_y y \\le \\alpha$ is independent of the $z$ coordinate. The volume of the liquid region is the area of the corresponding two-dimensional region in the $xy$-plane multiplied by the extent of the cell in the $z$-direction, which is $1$. In general, if some components of $\\mathbf{n}$ are zero, the problem can be solved in a lower-dimensional space spanned by the axes corresponding to the non-zero components of $\\mathbf{n}$. The resulting measure is identical. The algorithm first identifies the effective dimensions of the problem and proceeds with the reduced normal vector and dimension. A special case arises if all components of $\\mathbf{n}$ are zero, where the inequality becomes $0 \\le \\alpha$. The measure is $1$ if $\\alpha \\ge 0$ and $0$ if $\\alpha < 0$. If only one component $n_k$ is non-zero, the problem is one-dimensional, and the measure is simply a fraction of the cell length, computed as $\\text{clip}(\\alpha/n_k, 0, 1)$ if $n_k > 0$, or $\\text{clip}(1 - \\alpha/n_k, 0, 1)$ if $n_k < 0$.\n\n**Stage 2: Transformation to a Canonical Form**\nThe general problem can be simplified by transforming it into a canonical form where all components of the normal vector are non-negative. This is achieved through a series of volume-preserving reflections. For any dimension $i$ where $n_i < 0$, we apply the reflection $x_i \\to 1 - x'_i$. The domain for the new coordinate $x'_i$ remains $[0,1]$. The inequality $\\sum_j n_j x_j \\le \\alpha$ becomes:\n$$ \\sum_{j \\ne i} n_j x_j + n_i(1-x'_i) \\le \\alpha \\implies \\sum_{j \\ne i} n_j x_j - n_i x'_i \\le \\alpha - n_i $$\nBy defining a new normal vector $\\mathbf{n}'$ where $n'_i = -n_i > 0$ and a new offset $\\alpha' = \\alpha - n_i$, we obtain an equivalent problem with a non-negative normal component. This process is repeated for all dimensions with negative normal components. After this stage, we have a new problem defined by $(\\mathbf{n}', \\alpha')$ where all components of $\\mathbf{n}'$ are non-negative. The function $f(\\mathbf{x}) = \\mathbf{n}' \\cdot \\mathbf{x}$ is now monotonically increasing in all coordinates.\n\n**Stage 3: Bounding and Trivial Cases**\nFor the canonical problem with $n'_i \\ge 0$ for all $i$, the minimum value of $\\mathbf{n}' \\cdot \\mathbf{x}$ in the unit cell is at $\\mathbf{x}=(0,\\dots,0)$, which is $0$. The maximum value is at $\\mathbf{x}=(1,\\dots,1)$, which is $\\sum_i n'_i$. This allows for simple checks:\n- If $\\alpha' \\le 0$, the liquid region is empty (or of measure zero), so the measure is $0$.\n- If $\\alpha' \\ge \\sum_i n'_i$, the entire cell is filled, and the measure is $1$.\n\n**Stage 4: The Inclusion-Exclusion Formula for Volume Calculation**\nFor the non-trivial case where $0 < \\alpha' < \\sum_i n'_i$, the liquid region is a convex polytope formed by cutting the corner of the hypercube near the origin. The volume of such a shape can be calculated analytically. The volume of the simplex defined by $\\{\\mathbf{x} \\in \\mathbb{R}^d_+ \\mid \\mathbf{n}' \\cdot \\mathbf{x} \\le \\alpha'\\}$ (i.e., in the first orthant) is given by:\n$$ V_{\\text{simplex}} = \\frac{(\\alpha')^d}{d! \\prod_{i=1}^d n'_i} $$\nThis formula is valid for the portion of the simplex inside the unit hypercube only if the simplex does not extend beyond any face $x_i = 1$. To account for clipping by the hypercube faces, we use the inclusion-exclusion principle. The desired volume is the volume of the simplex in the first orthant minus the volumes of the regions that lie outside the hypercube (where one or more $x_i > 1$). This leads to the general formula for the measure $M$:\n$$ M(\\mathbf{n}', \\alpha', d) = \\frac{1}{\\prod_{i=1}^d n'_i} \\sum_{S \\subseteq \\{1, \\dots, d\\}} (-1)^{|S|} \\frac{\\left(\\alpha' - \\sum_{j \\in S} n'_j\\right)^d}{d!} H\\left(\\alpha' - \\sum_{j \\in S} n'_j\\right) $$\nHere, the sum is over all $2^d$ subsets $S$ of the dimension indices $\\{1, \\dots, d\\}$, and $H$ is the Heaviside step function, which is $1$ if its argument is positive and $0$ otherwise. This effectively prunes the sum to include only terms where the adjusted alpha is positive. The term for $S=\\emptyset$ is the initial simplex volume.\n\nThis systematic application of dimensionality reduction, canonical transformation, and the inclusion-exclusion principle provides a robust and mathematically sound algorithm capable of handling the full range of test cases, including those designed to stress numerical precision and geometric degeneracy.",
            "answer": "```python\nimport numpy as np\nfrom itertools import combinations\nimport math\n\ndef compute_measure(n_orig, alpha_orig):\n    \"\"\"\n    Computes the measure (area in 2D, volume in 3D) of the region\n    n . x <= alpha inside the unit hypercube [0,1]^d.\n    \"\"\"\n    n = np.array(n_orig, dtype=float)\n    alpha = float(alpha_orig)\n    dim = len(n)\n    \n    # Epsilon for floating point comparisons\n    TOL = 1e-12\n\n    # Stage 1: Dimensionality Reduction\n    non_zero_indices = np.where(np.abs(n) > TOL)[0]\n    sub_dim = len(non_zero_indices)\n\n    if sub_dim == 0:\n        return 1.0 if alpha >= 0 else 0.0\n\n    # If the problem is effectively lower-dimensional, solve it in that subspace.\n    # The measure in the full space is the same.\n    if sub_dim < dim:\n        sub_n = n[non_zero_indices]\n        # Recursively call on the sub-problem\n        return compute_measure(sub_n, alpha)\n\n    # From here, dim = sub_dim and all components of n are non-zero.\n    \n    # Handle the 1D case explicitly for clarity, though it's covered by the \n    # transformation logic as well.\n    if dim == 1:\n        n0 = n[0]\n        if n0 > 0:\n            val = alpha / n0\n        else: # n0 < 0\n            # n0*x <= alpha => x >= alpha/n0.\n            # measure of x in [0,1] is 1 - alpha/n0\n            val = 1.0 - (alpha / n0)\n        return np.clip(val, 0.0, 1.0)\n        \n    # Stage 2: Transformation to a Canonical Form (all normal components non-negative)\n    n_prime = n.copy()\n    alpha_prime = alpha\n    for i in range(dim):\n        if n_prime[i] < 0:\n            alpha_prime -= n_prime[i]\n            n_prime[i] = -n_prime[i]\n\n    # After transformation, n_prime has all positive components.\n    \n    # Stage 3: Bounding and Trivial Cases for the canonical problem\n    if alpha_prime <= TOL:\n        return 0.0\n    if alpha_prime >= np.sum(n_prime):\n        return 1.0\n\n    # Stage 4: Inclusion-Exclusion Formula for measure calculation\n    total_volume_term = 0.0\n    \n    # Iterate over all subset sizes k = 0, 1, ..., dim\n    for k in range(dim + 1):\n        # The sign of the term in the inclusion-exclusion sum\n        term_sign = (-1)**k\n        \n        # Iterate over all subsets of indices of size k\n        for subset_indices in combinations(range(dim), k):\n            n_subset_sum = np.sum(n_prime[list(subset_indices)])\n            \n            current_alpha = alpha_prime - n_subset_sum\n            \n            # The Heaviside function H(...) implemented by this check\n            if current_alpha > TOL:\n                term = (current_alpha**dim)\n                total_volume_term += term_sign * term\n    \n    prod_n = np.prod(n_prime)\n    factorial_d = math.factorial(dim)\n    \n    final_measure = total_volume_term / (factorial_d * prod_n)\n    \n    return np.clip(final_measure, 0.0, 1.0)\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # 2D cases\n        {'n': (1,0), 'alpha': 0.37, 'expected': 0.37, 'dim': 2},\n        {'n': (1,0), 'alpha': -1e-12, 'expected': 0.0, 'dim': 2},\n        {'n': (1,0), 'alpha': 1.2, 'expected': 1.0, 'dim': 2},\n        {'n': (1,1), 'alpha': 0.5, 'expected': 0.125, 'dim': 2},\n        {'n': (1,1), 'alpha': 1e-4, 'expected': 5e-9, 'dim': 2},\n        {'n': (1,1), 'alpha': 1.99, 'expected': 0.99995, 'dim': 2},\n        {'n': (0,1), 'alpha': 0.65, 'expected': 0.65, 'dim': 2},\n        # 3D cases\n        {'n': (1,0,0), 'alpha': 0.37, 'expected': 0.37, 'dim': 3},\n        {'n': (1,0,0), 'alpha': -1e-12, 'expected': 0.0, 'dim': 3},\n        {'n': (1,0,0), 'alpha': 1.2, 'expected': 1.0, 'dim': 3},\n        {'n': (1,1,1), 'alpha': 0.5, 'expected': 0.020833333333333332, 'dim': 3},\n        {'n': (1,1,1), 'alpha': 0.01, 'expected': 1.6666666666666667e-07, 'dim': 3},\n        {'n': (1,1,1), 'alpha': 2.99, 'expected': 0.9999998333333334, 'dim': 3},\n        {'n': (0,1,0), 'alpha': 0.65, 'expected': 0.65, 'dim': 3},\n    ]\n\n    eps_abs = 1e-9\n    eps_rel = 1e-9\n    \n    results = []\n    \n    for case in test_cases:\n        computed_measure = compute_measure(case['n'], case['alpha'])\n        expected_measure = case['expected']\n        \n        abs_error = abs(computed_measure - expected_measure)\n        \n        # Pass/fail criterion: |m_comp - m_exp| <= max(eps_abs, eps_rel * max(1, |m_exp|))\n        tolerance = max(eps_abs, eps_rel * max(1.0, abs(expected_measure)))\n\n        passed = abs_error <= tolerance\n        results.append(passed)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With the principles of static reconstruction in hand, we now turn to its application in fluid dynamics: advection. In geometric Volume of Fluid (VOF) methods, the amount of fluid transported across a cell face is found by calculating the volume of the \"swept\" fluid region. This exercise provides a concrete example of this process, challenging you to compute the exact PLIC flux for a simple, constant-velocity flow, thus bridging the gap between static interface geometry and dynamic transport. ",
            "id": "4004075",
            "problem": "Consider a uniform Cartesian grid used in a Volume of Fluid (VOF) method with Piecewise Linear Interface Construction (PLIC) for two-phase advection in a computational thermal engineering context. Focus on a single donor cell whose local coordinates are defined as $x \\in [0,\\Delta x]$, $y \\in [0,\\Delta y]$, and $z \\in [0,\\Delta z]$. The flow velocity is constant and aligned with the $x$-direction, $\\mathbf{u} = (u,0,0)$, and the Courant–Friedrichs–Lewy (CFL) number $\\mathrm{CFL} = u \\Delta t / \\Delta x$ satisfies $\\mathrm{CFL} < 1$. The interface within the donor cell is reconstructed by PLIC as the intersection of the cell with a plane described by the equation $n_x x + n_y y + n_z z = \\alpha$, where $\\mathbf{n} = (n_x,n_y,n_z)$ is the unit normal supplied by the VOF gradient and $\\alpha$ is the plane constant determined by the local volume fraction.\n\nAssume the following values:\n- $\\Delta x = 0.01\\,\\mathrm{m}$, $\\Delta y = 0.02\\,\\mathrm{m}$, $\\Delta z = 0.01\\,\\mathrm{m}$,\n- $u = 1\\,\\mathrm{m/s}$, $\\Delta t = 0.003\\,\\mathrm{s}$ (so $\\mathrm{CFL} = 0.3$),\n- $\\mathbf{n} = (0.6,0.8,0)$ (a unit vector),\n- $\\alpha = 0.014\\,\\mathrm{m}$.\n\nUnder constant advection during the time step, the exact PLIC flux of the reconstructed fluid across the right (vertical) cell face at $x = \\Delta x$ equals the volume of the portion of the reconstructed fluid region that lies in the swept slab $x \\in [\\Delta x - d, \\Delta x]$, where $d = u \\Delta t$. Starting from conservation of the indicator function and geometric advection with constant velocity, compute the exact PLIC volumetric flux $F$ crossing the right face in the time interval $\\Delta t$. Express your final answer in $\\mathrm{m^3}$ and round your result to five significant figures.",
            "solution": "The problem requires the calculation of the volumetric flux, $F$, of a fluid across the right face of a computational cell during a time step $\\Delta t$. The fluid interface is represented by a plane using the Piecewise Linear Interface Construction (PLIC) method within the Volume of Fluid (VOF) framework.\n\nThe problem states that the volumetric flux $F$ is equal to the volume of the reconstructed fluid region that lies within a \"swept slab\" defined by $x \\in [\\Delta x - d, \\Delta x]$, where $d = u \\Delta t$. This is a standard geometric interpretation of advection for a constant velocity field.\n\nThe region of interest is a polyhedron defined by the intersection of several half-spaces:\n1.  The reconstructed fluid region: The interface is given by the plane $n_x x + n_y y + n_z z = \\alpha$. The normal vector $\\mathbf{n}$ is typically defined as pointing away from the fluid. Thus, the fluid occupies the space where $n_x x + n_y y + n_z z \\le \\alpha$.\n2.  The swept slab: The advection is purely in the $x$-direction, so the volume that crosses the face at $x=\\Delta x$ in time $\\Delta t$ originates from the slab defined by $x \\in [\\Delta x - u\\Delta t, \\Delta x]$.\n3.  The cell boundaries: The calculation is confined to the donor cell, which imposes the bounds $y \\in [0, \\Delta y]$ and $z \\in [0, \\Delta z]$.\n\nThe total volume to be calculated, $F$, is given by the integral of $1$ over the region $V$ defined by all these constraints.\nLet's first substitute the given numerical values for the parameters.\nCell dimensions: $\\Delta x = 0.01\\,\\mathrm{m}$, $\\Delta y = 0.02\\,\\mathrm{m}$, $\\Delta z = 0.01\\,\\mathrm{m}$.\nFlow parameters: $u = 1\\,\\mathrm{m/s}$, $\\Delta t = 0.003\\,\\mathrm{s}$.\nThe advection distance is $d = u \\Delta t = (1\\,\\mathrm{m/s})(0.003\\,\\mathrm{s}) = 0.003\\,\\mathrm{m}$.\nThe swept slab is therefore the region where $x \\in [0.01 - 0.003, 0.01]$, which simplifies to $x \\in [0.007, 0.01]$.\n\nInterface plane definition:\nNormal vector $\\mathbf{n} = (0.6, 0.8, 0)$.\nPlane constant $\\alpha = 0.014\\,\\mathrm{m}$.\nThe fluid is in the region defined by the inequality:\n$0.6x + 0.8y + 0z \\le 0.014$, which simplifies to $0.6x + 0.8y \\le 0.014$.\n\nThe volume $F$ is the integral over the region $V$ defined by the following inequalities:\n1. $0.007 \\le x \\le 0.01$\n2. $0 \\le y \\le 0.02$\n3. $0 \\le z \\le 0.01$\n4. $0.6x + 0.8y \\le 0.014$\n\nThe expression for the fluid region does not depend on the variable $z$ (since $n_z=0$). This means that for any given $(x, y)$ pair, the integrand is constant along the $z$-direction. The integration over $z$ can be performed first and simply results in multiplying the area of the $xy$-projection of the region by the cell depth $\\Delta z$.\n\nLet $A$ be the area of the two-dimensional region in the $xy$-plane defined by:\n1. $0.007 \\le x \\le 0.01$\n2. $0 \\le y \\le 0.02$\n3. $0.6x + 0.8y \\le 0.014$\n\nThe flux volume is then $F = A \\times \\Delta z$. We now focus on calculating $A$.\nThe third inequality can be rewritten to express $y$ as a function of $x$:\n$0.8y \\le 0.014 - 0.6x$\n$y \\le \\frac{0.014 - 0.6x}{0.8}$\n$y \\le 0.0175 - 0.75x$\n\nSo, the region $A$ is bounded by $x=0.007$, $x=0.01$, $y=0$, and $y \\le \\min(0.02, 0.0175 - 0.75x)$.\nWe must check if the line $y = 0.0175 - 0.75x$ intersects with the top of the cell $y = 0.02$ within our $x$-integration domain $[0.007, 0.01]$.\nLet's evaluate the upper bound $0.0175 - 0.75x$ at the limits of the $x$-domain:\nAt $x = 0.007$: $y = 0.0175 - 0.75(0.007) = 0.0175 - 0.00525 = 0.01225$.\nAt $x = 0.01$: $y = 0.0175 - 0.75(0.01) = 0.0175 - 0.0075 = 0.01$.\n\nSince both $0.01225$ and $0.01$ are less than the cell height $\\Delta y = 0.02$, the top boundary of the integration area is always given by the line $y = 0.0175 - 0.75x$, and the cell boundary $y = 0.02$ is not a constraint on the area.\nThe area $A$ can be calculated by the integral:\n$$ A = \\int_{0.007}^{0.01} \\left( \\int_0^{0.0175 - 0.75x} dy \\right) dx $$\n$$ A = \\int_{0.007}^{0.01} (0.0175 - 0.75x) dx $$\nThis integral represents the area of a trapezoid. We can solve it directly:\n$$ A = \\left[ 0.0175x - 0.75\\frac{x^2}{2} \\right]_{0.007}^{0.01} = \\left[ 0.0175x - 0.375x^2 \\right]_{0.007}^{0.01} $$\nSubstituting the limits:\n$$ A = (0.0175(0.01) - 0.375(0.01)^2) - (0.0175(0.007) - 0.375(0.007)^2) $$\n$$ A = (0.000175 - 0.375(0.0001)) - (0.0001225 - 0.375(0.000049)) $$\n$$ A = (0.000175 - 0.0000375) - (0.0001225 - 0.000018375) $$\n$$ A = 0.0001375 - 0.000104125 $$\n$$ A = 0.000033375\\,\\mathrm{m}^2 $$\nThis calculation can be verified using the geometric formula for a trapezoid: Area $= \\frac{1}{2}(\\text{height}_1 + \\text{height}_2) \\times \\text{width}$.\nWidth $w = 0.01 - 0.007 = 0.003\\,\\mathrm{m}$.\nHeights are $h_1 = 0.01225\\,\\mathrm{m}$ (at $x=0.007$) and $h_2 = 0.01\\,\\mathrm{m}$ (at $x=0.01$).\n$$ A = \\frac{1}{2}(0.01225 + 0.01)(0.003) = \\frac{1}{2}(0.02225)(0.003) = 0.011125 \\times 0.003 = 0.000033375\\,\\mathrm{m}^2 $$\nThe results match.\n\nFinally, we calculate the volumetric flux $F$ by multiplying the area $A$ by the cell depth $\\Delta z$:\n$$ F = A \\times \\Delta z = (0.000033375\\,\\mathrm{m}^2) \\times (0.01\\,\\mathrm{m}) $$\n$$ F = 0.00000033375\\,\\mathrm{m}^3 $$\nIn scientific notation, this is $F = 3.3375 \\times 10^{-7}\\,\\mathrm{m}^3$.\nThe problem requires the answer to be rounded to five significant figures. The calculated value $3.3375 \\times 10^{-7}$ already has exactly five significant figures.",
            "answer": "$$\n\\boxed{3.3375 \\times 10^{-7}}\n$$"
        }
    ]
}