{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of non-premixed combustion modeling is the mixture fraction, $Z$, a conserved scalar that tracks the mixing between fuel and oxidizer streams. In a turbulent flow, $Z$ is not a single value at a point in space but is instead characterized by a statistical distribution, often modeled by a Probability Density Function (PDF). This first exercise provides a concrete application of this concept by having you calculate the fundamental statistical moments—the mean and variance—of the mixture fraction in a canonical jet configuration, starting from prescribed inlet distributions . Mastering this calculation builds an essential foundation for understanding how turbulent mixing is quantified and propagated in combustion models.",
            "id": "4000407",
            "problem": "A coaxial turbulent jet combustor is modeled using the presumed Probability Density Function (PDF) approach consistent with the mixture fraction flamelet methodology, with small-scale scalar mixing occurring on the Eddy Dissipation Concept (EDC) timescale so that, at the nozzle exit, each fluid element is an instantaneous mass-weighted mixture of the fuel-core and oxidizer-coflow scalars. The mixture fraction, denoted by $Z$, is defined as a conserved scalar representing the mass fraction of fuel elements in the mixture. The inlet mixture fraction distributions in the core fuel stream and the coflow oxidizer stream are modeled as independent Beta distributions: $Z_{f} \\sim \\operatorname{Beta}(a_{f}, b_{f})$ and $Z_{o} \\sim \\operatorname{Beta}(a_{o}, b_{o})$, with $(a_{f}, b_{f}) = (19, 1)$ and $(a_{o}, b_{o}) = (1, 19)$. The fuel core issues through a circular nozzle of diameter $D_{f} = 4 \\times 10^{-3}\\ \\text{m}$ with uniform axial speed $U_{f} = 50\\ \\text{m}\\,\\text{s}^{-1}$ and density $\\rho_{f} = 0.8\\ \\text{kg}\\,\\text{m}^{-3}$. The coflow oxidizer fills an annulus with inner diameter equal to the fuel nozzle diameter and outer diameter $D_{o} = 16 \\times 10^{-3}\\ \\text{m}$, with uniform axial speed $U_{o} = 5\\ \\text{m}\\,\\text{s}^{-1}$ and density $\\rho_{o} = 1.2\\ \\text{kg}\\,\\text{m}^{-3}$.\n\nAssume that, at the nozzle exit plane, instantaneous scalar mixing within the fine structures leads to a convex linear combination of independent draws from the two inlet PDFs, such that the exit mixture fraction for a fluid element is\n$$\nZ_{\\text{exit}} \\;=\\; \\varepsilon\\, Z_{f} \\;+\\; (1 - \\varepsilon)\\, Z_{o},\n$$\nwhere the mixing weight $\\varepsilon$ is the mass fraction of fuel entering the exit plane control surface,\n$$\n\\varepsilon \\;=\\; \\frac{\\dot{m}_{f}}{\\dot{m}_{f} + \\dot{m}_{o}}, \\quad \\dot{m}_{f} \\;=\\; \\rho_{f} A_{f} U_{f}, \\quad \\dot{m}_{o} \\;=\\; \\rho_{o} A_{o} U_{o},\n$$\nwith $A_{f}$ the core fuel area and $A_{o}$ the oxidizer annulus area. Here $A_{f} = \\pi (D_{f}/2)^{2}$ and $A_{o} = \\pi \\left[(D_{o}/2)^{2} - (D_{f}/2)^{2}\\right]$.\n\nUsing only first principles of mass conservation, properties of expectation and variance for linear combinations of independent random variables, and standard facts about Beta distributions, compute the mean $\\mathbb{E}[Z_{\\text{exit}}]$ and variance $\\operatorname{Var}(Z_{\\text{exit}})$ of the exit mixture fraction. Express your final answer as two exact fractions (no units; $Z$ is dimensionless) in a single row matrix in the order $\\left(\\mathbb{E}[Z_{\\text{exit}}},\\, \\operatorname{Var}(Z_{\\text{exit}})\\right)$. If you choose to provide decimal values instead of exact fractions, round both values to six significant figures.",
            "solution": "The problem is subjected to validation against the specified criteria.\n\n### Step 1: Extract Givens\n- **Model Framework**: Presumed Probability Density Function (PDF) approach, mixture fraction flamelet methodology, Eddy Dissipation Concept (EDC) timescale.\n- **Physical System**: Coaxial turbulent jet combustor.\n- **Mixture Fraction $Z$**: A conserved scalar representing the mass fraction of fuel elements in the mixture.\n- **Fuel Stream Inlet Distribution**: $Z_{f} \\sim \\operatorname{Beta}(a_{f}, b_{f})$ with $(a_{f}, b_{f}) = (19, 1)$.\n- **Oxidizer Stream Inlet Distribution**: $Z_{o} \\sim \\operatorname{Beta}(a_{o}, b_{o})$ with $(a_{o}, b_{o}) = (1, 19)$.\n- **Independence**: $Z_{f}$ and $Z_{o}$ are independent random variables.\n- **Geometries and Flow Conditions**:\n  - Fuel nozzle diameter: $D_{f} = 4 \\times 10^{-3}\\ \\text{m}$.\n  - Fuel axial speed: $U_{f} = 50\\ \\text{m}\\,\\text{s}^{-1}$.\n  - Fuel density: $\\rho_{f} = 0.8\\ \\text{kg}\\,\\text{m}^{-3}$.\n  - Oxidizer annulus outer diameter: $D_{o} = 16 \\times 10^{-3}\\ \\text{m}$.\n  - Oxidizer axial speed: $U_{o} = 5\\ \\text{m}\\,\\text{s}^{-1}$.\n  - Oxidizer density: $\\rho_{o} = 1.2\\ \\text{kg}\\,\\text{m}^{-3}$.\n- **Area Definitions**: $A_{f} = \\pi (D_{f}/2)^{2}$ and $A_{o} = \\pi \\left[(D_{o}/2)^{2} - (D_{f}/2)^{2}\\right]$.\n- **Exit Mixture Fraction Model**: $Z_{\\text{exit}} = \\varepsilon Z_{f} + (1 - \\varepsilon) Z_{o}$.\n- **Mixing Weight Definition**: $\\varepsilon = \\frac{\\dot{m}_{f}}{\\dot{m}_{f} + \\dot{m}_{o}}$, where $\\dot{m}_{f} = \\rho_{f} A_{f} U_{f}$ and $\\dot{m}_{o} = \\rho_{o} A_{o} U_{o}$.\n- **Objective**: Compute the mean $\\mathbb{E}[Z_{\\text{exit}}]$ and variance $\\operatorname{Var}(Z_{\\text{exit}})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is analyzed for validity:\n- **Scientifically Grounded**: The problem is set within the standard framework of turbulent combustion modeling. The use of mixture fraction, PDF methods, and Beta distributions for bounded scalars is established practice. The physical parameters are realistic for a laboratory-scale jet combustor.\n- **Well-Posed**: The problem is clearly stated, providing all necessary data and definitions to compute the required statistical moments. The objective is unambiguous, and a unique solution can be derived from the given information.\n- **Objective**: The problem is phrased in precise, quantitative, and unbiased language.\n\nThe problem does not exhibit any of the listed invalidity flaws. It is a well-posed, scientifically sound, and formalizable problem in computational thermal engineering.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A detailed solution will be provided.\n\n### Solution Derivation\nThe objective is to compute the mean, $\\mathbb{E}[Z_{\\text{exit}}]$, and variance, $\\operatorname{Var}(Z_{\\text{exit}})$, of the exit mixture fraction $Z_{\\text{exit}}$. The exit mixture fraction is defined as a linear combination of two independent random variables, $Z_{f}$ and $Z_{o}$:\n$$\nZ_{\\text{exit}} = \\varepsilon Z_{f} + (1 - \\varepsilon) Z_{o}\n$$\nThe properties of expectation and variance for such a combination are:\n$$\n\\mathbb{E}[Z_{\\text{exit}}] = \\varepsilon \\mathbb{E}[Z_{f}] + (1 - \\varepsilon) \\mathbb{E}[Z_{o}]\n$$\n$$\n\\operatorname{Var}(Z_{\\text{exit}}) = \\varepsilon^2 \\operatorname{Var}(Z_{f}) + (1 - \\varepsilon)^2 \\operatorname{Var}(Z_{o})\n$$\nThe second expression relies on the specified independence of $Z_{f}$ and $Z_{o}$.\n\nFirst, we determine the mean and variance of the inlet Beta distributions. For a random variable $X \\sim \\operatorname{Beta}(a, b)$, the mean is $\\mathbb{E}[X] = \\frac{a}{a+b}$ and the variance is $\\operatorname{Var}(X) = \\frac{ab}{(a+b)^2(a+b+1)}$.\n\nFor the fuel stream, $Z_{f} \\sim \\operatorname{Beta}(19, 1)$:\n$$\n\\mathbb{E}[Z_{f}] = \\frac{19}{19+1} = \\frac{19}{20}\n$$\n$$\n\\operatorname{Var}(Z_{f}) = \\frac{19 \\times 1}{(19+1)^2(19+1+1)} = \\frac{19}{20^2 \\times 21} = \\frac{19}{400 \\times 21} = \\frac{19}{8400}\n$$\nFor the oxidizer stream, $Z_{o} \\sim \\operatorname{Beta}(1, 19)$:\n$$\n\\mathbb{E}[Z_{o}] = \\frac{1}{1+19} = \\frac{1}{20}\n$$\n$$\n\\operatorname{Var}(Z_{o}) = \\frac{1 \\times 19}{(1+19)^2(1+19+1)} = \\frac{19}{20^2 \\times 21} = \\frac{19}{400 \\times 21} = \\frac{19}{8400}\n$$\nNext, we calculate the mixing weight $\\varepsilon$, which depends on the mass flow rates $\\dot{m}_{f}$ and $\\dot{m}_{o}$. We start by computing the areas $A_f$ and $A_o$.\n$$\nD_{f} = 4 \\times 10^{-3}\\ \\text{m}, \\quad D_{o} = 16 \\times 10^{-3}\\ \\text{m}\n$$\nThe fuel nozzle area is:\n$$\nA_{f} = \\pi \\left(\\frac{D_{f}}{2}\\right)^{2} = \\pi \\left(\\frac{4 \\times 10^{-3}}{2}\\right)^{2} = \\pi (2 \\times 10^{-3})^{2} = 4\\pi \\times 10^{-6}\\ \\text{m}^{2}\n$$\nThe oxidizer annulus area is:\n$$\nA_{o} = \\pi \\left[\\left(\\frac{D_{o}}{2}\\right)^{2} - \\left(\\frac{D_{f}}{2}\\right)^{2}\\right] = \\pi \\left[\\left(\\frac{16 \\times 10^{-3}}{2}\\right)^{2} - \\left(\\frac{4 \\times 10^{-3}}{2}\\right)^{2}\\right]\n$$\n$$\nA_{o} = \\pi [(8 \\times 10^{-3})^{2} - (2 \\times 10^{-3})^{2}] = \\pi [64 \\times 10^{-6} - 4 \\times 10^{-6}] = 60\\pi \\times 10^{-6}\\ \\text{m}^{2}\n$$\nNow, we compute the mass flow rates:\n$$\n\\dot{m}_{f} = \\rho_{f} A_{f} U_{f} = (0.8\\ \\text{kg}\\,\\text{m}^{-3}) (4\\pi \\times 10^{-6}\\ \\text{m}^{2}) (50\\ \\text{m}\\,\\text{s}^{-1}) = 160\\pi \\times 10^{-6}\\ \\text{kg}\\,\\text{s}^{-1}\n$$\n$$\n\\dot{m}_{o} = \\rho_{o} A_{o} U_{o} = (1.2\\ \\text{kg}\\,\\text{m}^{-3}) (60\\pi \\times 10^{-6}\\ \\text{m}^{2}) (5\\ \\text{m}\\,\\text{s}^{-1}) = 360\\pi \\times 10^{-6}\\ \\text{kg}\\,\\text{s}^{-1}\n$$\nThe mixing weight $\\varepsilon$ is:\n$$\n\\varepsilon = \\frac{\\dot{m}_{f}}{\\dot{m}_{f} + \\dot{m}_{o}} = \\frac{160\\pi \\times 10^{-6}}{160\\pi \\times 10^{-6} + 360\\pi \\times 10^{-6}} = \\frac{160}{160 + 360} = \\frac{160}{520} = \\frac{16}{52} = \\frac{4}{13}\n$$\nConsequently, $1 - \\varepsilon = 1 - \\frac{4}{13} = \\frac{9}{13}$.\n\nNow we can compute the mean of the exit mixture fraction:\n$$\n\\mathbb{E}[Z_{\\text{exit}}] = \\varepsilon \\mathbb{E}[Z_{f}] + (1 - \\varepsilon) \\mathbb{E}[Z_{o}] = \\left(\\frac{4}{13}\\right)\\left(\\frac{19}{20}\\right) + \\left(\\frac{9}{13}\\right)\\left(\\frac{1}{20}\\right)\n$$\n$$\n\\mathbb{E}[Z_{\\text{exit}}] = \\frac{4 \\times 19 + 9 \\times 1}{13 \\times 20} = \\frac{76 + 9}{260} = \\frac{85}{260} = \\frac{17 \\times 5}{52 \\times 5} = \\frac{17}{52}\n$$\nFinally, we compute the variance of the exit mixture fraction:\n$$\n\\operatorname{Var}(Z_{\\text{exit}}) = \\varepsilon^2 \\operatorname{Var}(Z_{f}) + (1 - \\varepsilon)^2 \\operatorname{Var}(Z_{o})\n$$\n$$\n\\operatorname{Var}(Z_{\\text{exit}}) = \\left(\\frac{4}{13}\\right)^{2}\\left(\\frac{19}{8400}\\right) + \\left(\\frac{9}{13}\\right)^{2}\\left(\\frac{19}{8400}\\right)\n$$\n$$\n\\operatorname{Var}(Z_{\\text{exit}}) = \\left(\\frac{19}{8400}\\right) \\left[ \\left(\\frac{4}{13}\\right)^{2} + \\left(\\frac{9}{13}\\right)^{2} \\right] = \\left(\\frac{19}{8400}\\right) \\left[ \\frac{16}{169} + \\frac{81}{169} \\right]\n$$\n$$\n\\operatorname{Var}(Z_{\\text{exit}}) = \\left(\\frac{19}{8400}\\right) \\left(\\frac{16 + 81}{169}\\right) = \\left(\\frac{19}{8400}\\right) \\left(\\frac{97}{169}\\right)\n$$\n$$\n\\operatorname{Var}(Z_{\\text{exit}}) = \\frac{19 \\times 97}{8400 \\times 169} = \\frac{1843}{1419600}\n$$\nThe numerator is $19 \\times 97$. The denominator is $8400 \\times 169 = (2^4 \\cdot 3 \\cdot 5^2 \\cdot 7) \\times 13^2$. Since $19$ and $97$ are prime numbers not present in the denominator's factorization, the fraction is irreducible.\n\nThe final answer consists of the pair $(\\mathbb{E}[Z_{\\text{exit}}], \\operatorname{Var}(Z_{\\text{exit}}))$.\n$$\n\\mathbb{E}[Z_{\\text{exit}}] = \\frac{17}{52}\n$$\n$$\n\\operatorname{Var}(Z_{\\text{exit}}) = \\frac{1843}{1419600}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{17}{52}  \\frac{1843}{1419600} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building upon the statistical description of scalar fields, we now address a central challenge in turbulent combustion simulation: the closure of the mean chemical reaction rate. Because chemical reactions are highly nonlinear functions of temperature and species concentrations, the mean reaction rate is not simply the reaction rate at the mean temperature and concentrations. This practice demonstrates the widely used presumed PDF closure method, where the mean rate is found by integrating the instantaneous reaction rate over the joint PDF of the underlying thermochemical variables . This exercise bridges the gap between abstract statistical theory and its practical application in Reynolds-Averaged Navier-Stokes (RANS) flame modeling.",
            "id": "4000391",
            "problem": "A Reynolds-Averaged Navier–Stokes (RANS) simulation of a turbulent nonpremixed methane–air flame is performed using a flamelet/progress-variable approach. In contrast to the Eddy Dissipation Concept (EDC), which closes the mean reaction rate by mixing-limited time scales, the present closure evaluates the mean reaction rate by integrating a tabulated laminar flamelet source term against a presumed joint probability density function (PDF). At a particular computational cell, the Favre-mean reaction rate of a key intermediate species is modeled as\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; \\iint \\dot{\\omega}(Z,c)\\, \\tilde{f}_{Z,c}(Z,c)\\, dZ\\, dc,\n$$\nwhere $Z \\in [0,1]$ is the mixture fraction, $c \\in [0,1]$ is a progress variable, and $\\tilde{f}_{Z,c}(Z,c)$ is the joint Favre PDF of $(Z,c)$. Assume density fluctuations are weak such that the Favre PDF equals the Reynolds PDF at this location. The joint PDF is presumed as statistically independent Beta distributions,\n$$\n\\tilde{f}_{Z,c}(Z,c) \\;=\\; f_Z(Z)\\, f_c(c),\n$$\nwith\n$$\nf_Z(Z) \\;=\\; \\frac{1}{B(\\alpha_Z,\\beta_Z)}\\, Z^{\\alpha_Z-1}\\, (1-Z)^{\\beta_Z-1}, \\quad \\alpha_Z = 4,\\; \\beta_Z = 2,\n$$\n$$\nf_c(c) \\;=\\; \\frac{1}{B(\\alpha_c,\\beta_c)}\\, c^{\\alpha_c-1}\\, (1-c)^{\\beta_c-1}, \\quad \\alpha_c = 3,\\; \\beta_c = 5,\n$$\nwhere $B(\\cdot,\\cdot)$ is the Beta function. The tabulated laminar flamelet library for this species has been locally regressed (in the neighborhood of the cell’s mean state) to the bivariate polynomial\n$$\n\\dot{\\omega}(Z,c) \\;=\\; A\\, Z(1-Z)\\, c \\;+\\; B\\, Z^{2} c^{2} \\;+\\; C\\, c(1-c) \\;+\\; D\\, Z^{3},\n$$\nwith coefficients $A = 4.0$, $B = 10.0$, $C = 1.5$, and $D = 2.0$, in units of $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$. Using only the definitions of Favre averaging, presumed PDF integration, and the Beta distribution, compute the mean reaction rate $\\tilde{\\dot{\\omega}}$ implied by this closure at the given cell.\n\nExpress your final answer in $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$ and round to four significant figures.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard calculation in the field of turbulent combustion modeling, specifically demonstrating the application of a presumed Probability Density Function (PDF) closure. Therefore, the problem is valid, and a solution will be furnished.\n\nThe primary objective is to compute the Favre-mean reaction rate, $\\tilde{\\dot{\\omega}}$, at a specific point in a computational domain. This quantity is defined by the integral of the instantaneous reaction rate, $\\dot{\\omega}(Z,c)$, weighted by the joint Favre PDF of mixture fraction, $Z$, and progress variable, $c$:\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; \\iint \\dot{\\omega}(Z,c)\\, \\tilde{f}_{Z,c}(Z,c)\\, dZ\\, dc\n$$\nThe integration is performed over the entire sample space of $Z$ and $c$, which are both defined on the interval $[0,1]$.\n\nThe problem specifies that the joint PDF, $\\tilde{f}_{Z,c}(Z,c)$, is presumed to be composed of two statistically independent Beta distributions, one for $Z$ and one for $c$:\n$$\n\\tilde{f}_{Z,c}(Z,c) \\;=\\; f_Z(Z)\\, f_c(c)\n$$\nThe instantaneous source term, $\\dot{\\omega}(Z,c)$, is given as a bivariate polynomial:\n$$\n\\dot{\\omega}(Z,c) \\;=\\; A\\, Z(1-Z)\\, c \\;+\\; B\\, Z^{2} c^{2} \\;+\\; C\\, c(1-c) \\;+\\; D\\, Z^{3}\n$$\nSubstituting these forms into the definition of the mean reaction rate yields:\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; \\int_0^1 \\int_0^1 \\left( A\\, Z(1-Z)\\, c \\;+\\; B\\, Z^{2} c^{2} \\;+\\; C\\, c(1-c) \\;+\\; D\\, Z^{3} \\right) f_Z(Z)\\, f_c(c)\\, dZ\\, dc\n$$\nBy the linearity of integration, this can be expressed as the expectation of $\\dot{\\omega}(Z,c)$, which can be separated into a sum of terms:\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; E[\\dot{\\omega}(Z,c)] \\;=\\; A\\, E[Z(1-Z)c] \\;+\\; B\\, E[Z^2 c^2] \\;+\\; C\\, E[c(1-c)] \\;+\\; D\\, E[Z^3]\n$$\nDue to the statistical independence of $Z$ and $c$, the expectation of a product of functions of $Z$ and $c$ is the product of their individual expectations, i.e., $E[g(Z)h(c)] = E[g(Z)]E[h(c)]$. Applying this principle, the expression becomes:\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; A\\, E[Z-Z^2] E[c] \\;+\\; B\\, E[Z^2] E[c^2] \\;+\\; C\\, E[c-c^2] \\;+\\; D\\, E[Z^3]\n$$\nUsing the linearity of expectation again, $E[X-Y] = E[X]-E[Y]$, we have:\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; A (E[Z] - E[Z^2]) E[c] \\;+\\; B E[Z^2] E[c^2] \\;+\\; C (E[c] - E[c^2]) \\;+\\; D E[Z^3]\n$$\nThis expression requires the computation of the first three raw moments of $Z$ and the first two raw moments of $c$. For a random variable $X$ following a Beta distribution $X \\sim \\text{Beta}(\\alpha, \\beta)$, the $k$-th raw moment, $E[X^k]$, is given by:\n$$\nE[X^k] \\;=\\; \\frac{B(\\alpha+k, \\beta)}{B(\\alpha, \\beta)} \\;=\\; \\frac{\\Gamma(\\alpha+k)\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\alpha+\\beta+k)}\n$$\nA more direct recursive formula is:\n$$ E[X^k] = E[X^{k-1}] \\frac{\\alpha+k-1}{\\alpha+\\beta+k-1} \\quad \\text{for } k \\geq 1, \\text{ with } E[X^0] = 1 $$\nAnd the mean is $E[X] = \\frac{\\alpha}{\\alpha+\\beta}$.\n\nFirst, we compute the moments for the mixture fraction $Z$, which follows a Beta distribution with parameters $\\alpha_Z = 4$ and $\\beta_Z = 2$.\nThe first moment (mean) is:\n$$ E[Z] \\;=\\; \\frac{\\alpha_Z}{\\alpha_Z+\\beta_Z} \\;=\\; \\frac{4}{4+2} \\;=\\; \\frac{4}{6} \\;=\\; \\frac{2}{3} $$\nThe second moment is:\n$$ E[Z^2] \\;=\\; E[Z] \\frac{\\alpha_Z+1}{\\alpha_Z+\\beta_Z+1} \\;=\\; \\frac{2}{3} \\cdot \\frac{4+1}{4+2+1} \\;=\\; \\frac{2}{3} \\cdot \\frac{5}{7} \\;=\\; \\frac{10}{21} $$\nThe third moment is:\n$$ E[Z^3] \\;=\\; E[Z^2] \\frac{\\alpha_Z+2}{\\alpha_Z+\\beta_Z+2} \\;=\\; \\frac{10}{21} \\cdot \\frac{4+2}{4+2+2} \\;=\\; \\frac{10}{21} \\cdot \\frac{6}{8} \\;=\\; \\frac{10}{21} \\cdot \\frac{3}{4} \\;=\\; \\frac{30}{84} \\;=\\; \\frac{5}{14} $$\n\nNext, we compute the moments for the progress variable $c$, which follows a Beta distribution with parameters $\\alpha_c = 3$ and $\\beta_c = 5$.\nThe first moment (mean) is:\n$$ E[c] \\;=\\; \\frac{\\alpha_c}{\\alpha_c+\\beta_c} \\;=\\; \\frac{3}{3+5} \\;=\\; \\frac{3}{8} $$\nThe second moment is:\n$$ E[c^2] \\;=\\; E[c] \\frac{\\alpha_c+1}{\\alpha_c+\\beta_c+1} \\;=\\; \\frac{3}{8} \\cdot \\frac{3+1}{3+5+1} \\;=\\; \\frac{3}{8} \\cdot \\frac{4}{9} \\;=\\; \\frac{12}{72} \\;=\\; \\frac{1}{6} $$\n\nWe now have all the necessary moments. We compute the required combinations:\n$$ E[Z] - E[Z^2] \\;=\\; \\frac{2}{3} - \\frac{10}{21} \\;=\\; \\frac{14}{21} - \\frac{10}{21} \\;=\\; \\frac{4}{21} $$\n$$ E[c] - E[c^2] \\;=\\; \\frac{3}{8} - \\frac{1}{6} \\;=\\; \\frac{9}{24} - \\frac{4}{24} \\;=\\; \\frac{5}{24} $$\n\nSubstitute these values back into the equation for $\\tilde{\\dot{\\omega}}$:\n$$ \\tilde{\\dot{\\omega}} \\;=\\; A \\left(\\frac{4}{21}\\right) \\left(\\frac{3}{8}\\right) \\;+\\; B \\left(\\frac{10}{21}\\right) \\left(\\frac{1}{6}\\right) \\;+\\; C \\left(\\frac{5}{24}\\right) \\;+\\; D \\left(\\frac{5}{14}\\right) $$\nNow, we substitute the given coefficients $A = 4.0$, $B = 10.0$, $C = 1.5$, and $D = 2.0$. It is prudent to use their exact fractional forms, $A=4$, $B=10$, $C=3/2$, $D=2$, for precision.\n$$ \\tilde{\\dot{\\omega}} \\;=\\; (4) \\left(\\frac{12}{168}\\right) \\;+\\; (10) \\left(\\frac{10}{126}\\right) \\;+\\; \\left(\\frac{3}{2}\\right) \\left(\\frac{5}{24}\\right) \\;+\\; (2) \\left(\\frac{5}{14}\\right) $$\nSimplify each term:\n$$ \\tilde{\\dot{\\omega}} \\;=\\; (4) \\left(\\frac{1}{14}\\right) \\;+\\; (10) \\left(\\frac{5}{63}\\right) \\;+\\; \\left(\\frac{15}{48}\\right) \\;+\\; \\left(\\frac{10}{14}\\right) $$\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{4}{14} \\;+\\; \\frac{50}{63} \\;+\\; \\frac{5}{16} \\;+\\; \\frac{5}{7} $$\nCombine terms with a common denominator where possible:\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\left(\\frac{2}{7} + \\frac{5}{7}\\right) \\;+\\; \\frac{50}{63} \\;+\\; \\frac{5}{16} \\;=\\; 1 \\;+\\; \\frac{50}{63} \\;+\\; \\frac{5}{16} $$\nTo sum the remaining fractions, we find a common denominator for $63$ and $16$. Since $63 = 3^2 \\cdot 7$ and $16 = 2^4$, they are coprime, and their least common multiple is their product: $63 \\times 16 = 1008$.\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{1008}{1008} \\;+\\; \\frac{50 \\cdot 16}{1008} \\;+\\; \\frac{5 \\cdot 63}{1008} $$\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{1008}{1008} \\;+\\; \\frac{800}{1008} \\;+\\; \\frac{315}{1008} $$\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{1008 + 800 + 315}{1008} \\;=\\; \\frac{2123}{1008} $$\nFinally, we compute the numerical value and round to four significant figures as requested:\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{2123}{1008} \\approx 2.10615079... $$\nRounding to four significant figures gives $2.106$. The units are inherited from the coefficients of $\\dot{\\omega}(Z,c)$, which are $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$.",
            "answer": "$$\\boxed{2.106}$$"
        },
        {
            "introduction": "While presumed PDF models are powerful, more advanced approaches solve a transport equation for the PDF itself, thereby capturing its evolution in time and space more accurately. This final practice introduces you to the numerical engine behind these Filtered Density Function (FDF) methods: the Lagrangian Monte Carlo solver. You will implement a simplified solver for a population of computational \"particles,\" where each particle's properties evolve due to subfilter turbulent mixing and chemical reaction . This coding exercise demystifies how particle methods work and provides tangible insight into the sophisticated interplay between mixing and reaction at the heart of modern turbulent combustion simulation.",
            "id": "4000431",
            "problem": "Implement a Lagrangian Monte Carlo solver for the Filtered Density Function (FDF) of a bounded progress variable $c \\in [0,1]$ undergoing subfilter micromixing modeled by the Interaction by Exchange with the Mean (IEM) closure and a nonlinear reaction source. The problem is zero-dimensional and statistically homogeneous, so there is no spatial transport, and all filtering reduces to ensemble averaging. The subfilter dynamics of each Lagrangian particle representation of $c$ are given by an ordinary differential equation with a relaxation-to-mean micromixing term and a deterministic reaction source. The objective is to compute the filtered mean and filtered variance of $c$ at a specified final time for a set of test cases.\n\nStart from the following fundamental base:\n- The definition of a probability density function and its representation by Monte Carlo samples: ensemble averages approximate filtered quantities, i.e., for $N$ particles, $\\tilde{c}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} c_i(t)$ and $\\widetilde{c^{\\prime\\prime 2}}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} \\left(c_i(t)-\\tilde{c}(t)\\right)^2$ under statistical homogeneity and unit density.\n- The deterministic IEM micromixing model posits a linear relaxation of each sample toward the instantaneous filtered mean with a relaxation time scale $\\tau_{\\text{mix}}$, so micromixing preserves the mean while dissipating variance.\n- The filtered density function approach in a zero-dimensional homogeneous setting implies that the evolution of particle samples directly governs the filtered statistics.\n\nYour solver must implement the following model:\n- For each particle $i$, evolve $c_i(t)$ according to\n$$\n\\frac{d c_i}{dt} = -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i - \\tilde{c}\\right) + \\omega\\!\\left(c_i\\right),\n$$\nwhere $\\tilde{c} = \\mathbb{E}[c]$ is the filtered mean approximated by the ensemble mean of the particle population at the current time, and $\\omega(c)$ is a prescribed reaction source term.\n- Use the reaction source term\n$$\n\\omega(c) = \\mathrm{Da} \\, c^{1/2} (1-c),\n$$\nwhere $\\mathrm{Da}$ is a Damköhler-like non-dimensional reaction intensity parameter.\n- Enforce the boundedness constraint $c \\in [0,1]$ at all times by clipping after each time step if necessary.\n- Discretize in time with a forward Euler scheme. On a time grid $t^n = n\\,\\Delta t$ for integer $n$, the update for each particle reads\n$$\nc_i^{n+1} = c_i^n + \\Delta t \\left[ -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i^n - \\tilde{c}^n\\right) + \\omega\\!\\left(c_i^n\\right) \\right],\n$$\nfollowed by $c_i^{n+1} \\leftarrow \\min\\left(1,\\max\\left(0,c_i^{n+1}\\right)\\right)$.\n\nInitialization:\n- At $t=0$, initialize $c_i(0)$ independently from a Beta distribution with shape parameters $(\\alpha,\\beta)$ on $[0,1]$. Use a fixed pseudorandom seed to ensure reproducibility across runs.\n\nQuantities to compute:\n- At the specified final time $T$, compute the filtered mean $\\tilde{c}(T)$ and the filtered variance $\\widetilde{c^{\\prime\\prime 2}}(T)$ using population formulas with normalization by $N$ (not $N-1$).\n\nTest suite:\nYour program must compute results for the following four cases. All quantities are dimensionless.\n- Case A (balanced mixing and reaction):\n  - $N = 4096$, $T = 0.5$, $\\Delta t = 5\\times 10^{-4}$, $\\tau_{\\text{mix}} = 0.2$, $\\mathrm{Da} = 3.0$, $(\\alpha,\\beta) = (2.0, 5.0)$.\n- Case B (no mixing limit):\n  - $N = 4096$, $T = 0.5$, $\\Delta t = 5\\times 10^{-4}$, $\\tau_{\\text{mix}} = 10^{9}$, $\\mathrm{Da} = 3.0$, $(\\alpha,\\beta) = (2.0, 5.0)$.\n- Case C (very strong mixing):\n  - $N = 4096$, $T = 0.1$, $\\Delta t = 10^{-4}$, $\\tau_{\\text{mix}} = 10^{-3}$, $\\mathrm{Da} = 3.0$, $(\\alpha,\\beta) = (0.7, 0.7)$.\n- Case D (no reaction):\n  - $N = 4096$, $T = 0.5$, $\\Delta t = 5\\times 10^{-4}$, $\\tau_{\\text{mix}} = 0.1$, $\\mathrm{Da} = 0.0$, $(\\alpha,\\beta) = (2.0, 5.0)$.\n\nRandomness:\n- Use a fixed global pseudorandom seed of $42$ to initialize the random number generator. To diversify cases while retaining reproducibility, you may offset the seed per case deterministically (for example, by adding the case index).\n\nOutput:\n- For each case, return the pair $[\\tilde{c}(T), \\widetilde{c^{\\prime\\prime 2}}(T)]$.\n- Your program should produce a single line of output containing the results for the four cases as a comma-separated list of pairs enclosed in square brackets, with each floating-point number rounded to $6$ decimal places. For example, the output format must be\n$[\\,[\\tilde{c}_A,\\widetilde{c^{\\prime\\prime 2}}_A],[\\tilde{c}_B,\\widetilde{c^{\\prime\\prime 2}}_B],[\\tilde{c}_C,\\widetilde{c^{\\prime\\prime 2}}_C],[\\tilde{c}_D,\\widetilde{c^{\\prime\\prime 2}}_D]\\,]$ with each number shown to $6$ decimal places.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of turbulent combustion modeling, specifically the Filtered Density Function (FDF) method. The problem is well-posed, providing a complete and consistent set of mathematical equations, numerical parameters, and initial conditions required for a unique and verifiable solution. The objective is clear and the prescribed methodology is computationally feasible. We may therefore proceed with a principled solution.\n\nThe problem requires the development of a Lagrangian Monte Carlo solver for a system of stochastic particles representing a filtered progress variable, $c$. The context is a zero-dimensional, statistically homogeneous system, where spatial effects are neglected, and filtering becomes equivalent to ensemble averaging. The evolution of each particle is governed by an ordinary differential equation (ODE) that models the interplay of subfilter turbulent micromixing and chemical reaction.\n\nThe state of the progress variable for the $i$-th particle in an ensemble of $N$ particles, denoted $c_i(t)$, evolves according to:\n$$\n\\frac{d c_i}{dt} = -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i - \\tilde{c}\\right) + \\omega\\!\\left(c_i\\right)\n$$\nHere, the first term on the right-hand side represents micromixing, and the second term represents chemical reaction.\n\nThe micromixing process is modeled using the Interaction by Exchange with the Mean (IEM) closure. This model postulates a linear relaxation of each particle's state $c_i$ towards the instantaneous ensemble mean $\\tilde{c}(t)$. The characteristic time scale for this relaxation is $\\tau_{\\text{mix}}$. The IEM model conserves the mean of the ensemble, $\\tilde{c}$, while causing a decay in its variance, $\\widetilde{c^{\\prime\\prime 2}}$, thus modeling the dissipative nature of turbulent mixing.\n\nThe filtered mean $\\tilde{c}(t)$ and filtered variance $\\widetilde{c^{\\prime\\prime 2}}(t)$ are approximated from the Monte Carlo particle ensemble as:\n$$\n\\tilde{c}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} c_i(t)\n$$\n$$\n\\widetilde{c^{\\prime\\prime 2}}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} \\left(c_i(t) - \\tilde{c}(t)\\right)^2\n$$\nThe use of $N$ in the denominator for the variance corresponds to the population variance, consistent with the FDF framework where the particles constitute the full representation of the subfilter statistical population.\n\nThe chemical reaction is described by the source term $\\omega(c)$, given as:\n$$\n\\omega(c) = \\mathrm{Da} \\, c^{1/2} (1-c)\n$$\nwhere $\\mathrm{Da}$ is the Damköhler number, a dimensionless parameter representing the ratio of the mixing time scale to the reaction time scale. The term $c^{1/2}$ introduces nonlinearity, and the $(1-c)$ factor ensures the reaction rate diminishes as the progress variable approaches completion, $c \\to 1$. The progress variable $c$ is physically bounded, $c \\in [0,1]$.\n\nTo solve this system numerically, we discretize the governing ODE in time using the forward Euler method. For a time step $\\Delta t$, the value of $c_i$ at the next time level, $t^{n+1} = t^n + \\Delta t$, is computed from its value at the current time level, $t^n$:\n$$\nc_i^{n+1} = c_i^n + \\Delta t \\left[ -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i^n - \\tilde{c}^n\\right) + \\omega\\!\\left(c_i^n\\right) \\right]\n$$\nwhere $\\tilde{c}^n$ is the ensemble mean of all particle values $\\{c_j^n\\}_{j=1}^N$ at time $t^n$. This explicit time-stepping scheme requires that at each step, the mean $\\tilde{c}^n$ is computed first before updating the individual particle states. For computational efficiency, this update is performed vectorially over the entire particle ensemble.\n\nFollowing each update step, the physical boundedness of the progress variable, $c \\in [0,1]$, must be enforced. This is achieved by clipping the updated values:\n$$\nc_i^{n+1} \\leftarrow \\min\\left(1, \\max\\left(0, c_i^{n+1}\\right)\\right)\n$$\nThis clipping is a direct consequence of the physical constraints on the progress variable and also prevents numerical issues, such as the argument of the square root in the reaction term becoming negative.\n\nThe simulation procedure is as follows:\n1.  **Initialization**: At time $t=0$, for each test case, an ensemble of $N$ particle states $\\{c_i(0)\\}_{i=1}^N$ is initialized. The initial values are drawn as independent and identically distributed random variates from a Beta distribution with specified shape parameters $(\\alpha, \\beta)$. A deterministic pseudorandom seed is used for reproducibility.\n2.  **Time Integration**: The simulation evolves the particle ensemble from $t=0$ to the final time $T$. A loop iterates over the discrete time steps, where each step has a duration of $\\Delta t$. In each iteration, the following sequence is executed:\n    a.  Compute the ensemble mean $\\tilde{c}^n$.\n    b.  Compute the mixing and reaction terms for all particles.\n    c.  Update all particle states $\\{c_i^n\\}$ to $\\{c_i^{n+1}\\}$ using the forward Euler formula.\n    d.  Apply the clipping operation to enforce the bounds $[0,1]$ on all particles.\n3.  **Final Analysis**: Upon reaching the final time $T$, the required statistical moments—the filtered mean $\\tilde{c}(T)$ and the filtered variance $\\widetilde{c^{\\prime\\prime 2}}(T)$—are computed from the final particle ensemble $\\{c_i(T)\\}_{i=1}^N$.\n\nThis procedure is implemented for each of the four specified test cases, which explore different regimes of mixing and reaction intensity by varying the parameters $\\tau_{\\text{mix}}$ and $\\mathrm{Da}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Lagrangian Monte Carlo solver for the Filtered Density Function (FDF)\n    of a bounded progress variable.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (balanced mixing and reaction)\n        {\n            'N': 4096, 'T': 0.5, 'dt': 5e-4, 'tau_mix': 0.2, \n            'Da': 3.0, 'alpha': 2.0, 'beta': 5.0\n        },\n        # Case B (no mixing limit)\n        {\n            'N': 4096, 'T': 0.5, 'dt': 5e-4, 'tau_mix': 10**9, \n            'Da': 3.0, 'alpha': 2.0, 'beta': 5.0\n        },\n        # Case C (very strong mixing)\n        {\n            'N': 4096, 'T': 0.1, 'dt': 1e-4, 'tau_mix': 1e-3, \n            'Da': 3.0, 'alpha': 0.7, 'beta': 0.7\n        },\n        # Case D (no reaction)\n        {\n            'N': 4096, 'T': 0.5, 'dt': 5e-4, 'tau_mix': 0.1, \n            'Da': 0.0, 'alpha': 2.0, 'beta': 5.0\n        },\n    ]\n\n    results = []\n    base_seed = 42\n\n    for i, params in enumerate(test_cases):\n        # Set a deterministic, case-specific seed for reproducibility\n        seed = base_seed + i\n        rng = np.random.default_rng(seed)\n\n        # Unpack parameters for clarity\n        N = params['N']\n        T = params['T']\n        dt = params['dt']\n        tau_mix = params['tau_mix']\n        Da = params['Da']\n        alpha = params['alpha']\n        beta = params['beta']\n\n        # 1. Initialization: Draw particles from a Beta distribution\n        c_particles = rng.beta(alpha, beta, size=N)\n\n        # 2. Time Integration Loop\n        num_steps = int(round(T / dt))\n        for _ in range(num_steps):\n            # a. Compute the filtered mean\n            c_mean_n = np.mean(c_particles)\n\n            # b. Compute reaction and mixing terms\n            # The reaction term is omega(c) = Da * c^(1/2) * (1-c)\n            # np.sqrt is safe as c_particles >= 0 due to clipping in the previous step\n            omega_term = Da * np.sqrt(c_particles) * (1 - c_particles)\n            \n            # The IEM mixing term is -(c_i - c_mean) / tau_mix\n            mixing_term = -(1.0 / tau_mix) * (c_particles - c_mean_n)\n\n            # c. Update particle states using Forward Euler\n            c_particles_new = c_particles + dt * (mixing_term + omega_term)\n            \n            # d. Enforce boundedness constraint c in [0, 1]\n            c_particles = np.clip(c_particles_new, 0.0, 1.0)\n            \n        # 3. Final Analysis: Compute final mean and variance\n        final_mean = np.mean(c_particles)\n        # np.var computes the population variance (denominator N), as required.\n        final_variance = np.var(c_particles)\n        \n        # Format the result pair for this case\n        results.append(f\"[{final_mean:.6f},{final_variance:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}