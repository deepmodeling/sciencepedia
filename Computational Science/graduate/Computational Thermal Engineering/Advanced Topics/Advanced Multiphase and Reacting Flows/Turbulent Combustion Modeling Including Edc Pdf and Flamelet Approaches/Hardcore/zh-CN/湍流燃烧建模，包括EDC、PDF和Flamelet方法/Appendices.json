{
    "hands_on_practices": [
        {
            "introduction": "本练习是许多湍流燃烧模型的核心。我们将探讨如何通过假设关键变量（如混合分数和反应进程变量）的概率密度函数（PDF）的形状，来封闭未封闭的平均反应速率项。该练习让您直接体验执行积分计算的过程，这个过程将微观的化学动力学与在CFD模拟中求解的宏观平均方程联系起来。",
            "id": "4000391",
            "problem": "使用小火焰/反应进程变量方法，对湍流非预混甲烷-空气火焰进行了雷诺平均纳维-斯托克斯 (RANS) 模拟。与通过混合限制时间尺度来封闭平均反应速率的涡耗散概念 (EDC) 不同，本封闭方法通过将列表化的层流小火焰源项与假定的联合概率密度函数 (PDF) 进行积分来评估平均反应速率。在某个特定的计算单元中，一个关键中间产物的Favre平均反应速率被建模为\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; \\iint \\dot{\\omega}(Z,c)\\, \\tilde{f}_{Z,c}(Z,c)\\, dZ\\, dc,\n$$\n其中 $Z \\in [0,1]$ 是混合分数，$c \\in [0,1]$ 是反应进程变量，而 $\\tilde{f}_{Z,c}(Z,c)$ 是 $(Z,c)$ 的联合Favre PDF。假设密度脉动很弱，因此在该位置Favre PDF等于雷诺PDF。联合PDF被假定为统计独立的Beta分布，\n$$\n\\tilde{f}_{Z,c}(Z,c) \\;=\\; f_Z(Z)\\, f_c(c),\n$$\n其中\n$$\nf_Z(Z) \\;=\\; \\frac{1}{B(\\alpha_Z,\\beta_Z)}\\, Z^{\\alpha_Z-1}\\, (1-Z)^{\\beta_Z-1}, \\quad \\alpha_Z = 4,\\; \\beta_Z = 2,\n$$\n$$\nf_c(c) \\;=\\; \\frac{1}{B(\\alpha_c,\\beta_c)}\\, c^{\\alpha_c-1}\\, (1-c)^{\\beta_c-1}, \\quad \\alpha_c = 3,\\; \\beta_c = 5,\n$$\n此处 $B(\\cdot,\\cdot)$ 是Beta函数。该物种的列表化层流小火焰库已在局部（计算单元平均态的邻域内）回归为二元多项式\n$$\n\\dot{\\omega}(Z,c) \\;=\\; A\\, Z(1-Z)\\, c \\;+\\; B\\, Z^{2} c^{2} \\;+\\; C\\, c(1-c) \\;+\\; D\\, Z^{3},\n$$\n其系数为 $A = 4.0$，$B = 10.0$，$C = 1.5$ 和 $D = 2.0$，单位为 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。仅使用Favre平均、假定PDF积分和Beta分布的定义，计算在给定单元处此封闭模型所隐含的平均反应速率 $\\tilde{\\dot{\\omega}}$。\n\n将最终答案以 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "所述问题具有科学依据、提法恰当、客观，并包含了获得唯一解所需的所有信息。这是湍流燃烧模拟领域的一个标准计算，具体展示了假定概率密度函数 (PDF) 封闭模型的应用。因此，该问题是有效的，并将提供解答。\n\n主要目标是计算计算域中一个特定点的Favre平均反应速率 $\\tilde{\\dot{\\omega}}$。该量由瞬时反应速率 $\\dot{\\omega}(Z,c)$ 与混合分数 $Z$ 和反应进程变量 $c$ 的联合Favre PDF进行加权积分定义：\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; \\iint \\dot{\\omega}(Z,c)\\, \\tilde{f}_{Z,c}(Z,c)\\, dZ\\, dc\n$$\n积分在 $Z$ 和 $c$ 的整个样本空间上进行，它们都定义在区间 $[0,1]$ 上。\n\n问题指明，联合PDF $\\tilde{f}_{Z,c}(Z,c)$ 被假定由两个统计独立的Beta分布组成，一个用于 $Z$，一个用于 $c$：\n$$\n\\tilde{f}_{Z,c}(Z,c) \\;=\\; f_Z(Z)\\, f_c(c)\n$$\n瞬时源项 $\\dot{\\omega}(Z,c)$ 以二元多项式形式给出：\n$$\n\\dot{\\omega}(Z,c) \\;=\\; A\\, Z(1-Z)\\, c \\;+\\; B\\, Z^{2} c^{2} \\;+\\; C\\, c(1-c) \\;+\\; D\\, Z^{3}\n$$\n将这些形式代入平均反应速率的定义中，得到：\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; \\int_0^1 \\int_0^1 \\left( A\\, Z(1-Z)\\, c \\;+\\; B\\, Z^{2} c^{2} \\;+\\; C\\, c(1-c) \\;+\\; D\\, Z^{3} \\right) f_Z(Z)\\, f_c(c)\\, dZ\\, dc\n$$\n根据积分的线性性质，这可以表示为 $\\dot{\\omega}(Z,c)$ 的期望，它可以被分解为各项之和：\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; E[\\dot{\\omega}(Z,c)] \\;=\\; A\\, E[Z(1-Z)c] \\;+\\; B\\, E[Z^2 c^2] \\;+\\; C\\, E[c(1-c)] \\;+\\; D\\, E[Z^3]\n$$\n由于 $Z$ 和 $c$ 的统计独立性，$Z$ 的函数与 $c$ 的函数的乘积的期望等于它们各自期望的乘积，即 $E[g(Z)h(c)] = E[g(Z)]E[h(c)]$。应用此原理，表达式变为：\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; A\\, E[Z-Z^2] E[c] \\;+\\; B\\, E[Z^2] E[c^2] \\;+\\; C\\, E[c-c^2] \\;+\\; D\\, E[Z^3]\n$$\n再次利用期望的线性性质 $E[X-Y] = E[X]-E[Y]$，我们得到：\n$$\n\\tilde{\\dot{\\omega}} \\;=\\; A (E[Z] - E[Z^2]) E[c] \\;+\\; B E[Z^2] E[c^2] \\;+\\; C (E[c] - E[c^2]) \\;+\\; D E[Z^3]\n$$\n该表达式需要计算 $Z$ 的前三阶原点矩和 $c$ 的前二阶原点矩。对于一个服从Beta分布 $X \\sim \\text{Beta}(\\alpha, \\beta)$ 的随机变量 $X$，其第 $k$ 阶原点矩 $E[X^k]$ 由以下公式给出：\n$$\nE[X^k] \\;=\\; \\frac{B(\\alpha+k, \\beta)}{B(\\alpha, \\beta)} \\;=\\; \\frac{\\Gamma(\\alpha+k)\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\alpha+\\beta+k)}\n$$\n一个更直接的递推公式是：\n$$ E[X^k] = E[X^{k-1}] \\frac{\\alpha+k-1}{\\alpha+\\beta+k-1} \\quad \\text{for } k \\geq 1, \\text{ with } E[X^0] = 1 $$\n且平均值为 $E[X] = \\frac{\\alpha}{\\alpha+\\beta}$。\n\n首先，我们计算混合分数 $Z$ 的矩，它服从参数为 $\\alpha_Z = 4$ 和 $\\beta_Z = 2$ 的Beta分布。\n一阶矩（平均值）为：\n$$ E[Z] \\;=\\; \\frac{\\alpha_Z}{\\alpha_Z+\\beta_Z} \\;=\\; \\frac{4}{4+2} \\;=\\; \\frac{4}{6} \\;=\\; \\frac{2}{3} $$\n二阶矩为：\n$$ E[Z^2] \\;=\\; E[Z] \\frac{\\alpha_Z+1}{\\alpha_Z+\\beta_Z+1} \\;=\\; \\frac{2}{3} \\cdot \\frac{4+1}{4+2+1} \\;=\\; \\frac{2}{3} \\cdot \\frac{5}{7} \\;=\\; \\frac{10}{21} $$\n三阶矩为：\n$$ E[Z^3] \\;=\\; E[Z^2] \\frac{\\alpha_Z+2}{\\alpha_Z+\\beta_Z+2} \\;=\\; \\frac{10}{21} \\cdot \\frac{4+2}{4+2+2} \\;=\\; \\frac{10}{21} \\cdot \\frac{6}{8} \\;=\\; \\frac{10}{21} \\cdot \\frac{3}{4} \\;=\\; \\frac{30}{84} \\;=\\; \\frac{5}{14} $$\n\n接下来，我们计算反应进程变量 $c$ 的矩，它服从参数为 $\\alpha_c = 3$ 和 $\\beta_c = 5$ 的Beta分布。\n一阶矩（平均值）为：\n$$ E[c] \\;=\\; \\frac{\\alpha_c}{\\alpha_c+\\beta_c} \\;=\\; \\frac{3}{3+5} \\;=\\; \\frac{3}{8} $$\n二阶矩为：\n$$ E[c^2] \\;=\\; E[c] \\frac{\\alpha_c+1}{\\alpha_c+\\beta_c+1} \\;=\\; \\frac{3}{8} \\cdot \\frac{3+1}{3+5+1} \\;=\\; \\frac{3}{8} \\cdot \\frac{4}{9} \\;=\\; \\frac{12}{72} \\;=\\; \\frac{1}{6} $$\n\n现在我们有了所有必需的矩。我们计算所需的组合：\n$$ E[Z] - E[Z^2] \\;=\\; \\frac{2}{3} - \\frac{10}{21} \\;=\\; \\frac{14}{21} - \\frac{10}{21} \\;=\\; \\frac{4}{21} $$\n$$ E[c] - E[c^2] \\;=\\; \\frac{3}{8} - \\frac{1}{6} \\;=\\; \\frac{9}{24} - \\frac{4}{24} \\;=\\; \\frac{5}{24} $$\n\n将这些值代回 $\\tilde{\\dot{\\omega}}$ 的方程中：\n$$ \\tilde{\\dot{\\omega}} \\;=\\; A \\left(\\frac{4}{21}\\right) \\left(\\frac{3}{8}\\right) \\;+\\; B \\left(\\frac{10}{21}\\right) \\left(\\frac{1}{6}\\right) \\;+\\; C \\left(\\frac{5}{24}\\right) \\;+\\; D \\left(\\frac{5}{14}\\right) $$\n现在，我们代入给定的系数 $A = 4.0$，$B = 10.0$，$C = 1.5$ 和 $D = 2.0$。为确保精度，使用它们精确的分数形式是明智的，$A=4$，$B=10$，$C=3/2$，$D=2$。\n$$ \\tilde{\\dot{\\omega}} \\;=\\; (4) \\left(\\frac{12}{168}\\right) \\;+\\; (10) \\left(\\frac{10}{126}\\right) \\;+\\; \\left(\\frac{3}{2}\\right) \\left(\\frac{5}{24}\\right) \\;+\\; (2) \\left(\\frac{5}{14}\\right) $$\n简化每一项：\n$$ \\tilde{\\dot{\\omega}} \\;=\\; (4) \\left(\\frac{1}{14}\\right) \\;+\\; (10) \\left(\\frac{5}{63}\\right) \\;+\\; \\left(\\frac{15}{48}\\right) \\;+\\; \\left(\\frac{10}{14}\\right) $$\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{4}{14} \\;+\\; \\frac{50}{63} \\;+\\; \\frac{5}{16} \\;+\\; \\frac{5}{7} $$\n在可能的情况下，合并具有公分母的项：\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\left(\\frac{2}{7} + \\frac{5}{7}\\right) \\;+\\; \\frac{50}{63} \\;+\\; \\frac{5}{16} \\;=\\; 1 \\;+\\; \\frac{50}{63} \\;+\\; \\frac{5}{16} $$\n为了对剩余的分数求和，我们找到 63 和 16 的公分母。由于 $63 = 3^2 \\cdot 7$ 且 $16 = 2^4$，它们互质，因此它们的最小公倍数是它们的乘积：$63 \\times 16 = 1008$。\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{1008}{1008} \\;+\\; \\frac{50 \\cdot 16}{1008} \\;+\\; \\frac{5 \\cdot 63}{1008} $$\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{1008}{1008} \\;+\\; \\frac{800}{1008} \\;+\\; \\frac{315}{1008} $$\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{1008 + 800 + 315}{1008} \\;=\\; \\frac{2123}{1008} $$\n最后，我们计算数值并按要求四舍五入到四位有效数字：\n$$ \\tilde{\\dot{\\omega}} \\;=\\; \\frac{2123}{1008} \\approx 2.10615079... $$\n四舍五入到四位有效数字得到 $2.106$。单位继承自 $\\dot{\\omega}(Z,c)$ 的系数，即 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。",
            "answer": "$$\\boxed{2.106}$$"
        },
        {
            "introduction": "虽然假定PDF模型功能强大，但某些情况下需要为PDF本身求解一个输运方程。本练习将通过实现一个拉格朗日蒙特卡洛求解器，深入探讨一种流行的方法——滤波密度函数（FDF）方法。您将模拟代表亚格子统计特性的粒子群，如何因湍流混合和化学反应而演化，从而更深入地理解PDF输运模型的内在机理。",
            "id": "4000431",
            "problem": "实现一个拉格朗日蒙特卡洛求解器，用于求解有界进程变量 $c \\in [0,1]$ 的滤波密度函数 (FDF)。该进程变量经历了由均值交换相互作用 (IEM) 闭合模型和非线性反应源模拟的亚滤波器微混合过程。此问题是零维且统计均匀的，因此没有空间输运，所有滤波都简化为系综平均。每个表示 $c$ 的拉格朗日粒子的亚滤波器动力学由一个常微分方程给出，该方程包含一个向均值松弛的微混合项和一个确定性反应源。目标是为一组测试用例计算在指定的最终时刻下 $c$ 的滤波平均值和滤波方差。\n\n从以下基本基础出发：\n- 概率密度函数的定义及其蒙特卡洛样本表示：系综平均近似滤波量，即对于 $N$ 个粒子，在统计均匀性和单位密度下，$\\tilde{c}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} c_i(t)$ 和 $\\widetilde{c^{\\prime\\prime 2}}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} \\left(c_i(t)-\\tilde{c}(t)\\right)^2$。\n- 确定性的 IEM 微混合模型假设每个样本以松弛时间尺度 $\\tau_{\\text{mix}}$ 向瞬时滤波平均值进行线性松弛，因此微混合在保持平均值的同时耗散方差。\n- 在零维均匀设定中，滤波密度函数方法意味着粒子样本的演化直接决定了滤波统计量。\n\n您的求解器必须实现以下模型：\n- 对每个粒子 $i$，根据以下方程演化 $c_i(t)$\n$$\n\\frac{d c_i}{dt} = -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i - \\tilde{c}\\right) + \\omega\\!\\left(c_i\\right),\n$$\n其中 $\\tilde{c} = \\mathbb{E}[c]$ 是滤波平均值，由当前时刻粒子总体的系综平均值近似，而 $\\omega(c)$ 是一个给定的反应源项。\n- 使用反应源项\n$$\n\\omega(c) = \\mathrm{Da} \\, c^{1/2} (1-c),\n$$\n其中 $\\mathrm{Da}$ 是一个类 Damköhler 无量纲反应强度参数。\n- 在所有时刻强制执行有界约束 $c \\in [0,1]$，必要时在每个时间步后进行裁剪。\n- 使用前向欧拉格式进行时间离散。在时间网格 $t^n = n\\,\\Delta t$（其中 $n$ 为整数）上，每个粒子的更新公式为\n$$\nc_i^{n+1} = c_i^n + \\Delta t \\left[ -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i^n - \\tilde{c}^n\\right) + \\omega\\!\\left(c_i^n\\right) \\right],\n$$\n之后进行 $c_i^{n+1} \\leftarrow \\min\\left(1,\\max\\left(0,c_i^{n+1}\\right)\\right)$。\n\n初始化：\n- 在 $t=0$ 时，从 $[0,1]$ 上的贝塔 (Beta) 分布中独立初始化 $c_i(0)$，其形状参数为 $(\\alpha,\\beta)$。使用固定的伪随机种子以确保不同运行之间的可复现性。\n\n需要计算的量：\n- 在指定的最终时间 $T$，使用由 $N$（而非 $N-1$）归一化的总体公式计算滤波平均值 $\\tilde{c}(T)$ 和滤波方差 $\\widetilde{c^{\\prime\\prime 2}}(T)$。\n\n测试套件：\n您的程序必须计算以下四种情况的结果。所有量均为无量纲。\n- 情况 A（平衡混合与反应）：\n  - $N = 4096$, $T = 0.5$, $\\Delta t = 5\\times 10^{-4}$, $\\tau_{\\text{mix}} = 0.2$, $\\mathrm{Da} = 3.0$, $(\\alpha,\\beta) = (2.0, 5.0)$。\n- 情况 B（无混合极限）：\n  - $N = 4096$, $T = 0.5$, $\\Delta t = 5\\times 10^{-4}$, $\\tau_{\\text{mix}} = 10^{9}$, $\\mathrm{Da} = 3.0$, $(\\alpha,\\beta) = (2.0, 5.0)$。\n- 情况 C（极强混合）：\n  - $N = 4096$, $T = 0.1$, $\\Delta t = 10^{-4}$, $\\tau_{\\text{mix}} = 10^{-3}$, $\\mathrm{Da} = 3.0$, $(\\alpha,\\beta) = (0.7, 0.7)$。\n- 情况 D（无反应）：\n  - $N = 4096$, $T = 0.5$, $\\Delta t = 5\\times 10^{-4}$, $\\tau_{\\text{mix}} = 0.1$, $\\mathrm{Da} = 0.0$, $(\\alpha,\\beta) = (2.0, 5.0)$。\n\n随机性：\n- 使用固定的全局伪随机种子 $42$ 来初始化随机数生成器。为了在保持可复现性的同时使各情况多样化，您可以确定性地为每个情况偏移种子（例如，通过加上情况索引）。\n\n输出：\n- 对每种情况，返回数对 $[\\tilde{c}(T), \\widetilde{c^{\\prime\\prime 2}}(T)]$。\n- 您的程序应生成单行输出，其中包含四个情况的结果，格式为由方括号括起来的逗号分隔的数对列表，每个浮点数四舍五入到 $6$ 位小数。例如，输出格式必须是\n$[\\,[\\tilde{c}_A,\\widetilde{c^{\\prime\\prime 2}}_A],[\\tilde{c}_B,\\widetilde{c^{\\prime\\prime 2}}_B],[\\tilde{c}_C,\\widetilde{c^{\\prime\\prime 2}}_C],[\\tilde{c}_D,\\widetilde{c^{\\prime\\prime 2}}_D]\\,]$ 每个数字显示到 $6$ 位小数。",
            "solution": "经评估，该问题陈述有效。它在科学上基于湍流燃烧建模的原理，特别是滤波密度函数 (FDF) 方法。该问题是适定的，提供了求解唯一且可验证解所需的完整且一致的数学方程、数值参数和初始条件。目标明确，所规定的方法在计算上是可行的。因此，我们可以着手进行有原则的求解。\n\n该问题要求开发一个拉格朗日蒙特卡洛求解器，用于处理代表滤波进程变量 $c$ 的随机粒子系统。其背景是一个零维、统计均匀的系统，其中空间效应被忽略，滤波等同于系综平均。每个粒子的演化由一个常微分方程 (ODE) 控制，该方程模拟了亚滤波器湍流微混合与化学反应之间的相互作用。\n\n在一个包含 $N$ 个粒子的系综中，第 $i$ 个粒子的进程变量状态，记为 $c_i(t)$，根据以下方程演化：\n$$\n\\frac{d c_i}{dt} = -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i - \\tilde{c}\\right) + \\omega\\!\\left(c_i\\right)\n$$\n此处，右侧的第一项代表微混合，第二项代表化学反应。\n\n微混合过程使用均值交换相互作用 (IEM) 闭合模型进行建模。该模型假设每个粒子的状态 $c_i$ 向瞬时系综平均值 $\\tilde{c}(t)$ 进行线性松弛。此松弛的特征时间尺度为 $\\tau_{\\text{mix}}$。IEM 模型保持系综的平均值 $\\tilde{c}$ 不变，同时使其方差 $\\widetilde{c^{\\prime\\prime 2}}$ 衰减，从而模拟了湍流混合的耗散性质。\n\n滤波平均值 $\\tilde{c}(t)$ 和滤波方差 $\\widetilde{c^{\\prime\\prime 2}}(t)$ 从蒙特卡洛粒子系综中近似计算如下：\n$$\n\\tilde{c}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} c_i(t)\n$$\n$$\n\\widetilde{c^{\\prime\\prime 2}}(t) \\approx \\frac{1}{N} \\sum_{i=1}^{N} \\left(c_i(t) - \\tilde{c}(t)\\right)^2\n$$\n方差分母中使用 $N$ 对应于总体方差，这与 FDF 框架一致，在该框架中，粒子构成了亚滤波器统计总体的完整表示。\n\n化学反应由源项 $\\omega(c)$ 描述，给定为：\n$$\n\\omega(c) = \\mathrm{Da} \\, c^{1/2} (1-c)\n$$\n其中 $\\mathrm{Da}$ 是 Damköhler 数，一个无量纲参数，表示混合时间尺度与反应时间尺度之比。项 $c^{1/2}$ 引入了非线性，而因子 $(1-c)$ 确保了当进程变量接近完成时 ($c \\to 1$) 反应速率减小。进程变量 $c$ 在物理上有界，即 $c \\in [0,1]$。\n\n为了数值求解该系统，我们使用前向欧拉方法对控制 ODE 进行时间离散。对于时间步长 $\\Delta t$，下一个时间层 $t^{n+1} = t^n + \\Delta t$ 的 $c_i$ 值由其在当前时间层 $t^n$ 的值计算得出：\n$$\nc_i^{n+1} = c_i^n + \\Delta t \\left[ -\\frac{1}{\\tau_{\\text{mix}}}\\left(c_i^n - \\tilde{c}^n\\right) + \\omega\\!\\left(c_i^n\\right) \\right]\n$$\n其中 $\\tilde{c}^n$ 是在时间 $t^n$ 时所有粒子值 $\\{c_j^n\\}_{j=1}^N$ 的系综平均值。这种显式时间步进格式要求在每一步中，先计算平均值 $\\tilde{c}^n$，然后再更新单个粒子的状态。为了计算效率，此更新是在整个粒子系综上以矢量方式执行的。\n\n在每个更新步骤之后，必须强制执行进程变量的物理有界性 $c \\in [0,1]$。这通过裁剪更新后的值来实现：\n$$\nc_i^{n+1} \\leftarrow \\min\\left(1, \\max\\left(0, c_i^{n+1}\\right)\\right)\n$$\n这种裁剪是进程变量物理约束的直接结果，也防止了数值问题，例如反应项中平方根的参数变为负值。\n\n模拟过程如下：\n1.  **初始化**：在时间 $t=0$ 时，对每个测试用例，初始化一个包含 $N$ 个粒子状态的系综 $\\{c_i(0)\\}_{i=1}^N$。初始值是从具有指定形状参数 $(\\alpha, \\beta)$ 的贝塔 (Beta) 分布中抽取的独立同分布随机变量。使用确定性伪随机种子以确保可复现性。\n2.  **时间积分**：模拟将粒子系综从 $t=0$ 演化到最终时间 $T$。一个循环遍历离散的时间步，每个步长为 $\\Delta t$。在每次迭代中，执行以下序列：\n    a.  计算系综平均值 $\\tilde{c}^n$。\n    b.  计算所有粒子的混合项和反应项。\n    c.  使用前向欧拉公式将所有粒子状态 $\\{c_i^n\\}$ 更新为 $\\{c_i^{n+1}\\}$。\n    d.  应用裁剪操作以对所有粒子强制执行 $[0,1]$ 边界。\n3.  **最终分析**：到达最终时间 $T$ 后，从最终的粒子系综 $\\{c_i(T)\\}_{i=1}^N$ 中计算所需的统计矩——滤波平均值 $\\tilde{c}(T)$ 和滤波方差 $\\widetilde{c^{\\prime\\prime 2}}(T)$。\n\n此过程针对四个指定的测试用例分别实现，这些用例通过改变参数 $\\tau_{\\text{mix}}$ 和 $\\mathrm{Da}$ 来探索混合和反应强度的不同区域。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Lagrangian Monte Carlo solver for the Filtered Density Function (FDF)\n    of a bounded progress variable.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (balanced mixing and reaction)\n        {\n            'N': 4096, 'T': 0.5, 'dt': 5e-4, 'tau_mix': 0.2, \n            'Da': 3.0, 'alpha': 2.0, 'beta': 5.0\n        },\n        # Case B (no mixing limit)\n        {\n            'N': 4096, 'T': 0.5, 'dt': 5e-4, 'tau_mix': 10**9, \n            'Da': 3.0, 'alpha': 2.0, 'beta': 5.0\n        },\n        # Case C (very strong mixing)\n        {\n            'N': 4096, 'T': 0.1, 'dt': 1e-4, 'tau_mix': 1e-3, \n            'Da': 3.0, 'alpha': 0.7, 'beta': 0.7\n        },\n        # Case D (no reaction)\n        {\n            'N': 4096, 'T': 0.5, 'dt': 5e-4, 'tau_mix': 0.1, \n            'Da': 0.0, 'alpha': 2.0, 'beta': 5.0\n        },\n    ]\n\n    results = []\n    base_seed = 42\n\n    for i, params in enumerate(test_cases):\n        # Set a deterministic, case-specific seed for reproducibility\n        seed = base_seed + i\n        rng = np.random.default_rng(seed)\n\n        # Unpack parameters for clarity\n        N = params['N']\n        T = params['T']\n        dt = params['dt']\n        tau_mix = params['tau_mix']\n        Da = params['Da']\n        alpha = params['alpha']\n        beta = params['beta']\n\n        # 1. Initialization: Draw particles from a Beta distribution\n        c_particles = rng.beta(alpha, beta, size=N)\n\n        # 2. Time Integration Loop\n        num_steps = int(round(T / dt))\n        for _ in range(num_steps):\n            # a. Compute the filtered mean\n            c_mean_n = np.mean(c_particles)\n\n            # b. Compute reaction and mixing terms\n            # The reaction term is omega(c) = Da * c^(1/2) * (1-c)\n            # np.sqrt is safe as c_particles >= 0 due to clipping in the previous step\n            omega_term = Da * np.sqrt(c_particles) * (1 - c_particles)\n            \n            # The IEM mixing term is -(c_i - c_mean) / tau_mix\n            mixing_term = -(1.0 / tau_mix) * (c_particles - c_mean_n)\n\n            # c. Update particle states using Forward Euler\n            c_particles_new = c_particles + dt * (mixing_term + omega_term)\n            \n            # d. Enforce boundedness constraint c in [0, 1]\n            c_particles = np.clip(c_particles_new, 0.0, 1.0)\n            \n        # 3. Final Analysis: Compute final mean and variance\n        final_mean = np.mean(c_particles)\n        # np.var computes the population variance (denominator N), as required.\n        final_variance = np.var(c_particles)\n        \n        # Format the result pair for this case\n        results.append(f\"[{final_mean:.6f},{final_variance:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "假定和输运PDF方法，以及火焰面模型，都严重依赖于预先计算的化学数据库（即“列表”）来降低计算成本。这些数据库的完整性对于精确模拟至关重要。最后一个练习将侧重于一项关键的实用技能：开发一个程序来验证化学数据库是否自洽，并遵守热力学和元素守恒的基本定律。",
            "id": "4000402",
            "problem": "给定一组列表化的状态，旨在表示用于湍流燃烧模拟的化学表条目，这些条目可用于涡耗散概念 (EDC)、概率密度函数 (PDF) 和基于火焰面的方法。每个表行包含一个热化学状态 $(\\mathbf{Y}, T, p, \\rho, h)$ 以及单位混合物质量的目标元素丰度向量 $\\mathbf{n}_{\\mathrm{elem,target}}$。目标是设计并实现一个严格的一致性检查，对每一行进行验证，确保元素守恒和基本热力学关系得到满足。该检查必须遵循第一性原理，不得依赖任何未经记载的简化公式。\n\n检查的基本依据如下：\n\n- 化学元素守恒：对于选定集合中的每种元素 $e$，单位质量的元素摩尔数 $n_e$ 必须等于通过组分质量分数和分子组成计算得出的各组分贡献之和。\n- 理想气体状态方程：对于无相互作用的理想气体混合物，$p = \\rho R_{\\mathrm{mix}} T$，其中 $R_{\\mathrm{mix}}$ 由混合物组分确定。\n- 具有与温度无关的组分比热的理想混合物中显焓的可加性：$h = \\sum_i Y_i h_i(T)$，其中 $h_i(T)$ 是相对于一个共同的参考温度给出的。\n\n您必须按以下步骤进行。\n\n1. 组分集合、性质和元素组成：\n   - 考虑固定顺序的组分集合 $[\\mathrm{O}_2, \\mathrm{N}_2, \\mathrm{CO}_2, \\mathrm{H}_2\\mathrm{O}, \\mathrm{CO}, \\mathrm{H}_2]$。\n   - 摩尔质量 $\\mathbf{W}$（单位 $\\mathrm{kg/mol}$）由 $[0.0319988, 0.0280134, 0.0440095, 0.01801528, 0.0280101, 0.00201588]$ 给出。\n   - 组分的定压比热 $\\mathbf{c}_p$（单位 $\\mathrm{J/(kg\\cdot K)}$）是恒定的，由 $[918.0, 1040.0, 844.0, 1860.0, 1040.0, 14310.0]$ 给出。\n   - 通用气体常数为 $R_u = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。\n   - 显焓的参考温度为 $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$，且在所选参考状态下，所有生成焓均视为零，因此 $h_i(T) = c_{p,i}\\,(T - T_{\\mathrm{ref}})$。\n   - 元素集合为 $[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}, \\mathrm{N}]$，每个组分分子中的原子数由矩阵给出\n     $$\n     \\mathbf{B} =\n     \\begin{bmatrix}\n     0  0  1  0  1  0 \\\\\n     0  0  0  2  0  2 \\\\\n     2  0  2  1  1  0 \\\\\n     0  2  0  0  0  0\n     \\end{bmatrix},\n     $$\n     其中行序为 $[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}, \\mathrm{N}]$，列序为 $[\\mathrm{O}_2, \\mathrm{N}_2, \\mathrm{CO}_2, \\mathrm{H}_2\\mathrm{O}, \\mathrm{CO}, \\mathrm{H}_2]$。\n\n2. 对于一个表行，其包含组分质量分数 $\\mathbf{Y} = [Y_1,\\dots,Y_6]$、温度 $T$（单位 K）、压力 $p$（单位 Pa）、密度 $\\rho$（单位 kg/m³）、混合物显焓 $h$（单位 J/kg），以及针对元素 $[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}, \\mathrm{N}]$ 的目标元素向量 $\\mathbf{n}_{\\mathrm{elem,target}}$（单位 mol/kg），需要实现的检查如下：\n   - 质量分数归一化与边界：对所有 $i$，$\\sum_i Y_i = 1$ 且 $0 \\le Y_i \\le 1$。\n   - 元素守恒一致性，对每种元素 $e$：\n     $$\n     n_e = \\sum_{i=1}^{6} \\frac{B_{e,i}}{W_i} Y_i \\quad \\text{必须满足} \\quad n_e \\approx n_{e,\\mathrm{target}}。\n     $$\n   - 理想气体状态方程：\n     $$\n     R_{\\mathrm{mix}} = R_u \\sum_{i=1}^{6} \\frac{Y_i}{W_i}, \\quad \\text{且} \\quad p \\approx \\rho\\, R_{\\mathrm{mix}}\\, T.\n     $$\n   - 混合物显焓可加性：\n     $$\n     h_{\\mathrm{mix}} = \\sum_{i=1}^{6} Y_i\\, c_{p,i}\\, (T - T_{\\mathrm{ref}}) \\quad \\text{且} \\quad h \\approx h_{\\mathrm{mix}}。\n     $$\n\n3. 检查中要使用的数值容差如下：\n   - 质量分数总和容差：$\\varepsilon_{\\Sigma Y} = 10^{-9}$。\n   - 质量分数边界容差：为适应舍入误差，允许 $Y_i \\in [-10^{-12}, 1+10^{-12}]$。\n   - 元素向量比较：相对容差 $\\varepsilon_{\\mathrm{elem,rel}} = 10^{-6}$，绝对容差为零。\n   - 状态方程比较：相对容差 $\\varepsilon_{\\mathrm{eos,rel}} = 10^{-9}$，绝对容差为零。\n   - 焓值比较：绝对容差 $\\varepsilon_{h,\\mathrm{abs}} = 10^{-6}\\,\\mathrm{J/kg}$。\n\n4. 您的程序必须实现一个函数，该函数在给定一个表（即行的列表）时，返回一个布尔值，以指示是否所有行都通过了所有检查。请将此函数应用于以下测试用例集。为清晰起见，下文描述了每个案例；精确的数组必须完全按照下述方式在您的程序中编码。所有单位均为国际单位制（SI）。\n\n   - 案例 1（理想情况，两行处于两个不同温度的干空气，所有检查均一致）：\n     - 两行的组分质量分数：$\\mathbf{Y} = [0.2319, 0.7681, 0, 0, 0, 0]$。\n     - 第 1 行：$T = 300.0\\,\\mathrm{K}$，$p = 101325.0\\,\\mathrm{Pa}$，$\\rho$ 的选择与此 $\\mathbf{Y}$ 和 $T$ 的理想气体方程一致，$h$ 的选择与此 $\\mathbf{Y}$ 和 $T$ 的显焓一致；目标元素向量等于为此 $\\mathbf{Y}$ 计算出的 $\\mathbf{n}_{\\mathrm{elem}}$，即 $\\mathbf{n}_{\\mathrm{elem,target}} \\approx [0.0, 0.0, 14.495, 54.825]\\,\\mathrm{mol/kg}$。\n     - 第 2 行：$T = 1500.0\\,\\mathrm{K}$，$p = 101325.0\\,\\mathrm{Pa}$，$\\rho$ 的选择与此 $\\mathbf{Y}$ 和 $T$ 的理想气体方程一致，$h$ 的选择与显焓一致；目标元素向量与第 1 行相同。\n   - 案例 2（因目标向量不正确导致元素守恒被违反）：\n     - 一行与案例 1 的第 1 行相同，但将目标元素向量设置为 $\\mathbf{n}_{\\mathrm{elem,target}} = [0.0, 0.0, 14.495, 50.0]\\,\\mathrm{mol/kg}$。\n   - 案例 3（焓值不匹配）：\n     - 一行与案例 1 的第 2 行相同，但将存储的 $h$ 设置为比一致的 $h_{\\mathrm{mix}}$ 大 $10000.0\\,\\mathrm{J/kg}$。\n   - 案例 4（状态方程不匹配）：\n     - 一行与案例 1 的第 1 行相同，但将 $\\rho$ 设置为给定 $\\mathbf{Y}$、$T$ 和 $p$ 下的一致理想气体密度的一半。\n   - 案例 5（质量分数归一化与边界）：\n     - 两行：\n       - 第 1 行：$\\mathbf{Y} = [0.5, 0.6, -0.1, 0, 0, 0]$，$T = 300.0\\,\\mathrm{K}$，$p = 101325.0\\,\\mathrm{Pa}$，$\\rho$ 和 $h$ 值可任意设置（一旦质量分数边界检查失败，它们将被忽略）；目标元素向量可任意选择（为明确起见，使用从此 $\\mathbf{Y}$ 计算出的向量）。\n       - 第 2 行：$\\mathbf{Y} = [0.23, 0.76, 0.01, 0.0, 0.0, 0.0]$，$T = 300.0\\,\\mathrm{K}$，$p = 101325.0\\,\\mathrm{Pa}$，$\\rho$ 和 $h$ 可任意取值；这里 $\\sum_i Y_i = 1.0$ 得到满足，但如果能执行到后续检查，焓和状态方程仍需保持一致；然而，此案例的目的是检验表中至少有一行验证失败，从而导致整个表的验证失败。\n\n5. 最终输出格式：\n   - 您的程序应生成单行输出，其中包含五个案例的结果，形式为一个由方括号括起的、逗号分隔的布尔值列表，例如 $[{\\tt True},{\\tt False},{\\tt True},{\\tt True},{\\tt False}]$。\n\n所有输入和计算都必须使用国际单位制（SI）单位。单行输出应严格遵循指定格式。不应打印任何其他文本。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确、客观，并包含唯一可验证解所需的所有必要信息。我们着手设计和实现所需的热化学状态一致性检查。\n\n目标是创建一个函数，该函数基于四个基本原则来验证热化学状态表：质量守恒、元素守恒、理想气体状态方程以及焓的热力学可加性。表中的每一行代表一个状态 $(\\mathbf{Y}, T, p, \\rho, h)$ 和一个目标元素丰度 $\\mathbf{n}_{\\mathrm{elem,target}}$，必须在指定的数值容差内满足这些原则。\n\n首先，我们定义计算所需的恒定物理和化学性质。\n\n组分集合按顺序为 $[\\mathrm{O}_2, \\mathrm{N}_2, \\mathrm{CO}_2, \\mathrm{H}_2\\mathrm{O}, \\mathrm{CO}, \\mathrm{H}_2]$。共有 $N_s = 6$ 个组分。\n相应的摩尔质量 $\\mathbf{W}$，单位为 $\\mathrm{kg/mol}$，由以下向量给出：\n$$\n\\mathbf{W} = [0.0319988, 0.0280134, 0.0440095, 0.01801528, 0.0280101, 0.00201588]\n$$\n组分的定压比热是恒定的，$\\mathbf{c}_p$ 的单位为 $\\mathrm{J/(kg\\cdot K)}$，其值为：\n$$\n\\mathbf{c}_p = [918.0, 1040.0, 844.0, 1860.0, 1040.0, 14310.0]\n$$\n通用气体常数为 $R_u = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。\n显焓的参考温度为 $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$。\n\n元素组成为元素 $[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}, \\mathrm{N}]$ 定义。组分 $i$ 的分子中元素 $e$ 的原子数由化学计量矩阵 $\\mathbf{B}$ 给出，其中 $B_{e,i}$ 是系数。\n$$\n\\mathbf{B} =\n\\begin{bmatrix}\n0  0  1  0  1  0 \\\\\n0  0  0  2  0  2 \\\\\n2  0  2  1  1  0 \\\\\n0  2  0  0  0  0\n\\end{bmatrix}\n$$\n行对应于元素 $[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}, \\mathrm{N}]$，列对应于组分 $[\\mathrm{O}_2, \\mathrm{N}_2, \\mathrm{CO}_2, \\mathrm{H}_2\\mathrm{O}, \\mathrm{CO}, \\mathrm{H}_2]$。\n\n对表中每一行的验证过程包括四个顺序检查。只有当一行通过所有检查时，该行才有效。只有当一个表的所有行都有效时，该表才有效。\n\n1.  **质量分数一致性检查**：此检查确保组分质量分数向量 $\\mathbf{Y} = [Y_1, \\dots, Y_{N_s}]$ 具有物理意义。\n    -   **归一化**：质量分数的总和必须等于 1。我们检查 $|\\sum_{i=1}^{N_s} Y_i - 1| \\le \\varepsilon_{\\Sigma Y}$ 是否成立，其中容差为 $\\varepsilon_{\\Sigma Y} = 10^{-9}$。\n    -   **边界**：每个质量分数必须为非负且不超过 1。为适应小的浮点舍入误差，我们检查是否对所有 $i=1, \\dots, N_s$ 均有 $Y_i \\in [-\\varepsilon_{Y,\\text{bound}}, 1+\\varepsilon_{Y,\\text{bound}}]$，容差为 $\\varepsilon_{Y,\\text{bound}} = 10^{-12}$。任何 $Y_i$ 未通过此检查都会使该行无效。\n\n2.  **元素守恒检查**：此检查验证从组分质量分数导出的元素组成是否与提供的目标元素丰度相匹配。单位质量混合物中元素 $e$ 的摩尔数 $n_e$ 计算如下：\n    $$\n    n_e = \\sum_{i=1}^{N_s} \\frac{B_{e,i}}{W_i} Y_i\n    $$\n    对集合 $[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}, \\mathrm{N}]$ 中的每种元素都执行此计算，得到一个计算出的元素向量 $\\mathbf{n}_{\\mathrm{elem,calc}}$。然后将此向量与目标向量 $\\mathbf{n}_{\\mathrm{elem,target}}$ 进行比较。如果计算出的向量与目标向量相近，则检查通过。此处的“相近”使用相对容差 $\\varepsilon_{\\mathrm{elem,rel}} = 10^{-6}$ 和零绝对容差进行评估。对于每种元素 $e$，条件是 $|n_{e,\\mathrm{calc}} - n_{e,\\mathrm{target}}| \\le \\varepsilon_{\\mathrm{elem,rel}} |n_{e,\\mathrm{target}}|$。如果 $n_{e,\\mathrm{target}} = 0$，则意味着 $n_{e,\\mathrm{calc}}$ 也必须为零（在机器精度范围内）。\n\n3.  **理想气体状态方程检查**：此检查确认给定的压力 $p$、密度 $\\rho$ 和温度 $T$ 与混合物的理想气体定律一致。首先，从组分计算混合物的比气体常数 $R_{\\mathrm{mix}}$：\n    $$\n    R_{\\mathrm{mix}} = R_u \\sum_{i=1}^{N_s} \\frac{Y_i}{W_i}\n    $$\n    根据理想气体定律计算出的压力为 $p_{\\mathrm{calc}} = \\rho R_{\\mathrm{mix}} T$。将此计算出的压力与表行中给出的压力 $p$ 进行比较。如果 $|p - p_{\\mathrm{calc}}| \\le \\varepsilon_{\\mathrm{eos,rel}} |p|$ 成立，则检查通过，相对容差为 $\\varepsilon_{\\mathrm{eos,rel}} = 10^{-9}$。\n\n4.  **混合物焓值检查**：此检查确保混合物显焓 $h$ 与所有组分的贡献一致。对于在参考状态下具有恒定比热和零生成焓的理想气体混合物，混合物显焓是各组分显焓的质量分数加权和：\n    $$\n    h_{\\mathrm{calc}} = \\sum_{i=1}^{N_s} Y_i h_i(T)\n    $$\n    其中组分 $i$ 的显焓由 $h_i(T) = c_{p,i} (T - T_{\\mathrm{ref}})$ 给出。如果给定焓 $h$ 与计算焓 $h_{\\mathrm{calc}}$ 之间的绝对差在指定容差范围内，即 $|h - h_{\\mathrm{calc}}| \\le \\varepsilon_{h,\\mathrm{abs}}$，则检查通过，其中 $\\varepsilon_{h,\\mathrm{abs}} = 10^{-6}\\,\\mathrm{J/kg}$。\n\n实现将按所呈现的顺序应用这些检查。如果任何检查对给定行失败，则该行的验证终止，并且整个表被标记为无效。对五个测试案例重复此过程，并报告每个案例的布尔结果（True 表示有效，False 表示无效）。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define constants, test cases, and run the validation.\n    \"\"\"\n\n    # 1. Species set, properties, and elemental composition\n    # Species: [O2, N2, CO2, H2O, CO, H2]\n    # Elements: [C, H, O, N]\n\n    W = np.array([0.0319988, 0.0280134, 0.0440095, 0.01801528, 0.0280101, 0.00201588])  # kg/mol\n    cp = np.array([918.0, 1040.0, 844.0, 1860.0, 1040.0, 14310.0])  # J/(kg.K)\n    Ru = 8.314462618  # J/(mol.K)\n    T_ref = 298.15  # K\n\n    B = np.array([\n        [0, 0, 1, 0, 1, 0],  # C\n        [0, 0, 0, 2, 0, 2],  # H\n        [2, 0, 2, 1, 1, 0],  # O\n        [0, 2, 0, 0, 0, 0]   # N\n    ])\n\n    # 3. Numerical tolerances\n    eps_sum_Y = 1e-9\n    eps_Y_bound = 1e-12\n    eps_elem_rel = 1e-6\n    eps_eos_rel = 1e-9\n    eps_h_abs = 1e-6\n\n    def check_table(table):\n        \"\"\"\n        Validates a given table of thermochemical states.\n        A table is a list of rows. Each row is a tuple:\n        (Y, T, p, rho, h, n_elem_target)\n        \"\"\"\n        for row in table:\n            Y, T, p, rho, h, n_elem_target = row\n\n            # --- Check 1: Mass Fraction Consistency ---\n            # Normalization\n            if not np.isclose(np.sum(Y), 1.0, atol=eps_sum_Y, rtol=0.0):\n                return False\n            # Bounds\n            if not np.all((Y >= -eps_Y_bound)  (Y = 1 + eps_Y_bound)):\n                return False\n\n            # --- Check 2: Elemental Conservation ---\n            n_elem_calc = B @ (Y / W)\n            if not np.all(np.isclose(n_elem_calc, n_elem_target, rtol=eps_elem_rel, atol=0.0)):\n                return False\n\n            # --- Check 3: Ideal-Gas Equation of State ---\n            R_mix = Ru * np.sum(Y / W)\n            p_calc = rho * R_mix * T\n            if not np.isclose(p, p_calc, rtol=eps_eos_rel, atol=0.0):\n                return False\n                \n            # --- Check 4: Mixture Enthalpy Additivity ---\n            h_calc = np.sum(Y * cp * (T - T_ref))\n            if not np.isclose(h, h_calc, rtol=0.0, atol=eps_h_abs):\n                return False\n\n        # If all rows pass all checks\n        return True\n\n    # 4. Construct and run test cases\n    test_cases = []\n\n    # Helper function to generate consistent data\n    def get_consistent_state(Y, T, p):\n        n_elem = B @ (Y / W)\n        R_mix = Ru * np.sum(Y / W)\n        rho = p / (R_mix * T)\n        h = np.sum(Y * cp * (T - T_ref))\n        return rho, h, n_elem\n\n    # --- Case 1: Happy path ---\n    Y_air = np.array([0.2319, 0.7681, 0.0, 0.0, 0.0, 0.0])\n    p_atm = 101325.0\n    \n    # Row 1\n    T1 = 300.0\n    rho1, h1, n_elem1 = get_consistent_state(Y_air, T1, p_atm)\n    row1_case1 = (Y_air, T1, p_atm, rho1, h1, n_elem1)\n\n    # Row 2\n    T2 = 1500.0\n    rho2, h2, n_elem2 = get_consistent_state(Y_air, T2, p_atm)\n    row2_case1 = (Y_air, T2, p_atm, rho2, h2, n_elem2)\n    \n    test_cases.append([row1_case1, row2_case1])\n\n    # --- Case 2: Elemental conservation violation ---\n    n_elem_target_bad_N = np.copy(n_elem1)\n    n_elem_target_bad_N[3] = 50.0 # B matrix row order is C, H, O, N\n    row_case2 = (Y_air, T1, p_atm, rho1, h1, n_elem_target_bad_N)\n    test_cases.append([row_case2])\n\n    # --- Case 3: Enthalpy mismatch ---\n    h_bad = h2 + 10000.0\n    row_case3 = (Y_air, T2, p_atm, rho2, h_bad, n_elem2)\n    test_cases.append([row_case3])\n\n    # --- Case 4: Equation of state mismatch ---\n    rho_bad = rho1 / 2.0\n    row_case4 = (Y_air, T1, p_atm, rho_bad, h1, n_elem1)\n    test_cases.append([row_case4])\n\n    # --- Case 5: Mass fraction violation ---\n    # Row 1 fails bounds check\n    Y_bad_bounds = np.array([0.5, 0.6, -0.1, 0.0, 0.0, 0.0])\n    # Other values can be arbitrary as the check will fail early\n    rho_arb, h_arb, n_elem_arb = get_consistent_state(np.array([1,0,0,0,0,0]), 300.0, 101325.0)\n    row1_case5 = (Y_bad_bounds, 300.0, 101325.0, rho_arb, h_arb, n_elem_arb)\n    \n    # Row 2 is technically made inconsistent by the problem setup, but its\n    # presence tests that one failing row invalidates the whole table.\n    Y_case5_r2 = np.array([0.23, 0.76, 0.01, 0.0, 0.0, 0.0])\n    rho_c5_r2, h_c5_r2, n_elem_c5_r2 = get_consistent_state(Y_case5_r2, 300.0, 101325.0)\n    row2_case5 = (Y_case5_r2, 300.0, 101325.0, rho_c5_r2, h_c5_r2, n_elem_c5_r2)\n    \n    test_cases.append([row1_case5, row2_case5])\n\n    # Run all checks\n    results = [check_table(case) for case in test_cases]\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}