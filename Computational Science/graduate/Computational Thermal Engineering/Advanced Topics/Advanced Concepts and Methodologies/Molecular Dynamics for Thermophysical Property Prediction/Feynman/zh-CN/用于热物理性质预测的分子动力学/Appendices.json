{
    "hands_on_practices": [
        {
            "introduction": "在任何分子动力学模拟中，积分时间步长 $\\Delta t$ 的选择都是一个关键决策，它直接影响到计算的准确性、稳定性以及计算成本。一个过大的时间步长会导致积分算法发散，而一个过小的时间步长则会极大地增加获得足够采样所需的计算时间。本练习将指导您通过对系统中速度最快的模式（即分子内振动）进行分析，来确定一个既能保证数值稳定性又能满足精度要求的可行时间步长。通过这个过程，您将深入理解为何在模拟中对高频振动（如 O-H 键伸缩）施加刚性约束，能够允许我们使用更大的时间步长，从而显著提高模拟效率 。",
            "id": "3973865",
            "problem": "您正在准备一个液态水的经典分子动力学（MD）模拟，温度为 $T=300\\,\\mathrm{K}$，使用显式全原子模型，并采用 velocity-Verlet 方案进行积分。最强的分子内振动模式是 O–H 伸缩振动，它可以很好地近似为一个一维谐振子，其角频率为 $\\omega_{\\mathrm{s}} \\approx 3.0\\times 10^{14}\\,\\mathrm{s}^{-1}$。在没有刚性约束的情况下，这是最快的模式。当施加刚性约束以冻结 O–H 键长时，剩余的最高分子内振动模式是 H–O–H 弯曲振动，您可以将其建模为一个角频率为 $\\omega_{\\mathrm{b}} \\approx 1.6\\times 10^{14}\\,\\mathrm{s}^{-1}$ 的谐振子。\n\n仅从牛顿第二定律和谐振子方程 $m\\,d^{2}x/dt^{2} + m\\,\\omega^{2}\\,x = 0$ 出发，并使用 velocity-Verlet 离散化的位置更新形式，完成以下操作：\n\n1. 对谐振子得到的离散更新进行线性稳定性分析，以确定时间步长 $\\Delta t$ 在 $\\omega$ 方面的条件，从而确保积分的线性稳定性。\n\n2. 施加一个分辨率要求，即最快的振动周期 $T = 2\\pi/\\omega$ 至少要被 $N=20$ 个时间步长采样。将“可行”时间步长定义为 $\\Delta t_{\\mathrm{feas}} = \\min\\{\\Delta t_{\\mathrm{stab}},\\,T/N\\}$，其中 $\\Delta t_{\\mathrm{stab}}$ 是在第 1 部分中获得的受稳定性限制的时间步长。\n\n3. 使用 $\\omega=\\omega_{\\mathrm{s}}$ 计算无约束水和使用 $\\omega=\\omega_{\\mathrm{b}}$ 计算有约束水的可行时间步长 $\\Delta t_{\\mathrm{feas}}$。然后计算约束使可行时间步长增加的乘法因子，定义为 $R=\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}})/\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}})$。\n\n以飞秒（fs）表示这两个可行的时间步长，并将比率 $R$ 表示为一个无量纲数。将您的三个最终结果四舍五入到三位有效数字。",
            "solution": "我们的分析基于牛顿第二定律和谐振子模型。谐振子满足\n$$\nm\\,\\frac{d^{2}x}{dt^{2}} + m\\,\\omega^{2}\\,x = 0,\n$$\n其角频率为 $\\omega$，周期为 $T=2\\pi/\\omega$。\n\n对于 velocity-Verlet 方法，一维谐振子的仅位置更新可以写成 Störmer–Verlet 形式\n$$\nx_{n+1} = 2x_{n} - x_{n-1} - (\\omega \\Delta t)^{2} x_{n},\n$$\n其中 $x_{n}$ 表示在时间 $t_{n}=n\\,\\Delta t$ 的位置。这个线性齐次递推关系式允许 $x_{n}=\\lambda^{n}$ 形式的解，从而得到特征方程\n$$\n\\lambda^{2} - 2\\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right)\\lambda + 1 = 0.\n$$\n两个根是\n$$\n\\lambda_{\\pm} = \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) \\pm i \\sqrt{1 - \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right)^{2}}.\n$$\n离散映射的线性稳定性要求放大因子满足 $|\\lambda_{\\pm}|=1$（无指数增长）。当且仅当平方根下的判别式为非负且实部有界，使得模保持为1时，上述根位于单位圆上。对于此递推关系，一个标准结果是，只要满足以下条件，根就是单位圆上的共轭复数\n$$\n0 \\le (\\omega \\Delta t)^{2} \\le 4,\n$$\n即\n$$\n0 \\le \\omega \\Delta t \\le 2.\n$$\n因此，谐振子的 velocity-Verlet 积分的线性稳定性条件是\n$$\n\\Delta t_{\\mathrm{stab}} \\le \\frac{2}{\\omega}.\n$$\n\n精度通常要求比稳定性本身更精细的时间分辨率。我们要求最快的周期至少被 $N=20$ 个时间步长采样，这产生了一个受分辨率限制的时间步长\n$$\n\\Delta t_{\\mathrm{res}} = \\frac{T}{N} = \\frac{2\\pi}{\\omega\\,N}.\n$$\n我们将可行时间步长定义为\n$$\n\\Delta t_{\\mathrm{feas}} = \\min\\!\\left\\{\\frac{2}{\\omega},\\,\\frac{2\\pi}{\\omega\\,N}\\right\\}.\n$$\n当 $N=20$ 时，我们比较这两个界限：\n$$\n\\frac{2}{\\omega} \\quad \\text{versus} \\quad \\frac{2\\pi}{20\\,\\omega} = \\frac{\\pi}{10\\,\\omega}.\n$$\n由于 $\\frac{2}{\\omega} = \\frac{T}{\\pi}$ 且 $\\frac{\\pi}{10\\,\\omega} = \\frac{T}{20}$，并且因为 $\\frac{T}{20}  \\frac{T}{\\pi}$，所以分辨率标准更严格。因此，\n$$\n\\Delta t_{\\mathrm{feas}} = \\frac{2\\pi}{\\omega\\,N} \\quad \\text{with} \\quad N=20.\n$$\n\n我们现在计算两种情况下的可行时间步长。\n\n无约束水（最快模式是O–H伸缩振动，$\\omega_{\\mathrm{s}}=3.0\\times 10^{14}\\,\\mathrm{s}^{-1}$）：\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}}) = \\frac{2\\pi}{\\omega_{\\mathrm{s}}\\,N} = \\frac{2\\pi}{(3.0\\times 10^{14}\\,\\mathrm{s}^{-1})\\times 20}.\n$$\n数值上，\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}}) = \\frac{2\\pi}{6.0\\times 10^{15}\\,\\mathrm{s}^{-1}} = \\left(\\frac{2\\pi}{6.0}\\right)\\times 10^{-15}\\,\\mathrm{s}.\n$$\n使用 $2\\pi \\approx 6.283185307$，我们得到\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}}) \\approx 1.047197551\\times 10^{-15}\\,\\mathrm{s} = 1.047197551\\,\\mathrm{fs}.\n$$\n四舍五入到三位有效数字：$1.05\\,\\mathrm{fs}$。\n\n有约束水（最快模式是H–O–H弯曲振动，$\\omega_{\\mathrm{b}}=1.6\\times 10^{14}\\,\\mathrm{s}^{-1}$）：\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}}) = \\frac{2\\pi}{\\omega_{\\mathrm{b}}\\,N} = \\frac{2\\pi}{(1.6\\times 10^{14}\\,\\mathrm{s}^{-1})\\times 20} = \\frac{2\\pi}{3.2\\times 10^{15}\\,\\mathrm{s}^{-1}}.\n$$\n因此，\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}}) = \\left(\\frac{2\\pi}{3.2}\\right)\\times 10^{-15}\\,\\mathrm{s} \\approx 1.963495408\\times 10^{-15}\\,\\mathrm{s} = 1.963495408\\,\\mathrm{fs}.\n$$\n四舍五入到三位有效数字：$1.96\\,\\mathrm{fs}$。\n\n约束使可行时间步长增加的乘法因子是\n$$\nR = \\frac{\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}})}{\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}})} = \\frac{\\frac{2\\pi}{\\omega_{\\mathrm{b}}\\,N}}{\\frac{2\\pi}{\\omega_{\\mathrm{s}}\\,N}} = \\frac{\\omega_{\\mathrm{s}}}{\\omega_{\\mathrm{b}}} = \\frac{3.0\\times 10^{14}}{1.6\\times 10^{14}} = 1.875.\n$$\n四舍五入到三位有效数字：$1.88$。\n\n因此，以飞秒表示的可行时间步长，在无约束条件下约为 $1.05\\,\\mathrm{fs}$，在有 O–H 键约束条件下约为 $1.96\\,\\mathrm{fs}$，而约束带来的增加因子为 $1.88$。",
            "answer": "$$\\boxed{\\begin{pmatrix}1.05 \\quad 1.96 \\quad 1.88\\end{pmatrix}}$$"
        },
        {
            "introduction": "为了提高计算效率，分子动力学模拟中通常会对原子间的相互作用势能函数在一个截断半径 $r_c$ 处进行截断。尽管这种做法大大减少了需要计算的原子对数量，但它也引入了系统性的误差，因为忽略了截断半径之外的长程相互作用。本练习旨在让您从统计力学的第一性原理出发，推导用于校正截断所引起的势能和压强误差的“尾部修正”解析表达式。通过假设在截断半径之外流体结构是均匀的（即径向分布函数 $g(r) = 1$），您将能够量化这些长程相互作用的贡献，从而更准确地预测宏观热物理性质 。",
            "id": "3973849",
            "problem": "考虑一个通过分子动力学 (MD) 模拟的均匀、各向同性的流体，其中使用了在有限截断距离 $r_c$ 处截断且没有任何移位的对势 Lennard–Jones (LJ) 势。对势为 $u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right]$，其中 $\\varepsilon$ 和 $\\sigma$ 分别是特征能量和长度参数。数密度为 $\\rho$，径向分布函数 (RDF) 为 $g(r)$，温度为 $T$。玻尔兹曼常数 (记作 $k_B$) 仅通过理想气体项出现，在下文的尾部修正推导中不需要用到。\n\n你需要推导解析的尾部修正，以估算因在 $r_c$ 處截断势而导致的每个粒子势能和压力的缺失贡献。假设当 $r \\ge r_c$ 时，结构是不相关的，即 $g(r) = 1$，并且流体足够均匀，可以使用标准的连续积分。从统计力学中均匀流体的位形能量密度和维里压力的第一性原理表达式出发，得到尾部修正 $\\Delta U/N$ 和 $\\Delta P$ 作为 $\\varepsilon$、$\\sigma$、$\\rho$ 和 $r_c$ 的函数的闭式表达式。\n\n在符号化地推导出这些表达式后，使用由 $r^\\ast = r/\\sigma$ 和 $\\rho^\\ast = \\rho \\sigma^3$ 定义的 Lennard–Jones 约化单位对它们进行数值计算，其中能量以 $\\varepsilon$ 为单位，压力以 $\\varepsilon/\\sigma^3$ 为单位。使用 $\\rho^\\ast = 0.85$ 和 $r_c^\\ast = 2.5$。将每个粒子的能量修正以 $\\varepsilon$ 为单位表示，压力修正以 $\\varepsilon/\\sigma^3$ 为单位表示。将你的数值答案四舍五入到四位有效数字。按照 $\\Delta U/N$ (以 $\\varepsilon$ 为单位)，然后是 $\\Delta P$ (以 $\\varepsilon/\\sigma^3$ 为单位) 的顺序报告你的最终结果。",
            "solution": "该问题要求推导 Lennard-Jones (LJ) 流体的每个粒子势能和压力的解析尾部修正，其中势在有限的截断距离 $r_c$ 处被截断。该推导基于径向分布函数 $g(r)$ 在距离 $r \\ge r_c$ 时为 1 的假设。\n\n首先，我们建立统计力学中的基本表达式。\n对于一个包含 $N$ 个粒子、数密度为 $\\rho = N/V$ 的系统，其位形势能 $U$ 由下式给出：\n$$ U = 2 \\pi N \\rho \\int_0^\\infty u(r) g(r) r^2 dr $$\n压力 $P$ 由维里定理给出：\n$$ P = \\rho k_B T - \\frac{2 \\pi \\rho^2}{3} \\int_0^\\infty r \\frac{du(r)}{dr} g(r) r^2 dr $$\n其中积分项代表来自粒子间力的贡献。\n\n尾部修正 $\\Delta U$ 和 $\\Delta P$ 代表这些积分中来自截断距离以外区域的贡献，即对于 $r \\in [r_c, \\infty)$。\n\n**势能尾部修正 ($\\Delta U/N$) 的推导**\n\n势能修正 $\\Delta U$ 是势能密度在被截断区域上的积分。\n$$ \\Delta U = 2 \\pi N \\rho \\int_{r_c}^\\infty u(r) g(r) r^2 dr $$\n给定 Lennard-Jones 势：\n$$ u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] $$\n我们假设当 $r \\ge r_c$ 时，流体结构不相关，即 $g(r) = 1$。将这些代入 $\\Delta U$ 的表达式中：\n$$ \\Delta U = 2 \\pi N \\rho \\int_{r_c}^\\infty 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] r^2 dr $$\n提出常数：\n$$ \\Delta U = 8 \\pi N \\rho \\varepsilon \\int_{r_c}^\\infty \\left( \\sigma^{12} r^{-12} - \\sigma^6 r^{-6} \\right) r^2 dr $$\n$$ \\Delta U = 8 \\pi N \\rho \\varepsilon \\int_{r_c}^\\infty \\left( \\sigma^{12} r^{-10} - \\sigma^6 r^{-4} \\right) dr $$\n进行积分：\n$$ \\int \\left( \\sigma^{12} r^{-10} - \\sigma^6 r^{-4} \\right) dr = \\sigma^{12} \\frac{r^{-9}}{-9} - \\sigma^6 \\frac{r^{-3}}{-3} = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} $$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$ \\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^\\infty = \\lim_{r \\to \\infty} \\left( -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) $$\n$$ = (0 - 0) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} $$\n将此结果代回 $\\Delta U$ 的表达式：\n$$ \\Delta U = 8 \\pi N \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) $$\n问题要求每个粒子的修正 $\\Delta U/N$：\n$$ \\frac{\\Delta U}{N} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) = \\frac{8 \\pi \\rho \\varepsilon \\sigma^3}{3} \\left[ \\frac{1}{3} \\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right] $$\n\n**压力尾部修正 ($\\Delta P$) 的推导**\n\n压力修正 $\\Delta P$ 是从压力表达式中针对区域 $r \\ge r_c$ 的维里部分推导出来的：\n$$ \\Delta P = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^\\infty r \\frac{du(r)}{dr} g(r) r^2 dr $$\n同样，我们假设 $g(r) = 1$。首先，我们计算 LJ 势的导数 $du/dr$：\n$$ \\frac{du}{dr} = 4 \\varepsilon \\left( -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right) $$\n将此代入 $\\Delta P$ 的积分中：\n$$ \\Delta P = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 \\left[ 4 \\varepsilon \\left( -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right) \\right] dr $$\n$$ \\Delta P = - \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\int_{r_c}^\\infty \\left( -12 \\sigma^{12} r^{-10} + 6 \\sigma^6 r^{-4} \\right) dr $$\n$$ \\Delta P = \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\int_{r_c}^\\infty \\left( 12 \\sigma^{12} r^{-10} - 6 \\sigma^6 r^{-4} \\right) dr $$\n进行积分：\n$$ \\int \\left( 12 \\sigma^{12} r^{-10} - 6 \\sigma^6 r^{-4} \\right) dr = 12 \\sigma^{12} \\frac{r^{-9}}{-9} - 6 \\sigma^6 \\frac{r^{-3}}{-3} = -\\frac{4}{3} \\sigma^{12} r^{-9} + 2 \\sigma^6 r^{-3} $$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$ \\left[ -\\frac{4}{3} \\frac{\\sigma^{12}}{r^9} + 2 \\frac{\\sigma^6}{r^3} \\right]_{r_c}^\\infty = (0 - 0) - \\left( -\\frac{4}{3} \\frac{\\sigma^{12}}{r_c^9} + 2 \\frac{\\sigma^6}{r_c^3} \\right) = \\frac{4}{3} \\frac{\\sigma^{12}}{r_c^9} - 2 \\frac{\\sigma^6}{r_c^3} $$\n将此结果代回 $\\Delta P$ 的表达式：\n$$ \\Delta P = \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\left( \\frac{4}{3} \\frac{\\sigma^{12}}{r_c^9} - 2 \\frac{\\sigma^6}{r_c^3} \\right) = \\frac{32 \\pi \\rho^2 \\varepsilon}{9} \\frac{\\sigma^{12}}{r_c^9} - \\frac{16 \\pi \\rho^2 \\varepsilon}{3} \\frac{\\sigma^6}{r_c^3} $$\n\n**在约化单位下的数值计算**\n\n我们现在使用 Lennard-Jones 约化单位来计算这些表达式，其定义为 $r^* = r/\\sigma$，$\\rho^* = \\rho \\sigma^3$。能量以 $\\varepsilon$ 为单位，压力以 $\\varepsilon/\\sigma^3$ 为单位。\n\n对于每个粒子的能量修正，$(\\Delta U/N)^* = (\\Delta U/N)/\\varepsilon$：\n$$ \\frac{\\Delta U}{N \\varepsilon} = 8 \\pi (\\rho \\sigma^3) \\left( \\frac{1}{9(r_c/\\sigma)^9} - \\frac{1}{3(r_c/\\sigma)^3} \\right) = 8 \\pi \\rho^* \\left( \\frac{1}{9(r_c^*)^9} - \\frac{1}{3(r_c^*)^3} \\right) $$\n对于压力修正，$\\Delta P^* = \\Delta P / (\\varepsilon/\\sigma^3)$：\n$$ \\Delta P^* = \\frac{32 \\pi (\\rho \\sigma^3)^2}{9 (r_c/\\sigma)^9} - \\frac{16 \\pi (\\rho \\sigma^3)^2}{3 (r_c/\\sigma)^3} = \\frac{32 \\pi (\\rho^*)^2}{9 (r_c^*)^9} - \\frac{16 \\pi (\\rho^*)^2}{3 (r_c^*)^3} $$\n$$ \\Delta P^* = 16 \\pi (\\rho^*)^2 \\left( \\frac{2}{9(r_c^*)^9} - \\frac{1}{3(r_c^*)^3} \\right) $$\n给定的数值为 $\\rho^* = 0.85$ 和 $r_c^* = 2.5$。\n首先，我们计算 $r_c^*$ 的幂：\n$(r_c^*)^3 = 2.5^3 = 15.625$\n$(r_c^*)^9 = (2.5^3)^3 = 15.625^3 = 3814.697265625$\n\n现在，我们计算能量修正的数值：\n$$ \\frac{\\Delta U}{N \\varepsilon} = 8 \\pi (0.85) \\left( \\frac{1}{9 \\times 3814.697...} - \\frac{1}{3 \\times 15.625} \\right) $$\n$$ \\frac{\\Delta U}{N \\varepsilon} = 21.36283... \\times \\left( \\frac{1}{34332.275...} - \\frac{1}{46.875} \\right) $$\n$$ \\frac{\\Delta U}{N \\varepsilon} = 21.36283... \\times (0.000029127... - 0.021333333...) $$\n$$ \\frac{\\Delta U}{N \\varepsilon} = 21.36283... \\times (-0.021304206...) = -0.4550775... $$\n四舍五入到四位有效数字，每个粒子的能量修正为 $-0.4551\\,\\varepsilon$。\n\n接下来，我们计算压力修正的数值：\n$$ \\Delta P^* = 16 \\pi (0.85)^2 \\left( \\frac{2}{9 \\times 3814.697...} - \\frac{1}{3 \\times 15.625} \\right) $$\n$$ \\Delta P^* = 16 \\pi (0.7225) \\left( \\frac{2}{34332.275...} - \\frac{1}{46.875} \\right) $$\n$$ \\Delta P^* = 36.31681... \\times (0.000058254... - 0.021333333...) $$\n$$ \\Delta P^* = 36.31681... \\times (-0.021275079...) = -0.7725964... $$\n四舍五入到四位有效数字，压力修正为 $-0.7726\\,\\varepsilon/\\sigma^3$。\n\n最终答案为 $\\Delta U/N = -0.4551\\,\\varepsilon$ 和 $\\Delta P = -0.7726\\,\\varepsilon/\\sigma^3$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.4551 \\quad -0.7726 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "自由能是描述系统热力学状态的核心物理量，但与能量或压强不同，它不能直接通过单次模拟的系综平均得到。热力学积分（TI）是计算自由能差异最强大和最经典的方法之一。该方法通过引入一个耦合参数 $\\lambda$ 来构建一条连接初始状态和最终状态的热力学路径，然后对路径上能量对 $\\lambda$ 的导数的系综平均值进行积分，从而得到自由能的变化。本练习将引导您在一个明确定义的模型体系中，完整地实践热力学积分的计算流程，从构建积分路径、推导并计算被积函数，到最终通过数值积分得到过剩化学势。这个过程将帮助您掌握自由能计算的核心思想和技术细节 。",
            "id": "3973875",
            "problem": "考虑一个为分子动力学 (MD) 自由能计算而制定的单粒子插入问题，该问题在正则系综内使用热力学积分 (TI) 方法。设亥姆霍兹自由能由 $F$ 表示，逆温度由 $\\beta = 1/(k_{\\mathrm{B}} T)$ 表示，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，耦合参数由 $\\lambda \\in [0,1]$ 表示。TI 恒等式将亥姆霍兹自由能对耦合参数的导数与系综平均关联起来，如下所示\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle \\frac{\\partial U(\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda},\n$$\n其中 $U(\\lambda)$ 是依赖于 $\\lambda$ 的势能函数，而 $\\langle \\cdot \\rangle_{\\lambda}$ 表示在固定 $\\lambda$ 下的正则系综平均。\n\n在此问题中，为插入一个在边长为 $L$ 的有限立方盒子内受到线性耦合外部谐波场作用的单个粒子，构建一个计算其超额化学势的热力学积分路径。设势能定义为\n$$\nU(\\lambda; \\mathbf{r}) = \\lambda U_0(\\mathbf{r}), \\quad U_0(\\mathbf{r}) = \\frac{k}{2} \\left(x^2 + y^2 + z^2\\right),\n$$\n其中 $k$ 是谐波刚度，$\\mathbf{r} = (x,y,z)$ 是盒子 $\\mathbf{r} \\in [-L/2,L/2]^3$ 内的粒子位置。假设边界为反射边界，因此粒子保持在盒子内部。在约化单位中，将德布罗意热波长设置为 1，以便排除理想气体对化学势的贡献；您只需要计算超额化学势 $\\mu^{\\mathrm{ex}}$，它等于沿 TI 路径的自由能变化：\n$$\n\\mu^{\\mathrm{ex}} = \\Delta F = \\int_0^1 \\left\\langle \\frac{\\partial U(\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda}\\, d\\lambda.\n$$\n\n从第一性原理出发，使用正则配分积分将系综平均表示为配分积分之比：\n$$\n\\left\\langle \\frac{\\partial U(\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda}\n= \\frac{\\displaystyle \\int_{-L/2}^{L/2}\\int_{-L/2}^{L/2}\\int_{-L/2}^{L/2} U_0(\\mathbf{r}) \\, e^{-\\beta \\lambda U_0(\\mathbf{r})} \\, dx\\,dy\\,dz}{\\displaystyle \\int_{-L/2}^{L/2}\\int_{-L/2}^{L/2}\\int_{-L/2}^{L/2} e^{-\\beta \\lambda U_0(\\mathbf{r})} \\, dx\\,dy\\,dz}.\n$$\n\n利用可分离性将三维积分简化为一维积分。定义 $A = L/2$ 和 $a(\\lambda) = \\beta \\lambda k / 2$。记一维高斯积分为\n$$\nI(a) = \\int_{-A}^{A} e^{-a x^2}\\,dx, \\quad\nJ(a) = \\int_{-A}^{A} x^2 e^{-a x^2}\\,dx.\n$$\n使用这些来证明\n$$\n\\left\\langle U_0 \\right\\rangle_{\\lambda} = \\frac{3k}{2}\\,\\frac{J(a(\\lambda))}{I(a(\\lambda))}.\n$$\n对于 $a0$，您必须实现 $I(a)$ 和 $J(a)$ 的以下数学精确表达式：\n$$\nI(a) = \\sqrt{\\frac{\\pi}{a}}\\, \\mathrm{erf}\\!\\left(A \\sqrt{a}\\right),\n\\quad\nJ(a) = \\frac{\\sqrt{\\pi}}{2\\,a^{3/2}}\\, \\mathrm{erf}\\!\\left(A \\sqrt{a}\\right) - \\frac{A}{a}\\, e^{-a A^2}.\n$$\n在边界 $a=0$（即 $\\lambda=0$）处，使用以下精确极限\n$$\nI(0) = 2A, \\quad J(0) = \\frac{2A^3}{3},\n$$\n以无奇点地计算 $\\left\\langle U_0 \\right\\rangle_{\\lambda=0}$。\n\n算法要求：\n- 使用稳定复合辛普森法则和偶数个子区间，在 $[0,1]$ 上数值计算 $\\mu^{\\mathrm{ex}}$ 的 $\\lambda$ 积分，通过提供的极限确保精确处理 $\\lambda=0$ 端点。\n- 所有量均为无量纲的约化单位，其中 $k_{\\mathrm{B}}=1$ 且德布罗意热波长为 1。以这些约化能量单位表示 $\\mu^{\\mathrm{ex}}$ 的最终答案。\n\n测试套件：\n- 案例 1 (一般情况)：$\\beta = 1.0$, $k = 1.5$, $L = 10$。\n- 案例 2 (软势能边界情况)：$\\beta = 1.0$, $k = 0.001$, $L = 10$。\n- 案例 3 (小盒子边界情况)：$\\beta = 1.0$, $k = 1.5$, $L = 2$。\n- 案例 4 (低温敏感性)：$\\beta = 2.0$, $k = 1.5$, $L = 10$。\n\n您的程序必须为每个案例计算 $\\mu^{\\mathrm{ex}}$，并生成一行输出，其中包含按上述案例顺序列出的结果，结果为包含在方括号中的逗号分隔列表。每个结果必须是以约化能量单位表示、四舍五入到六位小数的浮点数。例如：$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$。",
            "solution": "超额化学势 $\\mu^{\\mathrm{ex}}$ 通过对耦合参数 $\\lambda$ 在 $[0,1]$ 区间内进行热力学积分得到：\n$$\n\\mu^{\\mathrm{ex}} = \\int_0^1 \\left\\langle \\frac{\\partial U(\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda.\n$$\n对于给定的势能函数 $U(\\lambda; \\mathbf{r}) = \\lambda U_0(\\mathbf{r})$，其对 $\\lambda$ 的偏导数为 $\\frac{\\partial U(\\lambda)}{\\partial \\lambda} = U_0(\\mathbf{r})$。因此，被积函数是在固定 $\\lambda$ 下对 $U_0$ 的系综平均：\n$$\n\\mu^{\\mathrm{ex}} = \\int_0^1 \\langle U_0 \\rangle_{\\lambda} \\, d\\lambda.\n$$\n根据统计力学，系综平均由配分积分的比值给出：\n$$\n\\langle U_0 \\rangle_{\\lambda} = \\frac{\\displaystyle\\int_V U_0(\\mathbf{r}) e^{-\\beta \\lambda U_0(\\mathbf{r})} d\\mathbf{r}}{\\displaystyle\\int_V e^{-\\beta \\lambda U_0(\\mathbf{r})} d\\mathbf{r}}.\n$$\n其中 $U_0(\\mathbf{r}) = \\frac{k}{2}(x^2+y^2+z^2)$，积分在边长为 $L$ 的立方盒子内进行。由于势能是可分离的，三维积分可以分解为三个独立的一维积分的乘积。设 $A = L/2$ 和 $a = a(\\lambda) = \\beta \\lambda k / 2$。\n\n分母（构型配分函数）为：\n$$\nZ_{\\text{conf}}(\\lambda) = \\left( \\int_{-A}^{A} e^{-ax^2} dx \\right)^3 = [I(a)]^3.\n$$\n分子为：\n$$\n\\int_V \\frac{k}{2}(x^2+y^2+z^2) e^{-a(x^2+y^2+z^2)} d\\mathbf{r} = 3 \\times \\frac{k}{2} \\left(\\int_{-A}^{A} x^2 e^{-ax^2} dx\\right) \\left(\\int_{-A}^{A} e^{-ay^2} dy\\right)^2 = \\frac{3k}{2} J(a) [I(a)]^2.\n$$\n因此，被积函数可以表示为：\n$$\n\\langle U_0 \\rangle_{\\lambda} = \\frac{\\frac{3k}{2} J(a) [I(a)]^2}{[I(a)]^3} = \\frac{3k}{2} \\frac{J(a(\\lambda))}{I(a(\\lambda))}.\n$$\n为了计算这个表达式，我们使用问题中提供的 $I(a)$ 和 $J(a)$ 的解析形式。当 $\\lambda \\to 0$ (即 $a \\to 0$) 时，被积函数趋于一个明确的极限：\n$$\n\\langle U_0 \\rangle_{\\lambda=0} = \\frac{3k}{2} \\frac{J(0)}{I(0)} = \\frac{3k}{2} \\frac{2A^3/3}{2A} = \\frac{k A^2}{2} = \\frac{k L^2}{8}.\n$$\n该极限用于处理积分的下限。对于 $\\lambda \\in (0, 1]$，我们使用涉及误差函数 $\\mathrm{erf}$ 的表达式。\n\n最终，超额化学势 $\\mu^{\\mathrm{ex}}$ 通过对被积函数 $\\langle U_0 \\rangle_{\\lambda}$ 在 $[0,1]$ 区间上使用复合辛普森法则进行数值积分来计算。对每个给定的测试案例重复此过程，得到相应的 $\\mu^{\\mathrm{ex}}$ 值。",
            "answer": "$$ \\boxed{[1.498135, 0.012498, 0.457813, 1.499994]} $$"
        }
    ]
}