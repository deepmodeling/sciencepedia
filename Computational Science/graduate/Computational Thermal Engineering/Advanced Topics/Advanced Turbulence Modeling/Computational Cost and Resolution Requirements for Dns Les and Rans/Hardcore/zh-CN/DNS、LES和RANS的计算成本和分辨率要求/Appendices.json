{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学中，对壁面附近湍流的精确建模是核心挑战之一。本练习将介绍评估近壁面分辨率最基本的度量——无量纲壁面距离 $y^+$。通过为一个给定的网格和流动条件计算 $y^+$ ，你将学会如何做出一个关键决策：该网格是足够精细以进行壁面解析模拟，还是需要使用壁面函数，这项技能对于在 RANS 和 LES 模拟中做出正确的建模选择至关重要。",
            "id": "3941228",
            "problem": "为了进行共轭传热分析，需要模拟一个标准条件下充分发展的高雷诺数空气湍流槽道流。一次初步的壁面剪切测量得到了摩擦速度 $u_{\\tau}$，并且空气的运动粘度 $\\nu$ 是已知的。当前的计算网格将第一个离壁单元的中心放置在距离壁面 $y_1$ 的位置。在比较直接数值模拟 (DNS)、大涡模拟 (LES) 和雷诺平均纳维-斯托克斯 (RANS) 方法的背景下，壁面模型的适用性取决于无量纲的近壁分辨率。\n\n从第一性原理出发，使用摩擦速度 $u_{\\tau}$ 和粘性长度尺度的定义，推导出用 $y_1$、$u_{\\tau}$ 和 $\\nu$ 表示的无量纲壁面坐标 $y_1^{+}$。然后，使用以下物理上一致的参数计算 $y_1^{+}$ 的值：\n- 摩擦速度 $u_{\\tau} = 0.50 \\ \\mathrm{m/s}$，\n- 运动粘度 $\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$，\n- 第一个单元中心法向离壁距离 $y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$。\n\n最后，基于壁湍流中典型的近壁结构和模拟实践，判断在此分辨率下，壁面模型是否适用于大涡模拟 (LES)，并通过参考 $y_1^{+}$ 相对于已确立的近壁区域的位置来简要说明您的决定。\n\n将您计算出的 $y_1^{+}$ 值四舍五入至四位有效数字。将最终结果表示为一个纯数（无量纲）。最终答案必须仅为计算出的 $y_1^{+}$ 值。",
            "solution": "在尝试提供解答之前，对问题陈述进行验证。\n\n### 步骤1：提取给定条件\n- 需要推导的定义：用 $y_1$、$u_{\\tau}$ 和 $\\nu$ 表示的无量纲壁面坐标 $y_1^{+}$。\n- 摩擦速度：$u_{\\tau} = 0.50 \\ \\mathrm{m/s}$。\n- 运动粘度：$\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$。\n- 第一个单元中心法向离壁距离：$y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$。\n- 精度要求：将计算出的 $y_1^{+}$ 值四舍五入至四位有效数字。\n- 解释要求：评估在此计算分辨率下，壁面模型对大涡模拟 (LES) 的适用性。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据**：该问题在根本上是合理的。它涉及壁湍流理论中的标准概念，即摩擦速度、粘性长度尺度和无量纲壁面坐标 ($y^{+}$)。这些是计算流体力学 (CFD) 中使用 DNS、LES 和 RANS 模拟湍流的基石概念。所提供的物理参数对于标准温度和压力下的空气是符合实际的。\n- **适定性**：该问题是适定的。它要求从第一性原理进行推导，使用所提供的数据进行数值计算，并基于该领域的既定实践进行解释。任务定义清晰，能够导出一个唯一且有意义的结果。\n- **客观性**：该问题以精确、客观和定量的术语陈述。在定义或要求的任务中没有模糊之处。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**，因为它具有科学依据、适定且客观。它不包含任何不一致之处、缺失信息或逻辑缺陷。将提供完整的解答。\n\n### 解答推导与计算\n\n第一步是推导无量纲壁面坐标 $y^{+}$ 的表达式。该坐标系用于表征湍流边界层近壁区域的流动结构。其标度基于主导该区域的物理量。\n\n在固体壁面紧邻区域（粘性底层）主导流体运动的关键物理量是壁面剪切应力 $\\tau_w$、流体密度 $\\rho$ 和流体运动粘度 $\\nu$。根据这些量，我们可以构建速度、长度和时间的特征尺度。\n\n特征速度尺度是摩擦速度 $u_{\\tau}$，其定义为：\n$$\nu_{\\tau} \\equiv \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n这个量具有速度的单位 $[L T^{-1}]$。问题直接给出了 $u_{\\tau}$ 的值。\n\n近壁区域的特征长度尺度是粘性长度尺度，有时记为 $\\delta_{\\nu}$。它由摩擦速度 $u_{\\tau}$ 和运动粘度 $\\nu$ 组合而成，以得到长度的量纲。它们的量纲是：\n- $[u_{\\tau}] = L T^{-1}$\n- $[\\nu] = L^2 T^{-1}$\n\n为了获得一个具有长度单位 $[L]$ 的量，我们必须用 $\\nu$ 除以 $u_{\\tau}$：\n$$\n\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}} \\quad \\left( \\frac{[L^2 T^{-1}]}{[L T^{-1}]} = [L] \\right)\n$$\n这就是粘性长度尺度。它代表了粘性效应主导惯性效应区域的近似厚度。\n\n无量纲壁面坐标 $y^{+}$ 定义为物理法向离壁距离 $y$ 由该粘性长度尺度 $\\delta_{\\nu}$ 归一化：\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}}\n$$\n代入 $\\delta_{\\nu}$ 的表达式，我们得到所求的关系式：\n$$\ny^{+} = \\frac{y}{\\left(\\frac{\\nu}{u_{\\tau}}\\right)} = \\frac{y u_{\\tau}}{\\nu}\n$$\n对于距离壁面 $y_1$ 处的第一个计算单元中心的特定情况，其无量纲坐标记为 $y_1^{+}$：\n$$\ny_1^{+} = \\frac{y_1 u_{\\tau}}{\\nu}\n$$\n这就完成了从第一性原理的推导。\n\n接下来，我们使用给定的数值计算 $y_1^{+}$：\n- $y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$\n- $u_{\\tau} = 0.50 \\ \\mathrm{m/s}$\n- $\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$\n\n将这些值代入推导出的公式中：\n$$\ny_1^{+} = \\frac{(1.0 \\times 10^{-4} \\ \\mathrm{m}) (0.50 \\ \\mathrm{m/s})}{1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}}\n$$\n单位如预期般消去，得到一个无量纲数：\n$$\n\\frac{\\mathrm{m} \\cdot \\mathrm{m/s}}{\\mathrm{m^2/s}} = 1\n$$\n现在，我们进行算术运算：\n$$\ny_1^{+} = \\frac{0.50 \\times 10^{-4}}{1.5 \\times 10^{-5}} = \\frac{0.50}{1.5} \\times 10^{(-4 - (-5))} = \\frac{1}{3} \\times 10^1 = \\frac{10}{3}\n$$\n值为 $y_1^{+} = 3.3333...$。按要求四舍五入到四位有效数字，得到：\n$$\ny_1^{+} \\approx 3.333\n$$\n\n### 关于大涡模拟壁面模型的解释\n\n壁面模型对于大涡模拟 (LES) 的适用性，关键取决于第一个离壁网格点的放置位置，该位置由其 $y_1^{+}$ 值量化。湍流边界层的近壁区域通常根据其 $y^{+}$ 值划分为几个区域：\n1.  **粘性底层**：对于 $y^{+} \\lesssim 5$，粘性剪切应力占主导地位，平均速度剖面是线性的 ($u^{+} = y^{+}$)。\n2.  **缓冲层**：对于 $5 \\lesssim y^{+} \\lesssim 30$，粘性应力和湍流（雷诺）应力都很显著。这是一个复杂的过渡区域。\n3.  **对数律层（对数律区域）**：对于 $y^{+} \\gtrsim 30$（直到边界层厚度的某个比例），湍流应力占主导地位，平均速度剖面遵循对数律 ($u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$)。\n\n大涡模拟中的壁面模型旨在桥接边界层的内部区域，以避免直接解析该区域所需的高昂计算成本。这些模型几乎普遍基于一个假设，即第一个离壁网格点位于对数律层内，在该层中普适壁面律成立。因此，应用标准壁面模型的一个先决条件是 $y_1^{+} \\gtrsim 30$。\n\n在本问题中，计算值为 $y_1^{+} \\approx 3.333$。这个值将第一个计算单元的中心完全置于**粘性底层**内。在此位置，壁面模型所依赖的对数速度剖面的基本假设是无效的。在此分辨率下使用壁面模型是不正确的，并将导致显著的建模误差。\n\n因此，对于此分辨率下的大涡模拟，使用壁面模型是**不合适的**。一个 $y_1^{+} \\approx 3.333$ 的网格是为**壁面解析**模拟而设计的，在这种模拟中，粘性层和缓冲层内的湍流结构至少被网格部分解析，而不是被模型化。要正确使用壁面模型，近壁网格需要被加粗，以使第一个单元中心移动到对数律区域（例如，$y_1^{+} > 30$）。",
            "answer": "$$\n\\boxed{3.333}\n$$"
        },
        {
            "introduction": "直接数值模拟 (DNS) 是保真度最高的方法，但其计算成本可能高得惊人，这为 LES 和 RANS 的发展提供了动力。本实践探讨了在 DNS 中增加一个被动标量（如温度）会如何影响总计算成本，特别是对于具有高普朗特数 $Pr$ 的流体。通过执行一个基于物理尺度的分析 ，你将量化分辨率需求和时间步长限制如何共同导致成本急剧增加，从而深刻理解为何 DNS 在许多工程传热问题中不切实际。",
            "id": "3941206",
            "problem": "在一个通过直接数值模拟 (DNS) 求解的三维不可压缩湍流中，您最初模拟一个等温情况，选择网格间距 $\\Delta x_{0}$ 来解析科尔莫戈罗夫长度尺度 $\\eta$。现在，您在普朗特数 $Pr = 7$ 的条件下，将温度作为一个输运标量加入，并要求温度场也得到 DNS 解析。大涡模拟 (LES) 和雷诺平均纳维-斯托克斯 (RANS) 是分辨率要求更粗糙的替代方法，但此处我们专注于 DNS 范畴。\n\n使用以下基本依据：\n- 普朗特数是 $Pr = \\nu / \\alpha$，其中 $\\nu$ 是运动粘度，$\\alpha$ 是热扩散率。\n- 科尔莫戈罗夫长度尺度是 $\\eta$，即湍流中动量的最小动态活动尺度。\n- 对于 $Pr \\ge 1$ 的情况，对于扩散率小于粘度的标量，其巴切勒尺度为 $\\eta_{B} = \\eta / \\sqrt{Pr}$。\n- 一个完全解析的 DNS 要求网格间距 $\\Delta x$ 与最小相关物理尺度的量级相同（即，对于动量，$\\Delta x_{0} \\sim \\eta$；对于 $Pr \\ge 1$ 时的温度，$\\Delta x_{T} \\sim \\eta_{B}$）。\n- 对于一个边长固定的立方体域 $L$，网格点数与 $(L / \\Delta x)^{3}$ 成比例。\n- 对于显式时间积分，且对流 Courant–Friedrichs–Lewy (CFL) 准则占主导地位的情况下，稳定时间步长与 $\\Delta t \\propto \\Delta x / U$ 成比例，其中 $U$ 是一个独立于 $\\Delta x$ 的特征速度尺度。\n\n为分离由分辨率驱动的计算效应，作如下假设：\n- 添加温度时，域大小 $L$ 和特征速度尺度 $U$ 保持不变。\n- 每个时间步的成本与网格点数成正比，并且在本估算中忽略了温度方程本身带来的任何额外代数成本。\n- 在添加温度前后，时间步长均受限于对流 CFL（即，在所选分辨率下，粘性和热扩散的稳定性限制不会施加更严格的界限）。\n\n基于这些依据，推导当在 $Pr = 7$ 时添加温度作为输运标量，总计算成本（网格点数乘以达到固定物理时间所需的时间步数）的乘性增长。这个增长纯粹是由于更小的 $\\eta_{B}$ 以及在精细化分辨率下由对流 CFL 隐含的更严格的 $\\Delta t$ 所致。请将最终答案表示为一个纯数字（无单位）。无需四舍五入，提供精确值。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它提供了一套一致的物理和计算比例定律，用于确定在直接数值模拟 (DNS) 中添加高普朗特数标量时计算成本的增加。\n\n设 $C$ 表示总计算成本。根据问题陈述，模拟一个固定的物理时间 $T_{final}$ 的总成本是网格点数 $N$ 和时间步数 $M$ 的乘积。\n$$C \\propto N \\times M$$\n下标 $0$ 和 $T$ 将分别用于表示初始的等温情况和最终的含温度情况。我们旨在求出比率 $\\frac{C_T}{C_0}$。\n\n首先，我们确定网格点数 $N$ 的比例关系。对于一个边长固定为 $L$ 且网格间距均匀为 $\\Delta x$ 的立方体域，三维空间中的网格点数按以下比例缩放：\n$$N \\propto \\left(\\frac{L}{\\Delta x}\\right)^3 \\propto (\\Delta x)^{-3}$$\n问题陈述指出，一个完全解析的 DNS 要求网格间距 $\\Delta x$ 与最小相关物理尺度的量级相同。\n对于初始的等温情况，最小尺度是科尔莫戈罗夫长度尺度 $\\eta$。因此，网格间距为 $\\Delta x_0 \\propto \\eta$。\n对于普朗特数 $Pr > 1$ 的含温度的最终情况，最小尺度是巴切勒尺度 $\\eta_B$。网格间距必须细化至 $\\Delta x_T \\propto \\eta_B$。\n问题给出了对于 $Pr \\ge 1$ 的关系式 $\\eta_B = \\frac{\\eta}{\\sqrt{Pr}}$。\n两种情况下网格点数的比值为：\n$$\\frac{N_T}{N_0} = \\frac{(\\Delta x_T)^{-3}}{(\\Delta x_0)^{-3}} = \\left(\\frac{\\Delta x_0}{\\Delta x_T}\\right)^3$$\n由于 $\\Delta x_0 \\propto \\eta$ 且 $\\Delta x_T \\propto \\eta_B$，网格间距的比值为：\n$$\\frac{\\Delta x_0}{\\Delta x_T} \\propto \\frac{\\eta}{\\eta_B} = \\frac{\\eta}{\\eta/\\sqrt{Pr}} = \\sqrt{Pr}$$\n将此代入 $N$ 的比率中：\n$$\\frac{N_T}{N_0} = \\left(\\sqrt{Pr}\\right)^3 = Pr^{\\frac{3}{2}}$$\n\n接下来，我们确定时间步数 $M$ 的比例关系。要用时间步长 $\\Delta t$ 达到一个固定的物理时间 $T_{final}$，所需的步数为 $M = \\frac{T_{final}}{\\Delta t}$。因此，$M \\propto (\\Delta t)^{-1}$。\n问题陈述指出，时间步长受限于对流 Courant–Friedrichs–Lewy (CFL) 准则，其比例关系为 $\\Delta t \\propto \\frac{\\Delta x}{U}$。由于特征速度 $U$ 假定为常数，我们有 $\\Delta t \\propto \\Delta x$。\n因此，时间步数按以下比例缩放：\n$$M \\propto (\\Delta x)^{-1}$$\n两种情况下时间步数的比值为：\n$$\\frac{M_T}{M_0} = \\frac{(\\Delta t_T)^{-1}}{(\\Delta t_0)^{-1}} = \\frac{\\Delta t_0}{\\Delta t_T} = \\frac{\\Delta x_0}{\\Delta x_T}$$\n如前所定，此比值为 $\\sqrt{Pr}$：\n$$\\frac{M_T}{M_0} = \\sqrt{Pr} = Pr^{\\frac{1}{2}}$$\n\n最后，我们计算总计算成本的乘性增长，即比率 $\\frac{C_T}{C_0}$。\n$$\\frac{C_T}{C_0} = \\frac{N_T \\times M_T}{N_0 \\times M_0} = \\left(\\frac{N_T}{N_0}\\right) \\times \\left(\\frac{M_T}{M_0}\\right)$$\n代入上面推导出的比例关系：\n$$\\frac{C_T}{C_0} = \\left(Pr^{\\frac{3}{2}}\\right) \\times \\left(Pr^{\\frac{1}{2}}\\right) = Pr^{\\frac{3}{2} + \\frac{1}{2}} = Pr^2$$\n因此，总计算成本的乘性增长等于普朗特数的平方。\n\n问题给出了值 $Pr=7$。将此值代入我们推导的表达式中：\n$$\\text{Cost Increase} = 7^2 = 49$$\n因此，在指定的假设下，与等温情况相比，解析 $Pr=7$ 的温度场需要将总计算资源增加 49 倍。",
            "answer": "$$\n\\boxed{49}\n$$"
        },
        {
            "introduction": "鉴于 DNS 的高昂成本，LES 和 RANS 中广泛使用壁面函数来连接壁面和第一个离壁网格点，但这是一种模型上的折衷，会引入误差。本练习提供了一个量化框架，用于评估壁面函数在预测壁面传热（以努塞尔数 $Nu$ 衡量）时所引入的误差。你将通过一个经典模型，分析该误差如何关键地取决于第一个网格点的位置 $y^+$，从而学会评估工程预测结果对网格分辨率选择的敏感性 。",
            "id": "3941243",
            "problem": "本题要求您通过比较两个具有不同壁面坐标 $y^+$ 值的网格，并计算相对于参考值的误差估计，来量化无量纲努塞尔数对近壁面分辨率的敏感性。请在恒定壁温的光滑圆管内，充分发展的湍流与热充分发展的内部流动这一计算热工学中的标准经典构型背景下进行分析。\n\n使用一个基于原理的模型，其中参考努塞尔数由经过充分检验的湍流传热关联式推断得出，而近壁面分辨率的依赖性通过一个与经典温度壁面律相关联的壁面函数估计引入。求解应从以下基本基础开始：\n- 努塞尔数 $Nu$ 的定义为 $Nu = h D / k$，其中 $h$ 是对流传热系数，$D$ 是水力直径，$k$ 是导热系数。\n- 使用温度壁面单位 $\\Theta^+ = (T_w - T)/T_\\tau$ 对近壁面湍流输运进行内尺度标度，其中 $T_\\tau = q_w/(\\rho c_p u_\\tau)$ 是由壁面热通量 $q_w$、密度 $\\rho$、比热 $c_p$ 和摩擦速度 $u_\\tau$ 构建的温度尺度。\n- 温度的复合壁面律形式为 $\\Theta^+(y^+)$，对于小的 $y^+$ 有黏性子层，对于较大的 $y^+$ 有对数律层。\n- 参考努塞尔数 $Nu_{\\text{ref}}$ 由一个针对光滑管道的、经过充分验证的可靠关联式计算得出，以便它能近似壁面解析的高保真度计算的行为。您可以采用 Gnielinski 关联式作为一个经过充分检验的基础。\n\n假设采用以下复合温度壁面律及常数：\n- 黏性子层：对于 $y^+ \\le y_{\\text{crit}}$，$\\Theta^+(y^+) = y^+$。\n- 对数律层：对于 $y^+ > y_{\\text{crit}}$，$\\Theta^+(y^+) = \\dfrac{1}{\\kappa \\, Pr_t} \\ln(y^+) + B_t$。\n- Von Kármán 常数 $\\kappa = 0.41$ (无量纲)。\n- 湍流普朗特数 $Pr_t = 0.85$ (无量纲)。\n- 温度对数律加法常数 $B_t = 3.5$ (无量纲)。\n- 过渡位置 $y_{\\text{crit}} = 11.8$ (无量纲内尺度单位)。\n- 所有对数运算均使用自然对数 $\\ln(\\cdot)$。\n\n在壁面函数通常采用的实践中，即根据第一个离壁点的数值来估计近壁面梯度，我们将壁面处的无量纲温度梯度近似为比值 $\\Theta^+(y^+)/y^+$。通过将其与黏性子层中精确的内尺度单位梯度 $1$ 进行比较，我们将估计的壁面热通量（并因此在 $Nu$ 中）的乘性偏差建模为\n$$\nr(y^+) = \\frac{\\Theta^+(y^+)}{y^+}.\n$$\n因此，将与网格相关的努塞尔数估计值定义为\n$$\nNu_{\\text{est}}(y^+) = r(y^+) \\, Nu_{\\text{ref}}.\n$$\n将第一个单元中心位于 $y^+$ 的网格的相对误差（以小数而非百分比表示）定义为\n$$\ne(y^+) = \\frac{Nu_{\\text{est}}(y^+) - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = r(y^+) - 1.\n$$\n\n使用适用于光滑管道的 Gnielinski 关联式计算每个测试用例的参考努塞尔数 $Nu_{\\text{ref}}$，这是一个在湍流范围内针对 $Re$ 和 $Pr$ 的经过充分检验的公式：\n- 根据 Petukhov 关联式计算的摩擦因子：\n$$\nf = \\left(0.79 \\, \\ln(Re) - 1.64\\right)^{-2},\n$$\n适用于 $Re \\in [3\\times 10^3, 5\\times 10^6]$。\n- Gnielinski 关联式：\n$$\nNu_{\\text{ref}} = \\frac{(f/8)\\,(Re - 1000)\\,Pr}{1 + 12.7 \\sqrt{f/8}\\,\\left(Pr^{2/3} - 1\\right)},\n$$\n适用于 $Pr \\in [0.5, 2000]$ 及上述 $Re$ 范围。\n\n对于每个测试用例，给定两个由其第一个离壁点位置 $y^+_1$ 和 $y^+_2$ 表征的网格。对每个网格，计算 $e(y^+_1)$ 和 $e(y^+_2)$。通过相对于 $y^+$ 对数的有限差分斜率来量化误差对近壁面分辨率的敏感性，\n$$\ns = \\frac{e(y^+_2) - e(y^+_1)}{\\ln\\!\\left(\\frac{y^+_2}{y^+_1}\\right)}.\n$$\n\n实现一个程序，为每个测试用例返回一个包含四个浮点数的列表：\n- $Nu_{\\text{ref}}$，\n- $e(y^+_1)$，\n- $e(y^+_2)$，\n- $s$。\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的、由逗号分隔的列表之列表，例如 $\\left[ [\\dots], [\\dots] \\right]$。\n\n使用以下测试套件，它涵盖了典型工况和边界情况：\n- 工况 A (类空气，中等湍流，壁面解析与壁面模化对比)：$Re = 1.0\\times 10^5$, $Pr = 0.71$, $y^+_1 = 1.0$, $y^+_2 = 30.0$。\n- 工况 B (类水，高 $Pr$，强近壁面梯度)：$Re = 2.0\\times 10^5$, $Pr = 7.0$, $y^+_1 = 1.0$, $y^+_2 = 100.0$。\n- 工况 C (以缓冲层边缘作为粗网格)：$Re = 5.0\\times 10^4$, $Pr = 2.0$, $y^+_1 = 0.5$, $y^+_2 = 12.0$。\n- 工况 D (极高 $Re$，非常粗糙的近壁面采样)：$Re = 1.0\\times 10^6$, $Pr = 0.70$, $y^+_1 = 2.0$, $y^+_2 = 300.0$。\n\n所有量均为无量纲；无需物理单位。不涉及角度。所有最终数值答案均以浮点数表示。最终输出格式必须是表示 Python 列表之列表的字符串，且仅占一行，无任何附加文本。",
            "solution": "该问题要求在计算流体动力学 (CFD) 的背景下，分析预测的努塞尔数 $Nu$ 对近壁面网格分辨率的敏感性。这是通过利用管道中湍流传热的经典模型来完成的。分析的核心在于将基于壁面函数模型得到的努塞尔数估计值 $Nu_{\\text{est}}$ 与一个高保真度的参考值 $Nu_{\\text{ref}}$ 进行比较。这两个量之间的差异直接衡量了因近壁面网格分辨率不足而引入的误差。\n\n整个分析过程均使用无量纲量，这是流体力学和传热学中为实现普适性而采用的标准做法。关键的无量纲参数是雷诺数 $Re$、普朗特数 $Pr$ 和无量纲壁面距离 $y^+$。\n\n首先，我们为精确解建立基准。参考努塞尔数 $Nu_{\\text{ref}}$ 使用 Gnielinski 关联式计算，这是一个针对光滑圆管内充分发展湍流的、经过充分验证的经验公式。该关联式依赖于 $Re$ 和 $Pr$。它首先需要达西摩擦因子 $f$，我们使用 Petukhov 关联式来计算，该关联式适用于 $Re \\in [3\\times 10^3, 5\\times 10^6]$：\n$$\nf = \\left(0.79 \\, \\ln(Re) - 1.64\\right)^{-2}\n$$\n有了摩擦因子 $f$，Gnielinski 关联式为 $Pr \\in [0.5, 2000]$ 提供了参考努塞尔数：\n$$\nNu_{\\text{ref}} = \\frac{(f/8)\\,(Re - 1000)\\,Pr}{1 + 12.7 \\sqrt{f/8}\\,\\left(Pr^{2/3} - 1\\right)}\n$$\n这个 $Nu_{\\text{ref}}$ 作为我们的“基准真相”，代表了人们期望从一个非常精细的、壁面解析的模拟或精确实验中得到的结果。\n\n接下来，我们对粗糙近壁面网格引入的误差进行建模。在许多 CFD 模拟中，尤其是在使用雷诺平均纳维-斯托克斯 (RANS) 模型时，要解析壁面附近的薄黏性子层在计算上是极其昂贵的。取而代之的是，使用“壁面函数”来桥接壁面与第一个计算网格点之间的区域。这种方法的准确性关键取决于此第一个网格点的位置，由其 $y^+$ 值指定。\n\n该分析基于温度壁面律，它将无量纲温度分布 $\\Theta^+(y^+) = (T_w - T)/T_\\tau$ 描述为无量纲壁面距离 $y^+$ 的函数。这里，$T_w$ 是壁面温度，$T$ 是当地流体温度，$T_\\tau = q_w/(\\rho c_p u_\\tau)$ 是基于壁面热通量 $q_w$ 的摩擦温度。问题指定了 $\\Theta^+$ 的一个复合分布：\n- 在黏性子层中，对于 $y^+ \\le y_{\\text{crit}} = 11.8$：\n$$\n\\Theta^+(y^+) = y^+\n$$\n- 在对数律层中，对于 $y^+ > y_{\\text{crit}} = 11.8$：\n$$\n\\Theta^+(y^+) = \\frac{1}{\\kappa \\, Pr_t} \\ln(y^+) + B_t\n$$\n给定的常数为 $\\kappa = 0.41$，$Pr_t = 0.85$ 和 $B_t = 3.5$。\n\n壁面热通量 $q_w$ 与努塞尔数成正比，由壁面处的温度梯度计算得出。在无量纲形式下，这对应于 $y^+=0$ 处的梯度 $d\\Theta^+/dy^+$。在黏性子层中，该梯度精确为 $1$。一种常见的壁面函数做法是使用第一个网格点 $y^+_p$ 处的温度来近似该梯度，即 $(d\\Theta^+/dy^+)|_0 \\approx \\Theta^+(y^+_p) / y^+_p$。因此，计算出的热通量中的乘性偏差或误差因子，是近似梯度与精确梯度之比：\n$$\nr(y^+) = \\frac{\\text{近似梯度}}{\\text{精确梯度}} = \\frac{\\Theta^+(y^+)/y^+}{1} = \\frac{\\Theta^+(y^+)}{y^+}\n$$\n该因子直接转化为努塞尔数的偏差，使得 $Nu_{\\text{est}}(y^+) = r(y^+) \\, Nu_{\\text{ref}}$。\n\n相对误差 $e(y^+)$ 随后被定义为估计努塞尔数与参考值之间的分数偏差：\n$$\ne(y^+) = \\frac{Nu_{\\text{est}}(y^+) - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = \\frac{r(y^+) \\, Nu_{\\text{ref}} - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = r(y^+) - 1\n$$\n通过代入 $\\Theta^+(y^+)$ 的表达式，我们可以计算出任何给定 $y^+$ 的误差：\n- 对于 $y^+ \\le y_{\\text{crit}}$：$e(y^+) = (y^+ / y^+) - 1 = 0$。这意味着如果第一个单元格位于黏性子层内，这个特定的壁面函数模型预测的误差为零。\n- 对于 $y^+ > y_{\\text{crit}}$：$e(y^+) = \\left(\\frac{1}{y^+}\\left(\\frac{1}{\\kappa Pr_t} \\ln(y^+) + B_t\\right)\\right) - 1$。这表明对于粗糙网格 ($y^+ > y_{\\text{crit}}$)，误差取决于第一个网格点的布置。\n\n最后，为了量化此误差对近壁面分辨率变化的敏感性，我们计算了误差相对于 $y^+$ 对数的导数的有限差分近似。这是一个自然的选择，因为湍流剖面在 $y^+$ 上是对数的。给定两个具有第一个单元中心位置 $y^+_1$ 和 $y^+_2$ 的网格，敏感性 $s$ 为：\n$$\ns = \\frac{e(y^+_2) - e(y^+_1)}{\\ln(y^+_2) - \\ln(y^+_1)} = \\frac{e(y^+_2) - e(y^+_1)}{\\ln(y^+_2 / y^+_1)}\n$$\n$s$ 的绝对值越大，表示建模误差对近壁面网格间距的变化越敏感。\n\n每个测试用例的计算过程如下：\n1.  给定 $Re$ 和 $Pr$，使用 Petukhov 关联式计算摩擦因子 $f$。\n2.  使用 $f$、$Re$ 和 $Pr$ 通过 Gnielinski 公式计算参考努塞尔数 $Nu_{\\text{ref}}$。该值与网格参数 $y^+_1$ 和 $y^+_2$ 无关。\n3.  对于 $y^+_1$，首先根据 $y^+_1 \\le y_{\\text{crit}}$ 或 $y^+_1 > y_{\\text{crit}}$ 计算 $\\Theta^+(y^+_1)$，然后使用 $e(y^+_1) = \\Theta^+(y^+_1)/y^+_1 - 1$ 计算误差 $e(y^+_1)$。\n4.  同样地，为分辨率为 $y^+_2$ 的网格计算误差 $e(y^+_2)$。\n5.  使用 $e(y^+_1)$、$e(y^+_2)$、$y^+_1$ 和 $y^+_2$ 的值计算敏感性 $s$。\n6.  收集四个计算值：$[Nu_{\\text{ref}}, e(y^+_1), e(y^+_2), s]$。\n然后对所有指定的测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sensitivity of Nusselt number to near-wall resolution\n    for several test cases in turbulent pipe flow.\n    \"\"\"\n\n    # Define physical and model constants from the problem statement.\n    KAPPA = 0.41  # Von Kármán constant\n    PR_T = 0.85   # Turbulent Prandtl number\n    B_T = 3.5     # Temperature log-law additive constant\n    Y_CRIT = 11.8 # Crossover y+ from viscous sublayer to log layer\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Re, Pr, y_plus_1, y_plus_2)\n        (1.0e5, 0.71, 1.0, 30.0),   # Case A\n        (2.0e5, 7.0, 1.0, 100.0),  # Case B\n        (5.0e4, 2.0, 0.5, 12.0),   # Case C\n        (1.0e6, 0.70, 2.0, 300.0),  # Case D\n    ]\n\n    def calculate_nu_ref(Re, Pr):\n        \"\"\"\n        Calculates the reference Nusselt number using the Gnielinski correlation.\n        \"\"\"\n        # Petukhov correlation for friction factor f\n        f = (0.79 * np.log(Re) - 1.64)**(-2)\n\n        # Gnielinski correlation for Nu_ref\n        f_over_8 = f / 8.0\n        numerator = f_over_8 * (Re - 1000.0) * Pr\n        denominator = 1.0 + 12.7 * np.sqrt(f_over_8) * (Pr**(2.0/3.0) - 1.0)\n        \n        return numerator / denominator\n\n    def calculate_theta_plus(y_plus):\n        \"\"\"\n        Calculates the dimensionless temperature Theta+ based on the composite law of the wall.\n        \"\"\"\n        if y_plus = Y_CRIT:\n            # Viscous sublayer\n            return y_plus\n        else:\n            # Logarithmic layer\n            return (1.0 / (KAPPA * PR_T)) * np.log(y_plus) + B_T\n            \n    def calculate_relative_error(y_plus):\n        \"\"\"\n        Calculates the relative error e(y+) based on the wall function model.\n        e(y+) = r(y+) - 1, where r(y+) = Theta+(y+)/y+\n        \"\"\"\n        theta_p = calculate_theta_plus(y_plus)\n        r_y_plus = theta_p / y_plus\n        return r_y_plus - 1.0\n        \n    def calculate_sensitivity(e1, e2, y_plus1, y_plus2):\n        \"\"\"\n        Calculates the sensitivity s of the error to the log of the wall coordinate.\n        \"\"\"\n        # s = (e2 - e1) / ln(y2/y1) = (e2 - e1) / (ln(y2) - ln(y1))\n        return (e2 - e1) / np.log(y_plus2 / y_plus1)\n\n    results = []\n    for case in test_cases:\n        Re, Pr, y_plus1, y_plus2 = case\n        \n        # 1. Calculate the reference Nusselt number\n        nu_ref = calculate_nu_ref(Re, Pr)\n        \n        # 2. Calculate the relative error for the first grid\n        e1 = calculate_relative_error(y_plus1)\n        \n        # 3. Calculate the relative error for the second grid\n        e2 = calculate_relative_error(y_plus2)\n        \n        # 4. Calculate the sensitivity\n        s = calculate_sensitivity(e1, e2, y_plus1, y_plus2)\n        \n        # Append the list of four floats to the main results list\n        results.append([nu_ref, e1, e2, s])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}