{
    "hands_on_practices": [
        {
            "introduction": "Understanding the near-wall region in turbulent flows is critical for accurate thermal and momentum predictions. The dimensionless wall coordinate, $y^+$, provides a universal framework for describing the physics in this region. This first exercise  provides a foundational practice in calculating $y^+$ from primary flow parameters and, more importantly, using its value to make a crucial judgment about simulation strategy—determining whether a computational grid is fine enough for a wall-resolved simulation or if it necessitates a wall model.",
            "id": "3941228",
            "problem": "A fully developed, high-Reynolds-number turbulent channel flow of air at standard conditions is to be simulated for conjugate heat transfer analysis. A preliminary wall shear measurement yields the friction velocity $u_{\\tau}$, and the kinematic viscosity $\\nu$ of the air is known. The computational mesh currently places the center of the first off-wall cell at a distance $y_1$ from the wall. In the context of comparing Direct Numerical Simulation (DNS), Large-Eddy Simulation (LES), and Reynolds-Averaged Navier–Stokes (RANS) approaches, the suitability of a wall model hinges on the nondimensional near-wall resolution.\n\nStarting from first principles, use the definition of the friction velocity $u_{\\tau}$ and the viscous length scale to derive the nondimensional wall coordinate $y_1^{+}$ in terms of $y_1$, $u_{\\tau}$, and $\\nu$. Then, evaluate $y_1^{+}$ for the following physically consistent parameters:\n- Friction velocity $u_{\\tau} = 0.50 \\ \\mathrm{m/s}$,\n- Kinematic viscosity $\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$,\n- First-cell-center wall-normal distance $y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$.\n\nFinally, based on canonical near-wall structure and modeling practice in wall-bounded turbulence, interpret whether a wall model would be appropriate for LES at this resolution, and briefly justify your decision by referencing the location of $y_1^{+}$ relative to established near-wall regions.\n\nRound your computed value of $y_1^{+}$ to four significant figures. Express the final result as a pure number (dimensionless). The final answer must be only the computed value of $y_1^{+}$.",
            "solution": "### Solution Derivation and Calculation\n\nThe first step is to derive the expression for the nondimensional wall coordinate, $y^{+}$. This coordinate system is used to characterize the structure of the flow in the near-wall region of a turbulent boundary layer. The scaling is based on physical quantities that dominate this region.\n\nThe key quantities governing the fluid motion in the immediate vicinity of a solid wall (the viscous sublayer) are the wall shear stress, $\\tau_w$, the fluid density, $\\rho$, and the fluid kinematic viscosity, $\\nu$. From these, we can construct characteristic scales for velocity, length, and time.\n\nThe characteristic velocity scale is the friction velocity, $u_{\\tau}$, which is defined as:\n$$\nu_{\\tau} \\equiv \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\nThis quantity has units of velocity $[L T^{-1}]$. The problem directly provides the value of $u_{\\tau}$.\n\nThe characteristic length scale in the near-wall region is the viscous length scale, sometimes denoted $\\delta_{\\nu}$. It is formed by a combination of the friction velocity, $u_{\\tau}$, and the kinematic viscosity, $\\nu$, that yields a dimension of length. The dimensions are:\n- $[u_{\\tau}] = L T^{-1}$\n- $[\\nu] = L^2 T^{-1}$\n\nTo obtain a quantity with units of length $[L]$, we must divide $\\nu$ by $u_{\\tau}$:\n$$\n\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}} \\quad \\left( \\frac{[L^2 T^{-1}]}{[L T^{-1}]} = [L] \\right)\n$$\nThis is the viscous length scale. It represents the approximate thickness of the region where viscous effects are dominant over inertial effects.\n\nThe nondimensional wall coordinate, $y^{+}$, is defined as the physical wall-normal distance, $y$, normalized by this viscous length scale $\\delta_{\\nu}$:\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}}\n$$\nSubstituting the expression for $\\delta_{\\nu}$, we arrive at the desired relationship:\n$$\ny^{+} = \\frac{y}{\\left(\\frac{\\nu}{u_{\\tau}}\\right)} = \\frac{y u_{\\tau}}{\\nu}\n$$\nFor the specific case of the first computational cell center at a distance $y_1$ from the wall, its nondimensional coordinate is denoted $y_1^{+}$:\n$$\ny_1^{+} = \\frac{y_1 u_{\\tau}}{\\nu}\n$$\nThis completes the derivation from first principles.\n\nNext, we evaluate $y_1^{+}$ using the provided numerical values:\n- $y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$\n- $u_{\\tau} = 0.50 \\ \\mathrm{m/s}$\n- $\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$\n\nSubstituting these values into the derived formula:\n$$\ny_1^{+} = \\frac{(1.0 \\times 10^{-4} \\ \\mathrm{m}) (0.50 \\ \\mathrm{m/s})}{1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}}\n$$\nThe units cancel out as expected, yielding a dimensionless number:\n$$\n\\frac{\\mathrm{m} \\cdot \\mathrm{m/s}}{\\mathrm{m^2/s}} = 1\n$$\nNow, we perform the arithmetic:\n$$\ny_1^{+} = \\frac{0.50 \\times 10^{-4}}{1.5 \\times 10^{-5}} = \\frac{0.50}{1.5} \\times 10^{(-4 - (-5))} = \\frac{1}{3} \\times 10^1 = \\frac{10}{3}\n$$\nThe value is $y_1^{+} = 3.3333...$. Rounding to four significant figures as requested gives:\n$$\ny_1^{+} \\approx 3.333\n$$\n\n### Interpretation for LES Wall Modeling\n\nThe suitability of a wall model for a Large-Eddy Simulation (LES) is critically dependent on the placement of the first off-wall grid point, quantified by its $y_1^{+}$ value. The near-wall region of a turbulent boundary layer is canonically divided into several regions based on their $y^{+}$values:\n1.  **Viscous Sublayer**: For $y^{+} \\lesssim 5$, viscous shear stress dominates, and the mean velocity profile is linear ($u^{+} = y^{+}$).\n2.  **Buffer Layer**: For $5 \\lesssim y^{+} \\lesssim 30$, both viscous and turbulent (Reynolds) stresses are significant. This is a complex transition region.\n3.  **Logarithmic Layer (Log-Law Region)**: For $y^{+} \\gtrsim 30$ (up to a certain fraction of the boundary layer thickness), turbulent stresses dominate, and the mean velocity profile follows a logarithmic law ($u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$).\n\nWall models in LES are designed to bridge the inner part of the boundary layer, avoiding the computationally prohibitive cost of resolving it directly. These models are almost universally based on the assumption that the first off-wall grid point lies within the logarithmic layer, where the universal law of the wall holds. Therefore, a prerequisite for applying a standard wall model is that $y_1^{+} \\gtrsim 30$.\n\nIn this problem, the calculated value is $y_1^{+} \\approx 3.333$. This value places the center of the first computational cell squarely within the **viscous sublayer**. At this location, the fundamental assumption of a logarithmic velocity profile, upon which wall models rely, is invalid. Using a wall model at this resolution would be incorrect and would lead to significant modeling errors.\n\nTherefore, a wall model would be **inappropriate** for an LES at this resolution. A mesh with $y_1^{+} \\approx 3.333$ is designed for a **wall-resolved** simulation, where the turbulent structures within the viscous and buffer layers are at least partially resolved by the grid, not modeled. To use a wall model correctly, the near-wall mesh would need to be coarsened such that the first cell center is moved into the log-law region (e.g., $y_1^{+} > 30$).",
            "answer": "$$\n\\boxed{3.333}\n$$"
        },
        {
            "introduction": "While Direct Numerical Simulation (DNS) offers the highest fidelity by resolving all scales of turbulence, its computational cost can be astronomical. This is particularly true when simulating heat transfer in fluids with a high Prandtl number, where thermal gradients become extremely steep. This scaling analysis exercise  allows you to derive the dramatic increase in computational cost associated with resolving these fine thermal scales, providing a clear, quantitative justification for the necessity of more economical approaches like LES and RANS in many practical engineering scenarios.",
            "id": "3941206",
            "problem": "In a three-dimensional, incompressible turbulent flow solved by Direct Numerical Simulation (DNS), you initially simulate an isothermal case with grid spacing $\\Delta x_{0}$ chosen to resolve the Kolmogorov length scale $\\eta$. You now add temperature as a transported scalar at Prandtl number $Pr = 7$ and require the temperature field to be DNS-resolved as well. Let Large-Eddy Simulation (LES) and Reynolds-Averaged Navier–Stokes (RANS) be alternative approaches with coarser resolution requirements, but here focus on the DNS regime.\n\nUse the following fundamental bases:\n- The Prandtl number is $Pr = \\nu / \\alpha$, where $\\nu$ is kinematic viscosity and $\\alpha$ is thermal diffusivity.\n- The Kolmogorov length scale is $\\eta$, the smallest dynamically active scale in turbulence for momentum.\n- For $Pr \\ge 1$, the Batchelor scale for a scalar with diffusivity smaller than viscosity is $\\eta_{B} = \\eta / \\sqrt{Pr}$.\n- A fully resolved DNS requires $\\Delta x$ of the order of the smallest relevant physical scale (i.e., for momentum, $\\Delta x_{0} \\sim \\eta$; for temperature at $Pr \\ge 1$, $\\Delta x_{T} \\sim \\eta_{B}$).\n- For a cubic domain of fixed side length $L$, the number of grid points scales like $(L / \\Delta x)^{3}$.\n- For explicit time integration with the convective Courant–Friedrichs–Lewy (CFL) criterion dominant, the stable time step scales like $\\Delta t \\propto \\Delta x / U$, where $U$ is a characteristic velocity scale independent of $\\Delta x$.\n\nAssume the following to isolate the resolution-driven computational effects:\n- The domain size $L$ and characteristic velocity scale $U$ remain unchanged when adding temperature.\n- The per-time-step cost scales proportionally with the number of grid points, and any additional algebraic cost of the temperature equation itself is neglected for this estimate.\n- The time step is limited by the convective CFL both before and after adding temperature (i.e., viscous and thermal diffusion stability limits do not impose a stricter bound at the chosen resolutions).\n\nStarting from these bases, derive the multiplicative increase in total computational cost (number of grid points times number of time steps to reach a fixed physical time) when adding temperature as a transported scalar at $Pr = 7$, purely due to the smaller $\\eta_{B}$ and the stricter $\\Delta t$ implied by the convective CFL at the refined resolution. Express your final answer as a single pure number (no units). No rounding is necessary; provide the exact value.",
            "solution": "Let $C$ denote the total computational cost. According to the problem statement, the total cost to simulate a fixed physical time $T_{final}$ is the product of the number of grid points $N$ and the number of time steps $M$.\n$$C \\propto N \\times M$$\nThe subscripts $0$ and $T$ will be used to denote the initial isothermal case and the final case with temperature, respectively. We seek to find the ratio $\\frac{C_T}{C_0}$.\n\nFirst, we establish the scaling of the number of grid points $N$. For a cubic domain of fixed side length $L$ and uniform grid spacing $\\Delta x$, the number of grid points in three dimensions scales as:\n$$N \\propto \\left(\\frac{L}{\\Delta x}\\right)^3 \\propto (\\Delta x)^{-3}$$\nThe problem states that a fully resolved DNS requires the grid spacing $\\Delta x$ to be on the order of the smallest relevant physical scale.\nFor the initial isothermal case, the smallest scale is the Kolmogorov length scale $\\eta$. Thus, the grid spacing is $\\Delta x_0 \\propto \\eta$.\nFor the final case with temperature at Prandtl number $Pr > 1$, the smallest scale is the Batchelor scale $\\eta_B$. The grid spacing must be refined to $\\Delta x_T \\propto \\eta_B$.\nThe problem provides the relationship $\\eta_B = \\frac{\\eta}{\\sqrt{Pr}}$ for $Pr \\ge 1$.\nThe ratio of the number of grid points in the two cases is:\n$$\\frac{N_T}{N_0} = \\frac{(\\Delta x_T)^{-3}}{(\\Delta x_0)^{-3}} = \\left(\\frac{\\Delta x_0}{\\Delta x_T}\\right)^3$$\nSince $\\Delta x_0 \\propto \\eta$ and $\\Delta x_T \\propto \\eta_B$, the ratio of the grid spacings is:\n$$\\frac{\\Delta x_0}{\\Delta x_T} \\propto \\frac{\\eta}{\\eta_B} = \\frac{\\eta}{\\eta/\\sqrt{Pr}} = \\sqrt{Pr}$$\nSubstituting this into the ratio for $N$:\n$$\\frac{N_T}{N_0} = \\left(\\sqrt{Pr}\\right)^3 = Pr^{\\frac{3}{2}}$$\n\nNext, we establish the scaling for the number of time steps $M$. To reach a fixed physical time $T_{final}$ with a time step $\\Delta t$, the number of steps required is $M = \\frac{T_{final}}{\\Delta t}$. Thus, $M \\propto (\\Delta t)^{-1}$.\nThe problem states that the time step is limited by the convective Courant–Friedrichs–Lewy (CFL) criterion, which scales as $\\Delta t \\propto \\frac{\\Delta x}{U}$. Since the characteristic velocity $U$ is assumed constant, we have $\\Delta t \\propto \\Delta x$.\nTherefore, the number of time steps scales as:\n$$M \\propto (\\Delta x)^{-1}$$\nThe ratio of the number of time steps in the two cases is:\n$$\\frac{M_T}{M_0} = \\frac{(\\Delta t_T)^{-1}}{(\\Delta t_0)^{-1}} = \\frac{\\Delta t_0}{\\Delta t_T} = \\frac{\\Delta x_0}{\\Delta x_T}$$\nAs determined previously, this ratio is $\\sqrt{Pr}$:\n$$\\frac{M_T}{M_0} = \\sqrt{Pr} = Pr^{\\frac{1}{2}}$$\n\nFinally, we compute the multiplicative increase in total computational cost, which is the ratio $\\frac{C_T}{C_0}$.\n$$\\frac{C_T}{C_0} = \\frac{N_T \\times M_T}{N_0 \\times M_0} = \\left(\\frac{N_T}{N_0}\\right) \\times \\left(\\frac{M_T}{M_0}\\right)$$\nSubstituting the scaling relationships derived above:\n$$\\frac{C_T}{C_0} = \\left(Pr^{\\frac{3}{2}}\\right) \\times \\left(Pr^{\\frac{1}{2}}\\right) = Pr^{\\frac{3}{2} + \\frac{1}{2}} = Pr^2$$\nThe multiplicative increase in total computational cost is therefore equal to the square of the Prandtl number.\n\nThe problem provides the value $Pr=7$. Substituting this value into our derived expression:\n$$\\text{Cost Increase} = 7^2 = 49$$\nThus, resolving the temperature field at $Pr=7$ requires a $49$-fold increase in total computational resources compared to the isothermal case, under the specified assumptions.",
            "answer": "$$\n\\boxed{49}\n$$"
        },
        {
            "introduction": "Given that DNS is often out of reach, engineers rely on LES and RANS, which employ wall models to bypass the need for resolving the finest near-wall scales. However, this computational saving comes at the cost of introducing modeling assumptions whose accuracy must be understood. This final practice  is a computational exercise that lets you directly quantify the error introduced by a standard wall function, connecting the local grid resolution choice ($y^+$) to a global engineering metric, the Nusselt number. By comparing your model's prediction against a trusted engineering correlation, you will gain practical insight into the trade-offs between accuracy and computational cost inherent in turbulent heat transfer modeling.",
            "id": "3941243",
            "problem": "You are asked to quantify the sensitivity of the dimensionless Nusselt number to near-wall resolution by comparing two grids with different values of the wall coordinate $y^+$ and computing an error estimate relative to a reference. Work in the context of fully developed turbulent, thermally fully developed internal flow in a smooth circular pipe with constant wall temperature, which is a standard canonical configuration in computational thermal engineering.\n\nUse a principle-based model in which the reference Nusselt number is inferred from a well-tested turbulent heat transfer correlation, and the near-wall resolution dependence enters through a wall-function estimate tied to the canonical temperature law of the wall. The solution should start from the following fundamental base:\n- The definition of the Nusselt number $Nu$ as $Nu = h D / k$, where $h$ is the convective heat transfer coefficient, $D$ is the hydraulic diameter, and $k$ is the thermal conductivity.\n- The inner scaling of near-wall turbulent transport using temperature wall units $\\Theta^+ = (T_w - T)/T_\\tau$, where $T_\\tau = q_w/(\\rho c_p u_\\tau)$ is the temperature scale constructed from the wall heat flux $q_w$, density $\\rho$, specific heat $c_p$, and friction velocity $u_\\tau$.\n- The composite law of the wall for temperature in the form $\\Theta^+(y^+)$, with a viscous sublayer for small $y^+$ and a logarithmic layer for larger $y^+$.\n- A reference Nusselt number $Nu_{\\text{ref}}$ computed from a robust, validated correlation for smooth pipes so that it approximates the behavior of a wall-resolved high-fidelity calculation. You may adopt the Gnielinski correlation as a well-tested foundation.\n\nAssume the following composite temperature law of the wall and constants:\n- Viscous sublayer: for $y^+ \\le y_{\\text{crit}}$, $\\Theta^+(y^+) = y^+$.\n- Logarithmic layer: for $y^+  y_{\\text{crit}}$, $\\Theta^+(y^+) = \\dfrac{1}{\\kappa \\, Pr_t} \\ln(y^+) + B_t$.\n- Von Kármán constant $\\kappa = 0.41$ (dimensionless).\n- Turbulent Prandtl number $Pr_t = 0.85$ (dimensionless).\n- Temperature log-law additive constant $B_t = 3.5$ (dimensionless).\n- Crossover location $y_{\\text{crit}} = 11.8$ (dimensionless inner units).\n- The natural logarithm $\\ln(\\cdot)$ is to be used for all logarithmic operations.\n\nUnder the common wall-function practice of estimating a near-wall gradient from the value at the first off-wall point, approximate the dimensionless temperature gradient at the wall by the ratio $\\Theta^+(y^+)/y^+$. By comparing this to the exact viscous-sublayer gradient of $1$ in inner units, model the multiplicative bias in the estimated wall heat flux (and hence in $Nu$) as\n$$\nr(y^+) = \\frac{\\Theta^+(y^+)}{y^+}.\n$$\nAccordingly, define the grid-dependent Nusselt estimate as\n$$\nNu_{\\text{est}}(y^+) = r(y^+) \\, Nu_{\\text{ref}}.\n$$\nDefine the relative error (as a decimal, not a percentage) for a grid with first-cell location $y^+$ as\n$$\ne(y^+) = \\frac{Nu_{\\text{est}}(y^+) - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = r(y^+) - 1.\n$$\n\nCompute the reference Nusselt number $Nu_{\\text{ref}}$ for each test case using the Gnielinski correlation for smooth pipes, which is a well-tested formula for $Re$ and $Pr$ in the turbulent range:\n- Friction factor from the Petukhov correlation:\n$$\nf = \\left(0.79 \\, \\ln(Re) - 1.64\\right)^{-2},\n$$\nvalid for $Re \\in [3\\times 10^3, 5\\times 10^6]$.\n- Gnielinski correlation:\n$$\nNu_{\\text{ref}} = \\frac{(f/8)\\,(Re - 1000)\\,Pr}{1 + 12.7 \\sqrt{f/8}\\,\\left(Pr^{2/3} - 1\\right)},\n$$\nvalid for $Pr \\in [0.5, 2000]$ and the above $Re$ range.\n\nFor each test case, you are given two grids characterized by their first off-wall locations $y^+_1$ and $y^+_2$. For each grid, compute $e(y^+_1)$ and $e(y^+_2)$. Quantify the sensitivity of the error to near-wall resolution by the finite-difference slope with respect to the logarithm of $y^+$,\n$$\ns = \\frac{e(y^+_2) - e(y^+_1)}{\\ln\\!\\left(\\frac{y^+_2}{y^+_1}\\right)}.\n$$\n\nImplement a program that, for each test case, returns a list of four floating-point numbers:\n- $Nu_{\\text{ref}}$,\n- $e(y^+_1)$,\n- $e(y^+_2)$,\n- $s$.\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list of lists enclosed in square brackets, for example, $\\left[ [\\dots], [\\dots] \\right]$.\n\nUse the following test suite, which spans typical conditions and edge cases:\n- Case A (air-like, moderate turbulence, wall-resolved versus wall-modeled): $Re = 1.0\\times 10^5$, $Pr = 0.71$, $y^+_1 = 1.0$, $y^+_2 = 30.0$.\n- Case B (water-like, high $Pr$, strong near-wall gradients): $Re = 2.0\\times 10^5$, $Pr = 7.0$, $y^+_1 = 1.0$, $y^+_2 = 100.0$.\n- Case C (buffer-layer edge as coarse grid): $Re = 5.0\\times 10^4$, $Pr = 2.0$, $y^+_1 = 0.5$, $y^+_2 = 12.0$.\n- Case D (very high $Re$, very coarse near-wall sampling): $Re = 1.0\\times 10^6$, $Pr = 0.70$, $y^+_1 = 2.0$, $y^+_2 = 300.0$.\n\nAll quantities are dimensionless; no physical units are required. Angles are not involved. Express all final numerical answers as floating-point numbers. The final output format must be exactly a single line that is a string representation of a Python list of lists, with no additional text.",
            "solution": "The problem requires an analysis of the sensitivity of the predicted Nusselt number, $Nu$, to the near-wall grid resolution in a computational fluid dynamics (CFD) context. This is accomplished by leveraging canonical models for turbulent heat transfer in a pipe. The core of the analysis rests on comparing a Nusselt number estimate derived from a wall-function model, $Nu_{\\text{est}}$, against a high-fidelity reference value, $Nu_{\\text{ref}}$. The discrepancy between these two quantities is a direct measure of the error introduced by inadequate grid resolution near the wall.\n\nThe entire analysis is conducted using dimensionless quantities, which is standard practice in fluid mechanics and heat transfer for achieving generality. The key dimensionless parameters are the Reynolds number, $Re$, the Prandtl number, $Pr$, and the dimensionless wall distance, $y^+$.\n\nFirst, we establish the benchmark for an accurate solution. The reference Nusselt number, $Nu_{\\text{ref}}$, is computed using the Gnielinski correlation, which is a well-validated empirical formula for fully developed turbulent flow in smooth circular pipes. This correlation depends on both $Re$ and $Pr$. It first requires the Darcy friction factor, $f$, for which we use the Petukhov correlation, valid for $Re \\in [3\\times 10^3, 5\\times 10^6]$:\n$$\nf = \\left(0.79 \\, \\ln(Re) - 1.64\\right)^{-2}\n$$\nWith the friction factor $f$, the Gnielinski correlation provides the reference Nusselt number for $Pr \\in [0.5, 2000]$:\n$$\nNu_{\\text{ref}} = \\frac{(f/8)\\,(Re - 1000)\\,Pr}{1 + 12.7 \\sqrt{f/8}\\,\\left(Pr^{2/3} - 1\\right)}\n$$\nThis $Nu_{\\text{ref}}$ serves as our \"ground truth,\" representing the result one would expect from a very fine, wall-resolved simulation or a precise experiment.\n\nNext, we model the error introduced by a coarse near-wall grid. In many CFD simulations, particularly using Reynolds-Averaged Navier-Stokes (RANS) models, it is computationally prohibitive to resolve the thin viscous sublayer near the wall. Instead, \"wall functions\" are used to bridge the region between the wall and the first computational grid point. The accuracy of this approach depends critically on the position of this first grid point, specified by its $y^+$ value.\n\nThe analysis is based on the law of the wall for temperature, which describes the dimensionless temperature profile, $\\Theta^+(y^+) = (T_w - T)/T_\\tau$, as a function of the dimensionless wall distance, $y^+$. Here, $T_w$ is the wall temperature, $T$ is the local fluid temperature, and $T_\\tau = q_w/(\\rho c_p u_\\tau)$ is the friction temperature based on wall heat flux $q_w$. The problem specifies a composite profile for $\\Theta^+$:\n- In the viscous sublayer, for $y^+ \\le y_{\\text{crit}} = 11.8$:\n$$\n\\Theta^+(y^+) = y^+\n$$\n- In the logarithmic layer, for $y^+  y_{\\text{crit}} = 11.8$:\n$$\n\\Theta^+(y^+) = \\frac{1}{\\kappa \\, Pr_t} \\ln(y^+) + B_t\n$$\nThe constants are given as $\\kappa = 0.41$, $Pr_t = 0.85$, and $B_t = 3.5$.\n\nThe wall heat flux, $q_w$, which is directly proportional to the Nusselt number, is computed from the temperature gradient at the wall. In dimensionless form, this corresponds to the gradient $d\\Theta^+/dy^+$ at $y^+=0$. In the viscous sublayer, this gradient is exactly $1$. A common wall-function practice approximates this gradient using the temperature at the first grid point, $y^+_p$, as $(d\\Theta^+/dy^+)|_0 \\approx \\Theta^+(y^+_p) / y^+_p$. The multiplicative bias, or error factor, in the computed heat flux is therefore the ratio of the approximate gradient to the exact gradient:\n$$\nr(y^+) = \\frac{\\text{approximate gradient}}{\\text{exact gradient}} = \\frac{\\Theta^+(y^+)/y^+}{1} = \\frac{\\Theta^+(y^+)}{y^+}\n$$\nThis factor directly translates to a bias in the Nusselt number, such that $Nu_{\\text{est}}(y^+) = r(y^+) \\, Nu_{\\text{ref}}$.\n\nThe relative error, $e(y^+)$, is then defined as the fractional deviation of the estimated Nusselt number from the reference value:\n$$\ne(y^+) = \\frac{Nu_{\\text{est}}(y^+) - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = \\frac{r(y^+) \\, Nu_{\\text{ref}} - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = r(y^+) - 1\n$$\nBy substituting the expressions for $\\Theta^+(y^+)$, we can calculate the error for any given $y^+$:\n- For $y^+ \\le y_{\\text{crit}}$: $e(y^+) = (y^+ / y^+) - 1 = 0$. This implies that if the first cell is within the viscous sublayer, this particular wall-function model predicts zero error.\n- For $y^+  y_{\\text{crit}}$: $e(y^+) = \\left(\\frac{1}{y^+}\\left(\\frac{1}{\\kappa Pr_t} \\ln(y^+) + B_t\\right)\\right) - 1$. This shows that for coarse grids ($y^+  y_{\\text{crit}}$), the error depends on the placement of the first grid point.\n\nFinally, to quantify the sensitivity of this error to changes in near-wall resolution, we compute a finite-difference approximation of the derivative of the error with respect to the logarithm of $y^+$. This is a natural choice as turbulent profiles are logarithmic in $y^+$. Given two grids with first-cell locations $y^+_1$ and $y^+_2$, the sensitivity, $s$, is:\n$$\ns = \\frac{e(y^+_2) - e(y^+_1)}{\\ln(y^+_2) - \\ln(y^+_1)} = \\frac{e(y^+_2) - e(y^+_1)}{\\ln(y^+_2 / y^+_1)}\n$$\nA larger magnitude of $s$ indicates that the modeling error is more sensitive to changes in the near-wall grid spacing.\n\nThe computational procedure for each test case is as follows:\n1.  Given $Re$ and $Pr$, calculate the friction factor $f$ using the Petukhov correlation.\n2.  Use $f$, $Re$, and $Pr$ to compute the reference Nusselt number, $Nu_{\\text{ref}}$, from the Gnielinski formula. This value is independent of the grid parameters $y^+_1$ and $y^+_2$.\n3.  For $y^+_1$, compute the error $e(y^+_1)$ by first calculating $\\Theta^+(y^+_1)$ based on whether $y^+_1 \\le y_{\\text{crit}}$ or $y^+_1  y_{\\text{crit}}$, and then using $e(y^+_1) = \\Theta^+(y^+_1)/y^+_1 - 1$.\n4.  Similarly, compute the error $e(y^+_2)$ for the grid with resolution $y^+_2$.\n5.  Calculate the sensitivity $s$ using the values of $e(y^+_1)$, $e(y^+_2)$, $y^+_1$, and $y^+_2$.\n6.  Collect the four computed values: $[Nu_{\\text{ref}}, e(y^+_1), e(y^+_2), s]$.\nThis procedure is then repeated for all specified test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sensitivity of Nusselt number to near-wall resolution\n    for several test cases in turbulent pipe flow.\n    \"\"\"\n\n    # Define physical and model constants from the problem statement.\n    KAPPA = 0.41  # Von Kármán constant\n    PR_T = 0.85   # Turbulent Prandtl number\n    B_T = 3.5     # Temperature log-law additive constant\n    Y_CRIT = 11.8 # Crossover y+ from viscous sublayer to log layer\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Re, Pr, y_plus_1, y_plus_2)\n        (1.0e5, 0.71, 1.0, 30.0),   # Case A\n        (2.0e5, 7.0, 1.0, 100.0),  # Case B\n        (5.0e4, 2.0, 0.5, 12.0),   # Case C\n        (1.0e6, 0.70, 2.0, 300.0),  # Case D\n    ]\n\n    def calculate_nu_ref(Re, Pr):\n        \"\"\"\n        Calculates the reference Nusselt number using the Gnielinski correlation.\n        \"\"\"\n        # Petukhov correlation for friction factor f\n        f = (0.79 * np.log(Re) - 1.64)**(-2)\n\n        # Gnielinski correlation for Nu_ref\n        f_over_8 = f / 8.0\n        numerator = f_over_8 * (Re - 1000.0) * Pr\n        denominator = 1.0 + 12.7 * np.sqrt(f_over_8) * (Pr**(2.0/3.0) - 1.0)\n        \n        return numerator / denominator\n\n    def calculate_theta_plus(y_plus):\n        \"\"\"\n        Calculates the dimensionless temperature Theta+ based on the composite law of the wall.\n        \"\"\"\n        if y_plus = Y_CRIT:\n            # Viscous sublayer\n            return y_plus\n        else:\n            # Logarithmic layer\n            return (1.0 / (KAPPA * PR_T)) * np.log(y_plus) + B_T\n            \n    def calculate_relative_error(y_plus):\n        \"\"\"\n        Calculates the relative error e(y+) based on the wall function model.\n        e(y+) = r(y+) - 1, where r(y+) = Theta+(y+)/y+\n        \"\"\"\n        theta_p = calculate_theta_plus(y_plus)\n        r_y_plus = theta_p / y_plus\n        return r_y_plus - 1.0\n        \n    def calculate_sensitivity(e1, e2, y_plus1, y_plus2):\n        \"\"\"\n        Calculates the sensitivity s of the error to the log of the wall coordinate.\n        \"\"\"\n        # s = (e2 - e1) / ln(y2/y1) = (e2 - e1) / (ln(y2) - ln(y1))\n        return (e2 - e1) / np.log(y_plus2 / y_plus1)\n\n    results = []\n    for case in test_cases:\n        Re, Pr, y_plus1, y_plus2 = case\n        \n        # 1. Calculate the reference Nusselt number\n        nu_ref = calculate_nu_ref(Re, Pr)\n        \n        # 2. Calculate the relative error for the first grid\n        e1 = calculate_relative_error(y_plus1)\n        \n        # 3. Calculate the relative error for the second grid\n        e2 = calculate_relative_error(y_plus2)\n        \n        # 4. Calculate the sensitivity\n        s = calculate_sensitivity(e1, e2, y_plus1, y_plus2)\n        \n        # Append the list of four floats to the main results list\n        results.append([nu_ref, e1, e2, s])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}