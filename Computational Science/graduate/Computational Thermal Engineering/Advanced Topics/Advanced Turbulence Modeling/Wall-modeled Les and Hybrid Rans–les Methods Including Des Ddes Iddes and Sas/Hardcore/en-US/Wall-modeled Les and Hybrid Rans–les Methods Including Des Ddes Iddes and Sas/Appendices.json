{
    "hands_on_practices": [
        {
            "introduction": "Before applying complex hybrid models, it is crucial to master the fundamental language of near-wall turbulence. This exercise  provides hands-on practice in calculating essential quantities like the friction velocity, $u_{\\tau}$, and the dimensionless wall distance, $y^{+}$, which are the cornerstones for designing an appropriate grid for a wall-modeled LES (WMLES).",
            "id": "4005141",
            "problem": "A wall-modeled Large Eddy Simulation (WMLES) is to be performed for a high-Reynolds-number, incompressible, isothermal turbulent flow over a smooth flat wall. The near-wall thermal coupling is negligible, and the momentum wall model will sample at a prescribed inner-scaled height. The fluid is air at standard conditions with density $\\rho=1.2\\,\\mathrm{kg/m^3}$ and kinematic viscosity $\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$. A measured steady wall shear stress is $\\tau_{w}=0.8\\,\\mathrm{Pa}$. \n\nStarting from fundamental definitions of friction velocity and inner scaling, and without invoking any turbulence-model-specific shortcuts from hybrid Reynolds-Averaged Navier–Stokes–Large Eddy Simulation (RANS–LES) methods such as Detached-Eddy Simulation (DES), Delayed Detached-Eddy Simulation (DDES), Improved DDES (IDDES), or Scale-Adaptive Simulation (SAS), do the following:\n\n1. Derive the friction velocity $u_{\\tau}$ from $\\tau_{w}$ and $\\rho$, and compute its numerical value.\n2. Define the inner-scaled wall-normal coordinate $y^{+}$ in terms of $y$, $u_{\\tau}$, and $\\nu$, and compute $y^{+}$ at $y=1\\,\\mathrm{mm}$.\n3. For WMLES, the wall model sampling height is to be set to $h^{+}=100$. Using inner scaling, estimate the required first-cell-center wall-normal spacing $h$ and express it as a physical length.\n\nExpress $u_{\\tau}$ in $\\mathrm{m/s}$, $y^{+}$ as a dimensionless quantity, and $h$ in $\\mathrm{mm}$. Round each numerical result to four significant figures. The final answer must list the three results in the order $(u_{\\tau}, y^{+}, h)$.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on fundamental principles of turbulent boundary layer theory and standard practices in computational fluid dynamics (CFD). All necessary data are provided, and the requested tasks are clear and solvable. Therefore, the problem is deemed valid and a full solution follows.\n\nThe solution is structured into three parts as requested by the problem statement.\n\n**Part 1: Derivation and computation of the friction velocity, $u_{\\tau}$**\n\nThe friction velocity, denoted by $u_{\\tau}$, is a characteristic velocity scale in a turbulent boundary layer. It is defined in terms of the wall shear stress, $\\tau_{w}$, and the fluid density, $\\rho$. The fundamental definition is:\n$$u_{\\tau} \\equiv \\sqrt{\\frac{\\tau_{w}}{\\rho}}$$\nThe problem provides the following values:\n- Wall shear stress, $\\tau_{w} = 0.8\\,\\mathrm{Pa}$.\n- Fluid density, $\\rho = 1.2\\,\\mathrm{kg/m^3}$.\n\nBefore substitution, it is critical to ensure dimensional consistency. The unit Pascal ($\\mathrm{Pa}$) is equivalent to Newtons per square meter ($\\mathrm{N/m^2}$), and a Newton ($\\mathrm{N}$) is a $\\mathrm{kg \\cdot m/s^2}$. Therefore, the units of $\\tau_{w}$ are $\\mathrm{kg/(m \\cdot s^2)}$.\nSubstituting the given numerical values into the definition:\n$$u_{\\tau} = \\sqrt{\\frac{0.8\\,\\mathrm{kg/(m \\cdot s^2)}}{1.2\\,\\mathrm{kg/m^3}}}$$\nThe calculation proceeds as:\n$$u_{\\tau} = \\sqrt{\\frac{0.8}{1.2}\\,\\frac{\\mathrm{kg}}{\\mathrm{m \\cdot s^2}} \\cdot \\frac{\\mathrm{m^3}}{\\mathrm{kg}}} = \\sqrt{\\frac{2}{3}\\,\\frac{\\mathrm{m^2}}{\\mathrm{s^2}}}$$\n$$u_{\\tau} = \\sqrt{0.6666...}\\,\\mathrm{m/s} \\approx 0.81649658\\,\\mathrm{m/s}$$\nRounding the result to four significant figures, we obtain:\n$$u_{\\tau} \\approx 0.8165\\,\\mathrm{m/s}$$\n\n**Part 2: Definition and computation of the inner-scaled wall-normal coordinate, $y^{+}$**\n\nThe inner-scaled (or wall-scaled) wall-normal coordinate, denoted by $y^{+}$, is a dimensionless distance from the wall. It is defined using the inner scales of the boundary layer: the friction velocity, $u_{\\tau}$, and the viscous length scale, $\\nu/u_{\\tau}$. The definition of $y^{+}$ for a physical distance $y$ from the wall is:\n$$y^{+} \\equiv \\frac{y u_{\\tau}}{\\nu}$$\nwhere $\\nu$ is the kinematic viscosity of the fluid. The problem provides:\n- Physical distance from the wall, $y = 1\\,\\mathrm{mm}$.\n- Kinematic viscosity, $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\n- The friction velocity, $u_{\\tau} \\approx 0.81649658\\,\\mathrm{m/s}$, from Part 1.\n\nTo maintain unit consistency, the distance $y$ must be converted from millimeters to meters:\n$$y = 1\\,\\mathrm{mm} = 1 \\times 10^{-3}\\,\\mathrm{m}$$\nSubstituting the values into the definition of $y^{+}$:\n$$y^{+} = \\frac{(1 \\times 10^{-3}\\,\\mathrm{m}) \\cdot (0.81649658\\,\\mathrm{m/s})}{1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}}$$\nThe units cancel out, confirming that $y^{+}$ is a dimensionless quantity:\n$$\\frac{\\mathrm{m} \\cdot (\\mathrm{m/s})}{\\mathrm{m^2/s}} = \\frac{\\mathrm{m^2/s}}{\\mathrm{m^2/s}} = 1$$\nThe numerical calculation is:\n$$y^{+} = \\frac{8.1649658 \\times 10^{-4}}{1.5 \\times 10^{-5}} \\approx 54.433105$$\nRounding the result to four significant figures gives:\n$$y^{+} \\approx 54.43$$\n\n**Part 3: Estimation of the first-cell-center wall-normal spacing, $h$**\n\nFor a wall-modeled Large Eddy Simulation (WMLES), the first computational cell center adjacent to the wall is deliberately placed outside the viscous sublayer, typically in the logarithmic region of the boundary layer. The wall shear stress is then modeled rather than resolved directly. The problem specifies that this first cell center height, which we denote as $h$, must correspond to an inner-scaled value of $h^{+} = 100$.\n\nUsing the same definition as for $y^{+}$, we can write the relationship between the physical height $h$ and the dimensionless height $h^{+}$:\n$$h^{+} = \\frac{h u_{\\tau}}{\\nu}$$\nTo find the required physical spacing $h$, we rearrange this equation:\n$$h = \\frac{h^{+} \\nu}{u_{\\tau}}$$\nThe problem specifies the target dimensionless height:\n- $h^{+} = 100$.\nWe use the given value for $\\nu$ and the calculated value for $u_{\\tau}$:\n- $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\n- $u_{\\tau} \\approx 0.81649658\\,\\mathrm{m/s}$.\n\nSubstituting these values:\n$$h = \\frac{100 \\cdot (1.5 \\times 10^{-5}\\,\\mathrm{m^2/s})}{0.81649658\\,\\mathrm{m/s}}$$\n$$h = \\frac{1.5 \\times 10^{-3}\\,\\mathrm{m^2/s}}{0.81649658\\,\\mathrm{m/s}} \\approx 1.837117 \\times 10^{-3}\\,\\mathrm{m}$$\nThe problem requires the result to be expressed in millimeters ($\\mathrm{mm}$). Since $1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$, we have:\n$$h \\approx 1.837117\\,\\mathrm{mm}$$\nRounding the result to four significant figures yields:\n$$h \\approx 1.837\\,\\mathrm{mm}$$\nThis value represents the required distance of the first grid point from the wall to satisfy the $h^{+} = 100$ criterion for the wall model.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8165  54.43  1.837 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the concept of near-wall scaling, this practice delves into the theoretical underpinnings of an equilibrium wall model. By deriving the governing ordinary differential equation for the mean velocity gradient , you will see firsthand how a simple mixing-length hypothesis provides the crucial link between the shear stress at the wall-model interface and the velocity profile, forming the basis of many practical wall functions.",
            "id": "4005119",
            "problem": "Consider a wall-modeled Large-Eddy Simulation (LES), coupled to a near-wall one-dimensional steady Reynolds-Averaged Navier–Stokes (RANS) closure as is common in hybrid RANS–LES methods such as Detached Eddy Simulation (DES), Delayed Detached Eddy Simulation (DDES), Improved Delayed Detached Eddy Simulation (IDDES), and Scale-Adaptive Simulation (SAS). In the viscous sublayer and logarithmic layer approximation, assume a statistically steady, fully developed, wall-parallel mean flow $U(y)$ in the near-wall region $y \\in [0,h]$, with $y$ the wall-normal coordinate and the wall at $y=0$. Adopt the following modeling ingredients as the fundamental base:\n\n- The one-dimensional steady RANS mean-momentum balance reduces to the constancy of total shear flux: $0 = \\frac{d}{dy} \\left[ (\\nu + \\nu_t) \\frac{dU}{dy} \\right]$, where $\\nu$ is the kinematic viscosity and $\\nu_t$ is the eddy viscosity.\n- The eddy viscosity is modeled using the mixing-length hypothesis with the von Kármán length scale $\\ell_\\kappa = \\kappa y$, so that $\\nu_t = \\ell_\\kappa^{2} \\left| \\frac{dU}{dy} \\right|$ with $\\kappa$ the von Kármán constant.\n- The no-slip boundary condition holds at the wall: $U(0) = 0$.\n- At the coupling height $y=h$, the total shear stress $\\tau(y)=\\rho (\\nu + \\nu_t) \\frac{dU}{dy}$ is matched to the LES-resolved stress, yielding $\\tau(y) = \\tau_h$ (constant for $y \\in [0,h]$), where $\\rho$ is the density and $\\tau_h$ is the interface shear stress supplied by LES.\n\nStarting from the above foundations, derive the explicit first-order ordinary differential equation for the wall-parallel mean velocity $U(y)$ by eliminating $\\nu_t$ and exploiting the constancy of the total shear flux. Specifically, express $\\frac{dU}{dy}$ as a closed-form analytic function of $y$, $\\nu$, $\\kappa$, $\\rho$, and $\\tau_h$. If multiple mathematical branches arise, select the branch consistent with $\\frac{dU}{dy} \\ge 0$ for $y0$. Provide the final result as a single closed-form expression for $\\frac{dU}{dy}$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of a closed-form analytic expression for the mean velocity gradient, $\\frac{dU}{dy}$, in a wall-modeled LES context, based on a set of provided modeling assumptions for the near-wall RANS region. The derivation proceeds by combining the given equations.\n\nThe fundamental premise is the constancy of total shear stress in the near-wall region $y \\in [0,h]$. The total shear stress $\\tau(y)$ is given as the sum of viscous and turbulent stresses. Per the problem statement, this is matched to the LES-resolved stress at the interface, yielding a constant value $\\tau_h$:\n$$ \\tau(y) = \\tau_h $$\nThe definition for total shear stress is provided as:\n$$ \\tau(y) = \\rho (\\nu + \\nu_t) \\frac{dU}{dy} $$\nwhere $\\rho$ is the fluid density, $\\nu$ is the kinematic viscosity, and $\\nu_t$ is the turbulent eddy viscosity. Combining these two equations, we obtain a constant total shear flux:\n$$ \\frac{\\tau_h}{\\rho} = (\\nu + \\nu_t) \\frac{dU}{dy} $$\nThis equation is consistent with the provided mean-momentum balance, $0 = \\frac{d}{dy} \\left[ (\\nu + \\nu_t) \\frac{dU}{dy} \\right]$, which integrates to $(\\nu + \\nu_t) \\frac{dU}{dy} = \\text{constant}$.\n\nNext, we introduce the model for the eddy viscosity, which is based on the mixing-length hypothesis with a von Kármán length scale $\\ell_\\kappa = \\kappa y$:\n$$ \\nu_t = \\ell_\\kappa^2 \\left| \\frac{dU}{dy} \\right| = (\\kappa y)^2 \\left| \\frac{dU}{dy} \\right| $$\nHere, $\\kappa$ is the von Kármán constant and $y$ is the wall-normal coordinate.\n\nThe problem specifies that the physically meaningful solution branch, corresponding to a positive mean velocity gradient for $y0$, must be selected. This implies $\\frac{dU}{dy} \\ge 0$. Therefore, the absolute value can be removed:\n$$ \\left| \\frac{dU}{dy} \\right| = \\frac{dU}{dy} $$\nSubstituting this into the eddy viscosity model gives:\n$$ \\nu_t = (\\kappa y)^2 \\frac{dU}{dy} $$\nNow, we substitute this expression for $\\nu_t$ back into the total shear flux equation:\n$$ \\frac{\\tau_h}{\\rho} = \\left[ \\nu + (\\kappa y)^2 \\frac{dU}{dy} \\right] \\frac{dU}{dy} $$\nTo simplify the notation, let's denote the velocity gradient as $S(y) = \\frac{dU}{dy}$. The equation becomes:\n$$ \\frac{\\tau_h}{\\rho} = \\nu S + (\\kappa y)^2 S^2 $$\nRearranging this into the standard form of a quadratic equation, $aS^2 + bS + c = 0$, we get:\n$$ (\\kappa y)^2 S^2 + \\nu S - \\frac{\\tau_h}{\\rho} = 0 $$\nThis is a quadratic equation for $S = \\frac{dU}{dy}$ with coefficients:\n- $a = (\\kappa y)^2$\n- $b = \\nu$\n- $c = -\\frac{\\tau_h}{\\rho}$\n\nWe can solve for $S$ using the quadratic formula, $S = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$ S(y) = \\frac{-\\nu \\pm \\sqrt{\\nu^2 - 4((\\kappa y)^2)\\left(-\\frac{\\tau_h}{\\rho}\\right)}}{2(\\kappa y)^2} $$\nSimplifying the term under the square root:\n$$ S(y) = \\frac{-\\nu \\pm \\sqrt{\\nu^2 + 4\\kappa^2 y^2 \\frac{\\tau_h}{\\rho}}}{2\\kappa^2 y^2} $$\nThe problem requires us to select the mathematical branch that ensures $\\frac{dU}{dy} \\ge 0$, which means $S(y) \\ge 0$. Let's analyze the two possible solutions from the $\\pm$ sign.\nThe physical parameters $\\nu$, $\\kappa$, $\\rho$, and $\\tau_h$ are all positive, and $y^2  0$ for $y  0$. Consequently, the term $4\\kappa^2 y^2 \\frac{\\tau_h}{\\rho}$ is positive. This means:\n$$ \\sqrt{\\nu^2 + 4\\kappa^2 y^2 \\frac{\\tau_h}{\\rho}}  \\sqrt{\\nu^2} = \\nu $$\n1. If we choose the negative sign (`-`), the numerator becomes $-\\nu - \\sqrt{\\dots}$, which is strictly negative. Since the denominator $2\\kappa^2 y^2$ is positive, the resulting $S(y)$ would be negative. This contradicts the physical requirement $S(y) \\ge 0$.\n2. If we choose the positive sign (`+`), the numerator is $-\\nu + \\sqrt{\\dots}$. Since $\\sqrt{\\dots}  \\nu$, the numerator is strictly positive. The denominator is also positive, so the resulting $S(y)$ is positive. This is the physically correct branch.\n\nTherefore, the only valid solution for the mean velocity gradient $\\frac{dU}{dy}$ is:\n$$ \\frac{dU}{dy} = \\frac{-\\nu + \\sqrt{\\nu^2 + 4\\kappa^2 y^2 \\frac{\\tau_h}{\\rho}}}{2\\kappa^2 y^2} $$\nThis expression represents the explicit first-order ordinary differential equation for the mean velocity $U(y)$ and is the final closed-form result sought by the problem.",
            "answer": "$$\n\\boxed{\\frac{-\\nu + \\sqrt{\\nu^2 + \\frac{4 \\kappa^2 y^2 \\tau_h}{\\rho}}}{2 \\kappa^2 y^2}}\n$$"
        },
        {
            "introduction": "This final practice transitions from the physics of the wall layer to the core mechanism of the hybrid RANS-LES method itself. The Detached Eddy Simulation (DES) approach hinges on a specially designed length scale that switches the model from RANS to LES mode; this exercise  offers a practical, code-level challenge to implement this length scale, test its fundamental properties, and appreciate the critical role of grid quality in hybrid simulations.",
            "id": "4005152",
            "problem": "You are implementing a Detached Eddy Simulation (DES) length scale for a finite-volume solver to be used in wall-modeled Large Eddy Simulation (LES) and hybrid Reynolds-Averaged Navier–Stokes (RANS)–LES methods, including Delayed Detached Eddy Simulation (DDES), Improved DDES (IDDES), and Scale-Adaptive Simulation (SAS), within computational thermal engineering. Starting from fundamental and widely accepted principles, you must derive and implement a procedure to compute a local filter width from cell metrics and then construct the DES length scale used to limit the turbulence length scale away from the wall. You must also demonstrate unit consistency and smoothness of the grid-filter width definition across neighboring cells and interfaces.\n\nFundamental base:\n- The finite-volume method represents the domain as a collection of control volumes (cells) with local dimensions $dx$, $dy$, $dz$ in meters and wall-normal distance $d_w$ in meters.\n- In near-wall RANS, the mixing length model provides a turbulence length scale $l_{\\mathrm{RANS}} = \\kappa\\,d_w$ where $\\kappa$ is the von Kármán constant with $\\kappa = 0.41$.\n- In DES, a hybrid length scale is introduced to switch between RANS near the wall and LES away from the wall using the DES limiter $l_{\\mathrm{DES}} = \\min\\left(l_{\\mathrm{RANS}},\\,C_{\\mathrm{DES}}\\,\\Delta\\right)$, where $C_{\\mathrm{DES}}$ is a model constant with $C_{\\mathrm{DES}} = 0.65$ and $\\Delta$ is a local grid-filter width computed from cell metrics.\n\nGrid-filter width definitions to implement and compare:\n- Volume-based definition: $\\Delta_{\\mathrm{vol}} = \\left(dx\\,dy\\,dz\\right)^{1/3}$.\n- Maximum-edge definition: $\\Delta_{\\max} = \\max\\left(dx,dy,dz\\right)$.\n\nFor smoothness assessment, define a measure across adjacent cells $(i,j)$ by\n$$\nS_{ij} = \\frac{\\left|\\Delta_i - \\Delta_j\\right|}{\\max\\left(\\Delta_i,\\Delta_j\\right)},\n$$\nand evaluate the maximum jump $S_{\\max}$ across all specified adjacency pairs.\n\nFor unit consistency assessment, consider a scale factor $s0$ and verify that scaling all lengths by $s$ yields $l_{\\mathrm{DES}}^{(s)} = s\\,l_{\\mathrm{DES}}$ for all cells. Numerically, check the ratios $l_{\\mathrm{DES},i}^{(s)} / l_{\\mathrm{DES},i}$ equal $s$ within a tight tolerance.\n\nImplement the following steps:\n1. For each cell, compute the local grid-filter width $\\Delta$ using the specified definition.\n2. Compute $l_{\\mathrm{RANS}} = \\kappa\\,d_w$ for each cell and $l_{\\mathrm{DES}} = \\min\\left(l_{\\mathrm{RANS}},\\,C_{\\mathrm{DES}}\\,\\Delta\\right)$.\n3. For smoothness, compute $S_{\\max}$ for the given adjacency pairs using the chosen $\\Delta$.\n4. For unit consistency, compute $l_{\\mathrm{DES}}$ for the original metrics and for metrics scaled by factor $s$ and verify that all ratios $l_{\\mathrm{DES}}^{(s)} / l_{\\mathrm{DES}}$ equal $s$ within an absolute tolerance of $10^{-12}$.\n\nAll lengths are in meters. All outputs involving floats must be expressed in meters where applicable. Angles do not appear. Your program must produce the results for the following test suite.\n\nTest Suite:\n- Test Case 1 (uniform isotropic grid, volume filter):\n  - Cells: $N=5$ with $(dx,dy,dz) = (1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})$ meters for all cells.\n  - Wall distances $d_w$ in meters: $\\left[1.0\\times 10^{-5},\\,5.0\\times 10^{-5},\\,1.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,1.0\\times 10^{-3}\\right]$.\n  - Adjacency pairs: sequential neighbors $(0,1),(1,2),(2,3),(3,4)$.\n  - Filter: $\\Delta = \\Delta_{\\mathrm{vol}}$.\n  - Smoothness threshold: $T=0.05$; smoothness is acceptable if $S_{\\max} \\le T$.\n  - Unit scaling factor: $s=10$.\n- Test Case 2 (gradually stretched grid in one direction, maximum-edge filter):\n  - Cells: $N=6$ with $(dx,dy,dz)$ in meters\n    $\\left[(5.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4}),\\,(6.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4}),\\,(7.2\\times 10^{-4},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4}),\\,(8.64\\times 10^{-4},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4}),\\,(1.0368\\times 10^{-3},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4}),\\,(1.24416\\times 10^{-3},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4})\\right]$.\n  - Wall distances $d_w$ in meters: all equal to $1.0\\times 10^{-2}$.\n  - Adjacency pairs: sequential neighbors $(0,1),(1,2),(2,3),(3,4),(4,5)$.\n  - Filter: $\\Delta = \\Delta_{\\max}$.\n  - Smoothness threshold: $T=0.2$.\n  - Unit scaling factor: $s=3$.\n- Test Case 3 (abrupt interface between fine and coarse regions, maximum-edge filter):\n  - Cells: $N=6$ with $(dx,dy,dz)$ in meters\n    $\\left[(2.5\\times 10^{-4},\\,2.5\\times 10^{-4},\\,2.5\\times 10^{-4}),\\,(2.5\\times 10^{-4},\\,2.5\\times 10^{-4},\\,2.5\\times 10^{-4}),\\,(2.5\\times 10^{-4},\\,2.5\\times 10^{-4},\\,2.5\\times 10^{-4}),\\,(1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3}),\\,(1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3}),\\,(1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})\\right]$.\n  - Wall distances $d_w$ in meters: all equal to $5.0\\times 10^{-3}$.\n  - Adjacency pairs: sequential neighbors $(0,1),(1,2),(2,3),(3,4),(4,5)$.\n  - Filter: $\\Delta = \\Delta_{\\max}$.\n  - Smoothness threshold: $T=0.2$.\n  - Unit scaling factor: $s=5$.\n\nProgram requirements:\n- Use constants $\\kappa = 0.41$ and $C_{\\mathrm{DES}} = 0.65$.\n- Compute $S_{\\max}$ and compare to the threshold $T$ to return a smoothness boolean for each test case.\n- Verify unit consistency by confirming that all ratios $l_{\\mathrm{DES}}^{(s)} / l_{\\mathrm{DES}}$ equal $s$ within absolute tolerance $10^{-12}$ to return a unit-consistency boolean for each test case.\n- For each test case, produce a list of three results: $[\\text{unit\\_consistent},\\,\\text{smoothness\\_ok},\\,S_{\\max}]$, where $S_{\\max}$ is a float rounded to six decimal places (dimensionless).\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a bracketed comma-separated list, for example, \"[[True,True,0.000000],[True,False,0.750000],[True,True,0.166667]]\".",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a standard, albeit simplified, task in the implementation of hybrid Reynolds-Averaged Navier-Stokes (RANS) and Large Eddy Simulation (LES) turbulence models, specifically focusing on the construction of the Detached Eddy Simulation (DES) length scale. All parameters, constants, and procedures are clearly defined and consistent with established principles in computational fluid dynamics.\n\nThe core of the problem is the formulation of a hybrid turbulence length scale, $l_{\\mathrm{DES}}$, which is fundamental to DES-type methods. These methods aim to combine the strengths of RANS for modeling near-wall boundary layers efficiently and LES for resolving large-scale turbulent structures in separated flow regions. The switch between these two modes is governed by the $l_{\\mathrm{DES}}$ definition.\n\nThe RANS turbulence length scale, $l_{\\mathrm{RANS}}$, is based on the mixing length model, which is appropriate for the near-wall region. It is defined as\n$$l_{\\mathrm{RANS}} = \\kappa\\,d_w$$\nwhere $\\kappa$ is the von Kármán constant, a dimensionless parameter with value $\\kappa=0.41$, and $d_w$ is the normal distance from the cell center to the nearest wall. This formulation is rooted in the law of the wall for turbulent boundary layers.\n\nThe LES length scale is related to the grid resolution, as LES resolves turbulent eddies larger than the grid filter width, $\\Delta$, and models the smaller ones. For DES, the effective LES length scale is defined as\n$$l_{\\mathrm{LES}} = C_{\\mathrm{DES}}\\,\\Delta$$\nwhere $C_{\\mathrm{DES}}$ is an empirical model constant, given as $C_{\\mathrm{DES}}=0.65$, and $\\Delta$ is the characteristic size of the finite-volume cell.\n\nThe DES methodology combines these two length scales using a minimization function to create a hybrid scale:\n$$l_{\\mathrm{DES}} = \\min\\left(l_{\\mathrm{RANS}},\\,C_{\\mathrm{DES}}\\,\\Delta\\right) = \\min\\left(\\kappa\\,d_w,\\,C_{\\mathrm{DES}}\\,\\Delta\\right)$$\nThis formulation acts as a switch. Near a wall, $d_w$ is small, typically ensuring that $\\kappa\\,d_w  C_{\\mathrm{DES}}\\,\\Delta$. This selects the RANS length scale, and the model behaves like a RANS model. Far from the wall, $d_w$ becomes large, and the LES length scale, $C_{\\mathrm{DES}}\\,\\Delta$, is selected, activating the LES mode of the simulation.\n\nThe problem requires the implementation and comparison of two common definitions for the filter width $\\Delta$ based on the cell dimensions $dx$, $dy$, and $dz$:\n1.  The volume-based definition: $\\Delta_{\\mathrm{vol}} = \\left(dx\\,dy\\,dz\\right)^{1/3}$. This is a geometric mean of the cell dimensions and is well-suited for isotropic or near-isotropic cells.\n2.  The maximum-edge definition: $\\Delta_{\\max} = \\max\\left(dx,dy,dz\\right)$. This definition is more conservative, as it is determined by the largest dimension of the cell. It is frequently used in practice, especially for anisotropic grids common in boundary layers, where one dimension is much smaller than the others.\n\nTwo critical properties of the numerical implementation are assessed: unit consistency and grid smoothness.\n\nUnit consistency is a fundamental requirement of any physically meaningful model. It ensures that the model's behavior is independent of the system of units used. If all fundamental length quantities ($dx, dy, dz, d_w$) are scaled by a factor $s  0$, any derived quantity with the dimension of length must also scale by the same factor $s$. We can analytically verify this for $l_{\\mathrm{DES}}$. Let primed quantities denote scaled lengths.\n$$dx' = s\\,dx, \\quad dy' = s\\,dy, \\quad dz' = s\\,dz, \\quad d_w' = s\\,d_w$$\nThe RANS length scale scales as:\n$$l'_{\\mathrm{RANS}} = \\kappa\\,d_w' = \\kappa(s\\,d_w) = s(\\kappa\\,d_w) = s\\,l_{\\mathrm{RANS}}$$\nThe grid filter widths scale as:\n$$\\Delta'_{\\mathrm{vol}} = \\left(dx'\\,dy'\\,dz'\\right)^{1/3} = \\left((s\\,dx)(s\\,dy)(s\\,dz)\\right)^{1/3} = \\left(s^3\\,dx\\,dy\\,dz\\right)^{1/3} = s\\,\\left(dx\\,dy\\,dz\\right)^{1/3} = s\\,\\Delta_{\\mathrm{vol}}$$\n$$\\Delta'_{\\max} = \\max(dx', dy', dz') = \\max(s\\,dx, s\\,dy, s\\,dz) = s\\,\\max(dx, dy, dz) = s\\,\\Delta_{\\max}$$\nSince both arguments of the $\\min$ function for $l_{\\mathrm{DES}}$ scale linearly with $s$, the result itself must also scale linearly:\n$$l'_{\\mathrm{DES}} = \\min(l'_{\\mathrm{RANS}}, C_{\\mathrm{DES}}\\,\\Delta') = \\min(s\\,l_{\\mathrm{RANS}}, C_{\\mathrm{DES}}\\,s\\,\\Delta) = s\\,\\min(l_{\\mathrm{RANS}}, C_{\\mathrm{DES}}\\,\\Delta) = s\\,l_{\\mathrm{DES}}$$\nThe analytical derivation confirms unit consistency. The numerical task is to verify that the implementation respects this property within a given tolerance.\n\nGrid smoothness is crucial for the stability and accuracy of the numerical simulation. Abrupt changes in the grid filter width $\\Delta$ between adjacent cells can introduce spurious source terms in the turbulence model, potentially triggering a premature and unphysical switch from RANS to LES, a phenomenon known as \"grid-induced separation.\" The smoothness metric $S_{ij}$ quantifies the relative jump in $\\Delta$ between adjacent cells $i$ and $j$:\n$$S_{ij} = \\frac{\\left|\\Delta_i - \\Delta_j\\right|}{\\max\\left(\\Delta_i,\\Delta_j\\right)}$$\nA value of $S_{ij}$ close to $0$ indicates a smooth transition, whereas a value close to $1$ signifies a large, abrupt change in cell size. The maximum jump over the domain, $S_{\\max}$, is a key indicator of grid quality for DES-type simulations.\n\nThe solution will now proceed by implementing these calculations for the three specified test cases. Each case provides a different grid configuration to test the behavior of the filter definitions and the resulting DES length scale under various conditions: a uniform isotropic grid, a gradually stretched grid, and a grid with an abrupt refinement interface. For each case, we will compute $l_{\\mathrm{DES}}$, evaluate unit consistency, and assess grid smoothness by calculating $S_{\\max}$ and comparing it to the specified threshold $T$.\n```python\nimport numpy as np\n\ndef compute_des_analysis(cell_dims, d_w, adj_pairs, filter_type, T, s_factor):\n    \"\"\"\n    Computes the DES length scale, checks unit consistency, and assesses grid smoothness.\n\n    Args:\n        cell_dims (np.ndarray): Array of cell dimensions (dx, dy, dz) for N cells, shape (N, 3).\n        d_w (np.ndarray): Array of wall distances for N cells, shape (N,).\n        adj_pairs (list of tuples): List of (i, j) indices for adjacent cells.\n        filter_type (str): Type of filter width calculation ('vol' or 'max').\n        T (float): Smoothness threshold.\n        s_factor (float): Unit scaling factor.\n\n    Returns:\n        list: [unit_consistent (bool), smoothness_ok (bool), S_max (float)]\n    \"\"\"\n    KAPPA = 0.41\n    C_DES = 0.65\n    TOLERANCE = 1e-12\n\n    # 1. Compute local grid-filter width Delta\n    if filter_type == 'vol':\n        volumes = np.prod(cell_dims, axis=1)\n        deltas = np.cbrt(volumes)\n    elif filter_type == 'max':\n        deltas = np.max(cell_dims, axis=1)\n    else:\n        raise ValueError(\"Invalid filter_type. Must be 'vol' or 'max'.\")\n\n    # 2. Compute RANS and DES length scales\n    l_rans = KAPPA * d_w\n    l_les_component = C_DES * deltas\n    l_des = np.minimum(l_rans, l_les_component)\n\n    # 3. Compute smoothness metric S_max\n    if not adj_pairs:\n        s_max = 0.0\n    else:\n        s_jumps = []\n        for i, j in adj_pairs:\n            delta_i = deltas[i]\n            delta_j = deltas[j]\n            # Avoid division by zero if deltas are zero (though not in test cases)\n            max_delta = np.maximum(delta_i, delta_j)\n            if max_delta > 0:\n                s_ij = np.abs(delta_i - delta_j) / max_delta\n                s_jumps.append(s_ij)\n        s_max = np.max(s_jumps) if s_jumps else 0.0\n    \n    smoothness_ok = s_max = T\n\n    # 4. Verify unit consistency\n    # Scale all length-based inputs\n    scaled_cell_dims = cell_dims * s_factor\n    scaled_d_w = d_w * s_factor\n    \n    # Recalculate Delta with scaled dimensions\n    if filter_type == 'vol':\n        scaled_volumes = np.prod(scaled_cell_dims, axis=1)\n        scaled_deltas = np.cbrt(scaled_volumes)\n    else: # 'max'\n        scaled_deltas = np.max(scaled_cell_dims, axis=1)\n\n    # Recalculate l_des with scaled values\n    scaled_l_rans = KAPPA * scaled_d_w\n    scaled_l_les_component = C_DES * scaled_deltas\n    scaled_l_des = np.minimum(scaled_l_rans, scaled_l_les_component)\n\n    # Check the ratio, handling potential division by zero for l_des=0\n    # In such a case, scaled_l_des would also be 0, and ratio is ill-defined but consistency holds.\n    # We check where l_des > 0.\n    is_consistent = True\n    valid_indices = l_des > 0\n    if np.any(valid_indices):\n        ratios = scaled_l_des[valid_indices] / l_des[valid_indices]\n        if not np.all(np.abs(ratios - s_factor) = TOLERANCE):\n            is_consistent = False\n    \n    # Check if cases where l_des=0 also have scaled_l_des=0\n    if np.any(scaled_l_des[~valid_indices] != 0):\n        is_consistent = False\n\n    return [is_consistent, smoothness_ok, s_max]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"Test Case 1\",\n            \"cell_dims\": np.array([[1.0e-3, 1.0e-3, 1.0e-3]] * 5),\n            \"d_w\": np.array([1.0e-5, 5.0e-5, 1.0e-4, 5.0e-4, 1.0e-3]),\n            \"adj_pairs\": [(0, 1), (1, 2), (2, 3), (3, 4)],\n            \"filter_type\": 'vol',\n            \"T\": 0.05,\n            \"s_factor\": 10.0\n        },\n        {\n            \"name\": \"Test Case 2\",\n            \"cell_dims\": np.array([\n                [5.0e-4, 5.0e-4, 5.0e-4],\n                [6.0e-4, 5.0e-4, 5.0e-4],\n                [7.2e-4, 5.0e-4, 5.0e-4],\n                [8.64e-4, 5.0e-4, 5.0e-4],\n                [1.0368e-3, 5.0e-4, 5.0e-4],\n                [1.24416e-3, 5.0e-4, 5.0e-4]\n            ]),\n            \"d_w\": np.array([1.0e-2] * 6),\n            \"adj_pairs\": [(0, 1), (1, 2), (2, 3), (3, 4), (4, 5)],\n            \"filter_type\": 'max',\n            \"T\": 0.2,\n            \"s_factor\": 3.0\n        },\n        {\n            \"name\": \"Test Case 3\",\n            \"cell_dims\": np.array([\n                [2.5e-4, 2.5e-4, 2.5e-4],\n                [2.5e-4, 2.5e-4, 2.5e-4],\n                [2.5e-4, 2.5e-4, 2.5e-4],\n                [1.0e-3, 1.0e-3, 1.0e-3],\n                [1.0e-3, 1.0e-3, 1.0e-3],\n                [1.0e-3, 1.0e-3, 1.0e-3]\n            ]),\n            \"d_w\": np.array([5.0e-3] * 6),\n            \"adj_pairs\": [(0, 1), (1, 2), (2, 3), (3, 4), (4, 5)],\n            \"filter_type\": 'max',\n            \"T\": 0.2,\n            \"s_factor\": 5.0\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result_list = compute_des_analysis(\n            case[\"cell_dims\"],\n            case[\"d_w\"],\n            case[\"adj_pairs\"],\n            case[\"filter_type\"],\n            case[\"T\"],\n            case[\"s_factor\"]\n        )\n        all_results.append(result_list)\n\n    # Format the final output string\n    result_strings = []\n    for res in all_results:\n        unit_consistent, smoothness_ok, s_max = res\n        s_max_str = f\"{s_max:.6f}\"\n        result_strings.append(f\"[{str(unit_consistent)},{str(smoothness_ok)},{s_max_str}]\")\n\n    print(f\"[{','.join(result_strings)}]\")\n\n# This function call is for conceptual execution; the output is pre-calculated and placed in the answer tag.\n# solve()\n```",
            "answer": "[[True, True, 0.000000],[True, True, 0.166667],[True, False, 0.750000]]"
        }
    ]
}