{
    "hands_on_practices": [
        {
            "introduction": "要理解大涡模拟，我们必须首先掌握空间滤波的数学本质。本练习提供了一个基础性的解析练习，以揭示这一核心概念。通过将一个简单的“礼帽”滤波器应用于单个傅立叶模态，您将推导出其传递函数，并精确地看到滤波器如何分离尺度，为理解更复杂的亚格子模型奠定基础。",
            "id": "3338942",
            "problem": "在大涡模拟（LES）中，空间滤波通过场与滤波核的卷积来定义。考虑一个一维空间均匀滤波器，其滤波核 $G(x;\\Delta)$ 的紧支集宽度为 $\\Delta$。滤波后的场 $\\bar{\\phi}(x)$ 通过卷积定义为 $\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr$。取箱式核（top-hat kernel）$G(x;\\Delta) = \\Delta^{-1}\\,\\mathbb{1}_{|x| < \\Delta/2}$ 和标量场 $\\phi(x) = \\sin(k x)$，其中 $k$ 是一个实波数。仅从卷积的定义和基本三角恒等式出发，推导 $\\bar{\\phi}(x)$ 作为 $k$、$\\Delta$ 和 $x$ 的函数的封闭形式表达式。然后，将有效谱截止波数 $k_c$ 定义为使滤波器一维传递函数幅值消失的最小正波数 $k$，并给出相应的无量纲乘积 $k_c \\Delta$ 的表达式。将您的最终答案以单行向量的形式给出，其第一个条目是 $\\bar{\\phi}(x)$ 的精确表达式，第二个条目是 $k_c \\Delta$ 的精确值。最终答案无需四舍五入，也不应包含单位。",
            "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- **空间滤波的定义：** 滤波后的场 $\\bar{\\phi}(x)$ 是场 $\\phi(x)$ 与滤波核 $G(x;\\Delta)$ 的卷积：$\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr$。\n- **滤波核：** 一维箱式滤波核，$G(x;\\Delta) = \\Delta^{-1}\\,\\mathbb{1}_{|x| < \\Delta/2}$，其中 $\\mathbb{1}$ 是指示函数，$\\Delta$ 是滤波器宽度。\n- **标量场：** 单一波数的正弦场，$\\phi(x) = \\sin(k x)$，其中 $k$ 是一个实波数。\n- **截止波数的定义：** 有效谱截止波数 $k_c$ 是使滤波器一维传递函数幅值消失的最小正波数 $k$。\n- **任务：** 推导 $\\bar{\\phi}(x)$ 的封闭形式表达式，并求出无量纲乘积 $k_c \\Delta$ 的值。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学基础：** 该问题是大涡模拟（LES）数学基础中的一个标准练习，而LES是计算流体力学的一个主要课题。卷积、滤波核和传递函数的概念是信号处理和湍流理论中的基本原理。\n- **适定性：** 所有必要的函数（$G$, $\\phi$）、定义（卷积, $k_c$）和约束都已提供。该问题是自洽的，其结构可以得出一个唯一的解。\n- **客观性：** 语言正式且精确，没有主观或模糊的陈述。\n- **未检测到其他缺陷：** 该问题并非不健全、不完整、自相矛盾、不切实际或不适定。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n第一步是通过计算卷积积分来推导滤波后场 $\\bar{\\phi}(x)$ 的表达式。\n滤波后场的定义为：\n$$\n\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr\n$$\n代入给定的滤波核 $G(r;\\Delta)$ 和标量场 $\\phi(x)$ 的表达式：\n$$\n\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} \\left(\\frac{1}{\\Delta}\\,\\mathbb{1}_{|r| < \\Delta/2}\\right) \\sin(k(x-r))\\,dr\n$$\n指示函数 $\\mathbb{1}_{|r| < \\Delta/2}$ 在 $-\\Delta/2 < r < \\Delta/2$ 时等于 $1$，在其他情况下等于 $0$。此性质限制了积分的上下限：\n$$\n\\bar{\\phi}(x) = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\sin(k(x-r))\\,dr\n$$\n为计算此积分，我们使用差角正弦的三角恒等式：$\\sin(A-B) = \\sin(A)\\cos(B) - \\cos(A)\\sin(B)$。令 $A = kx$，$B = kr$。\n$$\n\\sin(k(x-r)) = \\sin(kx)\\cos(kr) - \\cos(kx)\\sin(kr)\n$$\n将其代入积分中：\n$$\n\\bar{\\phi}(x) = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\left[ \\sin(kx)\\cos(kr) - \\cos(kx)\\sin(kr) \\right]\\,dr\n$$\n由于 $\\sin(kx)$ 和 $\\cos(kx)$ 不依赖于积分变量 $r$，它们可以从积分中提取出来：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(kx)}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\cos(kr)\\,dr - \\frac{\\cos(kx)}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\sin(kr)\\,dr\n$$\n我们现在分别计算这两个积分。\n第一个积分涉及在一个对称区间上对偶函数 $\\cos(kr)$ 进行积分：\n$$\n\\int_{-\\Delta/2}^{\\Delta/2} \\cos(kr)\\,dr = \\left[ \\frac{\\sin(kr)}{k} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{\\sin(k\\Delta/2)}{k} - \\frac{\\sin(-k\\Delta/2)}{k}\n$$\n由于 $\\sin(-z) = -\\sin(z)$，这可以简化为：\n$$\n\\frac{\\sin(k\\Delta/2)}{k} + \\frac{\\sin(k\\Delta/2)}{k} = \\frac{2}{k} \\sin\\left(\\frac{k\\Delta}{2}\\right)\n$$\n第二个积分涉及在一个对称区间上对奇函数 $\\sin(kr)$ 进行积分。这样的积分总是为零。我们可以明确地验证这一点：\n$$\n\\int_{-\\Delta/2}^{\\Delta/2} \\sin(kr)\\,dr = \\left[ -\\frac{\\cos(kr)}{k} \\right]_{-\\Delta/2}^{\\Delta/2} = -\\frac{\\cos(k\\Delta/2)}{k} - \\left(-\\frac{\\cos(-k\\Delta/2)}{k}\\right)\n$$\n由于 $\\cos(-z) = \\cos(z)$，这可以简化为：\n$$\n-\\frac{\\cos(k\\Delta/2)}{k} + \\frac{\\cos(k\\Delta/2)}{k} = 0\n$$\n将这些结果代回 $\\bar{\\phi}(x)$ 的表达式中：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(kx)}{\\Delta} \\left( \\frac{2}{k} \\sin\\left(\\frac{k\\Delta}{2}\\right) \\right) - \\frac{\\cos(kx)}{\\Delta} (0)\n$$\n$$\n\\bar{\\phi}(x) = \\frac{2}{k\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) \\sin(kx)\n$$\n这个表达式可以方便地重写以突出滤波器的传递函数。通过重新排列各项，我们得到了所需答案的第一部分：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(k\\Delta/2)}{k\\Delta/2} \\sin(kx)\n$$\n\n第二步是确定无量纲乘积 $k_c \\Delta$。\n将滤波器应用于单个傅里叶模式 $\\exp(ikx)$ 会导致该模式乘以滤波器的传递函数 $\\hat{G}(k)$。对于像 $\\phi(x) = \\sin(kx)$ 这样的实值场，假设核 $G(x)$ 是实偶函数（这对于箱式核是成立的），则滤波后的场为 $\\bar{\\phi}(x) = \\hat{G}(k)\\phi(x)$。\n通过将我们推导出的 $\\bar{\\phi}(x)$ 表达式与形式 $\\hat{G}(k)\\phi(x) = \\hat{G}(k)\\sin(kx)$ 进行比较，我们可以确定传递函数：\n$$\n\\hat{G}(k) = \\frac{\\sin(k\\Delta/2)}{k\\Delta/2}\n$$\n这是归一化的sinc函数，$\\text{sinc}(k\\Delta/2)$。\n根据问题的定义，$k_c$ 是使传递函数幅值 $|\\hat{G}(k)|$ 为零的最小正波数 $k$。由于 $\\hat{G}(k)$ 是实数，这等价于找到使 $\\hat{G}(k) = 0$ 的最小正波数 $k$。\n$$\n\\frac{\\sin(k_c\\Delta/2)}{k_c\\Delta/2} = 0\n$$\n要使此表达式为零，分子必须为零，而分母不为零（我们寻求正波数，故排除 $k_c=0$ 的情况，并且在极限 $k\\to 0$ 时，$\\hat{G}(k) \\to 1$）。\n因此，条件是：\n$$\n\\sin\\left(\\frac{k_c\\Delta}{2}\\right) = 0\n$$\n$\\sin(\\theta) = 0$ 的通解是 $\\theta = n\\pi$，其中 $n$ 为任意整数。因此：\n$$\n\\frac{k_c\\Delta}{2} = n\\pi, \\quad n \\in \\mathbb{Z}\n$$\n我们寻求最小的正波数 $k_c$。由于滤波器宽度 $\\Delta$ 是正的，我们必须有 $n > 0$。最小的正整数是 $n=1$。\n$$\n\\frac{k_c\\Delta}{2} = \\pi\n$$\n求解无量纲乘积 $k_c \\Delta$ 得到所需答案的第二部分：\n$$\nk_c \\Delta = 2\\pi\n$$\n其物理解释是，箱式滤波器完全移除了波长 $\\lambda = 2\\pi/k_c$ 等于滤波器宽度 $\\Delta$ 的波，即 $\\lambda_c = \\Delta$。\n\n最终答案由 $\\bar{\\phi}(x)$ 的表达式和 $k_c \\Delta$ 的值组成。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sin(k\\Delta/2)}{k\\Delta/2} \\sin(kx) & 2\\pi \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在密度可变的流动中，例如燃烧或多相流系统，标准的滤波方法会引入显著误差。这个动手编程练习展示了简单的雷诺滤波与密度加权的法夫瑞滤波之间的关键区别。通过数值实现这两种方法，您将量化法夫瑞滤波的优势，并深入理解为何它是模拟可压缩或变密度湍流的标准选择。",
            "id": "3967139",
            "problem": "给定一个长度为 $L$ (单位: $\\mathrm{m}$) 的一维周期性域，一个在位置 $x_0$ 附近具有陡峭梯度的给定非均匀密度场 $\\rho(x)$ (单位: $\\mathrm{kg\\,m^{-3}}$)，以及一个速度场 $u(x)$ (单位: $\\mathrm{m\\,s^{-1}}$)。考虑使用标准差为 $\\sigma$ (单位: $\\mathrm{m}$) 的高斯核进行空间滤波，该滤波在周期性边界条件下应用。令简单滤波表示通过与高斯核卷积实现的空间平均 $\\overline{\\cdot}$，令 Favre 滤波表示由 $\\tilde{\\phi}(x) = \\overline{\\rho \\phi}(x)/\\overline{\\rho}(x)$ 定义的密度加权平均。一维空间中的对流性动量通量是场 $\\rho(x)\\,u(x)^2$ (单位: $\\mathrm{Pa}$)。\n\n从可压缩流的对流性动量通量、空间滤波和 Favre 滤波的定义出发，实现一个程序，该程序可以：\n- 计算精确的滤波后通量 $\\overline{\\rho u^2}(x)$ (单位: $\\mathrm{Pa}$)。\n- 计算通量的简单滤波近似 $\\overline{\\rho}(x)\\,\\overline{u}(x)^2$ (单位: $\\mathrm{Pa}$)。\n- 计算通量的 Favre 滤波近似 $\\overline{\\rho}(x)\\,\\tilde{u}(x)^2$ (单位: $\\mathrm{Pa}$)，其中 $\\tilde{u}(x) = \\overline{\\rho u}(x)/\\overline{\\rho}(x)$。\n- 计算对流性动量通量的简单近似与 Favre 近似之间的差异，逐点定义为 $\\Delta(x) = \\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho}(x)\\,\\tilde{u}(x)^2$ (单位: $\\mathrm{Pa}$)。\n- 将 Favre 滤波相对于精确滤波通量所避免的伪项量化为绝对误差的逐点减少量 $E_{\\mathrm{avoid}}(x) = \\left|\\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho u^2}(x)\\right| - \\left|\\overline{\\rho}(x)\\,\\tilde{u}(x)^2 - \\overline{\\rho u^2}(x)\\right|$ (单位: $\\mathrm{Pa}$)。\n- 报告在整个域上的空间平均值 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$，单位均为 $\\mathrm{Pa}$。\n\n使用以下基本依据：\n- 可压缩动量方程的对流性通量张量在一维情况下简化为标量场 $\\rho u^2$ (单位: $\\mathrm{Pa}$)。\n- 空间滤波是与一个归一化高斯核 $G(x) = \\exp\\!\\left(-x^2/(2\\sigma^2)\\right)$ 的线性卷积操作，在整个域上周期性地解释。\n- Favre 滤波定义为 $\\tilde{\\phi} = \\overline{\\rho \\phi}/\\overline{\\rho}$。\n\n所有滤波必须通过离散傅里叶变换，在周期性边界条件下，使用波数空间中的高斯传递函数进行数值计算。\n\n物理和数值规格：\n- 域：具有周期性边界条件和 $N$ 个均匀间隔点的域 $x \\in [0,L)$。\n- 密度：$\\rho(x) = \\rho_1 + (\\rho_2 - \\rho_1)\\,s(x)$，其中 $s(x) = \\dfrac{1}{2}\\left[1 + \\tanh\\!\\left(\\dfrac{x - x_0}{\\epsilon}\\right)\\right]$，$\\rho_1$ 和 $\\rho_2$ 的单位为 $\\mathrm{kg\\,m^{-3}}$，$x_0$ 和 $\\epsilon$ 的单位为 $\\mathrm{m}$。\n- 速度：$u(x) = U_0 + U_1 \\sin\\!\\left(\\dfrac{2\\pi x}{L}\\right) + U_2 \\exp\\!\\left(-\\left(\\dfrac{x - x_0}{\\epsilon}\\right)^2\\right)$，其中 $U_0$、$U_1$ 和 $U_2$ 的单位为 $\\mathrm{m\\,s^{-1}}$。\n- 高斯滤波器：标准差为 $\\sigma$ (单位: $\\mathrm{m}$)，波数空间中的传递函数为 $H(k) = \\exp\\!\\left(-\\dfrac{1}{2}\\sigma^2 k^2\\right)$，其中 $k$ 表示周期性波数。\n\n单位：\n- 所有输出必须以 $\\mathrm{Pa}$ 为单位报告。\n\n测试套件：\n提供三个具有科学真实参数的测试用例，以评估不同方面：\n1. 案例 A (一般陡峭梯度，中等滤波器)：$L = 1\\,\\mathrm{m}$，$N = 4096$，$\\rho_1 = 1.0\\,\\mathrm{kg\\,m^{-3}}$，$\\rho_2 = 5.0\\,\\mathrm{kg\\,m^{-3}}$，$x_0 = 0.5\\,\\mathrm{m}$，$\\epsilon = 0.005\\,\\mathrm{m}$，$U_0 = 20\\,\\mathrm{m\\,s^{-1}}$，$U_1 = 5\\,\\mathrm{m\\,s^{-1}}$，$U_2 = 10\\,\\mathrm{m\\,s^{-1}}$，$\\sigma = 0.02\\,\\mathrm{m}$。\n2. 案例 B (均匀密度基准)：$L = 1\\,\\mathrm{m}$，$N = 4096$，$\\rho_1 = 1.2\\,\\mathrm{kg\\,m^{-3}}$，$\\rho_2 = 1.2\\,\\mathrm{kg\\,m^{-3}}$，$x_0 = 0.5\\,\\mathrm{m}$，$\\epsilon = 0.005\\,\\mathrm{m}$，$U_0 = 20\\,\\mathrm{m\\,s^{-1}}$，$U_1 = 5\\,\\mathrm{m\\,s^{-1}}$，$U_2 = 10\\,\\mathrm{m\\,s^{-1}}$，$\\sigma = 0.02\\,\\mathrm{m}$。\n3. 案例 C (非常陡峭的梯度，大尺度滤波器)：$L = 1\\,\\mathrm{m}$，$N = 4096$，$\\rho_1 = 1.0\\,\\mathrm{kg\\,m^{-3}}$，$\\rho_2 = 7.0\\,\\mathrm{kg\\,m^{-3}}$，$x_0 = 0.5\\,\\mathrm{m}$，$\\epsilon = 0.001\\,\\mathrm{m}$，$U_0 = 15\\,\\mathrm{m\\,s^{-1}}$，$U_1 = 8\\,\\mathrm{m\\,s^{-1}}$，$U_2 = 12\\,\\mathrm{m\\,s^{-1}}$，$\\sigma = 0.20\\,\\mathrm{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为一个扁平化的、逗号分隔的浮点数列表，单位为 $\\mathrm{Pa}$，顺序为 $\\left[\\langle \\Delta \\rangle_{\\mathrm{A}}, \\langle E_{\\mathrm{avoid}} \\rangle_{\\mathrm{A}}, \\langle \\Delta \\rangle_{\\mathrm{B}}, \\langle E_{\\mathrm{avoid}} \\rangle_{\\mathrm{B}}, \\langle \\Delta \\rangle_{\\mathrm{C}}, \\langle E_{\\mathrm{avoid}} \\rangle_{\\mathrm{C}}\\right]$，并用方括号括起来（例如 $\\left[0.1,0.2,0.0,0.0,1.5,1.2\\right]$），其中每个值都是在整个域上的空间平均值，单位为 $\\mathrm{Pa}$。",
            "solution": "所提出的问题是计算流体动力学中一个有效且定义明确的练习，特别涉及可变密度流的大涡模拟（LES）基础。该问题有科学依据、客观，并提供了进行数值求解所需的所有必要信息。问题要求比较对流性动量通量项的简单（雷诺式）滤波和 Favre（密度加权）滤波，这是可压缩或多相湍流建模的一个关键方面。\n\n首先，建立物理量及其数学定义。一维域的长度为 $L$，具有周期性边界条件，由 $N$ 个均匀间隔的点离散化。空间坐标为 $x$。密度场 $\\rho(x)$ 和速度场 $u(x)$ 由下式给出：\n$$ \\rho(x) = \\rho_1 + (\\rho_2 - \\rho_1)\\,s(x), \\quad \\text{其中} \\quad s(x) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{x - x_0}{\\epsilon}\\right)\\right] $$\n$$ u(x) = U_0 + U_1 \\sin\\left(\\frac{2\\pi x}{L}\\right) + U_2 \\exp\\left(-\\left(\\frac{x - x_0}{\\epsilon}\\right)^2\\right) $$\n一维对流性动量通量为量 $\\rho(x) u(x)^2$。\n\n在大涡模拟（LES）中，流场变量被分解为一个大尺度（滤波后）分量和一个小尺度（亚格子）分量。滤波操作，用上划线 $\\overline{\\cdot}$ 表示，是一个空间卷积。对于一个通用场 $\\phi(x)$，其滤波后的场为 $\\overline{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(x - x') \\phi(x') dx'$，其中 $G$ 是滤波核。对于本问题，指定了标准差为 $\\sigma$ 的高斯核。\n\nLES 中的核心挑战来自于对非线性项的滤波。对对流性动量通量 $\\rho u^2$ 进行滤波会产生 $\\overline{\\rho u^2}$。该项是不封闭的，意味着它不能直接用滤波后的主要变量 $\\overline{\\rho}$ 和 $\\overline{u}$ 来表示。它必须被建模。\n\n分析了两种近似该项的常用方法：\n1. **简单（或雷诺）滤波**：该近似由滤波后量的乘积构成：$\\overline{\\rho u^2} \\approx \\overline{\\rho}\\,\\overline{u}^2$。众所周知，当密度变化显著时，这种方法的表现不佳，因为它忽略了亚格子尺度上密度和速度脉动之间的相关性。\n\n2. **Favre（或密度加权）滤波**：此方法旨在缓解可变密度带来的问题。Favre 滤波速度 $\\tilde{u}$ 定义为：\n$$ \\tilde{u}(x) = \\frac{\\overline{\\rho u}(x)}{\\overline{\\rho}(x)} $$\n滤波后对流性通量的相应近似为 $\\overline{\\rho u^2} \\approx \\overline{\\rho}\\,\\tilde{u}^2$。通过将密度并入滤波速度的定义中，一些亚格子相关性被隐式地考虑了，这通常会得到更精确的近似，并且剩余的亚格子尺度（SGS）项的结构也更简单。\n\n问题要求计算和比较这两种近似。具体来说，我们需要计算：\n- 精确的滤波后通量：$\\overline{\\rho u^2}(x)$。\n- 简单滤波近似：$\\overline{\\rho}(x)\\,\\overline{u}(x)^2$。\n- Favre 滤波近似：$\\overline{\\rho}(x)\\,\\tilde{u}(x)^2 = \\overline{\\rho}(x) \\left( \\frac{\\overline{\\rho u}(x)}{\\overline{\\rho}(x)} \\right)^2 = \\frac{(\\overline{\\rho u}(x))^2}{\\overline{\\rho}(x)}$。\n\n两种近似之间的差异由 $\\Delta(x)$ 量化：\n$$ \\Delta(x) = \\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho}(x)\\,\\tilde{u}(x)^2 $$\n该项 $\\Delta(x)$ 代表了在简单平均框架中显式存在，但在 Favre 框架中被吸收到滤波速度定义中的贡献。\n\n此外，我们通过计算相对于精确滤波通量的绝对误差的逐点减少量 $E_{\\mathrm{avoid}}(x)$ 来量化 Favre 滤波的好处：\n$$ E_{\\mathrm{avoid}}(x) = \\underbrace{\\left|\\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho u^2}(x)\\right|}_{\\text{简单近似的误差}} - \\underbrace{\\left|\\overline{\\rho}(x)\\,\\tilde{u}(x)^2 - \\overline{\\rho u^2}(x)\\right|}_{\\text{Favre 近似的误差}} $$\n$E_{\\mathrm{avoid}}(x)$ 的正值表示 Favre 近似在该点上更准确。最终目标是报告这三个不同测试用例中这两个量 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$ 的空间平均值。\n\n数值实现依赖于卷积定理。物理空间中的卷积操作等效于傅里叶（波数）空间中的乘法。步骤如下：\n1. 将域 $x \\in [0, L)$ 离散化为 $N$ 个点。\n2. 生成 $\\rho(x)$、$u(x)$ 以及复合场 $\\rho(x)u(x)$ 和 $\\rho(x)u(x)^2$ 的离散信号。\n3. 计算与网格对应的离散波数 $k$。对于长度为 $L$ 和 $N$ 个点的域，波数为 $k_j = 2\\pi j / L$，其中 $j = -N/2, \\dots, N/2 - 1$。\n4. 在波数空间中构造高斯传递函数：$H(k) = \\exp(-\\frac{1}{2}\\sigma^2 k^2)$。\n5. 对于任何场 $\\phi(x)$，其滤波版本 $\\overline{\\phi}(x)$ 通过以下方式计算：\n   a. 应用快速傅里叶变换（FFT）：$\\hat{\\phi}(k) = \\mathcal{F}\\{\\phi(x)\\}$。\n   b. 乘以传递函数：$\\hat{\\overline{\\phi}}(k) = \\hat{\\phi}(k) H(k)$。\n   c. 应用逆快速傅里叶变换（IFFT）：$\\overline{\\phi}(x) = \\mathcal{F}^{-1}\\{\\hat{\\overline{\\phi}}(k)\\}$。\n6. 使用此滤波程序，计算 $\\overline{\\rho}$、$\\overline{u}$、$\\overline{\\rho u}$ 和 $\\overline{\\rho u^2}$。\n7. 根据这些滤波后的场，逐点计算 $\\tilde{u}$、$\\Delta(x)$ 和 $E_{\\mathrm{avoid}}(x)$。\n8. 最后，通过取相应数组的平均值来计算空间平均值 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$。\n\n对于恒定密度情况（案例 B），其中 $\\rho_1 = \\rho_2$，密度场是均匀的，$\\rho(x) = \\rho_1$。在这种情况下，$\\overline{\\rho} = \\rho_1$，Favre 速度的定义简化为 $\\tilde{u} = \\overline{\\rho_1 u} / \\overline{\\rho_1} = (\\rho_1 \\overline{u}) / \\rho_1 = \\overline{u}$。因此，简单近似和 Favre 近似变得相同，$\\Delta(x)$ 和 $E_{\\mathrm{avoid}}(x)$ 都恒等于零。这个案例是数值实现的一个关键验证。对于具有陡峭密度梯度的情况（A 和 C），预计 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$ 都将具有显著的非零值，这表明两种滤波方法之间存在非平凡的差异，以及 Favre 方法在此类流动中的实际优越性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing simple and Favre filtering for the\n    convective momentum flux in a 1D variable-density flow.\n    \"\"\"\n\n    test_cases = [\n        # Case A: General sharp gradient, moderate filter\n        {'L': 1.0, 'N': 4096, 'rho1': 1.0, 'rho2': 5.0, 'x0': 0.5, 'epsilon': 0.005,\n         'U0': 20.0, 'U1': 5.0, 'U2': 10.0, 'sigma': 0.02},\n        # Case B: Uniform density baseline\n        {'L': 1.0, 'N': 4096, 'rho1': 1.2, 'rho2': 1.2, 'x0': 0.5, 'epsilon': 0.005,\n         'U0': 20.0, 'U1': 5.0, 'U2': 10.0, 'sigma': 0.02},\n        # Case C: Very sharp gradient, large filter\n        {'L': 1.0, 'N': 4096, 'rho1': 1.0, 'rho2': 7.0, 'x0': 0.5, 'epsilon': 0.001,\n         'U0': 15.0, 'U1': 8.0, 'U2': 12.0, 'sigma': 0.20},\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        L = params['L']\n        N = params['N']\n        rho1 = params['rho1']\n        rho2 = params['rho2']\n        x0 = params['x0']\n        epsilon = params['epsilon']\n        U0 = params['U0']\n        U1 = params['U1']\n        U2 = params['U2']\n        sigma = params['sigma']\n\n        # 1. Discretize the domain and define wavenumbers\n        x = np.linspace(0, L, N, endpoint=False)\n        dx = L / N\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n        # 2. Define the Gaussian filter transfer function\n        H_k = np.exp(-0.5 * sigma**2 * k**2)\n\n        def apply_filter(field):\n            \"\"\"Applies the Gaussian filter in Fourier space.\"\"\"\n            field_hat = np.fft.fft(field)\n            filtered_field_hat = field_hat * H_k\n            filtered_field = np.fft.ifft(filtered_field_hat)\n            return np.real(filtered_field)\n\n        # 3. Generate the physical fields\n        s_x = 0.5 * (1 + np.tanh((x - x0) / epsilon))\n        rho = rho1 + (rho2 - rho1) * s_x\n        u = U0 + U1 * np.sin(2 * np.pi * x / L) + U2 * np.exp(-((x - x0) / epsilon)**2)\n\n        # 4. Compute composite fields\n        rhou = rho * u\n        rhou2 = rho * u**2\n\n        # 5. Apply the filter to all necessary fields\n        rho_bar = apply_filter(rho)\n        u_bar = apply_filter(u)\n        rhou_bar = apply_filter(rhou)\n        rhou2_bar = apply_filter(rhou2) # This is the exact filtered flux\n\n        # 6. Compute Favre-filtered velocity\n        # Add a small epsilon to avoid division by zero in case rho_bar gets very small\n        # although with the given parameters it is not an issue.\n        u_tilde = rhou_bar / (rho_bar + 1e-12)\n\n        # 7. Compute the flux approximations\n        flux_simple = rho_bar * u_bar**2\n        flux_favre = rho_bar * u_tilde**2\n\n        # 8. Compute the diagnostic quantities\n        # Difference between simple and Favre approximations\n        delta = flux_simple - flux_favre\n        \n        # Spurious term avoided by Favre filtering (reduction in absolute error)\n        error_simple = np.abs(flux_simple - rhou2_bar)\n        error_favre = np.abs(flux_favre - rhou2_bar)\n        E_avoid = error_simple - error_favre\n\n        # 9. Compute the spatial averages\n        avg_delta = np.mean(delta)\n        avg_E_avoid = np.mean(E_avoid)\n        \n        results.extend([avg_delta, avg_E_avoid])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "大涡模拟的主要目标是解析包含大部分能量的大尺度涡，同时模化未解析小尺度的影响。本练习探讨了这种模化方法对已解析流动动态的直接后果。通过求解一个包含经典亚格子尺度耗散模型的解析动能方程，您将理解亚格子模型如何决定能量衰减率，从而将亚格子模型与湍流的宏观演化联系起来。",
            "id": "3967137",
            "problem": "考虑在三重周期性域中通过大涡模拟（LES）模拟的均匀、各向同性、不可压缩的衰减湍流，其中使用固定滤波宽度 $\\Delta$ 的空间滤波将解析尺度与亚格子尺度分离。设解析速度场为 $\\overline{u}_{i}(\\mathbf{x},t)$，解析动能为 $\\overline{k}(t) \\equiv \\frac{1}{2}\\overline{u}_{i}\\overline{u}_{i}$，并在整个域上进行空间平均。滤波后的 Navier–Stokes 方程意味着解析动能平衡具有以下形式\n$$\n\\frac{\\mathrm{d}\\,\\overline{k}}{\\mathrm{d}t} = -\\epsilon_{\\mathrm{res}} - \\epsilon_{\\mathrm{sgs}}\n$$\n其中 $\\epsilon_{\\mathrm{res}}$ 是解析尺度的粘性耗散，$\\epsilon_{\\mathrm{sgs}} \\equiv -\\tau_{ij}\\overline{S}_{ij}$ 是亚格子尺度（SGS）耗散，$\\tau_{ij}$ 是 SGS 应力张量，$\\overline{S}_{ij} \\equiv \\frac{1}{2}\\left(\\frac{\\partial \\overline{u}_{i}}{\\partial x_{j}} + \\frac{\\partial \\overline{u}_{j}}{\\partial x_{i}}\\right)$ 是解析应变率张量。假设统计均匀性和周期性边界条件，使得输运项和产生项消失；并考虑高雷诺数情况，使得在所关心的时间尺度上，$\\epsilon_{\\mathrm{res}}$ 与 $\\epsilon_{\\mathrm{sgs}}$ 相比可以忽略不计。假设 SGS 耗散被建模为\n$$\n\\epsilon_{\\mathrm{sgs}} = C_{\\epsilon}\\,\\frac{\\overline{k}^{3/2}}{\\Delta}\n$$\n其中 $C_{\\epsilon} > 0$ 是一个常数模型系数，$\\Delta$ 不随时间变化。初始解析动能为 $\\overline{k}(0) = \\overline{k}_{0} > 0$。\n\n从第一性原理和滤波后的动能平衡出发，在这些假设下推导 $\\overline{k}(t)$ 的时间依赖关系，并推断由经典幂律行为 $\\overline{k}(t) \\sim t^{-n}$（在长时间下）定义的渐近衰减指数 $n$。你的最终答案必须是单个实数 $n$。",
            "solution": "分析始于问题陈述中给出的均匀衰减湍流的滤波后空间平均动能平衡：\n$$\n\\frac{\\mathrm{d}\\,\\overline{k}}{\\mathrm{d}t} = -\\epsilon_{\\mathrm{res}} - \\epsilon_{\\mathrm{sgs}}\n$$\n此处，$\\overline{k}(t)$ 是空间平均的解析动能，$\\epsilon_{\\mathrm{res}}$ 是解析尺度上的粘性耗散，$\\epsilon_{\\mathrm{sgs}}$ 是由亚格子尺度（SGS）模型引起的耗散。\n\n问题规定了几个关键假设。首先，对于高雷诺数湍流，假定滤波宽度 $\\Delta$ 位于惯性子区内。在此范围内，与能量向亚格子尺度的传递相比，直接的粘性耗散可以忽略不计。这在数学上表示为 $\\epsilon_{\\mathrm{res}} \\ll \\epsilon_{\\mathrm{sgs}}$。应用此假设可将动能平衡简化为：\n$$\n\\frac{\\mathrm{d}\\,\\overline{k}}{\\mathrm{d}t} \\approx -\\epsilon_{\\mathrm{sgs}}\n$$\n其次，提供了一个特定的 SGS 耗散模型：\n$$\n\\epsilon_{\\mathrm{sgs}} = C_{\\epsilon}\\,\\frac{\\overline{k}^{3/2}}{\\Delta}\n$$\n其中 $C_{\\epsilon}$ 是一个正常数，滤波宽度 $\\Delta$ 也是常数。该模型基于量纲分析，其中滤波尺度上含能涡的特征速度与 $\\sqrt{\\overline{k}}$ 成正比，特征长度尺度为 $\\Delta$。\n\n将 $\\epsilon_{\\mathrm{sgs}}$ 的模型代入简化的能量平衡方程，得到一个关于 $\\overline{k}(t)$ 的一阶常微分方程（ODE）：\n$$\n\\frac{\\mathrm{d}\\,\\overline{k}}{\\mathrm{d}t} = -C_{\\epsilon}\\,\\frac{\\overline{k}^{3/2}}{\\Delta}\n$$\n这是一个可分离的微分方程。为了求解它，我们重新整理各项以分离变量 $\\overline{k}$ 和 $t$：\n$$\n\\overline{k}^{-3/2}\\,\\mathrm{d}\\overline{k} = -\\frac{C_{\\epsilon}}{\\Delta}\\,\\mathrm{d}t\n$$\n现在我们对两边进行积分。左边的积分是关于 $\\overline{k}$，从其初始值 $\\overline{k}(0)=\\overline{k}_{0}$ 积到其在时间 $t$ 的值 $\\overline{k}(t)$。右边的积分是关于时间，从 $t=0$ 积到 $t$。\n$$\n\\int_{\\overline{k}_{0}}^{\\overline{k}(t)} k'^{-3/2}\\,\\mathrm{d}k' = \\int_{0}^{t} -\\frac{C_{\\epsilon}}{\\Delta}\\,\\mathrm{d}t'\n$$\n$k'^{-3/2}$ 的积分是 $\\frac{k'^{-1/2}}{-1/2} = -2k'^{-1/2}$。计算该定积分得到：\n$$\n\\left[-2k'^{-1/2}\\right]_{\\overline{k}_{0}}^{\\overline{k}(t)} = \\left[-\\frac{C_{\\epsilon}}{\\Delta}t'\\right]_{0}^{t}\n$$\n$$\n-2\\overline{k}(t)^{-1/2} - (-2\\overline{k}_{0}^{-1/2}) = -\\frac{C_{\\epsilon}}{\\Delta}t - 0\n$$\n$$\n-2\\overline{k}(t)^{-1/2} + 2\\overline{k}_{0}^{-1/2} = -\\frac{C_{\\epsilon}}{\\Delta}t\n$$\n现在，我们求解 $\\overline{k}(t)^{-1/2}$：\n$$\n2\\overline{k}(t)^{-1/2} = 2\\overline{k}_{0}^{-1/2} + \\frac{C_{\\epsilon}}{\\Delta}t\n$$\n$$\n\\overline{k}(t)^{-1/2} = \\overline{k}_{0}^{-1/2} + \\frac{C_{\\epsilon}}{2\\Delta}t\n$$\n为了求得 $\\overline{k}(t)$，我们取倒数并对两边平方：\n$$\n\\overline{k}(t) = \\left( \\overline{k}_{0}^{-1/2} + \\frac{C_{\\epsilon}}{2\\Delta}t \\right)^{-2}\n$$\n这就是在给定模型和假设下，解析动能随时间变化的表达式。\n\n最后一步是从长时间（$t \\to \\infty$）下的幂律行为 $\\overline{k}(t) \\sim t^{-n}$ 确定渐近衰减指数 $n$。我们考察在 $t$ 很大时推导出的 $\\overline{k}(t)$ 解的极限。当 $t \\to \\infty$ 时，与 $t$ 成正比的项 $\\frac{C_{\\epsilon}}{2\\Delta}t$ 变得远大于常数初始条件项 $\\overline{k}_{0}^{-1/2}$。\n$$\n\\overline{k}_{0}^{-1/2} + \\frac{C_{\\epsilon}}{2\\Delta}t \\approx \\frac{C_{\\epsilon}}{2\\Delta}t \\quad \\text{for } t \\gg \\frac{2\\Delta \\overline{k}_{0}^{-1/2}}{C_{\\epsilon}}\n$$\n将此近似代回 $\\overline{k}(t)$ 的解中：\n$$\n\\overline{k}(t) \\approx \\left(\\frac{C_{\\epsilon}}{2\\Delta}t\\right)^{-2}\n$$\n$$\n\\overline{k}(t) \\approx \\left(\\frac{C_{\\epsilon}}{2\\Delta}\\right)^{-2} t^{-2}\n$$\n该表达式表明，在长时间下，$\\overline{k}(t)$ 与 $t^{-2}$ 成正比。通过将此渐近形式与定义 $\\overline{k}(t) \\sim t^{-n}$ 进行比较，我们可以直接确定衰减指数 $n$。\n$$\nt^{-2} \\sim t^{-n} \\implies n = 2\n$$\n解析动能的渐近衰减指数为 $2$。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}