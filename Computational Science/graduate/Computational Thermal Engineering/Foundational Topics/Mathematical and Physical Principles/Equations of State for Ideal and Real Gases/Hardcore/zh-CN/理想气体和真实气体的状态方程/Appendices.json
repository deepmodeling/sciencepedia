{
    "hands_on_practices": [
        {
            "introduction": "虽然真实气体的行为偏离理想气体模型，但它们的性质可以通过一种通用的方式来描述。本练习将以经典的 van der Waals 方程为例，展示如何利用临界点对状态方程进行无量纲化处理。通过这个过程，我们将消除物质特定的参数，从而揭示对应状态原理这一用于概括流体行为的基石概念。",
            "id": "3951058",
            "problem": "单一组分流体可由 van der Waals 状态方程（EOS）描述，对于摩尔体积 $V$ 和绝对温度 $T$，其形式为\n$$\nP = \\frac{R T}{V - b} - \\frac{a}{V^{2}},\n$$\n其中 $P$ 是压力，$R$ 是普适气体常数，$a$ 和 $b$ 分别是考虑了分子间引力和排斥体积效应的特定物质参数。在温度 $T = T_{c}$ 的等温线 $P(V)$ 上，热力学临界点由 $P$–$V$ 曲线上的一个拐点条件定义，\n$$\n\\left( \\frac{\\partial P}{\\partial V} \\right)_{T} \\bigg|_{(T_{c}, V_{c})} = 0, \n\\qquad\n\\left( \\frac{\\partial^{2} P}{\\partial V^{2}} \\right)_{T} \\bigg|_{(T_{c}, V_{c})} = 0,\n$$\n其对应的压力为 $P_{c} = P(T_{c}, V_{c})$。\n\n从这些基本定义出发，推导临界标度 $P_{c}$、$T_{c}$ 和 $V_{c}$ 关于 $a$、$b$ 和 $R$ 的表达式。然后，通过定义约化变量对状态方程进行无量纲化处理\n$$\n\\hat{P} = \\frac{P}{P_{c}}, \n\\qquad \n\\hat{T} = \\frac{T}{T_{c}}, \n\\qquad \n\\hat{V} = \\frac{V}{V_{c}},\n$$\n并将约化压力 $\\hat{P}$ 表示为仅与 $\\hat{T}$ 和 $\\hat{V}$ 有关的函数。简要解释为什么对于该模型，在对应状态定律下，所得的约化状态方程呈现出无参数结构。最终答案必须是 $\\hat{P}(\\hat{T}, \\hat{V})$ 的单一闭式表达式。无需四舍五入。由于结果是无量纲的，请勿在最终表达式中包含单位。",
            "solution": "该问题要求推导 van der Waals 状态方程（EOS）的临界常数，并随后构建该方程的约化、无量纲形式。\n\nvan der Waals 状态方程为\n$$\nP = \\frac{R T}{V - b} - \\frac{a}{V^{2}}\n$$\n其中 $P$ 是压力，$V$ 是摩尔体积，$T$ 是绝对温度，$R$ 是普适气体常数，$a$ 和 $b$ 是特定物质的参数。\n\n临界点 $(P_c, V_c, T_c)$ 定义为临界等温线上的拐点，在该点，压力对体积在恒温下的一阶和二阶偏导数均为零。\n\n首先，我们计算 $P$ 在恒定 $T$ 下对 $V$ 的一阶偏导数：\n$$\n\\left( \\frac{\\partial P}{\\partial V} \\right)_{T} = \\frac{\\partial}{\\partial V} \\left( \\frac{R T}{V - b} - \\frac{a}{V^{2}} \\right) = - \\frac{R T}{(V - b)^{2}} + \\frac{2a}{V^{3}}\n$$\n接下来，我们计算二阶偏导数：\n$$\n\\left( \\frac{\\partial^{2} P}{\\partial V^{2}} \\right)_{T} = \\frac{\\partial}{\\partial V} \\left( - \\frac{R T}{(V - b)^{2}} + \\frac{2a}{V^{3}} \\right) = \\frac{2 R T}{(V - b)^{3}} - \\frac{6a}{V^{4}}\n$$\n在临界点 $(T_c, V_c)$，两个导数均等于零：\n$$\n(1) \\qquad - \\frac{R T_{c}}{(V_{c} - b)^{2}} + \\frac{2a}{V_{c}^{3}} = 0 \\implies \\frac{R T_{c}}{(V_{c} - b)^{2}} = \\frac{2a}{V_{c}^{3}}\n$$\n$$\n(2) \\qquad \\frac{2 R T_{c}}{(V_{c} - b)^{3}} - \\frac{6a}{V_{c}^{4}} = 0 \\implies \\frac{2 R T_{c}}{(V_{c} - b)^{3}} = \\frac{6a}{V_{c}^{4}}\n$$\n我们现在有一个包含两个未知数 $T_c$ 和 $V_c$ 的方程组。为求解此方程组，我们可以将方程 $(2)$ 除以方程 $(1)$：\n$$\n\\frac{\\left( \\frac{2 R T_{c}}{(V_{c} - b)^{3}} \\right)}{\\left( \\frac{R T_{c}}{(V_{c} - b)^{2}} \\right)} = \\frac{\\left( \\frac{6a}{V_{c}^{4}} \\right)}{\\left( \\frac{2a}{V_{c}^{3}} \\right)}\n$$\n简化两边可得：\n$$\n\\frac{2}{V_{c} - b} = \\frac{3}{V_{c}}\n$$\n$$\n2V_{c} = 3(V_{c} - b) \\implies 2V_{c} = 3V_{c} - 3b \\implies V_{c} = 3b\n$$\n现在我们将临界摩尔体积 $V_{c}$ 的表达式代回方程 $(1)$，以求解临界温度 $T_c$：\n$$\n\\frac{R T_{c}}{(3b - b)^{2}} = \\frac{2a}{(3b)^{3}} \\implies \\frac{R T_{c}}{(2b)^{2}} = \\frac{2a}{27b^{3}}\n$$\n$$\n\\frac{R T_{c}}{4b^{2}} = \\frac{2a}{27b^{3}} \\implies T_{c} = \\frac{4b^{2}}{R} \\left( \\frac{2a}{27b^{3}} \\right) = \\frac{8a}{27Rb}\n$$\n最后，我们将 $T_c$ 和 $V_c$ 代入原始的 van der Waals 方程，求出临界压力 $P_c$：\n$$\nP_{c} = \\frac{R T_{c}}{V_{c} - b} - \\frac{a}{V_{c}^{2}} = \\frac{R}{3b - b} \\left( \\frac{8a}{27Rb} \\right) - \\frac{a}{(3b)^{2}}\n$$\n$$\nP_{c} = \\frac{R}{2b} \\left( \\frac{8a}{27Rb} \\right) - \\frac{a}{9b^{2}} = \\frac{8a}{54b^{2}} - \\frac{a}{9b^{2}} = \\frac{4a}{27b^{2}} - \\frac{3a}{27b^{2}}\n$$\n$$\nP_{c} = \\frac{a}{27b^{2}}\n$$\n总结以 $a$、$b$ 和 $R$ 表示的临界常数：\n$V_c = 3b$, $T_c = \\frac{8a}{27Rb}$, $P_c = \\frac{a}{27b^2}$。\n\n下一步是使用约化变量对状态方程进行无量纲化：\n$\\hat{P} = \\frac{P}{P_c}$, $\\hat{T} = \\frac{T}{T_c}$, $\\hat{V} = \\frac{V}{V_c}$。\n这意味着我们可以将原始变量写为 $P = \\hat{P}P_c$、$T = \\hat{T}T_c$ 和 $V = \\hat{V}V_c$。将这些代入 van der Waals 状态方程：\n$$\n\\hat{P} P_{c} = \\frac{R (\\hat{T} T_{c})}{\\hat{V} V_{c} - b} - \\frac{a}{(\\hat{V} V_{c})^{2}}\n$$\n现在，代入 $P_c$、$T_c$ 和 $V_c$ 的表达式：\n$$\n\\hat{P} \\left( \\frac{a}{27b^{2}} \\right) = \\frac{R \\hat{T} \\left( \\frac{8a}{27Rb} \\right)}{\\hat{V}(3b) - b} - \\frac{a}{(\\hat{V}(3b))^{2}}\n$$\n$$\n\\hat{P} \\left( \\frac{a}{27b^{2}} \\right) = \\frac{\\frac{8a\\hat{T}}{27b}}{b(3\\hat{V} - 1)} - \\frac{a}{9b^{2}\\hat{V}^{2}}\n$$\n$$\n\\hat{P} \\left( \\frac{a}{27b^{2}} \\right) = \\frac{8a\\hat{T}}{27b^{2}(3\\hat{V} - 1)} - \\frac{a}{9b^{2}\\hat{V}^{2}}\n$$\n为了求解 $\\hat{P}$，我们可以将整个方程除以公因子 $\\frac{a}{27b^2}$：\n$$\n\\hat{P} = \\left( \\frac{8a\\hat{T}}{27b^{2}(3\\hat{V} - 1)} \\right) \\left( \\frac{27b^{2}}{a} \\right) - \\left( \\frac{a}{9b^{2}\\hat{V}^{2}} \\right) \\left( \\frac{27b^{2}}{a} \\right)\n$$\n简化每一项可得：\n$$\n\\hat{P} = \\frac{8\\hat{T}}{3\\hat{V} - 1} - \\frac{27}{9\\hat{V}^{2}}\n$$\n这就得到了最终的约化 van der Waals 状态方程：\n$$\n\\hat{P} = \\frac{8\\hat{T}}{3\\hat{V} - 1} - \\frac{3}{\\hat{V}^{2}}\n$$\n所得的约化状态方程是一个联系约化变量 $\\hat{P}$、$\\hat{V}$ 和 $\\hat{T}$ 的无参数表达式。这体现了 van der Waals 模型的对应状态定律。其之所以无参数，是因为特定物质的常数 $a$ 和 $b$ 已被吸收到标度因子 $P_c$、$V_c$ 和 $T_c$ 的定义中。通过将状态变量用它们在临界点（对于任何给定物质而言，这是一个独特的特征点）的值进行标度，所得的方程对于所有可用 van der Waals 模型描述的物质都变得具有普适性。这意味着在相同的约化温度和约化体积下，所有 van der Waals 流体都具有相同的约化压力。",
            "answer": "$$\n\\boxed{\\hat{P} = \\frac{8\\hat{T}}{3\\hat{V} - 1} - \\frac{3}{\\hat{V}^{2}}}\n$$"
        },
        {
            "introduction": "状态方程不仅能描述稳定的物相，还能描绘亚稳态甚至不稳定的区域。本练习将探讨如何从一个现代立方状态方程（SRK方程）中直接提取出关于相稳定性的关键物理信息。我们将通过微积分推导出亚稳态的力学稳定性极限——旋节线，这是理解相分离现象至关重要的一步。",
            "id": "3951120",
            "problem": "一种纯流体遵循Soave–Redlich–Kwong (SRK) 立方状态方程 (EOS)，这是计算热工学中使用的立方EOS的标准代表。SRK EOS的摩尔比形式为\n$$\nP \\;=\\; \\frac{R T}{v - b} \\;-\\; \\frac{a(T)}{v\\,(v + b)} \\,,\n$$\n其中 $P$ 是压力，$T$ 是温度，$R$ 是通用气体常数，$v$ 是摩尔体积，$b$ 是共体积（排斥）参数，$a(T)$ 是与温度相关的吸引力参数。均匀相的等温机械稳定性由等温压缩率的符号决定，该压缩率可通过热力学恒等式，用恒定温度下压力-体积斜率来表示\n$$\n\\kappa_T \\;=\\; -\\frac{1}{v}\\left(\\frac{\\partial v}{\\partial P}\\right)_T \\,,\n$$\n因此机械稳定性要求 $\\left(\\frac{\\partial P}{\\partial v}\\right)_T \\le 0$。旋节线（spinodal）定义为 $P$–$T$–$v$ 空间中均匀相失去机械稳定性且 $\\left(\\frac{\\partial P}{\\partial v}\\right)_T = 0$ 的轨迹。\n\n从这些基础出发，并使用上述SRK EOS作为本构关系，执行以下操作：\n\n1. 从第一性原理出发，将旋节线判据与等温机械稳定性条件联系起来，并解释为什么旋节线对应于均匀相的亚稳态极限。\n2. 将旋节线判据 $\\left(\\frac{\\partial P}{\\partial v}\\right)_T = 0$ 应用于SRK EOS，并通过引入折合摩尔体积 $y \\equiv v/b$ 和无量纲吸引-热参数 $\\kappa \\equiv a(T)/(R T b)$，将所得条件解析地简化为无量纲形式。\n3. 消去 $P$ 并将旋节线条件表示为 $\\kappa$ 关于 $y$ 的显式函数的单一闭式解析表达式。\n\n最终答案仅报告在第3步中获得的显式表达式 $\\kappa(y)$。不需要进行数值计算。最终表达式不需要单位。如果您选择呈现代数因子，请以精确的符号形式保留它们；不要求四舍五入。",
            "solution": "问题陈述经评估有效。它在科学上基于标准化学热力学，特别是状态方程和相稳定性理论。该问题提法恰当，目标明确，并提供了足够的信息来推导所要求的解析表达式。术语精确客观。因此，我们可以着手求解。\n\n该问题要求一个包含三部分的解答：解释旋节线判据，将此判据应用于Soave–Redlich–Kwong (SRK) 状态方程以推导无量纲条件，以及无量纲参数 $\\kappa$ 作为折合摩尔体积 $y$ 的函数的最终表达式。\n\n首先，我们探讨旋节线判据的物理基础。热力学稳定性要求一个系统在受到对其平衡态的微小扰动时，必须产生一个作用以使系统恢复平衡的响应。对于恒定温度 $T$ 下均匀相的机械稳定性，考虑摩尔体积 $v$ 的一个微小的自发涨落。如果体积减小（压缩，使得变化量 $\\delta v$ 为负），稳定性要求系统的压力 $P$ 必须增加（变化量 $\\delta P$ 为正）以抵消压缩。相反，如果体积增加（膨胀，$\\delta v  0$），压力必须减小（$\\delta P  0$）以抵抗膨胀。在这两种情况下，压力变化量与体积变化量之比 $\\delta P / \\delta v$ 必须为负。对于无穷小的涨落，该条件由偏导数表示：\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T \\le 0\n$$\n这是等温机械稳定性的基本条件。该条件与等温压缩率 $\\kappa_T$ 直接相关，其定义为 $\\kappa_T = -\\frac{1}{v}\\left(\\frac{\\partial v}{\\partial P}\\right)_T$。由于对于物理上稳定的物质，摩尔体积 $v$ 和 $\\kappa_T$ 都必须为正，因此要求 $\\left(\\frac{\\partial v}{\\partial P}\\right)_T  0$。使用偏导数的恒等式 $\\left(\\frac{\\partial v}{\\partial P}\\right)_T = \\left[\\left(\\frac{\\partial P}{\\partial v}\\right)_T\\right]^{-1}$，条件 $\\left(\\frac{\\partial v}{\\partial P}\\right)_T  0$ 完全等同于 $\\left(\\frac{\\partial P}{\\partial v}\\right)_T  0$。\n\n一个均匀相可以存在于稳定态（吉布斯自由能的全局最小值）或亚稳态（局部但非全局最小值），两者都满足 $\\left(\\frac{\\partial P}{\\partial v}\\right)_T  0$。旋节线被定义为一个相失去其局部机械稳定性的点的轨迹。在这个极限下，恢复力消失，系统对自发分解为多相不提供任何阻力。因此，这个亚稳态的极限由导数变为零的条件标记：\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T = 0\n$$\n在 $\\left(\\frac{\\partial P}{\\partial v}\\right)_T  0$ 的区域，该相是机械不稳定的，不能作为均匀相存在。\n\n其次，我们将此旋节线判据应用于给定的SRK状态方程。SRK EOS为：\n$$\nP(v, T) = \\frac{R T}{v - b} - \\frac{a(T)}{v(v + b)}\n$$\n我们必须计算在恒定 $T$ 下 $P$ 对 $v$ 的偏导数：\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T = \\frac{\\partial}{\\partial v} \\left( \\frac{R T}{v - b} - \\frac{a(T)}{v^2 + vb} \\right)_T\n$$\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T = -R T (v - b)^{-2} - a(T) (-1) (v^2 + vb)^{-2} (2v + b)\n$$\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T = -\\frac{R T}{(v - b)^2} + \\frac{a(T)(2v + b)}{\\left[v(v + b)\\right]^2}\n$$\n旋节线条件是 $\\left(\\frac{\\partial P}{\\partial v}\\right)_T = 0$。将此应用于上述表达式可得：\n$$\n-\\frac{R T}{(v - b)^2} + \\frac{a(T)(2v + b)}{v^2(v + b)^2} = 0\n$$\n$$\n\\frac{R T}{(v - b)^2} = \\frac{a(T)(2v + b)}{v^2(v + b)^2}\n$$\n这个消去了压力 $P$ 的方程，就是遵循SRK EOS的流体的旋节线条件。\n\n第三，我们将此条件简化为无量纲形式，并找出显式函数 $\\kappa(y)$。我们重排方程以对参数进行分组：\n$$\n\\frac{a(T)}{R T} = \\frac{v^2(v + b)^2}{(v - b)^2(2v + b)}\n$$\n现在，我们引入无量纲变量 $y \\equiv v/b$ 和 $\\kappa \\equiv a(T)/(R T b)$。根据 $y$ 的定义，我们有 $v = yb$。将此代入方程中：\n$$\n\\frac{a(T)}{R T} = \\frac{(yb)^2(yb + b)^2}{(yb - b)^2(2yb + b)}\n$$\n我们从每一项中提出常数 $b$：\n$$\n\\frac{a(T)}{R T} = \\frac{y^2 b^2 \\cdot b^2(y + 1)^2}{b^2(y - 1)^2 \\cdot b(2y + 1)}\n$$\n$$\n\\frac{a(T)}{R T} = \\frac{b^4 y^2(y + 1)^2}{b^3(y - 1)^2(2y + 1)}\n$$\n$$\n\\frac{a(T)}{R T} = b \\frac{y^2(y + 1)^2}{(y - 1)^2(2y + 1)}\n$$\n为了获得无量纲参数 $\\kappa$，我们将两边都除以 $b$：\n$$\n\\frac{a(T)}{R T b} = \\frac{y^2(y + 1)^2}{(y - 1)^2(2y + 1)}\n$$\n根据定义，左边是 $\\kappa$。因此，我们已将旋节线条件推导为 $\\kappa$ 关于 $y$ 的显式函数的单一闭式解析表达式：\n$$\n\\kappa(y) = \\frac{y^2(y + 1)^2}{(y - 1)^2(2y + 1)}\n$$\n这就是最终所求的表达式。该函数的定义域必须是 $y > 1$，因为 $v > b$ 是SRK EOS的一个物理要求（摩尔体积必须大于共体积）。",
            "answer": "$$\n\\boxed{\\kappa(y) = \\frac{y^{2}(y+1)^{2}}{(y-1)^{2}(2y+1)}}\n$$"
        },
        {
            "introduction": "从解析推导转向实际的计算应用，在工程实践中，我们需要根据具体应用场景选择并比较不同的状态方程模型。这项动手编程练习将要求您实现两种结构不同的状态方程（立方型的 Peng-Robinson 方程和复杂的多参数 BWRS 方程），并用它们来预测一种重质烃的性质。通过求解这些非线性方程并计算焦耳-汤姆孙系数等重要的导出性质，您将直观地看到不同模型在预测上的差异。",
            "id": "3951055",
            "problem": "您需要实现一个完整的、可运行的程序。该程序针对一种被建模为单组分的指定重质烃，比较两种真实气体状态方程在多个温度-压力对下的预测结果，并分析压缩因子和派生属性——焦耳-汤姆逊系数的差异。\n\n请从以下基本原理和定义开始。\n\n- 压缩因子定义为 $Z \\equiv \\dfrac{P v}{R T}$，其中 $P$ 是压力，$v$ 是摩尔体积，$R$ 是普适气体常数，$T$ 是温度。\n- 焦耳-汤姆逊系数定义为 $\\mu_{\\mathrm{JT}} \\equiv \\left( \\dfrac{\\partial T}{\\partial P} \\right)_H$。从焓微分 $d h = c_p d T + \\left[ v - T \\left( \\dfrac{\\partial v}{\\partial T} \\right)_P \\right] d P$ 和等焓条件 $d h = 0$，可以得到工作关系式\n$$\n\\mu_{\\mathrm{JT}} = \\dfrac{ T \\left( \\dfrac{\\partial v}{\\partial T} \\right)_P - v }{ c_p },\n$$\n其中 $c_p$ 是恒压摩尔热容。在本问题中，使用线性的理想气体形式 $c_{p,\\mathrm{ig}}(T) = A + B T$ 来为 $c_p$ 建模，其中 $A$ 和 $B$ 是给定常数。\n\n使用以下两种状态方程（EOS）作为计算模型。\n\n- Peng–Robinson (PR) 立方状态方程：\n$$\nP(T,v) = \\dfrac{R T}{v - b} - \\dfrac{a \\, \\alpha(T)}{ v (v + b) + b (v - b) },\n$$\n其中\n$$\na = 0.45724 \\dfrac{R^2 T_c^2}{P_c}, \\quad b = 0.07780 \\dfrac{R T_c}{P_c}, \\quad \\alpha(T) = \\left[ 1 + \\kappa \\left(1 - \\sqrt{\\dfrac{T}{T_c}} \\right) \\right]^2,\n$$\n$$\n\\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2.\n$$\n- 以摩尔密度 $\\rho \\equiv \\dfrac{1}{v}$ 表示的类 Benedict–Webb–Rubin–Starling (BWRS) 形式：\n$$\nP(T,\\rho) = R T \\rho + \\left( B_0 R T - A_0 - \\dfrac{C_0}{T^2} \\right) \\rho^2 + \\left( b R T - a \\right) \\rho^3 + a \\alpha \\rho^6 + \\dfrac{c}{T^2} \\, \\rho^3 \\left( 1 + \\gamma \\rho^2 \\right) \\exp\\!\\left( - \\gamma \\rho^2 \\right).\n$$\n\n对于该重质烃（选择其代表 $n$-decane），采用以下数据：\n\n- 临界温度 $T_c = 617.7$ K。\n- 临界压力 $P_c = 2.11$ MPa。\n- 偏心因子 $\\omega = 0.49$。\n- 普适气体常数 $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$。\n- 理想气体摩尔热容模型常数 $A = 100.0$ J mol$^{-1}$ K$^{-1}$ 和 $B = 0.20$ J mol$^{-1}$ K$^{-2}$。\n- 类BWRS系数（单位的选择是为了保证上述公式的量纲一致性）：\n  - $A_0 = 0.20$ J m$^3$ mol$^{-2}$，\n  - $B_0 = 1.0 \\times 10^{-4}$ m$^3$ mol$^{-1}$，\n  - $C_0 = 0.02$ J m$^3$ mol$^{-2}$ K$^{-2}$，\n  - $a = 1.0 \\times 10^{-4}$ J m$^6$ mol$^{-3}$，\n  - $b = 1.0 \\times 10^{-7}$ m$^6$ mol$^{-2}$，\n  - $\\alpha = 1.0$ (无量纲)，\n  - $\\gamma = 1.0 \\times 10^{-6}$ m$^6$ mol$^{-2}$，\n  - $c = 1.0 \\times 10^{-4}$ J m$^6$ K$^2$ mol$^{-3}$。\n\n您的程序必须完全使用浮点运算实现以下逻辑：\n\n- 对于每个指定的温度-压力对 $(T,P)$，通过数值求解 PR 状态方程 $P(T,v)$ 来计算摩尔体积 $v_{\\mathrm{PR}}(T,P)$。通过数值求解类 BWRS 状态方程 $P(T,\\rho)$ 来计算摩尔密度 $\\rho_{\\mathrm{BWRS}}(T,P)$，然后设置 $v_{\\mathrm{BWRS}}(T,P) = 1 / \\rho_{\\mathrm{BWRS}}(T,P)$。\n- 使用这些摩尔体积计算压缩因子 $Z_{\\mathrm{PR}} = \\dfrac{P v_{\\mathrm{PR}}}{R T}$ 和 $Z_{\\mathrm{BWRS}} = \\dfrac{P v_{\\mathrm{BWRS}}}{R T}$。\n- 使用以下公式计算焦耳-汤姆逊系数：\n$$\n\\mu_{\\mathrm{JT,PR}}(T,P) = \\dfrac{ T \\left( \\dfrac{\\partial v_{\\mathrm{PR}}}{\\partial T} \\right)_P - v_{\\mathrm{PR}} }{ c_{p,\\mathrm{ig}}(T) }, \\quad\n\\mu_{\\mathrm{JT,BWRS}}(T,P) = \\dfrac{ T \\left( \\dfrac{\\partial v_{\\mathrm{BWRS}}}{\\partial T} \\right)_P - v_{\\mathrm{BWRS}} }{ c_{p,\\mathrm{ig}}(T) },\n$$\n其中 $\\left( \\dfrac{\\partial v}{\\partial T} \\right)_P$ 通过中心有限差分进行近似，使用对称温度增量 $\\Delta T = 1.0$ K。将计算出的 K/Pa 值除以 $10^6$，以 K/MPa 为单位报告焦耳-汤姆逊系数。\n\n数值要求和约束：\n\n- 使用稳健的区间法和求根法求解非线性方程 $v_{\\mathrm{PR}}(T,P)$ 和 $\\rho_{\\mathrm{BWRS}}(T,P)$；确保区间两端的目标残差符号相反。\n- 内部计算使用国际单位制基本单位：$T$ 单位为开尔文，$P$ 单位为帕斯卡，$v$ 单位为 m$^3$ mol$^{-1}$，$\\rho$ 单位为 mol m$^{-3}$。最终报告的 $\\mu_{\\mathrm{JT}}$ 必须以 K/MPa 为单位。\n- 所有输出结果计算到小数点后六位。\n\n测试套件：\n\n在以下四个案例上评估您的程序，这些案例旨在覆盖一个典型的超临界类气态区域、一个近临界区域、一个低压近理想气体区域以及一个保持在单相区内的高压区域：\n\n- 案例 1：$T = 650.0$ K, $P = 1.0$ MPa。\n- 案例 2：$T = 620.0$ K, $P = 2.0$ MPa。\n- 案例 3：$T = 700.0$ K, $P = 0.1$ MPa。\n- 案例 4：$T = 650.0$ K, $P = 5.0$ MPa。\n\n答案规范：\n\n- 对于每个案例，生成一个包含四个浮点数的列表 $[ Z_{\\mathrm{PR}}, Z_{\\mathrm{BWRS}}, \\mu_{\\mathrm{JT,PR}}, \\mu_{\\mathrm{JT,BWRS}} ]$，其中焦耳-汤姆逊系数的单位为 K/MPa。将每个值四舍五入到小数点后六位。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个案例表示为其自己的子列表，例如 $[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\ldots]$。",
            "solution": "该问题被评估为有效，因为它在化学工程热力学方面有科学依据，数据充分，提法得当，且表述客观。任务是实现一个计算模型，用于比较两种状态方程（EOS）对一种重质烃的预测。\n\n求解过程首先建立必要的物理常数和状态方程参数。然后，对于每个指定的温度-压力对，采用稳健的数值求根算法来确定每个状态方程的摩尔体积（或密度）。随后，根据它们的基本定义和计算出的状态变量，计算压缩因子和焦耳-汤姆逊系数。\n\n**1. 模型构建和常数**\n\n问题要求使用两种状态方程：Peng–Robinson (PR) EOS 和一个特定的类 Benedict–Webb–Rubin–Starling (BWRS) EOS。所有计算均使用国际单位制基本单位（压力单位为帕斯卡，温度单位为开尔文，摩尔体积单位为 $m^3/mol$）。\n\n**Peng-Robinson (PR) EOS：**\n压力表示为温度 $T$ 和摩尔体积 $v$ 的函数：\n$$P(T,v) = \\dfrac{R T}{v - b} - \\dfrac{a \\alpha(T)}{v(v+b) + b(v-b)}$$\n参数 $a$、$b$ 和 $\\alpha(T)$ 由物质的临界性质（$T_c, P_c$）和偏心因子（$\\omega$）确定：\n$$a = 0.45724 \\dfrac{R^2 T_c^2}{P_c}, \\quad b = 0.07780 \\dfrac{R T_c}{P_c}$$\n$$\\alpha(T) = \\left[ 1 + \\kappa \\left(1 - \\sqrt{\\dfrac{T}{T_c}} \\right) \\right]^2, \\quad \\text{其中} \\quad \\kappa = 0.37464 + 1.54226 \\omega - 0.26992 \\omega^2$$\n\n**类BWRS EOS：**\n该状态方程给出压力作为温度 $T$ 和摩尔密度 $\\rho = 1/v$ 的函数：\n$$P(T,\\rho) = R T \\rho + \\left( B_0 R T - A_0 - \\dfrac{C_0}{T^2} \\right) \\rho^2 + \\left( b R T - a \\right) \\rho^3 + a \\alpha \\rho^6 + \\dfrac{c}{T^2} \\rho^3 \\left( 1 + \\gamma \\rho^2 \\right) \\exp\\left( - \\gamma \\rho^2 \\right)$$\n系数 $A_0, B_0, C_0, a, b, \\alpha, c, \\gamma$ 作为特定物质的常数提供。\n\n**物理和模型常数：**\n以下数据用于类正癸烷的重质烃：\n- 临界温度, $T_c = 617.7 \\text{ K}$\n- 临界压力, $P_c = 2.11 \\text{ MPa} = 2.11 \\times 10^6 \\text{ Pa}$\n- 偏心因子, $\\omega = 0.49$\n- 普适气体常数, $R = 8.314462618 \\text{ J mol}^{-1} \\text{ K}^{-1}$\n- 理想气体热容常数: $A = 100.0 \\text{ J mol}^{-1} \\text{ K}^{-1}$, $B = 0.20 \\text{ J mol}^{-1} \\text{ K}^{-2}$\n- 类BWRS系数按规定使用，并注意将其与PR方程中共享相同符号（$a, b, \\alpha$）的参数区分开来。\n\n**2. 计算策略**\n\n**用于确定状态的求根：**\n在给定的温度 $T$ 和压力 $P$ 下，两个状态方程都变成单一变量（PR方程为摩尔体积 $v$，类BWRS方程为摩尔密度 $\\rho$）的非线性函数。为了找到正确的状态，我们必须求解这个变量。这被表述为一个求根问题，$f(x) = 0$，其中残差函数为 $f(x) = P_{EOS}(T, x) - P$。\n\n为此任务选择了一个稳健的数值求解器 `scipy.optimize.brentq`。该方法需要一个区间 $[x_{min}, x_{max}]$，使得 $f(x_{min})$ 和 $f(x_{max})$ 的符号相反。\n- 对于PR EOS，物理摩尔体积 $v$ 必须大于协体积参数 $b$。理想气体体积 $v_{ideal} = RT/P$ 为解的量级提供了一个很好的估计。可以建立一个合适的搜索区间，例如，在 $1.01 \\cdot b$ 和 $v_{ideal}$ 的数倍之间。\n- 对于类BWRS EOS，摩尔密度 $\\rho$ 必须为正。使用一个宽泛但物理上合理的区间，例如 $[10^{-4}, 6000] \\text{ mol/m}^3$，以确保在所有测试条件下都能捕捉到根。\n\n**派生属性的计算：**\n1.  **压缩因子 ($Z$):** 在给定的 $(T, P)$ 下确定摩尔体积 $v$ 后，压缩因子直接根据其定义计算：\n    $$Z = \\dfrac{P v}{R T}$$\n\n2.  **焦耳-汤姆逊系数 ($\\mu_{JT}$):** 该系数使用提供的热力学关系式计算：\n    $$\\mu_{\\mathrm{JT}} = \\dfrac{T \\left( \\dfrac{\\partial v}{\\partial T} \\right)_P - v}{c_p}$$\n    按照规定，热容 $c_p$ 用其理想气体形式 $c_{p,ig}(T) = A + B T$ 来近似。偏导数 $(\\partial v / \\partial T)_P$ 使用二阶中心有限差分格式进行近似，温度步长为 $\\Delta T = 1.0 \\text{ K}$：\n    $$\\left( \\dfrac{\\partial v}{\\partial T} \\right)_P \\approx \\dfrac{v(T + \\Delta T, P) - v(T - \\Delta T, P)}{2 \\Delta T}$$\n    这要求对每个测试案例，在另外两个温度 $T + \\Delta T$ 和 $T - \\Delta T$ 下求解摩尔体积。最终的 K/Pa 结果通过除以 $10^6$ 转换为 K/MPa。\n\n**3. 实现设计**\n\nPython 实现的结构清晰且稳健。\n- 采用面向对象设计，使用独立的类（`PREOS`、`BWRS_EOS`）来封装每个状态方程的逻辑和参数。这可以防止不同模型中同名参数（例如 $a$、$b$）之间的混淆。\n- 一个 `solve` 主函数协调整个过程。它遍历指定的测试案例，并调用一个辅助函数来为每个 $(T, P)$ 对执行计算。\n- 这个计算辅助函数首先使用各自的 EOS 求根例程求解摩尔体积/密度。然后通过有限差分计算导数项，最后组合出 $Z$ 和 $\\mu_{JT}$ 的值。\n- 所有内部计算都严格遵守国际单位制。\n- 每个案例的最终结果 $[Z_{\\mathrm{PR}}, Z_{\\mathrm{BWRS}}, \\mu_{\\mathrm{JT,PR}}, \\mu_{\\mathrm{JT,BWRS}}]$ 按要求四舍五入到小数点后六位，并汇总成一个列表的列表。然后将此最终数据结构格式化为指定的字符串表示形式用于输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the thermodynamics problem.\n    It sets up constants, defines EOS models, iterates through test cases,\n    and prints the final results in the specified format.\n    \"\"\"\n\n    # Global constants in SI units\n    R = 8.314462618  # J mol^-1 K^-1\n    TC = 617.7  # K\n    PC = 2.11e6  # Pa\n    OMEGA = 0.49\n    CP_IG_PARAMS = {\"A\": 100.0, \"B\": 0.20}  # J mol^-1 K^-1, J mol^-1 K^-2\n\n    # BWRS-like EOS coefficients\n    BWRS_PARAMS = {\n        \"A0\": 0.20,       # J m^3 mol^-2\n        \"B0\": 1.0e-4,     # m^3 mol^-1\n        \"C0\": 0.02,       # J m^3 mol^-2 K^2\n        \"a\": 1.0e-4,      # J m^6 mol^-3\n        \"b\": 1.0e-7,      # m^6 mol^-2\n        \"alpha\": 1.0,     # dimensionless\n        \"gamma\": 1.0e-6,  # m^6 mol^-2\n        \"c\": 1.0e-4       # J m^6 K^2 mol^-3\n    }\n    \n    class PREOS:\n        \"\"\"Encapsulates the Peng-Robinson Equation of State.\"\"\"\n        def __init__(self, Tc, Pc, omega, R_const):\n            self.Tc, self.Pc, self.omega, self.R = Tc, Pc, omega, R_const\n            self.kappa = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n            self.a_const = 0.45724 * (self.R**2 * Tc**2) / Pc\n            self.b = 0.07780 * (self.R * Tc) / Pc\n\n        def get_alpha(self, T):\n            return (1 + self.kappa * (1 - np.sqrt(T / self.Tc)))**2\n\n        def pressure(self, v, T):\n            alpha_T = self.get_alpha(T)\n            # Denominator is v(v+b) + b(v-b) = v^2 + 2bv - b^2\n            attractive_term = (self.a_const * alpha_T) / (v**2 + 2 * self.b * v - self.b**2)\n            repulsive_term = (self.R * T) / (v - self.b)\n            return repulsive_term - attractive_term\n\n        def residual(self, v, T, P):\n            if v = self.b:\n                return 1e12  # Return a large number for non-physical volumes\n            return self.pressure(v, T) - P\n\n    class BWRS_EOS:\n        \"\"\"Encapsulates the BWRS-like Equation of State.\"\"\"\n        def __init__(self, R_const, params):\n            self.R = R_const\n            self.p = params\n\n        def pressure(self, rho, T):\n            p = self.p\n            T2 = T**2\n            rho2 = rho**2\n            rho3 = rho**3\n            gamma_rho2 = p[\"gamma\"] * rho2\n            \n            term1 = self.R * T * rho\n            term2 = (p[\"B0\"] * self.R * T - p[\"A0\"] - p[\"C0\"] / T2) * rho2\n            term3 = (p[\"b\"] * self.R * T - p[\"a\"]) * rho3\n            term4 = p[\"a\"] * p[\"alpha\"] * rho**6\n            term5 = (p[\"c\"] / T2) * rho3 * (1 + gamma_rho2) * np.exp(-gamma_rho2)\n            \n            return term1 + term2 + term3 + term4 + term5\n            \n        def residual(self, rho, T, P):\n            if rho  0:\n                return -1e12 # Return a large number for non-physical densities\n            return self.pressure(rho, T) - P\n\n    def get_properties(T, P, pr_eos, bwrs_eos, cp_params):\n        \"\"\"Computes Z and mu_JT for both EOS at a given T and P.\"\"\"\n        # --- Peng-Robinson Path ---\n        v_ideal_pr = R * T / P\n        v_pr = brentq(pr_eos.residual, pr_eos.b * 1.01, v_ideal_pr * 10, args=(T, P))\n        Z_pr = (P * v_pr) / (R * T)\n\n        # --- BWRS-like Path ---\n        # Bracket [1e-4, 6000] is robust for gaseous states\n        rho_bwrs = brentq(bwrs_eos.residual, 1e-4, 6000, args=(T, P))\n        v_bwrs = 1.0 / rho_bwrs\n        Z_bwrs = (P * v_bwrs) / (R * T)\n\n        # --- Joule-Thomson Coefficient Calculation ---\n        dT = 1.0 # K, finite difference step\n        cp_ig = cp_params[\"A\"] + cp_params[\"B\"] * T\n        \n        # PR mu_JT\n        v_pr_plus = brentq(pr_eos.residual, pr_eos.b * 1.01, v_ideal_pr * 10, args=(T + dT, P))\n        v_pr_minus = brentq(pr_eos.residual, pr_eos.b * 1.01, v_ideal_pr * 10, args=(T - dT, P))\n        dvdT_pr = (v_pr_plus - v_pr_minus) / (2 * dT)\n        mu_jt_pr_si = (T * dvdT_pr - v_pr) / cp_ig\n        mu_jt_pr = mu_jt_pr_si / 1e6 # Convert from K/Pa to K/MPa\n\n        # BWRS mu_JT\n        rho_bwrs_plus = brentq(bwrs_eos.residual, 1e-4, 6000, args=(T + dT, P))\n        rho_bwrs_minus = brentq(bwrs_eos.residual, 1e-4, 6000, args=(T - dT, P))\n        v_bwrs_plus = 1.0 / rho_bwrs_plus\n        v_bwrs_minus = 1.0 / rho_bwrs_minus\n        dvdT_bwrs = (v_bwrs_plus - v_bwrs_minus) / (2 * dT)\n        mu_jt_bwrs_si = (T * dvdT_bwrs - v_bwrs) / cp_ig\n        mu_jt_bwrs = mu_jt_bwrs_si / 1e6 # Convert from K/Pa to K/MPa\n\n        return [\n            round(Z_pr, 6),\n            round(Z_bwrs, 6),\n            round(mu_jt_pr, 6),\n            round(mu_jt_bwrs, 6)\n        ]\n\n    # Instantiate EOS models\n    pr_eos_model = PREOS(TC, PC, OMEGA, R)\n    bwrs_eos_model = BWRS_EOS(R, BWRS_PARAMS)\n\n    # Define test cases (T in K, P in Pa)\n    test_cases = [\n        (650.0, 1.0e6),\n        (620.0, 2.0e6),\n        (700.0, 0.1e6),\n        (650.0, 5.0e6)\n    ]\n\n    results = []\n    for T_case, P_case in test_cases:\n        case_results = get_properties(T_case, P_case, pr_eos_model, bwrs_eos_model, CP_IG_PARAMS)\n        results.append(case_results)\n    \n    # Format the final output string as a list of lists.\n    # str(list) automatically creates the '[...]' representation.\n    # ','.join(...) joins these string representations with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}