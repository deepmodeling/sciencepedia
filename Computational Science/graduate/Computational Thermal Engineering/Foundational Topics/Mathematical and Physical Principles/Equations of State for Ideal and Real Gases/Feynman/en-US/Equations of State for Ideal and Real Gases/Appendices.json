{
    "hands_on_practices": [
        {
            "introduction": "The van der Waals equation represents a monumental first step in modeling the behavior of real gases beyond the ideal gas law. This exercise guides you through a classic derivation that reveals a profound insight: the law of corresponding states. By determining the fluid's characteristic critical point and using it to define dimensionless variables, you will transform the substance-specific equation into a universal, parameter-free form, a powerful technique widely used in engineering analysis .",
            "id": "3951058",
            "problem": "A single-component fluid is modeled by the van der Waals Equation of State (EOS), which for a molar volume $V$ and absolute temperature $T$ is\n$$\nP = \\frac{R T}{V - b} - \\frac{a}{V^{2}},\n$$\nwhere $P$ is pressure, $R$ is the universal gas constant, and $a$ and $b$ are substance-specific parameters accounting for attraction and excluded volume effects, respectively. The thermodynamic critical point on the isotherm $P(V)$ at temperature $T = T_{c}$ is defined by an inflection condition on the $P$–$V$ curve,\n$$\n\\left( \\frac{\\partial P}{\\partial V} \\right)_{T} \\bigg|_{(T_{c}, V_{c})} = 0, \n\\qquad\n\\left( \\frac{\\partial^{2} P}{\\partial V^{2}} \\right)_{T} \\bigg|_{(T_{c}, V_{c})} = 0,\n$$\nwith the corresponding pressure $P_{c} = P(T_{c}, V_{c})$.\n\nStarting from these foundational definitions, derive the critical scales $P_{c}$, $T_{c}$, and $V_{c}$ in terms of $a$, $b$, and $R$. Then, non-dimensionalize the EOS by defining reduced variables\n$$\n\\hat{P} = \\frac{P}{P_{c}}, \n\\qquad \n\\hat{T} = \\frac{T}{T_{c}}, \n\\qquad \n\\hat{V} = \\frac{V}{V_{c}},\n$$\nand express the reduced pressure $\\hat{P}$ solely as a function of $\\hat{T}$ and $\\hat{V}$. Explain briefly why the resulting reduced EOS exhibits a parameter-free structure under the law of corresponding states for this model. The final answer must be the single closed-form expression for $\\hat{P}(\\hat{T}, \\hat{V})$. No rounding is required. Since the result is dimensionless, do not include units in your final expression.",
            "solution": "The problem requires the derivation of the critical constants for the van der Waals Equation of State (EOS) and the subsequent formulation of the reduced, dimensionless form of this equation.\n\nThe van der Waals EOS is given by\n$$\nP = \\frac{R T}{V - b} - \\frac{a}{V^{2}}\n$$\nwhere $P$ is the pressure, $V$ is the molar volume, $T$ is the absolute temperature, $R$ is the universal gas constant, and $a$ and $b$ are substance-specific parameters.\n\nThe critical point $(P_c, V_c, T_c)$ is defined as the point of inflection on the critical isotherm, where both the first and second partial derivatives of pressure with respect to volume at constant temperature are zero.\n\nFirst, we compute the first partial derivative of $P$ with respect to $V$ at constant $T$:\n$$\n\\left( \\frac{\\partial P}{\\partial V} \\right)_{T} = \\frac{\\partial}{\\partial V} \\left( \\frac{R T}{V - b} - \\frac{a}{V^{2}} \\right) = - \\frac{R T}{(V - b)^{2}} + \\frac{2a}{V^{3}}\n$$\nNext, we compute the second partial derivative:\n$$\n\\left( \\frac{\\partial^{2} P}{\\partial V^{2}} \\right)_{T} = \\frac{\\partial}{\\partial V} \\left( - \\frac{R T}{(V - b)^{2}} + \\frac{2a}{V^{3}} \\right) = \\frac{2 R T}{(V - b)^{3}} - \\frac{6a}{V^{4}}\n$$\nAt the critical point $(T_c, V_c)$, both derivatives are equal to zero:\n$$\n(1) \\qquad - \\frac{R T_{c}}{(V_{c} - b)^{2}} + \\frac{2a}{V_{c}^{3}} = 0 \\implies \\frac{R T_{c}}{(V_{c} - b)^{2}} = \\frac{2a}{V_{c}^{3}}\n$$\n$$\n(2) \\qquad \\frac{2 R T_{c}}{(V_{c} - b)^{3}} - \\frac{6a}{V_{c}^{4}} = 0 \\implies \\frac{2 R T_{c}}{(V_{c} - b)^{3}} = \\frac{6a}{V_{c}^{4}}\n$$\nWe now have a system of two equations with two unknowns, $T_c$ and $V_c$. To solve this system, we can divide equation $(2)$ by equation $(1)$:\n$$\n\\frac{\\left( \\frac{2 R T_{c}}{(V_{c} - b)^{3}} \\right)}{\\left( \\frac{R T_{c}}{(V_{c} - b)^{2}} \\right)} = \\frac{\\left( \\frac{6a}{V_{c}^{4}} \\right)}{\\left( \\frac{2a}{V_{c}^{3}} \\right)}\n$$\nSimplifying both sides yields:\n$$\n\\frac{2}{V_{c} - b} = \\frac{3}{V_{c}}\n$$\n$$\n2V_{c} = 3(V_{c} - b) \\implies 2V_{c} = 3V_{c} - 3b \\implies V_{c} = 3b\n$$\nNow we substitute this expression for the critical molar volume, $V_{c}$, back into equation $(1)$ to solve for the critical temperature, $T_c$:\n$$\n\\frac{R T_{c}}{(3b - b)^{2}} = \\frac{2a}{(3b)^{3}} \\implies \\frac{R T_{c}}{(2b)^{2}} = \\frac{2a}{27b^{3}}\n$$\n$$\n\\frac{R T_{c}}{4b^{2}} = \\frac{2a}{27b^{3}} \\implies T_{c} = \\frac{4b^{2}}{R} \\left( \\frac{2a}{27b^{3}} \\right) = \\frac{8a}{27Rb}\n$$\nFinally, we find the critical pressure, $P_c$, by substituting $T_c$ and $V_c$ into the original van der Waals equation:\n$$\nP_{c} = \\frac{R T_{c}}{V_{c} - b} - \\frac{a}{V_{c}^{2}} = \\frac{R}{3b - b} \\left( \\frac{8a}{27Rb} \\right) - \\frac{a}{(3b)^{2}}\n$$\n$$\nP_{c} = \\frac{R}{2b} \\left( \\frac{8a}{27Rb} \\right) - \\frac{a}{9b^{2}} = \\frac{4a}{27b^{2}} - \\frac{a}{9b^{2}} = \\frac{4a - 3a}{27b^{2}} = \\frac{a}{27b^{2}}\n$$\nSummarizing the critical constants in terms of $a$, $b$, and $R$:\n$V_c = 3b$, $T_c = \\frac{8a}{27Rb}$, $P_c = \\frac{a}{27b^2}$.\n\nThe next step is to non-dimensionalize the EOS using the reduced variables:\n$\\hat{P} = \\frac{P}{P_c}$, $\\hat{T} = \\frac{T}{T_c}$, $\\hat{V} = \\frac{V}{V_c}$.\nThis means we can write the original variables as $P = \\hat{P}P_c$, $T = \\hat{T}T_c$, and $V = \\hat{V}V_c$. Substituting these into the van der Waals EOS:\n$$\n\\hat{P} P_{c} = \\frac{R (\\hat{T} T_{c})}{\\hat{V} V_{c} - b} - \\frac{a}{(\\hat{V} V_{c})^{2}}\n$$\nNow, substitute the expressions for $P_c$, $T_c$, and $V_c$:\n$$\n\\hat{P} \\left( \\frac{a}{27b^{2}} \\right) = \\frac{R \\hat{T} \\left( \\frac{8a}{27Rb} \\right)}{\\hat{V}(3b) - b} - \\frac{a}{(\\hat{V}(3b))^{2}}\n$$\n$$\n\\hat{P} \\left( \\frac{a}{27b^{2}} \\right) = \\frac{\\frac{8a\\hat{T}}{27b}}{b(3\\hat{V} - 1)} - \\frac{a}{9b^{2}\\hat{V}^{2}}\n$$\n$$\n\\hat{P} \\left( \\frac{a}{27b^{2}} \\right) = \\frac{8a\\hat{T}}{27b^{2}(3\\hat{V} - 1)} - \\frac{a}{9b^{2}\\hat{V}^{2}}\n$$\nTo solve for $\\hat{P}$, we can divide the entire equation by the common factor $\\frac{a}{27b^2}$:\n$$\n\\hat{P} = \\left( \\frac{8a\\hat{T}}{27b^{2}(3\\hat{V} - 1)} \\right) \\left( \\frac{27b^{2}}{a} \\right) - \\left( \\frac{a}{9b^{2}\\hat{V}^{2}} \\right) \\left( \\frac{27b^{2}}{a} \\right)\n$$\nSimplifying each term gives:\n$$\n\\hat{P} = \\frac{8\\hat{T}}{3\\hat{V} - 1} - \\frac{27}{9\\hat{V}^{2}}\n$$\nThis leads to the final reduced van der Waals Equation of State:\n$$\n\\hat{P} = \\frac{8\\hat{T}}{3\\hat{V} - 1} - \\frac{3}{\\hat{V}^{2}}\n$$\nThe resulting reduced EOS is a parameter-free expression relating the reduced variables $\\hat{P}$, $\\hat{V}$, and $\\hat{T}$. This exhibits the law of corresponding states for the van der Waals model. The reason it is parameter-free is that the substance-specific constants $a$ and $b$ have been absorbed into the definitions of the scaling factors $P_c$, $V_c$, and $T_c$. By scaling the state variables by their values at the critical point—a unique, characteristic point for any given substance—the resulting equation becomes universal for all substances described by the van der Waals model. It implies that at the same reduced temperature and reduced volume, all van der Waals fluids exert the same reduced pressure.",
            "answer": "$$\n\\boxed{\\frac{8\\hat{T}}{3\\hat{V} - 1} - \\frac{3}{\\hat{V}^{2}}}\n$$"
        },
        {
            "introduction": "While phenomenological equations of state are powerful, a deeper understanding comes from connecting macroscopic properties to microscopic intermolecular forces. This practice takes you to the heart of statistical mechanics, where you will use the Lennard-Jones potential—a canonical model for molecular interaction—to compute the second virial coefficient, $B(T)$ . This exercise demonstrates how fundamental theory, combined with numerical integration, allows us to predict the first-order deviation from ideal gas behavior directly from molecular parameters.",
            "id": "3951116",
            "problem": "You are given the Lennard–Jones 12–6 potential $u(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^6\\right]$ for a monatomic gas. Starting from first principles of the equilibrium statistical mechanics of a dilute gas, the second virial coefficient $B(T)$ is defined via the configurational integral involving the Mayer function. Your task is to derive a dimensionless form of the second virial coefficient for the Lennard–Jones potential and then compute its molar value $B_m(T)$ numerically for a set of physically realistic test cases.\n\nDerivation requirements:\n- Begin from the virial expansion for a dilute gas and the definition of the second virial coefficient in terms of the Mayer function $f(r)=\\exp\\left(-u(r)/k_B T\\right)-1$, where $k_B$ is the Boltzmann constant.\n- Convert the radial integral to spherical coordinates.\n- Introduce the nondimensionalization $x=r/\\sigma$ and the reduced temperature $T^\\star = k_B T/\\epsilon$. Show that $B(T)$ can be expressed as $B(T) = \\sigma^3 \\mathcal{I}(T^\\star)$ for an appropriate dimensionless integral $\\mathcal{I}(T^\\star)$.\n- Explain, based on the dimensionless form, how $\\epsilon$ (the energy scale) and $\\sigma$ (the length scale) control the magnitude and temperature dependence of $B(T)$.\n\nComputational requirements:\n- Implement a robust numerical quadrature to evaluate the dimensionless integral $\\mathcal{I}(T^\\star)$ on $x\\in[0,\\infty)$, paying attention to numerical stability of the integrand near $x\\to 0$ and $x\\to\\infty$. Use adaptive quadrature and domain splitting if needed. Convert the per-particle $B(T)$ to the molar second virial coefficient $B_m(T)$ using the Avogadro number $N_A$ and express $B_m(T)$ in $\\text{m}^3/\\text{mol}$.\n- Use the Boltzmann constant $k_B=1.380649\\times 10^{-23}\\ \\text{J/K}$ and the Avogadro number $N_A=6.02214076\\times 10^{23}\\ \\text{mol}^{-1}$.\n\nUnits and output specification:\n- All input physical parameters are in SI units: $\\epsilon$ in $\\text{J}$, $\\sigma$ in $\\text{m}$, and $T$ in $\\text{K}$.\n- The final answers must be the molar second virial coefficients $B_m(T)$ in $\\text{m}^3/\\text{mol}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each number must be printed in scientific notation with six significant digits (e.g., $\\text{1.234567e-03}$).\n\nTest suite:\nCompute $B_m(T)$ for the following cases that probe typical behavior, the vicinity of the Boyle temperature, extremes, and sensitivity to $\\epsilon$ and $\\sigma$:\n1. Baseline argon-like parameters at low temperature: $\\epsilon = k_B\\times 119.8\\ \\text{K}$, $\\sigma=3.405\\times 10^{-10}\\ \\text{m}$, $T=50\\ \\text{K}$.\n2. Baseline argon-like parameters at ambient temperature: $\\epsilon = k_B\\times 119.8\\ \\text{K}$, $\\sigma=3.405\\times 10^{-10}\\ \\text{m}$, $T=300\\ \\text{K}$.\n3. Baseline argon-like parameters near the Boyle temperature: $\\epsilon = k_B\\times 119.8\\ \\text{K}$, $\\sigma=3.405\\times 10^{-10}\\ \\text{m}$, $T=409\\ \\text{K}$.\n4. Baseline argon-like parameters at very high temperature: $\\epsilon = k_B\\times 119.8\\ \\text{K}$, $\\sigma=3.405\\times 10^{-10}\\ \\text{m}$, $T=5000\\ \\text{K}$.\n5. Sensitivity to $\\epsilon$ (weaker attraction): $\\epsilon = k_B\\times 59.9\\ \\text{K}$, $\\sigma=3.405\\times 10^{-10}\\ \\text{m}$, $T=300\\ \\text{K}$.\n6. Sensitivity to $\\sigma$ (smaller size): $\\epsilon = k_B\\times 119.8\\ \\text{K}$, $\\sigma=3.000\\times 10^{-10}\\ \\text{m}$, $T=300\\ \\text{K}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and in the specified format, for example: $[b_1,b_2,b_3,b_4,b_5,b_6]$, where each $b_i$ is a float with unit $\\text{m}^3/\\text{mol}$ printed in scientific notation with six significant digits.",
            "solution": "The user provides a valid problem statement from the field of computational thermal engineering, which will be solved by first deriving the necessary equations from first principles of statistical mechanics and then implementing a numerical solution in Python.\n\n### Part 1: Theoretical Derivation\n\nThe pressure $P$ of a dilute real gas can be expressed using the virial expansion in terms of the number density $\\rho = N/V$:\n$$\n\\frac{P V}{N k_B T} = 1 + B(T)\\rho + C(T)\\rho^2 + \\dots\n$$\nwhere $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $B(T)$, $C(T)$, etc., are the temperature-dependent second, third, etc., virial coefficients. These coefficients account for deviations from ideal gas behavior due to intermolecular interactions.\n\nFor a gas whose molecules interact via a spherically symmetric pair potential $u(r)$, the second virial coefficient $B(T)$ is given by the exact statistical mechanical result:\n$$\nB(T) = -\\frac{1}{2} \\int_0^\\infty f(r) \\, 4\\pi r^2 dr\n$$\nHere, $r$ is the intermolecular separation distance, and $f(r)$ is the Mayer function, defined as:\n$$\nf(r) = e^{-u(r)/(k_B T)} - 1\n$$\nThe problem specifies the Lennard-Jones (LJ) 12-6 potential:\n$$\nu(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right]\n$$\nwhere $\\epsilon$ is the depth of the potential well (energy scale) and $\\sigma$ is the finite distance at which the potential is zero (length scale).\n\nSubstituting the Mayer function definition into the expression for $B(T)$, we get:\n$$\nB(T) = -2\\pi \\int_0^\\infty \\left[ e^{-u(r)/(k_B T)} - 1 \\right] r^2 dr\n$$\nTo simplify this expression and reveal its underlying universal behavior, we introduce dimensionless variables. Let the reduced radial distance be $x = r/\\sigma$ and the reduced temperature be $T^\\star = k_B T / \\epsilon$.\nFrom $x = r/\\sigma$, we have $r = x\\sigma$ and $dr = \\sigma dx$.\nThe argument of the exponential, $u(r)/(k_B T)$, becomes:\n$$\n\\frac{u(r)}{k_B T} = \\frac{4\\epsilon}{k_B T} \\left[ \\left(\\frac{\\sigma}{x\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{x\\sigma}\\right)^6 \\right] = \\frac{4}{T^\\star} \\left( x^{-12} - x^{-6} \\right)\n$$\nNow, we substitute these dimensionless quantities into the integral for $B(T)$:\n$$\nB(T) = -2\\pi \\int_0^\\infty \\left[ \\exp\\left(-\\frac{4}{T^\\star} (x^{-12} - x^{-6})\\right) - 1 \\right] (x\\sigma)^2 (\\sigma dx)\n$$\nThe terms involving $\\sigma$ can be factored out of the integral:\n$$\nB(T) = -2\\pi \\sigma^3 \\int_0^\\infty \\left[ \\exp\\left(-\\frac{4}{T^\\star} (x^{-12} - x^{-6})\\right) - 1 \\right] x^2 dx\n$$\nThis result is of the form $B(T) = \\sigma^3 \\mathcal{I}(T^\\star)$, as required, where the dimensionless integral $\\mathcal{I}(T^\\star)$ is defined as:\n$$\n\\mathcal{I}(T^\\star) = -2\\pi \\int_0^\\infty \\left[ \\exp\\left(-\\frac{4}{T^\\star} (x^{-12} - x^{-6})\\right) - 1 \\right] x^2 dx\n$$\nThis dimensionless form elegantly demonstrates the principle of corresponding states for LJ fluids. The behavior of the second virial coefficient is universal when scaled appropriately:\n1.  **Role of $\\sigma$**: The term $\\sigma^3$ acts as a scaling factor for the volume. It is directly proportional to the \"excluded volume\" of a molecule. Thus, larger molecules (larger $\\sigma$) lead to a proportionally larger magnitude of the second virial coefficient, enhancing deviations from ideality.\n2.  **Role of $\\epsilon$**: The energy parameter $\\epsilon$ appears only within the reduced temperature $T^\\star = k_B T / \\epsilon$. This means $\\epsilon$ sets the characteristic temperature scale for the gas. The shape of the $B(T)$ versus $T$ curve is determined by the universal function $\\mathcal{I}(T^\\star)$, while $\\epsilon$ determines where a particular absolute temperature $T$ falls on this universal curve. A higher $\\epsilon$ (stronger attraction) means that higher absolute temperatures are needed to reach the same reduced state (e.g., the high-temperature limit or the Boyle temperature).\n\nFinally, the per-particle coefficient $B(T)$ is converted to the molar second virial coefficient $B_m(T)$ using the Avogadro number, $N_A$:\n$$\nB_m(T) = N_A B(T)\n$$\nThe final expression for the molar second virial coefficient to be computed is:\n$$\nB_m(T) = -2\\pi N_A \\sigma^3 \\int_0^\\infty \\left[ \\exp\\left(-\\frac{4}{T^\\star} (x^{-12} - x^{-6})\\right) - 1 \\right] x^2 dx\n$$\nThe units of $B_m(T)$ will be $\\text{mol}^{-1} \\cdot \\text{m}^3 = \\text{m}^3/\\text{mol}$, as required.\n\n### Part 2: Computational Strategy\n\nThe core of the computation is the numerical evaluation of the improper integral for $\\mathcal{I}(T^\\star)$. The integrand, let's call it $g(x; T^\\star) = \\left[ \\exp\\left(-\\frac{4}{T^\\star} (x^{-12} - x^{-6})\\right) - 1 \\right] x^2$, is well-behaved and can be handled robustly by standard adaptive quadrature routines, such as `scipy.integrate.quad`.\n\n-   **Behavior as $x \\to 0$**: The term $x^{-12}$ dominates, making the potential $u(r) \\to +\\infty$. Consequently, the term $\\exp(-u(r)/k_B T) \\to 0$. The integrand approaches $(0 - 1)x^2 = -x^2$, which is finite and integrable at $x=0$.\n-   **Behavior as $x \\to \\infty$**: Both $x^{-12}$ and $x^{-6}$ go to zero, so $u(r) \\to 0$. The exponential can be linearized, $\\exp(y) - 1 \\approx y$.\n    $$g(x; T^\\star) \\approx \\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] x^2 = -\\frac{4}{T^\\star}(x^{-10} - x^{-4})$$\n    The integrand decays as $x^{-4}$, which is integrable over $[a, \\infty)$ for any $a > 0$. `scipy.integrate.quad` is designed to handle such infinite integrals effectively.\n-   **Numerical Stability**: The maximum value of the exponent occurs at the minimum of the potential, $x = 2^{1/6}$, where its value is $1/T^\\star$. For the given test cases, the lowest $T^\\star$ is for Case 1 ($T=50$ K, $\\epsilon/k_B = 119.8$ K), giving $T^\\star = 50/119.8 \\approx 0.417$. The maximum exponent is $\\approx 1/0.417 \\approx 2.4$, which is well within the standard floating-point range, so no special overflow handling is required.\n\nThe implementation will consist of a function that takes $\\epsilon$, $\\sigma$, and $T$ as input, calculates $T^\\star$, defines the integrand, calls `scipy.integrate.quad` to evaluate the integral, and then combines the results to compute $B_m(T)$ according to the derived formula. This function will be called for each of the test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Derives and computes the molar second virial coefficient B_m(T) for a \n    Lennard-Jones gas based on first principles of statistical mechanics.\n    \"\"\"\n\n    # Physical constants in SI units\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n    N_A = 6.02214076e23 # Avogadro number in mol^-1\n\n    def lj_integrand(x, T_star):\n        \"\"\"\n        Calculates the integrand for the dimensionless second virial coefficient.\n        The integrand is: (exp(-u*(x)/T*) - 1) * x^2\n        where u*(x) = 4 * (x^-12 - x^-6).\n\n        Args:\n            x (float): The dimensionless distance, x = r/sigma.\n            T_star (float): The reduced temperature, T* = k_B*T/epsilon.\n        \n        Returns:\n            float: The value of the integrand at x.\n        \"\"\"\n        # Avoid division by zero at x=0. As x-0, the potential - +inf,\n        # exp - 0, so the integrand is (-1)*x^2, which is 0 at x=0.\n        if x == 0.0:\n            return 0.0\n\n        x_inv6 = x**-6\n        x_inv12 = x_inv6**2\n        \n        # Calculate the exponent term -u(r)/(k_B*T)\n        exponent = -4.0 / T_star * (x_inv12 - x_inv6)\n        \n        # The exponent is well-behaved for typical T_star values,\n        # so np.exp should not overflow with standard float64 precision.\n        \n        return (np.exp(exponent) - 1.0) * x**2\n\n    def calculate_Bm(epsilon, sigma, T):\n        \"\"\"\n        Calculates the molar second virial coefficient B_m(T).\n\n        Args:\n            epsilon (float): LJ energy parameter in Joules.\n            sigma (float): LJ length parameter in meters.\n            T (float): Absolute temperature in Kelvin.\n\n        Returns:\n            float: The molar second virial coefficient B_m(T) in m^3/mol.\n        \"\"\"\n        # Calculate the reduced temperature\n        T_star = k_B * T / epsilon\n\n        # Numerically integrate the dimensionless part of the integral\n        # The integral is over x from 0 to infinity.\n        integral_val, _ = quad(lj_integrand, 0, np.inf, args=(T_star,))\n\n        # Assemble the full expression for B_m(T)\n        # B_m(T) = N_A * B(T) = N_A * (-2*pi*sigma^3) * integral\n        B_m = -2.0 * np.pi * N_A * (sigma**3) * integral_val\n        \n        return B_m\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (epsilon in J, sigma in m, T in K)\n    test_cases = [\n        # 1. Baseline argon-like, low T\n        (k_B * 119.8, 3.405e-10, 50.0),\n        # 2. Baseline argon-like, ambient T\n        (k_B * 119.8, 3.405e-10, 300.0),\n        # 3. Baseline argon-like, near Boyle T\n        (k_B * 119.8, 3.405e-10, 409.0),\n        # 4. Baseline argon-like, high T\n        (k_B * 119.8, 3.405e-10, 5000.0),\n        # 5. Sensitivity to epsilon (weaker attraction)\n        (k_B * 59.9, 3.405e-10, 300.0),\n        # 6. Sensitivity to sigma (smaller size)\n        (k_B * 119.8, 3.000e-10, 300.0),\n    ]\n\n    results = []\n    # Process each test case\n    for epsilon, sigma, T in test_cases:\n        bm_value = calculate_Bm(epsilon, sigma, T)\n        # Format the result to scientific notation with 6 significant digits\n        results.append(f\"{bm_value:.6e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The behavior of multicomponent mixtures is central to many chemical engineering processes, with phase stability being a critical design question. This advanced practice challenges you to implement the definitive thermodynamic tool for this question: the tangent plane distance (TPD) criterion . By combining the robust Peng-Robinson equation of state with numerical optimization, you will build a computational model to determine whether a given mixture is stable or will spontaneously split into multiple phases, a core task in process simulation.",
            "id": "3951077",
            "problem": "You are given a multicomponent hydrocarbon mixture and must assess single-phase stability at specified thermodynamic conditions using the tangent plane distance (TPD) criterion constructed from fugacity coefficients obtained with the Peng–Robinson (PR) equation of state. Work entirely in terms of the molar Gibbs energy and the concept of fugacity, without shortcut formulas provided in the problem statement. The goal is to implement a computational method that decides whether a single-phase state is stable or will split into two phases, based on minimizing the TPD functional over candidate compositions.\n\nFundamental base to be used: the molar Gibbs energy at fixed pressure and temperature; chemical potentials as partial molar Gibbs energies; the definition of fugacity and fugacity coefficients; the Peng–Robinson equation of state for real gases with classical mixing rules; and the vapor-like compressibility factor root selection. You must implement these from first principles and scientifically sound assumptions, starting from the definition that a thermodynamic phase at fixed pressure and temperature is stable if the molar Gibbs energy is a convex function of composition, and unstable if a direction exists that lowers the Gibbs energy through phase splitting.\n\nPhysical specifications:\n- Components: methane, ethane, propane. Use the standard Peng–Robinson critical properties and acentric factors for these components with classical mixing rules.\n- Critical properties and acentric factors for each component $i$:\n  - Methane: $T_{c} = 190.56\\ \\mathrm{K}$, $P_{c} = 4.599\\times 10^{6}\\ \\mathrm{Pa}$, $\\omega = 0.011$.\n  - Ethane: $T_{c} = 305.32\\ \\mathrm{K}$, $P_{c} = 4.872\\times 10^{6}\\ \\mathrm{Pa}$, $\\omega = 0.099$.\n  - Propane: $T_{c} = 369.83\\ \\mathrm{K}$, $P_{c} = 4.248\\times 10^{6}\\ \\mathrm{Pa}$, $\\omega = 0.152$.\n- Binary interaction parameters (symmetric), used in the classical mixing $\\sqrt{a_{i} a_{j}}(1 - k_{ij})$: $k_{12} = 0.012$, $k_{13} = 0.015$, $k_{23} = 0.010$, and $k_{ii} = 0$.\n- Universal gas constant: $R = 8.314462618\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nComputational requirements and modeling assumptions:\n- Fugacity coefficients must be computed using the Peng–Robinson equation of state with classical mixing rules for $a$ and $b$ parameters. For the compressibility factor $Z$, use the vapor-like root selection, namely the largest real root of the PR cubic at the specified conditions.\n- The tangent plane distance functional must be minimized over candidate compositions subject to the mole fraction constraints. Assume a smooth parameterization that enforces $y_{i} \\ge 0$ and $\\sum_{i} y_{i} = 1$ without manual constraints.\n\nDecision criterion:\n- If the minimum TPD value at the specified conditions is negative, the single-phase state is unstable and will split into two phases; if it is nonnegative, the single-phase state is stable.\n\nUnits and output specification:\n- Temperature $T$ must be in $\\mathrm{K}$.\n- Pressure $P$ must be in $\\mathrm{Pa}$.\n- Mole fractions must be dimensionless and strictly positive for all components (no exact zeros).\n- Your program must compute, for each test case, the minimum TPD value and report these values in a single line. Express each minimum TPD value as a floating-point number rounded to six decimal places.\n\nTest suite:\n- Case $1$ (general vapor-like condition): $T = 320\\ \\mathrm{K}$, $P = 5.0\\times 10^{6}\\ \\mathrm{Pa}$, global composition $z = [0.7,\\,0.2,\\,0.1]$.\n- Case $2$ (near-condensation condition): $T = 220\\ \\mathrm{K}$, $P = 2.0\\times 10^{6}\\ \\mathrm{Pa}$, global composition $z = [0.4,\\,0.3,\\,0.3]$.\n- Case $3$ (high-pressure vapor-like condition): $T = 370\\ \\mathrm{K}$, $P = 1.2\\times 10^{7}\\ \\mathrm{Pa}$, global composition $z = [0.9,\\,0.05,\\,0.05]$.\n- Case $4$ (nearly pure component with strictly positive mole fractions): $T = 300\\ \\mathrm{K}$, $P = 4.0\\times 10^{6}\\ \\mathrm{Pa}$, global composition $z = [0.02,\\,0.97999,\\,0.00001]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the minimum TPD values for the four test cases as a comma-separated list enclosed in square brackets, rounded to six decimal places (for example, $[x_{1},x_{2},x_{3},x_{4}]$ where each $x_{k}$ is a float with six digits after the decimal point).",
            "solution": "The problem requires a rigorous thermodynamic stability analysis of a single-phase hydrocarbon mixture at specified conditions. The stability of a phase at constant temperature $T$ and pressure $P$ is determined by the convexity of its molar Gibbs energy, $G_m$, as a function of composition. A phase is stable if its $G_m$ surface is convex, meaning any line segment connecting two points on the surface lies entirely above the surface. If a tangent plane constructed at the point corresponding to the global composition $\\mathbf{z}$ lies entirely below the $G_m$ surface for all other possible compositions $\\mathbf{y}$, the phase is stable. If any part of the $G_m$ surface falls below this tangent plane, the phase is unstable and will split into two or more phases to achieve a lower overall Gibbs energy. The tangent plane distance (TPD) criterion is the direct mathematical formalization of this principle.\n\n### Thermodynamic Foundations\n\nThe TPD is the normalized vertical distance between the molar Gibbs energy surface at a trial composition $\\mathbf{y}$ and the tangent plane to that surface at the initial composition $\\mathbf{z}$. The TPD functional, expressed in dimensionless form by dividing by $RT$, is given by:\n$$\n\\text{TPD}(\\mathbf{y}) = \\frac{G_m(\\mathbf{y})}{RT} - \\frac{G_{m, \\text{tangent}}(\\mathbf{y})}{RT}\n$$\nThe equation for the tangent plane at $\\mathbf{z}$ is $G_{m, \\text{tangent}}(\\mathbf{y}) = \\sum_{i=1}^{N_c} y_i \\mu_i(\\mathbf{z})$, where $\\mu_i(\\mathbf{z})$ is the chemical potential of component $i$ in the mixture of composition $\\mathbf{z}$. Thus, the TPD functional becomes:\n$$\n\\text{TPD}(\\mathbf{y}) = \\frac{1}{RT} \\left( G_m(\\mathbf{y}) - \\sum_{i=1}^{N_c} y_i \\mu_i(\\mathbf{z}) \\right)\n$$\nThe chemical potential $\\mu_i$ is related to the fugacity $f_i$ by $\\mu_i = \\mu_i^{\\text{ref}} + RT \\ln(f_i/f_i^{\\text{ref}})$. Using this, the TPD functional can be expressed in terms of fugacities:\n$$\n\\text{TPD}(\\mathbf{y}) = \\sum_{i=1}^{N_c} y_i \\ln \\frac{f_i(\\mathbf{y})}{f_i(\\mathbf{z})}\n$$\nThe fugacity of a component $i$ in a mixture is defined as $f_i = y_i \\phi_i P$, where $\\phi_i$ is the fugacity coefficient. Substituting this definition into the TPD expression yields the form used for computation:\n$$\n\\text{TPD}(\\mathbf{y}) = \\sum_{i=1}^{N_c} y_i \\left( \\ln\\left(y_i \\phi_i(\\mathbf{y}) P\\right) - \\ln\\left(z_i \\phi_i(\\mathbf{z}) P\\right) \\right) = \\sum_{i=1}^{N_c} y_i \\left( \\ln y_i + \\ln \\phi_i(\\mathbf{y}) - \\ln z_i - \\ln \\phi_i(\\mathbf{z}) \\right)\n$$\nThe values $\\ln z_i$ and $\\ln \\phi_i(\\mathbf{z})$ are constant for a given problem. Let $d_i = \\ln z_i + \\ln \\phi_i(\\mathbf{z})$. The function to be minimized is:\n$$\n\\text{TPD}(\\mathbf{y}) = \\sum_{i=1}^{N_c} y_i \\left( \\ln y_i + \\ln \\phi_i(\\mathbf{y}) - d_i \\right)\n$$\nwhere summation is over all components $i=1, \\dots, N_c$. The fugacity coefficients $\\phi_i(\\mathbf{y})$ depend on the trial composition $\\mathbf{y}$ and must be recomputed at each step of the minimization. A stationary point is reached when the chemical potentials of the trial phase are equal to those of the feed phase, $\\mu_i(\\mathbf{y}) = \\mu_i(\\mathbf{z})$. At the trivial solution $\\mathbf{y} = \\mathbf{z}$, $\\text{TPD}(\\mathbf{z}) = 0$. If a non-trivial minimum with $\\text{TPD}(\\mathbf{y})  0$ is found, the original phase is unstable. Otherwise, it is stable or metastable.\n\n### The Peng–Robinson Equation of State (PR-EOS)\n\nThe fugacity coefficients are calculated using the Peng-Robinson Equation of State:\n$$\nP = \\frac{RT}{V_m - b} - \\frac{a(T)}{V_m(V_m+b) + b(V_m-b)}\n$$\nThe parameters $a_i$ and $b_i$ for each pure component $i$ are determined from its critical properties ($T_{ci}$, $P_{ci}$) and acentric factor ($\\omega_i$):\n$$\na_i = 0.45724 \\frac{R^2 T_{ci}^2}{P_{ci}}\n$$\n$$\nb_i = 0.07780 \\frac{R T_{ci}}{P_{ci}}\n$$\nThe temperature-dependent term $a(T)_i$ is given by $a(T)_i = a_i \\alpha_i(T)$, with\n$$\n\\alpha_i(T) = \\left[1 + \\kappa_i \\left(1 - \\sqrt{\\frac{T}{T_{ci}}}\\right)\\right]^2\n$$\n$$\n\\kappa_i = 0.37464 + 1.54226 \\omega_i - 0.26992 \\omega_i^2\n$$\nFor a mixture with mole fractions $\\mathbf{x} = (x_1, \\dots, x_{N_c})$, the classical mixing rules are applied:\n$$\na_{\\text{mix}} = \\sum_{i=1}^{N_c} \\sum_{j=1}^{N_c} x_i x_j \\sqrt{a_i(T) a_j(T)} (1 - k_{ij})\n$$\n$$\nb_{\\text{mix}} = \\sum_{i=1}^{N_c} x_i b_i\n$$\nIntroducing the dimensionless parameters $A = \\frac{a_{\\text{mix}} P}{(RT)^2}$ and $B = \\frac{b_{\\text{mix}} P}{RT}$, the PR-EOS can be written as a cubic equation for the compressibility factor $Z = PV_m/RT$:\n$$\nZ^3 - (1-B)Z^2 + (A - 2B - 3B^2)Z - (AB - B^2 - B^3) = 0\n$$\nAs per the problem specification, the largest real root of this cubic equation (the vapor-like root) is used for $Z$.\n\n### Fugacity Coefficients from the PR-EOS\n\nThe fugacity coefficient for component $k$ in the mixture is derived from the EOS and is given by:\n$$\n\\ln \\phi_k = \\frac{b_k}{b_{\\text{mix}}}(Z-1) - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\left( \\frac{2 \\sum_{j=1}^{N_c} x_j \\sqrt{a_k a_j}(1-k_{kj})}{a_{\\text{mix}}} - \\frac{b_k}{b_{\\text{mix}}} \\right) \\ln\\left(\\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B}\\right)\n$$\nwhere $a_k(T)$ is the temperature-dependent parameter of pure component $k$.\n\n### Computational Strategy\n\nThe solution involves a two-stage computational process for each test case.\n\n1.  **Feed Phase Characterization:** For the given feed composition $\\mathbf{z}$ at temperature $T$ and pressure $P$, we first compute all necessary properties. This involves calculating the mixture parameters $a_{\\text{mix}}(\\mathbf{z})$ and $b_{\\text{mix}}(\\mathbf{z})$, solving for the compressibility factor $Z(\\mathbf{z})$, and then computing the fugacity coefficients $\\phi_i(\\mathbf{z})$ for all components. These values are used to determine the constant terms $d_i = \\ln z_i + \\ln \\phi_i(\\mathbf{z})$ in the TPD functional.\n\n2.  **TPD Minimization:** The core of the task is to find the minimum value of the TPD functional over all possible trial compositions $\\mathbf{y}$. This is a constrained optimization problem, as mole fractions must satisfy $y_i > 0$ and $\\sum y_i = 1$. To handle these constraints, we introduce a set of $N_c-1$ unconstrained variables, $X_1, \\dots, X_{N_c-1}$, and use a smooth mapping to transform them into valid mole fractions. A robust choice is a variant of the softmax function: let $X_{N_c}=0$, then\n    $$\n    y_i = \\frac{\\exp(X_i)}{\\sum_{j=1}^{N_c} \\exp(X_j)}\n    $$\n    This transformation ensures that $y_i$ are always positive and sum to one. The minimization is then performed with respect to the unconstrained variables $\\mathbf{X}$ using a quasi-Newton method (e.g., BFGS) provided by `scipy.optimize.minimize`.\n\n    The TPD surface can be complex with multiple local minima. To increase the likelihood of finding the global minimum, the optimization is initiated from several different starting points. A judicious choice for these initial guesses are compositions close to the pure components, as these represent the vertices of the composition space where a new phase is likely to nucleate. For a three-component system, initial guesses corresponding to nearly pure methane, ethane, and propane are used. The lowest TPD value found among all optimization runs is taken as the final result. If this value is negative, the phase is declared unstable.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the phase stability problem using the tangent plane distance (TPD)\n    criterion with the Peng-Robinson (PR) equation of state.\n    \"\"\"\n    # Universal gas constant in J/(mol K)\n    R = 8.314462618\n\n    # Component properties: name, Tc (K), Pc (Pa), omega\n    components_data = {\n        'methane': {'Tc': 190.56, 'Pc': 4.599e6, 'omega': 0.011},\n        'ethane': {'Tc': 305.32, 'Pc': 4.872e6, 'omega': 0.099},\n        'propane': {'Tc': 369.83, 'Pc': 4.248e6, 'omega': 0.152},\n    }\n    comp_names = list(components_data.keys())\n    num_components = len(comp_names)\n\n    # Binary interaction parameters (kij)\n    kij = np.array([\n        [0.0,   0.012, 0.015],  # Methane\n        [0.012, 0.0,   0.010],  # Ethane\n        [0.015, 0.010, 0.0]    # Propane\n    ])\n\n    test_cases = [\n        # T (K), P (Pa), z (mole fractions)\n        (320.0, 5.0e6, np.array([0.7, 0.2, 0.1])),\n        (220.0, 2.0e6, np.array([0.4, 0.3, 0.3])),\n        (370.0, 1.2e7, np.array([0.9, 0.05, 0.05])),\n        (300.0, 4.0e6, np.array([0.02, 0.97999, 0.00001])),\n    ]\n\n    # Pre-calculate pure component parameters\n    Tc = np.array([v['Tc'] for v in components_data.values()])\n    Pc = np.array([v['Pc'] for v in components_data.values()])\n    omega = np.array([v['omega'] for v in components_data.values()])\n\n    kappa = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n    a_c = 0.45724 * (R * Tc)**2 / Pc\n    b_i = 0.07780 * R * Tc / Pc\n\n    def get_eos_properties(T, P, x):\n        \"\"\"Calculates EOS parameters A, B, Z, and ln(phi) for a given state.\"\"\"\n        # Ensure composition is a numpy array\n        x = np.array(x)\n\n        # Temperature-dependent 'a' parameter for pure components\n        Tr = T / Tc\n        alpha = (1 + kappa * (1 - np.sqrt(Tr)))**2\n        a_i_T = a_c * alpha\n\n        # Mixture 'a' and 'b' parameters using classical mixing rules\n        a_ij = np.outer(a_i_T, a_i_T)**0.5 * (1 - kij)\n        a_mix = x @ a_ij @ x\n        b_mix = x @ b_i\n\n        # Dimensionless PR parameters A and B\n        A = a_mix * P / (R * T)**2\n        B = b_mix * P / (R * T)\n\n        # Solve cubic equation for Z\n        coeffs = [1, -(1 - B), (A - 2 * B - 3 * B**2), -(A * B - B**2 - B**3)]\n        roots = np.roots(coeffs)\n        real_roots = roots[np.isreal(roots)].real\n        \n        # Select the vapor-like root (largest real root)\n        Z = np.max(real_roots) if len(real_roots) > 0 else -1\n        if Z = 0: # Physicality check\n            return None\n\n        # Fugacity coefficient calculation\n        # Sum term for ln(phi)\n        sum_a_ij_xj = a_ij @ x\n\n        term1 = b_i / b_mix * (Z - 1)\n        term2 = -np.log(Z - B) # Scipy uses natural log\n        \n        # Avoid division by zero if B is very small\n        if np.abs(B)  1e-12:\n           log_term_val = 0\n        else:\n           log_term_val = np.log((Z + (1 + np.sqrt(2)) * B) / (Z + (1 - np.sqrt(2)) * B))\n\n        term3_factor = A / (2 * np.sqrt(2) * B) if np.abs(B) > 1e-12 else 0\n        term3_inner = (2 * sum_a_ij_xj / a_mix) - (b_i / b_mix)\n        term3 = -term3_factor * term3_inner * log_term_val\n        \n        ln_phi = term1 + term2 + term3\n\n        return {'A': A, 'B': B, 'Z': Z, 'ln_phi': ln_phi}\n\n    def tpd_objective_function(X_vars, d_i_feed, T, P):\n        \"\"\"\n        Objective function for TPD minimization.\n        X_vars: Unconstrained variables for trial composition y.\n        d_i_feed: ln(z_i) + ln(phi_i(z)) for the feed phase.\n        T, P: Temperature and Pressure.\n        \"\"\"\n        # Transform unconstrained variables X to mole fractions y via softmax\n        X_full = np.append(X_vars, 0.0)\n        exp_X = np.exp(X_full)\n        y = exp_X / np.sum(exp_X)\n\n        # Handle cases where y has components very close to zero\n        if np.any(y  1e-12):\n            return 1e6 # Return a large number to steer optimizer away\n\n        # Calculate properties of the trial phase y\n        props_y = get_eos_properties(T, P, y)\n        if props_y is None:\n            return 1e6 # Return a large number if phase is non-physical\n\n        ln_phi_y = props_y['ln_phi']\n        \n        # Calculate TPD value\n        tpd = np.sum(y * (np.log(y) + ln_phi_y - d_i_feed))\n        return tpd\n\n    results = []\n    # Main loop over test cases\n    for T, P, z in test_cases:\n        # 1. Characterize the feed phase\n        props_z = get_eos_properties(T, P, z)\n        if props_z is None:\n            # Should not happen for given test cases\n            results.append(np.nan)\n            continue\n        \n        ln_phi_z = props_z['ln_phi']\n        d_i_feed = np.log(z) + ln_phi_z\n\n        # 2. Minimize the TPD function\n        min_tpd_found = 0.0\n        \n        # Initial guesses for unconstrained variables X, corresponding to\n        # trial compositions y near pure components.\n        # For 3 components, we have 2 variables X1, X2.\n        # X3 is fixed to 0.\n        # y1 ~ exp(X1), y2 ~ exp(X2), y3 ~ exp(0)=1\n        initial_guesses = [\n            np.array([10.0, 0.0]),      # Near component 1 (Methane)\n            np.array([0.0, 10.0]),      # Near component 2 (Ethane)\n            np.array([-10.0, -10.0]), # Near component 3 (Propane)\n        ]\n\n        for x0 in initial_guesses:\n            res = optimize.minimize(\n                tpd_objective_function,\n                x0,\n                args=(d_i_feed, T, P),\n                method='BFGS',\n                tol=1e-9\n            )\n            # TPD is by definition >= 0 for a stable phase, and its minimum at y=z is 0.\n            # We seek a negative minimum. res.fun can be a very small positive number\n            # due to numerical precision, which should be treated as zero.\n            if res.fun  min_tpd_found:\n                min_tpd_found = res.fun\n        \n        # Round very small positive values to 0 for stability\n        if min_tpd_found > -1e-9:\n             min_tpd_found = 0.0\n\n        results.append(min_tpd_found)\n\n    # Format and print the final results\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}