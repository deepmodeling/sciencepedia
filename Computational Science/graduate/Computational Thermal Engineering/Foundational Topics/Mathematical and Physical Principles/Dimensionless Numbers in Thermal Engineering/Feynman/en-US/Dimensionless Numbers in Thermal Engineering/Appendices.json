{
    "hands_on_practices": [
        {
            "introduction": "Rayleigh-Bénard convection is a classic paradigm for understanding the onset of natural convection. This exercise guides you through a linear stability analysis to determine the critical Rayleigh number ($Ra_c$), the dimensionless threshold at which a fluid layer heated from below transitions from a state of pure conduction to convective motion . By deriving $Ra_c$ for idealized free-slip boundaries and comparing it to the case with realistic no-slip boundaries, you will gain a first-principles appreciation for how this crucial dimensionless number emerges from the governing equations and dictates the stability of a thermal system.",
            "id": "3946574",
            "problem": "Consider an infinite horizontal layer of a Newtonian fluid of thickness $H$, heated from below with a fixed temperature difference $\\Delta T$ between the bottom and top surfaces. Assume the Boussinesq approximation holds, the base state is purely conductive, and the boundaries are perfectly thermally conducting so that the temperature perturbation vanishes at the boundaries. Let the dimensionless vertical coordinate be $z \\in [0,1]$, and nondimensionalize lengths by $H$, time by $H^{2}/\\alpha$, velocity by $\\alpha/H$, and temperature perturbations by $\\Delta T$, where $\\alpha$ is the thermal diffusivity.\n\n- Under the Boussinesq approximation, start from the linearized, nondimensional governing equations for infinitesimal perturbations to the conductive base state in terms of the dimensionless velocity field $\\boldsymbol{u}$, pressure $p$, and temperature perturbation $\\theta$. Use a normal mode ansatz with horizontal wavenumber magnitude $a$ and growth rate $\\sigma$ to obtain a one-dimensional eigenvalue problem in $z$ that determines the neutral stability condition ($\\sigma = 0$) at the onset of convection.\n\n- For mechanically free–free (stress-free) boundaries at $z=0$ and $z=1$, impose the kinematic conditions appropriate to stress-free surfaces, and the thermal boundary condition $\\theta=0$ at both boundaries. Using these boundary conditions, determine the neutral stability relationship $Ra(a)$ between the Rayleigh number $Ra$ and the horizontal wavenumber $a$. Then, find the critical Rayleigh number $Ra_{c,\\text{FF}}$ for the onset of convection by minimizing $Ra(a)$ over $a0$ and provide the exact analytical expression for $Ra_{c,\\text{FF}}$.\n\n- For mechanically rigid–rigid (no-slip) boundaries with the same thermal boundary conditions, the corresponding linear eigenvalue problem does not admit a simple closed-form analytical neutral curve, but its critical Rayleigh number is known numerically. Use the known value $Ra_{c,\\text{RR}} = 1707.76$ from numerical solution of the no-slip boundary eigenvalue problem.\n\nCompute the ratio\n$$\\chi = \\frac{Ra_{c,\\text{RR}}}{Ra_{c,\\text{FF}}}$$\nand report $\\chi$ rounded to four significant figures. The final answer must be this single real-valued number. Since the Rayleigh number is dimensionless, no units are required.",
            "solution": "The problem requires the calculation of the ratio of critical Rayleigh numbers for the onset of convection in a fluid layer heated from below, for two different sets of mechanical boundary conditions: rigid-rigid and free-free.\n\nFirst, we establish the governing equations. The linearized, nondimensional Boussinesq equations for perturbations to a quiescent, conductive base state are given by:\nContinuity:\n$$ \\nabla \\cdot \\boldsymbol{u} = 0 $$\nMomentum:\n$$ \\frac{1}{\\text{Pr}} \\frac{\\partial \\boldsymbol{u}}{\\partial t} = -\\nabla p + \\nabla^2 \\boldsymbol{u} + \\text{Ra} \\, \\theta \\, \\hat{\\boldsymbol{k}} $$\nEnergy:\n$$ \\frac{\\partial \\theta}{\\partial t} = w + \\nabla^2 \\theta $$\nHere, $\\boldsymbol{u} = (u,v,w)$ is the dimensionless velocity perturbation, $p$ is the pressure perturbation, $\\theta$ is the temperature perturbation, $\\text{Ra}$ is the Rayleigh number, $\\text{Pr}$ is the Prandtl number, and $\\hat{\\boldsymbol{k}}$ is the unit vector in the vertical direction, $z$.\n\nWe analyze the stability by introducing normal modes for the variables. We seek solutions of the form:\n$$ (w, \\theta) = (W(z), \\Theta(z)) \\exp(i(k_x x + k_y y) + \\sigma t) $$\nwhere $a = \\sqrt{k_x^2 + k_y^2}$ is the magnitude of the horizontal wavenumber and $\\sigma$ is the growth rate. The operators $\\nabla^2$ and the horizontal Laplacian $\\nabla_h^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ transform as:\n$$ \\nabla^2 \\rightarrow D^2 - a^2 \\quad \\text{and} \\quad \\nabla_h^2 \\rightarrow -a^2 $$\nwhere $D = d/dz$.\n\nTo simplify the system, we eliminate the horizontal velocity components $u$, $v$, and the pressure $p$. Applying the operator $\\hat{\\boldsymbol{k}} \\cdot (\\nabla \\times \\nabla \\times \\cdot)$ to the momentum equation and using the continuity equation results in an equation for the vertical velocity component $w$. This yields a coupled system of equations for $w$ and $\\theta$:\n$$ \\frac{1}{\\text{Pr}} \\frac{\\partial}{\\partial t}(\\nabla^2 w) = \\nabla^4 w + \\text{Ra} \\, \\nabla_h^2 \\theta $$\n$$ \\frac{\\partial \\theta}{\\partial t} = w + \\nabla^2 \\theta $$\nSubstituting the normal mode forms into these equations gives two ordinary differential equations for the amplitudes $W(z)$ and $\\Theta(z)$:\n$$ \\frac{\\sigma}{\\text{Pr}} (D^2 - a^2)W = (D^2 - a^2)^2 W - \\text{Ra} \\, a^2 \\Theta $$\n$$ \\sigma \\Theta = W + (D^2 - a^2) \\Theta $$\nWe are interested in the condition of neutral stability, which marks the onset of convection. This corresponds to the case where the growth rate $\\sigma$ is zero. Setting $\\sigma=0$ simplifies the system to:\n$$ (D^2 - a^2)^2 W = \\text{Ra} \\, a^2 \\Theta $$\n$$ W = -(D^2 - a^2) \\Theta $$\nWe can combine these two equations to get a single sixth-order ODE for $W(z)$:\n$$ (D^2 - a^2)^3 W + \\text{Ra} \\, a^2 W = 0 $$\nThis is the eigenvalue problem for the Rayleigh number $\\text{Ra}$.\n\nFor the case of free-free boundaries at $z=0$ and $z=1$, the boundary conditions are:\n1.  No vertical velocity at the boundaries: $w=0 \\implies W(0)=W(1)=0$.\n2.  Perfectly conducting boundaries: $\\theta=0 \\implies \\Theta(0)=\\Theta(1)=0$.\n3.  Stress-free (zero tangential stress) surfaces: $\\frac{\\partial u}{\\partial z} = \\frac{\\partial v}{\\partial z} = 0$. This condition can be shown to be equivalent to $\\frac{\\partial^2 w}{\\partial z^2}=0$ at the boundaries, so $D^2W(0)=D^2W(1)=0$.\n\nFrom the relationships between $W$ and $\\Theta$, these conditions imply that $W, D^2W, D^4W, \\dots$ are all zero at the boundaries. The simplest non-trivial eigenfunction satisfying these boundary conditions is of the form $W(z) = A \\sin(n\\pi z)$ for an integer $n \\geq 1$.\n\nNow we substitute $W(z) \\propto \\sin(n\\pi z)$ into the governing ODE. For this eigenfunction, $D^2W = -(n\\pi)^2 W$. The operator $(D^2 - a^2)$ acts as a simple multiplicative constant: $(-(n\\pi)^2 - a^2)$. The ODE becomes an algebraic equation for the eigenvalue $\\text{Ra}$:\n$$ ((-(n\\pi)^2 - a^2))^3 + \\text{Ra} \\, a^2 = 0 $$\n$$ -((n\\pi)^2 + a^2)^3 + \\text{Ra} \\, a^2 = 0 $$\n$$ \\text{Ra}(a, n) = \\frac{((n\\pi)^2 + a^2)^3}{a^2} $$\nThe onset of convection corresponds to the lowest possible Rayleigh number. This occurs for the lowest possible value of $n$, which is $n=1$. So we consider:\n$$ \\text{Ra}(a) = \\frac{(\\pi^2 + a^2)^3}{a^2} $$\nTo find the critical Rayleigh number, we must minimize $\\text{Ra}(a)$ with respect to the horizontal wavenumber $a$. We compute the derivative and set it to zero:\n$$ \\frac{d\\text{Ra}}{da} = \\frac{3(\\pi^2+a^2)^2(2a)(a^2) - (\\pi^2+a^2)^3(2a)}{a^4} = 0 $$\nFor $a>0$ and $\\pi^2+a^2 \\neq 0$, we can simplify this to:\n$$ 3a^2(\\pi^2+a^2)^2 = (\\pi^2+a^2)^3 $$\n$$ 3a^2 = \\pi^2 + a^2 $$\n$$ 2a^2 = \\pi^2 \\implies a_c^2 = \\frac{\\pi^2}{2} $$\nThe critical wavenumber is $a_c = \\pi/\\sqrt{2}$. Substituting this value back into the expression for $\\text{Ra}(a)$ gives the critical Rayleigh number for free-free boundaries, $\\text{Ra}_{c,\\text{FF}}$:\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{(\\pi^2 + \\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^4}{4} $$\nThis is the exact analytical expression for $\\text{Ra}_{c,\\text{FF}}$.\n\nThe problem provides the numerically computed critical Rayleigh number for rigid-rigid boundaries:\n$$ \\text{Ra}_{c,\\text{RR}} = 1707.76 $$\nWe can now compute the ratio $\\chi$:\n$$ \\chi = \\frac{\\text{Ra}_{c,\\text{RR}}}{\\text{Ra}_{c,\\text{FF}}} = \\frac{1707.76}{\\frac{27\\pi^4}{4}} $$\nFirst, we calculate the numerical value of $\\text{Ra}_{c,\\text{FF}}$:\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{27}{4}\\pi^4 \\approx 6.75 \\times (3.14159265...)^4 \\approx 6.75 \\times 97.409091... \\approx 657.51136... $$\nNow, the ratio is:\n$$ \\chi = \\frac{1707.76}{657.51136...} \\approx 2.597305... $$\nRounding this value to four significant figures gives:\n$$ \\chi \\approx 2.597 $$",
            "answer": "$$\\boxed{2.597}$$"
        },
        {
            "introduction": "The relationship between momentum and thermal transport is governed by the Prandtl number ($Pr$), but its influence on heat transfer scaling is not always straightforward. This practice challenges you to use matched asymptotic analysis to derive the scaling laws for forced convection over a flat plate in two distinct physical regimes: fluids where $Pr \\sim 1$ (like air) and fluids where $Pr \\ll 1$ (like liquid metals) . This exercise illuminates how the relative thickness of the velocity and thermal boundary layers fundamentally alters the heat transfer mechanism, providing a deep justification for the different empirical correlations used in practice.",
            "id": "3946643",
            "problem": "Consider steady, two-dimensional, laminar forced convection of an incompressible fluid of constant properties with free-stream velocity $U_{\\infty}$ flowing over an isothermal, semi-infinite flat plate at wall temperature $T_{w}$ with free-stream temperature $T_{\\infty}$. Let the kinematic viscosity be $\\nu$, the thermal diffusivity be $\\alpha$, and the thermal conductivity be $k$. Under boundary-layer conditions (negligible streamwise diffusion in momentum and energy, negligible pressure gradient), the governing boundary-layer equations are\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0,\n$$\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^{2} u}{\\partial y^{2}},\n$$\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}},\n$$\nwith boundary conditions $u(x,0)=0$, $T(x,0)=T_{w}$, $u(x,y\\to\\infty)=U_{\\infty}$, $T(x,y\\to\\infty)=T_{\\infty}$.\n\nDefine the Reynolds number $Re_{x} = \\frac{U_{\\infty} x}{\\nu}$, the Prandtl number $Pr = \\frac{\\nu}{\\alpha}$, and the local Nusselt number $Nu_{x} = \\frac{h_{x} x}{k}$, where $h_{x}$ is the local convective heat transfer coefficient. You may use the well-tested Blasius scaling for the velocity boundary-layer thickness $\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}$ and the near-wall linear shear approximation $u \\approx a\\,y$ with $a \\sim \\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0} \\sim \\frac{U_{\\infty}}{\\delta_{v}}$ where appropriate.\n\nUsing matched asymptotic analysis between the inner region ($y = \\mathcal{O}(\\delta_{v})$) and the outer thermal region ($y = \\mathcal{O}(\\delta_{T})$), determine how the scaling exponents in the canonical form\n$$\nNu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}\n$$\nmust change when going from a fluid with $Pr \\approx 0.7$ (air, $Pr = \\mathcal{O}(1)$) to a liquid metal with $Pr \\approx 0.01$ ($Pr \\ll 1$). Here $K$ is a dimensionless constant that may differ between regimes but should not be evaluated; the task is to deduce the exponents $a$ and $b$ by dominant-balance arguments and asymptotic matching of inner and outer solutions.\n\nAssume $Re_{x}$ is sufficiently large that a laminar boundary layer exists and streamwise conduction is negligible in the energy equation. Do not use empirical heat transfer correlations; derive the dependence from the boundary-layer equations and asymptotic matching. Express your final answer as the ordered quadruple of exponents $\\left(a_{\\text{air}},\\,b_{\\text{air}},\\,a_{\\text{metal}},\\,b_{\\text{metal}}\\right)$ in a single row matrix. No numerical rounding is required, and the exponents should be given in exact fractional form without units.",
            "solution": "The objective is to determine the scaling exponents $a$ and $b$ in the relation $Nu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}$ for two distinct regimes of the Prandtl number, $Pr \\sim \\mathcal{O}(1)$ and $Pr \\ll 1$.\n\nThe local Nusselt number, $Nu_{x}$, is defined as $Nu_{x} = \\frac{h_{x} x}{k}$, where $h_x$ is the local heat transfer coefficient. This coefficient is defined through Newton's law of cooling, $q''_{w} = h_{x}(T_{w} - T_{\\infty})$, where $q''_{w}$ is the heat flux at the wall, given by Fourier's law: $q''_{w} = -k \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0}$. This leads to a scaling estimate for the Nusselt number in terms of the thermal boundary layer thickness, $\\delta_{T}$:\n$$\nNu_{x} \\sim \\frac{x}{\\delta_{T}}\n$$\nThus, the problem reduces to determining the scaling of $\\delta_{T}(x)$ for the two Prandtl number regimes.\n\n**Case 1: Fluid with $Pr = \\mathcal{O}(1)$ (e.g., air)**\nIn this regime, the kinematic viscosity $\\nu$ and the thermal diffusivity $\\alpha$ are of the same order of magnitude ($Pr = \\nu/\\alpha \\sim 1$). This implies that momentum and heat diffuse away from the plate at comparable rates. Consequently, the thickness of the velocity boundary layer, $\\delta_{v}$, and the thermal boundary layer, $\\delta_{T}$, are of the same order: $\\delta_{T} \\sim \\delta_{v}$.\n\nThe problem provides the well-known Blasius scaling for the laminar velocity boundary layer:\n$$\n\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}\n$$\nSince $\\delta_{T} \\sim \\delta_{v}$ for $Pr \\sim 1$, the thermal boundary layer thickness has the same scaling: $\\delta_{T}(x) \\sim x\\,Re_{x}^{-1/2}$. Substituting this into our scaling for the Nusselt number:\n$$\nNu_{x} \\sim \\frac{x}{\\delta_{T}} \\sim \\frac{x}{x\\,Re_{x}^{-1/2}} = Re_{x}^{1/2}\n$$\nThis gives the exponent $a_{\\text{air}} = 1/2$. The dependence on the Prandtl number is more subtle. A detailed analysis using a full similarity solution (the Pohlhausen solution) shows that for $Pr \\gtrsim 0.6$, the relationship is best described by $Nu_{x} \\propto Re_{x}^{1/2} Pr^{1/3}$. We adopt this established theoretical result, yielding $b_{\\text{air}} = 1/3$.\nThus, for $Pr \\sim \\mathcal{O}(1)$, the scaling exponents are $(a_{\\text{air}}, b_{\\text{air}}) = (\\frac{1}{2}, \\frac{1}{3})$.\n\n**Case 2: Liquid metal with $Pr \\ll 1$**\nFor a liquid metal, the Prandtl number is very small, $Pr = \\nu/\\alpha \\ll 1$. This implies that the thermal diffusivity is much larger than the momentum diffusivity ($\\alpha \\gg \\nu$), so heat diffuses much more rapidly and farther into the flow than momentum. This results in a thermal boundary layer that is significantly thicker than the velocity boundary layer: $\\delta_{T} \\gg \\delta_{v}$.\n\nThis physical picture is ideal for a matched asymptotic analysis. For the bulk of the thermal boundary layer, which extends far beyond the thin velocity boundary layer, the fluid velocity has already reached its free-stream value, so we can approximate $u(x,y) \\approx U_{\\infty}$. The energy equation is:\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}\n$$\nApproximating $u \\approx U_{\\infty}$ and noting that $v$ is small, the dominant balance in the energy equation is between streamwise advection and wall-normal diffusion:\n$$\nU_{\\infty} \\frac{\\partial T}{\\partial x} \\approx \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}\n$$\nWe now perform a scaling analysis on this simplified equation. Let the characteristic length scales be $x$ in the streamwise direction and $\\delta_T$ in the wall-normal direction. The terms scale as:\n$$\nU_{\\infty} \\frac{|T_w - T_\\infty|}{x} \\sim \\alpha \\frac{|T_w - T_\\infty|}{\\delta_{T}^{2}}\n$$\nSolving for the thermal boundary layer thickness $\\delta_{T}$:\n$$\n\\delta_{T}^{2} \\sim \\frac{\\alpha x}{U_{\\infty}} \\implies \\delta_{T} \\sim \\sqrt{\\frac{\\alpha x}{U_{\\infty}}}\n$$\nTo express this in terms of dimensionless numbers, we introduce $Re_x$ and $Pr$:\n$$\n\\delta_{T} \\sim \\sqrt{\\frac{\\alpha x}{U_{\\infty}}} = \\sqrt{\\frac{\\nu x}{U_{\\infty}} \\cdot \\frac{\\alpha}{\\nu}} = \\sqrt{\\frac{x^2}{Re_x} \\cdot \\frac{1}{Pr}} = x \\, Re_{x}^{-1/2} \\, Pr^{-1/2}\n$$\nThis result is consistent with our initial assumption that $\\delta_{T} \\gg \\delta_{v}$, since $\\frac{\\delta_{T}}{\\delta_{v}} \\sim Pr^{-1/2} \\gg 1$ for $Pr \\ll 1$.\nNow, we find the scaling for the Nusselt number using $Nu_{x} \\sim x/\\delta_{T}$:\n$$\nNu_{x} \\sim \\frac{x}{x \\, Re_{x}^{-1/2} \\, Pr^{-1/2}} = Re_{x}^{1/2} \\, Pr^{1/2}\n$$\nThis gives the scaling exponents for the low-Prandtl-number regime: $(a_{\\text{metal}}, b_{\\text{metal}}) = (\\frac{1}{2}, \\frac{1}{2})$.\n\n**Summary of Exponents**\nThe final ordered quadruple is $(a_{\\text{air}},\\,b_{\\text{air}},\\,a_{\\text{metal}},\\,b_{\\text{metal}}) = (\\frac{1}{2},\\,\\frac{1}{3},\\,\\frac{1}{2},\\,\\frac{1}{2})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{3}  \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Dimensionless numbers are as critical in computational practice as they are in theoretical analysis. This exercise bridges theory and application by focusing on the numerical simulation of transient heat conduction, where the dimensionless timestep, or Fourier number ($\\Delta Fo$), plays a central role . You will perform a Fourier analysis to connect $\\Delta Fo$ to numerical stability and accuracy, ultimately designing a practical timestep control strategy that balances computational cost with the physical fidelity of the simulation.",
            "id": "3946581",
            "problem": "Consider one-dimensional transient conduction in a homogeneous slab of length $L$ with Dirichlet boundary conditions and a smooth initial temperature field $u(x,0)$ that can be decomposed into spatial Fourier modes. The governing equation is the heat equation $u_t = \\alpha u_{xx}$, where $\\alpha$ is the thermal diffusivity. Discretize space using a uniform grid with $n_x$ nodes and spacing $\\Delta x = L/(n_x-1)$. Discretize time using the Crank–Nicolson (CN) method, which is an implicit second-order accurate scheme in time. Denote the dimensionless timestep (Fourier number) by $\\Delta Fo = \\alpha \\Delta t/\\Delta x^2$, where $\\Delta t$ is the physical timestep.\n\nYour tasks are:\n- Starting from the heat equation and the Crank–Nicolson update applied to the standard second-order centered spatial discretization, perform a Fourier (von Neumann) mode analysis to obtain the amplification factor per timestep. From this, deduce the precise relationship between $\\Delta Fo$ and stability. Explain in particular the condition under which the amplification factor remains nonnegative for all resolvable spatial modes.\n- Using the exact semi-discrete evolution $u(t+\\Delta t) = \\exp\\!\\big( (\\alpha \\Delta t/\\Delta x^2)\\,L \\big)\\,u(t)$ with $L$ the discrete Laplacian operator, compare the CN amplification with the exact exponential amplification to determine the leading-order global error dependence on $\\Delta Fo$ over a fixed physical time horizon $t_f$. Derive a conservative bound on $\\Delta Fo$ in terms of a target dimensionless relative amplitude tolerance $\\varepsilon$ that ensures the CN solution’s modal amplitudes deviate from the exact semi-discrete evolution by no more than $\\varepsilon$ at time $t_f$.\n- Design a timestep control strategy that, given $L$, $n_x$, $\\alpha$, $t_f$, and $\\varepsilon$, computes a recommended $\\Delta Fo^\\star$ that simultaneously satisfies your monotonicity constraint and your accuracy requirement over $[0,t_f]$ for all resolvable spatial modes. The control strategy must be expressed as a function of these inputs only and must not depend on the actual initial condition.\n\nImplement a program that, for each test case, computes and outputs the single floating-point value $\\Delta Fo^\\star$ returned by your control strategy. Each output value must be rounded to six decimal places. The spatial grid spacing used in your strategy must be $\\Delta x = L/(n_x-1)$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[0.123000,0.500000]$). No other output is permitted.\n\nUse the following scientifically plausible test suite, with all quantities in International System of Units (SI) where applicable:\n- Test case $1$ (general case): $\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 2.0\\,\\mathrm{s}$, $\\varepsilon = 1.0\\times 10^{-3}$.\n- Test case $2$ (monotonicity-limited): $\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 0.1\\,\\mathrm{s}$, $\\varepsilon = 1.0$.\n- Test case $3$ (boundary condition where monotonicity and accuracy limits coincide): $\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 0.1\\,\\mathrm{s}$, $\\varepsilon = 1/3$.\n- Test case $4$ (fine spatial resolution): $\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 201$, $t_f = 2.0\\,\\mathrm{s}$, $\\varepsilon = 1.0\\times 10^{-3}$.\n- Test case $5$ (higher thermal diffusivity and stricter tolerance): $\\alpha = 1.0\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 2.0\\,\\mathrm{s}$, $\\varepsilon = 1.0\\times 10^{-4}$.\n\nYour program must output the single line $[\\Delta Fo^\\star_1,\\Delta Fo^\\star_2,\\Delta Fo^\\star_3,\\Delta Fo^\\star_4,\\Delta Fo^\\star_5]$ where each entry is rounded to six decimal places and dimensionless.",
            "solution": "The problem requires the derivation of a timestep selection strategy for the Crank–Nicolson (CN) method applied to the $1$D heat equation, based on constraints of monotonicity and accuracy. The strategy will yield a recommended dimensionless timestep, the Fourier number $\\Delta Fo^\\star$.\n\n**1. Fourier Stability Analysis and Monotonicity Constraint**\n\nThe one-dimensional heat equation is given by:\n$$ u_t = \\alpha u_{xx} $$\nwhere $u$ is the temperature, $t$ is time, $x$ is the spatial coordinate, and $\\alpha$ is the thermal diffusivity. We discretize this equation on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. Using a second-order central difference for the spatial derivative and the Crank–Nicolson method for the time integration, we obtain the finite difference equation:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2\\Delta x^2} \\left[ (u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) + (u_{j+1}^{n} - 2u_j^{n} + u_{j-1}^{n}) \\right] $$\nwhere $u_j^n \\approx u(j\\Delta x, n\\Delta t)$. Let $\\Delta Fo = \\alpha \\Delta t / \\Delta x^2$ be the Fourier number. To perform a von Neumann stability analysis, we consider the evolution of a single Fourier mode, $u_j^n = G^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $G(k)$ is the amplification factor per timestep. Substituting this form into the difference equation yields the amplification factor:\n$$ G(k) = \\frac{1 - 2\\Delta Fo \\sin^2(k\\Delta x/2)}{1 + 2\\Delta Fo \\sin^2(k\\Delta x/2)} $$\nFor numerical stability, we require $|G(k)| \\le 1$. Since $\\Delta Fo \\ge 0$ and $\\sin^2(k\\Delta x/2) \\ge 0$, the denominator is always greater than or equal to the absolute value of the numerator. Thus, $|G(k)| \\le 1$ for all $\\Delta Fo \\ge 0$, and the Crank–Nicolson method is unconditionally stable.\n\nHowever, for a physically-realistic simulation of a diffusion process, it is often desirable to prevent the formation of non-physical oscillations. A sufficient condition for this is to ensure that the scheme is monotonic, which requires the amplification factor to be non-negative, $G(k) \\ge 0$. As the denominator is always positive, we require the numerator to be non-negative:\n$$ 1 - 2\\Delta Fo \\sin^2(k\\Delta x/2) \\ge 0 $$\nThis inequality must hold for all resolvable spatial modes on the grid. The most restrictive case occurs for the highest resolvable wavenumber, $k_{max} = \\pi/\\Delta x$, for which $\\sin^2(k_{max}\\Delta x/2) = \\sin^2(\\pi/2) = 1$. The condition thus becomes:\n$$ 1 - 2\\Delta Fo \\le 0 \\implies \\Delta Fo \\le \\frac{1}{2} $$\nThis establishes the monotonicity constraint: $\\Delta Fo_{mono} \\le 0.5$.\n\n**2. Accuracy Analysis and Constraint**\n\nThe Crank–Nicolson method is second-order accurate in time, but its accuracy deteriorates as $\\Delta Fo$ increases. We quantify this by comparing the numerical amplification factor $G_{CN}(k)$ with the exact amplification factor for the semi-discretized system, $G_{exact}(k)$.\nThe semi-discrete equation has an exact modal amplification factor over one time step $\\Delta t$:\n$$ G_{exact}(k) = \\exp \\left(-\\alpha \\Delta t \\frac{4}{\\Delta x^2} \\sin^2(k\\Delta x/2)\\right) = \\exp \\left(-4 \\Delta Fo \\sin^2(k\\Delta x/2)\\right) $$\nThe leading-order relative error in the amplitude of a mode after $N$ timesteps up to a final time $t_f = N\\Delta t$ can be approximated by analyzing the Taylor series of the amplification factors. The analysis shows that the total relative error is largest for the highest frequency mode ($k=\\pi/\\Delta x$) and can be approximated as:\n$$ \\text{Error} \\approx \\frac{16}{3} \\frac{t_f \\alpha}{\\Delta x^2} \\Delta Fo^2 $$\nThe problem requires this worst-case relative error to be bounded by a tolerance $\\varepsilon$:\n$$ \\frac{16}{3} \\frac{t_f \\alpha}{\\Delta x^2} \\Delta Fo^2 \\le \\varepsilon $$\nSolving for $\\Delta Fo$ gives the accuracy constraint:\n$$ \\Delta Fo \\le \\sqrt{\\frac{3 \\varepsilon \\Delta x^2}{16 t_f \\alpha}} = \\frac{\\Delta x}{4} \\sqrt{\\frac{3 \\varepsilon}{t_f \\alpha}} $$\nLet us denote this accuracy-based limit as $\\Delta Fo_{acc}$.\n\n**3. Timestep Control Strategy**\n\nThe final recommended timestep, $\\Delta Fo^\\star$, must satisfy both the monotonicity and accuracy constraints for all resolvable modes. Therefore, it must be the more restrictive (i.e., the minimum) of the two derived bounds:\n$$ \\Delta Fo^\\star = \\min(\\Delta Fo_{mono}, \\Delta Fo_{acc}) $$\nSubstituting the derived expressions:\n$$ \\Delta Fo^\\star = \\min\\left(0.5, \\frac{\\Delta x}{4} \\sqrt{\\frac{3 \\varepsilon}{t_f \\alpha}}\\right) $$\nThe spatial step size is defined as $\\Delta x = L/(n_x-1)$. The control strategy is thus a function of the given parameters $L$, $n_x$, $\\alpha$, $t_f$, and $\\varepsilon$, and is independent of the initial conditions, as required. This algorithm provides a conservative choice for the Fourier number that ensures non-oscillatory behavior and respects the specified global error tolerance over the simulation horizon.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the recommended Fourier number (Delta Fo_star) for a series of test cases\n    based on derived monotonicity and accuracy constraints for the Crank-Nicolson scheme.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    # Each tuple contains: (alpha, L, n_x, t_f, epsilon)\n    test_cases = [\n        # Test case 1 (general case)\n        (1.0e-5, 0.1, 51, 2.0, 1.0e-3),\n        # Test case 2 (monotonicity-limited)\n        (1.0e-5, 0.1, 51, 0.1, 1.0),\n        # Test case 3 (boundary condition where monotonicity and accuracy limits coincide)\n        (1.0e-5, 0.1, 51, 0.1, 1.0/3.0),\n        # Test case 4 (fine spatial resolution)\n        (1.0e-5, 0.1, 201, 2.0, 1.0e-3),\n        # Test case 5 (higher thermal diffusivity and stricter tolerance)\n        (1.0e-4, 0.1, 51, 2.0, 1.0e-4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        alpha, L, n_x, t_f, epsilon = case\n        \n        # Calculate the spatial grid spacing, delta_x.\n        # As per the problem, dx = L / (nx - 1).\n        delta_x = L / (n_x - 1)\n        \n        # 1. Monotonicity constraint for the Crank-Nicolson scheme.\n        # This constraint requires Delta Fo = 0.5 to avoid non-physical oscillations.\n        delta_fo_mono = 0.5\n        \n        # 2. Accuracy constraint derived from the global error analysis.\n        # The relative error in amplitude must be less than or equal to epsilon.\n        # The formula is Delta Fo = (delta_x / 4) * sqrt(3 * epsilon / (t_f * alpha)).\n        # We ensure the argument of the square root is non-negative, although physically\n        # it should always be positive.\n        arg_sqrt = (3.0 * epsilon) / (t_f * alpha)\n        if arg_sqrt  0:\n            # This case is physically not expected but included for robustness.\n            delta_fo_acc = 0.0\n        else:\n            delta_fo_acc = (delta_x / 4.0) * np.sqrt(arg_sqrt)\n            \n        # The recommended Fourier number, Delta Fo_star, must satisfy both constraints.\n        # Therefore, we take the minimum of the two bounds.\n        delta_fo_star = min(delta_fo_mono, delta_fo_acc)\n        \n        # Format the result to six decimal places as a string for the final output.\n        results.append(\"{:.6f}\".format(delta_fo_star))\n\n    # Print the final result in the exact required format: [res1,res2,...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}