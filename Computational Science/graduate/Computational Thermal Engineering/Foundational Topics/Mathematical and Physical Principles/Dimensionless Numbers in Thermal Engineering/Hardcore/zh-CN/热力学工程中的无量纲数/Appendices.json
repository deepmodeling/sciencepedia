{
    "hands_on_practices": [
        {
            "introduction": "第一个实践将探讨平板上的强制对流问题。我们将运用标度分析和匹配渐近展开等强大的理论工具，来理解普朗特数（$Pr$）如何决定速度边界层和热边界层之间的关系。本练习将揭示为何对于空气（$Pr \\sim 1$）和液态金属（$Pr \\ll 1$）等不同流体，其传热关联式会呈现不同的形式。",
            "id": "3946643",
            "problem": "考虑一个物性恒定的不可压缩流体，以自由来流速度 $U_{\\infty}$ 流过一个壁面温度为 $T_{w}$、自由来流温度为 $T_{\\infty}$ 的等温半无限平板。流动为稳态、二维、层流强制对流。设运动粘度为 $\\nu$，热扩散系数为 $\\alpha$，导热系数为 $k$。在边界层条件下（动量和能量的流向扩散可忽略不计，压力梯度可忽略不计），控制边界层方程为\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0,\n$$\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^{2} u}{\\partial y^{2}},\n$$\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}},\n$$\n边界条件为 $u(x,0)=0$，$T(x,0)=T_{w}$，$u(x,y\\to\\infty)=U_{\\infty}$，$T(x,y\\to\\infty)=T_{\\infty}$。\n\n定义雷诺数 $Re_{x} = \\frac{U_{\\infty} x}{\\nu}$、普朗特数 $Pr = \\frac{\\nu}{\\alpha}$ 和局部努塞尔数 $Nu_{x} = \\frac{h_{x} x}{k}$，其中 $h_{x}$ 是局部对流换热系数。在适当的情况下，您可以使用经过充分检验的 Blasius 标度关系来描述速度边界层厚度 $\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}$ 以及近壁线性剪切近似 $u \\approx a\\,y$ (其中 $a \\sim \\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0} \\sim \\frac{U_{\\infty}}{\\delta_{v}}$)。\n\n使用内区 ($y = \\mathcal{O}(\\delta_{v})$) 和外热区 ($y = \\mathcal{O}(\\delta_{T})$) 之间的匹配渐近分析，确定标准形式\n$$\nNu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}\n$$\n中的标度指数在从 $Pr \\approx 0.7$ 的流体（空气，$Pr = \\mathcal{O}(1)$）变为 $Pr \\approx 0.01$ 的液态金属（$Pr \\ll 1$）时必须如何变化。此处 $K$ 是一个无量纲常数，在不同区间可能不同，但无需计算其值；任务是通过主导平衡论证和内外解的渐近匹配来推导出指数 $a$ 和 $b$。\n\n假设 $Re_{x}$ 足够大，使得层流边界层存在，并且能量方程中的流向热传导可以忽略不计。不要使用经验换热关联式；从边界层方程和渐近匹配推导出其依赖关系。将您的最终答案表示为单行矩阵形式的有序四元指数 $\\left(a_{\\text{air}},\\,b_{\\text{air}},\\,a_{\\text{metal}},\\,b_{\\text{metal}}\\right)$。不需要数值取整，指数应以无单位的精确分数形式给出。",
            "solution": "问题验证步骤：\n\n步骤 1：提取已知条件\n-   问题类型：物性恒定的不可压缩流体的稳态、二维、层流强制对流。\n-   几何形状：半无限平板。\n-   流动条件：自由来流速度 $U_{\\infty}$。\n-   热力条件：等温平板，温度为 $T_w$，自由来流温度为 $T_{\\infty}$。\n-   流体物性：运动粘度 $\\nu$，热扩散系数 $\\alpha$，导热系数 $k$。\n-   控制方程（边界层近似）：\n    -   连续性方程：$\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$\n    -   动量方程：$u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^{2} u}{\\partial y^{2}}$\n    -   能量方程：$u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}$\n-   边界条件：\n    -   $u(x,0)=0$\n    -   $T(x,0)=T_{w}$\n    -   $u(x,y\\to\\infty)=U_{\\infty}$\n    -   $T(x,y\\to\\infty)=T_{\\infty}$\n-   定义：\n    -   雷诺数：$Re_{x} = \\frac{U_{\\infty} x}{\\nu}$\n    -   普朗特数：$Pr = \\frac{\\nu}{\\alpha}$\n    -   局部努塞尔数：$Nu_{x} = \\frac{h_{x} x}{k}$\n-   给定的近似/标度关系：\n    -   速度边界层厚度：$\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}$\n    -   近壁线性剪切近似：$u \\approx a\\,y$ 且 $a \\sim \\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0} \\sim \\frac{U_{\\infty}}{\\delta_{v}}$\n-   目标：确定 $Nu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}$ 中标度指数 $a$ 和 $b$ 在两种情况下的值：\n    1.  $Pr \\approx 0.7$ ($Pr = \\mathcal{O}(1)$)\n    2.  $Pr \\approx 0.01$ ($Pr \\ll 1$)\n-   方法：匹配渐近分析，主导平衡论证。\n-   假设：$Re_x$ 很大。\n-   约束：不使用经验关联式。从第一性原理推导。\n-   最终答案格式：行矩阵形式的有序四元组 $(a_{\\text{air}},\\,b_{\\text{air}},\\,a_{\\text{metal}},\\,b_{\\text{metal}})$。\n\n步骤 2：使用提取的已知条件进行验证\n\n-   是否具有科学依据？是。该问题是强制对流换热理论中的一个经典设置（Blasius 边界层及相关的热边界层）。控制方程是从 Navier-Stokes 方程和能量方程导出的标准边界层方程。无量纲数（$Re_x$，$Pr$，$Nu_x$）都是标准定义。针对不同普朗特数区间的匹配渐近分析概念是流体力学和传热学中一个成熟的理论工具。\n-   问题是否适定？是。该问题要求的是标度指数，而不是一个完整的数值解。所提供的信息（控制方程、边界条件和标度律）足以进行标度分析（或主导平衡分析）来找到这些指数。这些条件导致了在指定区间内对换热过程的唯一且有意义的物理解释。\n-   是否客观？是。语言精确且技术性强。不存在主观或基于意见的陈述。\n-   缺陷检查清单：\n    1.  科学/事实不准确：无。物理原理是正确的。\n    2.  不可形式化/不相关：该问题高度形式化，与热工学中无量纲数的主题直接相关。\n    3.  不完整/矛盾：对于标度分析来说，设定是完整的。边界层假设与大 $Re_x$ 条件一致。\n    4.  不现实/不可行：条件对于诸如空气流过表面或液态金属在冷却系统中的流动是物理上现实的。数据是符号化的，因此维度上是一致的。\n    5.  不适定/结构不良：问题结构清晰。它引导求解者使用特定的分析方法（渐近分析）和特定的答案形式（标度指数）。\n    6.  伪深刻/琐碎：这是一个标准但非平凡的教科书问题，需要对边界层理论和标度分析有扎实的理解。它既不伪深刻也不琐碎。\n    7.  超出科学可验证性：这种分析的结果可以与完整的数值解或实验数据进行比较，因此是可验证的。\n\n步骤 3：结论与行动\n-   结论：问题是有效的 (VALID)。\n-   行动：进入求解阶段。\n\n目标是确定关系式 $Nu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}$ 中标度指数 $a$ 和 $b$ 的值，适用于普朗特数的两个不同先验区间，$Pr \\sim \\mathcal{O}(1)$ 和 $Pr \\ll 1$。\n\n局部努塞尔数 $Nu_{x}$ 定义为 $Nu_{x} = \\frac{h_{x} x}{k}$，其中 $h_x$ 是局部换热系数。系数 $h_x$ 通过牛顿冷却定律定义，$q''_{w} = h_{x}(T_{w} - T_{\\infty})$，其中 $q''_{w}$ 是壁面热通量。这个热通量也由傅里叶热传导定律在流固界面处给出：$q''_{w} = -k \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0}$。令这两个 $q''_{w}$ 的表达式相等，可得 $h_{x} = \\frac{-k}{T_{w} - T_{\\infty}} \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0}$。\n\n将此式代入 $Nu_x$ 的定义中：\n$$\nNu_{x} = \\frac{x}{k} \\left( \\frac{-k}{T_{w} - T_{\\infty}} \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} \\right) = \\frac{-x}{T_{w} - T_{\\infty}} \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0}\n$$\n壁面法向温度梯度的标度估计为 $\\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} \\sim \\frac{T_{\\infty} - T_{w}}{\\delta_{T}}$，其中 $\\delta_{T}$ 是热边界层的特征厚度。这将努塞尔数的标度关系简化为：\n$$\nNu_{x} \\sim \\frac{-x}{T_{w} - T_{\\infty}} \\frac{T_{\\infty} - T_{w}}{\\delta_{T}} = \\frac{x}{\\delta_{T}}\n$$\n因此，问题简化为确定热边界层厚度 $\\delta_{T}(x)$ 在普朗特数 $Pr = \\frac{\\nu}{\\alpha}$ 的两个指定区间内的标度关系。\n\n情况 1：$Pr \\approx 0.7$ 的流体（例如空气，$Pr = \\mathcal{O}(1)$）\n在这个区间内，运动粘度 $\\nu$ 和热扩散系数 $\\alpha$ 处于同一数量级。这意味着动量和热量以可比较的速率从平板扩散出去。因此，速度边界层厚度 $\\delta_{v}$ 和热边界层厚度 $\\delta_{T}$ 是同一量级：$\\delta_{T} \\sim \\delta_{v}$。\n\n问题给出了 Blasius 速度边界层的标度关系：\n$$\n\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}\n$$\n因此，对于 $Pr = \\mathcal{O}(1)$，我们可以说 $\\delta_{T}(x) \\sim x\\,Re_{x}^{-1/2}$。\n将此代入我们的努塞尔数标度关系中：\n$$\nNu_{x} \\sim \\frac{x}{\\delta_{T}} \\sim \\frac{x}{x\\,Re_{x}^{-1/2}} = Re_{x}^{1/2}\n$$\n这确定了指数 $a_{\\text{air}} = \\frac{1}{2}$。要确定指数 $b$，需要进行更详细的分析，因为速度剖面在整个热边界层上是非线性的，简单的标度分析可能会产生误导。该问题的完整相似性解（Pohlhausen 解），我们无需重新推导，但可以依赖其作为此经典案例的既定理论，该解给出的关系是 $Nu_{x} \\propto Re_{x}^{1/2} Pr^{1/3}$。对于 $Pr \\gtrsim 0.6$ 的流体，这种 $Pr^{1/3}$ 的依赖关系非常准确。问题要求我们推导指数，对于这个基准情况，这涉及到应用正确且已确立的理论结果。因此，我们有：\n$$\na_{\\text{air}} = \\frac{1}{2}, \\quad b_{\\text{air}} = \\frac{1}{3}\n$$\n\n情况 2：$Pr \\approx 0.01$ 的液态金属（$Pr \\ll 1$）\n对于液态金属，普朗特数非常小，$Pr = \\frac{\\nu}{\\alpha} \\ll 1$。这意味着热扩散系数远大于动量扩散系数（即运动粘度），$\\alpha \\gg \\nu$。热量比动量扩散得更快、更远。这导致热边界层明显厚于速度边界层：$\\delta_{T} \\gg \\delta_{v}$。\n\n这种物理图像非常适合进行匹配渐近分析。流场有两个不同的区域：\n1.  “内”区，$y = \\mathcal{O}(\\delta_{v})$，其中粘性效应占主导，速度剖面从 $u=0$ 发展到 $u=U_{\\infty}$。\n2.  “外”区，$\\delta_{v} \\ll y \\lesssim \\mathcal{O}(\\delta_{T})$，构成了热边界层的主体部分。在这个区域，流体速度已经达到其自由来流值，因此 $u(x,y) \\approx U_{\\infty}$。\n\n热传递由热边界层内的能量方程控制。由于 $\\delta_{T} \\gg \\delta_{v}$，我们可以用外区的值来近似热边界层大部分区域内的速度 $u$，即 $u \\approx U_{\\infty}$。能量方程为：\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}\n$$\n近似 $u \\approx U_{\\infty}$ 并注意到根据连续性方程 $v$ 将很小，能量方程中的主导平衡在于流向平流项和壁面法向扩散项之间：\n$$\nU_{\\infty} \\frac{\\partial T}{\\partial x} \\approx \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}\n$$\n我们现在对这个简化方程进行标度分析。设流向的特征长度尺度为 $x$，壁面法向的特征长度尺度为 $\\delta_T$。温差尺度为 $\\Delta T = |T_w - T_\\infty|$。各项的标度为：\n$$\nU_{\\infty} \\frac{\\Delta T}{x} \\sim \\alpha \\frac{\\Delta T}{\\delta_{T}^{2}}\n$$\n求解热边界层厚度 $\\delta_{T}$：\n$$\n\\delta_{T}^{2} \\sim \\frac{\\alpha x}{U_{\\infty}} \\implies \\delta_{T} \\sim \\sqrt{\\frac{\\alpha x}{U_{\\infty}}}\n$$\n为了用无量纲数表示，我们引入 $Re_x$ 和 $Pr$：\n$$\n\\delta_{T} \\sim \\sqrt{\\frac{\\alpha x}{U_{\\infty}}} = \\sqrt{\\frac{\\nu x}{U_{\\infty}} \\cdot \\frac{\\alpha}{\\nu}} = \\sqrt{\\frac{x^2}{Re_x} \\cdot \\frac{1}{Pr}} = x \\, Re_{x}^{-1/2} \\, Pr^{-1/2}\n$$\n我们必须验证这个结果与我们最初的假设 $\\delta_{T} \\gg \\delta_{v}$ 是否一致：\n$$\n\\frac{\\delta_{T}}{\\delta_{v}} \\sim \\frac{x \\, Re_{x}^{-1/2} \\, Pr^{-1/2}}{x \\, Re_{x}^{-1/2}} = Pr^{-1/2}\n$$\n对于 $Pr \\ll 1$，$Pr^{-1/2} \\gg 1$，因此假设成立。\n现在，我们使用 $Nu_{x} \\sim x/\\delta_{T}$ 来找到努塞尔数的标度关系：\n$$\nNu_{x} \\sim \\frac{x}{x \\, Re_{x}^{-1/2} \\, Pr^{-1/2}} = Re_{x}^{1/2} \\, Pr^{1/2}\n$$\n这个结果给出了低普朗特数区间的标度指数：\n$$\na_{\\text{metal}} = \\frac{1}{2}, \\quad b_{\\text{metal}} = \\frac{1}{2}\n$$\n\n指数总结：\n对于空气 ($Pr \\sim 1$)：$(a_{\\text{air}}, b_{\\text{air}}) = (\\frac{1}{2}, \\frac{1}{3})$\n对于液态金属 ($Pr \\ll 1$)：$(a_{\\text{metal}}, b_{\\text{metal}}) = (\\frac{1}{2}, \\frac{1}{2})$\n\n普朗特数指数从 $b=1/3$ 变为 $b=1/2$ 反映了热传输物理机制的根本变化。对于 $Pr \\sim 1$，热传递与速度边界层的详细结构耦合。对于 $Pr \\ll 1$，热边界层非常厚，以至于它在很大程度上与近壁的粘性效应解耦，并由近乎均匀的流体对流输运。\n最终答案是这些指数的有序四元组。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{3}  \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从强制对流转向自然对流，本练习将深入探讨经典的瑞利-贝纳德（Rayleigh-Bénard）问题。你将运用线性稳定性分析来确定在底部加热的流体层中，流体开始运动的临界条件。这个实践揭示了瑞利数（$Ra$）作为关键参数的物理意义，它标志着系统从纯粹的导热状态向对流状态的转变。",
            "id": "3946574",
            "problem": "考虑一个厚度为 $H$ 的无限水平牛顿流体层，其底部和顶面之间存在固定的温差 $\\Delta T$，并从下方加热。假设 Boussinesq 近似成立，基态是纯粹导热的，并且边界是理想导热的，因此温度扰动在边界处消失。令无量纲垂直坐标为 $z \\in [0,1]$，并用 $H$ 对长度进行无量纲化，用 $H^{2}/\\alpha$ 对时间进行无量纲化，用 $\\alpha/H$ 对速度进行无量纲化，用 $\\Delta T$ 对温度扰动进行无量纲化，其中 $\\alpha$ 是热扩散系数。\n\n- 在 Boussinesq 近似下，从业已线性化、无量纲化的控制方程出发，描述对导热基态的无穷小扰动。这些方程用无量纲速度场 $\\boldsymbol{u}$、压力 $p$ 和温度扰动 $\\theta$ 表示。使用具有水平波数大小 $a$ 和增长率 $\\sigma$ 的简正模拟设，得到一个关于 $z$ 的一维特征值问题，该问题确定了对流开始时的中性稳定条件（$\\sigma = 0$）。\n\n- 对于在 $z=0$ 和 $z=1$ 处的机械自由-自由（无应力）边界，施加适用于无应力表面的运动学条件，以及在两个边界上施加热边界条件 $\\theta=0$。利用这些边界条件，确定瑞利数 $Ra$ 和水平波数 $a$ 之间的中性稳定性关系 $Ra(a)$。然后，通过在 $a0$ 上最小化 $Ra(a)$ 来找到对流开始的临界瑞利数 $Ra_{c,\\text{FF}}$，并给出 $Ra_{c,\\text{FF}}$ 的精确解析表达式。\n\n- 对于具有相同热边界条件的机械刚性-刚性（无滑移）边界，相应的线性特征值问题不承认简单的闭合形式解析中性曲线，但其临界瑞利数可以通过数值方法得知。使用从无滑移边界特征值问题的数值解中得到的已知值 $Ra_{c,\\text{RR}} = 1707.76$。\n\n计算比率\n$$\\chi = \\frac{Ra_{c,\\text{RR}}}{Ra_{c,\\text{FF}}}$$\n并报告保留四位有效数字的 $\\chi$ 值。最终答案必须是这个单一的实数值。由于瑞利数是无量纲的，因此不需要单位。",
            "solution": "该问题要求计算在下方加热的流体层中，对于两种不同的机械边界条件（刚性-刚性和自由-自由），对流开始时的临界瑞利数的比率。\n\n首先，我们建立控制方程。对于静止、导热基态的扰动，线性化、无量纲化的 Boussinesq 方程如下：\n连续性方程：\n$$ \\nabla \\cdot \\boldsymbol{u} = 0 $$\n动量方程：\n$$ \\frac{1}{\\text{Pr}} \\frac{\\partial \\boldsymbol{u}}{\\partial t} = -\\nabla p + \\nabla^2 \\boldsymbol{u} + \\text{Ra} \\, \\theta \\, \\hat{\\boldsymbol{k}} $$\n能量方程：\n$$ \\frac{\\partial \\theta}{\\partial t} = w + \\nabla^2 \\theta $$\n这里，$\\boldsymbol{u} = (u,v,w)$ 是无量纲速度扰动，$p$ 是压力扰动，$\\theta$ 是温度扰动，$\\text{Ra}$ 是瑞利数，$\\text{Pr}$ 是普朗特数，$\\hat{\\boldsymbol{k}}$ 是垂直方向 $z$ 上的单位向量。\n\n我们通过引入变量的简正模来分析稳定性。我们寻求以下形式的解：\n$$ (w, \\theta) = (W(z), \\Theta(z)) \\exp(i(k_x x + k_y y) + \\sigma t) $$\n其中 $a = \\sqrt{k_x^2 + k_y^2}$ 是水平波数的大小，$\\sigma$ 是增长率。算子 $\\nabla^2$ 和水平拉普拉斯算子 $\\nabla_h^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 变换为：\n$$ \\nabla^2 \\rightarrow D^2 - a^2 \\quad \\text{和} \\quad \\nabla_h^2 \\rightarrow -a^2 $$\n其中 $D = d/dz$。\n\n为了简化系统，我们消去水平速度分量 $u$、$v$ 和压力 $p$。将算子 $\\hat{\\boldsymbol{k}} \\cdot (\\nabla \\times \\nabla \\times \\cdot)$ 应用于动量方程，并利用连续性方程，得到一个关于垂直速度分量 $w$ 的方程。这产生了一个关于 $w$ 和 $\\theta$ 的耦合方程组：\n$$ \\frac{1}{\\text{Pr}} \\frac{\\partial}{\\partial t}(\\nabla^2 w) = \\nabla^4 w + \\text{Ra} \\, \\nabla_h^2 \\theta $$\n$$ \\frac{\\partial \\theta}{\\partial t} = w + \\nabla^2 \\theta $$\n将简正模形式代入这些方程，得到两个关于振幅 $W(z)$ 和 $\\Theta(z)$ 的常微分方程：\n$$ \\frac{\\sigma}{\\text{Pr}} (D^2 - a^2)W = (D^2 - a^2)^2 W - \\text{Ra} \\, a^2 \\Theta $$\n$$ \\sigma \\Theta = W + (D^2 - a^2) \\Theta $$\n我们关心的是中性稳定条件，它标志着对流的开始。这对应于增长率 $\\sigma$ 为零的情况。令 $\\sigma=0$ 可将系统简化为：\n$$ (D^2 - a^2)^2 W = \\text{Ra} \\, a^2 \\Theta $$\n$$ W = -(D^2 - a^2) \\Theta $$\n我们可以将这两个方程组合起来，得到一个关于 $W(z)$ 的六阶常微分方程：\n$$ (D^2 - a^2) W = -(D^2 - a^2) (-(D^2 - a^2) \\Theta) = (D^2 - a^2)^2 \\Theta $$\n从第一个方程，$\\Theta = \\frac{1}{\\text{Ra}\\,a^2}(D^2 - a^2)^2 W$。将此代入 $W$ 的方程：\n$$ W = -(D^2 - a^2) \\left[ \\frac{1}{\\text{Ra}\\,a^2}(D^2 - a^2)^2 W \\right] $$\n$$ (D^2 - a^2)^3 W + \\text{Ra} \\, a^2 W = 0 $$\n这是关于瑞利数 $\\text{Ra}$ 的特征值问题。\n\n对于在 $z=0$ 和 $z=1$ 处的自由-自由边界，边界条件为：\n1.  边界处无垂直速度：$w=0 \\implies W(0)=W(1)=0$。\n2.  理想导热边界：$\\theta=0 \\implies \\Theta(0)=\\Theta(1)=0$。\n3.  无应力（切向应力为零）表面：$\\frac{\\partial u}{\\partial z} = \\frac{\\partial v}{\\partial z} = 0$。可以证明，该条件等价于在边界处 $\\frac{\\partial^2 w}{\\partial z^2}=0$，因此 $D^2W(0)=D^2W(1)=0$。\n\n从方程 $W=-(D^2-a^2)\\Theta$，条件 $\\Theta=0$ 和 $W=0$ 意味着在边界处 $D^2\\Theta=0$。对该方程求导两次，得到 $D^2W = -(D^4 - a^2 D^2)\\Theta$。在边界处有 $W=0, D^2W=0, \\Theta=0, D^2\\Theta=0$，可推得 $D^4\\Theta=0$。\n观察常微分方程，边界条件 $W=0$ 和 $\\Theta=0$ 意味着 $(D^2-a^2)^2 W = 0$。由于 $W=0$ 且 $D^2W=0$，这进一步意味着在边界处 $D^4W=0$。\n因此，$W(z)$ 的完整边界条件集为：\n$$ W = D^2 W = D^4 W = 0 \\quad \\text{在 } z=0, 1 $$\n满足这些边界条件的最简单的非平凡特征函数形式为 $W(z) = A \\sin(n\\pi z)$，其中 $n$ 为整数。我们来验证一下：\n$W(0)=A\\sin(0)=0$ 并且 $W(1)=A\\sin(n\\pi)=0$。\n$D^2 W = -A(n\\pi)^2 \\sin(n\\pi z)$，所以 $D^2W(0)=0$ 并且 $D^2W(1)=0$。\n$D^4 W = A(n\\pi)^4 \\sin(n\\pi z)$，所以 $D^4W(0)=0$ 并且 $D^4W(1)=0$。\n条件满足。\n\n现在我们将 $W(z) \\propto \\sin(n\\pi z)$ 代入控制常微分方程。对于这个特征函数，$D^2W = -(n\\pi)^2 W$。算子 $(D^2 - a^2)$ 的作用相当于一个简单的乘法常数：$(-(n\\pi)^2 - a^2)$。该常微分方程变成了关于特征值 $\\text{Ra}$ 的代数方程：\n$$ ((-(n\\pi)^2 - a^2))^3 + \\text{Ra} \\, a^2 = 0 $$\n$$ -((n\\pi)^2 + a^2)^3 + \\text{Ra} \\, a^2 = 0 $$\n$$ \\text{Ra}(a, n) = \\frac{((n\\pi)^2 + a^2)^3}{a^2} $$\n对流的开始对应于可能的最低瑞利数。这发生在 $n$ 的最低可能值，即 $n=1$ 时。因此我们考虑：\n$$ \\text{Ra}(a) = \\frac{(\\pi^2 + a^2)^3}{a^2} $$\n为了找到临界瑞利数，我们必须对 $\\text{Ra}(a)$ 关于水平波数 $a$ 进行最小化。我们计算其导数并令其为零：\n$$ \\frac{d\\text{Ra}}{da} = \\frac{3(\\pi^2+a^2)^2(2a)(a^2) - (\\pi^2+a^2)^3(2a)}{a^4} = 0 $$\n对于 $a0$ 且 $\\pi^2+a^2 \\neq 0$，我们可以将其简化为：\n$$ 3a^2(\\pi^2+a^2)^2 = (\\pi^2+a^2)^3 $$\n$$ 3a^2 = \\pi^2 + a^2 $$\n$$ 2a^2 = \\pi^2 \\implies a_c^2 = \\frac{\\pi^2}{2} $$\n临界波数为 $a_c = \\pi/\\sqrt{2}$。将此值代回 $\\text{Ra}(a)$ 的表达式，得到自由-自由边界的临界瑞利数 $\\text{Ra}_{c,\\text{FF}}$：\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{(\\pi^2 + \\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^4}{4} $$\n这就是 $\\text{Ra}_{c,\\text{FF}}$ 的精确解析表达式。\n\n题目给出了刚性-刚性边界的数值计算临界瑞利数：\n$$ \\text{Ra}_{c,\\text{RR}} = 1707.76 $$\n我们现在可以计算比率 $\\chi$：\n$$ \\chi = \\frac{\\text{Ra}_{c,\\text{RR}}}{\\text{Ra}_{c,\\text{FF}}} = \\frac{1707.76}{\\frac{27\\pi^4}{4}} $$\n首先，我们计算 $\\text{Ra}_{c,\\text{FF}}$ 的数值：\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{27}{4}\\pi^4 \\approx 6.75 \\times (3.14159265...)^4 \\approx 6.75 \\times 97.409091... \\approx 657.51136... $$\n现在，比率为：\n$$ \\chi = \\frac{1707.76}{657.51136...} \\approx 2.597305... $$\n将此值四舍五入到四位有效数字，得到：\n$$ \\chi \\approx 2.597 $$",
            "answer": "$$\\boxed{2.597}$$"
        },
        {
            "introduction": "在我们最后一个实践中，将在自然对流概念的基础上，进入复杂的湍流领域。通过对精确的全局能量平衡方程应用标度律分析，你将推导出湍流瑞利-贝纳德（Rayleigh-Bénard）对流“终极区”的理论传热标度律。这个练习将基础理论与现代数据分析相结合，展示了无量纲数如何为理解最混沌的流动提供框架。",
            "id": "3946571",
            "problem": "您会获得三个合成数据集，这些数据集模拟了在大 Rayleigh 数 $Ra$ 和变化的 Prandtl 数 $Pr$ 条件下的 Rayleigh–Bénard 对流 (RBC) 的直接数值模拟 (DNS)。您的任务是估算标度关系 $Nu \\sim Ra^{\\gamma} Pr^{\\delta}$ 中的指数 $\\gamma$ 和 $\\delta$，并从第一性原理出发，论证终极区假说如何约束指数 $\\gamma$ 和 $\\delta$。\n\n使用以下无量纲数定义和 RBC 背景作为基本依据：\n- Rayleigh 数 $Ra$，定义为 $Ra = \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha}$，其中 $g$ 是重力加速度，$\\beta$ 是热膨胀系数，$\\Delta T$ 是施加的温差，$H$ 是对流单元的高度，$\\nu$ 是运动粘度，$\\alpha$ 是热扩散率。\n- Prandtl 数 $Pr$，定义为 $Pr = \\dfrac{\\nu}{\\alpha}$。\n- Nusselt 数 $Nu$，定义为 $Nu = \\dfrac{q H}{k \\Delta T}$，其中 $q$ 是平均垂直热通量，$k$ 是热导率。\n\n假设从 DNS 测得的 Nusselt 数 $Nu$ 在足够大的 $Ra$ 下服从与 $Ra$ 和 $Pr$ 的幂律关系，即 $Nu \\sim Ra^{\\gamma} Pr^{\\delta}$，其中指数 $\\gamma$ 和 $\\delta$ 未知。下面提供的类 DNS 合成数据集由三元组 $(Ra_i, Pr_i, Nu_i)$（$i=1,\\dots,N$）组成。您的程序必须通过对对数变换后的关系式进行最小二乘拟合来估算 $\\gamma$ 和 $\\delta$：\n$$\\ln(Nu_i) = \\gamma \\ln(Ra_i) + \\delta \\ln(Pr_i) + c,$$\n其中 $c$ 是一个考虑了前置因子的截距。\n\n除了计算指数外，您还必须从精确的全局平衡关系和标准湍流假说出发，解释终极区假设如何约束 $\\gamma$ 和 $\\delta$。终极区指的是热边界层和粘性边界层都完全湍流化，并且主体动力学主导全局平衡的状态。\n\n您可以作为基础出发点使用的 RBC 精确全局平衡关系如下：\n- 对于单位质量的动能耗散率 $\\varepsilon_u$：\n$$\\varepsilon_u = \\dfrac{\\nu^3}{H^4} Ra \\, (Nu - 1) \\, Pr^{-2}.$$\n- 对于单位质量的温度方差耗散率 $\\varepsilon_\\theta$：\n$$\\varepsilon_\\theta = \\dfrac{\\alpha \\, \\Delta T^2}{H^2} Nu.$$\n\n上述关系和定义是经过充分检验且是基础性的；在您的解释中，除了这些基础之外，不要假定任何目标标度指数或简化公式。\n\n程序要求：\n1. 实现一个例程，对于给定的数据集 $(Ra_i, Pr_i, Nu_i)$，通过对 $\\ln(Nu)$ 与 $\\ln(Ra)$ 和 $\\ln(Pr)$ 进行线性最小二乘拟合来估算 $\\gamma$ 和 $\\delta$。即使数据列近似共线性，也要稳健地计算解。如果其中一个回归量在整个数据集中的方差可以忽略不计（例如，$Pr$ 近乎恒定），则将相应的指数设置为 NaN，并一致地拟合其余参数。\n2. 对所有变换使用自然对数。\n3. 使用以下包含三个数据集的测试套件，每个数据集由 $Ra$ 和 $Pr$ 的交叉组合构成，其中 $Nu$ 是根据已知的前置因子和指数构造的，以模拟不同的区：\n   - 数据集 A (类终极区，主体主导)：\n     - 前置因子 $C = 2 \\times 10^{-4}$，指数 $(\\gamma, \\delta) = (0.5, 0.5)$。\n     - $Ra \\in \\{10^{12}, 3 \\times 10^{12}, 10^{13}, 3 \\times 10^{13}, 10^{14}\\}$ 且 $Pr \\in \\{0.7, 1.0, 2.0, 5.0\\}$。\n     - 对每对 $(Ra, Pr)$，$Nu$ 生成为 $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$。\n   - 数据集 B (类经典区，受边界层影响)：\n     - 前置因子 $C = 0.07$，指数 $(\\gamma, \\delta) = (0.31, 0.0)$。\n     - $Ra \\in \\{10^{12}, 3 \\times 10^{12}, 10^{13}, 3 \\times 10^{13}, 10^{14}\\}$ 且 $Pr \\in \\{0.7, 2.0, 5.0\\}$。\n     - 对每对 $(Ra, Pr)$，$Nu$ 生成为 $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$。\n   - 数据集 C (具有窄 $Pr$ 变化的边缘情况)：\n     - 前置因子 $C = 0.05$，指数 $(\\gamma, \\delta) = (0.31, 0.1)$。\n     - $Ra \\in \\{10^{12}, 2 \\times 10^{12}, 5 \\times 10^{12}, 10^{13}\\}$ 且 $Pr \\in \\{0.95, 1.0, 1.05\\}$。\n     - 对每对 $(Ra, Pr)$，$Nu$ 生成为 $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$。\n\n输出规范：\n- 生成单行输出，其中包含按 A、B、C 顺序排列的三个数据集的估算指数的扁平化列表，四舍五入到六位小数，无单位（无量纲）：$[\\gamma_A, \\delta_A, \\gamma_B, \\delta_B, \\gamma_C, \\delta_C]$。\n- 您的输出必须是方括号括起来的逗号分隔列表，例如，$[0.500000,0.500000,0.310000,0.000000,0.310000,0.100000]$。\n\n由于 $Ra$、$Pr$、$Nu$、$\\gamma$ 和 $\\delta$ 都是无量纲的，因此无需报告物理单位。不涉及角度。",
            "solution": "该问题被评估为有效。它在科学上基于热流体动力学原理，特别是 Rayleigh-Bénard 对流，并提出了一个涉及理论推导和数值计算的良构任务。所提供的定义和关系是标准且正确的。该问题是客观的，并包含足够的信息以获得唯一解。\n\n解决方案分为两部分：第一部分是从第一性原理出发，对终极区标度指数进行理论推导；第二部分是设计并实现一个数值算法，以根据提供的数据集估算这些指数。\n\n### 第 1 部分：终极区标度指数的理论推导\n\n问题要求在湍流“终极区”假说下，推导标度关系 $Nu \\sim Ra^{\\gamma} Pr^{\\delta}$ 中的指数 $\\gamma$ 和 $\\delta$。我们从已知的 Rayleigh-Bénard 对流 (RBC) 统计稳态的精确全局平衡关系开始。对于非常大的 Rayleigh 数，$Nu \\gg 1$，因此 $(Nu - 1)$ 项可以近似为 $Nu$。\n\n单位质量的平均动能耗散率 $\\varepsilon_u$ 的全局平衡为：\n$$ \\varepsilon_u = \\dfrac{\\nu^3}{H^4} Ra \\, (Nu - 1) \\, Pr^{-2} \\approx \\dfrac{\\nu^3}{H^4} Ra \\, Nu \\, Pr^{-2} \\quad (\\text{当 } Nu \\gg 1 \\text{ 时}) $$\n单位质量的平均温度方差耗散率 $\\varepsilon_\\theta$ 的全局平衡为：\n$$ \\varepsilon_\\theta = \\dfrac{\\alpha \\, \\Delta T^2}{H^2} Nu $$\n\n由 Kraichnan 提出的“终极区”假说假定，在足够高的 Rayleigh 数下，流体的主体部分变得完全湍流。在这种状态下，由主体中的大尺度湍流运动主导的全局能量耗散率，变得与流体的分子输运性质无关：即运动粘度 $\\nu$ 和热扩散率 $\\alpha$。\n\n让我们应用这个假说。我们首先通过代入 $Ra = \\frac{g \\beta \\Delta T H^3}{\\nu \\alpha}$ 和 $Pr = \\frac{\\nu}{\\alpha}$ 的定义，用基本参数来表示耗散率：\n\n对于 $\\varepsilon_u$：\n$$ \\varepsilon_u \\approx \\dfrac{\\nu^3}{H^4} \\left( \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha} \\right) Nu \\left( \\dfrac{\\nu}{\\alpha} \\right)^{-2} = \\dfrac{\\nu^3}{H^4} \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha} Nu \\dfrac{\\alpha^2}{\\nu^2} = \\dfrac{g \\beta \\alpha \\Delta T Nu}{H} $$\n这个表达式揭示了动能耗散率在物理上等同于单位质量浮力做功的速率，这是流动的最终能量来源。\n\n对于 $\\varepsilon_\\theta$：\n该表达式已经以基本参数给出：\n$$ \\varepsilon_\\theta = \\dfrac{\\alpha \\, \\Delta T^2}{H^2} Nu $$\n\n根据终极区假说，$\\varepsilon_u$ 和 $\\varepsilon_\\theta$ 都必须变得与 $\\nu$ 和 $\\alpha$ 无关。让我们分析量 $\\alpha Nu$，它出现在两个表达式中，并乘以不依赖于 $\\nu$ 或 $\\alpha$ 的因子（因为 $\\Delta T$ 是施加的强迫）。因此，终极区假说等价于乘积 $\\alpha Nu$ 变得与 $\\nu$ 和 $\\alpha$ 都无关的条件。\n\n我们将假设的标度律 $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$ 代入乘积 $\\alpha Nu$：\n$$ \\alpha Nu = \\alpha C \\left( \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha} \\right)^{\\gamma} \\left( \\dfrac{\\nu}{\\alpha} \\right)^{\\delta} $$\n其中 $C$ 是一个无量纲前置因子。为了分析对 $\\nu$ 和 $\\alpha$ 的依赖性，我们将包含这些性质的项组合在一起：\n$$ \\alpha Nu = C (g \\beta \\Delta T H^3)^{\\gamma} \\alpha^{1} (\\nu \\alpha)^{-\\gamma} (\\nu \\alpha^{-1})^{\\delta} $$\n$$ \\alpha Nu = C (g \\beta \\Delta T H^3)^{\\gamma} \\alpha^{1} \\nu^{-\\gamma} \\alpha^{-\\gamma} \\nu^{\\delta} \\alpha^{-\\delta} $$\n合并 $\\nu$ 和 $\\alpha$ 的指数得到：\n$$ \\alpha Nu = C (g \\beta \\Delta T H^3)^{\\gamma} \\nu^{\\delta - \\gamma} \\alpha^{1 - \\gamma - \\delta} $$\n为了使整个表达式与 $\\nu$ 和 $\\alpha$ 无关，$\\nu$ 和 $\\alpha$ 的指数必须都等于零。这给了我们一个关于两个未知指数 $\\gamma$ 和 $\\delta$ 的二元线性方程组：\n\n1.  $\\nu$ 的指数： $\\delta - \\gamma = 0 \\implies \\gamma = \\delta$\n2.  $\\alpha$ 的指数： $1 - \\gamma - \\delta = 0 \\implies \\gamma + \\delta = 1$\n\n将第一个方程代入第二个方程得到：\n$$ \\gamma + \\gamma = 1 \\implies 2\\gamma = 1 \\implies \\gamma = \\dfrac{1}{2} $$\n由于 $\\delta = \\gamma$，因此：\n$$ \\delta = \\dfrac{1}{2} $$\n因此，当将终极区假说应用于精确的全局平衡关系时，它唯一地将标度指数约束为 $\\gamma = 1/2$ 和 $\\delta = 1/2$。预测的标度律为 $Nu \\sim Ra^{1/2} Pr^{1/2}$。\n\n### 第 2 部分：标度指数的数值估算\n\n问题要求从 $(Ra_i, Pr_i, Nu_i)$ 三元组数据集中，通过拟合对数变换后的模型来估算指数 $\\gamma$ 和 $\\delta$：\n$$ \\ln(Nu_i) = \\gamma \\ln(Ra_i) + \\delta \\ln(Pr_i) + c $$\n这是一个多元线性回归问题。令 $y_i = \\ln(Nu_i)$，$x_{i,1} = \\ln(Ra_i)$，以及 $x_{i,2} = \\ln(Pr_i)$。我们希望找到系数 $(\\gamma, \\delta, c)$，使得系统 $y = X\\beta$ 的残差平方和最小，其中 $y$ 是 $y_i$ 的向量，$X$ 是以 $[x_1, x_2, 1]$ 为列的设计矩阵，$\\beta = [\\gamma, \\delta, c]^T$。\n\n解由正规方程给出，$\\beta = (X^T X)^{-1} X^T y$。一个数值上稳健的求解方法，尤其是在存在共线性或近似共线性的情况下，是使用基于奇异值分解 (SVD) 的最小二乘求解器，例如 `numpy.linalg.lstsq`。\n\n问题指定了一个特殊条件：如果一个回归量（例如 $\\ln(Pr)$）的方差可以忽略不计，其对应的指数应报告为 `NaN`，并且拟合应使用剩余的参数进行。这处理了某个参数在整个数据集中保持不变的情况，使其贡献与截距项无法区分。我们将通过检查对数变换后的 `Ra` 和 `Pr` 向量的方差与一个小容差的比较来实现这一点。如果方差低于此容差，我们将从设计矩阵中排除该回归量。\n\n估算函数的算法如下：\n1.  输入数据向量 `Ra`、`Pr` 和 `Nu`。\n2.  计算每个向量的自然对数：`log_Ra`、`log_Pr`、`log_Nu`。\n3.  计算 `log_Ra` 和 `log_Pr` 的方差。\n4.  如果两个方差都显著，则执行对 `log_Nu` 关于 `log_Ra` 和 `log_Pr` 的完整回归，以找到 $\\gamma$ 和 $\\delta$。\n5.  如果 `log_Pr` 的方差可忽略，则将 $\\delta$ 设置为 `NaN`，并仅对 `log_Ra` 回归 `log_Nu` 以找到 $\\gamma$。\n6.  如果 `log_Ra` 的方差可忽略，则将 $\\gamma$ 设置为 `NaN`，并仅对 `log_Pr` 回归 `log_Nu` 以找到 $\\delta$。\n7.  如果两个方差都可忽略，则将 $\\gamma$ 和 $\\delta$ 都设置为 `NaN`。\n\n此过程将应用于提供的三个合成数据集。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_exponents(ra: np.ndarray, pr: np.ndarray, nu: np.ndarray) - tuple[float, float]:\n    \"\"\"\n    Estimates the exponents gamma and delta in the scaling law Nu ~ Ra^gamma * Pr^delta.\n\n    The estimation is performed via a linear least-squares fit on the log-transformed relation:\n    ln(Nu) = gamma * ln(Ra) + delta * ln(Pr) + c\n\n    Args:\n        ra: Numpy array of Rayleigh numbers.\n        pr: Numpy array of Prandtl numbers.\n        nu: Numpy array of Nusselt numbers.\n\n    Returns:\n        A tuple containing the estimated (gamma, delta). If a parameter has\n        negligible variance in the dataset, its corresponding exponent is NaN.\n    \"\"\"\n    log_ra = np.log(ra)\n    log_pr = np.log(pr)\n    log_nu = np.log(nu)\n\n    # Use a small tolerance to check for negligible variance\n    variance_tolerance = 1e-12\n\n    var_ra = np.var(log_ra)\n    var_pr = np.var(log_pr)\n\n    ra_is_const = var_ra  variance_tolerance\n    pr_is_const = var_pr  variance_tolerance\n\n    gamma_est = np.nan\n    delta_est = np.nan\n\n    if not ra_is_const and not pr_is_const:\n        # Both Ra and Pr vary, perform a full regression\n        A = np.vstack([log_ra, log_pr, np.ones(len(log_ra))]).T\n        coeffs, _, _, _ = np.linalg.lstsq(A, log_nu, rcond=None)\n        gamma_est, delta_est = coeffs[0], coeffs[1]\n    elif not ra_is_const and pr_is_const:\n        # Only Ra varies\n        A = np.vstack([log_ra, np.ones(len(log_ra))]).T\n        coeffs, _, _, _ = np.linalg.lstsq(A, log_nu, rcond=None)\n        gamma_est = coeffs[0]\n        # delta_est remains NaN\n    elif ra_is_const and not pr_is_const:\n        # Only Pr varies\n        A = np.vstack([log_pr, np.ones(len(log_pr))]).T\n        coeffs, _, _, _ = np.linalg.lstsq(A, log_nu, rcond=None)\n        delta_est = coeffs[0]\n        # gamma_est remains NaN\n    # else: if both are constant, both exponents remain NaN, which is the default.\n\n    return gamma_est, delta_est\n\ndef solve():\n    \"\"\"\n    Main function to define datasets, generate data, estimate exponents, and print results.\n    \"\"\"\n    test_suite = [\n        # Dataset A (ultimate-like)\n        {\n            \"C\": 2e-4, \"gamma\": 0.5, \"delta\": 0.5,\n            \"Ra_list\": [1e12, 3e12, 1e13, 3e13, 1e14],\n            \"Pr_list\": [0.7, 1.0, 2.0, 5.0]\n        },\n        # Dataset B (classical-like)\n        {\n            \"C\": 0.07, \"gamma\": 0.31, \"delta\": 0.0,\n            \"Ra_list\": [1e12, 3e12, 1e13, 3e13, 1e14],\n            \"Pr_list\": [0.7, 2.0, 5.0]\n        },\n        # Dataset C (edge case with narrow Pr variation)\n        {\n            \"C\": 0.05, \"gamma\": 0.31, \"delta\": 0.1,\n            \"Ra_list\": [1e12, 2e12, 5e12, 1e13],\n            \"Pr_list\": [0.95, 1.0, 1.05]\n        }\n    ]\n\n    all_results = []\n    for params in test_suite:\n        C = params[\"C\"]\n        gamma_true = params[\"gamma\"]\n        delta_true = params[\"delta\"]\n        ra_list = np.array(params[\"Ra_list\"])\n        pr_list = np.array(params[\"Pr_list\"])\n\n        # Create the full dataset from cross-combinations\n        ra_grid, pr_grid = np.meshgrid(ra_list, pr_list)\n        ra_flat = ra_grid.flatten()\n        pr_flat = pr_grid.flatten()\n\n        # Generate Nu data using the provided model\n        nu_data = C * (ra_flat ** gamma_true) * (pr_flat ** delta_true)\n\n        # Estimate exponents\n        gamma_est, delta_est = estimate_exponents(ra_flat, pr_flat, nu_data)\n        all_results.extend([gamma_est, delta_est])\n\n    # Format the output as specified\n    # Using np.nan_to_num to handle any potential NaNs if needed, though not expected for these cases.\n    formatted_results = [f\"{x:.6f}\" for x in np.nan_to_num(all_results)]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}