{
    "hands_on_practices": [
        {
            "introduction": "A fundamental question in thermal science is predicting the transition from a static, purely conductive state to a dynamic, convective one. This practice delves into this question using the classic example of Rayleigh-Bénard convection, where a fluid layer is heated from below. By performing a linear stability analysis on the governing equations, you will derive the critical Rayleigh number ($Ra_c$)—a dimensionless parameter that single-handedly determines the onset of fluid motion—and explore how this critical value is influenced by physical boundary conditions . This exercise is a masterclass in deriving a critical dimensionless number from first principles, demonstrating its power as a predictor of system stability.",
            "id": "3946574",
            "problem": "Consider an infinite horizontal layer of a Newtonian fluid of thickness $H$, heated from below with a fixed temperature difference $\\Delta T$ between the bottom and top surfaces. Assume the Boussinesq approximation holds, the base state is purely conductive, and the boundaries are perfectly thermally conducting so that the temperature perturbation vanishes at the boundaries. Let the dimensionless vertical coordinate be $z \\in [0,1]$, and nondimensionalize lengths by $H$, time by $H^{2}/\\alpha$, velocity by $\\alpha/H$, and temperature perturbations by $\\Delta T$, where $\\alpha$ is the thermal diffusivity.\n\n- Under the Boussinesq approximation, start from the linearized, nondimensional governing equations for infinitesimal perturbations to the conductive base state in terms of the dimensionless velocity field $\\boldsymbol{u}$, pressure $p$, and temperature perturbation $\\theta$. Use a normal mode ansatz with horizontal wavenumber magnitude $a$ and growth rate $\\sigma$ to obtain a one-dimensional eigenvalue problem in $z$ that determines the neutral stability condition ($\\sigma = 0$) at the onset of convection.\n\n- For mechanically free–free (stress-free) boundaries at $z=0$ and $z=1$, impose the kinematic conditions appropriate to stress-free surfaces, and the thermal boundary condition $\\theta=0$ at both boundaries. Using these boundary conditions, determine the neutral stability relationship $Ra(a)$ between the Rayleigh number $Ra$ and the horizontal wavenumber $a$. Then, find the critical Rayleigh number $Ra_{c,\\text{FF}}$ for the onset of convection by minimizing $Ra(a)$ over $a0$ and provide the exact analytical expression for $Ra_{c,\\text{FF}}$.\n\n- For mechanically rigid–rigid (no-slip) boundaries with the same thermal boundary conditions, the corresponding linear eigenvalue problem does not admit a simple closed-form analytical neutral curve, but its critical Rayleigh number is known numerically. Use the known value $Ra_{c,\\text{RR}} = 1707.76$ from numerical solution of the no-slip boundary eigenvalue problem.\n\nCompute the ratio\n$$\\chi = \\frac{Ra_{c,\\text{RR}}}{Ra_{c,\\text{FF}}}$$\nand report $\\chi$ rounded to four significant figures. The final answer must be this single real-valued number. Since the Rayleigh number is dimensionless, no units are required.",
            "solution": "The problem requires the calculation of the ratio of critical Rayleigh numbers for the onset of convection in a fluid layer heated from below, for two different sets of mechanical boundary conditions: rigid-rigid and free-free.\n\nFirst, we establish the governing equations. The linearized, nondimensional Boussinesq equations for perturbations to a quiescent, conductive base state are given by:\nContinuity:\n$$ \\nabla \\cdot \\boldsymbol{u} = 0 $$\nMomentum:\n$$ \\frac{1}{\\text{Pr}} \\frac{\\partial \\boldsymbol{u}}{\\partial t} = -\\nabla p + \\nabla^2 \\boldsymbol{u} + \\text{Ra} \\, \\theta \\, \\hat{\\boldsymbol{k}} $$\nEnergy:\n$$ \\frac{\\partial \\theta}{\\partial t} = w + \\nabla^2 \\theta $$\nHere, $\\boldsymbol{u} = (u,v,w)$ is the dimensionless velocity perturbation, $p$ is the pressure perturbation, $\\theta$ is the temperature perturbation, $\\text{Ra}$ is the Rayleigh number, $\\text{Pr}$ is the Prandtl number, and $\\hat{\\boldsymbol{k}}$ is the unit vector in the vertical direction, $z$.\n\nWe analyze the stability by introducing normal modes for the variables. We seek solutions of the form:\n$$ (w, \\theta) = (W(z), \\Theta(z)) \\exp(i(k_x x + k_y y) + \\sigma t) $$\nwhere $a = \\sqrt{k_x^2 + k_y^2}$ is the magnitude of the horizontal wavenumber and $\\sigma$ is the growth rate. After eliminating other variables, the system of ODEs for the amplitudes $W(z)$ and $\\Theta(z)$ at the point of neutral stability ($\\sigma=0$) is:\n$$ (D^2 - a^2)^2 W = \\text{Ra} \\, a^2 \\Theta $$\n$$ W = -(D^2 - a^2) \\Theta $$\nwhere $D=d/dz$. These can be combined into a single sixth-order ODE for $W(z)$:\n$$ (D^2 - a^2)^3 W + \\text{Ra} \\, a^2 W = 0 $$\nThis is the eigenvalue problem for the Rayleigh number $\\text{Ra}$.\n\nFor the case of free-free boundaries at $z=0$ and $z=1$, the boundary conditions are:\n1.  No vertical velocity at the boundaries: $w=0 \\implies W(0)=W(1)=0$.\n2.  Perfectly conducting boundaries: $\\theta=0 \\implies \\Theta(0)=\\Theta(1)=0$.\n3.  Stress-free surfaces: $\\frac{\\partial u}{\\partial z} = \\frac{\\partial v}{\\partial z} = 0$, which is equivalent to $D^2W(0)=D^2W(1)=0$.\n\nThe simplest non-trivial eigenfunction satisfying these boundary conditions is of the form $W(z) = A \\sin(n\\pi z)$ for an integer $n$. Substituting this form into the governing ODE, we note that the operator $(D^2 - a^2)$ acts as a multiplicative constant: $(-(n\\pi)^2 - a^2)$. The ODE thus becomes an algebraic equation for the eigenvalue $\\text{Ra}$:\n$$ -((n\\pi)^2 + a^2)^3 + \\text{Ra} \\, a^2 = 0 $$\n$$ \\text{Ra}(a, n) = \\frac{((n\\pi)^2 + a^2)^3}{a^2} $$\nThe onset of convection corresponds to the lowest possible Rayleigh number, which occurs for the lowest energy mode, $n=1$. So we consider:\n$$ \\text{Ra}(a) = \\frac{(\\pi^2 + a^2)^3}{a^2} $$\nTo find the critical Rayleigh number, we must minimize $\\text{Ra}(a)$ with respect to the horizontal wavenumber $a$. We compute the derivative and set it to zero:\n$$ \\frac{d\\text{Ra}}{da} = \\frac{3(\\pi^2+a^2)^2(2a)(a^2) - (\\pi^2+a^2)^3(2a)}{a^4} = 0 $$\nFor $a>0$, this simplifies to:\n$$ 3a^2(\\pi^2+a^2)^2 = (\\pi^2+a^2)^3 $$\n$$ 3a^2 = \\pi^2 + a^2 $$\n$$ 2a^2 = \\pi^2 \\implies a_c^2 = \\frac{\\pi^2}{2} $$\nThe critical wavenumber is $a_c = \\pi/\\sqrt{2}$. Substituting this value back into the expression for $\\text{Ra}(a)$ gives the critical Rayleigh number for free-free boundaries, $\\text{Ra}_{c,\\text{FF}}$:\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{(\\pi^2 + \\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^4}{4} $$\nThis is the exact analytical expression for $\\text{Ra}_{c,\\text{FF}}$.\n\nThe problem provides the numerically computed critical Rayleigh number for rigid-rigid boundaries:\n$$ \\text{Ra}_{c,\\text{RR}} = 1707.76 $$\nWe can now compute the ratio $\\chi$:\n$$ \\chi = \\frac{\\text{Ra}_{c,\\text{RR}}}{\\text{Ra}_{c,\\text{FF}}} = \\frac{1707.76}{\\frac{27\\pi^4}{4}} $$\nFirst, we calculate the numerical value of $\\text{Ra}_{c,\\text{FF}}$:\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{27}{4}\\pi^4 \\approx 6.75 \\times (3.14159265...)^4 \\approx 6.75 \\times 97.409091... \\approx 657.51136... $$\nNow, the ratio is:\n$$ \\chi = \\frac{1707.76}{657.51136...} \\approx 2.597305... $$\nRounding this value to four significant figures gives:\n$$ \\chi \\approx 2.597 $$",
            "answer": "$$\\boxed{2.597}$$"
        },
        {
            "introduction": "Once convection is established, its efficiency depends on the intricate coupling between the flow field and the temperature field. This practice explores how the Prandtl number ($Pr$), which compares the rates of momentum and thermal diffusion, governs this coupling. By analyzing flow over a flat plate using asymptotic methods, you will discover how the heat transfer scaling law, expressed as $Nu_x \\sim Re_x^a Pr^b$, changes dramatically between different classes of fluids, such as liquid metals ($Pr \\ll 1$) and gases ($Pr \\sim 1$) . This exercise highlights the role of dimensionless numbers not just in predicting transitions, but in classifying the fundamental physics of transport in different regimes.",
            "id": "3946643",
            "problem": "Consider steady, two-dimensional, laminar forced convection of an incompressible fluid of constant properties with free-stream velocity $U_{\\infty}$ flowing over an isothermal, semi-infinite flat plate at wall temperature $T_{w}$ with free-stream temperature $T_{\\infty}$. Let the kinematic viscosity be $\\nu$, the thermal diffusivity be $\\alpha$, and the thermal conductivity be $k$. Under boundary-layer conditions (negligible streamwise diffusion in momentum and energy, negligible pressure gradient), the governing boundary-layer equations are\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0,\n$$\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^{2} u}{\\partial y^{2}},\n$$\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}},\n$$\nwith boundary conditions $u(x,0)=0$, $T(x,0)=T_{w}$, $u(x,y\\to\\infty)=U_{\\infty}$, $T(x,y\\to\\infty)=T_{\\infty}$.\n\nDefine the Reynolds number $Re_{x} = \\frac{U_{\\infty} x}{\\nu}$, the Prandtl number $Pr = \\frac{\\nu}{\\alpha}$, and the local Nusselt number $Nu_{x} = \\frac{h_{x} x}{k}$, where $h_{x}$ is the local convective heat transfer coefficient. You may use the well-tested Blasius scaling for the velocity boundary-layer thickness $\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}$ and the near-wall linear shear approximation $u \\approx a\\,y$ with $a \\sim \\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0} \\sim \\frac{U_{\\infty}}{\\delta_{v}}$ where appropriate.\n\nUsing matched asymptotic analysis between the inner region ($y = \\mathcal{O}(\\delta_{v})$) and the outer thermal region ($y = \\mathcal{O}(\\delta_{T})$), determine how the scaling exponents in the canonical form\n$$\nNu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}\n$$\nmust change when going from a fluid with $Pr \\approx 0.7$ (air, $Pr = \\mathcal{O}(1)$) to a liquid metal with $Pr \\approx 0.01$ ($Pr \\ll 1$). Here $K$ is a dimensionless constant that may differ between regimes but should not be evaluated; the task is to deduce the exponents $a$ and $b$ by dominant-balance arguments and asymptotic matching of inner and outer solutions.\n\nAssume $Re_{x}$ is sufficiently large that a laminar boundary layer exists and streamwise conduction is negligible in the energy equation. Do not use empirical heat transfer correlations; derive the dependence from the boundary-layer equations and asymptotic matching. Express your final answer as the ordered quadruple of exponents $\\left(a_{\\text{air}},\\,b_{\\text{air}},\\,a_{\\text{metal}},\\,b_{\\text{metal}}\\right)$ in a single row matrix. No numerical rounding is required, and the exponents should be given in exact fractional form without units.",
            "solution": "The objective is to determine the scaling exponents $a$ and $b$ in the relation $Nu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}$ for two distinct regimes of the Prandtl number, $Pr \\sim \\mathcal{O}(1)$ and $Pr \\ll 1$.\n\nThe local Nusselt number, $Nu_{x}$, is defined as $Nu_{x} = \\frac{h_{x} x}{k}$. The local heat transfer coefficient $h_x$ is found by relating Newton's law of cooling, $q''_{w} = h_{x}(T_{w} - T_{\\infty})$, to Fourier's law at the wall, $q''_{w} = -k \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0}$. This gives $h_{x} = \\frac{-k}{T_{w} - T_{\\infty}} \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0}$.\n\nSubstituting this into the definition of $Nu_x$:\n$$\nNu_{x} = \\frac{x}{k} \\left( \\frac{-k}{T_{w} - T_{\\infty}} \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} \\right) = \\frac{-x}{T_{w} - T_{\\infty}} \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0}\n$$\nA scaling estimate for the wall-normal temperature gradient is $\\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} \\sim \\frac{T_{\\infty} - T_{w}}{\\delta_{T}}$, where $\\delta_{T}$ is the characteristic thickness of the thermal boundary layer. This simplifies the Nusselt number scaling to:\n$$\nNu_{x} \\sim \\frac{x}{\\delta_{T}}\n$$\nThus, the problem reduces to determining the scaling of the thermal boundary layer thickness $\\delta_{T}(x)$ for the two Prandtl number regimes.\n\n**Case 1: Fluid with $Pr \\approx 0.7$ (e.g., air, $Pr = \\mathcal{O}(1)$)**\nIn this regime, the kinematic viscosity $\\nu$ and the thermal diffusivity $\\alpha$ are of the same order. This means momentum and heat diffuse at comparable rates, so the thickness of the velocity boundary layer, $\\delta_{v}$, and the thermal boundary layer, $\\delta_{T}$, are of the same order: $\\delta_{T} \\sim \\delta_{v}$. Using the provided scaling for the Blasius velocity boundary layer, $\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}$, we have $\\delta_{T}(x) \\sim x\\,Re_{x}^{-1/2}$.\nSubstituting this into our scaling for the Nusselt number:\n$$\nNu_{x} \\sim \\frac{x}{\\delta_{T}} \\sim \\frac{x}{x\\,Re_{x}^{-1/2}} = Re_{x}^{1/2}\n$$\nThis determines that $a_{\\text{air}} = \\frac{1}{2}$. For this regime, the established similarity solution (the Pohlhausen solution) yields a dependence on the Prandtl number as $Nu_{x} \\propto Pr^{1/3}$. Therefore, we take the scaling exponents to be:\n$$\na_{\\text{air}} = \\frac{1}{2}, \\quad b_{\\text{air}} = \\frac{1}{3}\n$$\n\n**Case 2: Liquid metal with $Pr \\ll 1$**\nFor a liquid metal, $Pr = \\frac{\\nu}{\\alpha} \\ll 1$, which implies $\\alpha \\gg \\nu$. Heat diffuses much faster than momentum, resulting in a thermal boundary layer that is significantly thicker than the velocity boundary layer: $\\delta_{T} \\gg \\delta_{v}$.\nIn this case, the velocity within the majority of the thermal boundary layer is approximately the free-stream velocity, $u \\approx U_{\\infty}$. The energy equation, $u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}$, simplifies by balancing the streamwise advection and wall-normal diffusion terms:\n$$\nU_{\\infty} \\frac{\\partial T}{\\partial x} \\approx \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}\n$$\nA scaling analysis of this equation gives:\n$$\nU_{\\infty} \\frac{\\Delta T}{x} \\sim \\alpha \\frac{\\Delta T}{\\delta_{T}^{2}} \\implies \\delta_{T}^{2} \\sim \\frac{\\alpha x}{U_{\\infty}}\n$$\nSolving for $\\delta_{T}$ and expressing it in terms of dimensionless numbers:\n$$\n\\delta_{T} \\sim \\sqrt{\\frac{\\alpha x}{U_{\\infty}}} = \\sqrt{\\frac{\\nu x}{U_{\\infty}} \\cdot \\frac{\\alpha}{\\nu}} = \\sqrt{\\frac{x^2}{Re_x} \\cdot \\frac{1}{Pr}} = x \\, Re_{x}^{-1/2} \\, Pr^{-1/2}\n$$\nThe assumption $\\delta_{T} \\gg \\delta_{v}$ is consistent, as $\\delta_{T}/\\delta_{v} \\sim Pr^{-1/2} \\gg 1$. The Nusselt number scaling becomes:\n$$\nNu_{x} \\sim \\frac{x}{\\delta_{T}} \\sim \\frac{x}{x \\, Re_{x}^{-1/2} \\, Pr^{-1/2}} = Re_{x}^{1/2} \\, Pr^{1/2}\n$$\nThis gives the scaling exponents for the low-Prandtl-number regime:\n$$\na_{\\text{metal}} = \\frac{1}{2}, \\quad b_{\\text{metal}} = \\frac{1}{2}\n$$\n\nCombining the results, the exponents are $(a_{\\text{air}}, b_{\\text{air}}) = (\\frac{1}{2}, \\frac{1}{3})$ and $(a_{\\text{metal}}, b_{\\text{metal}}) = (\\frac{1}{2}, \\frac{1}{2})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{3}  \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "At the frontier of thermal engineering lies the challenge of understanding and predicting fully turbulent heat transfer. This practice tackles one of the most profound concepts in turbulence theory: the \"ultimate regime\" of convection, where global heat transport is hypothesized to become independent of the fluid's molecular properties. Starting from exact global energy balance relations for Rayleigh-Bénard convection, you will derive the theoretical scaling exponents for the Nusselt number ($Nu$) as a function of the Rayleigh ($Ra$) and Prandtl ($Pr$) numbers in this regime. You will then apply your theoretical understanding to analyze synthetic Direct Numerical Simulation (DNS) data, bridging the gap between first-principles theory and computational research .",
            "id": "3946571",
            "problem": "You are given three synthetic datasets that emulate Direct Numerical Simulation (DNS) of Rayleigh–Bénard convection (RBC) at large Rayleigh number $Ra$ and varying Prandtl number $Pr$. Your task is to estimate the exponents $\\gamma$ and $\\delta$ in the scaling relation $Nu \\sim Ra^{\\gamma} Pr^{\\delta}$ and to justify, from first principles, how ultimate-regime hypotheses constrain the exponents $\\gamma$ and $\\delta$.\n\nUse the following dimensionless number definitions and RBC context as the fundamental base:\n- Rayleigh number $Ra$, defined as $Ra = \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha}$, where $g$ is gravitational acceleration, $\\beta$ is the thermal expansion coefficient, $\\Delta T$ is the imposed temperature difference, $H$ is the height of the convection cell, $\\nu$ is kinematic viscosity, and $\\alpha$ is thermal diffusivity.\n- Prandtl number $Pr$, defined as $Pr = \\dfrac{\\nu}{\\alpha}$.\n- Nusselt number $Nu$, defined as $Nu = \\dfrac{q H}{k \\Delta T}$, where $q$ is the mean vertical heat flux and $k$ is thermal conductivity.\n\nAssume that the Nusselt number $Nu$ measured from DNS obeys a power-law relation with $Ra$ and $Pr$ at sufficiently large $Ra$, i.e., $Nu \\sim Ra^{\\gamma} Pr^{\\delta}$, with unknown exponents $\\gamma$ and $\\delta$. The DNS-like synthetic datasets provided below consist of triplets $(Ra_i, Pr_i, Nu_i)$ for $i=1,\\dots,N$. Your program must estimate $\\gamma$ and $\\delta$ by performing a least-squares fit on the logarithmically transformed relation:\n$$\\ln(Nu_i) = \\gamma \\ln(Ra_i) + \\delta \\ln(Pr_i) + c,$$\nwhere $c$ is an intercept accounting for the prefactor.\n\nIn addition to computing the exponents, you must explain, starting from the exact global balance relations and standard turbulence hypotheses, how the ultimate-regime assumptions constrain $\\gamma$ and $\\delta$. The ultimate regime refers to the state in which both the thermal and viscous boundary layers are fully turbulent and the bulk dynamics dominate the global balances.\n\nExact global balance relations for RBC that you may use as foundational starting points are:\n- For kinetic energy dissipation rate per unit mass $\\varepsilon_u$:\n$$\\varepsilon_u = \\dfrac{\\nu^3}{H^4} Ra \\, (Nu - 1) \\, Pr^{-2}.$$\n- For thermal variance dissipation rate per unit mass $\\varepsilon_\\theta$:\n$$\\varepsilon_\\theta = \\dfrac{\\alpha \\, \\Delta T^2}{H^2} Nu.$$\n\nThese relations and the definitions above are well-tested and fundamental; do not assume any target scaling exponents or shortcut formulas beyond these bases in your explanation.\n\nProgram requirements:\n1. Implement a routine that, given a dataset of $(Ra_i, Pr_i, Nu_i)$, estimates $\\gamma$ and $\\delta$ via linear least squares on $\\ln(Nu)$ against $\\ln(Ra)$ and $\\ln(Pr)$. Compute the solution robustly even if the columns are nearly collinear. If one of the regressors has negligible variance across the dataset (e.g., nearly constant $Pr$), set the corresponding exponent to NaN and fit the remaining parameters consistently.\n2. Use natural logarithms for all transformations.\n3. Use the following test suite of three datasets, each consisting of cross-combinations of $Ra$ and $Pr$, with $Nu$ constructed from a known prefactor and exponents to emulate different regimes:\n   - Dataset A (ultimate-like, bulk dominated):\n     - Prefactor $C = 2 \\times 10^{-4}$, exponents $(\\gamma, \\delta) = (0.5, 0.5)$.\n     - $Ra \\in \\{10^{12}, 3 \\times 10^{12}, 10^{13}, 3 \\times 10^{13}, 10^{14}\\}$ and $Pr \\in \\{0.7, 1.0, 2.0, 5.0\\}$.\n     - $Nu$ is generated as $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$ for each pair.\n   - Dataset B (classical-like, boundary-layer influenced):\n     - Prefactor $C = 0.07$, exponents $(\\gamma, \\delta) = (0.31, 0.0)$.\n     - $Ra \\in \\{10^{12}, 3 \\times 10^{12}, 10^{13}, 3 \\times 10^{13}, 10^{14}\\}$ and $Pr \\in \\{0.7, 2.0, 5.0\\}$.\n     - $Nu$ is generated as $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$.\n   - Dataset C (edge case with narrow $Pr$ variation):\n     - Prefactor $C = 0.05$, exponents $(\\gamma, \\delta) = (0.31, 0.1)$.\n     - $Ra \\in \\{10^{12}, 2 \\times 10^{12}, 5 \\times 10^{12}, 10^{13}\\}$ and $Pr \\in \\{0.95, 1.0, 1.05\\}$.\n     - $Nu$ is generated as $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$.\n\nOutput specification:\n- Produce a single line of output containing the flattened list of the estimated exponents for the three datasets in the order A, B, C, rounded to six decimal places, with no units (dimensionless): $[\\gamma_A, \\delta_A, \\gamma_B, \\delta_B, \\gamma_C, \\delta_C]$.\n- Your output must be a comma-separated list enclosed in square brackets, e.g., $[0.500000,0.500000,0.310000,0.000000,0.310000,0.100000]$.\n\nNo physical units are to be reported because $Ra$, $Pr$, $Nu$, $\\gamma$, and $\\delta$ are dimensionless. Angles are not involved.",
            "solution": "The solution is divided into two parts: a theoretical derivation of the ultimate-regime scaling exponents from first principles, and the numerical estimation of these exponents from provided datasets.\n\n### Part 1: Theoretical Derivation of Ultimate-Regime Scaling Exponents\n\nThe problem asks for a derivation of the exponents $\\gamma$ and $\\delta$ in the scaling relation $Nu \\sim Ra^{\\gamma} Pr^{\\delta}$ under the hypothesis of an \"ultimate regime\" of turbulence. We begin with the provided exact global balance relations for a statistically steady state of Rayleigh-Bénard convection (RBC). For very large Rayleigh numbers, $Nu \\gg 1$, so the term $(Nu - 1)$ can be approximated by $Nu$.\n\nThe global balance for the average kinetic energy dissipation rate per unit mass, $\\varepsilon_u$, is:\n$$ \\varepsilon_u = \\dfrac{\\nu^3}{H^4} Ra \\, (Nu - 1) \\, Pr^{-2} \\approx \\dfrac{\\nu^3}{H^4} Ra \\, Nu \\, Pr^{-2} \\quad (\\text{for } Nu \\gg 1) $$\nThe global balance for the average thermal variance dissipation rate per unit mass, $\\varepsilon_\\theta$, is:\n$$ \\varepsilon_\\theta = \\dfrac{\\alpha \\, \\Delta T^2}{H^2} Nu $$\n\nThe \"ultimate regime\" hypothesis posits that at sufficiently high Rayleigh numbers, the bulk of the fluid becomes fully turbulent. In this state, the global energy dissipation rates, which are dominated by the large-scale turbulent motions in the bulk, become independent of the molecular transport properties of the fluid: the kinematic viscosity, $\\nu$, and the thermal diffusivity, $\\alpha$.\n\nLet us apply this hypothesis. We first express the dissipation rates in terms of the fundamental parameters by substituting the definitions of $Ra = \\frac{g \\beta \\Delta T H^3}{\\nu \\alpha}$ and $Pr = \\frac{\\nu}{\\alpha}$:\n\nFor $\\varepsilon_u$:\n$$ \\varepsilon_u \\approx \\dfrac{\\nu^3}{H^4} \\left( \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha} \\right) Nu \\left( \\dfrac{\\nu}{\\alpha} \\right)^{-2} = \\dfrac{\\nu^3}{H^4} \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha} Nu \\dfrac{\\alpha^2}{\\nu^2} = \\dfrac{g \\beta \\alpha \\Delta T Nu}{H} $$\nFor $\\varepsilon_\\theta$:\n$$ \\varepsilon_\\theta = \\dfrac{\\alpha \\, \\Delta T^2}{H^2} Nu $$\n\nAccording to the ultimate regime hypothesis, both $\\varepsilon_u$ and $\\varepsilon_\\theta$ must become independent of $\\nu$ and $\\alpha$. From their expressions, this is equivalent to the condition that the product $\\alpha Nu$ becomes independent of both $\\nu$ and $\\alpha$, as all other factors ($g, \\beta, \\Delta T, H$) are external parameters.\n\nWe substitute the posited scaling law $Nu = C \\, Ra^{\\gamma} Pr^{\\delta}$ into the product $\\alpha Nu$:\n$$ \\alpha Nu = \\alpha C \\left( \\dfrac{g \\beta \\Delta T H^3}{\\nu \\alpha} \\right)^{\\gamma} \\left( \\dfrac{\\nu}{\\alpha} \\right)^{\\delta} $$\nwhere $C$ is a dimensionless prefactor. To analyze the dependence on $\\nu$ and $\\alpha$, we group the terms containing these properties:\n$$ \\alpha Nu = C (g \\beta \\Delta T H^3)^{\\gamma} \\alpha^{1} (\\nu \\alpha)^{-\\gamma} (\\nu \\alpha^{-1})^{\\delta} $$\n$$ \\alpha Nu = C (g \\beta \\Delta T H^3)^{\\gamma} \\alpha^{1} \\nu^{-\\gamma} \\alpha^{-\\gamma} \\nu^{\\delta} \\alpha^{-\\delta} $$\nCombining the exponents for $\\nu$ and $\\alpha$ yields:\n$$ \\alpha Nu \\propto \\nu^{\\delta - \\gamma} \\alpha^{1 - \\gamma - \\delta} $$\nFor this entire expression to be independent of $\\nu$ and $\\alpha$, the exponents of $\\nu$ and $\\alpha$ must both be equal to zero. This gives a system of two linear equations for the two unknown exponents, $\\gamma$ and $\\delta$:\n\n1.  Exponent of $\\nu$: $\\delta - \\gamma = 0 \\implies \\gamma = \\delta$\n2.  Exponent of $\\alpha$: $1 - \\gamma - \\delta = 0 \\implies \\gamma + \\delta = 1$\n\nSubstituting the first equation into the second gives:\n$$ \\gamma + \\gamma = 1 \\implies 2\\gamma = 1 \\implies \\gamma = \\dfrac{1}{2} $$\nSince $\\delta = \\gamma$, it follows that:\n$$ \\delta = \\dfrac{1}{2} $$\nThus, the ultimate-regime hypothesis, when applied to the exact global balance relations, uniquely constrains the scaling exponents to be $\\gamma = 1/2$ and $\\delta = 1/2$. The predicted scaling law is $Nu \\sim Ra^{1/2} Pr^{1/2}$.\n\n### Part 2: Numerical Estimation of Scaling Exponents\n\nThe numerical estimation requires fitting the log-transformed model $ \\ln(Nu_i) = \\gamma \\ln(Ra_i) + \\delta \\ln(Pr_i) + c $ using multiple linear regression. The provided Python code implements this procedure robustly using `numpy.linalg.lstsq`, correctly generates the synthetic datasets, estimates the exponents for each, and formats the output as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_exponents(ra: np.ndarray, pr: np.ndarray, nu: np.ndarray) -> tuple[float, float]:\n    \"\"\"\n    Estimates the exponents gamma and delta in the scaling law Nu ~ Ra^gamma * Pr^delta.\n\n    The estimation is performed via a linear least-squares fit on the log-transformed relation:\n    ln(Nu) = gamma * ln(Ra) + delta * ln(Pr) + c\n\n    Args:\n        ra: Numpy array of Rayleigh numbers.\n        pr: Numpy array of Prandtl numbers.\n        nu: Numpy array of Nusselt numbers.\n\n    Returns:\n        A tuple containing the estimated (gamma, delta). If a parameter has\n        negligible variance in the dataset, its corresponding exponent is NaN.\n    \"\"\"\n    log_ra = np.log(ra)\n    log_pr = np.log(pr)\n    log_nu = np.log(nu)\n\n    # Use a small tolerance to check for negligible variance\n    variance_tolerance = 1e-12\n\n    var_ra = np.var(log_ra)\n    var_pr = np.var(log_pr)\n\n    ra_is_const = var_ra  variance_tolerance\n    pr_is_const = var_pr  variance_tolerance\n\n    gamma_est = np.nan\n    delta_est = np.nan\n\n    if not ra_is_const and not pr_is_const:\n        # Both Ra and Pr vary, perform a full regression\n        A = np.vstack([log_ra, log_pr, np.ones(len(log_ra))]).T\n        coeffs, _, _, _ = np.linalg.lstsq(A, log_nu, rcond=None)\n        gamma_est, delta_est = coeffs[0], coeffs[1]\n    elif not ra_is_const and pr_is_const:\n        # Only Ra varies\n        A = np.vstack([log_ra, np.ones(len(log_ra))]).T\n        coeffs, _, _, _ = np.linalg.lstsq(A, log_nu, rcond=None)\n        gamma_est = coeffs[0]\n        # delta_est remains NaN\n    elif ra_is_const and not pr_is_const:\n        # Only Pr varies\n        A = np.vstack([log_pr, np.ones(len(log_pr))]).T\n        coeffs, _, _, _ = np.linalg.lstsq(A, log_nu, rcond=None)\n        delta_est = coeffs[0]\n        # gamma_est remains NaN\n    # else: if both are constant, both exponents remain NaN, which is the default.\n\n    return gamma_est, delta_est\n\ndef solve():\n    \"\"\"\n    Main function to define datasets, generate data, estimate exponents, and print results.\n    \"\"\"\n    test_suite = [\n        # Dataset A (ultimate-like)\n        {\n            \"C\": 2e-4, \"gamma\": 0.5, \"delta\": 0.5,\n            \"Ra_list\": [1e12, 3e12, 1e13, 3e13, 1e14],\n            \"Pr_list\": [0.7, 1.0, 2.0, 5.0]\n        },\n        # Dataset B (classical-like)\n        {\n            \"C\": 0.07, \"gamma\": 0.31, \"delta\": 0.0,\n            \"Ra_list\": [1e12, 3e12, 1e13, 3e13, 1e14],\n            \"Pr_list\": [0.7, 2.0, 5.0]\n        },\n        # Dataset C (edge case with narrow Pr variation)\n        {\n            \"C\": 0.05, \"gamma\": 0.31, \"delta\": 0.1,\n            \"Ra_list\": [1e12, 2e12, 5e12, 1e13],\n            \"Pr_list\": [0.95, 1.0, 1.05]\n        }\n    ]\n\n    all_results = []\n    for params in test_suite:\n        C = params[\"C\"]\n        gamma_true = params[\"gamma\"]\n        delta_true = params[\"delta\"]\n        ra_list = np.array(params[\"Ra_list\"])\n        pr_list = np.array(params[\"Pr_list\"])\n\n        # Create the full dataset from cross-combinations\n        ra_grid, pr_grid = np.meshgrid(ra_list, pr_list)\n        ra_flat = ra_grid.flatten()\n        pr_flat = pr_grid.flatten()\n\n        # Generate Nu data using the provided model\n        nu_data = C * (ra_flat ** gamma_true) * (pr_flat ** delta_true)\n\n        # Estimate exponents\n        gamma_est, delta_est = estimate_exponents(ra_flat, pr_flat, nu_data)\n        all_results.extend([gamma_est, delta_est])\n\n    # Format the output as specified\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}