{
    "hands_on_practices": [
        {
            "introduction": "Dirichlet (第一类) 边界条件是计算模型中最基本的边界类型，它直接指定了边界上的温度值。本练习将指导你使用显式有限差分法对瞬态热传导方程进行离散化，并分析该方法的数值稳定性。通过这个实践，你将深刻理解物理模型、数值方法和稳定性条件三者之间紧密的内在联系，这是进行任何瞬态仿真计算的基石。",
            "id": "3938346",
            "problem": "考虑一个占据区间 $x \\in [0,L]$、具有恒定热物理性质的均质板中的一维热传导。令 $T(x,t)$ 表示温度场。该板遵循能量守恒和傅里叶定律。狄利克雷边界条件要求边界温度由外部热源固定。此类狄利克雷边界条件的物理意义是，边界由具有无限热容和无限热导的理想恒温器维持在指定温度，从而在所有时间 $t$ 强制执行 $T(0,t)=T_L$ 和 $T(L,t)=T_R$。\n\n从能量守恒和傅里叶定律出发，推导在密度 $\\rho$、比热容 $c$ 和热导率 $k$ 恒定的情况下，板中瞬态热传导的控制偏微分方程 (PDE)。从物理角度解释，为什么狄利克雷边界条件在边界上强制执行固定温度，以及它与诺伊曼边界条件和罗宾边界条件有何不同。然后，使用均匀网格和间距为 $h$ 的中心差分对 PDE 进行空间离散化，并使用时间步长为 $\\Delta t$ 的前向欧拉法进行时间离散化，以获得狄利克雷边界条件下内部节点的有限差分法 (FDM) 更新方程。使用基于原理的稳定性分析（能量法或傅里叶/冯·诺依曼分析），推导保证显式格式稳定性的参数 $\\alpha$、$\\Delta t$ 和 $h$ 的充分必要条件，其中 $\\alpha = k/(\\rho c)$ 是热扩散率。最后，在没有内部热源的稳态下，根据傅里叶定律推导温度分布和恒定热通量。\n\n您的程序必须实现这些推导出的结果，以评估一套参数测试集。对于每个测试用例，计算：\n- 一个布尔值，指示显式前向欧拉中心差分法离散在狄利克雷边界条件下是否稳定。\n- $x=0$ 处的稳态边界热通量，单位为瓦特每平方米 (W/m$^2$)，表示为浮点数。\n\n使用以下测试套件。所有量均以单位指定，并必须作相应解释：\n- 测试用例 1：$L = 0.1 \\text{ m}$，$N_c = 20$ 个均匀单元，$h = L/N_c$，$\\alpha = 1.2\\times 10^{-4} \\text{ m}^2/\\text{s}$，$\\Delta t = 0.052083333333 \\text{ s}$，$k = 400 \\text{ W}/(\\text{m}\\cdot\\text{K})$，$T_L = 300 \\text{ K}$，$T_R = 350 \\text{ K}$。\n- 测试用例 2：$L = 0.2 \\text{ m}$，$N_c = 40$ 个均匀单元，$h = L/N_c$，$\\alpha = 1.0\\times 10^{-5} \\text{ m}^2/\\text{s}$，$\\Delta t = 1.25 \\text{ s}$，$k = 50 \\text{ W}/(\\text{m}\\cdot\\text{K})$，$T_L = 300 \\text{ K}$，$T_R = 300 \\text{ K}$。\n- 测试用例 3：$L = 0.1 \\text{ m}$，$N_c = 20$ 个均匀单元，$h = L/N_c$，$\\alpha = 1.2\\times 10^{-4} \\text{ m}^2/\\text{s}$，$\\Delta t = 0.12 \\text{ s}$，$k = 400 \\text{ W}/(\\text{m}\\cdot\\text{K})$，$T_L = 350 \\text{ K}$，$T_R = 300 \\text{ K}$。\n- 测试用例 4：$L = 0.05 \\text{ m}$，$N_c = 100$ 个均匀单元，$h = L/N_c$，$\\alpha = 8.0\\times 10^{-5} \\text{ m}^2/\\text{s}$，$\\Delta t = 1.0\\times 10^{-4} \\text{ s}$，$k = 150 \\text{ W}/(\\text{m}\\cdot\\text{K})$，$T_L = 310 \\text{ K}$，$T_R = 330 \\text{ K}$。\n\n在所有情况下，假设没有内部体热生成，并以 W/m$^2$ 为单位表示稳态热通量。此问题中不出现角度，因此不需要角度单位。最终输出格式必须是单行，包含一个方括号括起来的逗号分隔列表，其中每个测试用例的结果本身就是一个 $[\\text{stable}, \\text{flux}]$ 形式的双元素列表，布尔值后跟浮点数。例如，程序应打印一行，如 $[[\\text{True}, -123.456],[\\text{False}, 0.0]]$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，方括号内没有空格。",
            "solution": "该问题要求对一维瞬态热传导进行全面的推导和分析，然后实施推导出的结果来解决特定的测试用例。步骤如下：推导控制偏微分方程 (PDE)，对边界条件进行物理解释，对 PDE 进行离散化，对数值格式进行稳定性分析，以及推导稳态解。\n\n**1. 控制偏微分方程的推导**\n\n热传导的控制方程源于能量守恒原理。考虑一个一维均质材料板，其性质恒定：密度 $\\rho$、比热容 $c$ 和热导率 $k$。对于板内从 $x$ 到 $x+\\Delta x$ 且具有均匀横截面积 $A$ 的任意控制体，能量平衡方程为：\n\n内能变化率 = 进入的热量率 - 离开的热量率 + 热生成率\n\n用数学形式表示为：\n$$\n\\frac{\\partial}{\\partial t} \\int_{x}^{x+\\Delta x} \\rho c T(u,t) A \\, du = A q(x,t) - A q(x+\\Delta x, t) + \\int_{x}^{x+\\Delta x} \\dot{q}_{gen}(u,t) A \\, du\n$$\n其中 $T(x,t)$ 是温度，$q(x,t)$ 是热通量（单位面积单位时间的能量），$\\dot{q}_{gen}$ 是体内热生成率。两边除以 $A\\Delta x$ 并取 $\\Delta x \\to 0$ 的极限，得到能量守恒方程的微分形式：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = -\\frac{\\partial q}{\\partial x} + \\dot{q}_{gen}\n$$\n傅里叶热传导定律将热通量与温度梯度关联起来：\n$$\nq = -k \\frac{\\partial T}{\\partial x}\n$$\n负号表示热量从高温流向低温。将傅里叶定律代入能量方程得到：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left(-k \\frac{\\partial T}{\\partial x}\\right) + \\dot{q}_{gen} = \\frac{\\partial}{\\partial x} \\left(k \\frac{\\partial T}{\\partial x}\\right) + \\dot{q}_{gen}\n$$\n对于热导率 $k$ 恒定的均质材料，并且没有内部热生成（根据题意 $\\dot{q}_{gen}=0$），方程简化为：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2}\n$$\n两边除以 $\\rho c$ 得到一维瞬态热传导方程的最终形式：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $\\alpha = k/(\\rho c)$ 是热扩散率，这是一个材料属性，衡量热量在材料中传播的速度。\n\n**2. 边界条件的物理意义**\n\n边界条件对于获得 PDE 的唯一解至关重要。它们代表了系统与其周围环境的热相互作用。\n\n- **狄利克雷边界条件（第一类）**：此条件指定边界处的固定温度，即 $T(x_b, t) = T_{prescribed}$。在物理上，这代表一个与理想热储接触的边界，该热储具有无限的热容和无限的热导。这样的热储可以吸收或提供维持其温度所需的任何热量，并将其温度施加于边界上。例子包括与正在发生相变的大量流体（例如冰水浴）接触的边界。\n\n- **诺伊曼边界条件（第二类）**：此条件指定边界处的热通量，即 $-k \\frac{\\partial T}{\\partial x}\\big|_{x_b} = q_{prescribed}$。一个特殊且常见的情况是绝热边界，其热通量为零（$q_{prescribed}=0$）。在物理上，这模拟了一个施加了已知加热或冷却速率的边界，例如来自已知功率输出的电加热器，或者一个完全绝热以防止任何热量穿过的边界。与温度固定的狄利克雷条件相反，这里的边界温度可以根据域内的热流自由演变。\n\n- **罗宾边界条件（第三类）**：此条件指定了边界温度与热通量之间的关系，通常代表与周围流体的对流换热。其表达式为 $-k \\frac{\\partial T}{\\partial x}\\big|_{x_b} = h_{conv} (T(x_b, t) - T_{\\infty})$，其中 $h_{conv}$ 是对流换热系数，$T_{\\infty}$ 是周围流体的温度。对于许多工程系统来说，此条件比狄利克雷或诺伊曼条件更真实，因为它模拟了与外部介质之间有限速率的热传递。它弥合了理想固定温度（狄利克雷，对应于 $h_{conv} \\to \\infty$）和固定通量（诺伊曼）之间的差距。\n\n**3. 有限差分离散化**\n\n为了数值求解 PDE，我们在空间和时间上对域进行离散化。空间域 $x \\in [0,L]$ 被划分为 $N_c$ 个均匀单元，产生 $N_c+1$ 个节点，索引为 $i=0, 1, \\dots, N_c$。间距为 $h=L/N_c$。时间以步长 $\\Delta t$ 离散化，时间层级由 $n$ 索引。\n令 $T_i^n \\approx T(x_i, t_n)$，其中 $x_i = i h$，$t_n = n \\Delta t$。\n\nPDE 为 $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$。\n- 时间导数使用 **前向欧拉** 法（一阶前向差分）近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n- 空间二阶导数使用 **中心差分** 格式（二阶中心差分）近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2}\n$$\n将这些近似代入 PDE：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2} \\right)\n$$\n求解下一个时间步的温度 $T_i^{n+1}$，得到内部节点（$i=1, \\dots, N_c-1$）的显式更新方程：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{h^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\n这可以用无量纲网格傅里叶数 $Fo = \\frac{\\alpha \\Delta t}{h^2}$ 来写：\n$$\nT_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = (1-2Fo)T_i^n + Fo(T_{i+1}^n + T_{i-1}^n)\n$$\n狄利克雷边界条件直接应用于边界节点：对于所有时间步 $n$，$T_0^n = T_L$ 和 $T_{N_c}^n = T_R$。\n\n**4. 稳定性分析**\n\n显式格式的稳定性使用冯·诺依曼方法进行分析。我们考虑单个傅里叶误差模式的传播，$E_i^n = \\xi^n e^{j k_m i h}$，其中 $E_i^n$ 是节点 $i$ 和时间 $n$ 处的误差，$\\xi$ 是每时间步的放大因子，$k_m$ 是波数，$j=\\sqrt{-1}$。如果对于所有可能的波数，放大因子的模 $|\\xi| \\le 1$，则格式是稳定的。误差必须满足相同的齐次有限差分方程。\n将误差项代入更新方程：\n$$\n\\xi^{n+1} e^{j k_m i h} = \\xi^n e^{j k_m i h} + Fo(\\xi^n e^{j k_m (i+1)h} - 2\\xi^n e^{j k_m i h} + \\xi^n e^{j k_m (i-1)h})\n$$\n两边除以 $\\xi^n e^{j k_m i h}$：\n$$\n\\xi = 1 + Fo(e^{j k_m h} - 2 + e^{-j k_m h})\n$$\n使用恒等式 $e^{j\\theta} + e^{-j\\theta} = 2\\cos(\\theta)$，上式变为：\n$$\n\\xi = 1 + Fo(2\\cos(k_m h) - 2) = 1 - 2Fo(1 - \\cos(k_m h))\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\n\\xi = 1 - 4Fo \\sin^2(k_m h / 2)\n$$\n为了稳定，我们要求 $|\\xi| \\le 1$，这转化为 $-1 \\le \\xi \\le 1$。\n条件 $\\xi \\le 1$ 总是满足的，因为 $Fo > 0$ 且 $\\sin^2(k_m h/2) \\ge 0$。\n关键条件是 $\\xi \\ge -1$：\n$$\n1 - 4Fo \\sin^2(k_m h / 2) \\ge -1\n$$\n$$\n2 \\ge 4Fo \\sin^2(k_m h / 2)\n$$\n$$\nFo \\le \\frac{1}{2 \\sin^2(k_m h / 2)}\n$$\n这个条件必须对所有波数 $k_m$ 都成立。最严格的情况发生在分母最小时，即 $\\sin^2(k_m h/2)$ 最大时。$\\sin^2(\\theta)$ 的最大值是 $1$。这对应于网格上可以表示的最高频率（最短波长）的误差模式，此时 $k_m h = \\pi$。\n因此，稳定性的充分必要条件是：\n$$\nFo \\le \\frac{1}{2} \\quad \\text{或} \\quad \\frac{\\alpha \\Delta t}{h^2} \\le \\frac{1}{2}\n$$\n\n**5. 稳态解**\n\n在稳态下，温度场不再随时间变化，所以 $\\frac{\\partial T}{\\partial t} = 0$。控制 PDE 简化为常微分方程 (ODE)：\n$$\n\\alpha \\frac{d^2 T}{dx^2} = 0 \\quad \\implies \\quad \\frac{d^2 T}{dx^2} = 0\n$$\n对这个 ODE 对 $x$ 积分两次，得到线性温度分布：\n$$\n\\frac{dT}{dx} = C_1\n$$\n$$\nT(x) = C_1 x + C_2\n$$\n积分常数 $C_1$ 和 $C_2$ 通过应用边界条件 $T(0)=T_L$ 和 $T(L)=T_R$ 来确定：\n- 在 $x=0$ 处：$T(0) = C_1(0) + C_2 = T_L \\implies C_2 = T_L$。\n- 在 $x=L$ 处：$T(L) = C_1 L + C_2 = T_R \\implies C_1 L + T_L = T_R \\implies C_1 = \\frac{T_R - T_L}{L}$。\n\n因此，稳态温度分布为：\n$$\nT(x) = \\left(\\frac{T_R - T_L}{L}\\right)x + T_L\n$$\n使用傅里叶定律和这个温度分布来求热通量：\n$$\nq = -k \\frac{dT}{dx} = -k C_1 = -k \\left(\\frac{T_R - T_L}{L}\\right) = k \\frac{T_L - T_R}{L}\n$$\n由于温度梯度 $\\frac{dT}{dx}$ 是恒定的，在没有内部热生成的稳态下，整个板的热通量 $q$ 也是恒定的。$x=0$ 处的通量与任何其他位置 $x \\in [0,L]$ 的通量相同。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a suite of test cases.\n    For each case, it computes:\n    1. A boolean indicating if the FDM scheme is stable.\n    2. The steady-state heat flux at x=0.\n    \"\"\"\n    test_cases = [\n        # Test case 1: L, Nc, alpha, dt, k, T_L, T_R\n        (0.1, 20, 1.2e-4, 0.052083333333, 400, 300, 350),\n        # Test case 2\n        (0.2, 40, 1.0e-5, 1.25, 50, 300, 300),\n        # Test case 3\n        (0.1, 20, 1.2e-4, 0.12, 400, 350, 300),\n        # Test case 4\n        (0.05, 100, 8.0e-5, 1.0e-4, 150, 310, 330),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, Nc, alpha, dt, k, T_L, T_R = case\n        \n        # Calculate grid spacing h\n        h = L / Nc\n        \n        # --- Stability Check ---\n        # The stability condition for the explicit forward-Euler central-difference\n        # scheme for the 1D heat equation is alpha * dt / h^2 = 0.5.\n        # This is also known as the Fourier number, Fo.\n        fourier_number = alpha * dt / (h**2)\n        is_stable = fourier_number = 0.5\n        \n        # --- Steady-State Heat Flux Calculation ---\n        # In steady state with no internal generation, the temperature profile is linear.\n        # T(x) = (T_R - T_L)/L * x + T_L\n        # The heat flux q is constant and given by Fourier's law:\n        # q = -k * dT/dx\n        # dT/dx = (T_R - T_L) / L\n        # q = -k * (T_R - T_L) / L = k * (T_L - T_R) / L\n        # The flux is constant for all x in [0, L].\n        if L  0:\n            flux = k * (T_L - T_R) / L\n        else: # Avoid division by zero, though L > 0 in all test cases.\n            flux = float('nan') \n            \n        results.append([is_stable, flux])\n\n    # Format the final output string exactly as required,\n    # e.g., [[True,-123.456],[False,0.0]] a list of lists.\n    # The str() of a list adds spaces, so we remove them.\n    result_strings = [str(r).replace(\" \", \"\") for r in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\n# Execute the solution function.\nsolve()\n```"
        },
        {
            "introduction": "在 Dirichlet 条件之外，Neumann (第二类) 边界条件通过指定边界上的热通量，为模拟绝热表面或受控热源提供了可能。此练习的核心是从能量守恒第一性原理出发，推导并实施一个隐式时间积分方案来处理Neumann边界。你将通过验证整个系统的能量守恒性来检验代码的正确性，这不仅是数值方法课程的重点，也是高质量计算工程实践中的关键环节。",
            "id": "3938343",
            "problem": "考虑一根长度为 $L$（单位：$\\mathrm{m}$）、横截面积恒为 $A$（单位：$\\mathrm{m^2}$）的均质杆中的一维瞬态热传导。设 $x \\in [0,L]$ 表示沿杆的位置， $t \\ge 0$ 表示时间（单位：$\\mathrm{s}$）。温度场 $T(x,t)$（单位：$\\mathrm{K}$）的演化遵循能量守恒和傅里叶定律，两者共同给出了控制偏微分方程（PDE）：\n$$\\rho c_p \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right),$$\n其中 $\\rho$（单位：$\\mathrm{kg/m^3}$）是密度， $c_p$（单位：$\\mathrm{J/(kg\\cdot K)}$）是恒压比热容， $k$（单位：$\\mathrm{W/(m\\cdot K)}$）是热导率。假设 $k$、$\\rho$ 和 $c_p$ 在空间和时间上是常数，因此热扩散系数 $\\alpha = k/(\\rho c_p)$（单位：$\\mathrm{m^2/s}$）是常数，PDE简化为\n$$\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}。$$\n\n在边界 $x=0$ 处，有规定的热通量 $q_0(t)$（单位：$\\mathrm{W/m^2}$）进入杆中；在边界 $x=L$ 处，杆是绝热的，因此热通量 $q_L(t)$ 等于 $0$。因此，诺伊曼边界条件为\n$$-k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q_0(t), \\qquad -k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = q_L(t) = 0。$$\n初始条件在空间上是均匀的，\n$$T(x,0) = T_0,$$\n其中 $T_0$（单位：$\\mathrm{K}$）是一个给定的常数。一维中的对称边界条件对应于法向温度梯度为零，这与绝热诺伊曼边界的数学形式相同；因此，此处的 $x=L$ 边界也是温度场的对称面。\n\n任务。严格从能量守恒和傅里叶定律出发，不使用任何预先推导的离散化捷径，为空域推导一个有限差分法 (FDM) 并为时域推导一个一阶隐式格式，用于求解上述偏微分方程，并明确说明如何通过基于通量的关系施加在 $x=0$ 和 $x=L$ 处的诺伊曼边界条件。将得到的格式实现在一个单一程序中，对于下面的每个测试案例，该程序将温度推进到指定的最终时间，并通过比较杆的内能变化与通过边界的净能量输入来评估能量守恒。\n\n在您的实现和评估中使用的定义：\n- 杆在时间 $t$ 的离散内能为\n$$U(t) = \\rho c_p A \\int_0^L T(x,t)\\,dx,$$\n需在间距为 $\\Delta x$（单位：$\\mathrm{m}$）的均匀 $x$ 网格上使用复合梯形法则进行数值近似。\n- 在 $[0,t]$ 时间段内通过边界的净能量输入为\n$$E_{\\text{in}}(t) = A \\int_0^t \\big(q_0(\\tau) - q_L(\\tau)\\big)\\,d\\tau,$$\n需使用与您的隐式格式相同的时间步长 $\\Delta t$（单位：$\\mathrm{s}$）进行数值近似。\n- 每个测试案例需要报告的能量守恒残差为\n$$R(t_{\\text{final}}) = U(t_{\\text{final}}) - U(0) - E_{\\text{in}}(t_{\\text{final}}),$$\n其必须以 $\\mathrm{J}$ 为单位表示。\n\n您的程序必须实现从第一性原理推导的、带有基于通量的诺伊曼边界处理的隐式时间积分器，并为下面的每个测试案例计算标量残差 $R(t_{\\text{final}})$（单位：$\\mathrm{J}$）。\n\n网格和离散化要求：\n- 使用包含 $N$ 个节点（包括 $x=0$ 和 $x=L$）的均匀空间网格，间距为 $\\Delta x = L/(N-1)$（单位：$\\mathrm{m}$）。\n- 使用恒定的时间步长 $\\Delta t$（单位：$\\mathrm{s}$），共 $n_{\\text{steps}}$ 步，使得 $n_{\\text{steps}}\\Delta t = t_{\\text{final}}$。\n- 通过基于通量的导数关系施加诺伊曼边界条件，而不是任意规定虚拟温度。\n\n测试套件。实现以下四个测试案例，每个案例在物理上都是自洽的，旨在检验边界实现和能量计算：\n1. 具有恒定通量的常规路径：\n   - $L = 0.05$ $\\mathrm{m}$， $A = 5.0\\times 10^{-4}$ $\\mathrm{m^2}$， $N = 101$， $\\Delta t = 0.01$ $\\mathrm{s}$， $t_{\\text{final}} = 0.5$ $\\mathrm{s}$。\n   - 材料：$k = 200$ $\\mathrm{W/(m\\cdot K)}$， $\\rho = 8900$ $\\mathrm{kg/m^3}$， $c_p = 385$ $\\mathrm{J/(kg\\cdot K)}$。\n   - 初始温度：$T_0 = 300$ $\\mathrm{K}$。\n   - 边界通量：$q_0(t) = 2.0\\times 10^{4}$ $\\mathrm{W/m^2}$， $q_L(t) = 0$ $\\mathrm{W/m^2}$。\n2. 在一个周期内净能量输入为零的振荡通量：\n   - $L = 0.05$ $\\mathrm{m}$， $A = 5.0\\times 10^{-4}$ $\\mathrm{m^2}$， $N = 101$， $\\Delta t = 0.002$ $\\mathrm{s}$， $t_{\\text{final}} = 0.2$ $\\mathrm{s}$。\n   - 材料：$k = 200$ $\\mathrm{W/(m\\cdot K)}$， $\\rho = 8900$ $\\mathrm{kg/m^3}$， $c_p = 385$ $\\mathrm{J/(kg\\cdot K)}$。\n   - 初始温度：$T_0 = 300$ $\\mathrm{K}$。\n   - 边界通量：$q_0(t) = 1.0\\times 10^{5}\\sin\\left(2\\pi t / 0.2\\right)$ $\\mathrm{W/m^2}$， $q_L(t) = 0$ $\\mathrm{W/m^2}$。\n3. 零通量的边界情况：\n   - $L = 0.05$ $\\mathrm{m}$， $A = 5.0\\times 10^{-4}$ $\\mathrm{m^2}$， $N = 101$， $\\Delta t = 0.01$ $\\mathrm{s}$， $t_{\\text{final}} = 0.5$ $\\mathrm{s}$。\n   - 材料：$k = 200$ $\\mathrm{W/(m\\cdot K)}$， $\\rho = 8900$ $\\mathrm{kg/m^3}$， $c_p = 385$ $\\mathrm{J/(kg\\cdot K)}$。\n   - 初始温度：$T_0 = 300$ $\\mathrm{K}$。\n   - 边界通量：$q_0(t) = 0$ $\\mathrm{W/m^2}$， $q_L(t) = 0$ $\\mathrm{W/m^2}$。\n4. 粗网格和大时间步长下的强通量：\n   - $L = 0.02$ $\\mathrm{m}$， $A = 1.0\\times 10^{-4}$ $\\mathrm{m^2}$， $N = 11$， $\\Delta t = 0.1$ $\\mathrm{s}$， $t_{\\text{final}} = 0.1$ $\\mathrm{s}$。\n   - 材料：$k = 200$ $\\mathrm{W/(m\\cdot K)}$， $\\rho = 8900$ $\\mathrm{kg/m^3}$， $c_p = 385$ $\\mathrm{J/(kg\\cdot K)}$。\n   - 初始温度：$T_0 = 300$ $\\mathrm{K}$。\n   - 边界通量：$q_0(t) = 1.0\\times 10^{6}$ $\\mathrm{W/m^2}$， $q_L(t) = 0$ $\\mathrm{W/m^2}$。\n\n输出规格。您的程序应生成一行输出，其中包含能量守恒残差，形式为用方括号括起来的逗号分隔列表，顺序与测试案例相同，每个值都以 $\\mathrm{J}$ 为单位的十进制浮点数表示。例如，输出必须是以下形式：\n$$[\\text{residual}_1,\\text{residual}_2,\\text{residual}_3,\\text{residual}_4],$$\n其中每个 $\\text{residual}_i$ 是测试案例 $i$ 的 $R(t_{\\text{final}})$，单位为 $\\mathrm{J}$。",
            "solution": "该问题要求推导并实现一个数值格式来求解一维瞬态热方程，重点是从第一性原理推导有限差分方程并正确实现诺伊曼边界条件。实现方案的有效性将通过评估能量守恒来检验。\n\n均质杆中温度场 $T(x,t)$ 的控制偏微分方程 (PDE) 为：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n其中 $\\alpha = k/(\\rho c_p)$ 是恒定的热扩散系数。此方程定义在空间域 $x \\in [0, L]$ 和时间 $t \\ge 0$ 上。初始条件是均匀温度 $T(x,0) = T_0$。边界条件是指定热通量的诺伊曼类型：\n$$ -k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q_0(t) \\quad \\text{和} \\quad -k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = q_L(t) = 0 $$\n\n推导将基于有限体积法 (FVM)，该方法从能量守恒的积分形式出发。这种方法能确保最终的数值格式是内在守恒的，这也是本问题的核心主题。\n\n首先，我们将空间域 $[0,L]$ 离散化为 $N$ 个节点，索引为 $i = 0, 1, \\dots, N-1$。节点位于 $x_i = i \\Delta x$ 的位置，其中均匀网格间距为 $\\Delta x = L/(N-1)$。我们围绕每个节点定义控制体积 (CV)。对于内部节点 ($1 \\le i \\le N-2$)，控制体积从 $x_i - \\Delta x/2$ 延伸到 $x_i + \\Delta x/2$，长度为 $\\Delta x$。对于边界节点，控制体积的长度为 $\\Delta x/2$：CV$_0$ 是 $[0, \\Delta x/2]$，CV$_{N-1}$ 是 $[L-\\Delta x/2, L]$。\n\n对于任何控制体积 $V$ 及其边界 $\\partial V$，能量守恒的积分形式表明，内能的变化率等于流入该体积的净热流率：\n$$ \\frac{d}{dt} \\int_V \\rho c_p T \\,dV = -\\int_{\\partial V} \\mathbf{q} \\cdot \\mathbf{n} \\,dS $$\n在一维情况下，对于恒定的横截面积 $A$，这简化为：\n$$ \\frac{d}{dt} \\int_{x_a}^{x_b} \\rho c_p A T(x,t) \\,dx = A [q(x_a,t) - q(x_b,t)] $$\n其中，根据傅里叶定律，热通量 $q = -k \\frac{\\partial T}{\\partial x}$。\n\n**1. 内部节点 ($1 \\le i \\le N-2$) 的离散化**\n控制体积为 CV$_i = [x_i - \\Delta x/2, x_i + \\Delta x/2]$。应用能量平衡：\n$$ \\rho c_p A \\frac{d}{dt} \\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} T(x,t) \\,dx = A [q(x_i-\\Delta x/2, t) - q(x_i+\\Delta x/2, t)] $$\n我们假设节点温度 $T_i(t)$ 代表了控制体积内的平均温度来近似积分，并使用相邻节点间的中心差分来离散化通量：\n$$ \\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} T(x,t) \\,dx \\approx T_i(t) \\Delta x $$\n$$ q(x_i-\\Delta x/2, t) \\approx -k \\frac{T_i(t) - T_{i-1}(t)}{\\Delta x} $$\n$$ q(x_i+\\Delta x/2, t) \\approx -k \\frac{T_{i+1}(t) - T_i(t)}{\\Delta x} $$\n将这些近似代入能量平衡并简化：\n$$ \\rho c_p A \\Delta x \\frac{dT_i}{dt} = A \\left[ -k \\frac{T_i - T_{i-1}}{\\Delta x} - \\left(-k \\frac{T_{i+1} - T_i}{\\Delta x}\\right) \\right] $$\n$$ \\frac{dT_i}{dt} = \\frac{k}{\\rho c_p} \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2} = \\alpha \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2} $$\n这是内部节点的半离散方程。\n\n**2. 边界节点 $x=0$ ($i=0$) 的离散化**\n控制体积为 CV$_0 = [0, \\Delta x/2]$，长度为 $\\Delta x/2$。左侧面的热通量是给定的边界通量，$q(0,t) = q_0(t)$。\n$$ \\rho c_p A \\frac{d}{dt} \\int_{0}^{\\Delta x/2} T(x,t) \\,dx = A [q(0, t) - q(\\Delta x/2, t)] $$\n使用类似的近似：\n$$ \\int_{0}^{\\Delta x/2} T(x,t) \\,dx \\approx T_0(t) \\frac{\\Delta x}{2} $$\n$$ q(\\Delta x/2, t) \\approx -k \\frac{T_1(t) - T_0(t)}{\\Delta x} $$\n能量平衡变为：\n$$ \\rho c_p A \\frac{\\Delta x}{2} \\frac{dT_0}{dt} = A \\left[ q_0(t) - \\left(-k \\frac{T_1 - T_0}{\\Delta x}\\right) \\right] $$\n$$ \\frac{dT_0}{dt} = \\frac{2}{\\rho c_p \\Delta x} q_0(t) + \\frac{2k}{\\rho c_p (\\Delta x)^2} (T_1 - T_0) = \\frac{2\\alpha}{k \\Delta x} q_0(t) + \\frac{2\\alpha}{(\\Delta x)^2} (T_1 - T_0) $$\n\n**3. 边界节点 $x=L$ ($i=N-1$) 的离散化**\n控制体积为 CV$_{N-1} = [L - \\Delta x/2, L]$，长度为 $\\Delta x/2$。边界是绝热的，所以 $q(L,t) = q_L(t) = 0$。\n$$ \\rho c_p A \\frac{d}{dt} \\int_{L-\\Delta x/2}^{L} T(x,t) \\,dx = A [q(L-\\Delta x/2, t) - q(L, t)] $$\n近似为：\n$$ \\int_{L-\\Delta x/2}^{L} T(x,t) \\,dx \\approx T_{N-1}(t) \\frac{\\Delta x}{2} $$\n$$ q(L-\\Delta x/2, t) \\approx -k \\frac{T_{N-1}(t) - T_{N-2}(t)}{\\Delta x} $$\n能量平衡变为：\n$$ \\rho c_p A \\frac{\\Delta x}{2} \\frac{dT_{N-1}}{dt} = A \\left[ -k \\frac{T_{N-1} - T_{N-2}}{\\Delta x} - 0 \\right] $$\n$$ \\frac{dT_{N-1}}{dt} = \\frac{2k}{\\rho c_p (\\Delta x)^2} (T_{N-2} - T_{N-1}) = \\frac{2\\alpha}{(\\Delta x)^2} (T_{N-2} - T_{N-1}) $$\n\n**4. 隐式时间积分（后向欧拉法）**\n我们使用恒定步长 $\\Delta t$ 在时间上进行离散化。设 $T_i^n$ 为节点 $i$ 在时间 $t_n = n \\Delta t$ 的温度。一阶隐式（后向欧拉）格式将时间导数近似为 $\\frac{dT_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$，并在新的时间层级 $n+1$ 上计算所有空间项。设 $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 为无量纲网格傅里叶数。\n\n对于内部节点 ($1 \\le i \\le N-2$)：\n$$ \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i+1}^{n+1} - 2T_i^{n+1} + T_{i-1}^{n+1}}{(\\Delta x)^2} $$\n$$ -\\lambda T_{i-1}^{n+1} + (1+2\\lambda)T_i^{n+1} - \\lambda T_{i+1}^{n+1} = T_i^n $$\n\n对于边界节点 $i=0$：\n$$ \\frac{T_0^{n+1} - T_0^n}{\\Delta t} = \\frac{2\\alpha}{k \\Delta x} q_0(t^{n+1}) + \\frac{2\\alpha}{(\\Delta x)^2} (T_1^{n+1} - T_0^{n+1}) $$\n$$ (1+2\\lambda)T_0^{n+1} - 2\\lambda T_1^{n+1} = T_0^n + \\frac{2\\alpha \\Delta t}{k \\Delta x} q_0^{n+1} = T_0^n + \\frac{2\\lambda \\Delta x}{k} q_0^{n+1} $$\n\n对于边界节点 $i=N-1$：\n$$ \\frac{T_{N-1}^{n+1} - T_{N-1}^n}{\\Delta t} = \\frac{2\\alpha}{(\\Delta x)^2} (T_{N-2}^{n+1} - T_{N-1}^{n+1}) $$\n$$ -2\\lambda T_{N-2}^{n+1} + (1+2\\lambda)T_{N-1}^{n+1} = T_{N-1}^n $$\n\n**5. 线性系统公式化**\n这些方程构成了关于 $N$ 个未知温度 $\\mathbf{T}^{n+1} = [T_0^{n+1}, \\dots, T_{N-1}^{n+1}]^T$ 的 $N$ 个线性方程组。该系统可以写成矩阵形式 $\\mathbf{A} \\mathbf{T}^{n+1} = \\mathbf{b}^n$。\n\n矩阵 $\\mathbf{A}$ 是一个 $N \\times N$ 的三对角矩阵，不随时间变化：\n$$ \\mathbf{A} = \\begin{pmatrix}\n1+2\\lambda   -2\\lambda                     \\\\\n-\\lambda   1+2\\lambda  -\\lambda                  \\\\\n           \\ddots      \\ddots   \\ddots          \\\\\n                       -\\lambda  1+2\\lambda  -\\lambda \\\\\n                                 -2\\lambda   1+2\\lambda\n\\end{pmatrix} $$\n\n右端向量 $\\mathbf{b}^n$ 是：\n$$ \\mathbf{b}^n = \\begin{pmatrix}\nT_0^n + \\frac{2\\lambda \\Delta x}{k} q_0(t^{n+1}) \\\\\nT_1^n \\\\\n\\vdots \\\\\nT_{N-2}^n \\\\\nT_{N-1}^n\n\\end{pmatrix} $$\n\n**6. 算法与能量守恒**\n算法流程如下：\n1. 初始化温度场：对于所有 $i=0, \\dots, N-1$，设 $T_i^0 = T_0$。\n2. 使用复合梯形法则计算初始内能 $U(0)$：\n   $U(0) = \\rho c_p A \\int_0^L T(x,0) dx \\approx \\rho c_p A \\Delta x \\left( \\frac{T_0^0}{2} + \\sum_{i=1}^{N-2} T_i^0 + \\frac{T_{N-1}^0}{2} \\right)$。\n3. 构建矩阵 $\\mathbf{A}$。\n4. 从 $n=0$ 到 $n_{\\text{steps}}-1$ 循环：\n   a. 使用 $\\mathbf{T}^n$ 和边界通量 $q_0(t^{n+1})$ 构建向量 $\\mathbf{b}^n$。\n   b. 求解线性系统 $\\mathbf{A} \\mathbf{T}^{n+1} = \\mathbf{b}^n$ 以找到下一时间步的温度。\n   c. 通过加上当前步长的贡献来更新总能量输入 $E_{\\text{in}}$：$A (q_0(t^{n+1}) - q_L(t^{n+1})) \\Delta t$。我们对时间积分使用右侧和，与后向欧拉格式一致。\n5. 在最后一个时间步之后，使用温度场 $\\mathbf{T}^{n_{\\text{steps}}}$ 和梯形法则计算最终内能 $U(t_{\\text{final}})$。\n6. 计算能量守恒残差：$R(t_{\\text{final}}) = U(t_{\\text{final}}) - U(0) - E_{\\text{in}}(t_{\\text{final}})$。\n\n由于有限体积公式直接对积分守恒律进行离散化，该数值格式是内在能量守恒的。这意味着计算出的残差 $R(t_{\\text{final}})$ 应接近于零，仅受浮点精度限制。这为推导和实现的正确性提供了有力的验证。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the 1D transient heat conduction problem.\n    \"\"\"\n\n    def run_simulation(params):\n        \"\"\"\n        Executes a single simulation case for the heat conduction problem.\n\n        This function sets up and solves the 1D transient heat equation using a\n        finite volume method in space and an implicit first-order (Backward Euler)\n        scheme in time. It implements Neumann boundary conditions via a flux-based\n        formulation derived from first principles. The primary output is the\n        energy conservation residual, which verifies the implementation's correctness.\n\n        Args:\n            params (dict): A dictionary containing all physical and numerical\n                           parameters for the simulation case.\n\n        Returns:\n            float: The energy conservation residual R(t_final) in Joules.\n        \"\"\"\n        # Extract physical and numerical parameters from the dictionary\n        L = params['L']\n        A = params['A']\n        N = params['N']\n        dt = params['dt']\n        t_final = params['t_final']\n        k = params['k']\n        rho = params['rho']\n        cp = params['cp']\n        T0 = params['T0']\n        q0_func = params['q0_func']\n\n        # Calculate derived discretization parameters\n        dx = L / (N - 1)\n        n_steps = int(round(t_final / dt))\n        alpha = k / (rho * cp)\n        lam = alpha * dt / (dx**2)\n\n        # Initialize temperature field\n        T = np.full(N, T0, dtype=float)\n        x_nodes = np.linspace(0, L, N)\n\n        # 1. Calculate initial internal energy U(0) using the composite trapezoidal rule.\n        # np.trapz implements this rule: integral(y*dx) ~ dx * (y_0/2 + y_1 + ... + y_{N-1}/2)\n        U0 = rho * cp * A * np.trapz(T, x=x_nodes)\n        \n        # Initialize total net energy input\n        E_in_total = 0.0\n\n        # 2. Assemble the time-independent linear system matrix A\n        A_matrix = np.zeros((N, N))\n\n        # Equation for node i=0 (left boundary)\n        A_matrix[0, 0] = 1.0 + 2.0 * lam\n        A_matrix[0, 1] = -2.0 * lam\n\n        # Equations for interior nodes i=1 to N-2\n        for i in range(1, N - 1):\n            A_matrix[i, i - 1] = -lam\n            A_matrix[i, i]     = 1.0 + 2.0 * lam\n            A_matrix[i, i + 1] = -lam\n\n        # Equation for node i=N-1 (right boundary)\n        A_matrix[N - 1, N - 2] = -2.0 * lam\n        A_matrix[N - 1, N - 1] = 1.0 + 2.0 * lam\n\n        # 3. Time-stepping loop\n        for n in range(n_steps):\n            t_new = (n + 1) * dt\n\n            # Assemble the right-hand side vector b\n            b = T.copy()  # Start with temperatures from the previous step\n            q0_new = q0_func(t_new)\n            \n            # Update the first element of b with the boundary flux term. q_L is always 0.\n            flux_term = (2.0 * lam * dx / k) * q0_new\n            b[0] += flux_term\n\n            # Solve the linear system A * T_new = b\n            T = np.linalg.solve(A_matrix, b)\n\n            # Update total energy input using a right-hand sum, consistent with Backward Euler\n            E_in_total += A * q0_new * dt\n\n        # 4. Calculate final internal energy U(t_final)\n        Uf = rho * cp * A * np.trapz(T, x=x_nodes)\n\n        # 5. Calculate the energy conservation residual\n        residual = Uf - U0 - E_in_total\n        return residual\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'L': 0.05, 'A': 5.0e-4, 'N': 101, 'dt': 0.01, 't_final': 0.5,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 2.0e4\n        },\n        {\n            'L': 0.05, 'A': 5.0e-4, 'N': 101, 'dt': 0.002, 't_final': 0.2,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 1.0e5 * np.sin(2.0 * np.pi * t / 0.2)\n        },\n        {\n            'L': 0.05, 'A': 5.0e-4, 'N': 101, 'dt': 0.01, 't_final': 0.5,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 0.0\n        },\n        {\n            'L': 0.02, 'A': 1.0e-4, 'N': 11, 'dt': 0.1, 't_final': 0.1,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 1.0e6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Robin (第三类) 边界条件通过耦合边界温度与其法向导数，能够模拟更贴近实际的对流换热等物理过程。本练习将挑战升级，引入了包含热辐射的 Robin 边界，这将在边界方程中产生一个 $T^4$ 非线性项。你需要构建并求解一个非线性代数方程组，这是解决真实世界中复杂热传递问题时经常遇到的挑战，它同时也探索了多种边界条件的组合应用。",
            "id": "3938330",
            "problem": "一个厚度为 $L$、导热系数 $k$ 恒定的一维平板，在均匀体积热生成 $\\dot{q}'''$（单位：$\\mathrm{W/m^3}$）的条件下进行稳态热传导。其控制平衡方程为能量守恒和傅里叶热传导定律。从能量守恒和热通量的定义出发，推导一个离散系统，该系统在稳态下满足以下条件：\n- 在内部区域，温度的二阶导数加上源项除以导热系数等于零。\n- 在左边界，一个 Robin 边界条件模拟了与周围环境同时发生的对流和热辐射。\n- 在右边界，实现 Dirichlet、Neumann、对称或周期性边界类型中的任意一种。\n\n基本原理如下：\n- 控制体积内的能量守恒：在稳态下，传导热通量的散度加上体积热生成为零。\n- 傅里叶定律：$q_x = -k \\,\\frac{dT}{dx}$。\n- 表面的对流传热：$q_{\\text{conv}} = h \\,\\left(T_s - T_\\infty\\right)$，其中 $h$ 是对流传热系数，$T_s$ 是表面温度，$T_\\infty$ 是环境流体温度。\n- 向大型等温环境的热辐射：$q_{\\text{rad}} = \\varepsilon \\sigma \\left(T_s^4 - T_{\\text{surr}}^4\\right)$，其中 $\\varepsilon$ 是表面发射率，$\\sigma$ 是 Stefan–Boltzmann 常数。\n\n设 $x \\in [0,L]$ 表示位置，$T(x)$ 表示温度场（单位：$\\mathrm{K}$）。在稳态下：\n- 内部平衡：$\\frac{d^2 T}{dx^2} + \\frac{\\dot{q}'''}{k} = 0$。\n- 左边界 $x=0$（模拟对流和辐射的 Robin 条件）：$-k \\,\\frac{dT}{dx}\\big|_{x=0} = h \\,\\left( T(0) - T_\\infty \\right) + \\varepsilon \\sigma \\left( T(0)^4 - T_{\\text{surr}}^4 \\right)$。\n- 右边界 $x=L$ 可以是以下之一：\n    1. Dirichlet：$T(L) = T_R$。\n    2. Neumann（指定热通量）：$-k \\,\\frac{dT}{dx}\\big|_{x=L} = q''_R$。\n    3. 对称：$-k \\,\\frac{dT}{dx}\\big|_{x=L} = 0$。\n    4. 周期性：$T(0) = T(L)$ 且 $\\frac{dT}{dx}\\big|_{x=0} = \\frac{dT}{dx}\\big|_{x=L}$。\n\n将区域均匀离散为包括边界在内的 $N$ 个节点，间距为 $\\Delta x = \\frac{L}{N-1}$。对内部的二阶导数使用中心差分，对边界导数使用单边差分进行近似。对于周期性情况，使用环绕邻居节点，并且为了在 $\\dot{q}'''=0$ 时解决常数零空间问题，用平均温度约束 $\\frac{1}{N}\\sum_{i=0}^{N-1} T_i = T_{\\text{mean}}$ 替代一个残差方程。辐射项必须以其精确的非线性形式处理，不能线性化。\n\n您的程序必须构建由这些平衡方程产生的非线性代数系统，并求解节点温度。然后，对于下面的每个测试用例，报告：\n- 左壁温度 $T(0)$，单位为 $\\mathrm{K}$。\n- 左边界的净热通量 $q''_{\\text{left}}$，单位为 $\\mathrm{W/m^2}$，由传导近似 $q''_{\\text{left}} = -k \\,\\frac{T_1 - T_0}{\\Delta x}$ 定义，在收敛时，该值与对流和辐射热通量之和相匹配。\n\n物理单位必须保持一致：\n- $L$ 单位为 $\\mathrm{m}$，$k$ 单位为 $\\mathrm{W/(m\\cdot K)}$，$\\dot{q}'''$ 单位为 $\\mathrm{W/m^3}$，$h$ 单位为 $\\mathrm{W/(m^2\\cdot K)}$，$\\varepsilon$ 无量纲，$\\sigma$ 单位为 $\\mathrm{W/(m^2\\cdot K^4)}$，温度单位为 $\\mathrm{K}$，热通量单位为 $\\mathrm{W/m^2}$。\n\n测试套件：\n使用 Stefan–Boltzmann 常数 $\\sigma = 5.670374419 \\times 10^{-8} \\mathrm{W/(m^2\\cdot K^4)}$。对于每个案例，使用指定的 $N$ 进行离散化。\n\n- 案例 1（常规路径，混合 Robin–Dirichlet）：\n    - $L = 0.02\\ \\mathrm{m}$，$k = 16\\ \\mathrm{W/(m\\cdot K)}$，$N = 41$，$\\dot{q}''' = 5.0\\times 10^5\\ \\mathrm{W/m^3}$，\n    - $h = 35\\ \\mathrm{W/(m^2\\cdot K)}$，$\\varepsilon = 0.8$，$T_\\infty = 300\\ \\mathrm{K}$，$T_{\\text{surr}} = 300\\ \\mathrm{K}$，\n    - 右边界：Dirichlet，其中 $T_R = 310\\ \\mathrm{K}$。\n\n- 案例 2（辐射主导的 Robin–对称）：\n    - $L = 0.01\\ \\mathrm{m}$，$k = 200\\ \\mathrm{W/(m\\cdot K)}$，$N = 31$，$\\dot{q}''' = 0\\ \\mathrm{W/m^3}$，\n    - $h = 5\\ \\mathrm{W/(m^2\\cdot K)}$，$\\varepsilon = 0.95$，$T_\\infty = 300\\ \\mathrm{K}$，$T_{\\text{surr}} = 1000\\ \\mathrm{K}$，\n    - 右边界：对称（Neumann，其中 $q''_R = 0$）。\n\n- 案例 3（对流主导的 Robin–Dirichlet，低导热系数）：\n    - $L = 0.05\\ \\mathrm{m}$，$k = 0.2\\ \\mathrm{W/(m\\cdot K)}$，$N = 51$，$\\dot{q}''' = 2.0\\times 10^5\\ \\mathrm{W/m^3}$，\n    - $h = 100\\ \\mathrm{W/(m^2\\cdot K)}$，$\\varepsilon = 0.0$，$T_\\infty = 280\\ \\mathrm{K}$，$T_{\\text{surr}} = 280\\ \\mathrm{K}$，\n    - 右边界：Dirichlet，其中 $T_R = 280\\ \\mathrm{K}$。\n\n- 案例 4（混合 Robin–Neumann，指定热通量）：\n    - $L = 0.02\\ \\mathrm{m}$，$k = 50\\ \\mathrm{W/(m\\cdot K)}$，$N = 41$，$\\dot{q}''' = 1.0\\times 10^4\\ \\mathrm{W/m^3}$，\n    - $h = 10\\ \\mathrm{W/(m^2\\cdot K)}$，$\\varepsilon = 0.9$，$T_\\infty = 295\\ \\mathrm{K}$，$T_{\\text{surr}} = 600\\ \\mathrm{K}$，\n    - 右边界：Neumann，指定 $q''_R = 200\\ \\mathrm{W/m^2}$。\n\n- 案例 5（周期性边界，无热生成，平均温度约束）：\n    - $L = 0.10\\ \\mathrm{m}$，$k = 100\\ \\mathrm{W/(m\\cdot K)}$，$N = 51$，$\\dot{q}''' = 0\\ \\mathrm{W/m^3}$，\n    - 两端均为周期性边界，并施加平均温度 $T_{\\text{mean}} = 300\\ \\mathrm{K}$。\n    - 对于此案例，不应用 Robin 条件；强制执行周期性和平均温度约束。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。按给定顺序汇总所有测试用例的结果，将每个案例的配对结果展开到最终列表中，格式为 $[T_0^{(1)}, q''_{\\text{left}}^{(1)}, T_0^{(2)}, q''_{\\text{left}}^{(2)}, \\dots, T_0^{(5)}, q''_{\\text{left}}^{(5)}]$，其中 $T_0^{(i)}$ 的单位是 $\\mathrm{K}$，$q''_{\\text{left}}^{(i)}$ 的单位是 $\\mathrm{W/m^2}$。",
            "solution": "该问题要求推导并数值求解一个离散方程组，该方程组代表了厚度为 $L$ 的平板中的一维稳态热传导。分析从能量守恒和傅里叶定律的基本原理开始，导出热方程，然后使用有限差分法对其进行离散化。\n\n在区域内部 $x \\in (0, L)$，温度场 $T(x)$ 的控制偏微分方程如下：\n$$\n\\frac{d^2 T}{dx^2} + \\frac{\\dot{q}'''}{k} = 0\n$$\n其中 $k$ 是导热系数，$\\dot{q}'''$ 是体积热生成率。该方程必须在 $x=0$ 和 $x=L$ 处的指定边界条件下求解。\n\n为了获得数值解，连续区域被离散化为一组 $N$ 个离散节点。每个节点 $i$ 的位置由 $x_i = i \\cdot \\Delta x$ 给出，其中 $i = 0, 1, \\dots, N-1$，均匀网格间距为 $\\Delta x = L/(N-1)$。每个节点的温度表示为 $T_i \\equiv T(x_i)$。目标是找到节点温度向量 $\\mathbf{T} = [T_0, T_1, \\dots, T_{N-1}]^T$。\n\n通过近似导数，将控制微分方程转换为代数方程组。\n\n**内部节点 ($i=1, \\dots, N-2$)**\n对于非边界节点，二阶导数使用二阶中心差分格式进行近似：\n$$\n\\frac{d^2 T}{dx^2}\\bigg|_{x_i} \\approx \\frac{T(x_{i+1}) - 2T(x_i) + T(x_{i-1})}{(\\Delta x)^2} = \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2}\n$$\n将此近似代入控制方程，得到每个内部节点 $i$ 的残差方程：\n$$\nR_i(\\mathbf{T}) = \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2} + \\frac{\\dot{q}'''}{k} = 0\n$$\n\n**边界节点**\n边界节点 $i=0$ 和 $i=N-1$ 的方程由指定的边界条件导出。\n\n**左边界 ($i=0$)：Robin 条件**\n在 $x=0$ 处的边界受到一个涉及对流和辐射的混合条件约束：\n$$\n-k \\,\\frac{dT}{dx}\\bigg|_{x=0} = h \\,\\left( T(0) - T_\\infty \\right) + \\varepsilon \\sigma \\left( T(0)^4 - T_{\\text{surr}}^4 \\right)\n$$\n边界处的导数使用一阶向前差分进行近似：\n$$\n\\frac{dT}{dx}\\bigg|_{x=0} \\approx \\frac{T_1 - T_0}{\\Delta x}\n$$\n将此近似代入边界条件，得到节点 $i=0$ 的残差方程：\n$$\nR_0(\\mathbf{T}) = -k \\frac{T_1 - T_0}{\\Delta x} - h(T_0 - T_\\infty) - \\varepsilon \\sigma (T_0^4 - T_{\\text{surr}}^4) = 0\n$$\n由于来自热辐射的 $T_0^4$ 项，该方程是非线性的。\n\n**右边界 ($i=N-1$)**\n$x=L$ 处节点的公式取决于指定的边界条件类型。\n\n1.  **Dirichlet 条件：** 温度是固定的，$T(L) = T_R$。离散方程是直接的：\n    $$\n    R_{N-1}(\\mathbf{T}) = T_{N-1} - T_R = 0\n    $$\n\n2.  **Neumann 条件：** 指定了热通量，$-k \\,\\frac{dT}{dx}\\big|_{x=L} = q''_R$。导数使用一阶向后差分进行近似：\n    $$\n    \\frac{dT}{dx}\\bigg|_{x=L} \\approx \\frac{T_{N-1} - T_{N-2}}{\\Delta x}\n    $$\n    这导出了残差方程：\n    $$\n    R_{N-1}(\\mathbf{T}) = -k \\frac{T_{N-1} - T_{N-2}}{\\Delta x} - q''_R = 0\n    $$\n\n3.  **对称条件：** 这是指定通量为零，$q''_R = 0$ 的 Neumann 条件的特例。残差简化为：\n    $$\n    R_{N-1}(\\mathbf{T}) = -k \\frac{T_{N-1} - T_{N-2}}{\\Delta x} = 0 \\quad \\implies \\quad T_{N-1} - T_{N-2} = 0\n    $$\n\n**周期性边界条件**\n对于周期性情况，平板被视为其两端相连，形成一个环。这意味着 $T(0) = T(L)$ 且 $\\frac{dT}{dx}|_{x=0} = \\frac{dT}{dx}|_{x=L}$。离散化格式使用“环绕”邻居节点。对于任何节点 $i \\in \\{0, \\dots, N-1\\}$，其左邻居的索引是 $(i-1+N)\\%N$，右邻居的索引是 $(i+1)\\%N$。适用于内部节点的有限差分方程现在对所有节点都成立：\n$$\nR_i^{\\text{periodic}}(\\mathbf{T}) = \\frac{T_{(i+1)\\%N} - 2T_i + T_{(i-1+N)\\%N}}{(\\Delta x)^2} + \\frac{\\dot{q}'''}{k} = 0 \\quad \\text{for } i=0, \\dots, N-1\n$$\n在 $\\dot{q}'''=0$ 的特定情况下，这个线性方程组是奇异的。这对应于物理现实：如果 $T(x)$ 是一个解，那么对于任意常数 $C$，$T(x)+C$ 也是一个解。为了获得唯一解，必须施加一个额外的约束。按照题目要求，用一个平均温度约束替换其中一个残差方程（例如， $i=N-1$ 的方程）：\n$$\nR_{N-1}(\\mathbf{T}) = \\frac{1}{N}\\sum_{j=0}^{N-1} T_j - T_{\\text{mean}} = 0\n$$\n这使得整个系统是适定的。对于这种情况，不应用 $x=0$ 处的 Robin 条件。\n\n**系统求解**\n$N$ 个残差方程 $R_i(\\mathbf{T})=0$（对于 $i=0, \\dots, N-1$）构成一个代数方程组 $\\mathbf{R}(\\mathbf{T}) = \\mathbf{0}$。由于非线性的辐射项，该系统必须进行数值求解。牛顿类型的求根算法，例如 `scipy.optimize.root` 提供的算法，适用于此目的。该算法迭代地改进 $\\mathbf{T}$ 的初始猜测值，直到残差向量 $\\mathbf{R}$ 的范数低于指定的容差。\n\n收敛后，即可获得包含节点温度的解向量 $\\mathbf{T}$。由此，可以计算所需的输出量：左壁温度 $T_0$，以及左壁的传导热通量 $q''_{\\text{left}} = -k \\frac{T_1 - T_0}{\\Delta x}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Sets up and solves five 1D steady-state heat conduction problems\n    with various boundary conditions.\n    \"\"\"\n    SIGMA = 5.670374419e-8\n\n    test_cases = [\n        # Case 1: Robin-Dirichlet\n        {'L': 0.02, 'k': 16, 'N': 41, 'q_ppp': 5.0e5, 'h': 35, 'eps': 0.8,\n         'T_inf': 300, 'T_surr': 300, 'bc_type': 'Dirichlet', 'bc_val': 310},\n        # Case 2: Robin-Symmetry\n        {'L': 0.01, 'k': 200, 'N': 31, 'q_ppp': 0, 'h': 5, 'eps': 0.95,\n         'T_inf': 300, 'T_surr': 1000, 'bc_type': 'Symmetry', 'bc_val': 0},\n        # Case 3: Robin-Dirichlet (low-k)\n        {'L': 0.05, 'k': 0.2, 'N': 51, 'q_ppp': 2.0e5, 'h': 100, 'eps': 0.0,\n         'T_inf': 280, 'T_surr': 280, 'bc_type': 'Dirichlet', 'bc_val': 280},\n        # Case 4: Robin-Neumann\n        {'L': 0.02, 'k': 50, 'N': 41, 'q_ppp': 1.0e4, 'h': 10, 'eps': 0.9,\n         'T_inf': 295, 'T_surr': 600, 'bc_type': 'Neumann', 'bc_val': 200},\n        # Case 5: Periodic\n        {'L': 0.10, 'k': 100, 'N': 51, 'q_ppp': 0, 'h': 0, 'eps': 0,\n         'T_inf': 0, 'T_surr': 0, 'bc_type': 'Periodic', 'bc_val': 300},\n    ]\n\n    results = []\n    for params in test_cases:\n        T0, q_left = solve_case(params, SIGMA)\n        results.extend([T0, q_left])\n\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\n\ndef solve_case(params, sigma):\n    \"\"\"\n    Solves a single heat conduction problem for a given set of parameters.\n    \"\"\"\n    L = params['L']\n    k = params['k']\n    N = params['N']\n    q_ppp = params['q_ppp']\n    h = params['h']\n    eps = params['eps']\n    T_inf = params['T_inf']\n    T_surr = params['T_surr']\n    bc_type = params['bc_type']\n    bc_val = params['bc_val']\n    \n    dx = L / (N - 1)\n\n    def residuals(T):\n        \"\"\"\n        Calculates the residuals for the system of N algebraic equations.\n        \"\"\"\n        R = np.zeros(N)\n\n        if bc_type == 'Periodic':\n            # This logic is for the periodic case (Case 5)\n            # All nodes use a wrap-around stencil\n            for i in range(N):\n                T_left = T[(i - 1 + N) % N]\n                T_right = T[(i + 1) % N]\n                R[i] = (T_right - 2 * T[i] + T_left) / dx**2 + q_ppp / k\n            \n            # Replace the last residual with the mean temperature constraint\n            R[N - 1] = np.mean(T) - bc_val  # bc_val is T_mean\n        else:\n            # Interior nodes (for non-periodic cases)\n            for i in range(1, N - 1):\n                R[i] = (T[i+1] - 2 * T[i] + T[i-1]) / dx**2 + q_ppp / k\n\n            # Left boundary (Robin condition for Cases 1-4)\n            R[0] = -k * (T[1] - T[0]) / dx - h * (T[0] - T_inf) - eps * sigma * (T[0]**4 - T_surr**4)\n\n            # Right boundary\n            if bc_type == 'Dirichlet':\n                R[N - 1] = T[N - 1] - bc_val  # bc_val is T_R\n            elif bc_type == 'Symmetry':\n                # from -k * (T[N-1] - T[N-2]) / dx = 0\n                R[N - 1] = T[N - 1] - T[N - 2]\n            elif bc_type == 'Neumann':\n                # from -k * (T[N-1] - T[N-2]) / dx = q_R\n                R[N - 1] = -k * (T[N - 1] - T[N - 2]) / dx - bc_val # bc_val is q''_R\n        \n        return R\n\n    # Create an initial guess for the temperature profile\n    if bc_type == 'Periodic':\n        initial_guess = np.full(N, bc_val) # T_mean\n    elif bc_type == 'Dirichlet':\n        initial_guess = np.linspace(300, bc_val, N)\n    else:\n        initial_guess = np.full(N, 300.0)\n\n    # Solve the nonlinear system of equations\n    sol = root(residuals, initial_guess, method='hybr')\n    \n    if not sol.success:\n        # Fallback to a different solver or guess if needed, though 'hybr' is robust.\n        sol = root(residuals, initial_guess, method='lm')\n        if not sol.success:\n             raise RuntimeError(f\"Solver failed for case: {params}\")\n\n    T_solution = sol.x\n    \n    # Calculate required outputs\n    T0 = T_solution[0]\n    q_left = -k * (T_solution[1] - T_solution[0]) / dx\n    \n    return T0, q_left\n\nsolve()\n```"
        }
    ]
}