{
    "hands_on_practices": [
        {
            "introduction": "To build robust computational models, we must begin with the fundamental physical principles. This exercise returns to first principles, guiding you through the derivation of the integral form of the mass conservation law for a general, deforming control volume. By applying the Reynolds Transport Theorem, you will bridge the conceptual gap between a simple, fixed-mass material system and the more complex, open system represented by a control volume, a crucial skill for analyzing any thermal-fluid system .",
            "id": "3944078",
            "problem": "A compressible fluid with density field $\\rho(\\mathbf{x},t)$ occupies a deforming control volume $V(t)$ bounded by a smooth control surface $S(t)$ with outward unit normal $\\mathbf{n}(\\mathbf{x},t)$. The control surface has two instrumented ports: an inlet with area $A_{\\mathrm{in}}(t)$ and an outlet with area $A_{\\mathrm{out}}(t)$. The remainder of the control surface is impermeable to mass. The fluid velocity is $\\mathbf{u}(\\mathbf{x},t)$ and the local boundary velocity is $\\mathbf{u}_{b}(\\mathbf{x},t)$. The inlet and outlet mass flow rates are measured relative to the moving boundary and are given by\n$$\n\\dot{m}_{\\mathrm{in}}(t) \\text{ and } \\dot{m}_{\\mathrm{out}}(t),\n$$\nrespectively, with the sign convention that $\\dot{m}_{\\mathrm{in}}(t) \\ge 0$ denotes mass flowing into $V(t)$ through $A_{\\mathrm{in}}(t)$ and $\\dot{m}_{\\mathrm{out}}(t) \\ge 0$ denotes mass flowing out of $V(t)$ through $A_{\\mathrm{out}}(t)$. There are no volumetric sources or sinks of mass within $V(t)$.\n\nStarting from first principles of mass conservation for a material system and using an appropriate transport theorem to relate a material system to the deforming control volume, write the integral mass balance for $V(t)$ and solve it to obtain an expression for the rate of change of total mass in the control volume,\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{V(t)} \\rho(\\mathbf{x},t)\\,\\mathrm{d}V,\n$$\nin terms of $\\dot{m}_{\\mathrm{in}}(t)$ and $\\dot{m}_{\\mathrm{out}}(t)$ only. Express your final answer in kilograms per second (kg s$^{-1}$). No numerical evaluation is required; provide a closed-form symbolic expression.",
            "solution": "The problem requires the derivation of an expression for the rate of change of total mass within a deforming control volume, starting from the fundamental principle of mass conservation.\n\nThe first principle is the law of conservation of mass applied to a material system. A material system is defined as a fixed collection of matter, so its total mass, $M_{sys}$, is constant over time. The material system occupies a material volume $V_m(t)$ that moves and deforms with the fluid. The conservation of mass for this system is expressed as:\n$$\n\\frac{\\mathrm{d}M_{sys}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V_m(t)} \\rho(\\mathbf{x},t) \\, \\mathrm{d}V = 0\n$$\nwhere $\\rho(\\mathbf{x},t)$ is the fluid density field.\n\nThe next step is to relate the rate of change for the material system to quantities measured with respect to a control volume $V(t)$. The problem specifies a deforming control volume $V(t)$ bounded by a surface $S(t)$ which moves with a local velocity $\\mathbf{u}_b(\\mathbf{x},t)$. The appropriate tool for this transformation is the general Reynolds Transport Theorem (also known as the Leibniz-Reynolds theorem). For an arbitrary extensive property $B_{sys} = \\int_{V_m(t)} \\beta(\\mathbf{x},t) \\, \\mathrm{d}V$, where $\\beta$ is the corresponding intensive property per unit volume, the theorem states:\n$$\n\\frac{\\mathrm{d}B_{sys}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\beta \\, \\mathrm{d}V + \\int_{S(t)} \\beta (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\nHere, $\\mathbf{u}(\\mathbf{x},t)$ is the fluid velocity, and $\\mathbf{n}(\\mathbf{x},t)$ is the outward unit normal vector on the control surface $S(t)$. The term $(\\mathbf{u} - \\mathbf{u}_b)$ represents the fluid velocity relative to the moving boundary. This theorem is applied at the instant in time when the material volume $V_m(t)$ and the control volume $V(t)$ coincide.\n\nFor mass conservation, the extensive property is the mass itself, $M_{sys}$, so the corresponding intensive property per unit volume is the density, $\\rho$. Setting $\\beta = \\rho$ in the Reynolds Transport Theorem gives:\n$$\n\\frac{\\mathrm{d}M_{sys}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V + \\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\nApplying the principle of mass conservation, $\\frac{\\mathrm{d}M_{sys}}{\\mathrm{d}t} = 0$, to the above equation yields the integral mass balance for the deforming control volume:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V + \\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = 0\n$$\nThe problem asks for an expression for the rate of change of total mass in the control volume, which is the term $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V$. Let's denote this by $\\frac{\\mathrm{d}M_{CV}}{\\mathrm{d}t}$. Rearranging the equation gives:\n$$\n\\frac{\\mathrm{d}M_{CV}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V = - \\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\nThe right-hand side is the net rate of mass influx across the control surface $S(t)$. The control surface is composed of three disjoint parts: the inlet $A_{\\mathrm{in}}(t)$, the outlet $A_{\\mathrm{out}}(t)$, and the impermeable walls $S_{wall}(t)$. The surface integral can be split accordingly:\n$$\n\\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = \\int_{A_{\\mathrm{in}}(t)} \\! \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S + \\int_{A_{\\mathrm{out}}(t)} \\! \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S + \\int_{S_{wall}(t)} \\! \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\nWe analyze each integral:\n1.  On the impermeable walls $S_{wall}(t)$, no mass can pass through. This means the normal component of the fluid velocity relative to the boundary is zero: $(\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} = 0$. Therefore, the integral over the walls vanishes:\n    $$\n    \\int_{S_{wall}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = 0\n    $$\n2.  At the inlet $A_{\\mathrm{in}}(t)$, the problem states that the mass flow rate *into* the control volume is $\\dot{m}_{\\mathrm{in}}(t) \\ge 0$. The integral $\\int_{A_{\\mathrm{in}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S$ represents the mass flux across the inlet surface. For an inlet, the relative velocity vector $(\\mathbf{u} - \\mathbf{u}_b)$ points into the volume, which is opposite to the outward normal vector $\\mathbf{n}$. Thus, the dot product $(\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n}$ is negative. The integral represents the net mass *outflow* through the inlet, which must be negative. The given mass flow rate *in*, $\\dot{m}_{\\mathrm{in}}(t)$, is defined as a positive quantity. Therefore, it must be the negative of the surface integral:\n    $$\n    \\dot{m}_{\\mathrm{in}}(t) = - \\int_{A_{\\mathrm{in}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S \\implies \\int_{A_{\\mathrm{in}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = - \\dot{m}_{\\mathrm{in}}(t)\n    $$\n3.  At the outlet $A_{\\mathrm{out}}(t)$, the mass flow rate *out of* the control volume is $\\dot{m}_{\\mathrm{out}}(t) \\ge 0$. For an outlet, the fluid exits the volume, so the relative velocity $(\\mathbf{u} - \\mathbf{u}_b)$ is in the same direction as the outward normal $\\mathbf{n}$. The dot product $(\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n}$ is positive. The integral $\\int_{A_{\\mathrm{out}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S$ represents the mass outflow rate, which is precisely what $\\dot{m}_{\\mathrm{out}}(t)$ is defined as:\n    $$\n    \\int_{A_{\\mathrm{out}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = \\dot{m}_{\\mathrm{out}}(t)\n    $$\nSubstituting these results back into the expression for the total surface integral:\n$$\n\\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = (-\\dot{m}_{\\mathrm{in}}(t)) + (\\dot{m}_{\\mathrm{out}}(t)) + 0 = \\dot{m}_{\\mathrm{out}}(t) - \\dot{m}_{\\mathrm{in}}(t)\n$$\nThis term represents the net mass outflow rate from the control volume.\nFinally, we substitute this into the rearranged mass balance equation:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V = - \\left( \\dot{m}_{\\mathrm{out}}(t) - \\dot{m}_{\\mathrm{in}}(t) \\right)\n$$\nThis simplifies to the final expression for the rate of change of mass inside the control volume:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho(\\mathbf{x},t) \\, \\mathrm{d}V = \\dot{m}_{\\mathrm{in}}(t) - \\dot{m}_{\\mathrm{out}}(t)\n$$\nThe expression states that the rate of accumulation of mass in the control volume is equal to the rate of mass inflow minus the rate of mass outflow. The quantities $\\dot{m}_{\\mathrm{in}}(t)$ and $\\dot{m}_{\\mathrm{out}}(t)$ are mass flow rates, which have units of mass per time, such as kilograms per second ($kg s^{-1}$), consistent with the problem's requirement.",
            "answer": "$$\n\\boxed{\\dot{m}_{\\mathrm{in}}(t) - \\dot{m}_{\\mathrm{out}}(t)}\n$$"
        },
        {
            "introduction": "A numerical scheme for a conservation law is only reliable if it is, itself, conservative. This practice transitions from the continuous integral law to its discrete counterpart using the Finite Volume Method (FVM), a cornerstone of modern CFD. You will not only derive the semi-discrete equations but also prove that the FVM formulation inherently conserves mass globally, a property that ensures mass is not artificially created or destroyed by the numerical algorithm . This theoretical proof is then reinforced through a practical coding exercise.",
            "id": "3944083",
            "problem": "Consider the integral form of the conservation of mass (continuity equation) for a fluid with density $\\rho$ and velocity $\\mathbf{u}$ over a control volume $V$: $$\\frac{d}{dt}\\int_{V} \\rho \\, dV + \\oint_{\\partial V} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n} \\, dA = 0.$$ Using the Finite Volume Method (FVM), a general unstructured mesh partitions the domain into nonoverlapping cells indexed by $i$, each with volume $|V_i|$, and boundary $\\partial V_i$ composed of faces indexed by $f$. Define a single-valued mass flux per face $f$ by $$\\Phi_f = \\rho_f\\, (\\mathbf{u}_f\\cdot\\mathbf{n}_f)\\, A_f,$$ where $\\rho_f$ is a face density approximation, $\\mathbf{u}_f\\cdot\\mathbf{n}_f$ is the normal component of velocity at the face, and $A_f$ is the face area (length in two dimensions). For every interior face $f$ shared by adjacent cells $i$ and $j$, fix an orientation with a unit normal $\\mathbf{n}_f$ pointing from cell $i$ (the left cell) to cell $j$ (the right cell). For boundary faces $f$ of cell $i$, there is no adjacent right cell; impermeable boundary conditions enforce $(\\mathbf{u}_f\\cdot\\mathbf{n}_f) = 0$, and periodic boundary conditions identify pairs of boundary faces as interior connections between appropriate cell pairs so that $\\Phi_f$ is single-valued.\n\nTask A (Derivation): Starting strictly from the integral form and the definitions above, derive a semi-discrete FVM formulation for the continuity equation on a general unstructured mesh. Introduce the semi-discrete residual $R_i$ for each cell $i$ in terms of the oriented single-valued face fluxes $\\Phi_f$ and show that the semi-discrete ordinary differential equation has the form $$\\frac{d}{dt}\\left(\\rho_i\\, |V_i|\\right) + R_i = 0,$$ where $\\rho_i$ is the cell-averaged density defined by $\\rho_i = \\frac{1}{|V_i|}\\int_{V_i}\\rho\\, dV$, and $$R_i = \\sum_{f\\in \\partial V_i} s_{i,f}\\, \\Phi_f,$$ with $s_{i,f} = +1$ if face $f$ is oriented outward from cell $i$ (cell $i$ is the left cell of $f$) and $s_{i,f} = -1$ if face $f$ is oriented inward to cell $i$ (cell $i$ is the right cell of $f$).\n\nTask B (Global Conservation Proof): Prove that the sum of the semi-discrete residuals $R_i$ over all cells is exactly zero when all boundary faces are either impermeable or periodic. Your proof must rely only on the properties of the single-valued face fluxes and the orientation conventions, without assuming any specialized interpolation scheme for $\\rho_f$ beyond it being the same for both adjacent cells referencing the same face $f$.\n\nTask C (Program): Implement a program that computes the semi-discrete residuals for each cell and verifies the global conservation property numerically on the following test suite. In all tests, treat all quantities as nondimensional, meaning the outputs are unitless floats.\n\nDefinitions for the tests:\n- The program must use the single-valued face flux $\\Phi_f = \\rho_f\\, u_{n,f}\\, A_f$, where $u_{n,f}$ denotes the normal velocity component at face $f$. For interior faces shared by cells $i$ and $j$, use the arithmetic average $\\rho_f = \\frac{1}{2}(\\rho_i + \\rho_j)$. For boundary faces, use $\\rho_f = \\rho_i$ (this choice does not affect impermeable faces because $u_{n,f} = 0$) and for periodic boundaries treat them as interior faces between the mapped pair of cells with the same single-valued $\\Phi_f$.\n\nTest suite:\n- Test $1$ (General unstructured mesh, impermeable boundary): Cells indexed $i \\in \\{0,1,2,3,4\\}$ with cell densities $[\\rho_0,\\rho_1,\\rho_2,\\rho_3,\\rho_4] = [1.0, 0.8, 1.3, 0.9, 1.1]$. Faces are specified as tuples $(\\ell, r, A_f, u_{n,f})$, where $\\ell$ is the left cell index, $r$ is the right cell index ($r$ can be $\\text{None}$ for a boundary face), $A_f$ is the face area, and $u_{n,f}$ is the normal velocity. Interior faces: $(0,1,1.2,0.7)$, $(1,2,0.9,-1.1)$, $(2,3,1.5,0.3)$, $(3,4,1.1,-0.5)$, $(4,0,1.0,0.9)$, $(0,2,0.8,-0.4)$, $(1,3,1.3,0.2)$. Impermeable boundary faces: $(0,\\text{None},2.0,0.0)$, $(1,\\text{None},2.1,0.0)$, $(2,\\text{None},1.9,0.0)$, $(3,\\text{None},2.2,0.0)$, $(4,\\text{None},2.0,0.0)$.\n- Test $2$ (Structured mesh with left-right periodic boundaries and top-bottom impermeable): Cells indexed $i \\in \\{0,1,2,3\\}$ with densities $[\\rho_0,\\rho_1,\\rho_2,\\rho_3] = [1.2, 0.7, 1.0, 0.9]$. Interior faces: $(0,1,1.0,0.4)$, $(2,3,1.0,-0.6)$, $(0,2,1.0,0.5)$, $(1,3,1.0,-0.3)$. Periodic faces treated as interior: $(0,1,0.8,0.33)$, $(2,3,0.8,-0.21)$. Impermeable boundary faces (top and bottom): $(0,\\text{None},0.9,0.0)$, $(1,\\text{None},0.9,0.0)$, $(2,\\text{None},0.9,0.0)$, $(3,\\text{None},0.9,0.0)$.\n- Test $3$ (Zero velocity on all faces): Use the same cells and faces as in Test $1$ but set $u_{n,f} = 0.0$ for all faces, including interior faces.\n\nYour program should compute, for each test, the global sum $\\sum_i R_i$ using the oriented residual definition above. The final output must be a single line containing a comma-separated list enclosed in square brackets with the three floats for Tests $1$, $2$, and $3$, respectively, in that order. For example, the output format must be exactly like $[x_1,x_2,x_3]$ where each $x_k$ is a float computed by your program. The outputs are unitless and do not require any unit conversion.",
            "solution": "The problem is scientifically grounded, self-contained, and well-posed. The tasks involve a standard derivation of the semi-discrete Finite Volume Method (FVM) formulation for the mass conservation equation, a proof of its inherent conservation property, and a numerical verification. All required data and definitions are provided. The problem is valid, and a solution is presented below.\n\n**Task A: Derivation of the Semi-Discrete FVM Formulation**\n\nThe starting point is the integral form of the conservation of mass for a control volume $V$, fluid density $\\rho$, and velocity vector $\\mathbf{u}$:\n$$ \\frac{d}{dt}\\int_{V} \\rho \\, dV + \\oint_{\\partial V} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n} \\, dA = 0 $$\nIn the Finite Volume Method, we apply this equation to each individual cell (or control volume) $V_i$ in the computational mesh. For a single cell $i$, the equation is:\n$$ \\frac{d}{dt}\\int_{V_i} \\rho \\, dV + \\oint_{\\partial V_i} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA = 0 $$\nwhere $\\mathbf{n}_i$ is the local outward-pointing unit normal vector on the boundary $\\partial V_i$ of cell $i$.\n\nThe first term represents the rate of change of mass within cell $i$. We introduce the cell-averaged density $\\rho_i$ as:\n$$ \\rho_i = \\frac{1}{|V_i|}\\int_{V_i}\\rho\\, dV $$\nwhere $|V_i|$ is the volume of cell $i$. The mass in the cell is therefore $m_i = \\rho_i |V_i|$. The time derivative term is:\n$$ \\frac{d}{dt}\\int_{V_i} \\rho \\, dV = \\frac{d}{dt} \\left(\\rho_i |V_i|\\right) $$\nThe problem statement requests this form, which is general for both fixed and moving meshes.\n\nThe second term is the surface integral representing the net mass flux out of cell $i$. The boundary $\\partial V_i$ is composed of a set of flat faces, indexed by $f$. The integral can be discretized into a sum over these faces:\n$$ \\oint_{\\partial V_i} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA = \\sum_{f \\in \\partial V_i} \\int_{A_f} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA $$\nThe FVM approximates the integral over each face by assuming values are constant across the face, equal to some representative face-centered values $\\rho_f$ and $\\mathbf{u}_f$. The integral over a single face $f$ is then approximated as:\n$$ \\int_{A_f} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA \\approx \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_i) A_f $$\nwhere $A_f$ is the area of face $f$.\n\nThe problem defines a single-valued, oriented face flux $\\Phi_f$. For each interior face $f$ shared between a 'left' cell $i$ and a 'right' cell $j$, a fixed unit normal $\\mathbf{n}_f$ is defined pointing from $i$ to $j$. The flux is $\\Phi_f = \\rho_f\\, (\\mathbf{u}_f\\cdot\\mathbf{n}_f)\\, A_f$. We must relate the local outward normal $\\mathbf{n}_i$ to this oriented normal $\\mathbf{n}_f$.\n\n1.  If cell $i$ is the 'left' cell for face $f$, its outward normal $\\mathbf{n}_i$ is the same as the face orientation normal, $\\mathbf{n}_i = \\mathbf{n}_f$. The problem defines a sign factor $s_{i,f} = +1$ for this case. The mass flux through face $f$ out of cell $i$ is:\n    $$ \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_i) A_f = \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_f) A_f = \\Phi_f = s_{i,f} \\Phi_f $$\n2.  If cell $i$ is the 'right' cell for face $f$ (and some other cell $j$ is the 'left' cell), its outward normal $\\mathbf{n}_i$ is opposite to the face orientation normal, $\\mathbf{n}_i = -\\mathbf{n}_f$. The problem defines a sign factor $s_{i,f} = -1$ for this case. The mass flux through face $f$ out of cell $i$ is:\n    $$ \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_i) A_f = \\rho_f (\\mathbf{u}_f \\cdot (-\\mathbf{n}_f)) A_f = - \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_f) A_f = -\\Phi_f = s_{i,f} \\Phi_f $$\n\nIn both cases, the flux contribution from face $f$ to the balance for cell $i$ is $s_{i,f}\\Phi_f$. Summing over all faces of cell $i$, the total net flux is $\\sum_{f \\in \\partial V_i} s_{i,f} \\Phi_f$. This sum is defined as the semi-discrete residual for cell $i$, $R_i$.\n\nSubstituting the discretized terms back into the conservation law for cell $i$ yields the required semi-discrete ordinary differential equation:\n$$ \\frac{d}{dt}\\left(\\rho_i\\, |V_i|\\right) + R_i = 0 $$\nwhere $R_i = \\sum_{f\\in \\partial V_i} s_{i,f}\\, \\Phi_f$. This completes the derivation.\n\n**Task B: Proof of Global Mass Conservation**\n\nWe need to prove that the sum of the semi-discrete residuals over all cells in the domain is zero, i.e., $\\sum_i R_i = 0$, for a domain with only impermeable or periodic boundaries.\n\nThe sum is:\n$$ \\sum_{i} R_i = \\sum_{i} \\left( \\sum_{f \\in \\partial V_i} s_{i,f} \\Phi_f \\right) $$\nThis expression sums over each cell's faces. We can restructure this as a sum over all unique faces in the mesh. Every face's contribution to this global sum can be analyzed based on its type.\n\n1.  **Interior Face**: An interior face $f$ is shared by exactly two cells, the 'left' cell $i$ and the 'right' cell $j$, by definition of the orientation.\n    -   It contributes to the residual $R_i$ of the left cell $i$. For this contribution, $s_{i,f} = +1$, so the term is $+ \\Phi_f$.\n    -   It contributes to the residual $R_j$ of the right cell $j$. For this contribution, $s_{j,f} = -1$, so the term is $- \\Phi_f$.\n    -   The flux $\\Phi_f$ is defined to be single-valued for the face. Therefore, the total contribution of this face $f$ to the global sum $\\sum_k R_k$ is the sum of its contributions to $R_i$ and $R_j$:\n    $$ (+1)\\Phi_f + (-1)\\Phi_f = 0 $$\n    Thus, all interior faces' contributions cancel out pairwise, and the net contribution from all interior faces to the global sum is zero.\n\n2.  **Boundary Face**: A boundary face $f$ belongs to only one cell $i$.\n    -   **Impermeable Boundary**: The physical condition is that the normal velocity is zero, $(\\mathbf{u}_f\\cdot\\mathbf{n}_f) = 0$. This directly leads to a zero flux:\n    $$ \\Phi_f = \\rho_f (\\mathbf{u}_f\\cdot\\mathbf{n}_f) A_f = 0 $$\n    The contribution of this face to the global sum is $s_{i,f}\\Phi_f = 0$.\n    -   **Periodic Boundary**: A periodic boundary face is conceptually paired with another periodic boundary face on a different cell, and the pair is treated as a single interior face. That is, if face $f_a$ on cell $a$ is periodically linked to face $f_b$ on cell $b$, the pair is treated as one conceptual interior face $f$ connecting cells $a$ and $b$. One cell ($a$, for instance) is designated 'left' and the other ($b$) 'right'. The flux $\\Phi_f$ is single-valued for this connection. Just like a regular interior face, the contribution to $R_a$ is $+\\Phi_f$ and the contribution to $R_b$ is $-\\Phi_f$. Their sum is $0$.\n\nSince the domain boundaries are exclusively impermeable or periodic, all faces are either interior, impermeable, or periodic. As shown, the sum of contributions from each type of face to the global sum $\\sum_i R_i$ is zero. Therefore, total mass is conserved by the discretization:\n$$ \\sum_i R_i = 0 $$\nThis completes the proof.\n\n**Task C: Algorithmic Design and Implementation**\n\nThe program for Task C numerically verifies the conservation property proven in Task B. The algorithm directly implements the calculation of the total residual sum $\\sum_i R_i$ for the provided test cases.\n\nThe core of the algorithm is as follows:\n1.  For each test case, initialize an array of residuals $R$ of size equal to the number of cells, with all elements set to $0.0$.\n2.  Iterate through each face defined in the test case's mesh data. Each face is specified as a tuple $(\\ell, r, A_f, u_{n,f})$, where $\\ell$ is the index of the left cell, $r$ is the index of the right cell, $A_f$ is the face area, and $u_{n,f}$ is the normal velocity component.\n3.  For each face, calculate the single-valued flux $\\Phi_f = \\rho_f u_{n,f} A_f$. The face density $\\rho_f$ is computed according to the problem's rules:\n    -   If the face is internal (i.e., $r$ is not `None`), $\\rho_f = \\frac{1}{2}(\\rho_\\ell + \\rho_r)$, where $\\rho_\\ell$ and $\\rho_r$ are the densities of the left and right cells. This also applies to the given periodic connections, which are specified as internal faces.\n    -   If the face is a boundary face (i.e., $r$ is `None`), $\\rho_f = \\rho_\\ell$. For the impermeable boundaries given, this choice is immaterial as $u_{n,f}=0$.\n4.  Update the residuals of the adjacent cells based on the orientation.\n    -   Add $\\Phi_f$ to the residual of the left cell: $R_\\ell \\leftarrow R_\\ell + \\Phi_f$.\n    -   If the face is internal, subtract $\\Phi_f$ from the residual of the right cell: $R_r \\leftarrow R_r - \\Phi_f$.\n5.  After processing all faces, compute the sum of all elements in the residuals array, $\\sum_i R_i$. This sum is the result for the test case.\n\nBased on the proof in Task B, all test cases describe closed systems (only internal, impermeable, or periodic-as-internal faces). Therefore, the analytical result for $\\sum_i R_i$ in all three tests is exactly $0$. The numerical implementation should yield a result of $0.0$ or a value very close to it, within the limits of floating-point precision. Test $3$, with all velocities being zero, provides a trivial check, as all fluxes $\\Phi_f$ must be zero, leading to all residuals $R_i$ and their sum being identically zero. The program below implements this logic.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by computing the sum of semi-discrete residuals for three test cases.\n    \"\"\"\n\n    # Test cases data structure:\n    # Each test case is a dictionary containing:\n    # 'densities': a list of cell densities [rho_0, rho_1, ...]\n    # 'faces': a list of face tuples (left_cell, right_cell, area, normal_velocity).\n    #          right_cell is None for boundary faces.\n    \n    test_cases_data = [\n        {\n            \"densities\": [1.0, 0.8, 1.3, 0.9, 1.1],\n            \"faces\": [\n                # Interior faces\n                (0, 1, 1.2, 0.7), \n                (1, 2, 0.9, -1.1),\n                (2, 3, 1.5, 0.3),\n                (3, 4, 1.1, -0.5),\n                (4, 0, 1.0, 0.9),\n                (0, 2, 0.8, -0.4),\n                (1, 3, 1.3, 0.2),\n                # Impermeable boundary faces\n                (0, None, 2.0, 0.0),\n                (1, None, 2.1, 0.0),\n                (2, None, 1.9, 0.0),\n                (3, None, 2.2, 0.0),\n                (4, None, 2.0, 0.0)\n            ],\n        },\n        {\n            \"densities\": [1.2, 0.7, 1.0, 0.9],\n            \"faces\": [\n                # Interior faces\n                (0, 1, 1.0, 0.4),\n                (2, 3, 1.0, -0.6),\n                (0, 2, 1.0, 0.5),\n                (1, 3, 1.0, -0.3),\n                # Periodic faces (treated as interior)\n                (0, 1, 0.8, 0.33),\n                (2, 3, 0.8, -0.21),\n                # Impermeable boundary faces\n                (0, None, 0.9, 0.0),\n                (1, None, 0.9, 0.0),\n                (2, None, 0.9, 0.0),\n                (3, None, 0.9, 0.0)\n            ],\n        },\n        {\n            # Test 3 uses Test 1 topology with zero velocities\n            \"densities\": [1.0, 0.8, 1.3, 0.9, 1.1],\n            \"faces\": [\n                (0, 1, 1.2, 0.0), \n                (1, 2, 0.9, 0.0),\n                (2, 3, 1.5, 0.0),\n                (3, 4, 1.1, 0.0),\n                (4, 0, 1.0, 0.0),\n                (0, 2, 0.8, 0.0),\n                (1, 3, 1.3, 0.0),\n                (0, None, 2.0, 0.0),\n                (1, None, 2.1, 0.0),\n                (2, None, 1.9, 0.0),\n                (3, None, 2.2, 0.0),\n                (4, None, 2.0, 0.0)\n            ],\n        },\n    ]\n\n    def compute_total_residual(densities, faces):\n        \"\"\"\n        Computes the sum of semi-discrete residuals for a given mesh configuration.\n        \"\"\"\n        num_cells = len(densities)\n        residuals = np.zeros(num_cells, dtype=np.float64)\n        \n        rho_cells = np.array(densities, dtype=np.float64)\n\n        for face in faces:\n            left_cell, right_cell, area, u_normal = face\n            \n            rho_face = 0.0\n            if right_cell is not None:\n                # Interior or periodic face\n                rho_face = 0.5 * (rho_cells[left_cell] + rho_cells[right_cell])\n            else:\n                # Boundary face\n                rho_face = rho_cells[left_cell]\n\n            # Calculate the single-valued face flux\n            flux = rho_face * u_normal * area\n            \n            # Update residuals for adjacent cells based on orientation\n            # Left cell ('i') has s_if = +1\n            residuals[left_cell] += flux\n            \n            if right_cell is not None:\n                # Right cell ('j') has s_jf = -1\n                residuals[right_cell] -= flux\n        \n        # Return the sum of all residuals, which should be zero for a closed system\n        return np.sum(residuals)\n\n    results = []\n    for case in test_cases_data:\n        total_residual = compute_total_residual(case[\"densities\"], case[\"faces\"])\n        results.append(total_residual)\n\n    # Format and print the final output as a single-line string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The ultimate test of a conservative numerical scheme is its ability to correctly capture sharp discontinuities like shock waves. The physics across a shock are governed by the Rankine-Hugoniot jump conditions, which are the algebraic expression of the conservation laws. This advanced exercise demonstrates this critical link by implementing a conservative HLLC Riemann solver and verifying that it automatically satisfies the Rankine-Hugoniot conditions for mass, momentum, and energy, thereby accurately capturing the shock physics without any special treatment .",
            "id": "3944124",
            "problem": "Consider the one-dimensional compressible Euler equations expressed in conservation form for a thermally and calorically perfect gas with specific heat ratio $\\gamma$:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0,\n$$\nwhere $\\mathbf{U} = [\\rho, \\rho u, E]^T$ is the vector of conserved variables, $\\rho$ is the mass density, $u$ is the velocity, and $E$ is the total energy per unit volume. The conservative flux is $\\mathbf{F}(\\mathbf{U}) = [\\rho u,\\ \\rho u^2 + p,\\ u(E + p)]^T$, with thermodynamic closure for a perfect gas $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$.\n\nStart from the integral form of the conservation laws and the definition of a weak solution with a moving discontinuity at speed $s$, and derive the Rankine–Hugoniot conditions that relate the jump in conservative flux to the jump in state across the discontinuity:\n$$\n\\mathbf{F}(\\mathbf{U}_R) - \\mathbf{F}(\\mathbf{U}_L) = s\\left( \\mathbf{U}_R - \\mathbf{U}_L \\right).\n$$\nUsing this principle, the shock speed $s$ must be identical whether computed from the mass, momentum, or energy conservation equations for any physically admissible discontinuity in a conservative system.\n\nImplement a Riemann solver based on a conservative approximate flux method, specifically the Harten–Lax–van Leer–Contact (HLLC) solver, which is designed to capture shocks and contact discontinuities while satisfying the Rankine–Hugoniot conditions across the left and right waves. For each test case below, construct the left and right states $\\mathbf{U}_L$ and $\\mathbf{U}_R$ from primitive variables $(\\rho, u, p)$ using the perfect-gas equation of state. Compute the HLLC wave speeds and star-region states, then verify the Rankine–Hugoniot shock speed across each of the outer waves (left and right) by evaluating\n$$\ns_i = \\frac{F_i(\\mathbf{U}_\\star) - F_i(\\mathbf{U})}{U_i^\\star - U_i}\n$$\nfor $i \\in \\{1,2,3\\}$ corresponding to mass, momentum, and energy, respectively, where $\\mathbf{U}$ denotes the pre-wave state and $\\mathbf{U}_\\star$ denotes the post-wave star state for the corresponding wave. Confirm that each $s_i$ matches the HLLC wave speed $S$ for that wave within a specified numerical tolerance.\n\nPhysical units must be used for the primitive variables: density $\\rho$ in $\\mathrm{kg/m^3}$, velocity $u$ in $\\mathrm{m/s}$, pressure $p$ in $\\mathrm{Pa}$, and the resulting shock speeds $s$ and wave speeds $S$ in $\\mathrm{m/s}$. All angles, if any arise, must be measured in radians. No percentages are required in this task.\n\nUse the following test suite with specific parameter values to assess correctness. For each case, the gas is perfect with $\\gamma = 1.4$.\n\n- Case $1$ (canonical right-moving shock with quiescent initial states): left state $(\\rho_L, u_L, p_L) = (1.0,\\ 0.0,\\ 100000.0)$, right state $(\\rho_R, u_R, p_R) = (0.125,\\ 0.0,\\ 10000.0)$.\n- Case $2$ (left-moving shock possibility): left state $(\\rho_L, u_L, p_L) = (0.5,\\ 0.0,\\ 20000.0)$, right state $(\\rho_R, u_R, p_R) = (1.0,\\ 0.0,\\ 200000.0)$.\n- Case $3$ (transonic counter-flow): left state $(\\rho_L, u_L, p_L) = (1.0,\\ 200.0,\\ 500000.0)$, right state $(\\rho_R, u_R, p_R) = (0.8,\\ -100.0,\\ 100000.0)$.\n- Case $4$ (small jump, near-contact behavior): left state $(\\rho_L, u_L, p_L) = (1.0,\\ 10.0,\\ 100000.0)$, right state $(\\rho_R, u_R, p_R) = (0.99,\\ 9.5,\\ 98000.0)$.\n\nFor each test case, compute two booleans:\n- One boolean that is true if the Rankine–Hugoniot speeds computed independently from mass, momentum, and energy across the left wave all agree with the HLLC left wave speed within an absolute tolerance of $10^{-9}$ in $\\mathrm{m/s}$.\n- One boolean that is true if the Rankine–Hugoniot speeds computed independently from mass, momentum, and energy across the right wave all agree with the HLLC right wave speed within an absolute tolerance of $10^{-9}$ in $\\mathrm{m/s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\"). The list must contain booleans in the order $[\\text{Case 1 left}, \\text{Case 1 right}, \\text{Case 2 left}, \\text{Case 2 right}, \\text{Case 3 left}, \\text{Case 3 right}, \\text{Case 4 left}, \\text{Case 4 right}]\".",
            "solution": "The problem requires the validation of the Rankine–Hugoniot jump conditions for states computed by the Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solver. This validation is performed for the one-dimensional compressible Euler equations for a perfect gas. The core of the task is to implement the HLLC solver, compute the intermediate \"star\" states, and verify that the jump in flux across the outer waves is consistent with the jump in the conserved state variables, as dictated by the Rankine–Hugoniot relations.\n\nThe one-dimensional Euler equations are given in conservation form as:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0\n$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}(\\mathbf{U})$ is the corresponding flux vector:\n$$\n\\mathbf{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{bmatrix}\n$$\nHere, $\\rho$ is the mass density, $u$ is the velocity, $E$ is the total energy per unit volume, and $p$ is the pressure. For a thermally and calorically perfect gas, the system is closed with the equation of state:\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\nwhere $\\gamma$ is the specific heat ratio. This relation can be rearranged to express pressure in terms of the conserved variables:\n$$\np = (\\gamma - 1) \\left( E - \\frac{1}{2}\\frac{(\\rho u)^2}{\\rho} \\right) = (\\gamma - 1) \\left( U_3 - \\frac{U_2^2}{2U_1} \\right)\n$$\n\nThe Rankine–Hugoniot conditions are derived from the integral form of the conservation law. Considering a control volume $[x_L, x_R]$ containing a discontinuity moving at speed $s$, the integral form is:\n$$\n\\frac{d}{dt} \\int_{x_L}^{x_R} \\mathbf{U} dx + \\mathbf{F}(\\mathbf{U}_R) - \\mathbf{F}(\\mathbf{U}_L) = 0\n$$\nApplying the Leibniz integral rule and shrinking the control volume to the discontinuity, $[x_L, x_R] \\to x_s(t)$, where $\\frac{dx_s}{dt} = s$, we obtain the jump conditions:\n$$\ns \\left( \\mathbf{U}_R - \\mathbf{U}_L \\right) = \\mathbf{F}(\\mathbf{U}_R) - \\mathbf{F}(\\mathbf{U}_L)\n$$\nThis relation, denoted as $[\\mathbf{F}] = s[\\mathbf{U}]$, must hold for each component of the vectors for any physically admissible shock wave in a conservative system.\n\nThe HLLC approximate Riemann solver models the solution to a Riemann problem (two constant states $\\mathbf{U}_L$ and $\\mathbf{U}_R$ separated at $x=0$) as a set of four constant states separated by three waves: a left wave, a contact discontinuity, and a right wave.\nThe wave structure is:\n- State $\\mathbf{U}_L$ for $x/t < S_L$\n- State $\\mathbf{U}_{\\star L}$ for $S_L < x/t < S_\\star$\n- State $\\mathbf{U}_{\\star R}$ for $S_\\star < x/t < S_R$\n- State $\\mathbf{U}_R$ for $x/t > S_R$\nwhere $S_L$, $S_\\star$, and $S_R$ are the speeds of the left-traveling wave, the contact wave, and the right-traveling wave, respectively. The velocity and pressure are continuous across the contact wave ($u_{\\star L} = u_{\\star R} = S_\\star$ and $p_{\\star L} = p_{\\star R} = p_\\star$), but the density may be discontinuous.\n\nThe algorithmic procedure to compute the HLLC states and verify the Rankine-Hugoniot conditions is as follows:\n\n1.  **State Conversion**: Convert the initial primitive variables $(\\rho_k, u_k, p_k)$ for $k \\in \\{L, R\\}$ into conserved variable vectors $\\mathbf{U}_k$ using the equation for total energy $E$.\n\n2.  **Wave Speed Estimation**: The outer wave speeds, $S_L$ and $S_R$, must be estimated to bracket all physical characteristics. A common and robust choice, the Davis (1988) estimate, is used:\n    $$\n    S_L = \\min(u_L - a_L, u_R - a_R)\n    $$\n    $$\n    S_R = \\max(u_L + a_L, u_R + a_R)\n    $$\n    where $a_k = \\sqrt{\\gamma p_k / \\rho_k}$ is the speed of sound in state $k$.\n\n3.  **Contact Wave Speed**: The speed of the contact wave, $S_\\star$, is determined by applying the Rankine-Hugoniot conditions for momentum across the left and right waves, yielding:\n    $$\n    S_\\star = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)}\n    $$\n\n4.  **Star-Region States**: The states between the waves, $\\mathbf{U}_{\\star L}$ and $\\mathbf{U}_{\\star R}$, are found by applying the Rankine-Hugoniot conditions across the $S_L$ and $S_R$ waves.\n    - The star pressure $p_\\star$ is found from the jump across the left wave: $p_\\star = p_L + \\rho_L(u_L - S_L)(u_L - S_\\star)$.\n    - The star velocity is $u_\\star = S_\\star$.\n    - The star densities are found from mass conservation across their respective waves:\n      $$\n      \\rho_{\\star L} = \\rho_L \\frac{S_L - u_L}{S_L - S_\\star}\n      $$\n      $$\n      \\rho_{\\star R} = \\rho_R \\frac{S_R - u_R}{S_R - S_\\star}\n      $$\n    - With the primitive variables $(\\rho_{\\star k}, u_\\star, p_\\star)$ for $k \\in \\{L, R\\}$, the conserved state vectors $\\mathbf{U}_{\\star L}$ and $\\mathbf{U}_{\\star R}$ are constructed.\n\n5.  **Verification**: The final step is to confirm that the computed states and wave speeds satisfy the Rankine–Hugoniot conditions.\n    - **Left Wave**: The jump is from $\\mathbf{U}_L$ to $\\mathbf{U}_{\\star L}$. For each component $i \\in \\{1,2,3\\}$, we must verify if the calculated shock speed $s_{L,i}$ equals $S_L$:\n      $$\n      s_{L,i} = \\frac{F_i(\\mathbf{U}_{\\star L}) - F_i(\\mathbf{U}_L)}{U_{i, \\star L} - U_{i, L}} \\stackrel{?}{=} S_L\n      $$\n    - **Right Wave**: The jump is from $\\mathbf{U}_{\\star R}$ to $\\mathbf{U}_R$. Similarly, we verify if:\n      $$\n      s_{R,i} = \\frac{F_i(\\mathbf{U}_R) - F_i(\\mathbf{U}_{\\star R})}{U_{i, R} - U_{i, \\star R}} \\stackrel{?}{=} S_R\n      $$\n    A numerical tolerance is used for this comparison. A special case arises if the jump in a conserved variable, $U_i$, is zero (or numerically close). In this situation, the corresponding jump in flux, $F_i$, must also be zero for the condition to be satisfied. The implementation handles this by checking if $|U_{post,i} - U_{pre,i}|$ is below a small threshold; if so, it verifies that $|F_{post,i} - F_{pre,i}|$ is also below that threshold. Otherwise, the ratio is computed and compared to the wave speed. By its construction, the HLLC method is guaranteed to satisfy these conditions exactly, so this serves as a verification of the implementation's correctness.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef prim_to_cons(rho, u, p, gamma):\n    \"\"\"Converts primitive variables to conserved variables.\"\"\"\n    E = p / (gamma - 1.0) + 0.5 * rho * u**2\n    return np.array([rho, rho * u, E])\n\ndef compute_flux_from_cons(U, gamma):\n    \"\"\"Computes the Euler flux vector from conserved variables.\"\"\"\n    rho, rhou, E = U\n    u = rhou / rho\n    # Pressure from conserved variables\n    p = (gamma - 1.0) * (E - 0.5 * rho * u**2)\n    return np.array([rhou, rhou * u + p, u * (E + p)])\n\ndef verify_rh(U_pre, U_post, F_pre, F_post, S_wave, tol):\n    \"\"\"Verifies the Rankine-Hugoniot conditions for a single wave.\"\"\"\n    results = []\n    # A small tolerance to handle near-zero denominators\n    zero_tol = 1e-12\n    for i in range(3):\n        delta_U = U_post[i] - U_pre[i]\n        delta_F = F_post[i] - F_pre[i]\n\n        if abs(delta_U) < zero_tol:\n            # If the jump in U is zero, the jump in F must also be zero\n            # for the R-H condition F_jump = S * U_jump to hold.\n            results.append(abs(delta_F) < zero_tol)\n        else:\n            s_calc = delta_F / delta_U\n            results.append(abs(s_calc - S_wave) < tol)\n    \n    return all(results)\n\ndef hllc_solver_and_verify(prim_L, prim_R, gamma, tol):\n    \"\"\"\n    Computes HLLC intermediate states for a Riemann problem and verifies\n    the Rankine-Hugoniot conditions across the outer waves.\n    \"\"\"\n    # 1. Unpack primitive variables\n    rho_L, u_L, p_L = prim_L\n    rho_R, u_R, p_R = prim_R\n\n    # 2. Convert to conserved variables\n    U_L = prim_to_cons(rho_L, u_L, p_L, gamma)\n    U_R = prim_to_cons(rho_R, u_R, p_R, gamma)\n\n    # 3. Compute sound speeds\n    a_L = (gamma * p_L / rho_L)**0.5\n    a_R = (gamma * p_R / rho_R)**0.5\n\n    # 4. Estimate wave speeds (Davis 1988 estimate)\n    S_L = min(u_L - a_L, u_R - a_R)\n    S_R = max(u_L + a_L, u_R + a_R)\n\n    # 5. Compute contact wave speed S_star\n    num_S_star = p_R - p_L + rho_L * u_L * (S_L - u_L) - rho_R * u_R * (S_R - u_R)\n    den_S_star = rho_L * (S_L - u_L) - rho_R * (S_R - u_R)\n    S_star = num_S_star / den_S_star\n\n    # 6. Compute left star state (U_star_L)\n    p_star_L = p_L + rho_L * (u_L - S_L) * (u_L - S_star)\n    rho_star_L = rho_L * (S_L - u_L) / (S_L - S_star)\n    u_star_L = S_star\n    U_star_L = prim_to_cons(rho_star_L, u_star_L, p_star_L, gamma)\n\n    # 7. Compute right star state (U_star_R)\n    p_star_R = p_R + rho_R * (u_R - S_R) * (u_R - S_star)\n    rho_star_R = rho_R * (S_R - u_R) / (S_R - S_star)\n    u_star_R = S_star\n    U_star_R = prim_to_cons(rho_star_R, u_star_R, p_star_R, gamma)\n\n    # 8. Compute all necessary flux vectors\n    F_L = compute_flux_from_cons(U_L, gamma)\n    F_R = compute_flux_from_cons(U_R, gamma)\n    F_star_L = compute_flux_from_cons(U_star_L, gamma)\n    F_star_R = compute_flux_from_cons(U_star_R, gamma)\n\n    # 9. Verify Rankine-Hugoniot condition for the left wave\n    # Jump is from state L to state *L\n    left_wave_ok = verify_rh(U_L, U_star_L, F_L, F_star_L, S_L, tol)\n\n    # 10. Verify Rankine-Hugoniot condition for the right wave\n    # Jump is from state *R to state R\n    right_wave_ok = verify_rh(U_star_R, U_R, F_star_R, F_R, S_R, tol)\n\n    return left_wave_ok, right_wave_ok\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    gamma = 1.4\n    tolerance = 1e-9\n\n    test_cases = [\n        # Case 1: Canonical right-moving shock\n        ((1.0, 0.0, 100000.0), (0.125, 0.0, 10000.0)),\n        # Case 2: Left-moving shock possibility\n        ((0.5, 0.0, 20000.0), (1.0, 0.0, 200000.0)),\n        # Case 3: Transonic counter-flow\n        ((1.0, 200.0, 500000.0), (0.8, -100.0, 100000.0)),\n        # Case 4: Small jump, near-contact behavior\n        ((1.0, 10.0, 100000.0), (0.99, 9.5, 98000.0)),\n    ]\n\n    results = []\n    for case in test_cases:\n        prim_L, prim_R = case\n        left_ok, right_ok = hllc_solver_and_verify(prim_L, prim_R, gamma, tolerance)\n        results.extend([left_ok, right_ok])\n    \n    # Format the boolean list into the required string format\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}