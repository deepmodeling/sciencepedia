{
    "hands_on_practices": [
        {
            "introduction": "对于各向异性材料，导热系数不再是一个单一数值，而是一个张量 $\\boldsymbol{K}$，描述了热量在不同方向上传导能力的差异。为了深入理解材料的导热特性，我们必须确定其主导热率和主方向，这对应于 $\\boldsymbol{K}$ 张量的特征值和特征向量。本练习将引导你通过一个具体的例子，计算一个随温度变化的导热系数张量的特征分解，从而掌握表征各向异性材料物理特性的核心方法 。",
            "id": "3997961",
            "problem": "考虑各向异性固体中的稳态热传导，其本构关系由张量形式的傅里叶定律给出，$\\,\\boldsymbol{q}=-\\boldsymbol{K}(T)\\,\\nabla T\\,$，其中 $\\boldsymbol{K}(T)$ 是可能依赖于温度 $T$ 的二阶热导率张量。对于无外场的宏观均匀介质，互易性意味着 $\\boldsymbol{K}(T)$ 是对称的，并且为了物理稳定性，它是正定的。主热导率和主方向由 $\\boldsymbol{K}(T)$ 的谱性质定义。\n\n一种单向增强复合材料由于纤维错位而表现出面内耦合，但在厚度方向上保持非耦合。其在实验室坐标系 $\\{x,y,z\\}$ 中与温度相关的热导率张量建模如下\n$$\n\\boldsymbol{K}(T)=\n\\begin{pmatrix}\nk_{xx}(T)  k_{xy}(T)  0 \\\\\nk_{xy}(T)  k_{yy}(T)  0 \\\\\n0  0  k_{zz}(T)\n\\end{pmatrix},\n$$\n具有围绕 $T_{0} = 300\\,\\mathrm{K}$ 的线性温度依赖关系，\n$$\nk_{xx}(T)=k_{xx,0}+\\alpha_{xx}\\,(T-T_{0}),\\quad\nk_{yy}(T)=k_{yy,0}+\\alpha_{yy}\\,(T-T_{0}),\\quad\nk_{xy}(T)=k_{xy,0}+\\alpha_{xy}\\,(T-T_{0}),\\quad\nk_{zz}(T)=k_{zz,0}+\\alpha_{zz}\\,(T-T_{0}),\n$$\n其中 $k_{xx,0}=6$、$\\alpha_{xx}=0.03$、$k_{yy,0}=5$、$\\alpha_{yy}=0.03$、$k_{xy,0}=2$、$\\alpha_{xy}=0.02$、$k_{zz,0}=3$ 和 $\\alpha_{zz}=0.04$，对于系数 $\\alpha$，单位是每开尔文 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。在 $T=330\\,\\mathrm{K}$ 时，通过计算 $\\boldsymbol{K}(T)$ 的特征值和归一化特征向量来评估主热导率及相应的主方向。\n\n从傅里叶定律以及 $\\boldsymbol{K}(T)$ 的对称性/正定性出发，首先论证为什么主热导率和主方向是通过求解 $\\boldsymbol{K}(T)$ 的特征值问题得到的。然后，在 $T=330\\,\\mathrm{K}$ 时，显式地计算给定 $\\boldsymbol{K}(T)$ 的特征值和归一化特征向量。\n\n将主热导率以 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ 为单位表示，并将主方向表示为相对于 $\\{x,y,z\\}$ 坐标系的方向余弦（无量纲）。提供精确的解析形式；不要四舍五入。对于最终答案，请按顺序列出三个主热导率，然后是每个相应归一化特征向量的 $x、y$ 和 $z$ 分量。",
            "solution": "该问题是有效的，因为它在科学上基于连续介质力学和热传导的原理，是适定的，并为求得唯一解提供了所有必要的信息。\n\n首先，我们论证为何使用特征值问题来寻找主热导率和主方向。热导率的一个主方向是指这样一个方向（由单位向量 $\\boldsymbol{n}$ 表示）：在该方向上，温度梯度 $\\nabla T$ 产生的热通量向量 $\\boldsymbol{q}$ 与该梯度纯粹反平行。也就是说，如果 $\\nabla T$ 与 $\\boldsymbol{n}$ 方向一致，那么 $\\boldsymbol{q}$ 也与 $\\boldsymbol{n}$ 方向一致，但指向相反。\n\n设温度梯度为 $\\nabla T = G\\boldsymbol{n}$，其中 $G = |\\nabla T|$ 是梯度的模。$\\boldsymbol{n}$ 成为主方向的条件是，产生的热通量为 $\\boldsymbol{q} = -k_n G\\boldsymbol{n}$，其中 $k_n$ 是该方向上的标量热导率，即主热导率。\n\n将这些代入傅里叶定律 $\\boldsymbol{q} = -\\boldsymbol{K}(T)\\nabla T$，我们得到：\n$$ -k_n G\\boldsymbol{n} = -\\boldsymbol{K}(T)(G\\boldsymbol{n}) $$\n由于 $G$ 是一个非零标量，我们可以两边同除以 $-G$：\n$$ k_n \\boldsymbol{n} = \\boldsymbol{K}(T)\\boldsymbol{n} $$\n将其重写为特征值问题的标准形式：\n$$ \\boldsymbol{K}(T)\\boldsymbol{n} = k_n \\boldsymbol{n} $$\n这个方程表明，主热导率 $k_n$ 是热导率张量 $\\boldsymbol{K}(T)$ 的特征值，而相应的主方向是其特征向量 $\\boldsymbol{n}$。由于问题陈述 $\\boldsymbol{K}(T)$ 是对称且正定的，谱定理保证它具有实的、正的特征值（物理上必需的热导率）和一组三个相互正交的特征向量（热导率的主轴）。\n\n现在，我们着手计算给定问题的这些量。\n温度为 $T = 330\\,\\mathrm{K}$，参考温度为 $T_0 = 300\\,\\mathrm{K}$。温差为 $T - T_0 = 30\\,\\mathrm{K}$。\n我们首先计算在 $T=330\\,\\mathrm{K}$ 时热导率张量 $\\boldsymbol{K}$ 的各分量：\n$k_{xx}(T) = k_{xx,0} + \\alpha_{xx}(T-T_0) = 6 + (0.03)(30) = 6 + 0.9 = 6.9$\n$k_{yy}(T) = k_{yy,0} + \\alpha_{yy}(T-T_0) = 5 + (0.03)(30) = 5 + 0.9 = 5.9$\n$k_{xy}(T) = k_{xy,0} + \\alpha_{xy}(T-T_0) = 2 + (0.02)(30) = 2 + 0.6 = 2.6$\n$k_{zz}(T) = k_{zz,0} + \\alpha_{zz}(T-T_0) = 3 + (0.04)(30) = 3 + 1.2 = 4.2$\n\n所有值的单位都是 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。该热导率张量为：\n$$\n\\boldsymbol{K} =\n\\begin{pmatrix}\n6.9  2.6  0 \\\\\n2.6  5.9  0 \\\\\n0  0  4.2\n\\end{pmatrix}\n$$\n为了求特征值 $\\lambda$，我们求解特征方程 $\\det(\\boldsymbol{K} - \\lambda\\boldsymbol{I}) = 0$：\n$$\n\\det\n\\begin{pmatrix}\n6.9 - \\lambda  2.6  0 \\\\\n2.6  5.9 - \\lambda  0 \\\\\n0  0  4.2 - \\lambda\n\\end{pmatrix} = 0\n$$\n由于其块对角结构，该行列式展开为：\n$$ (4.2 - \\lambda) \\left[ (6.9 - \\lambda)(5.9 - \\lambda) - (2.6)^2 \\right] = 0 $$\n一个特征值立即可见：$\\lambda_3 = 4.2$。\n\n另外两个特征值是来自 $2 \\times 2$ 子块的二次方程的根：\n$$ \\lambda^2 - (6.9 + 5.9)\\lambda + (6.9)(5.9) - (2.6)^2 = 0 $$\n$$ \\lambda^2 - 12.8\\lambda + 40.71 - 6.76 = 0 $$\n$$ \\lambda^2 - 12.8\\lambda + 33.95 = 0 $$\n为了保持精度，我们使用分数进行计算：$k_{xx} = \\frac{69}{10}$，$k_{yy} = \\frac{59}{10}$，$k_{xy} = \\frac{26}{10}$。方程为 $\\lambda^2 - \\frac{128}{10}\\lambda + \\frac{3395}{100} = 0$，即 $20\\lambda^2 - 256\\lambda + 679 = 0$。\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$ \\lambda = \\frac{256 \\pm \\sqrt{(-256)^2 - 4(20)(679)}}{2(20)} = \\frac{256 \\pm \\sqrt{65536 - 54320}}{40} = \\frac{256 \\pm \\sqrt{11216}}{40} $$\n判别式可以简化为：$\\sqrt{11216} = \\sqrt{16 \\times 701} = 4\\sqrt{701}$。\n$$ \\lambda = \\frac{256 \\pm 4\\sqrt{701}}{40} = \\frac{64 \\pm \\sqrt{701}}{10} $$\n所以，另外两个主热导率是 $\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$ 和 $\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$。\n\n三个主热导率是：\n$\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$\n$\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$\n$\\lambda_3 = 4.2 = \\frac{21}{5}$\n\n接下来，我们求相应的归一化特征向量（主方向）。\n对于 $\\lambda_3 = 4.2$，我们求解 $(\\boldsymbol{K} - 4.2\\boldsymbol{I})\\boldsymbol{v}_3 = \\boldsymbol{0}$：\n$$\n\\begin{pmatrix}\n2.7  2.6  0 \\\\\n2.6  1.7  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\begin{pmatrix} v_x \\\\ v_y \\\\ v_z \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n前两行给出了一个关于 $v_x, v_y$ 的方程组，其行列式不为零（$(2.7)(1.7) - (2.6)^2 = 4.59 - 6.76 = -2.17$），所以 $v_x=0$ 且 $v_y=0$。第三行 $0 \\cdot v_z=0$ 对任何 $v_z$ 都成立。我们选择 $v_z=1$ 以得到一个单位向量。\n$\\lambda_3$ 的归一化特征向量是 $\\boldsymbol{n}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n\n对于 $\\lambda_1$ 和 $\\lambda_2$，特征向量位于 $xy$ 平面内，所以 $v_z=0$。我们求解 $(\\boldsymbol{K}_{xy} - \\lambda \\boldsymbol{I})\\boldsymbol{v} = \\boldsymbol{0}$，其中 $\\boldsymbol{K}_{xy}$ 是左上角的 $2 \\times 2$ 子矩阵。\n使用方程组的第一行，$(6.9 - \\lambda)v_x + 2.6v_y = 0$，或 $(69-10\\lambda)v_x + 26v_y = 0$。\n\n对于 $\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$：\n$10\\lambda_1 = 64 + \\sqrt{701}$。\n$(69 - (64 + \\sqrt{701}))v_x + 26v_y = 0 \\implies (5 - \\sqrt{701})v_x + 26v_y = 0$。\n我们可以选择一个未归一化的特征向量为 $\\boldsymbol{v}_1' = \\begin{pmatrix} 26 \\\\ \\sqrt{701} - 5 \\\\ 0 \\end{pmatrix}$。\n其范数的平方是 $|\\boldsymbol{v}_1'|^2 = 26^2 + (\\sqrt{701}-5)^2 = 676 + (701 - 10\\sqrt{701} + 25) = 1402 - 10\\sqrt{701}$。\n归一化特征向量是 $\\boldsymbol{n}_1 = \\frac{1}{\\sqrt{1402 - 10\\sqrt{701}}} \\begin{pmatrix} 26 \\\\ \\sqrt{701}-5 \\\\ 0 \\end{pmatrix}$。\n\n对于 $\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$：\n$10\\lambda_2 = 64 - \\sqrt{701}$。\n$(69 - (64 - \\sqrt{701}))v_x + 26v_y = 0 \\implies (5 + \\sqrt{701})v_x + 26v_y = 0$。\n一个未归一化的特征向量是 $\\boldsymbol{v}_2' = \\begin{pmatrix} 26 \\\\ -5 - \\sqrt{701} \\\\ 0 \\end{pmatrix}$。\n其范数的平方是 $|\\boldsymbol{v}_2'|^2 = 26^2 + (-5-\\sqrt{701})^2 = 676 + (25 + 10\\sqrt{701} + 701) = 1402 + 10\\sqrt{701}$。\n归一化特征向量是 $\\boldsymbol{n}_2 = \\frac{1}{\\sqrt{1402 + 10\\sqrt{701}}} \\begin{pmatrix} 26 \\\\ -5 - \\sqrt{701} \\\\ 0 \\end{pmatrix}$。\n\n主热导率是 $\\lambda_1, \\lambda_2, \\lambda_3$，相应的主方向（作为方向余弦）是 $\\boldsymbol{n}_1, \\boldsymbol{n}_2, \\boldsymbol{n}_3$ 的分量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{64 + \\sqrt{701}}{10}  \\frac{64 - \\sqrt{701}}{10}  \\frac{21}{5}  \\frac{26}{\\sqrt{1402 - 10\\sqrt{701}}}  \\frac{\\sqrt{701}-5}{\\sqrt{1402 - 10\\sqrt{701}}}  0  \\frac{26}{\\sqrt{1402 + 10\\sqrt{701}}}  \\frac{-5-\\sqrt{701}}{\\sqrt{1402 + 10\\sqrt{701}}}  0  0  0  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "材料属性的温度依赖性会对整个系统的热行为产生深远甚至剧烈的影响。本练习探讨一个关键的非线性现象——热失控，即在特定条件下，内部热源的增长会超过材料的散热能力，导致温度失控上升。你将运用线性稳定性分析这一强大工具，从第一性原理出发推导失稳的临界条件，这对于评估和设计在高工作温度下运行的系统的安全性至关重要 。",
            "id": "3997989",
            "problem": "一个均质正交各向异性固体占据矩形域 $\\Omega = (0,L_x)\\times(0,L_y)\\times(0,L_z)$，其等温边界保持在恒定温度 $T_s$。温度场 $T(\\mathbf{x},t)$ 的内能平衡由以下守恒定律决定\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big) \\;+\\; Q(T)\\,,\n$$\n其中 $\\rho$ 是密度，$c$ 是比热容，$\\mathbf{K}(T)$ 是各向异性导热张量，$Q(T)$ 是体积生热率。张量 $\\mathbf{K}(T)$ 是对角张量，其主分量为 $\\mathbf{K}(T)=\\mathrm{diag}\\big(k_x(T),k_y(T),k_z(T)\\big)$，并且是 $T$ 的光滑函数。热源满足 $Q(T_s)=0$，并在 $T_s$ 的邻域内单调递增，因此对于与 $T_s$ 的微小偏差，有 $Q(T)\\approx \\alpha\\,(T-T_s)$，其中 $\\alpha=\\left.\\frac{dQ}{dT}\\right|_{T_s}>0$。\n\n从能量守恒出发，不预先假设任何不稳定性阈值的公式，对均匀基态 $T(\\mathbf{x},t)\\equiv T_s$ 进行第一性原理线性稳定性分析，以揭示与温度相关的各向异性导热系数 $\\mathbf{K}(T)$ 和与温度相关的生热 $Q(T)$ 之间的相互作用如何导致热失控。推导一个判据，该判据确定了热源斜率的一个临界值 $\\alpha_c$，超过该临界值，微小扰动会随时间指数增长，表明 $T_s$ 失去稳定性。\n\n然后，对于一个矩形样本，其参数为：\n- $L_x = 0.02\\ \\mathrm{m}$，$L_y = 0.01\\ \\mathrm{m}$，$L_z = 0.005\\ \\mathrm{m}$，\n- $k_x(T_s)=140\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，$k_y(T_s)=70\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，$k_z(T_s)=35\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，\n\n数值计算相应的临界阈值 $\\alpha_c$。将您的答案四舍五入到四位有效数字。以 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$ 为单位表示最终答案。最终答案必须是单个实数。",
            "solution": "经评估，该问题陈述有效。其科学基础在于传热学和稳定性理论的原理，问题提法得当，目标明确，数据充分，且无矛盾或歧义。基态 $T(\\mathbf{x},t) \\equiv T_s$ 是控制方程的一个有效稳态解，因为 $\\rho c \\frac{\\partial T_s}{\\partial t} = 0$，$\\nabla T_s = \\mathbf{0}$，且问题陈述中说明 $Q(T_s)=0$，满足 $0 = \\nabla \\cdot (\\mathbf{0}) + 0$。因此，我们可以进行稳定性分析。\n\n温度场 $T(\\mathbf{x}, t)$ 的控制方程由能量守恒给出：\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big) \\;+\\; Q(T)\n$$\n我们围绕均匀基态 $T_0(\\mathbf{x}, t) = T_s$ 进行线性稳定性分析。我们引入一个微小扰动 $\\theta(\\mathbf{x}, t)$，使得总温度场为 $T(\\mathbf{x}, t) = T_s + \\theta(\\mathbf{x}, t)$，其中 $|\\theta|$ 很小。\n\n我们将此扰动场代入控制方程。方程左侧变为：\n$$\n\\rho c \\,\\frac{\\partial}{\\partial t}(T_s + \\theta) = \\rho c \\,\\frac{\\partial \\theta}{\\partial t}\n$$\n方程右侧的项是非线性的，必须对 $\\theta$ 展开到一阶。生热项 $Q(T)$ 用其在 $T_s$ 附近的泰勒展开来近似：\n$$\nQ(T) = Q(T_s + \\theta) \\approx Q(T_s) + \\left.\\frac{dQ}{dT}\\right|_{T_s} \\theta + \\mathcal{O}(\\theta^2)\n$$\n鉴于 $Q(T_s)=0$ 且 $\\alpha = \\left.\\frac{dQ}{dT}\\right|_{T_s}$，这可简化为：\n$$\nQ(T) \\approx \\alpha \\theta\n$$\n接下来，我们分析散度项 $\\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big)$。我们有 $\\nabla T = \\nabla(T_s + \\theta) = \\nabla \\theta$。导热张量 $\\mathbf{K}(T)$ 也在 $T_s$ 附近展开：\n$$\n\\mathbf{K}(T) = \\mathbf{K}(T_s + \\theta) \\approx \\mathbf{K}(T_s) + \\left.\\frac{d\\mathbf{K}}{dT}\\right|_{T_s} \\theta + \\mathcal{O}(\\theta^2)\n$$\n我们记 $\\mathbf{K}_s = \\mathbf{K}(T_s)$ 和 $\\mathbf{K}'_s = \\left.\\frac{d\\mathbf{K}}{dT}\\right|_{T_s}$。热通量矢量变为：\n$$\n\\mathbf{K}(T)\\,\\nabla T \\approx (\\mathbf{K}_s + \\mathbf{K}'_s \\theta) \\nabla\\theta = \\mathbf{K}_s \\nabla\\theta + \\mathbf{K}'_s \\theta \\nabla\\theta\n$$\n项 $\\mathbf{K}'_s \\theta \\nabla\\theta$ 是扰动 $\\theta$ 及其导数的二阶项，因此在线性分析中被忽略。线性化热通量为 $\\mathbf{K}_s \\nabla\\theta$。此通量的散度是：\n$$\n\\nabla \\cdot (\\mathbf{K}_s \\nabla\\theta)\n$$\n由于 $T_s$ 是一个常数，$\\mathbf{K}_s = \\mathrm{diag}\\big(k_x(T_s),k_y(T_s),k_z(T_s)\\big)$ 的分量在空间上是常数。令 $k_{xs} = k_x(T_s)$，$k_{ys} = k_y(T_s)$ 和 $k_{zs} = k_z(T_s)$。散度项变为：\n$$\n\\nabla \\cdot (\\mathbf{K}_s \\nabla\\theta) = \\frac{\\partial}{\\partial x}\\left(k_{xs}\\frac{\\partial\\theta}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(k_{ys}\\frac{\\partial\\theta}{\\partial y}\\right) + \\frac{\\partial}{\\partial z}\\left(k_{zs}\\frac{\\partial\\theta}{\\partial z}\\right) = k_{xs}\\frac{\\partial^2\\theta}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\theta}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\theta}{\\partial z^2}\n$$\n结合所有线性化项，我们得到扰动 $\\theta$ 的演化方程：\n$$\n\\rho c \\,\\frac{\\partial \\theta}{\\partial t} = k_{xs}\\frac{\\partial^2\\theta}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\theta}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\theta}{\\partial z^2} + \\alpha\\theta\n$$\n边界条件是 $T=T_s$ on $\\partial\\Omega$。对于扰动，这转化为齐次狄利克雷边界条件：$\\theta(\\mathbf{x}, t) = 0$ 对于 $\\mathbf{x} \\in \\partial\\Omega$。\n\n为求解这个线性偏微分方程，我们使用变量分离法。我们寻求形式为 $\\theta(\\mathbf{x}, t) = e^{\\sigma t} \\phi(\\mathbf{x})$ 的解，其中 $\\sigma$ 是时间增长率。将此代入方程得到：\n$$\n\\rho c \\sigma \\phi = k_{xs}\\frac{\\partial^2\\phi}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\phi}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\phi}{\\partial z^2} + \\alpha\\phi\n$$\n这可以重排为关于空间函数 $\\phi(\\mathbf{x})$ 的特征值问题：\n$$\n- \\left( k_{xs}\\frac{\\partial^2}{\\partial x^2} + k_{ys}\\frac{\\partial^2}{\\partial y^2} + k_{zs}\\frac{\\partial^2}{\\partial z^2} \\right) \\phi = (\\alpha - \\rho c \\sigma) \\phi\n$$\n左边的算子是自伴椭圆算子。对于具有齐次狄利克雷边界条件的矩形域 $\\Omega = (0,L_x)\\times(0,L_y)\\times(0,L_z)$，其特征函数 $\\phi$ 和相应的特征值是众所周知的。特征函数为：\n$$\n\\phi_{lmn}(x,y,z) = \\sin\\left(\\frac{l\\pi x}{L_x}\\right) \\sin\\left(\\frac{m\\pi y}{L_y}\\right) \\sin\\left(\\frac{n\\pi z}{L_z}\\right)\n$$\n其中 $l, m, n$ 是正整数 ($1, 2, 3, \\ldots$ )。\n将空间算子应用于特征函数 $\\phi_{lmn}$ 得到：\n$$\n- \\left( k_{xs}\\frac{\\partial^2\\phi_{lmn}}{\\partial x^2} + \\dots \\right) = \\left[ k_{xs}\\left(\\frac{l\\pi}{L_x}\\right)^2 + k_{ys}\\left(\\frac{m\\pi}{L_y}\\right)^2 + k_{zs}\\left(\\frac{n\\pi}{L_z}\\right)^2 \\right] \\phi_{lmn}\n$$\n因此，对于每个模式 $(l,m,n)$，我们有以下关系：\n$$\n\\pi^2 \\left( \\frac{k_{xs} l^2}{L_x^2} + \\frac{k_{ys} m^2}{L_y^2} + \\frac{k_{zs} n^2}{L_z^2} \\right) = \\alpha - \\rho c \\sigma_{lmn}\n$$\n因此，模式 $(l,m,n)$ 的增长率为：\n$$\n\\sigma_{lmn} = \\frac{1}{\\rho c} \\left[ \\alpha - \\pi^2 \\left( \\frac{k_{xs} l^2}{L_x^2} + \\frac{k_{ys} m^2}{L_y^2} + \\frac{k_{zs} n^2}{L_z^2} \\right) \\right]\n$$\n如果任何扰动模式能够指数增长，即对于至少一组整数 $(l,m,n)$ 有 $\\sigma_{lmn} > 0$，则均匀状态 $T_s$ 变得不稳定。系统的稳定性由最不稳定的模式决定，也就是增长率最大的模式 $\\sigma_{\\max}$。为了最大化 $\\sigma_{lmn}$，我们必须最小化从 $\\alpha$ 中减去的正定项。这在模式数取最小可能值时发生，即 $l=1$, $m=1$, 和 $n=1$。这对应于基模，即具有最大空间波长的扰动。\n\n最大增长率为：\n$$\n\\sigma_{\\max} = \\sigma_{111} = \\frac{1}{\\rho c} \\left[ \\alpha - \\pi^2 \\left( \\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} \\right) \\right]\n$$\n从稳定 ($\\sigma_{\\max}  0$) 到不稳定 ($\\sigma_{\\max} > 0$) 的转变发生在临界点 $\\sigma_{\\max} = 0$。此阈值处的 $\\alpha$ 值即为临界值 $\\alpha_c$：\n$$\n\\alpha_c = \\pi^2 \\left( \\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} \\right)\n$$\n这是热失控发生的判据。它表明，当生热率对温度的敏感度 $\\alpha$ 变得足够大，以克服由导热系数和几何参数所代表的热扩散的稳定作用时，不稳定性就会发生。\n\n现在，我们根据给定的数值计算 $\\alpha_c$：\n$L_x = 0.02\\ \\mathrm{m}$，$L_y = 0.01\\ \\mathrm{m}$，$L_z = 0.005\\ \\mathrm{m}$。\n$k_{xs} = 140\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，$k_{ys} = 70\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，$k_{zs} = 35\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n\n首先，我们计算括号内的项。每一项的单位是 $(\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}) / \\mathrm{m}^2 = \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$，这对于 $\\alpha$ 是正确的。\n$$\n\\frac{k_{xs}}{L_x^2} = \\frac{140}{(0.02)^2} = \\frac{140}{0.0004} = 350000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n$$\n\\frac{k_{ys}}{L_y^2} = \\frac{70}{(0.01)^2} = \\frac{70}{0.0001} = 700000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n$$\n\\frac{k_{zs}}{L_z^2} = \\frac{35}{(0.005)^2} = \\frac{35}{0.000025} = 1400000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n将这些贡献相加：\n$$\n\\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} = 350000 + 700000 + 1400000 = 2450000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n最后，我们乘以 $\\pi^2$：\n$$\n\\alpha_c = \\pi^2 \\times 2450000 \\approx 9.8696044 \\times 2450000 \\approx 24180530.78\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\alpha_c \\approx 2.418 \\times 10^7\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$",
            "answer": "$$\\boxed{2.418 \\times 10^7}$$"
        },
        {
            "introduction": "将复杂的物理模型转化为可计算的数值算法，是计算热工学的核心任务。本练习将指导你完成有限元方法 (FEM) 中最关键的步骤：针对包含温度依赖性和各向异性的稳态导热问题，推导单元残差向量和雅可比矩阵。掌握如何从控制方程出发进行牛顿法线性化，是理解并开发高级热仿真软件的基础，也能让你更深刻地认识商业软件的内部工作原理 。",
            "id": "3997964",
            "problem": "您的任务是在有限元法 (FEM) 框架内，为具有各向异性且依赖于温度的热导率的稳态热传导问题，推导、形式化并实现一个计算单元例程。从能量守恒基本定律出发，推导至伽辽金弱形式，然后推导离散残差和雅可比矩阵的牛顿线性化。最后，针对一个给定的、依赖于温度的对称热导率张量，为单个二维线性三角形单元实现最终的单元级公式，并报告所提供测试套件的可量化指标。\n\n从经过充分检验的连续介质稳态能量守恒定律开始：\n$$\\nabla \\cdot \\left(\\mathbf{q}_{\\text{cond}}\\right) + s = 0$$\n其中，传导热通量满足各向异性介质的傅里叶定律\n$$\\mathbf{q}_{\\text{cond}} = -\\mathbf{K}(T)\\,\\nabla T,$$\n式中，$T$ 是温度场，$\\mathbf{K}(T)$ 是一个依赖于 $T$ 的对称正定 (SPD) 二阶张量，$s$ 是一个体积热源。因此，控制偏微分方程 (PDE) 为\n$$\\nabla \\cdot \\left(\\mathbf{K}(T)\\,\\nabla T\\right) + s = 0 \\quad \\text{in } \\Omega,$$\n并带有适当的狄利克雷边界条件 $T = \\bar{T}$ on $\\Gamma_D$ 和诺伊曼边界条件 $\\mathbf{n} \\cdot \\left(\\mathbf{K}(T)\\,\\nabla T\\right) = h$ on $\\Gamma_N$，其中 $\\Omega$ 是域，$\\Gamma_D$ 和 $\\Gamma_N$ 是不相交的边界子集，$\\mathbf{n}$ 是外单位法向量。\n\n任务 1 (推导)：使用伽辽金法，通过将 PDE 乘以一个测试函数 $w$ 并在 $\\Omega$ 上积分来推导弱形式。应用散度定理将导数从通量项上移开，并清晰地标识出在 $\\Gamma_N$ 上涉及 $h$ 的自然边界项。然后，选择与试探形函数相等的权函数（伽辽金选择），并用单元形函数 $N_i$、它们的梯度 $\\nabla N_i$、张量 $\\mathbf{K}(T)$ 和源 $s$ 来写出单元残差向量 $\\mathbf{R}_e(\\mathbf{T}_e)$。不要预先假设 $\\mathbf{R}_e$ 或其雅可比矩阵的任何特定公式；从第一性原理推导它们。\n\n任务 2 (牛顿线性化)：考虑将牛顿-拉夫逊法 (NR法) 应用于非线性代数系统 $\\mathbf{R}(\\mathbf{T})=\\mathbf{0}$。通过在当前迭代值 $\\mathbf{T}_e^{(k)}$ 周围对残差进行线性化，推导单元雅可比矩阵 $\\mathbf{J}_e = \\dfrac{\\partial \\mathbf{R}_e}{\\partial \\mathbf{T}_e}$。证明雅可比矩阵由一个热导率项和一个由 $\\mathbf{K}(T)$ 的温度依赖性产生的项组成，并仅使用基本运算和定义明确写出表达式。将您的表达式特化到 $\\mathbf{K}(T)$ 是温度的线性函数的情况：\n$$\\mathbf{K}(T) = \\mathbf{K}_0 + \\mathbf{K}_1\\,T,$$\n其中 $\\mathbf{K}_0$ 和 $\\mathbf{K}_1$ 是常数对称矩阵，因此 $\\dfrac{\\partial \\mathbf{K}}{\\partial T} = \\mathbf{K}_1$。\n\n任务 3 (单个线性三角形的实现)：实现一个完整且可运行的程序，对于一个二维单位厚度的单个线性三角形单元，使用上述温度线性相关的热导率模型，在形心处采用单点求积法计算单元残差向量和单元雅可比矩阵。使用线性形函数的常数梯度，并在形心温度 $T_c$ 处评估热导率。使用从您的推导中提炼出的以下表达式：\n- 设单元节点位于坐标 $(x_i,y_i)$，$i=1,2,3$，具有线性形函数 $N_i$ 和常数梯度 $\\nabla N_i$。设单元面积为 $A$，体积为 $V = A \\times b$，厚度 $b=1$。\n- 形心位于 $\\left(\\dfrac{x_1+x_2+x_3}{3}, \\dfrac{y_1+y_2+y_3}{3}\\right)$，对于线性三角形，在形心处求值的 $N_i$ 为 $N_i(x_c,y_c) = \\dfrac{1}{3}$，温度梯度为 $\\nabla T = \\sum_{j=1}^{3} T_j\\,\\nabla N_j$。\n- 评估 $\\mathbf{K}(T_c) = \\mathbf{K}_0 + \\mathbf{K}_1 T_c$，其中 $T_c = \\dfrac{T_1+T_2+T_3}{3}$ 且 $\\dfrac{\\partial \\mathbf{K}}{\\partial T} = \\mathbf{K}_1$。\n- 单元残差项为\n$$R_i = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left(\\mathbf{K}(T)\\,\\nabla T\\right)\\,d\\Omega \\;-\\; \\int_{\\Omega_e} N_i\\,s\\,d\\Omega \\;-\\; \\int_{\\Gamma_{N,e}} N_i\\,h\\,d\\Gamma,$$\n在单点形心求积且单元内无诺伊曼边界的情况下，简化为\n$$R_i \\approx \\left[\\,\\nabla N_i \\cdot \\left(\\mathbf{K}(T_c)\\,\\nabla T\\right) - \\dfrac{s}{3}\\,\\right]\\,V.$$\n- 单元雅可比矩阵项为\n$$J_{ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left(\\mathbf{K}(T)\\,\\nabla N_j\\right)\\,d\\Omega \\;+\\; \\int_{\\Omega_e} \\nabla N_i \\cdot \\left(\\dfrac{\\partial \\mathbf{K}}{\\partial T}\\,N_j\\,\\nabla T\\right)\\,d\\Omega,$$\n在单点形心求积下变为\n$$J_{ij} \\approx \\left[\\,\\nabla N_i \\cdot \\left(\\mathbf{K}(T_c)\\,\\nabla N_j\\right) \\;+\\; \\nabla N_i \\cdot \\left(\\mathbf{K}_1\\,\\nabla T\\right)\\,\\dfrac{1}{3}\\,\\right]\\,V.$$\n\n单位：\n- 热导率张量项使用 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 源 $s$ 使用 $\\mathrm{W}\\,\\mathrm{m}^{-3}$。\n- 坐标 $(x,y)$ 使用 $\\mathrm{m}$。\n- 温度 $T$ 使用 $\\mathrm{K}$。\n- 残差向量项使用 $\\mathrm{W}$。\n- 雅可比矩阵项使用 $\\mathrm{W}\\,\\mathrm{K}^{-1}$。\n\n角度单位不适用。所有数值结果必须以小数形式提供。\n\n测试套件：\n对于所有情况，使用一个单位厚度 $b=1$ 且单元内无诺伊曼边界的单个三角形单元。每个情况使用常数源 $s$，并定义 $\\mathbf{K}(T) = \\mathbf{K}_0 + \\mathbf{K}_1\\,T$，其中 $\\mathbf{K}_0$、$\\mathbf{K}_1$ 为对称矩阵。\n\n- 情况 A (一般各向异性，非零温度依赖性；正常路径)：\n  - 节点坐标：$(x_1,y_1)=(0,0)$，$(x_2,y_2)=(0.02,0)$，$(x_3,y_3)=(0,0.01)$，单位 $\\mathrm{m}$。\n  - 节点温度迭代值：$(T_1,T_2,T_3)=(300,310,305)$，单位 $\\mathrm{K}$。\n  - 源：$s=1.0\\times 10^5$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-3}$。\n  - $\\mathbf{K}_0=\\begin{bmatrix}10  2 \\\\ 2  5\\end{bmatrix}$，$\\mathbf{K}_1=\\begin{bmatrix}0.01  0.005 \\\\ 0.005  0.02\\end{bmatrix}$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n\n- 情况 B (各向同性恒定热导率；零温度依赖性的类边界条件边缘情况)：\n  - 节点坐标：$(x_1,y_1)=(0,0)$，$(x_2,y_2)=(0.03,0)$，$(x_3,y_3)=(0,0.03)$，单位 $\\mathrm{m}$。\n  - 节点温度迭代值：$(T_1,T_2,T_3)=(300,300,300)$，单位 $\\mathrm{K}$。\n  - 源：$s=5.0\\times 10^4$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-3}$。\n  - $\\mathbf{K}_0=\\begin{bmatrix}15  0 \\\\ 0  15\\end{bmatrix}$，$\\mathbf{K}_1=\\begin{bmatrix}0  0 \\\\ 0  0\\end{bmatrix}$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n\n- 情况 C (具有负非对角线元素的强各向异性，仍为对称正定 (SPD)；无源；测试鲁棒性)：\n  - 节点坐标：$(x_1,y_1)=(0,0)$，$(x_2,y_2)=(0.01,0.02)$，$(x_3,y_3)=(0.03,0.005)$，单位 $\\mathrm{m}$。\n  - 节点温度迭代值：$(T_1,T_2,T_3)=(600,550,500)$，单位 $\\mathrm{K}$。\n  - 源：$s=0$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-3}$。\n  - $\\mathbf{K}_0=\\begin{bmatrix}30  -5 \\\\ -5  8\\end{bmatrix}$，$\\mathbf{K}_1=\\begin{bmatrix}0.03  0.002 \\\\ 0.002  0.015\\end{bmatrix}$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n\n要求输出：\n对于每种情况，计算：\n- 单元残差向量的欧几里得范数 $\\|\\mathbf{R}_e\\|_2$，单位 $\\mathrm{W}$。\n- 单元雅可比矩阵对称部分的最小特征值 $\\lambda_{\\min}\\left(\\dfrac{\\mathbf{J}_e+\\mathbf{J}_e^\\top}{2}\\right)$，单位 $\\mathrm{W}\\,\\mathrm{K}^{-1}$。\n- 雅可比矩阵反对称部分的弗罗贝尼乌斯范数 $\\left\\|\\mathbf{J}_e-\\mathbf{J}_e^\\top\\right\\|_F$，作为对称性偏差度量，单位 $\\mathrm{W}\\,\\mathrm{K}^{-1}$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果。该列表必须按以下顺序包含九个十进制数\n$$[\\|\\mathbf{R}_e\\|_2^{(A)},\\lambda_{\\min}^{(A)},\\text{symdev}^{(A)},\\|\\mathbf{R}_e\\|_2^{(B)},\\lambda_{\\min}^{(B)},\\text{symdev}^{(B)},\\|\\mathbf{R}_e\\|_2^{(C)},\\lambda_{\\min}^{(C)},\\text{symdev}^{(C)}],$$\n其中上标 $(A)$、$(B)$、$(C)$ 表示不同情况。每个数用国际单位制基本单位表示，并以保留六位小数的小数形式打印。",
            "solution": "本任务是为一个具有依赖于温度的各向异性热导率的二维线性三角形有限元，推导并实现其稳态热传导的单元残差向量和雅可比矩阵。推导从控制偏微分方程出发，经过伽辽金弱形式及其牛顿-拉夫逊线性化，最终使用单点求积法完成实现。\n\n### 任务 1：弱形式与单元残差推导\n\n在域 $\\Omega$ 内的稳态热传导的控制偏微分方程 (PDE) 由能量守恒定律给出：\n$$ \\nabla \\cdot (\\mathbf{q}_{\\text{cond}}) + s = 0 $$\n其中，$s$ 是体积热源，$\\mathbf{q}_{\\text{cond}}$ 是传导热通量。对于具有依赖于温度的热导率的各向异性材料，热通量由傅里叶定律描述：\n$$ \\mathbf{q}_{\\text{cond}} = -\\mathbf{K}(T)\\,\\nabla T $$\n这里，$T$ 是温度场，$\\mathbf{K}(T)$ 是二阶对称正定 (SPD) 热导率张量。将两者结合得到控制 PDE：\n$$ -\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T) + s = 0 $$\n注意：问题陈述将 PDE 写为 $\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T) + s = 0$。这对应于热通量或源项的不同符号约定。遵循问题的表述，我们从 $\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T) + s = 0$ 开始。\n\n为了使用伽辽金法推导弱形式，我们将 PDE 乘以一个测试（或权）函数 $w$，并在单个单元的域 $\\Omega_e$ 上积分：\n$$ \\int_{\\Omega_e} w \\left( \\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T) + s \\right) d\\Omega = 0 $$\n我们对第一项 $\\int_{\\Omega_e} w (\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T)) d\\Omega$ 应用散度定理（分部积分）。标量乘以矢量场的散度向量恒等式为 $\\nabla \\cdot (w \\mathbf{F}) = (\\nabla w) \\cdot \\mathbf{F} + w(\\nabla \\cdot \\mathbf{F})$。令 $\\mathbf{F} = \\mathbf{K}(T)\\,\\nabla T$，我们有：\n$$ w(\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T)) = \\nabla \\cdot (w \\mathbf{K}(T)\\,\\nabla T) - (\\nabla w) \\cdot (\\mathbf{K}(T)\\,\\nabla T) $$\n在 $\\Omega_e$ 上积分并对右侧第一项应用散度定理，$\\int_{\\Omega_e} \\nabla \\cdot (w \\mathbf{K}(T)\\,\\nabla T) d\\Omega = \\int_{\\Gamma_e} w (\\mathbf{K}(T)\\,\\nabla T) \\cdot \\mathbf{n} \\,d\\Gamma$，其中 $\\Gamma_e$ 是单元的边界，$\\mathbf{n}$ 是外单位法向量。\n将此代回加权积分方程，得到：\n$$ \\int_{\\Omega_e} \\left( -(\\nabla w) \\cdot (\\mathbf{K}(T)\\,\\nabla T) + w s \\right) d\\Omega + \\int_{\\Gamma_e} w (\\mathbf{K}(T)\\,\\nabla T) \\cdot \\mathbf{n} \\,d\\Gamma = 0 $$\n诺伊曼边界条件在边界的一部分 $\\Gamma_{N,e}$ 上给出为 $\\mathbf{n} \\cdot (\\mathbf{K}(T)\\,\\nabla T) = h$。这个 $h$ 项表示垂直于边界的指定热通量分量。方程变为：\n$$ \\int_{\\Omega_e} (\\nabla w) \\cdot (\\mathbf{K}(T)\\,\\nabla T) \\,d\\Omega - \\int_{\\Omega_e} ws \\,d\\Omega - \\int_{\\Gamma_{N,e}} wh \\,d\\Gamma = 0 $$\n此方程必须对所有容许的测试函数 $w$ 成立。在伽辽金法中，我们使用形函数 $N_j(x,y)$ 和节点温度 $T_j$ 来近似单元内的温度场 $T$：\n$$ T(x,y) \\approx T^h(x,y) = \\sum_{j=1}^{n_{\\text{nodes}}} N_j(x,y) T_j $$\n测试函数 $w$ 从相同的基中选取，即对单元的每个节点 $i$，取 $w = N_i$。这产生一个非线性代数方程组。单元 $e$ 的节点 $i$ 的残差 $R_{e,i}$ 是为使方程满足而必须为零的表达式：\n$$ R_{e,i}(\\mathbf{T}_e) = \\int_{\\Omega_e} \\nabla N_i \\cdot (\\mathbf{K}(T^h)\\,\\nabla T^h) \\,d\\Omega - \\int_{\\Omega_e} N_i s \\,d\\Omega - \\int_{\\Gamma_{N,e}} N_i h \\,d\\Gamma $$\n这与问题陈述中提供的积分形式相匹配。全局残差向量 $\\mathbf{R}(\\mathbf{T})$ 是通过在整个网格上组装这些单元残差形成的。\n\n### 任务 2：牛顿线性化与单元雅可比推导\n\n由于 $\\mathbf{K}$ 对 $T$ 的依赖性，方程组 $\\mathbf{R}(\\mathbf{T}) = \\mathbf{0}$ 是非线性的。我们使用牛顿-拉夫逊法来求解它。从一个估计值 $\\mathbf{T}^{(k)}$ 开始，我们通过求解线性系统来找到更新量 $\\Delta \\mathbf{T}^{(k+1)}$：\n$$ \\mathbf{J}(\\mathbf{T}^{(k)}) \\Delta \\mathbf{T}^{(k+1)} = -\\mathbf{R}(\\mathbf{T}^{(k)}) $$\n其中 $\\mathbf{J}$ 是雅可比矩阵，定义为 $J_{ij} = \\dfrac{\\partial R_i}{\\partial T_j}$。我们通过对单元残差 $R_{e,i}$ 关于节点温度 $T_j$ 求导来推导单元雅可比矩阵 $\\mathbf{J}_e$。假设源 $s$ 和边界通量 $h$ 与温度无关，我们只需对 $R_{e,i}$ 的第一项求导：\n$$ J_{e,ij} = \\frac{\\partial R_{e,i}}{\\partial T_j} = \\frac{\\partial}{\\partial T_j} \\int_{\\Omega_e} \\nabla N_i \\cdot (\\mathbf{K}(T^h)\\,\\nabla T^h) \\,d\\Omega $$\n将导数移到积分内部（因为域是固定的）：\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\frac{\\partial}{\\partial T_j} \\left(\\mathbf{K}(T^h)\\,\\nabla T^h\\right) \\,d\\Omega $$\n使用微分的乘积法则：\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left( \\frac{\\partial \\mathbf{K}(T^h)}{\\partial T_j} \\nabla T^h + \\mathbf{K}(T^h) \\frac{\\partial \\nabla T^h}{\\partial T_j} \\right) d\\Omega $$\n我们计算近似场的导数：\n$$ \\frac{\\partial \\nabla T^h}{\\partial T_j} = \\frac{\\partial}{\\partial T_j} \\left( \\sum_{k=1}^{n_{\\text{nodes}}} T_k \\nabla N_k \\right) = \\nabla N_j $$\n$$ \\frac{\\partial \\mathbf{K}(T^h)}{\\partial T_j} = \\frac{d\\mathbf{K}}{dT} \\frac{\\partial T^h}{\\partial T_j} = \\frac{d\\mathbf{K}}{dT} \\frac{\\partial}{\\partial T_j} \\left( \\sum_{k=1}^{n_{\\text{nodes}}} N_k T_k \\right) = \\frac{d\\mathbf{K}}{dT} N_j $$\n将这些代回 $J_{e,ij}$ 的表达式中：\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left( \\mathbf{K}(T^h) \\nabla N_j + \\frac{d\\mathbf{K}}{dT} N_j \\nabla T^h \\right) d\\Omega $$\n整理后得到单元雅可比矩阵项的最终形式：\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot (\\mathbf{K}(T^h) \\nabla N_j) \\,d\\Omega + \\int_{\\Omega_e} \\nabla N_i \\cdot \\left( \\frac{d\\mathbf{K}}{dT} N_j \\nabla T^h \\right) \\,d\\Omega $$\n对于给定的线性依赖关系 $\\mathbf{K}(T) = \\mathbf{K}_0 + \\mathbf{K}_1 T$，导数就是 $\\dfrac{d\\mathbf{K}}{dT} = \\mathbf{K}_1$。\n\n### 任务 3：线性三角形的实现\n\n对于二维线性三角形单元，形函数 $N_i$ 是坐标的线性函数，因此它们的梯度 $\\nabla N_i$ 是常数向量。设节点坐标为 $(x_1, y_1), (x_2, y_2), (x_3, y_3)$。三角形的面积 $A$ 为：\n$$ A = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)| $$\n梯度向量被收集在矩阵 $\\mathbf{B}$ 中：\n$$ \\nabla N_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix}, \\quad \\mathbf{B} = [\\nabla N_1, \\nabla N_2, \\nabla N_3] = \\frac{1}{2A} \\begin{bmatrix} y_2-y_3  y_3-y_1  y_1-y_2 \\\\ x_3-x_2  x_1-x_3  x_2-x_1 \\end{bmatrix} $$\n我们使用单元形心处的单点求积法。对于体积为 $V = A \\times b$（其中 $b$ 是厚度）的单元，积分近似为 $\\int_{\\Omega_e} f d\\Omega \\approx f(\\mathbf{x}_c) V$。\n在线性三角形的形心处，对所有 $i$ 都有 $N_i(\\mathbf{x}_c) = 1/3$。形心处的温度为 $T_c = \\sum N_i(\\mathbf{x}_c) T_i = \\frac{1}{3}\\sum T_i$。温度梯度在整个单元上是常数：$\\nabla T^h = \\sum T_j \\nabla N_j = \\mathbf{B} \\mathbf{T}_e$。\n\n将单点求积应用于残差（假设没有诺伊曼面，$h=0$）：\n$$ R_{e,i} \\approx \\left[ \\nabla N_i \\cdot (\\mathbf{K}(T_c)\\,\\nabla T^h) - N_i(\\mathbf{x}_c) s \\right] V = \\left[ (\\nabla N_i) \\cdot (\\mathbf{K}(T_c) \\nabla T^h) - \\frac{s}{3} \\right] V $$\n将其应用于雅可比矩阵：\n$$ J_{e,ij} \\approx \\left[ \\nabla N_i \\cdot (\\mathbf{K}(T_c)\\,\\nabla N_j) + \\nabla N_i \\cdot \\left(\\frac{d\\mathbf{K}}{dT}(T_c) N_j(\\mathbf{x}_c) \\nabla T^h\\right) \\right] V $$\n其中 $\\frac{d\\mathbf{K}}{dT} = \\mathbf{K}_1$ 且 $N_j(\\mathbf{x}_c) = 1/3$：\n$$ J_{e,ij} \\approx \\left[ (\\nabla N_i) \\cdot (\\mathbf{K}(T_c) \\nabla N_j) + \\frac{1}{3} (\\nabla N_i) \\cdot (\\mathbf{K}_1 \\nabla T^h) \\right] V $$\n如果 $\\mathbf{K}(T_c)$ 是对称的，则雅可比矩阵的第一项是对称的。第二项 $\\frac{V}{3} (\\nabla N_i) \\cdot (\\mathbf{K}_1 \\nabla T^h)$，在索引 $i, j$ 上通常不是对称的，因为它依赖于 $\\nabla N_i$ 而不是 $\\nabla N_j$。该项导致完整的雅可比矩阵 $\\mathbf{J}_e$ 成为非对称的。\n\n计算步骤包括：\n1.  计算单元面积 $A$、体积 $V$ 和梯度矩阵 $\\mathbf{B}$。\n2.  计算形心温度 $T_c$ 和热导率张量 $\\mathbf{K}(T_c)$。\n3.  计算温度梯度向量 $\\nabla T^h = \\mathbf{B} \\mathbf{T}_e$。\n4.  遍历节点 $i=1,2,3$ 计算残差向量 $\\mathbf{R}_e$。\n5.  遍历节点 $i,j=1,2,3$ 计算雅可比矩阵 $\\mathbf{J}_e$。\n6.  计算所需的指标：$\\|\\mathbf{R}_e\\|_2$、$\\lambda_{\\min}\\left(\\frac{\\mathbf{J}_e+\\mathbf{J}_e^\\top}{2}\\right)$ 和 $\\|\\mathbf{J}_e - \\mathbf{J}_e^\\top\\|_F$。\n这些步骤在提供的 Python 代码中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_element_routine(nodes, temps, s, K0, K1, b=1.0):\n    \"\"\"\n    Computes the element residual and Jacobian for a 2D linear triangular element.\n\n    Args:\n        nodes (list of tuples): Node coordinates [(x1,y1), (x2,y2), (x3,y3)].\n        temps (list or np.array): Nodal temperatures [T1, T2, T3].\n        s (float): Volumetric heat source.\n        K0 (np.array): Constant part of the conductivity tensor (2x2).\n        K1 (np.array): Temperature-dependent part of the conductivity tensor (2x2).\n        b (float): Element thickness.\n\n    Returns:\n        tuple: A tuple containing:\n            - norm_Re (float): Euclidean norm of the residual vector.\n            - lambda_min (float): Smallest eigenvalue of the symmetric part of the Jacobian.\n            - sym_dev (float): Frobenius norm of the antisymmetric part of the Jacobian.\n    \"\"\"\n    (x1, y1), (x2, y2), (x3, y3) = nodes\n    T_e = np.array(temps)\n\n    # 1. Geometric properties\n    A = 0.5 * abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n    V = A * b\n\n    # 2. Shape function gradients (B matrix)\n    # B = [gradN1, gradN2, gradN3]\n    B_mat = (1 / (2 * A)) * np.array([\n        [y2 - y3, y3 - y1, y1 - y2],\n        [x3 - x2, x1 - x3, x2 - x1]\n    ])\n\n    # 3. Centroid temperature and conductivity\n    Tc = np.mean(T_e)\n    K_Tc = K0 + K1 * Tc\n    \n    # 4. Temperature gradient (constant over the element)\n    grad_T = B_mat @ T_e  # Shape (2,)\n\n    # 5. Compute Residual Vector R_e\n    R_e = np.zeros(3)\n    for i in range(3):\n        grad_Ni = B_mat[:, i] # Shape (2,)\n        # term1 = grad_Ni^T * K_Tc * grad_T\n        term1 = grad_Ni.T @ K_Tc @ grad_T\n        term2 = s / 3.0\n        R_e[i] = (term1 - term2) * V\n\n    # 6. Compute Jacobian Matrix J_e\n    J_e = np.zeros((3, 3))\n    # Pre-calculate the second part's vector for efficiency\n    # K1 * grad_T\n    vec_for_term2 = K1 @ grad_T # Shape (2,)\n    for i in range(3):\n        grad_Ni = B_mat[:, i]\n        for j in range(3):\n            grad_Nj = B_mat[:, j]\n            \n            # term1 = grad_Ni^T * K_Tc * grad_Nj\n            term1 = grad_Ni.T @ K_Tc @ grad_Nj\n            \n            # term2 = grad_Ni^T * (K1 * grad_T) * (1/3)\n            term2 = grad_Ni.T @ vec_for_term2 / 3.0\n\n            J_e[i, j] = (term1 + term2) * V\n\n    # 7. Compute required metrics\n    norm_Re = np.linalg.norm(R_e, 2)\n    \n    J_sym = 0.5 * (J_e + J_e.T)\n    # Using eigvalsh for symmetric matrices for numerical stability and efficiency\n    eigvals_sym = np.linalg.eigvalsh(J_sym)\n    lambda_min = np.min(eigvals_sym)\n\n    J_asym = J_e - J_e.T\n    sym_dev = np.linalg.norm(J_asym, 'fro')\n\n    return norm_Re, lambda_min, sym_dev\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {\n            \"nodes\": [(0, 0), (0.02, 0), (0, 0.01)],\n            \"temps\": [300, 310, 305],\n            \"s\": 1.0e5,\n            \"K0\": np.array([[10, 2], [2, 5]]),\n            \"K1\": np.array([[0.01, 0.005], [0.005, 0.02]])\n        },\n        # Case B\n        {\n            \"nodes\": [(0, 0), (0.03, 0), (0, 0.03)],\n            \"temps\": [300, 300, 300],\n            \"s\": 5.0e4,\n            \"K0\": np.array([[15, 0], [0, 15]]),\n            \"K1\": np.array([[0, 0], [0, 0]])\n        },\n        # Case C\n        {\n            \"nodes\": [(0, 0), (0.01, 0.02), (0.03, 0.005)],\n            \"temps\": [600, 550, 500],\n            \"s\": 0.0,\n            \"K0\": np.array([[30, -5], [-5, 8]]),\n            \"K1\": np.array([[0.03, 0.002], [0.002, 0.015]])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        norm_Re, lambda_min, sym_dev = compute_element_routine(**case)\n        results.extend([norm_Re, lambda_min, sym_dev])\n\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}