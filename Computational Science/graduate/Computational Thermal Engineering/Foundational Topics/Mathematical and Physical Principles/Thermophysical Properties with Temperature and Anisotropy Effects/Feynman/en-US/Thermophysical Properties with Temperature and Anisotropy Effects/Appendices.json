{
    "hands_on_practices": [
        {
            "introduction": "An anisotropic conductivity tensor is best understood through its principal values and directions, which define the material's natural axes for heat flow. This exercise  provides foundational practice in computing these quantities from a temperature-dependent conductivity tensor. Mastering this allows you to reorient complex problems into a simpler, physically intuitive framework.",
            "id": "3997961",
            "problem": "Consider steady conduction in an anisotropic solid where the constitutive relation is given by Fourier’s law in tensor form, $\\,\\boldsymbol{q}=-\\boldsymbol{K}(T)\\,\\nabla T\\,$, with $\\boldsymbol{K}(T)$ the second-order thermal conductivity tensor that may depend on temperature $T$. For macroscopically homogeneous media without external fields, reciprocity implies that $\\boldsymbol{K}(T)$ is symmetric and, for physical stability, positive definite. Principal conductivities and principal directions are defined by the spectral properties of $\\boldsymbol{K}(T)$.\n\nA unidirectionally reinforced composite exhibits in-plane coupling due to fiber misalignment, while remaining uncoupled in the thickness direction. Its temperature-dependent conductivity tensor in the laboratory basis $\\{x,y,z\\}$ is modeled as\n$$\n\\boldsymbol{K}(T)=\n\\begin{pmatrix}\nk_{xx}(T) & k_{xy}(T) & 0 \\\\\nk_{xy}(T) & k_{yy}(T) & 0 \\\\\n0 & 0 & k_{zz}(T)\n\\end{pmatrix},\n$$\nwith linear temperature dependence about $T_{0} = 300\\,\\mathrm{K}$,\n$$\nk_{xx}(T)=k_{xx,0}+\\alpha_{xx}\\,(T-T_{0}),\\quad\nk_{yy}(T)=k_{yy,0}+\\alpha_{yy}\\,(T-T_{0}),\\quad\nk_{xy}(T)=k_{xy,0}+\\alpha_{xy}\\,(T-T_{0}),\\quad\nk_{zz}(T)=k_{zz,0}+\\alpha_{zz}\\,(T-T_{0}),\n$$\nwhere $k_{xx,0}=6$, $\\alpha_{xx}=0.03$, $k_{yy,0}=5$, $\\alpha_{yy}=0.03$, $k_{xy,0}=2$, $\\alpha_{xy}=0.02$, $k_{zz,0}=3$, and $\\alpha_{zz}=0.04$, in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ per kelvin for the coefficients $\\alpha$. At $T=330\\,\\mathrm{K}$, evaluate the principal conductivities and the corresponding principal directions by computing the eigenvalues and normalized eigenvectors of $\\boldsymbol{K}(T)$.\n\nStarting from Fourier’s law and the symmetry/positive-definiteness of $\\boldsymbol{K}(T)$, first justify why principal conductivities and directions are obtained from the eigenvalue problem for $\\boldsymbol{K}(T)$. Then compute the eigenvalues and normalized eigenvectors explicitly for the given $\\boldsymbol{K}(T)$ at $T=330\\,\\mathrm{K}$.\n\nExpress the principal conductivities in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ and express the principal directions as direction cosines (dimensionless) with respect to the $\\{x,y,z\\}$ basis. Provide exact analytical forms; do not round. For the final answer, list in order the three principal conductivities followed by the $x$, $y$, and $z$ components of each corresponding normalized eigenvector.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of continuum mechanics and heat transfer, is well-posed, and provides all necessary information for a unique solution.\n\nFirst, we justify the use of an eigenvalue problem to find the principal conductivities and directions. A principal direction of thermal conductivity is a direction, represented by a unit vector $\\boldsymbol{n}$, in which a temperature gradient, $\\nabla T$, produces a heat flux vector, $\\boldsymbol{q}$, that is purely anti-parallel to the gradient. That is, if $\\nabla T$ is aligned with $\\boldsymbol{n}$, then $\\boldsymbol{q}$ is also aligned with $\\boldsymbol{n}$ but in the opposite direction.\n\nLet the temperature gradient be $\\nabla T = G\\boldsymbol{n}$, where $G = |\\nabla T|$ is the magnitude of the gradient. The condition for $\\boldsymbol{n}$ to be a principal direction is that the resulting heat flux is $\\boldsymbol{q} = -k_n G\\boldsymbol{n}$, where $k_n$ is the scalar conductivity in that direction, i.e., the principal conductivity.\n\nSubstituting these into Fourier's law, $\\boldsymbol{q} = -\\boldsymbol{K}(T)\\nabla T$, we get:\n$$ -k_n G\\boldsymbol{n} = -\\boldsymbol{K}(T)(G\\boldsymbol{n}) $$\nSince $G$ is a non-zero scalar, we can divide by $-G$:\n$$ k_n \\boldsymbol{n} = \\boldsymbol{K}(T)\\boldsymbol{n} $$\nRewriting this in the standard form for an eigenvalue problem:\n$$ \\boldsymbol{K}(T)\\boldsymbol{n} = k_n \\boldsymbol{n} $$\nThis equation shows that the principal conductivities, $k_n$, are the eigenvalues of the thermal conductivity tensor $\\boldsymbol{K}(T)$, and the corresponding principal directions are its eigenvectors $\\boldsymbol{n}$. Since the problem states that $\\boldsymbol{K}(T)$ is symmetric and positive definite, the spectral theorem guarantees that it has real, positive eigenvalues (physically necessary conductivities) and a set of three mutually orthogonal eigenvectors (the principal axes of conductivity).\n\nNow, we proceed to compute these quantities for the given problem.\nThe temperature is $T = 330\\,\\mathrm{K}$, and the reference temperature is $T_0 = 300\\,\\mathrm{K}$. The temperature difference is $T - T_0 = 30\\,\\mathrm{K}$.\nWe first evaluate the components of the conductivity tensor $\\boldsymbol{K}$ at $T=330\\,\\mathrm{K}$:\n$k_{xx}(T) = k_{xx,0} + \\alpha_{xx}(T-T_0) = 6 + (0.03)(30) = 6 + 0.9 = 6.9$\n$k_{yy}(T) = k_{yy,0} + \\alpha_{yy}(T-T_0) = 5 + (0.03)(30) = 5 + 0.9 = 5.9$\n$k_{xy}(T) = k_{xy,0} + \\alpha_{xy}(T-T_0) = 2 + (0.02)(30) = 2 + 0.6 = 2.6$\n$k_{zz}(T) = k_{zz,0} + \\alpha_{zz}(T-T_0) = 3 + (0.04)(30) = 3 + 1.2 = 4.2$\n\nAll values are in units of $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$. The conductivity tensor is:\n$$\n\\boldsymbol{K} =\n\\begin{pmatrix}\n6.9 & 2.6 & 0 \\\\\n2.6 & 5.9 & 0 \\\\\n0 & 0 & 4.2\n\\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(\\boldsymbol{K} - \\lambda\\boldsymbol{I}) = 0$:\n$$\n\\det\n\\begin{pmatrix}\n6.9 - \\lambda & 2.6 & 0 \\\\\n2.6 & 5.9 - \\lambda & 0 \\\\\n0 & 0 & 4.2 - \\lambda\n\\end{pmatrix} = 0\n$$\nDue to the block-diagonal structure, this expands to:\n$$ (4.2 - \\lambda) \\left[ (6.9 - \\lambda)(5.9 - \\lambda) - (2.6)^2 \\right] = 0 $$\nOne eigenvalue is immediately apparent: $\\lambda_3 = 4.2$.\n\nThe other two eigenvalues are roots of the quadratic equation from the $2 \\times 2$ sub-block:\n$$ \\lambda^2 - (6.9 + 5.9)\\lambda + (6.9)(5.9) - (2.6)^2 = 0 $$\n$$ \\lambda^2 - 12.8\\lambda + 40.71 - 6.76 = 0 $$\n$$ \\lambda^2 - 12.8\\lambda + 33.95 = 0 $$\nTo maintain precision, we work with fractions: $k_{xx} = \\frac{69}{10}$, $k_{yy} = \\frac{59}{10}$, $k_{xy} = \\frac{26}{10}$. The equation is $\\lambda^2 - \\frac{128}{10}\\lambda + \\frac{3395}{100} = 0$, which is $20\\lambda^2 - 256\\lambda + 679 = 0$.\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$ \\lambda = \\frac{256 \\pm \\sqrt{(-256)^2 - 4(20)(679)}}{2(20)} = \\frac{256 \\pm \\sqrt{65536 - 54320}}{40} = \\frac{256 \\pm \\sqrt{11216}}{40} $$\nThe discriminant can be simplified: $\\sqrt{11216} = \\sqrt{16 \\times 701} = 4\\sqrt{701}$.\n$$ \\lambda = \\frac{256 \\pm 4\\sqrt{701}}{40} = \\frac{64 \\pm \\sqrt{701}}{10} $$\nSo, the other two principal conductivities are $\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$ and $\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$.\n\nThe three principal conductivities are:\n$\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$\n$\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$\n$\\lambda_3 = 4.2 = \\frac{21}{5}$\n\nNext, we find the corresponding normalized eigenvectors (principal directions).\nFor $\\lambda_3 = 4.2$, we solve $(\\boldsymbol{K} - 4.2\\boldsymbol{I})\\boldsymbol{v}_3 = \\boldsymbol{0}$:\n$$\n\\begin{pmatrix}\n2.7 & 2.6 & 0 \\\\\n2.6 & 1.7 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix} v_x \\\\ v_y \\\\ v_z \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe first two rows give a system for $v_x, v_y$ with a non-zero determinant ($(2.7)(1.7) - (2.6)^2 = 4.59 - 6.76 = -2.17$), so $v_x=0$ and $v_y=0$. The third row $0 \\cdot v_z=0$ is satisfied for any $v_z$. We choose $v_z=1$ to get a unit vector.\nThe normalized eigenvector for $\\lambda_3$ is $\\boldsymbol{n}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$.\n\nFor $\\lambda_1$ and $\\lambda_2$, the eigenvectors lie in the $xy$-plane, so $v_z=0$. We solve $(\\boldsymbol{K}_{xy} - \\lambda \\boldsymbol{I})\\boldsymbol{v} = \\boldsymbol{0}$, where $\\boldsymbol{K}_{xy}$ is the upper-left $2 \\times 2$ submatrix.\nUsing the first row of the system, $(6.9 - \\lambda)v_x + 2.6v_y = 0$, or $(69-10\\lambda)v_x + 26v_y = 0$.\n\nFor $\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$:\n$10\\lambda_1 = 64 + \\sqrt{701}$.\n$(69 - (64 + \\sqrt{701}))v_x + 26v_y = 0 \\implies (5 - \\sqrt{701})v_x + 26v_y = 0$.\nWe can choose an unnormalized eigenvector as $\\boldsymbol{v}_1' = \\begin{pmatrix} 26 \\\\ \\sqrt{701} - 5 \\\\ 0 \\end{pmatrix}$.\nThe squared norm is $|\\boldsymbol{v}_1'|^2 = 26^2 + (\\sqrt{701}-5)^2 = 676 + (701 - 10\\sqrt{701} + 25) = 1402 - 10\\sqrt{701}$.\nThe normalized eigenvector is $\\boldsymbol{n}_1 = \\frac{1}{\\sqrt{1402 - 10\\sqrt{701}}} \\begin{pmatrix} 26 \\\\ \\sqrt{701}-5 \\\\ 0 \\end{pmatrix}$.\n\nFor $\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$:\n$10\\lambda_2 = 64 - \\sqrt{701}$.\n$(69 - (64 - \\sqrt{701}))v_x + 26v_y = 0 \\implies (5 + \\sqrt{701})v_x + 26v_y = 0$.\nAn unnormalized eigenvector is $\\boldsymbol{v}_2' = \\begin{pmatrix} 26 \\\\ -5 - \\sqrt{701} \\\\ 0 \\end{pmatrix}$.\nThe squared norm is $|\\boldsymbol{v}_2'|^2 = 26^2 + (-5-\\sqrt{701})^2 = 676 + (25 + 10\\sqrt{701} + 701) = 1402 + 10\\sqrt{701}$.\nThe normalized eigenvector is $\\boldsymbol{n}_2 = \\frac{1}{\\sqrt{1402 + 10\\sqrt{701}}} \\begin{pmatrix} 26 \\\\ -5 - \\sqrt{701} \\\\ 0 \\end{pmatrix}$.\n\nTheprincipal conductivities are $\\lambda_1, \\lambda_2, \\lambda_3$ and the corresponding principal directions (as direction cosines) are the components of $\\boldsymbol{n}_1, \\boldsymbol{n}_2, \\boldsymbol{n}_3$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{64 + \\sqrt{701}}{10} & \\frac{64 - \\sqrt{701}}{10} & \\frac{21}{5} & \\frac{26}{\\sqrt{1402 - 10\\sqrt{701}}} & \\frac{\\sqrt{701}-5}{\\sqrt{1402 - 10\\sqrt{701}}} & 0 & \\frac{26}{\\sqrt{1402 + 10\\sqrt{701}}} & \\frac{-5-\\sqrt{701}}{\\sqrt{1402 + 10\\sqrt{701}}} & 0 & 0 & 0 & 1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Temperature-dependent properties can lead to thermal instabilities, such as runaway heating, where heat generation outpaces diffusion. In this practice , you will use linear stability analysis to derive the critical threshold for such an instability from first principles. This exercise demonstrates how to connect material property models to predictions of macroscopic system behavior.",
            "id": "3997989",
            "problem": "A homogeneous orthotropic solid occupies the rectangular domain $\\Omega = (0,L_x)\\times(0,L_y)\\times(0,L_z)$ with isothermal boundaries held at a constant temperature $T_s$. The internal energy balance for the temperature field $T(\\mathbf{x},t)$ is governed by the conservation law\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big) \\;+\\; Q(T)\\,,\n$$\nwhere $\\rho$ is the density, $c$ is the specific heat capacity, $\\mathbf{K}(T)$ is the anisotropic thermal conductivity tensor, and $Q(T)$ is the volumetric heat generation rate. The tensor $\\mathbf{K}(T)$ is diagonal with principal components $\\mathbf{K}(T)=\\mathrm{diag}\\big(k_x(T),k_y(T),k_z(T)\\big)$ that are smooth functions of $T$. The heat source satisfies $Q(T_s)=0$ and is monotonically increasing in a neighborhood of $T_s$ so that $Q(T)\\approx \\alpha\\,(T-T_s)$ for small deviations from $T_s$, where $\\alpha=\\left.\\frac{dQ}{dT}\\right|_{T_s}>0$.\n\nStarting from conservation of energy and without assuming any a priori formula for instability thresholds, perform a first-principles linear stability analysis of the uniform base state $T(\\mathbf{x},t)\\equiv T_s$ to show how the interplay between the temperature-dependent anisotropic conductivity $\\mathbf{K}(T)$ and the temperature-dependent generation $Q(T)$ can lead to thermal runaway. Derive a criterion that identifies a critical value $\\alpha_c$ of the source slope beyond which small perturbations grow exponentially in time, indicating loss of stability of $T_s$.\n\nThen, for a rectangular specimen with\n- $L_x = 0.02\\ \\mathrm{m}$, $L_y = 0.01\\ \\mathrm{m}$, $L_z = 0.005\\ \\mathrm{m}$,\n- $k_x(T_s)=140\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_y(T_s)=70\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_z(T_s)=35\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$,\n\nevaluate the corresponding critical threshold $\\alpha_c$ numerically. Round your answer to four significant figures. Express the final answer in $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$. The final answer must be a single real number.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of heat transfer and stability theory, well-posed with a clear objective and sufficient data, and free from contradictions or ambiguities. The base state $T(\\mathbf{x},t) \\equiv T_s$ is a valid steady-state solution of the governing equation, as $\\rho c \\frac{\\partial T_s}{\\partial t} = 0$, $\\nabla T_s = \\mathbf{0}$, and the problem states $Q(T_s)=0$, satisfying $0 = \\nabla \\cdot (\\mathbf{0}) + 0$. We may therefore proceed with the stability analysis.\n\nThe governing equation for the temperature field $T(\\mathbf{x}, t)$ is given by the conservation of energy:\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big) \\;+\\; Q(T)\n$$\nWe perform a linear stability analysis around the uniform base state $T_0(\\mathbf{x}, t) = T_s$. We introduce a small perturbation $\\theta(\\mathbf{x}, t)$ such that the total temperature field is $T(\\mathbf{x}, t) = T_s + \\theta(\\mathbf{x}, t)$, with $|\\theta|$ being small.\n\nWe substitute this perturbed field into the governing equation. The left-hand side becomes:\n$$\n\\rho c \\,\\frac{\\partial}{\\partial t}(T_s + \\theta) = \\rho c \\,\\frac{\\partial \\theta}{\\partial t}\n$$\nThe terms on the right-hand side are nonlinear and must be expanded to first order in $\\theta$. The heat generation term $Q(T)$ is approximated by its Taylor expansion around $T_s$:\n$$\nQ(T) = Q(T_s + \\theta) \\approx Q(T_s) + \\left.\\frac{dQ}{dT}\\right|_{T_s} \\theta + \\mathcal{O}(\\theta^2)\n$$\nGiven that $Q(T_s)=0$ and $\\alpha = \\left.\\frac{dQ}{dT}\\right|_{T_s}$, this simplifies to:\n$$\nQ(T) \\approx \\alpha \\theta\n$$\nNext, we analyze the divergence term $\\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big)$. We have $\\nabla T = \\nabla(T_s + \\theta) = \\nabla \\theta$. The conductivity tensor $\\mathbf{K}(T)$ is also expanded around $T_s$:\n$$\n\\mathbf{K}(T) = \\mathbf{K}(T_s + \\theta) \\approx \\mathbf{K}(T_s) + \\left.\\frac{d\\mathbf{K}}{dT}\\right|_{T_s} \\theta + \\mathcal{O}(\\theta^2)\n$$\nLet's denote $\\mathbf{K}_s = \\mathbf{K}(T_s)$ and $\\mathbf{K}'_s = \\left.\\frac{d\\mathbf{K}}{dT}\\right|_{T_s}$. The heat flux vector becomes:\n$$\n\\mathbf{K}(T)\\,\\nabla T \\approx (\\mathbf{K}_s + \\mathbf{K}'_s \\theta) \\nabla\\theta = \\mathbf{K}_s \\nabla\\theta + \\mathbf{K}'_s \\theta \\nabla\\theta\n$$\nThe term $\\mathbf{K}'_s \\theta \\nabla\\theta$ is of second order in the perturbation $\\theta$ and its derivatives and is therefore neglected in a linear analysis. The linearized heat flux is $\\mathbf{K}_s \\nabla\\theta$. The divergence of this flux is:\n$$\n\\nabla \\cdot (\\mathbf{K}_s \\nabla\\theta)\n$$\nSince $T_s$ is a constant, the components of $\\mathbf{K}_s = \\mathrm{diag}\\big(k_x(T_s),k_y(T_s),k_z(T_s)\\big)$ are constants in space. Let $k_{xs} = k_x(T_s)$, $k_{ys} = k_y(T_s)$, and $k_{zs} = k_z(T_s)$. The divergence term becomes:\n$$\n\\nabla \\cdot (\\mathbf{K}_s \\nabla\\theta) = \\frac{\\partial}{\\partial x}\\left(k_{xs}\\frac{\\partial\\theta}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(k_{ys}\\frac{\\partial\\theta}{\\partial y}\\right) + \\frac{\\partial}{\\partial z}\\left(k_{zs}\\frac{\\partial\\theta}{\\partial z}\\right) = k_{xs}\\frac{\\partial^2\\theta}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\theta}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\theta}{\\partial z^2}\n$$\nCombining all linearized terms, we obtain the evolution equation for the perturbation $\\theta$:\n$$\n\\rho c \\,\\frac{\\partial \\theta}{\\partial t} = k_{xs}\\frac{\\partial^2\\theta}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\theta}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\theta}{\\partial z^2} + \\alpha\\theta\n$$\nThe boundary conditions are $T=T_s$ on $\\partial\\Omega$. For the perturbation, this translates to homogeneous Dirichlet boundary conditions: $\\theta(\\mathbf{x}, t) = 0$ for $\\mathbf{x} \\in \\partial\\Omega$.\n\nTo solve this linear partial differential equation, we use the method of separation of variables. We seek solutions of the form $\\theta(\\mathbf{x}, t) = e^{\\sigma t} \\phi(\\mathbf{x})$, where $\\sigma$ is the temporal growth rate. Substituting this into the equation yields:\n$$\n\\rho c \\sigma \\phi = k_{xs}\\frac{\\partial^2\\phi}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\phi}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\phi}{\\partial z^2} + \\alpha\\phi\n$$\nThis can be rearranged into an eigenvalue problem for the spatial function $\\phi(\\mathbf{x})$:\n$$\n- \\left( k_{xs}\\frac{\\partial^2}{\\partial x^2} + k_{ys}\\frac{\\partial^2}{\\partial y^2} + k_{zs}\\frac{\\partial^2}{\\partial z^2} \\right) \\phi = (\\alpha - \\rho c \\sigma) \\phi\n$$\nThe operator on the left is a self-adjoint elliptic operator. For the rectangular domain $\\Omega = (0,L_x)\\times(0,L_y)\\times(0,L_z)$ with homogeneous Dirichlet boundary conditions, the eigenfunctions $\\phi$ and corresponding eigenvalues are well-known. The eigenfunctions are:\n$$\n\\phi_{lmn}(x,y,z) = \\sin\\left(\\frac{l\\pi x}{L_x}\\right) \\sin\\left(\\frac{m\\pi y}{L_y}\\right) \\sin\\left(\\frac{n\\pi z}{L_z}\\right)\n$$\nwhere $l, m, n$ are positive integers ($1, 2, 3, \\ldots$).\nApplying the spatial operator to an eigenfunction $\\phi_{lmn}$ yields:\n$$\n- \\left( k_{xs}\\frac{\\partial^2\\phi_{lmn}}{\\partial x^2} + \\dots \\right) = \\left[ k_{xs}\\left(\\frac{l\\pi}{L_x}\\right)^2 + k_{ys}\\left(\\frac{m\\pi}{L_y}\\right)^2 + k_{zs}\\left(\\frac{n\\pi}{L_z}\\right)^2 \\right] \\phi_{lmn}\n$$\nThus, for each mode $(l,m,n)$, we have the relation:\n$$\n\\pi^2 \\left( \\frac{k_{xs} l^2}{L_x^2} + \\frac{k_{ys} m^2}{L_y^2} + \\frac{k_{zs} n^2}{L_z^2} \\right) = \\alpha - \\rho c \\sigma_{lmn}\n$$\nThe growth rate for the mode $(l,m,n)$ is therefore:\n$$\n\\sigma_{lmn} = \\frac{1}{\\rho c} \\left[ \\alpha - \\pi^2 \\left( \\frac{k_{xs} l^2}{L_x^2} + \\frac{k_{ys} m^2}{L_y^2} + \\frac{k_{zs} n^2}{L_z^2} \\right) \\right]\n$$\nThe uniform state $T_s$ becomes unstable if any perturbation mode can grow exponentially, which means $\\sigma_{lmn} > 0$ for at least one set of integers $(l,m,n)$. The stability of the system is determined by the most unstable mode, which is the one with the largest growth rate, $\\sigma_{\\max}$. To maximize $\\sigma_{lmn}$, we must minimize the positive definite term being subtracted from $\\alpha$. This occurs for the smallest possible values of the mode numbers, which are $l=1$, $m=1$, and $n=1$. This corresponds to the fundamental mode, the perturbation with the largest spatial wavelength.\n\nThe maximum growth rate is:\n$$\n\\sigma_{\\max} = \\sigma_{111} = \\frac{1}{\\rho c} \\left[ \\alpha - \\pi^2 \\left( \\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} \\right) \\right]\n$$\nThe transition from stability ($\\sigma_{\\max} < 0$) to instability ($\\sigma_{\\max} > 0$) occurs at the critical point where $\\sigma_{\\max} = 0$. The value of $\\alpha$ at this threshold is the critical value, $\\alpha_c$:\n$$\n\\alpha_c = \\pi^2 \\left( \\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} \\right)\n$$\nThis is the criterion for the onset of thermal runaway. It shows that instability occurs when the heat generation rate's sensitivity to temperature, $\\alpha$, becomes large enough to overcome the stabilizing effect of thermal diffusion, which is represented by the conductivity and geometric parameters.\n\nNow, we evaluate $\\alpha_c$ for the given numerical values:\n$L_x = 0.02\\ \\mathrm{m}$, $L_y = 0.01\\ \\mathrm{m}$, $L_z = 0.005\\ \\mathrm{m}$.\n$k_{xs} = 140\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_{ys} = 70\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_{zs} = 35\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n\nFirst, we compute the terms inside the parenthesis. The units of each term are $(\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}) / \\mathrm{m}^2 = \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$, which is correct for $\\alpha$.\n$$\n\\frac{k_{xs}}{L_x^2} = \\frac{140}{(0.02)^2} = \\frac{140}{0.0004} = 350000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n$$\n\\frac{k_{ys}}{L_y^2} = \\frac{70}{(0.01)^2} = \\frac{70}{0.0001} = 700000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n$$\n\\frac{k_{zs}}{L_z^2} = \\frac{35}{(0.005)^2} = \\frac{35}{0.000025} = 1400000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\nSumming these contributions:\n$$\n\\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} = 350000 + 700000 + 1400000 = 2450000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\nFinally, we multiply by $\\pi^2$:\n$$\n\\alpha_c = \\pi^2 \\times 2450000 \\approx 9.8696044 \\times 2450000 \\approx 24180530.78\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\nRounding to four significant figures, we get:\n$$\n\\alpha_c \\approx 2.418 \\times 10^7\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$",
            "answer": "$$\\boxed{2.418 \\times 10^7}$$"
        },
        {
            "introduction": "This hands-on coding practice  challenges you to simulate a phase-change process, where the apparent heat capacity is strongly temperature-dependent, within an anisotropic material. You will implement an explicit finite difference scheme to solve the governing nonlinear partial differential equation. By analyzing the results, you will gain practical insight into how numerical parameters and physical anisotropy together dictate the evolution of a thermal system.",
            "id": "3997972",
            "problem": "Consider a two-dimensional conduction problem with anisotropic thermal conductivity and temperature-dependent thermophysical properties. The energy conservation law coupled with Fourier’s law of heat conduction in anisotropic media yields the governing equation\n$$\n\\rho\\,c_p^{\\mathrm{app}}(T)\\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla\\cdot\\left(\\mathbf{K}\\,\\nabla T\\right),\n$$\nwhere $T$ is the temperature field in kelvin, $\\rho$ is the mass density in $\\mathrm{kg/m^3}$, $c_p^{\\mathrm{app}}(T)$ is the apparent heat capacity in $\\mathrm{J/(kg\\cdot K)}$, and $\\mathbf{K}$ is the thermal conductivity tensor in $\\mathrm{W/(m\\cdot K)}$. Anisotropy is represented by a diagonal conductivity tensor\n$$\n\\mathbf{K} = \\begin{bmatrix} k_x & 0 \\\\ 0 & k_y \\end{bmatrix},\n$$\nwith $k_x$ and $k_y$ constants. The apparent heat capacity method captures latent heat via\n$$\nc_p^{\\mathrm{app}}(T) \\;=\\; c_p(T) + L\\,\\delta_\\epsilon(T - T_m),\n$$\nwhere $c_p(T)$ is a baseline temperature-dependent heat capacity, $L$ is the latent heat per unit mass in $\\mathrm{J/kg}$, $T_m$ is the melting temperature in $\\mathrm{K}$, and $\\delta_\\epsilon(\\cdot)$ is a regularized Dirac delta function (Dirac delta function (DDF)) with smoothing parameter $\\epsilon$ in $\\mathrm{K}$. Use the Gaussian mollifier\n$$\n\\delta_\\epsilon(s) = \\frac{1}{\\sqrt{2\\pi}\\,\\epsilon}\\,\\exp\\!\\left(-\\frac{s^2}{2\\epsilon^2}\\right).\n$$\n\nLet the domain be a rectangle with dimensions $L_x$ by $L_y$ in $\\mathrm{m}$, discretized uniformly into $N_x$ by $N_y$ nodes with spacings $\\Delta x$ and $\\Delta y$. Impose zero-flux (Neumann) boundary conditions on all sides. Initialize the temperature field with a sharp interface at mid-width:\n$$\nT(x,y,0) = \n\\begin{cases}\nT_m + \\Delta T_0, & x < \\frac{L_x}{2}, \\\\\nT_m - \\Delta T_0, & x \\ge \\frac{L_x}{2},\n\\end{cases}\n$$\nfor all $y\\in[0,L_y]$, where $\\Delta T_0$ is a small temperature offset in $\\mathrm{K}$. The baseline heat capacity is\n$$\nc_p(T) = c_0 + a\\,T,\n$$\nwith $c_0$ in $\\mathrm{J/(kg\\cdot K)}$ and $a$ in $\\mathrm{J/(kg\\cdot K^2)}$.\n\nIntegrate the governing equation forward in time to a final time $t_{\\mathrm{final}}$ in $\\mathrm{s}$ using a consistent explicit finite difference method that respects the anisotropy, the temperature dependence of $c_p^{\\mathrm{app}}(T)$, and the zero-flux boundaries. After reaching $t_{\\mathrm{final}}$, quantify the interface smearing along the horizontal and vertical centerlines using the following metric. Define a tolerance $\\Delta T_{\\mathrm{tol}}$ in $\\mathrm{K}$ and measure the total spatial thickness in $\\mathrm{m}$ of the set of points along the centerlines where\n$$\n\\left|T - T_m\\right| \\le \\Delta T_{\\mathrm{tol}}.\n$$\nSpecifically:\n- Along the horizontal centerline at $y = L_y/2$, let $w_x$ be the width in $\\mathrm{m}$ of the contiguous region where $\\left|T(x, L_y/2, t_{\\mathrm{final}}) - T_m\\right| \\le \\Delta T_{\\mathrm{tol}}$.\n- Along the vertical centerline at $x = L_x/2$, let $w_y$ be the width in $\\mathrm{m}$ of the contiguous region where $\\left|T(L_x/2, y, t_{\\mathrm{final}}) - T_m\\right| \\le \\Delta T_{\\mathrm{tol}}$.\n\nYour task is to implement $c_p^{\\mathrm{app}}(T)$ with the Gaussian $\\delta_\\epsilon$, advance the temperature field numerically, and compute $(w_x,w_y)$ for each test case below. Express all widths in meters, rounded to six decimal places.\n\nUse the following physically plausible parameter values unless varied in the test suite:\n- $L_x = 0.02\\ \\mathrm{m}$, $L_y = 0.02\\ \\mathrm{m}$, $N_x = 64$, $N_y = 64$, $T_m = 300\\ \\mathrm{K}$,\n- $\\Delta T_0 = 1.0\\ \\mathrm{K}$, $\\Delta T_{\\mathrm{tol}} = 0.05\\ \\mathrm{K}$,\n- $\\rho = 1000\\ \\mathrm{kg/m^3}$, $c_0 = 1000\\ \\mathrm{J/(kg\\cdot K)}$, $a = 0.1\\ \\mathrm{J/(kg\\cdot K^2)}$,\n- $L = 2.0\\times 10^5\\ \\mathrm{J/kg}$, $t_{\\mathrm{final}} = 0.2\\ \\mathrm{s}$.\n\nTest suite:\n1. Happy path anisotropic case: $\\epsilon = 0.10\\ \\mathrm{K}$, $k_x = 10\\ \\mathrm{W/(m\\cdot K)}$, $k_y = 2\\ \\mathrm{W/(m\\cdot K)}$.\n2. Small $\\epsilon$ (sharper regularization): $\\epsilon = 0.01\\ \\mathrm{K}$, $k_x = 10\\ \\mathrm{W/(m\\cdot K)}$, $k_y = 2\\ \\mathrm{W/(m\\cdot K)}$.\n3. Large $\\epsilon$ (broader regularization): $\\epsilon = 0.50\\ \\mathrm{K}$, $k_x = 10\\ \\mathrm{W/(m\\cdot K)}$, $k_y = 2\\ \\mathrm{W/(m\\cdot K)}$.\n4. Isotropic comparison: $\\epsilon = 0.10\\ \\mathrm{K}$, $k_x = 10\\ \\mathrm{W/(m\\cdot K)}$, $k_y = 10\\ \\mathrm{W/(m\\cdot K)}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the pair $[w_x,w_y]$ corresponding to a test case, for example\n$$\n\\big[ [w_x^{(1)},w_y^{(1)}],[w_x^{(2)},w_y^{(2)}],[w_x^{(3)},w_y^{(3)}],[w_x^{(4)},w_y^{(4)}] \\big],\n$$\nwith each $w_x^{(i)}$ and $w_y^{(i)}$ in $\\mathrm{m}$ rounded to six decimal places.",
            "solution": "Begin with local energy conservation for a continuum and Fourier’s law of heat conduction. For a control volume with no internal heat generation, the First Law of Thermodynamics yields\n$$\n\\frac{\\partial}{\\partial t}\\left(\\rho\\,u\\right) = -\\nabla\\cdot \\mathbf{q},\n$$\nwhere $\\rho$ is the mass density, $u$ is the specific internal energy, and $\\mathbf{q}$ is the heat flux vector. For a sensible heat capacity model with latent heat using the apparent heat capacity method,\n$$\n\\frac{\\partial u}{\\partial T} = c_p^{\\mathrm{app}}(T),\n$$\nso $\\partial(\\rho u)/\\partial t = \\rho\\,c_p^{\\mathrm{app}}(T)\\,\\partial T/\\partial t$. For anisotropic conduction, Fourier’s law is\n$$\n\\mathbf{q} = -\\mathbf{K}\\,\\nabla T,\n$$\nwith $\\mathbf{K}$ a symmetric positive definite tensor. Combining these gives the anisotropic heat equation with an apparent heat capacity:\n$$\n\\rho\\,c_p^{\\mathrm{app}}(T)\\,\\frac{\\partial T}{\\partial t} = \\nabla\\cdot\\left(\\mathbf{K}\\,\\nabla T\\right).\n$$\n\nThe apparent heat capacity method incorporates phase change by augmenting the baseline heat capacity $c_p(T)$ with a regularized Dirac delta function centered at $T_m$:\n$$\nc_p^{\\mathrm{app}}(T) = c_p(T) + L\\,\\delta_\\epsilon(T - T_m).\n$$\nA common and well-behaved regularization is the Gaussian mollifier\n$$\n\\delta_\\epsilon(s) = \\frac{1}{\\sqrt{2\\pi}\\,\\epsilon}\\,\\exp\\!\\left(-\\frac{s^2}{2\\epsilon^2}\\right),\n$$\nwhich satisfies $\\int_{-\\infty}^\\infty \\delta_\\epsilon(s)\\,ds = 1$ and $\\delta_\\epsilon(s)\\to \\delta(s)$ in the sense of distributions as $\\epsilon\\to 0$. The parameter $\\epsilon$ controls the breadth of the temperature interval over which latent heat is released or absorbed; physically it produces a “mushy zone” of finite width that smears the sharp phase-change interface.\n\nFor the baseline heat capacity we take a linear model\n$$\nc_p(T) = c_0 + a\\,T,\n$$\nwith $c_0$ and $a$ constants. The conductivity tensor is diagonal,\n$$\n\\mathbf{K} = \\mathrm{diag}(k_x,k_y),\n$$\nso the principal directions of heat flow coincide with the coordinate axes. With constant $k_x,k_y$, the governing equation becomes\n$$\n\\rho\\,c_p^{\\mathrm{app}}(T)\\,\\frac{\\partial T}{\\partial t} = k_x\\,\\frac{\\partial^2 T}{\\partial x^2} + k_y\\,\\frac{\\partial^2 T}{\\partial y^2}.\n$$\n\nDiscretization and algorithmic design:\n- Spatial domain: a rectangle of size $L_x\\times L_y$ discretized uniformly with $N_x\\times N_y$ grid points. Let $\\Delta x = L_x/(N_x-1)$ and $\\Delta y = L_y/(N_y-1)$.\n- Boundary conditions: zero-flux (Neumann) on all boundaries. In a finite difference context, this is implemented by symmetric mirroring of boundary values to ghost points so that $\\partial T/\\partial n = 0$ at the edges, yielding second derivatives computed by central differences that respect Neumann conditions.\n- Time integration: an explicit forward Euler scheme using second-order central differences for spatial derivatives. For grid node $(i,j)$ at time step $n$, define the discrete anisotropic Laplacian\n$$\n\\mathcal{L}(T^{(n)})_{i,j} = k_x\\,\\frac{T^{(n)}_{i+1,j} - 2T^{(n)}_{i,j} + T^{(n)}_{i-1,j}}{\\Delta x^2}\n+ k_y\\,\\frac{T^{(n)}_{i,j+1} - 2T^{(n)}_{i,j} + T^{(n)}_{i,j-1}}{\\Delta y^2},\n$$\nwith mirrored boundary values for $i=\\{0,N_x-1\\}$ and $j=\\{0,N_y-1\\}$. The update is\n$$\nT^{(n+1)}_{i,j} = T^{(n)}_{i,j} + \\Delta t\\,\\frac{\\mathcal{L}(T^{(n)})_{i,j}}{\\rho\\,c_p^{\\mathrm{app}}(T^{(n)}_{i,j})}.\n$$\nBecause $c_p^{\\mathrm{app}}$ depends on $T$, the local thermal diffusivities along each axis are $\\alpha_x(T) = k_x/(\\rho\\,c_p^{\\mathrm{app}}(T))$ and $\\alpha_y(T) = k_y/(\\rho\\,c_p^{\\mathrm{app}}(T))$, and a sufficient stability condition for the explicit scheme is\n$$\n\\Delta t \\le \\frac{1}{2\\left(\\frac{\\alpha_x^{\\max}}{\\Delta x^2} + \\frac{\\alpha_y^{\\max}}{\\Delta y^2}\\right)},\n$$\nwhere $\\alpha_x^{\\max}$ and $\\alpha_y^{\\max}$ are upper bounds of the diffusivities over the domain and time interval. Since $\\alpha_{x,y}(T)$ decrease with increasing $c_p^{\\mathrm{app}}(T)$, conservative bounds come from the minimum possible $c_p^{\\mathrm{app}}(T)$, which occurs away from $T_m$ in the baseline heat capacity; hence using $c_p^{\\mathrm{app,min}}\\approx c_p(T_{\\min})$ is conservative. A Courant–Friedrichs–Lewy-like (CFL-like) factor less than $1$ is applied for robustness.\n\nInitialization:\n- The initial temperature field creates a sharp interface at $x=L_x/2$:\n$$\nT(x,y,0) = \\begin{cases}\nT_m + \\Delta T_0, & x < L_x/2,\\\\\nT_m - \\Delta T_0, & x \\ge L_x/2.\n\\end{cases}\n$$\nThis produces opposing thermal tendencies across the interface, and the apparent heat capacity term will regulate the temperature evolution near $T_m$.\n\nSmearing metric:\n- After integrating to $t_{\\mathrm{final}}$, take the horizontal centerline at $y=L_y/2$ and find the contiguous set of nodes where $\\left|T - T_m\\right| \\le \\Delta T_{\\mathrm{tol}}$. The spatial width of this set times $\\Delta x$ gives $w_x$ in $\\mathrm{m}$. Similarly, along the vertical centerline at $x=L_x/2$ using $\\Delta y$ gives $w_y$ in $\\mathrm{m}$.\n- If no node along a centerline satisfies the tolerance, the width is zero. If all nodes satisfy, the width is the full domain length in that direction.\n\nEffect of $\\epsilon$ and anisotropy:\n- Increasing $\\epsilon$ broadens $\\delta_\\epsilon$, distributing latent heat absorption/release over a wider temperature interval. This lowers the peak magnitude of $c_p^{\\mathrm{app}}(T)$ near $T_m$ but widens the temperature band in which $c_p^{\\mathrm{app}}(T)$ is elevated. The net consequence is a wider mushy region, i.e., increased $w_x$ and $w_y$, especially at finite times.\n- Anisotropy modulates the rate of diffusion along each axis. With $k_x > k_y$, thermal diffusion is faster horizontally, so the interface smearing along the horizontal centerline ($w_x$) tends to be larger than along the vertical centerline ($w_y$) for the same $\\epsilon$. In the isotropic case ($k_x = k_y$), $w_x$ and $w_y$ should be comparable.\n\nImplementation details:\n- Use $\\delta_\\epsilon(s) = \\frac{1}{\\sqrt{2\\pi}\\epsilon}\\exp\\left(-\\frac{s^2}{2\\epsilon^2}\\right)$ and $c_p(T)=c_0+aT$.\n- Compute $c_p^{\\mathrm{app}}(T)$ pointwise each time step from the current $T$.\n- Choose $\\Delta t$ from the conservative stability bound using $c_p^{\\mathrm{app,min}}\\approx c_0+a\\,(T_m-\\Delta T_0)$ and then scale it to hit $t_{\\mathrm{final}}$ with an integer number of steps.\n\nThe program will execute the four test cases provided, compute $(w_x,w_y)$ in $\\mathrm{m}$ rounded to six decimal places for each, and print a single line in the format\n$$\n\\big[ [w_x^{(1)},w_y^{(1)}],[w_x^{(2)},w_y^{(2)}],[w_x^{(3)},w_y^{(3)}],[w_x^{(4)},w_y^{(4)}] \\big].\n$$",
            "answer": "```python\nimport numpy as np\n\n# Computational setup adhering to the specified environment:\n# Python 3.12, numpy 1.23.5, scipy 1.11.4 (not used).\n\ndef gaussian_delta(s, eps):\n    \"\"\"Regularized Dirac delta: Gaussian mollifier.\"\"\"\n    # Avoid division by zero; eps is positive in test suite.\n    coef = 1.0 / (np.sqrt(2.0 * np.pi) * eps)\n    return coef * np.exp(-0.5 * (s / eps) ** 2)\n\ndef cp_baseline(T, c0, a):\n    \"\"\"Baseline heat capacity cp(T) = c0 + a*T.\"\"\"\n    return c0 + a * T\n\ndef cp_apparent(T, c0, a, L_latent, Tm, eps):\n    \"\"\"Apparent heat capacity cp_app(T) = cp(T) + L*delta_eps(T-Tm).\"\"\"\n    return cp_baseline(T, c0, a) + L_latent * gaussian_delta(T - Tm, eps)\n\ndef anisotropic_laplacian(T, kx, ky, dx, dy):\n    \"\"\"\n    Compute anisotropic diffusion operator: kx*d2T/dx2 + ky*d2T/dy2\n    with zero-flux (Neumann) boundary conditions via mirrored ghost points.\n    \"\"\"\n    # Neighbors with mirrored boundaries\n    T_left = np.empty_like(T)\n    T_right = np.empty_like(T)\n    T_down = np.empty_like(T)\n    T_up = np.empty_like(T)\n\n    # x-direction neighbors\n    T_left[:, 1:] = T[:, :-1]\n    T_left[:, 0] = T[:, 1]  # mirror at left boundary\n\n    T_right[:, :-1] = T[:, 1:]\n    T_right[:, -1] = T[:, -2]  # mirror at right boundary\n\n    # y-direction neighbors\n    T_down[1:, :] = T[:-1, :]\n    T_down[0, :] = T[1, :]  # mirror at bottom boundary\n\n    T_up[:-1, :] = T[1:, :]\n    T_up[-1, :] = T[-2, :]  # mirror at top boundary\n\n    d2Tdx2 = (T_right - 2.0 * T + T_left) / (dx * dx)\n    d2Tdy2 = (T_up - 2.0 * T + T_down) / (dy * dy)\n\n    return kx * d2Tdx2 + ky * d2Tdy2\n\ndef measure_width_centerline(T, Tm, tol, dx, dy):\n    \"\"\"\n    Measure smearing width along horizontal and vertical centerlines:\n    - Horizontal centerline (y = Ly/2): width in x-direction using dx.\n    - Vertical centerline (x = Lx/2): width in y-direction using dy.\n    Returns (w_x, w_y).\n    \"\"\"\n    Ny, Nx = T.shape\n    row = Ny // 2\n    col = Nx // 2\n\n    # Horizontal centerline\n    T_row = T[row, :]\n    mask_x = np.abs(T_row - Tm) <= tol\n    if np.any(mask_x):\n        idx = np.where(mask_x)[0]\n        w_x = (idx[-1] - idx[0]) * dx\n    else:\n        w_x = 0.0\n\n    # Vertical centerline\n    T_col = T[:, col]\n    mask_y = np.abs(T_col - Tm) <= tol\n    if np.any(mask_y):\n        idy = np.where(mask_y)[0]\n        w_y = (idy[-1] - idy[0]) * dy\n    else:\n        w_y = 0.0\n\n    return w_x, w_y\n\ndef simulate_case(eps, kx, ky,\n                  Lx=0.02, Ly=0.02, Nx=64, Ny=64,\n                  Tm=300.0, dT0=1.0, Ttol=0.05,\n                  rho=1000.0, c0=1000.0, a=0.1,\n                  L_latent=2.0e5, t_final=0.2):\n    \"\"\"\n    Simulate anisotropic conduction with apparent heat capacity and return (w_x, w_y).\n    Widths are in meters.\n    \"\"\"\n    dx = Lx / (Nx - 1)\n    dy = Ly / (Ny - 1)\n\n    # Initial condition: sharp interface at mid-width\n    T = np.full((Ny, Nx), Tm - dT0, dtype=np.float64)\n    T[:, :Nx // 2] = Tm + dT0\n\n    # Conservative dt from explicit stability using cp_min away from Tm.\n    # cp_min ~ c0 + a*(Tm - dT0) (latent term increases cp, so ignoring it is conservative).\n    cp_min = c0 + a * (Tm - dT0)\n    alpha_x_max = kx / (rho * cp_min)\n    alpha_y_max = ky / (rho * cp_min)\n    # Stability bound: dt <= 1 / (2*(alpha_x/dx^2 + alpha_y/dy^2))\n    denom = 2.0 * (alpha_x_max / (dx * dx) + alpha_y_max / (dy * dy))\n    dt_stable = 1.0 / denom\n    # Choose a CFL factor for robustness\n    cfl = 0.45\n    dt = cfl * dt_stable\n    # Adjust dt to exactly hit t_final with an integer number of steps\n    n_steps = int(np.ceil(t_final / dt))\n    dt = t_final / n_steps\n\n    # Time stepping\n    for _ in range(n_steps):\n        # Compute apparent heat capacity at current temperature\n        cp_app = cp_apparent(T, c0, a, L_latent, Tm, eps)\n        # Anisotropic diffusion operator\n        diff_op = anisotropic_laplacian(T, kx, ky, dx, dy)\n        # Explicit update with local cp_app\n        T = T + dt * (diff_op / (rho * cp_app))\n\n    # Measure smearing widths along centerlines\n    w_x, w_y = measure_width_centerline(T, Tm, Ttol, dx, dy)\n    return w_x, w_y\n\ndef format_pair(wx, wy):\n    \"\"\"Format widths to six decimal places without spaces.\"\"\"\n    return f\"[{wx:.6f},{wy:.6f}]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (epsilon [K], kx [W/(m*K)], ky [W/(m*K)])\n    test_cases = [\n        (0.10, 10.0, 2.0),   # Happy path anisotropic\n        (0.01, 10.0, 2.0),   # Small epsilon\n        (0.50, 10.0, 2.0),   # Large epsilon\n        (0.10, 10.0, 10.0),  # Isotropic comparison\n    ]\n\n    results_str = []\n    for eps, kx, ky in test_cases:\n        wx, wy = simulate_case(eps, kx, ky)\n        results_str.append(format_pair(wx, wy))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}