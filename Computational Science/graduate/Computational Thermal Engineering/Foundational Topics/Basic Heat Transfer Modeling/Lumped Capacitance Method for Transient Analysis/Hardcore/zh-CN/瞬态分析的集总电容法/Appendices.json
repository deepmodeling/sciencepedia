{
    "hands_on_practices": [
        {
            "introduction": "现实世界的热力系统通常比理想模型更复杂，其传热路径上往往存在多种串联的热阻。本练习将基础的集总电容法扩展到一个更实际的场景：一个物体通过一个包含接触热阻和对流热阻的复合界面进行冷却 。通过推导包含总热阻的控制微分方程，您将学会如何构建更精确的热路模型，并加深对热时间常数物理意义的理解。",
            "id": "3969219",
            "problem": "一个均匀、各向同性的铝模块内部热充分混合，仅通过一个与大型、充分搅拌的液体浴接触的平面进行冷却。在模块外表面和液体浴之间存在两个串联的热流障碍：一个具有均匀热接触电阻的薄热界面层和液体侧的对流膜。液体浴在所有时间内保持等温，温度为 $T_{s}$。该模块的质量为 $m$，恒定比热为 $c$，热导率为 $k$。与界面层接触的模块平面面积为 $A$，所有其他面均为完美绝热。界面层的热接触电阻是均匀的，并等于一个恒定值（与温度和热通量无关）。液体侧的传热系数是均匀的，并等于一个恒定值，液体主体温度为 $T_{s}$。在时间 $t=0$ 时，模块的初始温度为 $T_{0}T_{s}$。\n\n数据：\n- 质量 $m=0.25\\ \\text{kg}$，\n- 比热 $c=900\\ \\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，\n- 热导率 $k=205\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$，\n- 密度 $\\rho=2700\\ \\text{kg}\\,\\text{m}^{-3}$，\n- 面积 $A=0.020\\ \\text{m}^{2}$，\n- 热接触电阻（已按给定面积归一化和表示） $R_{c}=3.00\\times 10^{-3}\\ \\text{K}\\,\\text{W}^{-1}$，\n- 传热系数 $h=200\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$。\n\n从瞬态控制质量的热力学第一定律以及跨界面层和对流膜传热的本构关系出发，推导模块空间均匀温度 $T(t)$ 相对于等温浴 $T_{s}$ 的控制常微分方程。识别热响应的相关单指数时间常数 $\\tau$，并用给定参数表示。\n\n然后，使用所提供的数据对 $\\tau$ 进行数值计算。将您的最终答案四舍五入到四位有效数字，并以秒为单位表示时间常数。您的最终答案必须是一个数字。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且适定。\n\n**步骤 1：提取已知条件**\n-   模块质量: $m=0.25\\ \\text{kg}$\n-   模块比热: $c=900\\ \\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$\n-   模块热导率: $k=205\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$\n-   模块密度: $\\rho=2700\\ \\text{kg}\\,\\text{m}^{-3}$\n-   传热面积: $A=0.020\\ \\text{m}^{2}$\n-   热接触电阻: $R_{c}=3.00\\times 10^{-3}\\ \\text{K}\\,\\text{W}^{-1}$\n-   对流传热系数: $h=200\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n-   等温浴温度: $T_{s}$\n-   模块初始温度: $T(0) = T_{0}$\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题基于热力学第一定律、傅里叶冷却定律和牛顿冷却定律。它描述了一个通常使用集总电容法建模的瞬态传热场景。该方法的核心假设是物体内部温度在空间上是均匀的，这一点在问题中明确指出模块“内部热充分混合”。\n\n为了证实该假设的物理合理性，我们可以评估毕渥数 $Bi$。当 $Bi \\ll 1$ 时，集总电容法是有效的。毕渥数定义为 $Bi = \\frac{R_{cond}}{R_{conv,ext}}$，表示内部（传导）热阻与外部（对流/表面）热阻之比。对于本问题，外部热阻是接触热阻和对流热阻的组合。一个等效的定义是 $Bi=\\frac{U L_c}{k}$，其中 $U$ 是总传热系数，$L_c$ 是特征长度，$k$ 是固体的热导率。\n\n总外部热阻 $R_{tot}$ 是接触热阻 $R_c$ 和对流热阻 $R_{conv}$ 的串联之和：\n$$R_{tot} = R_{c} + R_{conv}$$\n对流热阻由 $R_{conv} = \\frac{1}{hA}$ 给出。\n$$R_{conv} = \\frac{1}{(200\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1})(0.020\\ \\text{m}^{2})} = \\frac{1}{4.0}\\ \\text{K}\\,\\text{W}^{-1} = 0.25\\ \\text{K}\\,\\text{W}^{-1}$$\n$$R_{tot} = (3.00\\times 10^{-3}\\ \\text{K}\\,\\text{W}^{-1}) + (0.25\\ \\text{K}\\,\\text{W}^{-1}) = 0.253\\ \\text{K}\\,\\text{W}^{-1}$$\n总传热系数 $U$ 的定义满足 $\\frac{1}{UA} = R_{tot}$。\n$$U = \\frac{1}{A R_{tot}} = \\frac{1}{(0.020\\ \\text{m}^{2})(0.253\\ \\text{K}\\,\\text{W}^{-1})} \\approx 197.6\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$$\n对于一个面积为 $A$、体积为 $V$，一面绝热另一面冷却的平板壁，其特征长度 $L_c$ 是其厚度 $L = V/A$。体积为 $V=m/\\rho$。\n$$V = \\frac{0.25\\ \\text{kg}}{2700\\ \\text{kg}\\,\\text{m}^{-3}} \\approx 9.259 \\times 10^{-5}\\ \\text{m}^3$$\n$$L_c = L = \\frac{V}{A} = \\frac{9.259 \\times 10^{-5}\\ \\text{m}^3}{0.020\\ \\text{m}^2} \\approx 4.63 \\times 10^{-3}\\ \\text{m}$$\n毕渥数为：\n$$Bi = \\frac{U L_c}{k} = \\frac{(197.6\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1})(4.63 \\times 10^{-3}\\ \\text{m})}{205\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}} \\approx 0.00446$$\n由于 $Bi \\approx 0.00446 \\ll 0.1$，内部温度均匀的假设是完全合理的。所有提供的数据都是一致且物理上真实的。该问题是适定且有效的。\n\n**步骤 3：求解推导**\n我们将热力学第一定律应用于被视为控制质量的铝模块。模块内能的变化率 $\\frac{dE}{dt}$ 必须等于模块的净传出热率 $-\\dot{Q}_{out}$。\n$$\\frac{dE}{dt} = -\\dot{Q}_{out}$$\n假设比热 $c$ 恒定，内能的变化率为：\n$$\\frac{dE}{dt} = mc\\frac{dT}{dt}$$\n其中 $T(t)$ 是模块在时间 $t$ 时的均匀温度。\n\n模块的传出热量 $\\dot{Q}_{out}$ 通过热接触电阻和流体侧对流热阻的串联组合发生。总传热率由模块温度 $T(t)$ 和等温液体浴温度 $T_s$ 之间的温差驱动。\n$$\\dot{Q}_{out} = \\frac{T(t) - T_s}{R_{tot}}$$\n总热阻 $R_{tot}$ 是给定的接触热阻 $R_c$ 和对流热阻 $R_{conv} = \\frac{1}{hA}$ 的和。\n$$R_{tot} = R_c + \\frac{1}{hA}$$\n将这些表达式代入能量平衡方程，得到：\n$$mc\\frac{dT}{dt} = -\\frac{T(t) - T_s}{R_c + \\frac{1}{hA}}$$\n这是模块温度 $T(t)$ 的控制常微分方程（ODE）。\n\n为了确定时间常数，我们为温差引入一个新变量 $\\theta(t) = T(t) - T_s$。由于 $T_s$ 是常数，因此 $\\frac{d\\theta}{dt} = \\frac{dT}{dt}$。该常微分方程可以用 $\\theta(t)$ 改写为：\n$$mc\\frac{d\\theta}{dt} = -\\frac{\\theta(t)}{R_c + \\frac{1}{hA}}$$\n将其整理成一阶线性齐次常微分方程的标准形式：\n$$\\frac{d\\theta}{dt} + \\left( \\frac{1}{mc(R_c + \\frac{1}{hA})} \\right) \\theta(t) = 0$$\n该方程的形式为 $\\frac{d\\theta}{dt} + \\frac{1}{\\tau}\\theta = 0$，其中 $\\tau$ 是指数衰减的特征时间常数。通过比较，我们确定时间常数 $\\tau$ 为：\n$$\\tau = mc\\left(R_c + \\frac{1}{hA}\\right)$$\n这是时间常数的符号表达式。\n\n**步骤 4：数值计算**\n现在我们将给定的数值代入 $\\tau$ 的表达式中。\n-   $m = 0.25\\ \\text{kg}$\n-   $c = 900\\ \\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$\n-   $R_c = 3.00 \\times 10^{-3}\\ \\text{K}\\,\\text{W}^{-1}$\n-   $h = 200\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n-   $A = 0.020\\ \\text{m}^{2}$\n\n首先，我们计算模块的热容 $C_{th} = mc$：\n$$C_{th} = (0.25\\ \\text{kg})(900\\ \\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}) = 225\\ \\text{J}\\,\\text{K}^{-1}$$\n接下来，我们计算对流热阻 $R_{conv}$：\n$$R_{conv} = \\frac{1}{hA} = \\frac{1}{(200\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1})(0.020\\ \\text{m}^{2})} = \\frac{1}{4.0\\ \\text{W}\\,\\text{K}^{-1}} = 0.25\\ \\text{K}\\,\\text{W}^{-1}$$\n总热阻为：\n$$R_{tot} = R_c + R_{conv} = (3.00 \\times 10^{-3}\\ \\text{K}\\,\\text{W}^{-1}) + (0.25\\ \\text{K}\\,\\text{W}^{-1}) = 0.253\\ \\text{K}\\,\\text{W}^{-1}$$\n最后，我们计算时间常数 $\\tau = C_{th} R_{tot}$：\n$$\\tau = (225\\ \\text{J}\\,\\text{K}^{-1})(0.253\\ \\text{K}\\,\\text{W}^{-1})$$\n检查单位：$[\\text{J}\\,\\text{K}^{-1}] \\times [\\text{K}\\,\\text{W}^{-1}] = [\\text{J}\\,\\text{W}^{-1}] = [\\text{J}\\,({\\text{J}\\,\\text{s}^{-1}})^{-1}] = [\\text{s}]$，对于时间常数来说是正确的。\n$$\\tau = 56.925\\ \\text{s}$$\n问题要求结果四舍五入到四位有效数字。\n$$\\tau \\approx 56.93\\ \\text{s}$$",
            "answer": "$$\\boxed{56.93}$$"
        },
        {
            "introduction": "集总电容法是一个强大的工程近似，但其应用有其前提条件，即毕渥数 $Bi$ 需远小于1。本练习旨在通过定量分析来探究该模型的精度边界 。您将需要推导圆柱体瞬态冷却的集总模型解和基于贝塞尔函数的精确解析解，并通过编写数值算法来计算两种模型在不同 $Bi$ 数下的温度预测差异，从而直观地理解 $Bi$ 数是如何决定集总近似有效性的。",
            "id": "3969227",
            "problem": "考虑一个半径为 $R$ 的实心长圆柱体的瞬态冷却过程。该圆柱体由均匀各向同性材料制成，其热导率为 $k$，密度为 $\\rho$，比热容为 $c$。圆柱体初始温度均匀为 $T_i$，其侧表面突然暴露在温度为 $T_\\infty$ 的充分混合流体中，对流换热系数 $h$ 为常数。假设圆柱体内为一维径向导热，并忽略轴向和周向的温度梯度。定义无量纲温度为 $\\theta(r,t) = \\dfrac{T(r,t) - T_\\infty}{T_i - T_\\infty}$，毕渥数 $\\mathrm{Bi} = \\dfrac{h R}{k}$，傅里叶数 $\\mathrm{Fo} = \\dfrac{\\alpha t}{R^2}$，其中 $\\alpha = \\dfrac{k}{\\rho c}$ 是热扩散率。\n\n从能量守恒和傅里叶导热定律出发，$\\theta(r,t)$ 的控制方程和边界条件如下：\n- 柱坐标系下的瞬态热传导方程（径向对称）：$$\\frac{\\partial \\theta}{\\partial t} = \\alpha \\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial \\theta}{\\partial r}\\right)\\right), \\quad 0 \\le r \\le R, \\ t  0.$$\n- 初始条件：$$\\theta(r,0) = 1, \\quad 0 \\le r \\le R.$$\n- 表面的对流边界条件：$$-k \\left.\\frac{\\partial \\theta}{\\partial r}\\right|_{r=R} = h \\, \\theta(R,t), \\quad t  0.$$\n- 中心线的正则性条件：$$\\left.\\frac{\\partial \\theta}{\\partial r}\\right|_{r=0} = 0, \\quad t  0.$$\n\n集总电容法假设固体内部的温度在空间上保持均匀，从而得到一个关于空间均匀温度 $\\theta(t)$ 的常微分方程。相比之下，中心温度的精确解是通过分离变量法和特征函数展开，求解具有上述边界条件的瞬态热传导方程得到的。\n\n您的任务是：\n- 从第一性原理和给定定义出发，推导集总电容法预测的无量纲温度，以及中心无量纲温度 $\\theta(0,t)$ 的精确特征函数表示（用 $\\mathrm{Bi}$ 和 $\\mathrm{Fo}$ 表示），不得引用或直接使用任何预先推导的结果作为捷径。\n- 实现一个数值算法，通过确定相关的特征值和系数来计算精确的中心温度，然后对相应的特征函数级数进行求值，直到在 $0 \\le \\mathrm{Fo} \\le \\mathrm{Fo}_{\\max}$ 范围内达到收敛精度。\n- 对每个测试用例，计算在 $0 \\le \\mathrm{Fo} \\le \\mathrm{Fo}_{\\max}$ 范围内，集总电容法预测值与精确中心温度之间的最大绝对差。该差值为无量纲，因此不需要物理单位。\n\n测试套件：\n1. 主要用例：$\\mathrm{Bi} = 0.2$，$\\mathrm{Fo}_{\\max} = 1.0$。\n2. 近集总有效性用例：$\\mathrm{Bi} = 0.01$，$\\mathrm{Fo}_{\\max} = 1.0$。\n3. 较强内阻用例：$\\mathrm{Bi} = 1.0$，$\\mathrm{Fo}_{\\max} = 1.0$。\n4. 边界检查用例：$\\mathrm{Bi} = 0.2$，$\\mathrm{Fo}_{\\max} = 0.0$。\n\n算法与输出要求：\n- 您的程序必须是一个完整的、可运行的程序，不需要用户输入，并能自动为测试套件生成结果。\n- 对于集总电容法的预测，从能量平衡推导其控制常微分方程，并用 $\\mathrm{Bi}$ 和 $\\mathrm{Fo}$ 表示其解。\n- 对于精确中心温度，推导分离变量形式，确定由边界条件所蕴含的特征值条件，并构建由正交性确定的系数的级数表示。通过以下方式实现数值解：\n  - 求解特征值条件，得到足以确保中心温度级数在 $0 \\le \\mathrm{Fo} \\le \\mathrm{Fo}_{\\max}$ 范围内收敛的最小 $N$ 个正根。\n  - 从第一性原理（使用适当的权函数进行正交）计算展开系数。\n  - 在足够精细的一组 $\\mathrm{Fo}$ 值上对级数求值，以准确确定最大差值。\n- 您的程序应生成单行输出，其中包含四个计算出的最大差值，格式为逗号分隔的列表并用方括号括起（例如，$$[x_1,x_2,x_3,x_4]$$）。每个 $x_i$ 必须是四舍五入到六位小数的浮点数。\n\n注意：本问题描述中的所有数学实体必须使用 LaTeX 表示法。问题不涉及角度，并且由于结果是无量纲的，因此不需要物理单位。",
            "solution": "问题陈述已经过验证，被认为是合理的。这是一个定义明确的瞬态传热问题，基于已建立的物理原理和数学方法。所有必要的参数和条件都已提供，目标清晰且可形式化。\n\n解答过程主要分为两个部分：首先是对两种温度预测模型（集总电容法和精确级数解）的解析推导，然后是为计算它们之间所需差值而设计的数值算法的描述。\n\n### 第1部分：集总电容模型的推导\n\n集总电容法（Lumped Capacitance Method, LCM）假设物体内部的温度在任何给定时刻在空间上是均匀的，即 $T(r,t) \\approx T(t)$。当内部导热热阻与外部对流换热热阻相比可以忽略不计时，这一假设通常是有效的，这种情况可用小的毕渥数（$\\mathrm{Bi} \\ll 1$）来量化。\n\n我们从圆柱体的积分能量平衡开始，对于一个代表性长度 $L$，其体积为 $V = \\pi R^2 L$，表面积为 $A_s = 2 \\pi R L$。能量守恒原理指出，圆柱体内能的变化率必须等于进入圆柱体的净热流率。\n\n$$ \\frac{dE}{dt} = \\dot{E}_{\\text{in}} - \\dot{E}_{\\text{out}} $$\n\n在这个问题中，热量仅通过表面的对流进行传递。根据牛顿冷却定律，从圆柱体传递到周围流体的热流率为 $\\dot{E}_{\\text{out}} = h A_s (T(t) - T_\\infty)$。内能的变化率为 $\\frac{dE}{dt} = \\rho V c \\frac{dT}{dt}$。\n\n将两者相等得到：\n$$ \\rho V c \\frac{dT}{dt} = -h A_s (T(t) - T_\\infty) $$\n\n代入体积 $V$ 和表面积 $A_s$ 的表达式：\n$$ \\rho (\\pi R^2 L) c \\frac{dT}{dt} = -h (2 \\pi R L) (T(t) - T_\\infty) $$\n\n我们可以消去等式两边的 $\\pi$、$R$ 和 $L$ 来简化方程：\n$$ \\rho R c \\frac{dT}{dt} = -2h (T(t) - T_\\infty) $$\n\n为了进行无量纲化，我们引入无量纲温度 $\\theta(t) = \\frac{T(t) - T_\\infty}{T_i - T_\\infty}$。根据这个定义，我们有 $T(t) - T_\\infty = (T_i - T_\\infty) \\theta(t)$ 和 $\\frac{dT}{dt} = (T_i - T_\\infty) \\frac{d\\theta}{dt}$。将这些代入能量平衡方程：\n$$ \\rho R c (T_i - T_\\infty) \\frac{d\\theta}{dt} = -2h (T_i - T_\\infty) \\theta(t) $$\n\n项 $(T_i - T_\\infty)$ 被消去，得到一个关于 $\\theta(t)$ 的一阶常微分方程：\n$$ \\frac{d\\theta}{dt} = -\\frac{2h}{\\rho c R} \\theta(t) $$\n\n初始条件是 $T(0) = T_i$，换算成 $\\theta(0) = \\frac{T_i - T_\\infty}{T_i - T_\\infty} = 1$。这个初值问题的解是：\n$$ \\theta(t) = \\exp\\left(-\\frac{2h}{\\rho c R} t\\right) $$\n\n为了用毕渥数（$\\mathrm{Bi} = \\frac{hR}{k}$）和傅里叶数（$\\mathrm{Fo} = \\frac{\\alpha t}{R^2} = \\frac{k t}{\\rho c R^2}$）来表示这个解，我们处理指数部分：\n$$ -\\frac{2h}{\\rho c R} t = -2 \\left(\\frac{hR}{k}\\right) \\left(\\frac{k}{\\rho c R^2}\\right) t = -2 \\, \\mathrm{Bi} \\left(\\frac{\\alpha t}{R^2}\\right) = -2 \\, \\mathrm{Bi} \\, \\mathrm{Fo} $$\n\n因此，集总电容法预测的无量纲温度为：\n$$ \\theta_{\\text{lumped}}(\\mathrm{Fo}) = \\exp(-2 \\, \\mathrm{Bi} \\, \\mathrm{Fo}) $$\n\n### 第2部分：中心温度精确解的推导\n\n精确解是通过求解控制偏微分方程及其相关的边界和初始条件得到的。控制方程是在柱坐标系下针对一维径向热流的瞬态热传导方程：\n$$ \\frac{\\partial \\theta}{\\partial t} = \\alpha \\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial \\theta}{\\partial r}\\right)\\right) $$\n\n我们采用分离变量法，假设解的形式为 $\\theta(r,t) = F(r)G(t)$。将其代入偏微分方程得到：\n$$ F(r)\\frac{dG}{dt} = \\alpha G(t) \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{dF}{dr}\\right) $$\n\n分离变量后得到：\n$$ \\frac{1}{\\alpha G} \\frac{dG}{dt} = \\frac{1}{F} \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{dF}{dr}\\right) = -\\lambda^2 $$\n其中 $-\\lambda^2$ 是分离常数。这产生了两个常微分方程。\n\n时间方程为 $\\frac{dG}{dt} = -\\lambda^2 \\alpha G(t)$，其解为 $G(t) = C \\exp(-\\lambda^2 \\alpha t)$。\n\n空间方程为 $r\\frac{d}{dr}\\left(r \\frac{dF}{dr}\\right) + \\lambda^2 r^2 F = 0$，这是零阶贝塞尔方程。其通解为 $F(r) = A J_0(\\lambda r) + B Y_0(\\lambda r)$，其中 $J_0$ 和 $Y_0$ 分别是零阶第一类和第二类贝塞尔函数。\n\n我们应用边界条件来确定常数 $A$、$B$ 和特征值 $\\lambda$。\n1.  **中心线对称性 ($r=0$)**：条件 $\\left.\\frac{\\partial \\theta}{\\partial r}\\right|_{r=0} = 0$ 意味着 $\\left.\\frac{dF}{dr}\\right|_{r=0} = 0$。由于当 $x \\to 0$ 时 $Y_0(x) \\to -\\infty$，其导数也是奇异的。为了在中心保持有限的温度梯度，我们必须设 $B=0$。因此，空间解为 $F(r) = A J_0(\\lambda r)$。\n2.  **表面对流 ($r=R$)**：条件 $-k \\left.\\frac{\\partial \\theta}{\\partial r}\\right|_{r=R} = h \\, \\theta(R,t)$ 变为 $-k \\left.\\frac{dF}{dr}\\right|_{r=R} = h F(R)$。代入 $F(r) = A J_0(\\lambda r)$ 及其导数 $\\frac{dF}{dr} = -A \\lambda J_1(\\lambda r)$：\n    $$ -k (-A \\lambda J_1(\\lambda R)) = h (A J_0(\\lambda R)) $$\n    $$ k \\lambda J_1(\\lambda R) = h J_0(\\lambda R) $$\n    整理后得到特征值 $\\lambda_n$ 的超越方程：\n    $$ \\frac{\\lambda_n R J_1(\\lambda_n R)}{J_0(\\lambda_n R)} = \\frac{hR}{k} $$\n    令 $\\zeta_n = \\lambda_n R$，这变成了无量纲形式的特征值方程：\n    $$ \\zeta_n \\frac{J_1(\\zeta_n)}{J_0(\\zeta_n)} = \\mathrm{Bi} $$\n    对于给定的 $\\mathrm{Bi}$，该方程有无穷多个正的离散根 $\\zeta_n$，$n=1, 2, 3, \\ldots$。\n\n完整解是所有可能的乘积解的叠加：\n$$ \\theta(r,t) = \\sum_{n=1}^\\infty C_n \\exp(-\\lambda_n^2 \\alpha t) J_0(\\lambda_n r) $$\n我们将指数用傅里叶数表示：$\\lambda_n^2 \\alpha t = (\\frac{\\zeta_n}{R})^2 \\alpha t = \\zeta_n^2 (\\frac{\\alpha t}{R^2}) = \\zeta_n^2 \\mathrm{Fo}$。\n解变为：\n$$ \\theta(r,t) = \\sum_{n=1}^\\infty C_n \\exp(-\\zeta_n^2 \\mathrm{Fo}) J_0\\left(\\zeta_n \\frac{r}{R}\\right) $$\n\n系数 $C_n$ 由初始条件 $\\theta(r,0) = 1$ 确定：\n$$ 1 = \\sum_{n=1}^\\infty C_n J_0\\left(\\zeta_n \\frac{r}{R}\\right) $$\n这是函数 $f(r)=1$ 的傅里叶-贝塞尔级数展开。特征函数 $J_0(\\lambda_n r)$ 在区间 $[0, R]$ 上关于权函数 $r$ 是正交的。为了找到特定系数 $C_n$，我们将方程两边乘以 $r J_0(\\lambda_n r)$ 并从 $0$ 到 $R$ 积分：\n$$ \\int_0^R r J_0(\\lambda_n r) dr = C_n \\int_0^R r J_0^2(\\lambda_n r) dr $$\n$$ C_n = \\frac{\\int_0^R r J_0(\\lambda_n r) dr}{\\int_0^R r J_0^2(\\lambda_n r) dr} $$\n\n这些是标准形式的积分：\n-   分子：使用恒等式 $\\frac{d}{dx}(x J_1(x))=x J_0(x)$，我们有 $\\int x J_0(x) dx = x J_1(x)$。\n    $$ \\int_0^R r J_0(\\lambda_n r) dr = \\frac{1}{\\lambda_n^2} \\int_0^{\\lambda_n R} u J_0(u) du = \\frac{1}{\\lambda_n^2} [\\lambda_n R J_1(\\lambda_n R)] = \\frac{R}{\\lambda_n} J_1(\\lambda_n R) $$\n-   分母：标准积分为 $\\int x J_0^2(\\alpha x) dx = \\frac{x^2}{2} (J_0^2(\\alpha x) + J_1^2(\\alpha x))$。\n    $$ \\int_0^R r J_0^2(\\lambda_n r) dr = \\frac{R^2}{2} (J_0^2(\\lambda_n R) + J_1^2(\\lambda_n R)) $$\n\n代入这些结果和 $\\zeta_n = \\lambda_n R$：\n$$ C_n = \\frac{\\frac{R^2}{\\zeta_n} J_1(\\zeta_n)}{\\frac{R^2}{2} (J_0^2(\\zeta_n) + J_1^2(\\zeta_n))} = \\frac{2 J_1(\\zeta_n)}{\\zeta_n (J_0^2(\\zeta_n) + J_1^2(\\zeta_n))} $$\n使用特征值方程进行简化，$J_1(\\zeta_n) = \\frac{\\mathrm{Bi}}{\\zeta_n} J_0(\\zeta_n)$：\n$$ C_n = \\frac{2 (\\frac{\\mathrm{Bi}}{\\zeta_n} J_0(\\zeta_n))}{\\zeta_n (J_0^2(\\zeta_n) + (\\frac{\\mathrm{Bi}}{\\zeta_n})^2 J_0^2(\\zeta_n))} = \\frac{2 \\mathrm{Bi} J_0(\\zeta_n)}{\\zeta_n^2 J_0^2(\\zeta_n) (1 + (\\frac{\\mathrm{Bi}}{\\zeta_n})^2)} = \\frac{2 \\mathrm{Bi}}{(\\zeta_n^2 + \\mathrm{Bi}^2) J_0(\\zeta_n)} $$\n\n问题要求的是中心温度 $\\theta(0,t)$。由于 $J_0(0)=1$，精确中心温度的级数为：\n$$ \\theta_{\\text{exact}}(0, \\mathrm{Fo}) = \\sum_{n=1}^\\infty \\frac{2 \\mathrm{Bi}}{(\\zeta_n^2 + \\mathrm{Bi}^2) J_0(\\zeta_n)} \\exp(-\\zeta_n^2 \\mathrm{Fo}) $$\n\n### 第3部分：数值算法\n\n为了计算集总解与精确解之间的最大绝对差 $|\\theta_{\\text{lumped}}(\\mathrm{Fo}) - \\theta_{\\text{exact}}(0, \\mathrm{Fo})|$（在区间 $0 \\le \\mathrm{Fo} \\le \\mathrm{Fo}_{\\max}$ 内），实现了以下数值过程：\n1.  **特征值计算**：对于给定的 $\\mathrm{Bi}$，确定特征值方程 $\\zeta J_1(\\zeta) - \\mathrm{Bi} J_0(\\zeta) = 0$ 的前 $N$ 个正根 $\\zeta_n$。这是一个求根问题。根位于 $J_0$ 贝塞尔函数的零点之间。具体来说，第 $n$ 个根 $\\zeta_n$ 位于区间 $(j_{0,n-1}, j_{0,n})$ 内，其中 $j_{0,n}$ 是 $J_0(x)$ 的第 $n$ 个零点，且 $j_{0,0}=0$。使用像 Brent 法这样的区间法数值求解这些根。使用足够多的根（例如 $N=100$）以确保级数收敛到所需精度。\n2.  **级数求值**：使用推导出的公式计算系数 $C_n$。然后，在区间 $[0, \\mathrm{Fo}_{\\max}]$ 的精细离散网格上，通过对级数的前 $N$ 项求和来计算每个 $\\mathrm{Fo}$ 值对应的精确中心温度 $\\theta_{\\text{exact}}(0, \\mathrm{Fo})$。指数项 $\\exp(-\\zeta_n^2 \\mathrm{Fo})$ 确保了当 $\\mathrm{Fo}  0$ 时级数的快速收敛。\n3.  **差值计算**：在相同的 $\\mathrm{Fo}$ 值网格上计算集总电容解 $\\theta_{\\text{lumped}}(\\mathrm{Fo})$。计算网格中每个点上两个解的绝对差。\n4.  **最大值**：确定整个网格上该绝对差的最大值，并将其作为给定测试用例的结果报告。对于 $\\mathrm{Fo}_{\\max}=0$ 的特殊情况，区间只包含 $\\mathrm{Fo}=0$ 一点。此时，$\\theta_{\\text{lumped}}(0)$ 和 $\\theta_{\\text{exact}}(0,0)$（即 $\\sum C_n$）都等于 $1$，因此差值为 $0$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import j0, j1, jn_zeros\nfrom scipy.optimize import brentq\n\ndef solve_case(Bi, Fo_max, N_roots=100, N_fo_pts=2001):\n    \"\"\"\n    Computes the maximum absolute difference between the lumped capacitance\n    and exact center temperature solutions for a cooling cylinder.\n\n    Args:\n        Bi (float): Biot number.\n        Fo_max (float): Maximum Fourier number for the analysis range.\n        N_roots (int): Number of eigenvalues to compute for the series solution.\n        N_fo_pts (int): Number of points to discretize the Fourier number range.\n\n    Returns:\n        float: The maximum absolute difference over 0 = Fo = Fo_max.\n    \"\"\"\n    # Handle the trivial case where Fo_max is 0.\n    # At Fo=0, both solutions are 1, so the difference is 0.\n    if Fo_max == 0.0:\n        return 0.0\n\n    # Step 1: Find eigenvalues (roots of zeta*J1(zeta) - Bi*J0(zeta) = 0)\n    def eigenvalue_eq(zeta):\n        # The transcendental equation for eigenvalues.\n        return zeta * j1(zeta) - Bi * j0(zeta)\n\n    # The roots zeta_n are bracketed by the zeros of J0. We find N_roots zeros\n    # to establish search intervals for our N_roots eigenvalues.\n    j0_z = jn_zeros(0, N_roots)\n    \n    zeta_n = np.zeros(N_roots)\n    eps = 1e-9  # Small offset to avoid singularities at interval boundaries\n\n    # The first root zeta_1 is in the interval (0, j0_z[0]).\n    try:\n        zeta_n[0] = brentq(eigenvalue_eq, eps, j0_z[0] - eps)\n    except ValueError:\n        # If the root is extremely close to the boundary, brentq might fail.\n        # Retry without the epsilon offset.\n        zeta_n[0] = brentq(eigenvalue_eq, eps, j0_z[0])\n\n    # The subsequent roots zeta_n are in (j0_z[n-2], j0_z[n-1]) for n>1.\n    for i in range(1, N_roots):\n        lower_bound = j0_z[i-1] + eps\n        upper_bound = j0_z[i] - eps\n        try:\n            zeta_n[i] = brentq(eigenvalue_eq, lower_bound, upper_bound)\n        except ValueError:\n            zeta_n[i] = brentq(eigenvalue_eq, j0_z[i-1], j0_z[i])\n    \n    # Step 2: Compute coefficients Cn for the series solution.\n    zeta_n_sq = zeta_n**2\n    j0_of_zeta_n = j0(zeta_n)\n    Cn = (2 * Bi) / ((zeta_n_sq + Bi**2) * j0_of_zeta_n)\n    \n    # Step 3: Evaluate lumped and exact solutions over the Fo range.\n    Fo_range = np.linspace(0, Fo_max, N_fo_pts)\n    \n    # Lumped solution: theta_lumped = exp(-2*Bi*Fo)\n    theta_lumped = np.exp(-2 * Bi * Fo_range)\n    \n    # Exact solution: theta_exact = sum(Cn * exp(-zeta_n^2 * Fo))\n    # We use broadcasting for an efficient calculation.\n    # np.outer creates a matrix of (zeta_n_sq[i] * Fo_range[j]) values.\n    exp_terms = np.exp(-np.outer(zeta_n_sq, Fo_range))\n    # np.dot multiplies Cn vector with the exp_terms matrix and sums columns.\n    theta_exact = np.dot(Cn, exp_terms)\n    \n    # Step 4: Compute the maximum absolute difference.\n    abs_diff = np.abs(theta_lumped - theta_exact)\n    \n    return np.max(abs_diff)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement: (Bi, Fo_max)\n    test_cases = [\n        (0.2, 1.0),\n        (0.01, 1.0),\n        (1.0, 1.0),\n        (0.2, 0.0),\n    ]\n\n    results = []\n    for Bi, Fo_max in test_cases:\n        max_diff = solve_case(Bi, Fo_max)\n        results.append(f\"{max_diff:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "建立集总模型的常微分方程（ODE）只是分析的第一步；对于复杂的时变边界条件，我们通常需要依赖数值方法求解。本练习的核心是集总模型ODE的数值求解与验证过程 。您将为集总系统实现一个前向欧拉时间步进格式的求解器，并将其计算结果与阶跃和正弦输入的解析解进行比较，进而通过收敛性研究来评估数值方法的精度阶，这是计算工程中的一项基本技能。",
            "id": "3969242",
            "problem": "一个空间上等温、物性均匀的固体与温度随时间变化的周围流体进行热交换。从应用于均匀温度控制质量的热力学第一定律出发，推导固体在与周围流体进行对流换热作用下其温度的控制常微分方程 (ODE)。然后，使用此 ODE，获取两种输入情况下的解析解：$t=0$ 时流体温度的阶跃变化和流体温度的正弦变化。实现一个使用显式前向欧拉时间步进格式的计算求解器来近似固体的温度演化，并通过与解析解的比较来验证计算实现。最后，通过估计观测到的精度阶，进行关于时间步长的收敛性研究。\n\n物理设置和参数如下：\n- 固体密度为 $\\rho$ (单位 $\\mathrm{kg/m^3}$)，比热容为 $c$ (单位 $\\mathrm{J/(kg\\,K)}$)，体积为 $V$ (单位 $\\mathrm{m^3}$)，表面积为 $A$ (单位 $\\mathrm{m^2}$)，与温度随时间变化的周围流体 $T_\\infty(t)$ (单位 $\\mathrm{K}$) 进行对流换热，传热系数为 $h$ (单位 $\\mathrm{W/(m^2\\,K)}$)。固体的初始温度为 $T(0)=T_0$ (单位 $\\mathrm{K}$)。正弦输入中的角度必须解释为弧度，角频率 $\\omega$ 的单位为 $\\mathrm{rad/s}$。\n- 集总电容法假设必须通过毕渥数 $Bi=h L_c/k \\ll 0.1$ 来验证（其中 $L_c$ 为特征长度，$k$ 为热导率），但为本问题之目的，您将假设此条件已满足，并专注于瞬态分析。\n\n您必须：\n1. 从热力学第一定律推导控制 ODE，并用 $\\rho$、$c$、$V$、$A$ 和 $h$ 表示时间常数 $\\tau$ (单位 $\\mathrm{s}$)。\n2. 推导以下情况的解析解：\n   - 阶跃输入 $T_\\infty(t)$，其中 $t  0$ 时 $T_\\infty(t)=T_0$，$t\\ge 0$ 时 $T_\\infty(t)=T_\\mathrm{step}$。\n   - 正弦输入 $T_\\infty(t)=T_\\mathrm{mean}+T_\\mathrm{amp}\\,\\sin(\\omega t)$，其中 $t\\ge 0$。\n   所有温度以 $\\mathrm{K}$ 表示，时间以 $\\mathrm{s}$ 表示。\n3. 实现一个时间步长为 $\\Delta t$ 的显式前向欧拉格式来近似 $T(t)$。使用相同的离散时间网格评估解析解以计算误差。对于每个 $\\Delta t$，计算在模拟时间范围内的最大绝对误差（单位 $\\mathrm{K}$）。\n4. 对于每个测试用例（定义如下），通过对给定的一组 $\\Delta t$ 值，对 $\\log(e)$ 与 $\\log(\\Delta t)$ 进行最小二乘拟合，来估计观测到的精度阶 $p$，其中 $e$ 表示最大绝对误差。将 $p$ 报告为一个无量纲浮点数。\n\n测试套件：\n- 用例 $1$ (理想情况，中等时间常数和中等正弦频率)：\n  - $\\rho=2700\\,\\mathrm{kg/m^3}$，$c=900\\,\\mathrm{J/(kg\\,K)}$，$V=5\\times 10^{-5}\\,\\mathrm{m^3}$，$A=0.05\\,\\mathrm{m^2}$，$h=200\\,\\mathrm{W/(m^2\\,K)}$。\n  - $T_0=300\\,\\mathrm{K}$，$T_\\mathrm{step}=310\\,\\mathrm{K}$，$T_\\mathrm{mean}=300\\,\\mathrm{K}$，$T_\\mathrm{amp}=5\\,\\mathrm{K}$，$\\omega=0.5\\,\\mathrm{rad/s}$。\n  - 使用三个时间步长 $\\Delta t$，分别为 $\\tau/80$、$\\tau/40$、$\\tau/20$。\n  - 在 $t\\in[0,\\,5\\tau]$ 上模拟阶跃情况，在 $t\\in[0,\\,\\max(5\\tau,\\,10\\times 2\\pi/\\omega)]$ 上模拟正弦情况。\n- 用例 $2$ (较小时间常数，较高正弦频率)：\n  - $\\rho=1000\\,\\mathrm{kg/m^3}$，$c=4180\\,\\mathrm{J/(kg\\,K)}$，$V=10^{-6}\\,\\mathrm{m^3}$，$A=0.01\\,\\mathrm{m^2}$，$h=800\\,\\mathrm{W/(m^2\\,K)}$。\n  - $T_0=300\\,\\mathrm{K}$，$T_\\mathrm{step}=308\\,\\mathrm{K}$，$T_\\mathrm{mean}=300\\,\\mathrm{K}$，$T_\\mathrm{amp}=3\\,\\mathrm{K}$，$\\omega=5.0\\,\\mathrm{rad/s}$。\n  - 使用三个时间步长 $\\Delta t$，分别为 $\\tau/100$、$\\tau/50$、$\\tau/25$。\n  - 在 $t\\in[0,\\,5\\tau]$ 上模拟阶跃情况，在 $t\\in[0,\\,\\max(5\\tau,\\,10\\times 2\\pi/\\omega)]$ 上模拟正弦情况。\n- 用例 $3$ (较大时间常数，较低正弦频率)：\n  - $\\rho=7800\\,\\mathrm{kg/m^3}$，$c=500\\,\\mathrm{J/(kg\\,K)}$，$V=2\\times 10^{-4}\\,\\mathrm{m^3}$，$A=0.03\\,\\mathrm{m^2}$，$h=50\\,\\mathrm{W/(m^2\\,K)}$。\n  - $T_0=300\\,\\mathrm{K}$，$T_\\mathrm{step}=315\\,\\mathrm{K}$，$T_\\mathrm{mean}=300\\,\\mathrm{K}$，$T_\\mathrm{amp}=10\\,\\mathrm{K}$，$\\omega=0.05\\,\\mathrm{rad/s}$。\n  - 使用三个时间步长 $\\Delta t$，分别为 $\\tau/64$、$\\tau/16$、$\\tau/8$。\n  - 在 $t\\in[0,\\,5\\tau]$ 上模拟阶跃情况，在 $t\\in[0,\\,\\max(5\\tau,\\,10\\times 2\\pi/\\omega)]$ 上模拟正弦情况。\n- 用例 $4$ (接近显式欧拉格式齐次部分稳定性边界的边界情况)：\n  - 使用与用例 1 相同的材料和输入参数。\n  - 使用三个时间步长 $\\Delta t$，分别为 $1.95\\,\\tau$、$1.80\\,\\tau$、$1.60\\,\\tau$。\n  - 模拟时间范围与用例 1 相同。\n\n最终输出格式要求：\n- 您的程序应产生一行输出，包含用方括号括起来的逗号分隔的结果列表，顺序为\n  $[p_{\\mathrm{step},1},p_{\\mathrm{sin},1},p_{\\mathrm{step},2},p_{\\mathrm{sin},2},p_{\\mathrm{step},3},p_{\\mathrm{sin},3},p_{\\mathrm{step},4},p_{\\mathrm{sin},4}]$,\n  其中 $p_{\\mathrm{step},i}$ 是用例 $i$ 中阶跃输入的观测精度阶，$p_{\\mathrm{sin},i}$ 是用例 $i$ 中正弦输入的观测精度阶。每个 $p$ 必须是浮点数（无量纲）。",
            "solution": "该问题具有科学依据，提法得当，且为获得唯一且有意义的解提供了所有必要的数据和条件。任务内容与瞬态传热分析中的标准解析和数值方法一致。因此，该问题被认为是有效的，下面给出了完整的解答。\n\n### I. 控制常微分方程 (ODE) 的推导\n\n分析始于将热力学第一定律应用于被视为具有均匀温度 $T(t)$ 的控制质量的固体。能量平衡由下式给出：\n$$\n\\frac{dE}{dt} = \\dot{Q} - \\dot{W}\n$$\n其中 $E$ 是固体的内能，$\\dot{Q}$ 是进入固体的净传热速率，$\\dot{W}$ 是固体对外做功的速率。对于不发生膨胀或其他产生功过程的固体，$\\dot{W}=0$。\n\n固体的内能是其温度的函数，$E = m c T$，其中 $m$ 是质量，$c$ 是比热容。质量可以用密度 $\\rho$ 和体积 $V$ 表示为 $m = \\rho V$。因此，内能的变化率为：\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} (\\rho V c T) = \\rho V c \\frac{dT}{dt}\n$$\n此处假设 $\\rho$、$V$ 和 $c$ 是常数。\n\n热量通过对流与周围流体交换。根据牛顿冷却定律，传热速率为：\n$$\n\\dot{Q} = h A (T_\\infty(t) - T(t))\n$$\n其中 $h$ 是对流传热系数，$A$ 是固体的表面积，$T_\\infty(t)$ 是周围流体随时间变化的温度。\n\n将内能变化率与传热速率相等，得到控制微分方程：\n$$\n\\rho V c \\frac{dT}{dt} = h A (T_\\infty(t) - T(t))\n$$\n将此方程重排为一阶线性 ODE 的标准形式，得到：\n$$\n\\frac{dT}{dt} + \\frac{h A}{\\rho V c} T(t) = \\frac{h A}{\\rho V c} T_\\infty(t)\n$$\n这个 ODE 描述了集总质量的温度演化 $T(t)$。乘以 $T(t)$ 的项是系统热时间常数 $\\tau$ 的倒数。时间常数定义为：\n$$\n\\tau = \\frac{\\rho V c}{h A}\n$$\n$\\tau$ 的单位是秒 ($\\mathrm{s}$)。将 $\\tau$ 代入 ODE，得到其最终形式：\n$$\n\\frac{dT}{dt} + \\frac{1}{\\tau} T(t) = \\frac{1}{\\tau} T_\\infty(t)\n$$\n\n### II. 解析解的推导\n\n$T(t)$ 的解析解取决于强迫函数 $T_\\infty(t)$ 的形式和初始条件 $T(0) = T_0$。\n\n#### A. 流体温度的阶跃变化\n对于阶跃变化，当 $t \\ge 0$ 时，流体温度是恒定的：$T_\\infty(t) = T_\\mathrm{step}$。ODE 变为：\n$$\n\\frac{dT}{dt} + \\frac{1}{\\tau} T = \\frac{1}{\\tau} T_\\mathrm{step}\n$$\n为求解此方程，我们可以定义温差 $\\theta(t) = T(t) - T_\\mathrm{step}$。其导数为 $\\frac{d\\theta}{dt} = \\frac{dT}{dt}$。代入 ODE 得到：\n$$\n\\frac{d\\theta}{dt} + \\frac{1}{\\tau}(\\theta + T_\\mathrm{step}) = \\frac{1}{\\tau} T_\\mathrm{step} \\implies \\frac{d\\theta}{dt} + \\frac{1}{\\tau}\\theta = 0\n$$\n这是一个齐次一阶 ODE，其解为 $\\theta(t) = C e^{-t/\\tau}$。代回 $T(t)$：\n$$\nT(t) - T_\\mathrm{step} = C e^{-t/\\tau}\n$$\n常数 $C$ 由初始条件 $T(0) = T_0$ 确定：\n$$\nT_0 - T_\\mathrm{step} = C e^0 \\implies C = T_0 - T_\\mathrm{step}\n$$\n因此，阶跃输入的解析解为：\n$$\nT(t) = T_\\mathrm{step} + (T_0 - T_\\mathrm{step}) e^{-t/\\tau}\n$$\n\n#### B. 流体温度的正弦变化\n对于正弦变化，流体温度为 $T_\\infty(t) = T_\\mathrm{mean} + T_\\mathrm{amp} \\sin(\\omega t)$。ODE 为：\n$$\n\\frac{dT}{dt} + \\frac{1}{\\tau} T = \\frac{1}{\\tau} (T_\\mathrm{mean} + T_\\mathrm{amp} \\sin(\\omega t))\n$$\n解是齐次解 ($T_h$) 和特解 ($T_p$) 的和。齐次解对应于初始条件的衰减，为 $T_h(t) = K e^{-t/\\tau}$。\n对于特解，我们假设一个与强迫函数形式相匹配的形式：$T_p(t) = C_1 + C_2 \\sin(\\omega t) + C_3 \\cos(\\omega t)$。将其代入 ODE 并匹配常数项、$\\sin(\\omega t)$ 和 $\\cos(\\omega t)$ 项的系数，得到常数：\n$$\nC_1 = T_\\mathrm{mean}\n$$\n$$\nC_2 = \\frac{T_\\mathrm{amp}}{1 + (\\omega\\tau)^2}\n$$\n$$\nC_3 = -\\frac{\\omega\\tau T_\\mathrm{amp}}{1 + (\\omega\\tau)^2}\n$$\n代表长期稳态周期响应的特解是：\n$$\nT_p(t) = T_\\mathrm{mean} + \\frac{T_\\mathrm{amp}}{1 + (\\omega\\tau)^2} \\left( \\sin(\\omega t) - \\omega\\tau \\cos(\\omega t) \\right)\n$$\n通解为 $T(t) = T_h(t) + T_p(t) = K e^{-t/\\tau} + T_p(t)$。常数 $K$ 使用初始条件 $T(0) = T_0$ 求得：\n$$\nT_0 = K + T_p(0) = K + T_\\mathrm{mean} + \\frac{T_\\mathrm{amp}}{1 + (\\omega\\tau)^2} \\left( \\sin(0) - \\omega\\tau \\cos(0) \\right)\n$$\n$$\nT_0 = K + T_\\mathrm{mean} - \\frac{\\omega\\tau T_\\mathrm{amp}}{1 + (\\omega\\tau)^2} \\implies K = T_0 - T_\\mathrm{mean} + \\frac{\\omega\\tau T_\\mathrm{amp}}{1 + (\\omega\\tau)^2}\n$$\n正弦输入的完整解析解为：\n$$\nT(t) = \\left( T_0 - T_\\mathrm{mean} + \\frac{\\omega\\tau T_\\mathrm{amp}}{1 + (\\omega\\tau)^2} \\right) e^{-t/\\tau} + T_\\mathrm{mean} + \\frac{T_\\mathrm{amp}}{1 + (\\omega\\tau)^2} (\\sin(\\omega t) - \\omega\\tau \\cos(\\omega t))\n$$\n\n### III. 数值实现与收敛性研究\n\n使用显式前向欧拉法对控制 ODE 进行离散化。导数 $\\frac{dT}{dt}$ 由向前差分近似：\n$$\n\\frac{T_{n+1} - T_n}{\\Delta t} \\approx \\left. \\frac{dT}{dt} \\right|_n = \\frac{1}{\\tau} (T_\\infty(t_n) - T_n)\n$$\n其中 $T_n \\approx T(t_n)$ 且 $t_n = n \\Delta t$。为 $T_{n+1}$ 重新整理，得到时间步进算法：\n$$\nT_{n+1} = T_n + \\frac{\\Delta t}{\\tau} (T_\\infty(t_n) - T_n)\n$$\n或等效地：\n$$\nT_{n+1} = T_n \\left(1 - \\frac{\\Delta t}{\\tau}\\right) + T_\\infty(t_n) \\frac{\\Delta t}{\\tau}\n$$\n该算法针对阶跃和正弦输入两种情况实现。对于给定的时间步长 $\\Delta t$，在离散时间网格上生成数值解。解析解在同一网格上进行评估。在模拟时间范围内计算最大绝对误差 $e$：\n$$\ne = \\max_{n} |T_{\\text{analytic}}(t_n) - T_{\\text{numerical},n}|\n$$\n前向欧拉法的理论全局误差与时间步长成线性关系，即 $e \\propto (\\Delta t)^p$，精度阶为 $p=1$。为验证这一点，我们进行收敛性研究。对于一组三个时间步长 $\\Delta t_i$ 及其对应的最大误差 $e_i$，我们可以写出：\n$$\n\\log(e_i) \\approx \\log(C) + p \\log(\\Delta t_i)\n$$\n这表明 $\\log(e)$ 和 $\\log(\\Delta t)$ 之间存在线性关系，其斜率即为精度阶 $p$。我们通过对点集 $(\\log(\\Delta t_i), \\log(e_i))$ 进行线性最小二乘拟合来估计 $p$。将此过程应用于每个测试用例，以确定阶跃和正弦输入的观测精度阶。",
            "answer": "```python\nimport numpy as np\n\ndef run_convergence_study(tau, dt_factors, t_final, T0, T_inf_func, analytic_func):\n    \"\"\"\n    Performs a convergence study for a given problem configuration.\n\n    Args:\n        tau (float): The system thermal time constant.\n        dt_factors (list of float): Factors to multiply tau by to get time steps.\n        t_final (float): The final simulation time.\n        T0 (float): The initial temperature.\n        T_inf_func (callable): Function T_inf(t) for the fluid temperature.\n        analytic_func (callable): Function T_analytic(t) for the exact solution.\n\n    Returns:\n        float: The observed order of accuracy p.\n    \"\"\"\n    log_dts = []\n    log_errors = []\n\n    for factor in dt_factors:\n        dt = factor * tau\n        # Ensure the time grid includes the full range including the endpoint,\n        # robust to floating point inaccuracies.\n        t = np.arange(0, t_final + dt/2, dt)\n        if t.size > 0 and t[-1] > t_final:\n            t = t[:-1]\n\n        if t.size == 0: continue\n\n        num_steps = len(t)\n        T_numerical = np.zeros(num_steps)\n        T_numerical[0] = T0\n\n        # Forward Euler time-stepping\n        for n in range(num_steps - 1):\n            T_inf_n = T_inf_func(t[n])\n            T_numerical[n+1] = T_numerical[n] * (1 - dt/tau) + T_inf_n * (dt/tau)\n\n        # Evaluate analytic solution and error\n        T_analytic = analytic_func(t)\n        max_error = np.max(np.abs(T_analytic - T_numerical))\n        \n        if max_error > 1e-12: # Avoid log(0) for very small or zero errors\n            log_dts.append(np.log(dt))\n            log_errors.append(np.log(max_error))\n\n    # Perform least-squares fit for the order of accuracy p (slope)\n    if len(log_dts)  2:\n        # Cannot perform fit, return NaN or a marker for failure\n        return np.nan\n        \n    p, _ = np.polyfit(log_dts, log_errors, 1)\n    \n    return p\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and produce the final output.\n    \"\"\"\n    test_cases = [\n        {\n            # Case 1 (happy path)\n            'rho': 2700, 'c': 900, 'V': 5e-5, 'A': 0.05, 'h': 200,\n            'T0': 300, 'T_step': 310, 'T_mean': 300, 'T_amp': 5, 'omega': 0.5,\n            'dt_factors': [1/80, 1/40, 1/20]\n        },\n        {\n            # Case 2 (smaller tau, higher omega)\n            'rho': 1000, 'c': 4180, 'V': 1e-6, 'A': 0.01, 'h': 800,\n            'T0': 300, 'T_step': 308, 'T_mean': 300, 'T_amp': 3, 'omega': 5.0,\n            'dt_factors': [1/100, 1/50, 1/25]\n        },\n        {\n            # Case 3 (large tau, lower omega)\n            'rho': 7800, 'c': 500, 'V': 2e-4, 'A': 0.03, 'h': 50,\n            'T0': 300, 'T_step': 315, 'T_mean': 300, 'T_amp': 10, 'omega': 0.05,\n            'dt_factors': [1/64, 1/16, 1/8]\n        },\n        {\n            # Case 4 (edge case, stability boundary)\n            'rho': 2700, 'c': 900, 'V': 5e-5, 'A': 0.05, 'h': 200,\n            'T0': 300, 'T_step': 310, 'T_mean': 300, 'T_amp': 5, 'omega': 0.5,\n            'dt_factors': [1.60, 1.80, 1.95] # Note: reversed for increasing dt\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        # Unpack parameters\n        rho, c, V, A, h = case['rho'], case['c'], case['V'], case['A'], case['h']\n        T0, T_step = case['T0'], case['T_step']\n        T_mean, T_amp, omega = case['T_mean'], case['T_amp'], case['omega']\n        dt_factors = sorted(case['dt_factors']) # ensure dt increases\n\n        # Calculate thermal time constant\n        tau = (rho * V * c) / (h * A)\n\n        # --- Step Input Analysis ---\n        t_final_step = 5 * tau\n        T_inf_step = lambda t: T_step\n        analytic_step = lambda t: T_step + (T0 - T_step) * np.exp(-t/tau)\n        \n        p_step = run_convergence_study(tau, dt_factors, t_final_step, T0, T_inf_step, analytic_step)\n        all_results.append(p_step)\n        \n        # --- Sinusoidal Input Analysis ---\n        t_final_sin = max(5 * tau, 10 * 2 * np.pi / omega if omega > 0 else 5 * tau)\n        \n        # Define T_inf and analytic solution functions\n        wt = omega * tau\n        C_transient = T0 - T_mean + (wt * T_amp) / (1 + wt**2)\n        \n        T_inf_sin = lambda t: T_mean + T_amp * np.sin(omega * t)\n        analytic_sin = lambda t: C_transient * np.exp(-t/tau) + T_mean + \\\n                                 (T_amp / (1 + wt**2)) * (np.sin(omega*t) - wt * np.cos(omega*t))\n\n        p_sin = run_convergence_study(tau, dt_factors, t_final_sin, T0, T_inf_sin, analytic_sin)\n        all_results.append(p_sin)\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}