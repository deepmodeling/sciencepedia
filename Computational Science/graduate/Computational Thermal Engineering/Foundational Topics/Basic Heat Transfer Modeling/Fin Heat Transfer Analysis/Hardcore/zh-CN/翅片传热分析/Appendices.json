{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的计算方法之前，建立坚实的解析基础至关重要。解析解不仅为我们提供了对潜在物理现象的深刻理解，也为验证数值模拟的准确性设立了基准。此练习旨在推导两种常见边界条件下（绝热翅片尖端和对流翅片尖端）的精确温度分布，并促使我们深入理解关键无量纲参数 $mL$ 如何影响翅片性能 。",
            "id": "3953803",
            "problem": "一个横截面积为 $A_{c}$、周长为 $P$ 的均匀、细长、棱柱形鳍片，连接在一个位于 $x=0$ 的大型等温基座上，并延伸至 $x=L$ 的端部。该鳍片由均匀、各向同性的固体材料制成，其热导率 $k$ 与温度无关。基座温度维持在 $T_{b}$，周围流体温度为 $T_{\\infty}$。鳍片的侧表面通过对流与周围流体进行热交换，其传热系数 $h$ 在空间上是均匀的。鳍片端部（位于 $x=L$）考虑两种不同的边界条件：(i) 绝热，以及 (ii) 在端部面积等于横截面积（即 $A_{t}=A_{c}$）的情况下，以相同的传热系数 $h$ 进行对流。假设沿 $x$ 方向为一维稳态热传导，轴向热生成可忽略，辐射可忽略。\n\n仅从傅里叶热传导定律和牛顿冷却定律出发，为过余温度 $\\theta(x) \\equiv T(x)-T_{\\infty}$ 建立一维控制方程，并为两种情况分别写出在基座和端部的适当边界条件。求解该边值问题的闭式解，并对(i)绝热端部和(ii)对流端部两种情况，求出鳍片端部温度分数 $\\theta(L)/\\theta_{b}$，其中 $\\theta_{b}\\equiv T_{b}-T_{\\infty}$。将你的两个结果表示为关于鳍片参数 $m$ 和 $L$ 的解析表达式，其中 $m$ 在你的推导中自然产生，对于对流端部，尽可能用 $m$、$A_{c}$、$P$ 和 $L$ 来消除 $h$。然后，在你的推导中简要解释在 $mL \\to 0$ 和 $mL \\to \\infty$ 的极限情况下，端部温度分数如何依赖于无量纲乘积 $mL$。\n\n你的最终答案必须将两个端部温度分数以一个单行排列的解析表达式形式提供，使用 LaTeX 的 $pmatrix$ 环境，左边的项对应绝热端部，右边的项对应对流端部。不需要进行数值计算，也无需四舍五入。最终答案中不要包含单位。",
            "solution": "此问题要求推导并求解具有恒定物性的一维稳态鳍片热传导方程，然后分析两种不同边界条件下的端部温度。\n\n首先，对问题进行验证。\n\n### 步骤1：提取已知条件\n- 几何形状：均匀横截面积 $A_c$、周长 $P$、长度 $L$ 的直棱柱形鳍片。\n- 基座：在 $x=0$ 处，温度为 $T_b$。\n- 材料：均匀、各向同性，具有恒定的热导率 $k$。\n- 环境：周围流体温度为 $T_{\\infty}$。\n- 热传递：侧表面具有均匀的对流传热系数 $h$。\n- 端部 ($x=L$) 条件：\n  - (i) 绝热。\n  - (ii) 在端部面积 $A_t=A_c$ 上，以传热系数 $h$ 进行对流。\n- 假设：一维稳态热传导，无内部热生成，辐射可忽略。\n- 定义：过余温度 $\\theta(x) \\equiv T(x)-T_{\\infty}$ 和基座过余温度 $\\theta_b \\equiv T_b-T_{\\infty}$。\n- 任务：推导 $\\theta(x)$ 的控制方程，陈述边界条件，求解两种情况下端部温度分数 $\\theta(L)/\\theta_b$（用 $m$ 和 $L$ 表示），并解释极限情况。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是扩展表面热传递的一个典型例子，基于傅里叶定律和牛顿冷却定律。所作的假设是获得解析解的标准假设。该问题在科学上是合理的。\n- **适定的**：这是一个二阶线性常微分方程（ODE），对于两个独立的情况中的每一种都指定了两个边界条件。这为每种情况构成了一个适定的边值问题（BVP），预计会有唯一解。\n- **客观的**：该问题使用热传递领域的精确、标准术语进行陈述。它没有歧义和主观性。\n- **缺陷检查清单**：该问题不违反任何无效性标准。它是自洽的、一致的、在给定的理想化范围内物理上现实的，并且需要一个标准的、非平凡的推导和求解过程。\n\n### 步骤3：结论与行动\n该问题是有效的。将提供完整解答。\n\n### 控制方程的推导\n我们对位于距基座 $x$ 处、长度为 $dx$ 的鳍片微分控制体进行能量平衡。在稳态条件下，传入元素在 $x$ 处的热传导速率必须等于传出元素在 $x+dx$ 处的热传导速率加上从元素侧表面对流出去的热量速率。\n$$q_x = q_{x+dx} + dq_{\\text{conv}}$$\n根据傅里叶热传导定律，热传导速率为 $q = -kA_c \\frac{dT}{dx}$。将其应用于我们的控制体：\n$$q_x = -kA_c \\frac{dT}{dx}$$\n在 $x+dx$ 处的热传导速率可以用泰勒级数展开表示，保留一阶项：\n$$q_{x+dx} = q_x + \\frac{dq_x}{dx}dx = -kA_c \\frac{dT}{dx} - \\frac{d}{dx}\\left(kA_c \\frac{dT}{dx}\\right)dx$$\n根据牛顿冷却定律，从微分表面积 $dA_s=Pdx$ 的热对流为：\n$$dq_{\\text{conv}} = h(Pdx)(T(x)-T_{\\infty})$$\n将这些表达式代入能量平衡方程：\n$$-kA_c \\frac{dT}{dx} = \\left(-kA_c \\frac{dT}{dx} - \\frac{d}{dx}\\left(kA_c \\frac{dT}{dx}\\right)dx\\right) + hP(T(x)-T_{\\infty})dx$$\n化简后得到：\n$$0 = - \\frac{d}{dx}\\left(kA_c \\frac{dT}{dx}\\right)dx + hP(T(x)-T_{\\infty})dx$$\n由于 $k$ 和 $A_c$ 是常数，这可以简化为：\n$$kA_c \\frac{d^2T}{dx^2} - hP(T(x)-T_{\\infty}) = 0$$\n我们引入过余温度 $\\theta(x) \\equiv T(x)-T_{\\infty}$。其导数为 $\\frac{d\\theta}{dx} = \\frac{dT}{dx}$ 和 $\\frac{d^2\\theta}{dx^2} = \\frac{d^2T}{dx^2}$。将其代入方程得到：\n$$kA_c \\frac{d^2\\theta}{dx^2} - hP\\theta = 0$$\n两边除以 $kA_c$，我们得到鳍片方程的标准形式：\n$$\\frac{d^2\\theta}{dx^2} - m^2\\theta = 0$$\n其中鳍片参数 $m$ 定义为：\n$$m \\equiv \\sqrt{\\frac{hP}{kA_c}}$$\n这个二阶齐次常微分方程的通解是：\n$$\\theta(x) = C_1 e^{mx} + C_2 e^{-mx}$$\n或者，用对此问题更方便的双曲函数表示：\n$$\\theta(x) = C_3 \\cosh(mx) + C_4 \\sinh(mx)$$\n\n### 边界条件\n对于两种情况，鳍片基座（$x=0$）的边界条件是相同的。温度是给定的：\n$T(0) = T_b$，用过余温度表示为 $\\theta(0) = T_b - T_{\\infty} \\equiv \\theta_b$。\n将此应用于通解：\n$\\theta(0) = C_3 \\cosh(0) + C_4 \\sinh(0) = C_3(1) + C_4(0) = C_3$。\n因此，$C_3 = \\theta_b$，解变为：\n$$\\theta(x) = \\theta_b \\cosh(mx) + C_4 \\sinh(mx)$$\n第二个边界条件在鳍片端部（$x=L$），两种情况不同。\n\n### 情况 (i)：绝热端部\n绝热端部的边界条件是零热通量：\n$$q_{x=L} = -kA_c \\left.\\frac{dT}{dx}\\right|_{x=L} = 0$$\n用 $\\theta$ 表示，这变为 $\\left.\\frac{d\\theta}{dx}\\right|_{x=L} = 0$。\n首先，我们对 $\\theta(x)$ 的解进行微分：\n$$\\frac{d\\theta}{dx} = \\theta_b m \\sinh(mx) + C_4 m \\cosh(mx)$$\n在 $x=L$ 处应用边界条件：\n$$\\theta_b m \\sinh(mL) + C_4 m \\cosh(mL) = 0$$\n求解 $C_4$：\n$$C_4 = -\\theta_b \\frac{\\sinh(mL)}{\\cosh(mL)} = -\\theta_b \\tanh(mL)$$\n将 $C_3$ 和 $C_4$ 代入通解，得到温度分布：\n$$\\theta(x) = \\theta_b \\cosh(mx) - \\theta_b \\tanh(mL) \\sinh(mx) = \\theta_b \\left( \\frac{\\cosh(mL)\\cosh(mx) - \\sinh(mL)\\sinh(mx)}{\\cosh(mL)} \\right)$$\n使用恒等式 $\\cosh(a-b) = \\cosh(a)\\cosh(b) - \\sinh(a)\\sinh(b)$，我们得到简洁的形式：\n$$\\theta(x) = \\theta_b \\frac{\\cosh(m(L-x))}{\\cosh(mL)}$$\n通过设置 $x=L$ 找到鳍片端部温度：\n$$\\theta(L) = \\theta_b \\frac{\\cosh(m(L-L))}{\\cosh(mL)} = \\theta_b \\frac{\\cosh(0)}{\\cosh(mL)} = \\frac{\\theta_b}{\\cosh(mL)}$$\n所要求的端部温度分数为：\n$$\\frac{\\theta(L)}{\\theta_b} = \\frac{1}{\\cosh(mL)}$$\n\n### 情况 (ii)：对流端部\n在对流端部，边界条件将传导至端部的热量与从端部对流出去的热量相等。端部面积给定为 $A_t=A_c$。\n$$-kA_c \\left.\\frac{dT}{dx}\\right|_{x=L} = hA_c (T(L)-T_{\\infty})$$\n用 $\\theta$ 表示，这变为：\n$$-k \\left.\\frac{d\\theta}{dx}\\right|_{x=L} = h\\theta(L)$$\n我们从部分确定的解 $\\theta(x) = \\theta_b \\cosh(mx) + C_4 \\sinh(mx)$ 开始。\n在 $x=L$ 处：\n$\\theta(L) = \\theta_b \\cosh(mL) + C_4 \\sinh(mL)$\n$\\left.\\frac{d\\theta}{dx}\\right|_{x=L} = \\theta_b m \\sinh(mL) + C_4 m \\cosh(mL)$\n将这些代入边界条件：\n$$-k(\\theta_b m \\sinh(mL) + C_4 m \\cosh(mL)) = h(\\theta_b \\cosh(mL) + C_4 \\sinh(mL))$$\n我们通过分组项来求解 $C_4$：\n$$C_4(-km\\cosh(mL) - h\\sinh(mL)) = h\\theta_b\\cosh(mL) + km\\theta_b\\sinh(mL)$$\n$$C_4 = -\\theta_b \\frac{h\\cosh(mL) + km\\sinh(mL)}{km\\cosh(mL) + h\\sinh(mL)}$$\n为了找到端部温度 $\\theta(L)$，我们将这个 $C_4$ 代入 $\\theta(L)$ 的表达式中：\n$$\\frac{\\theta(L)}{\\theta_b} = \\cosh(mL) + \\frac{C_4}{\\theta_b}\\sinh(mL)$$\n$$\\frac{\\theta(L)}{\\theta_b} = \\cosh(mL) - \\left( \\frac{h\\cosh(mL) + km\\sinh(mL)}{km\\cosh(mL) + h\\sinh(mL)} \\right) \\sinh(mL)$$\n通分：\n$$\\frac{\\theta(L)}{\\theta_b} = \\frac{\\cosh(mL)(km\\cosh(mL) + h\\sinh(mL)) - \\sinh(mL)(h\\cosh(mL) + km\\sinh(mL))}{km\\cosh(mL) + h\\sinh(mL)}$$\n分子化简：\n$km\\cosh^2(mL) + h\\cosh(mL)\\sinh(mL) - h\\sinh(mL)\\cosh(mL) - km\\sinh^2(mL) = km(\\cosh^2(mL) - \\sinh^2(mL)) = km(1) = km$。\n所以，端部温度分数为：\n$$\\frac{\\theta(L)}{\\theta_b} = \\frac{km}{km\\cosh(mL) + h\\sinh(mL)}$$\n分子分母同除以 $km$：\n$$\\frac{\\theta(L)}{\\theta_b} = \\frac{1}{\\cosh(mL) + \\frac{h}{km}\\sinh(mL)}$$\n问题要求消除 $h$。我们使用定义 $m^2 = \\frac{hP}{kA_c}$，这给出 $h = \\frac{m^2kA_c}{P}$。比率 $\\frac{h}{km}$ 变为：\n$$\\frac{h}{km} = \\frac{1}{km} \\left(\\frac{m^2kA_c}{P}\\right) = \\frac{mA_c}{P}$$\n将此代入端部温度分数的表达式中：\n$$\\frac{\\theta(L)}{\\theta_b} = \\frac{1}{\\cosh(mL) + \\frac{mA_c}{P}\\sinh(mL)}$$\n\n### 极限情况的解释\n无量纲参数 $mL = L\\sqrt{hP/kA_c}$ 控制着鳍片的热行为。\n\n对于**绝热端部**（情况 i），$\\frac{\\theta(L)}{\\theta_b} = \\frac{1}{\\cosh(mL)}$。\n- 当 $mL \\to 0$ 时（例如，一个非常短、高导热的鳍片），$\\cosh(mL) \\to 1$。因此，$\\frac{\\theta(L)}{\\theta_b} \\to 1$。这意味着 $\\theta(L) \\to \\theta_b$，即鳍片几乎是等温的，温度等于基座温度。\n- 当 $mL \\to \\infty$ 时（例如，一个非常长、导热性差的鳍片），$\\cosh(mL) \\to \\infty$。因此，$\\frac{\\theta(L)}{\\theta_b} \\to 0$。这意味着 $\\theta(L) \\to 0$，即端部温度接近环境流体温度。这是“无限长鳍片”近似。\n\n对于**对流端部**（情况 ii），$\\frac{\\theta(L)}{\\theta_b} = \\frac{1}{\\cosh(mL) + (h/km)\\sinh(mL)}$。\n- 当 $mL \\to 0$ 时，我们使用近似 $\\cosh(mL) \\approx 1$ 和 $\\sinh(mL) \\approx mL$。该分数变为 $\\frac{1}{1 + (h/km)(mL)} = \\frac{1}{1 + hL/k}$。这个结果对应于忽略侧面对流，将鳍片视为一个简单的一维热阻问题，其中鳍片内的热传导与端部的对流串联。\n- 当 $mL \\to \\infty$ 时，$\\cosh(mL)$ 和 $\\sinh(mL)$ 都趋近于 $\\frac{1}{2}e^{mL}$。分母增长为 $\\frac{1}{2}e^{mL}(1 + h/km)$，所以分数 $\\frac{\\theta(L)}{\\theta_b} \\to 0$。与绝热情况一样，足够大的 $mL$ 使鳍片的行为如同无限长，特定的端部条件变得无关紧要，因为温度已经接近环境温度。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\cosh(mL)} & \\frac{1}{\\cosh(mL) + \\frac{mA_c}{P}\\sinh(mL)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然解析解提供了宝贵的洞察力，但现实世界中的工程问题往往因其复杂的几何形状或边界条件而无法求得解析解。这时，数值方法（如有限差分法）便成为不可或缺的工具。本练习将引导您从零开始构建一个稳态有限差分求解器，并通过与精确解析解进行比较来进行网格收敛性研究，这是计算工程中验证与确认（V&V）的关键步骤 。",
            "id": "3953483",
            "problem": "考虑一个直、细长的一维翅片，其横截面积 $A$ 和周长 $P$ 均匀，由导热系数为 $k$ 的固体材料制成，从温度为 $T_b$ 的基座延伸出长度 $L$，并置于环境温度为 $T_\\infty$ 的流体中。翅片的侧表面暴露在具有均匀对流换热系数 $h$ 的流体中。位于 $x=L$ 处的翅片尖端通过尖端面积 $A_t$ 与系数为 $h_t$ 的对流环境接触。定义过余温度为 $\\theta(x) = T(x) - T_\\infty$，基座过余温度为 $\\theta_b = T_b - T_\\infty$。在稳态条件下，当轴向热生成可忽略不计且物性恒定时，该翅片由一个线性二阶常微分方程控制，并在尖端处具有对流（Robin）边界条件。翅片效率 $\\eta_f$ 定义为翅片的总传热率与假设整个翅片都处于基座过余温度时的传热率之比，即 $\\eta_f = q_f/\\left(h P L \\theta_b\\right)$，其中 $q_f$ 是在基座处传导的实际传热率。\n\n你的任务是实现一个有限差分格式，该格式：\n- 在间距为 $\\Delta x$ 的均匀网格上，使用内部节点的二阶中心差分近似和 $x=L$ 处对流尖端边界条件的一阶单边差分来离散化控制常微分方程。\n- 在基座 $x=0$ 处强制施加 Dirichlet 边界条件 $\\theta(0)=\\theta_b$。\n- 计算离散温度场，然后使用 $x=0$ 处导数的二阶单边有限差分近似来计算基座热流率 $q_f$。\n- 从离散解中计算翅片效率 $\\eta_f$。\n\n为了量化精度，你还必须基于具有相同边界条件的控制线性常微分方程的精确解析解来计算 $\\eta_f$ 的参考值，然后评估 $\\eta_f$ 中作为网格间距 $\\Delta x$ 函数的绝对相对误差。\n\n使用以下常数和单位：\n- 导热系数 $k$，单位为 $\\mathrm{W/(m\\cdot K)}$。\n- 对流换热系数 $h$ 和 $h_t$，单位为 $\\mathrm{W/(m^2\\cdot K)}$。\n- 几何量 $L$，单位为 $\\mathrm{m}$；$A$ 和 $A_t$，单位为 $\\mathrm{m^2}$；$P$，单位为 $\\mathrm{m}$。\n- 温度单位为 $\\mathrm{K}$；使用基座过余温度 $\\theta_b = 1$，以使翅片效率保持无量纲。将误差报告为无量纲十进制数。\n\n对于所有测试用例，使用具有 $N$ 个控制体积的均匀网格，使得 $\\Delta x = L/N$。对于每个用例，在一组网格间距 $\\left\\{\\Delta x_k\\right\\}$ 上评估误差，该组间距对应于 $N \\in \\{5, 10, 20, 40, 80\\}$，即 $\\Delta x_k = L/5$, $\\Delta x_k = L/10$, $\\Delta x_k = L/20$, $\\Delta x_k = L/40$, $\\Delta x_k = L/80$。\n\n实现你的程序，为每个测试用例计算规定 $\\Delta x_k$ 下的绝对相对误差列表 $e_k = \\left|\\eta_f^{\\mathrm{FD}}(\\Delta x_k) - \\eta_f^{\\mathrm{exact}}\\right|/\\left|\\eta_f^{\\mathrm{exact}}\\right|$，其中 $\\eta_f^{\\mathrm{FD}}$ 是有限差分估计值，$\\eta_f^{\\mathrm{exact}}$ 是从精确连续解获得的值。\n\n使用以下四个科学上合理且自洽的测试用例：\n\n- 用例 $1$（中等对流，类铝导热系数）：$L = 0.05\\,\\mathrm{m}$，$k = 205\\,\\mathrm{W/(m\\cdot K)}$，$h = 25\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$，$P = 0.04\\,\\mathrm{m}$，$h_t = 25\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n- 用例 $2$（绝热尖端理想化）：$L = 0.05\\,\\mathrm{m}$，$k = 205\\,\\mathrm{W/(m\\cdot K)}$，$h = 25\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$，$P = 0.04\\,\\mathrm{m}$，$h_t = 0\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n- 用例 $3$（强对流，低导热系数）：$L = 0.10\\,\\mathrm{m}$，$k = 15\\,\\mathrm{W/(m\\cdot K)}$，$h = 200\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 2.0\\times 10^{-4}\\,\\mathrm{m^2}$，$P = 0.06\\,\\mathrm{m}$，$h_t = 200\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n- 用例 $4$（短且高导热系数的翅片）：$L = 0.01\\,\\mathrm{m}$，$k = 400\\,\\mathrm{W/(m\\cdot K)}$，$h = 10\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 5.0\\times 10^{-5}\\,\\mathrm{m^2}$，$P = 0.03\\,\\mathrm{m}$，$h_t = 10\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n\n你的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表对应一个测试用例，并按 $[L/5, L/10, L/20, L/40, L/80]$ 的顺序包含五个规定 $\\Delta x_k$ 的误差。确切的所需输出格式为：\n- 单行，无附加文本，包含一个类似 Python 的浮点数列表的列表，例如：“[[e_{1,1},e_{1,2},e_{1,3},e_{1,4},e_{1,5}],[e_{2,1},...,e_{2,5}],...]\"，其中每个 $e_{i,j}$ 是一个十进制数。",
            "solution": "### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **控制物理**：稳态、一维传热，发生在具有均匀横截面积 $A$ 和周长 $P$ 的直翅片中。\n- **材料物性**：导热系数 $k$。\n- **对流**：侧表面具有均匀对流换热系数 $h$，尖端面积 $A_t$ 上具有系数 $h_t$。\n- **温度**：基座温度 $T_b$，环境流体温度 $T_\\infty$。\n- **定义**：\n    - 过余温度：$\\theta(x) = T(x) - T_\\infty$。\n    - 基座过余温度：$\\theta_b = T_b - T_\\infty$。对于所有计算，$\\theta_b = 1$。\n    - 翅片效率：$\\eta_f = q_f/\\left(h P L \\theta_b\\right)$，其中 $q_f$ 是在基座（$x=0$）处传导的热流率。\n- **控制方程**：问题隐含了标准翅片方程：$k A \\frac{d^2T}{dx^2} - h P (T-T_\\infty) = 0$。\n- **边界条件 (BCs)**：\n    - 基座（$x=0$）：Dirichlet 边界条件，$\\theta(0) = \\theta_b$。\n    - 尖端（$x=L$）：对流（Robin）边界条件，$-k A \\frac{dT}{dx}|_{x=L} = h_t A_t (T(L) - T_\\infty)$。\n- **有限差分法 (FDM) 规格**：\n    - 网格：均匀，有 $N$ 个控制体积，间距 $\\Delta x = L/N$。\n    - 内部节点：对常微分方程使用二阶中心差分。\n    - 尖端边界条件（$x=L$）：一阶单边差分。\n    - 基座热流率（$q_f$）：对 $x=0$ 处的导数使用二阶单边有限差分。\n- **误差分析**：\n    - 计算绝对相对误差 $e_k = \\left|\\eta_f^{\\mathrm{FD}}(\\Delta x_k) - \\eta_f^{\\mathrm{exact}}\\right|/\\left|\\eta_f^{\\mathrm{exact}}\\right|$。\n    - 评估点：$N \\in \\{5, 10, 20, 40, 80\\}$。\n- **测试用例**：\n    - 用例 1：$L = 0.05\\,\\mathrm{m}$，$k = 205\\,\\mathrm{W/(m\\cdot K)}$，$h = 25\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$，$P = 0.04\\,\\mathrm{m}$，$h_t = 25\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n    - 用例 2：$L = 0.05\\,\\mathrm{m}$，$k = 205\\,\\mathrm{W/(m\\cdot K)}$，$h = 25\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$，$P = 0.04\\,\\mathrm{m}$，$h_t = 0\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n    - 用例 3：$L = 0.10\\,\\mathrm{m}$，$k = 15\\,\\mathrm{W/(m\\cdot K)}$，$h = 200\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 2.0\\times 10^{-4}\\,\\mathrm{m^2}$，$P = 0.06\\,\\mathrm{m}$，$h_t = 200\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n    - 用例 4：$L = 0.01\\,\\mathrm{m}$，$k = 400\\,\\mathrm{W/(m\\cdot K)}$，$h = 10\\,\\mathrm{W/(m^2\\cdot K)}$，$A = 5.0\\times 10^{-5}\\,\\mathrm{m^2}$，$P = 0.03\\,\\mathrm{m}$，$h_t = 10\\,\\mathrm{W/(m^2\\cdot K)}$，$A_t = A$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题是计算传热学中的一个标准练习，特别是关于翅片问题的数值求解和分析。\n- **有科学依据**：该问题基于稳态热传导和对流的基本原理，由一个公认的二阶常微分方程（翅片方程）描述。为测试用例提供的物理参数对于常见的工程材料（如铝、铜）和对流场景是现实的。这些定义是传热领域的标准定义。\n- **适定的**：问题描述了一个线性二阶常微分方程，带有两个边界条件（基座处为 Dirichlet 条件，尖端处为 Robin 条件）。这构成了一个适定的边值问题，存在唯一、稳定且有意义的解析解。数值任务也是适定的；指定的有限差分格式会产生一个非奇异且可解的线性方程组。\n- **客观的**：问题以精确、客观和定量的术语陈述。所有参数、方法和评估标准都已明确定义，没有主观解释的余地。\n- **完整性和一致性**：解析解和数值实现所需的所有数据都已提供。单位是一致的。数值格式的结构已完全指定。问题是自洽的，没有矛盾。观察到翅片效率 $\\eta_f$ 可能超过 1 是所给定义 $\\eta_f = q_f/\\left(h P L \\theta_b\\right)$ 的一个有效结果，该定义仅基于翅片侧面积来定义理想传热，而实际传热 $q_f$ 则包括了来自侧面积和尖端面积的贡献。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。它在科学上是合理的、适定的、完整的和客观的。该任务是计算热工领域中一个严谨和标准的验证与确认练习。我们着手进行求解。\n\n### 基于原理的求解设计\n\n该解决方案既涉及用于获取参考值的解析推导，也涉及基于指定的有限差分法的数值实现。\n\n**1. 解析解**\n\n在物性均匀的翅片中，过余温度 $\\theta(x) = T(x) - T_\\infty$ 的控制方程为：\n$$ \\frac{d^2\\theta}{dx^2} - m^2 \\theta = 0 $$\n其中翅片参数 $m$ 定义为 $m = \\sqrt{\\frac{hP}{kA}}$。用 $\\theta$ 表示的边界条件是：\n1. 基座（$x=0$）：$\\theta(0) = \\theta_b$\n2. 尖端（$x=L$）：传导到尖端的热量等于从尖端对流出去的热量。当 $A_t=A$ 时，即为 $-k A \\frac{d\\theta}{dx}|_{L} = h_t A \\theta(L)$，简化为 $\\frac{d\\theta}{dx}|_{L} + \\frac{h_t}{k} \\theta(L) = 0$。\n\n该常微分方程的通解为 $\\theta(x) = C_1 \\cosh(m(L-x)) + C_2 \\sinh(m(L-x))$。应用边界条件可以解出常数，从而得到温度分布的标准解。\n\n基座处的热流率由傅里叶定律给出：$q_f = -kA \\frac{d\\theta}{dx}|_{x=0}$。对通解求导并应用边界条件，可得到带有对流尖端的翅片热流率的著名表达式：\n$$ q_f = \\sqrt{hPkA} \\theta_b \\frac{\\sinh(mL) + (h_t/mk) \\cosh(mL)}{\\cosh(mL) + (h_t/mk) \\sinh(mL)} $$\n翅片效率 $\\eta_f$ 定义为这个实际热流率与假设整个侧表面都处于基座温度时的理想热流率 $q_{ideal} = hPL\\theta_b$ 之比。\n$$ \\eta_f^{\\mathrm{exact}} = \\frac{q_f}{hPL\\theta_b} = \\frac{\\sqrt{hPkA}}{hPL} \\frac{\\sinh(mL) + (h_t/mk) \\cosh(mL)}{\\cosh(mL) + (h_t/mk) \\sinh(mL)} $$\n由于 $m = \\sqrt{hP/kA}$，前置因子简化为：$\\frac{\\sqrt{hPkA}}{hPL} = \\frac{m k A}{hPL} = \\frac{m k A}{(m^2 k A) L} = \\frac{1}{mL}$。因此，精确效率为：\n$$ \\eta_f^{\\mathrm{exact}} = \\frac{1}{mL} \\frac{\\sinh(mL) + (h_t/mk) \\cosh(mL)}{\\cosh(mL) + (h_t/mk) \\sinh(mL)} $$\n对于绝热尖端（$h_t=0$）的特殊情况，这简化为经典结果 $\\eta_f^{\\mathrm{exact}} = \\frac{\\tanh(mL)}{mL}$。\n\n**2. 有限差分公式**\n\n长度为 $L$ 的翅片域被离散为 $N$ 个长度为 $\\Delta x = L/N$ 的均匀段，创建了 $N+1$ 个节点，索引为 $i = 0, 1, \\dots, N$。设 $\\theta_i$ 是 $\\theta(x_i)$ 的数值近似。\n\n- **内部节点（$i=1, \\dots, N-1$）**：常微分方程 $\\frac{d^2\\theta}{dx^2} - m^2 \\theta = 0$ 使用二阶中心差分对二阶导数进行离散化：\n$$ \\frac{\\theta_{i-1} - 2\\theta_i + \\theta_{i+1}}{(\\Delta x)^2} - m^2 \\theta_i = 0 $$\n重新整理得到每个内部节点的线性代数方程：\n$$ \\theta_{i-1} - (2 + m^2(\\Delta x)^2) \\theta_i + \\theta_{i+1} = 0 $$\n\n- **边界节点**：\n    - **基座（$i=0$）**：直接应用 Dirichlet 条件：$\\theta_0 = \\theta_b$。由于指定了 $\\theta_b=1$，因此 $\\theta_0=1$。该值被代入节点 $i=1$ 的方程中。\n    - **尖端（$i=N$）**：Robin 边界条件 $\\frac{d\\theta}{dx}|_{L} + \\frac{h_t}{k} \\theta(L) = 0$ 使用指定的一阶后向差分对导数进行离散化：\n    $$ \\frac{\\theta_N - \\theta_{N-1}}{\\Delta x} + \\frac{h_t}{k} \\theta_N = 0 $$\n    重新整理得到方程组的最后一个方程：\n    $$ -\\theta_{N-1} + \\left(1 + \\frac{h_t \\Delta x}{k}\\right) \\theta_N = 0 $$\n\n此公式产生了一个包含 $N$ 个线性方程的方程组，用于求解 $N$ 个未知温度 $\\theta_1, \\dots, \\theta_N$。以矩阵形式表示为 $\\mathbf{M}\\vec{\\theta} = \\vec{b}$，其中 $\\vec{\\theta} = [\\theta_1, \\dots, \\theta_N]^T$，$\\mathbf{M}$ 是一个 $N \\times N$ 的三对角矩阵，$\\vec{b}$ 是一个表示边界条件贡献的向量。具体来说：\n$$\n\\mathbf{M} = \n\\begin{pmatrix}\n-(2+c)  1  0  \\cdots  0 \\\\\n1  -(2+c)  1  \\cdots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  \\vdots \\\\\n0  \\cdots  1  -(2+c)  1 \\\\\n0  \\cdots  0  -1  1+d\n\\end{pmatrix}, \\quad\n\\vec{b} = \n\\begin{pmatrix}\n-\\theta_b \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n其中 $c = m^2(\\Delta x)^2$ 且 $d = \\frac{h_t \\Delta x}{k}$。可以高效地求解该系统以找到离散温度场 $\\theta_i$。\n\n**3. 数值翅片效率与误差计算**\n\n基座热流率 $q_f$ 使用指定的二阶前向差分公式计算 $x=0$ 处的导数：\n$$ \\left.\\frac{d\\theta}{dx}\\right|_{x=0} \\approx \\frac{-3\\theta_0 + 4\\theta_1 - \\theta_2}{2\\Delta x} $$\n数值热流率则为：\n$$ q_f^{\\mathrm{FD}} = -kA \\left( \\frac{-3\\theta_0 + 4\\theta_1 - \\theta_2}{2\\Delta x} \\right) $$\n数值翅片效率使用给定定义计算：\n$$ \\eta_f^{\\mathrm{FD}} = \\frac{q_f^{\\mathrm{FD}}}{hPL\\theta_b} $$\n当 $\\theta_0=\\theta_b=1$ 时，这变为：\n$$ \\eta_f^{\\mathrm{FD}} = \\frac{-kA(-3 + 4\\theta_1 - \\theta_2)}{2hPL\\Delta x} $$\n\n最后，对于每个网格分辨率 $N$，通过将数值结果与精确解进行比较来计算绝对相对误差 $e$：\n$$ e = \\frac{\\left|\\eta_f^{\\mathrm{FD}} - \\eta_f^{\\mathrm{exact}}\\right|}{\\left|\\eta_f^{\\mathrm{exact}}\\right|} $$\n\n总体算法包括遍历每组物理参数（测试用例），并对每个用例遍历规定的网格分辨率 $N$，在每个步骤中计算并存储误差 $e$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the fin heat transfer problem for four test cases, calculating the\n    absolute relative error in fin efficiency for a series of grid refinements.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (moderate convection, aluminum-like conductivity)\n        # L, k, h, A, P, h_t, A_t\n        (0.05, 205.0, 25.0, 1.0e-4, 0.04, 25.0, 1.0e-4),\n        # Case 2 (adiabatic tip idealization)\n        (0.05, 205.0, 25.0, 1.0e-4, 0.04, 0.0, 1.0e-4),\n        # Case 3 (strong convection, low conductivity)\n        (0.10, 15.0, 200.0, 2.0e-4, 0.06, 200.0, 2.0e-4),\n        # Case 4 (short, highly conductive fin)\n        (0.01, 400.0, 10.0, 5.0e-5, 0.03, 10.0, 5.0e-5),\n    ]\n\n    N_values = [5, 10, 20, 40, 80]\n    all_results = []\n\n    for case_params in test_cases:\n        L, k, h, A, P, h_t, A_t = case_params\n        case_errors = calculate_errors_for_case(L, k, h, A, P, h_t, A_t, N_values)\n        all_results.append(case_errors)\n\n    # Format the output as a string representing a list of lists.\n    list_of_strings = []\n    for inner_list in all_results:\n        inner_list_str = [f\"{num:.10e}\" for num in inner_list]\n        list_of_strings.append(f\"[{','.join(inner_list_str)}]\")\n    final_output = f\"[{','.join(list_of_strings)}]\"\n    print(final_output)\n\n\ndef calculate_errors_for_case(L, k, h, A, P, h_t, A_t, N_values):\n    \"\"\"\n    For a single test case, computes the fin efficiency error for each grid size.\n    \"\"\"\n    theta_b = 1.0\n    errors = []\n\n    # 1. Calculate the exact fin efficiency for the given parameters.\n    # This value is constant for the case.\n    if k * A == 0:\n        return [np.nan] * len(N_values)\n    m = np.sqrt((h * P) / (k * A))\n    mL = m * L\n\n    if mL == 0:\n        eta_f_exact = 1.0\n    else:\n        if h_t == 0: # Adiabatic tip special case\n            eta_f_exact = np.tanh(mL) / mL\n        else: # General convective tip case (A_t = A is assumed)\n            term = h_t / (m * k)\n            numerator = np.sinh(mL) + term * np.cosh(mL)\n            denominator = np.cosh(mL) + term * np.sinh(mL)\n            eta_f_exact = (1.0 / mL) * (numerator / denominator)\n\n    for N in N_values:\n        delta_x = L / N\n\n        # 2. Set up and solve the finite difference linear system M*theta = b\n        M = np.zeros((N, N))\n        b = np.zeros(N)\n\n        # Tridiagonal matrix coefficients for interior nodes\n        m_sq_dx_sq = m**2 * delta_x**2\n        diag_val = -(2.0 + m_sq_dx_sq)\n        \n        for i in range(N - 1):\n            if i > 0:\n                M[i, i - 1] = 1.0  # Lower diagonal\n            M[i, i] = diag_val       # Main diagonal\n            M[i, i + 1] = 1.0  # Upper diagonal\n        \n        # First equation's RHS is modified by the base BC\n        b[0] = -theta_b\n        \n        # Last row of the matrix from the tip BC\n        # -theta_{N-1} + (1 + h_t*delta_x/k) * theta_N = 0\n        M[N - 1, N - 2] = -1.0\n        M[N - 1, N - 1] = 1.0 + (h_t * delta_x / k)\n        \n        theta_vec = np.linalg.solve(M, b)\n        \n        # 3. Calculate numerical fin efficiency from the discrete solution\n        theta_0 = theta_b\n        theta_1 = theta_vec[0]\n        theta_2 = theta_vec[1]\n        \n        # Base heat flux using 2nd-order forward difference for derivative\n        dtheta_dx_0 = (-3.0 * theta_0 + 4.0 * theta_1 - theta_2) / (2.0 * delta_x)\n        q_f_fd = -k * A * dtheta_dx_0\n        \n        # Ideal heat rate for the lateral surface\n        q_ideal = h * P * L * theta_b\n        \n        eta_f_fd = q_f_fd / q_ideal\n        \n        # 4. Compute and store the absolute relative error\n        if eta_f_exact == 0:\n            rel_error = np.abs(eta_f_fd)\n        else:\n            rel_error = np.abs(eta_f_fd - eta_f_exact) / np.abs(eta_f_exact)\n        \n        errors.append(rel_error)\n        \n    return errors\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "在掌握了稳态分析之后，下一个挑战是模拟随时间演变的热过程。许多工程应用，如电子设备的启动冷却或发动机的预热，都涉及瞬态传热。本练习将带领您开发一种更高级的数值格式——Crank-Nicolson 格式，用于求解瞬态翅片方程，从而准确捕捉温度场如何随时间动态变化 。",
            "id": "3953813",
            "problem": "考虑一个长度为 $L$ 的细长一维直翅片，其横截面积 $A$ 和周长 $P$ 恒定，由均质材料制成，其热导率为 $k$，质量密度为 $\\rho$，比热容为 $c$。翅片的侧表面暴露在温度为 $T_{\\infty}$ 的均匀环境中，对流系数为 $h$。令 $\\theta(x,t) = T(x,t) - T_{\\infty}$ 表示过余温度。假设材料属性在空间上均匀，且忽略轴向辐射。单位长度的能量守恒结合 Fourier 定律可得出瞬态翅片方程\n$$\n\\rho c A \\frac{\\partial \\theta}{\\partial t} = k A \\frac{\\partial^2 \\theta}{\\partial x^2} - h P \\theta,\n$$\n其中 $x \\in (0,L)$ 且 $t > 0$。定义热扩散率 $\\alpha = \\frac{k}{\\rho c}$ 和侧面对流汇系数 $s = \\frac{h P}{\\rho c A}$，可将方程写为\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta.\n$$\n位于 $x=0$ 的翅片根部在所有 $t \\ge 0$ 的时间内都保持已知的过余温度 $\\theta(0,t) = \\theta_b$。位于 $x=L$ 的尖端通过其端部面积 $A_e$ 与温度为 $T_{\\infty}$ 的环境进行对流换热，对流系数为 $h_e$。由此产生的过余温度的 Robin 边界条件 (Robin boundary condition (RBC)) 为\n$$\n-k A \\frac{\\partial \\theta}{\\partial x}(L,t) = h_e A_e \\theta(L,t),\n$$\n可写为\n$$\n-\\frac{\\partial \\theta}{\\partial x}(L,t) = \\beta \\theta(L,t), \\quad \\text{其中} \\quad \\beta = \\frac{h_e A_e}{k A}.\n$$\n您需要为这个瞬态翅片方程的一个时间步长建立一个 Crank-Nicolson (Crank-Nicolson (CN)) 有限差分格式，并在均匀网格上推导出相关的线性代数系统，包括 Robin 尖端边界。从第一性原理出发，在均匀网格 $x_i = i \\Delta x$（其中 $i = 0,1,\\dots,N$，$ \\Delta x = \\frac{L}{N}$）上使用中心差分对空间二阶导数进行离散，并使用时间步长为 $\\Delta t$ 的 CN 方法对时间进行离散。将 $x_0 = 0$ 处的根部边界视为 Dirichlet 条件，其值为已知的 $\\theta_b$，并通过与导数边界条件一致的单侧二阶精确消除虚拟节点的方法来施加 $x_N = L$ 处的 Robin 边界。\n\n任务：\n- 从有限差分近似和应用于 $\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta$ 的 CN 时间离散出发，推导出在新时间层 $t^{n+1} = t^n + \\Delta t$ 上未知向量 $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\theta_2^{n+1}, \\dots, \\theta_{N}^{n+1}]^{\\top}$ 的三对角矩阵系统，其中根部节点 $\\theta_0$ 是已知的，不包含在未知向量中。明确说明内部节点 $i=1,\\dots,N-1$ 的矩阵行系数，由于 Dirichlet 边界对第一个内部节点 $i=1$ 的修正，以及由于带参数 $\\beta$ 的 Robin 边界对尖端节点 $i=N$ 的修正。\n- 根据已知的前一状态 $\\boldsymbol{\\theta}^{n} = [\\theta_1^{n}, \\theta_2^{n}, \\dots, \\theta_{N}^{n}]^{\\top}$、Dirichlet 边界值 $\\theta_b$ 以及参数 $\\alpha$、$s$、$\\beta$、$\\Delta x$ 和 $\\Delta t$，提供最终的右端向量。\n\n您的程序必须实现所推导的 CN 格式，为以下每个测试用例执行从 $\\boldsymbol{\\theta}^{n}$ 到 $\\boldsymbol{\\theta}^{n+1}$ 的单个时间步长。在所有情况下，假设初始过余温度在空间上是均匀的，即 $\\theta(x,0) = \\theta_{\\text{init}}$（如下所示），并使用一个包含 $N+1$ 个点和 $N$ 个内部区间的均匀空间网格。报告所有网格点 $x_i$（包括根部）处的过余温度（单位：开尔文），即为每种情况输出列表 $[\\theta_0^{n+1}, \\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]$。所有温度以 $\\mathrm{K}$ 表示，时间以 $\\mathrm{s}$ 表示，长度以 $\\mathrm{m}$ 表示。此问题不涉及角度。\n\n使用以下参数值测试套件：\n- 情况 1（一般情况，中等侧面对流，中等尖端对流）：\n  - $L = 0.05\\,\\mathrm{m}$, $N = 10$, $\\Delta t = 0.2\\,\\mathrm{s}$,\n  - $k = 205\\,\\mathrm{W/(m\\,K)}$, $\\rho = 2700\\,\\mathrm{kg/m^3}$, $c = 900\\,\\mathrm{J/(kg\\,K)}$, $A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$, $P = 0.02\\,\\mathrm{m}$,\n  - $h = 55\\,\\mathrm{W/(m^2\\,K)}$, $h_e = 55\\,\\mathrm{W/(m^2\\,K)}$, $A_e = A$,\n  - $\\theta_b = 50\\,\\mathrm{K}$, $\\theta_{\\text{init}} = 0\\,\\mathrm{K}$.\n- 情况 2（绝热尖端，即零尖端对流）：\n  - $L = 0.05\\,\\mathrm{m}$, $N = 10$, $\\Delta t = 0.2\\,\\mathrm{s}$,\n  - $k = 205\\,\\mathrm{W/(m\\,K)}$, $\\rho = 2700\\,\\mathrm{kg/m^3}$, $c = 900\\,\\mathrm{J/(kg\\,K)}$, $A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$, $P = 0.02\\,\\mathrm{m}$,\n  - $h = 55\\,\\mathrm{W/(m^2\\,K)}$, $h_e = 0\\,\\mathrm{W/(m^2\\,K)}$, $A_e = A$,\n  - $\\theta_b = 50\\,\\mathrm{K}$, $\\theta_{\\text{init}} = 0\\,\\mathrm{K}$.\n- 情况 3（较短翅片，强侧面和尖端对流，不同材料）：\n  - $L = 0.03\\,\\mathrm{m}$, $N = 6$, $\\Delta t = 0.01\\,\\mathrm{s}$,\n  - $k = 150\\,\\mathrm{W/(m\\,K)}$, $\\rho = 8000\\,\\mathrm{kg/m^3}$, $c = 500\\,\\mathrm{J/(kg\\,K)}$, $A = 2.0\\times 10^{-4}\\,\\mathrm{m^2}$, $P = 0.03\\,\\mathrm{m}$,\n  - $h = 250\\,\\mathrm{W/(m^2\\,K)}$, $h_e = 4000\\,\\mathrm{W/(m^2\\,K)}$, $A_e = A$,\n  - $\\theta_b = 20\\,\\mathrm{K}$, $\\theta_{\\text{init}} = 0\\,\\mathrm{K}$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个条目对应一个案例，其本身是在时间 $t^{n+1}$ 时网格点温度的逗号分隔列表。例如，输出格式必须为\n$$\n[\\,[\\theta_0^{n+1},\\theta_1^{n+1},\\dots,\\theta_N^{n+1}],\\,[\\theta_0^{n+1},\\theta_1^{n+1},\\dots,\\theta_N^{n+1}],\\,[\\theta_0^{n+1},\\theta_1^{n+1},\\dots,\\theta_N^{n+1}]\\,].\n$$",
            "solution": "用户希望使用 Crank-Nicolson 有限差分法解决一维翅片的瞬态热传导问题。\n\n### 1. 问题验证\n\n**步骤 1：提取给定信息**\n\n- **控制方程：** $\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta$，其中 $x \\in (0,L)$, $t > 0$。\n- **定义：**\n    - 过余温度：$\\theta(x,t) = T(x,t) - T_{\\infty}$。\n    - 热扩散率：$\\alpha = \\frac{k}{\\rho c}$。\n    - 侧面对流汇系数：$s = \\frac{h P}{\\rho c A}$。\n- **边界条件：**\n    - 根部（在 $x=0$ 处的 Dirichlet 条件）：$\\theta(0,t) = \\theta_b$，其中 $t \\ge 0$。\n    - 尖端（在 $x=L$ 处的 Robin 条件）：$-\\frac{\\partial \\theta}{\\partial x}(L,t) = \\beta \\theta(L,t)$，其中 $\\beta = \\frac{h_e A_e}{k A}$。\n- **初始条件：** 空间均匀的过余温度 $\\theta(x,0) = \\theta_{\\text{init}}$。\n- **数值格式：**\n    - Crank-Nicolson (CN) 方法进行时间离散。\n    - 均匀空间网格：$x_i = i \\Delta x$，其中 $i = 0, 1, \\dots, N$，$\\Delta x = L/N$。\n    - 中心差分用于空间二阶导数。\n    - 用于尖端 Robin 边界条件的二阶精确单侧消除方法。\n- **任务：**\n    1.  推导未知向量 $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\theta_2^{n+1}, \\dots, \\theta_{N}^{n+1}]^{\\top}$ 的三对角矩阵系统。\n    2.  提供矩阵系数和右端向量的表达式。\n    3.  为三个特定的测试用例实现该格式的单个时间步，并报告温度分布 $[\\theta_0^{n+1}, \\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]$。\n- **测试用例：**\n    - **情况 1：** $L = 0.05$, $N = 10$, $\\Delta t = 0.2$, $k = 205$, $\\rho = 2700$, $c = 900$, $A = 10^{-4}$, $P = 0.02$, $h = 55$, $h_e = 55$, $A_e = A$, $\\theta_b = 50$, $\\theta_{\\text{init}} = 0$。\n    - **情况 2：** 与情况 1 相同，但 $h_e = 0$。\n    - **情况 3：** $L = 0.03$, $N = 6$, $\\Delta t = 0.01$, $k = 150$, $\\rho = 8000$, $c = 500$, $A = 2 \\times 10^{-4}$, $P = 0.03$, $h = 250$, $h_e = 4000$, $A_e = A$, $\\theta_b = 20$, $\\theta_{\\text{init}} = 0$。\n\n**步骤 2：使用提取的给定信息进行验证**\n\n- **科学依据：** 该问题基于公认的一维瞬态翅片方程，这是传热分析中的标准模型，源于能量守恒原理和 Fourier 传导定律。边界条件（Dirichlet 和 Robin）是常见热条件的物理现实表示。所有参数均为标准物理属性。该问题不含伪科学，事实可靠。\n- **适定性：** 该问题是一个具有明确初始和边界条件的线性抛物型偏微分方程。这构成了一个适定的初边值问题。为其求解推导和实现一个标准数值方法（Crank-Nicolson）的任务也是适定的。\n- **客观性：** 问题使用精确的数学和物理术语陈述。任务是具体和定量的。没有主观或基于意见的元素。\n- **完整性与一致性：** 每个测试用例都提供了所有必要的物理参数、几何尺寸、初始/边界条件和数值参数。数据自洽且足以构建和解决问题。\n- **现实性与可行性：** 热属性和尺寸的值对应于现实的工程材料（例如，情况 1 中的铝合金，情况 3 中的钢/铜合金）和翅片几何形状。指定的数值方法是标准的，并且在计算上是可行的。\n\n**步骤 3：结论与行动**\n\n该问题是有效的。它是一个科学合理、适定且完整的计算传热学问题。我将继续进行推导和求解。\n\n### 2. Crank-Nicolson 格式的推导\n\n控制瞬态翅片方程为：\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta\n$$\n令 $\\theta_i^n \\approx \\theta(x_i, t^n)$ 为在空间网格点 $x_i = i\\Delta x$ 和时间层 $t^n = n\\Delta t$ 上过余温度的数值近似。\n\nCrank-Nicolson 方法使用在 $t^{n+1/2}$ 处中心化的前向差分来近似时间导数，并将空间项在时间层 $n$ 和 $n+1$ 上取平均值：\n$$\n\\frac{\\theta_i^{n+1} - \\theta_i^n}{\\Delta t} = \\frac{1}{2} \\left[ \\left(\\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta\\right)\\right]_i^{n+1} + \\frac{1}{2} \\left[ \\left(\\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta\\right)\\right]_i^{n}\n$$\n我们使用二阶中心差分近似来处理空间二阶导数：\n$$\n\\frac{\\partial^2 \\theta}{\\partial x^2}\\bigg|_i \\approx \\frac{\\theta_{i-1} - 2\\theta_i + \\theta_{i+1}}{(\\Delta x)^2}\n$$\n将其代入 Crank-Nicolson 公式可得：\n$$\n\\frac{\\theta_i^{n+1} - \\theta_i^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{\\theta_{i-1}^{n+1} - 2\\theta_i^{n+1} + \\theta_{i+1}^{n+1}}{(\\Delta x)^2} + \\frac{\\theta_{i-1}^{n} - 2\\theta_i^{n} + \\theta_{i+1}^{n}}{(\\Delta x)^2} \\right) - \\frac{s}{2}(\\theta_i^{n+1} + \\theta_i^n)\n$$\n我们定义扩散数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。乘以 $\\Delta t$ 并重新整理各项，将未知项（在时间层 $n+1$）分组到左侧（LHS），将已知项（在时间层 $n$）分组到右侧（RHS），我们得到：\n$$\n-\\frac{r}{2}\\theta_{i-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_i^{n+1} - \\frac{r}{2}\\theta_{i+1}^{n+1} = \\frac{r}{2}\\theta_{i-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_i^{n} + \\frac{r}{2}\\theta_{i+1}^{n}\n$$\n此方程对内部节点 $i = 1, 2, \\dots, N-1$ 有效。现在我们必须引入边界条件来修改节点 $i=1$ 和 $i=N$ 的方程。未知向量为 $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\theta_2^{n+1}, \\dots, \\theta_N^{n+1}]^{\\top}$。\n\n**根部边界条件（在 $i=0$ 处的 Dirichlet 条件）：**\n根部温度是固定的：$\\theta(0, t) = \\theta_b$。在我们的离散网格中，这意味着对于所有 $n \\ge 0$，$\\theta_0^n = \\theta_b$。\n对于第一个内部节点 $i=1$，通用方程为：\n$$\n-\\frac{r}{2}\\theta_{0}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_1^{n+1} - \\frac{r}{2}\\theta_2^{n+1} = \\frac{r}{2}\\theta_{0}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^{n} + \\frac{r}{2}\\theta_2^{n}\n$$\n由于 $\\theta_0^{n+1} = \\theta_0^n = \\theta_b$，我们将包含 $\\theta_0$ 的已知项移到右侧：\n$$\n\\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_1^{n+1} - \\frac{r}{2}\\theta_2^{n+1} = \\frac{r}{2}\\theta_b + \\frac{r}{2}\\theta_b + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^{n} + \\frac{r}{2}\\theta_2^{n}\n$$\n第一个未知数 $\\theta_1^{n+1}$ 的方程为：\n$$\n\\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_1^{n+1} - \\frac{r}{2}\\theta_2^{n+1} = r\\theta_b + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^{n} + \\frac{r}{2}\\theta_2^{n}.\n$$\n\n**尖端边界条件（在 $i=N$ 处的 Robin 条件）：**\n条件为 $-\\frac{\\partial \\theta}{\\partial x}(L,t) = \\beta \\theta(L,t)$。我们通过在 $x_{N+1} = x_N + \\Delta x$ 处引入一个“虚拟”节点，来使用二阶精确的中心差分来计算在 $x_N=L$ 处的导数。\n$$\n\\frac{\\partial \\theta}{\\partial x}\\bigg|_N \\approx \\frac{\\theta_{N+1} - \\theta_{N-1}}{2\\Delta x}\n$$\n将其代入 Robin 边界条件可得：\n$$\n-\\left(\\frac{\\theta_{N+1} - \\theta_{N-1}}{2\\Delta x}\\right) = \\beta \\theta_N \\quad \\implies \\quad \\theta_{N+1} = \\theta_{N-1} - 2\\beta\\Delta x \\theta_N\n$$\n这个关系用于从 $i=N$ 处的通用差分方程中消除虚拟节点 $\\theta_{N+1}$。我们在时间层 $n$ 和 $n+1$ 上都应用这个关系。\n节点 $i=N$ 的方程为：\n$$\n-\\frac{r}{2}\\theta_{N-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_N^{n+1} - \\frac{r}{2}\\theta_{N+1}^{n+1} = \\frac{r}{2}\\theta_{N-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_N^{n} + \\frac{r}{2}\\theta_{N+1}^{n}\n$$\n在左侧代入 $\\theta_{N+1}^{n+1} = \\theta_{N-1}^{n+1} - 2\\beta\\Delta x \\theta_N^{n+1}$，在右侧代入 $\\theta_{N+1}^{n} = \\theta_{N-1}^{n} - 2\\beta\\Delta x \\theta_N^{n}$：\nLHS: $-\\frac{r}{2}\\theta_{N-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_N^{n+1} - \\frac{r}{2}\\left(\\theta_{N-1}^{n+1} - 2\\beta\\Delta x \\theta_N^{n+1}\\right) = -r \\theta_{N-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2} + r\\beta\\Delta x\\right)\\theta_N^{n+1}$\n\nRHS: $\\frac{r}{2}\\theta_{N-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_N^{n} + \\frac{r}{2}\\left(\\theta_{N-1}^{n} - 2\\beta\\Delta x \\theta_N^{n}\\right) = r \\theta_{N-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2} - r\\beta\\Delta x\\right)\\theta_N^{n}$\n\n### 3. 三对角系统总结\n\n我们得到一个包含 $N$ 个方程的线性系统，用于求解 $N$ 个未知数 $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]^{\\top}$，其形式为 $\\mathbf{M} \\boldsymbol{\\theta}^{n+1} = \\mathbf{d}$。\n\n**矩阵 $\\mathbf{M}$ ($N \\times N$)：**\n这是一个具有以下系数的三对角矩阵。令行索引为 $j \\in \\{1,\\dots,N\\}$。\n- **次对角线 ($a_j$)：**\n  - 对于 $j = 2, \\dots, N-1$： $a_j = -\\frac{r}{2}$\n  - 对于 $j = N$： $a_N = -r$\n- **主对角线 ($b_j$)：**\n  - 对于 $j = 1, \\dots, N-1$： $b_j = 1 + r + \\frac{s \\Delta t}{2}$\n  - 对于 $j = N$： $b_N = 1 + r + \\frac{s \\Delta t}{2} + r\\beta\\Delta x$\n- **超对角线 ($c_j$)：**\n  - 对于 $j = 1, \\dots, N-1$： $c_j = -\\frac{r}{2}$\n\n**右端向量 $\\mathbf{d}$ (大小为 $N$)：**\n令分量索引为 $j \\in \\{1,\\dots,N\\}$。\n- **第一个分量 ($d_1$)：**\n  - $d_1 = r\\theta_b + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^n + \\frac{r}{2}\\theta_2^n$\n- **内部分量 ($d_j$，其中 $j=2, \\dots, N-1$)：**\n  - $d_j = \\frac{r}{2}\\theta_{j-1}^n + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_j^n + \\frac{r}{2}\\theta_{j+1}^n$\n- **最后一个分量 ($d_N$)：**\n  - $d_N = r\\theta_{N-1}^n + \\left(1 - r - \\frac{s \\Delta t}{2} - r\\beta\\Delta x\\right)\\theta_N^n$\n\n新时间步 $t^{n+1}$ 的温度解是通过使用时间 $t^n$ 的已知值建立该系统并求解 $\\boldsymbol{\\theta}^{n+1}$ 来找到的。然后将已知的根部温度 $\\theta_b$ 前置到解向量中，构建最终的温度向量：$[\\theta_b, \\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]$。",
            "answer": "```python\nimport numpy as np\n\ndef setup_and_solve_cn_step(params):\n    \"\"\"\n    Sets up and solves the Crank-Nicolson system for one time step.\n\n    Args:\n        params (dict): A dictionary containing all problem parameters.\n\n    Returns:\n        np.array: The temperature vector at the new time step, including the base.\n    \"\"\"\n    # Unpack parameters\n    L = params['L']\n    N = params['N']\n    dt = params['dt']\n    k = params['k']\n    rho = params['rho']\n    c = params['c']\n    A = params['A']\n    P = params['P']\n    h = params['h']\n    h_e = params['h_e']\n    A_e = params['A_e']\n    theta_b = params['theta_b']\n    theta_init = params['theta_init']\n    \n    # Calculate derived parameters\n    dx = L / N\n    alpha = k / (rho * c)\n    s = (h * P) / (rho * c * A)\n    beta = (h_e * A_e) / (k * A)\n    r = alpha * dt / (dx**2)\n\n    # Initial temperature vector theta^n for the single step calculation\n    # theta_n[0] is at x=0, theta_n[N] is at x=L\n    theta_n = np.full(N + 1, theta_init)\n    theta_n[0] = theta_b\n\n    # The vector of unknowns contains N elements: theta_{1} to theta_{N}\n    # We will construct an N x N matrix M and an N-element RHS vector d.\n    M = np.zeros((N, N))\n    d = np.zeros(N)\n\n    # --- Fill Matrix M (LHS coefficients) ---\n\n    # Main diagonal\n    diag_val = 1 + r + (s * dt / 2)\n    np.fill_diagonal(M, diag_val)\n    \n    # Sub-diagonal and Super-diagonal for interior nodes\n    sub_sup_val = -r / 2\n    if N > 1:\n        np.fill_diagonal(M[1:], sub_sup_val)  # Sub-diagonal\n        np.fill_diagonal(M[:, 1:], sub_sup_val) # Super-diagonal\n\n    # Modify last row for Robin BC at i=N\n    if N > 1:\n        M[N-1, N-2] = -r\n    M[N-1, N-1] = diag_val + r * beta * dx\n\n    # --- Fill RHS vector d ---\n\n    # First interior node (i=1)\n    # d[0] corresponds to the equation for theta_1\n    d[0] = r * theta_b + (1 - r - s * dt / 2) * theta_n[1]\n    if N > 1:\n        d[0] += (r / 2) * theta_n[2]\n\n    # Interior nodes (i=2 to N-1)\n    # d[j] corresponds to equation for theta_{j+1}\n    for j in range(1, N - 1):\n        d[j] = (r / 2) * theta_n[j] + \\\n               (1 - r - s * dt / 2) * theta_n[j+1] + \\\n               (r / 2) * theta_n[j+2]\n\n    # Last node (i=N)\n    # d[N-1] corresponds to equation for theta_N\n    if N > 1:\n        d[N-1] = r * theta_n[N-1] + \\\n                 (1 - r - s * dt / 2 - r * beta * dx) * theta_n[N]\n    else: # Case N=1\n        d[0] += (r * theta_n[0] + (1 - r - s * dt/2 - r*beta*dx) * theta_n[1]) - (1-r-s*dt/2)*theta_n[1]\n\n    # Solve the linear system M * theta_unknown_np1 = d\n    theta_unknown_np1 = np.linalg.solve(M, d)\n    \n    # Construct the full solution vector for t^{n+1}\n    theta_np1 = np.concatenate(([theta_b], theta_unknown_np1))\n\n    return theta_np1\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            'L': 0.05, 'N': 10, 'dt': 0.2,\n            'k': 205.0, 'rho': 2700.0, 'c': 900.0,\n            'A': 1.0e-4, 'P': 0.02, 'h': 55.0,\n            'h_e': 55.0, 'A_e': 1.0e-4,\n            'theta_b': 50.0, 'theta_init': 0.0\n        },\n        # Case 2\n        {\n            'L': 0.05, 'N': 10, 'dt': 0.2,\n            'k': 205.0, 'rho': 2700.0, 'c': 900.0,\n            'A': 1.0e-4, 'P': 0.02, 'h': 55.0,\n            'h_e': 0.0, 'A_e': 1.0e-4,\n            'theta_b': 50.0, 'theta_init': 0.0\n        },\n        # Case 3\n        {\n            'L': 0.03, 'N': 6, 'dt': 0.01,\n            'k': 150.0, 'rho': 8000.0, 'c': 500.0,\n            'A': 2.0e-4, 'P': 0.03, 'h': 250.0,\n            'h_e': 4000.0, 'A_e': 2.0e-4,\n            'theta_b': 20.0, 'theta_init': 0.0\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result_vector = setup_and_solve_cn_step(case_params)\n        # Format the result vector as a list of strings\n        result_str_list = [f\"{x:.10f}\" for x in result_vector]\n        results.append(f\"[{','.join(result_str_list)}]\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}