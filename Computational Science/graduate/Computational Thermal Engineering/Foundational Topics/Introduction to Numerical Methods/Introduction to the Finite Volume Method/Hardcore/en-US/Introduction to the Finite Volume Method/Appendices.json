{
    "hands_on_practices": [
        {
            "introduction": "The Finite Volume Method is founded on the integral form of physical conservation laws, transforming them into algebraic equations on a discrete mesh. This practice  explores this core concept by examining the net heat flux across a control volume for a hypothetical linear temperature field. You will see how the divergence theorem translates a volume integral into a sum of face fluxes and discover why the net flux is exactly zero in this special case, a result that reveals a fundamental geometric property of all closed volumes used in FVM.",
            "id": "3964711",
            "problem": "Consider a general three-dimensional hexahedral control volume with planar faces, denoted by the set of faces $\\{f\\}$, outward unit normals $\\mathbf{n}_{f}$, and face areas $A_{f}$. Let the temperature field be linear in space, $T(\\mathbf{x}) = a + \\mathbf{b}\\cdot \\mathbf{x}$, with constants $a \\in \\mathbb{R}$ and $\\mathbf{b} \\in \\mathbb{R}^{3}$. The thermal conductivity is constant and isotropic, $k>0$. There are no volumetric heat sources and the situation is steady. The diffusive heat flux vector is given by Fourier’s law $\\mathbf{q}(\\mathbf{x}) = -k \\nabla T(\\mathbf{x})$. In the Finite Volume Method (FVM), the net diffusive heat rate crossing the control-volume boundary is the surface integral of the normal component of $\\mathbf{q}$ over the closed surface.\n\nUsing only fundamental principles (energy conservation over a fixed control volume, Fourier’s law of heat conduction, and standard vector calculus identities), derive the finite-volume face-summed expression for the net diffusive heat rate crossing the closed surface, and then compute its exact value for the given linear temperature field and constant $k$. Express your final answer as the net diffusive heat rate in watt (W). Provide the exact value.\n\nAdditionally, verify by direct evaluation that the volume integral $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V$ is equal to zero for this control volume, and explain why this result is independent of the particular shape of the hexahedron as long as its faces are planar.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n-   Control volume: A general three-dimensional hexahedral control volume, $V$, with planar faces.\n-   Faces: The set of faces is denoted by $\\{f\\}$.\n-   Face normals: Outward unit normal vectors are $\\mathbf{n}_{f}$ for each face $f$.\n-   Face areas: The area of each face $f$ is $A_{f}$.\n-   Temperature field: $T(\\mathbf{x}) = a + \\mathbf{b}\\cdot \\mathbf{x}$, where $a \\in \\mathbb{R}$ is a scalar constant and $\\mathbf{b} \\in \\mathbb{R}^{3}$ is a constant vector.\n-   Thermal conductivity: $k$ is a positive constant ($k>0$) and isotropic.\n-   Heat sources: There are no volumetric heat sources.\n-   Time dependence: The process is in steady state.\n-   Heat flux: Fourier’s law gives the diffusive heat flux vector as $\\mathbf{q}(\\mathbf{x}) = -k \\nabla T(\\mathbf{x})$.\n-   Objective 1: Derive the finite-volume face-summed expression for the net diffusive heat rate and compute its exact value.\n-   Objective 2: Verify by direct evaluation that $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V = 0$.\n-   Objective 3: Explain why the result of Objective 2 is independent of the particular shape of the hexahedron.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria.\n-   **Scientifically Grounded**: The problem is based on the fundamental principles of heat transfer, namely the energy conservation law and Fourier's law of heat conduction. The mathematical framework relies on standard vector calculus. The assumption of a linear temperature field is a valid and common simplification used in numerical analysis and theoretical derivations.\n-   **Well-Posed**: The problem is fully specified. It provides all the necessary definitions, physical laws, and properties ($T(\\mathbf{x})$, $k$) to determine a unique solution.\n-   **Objective**: The problem is stated using precise, unambiguous mathematical and physical terminology. It is free from subjective or opinion-based content.\n-   **Consistency and Completeness**: The givens are self-consistent and sufficient. The condition of no volumetric heat sources is consistent with the implications of the given linear temperature field and constant conductivity, as will be shown in the solution.\n-   **Realism**: While a perfectly linear temperature field over a macroscopic volume is an idealization, it is a physically plausible local approximation and a standard scenario for analyzing numerical methods like the Finite Volume Method (FVM).\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid as it is scientifically sound, well-posed, and internally consistent. The solution process may proceed.\n\nThe solution is developed in three parts as requested.\n\n**Part 1: Net Diffusive Heat Rate**\nThe net diffusive heat rate, denoted $\\dot{Q}_{\\text{net}}$, out of a fixed control volume $V$ with a closed boundary surface $S$ is defined by the surface integral of the normal component of the heat flux vector $\\mathbf{q}$.\n$$ \\dot{Q}_{\\text{net}} = \\oint_{S} \\mathbf{q} \\cdot \\mathrm{d}\\mathbf{S} = \\oint_{S} \\mathbf{q} \\cdot \\mathbf{n} \\, \\mathrm{d}S $$\nIn the Finite Volume Method, the control volume is a polyhedron with a set of discrete, planar faces $\\{f\\}$. The surface integral is replaced by a sum of integrals over each face:\n$$ \\dot{Q}_{\\text{net}} = \\sum_{f} \\int_{A_f} \\mathbf{q} \\cdot \\mathbf{n}_f \\, \\mathrm{d}A_f $$\nwhere $\\mathbf{n}_f$ is the constant outward unit normal for the planar face $f$ of area $A_f$. A common FVM approximation assumes the flux is uniform over the face, equal to its value at the face centroid, leading to the algebraic expression $\\dot{Q}_{\\text{net}} \\approx \\sum_{f} (\\mathbf{q}_f \\cdot \\mathbf{n}_f) A_f$. However, in this problem, we can evaluate the expression exactly.\n\nFirst, we determine the heat flux vector $\\mathbf{q}(\\mathbf{x})$ from the given temperature field $T(\\mathbf{x}) = a + \\mathbf{b}\\cdot \\mathbf{x}$. The gradient of the temperature field is:\n$$ \\nabla T = \\nabla(a + \\mathbf{b}\\cdot \\mathbf{x}) = \\nabla a + \\nabla(\\mathbf{b}\\cdot \\mathbf{x}) $$\nSince $a$ is a scalar constant, $\\nabla a = \\mathbf{0}$. For the term $\\mathbf{b}\\cdot \\mathbf{x}$, where $\\mathbf{b} = (b_1, b_2, b_3)$ and $\\mathbf{x} = (x_1, x_2, x_3)$ are constant and position vectors respectively, we have $\\mathbf{b}\\cdot \\mathbf{x} = b_1 x_1 + b_2 x_2 + b_3 x_3$. The gradient is:\n$$ \\nabla(\\mathbf{b}\\cdot \\mathbf{x}) = \\left(\\frac{\\partial}{\\partial x_1}, \\frac{\\partial}{\\partial x_2}, \\frac{\\partial}{\\partial x_3}\\right) (b_1 x_1 + b_2 x_2 + b_3 x_3) = (b_1, b_2, b_3) = \\mathbf{b} $$\nThus, the temperature gradient is the constant vector $\\mathbf{b}$:\n$$ \\nabla T = \\mathbf{b} $$\nNow, we apply Fourier's law, $\\mathbf{q}(\\mathbf{x}) = -k \\nabla T(\\mathbf{x})$. Since both $k$ and $\\nabla T = \\mathbf{b}$ are constant, the heat flux vector $\\mathbf{q}$ is also constant throughout the entire domain:\n$$ \\mathbf{q}(\\mathbf{x}) = -k \\mathbf{b} $$\nSubstituting this constant heat flux vector into the expression for the net heat rate:\n$$ \\dot{Q}_{\\text{net}} = \\sum_{f} \\int_{A_f} (-k \\mathbf{b}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A_f $$\nSince $(-k \\mathbf{b})$, $\\mathbf{n}_f$ are all constant with respect to the integration over the area $A_f$, the dot product can be moved outside the integral:\n$$ \\dot{Q}_{\\text{net}} = \\sum_{f} \\left( (-k \\mathbf{b}) \\cdot \\mathbf{n}_f \\right) \\int_{A_f} \\mathrm{d}A_f = \\sum_{f} \\left( (-k \\mathbf{b}) \\cdot \\mathbf{n}_f \\right) A_f $$\nThis is the finite-volume face-summed expression for the net diffusive heat rate. We can further simplify this expression by factoring out the constant vector $-k \\mathbf{b}$:\n$$ \\dot{Q}_{\\text{net}} = (-k \\mathbf{b}) \\cdot \\left( \\sum_{f} A_f \\mathbf{n}_f \\right) $$\nA fundamental geometric property of any closed polyhedron is that the vector sum of its outward-pointing face-area vectors is the zero vector. That is:\n$$ \\sum_{f} A_f \\mathbf{n}_f = \\oint_S \\mathbf{n} \\, \\mathrm{d}S = \\mathbf{0} $$\nThis identity can be proven using the divergence theorem on an arbitrary constant vector field $\\mathbf{c}$: $\\int_V (\\nabla \\cdot \\mathbf{c}) \\, \\mathrm{d}V = \\oint_S \\mathbf{c} \\cdot \\mathbf{n} \\, \\mathrm{d}S$. Since $\\nabla \\cdot \\mathbf{c} = 0$, the left side is zero. The right side is $\\mathbf{c} \\cdot \\oint_S \\mathbf{n} \\, \\mathrm{d}S$. For this to be zero for any $\\mathbf{c}$, the integral (or sum) of the normal vectors must be zero.\n\nSubstituting this geometric identity into our expression for $\\dot{Q}_{\\text{net}}$:\n$$ \\dot{Q}_{\\text{net}} = (-k \\mathbf{b}) \\cdot \\mathbf{0} = 0 $$\nThe exact value for the net diffusive heat rate is $0$ W.\n\n**Part 2: Verification of the Volume Integral**\nWe are asked to verify that $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V = 0$.\nThe term $-\\nabla \\cdot (k \\nabla T)$ is the diffusive source term in the steady-state heat equation. With no volumetric sources, the heat equation is $\\nabla \\cdot (k \\nabla T) = 0$. Let's evaluate the divergence term explicitly.\nFrom Part 1, we established that for the given linear temperature field, $\\nabla T = \\mathbf{b}$, where $\\mathbf{b}$ is a constant vector.\nThe expression inside the divergence operator is $k \\nabla T = k \\mathbf{b}$. Since $k$ is a constant scalar and $\\mathbf{b}$ is a constant vector, $k \\mathbf{b}$ is a constant vector field.\nLet $\\mathbf{F} = k\\mathbf{b}$. The divergence of this constant vector field is:\n$$ \\nabla \\cdot \\mathbf{F} = \\nabla \\cdot (k\\mathbf{b}) = \\frac{\\partial(k b_1)}{\\partial x_1} + \\frac{\\partial(k b_2)}{\\partial x_2} + \\frac{\\partial(k b_3)}{\\partial x_3} = 0 + 0 + 0 = 0 $$\nThe divergence is identically zero at every point in space. Consequently, the integrand is zero everywhere within the volume $V$:\n$$ -\\nabla \\cdot (k \\nabla T) = 0 $$\nThe volume integral of zero over any volume is zero:\n$$ \\int_{V} 0 \\, \\mathrm{d}V = 0 $$\nThis verifies the assertion. By the divergence theorem, this volume integral must equal the net surface heat flux, $\\oint_S (k \\nabla T) \\cdot \\mathrm{d}\\mathbf{S} = -\\oint_S \\mathbf{q} \\cdot \\mathrm{d}\\mathbf{S} = -\\dot{Q}_{\\text{net}}$. Since we found $\\dot{Q}_{\\text{net}} = 0$ in Part 1, this result is consistent.\n\n**Part 3: Independence of Shape**\nThe result $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V = 0$ is independent of the particular shape of the hexahedron. The reason lies in the evaluation of the integrand, $-\\nabla \\cdot (k \\nabla T)$.\nAs shown in Part 2, the calculation that $\\nabla \\cdot (k \\nabla T)$ is zero relies only on two facts:\n1.  The thermal conductivity $k$ is constant.\n2.  The temperature field $T(\\mathbf{x})$ is a linear function of position, which makes its gradient $\\nabla T$ a constant vector.\n\nThe consequence is that the divergence of the constant vector field $k \\nabla T$ is zero at every point in space, $\\nabla \\cdot (k \\nabla T) \\equiv 0$. This is a pointwise identity that holds regardless of any control volume's existence or geometry. Since the integrand is identically zero, its integral over *any* volume $V$—be it a hexahedron, a sphere, a pyramid, or any other shape—will always be zero. The properties of the control volume (e.g., that it is a hexahedron with planar faces) are completely irrelevant to this conclusion.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Evaluating diffusive fluxes, which depend on the gradient of a field like temperature ($ \\mathbf{q} = -k \\nabla T $), requires an accurate numerical approximation of the gradient from discrete data. This practice  provides a hands-on comparison of two cornerstone techniques for this task: the Green-Gauss method and the least-squares method. By applying both schemes to a skewed control volume with a known temperature field, you will gain a practical understanding of how these methods work and why gradient reconstruction is a critical component of a robust FVM solver.",
            "id": "3964691",
            "problem": "A single skewed quadrilateral control volume in the plane is defined by its vertices listed in counterclockwise order: $\\left(0,0\\right)$, $\\left(1.8,0.2\\right)$, $\\left(2.0,1.3\\right)$, and $\\left(0.2,1.1\\right)$. Consider the scalar temperature field $T(x,y)=x^{2}+y$. Using principles appropriate for the finite volume method (FVM), carry out the following steps to compare two gradient reconstruction strategies and quantify their impact on linear reconstruction error:\n\n- Compute the polygon area $A$ and the centroid $\\boldsymbol{x}_{P}=\\left(x_{P},y_{P}\\right)$ using the standard geometric formulas for a simple polygon.\n\n- Using the Green–Gauss (GG) gradient, obtained from the divergence theorem discretized on the control-volume boundary, approximate the cell-centered gradient $\\nabla T\\big|_{P}$ by\n$$\n\\nabla T\\big|_{P}\\approx \\frac{1}{A}\\sum_{f=1}^{4}T\\big(\\boldsymbol{m}_{f}\\big)\\,\\boldsymbol{s}_{f},\n$$\nwhere $\\boldsymbol{m}_{f}$ is the midpoint of face $f$ and $\\boldsymbol{s}_{f}$ is the outward edge-normal vector of face $f$ of magnitude equal to the face length (constructed by rotating the edge vector $\\Delta \\boldsymbol{x}_{f}$ by $+90^{\\circ}$ so that $\\boldsymbol{s}_{f}=\\big(\\Delta y_{f},-\\Delta x_{f}\\big)$ for a counterclockwise-ordered polygon).\n\n- Using a uniformly weighted least-squares (LS) gradient, approximate the cell-centered gradient $\\nabla T\\big|_{P}$ by minimizing the sum of squared residuals built from the four vertex samples. With uniform weights, this leads to the normal equations\n$$\n\\left(\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\boldsymbol{d}_{i}^{\\mathsf{T}}\\right)\\boldsymbol{g}=\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\left[T\\left(\\boldsymbol{x}_{i}\\right)-T\\left(\\boldsymbol{x}_{P}\\right)\\right],\n$$\nwhere $\\boldsymbol{d}_{i}=\\boldsymbol{x}_{i}-\\boldsymbol{x}_{P}$ are the vectors from the centroid to vertex $i$, and $\\boldsymbol{g}$ is the least-squares estimate of $\\nabla T\\big|_{P}$.\n\n- For each method (GG and LS), form the first-order linear reconstruction at the four face midpoints using\n$$\nT_{\\text{rec}}^{(\\cdot)}\\big(\\boldsymbol{m}_{f}\\big)=T\\left(\\boldsymbol{x}_{P}\\right)+\\left[\\nabla T\\big|_{P}\\right]^{(\\cdot)}\\cdot\\left(\\boldsymbol{m}_{f}-\\boldsymbol{x}_{P}\\right),\n$$\nand compute the root-mean-square (RMS) reconstruction error over the four faces,\n$$\nE^{(\\cdot)}=\\sqrt{\\frac{1}{4}\\sum_{f=1}^{4}\\left[T_{\\text{rec}}^{(\\cdot)}\\big(\\boldsymbol{m}_{f}\\big)-T\\big(\\boldsymbol{m}_{f}\\big)\\right]^{2}}.\n$$\n\nReport the ratio of RMS errors $E^{(\\mathrm{GG})}/E^{(\\mathrm{LS})}$ as a pure number (dimensionless). Round your final answer to four significant figures.",
            "solution": "The problem requires a comparison of two gradient reconstruction schemes, Green-Gauss (GG) and Least-Squares (LS), on a specified quadrilateral control volume for a given scalar field. The final goal is to compute the ratio of the root-mean-square (RMS) reconstruction errors at the face midpoints.\n\nThe vertices of the quadrilateral, listed in counterclockwise order, are:\n$\\boldsymbol{x}_{1} = (0,0)$\n$\\boldsymbol{x}_{2} = (1.8,0.2)$\n$\\boldsymbol{x}_{3} = (2.0,1.3)$\n$\\boldsymbol{x}_{4} = (0.2,1.1)$\n\nThe scalar temperature field is given by $T(x,y) = x^2 + y$.\n\nFirst, we compute the area $A$ and centroid $\\boldsymbol{x}_{P} = (x_P, y_P)$ of the control volume.\nUsing the shoelace formula for the area of a simple polygon:\n$$A = \\frac{1}{2} \\left| \\sum_{i=1}^{4} (x_i y_{i+1} - x_{i+1} y_i) \\right|$$\nwhere $\\boldsymbol{x}_{5} = \\boldsymbol{x}_{1}$.\n$A = \\frac{1}{2} |(x_1 y_2 - x_2 y_1) + (x_2 y_3 - x_3 y_2) + (x_3 y_4 - x_4 y_3) + (x_4 y_1 - x_1 y_4)|$\n$A = \\frac{1}{2} |(0 \\cdot 0.2 - 1.8 \\cdot 0) + (1.8 \\cdot 1.3 - 2.0 \\cdot 0.2) + (2.0 \\cdot 1.1 - 0.2 \\cdot 1.3) + (0.2 \\cdot 0 - 0 \\cdot 1.1)|$\n$A = \\frac{1}{2} |0 + (2.34 - 0.4) + (2.2 - 0.26) + 0| = \\frac{1}{2} |1.94 + 1.94| = \\frac{1}{2}(3.88) = 1.94$\n\nThe control volume is a parallelogram, which can be confirmed by checking the vectors of opposite sides:\n$\\boldsymbol{x}_{2}-\\boldsymbol{x}_{1} = (1.8-0, 0.2-0) = (1.8, 0.2)$\n$\\boldsymbol{x}_{3}-\\boldsymbol{x}_{4} = (2.0-0.2, 1.3-1.1) = (1.8, 0.2)$\nFor a parallelogram, the centroid is the average of the vertices' coordinates:\n$x_P = \\frac{1}{4}(x_1+x_2+x_3+x_4) = \\frac{1}{4}(0+1.8+2.0+0.2) = \\frac{4.0}{4} = 1.0$\n$y_P = \\frac{1}{4}(y_1+y_2+y_3+y_4) = \\frac{1}{4}(0+0.2+1.3+1.1) = \\frac{2.6}{4} = 0.65$\nSo, the centroid is $\\boldsymbol{x}_{P} = (1.0, 0.65)$.\n\nNext, we compute the Green-Gauss (GG) gradient, $\\nabla T\\big|_{P}^{(\\mathrm{GG})} = \\frac{1}{A} \\sum_{f=1}^{4} T(\\boldsymbol{m}_{f}) \\boldsymbol{s}_{f}$.\nWe need the face midpoints $\\boldsymbol{m}_f$ and outward normal vectors $\\boldsymbol{s}_f$.\n\nFace 1 (v1 to v2):\n$\\Delta \\boldsymbol{x}_1 = \\boldsymbol{x}_2 - \\boldsymbol{x}_1 = (1.8, 0.2)$.\n$\\boldsymbol{s}_1 = (\\Delta y_1, -\\Delta x_1) = (0.2, -1.8)$.\n$\\boldsymbol{m}_1 = \\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2} = (0.9, 0.1)$.\n$T(\\boldsymbol{m}_1) = (0.9)^2 + 0.1 = 0.81 + 0.1 = 0.91$.\n$T(\\boldsymbol{m}_1)\\boldsymbol{s}_1 = 0.91(0.2, -1.8) = (0.182, -1.638)$.\n\nFace 2 (v2 to v3):\n$\\Delta \\boldsymbol{x}_2 = \\boldsymbol{x}_3 - \\boldsymbol{x}_2 = (0.2, 1.1)$.\n$\\boldsymbol{s}_2 = (1.1, -0.2)$.\n$\\boldsymbol{m}_2 = \\frac{\\boldsymbol{x}_2+\\boldsymbol{x}_3}{2} = (1.9, 0.75)$.\n$T(\\boldsymbol{m}_2) = (1.9)^2 + 0.75 = 3.61 + 0.75 = 4.36$.\n$T(\\boldsymbol{m}_2)\\boldsymbol{s}_2 = 4.36(1.1, -0.2) = (4.796, -0.872)$.\n\nFace 3 (v3 to v4):\n$\\Delta \\boldsymbol{x}_3 = \\boldsymbol{x}_4 - \\boldsymbol{x}_3 = (-1.8, -0.2)$.\n$\\boldsymbol{s}_3 = (-0.2, 1.8)$.\n$\\boldsymbol{m}_3 = \\frac{\\boldsymbol{x}_3+\\boldsymbol{x}_4}{2} = (1.1, 1.2)$.\n$T(\\boldsymbol{m}_3) = (1.1)^2 + 1.2 = 1.21 + 1.2 = 2.41$.\n$T(\\boldsymbol{m}_3)\\boldsymbol{s}_3 = 2.41(-0.2, 1.8) = (-0.482, 4.338)$.\n\nFace 4 (v4 to v1):\n$\\Delta \\boldsymbol{x}_4 = \\boldsymbol{x}_1 - \\boldsymbol{x}_4 = (-0.2, -1.1)$.\n$\\boldsymbol{s}_4 = (-1.1, 0.2)$.\n$\\boldsymbol{m}_4 = \\frac{\\boldsymbol{x}_4+\\boldsymbol{x}_1}{2} = (0.1, 0.55)$.\n$T(\\boldsymbol{m}_4) = (0.1)^2 + 0.55 = 0.01 + 0.55 = 0.56$.\n$T(\\boldsymbol{m}_4)\\boldsymbol{s}_4 = 0.56(-1.1, 0.2) = (-0.616, 0.112)$.\n\nThe sum is:\n$\\sum_{f=1}^{4} T(\\boldsymbol{m}_{f})\\boldsymbol{s}_{f} = (0.182+4.796-0.482-0.616, -1.638-0.872+4.338+0.112)$\n$\\sum_{f=1}^{4} T(\\boldsymbol{m}_{f})\\boldsymbol{s}_{f} = (3.88, 1.94)$.\n\nThe GG gradient is:\n$\\nabla T\\big|_{P}^{(\\mathrm{GG})} = \\frac{1}{1.94} (3.88, 1.94) = (2.0, 1.0)$.\n\nNext, we compute the Least-Squares (LS) gradient, $\\boldsymbol{g}=[\\nabla T\\big|_{P}]^{(\\mathrm{LS)}}$, by solving the normal equations $\\left(\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\boldsymbol{d}_{i}^{\\mathsf{T}}\\right)\\boldsymbol{g}=\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\left[T\\left(\\boldsymbol{x}_{i}\\right)-T\\left(\\boldsymbol{x}_{P}\\right)\\right]$.\n$T(\\boldsymbol{x}_P) = (1.0)^2 + 0.65 = 1.65$.\nThe displacement vectors $\\boldsymbol{d}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_P$ and vertex temperatures $T(\\boldsymbol{x}_i)$ are:\n$\\boldsymbol{d}_1 = (0,0) - (1.0, 0.65) = (-1.0, -0.65)$; $T(\\boldsymbol{x}_1) = 0$.\n$\\boldsymbol{d}_2 = (1.8,0.2) - (1.0, 0.65) = (0.8, -0.45)$; $T(\\boldsymbol{x}_2) = 1.8^2+0.2 = 3.44$.\n$\\boldsymbol{d}_3 = (2.0,1.3) - (1.0, 0.65) = (1.0, 0.65)$; $T(\\boldsymbol{x}_3) = 2.0^2+1.3 = 5.3$.\n$\\boldsymbol{d}_4 = (0.2,1.1) - (1.0, 0.65) = (-0.8, 0.45)$; $T(\\boldsymbol{x}_4) = 0.2^2+1.1 = 1.14$.\n\nThe LHS matrix $M = \\sum \\boldsymbol{d}_i\\boldsymbol{d}_i^{\\mathsf{T}}$:\n$M_{11} = (-1.0)^2 + (0.8)^2 + (1.0)^2 + (-0.8)^2 = 1.0 + 0.64 + 1.0 + 0.64 = 3.28$.\n$M_{12} = M_{21} = (-1.0)(-0.65) + (0.8)(-0.45) + (1.0)(0.65) + (-0.8)(0.45) = 0.65 - 0.36 + 0.65 - 0.36 = 0.58$.\n$M_{22} = (-0.65)^2 + (-0.45)^2 + (0.65)^2 + (0.45)^2 = 0.4225 + 0.2025 + 0.4225 + 0.2025 = 1.25$.\n$M = \\begin{pmatrix} 3.28 & 0.58 \\\\ 0.58 & 1.25 \\end{pmatrix}$.\n\nThe RHS vector $\\boldsymbol{b} = \\sum \\boldsymbol{d}_i(T_i - T_P)$:\nTerm 1: $(-1.0, -0.65)(0 - 1.65) = (1.65, 1.0725)$.\nTerm 2: $(0.8, -0.45)(3.44 - 1.65) = (0.8, -0.45)(1.79) = (1.432, -0.8055)$.\nTerm 3: $(1.0, 0.65)(5.3 - 1.65) = (1.0, 0.65)(3.65) = (3.65, 2.3725)$.\nTerm 4: $(-0.8, 0.45)(1.14 - 1.65) = (-0.8, 0.45)(-0.51) = (0.408, -0.2295)$.\n$\\boldsymbol{b} = (1.65+1.432+3.65+0.408, 1.0725-0.8055+2.3725-0.2295)^{\\mathsf{T}} = (7.14, 2.41)^{\\mathsf{T}}$.\n\nSolving $M\\boldsymbol{g}=\\boldsymbol{b}$:\n$\\det(M) = (3.28)(1.25)-(0.58)^2 = 4.1 - 0.3364 = 3.7636$.\n$\\boldsymbol{g} = M^{-1}\\boldsymbol{b} = \\frac{1}{3.7636}\\begin{pmatrix} 1.25 & -0.58 \\\\ -0.58 & 3.28 \\end{pmatrix} \\begin{pmatrix} 7.14 \\\\ 2.41 \\end{pmatrix}$.\n$g_x = \\frac{1}{3.7636}(1.25 \\cdot 7.14 - 0.58 \\cdot 2.41) = \\frac{8.925 - 1.3978}{3.7636} = \\frac{7.5272}{3.7636} = 2.0$.\n$g_y = \\frac{1}{3.7636}(-0.58 \\cdot 7.14 + 3.28 \\cdot 2.41) = \\frac{-4.1412 + 7.9048}{3.7636} = \\frac{3.7636}{3.7636} = 1.0$.\nThe LS gradient is $\\nabla T\\big|_{P}^{(\\mathrm{LS})} = (2.0, 1.0)$.\n\nThe exact gradient of $T(x,y)=x^2+y$ is $\\nabla T = (2x, 1)$. At the centroid $\\boldsymbol{x}_P=(1.0, 0.65)$, the exact gradient is $\\nabla T(\\boldsymbol{x}_P) = (2(1.0), 1) = (2.0, 1.0)$.\nBoth the GG and LS methods yield the exact gradient at the centroid for this particular problem. This occurs because the geometry is a parallelogram and the field is quadratic.\n\nSince both methods produce the same gradient vector, $\\nabla T\\big|_{P}^{(\\mathrm{GG})} = \\nabla T\\big|_{P}^{(\\mathrm{LS})}$, the linear reconstructions at the face midpoints will be identical for both methods:\n$T_{\\text{rec}}^{(\\mathrm{GG})}\\big(\\boldsymbol{m}_{f}\\big) = T(\\boldsymbol{x}_{P})+\\nabla T\\big|_{P}^{(\\mathrm{GG})}\\cdot(\\boldsymbol{m}_{f}-\\boldsymbol{x}_{P})$\n$T_{\\text{rec}}^{(\\mathrm{LS})}\\big(\\boldsymbol{m}_{f}\\big) = T(\\boldsymbol{x}_{P})+\\nabla T\\big|_{P}^{(\\mathrm{LS})}\\cdot(\\boldsymbol{m}_{f}-\\boldsymbol{x}_{P})$\nGiven the identical gradients, $T_{\\text{rec}}^{(\\mathrm{GG})}\\big(\\boldsymbol{m}_{f}\\big) = T_{\\text{rec}}^{(\\mathrm{LS})}\\big(\\boldsymbol{m}_{f}\\big)$ for all $f=1,..,4$.\n\nConsequently, the reconstruction errors at each face will be the same for both methods. The RMS errors are defined as:\n$E^{(\\mathrm{GG})}=\\sqrt{\\frac{1}{4}\\sum_{f=1}^{4}\\left[T_{\\text{rec}}^{(\\mathrm{GG})}\\big(\\boldsymbol{m}_{f}\\big)-T\\big(\\boldsymbol{m}_{f}\\big)\\right]^{2}}$\n$E^{(\\mathrm{LS})}=\\sqrt{\\frac{1}{4}\\sum_{f=1}^{4}\\left[T_{\\text{rec}}^{(\\mathrm{LS})}\\big(\\boldsymbol{m}_{f}\\big)-T\\big(\\boldsymbol{m}_{f}\\big)\\right]^{2}}$\nSince the terms in the summation are identical, it must be that $E^{(\\mathrm{GG})} = E^{(\\mathrm{LS})}$.\nThe reconstruction error is non-zero because the linear reconstruction of a quadratic function is not perfect. For example, for face 1:\n$\\boldsymbol{r}_1 = \\boldsymbol{m}_1 - \\boldsymbol{x}_P = (0.9, 0.1) - (1.0, 0.65) = (-0.1, -0.55)$.\n$T_{\\text{rec}}(\\boldsymbol{m}_1) = T(\\boldsymbol{x}_P) + \\nabla T\\big|_{P} \\cdot \\boldsymbol{r}_1 = 1.65 + (2.0, 1.0)\\cdot(-0.1, -0.55) = 1.65 - 0.2 - 0.55 = 0.90$.\nThe exact temperature is $T(\\boldsymbol{m}_1) = 0.91$.\nThe squared error for face 1 is $(0.90 - 0.91)^2 = (-0.01)^2 = 0.0001$. As this error is non-zero, both $E^{(\\mathrm{GG})}$ and $E^{(\\mathrm{LS})}$ are non-zero and equal.\n\nTherefore, the ratio of the RMS errors is:\n$\\frac{E^{(\\mathrm{GG})}}{E^{(\\mathrm{LS})}} = 1$.\n\nRounding to four significant figures as requested, the result is $1.000$.",
            "answer": "$$\n\\boxed{1.000}\n$$"
        },
        {
            "introduction": "Building a numerical solver is only half the battle; ensuring its correctness is just as crucial. This practice  introduces the Method of Manufactured Solutions (MMS), a powerful and standard procedure for code verification in computational science. You will implement a complete Finite Volume solver for a 2D heat diffusion problem and then systematically test it to confirm that your code's error decreases at the theoretically expected rate, a critical step in developing any reliable simulation software.",
            "id": "3964725",
            "problem": "Consider the steady two-dimensional heat diffusion equation in a square domain governed by the conservation of energy law with a volumetric source term. The governing equation is $-\\nabla \\cdot (k \\nabla T) = q$ in the domain and Dirichlet boundary conditions are applied on all boundaries. Assume a constant and isotropic thermal conductivity $k$ and a square domain $\\Omega = [0,1] \\times [0,1]$ measured in meters. The boundary temperature is prescribed as $T=0$ on all four sides of the square. Use the Method of Manufactured Solutions (MMS) by choosing the exact solution $T(x,y) = \\sin(\\pi x)\\sin(\\pi y)$, and derive the source term $q(x,y)$ so that the chosen $T(x,y)$ exactly satisfies the governing equation with constant $k$. Treat $k$ as a known positive constant with units of watts per meter-kelvin (W/(m·K)).\n\nYour task is to implement a uniform Cartesian, cell-centered Finite Volume Method (FVM) discretization for the above problem. The discretization must start from the integral form of conservation over each control volume, apply the Divergence Theorem, and approximate diffusive fluxes at faces using constant $k$ and second-order central differences between adjacent cell centers in the interior. For boundary-adjacent control volumes, impose Dirichlet boundary conditions weakly via boundary face fluxes using the known boundary temperature at the face. Treat the volumetric source as $q(x,y)$ evaluated at the cell center and multiplied by the control volume area. Solve the resulting linear system for the cell-centered temperature field and compute the error at the cell centers against the manufactured exact solution.\n\nDefine the control volumes on a grid with $N_x$ cells in the $x$-direction and $N_y$ cells in the $y$-direction, with uniform spacings $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$. The cell centers are located at $x_i = (i+1/2)\\Delta x$ for $i=0,1,\\dots,N_x-1$ and $y_j = (j+1/2)\\Delta y$ for $j=0,1,\\dots,N_y-1$. The face areas are $S_e=S_w=\\Delta y$ and $S_n=S_s=\\Delta x$, and the distances between adjacent cell centers are $d_e=d_w=\\Delta x$ and $d_n=d_s=\\Delta y$. For boundary faces, use half-distances $d=\\Delta x/2$ or $d=\\Delta y/2$ to the boundary face, and use the exact boundary temperature value $T_b=0$ at the face to compute the boundary flux. The volumetric source term is incorporated by multiplying the local source $q(x_i,y_j)$ by the control volume area $\\Delta x \\Delta y$.\n\nUnits: express all temperature errors in kelvin (K). The thermal conductivity $k$ should be treated in watts per meter-kelvin (W/(m·K)), and the source term $q$ in watts per cubic meter (W/m$^3$). Angles, where applicable in trigonometric functions, are in radians.\n\nTest suite:\n- Case A (happy path): $N_x=N_y=10$, $k=1$ W/(m·K).\n- Case B (refinement): $N_x=N_y=20$, $k=1$ W/(m·K).\n- Case C (refinement): $N_x=N_y=40$, $k=1$ W/(m·K).\n- Case D (refinement, near-asymptotic): $N_x=N_y=80$, $k=1$ W/(m·K).\n\nFor each case, compute:\n- The discrete $L^2$ error norm defined by $\\|e\\|_{L^2} = \\left( \\sum_{i,j} \\left( T_{ij}^{\\text{num}} - T(x_i,y_j) \\right)^2 \\Delta x \\Delta y \\right)^{1/2}$, in kelvin (K).\nAfter computing errors $(E_{10},E_{20},E_{40},E_{80})$, compute the observed orders of accuracy between successive refinements using $r_{m \\to n} = \\dfrac{\\ln(E_m/E_n)}{\\ln(h_m/h_n)}$ with $h = \\max(\\Delta x,\\Delta y)$, specifically $r_{10 \\to 20}$, $r_{20 \\to 40}$, and $r_{40 \\to 80}$. Finally, include a boolean flag that is true if all three observed orders are greater than or equal to $1.8$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order: $[E_{10},E_{20},E_{40},E_{80},r_{10 \\to 20},r_{20 \\to 40},r_{40 \\to 80},\\text{passed}]$. Each error and rate must be a floating-point number and the final flag must be a boolean literal. All temperature errors must be reported in kelvin (K).",
            "solution": "The problem is valid as it is scientifically grounded in the principles of heat transfer, mathematically well-posed, and provides a complete and unambiguous specification for a numerical solution using the Finite Volume Method (FVM) and verification via the Method of Manufactured Solutions (MMS).\n\nThe solution process involves three main stages:\n1.  Derivation of the source term $q(x,y)$ using the manufactured solution.\n2.  Discretization of the governing partial differential equation (PDE) using the cell-centered FVM to obtain a system of linear algebraic equations.\n3.  Implementation of a numerical solver to solve the linear system for the specified test cases and subsequent calculation of error norms and convergence rates.\n\n**1. Derivation of the Source Term**\n\nThe governing equation is the steady-state heat diffusion equation with a source term $q$:\n$$ -\\nabla \\cdot (k \\nabla T) = q $$\nGiven that the thermal conductivity $k$ is a constant scalar, this simplifies to the Poisson equation:\n$$ -k \\nabla^2 T = q $$\nwhere $\\nabla^2$ is the Laplacian operator, $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2}$.\n\nThe problem specifies a manufactured solution $T(x,y) = \\sin(\\pi x)\\sin(\\pi y)$. We must derive the source term $q(x,y)$ that makes this $T(x,y)$ an exact solution to the PDE. First, we compute the second partial derivatives of $T(x,y)$:\n$$ \\frac{\\partial T}{\\partial x} = \\pi \\cos(\\pi x)\\sin(\\pi y) \\implies \\frac{\\partial^2 T}{\\partial x^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\n$$ \\frac{\\partial T}{\\partial y} = \\pi \\sin(\\pi x)\\cos(\\pi y) \\implies \\frac{\\partial^2 T}{\\partial y^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\nThe Laplacian of $T$ is the sum of these derivatives:\n$$ \\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = -2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\nSubstituting this into the governing equation $q = -k \\nabla^2 T$, we find the source term:\n$$ q(x,y) = -k (-2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)) = 2k\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\nThis source term, when used in the simulation, will have the function $T(x,y) = \\sin(\\pi x)\\sin(\\pi y)$ as the exact solution. The chosen $T(x,y)$ also satisfies the Dirichlet boundary conditions $T=0$ on the boundaries of the domain $\\Omega = [0,1] \\times [0,1]$.\n\n**2. Finite Volume Discretization**\n\nWe discretize the governing PDE using a cell-centered Finite Volume Method. We start by integrating the PDE over a generic control volume (CV), denoted as $V_{ij}$, centered at $(x_i, y_j)$ with area $\\Delta V = \\Delta x \\Delta y$:\n$$ - \\int_{V_{ij}} \\nabla \\cdot (k \\nabla T) \\, dV = \\int_{V_{ij}} q \\, dV $$\nApplying the Divergence Theorem to the left-hand side converts the volume integral into a surface integral over the boundary of the control volume, $\\partial V_{ij}$:\n$$ - \\oint_{\\partial V_{ij}} (k \\nabla T) \\cdot \\mathbf{n} \\, dS = \\int_{V_{ij}} q \\, dV $$\nwhere $\\mathbf{n}$ is the outward-pointing normal vector on the boundary of the control volume. The surface integral represents the net heat flux out of the control volume. We can express this as a sum of fluxes over the four faces of the rectangular cell (east, west, north, south), denoted by subscripts $e, w, n, s$:\n$$ - \\left[ J_e + J_w + J_n + J_s \\right] = Q_{ij} $$\nwhere $J_f = \\int_f (k \\nabla T) \\cdot \\mathbf{n} \\, dS$ is the integrated heat flux through face $f$, and $Q_{ij} = \\int_{V_{ij}} q \\, dV$ is the total heat generated within the control volume.\n\nLet's use the physical interpretation: the rate of heat entering the CV must balance the rate of heat generation for steady state. The net heat flow into the cell from its neighbors is given by:\n$$ (J_w^{\\text{in}} - J_e^{\\text{out}}) + (J_s^{\\text{in}} - J_n^{\\text{out}}) + Q_{ij} = 0 $$\nApproximating the fluxes and the source term:\n- **Source Term**: The integrated source term is approximated by the value at the cell center multiplied by the cell volume: $Q_{ij} \\approx q(x_i, y_j) \\Delta x \\Delta y$.\n- **Fluxes**: The heat flux vector is $\\mathbf{j} = -k \\nabla T$. The heat flow through a face is the integral of the normal component of this flux over the face area. For the east face, with normal $\\mathbf{n}_e = (1,0)$ and area $S_e = \\Delta y$:\n$$ J_e^{\\text{out}} \\approx \\left( -k \\frac{\\partial T}{\\partial x} \\right)_e \\Delta y $$\nThe gradient at the face is approximated by a second-order central difference between the adjacent cell centers $P(i,j)$ and $E(i+1,j)$. The distance between centers is $d_e = \\Delta x$.\n$$ \\left( \\frac{\\partial T}{\\partial x} \\right)_e \\approx \\frac{T_{i+1,j} - T_{ij}}{\\Delta x} \\implies J_e^{\\text{out}} \\approx -k \\frac{T_{i+1,j} - T_{ij}}{\\Delta x} \\Delta y $$\nSimilarly for the other faces of an interior cell:\n$$ J_w^{\\text{in}} \\approx -k \\frac{T_{ij} - T_{i-1,j}}{\\Delta x} \\Delta y $$\n$$ J_n^{\\text{out}} \\approx -k \\frac{T_{i,j+1} - T_{ij}}{\\Delta y} \\Delta x $$\n$$ J_s^{\\text{in}} \\approx -k \\frac{T_{ij} - T_{i,j-1}}{\\Delta y} \\Delta x $$\nSubstituting these approximations into the balance equation:\n$$ -k \\frac{T_{ij} - T_{i-1,j}}{\\Delta x} \\Delta y - \\left(-k \\frac{T_{i+1,j} - T_{ij}}{\\Delta x} \\Delta y\\right) -k \\frac{T_{ij} - T_{i,j-1}}{\\Delta y} \\Delta x - \\left(-k \\frac{T_{i,j+1} - T_{ij}}{\\Delta y} \\Delta x\\right) + q_{ij} \\Delta x \\Delta y = 0 $$\nRearranging and collecting terms for $T_{ij}$:\n$$ k\\frac{\\Delta y}{\\Delta x}(T_{i-1,j} - T_{ij}) + k\\frac{\\Delta y}{\\Delta x}(T_{i+1,j} - T_{ij}) + k\\frac{\\Delta x}{\\Delta y}(T_{i,j-1} - T_{ij}) + k\\frac{\\Delta x}{\\Delta y}(T_{i,j+1} - T_{ij}) + q_{ij}\\Delta x \\Delta y = 0 $$\nWe define coefficients $a_W = a_E = k\\frac{\\Delta y}{\\Delta x}$ and $a_S = a_N = k\\frac{\\Delta x}{\\Delta y}$. The equation becomes:\n$$ (a_W+a_E+a_S+a_N)T_{ij} - a_W T_{i-1,j} - a_E T_{i+1,j} - a_S T_{i,j-1} - a_N T_{i,j+1} = q_{ij} \\Delta x \\Delta y $$\nLetting $a_P = a_W+a_E+a_S+a_N$, we arrive at the standard five-point stencil for an interior cell:\n$$ a_P T_{ij} - a_W T_{i-1,j} - a_E T_{i+1,j} - a_S T_{i,j-1} - a_N T_{i,j+1} = q_{ij} \\Delta x \\Delta y $$\n\n**Boundary Conditions:**\nFor cells adjacent to a boundary, the flux must be calculated using the prescribed boundary temperature $T_b=0$. Consider a cell on the west boundary ($i=0$). The distance from its center to the boundary is $d_w = \\Delta x/2$. The heat flow from the boundary into the cell is:\n$$ J_w^{\\text{in}} \\approx -k \\frac{T_{0j} - T_b}{\\Delta x/2} \\Delta y = -2k \\frac{\\Delta y}{\\Delta x}(T_{0j} - T_b) $$\nThe balance equation for cell $(0,j)$ (not a corner) includes this boundary flux term. The term $a_W(T_{i-1,j} - T_{ij})$ is replaced with this new expression.\nThe discrete equation for a boundary-adjacent cell is modified by moving all known boundary temperature terms to the right-hand side (source term) and adjusting the central coefficient $a_P$.\n-   **West boundary ($i=0$)**: $a_P$ is increased by $a_{W,b} = 2k \\frac{\\Delta y}{\\Delta x}$, and the source term is increased by $a_{W,b} T_b$. Since $T_b=0$, the source term is unchanged.\n-   **East boundary ($i=N_x-1$)**: $a_P$ is increased by $a_{E,b} = 2k\\frac{\\Delta y}{\\Delta x}$.\n-   **South boundary ($j=0$)**: $a_P$ is increased by $a_{S,b} = 2k\\frac{\\Delta x}{\\Delta y}$.\n-   **North boundary ($j=N_y-1$)**: $a_P$ is increased by $a_{N,b} = 2k\\frac{\\Delta x}{\\Delta y}$.\nA corner cell, e.g., $(0,0)$, receives modifications from two boundaries (west and south).\n\n**3. Linear System and Solution**\n\nThese discrete equations for all $N_x \\times N_y$ cells form a large, sparse, diagonally dominant system of linear equations $A\\mathbf{T} = \\mathbf{b}$, where $\\mathbf{T}$ is a vector of the unknown cell-center temperatures, $A$ is the coefficient matrix, and $\\mathbf{b}$ is the source vector. This system is solved numerically.\n\nThe final steps are:\n1.  Construct the matrix $A$ and vector $\\mathbf{b}$ for a given grid $(N_x, N_y)$ and conductivity $k$.\n2.  Solve $A\\mathbf{T} = \\mathbf{b}$ to find the numerical solution $T_{ij}^{\\text{num}}$.\n3.  Calculate the exact solution $T(x_i, y_j)$ at all cell centers.\n4.  Compute the discrete $L^2$ error norm: $\\|e\\|_{L^2} = \\left( \\sum_{i,j} \\left( T_{ij}^{\\text{num}} - T(x_i,y_j) \\right)^2 \\Delta x \\Delta y \\right)^{1/2}$.\n5.  With errors $E_m$ and $E_n$ for grids with characteristic cell sizes $h_m$ and $h_n$, compute the observed order of accuracy: $r_{m \\to n} = \\frac{\\ln(E_m/E_n)}{\\ln(h_m/h_n)}$. For successive grid refinements where $h_n = h_m/2$, this simplifies to $r = \\frac{\\ln(E_m/E_n)}{\\ln(2)}$. The expected order for this second-order scheme is $r \\approx 2$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\nimport math\n\n# --- DO NOT MODIFY THE CODE BELOW ---\n\ndef run_fvm_solver(Nx, Ny, k):\n    \"\"\"\n    Solves the 2D steady heat diffusion problem using a cell-centered FVM.\n\n    Args:\n        Nx (int): Number of cells in the x-direction.\n        Ny (int): Number of cells in the y-direction.\n        k (float): Thermal conductivity.\n\n    Returns:\n        float: The discrete L2 error norm of the solution.\n    \"\"\"\n    dx = 1.0 / Nx\n    dy = 1.0 / Ny\n    total_cells = Nx * Ny\n    \n    # Cell center coordinates\n    x_centers = (np.arange(Nx) + 0.5) * dx\n    y_centers = (np.arange(Ny) + 0.5) * dy\n    \n    A = lil_matrix((total_cells, total_cells))\n    b = np.zeros(total_cells)\n\n    def q_func(x, y, k_val):\n        return 2 * k_val * math.pi**2 * np.sin(math.pi * x) * np.sin(math.pi * y)\n    \n    T_b = 0.0\n\n    for j in range(Ny):\n        for i in range(Nx):\n            p = i + j * Nx\n            \n            # Source term contribution\n            b[p] = q_func(x_centers[i], y_centers[j], k) * dx * dy\n            \n            a_P = 0.0\n\n            # West face contribution\n            if i > 0:\n                a_W = k * dy / dx\n                A[p, p - 1] = -a_W\n                a_P += a_W\n            else: # West boundary\n                a_W_b = 2.0 * k * dy / dx\n                a_P += a_W_b\n                b[p] += a_W_b * T_b\n\n            # East face contribution\n            if i  Nx - 1:\n                a_E = k * dy / dx\n                A[p, p + 1] = -a_E\n                a_P += a_E\n            else: # East boundary\n                a_E_b = 2.0 * k * dy / dx\n                a_P += a_E_b\n                b[p] += a_E_b * T_b\n\n            # South face contribution\n            if j > 0:\n                a_S = k * dx / dy\n                A[p, p - Nx] = -a_S\n                a_P += a_S\n            else: # South boundary\n                a_S_b = 2.0 * k * dx / dy\n                a_P += a_S_b\n                b[p] += a_S_b * T_b\n            \n            # North face contribution\n            if j  Ny - 1:\n                a_N = k * dx / dy\n                A[p, p + Nx] = -a_N\n                a_P += a_N\n            else: # North boundary\n                a_N_b = 2.0 * k * dx / dy\n                a_P += a_N_b\n                b[p] += a_N_b * T_b\n\n            A[p, p] = a_P\n\n    A_csr = A.tocsr()\n    \n    T_vec = spsolve(A_csr, b)\n    T_num = T_vec.reshape((Ny, Nx))\n    \n    X, Y = np.meshgrid(x_centers, y_centers)\n    T_exact = np.sin(np.pi * X) * np.sin(np.pi * Y)\n    \n    error_sq_sum = np.sum((T_num - T_exact)**2)\n    l2_error = np.sqrt(error_sq_sum * dx * dy)\n    \n    return l2_error\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and compute results.\n    \"\"\"\n    test_cases = [\n        (10, 10, 1.0),\n        (20, 20, 1.0),\n        (40, 40, 1.0),\n        (80, 80, 1.0),\n    ]\n\n    errors = []\n    h_values = []\n    for Nx, Ny, k in test_cases:\n        error = run_fvm_solver(Nx, Ny, k)\n        errors.append(error)\n        h_values.append(max(1.0/Nx, 1.0/Ny))\n\n    E10, E20, E40, E80 = errors\n\n    if E20 == 0 or E40 == 0 or E80 == 0:\n        # Avoid division by zero if error is unexpectedly zero\n        r10_20, r20_40, r40_80 = (0.0, 0.0, 0.0)\n    else:\n        r10_20 = np.log(E10 / E20) / np.log(h_values[0] / h_values[1])\n        r20_40 = np.log(E20 / E40) / np.log(h_values[1] / h_values[2])\n        r40_80 = np.log(E40 / E80) / np.log(h_values[2] / h_values[3])\n\n    rates = [r10_20, r20_40, r40_80]\n    passed = all(rate >= 1.8 for rate in rates)\n\n    results = [E10, E20, E40, E80, r10_20, r20_40, r40_80, passed]\n    \n    # Format the output string correctly\n    result_str_parts = []\n    for item in results[:-1]:\n        result_str_parts.append(f\"{item}\")\n    result_str_parts.append(str(results[-1]).lower()) # for boolean 'true'/'false'\n\n    print(f\"[{','.join(result_str_parts)}]\")\n\nsolve()\n```"
        }
    ]
}