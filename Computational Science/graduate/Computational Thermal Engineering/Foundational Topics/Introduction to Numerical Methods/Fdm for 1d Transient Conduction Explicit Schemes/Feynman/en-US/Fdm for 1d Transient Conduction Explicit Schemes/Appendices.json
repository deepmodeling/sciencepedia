{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering any numerical method is to build a solver from first principles. This practice guides you through the complete workflow for the Forward-Time Centered-Space (FTCS) scheme, starting from the governing heat equation. You will derive the discrete update rule, perform a von Neumann stability analysis to establish the limit on the Fourier number $Fo$, and implement a working code to solve a problem with a known analytical solution, which is essential for verification . This foundational exercise connects the underlying theory of finite differences and numerical stability directly to a practical coding implementation.",
            "id": "3952352",
            "problem": "Consider a one-dimensional transient heat conduction problem in a homogeneous rod of length $L$ with fixed-temperature (Dirichlet) boundary conditions at both ends. Let $T(x,t)$ denote the temperature field, $\\alpha$ the thermal diffusivity (in $\\mathrm{m}^2/\\mathrm{s}$), and assume a uniform spatial partition with $N$ nodes, spacing $\\Delta x = L/(N-1)$. The rod ends at $x=0$ and $x=L$ are held at constant temperatures, and the initial temperature distribution is a single spatial eigenmode with amplitude $A$ expressed using the sine function. Angles must be treated in radians.\n\nStarting from the one-dimensional heat equation $ \\partial T / \\partial t = \\alpha \\, \\partial^2 T / \\partial x^2 $, derive a Forward-Time Centered-Space (FTCS) explicit finite difference scheme. Use a forward difference in time and a centered second-difference in space on the uniform grid described. Clearly derive the discrete update at interior nodes in terms of the Fourier number $Fo$, where $Fo$ must be defined directly from the discretization parameters and material properties. Impose the Dirichlet boundary conditions at all time levels.\n\nPerform a stability analysis based on a standard mode-amplification approach appropriate for linear constant-coefficient partial differential equations. Express the amplification factor in terms of $Fo$ and spatial wavenumber, and derive the condition on $Fo$ ensuring bounded amplification for all admissible discrete spatial modes. Use this condition to implement an a priori stability check in your algorithm.\n\nDesign and implement an algorithm that:\n- Constructs the spatial grid and initializes the temperature field using $T(x,0) = A \\, \\sin(m \\pi x / L)$ for a specified integer mode index $m$ compatible with the Dirichlet boundary conditions.\n- Advances the solution in time to a final time $t_f$ using the explicit FTCS scheme, enforcing boundary values at each step.\n- Evaluates the exact analytical solution at $t_f$ for the chosen initial mode, and computes the maximum absolute error between the numerical and exact solutions over the grid.\n- Reports a stability flag indicating whether the $Fo$ chosen satisfies the derived stability condition, along with quantitative diagnostics.\n\nPhysical units:\n- Report temperatures in Kelvin.\n- Report times in seconds.\n- Report lengths in meters.\n- Angles in the sine function must be in radians.\n\nYour program must implement loop-based updates over time steps and spatial nodes. For each test case, it must output a list of values containing, in order:\n- A boolean stability flag using the derived $Fo$ criterion.\n- A float equal to the maximum absolute error at $t_f$ in Kelvin.\n- A float equal to the maximum absolute temperature magnitude at $t_f$ in Kelvin.\n- A float equal to $t_f$ in seconds.\n\nTest suite:\n- Test Case 1 (happy path): $L = 1.0$ $\\mathrm{m}$, $\\alpha = 1.0 \\times 10^{-4}$ $\\mathrm{m}^2/\\mathrm{s}$, $N=41$, $\\Delta t = 0.1$ $\\mathrm{s}$, $t_f = 1.0$ $\\mathrm{s}$, $A=1.0$ $\\mathrm{K}$, $m=1$.\n- Test Case 2 (boundary condition on stability): $L = 1.0$ $\\mathrm{m}$, $\\alpha = 1.0 \\times 10^{-4}$ $\\mathrm{m}^2/\\mathrm{s}$, $N=101$, $\\Delta t = 0.5$ $\\mathrm{s}$, $t_f = 5.0$ $\\mathrm{s}$, $A=1.0$ $\\mathrm{K}$, $m=1$.\n- Test Case 3 (edge case probing instability with high-frequency content): $L = 1.0$ $\\mathrm{m}$, $\\alpha = 1.0 \\times 10^{-4}$ $\\mathrm{m}^2/\\mathrm{s}$, $N=101$, $\\Delta t = 0.6$ $\\mathrm{s}$, $t_f = 3.0$ $\\mathrm{s}$, $A=1.0$ $\\mathrm{K}$, $m=N-2$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to a test case and must itself be a list in the order specified above. For example: $[ [\\text{flag}_1, \\text{err}_1, \\text{maxT}_1, \\text{t}_1], [\\text{flag}_2, \\text{err}_2, \\text{maxT}_2, \\text{t}_2], [\\text{flag}_3, \\text{err}_3, \\text{maxT}_3, \\text{t}_3] ]$.",
            "solution": "The problem requires the derivation, stability analysis, and implementation of the Forward-Time Centered-Space (FTCS) explicit finite difference method for the one-dimensional transient heat conduction equation. The solution is then compared against a known analytical solution to assess its accuracy.\n\nThe governing partial differential equation (PDE) for one-dimensional heat conduction is:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\nwhere $T(x,t)$ is the temperature at spatial coordinate $x$ and time $t$, and $\\alpha$ is the thermal diffusivity of the material. The problem is defined on a spatial domain $x \\in [0, L]$ with homogeneous Dirichlet boundary conditions, $T(0, t) = 0$ and $T(L, t) = 0$. The initial temperature distribution is given as a single spatial eigenmode:\n$$ T(x,0) = A \\sin\\left(\\frac{m \\pi x}{L}\\right) $$\nwhere $A$ is the amplitude and $m$ is an integer mode index.\n\nFirst, we derive the FTCS finite difference scheme. We discretize the domain into a uniform grid with $N$ spatial nodes, indexed by $i=0, 1, \\dots, N-1$, such that $x_i = i \\Delta x$, where the spatial step is $\\Delta x = L/(N-1)$. Time is discretized with a constant step $\\Delta t$, such that $t_n = n \\Delta t$. The temperature at a grid point $(x_i, t_n)$ is denoted by $T_i^n$.\n\nThe time derivative $\\partial T/\\partial t$ is approximated using a first-order accurate forward difference:\n$$ \\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t} $$\nThe spatial second derivative $\\partial^2 T/\\partial x^2$ is approximated using a second-order accurate centered difference:\n$$ \\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} $$\nSubstituting these approximations into the governing PDE yields the FTCS scheme:\n$$ \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} \\right) $$\nThis equation can be rearranged to provide an explicit update rule for the temperature at the next time level, $T_i^{n+1}$, based on temperatures at the current level, $T^n$:\n$$ T_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n) $$\nWe define the non-dimensional Fourier number, $Fo$, as:\n$$ Fo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} $$\nThe update equation for interior nodes ($i=1, \\dots, N-2$) is written compactly as:\n$$ T_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = (1 - 2Fo)T_i^n + Fo(T_{i-1}^n + T_{i+1}^n) $$\n\nNext, we perform a von Neumann stability analysis to determine the constraints on $Fo$ for a stable solution. We consider the propagation of a single Fourier mode of the numerical solution, $T_i^n = G^n e^{\\mathrm{j}k_w x_i}$, where $G$ is the amplification factor per time step, $k_w$ is the spatial wavenumber, and $\\mathrm{j}=\\sqrt{-1}$. Substituting this into the discretized equation:\n$$ G^{n+1} e^{\\mathrm{j}k_w x_i} = (1 - 2Fo) G^n e^{\\mathrm{j}k_w x_i} + Fo (G^n e^{\\mathrm{j}k_w x_{i-1}} + G^n e^{\\mathrm{j}k_w x_{i+1}}) $$\nDividing by $G^n e^{\\mathrm{j}k_w x_i}$ and using $x_{i\\pm1} = x_i \\pm \\Delta x$:\n$$ G = (1 - 2Fo) + Fo (e^{-\\mathrm{j}k_w \\Delta x} + e^{\\mathrm{j}k_w \\Delta x}) $$\nUsing Euler's identity, $e^{\\mathrm{j}\\theta} + e^{-\\mathrm{j}\\theta} = 2\\cos(\\theta)$, we get:\n$$ G = 1 - 2Fo + 2Fo \\cos(k_w \\Delta x) = 1 - 2Fo(1 - \\cos(k_w \\Delta x)) $$\nWith the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$ G = 1 - 4Fo\\sin^2\\left(\\frac{k_w \\Delta x}{2}\\right) $$\nFor stability, the magnitude of the amplification factor must not exceed unity for all possible wavenumbers, i.e., $|G| \\le 1$. This implies $-1 \\le G \\le 1$.\nThe condition $G \\le 1$ is always satisfied, since $Fo > 0$ and $\\sin^2(\\cdot) \\ge 0$.\nThe condition $G \\ge -1$ provides the stability constraint:\n$$ 1 - 4Fo\\sin^2\\left(\\frac{k_w \\Delta x}{2}\\right) \\ge -1 $$\n$$ 2 \\ge 4Fo\\sin^2\\left(\\frac{k_w \\Delta x}{2}\\right) \\implies Fo \\le \\frac{1}{2\\sin^2\\left(\\frac{k_w \\Delta x}{2}\\right)} $$\nThis constraint must hold for all wavenumbers. The most restrictive case occurs when $\\sin^2(k_w \\Delta x / 2)$ is maximum, which is $1$. This corresponds to the highest frequency mode resolvable on the grid, where $k_w \\Delta x = \\pi$. This yields the final stability criterion for the FTCS scheme:\n$$ Fo \\le \\frac{1}{2} $$\n\nThe analytical solution to the PDE with the given initial and boundary conditions can be found using separation of variables. Since the initial condition is already a single eigenfunction $\\sin(m \\pi x / L)$ of the spatial operator with the given boundary conditions, the solution's time evolution is an exponential decay of this mode:\n$$ T_{\\text{exact}}(x,t) = A \\sin\\left(\\frac{m \\pi x}{L}\\right) \\exp\\left(-\\alpha \\left(\\frac{m \\pi}{L}\\right)^2 t\\right) $$\nThis exact solution is used to compute the error of the numerical scheme.\n\nThe algorithm proceeds as follows:\n1. For each test case, define the parameters $L, \\alpha, N, \\Delta t, t_f, A, m$.\n2. Compute derived grid parameters $\\Delta x = L/(N-1)$ and the Fourier number $Fo = \\alpha \\Delta t / (\\Delta x)^2$.\n3. Perform an a priori stability check: if $Fo \\le 0.5$, the scheme is stable.\n4. Initialize a spatial grid $x$ and the temperature array $T$ according to the initial condition $T(x,0)$.\n5. Iterate in time from $t=0$ to $t_f$. In each time step, create a copy of the current temperature field. Then, loop over all interior spatial nodes ($i=1, \\dots, N-2$) and update the temperature using the FTCS formula. The boundary temperatures at $i=0$ and $i=N-1$ remain fixed at $0$.\n6. After the final time step, calculate the exact solution $T_{\\text{exact}}(x,t_f)$.\n7. Compute the maximum absolute error, $\\max_i |T_i - T_{\\text{exact}}(x_i, t_f)|$, and the maximum absolute temperature magnitude, $\\max_i |T_i|$, from the numerical solution.\n8. Report the stability flag, maximum absolute error, maximum absolute temperature, and final time $t_f$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D transient heat conduction problem using an explicit FTCS scheme\n    for a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, alpha, N, dt, tf, A, m)\n        (1.0, 1.0e-4, 41, 0.1, 1.0, 1.0, 1),\n        (1.0, 1.0e-4, 101, 0.5, 5.0, 1.0, 1),\n        (1.0, 1.0e-4, 101, 0.6, 3.0, 1.0, 101 - 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, alpha, N, dt, tf, A, m = case\n\n        # 1. Setup grid and parameters\n        dx = L / (N - 1)\n        x = np.linspace(0.0, L, N)\n        Fo = alpha * dt / (dx**2)\n\n        # 2. Stability Check\n        is_stable = Fo = 0.5\n\n        # 3. Initialization\n        T = A * np.sin(m * np.pi * x / L)\n        \n        # Dirichlet boundary conditions are fixed at T=0.\n        # They are correctly set by the initial condition and will not be\n        # updated in the spatial loop.\n        T[0] = 0.0\n        T[-1] = 0.0\n\n        # 4. Time Marching Loop\n        # The problem requires loop-based updates.\n        num_steps = int(round(tf / dt))\n        \n        for n in range(num_steps):\n            T_old = T.copy()\n            # Loop over interior nodes\n            for i in range(1, N - 1):\n                T[i] = T_old[i] + Fo * (T_old[i+1] - 2 * T_old[i] + T_old[i-1])\n\n        # 5. Final Calculations\n        # The final simulation time is num_steps * dt, which equals tf for these cases.\n        t_final = num_steps * dt\n\n        # Analytical solution at t_final\n        decay_term = np.exp(-alpha * (m * np.pi / L)**2 * t_final)\n        T_exact = A * np.sin(m * np.pi * x / L) * decay_term\n\n        # Metrics\n        # In case of instability, T can become NaN\n        if np.isnan(T).any():\n            max_abs_error = float('inf')\n            max_abs_temp = float('inf')\n        else:\n            max_abs_error = np.max(np.abs(T - T_exact))\n            max_abs_temp = np.max(np.abs(T))\n\n        results.append([is_stable, max_abs_error, max_abs_temp, tf])\n\n    # Final print statement in the exact required format.\n    # str() on a list of lists produces the required format with spaces.\n    # The join(map(...)) idiom is more complex and produces a slightly different\n    # spacing, so we use the simpler and more standard str() conversion.\n    print(str(results).replace(\"'\", '\"'))\n\nsolve()\n\n```"
        },
        {
            "introduction": "After establishing the mathematical stability criterion, it is crucial to understand its physical basis. This exercise explores the concept of positivity, a fundamental property of diffusion processes, and demonstrates how it is linked to the stability of the numerical scheme . By analyzing the coefficients of the explicit update formula, you will see how a Fourier number $Fo \\gt 0.5$ leads to non-physical behavior, providing a deeper, more intuitive reason for the stability limit beyond abstract mathematics. This practice illuminates why an unstable scheme doesn't just produce inaccurate results, but fundamentally violates the physics it is meant to simulate.",
            "id": "3952406",
            "problem": "Consider one-dimensional heat diffusion in a homogeneous rod with constant material properties, governed by the conservation of energy and Fourier’s law of heat conduction. The governing partial differential equation is the standard diffusion equation with constant thermal diffusivity. Using a uniform spatial grid and uniform time steps, construct an explicit time-marching Finite Difference Method (FDM) scheme by combining a forward time discretization and a centered spatial discretization. Do not assume any pre-derived formula for the update. Begin from conservation of energy over a differential control volume and Fourier’s law to obtain the diffusion equation, and then perform the discrete approximations in time and space. Identify the dimensionless combination of the time step and the grid spacing that arises from the discretization. Use it to express the update at an interior node as a linear combination of the current node and its nearest neighbors at the previous time level. Prove, by analyzing the coefficients of this linear combination, that there exists a threshold such that beyond it one coefficient becomes negative. Explain why this negativity implies a violation of the positivity-preserving property for nonnegative initial data.\n\nThen, illustrate the consequence with a specific numerical example specification that uses nondimensional variables (so no physical units are needed). Consider a uniform grid of $N$ nodes with $N=11$ labeled by indices $i=0,1,\\dots,10$, with Dirichlet boundary conditions $T_0^n=0$ and $T_{10}^n=0$ for all time levels $n$. The initial condition at time level $n=0$ is nonnegative and concentrated at the center node only: let the center index be $i_c=(N-1)/2=5$, set $T_{i_c}^0=1$, and set $T_i^0=0$ for all $i\\neq i_c$. Perform exactly one explicit time update for three distinct values of the dimensionless time step parameter (the Fourier number): $Fo\\in\\{0.25,0.5,0.6\\}$.\n\nYour program must, for each of these three $Fo$ values, compute two outputs:\n- A boolean indicating whether all three update coefficients in the interior-node linear combination are nonnegative.\n- The minimum nodal value after one time step, $\\min_i T_i^{1}$, computed on the specified grid and boundary/initial data.\n\nTest suite:\n- Case A (happy path): $Fo=0.25$.\n- Case B (boundary): $Fo=0.5$.\n- Case C (beyond threshold): $Fo=0.6$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as follows:\n$[b_{0.25},m_{0.25},b_{0.5},m_{0.5},b_{0.6},m_{0.6}]$,\nwhere $b_{Fo}$ is the boolean coefficient-nonnegativity indicator for the given $Fo$, and $m_{Fo}$ is the corresponding minimum value $\\min_i T_i^{1}$ as a float. Since the setting is fully nondimensional, there are no physical units to report.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We begin by deriving the explicit Finite Difference Method (FDM) scheme from first principles.\n\n**1. Derivation of the Governing Equation and Discretization**\n\nThe one-dimensional transient heat conduction in a homogeneous medium with constant properties is governed by the conservation of energy. For an arbitrary control volume of length $\\Delta x$ and uniform cross-sectional area $A$, the energy balance is:\n$$ \\frac{dE_{stored}}{dt} = \\dot{E}_{in} - \\dot{E}_{out} $$\nwhere $E_{stored}$ is the internal energy stored in the volume, and $\\dot{E}$ represents the rate of energy transfer. The stored energy is $$ E_{stored} = \\int_{x}^{x+\\Delta x} \\rho c_p T(x', t) A dx' $$, where $\\rho$ is the density and $c_p$ is the specific heat capacity. The rate of change of stored energy is thus $$ \\frac{dE_{stored}}{dt} \\approx \\rho c_p A \\Delta x \\frac{\\partial T}{\\partial t} $$.\n\nThe energy transfer is by conduction, governed by Fourier's law, $q = -kA \\frac{\\partial T}{\\partial x}$, where $k$ is the thermal conductivity. The net rate of heat conduction into the volume is $ \\dot{E}_{in} - \\dot{E}_{out} = q_x - q_{x+\\Delta x} $.\nSubstituting these into the energy balance yields:\n$$ \\rho c_p A \\Delta x \\frac{\\partial T}{\\partial t} \\approx \\left(-kA \\frac{\\partial T}{\\partial x}\\right)\\bigg|_x - \\left(-kA \\frac{\\partial T}{\\partial x}\\right)\\bigg|_{x+\\Delta x} $$\nDividing by $A \\Delta x$ and rearranging gives:\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} \\approx k \\frac{\\left(\\frac{\\partial T}{\\partial x}\\right)\\bigg|_{x+\\Delta x} - \\left(\\frac{\\partial T}{\\partial x}\\right)\\bigg|_x}{\\Delta x} $$\nIn the limit as $\\Delta x \\to 0$, this becomes the exact partial differential equation (PDE):\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} $$\nDividing by $\\rho c_p$ yields the standard diffusion equation, where $\\alpha = k / (\\rho c_p)$ is the thermal diffusivity:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\nTo discretize this equation, we use a uniform grid in space and time, where $T(x_i, t_n)$ is denoted by $T_i^n$, with $x_i = i \\Delta x$ and $t_n = n \\Delta t$. We approximate the derivatives using finite differences.\nThe time derivative is approximated by a first-order forward difference:\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_{(i,n)} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t} $$\nThe spatial second derivative is approximated by a second-order central difference:\n$$ \\frac{\\partial^2 T}{\\partial x^2}\\bigg|_{(i,n)} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} $$\nSubstituting these approximations into the PDE gives the Forward-Time Centered-Space (FTCS) explicit scheme:\n$$ \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} $$\nSolving for the temperature at the new time level, $T_i^{n+1}$, we obtain the update equation:\n$$ T_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n) $$\nThe dimensionless grouping is the mesh Fourier number, $Fo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$. Substituting $Fo$ simplifies the update equation:\n$$ T_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) $$\nThis can be expressed as a linear combination of the temperatures at the previous time level by collecting terms:\n$$ T_i^{n+1} = (Fo) T_{i-1}^n + (1 - 2Fo) T_i^n + (Fo) T_{i+1}^n $$\n\n**2. Analysis of Positivity and Stability**\n\nThe update equation expresses the new temperature $T_i^{n+1}$ as a weighted average of the temperatures at the neighboring nodes at the previous time step $n$. The coefficients of this linear combination are:\n*   $C_{i-1} = Fo$\n*   $C_i = 1 - 2Fo$\n*   $C_{i+1} = Fo$\n\nFor the numerical solution to be physically meaningful, it should respect the second law of thermodynamics. For a diffusion problem with non-negative initial data and no heat sinks, the temperature at any point should not fall below the initial minimum temperature. This is known as the positivity-preserving property. A sufficient condition to ensure this is that all coefficients in the linear combination are non-negative.\n1. $C_{i-1} = Fo \\ge 0$. This is always true since $\\alpha, \\Delta t, \\Delta x$ are all non-negative.\n2. $C_{i+1} = Fo \\ge 0$. This is also always true.\n3. $C_i = 1 - 2Fo \\ge 0$. This imposes a constraint: $1 \\ge 2Fo \\implies Fo \\le \\frac{1}{2}$.\n\nTherefore, the threshold for the Fourier number is $Fo=0.5$. If $Fo > 0.5$, the coefficient $C_i = 1-2Fo$ becomes negative. This negativity implies that the temperature at the central node $T_i^n$, if it is a local maximum, will contribute negatively to its own future value $T_i^{n+1}$.\n\nTo demonstrate this violation, consider the specified initial condition: $T_i^0 = 0$ for all $i$ except for the center node $i_c=5$, where $T_5^0 = 1$. Let us compute the temperature at this central node after one time step, $T_5^1$:\n$$ T_5^1 = Fo \\cdot T_4^0 + (1 - 2Fo) \\cdot T_5^0 + Fo \\cdot T_6^0 $$\nSubstituting the initial values $T_4^0 = 0$, $T_5^0 = 1$, and $T_6^0 = 0$:\n$$ T_5^1 = Fo \\cdot (0) + (1 - 2Fo) \\cdot (1) + Fo \\cdot (0) = 1 - 2Fo $$\nIf $Fo > 0.5$, then $2Fo > 1$, which makes $T_5^1 = 1 - 2Fo  0$. Starting from an entirely non-negative temperature field, the scheme produces a negative temperature, which is physically impossible for a pure diffusion process and signifies numerical instability.\n\nThe numerical part of the problem requires performing this calculation for $Fo$ values of $0.25$, $0.5$, and $0.6$. This will be implemented in the program. For each case, we will first check if all coefficients are non-negative ($Fo \\le 0.5$) and then compute the minimum temperature after one time step using the supplied initial and boundary conditions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D transient heat conduction problem using an explicit FDM scheme\n    for three specified Fourier numbers and calculates the requested outputs.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [0.25, 0.5, 0.6]\n\n    results = []\n    \n    # Problem specifications for the numerical example\n    N = 11  # Number of nodes\n    i_c = (N - 1) // 2  # Index of the center node, (11-1)/2 = 5\n\n    # Initial Condition (at time n=0)\n    T0 = np.zeros(N)\n    T0[i_c] = 1.0\n\n    for Fo in test_cases:\n        # --- Part 1: Check if all coefficients are non-negative ---\n        # The coefficients are Fo, (1 - 2*Fo), and Fo.\n        # Since Fo is always >= 0, we only need to check (1 - 2*Fo).\n        coeffs_are_nonnegative = (1 - 2 * Fo) >= 0\n\n        # --- Part 2: Compute temperature distribution after one time step ---\n        # Initialize temperature array for the next time step (n=1)\n        T1 = np.zeros(N)\n\n        # The boundary conditions are T_0^n = 0 and T_{10}^n = 0.\n        # Since T1 is initialized to zeros, these are automatically satisfied.\n\n        # Apply the explicit update formula for all interior nodes (i = 1 to N-2)\n        # T_i^{n+1} = Fo * T_{i-1}^n + (1 - 2*Fo) * T_i^n + Fo * T_{i+1}^n\n        for i in range(1, N - 1):\n            T1[i] = Fo * T0[i - 1] + (1 - 2 * Fo) * T0[i] + Fo * T0[i + 1]\n\n        # Find the minimum nodal value in the new temperature distribution\n        min_T1 = np.min(T1)\n\n        # Append the results for this case\n        results.append(coeffs_are_nonnegative)\n        results.append(min_T1)\n        \n    # Format the results into the required string format.\n    # The map(str, ...) converts each item (boolean or float) to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    # Note: Python's `str()` on booleans produces \"True\" and \"False\" with capital letters.\n    # The problem description implies these are the desired boolean representations.\n    # We replace them with lowercase to be certain, though typically this is not required.\n    print(output_str.replace('True', 'true').replace('False', 'false'))\n\nsolve()\n\n```"
        },
        {
            "introduction": "A critical skill in computational engineering is code verification—the process of ensuring that your code solves the mathematical equations correctly. This practice introduces the method of manufactured solutions and mesh refinement studies, which are standard procedures for verifying the order of accuracy of a numerical scheme . By systematically refining the spatial and temporal discretization and measuring the resulting error against a known exact solution, you will empirically determine the convergence rates of your FTCS solver. This process builds confidence in your implementation and reinforces the theoretical error analysis of the explicit method.",
            "id": "3952361",
            "problem": "Consider the one-dimensional transient heat conduction problem governed by the heat equation on a closed interval with fixed temperature boundaries. The physical model is the standard partial differential equation\n$$\n\\frac{\\partial T(x,t)}{\\partial t} = \\alpha \\,\\frac{\\partial^2 T(x,t)}{\\partial x^2},\n$$\nwhere $T(x,t)$ is the temperature field, $x \\in [0,L]$ is the spatial coordinate, $t \\ge 0$ is time, and $\\alpha$ is the thermal diffusivity. The spatial domain length is $L$, and the thermal diffusivity is $\\alpha$. Boundary conditions are homogeneous Dirichlet,\n$$\nT(0,t) = 0 \\;\\text{and}\\; T(L,t) = 0 \\quad \\text{for all } t \\ge 0,\n$$\nand the initial condition is\n$$\nT(x,0) = \\sin\\!\\left(\\frac{\\pi x}{L}\\right).\n$$\nThis field evolves according to the heat equation; for this specific initial and boundary condition, the exact solution is known to be\n$$\nT_{\\text{exact}}(x,t) = \\sin\\!\\left(\\frac{\\pi x}{L}\\right) \\exp\\!\\left(-\\alpha \\left(\\frac{\\pi}{L}\\right)^2 t\\right).\n$$\n\nUse the Finite Difference Method (FDM) with the explicit forward-time and central-space scheme to approximate the temperature field. Define the Fourier number (Fo) as\n$$\nFo = \\frac{\\alpha\\,\\Delta t}{\\Delta x^2},\n$$\nwhere $\\Delta x$ is the spatial step and $\\Delta t$ is the time step. The explicit scheme in one spatial dimension requires $Fo \\le \\frac{1}{2}$ for stability.\n\nStarting from the preceding physical laws and definitions, plan and execute a mesh refinement study under the following scenarios, and compute the observed convergence rates. For each scenario, approximate the solution to time $t_{\\text{end}}$, compare the numerical field $T_{\\text{num}}(x,t_{\\text{end}})$ against the exact field $T_{\\text{exact}}(x,t_{\\text{end}})$, and define the error as the discrete $L^2$-norm over the interior grid points with uniform spacing,\n$$\nE = \\left( \\sum_{i=1}^{N-1} \\left[T_{\\text{num}}(x_i,t_{\\text{end}}) - T_{\\text{exact}}(x_i,t_{\\text{end}})\\right]^2 \\Delta x \\right)^{1/2},\n$$\nwhere $x_i = i\\,\\Delta x$ for $i = 0,1,\\dots,N$ and $N = \\frac{L}{\\Delta x}$ is an integer. For each refinement pair $(\\Delta x_1,\\Delta x_2)$ or $(\\Delta t_1,\\Delta t_2)$, estimate the observed order $p$ by fitting the error to a power law using two resolutions,\n$$\np = \\frac{\\ln\\!\\left(\\frac{E_2}{E_1}\\right)}{\\ln\\!\\left(\\frac{h_2}{h_1}\\right)},\n$$\nwhere $h$ denotes the refinement parameter ($h=\\Delta x$ when studying spatial refinement, $h=\\Delta t$ when studying temporal refinement), and $E_1$ and $E_2$ are the errors on the coarse and refined grids, respectively. In all cases, use integer numbers of time steps; when $t_{\\text{end}}$ is not an exact multiple of $\\Delta t$, compute $t_{\\text{num}} = n \\,\\Delta t$ with $n = \\mathrm{round}\\!\\left(\\frac{t_{\\text{end}}}{\\Delta t}\\right)$ and compare against $T_{\\text{exact}}(x,t_{\\text{num}})$ to ensure consistency.\n\nPerform the following test suite with scientifically realistic parameters. All quantities with physical units are specified; convergence rates are dimensionless and must be reported as plain decimal numbers.\n\n- Test $1$ (spatial refinement, stable interior Fourier number): \n  - $L = 1$ (meter), $\\alpha = 7.19 \\times 10^{-5}$ (meter squared per second), $t_{\\text{end}} = 19$ (second), $Fo = 0.4$.\n  - Coarse spatial step: $\\Delta x_1 = \\frac{L}{50}$, refined spatial step: $\\Delta x_2 = \\frac{L}{100}$.\n  - Time steps are chosen to keep $Fo$ fixed: $\\Delta t_j = Fo\\,\\frac{\\Delta x_j^2}{\\alpha}$ for $j \\in \\{1,2\\}$.\n  - Return the observed spatial convergence rate $p_{\\text{space},\\,0.4}$.\n\n- Test $2$ (spatial refinement, boundary stability Fourier number):\n  - $L = 1$ (meter), $\\alpha = 7.19 \\times 10^{-5}$ (meter squared per second), $t_{\\text{end}} = 19$ (second), $Fo = 0.5$.\n  - Coarse spatial step: $\\Delta x_1 = \\frac{L}{50}$, refined spatial step: $\\Delta x_2 = \\frac{L}{100}$.\n  - Time steps are chosen to keep $Fo$ fixed: $\\Delta t_j = Fo\\,\\frac{\\Delta x_j^2}{\\alpha}$ for $j \\in \\{1,2\\}$.\n  - Return the observed spatial convergence rate $p_{\\text{space},\\,0.5}$.\n\n- Test $3$ (temporal refinement at fixed spatial resolution): \n  - $L = 1$ (meter), $\\alpha = 7.19 \\times 10^{-5}$ (meter squared per second), $t_{\\text{end}} = 19$ (second).\n  - Fixed spatial step: $\\Delta x = \\frac{L}{100}$.\n  - Coarse time step: $\\Delta t_1 = 0.556$ (second), refined time step: $\\Delta t_2 = 0.278$ (second).\n  - Return the observed temporal convergence rate $p_{\\text{time}}$.\n\nYour program must compute the three rates and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[p_{\\text{space},\\,0.4}, p_{\\text{space},\\,0.5}, p_{\\text{time}}]$. Since these convergence rates are dimensionless, express them as decimal numbers without any unit and round them in the program to six decimal places in the final output.",
            "solution": "The problem statement has been rigorously validated and is determined to be sound. It is scientifically grounded, well-posed, objective, and provides a complete and consistent set of definitions and parameters for a standard numerical analysis exercise in computational heat transfer. All components—the governing partial differential equation (PDE), boundary and initial conditions, the corresponding exact solution, the specified numerical scheme, and the metrics for error and convergence—are standard and correctly formulated. The test cases are designed to systematically investigate the convergence properties of the chosen numerical method.\n\nThe problem requires the numerical solution of the one-dimensional transient heat conduction equation,\n$$\n\\frac{\\partial T(x,t)}{\\partial t} = \\alpha \\,\\frac{\\partial^2 T(x,t)}{\\partial x^2}\n$$\non a spatial domain $x \\in [0,L]$ with homogeneous Dirichlet boundary conditions $T(0,t)=T(L,t)=0$ and an initial condition $T(x,0) = \\sin(\\pi x / L)$.\n\nThe numerical approach is the Finite Difference Method (FDM) using an explicit Forward-Time, Central-Space (FTCS) scheme. Let the temperature at discrete grid point $x_i = i\\,\\Delta x$ and time $t_n = n\\,\\Delta t$ be denoted by $T_i^n$. The FTCS discretization of the heat equation is derived by approximating the time derivative with a first-order forward difference and the spatial derivative with a second-order central difference:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2} \\right)\n$$\nwhere $i = 1, \\dots, N-1$ are the interior spatial indices, with $N=L/\\Delta x$. Rearranging to solve for the temperature at the next time step, $T_i^{n+1}$, gives the explicit update rule:\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha\\,\\Delta t}{\\Delta x^2} \\left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \\right)\n$$\nIntroducing the dimensionless Fourier number, $Fo = \\frac{\\alpha\\,\\Delta t}{\\Delta x^2}$, the update equation simplifies to:\n$$\nT_i^{n+1} = T_i^n + Fo \\left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \\right) = Fo\\,T_{i-1}^n + (1 - 2Fo)T_i^n + Fo\\,T_{i+1}^n\n$$\nThis scheme is known to be stable only if the Fourier number satisfies the condition $Fo \\le 1/2$. All specified test cases adhere to this stability constraint.\n\nThe overall algorithm to solve the problem for a given set of parameters $(\\Delta x, \\Delta t)$ is as follows:\n1.  Establish the computational grid. The number of spatial intervals is $N = L/\\Delta x$. The spatial grid points are $x_i = i\\,\\Delta x$ for $i=0, 1, \\dots, N$.\n2.  Initialize the temperature field at time $t=0$ using the given initial condition: $T_i^0 = \\sin(\\pi x_i/L)$ for all $i$.\n3.  Determine the total number of time steps. As specified, this is $n_{\\text{steps}} = \\mathrm{round}(t_{\\text{end}}/\\Delta t)$. The final simulation time is thus $t_{\\text{num}} = n_{\\text{steps}}\\,\\Delta t$.\n4.  Iterate from time step $n=0$ to $n=n_{\\text{steps}}-1$. In each step, compute the temperature field $T^{n+1}$ from $T^n$ using the FTCS update rule for all interior points $i=1, \\dots, N-1$. The boundary conditions $T_0^{n+1}=0$ and $T_N^{n+1}=0$ are enforced at every step.\n5.  After the final time step, compute the exact solution at the numerical end time $t_{\\text{num}}$ on the same spatial grid: $T_{\\text{exact}}(x_i, t_{\\text{num}}) = \\sin(\\pi x_i / L) \\exp(-\\alpha (\\pi/L)^2 t_{\\text{num}})$.\n6.  Calculate the discrete $L^2$-norm of the error, $E$, over the interior grid points using the provided formula:\n    $$\n    E = \\left( \\sum_{i=1}^{N-1} \\left[T_i^{n_{\\text{steps}}} - T_{\\text{exact}}(x_i, t_{\\text{num}})\\right]^2 \\Delta x \\right)^{1/2}\n    $$\nFor each test, two simulations are run: one with a coarse discretization parameter ($h_1$, which is either $\\Delta x_1$ or $\\Delta t_1$) and one with a refined parameter ($h_2$). The corresponding errors, $E_1$ and $E_2$, are then used to compute the observed order of convergence, $p$:\n$$\np = \\frac{\\ln(E_2/E_1)}{\\ln(h_2/h_1)}\n$$\n\nThe theoretical truncation error of the FTCS scheme is $O(\\Delta t, \\Delta x^2)$.\n- For the spatial refinement tests (Test 1 and 2), the time step $\\Delta t$ is coupled to the spatial step $\\Delta x$ via a fixed Fourier number, $\\Delta t = Fo\\,\\Delta x^2/\\alpha$. Thus, the total error is expected to scale with $\\Delta x^2$, and the theoretical convergence rate is $p_{\\text{space}}=2$.\n- For the temporal refinement test (Test 3), $\\Delta x$ is held constant while $\\Delta t$ is varied. The error is thus dominated by the first-order term in time, and the theoretical convergence rate is $p_{\\text{time}}=1$.\n\nThe program will execute these steps for the three specified test cases to determine the observed convergence rates $p_{\\text{space},\\,0.4}$, $p_{\\text{space},\\,0.5}$, and $p_{\\text{time}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(L, alpha, t_end, delta_x, delta_t):\n    \"\"\"\n    Runs a single 1D transient heat conduction simulation using the FTCS scheme.\n\n    Args:\n        L (float): Length of the spatial domain.\n        alpha (float): Thermal diffusivity.\n        t_end (float): Target end time for the simulation.\n        delta_x (float): Spatial step size.\n        delta_t (float): Time step size.\n\n    Returns:\n        float: The discrete L2-norm of the error.\n    \"\"\"\n    # 1. Establish grid and parameters\n    # As per problem, N = L/delta_x is an integer.\n    N = int(round(L / delta_x))\n    x = np.linspace(0, L, N + 1)\n    Fo = alpha * delta_t / delta_x**2\n\n    # Stability check (problem statement ensures this, but good practice)\n    if Fo > 0.5:\n        raise ValueError(f\"Stability condition not met: Fo = {Fo} > 0.5\")\n\n    # 2. Initialize temperature field\n    T = np.sin(np.pi * x / L)\n\n    # 3. Determine number of time steps and final numerical time\n    n_steps = int(round(t_end / delta_t))\n    t_num = n_steps * delta_t\n\n    # 4. Time-stepping loop\n    for _ in range(n_steps):\n        # Use a copy to store the new values\n        T_new = T.copy()\n        # Apply FTCS update rule for interior points\n        T_new[1:-1] = T[1:-1] + Fo * (T[2:] - 2 * T[1:-1] + T[:-2])\n        T = T_new\n        # Boundary conditions T(0)=0 and T(L)=0 are maintained as endpoints are not updated\n\n    # 5. Compute exact solution at the final numerical time\n    T_exact = np.sin(np.pi * x / L) * np.exp(-alpha * (np.pi / L)**2 * t_num)\n\n    # 6. Calculate the discrete L2-norm of the error over interior points\n    # (T[1:-1] - T_exact[1:-1]) is the vector of differences at interior points\n    error_sq_sum = np.sum((T[1:-1] - T_exact[1:-1])**2)\n    error = np.sqrt(error_sq_sum * delta_x)\n    \n    return error\n\ndef calculate_convergence_rate(E1, E2, h1, h2):\n    \"\"\"Calculates the observed order of convergence p.\"\"\"\n    return np.log(E2 / E1) / np.log(h2 / h1)\n\ndef solve():\n    \"\"\"\n    Executes the mesh refinement study as described in the problem statement.\n    \"\"\"\n    # Common parameters\n    L = 1.0  # meter\n    alpha = 7.19e-5  # meter^2/s\n    t_end = 19.0  # second\n\n    results = []\n\n    # Test 1: Spatial refinement with Fo = 0.4\n    Fo_1 = 0.4\n    dx1_1 = L / 50.0\n    dx1_2 = L / 100.0\n    dt1_1 = Fo_1 * dx1_1**2 / alpha\n    dt1_2 = Fo_1 * dx1_2**2 / alpha\n    E1_1 = run_simulation(L, alpha, t_end, dx1_1, dt1_1)\n    E1_2 = run_simulation(L, alpha, t_end, dx1_2, dt1_2)\n    p_space_04 = calculate_convergence_rate(E1_1, E1_2, dx1_1, dx1_2)\n    results.append(p_space_04)\n\n    # Test 2: Spatial refinement with Fo = 0.5\n    Fo_2 = 0.5\n    dx2_1 = L / 50.0\n    dx2_2 = L / 100.0\n    dt2_1 = Fo_2 * dx2_1**2 / alpha\n    dt2_2 = Fo_2 * dx2_2**2 / alpha\n    E2_1 = run_simulation(L, alpha, t_end, dx2_1, dt2_1)\n    E2_2 = run_simulation(L, alpha, t_end, dx2_2, dt2_2)\n    p_space_05 = calculate_convergence_rate(E2_1, E2_2, dx2_1, dx2_2)\n    results.append(p_space_05)\n    \n    # Test 3: Temporal refinement at fixed spatial resolution\n    dx3 = L / 100.0\n    dt3_1 = 0.556\n    dt3_2 = 0.278\n    E3_1 = run_simulation(L, alpha, t_end, dx3, dt3_1)\n    E3_2 = run_simulation(L, alpha, t_end, dx3, dt3_2)\n    p_time = calculate_convergence_rate(E3_1, E3_2, dt3_1, dt3_2)\n    results.append(p_time)\n\n    # Format and print the final output\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}