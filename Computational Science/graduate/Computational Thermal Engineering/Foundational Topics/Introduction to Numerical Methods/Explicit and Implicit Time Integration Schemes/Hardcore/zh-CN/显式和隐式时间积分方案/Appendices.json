{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们的实践探索，我们首先来解决显式时间积分的基石：时间前向中心差分 (FTCS) 格式。虽然这种格式实现简单，但其应用受到严格的稳定性条件制约。练习  将指导你通过冯·诺依曼稳定性分析，推导出允许的最大时间步长，从而揭示时间步长、空间分辨率和材料属性之间的关键关系。掌握这一计算是成功应用任何显式方法的基础。",
            "id": "2483538",
            "problem": "一个均匀、各向同性的一维固体，其热扩散系数为常数，其特性由从能量守恒和傅里叶定律推导出的瞬态热方程所决定，该方程为 $\\frac{\\partial T}{\\partial t}=\\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}$，其中 $T$ 是温度，$t$ 是时间，$x$ 是沿杆的空间坐标，$\\alpha$ 是热扩散系数。考虑一个间距为 $\\Delta x$ 的均匀网格，并应用前向时间中心空间 (FTCS) 显式时间积分方案，该方案使用前向欧拉步在时间上推进 $T$，并通过二阶中心差分来近似空间二阶导数。使用冯·诺依曼 (Fourier) 稳定性分析，确定最大时间步长 $\\Delta t_{\\max}$，使得该方案对所有空间傅里叶模式都处于临界稳定状态。\n\n使用数据 $\\alpha=1.4\\times 10^{-5}\\,\\mathrm{m^{2}/s}$ 和 $\\Delta x=0.5\\,\\mathrm{mm}$，计算此一维 FTCS 离散化对应的 $\\Delta t_{\\max}$。将您的答案四舍五入到四位有效数字，并以秒为单位表示时间。",
            "solution": "该问题陈述具有科学依据，提法恰当，并包含了获得唯一解所需的所有信息。因此，该问题被认为是有效的。我们着手进行求解。\n\n一维瞬态热传导的控制方程如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n这里，$T(x, t)$ 是温度，$x$ 是空间坐标，$t$ 是时间，$\\alpha$ 是热扩散系数。我们需要分析该方程的前向时间中心空间 (FTCS) 离散格式的稳定性。\n\n我们定义一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格。在网格节点 $i$ 和时间层 $n$ 的温度表示为 $T_i^n \\equiv T(i\\Delta x, n\\Delta t)$。\n\nFTCS 格式按如下方式近似偏导数：\n时间导数使用一阶前向差分进行近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n空间二阶导数使用二阶中心差分进行近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n将这些近似值代入控制方程，得到 FTCS 格式的离散形式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} \\right)\n$$\n我们可以重新排列这个方程，以显式求解下一个时间步的温度 $T_i^{n+1}$：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\n我们定义无量纲傅里叶数 $Fo$，也称为扩散数，为：\n$$\nFo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n离散方程简化为：\n$$\nT_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = Fo \\, T_{i+1}^n + (1 - 2Fo)T_i^n + Fo \\, T_{i-1}^n\n$$\n为了确定此数值格式的稳定性，我们进行冯·诺依曼稳定性分析。我们考虑解的单个傅里叶模式的行为。设时间层 $n$ 的温度分布由一个傅里叶分量表示：\n$$\nT_i^n = \\hat{T}^n(k) e^{\\mathrm{i} k x_i}\n$$\n其中 $k$ 是波数，$x_i = i\\Delta x$ 是节点 $i$ 的空间位置，$\\mathrm{i} = \\sqrt{-1}$ 是虚数单位。在时间 $n$ 这个模式的振幅是 $\\hat{T}^n(k)$。经过一个时间步长后，该模式将被放大一个因子 $G(k)$，即放大因子：\n$$\nT_i^{n+1} = \\hat{T}^{n+1}(k) e^{\\mathrm{i} k x_i} = G(k) \\hat{T}^n(k) e^{\\mathrm{i} k x_i}\n$$\n为了使数值格式稳定，对于任何波数 $k$，放大因子的模都不能超过1。稳定性条件是：\n$$\n|G(k)| \\le 1\n$$\n我们将傅里叶模式的表示代入离散方程中：\n$$\nG(k) \\hat{T}^n(k) e^{\\mathrm{i} k (i\\Delta x)} = Fo \\, \\hat{T}^n(k) e^{\\mathrm{i} k ((i+1)\\Delta x)} + (1 - 2Fo) \\hat{T}^n(k) e^{\\mathrm{i} k (i\\Delta x)} + Fo \\, \\hat{T}^n(k) e^{\\mathrm{i} k ((i-1)\\Delta x)}\n$$\n两边同除以 $\\hat{T}^n(k) e^{\\mathrm{i} k (i\\Delta x)}$，得到放大因子 $G(k)$ 的表达式：\n$$\nG(k) = Fo \\, e^{\\mathrm{i} k \\Delta x} + (1 - 2Fo) + Fo \\, e^{-\\mathrm{i} k \\Delta x}\n$$\n使用欧拉恒等式 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$，我们可以简化此表达式：\n$$\nG(k) = 1 - 2Fo + Fo (e^{\\mathrm{i} k \\Delta x} + e^{-\\mathrm{i} k \\Delta x}) = 1 - 2Fo + 2Fo \\cos(k \\Delta x)\n$$\n$$\nG(k) = 1 - 2Fo(1 - \\cos(k \\Delta x))\n$$\n使用三角半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\nG(k) = 1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n现在我们应用稳定性条件 $|G(k)| \\le 1$。由于 $Fo > 0$，项 $4Fo \\sin^2(k\\Delta x/2)$ 是非负的。因此，$G(k)$ 总是小于或等于 $1$。稳定性因此由下界决定：\n$$\nG(k) \\ge -1\n$$\n$$\n1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n这个不等式必须对所有可能的波数 $k$ 都成立。最严格的条件发生在项 $\\sin^2(k\\Delta x/2)$ 达到其最大值时。$\\sin^2(\\theta)$ 的最大值是 $1$。这对应于网格上可表示的最高频率（振荡最快）的模式，此时 $k \\Delta x = \\pi$。\n因此，稳定性条件变为：\n$$\nFo \\le \\frac{1}{2}\n$$\n临界稳定性在此条件的极限处达到，即 $Fo = 1/2$。最大允许时间步长 $\\Delta t_{\\max}$ 对应于此极限：\n$$\n\\frac{\\alpha \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\n求解 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n我们已知以下数据：\n$\\alpha = 1.4 \\times 10^{-5} \\, \\mathrm{m^2/s}$\n$\\Delta x = 0.5 \\, \\mathrm{mm} = 0.5 \\times 10^{-3} \\, \\mathrm{m}$\n\n将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n(\\Delta x)^2 = (0.5 \\times 10^{-3} \\, \\mathrm{m})^2 = 0.25 \\times 10^{-6} \\, \\mathrm{m^2}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25 \\times 10^{-6} \\, \\mathrm{m^2}}{2 \\times (1.4 \\times 10^{-5} \\, \\mathrm{m^2/s})} = \\frac{0.25 \\times 10^{-6}}{2.8 \\times 10^{-5}} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25}{2.8} \\times 10^{-1} \\, \\mathrm{s} \\approx 0.0892857 \\times 10^{-1} \\, \\mathrm{s} = 0.00892857 \\, \\mathrm{s}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 0.008929 \\, \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{0.008929}\n$$"
        },
        {
            "introduction": "显式格式严格的时间步长 $\\Delta t$ 限制可能会导致计算成本过高，特别是对于涉及精细网格或快速扩散过程的问题。隐式方法通过提供无条件稳定性，为此提供了一个强大的替代方案。在本次练习  中，我们将重点转向全隐式的后向欧拉格式，推导其离散方程，并将其组装成在每个时间步都必须求解的三对角线性系统。这个练习对于理解隐式积分的机制和计算成本至关重要。",
            "id": "2483544",
            "problem": "一个长度为 $L$ 的均匀、各向同性的一维固体平板，其导热系数 $k$、密度 $\\rho$ 和比热容 $c_p$ 均为常数，正在经历无内部热源的瞬态热传导过程。设 $T(x,t)$ 表示温度，并定义热扩散系数 $\\alpha = \\dfrac{k}{\\rho c_p}$。控制能量平衡和傅里叶定律可得到一维瞬态热传导方程\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}.\n$$\n将空间域 $[0,L]$ 用均匀网格 $x_i = i\\,\\Delta x$ 进行离散化，其中 $i=0,1,\\dots,N-1$ 且 $\\Delta x = L/(N-1)$。将时间离散化为 $t^n = n\\,\\Delta t$，其中 $n=0,1,2,\\dots$。施加狄利克雷边界条件 $T(0,t) = T_L(t)$ 和 $T(L,t) = T_R(t)$，并假设对于所有时间 $t$ 它们都是已知的。对于内部节点 $i=1,2,\\dots,N-2$，使用在时间层 $t^{n+1}$ 上计算的全隐式后向时间、中心空间有限差分格式来近似控制方程。\n\n任务：\n- 从能量守恒和傅里叶定律的陈述出发，推导由所述时间和空间离散化方法得到的内部节点的离散有限差分方程。引入无量纲参数 $r = \\dfrac{\\alpha\\,\\Delta t}{\\Delta x^2}$，并将离散方程简化为三点格式形式，其左侧包含 $T_{i-1}^{n+1}$、$T_{i}^{n+1}$ 和 $T_{i+1}^{n+1}$，右侧包含 $T_i^{n}$。\n- 将 $i=1,2,\\dots,N-2$ 的方程组组装成针对内部未知数 $\\mathbf{T}^{n+1}_{\\text{int}} = \\big(T_1^{n+1},\\dots,T_{N-2}^{n+1}\\big)^{\\top}$ 的三对角线性系统 $\\mathbf{A}\\,\\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$，并明确指出 $\\mathbf{A}$ 的次对角线、对角线和超对角线元素，以及 $\\mathbf{b}$ 的结构，包括时间 $t^{n+1}$ 的狄利克雷边界值是如何影响第一个和最后一个方程的。\n-作为最终答案，请按顺序报告三对角矩阵 $\\mathbf{A}$ 中内部节点的次对角线、对角线和超对角线系数所组成的三元组，并用 $r$ 表示。将此三元组以单行矩阵的形式提供。无需进行数值计算或四舍五入。最终答案中请勿包含物理单位。",
            "solution": "所述问题是适定的、科学上合理的，并包含了获得唯一解所需的所有信息。我们直接进行推导。\n\n无内部热源的一维瞬态热传导的控制方程如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T(x,t)$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是热扩散系数。\n\n根据题目要求，我们使用全隐式有限差分格式。这意味着空间导数在未来的时间层 $t^{n+1}$ 进行计算，而时间导数则使用后向差分进行近似。设 $T_i^n$ 表示节点 $x_i$ 在时间 $t^n$ 的温度。\n\n在点 $(x_i, t^{n+1})$ 处的时间导数 $\\frac{\\partial T}{\\partial t}$ 可用一阶后向差分近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i}^{n+1} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n\n在点 $(x_i, t^{n+1})$ 处的空间导数 $\\frac{\\partial^2 T}{\\partial x^2}$ 可用二阶中心差分近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i}^{n+1} \\approx \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n\n将这些近似式代入控制偏微分方程，我们得到内部节点 $i$ 的有限差分方程：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n该方程对 $i = 1, 2, \\dots, N-2$ 成立。\n\n为了得到要求的形式，我们首先将方程两边同乘以 $\\Delta t$：\n$$\nT_i^{n+1} - T_i^n = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n现在我们引入无量纲参数，即网格傅里叶数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。方程变为：\n$$\nT_i^{n+1} - T_i^n = r \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n任务要求整理此方程，将新时间层 $n+1$ 的所有项移到左侧 (LHS)，将当前时间层 $n$ 的项移到右侧 (RHS)。\n$$\nT_i^{n+1} - r T_{i-1}^{n+1} + 2r T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n合并时间层 $n+1$ 未知温度的系数，我们得到以下三点格式形式：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n这就完成了第一个任务。\n\n对于第二个任务，我们为内部未知温度 $\\mathbf{T}^{n+1}_{\\text{int}} = (T_1^{n+1}, T_2^{n+1}, \\dots, T_{N-2}^{n+1})^{\\top}$ 组装线性方程组。从 $i=1$ 到 $i=N-2$ 的每个内部节点都有一个方程，共 $N-2$ 个方程。\n\n对于第一个内部节点 $i=1$：\n$$\n-r T_{0}^{n+1} + (1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n\n$$\n此处，$T_0^{n+1}$ 由 $x=0$ 处的狄利克雷边界条件确定，因此 $T_0^{n+1} = T_L(t^{n+1})$。由于这是一个已知值，我们将其移到右侧 (RHS)：\n$$\n(1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n + r T_L(t^{n+1})\n$$\n\n对于一般内部节点 $i$（其中 $1 < i < N-2$）：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n\n对于最后一个内部节点 $i=N-2$：\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} - r T_{N-1}^{n+1} = T_{N-2}^n\n$$\n此处，$T_{N-1}^{n+1}$ 由 $x=L$ 处的狄利克雷边界条件确定，因此 $T_{N-1}^{n+1} = T_R(t^{n+1})$。我们将这个已知值移到右侧 (RHS)：\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} = T_{N-2}^n + r T_R(t^{n+1})\n$$\n\n将这 $N-2$ 个方程组装成矩阵形式 $\\mathbf{A} \\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$：\n- 矩阵 $\\mathbf{A}$ 是一个 $(N-2) \\times (N-2)$ 的三对角矩阵。\n- 向量 $\\mathbf{b}$ 是一个 $(N-2) \\times 1$ 的列向量。\n\n矩阵 $\\mathbf{A}$ 具有以下结构：\n$$\n\\mathbf{A} =\n\\begin{pmatrix}\n1+2r  -r  0  \\cdots  0 \\\\\n-r  1+2r  -r  \\cdots  0 \\\\\n0  -r  1+2r  \\ddots  \\vdots \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  -r \\\\\n0  \\cdots  0  -r  1+2r\n\\end{pmatrix}\n$$\n$\\mathbf{A}$ 任意内部行的元素均源自通用格式：\n- 次对角线元素（$T_{i-1}^{n+1}$ 的系数）：$-r$\n- 对角线元素（$T_i^{n+1}$ 的系数）：$1+2r$\n- 超对角线元素（$T_{i+1}^{n+1}$ 的系数）：$-r$\n\n向量 $\\mathbf{b}$ 的构造如下：\n$$\n\\mathbf{b} =\n\\begin{pmatrix}\nT_1^n + r T_L(t^{n+1}) \\\\\nT_2^n \\\\\n\\vdots \\\\\nT_{N-3}^n \\\\\nT_{N-2}^n + r T_R(t^{n+1})\n\\end{pmatrix}\n$$\n时间 $t^{n+1}$ 的边界条件贡献给了右侧向量 $\\mathbf{b}$ 的第一个和最后一个元素。\n\n最后的任务是报告 $\\mathbf{A}$ 矩阵内部节点的次对角线、对角线和超对角线系数所组成的三元组。对于矩阵的所有内部行，这些系数都是常数。根据我们的分析，它们是：\n- 次对角线：$-r$\n- 对角线：$1+2r$\n- 超对角线：$-r$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -r  1+2r  -r \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管像后向欧拉这样的隐式方法提供了稳定性，但它们在时间上仅具有一阶精度。Crank-Nicolson 格式因其二阶精度和无条件稳定性而广受欢迎，但稳定性是评判一个好解的唯一标准吗？这个高级练习  深入探讨了单调性的概念，揭示了 Crank-Nicolson 格式即使在稳定条件下也可能产生非物理振荡。分析这种行为对于选择那些解的质量和物理真实性与长期稳定性同等重要的数值格式至关重要。",
            "id": "3952036",
            "problem": "考虑一个均匀网格上的一维热传导方程，由 $u_t = \\alpha u_{xx}$ 给出，其中 $x \\in (0,L)$ 且 $t > 0$，边界条件为齐次狄利克雷(Dirichlet)边界条件 $u(0,t) = 0$ 和 $u(L,t) = 0$，初始条件为 $u(x,0) = u_0(x)$。设空间域被划分为 $N$ 个内部节点，间距为 $\\Delta x$，并令 $u_i^n$ 表示在网格点 $x_i$ 和时间层 $t^n$ 处对 $u(x_i, t^n)$ 的数值近似。在空间上使用二阶中心差分，该半离散系统具有形式 $\\dfrac{d \\mathbf{u}}{dt} = \\alpha \\mathbf{L} \\mathbf{u}$，其中 $\\mathbf{L}$ 是标准的三对角离散拉普拉斯算子，其对角线元素为 $-2/\\Delta x^2$，非对角线元素为 $1/\\Delta x^2$。\n\n现在应用 Crank-Nicolson 时间积分（即常微分方程的梯形法则），以时间步长 $\\Delta t$ 从 $\\mathbf{u}^n$ 获得全离散更新到 $\\mathbf{u}^{n+1}$。定义无量纲参数 $r = \\alpha \\Delta t / \\Delta x^2$。抛物型扩散的连续极值原理指出，在没有源项和齐次狄利克雷边界条件下，解不会随时间产生新的极值。如果对于从 $\\mathbf{u}^n$ 到 $\\mathbf{u}^{n+1}$ 的任意时间步，新值 $u_i^{n+1}$ 保持在先前节点值 $\\{u_j^n\\}$ 的凸包内，从而遵守离散极值原理，则称该离散格式是单调的。\n\n分析当 $\\Delta t$ 变化时，Crank-Nicolson 格式对于所述空间离散化的单调性。然后评估以下陈述，这些陈述涉及 Crank-Nicolson 是否可能在大的 $\\Delta t$ 下违反离散极值原理，以及如何在保持科学真实性的前提下修改格式以恢复单调性。选择所有正确的陈述。\n\nA. 因为 Crank-Nicolson 对于线性扩散是无条件稳定的，所以它也是无条件单调的：它对任何 $\\Delta t$ 都保持离散极值原理。\n\nB. 对于给定的空间二阶中心差分，当 $r > 1$ 时，由于显式侧算子上出现负的对角系数，Crank-Nicolson 更新会违反离散极值原理。可以通过切换到 $\\theta > 1/2$ 的 $\\theta$-方法（当 $\\theta \\to 1$ 时接近后向欧拉法）或在 Crank-Nicolson 之前执行几个初始的后向欧拉步骤（Rannacher 时间步进法）来恢复单调性。\n\nC. 将 Crank-Nicolson 替换为时间上的前向欧拉法，并使用相同的空间离散化，可以得到无条件的单调性，且与 $\\Delta t$ 无关。\n\nD. 在同一问题的有限体积法 (FVM) 公式中，可以在单元面上实现非线性保不变域的扩散通量限制器，以强制每个 $u_i^{n+1}$ 保持在邻近值的凸包内，从而恢复单调性；此类限制器被设计成相容的，并在光滑区域恢复为二阶中心通量，并且可以与隐式时间步进结合使用，以允许大的 $\\Delta t$ 而不产生新的极值。\n\nE. 使用相同的 Crank-Nicolson 时间步进，但将扩散算子的中心差分空间离散化替换为二阶迎风格式，可以消除大 $\\Delta t$ 时的振荡，并保证单调性，没有任何时间步长限制。",
            "solution": "用户需要分析一维热方程的 Crank-Nicolson 格式的单调性，并评估关于此问题的几个陈述。\n\n### 第一步：提取已知条件\n- **控制方程**：$u_t = \\alpha u_{xx}$，对于 $x \\in (0,L)$ 和 $t > 0$。\n- **边界条件 (BCs)**：齐次狄利克雷边界条件，$u(0,t) = 0$ 和 $u(L,t) = 0$。\n- **初始条件 (IC)**：$u(x,0) = u_0(x)$。\n- **空间离散化**：在间距为 $\\Delta x$ 的均匀网格上使用二阶中心差分。\n- **半离散系统**：$\\dfrac{d \\mathbf{u}}{dt} = \\alpha \\mathbf{L} \\mathbf{u}$。\n- **离散拉普拉斯矩阵 $\\mathbf{L}$**：三对角矩阵，对角线元素为 $-2/\\Delta x^2$，非对角线元素为 $1/\\Delta x^2$。\n- **时间积分**：Crank-Nicolson（梯形法则），时间步长为 $\\Delta t$。\n- **参数**：$r = \\alpha \\Delta t / \\Delta x^2$。\n- **连续极值原理**：解 $u(x,t)$ 不会随时间产生新的极值。\n- **离散单调性**：格式遵守离散极值原理，意味着 $u_i^{n+1}$ 保持在先前节点值 $\\{u_j^n\\}$ 的凸包内。\n\n### 第二步：使用提取的已知条件进行验证\n问题陈述描述了计算物理和工程中的一个典型问题：一维热方程的数值解。所有要素——方程、边界条件、离散化方法（中心差分、Crank-Nicolson）以及分析概念（稳定性、单调性、极值原理）——都是文献中的标准和明确定义的内容。参数 $r$ 是显式扩散格式的标准 Courant–Friedrichs–Lewy (CFL) 数。问题要求分析一个标准格式 (Crank-Nicolson) 的一个已知属性（单调性），这与其稳定性是不同的。\n\n- **有科学依据**：是。该问题是偏微分方程数值分析的基石。\n- **适定**：是。基于对数值格式的数学分析，该问题有确定且可验证的答案。\n- **客观**：是。语言精确且技术性强。\n- **完整性**：是。提供了构建离散格式和分析其属性所需的所有信息。\n- **缺陷**：问题陈述没有说明中列出的缺陷。这是一个有效、非平凡且标准的学术问题。\n\n### 第三步：结论与行动\n问题有效。我将继续进行详细的推导和分析。\n\n### 推导与分析\n\n网格节点 $x_i$ 处热方程的半离散形式为：\n$$\n\\frac{d u_i}{dt} = \\alpha \\frac{u_{i-1} - 2u_i + u_{i+1}}{\\Delta x^2}\n$$\n其矩阵形式为 $\\dfrac{d \\mathbf{u}}{dt} = \\alpha \\mathbf{L} \\mathbf{u}$。\n\n应用 Crank-Nicolson 格式，这是一个对应于梯形法则的隐式方法，并且在时间上是二阶准确的：\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = \\frac{1}{2} \\left( \\alpha \\mathbf{L} \\mathbf{u}^{n+1} + \\alpha \\mathbf{L} \\mathbf{u}^n \\right)\n$$\n重新整理各项以求解 $\\mathbf{u}^{n+1}$：\n$$\n\\left(\\mathbf{I} - \\frac{\\alpha \\Delta t}{2} \\mathbf{L}\\right) \\mathbf{u}^{n+1} = \\left(\\mathbf{I} + \\frac{\\alpha \\Delta t}{2} \\mathbf{L}\\right) \\mathbf{u}^n\n$$\n我们来分析这些矩阵。矩阵 $\\mathbf{L}$ 的元素为 $L_{ii} = -2/\\Delta x^2$ 和 $L_{i,i\\pm 1} = 1/\\Delta x^2$。设 $r = \\alpha \\Delta t / \\Delta x^2$。方程变为：\n$$\n\\left(\\mathbf{I} - \\frac{r \\Delta x^2}{2} \\mathbf{L}\\right) \\mathbf{u}^{n+1} = \\left(\\mathbf{I} + \\frac{r \\Delta x^2}{2} \\mathbf{L}\\right) \\mathbf{u}^n\n$$\n更新可以写为 $\\mathbf{A} \\mathbf{u}^{n+1} = \\mathbf{B} \\mathbf{u}^n$，其中 $\\mathbf{A} = \\mathbf{I} - \\frac{r \\Delta x^2}{2} \\mathbf{L}$ 是隐式算子，$\\mathbf{B} = \\mathbf{I} + \\frac{r \\Delta x^2}{2} \\mathbf{L}$ 是显式算子。\n\n如果新值 $u_i^{n+1}$ 可以表示为旧值 $\\{u_j^n\\}$ 的凸组合，则数值格式是单调的（因此遵守离散极值原理）。这要求更新矩阵 $\\mathbf{M} = \\mathbf{A}^{-1}\\mathbf{B}$ 具有非负元素且行和为1。一个更简单的、保证正性（如果 $\\mathbf{u}^n \\ge \\mathbf{0}$ 则 $\\mathbf{u}^{n+1} \\ge \\mathbf{0}$）的充分条件是 $\\mathbf{B}$ 和 $\\mathbf{A}^{-1}$ 都具有非负元素。\n\n我们首先考察矩阵 $\\mathbf{B}$。\n$\\mathbf{B}$ 的对角线元素是：\n$$\nB_{ii} = 1 + \\frac{r \\Delta x^2}{2} L_{ii} = 1 + \\frac{r \\Delta x^2}{2} \\left(\\frac{-2}{\\Delta x^2}\\right) = 1 - r\n$$\n$\\mathbf{B}$ 的非对角线元素是：\n$$\nB_{i, i\\pm 1} = \\frac{r \\Delta x^2}{2} L_{i, i\\pm 1} = \\frac{r \\Delta x^2}{2} \\left(\\frac{1}{\\Delta x^2}\\right) = \\frac{r}{2}\n$$\n为了使矩阵 $\\mathbf{B}$ 具有非负元素，我们需要 $B_{ii} \\ge 0$ 和 $B_{i, i\\pm 1} \\ge 0$。由于 $r > 0$，非对角线元素 $r/2$ 总是非负的。对角线元素的条件是：\n$$\n1 - r \\ge 0 \\implies r \\le 1\n$$\n如果 $r > 1$，显式算子 $\\mathbf{B}$ 的对角线元素变为负数。这意味着更新涉及到诸如 $(1-r) u_i^n$ 的项，其中系数为负，这可能导致振荡和新极值的产生，从而违反离散极值原理。例如，如果 $\\mathbf{u}^n$ 是非负的，且在 $u_i^n$ 处有一个正的峰值，一个负的 $(1-r)$ 值可能导致 $u_{i-1}^{n+1}$ 和 $u_{i+1}^{n+1}$ 变得比 $u_i^n$ 更大，甚至可能在 $\\mathbf{u}^{n+1}$ 中产生负值。\n\n现在我们考察矩阵 $\\mathbf{A}$。\n$\\mathbf{A}$ 的对角线元素是 $A_{ii} = 1 - \\frac{r \\Delta x^2}{2} L_{ii} = 1 + r$。对于 $r>0$，这些元素总是正的。\n非对角线元素是 $A_{i, i\\pm 1} = -\\frac{r \\Delta x^2}{2} L_{i, i\\pm 1} = -\\frac{r}{2}$。这些元素总是负的。\n矩阵 $\\mathbf{A}$ 是一个具有正对角线元素和非正非对角线元素的严格对角占优矩阵。这使得 $\\mathbf{A}$ 成为一个 M-矩阵，并保证其逆矩阵 $\\mathbf{A}^{-1}$ 具有非负元素。\n\n因此，产生非单调行为的可能性完全来自显式侧矩阵 $\\mathbf{B}$（当 $r > 1$ 时）。Crank-Nicolson 格式在 $L_2$ 范数意义下是无条件稳定的，这意味着数值误差不会对任何 $\\Delta t$ 无界增长。然而，它只是有条件单调的，条件是 $r = \\alpha \\Delta t / \\Delta x^2 \\le 1$。\n\n### 逐项分析\n\n**A. 因为 Crank-Nicolson 对于线性扩散是无条件稳定的，所以它也是无条件单调的：它对任何 $\\Delta t$ 都保持离散极值原理。**\n这个陈述错误地将无条件稳定性等同于无条件单调性。如上所述，该格式对于线性热方程是无条件稳定的，但仅在 $r \\le 1$ 时是单调的。对于 $r>1$，可能会出现伪振荡，违反离散极值原理。因此，它不是无条件单调的。\n**结论：错误。**\n\n**B. 对于给定的空间二阶中心差分，当 $r > 1$ 时，由于显式侧算子上出现负的对角系数，Crank-Nicolson 更新会违反离散极值原理。可以通过切换到 $\\theta > 1/2$ 的 $\\theta$-方法（当 $\\theta \\to 1$ 时接近后向欧拉法）或在 Crank-Nicolson 之前执行几个初始的后向欧拉步骤（Rannacher 时间步进法）来恢复单调性。**\n这个陈述是准确的。\n-   第一部分正确地指出，当 $r > 1$ 时可能发生违规，并正确地将其归因于显式侧算子 $\\mathbf{B}$ 中的负对角系数 ($1-r$)。\n-   第二部分提出了有效的补救措施。广义 $\\theta$-方法的单调性条件是 $r \\le \\frac{1}{2(1-\\theta)}$。对于 $\\theta > 1/2$，此条件比 $r \\le 1$ 更宽松。当 $\\theta \\to 1$ 时，格式接近后向欧拉法。对于后向欧拉法 ($\\theta = 1$)，显式侧算子是单位矩阵，格式是无条件单调的。因此，将 $\\theta$ 增加到 1 是提高单调性的标准策略。\n-   Rannacher 时间步进法是一种众所周知的技术，即先用一个强耗散和单调的格式（如后向欧拉法）进行几个初始步骤来平滑初始条件，然后在模拟的其余部分切换到耗散较小但非单调的 Crank-Nicolson 格式。这有效地抑制了引起最严重振荡的高频模式。\n**结论：正确。**\n\n**C. 将 Crank-Nicolson 替换为时间上的前向欧拉法，并使用相同的空间离散化，可以得到无条件的单调性，且与 $\\Delta t$ 无关。**\n前向欧拉格式是 $\\mathbf{u}^{n+1} = (\\mathbf{I} + \\alpha \\Delta t \\mathbf{L})\\mathbf{u}^n$。更新矩阵是 $\\mathbf{M} = \\mathbf{I} + \\alpha \\Delta t \\mathbf{L}$。为了保证单调性，$\\mathbf{M}$ 的所有元素都必须是非负的。\n-   对角线元素：$1 - 2r$。要求 $1 - 2r \\ge 0 \\implies r \\le 1/2$。\n-   非对角线元素：$r$。要求 $r \\ge 0$。\n因此，该格式仅在 $r \\le 1/2$ 的条件下是单调的。这对时间步长 $\\Delta t$ 是一个严格的条件。陈述中声称的“无条件的单调性，且与 $\\Delta t$ 无关”是错误的。\n**结论：错误。**\n\n**D. 在同一问题的有限体积法 (FVM) 公式中，可以在单元面上实现非线性保不变域的扩散通量限制器，以强制每个 $u_i^{n+1}$ 保持在邻近值的凸包内，从而恢复单调性；此类限制器被设计成相容的，并在光滑区域恢复为二阶中心通量，并且可以与隐式时间步进结合使用，以允许大的 $\\Delta t$ 而不产生新的极值。**\n这个陈述准确地描述了一族现代的、先进的数值技术。\n-   在有限体积法中，更新基于单元界面处的通量。该问题的标准线性通量会产生相同的中心差分格式和相同的单调性问题。\n-   非线性通量限制器会修改这些通量，通常基于局部解的梯度，以保证离散更新是凸组合。这通过构造强制满足离散极值原理。这类方法被称为“保界”或“保正”方法。\n-   这些高分辨率格式的一个关键特征是相容性：它们在光滑区域保持二阶（或更高阶）精度，并在陡峭梯度附近局部增加耗散（变为一阶），以抑制振荡。\n-   这些空间离散化技术可以被整合到隐式时间步进框架中，允许使用大的时间步长，同时仍然满足极值原理。这是计算方法领域一个活跃的研究和发展方向。\n**结论：正确。**\n\n**E. 使用相同的 Crank-Nicolson 时间步进，但将扩散算子的中心差分空间离散化替换为二阶迎风格式，可以消除大 $\\Delta t$ 时的振荡，并保证单调性，没有任何时间步长限制。**\n这个陈述有根本性的缺陷。“迎风”的概念是离散化一阶对流项（例如 $c u_x$）的核心，其中离散格式取决于速度 $c$ 的符号。扩散算子 $u_{xx}$ 是对称的，没有内禀的方向或“风”。对于纯扩散，没有标准的“迎风格式”。虽然可以构造有偏的格式，但中心差分是自然的、紧凑的、二阶准确的离散化方法。此外，Crank-Nicolson 非单调性的根本原因在于时间平均（$\\theta=1/2$），而不仅仅是空间格式。简单地将空间格式更改为其他二阶格式不会消除显式侧的 $1-r$ 项，因此不会使格式无条件单调。\n**结论：错误。**",
            "answer": "$$\\boxed{BD}$$"
        }
    ]
}