{
    "hands_on_practices": [
        {
            "introduction": "Our journey into the practical application of von Neumann analysis begins with a foundational, yet cautionary, example. We will examine the Forward-Time, Centered-Space (FTCS) scheme applied to the linear advection equation. This practice  serves as a classic demonstration of how an intuitively constructed numerical method can harbor inherent instability, establishing the critical importance of performing a rigorous stability analysis before implementation.",
            "id": "2225597",
            "problem": "Consider the one-dimensional linear advection equation, which describes the transport of a scalar quantity $u(x, t)$ with a constant velocity $c$:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nTo solve this equation numerically, we can discretize it on a grid with time step $\\Delta t$ and spatial step $\\Delta x$. The value of the function at grid point $j$ and time step $n$ is denoted by $u_j^n = u(j\\Delta x, n\\Delta t)$.\n\nA common discretization approach is the Forward-Time, Centered-Space (FTCS) scheme. In this scheme, the time derivative is approximated using a forward difference and the spatial derivative is approximated using a central difference, both evaluated at time step $n$:\n$$\n\\frac{\\partial u}{\\partial t} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n$$\n\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}\n$$\nTo analyze the stability of such a scheme, we use von Neumann stability analysis. We consider a single Fourier mode of the solution, represented by the ansatz $u_j^n = G^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $G$ is the complex amplification factor. This factor determines how the amplitude of a mode changes from one time step to the next.\n\nLet the Courant number be defined as $C = \\frac{c \\Delta t}{\\Delta x}$. By substituting the discretized derivatives and the Fourier mode ansatz into the original advection equation, an expression for the amplification factor $G$ can be found as a function of the wavenumber $k$ and the Courant number $C$.\n\nWhat is the maximum possible magnitude of the amplification factor, $|G|_{max}$, over all possible real wavenumbers $k$?\n\nA. $1$\n\nB. $\\sqrt{1+C^2}$\n\nC. $1+C$\n\nD. $\\sqrt{1-C^2}$\n\nE. $C$",
            "solution": "We start from the FTCS discretization of the advection equation. Approximating the derivatives at time level $n$ gives\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}+c\\,\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}=0.\n$$\nMultiplying by $\\Delta t$ and introducing the Courant number $C=\\frac{c\\Delta t}{\\Delta x}$ yields the recurrence\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{C}{2}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right).\n$$\nFor von Neumann analysis, use the Fourier mode ansatz $u_{j}^{n}=G^{n}\\exp(i k j \\Delta x)$. Then\n$$\nu_{j+1}^{n}=G^{n}\\exp\\!\\big(i k (j+1)\\Delta x\\big)=\\exp(i k \\Delta x)\\,u_{j}^{n},\\qquad\nu_{j-1}^{n}=G^{n}\\exp\\!\\big(i k (j-1)\\Delta x\\big)=\\exp(-i k \\Delta x)\\,u_{j}^{n}.\n$$\nSubstituting into the recurrence gives\n$$\nG^{n+1}\\exp(i k j \\Delta x)=G^{n}\\exp(i k j \\Delta x)-\\frac{C}{2}\\,G^{n}\\exp(i k j \\Delta x)\\left[\\exp(i k \\Delta x)-\\exp(-i k \\Delta x)\\right].\n$$\nDividing by $G^{n}\\exp(i k j \\Delta x)$ yields the amplification factor\n$$\nG=1-\\frac{C}{2}\\left[\\exp(i k \\Delta x)-\\exp(-i k \\Delta x)\\right].\n$$\nUsing $\\exp(i\\theta)-\\exp(-i\\theta)=2i\\sin(\\theta)$ with $\\theta=k\\Delta x$, we obtain\n$$\nG=1-i\\,C\\,\\sin(k\\Delta x).\n$$\nIts magnitude is\n$$\n|G|=\\sqrt{(\\Re G)^{2}+(\\Im G)^{2}}=\\sqrt{1+C^{2}\\sin^{2}(k\\Delta x)}.\n$$\nMaximizing over all real $k$ is equivalent to maximizing over $\\theta=k\\Delta x\\in\\mathbb{R}$, for which $\\sin^{2}(\\theta)\\in[0,1]$. Hence\n$$\n|G|_{\\max}=\\sqrt{1+C^{2}}.\n$$\nTherefore, the correct option is B.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Having seen how an explicit scheme can fail for a hyperbolic equation, we now shift our focus to a parabolic problem: the heat equation. This exercise introduces the Backward-Time, Centered-Space (BTCS) scheme, a fully implicit method. By deriving its amplification factor , you will uncover the source of its unconditional stability, providing a powerful contrast to the constraints of many explicit methods and showcasing a robust tool for thermal simulations.",
            "id": "2225612",
            "problem": "The one-dimensional heat equation, which describes the distribution of heat in a long thin rod, is given by the partial differential equation $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$. Here, $u(x, t)$ represents the temperature at position $x$ and time $t$, and $\\alpha$ is the constant thermal diffusivity of the material.\n\nTo solve this equation numerically, one can use a finite difference method. Consider the fully implicit Backward-Time, Centered-Space (BTCS) scheme. Let $u_j^n$ denote the numerical approximation of $u(j\\Delta x, n\\Delta t)$, where $\\Delta x$ is the spatial step size and $\\Delta t$ is the time step size. The BTCS scheme is defined by the following discretized equation:\n\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n\nThe stability of this scheme can be analyzed by investigating the behavior of a single Fourier mode. The amplification factor, $G$, represents how the amplitude of a Fourier mode with wave number $k$ changes over a single time step.\n\nDetermine the amplification factor $G$. Express your answer as an analytic function of the dimensionless diffusion number $d = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ and the dimensionless phase angle $\\xi = k \\Delta x$.",
            "solution": "We analyze the BTCS scheme\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\alpha \\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{(\\Delta x)^{2}}\n$$\nby inserting a single Fourier mode. Let $u_{j}^{n}=\\hat{u}^{n}\\exp(i j \\xi)$, where $\\xi=k\\Delta x$ is the dimensionless phase angle. Then $u_{j\\pm 1}^{n+1}=\\hat{u}^{n+1}\\exp(i (j\\pm 1)\\xi)=\\hat{u}^{n+1}\\exp(i j \\xi)\\exp(\\pm i \\xi)$ and $u_{j}^{n+1}=\\hat{u}^{n+1}\\exp(i j \\xi)$. Substituting into the scheme and canceling the common factor $\\exp(i j \\xi)$ gives\n$$\n\\frac{\\hat{u}^{n+1}-\\hat{u}^{n}}{\\Delta t}=\\alpha \\frac{\\hat{u}^{n+1}\\left(\\exp(i\\xi)-2+\\exp(-i\\xi)\\right)}{(\\Delta x)^{2}}.\n$$\nDefine the amplification factor $G=\\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$. Then\n$$\n\\frac{G-1}{\\Delta t}=\\alpha \\frac{G\\left(\\exp(i\\xi)-2+\\exp(-i\\xi)\\right)}{(\\Delta x)^{2}}.\n$$\nUse $\\exp(i\\xi)+\\exp(-i\\xi)=2\\cos\\xi$ to write $\\exp(i\\xi)-2+\\exp(-i\\xi)=2\\cos\\xi-2=-4\\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)$. Hence\n$$\nG-1=-4\\,\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}\\,G\\,\\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right).\n$$\nWith the dimensionless diffusion number $d=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}$, we obtain\n$$\nG\\left(1+4 d \\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)\\right)=1,\n$$\nso the amplification factor is\n$$\nG=\\frac{1}{1+4 d \\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{1+4 d \\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)}}$$"
        },
        {
            "introduction": "Stability is a necessary, but not sufficient, condition for a numerical scheme to be effective. This advanced practice  explores this concept by analyzing the Crank-Nicolson scheme for the advection equation. While the method is unconditionally stable, with an amplification factor magnitude $|G|=1$, its true behavior is more complex. This exercise will guide you to look beyond stability and analyze the scheme's phase error, revealing its dispersive nature and the potential for non-physical oscillations in the solution.",
            "id": "3286142",
            "problem": "Consider the linear advection equation $u_t + a\\,u_x = 0$ with constant wave speed $a \\in \\mathbb{R}$ on a periodic domain. Let the spatial grid be $x_j = j\\,\\Delta x$ and time levels be $t^n = n\\,\\Delta t$, with $j \\in \\mathbb{Z}$ and $n \\in \\mathbb{N}$. The Crank–Nicolson time discretization combined with centered differences in space is given by\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n+ \\frac{a}{2}\\left(\\frac{u_{j+1}^{n+1} - u_{j-1}^{n+1}}{2\\Delta x} + \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\\right)\n= 0.\n$$\nUsing von Neumann stability analysis (Fourier or normal-mode analysis), examine the amplification factor and stability properties of this scheme. Then select the statement that best captures the stability behavior and any undesirable features of the method when applied to pure advection.\n\nA. The amplification factor has unit magnitude for all wavenumbers and time steps, indicating neutral (unconditional) stability; the phase is dispersive, and the absence of numerical dissipation can yield spurious oscillations, especially near discontinuities.\n\nB. The scheme is stable only if the Courant–Friedrichs–Lewy (CFL) condition $|a|\\,\\Delta t/\\Delta x \\le 1$ holds; otherwise $|G|  1$ and solutions blow up.\n\nC. The scheme is unconditionally unstable for high-frequency modes because $|G|  1$ when $|\\sin\\theta|$ is large, so it inevitably exhibits exponential growth of grid-scale components.\n\nD. The scheme is unconditionally stable and also Total Variation Diminishing (TVD), so it is monotone and suppresses oscillations near steep gradients due to implicit damping.\n\nE. The amplification factor exactly matches the continuum phase $e^{-i a k \\Delta t}$ for all wavenumbers, so the scheme is both non-dissipative and non-dispersive for advection.",
            "solution": "The user wants a stability analysis of the Crank-Nicolson scheme applied to the linear advection equation.\n\n### Step 1: Extract Givens\n\nThe problem provides the following:\n1.  **Partial Differential Equation (PDE)**: The linear advection equation, $u_t + a\\,u_x = 0$, with a constant wave speed $a \\in \\mathbb{R}$.\n2.  **Domain**: A periodic domain.\n3.  **Discretization**:\n    *   Spatial grid: $x_j = j\\,\\Delta x$ for $j \\in \\mathbb{Z}$.\n    *   Time levels: $t^n = n\\,\\Delta t$ for $n \\in \\mathbb{N}$.\n4.  **Numerical Scheme**: The Crank-Nicolson method is given as:\n    $$\n    \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n    + \\frac{a}{2}\\left(\\frac{u_{j+1}^{n+1} - u_{j-1}^{n+1}}{2\\Delta x} + \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\\right)\n    = 0.\n    $$\n5.  **Task**: Use von Neumann stability analysis to determine the amplification factor $G$ and characterize the stability and other properties of the scheme.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientific or Factual Unsoundness**: The problem is scientifically sound. The advection equation is a fundamental model PDE, and the Crank-Nicolson scheme with centered differences is a standard, well-documented numerical method. The application of von Neumann analysis is the canonical technique for studying the stability of linear, constant-coefficient schemes on periodic domains. No scientific principles are violated.\n2.  **Non-Formalizable or Irrelevant**: The problem is entirely formalizable within the field of numerical analysis for PDEs. The topic is precisely *von Neumann stability analysis*.\n3.  **Incomplete or Contradictory Setup**: The problem is self-contained. The PDE, the numerical scheme, and the analytical tool (von Neumann analysis) are all explicitly defined. There are no contradictions.\n4.  **Unrealistic or Infeasible**: The setup is a standard textbook example and poses no issues of realism or feasibility.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. The question asks for the properties of the scheme, which can be uniquely determined from the amplification factor derived via the specified analysis. The terminology is standard and unambiguous.\n6.  **Pseudo-Profound, Trivial, or Tautological**: While a standard problem, it is not trivial. It requires a correct derivation and interpretation of the amplification factor to understand the scheme's nuanced behavior (e.g., distinguishing stability from dispersion).\n7.  **Outside Scientific Verifiability**: The claims can be rigorously verified through mathematical derivation.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. I will proceed with the solution derivation.\n\n### Derivation of the Amplification Factor\n\nTo perform the von Neumann stability analysis, we consider a single Fourier mode as a solution to the numerical scheme:\n$$\nu_j^n = G^n(k) e^{ikx_j} = G^n(k) e^{ikj\\Delta x}\n$$\nHere, $k$ is the wavenumber, $G(k)$ is the amplification factor for that mode, $n$ is the time level index, and $j$ is the spatial index. We substitute this ansatz into the numerical scheme.\n\nThe scheme is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + \\frac{a}{4\\Delta x} \\left( u_{j+1}^{n+1} - u_{j-1}^{n+1} + u_{j+1}^n - u_{j-1}^n \\right) = 0\n$$\nSubstituting the Fourier mode for each term:\n*   $u_j^{n+1} \\rightarrow G^{n+1} e^{ikj\\Delta x} = G \\cdot G^n e^{ikj\\Delta x}$\n*   $u_j^n \\rightarrow G^n e^{ikj\\Delta x}$\n*   $u_{j\\pm 1}^{n} \\rightarrow G^n e^{ik(j\\pm 1)\\Delta x} = G^n e^{ikj\\Delta x} e^{\\pm ik\\Delta x}$\n*   $u_{j\\pm 1}^{n+1} \\rightarrow G^{n+1} e^{ik(j\\pm 1)\\Delta x} = G \\cdot G^n e^{ikj\\Delta x} e^{\\pm ik\\Delta x}$\n\nPlugging these into the scheme and dividing by the common factor $G^n e^{ikj\\Delta x}$ yields an equation for $G$:\n$$\n\\frac{G - 1}{\\Delta t} + \\frac{a}{4\\Delta x} \\left( (G e^{ik\\Delta x} - G e^{-ik\\Delta x}) + (e^{ik\\Delta x} - e^{-ik\\Delta x}) \\right) = 0\n$$\nWe can factor out $G$ from the first two terms in the parenthesis and use the identity $e^{i\\phi} - e^{-i\\phi} = 2i\\sin\\phi$. Let $\\theta = k\\Delta x$ be the dimensionless wavenumber.\n$$\n\\frac{G - 1}{\\Delta t} + \\frac{a}{4\\Delta x} \\left( G(2i\\sin\\theta) + (2i\\sin\\theta) \\right) = 0\n$$\n$$\n\\frac{G - 1}{\\Delta t} + \\frac{a}{2\\Delta x} i\\sin\\theta (G + 1) = 0\n$$\nLet $C = \\frac{a\\Delta t}{\\Delta x}$ be the Courant number. Multiplying by $\\Delta t$:\n$$\n(G - 1) + \\frac{C}{2} i\\sin\\theta (G + 1) = 0\n$$\nNow, we solve for $G$:\n$$\nG - 1 + i\\frac{C}{2}\\sin\\theta \\cdot G + i\\frac{C}{2}\\sin\\theta = 0\n$$\n$$\nG \\left(1 + i\\frac{C}{2}\\sin\\theta \\right) = 1 - i\\frac{C}{2}\\sin\\theta\n$$\n$$\nG = \\frac{1 - i\\frac{C}{2}\\sin\\theta}{1 + i\\frac{C}{2}\\sin\\theta}\n$$\n\n### Analysis of the Amplification Factor\n\n1.  **Stability (Magnitude of $G$)**:\n    The amplification factor $G$ is a complex number of the form $\\frac{1-iz}{1+iz}$, where $z = \\frac{C}{2}\\sin\\theta$ is a real number. The magnitude of such a complex number is:\n    $$\n    |G| = \\left| \\frac{1 - iz}{1 + iz} \\right| = \\frac{|1 - iz|}{|1 + iz|} = \\frac{\\sqrt{1^2 + (-z)^2}}{\\sqrt{1^2 + z^2}} = \\frac{\\sqrt{1 + z^2}}{\\sqrt{1 + z^2}} = 1\n    $$\n    Since $|G| = 1$ for all values of $C$ and $\\theta$ (i.e., for all $\\Delta t$, $\\Delta x$, and $k$), the scheme is **unconditionally stable** in the von Neumann sense. The fact that the magnitude is exactly $1$ means the scheme is **neutrally stable** or **non-dissipative**; it does not damp the amplitude of any Fourier mode.\n\n2.  **Dispersion (Phase of $G$)**:\n    For the exact solution of the advection equation, $u(x,t) = f(x-at)$, a Fourier mode $e^{ikx}$ evolves to $e^{ik(x-a\\Delta t)} = e^{-iak\\Delta t}e^{ikx}$ over a time step $\\Delta t$. The exact amplification factor is $G_{exact} = e^{-iak\\Delta t}$. The exact phase shift is $\\phi_{exact} = ak\\Delta t = C\\theta$.\n\n    The numerical amplification factor can be written in polar form $G = e^{-i\\phi_{num}}$. The numerical phase shift $\\phi_{num}$ can be found from the expression for $G$. Let $z = \\tan(\\alpha) = \\frac{C}{2}\\sin\\theta$. Then $G = \\frac{1-i\\tan\\alpha}{1+i\\tan\\alpha} = \\frac{\\cos\\alpha - i\\sin\\alpha}{\\cos\\alpha + i\\sin\\alpha} = \\frac{e^{-i\\alpha}}{e^{i\\alpha}} = e^{-2i\\alpha}$.\n    So, the numerical phase shift is $\\phi_{num} = 2\\alpha = 2\\arctan(z)$.\n    $$\n    \\phi_{num} = 2\\arctan\\left(\\frac{C}{2}\\sin\\theta\\right)\n    $$\n    Dispersion occurs if the numerical phase velocity, $v_p = \\frac{\\omega_{num}}{k} = \\frac{\\phi_{num}}{k\\Delta t}$, depends on the wavenumber $k$.\n    $$\n    v_p = \\frac{2\\arctan\\left(\\frac{a\\Delta t}{2\\Delta x}\\sin(k\\Delta x)\\right)}{k\\Delta t}\n    $$\n    Since $\\phi_{num} \\neq \\phi_{exact}$ (i.e., $2\\arctan(\\frac{C}{2}\\sin\\theta) \\neq C\\theta$, except in the limit $\\theta \\to 0$), the numerical phase speed is not equal to the exact phase speed $a$. The phase error causes different Fourier components to travel at different speeds, a phenomenon known as numerical dispersion. Therefore, the scheme is **dispersive**.\n\n3.  **Consequences**:\n    A scheme that is non-dissipative ($|G|=1$) and dispersive is known to perform poorly for solutions with sharp gradients or discontinuities. The lack of numerical dissipation means that high-frequency errors are not damped. The dispersion causes these high-frequency components to separate from the main wave and propagate at incorrect speeds, creating spurious, non-physical oscillations (wiggles) in the numerical solution. This is a well-known characteristic of the Crank-Nicolson scheme for pure advection problems.\n\n### Option-by-Option Analysis\n\n*   **A. The amplification factor has unit magnitude for all wavenumbers and time steps, indicating neutral (unconditional) stability; the phase is dispersive, and the absence of numerical dissipation can yield spurious oscillations, especially near discontinuities.**\n    Our analysis shows $|G|=1$ for all parameters, which means the scheme is unconditionally and neutrally stable. Our analysis also shows the phase is not exact, meaning the scheme is dispersive. The combination of these two properties (non-dissipative and dispersive) is known to cause spurious oscillations. This statement accurately describes all key features of the scheme.\n    **Verdict: Correct.**\n\n*   **B. The scheme is stable only if the Courant–Friedrichs–Lewy (CFL) condition $|a|\\,\\Delta t/\\Delta x \\le 1$ holds; otherwise $|G|  1$ and solutions blow up.**\n    Our analysis proved $|G|=1$ unconditionally, regardless of the value of the Courant number $C = |a|\\,\\Delta t/\\Delta x$. This statement incorrectly claims conditional stability.\n    **Verdict: Incorrect.**\n\n*   **C. The scheme is unconditionally unstable for high-frequency modes because $|G|  1$ when $|\\sin\\theta|$ is large, so it inevitably exhibits exponential growth of grid-scale components.**\n    This statement claims unconditional instability. Our analysis proved $|G|=1$ for all modes, including high-frequency ones (where $\\theta$ is close to $\\pi$). The magnitude never exceeds $1$.\n    **Verdict: Incorrect.**\n\n*   **D. The scheme is unconditionally stable and also Total Variation Diminishing (TVD), so it is monotone and suppresses oscillations near steep gradients due to implicit damping.**\n    The scheme is unconditionally stable, so the first part is correct. However, Godunov's theorem states that a linear numerical scheme that is TVD can have at most first-order accuracy. The Crank-Nicolson scheme is second-order accurate in both space and time, and thus it cannot be TVD. Non-TVD schemes can generate new oscillations. Furthermore, the scheme is non-dissipative ($|G|=1$), meaning it has no damping, implicit or otherwise, to suppress oscillations.\n    **Verdict: Incorrect.**\n\n*   **E. The amplification factor exactly matches the continuum phase $e^{-i a k \\Delta t}$ for all wavenumbers, so the scheme is both non-dissipative and non-dispersive for advection.**\n    The numerical amplification factor is $G = e^{-2i \\arctan\\left(\\frac{C}{2}\\sin\\theta\\right)}$, while the exact factor is $G_{exact} = e^{-iC\\theta}$. These are not equal in general, so the scheme is dispersive. This statement incorrectly claims the scheme is non-dispersive.\n    **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}