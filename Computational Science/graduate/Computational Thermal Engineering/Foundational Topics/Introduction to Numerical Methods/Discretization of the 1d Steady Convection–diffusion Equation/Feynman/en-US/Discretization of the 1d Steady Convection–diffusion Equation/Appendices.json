{
    "hands_on_practices": [
        {
            "introduction": "We begin with one of the most direct applications of the Finite Volume Method: the central differencing scheme. This approach uses simple linear interpolation to estimate values at control volume faces, making it intuitive to derive and analyze. This exercise  will guide you through the derivation of the scheme's coefficients, revealing a structure that, while elegant, can lead to unphysical oscillations in convection-dominated flows, a critical lesson for any computational engineer.",
            "id": "3947986",
            "problem": "Consider one-dimensional, steady transport of a passive scalar $\\,\\phi\\,$ in a thermally conducting fluid moving with constant velocity $\\,u\\,$ and constant density $\\,\\rho\\,$ through a duct of constant cross-sectional area $\\,A\\,$. The scalar is transported by convection and diffusion, with constant diffusion coefficient $\\,\\Gamma\\,$. Let a uniform grid partition the domain into control volumes of size $\\,\\Delta x\\,$, and consider an interior control volume centered at node $\\,P\\,$ with neighboring nodes $\\,W\\,$ and $\\,E\\,$. The conservative statement of steady transport of $\\,\\phi\\,$ over the control volume is that the net outflow of the total flux (convective plus diffusive) across the two faces is zero. Using the Finite Volume Method (FVM), adopt second-order central differencing to approximate face values and face gradients needed to discretize the convective and diffusive fluxes across the west face $\\,w\\,$ and the east face $\\,e\\,$. Define the mass flux at a face as $\\,F \\equiv \\rho\\,u\\,A\\,$ and the diffusive conductance between neighboring nodes as $\\,D \\equiv \\Gamma\\,A/\\Delta x\\,$. Derive the central difference approximation for the convective flux $\\,F\\,\\phi\\,$ at a face and, by enforcing flux balance over the control volume, obtain the linearized discrete control volume equation in the form $\\,a_{P}\\,\\phi_{P} = a_{W}\\,\\phi_{W} + a_{E}\\,\\phi_{E}\\,$. Express the resulting coefficients $\\,a_{W}\\,$, $\\,a_{P}\\,$, and $\\,a_{E}\\,$ in closed form in terms of $\\,F\\,$ and $\\,D\\,$. Provide your final answer as a single row matrix containing $\\,a_{W}\\,$, $\\,a_{P}\\,$, and $\\,a_{E}\\,$.",
            "solution": "The problem requires the derivation of the coefficients of the discretized one-dimensional steady convection-diffusion equation using the Finite Volume Method (FVM) with a second-order central differencing scheme.\n\nThe governing differential equation for one-dimensional steady transport of a passive scalar $\\phi$ with constant properties ($\\rho$, $u$, $\\Gamma$) is:\n$$\n\\frac{d}{dx}(\\rho u \\phi) = \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right)\n$$\nThis can be rewritten in terms of the total flux $J(x)$, which is the sum of the convective flux $J_c(x) = \\rho u \\phi$ and the diffusive flux $J_d(x) = -\\Gamma \\frac{d\\phi}{dx}$:\n$$\n\\frac{d}{dx}(J_c(x) + J_d(x)) = 0\n$$\nThe problem is analyzed using the Finite Volume Method. We integrate the governing equation over a control volume (CV) of length $\\Delta x$ centered at node $P$. The CV is bounded by the west face $w$ and the east face $e$.\n$$\n\\int_{w}^{e} \\frac{d}{dx}\\left[ A(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}) \\right] dx = 0\n$$\nHere, $A$ is the constant cross-sectional area. Applying the Fundamental Theorem of Calculus to the integral gives the statement of conservation for the control volume: the net flux across the boundaries is zero.\n$$\n\\left[ A(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}) \\right]_e - \\left[ A(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}) \\right]_w = 0\n$$\nThe problem defines the mass flux at a face as $F \\equiv \\rho u A$ and the diffusive conductance as $D \\equiv \\Gamma A / \\Delta x$. Since $\\rho$, $u$, and $A$ are constant, $F$ is constant throughout the domain. The flux balance equation can be written as:\n$$\n\\left[ F\\phi - A\\Gamma\\frac{d\\phi}{dx} \\right]_e - \\left[ F\\phi - A\\Gamma\\frac{d\\phi}{dx} \\right]_w = 0\n$$\nLet $\\dot{\\mathcal{C}}$ denote the convective flux rate ($F\\phi$) and $\\dot{\\mathcal{D}}$ denote the diffusive flux rate ($-A\\Gamma\\frac{d\\phi}{dx}$). The equation becomes:\n$$\n(\\dot{\\mathcal{C}}_e + \\dot{\\mathcal{D}}_e) - (\\dot{\\mathcal{C}}_w + \\dot{\\mathcal{D}}_w) = 0\n$$\nWe now discretize the flux terms at the faces $e$ and $w$ using the specified second-order central differencing scheme.\n\n**Discretization of Convective Flux:**\nThe scheme requires approximating the value of the scalar $\\phi$ at the cell faces by linear interpolation between the adjacent nodal values.\nThe value at the east face $e$, located between nodes $P$ and $E$, is:\n$$\n\\phi_e \\approx \\frac{\\phi_P + \\phi_E}{2}\n$$\nThe value at the west face $w$, located between nodes $W$ and $P$, is:\n$$\n\\phi_w \\approx \\frac{\\phi_W + \\phi_P}{2}\n$$\nThe convective flux rates at the faces are therefore:\n$$\n\\dot{\\mathcal{C}}_e = F\\phi_e \\approx F \\left( \\frac{\\phi_P + \\phi_E}{2} \\right)\n$$\n$$\n\\dot{\\mathcal{C}}_w = F\\phi_w \\approx F \\left( \\frac{\\phi_W + \\phi_P}{2} \\right)\n$$\n\n**Discretization of Diffusive Flux:**\nThe scheme requires approximating the gradient of the scalar $\\phi$ at the cell faces using a central difference formula based on the adjacent nodal values. The distance between nodes is $\\Delta x$.\nThe gradient at the east face $e$ is:\n$$\n\\left(\\frac{d\\phi}{dx}\\right)_e \\approx \\frac{\\phi_E - \\phi_P}{\\Delta x}\n$$\nThe gradient at the west face $w$ is:\n$$\n\\left(\\frac{d\\phi}{dx}\\right)_w \\approx \\frac{\\phi_P - \\phi_W}{\\Delta x}\n$$\nUsing the definition of diffusive conductance $D = \\Gamma A / \\Delta x$, the diffusive flux rates at the faces are:\n$$\n\\dot{\\mathcal{D}}_e = -A\\Gamma\\left(\\frac{d\\phi}{dx}\\right)_e \\approx -A\\Gamma \\left( \\frac{\\phi_E - \\phi_P}{\\Delta x} \\right) = -D(\\phi_E - \\phi_P)\n$$\n$$\n\\dot{\\mathcal{D}}_w = -A\\Gamma\\left(\\frac{d\\phi}{dx}\\right)_w \\approx -A\\Gamma \\left( \\frac{\\phi_P - \\phi_W}{\\Delta x} \\right) = -D(\\phi_P - \\phi_W)\n$$\n\n**Assembly of the Discretized Equation:**\nWe substitute these discretized flux expressions back into the flux balance equation:\n$$\n\\left[ F\\left(\\frac{\\phi_P + \\phi_E}{2}\\right) - D(\\phi_E - \\phi_P) \\right] - \\left[ F\\left(\\frac{\\phi_W + \\phi_P}{2}\\right) - D(\\phi_P - \\phi_W) \\right] = 0\n$$\nTo find the coefficients $a_W$, $a_P$, and $a_E$, we rearrange this equation into the form $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$. Let's expand and collect terms for each nodal value $\\phi_W$, $\\phi_P$, and $\\phi_E$.\n$$\n\\frac{F}{2}\\phi_P + \\frac{F}{2}\\phi_E - D\\phi_E + D\\phi_P - \\frac{F}{2}\\phi_W - \\frac{F}{2}\\phi_P + D\\phi_P - D\\phi_W = 0\n$$\nGroup terms by node:\nFor node $P$:\n$$\n\\left(\\frac{F}{2} + D - \\frac{F}{2} + D\\right)\\phi_P = (2D)\\phi_P\n$$\nFor node $W$:\n$$\n\\left(-\\frac{F}{2} - D\\right)\\phi_W = -\\left(D + \\frac{F}{2}\\right)\\phi_W\n$$\nFor node $E$:\n$$\n\\left(\\frac{F}{2} - D\\right)\\phi_E\n$$\nCombining these terms, the full equation is:\n$$\n(2D)\\phi_P - \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(\\frac{F}{2} - D\\right)\\phi_E = 0\n$$\nRearranging to match the required form $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$:\n$$\n(2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W - \\left(\\frac{F}{2} - D\\right)\\phi_E\n$$\n$$\n(2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E\n$$\nBy comparing this result with the target form, we identify the coefficients:\n$$\na_W = D + \\frac{F}{2}\n$$\n$$\na_E = D - \\frac{F}{2}\n$$\n$$\na_P = 2D\n$$\nFor a source-free problem, the FVM coefficients should satisfy the conservation property $a_P = a_W + a_E$. We can verify this:\n$$\na_W + a_E = \\left(D + \\frac{F}{2}\\right) + \\left(D - \\frac{F}{2}\\right) = 2D = a_P\n$$\nThe condition is satisfied, confirming the consistency of the derived coefficients.\nThe final expressions for the coefficients in terms of $F$ and $D$ are:\n$a_W = D + \\frac{F}{2}$, $a_P = 2D$, and $a_E = D - \\frac{F}{2}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} D + \\frac{F}{2} & 2D & D - \\frac{F}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the central difference scheme can be unstable, the first-order upwind scheme guarantees a stable solution by taking information from the direction of the flow. But what is the hidden cost of this stability? This practice  introduces the powerful technique of modified equation analysis to reveal that the upwind scheme implicitly adds artificial diffusion to the system, effectively solving a different physical problem than the one intended. Understanding this fundamental trade-off between stability and accuracy is crucial for selecting appropriate discretization schemes.",
            "id": "3947949",
            "problem": "Consider the one-dimensional steady transport of a passive scalar $\\,\\phi(x)\\,$ in a uniform flow of speed $\\,u>0\\,$ with constant molecular diffusivity $\\,\\alpha\\,$, governed by the conservation law\n$$u\\,\\frac{d\\phi}{dx} \\;=\\; \\alpha\\,\\frac{d^{2}\\phi}{dx^{2}},$$\non a uniform grid with spacing $\\,\\Delta x\\,$. At an interior node indexed by $\\,i\\,$ (located at $\\,x_i\\,$), construct a finite-volume balance that uses first-order upwind for the convective flux and second-order central differencing for the diffusive flux. Starting from this discrete balance, perform a modified equation analysis by Taylor expanding $\\,\\phi_{i\\pm 1}\\,$ about $\\,x_i\\,$ to sufficient order and determine the continuous differential equation that the scheme solves to leading order in $\\,\\Delta x\\,$. Identify the leading-order augmentation to the coefficient multiplying $\\,\\frac{d^{2}\\phi}{dx^{2}}\\,$ in closed form, and interpret this augmentation as an artificial diffusion coefficient $\\,\\alpha_{\\mathrm{num}}\\,$ introduced by the upwind discretization.\n\nUsing a scale analysis of the modified equation, infer the effective boundary layer thickness $\\,\\delta_{\\mathrm{eff}}\\,$ adjacent to an inflow boundary by balancing convection against effective diffusion, where the effective diffusion is the sum of the molecular diffusion and the artificial diffusion. Then, for the numerical parameters $\\,u = 2.0\\,\\mathrm{m/s}\\,$, $\\,\\alpha = 1.5\\times 10^{-5}\\,\\mathrm{m^{2}/s}\\,$, and $\\,\\Delta x = 1.0\\times 10^{-2}\\,\\mathrm{m}\\,$, compute $\\,\\delta_{\\mathrm{eff}}\\,$. Express the final boundary layer thickness in meters, and round your answer to four significant figures.\n\nFor context, you may define the Péclet number (Pe) as $\\,\\mathrm{Pe} = \\dfrac{u\\,L}{\\alpha}\\,$ for a characteristic length $\\,L\\,$, but you should not assume a specific $\\,L\\,$ in your derivation of $\\,\\delta_{\\mathrm{eff}}\\,$.",
            "solution": "The first step is to derive the discrete form of the governing equation using a finite-volume method on a uniform grid with spacing $\\Delta x$. The one-dimensional steady convection-diffusion equation is:\n$$u\\,\\frac{d\\phi}{dx} \\;=\\; \\alpha\\,\\frac{d^2\\phi}{dx^2}$$\nAssuming $u$ and $\\alpha$ are constants, we can write this in conservation-law form, $\\frac{dF}{dx} = 0$, where the total flux $F$ is composed of a convective part, $F_c = u\\phi$, and a diffusive part, $F_d = -\\alpha\\frac{d\\phi}{dx}$.\n$$F(x) = u\\phi(x) - \\alpha\\frac{d\\phi}{dx}$$\nWe integrate the conservation law over a control volume (CV) centered at node $i$, extending from the face at $x_{i-1/2}$ to the face at $x_{i+1/2}$. The width of this CV is $\\Delta x$.\n$$\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{dF}{dx} \\,dx = 0 \\implies F(x_{i+1/2}) - F(x_{i-1/2}) = 0$$\nLet $F_{i+1/2}$ and $F_{i-1/2}$ denote the fluxes at the control volume faces. The discrete balance is $F_{i+1/2} - F_{i-1/2} = 0$.\n\nWe now need to approximate the fluxes at the faces using the nodal values $\\phi_i$.\nThe convective flux, $F_c = u\\phi$, is discretized using a first-order upwind scheme. Since the flow speed $u$ is given as positive ($u>0$), the flow is from left to right. Therefore, the value of $\\phi$ at a face is taken from the upwind (left) node.\n$$ (F_c)_{i-1/2} = u\\phi_{i-1} $$\n$$ (F_c)_{i+1/2} = u\\phi_i $$\nThe diffusive flux, $F_d = -\\alpha\\frac{d\\phi}{dx}$, is discretized using a second-order central difference scheme for the gradient at the face.\n$$ (F_d)_{i-1/2} = -\\alpha \\left(\\frac{d\\phi}{dx}\\right)_{i-1/2} \\approx -\\alpha \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n$$ (F_d)_{i+1/2} = -\\alpha \\left(\\frac{d\\phi}{dx}\\right)_{i+1/2} \\approx -\\alpha \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\nThe total flux at each face is the sum of the convective and diffusive parts.\n$$ F_{i-1/2} = (F_c)_{i-1/2} + (F_d)_{i-1/2} = u\\phi_{i-1} - \\alpha \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n$$ F_{i+1/2} = (F_c)_{i+1/2} + (F_d)_{i+1/2} = u\\phi_i - \\alpha \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\nSubstituting these into the balance equation $F_{i+1/2} - F_{i-1/2} = 0$:\n$$ \\left( u\\phi_i - \\alpha \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} \\right) - \\left( u\\phi_{i-1} - \\alpha \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} \\right) = 0 $$\nRearranging the terms, we get:\n$$ u(\\phi_i - \\phi_{i-1}) - \\frac{\\alpha}{\\Delta x} ((\\phi_{i+1} - \\phi_i) - (\\phi_i - \\phi_{i-1})) = 0 $$\n$$ u(\\phi_i - \\phi_{i-1}) = \\frac{\\alpha}{\\Delta x} (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) $$\nDividing by $\\Delta x$ yields the standard finite-difference formulation:\n$$ u\\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} = \\alpha\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} $$\nThe left side is a first-order backward difference approximation for $u\\frac{d\\phi}{dx}$, and the right side is a second-order central difference approximation for $\\alpha\\frac{d^2\\phi}{dx^2}$.\n\nNext, we perform a modified equation analysis by replacing the discrete terms with their Taylor series expansions around the point $x_i$. Let $\\phi_i = \\phi(x_i)$, $\\phi' = \\frac{d\\phi}{dx}$, $\\phi'' = \\frac{d^2\\phi}{dx^2}$, etc., with all derivatives evaluated at $x_i$.\n$$ \\phi_{i-1} = \\phi(x_i - \\Delta x) = \\phi_i - \\Delta x\\,\\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' - \\frac{(\\Delta x)^3}{6}\\phi''' + O((\\Delta x)^4) $$\n$$ \\phi_{i+1} = \\phi(x_i + \\Delta x) = \\phi_i + \\Delta x\\,\\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' + \\frac{(\\Delta x)^3}{6}\\phi''' + O((\\Delta x)^4) $$\nWe substitute these expansions into the discrete equation.\nFor the convective term (left-hand side):\n$$ u\\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} = u \\frac{1}{\\Delta x} \\left( \\phi_i - \\left[ \\phi_i - \\Delta x\\,\\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' - \\dots \\right] \\right) = u \\left( \\phi' - \\frac{\\Delta x}{2}\\phi'' + O((\\Delta x)^2) \\right) $$\nFor the diffusive term (right-hand side):\n$$ \\phi_{i+1} - 2\\phi_i + \\phi_{i-1} = (\\phi_i + \\Delta x \\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' + \\dots) - 2\\phi_i + (\\phi_i - \\Delta x \\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' - \\dots) = (\\Delta x)^2\\phi'' + O((\\Delta x)^4) $$\n$$ \\alpha\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\alpha \\frac{(\\Delta x)^2\\phi'' + O((\\Delta x)^4)}{(\\Delta x)^2} = \\alpha\\phi'' + O((\\Delta x)^2) $$\nEquating the expanded terms:\n$$ u\\phi' - u\\frac{\\Delta x}{2}\\phi'' + O((\\Delta x)^2) = \\alpha\\phi'' + O((\\Delta x)^2) $$\nRearranging to isolate the original equation terms:\n$$ u\\frac{d\\phi}{dx} = \\alpha\\frac{d^2\\phi}{dx^2} + u\\frac{\\Delta x}{2}\\frac{d^2\\phi}{dx^2} + O((\\Delta x)^2) $$\nThe modified equation, which is the differential equation solved by the numerical scheme to leading order, is:\n$$ u\\frac{d\\phi}{dx} = \\left(\\alpha + \\frac{u\\Delta x}{2}\\right) \\frac{d^2\\phi}{dx^2} $$\nComparing this to the original equation, we identify the term added to the molecular diffusivity $\\alpha$ as the artificial or numerical diffusion coefficient, $\\alpha_{\\mathrm{num}}$.\n$$ \\alpha_{\\mathrm{num}} = \\frac{u\\Delta x}{2} $$\nThe effective diffusion coefficient is $\\alpha_{\\mathrm{eff}} = \\alpha + \\alpha_{\\mathrm{num}} = \\alpha + \\frac{u\\Delta x}{2}$.\n\nThe thickness of a boundary layer is determined by a scale analysis that balances the convective and diffusive transport terms. For the modified equation, this balance is between convection and effective diffusion. Let $\\delta_{\\mathrm{eff}}$ be the effective boundary layer thickness.\nThe scaling of the terms is:\n$$ \\text{Convection: } u\\frac{d\\phi}{dx} \\sim u\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}} $$\n$$ \\text{Effective Diffusion: } \\alpha_{\\mathrm{eff}}\\frac{d^2\\phi}{dx^2} \\sim \\alpha_{\\mathrm{eff}}\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}^2} $$\nEquating the scales:\n$$ u\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}} \\sim \\alpha_{\\mathrm{eff}}\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}^2} \\implies \\delta_{\\mathrm{eff}} \\sim \\frac{\\alpha_{\\mathrm{eff}}}{u} $$\nSubstituting the expression for $\\alpha_{\\mathrm{eff}}$:\n$$ \\delta_{\\mathrm{eff}} = \\frac{\\alpha + \\alpha_{\\mathrm{num}}}{u} = \\frac{\\alpha + \\frac{u\\Delta x}{2}}{u} = \\frac{\\alpha}{u} + \\frac{\\Delta x}{2} $$\nNow, we compute the numerical value of $\\delta_{\\mathrm{eff}}$ using the given parameters: $u = 2.0\\,\\mathrm{m/s}$, $\\alpha = 1.5\\times 10^{-5}\\,\\mathrm{m^{2}/s}$, and $\\Delta x = 1.0\\times 10^{-2}\\,\\mathrm{m}$.\n$$ \\delta_{\\mathrm{eff}} = \\frac{1.5\\times 10^{-5}\\,\\mathrm{m^2/s}}{2.0\\,\\mathrm{m/s}} + \\frac{1.0\\times 10^{-2}\\,\\mathrm{m}}{2} $$\n$$ \\delta_{\\mathrm{eff}} = (7.5 \\times 10^{-6})\\,\\mathrm{m} + (0.5 \\times 10^{-2})\\,\\mathrm{m} $$\n$$ \\delta_{\\mathrm{eff}} = 0.0000075\\,\\mathrm{m} + 0.005\\,\\mathrm{m} = 0.0050075\\,\\mathrm{m} $$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $5$, $0$, $0$, $7$. The fifth is $5$, so we round up the fourth digit.\n$$ \\delta_{\\mathrm{eff}} \\approx 0.005008\\,\\mathrm{m} $$",
            "answer": "$$\\boxed{0.005008}$$"
        },
        {
            "introduction": "Having explored the pitfalls of simpler schemes, we now turn to a method that provides an exact solution for the one-dimensional, source-free problem: the exponential scheme. This practice  demonstrates how leveraging the analytical solution of the governing equation locally leads to a discretization that is both unconditionally stable and highly accurate across all Péclet numbers. The exercise bridges rigorous derivation with the practicalities of coding, including the need for robust numerical implementation to handle different physical regimes.",
            "id": "3948014",
            "problem": "Consider the one-dimensional steady convection–diffusion of a scalar field $\\,\\phi(x)\\,$ on a uniform grid along the spatial coordinate $\\,x\\,$ with constant properties. The governing balance for a conserved scalar in steady state, neglecting volumetric sources, is the differential equation\n$$\n\\frac{d}{dx}\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right) - \\rho\\,u\\,\\frac{d\\phi}{dx} = 0,\n$$\nwhere $\\,\\Gamma\\,$ is the diffusion coefficient, $\\,\\rho\\,$ is the density, and $\\,u\\,$ is the constant velocity. Assume a unit cross-sectional area. Using a control-volume finite volume method with a uniform grid spacing $\\,\\Delta x\\,$ and interior node $\\,P\\,$ with neighbors $\\,W\\,$ and $\\,E\\,$, define the mass flux magnitude $\\,F = \\rho\\,u\\,$ and the diffusive conductance $\\,D = \\Gamma/\\Delta x\\,$. The face Peclet number, which is uniform for this setup, is \n$$\nP = \\frac{F}{D} = \\frac{\\rho\\,u\\,\\Delta x}{\\Gamma}.\n$$\nYour task is to derive the discrete equation at a representative interior node $\\,P\\,$ based on exact integration of the local one-dimensional steady convection–diffusion equation within each control volume and face interpolation that is consistent with this exact local solution (this approach is commonly referred to as the exponential scheme). From first principles, start from the governing balance and show how the convective and diffusive fluxes at the faces combine to yield a linear discrete equation of the form\n$$\na_W\\,\\phi_W + a_E\\,\\phi_E - a_P\\,\\phi_P = 0,\n$$\nwith coefficients $\\,a_W\\,$, $\\,a_E\\,$, and $\\,a_P\\,$ expressed solely in terms of $\\,F\\,$, $\\,D\\,$, and $\\,P\\,$ for a uniform grid and constant properties, assuming zero volumetric source.\n\nAfter your derivation, implement a program that computes the discrete coefficients $\\,a_W\\,$, $\\,a_E\\,$, and $\\,a_P\\,$ for a representative interior node using the exponential scheme for the following test suite. For numerical robustness of your implementation, if $\\,|P|\\,$ is very small, you must use a series expansion consistent with the exact local solution to evaluate the required face weighting function to avoid catastrophic cancellation.\n\nThe test suite parameter sets are given by ordered pairs $\\,(\\text{Pe}, D)\\,$, where $\\,\\text{Pe}=P\\,$ is the Peclet number and $\\,D\\,$ is the diffusive conductance:\n- General convection-diffusion (happy path): $\\,(\\text{Pe}=10,\\;D=2.0)\\,$.\n- Pure diffusion limit: $\\,(\\text{Pe}=0,\\;D=2.0)\\,$.\n- Convection to the left (negative flow): $\\,(\\text{Pe}=-10,\\;D=2.0)\\,$.\n- Near-zero Peclet number (numerical stability check): $\\,(\\text{Pe}=10^{-6},\\;D=2.0)\\,$.\n- Strong convection limit: $\\,(\\text{Pe}=100,\\;D=2.0)\\,$.\n\nFor each test case, compute and report the triplet $\\,\\big[a_W,\\;a_E,\\;a_P\\big]\\,$. Your program should produce a single line of output containing the results as a comma-separated list of the five triplets, enclosed in square brackets, with each coefficient rounded to six decimal places. For example, the output format must be\n$$\n\\texttt{[[aW1,aE1,aP1],[aW2,aE2,aP2],[aW3,aE3,aP3],[aW4,aE4,aP4],[aW5,aE5,aP5]]}\n$$\nAll outputs are pure numbers with no units.",
            "solution": "The derivation proceeds from the fundamental principles of the finite volume method, leveraging the exact analytical solution of the local governing equation.\n\nThe one-dimensional steady-state convection-diffusion equation for a scalar property $\\phi(x)$ with constant properties ($\\rho$, $u$, $\\Gamma$) and no source term is given as:\n$$\n\\frac{d}{dx}\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right) - \\rho\\,u\\,\\frac{d\\phi}{dx} = 0\n$$\nFor constant $\\rho$ and $u$, the convective term can be written in divergence form, $\\rho u \\frac{d\\phi}{dx} = \\frac{d}{dx}(\\rho u \\phi)$. The equation can thus be expressed in a conservative form representing the balance of the total flux, $J(x) = \\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}$:\n$$\n-\\frac{d J(x)}{dx} = 0 \\quad \\text{or} \\quad \\frac{d}{dx}\\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right) = 0\n$$\nWe apply the finite volume method by integrating this equation over a control volume (CV) surrounding a generic interior node $P$. The CV extends from a west face $w$, located halfway between nodes $W$ and $P$, to an east face $e$, located halfway between nodes $P$ and $E$. The grid spacing is uniform, $\\Delta x$.\n$$\n\\int_{w}^{e} \\frac{d}{dx}\\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right) dx = 0\n$$\nApplying the fundamental theorem of calculus yields the flux balance for the CV:\n$$\n\\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right)\\bigg|_e - \\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right)\\bigg|_w = 0\n$$\nThis states that the net flux out of the CV is zero in the steady state. Let's denote the total flux as $J_{total} = \\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}$. The balance is simply $J_{total, e} - J_{total, w} = 0$.\n\nThe core of the exponential scheme is to use the exact local solution of the governing ODE to evaluate the fluxes $J_{total, e}$ and $J_{total, w}$. Let's solve the ODE $\\Gamma\\phi'' - \\rho u \\phi' = 0$. The general solution is of the form:\n$$\n\\phi(x) = C_1 e^{(\\rho u / \\Gamma)x} + C_2\n$$\nConsider the segment between any two nodes, say node $A$ at $x=0$ and node $B$ at $x=\\Delta x$. The boundary conditions are $\\phi(0) = \\phi_A$ and $\\phi(\\Delta x) = \\phi_B$. Applying these conditions allows us to solve for the constants $C_1$ and $C_2$. The resulting solution for $\\phi(x)$ in the interval $[0, \\Delta x]$ is:\n$$\n\\frac{\\phi(x) - \\phi_A}{\\phi_B - \\phi_A} = \\frac{e^{P \\cdot (x/\\Delta x)} - 1}{e^P - 1}\n$$\nwhere $P = \\frac{\\rho u \\Delta x}{\\Gamma}$ is the grid Peclet number.\n\nA key insight is that for this source-free 1D problem, the total flux $J_{total}(x)$ is constant between any two nodes. We can find this constant flux by evaluating $J_{total}(x) = \\rho u \\phi(x) - \\Gamma \\frac{d\\phi}{dx}$ at any point $x \\in [0, \\Delta x]$ using the exact solution. This calculation yields a remarkably simple expression for the flux in terms of the nodal values $\\phi_A$ and $\\phi_B$:\n$$\nJ_{total} = \\rho u \\frac{\\phi_A e^P - \\phi_B}{e^P - 1}\n$$\nUsing the definitions $F = \\rho u$ (mass flux) and $D = \\Gamma / \\Delta x$ (diffusive conductance), and the relation $P = F/D$, this can be written as:\n$$\nJ_{total} = F \\frac{\\phi_A e^P - \\phi_B}{e^P - 1}\n$$\nWe now apply this result to our CV balance, $J_{total, e} - J_{total, w} = 0$.\nThe flux at face $e$ is determined by the nodes bracketing it, $P$ and $E$. In this context, $A=P$ and $B=E$.\n$$\nJ_{total, e} = F \\frac{\\phi_P e^P - \\phi_E}{e^P - 1}\n$$\nThe flux at face $w$ is determined by nodes $W$ and $P$. Here, $A=W$ and $B=P$.\n$$\nJ_{total, w} = F \\frac{\\phi_W e^P - \\phi_P}{e^P - 1}\n$$\nSubstituting these into the flux balance gives:\n$$\nF \\frac{\\phi_P e^P - \\phi_E}{e^P - 1} - F \\frac{\\phi_W e^P - \\phi_P}{e^P - 1} = 0\n$$\nSince $F$ is a common factor (and we assume $F \\neq 0$ for a moment), we can simplify:\n$$\n(\\phi_P e^P - \\phi_E) - (\\phi_W e^P - \\phi_P) = 0\n$$\nRearranging and grouping terms by nodal values $\\phi_W$, $\\phi_P$, and $\\phi_E$:\n$$\n(-\\phi_W e^P) + (-\\phi_E) + \\phi_P(e^P + 1) = 0\n$$\nTo match the desired form $a_W \\phi_W + a_E \\phi_E - a_P \\phi_P = 0$, we can express the equation as:\n$$\n\\left(\\frac{F e^P}{e^P-1}\\right) \\phi_W + \\left(\\frac{F}{e^P-1}\\right) \\phi_E - \\left(\\frac{F(e^P+1)}{e^P-1}\\right) \\phi_P = 0\n$$\nThis leads to the identification of the coefficients:\n$$\na_W = F \\frac{e^P}{e^P-1}\n$$\n$$\na_E = \\frac{F}{e^P-1}\n$$\n$$\na_P = F \\frac{e^P+1}{e^P-1}\n$$\nIt can be readily verified that $a_P = a_W + a_E$, which is a required property for a conservative scheme with no source terms. These expressions are valid for both positive and negative $P$.\n\nFor numerical implementation, it is advantageous to express these coefficients in terms of $D$ and a function of $P$ to handle the case $P \\to 0$ robustly. Using $F=P \\cdot D$:\n$$\na_E = (P \\cdot D) \\frac{1}{e^P-1} = D \\left(\\frac{P}{e^P-1}\\right)\n$$\n$$\na_W = (P \\cdot D) \\frac{e^P}{e^P-1} = D \\left(\\frac{P e^P}{e^P-1}\\right) = D \\left(\\frac{-P}{e^{-P}-1}\\right)\n$$\nLet us define the function $B(z) = \\frac{z}{e^z-1}$. The coefficients become:\n$$\na_E = D \\cdot B(P)\n$$\n$$\na_W = D \\cdot B(-P)\n$$\n$$\na_P = a_W + a_E = D \\cdot (B(P) + B(-P))\n$$\nThis formulation is numerically robust. As $P \\to 0$, the expression $e^P-1$ suffers from catastrophic cancellation. However, the limit of $B(P)$ as $P \\to 0$ is well-defined: $\\lim_{P\\to 0} B(P) = 1$. This can be shown using L'Hôpital's rule or by Taylor expansion: $e^P \\approx 1+P$, so $B(P) \\approx P/((1+P)-1)=1$.\nFor the limit $P=0$ (pure diffusion), we get:\n$a_E = D \\cdot B(0) = D \\cdot 1 = D$.\n$a_W = D \\cdot B(0) = D \\cdot 1 = D$.\n$a_P = D+D = 2D$.\nThis correctly recovers the standard central-difference scheme for pure diffusion.\n\nFor computation, when $|P|$ is very small but non-zero, using the `numpy.expm1(P)` function, which computes $e^P-1$ accurately, avoids numerical instability. For $P=0$, the limit value of $1$ must be used for $B(0)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the discrete coefficients for the 1D steady convection-diffusion equation\n    using the exponential scheme for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement as (Pe, D) pairs.\n    # Pe is the Peclet number (P), and D is the diffusive conductance.\n    test_cases = [\n        (10.0, 2.0),      # General convection-diffusion\n        (0.0, 2.0),       # Pure diffusion limit\n        (-10.0, 2.0),     # Convection to the left (negative flow)\n        (1e-6, 2.0),      # Near-zero Peclet number (numerical stability check)\n        (100.0, 2.0),     # Strong convection limit\n    ]\n\n    results_formatted = []\n    \n    # Helper function B(z) = z / (exp(z) - 1)\n    # This function is central to the exponential scheme coefficients.\n    def B(z):\n        \"\"\"\n        Computes z / (exp(z) - 1) robustly.\n        For z -> 0, the limit is 1.\n        For small non-zero z, np.expm1(z) provides an accurate computation\n        of exp(z) - 1, avoiding catastrophic cancellation.\n        \"\"\"\n        if z == 0.0:\n            return 1.0\n        else:\n            return z / np.expm1(z)\n\n    for case in test_cases:\n        P, D = case\n        \n        # The mass flux F is related to P and D by F = P * D.\n        # The coefficients are expressed in terms of D and the function B(P).\n        # This formulation is robust for all values of P, including P -> 0.\n        \n        # Coefficient for the east node (E)\n        # a_E = D * (P / (exp(P) - 1)) = D * B(P)\n        a_E = D * B(P)\n        \n        # Coefficient for the west node (W)\n        # a_W = D * (P * exp(P) / (exp(P) - 1)) = D * B(-P)\n        a_W = D * B(-P)\n        \n        # Coefficient for the center node (P)\n        # For a source-free problem, a_P = a_W + a_E\n        a_P = a_W + a_E\n        \n        # Append the formatted triplet to the results list\n        results_formatted.append(f\"[{a_W:.6f},{a_E:.6f},{a_P:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(results_formatted)}]]\")\n\nsolve()\n```"
        }
    ]
}