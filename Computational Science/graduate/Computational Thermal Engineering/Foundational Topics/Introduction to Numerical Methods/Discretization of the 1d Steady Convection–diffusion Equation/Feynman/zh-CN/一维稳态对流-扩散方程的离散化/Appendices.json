{
    "hands_on_practices": [
        {
            "introduction": "指数格式是一种强大的离散化方法，它利用控制体积内控制方程的精确解来近似通量，从而在所有佩克莱数 $P$ 下都能保证物理真实性。本练习将指导您完成该格式的推导和实际编程实现，同时强调在低佩克莱数下保证数值稳定性的重要性。",
            "id": "3948014",
            "problem": "考虑在一个具有恒定物性的均匀网格上，沿空间坐标$\\,x\\,$的一维稳态对流扩散标量场$\\,\\phi(x)\\,$。在忽略体积源项的情况下，守恒标量在稳态下的控制平衡是一个微分方程\n$$\n\\frac{d}{dx}\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right) - \\rho\\,u\\,\\frac{d\\phi}{dx} = 0,\n$$\n其中$\\,\\Gamma\\,$是扩散系数，$\\,\\rho\\,$是密度，$\\,u\\,$是恒定速度。假设横截面积为单位面积。使用控制体有限体积法，在均匀网格间距为$\\,\\Delta x\\,$、内部节点为$\\,P\\,$且相邻节点为$\\,W\\,$和$\\,E\\,$的情况下，定义质量通量大小$\\,F = \\rho\\,u\\,$和扩散传导系数$\\,D = \\Gamma/\\Delta x\\,$。对于此设置，均匀的界面佩克莱数（Peclet number）为\n$$\nP = \\frac{F}{D} = \\frac{\\rho\\,u\\,\\Delta x}{\\Gamma}.\n$$\n你的任务是，基于在每个控制体积内对局部一维稳态对流扩散方程的精确积分，以及与此精确局部解一致的界面插值方法（这种方法通常称为指数格式），推导一个代表性内部节点$\\,P\\,$处的离散方程。从第一性原理出发，从控制平衡方程开始，展示界面上的对流通量和扩散通量如何组合，从而得到一个形如下式的线性离散方程\n$$\na_W\\,\\phi_W + a_E\\,\\phi_E - a_P\\,\\phi_P = 0,\n$$\n其中，对于均匀网格和恒定物性，并假设体积源项为零，系数$\\,a_W\\,$, $\\,a_E\\,$和$\\,a_P\\,$仅用$\\,F\\,$, $\\,D\\,$和$\\,P\\,$表示。\n\n完成推导后，实现一个程序，使用指数格式为以下测试套件计算一个代表性内部节点的离散系数$\\,a_W\\,$, $\\,a_E\\,$和$\\,a_P\\,$。为了保证实现的数值鲁棒性，如果$\\,|P|\\,$非常小，你必须使用与精确局部解一致的级数展开来评估所需的界面权重函数，以避免灾难性抵消。\n\n测试套件的参数集由有序对$\\,(\\text{Pe}, D)\\,$给出，其中$\\,\\text{Pe}=P\\,$是佩克莱数，$\\,D\\,$是扩散传导系数：\n- 一般对流扩散（正常情况）：$\\,(\\text{Pe}=10,\\;D=2.0)\\,$。\n- 纯扩散极限：$\\,(\\text{Pe}=0,\\;D=2.0)\\,$。\n- 向左对流（负流）：$\\,(\\text{Pe}=-10,\\;D=2.0)\\,$。\n- 接近零的佩克莱数（数值稳定性检查）：$\\,(\\text{Pe}=10^{-6},\\;D=2.0)\\,$。\n- 强对流极限：$\\,(\\text{Pe}=100,\\;D=2.0)\\,$。\n\n对于每个测试用例，计算并报告三元组$\\,\\big[a_W,\\;a_E,\\;a_P\\big]\\,$。你的程序应生成单行输出，其中包含五个三元组的结果，以逗号分隔，并用方括号括起来，每个系数四舍五入到六位小数。例如，输出格式必须是\n$$\n\\texttt{[[aW1,aE1,aP1],[aW2,aE2,aP2],[aW3,aE3,aP3],[aW4,aE4,aP4],[aW5,aE5,aP5]]}\n$$\n所有输出都是无单位的纯数字。",
            "solution": "该问题陈述具有科学依据，是适定的、客观且自洽的。它描述了计算输运现象中的一个标准问题：一维稳态对流扩散方程的指数离散格式的推导与应用。所提供的控制方程、定义和边界条件在该领域中是一致且标准的。因此，该问题是有效的，并将提供解答。\n\n推导过程从有限体积法的基本原理出发，并利用局部控制方程的精确解析解。\n\n对于具有恒定物性（$\\rho$, $u$, $\\Gamma$）且无源项的标量属性$\\phi(x)$，其一维稳态对流扩散方程如下：\n$$\n\\frac{d}{dx}\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right) - \\rho\\,u\\,\\frac{d\\phi}{dx} = 0\n$$\n对于恒定的$\\rho$和$u$，对流项可以写成散度形式，$\\rho u \\frac{d\\phi}{dx} = \\frac{d}{dx}(\\rho u \\phi)$。因此，该方程可以表示为代表总通量$J(x) = \\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}$平衡的守恒形式：\n$$\n-\\frac{d J(x)}{dx} = 0 \\quad \\text{或} \\quad \\frac{d}{dx}\\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right) = 0\n$$\n我们应用有限体积法，将此方程在一个围绕通用内部节点$P$的控制体（CV）上进行积分。该控制体从位于节点$W$和$P$之间的西界面$w$延伸到位于节点$P$和$E$之间的东界面$e$。网格间距是均匀的，为$\\Delta x$。\n$$\n\\int_{w}^{e} \\frac{d}{dx}\\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right) dx = 0\n$$\n应用微积分基本定理，得到控制体的通量平衡：\n$$\n\\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right)\\bigg|_e - \\left( \\Gamma \\frac{d\\phi}{dx} - \\rho u \\phi\\right)\\bigg|_w = 0\n$$\n这表明在稳态下，流出控制体的净通量为零。我们将总通量表示为$J_{total} = \\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}$。平衡方程即为$J_{total, e} - J_{total, w} = 0$。\n\n指数格式的核心是利用控制常微分方程（ODE）的局部精确解来评估通量$J_{total, e}$和$J_{total, w}$。我们来求解常微分方程$\\Gamma\\phi'' - \\rho u \\phi' = 0$。其通解形式为：\n$$\n\\phi(x) = C_1 e^{(\\rho u / \\Gamma)x} + C_2\n$$\n考虑任意两个节点之间的线段，比如$x=0$处的节点$A$和$x=\\Delta x$处的节点$B$。边界条件为$\\phi(0) = \\phi_A$和$\\phi(\\Delta x) = \\phi_B$。应用这些条件可以求解常数$C_1$和$C_2$。在区间$[0, \\Delta x]$内，$\\phi(x)$的最终解为：\n$$\n\\frac{\\phi(x) - \\phi_A}{\\phi_B - \\phi_A} = \\frac{e^{P \\cdot (x/\\Delta x)} - 1}{e^P - 1}\n$$\n其中$P = \\frac{\\rho u \\Delta x}{\\Gamma}$是网格佩克莱数。\n\n一个关键的洞见是，对于这个无源一维问题，总通量$J_{total}(x)$在任意两个节点之间是恒定的。我们可以通过使用精确解，在任意点$x \\in [0, \\Delta x]$处计算$J_{total}(x) = \\rho u \\phi(x) - \\Gamma \\frac{d\\phi}{dx}$来找到这个恒定的通量。该计算得出了一个用节点值$\\phi_A$和$\\phi_B$表示的异常简洁的通量表达式：\n$$\nJ_{total} = \\rho u \\frac{\\phi_A e^P - \\phi_B}{e^P - 1}\n$$\n使用定义$F = \\rho u$（质量通量）和$D = \\Gamma / \\Delta x$（扩散传导系数），以及关系式$P = F/D$，上式可以写为：\n$$\nJ_{total} = F \\frac{\\phi_A e^P - \\phi_B}{e^P - 1}\n$$\n现在我们将这个结果应用到我们的控制体平衡方程$J_{total, e} - J_{total, w} = 0$中。\n界面$e$处的通量由其两侧的节点$P$和$E$决定。在此情况下，$A=P$，$B=E$。\n$$\nJ_{total, e} = F \\frac{\\phi_P e^P - \\phi_E}{e^P - 1}\n$$\n界面$w$处的通量由节点$W$和$P$决定。此处，$A=W$，$B=P$。\n$$\nJ_{total, w} = F \\frac{\\phi_W e^P - \\phi_P}{e^P - 1}\n$$\n将这些代入通量平衡方程，得到：\n$$\nF \\frac{\\phi_P e^P - \\phi_E}{e^P - 1} - F \\frac{\\phi_W e^P - \\phi_P}{e^P - 1} = 0\n$$\n由于$F$是公因子（我们暂时假设$F \\neq 0$），我们可以简化为：\n$$\n(\\phi_P e^P - \\phi_E) - (\\phi_W e^P - \\phi_P) = 0\n$$\n按节点值$\\phi_W$、$\\phi_P$和$\\phi_E$重新排列和分组各项：\n$$\n(-\\phi_W e^P) + (-\\phi_E) + \\phi_P(e^P + 1) = 0\n$$\n为了匹配所需的形式$a_W \\phi_W + a_E \\phi_E - a_P \\phi_P = 0$，我们可以将方程表示为：\n$$\n\\left(\\frac{F e^P}{e^P-1}\\right) \\phi_W + \\left(\\frac{F}{e^P-1}\\right) \\phi_E - \\left(\\frac{F(e^P+1)}{e^P-1}\\right) \\phi_P = 0\n$$\n由此可以确定这些系数：\n$$\na_W = F \\frac{e^P}{e^P-1}\n$$\n$$\na_E = \\frac{F}{e^P-1}\n$$\n$$\na_P = F \\frac{e^P+1}{e^P-1}\n$$\n可以很容易地验证$a_P = a_W + a_E$，这是无源项守恒格式的一个必要属性。这些表达式对正的和负的$P$都有效。\n\n对于数值实现，将这些系数用$D$和$P$的函数表示是有利的，以便鲁棒地处理$P \\to 0$的情况。使用$F=P \\cdot D$：\n$$\na_E = (P \\cdot D) \\frac{1}{e^P-1} = D \\left(\\frac{P}{e^P-1}\\right)\n$$\n$$\na_W = (P \\cdot D) \\frac{e^P}{e^P-1} = D \\left(\\frac{P e^P}{e^P-1}\\right) = D \\left(\\frac{-P}{e^{-P}-1}\\right)\n$$\n我们定义函数$B(z) = \\frac{z}{e^z-1}$。系数变为：\n$$\na_E = D \\cdot B(P)\n$$\n$$\na_W = D \\cdot B(-P)\n$$\n$$\na_P = a_W + a_E = D \\cdot (B(P) + B(-P))\n$$\n这个公式在数值上是鲁棒的。当$P \\to 0$时，表达式$e^P-1$会遭受灾难性抵消。然而，$B(P)$在$P \\to 0$时的极限是明确定义的：$\\lim_{P\\to 0} B(P) = 1$。这可以通过使用洛必达法则或泰勒展开来证明：$e^P \\approx 1+P$，所以$B(P) \\approx P/((1+P)-1)=1$。\n对于极限情况$P=0$（纯扩散），我们得到：\n$a_E = D \\cdot B(0) = D \\cdot 1 = D$。\n$a_W = D \\cdot B(0) = D \\cdot 1 = D$。\n$a_P = D+D = 2D$。\n这正确地恢复了纯扩散的标准中心差分格式。\n\n在计算中，当$|P|$非常小但非零时，使用`numpy.expm1(P)`函数可以精确计算$e^P-1$，从而避免数值不稳定性。对于$P=0$的情况，必须使用极限值$1$作为$B(0)$的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the discrete coefficients for the 1D steady convection-diffusion equation\n    using the exponential scheme for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement as (Pe, D) pairs.\n    # Pe is the Peclet number (P), and D is the diffusive conductance.\n    test_cases = [\n        (10.0, 2.0),      # General convection-diffusion\n        (0.0, 2.0),       # Pure diffusion limit\n        (-10.0, 2.0),     # Convection to the left (negative flow)\n        (1e-6, 2.0),      # Near-zero Peclet number (numerical stability check)\n        (100.0, 2.0),     # Strong convection limit\n    ]\n\n    results_formatted = []\n    \n    # Helper function B(z) = z / (exp(z) - 1)\n    # This function is central to the exponential scheme coefficients.\n    def B(z):\n        \"\"\"\n        Computes z / (exp(z) - 1) robustly.\n        For z -> 0, the limit is 1.\n        For small non-zero z, np.expm1(z) provides an accurate computation\n        of exp(z) - 1, avoiding catastrophic cancellation.\n        \"\"\"\n        if z == 0.0:\n            return 1.0\n        else:\n            return z / np.expm1(z)\n\n    for case in test_cases:\n        P, D = case\n        \n        # The mass flux F is related to P and D by F = P * D.\n        # The coefficients are expressed in terms of D and the function B(P).\n        # This formulation is robust for all values of P, including P -> 0.\n        \n        # Coefficient for the east node (E)\n        # a_E = D * (P / (exp(P) - 1)) = D * B(P)\n        a_E = D * B(P)\n        \n        # Coefficient for the west node (W)\n        # a_W = D * (P * exp(P) / (exp(P) - 1)) = D * B(-P)\n        a_W = D * B(-P)\n        \n        # Coefficient for the center node (P)\n        # For a source-free problem, a_P = a_W + a_E\n        a_P = a_W + a_E\n        \n        # Append the formatted triplet to the results list\n        results_formatted.append(f\"[{a_W:.6f},{a_E:.6f},{a_P:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_formatted)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在学习了如指数格式这类精确的格式后，分析一个更简单的格式以理解其数值误差的来源是很有启发性的。本练习将采用修正方程分析方法，揭示一阶迎风格式所引入的“人工扩散”或“数值扩散”。这个概念对于评估对流主导问题的数值方法精度至关重要。",
            "id": "3947949",
            "problem": "考虑一个被动标量 $\\,\\phi(x)\\,$ 在速度为 $\\,u>0\\,$ 的均匀流场中的一维稳态输运，其分子扩散系数 $\\,\\alpha\\,$ 为常数，由守恒定律控制\n$$u\\,\\frac{d\\phi}{dx} \\;=\\; \\alpha\\,\\frac{d^{2}\\phi}{dx^{2}},$$\n在间距为 $\\,\\Delta x\\,$ 的均匀网格上。在索引为 $\\,i\\,$（位于 $\\,x_i\\,$）的内部节点上，构建一个有限体积平衡方程，其中对流项通量使用一阶迎风格式，扩散项通量使用二阶中心差分格式。从这个离散平衡方程出发，通过将 $\\,\\phi_{i\\pm 1}\\,$ 在 $\\,x_i\\,$ 附近进行足够高阶的泰勒展开，进行修正方程分析，并确定该格式在 $\\,\\Delta x\\,$ 的主阶上求解的连续微分方程。以闭合形式确定乘以 $\\,\\frac{d^{2}\\phi}{dx^{2}}\\,$ 的系数的主阶增量，并将此增量解释为由迎风离散化引入的人工扩散系数 $\\,\\alpha_{\\mathrm{num}}\\,$。\n\n使用修正方程的量级分析，通过平衡对流与有效扩散，推断出入口边界附近的有效边界层厚度 $\\,\\delta_{\\mathrm{eff}}\\,$，其中有效扩散是分子扩散和人工扩散之和。然后，对于数值参数 $\\,u = 2.0\\,\\mathrm{m/s}\\,$, $\\,\\alpha = 1.5\\times 10^{-5}\\,\\mathrm{m^{2}/s}\\,$ 和 $\\,\\Delta x = 1.0\\times 10^{-2}\\,\\mathrm{m}\\,$，计算 $\\,\\delta_{\\mathrm{eff}}\\,$。以米为单位表示最终的边界层厚度，并将您的答案四舍五入到四位有效数字。\n\n作为背景知识，您可以将佩克莱数（Pe）定义为 $\\,\\mathrm{Pe} = \\dfrac{u\\,L}{\\alpha}\\,$，其中 $\\,L\\,$ 是特征长度，但在推导 $\\,\\delta_{\\mathrm{eff}}\\,$ 时，您不应假设特定的 $\\,L\\,$。",
            "solution": "用户提供了一个有效的问题陈述。该问题在计算流体动力学方面有科学依据，是适定的、客观的。它包含了获得唯一解所需的所有信息。\n\n第一步是使用有限体积法在间距为 $\\Delta x$ 的均匀网格上推导控制方程的离散形式。一维稳态对流扩散方程为：\n$$u\\,\\frac{d\\phi}{dx} \\;=\\; \\alpha\\,\\frac{d^{2}\\phi}{dx^{2}}$$\n假设 $u$ 和 $\\alpha$ 是常数，我们可以将其写成守恒律形式 $\\frac{dF}{dx} = 0$，其中总通量 $F$ 由对流通量部分 $F_c = u\\phi$ 和扩散通量部分 $F_d = -\\alpha\\frac{d\\phi}{dx}$ 组成。\n$$F(x) = u\\phi(x) - \\alpha\\frac{d\\phi}{dx}$$\n我们在以节点 $i$ 为中心、从 $x_{i-1/2}$ 面延伸到 $x_{i+1/2}$ 面的控制体（CV）上对守恒律进行积分。该控制体的宽度为 $\\Delta x$。\n$$\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{dF}{dx} \\,dx = 0 \\implies F(x_{i+1/2}) - F(x_{i-1/2}) = 0$$\n令 $F_{i+1/2}$ 和 $F_{i-1/2}$ 表示控制体面上的通量。离散平衡方程为 $F_{i+1/2} - F_{i-1/2} = 0$。\n\n现在我们需要使用节点值 $\\phi_i$ 来近似面上的通量。\n对流通量 $F_c = u\\phi$ 使用一阶迎风格式进行离散化。由于流速 $u$ 给定为正值（$u>0$），流动方向是从左到右。因此，面上的 $\\phi$ 值取自上游（左侧）节点。\n$$ (F_c)_{i-1/2} = u\\phi_{i-1} $$\n$$ (F_c)_{i+1/2} = u\\phi_i $$\n扩散通量 $F_d = -\\alpha\\frac{d\\phi}{dx}$ 使用二阶中心差分格式来离散化面上的梯度。\n$$ (F_d)_{i-1/2} = -\\alpha \\left(\\frac{d\\phi}{dx}\\right)_{i-1/2} \\approx -\\alpha \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n$$ (F_d)_{i+1/2} = -\\alpha \\left(\\frac{d\\phi}{dx}\\right)_{i+1/2} \\approx -\\alpha \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\n每个面上的总通量是对流通量和扩散通量部分之和。\n$$ F_{i-1/2} = (F_c)_{i-1/2} + (F_d)_{i-1/2} = u\\phi_{i-1} - \\alpha \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n$$ F_{i+1/2} = (F_c)_{i+1/2} + (F_d)_{i+1/2} = u\\phi_i - \\alpha \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\n将这些代入平衡方程 $F_{i+1/2} - F_{i-1/2} = 0$：\n$$ \\left( u\\phi_i - \\alpha \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} \\right) - \\left( u\\phi_{i-1} - \\alpha \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} \\right) = 0 $$\n重新整理这些项，我们得到：\n$$ u(\\phi_i - \\phi_{i-1}) - \\frac{\\alpha}{\\Delta x} ((\\phi_{i+1} - \\phi_i) - (\\phi_i - \\phi_{i-1})) = 0 $$\n$$ u(\\phi_i - \\phi_{i-1}) = \\frac{\\alpha}{\\Delta x} (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) $$\n除以 $\\Delta x$ 得到标准的有限差分格式：\n$$ u\\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} = \\alpha\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} $$\n左边是 $u\\frac{d\\phi}{dx}$ 的一阶后向差分近似，右边是 $\\alpha\\frac{d^2\\phi}{dx^2}$ 的二阶中心差分近似。\n\n接下来，我们通过用离散项在点 $x_i$ 附近的泰勒级数展开来替换它们，进行修正方程分析。令 $\\phi_i = \\phi(x_i)$，$\\phi' = \\frac{d\\phi}{dx}$，$\\phi'' = \\frac{d^2\\phi}{dx^2}$ 等，所有导数均在 $x_i$ 处计算。\n$$ \\phi_{i-1} = \\phi(x_i - \\Delta x) = \\phi_i - \\Delta x\\,\\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' - \\frac{(\\Delta x)^3}{6}\\phi''' + O((\\Delta x)^4) $$\n$$ \\phi_{i+1} = \\phi(x_i + \\Delta x) = \\phi_i + \\Delta x\\,\\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' + \\frac{(\\Delta x)^3}{6}\\phi''' + O((\\Delta x)^4) $$\n我们将这些展开式代入离散方程。\n对于对流项（左侧）：\n$$ u\\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} = u \\frac{1}{\\Delta x} \\left( \\phi_i - \\left[ \\phi_i - \\Delta x\\,\\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' - \\dots \\right] \\right) = u \\left( \\phi' - \\frac{\\Delta x}{2}\\phi'' + O((\\Delta x)^2) \\right) $$\n对于扩散项（右侧）：\n$$ \\phi_{i+1} - 2\\phi_i + \\phi_{i-1} = (\\phi_i + \\Delta x \\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' + \\dots) - 2\\phi_i + (\\phi_i - \\Delta x \\phi' + \\frac{(\\Delta x)^2}{2}\\phi'' - \\dots) = (\\Delta x)^2\\phi'' + O((\\Delta x)^4) $$\n$$ \\alpha\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\alpha \\frac{(\\Delta x)^2\\phi'' + O((\\Delta x)^4)}{(\\Delta x)^2} = \\alpha\\phi'' + O((\\Delta x)^2) $$\n令展开后的项相等：\n$$ u\\phi' - u\\frac{\\Delta x}{2}\\phi'' + O((\\Delta x)^2) = \\alpha\\phi'' + O((\\Delta x)^2) $$\n重新整理以分离出原方程的项：\n$$ u\\frac{d\\phi}{dx} = \\alpha\\frac{d^2\\phi}{dx^2} + u\\frac{\\Delta x}{2}\\frac{d^2\\phi}{dx^2} + O((\\Delta x)^2) $$\n修正方程，即数值格式在主阶上求解的微分方程，是：\n$$ u\\frac{d\\phi}{dx} = \\left(\\alpha + \\frac{u\\Delta x}{2}\\right) \\frac{d^2\\phi}{dx^2} $$\n将其与原方程进行比较，我们识别出加到分子扩散系数 $\\alpha$ 上的项为人工或数值扩散系数 $\\alpha_{\\mathrm{num}}$。\n$$ \\alpha_{\\mathrm{num}} = \\frac{u\\Delta x}{2} $$\n有效扩散系数为 $\\alpha_{\\mathrm{eff}} = \\alpha + \\alpha_{\\mathrm{num}} = \\alpha + \\frac{u\\Delta x}{2}$。\n\n边界层的厚度由平衡对流和扩散输运项的量级分析确定。对于修正方程，这种平衡存在于对流和有效扩散之间。令 $\\delta_{\\mathrm{eff}}$ 为有效边界层厚度。\n各项的量级为：\n$$ \\text{对流: } u\\frac{d\\phi}{dx} \\sim u\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}} $$\n$$ \\text{有效扩散: } \\alpha_{\\mathrm{eff}}\\frac{d^2\\phi}{dx^2} \\sim \\alpha_{\\mathrm{eff}}\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}^2} $$\n令量级相等：\n$$ u\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}} \\sim \\alpha_{\\mathrm{eff}}\\frac{\\Delta\\phi}{\\delta_{\\mathrm{eff}}^2} \\implies \\delta_{\\mathrm{eff}} \\sim \\frac{\\alpha_{\\mathrm{eff}}}{u} $$\n代入 $\\alpha_{\\mathrm{eff}}$ 的表达式：\n$$ \\delta_{\\mathrm{eff}} = \\frac{\\alpha + \\alpha_{\\mathrm{num}}}{u} = \\frac{\\alpha + \\frac{u\\Delta x}{2}}{u} = \\frac{\\alpha}{u} + \\frac{\\Delta x}{2} $$\n现在，我们使用给定的参数计算 $\\delta_{\\mathrm{eff}}$ 的数值：$u = 2.0\\,\\mathrm{m/s}$，$\\alpha = 1.5\\times 10^{-5}\\,\\mathrm{m^{2}/s}$，以及 $\\Delta x = 1.0\\times 10^{-2}\\,\\mathrm{m}$。\n$$ \\delta_{\\mathrm{eff}} = \\frac{1.5\\times 10^{-5}\\,\\mathrm{m^2/s}}{2.0\\,\\mathrm{m/s}} + \\frac{1.0\\times 10^{-2}\\,\\mathrm{m}}{2} $$\n$$ \\delta_{\\mathrm{eff}} = (7.5 \\times 10^{-6})\\,\\mathrm{m} + (0.5 \\times 10^{-2})\\,\\mathrm{m} $$\n$$ \\delta_{\\mathrm{eff}} = 0.0000075\\,\\mathrm{m} + 0.005\\,\\mathrm{m} = 0.0050075\\,\\mathrm{m} $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $5$、$0$、$0$、$7$。第五位是 $5$，所以我们将第四位数字向上取整。\n$$ \\delta_{\\mathrm{eff}} \\approx 0.005008\\,\\mathrm{m} $$",
            "answer": "$$\\boxed{0.005008}$$"
        },
        {
            "introduction": "将理论知识应用于计算网格设计是计算热工学中的一项核心技能。本练习将运用标度分析来估算对流主导流动中的边界层厚度，并确定为精确捕捉这些关键物理特征所需的最小网格分辨率。这展示了如何利用无量纲参数（如佩克莱数 $Pe$）来指导实际的数值模拟设置。",
            "id": "3947962",
            "problem": "一个在 $x=0$ 和 $x=L$ 两个等温边界之间的一维稳态热输运过程，由具有恒定物性和无体积源的对流-扩散能量平衡方程描述：\n$$\\rho c_{p} u \\,\\frac{dT}{dx} = k \\,\\frac{d^{2}T}{dx^{2}},$$\n其中 $T$ 是温度，$\\rho$ 是密度， $c_{p}$ 是定压比热， $u$ 是均匀流向速度， $k$ 是热导率。定义热扩散率 $\\alpha$ 为 $\\alpha \\equiv \\frac{k}{\\rho c_{p}}$ ，佩克莱数 (Pe) 为 $Pe \\equiv \\frac{uL}{\\alpha}$。利用基于在一个边界附近的薄层内对流和扩散之间平衡的标度分析，推导在 $Pe \\gg 1$ 极限下边界层厚度 $\\delta$ 的解析表达式，用 $L$ 和 $Pe$ 表示。\n\n接着，对于长度为 $L$ 的区域上具有 $M$ 个等尺寸有限体积（单元）的均匀空间离散，假设为了充分解析陡峭的梯度，至少需要有 $m$ 个单元完全位于边界层厚度 $\\delta$ 内。使用相同的标度逻辑，确定满足此解析度要求的最小整数 $M_{\\min}$。\n\n取以下代表标准条件下中等流速空气的物理一致性属性：\n- `$L = 0.3\\,\\text{m}`,\n- `$u = 0.5\\,\\text{m}\\,\\text{s}^{-1}`,\n- `$\\rho = 1.2\\,\\text{kg}\\,\\text{m}^{-3}`,\n- `$c_{p} = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}`,\n- `$k = 0.026\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}`,\n- `$m = 12`.\n\n从第一性原理出发解释推导过程，并提供两个结果：用 $L$ 和 $Pe$ 表示的 $\\delta$ 的解析表达式，以及使用给定数据计算出的 $\\delta$ 的数值，连同相应的 $M_{\\min}$。边界层厚度以米表示，最小单元数以纯数字表示。你最终报告的答案必须包含这两个量，形式为一个单行矩阵，其中第一个条目等于 $\\delta$ 的数值，第二个条目等于 $M_{\\min}$。",
            "solution": "所述问题在科学上是合理的、自洽的且提法得当。所有提供的数据和定义均为热流体科学领域的标准，并且量纲一致。因此，该问题被认为是有效的，并将提供解答。\n\n分析始于温度 $T(x)$ 的一维稳态对流-扩散方程，给定恒定的物性和无体积生热：\n$$ \\rho c_{p} u \\frac{dT}{dx} = k \\frac{d^{2}T}{dx^{2}} $$\n此处，$\\rho$ 是流体密度，$c_{p}$ 是定压比热，$u$ 是均匀流体速度，$k$ 是热导率。物理域的长度为 $L$，从 $x=0$ 到 $x=L$。\n\n首先，我们将使用标度分析推导边界层厚度 $\\delta$ 的解析表达式。在以高佩克莱数 ($Pe$) 为特征的输运现象中，通常认为在大部分区域内，对流（方程左侧项）远大于扩散（方程右侧项）。然而，为了满足边界条件，必须存在一个薄层区域，在该区域内扩散的大小与对流相当。这个区域被称为边界层。\n\n设该层的特征厚度为 $\\delta$。在该层内，温度发生显著变化，其量级与整个区域的总温差相当，我们可将其表示为 $\\Delta T$。我们可以估计该层内温度导数的数量级如下：\n温度梯度：\n$$ \\frac{dT}{dx} \\sim \\frac{\\Delta T}{\\delta} $$\n温度分布的曲率：\n$$ \\frac{d^{2}T}{dx^{2}} \\sim \\frac{\\Delta T}{\\delta^{2}} $$\n标度分析的核心在于，在边界层内，对流项和扩散项达到平衡：\n$$ \\rho c_{p} u \\frac{dT}{dx} \\sim k \\frac{d^{2}T}{dx^{2}} $$\n代入经过标度分析的导数：\n$$ \\rho c_{p} u \\frac{\\Delta T}{\\delta} \\sim k \\frac{\\Delta T}{\\delta^{2}} $$\n假设存在非平凡的温差（$\\Delta T \\neq 0$），此项可以消去，得到一个关于 $\\delta$ 的关系式：\n$$ \\rho c_{p} u \\sim \\frac{k}{\\delta} $$\n解出 $\\delta$ 即可得到边界层厚度的标度关系：\n$$ \\delta \\sim \\frac{k}{\\rho c_{p} u} $$\n为了用佩克莱数 $Pe$ 表示此式，我们使用其定义：\n$$ Pe \\equiv \\frac{uL}{\\alpha} $$\n其中热扩散率 $\\alpha$ 定义为 $\\alpha \\equiv \\frac{k}{\\rho c_{p}}$。将 $\\alpha$ 的定义代入 $Pe$ 的表达式中：\n$$ Pe = \\frac{uL}{k/(\\rho c_{p})} = \\frac{\\rho c_{p} u L}{k} $$\n现在我们可以通过巧妙地乘以 $\\frac{L}{L}$ 来重写 $\\delta$ 的表达式：\n$$ \\delta \\sim \\frac{k}{\\rho c_{p} u} = L \\left( \\frac{k}{\\rho c_{p} u L} \\right) = L \\left( \\frac{1}{Pe} \\right) $$\n因此，在 $Pe \\gg 1$ 极限下，边界层厚度的解析表达式为：\n$$ \\delta \\sim \\frac{L}{Pe} $$\n\n接下来，我们确定为获得足够解析度所需的最小计算单元数 $M_{\\min}$。长度为 $L$ 的区域被划分为 $M$ 个均匀单元，每个单元的宽度为 $\\Delta x$：\n$$ \\Delta x = \\frac{L}{M} $$\n要求是至少有 $m$ 个单元必须完全位于厚度为 $\\delta$ 的边界层内。这个数学条件表示为：\n$$ m \\cdot \\Delta x \\le \\delta $$\n代入 $\\Delta x$ 的表达式和推导出的 $\\delta$ 的标度关系：\n$$ m \\left( \\frac{L}{M} \\right) \\le \\frac{L}{Pe} $$\n区域长度 $L$ 可以消去，得到一个关于 $M$ 的直接条件：\n$$ \\frac{m}{M} \\le \\frac{1}{Pe} \\implies M \\ge m \\cdot Pe $$\n由于单元数 $M$ 必须为整数，最小单元数 $M_{\\min}$ 是满足此不等式的最小整数，可通过向上取整函数得到：\n$$ M_{\\min} = \\lceil m \\cdot Pe \\rceil $$\n\n最后，我们使用提供的数据计算 $\\delta$ 和 $M_{\\min}$ 的数值：\n- $L = 0.3\\,\\text{m}$\n- $u = 0.5\\,\\text{m}\\,\\text{s}^{-1}$\n- $\\rho = 1.2\\,\\text{kg}\\,\\text{m}^{-3}$\n- $c_{p} = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$\n- $k = 0.026\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$\n- $m = 12$\n\n首先，我们计算佩克莱数：\n$$ Pe = \\frac{\\rho c_{p} u L}{k} = \\frac{(1.2)(1005)(0.5)(0.3)}{0.026} = \\frac{180.9}{0.026} = \\frac{90450}{13} \\approx 6957.69 $$\n这个值证实了高佩克莱数假设 ($Pe \\gg 1$) 是有效的。\n\n现在，我们计算边界层厚度 $\\delta$。使用更直接的标度关系可以提供更高的精度：\n$$ \\delta = \\frac{k}{\\rho c_{p} u} = \\frac{0.026}{(1.2)(1005)(0.5)} = \\frac{0.026}{603} \\,\\text{m} \\approx 4.311774 \\times 10^{-5} \\,\\text{m} $$\n报告至五位有效数字，$\\delta \\approx 4.3118 \\times 10^{-5} \\,\\text{m}$。\n\n最后，我们计算最小单元数 $M_{\\min}$：\n$$ M_{\\min} = \\lceil m \\cdot Pe \\rceil = \\left\\lceil 12 \\cdot \\frac{90450}{13} \\right\\rceil = \\left\\lceil \\frac{1085400}{13} \\right\\rceil $$\n$$ M_{\\min} = \\lceil 83492.30769... \\rceil = 83493 $$\n因此，需要最少 $83493$ 个单元来满足解析度标准。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.3118 \\times 10^{-5}  83493 \\end{pmatrix}}\n$$"
        }
    ]
}