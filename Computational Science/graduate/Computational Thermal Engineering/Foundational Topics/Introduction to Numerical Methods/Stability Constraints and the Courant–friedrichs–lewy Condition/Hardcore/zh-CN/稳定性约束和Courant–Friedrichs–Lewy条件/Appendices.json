{
    "hands_on_practices": [
        {
            "introduction": "显式时间积分方案的数值稳定性是计算传热学中的一个核心问题。本练习将指导您完成一个冯·诺依曼稳定性分析，这是一个用于检验数值方案稳定性的基本工具。通过这个练习，您将为结合了对流和扩散项的经典显式格式推导出其稳定性上限，从而深入理解 Courant–Friedrichs–Lewy (CFL) 条件的理论基础。",
            "id": "3985772",
            "problem": "考虑在均匀、不可压缩流中的一维热输运，该过程由关于温度 $u(x,t)$ 的线性平流-扩散方程建模，\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}},\n$$\n其中 $a>0$ 是恒定的平流速度，$\\nu>0$ 是恒定的热扩散系数。假设一个周期性域和间距为 $h>0$ 的均匀空间网格 $x_j = j\\,h$。您需要使用显式前向欧拉格式来在时间上推进解。对于空间离散化，对流项使用一阶迎风近似（适用于 $a>0$），扩散项使用二阶中心近似，从而得到更新式\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{h}\\left(u_j^n - u_{j-1}^n\\right) \\;+\\; \\frac{\\nu\\,\\Delta t}{h^2}\\left(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\right).\n$$\n从该偏微分方程和这些标准离散化出发，在周期性假设下进行傅里叶（von Neumann）稳定性分析。推导放大因子，并施加其模对所有可分辨的波数都不超过 $1$ 的条件。根据此要求，确定最大稳定时间步长 $\\Delta t$，并以参数 $a$、$\\nu$ 和 $h$ 的闭式表达式表示。\n\n以秒为单位表示您最终的 $\\Delta t$。没有提供具体数值；请给出精确的解析表达式。无需四舍五入。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知信息\n已知信息如下：\n- **偏微分方程 (PDE)**：关于温度 $u(x,t)$ 的一维线性平流-扩散方程：\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}}\n$$\n- **常数**: 平流速度 $a>0$ 和热扩散系数 $\\nu>0$。\n- **域和网格**: 一个周期性域，具有均匀空间网格 $x_j = j\\,h$，其中 $h>0$ 是网格间距。\n- **数值格式**: 时间积分使用显式前向欧拉格式进行。空间导数使用一阶迎风格式近似平流项 ($\\frac{\\partial u}{\\partial x}$)，使用二阶中心差分格式近似扩散项 ($\\frac{\\partial^2 u}{\\partial x^2}$)。\n- **有限差分方程 (FDE)**: 得到的离散更新法则如下：\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{h}\\left(u_j^n - u_{j-1}^n\\right) \\;+\\; \\frac{\\nu\\,\\Delta t}{h^2}\\left(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\right)\n$$\n其中 $\\Delta t$ 是时间步长。\n- **任务**: 进行傅里叶（von Neumann）稳定性分析，以找到最大稳定时间步长 $\\Delta t$ 关于 $a$、$\\nu$ 和 $h$ 的闭式表达式。\n\n### 步骤 2：使用提取的已知信息进行验证\n- **科学依据**: 该问题基于平流-扩散方程，这是输运现象中的一个基本模型。所描述的数值方法（前向欧拉、迎风、中心差分）和分析技术（von Neumann 稳定性分析）是计算物理和工程中标准的、成熟的工具。该问题在科学上是完全合理的。\n- **适定的**: 问题定义清晰。它指定了控制方程、数值格式和要使用的分析方法。目标是推导一个特定的量，即稳定性极限，对于给定的格式，这个量应该是唯一的。\n- **客观性**: 问题以精确的数学语言表述，没有任何主观性或歧义。\n- **完整性和一致性**: 所有必要的信息都已提供。给出的偏微分方程和相应的有限差分方程与所描述的离散化方法是一致的。约束条件 $a>0$、$\\nu>0$ 和 $h>0$ 具有物理意义，并且在数学上是必要的。\n- **现实性**: 该设置是计算热工问题的一个标准模型。\n\n### 步骤 3：结论和行动\n该问题是有效的，因为它具有科学依据、适定、客观且完整。将提供解答。\n\n### 解题推导\n为了进行 von Neumann 稳定性分析，我们考虑网格上数值解的单个傅里叶模式。我们将网格点 $j$ 和时间步 $n$ 处的解表示为：\n$$\nu_j^n = \\hat{u}^n(k) \\, e^{i k x_j} = \\hat{u}^n(k) \\, e^{i k j h}\n$$\n其中 $k$ 是波数，$i$ 是虚数单位，$\\hat{u}^n(k)$ 是时间步 $n$ 处该模式的振幅。格式的稳定性取决于放大因子 $G(k)$，它关联了连续时间步的振幅：\n$$\n\\hat{u}^{n+1}(k) = G(k) \\, \\hat{u}^n(k)\n$$\n将傅里叶模式表达式代入有限差分方程，我们得到：\n$$\nG(k) \\hat{u}^n(k) e^{i k j h} = \\hat{u}^n(k) e^{i k j h} - \\frac{a \\Delta t}{h} \\left( \\hat{u}^n(k) e^{i k j h} - \\hat{u}^n(k) e^{i k (j-1) h} \\right) + \\frac{\\nu \\Delta t}{h^2} \\left( \\hat{u}^n(k) e^{i k (j+1) h} - 2 \\hat{u}^n(k) e^{i k j h} + \\hat{u}^n(k) e^{i k (j-1) h} \\right)\n$$\n我们可以从所有项中消去公因子 $\\hat{u}^n(k) e^{i k j h}$：\n$$\nG(k) = 1 - \\frac{a \\Delta t}{h} (1 - e^{-i k h}) + \\frac{\\nu \\Delta t}{h^2} (e^{i k h} - 2 + e^{-i k h})\n$$\n我们定义两个无量纲数：Courant数 $C = \\frac{a \\Delta t}{h}$ 和扩散数 $d = \\frac{\\nu \\Delta t}{h^2}$。设 $\\theta = k h$。放大因子的表达式变为：\n$$\nG(\\theta) = 1 - C (1 - e^{-i \\theta}) + d (e^{i \\theta} - 2 + e^{-i \\theta})\n$$\n使用欧拉恒等式 ($e^{i\\phi} = \\cos\\phi + i\\sin\\phi$)，我们可以简化这些项：\n$$\n1 - e^{-i \\theta} = 1 - (\\cos\\theta - i\\sin\\theta) = 1 - \\cos\\theta + i\\sin\\theta\n$$\n$$\ne^{i \\theta} - 2 + e^{-i \\theta} = (\\cos\\theta + i\\sin\\theta) - 2 + (\\cos\\theta - i\\sin\\theta) = 2\\cos\\theta - 2\n$$\n将这些代回到 $G(\\theta)$ 的表达式中：\n$$\nG(\\theta) = 1 - C(1 - \\cos\\theta + i\\sin\\theta) + d(2\\cos\\theta - 2)\n$$\n分离实部和虚部：\n$$\nG(\\theta) = [1 - C(1 - \\cos\\theta) - 2d(1 - \\cos\\theta)] - i[C\\sin\\theta]\n$$\n$$\nG(\\theta) = [1 - (C + 2d)(1 - \\cos\\theta)] - i[C\\sin\\theta]\n$$\n为了使数值格式稳定，放大因子的模对于任何可能的波数都不能超过 $1$，即对所有 $\\theta \\in [-\\pi, \\pi]$ 都有 $|G(\\theta)| \\le 1$。这等价于 $|G(\\theta)|^2 \\le 1$。\n$$\n|G(\\theta)|^2 = [1 - (C + 2d)(1 - \\cos\\theta)]^2 + (C\\sin\\theta)^2 \\le 1\n$$\n展开表达式：\n$$\n1 - 2(C + 2d)(1 - \\cos\\theta) + (C + 2d)^2(1 - \\cos\\theta)^2 + C^2\\sin^2\\theta \\le 1\n$$\n两边减 $1$ 并化简：\n$$\n-2(C + 2d)(1 - \\cos\\theta) + (C + 2d)^2(1 - \\cos\\theta)^2 + C^2\\sin^2\\theta \\le 0\n$$\n为了简化这个表达式，我们使用半角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\frac{\\theta}{2})$ 和恒等式 $\\sin^2\\theta = 4\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) = 4\\sin^2(\\frac{\\theta}{2})(1-\\sin^2(\\frac{\\theta}{2}))$。设 $S = \\sin^2(\\frac{\\theta}{2})$。不等式变为：\n$$\n-2(C + 2d)(2S) + (C + 2d)^2(2S)^2 + C^2(4S(1-S)) \\le 0\n$$\n对于 $S \\ne 0$（即，对于非零波数），我们可以除以 $4S$：\n$$\n-(C + 2d) + S(C + 2d)^2 + C^2(1-S) \\le 0\n$$\n根据 $S$ 重新整理各项：\n$$\nS [(C + 2d)^2 - C^2] + [C^2 - (C + 2d)] \\le 0\n$$\n化简 $S$ 的系数：\n$$\n(C + 2d)^2 - C^2 = C^2 + 4Cd + 4d^2 - C^2 = 4Cd + 4d^2 = 4d(C+d)\n$$\n现在不等式为：\n$$\nS [4d(C+d)] + C^2 - C - 2d \\le 0\n$$\n这个不等式必须对所有可分辨的模式都成立。$\\theta$ 的范围是 $[-\\pi, \\pi]$，这意味着 $\\frac{\\theta}{2}$ 在 $[-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$ 内，因此 $S = \\sin^2(\\frac{\\theta}{2})$ 在 $[0, 1]$ 内。\n因为 $a, \\nu, h, \\Delta t$ 都是正数，所以 $C>0$ 且 $d>0$。因此 $S$ 的系数 $4d(C+d)$ 是正的。这意味着不等式的左边是关于 $S$ 的单调递增函数。最严格的条件（不等式左边的最大值）出现在 $S$ 取其最大值 $S=1$ 时（对应于 $\\theta=\\pi$ 的最高频率模式）。我们必须对 $S=1$ 施加这个不等式：\n$$\n(1) [4d(C+d)] + C^2 - C - 2d \\le 0\n$$\n$$\n4Cd + 4d^2 + C^2 - C - 2d \\le 0\n$$\n这个表达式可以方便地重新整理为：\n$$\n(C^2 + 4Cd + 4d^2) - (C + 2d) \\le 0\n$$\n$$\n(C + 2d)^2 - (C + 2d) \\le 0\n$$\n设 $Z = C + 2d$。不等式为 $Z^2 - Z \\le 0$，或 $Z(Z-1) \\le 0$。\n因为 $C = \\frac{a \\Delta t}{h} > 0$ 且 $d = \\frac{\\nu \\Delta t}{h^2} > 0$，它们的和 $Z = C+2d$ 也必须是正的。为了使乘积 $Z(Z-1)$ 为非正数，我们必须有 $Z-1 \\le 0$，这意味着 $Z \\le 1$。\n因此，稳定性的条件是：\n$$\nC + 2d \\le 1\n$$\n将 $C$ 和 $d$ 的定义代回到这个不等式中：\n$$\n\\frac{a \\Delta t}{h} + 2\\frac{\\nu \\Delta t}{h^2} \\le 1\n$$\n为了找到最大稳定时间步长 $\\Delta t$，我们求解 $\\Delta t$：\n$$\n\\Delta t \\left( \\frac{a}{h} + \\frac{2\\nu}{h^2} \\right) \\le 1\n$$\n由于括号中的项是正的，我们可以写成：\n$$\n\\Delta t \\le \\frac{1}{\\frac{a}{h} + \\frac{2\\nu}{h^2}}\n$$\n将分母中的项合并成一个分数：\n$$\n\\Delta t \\le \\frac{1}{\\frac{ah + 2\\nu}{h^2}}\n$$\n因此，最大稳定时间步长是：\n$$\n\\Delta t_{\\text{max}} = \\frac{h^2}{ah + 2\\nu}\n$$\n这个表达式给出了关于问题的物理和数值参数的稳定性极限。",
            "answer": "$$\n\\boxed{\\frac{h^2}{ah + 2\\nu}}\n$$"
        },
        {
            "introduction": "在实际的工程模拟中，仅仅满足稳定性条件往往是不够的；我们还需要确保数值解能够准确地捕捉关键的物理过程。本练习将引导您从纯粹的数学推导转向实际的工程决策。您需要选择一个时间步长 $ \\Delta t $，它不仅要避免数值不稳定，还要能够充分解析模拟中最快的物理时间尺度，如网格尺度的对流和扩散时间。",
            "id": "3985787",
            "problem": "在均匀、不可压缩、热均匀流中的一维瞬态热传输，在空间区间 $[0,L]$ 上通过平流-扩散能量方程进行建模：\n$$\n\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2},\n$$\n其中 $T(x,t)$ 是温度，$a>0$ 是恒定的流速，$\\alpha>0$ 是恒定的热扩散系数。考虑一个间距为 $h$ 的均匀空间网格，并采用时间上向前欧拉的全显式时间积分。空间平流项使用与 $a>0$ 一致的一阶迎风差分进行离散，扩散项使用二阶中心差分进行离散。假设内部稳定性可以通过在离散算子周期性下的傅里叶 (von Neumann) 模态分析来评估。\n\n您需要选择一个全局时间步长 $\\Delta t$ 来推进显式格式。您的选择必须同时满足两个要求：\n\n- 在所述离散化下，显式格式对所有傅里叶模态都具有线性稳定性。\n- 在平流和扩散中，解析最短的物理相关的网格尺度时间，具体含义如下：离散时间步长必须在最快的网格尺度输运过程中产生至少 $5$ 个解析的时间层级。将网格尺度平流时间定义为物质单元穿过一个网格单元所需的时间，并将网格尺度扩散时间定义为热扩散散布到与一个网格单元相当的距离所需的时间。使用基本定义（对于平流，$v = dx/dt$；对于扩散，扩散长度尺度 $\\ell \\sim \\sqrt{\\alpha t}$）来确定相关的时间尺度。\n\n给定参数 $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$，$a = 0.5\\,\\mathrm{m/s}$，以及 $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$，在以下关于 $\\Delta t$ 的选项中，哪个是满足由离散化产生的稳定性要求和上述解析度要求的最大值？基于第一性原理和适当的稳定性推理来证明您的选择，包括 Courant–Friedrichs–Lewy (CFL) 条件以及从傅里叶分析中出现的任何与扩散相关的约束。\n\n- A. $\\Delta t = 2.0 \\times 10^{-3}\\,\\mathrm{s}$\n\n- B. $\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$\n\n- C. $\\Delta t = 5.0 \\times 10^{-2}\\,\\mathrm{s}$\n\n- D. $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$",
            "solution": "首先验证问题陈述，以确保其科学上合理、适定且客观。\n\n### 第 1 步：提取已知条件\n- **控制方程**：一维平流-扩散方程为 $\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2}$。\n- **参数**：\n    - 流速：$a > 0$，恒定。\n    - 热扩散系数：$\\alpha > 0$，恒定。\n    - 网格间距：$h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$。\n    - 流速值：$a = 0.5\\,\\mathrm{m/s}$。\n    - 热扩散系数值：$\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$。\n- **离散格式**：\n    - 时间：全显式，向前欧拉。\n    - 平流项 ($\\partial T/\\partial x$)：对于 $a>0$ 采用一阶迎风差分。\n    - 扩散项 ($\\partial^2 T/\\partial x^2$)：二阶中心差分。\n- **对时间步长 $\\Delta t$ 的要求**：\n    1.  **稳定性**：格式对所有傅里叶模态必须是线性稳定的。\n    2.  **解析度**：时间步长必须在最快的网格尺度输运过程中提供至少 $5$ 个解析的时间层级。\n        -   网格尺度平流时间 ($\\tau_{adv}$)：穿过一个网格单元所需的时间，由 $v = dx/dt$ 定义。\n        -   网格尺度扩散时间 ($\\tau_{diff}$)：扩散散布一个网格单元距离所需的时间，由 $\\ell \\sim \\sqrt{\\alpha t}$ 定义。\n- **目标**：从选项中找出满足这两个要求的 $\\Delta t$ 的最大值。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：问题描述了计算热工学中的一个标准设置。平流-扩散方程是一个基本的物理模型。数值方法（向前欧拉、迎风、中心差分）和稳定性分析（von Neumann）是偏微分方程数值分析中的经典课题。该问题在科学上是有效的。\n- **适定性**：问题提供了所有必要的数据和定义，以建立关于时间步长 $\\Delta t$ 的两个清晰的量化约束。寻找满足这些约束的最大选项的任务是明确的，并导向唯一的解。\n- **客观性**：问题以精确的数学和物理术语陈述，没有任何主观性或模糊性。\n\n### 第 3 步：结论与行动\n问题陈述是**有效的**。现在开始求解过程。\n\n### 解的推导\n\n求解需要满足关于时间步长 $\\Delta t$ 的两个不同约束。我们将分别推导每个约束，然后将它们结合起来，找到最严格的界限。\n\n**1. 要求 1：线性稳定性**\n\n控制偏微分方程为：\n$$\n\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2}\n$$\n令 $T_j^n$ 表示在空间网格点 $j$ 和时间层 $n$ 的温度，其中 $x_j = j h$ 且 $t_n = n \\Delta t$。指定的离散格式为：\n- 时间上向前欧拉：$\\frac{\\partial T}{\\partial t} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}$\n- 平流项的一阶迎风格式（因为 $a>0$）：$a\\,\\frac{\\partial T}{\\partial x} \\approx a\\,\\frac{T_j^n - T_{j-1}^n}{h}$\n- 扩散项的二阶中心差分：$\\alpha\\,\\frac{\\partial^2 T}{\\partial x^2} \\approx \\alpha\\,\\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{h^2}$\n\n将这些代入偏微分方程，得到全离散方程：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} + a\\,\\frac{T_j^n - T_{j-1}^n}{h} = \\alpha\\,\\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{h^2}\n$$\n求解 $T_j^{n+1}$：\n$$\nT_j^{n+1} = T_j^n - \\frac{a \\Delta t}{h}(T_j^n - T_{j-1}^n) + \\frac{\\alpha \\Delta t}{h^2}(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n我们定义 Courant 数 $C = \\frac{a \\Delta t}{h}$ 和扩散数 $d = \\frac{\\alpha \\Delta t}{h^2}$。方程变为：\n$$\nT_j^{n+1} = T_j^n - C(T_j^n - T_{j-1}^n) + d(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n$$\nT_j^{n+1} = (1 - C - 2d)T_j^n + (C+d)T_{j-1}^n + d T_{j+1}^n\n$$\n对于 von Neumann 稳定性分析，我们代入一个傅里叶模态 $T_j^n = G^n e^{i k x_j} = G^n e^{i \\theta j}$，其中 $\\theta = k h$ 是无量纲波数。这得到放大因子 $G$：\n$$\nG = (1 - C - 2d) + (C+d)e^{-i\\theta} + d e^{i\\theta}\n$$\n稳定性条件是对于所有 $\\theta \\in [-\\pi, \\pi]$ 都有 $|G(\\theta)| \\le 1$。对于这个特定格式，一个广为人知的充分必要条件是通过要求对所有 $\\theta$ 都有 $|G(\\theta)| \\le 1$ 来推导的。最严格的约束出现在 $\\theta = \\pi$ 处，这导致了以下条件：\n$$\nC + 2d \\leq 1\n$$\n代入 $C$ 和 $d$ 的定义：\n$$\n\\frac{a \\Delta t}{h} + \\frac{2\\alpha \\Delta t}{h^2} \\leq 1\n$$\n$$\n\\Delta t \\left( \\frac{a}{h} + \\frac{2\\alpha}{h^2} \\right) \\leq 1\n$$\n这给出了对 $\\Delta t$ 的稳定性约束：\n$$\n\\Delta t \\leq \\frac{1}{\\frac{a}{h} + \\frac{2\\alpha}{h^2}}\n$$\n使用给定的参数值：\n- $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$\n- $a = 0.5\\,\\mathrm{m/s}$\n- $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n\n我们计算分母中的各项：\n$$\n\\frac{a}{h} = \\frac{0.5\\,\\mathrm{m/s}}{1.0 \\times 10^{-3}\\,\\mathrm{m}} = 500\\,\\mathrm{s}^{-1}\n$$\n$$\n\\frac{2\\alpha}{h^2} = \\frac{2 \\times (1.0 \\times 10^{-5}\\,\\mathrm{m^2/s})}{(1.0 \\times 10^{-3}\\,\\mathrm{m})^2} = \\frac{2.0 \\times 10^{-5}}{1.0 \\times 10^{-6}}\\,\\mathrm{s}^{-1} = 20\\,\\mathrm{s}^{-1}\n$$\n稳定性允许的最大时间步长是：\n$$\n\\Delta t_{stability} \\leq \\frac{1}{500\\,\\mathrm{s}^{-1} + 20\\,\\mathrm{s}^{-1}} = \\frac{1}{520}\\,\\mathrm{s} \\approx 1.923 \\times 10^{-3}\\,\\mathrm{s}\n$$\n\n**2. 要求 2：时间解析度**\n\n这个要求基于解析物理时间尺度来约束 $\\Delta t$。我们必须确定在单个网格单元上传输的最短特征时间。\n\n- **网格尺度平流时间 ($\\tau_{adv}$)**：流体单元以速度 $a$ 行进距离 $h$ 所需的时间。\n$$\n\\tau_{adv} = \\frac{h}{a} = \\frac{1.0 \\times 10^{-3}\\,\\mathrm{m}}{0.5\\,\\mathrm{m/s}} = 2.0 \\times 10^{-3}\\,\\mathrm{s}\n$$\n\n- **网格尺度扩散时间 ($\\tau_{diff}$)**：热量扩散过特征距离 $h$ 所需的时间，基于尺度关系 $\\ell \\sim \\sqrt{\\alpha t}$。设 $\\ell = h$ 且 $t=\\tau_{diff}$：\n$$\nh^2 = \\alpha \\tau_{diff} \\implies \\tau_{diff} = \\frac{h^2}{\\alpha} = \\frac{(1.0 \\times 10^{-3}\\,\\mathrm{m})^2}{1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}} = \\frac{1.0 \\times 10^{-6}}{1.0 \\times 10^{-5}}\\,\\mathrm{s} = 0.1\\,\\mathrm{s}\n$$\n\n这两个时间尺度中最快的（即最短的）是：\n$$\n\\tau_{fastest} = \\min(\\tau_{adv}, \\tau_{diff}) = \\min(2.0 \\times 10^{-3}\\,\\mathrm{s}, 0.1\\,\\mathrm{s}) = 2.0 \\times 10^{-3}\\,\\mathrm{s}\n$$\n解析度要求规定在这个最快的时间尺度内必须有至少 5 个时间步：\n$$\n5 \\Delta t \\leq \\tau_{fastest}\n$$\n$$\n\\Delta t \\leq \\frac{\\tau_{fastest}}{5} = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{s}}{5} = 0.4 \\times 10^{-3}\\,\\mathrm{s} = 4.0 \\times 10^{-4}\\,\\mathrm{s}\n$$\n所以，解析度约束为 $\\Delta t_{resolution} \\leq 4.0 \\times 10^{-4}\\,\\mathrm{s}$。\n\n**3. 总体约束与选项评估**\n\n为同时满足两个要求，$\\Delta t$ 必须小于或等于两个推导出的界限中的最小值：\n$$\n\\Delta t \\leq \\min(\\Delta t_{stability}, \\Delta t_{resolution})\n$$\n$$\n\\Delta t \\leq \\min(1.923 \\times 10^{-3}\\,\\mathrm{s}, 4.0 \\times 10^{-4}\\,\\mathrm{s})\n$$\n$$\n\\Delta t \\leq 4.0 \\times 10^{-4}\\,\\mathrm{s}\n$$\n解析度要求是更严格的约束。满足两个条件的最大可能时间步长是 $\\Delta t_{max} = 4.0 \\times 10^{-4}\\,\\mathrm{s}$。我们现在根据这个限制来评估给定的选项。\n\n- **A. $\\Delta t = 2.0 \\times 10^{-3}\\,\\mathrm{s}$**：该值为 $20.0 \\times 10^{-4}\\,\\mathrm{s}$。由于 $20.0 \\times 10^{-4}\\,\\mathrm{s} > 4.0 \\times 10^{-4}\\,\\mathrm{s}$，此选项违反了解析度约束。它也违反了稳定性约束 ($2.0 \\times 10^{-3}\\,\\mathrm{s} > 1.923 \\times 10^{-3}\\,\\mathrm{s}$)。**不正确**。\n\n- **B. $\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$**：该值恰好等于允许的最大时间步长 $\\Delta t_{max}$。它既满足解析度约束（$\\Delta t \\le 4.0 \\times 10^{-4}\\,\\mathrm{s}$），也满足稳定性约束（$\\Delta t \\le 1.923 \\times 10^{-3}\\,\\mathrm{s}$）。这是一个有效的选择。**正确**。\n\n- **C. $\\Delta t = 5.0 \\times 10^{-2}\\,\\mathrm{s}$**：该值为 $500 \\times 10^{-4}\\,\\mathrm{s}$。这个值远大于 $\\Delta t_{max}$，并且违反了两个约束。**不正确**。\n\n- **D. $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$**：该值小于 $\\Delta t_{max}$。由于 $1.0 \\times 10^{-4}\\,\\mathrm{s} \\le 4.0 \\times 10^{-4}\\,\\mathrm{s}$，它满足两个约束，是一个有效的选择。**正确**。\n\n问题要求从选项中找出满足两个要求的**最大值**。在两个有效选项 B ($\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$) 和 D ($\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$) 之间，选项 B 是较大的值。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "隐式格式，如 Crank-Nicolson 方法，因其无条件稳定性而备受青睐，这似乎消除了对时间步长 $ \\Delta t $ 的严格限制。然而，这个高级练习揭示了一个微妙但关键的陷阱：即使是稳定的格式也可能产生非物理的振荡解。通过构建一个具体的反例，您将学会区分稳定性和单调性这两个重要概念，并理解为什么一个“稳定”的模拟结果仍可能是错误的。",
            "id": "3985733",
            "problem": "考虑均匀杆上的一维热传导方程，\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\n空间区间为 $[0,1]$，边界条件为齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(1,t)=0$。使用包含 $N=2$ 个内部节点的均匀网格对空间域进行离散，并使用标准的二阶中心差分来近似拉普拉斯算子。使用 Crank–Nicolson 格式进行时间推进。定义无量纲参数 $r = \\alpha \\Delta t / \\Delta x^{2}$，其中 $\\Delta x$ 是均匀网格间距，$\\Delta t$ 是时间步长。此处的单调性（离散极值原理）指的是以下性质：如果当前内部温度向量 $u^{n}$ 是逐项非负的，那么下一步的向量 $u^{n+1}$ 也应是逐项非负的。\n\n从控制方程和给定的离散化方法出发，推导内部自由度的 $2\\times 2$ 线性时间步进映射 $u^{n+1} = \\mathbf{T}(r)\\,u^{n}$。然后，使用初始离散状态 $u^{n} = \\begin{pmatrix}1  0\\end{pmatrix}^{\\mathsf{T}}$，确定使得 $u^{n+1}$ 的第一个内部分量变为负的最小 $r$ 值，从而为大 $\\Delta t$ 下不满足单调性提供一个明确的反例。将你的最终答案表示为不含单位的、仅含根式的单一闭式表达式。中间过程的不等式不被接受为最终答案。\n\n此外，解释单调性的丧失如何与 M-矩阵（单调矩阵）相关的矩阵单调性条件的违反相关联。此处 M-矩阵定义为非对角元素为非正且其逆矩阵逐项非负的矩阵。你可以引用 Courant–Friedrichs–Lewy (CFL) 条件来对比稳定性和单调性，但不要假定任何预先推导的时间步进公式；从给定的基本原理出发推导所有必需的矩阵。\n\n无需四舍五入；提供所要求的关于 $r$ 的阈值的精确表达式。",
            "solution": "首先根据指定标准验证问题。\n\n**步骤 1：提取已知条件**\n-   控制方程：$\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}}$\n-   空间域：$x \\in [0, 1]$\n-   边界条件：$u(0,t)=0$ 和 $u(1,t)=0$（齐次狄利克雷）\n-   空间离散化：包含 $N=2$ 个内部节点的均匀网格。使用二阶中心差分近似拉普拉斯算子。\n-   时间离散化：Crank-Nicolson 格式。\n-   参数定义：$r = \\alpha \\Delta t / \\Delta x^{2}$\n-   单调性定义：如果当前内部温度向量 $u^{n}$ 是逐项非负的，那么下一步的向量 $u^{n+1}$ 也应是逐项非负的。\n-   测试的初始条件：$u^{n} = \\begin{pmatrix}1  0\\end{pmatrix}^{\\mathsf{T}}$\n-   目标 1：推导 $2\\times 2$ 时间步进映射 $u^{n+1} = \\mathbf{T}(r)\\,u^{n}$。\n-   目标 2：在给定的测试初始条件下，找出使得 $u^{n+1}_1 < 0$ 的最小 $r$ 值。\n-   目标 3：解释单调性的丧失与 M-矩阵性质之间的联系。\n-   目标 4：对比单调性与稳定性。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的且客观的。它为计算热工学中的一个标准问题（即一维热方程的 Crank-Nicolson 格式分析）提供了一个完整且一致的设置。任务具体、可形式化且可数学验证。该问题不违反任何无效性标准。\n\n**结论**\n问题有效。\n\n**求解推导**\n\n我们首先对控制偏微分方程进行离散化。\n\n**空间离散化**\n空间域为 $[0, 1]$。当有 $N=2$ 个内部节点时，总网格点数为 $N+2=4$。设这些点从 $i=0$ 索引到 $i=3$。网格间距是均匀的，所以 $\\Delta x = \\frac{1-0}{N+1} = \\frac{1}{3}$。内部节点位于 $x_1 = \\frac{1}{3}$ 和 $x_2 = \\frac{2}{3}$，对应的温度变量为 $u_1(t)$ 和 $u_2(t)$。边界条件要求 $u_0(t) = u(0, t) = 0$ 和 $u_3(t) = u(1, t) = 0$。\n\n拉普拉斯算子 $\\frac{\\partial^2 u}{\\partial x^2}$ 在内部节点 $x_i$ 处的二阶中心差分近似由下式给出：\n$$ \\left.\\frac{\\partial^2 u}{\\partial x^2}\\right|_{x_i} \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{\\Delta x^2} $$\n将此应用于我们的两个内部节点：\n-   在 $x_1$ 处：$\\frac{u_0 - 2u_1 + u_2}{\\Delta x^2} = \\frac{0 - 2u_1 + u_2}{\\Delta x^2}$\n-   在 $x_2$ 处：$\\frac{u_1 - 2u_2 + u_3}{\\Delta x^2} = \\frac{u_1 - 2u_2 + 0}{\\Delta x^2}$\n\n令 $u(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ 为内部温度向量。空间离散化（线方法）得到的常微分方程组为：\n$$ \\frac{d u}{d t} = \\frac{\\alpha}{\\Delta x^2} \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} u = \\frac{\\alpha}{\\Delta x^2} \\mathbf{L} u $$\n其中 $\\mathbf{L} = \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix}$ 是内部节点的离散拉普拉斯矩阵。\n\n**时间离散化：Crank-Nicolson 格式**\nCrank-Nicolson 格式对时间层 $t_n$ 和 $t_{n+1}$ 的右侧项取平均：\n$$ \\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{1}{2} \\left[ \\left(\\alpha \\frac{\\partial^2 u}{\\partial x^2}\\right)^{n+1} + \\left(\\alpha \\frac{\\partial^2 u}{\\partial x^2}\\right)^n \\right] $$\n代入空间离散化的矩阵形式：\n$$ \\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{1}{2} \\left( \\frac{\\alpha}{\\Delta x^2} \\mathbf{L} u^{n+1} + \\frac{\\alpha}{\\Delta x^2} \\mathbf{L} u^n \\right) $$\n使用无量纲参数 $r = \\frac{\\alpha \\Delta t}{\\Delta x^2}$：\n$$ u^{n+1} - u^n = \\frac{r}{2} \\mathbf{L} u^{n+1} + \\frac{r}{2} \\mathbf{L} u^n $$\n重新整理各项以求解 $u^{n+1}$：\n$$ \\left(\\mathbf{I} - \\frac{r}{2}\\mathbf{L}\\right) u^{n+1} = \\left(\\mathbf{I} + \\frac{r}{2}\\mathbf{L}\\right) u^n $$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。\n\n**时间步进映射 $\\mathbf{T}(r)$ 的推导**\n该方程的形式为 $\\mathbf{A} u^{n+1} = \\mathbf{B} u^n$，其中 $\\mathbf{A} = \\mathbf{I} - \\frac{r}{2}\\mathbf{L}$ 和 $\\mathbf{B} = \\mathbf{I} + \\frac{r}{2}\\mathbf{L}$。时间步进映射为 $\\mathbf{T}(r) = \\mathbf{A}^{-1}\\mathbf{B}$。\n\n首先，我们计算 $\\mathbf{A}$ 和 $\\mathbf{B}$：\n$$ \\mathbf{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{r}{2}\\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} = \\begin{pmatrix} 1+r  -r/2 \\\\ -r/2  1+r \\end{pmatrix} $$\n$$ \\mathbf{B} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{r}{2}\\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} = \\begin{pmatrix} 1-r  r/2 \\\\ r/2  1-r \\end{pmatrix} $$\n\n接下来，我们求 $\\mathbf{A}$ 的逆矩阵。$\\mathbf{A}$ 的行列式为：\n$$ \\det(\\mathbf{A}) = (1+r)^2 - \\left(-\\frac{r}{2}\\right)^2 = 1 + 2r + r^2 - \\frac{r^2}{4} = 1 + 2r + \\frac{3}{4}r^2 $$\n逆矩阵 $\\mathbf{A}^{-1}$ 为：\n$$ \\mathbf{A}^{-1} = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1+r  r/2 \\\\ r/2  1+r \\end{pmatrix} $$\n\n现在，我们计算 $\\mathbf{T}(r) = \\mathbf{A}^{-1}\\mathbf{B}$：\n$$ \\mathbf{T}(r) = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1+r  r/2 \\\\ r/2  1+r \\end{pmatrix} \\begin{pmatrix} 1-r  r/2 \\\\ r/2  1-r \\end{pmatrix} $$\n矩阵乘积为：\n$$ \\begin{pmatrix} (1+r)(1-r) + (r/2)^2  (1+r)(r/2) + (r/2)(1-r) \\\\ (r/2)(1-r) + (1+r)(r/2)  (r/2)^2 + (1+r)(1-r) \\end{pmatrix} = \\begin{pmatrix} 1-r^2 + \\frac{r^2}{4}  \\frac{r}{2} + \\frac{r^2}{2} + \\frac{r}{2} - \\frac{r^2}{2} \\\\ \\frac{r}{2} - \\frac{r^2}{2} + \\frac{r}{2} + \\frac{r^2}{2}  \\frac{r^2}{4} + 1-r^2 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{3}{4}r^2  r \\\\ r  1 - \\frac{3}{4}r^2 \\end{pmatrix} $$\n因此，时间步进映射为：\n$$ \\mathbf{T}(r) = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1 - \\frac{3}{4}r^2  r \\\\ r  1 - \\frac{3}{4}r^2 \\end{pmatrix} $$\n\n**确定 $r$ 的临界值**\n给定初始状态 $u^n = \\begin{pmatrix}1  0\\end{pmatrix}^{\\mathsf{T}}$，它是逐项非负的。我们计算 $u^{n+1} = \\mathbf{T}(r)u^n$：\n$$ u^{n+1} = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1 - \\frac{3}{4}r^2  r \\\\ r  1 - \\frac{3}{4}r^2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1 - \\frac{3}{4}r^2 \\\\ r \\end{pmatrix} $$\n下一状态的分量为 $u^{n+1}_1 = \\frac{1 - \\frac{3}{4}r^2}{1 + 2r + \\frac{3}{4}r^2}$ 和 $u^{n+1}_2 = \\frac{r}{1 + 2r + \\frac{3}{4}r^2}$。\n对于 $r > 0$，分母 $1 + 2r + \\frac{3}{4}r^2$ 总是正的。分量 $u^{n+1}_2$ 也总是正的。第一个分量 $u^{n+1}_1$ 在其分子变为负数时变为负数。对于这个特定的初始条件，单调性的丧失发生在 $u^{n+1}_1 < 0$ 时。\n阈值条件是 $u^{n+1}_1 = 0$，这要求分子为零：\n$$ 1 - \\frac{3}{4}r^2 = 0 $$\n$$ 1 = \\frac{3}{4}r^2 $$\n$$ r^2 = \\frac{4}{3} $$\n因为 $r$ 必须为正，我们取正平方根：\n$$ r = \\sqrt{\\frac{4}{3}} = \\frac{2}{\\sqrt{3}} $$\n对于任何大于 $\\frac{2}{\\sqrt{3}}$ 的 $r$ 值，分量 $u^{n+1}_1$ 将为负，从而违反单调性。发生此转变的最小 $r$ 值就是阈值本身。\n\n**与 M-矩阵、单调性和稳定性的联系**\n如果对于任何非负向量 $u^n$，得到的向量 $u^{n+1} = \\mathbf{T}(r)u^n$ 也非负，则该格式是单调的。这当且仅当传播矩阵 $\\mathbf{T}(r)$ 逐项非负时成立。对于 $r > 0$，$\\mathbf{T}(r)$ 的分母及其非对角元素均为正。因此，当对角元素 $1 - \\frac{3}{4}r^2$ 变为负数时，单调性丧失。这给出了单调性的条件：$1 - \\frac{3}{4}r^2 \\geq 0$，即 $r \\le \\frac{2}{\\sqrt{3}}$。\n\n问题将 M-矩阵定义为具有非正的非对角元素和逐项非负的逆矩阵。来自该格式隐式部分的矩阵 $\\mathbf{A} = \\mathbf{I} - \\frac{r}{2}\\mathbf{L}$，当 $r > 0$ 时，其非对角元素 $-r/2 \\le 0$。其逆矩阵 $\\mathbf{A}^{-1}$ 已被证明对所有 $r>0$ 都是逐项为正的。因此，$\\mathbf{A}$ 对所有 $r > 0$ 都是一个 M-矩阵。这个 M-矩阵的存在保证了关于 $u^{n+1}$ 的隐式系统总是唯一可解的。\n\n单调性的丧失是违反了 $\\mathbf{T}(r)$ 必须是一个非负矩阵的条件。$\\mathbf{A}$ 是一个 M-矩阵（因此 $\\mathbf{A}^{-1} \\ge 0$）这一事实是该结构的关键部分，但其本身并不足以保证单调性。格式 $\\mathbf{A}u^{n+1} = \\mathbf{B}u^n$ 单调的一个常见充分（但非必要）条件是 $\\mathbf{A}$ 是一个 M-矩阵且 $\\mathbf{B}$ 是一个非负矩阵。在我们的例子中，$\\mathbf{B} = \\begin{pmatrix} 1-r  r/2 \\\\ r/2  1-r \\end{pmatrix}$ 仅当 $1-r \\ge 0$，即 $r \\le 1$ 时才非负。我们的分析表明，单调性实际上在更大的值 $r \\le \\frac{2}{\\sqrt{3}} \\approx 1.1547$ 之前都成立。因此，单调性的丧失与传播矩阵 $\\mathbf{T}(r) = \\mathbf{A}^{-1}\\mathbf{B}$ 不再是非负矩阵直接相关，这发生在已确定的 $r$ 的临界值处。\n\n最后，我们将其与稳定性进行对比。Crank-Nicolson 格式在 von Neumann 意义下是无条件稳定的，这意味着对于所有 $r > 0$，放大因子的模长都小于或等于 $1$。这确保了数值误差不会无界增长。然而，正如所推导的，该格式仅是条件单调的。对于 $r > \\frac{2}{\\sqrt{3}}$，该格式是稳定的但非单调的，允许物理上不切实际的振荡（例如，从正的初始数据产生负温度）出现在解中，尽管其振幅不会增长。Courant–Friedrichs–Lewy (CFL) 条件通常是一个稳定性约束，但在本例中并不限制稳定性的时间步长。然而，一个形式相似的关于 $r$ 的约束来自于单调性的要求，对于扩散问题，单调性通常是比稳定性本身更理想的性质。",
            "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}}}\n$$"
        }
    ]
}