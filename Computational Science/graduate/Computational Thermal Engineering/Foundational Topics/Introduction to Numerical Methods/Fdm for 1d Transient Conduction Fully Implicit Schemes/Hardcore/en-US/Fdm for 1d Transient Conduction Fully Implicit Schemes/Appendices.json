{
    "hands_on_practices": [
        {
            "introduction": "Mastering a numerical method begins with the fundamental skill of translating a physical problem into a solvable algebraic system. This first practice guides you through the essential steps of deriving the fully implicit finite difference equations for transient heat conduction. You will then learn how to correctly modify these equations to incorporate Dirichlet (fixed-temperature) boundary conditions, a critical procedure for assembling the linear system $\\mathbf{A}\\mathbf{T}^{n+1}=\\mathbf{b}$ that forms the core of the simulation .",
            "id": "3952708",
            "problem": "A one-dimensional homogeneous rod of length $L$ with constant thermal properties (thermal conductivity $k$, mass density $\\rho$, and specific heat $c$) undergoes transient heat conduction without internal heat generation. The governing equation is the transient heat equation, and the boundary conditions are prescribed temperatures (Dirichlet type) at the two ends $x=0$ and $x=L$. You will discretize the domain using a uniform grid and apply the Finite Difference Method (FDM) with a fully implicit time integration scheme.\n\nStarting from the integral form of energy conservation applied to a control volume around a generic interior node $i$ and Fourier’s law of heat conduction, derive the algebraic equation at time level $n+1$ for an interior node that depends on the temperatures at nodes $i-1$, $i$, and $i+1$. Clearly identify the dimensionless group that multiplies the spatial discretization term. Then, using the fact that the boundary temperatures are prescribed at $x=0$ and $x=L$ (Dirichlet boundary conditions), show how the first and last interior-node equations must be modified so that the known boundary temperatures are correctly incorporated in the linear system $\\mathbf{A}\\mathbf{T}^{n+1}=\\mathbf{b}$.\n\nFinally, for the specific case with the following parameters:\n- rod length $L=0.1\\,\\mathrm{m}$,\n- number of uniform intervals $N=5$ (so there are $N-1=4$ interior unknowns at nodes $i=1,2,3,4$),\n- time step $\\Delta t=20\\,\\mathrm{s}$,\n- thermal diffusivity $\\alpha=k/(\\rho c)=1.0\\times 10^{-5}\\,\\mathrm{m^2/s}$,\n- interior-node temperatures at time level $n$: $T_1^n=310\\,\\mathrm{K}$, $T_2^n=300\\,\\mathrm{K}$, $T_3^n=295\\,\\mathrm{K}$, $T_4^n=290\\,\\mathrm{K}$,\n- Dirichlet boundary values $T(0,t)=T_L=400\\,\\mathrm{K}$ and $T(L,t)=T_R=280\\,\\mathrm{K}$,\n\nwrite explicitly the first and last equations in terms of the unknown vector $\\mathbf{T}^{n+1}=\\big[T_1^{n+1},T_2^{n+1},T_3^{n+1},T_4^{n+1}\\big]^{\\top}$, and report the concatenated row vector of their coefficients and right-hand sides in the following order:\n$$\\big[a_{11}\\ a_{12}\\ a_{13}\\ a_{14}\\ b_1\\ a_{41}\\ a_{42}\\ a_{43}\\ a_{44}\\ b_4\\big],$$\nwhere $a_{jk}$ denotes the coefficient multiplying $T_k^{n+1}$ in equation $j$ and $b_j$ is the corresponding right-hand side. Round your answer to four significant figures and express the row vector entries with no units.",
            "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded in the principles of heat transfer and numerical methods, is well-posed, objective, and contains all necessary information for a complete solution.\n\nThe problem asks for three parts: first, the derivation of the finite difference equation for an interior node using a fully implicit scheme; second, the modification of this equation for the first and last interior nodes subject to Dirichlet boundary conditions; and third, the calculation of specific coefficients and right-hand side terms for a given numerical case.\n\n**Part 1: Derivation of the Fully Implicit Algebraic Equation for an Interior Node**\n\nWe start from the integral form of energy conservation for a one-dimensional control volume of length $\\Delta x$ and unit cross-sectional area centered at node $i$. The principle states that the rate of change of stored energy within the control volume equals the net rate of heat conducted into it.\n$$\n\\frac{dE_{st}}{dt} = \\dot{E}_{in} - \\dot{E}_{out}\n$$\nFor the control volume extending from $x_{i-1/2}$ to $x_{i+1/2}$, the stored energy is $E_{st} = (\\rho c \\Delta x) T_i$. The rate of change is thus $\\rho c \\Delta x \\frac{dT_i}{dt}$. The heat transfer rates are given by the heat fluxes $q$ at the control volume faces: $\\dot{E}_{in} = q_{x, i-1/2}$ and $\\dot{E}_{out} = q_{x, i+1/2}$. The energy balance becomes:\n$$\n\\rho c \\Delta x \\frac{dT_i}{dt} = q_{x, i-1/2} - q_{x, i+1/2}\n$$\nUsing Fourier's law of conduction, $q = -k \\frac{\\partial T}{\\partial x}$, we approximate the fluxes using central differences:\n$$\nq_{x, i-1/2} \\approx -k \\frac{T_i - T_{i-1}}{\\Delta x} \\quad \\text{and} \\quad q_{x, i+1/2} \\approx -k \\frac{T_{i+1} - T_i}{\\Delta x}\n$$\nSubstituting these into the energy balance gives:\n$$\n\\rho c \\Delta x \\frac{dT_i}{dt} \\approx -k \\frac{T_i - T_{i-1}}{\\Delta x} - \\left(-k \\frac{T_{i+1} - T_i}{\\Delta x}\\right) = \\frac{k}{\\Delta x} (T_{i-1} - 2T_i + T_{i+1})\n$$\nNow, we discretize in time. The time derivative is approximated using a first-order difference between time levels $n$ and $n+1$:\n$$\n\\frac{dT_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\nFor a **fully implicit** scheme, the spatial derivatives (the right-hand side of the energy balance) are evaluated at the future time level, $n+1$:\n$$\n\\rho c \\Delta x \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{k}{(\\Delta x)^2} (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1})\n$$\nDividing by $\\rho c$ and introducing the thermal diffusivity $\\alpha = k/(\\rho c)$:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\alpha}{(\\Delta x)^2} (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1})\n$$\nThe dimensionless group that multiplies the spatial discretization term is the **mesh Fourier number**, defined as $Fo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$. Substituting this definition, we get:\n$$\nT_i^{n+1} - T_i^n = Fo (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1})\n$$\nRearranging this equation to group all unknown temperatures at time $n+1$ on the left-hand side and known temperatures at time $n$ on the right-hand side yields the final algebraic equation for an interior node $i$:\n$$\n-Fo \\cdot T_{i-1}^{n+1} + (1 + 2Fo) \\cdot T_i^{n+1} - Fo \\cdot T_{i+1}^{n+1} = T_i^n\n$$\n\n**Part 2: Modification for Dirichlet Boundary Conditions**\n\nThe problem specifies Dirichlet boundary conditions, where the temperatures at the ends of the rod are prescribed: $T(0,t) = T_L$ and $T(L,t) = T_R$. In our discretized domain with $N$ intervals, there are $N+1$ nodes indexed from $i=0$ to $i=N$. The boundary nodes are $i=0$ and $i=N$, so $T_0^{n+1} = T_L$ and $T_N^{n+1} = T_R$. The unknown temperatures are at the interior nodes $i=1, 2, \\ldots, N-1$.\n\nFor the **first interior node ($i=1$)**:\nThe general equation is applied:\n$$\n-Fo \\cdot T_{0}^{n+1} + (1 + 2Fo) \\cdot T_1^{n+1} - Fo \\cdot T_2^{n+1} = T_1^n\n$$\nSince $T_0^{n+1} = T_L$ is a known value, we move the term containing it to the right-hand side of the equation:\n$$\n(1 + 2Fo) \\cdot T_1^{n+1} - Fo \\cdot T_2^{n+1} = T_1^n + Fo \\cdot T_L\n$$\nThis is the first row of the linear system $\\mathbf{A}\\mathbf{T}^{n+1}=\\mathbf{b}$.\n\nFor the **last interior node ($i=N-1$)**:\nThe general equation is applied:\n$$\n-Fo \\cdot T_{N-2}^{n+1} + (1 + 2Fo) \\cdot T_{N-1}^{n+1} - Fo \\cdot T_{N}^{n+1} = T_{N-1}^n\n$$\nSince $T_N^{n+1} = T_R$ is a known value, we move the term containing it to the right-hand side:\n$$\n-Fo \\cdot T_{N-2}^{n+1} + (1 + 2Fo) \\cdot T_{N-1}^{n+1} = T_{N-1}^n + Fo \\cdot T_R\n$$\nThis is the last row of the linear system.\n\n**Part 3: Numerical Calculation**\n\nThe given parameters are:\n- $L = 0.1\\,\\mathrm{m}$\n- $N = 5$ intervals, which implies $N-1=4$ interior nodes ($i=1, 2, 3, 4$) and $N+1=6$ total nodes ($i=0, \\ldots, 5$).\n- $\\Delta t = 20\\,\\mathrm{s}$\n- $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n- $T_1^n = 310\\,\\mathrm{K}$, $T_2^n = 300\\,\\mathrm{K}$, $T_3^n = 295\\,\\mathrm{K}$, $T_4^n = 290\\,\\mathrm{K}$\n- Boundary temperatures: $T_L = T_0^{n+1} = 400\\,\\mathrm{K}$ and $T_R = T_5^{n+1} = 280\\,\\mathrm{K}$\n\nFirst, we calculate the grid spacing $\\Delta x$:\n$$\n\\Delta x = \\frac{L}{N} = \\frac{0.1\\,\\mathrm{m}}{5} = 0.02\\,\\mathrm{m}\n$$\nNext, we calculate the mesh Fourier number $Fo$:\n$$\nFo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = \\frac{(1.0 \\times 10^{-5}\\,\\mathrm{m^2/s})(20\\,\\mathrm{s})}{(0.02\\,\\mathrm{m})^2} = \\frac{2.0 \\times 10^{-4}\\,\\mathrm{m^2}}{4.0 \\times 10^{-4}\\,\\mathrm{m^2}} = 0.5\n$$\nThe linear system involves the unknown vector $\\mathbf{T}^{n+1}=\\big[T_1^{n+1}, T_2^{n+1}, T_3^{n+1}, T_4^{n+1}\\big]^{\\top}$.\n\n**Equation for the first interior node ($i=1$):**\nThis corresponds to the first row of the system ($j=1$).\n$$\n(1 + 2Fo) T_1^{n+1} - Fo T_2^{n+1} = T_1^n + Fo T_L\n$$\nSubstituting numerical values:\n$$\n(1 + 2(0.5)) T_1^{n+1} - 0.5 T_2^{n+1} = 310 + (0.5)(400)\n$$\n$$\n2.0 T_1^{n+1} - 0.5 T_2^{n+1} = 310 + 200 = 510\n$$\nThe full equation, with all unknowns from $\\mathbf{T}^{n+1}$, is:\n$$\n2.0 T_1^{n+1} - 0.5 T_2^{n+1} + 0 T_3^{n+1} + 0 T_4^{n+1} = 510\n$$\nThe coefficients and right-hand side for the first equation are:\n$a_{11} = 2.0$, $a_{12} = -0.5$, $a_{13} = 0$, $a_{14} = 0$, $b_1 = 510$.\n\n**Equation for the last interior node ($i=4$):**\nThis corresponds to the fourth row of the system ($j=4$). The interior nodes are $1, 2, 3, 4$, so the last one is $i=4$, which corresponds to $i=N-1$ since $N=5$.\n$$\n-Fo T_{3}^{n+1} + (1 + 2Fo) T_{4}^{n+1} = T_4^n + Fo T_R\n$$\nSubstituting numerical values:\n$$\n-0.5 T_3^{n+1} + (1 + 2(0.5)) T_4^{n+1} = 290 + (0.5)(280)\n$$\n$$\n-0.5 T_3^{n+1} + 2.0 T_4^{n+1} = 290 + 140 = 430\n$$\nThe full equation is:\n$$\n0 T_1^{n+1} + 0 T_2^{n+1} - 0.5 T_3^{n+1} + 2.0 T_4^{n+1} = 430\n$$\nThe coefficients and right-hand side for the fourth equation are:\n$a_{41} = 0$, $a_{42} = 0$, $a_{43} = -0.5$, $a_{44} = 2.0$, $b_4 = 430$.\n\n**Final Result Assembly:**\nWe need to report the concatenated row vector $\\big[a_{11}\\ a_{12}\\ a_{13}\\ a_{14}\\ b_1\\ a_{41}\\ a_{42}\\ a_{43}\\ a_{44}\\ b_4\\big]$. Rounding each value to four significant figures:\n- $a_{11} = 2.0 \\rightarrow 2.000$\n- $a_{12} = -0.5 \\rightarrow -0.5000$\n- $a_{13} = 0 \\rightarrow 0.000$\n- $a_{14} = 0 \\rightarrow 0.000$\n- $b_1 = 510 \\rightarrow 510.0$\n- $a_{41} = 0 \\rightarrow 0.000$\n- $a_{42} = 0 \\rightarrow 0.000$\n- $a_{43} = -0.5 \\rightarrow -0.5000$\n- $a_{44} = 2.0 \\rightarrow 2.000$\n- $b_4 = 430 \\rightarrow 430.0$\n\nThe final vector of numerical values is:\n$\\begin{pmatrix} 2.000  -0.5000  0.000  0.000  510.0  0.000  0.000  -0.5000  2.000  430.0 \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.000  -0.5000  0.000  0.000  510.0  0.000  0.000  -0.5000  2.000  430.0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While Dirichlet conditions are common, many engineering systems involve insulated or symmetric boundaries, which are modeled with Neumann (fixed-flux) conditions. This practice delves into the profound implications of these conditions on the discrete mathematical system, exploring concepts like matrix singularity, solution uniqueness, and the physical principle of energy conservation. By analyzing the system matrix, you will discover why the transient implicit formulation is inherently robust and well-posed, even when the corresponding steady-state problem is not .",
            "id": "3952712",
            "problem": "Consider one-dimensional transient heat conduction in a homogeneous rod of length $L$ with constant thermal diffusivity $\\alpha$, governed by energy conservation and Fourier’s law, which in one spatial dimension lead to the partial differential equation $\\partial T/\\partial t = \\alpha \\, \\partial^{2} T/\\partial x^{2}$ subject to homogeneous Neumann (zero heat-flux) boundary conditions at $x=0$ and $x=L$. Discretize the spatial domain with a uniform grid of $N$ nodes and spacing $\\Delta x = L/(N-1)$ and use the Finite Difference Method (FDM) with second-order central differences in the interior and a consistent elimination of ghost nodes to enforce the homogeneous Neumann boundary conditions at the end nodes. Denote by $K \\in \\mathbb{R}^{N \\times N}$ the symmetric matrix that represents the discrete operator corresponding to $-\\,\\partial^{2}/\\partial x^{2}$ with these homogeneous Neumann boundary conditions. Consider the steady problem with a discrete source vector $b \\in \\mathbb{R}^{N}$, as well as the fully implicit (backward Euler) time discretization for the transient problem with time step $\\Delta t  0$.\n\nWhich of the following statements are correct?\n\n- A. For the steady pure Neumann problem with no source, the discrete stiffness matrix $K$ has rank $N-1$, with a one-dimensional nullspace spanned by the constant vector, and the steady solution is unique up to an additive constant.\n\n- B. For the steady pure Neumann problem with an arbitrary nonzero discrete source $b$, there is always a unique discrete solution without any additional condition on $b$.\n\n- C. In the fully implicit scheme, the linear system matrix at each time step can be written in the form $I + \\alpha \\,\\Delta t \\, K$, and for any $\\Delta t0$ this matrix is nonsingular even under pure Neumann boundary conditions.\n\n- D. The condition number of the implicit step matrix $I + \\alpha \\,\\Delta t \\, K$ remains bounded as $\\Delta t \\to \\infty$ because the nullspace is removed by the Neumann boundary conditions.\n\n- E. Under homogeneous Neumann boundary conditions and no internal source, the spatial average of the discrete temperature (the arithmetic mean over the $N$ nodes on a uniform grid) is conserved by the fully implicit time stepping.\n\nSelect all that apply.",
            "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\n- **Governing Equation:** One-dimensional transient heat conduction, $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}}$.\n- **Domain:** A homogeneous rod of length $L$.\n- **Material Property:** Constant thermal diffusivity $\\alpha$.\n- **Boundary Conditions (BCs):** Homogeneous Neumann (zero heat-flux) at $x=0$ and $x=L$, i.e., $\\frac{\\partial T}{\\partial x}\\vert_{x=0} = 0$ and $\\frac{\\partial T}{\\partial x}\\vert_{x=L} = 0$.\n- **Spatial Discretization:** Finite Difference Method (FDM) on a uniform grid with $N$ nodes and spacing $\\Delta x = L/(N-1)$.\n- **Numerical Scheme (Spatial):** Second-order central differences in the interior. Consistent elimination of ghost nodes for the Neumann BCs.\n- **Discrete Operator:** $K \\in \\mathbb{R}^{N \\times N}$ is the **symmetric** matrix representing the discrete operator $-\\frac{\\partial^{2}}{\\partial x^{2}}$ with the specified BCs.\n- **Problem Types:**\n    1. Steady problem with a discrete source vector $b \\in \\mathbb{R}^{N}$.\n    2. Transient problem using fully implicit (Backward Euler) time discretization with time step $\\Delta t  0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes a standard setup in computational heat transfer. It is scientifically grounded, well-posed, and objective.\n\n- **Scientific Grounding:** The problem is based on the fundamental heat equation and the widely used Finite Difference Method. All principles are well-established in physics and numerical analysis.\n- **Well-Posedness  Consistency:** The crucial detail is the nature of the matrix $K$. The description \"second-order central differences in the interior and a consistent elimination of ghost nodes\" can lead to a non-symmetric matrix if interpreted in a specific way. However, the problem provides the overriding constraint that $K$ is a **symmetric** matrix. This constraint resolves any ambiguity and points to the standard, symmetric form of the discrete Laplacian for Neumann problems. This matrix can be derived from a finite volume or variational formulation, and it is known to be consistent with the continuous operator. With this understanding, the problem is self-contained and consistent.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The analysis can proceed based on the properties of the symmetric discrete Laplacian matrix for homogeneous Neumann boundary conditions.\n\n## DERIVATION\n\nThe problem revolves around the properties of the matrix $K$ and the resulting numerical schemes. The problem specifies that $K$ is the symmetric matrix for the operator $-\\frac{\\partial^2}{\\partial x^2}$ under homogeneous Neumann boundary conditions. This matrix, for an $N$-node grid, is given by:\n$$\nK = \\frac{1}{(\\Delta x)^2}\n\\begin{pmatrix}\n1  -1  0  \\dots  0  0 \\\\\n-1  2  -1  \\dots  0  0 \\\\\n0  -1  2  \\dots  0  0 \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\dots  2  -1 \\\\\n0  0  0  \\dots  -1  1\n\\end{pmatrix}\n$$\nThis matrix has several key properties:\n1.  **Symmetry:** $K = K^T$. This is given and is true by inspection.\n2.  **Positive Semi-Definiteness:** For any vector $\\mathbf{v} \\in \\mathbb{R}^N$, the quadratic form is $\\mathbf{v}^T K \\mathbf{v} = \\frac{1}{(\\Delta x)^2} \\sum_{i=1}^{N-1} (v_i - v_{i+1})^2 \\ge 0$. Thus, $K$ is positive semi-definite, and all its eigenvalues $\\lambda_k$ are real and non-negative.\n3.  **Nullspace:** The quadratic form $\\mathbf{v}^T K \\mathbf{v} = 0$ if and only if $v_i - v_{i+1} = 0$ for all $i=1, \\dots, N-1$. This implies $v_1 = v_2 = \\dots = v_N$. Therefore, the nullspace of $K$ is the set of all constant vectors, spanned by the vector $\\mathbf{1} = [1, 1, \\dots, 1]^T$.\n4.  **Rank:** Since $K$ is an $N \\times N$ matrix and its nullspace has dimension $1$, the rank-nullity theorem implies that the rank of $K$ is $N-1$.\n5.  **Row/Column Sums:** The sum of the elements in each row is $0$. For example, for row $i$ ($1  i  N$), the sum is $-1+2-1=0$. For row $1$, it is $1-1=0$. Since $K$ is symmetric, the sum of elements in each column is also $0$. The property that row sums are zero is equivalent to the statement $K\\mathbf{1} = \\mathbf{0}$. The property that column sums are zero is equivalent to $\\mathbf{1}^T K = \\mathbf{0}^T$.\n\nWith these properties established, we can analyze each statement.\n\n### Option-by-Option Analysis\n\n**A. For the steady pure Neumann problem with no source, the discrete stiffness matrix $K$ has rank $N-1$, with a one-dimensional nullspace spanned by the constant vector, and the steady solution is unique up to an additive constant.**\n\nThe steady-state problem with no source is $K\\mathbf{T} = \\mathbf{0}$. The solutions to this homogeneous system are the vectors in the nullspace of $K$.\n- As established above, the nullspace of $K$ is one-dimensional and is spanned by the constant vector $\\mathbf{1}$.\n- By the rank-nullity theorem, the rank of $K$ is $N - \\dim(\\text{nullspace}(K)) = N-1$.\n- The set of solutions is $\\{\\mathbf{T} | \\mathbf{T} = c\\mathbf{1} \\text{ for some constant } c \\in \\mathbb{R}\\}$. This means any constant temperature profile is a solution.\n- The phrase \"unique up to an additive constant\" means that if $\\mathbf{T}_{\\text{sol}}$ is a solution, then so is $\\mathbf{T}_{\\text{sol}} + C\\mathbf{1}$ for any scalar constant $C$. Let's check: if $\\mathbf{T}_{\\text{sol}} = c_1\\mathbf{1}$ is a solution, then $\\mathbf{T}_{\\text{sol}} + C\\mathbf{1} = c_1\\mathbf{1} + C\\mathbf{1} = (c_1+C)\\mathbf{1}$. This is another vector in the nullspace, so it is also a solution. The phrasing is appropriate.\nThis statement accurately describes the properties of the steady, sourceless Neumann problem.\n\n**Verdict: Correct**\n\n**B. For the steady pure Neumann problem with an arbitrary nonzero discrete source $b$, there is always a unique discrete solution without any additional condition on $b$.**\n\nThe problem is to solve the linear system $K\\mathbf{T} = \\mathbf{b}$.\n- According to the Fredholm alternative theorem, this system has a solution if and only if the source vector $\\mathbf{b}$ is orthogonal to the nullspace of the adjoint operator $K^T$. Since $K$ is symmetric, we require $\\mathbf{b}$ to be orthogonal to the nullspace of $K$.\n- The nullspace of $K$ is spanned by $\\mathbf{1}$. The orthogonality condition is $\\mathbf{1}^T \\mathbf{b} = 0$, which means $\\sum_{i=1}^N b_i = 0$.\n- The statement claims a solution exists for an *arbitrary* nonzero source $\\mathbf{b}$. This is false, as a solution only exists if $\\mathbf{b}$ satisfies the condition $\\sum b_i = 0$. This condition represents the physical constraint of global energy conservation at steady state in an isolated system.\n- Furthermore, if a solution $\\mathbf{T}_p$ exists, the general solution is $\\mathbf{T} = \\mathbf{T}_p + c\\mathbf{1}$, where $c\\mathbf{1}$ is any vector in the nullspace. The solution is therefore not unique; it is unique only up to an additive constant.\n- The statement is incorrect on two counts: existence and uniqueness are not guaranteed as stated.\n\n**Verdict: Incorrect**\n\n**C. In the fully implicit scheme, the linear system matrix at each time step can be written in the form $I + \\alpha \\,\\Delta t \\, K$, and for any $\\Delta t0$ this matrix is nonsingular even under pure Neumann boundary conditions.**\n\nThe 1D transient heat equation, discretized in space, is $\\frac{d\\mathbf{T}}{dt} = -\\alpha K \\mathbf{T}$.\n- The fully implicit (Backward Euler) method discretizes the time derivative as $\\frac{\\mathbf{T}^{p+1} - \\mathbf{T}^p}{\\Delta t}$ and evaluates the right-hand side at the future time step $p+1$:\n$$ \\frac{\\mathbf{T}^{p+1} - \\mathbf{T}^p}{\\Delta t} = -\\alpha K \\mathbf{T}^{p+1} $$\n- Rearranging this equation to solve for $\\mathbf{T}^{p+1}$ gives:\n$$ \\mathbf{T}^{p+1} + \\alpha \\Delta t K \\mathbf{T}^{p+1} = \\mathbf{T}^p \\implies (I + \\alpha \\Delta t K) \\mathbf{T}^{p+1} = \\mathbf{T}^p $$\n- The linear system matrix is $M = I + \\alpha \\Delta t K$. To check if it is nonsingular, we examine its eigenvalues. Let $\\lambda_k$ be the eigenvalues of $K$. The eigenvalues of $M$ are $\\mu_k = 1 + \\alpha \\Delta t \\lambda_k$.\n- We established that $K$ is symmetric positive semi-definite, so its eigenvalues $\\lambda_k$ are real and non-negative ($\\lambda_k \\ge 0$). One eigenvalue is $\\lambda_1 = 0$, and all others are strictly positive.\n- The eigenvalues of $M$ are therefore:\n  $\\mu_1 = 1 + \\alpha \\Delta t \\lambda_1 = 1 + 0 = 1$.\n  For $k  1$, $\\lambda_k  0$, and since $\\alpha  0$ and $\\Delta t  0$, $\\mu_k = 1 + \\alpha \\Delta t \\lambda_k  1$.\n- All eigenvalues $\\mu_k$ of the matrix $M$ are greater than or equal to $1$. None are zero. A matrix is nonsingular if and only if it has no zero eigenvalues. Thus, $M$ is nonsingular for any $\\Delta t  0$.\n\n**Verdict: Correct**\n\n**D. The condition number of the implicit step matrix $I + \\alpha \\,\\Delta t \\, K$ remains bounded as $\\Delta t \\to \\infty$ because the nullspace is removed by the Neumann boundary conditions.**\n\nThe matrix is $M = I + \\alpha \\Delta t K$. Since $K$ is symmetric, $M$ is also symmetric. The spectral condition number (using the 2-norm) is the ratio of the largest to the smallest eigenvalue magnitude: $\\text{cond}_2(M) = |\\mu_{\\max}| / |\\mu_{\\min}|$.\n- The eigenvalues of $M$ are $\\mu_k = 1 + \\alpha \\Delta t \\lambda_k$. All are positive.\n- The minimum eigenvalue is $\\mu_{\\min} = 1 + \\alpha \\Delta t \\lambda_{\\min} = 1 + \\alpha \\Delta t (0) = 1$.\n- The maximum eigenvalue is $\\mu_{\\max} = 1 + \\alpha \\Delta t \\lambda_{\\max}$, where $\\lambda_{\\max}$ is the largest eigenvalue of $K$. Since the grid is finite, $\\lambda_{\\max}$ is a finite positive number. (Specifically, $\\lambda_{\\max} \\approx 4/(\\Delta x)^2$).\n- The condition number is $\\text{cond}_2(M) = \\frac{1 + \\alpha \\Delta t \\lambda_{\\max}}{1} = 1 + \\alpha \\Delta t \\lambda_{\\max}$.\n- As $\\Delta t \\to \\infty$, the term $\\alpha \\Delta t \\lambda_{\\max}$ grows without bound. Therefore, $\\lim_{\\Delta t \\to \\infty} \\text{cond}_2(M) = \\infty$.\n- The condition number is not bounded as $\\Delta t \\to \\infty$. The system becomes progressively more ill-conditioned. The reasoning provided in the statement is also flawed; the nullspace of $K$ is a *consequence* of the pure Neumann BCs, not removed by them.\n\n**Verdict: Incorrect**\n\n**E. Under homogeneous Neumann boundary conditions and no internal source, the spatial average of the discrete temperature (the arithmetic mean over the $N$ nodes on a uniform grid) is conserved by the fully implicit time stepping.**\n\nThe spatial average temperature at time step $p$ is $\\bar{T}^p = \\frac{1}{N} \\sum_{i=1}^N T^p_i$. In vector notation, this is $\\bar{T}^p = \\frac{1}{N} \\mathbf{1}^T \\mathbf{T}^p$. We need to verify if $\\bar{T}^{p+1} = \\bar{T}^p$, which is equivalent to showing $\\mathbf{1}^T \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p$.\n- The time-stepping equation is $(I + \\alpha \\Delta t K) \\mathbf{T}^{p+1} = \\mathbf{T}^p$.\n- Pre-multiply both sides by the row vector $\\mathbf{1}^T$:\n$$ \\mathbf{1}^T (I + \\alpha \\Delta t K) \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n$$ (\\mathbf{1}^T I + \\alpha \\Delta t \\mathbf{1}^T K) \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n- As established in the preamble, for the symmetric matrix $K$ with zero row sums, we have $K\\mathbf{1}=\\mathbf{0}$. Since $K$ is symmetric, this also implies $\\mathbf{1}^T K = (K\\mathbf{1})^T = \\mathbf{0}^T$.\n- Substituting $\\mathbf{1}^T K = \\mathbf{0}^T$ into the equation:\n$$ (\\mathbf{1}^T + \\alpha \\Delta t \\mathbf{0}^T) \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n$$ \\mathbf{1}^T \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n- This confirms that the sum of the temperatures is conserved at each time step. Consequently, their arithmetic mean is also conserved. This is the discrete analog of the conservation of total thermal energy in an isolated system.\n\n**Verdict: Correct**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "The ultimate test of understanding is the ability to implement a method and analyze its behavior. This final exercise transitions from theoretical formulation to practical application, requiring you to write a program to solve the heat equation and compare the numerical results against a known exact solution. Through this process, you will quantify the concept of numerical damping—an artifact inherent to the backward Euler scheme—and develop critical skills for validating computational models .",
            "id": "3952709",
            "problem": "Consider the one-dimensional transient heat conduction initial-boundary value problem on a finite rod with homogeneous Dirichlet boundary conditions. Let the temperature field be $T(x,t)$, thermal diffusivity be $\\alpha$ (in $\\mathrm{m}^2/\\mathrm{s}$), and the rod length be $L$ (in $\\mathrm{m}$). The governing equation and data are:\n- Governing equation: $\\dfrac{\\partial T}{\\partial t} = \\alpha \\dfrac{\\partial^2 T}{\\partial x^2}$ for $0  x  L$, $t  0$.\n- Boundary conditions: $T(0,t) = 0$ and $T(L,t) = 0$ for all $t \\ge 0$.\n- Initial condition (single-mode): $T(x,0) = T_{\\mathrm{ref}} \\sin\\!\\left(\\dfrac{m \\pi x}{L}\\right)$ where $m$ is a positive integer mode index and $T_{\\mathrm{ref}}$ is a reference temperature amplitude. Use $T_{\\mathrm{ref}} = 1$ K so that temperature is in kelvin.\n\nUsing the Finite Difference Method (FDM) with a fully implicit (backward Euler) time integration and second-order central differences in space on a uniform grid with $N$ interior nodes:\n- Define the spatial step $\\Delta x = \\dfrac{L}{N+1}$ and grid points $x_i = i \\Delta x$ for $i=1,2,\\dots,N$.\n- Denote the time step as $\\Delta t$ (in $\\mathrm{s}$).\n- At a single time step from $t=0$ to $t=\\Delta t$, discretize the spatial operator with the standard second difference and discretize time with the backward Euler method. Use the fundamental law of conservation of energy and Fourier’s law to motivate the heat equation, and then discretize from first principles (no shortcut formulas are to be assumed in this problem statement).\n\nTasks:\n1. Starting from the governing equation and the specified discretization choices, set up the linear system that must be solved to obtain the fully implicit solution vector $T^{1}$ at time $t=\\Delta t$ from the initial nodal vector $T^{0}$.\n2. Use the exact separation-of-variables solution for the given single-mode initial condition to write the exact temperature at $t=\\Delta t$ as a function of $x$; then evaluate it at the grid points $x_i$ to obtain a reference exact nodal vector $T^{\\mathrm{exact}}$.\n3. For a single time step, quantify the numerical damping introduced by the backward Euler method by computing the following two metrics at the grid nodes:\n   - The amplification ratio $G_{\\mathrm{num}} = \\dfrac{\\lVert T^{1} \\rVert_2}{\\lVert T^{0} \\rVert_2}$ (dimensionless), where $\\lVert \\cdot \\rVert_2$ denotes the Euclidean norm; and the exact modal amplification $G_{\\mathrm{exact}} = \\exp\\!\\left(-\\alpha \\left(\\dfrac{m \\pi}{L}\\right)^2 \\Delta t\\right)$ (dimensionless). Define the relative damping factor $R = \\dfrac{G_{\\mathrm{num}}}{G_{\\mathrm{exact}}}$ (dimensionless). Interpret $R1$ as underdamping relative to the exact solution over one time step, and $R1$ as overdamping.\n   - The infinity-norm discrepancy $E_{\\infty} = \\max_i \\left| T^{1}_i - T^{\\mathrm{exact}}_i \\right|$ (in kelvin).\n4. Implement a program that, for each test case below, computes $R$ and $E_{\\infty}$ as defined above and outputs them.\n\nUse the following test suite (each tuple is $(L \\ \\mathrm{[m]}, \\ \\alpha \\ \\mathrm{[m}^2/\\mathrm{s}], \\ N, \\ \\Delta t \\ \\mathrm{[s]}, \\ m)$):\n- Test $1$: $(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;20,\\ \\Delta t=\\;0.1,\\ m=\\;1)$.\n- Test $2$: $(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;20,\\ \\Delta t=\\;10.0,\\ m=\\;1)$.\n- Test $3$: $(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;10,\\ \\Delta t=\\;1.0,\\ m=\\;5)$.\n- Test $4$: $(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;8,\\ \\Delta t=\\;1.0,\\ m=\\;8)$.\n- Test $5$: $(L=\\;2.0,\\ \\alpha=\\;5.0\\times 10^{-5},\\ N=\\;40,\\ \\Delta t=\\;0.5,\\ m=\\;3)$.\n\nNumerical and output requirements:\n- All computations must use $T_{\\mathrm{ref}} = 1$ K, so that $T(x,0)$ has units of kelvin and $E_{\\infty}$ is reported in kelvin.\n- Angles are dimensionless (the sine function uses arguments in radians).\n- The final output of your program must be a single line containing a list of results, one per test case, where each result is the two-element list $[R,E_{\\infty}]$ with both entries rounded to eight decimal places. The entire output must be a single line of the form $[[R_1,E_{\\infty,1}],[R_2,E_{\\infty,2}],\\dots]$ with no extra text.",
            "solution": "The problem is valid. It is a well-posed initial-boundary value problem from computational physics, with a clear and consistent set of definitions, conditions, and tasks. All parameters are specified, and the required metrics are unambiguously defined. The problem is scientifically grounded in the theory of heat transfer and numerical analysis.\n\nWe proceed with a step-by-step derivation and solution, following the tasks outlined in the problem statement.\n\n### Step 1: Derivation of the Fully Implicit Finite Difference Scheme\n\nThe governing partial differential equation (PDE) for one-dimensional transient heat conduction is given as:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{for } 0  x  L, \\ t  0\n$$\nwhere $T(x,t)$ is the temperature field, $\\alpha$ is the thermal diffusivity, $x$ is the spatial coordinate, and $t$ is time. This equation arises from applying the principle of conservation of energy to an infinitesimal control volume, combined with Fourier's law of heat conduction, $q = -k A \\frac{\\partial T}{\\partial x}$, where $\\alpha = k/(\\rho c)$.\n\nWe discretize the spatial domain $[0, L]$ using a uniform grid with $N$ interior nodes. The spatial step size is $\\Delta x = \\frac{L}{N+1}$, and the grid points are $x_i = i \\Delta x$ for $i=0, 1, \\dots, N+1$. The temperatures at these nodes are denoted by $T_i(t) = T(x_i, t)$. The boundary conditions are $T_0(t) = 0$ and $T_{N+1}(t) = 0$.\n\nWe discretize in time with a time step $\\Delta t$, denoting the temperature at time $t_n = n \\Delta t$ as $T_i^n = T(x_i, t_n)$.\n\nThe problem asks for a fully implicit scheme, which means the spatial derivative is evaluated at the future time level, $n+1$. The time derivative is approximated using the first-order backward Euler method, and the spatial second derivative is approximated using the second-order central difference formula. At an interior node $i$ and time level $n+1$, the discretized PDE is:\n\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n\nOur task is to find the temperature vector $T^1$ at time $t=\\Delta t$ (i.e., $n=0$). The equation becomes:\n\n$$\n\\frac{T_i^{1} - T_i^0}{\\Delta t} = \\alpha \\frac{T_{i-1}^{1} - 2T_i^{1} + T_{i+1}^{1}}{(\\Delta x)^2}\n$$\n\nTo form a linear system, we rearrange the terms, moving all unknowns (at time level $1$) to the left-hand side and all knowns (at time level $0$) to the right-hand side.\n\n$$\nT_i^{1} - T_i^0 = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i-1}^{1} - 2T_i^{1} + T_{i+1}^{1})\n$$\n\nLet's define the dimensionless Fourier number, $F_o = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$. The equation simplifies to:\n\n$$\nT_i^{1} - T_i^0 = F_o (T_{i-1}^{1} - 2T_i^{1} + T_{i+1}^{1})\n$$\n\n$$\n-F_o T_{i-1}^{1} + (1 + 2F_o) T_i^{1} - F_o T_{i+1}^{1} = T_i^0\n$$\n\nThis equation is valid for all interior nodes, $i=1, 2, \\dots, N$. We must incorporate the boundary conditions $T(0,t)=0$ and $T(L,t)=0$, which in our discrete notation are $T_0^1=0$ and $T_{N+1}^1=0$.\n\nFor node $i=1$:\n$$\n-F_o T_0^1 + (1 + 2F_o) T_1^1 - F_o T_2^1 = T_1^0 \\implies (1 + 2F_o) T_1^1 - F_o T_2^1 = T_1^0\n$$\n\nFor node $i=N$:\n$$\n-F_o T_{N-1}^1 + (1 + 2F_o) T_N^1 - F_o T_{N+1}^1 = T_N^0 \\implies -F_o T_{N-1}^1 + (1 + 2F_o) T_N^1 = T_N^0\n$$\n\nThis set of $N$ linear equations can be written in matrix form as $A T^1 = T^0$, where $T^1 = [T_1^1, T_2^1, \\dots, T_N^1]^T$ is the vector of unknown temperatures and $T^0 = [T_1^0, T_2^0, \\dots, T_N^0]^T$ is the vector of known initial temperatures. The matrix $A$ is an $N \\times N$ symmetric, tridiagonal matrix:\n\n$$\nA = \\begin{pmatrix}\n1+2F_o  -F_o  0  \\dots  0 \\\\\n-F_o  1+2F_o  -F_o  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  -F_o  1+2F_o  -F_o \\\\\n0  \\dots  0  -F_o  1+2F_o\n\\end{pmatrix}\n$$\n\nTo find the numerical solution $T^1$, we solve this linear system.\n\n### Step 2: Exact Solution\n\nThe analytical solution to the PDE with the given initial and boundary conditions can be found using the method of separation of variables. The general solution is a Fourier sine series. For the specific single-mode initial condition $T(x,0) = T_{\\mathrm{ref}} \\sin\\left(\\frac{m \\pi x}{L}\\right)$, the solution simplifies dramatically, as only the $m$-th mode is excited. The exact solution is:\n$$\nT(x,t) = T_{\\mathrm{ref}} \\sin\\left(\\frac{m \\pi x}{L}\\right) \\exp\\left(-\\alpha \\left(\\frac{m \\pi}{L}\\right)^2 t\\right)\n$$\nWe set $T_{\\mathrm{ref}} = 1$ K as per the problem statement. The exact temperature at the grid nodes $x_i$ at time $t=\\Delta t$ is given by the vector $T^{\\mathrm{exact}}$ with components:\n$$\nT_i^{\\mathrm{exact}} = T(x_i, \\Delta t) = \\sin\\left(\\frac{m \\pi x_i}{L}\\right) \\exp\\left(-\\alpha \\left(\\frac{m \\pi}{L}\\right)^2 \\Delta t\\right) \\quad \\text{for } i=1, \\dots, N\n$$\n\n### Step 3: Calculation of Metrics\n\nWe now define the procedure to calculate the required metrics for each test case.\nFirst, we establish the initial nodal temperature vector $T^0$ by evaluating $T(x,0)$ at the grid points $x_i$:\n$$\nT_i^0 = T(x_i, 0) = \\sin\\left(\\frac{m \\pi x_i}{L}\\right) \\quad \\text{for } i=1, \\dots, N\n$$\n\n1.  **Solve for $T^1$**: Using the vector $T^0$ as the right-hand side, solve the linear system $A T^1 = T^0$ to obtain the numerical solution vector $T^1$.\n\n2.  **Calculate $G_{\\mathrm{num}}$**: Compute the Euclidean norms (L2-norms) of the numerical solution vector $T^1$ and the initial vector $T^0$.\n    $$\n    G_{\\mathrm{num}} = \\frac{\\lVert T^1 \\rVert_2}{\\lVert T^0 \\rVert_2} = \\frac{\\sqrt{\\sum_{i=1}^N (T_i^1)^2}}{\\sqrt{\\sum_{i=1}^N (T_i^0)^2}}\n    $$\n\n3.  **Calculate $G_{\\mathrm{exact}}$**: The exact modal amplification factor is given by the exponential decay term from the analytical solution:\n    $$\n    G_{\\mathrm{exact}} = \\exp\\left(-\\alpha \\left(\\frac{m \\pi}{L}\\right)^2 \\Delta t\\right)\n    $$\n    Note that $T_i^{\\mathrm{exact}} = T_i^0 \\cdot G_{\\mathrm{exact}}$, which means $\\lVert T^{\\mathrm{exact}} \\rVert_2 = G_{\\mathrm{exact}} \\lVert T^0 \\rVert_2$.\n\n4.  **Calculate $R$**: The relative damping factor is the ratio of the numerical to the exact amplification:\n    $$\n    R = \\frac{G_{\\mathrm{num}}}{G_{\\mathrm{exact}}}\n    $$\n\n5.  **Calculate $E_{\\infty}$**: The infinity-norm discrepancy is the maximum absolute difference between the numerical and exact solutions at the grid nodes:\n    $$\n    E_{\\infty} = \\max_{i=1, \\dots, N} |T_i^1 - T_i^{\\mathrm{exact}}|\n    $$\n\nThis procedure will be implemented for each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D transient heat conduction problem for multiple test cases\n    using a fully implicit finite difference method and evaluates numerical\n    damping and error metrics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (L [m], alpha [m^2/s], N, dt [s], m).\n    test_cases = [\n        (1.0, 1.0e-4, 20, 0.1, 1),\n        (1.0, 1.0e-4, 20, 10.0, 1),\n        (1.0, 1.0e-4, 10, 1.0, 5),\n        (1.0, 1.0e-4, 8, 1.0, 8),\n        (2.0, 5.0e-5, 40, 0.5, 3),\n    ]\n\n    T_ref = 1.0 # Reference temperature amplitude in kelvin.\n    results = []\n    \n    for case in test_cases:\n        L, alpha, N, dt, m = case\n\n        # 1. Define grid and initial conditions\n        # Spatial step for N interior nodes\n        dx = L / (N + 1)\n        # Grid points for interior nodes x_1, ..., x_N\n        x_nodes = np.arange(1, N + 1) * dx\n\n        # Initial temperature vector T^0 at t=0\n        T0 = T_ref * np.sin(m * np.pi * x_nodes / L)\n\n        # 2. Set up and solve the linear system A * T^1 = T^0\n        # Calculate the dimensionless Fourier number\n        Fo = alpha * dt / (dx**2)\n\n        # Construct the tridiagonal matrix A in the banded format required by\n        # scipy.linalg.solve_banded. For a tridiagonal matrix, the banded\n        # matrix 'ab' has 3 rows: super-diagonal, main-diagonal, sub-diagonal.\n        ab = np.zeros((3, N))\n        ab[0, 1:] = -Fo          # Super-diagonal (1st row, shifted)\n        ab[1, :] = 1.0 + 2.0 * Fo # Main diagonal (2nd row)\n        ab[2, :-1] = -Fo         # Sub-diagonal (3rd row, shifted)\n\n        # Solve the linear system for T^1, the temperature vector at t=dt\n        T1 = solve_banded((1, 1), ab, T0)\n\n        # 3. Calculate the exact solution at t=dt\n        # The exact amplification factor for the single mode\n        G_exact = np.exp(-alpha * (m * np.pi / L)**2 * dt)\n        \n        # The exact solution vector is the initial vector scaled by G_exact\n        T_exact = T0 * G_exact\n\n        # 4. Compute the required metrics\n        # Euclidean (L2) norms of the initial and numerical solution vectors\n        norm_T0 = np.linalg.norm(T0, 2)\n        norm_T1 = np.linalg.norm(T1, 2)\n\n        # The numerical amplification ratio G_num\n        # Handle the case where norm_T0 is zero to avoid division by zero\n        if norm_T0 > 1e-15:\n            G_num = norm_T1 / norm_T0\n        else:\n            G_num = 0.0\n\n        # The relative damping factor R\n        R = G_num / G_exact\n\n        # The infinity-norm discrepancy E_inf\n        E_inf = np.linalg.norm(T1 - T_exact, np.inf)\n\n        # Append the computed metrics, rounded to 8 decimal places\n        results.append([round(R, 8), round(E_inf, 8)])\n\n    # 5. Format the final output string as specified\n    # Create a list of strings, e.g., [\"[1.23456789,0.98765432]\"]\n    result_strings = [f\"[{r[0]:.8f},{r[1]:.8f}]\" for r in results]\n    # Join them with commas and enclose in brackets\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}