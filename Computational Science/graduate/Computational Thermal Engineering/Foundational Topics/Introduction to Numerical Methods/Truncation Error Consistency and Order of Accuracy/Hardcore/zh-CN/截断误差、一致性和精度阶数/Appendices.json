{
    "hands_on_practices": [
        {
            "introduction": "理解截断误差是评估任何数值格式的第一步。本练习通过分析经典的一阶迎风格式，提供了基础的分析实践。通过泰勒级数展开，您不仅将确定其精度阶数，还将揭示一个被称为“人工扩散”的关键数值产物，这是理解数值解行为的核心概念 。",
            "id": "4000118",
            "problem": "在计算热工学中，被动热标量的对流输运可以通过一维线性平流偏微分方程（PDE）来建模：\n$$\nu_t + a\\,u_x = 0,\n$$\n其中$u(x,t)$是被输运的标量（例如，温度脉动），$a>0$是一个恒定的平流速度，$x$是空间坐标，$t$是时间。考虑一个具有恒定间距$\\Delta x>0$的均匀网格$x_i = i\\,\\Delta x$，以及在网格点$x_i$处空间导数$u_x$的一阶迎风有限差分近似，其形式如下\n$$\n\\left(u_x\\right)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}, \\quad \\text{for } a>0,\n$$\n其中$u_i \\equiv u(x_i,t)$。\n\n您的任务是：\n- 从局部截断误差的定义和关于$x_i$的泰勒级数展开出发，推导在$x_i$处平流项$a u_x$的离散近似的截断误差，并确定其关于$\\Delta x$的精度阶。\n- 使用相同的展开，为半离散格式$u_t + a \\frac{u_i - u_{i-1}}{\\Delta x} = 0$构建修正方程，方法是将其表示为一个$u(x,t)$近似满足的连续偏微分方程，并保留直到并包括与$\\Delta x^2$成正比的项。\n- 识别并解释修正方程中出现的人工扩散项，并提取其扩散系数。\n\n将您的最终答案表示为关于$a$和$\\Delta x$的人工扩散系数的单个符号表达式。不包括单位，也不要四舍五入；以精确的解析形式提供表达式。",
            "solution": "该问题要求分析用于一维线性平流方程的一阶迎风有限差分格式。分析将分三步进行：首先，推导局部截断误差和精度阶；其次，构建修正偏微分方程（PDE）；第三，识别出人工扩散项及其系数。\n\n控制偏微分方程是线性平流方程：\n$$\nu_t + a u_x = 0\n$$\n其中$u(x,t)$是被输运的标量，$a > 0$是恒定的平流速度，$x$是空间坐标，$t$是时间。空间域在一个间距为$\\Delta x > 0$的均匀网格$x_i = i \\Delta x$上被离散化。空间偏导数$u_x$在网格点$x_i$处使用一阶迎风（后向差分）格式进行近似：\n$$\n(u_x)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n其中$u_i \\equiv u(x_i, t)$。\n\n**第一部分：截断误差和精度阶**\n\n空间离散化的局部截断误差$\\tau_i$是将精确解$u(x,t)$代入有限差分公式时得到的残差。它被定义为作用于精确解的离散算子与连续算子之差。\n\n设连续微分算子为$L(u) = a u_x$。\n设离散差分算子为$L_{\\Delta x}(u_i) = a \\frac{u_i - u_{i-1}}{\\Delta x}$。\n\n那么截断误差为：\n$$\n\\tau_i = L_{\\Delta x}(u_i) - (L u)_i = a \\frac{u_i - u_{i-1}}{\\Delta x} - a (u_x)_i\n$$\n为了分析$\\tau_i$，我们在点$x_i$附近对函数$u(x, t)$在点$x_{i-1} = x_i - \\Delta x$处进行泰勒级数展开。假设解$u(x,t)$足够光滑，我们有：\n$$\nu_{i-1} = u(x_i - \\Delta x, t) = u(x_i, t) - \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_i + \\frac{(\\Delta x)^2}{2!} \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i - \\frac{(\\Delta x)^3}{3!} \\left(\\frac{\\partial^3 u}{\\partial x^3}\\right)_i + \\mathcal{O}((\\Delta x)^4)\n$$\n使用下标表示空间导数，即$(u_x)_i = (\\partial u/\\partial x)_i$，$(u_{xx})_i = (\\partial^2 u/\\partial x^2)_i$等，展开式变为：\n$$\nu_{i-1} = u_i - \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i - \\frac{(\\Delta x)^3}{6} (u_{xxx})_i + \\mathcal{O}((\\Delta x)^4)\n$$\n将此展开式代入截断误差的表达式中：\n$$\n\\tau_i = a \\frac{u_i - \\left(u_i - \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i - \\frac{(\\Delta x)^3}{6} (u_{xxx})_i + \\mathcal{O}((\\Delta x)^4)\\right)}{\\Delta x} - a (u_x)_i\n$$\n化简分子中的项：\n$$\n\\tau_i = a \\frac{\\Delta x (u_x)_i - \\frac{(\\Delta x)^2}{2} (u_{xx})_i + \\frac{(\\Delta x)^3}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^4)}{\\Delta x} - a (u_x)_i\n$$\n除以$\\Delta x$：\n$$\n\\tau_i = a \\left( (u_x)_i - \\frac{\\Delta x}{2} (u_{xx})_i + \\frac{(\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3) \\right) - a (u_x)_i\n$$\n项$a (u_x)_i$被消去，留下截断误差的表达式：\n$$\n\\tau_i = - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3)\n$$\n精度阶由截断误差首项中$\\Delta x$的最低次幂决定。在这种情况下，首项是$- \\frac{a \\Delta x}{2} (u_{xx})_i$，它与$(\\Delta x)^1$成正比。因此，空间离散化对于$\\Delta x$是一阶精度的。\n\n**第二部分：修正方程**\n\n修正方程是数值格式实际求解的偏微分方程，包括其误差项。我们从半离散格式开始，其中空间导数被其有限差分近似所取代：\n$$\n(u_t)_i + a \\frac{u_i - u_{i-1}}{\\Delta x} = 0\n$$\n我们已经得到了离散空间项的泰勒级数展开：\n$$\na \\frac{u_i - u_{i-1}}{\\Delta x} = a (u_x)_i - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3)\n$$\n将此代入半离散方程得到：\n$$\n(u_t)_i + a (u_x)_i - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3) = 0\n$$\n我们可以通过去掉下标$i$来为连续函数$u(x,t)$表达此关系。这个方程代表了数值解近似满足的偏微分方程。重新整理它以匹配原始偏微分方程加误差项的结构，便得到修正方程：\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}((\\Delta x)^3)\n$$\n问题要求保留直到并包括与$(\\Delta x)^2$成正比的项。因此，修正方程为：\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx}\n$$\n\n**第三部分：人工扩散项和系数**\n\n修正方程显示了数值格式如何偏离原始的偏微分方程。右侧的项是离散化引入的误差项。原始方程$u_t + a u_x = 0$描述了没有任何扩散的纯平流过程。\n\n修正方程中的首项误差项是$\\frac{a \\Delta x}{2} u_{xx}$。该项具有扩散项$D u_{xx}$的形式，这是热方程或扩散方程的特征。由于该项是数值方法的产物，而不是原始物理模型的一部分，因此被称为“人工扩散”或“数值扩散”项。\n\n该项是耗散的，意味着它倾向于衰减或平滑解中的陡峭梯度，这是一阶迎风格式的一个已知特性。系数的正号（因为$a > 0$且$\\Delta x > 0$）证实了它起着正向扩散过程的作用，以牺牲精度为代价来确保数值稳定性。\n\n通过将首项误差项与扩散项的一般形式$D_{art} u_{xx}$进行比较，我们可以提取出人工扩散系数$D_{art}$。\n$$\nD_{art} u_{xx} = \\frac{a \\Delta x}{2} u_{xx}\n$$\n因此，人工扩散系数为：\n$$\nD_{art} = \\frac{a \\Delta x}{2}\n$$\n该系数化了格式引入的非物理扩散量。它与平流速度$a$和网格间距$\\Delta x$都成正比。",
            "answer": "$$\\boxed{\\frac{a \\Delta x}{2}}$$"
        },
        {
            "introduction": "一个模拟的整体精度往往由其最薄弱的环节决定，而这通常是边界条件的实施方式。本练习将分析从内部网格点扩展到这一关键的实际问题。您将首先量化一个简陋的边界处理所导致的精度损失，然后学习通过实施“虚拟单元”(ghost-cell)校正来恢复二阶精度，这在计算方法中是一种标准且强大的技术 。",
            "id": "4000115",
            "problem": "考虑在域$x \\in [0,L]$内的均匀杆中的一维稳态热传导，其热导率$k$为常数。设温度场为$T(x)$，假定其足够光滑，且傅里叶热传导定律表明热通量为$q(x) = -k \\,\\frac{dT}{dx}(x)$。位于$x=0$的左边界保持在固定温度$T(0)=T_{b}$（狄利克雷条件）。使用均匀的有限体积网格离散该域，网格包含$N$个宽度为$h = L/N$的控制体，单元中心位于$x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$（$i=1,2,\\dots,N$），左边界界面位于$x=\\tfrac{1}{2}(x_{0}+x_{1})=0$。其中$x_{0}=-\\tfrac{h}{2}$是为了在边界处能够使用内部格式而引入的虚拟单元中心的位置。相邻单元中心之间的面法向温度梯度的内部二阶中心差分近似为\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=(x_{i}+x_{i+1})/2} \\approx \\frac{T_{i+1}-T_{i}}{h}.\n$$\n在左边界界面处，假设通过使用朴素的单边面到中心公式来近似面法向梯度，从而施加狄利克雷边界条件，且不进行任何特殊的边界修正\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=0} \\approx \\frac{T_{1} - T_{b}}{h/2}.\n$$\n使用关于$x=0$的泰勒级数展开以及截断误差和相容性的定义，确定此朴素边界近似对面法向梯度的局部精度阶，并将其与内部的二阶精度进行比较。然后，通过选择一个表示为$T_{b}$、$T_{1}$和$T_{2}$线性组合的合适的虚拟单元值$T_{0}$，提出并推导一个边界修正，该修正在左边界恢复二阶精度的同时，允许使用内部中心差分格式$\\frac{T_{1}-T_{0}}{h}$。\n\n你的任务是：\n- 推导朴素边界近似$\\frac{T_{1}-T_{b}}{h/2}$对$\\left.\\frac{dT}{dx}\\right|_{x=0}$的截断误差，并说明其关于$h$的阶数。\n- 确定相对于内部二阶近似，在边界处产生的精度损失阶数。\n- 通过选择$T_{0}$，使得内部中心差分格式$\\frac{T_{1}-T_{0}}{h}$能以二阶精度近似$\\left.\\frac{dT}{dx}\\right|_{x=0}$，从而推导一个二阶精度的边界修正，并提供$T_{0}$关于$T_b$、$T_1$和$T_2$的显式表达式。\n\n将你的最终答案表示为一个行矩阵，其中包含：\n1) 边界处的整数精度损失阶数，以及\n2) 以$T_b$、$T_1$和$T_2$符号表示的修正后的虚拟单元值$T_{0}$。\n\n无需进行数值计算；请提供精确的符号表达式。最终答案中无需报告物理单位。",
            "solution": "问题要求三项内容：温度梯度的朴素边界近似的精度阶，与内部格式相比产生的精度损失阶数，以及一个能够恢复边界二阶精度的虚拟单元值$T_{0}$的推导。我们将使用泰勒级数分析来依次解决每个任务。\n\n该域通过单元中心$x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$进行离散化。因此，第一个单元中心位于$x_{1} = h/2$，第二个位于$x_{2} = 3h/2$。狄利克雷边界位于$x=0$，其中$T(0) = T_{b}$。我们假设温度场$T(x)$足够光滑，以允许进行泰勒级数展开。\n\n首先，我们分析梯度$\\left.\\frac{dT}{dx}\\right|_{x=0}$的朴素边界近似的截断误差。该近似由下式给出：\n$$\nD_{\\text{naive}} = \\frac{T_{1} - T_{b}}{h/2}\n$$\n其中$T_{1}$是第一个单元中心的温度，$T(x_1) = T(h/2)$，$T_b$是边界温度，$T(0)$。为了求截断误差，我们将$T(h/2)$在$x=0$处进行泰勒级数展开：\n$$\nT_{1} = T(h/2) = T(0) + \\left.\\frac{dT}{dx}\\right|_{x=0} \\left(\\frac{h}{2}\\right) + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{(h/2)^2}{2!} + \\left.\\frac{d^3T}{dx^3}\\right|_{x=0} \\frac{(h/2)^3}{3!} + \\dots\n$$\n代入$T(0) = T_{b}$并化简：\n$$\nT_{1} = T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3)\n$$\n现在，将此展开式代入$D_{\\text{naive}}$的公式中：\n$$\nD_{\\text{naive}} = \\frac{1}{h/2} \\left[ \\left( T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right) - T_{b} \\right]\n$$\n$$\nD_{\\text{naive}} = \\frac{2}{h} \\left[ \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right]\n$$\n$$\nD_{\\text{naive}} = \\left.\\frac{dT}{dx}\\right|_{x=0} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h}{4} + O(h^2)\n$$\n截断误差$\\tau_{\\text{naive}}$是近似值与精确值之差：\n$$\n\\tau_{\\text{naive}} = D_{\\text{naive}} - \\left.\\frac{dT}{dx}\\right|_{x=0} = \\frac{h}{4} \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} + O(h^2)\n$$\n误差的主导项与$h^1$成正比，因此朴素边界近似是一阶精度的，即其精度阶为$p_{\\text{naive}} = 1$。\n\n问题陈述内部近似是二阶精度的 ($p_{\\text{int}} = 2$)。边界处的精度损失阶数是内部阶数与边界阶数之差：\n$$\n\\text{Order Loss} = p_{\\text{int}} - p_{\\text{naive}} = 2 - 1 = 1\n$$\n这样就完成了前两个任务。\n\n对于第三个任务，我们需要找到一个虚拟单元温度值$T_0$，使得中心差分格式$\\frac{T_1 - T_0}{h}$能为边界处梯度$\\left.\\frac{dT}{dx}\\right|_{x=0}$提供一个二阶精度的近似。该格式是中心差分，因为它使用点$x_1 = h/2$和虚拟单元中心$x_0 = -h/2$，并以它们的中点$x=0$为中心。\n已知此中心差分格式的截断误差是二阶的：\n$$\n\\frac{T(h/2) - T(-h/2)}{h} = \\left.\\frac{dT}{dx}\\right|_{x=0} + O(h^2)\n$$\n为了达到此精度，我们必须将$T_0$定义为$T(-h/2)$的一个二阶精度近似。我们可以通过从已知值$T_b = T(0)$、$T_1 = T(h/2)$和$T_2 = T(3h/2)$进行外推来构造这样一个近似。我们可以用一个二次多项式$P(x)$拟合这三个点，并在$x=-h/2$处求值。\n设插值多项式为$P(x) = ax^2 + bx + c$。那么$T_0$的值就是$P(-h/2)$。\n找到$P(-h/2)$的一个直接方法是使用拉格朗日插值公式。这三个点是$(0, T_b)$、$(h/2, T_1)$和$(3h/2, T_2)$。我们想要求出插值多项式在$x = -h/2$处的值。\n$$\nP(x) = T_b L_0(x) + T_1 L_1(x) + T_2 L_2(x)\n$$\n其中$L_i(x)$是拉格朗日基多项式。我们需要在$x=-h/2$处对它们求值。\n对于$L_0(x) = \\frac{(x-h/2)(x-3h/2)}{(0-h/2)(0-3h/2)}$：\n$$\nL_0(-h/2) = \\frac{(-h/2-h/2)(-h/2-3h/2)}{(0-h/2)(0-3h/2)} = \\frac{(-h)(-2h)}{3h^2/4} = \\frac{2h^2}{3h^2/4} = \\frac{8}{3}\n$$\n对于$L_1(x) = \\frac{(x-0)(x-3h/2)}{(h/2-0)(h/2-3h/2)}$：\n$$\nL_1(-h/2) = \\frac{(-h/2)(-h/2-3h/2)}{(h/2)(-h)} = \\frac{(-h/2)(-2h)}{-h^2/2} = \\frac{h^2}{-h^2/2} = -2\n$$\n对于$L_2(x) = \\frac{(x-0)(x-h/2)}{(3h/2-0)(3h/2-h/2)}$：\n$$\nL_2(-h/2) = \\frac{(-h/2)(-h/2-h/2)}{(3h/2)(h)} = \\frac{(-h/2)(-h)}{3h^2/2} = \\frac{h^2/2}{3h^2/2} = \\frac{1}{3}\n$$\n现在，我们将这些结合起来求$T_0 = P(-h/2)$：\n$$\nT_0 = T_b L_0(-h/2) + T_1 L_1(-h/2) + T_2 L_2(-h/2) = T_b \\left(\\frac{8}{3}\\right) + T_1(-2) + T_2\\left(\\frac{1}{3}\\right)\n$$\n$$\nT_0 = \\frac{8}{3}T_b - 2T_1 + \\frac{1}{3}T_2\n$$\n整理此表达式，得到虚拟单元值的最终形式：\n$$\nT_0 = \\frac{8T_b - 6T_1 + T_2}{3}\n$$\n使用这个$T_0$值可以确保格式$\\frac{T_1 - T_0}{h}$以二阶精度近似$\\left.\\frac{dT}{dx}\\right|_{x=0}$。\n\n最终答案的两个部分是整数精度损失阶数，即$1$，以及推导出的$T_0$的表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{8T_b - 6T_1 + T_2}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管高阶格式能提供更高的精度，但线性高阶格式在处理急剧梯度时会产生非物理振荡，这是一个著名难题。这个高级练习探讨了针对这一困境的现代非线性解决方案：采用通量限制器的高分辨率MUSCL格式。该分析将揭示此类格式如何智能地适应解的特性，在平滑区域保持高阶精度，而在梯度附近则切换到更稳健的一阶行为以抑制振荡，从而让您深入了解现代激波捕捉方法的设计原理 。",
            "id": "4000070",
            "problem": "考虑由被动标量守恒律控制的一维温度平流，\n$$\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = 0,$$\n在间距为$h$的均匀网格上，平流速度为恒定值$a > 0$。位于单元中心$x_i$的单元平均值$T_i(t)$的一个保守有限体积半离散更新格式为\n$$\\frac{d T_i}{d t} + \\frac{a T_{i+1/2}^{L} - a T_{i-1/2}^{L}}{h} = 0,$$\n其中界面$x_{i+1/2}$处的左状态由一种通量限制的高分辨率守恒律单调上游中心格式（MUSCL）公式重构\n$$T_{i+1/2}^{L} = T_i + \\frac{1}{2}\\,\\varphi(r_i)\\left(T_i - T_{i-1}\\right),$$\n$$r_i = \\frac{T_i - T_{i-1}}{T_{i+1} - T_i}.$$\n假设使用 Van Leer 限制器，\n$$\\varphi(r) = \\frac{r + |r|}{1 + |r|},$$\n并且精确温度场$T(x,t)$在$x_i$的邻域内是光滑且单调递增的，因此当$h \\to 0$时有$r_i \\ge 0$和$r_i \\to 1$。在半离散的设定下进行分析，并定义空间离散算子\n$$\\mathcal{D}[T]_i = \\frac{a T_{i+1/2}^{L} - a T_{i-1/2}^{L}}{h}.$$\n使用关于$x_i$的泰勒展开，推导局部截断误差\n$$\\tau_i = \\mathcal{D}[T]_i - a \\frac{\\partial T}{\\partial x}(x_i)$$\n在光滑单调假设下，推导其当$h \\to 0$时的首个非零项。将此首项表示为\n$$\\tau_i = c\\, a\\, \\frac{\\partial^3 T}{\\partial x^3}(x_i)\\, h^2 + \\mathcal{O}(h^3),$$\n的形式，并确定常数$c$。\n\n然后，对于一个陡峭的单调梯度（此时限制器被激活以抑制伪振荡，即$\\varphi(r) \\to 0$，使得$T_{i+1/2}^{L} \\to T_i$且格式降为一阶迎风格式），分析其主阶截断误差，并从基本原理出发解释，为什么在陡峭梯度附近，格式的形式精度阶会降低，但格式仍保持相容性。\n\n报告常数$c$作为你的最终答案。无需进行数值计算，也无需为最终答案提供单位。",
            "solution": "该问题陈述是守恒律数值分析中一个适定且标准的练习，具体涉及守恒律的单调上游中心格式（MUSCL）的性质。所有给出的方程、定义和假设在计算流体动力学领域都是标准的，并且内部一致。该问题具有科学依据，是客观且完整的。因此，该问题被认为是有效的，并将提供解答。\n\n任务是推导一个半离散有限体积格式的局部截断误差。该格式由下式给出\n$$\n\\frac{d T_i}{d t} + \\mathcal{D}[T]_i = 0,\n$$\n其中 $\\mathcal{D}[T]_i$ 是平流项 $a \\frac{\\partial T}{\\partial x}$ 的空间离散。截断误差定义为\n$$\n\\tau_i = \\mathcal{D}[T]_i - a \\frac{\\partial T}{\\partial x}\\bigg|_{x_i}.\n$$\n空间算子为\n$$\n\\mathcal{D}[T]_i = \\frac{a T_{i+1/2}^{L} - a T_{i-1/2}^{L}}{h},\n$$\n其中 $T_{i+1/2}^{L}$ 是单元 $i$ 东侧界面的重构状态，而 $T_{i-1/2}^{L}$ 是西侧界面的重构状态。重构公式由下式给出\n$$\nT_{j+1/2}^{L} = T_j + \\frac{1}{2}\\,\\varphi(r_j)\\left(T_j - T_{j-1}\\right)\n$$\n斜率比为 $r_j = \\frac{T_j - T_{j-1}}{T_{j+1} - T_j}$。Van Leer 限制器为 $\\varphi(r) = \\frac{r + |r|}{1 + |r|}$。\n\n分析方法是将精确光滑解 $T(x,t)$ 代入离散算子，并在固定时间 $t$ 对点 $x_i$ 进行泰勒级数展开。我们将使用记号 $T^{(n)}$ 来表示 $\\frac{\\partial^n T}{\\partial x^n}(x_i)$。\n\n**第一部分：光滑区域的截断误差**\n\n在这一部分，我们假设解是光滑且单调递增的，这意味着当 $h \\to 0$ 时，$r_i \\ge 0$ 且 $r_i \\to 1$。对于 $r \\ge 0$，Van Leer 限制器简化为\n$$\n\\varphi(r) = \\frac{r+r}{1+r} = \\frac{2r}{1+r}.\n$$\n我们需要找到当 $h \\to 0$ 时 $\\varphi(r_i)$ 的渐进行为。首先，我们在 $x_i$ 附近展开 $r_i$ 中的各项：\n$$\nT_{i\\pm1} = T(x_i \\pm h) = T_i \\pm h T^{(1)} + \\frac{h^2}{2} T^{(2)} \\pm \\frac{h^3}{6} T^{(3)} + \\frac{h^4}{24} T^{(4)} \\pm \\frac{h^5}{120} T^{(5)} + \\mathcal{O}(h^6).\n$$\n差值为：\n$$\nT_i - T_{i-1} = h T^{(1)} - \\frac{h^2}{2} T^{(2)} + \\frac{h^3}{6} T^{(3)} - \\frac{h^4}{24} T^{(4)} + \\mathcal{O}(h^5).\n$$\n$$\nT_{i+1} - T_i = h T^{(1)} + \\frac{h^2}{2} T^{(2)} + \\frac{h^3}{6} T^{(3)} + \\frac{h^4}{24} T^{(4)} + \\mathcal{O}(h^5).\n$$\n则斜率比 $r_i$ 为\n$$\nr_i = \\frac{T_i - T_{i-1}}{T_{i+1} - T_i} = \\frac{h T^{(1)} - \\frac{h^2}{2} T^{(2)} + \\frac{h^3}{6} T^{(3)} - \\dots}{h T^{(1)} + \\frac{h^2}{2} T^{(2)} + \\frac{h^3}{6} T^{(3)} + \\dots} = \\frac{1 - \\frac{h}{2}\\frac{T^{(2)}}{T^{(1)}} + \\frac{h^2}{6}\\frac{T^{(3)}}{T^{(1)}} - \\dots}{1 + \\frac{h}{2}\\frac{T^{(2)}}{T^{(1)}} + \\frac{h^2}{6}\\frac{T^{(3)}}{T^{(1)}} + \\dots}.\n$$\n使用几何级数展开 $(1+z)^{-1} = 1 - z + z^2 - \\dots$，我们得到\n$$\nr_i = \\left(1 - \\frac{h}{2}\\frac{T^{(2)}}{T^{(1)}} + \\dots \\right) \\left(1 - \\frac{h}{2}\\frac{T^{(2)}}{T^{(1)}} + \\dots \\right) = 1 - h\\frac{T^{(2)}}{T^{(1)}} + \\mathcal{O}(h^2).\n$$\n这证实了当 $h \\to 0$ 时 $r_i \\to 1$。为了找到二阶误差项，我们需要对 $r_i$ 以及随后的 $\\varphi(r_i)$ 进行更精确的展开。\n设 $r_i = 1+\\delta$。我们在 $r=1$ 附近展开 $\\varphi(r)$：\n$$\n\\varphi'(r) = \\frac{2}{(1+r)^2} \\implies \\varphi'(1) = \\frac{1}{2}.\n$$\n$$\n\\varphi''(r) = \\frac{-4}{(1+r)^3} \\implies \\varphi''(1) = -\\frac{1}{2}.\n$$\n$\\varphi(r_i)$ 的展开式为 $\\varphi(r_i) = \\varphi(1) + (r_i-1)\\varphi'(1) + \\frac{(r_i-1)^2}{2}\\varphi''(1) + \\mathcal{O}((r_i-1)^3)$。\n$$\n\\varphi(r_i) = 1 + \\frac{1}{2}(r_i-1) - \\frac{1}{4}(r_i-1)^2 + \\mathcal{O}(h^3).\n$$\n为了继续，我们需要 $r_i-1$ 的展开式直到 $h^2$ 阶：\n$$\nr_i-1 = -h\\frac{T^{(2)}}{T^{(1)}} + h^2 \\left[ \\left(\\frac{T^{(2)}}{T^{(1)}}\\right)^2 - \\frac{1}{3}\\frac{T^{(3)}}{T^{(1)}} \\right] + \\mathcal{O}(h^3).\n$$\n将此代入 $\\varphi(r_i)$ 的展开式中：\n$$\n\\varphi(r_i) = 1 + \\frac{1}{2}\\left(-h\\frac{T^{(2)}}{T^{(1)}} + h^2 \\left[ \\dots \\right] \\right) - \\frac{1}{4}\\left(-h\\frac{T^{(2)}}{T^{(1)}}\\right)^2 + \\mathcal{O}(h^3)\n$$\n$$\n\\varphi(r_i) = 1 - \\frac{h}{2}\\frac{T^{(2)}}{T^{(1)}} + \\frac{h^2}{2}\\left[ \\left(\\frac{T^{(2)}}{T^{(1)}}\\right)^2 - \\frac{1}{3}\\frac{T^{(3)}}{T^{(1)}} \\right] - \\frac{h^2}{4}\\left(\\frac{T^{(2)}}{T^{(1)}}\\right)^2 + \\mathcal{O}(h^3)\n$$\n$$\n\\varphi(r_i) = 1 - \\frac{h}{2}\\frac{T^{(2)}}{T^{(1)}} + h^2\\left[ \\frac{1}{4}\\left(\\frac{T^{(2)}}{T^{(1)}}\\right)^2 - \\frac{1}{6}\\frac{T^{(3)}}{T^{(1)}} \\right] + \\mathcal{O}(h^3).\n$$\n现在我们组装重构状态 $T_{i+1/2}^L = T_i + \\frac{1}{2}\\varphi(r_i)(T_i - T_{i-1})$。\n让我们定义一个函数 $F(x; h)$ 来表示重构：\n$T_{i+1/2}^L = F(x_i; h)$。\n那么 $T_{i-1/2}^L$ 由相同的公式给出，但应用于单元 $i-1$。\n$T_{i-1/2}^L = F(x_{i-1}; h)$。\n我们需要 $F(x;h)$ 的展开式。\n$F(x;h) = T(x) + \\frac{1}{2}\\varphi(r(x))(T(x)-T(x-h))$。\n$\\frac{1}{2}\\varphi(r(x))(T(x)-T(x-h)) = \\frac{1}{2} [1 - \\frac{h}{2}\\frac{T''}{T'} + \\dots][hT' - \\frac{h^2}{2}T'' + \\frac{h^3}{6}T''' + \\dots]$\n$= \\frac{1}{2} [hT' - h^2 T'' + \\frac{h^3}{2}\\frac{(T'')^2}{T'} + \\mathcal{O}(h^4)]$.\n$F(x;h) = T(x) + \\frac{h}{2}T' - \\frac{h^2}{2}T'' + \\frac{h^3}{4}\\frac{(T'')^2}{T'} + \\mathcal{O}(h^4)$.\n我们在 $x_i$ 附近展开 $F(x_{i-1}; h)$：\n$F(x_{i-1}; h) = F(x_i; h) - h \\frac{\\partial F}{\\partial x}(x_i; h) + \\frac{h^2}{2} \\frac{\\partial^2 F}{\\partial x^2}(x_i; h) - \\frac{h^3}{6} \\frac{\\partial^3 F}{\\partial x^3}(x_i; h) + \\mathcal{O}(h^4)$。\n$F(x;h) = T(x) + \\frac{h}{2}T'(x) - \\frac{h^2}{2}T''(x) + \\mathcal{O}(h^3)$。\n$\\frac{\\partial F}{\\partial x} = T' + \\frac{h}{2}T'' - \\frac{h^2}{2}T''' + \\mathcal{O}(h^3)$。\n$\\frac{\\partial^2 F}{\\partial x^2} = T'' + \\frac{h}{2}T''' + \\mathcal{O}(h^2)$。\n$\\frac{\\partial^3 F}{\\partial x^3} = T''' + \\mathcal{O}(h)$。\n所以，差值为 $T_{i+1/2}^L - T_{i-1/2}^L = F(x_i; h) - F(x_{i-1}; h)$：\n$= h \\frac{\\partial F}{\\partial x}\\bigg|_{x_i} - \\frac{h^2}{2} \\frac{\\partial^2 F}{\\partial x^2}\\bigg|_{x_i} + \\frac{h^3}{6} \\frac{\\partial^3 F}{\\partial x^3}\\bigg|_{x_i} + \\mathcal{O}(h^4)$。\n$= h\\left(T^{(1)} + \\frac{h}{2}T^{(2)} - \\frac{h^2}{2}T^{(3)}\\right) - \\frac{h^2}{2}\\left(T^{(2)} + \\frac{h}{2}T^{(3)}\\right) + \\frac{h^3}{6}T^{(3)} + \\mathcal{O}(h^4)$。\n$= h T^{(1)} + \\frac{h^2}{2}T^{(2)} - \\frac{h^3}{2}T^{(3)} - \\frac{h^2}{2}T^{(2)} - \\frac{h^3}{4}T^{(3)} + \\frac{h^3}{6}T^{(3)} + \\mathcal{O}(h^4)$。\n$= h T^{(1)} + h^3 T^{(3)} \\left(-\\frac{1}{2} - \\frac{1}{4} + \\frac{1}{6}\\right) + \\mathcal{O}(h^4)$。\n$= h T^{(1)} + h^3 T^{(3)} \\left(\\frac{-6 - 3 + 2}{12}\\right) + \\mathcal{O}(h^4) = h T^{(1)} - \\frac{7}{12} h^3 T^{(3)} + \\mathcal{O}(h^4)$。\n现在我们可以计算算子 $\\mathcal{D}[T]_i$：\n$$\n\\mathcal{D}[T]_i = \\frac{a}{h} \\left( T_{i+1/2}^L - T_{i-1/2}^L \\right) = \\frac{a}{h} \\left( h T^{(1)} - \\frac{7}{12} h^3 T^{(3)} + \\mathcal{O}(h^4) \\right) = a T^{(1)} - \\frac{7}{12} a h^2 T^{(3)} + \\mathcal{O}(h^3).\n$$\n截断误差为\n$$\n\\tau_i = \\mathcal{D}[T]_i - a T^{(1)} = \\left( a T^{(1)} - \\frac{7}{12} a h^2 T^{(3)} \\right) - a T^{(1)} + \\mathcal{O}(h^3) = -\\frac{7}{12} a h^2 T^{(3)} + \\mathcal{O}(h^3).\n$$\n将此与所要求的形式 $\\tau_i = c\\, a\\, \\frac{\\partial^3 T}{\\partial x^3}(x_i)\\, h^2 + \\mathcal{O}(h^3)$ 进行比较，我们发现常数 $c$ 是\n$$\nc = -\\frac{7}{12}.\n$$\n主误差项的阶为 $h^2$，这证实了该格式在光滑区域是二阶精度的。\n\n**第二部分：陡峭单调梯度下的分析**\n\n在具有陡峭单调梯度的区域，限制器被设计为激活以防止振荡。问题指出这对应于 $\\varphi(r) \\to 0$ 的情况。对于 Van Leer 限制器，当 $r \\to 0$ 时，$\\varphi(r) = \\frac{2r}{1+r}$（对于 $r \\ge 0$）趋近于 $0$。条件 $r_i = \\frac{T_i - T_{i-1}}{T_{i+1} - T_i} \\to 0$ 意味着梯度在 $x_i$ 处急剧增加，即 $T_i - T_{i-1} \\ll T_{i+1} - T_i$。\n\n在此条件下，重构公式变为\n$$\nT_{i+1/2}^{L} = T_i + \\frac{1}{2}\\,\\varphi(r_i)\\left(T_i - T_{i-1}\\right) \\to T_i \\quad \\text{当 } \\varphi(r_i) \\to 0.\n$$\n对于西侧界面的通量 $T_{i-1/2}^L$，我们在索引 $i-1$ 处计算公式。\n$$\nT_{i-1/2}^{L} = T_{i-1} + \\frac{1}{2}\\,\\varphi(r_{i-1})\\left(T_{i-1} - T_{i-2}\\right).\n$$\n如果梯度在多个单元上都很陡峭，那么 $r_{i-1}$ 很可能也很小，导致 $\\varphi(r_{i-1}) \\to 0$。在这种情况下，$T_{i-1/2}^{L} \\to T_{i-1}$。\n于是空间算子简化为\n$$\n\\mathcal{D}[T]_i = \\frac{a T_{i} - a T_{i-1}}{h} = \\frac{a}{h}(T_i - T_{i-1}).\n$$\n这是一阶迎风格式的空间算子。为了找到其截断误差，我们在 $x_i$ 附近展开 $T_{i-1}$：\n$$\nT_{i-1} = T_i - h T^{(1)} + \\frac{h^2}{2} T^{(2)} + \\mathcal{O}(h^3).\n$$\n将此代入算子：\n$$\n\\mathcal{D}[T]_i = \\frac{a}{h} \\left( T_i - \\left(T_i - h T^{(1)} + \\frac{h^2}{2} T^{(2)} - \\dots \\right) \\right) = \\frac{a}{h} \\left( h T^{(1)} - \\frac{h^2}{2} T^{(2)} + \\dots \\right) = a T^{(1)} - \\frac{a h}{2} T^{(2)} + \\mathcal{O}(h^2).\n$$\n主阶截断误差为\n$$\n\\tau_i = \\mathcal{D}[T]_i - a T^{(1)} = - \\frac{a h}{2} \\frac{\\partial^2 T}{\\partial x^2}(x_i) + \\mathcal{O}(h^2).\n$$\n该项的阶为 $h$，因此格式的形式精度阶降为一阶。这个主误差项被称为数值扩散。\n\n**关于精度降低和相容性的解释**\n\n分析表明，带有 Van Leer 限制器的 MUSCL 格式具有一个显著特性：其精度阶不是统一的。在解的光滑区域，它是一个二阶精度格式，而在陡峭梯度附近，它局部地退化为一阶精度格式。\n\n这种行为不是一个缺陷，而是一个关键的设计特性。Godunov 定理证明，任何精度阶高于一阶的线性平流数值格式都不能保证单调的初始数据保持单调性（即，它会在急剧变化的特征附近产生伪振荡）。像 MUSCL 这样的高分辨率格式通过非线性来规避这一限制。这种非线性是由通量限制器函数 $\\varphi(r_i)$ 引入的，它使得格式的系数依赖于解本身。\n\n限制器的作用是感知陡峭梯度（其中 $r_i$ 显著偏离 1），并在这些区域减少提供高精度的“抗扩散”通量项，从而有效地增加数值扩散。这种受控的扩散增加抑制了高阶线性格式可能产生的振荡，确保了稳定且物理上合理的解。其代价是形式精度阶从二阶局部降低到一阶。\n\n尽管精度有这种局部降低，但该格式仍然是**相容的**。如果一个格式的截断误差 $\\tau_i$ 随着网格间距 $h \\to 0$ 而趋于零，则该格式是相容的。在光滑情况下，$\\tau_i = \\mathcal{O}(h^2)$，它趋于零。在陡峭梯度情况下，$\\tau_i = \\mathcal{O}(h)$，它也趋于零。由于在整个区域内，当网格加密到极限时截断误差消失，因此离散方程收敛于原始的偏微分方程。收敛的*速率*只是在某些区域比其他区域慢。这种自适应的非线性机制是现代激波捕捉方法的基础，这些方法旨在光滑区域保持高精度，同时在间断处保持稳健和无振荡。",
            "answer": "$$\n\\boxed{-\\frac{7}{12}}\n$$"
        }
    ]
}