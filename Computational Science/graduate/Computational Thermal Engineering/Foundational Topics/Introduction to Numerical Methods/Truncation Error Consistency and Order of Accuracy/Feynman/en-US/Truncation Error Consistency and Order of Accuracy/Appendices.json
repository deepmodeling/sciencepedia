{
    "hands_on_practices": [
        {
            "introduction": "To begin our practical study, we will analyze the simplest intuitive scheme for solving advection problems: the first-order upwind method. This fundamental exercise demonstrates how to perform a Taylor series analysis to derive the local truncation error, a core skill in numerical analysis. By constructing the modified equation, you will discover how the discretization introduces an error term that acts like physical diffusion, a phenomenon known as \"numerical diffusion\" that you must learn to identify and control .",
            "id": "4000118",
            "problem": "In computational thermal engineering, the convective transport of a passive thermal scalar can be modeled by the linear advection partial differential equation (PDE) in one dimension ($1$-$D$):\n$$\nu_t + a\\,u_x = 0,\n$$\nwhere $u(x,t)$ is the transported scalar (e.g., temperature fluctuation), $a>0$ is a constant advection speed, $x$ is the spatial coordinate, and $t$ is time. Consider a uniform grid $x_i = i\\,\\Delta x$ with constant spacing $\\Delta x>0$, and the first-order upwind finite-difference approximation for the spatial derivative $u_x$ at grid point $x_i$ given by\n$$\n\\left(u_x\\right)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}, \\quad \\text{for } a>0,\n$$\nwhere $u_i \\equiv u(x_i,t)$.\n\nYour tasks are:\n- Starting from the definition of the local truncation error and a Taylor series expansion about $x_i$, derive the truncation error of the discrete approximation for the advection term $a\\,u_x$ at $x_i$ and determine its order of accuracy with respect to $\\Delta x$.\n- Using the same expansion, construct the modified equation for the semi-discrete scheme $u_t + a\\,\\left(u_i - u_{i-1}\\right)/\\Delta x = 0$ by expressing it as a continuous PDE that $u(x,t)$ approximately satisfies, retaining terms up to and including those proportional to $\\Delta x^2$.\n- Identify and explain the artificial diffusion term that appears in the modified equation and extract its diffusion coefficient.\n\nExpress your final answer as a single symbolic expression for the artificial diffusion coefficient in terms of $a$ and $\\Delta x$. Do not include units and do not round; provide the expression in exact analytic form.",
            "solution": "The problem requires the analysis of a first-order upwind finite-difference scheme for the $1$-$D$ linear advection equation. The analysis will proceed in three steps: first, the derivation of the local truncation error and order of accuracy; second, the construction of the modified partial differential equation (PDE); and third, the identification of the artificial diffusion term and its coefficient.\n\nThe governing PDE is the linear advection equation:\n$$\nu_t + a u_x = 0\n$$\nwhere $u(x,t)$ is the transported scalar, $a > 0$ is the constant advection speed, $x$ is the spatial coordinate, and $t$ is time. The spatial domain is discretized on a uniform grid $x_i = i \\Delta x$ with spacing $\\Delta x > 0$. The partial derivative with respect to space, $u_x$, is approximated at grid point $x_i$ using the first-order upwind (backward-difference) scheme:\n$$\n(u_x)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\nwhere $u_i \\equiv u(x_i, t)$.\n\n**Part 1: Truncation Error and Order of Accuracy**\n\nThe local truncation error, $\\tau_i$, of the spatial discretization is the residual obtained when the exact solution $u(x,t)$ is substituted into the finite-difference formula. It is defined as the difference between the discrete operator and the continuous operator acting on the exact solution.\n\nLet the continuous differential operator be $L(u) = a u_x$.\nLet the discrete difference operator be $L_{\\Delta x}(u_i) = a \\frac{u_i - u_{i-1}}{\\Delta x}$.\n\nThe truncation error is then:\n$$\n\\tau_i = L_{\\Delta x}(u_i) - (L u)_i = a \\frac{u_i - u_{i-1}}{\\Delta x} - a (u_x)_i\n$$\nTo analyze $\\tau_i$, we perform a Taylor series expansion of the function $u(x, t)$ at the point $x_{i-1} = x_i - \\Delta x$ around the point $x_i$. Assuming sufficient smoothness of the solution $u(x,t)$, we have:\n$$\nu_{i-1} = u(x_i - \\Delta x, t) = u(x_i, t) - \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_i + \\frac{(\\Delta x)^2}{2!} \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i - \\frac{(\\Delta x)^3}{3!} \\left(\\frac{\\partial^3 u}{\\partial x^3}\\right)_i + \\mathcal{O}((\\Delta x)^4)\n$$\nUsing the subscript notation for spatial derivatives, i.e., $(u_x)_i = (\\partial u/\\partial x)_i$, $(u_{xx})_i = (\\partial^2 u/\\partial x^2)_i$, etc., the expansion becomes:\n$$\nu_{i-1} = u_i - \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i - \\frac{(\\Delta x)^3}{6} (u_{xxx})_i + \\mathcal{O}((\\Delta x)^4)\n$$\nSubstituting this expansion into the expression for the truncation error:\n$$\n\\tau_i = a \\frac{u_i - \\left(u_i - \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i - \\frac{(\\Delta x)^3}{6} (u_{xxx})_i + \\mathcal{O}((\\Delta x)^4)\\right)}{\\Delta x} - a (u_x)_i\n$$\nSimplifying the terms in the numerator:\n$$\n\\tau_i = a \\frac{\\Delta x (u_x)_i - \\frac{(\\Delta x)^2}{2} (u_{xx})_i + \\frac{(\\Delta x)^3}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^4)}{\\Delta x} - a (u_x)_i\n$$\nDividing by $\\Delta x$:\n$$\n\\tau_i = a \\left( (u_x)_i - \\frac{\\Delta x}{2} (u_{xx})_i + \\frac{(\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3) \\right) - a (u_x)_i\n$$\nThe term $a (u_x)_i$ cancels out, leaving the expression for the truncation error:\n$$\n\\tau_i = - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3)\n$$\nThe order of accuracy is determined by the lowest power of $\\Delta x$ in the leading term of the truncation error. In this case, the leading term is $- \\frac{a \\Delta x}{2} (u_{xx})_i$, which is proportional to $(\\Delta x)^1$. Therefore, the spatial discretization is first-order accurate with respect to $\\Delta x$.\n\n**Part 2: Modified Equation**\n\nThe modified equation is the PDE that is actually solved by the numerical scheme, including its error terms. We start with the semi-discrete scheme, where the spatial derivative is replaced by its finite-difference approximation:\n$$\n(u_t)_i + a \\frac{u_i - u_{i-1}}{\\Delta x} = 0\n$$\nWe have already found the Taylor series expansion for the discrete spatial term:\n$$\na \\frac{u_i - u_{i-1}}{\\Delta x} = a (u_x)_i - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3)\n$$\nSubstituting this into the semi-discrete equation gives:\n$$\n(u_t)_i + a (u_x)_i - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3) = 0\n$$\nWe can express this relationship for the continuous function $u(x,t)$ by dropping the subscript $i$. This equation represents the PDE that the numerical solution approximately satisfies. Rearranging it to match the structure of the original PDE plus error terms yields the modified equation:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}((\\Delta x)^3)\n$$\nThe problem asks for terms up to and including those proportional to $(\\Delta x)^2$. Thus, the modified equation is:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx}\n$$\n\n**Part 3: Artificial Diffusion Term and Coefficient**\n\nThe modified equation shows how the numerical scheme deviates from the original PDE. The terms on the right-hand side are error terms introduced by the discretization. The original equation, $u_t + a u_x = 0$, describes pure advection without any diffusion.\n\nThe leading error term in the modified equation is $\\frac{a \\Delta x}{2} u_{xx}$. This term has the form of a diffusion term, $D u_{xx}$, which is characteristic of the heat equation or diffusion equation. Since this term is an artifact of the numerical method and not part of the original physical model, it is called the \"artificial diffusion\" or \"numerical diffusion\" term.\n\nThis term is dissipative, meaning it tends to damp or smooth out sharp gradients in the solution, which is a known characteristic of the first-order upwind scheme. The positive sign of the coefficient (since $a > 0$ and $\\Delta x > 0$) confirms that it acts as a forward diffusion process, ensuring numerical stability at the cost of accuracy.\n\nBy comparing the leading error term to the general form of a diffusion term, $D_{art} u_{xx}$, we can extract the artificial diffusion coefficient, $D_{art}$.\n$$\nD_{art} u_{xx} = \\frac{a \\Delta x}{2} u_{xx}\n$$\nTherefore, the artificial diffusion coefficient is:\n$$\nD_{art} = \\frac{a \\Delta x}{2}\n$$\nThis coefficient quantifies the amount of non-physical diffusion introduced by the scheme. It is directly proportional to both the advection speed $a$ and the grid spacing $\\Delta x$.",
            "answer": "$$\\boxed{\\frac{a \\Delta x}{2}}$$"
        },
        {
            "introduction": "Moving beyond first-order methods, this practice explores the classic second-order Lax-Wendroff scheme. The exercise has two crucial parts: a theoretical derivation of the truncation error and a computational verification of the scheme's accuracy. This combination is central to modern computational engineering, as it teaches you not only how to analyze a scheme on paper but also how to implement the \"Method of Manufactured Solutions\" to compute the observed order of accuracy, a vital step in verifying that your code is working as designed .",
            "id": "3817399",
            "problem": "Consider the one-dimensional advection of a passive scalar concentration field in a periodic oceanic channel. The governing equation is the linear advection equation $c_t + U c_x = 0$, where $c(x,t)$ is the scalar concentration, $U$ is the constant advection speed, and subscripts denote partial derivatives with respect to time $t$ and space $x$. Angles must be treated in radians. Assume a nondimensional domain of length $L$ with periodic boundary conditions, and use a nondimensional formulation in which all quantities are dimensionless.\n\nAn exact traveling-wave solution is $c(x,t) = \\sin(k x - \\omega t)$ with $\\omega = U k$, where $k$ is the spatial wavenumber and $\\omega$ is the angular frequency. This solution is strictly periodic in both $x$ and $t$, and it satisfies the advection equation under the stated relation $\\omega = U k$.\n\nWe consider the following explicit, two-step spatial-temporal discretization of the advection equation on a uniform grid with grid spacing $\\Delta x$ and time step $\\Delta t$, known as the Lax–Wendroff (LW) scheme (defined here for constant $U$ and positive $U$):\n$$\nc_i^{n+1} = c_i^n - \\frac{\\lambda}{2} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{\\lambda^2}{2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right),\n$$\nwhere $c_i^n$ denotes the numerical approximation at grid point $x_i$ and time $t^n$, and $\\lambda = \\frac{U \\Delta t}{\\Delta x}$ is the Courant–Friedrichs–Lewy (CFL) number. Indices $i+1$ and $i-1$ are interpreted modulo the number of grid points to enforce periodic boundary conditions.\n\nTask 1 (Derivation): Starting from the linear advection equation $c_t + U c_x = 0$ and the LW discretization above, derive the local truncation error $\\tau(x,t;\\Delta x,\\Delta t)$ of the LW scheme by substituting the exact solution $c(x,t)$ into the LW update, performing Taylor expansions in both space and time about $(x,t)$, and using the governing equation to eliminate time derivatives in favor of spatial derivatives. Your derivation must express $\\tau$ as a leading-order asymptotic series in terms of $\\Delta x$ and $\\Delta t$, demonstrating the scheme’s consistency and identifying the order of accuracy.\n\nTask 2 (Observed Order from Discrete Residuals): Define the discrete residual at grid point $x_i$ and time level $t^n$ when the exact solution is used as\n$$\nR_i^n = c(x_i,t^{n+1}) - \\left[ c(x_i,t^n) - \\frac{\\lambda}{2}\\left(c(x_{i+1},t^n) - c(x_{i-1},t^n)\\right) + \\frac{\\lambda^2}{2}\\left(c(x_{i+1},t^n) - 2c(x_i,t^n) + c(x_{i-1},t^n)\\right) \\right].\n$$\nThe local truncation error at $(x_i,t^n)$ is then $\\tau_i^n = \\frac{R_i^n}{\\Delta t}$. Use the discrete $\\ell^2$ norm\n$$\n\\|\\tau\\|_2 = \\left( \\Delta x \\sum_{i} (\\tau_i^n)^2 \\right)^{1/2}\n$$\nto measure the magnitude of the local truncation error across the spatial grid at a fixed time $t^n$. For each test case, compute $\\|\\tau\\|_2$ on a sequence of refined grids, and estimate the observed order $p$ using the two finest grid spacings $\\Delta x_{\\text{fine}}$ and $\\Delta x_{\\text{finer}}$:\n$$\np \\approx \\frac{\\log\\left(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}}\\right)}{\\log\\left(\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}}\\right)}.\n$$\n\nImplementation Requirements:\n- Use the exact solution $c(x,t) = \\sin(k x - \\omega t)$ with $\\omega = U k$.\n- Use a uniform grid with $x_i = i \\Delta x$ for $i = 0,1,\\dots,N_x-1$ and periodic boundary conditions. Set $t^n = 0$ for computing $R_i^n$ and $\\tau_i^n$, and define $t^{n+1} = t^n + \\Delta t$.\n- For each grid, set $\\Delta t$ by a fixed CFL number $\\lambda = \\frac{U \\Delta t}{\\Delta x}$ supplied in the test case to balance spatial and temporal contributions to truncation error.\n- Angles are in radians. All quantities are nondimensional.\n\nTest Suite:\nFor each test case, the parameters are $(U,k,L,\\lambda,\\{N_x\\})$ with $L$ the domain length, $\\lambda$ the CFL number, and $\\{N_x\\}$ the set of grid resolutions for estimating the order. Use the following three test cases:\n1. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 2\\pi, 1, 0.4, \\{50, 100, 200\\})$.\n2. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 10\\pi, 1, 0.4, \\{100, 200, 400\\})$.\n3. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 4\\pi, 1, 0.9, \\{60, 120, 240\\})$.\n\nAnswer Specification:\n- Your program must compute the observed order $p$ for each test case using the two finest grids in $\\{N_x\\}$, and round each $p$ to six decimal places.\n- Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, for example, $[p_1,p_2,p_3]$.",
            "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded problem in the field of computational science, specifically concerning the numerical analysis of partial differential equations. All parameters, equations, and procedures are clearly defined, allowing for a unique and verifiable solution. We shall proceed with the two tasks outlined.\n\n### Task 1: Derivation of the Local Truncation Error\n\nThe first task is to derive the local truncation error, $\\tau$, for the Lax-Wendroff (LW) scheme applied to the linear advection equation, $c_t + U c_x = 0$. The local truncation error is found by substituting the exact solution, $c(x,t)$, into the finite difference scheme and quantifying the residual.\n\nThe LW scheme is given as:\n$$\nc_i^{n+1} = c_i^n - \\frac{\\lambda}{2} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{\\lambda^2}{2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\nwhere $\\lambda = \\frac{U \\Delta t}{\\Delta x}$. To find the truncation error, we rearrange the scheme to represent the differential operator it approximates, $L = \\partial_t + U \\partial_x$.\n\nFirst, we divide by $\\Delta t$:\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = - \\frac{U \\Delta t}{2 \\Delta x \\Delta t} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{U^2 (\\Delta t)^2}{2 (\\Delta x)^2 \\Delta t} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = - \\frac{U}{2 \\Delta x} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{U^2 \\Delta t}{2 (\\Delta x)^2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\nThe truncation error $\\tau(x,t)$ is defined as the residual when the exact solution $c(x,t)$ is substituted into the numerical operator. We evaluate all terms at the point $(x,t)$, which corresponds to $(x_i, t^n)$.\n$$\n\\tau(x,t) = \\frac{c(x, t+\\Delta t) - c(x, t)}{\\Delta t} + U \\frac{c(x+\\Delta x, t) - c(x-\\Delta x, t)}{2 \\Delta x} - \\frac{U^2 \\Delta t}{2} \\frac{c(x+\\Delta x, t) - 2c(x, t) + c(x-\\Delta x, t)}{(\\Delta x)^2}\n$$\nWe now perform Taylor series expansions for each term around the point $(x,t)$. For clarity, we use the subscript notation for partial derivatives (e.g., $c_t = \\frac{\\partial c}{\\partial t}$, $c_{xx} = \\frac{\\partial^2 c}{\\partial x^2}$).\n\nTerm 1 (Forward difference in time):\n$$\n\\frac{c(x, t+\\Delta t) - c(x, t)}{\\Delta t} = \\frac{1}{\\Delta t} \\left[ \\left(c + \\Delta t c_t + \\frac{(\\Delta t)^2}{2} c_{tt} + \\frac{(\\Delta t)^3}{6} c_{ttt} + \\dots \\right) - c \\right] = c_t + \\frac{\\Delta t}{2} c_{tt} + \\frac{(\\Delta t)^2}{6} c_{ttt} + O((\\Delta t)^3)\n$$\nTerm 2 (Centered difference in space for $c_x$):\n$$\nU \\frac{c(x+\\Delta x, t) - c(x-\\Delta x, t)}{2 \\Delta x} = \\frac{U}{2 \\Delta x} \\left[ \\left(c + \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} + \\frac{(\\Delta x)^3}{6} c_{xxx} + \\dots \\right) - \\left(c - \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} - \\frac{(\\Delta x)^3}{6} c_{xxx} + \\dots \\right) \\right]\n$$\n$$\n= \\frac{U}{2 \\Delta x} \\left[ 2 \\Delta x c_x + \\frac{(\\Delta x)^3}{3} c_{xxx} + O((\\Delta x)^5) \\right] = U c_x + \\frac{U (\\Delta x)^2}{6} c_{xxx} + O((\\Delta x)^4)\n$$\nTerm 3 (Centered difference in space for $c_{xx}$):\n$$\n- \\frac{U^2 \\Delta t}{2} \\frac{c(x+\\Delta x, t) - 2c(x, t) + c(x-\\Delta x, t)}{(\\Delta x)^2} = - \\frac{U^2 \\Delta t}{2} \\left[ c_{xx} + \\frac{(\\Delta x)^2}{12} c_{xxxx} + O((\\Delta x)^4) \\right] = - \\frac{U^2 \\Delta t}{2} c_{xx} - \\frac{U^2 \\Delta t (\\Delta x)^2}{24} c_{xxxx} + O(\\Delta t(\\Delta x)^4)\n$$\nCombining these expansions into the expression for $\\tau(x,t)$:\n$$\n\\tau(x,t) = \\left( c_t + \\frac{\\Delta t}{2} c_{tt} + \\frac{(\\Delta t)^2}{6} c_{ttt} \\right) + \\left( U c_x + \\frac{U (\\Delta x)^2}{6} c_{xxx} \\right) - \\left( \\frac{U^2 \\Delta t}{2} c_{xx} \\right) + \\text{H.O.T.}\n$$\nWe group terms by their derivatives:\n$$\n\\tau(x,t) = (c_t + U c_x) + \\frac{\\Delta t}{2} (c_{tt} - U^2 c_{xx}) + \\frac{(\\Delta t)^2}{6} c_{ttt} + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\nThe exact solution satisfies the governing equation $c_t + U c_x = 0$. This implies the scheme is *consistent*, as the leading term of $\\tau$ is not zeroth-order. Furthermore, we can use the governing equation to express higher-order time derivatives in terms of spatial derivatives:\n$c_{t} = -U c_{x}$\n$c_{tt} = \\partial_t(-U c_x) = -U c_{xt} = -U \\partial_x(c_t) = -U \\partial_x(-U c_x) = U^2 c_{xx}$\n$c_{ttt} = \\partial_t(U^2 c_{xx}) = U^2 c_{xxt} = U^2 \\partial_{xx}(-U c_x) = -U^3 c_{xxx}$\n\nSubstituting these back into the expression for $\\tau(x,t)$:\n1. The term $(c_t + U c_x)$ is $0$.\n2. The term $\\frac{\\Delta t}{2} (c_{tt} - U^2 c_{xx}) = \\frac{\\Delta t}{2} (U^2 c_{xx} - U^2 c_{xx})$ is also $0$. This cancellation is the hallmark of the Lax-Wendroff construction, elevating the scheme's accuracy.\n\nThe remaining leading-order terms are:\n$$\n\\tau(x,t) = \\frac{(\\Delta t)^2}{6} c_{ttt} + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\nSubstituting $c_{ttt} = -U^3 c_{xxx}$:\n$$\n\\tau(x,t) = \\frac{(\\Delta t)^2}{6} (-U^3 c_{xxx}) + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\n$$\n\\tau(x,t) = \\frac{U c_{xxx}}{6} \\left( (\\Delta x)^2 - U^2 (\\Delta t)^2 \\right) + \\text{H.O.T.}\n$$\nUsing the CFL number definition $\\lambda = \\frac{U \\Delta t}{\\Delta x}$, we can write $\\Delta t = \\frac{\\lambda \\Delta x}{U}$. The expression becomes:\n$$\n\\tau(x,t) = \\frac{U c_{xxx}}{6} \\left( (\\Delta x)^2 - U^2 \\frac{\\lambda^2 (\\Delta x)^2}{U^2} \\right) + \\text{H.O.T.} = \\frac{U (\\Delta x)^2}{6} (1 - \\lambda^2) c_{xxx} + \\text{H.O.T.}\n$$\nThe primary error term also involves $(\\Delta t)^2$, so we can write $\\tau(x,t) = O((\\Delta x)^2, (\\Delta t)^2)$. Since the numerical experiment fixes $\\lambda$, $\\Delta t$ is directly proportional to $\\Delta x$. The overall order of accuracy is therefore second-order, and we expect the observed order $p$ to be $2$.\n\n### Task 2: Observed Order of Accuracy\n\nThe second task is to numerically verify the order of accuracy. This involves computing the truncation error on a sequence of grids and using the results to estimate the order of convergence $p$. The methodology is as follows:\n1.  For each test case $(U, k, L, \\lambda, \\{N_x\\})$, we iterate through the provided grid resolutions $N_x$.\n2.  For a given $N_x$, we define the grid parameters: grid spacing $\\Delta x = L / N_x$ and time step $\\Delta t = \\lambda \\Delta x / U$.\n3.  We define the spatial grid $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N_x-1$.\n4.  We evaluate the exact solution at time $t^n=0$ and $t^{n+1}=\\Delta t$:\n    $c(x_i, t^n) = \\sin(k x_i)$\n    $c(x_i, t^{n+1}) = \\sin(k x_i - \\omega \\Delta t)$, where $\\omega = U k$.\n5.  We compute the numerical solution at $t^{n+1}$, denoted $c_i^{n+1, \\text{num}}$, by applying the LW operator to the exact solution at $t^n$:\n    $c_i^{n+1, \\text{num}} = c(x_i,t^n) - \\frac{\\lambda}{2}(c(x_{i+1},t^n) - c(x_{i-1},t^n)) + \\frac{\\lambda^2}{2}(c(x_{i+1},t^n) - 2c(x_i,t^n) + c(x_{i-1},t^n))$\n6.  The discrete residual is calculated as $R_i^n = c(x_i,t^{n+1}) - c_i^{n+1, \\text{num}}$.\n7.  The local truncation error at each grid point is $\\tau_i^n = R_i^n / \\Delta t$.\n8.  The magnitude of the error field is measured using the discrete $\\ell^2$ norm: $\\|\\tau\\|_2 = \\sqrt{\\Delta x \\sum_{i=0}^{N_x-1} (\\tau_i^n)^2}$.\n9.  After computing $\\|\\tau\\|_2$ for the two finest grids (corresponding to grid spacings $\\Delta x_{\\text{fine}}$ and $\\Delta x_{\\text{finer}}$), the observed order $p$ is calculated using the formula:\n    $$\n    p \\approx \\frac{\\log\\left(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}}\\right)}{\\log\\left(\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}}\\right)}\n    $$\nSince the resolutions in each test case are chosen such that $\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}} = 2$, this simplifies to $p \\approx \\log_2(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}})$. Based on the theoretical derivation, the expected result is $p \\approx 2$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by computing the observed order of accuracy for the\n    Lax-Wendroff scheme for three test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (U, k, L, lambda, {N_x})\n        (1, 2 * np.pi, 1, 0.4, [50, 100, 200]),\n        (1, 10 * np.pi, 1, 0.4, [100, 200, 400]),\n        (1, 4 * np.pi, 1, 0.9, [60, 120, 240]),\n    ]\n\n    results = []\n    for case in test_cases:\n        U, k, L, lamb, Nx_list = case\n        \n        norms = []\n        dx_list = []\n\n        for Nx in Nx_list:\n            # 1. Set up grid parameters\n            dx = L / Nx\n            dt = lamb * dx / U\n            omega = U * k\n            \n            # Store dx for order calculation\n            dx_list.append(dx)\n            \n            # 2. Define spatial grid\n            x = np.arange(Nx) * dx\n            \n            # 3. Evaluate exact solution at t=0 and t=dt\n            # c(x, t=0)\n            c_n = np.sin(k * x)\n            # c(x, t=dt)\n            c_exact_np1 = np.sin(k * x - omega * dt)\n\n            # 4. Apply LW operator to exact solution at t=0\n            # Get neighbor values using periodic boundary conditions with np.roll\n            c_ip1 = np.roll(c_n, -1)\n            c_im1 = np.roll(c_n, 1)\n\n            # Compute numerical solution at t=dt, c_num_np1\n            term_central_diff = - (lamb / 2) * (c_ip1 - c_im1)\n            term_diffusion = (lamb**2 / 2) * (c_ip1 - 2 * c_n + c_im1)\n            c_num_np1 = c_n + term_central_diff + term_diffusion\n\n            # 5. Compute residual and truncation error\n            # R_i^n = c(x_i, t^{n+1}) - c_i^{n+1, num}\n            R_vec = c_exact_np1 - c_num_np1\n            # tau_i^n = R_i^n / dt\n            tau_vec = R_vec / dt\n\n            # 6. Compute the l2 norm of the truncation error\n            # ||tau||_2 = (dx * sum(tau_i^2))^(1/2)\n            norm_tau = np.sqrt(dx * np.sum(tau_vec**2))\n            norms.append(norm_tau)\n            \n        # 7. Compute observed order of accuracy p\n        # Use the two finest grids\n        norm_fine = norms[-2]\n        norm_finer = norms[-1]\n        \n        dx_fine = dx_list[-2]\n        dx_finer = dx_list[-1]\n        \n        # p = log(norm_ratio) / log(dx_ratio)\n        p = np.log(norm_fine / norm_finer) / np.log(dx_fine / dx_finer)\n        \n        # Round to six decimal places as specified\n        results.append(round(p, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "A high-order scheme is only as accurate as its weakest point, which is often the implementation of boundary conditions. This exercise tackles this critical, practical issue by showing how a naive boundary treatment can reduce the overall accuracy of a simulation from second-order to first-order. You will learn to diagnose this \"order loss\" and then derive a higher-order boundary condition using the ghost-cell method, a widely used technique to maintain global accuracy in complex simulations .",
            "id": "4000115",
            "problem": "Consider one-dimensional steady heat conduction in a homogeneous rod occupying the domain $x \\in [0,L]$ with constant thermal conductivity $k$. Let the temperature field be $T(x)$, assumed sufficiently smooth, and let Fourier’s law of heat conduction state that the heat flux is $q(x) = -k \\,\\frac{dT}{dx}(x)$. The left boundary at $x=0$ is held at a fixed temperature $T(0)=T_{b}$ (Dirichlet condition). Discretize the domain using a uniform finite-volume mesh with $N$ control volumes of width $h = L/N$, cell centers at $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$ for $i=1,2,\\dots,N$, and the left boundary face at $x=\\tfrac{1}{2}(x_{0}+x_{1})=0$, where $x_{0}=-\\tfrac{h}{2}$ is the location of a ghost cell center introduced to enable use of interior stencils at the boundary. The interior second-order central difference approximation for the face-normal temperature gradient between adjacent cell centers is\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=(x_{i}+x_{i+1})/2} \\approx \\frac{T_{i+1}-T_{i}}{h}.\n$$\nAt the left boundary face, suppose one enforces the Dirichlet boundary without any special boundary correction by approximating the face-normal gradient using the naive one-sided face-to-center formula\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=0} \\approx \\frac{T_{1} - T_{b}}{h/2}.\n$$\nUsing Taylor series expansions about $x=0$ and the definitions of truncation error and consistency, determine the local order of accuracy of this naive boundary approximation for the face-normal gradient and compare it with the interior second-order accuracy. Then, propose and derive a boundary correction that restores second-order accuracy at the left boundary while permitting use of the interior central difference stencil $\\left(T_{1}-T_{0}\\right)/h$ by choosing an appropriate ghost-cell value $T_{0}$ expressed as a linear combination of $T_{b}$, $T_{1}$, and $T_{2}$.\n\nYour tasks are:\n- Derive the truncation error of the naive boundary approximation $\\left(T_{1}-T_{b}\\right)/(h/2)$ for $\\left.dT/dx\\right|_{x=0}$ and state its order in $h$.\n- Determine the resulting order loss at the boundary relative to the interior second-order approximation.\n- Derive a second-order accurate boundary correction by choosing $T_{0}$ so that the interior central difference stencil $(T_{1}-T_{0})/h$ approximates $\\left.dT/dx\\right|_{x=0}$ with second-order accuracy, and provide the explicit expression for $T_{0}$ in terms of $T_{b}$, $T_{1}$, and $T_{2}$.\n\nExpress your final answer as a row matrix containing:\n1) the integer order loss at the boundary, and\n2) the corrected ghost-cell value $T_{0}$ expressed symbolically in terms of $T_{b}$, $T_{1}$, and $T_{2}$.\n\nNo numerical evaluation is required; provide exact symbolic expressions. There are no physical units to report in the final answer.",
            "solution": "The problem asks for three items: the order of accuracy of a naive boundary approximation for a temperature gradient, the resulting order loss compared to an interior scheme, and the derivation of a ghost-cell value $T_{0}$ that restores second-order accuracy at the boundary. We will address each task sequentially using Taylor series analysis.\n\nThe domain is discretized with cell centers at $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$. Thus, the first cell center is at $x_{1} = h/2$ and the second is at $x_{2} = 3h/2$. The Dirichlet boundary is at $x=0$, where $T(0) = T_{b}$. We assume the temperature field $T(x)$ is sufficiently smooth to permit Taylor series expansions.\n\nFirst, we analyze the truncation error of the naive boundary approximation for the gradient, $\\left.\\frac{dT}{dx}\\right|_{x=0}$. The approximation is given by:\n$$\nD_{\\text{naive}} = \\frac{T_{1} - T_{b}}{h/2}\n$$\nwhere $T_{1}$ is the temperature at the first cell center, $T(x_1) = T(h/2)$, and $T_b$ is the boundary temperature, $T(0)$. To find the truncation error, we expand $T(h/2)$ in a Taylor series about $x=0$:\n$$\nT_{1} = T(h/2) = T(0) + \\left.\\frac{dT}{dx}\\right|_{x=0} \\left(\\frac{h}{2}\\right) + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{(h/2)^2}{2!} + \\left.\\frac{d^3T}{dx^3}\\right|_{x=0} \\frac{(h/2)^3}{3!} + \\dots\n$$\nSubstituting $T(0) = T_{b}$ and simplifying:\n$$\nT_{1} = T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3)\n$$\nNow, substitute this expansion into the formula for $D_{\\text{naive}}$:\n$$\nD_{\\text{naive}} = \\frac{1}{h/2} \\left[ \\left( T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right) - T_{b} \\right]\n$$\n$$\nD_{\\text{naive}} = \\frac{2}{h} \\left[ \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right]\n$$\n$$\nD_{\\text{naive}} = \\left.\\frac{dT}{dx}\\right|_{x=0} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h}{4} + O(h^2)\n$$\nThe truncation error, $\\tau_{\\text{naive}}$, is the difference between the approximation and the exact value:\n$$\n\\tau_{\\text{naive}} = D_{\\text{naive}} - \\left.\\frac{dT}{dx}\\right|_{x=0} = \\frac{h}{4} \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} + O(h^2)\n$$\nThe leading term in the error is proportional to $h^1$, so the naive boundary approximation is first-order accurate, i.e., its order of accuracy is $p_{\\text{naive}} = 1$.\n\nThe problem states that the interior approximation is second-order accurate ($p_{\\text{int}} = 2$). The order loss at the boundary is the difference between the interior order and the boundary order:\n$$\n\\text{Order Loss} = p_{\\text{int}} - p_{\\text{naive}} = 2 - 1 = 1\n$$\nThis completes the first two tasks.\n\nFor the third task, we need to find a value for the ghost-cell temperature, $T_0$, such that the central difference stencil $\\frac{T_1 - T_0}{h}$ provides a second-order accurate approximation for the gradient at the boundary, $\\left.\\frac{dT}{dx}\\right|_{x=0}$. The stencil is a central difference because it uses points $x_1 = h/2$ and the ghost-cell center $x_0 = -h/2$, and is centered at their midpoint, $x=0$.\nThe truncation error of this central difference scheme is known to be second-order:\n$$\n\\frac{T(h/2) - T(-h/2)}{h} = \\left.\\frac{dT}{dx}\\right|_{x=0} + O(h^2)\n$$\nTo achieve this accuracy, we must define $T_0$ as a second-order accurate approximation of $T(-h/2)$. We can construct such an approximation by extrapolation from the known values $T_b = T(0)$, $T_1 = T(h/2)$, and $T_2 = T(3h/2)$. We can fit a quadratic polynomial $P(x)$ through these three points and evaluate it at $x=-h/2$.\nLet the interpolating polynomial be $P(x) = ax^2 + bx + c$. The value of $T_0$ is then $P(-h/2)$.\nA direct way to find $P(-h/2)$ is using Lagrange's interpolation formula. The three points are $(0, T_b)$, $(h/2, T_1)$, and $(3h/2, T_2)$. We want to find the value of the interpolating polynomial at $x = -h/2$.\n$$\nP(x) = T_b L_0(x) + T_1 L_1(x) + T_2 L_2(x)\n$$\nwhere $L_i(x)$ are the Lagrange basis polynomials. We need to evaluate them at $x=-h/2$.\nFor $L_0(x) = \\frac{(x-h/2)(x-3h/2)}{(0-h/2)(0-3h/2)}$:\n$$\nL_0(-h/2) = \\frac{(-h/2-h/2)(-h/2-3h/2)}{(0-h/2)(0-3h/2)} = \\frac{(-h)(-2h)}{3h^2/4} = \\frac{2h^2}{3h^2/4} = \\frac{8}{3}\n$$\nFor $L_1(x) = \\frac{(x-0)(x-3h/2)}{(h/2-0)(h/2-3h/2)}$:\n$$\nL_1(-h/2) = \\frac{(-h/2)(-h/2-3h/2)}{(h/2)(-h)} = \\frac{(-h/2)(-2h)}{-h^2/2} = \\frac{h^2}{-h^2/2} = -2\n$$\nFor $L_2(x) = \\frac{(x-0)(x-h/2)}{(3h/2-0)(3h/2-h/2)}$:\n$$\nL_2(-h/2) = \\frac{(-h/2)(-h/2-h/2)}{(3h/2)(h)} = \\frac{(-h/2)(-h)}{3h^2/2} = \\frac{h^2/2}{3h^2/2} = \\frac{1}{3}\n$$\nNow, we combine these to find $T_0 = P(-h/2)$:\n$$\nT_0 = T_b L_0(-h/2) + T_1 L_1(-h/2) + T_2 L_2(-h/2) = T_b \\left(\\frac{8}{3}\\right) + T_1(-2) + T_2\\left(\\frac{1}{3}\\right)\n$$\n$$\nT_0 = \\frac{8}{3}T_b - 2T_1 + \\frac{1}{3}T_2\n$$\nRearranging this expression gives the final form for the ghost-cell value:\n$$\nT_0 = \\frac{8T_b - 6T_1 + T_2}{3}\n$$\nUsing this value for $T_0$ ensures that the stencil $\\frac{T_1 - T_0}{h}$ approximates $\\left.\\frac{dT}{dx}\\right|_{x=0}$ with second-order accuracy.\n\nThe two parts of the final answer are the integer order loss, which is $1$, and the derived expression for $T_0$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & \\frac{8T_b - 6T_1 + T_2}{3} \\end{pmatrix}}\n$$"
        }
    ]
}