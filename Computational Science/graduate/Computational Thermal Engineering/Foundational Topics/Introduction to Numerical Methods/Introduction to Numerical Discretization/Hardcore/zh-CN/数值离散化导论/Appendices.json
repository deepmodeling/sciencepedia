{
    "hands_on_practices": [
        {
            "introduction": "理论知识的最终目的是应用于实践。本节的第一个实践将指导您从最基本的物理定律出发，为一个复杂的一维热传导问题开发并实现一个数值求解方案。该练习强调在非均匀网格和异质材料属性这些更贴近现实的条件下，如何运用有限体积法进行离散化，并推导出显式时间积分格式的稳定性约束，即最大允许时间步长。通过完成这项实践，您不仅能掌握数值实现的核心技能，还能深刻理解数值稳定性这一在计算中至关重要的概念。",
            "id": "3964328",
            "problem": "考虑一种具有分段常数热物性的非均匀介质中的一维瞬态热传导。控制方程源于能量守恒和傅里叶热传导定律。从物理定律出发，本构关系是傅里叶定律，$q_x = -k \\, \\partial T/\\partial x$。控制体中的能量守恒定律指出，内能的变化率等于流入控制体的净传导热通量。这两者共同推出了瞬态热方程 $ \\rho c \\, \\partial T / \\partial t = \\partial / \\partial x \\left( k(x) \\, \\partial T / \\partial x \\right) $，其中 $T$ 是温度，$k$ 是热导率，$\\rho$ 是密度，$c$ 是比热容。\n\n在一个包含 $N$ 个宽度为 $\\Delta x_i$ 的控制体的非均匀、以单元为中心的网格上，为该方程实现一个一维有限体积法 (FVM) 的显式时间积分格式（前向欧拉法）。在内部界面处，使用通过半单元热阻串联相加推导出的谐波平均界面热导率。界面间距 $\\delta_{i+1/2}$ 是相邻单元宽度之和的一半。对于边界面，施加固定温度（狄利克雷）边界或零通量（诺伊曼）边界；对于狄利克雷边界，将边界面建模为从单元中心到边界的半单元传导路径；对于诺伊曼边界，在边界面上施加零通量。\n\n您的任务是：\n\n- 推导并实现对 $T_i^{n+1}$ 的显式前向欧拉 FVM 更新。其中，通量在内部界面处使用谐波平均界面热导率计算，并对边界面进行适当处理。\n- 从离散算子中，为每个单元确定局部最严格时间步长（为保证显式更新的单调稳定性和非负性所允许的最大局部时间步长），并返回这些局部值的最小值作为全局最严格时间步长。所需单位为秒。\n\n从第一性原理（能量守恒和傅里叶定律）以及在非均匀网格上 FVM 通量的定义开始；不要在没有推导的情况下使用简便公式。\n\n使用以下测试套件。每个测试案例指定了以米为单位的非均匀网格单元宽度 $\\Delta x_i$、以瓦特/米-开尔文为单位的热导率 $k_i$、以千克/立方米为单位的密度 $\\rho_i$、以焦耳/千克-开尔文为单位的比热 $c_i$，以及左右两端的边界类型。假设单位横截面积 $A = 1\\,\\mathrm{m}^2$。边界类型为狄利克雷（固定温度 $T_b$，该值已指定但不影响稳定性极限）或诺伊曼（零通量）。在所有情况下，最终答案都以秒为单位表示。\n\n测试套件：\n\n- 案例 $1$（一般非均匀，两端均为狄利克雷边界）：\n  - $\\Delta x = [\\,0.008,\\,0.012,\\,0.010,\\,0.015,\\,0.005\\,]$\n  - $k = [\\,15,\\,22,\\,18,\\,40,\\,10\\,]$\n  - $\\rho = [\\,7800,\\,7800,\\,7800,\\,7800,\\,7800\\,]$\n  - $c = [\\,500,\\,500,\\,500,\\,500,\\,500\\,]$\n  - 左边界：狄利克雷边界，$T_b = 300\\,\\mathrm{K}$，右边界：狄利克雷边界，$T_b = 300\\,\\mathrm{K}$。\n\n- 案例 $2$（包含一个非常小的单元，两端均为狄利克雷边界）：\n  - $\\Delta x = [\\,0.0005,\\,0.002,\\,0.0015,\\,0.0025,\\,0.002\\,]$\n  - $k = [\\,30,\\,30,\\,30,\\,30,\\,30\\,]$\n  - $\\rho = [\\,7900,\\,7900,\\,7900,\\,7900,\\,7900\\,]$\n  - $c = [\\,460,\\,460,\\,460,\\,460,\\,460\\,]$\n  - 左边界：狄利克雷边界，$T_b = 350\\,\\mathrm{K}$，右边界：狄利克雷边界，$T_b = 350\\,\\mathrm{K}$。\n\n- 案例 $3$（混合边界条件，诺伊曼-狄利克雷）：\n  - $\\Delta x = [\\,0.01,\\,0.02,\\,0.015,\\,0.025\\,]$\n  - $k = [\\,12,\\,20,\\,14,\\,16\\,]$\n  - $\\rho = [\\,8500,\\,8500,\\,8500,\\,8500\\,]$\n  - $c = [\\,500,\\,500,\\,500,\\,500\\,]$\n  - 左边界：诺伊曼零通量，右边界：狄利克雷边界，$T_b = 300\\,\\mathrm{K}$。\n\n- 案例 $4$（小单元附近存在强热导率对比，两端均为狄利克雷边界）：\n  - $\\Delta x = [\\,0.006,\\,0.004,\\,0.007,\\,0.005\\,]$\n  - $k = [\\,20,\\,400,\\,15,\\,25\\,]$\n  - $\\rho = [\\,7800,\\,7800,\\,7800,\\,7800\\,]$\n  - $c = [\\,500,\\,500,\\,500,\\,500\\,]$\n  - 左边界：狄利克雷边界，$T_b = 320\\,\\mathrm{K}$，右边界：狄利克雷边界，$T_b = 320\\,\\mathrm{K}$。\n\n- 案例 $5$（可变的 $\\rho$ 和 $c$，两端均为狄利克雷边界）：\n  - $\\Delta x = [\\,0.009,\\,0.011,\\,0.008\\,]$\n  - $k = [\\,18,\\,22,\\,19\\,]$\n  - $\\rho = [\\,3000,\\,8000,\\,6000\\,]$\n  - $c = [\\,800,\\,500,\\,700\\,]$\n  - 左边界：狄利克雷边界，$T_b = 300\\,\\mathrm{K}$，右边界：狄利克雷边界，$T_b = 300\\,\\mathrm{K}$。\n\n您的程序应生成一行输出，其中包含每个测试用例的全局最严格时间步长，格式为方括号括起来的逗号分隔列表，每个浮点数四舍五入到 $10$ 位有效数字，单位为秒。例如，输出行的格式为 $[t_1,t_2,t_3,t_4,t_5]$，其中每个 $t_i$ 是一个代表秒的浮点数。",
            "solution": "该问题要求推导并实现一维瞬态热传导问题有限体积法 (FVM) 显式格式的稳定性判据。推导必须从第一性原理出发：能量守恒和傅里叶热传导定律。\n\n在物性随空间变化的介质中，一维瞬态热传导的控制偏微分方程为：\n$$\n\\rho(x) c(x) \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x} \\left( k(x) \\frac{\\partial T}{\\partial x} \\right)\n$$\n其中 $T$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\rho$ 是密度，$c$ 是比热容，$k$ 是热导率。\n\n我们考虑一个具有 $N$ 个控制体 (CVs) 的以单元为中心的有限体积离散化。对于一个中心位于 $x_i$、宽度为 $\\Delta x_i$ 且具有均匀物性 $\\rho_i, c_i, k_i$ 的通用控制体 $CV_i$，能量守恒定律的积分形式为：\n$$\n\\frac{d}{dt} \\int_{CV_i} \\rho_i c_i T \\, dV = Q_{i-1/2} - Q_{i+1/2}\n$$\n其中 $dV = A \\, dx$，横截面积 $A=1 \\, \\text{m}^2$。$Q_{i-1/2}$ 和 $Q_{i+1/2}$ 分别是通过 $CV_i$ 的左界面和右界面传入的热量传输速率。假设温度 $T_i$ 代表单元上的平均温度，方程变为：\n$$\n\\rho_i c_i (A \\Delta x_i) \\frac{dT_i}{dt} = Q_{i-1/2} - Q_{i+1/2}\n$$\n由于 $A=1$，我们有：\n$$\n(\\rho_i c_i \\Delta x_i) \\frac{dT_i}{dt} = q_{i-1/2} - q_{i+1/2}\n$$\n其中 $q = Q/A$ 是单位面积热通量。\n\n我们使用显式前向欧拉格式对时间导数进行离散，其中右侧的通量在当前时间层 $n$ 进行计算：\n$$\n(\\rho_i c_i \\Delta x_i) \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = q_{i-1/2}^n - q_{i+1/2}^n\n$$\n对新时间层的温度 $T_i^{n+1}$ 进行整理：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\rho_i c_i \\Delta x_i} (q_{i-1/2}^n - q_{i+1/2}^n)\n$$\n\n热通量是基于傅里叶定律，使用热阻网络类比来定义的。两点之间的通量是温度差除以热阻。一块材料的热阻为 $R_{th} = L / (k A)$，其中 $L$ 是厚度。由于 $A=1$，$R_{th} = L/k$。热阻的倒数是热导，$K = 1/R_{th}$。\n\n对于位于单元 $i$ 和单元 $i+1$ 之间位置 $x_{i+1/2}$ 处的内部界面，通量由单元中心温度 $T_i^n$ 和 $T_{i+1}^n$ 之间的温差驱动。总热阻是两个半单元热阻的串联之和：\n$$\nR_{i+1/2} = R_{i \\to i+1/2} + R_{i+1/2 \\to i+1} = \\frac{\\Delta x_i/2}{k_i} + \\frac{\\Delta x_{i+1}/2}{k_{i+1}}\n$$\n对应的热导为 $K_{i+1/2} = 1/R_{i+1/2}$。那么热通量为：\n$$\nq_{i+1/2}^n = K_{i+1/2} (T_i^n - T_{i+1}^n) = \\frac{T_i^n - T_{i+1}^n}{\\frac{\\Delta x_i}{2k_i} + \\frac{\\Delta x_{i+1}}{2k_{i+1}}}\n$$\n根据对称性，单元 $i$ 左界面的通量为 $q_{i-1/2}^n = K_{i-1/2} (T_{i-1}^n - T_i^n)$。\n\n将这些通量表达式代入内部单元（$0  i  N-1$）的离散化能量方程，得到：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\rho_i c_i \\Delta x_i} [K_{i-1/2}(T_{i-1}^n - T_i^n) - K_{i+1/2}(T_i^n - T_{i+1}^n)]\n$$\n按时间层 $n$ 的温度项进行分组：\n$$\nT_i^{n+1} = \\frac{\\Delta t K_{i-1/2}}{\\rho_i c_i \\Delta x_i} T_{i-1}^n + \\left(1 - \\frac{\\Delta t (K_{i-1/2} + K_{i+1/2})}{\\rho_i c_i \\Delta x_i}\\right) T_i^n + \\frac{\\Delta t K_{i+1/2}}{\\rho_i c_i \\Delta x_i} T_{i+1}^n\n$$\n\n为使格式数值稳定并保证物理解（非负性），右侧温度 $T^n$ 的系数必须为非负。$T_{i-1}^n$ 和 $T_{i+1}^n$ 的系数是内在地非负的。因此，稳定性约束来自于 $T_i^n$ 的系数：\n$$\n1 - \\frac{\\Delta t (K_{i-1/2} + K_{i+1/2})}{\\rho_i c_i \\Delta x_i} \\ge 0\n$$\n求解 $\\Delta t$ 得到内部单元 $i$ 的局部稳定性限制的时间步长：\n$$\n\\Delta t \\le \\frac{\\rho_i c_i \\Delta x_i}{K_{i-1/2} + K_{i+1/2}} \\equiv \\Delta t_{i, \\text{max}}\n$$\n\n现在我们必须考虑边界单元。设单元索引从 $i=0$ 到 $i=N-1$。\n\n对于第一个单元（$i=0$）：\n更新方程为 $T_0^{n+1} = T_0^n + \\frac{\\Delta t}{\\rho_0 c_0 \\Delta x_0} (q_{-1/2}^n - q_{1/2}^n)$，其中 $q_{-1/2}^n$ 是边界通量，并且 $q_{1/2}^n=K_{1/2}(T_0^n-T_1^n)$。\n- 如果左边界是狄利克雷边界（固定温度 $T_{b,L}$），通量通过半单元热阻 $R_{-1/2} = (\\Delta x_0/2)/k_0$ 建模。热导为 $K_{-1/2} = 2k_0/\\Delta x_0$。通量为 $q_{-1/2}^n = K_{-1/2}(T_{b,L} - T_0^n)$。更新方程中 $T_0^n$ 的系数变为 $1 - \\frac{\\Delta t (K_{-1/2} + K_{1/2})}{\\rho_0 c_0 \\Delta x_0}$。稳定性极限为 $\\Delta t_{0, \\text{max}} = \\frac{\\rho_0 c_0 \\Delta x_0}{K_{-1/2} + K_{1/2}}$。\n- 如果左边界是诺伊曼边界（零通量），则 $q_{-1/2}^n = 0$。$T_0^n$ 的系数变为 $1 - \\frac{\\Delta t K_{1/2}}{\\rho_0 c_0 \\Delta x_0}$。稳定性极限为 $\\Delta t_{0, \\text{max}} = \\frac{\\rho_0 c_0 \\Delta x_0}{K_{1/2}}$。这等效于设置边界热导 $K_{-1/2}=0$。\n\n对于最后一个单元（$i=N-1$）：\n更新方程为 $T_{N-1}^{n+1} = T_{N-1}^n + \\frac{\\Delta t}{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}} (q_{N-3/2}^n - q_{N-1/2}^n)$，其中 $q_{N-3/2}^n = K_{N-3/2}(T_{N-2}^n-T_{N-1}^n)$，$q_{N-1/2}^n$ 是边界通量。\n- 如果右边界是狄利克雷边界（固定温度 $T_{b,R}$），通量热阻为 $R_{N-1/2} = (\\Delta x_{N-1}/2)/k_{N-1}$。热导为 $K_{N-1/2} = 2k_{N-1}/\\Delta x_{N-1}$。通量为 $q_{N-1/2}^n = K_{N-1/2}(T_{N-1}^n - T_{b,R})$。$T_{N-1}^n$ 的系数为 $1 - \\frac{\\Delta t (K_{N-3/2} + K_{N-1/2})}{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}$。稳定性极限为 $\\Delta t_{N-1, \\text{max}} = \\frac{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}{K_{N-3/2} + K_{N-1/2}}$。\n- 如果右边界是诺伊曼边界（零通量），则 $q_{N-1/2}^n = 0$。$T_{N-1}^n$ 的系数为 $1 - \\frac{\\Delta t K_{N-3/2}}{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}$。稳定性极限为 $\\Delta t_{N-1, \\text{max}} = \\frac{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}{K_{N-3/2}}$。这等效于设置边界热导 $K_{N-1/2}=0$。\n\n总而言之，对于任何单元 $i$，局部最严格时间步长由下式给出：\n$$\n\\Delta t_{i, \\text{max}} = \\frac{\\rho_i c_i \\Delta x_i}{K_{left, i} + K_{right, i}}\n$$\n其中 $K_{left, i}$ 和 $K_{right, i}$ 分别是单元 $i$ 左右界面的热导。\n- 对于单元 i-1 和 i 之间的内部界面：$K_{left, i} = \\frac{1}{\\frac{\\Delta x_{i-1}}{2k_{i-1}} + \\frac{\\Delta x_i}{2k_i}}$。\n- 对于单元 i 和 i+1 之间的内部界面：$K_{right, i} = \\frac{1}{\\frac{\\Delta x_i}{2k_i} + \\frac{\\Delta x_{i+1}}{2k_{i+1}}}$。\n- 对于单元 0 左侧的狄利克雷边界：$K_{left, 0} = \\frac{2k_0}{\\Delta x_0}$。\n- 对于单元 0 左侧的诺伊曼边界：$K_{left, 0} = 0$。\n- 对于单元 N-1 右侧的狄利克雷边界：$K_{right, N-1} = \\frac{2k_{N-1}}{\\Delta x_{N-1}}$。\n- 对于单元 N-1 右侧的诺伊曼边界：$K_{right, N-1} = 0$。\n\n整个系统的全局最严格时间步长是所有局部时间步长极限的最小值，因为系统必须对每个单元同时保持稳定：\n$$\n\\Delta t_{\\text{global}} = \\min_{i=0, \\dots, N-1} (\\Delta t_{i, \\text{max}})\n$$\n该值给出了能保证显式前向欧拉格式稳定的最大可能时间步长 $\\Delta t$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the most restrictive time step for a series of 1D transient heat\n    conduction problems discretized using the Finite Volume Method.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"dx\": np.array([0.008, 0.012, 0.010, 0.015, 0.005]),\n            \"k\": np.array([15, 22, 18, 40, 10]),\n            \"rho\": np.array([7800, 7800, 7800, 7800, 7800]),\n            \"c\": np.array([500, 500, 500, 500, 500]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.0005, 0.002, 0.0015, 0.0025, 0.002]),\n            \"k\": np.array([30, 30, 30, 30, 30]),\n            \"rho\": np.array([7900, 7900, 7900, 7900, 7900]),\n            \"c\": np.array([460, 460, 460, 460, 460]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.01, 0.02, 0.015, 0.025]),\n            \"k\": np.array([12, 20, 14, 16]),\n            \"rho\": np.array([8500, 8500, 8500, 8500]),\n            \"c\": np.array([500, 500, 500, 500]),\n            \"bc_left\": \"Neumann\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.006, 0.004, 0.007, 0.005]),\n            \"k\": np.array([20, 400, 15, 25]),\n            \"rho\": np.array([7800, 7800, 7800, 7800]),\n            \"c\": np.array([500, 500, 500, 500]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.009, 0.011, 0.008]),\n            \"k\": np.array([18, 22, 19]),\n            \"rho\": np.array([3000, 8000, 6000]),\n            \"c\": np.array([800, 500, 700]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        dt_global = calculate_dt_max(case)\n        results.append(dt_global)\n\n    # Format output to 10 significant digits per problem specification\n    formatted_results = [f\"{r:.9e}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_dt_max(case_data):\n    \"\"\"\n    Calculates the global most restrictive time step for a single case.\n    \n    The stability limit for each cell i is given by:\n    dt_i = (rho_i * c_i * dx_i) / (K_left + K_right)\n    where K_left and K_right are the thermal conductances at the cell faces.\n    The global limit is the minimum of all dt_i.\n    \"\"\"\n    dx = case_data[\"dx\"]\n    k = case_data[\"k\"]\n    rho = case_data[\"rho\"]\n    c = case_data[\"c\"]\n    bc_left_type = case_data[\"bc_left\"]\n    bc_right_type = case_data[\"bc_right\"]\n    \n    N = len(dx)\n    local_dt_max = np.zeros(N)\n\n    for i in range(N):\n        # Thermal capacitance of cell i (per unit area)\n        cell_capacitance = rho[i] * c[i] * dx[i]\n        \n        # Conductance on the left face of cell i\n        if i == 0:\n            if bc_left_type == \"Dirichlet\":\n                # Half-cell resistance from boundary to cell center\n                K_left = 2.0 * k[0] / dx[0]\n            else:  # Neumann zero-flux\n                K_left = 0.0\n        else:\n            # Interior face: harmonic mean conductivity based on series resistance\n            R_left = (dx[i-1] / (2.0 * k[i-1])) + (dx[i] / (2.0 * k[i]))\n            K_left = 1.0 / R_left\n            \n        # Conductance on the right face of cell i\n        if i == N - 1:\n            if bc_right_type == \"Dirichlet\":\n                # Half-cell resistance from cell center to boundary\n                K_right = 2.0 * k[N-1] / dx[N-1]\n            else:  # Neumann zero-flux\n                K_right = 0.0\n        else:\n            # Interior face: harmonic mean conductivity based on series resistance\n            R_right = (dx[i] / (2.0 * k[i])) + (dx[i+1] / (2.0 * k[i+1]))\n            K_right = 1.0 / R_right\n            \n        total_conductance = K_left + K_right\n        \n        # Stability limit requires TotalConductance to be non-zero\n        if total_conductance  0:\n            local_dt_max[i] = cell_capacitance / total_conductance\n        else:\n            # Occurs for N=1 with Neumann B.C. on both sides; dt is infinite\n            local_dt_max[i] = np.inf\n\n    return np.min(local_dt_max)\n\nsolve()\n```"
        },
        {
            "introduction": "在建立了离散方程组后，一个核心问题是如何判断一个给定的温度场是否是该方程组的解。这个问题的答案引出了“残差”的概念，它量化了在每个控制体积内，离散后的守恒定律被满足的程度。本练习将要求您为一个二维稳态热传导问题，计算一个候选温度场在特定控制体积上产生的离散残差。这项计算实践能够让您具体地把握残差的物理意义——它代表了局部能量守恒的失衡量，这对于理解迭代求解器的工作原理和进行误差分析至关重要。",
            "id": "3964391",
            "problem": "在一个均匀、各向同性的固体中，二维稳态热传导过程遵循能量守恒定律，在没有平流的情况下，可以写成偏微分方程 (PDE) $\\nabla \\cdot \\left(k \\nabla T\\right) + \\dot{q} = 0$，其中 $T(x,y)$ 是温度，$k$ 是热导率，$\\dot{q}(x,y)$ 是单位体积热生成率。考虑一个方形区域 $[0,L] \\times [0,L]$，其中 $L = 0.2\\,\\mathrm{m}$，该区域通过间距为 $\\Delta x = \\Delta y = h = 0.05\\,\\mathrm{m}$ 的均匀笛卡尔网格进行离散。重点关注以 $(x_i,y_j) = (0.1\\,\\mathrm{m}, 0.1\\,\\mathrm{m})$ 为中心的内部控制体积，其对应索引为 $(i,j) = (2,2)$。\n\n假设热导率为常数，$k = 30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$。给定一个候选温度场如下：\n$$\nT(x,y) = 300 + 10 x^{2} + 5 y^{2} - 8 x y \\quad \\text{(单位 K)}.\n$$\n单位体积热生成率由下式给出：\n$$\n\\dot{q}(x,y) = 5 \\times 10^{5} + 1 \\times 10^{5}\\,x - 2 \\times 10^{5}\\,y \\quad \\text{(单位 W\\,m$^{-3}$)}.\n$$\n使用与有限体积法 (FVM) 一致的二阶中心差分离散格式，在该均匀网格上，从控制体积的积分能量平衡方程推导出候选温度场在以 $(x_i,y_j)$ 为中心的单元处产生的单位体积离散残差 $R_{ij}$，然后计算其在 $(i,j) = (2,2)$ 处的数值。将残差解释为局部守恒误差密度的度量：正值表示控制体积内的净非平衡产生，负值表示净非平衡移除。\n\n将最终数值答案四舍五入至四位有效数字，并以 $\\mathrm{W\\,m^{-3}}$ 为单位表示。",
            "solution": "对于具有恒定热导率 $k$ 和单位体积热生成率 $\\dot{q}$ 的二维稳态热传导，其控制偏微分方程为：\n$$ k \\nabla^2 T + \\dot{q} = 0 $$\n其中 $T(x,y)$ 是温度场。在笛卡尔坐标系中，该方程展开为：\n$$ k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\dot{q}(x,y) = 0 $$\n该问题要求使用有限体积法 (FVM) 计算特定内部节点 $(i,j)$ 处的单位体积离散残差 $R_{ij}$。残差表示候选温度场不满足离散化能量守恒方程的程度。\n\n在有限体积法中，控制方程在围绕节点 $(x_i, y_j)$ 的控制体积 $V$ 上进行积分。对于单位深度的二维问题，该控制体积是一个方形区域，面积为 $A = \\Delta x \\Delta y = h^2$。\n$$ \\int_A \\left[ k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\dot{q} \\right] dA = 0 $$\n对扩散项应用散度定理，控制体积的积分方程变为穿过其表面的热通量与内部产生的总热量之间的平衡：\n$$ \\int_{\\partial A} k \\nabla T \\cdot \\mathbf{n} \\, dl + \\int_A \\dot{q} \\, dA = 0 $$\n其中 $\\partial A$ 是控制体积的边界，$\\mathbf{n}$ 是向外的单位法向量。\n\n当代入候选温度场时，此积分平衡方程左侧的值即为离散残差 $Res_{ij}$。我们使用二阶中心差分来近似控制体积各表面（东'e'、西'w'、北'n'、南's'）的通量。净热流出量近似为：\n$$ \\int_{\\partial A} k \\nabla T \\cdot \\mathbf{n} \\, dl \\approx k(T_{i+1,j} - 2T_{i,j} + T_{i-1,j}) + k(T_{i,j+1} - 2T_{i,j} + T_{i,j-1}) $$\n积分源项近似为：\n$$ \\int_A \\dot{q} \\, dA \\approx \\bar{\\dot{q}}_{ij} A = \\bar{\\dot{q}}_{ij} h^2 $$\n其中 $\\bar{\\dot{q}}_{ij}$ 是控制体积内的平均源项，对于二阶格式，取其为节点中心的值，即 $\\bar{\\dot{q}}_{ij} = \\dot{q}(x_i, y_j)$。\n控制体积的总残差是这些项的总和：\n$$ Res_{ij} = k \\left( T_{i+1,j} + T_{i-1,j} + T_{i,j+1} + T_{i,j-1} - 4T_{i,j} \\right) + \\dot{q}(x_i, y_j) h^2 $$\n问题要求的是*单位体积*的残差 $R_{ij}$，即 $Res_{ij}$ 除以控制体积的面积 $h^2$：\n$$ R_{ij} = \\frac{Res_{ij}}{h^2} = k \\left( \\frac{T_{i+1,j} - 2T_{i,j} + T_{i-1,j}}{h^2} + \\frac{T_{i,j+1} - 2T_{i,j} + T_{i,j-1}}{h^2} \\right) + \\dot{q}(x_i, y_j) $$\n该表达式代表了 $k \\nabla^2 T + \\dot{q}$ 的离散形式。\n\n现在我们计算在节点 $(i,j)=(2,2)$ 处的 $R_{ij}$ 数值，该节点中心位于 $(x_i, y_j) = (0.1\\,\\mathrm{m}, 0.1\\,\\mathrm{m})$。\n给定参数如下：\n- 热导率, $k = 30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- 网格间距, $h = 0.05\\,\\mathrm{m}$\n- 目标节点坐标：$(x_2, y_2) = (0.1, 0.1)$\n相邻节点的坐标为：\n- 西侧：$(x_1, y_2) = (x_2 - h, y_2) = (0.05, 0.1)$\n- 东侧：$(x_3, y_2) = (x_2 + h, y_2) = (0.15, 0.1)$\n- 南侧：$(x_2, y_1) = (x_2, y_2 - h) = (0.1, 0.05)$\n- 北侧：$(x_2, y_3) = (x_2, y_2 + h) = (0.1, 0.15)$\n\n候选温度场为 $T(x,y) = 300 + 10 x^{2} + 5 y^{2} - 8 x y$。我们计算每个所需节点的温度：\n- $T_{2,2} = T(0.1, 0.1) = 300 + 10(0.1)^2 + 5(0.1)^2 - 8(0.1)(0.1) = 300 + 0.1 + 0.05 - 0.08 = 300.07\\,\\mathrm{K}$\n- $T_{1,2} = T(0.05, 0.1) = 300 + 10(0.05)^2 + 5(0.1)^2 - 8(0.05)(0.1) = 300 + 0.025 + 0.05 - 0.04 = 300.035\\,\\mathrm{K}$\n- $T_{3,2} = T(0.15, 0.1) = 300 + 10(0.15)^2 + 5(0.1)^2 - 8(0.15)(0.1) = 300 + 0.225 + 0.05 - 0.12 = 300.155\\,\\mathrm{K}$\n- $T_{2,1} = T(0.1, 0.05) = 300 + 10(0.1)^2 + 5(0.05)^2 - 8(0.1)(0.05) = 300 + 0.1 + 0.0125 - 0.04 = 300.0725\\,\\mathrm{K}$\n- $T_{2,3} = T(0.1, 0.15) = 300 + 10(0.1)^2 + 5(0.15)^2 - 8(0.1)(0.15) = 300 + 0.1 + 0.1125 - 0.12 = 300.0925\\,\\mathrm{K}$\n\n现在，我们计算离散拉普拉斯算子的两个项：\n$$ \\frac{T_{3,2} - 2T_{2,2} + T_{1,2}}{h^2} = \\frac{300.155 - 2(300.07) + 300.035}{(0.05)^2} = \\frac{0.05}{0.0025} = 20\\,\\mathrm{K\\,m^{-2}} $$\n$$ \\frac{T_{2,3} - 2T_{2,2} + T_{2,1}}{h^2} = \\frac{300.0925 - 2(300.07) + 300.0725}{(0.05)^2} = \\frac{0.025}{0.0025} = 10\\,\\mathrm{K\\,m^{-2}} $$\n总离散拉普拉斯算子为 $20 + 10 = 30\\,\\mathrm{K\\,m^{-2}}$。由于温度场是二次函数，这个二阶中心差分是精确的，其结果等于解析拉普拉斯算子 $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 20 + 10 = 30$。\n\n接下来，我们计算节点中心的热生成项：\n$$ \\dot{q}(x,y) = 5 \\times 10^{5} + 1 \\times 10^{5}\\,x - 2 \\times 10^{5}\\,y $$\n$$ \\dot{q}(0.1, 0.1) = 5 \\times 10^{5} + 1 \\times 10^{5}(0.1) - 2 \\times 10^{5}(0.1) = 5 \\times 10^{5} + 0.1 \\times 10^{5} - 0.2 \\times 10^{5} = 4.9 \\times 10^{5}\\,\\mathrm{W\\,m^{-3}} $$\n\n最后，我们组合得到单位体积的残差 $R_{2,2}$：\n$$ R_{2,2} = k \\left( 30 \\right) + \\dot{q}(0.1, 0.1) $$\n$$ R_{2,2} = (30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}) \\times (30\\,\\mathrm{K\\,m^{-2}}) + 4.9 \\times 10^{5}\\,\\mathrm{W\\,m^{-3}} $$\n$$ R_{2,2} = 900\\,\\mathrm{W\\,m^{-3}} + 490000\\,\\mathrm{W\\,m^{-3}} = 490900\\,\\mathrm{W\\,m^{-3}} $$\n残差的正号表示对于给定的候选温度场，在控制体积内存在净的局部能量源，或称“不平衡的产生”。该候选场不是稳态控制方程的解。\n\n问题要求答案四舍五入到四位有效数字。$490900 = 4.909 \\times 10^5$。这个值已经是四位有效数字。",
            "answer": "$$\\boxed{4.909 \\times 10^5}$$"
        },
        {
            "introduction": "开发和运行数值程序后，一个不可或缺的步骤是验证（Verification），即确认您的代码是否正确地求解了它所对应的数学模型。网格收敛性研究是代码验证的黄金标准。本练习为您提供了一系列在不同网格分辨率下得到的数值解误差数据，并要求您计算离散误差范数和观测到的收敛阶。通过这项数据分析实践，您将学会如何定量地评估您代码的正确性，即检验数值误差是否随着网格加密而按照理论预期的速率减小。",
            "id": "3964340",
            "problem": "考虑一个均匀板中的一维稳态热传导，其空间域为 $x \\in [0,1]$，导热系数 $k$ 为常数，并存在体积热源 $s(x)$。稳态下的能量守恒控制定律是一个边值问题 $-\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = s(x)$，其狄利克雷边界条件为 $T(0)=0$ 和 $T(1)=0$。设 $k$ 为一个正常数，并设热源使得精确解为 $T(x) = \\sin(\\pi x)$。采用二阶中心有限差分法，在网格间距为 $h$ 的均匀网格上，计算四个网格分辨率（$h_1 = \\frac{1}{16}$，$h_2 = \\frac{1}{32}$，$h_3 = \\frac{1}{64}$ 和 $h_4 = \\frac{1}{128}$）下，网格点 $\\{x_j\\}$ 处的离散解 $\\{T_j^{(i)}\\}$。对于每个网格 $i \\in \\{1,2,3,4\\}$，记录逐点误差 $e_j^{(i)} = T_j^{(i)} - T(x_j)$，并提供以下网格加密数据：\n- 对于离散 $L_2$ 误差计算，其和 $S^{(i)} = \\sum_{j} \\left(e_j^{(i)}\\right)^2$ 为：\n$$S^{(1)} = 1.6 \\times 10^{-5}, \\quad S^{(2)} = 2.0 \\times 10^{-6}, \\quad S^{(3)} = 2.5 \\times 10^{-7}, \\quad S^{(4)} = 3.125 \\times 10^{-8}。$$\n- 对于离散 $L_{\\infty}$ 误差计算，其最大值 $M^{(i)} = \\max_{j} \\left|e_j^{(i)}\\right|$ 为：\n$$M^{(1)} = 2.0 \\times 10^{-3}, \\quad M^{(2)} = 5.0 \\times 10^{-4}, \\quad M^{(3)} = 1.25 \\times 10^{-4}, \\quad M^{(4)} = 3.125 \\times 10^{-5}。$$\n\n任务：\n1. 从误差 $e(x) = T_h(x) - T(x)$ 在 $[0,1]$ 上的连续 $L_2$ 和 $L_{\\infty}$ 范数的定义出发，推导网格间距为 $h_i$ 的均匀网格上的一致离散定义 $E_2^{(i)}$ 和 $E_{\\infty}^{(i)}$，并用逐点误差 $e_j^{(i)}$、网格间距 $h_i$ 以及给定的量 $S^{(i)}$ 和 $M^{(i)}$ 表示。\n2. 使用您的离散定义，根据给定的 $S^{(i)}$ 和 $h_i$，计算 $i=1,2,3,4$ 时的 $L_2$ 误差范数 $E_2^{(i)}$。\n3. 使用 $L_2$ 范数，通过对四个网格的数据进行最小二乘法拟合模型 $\\ln\\left(E_2^{(i)}\\right) \\approx \\alpha + p \\,\\ln(h_i)$，估算观测到的收敛阶 $p$。报告最终的 $p$ 值，四舍五入到四位有效数字。$p$ 无需单位。",
            "solution": "### 解答\n\n解答分为三部分，对应问题陈述中指定的任务。\n\n**任务 1：推导离散误差范数**\n\n误差函数为 $e(x) = T_h(x) - T(x)$，其中 $T_h(x)$ 是离散解的表示，$T(x)$ 是精确解。\n\n在区域 $[0,1]$ 上，误差的连续 $L_{\\infty}$ 范数定义为：\n$$\n\\|e\\|_{\\infty} = \\max_{x \\in [0,1]} |e(x)|\n$$\n该范数的一个一致的离散模拟，对于网格 $i$ 表示为 $E_{\\infty}^{(i)}$，是所有网格点 $\\{x_j\\}$ 上逐点误差绝对值的最大值。问题直接以 $M^{(i)} = \\max_{j} |e_j^{(i)}| = \\max_{j} |T_j^{(i)} - T(x_j)|$ 的形式提供了这个量。因此，离散 $L_{\\infty}$ 误差范数为：\n$$\nE_{\\infty}^{(i)} = M^{(i)}\n$$\n\n在区域 $[0,1]$ 上，误差的连续 $L_2$ 范数定义为：\n$$\n\\|e\\|_{2} = \\left( \\int_{0}^{1} (e(x))^2 dx \\right)^{1/2}\n$$\n为了找到离散模拟，我们在间距为 $h_i$ 的均匀网格 $i$ 上使用数值积分法则来近似该积分。将区域 $[0,1]$ 划分为子区间，我们可以将积分近似为一个和。使用左矩形法则，积分近似为：\n$$\n\\int_{0}^{1} (e(x))^2 dx \\approx \\sum_{j=0}^{N_i-1} (e(x_j))^2 h_i\n$$\n其中 $N_i = 1/h_i$ 是区间的数量。由于边界上的误差为零，即 $e_0^{(i)} = e(0) = 0$ 和 $e_{N_i}^{(i)} = e(1) = 0$，求和实际上是在内部点 $j=1, \\dots, N_i-1$ 上进行的。问题定义了 $S^{(i)} = \\sum_{j} (e_j^{(i)})^2$。通常假设此和是在计算误差的内部节点上进行的。因此，我们有：\n$$\n\\int_{0}^{1} (e(x))^2 dx \\approx h_i \\sum_{j=1}^{N_i-1} (e_j^{(i)})^2 = h_i S^{(i)}\n$$\n取平方根得到离散 $L_2$ 误差范数 $E_2^{(i)}$：\n$$\nE_2^{(i)} = \\left( h_i S^{(i)} \\right)^{1/2} = \\sqrt{h_i S^{(i)}}\n$$\n\n**任务 2：计算 $L_2$ 误差范数**\n\n使用推导出的公式 $E_2^{(i)} = \\sqrt{h_i S^{(i)}}$ 和所提供的数据，我们为 4 个网格中的每一个计算范数。\n\n对于网格 $i=1$：$h_1 = \\frac{1}{16}$，$S^{(1)} = 1.6 \\times 10^{-5}$。\n$$\nE_2^{(1)} = \\sqrt{\\frac{1}{16} \\times 1.6 \\times 10^{-5}} = \\sqrt{0.1 \\times 10^{-5}} = \\sqrt{1.0 \\times 10^{-6}} = 1.0 \\times 10^{-3}\n$$\n\n对于网格 $i=2$：$h_2 = \\frac{1}{32}$，$S^{(2)} = 2.0 \\times 10^{-6}$。\n$$\nE_2^{(2)} = \\sqrt{\\frac{1}{32} \\times 2.0 \\times 10^{-6}} = \\sqrt{\\frac{1}{16} \\times 1.0 \\times 10^{-6}} = \\frac{1}{4} \\times 1.0 \\times 10^{-3} = 2.5 \\times 10^{-4}\n$$\n\n对于网格 $i=3$：$h_3 = \\frac{1}{64}$，$S^{(3)} = 2.5 \\times 10^{-7}$。\n$$\nE_2^{(3)} = \\sqrt{\\frac{1}{64} \\times 2.5 \\times 10^{-7}} = \\sqrt{\\frac{1}{64} \\times 25 \\times 10^{-8}} = \\frac{5}{8} \\times 10^{-4} = 0.625 \\times 10^{-4} = 6.25 \\times 10^{-5}\n$$\n\n对于网格 $i=4$：$h_4 = \\frac{1}{128}$，$S^{(4)} = 3.125 \\times 10^{-8}$。\n$$\nE_2^{(4)} = \\sqrt{\\frac{1}{128} \\times 3.125 \\times 10^{-8}} = \\sqrt{\\frac{1}{128} \\times \\frac{25}{8} \\times 10^{-8}} = \\sqrt{\\frac{25}{1024} \\times 10^{-8}} = \\frac{5}{32} \\times 10^{-4} = 0.15625 \\times 10^{-4} = 1.5625 \\times 10^{-5}\n$$\n\n**任务 3：估算收敛阶 $p$**\n\n误差模型为 $E_2 \\approx C h^p$，其中 $p$ 是收敛阶。取自然对数得到线性模型：\n$$\n\\ln(E_2^{(i)}) \\approx \\ln(C) + p \\ln(h_i)\n$$\n这对应于 $y_i = \\ln(E_2^{(i)})$ 对 $x_i = \\ln(h_i)$ 的线性回归，其中斜率为 $p$。\n\n我们来检验一下计算出的 $E_2^{(i)}$ 和 $h_i$ 之间的关系。网格间距 $h_i$ 逐次减半：$h_i = \\frac{1}{16} \\left(\\frac{1}{2}\\right)^{i-1}$。\n计算出的误差为：\n$E_2^{(1)} = 1.0 \\times 10^{-3}$\n$E_2^{(2)} = E_2^{(1)} / 4$\n$E_2^{(3)} = E_2^{(2)} / 4 = E_2^{(1)} / 16$\n$E_2^{(4)} = E_2^{(3)} / 4 = E_2^{(1)} / 64$\n\n这可以写成 $E_2^{(i)} = E_2^{(1)} \\left(\\frac{1}{4}\\right)^{i-1}$。\n让我们用初始值来表示 $E_2^{(i)}$ 和 $h_i$：\n$h_i = h_1 \\left(\\frac{1}{2}\\right)^{i-1}$\n$E_2^{(i)} = E_2^{(1)} \\left(\\frac{1}{4}\\right)^{i-1} = E_2^{(1)} \\left(\\left(\\frac{1}{2}\\right)^{2}\\right)^{i-1} = E_2^{(1)} \\left(\\left(\\frac{1}{2}\\right)^{i-1}\\right)^{2}$\n代入 $h_i$ 的表达式：\n$E_2^{(i)} = E_2^{(1)} \\left(\\frac{h_i}{h_1}\\right)^2 = \\frac{E_2^{(1)}}{h_1^2} h_i^2$\n\n这表明 $E_2^{(i)} = C (h_i)^2$，其中常数 $C = \\frac{E_2^{(1)}}{h_1^2} = \\frac{1.0 \\times 10^{-3}}{(1/16)^2} = 256 \\times 10^{-3} = 0.256$。\n对于给定的数据，该关系是精确的。取自然对数：\n$$\n\\ln(E_2^{(i)}) = \\ln(C (h_i)^2) = \\ln(C) + 2 \\ln(h_i)\n$$\n数据点 $(x_i, y_i) = (\\ln(h_i), \\ln(E_2^{(i)}))$ 完全位于一条斜率为 $p=2$ 的直线上。对完全线性的数据进行最小二乘回归拟合将返回直线的精确斜率。因此，估计的收敛阶恰好为 $2$。\n\n问题要求将结果四舍五入到四位有效数字。",
            "answer": "$$\n\\boxed{2.000}\n$$"
        }
    ]
}