{
    "hands_on_practices": [
        {
            "introduction": "计算分析的基础步骤是将连续的偏微分方程转化为可解的代数方程组。本练习将指导您完成这一关键过程，重点是使用稳定且常用的隐式后向欧拉法对一维热方程进行离散化。通过这个实践，您将学会如何构建线性系统矩阵，这是许多数值求解器的核心，并理解边界条件是如何融入到离散模型中的。",
            "id": "3964336",
            "problem": "一根长度为 $L$ 的一维均匀杆，其热扩散系数 $\\alpha$ 为常数，其温度场根据由能量守恒和傅里叶定律推导出的瞬态热传导偏微分方程（PDE）演化：$T_{t}=\\alpha\\,T_{xx}$。假设该杆服从狄利克雷边界条件 $T(0,t)=T_{L}$ 和 $T(L,t)=T_{R}$（其中 $T_{L}$ 和 $T_{R}$ 是给定的常数），以及初始条件 $T(x,0)=T_{0}(x)$。设空间域被一个包含边界在内的、由 $N+1$ 个节点组成的均匀网格离散化，网格间距为 $\\Delta x=L/N$；时间域使用后向（隐式）欧拉法，以均匀的时间步长 $\\Delta t$ 向前推进。\n\n从应用于微分控制体的能量守恒基本定律和傅里叶热传导定律出发，推导该偏微分方程在内部节点上的后向欧拉有限差分离散格式。将一个通用时间步 $t^{n+1}$ 得到的、用于求解内部未知温度的线性系统组装成矩阵形式 $\\mathbf{A}\\,\\mathbf{T}^{n+1}=\\mathbf{b}$。明确指出狄利克雷边界值是如何进入右端项的。将时间层 $t^{n}$ 的内部温度向量记为 $\\mathbf{T}^{n}\\in\\mathbb{R}^{M}$，其中 $M=N-1$ 是内部节点的数量。\n\n最后，定义无量纲比 $r=\\alpha\\,\\Delta t/\\Delta x^{2}$，并使用克罗内克δ函数 $\\delta_{ij}$（当 $i=j$ 时 $\\delta_{ij}=1$，否则 $\\delta_{ij}=0$）为系统矩阵 $\\mathbf{A}\\in\\mathbb{R}^{M\\times M}$ 的元素 $A_{ij}$ 提供一个闭式解析表达式。您的最终答案必须是这个仅用 $r$ 表示的 $A_{ij}$ 的单一解析表达式。无需进行数值计算，也无需在最终答案中提供单位。",
            "solution": "所提出的问题是偏微分方程数值解中的一个标准练习，问题是有效的。我们将按要求进行推导。\n\n一维瞬态热传导的控制偏微分方程（PDE）如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T(x,t)$ 是温度，$\\alpha$ 是恒定的热扩散系数，$x$ 是空间坐标，$t$ 是时间。\n\n问题要求从能量守恒和傅里叶定律的基本原理推导离散格式。我们考虑应用于以内部节点 $x_i = i\\Delta x$ 为中心的有限控制体（CV）的能量守恒方程的积分形式。该控制体的范围从 $x_{i-1/2} = x_i - \\frac{\\Delta x}{2}$ 到 $x_{i+1/2} = x_i + \\frac{\\Delta x}{2}$。对于无内部热源的均匀材料，控制体内内能的变化率等于传入其中的净热传导率：\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\rho c_p A_{cs} T(x, t) \\, dx = q(x_{i-1/2}, t) - q(x_{i+1/2}, t)\n$$\n此处，$\\rho$ 是密度，$c_p$ 是比热容，$A_{cs}$ 是恒定的横截面积，$q(x,t)$ 是热流率。我们用节点 $T_i(t) = T(x_i, t)$ 处的值乘以体积 $(\\Delta x A_{cs})$ 来近似该积分，得到：\n$$\n\\rho c_p A_{cs} \\Delta x \\frac{dT_i}{dt} \\approx q_{i-1/2} - q_{i+1/2}\n$$\n傅里叶传导定律指出 $q = -k A_{cs} \\frac{\\partial T}{\\partial x}$，其中 $k$ 是热导率。将此代入能量平衡方程：\n$$\n\\rho c_p A_{cs} \\Delta x \\frac{dT_i}{dt} \\approx \\left(-k A_{cs} \\frac{\\partial T}{\\partial x}\\right)\\bigg|_{i-1/2} - \\left(-k A_{cs} \\frac{\\partial T}{\\partial x}\\right)\\bigg|_{i+1/2}\n$$\n两边同除以 $\\rho c_p A_{cs} \\Delta x$，并回顾热扩散系数的定义 $\\alpha = k/(\\rho c_p)$：\n$$\n\\frac{dT_i}{dt} \\approx \\frac{\\alpha}{\\Delta x} \\left( \\frac{\\partial T}{\\partial x}\\bigg|_{i+1/2} - \\frac{\\partial T}{\\partial x}\\bigg|_{i-1/2} \\right)\n$$\n我们使用相邻节点间的中心有限差分来近似控制体表面的温度梯度：\n$$\n\\frac{\\partial T}{\\partial x}\\bigg|_{i+1/2} \\approx \\frac{T_{i+1}(t) - T_i(t)}{\\Delta x} \\quad \\text{和} \\quad \\frac{\\partial T}{\\partial x}\\bigg|_{i-1/2} \\approx \\frac{T_i(t) - T_{i-1}(t)}{\\Delta x}\n$$\n代入这些近似值，得到半离散常微分方程组（ODEs），即所谓的线方法：\n$$\n\\frac{dT_i}{dt} = \\frac{\\alpha}{\\Delta x^2} \\left( T_{i-1}(t) - 2T_i(t) + T_{i+1}(t) \\right)\n$$\n接下来，我们使用后向（隐式）欧拉法在时间上进行离散化。我们在未来时间层 $t^{n+1} = (n+1)\\Delta t$ 对时间导数进行近似，并且关键的是，我们也在相同的未来时间层 $t^{n+1}$ 计算空间导数项：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\alpha}{(\\Delta x)^2} \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n其中 $T_i^n$ 表示节点 $i$ 在时间层 $n$ 的温度。引入无量纲比 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$：\n$$\nT_i^{n+1} - T_i^n = r \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n为了构建线性系统，我们重排此方程，将所有未知项（在时间层 $n+1$）归到左侧，将所有已知项（在时间层 $n$）归到右侧：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n该方程对所有内部节点 $i=1, 2, ..., M$（其中 $M=N-1$）成立。现在我们通过考虑边界条件 $T(0,t)=T_L$ 和 $T(L,t)=T_R$（其离散形式为 $T_0^{n+1} = T_L$ 和 $T_N^{n+1} = T_R$）来组装系统 $\\mathbf{A}\\,\\mathbf{T}^{n+1}=\\mathbf{b}$。\n\n对于第一个内部节点 $i=1$：\n$$\n-r T_0^{n+1} + (1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n\n$$\n代入 $T_0^{n+1} = T_L$ 并将已知项移至右侧：\n$$\n(1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n + r T_L\n$$\n对于一个通用内部节点 $i \\in \\{2, ..., M-1\\}$：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n对于最后一个内部节点 $i=M=N-1$：\n$$\n-r T_{M-1}^{n+1} + (1 + 2r) T_M^{n+1} - r T_N^{n+1} = T_M^n\n$$\n代入 $T_N^{n+1} = T_R$ 并将已知项移至右侧：\n$$\n-r T_{M-1}^{n+1} + (1 + 2r) T_M^{n+1} = T_M^n + r T_R\n$$\n因此，线性系统 $\\mathbf{A}\\,\\mathbf{T}^{n+1}=\\mathbf{b}$ 由以下各项定义：\n未知数向量 $\\mathbf{T}^{n+1} = [T_1^{n+1}, T_2^{n+1}, \\dots, T_M^{n+1}]^T$。\n系统矩阵 $\\mathbf{A} \\in \\mathbb{R}^{M\\times M}$ 是一个对称三对角矩阵：\n$$\n\\mathbf{A} = \\begin{pmatrix}\n1+2r  -r  0  \\cdots  0 \\\\\n-r  1+2r  -r  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots  \\cdots  -r  1+2r  -r \\\\\n0  \\cdots  0  -r  1+2r\n\\end{pmatrix}\n$$\n右端向量 $\\mathbf{b} \\in \\mathbb{R}^{M}$ 由下式给出：\n$$\n\\mathbf{b} = \\begin{pmatrix} T_1^n + r T_L \\\\ T_2^n \\\\ \\vdots \\\\ T_{M-1}^n \\\\ T_M^n + r T_R \\end{pmatrix}\n$$\n这清楚地表明了狄利克雷边界值 $T_L$ 和 $T_R$ 是如何经无量纲参数 $r$ 缩放后，进入向量 $\\mathbf{b}$ 的第一个和最后一个元素的。\n\n最后，我们使用克罗内克δ函数 $\\delta_{ij}$ 为矩阵 $\\mathbf{A}$ 的元素 $A_{ij}$（其中 $i,j \\in \\{1, 2, ..., M\\}$）提供一个闭式表达式。该矩阵在主对角线（$i=j$）上的元素为 $(1+2r)$，在上对角线（$j=i+1$）和下对角线（$j=i-1$）上的元素为 $-r$。所有其他元素均为零。这种结构可以紧凑地写成：\n$$\nA_{ij} = (1+2r)\\delta_{ij} - r\\delta_{i, j-1} - r\\delta_{i, j+1}\n$$\n这个单一表达式精确地表示了矩阵 $\\mathbf{A}$ 中的每一个元素。",
            "answer": "$$\n\\boxed{(1+2r)\\delta_{ij} - r\\delta_{i,j-1} - r\\delta_{i,j+1}}\n$$"
        },
        {
            "introduction": "在学会建立离散系统之后，下一步是理解其物理意义。本练习介绍了“残差”的概念，它量化了给定温度场在多大程度上未能满足局部能量守恒。通过计算残差，您可以更深入地理解离散方程作为能量守恒声明的本质，这是有限体积法的核心思想。",
            "id": "3964391",
            "problem": "在一个均匀、各向同性的固体中，一个二维稳态热传导过程由能量守恒定律控制，在没有平流的情况下，可以写成偏微分方程 (PDE) $\\nabla \\cdot \\left(k \\nabla T\\right) + \\dot{q} = 0$，其中 $T(x,y)$ 是温度，$k$ 是热导率，$\\dot{q}(x,y)$ 是体积生热率。考虑一个方形区域 $[0,L] \\times [0,L]$，其中 $L = 0.2\\,\\mathrm{m}$，该区域被一个间距为 $\\Delta x = \\Delta y = h = 0.05\\,\\mathrm{m}$ 的均匀笛卡尔网格离散化。我们关注位于 $(x_i,y_j) = (0.1\\,\\mathrm{m}, 0.1\\,\\mathrm{m})$ 中心的内部控制体，其对应指数为 $(i,j) = (2,2)$。\n\n假设热导率是常数，$k = 30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$。一个候选温度场被指定为\n$$\nT(x,y) = 300 + 10 x^{2} + 5 y^{2} - 8 x y \\quad \\text{(单位 K)}。\n$$\n体积生热率由下式给出\n$$\n\\dot{q}(x,y) = 5 \\times 10^{5} + 1 \\times 10^{5}\\,x - 2 \\times 10^{5}\\,y \\quad \\text{(单位 W\\,m$^{-3}$)}。\n$$\n使用与有限体积法 (FVM) 一致的二阶中心差分格式对该均匀网格进行离散化，从控制体上的积分能量平衡方程推导出候选场在以 $(x_i,y_j)$ 为中心的单元格上产生的单位体积离散残差 $R_{ij}$，然后计算其在 $(i,j) = (2,2)$ 处的数值。将残差解释为局部守恒误差密度的度量：正值表示控制体内存在净不平衡产生，负值表示存在净不平衡移除。\n\n将您的最终数值答案四舍五入到四位有效数字，并以 $\\mathrm{W\\,m^{-3}}$ 为单位表示。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、适定且完整的。所有必要的数据和条件都已提供，可以计算出离散残差的唯一、有意义的答案。该问题是计算传热学入门中的一个标准练习。\n\n对于具有恒定热导率 $k$ 和体积生热率 $\\dot{q}$ 的二维稳态热传导，其控制偏微分方程如下：\n$$ k \\nabla^2 T + \\dot{q} = 0 $$\n其中 $T(x,y)$ 是温度场。在笛卡尔坐标系中，该方程展开为：\n$$ k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\dot{q}(x,y) = 0 $$\n该问题要求使用有限体积法 (FVM) 计算特定内部节点 $(i,j)$ 处的单位体积离散残差 $R_{ij}$。残差表示候选温度场不满足离散化能量守恒方程的程度。\n\n在FVM中，控制方程在围绕节点 $(x_i, y_j)$ 的控制体 $V$ 上进行积分。对于单位深度的二维问题，控制体是一个面积为 $A = \\Delta x \\Delta y = h^2$ 的方形区域。\n$$ \\int_A \\left[ k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\dot{q} \\right] dA = 0 $$\n对扩散项应用散度定理，控制体的积分方程变为其各表面上的热通量与内部总生热量的平衡：\n$$ \\int_{\\partial A} k \\nabla T \\cdot \\mathbf{n} \\, dl + \\int_A \\dot{q} \\, dA = 0 $$\n其中 $\\partial A$ 是控制体的边界，$\\mathbf{n}$ 是向外的单位法向量。\n\n离散残差 $Res_{ij}$ 是将候选温度场代入此积分平衡方程左侧得到的值。我们使用二阶中心差分来近似控制体各面（东‘e’、西‘w’、北‘n’、南‘s’）的热通量。净热流出近似为：\n$$ \\int_{\\partial A} k \\nabla T \\cdot \\mathbf{n} \\, dl \\approx k(T_{i+1,j} - 2T_{i,j} + T_{i-1,j}) + k(T_{i,j+1} - 2T_{i,j} + T_{i,j-1}) $$\n积分源项近似为：\n$$ \\int_A \\dot{q} \\, dA \\approx \\bar{\\dot{q}}_{ij} A = \\bar{\\dot{q}}_{ij} h^2 $$\n其中 $\\bar{\\dot{q}}_{ij}$ 是控制体中的平均源项，对于二阶格式，取节点中心的值，即 $\\bar{\\dot{q}}_{ij} = \\dot{q}(x_i, y_j)$。\n控制体的总残差是这些项的总和：\n$$ Res_{ij} = k \\left( T_{i+1,j} + T_{i-1,j} + T_{i,j+1} + T_{i,j-1} - 4T_{i,j} \\right) + \\dot{q}(x_i, y_j) h^2 $$\n问题要求的是*单位体积*残差 $R_{ij}$，即 $Res_{ij}$ 除以控制体面积 $h^2$：\n$$ R_{ij} = \\frac{Res_{ij}}{h^2} = k \\left( \\frac{T_{i+1,j} - 2T_{i,j} + T_{i-1,j}}{h^2} + \\frac{T_{i,j+1} - 2T_{i,j} + T_{i,j-1}}{h^2} \\right) + \\dot{q}(x_i, y_j) $$\n该表达式代表了 $k \\nabla^2 T + \\dot{q}$ 的离散形式。\n\n我们现在计算在节点 $(i,j)=(2,2)$ 处的 $R_{ij}$ 的数值，该节点中心位于 $(x_i, y_j) = (0.1\\,\\mathrm{m}, 0.1\\,\\mathrm{m})$。\n给定的参数是：\n- 热导率, $k = 30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- 网格间距, $h = 0.05\\,\\mathrm{m}$\n- 目标节点坐标：$(x_2, y_2) = (0.1, 0.1)$\n相邻节点的坐标是：\n- 西：$(x_1, y_2) = (x_2 - h, y_2) = (0.05, 0.1)$\n- 东：$(x_3, y_2) = (x_2 + h, y_2) = (0.15, 0.1)$\n- 南：$(x_2, y_1) = (x_2, y_2 - h) = (0.1, 0.05)$\n- 北：$(x_2, y_3) = (x_2, y_2 + h) = (0.1, 0.15)$\n\n候选温度场为 $T(x,y) = 300 + 10 x^{2} + 5 y^{2} - 8 x y$。我们在每个所需节点上计算温度：\n- $T_{2,2} = T(0.1, 0.1) = 300 + 10(0.1)^2 + 5(0.1)^2 - 8(0.1)(0.1) = 300 + 0.1 + 0.05 - 0.08 = 300.07\\,\\mathrm{K}$\n- $T_{1,2} = T(0.05, 0.1) = 300 + 10(0.05)^2 + 5(0.1)^2 - 8(0.05)(0.1) = 300 + 0.025 + 0.05 - 0.04 = 300.035\\,\\mathrm{K}$\n- $T_{3,2} = T(0.15, 0.1) = 300 + 10(0.15)^2 + 5(0.1)^2 - 8(0.15)(0.1) = 300 + 0.225 + 0.05 - 0.12 = 300.155\\,\\mathrm{K}$\n- $T_{2,1} = T(0.1, 0.05) = 300 + 10(0.1)^2 + 5(0.05)^2 - 8(0.1)(0.05) = 300 + 0.1 + 0.0125 - 0.04 = 300.0725\\,\\mathrm{K}$\n- $T_{2,3} = T(0.1, 0.15) = 300 + 10(0.1)^2 + 5(0.15)^2 - 8(0.1)(0.15) = 300 + 0.1 + 0.1125 - 0.12 = 300.0925\\,\\mathrm{K}$\n\n现在，我们计算离散拉普拉斯算子的两项：\n$$ \\frac{T_{3,2} - 2T_{2,2} + T_{1,2}}{h^2} = \\frac{300.155 - 2(300.07) + 300.035}{(0.05)^2} = \\frac{0.05}{0.0025} = 20\\,\\mathrm{K\\,m^{-2}} $$\n$$ \\frac{T_{2,3} - 2T_{2,2} + T_{2,1}}{h^2} = \\frac{300.0925 - 2(300.07) + 300.0725}{(0.05)^2} = \\frac{0.025}{0.0025} = 10\\,\\mathrm{K\\,m^{-2}} $$\n总的离散拉普拉斯算子是 $20 + 10 = 30\\,\\mathrm{K\\,m^{-2}}$。由于温度场是二次的，这个二阶中心差分是精确的，等于解析拉普拉斯算子 $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 20 + 10 = 30$。\n\n接下来，我们计算节点中心的生热项：\n$$ \\dot{q}(x,y) = 5 \\times 10^{5} + 1 \\times 10^{5}\\,x - 2 \\times 10^{5}\\,y $$\n$$ \\dot{q}(0.1, 0.1) = 5 \\times 10^{5} + 1 \\times 10^{5}(0.1) - 2 \\times 10^{5}(0.1) = 5 \\times 10^{5} + 0.1 \\times 10^{5} - 0.2 \\times 10^{5} = 4.9 \\times 10^{5}\\,\\mathrm{W\\,m^{-3}} $$\n\n最后，我们组装单位体积残差 $R_{2,2}$：\n$$ R_{2,2} = k \\left( 30 \\right) + \\dot{q}(0.1, 0.1) $$\n$$ R_{2,2} = (30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}) \\times (30\\,\\mathrm{K\\,m^{-2}}) + 4.9 \\times 10^{5}\\,\\mathrm{W\\,m^{-3}} $$\n$$ R_{2,2} = 900\\,\\mathrm{W\\,m^{-3}} + 490000\\,\\mathrm{W\\,m^{-3}} = 490900\\,\\mathrm{W\\,m^{-3}} $$\n残差的正号表示在给定的候选温度场下，控制体内存在净局部能源，或称为“不平衡产生”。该候选场不是控制稳态方程的解。\n\n问题要求答案四舍五入到四位有效数字。\n$490900 = 4.909 \\times 10^5$。这个值已经有四位有效数字。",
            "answer": "$$\\boxed{4.909 \\times 10^5}$$"
        },
        {
            "introduction": "确保数值解的正确性是最终的关键环节。本练习提供了代码验证的实用指南，演示了如何利用已知的解析解来衡量数值方法的误差。通过网格细化研究，您可以计算出方法的收敛阶，从而验证您的实现是否与理论预期相符，并建立对数值结果的信心。",
            "id": "3964340",
            "problem": "考虑一个占据空间域 $x \\in [0,1]$ 的均匀板中的一维稳态热传导，其导热系数 $k$ 为常数，并存在一个体积热源 $s(x)$。稳态下的能量守恒定律是一个边值问题，其控制方程为 $-\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = s(x)$，狄利克雷边界条件为 $T(0)=0$ 和 $T(1)=0$。设 $k$ 为一个正常数，热源 $s(x)$ 使得精确解为 $T(x) = \\sin(\\pi x)$。采用网格间距为 $h$ 的均匀网格上的二阶中心有限差分法，计算在四种网格分辨率（$h_1 = \\frac{1}{16}$、$h_2 = \\frac{1}{32}$、$h_3 = \\frac{1}{64}$ 和 $h_4 = \\frac{1}{128}$）下，网格点 $\\{x_j\\}$ 处的离散解 $\\{T_j^{(i)}\\}$。对于每个网格 $i \\in \\{1,2,3,4\\}$，记录其逐点误差 $e_j^{(i)} = T_j^{(i)} - T(x_j)$，并提供以下网格加密数据：\n- 对于离散 $L_2$ 误差计算，其平方和 $S^{(i)} = \\sum_{j} \\left(e_j^{(i)}\\right)^2$ 如下：\n$$S^{(1)} = 1.6 \\times 10^{-5}, \\quad S^{(2)} = 2.0 \\times 10^{-6}, \\quad S^{(3)} = 2.5 \\times 10^{-7}, \\quad S^{(4)} = 3.125 \\times 10^{-8}.$$\n- 对于离散 $L_{\\infty}$ 误差计算，其最大值 $M^{(i)} = \\max_{j} \\left|e_j^{(i)}\\right|$ 如下：\n$$M^{(1)} = 2.0 \\times 10^{-3}, \\quad M^{(2)} = 5.0 \\times 10^{-4}, \\quad M^{(3)} = 1.25 \\times 10^{-4}, \\quad M^{(4)} = 3.125 \\times 10^{-5}.$$\n\n任务：\n1. 从误差 $e(x) = T_h(x) - T(x)$ 在 $[0,1]$ 上的连续 $L_2$ 和 $L_{\\infty}$ 范数的定义出发，推导出一个网格间距为 $h_i$ 的均匀网格上的一致离散定义 $E_2^{(i)}$ 和 $E_{\\infty}^{(i)}$，并用逐点误差 $e_j^{(i)}$、网格间距 $h_i$ 以及所给定的量 $S^{(i)}$ 和 $M^{(i)}$ 来表示。\n2. 使用你推导的离散定义，根据给定的 $S^{(i)}$ 和 $h_i$ 计算 $i=1,2,3,4$ 时的 $L_2$ 误差范数 $E_2^{(i)}$。\n3. 使用 $L_2$ 范数，通过对四个网格的数据进行最小二乘法拟合模型 $\\ln\\left(E_2^{(i)}\\right) \\approx \\alpha + p \\,\\ln(h_i)$，估计观测到的收敛阶 $p$。报告最终的 $p$ 值，四舍五入到四位有效数字。$p$ 无需单位。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前，必须首先验证其正确性、完整性和科学合理性。\n\n### 步骤 1：提取已知条件\n- **控制方程：** 一维稳态热传导：$-\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = s(x)$，其中 $x \\in [0,1]$。\n- **区域：** $x \\in [0,1]$。\n- **导热系数：** $k$ 是一个正常数。\n- **边界条件：** $T(0)=0$ 和 $T(1)=0$。\n- **精确解：** $T(x) = \\sin(\\pi x)$。这意味着热源项为 $s(x) = k \\pi^2 \\sin(\\pi x)$。\n- **数值方法：** 均匀网格上的二阶中心有限差分法。\n- **网格间距：** $h_1 = \\frac{1}{16}$、$h_2 = \\frac{1}{32}$、$h_3 = \\frac{1}{64}$ 和 $h_4 = \\frac{1}{128}$。\n- **逐点误差：** $e_j^{(i)} = T_j^{(i)} - T(x_j)$，对于网格 $i$ 的点 $x_j$。\n- **$L_2$ 误差平方和：** $S^{(i)} = \\sum_{j} \\left(e_j^{(i)}\\right)^2$\n  - $S^{(1)} = 1.6 \\times 10^{-5}$\n  - $S^{(2)} = 2.0 \\times 10^{-6}$\n  - $S^{(3)} = 2.5 \\times 10^{-7}$\n  - $S^{(4)} = 3.125 \\times 10^{-8}$\n- **$L_{\\infty}$ 误差最大值：** $M^{(i)} = \\max_{j} \\left|e_j^{(i)}\\right|$\n  - $M^{(1)} = 2.0 \\times 10^{-3}$\n  - $M^{(2)} = 5.0 \\times 10^{-4}$\n  - $M^{(3)} = 1.25 \\times 10^{-4}$\n  - $M^{(4)} = 3.125 \\times 10^{-5}$\n- **任务：**\n  1. 推导离散误差范数 $E_2^{(i)}$ 和 $E_{\\infty}^{(i)}$。\n  2. 计算 $i=1,2,3,4$ 时的 $E_2^{(i)}$。\n  3. 使用最小二乘法拟合模型 $\\ln\\left(E_2^{(i)}\\right) \\approx \\alpha + p \\,\\ln(h_i)$，估计 $L_2$ 误差的收敛阶 $p$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实合理性：** 该问题描述了由泊松方程控制的稳态热传导，这是热工和物理学中的一个基本概念。有限差分法、网格加密、误差范数和收敛性分析的使用是数值分析中的标准且正确的程序。所提供的精确解 $T(x) = \\sin(\\pi x)$ 正确地满足了狄利克雷边界条件 $T(0)=0$ 和 $T(1)=0$。该问题在科学和数学上是合理的。\n2.  **适定性和完整性：** 该问题是一个适定的边值问题。执行三个指定任务所需的所有数据均已提供。任务本身定义清晰，并有唯一解。对所提供误差数据的检查显示其内部一致。对于一个二阶方法，将网格尺寸 $h$ 减半应使误差减少一个因子 $2^2=4$。$M^{(i)}$ 的值精确地显示了这一点：$M^{(i)}/M^{(i+1)}=4$。对于 $L_2$ 范数，其尺度与 $\\sqrt{h S}$ 成正比，量 $hS$ 应与 $h^4$ 成正比，这意味着 $S$ 应与 $h^3$ 成正比。将 $h$ 减半应使 $S$ 减少一个因子 $2^3=8$。$S^{(i)}$ 的值精确地显示了这一点：$S^{(i)}/S^{(i+1)}=8$。数据与二阶方法的前提是一致的。\n3.  **客观性：** 该问题使用精确、客观的数学语言陈述，没有歧义或主观论断。\n\n### 步骤 3：结论与行动\n该问题具有科学依据、适定且内部一致。这是一个有效的问题。将提供解答。\n\n---\n\n### 解答\n\n解答分为三部分，对应问题陈述中指定的任务。\n\n**任务 1：推导离散误差范数**\n\n误差函数为 $e(x) = T_h(x) - T(x)$，其中 $T_h(x)$ 是离散解的一种表示，$T(x)$ 是精确解。\n\n误差在域 $[0,1]$ 上的连续 $L_{\\infty}$ 范数定义为：\n$$\n\\|e\\|_{\\infty} = \\max_{x \\in [0,1]} |e(x)|\n$$\n该范数的一个一致的离散模拟，对于网格 $i$ 记为 $E_{\\infty}^{(i)}$，是所有网格点 $\\{x_j\\}$ 上逐点误差绝对值的最大值。问题直接提供了这个量，即 $M^{(i)} = \\max_{j} |e_j^{(i)}| = \\max_{j} |T_j^{(i)} - T(x_j)|$。因此，离散 $L_{\\infty}$ 误差范数为：\n$$\nE_{\\infty}^{(i)} = M^{(i)}\n$$\n\n误差在域 $[0,1]$ 上的连续 $L_2$ 范数定义为：\n$$\n\\|e\\|_{2} = \\left( \\int_{0}^{1} (e(x))^2 dx \\right)^{1/2}\n$$\n为了找到离散模拟，我们在间距为 $h_i$ 的均匀网格 $i$ 上使用数值积分法则来近似该积分。将域 $[0,1]$ 分割成子区间，我们可以将积分近似为一个和。使用左矩形法则，积分近似为：\n$$\n\\int_{0}^{1} (e(x))^2 dx \\approx \\sum_{j=0}^{N_i-1} (e(x_j))^2 h_i\n$$\n其中 $N_i = 1/h_i$ 是区间的数量。由于边界上的误差为零，即 $e_0^{(i)} = e(0) = 0$ 和 $e_{N_i}^{(i)} = e(1) = 0$，求和实际上是对内部点 $j=1, \\dots, N_i-1$ 进行的。问题定义了 $S^{(i)} = \\sum_{j} (e_j^{(i)})^2$。通常假定此求和是针对计算误差的内部节点。因此，我们有：\n$$\n\\int_{0}^{1} (e(x))^2 dx \\approx h_i \\sum_{j=1}^{N_i-1} (e_j^{(i)})^2 = h_i S^{(i)}\n$$\n取平方根得到离散 $L_2$ 误差范数 $E_2^{(i)}$：\n$$\nE_2^{(i)} = \\left( h_i S^{(i)} \\right)^{1/2} = \\sqrt{h_i S^{(i)}}\n$$\n\n**任务 2：计算 $L_2$ 误差范数**\n\n使用推导出的公式 $E_2^{(i)} = \\sqrt{h_i S^{(i)}}$ 和所提供的数据，我们计算 4 个网格中每一个的范数。\n\n对于网格 $i=1$：$h_1 = \\frac{1}{16}$，$S^{(1)} = 1.6 \\times 10^{-5}$。\n$$\nE_2^{(1)} = \\sqrt{\\frac{1}{16} \\times 1.6 \\times 10^{-5}} = \\sqrt{0.1 \\times 10^{-5}} = \\sqrt{1.0 \\times 10^{-6}} = 1.0 \\times 10^{-3}\n$$\n\n对于网格 $i=2$：$h_2 = \\frac{1}{32}$，$S^{(2)} = 2.0 \\times 10^{-6}$。\n$$\nE_2^{(2)} = \\sqrt{\\frac{1}{32} \\times 2.0 \\times 10^{-6}} = \\sqrt{\\frac{1}{16} \\times 1.0 \\times 10^{-6}} = \\frac{1}{4} \\times 1.0 \\times 10^{-3} = 2.5 \\times 10^{-4}\n$$\n\n对于网格 $i=3$：$h_3 = \\frac{1}{64}$，$S^{(3)} = 2.5 \\times 10^{-7}$。\n$$\nE_2^{(3)} = \\sqrt{\\frac{1}{64} \\times 2.5 \\times 10^{-7}} = \\sqrt{\\frac{1}{64} \\times 25 \\times 10^{-8}} = \\frac{5}{8} \\times 10^{-4} = 0.625 \\times 10^{-4} = 6.25 \\times 10^{-5}\n$$\n\n对于网格 $i=4$：$h_4 = \\frac{1}{128}$，$S^{(4)} = 3.125 \\times 10^{-8}$。\n$$\nE_2^{(4)} = \\sqrt{\\frac{1}{128} \\times 3.125 \\times 10^{-8}} = \\sqrt{\\frac{1}{128} \\times \\frac{25}{8} \\times 10^{-8}} = \\sqrt{\\frac{25}{1024} \\times 10^{-8}} = \\frac{5}{32} \\times 10^{-4} = 0.15625 \\times 10^{-4} = 1.5625 \\times 10^{-5}\n$$\n\n**任务 3：估计收敛阶 $p$**\n\n误差模型为 $E_2 \\approx C h^p$，其中 $p$ 是收敛阶。取自然对数得到线性模型：\n$$\n\\ln(E_2^{(i)}) \\approx \\ln(C) + p \\ln(h_i)\n$$\n这对应于 $y_i = \\ln(E_2^{(i)})$ 对 $x_i = \\ln(h_i)$ 的线性回归，其中斜率为 $p$。\n\n我们来检验一下计算出的 $E_2^{(i)}$ 和 $h_i$ 之间的关系。网格间距 $h_i$ 逐次减半：$h_i = \\frac{1}{16} \\left(\\frac{1}{2}\\right)^{i-1}$。\n计算出的误差为：\n$E_2^{(1)} = 1.0 \\times 10^{-3}$\n$E_2^{(2)} = E_2^{(1)} / 4$\n$E_2^{(3)} = E_2^{(2)} / 4 = E_2^{(1)} / 16$\n$E_2^{(4)} = E_2^{(3)} / 4 = E_2^{(1)} / 64$\n\n这可以写成 $E_2^{(i)} = E_2^{(1)} \\left(\\frac{1}{4}\\right)^{i-1}$。\n让我们用初始值来表示 $E_2^{(i)}$ 和 $h_i$：\n$h_i = h_1 \\left(\\frac{1}{2}\\right)^{i-1}$\n$E_2^{(i)} = E_2^{(1)} \\left(\\frac{1}{4}\\right)^{i-1} = E_2^{(1)} \\left(\\left(\\frac{1}{2}\\right)^{2}\\right)^{i-1} = E_2^{(1)} \\left(\\left(\\frac{1}{2}\\right)^{i-1}\\right)^{2}$\n代入 $h_i$ 的表达式：\n$E_2^{(i)} = E_2^{(1)} \\left(\\frac{h_i}{h_1}\\right)^2 = \\frac{E_2^{(1)}}{h_1^2} h_i^2$\n\n这表明 $E_2^{(i)} = C (h_i)^2$，其中常数 $C = \\frac{E_2^{(1)}}{h_1^2} = \\frac{1.0 \\times 10^{-3}}{(1/16)^2} = 256 \\times 10^{-3} = 0.256$。\n对于给定数据，该关系是精确的。取自然对数：\n$$\n\\ln(E_2^{(i)}) = \\ln(C (h_i)^2) = \\ln(C) + 2 \\ln(h_i)\n$$\n数据点 $(x_i, y_i) = (\\ln(h_i), \\ln(E_2^{(i)}))$ 完全位于一条斜率为 $p=2$ 的直线上。对完全线性的数据进行最小二乘回归拟合将返回该直线的精确斜率。因此，估计的收敛阶恰好为 $2$。\n\n问题要求将结果四舍五入到四位有效数字。",
            "answer": "$$\n\\boxed{2.000}\n$$"
        }
    ]
}