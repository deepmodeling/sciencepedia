{
    "hands_on_practices": [
        {
            "introduction": "在曲线坐标系中，正确表示矢量（如热通量）是至关重要的，但协变和逆变分量之间的区别常常引起混淆。本练习旨在通过在熟悉的球坐标系中，从第一性原理出发，推导和辨析热通量矢量的协变与逆变分量，从而澄清这一关键概念。通过深入探讨这些分量的物理单位和几何意义，您将为在复杂几何中准确建模物理现象打下坚实的基础 。",
            "id": "3945595",
            "problem": "一个均匀、各向同性的固态球体，其热导率为 $k$（单位为 $\\mathrm{W \\, m^{-1} \\, K^{-1}}$），并具有一个由 $T(r) = T_{\\infty} + \\dfrac{C}{r}$ 给出的稳态、球对称温度场，其中 $T_{\\infty}$ 和 $C$ 是常数，$r$ 是球坐标系 $(r,\\theta,\\phi)$ 中的径向坐标。热通量矢量 $\\boldsymbol{q}$ 遵循傅里叶热传导定律 $\\boldsymbol{q} = -k \\nabla T$。考虑在球坐标系中使用协变基 $\\{\\boldsymbol{g}_{i}\\}$ 和逆变（倒易）基 $\\{\\boldsymbol{g}^{i}\\}$（其中 $i \\in \\{r,\\theta,\\phi\\}$）来表示矢量，这是计算热工学中曲线坐标变换所要求的。\n\n仅从以下三点出发：(i) 傅里叶定律 $\\boldsymbol{q} = -k \\nabla T$，(ii) 梯度作为满足 $dT = \\nabla T \\cdot d\\boldsymbol{r}$（对于任意位移 $d\\boldsymbol{r}$）的唯一矢量的定义，以及 (iii) 由 $\\boldsymbol{g}_{i} = \\dfrac{\\partial \\boldsymbol{r}}{\\partial q^{i}}$ 和 $\\boldsymbol{g}_{i} \\cdot \\boldsymbol{g}^{j} = \\delta_{i}^{\\,j}$ 定义的坐标基的几何定义，推导热通量矢量 $\\boldsymbol{q}$ 在球坐标系中的协变分量 $q_{i}$ 和逆变分量 $q^{i}$ 的表达式。然后，将您的一般表达式具体应用于此球对称情况，并显式计算非零分量 $q^{r}$ 和 $q_{r}$ 作为 $r$、$k$ 和 $C$ 的函数。\n\n此外，请解释以下各项的物理单位：协变基矢量 $\\boldsymbol{g}_{i}$、逆变基矢量 $\\boldsymbol{g}^{i}$、协变分量 $q_{i}$ 和逆变分量 $q^{i}$。角坐标 $\\theta$ 和 $\\phi$ 使用弧度。\n\n答案规格：\n- 以包含 $q^{r}$ 和 $q_{r}$（按此顺序）的单个 $1 \\times 2$ 行矩阵的形式报告最终结果。\n- 用符号表达式表达您的最终结果，不要进行数值代入。\n- 如果需要附加单位，请使用国际单位制（SI），热通量单位为 $\\mathrm{W \\, m^{-2}}$。最终的方框答案中不要包含单位。",
            "solution": "该问题是有效的，因为它科学地基于张量微积分和传热学原理，问题陈述清晰且信息充分，并且是客观陈述的。我们将开始推导。\n\n设曲线坐标表示为 $q^i$。位置矢量 $\\boldsymbol{r}$ 是这些坐标的函数。\n\n**步骤 1：梯度和热通量分量的一般推导**\n\n出发点是梯度 $\\nabla T$ 的定义，即它是在任意微分位移 $d\\boldsymbol{r}$ 下都满足 $dT = \\nabla T \\cdot d\\boldsymbol{r}$ 的唯一矢量场。\n\n标量场 $T(q^1, q^2, q^3)$ 的微分由链式法则给出：\n$$dT = \\frac{\\partial T}{\\partial q^i} dq^i$$\n其中，重复的索引 $i$ 意味着求和（爱因斯坦求和约定）。\n\n微分位移矢量 $d\\boldsymbol{r}$ 可以用协变基矢量 $\\boldsymbol{g}_i = \\frac{\\partial \\boldsymbol{r}}{\\partial q^i}$ 来表示：\n$$d\\boldsymbol{r} = \\frac{\\partial \\boldsymbol{r}}{\\partial q^i} dq^i = \\boldsymbol{g}_i dq^i$$\n\n将这些代入梯度的定义中：\n$$\\frac{\\partial T}{\\partial q^i} dq^i = (\\nabla T) \\cdot (\\boldsymbol{g}_i dq^i) = ((\\nabla T) \\cdot \\boldsymbol{g}_i) dq^i$$\n由于此等式必须对任意坐标微分 $dq^i$ 成立，我们可以使系数相等：\n$$(\\nabla T) \\cdot \\boldsymbol{g}_i = \\frac{\\partial T}{\\partial q^i}$$\n根据定义，项 $(\\nabla T) \\cdot \\boldsymbol{g}_i$ 是矢量 $\\nabla T$ 的协变分量。\n\n一个矢量可以通过其协变分量和逆变（倒易）基矢量 $\\boldsymbol{g}^j$ 进行重构，逆变基矢量由关系 $\\boldsymbol{g}_i \\cdot \\boldsymbol{g}^j = \\delta_i^{\\,j}$（克罗内克 $\\delta$）定义。因此，梯度矢量表示为：\n$$\\nabla T = ((\\nabla T) \\cdot \\boldsymbol{g}_i) \\boldsymbol{g}^i = \\frac{\\partial T}{\\partial q^i} \\boldsymbol{g}^i$$\n这是曲线坐标系中梯度的一般表达式。\n\n现在，我们应用傅里叶热传导定律 $\\boldsymbol{q} = -k \\nabla T$：\n$$\\boldsymbol{q} = -k \\left(\\frac{\\partial T}{\\partial q^i} \\boldsymbol{g}^i \\right)$$\n\n为了找到 $\\boldsymbol{q}$ 的分量，我们将其在协变基和逆变基中展开：\n1.  $\\boldsymbol{q} = q_i \\boldsymbol{g}^i$（在逆变基下的展开）\n2.  $\\boldsymbol{q} = q^i \\boldsymbol{g}_i$（在协变基下的展开）\n\n通过与表达式 $\\boldsymbol{q} = -k \\frac{\\partial T}{\\partial q^i} \\boldsymbol{g}^i$ 直接比较，我们立即可以确定热通量矢量的**协变分量**：\n$$q_j = -k \\frac{\\partial T}{\\partial q^j}$$\n\n为了求出**逆变分量** $q^j$，我们需要关联两个基。关系是 $\\boldsymbol{g}^i = g^{ij} \\boldsymbol{g}_j$，其中 $g^{ij}$ 是逆度规张量的分量。度规张量的分量是 $g_{ij} = \\boldsymbol{g}_i \\cdot \\boldsymbol{g}_j$。将此代入 $\\boldsymbol{q}$ 的表达式中：\n$$\\boldsymbol{q} = -k \\frac{\\partial T}{\\partial q^i} (g^{ij} \\boldsymbol{g}_j) = \\left(-k g^{ij} \\frac{\\partial T}{\\partial q^i}\\right) \\boldsymbol{g}_j$$\n将此与 $\\boldsymbol{q} = q^j \\boldsymbol{g}_j$ 进行比较，我们确定逆变分量为：\n$$q^j = -k g^{ij} \\frac{\\partial T}{\\partial q^i}$$\n\n**步骤 2：应用于球坐标系**\n\n设球坐标为 $(q^1, q^2, q^3) = (r, \\theta, \\phi)$。位置矢量 $\\boldsymbol{r}$ 在固定笛卡尔基 $(\\hat{\\boldsymbol{x}}, \\hat{\\boldsymbol{y}}, \\hat{\\boldsymbol{z}})$ 下表示为：\n$$\\boldsymbol{r}(r, \\theta, \\phi) = r \\sin\\theta \\cos\\phi \\, \\hat{\\boldsymbol{x}} + r \\sin\\theta \\sin\\phi \\, \\hat{\\boldsymbol{y}} + r \\cos\\theta \\, \\hat{\\boldsymbol{z}}$$\n\n协变基矢量 $\\boldsymbol{g}_i = \\frac{\\partial \\boldsymbol{r}}{\\partial q^i}$ 为：\n$$\\boldsymbol{g}_r = \\frac{\\partial \\boldsymbol{r}}{\\partial r} = \\sin\\theta \\cos\\phi \\, \\hat{\\boldsymbol{x}} + \\sin\\theta \\sin\\phi \\, \\hat{\\boldsymbol{y}} + \\cos\\theta \\, \\hat{\\boldsymbol{z}}$$\n$$\\boldsymbol{g}_\\theta = \\frac{\\partial \\boldsymbol{r}}{\\partial \\theta} = r \\cos\\theta \\cos\\phi \\, \\hat{\\boldsymbol{x}} + r \\cos\\theta \\sin\\phi \\, \\hat{\\boldsymbol{y}} - r \\sin\\theta \\, \\hat{\\boldsymbol{z}}$$\n$$\\boldsymbol{g}_\\phi = \\frac{\\partial \\boldsymbol{r}}{\\partial \\phi} = -r \\sin\\theta \\sin\\phi \\, \\hat{\\boldsymbol{x}} + r \\sin\\theta \\cos\\phi \\, \\hat{\\boldsymbol{y}}$$\n这些矢量相互正交。\n\n度规张量 $g_{ij} = \\boldsymbol{g}_i \\cdot \\boldsymbol{g}_j$ 的分量为：\n$$g_{rr} = \\boldsymbol{g}_r \\cdot \\boldsymbol{g}_r = \\sin^2\\theta \\cos^2\\phi + \\sin^2\\theta \\sin^2\\phi + \\cos^2\\theta = 1$$\n$$g_{\\theta\\theta} = \\boldsymbol{g}_\\theta \\cdot \\boldsymbol{g}_\\theta = r^2(\\cos^2\\theta \\cos^2\\phi + \\cos^2\\theta \\sin^2\\phi + \\sin^2\\theta) = r^2$$\n$$g_{\\phi\\phi} = \\boldsymbol{g}_\\phi \\cdot \\boldsymbol{g}_\\phi = r^2 \\sin^2\\theta(\\sin^2\\phi + \\cos^2\\phi) = r^2\\sin^2\\theta$$\n由于正交性，所有非对角线分量 $g_{ij}$（当 $i \\neq j$ 时）均为零。度规张量是对角的：\n$$[g_{ij}] = \\begin{pmatrix} 1  & 0 & 0 \\\\ 0 & r^2 & 0 \\\\ 0 & 0 & r^2\\sin^2\\theta \\end{pmatrix}$$\n逆度规张量 $[g^{ij}]$ 是该矩阵的逆矩阵，对于对角矩阵，其逆矩阵是对角元素倒数构成的矩阵：\n$$[g^{ij}] = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & r^{-2} & 0 \\\\ 0 & 0 & (r\\sin\\theta)^{-2} \\end{pmatrix}$$\n\n**步骤 3：非零通量分量的计算**\n\n温度场由 $T(r) = T_{\\infty} + \\frac{C}{r}$ 给出。它仅依赖于径向坐标 $r$。其偏导数为：\n$$\\frac{\\partial T}{\\partial r} = -\\frac{C}{r^2}$$\n$$\\frac{\\partial T}{\\partial \\theta} = 0$$\n$$\\frac{\\partial T}{\\partial \\phi} = 0$$\n\n现在我们计算热通量的特定非零分量。\n唯一非零的协变分量是 $q_r$：\n$$q_r = -k \\frac{\\partial T}{\\partial r} = -k \\left(-\\frac{C}{r^2}\\right) = \\frac{kC}{r^2}$$\n其他协变分量 $q_\\theta = -k \\frac{\\partial T}{\\partial \\theta} = 0$ 和 $q_\\phi = -k \\frac{\\partial T}{\\partial \\phi} = 0$。\n\n对于逆变分量，我们使用公式 $q^j = -k \\sum_i g^{ji} \\frac{\\partial T}{\\partial q^i}$。由于度规张量是对角的，并且只有 $\\frac{\\partial T}{\\partial r}$ 不为零，求和大大简化。\n唯一非零的逆变分量是 $q^r$：\n$$q^r = -k \\left( g^{rr}\\frac{\\partial T}{\\partial r} + g^{r\\theta}\\frac{\\partial T}{\\partial \\theta} + g^{r\\phi}\\frac{\\partial T}{\\partial \\phi} \\right) = -k g^{rr} \\frac{\\partial T}{\\partial r}$$\n代入 $g^{rr}=1$ 和 $T$ 的导数：\n$$q^r = -k (1) \\left(-\\frac{C}{r^2}\\right) = \\frac{kC}{r^2}$$\n其他逆变分量 $q^\\theta$ 和 $q^\\phi$ 为零，因为 $\\frac{\\partial T}{\\partial \\theta}$ 和 $\\frac{\\partial T}{\\partial \\phi}$ 为零。因此，唯一的非零分量是 $q^r = \\frac{kC}{r^2}$ 和 $q_r = \\frac{kC}{r^2}$。\n\n**步骤 4：物理单位的解释**\n\n令 $[X]$ 表示物理量 $X$ 的单位。坐标的单位是 $[r]=\\mathrm{m}$ 和 $[\\theta]=[\\phi]=\\mathrm{rad}$（无量纲）。位置矢量的单位是 $[\\boldsymbol{r}]=\\mathrm{m}$。\n- **协变基矢量 $\\boldsymbol{g}_i = \\frac{\\partial \\boldsymbol{r}}{\\partial q^i}$**:\n  - $[\\boldsymbol{g}_r] = [\\frac{\\partial \\boldsymbol{r}}{\\partial r}] = \\frac{[\\boldsymbol{r}]}{[r]} = \\frac{\\mathrm{m}}{\\mathrm{m}}$，所以它是无量纲的。\n  - $[\\boldsymbol{g}_\\theta] = [\\frac{\\partial \\boldsymbol{r}}{\\partial \\theta}] = \\frac{[\\boldsymbol{r}]}{[\\theta]} = \\frac{\\mathrm{m}}{\\mathrm{rad}} = \\mathrm{m}$。\n  - $[\\boldsymbol{g}_\\phi] = [\\frac{\\partial \\boldsymbol{r}}{\\partial \\phi}] = \\frac{[\\boldsymbol{r}]}{[\\phi]} = \\frac{\\mathrm{m}}{\\mathrm{rad}} = \\mathrm{m}$。\n- **逆变基矢量 $\\boldsymbol{g}^i$**: 从 $\\boldsymbol{g}_i \\cdot \\boldsymbol{g}^j = \\delta_i^j$（无量纲）可知，$[\\boldsymbol{g}^i] = 1/[\\boldsymbol{g}_i]$。\n  - $[\\boldsymbol{g}^r] = 1/[\\boldsymbol{g}_r]$ 是无量纲的。\n  - $[\\boldsymbol{g}^\\theta] = 1/[\\boldsymbol{g}_\\theta] = \\mathrm{m}^{-1}$。\n  - $[\\boldsymbol{g}^\\phi] = 1/[\\boldsymbol{g}_\\phi] = \\mathrm{m}^{-1}$。\n- 物理热通量矢量 $\\boldsymbol{q}$ 的单位是功率每面积，即 $[\\boldsymbol{q}] = \\mathrm{W \\, m^{-2}}$。\n- **协变分量 $q_i = \\boldsymbol{q} \\cdot \\boldsymbol{g}_i$**:\n  - $[q_r] = [\\boldsymbol{q}][\\boldsymbol{g}_r] = (\\mathrm{W \\, m^{-2}})(1) = \\mathrm{W \\, m^{-2}}$。\n  - $[q_\\theta] = [\\boldsymbol{q}][\\boldsymbol{g}_\\theta] = (\\mathrm{W \\, m^{-2}})(\\mathrm{m}) = \\mathrm{W \\, m^{-1}}$。\n  - $[q_\\phi] = [\\boldsymbol{q}][\\boldsymbol{g}_\\phi] = (\\mathrm{W \\, m^{-2}})(\\mathrm{m}) = \\mathrm{W \\, m^{-1}}$。\n- **逆变分量 $q^i = \\boldsymbol{q} \\cdot \\boldsymbol{g}^i$**:\n  - $[q^r] = [\\boldsymbol{q}][\\boldsymbol{g}^r] = (\\mathrm{W \\, m^{-2}})(1) = \\mathrm{W \\, m^{-2}}$。\n  - $[q^\\theta] = [\\boldsymbol{q}][\\boldsymbol{g}^\\theta] = (\\mathrm{W \\, m^{-2}})(\\mathrm{m}^{-1}) = \\mathrm{W \\, m^{-3}}$。\n  - $[q^\\phi] = [\\boldsymbol{q}][\\boldsymbol{g}^\\phi] = (\\mathrm{W \\, m^{-2}})(\\mathrm{m}^{-1}) = \\mathrm{W \\, m^{-3}}$。\n\n物理热通量矢量为 $\\boldsymbol{q} = q^r \\boldsymbol{g}_r$。其大小为 $||\\boldsymbol{q}|| = ||q^r \\boldsymbol{g}_r|| = |q^r| ||\\boldsymbol{g}_r||$。由于 $||\\boldsymbol{g}_r|| = \\sqrt{g_{rr}} = 1$，热通量的物理大小为 $|q^r| = \\frac{|kC|}{r^2}$，其单位为 $\\mathrm{W \\, m^{-2}}$，这与分析一致。\n\n非零分量的最终结果是：\n$q^r = \\frac{kC}{r^2}$\n$q_r = \\frac{kC}{r^2}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{kC}{r^{2}} & \\frac{kC}{r^{2}} \\end{pmatrix} } $$"
        },
        {
            "introduction": "从正交坐标系（如球坐标）过渡到更普遍的非正交坐标系，是计算热工学中的关键一步，因为现实世界的几何形状往往需要非正交网格。本练习将引导您分析一个非正交剪切变换，从头推导度量张量，并揭示其非对角项如何直接影响物理守恒定律（如热通量散度）的数学形式。通过这个过程，您将深刻理解度量张量是如何捕捉局部坐标系的几何特性，以及非正交性如何引入必须在离散方程中精确处理的混合导数项 。",
            "id": "3945586",
            "problem": "考虑一个在三维欧几里得空间中由非正交剪切变换 $x=\\xi$，$y=\\eta+\\alpha\\xi$，$z=\\zeta$ 定义的曲线坐标映射，其中 $(x,y,z)$ 是笛卡尔坐标，$(\\xi,\\eta,\\zeta)$ 是曲线坐标，$\\alpha$ 是一个恒定的剪切参数。\n\n从适用于计算热工学的第一性原理出发，执行以下操作：\n\n1. 使用协变基向量的定义 $ \\mathbf{a}_{i}=\\partial \\mathbf{r}/\\partial \\xi^{i}$，其中 $\\mathbf{r}=(x,y,z)$ 且 $\\xi^{1}=\\xi$，$\\xi^{2}=\\eta$，$\\xi^{3}=\\zeta$，计算度规张量分量 $g_{ij}=\\mathbf{a}_{i}\\cdot \\mathbf{a}_{j}$。\n\n2. 从梯度的定义性质出发，即对于任意标量场 $T(\\xi,\\eta,\\zeta)$ 和任意方向 $\\mathbf{v}$，方向导数满足 $\\nabla T\\cdot \\mathbf{v}=\\lim_{\\epsilon\\to 0}[T(\\mathbf{r}+\\epsilon \\mathbf{v})-T(\\mathbf{r})]/\\epsilon$，推导 $\\nabla T$ 关于曲线坐标导数 $\\partial T/\\partial \\xi^{i}$ 和您所构建的坐标系的几何对象的表达式（不要假设正交性）。\n\n3. 从具有各向同性导热系数 $k$ 的稳态传导的局部能量守恒定律出发，并对一个无穷小曲线控制体应用散度定理，推导热通量矢量 $\\mathbf{q}=-k \\nabla T$ 在 $(\\xi,\\eta,\\zeta)$ 坐标系中的散度。明确展示度规的非对角项如何影响混合导数项的出现。\n\n4. 设 $k=12$（$k$ 的单位为瓦特每米开尔文），$\\alpha=0.3$，温度场为 $T(\\xi,\\eta,\\zeta)=\\xi^2+2\\xi\\eta+3\\eta^2+4\\zeta^2$。计算在点 $(\\xi,\\eta,\\zeta)=(1,-1,0.5)$ 处的热通量散度 $\\nabla\\cdot \\mathbf{q}$。将您的答案四舍五入到四位有效数字。最终结果以瓦特每立方米表示。\n\n您的最终答案必须是一个实数值。",
            "solution": "该问题被验证为有科学依据、适定、客观和完整的。所有必要信息均已提供，且任务是张量微积分应用于连续介质力学中的标准程序。我们分四部分进行求解。\n\n### 第1部分：度规张量的计算\n\n笛卡尔坐标 $(x, y, z)$ 中的位置矢量 $\\mathbf{r}$ 由 $\\mathbf{r} = x\\mathbf{i} + y\\mathbf{j} + z\\mathbf{k}$ 给出。\n曲线坐标变换由下式给出：\n$$x = \\xi$$\n$$y = \\eta + \\alpha \\xi$$\n$$z = \\zeta$$\n此处，$(\\xi, \\eta, \\zeta)$ 是曲线坐标，分别对应于 $\\xi^1, \\xi^2, \\xi^3$。将这些代入位置矢量可得：\n$$\\mathbf{r}(\\xi, \\eta, \\zeta) = \\xi\\mathbf{i} + (\\eta + \\alpha \\xi)\\mathbf{j} + \\zeta\\mathbf{k}$$\n协变基向量 $\\mathbf{a}_i$ 定义为 $\\mathbf{a}_i = \\frac{\\partial \\mathbf{r}}{\\partial \\xi^i}$。我们如下计算它们：\n$$\\mathbf{a}_1 = \\frac{\\partial \\mathbf{r}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi\\mathbf{i} + (\\eta + \\alpha \\xi)\\mathbf{j} + \\zeta\\mathbf{k}) = \\mathbf{i} + \\alpha\\mathbf{j}$$\n$$\\mathbf{a}_2 = \\frac{\\partial \\mathbf{r}}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi\\mathbf{i} + (\\eta + \\alpha \\xi)\\mathbf{j} + \\zeta\\mathbf{k}) = \\mathbf{j}$$\n$$\\mathbf{a}_3 = \\frac{\\partial \\mathbf{r}}{\\partial \\zeta} = \\frac{\\partial}{\\partial \\zeta}(\\xi\\mathbf{i} + (\\eta + \\alpha \\xi)\\mathbf{j} + \\zeta\\mathbf{k}) = \\mathbf{k}$$\n度规张量分量 $g_{ij}$ 由协变基向量的点积定义：$g_{ij} = \\mathbf{a}_i \\cdot \\mathbf{a}_j$。\n$$g_{11} = \\mathbf{a}_1 \\cdot \\mathbf{a}_1 = (\\mathbf{i} + \\alpha\\mathbf{j}) \\cdot (\\mathbf{i} + \\alpha\\mathbf{j}) = 1 + \\alpha^2$$\n$$g_{12} = \\mathbf{a}_1 \\cdot \\mathbf{a}_2 = (\\mathbf{i} + \\alpha\\mathbf{j}) \\cdot \\mathbf{j} = \\alpha$$\n$$g_{13} = \\mathbf{a}_1 \\cdot \\mathbf{a}_3 = (\\mathbf{i} + \\alpha\\mathbf{j}) \\cdot \\mathbf{k} = 0$$\n$$g_{21} = \\mathbf{a}_2 \\cdot \\mathbf{a}_1 = \\mathbf{j} \\cdot (\\mathbf{i} + \\alpha\\mathbf{j}) = \\alpha$$\n$$g_{22} = \\mathbf{a}_2 \\cdot \\mathbf{a}_2 = \\mathbf{j} \\cdot \\mathbf{j} = 1$$\n$$g_{23} = \\mathbf{a}_2 \\cdot \\mathbf{a}_3 = \\mathbf{j} \\cdot \\mathbf{k} = 0$$\n$$g_{31} = \\mathbf{a}_3 \\cdot \\mathbf{a}_1 = \\mathbf{k} \\cdot (\\mathbf{i} + \\alpha\\mathbf{j}) = 0$$\n$$g_{32} = \\mathbf{a}_3 \\cdot \\mathbf{a}_2 = \\mathbf{k} \\cdot \\mathbf{j} = 0$$\n$$g_{33} = \\mathbf{a}_3 \\cdot \\mathbf{a}_3 = \\mathbf{k} \\cdot \\mathbf{k} = 1$$\n将这些分量组合成一个矩阵，度规张量为：\n$$g_{ij} = \\begin{pmatrix} 1+\\alpha^2  & \\alpha & 0 \\\\ \\alpha & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n\n### 第2部分：梯度表达式的推导\n\n标量场 $T$ 在矢量 $\\mathbf{v}$ 方向上的方向导数定义为 $\\nabla T \\cdot \\mathbf{v}$。问题将此定义以极限形式给出。利用多变量链式法则，这也可以用曲线坐标来表示。设曲线由 $\\epsilon$ 参数化，使得 $\\mathbf{r}(\\epsilon) = \\mathbf{r}(0) + \\epsilon \\mathbf{v}$。方向导数是 $\\frac{d}{d\\epsilon} T(\\mathbf{r}(\\epsilon))|_{\\epsilon=0}$。\n根据链式法则：\n$$\\frac{dT}{d\\epsilon} = \\frac{\\partial T}{\\partial \\xi^i} \\frac{d\\xi^i}{d\\epsilon}$$\n矢量 $\\mathbf{v}$ 可以表示为 $\\mathbf{v} = \\frac{d\\mathbf{r}}{d\\epsilon} = \\frac{\\partial \\mathbf{r}}{\\partial \\xi^i} \\frac{d\\xi^i}{d\\epsilon} = \\mathbf{a}_i v^i$，其中 $v^i = \\frac{d\\xi^i}{d\\epsilon}$ 是 $\\mathbf{v}$ 的逆变分量。\n因此，方向导数为 $\\nabla T \\cdot \\mathbf{v} = \\frac{\\partial T}{\\partial \\xi^i} v^i$。\n代入 $\\mathbf{v}$ 的展开式可得：\n$$\\nabla T \\cdot (\\mathbf{a}_j v^j) = (\\nabla T \\cdot \\mathbf{a}_j) v^j = \\frac{\\partial T}{\\partial \\xi^i} v^i$$\n由于此等式对任意矢量 $\\mathbf{v}$（即对任意分量 $v^j$）都必须成立，我们可以令 $v^i$ 的系数相等：\n$$\\nabla T \\cdot \\mathbf{a}_i = \\frac{\\partial T}{\\partial \\xi^i}$$\n此方程给出了梯度矢量的协变分量。为了求得梯度矢量本身，我们将其在逆变基 $\\mathbf{a}^j$ 中表示，该基由性质 $\\mathbf{a}^i \\cdot \\mathbf{a}_j = \\delta^i_j$（克罗内克δ）定义。设 $\\nabla T = C_j \\mathbf{a}^j$。与 $\\mathbf{a}_i$ 作点积：\n$$(\\nabla T) \\cdot \\mathbf{a}_i = (C_j \\mathbf{a}^j) \\cdot \\mathbf{a}_i = C_j (\\mathbf{a}^j \\cdot \\mathbf{a}_i) = C_j \\delta^j_i = C_i$$\n将此与前面的结果比较，我们确定系数为 $C_i = \\frac{\\partial T}{\\partial \\xi^i}$。\n因此，用导数和几何对象（基向量）表示的梯度表达式为：\n$$\\nabla T = \\mathbf{a}^i \\frac{\\partial T}{\\partial \\xi^i}$$\n这也可以用度规张量来关联逆变和协变基向量（$\\mathbf{a}^i = g^{ij}\\mathbf{a}_j$）来写成：\n$$\\nabla T = g^{ij} \\frac{\\partial T}{\\partial \\xi^i} \\mathbf{a}_j$$\n\n### 第3部分：热通量散度的推导\n\n在一般曲线坐标中，矢量场 $\\mathbf{F}$ 的散度由 $\\nabla \\cdot \\mathbf{F} = \\frac{1}{\\sqrt{g}} \\frac{\\partial}{\\partial \\xi^i}(\\sqrt{g} F^i)$ 给出，其中 $F^i$ 是 $\\mathbf{F}$ 的逆变分量，$g$ 是度规张量的行列式。此公式可以通过将散度定理 $\\int_V \\nabla\\cdot\\mathbf{F} dV = \\oint_S \\mathbf{F}\\cdot d\\mathbf{S}$ 应用于无穷小体积元 $dV = \\sqrt{g} d\\xi^1 d\\xi^2 d\\xi^3$ 来推导。\n\n热通量矢量为 $\\mathbf{q} = -k \\nabla T$。利用第2部分的结果：\n$$\\mathbf{q} = -k \\left( \\mathbf{a}^j \\frac{\\partial T}{\\partial \\xi^j} \\right) = -k \\left( g^{ij}\\mathbf{a}_i \\frac{\\partial T}{\\partial \\xi^j} \\right)$$\n$\\mathbf{q}$ 的逆变分量，记为 $q^i$，是协变基向量 $\\mathbf{a}_i$ 的系数。通过重新索引，我们有 $\\mathbf{q} = q^i \\mathbf{a}_i$，因此：\n$$q^i = -k g^{ij} \\frac{\\partial T}{\\partial \\xi^j}$$\n将此代入散度公式：\n$$\\nabla \\cdot \\mathbf{q} = \\frac{1}{\\sqrt{g}} \\frac{\\partial}{\\partial \\xi^i} \\left( \\sqrt{g} \\left( -k g^{ij} \\frac{\\partial T}{\\partial \\xi^j} \\right) \\right)$$\n对于各向同性材料，$k$ 是常数。公式变为：\n$$\\nabla \\cdot \\mathbf{q} = -k \\frac{1}{\\sqrt{g}} \\frac{\\partial}{\\partial \\xi^i} \\left( \\sqrt{g} g^{ij} \\frac{\\partial T}{\\partial \\xi^j} \\right)$$\n对于我们特定的坐标系，$g_{ij}$ 的行列式是 $g = \\det(g_{ij}) = (1+\\alpha^2)(1) - (\\alpha)(\\alpha) = 1$。因此，$\\sqrt{g}=1$。公式简化为：\n$$\\nabla \\cdot \\mathbf{q} = -k \\frac{\\partial}{\\partial \\xi^i} \\left( g^{ij} \\frac{\\partial T}{\\partial \\xi^j} \\right)$$\n我们需要逆度规张量 $g^{ij} = (g_{ij})^{-1}$。\n$$g^{ij} = \\begin{pmatrix} 1+\\alpha^2  & \\alpha & 0 \\\\ \\alpha & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}^{-1} = \\frac{1}{1} \\begin{pmatrix} 1 & -\\alpha & 0 \\\\ -\\alpha & 1+\\alpha^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & -\\alpha & 0 \\\\ -\\alpha & 1+\\alpha^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n现在我们通过对 $i$ 和 $j$ 求和来展开散度表达式：\n$$\\nabla \\cdot \\mathbf{q} = -k \\left[ \\frac{\\partial}{\\partial \\xi}\\left(g^{1j}\\frac{\\partial T}{\\partial \\xi^j}\\right) + \\frac{\\partial}{\\partial \\eta}\\left(g^{2j}\\frac{\\partial T}{\\partial \\xi^j}\\right) + \\frac{\\partial}{\\partial \\zeta}\\left(g^{3j}\\frac{\\partial T}{\\partial \\xi^j}\\right) \\right]$$\n括号中的项是：\n$$g^{1j}\\frac{\\partial T}{\\partial \\xi^j} = g^{11}\\frac{\\partial T}{\\partial \\xi} + g^{12}\\frac{\\partial T}{\\partial \\eta} = \\frac{\\partial T}{\\partial \\xi} - \\alpha\\frac{\\partial T}{\\partial \\eta}$$\n$$g^{2j}\\frac{\\partial T}{\\partial \\xi^j} = g^{21}\\frac{\\partial T}{\\partial \\xi} + g^{22}\\frac{\\partial T}{\\partial \\eta} = -\\alpha\\frac{\\partial T}{\\partial \\xi} + (1+\\alpha^2)\\frac{\\partial T}{\\partial \\eta}$$\n$$g^{3j}\\frac{\\partial T}{\\partial \\xi^j} = g^{33}\\frac{\\partial T}{\\partial \\zeta} = \\frac{\\partial T}{\\partial \\zeta}$$\n将这些代回并进行外层微分（假设 $T$ 是 $C^2$ 连续的，因此混合偏导数相等）：\n$$\\nabla \\cdot \\mathbf{q} = -k \\left[ \\frac{\\partial}{\\partial \\xi}\\left(\\frac{\\partial T}{\\partial \\xi} - \\alpha\\frac{\\partial T}{\\partial \\eta}\\right) + \\frac{\\partial}{\\partial \\eta}\\left(-\\alpha\\frac{\\partial T}{\\partial \\xi} + (1+\\alpha^2)\\frac{\\partial T}{\\partial \\eta}\\right) + \\frac{\\partial}{\\partial \\zeta}\\left(\\frac{\\partial T}{\\partial \\zeta}\\right) \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -k \\left[ \\left(\\frac{\\partial^2 T}{\\partial \\xi^2} - \\alpha\\frac{\\partial^2 T}{\\partial \\xi \\partial \\eta}\\right) + \\left(-\\alpha\\frac{\\partial^2 T}{\\partial \\eta \\partial \\xi} + (1+\\alpha^2)\\frac{\\partial^2 T}{\\partial \\eta^2}\\right) + \\frac{\\partial^2 T}{\\partial \\zeta^2} \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -k \\left[ \\frac{\\partial^2 T}{\\partial \\xi^2} - 2\\alpha\\frac{\\partial^2 T}{\\partial \\xi \\partial \\eta} + (1+\\alpha^2)\\frac{\\partial^2 T}{\\partial \\eta^2} + \\frac{\\partial^2 T}{\\partial \\zeta^2} \\right]$$\n非零的非对角度规分量，$g_{12}=\\alpha$ 和 $g^{12}=-\\alpha$，明确地引入了混合导数项 $-2\\alpha \\partial^2 T / (\\partial\\xi\\partial\\eta)$，这表明了非正交性如何在物理守恒定律中耦合空间导数。\n\n### 第4部分：数值计算\n\n给定 $k=12$，$\\alpha=0.3$，以及温度场 $T(\\xi,\\eta,\\zeta)=\\xi^2+2\\xi\\eta+3\\eta^2+4\\zeta^2$。我们必须计算在点 $(\\xi,\\eta,\\zeta)=(1,-1,0.5)$ 处的 $\\nabla\\cdot \\mathbf{q}$。\n首先，我们计算 $T$ 所需的二阶偏导数：\n$$\\frac{\\partial T}{\\partial \\xi} = 2\\xi + 2\\eta \\quad \\implies \\quad \\frac{\\partial^2 T}{\\partial \\xi^2} = 2$$\n$$\\frac{\\partial T}{\\partial \\eta} = 2\\xi + 6\\eta \\quad \\implies \\quad \\frac{\\partial^2 T}{\\partial \\eta^2} = 6$$\n$$\\frac{\\partial T}{\\partial \\zeta} = 8\\zeta \\quad \\implies \\quad \\frac{\\partial^2 T}{\\partial \\zeta^2} = 8$$\n$$\\frac{\\partial^2 T}{\\partial \\xi \\partial \\eta} = \\frac{\\partial}{\\partial \\xi}(2\\xi + 6\\eta) = 2$$\n所有二阶导数都是常数，因此它们的值与点 $(1, -1, 0.5)$ 无关。\n现在我们将这些值代入 $\\nabla \\cdot \\mathbf{q}$ 的表达式中：\n$$\\nabla \\cdot \\mathbf{q} = -k \\left[ \\frac{\\partial^2 T}{\\partial \\xi^2} - 2\\alpha\\frac{\\partial^2 T}{\\partial \\xi \\partial \\eta} + (1+\\alpha^2)\\frac{\\partial^2 T}{\\partial \\eta^2} + \\frac{\\partial^2 T}{\\partial \\zeta^2} \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -12 \\left[ 2 - 2(0.3)(2) + (1+(0.3)^2)(6) + 8 \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -12 \\left[ 2 - 1.2 + (1+0.09)(6) + 8 \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -12 \\left[ 0.8 + (1.09)(6) + 8 \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -12 \\left[ 0.8 + 6.54 + 8 \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -12 \\left[ 15.34 \\right]$$\n$$\\nabla \\cdot \\mathbf{q} = -184.08$$\n问题要求将答案四舍五入到四位有效数字。单位是瓦特每立方米，W/m$^3$。\n$$\\nabla \\cdot \\mathbf{q} \\approx -184.1$$",
            "answer": "$$\n\\boxed{-184.1}\n$$"
        },
        {
            "introduction": "将连续的数学理论转化为离散的计算实践，是计算工程领域的核心技能。本练习将理论与代码相结合，要求您在贴体坐标系下实现一个实际工程问题中常见的罗宾边界条件。您将推导如何利用标度因子（scale factors）将物理法向导数与坐标导数联系起来，并将其应用于一个具体的椭圆坐标系中。这项实践不仅巩固了您对曲线坐标变换的理论理解，还提供了将抽象概念转化为具体数值算法的宝贵经验 。",
            "id": "3945618",
            "problem": "在一个曲线贴体网格上，提出了一个稳态的二维传导问题。边界是由共焦椭圆表示的光滑闭合曲线。考虑正交曲线坐标 $\\left(\\mu,\\nu\\right)$，其通过一个光滑、可逆的变换映射到笛卡尔坐标 $\\left(x,y\\right)$。导热通量矢量由傅里叶定律给出：$\\boldsymbol{q} = -k \\nabla T$，其中 $k$ 是热导率，$T$ 是温度场。与环境对流的罗宾边界条件 (RBC) 在边界上定义为 $-k \\frac{\\partial T}{\\partial n} = h \\left(T - T_{\\infty}\\right)$，其中 $\\frac{\\partial T}{\\partial n}$ 表示外法向导数，$h$ 是对流系数，$T_{\\infty}$ 是环境温度。\n\n从梯度和坐标变换雅可比矩阵的基本定义出发，推导出一个与坐标曲面对齐的边界上，以外法向导数 $\\frac{\\partial T}{\\partial n}$ 关于坐标导数和尺度因子的表达式。然后，使用贴体网格实现 $\\frac{\\partial T}{\\partial n}$ 的单边有限差分近似。\n\n要使用的特定正交曲线坐标系是共焦椭圆坐标系，由以下映射隐式定义：\n$$\nx(\\mu,\\nu) = c \\cosh\\mu \\cos\\nu,\\quad\ny(\\mu,\\nu) = c \\sinh\\mu \\sin\\nu,\n$$\n其中 $c$ 是焦距参数，$\\mu \\ge 0$ 且 $\\nu \\in [0,2\\pi)$（角度以弧度为单位）。边界是由给定 $\\mu_0$ 的曲面 $\\mu = \\mu_0$ 所表示的椭圆。假设 $\\mu$ 的增加方向是从物体指向外部，因此边界处的外法向单位矢量与 $\\mu$ 方向对齐。\n\n在边界上，使用 $\\mu$ 方向的一阶单边差分来近似法向导数：\n$$\n\\left.\\frac{\\partial T}{\\partial \\mu}\\right|_{\\mu=\\mu_0,\\nu} \\approx \\frac{T(\\mu_0+\\Delta\\mu,\\nu) - T(\\mu_0,\\nu)}{\\Delta\\mu},\n$$\n并使用适当的尺度因子将此坐标导数转换为物理法向导数。用 $[0,2\\pi)$ 上的 $N_\\nu$ 个点对边界进行均匀网格离散化。\n\n对于下面的每个测试用例，计算：\n- 沿边界平均的边界法向导热通量大小，\n$$\n\\overline{\\left|q''\\right|} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\left| -k \\frac{\\partial T}{\\partial n}(\\nu)\\right| \\,\\mathrm{d}\\nu,\n$$\n通过在离散 $\\nu$ 网格上的均匀平均来近似。\n- 罗宾边界条件的点态残差的均方根 (RMS)，\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\left( -k \\frac{\\partial T}{\\partial n}(\\nu) - h \\left( T(\\mu_0,\\nu) - T_{\\infty}\\right) \\right)^2 \\,\\mathrm{d}\\nu},\n$$\n也通过在离散 $\\nu$ 网格上的均匀离散平均来近似。\n\n将这两个量的最终答案以瓦特每平方米 $\\left(\\mathrm{W}/\\mathrm{m}^2\\right)$ 为单位，表示为十进制数。\n\n使用以下测试套件。为便于验证，温度场被指定为 $\\left(\\mu,\\nu\\right)$ 的解析函数：\n1. 测试用例 1 (正常情况): $c = 0.4$ $\\mathrm{m}$，$\\mu_0 = 1.0$，$\\Delta\\mu = 1\\times 10^{-3}$，$N_\\nu = 256$，$k = 15$ $\\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$，$h = 50$ $\\mathrm{W}/\\mathrm{m}^2\\cdot\\mathrm{K}$，$T_{\\infty} = 300$ $\\mathrm{K}$，以及 $T(\\mu,\\nu) = T_{\\infty} + A \\cos\\nu \\cosh\\mu$，振幅 $A = 10$ $\\mathrm{K}$。\n2. 测试用例 2 (无对流的边界条件边界情况): $c = 0.2$ $\\mathrm{m}$，$\\mu_0 = 0.2$，$\\Delta\\mu = 1\\times 10^{-4}$，$N_\\nu = 512$，$k = 200$ $\\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$，$h = 0$ $\\mathrm{W}/\\mathrm{m}^2\\cdot\\mathrm{K}$，$T_{\\infty} = 300$ $\\mathrm{K}$，以及 $T(\\mu,\\nu) = T_{\\infty} + A \\cos\\nu \\cosh\\mu$，振幅 $A = 5$ $\\mathrm{K}$。\n3. 测试用例 3 (强对流，不同角向模态): $c = 0.6$ $\\mathrm{m}$，$\\mu_0 = 1.5$，$\\Delta\\mu = 2\\times 10^{-3}$，$N_\\nu = 128$，$k = 1$ $\\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$，$h = 1000$ $\\mathrm{W}/\\mathrm{m}^2\\cdot\\mathrm{K}$，$T_{\\infty} = 300$ $\\mathrm{K}$，以及 $T(\\mu,\\nu) = T_{\\infty} + A \\sin(3\\nu) \\cosh\\mu$，振幅 $A = 2$ $\\mathrm{K}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个形如 $\\left[\\overline{\\left|q''\\right|},\\mathrm{RMS}\\right]$ 的子列表。例如，格式应类似于 $\\left[[q_1,r_1],[q_2,r_2],[q_3,r_3]\\right]$，其中每个 $q_i$ 和 $r_i$ 都是以 $\\mathrm{W}/\\mathrm{m}^2$ 为单位的十进制数。",
            "solution": "该问题要求计算与曲线边界上的传热相关的两个度量：平均法向热通量大小和罗宾边界条件的均方根 (RMS) 残差。这将通过首先在指定的正交曲线坐标系中推导温度场法向导数 $\\frac{\\partial T}{\\partial n}$ 的表达式，然后基于有限差分格式实现数值近似来完成。\n\n此分析的基础是标量场梯度与其在曲线坐标系中导数之间的关系。在一般的正交三维坐标系 $(\\xi_1, \\xi_2, \\xi_3)$ 中，标量函数 $T$ 的梯度由下式给出：\n$$\n\\nabla T = \\frac{1}{h_1} \\frac{\\partial T}{\\partial \\xi_1} \\hat{e}_1 + \\frac{1}{h_2} \\frac{\\partial T}{\\partial \\xi_2} \\hat{e}_2 + \\frac{1}{h_3} \\frac{\\partial T}{\\partial \\xi_3} \\hat{e}_3\n$$\n其中 $h_i$ 是尺度因子，$\\hat{e}_i$ 是对应于坐标 $\\xi_i$ 的标准正交基向量。对于当前处理的二维问题，我们使用正交坐标 $(\\mu, \\nu)$，因此梯度变为：\n$$\n\\nabla T = \\frac{1}{h_\\mu} \\frac{\\partial T}{\\partial \\mu} \\hat{e}_\\mu + \\frac{1}{h_\\nu} \\frac{\\partial T}{\\partial \\nu} \\hat{e}_\\nu\n$$\n外法向导数 $\\frac{\\partial T}{\\partial n}$ 定义为 $T$ 在外法向单位矢量 $\\hat{n}$ 方向上的方向导数，数学上表示为 $\\frac{\\partial T}{\\partial n} = \\nabla T \\cdot \\hat{n}$。\n\n问题指出，边界是常数 $\\mu$ 的曲面，特别是 $\\mu = \\mu_0$，并且 $\\mu$ 增加的方向对应于向外的方向。因此，外法向单位矢量 $\\hat{n}$ 与基矢量 $\\hat{e}_\\mu$ 相同。于是法向导数为：\n$$\n\\frac{\\partial T}{\\partial n} = \\left( \\frac{1}{h_\\mu} \\frac{\\partial T}{\\partial \\mu} \\hat{e}_\\mu + \\frac{1}{h_\\nu} \\frac{\\partial T}{\\partial \\nu} \\hat{e}_\\nu \\right) \\cdot \\hat{e}_\\mu\n$$\n由于坐标系的正交性，我们有 $\\hat{e}_\\mu \\cdot \\hat{e}_\\mu = 1$ 和 $\\hat{e}_\\mu \\cdot \\hat{e}_\\nu = 0$。这将法向导数的表达式简化为：\n$$\n\\frac{\\partial T}{\\partial n} = \\frac{1}{h_\\mu} \\frac{\\partial T}{\\partial \\mu}\n$$\n这个基本结果表明，物理法向导数是在法向方向上的坐标导数，按相应尺度因子的倒数进行缩放。\n\n接下来，我们必须确定给定共焦椭圆坐标系的尺度因子 $h_\\mu$。从椭圆坐标 $(\\mu, \\nu)$ 到笛卡尔坐标 $(x,y)$ 的变换由下式给出：\n$$\nx(\\mu,\\nu) = c \\cosh\\mu \\cos\\nu\n$$\n$$\ny(\\mu,\\nu) = c \\sinh\\mu \\sin\\nu\n$$\n位置矢量为 $\\boldsymbol{r}(\\mu, \\nu) = x(\\mu, \\nu) \\hat{i} + y(\\mu, \\nu) \\hat{j}$。尺度因子是位置矢量关于坐标的偏导数的模长：$h_\\mu = \\left|\\frac{\\partial\\boldsymbol{r}}{\\partial\\mu}\\right|$ 和 $h_\\nu = \\left|\\frac{\\partial\\boldsymbol{r}}{\\partial\\nu}\\right|$。\n\n首先，我们计算偏导数矢量：\n$$\n\\frac{\\partial\\boldsymbol{r}}{\\partial\\mu} = \\frac{\\partial x}{\\partial\\mu}\\hat{i} + \\frac{\\partial y}{\\partial\\mu}\\hat{j} = (c \\sinh\\mu \\cos\\nu)\\hat{i} + (c \\cosh\\mu \\sin\\nu)\\hat{j}\n$$\n$$\n\\frac{\\partial\\boldsymbol{r}}{\\partial\\nu} = \\frac{\\partial x}{\\partial\\nu}\\hat{i} + \\frac{\\partial y}{\\partial\\nu}\\hat{j} = (-c \\cosh\\mu \\sin\\nu)\\hat{i} + (c \\sinh\\mu \\cos\\nu)\\hat{j}\n$$\n作为正交性的验证，它们的点积是：\n$$\n\\frac{\\partial\\boldsymbol{r}}{\\partial\\mu} \\cdot \\frac{\\partial\\boldsymbol{r}}{\\partial\\nu} = (c \\sinh\\mu \\cos\\nu)(-c \\cosh\\mu \\sin\\nu) + (c \\cosh\\mu \\sin\\nu)(c \\sinh\\mu \\cos\\nu) = 0\n$$\n这证实了坐标系是正交的。现在，我们计算第一个导数矢量的模长平方以求得 $h_\\mu^2$：\n$$\nh_\\mu^2 = \\left|\\frac{\\partial\\boldsymbol{r}}{\\partial\\mu}\\right|^2 = (c \\sinh\\mu \\cos\\nu)^2 + (c \\cosh\\mu \\sin\\nu)^2 = c^2 (\\sinh^2\\mu \\cos^2\\nu + \\cosh^2\\mu \\sin^2\\nu)\n$$\n使用双曲恒等式 $\\cosh^2\\mu = 1 + \\sinh^2\\mu$：\n$$\nh_\\mu^2 = c^2 (\\sinh^2\\mu \\cos^2\\nu + (1+\\sinh^2\\mu)\\sin^2\\nu) = c^2 (\\sinh^2\\mu \\cos^2\\nu + \\sin^2\\nu + \\sinh^2\\mu \\sin^2\\nu)\n$$\n使用三角恒等式 $\\cos^2\\nu + \\sin^2\\nu = 1$：\n$$\nh_\\mu^2 = c^2 (\\sinh^2\\mu (\\cos^2\\nu + \\sin^2\\nu) + \\sin^2\\nu) = c^2 (\\sinh^2\\mu + \\sin^2\\nu)\n$$\n因此，在任意点 $(\\mu, \\nu)$ 的尺度因子 $h_\\mu$ 是：\n$$\nh_\\mu(\\mu, \\nu) = c \\sqrt{\\sinh^2\\mu + \\sin^2\\nu}\n$$\n（类似的计算表明 $h_\\nu = h_\\mu$）。\n\n结合这些结果，边界曲面 $\\mu=\\mu_0$ 上的物理法向导数为：\n$$\n\\left.\\frac{\\partial T}{\\partial n}\\right|_{\\mu_0,\\nu} = \\frac{1}{c \\sqrt{\\sinh^2\\mu_0 + \\sin^2\\nu}} \\left. \\frac{\\partial T}{\\partial \\mu} \\right|_{\\mu_0,\\nu}\n$$\n问题指定了坐标导数的一阶单边有限差分近似：\n$$\n\\left. \\frac{\\partial T}{\\partial \\mu} \\right|_{\\mu_0,\\nu} \\approx \\frac{T(\\mu_0+\\Delta\\mu, \\nu) - T(\\mu_0, \\nu)}{\\Delta\\mu}\n$$\n将此代入我们的表达式，得到边界上每个离散点 $\\nu_j$ 处法向导数的数值近似：\n$$\n\\left.\\frac{\\partial T}{\\partial n}\\right|_j \\approx \\frac{1}{c \\sqrt{\\sinh^2\\mu_0 + \\sin^2\\nu_j}} \\left( \\frac{T(\\mu_0+\\Delta\\mu, \\nu_j) - T(\\mu_0, \\nu_j)}{\\Delta\\mu} \\right)\n$$\n边界法向导热通量由傅里叶定律给出，$q'' = -k \\frac{\\partial T}{\\partial n}$。我们现在可以计算所需的量。\n\n1. 平均边界法向导热通量大小，$\\overline{|q''|}$：\n该积分通过对 $N_\\nu$ 个离散点的均值来近似：\n$$\n\\overline{|q''|} \\approx \\frac{1}{N_\\nu} \\sum_{j=0}^{N_\\nu-1} \\left| -k \\left.\\frac{\\partial T}{\\partial n}\\right|_j \\right|\n$$\n\n2. 罗宾边界条件的 RMS 点态残差：\n每个点的残差为 $R_j = -k \\left.\\frac{\\partial T}{\\partial n}\\right|_j - h \\left( T(\\mu_0, \\nu_j) - T_{\\infty}\\right)$。RMS 残差同样通过离散平均来近似：\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N_\\nu} \\sum_{j=0}^{N_\\nu-1} R_j^2}\n$$\n实现将通过将角向域 $\\nu \\in [0, 2\\pi)$ 离散为 $N_\\nu$ 个点，在每个点上评估尺度因子 $h_\\mu$ 和温度 $T(\\mu_0, \\nu_j)$ 与 $T(\\mu_0+\\Delta\\mu, \\nu_j)$，计算有限差分，并最终组装平均通量和 RMS 残差。此过程将应用于提供的三个测试用例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n\n    def T_func_case1_2(mu, nu, T_inf, A=10.0):\n        \"\"\"Temperature field for cases 1 and 2.\"\"\"\n        return T_inf + A * np.cos(nu) * np.cosh(mu)\n\n    def T_func_case3(mu, nu, T_inf, A=2.0):\n        \"\"\"Temperature field for case 3.\"\"\"\n        return T_inf + A * np.sin(3 * nu) * np.cosh(mu)\n\n    test_cases = [\n        {\n            \"c\": 0.4, \"mu0\": 1.0, \"dmu\": 1e-3, \"N_nu\": 256,\n            \"k\": 15.0, \"h\": 50.0, \"T_inf\": 300.0,\n            \"T_func\": lambda mu, nu, T_inf: T_func_case1_2(mu, nu, T_inf, A=10.0)\n        },\n        {\n            \"c\": 0.2, \"mu0\": 0.2, \"dmu\": 1e-4, \"N_nu\": 512,\n            \"k\": 200.0, \"h\": 0.0, \"T_inf\": 300.0,\n            \"T_func\": lambda mu, nu, T_inf: T_func_case1_2(mu, nu, T_inf, A=5.0)\n        },\n        {\n            \"c\": 0.6, \"mu0\": 1.5, \"dmu\": 2e-3, \"N_nu\": 128,\n            \"k\": 1.0, \"h\": 1000.0, \"T_inf\": 300.0,\n            \"T_func\": lambda mu, nu, T_inf: T_func_case3(mu, nu, T_inf, A=2.0)\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c = case[\"c\"]\n        mu0 = case[\"mu0\"]\n        dmu = case[\"dmu\"]\n        N_nu = case[\"N_nu\"]\n        k = case[\"k\"]\n        h = case[\"h\"]\n        T_inf = case[\"T_inf\"]\n        T_func = case[\"T_func\"]\n\n        # Discretize the boundary in the nu-direction\n        # endpoint=False to cover [0, 2*pi)\n        nu_j = np.linspace(0, 2 * np.pi, N_nu, endpoint=False)\n\n        # 1. Calculate the scale factor h_mu on the boundary\n        # h_mu = c * sqrt(sinh^2(mu_0) + sin^2(nu))\n        h_mu_vals = c * np.sqrt(np.sinh(mu0)**2 + np.sin(nu_j)**2)\n\n        # 2. Evaluate temperature at the boundary and at a small step outward\n        T_boundary = T_func(mu0, nu_j, T_inf)\n        T_ghost = T_func(mu0 + dmu, nu_j, T_inf)\n\n        # 3. Approximate the coordinate derivative dT/dmu\n        # Using a first-order one-sided finite difference\n        dT_dmu = (T_ghost - T_boundary) / dmu\n        \n        # 4. Calculate the physical normal derivative dT/dn\n        # dT/dn = (1/h_mu) * dT/dmu\n        dT_dn = (1 / h_mu_vals) * dT_dmu\n\n        # 5. Calculate the normal conductive heat flux q''\n        # q'' = -k * dT/dn\n        q_prime_prime = -k * dT_dn\n\n        # 6. Compute the average heat flux magnitude\n        # Integral approximated by the mean over the discrete points\n        avg_q_magnitude = np.mean(np.abs(q_prime_prime))\n        \n        # 7. Compute the RMS of the Robin boundary condition residual\n        # Residual R = -k*dT/dn - h*(T - T_inf)\n        # Note that -k*dT/dn is just q_prime_prime\n        residual = q_prime_prime - h * (T_boundary - T_inf)\n        rms_residual = np.sqrt(np.mean(residual**2))\n        \n        results.append([avg_q_magnitude, rms_residual])\n\n    # The final print statement must follow the exact specified format.\n    # Python's default string representation of a list of lists matches the required format.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}