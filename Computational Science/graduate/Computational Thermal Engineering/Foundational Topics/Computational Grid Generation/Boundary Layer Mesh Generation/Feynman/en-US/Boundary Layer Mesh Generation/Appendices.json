{
    "hands_on_practices": [
        {
            "introduction": "The first step in creating a high-quality boundary layer mesh is determining the height of the very first cell off the wall. This height is dictated by the dimensionless wall distance, $y^+$, which ensures that the mesh is fine enough to capture the steep gradients in the viscous sublayer. This exercise  will guide you through the fundamental calculation of converting physical flow parameters, such as wall shear stress, into the precise first cell height required for a wall-resolved simulation.",
            "id": "3938566",
            "problem": "A computational thermal engineering team is constructing a near-wall mesh for a wall-bounded forced convection simulation of liquid water using Computational Fluid Dynamics (CFD). The goal is to resolve the thermal and momentum boundary layers in the viscous sublayer by designing the first off-wall cell height to achieve a dimensionless wall-normal coordinate of $y^{+}=1$. The fluid properties at operating conditions are known: density $\\rho=1000\\,\\text{kg/m}^{3}$ and kinematic viscosity $\\nu=1\\times 10^{-6}\\,\\text{m}^{2}/\\text{s}$. A prior high-fidelity calculation has provided a predicted wall shear stress $\\tau_{w}=0.5\\,\\text{Pa}$ for the location of interest.\n\nStarting from the fundamental definitions of wall shear stress and viscous wall units used in boundary layer theory, derive the expression for the friction velocity $u_{\\tau}$ in terms of $\\tau_{w}$ and $\\rho$, and derive the expression for the first cell height $y$ that achieves $y^{+}=1$ in terms of $\\nu$ and $u_{\\tau}$. Then, evaluate $u_{\\tau}$ and $y$ numerically using the given values.\n\nRound your numerical results to four significant figures. Express $u_{\\tau}$ in $\\text{m/s}$ and $y$ in $\\text{m}$.",
            "solution": "The objective is to compute the friction velocity $u_{\\tau}$ and the first off-wall cell height $y$ that yields $y^{+}=1$, using fundamental boundary layer scaling for wall-bounded flows of a Newtonian fluid.\n\nWe begin from the definition of wall shear stress and the associated friction scaling. In wall-bounded turbulence and laminar boundary layers, it is standard to introduce a velocity scale $u_{\\tau}$, called the friction velocity, by defining the wall shear stress $\\tau_{w}$ to be equal to the dynamic pressure scale formed from $u_{\\tau}$:\n$$\n\\tau_{w}=\\rho\\,u_{\\tau}^{2}.\n$$\nThis definition arises from dimensional analysis and near-wall scaling of the momentum equation, which identifies $\\rho\\,u_{\\tau}^{2}$ as the characteristic stress scale when velocities are normalized by $u_{\\tau}$ and lengths by the viscous length scale. Solving the above definition for $u_{\\tau}$ gives\n$$\nu_{\\tau}=\\sqrt{\\frac{\\tau_{w}}{\\rho}}.\n$$\n\nNext, we consider the viscous wall unit and the definition of the dimensionless wall-normal coordinate $y^{+}$. The viscous length scale $\\ell_{\\nu}$ is defined by the ratio of kinematic viscosity to friction velocity:\n$$\n\\ell_{\\nu}=\\frac{\\nu}{u_{\\tau}}.\n$$\nNon-dimensionalizing the wall-normal coordinate $y$ by $\\ell_{\\nu}$ defines the wall unit $y^{+}$:\n$$\ny^{+}=\\frac{y}{\\ell_{\\nu}}=\\frac{y\\,u_{\\tau}}{\\nu}.\n$$\nTo achieve $y^{+}=1$, the required first cell height $y$ must satisfy\n$$\ny=\\frac{\\nu}{u_{\\tau}}.\n$$\n\nWith the derived expressions in hand, we now substitute the given numerical values. The friction velocity is\n$$\nu_{\\tau}=\\sqrt{\\frac{\\tau_{w}}{\\rho}}=\\sqrt{\\frac{0.5}{1000}}=\\sqrt{5\\times 10^{-4}}=\\sqrt{5}\\times 10^{-2}.\n$$\nEvaluating $\\sqrt{5}$ symbolically and then numerically to four significant figures yields\n$$\nu_{\\tau}\\approx 0.02236.\n$$\nThe first cell height for $y^{+}=1$ is\n$$\ny=\\frac{\\nu}{u_{\\tau}}=\\frac{1\\times 10^{-6}}{0.02236}.\n$$\nCarrying out the division and rounding to four significant figures gives\n$$\ny\\approx 4.472\\times 10^{-5}.\n$$\n\nThus, the friction velocity and the first cell height that achieves $y^{+}=1$ are, respectively, $u_{\\tau}\\approx 0.02236\\,\\text{m/s}$ and $y\\approx 4.472\\times 10^{-5}\\,\\text{m}$, each reported to four significant figures as requested.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.02236  4.472\\times 10^{-5}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Once the initial cell height is set, the subsequent layers must expand smoothly to cover the entire boundary layer thickness without introducing large jumps in cell size that can degrade numerical accuracy. This is typically achieved using a geometric growth ratio, a core technique in inflation layer meshing. In this practice , you will apply the principles of a geometric series to determine the necessary number of layers to achieve a target total thickness while respecting a maximum expansion ratio.",
            "id": "3938579",
            "problem": "In a wall-resolved conjugate heat transfer simulation within computational thermal engineering, a boundary-layer inflation mesh is constructed adjacent to a heated flat plate to resolve steep wall-normal gradients in temperature and velocity. To control numerical diffusion and preserve accuracy, the mesh uses monotone increasing layer heights with a constant geometric growth, bounded by a maximum allowed expansion ratio. Let the $k$-th layer height be denoted by $H_k$, with $H_1$ prescribed, and let the constant expansion ratio be $r$, defined by $H_{k+1}/H_k=r$. The cumulative thickness of the inflation layer stack of $N$ layers is $H_{\\text{stack}}(N)=\\sum_{k=1}^{N} H_k$, which must be at least a prescribed target thickness $H_{\\text{tot}}$ to envelop the thermal boundary layer.\n\nStarting from the definitions of geometric growth and the finite sum of a geometric progression, and without assuming any pre-derived target formulas, derive the selection criterion for the minimal integer number of layers $N$ needed to ensure $H_{\\text{stack}}(N)\\ge H_{\\text{tot}}$ when a constant per-layer expansion ratio $r$ is used. Then compute $N$ and the last-layer height $H_N$ for the following parameters: $H_{\\text{tot}}=5\\,\\text{mm}$, $H_1=10\\,\\mu\\text{m}$, and a maximum allowed expansion ratio $r=1.2$. Assume the mesh uses a constant ratio equal to the maximum allowed value $r$ for all layers. Report $N$ as an integer, and report $H_N$ rounded to four significant figures and expressed in $\\text{mm}$. The final answer must be provided as two entries in a single row, in the order $N$ and $H_N$.",
            "solution": "The height of the $k$-th layer, $H_k$, follows a geometric progression: $H_k = H_1 r^{k-1}$. The total thickness of $N$ layers, $H_{\\text{stack}}(N)$, is the sum of this finite geometric series:\n$$H_{\\text{stack}}(N) = \\sum_{k=1}^{N} H_1 r^{k-1} = H_1 \\frac{r^N - 1}{r - 1}$$\nThe problem requires this to be at least the target thickness, $H_{\\text{tot}}$, so we must find the smallest integer $N$ that satisfies the inequality $H_{\\text{stack}}(N) \\ge H_{\\text{tot}}$. Substituting the formula for the sum gives:\n$$H_1 \\frac{r^N - 1}{r - 1} \\ge H_{\\text{tot}}$$\nSolving for $N$ yields the selection criterion:\n$$N \\ge \\frac{\\ln\\left(1 + \\frac{H_{\\text{tot}}}{H_1} (r - 1)\\right)}{\\ln(r)}$$\nNow, we substitute the given parameters: $H_{\\text{tot}} = 5\\,\\text{mm}$, $H_1 = 10\\,\\mu\\text{m} = 0.01\\,\\text{mm}$, and $r = 1.2$. The ratio of thicknesses is $\\frac{H_{\\text{tot}}}{H_1} = \\frac{5}{0.01} = 500$.\n$$N \\ge \\frac{\\ln\\left(1 + 500(1.2 - 1)\\right)}{\\ln(1.2)} = \\frac{\\ln(101)}{\\ln(1.2)} \\approx \\frac{4.6151}{0.1823} \\approx 25.313$$\nSince the number of layers $N$ must be an integer, we take the ceiling of this value:\n$$N = 26$$\nNext, we compute the height of the last layer, $H_N = H_{26}$, using the formula for the $k$-th term:\n$$H_{26} = H_1 r^{26-1} = (0.01\\,\\text{mm}) \\cdot (1.2)^{25} \\approx (0.01\\,\\text{mm}) \\cdot (95.3962) \\approx 0.953962\\,\\text{mm}$$\nRounding to four significant figures, the height of the last layer is $H_N \\approx 0.9540\\,\\text{mm}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 26  0.9540 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Generating a mesh is not the final goal; the ultimate objective is to obtain an accurate and reliable solution. A grid convergence study is the standard procedure to assess the quality of a simulation by quantifying how the solution changes with mesh refinement. This exercise  introduces the powerful technique of Richardson extrapolation, allowing you to estimate the true, mesh-independent solution and verify the theoretical order of accuracy of your simulation from a series of results.",
            "id": "3938557",
            "problem": "A two-dimensional steady incompressible thermal boundary layer over a heated flat plate is simulated using Computational Fluid Dynamics (CFD). The wall heat flux, denoted by $q(h)$, is obtained from three successively refined meshes that differ only in the first off-wall cell height $H_1$, which is the representative wall-normal mesh size for the near-wall discretization. The three meshes have $H_1=(20,10,5)\\,\\mu\\text{m}$, yielding area-averaged wall heat fluxes $(q_1,q_2,q_3)=(500,540,560)\\,\\text{W/m}^2$, respectively, where the subscript increases with refinement. Assume:\n- The refinement is uniform in the wall-normal direction, so that the refinement factor $r$ defined by $r = H_{1,\\text{coarse}}/H_{1,\\text{fine}}$ is constant across successive meshes.\n- In the asymptotic regime of grid convergence, the discretization error in $q(h)$ admits the leading-order model $q(h) = q_{\\text{exact}} + C\\,h^{p}$, where $q_{\\text{exact}}$ is the mesh-independent wall heat flux, $C$ is a constant independent of $h$, $h$ is represented by $H_1$, and $p$ is the observed order of accuracy.\n\nStarting from the stated leading-order error model and the definition of a uniform refinement factor, derive expressions that eliminate the unknown constant $C$ and allow the determination of the order $p$ and the Richardson-extrapolated $q_{\\text{exact}}$ from the three data points. Then evaluate $p$ and $q_{\\text{exact}}$ using the given data.\n\nExpress $q_{\\text{exact}}$ in $\\text{W/m}^2$ and $p$ as a dimensionless quantity. Round both numbers to four significant figures. Provide your final result as a row matrix $\\bigl[q_{\\text{exact}},\\,p\\bigr]$.",
            "solution": "The problem requires the derivation of expressions for the observed order of accuracy, $p$, and the mesh-independent solution, $q_{\\text{exact}}$, from a set of three numerical solutions obtained on successively refined meshes. Subsequently, these quantities are to be evaluated using the provided data.\n\nThe analysis begins with the given leading-order error model for the area-averaged wall heat flux, $q(h)$:\n$$q(h) = q_{\\text{exact}} + C h^{p}$$\nwhere $h$ is the representative mesh size. We are given three solutions, $(q_1, q_2, q_3)$, corresponding to three mesh sizes, $(h_1, h_2, h_3)$, where the subscripts increase with refinement (i.e., $h_1 > h_2 > h_3$). The problem states that the representative mesh size $h$ is the first off-wall cell height, $H_1$. Thus, we have:\n$h_1 = H_{1,1} = 20\\,\\mu\\text{m}$ with $q_1 = 500\\,\\text{W/m}^2$\n$h_2 = H_{1,2} = 10\\,\\mu\\text{m}$ with $q_2 = 540\\,\\text{W/m}^2$\n$h_3 = H_{1,3} = 5\\,\\mu\\text{m}$ with $q_3 = 560\\,\\text{W/m}^2$\n\nWe can write the error model for each of the three meshes as a system of three equations with three unknowns ($q_{\\text{exact}}$, $C$, and $p$):\n1. $q_1 = q_{\\text{exact}} + C h_1^p$\n2. $q_2 = q_{\\text{exact}} + C h_2^p$\n3. $q_3 = q_{\\text{exact}} + C h_3^p$\n\nThe problem specifies a uniform refinement factor, $r$, defined as $r = H_{1,\\text{coarse}}/H_{1,\\text{fine}}$. Using the given data:\n$$r = \\frac{h_1}{h_2} = \\frac{20}{10} = 2$$\n$$r = \\frac{h_2}{h_3} = \\frac{10}{5} = 2$$\nThe refinement factor is indeed constant, with a value of $r=2$. This implies $h_1 = r h_2$ and $h_2 = r h_3$.\n\nTo derive an expression for the order of accuracy $p$, we first eliminate the unknown $q_{\\text{exact}}$ by taking the difference between successive equations:\nSubtracting equation (1) from (2):\n$$q_2 - q_1 = (q_{\\text{exact}} + C h_2^p) - (q_{\\text{exact}} + C h_1^p) = C(h_2^p - h_1^p)$$\nSince $h_1 = r h_2$, this becomes:\n$$q_2 - q_1 = C(h_2^p - (r h_2)^p) = C h_2^p (1 - r^p)$$\nSubtracting equation (2) from (3):\n$$q_3 - q_2 = (q_{\\text{exact}} + C h_3^p) - (q_{\\text{exact}} + C h_2^p) = C(h_3^p - h_2^p)$$\nSince $h_2 = r h_3$, this becomes:\n$$q_3 - q_2 = C(h_3^p - (r h_3)^p) = C h_3^p (1 - r^p)$$\n\nNow, we can eliminate the unknown constant $C$ by taking the ratio of these two differences:\n$$\\frac{q_2 - q_1}{q_3 - q_2} = \\frac{C h_2^p (1 - r^p)}{C h_3^p (1 - r^p)} = \\frac{h_2^p}{h_3^p} = \\left(\\frac{h_2}{h_3}\\right)^p$$\nBy definition, $h_2/h_3 = r$. Therefore:\n$$\\frac{q_2 - q_1}{q_3 - q_2} = r^p$$\nTo solve for $p$, we take the natural logarithm of both sides:\n$$\\ln\\left(\\frac{q_2 - q_1}{q_3 - q_2}\\right) = \\ln(r^p) = p \\ln(r)$$\nThis yields the desired expression for the observed order of accuracy:\n$$p = \\frac{\\ln\\left(\\frac{q_2 - q_1}{q_3 - q_2}\\right)}{\\ln(r)}$$\n\nNext, we derive the expression for the Richardson-extrapolated value $q_{\\text{exact}}$. We use the two equations corresponding to the finest meshes, (2) and (3), as this generally yields a more accurate estimate.\n$q_2 = q_{\\text{exact}} + C h_2^p$\n$q_3 = q_{\\text{exact}} + C h_3^p$\nWe eliminate the constant $C$. From the second of these equations, we solve for $C$:\n$$C = \\frac{q_3 - q_{\\text{exact}}}{h_3^p}$$\nSubstitute this expression for $C$ into the equation for $q_2$:\n$$q_2 = q_{\\text{exact}} + \\left(\\frac{q_3 - q_{\\text{exact}}}{h_3^p}\\right)h_2^p = q_{\\text{exact}} + (q_3 - q_{\\text{exact}})\\left(\\frac{h_2}{h_3}\\right)^p$$\nUsing the refinement factor $r=h_2/h_3$, we have:\n$$q_2 = q_{\\text{exact}} + (q_3 - q_{\\text{exact}})r^p$$\nRearranging the terms to solve for $q_{\\text{exact}}$:\n$$q_2 = q_{\\text{exact}} - q_{\\text{exact}}r^p + q_3 r^p$$\n$$q_2 - q_3 r^p = q_{\\text{exact}}(1 - r^p)$$\n$$q_{\\text{exact}} = \\frac{q_2 - q_3 r^p}{1 - r^p} = \\frac{q_3 r^p - q_2}{r^p - 1}$$\nThis expression allows for the determination of $q_{\\text{exact}}$ once $p$ and $r$ are known. A common alternative form is $q_{\\text{exact}} = q_3 + \\frac{q_3-q_2}{r^p-1}$, which is known as Richardson's extrapolation formula applied to the finest grid solution $q_3$.\n\nNow we evaluate $p$ and $q_{\\text{exact}}$ using the given numerical data:\n$q_1 = 500$, $q_2 = 540$, $q_3 = 560$ (all in $\\text{W/m}^2$).\n$r = 2$.\n\nFirst, calculate $p$:\n$$p = \\frac{\\ln\\left(\\frac{540 - 500}{560 - 540}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{40}{20}\\right)}{\\ln(2)} = \\frac{\\ln(2)}{\\ln(2)} = 1$$\nThe observed order of accuracy is exactly $1$.\n\nNext, calculate $q_{\\text{exact}}$ using the derived expression and $p=1$:\n$$q_{\\text{exact}} = \\frac{q_3 r^p - q_2}{r^p - 1} = \\frac{560 \\cdot (2)^1 - 540}{(2)^1 - 1} = \\frac{1120 - 540}{1} = 580$$\nThe mesh-independent (extrapolated) wall heat flux is $580\\,\\text{W/m}^2$.\n\nThe problem requires rounding both numbers to four significant figures.\nFor $q_{\\text{exact}} = 580$, four significant figures gives $580.0$.\nFor $p = 1$, four significant figures gives $1.000$.\n\nThe final result is provided as a row matrix $\\bigl[q_{\\text{exact}},\\,p\\bigr]$.",
            "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n580.0  1.000\n\\end{bmatrix}\n}\n$$"
        }
    ]
}