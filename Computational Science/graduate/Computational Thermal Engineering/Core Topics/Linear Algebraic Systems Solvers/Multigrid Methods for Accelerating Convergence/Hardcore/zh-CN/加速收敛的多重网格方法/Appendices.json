{
    "hands_on_practices": [
        {
            "introduction": "多重网格方法的核心思想是在不同尺度上处理误差的不同频率分量。平滑器在此过程中扮演着至关重要的角色，其主要任务是高效地衰减高频误差。本练习将通过局部傅里叶分析（LFA）这一强大的理论工具，带你亲手计算加权雅可比（weighted Jacobi）平滑器的最优松弛因子，从而深入理解如何设计一个高效的平滑器。",
            "id": "3974232",
            "problem": "考虑一个无穷二维均匀笛卡尔网格上的稳态热传导问题，其介质为均匀各向同性，由泊松方程 $-\\nabla^{2} T = f$ 控制，网格间距为 $h$。使用标准的二阶五点有限差分近似来逼近拉普拉斯算子，离散算子 $A$ 的模板为 $\\frac{1}{h^2} \\begin{pmatrix}  -1  \\\\ -1  4  -1 \\\\  -1  \\end{pmatrix}$，其对角部分 $D$ 为 $D = \\frac{4}{h^{2}} I$。在一个采用 $2 \\times 2$ 粗化、全加权限制和双线性插值的双网格法中，一个常用的光滑子是加权雅可比法。对于迭代值 $u^{(k)}$，该方法定义为 $u^{(k+1)} = u^{(k)} + \\omega D^{-1}\\left(b - A u^{(k)}\\right)$，其中 $\\omega \\in (0,1)$ 是松弛参数。\n\n使用局部傅里叶分析（LFA; Local Fourier Analysis），分析此算子在无穷网格上加权雅可比光滑子的误差传播符号。将高频集定义为两个分量都在粗网格可表示频带之外的傅里叶模式，具体来说是 $|\\theta_{x}| \\in [\\pi/2,\\pi]$ 和 $|\\theta_{y}| \\in [\\pi/2,\\pi]$。确定松弛参数 $\\omega$ 的值，该值使得光滑子符号在此高频集上的最坏情况下的幅值最小。将最终答案表示为一个精确数，无需四舍五入。",
            "solution": "本问题要求确定用于二维泊松方程多重网格法中的加权雅可比光滑子的最优松弛参数 $\\omega$。该优化需要使用局部傅里叶分析（LFA）在指定的高频模式集上进行。\n\n首先，我们建立LFA的框架。在间距为 $h$ 的无穷均匀笛卡尔网格上，一个离散函数由其傅里叶分量表示。傅里叶模式是任何线性位移不变算子（例如有限差分算子 $A$）的特征函数。一个无量纲波数为 $\\theta = (\\theta_x, \\theta_y) \\in [-\\pi, \\pi]^2$ 的模式由 $\\phi_{\\theta}(j) = \\exp(i j \\cdot \\theta)$ 给出，其中 $j = (j_x, j_y)$ 是网格索引。算子对应于此模式的特征值称为该算子的符号。\n\n离散算子 $A$ 由负拉普拉斯算子的五点模板给出：\n$$\n(A u)_j = \\frac{1}{h^2} \\left( 4u_j - u_{j+(1,0)} - u_{j-(1,0)} - u_{j+(0,1)} - u_{j-(0,1)} \\right)\n$$\n为了找到符号 $\\hat{A}(\\theta)$，我们将 $A$ 应用于傅里叶模式 $\\phi_{\\theta}(j)$：\n$$\n(A \\phi_{\\theta})_j = \\frac{1}{h^2} \\left( 4e^{i j \\cdot \\theta} - e^{i (j_x+1)\\theta_x}e^{i j_y\\theta_y} - e^{i (j_x-1)\\theta_x}e^{i j_y\\theta_y} - e^{i j_x\\theta_x}e^{i (j_y+1)\\theta_y} - e^{i j_x\\theta_x}e^{i (j_y-1)\\theta_y} \\right)\n$$\n提出因子 $\\phi_{\\theta}(j) = e^{i j \\cdot \\theta}$：\n$$\n(A \\phi_{\\theta})_j = \\frac{1}{h^2} \\phi_{\\theta}(j) \\left( 4 - e^{i\\theta_x} - e^{-i\\theta_x} - e^{i\\theta_y} - e^{-i\\theta_y} \\right)\n$$\n使用恒等式 $2\\cos(x) = e^{ix} + e^{-ix}$，算子 $A$ 的符号为：\n$$\n\\hat{A}(\\theta) = \\frac{1}{h^2} \\left( 4 - 2\\cos(\\theta_x) - 2\\cos(\\theta_y) \\right) = \\frac{2}{h^2} \\left( 2 - \\cos(\\theta_x) - \\cos(\\theta_y) \\right)\n$$\n使用半角公式 $1 - \\cos(x) = 2\\sin^2(x/2)$，这可以重写为：\n$$\n\\hat{A}(\\theta) = \\frac{4}{h^2} \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)\n$$\n加权雅可比迭代由 $u^{(k+1)} = u^{(k)} + \\omega D^{-1}(b - A u^{(k)})$ 给出。误差 $e^{(k)} = u^{(k)} - u$（其中 $Au=b$）根据光滑算子 $S = I - \\omega D^{-1} A$ 进行传播。我们需要 $S$ 的符号，记为 $\\hat{S}(\\theta)$。\n算子 $D$ 是 $A$ 的对角部分，即 $D = \\frac{4}{h^2}I$。其逆为 $D^{-1} = \\frac{h^2}{4}I$。$D$ 和 $D^{-1}$ 的符号分别是标量 $\\hat{D} = \\frac{4}{h^2}$ 和 $\\hat{D}^{-1} = \\frac{h^2}{4}$。\n\n于是，光滑算子 $S$ 的符号为：\n$$\n\\hat{S}(\\theta) = 1 - \\omega \\hat{D}^{-1} \\hat{A}(\\theta) = 1 - \\omega \\left(\\frac{h^2}{4}\\right) \\left[ \\frac{4}{h^2} \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right) \\right]\n$$\n$$\n\\hat{S}(\\theta) = 1 - \\omega \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)\n$$\n这便是误差传播符号，也称为模式 $\\theta$ 的光滑因子。我们将其记为 $\\mu(\\theta, \\omega)$。\n\n问题将高频集定义为 $HF = \\{ (\\theta_x, \\theta_y) : |\\theta_x| \\in [\\pi/2, \\pi] \\text{ 且 } |\\theta_y| \\in [\\pi/2, \\pi] \\}$。我们需要找到 $\\omega \\in (0,1)$ 的值，以最小化 $\\mu(\\theta, \\omega)$ 在此集合上的最坏情况（最大）幅值。\n$$\n\\min_{\\omega \\in (0,1)} \\max_{\\theta \\in HF} |\\mu(\\theta, \\omega)|\n$$\n令依赖于频率的项为 $C(\\theta) = \\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2})$。那么符号为 $\\mu(\\theta, \\omega) = 1 - \\omega C(\\theta)$。\n我们首先确定当 $\\theta \\in HF$ 时 $C(\\theta)$ 的范围。函数 $\\sin^2(x/2)$ 在 $x \\in [0, \\pi]$ 上是单调递增的。由于 $\\sin^2(x/2)$ 是 $x$ 的偶函数，我们只需考虑 $\\theta_x, \\theta_y \\in [\\pi/2, \\pi]$。\n对于 $\\alpha \\in [\\pi/2, \\pi]$，$\\sin^2(\\alpha/2)$ 的最小值在 $\\alpha = \\pi/2$ 时取到：$\\sin^2(\\frac{\\pi/2}{2}) = \\sin^2(\\pi/4) = (\\frac{1}{\\sqrt{2}})^2 = \\frac{1}{2}$。\n最大值在 $\\alpha = \\pi$ 时取到：$\\sin^2(\\pi/2) = 1^2 = 1$。\n因此，对于 $\\theta \\in HF$，项 $\\sin^2(\\theta_x/2)$ 的范围是 $[1/2, 1]$，$\\sin^2(\\theta_y/2)$ 的范围也是如此。\n因此，它们的和 $C(\\theta)$ 的范围是：\n$$\nC_{min} = \\frac{1}{2} + \\frac{1}{2} = 1 \\quad (\\text{在 } |\\theta_x|=|\\theta_y|=\\pi/2 \\text{ 时})\n$$\n$$\nC_{max} = 1 + 1 = 2 \\quad (\\text{在 } |\\theta_x|=|\\theta_y|=\\pi \\text{ 时})\n$$\n所以，对于 $\\theta \\in HF$，$C(\\theta)$ 的取值范围是区间 $[1, 2]$。\n\n我们的问题简化为求解以下极小化极大问题的 $\\omega$：\n$$\n\\min_{\\omega \\in (0,1)} \\max_{C \\in [1, 2]} |1 - \\omega C|\n$$\n函数 $g(C) = 1 - \\omega C$ 是关于 $C$ 的线性函数。对于固定的 $\\omega  0$，线性函数在区间 $[C_{min}, C_{max}]$ 上的最大绝对值必然在端点 $C=1$ 或 $C=2$ 处取得。\n所以，我们需要最小化：\n$$\n\\max(|1 - \\omega \\cdot 1|, |1 - \\omega \\cdot 2|) = \\max(|1 - \\omega|, |1 - 2\\omega|)\n$$\n最优的 $\\omega$ 值在两个边界处的幅值相等时取得，因为这平衡了极端频率分量的放大。这是一个标准结果，用于最小化两个函数的最大值，其中一个函数相对于参数是递减的，另一个是递增的。\n我们令 $|1 - \\omega| = |1 - 2\\omega|$。\n因为问题指定 $\\omega \\in (0,1)$，项 $1-\\omega$ 总是正的，所以 $|1-\\omega| = 1-\\omega$。\n对于项 $|1-2\\omega|$，我们考虑 $\\omega$ 的两种情况：\n1. 如果 $\\omega \\in (0, 1/2]$，那么 $1-2\\omega \\ge 0$，所以 $|1-2\\omega| = 1-2\\omega$。方程变为 $1-\\omega = 1-2\\omega$，这意味着 $\\omega=0$，这个值在指定的区间 $(0,1)$ 之外。\n2. 如果 $\\omega \\in (1/2, 1)$，那么 $1-2\\omega  0$，所以 $|1-2\\omega| = -(1-2\\omega) = 2\\omega - 1$。方程变为：\n$$\n1 - \\omega = 2\\omega - 1\n$$\n$$\n2 = 3\\omega\n$$\n$$\n\\omega = \\frac{2}{3}\n$$\n这个值 $\\omega = 2/3$ 位于区间 $(1/2, 1)$ 内，因此它是一个有效的候选值。在此值下，最大幅值为 $|1 - 2/3| = |1 - 2(2/3)| = |1 - 4/3| = 1/3$。\n为了确认这是最小值，我们可以分析函数 $f(\\omega) = \\max(1-\\omega, |1-2\\omega|)$ 在 $\\omega \\in (0,1)$ 上的行为。\n对于 $\\omega \\in (0, 1/2)$，$f(\\omega) = \\max(1-\\omega, 1-2\\omega) = 1-\\omega$。这是一个递减函数，所以它在这个开区间上的最小值在 $\\omega=1/2$ 处趋近，值为 $1/2$。\n对于 $\\omega \\in [1/2, 1)$，$f(\\omega) = \\max(1-\\omega, 2\\omega-1)$。这里，$1-\\omega$ 是递减的，而 $2\\omega-1$ 是递增的。它们最大值的最小值出现在它们的交点处，我们已经求得该交点为 $\\omega=2/3$，此时值为 $1/3$。\n比较两个区间的结果，$\\omega \\in (0,1)$ 的全局最小值是 $1/3$，在 $\\omega = 2/3$ 时达到。\n\n因此，使得光滑子符号在指定高频集上的最坏情况幅值最小的松弛参数 $\\omega$ 的值为 $2/3$。",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "在平滑操作之后，残差被传递到粗网格上，我们需要求解一个粗网格问题。这个粗网格算子是如何构建的，以及它是否保持了原问题的关键物理和数学性质，是多重网格方法收敛性的理论基石。通过本练习，你将为变系数扩散问题推导伽辽金（Galerkin）粗网格算子的具体形式，并验证其对称正定性（Symmetric Positive Definite, SPD），从而揭示多重网格在不同层级间保持结构一致性的内在机制。",
            "id": "3974226",
            "problem": "考虑在一维非均匀杆中的稳态热传导，其热导率随空间变化，该过程遵循傅里叶定律。控制方程是具有可变系数的二阶扩散算子，\n$$\n-\\frac{d}{dx}\\!\\left(k(x)\\,\\frac{du}{dx}\\right)=f(x),\n$$\n在区间上的均匀网格上，两端施加齐次狄利克雷边界条件 $u=0$。可变热导率 $k(x)$ 是严格为正且光滑的。在间距为 $h$ 的细网格上，使用中边电导率 $\\{k_{i+1/2}\\}_{i}$，通过标准的三点守恒通量平衡法对算子进行离散化，离散线性算子 $\\mathbf{A}$ 作用于细网格向量 $\\mathbf{u}$，在内部索引 $i$ 处由下式给出\n$$\n(\\mathbf{A}\\mathbf{u})_{i}=\\frac{1}{h^{2}}\\!\\left(-k_{i-1/2}\\,\\mathbf{u}_{i-1}+(k_{i-1/2}+k_{i+1/2})\\,\\mathbf{u}_{i}-k_{i+1/2}\\,\\mathbf{u}_{i+1}\\right).\n$$\n设粗网格间距为 $H=2h$。定义从粗网格到细网格的线性插值延长算子 $\\mathbf{P}$ 如下：\n$$\n(\\mathbf{P}\\mathbf{v})_{2j}=\\mathbf{v}_{j},\\quad (\\mathbf{P}\\mathbf{v})_{2j+1}=\\frac{\\mathbf{v}_{j}+\\mathbf{v}_{j+1}}{2},\n$$\n对于内部粗网格索引 $j$。定义从细网格到粗网格的全加权限制算子 $\\mathbf{R}$ 如下：\n$$\n(\\mathbf{R}\\mathbf{r})_{j}=\\frac{1}{4}\\,\\mathbf{r}_{2j-1}+\\frac{1}{2}\\,\\mathbf{r}_{2j}+\\frac{1}{4}\\,\\mathbf{r}_{2j+1}.\n$$\n使用伽辽金构造 $\\mathbf{A}_{c}=\\mathbf{R}\\mathbf{A}\\mathbf{P}$，明确计算 $\\mathbf{A}_{c}$ 在内部粗网格索引 $j$ 处的三点粗网格模板，用四个细网格中边电导率 $k_{2j-3/2}$、$k_{2j-1/2}$、$k_{2j+1/2}$ 和 $k_{2j+3/2}$ 以及粗网格间距 $H$ 来表示。然后，使用第一性原理和线性代数能量论证，验证在所有细网格中边电导率严格为正且边界条件为齐次狄利克雷的情况下，$\\mathbf{A}_{c}$ 是对称正定（SPD）的。\n\n将最终的粗网格三点模板系数，即 $\\left(a^{c}_{j,j-1},\\,a^{c}_{j,j},\\,a^{c}_{j,j+1}\\right)$，使用 LaTeX 的 $\\texttt{pmatrix}$ 环境表示为单行矩阵。无需四舍五入。最终答案中无需单位。",
            "solution": "解答分为两部分。首先，我们计算粗网格算子 $\\mathbf{A}_{c}=\\mathbf{R}\\mathbf{A}\\mathbf{P}$ 的模板。其次，我们验证 $\\mathbf{A}_{c}$ 是对称正定（SPD）的。\n\n**第一部分：推导粗网格算子模板**\n\n目标是计算粗网格算子 $\\mathbf{A}_c$ 对任意粗网格向量 $\\mathbf{v}$ 的作用。我们将计算结果向量的第 $j$ 个分量 $(\\mathbf{A}_{c}\\mathbf{v})_{j}$，其定义为 $(\\mathbf{R}(\\mathbf{A}(\\mathbf{P}\\mathbf{v})))_j$。我们从最内层的运算开始向外计算。\n\n**步骤1：延长算子 $\\mathbf{P}$ 的作用**\n令 $\\mathbf{v}$ 为一个粗网格向量。延长算子 $\\mathbf{P}$ 将 $\\mathbf{v}$ 映射到一个细网格向量 $\\mathbf{u} = \\mathbf{P}\\mathbf{v}$。在细网格点 $2j$ 附近的 $\\mathbf{u}$ 的分量由以下插值规则给出：\n$$\n\\mathbf{u}_{2j-2} = \\mathbf{v}_{j-1}\n$$\n$$\n\\mathbf{u}_{2j-1} = \\frac{1}{2}(\\mathbf{v}_{j-1} + \\mathbf{v}_{j})\n$$\n$$\n\\mathbf{u}_{2j} = \\mathbf{v}_{j}\n$$\n$$\n\\mathbf{u}_{2j+1} = \\frac{1}{2}(\\mathbf{v}_{j} + \\mathbf{v}_{j+1})\n$$\n$$\n\\mathbf{u}_{2j+2} = \\mathbf{v}_{j+1}\n$$\n\n**步骤2：细网格算子 $\\mathbf{A}$ 的作用**\n接下来，我们计算细网格向量 $\\mathbf{r} = \\mathbf{A}\\mathbf{u}$ 的分量。粗网格索引 $j$ 处的限制算子 $\\mathbf{R}$ 需要分量 $\\mathbf{r}_{2j-1}$、$\\mathbf{r}_{2j}$ 和 $\\mathbf{r}_{2j+1}$。我们使用 $\\mathbf{A}$ 的定义来计算这些分量中的每一个：\n$$\n(\\mathbf{A}\\mathbf{u})_{i}=\\frac{1}{h^{2}}\\!\\left(-k_{i-1/2}\\,\\mathbf{u}_{i-1}+(k_{i-1/2}+k_{i+1/2})\\,\\mathbf{u}_{i}-k_{i+1/2}\\,\\mathbf{u}_{i+1}\\right)\n$$\n为清晰起见，我们计算 $h^2 \\mathbf{r}_i$：\n\n索引 $2j-1$ 处的分量：\n$$\nh^2 \\mathbf{r}_{2j-1} = -k_{2j-3/2}\\mathbf{u}_{2j-2} + (k_{2j-3/2}+k_{2j-1/2})\\mathbf{u}_{2j-1} - k_{2j-1/2}\\mathbf{u}_{2j}\n$$\n代入步骤1中 $\\mathbf{u}_{i}$ 的表达式：\n$$\nh^2 \\mathbf{r}_{2j-1} = -k_{2j-3/2}\\mathbf{v}_{j-1} + (k_{2j-3/2}+k_{2j-1/2})\\frac{1}{2}(\\mathbf{v}_{j-1} + \\mathbf{v}_{j}) - k_{2j-1/2}\\mathbf{v}_{j}\n$$\n收集 $\\mathbf{v}_{j-1}$ 和 $\\mathbf{v}_{j}$ 的项：\n$$\nh^2 \\mathbf{r}_{2j-1} = \\left(-\\frac{1}{2}k_{2j-3/2} + \\frac{1}{2}k_{2j-1/2}\\right)\\mathbf{v}_{j-1} + \\left(\\frac{1}{2}k_{2j-3/2} - \\frac{1}{2}k_{2j-1/2}\\right)\\mathbf{v}_{j}\n$$\n\n索引 $2j$ 处的分量：\n$$\nh^2 \\mathbf{r}_{2j} = -k_{2j-1/2}\\mathbf{u}_{2j-1} + (k_{2j-1/2}+k_{2j+1/2})\\mathbf{u}_{2j} - k_{2j+1/2}\\mathbf{u}_{2j+1}\n$$\n代入：\n$$\nh^2 \\mathbf{r}_{2j} = -k_{2j-1/2}\\frac{1}{2}(\\mathbf{v}_{j-1} + \\mathbf{v}_{j}) + (k_{2j-1/2}+k_{2j+1/2})\\mathbf{v}_{j} - k_{2j+1/2}\\frac{1}{2}(\\mathbf{v}_{j} + \\mathbf{v}_{j+1})\n$$\n收集 $\\mathbf{v}_{j-1}$、$\\mathbf{v}_{j}$ 和 $\\mathbf{v}_{j+1}$ 的项：\n$$\nh^2 \\mathbf{r}_{2j} = \\left(-\\frac{1}{2}k_{2j-1/2}\\right)\\mathbf{v}_{j-1} + \\left(\\frac{1}{2}k_{2j-1/2} + \\frac{1}{2}k_{2j+1/2}\\right)\\mathbf{v}_{j} + \\left(-\\frac{1}{2}k_{2j+1/2}\\right)\\mathbf{v}_{j+1}\n$$\n\n索引 $2j+1$ 处的分量：\n$$\nh^2 \\mathbf{r}_{2j+1} = -k_{2j+1/2}\\mathbf{u}_{2j} + (k_{2j+1/2}+k_{2j+3/2})\\mathbf{u}_{2j+1} - k_{2j+3/2}\\mathbf{u}_{2j+2}\n$$\n代入：\n$$\nh^2 \\mathbf{r}_{2j+1} = -k_{2j+1/2}\\mathbf{v}_{j} + (k_{2j+1/2}+k_{2j+3/2})\\frac{1}{2}(\\mathbf{v}_{j} + \\mathbf{v}_{j+1}) - k_{2j+3/2}\\mathbf{v}_{j+1}\n$$\n收集 $\\mathbf{v}_{j}$ 和 $\\mathbf{v}_{j+1}$ 的项：\n$$\nh^2 \\mathbf{r}_{2j+1} = \\left(-\\frac{1}{2}k_{2j+1/2} + \\frac{1}{2}k_{2j+3/2}\\right)\\mathbf{v}_{j} + \\left(\\frac{1}{2}k_{2j+1/2} - \\frac{1}{2}k_{2j+3/2}\\right)\\mathbf{v}_{j+1}\n$$\n\n**步骤3：限制算子 $\\mathbf{R}$ 的作用**\n最后，我们将全加权限制算子应用于向量 $\\mathbf{r}$：\n$$\n(\\mathbf{A}_{c}\\mathbf{v})_{j} = (\\mathbf{R}\\mathbf{r})_j = \\frac{1}{4}\\mathbf{r}_{2j-1} + \\frac{1}{2}\\mathbf{r}_{2j} + \\frac{1}{4}\\mathbf{r}_{2j+1}\n$$\n我们代入 $\\mathbf{r}_i$ 的表达式，并收集 $\\mathbf{v}_{j-1}$、$\\mathbf{v}_{j}$ 和 $\\mathbf{v}_{j+1}$ 的系数，这些系数即为模板系数 $a^c_{j,j-1}$、$a^c_{j,j}$ 和 $a^c_{j,j+1}$。\n$$\nh^2(\\mathbf{A}_{c}\\mathbf{v})_{j} = \\frac{1}{4}(h^2\\mathbf{r}_{2j-1}) + \\frac{1}{2}(h^2\\mathbf{r}_{2j}) + \\frac{1}{4}(h^2\\mathbf{r}_{2j+1})\n$$\n\n$\\mathbf{v}_{j-1}$ 的系数：\n$$\nh^2 a^c_{j,j-1} = \\frac{1}{4}\\left(-\\frac{1}{2}k_{2j-3/2} + \\frac{1}{2}k_{2j-1/2}\\right) + \\frac{1}{2}\\left(-\\frac{1}{2}k_{2j-1/2}\\right) = -\\frac{1}{8}k_{2j-3/2} - \\frac{1}{8}k_{2j-1/2} = -\\frac{1}{8}(k_{2j-3/2} + k_{2j-1/2})\n$$\n\n$\\mathbf{v}_{j+1}$ 的系数：\n根据对称性，我们可以通过将所有索引移动 $+2$ 从 $\\mathbf{v}_{j-1}$ 的系数推断出此结果：\n$$\nh^2 a^c_{j,j+1} = -\\frac{1}{8}(k_{2(j+1)-3/2} + k_{2(j+1)-1/2}) = -\\frac{1}{8}(k_{2j+1/2} + k_{2j+3/2})\n$$\n让我们直接验证：\n$$\nh^2 a^c_{j,j+1} = \\frac{1}{2}\\left(-\\frac{1}{2}k_{2j+1/2}\\right) + \\frac{1}{4}\\left(\\frac{1}{2}k_{2j+1/2} - \\frac{1}{2}k_{2j+3/2}\\right) = -\\frac{1}{4}k_{2j+1/2} + \\frac{1}{8}k_{2j+1/2} - \\frac{1}{8}k_{2j+3/2} = -\\frac{1}{8}(k_{2j+1/2} + k_{2j+3/2})\n$$\n结果得到确认。\n\n$\\mathbf{v}_{j}$ 的系数：\n$$\nh^2 a^c_{j,j} = \\frac{1}{4}\\left(\\frac{1}{2}k_{2j-3/2} - \\frac{1}{2}k_{2j-1/2}\\right) + \\frac{1}{2}\\left(\\frac{1}{2}k_{2j-1/2} + \\frac{1}{2}k_{2j+1/2}\\right) + \\frac{1}{4}\\left(-\\frac{1}{2}k_{2j+1/2} + \\frac{1}{2}k_{2j+3/2}\\right)\n$$\n$$\nh^2 a^c_{j,j} = \\frac{1}{8}k_{2j-3/2} - \\frac{1}{8}k_{2j-1/2} + \\frac{1}{4}k_{2j-1/2} + \\frac{1}{4}k_{2j+1/2} - \\frac{1}{8}k_{2j+1/2} + \\frac{1}{8}k_{2j+3/2}\n$$\n$$\nh^2 a^c_{j,j} = \\frac{1}{8}k_{2j-3/2} + \\frac{1}{8}k_{2j-1/2} + \\frac{1}{8}k_{2j+1/2} + \\frac{1}{8}k_{2j+3/2} = \\frac{1}{8}(k_{2j-3/2} + k_{2j-1/2} + k_{2j+1/2} + k_{2j+3/2})\n$$\n注意到 $a^c_{j,j-1} + a^c_{j,j} + a^c_{j,j+1} = 0$，这对于一个守恒格式是符合预期的。\n\n**步骤4：用粗网格间距 $H$ 表示**\n问题使用粗网格间距 $H=2h$，因此 $h^2 = H^2/4$。为了找到最终的系数，我们除以 $h^2$：\n$$\na^c_{j,j-1} = \\frac{1}{h^2}\\left[-\\frac{1}{8}(k_{2j-3/2} + k_{2j-1/2})\\right] = \\frac{4}{H^2}\\left[-\\frac{1}{8}(k_{2j-3/2} + k_{2j-1/2})\\right] = -\\frac{k_{2j-3/2} + k_{2j-1/2}}{2H^2}\n$$\n$$\na^c_{j,j} = \\frac{1}{h^2}\\left[\\frac{1}{8}(k_{2j-3/2} + k_{2j-1/2} + k_{2j+1/2} + k_{2j+3/2})\\right] = \\frac{k_{2j-3/2} + k_{2j-1/2} + k_{2j+1/2} + k_{2j+3/2}}{2H^2}\n$$\n$$\na^c_{j,j+1} = \\frac{1}{h^2}\\left[-\\frac{1}{8}(k_{2j+1/2} + k_{2j+3/2})\\right] = -\\frac{k_{2j+1/2} + k_{2j+3/2}}{2H^2}\n$$\n\n**第二部分：验证对称正定（SPD）性质**\n\n**对称性：**\n伽辽金粗网格算子为 $\\mathbf{A}_{c} = \\mathbf{R}\\mathbf{A}\\mathbf{P}$。如果一个算子等于其转置，即 $\\mathbf{A}_{c} = \\mathbf{A}_{c}^T$，则该算子是对称的。\n其转置为 $\\mathbf{A}_{c}^T = (\\mathbf{R}\\mathbf{A}\\mathbf{P})^T = \\mathbf{P}^T \\mathbf{A}^T \\mathbf{R}^T$。\n细网格算子 $\\mathbf{A}$ 是一个对称矩阵，因此 $\\mathbf{A}^T = \\mathbf{A}$。\n所指定的限制算子和延长算子通过 $\\mathbf{R} = \\frac{1}{2}\\mathbf{P}^T$ 相关联。为了看到这一点，我们可以检查它们在对偶配对（内积）中的作用。对于任意细网格向量 $\\mathbf{r}$ 和粗网格向量 $\\mathbf{v}$，$\\langle \\mathbf{r}, \\mathbf{P}\\mathbf{v} \\rangle_{f} = \\langle \\mathbf{P}^T \\mathbf{r}, \\mathbf{v} \\rangle_{c}$。显式计算表明 $\\mathbf{P}^T\\mathbf{r} = 2(\\mathbf{R}\\mathbf{r})$，因此 $\\mathbf{R}=\\frac{1}{2}\\mathbf{P}^T$。\n将此代入 $\\mathbf{A}_c$ 的定义得到 $\\mathbf{A}_{c} = \\frac{1}{2}\\mathbf{P}^T \\mathbf{A} \\mathbf{P}$。\n现在我们检查 $\\mathbf{A}_{c}$ 的转置：\n$$\n\\mathbf{A}_{c}^T = \\left(\\frac{1}{2}\\mathbf{P}^T \\mathbf{A} \\mathbf{P}\\right)^T = \\frac{1}{2} \\mathbf{P}^T \\mathbf{A}^T (\\mathbf{P}^T)^T = \\frac{1}{2} \\mathbf{P}^T \\mathbf{A} \\mathbf{P} = \\mathbf{A}_{c}\n$$\n因此，$\\mathbf{A}_{c}$ 是对称的。\n\n**正定性：**\n我们必须证明，对于任何非零的粗网格向量 $\\mathbf{v}$（满足齐次边界条件），二次型 $\\mathbf{v}^T \\mathbf{A}_{c} \\mathbf{v}$ 是严格为正的。\n$$\n\\mathbf{v}^T \\mathbf{A}_{c} \\mathbf{v} = \\mathbf{v}^T \\left(\\frac{1}{2}\\mathbf{P}^T \\mathbf{A} \\mathbf{P}\\right) \\mathbf{v} = \\frac{1}{2} (\\mathbf{P}\\mathbf{v})^T \\mathbf{A} (\\mathbf{P}\\mathbf{v})\n$$\n令 $\\mathbf{u} = \\mathbf{P}\\mathbf{v}$。表达式变为 $\\frac{1}{2}\\mathbf{u}^T \\mathbf{A} \\mathbf{u}$。\n\n首先，我们证明 $\\mathbf{A}$ 是正定的。$\\mathbf{A}$ 的二次型可以通过分部求和表示为离散能量范数：\n$$\n\\mathbf{u}^T \\mathbf{A} \\mathbf{u} = \\sum_{i=1}^{N-1} \\mathbf{u}_i (\\mathbf{A}\\mathbf{u})_i = \\frac{1}{h^2} \\sum_{i=0}^{N-1} k_{i+1/2}(\\mathbf{u}_{i+1} - \\mathbf{u}_i)^2\n$$\n鉴于电导率 $k_{i+1/2}$ 严格为正，这个平方和总是非负的。它为零当且仅当对于所有 $i=0, \\dots, N-1$，都有 $\\mathbf{u}_{i+1} - \\mathbf{u}_i = 0$。这意味着 $\\mathbf{u}$ 必须是一个常数向量。由于齐次狄利克雷边界条件 $\\mathbf{u}_0 = \\mathbf{u}_N = 0$，这迫使该常数为零。因此，$\\mathbf{u}^T \\mathbf{A} \\mathbf{u} = 0$ 当且仅当 $\\mathbf{u} = \\mathbf{0}$。所以，$\\mathbf{A}$ 是正定的。\n\n其次，我们需要确保如果 $\\mathbf{v} \\neq \\mathbf{0}$，则 $\\mathbf{u} = \\mathbf{P}\\mathbf{v} \\neq \\mathbf{0}$。算子 $\\mathbf{P}$ 是单射的（其零空间是平凡的）。如果 $\\mathbf{v}$ 是一个非零的粗网格向量，则至少存在一个内部索引 $j$ 使得 $\\mathbf{v}_j \\neq 0$。根据 $\\mathbf{P}$ 的定义，相应的细网格分量是 $(\\mathbf{P}\\mathbf{v})_{2j} = \\mathbf{v}_j \\neq 0$。这意味着 $\\mathbf{P}\\mathbf{v}$不可能是零向量。\n\n结合这两个事实：对于任何非零的粗网格向量 $\\mathbf{v}$，延长后的向量 $\\mathbf{u} = \\mathbf{P}\\mathbf{v}$ 是一个非零的细网格向量。由于 $\\mathbf{A}$ 是正定的，所以 $\\mathbf{u}^T\\mathbf{A}\\mathbf{u}  0$。因此：\n$$\n\\mathbf{v}^T \\mathbf{A}_{c} \\mathbf{v} = \\frac{1}{2}\\mathbf{u}^T \\mathbf{A} \\mathbf{u}  0\n$$\n这证明了 $\\mathbf{A}_{c}$ 是正定的。由于它也是对称的，$\\mathbf{A}_{c}$ 是对称正定（SPD）的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{k_{2j-3/2} + k_{2j-1/2}}{2H^2}  \\frac{k_{2j-3/2} + k_{2j-1/2} + k_{2j+1/2} + k_{2j+3/2}}{2H^2}  -\\frac{k_{2j+1/2} + k_{2j+3/2}}{2H^2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "我们已经分析了多重网格的内部组件，现在是时候从宏观角度评估其作为预条件子的整体效能了。一个理想的预条件子能够显著改善线性系统的条件数，使得迭代求解器（如共轭梯度法）的收敛速度与网格规模无关。本练习通过一个三维热传导问题的具体计算，让你量化对比未使用和使用多重网格预条件子时共轭梯度法的迭代次数，直观地感受多重网格方法在加速大规模科学计算中的巨大威力。",
            "id": "3974261",
            "problem": "考虑在单位立方体上的三维稳态热传导方程，该方程在热导率恒定的情况下简化为拉普拉斯方程 $-\\nabla^2 T = 0$，并带有齐次狄利克雷边界条件。在每个坐标方向上具有 $n$ 个内部点的均匀网格上，使用二阶中心差分对方程进行离散化，得到一个线性系统 $\\mathbf{A}\\mathbf{u}=\\mathbf{b}$，其中 $\\mathbf{A}$ 是对称正定矩阵。离散算子对应于标准的七点模板，按 $1/h^2$ 进行缩放，网格间距为 $h=1/(n+1)$。假设使用共轭梯度法（CG）求解该线性系统，并可选择在每次 CG 迭代中应用一次多重网格（MG）预条件子（预条件共轭梯度法，PCG）。\n\n从具有齐次狄利克雷边界条件的离散拉普拉斯算子的基本性质出发，推导适用于此设置的矩阵 $\\mathbf{A}$ 的极端特征值，然后获得条件数 $\\kappa(\\mathbf{A})$，并使用共轭梯度法的标准能量范数收敛界来估计将误差的能量范数减小一个指定因子所需的迭代次数。对于多重网格预条件的情况，假设每次 PCG 迭代都实现一个估计的每循环几何收敛因子 $\\rho \\in (0,1)$，并计算将误差减小相同因子所需的最小迭代次数。\n\n对于所有计算，设置 $n=128$（即问题规模为 $128^3$ 个内部未知数）。对于无预条件的共轭梯度法，令收敛性估计基于从矩阵 $\\mathbf{A}$ 的条件数推导出的能量范数误差界。对于多重网格预条件的情况，使用简化假设，即每次 PCG 迭代都将误差减小因子 $\\rho$，且该因子与 $n$ 无关。\n\n您的程序必须为每个测试用例计算一对整数 $[k_{\\mathrm{CG}},k_{\\mathrm{PCG}}]$，其中 $k_{\\mathrm{CG}}$ 是将误差的能量范数减小因子 $\\tau$ 所需的最小共轭梯度迭代次数（使用从基本原理推导出的界限），而 $k_{\\mathrm{PCG}}$ 是在几何衰减模型下（因子为 $\\rho$）所需的最小预条件共轭梯度迭代次数。整数 $k_{\\mathrm{CG}}$ 必须是满足标准界限保证衰减至少达到 $\\tau$ 的最小整数 $k$，而 $k_{\\mathrm{PCG}}$ 必须是满足 $\\rho^k \\le \\tau$ 的最小整数 $k$。\n\n使用以下测试套件，其中每个案例提供目标衰减因子 $\\tau$ 和估计的 MG 每循环因子 $\\rho$：\n- 情况 1：$\\tau=10^{-6}$，$\\rho=0.1$。\n- 情况 2：$\\tau=10^{-8}$，$\\rho=0.3$。\n- 情况 3：$\\tau=10^{-10}$，$\\rho=0.8$。\n- 情况 4：$\\tau=10^{-4}$，$\\rho=0.99$。\n- 情况 5：$\\tau=10^{-12}$，$\\rho=0.05$。\n\n所有量均为无量纲。您的程序应生成单行输出，其中包含五个测试用例的结果，格式为逗号分隔的方括号对列表，并由最外层方括号包围，不含任何额外文本。例如，输出格式必须为 $[[k_{\\mathrm{CG},1},k_{\\mathrm{PCG},1}],[k_{\\mathrm{CG},2},k_{\\mathrm{PCG},2}],\\dots,[k_{\\mathrm{CG},5},k_{\\mathrm{PCG},5}]]$。",
            "solution": "所提出的问题是将数值线性代数原理应用于椭圆偏微分方程迭代求解器分析的一个明确定义的应用。它在科学上是合理的、自成体系的且客观的。我们继续进行推导和求解。\n\n问题的核心是单位立方体上的三维稳态热传导方程，对于恒定的热导率，该方程即为拉普拉斯方程：\n$$\n-\\nabla^2 T = - \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} + \\frac{\\partial^2 T}{\\partial z^2} \\right) = 0\n$$\n在区域 $\\Omega = [0,1]^3$ 的边界上，带有齐次狄利克雷边界条件 $T=0$。\n\n我们在每个坐标方向上具有 $n$ 个内部点的均匀网格上离散化此方程。网格间距为 $h = 1/(n+1)$。在内部网格点 $(x_i, y_j, z_k)$ 处，对二阶导数使用二阶中心差分近似，我们有：\n$$\n-\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_{(i,j,k)} \\approx -\\frac{T_{i-1,j,k} - 2T_{i,j,k} + T_{i+1,j,k}}{h^2}\n$$\n对于 $y$ 和 $z$ 方向的导数也是如此。将这些项相加，得到每个内部点处负拉普拉斯算子的离散方程：\n$$\n(-\\nabla^2_h T)_{i,j,k} = \\frac{1}{h^2} \\left( 6T_{i,j,k} - T_{i-1,j,k} - T_{i+1,j,k} - T_{i,j-1,k} - T_{i,j+1,k} - T_{i,j,k-1} - T_{i,j,k+1} \\right) = 0\n$$\n这就构成了一个线性系统 $\\mathbf{A}\\mathbf{u}=\\mathbf{b}$，其中 $\\mathbf{u}$ 是 $n^3$ 个内部点上未知温度的向量。矩阵 $\\mathbf{A}$ 代表标准的7点离散拉普拉斯算子，并按 $1/h^2$ 进行了缩放。由于齐次边界条件，右侧向量 $\\mathbf{b}$ 为零。矩阵 $\\mathbf{A}$ 是对称且正定的。\n\n为了分析共轭梯度法（CG）的收敛性，我们必须确定条件数 $\\kappa(\\mathbf{A})$，即其最大特征值与最小特征值的比值，$\\kappa(\\mathbf{A}) = \\lambda_{\\max} / \\lambda_{\\min}$。\n\n三维离散拉普拉斯算子的特征值可以通过分离变量法，从一维情况构建得到。在 $n$ 个内部点上的一维离散拉普拉斯矩阵是 $L_{1D} = \\frac{1}{h^2} \\text{tridiag}(-1, 2, -1)$。其特征值已知为：\n$$\n\\lambda_p = \\frac{2}{h^2}\\left(1 - \\cos\\left(\\frac{p\\pi}{n+1}\\right)\\right) = \\frac{4}{h^2}\\sin^2\\left(\\frac{p\\pi}{2(n+1)}\\right), \\quad p = 1, 2, \\dots, n\n$$\n三维矩阵 $\\mathbf{A}$ 可以用一维矩阵的克罗内克和表示：$\\mathbf{A} = L_{1D} \\otimes I \\otimes I + I \\otimes L_{1D} \\otimes I + I \\otimes I \\otimes L_{1D}$。因此，矩阵 $\\mathbf{A}$ 的特征值是来自每个维度的特征值之和：\n$$\n\\lambda_{p,q,r} = \\lambda_p + \\lambda_q + \\lambda_r = \\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{p\\pi}{2(n+1)}\\right) + \\sin^2\\left(\\frac{q\\pi}{2(n+1)}\\right) + \\sin^2\\left(\\frac{r\\pi}{2(n+1)}\\right) \\right]\n$$\n其中 $p, q, r \\in \\{1, 2, \\dots, n\\}$。\n\n最小特征值 $\\lambda_{\\min}$ 对应于最低频率模式，此时 $p=q=r=1$：\n$$\n\\lambda_{\\min} = \\lambda_{1,1,1} = \\frac{4}{h^2} \\left[ 3 \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right) \\right] = \\frac{12}{h^2} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n最大特征值 $\\lambda_{\\max}$ 对应于最高频率模式，此时 $p=q=r=n$：\n$$\n\\lambda_{\\max} = \\lambda_{n,n,n} = \\frac{4}{h^2} \\left[ 3 \\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right) \\right]\n$$\n使用恒等式 $\\sin\\left(\\frac{n\\pi}{2(n+1)}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = \\cos\\left(\\frac{\\pi}{2(n+1)}\\right)$，我们得到：\n$$\n\\lambda_{\\max} = \\frac{12}{h^2} \\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n矩阵 $\\mathbf{A}$ 的条件数则为：\n$$\n\\kappa(\\mathbf{A}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\frac{12}{h^2} \\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\frac{12}{h^2} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nCG方法的收敛性由条件数决定。经过 $k$ 次迭代后的误差 $e_k = u - u_k$，在能量范数 $\\|e_k\\|_{\\mathbf{A}} = \\sqrt{e_k^T \\mathbf{A} e_k}$ 下度量，满足以下标准界限：\n$$\n\\|e_k\\|_{\\mathbf{A}} \\le 2 \\left( \\frac{\\sqrt{\\kappa(\\mathbf{A})} - 1}{\\sqrt{\\kappa(\\mathbf{A})} + 1} \\right)^k \\|e_0\\|_{\\mathbf{A}}\n$$\n我们需要找到最小整数 $k$（记为 $k_{\\mathrm{CG}}$），使得误差减小因子 $\\tau$，即 $\\|e_k\\|_{\\mathbf{A}} / \\|e_0\\|_{\\mathbf{A}} \\le \\tau$。这需要在不等式中求解 $k$：\n$$\n2 \\left( \\frac{\\sqrt{\\kappa(\\mathbf{A})} - 1}{\\sqrt{\\kappa(\\mathbf{A})} + 1} \\right)^k \\le \\tau\n$$\n对两边取自然对数：\n$$\n\\ln(2) + k \\ln\\left(\\frac{\\sqrt{\\kappa(\\mathbf{A})} - 1}{\\sqrt{\\kappa(\\mathbf{A})} + 1}\\right) \\le \\ln(\\tau)\n$$\n由于 $\\sqrt{\\kappa(\\mathbf{A})}  1$，对数内的项小于1，使得对数值为负。因此，在求解 $k$ 时，不等式反向：\n$$\nk \\ge \\frac{\\ln(\\tau) - \\ln(2)}{\\ln\\left(\\frac{\\sqrt{\\kappa(\\mathbf{A})} - 1}{\\sqrt{\\kappa(\\mathbf{A})} + 1}\\right)} = \\frac{\\ln(\\tau/2)}{\\ln\\left(\\frac{\\sqrt{\\kappa(\\mathbf{A})} - 1}{\\sqrt{\\kappa(\\mathbf{A})} + 1}\\right)}\n$$\n最小整数迭代次数是此表达式的向上取整：\n$$\nk_{\\mathrm{CG}} = \\left\\lceil \\frac{\\ln(\\tau/2)}{\\ln\\left(\\frac{\\cot(\\frac{\\pi}{2(n+1)}) - 1}{\\cot(\\frac{\\pi}{2(n+1)}) + 1}\\right)} \\right\\rceil\n$$\n对于多重网格预条件的共轭梯度法（PCG）情况，问题提供了一个简化模型，其中每次迭代将误差减小一个常数因子 $\\rho$。我们寻求达到衰减因子 $\\tau$ 所需的最小迭代次数 $k$（记为 $k_{\\mathrm{PCG}}$）。其控制不等式为：\n$$\n\\rho^k \\le \\tau\n$$\n取自然对数：\n$$\nk \\ln(\\rho) \\le \\ln(\\tau)\n$$\n由于 $\\rho \\in (0,1)$，$\\ln(\\rho)$ 为负值。求解 $k$ 会使不等式反向：\n$$\nk \\ge \\frac{\\ln(\\tau)}{\\ln(\\rho)}\n$$\n因此，最小整数迭代次数为：\n$$\nk_{\\mathrm{PCG}} = \\left\\lceil \\frac{\\ln(\\tau)}{\\ln(\\rho)} \\right\\rceil\n$$\n对于所有计算，问题指定 $n=128$。我们将使用此值以及测试用例参数 $(\\tau, \\rho)$ 来计算数对 $[k_{\\mathrm{CG}}, k_{\\mathrm{PCG}}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the estimated number of iterations for Conjugate Gradient (CG)\n    and Preconditioned Conjugate Gradient (PCG) methods for solving the\n    3D discretized Laplace equation based on provided theoretical models.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains: (error reduction factor tau, MG convergence factor rho)\n    test_cases = [\n        (1e-6, 0.1),\n        (1e-8, 0.3),\n        (1e-10, 0.8),\n        (1e-4, 0.99),\n        (1e-12, 0.05),\n    ]\n\n    # Number of interior grid points per dimension\n    n = 128\n\n    # --- CG Iteration Count Calculation ---\n\n    # Derivation steps for k_CG:\n    # 1. Condition number kappa = cot(pi / (2*(n+1)))^2\n    # 2. sqrt(kappa) = cot(pi / (2*(n+1)))\n    # 3. CG convergence factor gamma = (sqrt(kappa) - 1) / (sqrt(kappa) + 1)\n    # 4. Error bound: 2 * gamma^k = tau\n    # 5. k = log(tau / 2) / log(gamma)\n    \n    n_plus_1 = n + 1\n    # Argument for the cotangent function\n    angle = np.pi / (2.0 * n_plus_1)\n    # The square root of the condition number\n    sqrt_kappa = 1.0 / np.tan(angle)\n    \n    # The convergence factor in the CG error bound\n    cg_conv_factor = (sqrt_kappa - 1.0) / (sqrt_kappa + 1.0)\n    log_cg_conv_factor = np.log(cg_conv_factor)\n\n    results = []\n    for tau, rho in test_cases:\n        # --- Calculate k_CG for the current test case ---\n        log_tau_div_2 = np.log(tau / 2.0)\n        # k_CG is the smallest integer k satisfying the bound\n        k_cg = int(math.ceil(log_tau_div_2 / log_cg_conv_factor))\n\n        # --- PCG Iteration Count Calculation ---\n\n        # Derivation steps for k_PCG:\n        # 1. Error model: rho^k = tau\n        # 2. k = log(tau) / log(rho)\n        log_tau = np.log(tau)\n        log_rho = np.log(rho)\n        # k_PCG is the smallest integer k satisfying the model\n        k_pcg = int(math.ceil(log_tau / log_rho))\n\n        results.append([k_cg, k_pcg])\n\n    # Final print statement in the exact required format.\n    # e.g., [[k_CG,1,k_PCG,1],[k_CG,2,k_PCG,2],...,[k_CG,5,k_PCG,5]]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}