## 引言
在[计算流体动力学](@entry_id:142614)（CFD）领域，对[不可压缩流](@entry_id:140301)动的模拟构成了众多工程与科学问题的基础。然而，与可压缩流不同，[不可压缩流](@entry_id:140301)的控制方程中缺少一个直接求解压力的独立方程。压力在此不再是简单的热力学状态量，而是转变为一个确保速度场满足[质量守恒定律](@entry_id:147377)的约束工具。如何高效、准确地处理这种隐含的压力-速度耦合关系，是不可压缩流CFD求解器设计的核心挑战，也是本文旨在阐明的知识要点。

本文将系统性地剖析解决这一难题的关键技术——压力校正方法。我们将带领读者深入其核心，揭示其从基本原理到复杂应用的完整图景。
在“**原理与机制**”一章中，我们将从第一性原理出发，推导压力校正方程，阐明其作为椭圆型泊松方程的数学本质和物理意义，并探讨SIMPLE等经典算法的“预测-校正”策略。
接着，在“**应用与跨学科联系**”一章中，我们将展示该方法如何被巧妙扩展，以应对复杂几何、变密度、热[浮力](@entry_id:154088)、化学反应和多相流等前沿工程挑战，彰显其在[热力学](@entry_id:172368)、燃烧学等领域的交叉应用价值。
最后，通过“**动手实践**”部分提供的编程练习，您将有机会将理论付诸实践，亲手构建和求解压力校正系统，从而获得对[CFD求解器](@entry_id:747244)内部工作机制的深刻理解。

## 原理与机制

在不可压缩流动的[计算流体动力学](@entry_id:142614)（CFD）中，压力扮演着一个独特而关键的角色。与[可压缩流](@entry_id:747589)不同，不可压缩流的密度为常数，这意味着压力不再是可通过状态方程直接求解的[热力学变量](@entry_id:160587)。相反，压[力场](@entry_id:147325)的作用是瞬时调整自身，以确保速度场始终满足质量守恒定律，即[无散度约束](@entry_id:748603)。为了在数值上处理这种特殊的压力-速度耦合关系，发展出了一系列基于“压力校正”思想的算法，其中最著名的是SIMPLE（Semi-Implicit Method for Pressure-Linked Equations）算法及其变体。本章将深入探讨压力校正方法的基本原理、核心机制、数值实现中的挑战以及主要算法家族的特点。

### [不可压缩流](@entry_id:140301)中压力的独特作用

对于一个密度 $\rho$ 恒定的[不可压缩流](@entry_id:140301)，其控制方程通常为纳维-斯托克斯（[Navier-Stokes](@entry_id:276387)）方程：

$$
\rho \frac{D \mathbf{u}}{D t} = - \nabla p + \mu \nabla^{2} \mathbf{u} + \mathbf{f}
$$

$$
\nabla \cdot \mathbf{u} = 0
$$

其中，$\mathbf{u}$ 是[速度矢量](@entry_id:269648)， $p$ 是压力，$\mu$ 是[动力粘度](@entry_id:268228)，$\mathbf{f}$ 是体积力。动量方程描述了作用力（压力梯度、[粘性力](@entry_id:263294)、体积力）如何改变流体的运动，而[连续性方程](@entry_id:195013)（即 $\nabla \cdot \mathbf{u} = 0$）则是一个运动学约束，要求速度场必须是无散度的。

一个显而易见的问题是：这组方程中没有为压力 $p$ 提供独立的演化方程。在可压缩流中，压力、密度和温度通过[热力学状态](@entry_id:755916)方程（如[理想气体定律](@entry_id:146757)）相互关联，使得压力可以作为[独立变量](@entry_id:267118)求解。但在不可压缩流中，压力失去了其[热力学](@entry_id:172368)意义，转而扮演一个纯粹的数学角色：它是一个**拉格朗日乘子（Lagrange multiplier）**。其唯一的功能就是调整自身的大小和分布，以强制速度场满足[无散度约束](@entry_id:748603) 。

从数学角度看，当我们将完整的、耦合的离散化方程组写成矩阵形式时，会得到一个典型的**[鞍点系统](@entry_id:754480)（saddle-point system）**  ：

$$
\begin{pmatrix}
\mathbf{A} & \mathbf{G} \\
\mathbf{D} & \mathbf{0}
\end{pmatrix}
\begin{pmatrix}
\mathbf{U} \\
\mathbf{P}
\end{pmatrix}
=
\begin{pmatrix}
\mathbf{F} \\
\mathbf{0}
\end{pmatrix}
$$

其中 $\mathbf{U}$ 和 $\mathbf{P}$ 是速度和压力的未知数向量，$\mathbf{A}$ 代表离散的动量输运算子，$\mathbf{G}$ 是[离散梯度](@entry_id:171970)算子，$\mathbf{D}$ 是离散散度算子。该矩阵右下角的零块（压力-压力耦合项为零）正是[鞍点问题](@entry_id:174221)的标志。这种结构对[直接求解器](@entry_id:152789)提出了巨大挑战，并促使了分离式（segregated）求解算法的发展，压力校正方法便是其中的核心。

### 预测-校正策略：压力校正的诞生

[分离式求解器](@entry_id:1131384)的核心思想是避免直接求解庞大而复杂的耦合系统，转而对速度和压力进行序贯的、迭代的求解。**SIMPLE** 算法是这一思想的经典体现，其“预测-校正”循环步骤如下 ：

1.  **猜测压[力场](@entry_id:147325)**：首先，需要一个初始的或来自上一次迭代的压[力场](@entry_id:147325)，记为 $p^*$。

2.  **预测步（Predictor Step）**：使用猜测的压[力场](@entry_id:147325) $p^*$ 求解离散化的动量方程，得到一个临时的、不满足[连续性方程](@entry_id:195013)的速度场，记为 $\mathbf{u}^*$。这个速度场 $\mathbf{u}^*$ 在给定压力 $p^*$ 的情况下，满足了[动量守恒](@entry_id:149964)，但其散度 $\nabla \cdot \mathbf{u}^*$ 通常不为零。

3.  **校正步（Corrector Step）**：引入压力校正值 $p'$ 和速度校正值 $\mathbf{u}'$，使得最终的压[力场](@entry_id:147325) $p$ 和速度场 $\mathbf{u}$ 可以表示为：

    $$
    p = p^* + p'
    $$
    $$
    \mathbf{u} = \mathbf{u}^* + \mathbf{u}'
    $$

    我们的目标是找到一个合适的 $p'$，通过它计算出相应的 $\mathbf{u}'$，从而使得最终的速度场 $\mathbf{u}$ 能够精确满足连续性方程，即 $\nabla \cdot \mathbf{u} = 0$。这个过程的关键在于建立一个用于求解 $p'$ 的方程，这便是压力校正方程。

### 压力校正方程的推导与机制

压力校正方程的推导始于对最终速度场 $\mathbf{u}$ 必须满足的连续性方程：

$$
\nabla \cdot \mathbf{u} = 0
$$

将校正关系式代入，得到：

$$
\nabla \cdot (\mathbf{u}^* + \mathbf{u}') = 0 \implies \nabla \cdot \mathbf{u}' = - \nabla \cdot \mathbf{u}^*
$$

这个关系式表明，速度校正场 $\mathbf{u}'$ 的散度必须等于预测速度场 $\mathbf{u}^*$ 散度的负值。右边的 $- \nabla \cdot \mathbf{u}^*$ 代表了在预测步之后，每个控制体积内的**质量不平衡量**或**质量残差**，它是已知的。

下一步是建立速度校正值 $\mathbf{u}'$ 和压力校正值 $p'$ 之间的联系。这个联系源于动量方程。离散化的[动量方程](@entry_id:197225)可以写成如下形式，其中 $a_P$ 是中心节点的系数，$H(\mathbf{u})$ 代表了邻近节点速度和源项的贡献：

$$
a_P \mathbf{u}_P = H(\mathbf{u}) - V \nabla_d p
$$

将校正关系代入，并进行简化，可以得到速度校正值与压力校正值梯度之间的近似关系。SIMPLE算法的核心近似在于忽略了邻居速度校正值对中心节点速度校正值的影响，从而得到一个显式关系 ：

$$
\mathbf{u}' \approx -d \nabla p'
$$

其中系数 $d$ 通常与离散动量方程的中心系数 $a_P$ 的倒数成正比（例如 $d_P = V/a_P$）。这个关系式直观地表明，压力校正值的梯度驱动了速度的校正。

最后，将这个速度校正关系代入到[连续性方程](@entry_id:195013) $\nabla \cdot \mathbf{u}' = - \nabla \cdot \mathbf{u}^*$ 中，我们便得到了一个关于未知量 $p'$ 的方程：

$$
\nabla \cdot (d \nabla p') = \nabla \cdot \mathbf{u}^*
$$

这是一个泊松（Poisson）型方程，其数学性质是**椭圆型（elliptic）**的 [@problem_id:3993950, @problem_id:4063102]。方程的左边是一个作用于 $p'$ 的扩散算子，而右边是已知的质量不平衡量，作为源项。

求解这个椭圆型方程的物理意义在于，它会生成一个压力校正场 $p'$。这个 $p'$ 场会在质量盈余的区域（$\nabla \cdot \mathbf{u}^* > 0$）形成一个局部高压，在[质量亏损](@entry_id:139284)的区域（$\nabla \cdot \mathbf{u}^* < 0$）形成一个局部低压。由此产生的压力校正梯度 $-\nabla p'$ 将驱动一个校正速度场 $\mathbf{u}'$，从而将多余的质量从“源”处输运到“汇”处，直至每个控制体积内的质量不平衡都得到消除，最终实现全场范围的[质量守恒](@entry_id:204015) 。从更高等的线性代数角度看，这个压力校正方程可以被解释为原始耦合系统矩阵的**[舒尔补](@entry_id:142780)（Schur complement）**，这也进一步证实了其作为核心求解步骤的地位 。

### 数值实现中的挑战与对策

在将压力校正方法付诸实践时，会遇到一系列数值挑战，必须采用精巧的策略加以解决。

#### [压力-速度解耦](@entry_id:167545)与[Rhie-Chow插值](@entry_id:154759)

当在**同位网格（collocated grid）**（即所有变量如压力、速度分量都存储在控制体积中心）上进行离散时，一个严重的问题便会浮现：**[压力-速度解耦](@entry_id:167545)（pressure-velocity decoupling）**。如果采用简单的线性插值来计算控制体表面的速度，离散的[散度算子](@entry_id:265975)可能无法“感知”到一种[高频振荡](@entry_id:1126069)的、非物理的“棋盘格”（checkerboard）压[力场](@entry_id:147325)。在这种压[力场](@entry_id:147325)下，相邻节点的压力梯度为零，但压[力场](@entry_id:147325)本身却剧烈振荡，这会导致数值解的严重失真 [@problem_id:3442959, @problem_id:3993950]。

为了解决这个问题，Rhie和Chow提出了一种特殊的插值方法，即**[Rhie-Chow插值](@entry_id:154759)**。其核心思想是，在计算面心速度时，不仅仅依赖于相邻单元中心速度的插值，还要额外引入一个与压力梯度相关的修正项。这个修正项的构造方式与离散[动量方程](@entry_id:197225)保持一致，它有效地将相邻单元的压力直接联系起来，从而抑制了非物理的压力振荡。

采用[Rhie-Chow插值](@entry_id:154759)后，压力校正方程中的离散系数也会相应改变。例如，对于一个二维均匀网格，在东面（e）的系数 $A_E$ 可以具体推导出来 ：

$$
A_E = \rho \frac{\Delta y}{\Delta x} \frac{d_P^u + d_E^u}{2}
$$

这里，$d_P^u$ 和 $d_E^u$ 是从相邻单元 $P$ 和 $E$ 的离散动量方程中得到的系数。这种形式确保了压力的耦合，是[同位网格](@entry_id:1122659)方法成功的关键。

#### 压力校正方程的边界条件

压力校正方程是一个[偏微分](@entry_id:194612)方程，求解它需要设定适当的边界条件。这些边界条件必须根据原始流动问题的物理边界条件来确定，以保证最终校正后的速度和压[力场](@entry_id:147325)满足物理约束 。

-   **速度入口或固壁边界**：在这些边界上，法向速度是已知的（例如，入口速度为 $U_0$，壁面法向速度为 $0$）。在SIMPLE算法中，通常将预测速度的法向分量 $\mathbf{u}_n^*$ 设定为该已知值。因此，为了使最终速度 $\mathbf{u}_n = \mathbf{u}_n^* + \mathbf{u}_n'$ 满足边界条件，必须要求法向速度校正值 $\mathbf{u}_n'$ 为零。根据 $\mathbf{u}_n' \propto -\partial p' / \partial n$ 的关系，这等价于对压力校正值 $p'$ 施加一个**零梯度（齐次诺伊曼，homogeneous Neumann）**边界条件：

    $$
    \frac{\partial p'}{\partial n} = 0
    $$

-   **[压力出口](@entry_id:264948)边界**：在此类边界上，物理压力值是给定的，例如 $p = p_{out}$。为了使最终压力 $p = p^* + p'$ 满足该条件，最直接且常用的做法是假设预测压力 $p^*$ 已经满足了该值，即 $p^* = p_{out}$。这样，压力校正值必须为零。这对应于一个**零值（齐次狄利克雷，homogeneous Dirichlet）**边界条件：

    $$
    p' = 0
    $$

    这个[狄利克雷边界条件](@entry_id:173524)不仅确保了物理压力的正确施加，还为压力校正方程提供了一个绝对值的参考点，避免了下文将要讨论的“浮动压力”问题。

#### 浮动压力问题：参考点的设定

当一个计算域完全由固壁包围，或者所有边界都是速度指定边界时，压力校正方程的所有边界条件都将是诺伊曼型的。一个带有纯[诺伊曼边界条件](@entry_id:142124)的泊松方程，其解不是唯一的——任意给解加上一个常数后仍然是方程的解。这在数值上表现为离散矩阵是**奇异的（singular）**，其核空间（null space）由常数向量构成 。

为了得到唯一的解并确保[线性求解器](@entry_id:751329)的[稳定收敛](@entry_id:199422)，必须消除这种不确定性。常用的处理方法包括：

-   **钉点法（Pinning）**：在计算域中选择一个单元，并强制该单元的压力校正值为零（$p'_i = 0$）。这种方法虽然简单，但会破坏原有算子的对称性，并可能引入局部扰动，从而降低某些高级求解器（如[多重网格法](@entry_id:146386)）的效率。

-   **零平均约束（Zero-Mean Constraint）**：强制整个压力校正场的积分为零，即 $\int_{\Omega} p' dV = 0$。这是一种在数学上更优雅、在数值上更稳健的方法。它保持了算子的对称性，并且与现代迭代求解器兼容性良好，通常能获得更优的收敛性能 。

-   **核空间感知求解器（Nullspace-aware solver）**：最先进的数值方法是使用能够显式处理核空间的求解器。这些求解器通过投影等技术，在迭代过程中主动移除解向量和[残差向量](@entry_id:165091)中的常数分量，从而在一个良态的子空间中进行求解 。

### 压力校正算法家族

基于压力校正的核心思想，发展出了多种算法，它们在处理压力-速度耦合的细节和效率上有所不同。

-   **SIMPLE (Semi-Implicit Method for Pressure-Linked Equations)**：作为基础算法，SIMPLE的主要近似在于推导速度校正关系时忽略了相邻速度校正的影响。这一简化使得压力-速度耦合较弱，为了保证[迭代过程的稳定性](@entry_id:174376)，必须对压力进行**亚松弛（under-relaxation）**处理，即 $p^{\text{new}} = p^{\text{old}} + \alpha_p p'$，其中[松弛因子](@entry_id:1130825) $\alpha_p$ 通常远小于1 [@problem_id:3442959, @problem_id:3993325]。SIMPLE算法非常适合求解[稳态](@entry_id:139253)问题。

-   **SIMPLER (SIMPLE Revised)**：SIMPLER算法对SIMPLE进行了改进。在每个迭代步中，它首先求解一个更精确的、为压力本身 $p$ 构建的泊松方程，得到一个更好的预测压[力场](@entry_id:147325)。然后用这个压[力场](@entry_id:147325)求解[动量方程](@entry_id:197225)得到预测速度。最后，它再求解一个压力校正方程，但其结果仅用于校正速度场以满足连续性，而不再用来更新压[力场](@entry_id:147325)本身。这种“先求准压力，再校正速度”的策略通常能带来更快的[收敛速度](@entry_id:636873) 。

-   **PISO (Pressure-Implicit with Splitting of Operators)**：[PISO算法](@entry_id:155035)主要为**瞬态问题**设计。它不像SIMPLE那样依赖于内部迭代和亚松弛，而是在一个时间步内执行多次显式的校正步骤 。其流程通常是：一个预测步，紧跟着两个或更多的校正步。在每个校正步之后，[动量方程](@entry_id:197225)的系数和通量都会用最新的速度场重新计算。这种多次校正极大地增强了单个时间步内的[压力-速度耦合](@entry_id:155962)强度，允许使用更大的时间步长，并且无需亚松弛（即[松弛因子](@entry_id:1130825)为1），这对于保证时间精度至关重要。

### 对[可变密度流](@entry_id:756427)的拓展

一个自然的问题是：当流体密度发生变化时（例如在燃烧等[反应流](@entry_id:190741)中），压力校正方法是否依然适用？其数学性质会改变吗？

在**低马赫数（low-Mach-number）**假设下，即使密度由于温度和组分变化而显著改变，压力校正方程的椭圆性质依然保持不变 。在这种近似下，密度 $\rho$ 是温度 $T$ 和组分 $Y_k$ 的函数，但与流场中的水动力压力 $p$ [解耦](@entry_id:160890)。此时，连续性方程写为：

$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0
$$

在推导压力校正方程时，密度的时间变化项 $\frac{\partial \rho}{\partial t}$ 和由密度变化引起的散度项 $\nabla \cdot (\rho \mathbf{u}^*)$ 都会被当作已知的源项来处理。作用于未知量 $p'$ 的算子仍然是 $\nabla \cdot (k(\mathbf{x}) \nabla (\cdot))$ 的形式，其中系数 $k(\mathbf{x})$ 现在包含了变化的密度。尽管方程变得更复杂，其最[高阶导数](@entry_id:140882)项的结构没有改变，因此方程的数学性质仍然是**椭圆型**的。这意味着压力校正的基本机制——通过一个[扩散过程](@entry_id:268015)来全局性地平衡质量——在可变密度的[低马赫数流动](@entry_id:751506)中依然有效。