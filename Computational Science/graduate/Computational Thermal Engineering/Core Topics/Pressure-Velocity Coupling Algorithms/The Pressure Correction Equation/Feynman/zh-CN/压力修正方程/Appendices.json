{
    "hands_on_practices": [
        {
            "introduction": "压力修正方程是许多不可压缩流计算流体动力学（CFD）算法的核心。它源于对一个临时更新但尚未满足质量守恒的速度场强制施加质量守恒约束。这项练习对于理解连续的物理定律如何转化为计算机可以求解的离散代数系统至关重要，它揭示了线性系统 $A \\mathbf{p}' = \\mathbf{b}$ 的来源 。",
            "id": "3993952",
            "problem": "在一个长度为 $L$、均匀横截面积为 $A$ 的一维通道中，使用具有 $N$ 个相等控制体积的同位网格有限体积法模拟了密度恒为 $\\rho$ 的牛顿流体的等温不可压缩流动。能量方程被解耦且不进行求解，流动仅考虑 $x$ 方向。推导的基本依据是不可压缩流动的质量守恒方程 $\\nabla \\cdot \\mathbf{u} = 0$，以及来自不可压缩Navier-Stokes方程的动量平衡，其中对流项和扩散项采用显式处理，而新时间步的压力项采用隐式处理。采用时间步长为 $\\Delta t$ 的后向欧拉时间步进格式将解从时间层 $n$ 推进到 $n+1$。\n\n应用了分步（投影）法：首先，通过求解不含时间层 $n+1$ 压力梯度的动量方程，得到一个预测速度场 $\\mathbf{u}^{*}$；然后引入压力修正量 $p'$，使得修正后的速度 $\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p'$ 满足时间层 $n+1$ 的不可压缩连续性方程。这就得出了一个泊松型的压力修正方程。计算域被离散为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀控制体积，压力 $p'$ 存储在单元中心，面心梯度通过二阶中心差分近似，面速度 $u^{*}_{i\\pm 1/2}$ 用于计算离散散度。\n\n对于索引为 $i$ 的内部控制体积，推导三对角形式的离散压力修正方程，\n$$\na_{P} \\, p'_{i} = a_{E} \\, p'_{i+1} + a_{W} \\, p'_{i-1} + b_{i},\n$$\n其中 $a_{P}$、$a_{E}$ 和 $a_{W}$ 是线性系统系数，$b_{i}$ 是来自预测速度散度的贡献项。仅使用基本定律和所述的离散化假设，确定内部单元的对角系数 $a_{P}$ 关于横截面积 $A$ 和均匀单元宽度 $\\Delta x$ 的符号表达式。请将最终答案表示为闭式解析表达式。无需四舍五入，最终方框内的答案不应包含单位。",
            "solution": "问题陈述被评估为有效，因为它描述了一个计算流体力学中的标准、适定问题，该问题基于已建立的科学原理，并且没有矛盾或歧义。\n\n离散压力修正方程的推导始于不可压缩流分步（投影）法的基本关系。在新时间步，修正后的速度场 $\\mathbf{u}^{n+1}$ 必须满足不可压缩流体的连续性方程：\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = 0\n$$\n修正后的速度通过所提供的公式与预测速度 $\\mathbf{u}^{*}$ 和压力修正量 $p'$ 相关联：\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p'\n$$\n其中 $\\Delta t$ 是时间步长，$\\rho$ 是恒定的流体密度。\n\n将第二个方程代入第一个方程，得到连续压力修正方程：\n$$\n\\nabla \\cdot \\left( \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p' \\right) = 0\n$$\n由于 $\\Delta t$ 和 $\\rho$ 是常数，散度算子可以分配进去：\n$$\n\\nabla \\cdot \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla \\cdot (\\nabla p') = 0\n$$\n这可以重新整理为关于压力修正量 $p'$ 的泊松方程：\n$$\n\\nabla^2 p' = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^{*}\n$$\n这里，$\\nabla^2$ 是拉普拉斯算子，即 $\\nabla \\cdot \\nabla$。\n\n为使用有限体积法离散此方程，我们将其在一个通用的内部控制体积 $CV_i$ 上积分。该控制体积具有均匀宽度 $\\Delta x$ 和恒定的横截面积 $A$，因此其体积为 $V_P = A \\Delta x$。\n$$\n\\int_{CV_i} \\nabla^2 p' \\, dV = \\int_{CV_i} \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^{*} \\, dV\n$$\n对该方程两边应用散度定理，即 $\\int_V (\\nabla \\cdot \\mathbf{F}) \\, dV = \\oint_S (\\mathbf{F} \\cdot \\mathbf{n}) \\, dS$。对于一维情况，面积分简化为对控制体积东($e$)面和西($w$)面的求和，这两个面分别位于 $x_{i+1/2}$ 和 $x_{i-1/2}$。每个面的面积为 $A$。\n\n左侧 (LHS) 变为：\n$$\n\\int_{CV_i} \\nabla \\cdot (\\nabla p') \\, dV = \\oint_{S_i} (\\nabla p' \\cdot \\mathbf{n}) \\, dS = \\left[ A \\left( \\frac{\\partial p'}{\\partial x} \\right) \\right]_{e} - \\left[ A \\left( \\frac{\\partial p'}{\\partial x} \\right) \\right]_{w}\n$$\n问题指定面心梯度由二阶中心差分近似。东($e$)面的梯度使用单元中心值 $p'_{i+1}$ 和 $p'_{i}$ 近似，西($w$)面的梯度使用 $p'_{i}$ 和 $p'_{i-1}$ 近似：\n$$\n\\left( \\frac{\\partial p'}{\\partial x} \\right)_{e} \\approx \\frac{p'_{i+1} - p'_{i}}{\\Delta x}\n$$\n$$\n\\left( \\frac{\\partial p'}{\\partial x} \\right)_{w} \\approx \\frac{p'_{i} - p'_{i-1}}{\\Delta x}\n$$\n将这些近似值代入 LHS 得到：\n$$\n\\text{LHS} = A \\left( \\frac{p'_{i+1} - p'_{i}}{\\Delta x} \\right) - A \\left( \\frac{p'_{i} - p'_{i-1}}{\\Delta x} \\right) = \\frac{A}{\\Delta x} (p'_{i+1} - 2p'_{i} + p'_{i-1})\n$$\n积分方程的右侧 (RHS) 是：\n$$\n\\text{RHS} = \\frac{\\rho}{\\Delta t} \\int_{CV_i} \\nabla \\cdot \\mathbf{u}^{*} \\, dV = \\frac{\\rho}{\\Delta t} \\oint_{S_i} (\\mathbf{u}^{*} \\cdot \\mathbf{n}) \\, dS = \\frac{\\rho}{\\Delta t} \\left( [A u^{*}]_{e} - [A u^{*}]_{w} \\right)\n$$\n其中 $u^{*}_{e}$ 和 $u^{*}_{w}$ 是面心的预测速度（给定为 $u^{*}_{i+1/2}$ 和 $u^{*}_{i-1/2}$）。\n\n令 LHS 和 RHS 相等：\n$$\n\\frac{A}{\\Delta x} (p'_{i+1} - 2p'_{i} + p'_{i-1}) = \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\n我们现在必须将此方程重新整理成问题中指定的目标形式：\n$$\na_{P} \\, p'_{i} = a_{E} \\, p'_{i+1} + a_{W} \\, p'_{i-1} + b_{i}\n$$\n从我们推导的方程中，我们分离出含 $p'_{i}$ 的项：\n$$\n-\\frac{2A}{\\Delta x} p'_{i} = - \\frac{A}{\\Delta x} p'_{i+1} - \\frac{A}{\\Delta x} p'_{i-1} + \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\n将整个方程乘以 $-1$，以使 $p'_i$ 的系数为正：\n$$\n\\frac{2A}{\\Delta x} p'_{i} = \\frac{A}{\\Delta x} p'_{i+1} + \\frac{A}{\\Delta x} p'_{i-1} - \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\n该方程现在与目标形式相匹配。问题陈述中指出，$b_{i}$ 是来自预测速度散度的贡献项，并且系数 $a_P, a_E, a_W$ 应仅用 $A$ 和 $\\Delta x$ 表示。这种唯一的代数排列方式将各项划分如下：\n$$\na_{P} = \\frac{2A}{\\Delta x}\n$$\n$$\na_{E} = \\frac{A}{\\Delta x}\n$$\n$$\na_{W} = \\frac{A}{\\Delta x}\n$$\n$$\nb_{i} = - \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\n这种形式满足所有条件，特别是 $a_P$、$a_E$ 和 $a_W$ 仅依赖于几何参数 $A$ 和 $\\Delta x$，而物理参数 $\\rho$ 和时间步长 $\\Delta t$ 则被吸收到源项 $b_i$ 中。\n\n因此，内部单元的对角系数为：\n$$\na_{P} = \\frac{2A}{\\Delta x}\n$$",
            "answer": "$$\n\\boxed{\\frac{2A}{\\Delta x}}\n$$"
        },
        {
            "introduction": "在同位网格上进行离散化时，非物理性的压力振荡（棋盘格现象）可能会破坏求解结果。Rhie-Chow插值是一种广泛用于防止此类现象的技术，它通过修改面心速度的计算方式，有效地耦合了相邻的压力节点。这项理论练习使用傅里叶分析来揭示该技术为何有效 ，展示了其在抑制引起振荡的高频误差模态方面的作用，从而加深了对数值稳定性和格式设计的理解。",
            "id": "3993953",
            "problem": "考虑一个长度为 $L$ 的一维、周期性、均匀离散的域，其中有 $N$ 个间距为 $h = L/N$ 的配置控制体，流体密度 $\\rho$ 为常数，且流动为不可压缩流。在半隐式压力耦合方程方法 (SIMPLE) 中执行压力修正步骤，并使用 Rhie–Chow 插值在配置网格上计算面法向速度。Rhie–Chow 插值通过增加一个基于压力差的项来修正单元 $i$ 和 $i+1$ 之间面上的法向速度，该项源于离散化的动量方程，而其他非压力贡献项则被聚合在一个插值项中。将单元中心 $i$ 处的压力记为 $p_i$，并将面 $i+1/2$ 处由压力引起的面法向速度贡献建模为 $u_{i+1/2}^{p} = -\\delta\\,(p_{i+1} - p_i)$，其中 $\\delta > 0$ 是一个由离散化动量算子的对角占优性和网格度量决定的常数。假设所有对面法向速度的非压力贡献项要么在压力修正方程的散度项中被抵消，要么不影响压力模态耦合的分析。\n\n从质量守恒及其在不可压缩流中的离散散度形式出发，推导仅由 Rhie–Chow 压力差对法向面速度的贡献所产生的、作用于压力场的线性算子 $L$。在均匀网格上，通过考虑形式为 $p_i = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)$（其中 $x_i = i h$，波数为 $k$）的压力模态，进行傅里叶（法向模态）分析。确定归一化傅里叶符号 $\\sigma(k)$，使得 $L p_i = \\left(\\frac{\\delta}{h}\\right)\\sigma(k)\\,p_i$。\n\n最后，计算特征为 $k h = \\pi$ 的棋盘格模态所对应的归一化符号。将最终答案表示为单个实数。无需四舍五入，最终值也不应附加任何物理单位，因为所求符号根据其构造是无量纲的。",
            "solution": "推导始于不可压缩流的质量守恒原理。在一维情况下，连续性方程的微分形式为 $\\frac{du}{dx} = 0$。对于同位网格，我们将有限体积法应用于以节点 $i$ 为中心、从面 $i-\\frac{1}{2}$ 延伸到面 $i+\\frac{1}{2}$ 的控制体积。通过在控制体积上对散度进行积分并应用散度定理，可得到连续性方程的离散形式：\n$$\n\\frac{u_{i+1/2} - u_{i-1/2}}{h} = 0\n$$\n其中 $u_{i+1/2}$ 和 $u_{i-1/2}$ 是控制体面上的速度，$h$ 是均匀的网格间距。\n\n问题陈述我们只考虑由压力引起的面法向速度贡献，该贡献由 Rhie-Chow 插值模型给出：\n$$\nu_{i+1/2}^{p} = -\\delta\\,(p_{i+1} - p_i)\n$$\n其中 $p_i$ 是单元中心 $i$ 的压力，$\\delta > 0$ 是一个常数。$u_{i-1/2}^{p}$ 项可通过将索引 $i$ 移至 $i-1$ 得到：\n$$\nu_{i-1/2}^{p} = -\\delta\\,(p_i - p_{i-1})\n$$\n作用于压力场 $p$ 的线性算子 $L$ 是通过将这些与压力相关的速度代入离散连续性方程而得到的。该算子构成了压力修正泊松方程的左侧。我们将 $L p_i$ 定义为该速度场的离散散度：\n$$\nL p_i = \\frac{u_{i+1/2}^{p} - u_{i-1/2}^{p}}{h}\n$$\n代入面速度的表达式：\n$$\nL p_i = \\frac{1}{h} \\left[ (-\\delta\\,(p_{i+1} - p_i)) - (-\\delta\\,(p_i - p_{i-1})) \\right]\n$$\n提出常数 $-\\frac{\\delta}{h}$：\n$$\nL p_i = -\\frac{\\delta}{h} \\left[ (p_{i+1} - p_i) - (p_i - p_{i-1}) \\right]\n$$\n简化括号内的表达式，得到离散拉普拉斯算子模板：\n$$\nL p_i = -\\frac{\\delta}{h} (p_{i+1} - 2p_i + p_{i-1})\n$$\n这就是推导出的作用于压力场的线性算子 $L$。\n\n接下来，我们通过考虑形式为 $p_i = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)$（其中 $x_i = i h$）的压力模态，进行傅里叶（法向模态）分析。为了找到 $L$ 对该模态的作用，我们首先用 $p_i$ 表示 $p_{i+1}$ 和 $p_{i-1}$：\n$$\np_{i+1} = \\hat{p}\\,\\exp(\\mathrm{i} k x_{i+1}) = \\hat{p}\\,\\exp(\\mathrm{i} k (x_i + h)) = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)\\,\\exp(\\mathrm{i} k h) = p_i\\,\\exp(\\mathrm{i} k h)\n$$\n$$\np_{i-1} = \\hat{p}\\,\\exp(\\mathrm{i} k x_{i-1}) = \\hat{p}\\,\\exp(\\mathrm{i} k (x_i - h)) = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)\\,\\exp(-\\mathrm{i} k h) = p_i\\,\\exp(-\\mathrm{i} k h)\n$$\n将这些代入 $L p_i$ 的表达式中：\n$$\nL p_i = -\\frac{\\delta}{h} (p_i\\,\\exp(\\mathrm{i} k h) - 2p_i + p_i\\,\\exp(-\\mathrm{i} k h))\n$$\n提出 $p_i$：\n$$\nL p_i = -\\frac{\\delta}{h} p_i (\\exp(\\mathrm{i} k h) - 2 + \\exp(-\\mathrm{i} k h))\n$$\n使用欧拉恒等式 $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)}{2}$，我们可以写出 $\\exp(\\mathrm{i} k h) + \\exp(-\\mathrm{i} k h) = 2\\cos(k h)$。括号中的表达式变为：\n$$\n\\exp(\\mathrm{i} k h) - 2 + \\exp(-\\mathrm{i} k h) = 2\\cos(k h) - 2 = -2(1 - \\cos(k h))\n$$\n将其代回 $L p_i$ 的方程中：\n$$\nL p_i = -\\frac{\\delta}{h} p_i [-2(1 - \\cos(k h))]\n$$\n$$\nL p_i = \\frac{2\\delta}{h} (1 - \\cos(k h)) p_i\n$$\n问题要求我们找到由关系式 $L p_i = \\left(\\frac{\\delta}{h}\\right)\\sigma(k)\\,p_i$ 定义的归一化傅里叶符号 $\\sigma(k)$。通过将此定义与我们推导的结果进行比较，我们可以确定 $\\sigma(k)$：\n$$\n\\left(\\frac{\\delta}{h}\\right)\\sigma(k)\\,p_i = \\frac{2\\delta}{h} (1 - \\cos(k h)) p_i\n$$\n从两边消去公因子 $\\left(\\frac{\\delta}{h}\\right)p_i$，我们得到归一化符号的表达式：\n$$\n\\sigma(k) = 2(1 - \\cos(k h))\n$$\n最后，我们必须计算棋盘格模态下的该符号，其特征为无量纲波数 $k h = \\pi$。该模态对应于网格上可解析的最高频率，其压力值在相邻单元之间符号交替，即 $p_i \\propto (-1)^i$。将 $k h = \\pi$ 代入 $\\sigma(k)$ 的表达式中：\n$$\n\\sigma(k)\\rvert_{kh=\\pi} = 2(1 - \\cos(\\pi))\n$$\n由于 $\\cos(\\pi) = -1$，计算结果为：\n$$\n\\sigma(k)\\rvert_{kh=\\pi} = 2(1 - (-1)) = 2(1 + 1) = 4\n$$\n此结果表明，离散算子对棋盘格模态的响应最强，这正是 Rhie-Chow 插值所期望的行为——通过创建一个良态的压力泊松方程来抑制这种伪压力振荡。",
            "answer": "$$ \\boxed{4} $$"
        },
        {
            "introduction": "压力修正方程是在整个CFD算法的迭代循环中被求解的。确保这个内部迭代过程收敛至关重要。亚松弛是一种用于稳定这些迭代的技术，尤其是在处理强非线性问题时，它通过在每一步只取一部分计算出的修正量来实现。这项动手编程练习将让你通过计算迭代矩阵的谱半径来探索线性稳定性的概念 ，你将亲眼看到亚松弛因子 $\\alpha_p$ 如何决定迭代求解器是收敛还是发散。",
            "id": "3993965",
            "problem": "考虑一个长度为 $L$、两端不渗透的一维通道中的不可压缩等温流动。从不可压缩流体的质量守恒定律出发，\n$$\\nabla \\cdot \\mathbf{u} = 0,$$\n以及基于压力的算法的离散化动量平衡方程，其中面法向速度经过预测，然后由压力梯度进行修正。在压力耦合方程组的半隐式方法 (SIMPLE) 中，预测速度场 $\\mathbf{u}^\\ast$ 不满足质量守恒，因此引入一个压力修正场 $p'$，使得修正后的速度 $\\mathbf{u} = \\mathbf{u}^\\ast - \\frac{1}{a_P} \\nabla p'$ 满足质量守恒。在常系数和一维几何 $x \\in [0,L]$ 的条件下，这会产生一个泊松型的压力修正方程，其狄利克雷边界条件为 $p'(0)=0$ 和 $p'(L)=0$。在 $N$ 个均匀分布的内部控制体上进行二阶中心差分离散后，会得到一个形如下式的对称正定线性系统\n$$A \\, \\mathbf{p}' = \\mathbf{r},$$\n其中 $A \\in \\mathbb{R}^{N \\times N}$ 是由具有指定边界条件的一维二阶导数所产生的离散拉普拉斯算子，而 $\\mathbf{r}$ 是从预测速度场得到的离散质量不平衡残差。\n\n为了提高迭代求解器的鲁棒性和稳定性，通常通过欠松弛来更新压力，\n$$p^{(k+1)} = p^{(k)} + \\alpha_p \\, p',$$\n其中 $p^{(k)}$ 是当前的压力迭代值，$p'$ 是修正方程的当前解（或在基于 $A$ 的定常迭代中的近似解），$\\alpha_p \\ge 0$ 是压力欠松弛因子。在用于修正方程的雅可比型定常迭代中，通过将对角逆矩阵 $D^{-1}$（其中 $D = \\operatorname{diag}(A)$）应用于残差来代替求解 $A \\, \\mathbf{p}' = \\mathbf{r}$，从而获得一个近似修正值。\n\n您的任务是：\n- 根据上述物理和数值原理，推导在雅可比型欠松弛下误差 $\\mathbf{e}^{(k)} = \\mathbf{p}^{(k)} - \\mathbf{p}^\\star$ 的线性迭代式，其中 $\\mathbf{p}^\\star$ 是对应于离散压力修正方程精确解的不动点。用一个作用于 $\\mathbf{e}^{(k)}$ 的矩阵 $M(\\alpha_p)$ 来表示该迭代。\n- 对于一维通道，使用二阶中心差分和狄利克雷边界条件 $p'(0)=0$ 及 $p'(L)=0$，在间距为 $h = L/(N+1)$ 的均匀网格上为 $N$ 个内部控制体显式地构建矩阵 $A$。通过使用标准的离散拉普拉斯模板确保科学一致性：在内部节点 $i$ 上，$A_{i,i} = \\frac{2}{h^2}$ 且 $A_{i,i\\pm 1} = -\\frac{1}{h^2}$。\n- 使用雅可比对角阵 $D = \\operatorname{diag}(A)$，构建与压力场欠松弛雅可比更新相关的迭代矩阵 $M(\\alpha_p)$。\n- 对每个给定的测试用例，计算谱半径 $\\rho(M)$，其定义为 $M(\\alpha_p)$ 特征值中的最大绝对值。谱半径是无量纲的。\n- 对每个测试用例，还要确定一个布尔稳定性标志：如果 $\\rho(M) < 1$（线性稳定迭代），则为 $True$，否则为 $False$。\n\n使用以下科学合理的测试套件，涵盖一个典型情况、一个大欠松弛因子情况、一个边界欠松弛情况、一个具有显著欠松弛的中等网格，以及一个具有接近激进欠松弛的细网格：\n- 案例 1：$N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 0.8$。\n- 案例 2：$N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 2.1$。\n- 案例 3：$N = 50$, $L = 2\\,\\mathrm{m}$, $\\alpha_p = 0.0$。\n- 案例 4：$N = 20$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.6$。\n- 案例 5：$N = 100$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.99$。\n\n您的程序必须：\n- 根据上述离散拉普拉斯算子，为每个 $(N,L)$ 对构建矩阵 $A$。\n- 从 $A$ 生成 $D^{-1}$，然后为给定的 $\\alpha_p$ 构建迭代矩阵 $M(\\alpha_p)$。\n- 为每种情况计算 $\\rho(M)$ 和相关的稳定性标志。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个结果本身是一个形式为 $[ \\rho(M), \\text{stability} ]$ 的双元素列表，其中 $\\rho(M)$ 是一个浮点数，$\\text{stability}$ 是一个布尔值。例如，一个有效的格式是 $[[\\text{float},\\text{bool}],[\\text{float},\\text{bool}],\\dots]$。\n- 谱半径是无量纲的；输出不附带任何物理单位。以标准十进制形式打印浮点数值，无需舍入指令。",
            "solution": "我们从不可压缩流的质量守恒定律开始，\n$$\\nabla \\cdot \\mathbf{u} = 0.$$\n在诸如压力耦合方程组的半隐式方法 (SIMPLE) 等基于压力的算法中，我们从离散化的动量方程得到一个预测速度场 $\\mathbf{u}^\\ast$。这个预测场通常不满足 $\\nabla \\cdot \\mathbf{u}^\\ast = 0$，因此引入压力修正量 $p'$ 来调整速度场，\n$$\\mathbf{u} = \\mathbf{u}^\\ast - \\frac{1}{a_P} \\nabla p',$$\n其中 $a_P$ 是来自动量方程离散化后的中心系数。将修正后的速度代入质量守恒方程，并假设 $a_P$ 在空间上是常数，可得\n$$\\nabla \\cdot \\mathbf{u} = \\nabla \\cdot \\left( \\mathbf{u}^\\ast - \\frac{1}{a_P} \\nabla p' \\right) = 0 \\quad \\Rightarrow \\quad \\nabla \\cdot \\left( \\frac{1}{a_P} \\nabla p' \\right) = \\nabla \\cdot \\mathbf{u}^\\ast.$$\n定义源项 $s = \\nabla \\cdot \\mathbf{u}^\\ast$，压力修正方程变为\n$$\\nabla \\cdot \\left( \\frac{1}{a_P} \\nabla p' \\right) = s.$$\n在一维且 $a_P$ 为常数的情况下，该方程简化为\n$$\\frac{1}{a_P} \\frac{d^2 p'}{dx^2} = s(x).$$\n对于本分析，其核心结构是椭圆算子 $\\frac{d^2}{dx^2}$，因此我们关注离散算子及其在迭代欠松弛下的稳定性特征。\n\n我们使用二阶中心差分在 $N$ 个间距均匀（$h = \\frac{L}{N+1}$）的内部节点上对二阶导数进行离散化。在狄利克雷边界条件 $p'(0)=0$ 和 $p'(L)=0$ 下，作用于内部节点值向量 $\\mathbf{p}' \\in \\mathbb{R}^N$ 的离散拉普拉斯算子可得到线性系统\n$$A \\, \\mathbf{p}' = \\mathbf{r},$$\n其中三对角矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 的元素为\n$$A_{i,i} = \\frac{2}{h^2}, \\quad A_{i,i-1} = -\\frac{1}{h^2}, \\quad A_{i,i+1} = -\\frac{1}{h^2},$$\n对于 $i = 1, \\dots, N$，并在端点处进行适当调整（仅当索引保持在 $1$ 到 $N$ 范围内时，非对角线元素才存在）。由于狄利克雷边界条件，这个矩阵 $A$ 是对称正定的。\n\n我们不选择在每次迭代中精确求解 $A \\, \\mathbf{p}' = \\mathbf{r}$，而是考虑一种雅可比型定常迭代。设 $D = \\operatorname{diag}(A)$ 为 $A$ 的对角部分。压力修正的雅可比更新通过\n$$\\mathbf{p}' \\approx D^{-1} \\left( \\mathbf{r} - (A-D) \\, \\mathbf{p}^{(k)} \\right),$$\n来近似解，然后在压力更新中对此进行欠松弛\n$$\\mathbf{p}^{(k+1)} = \\mathbf{p}^{(k)} + \\alpha_p \\, \\mathbf{p}'.$$\n将这些结合起来可得\n$$\\mathbf{p}^{(k+1)} = \\mathbf{p}^{(k)} + \\alpha_p \\, D^{-1} \\left( \\mathbf{r} - A \\, \\mathbf{p}^{(k)} \\right) = \\left( I - \\alpha_p D^{-1}A \\right) \\mathbf{p}^{(k)} + \\alpha_p D^{-1} \\mathbf{r}.$$\n设 $\\mathbf{p}^\\star$ 是满足离散方程 $A \\, \\mathbf{p}^\\star = \\mathbf{r}$ 的不动点。定义误差 $\\mathbf{e}^{(k)} = \\mathbf{p}^{(k)} - \\mathbf{p}^\\star$。从迭代式中减去不动点方程，误差的演化过程如下\n$$\\mathbf{e}^{(k+1)} = \\left( I - \\alpha_p D^{-1}A \\right) \\mathbf{e}^{(k)}.$$\n因此，作用于误差的迭代矩阵是\n$$M(\\alpha_p) = I - \\alpha_p D^{-1}A.$$\n经典线性迭代理论指出，当且仅当 $M(\\alpha_p)$ 的谱半径满足以下条件时，迭代是线性收敛的\n$$\\rho\\!\\left(M(\\alpha_p)\\right) < 1,$$\n其中 $\\rho(\\cdot)$ 表示特征值中的最大绝对值。对于我们带有狄利克雷边界条件的离散拉普拉斯算子 $A$，$A$ 是对称正定的，并且 $D^{-1}A$ 也是对称的，具有实数特征值。在这些条件下，$\\alpha_p$ 的选择通过 $M(\\alpha_p)$ 的特征值来控制误差的收缩因子。\n\n为计算每个测试用例所要求的量，算法步骤如下：\n- 给定 $N$ 和 $L$，计算 $h = \\frac{L}{N+1}$。\n- 组装三对角矩阵 $A$，其中对于内部相邻节点，$A_{i,i} = \\frac{2}{h^2}$ 且 $A_{i,i\\pm 1} = -\\frac{1}{h^2}$。\n- 构建 $D = \\operatorname{diag}(A)$ 和 $D^{-1}$。\n- 构建 $M(\\alpha_p) = I - \\alpha_p D^{-1}A$。\n- 计算 $M(\\alpha_p)$ 的所有特征值，然后将谱半径 $\\rho(M)$ 评估为最大绝对特征值。\n- 如果 $\\rho(M) < 1$ 则将稳定性标志设为 $True$，否则设为 $False$。\n\n谱半径是无量纲的。指定的测试套件包括：\n- 案例 1：$N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 0.8$。\n- 案例 2：$N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 2.1$。\n- 案例 3：$N = 50$, $L = 2\\,\\mathrm{m}$, $\\alpha_p = 0.0$。\n- 案例 4：$N = 20$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.6$。\n- 案例 5：$N = 100$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.99$。\n\n最终输出必须是单行文本，其中包含一个列表，列表内有五个双元素列表 $[ \\rho(M), \\text{stability} ]$，分别对应上述五个案例，并按顺序排列。",
            "answer": "```python\nimport numpy as np\n\ndef build_A(N: int, L: float) -> np.ndarray:\n    \"\"\"\n    Build the N x N discrete Laplacian matrix A for a 1D domain [0, L]\n    with Dirichlet boundary conditions at both ends and uniform spacing.\n    A_{ii} = 2/h^2, A_{i,i±1} = -1/h^2.\n    \"\"\"\n    h = L / (N + 1)\n    diag = 2.0 / (h * h)\n    off = -1.0 / (h * h)\n    A = np.zeros((N, N), dtype=float)\n    # Fill tridiagonal entries\n    for i in range(N):\n        A[i, i] = diag\n        if i - 1 >= 0:\n            A[i, i - 1] = off\n        if i + 1 < N:\n            A[i, i + 1] = off\n    return A\n\ndef iteration_matrix_spectral_radius(N: int, L: float, alpha: float) -> tuple[float, bool]:\n    \"\"\"\n    Construct the iteration matrix M(alpha) = I - alpha * D^{-1} * A\n    for Jacobi-type under-relaxation of the pressure correction, and\n    compute its spectral radius and stability flag.\n    \"\"\"\n    A = build_A(N, L)\n    D_diag = np.diag(A)\n    # Ensure no zero diagonal entries; for Dirichlet Laplacian this is guaranteed positive.\n    D_inv = np.diag(1.0 / D_diag)\n    I = np.eye(N, dtype=float)\n    M = I - alpha * (D_inv @ A)\n    # Compute eigenvalues and spectral radius\n    eigvals = np.linalg.eigvals(M)\n    rho = float(np.max(np.abs(eigvals)))\n    stable = rho < 1.0\n    return rho, stable\n\ndef solve():\n    # Define the test cases from the problem statement: (N, L [m], alpha_p)\n    test_cases = [\n        (5, 1.0, 0.8),   # Case 1: typical stable under-relaxation\n        (5, 1.0, 2.1),   # Case 2: aggressive under-relaxation likely unstable\n        (50, 2.0, 0.0),  # Case 3: boundary case alpha=0, no change, spectral radius=1\n        (20, 1.0, 1.6),  # Case 4: moderate grid with significant under-relaxation\n        (100, 1.0, 1.99) # Case 5: fine grid with near-aggressive under-relaxation\n    ]\n\n    results = []\n    for N, L, alpha in test_cases:\n        rho, stable = iteration_matrix_spectral_radius(N, L, alpha)\n        results.append([rho, stable])\n\n    # Final print statement in the exact required format.\n    print(\"[\" + \",\".join(str(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}