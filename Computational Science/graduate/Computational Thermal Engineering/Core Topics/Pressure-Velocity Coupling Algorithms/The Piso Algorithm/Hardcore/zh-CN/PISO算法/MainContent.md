## 引言
在现代[计算流体动力学](@entry_id:142614)（CFD）和[计算热工学](@entry_id:1122812)的研究与工程实践中，精确高效地模拟瞬态[不可压缩流](@entry_id:140301)是一个持久的挑战。这类流动的核心难点在于压力与速度场之间存在着一种隐式的、全局性的强耦合关系：压[力场](@entry_id:147325)必须在每一时刻都精确调整，以保证速度场满足[质量守恒](@entry_id:204015)（即[无散约束](@entry_id:755035)）。压力隐式算子分裂（PISO）算法作为一种先进的分离式求解策略，正是为了高效解决这一耦合难题而设计的，并已成为瞬态模拟领域的基石之一。

本文旨在为研究生及从业者提供一份关于[PISO算法](@entry_id:155035)的全面而深入的指南。我们将系统性地解决“[PISO算法](@entry_id:155035)如何通过其独特的预测-修正框架来[解耦](@entry_id:160890)并重新耦合压力与速度”这一核心问题，并展示其在[多物理场](@entry_id:164478)问题中的强大适应性。文章将分为三个核心部分，引领读者从理论基础走向前沿应用：

- **第一章：原则与机制**，将深入剖析[PISO算法](@entry_id:155035)的数学物理基础，从[不可压缩流](@entry_id:140301)近似出发，详细阐述其算子分裂思想、多重压力修正步的力学作用，以及在[有限体积法](@entry_id:141374)中的关键实现细节。
- **第二章：应用与跨学科交叉**，将展示PISO框架的灵活性，探讨其如何扩展至热流耦合、湍流模拟、[共轭传热](@entry_id:149857)乃至[非牛顿流体](@entry_id:154737)等复杂应用场景，揭示其作为多物理场求解器核心的潜力。
- **第三章：动手实践**，将通过一系列精心设计的编程与分析练习，帮助读者将理论知识转化为解决实际数值问题的能力，加深对[Rhie-Chow插值](@entry_id:154759)、[时间积分格式](@entry_id:165373)影响等关键概念的理解。

通过这一结构化的学习路径，读者将建立起对[PISO算法](@entry_id:155035)从底层原理到高级应用的完整认识。让我们首先从其核心的原则与机制开始。

## 原则与机制

本章旨在深入探讨压力隐式[算子分裂](@entry_id:634210)（Pressure-Implicit with Splitting of Operators, PISO）算法的核心原理与力学机制。作为一种在[计算热工学](@entry_id:1122812)领域广泛应用的瞬态[不可压缩流](@entry_id:140301)求解方法，[PISO算法](@entry_id:155035)通过其独特的预测-修正框架，高效地解决了流体动量与质量守恒之间的强耦合问题。我们将从[PISO算法](@entry_id:155035)适用的物理模型近似出发，系统地剖析其[算子分裂](@entry_id:634210)思想、多重修正步的力学作用，并将其置于更广阔的压力基求解器家族中进行比较，最后探讨其在[有限体积法](@entry_id:141374)中的关键实现细节。

### 热力学系统中的不可压缩流近似

在深入[PISO算法](@entry_id:155035)的数值细节之前，我们必须首先明确其应用的物理模型基础。许多热流问题，如[自然对流](@entry_id:197869)和共轭传热，本质上涉及因温度变化而引起的密度变化。然而，PISO及其同类算法是为求解**不可压缩流**而设计的，其核心是满足速度场的[无散约束](@entry_id:755035)，即 $\nabla \cdot \mathbf{u} = 0$。这就引出了一个关键问题：我们如何在处理变密度物理现象时，合理地使用一个基于恒定[密度假设](@entry_id:184118)的算法？答案在于对流体[可压缩性](@entry_id:144559)的来源进行[尺度分析](@entry_id:1131264)，并采用恰当的物理近似。

流体密度 $\rho$ 的变化通常源于两个方面：压力的变化（声学可压缩性）和温度的变化（热膨胀）。对于一个通用流体，其质量守恒（连续性）方程的完整形式为：
$$
\partial_t \rho + \nabla \cdot (\rho \mathbf{u}) = 0
$$
展开该式可得 $\frac{1}{\rho}\frac{D\rho}{Dt} + \nabla \cdot \mathbf{u} = 0$，其中 $\frac{D}{Dt}$ 是[物质导数](@entry_id:262900)。要使 $\nabla \cdot \mathbf{u} = 0$ 成立，必须要求[物质导数](@entry_id:262900)项 $\frac{D\rho}{Dt}$ 相对于其他项可以忽略不计。

首先，考虑**声学可压缩性**。流体中压力波动的传播速度为声速 $c$。由[热力学](@entry_id:172368)关系可知，由压力变化引起的[相对密度](@entry_id:184864)波动 $\rho'/\rho_0$ 与马赫数 $Ma = U/c$ 的平方成正比，即 $\rho'/\rho_0 \sim Ma^2$。在大多数工程热流问题中，流速远小于声速，即**[低马赫数](@entry_id:1127478)**（$Ma \ll 1$）流动。在此条件下，压力变化引起的密度变化极小，可以忽略。这一假设有效地滤除了声波，将流体视为“声学上不可压缩的”。

其次，考虑**热膨胀**。温度变化同样会引起密度变化。对于液体和中低速气体，这种关系通常可以通过线性化的[状态方程](@entry_id:274378)来近似，即**Boussinesq近似**的核心思想。该近似假设温度变化 $\Delta T = T - T_0$ 引起的[相对密度](@entry_id:184864)变化足够小，即 $|\beta(T - T_0)| \ll 1$，其中 $\beta$ 是体积[热膨胀系数](@entry_id:150685)。Boussinesq近似做了一个精妙的处理：在所有控制方程中，除了在与重力 $\mathbf{g}$ 相乘的[体力](@entry_id:174230)项外，均将密度 $\rho$ 视为常数 $\rho_0$。在体力项 $\rho \mathbf{g}$ 中，密度的微小变化 $\rho' = \rho - \rho_0$ 会产生一个不可忽略的驱动力，即**[浮力](@entry_id:154088)** $\rho' \mathbf{g} \approx -\rho_0 \beta(T-T_0)\mathbf{g}$。这个[浮力](@entry_id:154088)项被保留在[动量方程](@entry_id:197225)的源项 $\mathbf{f}$ 中。

通过低马赫数假设和Boussinesq近似，我们成功地将一个复杂的[热力学](@entry_id:172368)问题转化为一个在数学上等效于不可压缩流的问题：动量方程中包含一个温度相关的[浮力](@entry_id:154088)源项，而[连续性方程](@entry_id:195013)则简化为 $\nabla \cdot \mathbf{u} = 0$。这为PISO这类[不可压缩流](@entry_id:140301)求解算法的应用铺平了道路。

### [压力-速度耦合](@entry_id:155962)的挑战

在不可压缩流的[Navier-Stokes方程组](@entry_id:142275)中，压力 $p$ 扮演着一个独特的角色。与速度 $\mathbf{u}$ 不同，压力没有自己的独立[演化方程](@entry_id:268137)。相反，它充当一个[拉格朗日乘子](@entry_id:142696)，其场的分布必须恰好能确保速度场在任何时刻都满足[无散约束](@entry_id:755035) $\nabla \cdot \mathbf{u} = 0$。这种隐式的、全局性的约束关系构成了压力-速度耦合的核心挑战。

**[分离式求解器](@entry_id:1131384)**（Segregated Solvers）是应对这一挑战的主流策略。它们避免了将庞大的、完全耦合的动量和[连续性方程](@entry_id:195013)组作为一个整体（monolithic）求解，而是将它们[解耦](@entry_id:160890)，顺序求解。[PISO算法](@entry_id:155035)正是[分离式求解器](@entry_id:1131384)中的杰出代表，其核心在于它独特的[算子分裂](@entry_id:634210)思想。

### [PISO算法](@entry_id:155035)：一种[算子分裂](@entry_id:634210)方法

PISO的全称“压力隐式[算子分裂](@entry_id:634210)”精确地概括了其核心思想。这里的**算子分裂**（Operator Splitting）指的是将离散化的动量方程与[连续性方程](@entry_id:195013)所构成的耦合算子系统进行拆分。 具体而言，算法在求解过程中，将隐式离散的动量算子（主要包含瞬态项和扩散项）与压力梯度算子分离开来，通过一个**预测-修正**（Predictor-Corrector）的序列来重新建立它们之间的耦合。

该序列在一个时间步内通常包括以下步骤：

1.  **动量预测步（Predictor Step）**：使用上一时间步或上一迭代步的压[力场](@entry_id:147325) $p^n$ 作为对当前压[力场](@entry_id:147325)的初步猜测，求解[动量方程](@entry_id:197225)，得到一个临时的、不满足[连续性方程](@entry_id:195013)的**预测速度场** $\mathbf{u}^*$。这个速度场满足了动量守恒（在旧压[力场](@entry_id:147325)下），但其散度通常不为零，即 $\nabla \cdot \mathbf{u}^* \neq 0$。

2.  **[压力修正](@entry_id:753714)步（Corrector Step(s)）**：这是算法的核心。通过构造并求解一个关于**压力修正值** $p'$ 的方程，来计算速度修正值 $\mathbf{u}'$，使得最终更新后的速度场 $\mathbf{u}^{n+1} = \mathbf{u}^* + \mathbf{u}'$ 满足[无散约束](@entry_id:755035) $\nabla \cdot \mathbf{u}^{n+1} = 0$。PISO的独特之处在于它会执行多次（通常是两次）这样的修正，以达到更高阶的耦合精度。

### 修正步的力学机制

#### 第一次修正：强制质量守恒

第一次修正的目标是消除由预测速度场 $\mathbf{u}^*$ 带来的质量不平衡。首先，通过对[动量方程](@entry_id:197225)进行近似，建立起速度修正值 $\mathbf{u}'$ 与[压力修正](@entry_id:753714)值 $p'$ 之间的关系。在离散形式下，这个关系可以简化为 $\mathbf{u}' \approx -[A_u]^{-1} \nabla p'$，其中 $[A_u]$ 是离散[动量方程](@entry_id:197225)的[对角占优](@entry_id:748380)部分。 

随后，将这个关系代入连续性方程 $\nabla \cdot (\mathbf{u}^* + \mathbf{u}') = 0$，便可以推导出一个关于 $p'$ 的泊松型方程：
$$
\nabla \cdot \left( [A_u]^{-1} \nabla p' \right) = \nabla \cdot \mathbf{u}^*
$$
这个方程被称为**[压力修正方程](@entry_id:156602)**。从物理上看，它是一个椭圆型方程，其右端项 $\nabla \cdot \mathbf{u}^*$ 代表了每个控制体单元内的**质量不平衡源（或汇）**。求解这个方程，得到的[压力修正](@entry_id:753714)场 $p'$ 会产生一个压力梯度，驱动一个修正速度场 $\mathbf{u}'$，进而产生**修正质量通量**。这些修正通量精确地将一个单元内多余的质量“推送”到邻近的、质量不足的单元中，从而在整个计算域内重新分配质量，使每个单元都达到[质量守恒](@entry_id:204015)，即离散的积分形式 $\sum_f \phi_f = 0$ 得以满足。 因此，第一次修正的主要目标是确保每个控制体的积分质量守恒。

#### [分裂误差](@entry_id:755244)与第二次修正的必要性

如果一次修正就足够，为什么还需要第二次修正？答案在于第一次修正过程中引入的**分裂误差**（Splitting Error）。 在推导速度修正关系 $\mathbf{u}' \approx -[A_u]^{-1} \nabla p'$ 时，我们做了一个重要近似：忽略了相邻单元速度修正对中心单元速度修正的影响（即[动量方程](@entry_id:197225)矩阵的非对角项的贡献）。这导致经过一次修正后的速度场 $\mathbf{u}^{**}$ 虽然满足了积分[质量守恒](@entry_id:204015)，但它与修正后的压[力场](@entry_id:147325) $p^{**}$ 并不完全满足最初的动量方程。换言之，每个面上的质量通量虽然总和为零，但其值本身可能还不够精确。

#### 第二次修正：改善通量一致性

第二次修正的目的就是为了弥补这个分裂误差，提高解的精度。它在前一次修正的基础上，使用更新过的速度场 $\mathbf{u}^{**}$ 来重新计算动量方程中的各项（特别是对流项），从而得到一个更准确的动量关系。然后，再次构造并求解一个新的[压力修正方程](@entry_id:156602)，以消除第一次修正后残留的微小散度。

这个过程极大地改善了每个**面心通量**与动量方程之间的一致性。一个更精确的通量场对于求解与流动耦合的其他标量（如能量方程中的温度 $T$）至关重要，因为这些标量的对流输运项直接依赖于面心通量的值。 尽管每次修正都会增加时间步内的计算成本，但通过两次或多次修正获得的更高精度的耦合，往往允许在瞬态模拟中使用更大的时间步长，从而可能带来净的效率提升。

### PISO在[分离式求解器](@entry_id:1131384)家族中的定位

为了更好地理解PISO的特点，有必要将其与SIMPLE（Semi-Implicit Method for Pressure-Linked Equations）系列算法进行比较。

-   **SIMPLE算法**：SIMPLE在每个迭代步内只执行一次压力修正。由于其修正过程中的近似程度较高（与PISO的第一次修正类似），单次修正不足以完全耦合压力和速度。因此，SIMPLE算法通常需要配合显著的**欠松弛**（Under-relaxation）因子（$\alpha \lt 1$）并通过多次**外迭代**才能在一个时间步内达到收敛。其每次迭代的[耦合强度](@entry_id:275517)较弱，更适合求解[稳态](@entry_id:139253)问题。

-   **[PISO算法](@entry_id:155035)**：PISO通过在一个时间步内执行固定的、多次的修正步，来近似一个更紧密的耦合求解。这种“一步到位”的强耦合特性使其非常适合**瞬态问题**，因为它可以保证每个时间步结束时，解都在较高精度上满足控制方程。因此，PISO通常不需要或只需要非常轻微的欠松弛（$\alpha \approx 1$）。

值得注意的是，虽然PISO因其强耦合特性减少了对[欠松弛](@entry_id:756302)的需求，但在某些复杂情况下，[欠松弛](@entry_id:756302)依然是有益的。 当问题包含强[非线性](@entry_id:637147)因素时，例如：
-   流体物性（如粘度 $\mu$、导热系数 $k$）随温度剧烈变化；
-   能量方程与[动量方程](@entry_id:197225)之间存在强烈的双向耦合（如强[浮力驱动流](@entry_id:155190)）；
-   网格存在严重的**[非正交性](@entry_id:192553)**；
-   在粗网格上处理高对流问题（大库朗数 $Co$）。
在这些情况下，对速度、压力或耦合的物理量（如温度）进行适度的欠松弛，可以帮助稳定整个求解过程。

### [有限体积法](@entry_id:141374)中的实现细节

在[有限体积法](@entry_id:141374)（FVM）框架下实现[PISO算法](@entry_id:155035)时，会遇到一些关键的数值问题。

#### 网格布局与压力方程的构造

-   **[交错网格](@entry_id:1125805) (Staggered Grid)**：早期为避免[压力-速度解耦](@entry_id:167545)（[棋盘格压力](@entry_id:164851)场）而设计的网格，将压力存储在单元中心，速度分量存储在单元的面上。这种布局自然地形成了紧密的耦合，离散后的[压力修正方程](@entry_id:156602)自然地呈现为[对称正定](@entry_id:145886)的泊松方程（例如，在二维均匀网格上为[五点模板](@entry_id:174268)），且方程的组装相对简单。

-   **同位网格 (Collocated Grid)**：将所有变量（压力和速度分量）都存储在单元中心。这种布局在处理复杂几何和非结构网格时更为方便，但直接应用会导致数值上的[解耦](@entry_id:160890)问题。**Rhie-Chow动量插值**是解决此问题的标准方法。通过一种特殊的插值格式来计算面心速度，它引入了一个与压力梯度相关的高阶耗散项，有效地抑制了非物理的压力振荡。在采用了[Rhie-Chow插值](@entry_id:154759)后，同位网格同样能得到一个对称正定的[压力修正方程](@entry_id:156602)，其模板结构与[交错网格](@entry_id:1125805)类似。然而，其代价是压力方程的**组装成本更高**，因为面心通量不再是直接存储的变量，而是需要通过插值相邻单元的动量方程信息来动态重构。 

#### [非正交网格](@entry_id:752592)的影响

当使用[贴体网格](@entry_id:746897)或非结构网格处理复杂几何时，网格的非正交性是不可避免的。非正交性指的是单元[面法向量](@entry_id:749211) $\mathbf{S}_f$ 与相邻单元中心连线向量 $\mathbf{d}_f$ 不平行。这对压力方程的离散有重要影响。

在离散[压力修正方程](@entry_id:156602)时，驱动面心修正通量的压力梯度项 $\nabla p'$ 通常被分解为一个**正交分量**和一个**非正交分量**。
-   **正交分量**：沿中心连线方向 $\mathbf{d}_f$ 的压力梯度分量。这部分贡献被**隐式**处理，构成了[压力修正方程](@entry_id:156602)矩阵的主体（对角和非对角项）。其贡献的大小与 $\mathbf{S}_f \cdot \mathbf{d}_f$ 成正比，[非正交性](@entry_id:192553)越强，该项的贡献越小，隐式耦合也越弱。
-   **非正交分量**：垂直于中心连线方向的压力梯度分量。由于这部分贡献无法仅通过相邻两点的压力值直接计算，它通常使用上一迭代步的压力值进行估算，并作为一个已知的源项被**显式**地添加到[压力修正方程](@entry_id:156602)的右端。

因此，在[非正交网格](@entry_id:752592)上，压力方程的离散会自动分解为一个隐式的正交部分和一个显式的[非正交修正](@entry_id:1128815)项。这种处理方式虽然会因[非正交性](@entry_id:192553)增强而削弱矩阵的[对角占优](@entry_id:748380)性，但保证了数值解的准确性和稳定性。