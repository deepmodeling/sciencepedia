{
    "hands_on_practices": [
        {
            "introduction": "PISO算法与其他分离式算法一样，在同位网格上面临压力-速度解耦的挑战，这可能导致非物理性的压力振荡。Rhie-Chow插值是一项关键技术，它通过在面速度计算中引入压力梯度项来修正这一问题，从而防止解耦。本实践通过一个具体的编程练习，展示了解耦问题以及Rhie-Chow插值如何有效地解决它，这对于任何实现同位网格CFD求解器的研究者来说都是一项基本技能。",
            "id": "3993353",
            "problem": "考虑一个一维、周期性、均匀的同位有限体积网格，该网格有 $N$ 个单元，单元宽度为 $\\Delta x = 1/N$，无量纲密度 $\\rho = 1$。其中，对角动量系数 $a_u > 0$ 代表了在算子分裂压力隐式算法 (Pressure Implicit with Splitting of Operators, PISO) 中对动量方程的局部隐式处理。目标是构建一个数值算例，以揭示在同位网格上，当面速度由单元中心速度通过朴素线性插值形成时，面质量通量中出现的奇偶解耦伪影；并展示 Rhie–Chow 面插值通过将面质量通量与面上的压力梯度直接关联，从而恢复了耦合。所有物理量均为无量纲。\n\n从离散的不可压动量方程中由压力引起的单元中心速度修正项开始，该修正项与 PISO 的预测-校正框架一致：\n$$\nu_i = -\\frac{1}{a_u}\\left.\\frac{\\partial p}{\\partial x}\\right|_{x_i} \\approx -\\frac{1}{a_u}\\frac{p_{i+1}-p_{i-1}}{2\\Delta x},\n$$\n其中 $u_i$ 和 $p_i$ 是在单元索引 $i$ 处的单元中心速度和压力，采用周期性索引。在同位网格上，离散的面质量通量需要通过离散散度算子进入 PISO 算法的连续性方程：\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i \\approx \\frac{u_{i+1/2} - u_{i-1/2}}{\\Delta x},\n$$\n其中 $u_{i+1/2}$ 是在单元 $i$ 和 $i+1$ 之间的面上插值的速度。\n\n定义以下两种面插值策略：\n- 单元中心速度的朴素线性插值：\n$$\nu_{i+1/2}^{\\text{naive}} = \\frac{1}{2}\\left(u_i + u_{i+1}\\right).\n$$\n- 直接由面压力梯度和动量系数计算的 Rhie–Chow 插值：\n$$\nu_{i+1/2}^{\\text{RC}} = -\\frac{1}{a_u}\\frac{p_{i+1}-p_i}{\\Delta x}.\n$$\n\n任务：\n1. 对于给定的 $N$ 和 $\\Delta x = 1/N$，使用周期性索引，构建一个振幅为 $A > 0$ 的棋盘格压力场 $p_i = A(-1)^i$。\n2. 使用上述离散近似，根据单元中心的压力梯度计算单元中心的压力修正速度 $u_i$。\n3. 分别使用朴素面插值 $u_{i+1/2}^{\\text{naive}}$ 和 Rhie–Chow 面插值 $u_{i+1/2}^{\\text{RC}}$ 计算离散散度 $\\left(\\nabla \\cdot \\mathbf{u}\\right)_i$，并报告每种方法的散度均方根 (RMS)：\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(\\left(\\nabla \\cdot \\mathbf{u}\\right)_i\\right)^2}.\n$$\n4. 使用容差 $T_{\\text{small}} = 10^{-12}$ 和 $T_{\\text{large}} = 10^{-6}$，为每个测试用例生成一个布尔结果。当且仅当朴素插值产生的 $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS}} \\le T_{\\text{small}}$ 且 Rhie–Chow 插值产生的 $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS}} \\ge T_{\\text{large}}$ 时，该结果为真。这量化了朴素插值的解耦伪影和 Rhie–Chow 的修正耦合作用。\n\n推导和算法设计的基本依据：\n- 不可压流动的质量守恒要求 $\\nabla \\cdot \\mathbf{u} = 0$。\n- PISO 中的离散动量修正通过 $u = u^* - \\frac{1}{a_u}\\nabla p$ 将速度与压力梯度联系起来，其中 $u^*$ 是预测速度。在本测试中，我们通过设置 $u^* = 0$ 来分离出压力修正的贡献。\n- 同位网格上的面质量通量必须与单元压力耦合以防止奇偶解耦；Rhie–Chow 通过在面上使用隐式压力梯度来实现这一点。\n\n测试套件和参数：\n- 用例 1：$N = 8$, $a_u = 1.0$, $A = 1.0$。\n- 用例 2：$N = 9$, $a_u = 0.5$, $A = 1.0$。\n- 用例 3：$N = 2$, $a_u = 1.0$, $A = 0.3$。\n\n您的程序必须：\n- 为每个测试用例实现上述计算。\n- 生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$，其中每个 $\\text{result}_k$ 是第 $k$ 个用例的布尔值，如第 4 项所述。\n- 所有结果都是无量纲的；不需要物理单位。\n\n该问题旨在用任何现代编程语言解决，并侧重于基于不可压流控制方程和 PISO 压力-速度耦合的算法推理。除了已陈述的离散关系和定义外，不允许使用任何捷径；所有符号、变量和数字都必须严格按照规定处理。",
            "solution": "问题陈述经解析和验证，是科学上合理、适定且完整的。它提出了一个在计算流体动力学领域中定义明确的数值实验，旨在演示同位网格上的压力-速度解耦现象以及使用 Rhie–Chow 插值的修正方法。\n\n核心任务是分析两种不同的面速度插值格式在棋盘格压力场作用下的行为，已知该压力场会激发朴素格式无法检测到的非物理振荡。分析将通过推导每种格式的离散散度，然后评估给定测试用例的结果来进行。\n\n**1. 从棋盘格压力场计算单元中心速度 ($u_i$)**\n\n分析始于在具有 $N$ 个单元的周期性域上指定的棋盘格压力场：\n$$\np_i = A(-1)^i\n$$\n其中 $i \\in \\{0, 1, \\dots, N-1\\}$。单元中心速度 $u_i$ 由离散动量修正公式给出，该公式近似了单元中心 $x_i$ 处的压力梯度：\n$$\nu_i = -\\frac{1}{a_u}\\frac{p_{i+1}-p_{i-1}}{2\\Delta x}\n$$\n由于域的周期性，索引按模 $N$ 处理。相邻单元 $i+1$ 和 $i-1$ 处的压力为：\n$$\np_{i+1} = A(-1)^{i+1} = -A(-1)^i = -p_i\n$$\n$$\np_{i-1} = A(-1)^{i-1} = A(-1)^{i+1} = -A(-1)^i = -p_i\n$$\n由此可见 $p_{i+1} = p_{i-1}$。将此代入 $u_i$ 的方程：\n$$\nu_i = -\\frac{1}{a_u}\\frac{p_{i-1}-p_{i-1}}{2\\Delta x} = -\\frac{1}{a_u}\\frac{0}{2\\Delta x} = 0\n$$\n因此，对于棋盘格压力场，离散的单元中心速度对所有单元都恒为零，即对所有 $i$ 都有 $u_i = 0$。此结果与 $N$、$A$ 和 $a_u$ 无关。\n\n**2. 使用朴素线性插值计算散度**\n\n将速度插值到单元面 $i+1/2$ 的第一种方法是朴素线性插值：\n$$\nu_{i+1/2}^{\\text{naive}} = \\frac{1}{2}\\left(u_i + u_{i+1}\\right)\n$$\n由于我们发现对所有 $i$ 都有 $u_i = 0$，因此面速度也恒为零：\n$$\nu_{i+1/2}^{\\text{naive}} = \\frac{1}{2}\\left(0 + 0\\right) = 0\n$$\n单元 $i$ 处的离散散度定义为：\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i = \\frac{u_{i+1/2} - u_{i-1/2}}{\\Delta x}\n$$\n使用朴素面速度，我们得到：\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{naive}} = \\frac{0 - 0}{\\Delta x} = 0\n$$\n所有单元的散度均为零。因此，其均方根 (RMS) 范数也为零：\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, naive}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}(0)^2} = 0\n$$\n这一结果揭示了同位网格上朴素插值的致命缺陷：它对棋盘格压力模式是“盲目”的。以这种方式离散化的连续性方程无法检测到非零的压力振荡，这种效应被称为奇偶解耦。\n\n**3. 使用 Rhie–Chow 插值计算散度**\n\nRhie–Chow 插值不是根据单元中心速度构造面速度，而是直接根据面上的压力梯度构造：\n$$\nu_{i+1/2}^{\\text{RC}} = -\\frac{1}{a_u}\\frac{p_{i+1}-p_i}{\\Delta x}\n$$\n代入棋盘格压力场，$p_i = A(-1)^i$ 和 $p_{i+1} = -p_i = -A(-1)^i$：\n$$\np_{i+1}-p_i = -A(-1)^i - A(-1)^i = -2A(-1)^i\n$$\n因此，Rhie-Chow 面速度为：\n$$\nu_{i+1/2}^{\\text{RC}} = -\\frac{1}{a_u \\Delta x} \\left(-2A(-1)^i\\right) = \\frac{2A}{a_u \\Delta x}(-1)^i\n$$\n该速度非零且呈振荡性，正确反映了底层的压力振荡。现在，我们计算单元 $i$ 处的散度：\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}} = \\frac{u_{i+1/2}^{\\text{RC}} - u_{i-1/2}^{\\text{RC}}}{\\Delta x}\n$$\n前一个面 $u_{i-1/2}^{\\text{RC}}$ 上的速度可以通过在面速度公式中用 $i-1$ 替换 $i$ 来找到：\n$$\nu_{i-1/2}^{\\text{RC}} = \\frac{2A}{a_u \\Delta x}(-1)^{i-1} = -\\frac{2A}{a_u \\Delta x}(-1)^i\n$$\n面速度之差为：\n$$\nu_{i+1/2}^{\\text{RC}} - u_{i-1/2}^{\\text{RC}} = \\frac{2A}{a_u \\Delta x}(-1)^i - \\left(-\\frac{2A}{a_u \\Delta x}(-1)^i\\right) = \\frac{4A}{a_u \\Delta x}(-1)^i\n$$\n将此代入散度公式可得：\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}} = \\frac{1}{\\Delta x} \\left( \\frac{4A}{a_u \\Delta x}(-1)^i \\right) = \\frac{4A}{a_u (\\Delta x)^2}(-1)^i\n$$\n使用 $\\Delta x = 1/N$，散度变为：\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}} = \\frac{4AN^2}{a_u}(-1)^i\n$$\n离散散度非零，表明 Rhie-Chow 格式成功地耦合了压力场和速度场。为量化这一点，我们计算其 RMS 范数：\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}}^2 = \\frac{1}{N}\\sum_{i=0}^{N-1}\\left(\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}}\\right)^2 = \\frac{1}{N}\\sum_{i=0}^{N-1}\\left(\\frac{4AN^2}{a_u}(-1)^i\\right)^2\n$$\n由于 $((-1)^i)^2 = 1$，求和项中的每一项都是常数。\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}}^2 = \\frac{1}{N} \\cdot N \\cdot \\left(\\frac{4AN^2}{a_u}\\right)^2 = \\left(\\frac{4AN^2}{a_u}\\right)^2\n$$\n取平方根，并注意到 $A, N, a_u$ 均为正数，我们得到：\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4AN^2}{a_u}\n$$\n\n**4. 评估测试用例**\n\n需要检查的布尔条件是 $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, naive}} \\le T_{\\text{small}}$ 并且 $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} \\ge T_{\\text{large}}$，其中 $T_{\\text{small}} = 10^{-12}$，$T_{\\text{large}} = 10^{-6}$。\n\n- 对于朴素方法，我们得到 $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, naive}} = 0$。条件 $0 \\le 10^{-12}$ 恒为真。\n- 对于 Rhie-Chow 方法，我们必须检查是否 $\\frac{4AN^2}{a_u} \\ge 10^{-6}$。\n\n**用例 1**：$N = 8$, $a_u = 1.0$, $A = 1.0$\n$\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4(1.0)(8^2)}{1.0} = 4 \\times 64 = 256$。\n由于 $256 \\ge 10^{-6}$，条件为真。\n\n**用例 2**：$N = 9$, $a_u = 0.5$, $A = 1.0$\n$\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4(1.0)(9^2)}{0.5} = 8 \\times 81 = 648$。\n由于 $648 \\ge 10^{-6}$，条件为真。\n\n**用例 3**：$N = 2$, $a_u = 1.0$, $A = 0.3$\n$\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4(0.3)(2^2)}{1.0} = 4 \\times 0.3 \\times 4 = 4.8$。\n由于 $4.8 \\ge 10^{-6}$，条件为真。\n\n在所有三个用例中，该数值实验预计都将展示朴素插值的解耦伪影和 Rhie-Chow 格式提供的修正耦合作用。因此，所有测试用例都将满足该布尔条件。最终结果是一个包含三个真值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of demonstrating odd-even decoupling on a collocated\n    grid and its correction by Rhie-Chow interpolation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, a_u, A)\n        (8, 1.0, 1.0),\n        (9, 0.5, 1.0),\n        (2, 1.0, 0.3),\n    ]\n\n    T_small = 1e-12\n    T_large = 1e-6\n    \n    results = []\n    for N, a_u, A in test_cases:\n        # 1. Define grid parameters and the checkerboard pressure field p_i.\n        dx = 1.0 / N\n        indices = np.arange(N)\n        p = A * (-1)**indices\n\n        # 2. Compute the cell-centered velocity u_i from the pressure gradient.\n        # u_i = -1/a_u * (p_{i+1} - p_{i-1}) / (2*dx)\n        # np.roll provides periodic boundary handling.\n        p_plus1 = np.roll(p, -1)\n        p_minus1 = np.roll(p, 1)\n        u = (-1.0 / a_u) * (p_plus1 - p_minus1) / (2.0 * dx)\n\n        # 3. Compute divergence using Naive Linear Interpolation.\n        # Face velocity: u_{i+1/2}^naive = 0.5 * (u_i + u_{i+1})\n        u_plus1 = np.roll(u, -1)\n        u_face_naive = 0.5 * (u + u_plus1)\n\n        # Divergence: (div u)_i = (u_{i+1/2} - u_{i-1/2}) / dx\n        u_face_naive_minus1 = np.roll(u_face_naive, 1)\n        div_u_naive = (u_face_naive - u_face_naive_minus1) / dx\n\n        # RMS of the naive divergence.\n        rms_naive = np.sqrt(np.mean(div_u_naive**2))\n\n        # 4. Compute divergence using Rhie-Chow Interpolation.\n        # Face velocity: u_{i+1/2}^RC = -1/a_u * (p_{i+1} - p_i) / dx\n        # p_plus1 is already available from the cell-centered velocity calculation.\n        u_face_rc = (-1.0 / a_u) * (p_plus1 - p) / dx\n        \n        # Divergence: (div u)_i = (u_{i+1/2} - u_{i-1/2}) / dx\n        u_face_rc_minus1 = np.roll(u_face_rc, 1)\n        div_u_rc = (u_face_rc - u_face_rc_minus1) / dx\n        \n        # RMS of the Rhie-Chow divergence.\n        rms_rc = np.sqrt(np.mean(div_u_rc**2))\n        \n        # 5. Evaluate the boolean condition as specified in the problem statement.\n        # The condition is true if naive interpolation shows decoupling (RMS is small)\n        # AND Rhie-Chow interpolation shows coupling (RMS is large).\n        condition_met = (rms_naive <= T_small) and (rms_rc >= T_large)\n        results.append(condition_met)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "PISO算法始于动量预测步，而为此步骤选择的时间积分格式会产生重要影响。不同的格式，如后向欧拉（Backward Euler）和Crank-Nicolson，在时间精度和数值稳定性之间提供了不同的权衡，这种权衡表现为最终压力泊松方程的刚度。本练习让您能够定量分析这些权衡，深入理解数值选择如何同时影响PISO算法的精度和计算成本。",
            "id": "3993384",
            "problem": "考虑一个长度为 $L$、横截面积均匀为 $A$ 的直通道中的不可压缩流，该通道通过一维均匀有限体积网格离散化，该网格包含 $N$ 个控制体，每个控制体的大小为 $h = L/N$。流体密度为 $\\rho$，运动粘度为 $\\nu$，体速度为 $U$，方向为 $x$ 轴正方向。雷诺数 (Reynolds number, Re) 定义为 $Re = \\rho U L / \\mu$，其中 $\\mu = \\rho \\nu$ 是动力粘度。时间步长 $\\Delta t$ 的选择使得库朗数 (Courant number, 定义为 $Co = U \\Delta t / h$) 等于 $Co = 0.5$。对流项采用一阶迎风格式离散，扩散项采用二阶中心差分格式离散。采用算子分裂的压力隐式算法 (Pressure Implicit with Splitting of Operators, PISO) 在动量预测步之后通过压力修正方程来强制满足连续性方程。\n\n对于动量预测器，考虑一个单元集总线性模型，该模型从动量方程的积分形式以及对流和扩散的线性化通量推导而来，并在预测步中忽略了压力梯度。这将为每个控制体中的预测速度 $u(t)$ 导出一个形如 $\\rho h \\, \\frac{d u}{d t} = \\mathcal{R}(u)$ 的线性常微分方程 (ODE)，其中 $\\mathcal{R}(u)$ 表示线性化的对流和扩散流出量。通过从第一性原理出发，用 $\\rho$、$U$、$\\mu$ 和 $h$ 推导出常数 $\\lambda$，将此 ODE 表示为 $\\frac{d u}{d t} = \\lambda u$ 的形式。\n\n现在，比较预测器的两种时间积分方案：\n- Backward Euler (全隐式)。\n- Crank–Nicolson (梯形法则)。\n\n从应用于线性 ODE $\\frac{d u}{d t} = \\lambda u$ 的每种时间积分方案的基本定义出发，推导每种方案的单步数值放大因子和精确的单步放大因子。对于给定的 $\\Delta t$，将时间精度度量 $E$ 定义为单步数值放大因子与精确单步放大因子之间的绝对差。计算两种方案的 $E$。\n\n在 PISO 算法中，压力修正方程是椭圆形的，其标量系数来自运动预测器左侧对角项 $a_p$；在标准算子分裂下，此标量乘以压力拉普拉斯算子，形式为 $\\alpha = \\Delta t / a_p$。根据预测器中使用的相同通量线性化和隐式处理方法，为每种时间积分方案推导 $a_p$，然后得到每种方案的 $\\alpha$。将压力方程刚度度量 $S$ 定义为 $S = 1/\\alpha$ (更大的 $S$ 对应于更刚性的压力方程，即椭圆算子缩放更小)。计算比值 $S_{\\mathrm{BE}} / S_{\\mathrm{CN}}$。\n\n使用以下数值参数获得具体值：\n- $L = 1 \\,\\mathrm{m}$，$A = 1 \\,\\mathrm{m}^2$，$N = 10$。\n- $\\rho = 1 \\,\\mathrm{kg/m^3}$，$U = 1 \\,\\mathrm{m/s}$，$Re = 100$ (因此 $\\mu = \\rho U L / Re$)。\n- $Co = 0.5$ (所以 $\\Delta t = Co \\, h / U$)。\n\n以行矩阵的形式报告您的最终答案，按顺序包含时间精度度量之比 $R_E = E_{\\mathrm{BE}} / E_{\\mathrm{CN}}$ 和刚度度量之比 $R_S = S_{\\mathrm{BE}} / S_{\\mathrm{CN}}$。\n\n将每个报告值四舍五入到四位有效数字。最终答案以无量纲数表示。",
            "solution": "在尝试求解之前，对问题陈述进行了严格验证。\n\n### 步骤1：提取已知条件\n- 流动类型：直通道中的不可压缩流。\n- 几何形状：长度 $L$，均匀横截面积 $A$。\n- 离散化：一维均匀有限体积网格，$N$ 个控制体，大小 $h = L/N$。\n- 流体属性：密度 $\\rho$，运动粘度 $\\nu$，动力粘度 $\\mu = \\rho \\nu$。\n- 流动条件：体速度 $U$，方向为 $x$ 轴正方向。\n- 无量纲数：雷诺数 $Re = \\rho U L / \\mu$，库朗数 $Co = U \\Delta t / h$。\n- 数值格式：对流采用一阶迎风格式离散，扩散采用二阶中心差分格式离散。使用 PISO 算法。\n- 动量预测模型：忽略压力梯度，线性化 ODE 为 $\\rho h \\, \\frac{d u}{d t} = \\mathcal{R}(u)$，需表示为 $\\frac{d u}{d t} = \\lambda u$。\n- 时间积分方案：Backward Euler (BE) 和 Crank–Nicolson (CN)。\n- 用于比较的定义：\n    - 时间精度度量：$E = |\\text{数值放大因子} - \\text{精确放大因子}|$。\n    - PISO 压力方程系数：$\\alpha = \\Delta t / a_p$，其中 $a_p$ 是动量预测器左侧对角项。\n    - 压力方程刚度度量：$S = 1/\\alpha$。\n- 数值参数：\n    - $L = 1 \\,\\mathrm{m}$，$A = 1 \\,\\mathrm{m}^2$，$N = 10$。\n    - $\\rho = 1 \\,\\mathrm{kg/m^3}$，$U = 1 \\,\\mathrm{m/s}$，$Re = 100$。\n    - $Co = 0.5$。\n- 要求输出：时间精度度量之比 $R_E = E_{\\mathrm{BE}} / E_{\\mathrm{CN}}$ 和刚度度量之比 $R_S = S_{\\mathrm{BE}} / S_{\\mathrm{CN}}$，四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于流体动力学（不可压缩Navier-Stokes方程）和数值分析（有限体积法、PISO算法、时间积分方案分析）的基本原理。该设置在计算流体动力学（CFD）中是标准的。\n2.  **良态问题**：该问题提供了推导所需量所需的所有必要定义、参数和离散化方案。任务定义明确，可得到唯一的解析解和数值解。\n3.  **客观性**：该问题使用工程和应用数学中常见的精确、正式的语言陈述。它不含主观或模棱两可的术语。\n4.  **完整性与一致性**：所提供的数据是自洽且一致的。例如，定义了 $Re$ 并给出了其值，从而可以确定粘度。\n5.  **真实性与可行性**：物理参数和数值设置描述了一个真实的低雷诺数通道流模拟。任务在计算上是可行的。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。这是一个计算流体动力学领域的良态、科学合理的问题。开始求解。\n\n### 模型 ODE 的推导\n我们首先对控制体 $P$ 及其邻居 $W$ (西) 和 $E$ (东) 的一维对流-扩散方程进行空间离散化。忽略压力项的控制方程为：\n$$ \\rho \\frac{\\partial u}{\\partial t} + \\rho U \\frac{\\partial u}{\\partial x} = \\mu \\frac{\\partial^2 u}{\\partial x^2} $$\n在长度为 $h$、面积为 $A$ 的控制体上积分（对于一维问题，面积 $A$ 会被约去），我们得到：\n$$ \\rho h \\frac{d u_P}{d t} = \\left[ -\\rho U u + \\mu \\frac{d u}{d x} \\right]_{w}^{e} $$\n这里，$u_P$ 是控制体 $P$ 中的速度，$e$ 和 $w$ 表示控制体的东、西面。应用指定的离散格式：\n- 对流（一阶迎风，$U>0$）：$e$ 面上的通量基于 $u_P$，$w$ 面上的通量基于 $u_W$。净对流流出量为 $\\rho U u_e - \\rho U u_w = \\rho U (u_P - u_W)$。\n- 扩散（二阶中心差分）：$e$ 面上的扩散通量为 $\\mu \\frac{u_E - u_P}{h}$，$w$ 面上的扩散通量为 $\\mu \\frac{u_P - u_W}{h}$。净扩散流入量为 $\\mu \\frac{u_E - u_P}{h} - \\mu \\frac{u_P - u_W}{h} = \\frac{\\mu}{h}(u_E - 2u_P + u_W)$。\n\n单元 $P$ 的半离散方程是动量变化率，等于净通量之和：\n$$ \\rho h \\frac{d u_P}{d t} = -\\rho U(u_P - u_W) + \\frac{\\mu}{h}(u_E - 2u_P + u_W) $$\n$$ \\rho h \\frac{d u_P}{d t} = - \\left( \\rho U + \\frac{2\\mu}{h} \\right) u_P + \\left( \\rho U + \\frac{\\mu}{h} \\right) u_W + \\left( \\frac{\\mu}{h} \\right) u_E $$\n问题要求一个形如 $\\frac{du}{dt} = \\lambda u$ 的“单元集总线性模型”。这意味着将依赖于相邻单元的右侧项近似为一个与本单元速度 $u_P$ 成正比的项。这可以通过只考虑空间算子矩阵的对角部分来实现。\n$$ \\rho h \\frac{du}{dt} \\approx - \\left( \\rho U + \\frac{2\\mu}{h} \\right) u $$\n求解 $\\frac{du}{dt}$，我们找到常数 $\\lambda$：\n$$ \\frac{du}{dt} = \\left[ -\\frac{1}{\\rho h} \\left( \\rho U + \\frac{2\\mu}{h} \\right) \\right] u = \\left( -\\frac{U}{h} - \\frac{2\\mu}{\\rho h^2} \\right) u $$\n因此，$\\lambda = -\\frac{U}{h} - \\frac{2\\mu}{\\rho h^2}$。\n\n### 时间精度度量\nODE 为 $\\frac{du}{dt} = \\lambda u$。在一个时间步长 $\\Delta t$ 内的精确解为 $u(t+\\Delta t) = u(t) \\exp(\\lambda \\Delta t)$。精确的单步放大因子为 $G_{exact} = \\exp(\\lambda \\Delta t)$。\n\n**Backward Euler (BE)：** 该格式为 $\\frac{u^{n+1} - u^n}{\\Delta t} = \\lambda u^{n+1}$。\n$$ u^{n+1}(1 - \\lambda \\Delta t) = u^n \\implies G_{BE} = \\frac{u^{n+1}}{u^n} = \\frac{1}{1 - \\lambda \\Delta t} $$\nBE 的时间精度度量为：\n$$ E_{BE} = |G_{BE} - G_{exact}| = \\left| \\frac{1}{1 - \\lambda \\Delta t} - \\exp(\\lambda \\Delta t) \\right| $$\n\n**Crank-Nicolson (CN)：** 该格式为 $\\frac{u^{n+1} - u^n}{\\Delta t} = \\lambda \\frac{u^{n+1} + u^n}{2}$。\n$$ u^{n+1}\\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) = u^n\\left(1 + \\frac{\\lambda \\Delta t}{2}\\right) \\implies G_{CN} = \\frac{u^{n+1}}{u^n} = \\frac{1 + \\lambda \\Delta t/2}{1 - \\lambda \\Delta t/2} $$\nCN 的时间精度度量为：\n$$ E_{CN} = |G_{CN} - G_{exact}| = \\left| \\frac{1 + \\lambda \\Delta t/2}{1 - \\lambda \\Delta t/2} - \\exp(\\lambda \\Delta t) \\right| $$\n\n### 压力方程刚度度量\n刚度度量为 $S = 1/\\alpha = a_p / \\Delta t$，其中 $a_p$ 是动量预测步中矩阵的对角系数。预测速度 $u^*$ 的全离散方程写作 $a_p u_P^* = \\sum a_{nb} u_{nb}^* + \\text{source terms}$。我们从半离散方程的时间离散化中推导出 $a_p$。\n单元 $P$ 的空间算子项可以写成 $a_P^{\\text{space}} u_P - a_W^{\\text{space}} u_W - a_E^{\\text{space}} u_E$，其中 $a_P^{\\text{space}} = \\rho U + \\frac{2\\mu}{h}$。\n\n**Backward Euler：** 时间导数和空间项在未来时间层上进行隐式求值。\n$$ \\rho h \\frac{u_P^* - u_P^n}{\\Delta t} = -\\left( a_P^{\\text{space}} u_P^* - a_W^{\\text{space}} u_W^* - a_E^{\\text{space}} u_E^* \\right) $$\n重排以分离含 $u_P^*$ 的项：\n$$ \\left( \\frac{\\rho h}{\\Delta t} + a_P^{\\text{space}} \\right) u_P^* = \\dots $$\n因此，对角系数为 $a_{p, \\text{BE}} = \\frac{\\rho h}{\\Delta t} + a_P^{\\text{space}} = \\frac{\\rho h}{\\Delta t} + \\rho U + \\frac{2\\mu}{h}$。\nBE 的刚度度量为：\n$$ S_{BE} = \\frac{a_{p, \\text{BE}}}{\\Delta t} = \\frac{\\rho h}{(\\Delta t)^2} + \\frac{\\rho U}{\\Delta t} + \\frac{2\\mu}{h \\Delta t} $$\n\n**Crank-Nicolson：** 空间项是其在时间层 $n$ 和 $*$ 处值的平均。\n$$ \\rho h \\frac{u_P^* - u_P^n}{\\Delta t} = -\\frac{1}{2}\\left( a_P^{\\text{space}} u_P^* - \\dots \\right) - \\frac{1}{2}\\left( a_P^{\\text{space}} u_P^n - \\dots \\right) $$\n重排以分离含 $u_P^*$ 的项：\n$$ \\left( \\frac{\\rho h}{\\Delta t} + \\frac{1}{2}a_P^{\\text{space}} \\right) u_P^* = \\dots $$\n因此，对角系数为 $a_{p, \\text{CN}} = \\frac{\\rho h}{\\Delta t} + \\frac{1}{2}a_P^{\\text{space}} = \\frac{\\rho h}{\\Delta t} + \\frac{1}{2}\\left(\\rho U + \\frac{2\\mu}{h}\\right)$。\nCN 的刚度度量为：\n$$ S_{CN} = \\frac{a_{p, \\text{CN}}}{\\Delta t} = \\frac{\\rho h}{(\\Delta t)^2} + \\frac{\\rho U}{2\\Delta t} + \\frac{\\mu}{h \\Delta t} $$\n\n### 数值计算\n首先，我们计算物理和数值参数：\n- 单元尺寸：$h = L/N = 1/10 = 0.1 \\, \\mathrm{m}$。\n- 动力粘度：$\\mu = \\rho U L / Re = (1 \\cdot 1 \\cdot 1) / 100 = 0.01 \\, \\mathrm{kg/(m \\cdot s)}$。\n- 时间步长：$\\Delta t = Co \\cdot h / U = 0.5 \\cdot 0.1 / 1 = 0.05 \\, \\mathrm{s}$。\n\n现在，我们计算 $\\lambda$：\n$$ \\lambda = -\\frac{U}{h} - \\frac{2\\mu}{\\rho h^2} = -\\frac{1}{0.1} - \\frac{2(0.01)}{1 \\cdot (0.1)^2} = -10 - \\frac{0.02}{0.01} = -10 - 2 = -12 \\, \\mathrm{s^{-1}} $$\n关键的无量纲参数是 $x = \\lambda \\Delta t$:\n$$ x = -12 \\cdot 0.05 = -0.6 $$\n\n**时间精度比：**\n- 精确放大因子：$G_{exact} = \\exp(x) = \\exp(-0.6) \\approx 0.548812$。\n- BE 放大因子：$G_{BE} = \\frac{1}{1 - x} = \\frac{1}{1 - (-0.6)} = \\frac{1}{1.6} = 0.625$。\n- CN 放大因子：$G_{CN} = \\frac{1 + x/2}{1 - x/2} = \\frac{1 - 0.3}{1 + 0.3} = \\frac{0.7}{1.3} \\approx 0.538462$。\n\n- 精度度量：\n  - $E_{BE} = |0.625 - 0.548812| = 0.076188$。\n  - $E_{CN} = |0.538462 - 0.548812| = |-0.010350| = 0.010350$。\n- 比值 $R_E$：\n  $$ R_E = \\frac{E_{BE}}{E_{CN}} = \\frac{0.076188}{0.010350} \\approx 7.36116 $$\n  四舍五入到四位有效数字，$R_E = 7.361$。\n\n**刚度度量比：**\n我们计算 $S_{BE}$ 和 $S_{CN}$ 的各项：\n- 第1项：$\\frac{\\rho h}{(\\Delta t)^2} = \\frac{1 \\cdot 0.1}{(0.05)^2} = \\frac{0.1}{0.0025} = 40$。\n- 第2项：$\\frac{\\rho U}{\\Delta t} = \\frac{1 \\cdot 1}{0.05} = 20$。\n- 第3项：$\\frac{2\\mu}{h \\Delta t} = \\frac{2 \\cdot 0.01}{0.1 \\cdot 0.05} = \\frac{0.02}{0.005} = 4$。\n\n- 刚度度量：\n  - $S_{BE} = 40 + 20 + 4 = 64$。\n  - $S_{CN} = 40 + \\frac{20}{2} + \\frac{4}{2} = 40 + 10 + 2 = 52$。\n- 比值 $R_S$：\n  $$ R_S = \\frac{S_{BE}}{S_{CN}} = \\frac{64}{52} = \\frac{16}{13} \\approx 1.230769 $$\n  四舍五入到四位有效数字，$R_S = 1.231$。\n\n最终结果是比值 $R_E$ 和 $R_S$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 7.361 & 1.231 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在实际应用中，PISO算法通常使用近似方法来构建压力泊松方程，这简化了系统，但同时也引入了误差。本实践使用傅里叶分析来研究使用动量算子的近似逆（特别是其对角部分）如何影响算法执行无散约束的能力。通过完成此分析，您将更深入地理解PISO方法的“近似投影”本质，并量化校正步后残留的散度，揭示其迭代特性的根源。",
            "id": "3993373",
            "problem": "考虑一个长度为 $L$ 的一维、周期性、均匀网格，该网格有 $N$ 个控制体，网格间距为 $h=L/N$，用于离散不可压缩、常物性动量方程，其质量项和粘性项采用全隐式格式。令 $\\rho$ 表示恒定密度，$\\mu$ 表示动力粘度。记 $A$ 为离散动量方程中与隐式质量-粘性块相关的线性算子，$G$ 为离散梯度算子，$D$ 为离散散度算子，所有算子均采用二阶中心差分格式构建。在算子分裂压力隐式 (PISO) 算法中，使用已知压力从动量方程中获得预测速度 $\\boldsymbol{u}^{\\ast}$，并通过一个压力方程确定压力修正量 $\\phi$ 以强制满足不可压缩性条件，该压力方程是使用 $A$ 的近似逆（记为 $\\tilde{A}^{-1}$）组装的。然后，通过求解线性方程 $A\\boldsymbol{w}=G\\phi$ 并更新 $\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\ast}-\\boldsymbol{w}$，用 $A$ 的精确逆作用来修正速度。假设如下：\n- 区域是一维周期性的，且 $L=1$。\n- 控制体数量为 $N=64$，因此 $h=1/64$。\n- 密度为 $\\rho=1$，动力粘度为 $\\mu=10^{-3}$。\n- 时间步长为 $\\Delta t=10^{-3}$。\n- 用于组装压力方程的近似逆是 $A$ 在物理空间中的雅可比（对角）逆，因此 $\\tilde{A}^{-1}=\\alpha I$，其中 $\\alpha=\\left(\\frac{\\rho}{\\Delta t}+\\frac{2\\mu}{h^{2}}\\right)^{-1}$。\n- 使用标准的二阶中心差分，因此对于波数为 $k=\\frac{2\\pi n}{L}$ 的傅里叶模态，离散梯度和散度符号为 $i\\tilde{k}$，其中 $\\tilde{k}=\\frac{2}{h}\\sin\\left(\\frac{k h}{2}\\right)$，$A$ 的傅里叶符号为 $a(k)=\\frac{\\rho}{\\Delta t}+\\mu \\tilde{k}^{2}$。\n\n假设预测速度 $\\boldsymbol{u}^{\\ast}$ 有一个非零的散度分量，该分量由索引为 $n=32$ 的单个傅里叶模态组成，即 $D\\boldsymbol{u}^{\\ast}$ 仅在 $k=\\frac{2\\pi n}{L}$ 处具有傅里叶幅值 $\\hat{b}\\neq 0$。经过一次 PISO 修正（其中压力方程用 $\\tilde{A}^{-1}$ 组装，但速度修正用 $A$ 的精确逆作用施加），量化此模态的残余散度幅值与初始散度幅值之比，即计算\n$$\nR=\\frac{|\\widehat{D\\boldsymbol{u}^{\\,n+1}}|}{|\\widehat{D\\boldsymbol{u}^{\\ast}}|},\n$$\n其中尖号表示在波数 $k=\\frac{2\\pi n}{L}$ 处的傅里叶幅值。\n\n将您的最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算在算子分裂压力隐式 (PISO) 算法的一次修正步骤后，残余散度幅值与初始散度幅值之比 $R = \\frac{|\\widehat{D\\boldsymbol{u}^{\\,n+1}}|}{|\\widehat{D\\boldsymbol{u}^{\\ast}}|}$。分析将在傅里叶空间中进行，因为给定的算子和初始条件非常适合这种方法。\n\n令 $\\mathcal{F}(\\cdot)$ 表示傅里叶变换，$\\hat{f}(k) = \\mathcal{F}(f(x))$ 为函数 $f(x)$ 在波数 $k$ 处的傅里叶幅值。物理空间中线性微分或伪微分算子的作用对应于在傅里叶空间中乘以其傅里叶符号。\n\n问题中描述的 PISO 修正步骤如下：\n1.  预测速度场 $\\boldsymbol{u}^{\\ast}$ 已知。其散度 $D\\boldsymbol{u}^{\\ast}$ 非零。给定 $D\\boldsymbol{u}^{\\ast}$ 由索引为 $n=32$ 的单个傅里叶模态组成。令其在相应波数 $k = \\frac{2\\pi n}{L}$ 处的傅里叶幅值为 $\\widehat{D\\boldsymbol{u}^{\\ast}} = \\hat{b}$。\n\n2.  通过求解压力方程来计算压力修正量 $\\phi$。该方程是使用隐式质量-粘性算子 $A$ 的近似逆（记为 $\\tilde{A}^{-1}$）构成的。$\\phi$ 的控制方程为：\n    $$\n    (D \\tilde{A}^{-1} G) \\phi = D\\boldsymbol{u}^{\\ast}\n    $$\n    我们将此方程变换到傅里叶空间。离散梯度算子 $G$ 和离散散度算子 $D$ 的傅里叶符号均由 $i\\tilde{k}$ 给出，其中 $\\tilde{k} = \\frac{2}{h}\\sin\\left(\\frac{k h}{2}\\right)$。近似逆算子 $\\tilde{A}^{-1}$ 由 $\\alpha I$ 给出，其中 $I$ 是单位算子，$\\alpha$ 是一个标量常数。$\\alpha I$ 的傅里叶符号就是 $\\alpha$。因此，经过傅里叶变换的压力方程为：\n    $$\n    (i\\tilde{k}) (\\alpha) (i\\tilde{k}) \\hat{\\phi} = \\widehat{D\\boldsymbol{u}^{\\ast}}\n    $$\n    $$\n    -\\alpha \\tilde{k}^2 \\hat{\\phi} = \\hat{b}\n    $$\n    求解压力修正量的傅里叶幅值，我们得到：\n    $$\n    \\hat{\\phi} = -\\frac{\\hat{b}}{\\alpha \\tilde{k}^2}\n    $$\n\n3.  修正速度场以获得新速度 $\\boldsymbol{u}^{n+1}$。修正是使用 $A$ 的精确逆作用进行的。更新规则为 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\boldsymbol{w}$，其中 $\\boldsymbol{w}$ 是 $A\\boldsymbol{w} = G\\phi$ 的解。\n\n4.  我们需要求出修正后速度的散度 $D\\boldsymbol{u}^{n+1}$。对更新规则应用散度算子：\n    $$\n    D\\boldsymbol{u}^{n+1} = D\\boldsymbol{u}^{\\ast} - D\\boldsymbol{w}\n    $$\n    由 $A\\boldsymbol{w} = G\\phi$ 可得 $\\boldsymbol{w} = A^{-1}G\\phi$。将此代入散度表达式中：\n    $$\n    D\\boldsymbol{u}^{n+1} = D\\boldsymbol{u}^{\\ast} - D(A^{-1}G\\phi)\n    $$\n    将此方程变换到傅里叶空间，我们使用 $D$、$G$ 和 $A$ 的符号。$A$ 的符号由 $a(k) = \\frac{\\rho}{\\Delta t} + \\mu \\tilde{k}^2$ 给出，因此其逆 $A^{-1}$ 的符号是 $1/a(k)$。\n    $$\n    \\widehat{D\\boldsymbol{u}^{n+1}} = \\widehat{D\\boldsymbol{u}^{\\ast}} - \\mathcal{F}(D A^{-1} G \\phi) = \\hat{b} - (i\\tilde{k}) \\left(\\frac{1}{a(k)}\\right) (i\\tilde{k}) \\hat{\\phi}\n    $$\n    $$\n    \\widehat{D\\boldsymbol{u}^{n+1}} = \\hat{b} + \\frac{\\tilde{k}^2}{a(k)} \\hat{\\phi}\n    $$\n    现在，我们代入第 2 步中得到的 $\\hat{\\phi}$ 表达式：\n    $$\n    \\widehat{D\\boldsymbol{u}^{n+1}} = \\hat{b} + \\frac{\\tilde{k}^2}{a(k)} \\left( -\\frac{\\hat{b}}{\\alpha \\tilde{k}^2} \\right) = \\hat{b} - \\frac{\\hat{b}}{\\alpha a(k)} = \\hat{b} \\left( 1 - \\frac{1}{\\alpha a(k)} \\right)\n    $$\n\n5.  所求比率 $R$ 是傅里叶幅值之比的模：\n    $$\n    R = \\frac{|\\widehat{D\\boldsymbol{u}^{n+1}}|}{|\\widehat{D\\boldsymbol{u}^{\\ast}}|} = \\frac{|\\hat{b} \\left( 1 - \\frac{1}{\\alpha a(k)} \\right)|}{|\\hat{b}|} = \\left| 1 - \\frac{1}{\\alpha a(k)} \\right| = \\left| 1 - \\frac{\\alpha^{-1}}{a(k)} \\right|\n    $$\n    现在我们必须使用所提供的数据计算相关项的数值：\n    -   $L=1$，$N=64$，所以 $h=L/N = 1/64$。\n    -   $\\rho=1$，$\\mu=10^{-3}$，$\\Delta t=10^{-3}$。\n    -   傅里叶模态索引 $n=32$。\n\n    波数 $k$ 是：\n    $$\n    k = \\frac{2\\pi n}{L} = \\frac{2\\pi (32)}{1} = 64\\pi\n    $$\n    有效波数 $\\tilde{k}$ 是：\n    $$\n    \\tilde{k} = \\frac{2}{h} \\sin\\left(\\frac{k h}{2}\\right) = \\frac{2}{1/64} \\sin\\left(\\frac{(64\\pi)(1/64)}{2}\\right) = 128 \\sin\\left(\\frac{\\pi}{2}\\right) = 128\n    $$\n    精确算子 $A$ 的符号是：\n    $$\n    a(k) = \\frac{\\rho}{\\Delta t} + \\mu \\tilde{k}^2 = \\frac{1}{10^{-3}} + 10^{-3} \\cdot (128)^2 = 1000 + 10^{-3} \\cdot 16384 = 1000 + 16.384 = 1016.384\n    $$\n    项 $\\alpha^{-1}$ 是算子 $A$ 在物理空间中的对角元，用于构造近似逆 $\\tilde{A}^{-1}$：\n    $$\n    \\alpha^{-1} = \\frac{\\rho}{\\Delta t} + \\frac{2\\mu}{h^2} = \\frac{1}{10^{-3}} + \\frac{2 \\cdot 10^{-3}}{(1/64)^2} = 1000 + 2 \\cdot 10^{-3} \\cdot 4096 = 1000 + 8.192 = 1008.192\n    $$\n    最后，我们计算比率 $R$：\n    $$\n    R = \\left| 1 - \\frac{1008.192}{1016.384} \\right| = \\left| \\frac{1016.384 - 1008.192}{1016.384} \\right| = \\frac{8.192}{1016.384}\n    $$\n    $$\n    R \\approx 0.0080601509...\n    $$\n    将结果四舍五入到四位有效数字，得到 $0.008060$。",
            "answer": "$$\n\\boxed{0.008060}\n$$"
        }
    ]
}