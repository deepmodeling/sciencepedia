{
    "hands_on_practices": [
        {
            "introduction": "在计算热工模拟中，前处理阶段的决策对求解器的设置和性能有着直接而深远的影响。本练习将探讨其中一个关键联系：网格划分与显式时间积分格式的稳定性。我们将学习如何根据一个非均匀网格来确定保证数值解稳定的最大时间步长，这是一个在处理复杂几何时经常遇到的实际问题。这个练习强调了在前处理阶段就必须考虑求解器限制的重要性。",
            "id": "3983557",
            "problem": "一个一维瞬态热扩散问题将使用显式前向欧拉时间积分和二阶中心空间差分进行模拟。物理域是一根长度为 $L = 0.36$ $\\mathrm{m}$ 的杆，其热扩散系数为常数 $\\alpha = 1.4 \\times 10^{-5}\\,\\mathrm{m^2/s}$。作为预处理的一部分，通过拉伸映射 $x_i = L \\left(\\frac{i}{N}\\right)^2$（其中 $i = 0, 1, \\dots, N$，$N = 12$）生成了一个非均匀网格。求解器对所有单元使用单一的全局均匀时间步长 $\\Delta t$，并通过使用网格中最小的空间步长 $h$ 作为特征间距来约束 $\\Delta t$，以确保稳定性。后处理将计算最受限制单元处的无量纲傅里叶数，以验证其是否接近稳定性极限。\n\n从能量守恒和傅里叶定律导出的一维热方程出发，推导适用于所述显式格式的线性稳定性约束，然后计算网格和材料属性所允许的最大稳定均匀时间步长 $\\Delta t$。使用从给定映射中找到的最小相邻间距 $h$ 来设定约束。将最终数值答案四舍五入至四位有效数字，并以秒为单位表示。",
            "solution": "一维瞬态热扩散方程由下式给出：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是热扩散系数。\n\n问题指定使用显式前向欧拉方法进行时间积分，并使用二阶中心差分进行空间离散化来求解数值解。设 $T_i^n$ 表示空间节点 $i$ 在时间步长 $n$ 处的温度。时间上的前向差分为：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_i^n \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n对于间距为 $h$ 的均匀网格，空间上的中心差分为：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_i^n \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2}\n$$\n将这些代入热方程，得到时间前向、空间中心 (FTCS) 离散格式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2}\n$$\n为求未来温度 $T_i^{n+1}$ 重新整理，得到显式更新方程：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{h^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\n无量纲数组合 $Fo = \\frac{\\alpha \\Delta t}{h^2}$ 是网格傅里叶数。对此格式在均匀网格上进行的 von Neumann 稳定性分析表明，当且仅当傅里叶数有界时，该格式是稳定的：\n$$\nFo \\le \\frac{1}{2} \\quad \\implies \\quad \\frac{\\alpha \\Delta t}{h^2} \\le \\frac{1}{2}\n$$\n这导致对时间步长的稳定性约束：\n$$\n\\Delta t \\le \\frac{h^2}{2\\alpha}\n$$\n问题指定了一个非均匀网格，对此类网格的稳定性分析更为复杂。然而，问题明确指示稳定性约束应基于网格中最小的空间步长 $h$。设此最小间距为 $h_{min}$。因此，最大稳定均匀时间步长 $\\Delta t_{max}$ 的条件是：\n$$\n\\Delta t_{max} = \\frac{h_{min}^2}{2\\alpha}\n$$\n为求 $h_{min}$，我们必须分析给定的网格生成映射：\n$$\nx_i = L \\left(\\frac{i}{N}\\right)^2 \\quad \\text{for } i = 0, 1, \\dots, N\n$$\n第 $i$ 个单元的间距 $h_i$，定义为节点 $i$ 和节点 $i-1$ 之间的距离，为：\n$$\nh_i = x_i - x_{i-1} \\quad \\text{for } i = 1, \\dots, N\n$$\n代入映射函数：\n$$\nh_i = L \\left(\\frac{i}{N}\\right)^2 - L \\left(\\frac{i-1}{N}\\right)^2 = \\frac{L}{N^2} \\left[ i^2 - (i-1)^2 \\right]\n$$\n展开项 $(i-1)^2 = i^2 - 2i + 1$：\n$$\nh_i = \\frac{L}{N^2} [i^2 - (i^2 - 2i + 1)] = \\frac{L}{N^2} (2i - 1)\n$$\n为求 $h_{min}$，我们观察到 $h_i$ 是关于索引 $i$ 的线性递增函数。因此，最小间距出现在最小的索引处，即 $i=1$：\n$$\nh_{min} = h_1 = \\frac{L}{N^2} (2(1) - 1) = \\frac{L}{N^2}\n$$\n现在我们代入给定的数值：$L = 0.36 \\, \\mathrm{m}$ 和 $N=12$。\n$$\nh_{min} = \\frac{0.36}{12^2} = \\frac{0.36}{144} = 0.0025 \\, \\mathrm{m}\n$$\n在确定了最小间距后，我们现在可以使用给定的热扩散系数 $\\alpha = 1.4 \\times 10^{-5} \\, \\mathrm{m^2/s}$ 来计算最大稳定时间步长 $\\Delta t_{max}$。\n$$\n\\Delta t_{max} = \\frac{h_{min}^2}{2\\alpha} = \\frac{(0.0025)^2}{2 \\times (1.4 \\times 10^{-5})}\n$$\n$$\n\\Delta t_{max} = \\frac{6.25 \\times 10^{-6}}{2.8 \\times 10^{-5}} = \\frac{6.25}{28} \\approx 0.22321428... \\, \\mathrm{s}\n$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$\n\\Delta t_{max} \\approx 0.2232 \\, \\mathrm{s}\n$$\n该值代表求解器可以使用的最大均匀时间步长，它基于网格中最小单元施加的保守约束，保证了整个域的数值稳定性。对于这个最受限制的单元，其傅里叶数将恰好处于 $0.5$ 的极限值。",
            "answer": "$$\n\\boxed{0.2232}\n$$"
        },
        {
            "introduction": "选择正确的离散格式是求解器配置的核心，直接关系到仿真结果是否具有物理真实性。一个看似合理的数值方案，在特定条件下可能会产生违背物理定律的解，例如在没有物理热汇的情况下出现负温度。本练习通过一个思想实验，深入剖析了中心差分格式在处理对流主导问题时为何会失效，并介绍了诸如单调性、网格佩克莱数 ($P_e$) 以及迎风格式等关键概念，这些是确保数值解物理真实性的基石。",
            "id": "3983563",
            "problem": "一个计算热工学团队遵循标准的仿真工作流程，包括前处理、求解器选择与配置以及后处理验证，以研究长度为 $L$ 的杆上温度的一维瞬态对流扩散问题。在前处理阶段，他们指定了一个间距为 $\\Delta x$ 的均匀笛卡尔网格、热扩散系数 $\\alpha > 0$、恒定的对流速度 $u \\ge 0$、非负的体积热源 $s(x,t) \\ge 0$、非负的狄利克雷边界条件 $T(0,t) \\ge 0$ 和 $T(L,t) \\ge 0$，以及非负的初始条件 $T(x,0) \\ge 0$。其连续模型为\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + s(x,t).\n$$\n根据抛物线方程的基本极值原理，在给定的非负数据下，连续解 $T(x,t)$ 在所有 $t \\ge 0$ 的情况下均保持非负。\n\n在求解器步骤中，他们在一个均匀网格上实现了一个节点中心的显式格式，对一阶和二阶空间导数均使用中心差分，\n$$\nT_i^{n+1} = T_i^n + r \\left( T_{i+1}^n - 2 T_i^n + T_{i-1}^n \\right) - \\frac{c}{2} \\left( T_{i+1}^n - T_{i-1}^n \\right) + \\Delta t\\, s_i^n,\n$$\n其中 $r = \\alpha \\Delta t / \\Delta x^2$，$c = u \\Delta t / \\Delta x$，$T_i^n \\approx T(x_i, t^n)$，$s_i^n \\approx s(x_i,t^n)$，$x_i = i \\Delta x$，且 $t^n = n \\Delta t$。在后处理过程中，他们发现尽管初始和边界数据都是非负的，但当 $u$ 很大且为了计算效率而选择 $\\Delta t$ 时，离散温度在陡峭锋面附近表现出负值下冲。他们希望从第一性原理出发，理解为何离散解中会出现这种非物理的负温度，以及哪些修改可以在保持物理保真度的同时防止它们。\n\n选择所有正确解释离散解中出现负温度的机制以及保正格式如何防止此类非物理状态的陈述，并明确前处理、求解器配置和后处理验证的作用。\n\nA. 如果离散空间算子和时间更新产生一个单调格式，其系统矩阵是M-矩阵（对角线元素为正，非对角线元素为非正，逆矩阵为非负），并且如果显式更新系数构成一个非负的凸组合（例如，在一维纯扩散情况下 $r \\le 1/2$），那么离散极值原理成立，非负数据将保持非负。违反这些条件会破坏单调性，从而允许负值下冲。\n\nB. 观测到的负温度主要是在后处理中由色标选择和有限的数值精度引起的可视化伪影；启用色彩条裁剪可以消除它们，而无需更改离散化或时间步长。\n\nC. 在高局部单元佩克莱数 $P_e = u \\Delta x / \\alpha$ 下，对流项的中心差分离散化会破坏单调性，并引发色散振荡和下冲。使用带有总变差递减（TVD）限制器的迎风通量或指数拟合可以恢复离散算子的单调特性，从而在非负数据下得到保正格式。\n\nD. 仅靠前处理中的网格加密总是能消除任何相容格式的负温度，因此求解器的修改是不必要的。\n\nE. 对于带有非负源项的纯扩散情况，如果在一维中 $r = \\alpha \\Delta t / \\Delta x^2 \\le 1/2$，则显式欧拉更新是相邻状态的凸组合；超过这个界限会产生负系数，即使所有输入都为非负，也可能产生负温度。\n\n选择所有适用项。",
            "solution": "问题的核心在于理解离散格式在何种条件下能保持连续解的非负性。一个充分条件是，新的温度 $T_i^{n+1}$ 是前一时间步温度 $T_j^n$ 的一个非负加权平均，再加上一个非负的源项。我们重排给定的离散格式，将 $T_i^{n+1}$ 表示为时间步 $n$ 处温度的线性组合：\n\n$$\nT_i^{n+1} = T_i^n + r T_{i+1}^n - 2r T_i^n + r T_{i-1}^n - \\frac{c}{2} T_{i+1}^n + \\frac{c}{2} T_{i-1}^n + \\Delta t\\, s_i^n\n$$\n按时间步 $n$ 的空间索引对各项进行分组：\n$$\nT_i^{n+1} = \\left( r + \\frac{c}{2} \\right) T_{i-1}^n + (1 - 2r) T_i^n + \\left( r - \\frac{c}{2} \\right) T_{i+1}^n + \\Delta t\\, s_i^n\n$$\n鉴于对所有 $j$ 都有 $T_j^n \\ge 0$，且源项非负（$s_i^n \\ge 0$ 且 $\\Delta t > 0$），如果所有乘以 $T_j^n$ 项的系数也都是非负的，那么 $T_i^{n+1}$ 就保证是非负的。这导出了一组条件：\n\n1.  $T_{i-1}^n$ 的系数：$r + \\frac{c}{2} \\ge 0$。因为 $r = \\frac{\\alpha \\Delta t}{\\Delta x^2} > 0$ 且 $c = \\frac{u \\Delta t}{\\Delta x} \\ge 0$，所以这个条件总是满足的。\n2.  $T_i^n$ 的系数：$1 - 2r \\ge 0$。这意味着 $2r \\le 1$，或 $r \\le 1/2$。这是显式格式的标准扩散稳定性限制：$\\frac{\\alpha \\Delta t}{\\Delta x^2} \\le \\frac{1}{2}$。\n3.  $T_{i+1}^n$ 的系数：$r - \\frac{c}{2} \\ge 0$。这意味着 $2r \\ge c$。\n\n让我们分析第三个条件，$2r \\ge c$。代入 $r$ 和 $c$ 的定义：\n$$\n2 \\frac{\\alpha \\Delta t}{\\Delta x^2} \\ge \\frac{u \\Delta t}{\\Delta x}\n$$\n乘以 $\\frac{\\Delta x^2}{\\alpha \\Delta t}$（均为正量）得到：\n$$\n2 \\ge \\frac{u \\Delta x}{\\alpha}\n$$\n项 $\\frac{u \\Delta x}{\\alpha}$ 被定义为单元佩克莱数，$P_e$。因此，这个条件等价于 $P_e \\le 2$。\n\n为了使给定格式是保正的（从而避免非物理的负值下冲），必须同时满足用户可选参数（$\\Delta x, \\Delta t$）的两个条件：\n-   $r = \\frac{\\alpha \\Delta t}{\\Delta x^2} \\le \\frac{1}{2}$\n-   $P_e = \\frac{u \\Delta x}{\\alpha} \\le 2$\n\n问题陈述指出，当“$u$ 很大”时会出现负温度。大的对流速度 $u$ 会导致大的佩克莱数 $P_e$。如果 $P_e > 2$，第三个条件被违反，系数 $\\left( r - \\frac{c}{2} \\right)$ 变为负值。在一个陡峭锋面区域，可能会有 $T_{i-1}^n \\approx 0$，$T_i^n \\approx 0$，而 $T_{i+1}^n > 0$。在这种情况下，负系数乘以一个大的正温度 $T_{i+1}^n$，对 $T_i^{n+1}$ 产生一个负的贡献，并可能使其变为负值。这是观察到的下冲现象的直接机制。\n\n### 逐项分析\n\n**A. 这个陈述是对其背后数值理论的正确而正式的描述。如果一个格式能保持解的序，那么它就是单调的，这意味着对于非负数据，它能保持非负性。对于显式格式 $T^{n+1} = B T^n + \\text{source}$，这要求更新矩阵 $B$ 具有非负的项。我们推导出的条件（$r \\le 1/2$ 和 $c \\le 2r$）正是保证这些系数（即 $B$ 的项）非负的条件。当这些条件成立时，系数之和为 $(r + c/2) + (1-2r) + (r - c/2) = 1$，因此它们构成一个凸组合。与M-矩阵的联系对于隐式或稳态问题是标准的，并且在概念上与确保单调性的离散算子属性相关联。关于纯扩散的例子（$u=0 \\implies c=0$，所以条件仅为 $r \\le 1/2$）是正确的。结论是，违反这些条件会破坏单调性并导致下冲，这与推导结果完全一致。**结论：正确。**\n\n**B. 这个陈述有根本性的错误。在对流主导的情况下，中心差分格式产生的伪振荡和负值下冲是离散化本身的一个众所周知的小说特性。它们存在于数值解数据中，而不仅仅是绘图的伪影。“裁剪”色彩条只是隐藏了非物理值，并不能纠正错误的仿真结果。虽然有限精度可能导致舍入误差，但观察到的下冲通常幅度要大得多，与格式的截断误差有关，并非主要原因。**结论：不正确。**\n\n**C. 这个陈述正确地指出了根本原因：中心差分在高佩克莱数（$P_e > 2$）下的失效。这种失效表现为单调性的丧失和色散误差（振荡）。它接着正确地提出了一类标准且有效的补救措施。一阶迎风格式是无条件单调的（尽管有扩散性），因此只要满足组合的对流扩散方程的CFL条件，它就是保正的。高阶TVD格式和指数拟合是专门设计用于在保持单调性和防止伪振荡的同时提供良好精度的先进技术，使其具有保正性。这些是解决该问题的正确求解器修改方法。**结论：正确。**\n\n**D. 这个陈述具有误导性且不正确。网格加密（减小 $\\Delta x$）会降低单元佩克莱数 $P_e = u \\Delta x / \\alpha$。理论上，确实可以通过加密网格直到处处满足 $P_e \\le 2$。然而，对于高 $u$ 和低 $\\alpha$ 的问题，这可能需要天文数字般的网格点数，使得仿真在计算上不可行，特别是因为扩散时间步长限制 $\\Delta t \\propto \\Delta x^2$ 也会变得极其严格。此外，声称这对“任何相容格式”都有效是错误的。最重要的是，它错误地断言求解器的修改是“不必要的”。在实践中，修改求解器以使用更鲁棒的对流格式（如选项C所述）是标准的、高效的、且专业上公认的工程解决方案。**结论：不正确。**\n\n**E. 这个陈述分析了更简单的纯扩散子问题（$u=0 \\implies c=0 \\implies P_e=0$）。在这种情况下，我们的通用格式简化为 $T_i^{n+1} = (1-2r)T_i^n + r T_{i+1}^n + r T_{i-1}^n + \\Delta t s_i^n$。如前所述，非负系数的条件是 $1-2r \\ge 0$ 和 $r \\ge 0$，可简化为 $0 \\le r \\le 1/2$。如果该条件成立，系数之和为1，构成一个凸组合。该陈述准确地指出，如果 $r > 1/2$，系数 $(1-2r)$ 会变为负值，这可能导致一个正的 $T_i^n$ 引起一个负的 $T_i^{n+1}$。这是整个问题的正确且基本的一部分。**结论：正确。**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "仿真工作的完成并非止于求解器停止计算，严谨的后处理与验证是确保结果可信度的最后一道、也是至关重要的一道关卡。除了结果可视化，后处理更核心的任务是量化数值解的不确定性。本练习将引导我们应用网格收敛指数（Grid Convergence Index, GCI）方法，这是一种在计算流体力学和传热学中广泛使用的标准化流程，用于估计离散误差并为关键输出（如努塞尔数 $Nu$）建立一个可信的区间。掌握此方法对于任何严肃的计算分析都是必不可少的。",
            "id": "3983586",
            "problem": "使用计算流体动力学 (CFD) 对流经长度为 $L$、水力直径为 $D_{h}$ 的直通道内的受热层流进行模拟。材料属性恒定不变，壁面边界条件施加了均匀热通量。后处理目标是面积平均努塞尔数 $Nu$，其根据第一性原理定义为 $Nu = h D_{h} / k$，其中 $h$ 是对流传热系数，$k$ 是热导率。空间离散化沿受热长度方向是均匀的，在预处理中构建了三套系统加密的网格，其在流向上的控制体数量分别为 $N_{3} = 64$、$N_{2} = 128$ 和 $N_{1} = 256$。因此，网格间距的尺度关系为 $h_{i} \\propto L / N_{i}$，加密比满足 $r_{21} = h_{2}/h_{1} = 2$ 和 $r_{32} = h_{3}/h_{2} = 2$。求解器采用二阶空间格式和全隐式时间推进方法计算至稳态；由于所有网格的无量纲残差均已降至 $10^{-8}$ 以下，因此迭代误差可以忽略不计。后处理得到三套网格上的面积平均努塞尔数分别为：$Nu_{3} = 7.880$、$Nu_{2} = 7.974$ 和 $Nu_{1} = 8.017$。假设解处于网格收敛的渐近范围内，且主阶离散误差的行为符合 $E(h) \\approx C h^{p}$，其中 $C$ 为常数，$p$ 为观测到的精度阶数。使用网格收敛指数 (GCI) 的三网格方法，并取安全因子 $F_{s} = 1.25$，在最密网格上构建 GCI，并解释围绕 $Nu_{1}$ 的相应不确定性区间。仅报告基于最密网格的努塞尔数不确定性区间的上限。将最终答案表示为无量纲努塞尔数，并四舍五入至4位有效数字。",
            "solution": "该问题要求计算在最密网格上计算的面积平均努塞尔数 $Nu$ 的不确定性区间的上限。将按照规定，采用网格收敛指数 (GCI) 方法，这是一种估算计算模拟中离散误差的标准化程序。\n\n从三套系统加密的网格中给出的数据如下：\n-   密网格 (1)：解 $\\phi_1 = Nu_1 = 8.017$。\n-   中等网格 (2)：解 $\\phi_2 = Nu_2 = 7.974$。\n-   粗网格 (3)：解 $\\phi_3 = Nu_3 = 7.880$。\n\n网格加密是均匀的，具有恒定的加密比 $r = 2$。GCI 计算的安全因子指定为 $F_s = 1.25$。\n\nGCI 方法假设离散误差 $E$ 服从关系式 $E(h) = \\phi(h) - \\phi_{exact} \\approx C h^p$，其中 $\\phi(h)$ 是特征间距为 $h$ 的网格上的解，$\\phi_{exact}$ 是精确解，$C$ 是一个常数，$p$ 是精度阶数。对于具有恒定加密比 $r = h_2/h_1 = h_3/h_2$ 的三网格研究，可以计算出观测到的精度阶数 $p$。\n\n首先，我们计算连续网格上解之间的差值：\n$$ \\epsilon_{21} = \\phi_2 - \\phi_1 = 7.974 - 8.017 = -0.043 $$\n$$ \\epsilon_{32} = \\phi_3 - \\phi_2 = 7.880 - 7.974 = -0.094 $$\n这些差值的比率 $R$ 用于求解 $p$：\n$$\nR = \\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{\\phi_3 - \\phi_2}{\\phi_2 - \\phi_1} = \\frac{-0.094}{-0.043} = \\frac{94}{43}\n$$\n对于处于渐近范围内的解，该比率约等于 $r^p$。因此，我们可以求解观测到的精度阶数 $p$：\n$$\np = \\frac{\\ln(R)}{\\ln(r)} = \\frac{\\ln\\left(\\frac{94}{43}\\right)}{\\ln(2)} \\approx \\frac{\\ln(2.1860465)}{0.693147} \\approx \\frac{0.782071}{0.693147} \\approx 1.12828\n$$\n密网格解的不确定性 $U$ 是通过将 Richardson 误差估计值乘以安全因子 $F_s$ 计算得出的。密网格解 $\\phi_1$ 的误差估计由 $E_a^{12} = \\frac{\\phi_1 - \\phi_2}{r^p - 1}$ 给出。不确定性 $U$ 为：\n$$\nU = F_s \\left| E_a^{12} \\right| = F_s \\left| \\frac{\\phi_1 - \\phi_2}{r^p - 1} \\right|\n$$\n我们可以将 $r^p = R$ 代入此表达式：\n$$\nU = F_s \\frac{|\\phi_1 - \\phi_2|}{R - 1}\n$$\n代入数值：\n$$\nU = 1.25 \\times \\frac{|8.017 - 7.974|}{\\frac{94}{43} - 1} = 1.25 \\times \\frac{0.043}{\\frac{94 - 43}{43}} = 1.25 \\times \\frac{0.043 \\times 43}{51} = 1.25 \\times \\frac{1.849}{51} \\approx 1.25 \\times 0.0362549 \\approx 0.0453186\n$$\n该问题要求的是围绕密网格努塞尔数 $Nu_1 = \\phi_1$ 的不确定性区间的上限。该不确定性区间定义为 $[\\phi_1 - U, \\phi_1 + U]$。因此，上限为 $\\phi_1 + U$。\n$$\n\\text{Upper Limit} = \\phi_1 + U = 8.017 + 0.0453186 = 8.0623186\n$$\n最后，问题要求将答案四舍五入至4位有效数字。\n$$\n\\text{Upper Limit} \\approx 8.062\n$$\n该值表示在安全因子为 $1.25$ 的情况下，期望精确努塞尔数所在的区间的上界。",
            "answer": "$$\\boxed{8.062}$$"
        }
    ]
}