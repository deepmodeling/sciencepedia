{
    "hands_on_practices": [
        {
            "introduction": "A crucial step in verification is understanding the intrinsic behavior of the numerical schemes you implement. While we design discretizations to approximate a partial differential equation (PDE), they actually solve a different, 'modified' equation that includes higher-order derivative terms originating from truncation error. This exercise guides you through a modified equation analysis, a powerful technique that uses Taylor series to reveal the true PDE being solved and to interpret the leading error term, often as a non-physical 'artificial diffusion' . Mastering this analysis provides deep insight into the sources of numerical error and the stability characteristics of your chosen scheme.",
            "id": "4002986",
            "problem": "In the context of Verification and Validation (V&V) for computational thermal engineering, the method of modified equations is routinely used to perform code verification by revealing the asymptotic model problem that a given discretization actually solves. Consider the one-dimensional linear convective transport of temperature, with constant velocity, governed by\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0,\n$$\nwhere $T = T(x,t)$ and $u$ is a constant that may be positive or negative. Let the spatial domain be partitioned into a uniform grid of nodes $x_{i}$ with spacing $\\Delta x$. Construct a semi-discrete method-of-lines approximation by replacing the spatial derivative with a first-order upwind finite difference consistent with the sign of $u$ (for $u > 0$, use the backward difference at $x_{i}$; for $u < 0$, use the forward difference at $x_{i}$), while keeping time continuous.\n\nStarting strictly from Taylor series expansions about $x_{i}$ and the given governing equation, derive the modified differential equation up to and including terms of order $\\Delta x^2$ that the semi-discrete upwind scheme satisfies. Identify the leading-order term not present in the original partial differential equation, and interpret it as an artificial diffusion of the form $\\kappa_{\\mathrm{art}} \\, \\frac{\\partial^{2} T}{\\partial x^{2}}$ added to the right-hand side. Provide a single, closed-form analytical expression for the artificial diffusivity $\\kappa_{\\mathrm{art}}$ in terms of $u$ and $\\Delta x$, valid for any sign of $u$.\n\nExpress the final answer as a single analytic expression for $\\kappa_{\\mathrm{art}}$. Do not include units in the final boxed answer.",
            "solution": "The task is to find the modified differential equation that the semi-discrete upwind scheme represents. This involves replacing the finite difference approximation of the spatial derivative with its Taylor series expansion to reveal the higher-order derivative terms that are implicitly introduced by the discretization. We must consider two cases based on the sign of the velocity $u$.\n\n**Case 1: $u > 0$**\nFor $u > 0$, the upwind scheme uses a first-order backward difference for the spatial derivative. The semi-discrete equation at node $x_i$ is:\n$$\n\\frac{d T_i}{d t} + u \\left( \\frac{T_i - T_{i-1}}{\\Delta x} \\right) = 0\n$$\nTo find the modified equation, we expand $T_{i-1} = T(x_i - \\Delta x, t)$ in a Taylor series about $x_i$:\n$$\nT_{i-1} = T_i - \\Delta x \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x^2}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i - \\frac{\\Delta x^3}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i + \\mathcal{O}(\\Delta x^4)\n$$\nSubstituting this expansion into the finite difference term:\n$$\n\\frac{T_i - T_{i-1}}{\\Delta x} = \\left.\\frac{\\partial T}{\\partial x}\\right|_i - \\frac{\\Delta x}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\frac{\\Delta x^2}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i - \\mathcal{O}(\\Delta x^3)\n$$\nNow, we substitute this expression back into the semi-discrete equation. We replace the discrete nodal value $T_i(t)$ with the continuous function $T(x,t)$ to obtain the modified differential equation:\n$$\n\\frac{\\partial T}{\\partial t} + u \\left( \\frac{\\partial T}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} - \\mathcal{O}(\\Delta x^3) \\right) = 0\n$$\nRearranging the terms to match the form of the original PDE plus correction terms:\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = u \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} - u \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\mathcal{O}(\\Delta x^4)\n$$\nThe leading-order error term is the second-derivative term on the right-hand side. This is an artificial diffusion (or numerical dissipation) term of the form $\\kappa_{\\mathrm{art}} \\frac{\\partial^2 T}{\\partial x^2}$. By comparison, we identify the artificial diffusivity for $u>0$ as:\n$$\n\\kappa_{\\mathrm{art}} = u \\frac{\\Delta x}{2}\n$$\n\n**Case 2: $u < 0$**\nFor $u < 0$, the upwind scheme uses a first-order forward difference:\n$$\n\\frac{d T_i}{d t} + u \\left( \\frac{T_{i+1} - T_i}{\\Delta x} \\right) = 0\n$$\nWe expand $T_{i+1} = T(x_i + \\Delta x, t)$ in a Taylor series about $x_i$:\n$$\nT_{i+1} = T_i + \\Delta x \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x^2}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\frac{\\Delta x^3}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i + \\mathcal{O}(\\Delta x^4)\n$$\nThe finite difference term becomes:\n$$\n\\frac{T_{i+1} - T_i}{\\Delta x} = \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\frac{\\Delta x^2}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i + \\mathcal{O}(\\Delta x^3)\n$$\nSubstituting this expression into the semi-discrete equation gives the modified equation:\n$$\n\\frac{\\partial T}{\\partial t} + u \\left( \\frac{\\partial T}{\\partial x} + \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\mathcal{O}(\\Delta x^3) \\right) = 0\n$$\nRearranging the terms:\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = -u \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} - u \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\mathcal{O}(\\Delta x^4)\n$$\nComparing the leading-order error term to $\\kappa_{\\mathrm{art}} \\frac{\\partial^2 T}{\\partial x^2}$, we identify the artificial diffusivity for $u<0$ as:\n$$\n\\kappa_{\\mathrm{art}} = -u \\frac{\\Delta x}{2}\n$$\n\n**General Expression for $\\kappa_{\\mathrm{art}}$**\nWe have derived the artificial diffusivity for both signs of $u$:\n-   If $u > 0$, $\\kappa_{\\mathrm{art}} = u \\frac{\\Delta x}{2}$.\n-   If $u < 0$, $\\kappa_{\\mathrm{art}} = -u \\frac{\\Delta x}{2}$.\n\nWe can combine these two results into a single expression using the absolute value function. If $u > 0$, then $|u| = u$. If $u < 0$, then $|u| = -u$. In both cases, the expression for the artificial diffusivity can be written as:\n$$\n\\kappa_{\\mathrm{art}} = |u| \\frac{\\Delta x}{2}\n$$\nThis single, closed-form expression is valid for any non-zero $u$. This term is always non-negative ($\\kappa_{\\mathrm{art}} \\ge 0$, since $\\Delta x > 0$), which confirms its diffusive nature, as a negative diffusion coefficient would lead to an ill-posed, unstable problem.",
            "answer": "$$\n\\boxed{\\frac{|u|\\Delta x}{2}}\n$$"
        },
        {
            "introduction": "While analyzing individual schemes is essential, verifying the correctness of the entire computational solver is paramount. The Method of Manufactured Solutions (MMS) is the gold standard for this type of code verification, especially when analytical solutions to the original problem are unavailable. This practice  has you work 'backwards' by selecting a smooth analytical function as a 'manufactured' solution and deriving the necessary source term and boundary conditions that make it an exact solution to the governing equations. By forcing your code to solve this problem, you can rigorously check its implementation and confirm that it achieves the expected order of accuracy.",
            "id": "4003053",
            "problem": "A computational heat transfer code is to be verified using the Method of Manufactured Solutions (MMS). Consider two-dimensional transient heat conduction in a homogeneous, isotropic medium with constant thermal diffusivity $\\alpha>0$ on the unit square domain $\\Omega=(0,1)\\times(0,1)$ for time $t>0$. The governing equation in terms of a scalar field $u(x,y,t)$ is\n$$\n\\frac{\\partial u}{\\partial t}=\\alpha\\left(\\frac{\\partial^{2}u}{\\partial x^{2}}+\\frac{\\partial^{2}u}{\\partial y^{2}}\\right)+S(x,y,t),\n$$\nwhere $S(x,y,t)$ is a volumetric source term.\n\nUsing the Method of Manufactured Solutions (MMS), let the manufactured solution be\n$$\nu(x,y,t)=\\sin(\\pi x)\\sin(\\pi y)\\exp\\!\\big(-2\\pi^{2}\\alpha t\\big).\n$$\n\nStarting from conservation of energy and Fourierâ€™s law as the fundamental base, derive the corresponding manufactured source term $S(x,y,t)$ that makes $u(x,y,t)$ an exact solution of the governing equation. Then, specify boundary and initial conditions that are strictly consistent with the manufactured solution and suitable for code verification with Dirichlet data on all sides of $\\partial\\Omega$.\n\nAnswer specification:\n- Provide your final answer as a row vector with three entries in the following order: the analytic expression for $S(x,y,t)$, the initial condition $u(x,y,0)$, and the Dirichlet boundary value $g(x,y,t)$ to be imposed on $\\partial\\Omega$.\n- Express the answer in terms of $x$, $y$, $t$, $\\alpha$, and $\\pi$ only.\n- No numerical evaluation or rounding is required, and no physical units need to be reported in the final answer.",
            "solution": "The Method of Manufactured Solutions (MMS) requires substituting the chosen manufactured solution into the governing partial differential equation (PDE) to determine the necessary source term $S(x,y,t)$ that makes the equation hold true. We start by rearranging the governing equation to solve for $S(x,y,t)$:\n$$\nS(x,y,t) = \\frac{\\partial u}{\\partial t} - \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\nThe manufactured solution is given as $u(x,y,t) = \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t)$. We must now compute the required partial derivatives of $u(x,y,t)$.\n\nFirst, the partial derivative with respect to time, $t$:\n$$\n\\frac{\\partial u}{\\partial t} = \\sin(\\pi x)\\sin(\\pi y) \\cdot \\left( -2\\pi^2\\alpha \\right) \\exp(-2\\pi^2\\alpha t) = -2\\pi^2\\alpha u(x,y,t)\n$$\nNext, the second partial derivatives with respect to the spatial coordinates, $x$ and $y$.\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) = -\\pi^2 u(x,y,t)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial y^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) = -\\pi^2 u(x,y,t)\n$$\nThe Laplacian is therefore $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = -2\\pi^2 u(x,y,t)$.\n\nNow, we substitute these derivatives into the expression for $S(x,y,t)$:\n$$\nS(x,y,t) = (-2\\pi^2\\alpha u) - \\alpha (-2\\pi^2 u) = -2\\pi^2\\alpha u + 2\\pi^2\\alpha u = 0\n$$\nThe source term is zero. This indicates that the manufactured solution is an analytical solution to the homogeneous heat equation.\n\nNext, we specify the initial condition, $u(x,y,0)$, by evaluating the manufactured solution at $t=0$:\n$$\nu(x,y,0) = \\sin(\\pi x)\\sin(\\pi y)\\exp(0) = \\sin(\\pi x)\\sin(\\pi y)\n$$\nFinally, we specify the Dirichlet boundary condition, $g(x,y,t)$, by evaluating the manufactured solution on the boundary $\\partial\\Omega$ of the unit square. For any point on the boundary, either $x=0$, $x=1$, $y=0$, or $y=1$.\n- At $x=0$ and $x=1$, the term $\\sin(\\pi x)$ is zero.\n- At $y=0$ and $y=1$, the term $\\sin(\\pi y)$ is zero.\nIn all cases, the manufactured solution $u(x,y,t)$ is zero on the boundary $\\partial\\Omega$ for all time $t>0$. Therefore, the consistent Dirichlet boundary condition is:\n$$\ng(x,y,t) = 0\n$$\nThe three required components for the final answer are:\n1.  Source term: $S(x,y,t) = 0$.\n2.  Initial condition: $u(x,y,0) = \\sin(\\pi x)\\sin(\\pi y)$.\n3.  Dirichlet boundary condition: $g(x,y,t) = 0$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\sin(\\pi x)\\sin(\\pi y) & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "After verifying that your code is correctly implemented, the focus shifts to solution verification: quantifying the uncertainty in a simulation performed for a problem without a known exact solution. The Grid Convergence Index (GCI) is a widely accepted, standardized method for estimating the discretization error from a series of grid refinement studies. In this exercise , you will apply the GCI methodology to quantify the numerical uncertainty in a computed quantity of interest, learning how to use Richardson Extrapolation and a safety factor to establish a credible error band for your simulation results. This skill is fundamental to reporting computational findings with scientific rigor.",
            "id": "4003027",
            "problem": "A one-dimensional, steady-state conduction problem is solved in a homogeneous slab of length $L$ with Dirichlet boundary conditions $T(0)=T_{0}$ and $T(L)=T_{L}$ and constant thermal conductivity $k$. A finite-volume discretization with second-order central differencing is used to compute the wall heat flux magnitude at $x=0$, denoted by $\\phi$. Three uniform meshes are employed with $N_{3}=32$, $N_{2}=64$, and $N_{1}=128$ control volumes, so that the uniform refinement ratios satisfy $r_{32}=h_{3}/h_{2}=2$ and $r_{21}=h_{2}/h_{1}=2$, where $h_{j}=L/N_{j}$. The computed quantities of interest on these meshes are\n$\\phi_{3}=1.0160\\times 10^{4}$, $\\phi_{2}=1.0040\\times 10^{4}$, and $\\phi_{1}=1.0010\\times 10^{4}$.\nA separate three-grid analysis has established an apparent order of accuracy $p_{\\mathrm{obs}}=1.98$ for this quantity. Using the classical definition of the Grid Convergence Index (GCI) for the fine grid based on the discretization error model and Richardson extrapolation, and adopting the recommended safety factor $F_{s}=1.25$ for three-grid verification in the asymptotic range, compute the fine-grid Grid Convergence Index $\\mathrm{GCI}_{21}$ for $\\phi$ using the $(1,2)$ grid pair and $p_{\\mathrm{obs}}$. Round your final answer to four significant figures and express it as a dimensionless decimal fraction. In your solution, justify the GCI formula from the discretization error model and interpret the role of the safety factor $F_{s}$ in the GCI expression (conceptual interpretation only; the final answer must be the computed numerical value).",
            "solution": "The solution will first justify the GCI formula based on the discretization error model and Richardson extrapolation, then interpret the role of the safety factor as requested, and finally compute the required numerical value.\n\n**Justification of the GCI Formula**\nThe foundation of the Grid Convergence Index (GCI) is the modeling of discretization error. For a numerical scheme with an order of accuracy $p$, the solution $\\phi_h$ on a grid with characteristic size $h$ is assumed to follow the error model:\n$$\n\\phi_h \\approx \\phi_{\\mathrm{exact}} + c h^p\n$$\nwhere $\\phi_{\\mathrm{exact}}$ is the exact solution to the continuum equations, and $c$ is a constant.\n\nWe apply this model to the fine grid (grid 1, size $h_1$) and the coarser grid (grid 2, size $h_2=r_{21}h_1$):\n$$\n\\phi_1 \\approx \\phi_{\\mathrm{exact}} + c h_1^p\n$$\n$$\n\\phi_2 \\approx \\phi_{\\mathrm{exact}} + c (r_{21} h_1)^p\n$$\nSolving this system of two equations for the unknown $\\phi_{\\mathrm{exact}}$ yields the Richardson extrapolated solution, $\\phi_{\\mathrm{extrap}}^{21}$:\n$$\n\\phi_{\\mathrm{extrap}}^{21} = \\phi_1 + \\frac{\\phi_1 - \\phi_2}{r_{21}^p - 1}\n$$\nThe estimated error in the fine-grid solution, $E_a^{21}$, is the difference between the extrapolated value and the fine-grid solution:\n$$\nE_a^{21} = \\phi_{\\mathrm{extrap}}^{21} - \\phi_1 = \\frac{\\phi_1 - \\phi_2}{r_{21}^p - 1}\n$$\nThe GCI is defined as a measure of the uncertainty in the fine-grid solution. It is based on the magnitude of the estimated error, scaled by a factor of safety $F_s$, and expressed as a relative quantity:\n$$\n\\mathrm{GCI}_{21} = F_s \\left| \\frac{E_a^{21}}{\\phi_1} \\right| = \\frac{F_s}{|r_{21}^p - 1|} \\left| \\frac{\\phi_1 - \\phi_2}{\\phi_1} \\right|\n$$\n\n**Role of the Safety Factor $F_s$**\nThe factor of safety, $F_s$, serves to create a conservative error band. Its value reflects the confidence in the assumptions underlying the extrapolation. The Richardson extrapolation assumes the numerical solution is in the asymptotic range, which may not be perfectly true. Using $F_s > 1$ (e.g., $F_s=1.25$ is recommended for three-grid studies where the observed order of convergence is close to the theoretical order) inflates the estimated error to create an uncertainty interval, $\\phi_1 \\pm (\\mathrm{GCI}_{21} \\cdot \\phi_1)$, that is more likely (e.g., with 95% confidence) to contain the exact solution $\\phi_{\\mathrm{exact}}$.\n\n**Calculation**\nWe substitute the given values into the GCI formula:\n- Fine-grid solution: $\\phi_1 = 1.0010 \\times 10^4$\n- Coarse-grid solution: $\\phi_2 = 1.0040 \\times 10^4$\n- Refinement ratio: $r_{21} = 2$\n- Observed order of accuracy: $p = p_{\\mathrm{obs}} = 1.98$\n- Factor of safety: $F_s = 1.25$\n\nFirst, we compute the relative difference:\n$$\n\\left| \\frac{\\phi_1 - \\phi_2}{\\phi_1} \\right| = \\left| \\frac{1.0010 \\times 10^4 - 1.0040 \\times 10^4}{1.0010 \\times 10^4} \\right| = \\frac{0.0030}{1.0010}\n$$\nNext, we compute the denominator:\n$$\nr_{21}^p - 1 = 2^{1.98} - 1 \\approx 3.944835 - 1 = 2.944835\n$$\nNow, substitute into the GCI formula:\n$$\n\\mathrm{GCI}_{21} = \\frac{1.25}{2.944835} \\times \\frac{0.0030}{1.0010} \\approx (0.424469) \\times (0.002997003) \\approx 0.00127214\n$$\nRounding the final answer to four significant figures gives:\n$$\n\\mathrm{GCI}_{21} \\approx 0.001272\n$$\nThis represents an estimated uncertainty of approximately 0.1272% in the fine-grid solution $\\phi_1$.",
            "answer": "$$\n\\boxed{0.001272}\n$$"
        }
    ]
}