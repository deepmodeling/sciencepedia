{
    "hands_on_practices": [
        {
            "introduction": "在验证计算代码时，理解其核心离散格式的行为至关重要。修正方程法是一种强大的解析工具，它揭示了数值格式实际求解的等效偏微分方程。本练习将通过推导一阶迎风格式的修正方程，让您亲身体验如何识别和量化由离散化引入的非物理效应，例如数值扩散（或称人工黏性）。",
            "id": "4002986",
            "problem": "在计算热工学的验证与确认 (V&V) 背景下，修正方程法通常用于执行程序验证，通过揭示给定离散化方法实际求解的渐近模型问题。考虑由以下方程控制的、具有恒定速度的一维线性温度对流输运：\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0,\n$$\n其中 $T = T(x,t)$，$u$ 是一个可正可负的常数。设空间域被划分为一个由节点 $x_{i}$ 组成的均匀网格，节点间距为 $\\Delta x$。通过将空间导数替换为与 $u$ 符号一致的一阶迎风有限差分（对于 $u > 0$，在 $x_{i}$ 处使用后向差分；对于 $u < 0$，在 $x_{i}$ 处使用前向差分），同时保持时间连续，构建一个半离散线方法近似。\n\n严格从关于 $x_{i}$ 的泰勒级数展开和给定的控制方程出发，推导该半离散迎风格式所满足的修正微分方程，直至并包含 $\\Delta x^{2}$ 阶的项。识别出原始偏微分方程中不存在的领头阶项，并将其解释为添加到右侧的、形式为 $\\kappa_{\\mathrm{art}} \\, \\frac{\\partial^{2} T}{\\partial x^{2}}$ 的人为扩散。提供一个关于 $u$ 和 $\\Delta x$ 的、对任意符号的 $u$ 都有效的人为扩散系数 $\\kappa_{\\mathrm{art}}$ 的单一闭式解析表达式。\n\n将最终答案表示为 $\\kappa_{\\mathrm{art}}$ 的单个解析表达式。最终的方框答案中不包含单位。",
            "solution": "问题陈述需进行验证。\n\n**步骤1：提取已知条件**\n-   控制方程：$$ \\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0 $$\n-   温度：$T = T(x,t)$\n-   速度：$u$ 是一个可正可负的常数。\n-   网格：由节点 $x_i$ 组成的均匀网格，间距为 $\\Delta x$。\n-   离散化：一种半离散线方法近似，其中 $\\frac{\\partial T}{\\partial t}$ 保持连续。空间导数 $\\frac{\\partial T}{\\partial x}$ 被一阶迎风有限差分替换：\n    -   对于 $u > 0$，在 $x_i$ 处使用后向差分：$\\frac{T_i - T_{i-1}}{\\Delta x}$。\n    -   对于 $u  0$，在 $x_i$ 处使用前向差分：$\\frac{T_{i+1} - T_{i}}{\\Delta x}$。\n-   目标：\n    1.  推导该半离散格式所满足的修正微分方程，直至并包含 $\\Delta x^2$ 阶的项。\n    2.  使用泰勒级数展开和控制方程。\n    3.  识别出原始偏微分方程中不存在的领头阶项。\n    4.  将此项解释为形式为 $\\kappa_{\\mathrm{art}} \\, \\frac{\\partial^{2} T}{\\partial x^{2}}$ 的人为扩散。\n    5.  找到一个关于 $u$ 和 $\\Delta x$ 的、对任意符号的 $u$ 都有效的人为扩散系数 $\\kappa_{\\mathrm{art}}$ 的单一闭式表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题基于线性对流方程和修正方程法，这些是数值分析和计算流体动力学中的标准课题。迎风差分格式是一种基本的数值方法。这些概念在科学上是合理的。\n-   **适定性**：该问题是适定的。它要求进行特定的数学推导，具有明确定义的起点和唯一可确定的终点（$\\kappa_{\\mathrm{art}}$ 的表达式）。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n-   **完整性与一致性**：该问题提供了所有必要的信息，包括控制偏微分方程、正负速度下的离散化形式以及要执行的具体分析。这些条件是自洽的。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**解答推导**\n任务是找到半离散迎风格式所代表的修正微分方程。这涉及到用空间导数的有限差分近似的泰勒级数展开来替换它，以揭示由离散化隐式引入的高阶导数项。我们必须根据速度 $u$ 的符号考虑两种情况。\n\n**情况1：$u  0$**\n对于 $u > 0$，迎风格式对空间导数使用一阶后向差分。在节点 $x_i$ 处的半离散方程为：\n$$\n\\frac{d T_i}{d t} + u \\left( \\frac{T_i - T_{i-1}}{\\Delta x} \\right) = 0\n$$\n为了找到修正方程，我们将 $T_{i-1} = T(x_i - \\Delta x, t)$ 在 $x_i$ 处进行泰勒级数展开：\n$$\nT_{i-1} = T_i - \\Delta x \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x^2}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i - \\frac{\\Delta x^3}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i + \\mathcal{O}(\\Delta x^4)\n$$\n将此展开式代入有限差分项：\n$$\n\\frac{T_i - T_{i-1}}{\\Delta x} = \\frac{T_i - \\left( T_i - \\Delta x \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x^2}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i - \\frac{\\Delta x^3}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i + \\dots \\right)}{\\Delta x}\n$$\n$$\n\\frac{T_i - T_{i-1}}{\\Delta x} = \\frac{\\Delta x \\left.\\frac{\\partial T}{\\partial x}\\right|_i - \\frac{\\Delta x^2}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\frac{\\Delta x^3}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i - \\dots}{\\Delta x}\n$$\n$$\n\\frac{T_i - T_{i-1}}{\\Delta x} = \\left.\\frac{\\partial T}{\\partial x}\\right|_i - \\frac{\\Delta x}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\frac{\\Delta x^2}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i - \\mathcal{O}(\\Delta x^3)\n$$\n现在，我们将此表达式代回半离散方程中。我们用连续函数 $T(x,t)$ 替换离散节点值 $T_i(t)$，以获得修正微分方程：\n$$\n\\frac{\\partial T}{\\partial t} + u \\left( \\frac{\\partial T}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} - \\mathcal{O}(\\Delta x^3) \\right) = 0\n$$\n重新整理各项，以匹配原始偏微分方程加上修正项的形式：\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = u \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} - u \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\mathcal{O}(\\Delta x^4)\n$$\n问题要求方程达到并包含 $\\Delta x^2$ 阶的项。这就是 $u > 0$ 时所期望的修正方程。原始偏微分方程中不存在的领头阶项是右侧的二阶导数项。这是一个形式为 $\\kappa_{\\mathrm{art}} \\frac{\\partial^2 T}{\\partial x^2}$ 的人为扩散（或数值耗散）项。通过比较，我们确定当 $u > 0$ 时的人为扩散系数为：\n$$\n\\kappa_{\\mathrm{art}} = u \\frac{\\Delta x}{2}\n$$\n\n**情况2：$u  0$**\n对于 $u  0$，迎风格式使用一阶前向差分。在节点 $x_i$ 处的半离散方程为：\n$$\n\\frac{d T_i}{d t} + u \\left( \\frac{T_{i+1} - T_i}{\\Delta x} \\right) = 0\n$$\n我们将 $T_{i+1} = T(x_i + \\Delta x, t)$ 在 $x_i$ 处进行泰勒级数展开：\n$$\nT_{i+1} = T_i + \\Delta x \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x^2}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\frac{\\Delta x^3}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i + \\mathcal{O}(\\Delta x^4)\n$$\n将此代入有限差分项：\n$$\n\\frac{T_{i+1} - T_i}{\\Delta x} = \\frac{\\left( T_i + \\Delta x \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x^2}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\dots \\right) - T_i}{\\Delta x}\n$$\n$$\n\\frac{T_{i+1} - T_i}{\\Delta x} = \\left.\\frac{\\partial T}{\\partial x}\\right|_i + \\frac{\\Delta x}{2} \\left.\\frac{\\partial^2 T}{\\partial x^2}\\right|_i + \\frac{\\Delta x^2}{6} \\left.\\frac{\\partial^3 T}{\\partial x^3}\\right|_i + \\mathcal{O}(\\Delta x^3)\n$$\n将此表达式代回半离散方程以得到修正方程：\n$$\n\\frac{\\partial T}{\\partial t} + u \\left( \\frac{\\partial T}{\\partial x} + \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\mathcal{O}(\\Delta x^3) \\right) = 0\n$$\n重新整理各项：\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = -u \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} - u \\frac{\\Delta x^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\mathcal{O}(\\Delta x^4)\n$$\n这是 $u  0$ 时的修正方程。将领头阶误差项与 $\\kappa_{\\mathrm{art}} \\frac{\\partial^2 T}{\\partial x^2}$ 进行比较，我们确定当 $u  0$ 时的人为扩散系数为：\n$$\n\\kappa_{\\mathrm{art}} = -u \\frac{\\Delta x}{2}\n$$\n\n**$\\kappa_{\\mathrm{art}}$ 的通用表达式**\n我们已经推导出了 $u$ 两种符号下的人为扩散系数：\n-   如果 $u > 0$，则 $\\kappa_{\\mathrm{art}} = u \\frac{\\Delta x}{2}$。\n-   如果 $u  0$，则 $\\kappa_{\\mathrm{art}} = -u \\frac{\\Delta x}{2}$。\n\n我们可以使用绝对值函数将这两个结果合并为一个表达式。如果 $u > 0$，则 $|u| = u$。如果 $u  0$，则 $|u| = -u$。在这两种情况下，人为扩散系数的表达式都可以写成：\n$$\n\\kappa_{\\mathrm{art}} = |u| \\frac{\\Delta x}{2}\n$$\n这个单一的闭式表达式对任何非零 $u$ 都有效。此项始终为非负（$\\kappa_{\\mathrm{art}} \\ge 0$，因为 $\\Delta x  0$），这证实了其扩散性质，因为负的扩散系数会导致一个不适定、不稳定的问题。",
            "answer": "$$\n\\boxed{\\frac{|u|\\Delta x}{2}}\n$$"
        },
        {
            "introduction": "代码验证的核心任务是确认软件正确地求解了其所宣称的目标控制方程。制造解方法（Method of Manufactured Solutions, MMS）是实现这一目标的“黄金标准”，它通过构造一个精确解来严格测试代码的实现。在此实践中，您将学习如何为一个瞬态热传导问题推导出一个“制造”源项，从而强制一个预先选择的解析函数成为控制方程的精确解。",
            "id": "4003053",
            "problem": "一个计算传热学代码将使用制造解方法 (Method of Manufactured Solutions, MMS) 进行验证。考虑在单位正方形域 $\\Omega=(0,1)\\times(0,1)$ 上，对于时间 $t0$，在具有恒定热扩散率 $\\alpha0$ 的均匀、各向同性介质中的二维瞬态热传导。以标量场 $u(x,y,t)$ 表示的控制方程为\n$$\n\\frac{\\partial u}{\\partial t}=\\alpha\\left(\\frac{\\partial^{2}u}{\\partial x^{2}}+\\frac{\\partial^{2}u}{\\partial y^{2}}\\right)+S(x,y,t),\n$$\n其中 $S(x,y,t)$ 是一个体积源项。\n\n使用制造解方法 (MMS)，令制造解为\n$$\nu(x,y,t)=\\sin(\\pi x)\\sin(\\pi y)\\exp\\!\\big(-2\\pi^{2}\\alpha t\\big).\n$$\n\n从能量守恒和傅里叶定律作为基本出发点，推导相应的制造源项 $S(x,y,t)$，使得 $u(x,y,t)$ 成为控制方程的精确解。然后，指定与制造解严格一致且适用于在 $\\partial\\Omega$ 所有边界上使用狄利克雷 (Dirichlet) 数据进行代码验证的边界和初始条件。\n\n答案规范：\n- 最终答案以一个行向量的形式给出，包含三个条目，顺序如下：$S(x,y,t)$ 的解析表达式、初始条件 $u(x,y,0)$，以及施加在 $\\partial\\Omega$ 上的狄利克雷边界值 $g(x,y,t)$。\n- 答案仅用 $x$、$y$、$t$、$\\alpha$ 和 $\\pi$ 表示。\n- 无需进行数值计算或四舍五入，最终答案中也无需报告物理单位。",
            "solution": "用户希望我解决以下问题：\n一个计算传热学代码将使用制造解方法 (Method of Manufactured Solutions, MMS) 进行验证。考虑在单位正方形域 $\\Omega=(0,1)\\times(0,1)$ 上，对于时间 $t0$，在具有恒定热扩散率 $\\alpha0$ 的均匀、各向同性介质中的二维瞬态热传导。以标量场 $u(x,y,t)$ 表示的控制方程为\n$$\n\\frac{\\partial u}{\\partial t}=\\alpha\\left(\\frac{\\partial^{2}u}{\\partial x^{2}}+\\frac{\\partial^{2}u}{\\partial y^{2}}\\right)+S(x,y,t),\n$$\n其中 $S(x,y,t)$ 是一个体积源项。\n\n使用制造解方法 (MMS)，令制造解为\n$$\nu(x,y,t)=\\sin(\\pi x)\\sin(\\pi y)\\exp\\!\\big(-2\\pi^{2}\\alpha t\\big).\n$$\n\n从能量守恒和傅里叶定律作为基本出发点，推导相应的制造源项 $S(x,y,t)$，使得 $u(x,y,t)$ 成为控制方程的精确解。然后，指定与制造解严格一致且适用于在 $\\partial\\Omega$ 所有边界上使用狄利克雷 (Dirichlet) 数据进行代码验证的边界和初始条件。\n\n答案规范：\n- 最终答案以一个行向量的形式给出，包含三个条目，顺序如下：$S(x,y,t)$ 的解析表达式、初始条件 $u(x,y,0)$，以及施加在 $\\partial\\Omega$ 上的狄利克雷边界值 $g(x,y,t)$。\n- 答案仅用 $x$、$y$、$t$、$\\alpha$ 和 $\\pi$ 表示。\n- 无需进行数值计算或四舍五入，最终答案中也无需报告物理单位。\n\n### 第 1 步：提取已知条件\n- **控制方程**：$\\frac{\\partial u}{\\partial t}=\\alpha\\left(\\frac{\\partial^{2}u}{\\partial x^{2}}+\\frac{\\partial^{2}u}{\\partial y^{2}}\\right)+S(x,y,t)$\n- **制造解**：$u(x,y,t)=\\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^{2}\\alpha t)$\n- **域**：$\\Omega=(0,1)\\times(0,1)$，对于 $t0$\n- **参数**：热扩散率 $\\alpha0$ (常数)\n- **介质**：均匀、各向同性\n- **任务**：\n  1. 推导源项 $S(x,y,t)$。\n  2. 指定初始条件 $u(x,y,0)$。\n  3. 指定在 $\\partial\\Omega$ 上的狄利克雷边界条件 $g(x,y,t)$。\n- **答案格式**：一个包含 $[S(x,y,t), u(x,y,0), g(x,y,t)]$ 的行向量。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于热方程，这是一个基本的物理定律。制造解方法 (MMS) 是计算科学与工程中用于软件验证的标准且严谨的技术。该设置在科学上是合理的。\n- **适定性**：问题陈述清晰。它要求推导一个源项以及相应的边界/初始条件，以强制一个选定的函数成为偏微分方程的精确解。这是一个直接、明确的数学过程，会得到唯一的解。该问题是适定的。\n- **客观性**：该问题用精确的数学表达式和术语定义，没有任何主观或模棱两可的语言。\n- **结论**：该问题是自洽的，有科学依据且适定。它没有违反任何无效标准。\n\n### 第 3 步：结论和行动\n该问题是有效的。将提供一个完整的解答。\n\n制造解方法 (MMS) 要求将所选的制造解代入控制偏微分方程 (PDE) 中，以确定能使该方程成立的必要源项 $S(x,y,t)$。我们首先重新整理控制方程来求解 $S(x,y,t)$：\n$$\nS(x,y,t) = \\frac{\\partial u}{\\partial t} - \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n制造解由 $u(x,y,t) = \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t)$ 给出。我们现在必须计算 $u(x,y,t)$ 所需的偏导数。\n\n首先，是关于时间 $t$ 的偏导数：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right]\n$$\n$$\n\\frac{\\partial u}{\\partial t} = \\sin(\\pi x)\\sin(\\pi y) \\cdot \\left( -2\\pi^2\\alpha \\right) \\exp(-2\\pi^2\\alpha t)\n$$\n$$\n\\frac{\\partial u}{\\partial t} = -2\\pi^2\\alpha \\sin(\\pi x)\\sin(\\pi y) \\exp(-2\\pi^2\\alpha t)\n$$\n\n接下来，是关于空间坐标 $x$ 和 $y$ 的二阶偏导数。对于 $x$：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right] = \\pi \\cos(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ \\pi \\cos(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right] = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t)\n$$\n\n同理，对于 $y$：\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right] = \\pi \\sin(\\pi x)\\cos(\\pi y)\\exp(-2\\pi^2\\alpha t)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left[ \\pi \\sin(\\pi x)\\cos(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right] = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t)\n$$\n\n现在，我们将这些导数代入 $S(x,y,t)$ 的表达式中：\n$$\nS(x,y,t) = \\left( -2\\pi^2\\alpha \\sin(\\pi x)\\sin(\\pi y) \\exp(-2\\pi^2\\alpha t) \\right) - \\alpha \\left[ \\left( -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right) + \\left( -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right) \\right]\n$$\n$$\nS(x,y,t) = -2\\pi^2\\alpha \\sin(\\pi x)\\sin(\\pi y) \\exp(-2\\pi^2\\alpha t) - \\alpha \\left[ -2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) \\right]\n$$\n$$\nS(x,y,t) = -2\\pi^2\\alpha \\sin(\\pi x)\\sin(\\pi y) \\exp(-2\\pi^2\\alpha t) + 2\\pi^2\\alpha \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t)\n$$\n$$\nS(x,y,t) = 0\n$$\n源项为零。这表明该制造解是齐次热方程的一个解。\n\n接下来，我们通过计算制造解在 $t=0$ 时的值来指定初始条件 $u(x,y,0)$：\n$$\nu(x,y,0) = \\sin(\\pi x)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha \\cdot 0) = \\sin(\\pi x)\\sin(\\pi y)\\exp(0)\n$$\n$$\nu(x,y,0) = \\sin(\\pi x)\\sin(\\pi y)\n$$\n\n最后，我们通过计算制造解在单位正方形域 $\\Omega=(0,1)\\times(0,1)$ 的边界 $\\partial\\Omega$ 上的值来指定狄利克雷边界条件 $g(x,y,t)$。边界由四条边组成：$x=0$、$x=1$、$y=0$ 和 $y=1$。\n- 在 $x=0$ ($0 \\le y \\le 1$) 上：$g(0,y,t) = \\sin(0)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) = 0$。\n- 在 $x=1$ ($0 \\le y \\le 1$) 上：$g(1,y,t) = \\sin(\\pi)\\sin(\\pi y)\\exp(-2\\pi^2\\alpha t) = 0$。\n- 在 $y=0$ ($0 \\le x \\le 1$) 上：$g(x,0,t) = \\sin(\\pi x)\\sin(0)\\exp(-2\\pi^2\\alpha t) = 0$。\n- 在 $y=1$ ($0 \\le x \\le 1$) 上：$g(x,1,t) = \\sin(\\pi x)\\sin(\\pi)\\exp(-2\\pi^2\\alpha t) = 0$。\n\n由于对于所有时间 $t0$，制造解在边界的所有部分上都为零，因此一致的狄利克雷边界条件是一个恒定的零。\n$$\ng(x,y,t) = 0 \\quad \\text{对于 } (x,y) \\in \\partial\\Omega, t  0\n$$\n\n所需的三个分量是：\n1. 源项：$S(x,y,t) = 0$。\n2. 初始条件：$u(x,y,0) = \\sin(\\pi x)\\sin(\\pi y)$。\n3. 狄利克雷边界条件：$g(x,y,t) = 0$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  \\sin(\\pi x)\\sin(\\pi y)  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在代码经过验证并确认其能够产生可靠的工程结果之后，我们必须量化仿真结果中的离散化误差。对于大多数实际问题，由于精确解是未知的，我们必须依赖于系统性的网格收敛性研究。本练习将指导您应用网格收敛指数（Grid Convergence Index, GCI）方法，这是一种基于理查森外推法的标准化程序，用于估算精细网格解的不确定性。",
            "id": "4003027",
            "problem": "在一个长度为 $L$ 的均匀平板中求解一个一维稳态热传导问题，其边界条件为狄利克雷边界条件 $T(0)=T_{0}$ 和 $T(L)=T_{L}$，导热系数 $k$ 为常数。采用二阶中心差分的有限体积离散化方法计算 $x=0$ 处的壁面热通量大小，记为 $\\phi$。使用了三套均匀网格，分别包含 $N_{3}=32$、$N_{2}=64$ 和 $N_{1}=128$ 个控制体积，因此均匀加密比满足 $r_{32}=h_{3}/h_{2}=2$ 和 $r_{21}=h_{2}/h_{1}=2$，其中 $h_{j}=L/N_{j}$。在这些网格上计算得到的目标量为\n$\\phi_{3}=1.0160\\times 10^{4}$、$\\phi_{2}=1.0040\\times 10^{4}$ 和 $\\phi_{1}=1.0010\\times 10^{4}$。\n一项独立的三套网格分析确定了该量的表观精度阶为 $p_{\\mathrm{obs}}=1.98$。基于离散误差模型和 Richardson 外推法，使用细网格的网格收敛指数 (GCI) 的经典定义，并采用在渐近区域内进行三套网格验证时推荐的安全因子 $F_{s}=1.25$，利用 $(1,2)$ 网格对和 $p_{\\mathrm{obs}}$ 计算 $\\phi$ 的细网格网格收敛指数 $\\mathrm{GCI}_{21}$。将最终答案四舍五入至四位有效数字，并表示为无量纲小数。在你的解答中，从离散误差模型出发推导 GCI 公式，并解释安全因子 $F_{s}$ 在 GCI 表达式中的作用（仅需概念性解释；最终答案必须为计算出的数值）。",
            "solution": "首先验证问题，以确保其具有科学依据、良定且客观。\n\n**第1步：提取已知条件**\n- **问题类型**：一维、稳态、均匀平板内的热传导。\n- **边界条件**：狄利克雷条件，$T(0)=T_{0}$ 和 $T(L)=T_{L}$。\n- **材料属性**：恒定导热系数 $k$。\n- **数值方法**：采用二阶中心差分的有限体积离散化。\n- **目标量**：$x=0$ 处的壁面热通量大小，记为 $\\phi$。\n- **网格**：三套均匀网格，分别包含 $N_{3}=32$、$N_{2}=64$ 和 $N_{1}=128$ 个控制体积。\n- **网格尺寸**：$h_{j} = L/N_{j}$。\n- **加密比**：$r_{32} = h_{3}/h_{2} = 2$ 和 $r_{21} = h_{2}/h_{1} = 2$。\n- **计算解**：$\\phi_{3}=1.0160\\times 10^{4}$、$\\phi_{2}=1.0040\\times 10^{4}$ 和 $\\phi_{1}=1.0010\\times 10^{4}$。\n- **观测到的精度阶**：$p_{\\mathrm{obs}}=1.98$。\n- **安全因子**：$F_{s}=1.25$。\n- **任务**：使用 $(1,2)$ 网格对和 $p_{\\mathrm{obs}}$ 计算细网格的网格收敛指数 $\\mathrm{GCI}_{21}$。最终答案必须四舍五入到四位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于计算传热学和流体动力学这一成熟领域。网格收敛指数 (GCI) 是量化离散误差的标准且被广泛接受的方法，正如主要工程期刊（例如，《ASME Journal of Fluids Engineering》）的编辑政策所述。该程序基于 Richardson 外推法，这是一种稳健的数学技术。\n- **良定性**：该问题提供了计算 GCI 唯一值所需的所有数据——三套网格的解、加密比、观测到的精度阶和安全因子。\n- **客观性**：该问题使用数值分析和传热学的精确、标准术语进行陈述，没有主观或模糊的表述。\n\n**第3步：结论与行动**\n该问题是有效的，因为它在科学上是合理的、自洽的且良定的。将提供完整的解答。\n\n**解题推导**\n\n网格收敛指数 (GCI) 的基础是离散误差的建模。对于一个精度阶为 $p$ 的数值格式，在特征尺寸为 $h$ 的网格上得到的解 $\\phi_h$ 可以通过误差的泰勒级数展开表示为：\n$$\n\\phi_h = \\phi_{\\mathrm{exact}} + c h^p + O(h^{p+1})\n$$\n其中 $\\phi_{\\mathrm{exact}}$ 是连续介质方程的精确（未知）解，$c$ 是一个取决于解的高阶导数的常数。\n\n假设网格足够细，处于“渐近区域”内，高阶项 $O(h^{p+1})$ 可以忽略不计，误差由主导项控制：\n$$\n\\phi_h \\approx \\phi_{\\mathrm{exact}} + c h^p\n$$\n\n我们将此模型应用于两套网格：尺寸为 $h_1$ 的细网格（网格1）和尺寸为 $h_2$ 的粗网格（网格2）。网格加密比为 $r_{21} = h_2/h_1$。在这些网格上的解为：\n$$\n\\phi_1 \\approx \\phi_{\\mathrm{exact}} + c h_1^p\n$$\n$$\n\\phi_2 \\approx \\phi_{\\mathrm{exact}} + c h_2^p = \\phi_{\\mathrm{exact}} + c (r_{21} h_1)^p\n$$\n这构成了关于未知数 $\\phi_{\\mathrm{exact}}$ 和 $c$ 的两个代数方程组。我们可以消去 $c$ 来求解 $\\phi_{\\mathrm{exact}}$ 的一个更精确的估计值，即 Richardson 外推解 $\\phi_{\\mathrm{extrap}}^{21}$：\n$$\n\\phi_{\\mathrm{extrap}}^{21} = \\frac{r_{21}^p \\phi_1 - \\phi_2}{r_{21}^p - 1} = \\phi_1 + \\frac{\\phi_1 - \\phi_2}{r_{21}^p - 1}\n$$\n细网格解的估计误差 $E_a^{21}$ 是细网格解与此外推值之差：\n$$\nE_a^{21} = \\phi_{\\mathrm{extrap}}^{21} - \\phi_1 = \\frac{\\phi_1 - \\phi_2}{r_{21}^p - 1}\n$$\nGCI 被定义为细网格解不确定性的度量。它基于估计误差的大小，并按安全因子 $F_s$ 进行缩放，通常表示为相对于细网格解本身的相对量。\n$$\n\\mathrm{GCI}_{21} = F_s \\frac{|E_a^{21}|}{|\\phi_1|} = F_s \\frac{1}{|\\phi_1|} \\left| \\frac{\\phi_1 - \\phi_2}{r_{21}^p - 1} \\right|\n$$\n由于 $r_{21} = 2  1$ 且 $p_{\\mathrm{obs}} = 1.98  0$，项 $r_{21}^p - 1$ 为正。该公式可写为：\n$$\n\\mathrm{GCI}_{21} = \\frac{F_s}{r_{21}^p - 1} \\left| \\frac{\\phi_1 - \\phi_2}{\\phi_1} \\right|\n$$\n\n安全因子 $F_s$ 用于创建一个保守的误差带。其值反映了对外推法所依据的假设的置信度。Richardson 外推法假设数值解处于渐近区域，但这可能不完全成立。$F_s  1$（例如，对于具有表现良好的收敛阶的三套网格研究，$F_s=1.25$）会放大估计误差，以创建一个不确定性区间 $\\phi_1 \\pm (\\mathrm{GCI}_{21} \\cdot \\phi_1)$，该区间很可能（例如，具有 $95\\%$ 的置信度）包含精确解 $\\phi_{\\mathrm{exact}}$。\n\n**计算**\n\n现在我们将给定值代入推导出的 $\\mathrm{GCI}_{21}$ 公式中。\n已知条件如下：\n- 细网格解：$\\phi_1 = 1.0010 \\times 10^4$\n- 粗网格解：$\\phi_2 = 1.0040 \\times 10^4$\n- 加密比：$r_{21} = 2$\n- 观测到的精度阶：$p = p_{\\mathrm{obs}} = 1.98$\n- 安全因子：$F_s = 1.25$\n\n首先，我们计算两个解之间的相对差异：\n$$\n\\left| \\frac{\\phi_1 - \\phi_2}{\\phi_1} \\right| = \\left| \\frac{1.0010 \\times 10^4 - 1.0040 \\times 10^4}{1.0010 \\times 10^4} \\right| = \\left| \\frac{-0.0030 \\times 10^4}{1.0010 \\times 10^4} \\right| = \\frac{0.0030}{1.0010} = \\frac{3}{1001}\n$$\n接下来，我们计算涉及精度阶的分母项：\n$$\nr_{21}^p - 1 = 2^{1.98} - 1\n$$\n现在，将这些值代入 GCI 公式：\n$$\n\\mathrm{GCI}_{21} = \\frac{1.25}{2^{1.98} - 1} \\times \\frac{3}{1001}\n$$\n我们计算其数值：\n$$\n2^{1.98} \\approx 3.944835\n$$\n$$\nr_{21}^p - 1 \\approx 2.944835\n$$\n$$\n\\frac{3}{1001} \\approx 0.002997003\n$$\n$$\n\\mathrm{GCI}_{21} \\approx \\frac{1.25}{2.944835} \\times 0.002997003 \\approx (0.424469) \\times (0.002997003) \\approx 0.00127214\n$$\n题目要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $1$、$2$、$7$ 和 $2$。第五位数字是 $1$，因此我们向下舍入。\n$$\n\\mathrm{GCI}_{21} \\approx 0.001272\n$$\n该值表示细网格解 $\\phi_1$ 的估计不确定度约为 $0.1272\\%$。",
            "answer": "$$\n\\boxed{0.001272}\n$$"
        }
    ]
}