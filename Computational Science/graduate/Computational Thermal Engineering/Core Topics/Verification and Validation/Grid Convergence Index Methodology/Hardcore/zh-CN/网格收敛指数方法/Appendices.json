{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。本节将指导你完成一系列动手练习，旨在加深你对网格收敛指数（GCI）方法的理解和应用。我们将从一个理想化的“教科书式”案例开始，此案例旨在清晰地展示GCI方法论的每一个核心步骤。\n\n    在这个练习中，你将使用三套系统加密的网格数据，计算观测到的收敛阶 $p$、外插得到的渐近解，并最终量化离散不确定度。通过这个练习，你将掌握GCI方法的标准工作流程，并学会如何验证数值解是否已进入渐近收敛区，为后续更复杂的实践打下坚实基础。",
            "id": "3984808",
            "problem": "使用二阶有限体积法模拟了一个围绕加热圆柱体的二维稳态强迫对流基准问题。目标是使用网格收敛指数 (Grid Convergence Index, GCI) 来量化面积平均努塞尔数中的离散误差。该模拟使用双精度算术，非线性迭代的残差范数被减小到 $10^{-12}$ 以下，因此迭代误差和舍入误差相对于离散误差可以忽略不计。采用了三套系统加密的几何相似网格，均匀加密比为 $r_{21} = r_{32} = r = 2$，其特征网格间距分别为 $h_{1} = 0.0125$、$h_{2} = 0.0250$ 和 $h_{3} = 0.0500$。在这些网格上计算出的努塞尔数如下：\n- 细网格：$Nu_{1} = 24.5015625$，\n- 中等网格：$Nu_{2} = 24.50625$，\n- 粗网格：$Nu_{3} = 24.525$。\n\n从以下原理出发：对于应用于足够光滑解的一致离散化方法，依赖于网格的解 $Q(h)$ 的主阶离散误差表现为 $Q(h) = Q_{0} + C h^{p} + \\mathcal{O}(h^{p+1})$。请使用基于泰勒级数误差展开和理查森外推法的三网格方法来：\n1. 确定观测到的精度阶 $p$，\n2. 估计渐近（零网格尺寸）外推努塞尔数 $Nu_{0}$，\n3. 使用 Roache 方法论中的标准安全因子 $F_{s} = 1.25$，以及通过细网格解的量值对近似相对差异进行归一化的常规定义，计算从细网格到中等网格的网格收敛指数 $\\mathrm{GCI}_{21}$，\n4. 通过将比率 $\\displaystyle R = \\frac{\\mathrm{GCI}_{32}}{\\mathrm{GCI}_{21} \\, r^{p}}$ 与 1 进行比较，评估解序列是否处于渐近收敛区域，其中 $\\mathrm{GCI}_{32}$ 是针对中等网格到粗网格对类似定义的。\n\n将细网格的 $\\mathrm{GCI}_{21}$ 报告为一个无量纲小数，并四舍五入到四位有效数字。用文字给出您对渐近区域评估的推理，但最终的数值答案必须仅为所要求的 $\\mathrm{GCI}_{21}$ 值。最终的数值答案中不要包含任何单位或百分号。",
            "solution": "该问题基于以下原理：对于一个足够光滑的问题，依赖于网格的解 $Q(h)$ 的离散误差可以表示为关于特征网格间距 $h$ 的泰勒级数展开。对于一个精度阶为 $p$ 的方法，主阶项在误差中占主导地位，从而得出以下模型：\n$$Q(h) = Q_{0} + C h^{p} + \\mathcal{O}(h^{p+1})$$\n其中 $Q_{0}$ 是精确解（或当 $h \\to 0$ 时的渐近解），$C$ 是一个常数。在本问题中，我们关心的量 $Q$ 是努塞尔数 $Nu$。我们得到了在三个网格间距为 $h_1  h_2  h_3$ 的网格上的解：\n$Nu_{1} = Nu(h_{1}) = 24.5015625$\n$Nu_{2} = Nu(h_{2}) = 24.50625$\n$Nu_{3} = Nu(h_{3}) = 24.525$\n\n网格以常数比率 $r = 2$ 系统加密，使得 $h_2 = r h_1$ 且 $h_3 = r h_2 = r^2 h_1$。给定的网格间距 $h_{1} = 0.0125$、$h_{2} = 0.0250$ 和 $h_{3} = 0.0500$ 与 $r=2$ 一致。\n\n将误差模型应用于我们的三个解，我们得到：\n$$Nu_{1} \\approx Nu_{0} + C h_{1}^{p}$$\n$$Nu_{2} \\approx Nu_{0} + C h_{2}^{p} = Nu_{0} + C (r h_{1})^{p}$$\n$$Nu_{3} \\approx Nu_{0} + C h_{3}^{p} = Nu_{0} + C (r^2 h_{1})^{p}$$\n\n通过执行四个指定的任务来得出解决方案。\n\n1.  **确定观测到的精度阶 $p$**\n\n    我们定义连续网格上解的差异：\n    $\\epsilon_{21} = Nu_{2} - Nu_{1}$\n    $\\epsilon_{32} = Nu_{3} - Nu_{2}$\n    假设误差模型，这些差异的比值为：\n    $$\\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{Nu_3 - Nu_2}{Nu_2 - Nu_1} \\approx \\frac{C(h_3^p - h_2^p)}{C(h_2^p - h_1^p)} = \\frac{C( (rh_2)^p - h_2^p)}{C( (rh_1)^p - h_1^p)} = \\frac{h_2^p(r^p - 1)}{h_1^p(r^p - 1)} = \\left(\\frac{h_2}{h_1}\\right)^p = r^p$$\n    求解 $p$，我们得到：\n    $$p = \\frac{\\ln((\\epsilon_{32}) / (\\epsilon_{21}))}{\\ln(r)} = \\frac{\\ln((Nu_3 - Nu_2) / (Nu_2 - Nu_1))}{\\ln(r)}$$\n    使用所提供的值：\n    $\\epsilon_{21} = 24.50625 - 24.5015625 = 0.0046875$\n    $\\epsilon_{32} = 24.525 - 24.50625 = 0.01875$\n    比值为 $\\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{0.01875}{0.0046875} = 4$。\n    当加密比 $r=2$ 时，观测到的精度阶为：\n    $$p = \\frac{\\ln(4)}{\\ln(2)} = \\frac{\\ln(2^2)}{\\ln(2)} = \\frac{2 \\ln(2)}{\\ln(2)} = 2$$\n    观测到的精度阶恰好为 $2$，这与使用二阶数值方法是一致的。\n\n2.  **估计渐近外推努塞尔数 $Nu_{0}$**\n\n    我们使用基于细网格 ($Nu_1$) 和中等网格 ($Nu_2$) 解的理查森外推法。通过消除主阶误差项来找到外推值 $Nu_{0}$：\n    $$Nu_{0} = \\frac{r^{p} Nu_{1} - Nu_{2}}{r^{p} - 1}$$\n    代入 $p=2$ 和 $r=2$：\n    $$Nu_{0} = \\frac{2^{2} Nu_{1} - Nu_{2}}{2^{2} - 1} = \\frac{4 Nu_{1} - Nu_{2}}{3}$$\n    使用数值：\n    $$Nu_{0} = \\frac{4 (24.5015625) - 24.50625}{3} = \\frac{98.00625 - 24.50625}{3} = \\frac{73.5}{3} = 24.5$$\n    估计的渐近努塞尔数为 $Nu_0 = 24.5$。\n\n3.  **计算从细网格到中等网格的网格收敛指数 $\\mathrm{GCI}_{21}$**\n\n    GCI 提供了离散误差的置信界限。使用细网格和中等网格解，在细网格上 GCI 的标准定义为：\n    $$\\mathrm{GCI}_{21} = F_{s} \\frac{|e_{a}^{21}|}{r^{p} - 1}$$\n    其中 $F_{s}$ 是安全因子，$e_{a}^{21}$ 是细网格和中等网格解之间的近似相对差异，定义为 $e_{a}^{21} = (Nu_1 - Nu_2)/Nu_1$。\n    将所有项代入 GCI 公式：\n    $$\\mathrm{GCI}_{21} = F_s \\frac{\\left|\\frac{Nu_1 - Nu_2}{Nu_1}\\right|}{r^p - 1}$$\n    给定 $F_{s} = 1.25$。我们有 $p=2$ 和 $r=2$，所以 $r^{p}-1 = 3$。\n    $$ \\mathrm{GCI}_{21} = 1.25 \\times \\frac{\\left| \\frac{24.5015625 - 24.50625}{24.5015625} \\right|}{3} = \\frac{1.25}{3} \\left| \\frac{-0.0046875}{24.5015625} \\right| \\approx 0.41666 \\times 0.00019131 \\approx 0.00007971488$$\n    问题要求将此值四舍五入到四位有效数字。\n    $\\mathrm{GCI}_{21} \\approx 0.00007971$。\n\n4.  **评估解是否处于渐近收敛区域**\n\n    为了评估解是否在渐近区域内，我们检查比率 $R$：\n    $$R = \\frac{\\mathrm{GCI}_{32}}{\\mathrm{GCI}_{21} \\, r^{p}}$$\n    其中 $\\mathrm{GCI}_{32}$ 的定义与 $\\mathrm{GCI}_{21}$ 类似，但使用中等和粗网格解：\n    $$\\mathrm{GCI}_{32} = F_s \\frac{\\left|\\frac{Nu_2 - Nu_3}{Nu_2}\\right|}{r^p-1}$$\n    将 GCI 的表达式代入 $R$ 的公式中，公因子 $F_s / (r^p - 1)$ 会被消掉：\n    $$R = \\frac{\\left|\\frac{Nu_2 - Nu_3}{Nu_2}\\right|}{\\left|\\frac{Nu_1 - Nu_2}{Nu_1}\\right| r^p}$$\n    从步骤 1 中我们知道 $Nu_3 - Nu_2 = r^p (Nu_2 - Nu_1)$，因此 $|Nu_2 - Nu_3| = r^p |Nu_1 - Nu_2|$。\n    $$R = \\frac{\\frac{r^p|Nu_1 - Nu_2|}{|Nu_2|}}{\\frac{|Nu_1 - Nu_2|}{|Nu_1|} r^p} = \\frac{|Nu_1|}{|Nu_2|}$$\n    使用给定的值：\n    $$R = \\frac{24.5015625}{24.50625} \\approx 0.9998087$$\n    一个接近 $1$ 的 $R$ 值表明解序列处于渐近收敛区域。我们计算出的 $R \\approx 0.9998$ 非常接近 $1$。这证实了离散误差由其主阶项主导，并根据理论精度阶 $p=2$ 进行缩放，这是处于渐近区域的决定性特征。因此，该解序列可证明处于渐近区域内。\n\n要求的最终答案是 $\\mathrm{GCI}_{21}$ 的数值，四舍五入到四位有效数字。\n$\\mathrm{GCI}_{21} \\approx 0.00007971$。",
            "answer": "$$\\boxed{0.00007971}$$"
        },
        {
            "introduction": "在掌握了理想情况下的标准流程后，我们来探讨一个更贴近真实研究的场景。在实际的计算模拟中，由于网格质量、边界条件处理或问题本身的复杂性，计算出的收敛阶 $p$ 往往不是一个完美的整数。\n\n    本练习提供了一组模拟数据，其计算出的收敛阶偏离了理论预期值。你的任务是执行理查森外推法（Richardson extrapolation）并对结果的可靠性进行评判。这个过程将促使你思考：当观测阶与理论阶不符时，我们对GCI估算的不确定度应持何种态度？这强调了GCI不仅是计算工具，更是一种诊断工具。",
            "id": "3359001",
            "problem": "使用有限体积法模拟二维通道中的稳态、层流、不可压缩流动。从三个系统加密的网格中报告了一个无量纲积分量，记为 $u_h$。连续网格之间的均匀加密比为 $r=1.5$。在粗、中、细三种网格上的离散解分别为 $u_{h_1}=2.0015$，$u_{h_2}=1.9990$ 和 $u_{h_3}=1.9982$，其中 $h_1h_2h_3$ 且 $h_1/h_2=h_2/h_3=r$。假设数值解处于网格收敛的渐近范围内，主导离散误差在这些网格上由单一阶数 $p$ 决定，且舍入误差污染可以忽略不计。\n\n从计算流体动力学中离散误差的第一性原理出发，使用三网格法推导观察到的精度阶数 $p$，然后进行 Richardson 外推以估计渐近（网格无关）值 $u_{\\infty}$。简要评论外推估计的可靠性，涉及跨网格的连续差异的量级及其与均匀加密的一致性，并阐明其与网格收敛指数 (GCI) 概念的联系。将最终外推值 $u_{\\infty}$ 表示为无量纲数，并将答案四舍五入至六位有效数字。",
            "solution": "该问题要求根据在系统加密的网格上获得的三个数值解，确定观察到的精度阶数 $p$，并通过 Richardson 外推估计网格无关解 $u_{\\infty}$。\n\nRichardson 外推和网格收敛性研究的基本前提是，离散误差可以用网格间距 $h$ 的幂级数表示。假设解处于渐近范围，误差由主导项决定，我们可以将网格尺寸为 $h$ 时的数值解 $u_h$ 与精确解（或网格无关解）$u_{\\infty}$ 之间的关系写为：\n$$u_h - u_{\\infty} \\approx C h^p$$\n其中 $C$ 是一个取决于解的高阶导数但与 $h$ 无关的常数，$p$ 是数值方法的理论精度阶数。\n\n我们已知在特征尺寸为 $h_1$、$h_2$ 和 $h_3$ 的三个网格上的解。网格是均匀加密的，因此网格间距通过一个恒定的加密比 $r$ 相关联。我们有 $h_1 > h_2 > h_3$ 且 $h_1 = r h_2$，$h_2 = r h_3$。给定的加密比值为 $r=1.5$。相应的解为 $u_{h_1}=2.0015$，$u_{h_2}=1.9990$ 和 $u_{h_3}=1.9982$。\n\n我们可以为这三个网格分别写出误差方程：\n$$u_{h_1} - u_{\\infty} \\approx C h_1^p \\quad (1)$$\n$$u_{h_2} - u_{\\infty} \\approx C h_2^p \\quad (2)$$\n$$u_{h_3} - u_{\\infty} \\approx C h_3^p \\quad (3)$$\n\n为了确定观察到的精度阶数 $p$，我们可以消去未知常数 $C$ 和 $u_{\\infty}$。我们首先取连续解的差值之比：\n$$\\frac{u_{h_1} - u_{h_2}}{u_{h_2} - u_{h_3}} \\approx \\frac{C(h_1^p - h_2^p)}{C(h_2^p - h_3^p)} = \\frac{C((rh_2)^p - h_2^p)}{C((rh_3)^p - h_3^p)} = \\frac{h_2^p(r^p-1)}{h_3^p(r^p-1)} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$$\n\n这提供了一个基于三个解直接计算观察到的精度阶数 $p$ 的公式：\n$$p = \\frac{\\ln\\left(\\frac{u_{h_1} - u_{h_2}}{u_{h_2} - u_{h_3}}\\right)}{\\ln(r)}$$\n\n代入给定的数值：\n$$u_{h_1} - u_{h_2} = 2.0015 - 1.9990 = 0.0025$$\n$$u_{h_2} - u_{h_3} = 1.9990 - 1.9982 = 0.0008$$\n$$r = 1.5$$\n\n差值的比率为 $\\frac{0.0025}{0.0008} = 3.125$。\n因此，观察到的精度阶数为：\n$$p = \\frac{\\ln(3.125)}{\\ln(1.5)} \\approx \\frac{1.139434}{0.405465} \\approx 2.80999$$\n\n接下来，我们执行 Richardson 外推来估计网格无关值 $u_{\\infty}$。外推通常基于两个最细的网格（本例中为 $h_2$ 和 $h_3$），因为它们被期望更深入地处于渐近范围。我们从方程 (2) 和 (3) 开始，整理后可得外推公式：\n$$u_{\\infty} \\approx \\frac{r^p u_{h_3} - u_{h_2}}{r^p - 1}$$\n为了方便实际计算，这个公式可以重新整理为：\n$$u_{\\infty} \\approx u_{h_3} + \\frac{u_{h_3} - u_{h_2}}{r^p - 1}$$\n我们已经计算了所有必要的项。$r^p$ 的值恰好是我们之前求得的差值比：\n$$r^p = \\frac{u_{h_1} - u_{h_2}}{u_{h_2} - u_{h_3}} = 3.125$$\n细网格和中等网格解之间的差值为 $u_{h_3} - u_{h_2} = 1.9982 - 1.9990 = -0.0008$。\n现在，我们可以计算外推值 $u_{\\infty}$：\n$$u_{\\infty} \\approx 1.9982 + \\frac{-0.0008}{3.125 - 1} = 1.9982 - \\frac{0.0008}{2.125}$$\n$$u_{\\infty} \\approx 1.9982 - 0.000376470588...$$\n$$u_{\\infty} \\approx 1.997823529...$$\n根据要求四舍五入到六位有效数字，我们得到：\n$$u_{\\infty} \\approx 1.99782$$\n\n关于该估计的可靠性，网格收敛指数 (GCI) 方法论提供了一个评估不确定性的框架。一个关键步骤是确定解是否处于渐近范围。收敛的一个先验条件是解随网格加密单调变化，这一点在此处得到了观察，因为 $|u_{h_1}-u_{h_2}| = 0.0025 > |u_{h_2}-u_{h_3}| = 0.0008$。分析的核心是基于单一误差项 $Ch^p$ 占主导地位的假设。通过将观察到的精度阶数 $p$ 与格式的理论阶数进行比较，可以检验此假设的一致性。对于典型的有限体积法，人们可能期望一个整数阶数，如 $p=2$。我们计算出的观察阶数是 $p \\approx 2.81$。这个值与整数相差较远，这可能意味着网格还不够细，尚未进入渐近范围，并且高阶误差项仍然显著。GCI 方法论使用观察到的 $p$ 来估计误差带，但当 $p$ 显著偏离预期的理论阶数时，该误差带的可信度会降低。因此，尽管计算在形式上是正确的，并且与所提供的数据一致，但观察到的阶数与预期整数值的偏差使得外推值的可靠性受到一些质疑。应谨慎对待此估计，因为渐近收敛的基本假设可能未被完全满足。",
            "answer": "$$\\boxed{1.99782}$$"
        },
        {
            "introduction": "最后，我们将挑战一个更具实践性的难题：当数值解呈现振荡收敛时，标准的GCI方法会失效，因为计算收敛阶 $p$ 的公式中会出现负数的对数。然而，这种情况在实际工程模拟中并不少见，尤其是在解包含复杂物理现象或使用高阶格式但网格尚不够密时。\n\n    这个练习引导你思考在这种非理想情况下如何调整策略。你将评估几种处理振荡收敛的修正方法，学会如何保守地估计离散误差。此练习的核心在于培养严谨的工程判断力，即在理论模型的基本假设被破坏时，如何运用GCI的精神——保守性和可靠性——来量化不确定度。",
            "id": "3958788",
            "problem": "一项稳态热传输计算报告了在三个具有均匀加密比 $r_{21}=r_{32}=2$ 的系统性加密网格上的一个具有工程意义的标量输出，记为 $\\phi$。网格编号规则为：网格 $1$ 为最密网格，网格 $2$ 为中等网格，网格 $3$ 为最粗网格。报告的值为 $\\phi_{1}=10.4$，$\\phi_{2}=9.8$ 和 $\\phi_{3}=10.1$。定义连续差分 $\\epsilon_{21}=\\phi_{1}-\\phi_{2}$ 和 $\\epsilon_{32}=\\phi_{2}-\\phi_{3}$。乘积 $\\epsilon_{21}\\epsilon_{32}  0$，表明离散序列存在振荡收敛。\n\n仅使用以下基本原则：对于一致性方法，其渐近离散误差与网格间距的幂成比例，幂次为观测阶数 $p$；连续加密网格解之间的差分比反映了该比例关系；网格收敛指数 (GCI) 是一个根据观测阶数、加密比和安全因子构建的、用于评估两个网格间相对离散不确定度的保守无量纲估计值。请选择一个最佳选项，该选项为振荡收敛情况提出一种修正方法来估计观测阶数 $p$，并随后计算网格 $2$ 和网格 $1$ 之间的一个保守的两网格网格收敛指数 (GCI)。\n\nA. 对于振荡收敛，从连续差分的量值比来估计观测阶数，并使用较大的安全因子以保证保守性：取 $p^{*}=\\dfrac{\\ln\\!\\left(\\left|\\epsilon_{32}/\\epsilon_{21}\\right|\\right)}{\\ln(r_{21})}$ 且 $F_{s}=3.0$。当 $r_{21}=2$，$\\epsilon_{21}=0.6$ 和 $\\epsilon_{32}=-0.3$ 时，得到 $p^{*}=1.00$ 和 $\\mathrm{GCI}_{21}=\\dfrac{F_{s}\\left|\\epsilon_{21}\\right|}{\\left|\\phi_{1}\\right|\\left(r_{21}^{p^{*}}-1\\right)}=0.173$。\n\nB. 对于振荡收敛，使用与选项 A 中相同的基于量值的观测阶数，但保持用于单调收敛的常规安全因子：$F_{s}=1.25$。当 $p^{*}=1.00$ 时，得出 $\\mathrm{GCI}_{21}=0.072$。\n\nC. 假设尽管存在振荡，名义格式阶数仍起主导作用，设置 $p=2.00$，保留一个保守的安全因子 $F_{s}=3.0$，并计算 $\\mathrm{GCI}_{21}=\\dfrac{F_{s}\\left|\\epsilon_{21}\\right|}{\\left|\\phi_{1}\\right|\\left(r_{21}^{p}-1\\right)}=0.058$。\n\nD. 放弃阶数估计，转而对两个差分的量值取平均以代表误差尺度，并使用一个保守的安全因子：$\\mathrm{GCI}_{21}=\\dfrac{3.0\\left(\\left|\\epsilon_{21}\\right|+\\left|\\epsilon_{32}\\right|\\right)}{2\\left|\\phi_{1}\\right|}=0.130$。",
            "solution": "对于振荡收敛（$\\epsilon_{21}\\epsilon_{32}  0$），标准的收敛阶计算公式 $p = \\ln(\\epsilon_{32}/\\epsilon_{21})/\\ln(r)$ 失效，因为需要对负数取对数。这表明解未进入理想的渐近收敛区，需要采用修正的、更为保守的方法来估计不确定度。\n\n我们来分析各个选项：\n- **选项 A**: 提议使用差分绝对值的比率来估算一个有效的收敛阶 $p^*$，并配合一个较大的安全系数 $F_s=3.0$。这是一个合理的工程实践，旨在处理非理想收敛。首先，我们计算 $p^*$。注意选项中给出的公式有误，应使用比值大于1的形式以得到正阶数：$p^* = \\frac{\\ln(|\\epsilon_{21}/\\epsilon_{32}|)}{\\ln(r)} = \\frac{\\ln(|0.6/-0.3|)}{\\ln(2)} = \\frac{\\ln(2)}{\\ln(2)} = 1$。然后，配合保守的 $F_s=3.0$ 计算GCI：$\\mathrm{GCI}_{21} = \\frac{F_s |\\epsilon_{21}|}{|\\phi_1|(r^{p^*}-1)} = \\frac{3.0 \\times 0.6}{10.4 \\times (2^1-1)} = \\frac{1.8}{10.4} \\approx 0.173$。该方法在承认数据非理想性的同时，给出了一个保守的误差估计。\n- **选项 B**: 使用了与单调收敛情况相同的安全系数 $F_s=1.25$。对于振荡收敛这种非理想情况，这是不够保守的，因此该方法存在风险。\n- **选项 C**: 忽略了从数据中观察到的收敛行为（有效阶数 $p^* \\approx 1$），而是直接采用理论阶数 $p=2$。这会导致分母 $(r^p-1)$ 变大，从而显著低估不确定度（GCI值变小），这与保守原则相悖。\n- **选项 D**: 采用了一种特设的（ad-hoc）平均方法，完全脱离了理查森外推法的理论基础。虽然其结果可能保守，但其方法论的严谨性不如选项 A。\n\n综上所述，选项 A 提出的方法在尊重观测数据和保持保守性之间取得了最佳平衡，是处理振荡收敛最推荐的工程方法。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}