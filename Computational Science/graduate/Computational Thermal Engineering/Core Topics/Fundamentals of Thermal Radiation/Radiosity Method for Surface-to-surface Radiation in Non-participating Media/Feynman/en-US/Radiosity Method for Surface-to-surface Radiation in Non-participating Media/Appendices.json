{
    "hands_on_practices": [
        {
            "introduction": "Mastering the radiosity method starts with a solid grasp of its foundational principles: the summation rule, which arises from energy conservation, and the reciprocity relation. This first practice invites you to derive view factors for a classic two-surface enclosure—infinitely long concentric cylinders—using only these first principles. By reasoning through the geometry and applying these rules, you will solidify your understanding of how radiation is distributed in a simple, fully enclosed system .",
            "id": "3981152",
            "problem": "Consider two infinitely long concentric circular cylinders in a non-participating medium, with the smaller cylinder of radius $r_1$ located inside a larger cylinder of inner radius $r_2$, where $0 < r_1 < r_2$. Let the cylinders have common length $L$ and be perfectly coaxial, and neglect end effects by taking the limit $L \\to \\infty$ so that only the lateral surfaces contribute to radiation exchange. Let surface $1$ be the outer lateral surface of the inner cylinder (area $A_1$), and let surface $2$ be the inner lateral surface of the outer cylinder (area $A_2$). Assume both surfaces are opaque, diffuse-gray, isothermal emitters, and the space between them is vacuum (non-participating medium without scattering or absorption).\n\nStarting from the definition of the radiative view factor $F_{ij}$ as the fraction of total hemispherical diffuse emission from surface $i$ intercepted by surface $j$, as given by the double-area integral over the two surfaces weighted by the Lambert cosine factors and the inverse-square of separation (with no line-of-sight obstruction), and from conservation of energy principles that imply the reciprocity property and the summation rule for view factors, derive $F_{12}$ for this geometry. Then, by enforcing the reciprocity relation, express $F_{21}$ in terms of $r_1$ and $r_2$ and confirm the consistency condition $A_1 F_{12} = A_2 F_{21}$ using the lateral areas $A_1 = 2\\pi r_1 L$ and $A_2 = 2\\pi r_2 L$.\n\nReport the final answer for $F_{12}$ as a single dimensionless real number. No rounding is required. Express any intermediate symbolic relations in terms of $r_1$, $r_2$, and $L$.",
            "solution": "The problem requires the derivation of the view factor $F_{12}$ between two infinitely long, concentric circular cylinders and the subsequent derivation of $F_{21}$ using the reciprocity relation.\n\nFirst, we must validate the problem statement.\nAll data, variables, and conditions are extracted as follows:\n- Geometry: Two infinitely long concentric circular cylinders.\n- Inner cylinder radius: $r_1$.\n- Outer cylinder inner radius: $r_2$.\n- Constraint: $0 < r_1 < r_2$.\n- Common length: $L$, with the limit $L \\to \\infty$ to neglect end effects.\n- Surface $1$: Outer lateral surface of the inner cylinder, Area $A_1 = 2\\pi r_1 L$.\n- Surface $2$: Inner lateral surface of the outer cylinder, Area $A_2 = 2\\pi r_2 L$.\n- Surface properties: Opaque, diffuse-gray, isothermal.\n- Medium: Vacuum (non-participating).\n- Principles to be used: The definition of the view factor $F_{ij}$, the reciprocity property ($A_i F_{ij} = A_j F_{ji}$), and the summation rule for an enclosure ($\\sum_j F_{ij} = 1$).\n- Task: Derive $F_{12}$, then use reciprocity to find $F_{21}$ and confirm consistency. Report the numerical value of $F_{12}$.\n\nThe problem is scientifically grounded, as it deals with standard concepts in radiative heat transfer. It is well-posed, with a clearly defined geometry and sufficient assumptions to lead to a unique solution. The language is objective and precise. The problem is self-contained and free of contradictions. The idealization of infinite length is a standard and valid simplification in engineering analysis. Therefore, the problem is deemed valid and a solution will be provided.\n\nLet surface $1$ be the outer surface of the inner cylinder and surface $2$ be the inner surface of the outer cylinder. Since the cylinders are infinitely long, they form a two-surface enclosure. The summation rule for view factors, which is a statement of energy conservation for diffuse emitters, states that for any surface $i$ in an enclosure, the sum of the view factors from surface $i$ to all other surfaces $j$ in the enclosure (including itself) must be unity.\n$$\n\\sum_{j=1}^{N} F_{ij} = 1\n$$\nwhere $N$ is the number of surfaces in the enclosure. In this case, $N=2$.\n\nWe first apply the summation rule to surface $1$. The radiation emitted from surface $1$ can be intercepted by surface $1$ itself (with view factor $F_{11}$) or by surface $2$ (with view factor $F_{12}$). Thus, the summation rule for surface $1$ is:\n$$\nF_{11} + F_{12} = 1\n$$\nSurface $1$ is the outer surface of a cylinder, which is a convex surface. By definition, a convex surface cannot \"see\" itself. Any straight line (representing a ray of radiation) originating from a point on a convex surface and extending outwards cannot intersect the surface at any other point. Consequently, the fraction of radiation leaving surface $1$ that is intercepted by surface $1$ is zero. Therefore, the view factor from a convex surface to itself is always zero.\n$$\nF_{11} = 0\n$$\nSubstituting this into the summation rule for surface $1$:\n$$\n0 + F_{12} = 1\n$$\nThis gives the result for the first view factor:\n$$\nF_{12} = 1\n$$\nThis result is physically intuitive: since the inner cylinder is completely enclosed by the outer cylinder and is convex, all radiation emitted from its outer surface must inevitably be intercepted by the inner surface of the outer cylinder.\n\nNext, we are asked to find $F_{21}$ by enforcing the reciprocity relation. The reciprocity theorem for view factors states that for any two surfaces $i$ and $j$:\n$$\nA_i F_{ij} = A_j F_{ji}\n$$\nApplying this to surfaces $1$ and $2$:\n$$\nA_1 F_{12} = A_2 F_{21}\n$$\nWe can solve for $F_{21}$:\n$$\nF_{21} = F_{12} \\frac{A_1}{A_2}\n$$\nThe lateral surface areas are given as $A_1 = 2\\pi r_1 L$ and $A_2 = 2\\pi r_2 L$. Substituting these expressions and the value of $F_{12} = 1$ into the equation for $F_{21}$:\n$$\nF_{21} = (1) \\frac{2\\pi r_1 L}{2\\pi r_2 L} = \\frac{r_1}{r_2}\n$$\nThis expresses $F_{21}$ in terms of the radii $r_1$ and $r_2$, as requested. This result also makes physical sense: it is the fraction of radiation from the outer cylinder's inner surface that strikes the inner cylinder. This fraction is the ratio of their radii (or, equivalently, their perimeters or surface areas per unit length).\n\nFinally, we confirm the consistency condition $A_1 F_{12} = A_2 F_{21}$.\nCalculating the left-hand side (LHS):\n$$\n\\text{LHS} = A_1 F_{12} = (2\\pi r_1 L)(1) = 2\\pi r_1 L\n$$\nCalculating the right-hand side (RHS):\n$$\n\\text{RHS} = A_2 F_{21} = (2\\pi r_2 L) \\left( \\frac{r_1}{r_2} \\right) = 2\\pi r_1 L\n$$\nSince LHS = RHS ($2\\pi r_1 L = 2\\pi r_1 L$), the reciprocity relation is internally consistent with the derived view factors.\n\nAs a further check, we can apply the summation rule to surface $2$. Surface $2$ is concave and can see both surface $1$ ($F_{21}$) and itself ($F_{22}$).\n$$\nF_{21} + F_{22} = 1\n$$\nUsing our derived value for $F_{21}$:\n$$\nF_{22} = 1 - F_{21} = 1 - \\frac{r_1}{r_2}\n$$\nThis is the fraction of radiation leaving the inner surface of the outer cylinder that strikes another part of the inner surface of the outer cylinder. This result is physically sound.\n\nThe problem asks for the final answer for $F_{12}$ as a single dimensionless real number. As derived above, this value is $1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "Real-world engineering systems rarely consist of simple, complete enclosures; often, surfaces partially obstruct the view between others, creating more complex radiative pathways. This exercise advances your skills by introducing an obstruction in the form of an apertured spherical shell between two other concentric spheres. This scenario challenges you to apply view factor algebra to determine how the presence of a partial barrier redistributes radiative energy, a crucial skill for analyzing more complex and realistic geometries .",
            "id": "3981137",
            "problem": "A diffuse-gray, isothermal three-surface enclosure in a non-participating medium is constructed as follows. Surface $1$ is a perfectly diffuse, opaque sphere of radius $R_1$ centered at the origin. Surface $2$ is a perfectly diffuse, opaque, infinitesimally thin concentric spherical shell of radius $R_2$ that completely surrounds surface $1$, except that it has a circular aperture centered on the positive $z$-axis; the aperture is a spherical cap on the $R_2$ sphere subtending a half-angle $\\theta_0$ at the center. Surface $3$ is a perfectly diffuse, opaque, infinitesimally thin concentric spherical shell of radius $R_3$ that completely surrounds surface $2$. The medium between surfaces is vacuum and thus non-participating. All surfaces are black for simplicity (unit emissivity), but you are to work only with view factors (geometric configuration factors). The aperture in surface $2$ is the sole line-of-sight opening between surfaces $1$ and $3$; surface $2$ is otherwise fully blocking.\n\nStarting only from the definition of the view factor, conservation of energy, and the reciprocity relation, determine how the presence of the aperture in surface $2$ redistributes view factors and compute the obstructed view factors $F_{13}$ and $F_{31}$.\n\nUse the numerical data $R_1 = 0.40\\,\\mathrm{m}$, $R_2 = 0.80\\,\\mathrm{m}$, $R_3 = 1.20\\,\\mathrm{m}$, and $\\theta_0 = 60^\\circ$ (angles in degrees). In addition to computing $F_{13}$ and $F_{31}$, explicitly demonstrate the summation rule for surface $1$ by expressing $F_{12}$ in terms of $F_{13}$ and verifying $F_{11} + F_{12} + F_{13} = 1$.\n\nReport your final answer as the ordered pair $\\left(F_{13}, F_{31}\\right)$, rounded to four significant figures. Express the final answer as a dimensionless quantity.",
            "solution": "The user wants to solve a view factor problem in radiative heat transfer.\n\n### Step 1: Extract Givens\n- **Geometry**: A three-surface enclosure in a non-participating medium (vacuum).\n- **Surface 1**: A perfectly diffuse, opaque sphere of radius $R_1$ centered at the origin.\n- **Surface 2**: A perfectly diffuse, opaque, infinitesimally thin concentric spherical shell of radius $R_2$. It has a circular aperture centered on the positive $z$-axis, defined by a spherical cap subtending a half-angle $\\theta_0$ at the center.\n- **Surface 3**: A perfectly diffuse, opaque, infinitesimally thin concentric spherical shell of radius $R_3$ that completely surrounds surface $2$.\n- **Radiative Properties**: All surfaces are treated as black (emissivity $\\epsilon=1$) for simplicity, but the analysis is restricted to geometric view factors.\n- **Relationships**: $R_1 < R_2 < R_3$. The aperture in surface $2$ is the only path for radiation between surfaces $1$ and $3$.\n- **Numerical Data**: $R_1 = 0.40\\,\\mathrm{m}$, $R_2 = 0.80\\,\\mathrm{m}$, $R_3 = 1.20\\,\\mathrm{m}$, and $\\theta_0 = 60^\\circ$.\n- **Tasks**:\n    1. Compute the obstructed view factors $F_{13}$ and $F_{31}$.\n    2. Demonstrate the summation rule for surface $1$ by expressing $F_{12}$ in terms of $F_{13}$ and verifying $F_{11} + F_{12} + F_{13} = 1$.\n    3. Report the final answer as the ordered pair $(F_{13}, F_{31})$ rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a classical problem in radiative heat transfer. The geometry is clearly defined, and all necessary parameters are provided. The concepts of view factors, the summation rule, and the reciprocity relation are fundamental principles in this field. There are no contradictions, ambiguities, or physically impossible conditions. The problem is a standard exercise in applying view factor algebra to an enclosure with an obstruction.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution Derivation\n\nThe analysis will proceed by first calculating the view factor $F_{13}$, then verifying the summation rule for surface $1$, and finally calculating $F_{31}$ using the reciprocity relation.\n\n**1. Calculation of View Factor $F_{13}$**\n\nThe view factor $F_{13}$ represents the fraction of radiative energy leaving surface $1$ that directly strikes surface $3$. Due to the geometry, surface $2$ is an opaque obstruction between surfaces $1$ and $3$. Radiation can only travel from surface $1$ to surface $3$ by passing through the aperture on surface $2$. Let us denote this aperture as a hypothetical surface $A$. Thus, the view factor from surface $1$ to surface $3$ is equivalent to the view factor from surface $1$ to the aperture $A$.\n$$F_{13} = F_{1A}$$\nA fundamental property of diffuse radiation exchange between two concentric spheres is that the irradiation from the inner sphere onto the outer sphere is uniform over the entire surface of the outer sphere. This is a direct consequence of the spherical symmetry. Therefore, the fraction of energy from the inner sphere ($1$) that is intercepted by any portion of the concentric spherical shell (at radius $R_2$) is simply the ratio of the area of that portion to the total area of the shell.\nThe aperture $A$ is a spherical cap on the sphere of radius $R_2$. The view factor $F_{1A}$ is thus the ratio of the aperture's area, $A_A$, to the total surface area of a complete sphere of radius $R_2$, which we denote as $A_{2,total}$.\n$$F_{13} = F_{1A} = \\frac{A_A}{A_{2,total}}$$\nThe surface area of a spherical cap is given by the formula $A_{cap} = 2\\pi R^2 (1 - \\cos\\alpha)$, where $R$ is the radius of the sphere and $\\alpha$ is the half-angle subtended by the cap. In our case, $R = R_2$ and $\\alpha = \\theta_0$.\n$$A_A = 2\\pi R_2^2 (1 - \\cos\\theta_0)$$\nThe total surface area of the sphere of radius $R_2$ is:\n$$A_{2,total} = 4\\pi R_2^2$$\nSubstituting these into the expression for $F_{13}$:\n$$F_{13} = \\frac{2\\pi R_2^2 (1 - \\cos\\theta_0)}{4\\pi R_2^2} = \\frac{1 - \\cos\\theta_0}{2}$$\nNote that this result is independent of the radii $R_1$ and $R_2$. Using the given value $\\theta_0 = 60^\\circ$:\n$$\\cos\\theta_0 = \\cos(60^\\circ) = \\frac{1}{2} = 0.5$$\n$$F_{13} = \\frac{1 - 0.5}{2} = \\frac{0.5}{2} = 0.25$$\n\n**2. Verification of the Summation Rule for Surface 1**\n\nThe summation rule for any surface $i$ in an $N$-surface enclosure states that $\\sum_{j=1}^{N} F_{ij} = 1$. For surface $1$ in our three-surface enclosure, this is:\n$$F_{11} + F_{12} + F_{13} = 1$$\nSurface $1$ is a sphere, which is a convex surface. A convex surface cannot \"see\" itself. Therefore, the view factor from surface $1$ to itself is zero.\n$$F_{11} = 0$$\nThe summation rule simplifies to:\n$$F_{12} + F_{13} = 1$$\nThis expresses the conservation of energy for radiation leaving surface $1$: it must be intercepted by either surface $2$ or surface $3$.\nThe problem requires expressing $F_{12}$ in terms of $F_{13}$. From the simplified summation rule, we have:\n$$F_{12} = 1 - F_{13}$$\nUsing the calculated value $F_{13} = 0.25$:\n$$F_{12} = 1 - 0.25 = 0.75$$\nTo explicitly verify the summation rule, we can calculate $F_{12}$ independently. $F_{12}$ is the fraction of radiation from surface $1$ that strikes surface $2$. This is the portion of the sphere at radius $R_2$ that is *not* the aperture.\n$$F_{12} = \\frac{A_2}{A_{2,total}} = \\frac{A_{2,total} - A_A}{A_{2,total}} = 1 - \\frac{A_A}{A_{2,total}} = 1 - F_{13}$$\nThis confirms our previous reasoning. Using the angle $\\theta_0$:\n$$F_{12} = 1 - \\frac{1 - \\cos\\theta_0}{2} = \\frac{2 - (1 - \\cos\\theta_0)}{2} = \\frac{1 + \\cos\\theta_0}{2}$$\nFor $\\theta_0 = 60^\\circ$:\n$$F_{12} = \\frac{1 + 0.5}{2} = \\frac{1.5}{2} = 0.75$$\nNow, we verify the summation rule with the calculated values:\n$$F_{11} + F_{12} + F_{13} = 0 + 0.75 + 0.25 = 1.00$$\nThe summation rule is satisfied, confirming the correctness of our calculation for $F_{13}$.\n\n**3. Calculation of View Factor $F_{31}$**\n\nTo find the view factor $F_{31}$, we use the reciprocity relation, which for surfaces $1$ and $3$ is:\n$$A_1 F_{13} = A_3 F_{31}$$\nwhere $A_1$ and $A_3$ are the areas of surfaces $1$ and $3$, respectively.\nThe area of surface $1$ (a sphere of radius $R_1$) is:\n$$A_1 = 4\\pi R_1^2$$\nThe area of surface $3$ (the inner surface of a sphere of radius $R_3$) is:\n$$A_3 = 4\\pi R_3^2$$\nRearranging the reciprocity relation to solve for $F_{31}$:\n$$F_{31} = F_{13} \\frac{A_1}{A_3} = F_{13} \\frac{4\\pi R_1^2}{4\\pi R_3^2} = F_{13} \\left(\\frac{R_1}{R_3}\\right)^2$$\nNow, we substitute the known numerical values: $F_{13} = 0.25$, $R_1 = 0.40\\,\\mathrm{m}$, and $R_3 = 1.20\\,\\mathrm{m}$.\n$$F_{31} = 0.25 \\times \\left(\\frac{0.40}{1.20}\\right)^2 = 0.25 \\times \\left(\\frac{1}{3}\\right)^2 = 0.25 \\times \\frac{1}{9} = \\frac{1}{4} \\times \\frac{1}{9} = \\frac{1}{36}$$\nConverting this fraction to a decimal:\n$$F_{31} = \\frac{1}{36} \\approx 0.027777...$$\n\n**4. Final Answer Formulation**\n\nThe problem asks for the ordered pair $(F_{13}, F_{31})$, with values rounded to four significant figures.\n- $F_{13} = 0.25$. To four significant figures, this is $0.2500$.\n- $F_{31} \\approx 0.027777...$. To four significant figures, this is $0.02778$.\n\nThe final answer is the ordered pair $(0.2500, 0.02778)$.",
            "answer": "$$\n\\boxed{(0.2500, 0.02778)}\n$$"
        },
        {
            "introduction": "The true power of the radiosity method is realized when it is applied to solve for unknown temperatures and heat fluxes in coupled, multi-mode heat transfer problems, which often leads to systems of nonlinear equations. This final capstone practice transitions from analytical derivations to computational implementation, guiding you through the development of a numerical solver for an enclosure where radiation is coupled with convection. By formulating and solving the nonlinear energy balance equations, you will bridge the gap between theoretical concepts and the practical, computational tools essential to modern thermal engineering .",
            "id": "3981134",
            "problem": "Consider an enclosure comprised of a finite set of opaque, diffuse-gray surfaces exchanging thermal radiation in a non-participating medium. Each surface is also subject to external convection to a prescribed ambient temperature. The enclosure is closed and the surfaces have no transmissivity. The unknown surface temperatures appear nonlinearly through the blackbody emissive power. You must derive, implement, and solve a nonlinear system for the surface temperatures by constructing a Newton iteration or a fixed-point iteration, starting from first principles.\n\nFundamental starting point:\n- Stefan–Boltzmann law for blackbody emissive power: $E_b = \\sigma T^4$, where $\\sigma$ is the Stefan–Boltzmann constant and $T$ is the absolute temperature.\n- For a diffuse-gray, opaque surface $i$, define the radiosity $J_i$ as the total energy leaving the surface per unit area per unit time due to thermal radiation, and the irradiation $G_i$ as the total energy arriving at the surface per unit area per unit time due to thermal radiation. Assume diffuse reflection with reflectivity $1 - \\varepsilon_i$, where $\\varepsilon_i$ is the emissivity.\n- Define configuration (view) factors $F_{ij}$, which satisfy reciprocity $A_i F_{ij} = A_j F_{ji}$ and summation $\\sum_j F_{ij} = 1$ for a closed enclosure without self-view ($F_{ii} = 0$).\n- Convection to a quiescent ambient is modeled by a Newtonian cooling law with coefficient $h_i$ and ambient temperature $T_{\\infty,i}$.\n\nTasks:\n1. Using the fundamental definitions above, formally define the radiosity and irradiation for each surface $i$ in terms of the unknown temperatures, emissivities, and configuration factors. Use these to construct a set of equations that relate the radiosities to the temperatures for a given enclosure.\n2. Write an energy balance for each surface $i$ equating the supplied heat generation per unit area $q_{i}^{\\text{gen}}$ to the sum of the convective heat loss and the net radiative loss. Express the net radiative heat loss in terms of the radiosity and irradiation, as implied by the physical definitions.\n3. Derive a residual function $\\mathbf{R}(\\mathbf{T})$ whose root corresponds to the temperatures that satisfy the energy balances. Construct either:\n   - A Newton iteration for $\\mathbf{T}$ that requires the Jacobian $\\partial \\mathbf{R}/\\partial \\mathbf{T}$, or\n   - A fixed-point iteration for $\\mathbf{T}$ justified by the physical relationships.\n   In either case, specify stopping criteria based on mathematically well-defined norms of the residual and the update. The criteria must be expressed in terms of absolute tolerances on the residual (in $\\mathrm{W/m^2}$) and temperature change (in $\\mathrm{K}$). Explicitly describe the convergence criteria to be used by your program.\n4. Implement your chosen iteration entirely in code. The iteration must be robust to ill-conditioning that arises from low emissivity or strong coupling, and must ensure temperatures remain physically admissible (strictly positive absolute temperature).\n\nConstants and units:\n- Use $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$.\n- All temperatures must be computed and reported in $\\mathrm{K}$.\n- Heat generation $q_{i}^{\\text{gen}}$ is in $\\mathrm{W/m^2}$.\n- Convection coefficients $h_i$ are in $\\mathrm{W/(m^2\\cdot K)}$.\n- Configuration factors $F_{ij}$ are dimensionless.\n\nTest suite:\nImplement your solver for the following four test cases. Each case is specified by the number of surfaces $N$, areas $\\{A_i\\}$, emissivities $\\{\\varepsilon_i\\}$, convection coefficients $\\{h_i\\}$, ambient temperatures $\\{T_{\\infty,i}\\}$, heat generation per area $\\{q_{i}^{\\text{gen}}\\}$, and the configuration factor matrix $F$.\n\n- Case $1$ (two facing plates with one heated):\n  - $N = 2$\n  - Areas: $A_1 = 1.0\\ \\mathrm{m^2}$, $A_2 = 1.0\\ \\mathrm{m^2}$\n  - Emissivities: $\\varepsilon_1 = 0.9$, $\\varepsilon_2 = 0.7$\n  - Convection coefficients: $h_1 = 10.0\\ \\mathrm{W/(m^2\\cdot K)}$, $h_2 = 5.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - Ambient temperatures: $T_{\\infty,1} = 300.0\\ \\mathrm{K}$, $T_{\\infty,2} = 300.0\\ \\mathrm{K}$\n  - Heat generation: $q_{1}^{\\text{gen}} = 1000.0\\ \\mathrm{W/m^2}$, $q_{2}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - Configuration factors: $$F = \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}$$\n\n- Case $2$ (three surfaces with asymmetric areas and coupling):\n  - $N = 3$\n  - Areas: $A_1 = 1.0\\ \\mathrm{m^2}$, $A_2 = 2.0\\ \\mathrm{m^2}$, $A_3 = 1.0\\ \\mathrm{m^2}$\n  - Emissivities: $\\varepsilon_1 = 0.85$, $\\varepsilon_2 = 0.6$, $\\varepsilon_3 = 0.9$\n  - Convection coefficients: $h_1 = 15.0\\ \\mathrm{W/(m^2\\cdot K)}$, $h_2 = 8.0\\ \\mathrm{W/(m^2\\cdot K)}$, $h_3 = 20.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - Ambient temperatures: $T_{\\infty,1} = 300.0\\ \\mathrm{K}$, $T_{\\infty,2} = 300.0\\ \\mathrm{K}$, $T_{\\infty,3} = 300.0\\ \\mathrm{K}$\n  - Heat generation: $q_{1}^{\\text{gen}} = 500.0\\ \\mathrm{W/m^2}$, $q_{2}^{\\text{gen}} = 200.0\\ \\mathrm{W/m^2}$, $q_{3}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - Configuration factors:\n    $$F = \\begin{bmatrix}\n    0 & 1 & 0 \\\\\n    0.5 & 0 & 0.5 \\\\\n    0 & 1 & 0\n    \\end{bmatrix}$$\n    which obeys reciprocity $A_1 F_{12} = A_2 F_{21}$, $A_1 F_{13} = A_3 F_{31}$, $A_2 F_{23} = A_3 F_{32}$ and row-wise summation.\n\n- Case $3$ (two facing plates with very low emissivity and strong heating):\n  - $N = 2$\n  - Areas: $A_1 = 1.0\\ \\mathrm{m^2}$, $A_2 = 1.0\\ \\mathrm{m^2}$\n  - Emissivities: $\\varepsilon_1 = 0.05$, $\\varepsilon_2 = 0.05$\n  - Convection coefficients: $h_1 = 2.0\\ \\mathrm{W/(m^2\\cdot K)}$, $h_2 = 2.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - Ambient temperatures: $T_{\\infty,1} = 300.0\\ \\mathrm{K}$, $T_{\\infty,2} = 300.0\\ \\mathrm{K}$\n  - Heat generation: $q_{1}^{\\text{gen}} = 2000.0\\ \\mathrm{W/m^2}$, $q_{2}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - Configuration factors: $$F = \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}$$\n\n- Case $4$ (two facing plates, no heating; boundary check):\n  - $N = 2$\n  - Areas: $A_1 = 1.0\\ \\mathrm{m^2}$, $A_2 = 1.0\\ \\mathrm{m^2}$\n  - Emissivities: $\\varepsilon_1 = 0.8$, $\\varepsilon_2 = 0.8$\n  - Convection coefficients: $h_1 = 10.0\\ \\mathrm{W/(m^2\\cdot K)}$, $h_2 = 10.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - Ambient temperatures: $T_{\\infty,1} = 300.0\\ \\mathrm{K}$, $T_{\\infty,2} = 300.0\\ \\mathrm{K}$\n  - Heat generation: $q_{1}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$, $q_{2}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - Configuration factors: $$F = \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}$$\n\nOutput requirements:\n- Implement the iteration with absolute convergence tolerances of $10^{-6}\\ \\mathrm{W/m^2}$ for the residual infinity norm and $10^{-9}\\ \\mathrm{K}$ for the temperature update infinity norm.\n- For each case, compute the converged temperatures $\\{T_i\\}$ in $\\mathrm{K}$, rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list of temperatures for a case, e.g., \"[[T_case1_surface1,T_case1_surface2], [T_case2_surface1,...], ...]\". The temperatures must be in $\\mathrm{K}$ and rounded to three decimal places as specified.",
            "solution": "The problem requires the derivation and implementation of a numerical solver for the steady-state surface temperatures in a radiative enclosure with external convection. The solution is obtained by formulating a system of nonlinear energy balance equations and solving it using Newton's method.\n\n### Step 1: Derivation of the Governing Equations\n\nThe analysis begins from the fundamental principles of radiative heat transfer for an enclosure of $N$ opaque, diffuse-gray surfaces in a non-participating medium.\n\n**1. Radiosity and Irradiation**\nFor each surface $i$, the radiosity, $J_i$, is the total radiative energy leaving the surface per unit area. It is the sum of emitted and reflected radiation:\n$$J_i = \\varepsilon_i E_{b,i} + \\rho_i G_i$$\nwhere $\\varepsilon_i$ is the emissivity, $E_{b,i} = \\sigma T_i^4$ is the blackbody emissive power at absolute temperature $T_i$, $\\rho_i$ is the reflectivity, and $G_i$ is the irradiation (incident radiative energy per unit area). For an opaque surface, $\\rho_i = 1 - \\varepsilon_i$. Thus,\n$$J_i = \\varepsilon_i \\sigma T_i^4 + (1 - \\varepsilon_i) G_i$$\n\nThe irradiation on surface $i$, $G_i$, is the sum of radiative energy arriving from all other surfaces $j$ in the enclosure.\n$$A_i G_i = \\sum_{j=1}^{N} J_j A_j F_{ji}$$\nUsing the reciprocity relation $A_j F_{ji} = A_i F_{ij}$, we can write the irradiation per unit area of surface $i$ as:\n$$G_i = \\sum_{j=1}^{N} F_{ij} J_j$$\n\n**2. Radiosity System in Terms of Temperature**\nSubstituting the expression for $G_i$ into the equation for $J_i$ yields a system of $N$ linear equations for the radiosities $J_i$, assuming temperatures $T_i$ are known:\n$$J_i = \\varepsilon_i \\sigma T_i^4 + (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j$$\nThis can be rearranged as:\n$$J_i - (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j = \\varepsilon_i \\sigma T_i^4$$\n\nIn matrix-vector notation, this system becomes:\n$$(\\mathbf{I} - \\mathrm{diag}(1-\\boldsymbol{\\varepsilon})\\mathbf{F}) \\mathbf{J} = \\mathrm{diag}(\\boldsymbol{\\varepsilon}) \\mathbf{E_b}(\\mathbf{T})$$\nwhere $\\mathbf{I}$ is the identity matrix, $\\mathbf{F}$ is the configuration factor matrix with elements $F_{ij}$, $\\mathbf{J}$ is the vector of radiosities, $\\boldsymbol{\\varepsilon}$ is the vector of emissivities, and $\\mathbf{E_b}(\\mathbf{T})$ is the vector of blackbody emissive powers, $\\sigma \\mathbf{T}^4$ (element-wise).\n\nLet's define the matrix $\\mathbf{M} = \\mathbf{I} - \\mathrm{diag}(1-\\boldsymbol{\\varepsilon})\\mathbf{F}$. The system is then $\\mathbf{M}\\mathbf{J} = \\mathrm{diag}(\\boldsymbol{\\varepsilon}) \\mathbf{E_b}$. This matrix $\\mathbf{M}$ is non-singular because it is strictly diagonally dominant for any physical system with $\\varepsilon_i > 0$ and $\\sum_j F_{ij} = 1$. Thus, we can formally express the radiosity vector $\\mathbf{J}$ as a function of the temperature vector $\\mathbf{T}$:\n$$\\mathbf{J}(\\mathbf{T}) = \\mathbf{M}^{-1} \\mathrm{diag}(\\boldsymbol{\\varepsilon}) \\mathbf{E_b}(\\mathbf{T})$$\n\n**3. Surface Energy Balance**\nA steady-state energy balance on surface $i$ equates the supplied heat generation per unit area, $q_{i}^{\\text{gen}}$, to the sum of heat losses by convection and net radiation:\n$$q_{i}^{\\text{gen}} = q_{i,\\text{conv}} + q_{i,\\text{rad,net}}$$\nThe convective heat loss to an ambient at temperature $T_{\\infty,i}$ is given by Newton's law of cooling:\n$$q_{i,\\text{conv}} = h_i (T_i - T_{\\infty,i})$$\nThe net radiative heat loss is the difference between the radiosity and the irradiation:\n$$q_{i,\\text{rad,net}} = J_i - G_i = J_i - \\sum_{j=1}^{N} F_{ij} J_j$$\nIn vector form, the net radiative flux is $\\mathbf{q}_{\\text{rad,net}} = (\\mathbf{I}-\\mathbf{F})\\mathbf{J}$.\n\n**4. The Residual Function**\nThe system of equations to be solved for the unknown temperatures $\\mathbf{T}$ is found by substituting the expressions for heat fluxes into the energy balance. We define a residual function $\\mathbf{R}(\\mathbf{T})$ whose root, $\\mathbf{R}(\\mathbf{T})=\\mathbf{0}$, is the solution.\n$$R_i(\\mathbf{T}) = q_{i}^{\\text{gen}} - h_i (T_i - T_{\\infty,i}) - q_{i,\\text{rad,net}}(\\mathbf{T}) = 0$$\nIn vector form:\n$$\\mathbf{R}(\\mathbf{T}) = \\mathbf{q}^{\\text{gen}} - \\mathbf{h} \\circ (\\mathbf{T} - \\mathbf{T}_{\\infty}) - (\\mathbf{I}-\\mathbf{F})\\mathbf{J}(\\mathbf{T})$$\nwhere $\\circ$ denotes the Hadamard (element-wise) product. Substituting the expression for $\\mathbf{J}(\\mathbf{T})$:\n$$\\mathbf{R}(\\mathbf{T}) = \\mathbf{q}^{\\text{gen}} - \\mathbf{h} \\circ (\\mathbf{T} - \\mathbf{T}_{\\infty}) - (\\mathbf{I}-\\mathbf{F})\\mathbf{M}^{-1}\\mathrm{diag}(\\boldsymbol{\\varepsilon})\\mathbf{E_b}(\\mathbf{T})$$\nThis is the final system of $N$ nonlinear equations for the $N$ unknown temperatures.\n\n### Step 2: Newton's Method for the Nonlinear System\n\nNewton's method is an iterative root-finding algorithm. Given an estimate for the temperatures $\\mathbf{T}^{(k)}$, a new, improved estimate $\\mathbf{T}^{(k+1)}$ is found by solving a linear system based on the local gradient (Jacobian) of the residual function.\nThe update rule is:\n$$\\mathbf{T}^{(k+1)} = \\mathbf{T}^{(k)} - \\mathcal{J}(\\mathbf{T}^{(k)})^{-1} \\mathbf{R}(\\mathbf{T}^{(k)})$$\nwhere $\\mathcal{J}(\\mathbf{T}^{(k)})$ is the Jacobian matrix of $\\mathbf{R}$ evaluated at $\\mathbf{T}^{(k)}$.\n\n**1. Jacobian Derivation**\nThe Jacobian matrix $\\mathcal{J}$ has elements $\\mathcal{J}_{ij} = \\frac{\\partial R_i}{\\partial T_j}$. We differentiate the residual function $R_i(\\mathbf{T})$. For efficiency, let's define a constant matrix $\\mathbf{C} = (\\mathbf{I}-\\mathbf{F})\\mathbf{M}^{-1}\\mathrm{diag}(\\boldsymbol{\\varepsilon})$. The residual vector is then:\n$$\\mathbf{R}(\\mathbf{T}) = \\mathbf{q}^{\\text{gen}} - \\mathbf{h} \\circ (\\mathbf{T} - \\mathbf{T}_{\\infty}) - \\mathbf{C} (\\sigma \\mathbf{T}^4)$$\nNow, we differentiate with respect to $T_j$:\n$$\\frac{\\partial R_i}{\\partial T_j} = \\frac{\\partial}{\\partial T_j} \\left( q_{i}^{\\text{gen}} - h_i(T_i - T_{\\infty,i}) - \\sum_{k=1}^{N} C_{ik} (\\sigma T_k^4) \\right)$$\n$$\\frac{\\partial R_i}{\\partial T_j} = - h_i \\delta_{ij} - C_{ij} \\frac{\\partial}{\\partial T_j}(\\sigma T_j^4) = -h_i \\delta_{ij} - C_{ij} (4 \\sigma T_j^3)$$\nIn matrix form, the Jacobian is:\n$$\\mathcal{J}(\\mathbf{T}) = -\\mathrm{diag}(\\mathbf{h}) - \\mathbf{C} \\mathrm{diag}(4\\sigma \\mathbf{T}^3)$$\n\n**2. Algorithm and Implementation Details**\nThe iterative solution proceeds as follows:\n1.  **Initialization**: Given problem parameters, pre-calculate the constant matrices $\\mathbf{M}^{-1}$ and $\\mathbf{C}$. Set an initial guess for the temperature vector, $\\mathbf{T}^{(0)}$ (e.g., $\\mathbf{T}^{(0)} = \\mathbf{T}_{\\infty}$).\n2.  **Iteration**: For $k=0, 1, 2, ...$:\n    a.  Calculate the residual vector $\\mathbf{R}(\\mathbf{T}^{(k)})$.\n    b.  Calculate the Jacobian matrix $\\mathcal{J}(\\mathbf{T}^{(k)})$.\n    c.  Solve the linear system $\\mathcal{J}(\\mathbf{T}^{(k)}) \\Delta\\mathbf{T} = -\\mathbf{R}(\\mathbf{T}^{(k)})$ for the update vector $\\Delta\\mathbf{T}$.\n    d.  Apply a line search to find a step size $\\alpha \\in (0, 1]$ such that the new temperatures $\\mathbf{T}^{(k+1)} = \\mathbf{T}^{(k)} + \\alpha \\Delta\\mathbf{T}$ are physically admissible (i.e., $T_i > 0$ for all $i$). This is done by starting with $\\alpha=1$ and halving it until the condition is met.\n    e.  Update the temperature vector: $\\mathbf{T}^{(k+1)} = \\mathbf{T}^{(k)} + \\alpha \\Delta\\mathbf{T}$.\n3.  **Convergence Check**: The iteration is terminated when both of the following criteria are met:\n    -   The infinity norm of the residual is below an absolute tolerance $\\tau_{\\text{res}}$: $||\\mathbf{R}(\\mathbf{T}^{(k+1)})||_{\\infty} < \\tau_{\\text{res}} = 10^{-6} \\mathrm{W/m^2}$.\n    -   The infinity norm of the temperature update is below an absolute tolerance $\\tau_T$: $||\\alpha \\Delta\\mathbf{T}||_{\\infty} < \\tau_T = 10^{-9} \\mathrm{K}$.\nA maximum number of iterations is also enforced to prevent infinite loops.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and run the solver for each.\n    The final results are printed in the specified format.\n    \"\"\"\n    sigma = 5.670374419e-8\n\n    test_cases = [\n        # Case 1: two facing plates with one heated\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([0.9, 0.7]),\n            \"h\": np.array([10.0, 5.0]),\n            \"T_inf\": np.array([300.0, 300.0]),\n            \"q_gen\": np.array([1000.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]]),\n        },\n        # Case 2: three surfaces with asymmetric areas and coupling\n        {\n            \"N\": 3,\n            \"A\": np.array([1.0, 2.0, 1.0]),\n            \"eps\": np.array([0.85, 0.6, 0.9]),\n            \"h\": np.array([15.0, 8.0, 20.0]),\n            \"T_inf\": np.array([300.0, 300.0, 300.0]),\n            \"q_gen\": np.array([500.0, 200.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0, 0.0], [0.5, 0.0, 0.5], [0.0, 1.0, 0.0]]),\n        },\n        # Case 3: two facing plates with very low emissivity and strong heating\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([0.05, 0.05]),\n            \"h\": np.array([2.0, 2.0]),\n            \"T_inf\": np.array([300.0, 300.0]),\n            \"q_gen\": np.array([2000.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]]),\n        },\n        # Case 4: two facing plates, no heating; boundary check\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([0.8, 0.8]),\n            \"h\": np.array([10.0, 10.0]),\n            \"T_inf\": np.array([300.0, 300.0]),\n            \"q_gen\": np.array([0.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]]),\n        },\n    ]\n    \n    results = []\n    for case in test_cases:\n        converged_temps = solve_enclosure(\n            N=case[\"N\"],\n            eps=case[\"eps\"],\n            h=case[\"h\"],\n            T_inf=case[\"T_inf\"],\n            q_gen=case[\"q_gen\"],\n            F=case[\"F\"],\n            sigma=sigma,\n            tol_res=1e-6,\n            tol_T=1e-9,\n            max_iter=100\n        )\n        results.append(np.round(converged_temps, 3).tolist())\n\n    # The string representation of a list of lists is already the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_enclosure(N, eps, h, T_inf, q_gen, F, sigma, tol_res, tol_T, max_iter):\n    \"\"\"\n    Solves for the steady-state surface temperatures in a radiative enclosure using Newton's method.\n\n    Args:\n        N (int): Number of surfaces.\n        eps (np.ndarray): Vector of surface emissivities.\n        h (np.ndarray): Vector of convection coefficients.\n        T_inf (np.ndarray): Vector of ambient temperatures.\n        q_gen (np.ndarray): Vector of heat generation per unit area.\n        F (np.ndarray): Configuration factor matrix.\n        sigma (float): Stefan-Boltzmann constant.\n        tol_res (float): Convergence tolerance for the residual norm.\n        tol_T (float): Convergence tolerance for the temperature update norm.\n        max_iter (int): Maximum number of iterations.\n\n    Returns:\n        np.ndarray: Vector of converged surface temperatures in Kelvin.\n    \"\"\"\n    # Pre-calculate constant matrices for efficiency.\n    # M = I - diag(1-eps) @ F\n    M = np.identity(N) - np.diag(1 - eps) @ F\n    try:\n        M_inv = np.linalg.inv(M)\n    except np.linalg.LinAlgError:\n        raise RuntimeError(\"Matrix M is singular, problem may be ill-posed.\")\n\n    # C = (I - F) @ M_inv @ diag(eps)\n    C = (np.identity(N) - F) @ M_inv @ np.diag(eps)\n    \n    # Initial guess for temperatures\n    T = T_inf.copy().astype(float)\n    if not np.all(T > 0):\n        # Fallback if any ambient temp is 0K or less.\n        T[T <= 0] = 300.0\n\n    for k in range(max_iter):\n        # --- Calculate Residual R(T) ---\n        E_b = sigma * T**4\n        q_rad = C @ E_b\n        q_conv = h * (T - T_inf)\n        R = q_gen - q_conv - q_rad\n\n        # --- Calculate Jacobian J(T) ---\n        # J = -diag(h) - C @ diag(4*sigma*T^3)\n        J = -np.diag(h) - C @ np.diag(4 * sigma * T**3)\n        \n        # --- Solve for update step delta_T ---\n        try:\n            delta_T = np.linalg.solve(J, -R)\n        except np.linalg.LinAlgError:\n            raise RuntimeError(f\"Jacobian is singular at iteration {k}.\")\n\n        # --- Line search for step size alpha to ensure T > 0 ---\n        alpha = 1.0\n        while True:\n            T_next = T + alpha * delta_T\n            if np.all(T_next > 0):\n                break\n            alpha /= 2.0\n            if alpha < 1e-9: # Failsafe for line search\n                raise RuntimeError(\"Line search failed to find a valid step.\")\n        \n        T_update = alpha * delta_T\n        T = T + T_update\n\n        # --- Check for convergence ---\n        res_norm = np.linalg.norm(R, np.inf)\n        update_norm = np.linalg.norm(T_update, np.inf)\n\n        if res_norm < tol_res and update_norm < tol_T:\n            return T\n            \n    raise RuntimeError(f\"Solver did not converge within {max_iter} iterations.\")\n\nsolve()\n```"
        }
    ]
}