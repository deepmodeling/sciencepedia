{
    "hands_on_practices": [
        {
            "introduction": "角系数代数与交叉弦法的核心思想在于将复杂的辐射换热积分计算转化为简单的几何长度代数运算。为了掌握这一方法，我们首先从最简单、最具对称性的情况入手：两个共轴中心对齐的平行矩形。通过这个练习，我们将推导“交叉”和“非交叉”弦的长度，并利用对称性证明特定弦长是相等的，从而为理解更复杂的几何配置奠定坚实的几何基础。",
            "id": "4003224",
            "problem": "在计算热工学的范畴内，考虑两个进行辐射交换的、有限的、漫反射的、灰色的平面矩形表面。表面 $\\mathcal{S}_1$ 位于平面 $z=0$ 上，以原点为中心，沿 $x$ 轴的半宽为 $a>0$，沿 $y$ 轴的半宽为 $b>0$，因此其四个顶点位于 $(\\pm a,\\pm b,0)$。表面 $\\mathcal{S}_2$ 位于平面 $z=H$ 上（其中 $H>0$），以 $(0,0,H)$ 为中心，沿 $x$ 轴的半宽为 $c>0$，沿 $y$ 轴的半宽为 $d>0$，因此其四个顶点位于 $(\\pm c,\\pm d,H)$。这两个表面共轴且中心对齐，并且它们的边缘相互平行。\n\n在角系数代数中，交叉弦法通过将 $\\mathcal{S}_1$ 上选定的一对对角顶点与 $\\mathcal{S}_2$ 上相应的一对对角顶点相连，构造出四条直线段（“弦”）。其中两条连线是“交叉”的，另外两条是“非交叉”的。\n\n仅从笛卡尔坐标的定义、三维空间中的欧几里得距离以及共轴中心对齐配置的对称性出发，推导在此配置下两种不同弦长的闭式表达式。具体来说，证明两条交叉弦的长度相等，即 $L_1=L_2$；两条非交叉弦的长度也相等，即 $M_1=M_2$。并求出 $L$ 和 $M$ 作为 $a$、$b$、$c$、$d$ 和 $H$ 的函数的解析表达式。\n\n将最终答案以单个闭式解析表达式的形式表示为序对 $\\left(L,M\\right)$。无需进行数值计算。最终答案中不包含单位。",
            "solution": "该问题要求推导连接两个平行的、共轴且中心对齐的矩形表面 $\\mathcal{S}_1$ 和 $\\mathcal{S}_2$ 顶点的“交叉”弦和“非交叉”弦的长度。推导必须基于第一性原理：笛卡尔坐标的定义和欧几里得距离公式，并辅以指定几何结构固有的对称性考量。\n\n首先，我们使用三维笛卡尔坐标系来形式化描述该几何结构。\n表面 $\\mathcal{S}_1$ 位于平面 $z=0$ 上。它是一个以原点 $(0,0,0)$ 为中心的矩形，沿 $x$ 轴的半宽为 $a>0$，沿 $y$ 轴的半宽为 $b>0$。因此，其四个顶点为：\n$V_{1,1} = (a, b, 0)$\n$V_{1,2} = (-a, b, 0)$\n$V_{1,3} = (-a, -b, 0)$\n$V_{1,4} = (a, -b, 0)$\n\n表面 $\\mathcal{S}_2$ 位于平面 $z=H$ 上，其中 $H>0$。它是一个以 $(0,0,H)$ 为中心的矩形，沿 $x$ 轴的半宽为 $c>0$，沿 $y$ 轴的半宽为 $d>0$。因此，其四个顶点为：\n$V_{2,1} = (c, d, H)$\n$V_{2,2} = (-c, d, H)$\n$V_{2,3} = (-c, -d, H)$\n$V_{2,4} = (c, -d, H)$\n\n问题描述了通过在 $\\mathcal{S}_1$ 上选择一对对角顶点，并在 $\\mathcal{S}_2$ 上选择相应的一对顶点来构造四条弦。由于配置的共轴和中心对称性，从哪条对角线开始选择是任意的；最终得到的长度将是相同的。我们选择 $\\mathcal{S}_1$ 上连接 $V_{1,1}$ 和 $V_{1,3}$ 的对角线。$\\mathcal{S}_2$ 上相应的对角线连接 $V_{2,1}$ 和 $V_{2,3}$。因此，所涉及的四个顶点是 $V_{1,1}$、$V_{1,3}$、$V_{2,1}$ 和 $V_{2,3}$。\n\n我们计算的基本原理是欧几里得距离公式。三维空间中两点 $P_1 = (x_1, y_1, z_1)$ 和 $P_2 = (x_2, y_2, z_2)$ 之间的距离 $D$ 由下式给出：\n$$D = \\sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2 + (z_2 - z_1)^2}$$\n\n现在我们对“非交叉”弦和“交叉”弦进行分类并计算其长度。\n\n“非交叉”弦，我们用 $M_1$ 和 $M_2$ 表示，连接对应的顶点而不穿过中心 $z$ 轴。\n第一条非交叉弦 $M_1$ 连接 $V_{1,1}=(a,b,0)$ 和 $V_{2,1}=(c,d,H)$。其长度为：\n$$M_1 = \\sqrt{(c - a)^2 + (d - b)^2 + (H - 0)^2} = \\sqrt{(c-a)^2 + (d-b)^2 + H^2}$$\n第二条非交叉弦 $M_2$ 连接 $V_{1,3}=(-a,-b,0)$ 和 $V_{2,3}=(-c,-d,H)$。其长度为：\n$$M_2 = \\sqrt{(-c - (-a))^2 + (-d - (-b))^2 + (H - 0)^2} = \\sqrt{(a-c)^2 + (b-d)^2 + H^2}$$\n由于 $(x-y)^2 = (y-x)^2$，我们有 $(a-c)^2 = (c-a)^2$ 和 $(b-d)^2 = (d-b)^2$。因此，可以证明 $M_1 = M_2$。我们将这个共同的长度定义为 $M$：\n$$M = \\sqrt{(a-c)^2 + (b-d)^2 + H^2}$$\n\n“交叉”弦，我们用 $L_1$ 和 $L_2$ 表示，连接的顶点使得弦穿过中心 $z$ 轴。\n第一条交叉弦 $L_1$ 连接 $V_{1,1}=(a,b,0)$ 和 $V_{2,3}=(-c,-d,H)$。其长度为：\n$$L_1 = \\sqrt{(-c - a)^2 + (-d - b)^2 + (H - 0)^2} = \\sqrt{(-(c+a))^2 + (-(d+b))^2 + H^2}$$\n$$L_1 = \\sqrt{(a+c)^2 + (b+d)^2 + H^2}$$\n第二条交叉弦 $L_2$ 连接 $V_{1,3}=(-a,-b,0)$ 和 $V_{2,1}=(c,d,H)$。其长度为：\n$$L_2 = \\sqrt{(c - (-a))^2 + (d - (-b))^2 + (H - 0)^2} = \\sqrt{(c+a)^2 + (d+b)^2 + H^2}$$\n显而易见，$L_1 = L_2$。我们将这个共同的长度定义为 $L$：\n$$L = \\sqrt{(a+c)^2 + (b+d)^2 + H^2}$$\n\n问题要求基于对称性进行证明。上述计算本身就依赖于对称性。例如，等式 $M_1=M_2$ 的成立是因为从 $V_{2,3}$ 到 $V_{1,3}$ 的向量是从 $V_{1,1}$ 到 $V_{2,1}$ 的向量的负向量，即 $(-a - (-c), -b - (-d), 0-H) = (c-a, d-b, -H)$。其模长保持不变。类似的论证也适用于 $L_1=L_2$。\n\n此外，如果我们选择另一对对角线，即 $\\mathcal{S}_1$ 上的 $V_{1,2}(-a, b, 0)$ 和 $V_{1,4}(a, -b, 0)$，以及 $\\mathcal{S}_2$ 上相应的 $V_{2,2}(-c, d, H)$ 和 $V_{2,4}(c, -d, H)$，由于距离公式中平方运算对于坐标符号变化的对称性，得到的弦长将是相同的。\n例如，从 $V_{1,2}$到$V_{2,2}$的非交叉弦长度为 $\\sqrt{(-c - (-a))^2 + (d - b)^2 + H^2} = \\sqrt{(a-c)^2 + (d-b)^2 + H^2}$，这与$M$相同。\n从 $V_{1,2}$到$V_{2,4}$的交叉弦长度为 $\\sqrt{(c - (-a))^2 + (-d - b)^2 + H^2} = \\sqrt{(a+c)^2 + (b+d)^2 + H^2}$，这与$L$相同。\n这证实了对于给定的几何结构，推导出的长度 $L$ 和 $M$ 是唯一的。\n\n公共交叉弦长度 $L$ 和公共非交叉弦长度 $M$ 的最终表达式为：\n$$L = \\sqrt{(a+c)^2 + (b+d)^2 + H^2}$$\n$$M = \\sqrt{(a-c)^2 + (b-d)^2 + H^2}$$\n问题要求将序对 $(L, M)$ 作为最终答案。",
            "answer": "$$\\boxed{ \\left( \\sqrt{(a+c)^2 + (b+d)^2 + H^2}, \\sqrt{(a-c)^2 + (b-d)^2 + H^2} \\right) }$$"
        },
        {
            "introduction": "在建立了交叉弦法的基本几何构件之后，下一步是将其与角系数的定义联系起来，并验证其在工程应用中的一个关键属性——可加性。这个实践要求我们从第一性原理出发，推导二维无限长平行带间的角系数交叉弦公式，并证明将表面分割后，各部分角系数的面积加权和等于整体角系数。通过编写代码来数值验证这一理论，你可以深刻体会到该方法在处理复杂几何时的强大威力与内在一致性。",
            "id": "4003225",
            "problem": "考虑两个平行的、漫射的、灰色的、等温的表面，它们在二维空间中被建模为具有有限宽度的无限长条带。假设表面 $S_1$ 位于 $y = 0$ 的 $x$ 轴上，介于 $x = x_A$ 和 $x = x_B$ 之间；表面 $S_2$ 与其平行，位于 $y = H$ 处，介于 $x = x_C$ 和 $x = x_D$ 之间，其中 $H > 0$。角系数 $F_{12}$ 定义为，在漫射发射和无遮挡视线的假设下，离开表面 $S_1$ 的辐射能直接投射到表面 $S_2$ 上的比例。\n\n使用的基本原理：\n- 漫射表面的微分角系数定义：对于表面 $S_1$ 上的微分面积 $dA_1$ 和表面 $S_2$ 上的微分面积 $dA_2$，对角系数的贡献与 $\\dfrac{\\cos \\theta_1 \\cos \\theta_2}{\\pi r^2}$ 成正比，其中 $\\theta_1$ 和 $\\theta_2$ 是连接两个微分单元的直线与其各自表面法线之间的夹角，而 $r$ 是两点之间的距离。\n- 角系数对分区的可加性：如果表面 $S_1$ 被划分为 $N$ 个不重叠的子表面 $\\{S_{1k}\\}$，使得 $\\bigcup_k S_{1k} = S_1$，则 $F_{12} = \\sum_{k=1}^N \\dfrac{A_{1k}}{A_1} F_{(1k)2}$，其中 $A_{1k}$ 是 $S_{1k}$ 的面积，$A_1$ 是 $S_1$ 的面积。\n- 交叉弦法所基于的互易关系和几何不变性（在问题陈述中此处不提供捷径公式）：角系数可以通过使用条带端点之间角对角欧几里得距离的等效计算来表示。\n\n任务：\n1. 从微分定义和几何关系出发，推导两个无限长平行条带之间的 $F_{12}$ 的显式表达式，该表达式用 $(x_A, 0)$、$(x_B, 0)$、$(x_C, H)$ 和 $(x_D, H)$ 之间角对角的欧几里得距离表示，不得直接调用任何捷径公式。此推导应能证明为何这些距离的某个线性组合能够得出平面外方向上单位长度条带的角系数。\n2. 使用角系数的可加性，证明将表面 $S_1$ 沿 $x$ 轴划分为连续的子条带，并对每个子条带应用推导出的交叉弦计算，然后构成面积加权和 $\\sum_k \\dfrac{A_{1k}}{A_1} F_{(1k)2}$，其结果与完整条带 $S_1$ 的原始 $F_{12}$ 保持一致。\n3. 实现一个程序，该程序：\n   - 使用推导出的交叉弦表达式，为给定的几何形状 $(x_A, x_B, x_C, x_D, H)$ 计算 $F_{12}$。\n   - 将 $S_1$ 划分为具有端点 $\\{x_{p,0} = x_A, x_{p,1}, \\ldots, x_{p,n} = x_B\\}$ 的指定子条带，为每个子条带 $[x_{p,k-1}, x_{p,k}]$ 计算 $F_{(1k)2}$，并构成面积加权和 $\\sum_k \\dfrac{x_{p,k} - x_{p,k-1}}{x_B - x_A} F_{(1k)2}$。\n   - 报告每个测试用例中，完整条带的 $F_{12}$ 与分区加权和之间的绝对差值（浮点数）。\n\n单位：\n- 所有长度单位均为米。角系数是无量纲的（没有单位）。无需指定角度，因为几何形状已完全规定。\n\n测试套件：\n提供以下五个案例的结果。在每个案例中，您的程序必须计算并输出完整条带 $F_{12}$ 与子条带角系数的面积加权和之间的绝对差值（浮点数）。\n\n- 案例 1（正常路径，部分重叠，中等间距）：\n  - 几何参数：$x_A = -0.40$, $x_B = 1.10$, $x_C = -0.20$, $x_D = 0.70$, $H = 0.65$。\n  - $S_1$ 的分割点：$[-0.40, -0.10, 0.30, 0.50, 0.80, 1.10]$。\n\n- 案例 2（无水平重叠，中等间距）：\n  - 几何参数：$x_A = -1.20$, $x_B = -0.20$, $x_C = 0.30$, $x_D = 1.00$, $H = 0.90$。\n  - $S_1$ 的分割点：$[-1.20, -1.05, -0.80, -0.60, -0.35, -0.20]$。\n\n- 案例 3（显著偏移，小间距）：\n  - 几何参数：$x_A = 0.00$, $x_B = 0.70$, $x_C = -0.60$, $x_D = 0.10$, $H = 0.20$。\n  - $S_1$ 的分割点：$[0.00, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70]$。\n\n- 案例 4（$S_1$ 非常窄，中等间距）：\n  - 几何参数：$x_A = -0.05$, $x_B = 0.05$, $x_C = -0.30$, $x_D = 0.60$, $H = 0.50$。\n  - $S_1$ 的分割点：$[-0.05, -0.01, 0.02, 0.05]$。\n\n- 案例 5（宽条带，大间距）：\n  - 几何参数：$x_A = -0.30$, $x_B = 0.90$, $x_C = -0.80$, $x_D = 1.20$, $H = 5.00$。\n  - $S_1$ 的分割点：$[-0.30, 0.00, 0.30, 0.60, 0.90]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含以逗号分隔的列表形式的结果，并用方括号括起来，顺序与上述案例完全一致（例如，$[d_1,d_2,d_3,d_4,d_5]$），其中每个 $d_i$ 是计算出的绝对差值（浮点数）。不应打印任何其他文本。",
            "solution": "该问题被评估为有效，因为它科学地基于辐射传热原理，问题定义清晰完整、提出得当，并且其表述是客观的。该任务要求从第一性原理进行推导、形式化证明和数值实现，所有这些都是计算科学与工程中的标准和可验证的程序。\n\n### 第 1 部分：角系数表达式的推导 ###\n\n问题要求从基本的微分定义推导两个无限长的平行条带 $S_1$ 和 $S_2$ 之间的角系数 $F_{12}$。\n设 $S_1$ 是 $xy$ 平面（$z=0$ 时）上的一个条带，由 $x \\in [x_A, x_B]$ 和 $y=0$ 定义。\n设 $S_2$ 是与 $S_1$ 平行的条带，由 $x \\in [x_C, x_D]$ 和 $y=H$ 定义，其中 $H > 0$。两个条带在 $z$ 方向上都是无限长的。\n\n从表面 $S_1$ 上的一个微分面积 $dA_1$ 到表面 $S_2$ 上的一个微分面积 $dA_2$ 的角系数由下式给出：\n$$ dF_{dA_1 \\to dA_2} = \\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi r^2} dA_2 $$\n设 $dA_1$ 位于 $(x_1, 0, z_1)$，$dA_2$ 位于 $(x_2, H, z_2)$。面积为 $dA_1 = dx_1 dz_1$ 和 $dA_2 = dx_2 dz_2$。\n从 $dA_1$ 到 $dA_2$ 的向量是 $\\vec{r} = (x_2 - x_1)\\hat{i} + H\\hat{j} + (z_2 - z_1)\\hat{k}$。\n距离的平方是 $r^2 = (x_2 - x_1)^2 + H^2 + (z_2 - z_1)^2$。\n$S_1$ 的单位法向量是 $\\vec{n}_1 = \\hat{j}$。$S_2$ 的单位法向量是 $\\vec{n}_2 = -\\hat{j}$。\n角度 $\\theta_1$ 和 $\\theta_2$ 由下式给出：\n$$ \\cos\\theta_1 = \\frac{\\vec{r} \\cdot \\vec{n}_1}{|\\vec{r}||\\vec{n}_1|} = \\frac{H}{r} $$\n$$ \\cos\\theta_2 = \\frac{\\vec{r} \\cdot (-\\vec{n}_2)}{|\\vec{r}||\\vec{n}_2|} = \\frac{H}{r} $$\n注意 $\\theta_2$ 是 $\\vec{r}$ 与 $S_2$ 的法线 $\\vec{n}_2$ 之间的夹角。但公式中使用的是连接单元的直线与各自表面法线之间的夹角。因此该表述是正确的。\n从微分面积 $dA_1$ 到整个表面 $S_2$ 的角系数通过对 $S_2$ 积分得到：\n$$ F_{dA_1 \\to S_2} = \\int_{S_2} \\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi r^2} dA_2 = \\int_{z_2=-\\infty}^{\\infty} \\int_{x_2=x_C}^{x_D} \\frac{H^2}{\\pi r^4} dx_2 dz_2 $$\n对于二维问题（无限长条带），处理两个长度为 $dx_1$ 和 $dx_2$ 且在 $z$ 方向上无限延伸的微分条带之间的角系数更为方便。设其为 $dF_{dL_1 \\to dL_2}$。从位于 $x_1$ 的无限长微分条带 $dL_1$ 到有限宽度条带 $S_2$ 的角系数 $F_{dL_1 \\to S_2}$，通过对 $S_2$ 的宽度和无限长度 $z_2$ 积分得到。\n$$ F_{dL_1 \\to S_2} = \\int_{x_C}^{x_D} \\left( \\int_{-\\infty}^{\\infty} \\frac{H^2}{\\pi [ (x_2-x_1)^2 + H^2 + (z_2-z_1)^2 ]^2} dz_2 \\right) dx_2 $$\n令 $s = z_2 - z_1$ 和 $R^2 = (x_2 - x_1)^2 + H^2$。内部积分变为：\n$$ \\int_{-\\infty}^{\\infty} \\frac{H^2}{\\pi (R^2 + s^2)^2} ds = \\frac{H^2}{\\pi} \\left[ \\frac{s}{2R^2(R^2+s^2)} + \\frac{1}{2R^3}\\arctan\\left(\\frac{s}{R}\\right) \\right]_{-\\infty}^{\\infty} = \\frac{H^2}{\\pi} \\frac{\\pi}{2R^3} = \\frac{H^2}{2R^3} $$\n将此代回，我们得到：\n$$ F_{dL_1 \\to S_2} = \\int_{x_C}^{x_D} \\frac{H^2}{2((x_2-x_1)^2 + H^2)^{3/2}} dx_2 $$\n$\\frac{c^2}{(u^2+c^2)^{3/2}}$ 关于 $u$ 的积分是 $\\frac{u}{\\sqrt{u^2+c^2}}$。这里，$u = x_2 - x_1$ 且 $c=H$。因此，$du = dx_2$。\n$$ F_{dL_1 \\to S_2} = \\frac{1}{2} \\left[ \\frac{x_2 - x_1}{\\sqrt{(x_2-x_1)^2 + H^2}} \\right]_{x_2=x_C}^{x_D} $$\n$$ F_{dL_1 \\to S_2} = \\frac{1}{2} \\left( \\frac{x_D-x_1}{\\sqrt{(x_D-x_1)^2 + H^2}} - \\frac{x_C-x_1}{\\sqrt{(x_C-x_1)^2 + H^2}} \\right) $$\n为了找到总角系数 $F_{12}$，我们必须在表面 $S_1$ 的宽度上对 $F_{dL_1 \\to S_2}$ 进行平均：\n$$ F_{12} = \\frac{1}{A_1} \\int_{A_1} F_{dL_1 \\to S_2} dA_1 = \\frac{1}{x_B - x_A} \\int_{x_A}^{x_B} F_{dL_1 \\to S_2} dx_1 $$\n该积分为：\n$$ \\int_{x_A}^{x_B} \\frac{1}{2} \\left( \\frac{x_D-x_1}{\\sqrt{(x_D-x_1)^2 + H^2}} - \\frac{x_C-x_1}{\\sqrt{(x_C-x_1)^2 + H^2}} \\right) dx_1 $$\n我们分别计算这两项。对于第一项，令 $u = x_D-x_1$，所以 $du = -dx_1$。\n$$ \\int_{x_D-x_A}^{x_D-x_B} \\frac{u}{\\sqrt{u^2+H^2}}(-du) = \\left[ \\sqrt{u^2+H^2} \\right]_{x_D-x_B}^{x_D-x_A} = \\sqrt{(x_D-x_A)^2+H^2} - \\sqrt{(x_D-x_B)^2+H^2} $$\n设端点为 $A=(x_A,0)$，$B=(x_B,0)$，$C=(x_C,H)$ 和 $D=(x_D,H)$。这些项是欧几里得距离：$L_{AD} = \\sqrt{(x_D-x_A)^2+H^2}$ 和 $L_{BD} = \\sqrt{(x_D-x_B)^2+H^2}$。第一项的积分是 $L_{AD} - L_{BD}$。\n类似地，第二项的积分得到 $L_{AC} - L_{BC}$。\n总积分是 $(L_{AD} - L_{BD}) - (L_{AC} - L_{BC}) = (L_{AD} + L_{BC}) - (L_{AC} + L_{BD})$。\n将此代入 $F_{12}$ 的表达式中：\n$$ F_{12} = \\frac{(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})}{2(x_B - x_A)} $$\n这就是交叉弦法公式。分子表示连接条带端点的交叉弦的长度之和减去非交叉弦的长度之和。分母是发射表面 $S_1$ 宽度的两倍。\n\n### 第 2 部分：可加性的证明 ###\n\n问题要求证明，将 $S_1$ 分区并将子条带的面积加权角系数求和，其结果与总角系数保持一致。\n设 $S_1$ 被划分为 $N$ 个连续的子条带 $\\{S_{1k}\\}_{k=1}^N$。第 $k$ 个子条带 $S_{1k}$ 从 $x=x_{p,k-1}$ 延伸到 $x=x_{p,k}$，其中分割点为 $\\{x_{p,0}, x_{p,1}, \\ldots, x_{p,N}\\}$，且 $x_{p,0} = x_A$，$x_{p,N} = x_B$。\n子条带 $S_{1k}$ 的宽度（单位长度的面积）是 $W_{1k} = x_{p,k} - x_{p,k-1}$。\n$S_1$ 的总宽度是 $W_1 = x_B - x_A = \\sum_{k=1}^N W_{1k}$。\n可加性规则指出：\n$$ F_{12} = \\sum_{k=1}^N \\frac{W_{1k}}{W_1} F_{(1k)2} $$\n我们必须使用推导出的角系数公式来证明这个恒等式。设 $S_{1k}$ 的端点为 $P_{k-1}=(x_{p,k-1}, 0)$ 和 $P_k=(x_{p,k}, 0)$。$S_2$ 的端点保持为 $C=(x_C, H)$ 和 $D=(x_D, H)$。\n从 $S_{1k}$ 到 $S_2$ 的角系数是：\n$$ F_{(1k)2} = \\frac{(L_{P_{k-1}D} + L_{P_kC}) - (L_{P_{k-1}C} + L_{P_kD})}{2 W_{1k}} $$\n现在，我们构成面积加权和：\n$$ \\sum_{k=1}^N \\frac{W_{1k}}{W_1} F_{(1k)2} = \\sum_{k=1}^N \\frac{W_{1k}}{W_1} \\left[ \\frac{(L_{P_{k-1}D} + L_{P_kC}) - (L_{P_{k-1}C} + L_{P_kD})}{2 W_{1k}} \\right] $$\n宽度项 $W_{1k}$ 消掉了：\n$$ = \\frac{1}{2W_1} \\sum_{k=1}^N \\left[ (L_{P_{k-1}D} + L_{P_kC}) - (L_{P_{k-1}C} + L_{P_kD}) \\right] $$\n这是一个伸缩求和。让我们展开并重新组合求和中的项：\n$$ \\sum_{k=1}^N (\\dots) = \\sum_{k=1}^N (L_{P_{k-1}D} - L_{P_kD}) + \\sum_{k=1}^N (L_{P_kC} - L_{P_{k-1}C}) $$\n第一个求和是伸缩的：\n$$ \\sum_{k=1}^N (L_{P_{k-1}D} - L_{P_kD}) = (L_{P_0D} - L_{P_1D}) + (L_{P_1D} - L_{P_2D}) + \\dots + (L_{P_{N-1}D} - L_{P_ND}) = L_{P_0D} - L_{P_ND} $$\n第二个求和也是伸缩的：\n$$ \\sum_{k=1}^N (L_{P_kC} - L_{P_{k-1}C}) = (L_{P_1C} - L_{P_0C}) + (L_{P_2C} - L_{P_1C}) + \\dots + (L_{P_NC} - L_{P_{N-1}C}) = L_{P_NC} - L_{P_0C} $$\n将这些结果合并，总和为 $(L_{P_0D} - L_{P_ND}) + (L_{P_NC} - L_{P_0C})$。\n根据分区的定义，$P_0 = A = (x_A, 0)$ 且 $P_N = B = (x_B, 0)$。\n所以，总和变为 $(L_{AD} - L_{BD}) + (L_{BC} - L_{AC})$。\n重新整理各项，得到 $(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})$。\n将此代回加权和的表达式中：\n$$ \\sum_{k=1}^N \\frac{W_{1k}}{W_1} F_{(1k)2} = \\frac{(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})}{2W_1} = \\frac{(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})}{2(x_B - x_A)} $$\n这正是整个条带 $S_1$ 的 $F_{12}$ 的表达式。因此，交叉弦公式的可加性特性在解析上被证明是成立的。由于浮点运算，数值实现应产生零的差值，或一个在机器精度数量级的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_view_factor(x1_start: float, x1_end: float, x2_start: float, x2_end: float, h: float) -> float:\n    \"\"\"\n    Computes the view factor F_12 between two infinitely long parallel strips.\n\n    Args:\n        x1_start: Starting x-coordinate of strip 1.\n        x1_end: Ending x-coordinate of strip 1.\n        x2_start: Starting x-coordinate of strip 2.\n        x2_end: Ending x-coordinate of strip 2.\n        h: Perpendicular distance between the strips.\n\n    Returns:\n        The view factor F_12.\n    \"\"\"\n    w1 = x1_end - x1_start\n    if abs(w1) < 1e-12:\n        return 0.0\n\n    # Endpoints of the strips: A, B for strip 1; C, D for strip 2.\n    # A = (x1_start, 0), B = (x1_end, 0)\n    # C = (x2_start, h),  D = (x2_end, h)\n\n    # Uncrossed strings\n    l_ac = np.sqrt((x2_start - x1_start)**2 + h**2)\n    l_bd = np.sqrt((x2_end - x1_end)**2 + h**2)\n\n    # Crossed strings\n    l_ad = np.sqrt((x2_end - x1_start)**2 + h**2)\n    l_bc = np.sqrt((x2_start - x1_end)**2 + h**2)\n\n    f12 = (l_ad + l_bc - l_ac - l_bd) / (2 * w1)\n    \n    return f12\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases, computes the absolute difference between\n    the full-strip view factor and the area-weighted sum of sub-strip view factors,\n    and prints the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"geometry\": {\"xA\": -0.40, \"xB\": 1.10, \"xC\": -0.20, \"xD\": 0.70, \"H\": 0.65},\n            \"partitions\": [-0.40, -0.10, 0.30, 0.50, 0.80, 1.10],\n        },\n        {\n            \"geometry\": {\"xA\": -1.20, \"xB\": -0.20, \"xC\": 0.30, \"xD\": 1.00, \"H\": 0.90},\n            \"partitions\": [-1.20, -1.05, -0.80, -0.60, -0.35, -0.20],\n        },\n        {\n            \"geometry\": {\"xA\": 0.00, \"xB\": 0.70, \"xC\": -0.60, \"xD\": 0.10, \"H\": 0.20},\n            \"partitions\": [0.00, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70],\n        },\n        {\n            \"geometry\": {\"xA\": -0.05, \"xB\": 0.05, \"xC\": -0.30, \"xD\": 0.60, \"H\": 0.50},\n            \"partitions\": [-0.05, -0.01, 0.02, 0.05],\n        },\n        {\n            \"geometry\": {\"xA\": -0.30, \"xB\": 0.90, \"xC\": -0.80, \"xD\": 1.20, \"H\": 5.00},\n            \"partitions\": [-0.30, 0.00, 0.30, 0.60, 0.90],\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        geom = case[\"geometry\"]\n        partitions = case[\"partitions\"]\n        \n        xA, xB, xC, xD, H = geom[\"xA\"], geom[\"xB\"], geom[\"xC\"], geom[\"xD\"], geom[\"H\"]\n        \n        # 1. Compute F_12 for the full strip\n        f12_full = calculate_view_factor(xA, xB, xC, xD, H)\n        \n        # 2. Compute the area-weighted sum of sub-strip view factors\n        partitioned_sum = 0.0\n        total_width = xB - xA\n        \n        for k in range(1, len(partitions)):\n            x_start_k = partitions[k-1]\n            x_end_k = partitions[k]\n            \n            # Compute view factor for the sub-strip\n            f_k2 = calculate_view_factor(x_start_k, x_end_k, xC, xD, H)\n            \n            # Calculate area weight and add to sum\n            sub_strip_width = x_end_k - x_start_k\n            weight = sub_strip_width / total_width\n            partitioned_sum += weight * f_k2\n            \n        # 3. Report the absolute difference\n        abs_diff = abs(f12_full - partitioned_sum)\n        results.append(abs_diff)\n        \n    # Format the final output string as [d1,d2,d3,d4,d5]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论上的数学公式在转化为可靠的计算程序时，往往会遇到理想模型未曾考虑的挑战。交叉弦法中的“退化”几何构型——例如端点重合或多点共线——正是此类挑战的典型。这个实践将引导我们思考如何设计一个数值稳健的分类规则来处理这些退化情况，以确保计算结果的连续性和互易性，这对于任何计算工程师来说都是一项至关重要的技能，它连接了理想化的理论与现实世界的代码实现。",
            "id": "4003313",
            "problem": "考虑嵌入一个平面内的两个漫射、灰体、等温、完全吸收的线段 $\\overline{A_1A_2}$ 和 $\\overline{B_1B_2}$，它们代表了垂直于该平面的无限长表面的二维横截面。从 $\\overline{A_1A_2}$ 到 $\\overline{B_1B_2}$ 的角系数 $F_{12}$ 将使用交叉弦法计算，该方法连接 $\\overline{A_1A_2}$ 的每个端点与 $\\overline{B_1B_2}$ 的每个端点，然后将产生的四条线段划分为两个不相交的类别，标记依据是同一类别中的两条线段是否在其内部相交。在严格非退化的构型中，这种构造会产生唯一的划分和一个相应的长度代数组合，已知该组合关于端点是连续的，并且满足相互性 $L_1 F_{12} = L_2 F_{21}$，其中 $L_1 = \\lVert A_2 - A_1 \\rVert_2$ 且 $L_2 = \\lVert B_2 - B_1 \\rVert_2$。\n\n然而，在计算实践中，构型可能因两种方式之一而退化：(i) 端点重合，即对于某些 $i,j \\in \\{1,2\\}$ 有 $A_i = B_j$，这会产生长度为零的线段；以及 (ii) 共线性，即 $\\{A_1,A_2,B_1,B_2\\}$ 中有三或四个点共线，这可能导致两条线段在一个端点处接触或位于同一条直线上，使得交叉/非交叉的二元分类变得模糊不清。此类退化在连续几何中测度为零，但由于网格划分和浮点舍入而频繁出现。\n\n从以下基本事实出发：(a) 角系数由在两个线段上的光滑核的二重积分定义，因此只要线段保持不相交，它就连续地依赖于线段端点；以及 (b) 对于任何容许构型，相互性要求 $L_1 F_{12} = L_2 F_{21}$。请选择一个选项，该选项规定了一个数值鲁棒、标签对称的规则来处理重合或共线的顶点，无任意偏见地解决分类问题，并保证连续性（作为非退化扰动的极限）和相互性。\n\n哪个选项是正确的？\n\nA. 将任何相交的线对（包括在端点处接触）分类为“交叉”，并从所有总和中去掉任何零长度的线段；如果分类中仍存在平局，则通过选择索引标签最小的线对作为“非交叉”来打破平局。这强制执行了严格的几何相交规则，并避免了数值奇异性。\n\nB. 对 $\\overline{B_1B_2}$ 沿着一个为整个计算选择一次的、固定的、任意的单位方向 $\\hat{\\mathbf{n}}$，施加一个无穷小位移 $\\varepsilon \\,\\hat{\\mathbf{n}}$（其中 $\\varepsilon \\to 0^+$）；使用严格不等式对位移后的交叉情况进行分类，并将结果映射回原始构型。将零长度线段视为不存在。这模拟了一个一般位置构型，同时保持算法简单。\n\nC. 使用一个有向线段相交谓词和以下对称的平局打破规则：当且仅当每条线段恰当地与另一条的内部相交（严格相反的符号方向）时，宣布两条线段为“交叉”；并将任何端点接触或共线情况（相对于任一线段为零方向）宣布为“非交叉”。如果对于任何 $i,j$ 有 $A_i = B_j$，则将零长度线段精确地包含一次，并将其放入“非交叉”类别。如果四个点共线，将两条线段都分类为“非交叉”。使用精确或自适应精度的鲁棒谓词来实现方向测试；当重合端点需要去重时，使用端点坐标的字典序来选择唯一的代表，以使分类与标签无关。此规则独立于标签顺序，并与非退化扰动的极限相匹配。\n\nD. 通过加上 $\\delta \\, \\xi$ 来独立地抖动所有坐标，其中 $\\xi$ 从 $[-1,1]$ 中均匀采样，$\\delta > 0$ 是一个固定的小值；重新计算分类，并在 $N$ 次独立的抖动上对结果取平均，取大的 $N$。将任何零长度线段视为不存在。根据大数定律，这会产生一个稳定的估计，并避免处理退化逻辑。\n\n给出你的选择，并基于积分定义的基本连续性和相互性 $L_1 F_{12} = L_2 F_{21}$ 进行论证，不借助任何未经证实的交叉线法捷径公式。你的论证应清楚说明为什么不正确的选项在至少一种现实构型中会破坏连续性或相互性。假设线段保持不相交（有正分离距离），因此角系数是有限且良定义的。",
            "solution": "问题要求选择一个规则，用于在计算两个线段 $\\overline{A_1A_2}$ 和 $\\overline{B_1B_2}$ 之间的二维角系数 $F_{12}$ 时，对交叉弦法中的线段进行分类。该规则必须对退化的几何构型（重合或共线的端点）具有鲁棒性，并且必须保证角系数的两个基本性质：关于端点坐标的连续性，以及满足相互关系 $L_1 F_{12} = L_2 F_{21}$，其中 $L_1$ 和 $L_2$ 是线段的长度。它还必须是一个“标签对称”的规则，意味着它应该对端点的重新标记（例如，交换 $A_1$ 和 $A_2$）是不变的。\n\n首先，让我们建立理论基础。交叉弦法提供了一个交换因子 $E_{12} = L_1 F_{12}$ 的表达式。该方法涉及连接两个线段端点的四条线：$\\overline{A_1B_1}$、$\\overline{A_1B_2}$、$\\overline{A_2B_1}$ 和 $\\overline{A_2B_2}$。这四条线可以划分为不共享任何端点的两对：$P_a = \\{\\overline{A_1B_1}, \\overline{A_2B_2}\\}$ 和 $P_b = \\{\\overline{A_1B_2}, \\overline{A_2B_1}\\}$。在非退化构型中，其中一对的线（“交叉”线）将在其内部相交，而另一对的线（“非交叉”线）则不会。交换因子由以下代数组合给出：\n$$E_{12} = L_1 F_{12} = \\frac{1}{2} \\left[ \\sum L_{\\text{crossed}} - \\sum L_{\\text{uncrossed}} \\right]$$\n其中 $\\sum L$ 是相应类别中线段长度的总和。为了使角系数 $F_{12}$ 为非负，交叉线的长度之和必须大于或等于非交叉线的长度之和。\n\n我们必须根据主要要求评估每个选项：\n\n1.  **连续性**：如问题所述，由基本二重积分定义的角系数是端点坐标的连续函数（只要线段不相交）。任何用于代数交叉线法的规则都必须再现这种连续性。如果在退化构型处，线段到“交叉”和“非交叉”的分类发生突变，计算出的 $F_{12}$ 就会出现不连续性。分类的切换会导致 $\\left[ \\sum L_{\\text{crossed}} - \\sum L_{\\text{uncrossed}} \\right]$ 项符号翻转。为了保持连续性，该项在转变点必须为零。\n\n2.  **相互性**：规则必须确保 $L_1 F_{12} = L_2 F_{21}$。这意味着 $E_{12} = E_{21}$。$E_{21}$ 的计算涉及相同的四条线和相同的几何形状。当且仅当线段到“交叉”和“非交叉”的分类对于交换线段1和线段2的角色是对称的时，相互性才得到满足。这要求规则基于四个端点的内在几何性质，而与哪个线段是源无关。\n\n3.  **标签对称性**：计算出的 $F_{12}$ 值不得依赖于线段端点的任意标记（例如，交换 $A_1$ 和 $A_2$）。这也要求分类规则基于内在的几何属性，而不是索引标签。\n\n现在，我们评估给定的选项。\n\n**选项A分析**\n该选项建议将任何相交的线（包括仅在端点处接触）分类为“交叉”。考虑一个对角线（例如 $\\overline{A_1B_2}$ 和 $\\overline{A_2B_1}$）在端点处接触的构型。根据此规则，它们是“交叉”的。一个无穷小的扰动可以使它们完全不相交。在这种扰动状态下，它们将被分类为“非交叉”，而另一对将被分类为“交叉”。这导致 $E_{12}$ 的表达式符号翻转，在 $F_{12}$ 中引入不连续性，违反了连续性原则。此外，使用“最小索引标签”来打破平局的规则明确地依赖于点的任意标记，违反了标签对称性要求。丢弃零长度线段也可能导致不连续性，因为一个平滑趋近于零的线段长度会突然从公式中移除。\n**结论：不正确。**\n\n**选项B分析**\n该选项建议通过对其中一个线段施加无穷小位移 $\\varepsilon \\hat{\\mathbf{n}}$ 来解决退化问题。这是一种常见的扰动技术。然而，方向 $\\hat{\\mathbf{n}}$ 的选择是“固定的”但“任意的”。考虑一个四点构型，其中一个顶点与由四个端点形成的四边形的一条边共线。一个方向的扰动可能导致凸四边形（对角线交叉），而另一个方向的扰动可能导致非凸四边形（对角线不交叉）。最终的分类——以及 $F_{12}$ 的值——将取决于 $\\hat{\\mathbf n}$ 的任意选择。这将违反客观、无偏规则的要求，并且不能保证对于给定的退化几何形状有唯一的结果。\n**结论：不正确。**\n\n**选项C分析**\n该选项提供了一个详细的、多部分的规则，其基础是鲁棒计算几何的原理。\n1.  **相交测试**：它使用严格的内部相交谓词来定义“交叉”。这基于方向测试（例如，使用三角形的有符号面积或叉积），这是标准的鲁棒方法。一对线段 $\\overline{PQ}$ 和 $\\overline{RS}$ 恰当相交，当且仅当每条线段的端点位于由另一条线段定义的直线的两侧。这个测试是纯粹几何的，因此对于交换线段是对称的（确保相互性），并且对端点重新标记是不变的（确保标签对称性）。\n2.  **退化处理（共线/接触）**：方向测试结果为零的情况（共线或端点接触）被明确分类为“非交叉”。让我们为此分析连续性。当四个相关端点变得共线时，会发生从“交叉”到“非交叉”的转变。在这种构型中（例如，$A_1, A_2, B_1, B_2$ 都在一条线上，且线段分开），无论如何分类，线的长度都使得 $(\\sum L_{\\text{crossed}}) - (\\sum L_{\\text{uncrossed}}) = 0$。这确保了在分类发生转变的退化点上，角系数值是连续的。\n3.  **零长度线段**：将零长度线段放入“非交叉”类别，并包含在计算中，确保了其长度（为零）平滑地对总和做出贡献，避免了不连续性。\n4.  **标签对称性**：规则完全基于几何谓词和一致的平局打破规则（例如，字典序），这些都独立于任意的标签顺序。\n因此，该规则是确定性的、无偏的，并被设计为通过在退化点将 $(\\sum L_{\\text{crossed}}) - (\\sum L_{\\text{uncrossed}})$ 设为零来保持连续性。由于它是纯粹几何的，它自动满足相互性和标签对称性。\n**结论：正确。**\n\n**选项D分析**\n该选项建议使用随机抖动。这类似于蒙特卡洛方法。虽然它可能在平均意义上收敛到一个稳定的值，但它不是一个确定性的规则。对于相同的输入，每次运行都会产生不同的结果。这不符合对鲁棒、确定性计算程序的要求。此外，它不能保证严格满足相互性和连续性，只可能在统计意义上满足。最后，丢弃零长度线段会引入不连续性。\n**结论：不正确。**",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}