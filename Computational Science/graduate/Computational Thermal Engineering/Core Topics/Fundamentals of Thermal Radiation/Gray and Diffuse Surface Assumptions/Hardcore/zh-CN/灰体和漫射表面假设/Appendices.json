{
    "hands_on_practices": [
        {
            "introduction": "本练习至关重要。它要求你从第一性原理出发，为一个简单的双表面闭合系统推导辐射换热的控制方程。通过比较直接矩阵求解法和巧妙的电阻网络类比法，你将对辐射度、发射率和几何构型如何共同决定热通量获得深刻而直观的理解()。",
            "id": "3958654",
            "problem": "考虑两个大的、平行的、等温的、不透明的板，标记为表面 $1$ 和表面 $2$，它们隔着真空间隙相对。它们之间的介质是非参与性的（无吸收、发射或散射），且表面是灰体和漫射的。每个板只完全看到另一个板（即角系数 $F_{12} = 1$，且没有辐射逸出这个双表面系统）。板的面积均为 $A$，发射率分别为 $\\epsilon_{1}$ 和 $\\epsilon_{2}$，绝对温度分别为 $T_{1}$ 和 $T_{2}$。设斯蒂芬-玻尔兹曼常数用 $\\sigma$ 表示，表面 $i$ 的黑体发射本领为 $E_{b,i} = \\sigma T_{i}^{4}$。\n\n仅从表面能量守恒、灰体漫射表面的辐射出射度和辐射照度的定义以及角系数关系出发，完成以下任务：\n\n1. 为未知辐射出射度 $J_{1}$ 和 $J_{2}$ 建立两个耦合线性方程。\n2. 通过直接求解这些方程，得到 $J_{1}$ 和 $J_{2}$ 的闭式表达式。\n3. 独立地，利用表面热阻和空间热阻为这个双表面系统构建辐射网络类比，并推导从表面 $1$ 到表面 $2$ 的净辐射换热率 $Q$。\n4. 证明网络法得到的 $Q$ 结果与从辐射出射度解法得到的结果相同，并且 $J_{1}$ 和 $J_{2}$ 的两个表达式与相同的 $Q$ 相符。\n\n以单行矩阵的形式给出最终答案，其中包含用 $\\epsilon_{1}$、$\\epsilon_{2}$、$\\sigma$、$T_{1}$、$T_{2}$ 和 $A$ 表示的三个闭式表达式 $(J_{1}, J_{2}, Q)$。不需要四舍五入。最终表达式中不包含单位。",
            "solution": "该问题具有科学依据，提法明确且客观，为辐射换热中的一个标准问题提供了一套完整且一致的已知条件。因此，该问题是有效的。解题过程将系统地完成四个要求的任务。\n\n分析从两个不透明、漫射、灰体表面组成的系统进行辐射交换的第一性原理开始。这两个表面标记为 $1$ 和 $2$，其面积分别为 $A_1 = A_2 = A$，发射率分别为 $\\epsilon_1$ 和 $\\epsilon_2$，并分别保持在绝对温度 $T_1$ 和 $T_2$。\n\n表面 $i$ 的辐射出射度 $J_i$ 定义为离开该表面的总辐射能流密度。对于不透明、漫射、灰体表面，它是发射和反射的辐射之和：\n$$ J_i = E_i + \\rho_i G_i $$\n其中 $E_i$ 是发射本领，$\\rho_i$ 是反射率，而 $G_i$ 是辐射照度（入射的辐射能流密度）。发射本领为 $E_i = \\epsilon_i E_{b,i}$，其中 $E_{b,i} = \\sigma T_i^4$ 是黑体发射本领。对于不透明表面，入射辐射的能量守恒要求吸收率 $\\alpha_i$ 和反射率 $\\rho_i$ 之和为1，即 $\\alpha_i + \\rho_i = 1$。对于灰体表面，发射率等于吸收率，即 $\\epsilon_i = \\alpha_i$。因此，反射率为 $\\rho_i = 1 - \\epsilon_i$。将这些关系代入辐射出射度的定义，得到：\n$$ J_i = \\epsilon_i E_{b,i} + (1 - \\epsilon_i) G_i $$\n表面 $i$ 上的辐射照度 $G_i$ 是系统中所有表面辐射出射度的总和，并按各自的角系数加权。对于一个由 $N$ 个表面组成的系统：\n$$ G_i = \\sum_{j=1}^{N} F_{ji} J_j $$\n在这个双表面系统中，两个板是大的平行板，所以每个表面只看到另一个表面。这意味着角系数 $F_{12}=1$ 和 $F_{21}=1$（这与互易关系 $A_1 F_{12} = A_2 F_{21}$ 一致，因为 $A_1=A_2$）。此外，由于表面是平的，它们不能看到自身，所以 $F_{11}=0$ 和 $F_{22}=0$。\n\n表面 $1$ 上的辐射照度仅来自表面 $2$：$G_1 = F_{21} J_2 = (1)J_2 = J_2$。\n表面 $2$ 上的辐射照度仅来自表面 $1$：$G_2 = F_{12} J_1 = (1)J_1 = J_1$。\n\n1. 为 $J_1$ 和 $J_2$ 建立两个耦合线性方程。\n\n将辐射照度的表达式代入每个表面的辐射出射度方程，得到以下方程组。\n\n对于表面 $1$：\n$$ J_1 = \\epsilon_1 E_{b,1} + (1 - \\epsilon_1) G_1 = \\epsilon_1 E_{b,1} + (1 - \\epsilon_1) J_2 $$\n整理成标准线性形式：\n$$ J_1 - (1 - \\epsilon_1) J_2 = \\epsilon_1 E_{b,1} $$\n\n对于表面 $2$：\n$$ J_2 = \\epsilon_2 E_{b,2} + (1 - \\epsilon_2) G_2 = \\epsilon_2 E_{b,2} + (1 - \\epsilon_2) J_1 $$\n整理成标准线性形式：\n$$ -(1 - \\epsilon_2) J_1 + J_2 = \\epsilon_2 E_{b,2} $$\n这两个方程构成了关于未知辐射出射度 $J_1$ 和 $J_2$ 的耦合线性方程组。\n\n2. 求解 $J_1$ 和 $J_2$。\n\n我们求解一个二元线性方程组。从第二个方程，我们将 $J_2$ 用 $J_1$ 表示：\n$$ J_2 = \\epsilon_2 E_{b,2} + (1 - \\epsilon_2) J_1 $$\n将这个 $J_2$ 的表达式代入第一个方程：\n$$ J_1 - (1 - \\epsilon_1) [\\epsilon_2 E_{b,2} + (1 - \\epsilon_2) J_1] = \\epsilon_1 E_{b,1} $$\n$$ J_1 - (1 - \\epsilon_1)\\epsilon_2 E_{b,2} - (1 - \\epsilon_1)(1 - \\epsilon_2) J_1 = \\epsilon_1 E_{b,1} $$\n合并包含 $J_1$ 的项：\n$$ J_1 [1 - (1 - \\epsilon_1)(1 - \\epsilon_2)] = \\epsilon_1 E_{b,1} + (1 - \\epsilon_1)\\epsilon_2 E_{b,2} $$\n$J_1$ 的系数可以简化为：\n$$ 1 - (1 - \\epsilon_1 - \\epsilon_2 + \\epsilon_1 \\epsilon_2) = \\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2 $$\n解出 $J_1$：\n$$ J_1 = \\frac{\\epsilon_1 E_{b,1} + (1 - \\epsilon_1)\\epsilon_2 E_{b,2}}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n根据问题的几何对称性和控制方程，通过交换所有下标 $1$ 和 $2$ 可以得到 $J_2$ 的表达式：\n$$ J_2 = \\frac{\\epsilon_2 E_{b,2} + (1 - \\epsilon_2)\\epsilon_1 E_{b,1}}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n\n3. 使用辐射网络类比法推导净辐射换热率 $Q$。\n\n辐射网络类比将热量传递模拟为流经一系列热阻的电流。每个节点的电位是黑体发射本领 $E_{b,i}$ 或辐射出射度 $J_i$。\n\n对于灰体漫射表面 $i$，表面热阻 $R_{\\text{surf},i}$ 将其黑体电位与其辐射出射度电位联系起来。它由下式给出：\n$$ R_{\\text{surf},i} = \\frac{1 - \\epsilon_i}{\\epsilon_i A_i} $$\n两个表面 $i$ 和 $j$ 之间的空间热阻 $R_{\\text{space},ij}$ 考虑了几何配置（角系数），由下式给出：\n$$ R_{\\text{space},ij} = \\frac{1}{A_i F_{ij}} $$\n对于给定的双表面系统，该网络是一个简单的串联电路：\n$E_{b,1} \\rightarrow R_{\\text{surf},1} \\rightarrow J_1 \\rightarrow R_{\\text{space},12} \\rightarrow J_2 \\rightarrow R_{\\text{surf},2} \\rightarrow E_{b,2}$\n\n各热阻为：\n$R_{\\text{surf},1} = \\frac{1 - \\epsilon_1}{\\epsilon_1 A}$\n$R_{\\text{space},12} = \\frac{1}{A_1 F_{12}} = \\frac{1}{A \\cdot 1} = \\frac{1}{A}$\n$R_{\\text{surf},2} = \\frac{1 - \\epsilon_2}{\\epsilon_2 A}$\n\n网络的总热阻 $R_{\\text{total}}$ 是串联热阻之和：\n$$ R_{\\text{total}} = R_{\\text{surf},1} + R_{\\text{space},12} + R_{\\text{surf},2} = \\frac{1 - \\epsilon_1}{\\epsilon_1 A} + \\frac{1}{A} + \\frac{1 - \\epsilon_2}{\\epsilon_2 A} $$\n$$ R_{\\text{total}} = \\frac{1}{A} \\left( \\frac{1}{\\epsilon_1} - 1 + 1 + \\frac{1}{\\epsilon_2} - 1 \\right) = \\frac{1}{A} \\left( \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1 \\right) $$\n从表面 $1$ 到表面 $2$ 的净换热率 $Q$ 是总势差除以总热阻：\n$$ Q = \\frac{E_{b,1} - E_{b,2}}{R_{\\text{total}}} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{1}{A} \\left( \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1 \\right)} = \\frac{A \\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} $$\n\n4. 证明辐射出射度解法与网络解法的一致性。\n\n首先，我们证明从辐射出射度解法计算出的净热流率与网络法结果相匹配。离开表面 $1$ 的净热流率为 $Q_1 = A_1 (J_1 - G_1)$。由于 $G_1 = J_2$ 且 $A_1=A$：\n$$ Q_1 = A (J_1 - J_2) $$\n代入第2部分中 $J_1$ 和 $J_2$ 的表达式：\n$$ J_1 - J_2 = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} \\left[ (\\epsilon_1 E_{b,1} + (1 - \\epsilon_1)\\epsilon_2 E_{b,2}) - (\\epsilon_2 E_{b,2} + (1 - \\epsilon_2)\\epsilon_1 E_{b,1}) \\right] $$\n$$ J_1 - J_2 = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} [(\\epsilon_1 - \\epsilon_1(1-\\epsilon_2)) E_{b,1} - (\\epsilon_2 - \\epsilon_2(1-\\epsilon_1)) E_{b,2}] $$\n$$ J_1 - J_2 = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} [\\epsilon_1 \\epsilon_2 E_{b,1} - \\epsilon_1 \\epsilon_2 E_{b,2}] = \\frac{\\epsilon_1 \\epsilon_2 (E_{b,1} - E_{b,2})}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n因此，换热率为：\n$$ Q_1 = A (J_1 - J_2) = \\frac{A \\epsilon_1 \\epsilon_2 (E_{b,1} - E_{b,2})}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n通过将分子和分母同除以 $\\epsilon_1 \\epsilon_2$，该表达式可以改写为：\n$$ Q_1 = \\frac{A (E_{b,1} - E_{b,2})}{\\frac{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2}} = \\frac{A (E_{b,1} - E_{b,2})}{\\frac{1}{\\epsilon_2} + \\frac{1}{\\epsilon_1} - 1} $$\n这与从辐射网络类比推导出的净换热率 $Q$ 完全相同。\n\n其次，我们证明 $J_1$ 和 $J_2$ 的表达式与网络法结果一致。根据网络法，换热率 $Q$ 必须等于通过第一个表面热阻的势降：\n$$ Q = \\frac{E_{b,1} - J_1}{R_{\\text{surf},1}} = \\frac{E_{b,1} - J_1}{(1 - \\epsilon_1)/(\\epsilon_1 A)} $$\n解出 $J_1$：\n$$ J_1 = E_{b,1} - Q \\cdot R_{\\text{surf},1} = E_{b,1} - \\frac{A (E_{b,1} - E_{b,2})}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} \\cdot \\frac{1 - \\epsilon_1}{\\epsilon_1 A} $$\n$$ J_1 = E_{b,1} - \\frac{(E_{b,1} - E_{b,2})(\\frac{1}{\\epsilon_1} - 1)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} $$\n将其通分：\n$$ J_1 = \\frac{E_{b,1}(\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1) - (E_{b,1} - E_{b,2})(\\frac{1}{\\epsilon_1} - 1)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} $$\n展开分子：\n$$ \\frac{E_{b,1}}{\\epsilon_1} + \\frac{E_{b,1}}{\\epsilon_2} - E_{b,1} - \\frac{E_{b,1}}{\\epsilon_1} + E_{b,1} + \\frac{E_{b,2}}{\\epsilon_1} - E_{b,2} = \\frac{E_{b,1}}{\\epsilon_2} + \\frac{E_{b,2}}{\\epsilon_1} - E_{b,2} = \\frac{\\epsilon_1 E_{b,1} + \\epsilon_2 E_{b,2} - \\epsilon_1 \\epsilon_2 E_{b,2}}{\\epsilon_1 \\epsilon_2} $$\n分母是：\n$$ \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1 = \\frac{\\epsilon_2 + \\epsilon_1 - \\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2} $$\n分子除以分母得到：\n$$ J_1 = \\frac{\\epsilon_1 E_{b,1} + \\epsilon_2 E_{b,2}(1 - \\epsilon_1)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n这个表达式与第2部分得到的 $J_1$ 结果完全相同。对 $J_2 = E_{b,2} + Q \\cdot R_{\\text{surf},2}$ 进行类似的推导可以证实 $J_2$ 的表达式。两种方法完全一致。\n\n以给定变量表示的 $J_1$、$J_2$ 和 $Q$ 的最终表达式如下。\n$J_1 = \\frac{\\sigma(\\epsilon_1 T_1^4 + (1 - \\epsilon_1)\\epsilon_2 T_2^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$\n$J_2 = \\frac{\\sigma(\\epsilon_2 T_2^4 + (1 - \\epsilon_2)\\epsilon_1 T_1^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$\n$Q = \\frac{A \\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sigma(\\epsilon_1 T_1^4 + (1 - \\epsilon_1)\\epsilon_2 T_2^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}  \\frac{\\sigma(\\epsilon_2 T_2^4 + (1 - \\epsilon_2)\\epsilon_1 T_1^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}  \\frac{A \\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} \\end{pmatrix} } $$"
        },
        {
            "introduction": "计算模型的准确性取决于其输入的质量。本练习将探讨任何闭合腔体分析中一个关键的验证步骤：确保几何角系数遵循基本的能量守恒定律()。你将使用求和法则来量化一个预先计算好的角系数矩阵中的数值误差，这是在处理蒙特卡罗射线追踪等方法产生的结果时的一项常见任务。",
            "id": "3958631",
            "problem": "考虑一个由四个不透明、等温、具有灰体和漫射辐射特性的表面组成的封闭、真空罩壳。内部介质不参与辐射（无吸收、发射或散射），并且每个表面都根据兰伯特余弦定律进行漫射发射和反射。一次数值蒙特卡罗(MC)射线追踪计算得到了以下从表面 $i$ 到表面 $j$ 的方向角系数集合，并汇总成一个 $4 \\times 4$ 矩阵\n$$\n\\mathbf{F} \\equiv \\left[F_{ij}\\right] \\;=\\;\n\\begin{pmatrix}\n0.0002  0.515  0.245  0.237 \\\\\n0.514  0.0003  0.246  0.237 \\\\\n0.350  0.349  0.0001  0.290 \\\\\n0.351  0.349  0.290  0.0002\n\\end{pmatrix}.\n$$\n从基于几何和漫射发射的角系数定义出发，并引用封闭、不参与辐射的罩壳的辐射能守恒定律，推导离开任意表面的角系数集合必须满足的必要条件。使用该条件为每个 $i \\in \\{1,2,3,4\\}$ 定义一个闭合残差 $r_i$，其值为 1 与离开表面 $i$ 的计算角系数之和的差值，然后构建欧几里得（二范数）一致性度量\n$$\n\\|\\mathbf{r}\\|_{2} \\;=\\; \\sqrt{\\sum_{i=1}^{4} r_{i}^{2}}.\n$$\n计算给定 $\\mathbf{F}$ 的 $\\|\\mathbf{r}\\|_{2}$。将最终答案表示为一个无量纲数，并将其四舍五入到四位有效数字。",
            "solution": "首先验证问题以确保其科学上合理、提法得当且客观。\n\n**步骤1：提取已知条件**\n- 定义了一个罩壳，它是封闭、真空的，并由四（4）个不透明、等温的表面组成。\n- 表面的辐射特性是灰体和漫射。\n- 内部介质不参与辐射。\n- 表面根据兰伯特余弦定律进行漫射发射和反射。\n- 提供了一个通过计算生成的角系数矩阵 $\\mathbf{F}$：\n$$\n\\mathbf{F} \\equiv \\left[F_{ij}\\right] \\;=\\;\n\\begin{pmatrix}\n0.0002  0.515  0.245  0.237 \\\\\n0.514  0.0003  0.246  0.237 \\\\\n0.350  0.349  0.0001  0.290 \\\\\n0.351  0.349  0.290  0.0002\n\\end{pmatrix}\n$$\n- 每个表面 $i$ 的闭合残差定义为 $r_i = 1 - \\sum_{j=1}^{4} F_{ij}$。\n- 欧几里得一致性度量定义为 $\\|\\mathbf{r}\\|_{2} = \\sqrt{\\sum_{i=1}^{4} r_{i}^{2}}$。\n- 任务是推导角系数的必要条件，计算残差 $r_i$，然后计算 $\\|\\mathbf{r}\\|_{2}$，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于罩壳内辐射传热的基本原理，特别是角系数的概念及其性质。角系数的求和法则是封闭系统能量守恒的直接结果。使用蒙特卡罗方法计算这些系数以及随后对数值误差的分析是计算热工学中的标准实践。\n- **提法得当性**：该问题提供了所有必要的数据（矩阵 $\\mathbf{F}$）和一个清晰、明确的计算程序。存在一个唯一、稳定且有意义的数值解。所提供矩阵的行和不完全等于1，这对于一个数值结果是预料之中的，并且正是这个问题要求量化这种差异的基础。\n- **客观性**：该问题以精确、正式的语言陈述，不含任何主观或基于意见的论断。\n\n**步骤3：结论与行动**\n- 该问题在科学上合理、提法得当且客观。它是**有效的**。现在开始求解过程。\n\n**角系数求和法则的推导**\n角系数 $F_{ij}$ 定义为离开表面 $i$ 的总辐射能中直接到达表面 $j$ 的部分。假设表面是漫射发射体和反射体，这意味着离开表面的辐射强度在所有方向上都是均匀的。\n\n对于一个由 $N$ 个表面（本例中 $N=4$）组成的封闭罩壳，从表面 $i$ 发出的任何辐射最终都必须被罩壳内的某个表面所截获。这包括如果表面 $i$ 是凹面（即 $F_{ii}  0$），它有可能截获自身的辐射。这一陈述是辐射场能量守恒的直接表达。\n\n由于 $F_{ij}$ 代表离开表面 $i$ 并投射到表面 $j$ 的能量分数，因此这些分数在所有可能的接收表面 $j=1, 2, ..., N$ 上的总和必须等于离开表面 $i$ 的全部能量。因此，从给定表面 $i$ 到罩壳中所有其他表面 $j$（包括其自身）的所有角系数之和必须恰好等于1。这被称为角系数的求和法则或闭合关系式：\n$$\n\\sum_{j=1}^{N} F_{ij} = 1\n$$\n对于所描述的4表面罩壳的特定情况，此条件必须对每个表面 $i \\in \\{1, 2, 3, 4\\}$ 成立：\n$$\n\\sum_{j=1}^{4} F_{ij} = F_{i1} + F_{i2} + F_{i3} + F_{i4} = 1\n$$\n这是封闭罩壳中离开任意表面的角系数集合必须满足的必要条件。\n\n**残差和一致性度量的计算**\n所提供的角系数矩阵 $\\mathbf{F}$ 是数值蒙特卡罗模拟的结果，因此会存在统计误差。求和法则提供了一个基准，可以用来检验数值结果的准确性。闭合残差 $r_i$ 定义为每个表面 $i$ 对此法则的偏离：\n$$\nr_i = 1 - \\sum_{j=1}^{4} F_{ij}\n$$\n我们现在计算给定矩阵 $\\mathbf{F}$ 的每一行的和以及相应的残差 $r_i$。\n\n对于表面 $i=1$：\n$$\n\\sum_{j=1}^{4} F_{1j} = 0.0002 + 0.515 + 0.245 + 0.237 = 0.9972\n$$\n$$\nr_1 = 1 - 0.9972 = 0.0028\n$$\n\n对于表面 $i=2$：\n$$\n\\sum_{j=1}^{4} F_{2j} = 0.514 + 0.0003 + 0.246 + 0.237 = 0.9973\n$$\n$$\nr_2 = 1 - 0.9973 = 0.0027\n$$\n\n对于表面 $i=3$：\n$$\n\\sum_{j=1}^{4} F_{3j} = 0.350 + 0.349 + 0.0001 + 0.290 = 0.9891\n$$\n$$\nr_3 = 1 - 0.9891 = 0.0109\n$$\n\n对于表面 $i=4$：\n$$\n\\sum_{j=1}^{4} F_{4j} = 0.351 + 0.349 + 0.290 + 0.0002 = 0.9902\n$$\n$$\nr_4 = 1 - 0.9902 = 0.0098\n$$\n\n欧几里得一致性度量 $\\|\\mathbf{r}\\|_{2}$ 定义为这些残差平方和的平方根：\n$$\n\\|\\mathbf{r}\\|_{2} = \\sqrt{\\sum_{i=1}^{4} r_{i}^{2}} = \\sqrt{r_1^2 + r_2^2 + r_3^2 + r_4^2}\n$$\n代入计算出的残差值：\n$$\n\\|\\mathbf{r}\\|_{2} = \\sqrt{(0.0028)^2 + (0.0027)^2 + (0.0109)^2 + (0.0098)^2}\n$$\n$$\n\\|\\mathbf{r}\\|_{2} = \\sqrt{0.00000784 + 0.00000729 + 0.00011881 + 0.00009604}\n$$\n$$\n\\|\\mathbf{r}\\|_{2} = \\sqrt{0.00022998}\n$$\n$$\n\\|\\mathbf{r}\\|_{2} \\approx 0.01516509...\n$$\n题目要求答案四舍五入到四位有效数字。第一个非零数字是 $1$，所以第四位有效数字是 $6$。下一位数字是 $5$，因此我们向上取整。\n$$\n\\|\\mathbf{r}\\|_{2} \\approx 0.01517\n$$\n这个无量纲数提供了相对于基本能量守恒定律的、计算角系数中数值误差的总体度量。",
            "answer": "$$\n\\boxed{0.01517}\n$$"
        },
        {
            "introduction": "灰体-漫射模型中的“漫射”部分是一个强大的简化，但它并非总是物理上准确的，特别是对于抛光或光滑的表面。这个高级练习将挑战你构建一个定量的反例()。通过将漫射模型预测的反射能量分布与一个更真实的镜面反射模型（BRDF）进行比较，你将学会批判性地评估这一核心假设在何种情况下以及为何会失效。",
            "id": "3958652",
            "problem": "考虑一个置于真空罩中的不透明、等温、面积为 $A$ 的抛光表面片元。一束辐照度为 $G_0$ 的单色准直光束垂直入射到该片元上，因此入射方向 $\\boldsymbol{\\omega}_i$ 与表面外法线 $\\boldsymbol{n}$ 重合。假设该表面为灰体，其方向-半球反射率 $\\rho \\in (0,1)$ 在所关注的窄波段内与波长无关。\n\n一个具有小接收立体角 $\\Delta \\Omega$ 的探测器被放置在与法线 $\\boldsymbol{n}$ 成极角 $\\theta_d \\in (0,\\pi/2)$ 的方向 $\\boldsymbol{\\omega}_o$ 上观测该片元；假设系统具有轴对称性，因此方位角无关紧要。探测器距离足够远，使得该片元可视为局部平面，并且接收立体角 $\\Delta \\Omega$ 足够小，可以忽略 $\\Delta \\Omega$ 内部的角度变化。角度以弧度为单位。\n\n使用辐射传输基本原理，定义辐亮度 $L$ 和辐照度 $E$，并回顾对于任何其散射特性可由双向反射分布函数 (BRDF) 完全表征的表面，出射辐亮度满足 $L_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,E_i(\\boldsymbol{\\omega}_i)$，并带有能量守恒约束 $\\int_{\\Omega^{+}} f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,\\cos\\theta_o\\,\\mathrm{d}\\Omega_o = \\rho$，其中 $\\Omega^{+}$ 表示出射半球，$\\theta_o$ 是 $\\boldsymbol{\\omega}_o$ 相对于 $\\boldsymbol{n}$ 的极角。\n\n现在，通过使用一个围绕镜面反射方向的Phong型瓣的归一化纯镜面BRDF来对抛光表面建模，构建一个对漫反射假设的反例。对于垂直入射，镜面反射方向与 $\\boldsymbol{n}$ 重合；假设BRDF的形式为\n$$\nf_r^{\\mathrm{spec}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n},\n$$\n其中 $n>0$ 是镜面指数。相比之下，漫反射（朗伯）假设对应的BRDF为 $f_r^{\\mathrm{diff}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho/\\pi$。\n\n仅使用上述定义和能量守恒定律，推导在漫反射假设下预测的探测器功率 $P_{\\mathrm{diff}}$ 和在给定几何结构下镜面BRDF对应的物理上正确的探测器功率 $P_{\\mathrm{spec}}$，并获得比率的解析表达式\n$$\nR(\\theta_d,n) = \\frac{P_{\\mathrm{diff}}}{P_{\\mathrm{spec}}}.\n$$\n你的最终答案必须是 $R(\\theta_d,n)$ 的单个闭式解析表达式，其中角度以弧度为单位。不得代入任何数值，也无需进行四舍五入。从辐射传输的第一性原理和灰体表面能量守恒约束出发，解释每一步，并证明镜面BRDF归一化的合理性。最后明确给出 $R(\\theta_d,n)$。",
            "solution": "首先对问题陈述的科学合理性、完整性和一致性进行验证。\n\n**步骤1：提取已知条件**\n- 表面：不透明、等温、抛光、面积为 $A$。\n- 环境：真空罩。\n- 入射辐射：单色准直光束，辐照度为 $G_0$。\n- 入射方向：垂直，$\\boldsymbol{\\omega}_i$ 与表面法线 $\\boldsymbol{n}$ 重合。\n- 表面特性：灰体，方向-半球反射率 $\\rho \\in (0,1)$。\n- 探测器：小接收立体角 $\\Delta \\Omega$，在与法线 $\\boldsymbol{n}$ 成极角 $\\theta_d \\in (0,\\pi/2)$ 的方向上观测表面。由于轴对称性，方位角无关紧要。\n- 辐射传输关系：$L_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,E_i(\\boldsymbol{\\omega}_i)$。\n- BRDF的能量守恒：$\\int_{\\Omega^{+}} f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,\\cos\\theta_o\\,\\mathrm{d}\\Omega_o = \\rho$，其中 $\\Omega^{+}$ 是出射半球。\n- 镜面BRDF模型（对于垂直入射）：$f_r^{\\mathrm{spec}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n}$，其中 $n>0$。\n- 漫反射（朗伯）BRDF模型：$f_r^{\\mathrm{diff}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho/\\pi$。\n- 目标：推导比率 $R(\\theta_d,n) = P_{\\mathrm{diff}}/P_{\\mathrm{spec}}$。\n\n**步骤2：验证**\n该问题提法恰当，并以辐射传热原理为科学基础。辐亮度、辐照度和双向反射分布函数（BRDF）的定义都是标准的。Phong型BRDF是镜面反射的常用经验模型，而朗伯模型是完美漫反射表面的定义。能量守恒约束是一条基本物理定律。所有必要的变量和函数形式都已提供，足以推导出所要求的比率。问题要求对BRDF的归一化进行论证，这是检验物理一致性的必要步骤。此检验将在下面的求解过程中进行。该问题没有歧义、矛盾和事实错误。\n\n**步骤3：结论**\n该问题有效。将推导求解。\n\n**推导**\n\n分析从辐射量的基本定义开始。辐亮度，记为 $L$，定义为单位投影面积、单位立体角内的辐射功率，单位为 $\\mathrm{W} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{sr}^{-1}$。辐照度，记为 $E$，定义为入射到单位表面积上的辐射功率，单位为 $\\mathrm{W} \\cdot \\mathrm{m}^{-2}$。\n\n一个接收立体角为 $\\Delta \\Omega$ 的探测器观测面积为 $A$ 的表面片元所接收到的辐射功率 $P$ 由以下三者之积给出：表面在探测器方向上的出射辐亮度 $L_o(\\boldsymbol{\\omega}_o)$，表面垂直于观测方向的投影面积 $A \\cos\\theta_d$，以及探测器所对的立体角 $\\Delta \\Omega$。\n$$\nP = L_o(\\boldsymbol{\\omega}_o) (A \\cos\\theta_d) \\Delta\\Omega\n$$\n此处，$\\boldsymbol{\\omega}_o$ 是朝向探测器的方向，$\\theta_d$ 是该方向相对于表面法线 $\\boldsymbol{n}$ 的极角。\n\n问题陈述指出，出射辐亮度 $L_o$ 通过BRDF $f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o)$ 与入射辐照度 $E_i$ 相关：\n$$\nL_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o) E_i(\\boldsymbol{\\omega}_i)\n$$\n对于辐照度为 $G_0$ 的准直光束垂直入射到表面，入射辐照度 $E_i$ 就是 $G_0$。入射方向 $\\boldsymbol{\\omega}_i$ 沿着 $\\boldsymbol{n}$，因此入射极角为 $\\theta_i=0$。因此，在探测器方向 $\\boldsymbol{\\omega}_o$ 上的出射辐亮度为：\n$$\nL_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o) G_0\n$$\n将此代入探测器功率的表达式，得到一个通用公式：\n$$\nP = G_0 A \\Delta\\Omega f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o) \\cos\\theta_d\n$$\n\n首先，我们必须证明所给定的镜面BRDF $f_r^{\\mathrm{spec}}$ 归一化的合理性。能量守恒原理要求方向-半球反射率 $\\rho$ 等于BRDF乘以出射极角的余弦在整个出射方向半球 $\\Omega^{+}$ 上的积分。\n$$\n\\rho = \\int_{\\Omega^{+}} f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,\\cos\\theta_o\\,\\mathrm{d}\\Omega_o\n$$\n球坐标系中的微分立体角为 $\\mathrm{d}\\Omega_o = \\sin\\theta_o\\,\\mathrm{d}\\theta_o\\,\\mathrm{d}\\phi_o$，其中 $\\phi_o$ 是方位角。对于给定的镜面BRDF，我们进行积分：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} \\left( \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n} \\right) \\cos\\theta_o \\sin\\theta_o\\,\\mathrm{d}\\theta_o\\,\\mathrm{d}\\phi_o\n$$\n方位角 $\\phi_o$ 从 $0$ 到 $2\\pi$ 的积分得到一个因子 $2\\pi$。\n$$\n= 2\\pi \\cdot \\rho\\,\\frac{n+2}{2\\pi} \\int_{0}^{\\pi/2} (\\cos\\theta_o)^{n+1} \\sin\\theta_o\\,\\mathrm{d}\\theta_o = \\rho(n+2) \\int_{0}^{\\pi/2} (\\cos\\theta_o)^{n+1} \\sin\\theta_o\\,\\mathrm{d}\\theta_o\n$$\n为了求解余下的积分，我们使用换元法，令 $u = \\cos\\theta_o$，则 $\\mathrm{d}u = -\\sin\\theta_o\\,\\mathrm{d}\\theta_o$。积分上下限从 $\\theta_o=0$ 变为 $u=1$，从 $\\theta_o=\\pi/2$ 变为 $u=0$。\n$$\n= \\rho(n+2) \\int_{1}^{0} u^{n+1} (-\\mathrm{d}u) = \\rho(n+2) \\int_{0}^{1} u^{n+1} \\mathrm{d}u = \\rho(n+2) \\left[ \\frac{u^{n+2}}{n+2} \\right]_{0}^{1} = \\rho(n+2) \\left( \\frac{1}{n+2} - 0 \\right) = \\rho\n$$\n该镜面BRDF被正确归一化，满足能量守恒约束。\n\n现在我们可以计算漫反射和镜面反射两种情况下的探测器功率。\n\n**情况1：漫反射表面 ($P_{\\mathrm{diff}}$)**\n漫反射（朗伯）BRDF对所有出射方向都是常数：$f_r^{\\mathrm{diff}} = \\rho/\\pi$。出射辐亮度也与方向无关，$L_{o,\\mathrm{diff}} = (\\rho/\\pi)G_0$。探测器测得的功率为：\n$$\nP_{\\mathrm{diff}} = L_{o,\\mathrm{diff}} (A \\cos\\theta_d) \\Delta\\Omega = \\left(\\frac{\\rho}{\\pi} G_0\\right) A \\cos\\theta_d \\Delta\\Omega = \\frac{\\rho G_0 A \\Delta\\Omega}{\\pi} \\cos\\theta_d\n$$\n\n**情况2：镜面反射表面 ($P_{\\mathrm{spec}}$)**\n镜面BRDF由 $f_r^{\\mathrm{spec}} = \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n}$ 给出。探测器从极角 $\\theta_d$ 观测表面，因此我们令 $\\theta_o = \\theta_d$。在探测器方向上的出射辐亮度为：\n$$\nL_{o,\\mathrm{spec}}(\\theta_d) = \\left( \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_d\\big)^{n} \\right) G_0\n$$\n探测器测得的功率为：\n$$\nP_{\\mathrm{spec}} = L_{o,\\mathrm{spec}}(\\theta_d) (A \\cos\\theta_d) \\Delta\\Omega = \\left( \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_d\\big)^{n} G_0 \\right) A \\cos\\theta_d \\Delta\\Omega\n$$\n$$\nP_{\\mathrm{spec}} = \\frac{\\rho G_0 A \\Delta\\Omega}{2\\pi} (n+2) (\\cos\\theta_d)^{n+1}\n$$\n\n**比率计算**\n最后，我们计算比率 $R(\\theta_d,n) = P_{\\mathrm{diff}}/P_{\\mathrm{spec}}$。\n$$\nR(\\theta_d,n) = \\frac{P_{\\mathrm{diff}}}{P_{\\mathrm{spec}}} = \\frac{\\frac{\\rho G_0 A \\Delta\\Omega}{\\pi} \\cos\\theta_d}{\\frac{\\rho G_0 A \\Delta\\Omega}{2\\pi} (n+2) (\\cos\\theta_d)^{n+1}}\n$$\n公因子 $\\rho$、 $G_0$、 $A$ 和 $\\Delta\\Omega$ 消去。\n$$\nR(\\theta_d,n) = \\frac{\\frac{1}{\\pi} \\cos\\theta_d}{\\frac{1}{2\\pi} (n+2) (\\cos\\theta_d)^{n+1}} = \\frac{1}{\\pi} \\cos\\theta_d \\cdot \\frac{2\\pi}{(n+2) (\\cos\\theta_d)^{n+1}}\n$$\n简化表达式：\n$$\nR(\\theta_d,n) = \\frac{2 \\cos\\theta_d}{(n+2) (\\cos\\theta_d)^{n+1}} = \\frac{2}{(n+2) (\\cos\\theta_d)^{n}}\n$$\n此表达式给出了在错误的漫反射假设下探测到的功率与根据更符合物理实际的抛光表面镜面模型探测到的功率之比。\n比率 $R(\\theta_d, n)$ 的最终结果是：\n$$\nR(\\theta_d,n) = \\frac{2}{(n+2)(\\cos\\theta_d)^n}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{(n+2) (\\cos\\theta_d)^{n}}}\n$$"
        }
    ]
}