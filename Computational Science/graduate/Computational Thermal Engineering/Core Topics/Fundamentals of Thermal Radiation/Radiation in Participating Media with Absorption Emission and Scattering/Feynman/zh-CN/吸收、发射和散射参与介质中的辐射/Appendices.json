{
    "hands_on_practices": [
        {
            "introduction": "在解决复杂的辐射传递问题之前，我们必须首先掌握描述介质如何与辐射相互作用的基本参数。本练习侧重于消光系数 ($\\beta$)、单次散射反照率 ($\\omega$) 和光子平均自由程 ($\\ell$)。通过从更基本的吸收和散射系数计算这些值，您将对它们的物理意义以及它们如何决定辐射传输的性质（例如多次散射的主导地位）建立起物理直觉 。",
            "id": "3980455",
            "problem": "一个空间均匀、等温、具有各向同性散射的灰体参与介质，其特性由吸收系数 $\\,\\kappa\\,$ 和散射系数 $\\,\\sigma_{s}\\,$ 决定。考虑一个稳态辐射场，其中辐射强度与频率无关。从辐射传输方程 (RTE) 以及吸收、发射和散射的核心定义出发，推导光子的消光系数 $\\,\\beta\\,$、单次散射反照率 $\\,\\omega\\,$ 和平均自由程 $\\,\\ell\\,$ 的表达式。然后，对于 $\\,\\kappa=0.3\\,\\mathrm{m}^{-1}\\,$ 和 $\\,\\sigma_{s}=0.7\\,\\mathrm{m}^{-1}\\,$，计算这些量的值。将您的数值答案四舍五入到四位有效数字。将 $\\,\\beta\\,$ 以 $\\mathrm{m}^{-1}$ 为单位表示，$\\,\\omega\\,$ 为无量纲量，$\\,\\ell\\,$ 以 $\\mathrm{m}$ 为单位表示。最后，简要讨论计算出的 $\\,\\omega\\,$ 和 $\\,\\ell\\,$ 对于特征长度尺度与 $\\,\\ell\\,$ 相当或更大的区域中多次散射的发生有何影响；除 $\\,\\beta\\,$, $\\,\\omega\\,$ 和 $\\,\\ell\\,$ 外，不要计算任何其他数值。",
            "solution": "所述问题具有科学依据，提法得当，客观，并包含获得唯一解所需的所有信息。这是辐射传热领域的一个标准问题。因此，该问题被认为是有效的，并将提供完整的解答。\n\n分析从稳态下灰体参与介质的辐射传输方程 (RTE) 开始。沿着特定方向 $\\hat{s}$ 的路径长度 $s$，RTE 将辐射强度 $I$ 的变化描述为衰减（吸收和出射散射）与增强（发射和入射散射）之间的平衡。对于给定的灰体、等温、各向同性散射介质的条件，RTE 为：\n$$\n\\frac{dI}{ds} = -\\kappa I - \\sigma_{s} I + \\kappa I_{b} + \\frac{\\sigma_{s}}{4\\pi} \\int_{4\\pi} I(\\hat{s}') d\\Omega'\n$$\n此处，$\\kappa$ 是吸收系数，$\\sigma_{s}$ 是散射系数，$I_{b}$ 是介质温度下的黑体辐射强度（因为介质是灰体且等温），积分项表示来自所有其他方向 $\\hat{s}'$ 在整个 $4\\pi$ 球面度立体角内的入射散射。对于各向同性散射，散射相函数为1。\n\n辐射强度 $I$ 从原始光束方向的衰减由等式右侧的前两项决定：$-\\kappa I$ 和 $-\\sigma_{s} I$。它们分别表示由于吸收和从光束中散射出去而导致的单位体积、单位立体角内的能量损失。\n\n**1. 消光系数, $\\beta$**\n辐射的总衰减是吸收和散射效应的总和。消光系数，用 $\\beta$ 表示，定义为光子在单位路径长度上发生相互作用（吸收或散射）的总概率。因此，它是吸收系数和散射系数之和。\n$$\n\\beta = \\kappa + \\sigma_{s}\n$$\n该系数表示单位长度上光束强度的总衰减率。因此，RTE 中的衰减项可以写为 $-\\beta I = -(\\kappa + \\sigma_{s})I$。\n\n**2. 单次散射反照率, $\\omega$**\n单次散射反照率，用 $\\omega$ 表示，是一个无量纲参数，用于量化散射相对于总消光的相对重要性。它定义为散射系数与消光系数之比。\n$$\n\\omega = \\frac{\\sigma_{s}}{\\beta} = \\frac{\\sigma_{s}}{\\kappa + \\sigma_{s}}\n$$\n在物理上，$\\omega$ 表示光子与物质相互作用事件是散射事件而非吸收事件的概率。反照率 $\\omega=0$ 表示纯吸收介质，而反照率 $\\omega=1$ 表示纯散射介质。\n\n**3. 平均自由程, $\\ell$**\n光子的平均自由程，用 $\\ell$ 表示，是光子在与粒子相互作用（即被吸收或散射）之前在介质中行进的平均距离。这个统计量是消光系数的倒数，而消光系数表示单位距离内的相互作用概率。\n$$\n\\ell = \\frac{1}{\\beta} = \\frac{1}{\\kappa + \\sigma_{s}}\n$$\n\n**数值计算**\n问题给出了吸收系数和散射系数的以下数值：\n$\\kappa = 0.3\\,\\mathrm{m}^{-1}$\n$\\sigma_{s} = 0.7\\,\\mathrm{m}^{-1}$\n\n现在我们可以计算 $\\beta$、$\\omega$ 和 $\\ell$ 的值。\n\n首先，计算消光系数 $\\beta$：\n$$\n\\beta = \\kappa + \\sigma_{s} = 0.3\\,\\mathrm{m}^{-1} + 0.7\\,\\mathrm{m}^{-1} = 1.0\\,\\mathrm{m}^{-1}\n$$\n四舍五入到四位有效数字，我们得到 $\\beta = 1.000\\,\\mathrm{m}^{-1}$。\n\n接下来，计算单次散射反照率 $\\omega$：\n$$\n\\omega = \\frac{\\sigma_{s}}{\\kappa + \\sigma_{s}} = \\frac{0.7\\,\\mathrm{m}^{-1}}{0.3\\,\\mathrm{m}^{-1} + 0.7\\,\\mathrm{m}^{-1}} = \\frac{0.7}{1.0} = 0.7\n$$\n四舍五入到四位有效数字，得到 $\\omega = 0.7000$。\n\n最后，计算平均自由程 $\\ell$：\n$$\n\\ell = \\frac{1}{\\beta} = \\frac{1}{1.000\\,\\mathrm{m}^{-1}} = 1.0\\,\\mathrm{m}\n$$\n四舍五入到四位有效数字，我们得到 $\\ell = 1.000\\,\\mathrm{m}$。\n\n**关于多次散射的讨论**\n计算出的值为 $\\omega = 0.7000$ 和 $\\ell = 1.000\\,\\mathrm{m}$。\n单次散射反照率 $\\omega = 0.7000$ 显著大于零。这个值意味着在该介质中，散射是光子相互作用的主要机制，相互作用事件是散射的概率为 $70\\%$，是吸收的概率为 $30\\%$。高散射概率是发生多次散射的必要条件，因为光子很可能在初次相互作用后存活下来，并继续在介质中传播。\n\n平均自由程 $\\ell = 1.000\\,\\mathrm{m}$ 是光子与物质相互作用的特征长度尺度。对于一个特征几何长度尺度 $L$ 与 $\\ell$ 相当或更大（即 $L \\gtrsim \\ell$）的介质，穿过该介质的光子极有可能经历至少一次相互作用。这样一个区域的光学厚度 $\\tau = \\beta L$ 将在 $1$ 或更大的数量级。\n\n当这两个条件——高的单次散射反照率和光学厚介质（$L \\gtrsim \\ell$）——同时满足时，多次散射成为一种重要的能量传输模式。进入或在此类区域内发射的光子很可能会在最终被吸收或逃离该区域之前，沿着类似随机游走的路径进行多次散射。因此，高 $\\omega$ 和系统尺寸 $L \\ge \\ell$ 的组合确保了辐射场受到许多散射事件累积效应的强烈影响，这使得单次散射近似无效，并且需要对考虑了积分项的 RTE 进行完整求解。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.000  0.7000  1.000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "许多现实世界的应用都涉及弯曲几何形状，而非简单的一维平板，本练习将解决球体内辐射这一经典问题。您需要首先确定球体内光线的几何路径长度，然后沿该路径对辐射传递方程 (RTE) 进行积分，从而推导出辐射强度和热通量。这项练习可以锻炼您在非笛卡尔坐标系中应用 RTE 的技能，并为一个纯发射和吸收介质（一种常见且重要的情景）提供从第一性原理出发的完整解决方案 。",
            "id": "3980446",
            "problem": "考虑一个半径为 $R$ 的稳态、灰体、球对称参与性介质，其折射率 $n=1$，吸收系数 $\\kappa$ 在空间上均匀（为常数），且无散射。该介质处于均匀温度 $T$ 的局部热力学平衡状态，因此其各向同性发射源为黑体方向强度 $I_{b}=\\sigma T^{4}/\\pi$，其中 $\\sigma$ 是 Stefan–Boltzmann 常数。该球体被真空包围，且没有外部辐照；因此，在外边界上所有入射方向的入射方向强度均为零。\n\n从纯发射-吸收介质的辐射传输方程（RTE）出发，推导在任意内部位置（径向坐标 $r\\in[0,R]$，方向余弦 $\\mu=\\cos\\theta$ 相对于向外径向方向）的方向辐射强度 $I(r,\\mu)$。接下来，推导径向辐射热通量 $q_{r}(r)$ 作为 $I(r,\\mu)$ 的角度积分表达式，并将其特殊化以获得用 $R$、$\\kappa$ 和 $I_{b}$ 表示的外表面向外通量 $q_{r}(R)$ 的闭式表达式。最后，对下列参数数值计算 $q_{r}(R)$：\n- $R=0.10\\,\\text{m}$，\n- $\\kappa=10\\,\\text{m}^{-1}$，\n- $T=1000\\,\\text{K}$，\n使用 $\\sigma=5.670374419\\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$ 和 $I_{b}=\\sigma T^{4}/\\pi$。以 $\\text{W}\\,\\text{m}^{-2}$ 为单位表示最终通量，并将答案四舍五入到四位有效数字。",
            "solution": "用户希望我按照以下步骤解决问题：\n\n1.  **验证问题：**\n    *   **步骤1：提取已知条件：**\n        -   介质属性：稳态、灰体、球对称、半径 $R$、折射率 $n=1$、空间均匀吸收系数 $\\kappa$（常数）、无散射。\n        -   热力学状态：均匀温度 $T$ 下的局部热力学平衡（LTE）。\n        -   发射源：各向同性，黑体方向强度 $I_{b}=\\sigma T^{4}/\\pi$。\n        -   周围环境：真空。\n        -   边界条件：无外部辐照，因此外边界（$r=R$）上所有入射方向（$\\mu  0$）的入射方向强度为零。\n        -   任务1：推导在 $r\\in[0,R]$ 和 $\\mu=\\cos\\theta \\in [-1,1]$ 处的方向辐射强度 $I(r,\\mu)$。\n        -   任务2：推导径向辐射热通量 $q_{r}(r)$ 的表达式。\n        -   任务3：获得外表面向外通量 $q_{r}(R)$ 的闭式表达式。\n        -   任务4：对 $R=0.10\\,\\text{m}$，$\\kappa=10\\,\\text{m}^{-1}$，$T=1000\\,\\text{K}$，使用 $\\sigma=5.670374419\\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$ 进行 $q_{r}(R)$ 的数值计算。\n\n    *   **步骤2：使用提取的已知条件进行验证：**\n        -   **有科学依据：** 这个问题是基于辐射传输方程（RTE）构建的，RTE 是一个控制辐射在参与性介质中传播的基本物理定律。这些假设（灰体、均匀属性、LTE、纯吸收-发射）定义了热辐射领域中的一个经典问题。所有量都有明确的定义且具有物理意义。该问题具有科学合理性。\n        -   **适定的：** 这个问题提供了对几何形状（球体）、介质属性（$\\kappa$，$T$）和边界条件（在 $r=R$ 处辐照为零）的完整描述。这构成了 RTE 的一个适定边值问题，预期存在强度场和合成热通量的唯一、稳定解。\n        -   **客观的：** 这个问题使用精确、明确的技术语言陈述，没有任何主观或基于意见的论断。\n\n    *   **步骤3：结论与行动：** 该问题是有效的。这是一个辐射传热中的标准、自洽问题，具有科学依据、适定且客观。我将继续进行求解。\n\n对于折射率为 $n=1$、处于局部热力学平衡状态的非散射、非导热、灰体介质，其辐射传输方程（RTE）由下式给出：\n$$ \\frac{dI}{ds} = \\kappa I_{b} - \\kappa I $$\n其中 $s$ 是沿辐射路径的坐标，$I$ 是方向辐射强度，$\\kappa$ 是吸收系数，$I_{b}$ 是黑体方向强度。由于温度 $T$ 是均匀的，因此 $I_{b} = \\sigma T^4 / \\pi$ 在整个介质中也是均匀的。\n\n这是一个关于 $I$ 沿路径 $s$ 的一阶线性常微分方程。其形式解可通过使用积分因子 $\\exp(\\kappa s)$ 获得：\n$$ I(s) = I(s_0) \\exp(-\\kappa(s-s_0)) + I_{b} (1-\\exp(-\\kappa(s-s_0))) $$\n其中 $s_0$ 是射线路径的起点。\n\n对于给定的问题，球体内部任意点的任何辐射射线都源于 $r=R$ 的边界。问题陈述该球体被真空包围且无外部辐照，因此边界处的入射强度为零。因此，对于任何从边界开始的射线路径，初始强度 $I(s_0)$ 均为 0。强度方程简化为：\n$$ I(s) = I_{b}(1 - \\exp(-\\kappa \\Delta s)) $$\n其中 $\\Delta s = s - s_0$ 是射线从边界传播到目标点的路径长度。\n\n我们的第一个任务是确定这个路径长度 $\\Delta s$，它对应于由径向坐标 $r$ 和方向余弦 $\\mu = \\cos\\theta$ 指定的任意内部点，其中 $\\theta$ 是射线方向与向外径向矢量之间的夹角。设目标点为 $\\vec{x}$（模为 $r$），边界上的起始点为 $\\vec{x}_b$（模为 $R$）。射线路径是一条直线。我们从 $\\vec{x}$ 沿射线向后追溯距离 $\\Delta s$ 到达 $\\vec{x}_b$。因此，$\\vec{x}_b = \\vec{x} - \\Delta s \\, \\vec{\\Omega}$，其中 $\\vec{\\Omega}$ 是射线在 $\\vec{x}$ 处的方向。我们需要满足 $|\\vec{x}_b|^2 = R^2$。\n$$ R^2 = (\\vec{x} - \\Delta s \\, \\vec{\\Omega}) \\cdot (\\vec{x} - \\Delta s \\, \\vec{\\Omega}) = |\\vec{x}|^2 - 2 \\Delta s (\\vec{x} \\cdot \\vec{\\Omega}) + (\\Delta s)^2 |\\vec{\\Omega}|^2 $$\n代入 $|\\vec{x}| = r$, $|\\vec{\\Omega}|=1$ 以及 $\\vec{x} \\cdot \\vec{\\Omega} = r \\cos\\theta = r\\mu$，我们得到：\n$$ R^2 = r^2 - 2 \\Delta s r \\mu + (\\Delta s)^2 $$\n这是关于路径长度 $\\Delta s$ 的二次方程：\n$$ (\\Delta s)^2 - (2r\\mu) \\Delta s + (r^2 - R^2) = 0 $$\n求解 $\\Delta s$：\n$$ \\Delta s = \\frac{2r\\mu \\pm \\sqrt{4r^2\\mu^2 - 4(r^2-R^2)}}{2} = r\\mu \\pm \\sqrt{R^2 - r^2(1-\\mu^2)} $$\n由于路径长度 $\\Delta s$ 必须是正值，并且注意到 $r  R$ 意味着 $r^2\\mu^2  r^2  R^2 - r^2(1-\\mu^2)$，因此 $r\\mu - \\sqrt{R^2 - r^2(1-\\mu^2)}$ 这一项总是负的。所以，我们必须选择正根：\n$$ \\Delta s(r, \\mu) = r\\mu + \\sqrt{R^2 - r^2(1-\\mu^2)} $$\n这个单一的路径长度表达式对所有 $\\mu \\in [-1, 1]$ 和 $r \\in [0,R]$ 都有效。\n\n因此，方向辐射强度 $I(r,\\mu)$ 为：\n$$ I(r, \\mu) = I_{b} \\left( 1 - \\exp\\left(-\\kappa \\left[ r\\mu + \\sqrt{R^2-r^2(1-\\mu^2)} \\right]\\right) \\right) $$\n\n接下来，我们推导径向辐射热通量 $q_r(r)$。它被定义为强度法向分量在所有立体角上的积分：\n$$ q_r(r) = \\int_{4\\pi} I(r, \\mu) \\cos\\theta \\, d\\Omega = \\int_0^{2\\pi} \\int_{-1}^1 I(r, \\mu) \\mu \\, d\\mu \\, d\\phi $$\n由于 $I(r,\\mu)$ 与方位角 $\\phi$ 无关，对 $\\phi$ 的积分产生一个因子 $2\\pi$：\n$$ q_r(r) = 2\\pi \\int_{-1}^1 I(r, \\mu) \\mu \\, d\\mu $$\n代入 $I(r,\\mu)$ 的表达式：\n$$ q_r(r) = 2\\pi I_b \\int_{-1}^1 \\left( 1 - \\exp\\left(-\\kappa \\left[ r\\mu + \\sqrt{R^2-r^2(1-\\mu^2)} \\right]\\right) \\right) \\mu \\, d\\mu $$\n第一项的积分是 $\\int_{-1}^1 \\mu \\, d\\mu = 0$。所以，\n$$ q_r(r) = -2\\pi I_b \\int_{-1}^1 \\mu \\exp\\left(-\\kappa \\left[ r\\mu + \\sqrt{R^2-r^2(1-\\mu^2)} \\right]\\right) \\, d\\mu $$\n\n现在我们将此结果特殊化，以求出外表面 $r=R$ 处的热通量。我们首先计算 $I(R,\\mu)$。表面处的路径长度是：\n$$ \\Delta s(R, \\mu) = R\\mu + \\sqrt{R^2 - R^2(1-\\mu^2)} = R\\mu + \\sqrt{R^2\\mu^2} = R\\mu + R|\\mu| $$\n对于向内方向（$\\mu \\le 0$），$|\\mu|=-\\mu$，所以 $\\Delta s(R, \\mu \\le 0) = R\\mu - R\\mu = 0$。\n对于向外方向（$\\mu  0$），$|\\mu|=\\mu$，所以 $\\Delta s(R, \\mu  0) = R\\mu + R\\mu = 2R\\mu$。\n表面处的强度为：\n- $I(R, \\mu \\le 0) = I_b(1-\\exp(0)) = 0$，这正确地反映了入射辐射为零的边界条件。\n- $I(R, \\mu  0) = I_b(1-\\exp(-2\\kappa R \\mu))$。\n\n那么，表面热通量 $q_r(R)$ 是：\n$$ q_r(R) = 2\\pi \\int_{-1}^1 I(R, \\mu) \\mu \\, d\\mu = 2\\pi \\left( \\int_{-1}^0 I(R, \\mu\\le 0)\\mu \\, d\\mu + \\int_0^1 I(R,\\mu0)\\mu \\, d\\mu \\right) $$\n由于第一个被积函数为零，只有第二个积分有贡献：\n$$ q_r(R) = 2\\pi \\int_0^1 I_b(1 - \\exp(-2\\kappa R \\mu)) \\mu \\, d\\mu = 2\\pi I_b \\left( \\int_0^1 \\mu \\, d\\mu - \\int_0^1 \\mu \\exp(-2\\kappa R \\mu) \\, d\\mu \\right) $$\n第一个积分是 $\\int_0^1 \\mu \\, d\\mu = [\\mu^2/2]_0^1 = 1/2$。\n第二个积分使用分部积分法求解，$\\int u \\, dv = uv - \\int v \\, du$。令 $a=2\\kappa R$, $u=\\mu$, 且 $dv = \\exp(-a\\mu)d\\mu$。则 $du=d\\mu$ 且 $v = (-1/a)\\exp(-a\\mu)$。\n$$ \\int_0^1 \\mu e^{-a\\mu} d\\mu = \\left[-\\frac{\\mu}{a}e^{-a\\mu}\\right]_0^1 - \\int_0^1 \\left(-\\frac{1}{a}e^{-a\\mu}\\right) d\\mu $$\n$$ = -\\frac{1}{a}e^{-a} + \\frac{1}{a} \\int_0^1 e^{-a\\mu} d\\mu = -\\frac{1}{a}e^{-a} + \\frac{1}{a}\\left[-\\frac{1}{a}e^{-a\\mu}\\right]_0^1 $$\n$$ = -\\frac{e^{-a}}{a} - \\frac{e^{-a}}{a^2} + \\frac{1}{a^2} = \\frac{1 - (1+a)e^{-a}}{a^2} $$\n将此结果代回 $q_r(R)$ 的表达式中：\n$$ q_r(R) = 2\\pi I_b \\left[ \\frac{1}{2} - \\frac{1-(1+2\\kappa R)\\exp(-2\\kappa R)}{(2\\kappa R)^2} \\right] $$\n这就是所要求的闭式表达式。我们也可以用黑体发射功率 $E_b = \\pi I_b = \\sigma T^4$ 来表示它：\n$$ q_r(R) = 2 E_b \\left[ \\frac{1}{2} - \\frac{1-(1+2\\kappa R)\\exp(-2\\kappa R)}{(2\\kappa R)^2} \\right] = \\sigma T^4 \\left[ 1 - \\frac{2\\left(1-(1+2\\kappa R)\\exp(-2\\kappa R)\\right)}{(2\\kappa R)^2} \\right] $$\n\n最后，我们对 $q_r(R)$ 进行数值计算。给定的值为：\n- $R = 0.10\\,\\text{m}$\n- $\\kappa = 10\\,\\text{m}^{-1}$\n- $T = 1000\\,\\text{K}$\n- $\\sigma = 5.670374419 \\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$\n\n首先，我们计算光学直径 $\\tau_D = 2\\kappa R$：\n$$ \\tau_D = 2 \\times (10\\,\\text{m}^{-1}) \\times (0.10\\,\\text{m}) = 2 $$\n接下来，我们计算黑体发射功率 $E_b=\\sigma T^4$：\n$$ E_b = (5.670374419 \\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}) \\times (1000\\,\\text{K})^4 = 56703.74419\\,\\text{W}\\,\\text{m}^{-2} $$\n现在我们使用推导出的 $q_r(R)$ 表达式。一个更简单的代数形式是：\n$$ q_r(R) = \\sigma T^4 \\left[ 1 - \\frac{1-(1+\\tau_D)\\exp(-\\tau_D)}{\\tau_D^2/2} \\right] = \\sigma T^4 \\frac{\\tau_D^2/2 - (1-(1+\\tau_D)\\exp(-\\tau_D))}{\\tau_D^2/2} $$\n$$ q_r(R) = E_b \\left( \\frac{1+ (1+\\tau_D)\\exp(-\\tau_D)/(-1) + \\tau_D^2/2 }{...} \\right) \\quad \\text{让我们使用另一种代数形式} $$\n$$ q_r(R) = E_b \\left( 1 - \\frac{2(1-3e^{-2})}{4} \\right) = E_b \\left( 1 - \\frac{1-3e^{-2}}{2} \\right) = E_b \\left( \\frac{2-1+3e^{-2}}{2} \\right) = E_b \\left( \\frac{1+3e^{-2}}{2} \\right) $$\n代入数值：\n$$ q_r(R) = 56703.74419\\,\\text{W}\\,\\text{m}^{-2} \\times \\left( \\frac{1+3\\exp(-2)}{2} \\right) $$\n$$ \\exp(-2) \\approx 0.1353352832366127 $$\n$$ q_r(R) \\approx 56703.74419 \\times \\left( \\frac{1+3 \\times 0.1353352832}{2} \\right) $$\n$$ q_r(R) \\approx 56703.74419 \\times \\left( \\frac{1.4060058497}{2} \\right) $$\n$$ q_r(R) \\approx 56703.74419 \\times 0.70300292485 $$\n$$ q_r(R) \\approx 39863.099\\,\\text{W}\\,\\text{m}^{-2} $$\n四舍五入到四位有效数字，我们得到 $39860\\,\\text{W}\\,\\text{m}^{-2}$。",
            "answer": "$$\n\\boxed{3.986 \\times 10^4}\n$$"
        },
        {
            "introduction": "辐射传递方程的解析解非常罕见，大多数实际问题都需要数值方法，这个动手计算练习旨在探讨将 RTE 离散化以进行计算机模拟的核心挑战。您将实现并比较两种基本的空间差分格式——简单的阶梯格式和更精确的菱形差分格式——以理解计算流体动力学和传热学中的一个关键概念：数值扩散。通过量化每种格式引入的误差和“数值消光”，您将直接洞察离散化选择如何影响求解精度，这是任何计算工程师都必须考虑的关键因素 。",
            "id": "3980435",
            "problem": "一束单向准直光束在边界位置 $x=0$ 处进入一个均匀、等温、平面平行板的灰体参与介质，并以方向余弦 $ \\mu = 1$ 沿 $+x$ 方向传播。包含吸收、发射和各向同性散射的通用一维、稳态、灰体辐射传输方程（RTE）为\n$$\n\\mu \\, \\frac{d I(x,\\mu)}{dx} + \\sigma_t \\, I(x,\\mu) = \\sigma_a \\, B + \\frac{\\sigma_s}{2} \\int_{-1}^{1} I(x,\\mu') \\, d\\mu' ,\n$$\n其中 $I(x,\\mu)$ 是辐射强度，$\\sigma_a$ 是吸收系数，$\\sigma_s$ 是散射系数，$\\sigma_t = \\sigma_a + \\sigma_s$ 是消光系数，$B$ 是等温发射源（灰体普朗克函数）。为了分离空间离散化（数值扩散）对高度定向信号的影响，我们考虑一个纯吸收、无发射、无散射的特殊情况（$\\sigma_s = 0$，$B = 0$），此时RTE简化为\n$$\n\\mu \\, \\frac{d I(x)}{dx} + \\sigma_t \\, I(x) = 0,\n$$\n对于单一方向 $\\mu = 1$，其边界条件为 $I(0) = I_0$。对于 $x \\in [0,L]$，精确解为\n$$\nI_{\\text{exact}}(x) = I_0 \\, \\exp\\!\\left(-\\frac{\\sigma_t x}{\\mu}\\right).\n$$\n\n你将比较两种在宽度为 $\\Delta x$ 的 $N$ 个单元的均匀网格上应用的空间差分格式，即阶梯格式（一阶迎风）和菱形差分格式（二阶中心），应用于上述纯吸收光束问题。定义网格佩克莱特数\n$$\nPe_g \\equiv \\frac{\\sigma_t \\, \\Delta x}{\\mu}.\n$$\n对于每种格式，沿网格离散化控制方程，并将边缘强度从 $x=0$ 处的入口边界推进，穿过 $N$ 个单元，以计算在 $x=L = N \\, \\Delta x$ 处的数值出口强度 $I_{\\text{num}}(L)$。所有情况下均使用相同的入口边界值 $I_0 = 1$ 和 $\\mu = 1$。\n\n对于每个测试用例，量化：\n- 每种格式的相对出口强度误差（无量纲），\n$$\n\\varepsilon_{\\text{scheme}} = \\frac{I_{\\text{num,scheme}}(L) - I_{\\text{exact}}(L)}{I_{\\text{exact}}(L)} .\n$$\n- 每种格式的等效数值消光系数（无量纲），通过将数值出口强度与具有有效消光的指数衰减相匹配来定义，即，\n$$\nI_{\\text{num,scheme}}(L) = I_0 \\, \\exp\\!\\left(-\\frac{(\\sigma_t + \\sigma_{\\text{num,scheme}}) \\, L}{\\mu}\\right),\n$$\n因此\n$$\n\\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{L} \\, \\ln\\!\\left(\\frac{I_{\\text{num,scheme}}(L)}{I_0}\\right) - \\sigma_t .\n$$\n\n正确实现两种格式，并通过根据各自的离散化方法将边界强度在 $N$ 个单元中传播来计算每种格式的 $I_{\\text{num}}(L)$。不要在未从离散方程推导的情况下假设或使用任何闭式“捷径”的单位单元放大因子。\n\n使用以下测试套件。每个测试用例由 $(\\sigma_t, Pe_g, N)$ 指定，您必须从中计算 $\\Delta x = Pe_g/\\sigma_t$，$L = N \\, \\Delta x$，其中 $I_0 = 1$ 和 $\\mu = 1$：\n- 测试 $1$：$(\\sigma_t, Pe_g, N) = (\\, $1.0$ ,\\, $0.1$ ,\\, $10$ \\,)$.\n- 测试 $2$：$(\\sigma_t, Pe_g, N) = (\\, $1.0$ ,\\, $0.5$ ,\\, $4$ \\,)$.\n- 测试 $3$：$(\\sigma_t, Pe_g, N) = (\\, $1.5$ ,\\, $0.9$ ,\\, $2$ \\,)$.\n- 测试 $4$：$(\\sigma_t, Pe_g, N) = (\\, $2.0$ ,\\, $0.01$ ,\\, $10$ \\,)$.\n- 测试 $5$：$(\\sigma_t, Pe_g, N) = (\\, $0.8$ ,\\, $0.95$ ,\\, $2$ \\,)$.\n\n所有量均为无量纲。除了无量纲的 $\\mu=1$ 之外，不需要其他角度。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按顺序 $[Pe_g, \\varepsilon_{\\text{step}}, \\varepsilon_{\\text{diamond}}, \\sigma_{\\text{num,step}}, \\sigma_{\\text{num,diamond}}]$ 输出一个包含五个浮点数的列表。因此，最终输出必须是五个此类列表的列表，其顺序与测试用例的顺序相同，例如：\n$[ [Pe_1,\\varepsilon_{s,1},\\varepsilon_{d,1},\\sigma_{s,1},\\sigma_{d,1}], [Pe_2,\\dots], \\dots ]$。",
            "solution": "我们从包含吸收、发射和各向同性散射的通用一维、稳态、灰体辐射传输方程（RTE）开始，\n$$\n\\mu \\, \\frac{d I(x,\\mu)}{dx} + \\sigma_t \\, I(x,\\mu) = \\sigma_a \\, B + \\frac{\\sigma_s}{2} \\int_{-1}^{1} I(x,\\mu') \\, d\\mu' ,\n$$\n其中 $\\sigma_t = \\sigma_a + \\sigma_s$。为了分离准直光束因空间离散化而纯粹引起的数值扩散，我们考虑一个纯吸收、无发射、无散射的介质，此时 $\\sigma_s = 0$ 且 $B = 0$。RTE简化为\n$$\n\\mu \\, \\frac{d I(x)}{dx} + \\sigma_t \\, I(x) = 0,\n$$\n对于单一方向 $\\mu = 1$，边界条件为 $I(0) = I_0$。精确解为\n$$\nI_{\\text{exact}}(x) = I_0 \\, \\exp\\!\\left(-\\frac{\\sigma_t x}{\\mu}\\right) = I_0 \\, \\exp(- \\sigma_t x) .\n$$\n\n我们将平板 $[0,L]$ 离散化为 $N$ 个宽度为 $\\Delta x$ 的均匀单元，其中 $L = N \\, \\Delta x$。定义网格佩克莱特数会很方便\n$$\nPe_g \\equiv \\frac{\\sigma_t \\, \\Delta x}{\\mu}.\n$$\n由于本问题中 $\\mu = 1$，我们有 $Pe_g = \\sigma_t \\, \\Delta x$。对于单元索引 $j \\in \\{1,\\dots,N\\}$，我们将位置 $x_{j-1/2}$ 和 $x_{j+1/2}$ 处的单元边缘强度表示为 $I_{j-1/2}$ 和 $I_{j+1/2}$，入口边界位于 $x_{1-1/2} = 0$。\n\n接下来，我们推导两种空间差分格式，作为单元上的类有限体积平衡。在单元 $[x_{j-1/2}, x_{j+1/2}]$ 上对连续方程进行积分，并假设单元内的近似以不同方式封闭系统。\n\n对于 $\\mu  0$ 的阶梯格式（一阶迎风），用边缘强度除以 $\\Delta x$ 的前向差分来近似导数，并用迎风边缘值来近似单元内的衰减项。具体来说，\n$$\n\\mu \\, \\frac{I_{j+1/2} - I_{j-1/2}}{\\Delta x} + \\sigma_t \\, I_{j-1/2} = 0 .\n$$\n求解顺风边缘强度可得\n$$\nI_{j+1/2} = I_{j-1/2} \\left(1 - \\frac{\\sigma_t \\, \\Delta x}{\\mu}\\right) = I_{j-1/2} \\left(1 - Pe_g \\right) .\n$$\n对于 $0 \\le Pe_g \\le 1$，这是一个一阶精确的单调更新，超出此范围，因子变为负值，该格式会对此问题产生非物理的符号振荡。\n\n对于菱形差分格式（二阶中心），像之前一样用 $\\Delta x$ 上的边缘差分来近似导数，但用两个边缘值的算术平均值来近似衰减项，这等效于单元内线性变化的中点法则：\n$$\n\\mu \\, \\frac{I_{j+1/2} - I_{j-1/2}}{\\Delta x} + \\sigma_t \\, \\frac{I_{j+1/2} + I_{j-1/2}}{2} = 0 .\n$$\n求解此线性方程，用 $I_{j-1/2}$ 表示 $I_{j+1/2}$：\n$$\nI_{j+1/2} \\left( \\frac{\\mu}{\\Delta x} + \\frac{\\sigma_t}{2} \\right) = I_{j-1/2} \\left( \\frac{\\mu}{\\Delta x} - \\frac{\\sigma_t}{2} \\right) ,\n$$\n由此可得\n$$\nI_{j+1/2} = I_{j-1/2} \\, \\frac{\\frac{\\mu}{\\Delta x} - \\frac{\\sigma_t}{2}}{\\frac{\\mu}{\\Delta x} + \\frac{\\sigma_t}{2}} = I_{j-1/2} \\, \\frac{1 - \\frac{\\sigma_t \\Delta x}{2 \\mu}}{1 + \\frac{\\sigma_t \\Delta x}{2 \\mu}} = I_{j-1/2} \\, \\frac{1 - \\frac{Pe_g}{2}}{1 + \\frac{Pe_g}{2}} .\n$$\n此格式对于小的 $Pe_g$ 是二阶精确的，并且对于 $Pe_g  2$ 是保正的。\n\n令 $r_{\\text{step}} = 1 - Pe_g$ 和 $r_{\\text{dd}} = \\frac{1 - Pe_g/2}{1 + Pe_g/2}$ 为两种格式的单位单元放大因子。从入口边界 $I_{1-1/2} = I_0$ 开始，经过 $N$ 个单元传播，我们得到在 $x = L$ 处的数值出口强度：\n$$\nI_{\\text{num,step}}(L) = I_0 \\, r_{\\text{step}}^{\\,N}, \\qquad I_{\\text{num,diamond}}(L) = I_0 \\, r_{\\text{dd}}^{\\,N}.\n$$\n精确出口强度为\n$$\nI_{\\text{exact}}(L) = I_0 \\, \\exp\\!\\left(-\\frac{\\sigma_t L}{\\mu}\\right) = I_0 \\, \\exp(- \\sigma_t L) .\n$$\n我们将每种格式的相对误差定义为\n$$\n\\varepsilon_{\\text{scheme}} = \\frac{I_{\\text{num,scheme}}(L) - I_{\\text{exact}}(L)}{I_{\\text{exact}}(L)}.\n$$\n\n为了将数值扩散量化为等效的附加消光，我们将数值出口强度与具有有效消光系数的指数形式相匹配，并求解数值分量：\n$$\nI_{\\text{num,scheme}}(L) = I_0 \\, \\exp\\!\\left(-\\frac{(\\sigma_t + \\sigma_{\\text{num,scheme}}) \\, L}{\\mu}\\right) \\quad \\Rightarrow \\quad \\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{L} \\, \\ln\\!\\left(\\frac{I_{\\text{num,scheme}}(L)}{I_0}\\right) - \\sigma_t .\n$$\n代入上述 $I_{\\text{num,scheme}}(L)$ 的单位单元公式，等效地得到：\n$$\n\\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{\\Delta x} \\, \\ln(r_{\\text{scheme}}) - \\sigma_t,\n$$\n这与使用 $L$ 的定义是一致的，因为 $L = N \\, \\Delta x$ 且 $r_{\\text{scheme}}^{\\,N} = \\exp\\!\\left(N \\ln r_{\\text{scheme}}\\right)$。\n\n在算法上，对于每个测试用例，我们按以下步骤进行：\n1. 给定 $(\\sigma_t, Pe_g, N)$ 和 $\\mu = 1$，计算 $\\Delta x = Pe_g/\\sigma_t$ 和 $L = N \\, \\Delta x$。\n2. 设置 $I_0 = 1$。\n3. 计算 $I_{\\text{exact}}(L) = \\exp(- \\sigma_t L)$。\n4. 计算 $r_{\\text{step}} = 1 - Pe_g$ 和 $r_{\\text{dd}} = \\frac{1 - Pe_g/2}{1 + Pe_g/2}$。\n5. 计算 $I_{\\text{num,step}}(L) = I_0 \\, r_{\\text{step}}^{\\,N}$ 和 $I_{\\text{num,diamond}}(L) = I_0 \\, r_{\\text{dd}}^{\\,N}$。\n6. 通过它们的定义计算 $\\varepsilon_{\\text{step}}$ 和 $\\varepsilon_{\\text{diamond}}$。\n7. 通过有效消光定义计算 $\\sigma_{\\text{num,step}}$ 和 $\\sigma_{\\text{num,diamond}}$，\n$$\n\\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{L} \\, \\ln\\!\\left(\\frac{I_{\\text{num,scheme}}(L)}{I_0}\\right) - \\sigma_t .\n$$\n\n行为讨论：\n- 对于小的 $Pe_g$，菱形差分因子展开为 $r_{\\text{dd}} = \\frac{1 - Pe_g/2}{1 + Pe_g/2} = 1 - Pe_g + \\frac{Pe_g^2}{2} - \\frac{Pe_g^3}{4} + \\dots$，这与精确的 $e^{-Pe_g} = 1 - Pe_g + \\frac{Pe_g^2}{2} - \\frac{Pe_g^3}{6} + \\dots$ 匹配到二阶，导致比阶梯格式小得多的数值扩散，阶梯格式的 $r_{\\text{step}} = 1 - Pe_g$ 在一阶截断。\n- 当 $Pe_g \\to 1^{-}$ 时，对于这个纯衰减问题，阶梯格式变得极具扩散性，因为 $r_{\\text{step}} \\to 0$，导致即使对于适中的 $N$，$I_{\\text{num,step}}(L) \\to 0$，而精确衰减保持有限。\n- 等效数值消光 $\\sigma_{\\text{num,scheme}}$ 为离散化引入的人为衰减提供了一个直接的定量度量，对于小的 $Pe_g$，阶梯格式的该值与 $Pe_g$ 成比例，而菱形差分格式的该值与 $Pe_g^2$ 成比例。\n\n该实现直接编码了推导出的更新因子，并为指定的测试套件计算所要求的度量，以所要求的列表的列表格式返回结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Test cases: tuples of (sigma_t, Pe_g, N)\n    # mu = 1, I0 = 1 for all cases\n    test_cases = [\n        (1.0, 0.1, 10),   # small Peclet, many cells\n        (1.0, 0.5, 4),    # moderate Peclet\n        (1.5, 0.9, 2),    # high Peclet but  1 for step stability\n        (2.0, 0.01, 10),  # very small Peclet\n        (0.8, 0.95, 2),   # near-unity Peclet\n    ]\n    mu = 1.0\n    I0 = 1.0\n\n    results = []\n    for sigma_t, Pe, N in test_cases:\n        dx = Pe / sigma_t\n        L = N * dx\n\n        # Exact exit intensity\n        I_exact = I0 * np.exp(-(sigma_t * L) / mu)\n\n        # Per-cell amplification factors derived for Q=0 case\n        r_step = 1.0 - Pe\n        r_dd = (1.0 - 0.5 * Pe) / (1.0 + 0.5 * Pe)\n\n        # Numerical exit intensities\n        I_step = I0 * (r_step ** N)\n        I_dd = I0 * (r_dd ** N)\n\n        # Relative errors (dimensionless)\n        err_step = (I_step - I_exact) / I_exact\n        err_dd = (I_dd - I_exact) / I_exact\n\n        # Equivalent numerical extinction (dimensionless)\n        # Guard against any tiny negative due to floating point by max with tiny positive\n        I_step_pos = max(I_step, 1e-300)\n        I_dd_pos = max(I_dd, 1e-300)\n\n        sigma_num_step = -(mu / L) * np.log(I_step_pos / I0) - sigma_t\n        sigma_num_dd = -(mu / L) * np.log(I_dd_pos / I0) - sigma_t\n\n        results.append([\n            float(Pe),\n            float(err_step),\n            float(err_dd),\n            float(sigma_num_step),\n            float(sigma_num_dd),\n        ])\n\n    # Final print statement in the exact required format.\n    # Print list of lists as a single-line string.\n    # Use default str conversion for floats.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}