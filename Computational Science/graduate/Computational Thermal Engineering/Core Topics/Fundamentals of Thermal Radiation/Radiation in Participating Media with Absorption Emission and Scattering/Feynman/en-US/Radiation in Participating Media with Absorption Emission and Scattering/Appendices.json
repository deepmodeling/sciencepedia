{
    "hands_on_practices": [
        {
            "introduction": "Before tackling the full Radiative Transfer Equation (RTE), it is essential to master the fundamental parameters that describe how a medium interacts with radiation. This first exercise guides you through calculating the extinction coefficient ($\\beta$), the single-scattering albedo ($\\omega$), and the photon mean free path ($\\ell$). Understanding these properties  is the first step toward predicting whether a medium will primarily absorb, scatter, or transmit photons.",
            "id": "3980455",
            "problem": "A spatially homogeneous, isothermal, gray participating medium with isotropic scattering is characterized by its absorption coefficient $\\,\\kappa\\,$ and its scattering coefficient $\\,\\sigma_{s}\\,$. Consider a steady-state radiative field in which the specific intensity is independent of frequency. Starting from the Radiative Transfer Equation (RTE) and the core definitions of absorption, emission, and scattering, derive expressions for the extinction coefficient $\\,\\beta\\,$, the single-scattering albedo $\\,\\omega\\,$, and the mean free path $\\,\\ell\\,$ of photons. Then evaluate these quantities for $\\,\\kappa=0.3\\,\\mathrm{m}^{-1}\\,$ and $\\,\\sigma_{s}=0.7\\,\\mathrm{m}^{-1}\\,$. Round your numerical answers to four significant figures. Express $\\,\\beta\\,$ in $\\mathrm{m}^{-1}$, $\\,\\omega\\,$ as dimensionless, and $\\,\\ell\\,$ in $\\mathrm{m}$. Finally, briefly discuss the implications of the computed $\\,\\omega\\,$ and $\\,\\ell\\,$ for the onset of multiple scattering in domains whose characteristic length scales are comparable to or larger than $\\,\\ell\\,$; do not compute any additional numerical values beyond $\\,\\beta\\,$, $\\,\\omega\\,$, and $\\,\\ell\\,$.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in the field of radiative heat transfer. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe analysis begins with the Radiative Transfer Equation (RTE) for a gray, participating medium in a steady state. Along a path length $s$ in a specific direction $\\hat{s}$, the RTE describes the change in specific intensity $I$ as a balance between attenuation (absorption and out-scattering) and augmentation (emission and in-scattering). For the given conditions of a gray, isothermal medium with isotropic scattering, the RTE is:\n$$\n\\frac{dI}{ds} = -\\kappa I - \\sigma_{s} I + \\kappa I_{b} + \\frac{\\sigma_{s}}{4\\pi} \\int_{4\\pi} I(\\hat{s}') d\\Omega'\n$$\nHere, $\\kappa$ is the absorption coefficient, $\\sigma_{s}$ is the scattering coefficient, $I_{b}$ is the blackbody intensity at the medium's temperature (since the medium is gray and isothermal), and the integral term represents the in-scattering from all other directions $\\hat{s}'$ over the full solid angle of $4\\pi$ steradians. For isotropic scattering, the scattering phase function is unity.\n\nThe attenuation of the specific intensity $I$ from the original beam direction is governed by the first two terms on the right-hand side: $-\\kappa I$ and $-\\sigma_{s} I$. These represent the loss of energy per unit volume per unit solid angle due to absorption and scattering out of the beam, respectively.\n\n**1. Extinction Coefficient, $\\beta$**\nThe total attenuation of radiation is the sum of the effects of absorption and scattering. The extinction coefficient, denoted by $\\beta$, is defined as the total probability of a photon interaction (either absorption or scattering) per unit path length. It is therefore the sum of the absorption coefficient and the scattering coefficient.\n$$\n\\beta = \\kappa + \\sigma_{s}\n$$\nThis coefficient represents the total rate of intensity reduction from the beam per unit length. The attenuation term in the RTE can thus be written as $-\\beta I = -(\\kappa + \\sigma_{s})I$.\n\n**2. Single-Scattering Albedo, $\\omega$**\nThe single-scattering albedo, denoted by $\\omega$, is a dimensionless parameter that quantifies the relative importance of scattering compared to total extinction. It is defined as the ratio of the scattering coefficient to the extinction coefficient.\n$$\n\\omega = \\frac{\\sigma_{s}}{\\beta} = \\frac{\\sigma_{s}}{\\kappa + \\sigma_{s}}\n$$\nPhysically, $\\omega$ represents the probability that a photon-matter interaction event is a scattering event rather than an absorption event. An albedo of $\\omega=0$ signifies a purely absorbing medium, while an albedo of $\\omega=1$ signifies a purely scattering medium.\n\n**3. Mean Free Path, $\\ell$**\nThe mean free path of a photon, denoted by $\\ell$, is the average distance a photon travels through the medium before it interacts with a particle (i.e., before it is either absorbed or scattered). This statistical quantity is the reciprocal of the extinction coefficient, which represents the probability of interaction per unit distance.\n$$\n\\ell = \\frac{1}{\\beta} = \\frac{1}{\\kappa + \\sigma_{s}}\n$$\n\n**Numerical Evaluation**\nThe problem provides the following numerical values for the absorption and scattering coefficients:\n$\\kappa = 0.3\\,\\mathrm{m}^{-1}$\n$\\sigma_{s} = 0.7\\,\\mathrm{m}^{-1}$\n\nWe can now compute the values of $\\beta$, $\\omega$, and $\\ell$.\n\nFirst, the extinction coefficient $\\beta$:\n$$\n\\beta = \\kappa + \\sigma_{s} = 0.3\\,\\mathrm{m}^{-1} + 0.7\\,\\mathrm{m}^{-1} = 1.0\\,\\mathrm{m}^{-1}\n$$\nRounding to four significant figures, we get $\\beta = 1.000\\,\\mathrm{m}^{-1}$.\n\nNext, the single-scattering albedo $\\omega$:\n$$\n\\omega = \\frac{\\sigma_{s}}{\\kappa + \\sigma_{s}} = \\frac{0.7\\,\\mathrm{m}^{-1}}{0.3\\,\\mathrm{m}^{-1} + 0.7\\,\\mathrm{m}^{-1}} = \\frac{0.7}{1.0} = 0.7\n$$\nRounding to four significant figures, this is $\\omega = 0.7000$.\n\nFinally, the mean free path $\\ell$:\n$$\n\\ell = \\frac{1}{\\beta} = \\frac{1}{1.000\\,\\mathrm{m}^{-1}} = 1.0\\,\\mathrm{m}\n$$\nRounding to four significant figures, we get $\\ell = 1.000\\,\\mathrm{m}$.\n\n**Discussion on Multiple Scattering**\nThe computed values are $\\omega = 0.7000$ and $\\ell = 1.000\\,\\mathrm{m}$.\nThe single-scattering albedo, $\\omega = 0.7000$, is significantly greater than zero. This value implies that scattering is the dominant mechanism of photon interaction in this medium, with a $70\\%$ probability that an interaction event is scattering and a $30\\%$ probability that it is absorption. A high probability of scattering is a necessary condition for multiple scattering to occur, as photons are likely to survive initial interactions and continue propagating within the medium.\n\nThe mean free path, $\\ell = 1.000\\,\\mathrm{m}$, is the characteristic length scale for photon-matter interactions. For a medium with a characteristic geometric length scale $L$ that is comparable to or larger than $\\ell$ (i.e., $L \\gtrsim \\ell$), it is highly probable that a photon traversing the medium will experience at least one interaction. The optical thickness of such a domain, $\\tau = \\beta L$, would be on the order of $1$ or greater.\n\nWhen these two conditions are met simultaneously—a high single-scattering albedo and an optically thick medium ($L \\gtrsim \\ell$)—multiple scattering becomes a significant mode of energy transport. A photon entering or emitted within such a domain is likely to scatter multiple times, following a random walk-like path before it is eventually absorbed or escapes the domain. Therefore, the combination of a high $\\omega$ and a system size $L \\ge \\ell$ ensures that the radiative field is strongly influenced by the cumulative effect of many scattering events, making a single-scattering approximation invalid and necessitating a full solution of the RTE that accounts for the integral term.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.000 & 0.7000 & 1.000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the fundamental properties defined, we can now explore their impact on the overall radiative field in important limiting cases. This problem challenges you to analyze an optically thick, isothermal medium and prove that it behaves as a perfect blackbody emitter. This practice  provides a crucial link between the complex physics of volumetric radiation and the simpler, well-known laws of surface radiation.",
            "id": "3980465",
            "problem": "Consider an isothermal, plane-parallel, gray participating medium occupying the semi-infinite half-space $x>0$, bounded at $x=0$ by a perfectly transparent interface to vacuum. The medium is in Local Thermodynamic Equilibrium (LTE) at a uniform temperature $T$, and it is characterized by a constant absorption coefficient $\\kappa$ and a constant, isotropic scattering coefficient $\\sigma_s$; the extinction coefficient is $\\beta=\\kappa+\\sigma_s$. There is no external irradiation from the vacuum side, so the boundary condition at $x=0$ is that the incoming specific intensity for directions pointing into the medium vanishes.\n\nStarting from first principles, use Kirchhoff’s law of thermal radiation, the definition of the blackbody Planck intensity integrated over wavelength, and the radiative transfer equation to:\n\n1) Derive the thermal volumetric emissive power $E_{v}^{\\text{th}}$ of the medium (power per unit volume), expressed in terms of $\\kappa$ and the integrated blackbody intensity $B(T)$.\n\n2) In the optically thick limit (i.e., the optical thickness is very large for all relevant directions), determine the emergent outward hemispherical radiative heat flux $q_{\\text{out}}$ at $x=0$ by solving the radiative transfer equation for the specific intensity $I(x,\\mu)$, where $\\mu=\\cos\\theta$ is the direction cosine with respect to the $x$-axis. Compare $q_{\\text{out}}$ to the surface blackbody emissive power $E_{b}=\\sigma T^{4}$, where $\\sigma$ is the Stefan–Boltzmann constant and $B(T)$ satisfies $E_{b}=\\pi B(T)$.\n\nDefine the dimensionless comparison metric $R=\\dfrac{q_{\\text{out}}}{E_{b}}$, and provide its exact value. Express the final answer as the exact, dimensionless value of $R$ with no units. No rounding is required.",
            "solution": "The problem asks us to analyze the radiative properties of an isothermal, semi-infinite, gray participating medium. We will first derive its volumetric emissive power, then solve for the emergent radiative flux in the optically thick limit, and finally compare this flux to that of a perfect blackbody.\n\n**1. Thermal Volumetric Emissive Power ($E_{v}^{\\text{th}}$)**\n\nFor a medium in Local Thermodynamic Equilibrium (LTE), Kirchhoff's law states that the spectral volumetric emissive power per unit solid angle is proportional to the spectral absorption coefficient $\\kappa_\\lambda$ and the blackbody spectral intensity $B_\\lambda(T)$:\n$$\ne'_\\lambda = \\kappa_\\lambda B_\\lambda(T)\n$$\nSince the medium is gray, its absorption coefficient $\\kappa$ is constant with wavelength. The total volumetric emissive power per unit solid angle, $e'$, is obtained by integrating over all wavelengths:\n$$\ne' = \\int_{0}^{\\infty} e'_\\lambda d\\lambda = \\kappa \\int_{0}^{\\infty} B_\\lambda(T) d\\lambda = \\kappa B(T)\n$$\nwhere $B(T)$ is the wavelength-integrated blackbody intensity. Emission is isotropic, so to find the total power emitted per unit volume into all directions, $E_{v}^{\\text{th}}$, we integrate $e'$ over the full solid angle of $4\\pi$ steradians:\n$$\nE_{v}^{\\text{th}} = \\int_{4\\pi} e' d\\Omega = \\kappa B(T) \\int_{4\\pi} d\\Omega = 4\\pi \\kappa B(T)\n$$\n\n**2. Emergent Hemispherical Radiative Flux ($q_{\\text{out}}$)**\n\nThe one-dimensional Radiative Transfer Equation (RTE) for a gray, isotropically scattering medium is:\n$$\n\\mu \\frac{dI(x,\\mu)}{dx} = -(\\kappa + \\sigma_s)I(x,\\mu) + \\kappa B(T) + \\frac{\\sigma_s}{2} \\int_{-1}^{1} I(x,\\mu') d\\mu'\n$$\nIn the \"optically thick limit\" of a semi-infinite isothermal medium, the radiation field deep within the medium is in full equilibrium with the matter. This means the intensity $I$ becomes isotropic and equal to the blackbody intensity $B(T)$. This equilibrium state effectively propagates to the surface, meaning the emergent radiation originates from a region that is fully thermalized. Therefore, the emergent intensity $I(0,\\mu)$ for directions pointing out of the medium ($\\mu < 0$) is equal to the blackbody intensity:\n$$\nI(0, \\mu) = B(T) \\quad (\\text{for } \\mu  0)\n$$\nThe outward hemispherical radiative flux, $q_{\\text{out}}$, is the energy emerging per unit area. It is found by integrating the normal component of the intensity, $I(0,\\mu)(-\\mu)$, over the outward-facing hemisphere (where $\\mu$ ranges from -1 to 0):\n$$\nq_{\\text{out}} = \\int_{\\phi=0}^{2\\pi} \\int_{\\mu=-1}^{0} I(0, \\mu) (-\\mu) d\\mu d\\phi\n$$\nSubstituting $I(0, \\mu) = B(T)$ and integrating:\n$$\nq_{\\text{out}} = 2\\pi B(T) \\int_{-1}^{0} (-\\mu) d\\mu = 2\\pi B(T) \\left[ -\\frac{\\mu^2}{2} \\right]_{-1}^{0}\n$$\n$$\nq_{\\text{out}} = 2\\pi B(T) \\left( 0 - \\left( -\\frac{(-1)^2}{2} \\right) \\right) = 2\\pi B(T) \\left( \\frac{1}{2} \\right) = \\pi B(T)\n$$\n\n**3. Comparison with Blackbody Emissive Power ($R$)**\n\nThe problem defines the surface blackbody emissive power as $E_b = \\sigma T^4$ and gives the relation $E_b = \\pi B(T)$. We are asked to compute the ratio $R = q_{\\text{out}} / E_b$.\nUsing our result for $q_{\\text{out}}$:\n$$\nR = \\frac{\\pi B(T)}{E_b} = \\frac{\\pi B(T)}{\\pi B(T)} = 1\n$$\nThe value $R=1$ confirms that an isothermal, optically thick participating medium radiates from its boundary exactly like a perfect blackbody surface at the same temperature.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "While analytical solutions provide deep insight, most real-world problems require numerical methods. This hands-on coding exercise  shifts our focus to the numerical solution of the RTE, where you will implement and compare two fundamental spatial discretization schemes. By analyzing the concept of numerical diffusion, you will gain practical insight into the sources of error and the trade-offs involved in building reliable radiation transport codes.",
            "id": "3980435",
            "problem": "A monodirectional collimated beam enters a homogeneous, isothermal, plane-parallel slab of a gray participating medium at the boundary position $x=0$ and travels in the $+x$ direction with a direction cosine $ \\mu = 1$. The general one-dimensional, steady, gray Radiative Transfer Equation (RTE) with absorption, emission, and isotropic scattering is\n$$\n\\mu \\, \\frac{d I(x,\\mu)}{dx} + \\beta \\, I(x,\\mu) = \\kappa \\, B + \\frac{\\sigma_s}{2} \\int_{-1}^{1} I(x,\\mu') \\, d\\mu' ,\n$$\nwhere $I(x,\\mu)$ is the radiative intensity, $\\kappa$ is the absorption coefficient, $\\sigma_s$ is the scattering coefficient, $\\beta = \\kappa + \\sigma_s$ is the extinction coefficient, and $B$ is the isothermal emission source (Planck function for a gray medium). To isolate the effect of spatial discretization (numerical diffusion) on a highly directional signal, consider a purely absorbing, nonemitting, nonscattering special case ($\\sigma_s = 0$, $B = 0$), for which the RTE reduces to\n$$\n\\mu \\, \\frac{d I(x)}{dx} + \\beta \\, I(x) = 0,\n$$\nwith boundary condition $I(0) = I_0$ for the single direction $\\mu = 1$. The exact solution for $x \\in [0,L]$ is\n$$\nI_{\\text{exact}}(x) = I_0 \\, \\exp\\!\\left(-\\frac{\\beta x}{\\mu}\\right).\n$$\n\nYou will compare two spatial differencing schemes on a uniform grid of $N$ cells of width $\\Delta x$, namely the step (first-order upwind) scheme and the diamond-difference (second-order centered) scheme, applied to the above purely absorbing beam problem. Define the grid Peclet number\n$$\nPe_g \\equiv \\frac{\\beta \\, \\Delta x}{\\mu}.\n$$\nFor each scheme, discretize the governing equation along the grid and advance the edge intensity from the inflow boundary at $x=0$ across $N$ cells to compute a numerical exit intensity $I_{\\text{num}}(L)$ at $x=L = N \\, \\Delta x$. Use the same inflow boundary value $I_0 = 1$ and $\\mu = 1$ for all cases.\n\nFor each test case, quantify:\n- The relative exit intensity error (dimensionless) for each scheme,\n$$\n\\varepsilon_{\\text{scheme}} = \\frac{I_{\\text{num,scheme}}(L) - I_{\\text{exact}}(L)}{I_{\\text{exact}}(L)} .\n$$\n- The equivalent numerical extinction coefficient (dimensionless) for each scheme, defined by matching the numerical exit intensity to an exponential attenuation with an effective extinction, i.e.,\n$$\nI_{\\text{num,scheme}}(L) = I_0 \\, \\exp\\!\\left(-\\frac{(\\beta + \\sigma_{\\text{num,scheme}}) \\, L}{\\mu}\\right),\n$$\nso that\n$$\n\\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{L} \\, \\ln\\!\\left(\\frac{I_{\\text{num,scheme}}(L)}{I_0}\\right) - \\beta .\n$$\n\nImplement both schemes correctly and compute $I_{\\text{num}}(L)$ for each by propagating the boundary intensity through the $N$ cells according to the respective discretization. Do not assume or use any closed-form “shortcut” per-cell amplification factors without deriving them from the discretized equation.\n\nUse the following test suite. Each test case is specified by $(\\beta, Pe_g, N)$, from which you must compute $\\Delta x = Pe_g/\\beta$, $L = N \\, \\Delta x$, with $I_0 = 1$ and $\\mu = 1$:\n- Test $1$: $(\\beta, Pe_g, N) = (\\, $1.0$ ,\\, $0.1$ ,\\, $10$ \\,)$.\n- Test $2$: $(\\beta, Pe_g, N) = (\\, $1.0$ ,\\, $0.5$ ,\\, $4$ \\,)$.\n- Test $3$: $(\\beta, Pe_g, N) = (\\, $1.5$ ,\\, $0.9$ ,\\, $2$ \\,)$.\n- Test $4$: $(\\beta, Pe_g, N) = (\\, $2.0$ ,\\, $0.01$ ,\\, $10$ \\,)$.\n- Test $5$: $(\\beta, Pe_g, N) = (\\, $0.8$ ,\\, $0.95$ ,\\, $2$ \\,)$.\n\nAll quantities are dimensionless. Angles are not required beyond $\\mu = 1$, which is dimensionless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list of five floats in the order $[Pe_g, \\varepsilon_{\\text{step}}, \\varepsilon_{\\text{diamond}}, \\sigma_{\\text{num,step}}, \\sigma_{\\text{num,diamond}}]$. The final output must therefore be a list of five such lists in the same order as the test cases, for example:\n$[ [Pe_1,\\varepsilon_{s,1},\\varepsilon_{d,1},\\sigma_{s,1},\\sigma_{d,1}], [Pe_2,\\dots], \\dots ]$.",
            "solution": "We begin from the general one-dimensional, steady, gray Radiative Transfer Equation (RTE) with absorption, emission, and isotropic scattering,\n$$\n\\mu \\, \\frac{d I(x,\\mu)}{dx} + \\beta \\, I(x,\\mu) = \\kappa \\, B + \\frac{\\sigma_s}{2} \\int_{-1}^{1} I(x,\\mu') \\, d\\mu' ,\n$$\nwhere $\\beta = \\kappa + \\sigma_s$. To isolate the numerical diffusion induced purely by spatial discretization for a collimated beam, we consider a purely absorbing, nonemitting, nonscattering medium, for which $\\sigma_s = 0$ and $B = 0$. The RTE reduces to\n$$\n\\mu \\, \\frac{d I(x)}{dx} + \\beta \\, I(x) = 0,\n$$\nwith the boundary condition $I(0) = I_0$ for a single direction $\\mu = 1$. The exact solution is\n$$\nI_{\\text{exact}}(x) = I_0 \\, \\exp\\!\\left(-\\frac{\\beta x}{\\mu}\\right) = I_0 \\, \\exp(- \\beta x) .\n$$\n\nWe discretize the slab $[0,L]$ into $N$ uniform cells of width $\\Delta x$ with $L = N \\, \\Delta x$. It is convenient to define the grid Peclet number\n$$\nPe_g \\equiv \\frac{\\beta \\, \\Delta x}{\\mu}.\n$$\nSince $\\mu = 1$ in this problem, we have $Pe_g = \\beta \\, \\Delta x$. We denote the cell-edge intensities by $I_{j-1/2}$ and $I_{j+1/2}$ at positions $x_{j-1/2}$ and $x_{j+1/2}$ for cell index $j \\in \\{1,\\dots,N\\}$, with the inflow boundary at $x_{1-1/2} = 0$.\n\nWe next derive the two spatial differencing schemes as finite-volume-like balances over a cell. Integrate the continuous equation over the cell $[x_{j-1/2}, x_{j+1/2}]$ and assume that the within-cell approximations close the system in different ways.\n\nFor the step (first-order upwind) scheme for $\\mu  0$, approximate the derivative by a forward difference of edge intensities divided by $\\Delta x$, and approximate the attenuation term within the cell by the upwind edge value. Explicitly,\n$$\n\\mu \\, \\frac{I_{j+1/2} - I_{j-1/2}}{\\Delta x} + \\beta \\, I_{j-1/2} = 0 .\n$$\nSolving for the downwind edge intensity gives\n$$\nI_{j+1/2} = I_{j-1/2} \\left(1 - \\frac{\\beta \\, \\Delta x}{\\mu}\\right) = I_{j-1/2} \\left(1 - Pe_g \\right) .\n$$\nThis is a first-order accurate, monotone update for $0 \\le Pe_g \\le 1$, beyond which the factor becomes negative and the scheme produces nonphysical sign oscillations for this problem.\n\nFor the diamond-difference (second-order centered) scheme, approximate the derivative by the edge difference over $\\Delta x$ as before, but approximate the attenuation term by the arithmetic average of the two edge values, which is equivalent to the midpoint rule for linear variation within the cell:\n$$\n\\mu \\, \\frac{I_{j+1/2} - I_{j-1/2}}{\\Delta x} + \\beta \\, \\frac{I_{j+1/2} + I_{j-1/2}}{2} = 0 .\n$$\nSolve this linear equation for $I_{j+1/2}$ in terms of $I_{j-1/2}$:\n$$\nI_{j+1/2} \\left( \\frac{\\mu}{\\Delta x} + \\frac{\\beta}{2} \\right) = I_{j-1/2} \\left( \\frac{\\mu}{\\Delta x} - \\frac{\\beta}{2} \\right) ,\n$$\nwhich yields\n$$\nI_{j+1/2} = I_{j-1/2} \\, \\frac{\\frac{\\mu}{\\Delta x} - \\frac{\\beta}{2}}{\\frac{\\mu}{\\Delta x} + \\frac{\\beta}{2}} = I_{j-1/2} \\, \\frac{1 - \\frac{\\beta \\Delta x}{2 \\mu}}{1 + \\frac{\\beta \\Delta x}{2 \\mu}} = I_{j-1/2} \\, \\frac{1 - \\frac{Pe_g}{2}}{1 + \\frac{Pe_g}{2}} .\n$$\nThis scheme is second-order accurate for small $Pe_g$ and is positivity-preserving for $Pe_g  2$.\n\nLet $r_{\\text{step}} = 1 - Pe_g$ and $r_{\\text{dd}} = \\frac{1 - Pe_g/2}{1 + Pe_g/2}$ be the per-cell amplification factors for the two schemes. Propagating from the inflow boundary $I_{1-1/2} = I_0$ through $N$ cells, we obtain the numerical exit intensities at $x = L$:\n$$\nI_{\\text{num,step}}(L) = I_0 \\, r_{\\text{step}}^{\\,N}, \\qquad I_{\\text{num,diamond}}(L) = I_0 \\, r_{\\text{dd}}^{\\,N}.\n$$\nThe exact exit intensity is\n$$\nI_{\\text{exact}}(L) = I_0 \\, \\exp\\!\\left(-\\frac{\\beta L}{\\mu}\\right) = I_0 \\, \\exp(- \\beta L) .\n$$\nWe define the relative error for each scheme as\n$$\n\\varepsilon_{\\text{scheme}} = \\frac{I_{\\text{num,scheme}}(L) - I_{\\text{exact}}(L)}{I_{\\text{exact}}(L)}.\n$$\n\nTo quantify the numerical diffusion as an equivalent additional extinction, we match the numerical exit intensity to an exponential form with an effective extinction coefficient and solve for the numerical component:\n$$\nI_{\\text{num,scheme}}(L) = I_0 \\, \\exp\\!\\left(-\\frac{(\\beta + \\sigma_{\\text{num,scheme}}) \\, L}{\\mu}\\right) \\quad \\Rightarrow \\quad \\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{L} \\, \\ln\\!\\left(\\frac{I_{\\text{num,scheme}}(L)}{I_0}\\right) - \\beta .\n$$\nSubstituting the per-cell formulations above for $I_{\\text{num,scheme}}(L)$ yields, equivalently,\n$$\n\\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{\\Delta x} \\, \\ln(r_{\\text{scheme}}) - \\beta,\n$$\nwhich is consistent with the definition using $L$ because $L = N \\, \\Delta x$ and $r_{\\text{scheme}}^{\\,N} = \\exp\\!\\left(N \\ln r_{\\text{scheme}}\\right)$.\n\nAlgorithmically, for each test case we proceed as follows:\n1. Given $(\\beta, Pe_g, N)$ and $\\mu = 1$, compute $\\Delta x = Pe_g/\\beta$ and $L = N \\, \\Delta x$.\n2. Set $I_0 = 1$.\n3. Compute $I_{\\text{exact}}(L) = \\exp(- \\beta L)$.\n4. Compute $r_{\\text{step}} = 1 - Pe_g$ and $r_{\\text{dd}} = \\frac{1 - Pe_g/2}{1 + Pe_g/2}$.\n5. Compute $I_{\\text{num,step}}(L) = I_0 \\, r_{\\text{step}}^{\\,N}$ and $I_{\\text{num,diamond}}(L) = I_0 \\, r_{\\text{dd}}^{\\,N}$.\n6. Compute $\\varepsilon_{\\text{step}}$ and $\\varepsilon_{\\text{diamond}}$ via their definitions.\n7. Compute $\\sigma_{\\text{num,step}}$ and $\\sigma_{\\text{num,diamond}}$ via the effective extinction definition,\n$$\n\\sigma_{\\text{num,scheme}} = -\\frac{\\mu}{L} \\, \\ln\\!\\left(\\frac{I_{\\text{num,scheme}}(L)}{I_0}\\right) - \\beta .\n$$\n\nDiscussion of behavior:\n- For small $Pe_g$, the diamond-difference factor expands as $r_{\\text{dd}} = \\frac{1 - Pe_g/2}{1 + Pe_g/2} = 1 - Pe_g + \\frac{Pe_g^2}{2} - \\frac{Pe_g^3}{4} + \\dots$, which matches the exact $e^{-Pe_g} = 1 - Pe_g + \\frac{Pe_g^2}{2} - \\frac{Pe_g^3}{6} + \\dots$ through second order, resulting in much smaller numerical diffusion than the step scheme, which has $r_{\\text{step}} = 1 - Pe_g$ and therefore truncates at first order.\n- As $Pe_g \\to 1^{-}$, the step scheme becomes extremely diffusive for this pure attenuation problem, since $r_{\\text{step}} \\to 0$, causing $I_{\\text{num,step}}(L) \\to 0$ even for modest $N$, whereas the exact attenuation remains finite.\n- The equivalent numerical extinction $\\sigma_{\\text{num,scheme}}$ provides a direct quantitative measure of the artificial attenuation introduced by the discretization and scales with $Pe_g$ for the step scheme and with $Pe_g^2$ for the diamond-difference scheme for small $Pe_g$.\n\nThe implementation directly encodes the derived update factors and computes the requested metrics for the specified test suite, returning the results in the required list-of-lists format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Test cases: tuples of (beta, Pe_g, N)\n    # mu = 1, I0 = 1 for all cases\n    test_cases = [\n        (1.0, 0.1, 10),   # small Peclet, many cells\n        (1.0, 0.5, 4),    # moderate Peclet\n        (1.5, 0.9, 2),    # high Peclet but  1 for step stability\n        (2.0, 0.01, 10),  # very small Peclet\n        (0.8, 0.95, 2),   # near-unity Peclet\n    ]\n    mu = 1.0\n    I0 = 1.0\n\n    results = []\n    for beta, Pe, N in test_cases:\n        dx = Pe / beta\n        L = N * dx\n\n        # Exact exit intensity\n        I_exact = I0 * np.exp(-(beta * L) / mu)\n\n        # Per-cell amplification factors derived for Q=0 case\n        r_step = 1.0 - Pe\n        r_dd = (1.0 - 0.5 * Pe) / (1.0 + 0.5 * Pe)\n\n        # Numerical exit intensities\n        I_step = I0 * (r_step ** N)\n        I_dd = I0 * (r_dd ** N)\n\n        # Relative errors (dimensionless)\n        err_step = (I_step - I_exact) / I_exact\n        err_dd = (I_dd - I_exact) / I_exact\n\n        # Equivalent numerical extinction (dimensionless)\n        # Guard against any tiny negative due to floating point by max with tiny positive\n        I_step_pos = max(I_step, 1e-300)\n        I_dd_pos = max(I_dd, 1e-300)\n\n        sigma_num_step = -(mu / L) * np.log(I_step_pos / I0) - beta\n        sigma_num_dd = -(mu / L) * np.log(I_dd_pos / I0) - beta\n\n        results.append([\n            float(Pe),\n            float(err_step),\n            float(err_dd),\n            float(sigma_num_step),\n            float(sigma_num_dd),\n        ])\n\n    # Final print statement in the exact required format.\n    # Print list of lists as a single-line string.\n    # Use default str conversion for floats.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}