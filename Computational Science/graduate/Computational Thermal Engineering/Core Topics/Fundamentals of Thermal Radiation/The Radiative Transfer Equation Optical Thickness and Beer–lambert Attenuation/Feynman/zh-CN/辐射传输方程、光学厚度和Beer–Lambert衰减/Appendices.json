{
    "hands_on_practices": [
        {
            "introduction": "比尔-朗伯定律是理解辐射衰减的基石，而本实践旨在连接这一基本理论与实际应用。通过处理模拟的实验数据，你将学习如何使用统计方法提取关键的吸收系数（$\\kappa$），并掌握如何量化结果中的不确定性。这项练习将加深你对物理定律、数据分析和误差传播之间内在联系的理解。",
            "id": "3994664",
            "problem": "考虑一维、稳态、准直的辐射在一个均匀、等温、非散射、纯吸收介质中的传输。从纯吸收的辐射传输方程出发，表述辐射强度如何沿路径衰减，并将对数吸光度定义为一个可测量。以此为基础，为吸收系数构建一个基于统计原理的线性推断方法，并量化到光学厚度的不确定性传播。在一个完整的、可运行的程序中实现此过程。\n\n使用的科学背景和定义：\n- 一维、稳态的纯吸收辐射传输方程是基本依据。\n- 将吸光度定义为测量强度和入射强度的对数函数。\n- 将光学厚度定义为吸收系数和路径长度的乘积。\n\n你的程序必须：\n1. 假设测量强度和入射强度的测量噪声是独立的高斯噪声，使用一阶不确定性传播，将测量强度转换为吸光度值及其不确定性。\n2. 在异方差高斯噪声下，使用最大似然估计（等效于加权最小二乘法）对吸光度与路径长度的线性模型进行拟合。\n3. 从线性拟合中提取吸收系数及其标准不确定度，并使用双标准差准则验证截距是否在统计上与零一致。\n4. 将提取的吸收系数不确定性传播到指定目标路径长度处的光学厚度，如果提供了目标路径长度的不确定性，则在传播中包含它。\n\n单位和数值报告要求：\n- 路径长度 $L$ 以米 ($m$) 为单位。\n- 吸收系数 $\\kappa$ 必须以逆米 ($m^{-1}$) 报告。\n- 吸光度 $A$ 和光学厚度 $\\tau$ 是无量纲的。\n- 数值的最终输出必须四舍五入到六位小数。\n\n测试套件：\n使用以下三个测试用例。对于每个用例，给定测量的路径长度 $L$（单位为 $m$）、测量的透射强度 $I$（单位为 $W\\,m^{-2}$）、恒定的入射强度 $I_0$（单位为 $W\\,m^{-2}$）以及标准差 $\\sigma_I$ 和 $\\sigma_{I_0}$（单位为 $W\\,m^{-2}$）的数组。你必须通过一阶传播计算吸光度值 $A_i=-\\ln(I_i/I_0)$ 和吸光度不确定性 $\\sigma_{A_i}$。然后执行加权线性拟合 $A_i = a + \\kappa L_i + \\varepsilon_i$，提取 $\\kappa$ 及其标准不确定度，检验 $a$ 是否在零的两个标准差范围内，并通过不确定性传播计算在目标路径长度 $L^\\star$ 处的光学厚度。当提供了目标路径长度不确定性 $\\sigma_{L^\\star}$ 时，将其包含在传播计算中；否则，将 $L^\\star$ 视为精确值。\n\n- 用例1（一般情况，中等吸收）：\n  - $L = [0.005, 0.010, 0.015, 0.020, 0.025]$ $m$\n  - $I = [0.862, 0.742, 0.635, 0.550, 0.470]$ $W\\,m^{-2}$\n  - $I_0 = 1.000$ $W\\,m^{-2}$\n  - 对数组中的每个 $I$，$\\sigma_I = 0.005$ $W\\,m^{-2}$\n  - $\\sigma_{I_0} = 0.002$ $W\\,m^{-2}$\n  - $L^\\star = 0.040$ $m$\n  - $\\sigma_{L^\\star} = 0.000$ $m$\n\n- 用例2（接近透明，包含路径长度不确定性）：\n  - $L = [0.020, 0.040, 0.060, 0.080, 0.100]$ $m$\n  - $I = [0.962, 0.921, 0.888, 0.850, 0.820]$ $W\\,m^{-2}$\n  - $I_0 = 1.000$ $W\\,m^{-2}$\n  - 对数组中的每个 $I$，$\\sigma_I = 0.004$ $W\\,m^{-2}$\n  - $\\sigma_{I_0} = 0.001$ $W\\,m^{-2}$\n  - $L^\\star = 0.050$ $m$\n  - $\\sigma_{L^\\star} = 0.00025$ $m$\n\n- 用例3（强吸收，路径长度较小）：\n  - $L = [0.001, 0.003, 0.005, 0.007, 0.009]$ $m$\n  - $I = [0.890, 0.700, 0.546, 0.435, 0.338]$ $W\\,m^{-2}$\n  - $I_0 = 1.000$ $W\\,m^{-2}$\n  - 对数组中的每个 $I$，$\\sigma_I = 0.006$ $W\\,m^{-2}$\n  - $\\sigma_{I_0} = 0.003$ $W\\,m^{-2}$\n  - $L^\\star = 0.010$ $m$\n  - $\\sigma_{L^\\star} = 0.000$ $m$\n\n要实现的计算细节：\n- 吸光度：$A_i = -\\ln\\!\\left(\\dfrac{I_i}{I_0}\\right)$。\n- 通过一阶传播和独立性假设计算吸光度不确定性：$\\sigma_{A_i} = \\sqrt{\\left(\\dfrac{\\partial A}{\\partial I}\\Big|_{I_i,I_0}\\right)^2 \\sigma_I^2 + \\left(\\dfrac{\\partial A}{\\partial I_0}\\Big|_{I_i,I_0}\\right)^2 \\sigma_{I_0}^2}$，其中 $\\dfrac{\\partial A}{\\partial I} = -\\dfrac{1}{I}$ 和 $\\dfrac{\\partial A}{\\partial I_0} = \\dfrac{1}{I_0}$ 在测量值处进行计算。\n- 异方差高斯噪声下的加权线性拟合：最小化 $\\sum_i w_i \\left(A_i - a - \\kappa L_i\\right)^2$，权重为 $w_i = \\dfrac{1}{\\sigma_{A_i}^2}$；从加权正规矩阵的逆矩阵计算参数协方差。\n- 截距验证：返回一个布尔值，指示是否满足 $|a| \\le 2\\,\\sigma_a$。\n- 目标路径长度处的光学厚度及其不确定性：$\\tau^\\star = \\kappa\\,L^\\star$ 和 $\\sigma_{\\tau^\\star} = \\sqrt{(L^\\star)^2 \\sigma_\\kappa^2 + \\kappa^2 \\sigma_{L^\\star}^2}$，假设 $\\kappa$ 和 $L^\\star$ 之间相互独立。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的输出本身必须是一个列表，包含五个条目，顺序为 $\\left[\\kappa,\\;\\sigma_\\kappa,\\;\\tau^\\star,\\;\\sigma_{\\tau^\\star},\\;\\text{pass\\_zero\\_intercept}\\right]$，其中前四个是四舍五入到六位小数的浮点数，最后一个是布尔值。例如，总体格式为 $[[\\dots],[\\dots],[\\dots]]$，无额外文本。",
            "solution": "该问题是有效的，因为它科学上基于辐射传输原理，统计上使用成熟的线性推断和不确定性传播方法，问题陈述良好，并提供了一套完整、一致且可形式化的要求。\n\n解决方案首先从基本物理学推导出线性模型，然后详细说明用于参数估计和不确定性量化的统计方法。\n\n**1. 物理模型：比尔-朗伯定律**\n\n该问题涉及在一维、均匀、非散射、纯吸收介质中的辐射传输。辐射强度 $I$ 相对于路径长度 $s$ 的变化由纯吸收的辐射传输方程（RTE）描述：\n$$\n\\frac{dI}{ds} = -\\kappa I\n$$\n其中 $\\kappa$ 是介质的吸收系数，单位为逆长度（例如 $m^{-1}$）。这是一个一阶线性常微分方程。我们可以通过分离变量并沿长度为 $L$ 的路径积分来求解它：\n$$\n\\int_{I_0}^{I(L)} \\frac{dI}{I} = \\int_0^L -\\kappa \\, ds\n$$\n这里，$I_0$ 是 $s=0$ 处的入射强度，$I(L)$ 是穿过路径长度 $L$ 后的透射强度。由于介质是均匀的，$\\kappa$ 沿路径为常数。积分得出：\n$$\n\\ln(I(L)) - \\ln(I_0) = -\\kappa L\n$$\n$$\n\\ln\\left(\\frac{I(L)}{I_0}\\right) = -\\kappa L\n$$\n对两边取指数，得到熟悉的用于衰减的比尔-朗伯定律：\n$$\nI(L) = I_0 e^{-\\kappa L}\n$$\n\n**2. 线性化和吸光度**\n\n为了从不同路径长度 $L_i$ 下的 $I(L)$ 实验测量值中确定 $\\kappa$，使用线性模型会很方便。问题将吸光度 $A$ 定义为：\n$$\nA = -\\ln\\left(\\frac{I}{I_0}\\right)\n$$\n将比尔-朗伯定律代入此定义，揭示了吸光度与路径长度之间的直接线性关系：\n$$\nA = -\\ln\\left(\\frac{I_0 e^{-\\kappa L}}{I_0}\\right) = -\\ln(e^{-\\kappa L}) = \\kappa L\n$$\n这个理论模型 $A = \\kappa L$ 表明，吸光度与路径长度成正比，吸收系数 $\\kappa$ 是比例常数。在实际实验中，我们将数据拟合到一个更通用的线性模型 $A = a + \\kappa L$ 中，其中截距 $a$ 用于解释潜在的系统误差或偏移。一个物理上理想的实验将得出截距 $a=0$。\n\n**3. 吸光度的不确定性传播**\n\n测量从来都不是完美的。测量的强度 $I_i$ 和入射强度 $I_0$ 分别具有相关的不确定性 $\\sigma_I$ 和 $\\sigma_{I_0}$。这些不确定性必须传播到计算出的吸光度值 $A_i$。使用一阶泰勒级数展开进行不确定性传播，函数 $f(x_1, x_2, \\dots)$ 的方差近似为：\n$$\n\\sigma_f^2 \\approx \\sum_j \\left(\\frac{\\partial f}{\\partial x_j}\\right)^2 \\sigma_{x_j}^2\n$$\n假设 $x_j$ 中的不确定性是独立的。对于吸光度 $A(I, I_0) = \\ln(I_0) - \\ln(I)$，偏导数为：\n$$\n\\frac{\\partial A}{\\partial I} = -\\frac{1}{I} \\quad \\text{和} \\quad \\frac{\\partial A}{\\partial I_0} = \\frac{1}{I_0}\n$$\n假设 $I$ 和 $I_0$ 的测量误差是独立的，吸光度的方差 $\\sigma_A^2$ 为：\n$$\n\\sigma_A^2 = \\left(\\frac{\\partial A}{\\partial I}\\right)^2 \\sigma_I^2 + \\left(\\frac{\\partial A}{\\partial I_0}\\right)^2 \\sigma_{I_0}^2 = \\left(-\\frac{1}{I}\\right)^2 \\sigma_I^2 + \\left(\\frac{1}{I_0}\\right)^2 \\sigma_{I_0}^2 = \\left(\\frac{\\sigma_I}{I}\\right)^2 + \\left(\\frac{\\sigma_{I_0}}{I_0}\\right)^2\n$$\n由于每个测量对 $(L_i, I_i)$ 都会有唯一的值，因此每个点得到的吸光度不确定性 $\\sigma_{A_i}$ 将会不同。这被称为异方差性。\n\n**4. 加权最小二乘（WLS）估计**\n\n为了解决这种异方差性，我们使用加权最小二乘法（WLS）来拟合线性模型 $A_i = a + \\kappa L_i$。WLS 等效于最大似然估计，前提是假设误差是独立的且呈正态分布，即 $\\varepsilon_i = A_i - (a + \\kappa L_i) \\sim \\mathcal{N}(0, \\sigma_{A_i}^2)$。该方法最小化加权残差平方和，其中每个残差的权重是其方差的倒数：\n$$\n\\chi^2(a, \\kappa) = \\sum_{i=1}^{N} w_i (A_i - a - \\kappa L_i)^2 \\quad \\text{其中} \\quad w_i = \\frac{1}{\\sigma_{A_i}^2}\n$$\n这个最小化问题可以使用矩阵代数高效求解。我们定义吸光度测量向量 $\\mathbf{y}$、参数向量 $\\mathbf{p}$ 和设计矩阵 $\\mathbf{X}$：\n$$\n\\mathbf{y} = \\begin{pmatrix} A_1 \\\\ A_2 \\\\ \\vdots \\\\ A_N \\end{pmatrix}, \\quad \\mathbf{p} = \\begin{pmatrix} a \\\\ \\kappa \\end{pmatrix}, \\quad \\mathbf{X} = \\begin{pmatrix} 1 & L_1 \\\\ 1 & L_2 \\\\ \\vdots & \\vdots \\\\ 1 & L_N \\end{pmatrix}\n$$\n参数的 WLS 估计值 $\\hat{\\mathbf{p}}$ 由下式给出：\n$$\n\\hat{\\mathbf{p}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\n其中 $\\mathbf{W}$ 是由权重 $w_i$ 构成的对角矩阵。估计参数的协方差矩阵是：\n$$\n\\mathbf{C}_{\\mathbf{p}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} = \\begin{pmatrix} \\sigma_a^2 & \\text{cov}(a, \\kappa) \\\\ \\text{cov}(a, \\kappa) & \\sigma_\\kappa^2 \\end{pmatrix}\n$$\n$\\mathbf{C}_{\\mathbf{p}}$ 的对角线元素是估计的截距 $a$ 和斜率 $\\kappa$ 的方差。标准不确定度是它们各自的平方根，$\\sigma_a = \\sqrt{(\\mathbf{C}_{\\mathbf{p}})_{00}}$ 和 $\\sigma_\\kappa = \\sqrt{(\\mathbf{C}_{\\mathbf{p}})_{11}}$。如果截距的估计值在零的两个标准差范围内，即 $|a| \\le 2\\sigma_a$，则认为其在统计上与零一致。\n\n**5. 光学厚度与不确定性传播**\n\n最后一步是计算在特定目标路径长度 $L^\\star$ 处的光学厚度 $\\tau^\\star$ 及其相关的不确定性。光学厚度定义为：\n$$\n\\tau^\\star = \\kappa L^\\star\n$$\n由于该值是从估计参数 $\\kappa$ 和目标路径长度 $L^\\star$（其本身也可能具有不确定性 $\\sigma_{L^\\star}$）导出的，我们再次使用一阶不确定性传播。$\\tau^\\star$ 的方差为：\n$$\n\\sigma_{\\tau^\\star}^2 = \\left(\\frac{\\partial \\tau^\\star}{\\partial \\kappa}\\right)^2 \\sigma_\\kappa^2 + \\left(\\frac{\\partial \\tau^\\star}{\\partial L^\\star}\\right)^2 \\sigma_{L^\\star}^2 = (L^\\star)^2 \\sigma_\\kappa^2 + \\kappa^2 \\sigma_{L^\\star}^2\n$$\n该公式假设估计的 $\\kappa$ 的不确定性与 $L^\\star$ 的不确定性是独立的，这是一个合理的假设，因为它们通常来自不同的测量过程（分别是拟合过程和路径长度测量）。标准不确定度为 $\\sigma_{\\tau^\\star} = \\sqrt{\\sigma_{\\tau^\\star}^2}$。如果 $L^\\star$ 是精确已知的，则 $\\sigma_{L^\\star} = 0$，第二项消失。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the absorption coefficient, its uncertainty, optical thickness,\n    and its uncertainty for three test cases based on radiative transfer principles.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": np.array([0.005, 0.010, 0.015, 0.020, 0.025]),\n            \"I\": np.array([0.862, 0.742, 0.635, 0.550, 0.470]),\n            \"I0\": 1.000,\n            \"sigma_I\": 0.005,\n            \"sigma_I0\": 0.002,\n            \"L_star\": 0.040,\n            \"sigma_L_star\": 0.000,\n        },\n        {\n            \"L\": np.array([0.020, 0.040, 0.060, 0.080, 0.100]),\n            \"I\": np.array([0.962, 0.921, 0.888, 0.850, 0.820]),\n            \"I0\": 1.000,\n            \"sigma_I\": 0.004,\n            \"sigma_I0\": 0.001,\n            \"L_star\": 0.050,\n            \"sigma_L_star\": 0.00025,\n        },\n        {\n            \"L\": np.array([0.001, 0.003, 0.005, 0.007, 0.009]),\n            \"I\": np.array([0.890, 0.700, 0.546, 0.435, 0.338]),\n            \"I0\": 1.000,\n            \"sigma_I\": 0.006,\n            \"sigma_I0\": 0.003,\n            \"L_star\": 0.010,\n            \"sigma_L_star\": 0.000,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        I = case[\"I\"]\n        I0 = case[\"I0\"]\n        sigma_I = case[\"sigma_I\"]\n        sigma_I0 = case[\"sigma_I0\"]\n        L_star = case[\"L_star\"]\n        sigma_L_star = case[\"sigma_L_star\"]\n\n        # 1. Transform measured intensities into absorbance and their uncertainties.\n        # A = -ln(I/I0) = ln(I0) - ln(I)\n        A = np.log(I0) - np.log(I)\n        \n        # Uncertainty propagation: sigma_A^2 = (sigma_I/I)^2 + (sigma_I0/I0)^2\n        # sigma_I can be a scalar or array; numpy handles broadcasting.\n        sigma_A_sq = (sigma_I / I)**2 + (sigma_I0 / I0)**2\n        \n        # 2. Fit a linear model using Weighted Least Squares (WLS).\n        # Model: A = a + k*L\n        # Matrix formulation: y = X * p, where p = [a, k]^T\n        \n        # Construct the design matrix X\n        X = np.vstack([np.ones(len(L)), L]).T\n        \n        # Construct the diagonal weight matrix W from uncertainties\n        # Weights w_i = 1 / sigma_A_i^2\n        W = np.diag(1.0 / sigma_A_sq)\n        \n        # Calculate the WLS solution for parameters p = [a, k]^T\n        # p_hat = (X^T * W * X)^-1 * X^T * W * y\n        XTW = X.T @ W\n        XTWX = XTW @ X\n        XTWy = XTW @ A\n        \n        # Covariance matrix of parameters is inv(X^T * W * X)\n        cov_matrix = np.linalg.inv(XTWX)\n        \n        # Estimated parameters\n        params = cov_matrix @ XTWy\n        a, kappa = params[0], params[1]\n        \n        # 3. Extract absorption coefficient and its uncertainty, and verify intercept.\n        sigma_a = np.sqrt(cov_matrix[0, 0])\n        sigma_kappa = np.sqrt(cov_matrix[1, 1])\n        \n        # Intercept verification: |a| = 2 * sigma_a\n        pass_zero_intercept = np.abs(a) = 2 * sigma_a\n        \n        # 4. Propagate uncertainty to optical thickness tau_star at L_star.\n        # tau_star = kappa * L_star\n        tau_star = kappa * L_star\n        \n        # Uncertainty propagation: sigma_tau^2 = (L*)^2 * sigma_k^2 + k^2 * sigma_L*^2\n        sigma_tau_star_sq = (L_star**2 * sigma_kappa**2) + (kappa**2 * sigma_L_star**2)\n        sigma_tau_star = np.sqrt(sigma_tau_star_sq)\n        \n        # Round numerical results to six decimal places.\n        case_result = [\n            round(kappa, 6),\n            round(sigma_kappa, 6),\n            round(tau_star, 6),\n            round(sigma_tau_star, 6),\n            pass_zero_intercept\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list includes spaces, which is consistent\n    # with the problem's example formatting of the output list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "尽管单一吸收系数的概念十分有用，但真实材料（尤其是气体）的吸收特性会随波长急剧变化。本实践将带你超越简化的“灰体”介质假设，进入更真实的光谱世界。你将探索如何为具有复杂谱线的气体建模并计算其透射率，从而揭示精细光谱计算与简化灰体近似之间的关键差异，并理解为何高保真辐射传输模型在燃烧学和大气科学等应用中至关重要。",
            "id": "3994642",
            "problem": "一束中心位于中红外区域的准直热辐射光谱束穿过一个均匀、等温、非发射、非散射的气体层。光谱衰减由辐射传输方程 (RTE) 描述，对于单色强度 $I_{\\nu}$，在一维路径坐标 $s$ 下，该方程为 $\\,\\dfrac{\\partial I_{\\nu}}{\\partial s} = - \\kappa_{\\nu} I_{\\nu}\\,$，其中 $\\kappa_{\\nu}$ 是波数 $\\nu$ 处的光谱吸收系数，单位为逆长度。光学厚度定义为 $\\,\\tau_{\\nu}(L) = \\int_{0}^{L} \\kappa_{\\nu}(s') \\,\\mathrm{d}s'\\,$, 其中 $L$ 是该气体层的物理厚度。\n\n该气体的吸收系数随光谱变化，由一个平滑的连续背景和多条离散的光谱线构成。连续谱在整个波段内是均匀的，其系数为 $\\kappa_{\\mathrm{c}}$，单位为 $\\mathrm{m}^{-1}$。光谱线由归一化的洛伦兹线型表示。对于中心位于 $\\,\\nu_{0}\\,$、半峰半宽为 $\\,\\gamma\\,$ 的谱线，其洛伦兹线型为\n$$\n\\phi_{\\mathrm{L}}(\\nu; \\nu_{0}, \\gamma) = \\frac{1}{\\pi}\\,\\frac{\\gamma}{(\\nu - \\nu_{0})^{2} + \\gamma^{2}},\n$$\n该线型满足 $\\,\\int_{-\\infty}^{\\infty} \\phi_{\\mathrm{L}}(\\nu; \\nu_{0}, \\gamma)\\,\\mathrm{d}\\nu = 1\\,$. 该波段上的光谱吸收系数可由以下模型描述\n$$\n\\kappa_{\\nu} = \\kappa_{\\mathrm{c}} + \\sum_{i=1}^{N_{\\ell}} S_{i}\\,\\phi_{\\mathrm{L}}(\\nu; \\nu_{0,i}, \\gamma_{i}),\n$$\n其中 $S_{i}$ 是积分线强度，单位为 $\\mathrm{m}^{-2}$，这确保了当 $\\nu$ 以 $\\mathrm{m}^{-1}$ 表示时，$\\,\\kappa_{\\nu}\\,$ 的单位为 $\\mathrm{m}^{-1}$。\n\n定义一个窄波数波段 $[\\nu_{1}, \\nu_{2}]$，其宽度为 $\\,\\Delta \\nu = \\nu_{2} - \\nu_{1}\\,$。假设入射光谱强度在该波段内是均匀的。波段平均透射率定义为波段平均透射强度与波段平均入射强度的比值，并且必须通过在整个波段上对RTE进行光谱求解并进行适当平均来计算。\n\n你的程序必须从RTE和上述定义出发，实现以下内容：\n\n1. 对于厚度为 $\\,L\\,$ 的均匀层，通过对RTE的光谱解进行数值积分，推导并计算在 $[\\nu_{1}, \\nu_{2}]$ 上的窄带透射率 $\\,T_{\\mathrm{NB}}\\,$。\n\n2. 计算波段平均吸收系数 $\\,\\overline{\\kappa} = \\dfrac{1}{\\Delta \\nu}\\int_{\\nu_{1}}^{\\nu_{2}} \\kappa_{\\nu}\\,\\mathrm{d}\\nu\\,$，并构建灰体比尔-朗伯透射率 $\\,T_{\\mathrm{gray,avg}} = \\exp(-\\overline{\\kappa}\\,L)\\,$。\n\n3. 对于 $\\,L  0\\,$，计算透射率匹配的有效灰体系数 $\\,\\kappa_{\\mathrm{eff,map}} = -\\dfrac{1}{L}\\ln T_{\\mathrm{NB}}\\,$，并在 $\\,L = 0\\,$ 时使用小 $L$ 极限 $\\,\\kappa_{\\mathrm{eff,map}} = \\overline{\\kappa}\\,$。报告 $\\,\\overline{\\kappa}\\,$ 和 $\\,\\kappa_{\\mathrm{eff,map}}\\,$ 的值，单位为 $\\mathrm{m}^{-1}$。\n\n数值计算中，波数的单位必须为 $\\mathrm{m}^{-1}$，层厚的单位为 $\\mathrm{m}$，连续谱吸收的单位为 $\\mathrm{m}^{-1}$，积分线强度的单位为 $\\mathrm{m}^{-2}$，洛伦兹宽度的单位为 $\\mathrm{m}^{-1}$。所有透射率均为无量纲。在 $[\\nu_{1}, \\nu_{2}]$ 上使用一个包含 $\\,N\\,$ 个点的均匀间隔网格，并使用梯形法则近似波段积分。不涉及角度，因此不需要角度单位。如果出现任何类似百分比的量，请以小数形式表示。\n\n测试套件规范：\n对于下述每个测试用例，计算并按指定顺序返回一个包含四个浮点数 $[T_{\\mathrm{NB}}, T_{\\mathrm{gray,avg}}, \\overline{\\kappa}, \\kappa_{\\mathrm{eff,map}}]$ 的列表。参数集如下：\n\n- 案例 1 (包含连续谱和多条谱线的通用情况):\n  - $\\,\\nu_{1} = 95000\\,\\mathrm{m}^{-1}\\,$, $\\,\\nu_{2} = 105000\\,\\mathrm{m}^{-1}\\,$, $\\,N = 20001\\,$.\n  - $\\,L = 1.0\\,\\mathrm{m}\\,$, $\\,\\kappa_{\\mathrm{c}} = 0.05\\,\\mathrm{m}^{-1}\\,$.\n  - 谱线: $\\,(\\nu_{0}, S, \\gamma)\\,$ 分别为 $\\, (98000\\,\\mathrm{m}^{-1}, 0.030\\,\\mathrm{m}^{-2}, 60\\,\\mathrm{m}^{-1})\\,$, $\\, (100000\\,\\mathrm{m}^{-1}, 0.050\\,\\mathrm{m}^{-2}, 60\\,\\mathrm{m}^{-1})\\,$, $\\, (102000\\,\\mathrm{m}^{-1}, 0.040\\,\\mathrm{m}^{-2}, 60\\,\\mathrm{m}^{-1})\\,$.\n\n- 案例 2 (光学薄极限):\n  - $\\,\\nu_{1} = 99500\\,\\mathrm{m}^{-1}\\,$, $\\,\\nu_{2} = 100500\\,\\mathrm{m}^{-1}\\,$, $\\,N = 20001\\,$.\n  - $\\,L = 0.01\\,\\mathrm{m}\\,$, $\\,\\kappa_{\\mathrm{c}} = 0.0\\,\\mathrm{m}^{-1}\\,$.\n  - 谱线: $\\, (100000\\,\\mathrm{m}^{-1}, 5.0\\times 10^{-4}\\,\\mathrm{m}^{-2}, 20\\,\\mathrm{m}^{-1})\\,$ 和 $\\, (100200\\,\\mathrm{m}^{-1}, 2.0\\times 10^{-4}\\,\\mathrm{m}^{-2}, 15\\,\\mathrm{m}^{-1})\\,$.\n\n- 案例 3 (强光谱变化，无连续谱):\n  - $\\,\\nu_{1} = 99900\\,\\mathrm{m}^{-1}\\,$, $\\,\\nu_{2} = 100100\\,\\mathrm{m}^{-1}\\,$, $\\,N = 20001\\,$.\n  - $\\,L = 3.0\\,\\mathrm{m}\\,$, $\\,\\kappa_{\\mathrm{c}} = 0.0\\,\\mathrm{m}^{-1}\\,$.\n  - 谱线: $\\, (100000\\,\\mathrm{m}^{-1}, 3.0\\,\\mathrm{m}^{-2}, 5.0\\,\\mathrm{m}^{-1})\\,$ 和 $\\, (100050\\,\\mathrm{m}^{-1}, 2.5\\,\\mathrm{m}^{-2}, 3.0\\,\\mathrm{m}^{-1})\\,$.\n\n- 案例 4 (极窄谱线，高分辨率):\n  - $\\,\\nu_{1} = 99950\\,\\mathrm{m}^{-1}\\,$, $\\,\\nu_{2} = 100050\\,\\mathrm{m}^{-1}\\,$, $\\,N = 40001\\,$.\n  - $\\,L = 2.0\\,\\mathrm{m}\\,$, $\\,\\kappa_{\\mathrm{c}} = 0.0\\,\\mathrm{m}^{-1}\\,$.\n  - 谱线: $\\, (100000\\,\\mathrm{m}^{-1}, 0.20\\,\\mathrm{m}^{-2}, 0.50\\,\\mathrm{m}^{-1})\\,$.\n\n- 案例 5 (零路径长度边界条件):\n  - $\\,\\nu_{1} = 99500\\,\\mathrm{m}^{-1}\\,$, $\\,\\nu_{2} = 100500\\,\\mathrm{m}^{-1}\\,$, $\\,N = 20001\\,$.\n  - $\\,L = 0.0\\,\\mathrm{m}\\,$, $\\,\\kappa_{\\mathrm{c}} = 0.20\\,\\mathrm{m}^{-1}\\,$.\n  - 谱线: $\\, (100000\\,\\mathrm{m}^{-1}, 0.050\\,\\mathrm{m}^{-2}, 30\\,\\mathrm{m}^{-1})\\,$.\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个以逗号分隔的 Python 风格的列表的列表形式的结果。每个内部列表按上述顺序对应一个测试用例，并包含四个十进制数 $[T_{\\mathrm{NB}}, T_{\\mathrm{gray,avg}}, \\overline{\\kappa}, \\kappa_{\\mathrm{eff,map}}]$。例如，打印的结构必须类似于 $[[a_{1},b_{1},c_{1},d_{1}],[a_{2},b_{2},c_{2},d_{2}],\\ldots]$，不含任何额外文本。所有透射率均为无量纲，所有吸收系数的单位必须为 $\\mathrm{m}^{-1}$。",
            "solution": "该问题是有效的，因为它在科学上基于辐射传输的原理，其定义和参数集完整且一致，问题本身是适定的，并且其表述是客观的。因此，我们可以继续进行推导和求解。\n\n该问题的基础是针对非发射、非散射介质的一维辐射传输方程 (RTE)，其形式如下：\n$$\n\\frac{\\partial I_{\\nu}}{\\partial s} = - \\kappa_{\\nu} I_{\\nu}\n$$\n此处，$I_{\\nu}$ 是波数 $\\nu$ 处的单色光谱强度，$s$ 是路径坐标，$\\kappa_{\\nu}$ 是光谱吸收系数。\n\n对于厚度为 $L$ 的均匀气体层，吸收系数 $\\kappa_{\\nu}$ 相对于路径坐标 $s$ 是一个常数。这使得可以直接对RTE进行积分。我们分离变量，并从入射边界 $s=0$ 积分到出射边界 $s=L$：\n$$\n\\int_{I_{\\nu}(0)}^{I_{\\nu}(L)} \\frac{\\mathrm{d}I_{\\nu}'}{I_{\\nu}'} = \\int_{0}^{L} -\\kappa_{\\nu} \\,\\mathrm{d}s'\n$$\n这得到：\n$$\n\\ln(I_{\\nu}(L)) - \\ln(I_{\\nu}(0)) = -\\kappa_{\\nu} (L - 0)\n$$\n$$\n\\ln\\left(\\frac{I_{\\nu}(L)}{I_{\\nu}(0)}\\right) = -\\kappa_{\\nu}L\n$$\n对等式两边取指数，我们得到单色辐射的比尔-朗伯定律：\n$$\nI_{\\nu}(L) = I_{\\nu}(0) e^{-\\kappa_{\\nu}L}\n$$\n单色透射率 $T_{\\nu}$ 是透射强度与入射强度的比值：\n$$\nT_{\\nu} = \\frac{I_{\\nu}(L)}{I_{\\nu}(0)} = e^{-\\kappa_{\\nu}L}\n$$\n问题将光谱吸收系数 $\\kappa_{\\nu}$ 指定为一个恒定的连续背景 $\\kappa_{\\mathrm{c}}$ 与一系列 $N_{\\ell}$ 条光谱线之和，每条谱线都具有洛伦兹线型 $\\phi_{\\mathrm{L}}$：\n$$\n\\kappa_{\\nu} = \\kappa_{\\mathrm{c}} + \\sum_{i=1}^{N_{\\ell}} S_{i}\\,\\phi_{\\mathrm{L}}(\\nu; \\nu_{0,i}, \\gamma_{i})\n$$\n其中归一化的洛伦兹线型由下式给出：\n$$\n\\phi_{\\mathrm{L}}(\\nu; \\nu_{0}, \\gamma) = \\frac{1}{\\pi}\\,\\frac{\\gamma}{(\\nu - \\nu_{0})^{2} + \\gamma^{2}}\n$$\n$S_i$ 是积分线强度，$\\nu_{0,i}$ 是谱线中心波数，$\\gamma_i$ 是半峰半宽 (HWHM)。所有单位均与规定一致。\n\n问题要求为窄波数波段 $[\\nu_1, \\nu_2]$ 计算以下四个量：\n\n1.  **窄带透射率, $T_{\\mathrm{NB}}$**\n    入射强度在整个波段内是均匀的。波段平均透射强度为 $\\overline{I}_{\\text{trans}} = \\frac{1}{\\Delta\\nu} \\int_{\\nu_1}^{\\nu_2} I_{\\nu}(L) \\mathrm{d}\\nu$，其中 $\\Delta\\nu = \\nu_2 - \\nu_1$。波段平均入射强度为 $\\overline{I}_{\\text{inc}} = I_{\\nu}(0)$。窄带透射率是这两者的比值：\n    $$\n    T_{\\mathrm{NB}} = \\frac{\\overline{I}_{\\text{trans}}}{\\overline{I}_{\\text{inc}}} = \\frac{1}{\\Delta\\nu} \\int_{\\nu_1}^{\\nu_2} \\frac{I_{\\nu}(L)}{I_{\\nu}(0)} \\mathrm{d}\\nu = \\frac{1}{\\Delta\\nu} \\int_{\\nu_1}^{\\nu_2} e^{-\\kappa_{\\nu}L} \\mathrm{d}\\nu\n    $$\n    这是单色透射率的光谱平均值。它必须通过数值方法计算。我们在区间 $[\\nu_1, \\nu_2]$ 内建立一个包含 $N$ 个点的均匀间隔波数网格 $\\{\\nu_j\\}_{j=1}^N$。对于每个点 $\\nu_j$，我们计算 $\\kappa_{\\nu_j}$，然后计算 $T_{\\nu_j} = e^{-\\kappa_{\\nu_j}L}$。接着使用梯形法则来近似该积分。\n\n2.  **波段平均吸收系数, $\\overline{\\kappa}$, 和灰体透射率, $T_{\\mathrm{gray,avg}}$**\n    波段平均吸收系数定义为：\n    $$\n    \\overline{\\kappa} = \\frac{1}{\\Delta \\nu}\\int_{\\nu_{1}}^{\\nu_{2}} \\kappa_{\\nu}\\,\\mathrm{d}\\nu\n    $$\n    该积分也通过在波数网格上对 $\\kappa_{\\nu_j}$ 的值使用梯形法则进行数值计算。\n    然后，使用该平均系数计算灰体比尔-朗伯透射率 $T_{\\mathrm{gray,avg}}$：\n    $$\n    T_{\\mathrm{gray,avg}} = e^{-\\overline{\\kappa}L}\n    $$\n    由于指数函数的非线性，通常情况下 $T_{\\mathrm{NB}} \\neq T_{\\mathrm{gray,avg}}$。根据凸函数 $f(x)=e^{-x}$ 的詹森不等式，我们预期 $T_{\\mathrm{NB}} \\geq T_{\\mathrm{gray,avg}}$。\n\n3.  **透射率匹配的有效系数, $\\kappa_{\\mathrm{eff,map}}$**\n    该量被定义为能够产生真实窄带透射率 $T_{\\mathrm{NB}}$ 的等效灰体吸收系数。它是通过对 $T_{\\mathrm{NB}}$ 反解比尔-朗伯定律得到的：\n    $$\n    T_{\\mathrm{NB}} = e^{-\\kappa_{\\mathrm{eff,map}}L}\n    $$\n    求解 $\\kappa_{\\mathrm{eff,map}}$ 可得：\n    $$\n    \\kappa_{\\mathrm{eff,map}} = -\\frac{1}{L}\\ln(T_{\\mathrm{NB}}) \\quad \\text{for } L  0\n    $$\n    对于 $L=0$ 的特殊情况，问题指定 $\\kappa_{\\mathrm{eff,map}} = \\overline{\\kappa}$。这与 $T_{\\mathrm{NB}}$ 的小 $L$ 泰勒级数展开是一致的，该展开表明当 $L \\rightarrow 0$ 时，$\\kappa_{\\mathrm{eff,map}} \\rightarrow \\overline{\\kappa}$。如果 $L=0$，那么 $\\kappa_{\\nu}L=0$，所以对于所有 $\\nu$，都有 $T_\\nu=1$，且 $T_{\\mathrm{NB}}=1$。此时对数将为 $\\ln(1)=0$，导致 $0/0$ 的不定形式。因此，为 $L=0$ 提供这个定义是必要的，并且具有物理意义。\n\n要实现的算法如下：\n对于每个测试用例：\n1.  在 $[\\nu_1, \\nu_2]$ 上定义一个包含 $N$ 个点的波数网格 $\\nu$。\n2.  通过将连续谱贡献与所有指定洛伦兹谱线的贡献相加，计算网格上每个点的光谱吸收系数 $\\kappa_{\\nu}$。\n3.  使用梯形法则对网格上的 $\\kappa_{\\nu}$ 进行数值积分，然后除以带宽 $\\Delta\\nu = \\nu_2 - \\nu_1$，从而计算波段平均吸收系数 $\\overline{\\kappa}$。\n4.  计算灰体透射率 $T_{\\mathrm{gray,avg}} = e^{-\\overline{\\kappa}L}$。处理 $L=0$ 的情况，此时 $T_{\\mathrm{gray,avg}}=1$。\n5.  计算每个网格点的光谱透射率 $T_{\\nu} = e^{-\\kappa_{\\nu}L}$。对于 $L=0$，$T_{\\nu}=1$。\n6.  使用梯形法则对网格上的 $T_{\\nu}$ 进行数值积分，然后除以带宽 $\\Delta\\nu$，从而计算窄带透射率 $T_{\\mathrm{NB}}$。\n7.  计算有效吸收系数 $\\kappa_{\\mathrm{eff,map}}$。如果 $L=0$，则设置 $\\kappa_{\\mathrm{eff,map}} = \\overline{\\kappa}$。如果 $L0$，则计算 $\\kappa_{\\mathrm{eff,map}} = -\\frac{1}{L}\\ln(T_{\\mathrm{NB}})$。\n8.  收集四个结果 $[T_{\\mathrm{NB}}, T_{\\mathrm{gray,avg}}, \\overline{\\kappa}, \\kappa_{\\mathrm{eff,map}}]$。\n此过程将应用于所有指定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes radiative properties for a gas layer based on spectral data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"nu1\": 95000.0, \"nu2\": 105000.0, \"N\": 20001, \"L\": 1.0, \"k_c\": 0.05,\n            \"lines\": [\n                {\"nu0\": 98000.0, \"S\": 0.030, \"gamma\": 60.0},\n                {\"nu0\": 100000.0, \"S\": 0.050, \"gamma\": 60.0},\n                {\"nu0\": 102000.0, \"S\": 0.040, \"gamma\": 60.0},\n            ],\n        },\n        {\n            \"nu1\": 99500.0, \"nu2\": 100500.0, \"N\": 20001, \"L\": 0.01, \"k_c\": 0.0,\n            \"lines\": [\n                {\"nu0\": 100000.0, \"S\": 5.0e-4, \"gamma\": 20.0},\n                {\"nu0\": 100200.0, \"S\": 2.0e-4, \"gamma\": 15.0},\n            ],\n        },\n        {\n            \"nu1\": 99900.0, \"nu2\": 100100.0, \"N\": 20001, \"L\": 3.0, \"k_c\": 0.0,\n            \"lines\": [\n                {\"nu0\": 100000.0, \"S\": 3.0, \"gamma\": 5.0},\n                {\"nu0\": 100050.0, \"S\": 2.5, \"gamma\": 3.0},\n            ],\n        },\n        {\n            \"nu1\": 99950.0, \"nu2\": 100050.0, \"N\": 40001, \"L\": 2.0, \"k_c\": 0.0,\n            \"lines\": [\n                {\"nu0\": 100000.0, \"S\": 0.20, \"gamma\": 0.50},\n            ],\n        },\n        {\n            \"nu1\": 99500.0, \"nu2\": 100500.0, \"N\": 20001, \"L\": 0.0, \"k_c\": 0.20,\n            \"lines\": [\n                {\"nu0\": 100000.0, \"S\": 0.050, \"gamma\": 30.0},\n            ],\n        },\n    ]\n\n    results = []\n\n    def lorentz_profile(nu, nu0, gamma):\n        \"\"\"Calculates the normalized Lorentz profile.\"\"\"\n        return (1.0 / np.pi) * (gamma / ((nu - nu0)**2 + gamma**2))\n\n    for case in test_cases:\n        nu1, nu2, N, L, k_c, lines = case.values()\n        \n        # 1. Create the wavenumber grid\n        nu_grid = np.linspace(nu1, nu2, N)\n        delta_nu = nu2 - nu1\n        \n        # 2. Calculate the spectral absorption coefficient kappa_nu\n        kappa_nu = np.full_like(nu_grid, k_c)\n        for line in lines:\n            kappa_nu += line[\"S\"] * lorentz_profile(nu_grid, line[\"nu0\"], line[\"gamma\"])\n            \n        # 3. Compute band-averaged absorption coefficient kappa_bar\n        # np.trapz integrates using the trapezoidal rule.\n        kappa_bar = np.trapz(kappa_nu, nu_grid) / delta_nu\n        \n        # 4. Compute gray Beer-Lambert transmittance T_gray,avg\n        T_gray_avg = np.exp(-kappa_bar * L)\n        \n        # 5. Compute narrow-band transmittance T_NB\n        # First, compute spectral transmittance T_nu\n        T_nu = np.exp(-kappa_nu * L)\n        T_NB = np.trapz(T_nu, nu_grid) / delta_nu\n        \n        # 6. Compute transmittance-matching effective coefficient kappa_eff,map\n        if L > 0:\n            # Prevent taking log of zero or negative for very small T_NB\n            if T_NB > 0:\n                kappa_eff_map = -np.log(T_NB) / L\n            else:\n                kappa_eff_map = np.inf # Optically thick to the point of zero transmission\n        else:  # L == 0 case\n            kappa_eff_map = kappa_bar\n            \n        # Collect results for the current case\n        case_results = [T_NB, T_gray_avg, kappa_bar, kappa_eff_map]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list is used for the inner lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在许多介质中（如生物组织），辐射不僅被吸收，还会被散射到新的方向，使得辐射传输过程变得异常复杂。本实践将探讨散射的主导作用，并介绍一种简化其复杂效应的强大方法。你将应用折合散射系数（$\\mu_{s}'$）和输运平均自由程（$l_{tr}$）等概念，来评估作为生物医学光学基石的扩散近似的有效性，从而获得对散射主导介质中复杂输运现象如何被有效建模的实践洞察。",
            "id": "3994679",
            "problem": "一束波长为 $800\\,\\mathrm{nm}$ 的准直连续波近红外光束，垂直入射到一个均匀、平面平行的人体软组织厚板上。该组织无发射且无内部源。厚板的厚度为 $L = 0.025\\,\\mathrm{m}$。在 $800\\,\\mathrm{nm}$ 波长下，该组织的代表性体光学特性为：吸收系数 $\\mu_{a} = 12\\,\\mathrm{m}^{-1}$，散射系数 $\\mu_{s} = 8000\\,\\mathrm{m}^{-1}$，以及各向异性因子 $g = 0.90$。假设为了进行体输运分析，可以忽略边界处的折射率不匹配。\n\n从稳态、无发射、宏观均匀的参与介质的辐射传输方程 (RTE) 出发，并利用消光定义以及未散射准直分量所对应的 Beer–Lambert 形式，定义弹道光束穿过该厚板的光学厚度。接下来，引用小角度前向峰值散射极限，该极限引出了折合散射系数以及在近红外光学层析成像的扩散近似中使用的相应输运描述。在这些基础上：\n\n1. 计算适用于扩散理论的、穿过该厚板的折合光学厚度。\n2. 基于第一性原理，评估在 $800\\,\\mathrm{nm}$ 波长下，对于近红外光学层析成像，扩散近似在厚板体内是否有效，并根据从输运系数中得到的长度尺度来证明你的评估。\n\n将你的最终答案报告为折合光学厚度的值，该值是一个无量纲数。将最终答案四舍五入到三位有效数字。",
            "solution": "该问题要求计算人体组织厚板的折合光学厚度，并评估光在其中输运的扩散近似的有效性。解题过程将从第一性原理出发，以辐射传输方程 (RTE) 为起点。\n\n对于一个无发射、无源、吸收和散射的介质，其稳态RTE由下式给出：\n$$\n\\hat{s} \\cdot \\nabla I_{\\lambda}(\\mathbf{r}, \\hat{s}) = -(\\mu_{a} + \\mu_{s}) I_{\\lambda}(\\mathbf{r}, \\hat{s}) + \\mu_{s} \\int_{4\\pi} I_{\\lambda}(\\mathbf{r}, \\hat{s}') \\Phi_{\\lambda}(\\hat{s}', \\hat{s}) \\frac{d\\Omega'}{4\\pi}\n$$\n此处，$I_{\\lambda}(\\mathbf{r}, \\hat{s})$ 是位置 $\\mathbf{r}$ 处方向 $\\hat{s}$ 上的光谱辐射率，$\\mu_{a}$ 是吸收系数，$\\mu_{s}$ 是散射系数，$\\Phi_{\\lambda}(\\hat{s}', \\hat{s})$ 是散射相函数。$\\hat{s} \\cdot \\nabla$ 项是沿 $\\hat{s}$ 方向的方向导数。对于一个平面平行的厚板，当准直光束沿z轴垂直入射时，该方程可以简化。\n\n总消光系数定义为吸收系数和散射系数之和：$\\mu_{t} = \\mu_{a} + \\mu_{s}$。\n\n问题首先要求考虑入射准直光束的未散射（或弹道）分量。对于此分量，任何散射事件都会将辐射率从光束中移除。因此，入射散射积分项为零。准直强度 $I_{c}$ 的RTE简化为：\n$$\n\\frac{dI_{c}(z)}{dz} = -\\mu_{t} I_{c}(z)\n$$\n这就是 Beer-Lambert 定律，其解为 $I_{c}(z) = I_{c}(0) \\exp(-\\mu_{t} z)$。该弹道光束穿过整个厚度为 $L$ 的厚板的光学厚度定义为消光系数沿路径的积分。对于给定的均匀介质，即为：\n$$\n\\tau_{t} = \\int_{0}^{L} \\mu_{t} dz = \\mu_{t} L = (\\mu_{a} + \\mu_{s}) L\n$$\n这个量描述了光束未散射部分的衰减。\n\n接下来，我们考虑扩散近似，它在散射占主导地位（$\\mu_{s} \\gg \\mu_{a}$）且散射呈高度前向峰值（$g \\to 1$）的介质中有效。所提供的数据证实了这种情况：$\\mu_{s} = 8000\\,\\mathrm{m}^{-1}$ 远大于 $\\mu_{a} = 12\\,\\mathrm{m}^{-1}$，且各向异性因子 $g = 0.90$ 表明是强前向散射。\n\n在此极限下，将各向异性散射过程建模为等效的各向同性过程是很有用的。这通过引入折合散射系数（也称为输运散射系数）$\\mu_{s}'$ 来实现。其定义为：\n$$\n\\mu_{s}' = \\mu_{s}(1-g)\n$$\n该系数表示引起光子方向随机化所需的有效散射率。就动量传递而言，一次系数为 $\\mu_s'$ 的散射事件等效于多次前向峰值散射事件。扩散近似使用此折合系数来描述漫射光的输运。\n\n在扩散理论中使用的相应有效输运系数 $\\mu_{tr}$ 为：\n$$\n\\mu_{tr} = \\mu_{a} + \\mu_{s}' = \\mu_{a} + \\mu_{s}(1-g)\n$$\n现在我们来解决问题的两个部分。\n\n1. 计算穿过厚板的折合光学厚度。\n\n折合光学厚度 $\\tau'$ 类似于标准光学厚度，但它是使用输运系数 $\\mu_{tr}$ 而不是消光系数 $\\mu_{t}$ 来定义的。它用输运平均自由程来表征厚板的厚度。\n$$\n\\tau' = \\mu_{tr} L = (\\mu_{a} + \\mu_{s}(1-g))L\n$$\n代入给定值：\n- 厚板厚度: $L = 0.025\\,\\mathrm{m}$\n- 吸收系数: $\\mu_{a} = 12\\,\\mathrm{m}^{-1}$\n- 散射系数: $\\mu_{s} = 8000\\,\\mathrm{m}^{-1}$\n- 各向异性因子: $g = 0.90$\n\n首先，我们计算折合散射系数：\n$$\n\\mu_{s}' = 8000\\,\\mathrm{m}^{-1} \\times (1 - 0.90) = 8000\\,\\mathrm{m}^{-1} \\times 0.10 = 800\\,\\mathrm{m}^{-1}\n$$\n接着，我们计算输运系数：\n$$\n\\mu_{tr} = \\mu_{a} + \\mu_{s}' = 12\\,\\mathrm{m}^{-1} + 800\\,\\mathrm{m}^{-1} = 812\\,\\mathrm{m}^{-1}\n$$\n最后，我们计算折合光学厚度：\n$$\n\\tau' = \\mu_{tr} L = 812\\,\\mathrm{m}^{-1} \\times 0.025\\,\\mathrm{m} = 20.3\n$$\n该值为无量纲。\n\n2. 评估扩散近似的有效性。\n\n对于介质的体区域（即远离边界和源），扩散近似在两个主要条件下有效：\n(a) 散射占主导：单次散射反照率 $\\omega = \\frac{\\mu_{s}}{\\mu_{a} + \\mu_{s}}$ 必须非常接近于 1。\n(b) 足够的光学厚度：介质必须是光学厚的，这意味着其物理尺寸应远大于输运的特征长度尺度，即输运平均自由程 ($l_{tr}$)。\n\n让我们用给定的数据来验证这些条件。\n\n(a) 散射占主导：\n单次散射反照率为：\n$$\n\\omega = \\frac{\\mu_{s}}{\\mu_{a} + \\mu_{s}} = \\frac{8000}{12 + 8000} = \\frac{8000}{8012} \\approx 0.9985\n$$\n由于 $\\omega \\approx 1$，散射占主导的条件被很好地满足。几乎每次相互作用都是散射事件，而不是吸收事件。\n\n(b) 长度尺度和光学厚度：\n扩散理论中的基本长度尺度是输运平均自由程 $l_{tr}$，即光子在方向变得随机化之前行进的平均距离。它是输运系数的倒数：\n$$\nl_{tr} = \\frac{1}{\\mu_{tr}} = \\frac{1}{812\\,\\mathrm{m}^{-1}} \\approx 0.00123\\,\\mathrm{m} \\quad \\text{or} \\quad 1.23\\,\\mathrm{mm}\n$$\n扩散近似在离源或边界的距离远大于 $l_{tr}$ 时有效。我们必须将厚板厚度 $L$ 与此长度尺度进行比较。\n厚板厚度与输运平均自由程之比为：\n$$\n\\frac{L}{l_{tr}} = \\frac{0.025\\,\\mathrm{m}}{1/812\\,\\mathrm{m}^{-1}} = 0.025 \\times 812 = 20.3\n$$\n这个比值恰好是我们前面计算的折合光学厚度 $\\tau'$。扩散近似在介质体区域内有效的条件是折合光学厚度必须远大于 1，即 $\\tau' \\gg 1$。\n\n在本例中，$\\tau' = 20.3$。由于 $20.3$ 显著大于 1，厚板的厚度超过 20 个输运平均自由程。这确保了在厚板的中心区域（例如，在深度 $z = L/2$ 处，距离任一边界约 $10 \\, l_{tr}$），辐射场已经变得漫射且近似各向同性。初始的准直光束在最初的几个输运平均自由程内几乎完全转化为漫射光。\n\n因此，扩散近似是描述该组织厚板体内光输运的一个有效且合适的模型。\n\n要求的最终答案是折合光学厚度的数值，四舍五入到三位有效数字。我们的计算结果为 $20.3$，这已经符合要求的形式。",
            "answer": "$$\n\\boxed{20.3}\n$$"
        }
    ]
}