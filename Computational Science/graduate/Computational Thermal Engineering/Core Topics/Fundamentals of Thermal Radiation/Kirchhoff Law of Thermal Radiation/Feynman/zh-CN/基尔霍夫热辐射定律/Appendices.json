{
    "hands_on_practices": [
        {
            "introduction": "在深入探讨基尔霍夫热辐射定律的计算应用之前，我们必须首先牢固掌握其成立的核心前提。这个定律，即光谱发射率等于光谱吸收率（$\\epsilon_\\lambda = \\alpha_\\lambda$），并非在所有情况下都成立。本练习  通过一个巧妙的思想实验，揭示了该定律成立的基石——物体必须与其周围的辐射场处于热力学平衡状态。通过分析为何激光照射下的测量结果会“违背”这一定律，您将深刻理解其应用的边界条件，这是避免在复杂工程问题中误用物理定律的关键一步。",
            "id": "1872377",
            "problem": "一位实验物理学家正在研究一种保持在恒定均匀温度 $T$ 下的新型不透明材料的辐射特性。实验分两个阶段进行。\n\n首先，物理学家测量该材料自发发射的热辐射。根据这些数据，他们确定了材料的光谱发射率 $\\epsilon_{\\lambda}$，即材料的光谱辐射亮度与同温度下理想黑体的光谱辐射亮度之比。\n\n其次，他们用波长为 $\\lambda_0$ 的稳定、低功率、单色激光束照射该材料。通过测量材料吸收的入射激光功率的比例，他们确定了材料在该特定波长下的光谱吸收率 $\\alpha_{\\lambda_0}$。\n\n令他们惊讶的是，他们发现激光波长处的光谱发射率 $\\epsilon_{\\lambda_0}$ 的值不等于测得的光谱吸收率 $\\alpha_{\\lambda_0}$。也就是说，$\\epsilon_{\\lambda_0} \\neq \\alpha_{\\lambda_0}$。\n\n以下哪个陈述为这一明显违反基尔霍夫热辐射定律的现象提供了正确的物理解释？\n\nA. 基尔霍夫定律只适用于“灰体”，即发射率在所有波长下都为常数的物体。被研究的材料显然不是灰体。\n\nB. 激光的相干性对吸收过程的影响方式与非相干热辐射的发射方式有根本不同，因此使得这种比较无效。\n\nC. 基尔霍夫定律是一项基本原理，因此观测到 $\\epsilon_{\\lambda_0} \\neq \\alpha_{\\lambda_0}$ 的结果必定是由实验测量中的系统误差所致。\n\nD. 基尔霍夫定律，在其 $\\epsilon_{\\lambda} = \\alpha_{\\lambda}$ 的形式下，仅当物体与其周围的辐射场处于热平衡状态时才严格成立。激光提供了一个非热辐射源，这意味着该条件未被满足。\n\nE. 发射率是由材料温度决定的内禀属性，而吸收率则依赖于入射辐射的入射角。实验很可能未能控制激光的入射角。",
            "solution": "基尔霍夫热辐射定律是通过假设材料与一个同温度的、各向同性的、非偏振的黑体辐射场之间存在热力学平衡而建立的。定义方向和偏振分辨的光谱发射率 $\\epsilon_{\\lambda,\\Omega,p}$ 为\n$$\nL_{\\lambda}^{\\text{emit}}(\\Omega,p)=\\epsilon_{\\lambda,\\Omega,p}\\,B_{\\lambda}(T),\n$$\n其中 $B_{\\lambda}(T)$ 是普朗克黑体光谱辐射亮度。定义相应的光谱吸收率 $\\alpha_{\\lambda,\\Omega,p}$ 为材料吸收的、来自方向 $\\Omega$、偏振为 $p$ 的波长 $\\lambda$ 的入射功率的比例。\n\n在一个温度为 $T$ 的空腔中，充满了来自所有方向和所有偏振、辐射亮度为 $B_{\\lambda}(T)$ 的黑体辐射，热力学平衡和细致平衡要求在任何模式下都没有净能量流。对于每个 $\\lambda$、$\\Omega$ 和 $p$，吸收的功率与 $\\alpha_{\\lambda,\\Omega,p} B_{\\lambda}(T)$ 成正比，发射的功率与 $\\epsilon_{\\lambda,\\Omega,p} B_{\\lambda}(T)$ 成正比。如果对于某个模式 $\\epsilon_{\\lambda,\\Omega,p}\\neq\\alpha_{\\lambda,\\Omega,p}$，该模式将会有净的能量增益或损失，从而扭曲黑体光谱并破坏平衡。因此，平衡条件强制要求\n$$\n\\epsilon_{\\lambda,\\Omega,p}=\\alpha_{\\lambda,\\Omega,p}\\quad\\text{对于所有的 }\\lambda,\\Omega,p.\n$$\n\n实验的第一阶段根据自发热发射相对于 $B_{\\lambda}(T)$ 确定了 $\\epsilon_{\\lambda}$。第二阶段使用波长为 $\\lambda_{0}$ 的单色激光测量了 $\\alpha_{\\lambda_{0}}$。激光是一种非热、高度定向且通常是偏振的光源，而不是一个各向同性的黑体辐射场。因此，在测量吸收率期间，物体加辐射系统并未与其周围的辐射场处于热平衡状态，得出 $\\epsilon_{\\lambda}=\\alpha_{\\lambda}$ 的细致平衡论证不适用于那种非热照明条件。因此，在激光照射下观测到 $\\epsilon_{\\lambda_{0}}\\neq\\alpha_{\\lambda_{0}}$ 并不与基尔霍夫定律相矛盾；它反映了该等式是在热平衡条件下针对黑体辐射场推导出来的，并严格适用于这些条件。\n\n在这些选项中，正确指出这一平衡条件要求的陈述是：基尔霍夫定律，在其 $\\epsilon_{\\lambda}=\\alpha_{\\lambda}$ 的形式下，仅当物体与其周围的辐射场处于热平衡状态时才严格成立，而激光并不提供这样的条件。因此，正确选项是 D。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "在工程实践中，我们常常通过实验测量材料的一种辐射特性（如反射率），并需要据此推断出另一种特性（如发射率）。本练习  提供了一个绝佳的实践机会，让您将基尔霍夫定律与能量守恒原理相结合，来处理这类实际问题。您将为一个具有复杂光谱依赖性的不透明涂层，根据其给定的光谱反射率经验公式，计算其在特定波长和温度下的半球光谱发射率。这个过程不仅能锻炼您的计算能力，还能加深您对不透明体在热平衡条件下 $\\bar{\\epsilon}_{\\lambda} = 1 - \\bar{\\rho}_{\\lambda}$ 这一重要关系的理解。",
            "id": "3966162",
            "problem": "在温度为 $T$ 的高温辐射环境中测试一种不透明陶瓷涂层，其半球光谱反射率 $\\bar{\\rho}_{\\lambda}(\\lambda;T)$ 通过对不同波长 $\\lambda$ 下的测量数据进行拟合，报告如下：\n$$\n\\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right).\n$$\n假设该涂层在所关注的光谱带内是绝对不透明的（光谱透射率为零），表面及其周围环境处于相互热平衡状态，并且测得的反射率是真正的半球反射率（即对所有反射方向进行了适当的方向余弦加权积分）。\n\n从半球光谱吸收率和反射率的基本定义、表面辐射能量平衡以及热平衡状态下的 Kirchhoff 热辐射定律出发，确定该涂层在 $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ 和 $T^{\\star} = 1200\\,\\mathrm{K}$ 时的半球光谱发射率 $\\bar{\\epsilon}_{\\lambda}$。将最终的发射率表示为无量纲小数。将答案四舍五入至四位有效数字。",
            "solution": "该问题要求确定陶瓷涂层在特定波长 $\\lambda^{\\star}$ 和温度 $T^{\\star}$ 下的半球光谱发射率 $\\bar{\\epsilon}_{\\lambda}$。这将通过第一性原理来完成，首先从表面辐射能量守恒开始，然后应用 Kirchhoff 热辐射定律。\n\n首先，我们考虑受辐照表面的辐射能量平衡。入射光谱辐射中被吸收的部分是光谱吸收率 $\\alpha_{\\lambda}$，被反射的部分是光谱反射率 $\\rho_{\\lambda}$，被透射的部分是光谱透射率 $\\tau_{\\lambda}$。根据能量守恒，对于任何给定的波长 $\\lambda$，这三个属性的总和必须为1：\n$$ \\alpha_{\\lambda} + \\rho_{\\lambda} + \\tau_{\\lambda} = 1 $$\n这种关系适用于任何辐照条件。问题指明测得的反射率是半球的，这意味着它是对所有反射角积分得到的。因此，能量平衡中的所有属性都必须被视为半球属性。该方程可以更精确地写为：\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} + \\bar{\\tau}_{\\lambda} = 1 $$\n其中上划线表示半球属性。\n\n问题陈述该涂层是绝对不透明的。不透明性意味着没有辐射会穿透该材料。因此，半球光谱透射率为零：\n$$ \\bar{\\tau}_{\\lambda} = 0 $$\n将此条件代入能量平衡方程，可将其简化为：\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} = 1 \\quad \\implies \\quad \\bar{\\alpha}_{\\lambda} = 1 - \\bar{\\rho}_{\\lambda} $$\n该方程将任何不透明表面的半球光谱吸收率与半球光谱反射率联系起来。\n\n接下来，我们引用 Kirchhoff 热辐射定律。该定律指出，对于一个与其周围环境处于热平衡状态、发射和吸收热辐射的任意物体，其发射率等于其吸收率。对于光谱的、半球的属性，这表示为：\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = \\bar{\\alpha}_{\\lambda}(\\lambda; T) $$\n问题明确指出“表面及其周围环境处于相互热平衡状态”，这正是 Kirchhoff 定律成立的精确条件。\n\n通过将简化的能量平衡方程与 Kirchhoff 定律相结合，我们为处于热平衡状态的不透明表面的半球光谱发射率和半球光谱反射率之间建立了直接关系：\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = 1 - \\bar{\\rho}_{\\lambda}(\\lambda; T) $$\n这个方程构成了我们计算的基础。\n\n问题提供了半球光谱反射率 $\\bar{\\rho}_{\\lambda}(\\lambda;T)$ 的经验公式：\n$$ \\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right) $$\n我们被要求在特定条件 $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ 和 $T^{\\star} = 1200\\,\\mathrm{K}$ 下计算发射率。\n\n首先，我们计算反射率公式中的无量纲参数：\n$$ \\frac{\\lambda^{\\star}}{2.5\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{2.5\\,\\mu\\mathrm{m}} = 2 $$\n$$ \\frac{\\lambda^{\\star}}{10\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{10\\,\\mu\\mathrm{m}} = 0.5 $$\n$$ \\frac{T^{\\star}}{1000\\,\\mathrm{K}} = \\frac{1200\\,\\mathrm{K}}{1000\\,\\mathrm{K}} = 1.2 $$\n\n现在，将这些值代入 $\\bar{\\rho}_{\\lambda}$ 的表达式中：\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp\\left(-(2)^{2}\\right) + 0.10\\,(0.5)^{1/3} + 0.02\\,(1.2 - 1) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.02\\,(0.2) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.004 $$\n\n我们继续计算每一项的数值：\n指数项为：\n$$ 0.15\\,\\exp(-4) \\approx 0.15 \\times 0.01831566 \\approx 0.00274735 $$\n幂律项为：\n$$ 0.10\\,(0.5)^{1/3} \\approx 0.10 \\times 0.79370053 \\approx 0.07937005 $$\n将所有项相加得到反射率：\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.07 + 0.00274735 + 0.07937005 + 0.004 $$\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.15611740 $$\n\n最后，我们使用推导出的关系式计算半球光谱发射率：\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) = 1 - \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 1 - 0.15611740 $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.84388260 $$\n\n问题要求答案四舍五入到四位有效数字。第五位有效数字是 $8$，所以我们将第四位数字向上取整。\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.8439 $$\n这是在指定条件下发射率的最终无量纲值。",
            "answer": "$$\n\\boxed{0.8439}\n$$"
        },
        {
            "introduction": "为了简化复杂的辐射传热计算，工程师们广泛使用“灰体”假设，即假定物体的辐射特性与波长无关。然而，这是一个简化模型，其准确性必须得到检验。本计算练习  将指导您通过编程，量化灰体假设引入的误差。您将实现一个完整的光谱积分模型来计算精确的净辐射热流，并将其与基于普朗克加权平均发射率的灰体模型的计算结果进行比较。通过这项实践，您不仅能掌握评估工程模型简化程度的实用技能，还能深刻理解在计算保真度与计算成本之间进行权衡的必要性，这对于计算热工领域的专业人士至关重要。",
            "id": "3966176",
            "problem": "一个具有波长依赖性吸收率 $\\alpha_\\lambda$ 的表面正在与一个大的等温环境进行热辐射交换。在热力学平衡条件下，基尔霍夫热辐射定律指出，光谱发射率等于光谱吸收率，即 $\\epsilon_\\lambda = \\alpha_\\lambda$。单位波长的半球黑体光谱发射功率由普朗克定律给出，\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1},\n$$\n其中 $h$ 是普朗克常数，$c$ 是真空中的光速，$k_B$ 是玻尔兹曼常数，$\\lambda$ 是波长，$T$ 是绝对温度。总的黑体发射功率为 $\\sigma T^4$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n将从温度为 $T_s$ 的表面到温度为 $T_e$ 的环境（视角因子为1）的光谱分辨净辐射热通量定义为\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda \\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\n灰体模型用一个与波长无关的单一量 $\\epsilon_g = \\alpha_g$ 来替代光谱依赖性。为了拟合 $\\alpha_g$，使用在指定参考温度 $T_{\\text{ref}}$ 下的普朗克加权定义：\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\n相应的灰体净通量预测值为\n$$\nq_{\\text{gray}}(T_s,T_e;T_{\\text{ref}}) = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n\n您的任务是实现一个完整的程序，该程序：\n- 对于一组具有指定 $\\alpha_\\lambda$ 的合成材料和一组 $(T_s,T_e)$ 对，计算 $q_{\\text{spec}}$ 和 $q_{\\text{gray}}$，并量化由灰体假设引入的误差。\n- 使用波长上的数值积分来评估所需的积分。\n- 报告每个测试用例的相对误差，定义如下\n$$\n\\delta = \n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}},  \\text{if } q_{\\text{spec}} \\neq 0 \\\\\n0.0,  \\text{if } q_{\\text{spec}} = 0\n\\end{cases}\n$$\n此相对误差必须报告为无量纲的十进制数。在内部，所有通量必须以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位进行计算。\n\n使用以下合成材料和测试套件。对于所有情况，使用相同的波长域 $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$ 和数值上合适的波长离散化。\n\n合成材料：\n1. 材料 $\\mathcal{M}_1$（短波主导吸收）： \n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.95,  \\lambda \\le 2.5\\times 10^{-6}\\,\\mathrm{m} \\\\\n0.10,  \\lambda > 2.5\\times 10^{-6}\\,\\mathrm{m}\n\\end{cases}\n$$\n2. 材料 $\\mathcal{M}_2$（中长波段上升）：\n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.20,  \\lambda \\le 3\\times 10^{-6}\\,\\mathrm{m} \\\\\n0.20 + 0.70\\,\\dfrac{\\lambda - 3\\times 10^{-6}}{7\\times 10^{-6}},  3\\times 10^{-6}\\,\\text{m}  \\lambda  1\\times 10^{-5}\\,\\text{m} \\\\\n0.90,  \\lambda \\ge 1\\times 10^{-5}\\,\\text{m}\n\\end{cases}\n$$\n3. 材料 $\\mathcal{M}_3$（灰体基准）： \n$$\n\\alpha_\\lambda = 0.60, \\quad \\text{for all } \\lambda.\n$$\n\n灰体拟合的参考温度：\n- $T_{\\text{ref}} = 1200\\,\\mathrm{K}$。\n\n测试套件（每个案例是一个三元组 $(\\text{材料}, T_s, T_e)$）：\n- 案例 A：$(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n- 案例 B（边界）：$(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$。\n- 案例 C（符号反转）：$(\\mathcal{M}_1,\\,600\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$。\n- 案例 D（高 $T_s$）：$(\\mathcal{M}_2,\\,1500\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n- 案例 E（低 $T_s$）：$(\\mathcal{M}_2,\\,600\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n- 案例 F（灰体基准）：$(\\mathcal{M}_3,\\,1000\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n\n您的程序应生成单行输出，其中包含案例 A-F 的相对误差，按顺序排列，形式为用方括号括起来的逗号分隔列表（例如，“[errA,errB,errC,errD,errE,errF]”）。条目必须是纯十进制数。所有内部计算必须使用国际单位制（SI）中的常数 $h$、$c$、$k_B$ 和 $\\sigma$，温度单位为 $\\mathrm{K}$，波长单位为 $\\mathrm{m}$，通量单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$。",
            "solution": "计算从连接光谱特性与总辐射交换的第一性原理开始。基尔霍夫热辐射定律指出，在热力学平衡条件下，光谱发射率等于光谱吸收率，即 $\\epsilon_\\lambda = \\alpha_\\lambda$。这使得能够使用相同的光谱函数对发射和吸收进行一致的建模。\n\n单位波长的半球黑体光谱发射功率密度由普朗克定律给出，\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1}.\n$$\n这是从光子的量子统计以及对光谱辐射亮度在半球上的角度积分推导出来的。总黑体发射功率通过以下方式与此光谱相关联\n$$\n\\int_0^\\infty E_\\lambda^b(T)\\,\\mathrm{d}\\lambda = \\sigma T^4,\n$$\n其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n对于一个具有光谱吸收率 $\\alpha_\\lambda$ 且与大型等温环境进行辐射交换的表面，其净半球辐射热通量是通过对表面发射与环境辐照吸收之间的差值进行积分得到的，并由光谱吸收率加权，\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\n该表达式直接源于净交换的定义和基尔霍夫定律，后者确保了表面发射使用与控制吸收相同的光谱函数 $\\alpha_\\lambda$。\n\n灰体模型通常被用来简化计算，它用一个常数 $\\epsilon_g = \\alpha_g$ 来近似波长依赖性。为了使这种近似具有物理意义，我们将 $\\alpha_g$ 定义为在参考温度 $T_{\\text{ref}}$ 下的普朗克平均值，该温度被选择来代表材料发射最关键的条件。具体来说，\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\n这种选择确保了在 $T_{\\text{ref}}$ 时，灰体模型的总发射量与光谱模型的总发射量相匹配：\n$$\n\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda = \\alpha_g(T_{\\text{ref}})\\,\\sigma T_{\\text{ref}}^4.\n$$\n然而，当温度偏离 $T_{\\text{ref}}$ 时，或者当净交换包括从不同温度的环境中吸收辐射时，就会出现不匹配，因为普朗克分布会随温度移动，且 $\\alpha_\\lambda$ 的形状会优先加权不同的波长波段。这些不匹配量化了由灰体假设引入的误差。\n\n算法设计：\n1. 定义国际单位制（SI）中的物理常数 $h$、$c$、$k_B$ 和 $\\sigma$。\n2. 使用对数网格离散化波长域 $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$，以捕捉数量级的差异，并准确解析测试套件中温度下 $E_\\lambda^b(T)$ 的温度依赖性峰值。一个足够密集的网格，例如几千个点，可以为数值积分提供数值稳定性。\n3. 使用所述的普朗克公式实现 $E_\\lambda^b(T)$。为了数值稳健性，计算指数项 $\\exp(hc/(\\lambda k_B T))$ 时要小心避免溢出，例如，可以将其参数裁剪到一个大的有限边界内。对每个网格点和温度计算光谱。\n4. 按照规定实现材料 $\\mathcal{M}_1$、$\\mathcal{M}_2$ 和 $\\mathcal{M}_3$ 的合成 $\\alpha_\\lambda$。对于分段定义，确保在分段边界处的连续性。\n5. 通过数值积分计算 $\\alpha_g(T_{\\text{ref}})$：\n$$\n\\alpha_g(T_{\\text{ref}}) \\approx \\frac{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4},\n$$\n使用相同的波长网格。在对数网格上使用梯形法则是可以接受的，因为积分是关于 $\\lambda$ 的；梯形法则一致地考虑了可变的间距。\n6. 对于每个测试用例 $(\\text{材料},T_s,T_e)$，计算\n$$\nq_{\\text{spec}} \\approx \\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda,\n$$\n和\n$$\nq_{\\text{gray}} = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n7. 计算相对误差\n$$\n\\delta =\n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}},   \\text{if } q_{\\text{spec}} \\neq 0 \\\\\n0.0,   \\text{if } q_{\\text{spec}} = 0\n\\end{cases}\n$$\n这个无量纲的度量标准分离了因使用常数 $\\alpha_g$ 代替真实光谱 $\\alpha_\\lambda$ 而引入的差异。\n8. 将案例 A-F 的相对误差汇总到一个列表中，并以规定的格式打印。\n\n测试套件的科学解释：\n- 案例 A 使用材料 $\\mathcal{M}_1$，其中 $T_s = T_{\\text{ref}}$，环境温度较低。发射部分在 $T_{\\text{ref}}$ 处是匹配的，但从环境中吸收的辐射由 $E_\\lambda^b(T_e)$ 加权，而不是 $E_\\lambda^b(T_{\\text{ref}})$，从而引入误差。\n- 案例 B 是一个边界情况，其中 $T_s = T_e$，因此根据对称性 $q_{\\text{spec}} = 0$；相对误差定义为 $0.0$。\n- 案例 C 反转了温度顺序（$T_s  T_e$），产生负的净通量；在 $T_{\\text{ref}}$ 处的灰体拟合错误地加权了入射光谱，通常会增加误差幅度。\n- 案例 D 和 E 使用材料 $\\mathcal{M}_2$，其吸收率强调中长波段。当 $T_s$ 较高时（案例 D），普朗克峰移向较短波长，减少了与高 $\\alpha_\\lambda$ 波段的重叠，并放大了灰体模型的不匹配。在较低的 $T_s$（案例 E）下，普朗克峰更接近高 $\\alpha_\\lambda$ 区域，通常会减少误差。\n- 案例 F 是一个灰体基准，其中 $\\alpha_\\lambda$ 是常数；灰体模型变得精确，误差应接近机器级别的数值零。\n\n所有通量均以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 计算；程序仅输出无量纲的相对误差，形式为遵循指定格式的单个括号列表中的十进制数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nh = 6.62607015e-34       # Planck constant, J*s\nc = 2.99792458e8         # Speed of light, m/s\nk_B = 1.380649e-23       # Boltzmann constant, J/K\nsigma = 5.670374419e-8   # Stefan-Boltzmann constant, W/(m^2*K^4)\n\ndef planck_hemispherical_E_lambda(T, lam):\n    \"\"\"\n    Hemispherical blackbody spectral emissive power per unit wavelength E_lambda^b(T).\n    Uses Planck's law: E_lambda^b(T) = (2*pi*h*c^2)/lam^5 * 1/(exp(h*c/(lam*k_B*T)) - 1)\n    Returns array with same shape as lam, units W/m^3.\n    \"\"\"\n    # Avoid division by zero or invalid values at T=0\n    if T == 0.0:\n        return np.zeros_like(lam)\n    x = (h * c) / (lam * k_B * T)\n    # Clip exponent argument to avoid overflow in exp for very small lam\n    x = np.clip(x, 1e-12, 700.0)\n    denom = np.exp(x) - 1.0\n    # Where denom underflows to 0, set to np.inf to yield zero spectral power\n    denom = np.where(denom == 0.0, np.inf, denom)\n    E = (2.0 * np.pi * h * c**2) / (lam**5 * denom)\n    return E\n\ndef alpha_M1(lam):\n    \"\"\"\n    Synthetic material M1: shortwave-dominant absorption.\n    alpha_lambda = 0.95 for lambda = 2.5e-6 m, else 0.10\n    \"\"\"\n    return np.where(lam = 2.5e-6, 0.95, 0.10)\n\ndef alpha_M2(lam):\n    \"\"\"\n    Synthetic material M2: mid-to-longwave rise.\n    alpha_lambda =\n        0.20, for lambda = 3e-6 m\n        linear from 0.20 at 3e-6 to 0.90 at 1e-5 m, for 3e-6  lambda  1e-5 m\n        0.90, for lambda >= 1e-5 m\n    \"\"\"\n    a = np.empty_like(lam)\n    a.fill(0.20)\n    mask_mid = (lam > 3e-6)  (lam  1e-5)\n    # Linear interpolation between 0.20 and 0.90 over [3e-6, 1e-5]\n    a[mask_mid] = 0.20 + 0.70 * (lam[mask_mid] - 3e-6) / (7e-6)\n    a[lam >= 1e-5] = 0.90\n    return a\n\ndef alpha_M3(lam):\n    \"\"\"\n    Synthetic material M3: gray baseline.\n    alpha_lambda = 0.60 for all lambda\n    \"\"\"\n    return np.full_like(lam, 0.60)\n\ndef compute_alpha_g(alpha_func, lam, T_ref):\n    \"\"\"\n    Compute gray absorptivity alpha_g(T_ref) via Planck-weighted mean:\n    alpha_g = (integral alpha_lambda * E_lambda^b(T_ref) d lambda) / (sigma * T_ref^4)\n    \"\"\"\n    E_ref = planck_hemispherical_E_lambda(T_ref, lam)\n    alpha_vals = alpha_func(lam)\n    num = np.trapz(alpha_vals * E_ref, lam)\n    denom = sigma * T_ref**4\n    return num / denom\n\ndef compute_q_spec(alpha_func, lam, T_s, T_e):\n    \"\"\"\n    Compute spectral net flux:\n    q_spec = integral alpha_lambda * (E_lambda^b(T_s) - E_lambda^b(T_e)) d lambda\n    \"\"\"\n    E_s = planck_hemispherical_E_lambda(T_s, lam)\n    E_e = planck_hemispherical_E_lambda(T_e, lam)\n    alpha_vals = alpha_func(lam)\n    integrand = alpha_vals * (E_s - E_e)\n    return np.trapz(integrand, lam)\n\ndef solve():\n    # Wavelength grid: logarithmically spaced from 2e-7 m to 1e-4 m\n    lam_min = 2e-7\n    lam_max = 1e-4\n    # Use sufficient resolution for numerical stability\n    lam = np.logspace(np.log10(lam_min), np.log10(lam_max), num=5000)\n\n    # Reference temperature for gray-body fitting\n    T_ref = 1200.0  # K\n\n    # Map material names to functions\n    materials = {\n        \"M1\": alpha_M1,\n        \"M2\": alpha_M2,\n        \"M3\": alpha_M3,\n    }\n\n    # Define test cases: (material_key, T_s, T_e)\n    test_cases = [\n        (\"M1\", 1200.0, 300.0),  # Case A\n        (\"M1\", 1200.0, 1200.0), # Case B\n        (\"M1\", 600.0, 1200.0),  # Case C\n        (\"M2\", 1500.0, 300.0),  # Case D\n        (\"M2\", 600.0, 300.0),   # Case E\n        (\"M3\", 1000.0, 300.0),  # Case F\n    ]\n\n    results = []\n    for mat_key, T_s, T_e in test_cases:\n        alpha_func = materials[mat_key]\n        # Fit gray absorptivity at reference temperature\n        alpha_g = compute_alpha_g(alpha_func, lam, T_ref)\n        # Compute spectral net flux\n        q_spec = compute_q_spec(alpha_func, lam, T_s, T_e)\n        # Compute gray net flux\n        q_gray = alpha_g * sigma * (T_s**4 - T_e**4)\n        # Relative error\n        if q_spec != 0.0:\n            rel_err = (q_gray - q_spec) / q_spec\n        else:\n            rel_err = 0.0\n        results.append(rel_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}