{
    "hands_on_practices": [
        {
            "introduction": "Before applying any physical law, it is crucial to understand the conditions under which it is valid. Kirchhoff's law of thermal radiation, which equates spectral emissivity $\\epsilon_{\\lambda}$ to spectral absorptivity $\\alpha_{\\lambda}$, is no exception, and its misuse is a common pitfall. This thought experiment  challenges you to resolve an apparent contradiction, forcing a careful examination of the fundamental requirement of thermodynamic equilibrium between a body and its surrounding radiation field.",
            "id": "1872377",
            "problem": "An experimental physicist is investigating the radiative properties of a new opaque material held at a constant, uniform temperature $T$. The experiment proceeds in two stages.\n\nFirst, the physicist measures the thermal radiation spontaneously emitted by the material. From this data, they determine the material's spectral emissivity, $\\epsilon_{\\lambda}$, which is the ratio of the material's spectral radiance to that of an ideal blackbody at the same temperature.\n\nSecond, they illuminate the material with a stable, low-power, monochromatic laser beam of wavelength $\\lambda_0$. By measuring the fraction of incident laser power absorbed by the material, they determine its spectral absorptivity, $\\alpha_{\\lambda_0}$, at that specific wavelength.\n\nTo their surprise, they find that the value of the spectral emissivity at the laser wavelength, $\\epsilon_{\\lambda_0}$, is not equal to the measured spectral absorptivity, $\\alpha_{\\lambda_0}$. That is, $\\epsilon_{\\lambda_0} \\neq \\alpha_{\\lambda_0}$.\n\nWhich of the following statements provides the correct physical explanation for this apparent violation of Kirchhoff's law of thermal radiation?\n\nA. Kirchhoff's law only applies to \"gray bodies,\" where emissivity is constant for all wavelengths. The material under study is clearly not a gray body.\n\nB. The coherence of laser light affects the absorption process in a way that is fundamentally different from the emission of incoherent thermal radiation, thus invalidating the comparison.\n\nC. Kirchhoff's law is a fundamental principle, so the observation that $\\epsilon_{\\lambda_0} \\neq \\alpha_{\\lambda_0}$ must be the result of a systematic error in the experimental measurements.\n\nD. Kirchhoff's law, in the form $\\epsilon_{\\lambda} = \\alpha_{\\lambda}$, is strictly valid only when a body is in thermal equilibrium with its surrounding radiation field. A laser provides a non-thermal source of radiation, meaning this condition is not met.\n\nE. Emissivity is an intrinsic property determined by the temperature of the material, whereas absorptivity depends on the angle of incidence of the incoming radiation. The experiment likely failed to control the laser's angle of incidence.",
            "solution": "Kirchhoff’s law of thermal radiation is established by imposing thermodynamic equilibrium between a material and an isotropic, unpolarized blackbody radiation field at the same temperature. Define the directional, polarization-resolved spectral emissivity $\\epsilon_{\\lambda,\\Omega,p}$ by the emitted spectral radiance\n$$\nL_{\\lambda}^{\\text{emit}}(\\Omega,p)=\\epsilon_{\\lambda,\\Omega,p}\\,B_{\\lambda}(T),\n$$\nwhere $B_{\\lambda}(T)$ is the Planck blackbody spectral radiance. Define the corresponding spectral absorptivity $\\alpha_{\\lambda,\\Omega,p}$ as the fraction of incident power at wavelength $\\lambda$ from direction $\\Omega$ with polarization $p$ that is absorbed by the material.\n\nIn a cavity at temperature $T$, filled with blackbody radiation of radiance $B_{\\lambda}(T)$ incident from all directions and polarizations, thermodynamic equilibrium and detailed balance require that there be no net energy flow in any mode. For each $\\lambda$, $\\Omega$, and $p$, the absorbed power is proportional to $\\alpha_{\\lambda,\\Omega,p} B_{\\lambda}(T)$ and the emitted power is proportional to $\\epsilon_{\\lambda,\\Omega,p} B_{\\lambda}(T)$. If for some mode $\\epsilon_{\\lambda,\\Omega,p}\\neq\\alpha_{\\lambda,\\Omega,p}$, that mode would suffer a net gain or loss, distorting the blackbody spectrum and violating equilibrium. Therefore, equilibrium enforces\n$$\n\\epsilon_{\\lambda,\\Omega,p}=\\alpha_{\\lambda,\\Omega,p}\\quad\\text{for all }\\lambda,\\Omega,p.\n$$\n\nThe experiment’s first stage determines $\\epsilon_{\\lambda}$ from spontaneous thermal emission relative to $B_{\\lambda}(T)$. The second stage measures $\\alpha_{\\lambda_{0}}$ using a monochromatic laser at $\\lambda_{0}$. A laser is a non-thermal, highly directional and often polarized source, not an isotropic blackbody field. Thus the body-plus-radiation system is not in thermal equilibrium with its surrounding radiation field during the absorptivity measurement, and the detailed-balance argument that yields $\\epsilon_{\\lambda}=\\alpha_{\\lambda}$ does not apply to that non-thermal illumination condition. Consequently, observing $\\epsilon_{\\lambda_{0}}\\neq\\alpha_{\\lambda_{0}}$ under laser illumination does not contradict Kirchhoff’s law; it reflects that the equality is derived for, and strictly applies to, conditions of thermal equilibrium with a blackbody radiation field.\n\nAmong the options, the statement that correctly identifies this equilibrium condition requirement is that Kirchhoff’s law, in the form $\\epsilon_{\\lambda}=\\alpha_{\\lambda}$, is strictly valid only when the body is in thermal equilibrium with its surrounding radiation field, which a laser does not provide. Therefore the correct choice is D.",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "In many engineering applications, the radiative properties of opaque materials are characterized by measuring their reflectance, as this is often more experimentally accessible than direct emissivity measurement. This exercise  provides a direct, hands-on application of Kirchhoff's law, showing how to derive spectral emissivity from spectral reflectance data. You will work with a realistic, albeit hypothetical, empirical model for a ceramic coating, practicing the essential skill of translating measured data into the properties needed for thermal analysis.",
            "id": "3966162",
            "problem": "An opaque ceramic coating is tested in a high-temperature radiative environment at temperature $T$, and its hemispherical spectral reflectance $\\bar{\\rho}_{\\lambda}(\\lambda;T)$ is reported by the following fit to measured data across wavelength $\\lambda$:\n$$\n\\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right).\n$$\nAssume the coating is strictly opaque in the spectral band of interest (zero spectral transmittance), the surface and its surroundings are in mutual thermal equilibrium, and the measured reflectance is truly hemispherical (integrated over all reflection directions with proper direction-cosine weighting).\n\nStarting from the fundamental definitions of spectral hemispherical absorptivity and reflectance, the radiative energy balance at the surface, and the statement of Kirchhoff’s law of thermal radiation at thermal equilibrium, determine the hemispherical spectral emissivity $\\bar{\\epsilon}_{\\lambda}$ of this coating at $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ and $T^{\\star} = 1200\\,\\mathrm{K}$. Express the final emissivity as a dimensionless decimal. Round your answer to four significant figures.",
            "solution": "The problem requires the determination of the hemispherical spectral emissivity, $\\bar{\\epsilon}_{\\lambda}$, of a ceramic coating at a specific wavelength $\\lambda^{\\star}$ and temperature $T^{\\star}$. This will be accomplished by first principles, beginning with the conservation of radiative energy at a surface and then applying Kirchhoff's law of thermal radiation.\n\nFirst, we consider the radiative energy balance for an irradiated surface. The fraction of incident spectral radiation that is absorbed is the spectral absorptivity, $\\alpha_{\\lambda}$, the fraction reflected is the spectral reflectivity, $\\rho_{\\lambda}$, and the fraction transmitted is the spectral transmissivity, $\\tau_{\\lambda}$. By conservation of energy, these three properties must sum to unity for any given wavelength $\\lambda$:\n$$ \\alpha_{\\lambda} + \\rho_{\\lambda} + \\tau_{\\lambda} = 1 $$\nThis relationship holds for any irradiation conditions. The problem specifies that the measured reflectance is hemispherical, which means it is integrated over all reflection angles. Consequently, all properties in the energy balance must be considered hemispherical. The equation is more precisely written as:\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} + \\bar{\\tau}_{\\lambda} = 1 $$\nwhere the overbar denotes a hemispherical property.\n\nThe problem states that the coating is strictly opaque. Opacity implies that no radiation is transmitted through the material. Therefore, the spectral hemispherical transmissivity is zero:\n$$ \\bar{\\tau}_{\\lambda} = 0 $$\nSubstituting this condition into the energy balance equation simplifies it to:\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} = 1 \\quad \\implies \\quad \\bar{\\alpha}_{\\lambda} = 1 - \\bar{\\rho}_{\\lambda} $$\nThis equation relates the hemispherical spectral absorptivity to the hemispherical spectral reflectance for any opaque surface.\n\nNext, we invoke Kirchhoff's law of thermal radiation. This law states that for an arbitrary body emitting and absorbing thermal radiation in thermal equilibrium with its surroundings, its emissivity is equal to its absorptivity. For spectral, hemispherical properties, this is expressed as:\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = \\bar{\\alpha}_{\\lambda}(\\lambda; T) $$\nThe problem explicitly states that \"the surface and its surroundings are in mutual thermal equilibrium,\" which is the precise condition under which Kirchhoff's law is valid.\n\nBy combining the simplified energy balance with Kirchhoff's law, we establish a direct relationship between the hemispherical spectral emissivity and the hemispherical spectral reflectance for an opaque surface in thermal equilibrium:\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = 1 - \\bar{\\rho}_{\\lambda}(\\lambda; T) $$\nThis equation forms the basis of our calculation.\n\nThe problem provides an empirical formula for the hemispherical spectral reflectance $\\bar{\\rho}_{\\lambda}(\\lambda;T)$:\n$$ \\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right) $$\nWe are asked to evaluate the emissivity at the specific conditions $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ and $T^{\\star} = 1200\\,\\mathrm{K}$.\n\nFirst, we calculate the dimensionless arguments in the reflectance formula:\n$$ \\frac{\\lambda^{\\star}}{2.5\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{2.5\\,\\mu\\mathrm{m}} = 2 $$\n$$ \\frac{\\lambda^{\\star}}{10\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{10\\,\\mu\\mathrm{m}} = 0.5 $$\n$$ \\frac{T^{\\star}}{1000\\,\\mathrm{K}} = \\frac{1200\\,\\mathrm{K}}{1000\\,\\mathrm{K}} = 1.2 $$\n\nNow, substitute these values into the expression for $\\bar{\\rho}_{\\lambda}$:\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp\\left(-(2)^{2}\\right) + 0.10\\,(0.5)^{1/3} + 0.02\\,(1.2 - 1) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.02\\,(0.2) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.004 $$\n\nWe proceed to calculate the numerical value of each term:\nThe exponential term is:\n$$ 0.15\\,\\exp(-4) \\approx 0.15 \\times 0.01831566 \\approx 0.00274735 $$\nThe power law term is:\n$$ 0.10\\,(0.5)^{1/3} \\approx 0.10 \\times 0.79370053 \\approx 0.07937005 $$\nSumming all terms to find the reflectance:\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.07 + 0.00274735 + 0.07937005 + 0.004 $$\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.15611740 $$\n\nFinally, we calculate the hemispherical spectral emissivity using the derived relation:\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) = 1 - \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 1 - 0.15611740 $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.84388260 $$\n\nThe problem requires the answer to be rounded to four significant figures. The fifth significant figure is $8$, so we round up the fourth digit.\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.8439 $$\nThis is the final dimensionless value for the emissivity under the specified conditions.",
            "answer": "$$\n\\boxed{0.8439}\n$$"
        },
        {
            "introduction": "The gray-body assumption, where emissivity is treated as constant across all wavelengths, is a powerful simplification in radiative heat transfer, but it can lead to significant errors. This computational exercise  tasks you with building a model to quantify these errors by comparing a full spectral calculation against a Planck-weighted gray-body approximation. By implementing numerical integration of the Planck function over different spectral absorptivity profiles, you will gain a deeper, quantitative understanding of how spectral features govern net radiative heat exchange and learn when the gray-body model is a valid shortcut and when it fails.",
            "id": "3966176",
            "problem": "A surface with wavelength-dependent absorptivity $\\alpha_\\lambda$ is exchanging thermal radiation with a large isothermal environment. Under thermodynamic equilibrium, Kirchhoff's law of thermal radiation states that the spectral emissivity equals the spectral absorptivity, i.e., $\\epsilon_\\lambda = \\alpha_\\lambda$. The hemispherical blackbody spectral emissive power per unit wavelength is given by Planck's law,\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1},\n$$\nwhere $h$ is Planck's constant, $c$ is the speed of light in vacuum, $k_B$ is Boltzmann's constant, $\\lambda$ is the wavelength, and $T$ is the absolute temperature. The total blackbody emissive power is $\\sigma T^4$, where $\\sigma$ is the Stefan–Boltzmann constant.\n\nDefine the spectrally resolved net radiative heat flux from the surface at temperature $T_s$ to an environment at temperature $T_e$ and unit view factor as\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda \\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\nA gray-body model replaces the spectral dependence by a single wavelength-independent quantity $\\epsilon_g = \\alpha_g$. To fit $\\alpha_g$, use a Planck-weighted definition at a specified reference temperature $T_{\\text{ref}}$:\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\nThe corresponding gray-body net flux prediction is\n$$\nq_{\\text{gray}}(T_s,T_e;T_{\\text{ref}}) = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n\nYour task is to implement a complete program that:\n- Computes $q_{\\text{spec}}$ and $q_{\\text{gray}}$ and quantifies the error introduced by the gray-body assumption for a set of synthetic materials with specified $\\alpha_\\lambda$ and a set of $(T_s,T_e)$ pairs.\n- Uses numerical quadrature over wavelength to evaluate the required integrals.\n- Reports, for each test case, the relative error defined as\n$$\n\\delta = \n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}},  \\text{if } q_{\\text{spec}} \\neq 0, \\\\[6pt]\n0.0,  \\text{if } q_{\\text{spec}} = 0.\n\\end{cases}\n$$\nThis relative error must be reported as a dimensionless decimal number. Internally, all fluxes must be computed in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\nUse the following synthetic materials and test suite. For all cases, use the same wavelength domain $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$ and a numerically appropriate wavelength discretization.\n\nSynthetic materials:\n1. Material $\\mathcal{M}_1$ (shortwave-dominant absorption): \n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.95,  \\lambda \\le 2.5\\times 10^{-6}\\,\\mathrm{m},\\\\\n0.10,  \\lambda > 2.5\\times 10^{-6}\\,\\mathrm{m}.\n\\end{cases}\n$$\n2. Material $\\mathcal{M}_2$ (mid-to-longwave rise):\n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.20,  \\lambda \\le 3\\times 10^{-6}\\,\\mathrm{m},\\\\\n0.20 + 0.70\\,\\dfrac{\\lambda - 3\\times 10^{-6}}{7\\times 10^{-6}},  3\\times 10^{-6}  \\lambda  1\\times 10^{-5}\\,\\mathrm{m},\\\\\n0.90,  \\lambda \\ge 1\\times 10^{-5}\\,\\mathrm{m}.\n\\end{cases}\n$$\n3. Material $\\mathcal{M}_3$ (gray baseline): \n$$\n\\alpha_\\lambda = 0.60, \\quad \\text{for all } \\lambda.\n$$\n\nReference temperature for gray-body fitting:\n- $T_{\\text{ref}} = 1200\\,\\mathrm{K}$.\n\nTest suite (each case is a triple $(\\text{material}, T_s, T_e)$):\n- Case A: $(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n- Case B (boundary): $(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$.\n- Case C (sign reversal): $(\\mathcal{M}_1,\\,600\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$.\n- Case D (high $T_s$): $(\\mathcal{M}_2,\\,1500\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n- Case E (low $T_s$): $(\\mathcal{M}_2,\\,600\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n- Case F (gray baseline): $(\\mathcal{M}_3,\\,1000\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n\nYour program should produce a single line of output containing the relative errors for Cases A–F, in that order, as a comma-separated list enclosed in square brackets (e.g., \"[errA,errB,errC,errD,errE,errF]\"). The entries must be plain decimal numbers. All internal calculations must use the constants $h$, $c$, $k_B$, and $\\sigma$ in SI units, temperatures in $\\mathrm{K}$, wavelengths in $\\mathrm{m}$, and fluxes in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.",
            "solution": "The computation begins from first principles that connect spectral properties to total radiative exchange. Kirchhoff's law of thermal radiation states that under thermodynamic equilibrium the spectral emissivity equals the spectral absorptivity, i.e., $\\epsilon_\\lambda = \\alpha_\\lambda$. This allows modeling emission and absorption consistently with the same spectral function.\n\nThe spectral density of hemispherical blackbody emissive power per unit wavelength is provided by Planck's law,\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1}.\n$$\nThis is derived from quantum statistics for photons and angular integration of spectral radiance over a hemisphere. The total blackbody emissive power is linked to this spectrum via\n$$\n\\int_0^\\infty E_\\lambda^b(T)\\,\\mathrm{d}\\lambda = \\sigma T^4,\n$$\nwhere $\\sigma$ is the Stefan–Boltzmann constant.\n\nFor a surface with spectral absorptivity $\\alpha_\\lambda$ exchanging radiation with a large isothermal environment, the net hemispherical radiative heat flux is obtained by integrating the difference between emission from the surface and absorption of irradiation from the environment, weighted by the spectral absorptivity,\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\nThis expression directly follows from the definition of net exchange and Kirchhoff's law ensuring that emission from the surface uses the same spectral function $\\alpha_\\lambda$ that governs absorption.\n\nA gray-body model, which approximates the wavelength dependence by a constant $\\epsilon_g = \\alpha_g$, is commonly employed to simplify computations. To make this approximation physically meaningful, we define $\\alpha_g$ as a Planck-mean at a reference temperature $T_{\\text{ref}}$, chosen to represent conditions under which the material's emission is most critical. Specifically,\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\nThis choice ensures that the total emission at $T_{\\text{ref}}$ from the gray model matches the total emission from the spectral model:\n$$\n\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda = \\alpha_g(T_{\\text{ref}})\\,\\sigma T_{\\text{ref}}^4.\n$$\nHowever, when temperatures differ from $T_{\\text{ref}}$, or when net exchange includes absorption from an environment at a different temperature, mismatches occur because the Planck distribution shifts with temperature and the shape of $\\alpha_\\lambda$ preferentially weights different wavelength bands. These mismatches quantify the error introduced by the gray assumption.\n\nAlgorithmic design:\n1. Define the physical constants $h$, $c$, $k_B$, and $\\sigma$ in SI units.\n2. Discretize the wavelength domain $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$ using a logarithmic grid to capture orders of magnitude differences and accurately resolve the temperature-dependent peak of $E_\\lambda^b(T)$ for temperatures in the test suite. A sufficiently dense grid, such as several thousand points, provides numerical stability for quadrature.\n3. Implement $E_\\lambda^b(T)$ using the stated Planck formula. For numerical robustness, compute the exponential term $\\exp(hc/(\\lambda k_B T))$ with care to avoid overflow, for instance by clipping its argument to a large finite bound. The spectrum is computed for each grid point and temperature.\n4. Implement the synthetic $\\alpha_\\lambda$ for materials $\\mathcal{M}_1$, $\\mathcal{M}_2$, and $\\mathcal{M}_3$ as specified. For piecewise definitions, ensure continuity at segment boundaries.\n5. Compute $\\alpha_g(T_{\\text{ref}})$ via numerical quadrature:\n$$\n\\alpha_g(T_{\\text{ref}}) \\approx \\frac{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4},\n$$\nusing the same wavelength grid. The trapezoidal rule over a logarithmic grid is acceptable because integration is with respect to $\\lambda$; the trapezoidal rule consistently accounts for the variable spacing.\n6. For each test case $(\\text{material},T_s,T_e)$, compute\n$$\nq_{\\text{spec}} \\approx \\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda,\n$$\nand\n$$\nq_{\\text{gray}} = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n7. Compute the relative error\n$$\n\\delta =\n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}},  \\text{if } q_{\\text{spec}} \\neq 0, \\\\[6pt]\n0.0,  \\text{if } q_{\\text{spec}} = 0.\n\\end{cases}\n$$\nThis dimensionless metric isolates the discrepancy introduced by using a constant $\\alpha_g$ in place of the true spectral $\\alpha_\\lambda$.\n8. Aggregate the relative errors for Cases A–F into a single list and print it in the prescribed format.\n\nScientific interpretation of the test suite:\n- Case A uses $\\mathcal{M}_1$ with $T_s = T_{\\text{ref}}$ and a cooler environment. The emission part is matched at $T_{\\text{ref}}$, but absorption from the environment is weighted by $E_\\lambda^b(T_e)$, not $E_\\lambda^b(T_{\\text{ref}})$, introducing error.\n- Case B is a boundary where $T_s = T_e$, so $q_{\\text{spec}} = 0$ by symmetry; the relative error is defined as $0.0$.\n- Case C inverts the temperature ordering ($T_s  T_e$), producing negative net flux; the gray fit at $T_{\\text{ref}}$ misweights the incoming spectrum, often increasing error magnitude.\n- Cases D and E use $\\mathcal{M}_2$ whose absorptivity emphasizes mid-to-long wavelengths. When $T_s$ is high (Case D), the Planck peak shifts to shorter wavelengths, reducing overlap with high-$\\alpha_\\lambda$ bands and amplifying gray-model mismatch. At lower $T_s$ (Case E), the Planck peak is closer to the high-$\\alpha_\\lambda$ region, typically reducing error.\n- Case F is a gray baseline where $\\alpha_\\lambda$ is constant; the gray-body model becomes exact, and the error should be near machine-level numerical zero.\n\nAll fluxes are computed in $\\mathrm{W}\\,\\mathrm{m}^{-2}$; the program outputs only the dimensionless relative errors as a single bracketed list of decimal numbers, adhering to the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nh = 6.62607015e-34       # Planck constant, J*s\nc = 2.99792458e8         # Speed of light, m/s\nk_B = 1.380649e-23       # Boltzmann constant, J/K\nsigma = 5.670374419e-8   # Stefan-Boltzmann constant, W/(m^2*K^4)\n\ndef planck_hemispherical_E_lambda(T, lam):\n    \"\"\"\n    Hemispherical blackbody spectral emissive power per unit wavelength E_lambda^b(T).\n    Uses Planck's law: E_lambda^b(T) = (2*pi*h*c^2)/lam^5 * 1/(exp(h*c/(lam*k_B*T)) - 1)\n    Returns array with same shape as lam, units W/m^3.\n    \"\"\"\n    # Avoid division by zero or invalid values at T=0\n    if T = 0.0:\n        return np.zeros_like(lam)\n    x = (h * c) / (lam * k_B * T)\n    # Clip exponent argument to avoid overflow in exp for very small lam\n    x = np.clip(x, 1e-12, 700.0)\n    denom = np.exp(x) - 1.0\n    # Where denom underflows to 0, set to np.inf to yield zero spectral power\n    denom = np.where(denom == 0.0, np.inf, denom)\n    E = (2.0 * np.pi * h * c**2) / (lam**5 * denom)\n    return E\n\ndef alpha_M1(lam):\n    \"\"\"\n    Synthetic material M1: shortwave-dominant absorption.\n    alpha_lambda = 0.95 for lambda = 2.5e-6 m, else 0.10\n    \"\"\"\n    return np.where(lam = 2.5e-6, 0.95, 0.10)\n\ndef alpha_M2(lam):\n    \"\"\"\n    Synthetic material M2: mid-to-longwave rise.\n    alpha_lambda =\n        0.20, for lambda = 3e-6 m\n        linear from 0.20 at 3e-6 to 0.90 at 1e-5 m, for 3e-6  lambda  1e-5 m\n        0.90, for lambda = 1e-5 m\n    \"\"\"\n    a = np.empty_like(lam)\n    a.fill(0.20)\n    mask_mid = (lam  3e-6)  (lam  1e-5)\n    # Linear interpolation between 0.20 and 0.90 over [3e-6, 1e-5]\n    a[mask_mid] = 0.20 + 0.70 * (lam[mask_mid] - 3e-6) / (7e-6)\n    a[lam = 1e-5] = 0.90\n    return a\n\ndef alpha_M3(lam):\n    \"\"\"\n    Synthetic material M3: gray baseline.\n    alpha_lambda = 0.60 for all lambda\n    \"\"\"\n    return np.full_like(lam, 0.60)\n\ndef compute_alpha_g(alpha_func, lam, T_ref):\n    \"\"\"\n    Compute gray absorptivity alpha_g(T_ref) via Planck-weighted mean:\n    alpha_g = (integral alpha_lambda * E_lambda^b(T_ref) d lambda) / (sigma * T_ref^4)\n    \"\"\"\n    E_ref = planck_hemispherical_E_lambda(T_ref, lam)\n    alpha_vals = alpha_func(lam)\n    num = np.trapz(alpha_vals * E_ref, lam)\n    denom = sigma * T_ref**4\n    return num / denom\n\ndef compute_q_spec(alpha_func, lam, T_s, T_e):\n    \"\"\"\n    Compute spectral net flux:\n    q_spec = integral alpha_lambda * (E_lambda^b(T_s) - E_lambda^b(T_e)) d lambda\n    \"\"\"\n    E_s = planck_hemispherical_E_lambda(T_s, lam)\n    E_e = planck_hemispherical_E_lambda(T_e, lam)\n    alpha_vals = alpha_func(lam)\n    integrand = alpha_vals * (E_s - E_e)\n    return np.trapz(integrand, lam)\n\ndef solve():\n    # Wavelength grid: logarithmically spaced from 2e-7 m to 1e-4 m\n    lam_min = 2e-7\n    lam_max = 1e-4\n    # Use sufficient resolution for numerical stability\n    lam = np.logspace(np.log10(lam_min), np.log10(lam_max), num=5000)\n\n    # Reference temperature for gray-body fitting\n    T_ref = 1200.0  # K\n\n    # Map material names to functions\n    materials = {\n        \"M1\": alpha_M1,\n        \"M2\": alpha_M2,\n        \"M3\": alpha_M3,\n    }\n\n    # Define test cases: (material_key, T_s, T_e)\n    test_cases = [\n        (\"M1\", 1200.0, 300.0),  # Case A\n        (\"M1\", 1200.0, 1200.0), # Case B\n        (\"M1\", 600.0, 1200.0),  # Case C\n        (\"M2\", 1500.0, 300.0),  # Case D\n        (\"M2\", 600.0, 300.0),   # Case E\n        (\"M3\", 1000.0, 300.0),  # Case F\n    ]\n\n    results = []\n    for mat_key, T_s, T_e in test_cases:\n        alpha_func = materials[mat_key]\n        # Fit gray absorptivity at reference temperature\n        alpha_g = compute_alpha_g(alpha_func, lam, T_ref)\n        # Compute spectral net flux\n        q_spec = compute_q_spec(alpha_func, lam, T_s, T_e)\n        # Compute gray net flux\n        q_gray = alpha_g * sigma * (T_s**4 - T_e**4)\n        # Relative error\n        if q_spec != 0.0:\n            rel_err = (q_gray - q_spec) / q_spec\n        else:\n            rel_err = 0.0\n        results.append(rel_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}