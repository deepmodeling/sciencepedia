{
    "hands_on_practices": [
        {
            "introduction": "在应用任何物理定律之前，理解其有效性边界至关重要。本练习  提出了一个常见的悖论，旨在检验您对基尔霍夫定律最著名形式 $\\epsilon_{\\lambda} = \\alpha_{\\lambda}$ 所需的严格热平衡条件的理解。通过分析这个思想实验，您将能更深刻地认识到该定律成立的前提。",
            "id": "1872377",
            "problem": "一位实验物理学家正在研究一种保持在恒定均匀温度 $T$ 下的新型不透明材料的辐射特性。实验分两个阶段进行。\n\n首先，物理学家测量材料自发发射的热辐射。根据这些数据，他们确定了材料的光谱发射率 $\\epsilon_{\\lambda}$，即材料的光谱辐射亮度与同温度下理想黑体的光谱辐射亮度之比。\n\n其次，他们用波长为 $\\lambda_0$ 的稳定、低功率、单色激光束照射该材料。通过测量材料吸收的入射激光功率的比例，他们确定了材料在该特定波长下的光谱吸收率 $\\alpha_{\\lambda_0}$。\n\n令他们惊讶的是，他们发现在激光波长处的光谱发射率 $\\epsilon_{\\lambda_0}$ 的值不等于测得的光谱吸收率 $\\alpha_{\\lambda_0}$。也就是说，$\\epsilon_{\\lambda_0} \\neq \\alpha_{\\lambda_0}$。\n\n以下哪个陈述为这种对 Kirchhoff 热辐射定律的明显违背提供了正确的物理解释？\n\nA. Kirchhoff 定律只适用于“灰体”，即发射率在所有波长下都为常数的物体。被研究的材料显然不是灰体。\n\nB. 激光的相干性对吸收过程的影响方式与非相干热辐射的发射方式有根本不同，因此使得这种比较无效。\n\nC. Kirchhoff 定律是一项基本原理，因此观察到 $\\epsilon_{\\lambda_0} \\neq \\alpha_{\\lambda_0}$ 必然是实验测量中系统误差的结果。\n\nD. Kirchhoff 定律，在其 $\\epsilon_{\\lambda} = \\alpha_{\\lambda}$ 的形式下，仅当物体与其周围的辐射场处于热平衡状态时才严格有效。激光提供的是非热辐射源，这意味着该条件未被满足。\n\nE. 发射率是由材料温度决定的內稟属性，而吸收率则取决于入射辐射的入射角。实验可能未能控制激光的入射角。",
            "solution": "Kirchhoff 热辐射定律是通过在一个材料与同温度下各向同性、非偏振的黑体辐射场之间施加热力学平衡条件而建立的。通过发射的光谱辐射亮度来定义方向和偏振分辨的光谱发射率 $\\epsilon_{\\lambda,\\Omega,p}$\n$$\nL_{\\lambda}^{\\text{emit}}(\\Omega,p)=\\epsilon_{\\lambda,\\Omega,p}\\,B_{\\lambda}(T),\n$$\n其中 $B_{\\lambda}(T)$ 是 Planck 黑体光谱辐射亮度。将相应的光谱吸收率 $\\alpha_{\\lambda,\\Omega,p}$ 定义为在波长 $\\lambda$、方向 $\\Omega$、偏振 $p$ 的入射功率中被材料吸收的比例。\n\n在一个温度为 $T$ 的空腔中，充满了从所有方向和偏振入射的辐射亮度为 $B_{\\lambda}(T)$ 的黑体辐射，热力学平衡和细致平衡要求在任何模式下都没有净能量流。对于每个 $\\lambda$、$\\Omega$ 和 $p$，吸收的功率与 $\\alpha_{\\lambda,\\Omega,p} B_{\\lambda}(T)$ 成正比，而发射的功率与 $\\epsilon_{\\lambda,\\Omega,p} B_{\\lambda}(T)$ 成正比。如果对于某个模式 $\\epsilon_{\\lambda,\\Omega,p}\\neq\\alpha_{\\lambda,\\Omega,p}$，该模式将会有净增益或净损失，从而扭曲黑体光谱并违反平衡。因此，平衡条件强制要求\n$$\n\\epsilon_{\\lambda,\\Omega,p}=\\alpha_{\\lambda,\\Omega,p}\\quad\\text{for all }\\lambda,\\Omega,p.\n$$\n\n实验的第一阶段根据相对于 $B_{\\lambda}(T)$ 的自发热发射来确定 $\\epsilon_{\\lambda}$。第二阶段使用波长为 $\\lambda_{0}$ 的单色激光来测量 $\\alpha_{\\lambda_{0}}$。激光是一种非热的、高度定向且通常是偏振的光源，而不是一个各向同性的黑体场。因此，在测量吸收率期间，物体-辐射系统与其周围的辐射场并不处于热平衡状态，而得出 $\\epsilon_{\\lambda}=\\alpha_{\\lambda}$ 的细致平衡论证不适用于那种非热照明条件。因此，在激光照射下观察到 $\\epsilon_{\\lambda_{0}}\\neq\\alpha_{\\lambda_{0}}$ 并不与 Kirchhoff 定律相矛盾；它反映了该等式是在与黑体辐射场处于热平衡的条件下推导出来的，并严格适用于这些条件。\n\n在这些选项中，正确指出这一平衡条件要求的陈述是：Kirchhoff 定律，在其 $\\epsilon_{\\lambda}=\\alpha_{\\lambda}$ 的形式下，仅当物体与其周围的辐射场处于热平衡状态时才严格有效，而激光并不提供这种条件。因此，正确选项是 D。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "基尔霍夫定律最实际的应用之一是确定材料的辐射特性。本练习  提供了一个动手实践的机会，您将处理一个假设的反射率实验数据，并应用该定律来计算不透明表面的光谱发射率。这个过程模拟了从实验测量到工程参数提取的关键步骤。",
            "id": "3966162",
            "problem": "一种不透明的陶瓷涂层在温度为 $T$ 的高温辐射环境中进行测试，其半球光谱反射率 $\\bar{\\rho}_{\\lambda}(\\lambda;T)$ 通过对波长 $\\lambda$ 范围内的测量数据进行拟合，得到如下表达式：\n$$\n\\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right).\n$$\n假设该涂层在所关注的光谱带内是完全不透明的（光谱透射率为零），该表面及其周围环境处于相互热平衡状态，并且测得的反射率是真正的半球反射率（在所有反射方向上，使用适当的方向余弦加权进行积分）。\n\n从光谱半球吸收率和反射率的基本定义、表面的辐射能量平衡以及热平衡状态下的基尔霍夫热辐射定律（Kirchhoff’s law of thermal radiation）出发，确定该涂层在 $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ 和 $T^{\\star} = 1200\\,\\mathrm{K}$ 条件下的半球光谱发射率 $\\bar{\\epsilon}_{\\lambda}$。将最终的发射率表示为无量纲的小数。将您的答案四舍五入到四位有效数字。",
            "solution": "题目要求确定陶瓷涂层在特定波长 $\\lambda^{\\star}$ 和温度 $T^{\\star}$ 下的半球光谱发射率 $\\bar{\\epsilon}_{\\lambda}$。这将通过第一性原理来完成，首先从表面的辐射能量守恒开始，然后应用基尔霍夫热辐射定律。\n\n首先，我们考虑受辐照表面的辐射能量平衡。入射光谱辐射中被吸收的部分是光谱吸收率 $\\alpha_{\\lambda}$，被反射的部分是光谱反射率 $\\rho_{\\lambda}$，被透射的部分是光谱透射率 $\\tau_{\\lambda}$。根据能量守恒，对于任何给定的波长 $\\lambda$，这三个性质的总和必须为1：\n$$ \\alpha_{\\lambda} + \\rho_{\\lambda} + \\tau_{\\lambda} = 1 $$\n这个关系适用于任何辐照条件。题目指明测得的反射率是半球的，这意味着它是在所有反射角上积分得到的。因此，能量平衡中的所有性质都必须考虑为半球性质。该方程更精确地写作：\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} + \\bar{\\tau}_{\\lambda} = 1 $$\n其中上划线表示半球性质。\n\n题目指出涂层是完全不透明的。不透明意味着没有辐射会穿透材料。因此，光谱半球透射率为零：\n$$ \\bar{\\tau}_{\\lambda} = 0 $$\n将此条件代入能量平衡方程，可简化为：\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} = 1 \\quad \\implies \\quad \\bar{\\alpha}_{\\lambda} = 1 - \\bar{\\rho}_{\\lambda} $$\n这个方程将任何不透明表面的半球光谱吸收率与半球光谱反射率联系起来。\n\n接下来，我们引用基尔霍夫热辐射定律。该定律指出，对于一个与其周围环境处于热平衡状态、发射和吸收热辐射的任意物体，其发射率等于其吸收率。对于光谱、半球性质，这表示为：\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = \\bar{\\alpha}_{\\lambda}(\\lambda; T) $$\n题目明确指出“该表面及其周围环境处于相互热平衡状态”，这正是基尔霍夫定律成立的精确条件。\n\n通过将简化的能量平衡与基尔霍夫定律相结合，我们为处于热平衡状态的不透明表面建立了半球光谱发射率和半球光谱反射率之间的直接关系：\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = 1 - \\bar{\\rho}_{\\lambda}(\\lambda; T) $$\n该方程构成了我们计算的基础。\n\n题目给出了一个半球光谱反射率 $\\bar{\\rho}_{\\lambda}(\\lambda;T)$ 的经验公式：\n$$ \\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right) $$\n我们被要求在特定条件 $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ 和 $T^{\\star} = 1200\\,\\mathrm{K}$ 下计算发射率。\n\n首先，我们计算反射率公式中的无量纲参数：\n$$ \\frac{\\lambda^{\\star}}{2.5\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{2.5\\,\\mu\\mathrm{m}} = 2 $$\n$$ \\frac{\\lambda^{\\star}}{10\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{10\\,\\mu\\mathrm{m}} = 0.5 $$\n$$ \\frac{T^{\\star}}{1000\\,\\mathrm{K}} = \\frac{1200\\,\\mathrm{K}}{1000\\,\\mathrm{K}} = 1.2 $$\n\n现在，将这些值代入 $\\bar{\\rho}_{\\lambda}$ 的表达式中：\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp\\left(-(2)^{2}\\right) + 0.10\\,(0.5)^{1/3} + 0.02\\,(1.2 - 1) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.02\\,(0.2) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.004 $$\n\n我们继续计算每一项的数值：\n指数项是：\n$$ 0.15\\,\\exp(-4) \\approx 0.15 \\times 0.01831566 \\approx 0.00274735 $$\n幂律项是：\n$$ 0.10\\,(0.5)^{1/3} \\approx 0.10 \\times 0.79370053 \\approx 0.07937005 $$\n将所有项相加得到反射率：\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.07 + 0.00274735 + 0.07937005 + 0.004 $$\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.15611740 $$\n\n最后，我们使用推导出的关系计算半球光谱发射率：\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) = 1 - \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 1 - 0.15611740 $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.84388260 $$\n\n题目要求答案四舍五入到四位有效数字。第五位有效数字是 $8$，所以我们将第四位数字向上取整。\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.8439 $$\n这就是在指定条件下发射率的最终无量纲值。",
            "answer": "$$\n\\boxed{0.8439}\n$$"
        },
        {
            "introduction": "在工程计算中，处理光谱数据是一项挑战，因此灰体近似被广泛使用。本计算练习  将指导您构建一个数值工具，用以量化这种简化所带来的误差。通过完成这项任务，您将对灰体近似的实际局限性及其在不同工况下的适用性有深刻的理解。",
            "id": "3966176",
            "problem": "一个具有波长相关吸收率 $\\alpha_\\lambda$ 的表面正在与一个大型等温环境进行热辐射交换。在热力学平衡条件下，基尔霍夫热辐射定律 (Kirchhoff's law of thermal radiation) 指出，光谱发射率等于光谱吸收率，即 $\\epsilon_\\lambda = \\alpha_\\lambda$。单位波长的半球黑体光谱发射功率由普朗克定律 (Planck's law) 给出，\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1},\n$$\n其中 $h$ 是普朗克常数，$c$ 是真空中的光速，$k_B$ 是玻尔兹曼常数，$\\lambda$ 是波长，$T$ 是绝对温度。总黑体发射功率为 $\\sigma T^4$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n将温度为 $T_s$ 的表面到温度为 $T_e$ 的环境（视角因子为1）的光谱分辨净辐射热通量定义为\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda \\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\n灰体模型用一个与波长无关的单一量 $\\epsilon_g = \\alpha_g$ 来替代光谱相关性。为拟合 $\\alpha_g$，在指定的参考温度 $T_{\\text{ref}}$ 下使用普朗克加权定义：\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\n相应的灰体净通量预测值为\n$$\nq_{\\text{gray}}(T_s,T_e;T_{\\text{ref}}) = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n\n你的任务是实现一个完整的程序，该程序：\n- 对一组具有指定 $\\alpha_\\lambda$ 的合成材料和一组 $(T_s,T_e)$ 对，计算 $q_{\\text{spec}}$ 和 $q_{\\text{gray}}$，并量化由灰体假设引入的误差。\n- 使用对波长的数值积分来计算所需的积分。\n- 对每个测试案例，报告定义为如下的相对误差\n$$\n\\delta = \n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}},   \\text{if } q_{\\text{spec}} \\neq 0,\\\\[6pt]\n0.0,   \\text{if } q_{\\text{spec}} = 0.\n\\end{cases}\n$$\n此相对误差必须以无量纲十进制数的形式报告。在内部，所有通量必须以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位进行计算。\n\n使用以下合成材料和测试套件。对于所有情况，使用相同的波长域 $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$ 和一个数值上合适的波长离散化方案。\n\n合成材料：\n1. 材料 $\\mathcal{M}_1$（短波主导吸收）：\n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.95,  \\lambda \\le 2.5\\times 10^{-6}\\,\\mathrm{m},\\\\\n0.10,  \\lambda  2.5\\times 10^{-6}\\,\\mathrm{m}.\n\\end{cases}\n$$\n2. 材料 $\\mathcal{M}_2$（中长波段上升）：\n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.20,  \\lambda \\le 3\\times 10^{-6}\\,\\mathrm{m},\\\\\n0.20 + 0.70\\,\\dfrac{\\lambda - 3\\times 10^{-6}}{7\\times 10^{-6}},  3\\times 10^{-6}  \\lambda  1\\times 10^{-5}\\,\\mathrm{m},\\\\\n0.90,  \\lambda \\ge 1\\times 10^{-5}\\,\\mathrm{m}.\n\\end{cases}\n$$\n3. 材料 $\\mathcal{M}_3$（灰体基准）：\n$$\n\\alpha_\\lambda = 0.60, \\quad \\text{对所有 } \\lambda.\n$$\n\n用于灰体拟合的参考温度：\n- $T_{\\text{ref}} = 1200\\,\\mathrm{K}$。\n\n测试套件（每个案例都是一个三元组 $(\\text{材料}, T_s, T_e)$）：\n- 案例 A: $(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n- 案例 B (边界): $(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$。\n- 案例 C (符号反转): $(\\mathcal{M}_1,\\,600\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$。\n- 案例 D (高 $T_s$): $(\\mathcal{M}_2,\\,1500\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n- 案例 E (低 $T_s$): $(\\mathcal{M}_2,\\,600\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n- 案例 F (灰体基准): $(\\mathcal{M}_3,\\,1000\\,\\mathrm{K},\\,300\\,\\mathrm{K})$。\n\n你的程序应生成单行输出，其中包含案例 A–F 的相对误差，按顺序排列，形式为用方括号括起来的逗号分隔列表（例如，“[errA,errB,errC,errD,errE,errF]”）。列表中的条目必须是普通十进制数。所有内部计算必须使用国际单位制（SI）中的常数 $h$、$c$、$k_B$ 和 $\\sigma$，温度单位为 $\\mathrm{K}$，波长单位为 $\\mathrm{m}$，通量单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$。",
            "solution": "计算从连接光谱特性与总辐射交换的基本原理开始。基尔霍夫热辐射定律 (Kirchhoff's law of thermal radiation) 指出，在热力学平衡条件下，光谱发射率等于光谱吸收率，即 $\\epsilon_\\lambda = \\alpha_\\lambda$。这使得可以使用相同的光谱函数来一致地模拟发射和吸收。\n\n单位波长的半球黑体光谱发射功率密度由普朗克定律 (Planck's law) 给出，\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1}.\n$$\n这是从光子的量子统计以及光谱辐射亮度在半球上的角度积分推导出来的。总黑体发射功率通过以下方式与此光谱相关联：\n$$\n\\int_0^\\infty E_\\lambda^b(T)\\,\\mathrm{d}\\lambda = \\sigma T^4,\n$$\n其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n对于一个具有光谱吸收率 $\\alpha_\\lambda$ 的表面，与大型等温环境进行辐射交换时，其净半球辐射热通量是通过对表面发射与吸收来自环境的辐照之间的差值进行积分得到的，并由光谱吸收率加权，\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\n该表达式直接源于净交换的定义和基尔霍夫定律，后者确保了表面发射使用的光谱函数 $\\alpha_\\lambda$ 与控制吸收的函数相同。\n\n灰体模型通过一个常数 $\\epsilon_g = \\alpha_g$ 来近似波长依赖性，通常用于简化计算。为了使这种近似具有物理意义，我们将 $\\alpha_g$ 定义为在参考温度 $T_{\\text{ref}}$ 下的普朗克平均值，该温度被选择来代表材料发射最为关键的条件。具体来说，\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\n这一选择确保了在 $T_{\\text{ref}}$ 下，灰体模型的总发射量与光谱模型的总发射量相匹配：\n$$\n\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda = \\alpha_g(T_{\\text{ref}})\\,\\sigma T_{\\text{ref}}^4.\n$$\n然而，当温度偏离 $T_{\\text{ref}}$ 时，或者当净交换包括从不同温度的环境中吸收辐射时，就会出现不匹配，因为普朗克分布会随温度移动，并且 $\\alpha_\\lambda$ 的形状会优先加权不同的波长带。这些不匹配量化了由灰体假设引入的误差。\n\n算法设计：\n1. 定义国际单位制（SI）中的物理常数 $h$、$c$、$k_B$ 和 $\\sigma$。\n2. 使用对数网格离散化波长域 $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$，以捕捉数量级的差异，并为测试套件中的温度准确解析 $E_\\lambda^b(T)$ 的温度相关峰值。一个足够密集的网格（例如数千个点）可为积分提供数值稳定性。\n3. 使用所述的普朗克公式实现 $E_\\lambda^b(T)$。为了数值稳健性，计算指数项 $\\exp(hc/(\\lambda k_B T))$ 时要小心避免溢出，例如通过将其参数限制在一个较大的有限范围内。对每个网格点和温度计算光谱。\n4. 按照规定实现材料 $\\mathcal{M}_1$、$\\mathcal{M}_2$ 和 $\\mathcal{M}_3$ 的合成 $\\alpha_\\lambda$。对于分段定义，确保在段边界处的连续性。\n5. 通过数值积分计算 $\\alpha_g(T_{\\text{ref}})$：\n$$\n\\alpha_g(T_{\\text{ref}}) \\approx \\frac{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4},\n$$\n使用相同的波长网格。在对数网格上使用梯形法则是可接受的，因为积分是关于 $\\lambda$ 的；梯形法则能一致地处理可变间距。\n6. 对于每个测试案例 $(\\text{材料},T_s,T_e)$，计算\n$$\nq_{\\text{spec}} \\approx \\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda,\n$$\n和\n$$\nq_{\\text{gray}} = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n7. 计算相对误差\n$$\n\\delta =\n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}},  \\text{if } q_{\\text{spec}} \\neq 0,\\\\[6pt]\n0.0,  \\text{if } q_{\\text{spec}} = 0.\n\\end{cases}\n$$\n这个无量纲度量分离出了因使用常数 $\\alpha_g$ 代替真实光谱 $\\alpha_\\lambda$ 而引入的差异。\n8. 将案例 A–F 的相对误差汇总到一个列表中，并以规定的格式打印出来。\n\n测试套件的科学解释：\n- 案例 A 使用材料 $\\mathcal{M}_1$，其中 $T_s = T_{\\text{ref}}$ 且环境温度较低。发射部分在 $T_{\\text{ref}}$ 处是匹配的，但从环境中吸收的部分由 $E_\\lambda^b(T_e)$ 而非 $E_\\lambda^b(T_{\\text{ref}})$ 加权，从而引入误差。\n- 案例 B 是一个边界情况，其中 $T_s = T_e$，因此由于对称性 $q_{\\text{spec}} = 0$；相对误差定义为 $0.0$。\n- 案例 C 反转了温度顺序 ($T_s  T_e$)，产生负的净通量；在 $T_{\\text{ref}}$ 处的灰体拟合错误地加权了入射光谱，通常会增大了误差的量级。\n- 案例 D 和 E 使用材料 $\\mathcal{M}_2$，其吸收率强调中长波段。当 $T_s$ 较高时（案例 D），普朗克峰值移向较短波长，减少了与高 $\\alpha_\\lambda$ 波段的重叠，并放大了灰体模型的不匹配。在较低 $T_s$ 时（案例 E），普朗克峰值更接近高 $\\alpha_\\lambda$ 区域，通常会减小误差。\n- 案例 F 是一个灰体基准，其中 $\\alpha_\\lambda$ 是常数；灰体模型变得精确，误差应接近机器级别的数值零。\n\n所有通量都以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位计算；程序仅输出无量纲的相对误差，以单个括号括起来的十进制数列表形式，并遵循指定的格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nh = 6.62607015e-34       # Planck constant, J*s\nc = 2.99792458e8         # Speed of light, m/s\nk_B = 1.380649e-23       # Boltzmann constant, J/K\nsigma = 5.670374419e-8   # Stefan-Boltzmann constant, W/(m^2*K^4)\n\ndef planck_hemispherical_E_lambda(T, lam):\n    \"\"\"\n    Hemispherical blackbody spectral emissive power per unit wavelength E_lambda^b(T).\n    Uses Planck's law: E_lambda^b(T) = (2*pi*h*c^2)/lam^5 * 1/(exp(h*c/(lam*k_B*T)) - 1)\n    Returns array with same shape as lam, units W/m^3.\n    \"\"\"\n    # Avoid division by zero or invalid values at T=0\n    if T == 0.0:\n        return np.zeros_like(lam)\n    x = (h * c) / (lam * k_B * T)\n    # Clip exponent argument to avoid overflow in exp for very small lam\n    x = np.clip(x, 1e-12, 700.0)\n    denom = np.exp(x) - 1.0\n    # Where denom underflows to 0, set to np.inf to yield zero spectral power\n    denom = np.where(denom == 0.0, np.inf, denom)\n    E = (2.0 * np.pi * h * c**2) / (lam**5 * denom)\n    return E\n\ndef alpha_M1(lam):\n    \"\"\"\n    Synthetic material M1: shortwave-dominant absorption.\n    alpha_lambda = 0.95 for lambda = 2.5e-6 m, else 0.10\n    \"\"\"\n    return np.where(lam = 2.5e-6, 0.95, 0.10)\n\ndef alpha_M2(lam):\n    \"\"\"\n    Synthetic material M2: mid-to-longwave rise.\n    alpha_lambda =\n        0.20, for lambda = 3e-6 m\n        linear from 0.20 at 3e-6 to 0.90 at 1e-5 m, for 3e-6  lambda  1e-5 m\n        0.90, for lambda >= 1e-5 m\n    \"\"\"\n    a = np.empty_like(lam)\n    a.fill(0.20)\n    mask_mid = (lam > 3e-6)  (lam  1e-5)\n    # Linear interpolation between 0.20 and 0.90 over [3e-6, 1e-5]\n    a[mask_mid] = 0.20 + 0.70 * (lam[mask_mid] - 3e-6) / (7e-6)\n    a[lam >= 1e-5] = 0.90\n    return a\n\ndef alpha_M3(lam):\n    \"\"\"\n    Synthetic material M3: gray baseline.\n    alpha_lambda = 0.60 for all lambda\n    \"\"\"\n    return np.full_like(lam, 0.60)\n\ndef compute_alpha_g(alpha_func, lam, T_ref):\n    \"\"\"\n    Compute gray absorptivity alpha_g(T_ref) via Planck-weighted mean:\n    alpha_g = (integral alpha_lambda * E_lambda^b(T_ref) d lambda) / (sigma * T_ref^4)\n    \"\"\"\n    E_ref = planck_hemispherical_E_lambda(T_ref, lam)\n    alpha_vals = alpha_func(lam)\n    num = np.trapz(alpha_vals * E_ref, lam)\n    denom = sigma * T_ref**4\n    return num / denom\n\ndef compute_q_spec(alpha_func, lam, T_s, T_e):\n    \"\"\"\n    Compute spectral net flux:\n    q_spec = integral alpha_lambda * (E_lambda^b(T_s) - E_lambda^b(T_e)) d lambda\n    \"\"\"\n    E_s = planck_hemispherical_E_lambda(T_s, lam)\n    E_e = planck_hemispherical_E_lambda(T_e, lam)\n    alpha_vals = alpha_func(lam)\n    integrand = alpha_vals * (E_s - E_e)\n    return np.trapz(integrand, lam)\n\ndef solve():\n    # Wavelength grid: logarithmically spaced from 2e-7 m to 1e-4 m\n    lam_min = 2e-7\n    lam_max = 1e-4\n    # Use sufficient resolution for numerical stability\n    lam = np.logspace(np.log10(lam_min), np.log10(lam_max), num=5000)\n\n    # Reference temperature for gray-body fitting\n    T_ref = 1200.0  # K\n\n    # Map material names to functions\n    materials = {\n        \"M1\": alpha_M1,\n        \"M2\": alpha_M2,\n        \"M3\": alpha_M3,\n    }\n\n    # Define test cases: (material_key, T_s, T_e)\n    test_cases = [\n        (\"M1\", 1200.0, 300.0),  # Case A\n        (\"M1\", 1200.0, 1200.0), # Case B\n        (\"M1\", 600.0, 1200.0),  # Case C\n        (\"M2\", 1500.0, 300.0),  # Case D\n        (\"M2\", 600.0, 300.0),   # Case E\n        (\"M3\", 1000.0, 300.0),  # Case F\n    ]\n\n    results = []\n    for mat_key, T_s, T_e in test_cases:\n        alpha_func = materials[mat_key]\n        # Fit gray absorptivity at reference temperature\n        alpha_g = compute_alpha_g(alpha_func, lam, T_ref)\n        # Compute spectral net flux\n        q_spec = compute_q_spec(alpha_func, lam, T_s, T_e)\n        # Compute gray net flux\n        q_gray = alpha_g * sigma * (T_s**4 - T_e**4)\n        # Relative error\n        if q_spec != 0.0:\n            rel_err = (q_gray - q_spec) / q_spec\n        else:\n            rel_err = 0.0\n        results.append(rel_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}