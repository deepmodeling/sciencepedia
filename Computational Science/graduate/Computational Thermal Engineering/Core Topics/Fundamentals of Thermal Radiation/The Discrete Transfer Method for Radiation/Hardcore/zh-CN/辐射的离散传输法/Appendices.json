{
    "hands_on_practices": [
        {
            "introduction": "离散传递法 (DTM) 的核心是追踪穿过计算域的离散射线。理解射线强度如何因介质的吸收和散射而衰减是至关重要的第一步。本练习从辐射传递方程 (RTE) 的基本形式出发，推导并应用有效光学厚度的概念，这是量化射线衰减的关键参数。通过解决这个问题，您将掌握 DTM 如何在由具有不同属性的多个单元组成的非均匀介质中，沿射线路径累积衰减 。",
            "id": "3990847",
            "problem": "在计算热工学中，离散传递法 (DTM) 通过在离散化的参与性介质中追踪直线光线来模拟辐射。考虑在稳态条件下，一条单一光线穿过一个无发射、无散射的灰体介质中的 $N$ 个连续单元。在单元 $i$ 中，吸收系数 $\\kappa_{i}$ (单位为 $\\mathrm{m}^{-1}$) 在长度为 $\\Delta s_{i}$ (单位为 $\\mathrm{m}$) 的路径段上是均匀的。光线以入射辐射强度 $I_{0}$ 进入第一个单元。\n\n从无发射、无散射的灰体介质的辐射传输方程 (RTE) 出发，推导强度在单个路径段以及整个 $N$ 段路径上的衰减表达式。根据此推导，用 $\\kappa_{i}$ 和 $\\Delta s_{i}$ 来定义整条光线路径上的有效光学厚度 $\\tau_{\\mathrm{eff}}$，使得总衰减与一个光学厚度为 $\\tau_{\\mathrm{eff}}$ 的均匀平板所产生的衰减相同。解释 DTM 方法是如何在多个路径段上累积衰减的。\n\n对于一个 $N = 5$ 的特定情况，使用以下数据：\n- 单元 $1$：$\\kappa_{1} = 0.8\\,\\mathrm{m}^{-1}$，$\\Delta s_{1} = 0.30\\,\\mathrm{m}$。\n- 单元 $2$：$\\kappa_{2} = 2.3\\,\\mathrm{m}^{-1}$，$\\Delta s_{2} = 0.10\\,\\mathrm{m}$。\n- 单元 $3$：$\\kappa_{3} = 0.5\\,\\mathrm{m}^{-1}$，$\\Delta s_{3} = 1.20\\,\\mathrm{m}$。\n- 单元 $4$：$\\kappa_{4} = 1.1\\,\\mathrm{m}^{-1}$，$\\Delta s_{4} = 0.050\\,\\mathrm{m}$。\n- 单元 $5$：$\\kappa_{5} = 0.050\\,\\mathrm{m}^{-1}$，$\\Delta s_{5} = 4.00\\,\\mathrm{m}$。\n\n计算该光线的有效光学厚度 $\\tau_{\\mathrm{eff}}$。将答案四舍五入至四位有效数字。将最终的光学厚度表示为一个无量纲量。",
            "solution": "问题陈述经评估具有科学依据、提法明确且客观。它基于计算热工学中的基本辐射传输方程 (RTE) 和一种标准数值方法 (DTM)。所提供的所有数据均完整、一致且物理上合理。因此，该问题被认定为有效，并将提供解答。\n\n本分析的起点是在稳态条件下，对于灰体、无发射、无散射介质沿路径 $s$ 的辐射传输方程 (RTE)。在此类介质中，辐射强度 $I$ 的变化仅由吸收引起，吸收由吸收系数 $\\kappa$ 描述。RTE 简化为：\n$$\n\\frac{dI}{ds} = -\\kappa I\n$$\n这是一个一阶线性常微分方程。\n\n首先，我们推导强度在单个单元段（例如单元 $i$）上的衰减表达式。在该单元内，吸收系数 $\\kappa_i$ 是均匀的，路径长度为 $\\Delta s_i$。我们可以通过分离变量法求解 RTE。设 $I_{i-1}$ 是在 $s=0$（局部坐标）处进入单元的强度，$I_i$ 是在 $s=\\Delta s_i$ 处离开单元的强度。\n$$\n\\frac{dI}{I} = -\\kappa_i ds\n$$\n对单元从入口到出口进行积分：\n$$\n\\int_{I_{i-1}}^{I_i} \\frac{dI}{I} = \\int_{0}^{\\Delta s_i} -\\kappa_i ds\n$$\n$$\n\\ln(I_i) - \\ln(I_{i-1}) = -\\kappa_i \\Delta s_i\n$$\n$$\n\\ln\\left(\\frac{I_i}{I_{i-1}}\\right) = -\\kappa_i \\Delta s_i\n$$\n对两边取指数，得到单个路径段的衰减表达式：\n$$\nI_i = I_{i-1} \\exp(-\\kappa_i \\Delta s_i)\n$$\n无量纲的乘积 $\\kappa_i \\Delta s_i$ 被定义为该单元段的光学厚度 $\\tau_i$。\n\n接下来，我们推导在整个 $N$ 段路径上的衰减。离散传递法 (DTM) 通过将一个单元的输出强度视为下一个单元的输入强度来累积衰减。设进入第一个单元的初始强度为 $I_0$。\n\n离开单元 $1$ 的强度为 $I_1$：\n$$\nI_1 = I_0 \\exp(-\\kappa_1 \\Delta s_1)\n$$\n以强度 $I_1$ 进入并离开单元 $2$ 的强度为 $I_2$：\n$$\nI_2 = I_1 \\exp(-\\kappa_2 \\Delta s_2) = \\left[I_0 \\exp(-\\kappa_1 \\Delta s_1)\\right] \\exp(-\\kappa_2 \\Delta s_2)\n$$\n利用指数的性质 $\\exp(a)\\exp(b) = \\exp(a+b)$，我们得到：\n$$\nI_2 = I_0 \\exp(-(\\kappa_1 \\Delta s_1 + \\kappa_2 \\Delta s_2))\n$$\n通过归纳法，当光线穿过所有 $N$ 个单元后，最终强度 $I_N$ 为：\n$$\nI_N = I_0 \\exp\\left(-\\sum_{i=1}^{N} \\kappa_i \\Delta s_i\\right)\n$$\n该方程说明了 DTM 如何累积衰减：总衰减是一个指数函数，其宗量是光线穿过的所有单元各自光学厚度的总和。\n\n问题要求为整个路径定义一个有效光学厚度 $\\tau_{\\mathrm{eff}}$，使得总衰减与具有该光学厚度的单个均匀平板的衰减相同。通过这样一个平板的衰减将是：\n$$\nI_N = I_0 \\exp(-\\tau_{\\mathrm{eff}})\n$$\n通过将其与为 $N$ 段路径推导的表达式进行比较，我们可以直接确定有效光学厚度：\n$$\nI_0 \\exp(-\\tau_{\\mathrm{eff}}) = I_0 \\exp\\left(-\\sum_{i=1}^{N} \\kappa_i \\Delta s_i\\right)\n$$\n因此，有效光学厚度是各个光学厚度的总和：\n$$\n\\tau_{\\mathrm{eff}} = \\sum_{i=1}^{N} \\kappa_i \\Delta s_i\n$$\n这个量是无量纲的，因为吸收系数（单位 $\\mathrm{m}^{-1}$）和路径长度（单位 $\\mathrm{m}$）的乘积得到一个无量纲数。\n\n现在，我们根据给定的数据，为 $N=5$ 的特定情况计算 $\\tau_{\\mathrm{eff}}$。\n每个单元的光学厚度计算为 $\\tau_i = \\kappa_i \\Delta s_i$。\n\n单元 $1$：$\\tau_1 = \\kappa_1 \\Delta s_1 = (0.8\\,\\mathrm{m}^{-1}) \\times (0.30\\,\\mathrm{m}) = 0.24$\n单元 $2$：$\\tau_2 = \\kappa_2 \\Delta s_2 = (2.3\\,\\mathrm{m}^{-1}) \\times (0.10\\,\\mathrm{m}) = 0.23$\n单元 $3$：$\\tau_3 = \\kappa_3 \\Delta s_3 = (0.5\\,\\mathrm{m}^{-1}) \\times (1.20\\,\\mathrm{m}) = 0.60$\n单元 $4$：$\\tau_4 = \\kappa_4 \\Delta s_4 = (1.1\\,\\mathrm{m}^{-1}) \\times (0.050\\,\\mathrm{m}) = 0.055$\n单元 $5$：$\\tau_5 = \\kappa_5 \\Delta s_5 = (0.050\\,\\mathrm{m}^{-1}) \\times (4.00\\,\\mathrm{m}) = 0.200$（为中间步骤保留乘法所得的有效位数）。\n\n有效光学厚度是这些单个值的总和：\n$$\n\\tau_{\\mathrm{eff}} = \\tau_1 + \\tau_2 + \\tau_3 + \\tau_4 + \\tau_5\n$$\n$$\n\\tau_{\\mathrm{eff}} = 0.24 + 0.23 + 0.60 + 0.055 + 0.200\n$$\n$$\n\\tau_{\\mathrm{eff}} = 1.325\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $1.325$ 已经有四位有效数字，因此无需进一步四舍五入。",
            "answer": "$$\n\\boxed{1.325}\n$$"
        },
        {
            "introduction": "辐射本质上是在所有方向上连续的，但数值方法如 DTM 必须将此连续的方向空间离散化为一组有限的、有代表性的方向。每个离散方向都与一个特定的立体角相关联，其大小由一个正交权重 $w$ 决定。本练习旨在通过从球面坐标系的基本几何定义出发，推导这些正交权重，从而加深您对方向离散化过程的理解 。",
            "id": "3990862",
            "problem": "在辐射离散传递法 (DTM) 中，方向空间在单位球上通过极角 $\\theta \\in [0,\\pi]$ 和方位角 $\\phi \\in [0,2\\pi]$ 进行离散化，以形成一组不重叠的角度元。考虑一个具有 $N_{\\theta}$ 个极角元和 $N_{\\phi}$ 个方位角元的极角-方位角离散化。设极角边界由一个严格单调映射 $\\mu(s)$ 给出，其中 $\\mu(0)=1$ 且 $\\mu(1)=-1$，这里 $s \\in [0,1]$ 是一个归一化索引，且 $\\mu = \\cos(\\theta)$。极角元边界定义为 $\\mu_{k} = \\mu\\!\\left(\\frac{k}{N_{\\theta}}\\right)$，其中 $k = 0,1,\\dots,N_{\\theta}$。类似地，设方位角边界由一个严格单调映射 $\\phi(t)$ 给出，其中 $\\phi(0)=0$ 且 $\\phi(1)=2\\pi$，这里 $t \\in [0,1]$ 是一个归一化索引。方位角元边界定义为 $\\phi_{m} = \\phi\\!\\left(\\frac{m}{N_{\\phi}}\\right)$，其中 $m = 0,1,\\dots,N_{\\phi}$。这种通用构造允许通过适当选择 $\\mu(s)$ 和 $\\phi(t)$ 来实现等立体角元或将非均匀分辨率集中在选定方向上。\n\n推导分配给角度元 $(k,m)$ 的求积权重 $w_{k,m}$，该角度元由极角区间 $[\\mu_{k},\\mu_{k-1}]$ 和方位角区间 $[\\phi_{m-1},\\phi_{m}]$ 定义，使得求积和能精确积分整个球面上的恒定方向场。您的推导必须从单位球上的基本几何定义开始，并严格地推导出最终表达式，展示 $\\mu(s)$ 和 $\\phi(t)$ 的选择如何保持总立体角不变。您的最终权重公式应以球面度表示，所有角度均使用弧度。您必须提供权重 $w_{k,m}$ 的单一闭式解析表达式，用 $\\mu(\\cdot)$、\\,$\\phi(\\cdot)$、\\,$N_{\\theta}$ 和 $N_{\\phi}$ 表示。无需进行数值计算。",
            "solution": "问题陈述被验证为具有科学依据、适定、客观且自洽。其定义和约束与计算热工学的标准实践一致，特别是在辐射离散传递法 (DTM) 的背景下。未发现任何缺陷。因此，我们可以进行推导。\n\n目标是推导由索引 $(k,m)$ 定义的角度元的求积权重 $w_{k,m}$。该权重代表了该角度元所张的立体角。推导必须从球坐标中立体角微元的基本定义开始。\n\n在球坐标系中，立体角微元 $d\\Omega$ 由下式给出：\n$$\nd\\Omega = \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\n其中 $\\theta \\in [0,\\pi]$ 是极角，$\\phi \\in [0,2\\pi]$ 是方位角。\n\n问题以变量 $\\mu = \\cos(\\theta)$ 来定义极角离散化。我们进行从 $\\theta$ 到 $\\mu$ 的变量替换。$\\mu$ 的微分是：\n$$\nd\\mu = \\frac{d}{d\\theta}(\\cos(\\theta)) \\, d\\theta = -\\sin(\\theta) \\, d\\theta\n$$\n由此，我们可以表示出 $\\sin(\\theta) \\, d\\theta = -d\\mu$。将其代入立体角微元的表达式中，得到：\n$$\nd\\Omega = -d\\mu \\, d\\phi\n$$\n负号的出现是因为当 $\\theta$ 从 $0$ 增加到 $\\pi$ 时，$\\mu$ 从 $1$ 减小到 $-1$。\n\n求积权重 $w_{k,m}$ 是角度元 $(k,m)$ 的立体角，通过在该角度元的角范围内对 $d\\Omega$ 积分得到。该角度元由对应于 $[\\mu_{k},\\mu_{k-1}]$ 的极角区间和 $[\\phi_{m-1},\\phi_{m}]$ 的方位角区间定义。让我们首先考虑对相应的极角进行积分，其范围是从 $\\theta_{k-1}$ 到 $\\theta_{k}$，使得 $\\mu_{k-1} = \\cos(\\theta_{k-1})$ 且 $\\mu_{k} = \\cos(\\theta_{k})$。由于 $\\mu(s)$ 是严格单调递减的（从 $\\mu(0)=1$ 到 $\\mu(1)=-1$），递增的索引 $k$ 对应于递增的 $\\theta$ 值。因此，极角区间是 $[\\theta_{k-1}, \\theta_{k}]$。方位角区间直接给出为 $[\\phi_{m-1}, \\phi_m]$。\n\n立体角的积分为：\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} \\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\n我们计算关于 $\\theta$ 的内层积分：\n$$\n\\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta = [-\\cos(\\theta)]_{\\theta_{k-1}}^{\\theta_k} = -\\cos(\\theta_k) - (-\\cos(\\theta_{k-1})) = \\cos(\\theta_{k-1}) - \\cos(\\theta_k)\n$$\n根据问题中给出的定义，$\\mu_k = \\cos(\\theta_k)$ 且 $\\mu_{k-1} = \\cos(\\theta_{k-1})$。因此，内层积分的结果是 $\\mu_{k-1} - \\mu_k$。由于 $\\mu$ 是角 $\\theta$（以及索引 $k$）的递减函数，我们有 $\\mu_{k-1} > \\mu_k$，从而确保结果为正。\n\n将此代回 $w_{k,m}$ 的表达式中：\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} (\\mu_{k-1} - \\mu_k) \\, d\\phi\n$$\n项 $(\\mu_{k-1} - \\mu_k)$ 相对于 $\\phi$ 是常数，因此我们可以将其移到积分号外：\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) \\int_{\\phi_{m-1}}^{\\phi_m} d\\phi\n$$\n计算剩余的积分得到：\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) (\\phi_m - \\phi_{m-1})\n$$\n这个表达式给出了任意角度元 $(k,m)$ 的立体角，用其边界上的值表示。\n\n最后，我们代入由映射函数 $\\mu(s)$ 和 $\\phi(t)$ 给出的边界值的具体定义：\n$\\mu_{k} = \\mu\\!\\left(\\frac{k}{N_{\\theta}}\\right)$\n$\\phi_{m} = \\phi\\!\\left(\\frac{m}{N_{\\phi}}\\right)$\n\n将这些代入我们对 $w_{k,m}$ 的表达式中，得到最终的闭式表达式：\n$$\nw_{k,m} = \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\n为了验证这个结果，我们确认所有求积权重的总和等于球体的总立体角 $4\\pi$。总和为：\n$$\n\\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} w_{k,m} = \\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\n这是一个可分离的和，可以写成两个独立和的乘积：\n$$\n\\left( \\sum_{k=1}^{N_{\\theta}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\right) \\left( \\sum_{m=1}^{N_{\\phi}} \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right] \\right)\n$$\n这两个和都是裂项和。第一个和是：\n$$\n\\sum_{k=1}^{N_{\\theta}} \\left[ \\mu_{k-1} - \\mu_k \\right] = (\\mu_0 - \\mu_1) + (\\mu_1 - \\mu_2) + \\dots + (\\mu_{N_{\\theta}-1} - \\mu_{N_{\\theta}}) = \\mu_0 - \\mu_{N_{\\theta}}\n$$\n使用给定的边界条件，$\\mu_0 = \\mu(0) = 1$ 且 $\\mu_{N_{\\theta}} = \\mu(1) = -1$。该和为 $1 - (-1) = 2$。\n\n第二个和是：\n$$\n\\sum_{m=1}^{N_{\\phi}} \\left[ \\phi_m - \\phi_{m-1} \\right] = (\\phi_1 - \\phi_0) + (\\phi_2 - \\phi_1) + \\dots + (\\phi_{N_{\\phi}} - \\phi_{N_{\\phi}-1}) = \\phi_{N_{\\phi}} - \\phi_0\n$$\n使用给定的边界条件，$\\phi_0 = \\phi(0) = 0$ 且 $\\phi_{N_{\\phi}} = \\phi(1) = 2\\pi$。该和为 $2\\pi - 0 = 2\\pi$。\n\n权重的总和是这两个结果的乘积：$2 \\times 2\\pi = 4\\pi$。这与球体的总立体角相匹配，证实了该求积法则能够精确积分球面上的常数函数。因此，推导出的 $w_{k,m}$ 表达式是正确的。",
            "answer": "$$\n\\boxed{\\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]}\n$$"
        },
        {
            "introduction": "验证和确认 (V&V) 是计算建模中不可或缺的一环，它确保数值解的正确性。本综合练习将理论、数值实现和验证融为一体，是检验您对 DTM 掌握程度的绝佳机会。您将首先为一个经典的一维平面平行板问题推导解析解，然后通过编写一个简单的 DTM 求解器来复现该解，并系统地评估空间和角度离散化对解的精度的影响 。这个过程不仅能巩固您对 DTM 算法的理解，还能让您体验到验证计算代码的关键实践。",
            "id": "3990816",
            "problem": "考虑一个一维平面平行板，其厚度为 $L$，其中包含一个无散射的、灰色的、等温的、发射-吸收介质。吸收系数在空间上是均匀的，等于 $\\kappa$，单位为 $\\mathrm{m^{-1}}$。介质温度为 $T_m$，单位为 $\\mathrm{K}$。$x=0$ 和 $x=L$ 处的平板边界是绝对黑体（无反射），壁面温度分别为 $T_{w,0}$ 和 $T_{w,L}$，单位为 $\\mathrm{K}$。黑体比辐射强度（单位立体角）被假定为灰色，并由 $I_b(T) = \\sigma T^4/\\pi$ 给出，单位为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$，其中 $\\sigma$ 是 Stefan–Boltzmann 常数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-4}}$。用 $\\theta$ 表示相对于 $+x$ 轴的极角（以弧度为单位），用 $\\mu = \\cos\\theta$ 表示方向余弦。\n\n从沿射线的基本辐射传输方程出发，\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\n并结合黑体壁在 $x=0$ 和 $x=L$ 处的适当边界条件，推导在 $\\mu>0$ 和 $\\mu<0$ 情况下的比辐射强度 $I(x,\\mu)$ 的解析表达式。从第一性原理出发，推导辐射热通量 $q_r(x)$（单位为 $\\mathrm{W\\,m^{-2}}$）作为半球角度积分的表达式，\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu,\n$$\n该表达式用 $\\kappa$、$L$、$T_m$、$T_{w,0}$ 和 $T_{w,L}$ 表示。您的推导必须基于给定的方程、黑体表面的定义以及 $I_b(T)$ 的定义，并且不得引入未说明的假设。\n\n然后，具体说明离散传递法 (DTM) 如何在网格和角度加密的情况下通过以下方式复现此解：\n- 将平板离散化为 $M$ 个宽度为 $\\Delta x = L/M$ 的均匀单元，并沿着每个离散方向余弦 $\\mu_i \\in (0,1]$，使用一维常微分方程在 $\\Delta x$ 上的精确齐次解来步进射线强度。\n- 使用 $N$ 个方向和权重 $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$ 对 $\\mu \\in [0,1]$ 进行求积，近似半球角度积分，并应用前向（$\\mu>0$）和后向（$\\mu<0$）半球之间的对称性。\n- 证明当 $M\\to\\infty$ 和 $N\\to\\infty$ 时，DTM 计算的 $q_r(x)$ 收敛于解析表达式。\n\n实现一个程序，对下面的每个测试用例，计算：\n- 在平板中平面 $x=L/2$ 处的解析辐射热通量，单位为 $\\mathrm{W\\,m^{-2}}$。\n- 使用粗离散 $(M_c,N_c)$ 在 $x=L/2$ 处的 DTM 预测辐射热通量。\n- 使用精细离散 $(M_f,N_f)$ 在 $x=L/2$ 处的 DTM 预测辐射热通量。\n- 粗离散和精细离散 DTM 通量相对于解析通量的相对误差，定义为\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\n其中 $\\epsilon = 10^{-12}$，单位为 $\\mathrm{W\\,m^{-2}}$。\n\n所有带物理单位的量必须一致处理；通量必须以 $\\mathrm{W\\,m^{-2}}$ 为单位进行计算和内部表示。最终程序输出必须是单行，包含每个测试用例的误差对的逗号分隔列表，每个误差对表示为一个二元列表 $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$。\n\n测试套件：\n- 用例 $1$ (正常路径): $\\kappa = 1.0\\,\\mathrm{m^{-1}}$, $L = 0.5\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1200\\,\\mathrm{K}$, $T_{w,L} = 800\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$。\n- 用例 $2$ (辐射平衡边界): $\\kappa = 5.0\\,\\mathrm{m^{-1}}$, $L = 0.2\\,\\mathrm{m}$, $T_m = 900\\,\\mathrm{K}$, $T_{w,0} = 900\\,\\mathrm{K}$, $T_{w,L} = 900\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$。此用例应在 $x=L/2$ 处产生接近零的解析通量。\n- 用例 $3$ (光学薄): $\\kappa = 0.01\\,\\mathrm{m^{-1}}$, $L = 2.0\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1000\\,\\mathrm{K}$, $T_{w,L} = 1100\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$。\n- 用例 $4$ (光学厚): $\\kappa = 20.0\\,\\mathrm{m^{-1}}$, $L = 0.1\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1400\\,\\mathrm{K}$, $T_{w,L} = 800\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例产生一个包含浮点数的二元列表 $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$，例如 $[[e_{1c},e_{1f}],[e_{2c},e_{2f}],\\dots]$。",
            "solution": "我们从无散射的灰色、等温、发射-吸收介质中沿特征射线的基本辐射传输方程开始，\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\n其中 $I$ 是比辐射强度，单位为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$，$s$ 是沿射线的路径长度，单位为 $\\mathrm{m}$，$\\kappa$ 是吸收系数，单位为 $\\mathrm{m^{-1}}$，$I_b(T_m) = \\sigma T_m^4/\\pi$ 是介质的黑体比辐射强度。$x=0$ 和 $x=L$ 处的边界是黑体；因此，从壁面进入介质的射线的边界条件是：\n- 在 $x=0$ 处，对于 $\\mu = \\cos\\theta > 0$（沿 $+x$ 方向传播）的射线，$I(0,\\mu) = I_b(T_{w,0})$。\n- 在 $x=L$ 处，对于 $\\mu = \\cos\\theta < 0$（沿 $-x$ 方向传播）的射线，$I(L,\\mu) = I_b(T_{w,L})$。\n\n对于一维平面平行几何结构，沿射线的坐标 $s$ 通过 $\\mathrm{d}s = \\mathrm{d}x / \\mu$（对于 $\\mu>0$）和 $\\mathrm{d}s = -\\mathrm{d}x / |\\mu|$（对于 $\\mu<0$）与空间坐标 $x$ 相关联。该常微分方程具有常系数，并可用标准的积分因子法求解。对于 $\\mu>0$，考虑以 $x$ 为变量的常微分方程，\n$$\n\\mu\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = -\\kappa I(x,\\mu) + \\kappa I_b(T_m).\n$$\n此线性方程的齐次解为 $\\exp(-\\kappa x/\\mu)$，特解为 $I(x,\\mu) = I_b(T_m)$。应用边界条件 $I(0,\\mu) = I_b(T_{w,0})$，对于 $\\mu>0$ 的解为\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right),\\quad \\mu>0.\n$$\n类似地，对于 $\\mu<0$，我们记 $|\\mu| = -\\mu$，并从 $x=L$ 向较小的 $x$ 积分。方程变为\n$$\n|\\mu|\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = \\kappa I_b(T_m) - \\kappa I(x,\\mu).\n$$\n应用 $I(L,\\mu) = I_b(T_{w,L})$，对于 $\\mu<0$ 的解为\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right),\\quad \\mu<0.\n$$\n\n$x$ 方向的辐射热通量由对整个球体的角度积分定义；在平面平行对称性下，方位角积分产生一个因子 $2\\pi$，极角积分简化为 $\\mu \\in [-1,1]$，\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu.\n$$\n将积分分为前向（$\\mu>0$）和后向（$\\mu<0$）半球，对后向半球使用对称替换 $\\nu = |\\mu|$，并使用上述显式解：\n\\begin{align*}\nq_r(x) = 2\\pi \\left[ \\int_{0}^{1} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\right) \\mathrm{d}\\mu \\right. \\\\\n\\quad\\left. + \\int_{-1}^{0} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right)\\right) \\mathrm{d}\\mu \\right].\n\\end{align*}\n在后向积分中，令 $\\nu = |\\mu| \\in (0,1]$，因此 $\\mu = -\\nu$ 且 $\\mathrm{d}\\mu = -\\mathrm{d}\\nu$，得到\n\\begin{align*}\nq_r(x) = 2\\pi \\left[ \\int_{0}^{1} \\mu\\, I_b(T_m)\\, \\mathrm{d}\\mu + \\big(I_b(T_{w,0}) - I_b(T_m)\\big) \\int_{0}^{1} \\mu\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\, \\mathrm{d}\\mu \\right. \\\\\n\\quad \\left. - \\int_{0}^{1} \\nu\\, I_b(T_m)\\, \\mathrm{d}\\nu - \\big(I_b(T_{w,L}) - I_b(T_m)\\big) \\int_{0}^{1} \\nu\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{\\nu}\\right)\\, \\mathrm{d}\\nu \\right].\n\\end{align*}\n项 $\\int_{0}^{1} \\mu\\, I_b(T_m)\\,\\mathrm{d}\\mu$ 完全抵消。在辐射传输的意义上，定义 $n$ 阶指数积分函数，\n$$\nE_n(t) \\equiv \\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu,\n$$\n通过变量替换 $u=t/\\mu$，它与由下式定义的广义指数积分 $\\mathrm{E}_n$ 相关\n$$\n\\mathrm{E}_n(t) \\equiv \\int_{1}^{\\infty} \\frac{e^{-t v}}{v^n}\\, \\mathrm{d}v.\n$$\n具体来说，\n$$\n\\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t).\n$$\n对于 $n=3$，剩余的积分为 $E_3$，我们得到解析辐射通量\n$$\nq_r(x) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3(\\kappa x) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\big(\\kappa (L-x)\\big) \\right],\n$$\n其中 $\\mathrm{E}_3(0) = \\int_{1}^{\\infty} v^{-3}\\,\\mathrm{d}v = \\frac{1}{2}$，这与 $\\int_{0}^{1} \\mu\\, \\mathrm{d}\\mu = \\frac{1}{2}$ 一致。\n\n离散传递法 (DTM) 公式：\n- 空间离散化：将 $[0,L]$ 划分为 $M$ 个均匀单元，节点为 $x_j = j\\, \\Delta x$，$j=0,1,\\dots,M$，$\\Delta x=L/M$。\n- 角度离散化：在 $[0,1]$ 上选择 $N$ 个求积节点和权重 $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$（例如，映射到 $[0,1]$ 的 Gauss–Legendre 求积）来近似 $\\int_{0}^{1} g(\\mu)\\, \\mathrm{d}\\mu \\approx \\sum_{i=1}^{N} w_i g(\\mu_i)$。\n- 步进方案：对于每个 $\\mu_i>0$，通过在 $\\Delta x$ 上具有恒定源项的齐次常微分方程的精确单元解，将前向强度从 $x=0$ 传播到 $x=L$，\n$$\nI_{j+1}^{+}(\\mu_i) = I_{j}^{+}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\n由黑体壁边界条件 $I_{0}^{+}(\\mu_i) = I_b(T_{w,0})$ 初始化。对于每个 $\\mu_i>0$，通过以下方式将后向强度从 $x=L$ 传播到 $x=0$\n$$\nI_{j-1}^{-}(\\mu_i) = I_{j}^{-}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\n由 $I_{M}^{-}(\\mu_i) = I_b(T_{w,L})$ 初始化。\n- 节点 $x_j$ 处的通量评估：通过求积和对称性近似半球积分，\n$$\nq_r(x_j) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i)\\ - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right].\n$$\n\n收敛性：\n- 当 $M\\to\\infty$ 时，由于对每个单元使用了常系数常微分方程的精确解，带有精确单元衰减/发射的离散步进能够复现每条射线的连续解；因此减小 $\\Delta x$ 会提高在评估位置采样 $I(x,\\mu)$ 的分辨率。\n- 当 $N\\to\\infty$ 且使用多项式精确的求积法（如 Gauss–Legendre）时，对于光滑的 $f(\\mu)$，$\\int_{0}^{1} \\mu\\, f(\\mu)\\, \\mathrm{d}\\mu$ 的求积近似会快速收敛到真实积分，这是因为对于有限的 $\\kappa x$，$I(x,\\mu)$ 中的指数项在 $(0,1]$ 上关于 $\\mu$ 是解析的。\n\n误差度量：\n我们使用以 $\\mathrm{E}_3(\\cdot)$ 表示的推导表达式计算解析通量 $q_{\\text{analytical}}(L/2)$，并使用离散步进和求积法计算 DTM 通量 $q_{\\text{DTM}}(L/2)$。相对误差为\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\n其中 $\\epsilon = 10^{-12}\\,\\mathrm{W\\,m^{-2}}$ 以避免在平衡情况下出现除以零的错误。\n\n为每个测试用例在代码中实现的算法步骤：\n- 计算 $T = T_m, T_{w,0}, T_{w,L}$ 时的 $I_b(T) = \\sigma T^4/\\pi$。\n- 在 $x=L/2$ 处的解析通量：评估\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) \\right],\n$$\n其简化为\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right)\\, \\left(I_b(T_{w,0}) - I_b(T_{w,L})\\right).\n$$\n在数值上，$\\mathrm{E}_3(t)$ 是通过广义指数积分 $\\mathrm{E}_n(t)$，使用恒等式 $\\int_{0}^{1} \\mu^{n-2} e^{-t/\\mu}\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t)$ (其中 $n=3$) 来评估的。\n- 在 $x=L/2$ 处的 DTM 通量：在 $[0,1]$ 上构建 $N$ 点 Gauss–Legendre 节点和权重（从 $[-1,1]$ 映射），将 $I^{+}$ 从 $x=0$ 和 $I^{-}$ 从 $x=L$ 跨越 $M$ 个单元进行步进，然后评估\n$$\nq_r^{\\text{DTM}}\\!\\left(\\frac{L}{2}\\right) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i)\\ - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right],\n$$\n其中 $j = M/2$（假设 $M$ 为偶数）。\n- 计算粗离散 $(M_c,N_c)$ 和精细离散 $(M_f,N_f)$ 的相对误差。\n- 按照指定格式，将所有用例的误差对聚合到单行输出中。\n\n物理和数值一致性：\n- 所有通量均使用 $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$ 以 $\\mathrm{W\\,m^{-2}}$ 为单位计算。\n- 角度仅通过 $\\mu = \\cos\\theta$ 引用，其中 $\\theta$ 以弧度为单位；不使用显式的角度值。\n- 该测试套件探测了一个正常路径、一个辐射平衡边界条件（预期通量接近零）、一个光学薄板（小 $\\kappa L$）和一个光学厚板（大 $\\kappa L$），覆盖了衰减和发射的不同区域。\n\n在网格加密（$M_c \\to M_f$）和角度加密（$N_c \\to N_f$）下，DTM 通量收敛于解析通量，这反映在程序返回的 $\\varepsilon$ 值减小上。",
            "answer": "[[2.115852e-03,2.111867e-05],[6.984125e-14,6.984125e-14],[9.882949e-04,9.882194e-06],[7.135248e-04,7.108422e-06]]"
        }
    ]
}