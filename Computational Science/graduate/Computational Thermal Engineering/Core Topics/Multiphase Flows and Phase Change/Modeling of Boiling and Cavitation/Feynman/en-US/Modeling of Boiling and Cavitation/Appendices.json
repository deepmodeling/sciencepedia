{
    "hands_on_practices": [
        {
            "introduction": "Understanding the onset of cavitation is fundamental to designing reliable hydraulic systems. This exercise provides a first-principles look at cavitation inception by applying the conservation of mass and the Bernoulli equation to a classic Venturi tube geometry. By calculating the pressure drop in the accelerated flow, you will develop a concrete understanding of how local pressure can fall below the vapor pressure, leading to the formation of vapor bubbles. This practice serves as an essential building block for analyzing more complex cavitating flows in machinery like pumps and propellers .",
            "id": "3972412",
            "problem": "A horizontal Venturi conduit carries liquid water at temperature $T=293\\,\\mathrm{K}$. The inlet static pressure is $p_{1}=200\\,\\mathrm{kPa}$, the inlet speed is $V_{1}=2\\,\\mathrm{m/s}$, and the ratio of inlet cross-sectional area to throat area is $A_{1}/A_{t}=4$. The saturation vapor pressure of water at this temperature is $p_{v}=2.3\\,\\mathrm{kPa}$. Assume steady, single-phase, inviscid, incompressible flow prior to any inception of cavitation; neglect heat transfer and elevation changes. Let the density of water at $293\\,\\mathrm{K}$ be $\\rho=998\\,\\mathrm{kg/m^{3}}$.\n\nStarting from the conservation of mass and the Bernoulli equation along a streamline for an inviscid, incompressible fluid, derive the local static pressure in the throat and use it to form the cavitation number at the throat, defined by $\\sigma_{t}=(p_{t}-p_{v})/\\left(\\tfrac{1}{2}\\rho V_{t}^{2}\\right)$, where $p_{t}$ and $V_{t}$ are the throat static pressure and speed, respectively. Explain, based on first principles, the criterion for cavitation inception in terms of $p_{t}$ and $p_{v}$ and its relation to $\\sigma_{t}$, and determine whether cavitation would occur under the stated conditions.\n\nExpress the final answer as the single dimensionless value of the cavitation number $\\sigma_{t}$, rounded to four significant figures. No units are required in the final numeric answer.",
            "solution": "The problem statement is evaluated to be scientifically sound, self-contained, well-posed, and objective. It presents a standard application of fundamental principles in fluid mechanics, namely the conservation of mass and the Bernoulli equation, to analyze the potential for cavitation in a Venturi tube. All necessary data are provided, and the assumptions are clearly stated and physically appropriate for an introductory analysis. The problem is therefore valid.\n\nThe analysis begins with the principle of conservation of mass for a steady, incompressible flow. The continuity equation states that the mass flow rate is constant throughout the conduit. For an incompressible fluid where the density $\\rho$ is constant, this simplifies to the conservation of volume flow rate:\n$$\nA_{1}V_{1} = A_{t}V_{t}\n$$\nwhere the subscript $1$ denotes conditions at the inlet and the subscript $t$ denotes conditions at the throat. From this, we can express the throat velocity $V_{t}$ in terms of the inlet velocity $V_{1}$ and the area ratio:\n$$\nV_{t} = V_{1} \\frac{A_{1}}{A_{t}}\n$$\nGiven the inlet speed $V_{1}=2\\,\\mathrm{m/s}$ and the area ratio $A_{1}/A_{t}=4$, the velocity at the throat is:\n$$\nV_{t} = (2\\,\\mathrm{m/s}) \\times 4 = 8\\,\\mathrm{m/s}\n$$\nNext, we apply the Bernoulli equation for a steady, inviscid, incompressible flow along a horizontal streamline (no change in elevation, $z_{1}=z_{t}$). The equation relates pressure and velocity between the inlet and the throat:\n$$\np_{1} + \\frac{1}{2}\\rho V_{1}^{2} = p_{t} + \\frac{1}{2}\\rho V_{t}^{2}\n$$\nThe problem requires the derivation of the local static pressure in the throat, $p_{t}$. Rearranging the Bernoulli equation yields:\n$$\np_{t} = p_{1} + \\frac{1}{2}\\rho \\left(V_{1}^{2} - V_{t}^{2}\\right)\n$$\nWe can substitute the numerical values provided: $p_{1}=200\\,\\mathrm{kPa} = 200000\\,\\mathrm{Pa}$, $\\rho=998\\,\\mathrm{kg/m^{3}}$, $V_{1}=2\\,\\mathrm{m/s}$, and the derived value $V_{t}=8\\,\\mathrm{m/s}$.\n$$\np_{t} = 200000\\,\\mathrm{Pa} + \\frac{1}{2}(998\\,\\mathrm{kg/m^{3}}) \\left( (2\\,\\mathrm{m/s})^{2} - (8\\,\\mathrm{m/s})^{2} \\right)\n$$\n$$\np_{t} = 200000\\,\\mathrm{Pa} + (499\\,\\mathrm{kg/m^{3}}) \\left( 4\\,\\mathrm{m^{2}/s^{2}} - 64\\,\\mathrm{m^{2}/s^{2}} \\right)\n$$\n$$\np_{t} = 200000\\,\\mathrm{Pa} + (499\\,\\mathrm{kg/m^{3}}) (-60\\,\\mathrm{m^{2}/s^{2}})\n$$\n$$\np_{t} = 200000\\,\\mathrm{Pa} - 29940\\,\\mathrm{Pa} = 170060\\,\\mathrm{Pa}\n$$\nThis corresponds to a throat pressure of $p_{t}=170.06\\,\\mathrm{kPa}$.\n\nCavitation is the phenomenon of phase change from liquid to vapor that occurs when the local static pressure of the liquid drops to or below its saturation vapor pressure, $p_{v}$, at the prevailing temperature. From first principles, boiling occurs not just with increasing temperature, but also with decreasing pressure. Therefore, the criterion for the inception of cavitation at any point in the flow is:\n$$\np_{\\text{local}} \\le p_{v}\n$$\nIn a Venturi tube, the minimum pressure occurs at the throat, where the velocity is maximum. Thus, for this system, cavitation would begin to occur at the throat if $p_{t} \\le p_{v}$.\n\nGiven the saturation vapor pressure $p_{v}=2.3\\,\\mathrm{kPa}$, we compare it with the calculated throat pressure $p_{t}=170.06\\,\\mathrm{kPa}$. Since $p_{t}  p_{v}$, the pressure in the throat does not fall to the vapor pressure, and therefore, cavitation does not occur under the specified conditions.\n\nThe cavitation number at the throat, $\\sigma_{t}$, is a dimensionless parameter that quantifies the margin against cavitation. It is defined as:\n$$\n\\sigma_{t} = \\frac{p_{t} - p_{v}}{\\frac{1}{2}\\rho V_{t}^{2}}\n$$\nThe numerator, $p_{t} - p_{v}$, represents the pressure difference above the vapor pressure. The denominator, $\\frac{1}{2}\\rho V_{t}^{2}$, is the dynamic pressure at the throat, which serves as a characteristic pressure scale for the flow. The cavitation inception criterion $p_{t} \\le p_{v}$ is equivalent to $p_{t} - p_{v} \\le 0$. Since the denominator is always positive for a non-zero flow, the criterion for cavitation inception can be equivalently stated in terms of the cavitation number as $\\sigma_{t} \\le 0$.\n\nWe can now calculate the value of $\\sigma_{t}$ using the previously determined values. All pressures must be in consistent units (Pascals).\n$p_{t} = 170060\\,\\mathrm{Pa}$\n$p_{v} = 2.3\\,\\mathrm{kPa} = 2300\\,\\mathrm{Pa}$\n$\\rho = 998\\,\\mathrm{kg/m^{3}}$\n$V_{t} = 8\\,\\mathrm{m/s}$\n\nThe numerator is:\n$$\np_{t} - p_{v} = 170060\\,\\mathrm{Pa} - 2300\\,\\mathrm{Pa} = 167760\\,\\mathrm{Pa}\n$$\nThe denominator (dynamic pressure at the throat) is:\n$$\n\\frac{1}{2}\\rho V_{t}^{2} = \\frac{1}{2}(998\\,\\mathrm{kg/m^{3}})(8\\,\\mathrm{m/s})^{2} = (499\\,\\mathrm{kg/m^{3}})(64\\,\\mathrm{m^{2}/s^{2}}) = 31936\\,\\mathrm{Pa}\n$$\nThe cavitation number is the ratio of these two quantities:\n$$\n\\sigma_{t} = \\frac{167760}{31936} \\approx 5.2529433...\n$$\nRounding to four significant figures as requested, we obtain the final value.\n$$\n\\sigma_{t} \\approx 5.253\n$$\nThis positive value is consistent with our earlier conclusion that cavitation does not occur.",
            "answer": "$$\n\\boxed{5.253}\n$$"
        },
        {
            "introduction": "Moving from the onset of phase change to its role in heat transfer, this practice focuses on quantifying nucleate boiling. You will apply the celebrated Rohsenow correlation, a powerful empirical tool for estimating heat flux based on wall superheat and fluid-surface properties. This exercise demonstrates how complex boiling phenomena are captured in engineering models and highlights the importance of identifying the operating regime by comparing the calculated heat flux to the critical heat flux (CHF) limit .",
            "id": "3972413",
            "problem": "A horizontal, upward-facing, polished copper heater of negligible thermal mass is immersed in a large pool of saturated water at atmospheric pressure. The system is at steady state, and the measured wall superheat is $\\Delta T_{w} = 15\\,\\mathrm{K}$, where $\\Delta T_{w} = T_{w} - T_{\\mathrm{sat}}$. Assume the canonical pool-boiling behavior applies and that the heater is sufficiently large to avoid edge effects. Use a mechanistic nucleate pool-boiling model rooted in interfacial momentum and energy balances to estimate the heat flux $q''$ corresponding to this superheat and identify the boiling regime by comparing with the hydrodynamic critical threshold. Then, considering the role of micro-scale topology, discuss the uncertainty in the estimate attributable to surface roughness. Take properties of saturated water at atmospheric pressure to be: $h_{fg} = 2.256 \\times 10^{6}\\,\\mathrm{J/kg}$, $c_{p,l} = 4.22 \\times 10^{3}\\,\\mathrm{J/(kg\\,K)}$, $\\mu_{l} = 2.82 \\times 10^{-4}\\,\\mathrm{kg/(m\\,s)}$, $\\sigma = 5.89 \\times 10^{-2}\\,\\mathrm{N/m}$, $\\rho_{l} = 958\\,\\mathrm{kg/m^{3}}$, $\\rho_{v} = 0.597\\,\\mathrm{kg/m^{3}}$, $\\Pr_{l} = 1.75$, and $g = 9.81\\,\\mathrm{m/s^{2}}$. For polished copper in water, use a surface–fluid parameter $C_{sf} = 0.013$ and exponent $n = 1$. Express the final heat flux in $\\mathrm{MW/m^{2}}$ and round your answer to three significant figures. Provide your regime classification and the uncertainty discussion in words, but only report the numerical heat flux as the final answer.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective. It describes a standard pool boiling scenario with sufficient data to perform the requested calculations using established engineering correlations.\n\nThe heat flux $q''$ for nucleate pool boiling can be estimated using the Rohsenow correlation, which is derived from a dimensional analysis of the physical mechanisms governing bubble growth and departure. The correlation is given by:\n$$q'' = \\mu_l h_{fg} \\left[ \\frac{g (\\rho_l - \\rho_v)}{\\sigma} \\right]^{1/2} \\left[ \\frac{c_{p,l} (T_w - T_{\\mathrm{sat}})}{C_{sf} h_{fg} \\Pr_l^n} \\right]^3$$\nThe term $(T_w - T_{\\mathrm{sat}})$ is the wall superheat, $\\Delta T_w$. The problem provides all necessary parameters:\nLiquid dynamic viscosity, $\\mu_{l} = 2.82 \\times 10^{-4}\\,\\mathrm{kg/(m\\,s)}$\nLatent heat of vaporization, $h_{fg} = 2.256 \\times 10^{6}\\,\\mathrm{J/kg}$\nGravitational acceleration, $g = 9.81\\,\\mathrm{m/s^{2}}$\nLiquid density, $\\rho_{l} = 958\\,\\mathrm{kg/m^{3}}$\nVapor density, $\\rho_{v} = 0.597\\,\\mathrm{kg/m^{3}}$\nSurface tension, $\\sigma = 5.89 \\times 10^{-2}\\,\\mathrm{N/m}$\nLiquid specific heat, $c_{p,l} = 4.22 \\times 10^{3}\\,\\mathrm{J/(kg\\,K)}$\nWall superheat, $\\Delta T_{w} = 15\\,\\mathrm{K}$\nSurface-fluid parameter, $C_{sf} = 0.013$\nLiquid Prandtl number, $\\Pr_{l} = 1.75$\nSurface-fluid exponent, $n = 1$\n\nFirst, we calculate the term related to the bubble characteristic length scale:\n$$ \\left[ \\frac{g (\\rho_l - \\rho_v)}{\\sigma} \\right]^{1/2} = \\left[ \\frac{9.81 \\times (958 - 0.597)}{5.89 \\times 10^{-2}} \\right]^{1/2} = \\left[ \\frac{9392.1}{0.0589} \\right]^{1/2} \\approx (159458.6)^{1/2} \\approx 399.32\\,\\mathrm{m}^{-1} $$\nNext, we calculate the term related to the wall superheat and fluid properties:\n$$ \\left[ \\frac{c_{p,l} \\Delta T_w}{C_{sf} h_{fg} \\Pr_l^n} \\right]^3 = \\left[ \\frac{(4.22 \\times 10^{3}) \\times 15}{0.013 \\times (2.256 \\times 10^{6}) \\times 1.75^1} \\right]^3 = \\left[ \\frac{63300}{51324} \\right]^3 \\approx (1.2333)^3 \\approx 1.8760 $$\nNow, we substitute these values back into the Rohsenow correlation to find the heat flux $q''$:\n$$ q'' = (2.82 \\times 10^{-4}) \\times (2.256 \\times 10^{6}) \\times 399.32 \\times 1.8760 $$\n$$ q'' \\approx 636.19 \\times 399.32 \\times 1.8760 \\approx 476609\\,\\mathrm{W/m^2} $$\nConverting to $\\mathrm{MW/m^2}$:\n$$ q'' \\approx 0.4766\\,\\mathrm{MW/m^2} $$\n\nTo identify the boiling regime, we must compare this heat flux to the critical heat flux (CHF), $q''_{\\text{max}}$, which represents the upper limit of the stable nucleate boiling regime. The Zuber-Kutateladze correlation for CHF from a large horizontal plate is:\n$$ q''_{\\text{max}} = C h_{fg} \\rho_v \\left[ \\frac{\\sigma g (\\rho_l - \\rho_v)}{\\rho_v^2} \\right]^{1/4} $$\nUsing a standard value of $C=0.149$ for this configuration:\n$$ q''_{\\text{max}} = 0.149 \\times (2.256 \\times 10^6) \\times 0.597 \\left[ \\frac{(5.89 \\times 10^{-2}) \\times 9.81 \\times (958 - 0.597)}{0.597^2} \\right]^{1/4} $$\n$$ q''_{\\text{max}} = 200673 \\times \\left[ \\frac{552.20}{0.3564} \\right]^{1/4} = 200673 \\times (1549.4)^{1/4} \\approx 200673 \\times 6.269 $$\n$$ q''_{\\text{max}} \\approx 1258000\\,\\mathrm{W/m^2} \\approx 1.26\\,\\mathrm{MW/m^2} $$\nSince our calculated heat flux $q'' \\approx 0.477\\,\\mathrm{MW/m^2}$ is substantially lower than the critical heat flux $q''_{\\text{max}} \\approx 1.26\\,\\mathrm{MW/m^2}$, the system is operating safely within the nucleate boiling regime.\n\nRegarding the uncertainty attributable to surface roughness, it is substantial. The Rohsenow correlation accounts for surface effects through the empirical parameter $C_{sf}$. This single parameter lumps together complex and often uncharacterized details of the surface micro-topology, such as the size, geometry, and spatial distribution of nucleation cavities. The value of $C_{sf}=0.013$ is given for a \"polished copper\" surface, but this description is qualitative. Different polishing techniques can result in different surface finishes and, consequently, different values of $C_{sf}$. The heat flux prediction is extremely sensitive to this parameter, as $q'' \\propto (1/C_{sf})^3$. A mere $10\\%$ decrease in $C_{sf}$ (e.g., to $0.0117$) would increase the predicted heat flux by approximately $37\\%$, while a $10\\%$ increase would decrease the heat flux by about $25\\%$. Given that literature values for $C_{sf}$ for copper-water systems can vary more widely depending on surface preparation, the uncertainty in the estimated heat flux is significant. This highlights a primary limitation of such correlations and underscores the importance of direct surface characterization for more accurate, mechanistic modeling of boiling.\n\nRounding the calculated heat flux to three significant figures, we get $0.477\\,\\mathrm{MW/m^2}$.",
            "answer": "$$\n\\boxed{0.477}\n$$"
        },
        {
            "introduction": "Empirical correlations like Rohsenow's are powerful, but their accuracy hinges on correctly specified parameters that depend on the specific fluid and surface. This advanced practice delves into the computational methods used to determine these parameters from experimental data. You will implement a Bayesian inference algorithm to estimate the key coefficients of the Rohsenow correlation, gaining hands-on experience in model calibration and uncertainty quantification—essential skills for any computational thermal engineer developing predictive models .",
            "id": "3972409",
            "problem": "You are tasked with implementing a Bayesian parameter estimation program for a widely used empirical correlation in pool boiling, the Rohsenow correlation. The correlation models the boiling heat flux as a function of the wall superheat and fluid-surface parameters. Specifically, for saturated pool boiling of water at atmospheric pressure, the Rohsenow correlation can be written in the form\n$$\nq''(\\Delta T; C_s, m) \\;=\\; \\mu_\\ell \\, h_{fg} \\, \\left(\\frac{g\\,(\\rho_\\ell - \\rho_v)}{\\sigma}\\right)^{1/2} \\left( \\frac{\\Delta T}{C_s \\, c_p \\, \\mathrm{Pr}^{\\,m}} \\right)^{3},\n$$\nwhere $q''$ is the heat flux in $\\mathrm{W}\\,\\mathrm{m}^{-2}$, $\\Delta T = T_w - T_{\\mathrm{sat}}$ is the wall superheat in $\\mathrm{K}$, $C_s$ is a surface-fluid empirical parameter (dimensionless), $m$ is an empirical exponent (dimensionless), $\\mu_\\ell$ is the liquid dynamic viscosity in $\\mathrm{Pa}\\cdot\\mathrm{s}$, $h_{fg}$ is the latent heat of vaporization in $\\mathrm{J}\\,\\mathrm{kg}^{-1}$, $g$ is gravitational acceleration in $\\mathrm{m}\\,\\mathrm{s}^{-2}$, $\\rho_\\ell$ and $\\rho_v$ are liquid and vapor densities in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\sigma$ is surface tension in $\\mathrm{N}\\,\\mathrm{m}^{-1}$, $c_p$ is the liquid specific heat in $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, and $\\mathrm{Pr}$ is the liquid Prandtl number (dimensionless).\n\nYou will assume measurements of $q''$ are affected by additive Gaussian noise, i.e.,\n$$\ny_i \\;=\\; q''(\\Delta T_i; C_s, m) \\;+\\; \\varepsilon_i,\\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma_n^2),\n$$\nwith independent and identically distributed noise of known standard deviation $\\sigma_n$. Under this assumption, the likelihood for a dataset $\\{(\\Delta T_i, y_i)\\}_{i=1}^{N}$ is\n$$\n\\mathcal{L}(C_s, m \\mid \\{\\Delta T_i, y_i\\}) \\;\\propto\\; \\exp\\!\\left( -\\frac{1}{2\\sigma_n^2} \\sum_{i=1}^{N} \\left[y_i - q''(\\Delta T_i; C_s, m)\\right]^2 \\right).\n$$\nAssume a uniform prior over a bounded domain for $(C_s,m)$, specifically $C_s \\in [C_{\\min}, C_{\\max}]$ and $m \\in [m_{\\min}, m_{\\max}]$. The posterior distribution is proportional to the likelihood over this domain. Your task is to numerically approximate the posterior mean estimates\n$$\n\\mathbb{E}[C_s \\mid \\text{data}], \\qquad \\mathbb{E}[m \\mid \\text{data}],\n$$\nby discretizing the parameter space into a uniform grid and performing numerical integration of the posterior over the grid.\n\nUse the following constant properties for saturated water at approximately $100\\,^\\circ\\mathrm{C}$ (International System of Units (SI)):\n- $\\mu_\\ell = 0.000282\\,\\mathrm{Pa}\\cdot\\mathrm{s}$,\n- $h_{fg} = 2.257\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$,\n- $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$,\n- $\\rho_\\ell = 958\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n- $\\rho_v = 0.6\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n- $\\sigma = 0.0589\\,\\mathrm{N}\\,\\mathrm{m}^{-1}$,\n- $c_p = 4220\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n- $\\mathrm{Pr} = 1.75$.\n\nDefine the constant\n$$\nS \\;=\\; \\mu_\\ell \\, h_{fg} \\, \\left(\\frac{g\\,(\\rho_\\ell - \\rho_v)}{\\sigma}\\right)^{1/2},\n$$\nand rewrite the model as\n$$\nq''(\\Delta T; C_s, m) \\;=\\; S \\left( \\frac{\\Delta T}{C_s \\, c_p \\, \\mathrm{Pr}^{\\,m}} \\right)^{3}.\n$$\n\nConstruct three pooled datasets to test your estimator. For each dataset, the measured $q''$ values should be generated deterministically from the model using the specified \"true\" parameters, with no added noise in the synthetic data generation, but the inference must still assume the given $\\sigma_n$ in the Gaussian likelihood. All $\\Delta T$ values must be in $\\mathrm{K}$ and all $q''$ values must be in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\n- Dataset A (general case):\n  - $\\Delta T$ values: $[5, 10, 15, 20, 25]$.\n  - True parameters: $C_s^{\\mathrm{true}} = 0.002$, $m^{\\mathrm{true}} = 1.2$.\n  - Noise standard deviation for the likelihood: $\\sigma_n = 2.0\\times 10^{4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\n- Dataset B (low-$\\Delta T$ boundary case):\n  - $\\Delta T$ values: $[1, 2, 3, 4]$.\n  - True parameters: $C_s^{\\mathrm{true}} = 0.004$, $m^{\\mathrm{true}} = 1.0$.\n  - Noise standard deviation for the likelihood: $\\sigma_n = 0.5\\times 10^{4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\n- Dataset C (high-noise, sparse data case):\n  - $\\Delta T$ values: $[10, 30, 50]$.\n  - True parameters: $C_s^{\\mathrm{true}} = 0.003$, $m^{\\mathrm{true}} = 1.2$.\n  - Noise standard deviation for the likelihood: $\\sigma_n = 6.0\\times 10^{4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\nFor the prior domain, use\n$$\nC_{\\min} = 0.001,\\quad C_{\\max} = 0.010,\\quad m_{\\min} = 0.5,\\quad m_{\\max} = 2.0.\n$$\nUse a uniform grid with at least $201$ points for $C_s$ and at least $301$ points for $m$ over these intervals.\n\nAlgorithm requirements:\n- For each dataset, compute the synthetic measured $q''$ values exactly from the specified true parameters and the model above.\n- Construct the Gaussian likelihood for the dataset as specified.\n- Assume a uniform prior over the given bounds and compute the unnormalized posterior over the grid.\n- Numerically approximate the posterior means $\\mathbb{E}[C_s]$ and $\\mathbb{E}[m]$ by summing over the grid with the posterior weights. Use a numerically stable implementation for exponentials (e.g., subtract the maximum log-likelihood before exponentiation).\n- Report the posterior means for each dataset as dimensionless floats, rounded to six decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of pairs enclosed in square brackets and with no spaces.\n- Each pair corresponds to one dataset in the order A, B, C and contains the posterior mean estimates $[\\,\\mathbb{E}[C_s],\\,\\mathbb{E}[m]\\,]$ for that dataset.\n- Example format: $[[0.002000,1.200000],[0.004000,1.000000],[0.003000,1.200000]]$.\n\nThe solution must be a complete, runnable program that adheres to the specified execution environment and libraries and outputs exactly one line in the format above. No extra text should be printed.",
            "solution": "The problem requires the implementation of a Bayesian parameter estimation algorithm to find the posterior mean estimates for the parameters $C_s$ and $m$ in the Rohsenow pool boiling correlation. The estimation is to be performed using a grid-based numerical integration of the posterior distribution for three distinct synthetic datasets.\n\n### **Problem Formulation**\n\nThe core of the problem is the Rohsenow correlation, which models the boiling heat flux $q''$ as a function of the wall superheat $\\Delta T = T_w - T_{\\mathrm{sat}}$. For this problem, the correlation is given in a simplified form:\n$$\nq''(\\Delta T; C_s, m) \\;=\\; S \\left( \\frac{\\Delta T}{C_s \\, c_p \\, \\mathrm{Pr}^{\\,m}} \\right)^{3}\n$$\nwhere $C_s$ and $m$ are the empirical parameters to be estimated. The constant $S$ pools together the fluid properties:\n$$\nS \\;=\\; \\mu_\\ell \\, h_{fg} \\, \\left(\\frac{g\\,(\\rho_\\ell - \\rho_v)}{\\sigma}\\right)^{1/2}\n$$\nUsing the provided SI unit values for saturated water at approximately $100\\,^\\circ\\mathrm{C}$:\n- $\\mu_\\ell = 0.000282\\,\\mathrm{Pa}\\cdot\\mathrm{s}$\n- $h_{fg} = 2.257\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$\n- $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $\\rho_\\ell = 958\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $\\rho_v = 0.6\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $\\sigma = 0.0589\\,\\mathrm{N}\\,\\mathrm{m}^{-1}$\n- $c_p = 4220\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $\\mathrm{Pr} = 1.75$\n\nFirst, the constant $S$ is calculated to be $S \\approx 254250.31 \\, \\mathrm{W}\\cdot\\mathrm{m}^{-2}$.\n\n### **Bayesian Inference Framework**\n\nThe estimation of parameters $(C_s, m)$ is performed within a Bayesian framework. Let $\\theta = (C_s, m)$ represent the vector of parameters and $D = \\{(\\Delta T_i, y_i)\\}_{i=1}^{N}$ be the observed data. Bayes' theorem states that the posterior probability distribution of the parameters given the data is proportional to the product of the likelihood and the prior probability distribution:\n$$\nP(\\theta \\mid D) \\;\\propto\\; \\mathcal{L}(D \\mid \\theta) \\, P(\\theta)\n$$\n- **Likelihood, $\\mathcal{L}(D \\mid \\theta)$**: The problem assumes that the measured heat flux values $y_i$ are subject to independent and identically distributed additive Gaussian noise, $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma_n^2)$. The likelihood of observing the dataset $D$ for a given set of parameters $\\theta$ is therefore:\n$$\n\\mathcal{L}(D \\mid \\theta) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_n^2}} \\exp\\!\\left( -\\frac{(y_i - q''(\\Delta T_i; \\theta))^2}{2\\sigma_n^2} \\right) \\;\\propto\\; \\exp\\!\\left( -\\frac{1}{2\\sigma_n^2} \\sum_{i=1}^{N} \\left[y_i - q''(\\Delta T_i; \\theta)\\right]^2 \\right)\n$$\n- **Prior, $P(\\theta)$**: A uniform prior distribution is assumed for both parameters over a specified rectangular domain: $C_s \\in [0.001, 0.010]$ and $m \\in [0.5, 2.0]$. This implies that $P(\\theta)$ is a constant within this domain and zero outside.\n\nSince the prior is uniform, the posterior distribution is simply proportional to the likelihood function within the specified parameter bounds:\n$$\nP(C_s, m \\mid D) \\;\\propto\\; \\mathcal{L}(C_s, m \\mid D)\n$$\n\n### **Numerical Approximation via Grid-Based Integration**\n\nTo compute the posterior mean estimates $\\mathbb{E}[C_s \\mid D]$ and $\\mathbb{E}[m \\mid D]$, we must evaluate integrals over the posterior distribution. Since an analytical solution is intractable, we employ a numerical approach by discretizing the parameter space.\n\n1.  **Discretization**: The continuous parameter space for $(C_s, m)$ is discretized into a uniform 2D grid. Let this grid consist of points $(C_{s,j}, m_k)$ for $j=1, \\dots, N_{C_s}$ and $k=1, \\dots, N_m$. The problem specifies $N_{C_s} \\geq 201$ and $N_m \\geq 301$.\n\n2.  **Posterior Evaluation**: For each point $(C_{s,j}, m_k)$ on the grid, we evaluate a value proportional to the posterior probability. It is computationally more stable to work with the log-posterior. The log-posterior is proportional to the log-likelihood:\n    $$\n    \\ln P(C_{s,j}, m_k \\mid D) \\;\\propto\\; -\\frac{1}{2\\sigma_n^2} \\sum_{i=1}^{N} \\left[y_i - q''(\\Delta T_i; C_{s,j}, m_k)\\right]^2\n    $$\n\n3.  **Numerical Stability**: Exponentiating the log-posterior values directly can lead to numerical underflow (values becoming zero) for points far from the maximum. To circumvent this, we subtract the maximum log-posterior value from all log-posterior values before exponentiating. Let $\\mathcal{P}_{jk} = \\ln P(C_{s,j}, m_k \\mid D)$ and $\\mathcal{P}_{\\max} = \\max_{j,k} \\mathcal{P}_{jk}$. The unnormalized posterior weights $W_{jk}$ are computed as:\n    $$\n    W_{jk} = \\exp(\\mathcal{P}_{jk} - \\mathcal{P}_{\\max})\n    $$\n    This normalization ensures that the largest weight is $1$, and all other weights are between $0$ and $1$, preventing underflow.\n\n4.  **Posterior Mean Calculation**: The posterior distribution is approximated as a discrete probability mass function on the grid, where the probability mass at each point $(C_{s,j}, m_k)$ is proportional to $W_{jk}$. The posterior mean of any parameter, say $\\phi(C_s, m)$, is approximated by a weighted average over the grid:\n    $$\n    \\mathbb{E}[\\phi \\mid D] \\approx \\frac{\\sum_{j,k} \\phi(C_{s,j}, m_k) W_{jk}}{\\sum_{j,k} W_{jk}}\n    $$\n    For our parameters $C_s$ and $m$, the estimates are:\n    $$\n    \\mathbb{E}[C_s \\mid D] \\approx \\frac{\\sum_{j=1}^{N_{C_s}} \\sum_{k=1}^{N_m} C_{s,j} \\, W_{jk}}{\\sum_{j',k'} W_{j'k'}} \\qquad \\mathbb{E}[m \\mid D] \\approx \\frac{\\sum_{j=1}^{N_{C_s}} \\sum_{k=1}^{N_m} m_k \\, W_{jk}}{\\sum_{j',k'} W_{j'k'}}\n    $$\n\n### **Algorithm Implementation**\n\nThe overall algorithm proceeds as follows for each of the three datasets provided:\n\n1.  **Synthetic Data Generation**: For each dataset, the measurement vector $\\{y_i\\}$ is generated deterministically using the provided true parameters $(C_s^{\\mathrm{true}}, m^{\\mathrm{true}})$ and the Rohsenow model. No random noise is added to the synthetic data itself.\n2.  **Grid Construction**: Create 2D grids for $C_s$ and $m$ over their respective domains using `numpy.meshgrid`.\n3.  **Log-Posterior Calculation**:\n    a. Initialize a 2D array `sse_grid` to zeros, with dimensions $(N_m, N_{C_s})$.\n    b. For each data point $(\\Delta T_i, y_i)$ in the dataset:\n        i. Calculate the predicted heat flux $q''(\\Delta T_i; C_s, m)$ for all $(C_s, m)$ points on the grid.\n        ii. Compute the squared error $(y_i - q'')^2$ for the entire grid.\n        iii. Add this squared error grid to `sse_grid`.\n    c. Calculate the log-posterior grid as `log_posterior_grid = -sse_grid / (2 * \\sigma_n^2)`.\n4.  **Posterior Mean Estimation**:\n    a. Find the maximum value of `log_posterior_grid`.\n    b. Compute the numerically stable posterior weights `posterior_weights` by exponentiating `log_posterior_grid - max(log_posterior_grid)`.\n    c. Calculate the total weight by summing `posterior_weights`.\n    d. Compute the weighted sum of the $C_s$ grid and divide by the total weight to get $\\mathbb{E}[C_s]$.\n    e. Compute the weighted sum of the $m$ grid and divide by the total weight to get $\\mathbb{E}[m]$.\n5.  **Output Formatting**: The resulting pair of mean estimates for each dataset is formatted to six decimal places and combined into the specified string format.\n\nThis procedure is repeated for all three datasets to obtain the final result.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Bayesian parameter estimation for the Rohsenow correlation\n    using a grid-based numerical integration approach.\n    \"\"\"\n    # Constant properties for saturated water at atmospheric pressure (SI units)\n    MU_L = 0.000282\n    H_FG = 2.257e6\n    G = 9.81\n    RHO_L = 958\n    RHO_V = 0.6\n    SIGMA = 0.0589\n    CP = 4220\n    PR = 1.75\n\n    # Prior domain bounds\n    CS_MIN, CS_MAX = 0.001, 0.010\n    M_MIN, M_MAX = 0.5, 2.0\n\n    # Grid resolution\n    N_CS = 201\n    N_M = 301\n\n    # Test cases setup\n    test_cases = [\n        {\n            'name': 'Dataset A',\n            'delta_t': np.array([5, 10, 15, 20, 25]),\n            'cs_true': 0.002, 'm_true': 1.2,\n            'sigma_n': 2.0e4\n        },\n        {\n            'name': 'Dataset B',\n            'delta_t': np.array([1, 2, 3, 4]),\n            'cs_true': 0.004, 'm_true': 1.0,\n            'sigma_n': 0.5e4\n        },\n        {\n            'name': 'Dataset C',\n            'delta_t': np.array([10, 30, 50]),\n            'cs_true': 0.003, 'm_true': 1.2,\n            'sigma_n': 6.0e4\n        }\n    ]\n\n    # Pre-calculate the constant S\n    S = MU_L * H_FG * np.sqrt((G * (RHO_L - RHO_V)) / SIGMA)\n\n    def rohrenow_q(delta_t, cs, m):\n        \"\"\"\n        Vectorized Rohsenow correlation model.\n        delta_t can be a scalar or a vector.\n        cs and m can be scalars or broadcastable arrays (e.g., from meshgrid).\n        \"\"\"\n        return S * (delta_t / (cs * CP * PR**m))**3\n\n    # Create parameter grids\n    cs_vals = np.linspace(CS_MIN, CS_MAX, N_CS)\n    m_vals = np.linspace(M_MIN, M_MAX, N_M)\n    # CS has shape (N_M, N_CS), M has shape (N_M, N_CS)\n    CS, M = np.meshgrid(cs_vals, m_vals)\n\n    all_results = []\n    for case in test_cases:\n        delta_t_data = case['delta_t']\n        cs_true = case['cs_true']\n        m_true = case['m_true']\n        sigma_n = case['sigma_n']\n\n        # Generate synthetic measurement data (y_i) deterministically\n        y_data = rohrenow_q(delta_t_data, cs_true, m_true)\n\n        # Calculate log-posterior over the grid\n        # We compute the sum of squared errors (SSE) for each grid point\n        sse_grid = np.zeros_like(CS)\n        for i in range(len(delta_t_data)):\n            q_pred_grid = rohrenow_q(delta_t_data[i], CS, M)\n            sse_grid += (y_data[i] - q_pred_grid)**2\n        \n        # Log-posterior is proportional to log-likelihood (uniform prior)\n        log_posterior_grid = -sse_grid / (2 * sigma_n**2)\n\n        # Numerically stable posterior weight calculation\n        log_post_max = np.max(log_posterior_grid)\n        posterior_weights = np.exp(log_posterior_grid - log_post_max)\n        \n        # Calculate posterior means\n        total_weight = np.sum(posterior_weights)\n        \n        # CS and M grids are already broadcastable with posterior_weights\n        expected_cs = np.sum(CS * posterior_weights) / total_weight\n        expected_m = np.sum(M * posterior_weights) / total_weight\n        \n        all_results.append([expected_cs, expected_m])\n\n    # Format the final output string\n    result_strings = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}