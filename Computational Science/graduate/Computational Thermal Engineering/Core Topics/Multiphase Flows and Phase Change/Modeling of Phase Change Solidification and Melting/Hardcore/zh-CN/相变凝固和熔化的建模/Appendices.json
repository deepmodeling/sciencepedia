{
    "hands_on_practices": [
        {
            "introduction": "任何精确的熔化和凝固模型都必须从正确的能量衡算开始。第一个实践聚焦于焓的基本热力学原理，它巧妙地结合了与温度变化相关的显热和在相变过程中吸收或释放的潜热。通过解决这个问题 ()，您将巩固对当材料被加热通过其熔点时，总能量是如何分配和计算的理解。",
            "id": "3973642",
            "problem": "一种纯的、单组分材料在充分搅拌、恒压的环境中被加热，其空间温度梯度可忽略不计，且与储存的热能相比，热机械功也可忽略不计。初始温度为 $T_{1} = 300\\,\\mathrm{K}$，熔化温度为 $T_{m} = 500\\,\\mathrm{K}$，最终温度为 $T_{2} = 700\\,\\mathrm{K}$。质量为 $m = 5\\,\\mathrm{kg}$。在固相中（$T \\le T_m$），比热容为 $c_{p,s}(T) = 500 + 0.2\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$；在液相中（$T > T_m$），比热容为 $c_{p,\\ell}(T) = 900 + 0.1\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。熔化潜热为 $L = 2.50 \\times 10^{5}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$。计算将材料从 $T_1$ 加热到 $T_2$ 所需的总热输入（以千焦为单位），并四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效，因为它在科学上基于经典热力学，问题设定良好，给定的数据完整且一致，并以客观、明确的语言表达。\n\n任务首先是解释潜热在储存能量背景下的热力学作用，然后推导并计算将一种材料加热至熔点以上所需的总热输入。\n\n分析基于封闭系统在恒定压力下经历准静态过程的热力学第一定律。第一定律指出，内能的变化量 $dU$ 等于系统吸收的热量 $\\delta Q$ 减去系统对外做的功 $\\delta W$：\n$$dU = \\delta Q - \\delta W$$\n对于在恒定压力 $P$ 下的准静态过程，所做的功主要是热机械功（体积膨胀），由 $\\delta W = P\\,dV$ 给出。将其代入第一定律得到：\n$$\\delta Q = dU + P\\,dV$$\n由于压力 $P$ 是恒定的，这可以写成：\n$$\\delta Q = d(U + PV)$$\n量 $H = U + PV$ 被定义为焓。因此，对于准静态、恒压过程，系统吸收的热量等于其焓的变化量：\n$$\\delta Q = dH$$\n对于一个质量为 $m$ 的系统，我们可以定义比焓 $h = H/m$，因此 $dH = m\\,dh$。改变材料状态所需的热输入因此由 $m\\,dh$ 的积分给出：\n$$Q = m \\int dh = m\\,\\Delta h$$\n其中 $\\Delta h$ 是总的比焓变化量。\n\n焓与温度之间的关系由定压比热容 $c_p$ 给出，其定义为：\n$$c_p(T) = \\left(\\frac{\\partial h}{\\partial T}\\right)_P$$\n这个定义意味着，对于在单一相（固相或液相）内的无穷小温度变化 $dT$，比焓的变化是 $dh = c_p(T)\\,dT$。增加的能量称为显热，因为它导致了可测量的温度变化，这对应于组成物质的分子的平均动能的增加。\n\n然而，在相变过程中，例如在恒定温度 $T_m$ 下熔化，物质会吸收大量的热量而温度没有任何变化（$dT = 0$）。从定义 $c_p = (\\partial h / \\partial T)_P$ 来看，这在数学上意味着在 $T = T_m$ 时比热容为无穷大。一个更具物理意义的描述是，比焓 $h$ 在 $T_m$ 处经历一个不连续的跳跃。这个跳跃就是比熔化潜热 $L$。\n$$L = h_{\\ell}(T_m) - h_{s}(T_m)$$\n其中 $h_{s}(T_m)$ 和 $h_{\\ell}(T_m)$ 分别是材料在熔化温度 $T_m$ 时固相和液相的比焓。\n\n作为潜热吸收的能量不会增加分子的动能（因为温度保持不变），而是增加它们的势能。这部分能量用于克服将分子固定在固态晶格的有序结构中的分子间作用力，使它们能够在无序的液相中更自由地移动。因此，潜热项通过增加一份能量来改变总储存能量，这份能量储存在材料的相态构型（势能）中，而不是储存在其温度（动能）中。\n\n要计算将材料温度从 $T_1$ 升高到 $T_2$（经过熔点 $T_m$）所需的总热输入 $Q(T_1 \\rightarrow T_2)$，我们必须将三个不同阶段吸收的热量相加：\n1.  显热，将固体的温度从 $T_1$ 升高到 $T_m$。\n2.  潜热，在 $T_m$ 下将固体完全熔化。\n3.  显热，将液体的温度从 $T_m$ 升高到 $T_2$。\n\n总热输入 $Q$ 是质量 $m$ 与总比焓变 $\\Delta h = h(T_2)-h(T_1)$ 的乘积。这个变化可以表示为每个阶段焓变的总和：\n$$\\Delta h = \\Delta h_{s} + L + \\Delta h_{\\ell}$$\n各项分别为：\n- $\\Delta h_{s} = \\int_{T_1}^{T_m} c_{p,s}(T)\\,dT$ (加热固体)\n- $L$ (熔化固体)\n- $\\Delta h_{\\ell} = \\int_{T_m}^{T_2} c_{p,\\ell}(T)\\,dT$ (加热液体)\n\n因此，总热输入为：\n$$Q = m \\left( \\int_{T_1}^{T_m} c_{p,s}(T)\\,dT + L + \\int_{T_m}^{T_2} c_{p,\\ell}(T)\\,dT \\right)$$\n使用给定的数据：\n- $m = 5\\,\\mathrm{kg}$\n- $T_1 = 300\\,\\mathrm{K}$\n- $T_m = 500\\,\\mathrm{K}$\n- $T_2 = 700\\,\\mathrm{K}$\n- $c_{p,s}(T) = 500 + 0.2\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $c_{p,\\ell}(T) = 900 + 0.1\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $L = 2.50 \\times 10^{5}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$\n\n首先，我们计算加热固体的焓变：\n$$\\Delta h_s = \\int_{300}^{500} (500 + 0.2\\,T)\\,dT = \\left[ 500\\,T + 0.1\\,T^2 \\right]_{300}^{500}$$\n$$\\Delta h_s = (500 \\times 500 + 0.1 \\times 500^2) - (500 \\times 300 + 0.1 \\times 300^2)$$\n$$\\Delta h_s = (250000 + 0.1 \\times 250000) - (150000 + 0.1 \\times 90000)$$\n$$\\Delta h_s = (250000 + 25000) - (150000 + 9000)$$\n$$\\Delta h_s = 275000 - 159000 = 116000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$$\n\n接下来，我们计算加热液体的焓变：\n$$\\Delta h_{\\ell} = \\int_{500}^{700} (900 + 0.1\\,T)\\,dT = \\left[ 900\\,T + 0.05\\,T^2 \\right]_{500}^{700}$$\n$$\\Delta h_{\\ell} = (900 \\times 700 + 0.05 \\times 700^2) - (900 \\times 500 + 0.05 \\times 500^2)$$\n$$\\Delta h_{\\ell} = (630000 + 0.05 \\times 490000) - (450000 + 0.05 \\times 250000)$$\n$$\\Delta h_{\\ell} = (630000 + 24500) - (450000 + 12500)$$\n$$\\Delta h_{\\ell} = 654500 - 462500 = 192000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$$\n\n现在，我们将所有三个阶段的焓变相加：\n$$\\Delta h_{total} = \\Delta h_s + L + \\Delta h_{\\ell} = 116000 + 250000 + 192000 = 558000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$$\n\n最后，我们计算质量 $m = 5\\,\\mathrm{kg}$ 的总热输入 $Q$：\n$$Q = m \\times \\Delta h_{total} = 5\\,\\mathrm{kg} \\times 558000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1} = 2790000\\,\\mathrm{J}$$\n为了以千焦（$\\mathrm{kJ}$）表示最终结果并四舍五入到四位有效数字，我们从焦耳转换：\n$$Q = \\frac{2790000}{1000}\\,\\mathrm{kJ} = 2790\\,\\mathrm{kJ}$$\n数值 $2790$ 有四位有效数字。",
            "answer": "$$\\boxed{2790}$$"
        },
        {
            "introduction": "掌握了能量衡算之后，下一步是模拟移动相界面的动力学。斯特凡问题 (Stefan problem) 是一个经典的解析模型，用于描述固液界面因热扩散而推进时的位置。这个练习 () 将引导您推导其著名的自相似解，该解表明界面位置与时间的平方根成正比，这是扩散过程的标志。这不仅仅是一个理论练习，它还为验证数值模拟提供了重要的基准，并为深入理解凝固物理学提供了宝贵的视角。",
            "id": "3973638",
            "problem": "一个半无限的纯材料占据 $x>0$ 的区域。在时间 $t=0$ 时，整个区域处于热力学熔化温度 $T_{m}$。对于 $t>0$，$x=0$ 处的边界突然并永久地保持在一个较低的固定温度 $T_{0}$（其中 $T_{0} < T_m$）。结果，一个固相层开始在 $x=0$ 处形成并向材料内部生长。假设凝固界面位置具有 $s(t) = 2\\lambda\\sqrt{\\alpha t}$ 的形式，其中 $\\alpha$ 是固体的热扩散率，$\\lambda$ 是一个无量纲常数。推导出确定 $\\lambda$ 的超越方程，并表明它仅取决于斯特凡数 $\\mathrm{Ste} = c(T_m-T_0)/L$。",
            "solution": "该问题描述了半无限域中凝固过程的单边 Stefan 问题。我们首先根据能量守恒和热传导原理建立控制方程和边界条件。\n\n在区域 $0  x  s(t)$ 和时间 $t0$ 内，固相中的温度场 $T(x,t)$ 由一维热扩散方程控制：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n其中 $\\alpha = k/(\\rho c)$ 是固体的热扩散率。\n\n边界和界面条件如下：\n1. 对于 $t0$，固定边界 $x=0$ 处的温度是恒定的：\n$$ T(0, t) = T_0 $$\n2. 固液界面 $x=s(t)$ 处的温度为熔化温度 $T_m$：\n$$ T(s(t), t) = T_m $$\n3. 移动界面处的能量平衡，即 Stefan 条件，将从界面传导到固体中的热量与凝固释放的潜热相等同。假设液体处于 $T_m$，因此没有从液相到界面的热传导。\n$$ k \\frac{\\partial T}{\\partial x}\\bigg|_{x=s(t)} = \\rho L \\frac{ds}{dt} $$\n其中 $k$ 是固体的热导率，$\\rho$ 是密度， $L$ 是单位质量的熔化潜热，而 $ds/dt$ 是界面的速度。\n\n4. 初始条件是整个区域在熔化温度下是液体，这意味着在 $t=0$ 时固相的厚度为零：\n$$ s(0) = 0 $$\n\n该系统构成了一个适定的自由边界问题。该问题缺乏内禀的长度或时间尺度，这表明存在自相似解。我们假设界面位置随时间的平方根增长，这与扩散过程一致。根据问题的指导，我们假设解的形式为：\n$$ s(t) = 2\\lambda\\sqrt{\\alpha t} $$\n其中 $\\lambda$ 是一个待确定的无量纲、与时间无关的相似性参数。选择因子 $2\\sqrt{\\alpha}$ 是为了数学上的方便。如果这一假设能导出一个完整问题的自洽解，那么它的有效性就得到了证实。\n\n我们引入无量纲相似性变量 $\\eta$：\n$$ \\eta = \\frac{x}{2\\sqrt{\\alpha t}} $$\n通过此变换，假设温度场 $T(x,t)$ 仅是 $\\eta$ 的函数，即 $T(x,t) = T(\\eta)$。我们将控制偏微分方程转换为关于 $T(\\eta)$ 的常微分方程 (ODE)。偏导数如下：\n$$ \\frac{\\partial T}{\\partial t} = \\frac{dT}{d\\eta} \\frac{\\partial \\eta}{\\partial t} = \\frac{dT}{d\\eta} \\left( -\\frac{x}{4\\sqrt{\\alpha} t^{3/2}} \\right) = -\\frac{\\eta}{2t} \\frac{dT}{d\\eta} $$\n$$ \\frac{\\partial T}{\\partial x} = \\frac{dT}{d\\eta} \\frac{\\partial \\eta}{\\partial x} = \\frac{1}{2\\sqrt{\\alpha t}} \\frac{dT}{d\\eta} $$\n$$ \\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\frac{dT}{d\\eta} \\right) = \\frac{1}{2\\sqrt{\\alpha t}} \\frac{d^2 T}{d\\eta^2} \\frac{\\partial \\eta}{\\partial x} = \\frac{1}{4\\alpha t} \\frac{d^2 T}{d\\eta^2} $$\n将这些代入热方程 $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$ 得到：\n$$ -\\frac{\\eta}{2t} \\frac{dT}{d\\eta} = \\alpha \\left( \\frac{1}{4\\alpha t} \\frac{d^2 T}{d\\eta^2} \\right) $$\n$$ \\frac{d^2 T}{d\\eta^2} + 2\\eta \\frac{dT}{d\\eta} = 0 $$\n这是一个关于 $T(\\eta)$ 的二阶线性常微分方程。通解可以通过令 $U = dT/d\\eta$ 求得，这给出一阶可分离方程 $dU/d\\eta = -2\\eta U$。其解为 $U(\\eta) = C_1 \\exp(-\\eta^2)$。对 $\\eta$ 积分得到：\n$$ T(\\eta) = C_1 \\int_0^\\eta \\exp(-\\xi^2) d\\xi + C_2 $$\n使用 Gauss 误差函数的定义 $\\operatorname{erf}(y) = \\frac{2}{\\sqrt{\\pi}} \\int_0^y \\exp(-\\xi^2) d\\xi$，温度的通解为：\n$$ T(\\eta) = A \\operatorname{erf}(\\eta) + B $$\n其中 $A$ 和 $B$ 是常数。固体区域 $0  x  s(t)$ 对应于相似性域 $0  \\eta  \\lambda$。我们应用边界条件来求解 $A$ 和 $B$。\n\n在 $x=0$ 处，我们有 $\\eta=0$。边界条件 $T(0,t)=T_0$ 变为 $T(\\eta=0) = T_0$。\n$$ T(0) = A \\operatorname{erf}(0) + B = A \\cdot 0 + B = B \\implies B = T_0 $$\n在界面 $x=s(t)$ 处，我们有 $\\eta = s(t)/(2\\sqrt{\\alpha t}) = (2\\lambda\\sqrt{\\alpha t})/(2\\sqrt{\\alpha t}) = \\lambda$。条件 $T(s(t), t)=T_m$ 变为 $T(\\eta=\\lambda)=T_m$。\n$$ T(\\lambda) = A \\operatorname{erf}(\\lambda) + T_0 = T_m \\implies A = \\frac{T_m - T_0}{\\operatorname{erf}(\\lambda)} $$\n将 $A$ 和 $B$ 代回到 $T(\\eta)$ 的解中，并用 $x$ 和 $t$ 表示，得到固体中的温度场：\n$$ T(x,t) = T_0 + (T_m - T_0) \\frac{\\operatorname{erf}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)}{\\operatorname{erf}(\\lambda)} $$\n现在我们使用 Stefan 条件来确定 $\\lambda$ 的值。首先，我们计算所需的导数。界面处的温度梯度为：\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=s(t)} = \\frac{dT}{d\\eta}\\bigg|_{\\eta=\\lambda} \\frac{\\partial \\eta}{\\partial x} = \\left( A \\frac{2}{\\sqrt{\\pi}} \\exp(-\\lambda^2) \\right) \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\right) $$\n代入 $A$ 的表达式：\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=s(t)} = \\frac{T_m - T_0}{\\operatorname{erf}(\\lambda)} \\frac{2}{\\sqrt{\\pi}} \\exp(-\\lambda^2) \\frac{1}{2\\sqrt{\\alpha t}} = \\frac{T_m - T_0}{\\sqrt{\\pi \\alpha t} \\operatorname{erf}(\\lambda)} \\exp(-\\lambda^2) $$\n界面的速度为：\n$$ \\frac{ds}{dt} = \\frac{d}{dt} (2\\lambda\\sqrt{\\alpha t}) = 2\\lambda\\sqrt{\\alpha} \\left( \\frac{1}{2}t^{-1/2} \\right) = \\frac{\\lambda\\sqrt{\\alpha}}{\\sqrt{t}} $$\n将这两个表达式代入 Stefan 条件 $k \\frac{\\partial T}{\\partial x}|_{s(t)} = \\rho L \\frac{ds}{dt}$：\n$$ k \\left( \\frac{T_m - T_0}{\\sqrt{\\pi \\alpha t} \\operatorname{erf}(\\lambda)} \\exp(-\\lambda^2) \\right) = \\rho L \\left( \\frac{\\lambda\\sqrt{\\alpha}}{\\sqrt{t}} \\right) $$\n项 $\\sqrt{t}$ 消去。整理方程：\n$$ k (T_m - T_0) \\exp(-\\lambda^2) = \\rho L \\lambda \\sqrt{\\alpha} \\sqrt{\\pi \\alpha} \\operatorname{erf}(\\lambda) = \\rho L \\lambda \\alpha \\sqrt{\\pi} \\operatorname{erf}(\\lambda) $$\n代入 $\\alpha = k/(\\rho c)$：\n$$ k (T_m - T_0) \\exp(-\\lambda^2) = \\rho L \\lambda \\frac{k}{\\rho c} \\sqrt{\\pi} \\operatorname{erf}(\\lambda) $$\n项 $k$ 和 $\\rho$ 消去：\n$$ (T_m - T_0) \\exp(-\\lambda^2) = \\frac{L}{c} \\lambda \\sqrt{\\pi} \\operatorname{erf}(\\lambda) $$\n最后，我们整理这个结果，用 Stefan 数 $\\mathrm{Ste} = c(T_m - T_0)/L$ 来表示它：\n$$ \\frac{c(T_m - T_0)}{L} = \\sqrt{\\pi} \\lambda \\exp(\\lambda^2) \\operatorname{erf}(\\lambda) $$\n这就是相似性参数 $\\lambda$ 的超越方程：\n$$ \\mathrm{Ste} = \\sqrt{\\pi} \\lambda \\exp(\\lambda^2) \\operatorname{erf}(\\lambda) $$\n对于给定的 Stefan 数，可以数值求解该方程以找到唯一的正值 $\\lambda$。确定了 $\\lambda$ 后，任何时间 $t0$ 的界面位置由从相似性假设推导出的表达式给出。",
            "answer": "$$\n\\boxed{s(t) = 2 \\lambda \\sqrt{\\alpha t}}\n$$"
        },
        {
            "introduction": "虽然像斯特凡问题这样的解析模型非常宝贵，但大多数工程应用涉及复杂的几何形状和材料特性，需要使用数值方法求解。焓法是一种强大且广泛应用的计算技术，它避免了显式追踪界面。此方法中的一个关键步骤是在每个时间步之后，从计算出的焓场 $H$ 中恢复温度场 $T$。这个实践 () 要求您为此反演过程设计并实现一个稳健的算法，这对于任何开发或使用高级相变模拟软件的人来说都是一项核心技能。",
            "id": "3973595",
            "problem": "考虑在一维空间中使用隐式时间积分器进行基于焓的相变建模。其基本原理是能量守恒和将焓定义为状态变量：$ \\rho \\, \\dfrac{\\partial H}{\\partial t} = \\nabla \\cdot \\left( k \\nabla T \\right) $，其中 $ \\rho $ 是质量密度，$ H $ 是比焓，$ T $ 是温度，$ k $ 是热导率。在焓法中，比焓 $ H $ 依赖于 $ T $，并隐式地包含了潜热。在一个隐式时间步之后，新的焓 $ H^{n+1} $ 通过离散扩散求解得到，但温度 $ T^{n+1} $ 必须通过反演 $ H(T) $ 来恢复。为确保对任意单调、分段线性的 $ H(T) $ 具有鲁棒性，您必须设计一个全局收敛的迭代反演方案，该方案适用于有限体积法 (FVM) 或有限元法 (FEM) 求解器中的每个时间步。\n\n假设分段线性的本构关系 $ H(T) $ 由三个区域定义，其中一个糊状区（固液共存区）在固相线温度 $ T_s $ 和液相线温度 $ T_\\ell $ 之间线性地分配潜热。令 $ T_{\\mathrm{ref}} $ 为参考温度，$ c_s $ 为固相区的比热，$ c_m $ 为糊状区的有效比热，$ c_\\ell $ 为液相区的比热，$ L $ 为单位质量的熔化潜热。定义\n$$\nH_s \\equiv c_s \\,(T_s - T_{\\mathrm{ref}}), \\qquad\nH_\\ell \\equiv H_s + c_m \\,(T_\\ell - T_s) + L,\n$$\n并令分段函数 $ H(T) $ 为\n$$\nH(T) =\n\\begin{cases}\nc_s \\,(T - T_{\\mathrm{ref}}),  T \\le T_s, \\\\\nH_s + \\big(c_m + \\dfrac{L}{T_\\ell - T_s}\\big)\\,(T - T_s),  T_s  T \\le T_\\ell, \\\\\nH_\\ell + c_\\ell \\,(T - T_\\ell),  T  T_\\ell.\n\\end{cases}\n$$\n\n从上述基本定律和核心定义出发，设计一个求根方案来反演 $ H(T) $，以便在隐式积分器中从给定的 $ H $ 恢复 $ T $。您的方案必须：\n- 利用由 $ c_s  0 $、$ c_m  0 $、$ c_\\ell  0 $、$ L  0 $ 和 $ T_\\ell  T_s $ 所蕴含的 $ H(T) $ 的单调性。\n- 对于所有满足物理约束的输入 $ H \\in \\mathbb{R} $ 和参数，该方案必须是全局收敛的。\n- 能够无误地处理在 $ T = T_s $ 和 $ T = T_\\ell $ 处的不可微扭折点。\n- 仅使用与计算热工学实践相兼容的代数和迭代运算。\n\n您必须实现一个程序，该程序针对指定的测试套件，为每个提供的焓值反演出相应的温度。所有最终温度以开尔文（$\\mathrm{K}$）表示，并四舍五入到六位小数。不涉及角度。程序必须生成单行输出，该输出是一个用方括号括起来的、逗号分隔的 Python 风格浮点数列表。\n\n使用以下参数集和目标焓值的测试套件（所有量均采用国际单位制）：\n- 材料 A：$ T_{\\mathrm{ref}} = 300 $，$ c_s = 600 $，$ c_m = 700 $，$ c_\\ell = 800 $，$ L = 260000 $，$ T_s = 1700 $，$ T_\\ell = 1800 $。\n  - 反演目标：\n    - 案例 A1：$ H = 500000 $（固相区）。\n    - 案例 A2：$ H = H_s $（恰好在 $ T_s $ 处）。\n    - 案例 A3：$ H = 900000 $（糊状区）。\n    - 案例 A4：$ H = H_\\ell $（恰好在 $ T_\\ell $ 处）。\n    - 案例 A5：$ H = 1300000 $（液相区）。\n- 材料 B（窄糊状区）：$ T_{\\mathrm{ref}} = 273 $，$ c_s = 2100 $，$ c_m = 3000 $，$ c_\\ell = 4180 $，$ L = 334000 $，$ T_s = 273 $，$ T_\\ell = 274 $。\n  - 反演目标：\n    - 案例 B1：$ H = -10000 $（低于 $ T_{\\mathrm{ref}} $，固相区）。\n    - 案例 B2：$ H = 100000 $（糊状区）。\n    - 案例 B3：$ H = H_\\ell $（恰好在 $ T_\\ell $ 处）。\n    - 案例 B4：$ H = 600000 $（液相区）。\n\n您的程序应生成单行输出，其中包含案例 $ \\mathrm{A1} $ 到 $ \\mathrm{A5} $，随后是案例 $ \\mathrm{B1} $ 到 $ \\mathrm{B4} $ 对应的温度，形式为一个逗号分隔的列表，并用方括号括起来（例如，$ [T_{\\mathrm{A1}}, T_{\\mathrm{A2}}, \\dots, T_{\\mathrm{B4}}] $）。所有温度必须以开尔文（$\\mathrm{K}$）为单位，并四舍五入到六位小数。",
            "solution": "该问题要求设计并实现一个鲁棒的、全局收敛的数值方案，以根据给定的比焓 $H$ 找到对应的温度 $T$。对于基于焓的隐式有限体积法或有限元法相变问题求解器，本构关系 $H(T)$ 的反演是每个时间迭代中的一个基本后处理步骤。能量守恒方程为 $ \\rho \\, \\dfrac{\\partial H}{\\partial t} = \\nabla \\cdot \\left( k \\nabla T \\right) $。在对该方程进行离散化并求解得到新时间步的焓场 $H^{n+1}$ 后，必须通过函数 $T(H)$ 恢复温度场 $T^{n+1}$。\n\n所提供的本构关系 $H(T)$ 是一个定义在固相、糊状和液相三个区域上的连续分段线性函数。\n$$\nH(T) =\n\\begin{cases}\nc_s \\,(T - T_{\\mathrm{ref}}),  T \\le T_s \\\\\nH_s + \\left(c_m + \\dfrac{L}{T_\\ell - T_s}\\right)\\,(T - T_s),  T_s  T \\le T_\\ell \\\\\nH_\\ell + c_\\ell \\,(T - T_\\ell),  T  T_\\ell\n\\end{cases}\n$$\n阈值 $H_s$ 和 $H_\\ell$ 标记了相变之间的过渡：\n$$\nH_s = c_s \\,(T_s - T_{\\mathrm{ref}})\n$$\n$$\nH_\\ell = H_s + c_m \\,(T_\\ell - T_s) + L\n$$\n物理约束 $c_s  0$、$c_m  0$、$c_\\ell  0$、$L  0$ 和 $T_\\ell  T_s$ 确保了 $H(T)$ 的斜率（代表有效热容 $dH/dT$）在所有三个区域中都严格为正。\n斜率分别为：\n- 固相区 ($T \\le T_s$): $S_s = c_s  0$\n- 糊状区 ($T_s  T \\le T_\\ell$): $S_m = c_m + \\dfrac{L}{T_\\ell - T_s}  0$\n- 液相区 ($T  T_\\ell$): $S_\\ell = c_\\ell  0$\n\n一个连续且处处具有严格正导数（或斜率，对于分段函数）的函数是严格单调递增的。一条关键的数学原理指出，任何在给定定义域上的严格单调函数，在其值域上都有一个唯一的反函数。因此，对于任何给定的焓值 $H$，都存在唯一对应的温度 $T$。这保证了反演 $H(T)$ 的问题是适定的。\n\n问题要求方案是全局收敛的，并且能处理 $T=T_s$ 和 $T=T_\\ell$ 处的不可微点。对于分段线性函数，最鲁棒、高效和精确的“方案”并非迭代方案（如二分法或牛顿法，由于扭折点的存在，这些方法并不理想），而是直接解析反演。这种方法可以看作是一个单步收敛且误差为零的算法。它是全局收敛的，因为它为任何输入 $H \\in \\mathbb{R}$ 提供精确解。\n\n反演过程如下。我们为三个线性段分别推导反函数 $T(H)$。具体应用哪个反演公式，取决于将给定的焓 $H$ 与阈值 $H_s$ 和 $H_\\ell$ 进行比较的结果。\n\n1.  **固相区的反演 ($H \\le H_s$)：**\n    给定 $H = c_s(T - T_{\\mathrm{ref}})$，求解 $T$：\n    $$ \\frac{H}{c_s} = T - T_{\\mathrm{ref}} $$\n    $$ T(H) = T_{\\mathrm{ref}} + \\frac{H}{c_s} $$\n\n2.  **糊状区的反演 ($H_s  H \\le H_\\ell$)：**\n    给定 $H = H_s + \\left(c_m + \\frac{L}{T_\\ell - T_s}\\right)(T - T_s)$，求解 $T$：\n    $$ H - H_s = \\left(c_m + \\frac{L}{T_\\ell - T_s}\\right)(T - T_s) $$\n    $$ T - T_s = \\frac{H - H_s}{c_m + \\frac{L}{T_\\ell - T_s}} $$\n    $$ T(H) = T_s + \\frac{H - H_s}{c_m + \\frac{L}{T_\\ell - T_s}} $$\n\n3.  **液相区的反演 ($H  H_\\ell$)：**\n    给定 $H = H_\\ell + c_\\ell(T - T_\\ell)$，求解 $T$：\n    $$ H - H_\\ell = c_\\ell(T - T_\\ell) $$\n    $$ T - T_\\ell = \\frac{H - H_\\ell}{c_\\ell} $$\n    $$ T(H) = T_\\ell + \\frac{H - H_\\ell}{c_\\ell} $$\n\n根据给定的 $H$ 求 $T$ 的完整算法如下：\n1.  根据给定的材料参数，计算阈值焓 $H_s$ 和 $H_\\ell$。\n2.  如果目标焓 $H_{\\text{target}} \\le H_s$，应用固相区反演公式。等式情况 $H_{\\text{target}} = H_s$ 正确得出 $T=T_s$。\n3.  如果 $H_s  H_{\\text{target}} \\le H_\\ell$，应用糊状区反演公式。等式情况 $H_{\\text{target}} = H_\\ell$ 正确得出 $T=T_\\ell$。\n4.  如果 $H_{\\text{target}}  H_\\ell$，应用液相区反演公式。\n\n这个基于情况分类的解析反演方案在所提供的程序中得以实现，用以求解测试套件中要求的温度。该方案直接、精确、计算高效且无条件稳定，利用了焓温关系的单调性这一基本属性，因此满足所有问题约束。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for temperature T by inverting the piecewise-linear enthalpy function H(T)\n    for a given set of materials and target enthalpy values.\n    \"\"\"\n\n    # Define the material properties and target enthalpy values as specified in the problem statement.\n    # Each entry is a tuple: (material_parameters_dict, list_of_target_H).\n    # Some targets are functions of material parameters (e.g., H_s, H_l) and are denoted by strings.\n    test_cases = [\n        (\n            {\n                \"name\": \"Material A\",\n                \"T_ref\": 300.0,\n                \"c_s\": 600.0,\n                \"c_m\": 700.0,\n                \"c_l\": 800.0,\n                \"L\": 260000.0,\n                \"T_s\": 1700.0,\n                \"T_l\": 1800.0,\n            },\n            [500000.0, \"H_s\", 900000.0, \"H_l\", 1300000.0],\n        ),\n        (\n            {\n                \"name\": \"Material B\",\n                \"T_ref\": 273.0,\n                \"c_s\": 2100.0,\n                \"c_m\": 3000.0,\n                \"c_l\": 4180.0,\n                \"L\": 334000.0,\n                \"T_s\": 273.0,\n                \"T_l\": 274.0,\n            },\n            [-10000.0, 100000.0, \"H_l\", 600000.0],\n        ),\n    ]\n\n    results = []\n    \n    for params, targets in test_cases:\n        # Unpack material parameters\n        T_ref = params[\"T_ref\"]\n        c_s = params[\"c_s\"]\n        c_m = params[\"c_m\"]\n        c_l = params[\"c_l\"]\n        L = params[\"L\"]\n        T_s = params[\"T_s\"]\n        T_l = params[\"T_l\"]\n\n        # Step 1: Calculate the threshold enthalpies H_s and H_l\n        H_s = c_s * (T_s - T_ref)\n        H_l = H_s + c_m * (T_l - T_s) + L\n\n        # Calculate the effective specific heat in the mushy region\n        # This check handles the case T_l = T_s, although constraints say T_l > T_s.\n        if T_l > T_s:\n            c_eff_mushy = c_m + L / (T_l - T_s)\n        else:\n            # For an isothermal phase change, the mushy region has zero width.\n            # Enthalpy jumps from H_s to H_l = H_s + L at T = T_s.\n            c_eff_mushy = np.inf\n\n\n        # Replace string placeholders with calculated values\n        processed_targets = []\n        for h_val in targets:\n            if h_val == \"H_s\":\n                processed_targets.append(H_s)\n            elif h_val == \"H_l\":\n                processed_targets.append(H_l)\n            else:\n                processed_targets.append(h_val)\n\n        for H_target in processed_targets:\n            # Implement the direct analytical inversion\n            if H_target = H_s:\n                # Solid Region: T = T_ref + H / c_s\n                temp = T_ref + H_target / c_s\n            elif H_s  H_target = H_l:\n                # Mushy Region: T = T_s + (H - H_s) / c_eff_mushy\n                if T_l > T_s:\n                    temp = T_s + (H_target - H_s) / c_eff_mushy\n                else: # Isothermal case, T must be T_s=T_l\n                    temp = T_s\n            else: # H_target > H_l\n                # Liquid Region: T = T_l + (H - H_l) / c_l\n                temp = T_l + (H_target - H_l) / c_l\n            \n            # Append the result, rounded to six decimal places, as required.\n            results.append(round(temp, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}