## 引言
相变[凝固与熔化](@entry_id:155976)是自然界和工程技术中无处不在的现象，从金属铸造、先进材料制造到地球气候系统和生物过程，其影响深远。精确预测和控制这些过程对于技术创新和科学理解至关重要。然而，在复杂的物理原理与可行的[计算模型](@entry_id:637456)及多样化的应用场景之间建立一座桥梁，仍然是一个持续的挑战。本文旨在系统性地应对这一挑战，为读者提供一个从理论基础到前沿应用，再到实践技能的完整知识框架。

在接下来的内容中，我们将首先在“原则与机理”一章中，从第一性原理出发，深入剖析相变过程的能量学，并系统介绍锐利界面、[焓法](@entry_id:148184)及[相场法](@entry_id:191689)等核心建模方法。紧接着，在“应用与跨学科联系”一章中，我们将展示这些模型如何跨越学科界限，解决从材料科学、[热能工程](@entry_id:139895)到地球物理乃至细胞生物学等领域的实际问题。最后，在“动手实践”部分，您将通过一系列精心设计的计算练习，将理论知识转化为解决具体问题的实践能力。通过这三个层层递进的章节，本文将引导您全面掌握相变[凝固与熔化](@entry_id:155976)建模的精髓。

## 原则与机理

在本章中，我们将深入探讨相变[凝固与熔化](@entry_id:155976)建模背后的核心物理原则与数学机理。与前一章的概述不同，本章将从第一性原理出发，系统地构建描述相变现象的各类模型。我们将首先阐明[相变过程](@entry_id:147919)中的基本[热力学](@entry_id:172368)概念，随后介绍两种主流的连续介质模型——锐利界面模型和[焓法](@entry_id:148184)模型。在此基础上，我们将进一步探讨更复杂的界面物理现象，包括合金中的[溶质分配](@entry_id:1131936)、界面曲率的毛细效应以及[非平衡动力学](@entry_id:160262)。最后，我们将简要介绍一种更先进的弥散界面模型——[相场法](@entry_id:191689)，为其在后续章节的详细讨论奠定基础。

### [相变过程](@entry_id:147919)的基础能量学

理解任何相变模型的第一步，是精确地区分与过程相关的两种热量形式：**显热 (sensible heat)** 与 **潜热 (latent heat)**。**显热**是指系统在不发生相变的情况下，因温度变化而吸收或释放的能量。它与材料的比热容 $c_p$ 和温度变化量 $\Delta T$ 直接相关。相反，**潜熱**是在等温等压条件下，单位质量物质发生相变（如从液相转变为固相）时吸收或释放的能量。例如，在[凝固](@entry_id:156052)过程中，系统向外释放潜热，而在熔化过程中则吸收潜热 。

从[热力学](@entry_id:172368)角度看，恒压下的相变潜热 $L$ 被严格定义为材料在熔点温度 $T_m$ 和给定压力 $p$ 下，液相与固相之间的比焓差 ：

$L = h_l(T_m, p) - h_s(T_m, p)$

其中 $h_l$ 和 $h_s$ 分别是液相和固相的比焓。这个定义至关重要，因为它将潜热与一个精确的[状态函数](@entry_id:137683)（焓）联系起来，为后续的能量守恒分析提供了坚实的理论基础。

在分析一个具体的[相变传热](@entry_id:149240)问题时，评估显热与潜热的相对重要性是至关重要的。为此，我们引入一个关键的无量纲参数——**[斯特凡数](@entry_id:162817) (Stefan number)**，记作 $Ste$。它定义为特征温差 $\Delta T$ 下的显热与相变潜热之比 ：

$Ste = \frac{c_p \Delta T}{L}$

[斯特凡数](@entry_id:162817)的物理意义在于量化了系统中温度变化所需的能量与相变所需的能量之间的比例。
-   当 $Ste \ll 1$ 时，意味着相变潜热 $L$ 远大于显热 $c_p \Delta T$。在这种情况下，系统的能量收支由潜热的吸收或释放主导。传热过程的主要任务是移除或供给潜热，从而驱动[相界面](@entry_id:172947)的移动。因此，这是一个**潜热主导 (latent-heat-dominated)** 的过程。
-   当 $Ste \gg 1$ 时，情况则相反。显热在能量平衡中占据主导地位，而相变所需的能量相对较小。系统的温度场会有剧烈的变化，这是一个**显热主导 (sensible-heat-dominated)** 的过程 。

理解[斯特凡数](@entry_id:162817)的概念，有助于我们在建模和求解之前，对问题的物理特性有一个初步的判断。

### [相变过程](@entry_id:147919)的连续介质模型

在宏观尺度上，[凝固](@entry_id:156052)和熔化过程通常通过连续介质力学的方法来建模。目前主要存在两大类方法：锐利界面模型和固定区域方法（如[焓法](@entry_id:148184)）。

#### 锐利界面模型

锐利界面模型将固相区 $\Omega_s(t)$ 和液相区 $\Omega_l(t)$ 视为两个独立的连续介质区域，由一个没有厚度的数学曲面——**[相界面](@entry_id:172947) (interface)** $\Gamma(t)$ 分隔。在每个相区内部，温度场 $T_s(\mathbf{x},t)$ 和 $T_l(\mathbf{x},t)$ 分别遵循各自的[热传导方程](@entry_id:194763)：

$\rho c_s \frac{\partial T_s}{\partial t} = \nabla \cdot (k_s \nabla T_s) \quad \text{在 } \Omega_s(t) \text{ 内}$

$\rho c_l \frac{\partial T_l}{\partial t} = \nabla \cdot (k_l \nabla T_l) \quad \text{在 } \Omega_l(t) \text{ 内}$

其中 $\rho$ 是密度， $c_s$ 和 $c_l$ 是比热， $k_s$ 和 $k_l$ 是[热导](@entry_id:189019)率。这是一个[移动边界问题](@entry_id:170533)，其核心在于正确描述[移动界面](@entry_id:141467) $\Gamma(t)$ 上的边界条件。

对于纯物质，在[局部热平衡](@entry_id:147993)的假设下，界面上需要满足两个条件：

1.  **[热力学平衡](@entry_id:141660)条件**：界面上的温度是连续的，并且等于材料的[熔点](@entry_id:195793)温度 $T_m$ (暂不考虑曲率等效应)。
    $T_s = T_l = T_m \quad \text{在 } \Gamma(t) \text{ 上}$

2.  **能量守恒条件 ([斯特凡条件](@entry_id:149175), Stefan Condition)**：界面移动释放或吸收的潜热，必须等于通过界面两侧传入和传出的热通量之差。这是一个界面上的[能量平衡方程](@entry_id:191484)。

为了精确表述[斯特凡条件](@entry_id:149175)，我们定义界面的[单位法向量](@entry_id:178851) $\mathbf{n}$ 指向液相，界面的法向速度为 $V_n$。界面前进释放的单位面积潜热功率为 $\rho L V_n$。另一方面，从界面传入固相的热通量为 $\mathbf{q}_s \cdot (-\mathbf{n})$，传入液相的热通量为 $\mathbf{q}_l \cdot \mathbf{n}$。根据傅里葉定律 $\mathbf{q} = -k \nabla T$，总的净流出热通量为 $(-\mathbf{q}_s + \mathbf{q}_l) \cdot \mathbf{n}$。能量守恒要求：

$\rho L V_n = (\mathbf{q}_l - \mathbf{q}_s) \cdot \mathbf{n} = (-k_l \nabla T_l - (-k_s \nabla T_s)) \cdot \mathbf{n}$

整理后得到[斯特凡条件](@entry_id:149175)的标准形式  ：

$\rho L V_n = k_s (\mathbf{n} \cdot \nabla T_s) - k_l (\mathbf{n} \cdot \nabla T_l)$

或写为[法向导数](@entry_id:169511)的形式：

$\rho L V_n = k_s \frac{\partial T_s}{\partial n} - k_l \frac{\partial T_l}{\partial n}$

这个方程将界面的运动 ($V_n$) 与两侧的温度梯度直接联系起来，是所有锐利界面模型的核心。

#### [焓法](@entry_id:148184)模型

锐利界面模型虽然物理图像清晰，但在数值处理上非常复杂，因为它需要显式地追踪移动的界面。为了规避这一困难，**[焓法](@entry_id:148184) (Enthalpy Method)** 被提了出来。这是一种固定区域方法，其核心思想是在整个计算区域内求解一个统一的能量方程，而相变的信息则被巧妙地蕴含在**焓-温度 ($h-T$)关系**中。

我们定义比焓 $h$ 为包含显热和潜热的总能量。对于纯物质，[总焓](@entry_id:197863)可以表示为显热部分 $h_{sens}(T)$ 和与液相分数 $f_l$ 相关的潜热部分之和：

$h(T, f_l) = h_{sens}(T) + L f_l$

[能量守恒方程](@entry_id:748978)可以统一写为 ：

$\rho \frac{\partial h}{\partial t} = \nabla \cdot (k \nabla T)$

这个方程形式简洁，但包含了两个未知数 $h$ 和 $T$。为了封闭方程，我们需要一个[本构关系](@entry_id:186508)——即 $h$ 和 $T$ 之间的关系。

对于在单一温度 $T_m$ 下发生相变的纯物质，其 $h-T$ 关系是独特的。当温度低于 $T_m$ 时，材料为固相 ($f_l=0$)，焓随温度线性增加。当温度高于 $T_m$ 时，材料为液相 ($f_l=1$)，焓也随温度线性增加。而在 $T=T_m$ 时，温度保持不变，但焓值会经历一个大小为 $L$ 的跳跃，此时 $f_l$ 从0变化到1。这导致 $h(T)$ 函数在 $T=T_m$ 处是多值的，或者说其[反函数](@entry_id:141256) $T(h)$ 在对应的焓区间 $[h_s(T_m), h_l(T_m)]$ 内是单值的，恒等于 $T_m$。

这个特性正是[焓法](@entry_id:148184)的精髓所在，也是其数值实现的挑战。在数值求解时，我们通常先求解焓场 $h(\mathbf{x}, t)$ 的演化，然后再根据 $h-T$ 关系“恢复”出温度场 $T(\mathbf{x}, t)$。这个恢复过程遵循以下规则 ：
- 如果计算出的比焓 $h$ 低于固相在 $T_m$ 时的焓值 $h_s(T_m)$，则该点为固相，温度通过求解 $h = h_s(T)$ 得到。
- 如果 $h$ 高于液相在 $T_m$ 时的焓值 $h_l(T_m) = h_s(T_m)+L$，则该点为液相，温度通过求解 $h = h_l(T)$ 得到。
- 如果 $h$ 恰好落在区间 $[h_s(T_m), h_l(T_m)]$ 内，则该点正处于相变过程中，其温度就是 $T_m$。此时的液相分数可以计算为 $f_l = (h - h_s(T_m)) / L$。

为了便于数值计算，一种被称为**表观热容法 (Apparent Heat Capacity Method)** 的技术被广泛使用。它通过在一个很小的温度区间 $[T_s, T_l]$ 内“ smeared out”潜热，将 $h-T$ 关系中的垂直跳跃正则化为一个非常陡峭的斜坡。这使得 $h(T)$ 成为一个严格单调递增的函数，从而在任何焓值下都可以唯一地、稳定地反求出温度，例如通过牛顿迭代法 。

#### 扩展至合金：[糊状区](@entry_id:147943)模型

与纯物质不同，绝大多数合金不是在单一温度下[凝固](@entry_id:156052)，而是在一个温度区间——从液[相线](@entry_id:269561)温度 $T_l$ 到固[相线](@entry_id:269561)温度 $T_s$ ——内进行。在这个区间内，固相和液[相共存](@entry_id:147284)，形成一个被称为**糊状区 (mushy zone)** 的[微观混合](@entry_id:751971)区域。

[焓法](@entry_id:148184)可以自然地推广到这种情况。我们只需将液相分数 $f_l$ 定义为温度的函数。一个简单而常用的模型是**杠杆定律 (lever rule)**，它假设在糊状区内，液相分数随温度线性变化 ：

$f_l(T) = \frac{T - T_s}{T_l - T_s}, \quad \text{for } T_s \lt T \lt T_l$

在 $T \le T_s$ 时，$f_l = 0$；在 $T \ge T_l$ 时，$f_l = 1$。混合物的[总焓](@entry_id:197863)仍然可以写成各相比焓的加权平均：

$h(T) = f_s(T) h_s(T) + f_l(T) h_l(T)$

其中 $f_s(T) = 1 - f_l(T)$。对该式求温度的导数，可以得到表观比热 $\frac{dh}{dT}$。在糊状区内，这个导数不仅包含了两相的显热贡献 ($f_s c_s + f_l c_l$)，还包含了一个与潜[热释放速率](@entry_id:1125983)相关的项 $\frac{L}{T_l-T_s}$（在 $c_s=c_l$ 的简化下）。这清晰地表明，潜热是在整个凝固区间内逐渐释放的 。

### 先进的[界面物理学](@entry_id:143998)

上述模型主要关注热量传递，但在许多情况下，尤其是在[合金凝固](@entry_id:148532)和快速[凝固](@entry_id:156052)中，更复杂的界面物理现象起着决定性作用。

#### [合金凝固](@entry_id:148532)与[溶质分配](@entry_id:1131936)

在[合金凝固](@entry_id:148532)过程中，一个至关重要的现象是**溶质再分配 (solute redistribution)**。当液相凝固成固相时，溶质在两相中的[溶解度](@entry_id:147610)通常不同。这导致在固/液界面处，溶质会从固相中“排出”或被“吸收”到固相中。

为了量化这一现象，我们定义**平衡[溶质分配](@entry_id:1131936)系数 (equilibrium partition coefficient)** $k$ ：

$k = \frac{C_s}{C_l}$

其中 $C_s$ 和 $C_l$ 分别是平衡状态下，界面处固相和液相中的溶质浓度。$k$ 值通常不等于1，这正是[溶质分配](@entry_id:1131936)的根源。

这个系数并非一个经验参数，而是有其深刻的[热力学](@entry_id:172368)起源。在热力学平衡时，每个组元在固相和液相中的化学势必须相等。对于一个A-B[二元合金](@entry_id:160005)，这意味着：

$\mu_A^s(T, p, C_s) = \mu_A^l(T, p, C_l)$
$\mu_B^s(T, p, C_s) = \mu_B^l(T, p, C_l)$

在吉布斯自由能-成分图上，这个双重等式条件对应着一条同时与固相和液相自由能曲线相切的**公切线 (common tangent)**。两个[切点](@entry_id:172885)的成分坐标就定义了平衡的固相成分 $C_s$ 和液相成分 $C_l$。在温度-成分相图中，这两个点就是一条水平的**[连接线](@entry_id:196944) (tie-line)** 的两个端点。因此，分配系数 $k$ 直接由相图中的[连接线](@entry_id:196944)决定 。

#### 曲率效应：吉布斯-汤姆逊关系

在锐利界面模型中，我们通常假设界面是平直的。然而，在真实的凝固过程中，尤其是在枝晶生长等情形下，界面是弯曲的。界面的**曲率 (curvature)** 会通过**[界面能](@entry_id:198323) (interfacial energy)** $\gamma_{sl}$ 影响局部的热力学平衡。

这种效应被称为**吉布斯-汤姆逊效应 (Gibbs-Thomson effect)**。它指出，弯曲界面的平衡温度 $T_{int}$ 会偏离平直界面的[熔点](@entry_id:195793) $T_m$。通过从化学势相等的平衡条件 $\mu_s(T, p_s) = \mu_l(T, p_l)$ 出发，并引入由界面曲率 $\kappa$ 引起的[拉普拉斯压力](@entry_id:139171)差 $p_s - p_l = \gamma_{sl} \kappa$，我们可以推导出如下关系 ：

$T_{int} = T_m - \Gamma \kappa$

其中 $\Gamma$ 是吉布斯-汤姆逊系数，它正比于[界面能](@entry_id:198323) $\gamma_{sl}$ 和熔点 $T_m$，反比于潜热 $L$ 和固相密度 $\rho_s$。这个方程的物理意义是，对于一个凸向液相的固相（例如一个小的晶核，$\kappa > 0$），其平衡温度会低于 $T_m$。这意味着小的晶体颗粒需要更大的过冷度才能稳定存在，这解释了形核过程中的能量壁垒。

#### [非平衡动力学](@entry_id:160262)：原子附着速率

上述讨论都基于**局部平衡 (local equilibrium)** 的假设，即界面上的原子有足够的时间达到[热力学平衡](@entry_id:141660)。然而，在**快速[凝固](@entry_id:156052) (rapid solidification)** 过程中，界面移动速度非常快，原子附着到[晶格](@entry_id:148274)上的速率是有限的，这会导致界面偏离[局部平衡](@entry_id:156295)。

为了驱动界面以有限的速度 $V$ 运动，必须存在一个额外的热力学驱动力，即固液两相间的吉布斯自由能差 $\Delta g$。对于较小的驱动力，界面速度 $V$ 与 $\Delta g$ 成正比：$V = \mu \Delta g$，其中 $\mu$ 被称为**[界面动力学](@entry_id:1126605)系数 (interface kinetic coefficient)**。

自由能差 $\Delta g$ 又可以近似地与界面温度 $T_i$ 偏离平衡温度的程度关联起来。这导致界面上产生一个额外的温度降，称为**动力学过冷 (kinetic undercooling)** $\Delta T_k$，它正比于界面速度 $V$ ：

$\Delta T_k \propto V$

因此，一个完整的界面温度边界条件必须包含所有这些物理效应。界面处的实际温度 $T_i$ 由平直界面熔点 $T_m$、曲率修正项和动力学修正项共同决定：

$T_i = T_m - \Gamma \kappa - \Delta T_k = T_m - \Gamma \kappa - \frac{1}{\mu_k} V$

其中 $\mu_k$ 是一个集总了[热力学](@entry_id:172368)和动力学参数的系数。这个方程是现代[凝固理论](@entry_id:1131923)中描述[微观结构演化](@entry_id:142782)的核心方程之一。

#### 弥散界面模型一瞥：[相场法](@entry_id:191689)

锐利界面和[焓法](@entry_id:148184)模型在处理复杂界面拓扑（如枝晶的断裂和合并）时会遇到困难。**[相场法](@entry_id:191689) (Phase-field Method)** 提供了一种强大的替代方案。它引入一个连续的**序参量 (order parameter)** $\phi$（例如，$\phi=+1$ 代表液相，$\phi=-1$ 代表固相）来描述相态。界面不再是一个数学曲面，而是一个 $\phi$ 从-1平滑过渡到+1的、具有物理厚度的**弥散区域 (diffuse region)**。

系统的状态由一个总的[自由能泛函](@entry_id:184428)描述，该泛函通常包含两部分：一部分是与局部相态 $\phi$ 和温度 $T$ 相关的**体自由能密度 (bulk free energy density)**，另一部分是与序参量梯度相关的**梯度能量密度**，后者用于惩罚界面区域的产生。

体自由能密度通常被设计成一个**双阱势 (double-well potential)** 函数 $f_b(\phi, T)$ 。这个函数在 $\phi=-1$ 和 $\phi=+1$ 附近有两个极小值（“阱”），分别对应固相和液相的亚稳态或[稳态](@entry_id:139253)。温度的作用是“倾斜”这个双阱势。例如，在熔点 $T_m$ 以下，[热力学](@entry_id:172368)要求固相是更稳定的相。这体现在 $f_b(\phi, T)$ 的固相阱（$\phi \approx -1$）比液相阱（$\phi \approx +1$）更深。这个能量差提供了相变的驱动力，使得系统倾向于从亚稳的液相演化到稳定的固相 。通过求解[序参量](@entry_id:144819) $\phi$ 和温度 $T$ 的耦合演化方程（通常是基于自由能泛函的变分下降），[相场法](@entry_id:191689)可以自然地捕捉复杂的[界面动力学](@entry_id:1126605)和微观结构形态的形成，而无需显式追踪界面。我们将在后续章节中对此进行更深入的探讨。