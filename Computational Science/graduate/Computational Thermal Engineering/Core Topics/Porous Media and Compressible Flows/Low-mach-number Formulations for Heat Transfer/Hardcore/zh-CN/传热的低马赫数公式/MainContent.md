## 引言
在工程与科学的广阔天地中，存在着一类普遍而又特殊的流动现象：流体以远低于声速的速度缓慢运动，但剧烈的热量传递或化学反应却引起其密度发生显著变化。典型的例子包括工业燃烧炉内的火焰、建筑物内的自然通风，以及电子设备的冷却过程。对这类问题进行精确的[数值模拟](@entry_id:146043)面临着一个两难困境：一方面，完全可压缩的流动模型虽然能捕捉密度变化，但其计算必须解析高速传播的声波，导致时间步长极小，计算成本高昂得不切实际；另一方面，传统的不可压缩模型假设密度恒定，这从根本上违背了问题的物理本质，无法描述[热膨胀](@entry_id:137427)这一核心现象。

为了填补这一模型空白，**低马赫数（Low-Mach-Number）公式**应运而生。它是一种精巧的计算框架，旨在高效且准确地模拟这类低速、变密度的热流问题。该方法通过系统性的[渐近分析](@entry_id:1121160)，巧妙地将控制方程中的声波滤除，同时完整保留了热量与密度变化之间的耦合关系。

本文将系统地介绍传热的[低马赫数公式](@entry_id:1127509)。我们将首先在**原则与机理**一章中，深入剖析其核心思想，包括尺度分离、压力分解以及如何通过非零[速度散度](@entry_id:264117)来描述[热膨胀](@entry_id:137427)效应。接下来，在**应用与交叉学科联系**一章中，我们将通过丰富的案例，展示这些理论在燃烧、[多相流](@entry_id:146480)、湍流模型和[超临界流体](@entry_id:150951)等不同工程与科学领域中的实际应用与扩展。最后，通过**动手实践**环节，读者将有机会运用所学知识，解决与[压力-速度耦合](@entry_id:155962)和[数值稳定性](@entry_id:175146)相关的[经典计算](@entry_id:136968)问题，从而将理论理解转化为实践能力。

## 原则与机理

在传热和燃烧等许多工程和科学领域中，我们经常遇到这样一类流动：[流体速度](@entry_id:267320)远低于声速，但由于显著的加热或化学反应，其密度会发生大幅变化。对于这类问题，经典的[计算流体力学](@entry_id:747620)方法面临着挑战。完全可压缩流动模型虽然精确，但由于需要解析高速传播的声波，其时间步长受到严格的声学CFL（Courant-Friedrichs-Lewy）条件限制，导致计算成本极高 。另一方面，简单的不可压缩模型假设密度恒定，这直接违背了问题的物理本质，无法描述热膨胀等关键现象。因此，发展一种既能有效处理大幅密度变化，又能避免声学时间步长限制的特殊公式，成为[计算热工学](@entry_id:1122812)领域的一个核心课题。低马赫数（Low-Mach-Number）公式正是为应对这一挑战而生的。本章将深入探讨这些公式背后的基本原则和核心机理。

### 尺度分离与压力分解

[低马赫数公式](@entry_id:1127509)的基石在于对压[力场](@entry_id:147325)的深刻洞察，即**[尺度分离](@entry_id:270204)**（scale separation）。在一个[特征速度](@entry_id:165394)为 $U$、声速为 $c$ 的系统中，流体的动能与内能之比，或者说动态压力与[热力学压力](@entry_id:1133073)之比，与马赫数 $Ma = U/c$ 的平方成正比。具体而言，与流体加速相关的**动态压力**（dynamic pressure）尺度为 $\rho U^2$，而流体的绝对**[热力学压力](@entry_id:1133073)**（thermodynamic pressure）尺度为 $\rho c^2$。两者的比值为：

$$
\frac{\rho U^2}{\rho c^2} = \left(\frac{U}{c}\right)^2 = Ma^2
$$

当[马赫数](@entry_id:274014)非常小 ($Ma \ll 1$) 时，这意味着由流动引起的压力波动远小于系统平均的[绝对压力](@entry_id:144445)。这一洞察启发我们将[总压](@entry_id:265293)[力场](@entry_id:147325) $p(\mathbf{x}, t)$ 分解为两个部分：一个空间上均匀但可能随时间变化的[热力学](@entry_id:172368)背景压力 $p_0(t)$，以及一个空间上变化的、量级小得多的[流体动力](@entry_id:750449)学压力扰动 $\pi(\mathbf{x}, t)$  。

$$
p(\mathbf{x}, t) = p_0(t) + \pi(\mathbf{x}, t)
$$

根据上述尺度分析，这两个压力分量的相对大小为 $\pi / p_0 = O(Ma^2)$。这种分解具有深远的意义。在[动量守恒](@entry_id:149964)方程中，驱动流动的力来自于压力梯度 $\nabla p$。将压力分解代入，我们得到：

$$
\nabla p = \nabla (p_0(t) + \pi(\mathbf{x}, t)) = \nabla p_0(t) + \nabla \pi(\mathbf{x}, t)
$$

由于 $p_0(t)$ 在空间上是均匀的，其梯度为零，即 $\nabla p_0(t) = \mathbf{0}$。因此，动量方程中的压力梯度项简化为 $\nabla \pi$ 。这意味着，驱动流体运动的压力梯度完全由微小的[流体动力](@entry_id:750449)学压力扰动 $\pi$ 提供，而巨大的[热力学](@entry_id:172368)背景压力 $p_0$ 本身并不直接驱动流动。

### [热力学耦合](@entry_id:170539)与非零[速度散度](@entry_id:264117)

压力分解的另一个关键结果体现在它如何与[物态方程](@entry_id:194191)相互作用，从而允许密度发生显著变化。对于[理想气体](@entry_id:200096)，[物态方程](@entry_id:194191)为 $p = \rho R T$。将压力分解代入：

$$
p_0(t) + \pi(\mathbf{x}, t) = \rho(\mathbf{x}, t) R T(\mathbf{x}, t)
$$

考虑到 $\pi$ 相对于 $p_0$ 是一个高阶小量 ($O(Ma^2)$)，在主导阶上，我们可以忽略 $\pi$，从而得到一个至关重要的**[热力学约束](@entry_id:755911)**（thermodynamic constraint）：

$$
p_0(t) \approx \rho(\mathbf{x}, t) R T(\mathbf{x}, t)
$$

这个关系式表明，在低马赫数极限下，局部密度和温度的乘积在空间上是均匀的，仅随时间变化 。这一约束正是[低马赫数公式](@entry_id:1127509)能够处理大幅密度变化的核心。如果一个系统受到强烈的非均匀加热，导致温度场 $T(\mathbf{x}, t)$ 出现 $O(1)$ 的相对变化（即温差与参考温度相当），那么为了维持上述约束，密度场 $\rho(\mathbf{x}, t)$ 也必须相应地发生 $O(1)$ 的变化，即 $\rho \propto 1/T$。这与不可压缩模型假设 $\rho = \text{const}$ 形成了鲜明对比 。

密度的变化直接影响了流场的运动学特性。从质量守恒方程出发：

$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0
$$

利用物质导数 $D(\cdot)/Dt = \partial(\cdot)/\partial t + \mathbf{u} \cdot \nabla(\cdot)$，上式可改写为：

$$
\frac{D\rho}{Dt} + \rho \nabla \cdot \mathbf{u} = 0
$$

由此可得[速度散度](@entry_id:264117)（或称为**膨胀率**，dilatation）$\theta = \nabla \cdot \mathbf{u}$ 的表达式：

$$
\nabla \cdot \mathbf{u} = -\frac{1}{\rho} \frac{D\rho}{Dt}
$$

由于热效应导致密度 $\rho$ 沿着流体质点的路径发生变化 ($D\rho/Dt \neq 0$)，速度场不再是无散的，即 $\nabla \cdot \mathbf{u} \neq 0$。这种流动被称为**非弹性**（anelastic）流动，以区别于不可压缩模型所要求的无散（solenoidal）条件 $\nabla \cdot \mathbf{u} = 0$ 。[速度散度](@entry_id:264117)的非零值精确地描述了流体因受热而膨胀或因冷却而收缩的体积变化效应。

我们可以进一步推导[速度散度](@entry_id:264117)的具体表达式。通过对[热力学约束](@entry_id:755911) $p_0 = \rho R T$ 取[物质导数](@entry_id:262900)，并结合能量方程和[质量守恒](@entry_id:204015)方程，可以得到一个描述[速度散度](@entry_id:264117)来源的精确方程。对于一个包含多种组分的[理想气体混合物](@entry_id:149212)，在忽略[粘性耗散](@entry_id:143708)等次要项的情况下，可以证明膨胀率 $\theta$ 由[热力学压力](@entry_id:1133073)的时间变化、热量增加和组分变化共同决定 ：

$$
\theta = \frac{1}{\gamma}\left[\frac{\dot{Q}}{\rho c_v T} + \frac{1}{R(\mathbf{Y})}\sum_{k=1}^{N_s} R_k\,\frac{D Y_k}{D t} - \frac{1}{p_0}\frac{D p_0}{D t}\right]
$$

其中，$\dot{Q}$ 是净容积加热率， $Y_k$ 是各组分的[质量分数](@entry_id:161575)，$R_k$ 是组分气体常数，$c_v$ 是定容比热，$\gamma$ 是比热比。此式清晰地量化了[热膨胀](@entry_id:137427)、化学反应（通过改变 $Y_k$ 和 $R(\mathbf{Y})$）以及背景压力变化对流场体积变化率的贡献。

### 数值实现与相关近似

#### 压力的椭圆特性与时间步长

[低马赫数公式](@entry_id:1127509)的巨大计算优势源于其改变了控制方程的数学属性。在完全可压缩模型中，压力和密度通过双曲型[波动方程](@entry_id:139839)耦合，声波以有限速度 $a$ 传播。这导致显式时间积分格式的稳定性必须满足声学[CFL条件](@entry_id:178032)，即 $\Delta t \le C \Delta x / (|\mathbf{u}| + a)$。在[低马赫数流动](@entry_id:751506)中，$a$ 远大于 $|\mathbf{u}|$，使得 $\Delta t$ 异常之小。

[低马赫数公式](@entry_id:1127509)通过压力分解和[渐近分析](@entry_id:1121160)，成功地**过滤**（filters out）了声波。如前所述，动量方程由 $\nabla \pi$ 驱动。通过对[动量方程](@entry_id:197225)取散度，并代入上文推导的[速度散度](@entry_id:264117)约束，可以得到一个关于流体动力学压力 $\pi$ 的**泊松型[椭圆方程](@entry_id:169190)**（Poisson-type elliptic equation）。椭圆方程的解在整个求解域内是瞬时耦合的，不具有传播特性的真实特征值。这意味着声波的传播机制已从模型中被移除。

因此，数值求解的时间步长不再受限于声速，而是由更慢的物理过程决定，主要是流体**对流**（advection）和**扩散**（diffusion）。[时间步长限制](@entry_id:756010)变为 $\Delta t \approx \min(\Delta x/U, \Delta x^2/\alpha)$，其中 $\alpha$ 是[热扩散](@entry_id:148740)系数。由于 $U \ll a$，这个时间步长可以比声学[CFL条件](@entry_id:178032)允许的时间步长大几个数量级，从而极大地提高了[计算效率](@entry_id:270255) 。

#### [热力学压力](@entry_id:1133073)的确定

泊松方程求解的是流体动力学压力 $\pi$。然而，[热力学](@entry_id:172368)背景压力 $p_0(t)$ 是如何确定的呢？由于 $p_0(t)$ 在空间上均匀，它在任何空间[微分算子](@entry_id:140145)（如梯度 $\nabla$ 或拉普拉斯算子 $\nabla^2$）作用下都为零。因此，求解 $\pi$ 的泊松方程完全无法提供关于 $p_0(t)$ 的信息。

$p_0(t)$ 必须通过一个独立的**全局约束**（global constraint）来确定。这个约束通常源于全域的[质量守恒](@entry_id:204015)。例如，在一个体积为 $V$ 的封闭、刚性容器内，总质量 $M = \int_V \rho \, \mathrm{d}V$ 必须保持恒定。将[热力学约束](@entry_id:755911) $\rho = p_0(t) / (R T(\mathbf{x}, t))$ 代入该积分式：

$$
M = \int_V \frac{p_0(t)}{R T(\mathbf{x}, t)} \, \mathrm{d}V = \frac{p_0(t)}{R} \int_V \frac{1}{T(\mathbf{x}, t)} \, \mathrm{d}V = \text{常数}
$$

这给出了一个用于更新 $p_0(t)$ 的[代数方程](@entry_id:272665)。随着容器内温度场 $T(\mathbf{x}, t)$ 因加热而演化，分母中的积分项会发生变化， $p_0(t)$ 必须相应调整以保证总质量守恒。例如，整体升温会导致积分项减小，因此 $p_0(t)$ 必须升高。这个全局[演化过程](@entry_id:175749)是无法通过求解局部压力扰动 $\pi$ 的泊松方程来捕捉的 。

#### [Boussinesq近似](@entry_id:147239)：一种更严格的简化

在某些特定的传热问题中，例如[自然对流](@entry_id:197869)，可以使用一种比[低马赫数公式](@entry_id:1127509)更严格的简化，即**[Boussinesq近似](@entry_id:147239)**。该近似假设温度变化引起的密度变化非常小（即 $|\rho-\rho_0|/\rho_0 \ll 1$）。在此假设下，密度的变化在所有控制方程中都被忽略，**除了**在动量方程的重力项（[浮力](@entry_id:154088)项）中。

具体来说，动量方程中的重力项 $\rho \mathbf{g}$ 被写为 $(\rho_0 + \rho') \mathbf{g}$，其中 $\rho_0$ 是参考密度，$\rho'$ 是密度扰动。通过减去静水平衡项 $-\nabla p_h + \rho_0 \mathbf{g} = \mathbf{0}$，[动量方程](@entry_id:197225)中出现的净[体力](@entry_id:174230)为[浮力](@entry_id:154088)项 $\mathbf{f}_b = \rho' \mathbf{g}$。利用热膨胀系数 $\beta = -(1/\rho)(\partial\rho/\partial T)_p$ 的定义，密度扰动可线性化为 $\rho' \approx -\rho_0 \beta (T - T_0)$。因此，[浮力](@entry_id:154088)项近似为 ：

$$
\mathbf{f}_b \approx -\rho_0 \beta (T - T_0) \mathbf{g}
$$

由于在[连续性方程](@entry_id:195013)中忽略了密度变化 ($D\rho/Dt \approx 0$)，Boussinesq近似下的速度场恢复为[无散场](@entry_id:260932)，即 $\nabla \cdot \mathbf{u} = 0$。因此，[Boussinesq近似](@entry_id:147239)可以看作是[低马赫数公式](@entry_id:1127509)在温度和密度变化极小情况下的一个特例，它仅保留了密度变化对[浮力](@entry_id:154088)的影响 。

#### 热学变量的选择：温度 vs. 焓

在处理具有强温度依赖性的物性参数（如比热 $c_p(T)$）的流动时，选择合适的求解变量至关重要。对于[理想气体](@entry_id:200096)，比焓 $h$ 仅仅是温度的函数，其关系由 $dh = c_p(T) dT$ 定义。这意味着，如果 $c_p(T)$ 不是常数，那么 $h$ 与 $T$ 之间存在[非线性](@entry_id:637147)但单调递增的可[逆关系](@entry_id:274206) 。

能量方程可以写作温度 $T$ 的[输运方程](@entry_id:174281)，也可以写作焓 $h$ 的[输运方程](@entry_id:174281)。
以温度为变量：$\rho c_p(T) \frac{DT}{Dt} = \dots$
以焓为变量：$\rho \frac{Dh}{Dt} = \dots$

当 $c_p(T)$ 变化显著时，以温度为变量的能量方程左侧（时间导数项）的系数 $\rho c_p(T)$ 是[非线性](@entry_id:637147)的。而以焓为变量时，该项的系数仅为 $\rho$，形式上更为简洁。然而，这种转换并非没有代价。原本线性的[热传导](@entry_id:143509)项 $\nabla \cdot (k \nabla T)$ 在转换为焓变量后，会变为[非线性](@entry_id:637147)的扩散项 $\nabla \cdot (\frac{k}{c_p} \nabla h)$，因为扩散系数 $k/c_p$ 成为焓（或温度）的函数。因此，选择 $h$ 作为输运变量，本质上是将[非线性](@entry_id:637147)从储存项转移到了扩散项，这在[数值算法](@entry_id:752770)设计中需要仔细权衡 。