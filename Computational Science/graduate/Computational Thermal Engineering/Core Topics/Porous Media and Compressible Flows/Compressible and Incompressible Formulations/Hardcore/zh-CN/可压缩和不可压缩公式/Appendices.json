{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于探索可压缩性的基本物理意义。本练习将指导您从第一性原理推导声速，并借此理解为何液体（如此处的水）尽管在物理上是可压缩的，但在许多工程流动中仍常被建模为不可压缩流体。这项实践旨在建立热力学性质（如等熵体积模量 $K_s$）与流体动力学关键近似（如 $\\nabla \\cdot \\mathbf{u} = 0$）之间的桥梁。",
            "id": "3940188",
            "problem": "一个充满水的通道被建模用于计算流体力学（CFD）分析，该分析在计算热工学领域进行，温度为 $T = 25\\,^\\circ\\mathrm{C}$，绝对压力为 $p = 0.1\\,\\mathrm{MPa}$。对于小振幅扰动，压缩波的传播速度（声速）由流体在等熵约束下的热力学响应决定。从基本热力学定义和连续介质质量守恒出发，推导液体声速 $c$ 关于等熵体积模量 $K_s$ 和质量密度 $\\rho$ 的表达式，然后使用以下测得的性质，在所述条件下计算水的声速 $c$：\n- 等熵体积模量 $K_s = 2.20 \\times 10^{9}\\,\\mathrm{Pa}$，\n- 质量密度 $\\rho = 997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n将最终数值结果四舍五入至四位有效数字，并以 $\\mathrm{m}\\,\\mathrm{s}^{-1}$ 为单位表示速度。\n\n在您的解答中，还需提供一个基于第一性原理的简要分析讨论，解释液体在物理上为何是可压缩的（具有有限的等熵体积模量），但在许多工程流动中却表现出几乎无散度的速度场。讨论应围绕质量守恒方程、材料响应函数（如等熵压缩率 $\\beta_s$ 和体积热膨胀系数 $\\alpha$）以及适当的无量纲化（例如马赫数 $M$）展开，并明确指出不可压缩公式成立的条件。",
            "solution": "此问题被评估为有效，因为它具有科学依据、提法明确、客观，并包含完整解答所需的所有信息。它提出了一个连续介质力学和计算热工学领域的标准而重要的问题。\n\n根据要求，解答分为三个部分：第一，声速的推导；第二，对水的数值计算；第三，关于液体不可压缩流动近似的分析讨论。\n\n第1部分：声速 $c$ 的推导\n\n流体中小振幅扰动（声波）的传播受质量守恒和动量守恒定律的支配。对于一维、无粘、非导热的流动，其欧拉形式的控制方程是连续性方程和欧拉方程。\n\n连续性方程：\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 $$\n\n动量方程：\n$$ \\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0 $$\n\n其中，$\\rho$ 是流体密度，$u$ 是 $x$ 方向的流体速度，$p$ 是压力，$t$ 是时间。\n\n我们分析在静止介质中小扰动的传播。流体初始静止，具有均匀的密度 $\\rho_0$ 和压力 $p_0$。扰动引入了微小的变化：\n$$ \\rho(x,t) = \\rho_0 + \\rho' (x,t) $$\n$$ u(x,t) = 0 + u' (x,t) $$\n$$ p(x,t) = p_0 + p' (x,t) $$\n其中带撇的量（$\\rho'$, $u'$, $p'$）是小扰动，即 $|\\rho'| \\ll \\rho_0$，$|u'| \\ll c$ 且 $|p'| \\ll p_0$。\n\n将这些代入连续性方程并展开：\n$$ \\frac{\\partial (\\rho_0 + \\rho')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial x} = 0 $$\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial x} = 0 $$\n忽略二阶项 $\\rho' u'$，我们得到线性化的连续性方程：\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0 \\quad (1) $$\n\n类似地，代入动量方程：\n$$ \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') (u')^2 + p_0 + p')}{\\partial x} = 0 $$\n$$ \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial t} + \\frac{\\partial (\\rho_0 (u')^2 + \\rho' (u')^2 + p_0 + p')}{\\partial x} = 0 $$\n忽略二阶项（$\\rho' u'$、$(u')^2$、$\\rho'(u')^2$），方程简化为：\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0 \\quad (2) $$\n\n问题指出过程是等熵的。这意味着在熵 $s$ 恒定的情况下，压力扰动 $p'$ 仅是密度扰动 $\\rho'$ 的函数。对于小扰动，我们可以使用在平衡态附近的泰勒展开来表示这种关系，只保留一阶项：\n$$ p' \\approx \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s \\rho' $$\n项 $\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$ 是声速的平方，我们将其定义为 $c^2$：\n$$ c^2 \\equiv \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s $$\n因此，$p' = c^2 \\rho'$。将此代入线性化的动量方程 (2)：\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + c^2 \\frac{\\partial \\rho'}{\\partial x} = 0 \\quad (3) $$\n\n我们现在有一个由两个一阶线性偏微分方程(1)和(3)组成的系统。我们可以将它们组合成一个二阶波动方程。将(1)对 $t$ 求导，将(3)对 $x$ 求导：\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_0 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0 $$\n$$ \\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} + c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} = 0 $$\n假设扰动足够光滑，可以交换求导顺序（$\\frac{\\partial^2 u'}{\\partial t \\partial x} = \\frac{\\partial^2 u'}{\\partial x \\partial t}$）。我们可以将第二个方程中的 $\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} = -c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2}$ 代入第一个方程：\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} = 0 $$\n这是一维波动方程，它描述了以速度 $c$ 传播的扰动。\n\n接下来，我们将 $c^2$ 与等熵体积模量 $K_s$ 联系起来。体积模量定义为物质抵抗均匀压缩的度量：\n$$ K = -V \\left(\\frac{\\partial p}{\\partial V}\\right) $$\n其中 $V$ 是体积。对于等熵过程，这变为：\n$$ K_s = -V \\left(\\frac{\\partial p}{\\partial V}\\right)_s $$\n密度 $\\rho$ 是单位体积 $V$ 的质量 $m$，所以 $\\rho = m/V$。对于固定的质量，$V = m/\\rho$，其微分关系为 $dV = -m/\\rho^2 \\, d\\rho$。将此代入求导的链式法则：\n$$ \\left(\\frac{\\partial p}{\\partial V}\\right)_s = \\frac{(\\partial p/\\partial \\rho)_s}{(\\partial V/\\partial \\rho)_s} = \\frac{(\\partial p/\\partial \\rho)_s}{-m/\\rho^2} $$\n将此代入 $K_s$ 的定义中：\n$$ K_s = - \\left(\\frac{m}{\\rho}\\right) \\left[ \\frac{(\\partial p/\\partial \\rho)_s}{-m/\\rho^2} \\right] = \\rho \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s $$\n由于我们定义了 $c^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$，我们有：\n$$ K_s = \\rho c^2 $$\n求解声速 $c$ 得到所需的表达式：\n$$ c = \\sqrt{\\frac{K_s}{\\rho}} $$\n\n第2部分：对水的数值计算\n\n给定水在 $T = 25\\,^\\circ\\mathrm{C}$ 和 $p = 0.1\\,\\mathrm{MPa}$ 时的值：\n- 等熵体积模量: $K_s = 2.20 \\times 10^{9}\\,\\mathrm{Pa}$\n- 质量密度: $\\rho = 997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n\n我们将这些值代入推导出的 $c$ 的表达式中：\n$$ c = \\sqrt{\\frac{2.20 \\times 10^9\\,\\mathrm{Pa}}{997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}} $$\n$$ c = \\sqrt{2206619.86...\\,\\mathrm{m^2}\\,\\mathrm{s}^{-2}} $$\n$$ c \\approx 1485.4695... \\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n根据要求将结果四舍五入到四位有效数字：\n$$ c \\approx 1485\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\n第3部分：关于不可压缩流动近似的分析讨论\n\n像水这样的液体在物理上是可压缩的。这一点由有限的等熵体积模量 $K_s$ 值以及因此产生的有限声速 $c$ 所证实。然而，在广泛的工程应用中，液体流动是使用不可压缩公式建模的，该公式假设密度恒定，从而速度场无散度，即 $\\nabla \\cdot \\mathbf{u} = 0$。这种明显矛盾的合理解释在于对质量守恒方程的量级分析。\n\n质量守恒方程的精确形式是：\n$$ \\frac{1}{\\rho}\\frac{D\\rho}{Dt} + \\nabla \\cdot \\mathbf{u} = 0 $$\n其中 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$ 是物质导数，表示跟随流体质点变化的变化率。不可压缩近似 $\\nabla \\cdot \\mathbf{u} = 0$ 在表示密度分数变化率的项 $\\frac{1}{\\rho}\\frac{D\\rho}{Dt}$ 可以忽略不计时是有效的。\n\n纯物质的密度是两个独立热力学性质的函数，通常是压力 $p$ 和温度 $T$，因此 $\\rho = \\rho(p, T)$。密度的物质导数是：\n$$ \\frac{D\\rho}{Dt} = \\left(\\frac{\\partial \\rho}{\\partial p}\\right)_T \\frac{Dp}{Dt} + \\left(\\frac{\\partial \\rho}{\\partial T}\\right)_p \\frac{DT}{Dt} $$\n我们可以用标准的材料响应函数来表示这些偏导数：等温压缩率 $\\beta_T = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_T$ 和体积热膨胀系数 $\\alpha = -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_p$。对于等熵过程，相关的性质是等熵压缩率 $\\beta_s = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_s$。对于液体，$\\beta_s$ 和 $\\beta_T$ 的值非常接近。为了与问题的第一部分保持一致，我们使用 $\\beta_s$，密度变化主要由压力和熵的变化驱动。速度散度的完整表达式为：\n$$ \\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = -\\beta_s \\frac{Dp}{Dt} - \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial s}\\right)_p \\frac{Ds}{Dt} $$\n我们来分析每一项的贡献：\n\n1.  **压力引起的（声学）压缩**：项 $-\\beta_s \\frac{Dp}{Dt}$ 量化了由压力变化引起的密度变化。在具有特征速度 $U$ 和特征长度 $L$ 的流动中，由惯性（动压）引起的压力变化量级为 $\\Delta p \\sim \\rho U^2$。压力的物质导数量级为 $\\frac{Dp}{Dt} \\sim \\frac{U \\Delta p}{L} \\sim \\frac{\\rho U^3}{L}$。由该效应引起的速度散度的量级为 $|\\nabla \\cdot \\mathbf{u}|_{p} \\sim \\beta_s \\frac{\\rho U^3}{L}$。我们已经证明 $\\beta_s = 1/K_s = 1/(\\rho c^2)$。因此：\n    $$ |\\nabla \\cdot \\mathbf{u}|_{p} \\sim \\frac{1}{\\rho c^2} \\frac{\\rho U^3}{L} = \\frac{U^3}{c^2 L} $$\n    要使这种效应可以忽略，其对速度散度的贡献必须远小于特征速度梯度（量级为 $U/L$）。该比值为：\n    $$ \\frac{|\\nabla \\cdot \\mathbf{u}|_{p}}{U/L} \\sim \\frac{U^3/(c^2 L)}{U/L} = \\frac{U^2}{c^2} = M^2 $$\n    其中 $M = U/c$ 是马赫数。对于液体，声速 $c$ 非常高（例如，水的声速约为 $c \\approx 1485\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$）。对于典型的工程流动，其速度比如 $U \\ll 30\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，马赫数非常小（$M \\ll 0.02$）。因此，马赫数的平方极小（$M^2 \\ll 0.0004$），这意味着由动压变化引起的密度变化可以忽略不计。\n\n2.  **温度引起的（热）膨胀**：散度方程中的第二项与熵的变化有关，或者在 $(p, T)$ 坐标系中与温度的变化有关。项 $-\\alpha \\frac{DT}{Dt}$ 表示由于加热、冷却或粘性耗散引起的密度变化。不可压缩性假设要求 $|\\alpha \\frac{DT}{Dt}|$ 与特征速度梯度 $U/L$ 相比要小。这等同于说，由热效应引起的总密度变化（其量级为 $\\alpha \\Delta T$）必须很小，即 $|\\alpha \\Delta T| \\ll 1$。对于水，在 $T = 20\\,^\\circ\\mathrm{C}$ 时，$\\alpha \\approx 2.1 \\times 10^{-4}\\,\\mathrm{K}^{-1}$。对于温度变化为 $\\Delta T = 10\\,\\mathrm{K}$ 的流动，密度变化约为 $0.21\\%$。虽然这个值很小，但在浮力驱动的流动（自然对流）中可能很重要，因为这些微小的密度差异驱动着整个流动。在这种情况下，通常采用布辛涅斯克近似（Boussinesq approximation），该近似将密度视为常数，除了在重力体力项中。\n\n总而言之，液体被视为不可压缩，并非因为它在物理上是如此，而是因为在许多工程流动中遇到的压力和温度变化不足以引起显著的密度变化。主要条件是马赫数非常低（$M \\ll 1$），由于液体的高声速，这个条件几乎总是满足的。次要条件是温度变化适中，使得热膨胀效应也可以忽略不计。",
            "answer": "$$\\boxed{1485}$$"
        },
        {
            "introduction": "在理解了不可压缩近似的适用条件后，我们接下来将量化该近似所引入的物理误差。本练习采用渐近分析方法，估算在忽略可压缩效应时，气体流动中的静温计算会产生多大的误差。通过这个计算，您将具体地衡量在给定马赫数 $M$ 下，该简化模型偏离真实物理情况的程度，从而深化对模型精度的理解。",
            "id": "3940527",
            "problem": "一股性质恒定的量热完全气体（空气）的稳定、无粘、绝热流动，以马赫数 $M$ 均匀地流过一个没有外部热量添加且体力可忽略的区域。在不可压近似中，由于能量平衡中忽略了可压缩性效应，静态温度被建模为等于参考滞止温度 $T_0$。请使用关于 $M=0$ 的渐近分析，推导由可压缩能量方程公式所隐含的静态温度的主阶小 $M$ 修正项，并量化不可压近似在静态温度场中引入的相应误差。\n\n取空气为量热完全气体，比热比 $\\gamma=1.4$，并考虑一个马赫数 $M=0.3$、滞止温度 $T_0=300\\,\\mathrm{K}$ 的流动。使用您的渐近估计，计算在 $M=0.3$ 时由不可压近似引起的静态温度误差的大小。将您的答案四舍五入到三位有效数字，并以 $\\mathrm{K}$ 为单位表示。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，提法恰当，客观，并包含推导出唯一且有意义解所需的所有必要信息。\n\n该问题要求对量热完全气体的稳定、无粘、绝热流动中的静态温度进行分析。连接滞止温度 $T_0$、静态温度 $T$ 和马赫数 $M$ 的基本关系由稳流能量方程给出。对于量热完全气体，此关系为：\n$$\n\\frac{T_0}{T} = 1 + \\frac{\\gamma - 1}{2} M^2\n$$\n其中 $\\gamma$ 是比热比。\n\n为了分析小马赫数（$M \\to 0$）下静态温度的行为，我们首先将 $T$ 表示为 $T_0$ 和 $M$ 的函数：\n$$\nT = T_0 \\left( 1 + \\frac{\\gamma - 1}{2} M^2 \\right)^{-1}\n$$\n问题要求进行关于 $M=0$ 的渐近分析。这通过对小 $M$ 的 $T$ 表达式进行泰勒级数展开来实现。我们使用广义二项式定理，该定理指出，对于任意实数 $n$ 和 $|x|1$：\n$$\n(1+x)^{n} = 1 + nx + \\frac{n(n-1)}{2!}x^2 + \\dots\n$$\n在我们的例子中，变量是 $x = \\frac{\\gamma - 1}{2} M^2$，指数是 $n = -1$。由于 $M$ 很小，$x$ 也很小。展开式为：\n$$\n\\left( 1 + \\frac{\\gamma - 1}{2} M^2 \\right)^{-1} = 1 - \\frac{\\gamma - 1}{2} M^2 + \\left( \\frac{\\gamma - 1}{2} M^2 \\right)^2 - \\dots\n$$\n将此代回 $T$ 的表达式，得到静态温度的渐近展开式：\n$$\nT = T_0 \\left( 1 - \\frac{\\gamma - 1}{2} M^2 + O(M^4) \\right) = T_0 - T_0 \\frac{\\gamma - 1}{2} M^2 + O(M^4)\n$$\n问题陈述中提到，“不可压近似”将静态温度建模为 $T_{inc} = T_0$。这对应于渐近展开中的零阶项。对静态温度的主阶小 $M$ 修正是级数中下一个非零项，其阶数为 $M^2$：\n$$\n\\text{Leading-order correction} = -T_0 \\frac{\\gamma - 1}{2} M^2\n$$\n此修正项量化了在小的非零马赫数下，由于能量方程所捕捉到的可压缩性效应，静态温度偏离滞止温度的程度。\n\n由不可压近似（$T \\approx T_0$）引入的误差 $\\Delta T$ 是真实静态温度 $T$ 与近似值 $T_0$ 之间的差值。使用我们对 $T$ 的渐近估计，主阶误差为：\n$$\n\\Delta T = T - T_0 \\approx \\left( T_0 - T_0 \\frac{\\gamma - 1}{2} M^2 \\right) - T_0 = -T_0 \\frac{\\gamma - 1}{2} M^2\n$$\n问题要求计算此误差的大小，即 $|\\Delta T|$。\n$$\n|\\Delta T| \\approx \\left| -T_0 \\frac{\\gamma - 1}{2} M^2 \\right| = T_0 \\frac{\\gamma - 1}{2} M^2\n$$\n这是误差大小的渐近估计。\n\n最后，我们根据给定的参数计算此误差大小的数值：空气流动，比热比 $\\gamma = 1.4$，马赫数 $M=0.3$，滞止温度 $T_0=300\\,\\mathrm{K}$。\n$$\n|\\Delta T| \\approx (300\\,\\mathrm{K}) \\frac{1.4 - 1}{2} (0.3)^2\n$$\n$$\n|\\Delta T| \\approx 300 \\times \\frac{0.4}{2} \\times 0.09\n$$\n$$\n|\\Delta T| \\approx 300 \\times 0.2 \\times 0.09\n$$\n$$\n|\\Delta T| \\approx 60 \\times 0.09 = 5.4\n$$\n问题要求将答案四舍五入到三位有效数字。因此，误差的大小为 $5.40\\,\\mathrm{K}$。",
            "answer": "$$\n\\boxed{5.40}\n$$"
        },
        {
            "introduction": "在可压缩与不可压缩公式之间的选择，往往取决于实际的计算资源限制。最后的这个实践将深入探讨计算效率这一关键的权衡因素。通过比较两种公式下显式求解器所允许的最大稳定时间步长和总体计算吞吐量，您将揭示为何在低速流动中，工程师们倾向于使用专门的不可压缩求解器，即便其单步计算更为复杂。",
            "id": "3940215",
            "problem": "考虑一个在三维空间中的加热射流，其耦合的动量和能量方程的可压缩和不可压缩格式的显式时间积分，该射流在间距为 $\\Delta x$、$\\Delta y$、$\\Delta z$ 的均匀笛卡尔网格上进行离散化。射流流体是理想气体，其比热比 $\\gamma$、特定气体常数 $R$ 和热扩散系数 $\\alpha$ 均为常数。设平均速度分量为 $u$、$v$、$w$，绝对温度为 $T$。声速定义为 $a = \\sqrt{\\gamma R T}$。假设一个显式格式，其稳定性由双曲（平流和声学）Courant 约束和抛物线（扩散）Fourier 约束控制。为双曲项定义一个用户选择的 Courant 数 $C_{\\mathrm{CFL}}$，并使用典型的显式扩散稳定性界限。\n\n从守恒定律及其特征速度出发，将可压缩求解器的最大稳定时间步长表述为双曲界限和扩散界限的最小值。对于双曲界限，使用方向平流速度之和以及多维声学贡献：\n$$\nS_{\\mathrm{conv}} = \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}, \\quad\nS_{\\mathrm{acoust}} = a \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}},\n$$\n和\n$$\n\\Delta t_{\\mathrm{hyper,comp}} = \\frac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}} + S_{\\mathrm{acoust}}}.\n$$\n对于显式扩散约束，使用二阶中心离散的多维稳定性界限：\n$$\n\\Delta t_{\\mathrm{diff}} = \\frac{1}{2 \\alpha \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)}.\n$$\n因此，可压缩求解器的时间步长为\n$$\n\\Delta t_{\\mathrm{comp}} = \\min\\left(\\Delta t_{\\mathrm{hyper,comp}}, \\Delta t_{\\mathrm{diff}}\\right).\n$$\n\n对于不可压缩求解器，假设压力投影法消除了声波；因此，双曲界限不包括声学项。使用\n$$\n\\Delta t_{\\mathrm{hyper,inc}} =\n\\begin{cases}\n\\dfrac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}}},  \\text{如果 } S_{\\mathrm{conv}}  0, \\\\\n+\\infty,  \\text{如果 } S_{\\mathrm{conv}} = 0,\n\\end{cases}\n$$\n和\n$$\n\\Delta t_{\\mathrm{inc}} = \\min\\left(\\Delta t_{\\mathrm{hyper,inc}}, \\Delta t_{\\mathrm{diff}}\\right).\n$$\n\n为量化效率权衡，分别定义可压缩和不可压缩求解器每时间步的计算成本（单位为秒）$c_{\\mathrm{comp}}$ 和 $c_{\\mathrm{inc}}$。将每个求解器每单位计算时间所推进的物理时间（吞吐量）定义为\n$$\n\\Theta_{\\mathrm{comp}} = \\frac{\\Delta t_{\\mathrm{comp}}}{c_{\\mathrm{comp}}}, \\quad\n\\Theta_{\\mathrm{inc}} = \\frac{\\Delta t_{\\mathrm{inc}}}{c_{\\mathrm{inc}}},\n$$\n并定义效率比\n$$\n\\eta = \\frac{\\Theta_{\\mathrm{inc}}}{\\Theta_{\\mathrm{comp}}},\n$$\n该比值为无量纲。\n\n实现一个程序，针对以下测试套件，计算每个案例的 $\\Delta t_{\\mathrm{comp}}$ 和 $\\Delta t_{\\mathrm{inc}}$（单位为秒），以及 $\\eta$（一个无量纲浮点数）。所有案例均使用 $C_{\\mathrm{CFL}} = 0.5$。所有输入必须使用下面指定的单位进行解释，所有时间步长必须以秒表示。角度单位不适用。不使用百分比；所有比率均为纯小数。\n\n测试套件（每个元组列出 $(\\Delta x,\\Delta y,\\Delta z)$ 单位为米，$(u,v,w)$ 单位为 $\\mathrm{m/s}$，$T$ 单位为 $\\mathrm{K}$，$\\gamma$ 无量纲，$R$ 单位为 $\\mathrm{J/(kg\\cdot K)}$，$\\alpha$ 单位为 $\\mathrm{m^2/s}$，$c_{\\mathrm{comp}}$ 单位为秒，$c_{\\mathrm{inc}}$ 单位为秒）：\n- 案例 $1$（典型的亚音速、均匀网格、环境射流）：$(\\Delta x,\\Delta y,\\Delta z) = (1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})$, $(u,v,w) = (80,\\,0,\\,0)$, $T = 300$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 2.1\\times 10^{-5}$, $c_{\\mathrm{comp}} = 6.0\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.2\\times 10^{-2}$。\n- 案例 $2$（加热射流、更精细的网格）：$(\\Delta x,\\Delta y,\\Delta z) = (5.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4})$, $(u,v,w) = (100,\\,10,\\,0)$, $T = 1200$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 8.0\\times 10^{-5}$, $c_{\\mathrm{comp}} = 8.0\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.5\\times 10^{-2}$。\n- 案例 $3$（各向异性网格、中等加热）：$(\\Delta x,\\Delta y,\\Delta z) = (2.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4})$, $(u,v,w) = (10,\\,5,\\,0)$, $T = 800$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 5.0\\times 10^{-5}$, $c_{\\mathrm{comp}} = 7.0\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.3\\times 10^{-2}$。\n- 案例 $4$（极低对流速度、强加热）：$(\\Delta x,\\Delta y,\\Delta z) = (1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})$, $(u,v,w) = (0.5,\\,0,\\,0)$, $T = 1500$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 1.2\\times 10^{-4}$, $c_{\\mathrm{comp}} = 6.5\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.4\\times 10^{-2}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。对于每个案例，按顺序追加 $\\Delta t_{\\mathrm{comp}}$（单位为秒）、$\\Delta t_{\\mathrm{inc}}$（单位为秒）和 $\\eta$（无量纲）。因此，对于 $N=4$ 个案例，输出必须是：\n$$\n[\\Delta t_{\\mathrm{comp}}^{(1)},\\Delta t_{\\mathrm{inc}}^{(1)},\\eta^{(1)},\\Delta t_{\\mathrm{comp}}^{(2)},\\Delta t_{\\mathrm{inc}}^{(2)},\\eta^{(2)},\\Delta t_{\\mathrm{comp}}^{(3)},\\Delta t_{\\mathrm{inc}}^{(3)},\\eta^{(3)},\\Delta t_{\\mathrm{comp}}^{(4)},\\Delta t_{\\mathrm{inc}}^{(4)},\\eta^{(4)}].\n$$\n所有返回的时间步长必须以秒为单位，所有比率必须是无量纲小数。",
            "solution": "该问题已经过验证，被认为是科学上合理、适定且自洽的。所有提供的数据、常数和公式均符合计算流体动力学（CFD）和数值分析中的既定原理。任务是在指定条件下，计算和比较可压缩和不可压缩数值求解器的最大稳定时间步长和计算效率。\n\n问题的核心在于应用于流体动力学方程的显式时间推进格式的稳定性约束。最大允许时间步长 $\\Delta t$ 受限于正在求解的物理现象。这些约束通常分为两类：与波的传播（平流和声学）相关的双曲型约束，以及与扩散过程（粘性和热传导）相关的抛物线型约束。\n\n首先，我们定义几个两种求解器格式所共有的中间量。用于多维效应的网格相关项是网格间距平方倒数之和：\n$$\nD_2 = \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\n$$\n特征平流速度之和表示由于流体流过网格单元而导致信息传播的速率，由下式给出：\n$$\nS_{\\mathrm{conv}} = \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}\n$$\n理想气体中的声速 $a$ 为：\n$$\na = \\sqrt{\\gamma R T}\n$$\n\n**可压缩求解器时间步长，$\\Delta t_{\\mathrm{comp}}$**\n\n对于可压缩求解器，时间步长必须足够小，以解析流体运动（平流）和声波的传播（声学）。问题定义了一个组合的双曲稳定性限制。多维空间中声波的特征速度由 $S_{\\mathrm{acoust}}$ 给出：\n$$\nS_{\\mathrm{acoust}} = a \\sqrt{D_2} = a \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}\n$$\n一个保守的双曲时间步长约束，通常称为 Courant-Friedrichs-Lewy (CFL) 条件，通过将平流速度和声学速度相加来构建：\n$$\n\\Delta t_{\\mathrm{hyper,comp}} = \\frac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}} + S_{\\mathrm{acoust}}}\n$$\n其中 $C_{\\mathrm{CFL}}$ 是 Courant 数，给定为 $0.5$。\n\n除了双曲约束之外，热扩散的显式处理还施加了一个抛物线稳定性约束，通常称为 Fourier 条件。对于空间上的标准二阶中心差分格式，该约束为：\n$$\n\\Delta t_{\\mathrm{diff}} = \\frac{1}{2 \\alpha D_2} = \\frac{1}{2 \\alpha \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)}\n$$\n可压缩求解器的总体稳定时间步长是这两个约束中最严格的（即最小值）：\n$$\n\\Delta t_{\\mathrm{comp}} = \\min\\left(\\Delta t_{\\mathrm{hyper,comp}}, \\Delta t_{\\mathrm{diff}}\\right)\n$$\n\n**不可压缩求解器时间步长，$\\Delta t_{\\mathrm{inc}}$**\n\n不可压缩求解器是在流动马赫数很低，因此声速可被视为无穷大的假设下建立的。像压力投影格式这样的数值方法旨在滤除声波。因此，基于声学的时间步长约束被移除。双曲约束仅由平流速度确定：\n$$\n\\Delta t_{\\mathrm{hyper,inc}} =\n\\begin{cases}\n\\dfrac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}}},  \\text{如果 } S_{\\mathrm{conv}}  0 \\\\\n+\\infty,  \\text{如果 } S_{\\mathrm{conv}} = 0\n\\end{cases}\n$$\n扩散稳定性约束 $\\Delta t_{\\mathrm{diff}}$ 保持不变，因为它取决于热属性和网格间距，而不是声学模型。因此，不可压缩求解器的总稳定时间步长为：\n$$\n\\Delta t_{\\mathrm{inc}} = \\min\\left(\\Delta t_{\\mathrm{hyper,inc}}, \\Delta t_{\\mathrm{diff}}\\right)\n$$\n\n**效率比较，$\\eta$**\n\n虽然不可压缩求解器通常允许更大的时间步长（$\\Delta t_{\\mathrm{inc}} \\geq \\Delta t_{\\mathrm{comp}}$），但由于需要求解一个全局的压力泊松方程，每一步的计算成本可能更高（通常 $c_{\\mathrm{inc}}  c_{\\mathrm{comp}}$）。为了比较总体效率，我们评估每单位计算时间所推进的物理时间，定义为吞吐量 $\\Theta$。\n$$\n\\Theta_{\\mathrm{comp}} = \\frac{\\Delta t_{\\mathrm{comp}}}{c_{\\mathrm{comp}}}, \\quad \\Theta_{\\mathrm{inc}} = \\frac{\\Delta t_{\\mathrm{inc}}}{c_{\\mathrm{inc}}}\n$$\n效率比 $\\eta$ 比较了不可压缩求解器与可压缩求解器的吞吐量：\n$$\n\\eta = \\frac{\\Theta_{\\mathrm{inc}}}{\\Theta_{\\mathrm{comp}}} = \\frac{\\Delta t_{\\mathrm{inc}} / c_{\\mathrm{inc}}}{\\Delta t_{\\mathrm{comp}} / c_{\\mathrm{comp}}} = \\frac{\\Delta t_{\\mathrm{inc}}}{\\Delta t_{\\mathrm{comp}}} \\frac{c_{\\mathrm{comp}}}{c_{\\mathrm{inc}}}\n$$\n效率比 $\\eta  1$ 表明，对于给定的流动条件，不可压缩格式在计算上更高效，在相同的计算量下能将模拟在物理时间上推进得更远。\n\n下面的程序针对问题陈述中提供的每个测试案例实现了这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates time steps and efficiency for compressible and incompressible solvers\n    based on provided stability criteria for a series of test cases.\n    \"\"\"\n\n    # Global Courant number for hyperbolic stability constraints\n    C_CFL = 0.5\n\n    # Test Suite (each tuple lists (dx,dy,dz), (u,v,w), T, gamma, R, alpha, c_comp, c_inc)\n    test_cases = [\n        # Case 1 (typical subsonic, uniform grid, ambient jet)\n        ((1.0e-3, 1.0e-3, 1.0e-3), (80.0, 0.0, 0.0), 300.0, 1.4, 287.0, 2.1e-5, 6.0e-3, 1.2e-2),\n        # Case 2 (heated jet, finer grid)\n        ((5.0e-4, 5.0e-4, 5.0e-4), (100.0, 10.0, 0.0), 1200.0, 1.4, 287.0, 8.0e-5, 8.0e-3, 1.5e-2),\n        # Case 3 (anisotropic grid, moderate heating)\n        ((2.0e-4, 1.0e-3, 5.0e-4), (10.0, 5.0, 0.0), 800.0, 1.4, 287.0, 5.0e-5, 7.0e-3, 1.3e-2),\n        # Case 4 (very low convective speed, strong heating)\n        ((1.0e-3, 1.0e-3, 1.0e-3), (0.5, 0.0, 0.0), 1500.0, 1.4, 287.0, 1.2e-4, 6.5e-3, 1.4e-2),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta, vel, T, gamma, R, alpha, c_comp, c_inc = case\n        dx, dy, dz = delta\n        u, v, w = vel\n\n        # --- Intermediate Calculations ---\n        \n        # Acoustic speed: a = sqrt(gamma * R * T)\n        a = np.sqrt(gamma * R * T)\n\n        # Sum of inverse squared grid spacings for diffusion and acoustic terms:\n        # D2 = 1/dx^2 + 1/dy^2 + 1/dz^2\n        D2 = (1.0 / dx**2) + (1.0 / dy**2) + (1.0 / dz**2)\n        \n        # Sum of convective speeds: S_conv = |u|/dx + |v|/dy + |w|/dz\n        S_conv = (np.abs(u) / dx) + (np.abs(v) / dy) + (np.abs(w) / dz)\n        \n        # --- Common Diffusive Time Step ---\n        \n        # dt_diff = 1 / (2 * alpha * D2)\n        dt_diff = 1.0 / (2.0 * alpha * D2)\n\n        # --- Compressible Solver Time Step ---\n        \n        # Acoustic speed contribution: S_acoust = a * sqrt(D2)\n        S_acoust = a * np.sqrt(D2)\n        \n        # Hyperbolic time step for compressible solver\n        dt_hyper_comp = C_CFL / (S_conv + S_acoust)\n        \n        # Total compressible time step\n        dt_comp = min(dt_hyper_comp, dt_diff)\n\n        # --- Incompressible Solver Time Step ---\n        \n        # Hyperbolic time step for incompressible solver\n        if S_conv > 0:\n            dt_hyper_inc = C_CFL / S_conv\n        else:\n            dt_hyper_inc = np.inf\n            \n        # Total incompressible time step\n        dt_inc = min(dt_hyper_inc, dt_diff)\n        \n        # --- Efficiency Ratio ---\n        \n        # Throughput ratio: eta = (dt_inc / c_inc) / (dt_comp / c_comp)\n        # Avoid division by zero if dt_comp is zero (though unlikely in these cases)\n        if dt_comp > 0:\n            eta = (dt_inc / c_inc) / (dt_comp / c_comp)\n        else:\n            eta = np.inf # Or handle as a special case if needed.\n\n        # Append results for this case to the list\n        results.extend([dt_comp, dt_inc, eta])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}