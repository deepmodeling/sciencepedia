{
    "hands_on_practices": [
        {
            "introduction": "在对包含气体的封闭腔体进行传热建模时，关键的第一步是确定气体本身是否参与辐射交换。本练习将引导您使用光学厚度，一个无量纲参数，来做出这一关键的建模决策。这个决策将决定您是否可以将问题简化为表面间的辐射换热，还是必须求解更为复杂的气体辐射传输方程 。",
            "id": "3972583",
            "problem": "一个边长为 $L$ 的密封立方体外壳，内部含有处于总压为 $p$ 和高温下的静态混合气体。所有六个壁面均为等温、漫-灰表面。该混合气体由摩尔分数为 $y_{\\mathrm{H_2O}}$ 的水蒸气、摩尔分数为 $y_{\\mathrm{CO_2}}$ 的二氧化碳和摩尔分数为 $y_{\\mathrm{N_2}}=1-y_{\\mathrm{H_2O}}-y_{\\mathrm{CO_2}}$ 的氮气组成。假设氮气不参与辐射，散射可忽略不计，且气体是静止的，因此不存在宏观运动。您必须决定如何在气体能量方程中模拟辐射传热：是作为一个体积散度项，还是仅通过壁面边界条件。\n\n仅使用以下基本依据：(i) 固定控制体积的能量守恒，它引入了一个辐射热通量项，当介质参与辐射时，其散度表现为体积源/汇；(ii) 在灰体、吸收-发射介质中光学厚度的定义，$\\tau = \\kappa L$，其中 $\\kappa$ 是一个合适的平均吸收系数；(iii) 平均自由程的定义 $\\ell = 1/\\kappa$；以及 (iv) 对于参与介质壁面处的辐射传输方程 (RTE)，使用漫-灰边界条件。\n\n在给定温度和压力下，混合物的物性数据以物种在 $p=1$ 大气压下单位摩尔分数的普朗克平均吸收系数给出：$\\bar{\\kappa}_{\\mathrm{H_2O}}^{*} = 2.5$ 每米 和 $\\bar{\\kappa}_{\\mathrm{CO_2}}^{*} = 1.2$ 每米。使用线性混合近似 $\\bar{\\kappa} \\approx y_{\\mathrm{H_2O}} \\bar{\\kappa}_{\\mathrm{H_2O}}^{*} + y_{\\mathrm{CO_2}} \\bar{\\kappa}_{\\mathrm{CO_2}}^{*}$ 计算混合物的灰体吸收系数。\n\n给定 $L=2.0$ 米，$p=1$ 大气压，$y_{\\mathrm{H_2O}}=0.30$ 和 $y_{\\mathrm{CO_2}}=0.10$，估算光学厚度 $\\tau = L/\\ell$，并决定哪种辐射建模方法适合外壳内的气体。选择唯一的最佳选项。\n\nA. 仅通过壁面间的表面对表面边界条件来模拟辐射（将气体视为非参与介质），因为在所述条件下 $L/\\ell \\ll 1$。\n\nB. 在气体能量方程中包含体积辐射项 $-\\nabla \\cdot \\boldsymbol{q}_{r}$（将气体视为参与介质），并为气-壁交换施加漫-灰辐射边界条件，因为在所述条件下 $L/\\ell \\gtrsim 1$。\n\nC. 在气体能量方程和壁面处完全忽略辐射，因为在静态气体中，无论 $L/\\ell$ 如何，传导都占主导地位。\n\nD. 在气体中包含体积项 $-\\nabla \\cdot \\boldsymbol{q}_{r}$，并额外增加一个忽略气体的、壁面间的独立表面对表面辐射网络，以便在 $L/\\ell \\sim 1$ 时采取保守处理。",
            "solution": "从包含静态、吸收-发射介质的固定控制体积的能量守恒开始。对于静止气体，能量方程可以写为\n$$\n\\rho c_{p} \\frac{\\partial T}{\\partial t}\n= \\nabla \\cdot \\left( k \\nabla T \\right) - \\nabla \\cdot \\boldsymbol{q}_{r} + \\dot{\\omega},\n$$\n其中 $\\rho$ 是密度，$c_{p}$ 是定压比热，$T$ 是温度，$k$ 是导热系数，$\\boldsymbol{q}_{r}$ 是辐射热通量矢量，$\\dot{\\omega}$ 表示除辐射外的任何体积源。仅当介质参与辐射（吸收-发射）时，项 $-\\nabla \\cdot \\boldsymbol{q}_{r}$ 才作为体积贡献出现。如果介质不参与辐射（对热辐射是透明的），则在主体区域 $-\\nabla \\cdot \\boldsymbol{q}_{r} = 0$，辐射通过确定壁面净辐射交换的边界条件来考虑。\n\n将气体视为参与介质的决定由光学厚度指导。对于一个散射可忽略的灰体、吸收-发射介质，其在特征路径长度 $L$ 上的光学厚度为\n$$\n\\tau = \\kappa L,\n$$\n其中 $\\kappa$ 是一个平均吸收系数。平均自由程定义为\n$$\n\\ell = \\frac{1}{\\kappa},\n$$\n所以\n$$\n\\frac{L}{\\ell} = \\kappa L = \\tau.\n$$\n当 $\\tau \\ll 1$ 时，介质是光学薄的，辐射场由表面交换主导；在此极限下，仅通过表面边界条件来模拟辐射是合适的。当 $\\tau \\gtrsim 1$ 时，介质在光学上是显著的，必须通过 $-\\nabla \\cdot \\boldsymbol{q}_{r}$ 包含体积辐射传输，并求解受漫-灰壁面边界条件约束的辐射传输方程 (RTE)。\n\n使用提供的线性混合近似计算混合物的吸收系数。已知 $y_{\\mathrm{H_2O}}=0.30$，$y_{\\mathrm{CO_2}}=0.10$，$\\bar{\\kappa}_{\\mathrm{H_2O}}^{*} = 2.5$ 每米，以及 $\\bar{\\kappa}_{\\mathrm{CO_2}}^{*} = 1.2$ 每米，\n$$\n\\bar{\\kappa} \\approx y_{\\mathrm{H_2O}} \\bar{\\kappa}_{\\mathrm{H_2O}}^{*} + y_{\\mathrm{CO_2}} \\bar{\\kappa}_{\\mathrm{CO_2}}^{*}\n= \\left( 0.30 \\right)\\left( 2.5 \\right) + \\left( 0.10 \\right)\\left( 1.2 \\right)\n= 0.75 + 0.12\n= 0.87 \\ \\text{每米}.\n$$\n则平均自由程为\n$$\n\\ell = \\frac{1}{\\bar{\\kappa}} = \\frac{1}{0.87} \\ \\text{米} \\approx 1.149 \\ \\text{米},\n$$\n而外壳边长上的光学厚度为\n$$\n\\tau = \\frac{L}{\\ell} = \\left( 2.0 \\right)\\left( 0.87 \\right) \\approx 1.74.\n$$\n因为 $\\tau \\approx 1.74$，介质的光学厚度足够大，气体内部的发射和吸收会显著改变辐射场和能量平衡。因此，在气体能量方程中，辐射贡献必须被视为一个体积项 $-\\nabla \\cdot \\boldsymbol{q}_{r}$。必须在气体中求解辐射传输方程 (RTE)，并在等温壁面上使用漫-灰边界条件来解释气-壁交换。仅通过表面对表面的壁面交换来模拟辐射会忽略气体的参与，而将体积项与一个忽略气体的独立表面对表面壁面网络相结合会重复计算辐射传输路径。\n\n逐项分析：\n\nA. 该选项断言 $L/\\ell \\ll 1$ 并建议将气体视为非参与介质，仅在壁面考虑辐射。我们的估算得出 $\\tau = L/\\ell \\approx 1.74$，这不满足 $\\ll 1$。前提是错误的，推荐的建模方法会忽略显著的体积吸收和发射。结论 — 不正确。\n\nB. 该选项规定在气体能量方程中包含体积辐射项 $-\\nabla \\cdot \\boldsymbol{q}_{r}$，并使用适当的漫-灰气-壁辐射边界条件，理由是 $L/\\ell \\gtrsim 1$。我们的计算得出 $\\tau \\approx 1.74$，满足了需要进行体积处理的参与介质的条件。结论 — 正确。\n\nC. 该选项建议完全忽略辐射，理由是在静态气体中，无论 $L/\\ell$ 如何，传导都占主导地位。宏观运动的存在与否不是判断辐射重要性的标准；相反，光学厚度和温度水平控制着辐射的参与。对于 $\\tau \\approx 1.74$ 的热气体，忽略辐射会产生重大误差。结论 — 不正确。\n\nD. 该选项建议在气体中同时包含一个体积项，并额外增加一个忽略气体的、独立的表面对表面壁面网络。这样做会重复计算辐射交换，因为 RTE 的壁面边界条件已经捕捉了气-壁辐射相互作用，而忽略气体的表面对表面交换与参与介质不相容。结论 — 不正确。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "对于包含非参与性介质的封闭腔体，辐射度法是计算表面间辐射换热的强大工具。本练习提供了组装和求解表面辐射度线性系统的实践机会，这是计算辐射学中的一项基本任务。您还将通过评估系统的条件数来探索其数值稳定性，这是确保复杂几何形状模拟准确性的关键技能 。",
            "id": "3972590",
            "problem": "你需要为一封闭的漫-灰腔体建立并求解辐射度（radiosity）的腔体辐射线性系统，然后将结果与表面的对流和传导耦合。你的推导和算法必须从第一性原理出发：Stefan–Boltzmann 定律、辐射度和辐照度（irradiation）的定义，以及封闭腔体的角系数（view factor）性质。你还必须评估所得线性系统的数值条件，并应用一种缩放策略来改善条件，报告条件数的变化。最后，计算导出的热通量和稳态下传导所需的背面温度。\n\n使用以下基本陈述来推导你的方法：\n- 单位面积表面发射的辐射能由 Stefan–Boltzmann 定律给出：对于发射率为 $\\epsilon_i$、温度为 $T_i$ 的漫-灰表面，发射的能量为 $\\epsilon_i \\sigma T_i^4$，其中 $\\sigma$ 是 Stefan–Boltzmann 常数。\n- 表面 $i$ 的辐射度 $J_i$ 是离开该表面的单位面积总辐射能，而辐照度 $G_i$ 是入射到该表面的单位面积总辐射能。\n- 在一个由 $N$ 个表面组成的封闭腔体中，其角系数矩阵为 $F \\in \\mathbb{R}^{N \\times N}$，角系数满足对每个 $i$ 都有 $\\sum_{j=1}^N F_{ij} = 1$。假设每个表面的面积为 $A_i = 1\\,\\mathrm{m}^2$，因此互易关系简化为 $F_{ij} = F_{ji}$。\n\n基于这些基础，推导出关于已知温度 $\\mathbf{T}$、发射率 $\\boldsymbol{\\epsilon}$ 和角系数矩阵 $F$ 的辐射度向量 $\\mathbf{J} \\in \\mathbb{R}^N$ 的线性系统。然后：\n1. 根据你的推导组建矩阵和右侧向量，并求解 $\\mathbf{J}$。\n2. 计算辐照度 $\\mathbf{G}$ 和净辐射热通量向量 $\\mathbf{q}^{\\mathrm{rad}}$（其分量为 $q^{\\mathrm{rad}}_i$）。\n3. 对每个表面，计算对流热通量 $q^{\\mathrm{conv}}_i = h_i (T_i - T^{\\infty}_i)$，其中 $h_i$ 是对流传热系数，$T^{\\infty}_i$ 是与表面 $i$ 相邻的环境流体温度。\n4. 假设稳态一维热传导通过厚度为 $L_i$、导热系数为 $k_i$ 的壁面，计算所需的背面固体温度 $T^{\\mathrm{back}}_i$，使得传导热量等于表面向外的对流和辐射热量之和：$q^{\\mathrm{cond}}_i = \\dfrac{k_i}{L_i} \\left(T^{\\mathrm{back}}_i - T_i\\right)$，并强制 $q^{\\mathrm{cond}}_i = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$ 以求解 $T^{\\mathrm{back}}_i$。\n5. 评估能量守恒残差 $r = \\left|\\sum_{i=1}^N q^{\\mathrm{rad}}_i\\right|$，在一个封闭腔体中，该值应接近于零。\n6. 计算未缩放线性系统矩阵和行缩放矩阵的 $2$-范数条件数 $\\kappa_2$。行缩放矩阵通过将每个方程除以其所在行的绝对值之和得到（右侧向量也需进行一致的缩放）。报告这两个条件数。\n\n物理单位和报告要求：\n- 以 $\\mathrm{W/m^2}$ 为单位报告辐射度 $J_i$ 和净辐射热通量 $q^{\\mathrm{rad}}_i$。\n- 以 $\\mathrm{K}$ 为单位报告所需的背面温度 $T^{\\mathrm{back}}_i$。\n- 以无单位浮点数形式报告条件数。\n- 不涉及角度；无需角度单位。\n- 所有数值输出均以普通小数形式表示（非百分比）。\n\n测试套件：\n提供三个测试案例的结果。在每个案例中，将所有表面面积视为 $1\\,\\mathrm{m}^2$。\n\n案例 1（三表面，中等发射率，混合凹度）：\n- $N = 3$,\n- $\\boldsymbol{\\epsilon} = [0.8,\\,0.6,\\,0.9]$,\n- $\\mathbf{T} = [800,\\,500,\\,300]\\,\\mathrm{K}$,\n- $F = \\begin{bmatrix} 0.0  0.6  0.4 \\\\ 0.6  0.0  0.4 \\\\ 0.4  0.4  0.2 \\end{bmatrix}$,\n- $\\mathbf{h} = [15,\\,10,\\,8]\\,\\mathrm{W/(m^2\\,K)}$,\n- $\\mathbf{T}^{\\infty} = [300,\\,300,\\,300]\\,\\mathrm{K}$,\n- $\\mathbf{k} = [16,\\,40,\\,100]\\,\\mathrm{W/(m\\,K)}$,\n- $\\mathbf{L} = [0.02,\\,0.05,\\,0.10]\\,\\mathrm{m}$。\n\n案例 2（双表面，高反射率，等温）：\n- $N = 2$,\n- $\\boldsymbol{\\epsilon} = [0.02,\\,0.02]$,\n- $\\mathbf{T} = [300,\\,300]\\,\\mathrm{K}$,\n- $F = \\begin{bmatrix} 0.0  1.0 \\\\ 1.0  0.0 \\end{bmatrix}$,\n- $\\mathbf{h} = [5,\\,5]\\,\\mathrm{W/(m^2\\,K)}$,\n- $\\mathbf{T}^{\\infty} = [300,\\,300]\\,\\mathrm{K}$,\n- $\\mathbf{k} = [200,\\,200]\\,\\mathrm{W/(m\\,K)}$,\n- $\\mathbf{L} = [0.01,\\,0.01]\\,\\mathrm{m}$。\n\n案例 3（六表面，混合发射率含近镜面，较大腔体）：\n- $N = 6$,\n- $\\boldsymbol{\\epsilon} = [0.95,\\,0.10,\\,0.60,\\,0.85,\\,0.40,\\,0.03]$,\n- $\\mathbf{T} = [1100,\\,900,\\,600,\\,450,\\,350,\\,300]\\,\\mathrm{K}$,\n- $F = \\begin{bmatrix}\n0.10  0.20  0.15  0.15  0.20  0.20 \\\\\n0.20  0.10  0.20  0.20  0.15  0.15 \\\\\n0.15  0.20  0.10  0.25  0.15  0.15 \\\\\n0.15  0.20  0.25  0.10  0.15  0.15 \\\\\n0.20  0.15  0.15  0.15  0.10  0.25 \\\\\n0.20  0.15  0.15  0.15  0.25  0.10\n\\end{bmatrix}$,\n- $\\mathbf{h} = [25,\\,30,\\,12,\\,8,\\,10,\\,5]\\,\\mathrm{W/(m^2\\,K)}$,\n- $\\mathbf{T}^{\\infty} = [300,\\,300,\\,300,\\,300,\\,300,\\,300]\\,\\mathrm{K}$,\n- $\\mathbf{k} = [20,\\,15,\\,80,\\,60,\\,30,\\,220]\\,\\mathrm{W/(m\\,K)}$,\n- $\\mathbf{L} = [0.03,\\,0.02,\\,0.05,\\,0.04,\\,0.06,\\,0.01]\\,\\mathrm{m}$。\n\n最终输出规范：\n你的程序应生成单行输出，包含一个含三个子列表的列表（每个案例一个）。每个子列表必须按顺序包含：\n- 系统矩阵的未缩放条件数 $\\kappa_2$，\n- 行缩放后的条件数，\n- 能量守恒残差 $r$，\n- 该案例中所有表面的辐射度 $J_i$（单位 $\\mathrm{W/m^2}$），\n- 所有表面的净辐射热通量 $q^{\\mathrm{rad}}_i$（单位 $\\mathrm{W/m^2}$），\n- 所有表面的所需背面温度 $T^{\\mathrm{back}}_i$（单位 $\\mathrm{K}$）。\n\n将整个输出格式化为方括号内由逗号分隔的列表，不含任何空格，例如：\n\"[case1_sublist,case2_sublist,case3_sublist]\"\n其中每个 \"caseX_sublist\" 本身都是一个方括号括起来的、按上述顺序排列的、用逗号分隔的数字列表，不含空格。",
            "solution": "该问题要求推导并实现一个用于漫-灰封闭腔体内辐射、对流和传导组合传热的数值模型。该过程始于问题验证，接着是控制方程的第一性原理推导，最后是针对指定测试案例的求解。\n\n### 步骤 1：提取已知条件\n\n**基本定律与定义**：\n    - 发射能量 (Stefan–Boltzmann 定律)：$E_i = \\epsilon_i \\sigma T_i^4$，适用于漫-灰表面 $i$。\n    - 辐射度：$J_i$，离开表面 $i$ 的单位面积总辐射能。\n    - 辐照度：$G_i$，入射到表面 $i$ 的单位面积总辐射能。\n    - 角系数求和规则：$\\sum_{j=1}^N F_{ij} = 1$，适用于由 $N$ 个表面组成的封闭腔体。\n    - 表面积：$A_i = 1\\,\\mathrm{m}^2$，适用于所有表面 $i=1, \\dots, N$。\n    - 互易规则（当 $A_i=A_j$ 时）：$F_{ij} = F_{ji}$。\n    - 对流热通量：$q^{\\mathrm{conv}}_i = h_i (T_i - T^{\\infty}_i)$。\n    - 传导热通量：$q^{\\mathrm{cond}}_i = \\frac{k_i}{L_i} (T^{\\mathrm{back}}_i - T_i)$。\n    - 表面稳态能量平衡：$q^{\\mathrm{cond}}_i = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$。\n\n**常数**：\n    - Stefan–Boltzmann 常数：$\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W/(m^2\\,K^4)}$。\n\n**测试案例 1 数据**：\n    - $N = 3$\n    - $\\boldsymbol{\\epsilon} = [0.8, 0.6, 0.9]$\n    - $\\mathbf{T} = [800, 500, 300]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.0  0.6  0.4 \\\\ 0.6  0.0  0.4 \\\\ 0.4  0.4  0.2 \\end{bmatrix}$\n    - $\\mathbf{h} = [15, 10, 8]\\,\\mathrm{W/(m^2\\,K)}$\n    - $\\mathbf{T}^{\\infty} = [300, 300, 300]\\,\\mathrm{K}$\n    - $\\mathbf{k} = [16, 40, 100]\\,\\mathrm{W/(m\\,K)}$\n    - $\\mathbf{L} = [0.02, 0.05, 0.10]\\,\\mathrm{m}$\n\n**测试案例 2 数据**：\n    - $N = 2$\n    - $\\boldsymbol{\\epsilon} = [0.02, 0.02]$\n    - $\\mathbf{T} = [300, 300]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.0  1.0 \\\\ 1.0  0.0 \\end{bmatrix}$\n    - $\\mathbf{h} = [5, 5]\\,\\mathrm{W/(m^2\\,K)}$\n    - $\\mathbf{T}^{\\infty} = [300, 300]\\,\\mathrm{K}$\n    - $\\mathbf{k} = [200, 200]\\,\\mathrm{W/(m\\,K)}$\n    - $\\mathbf{L} = [0.01, 0.01]\\,\\mathrm{m}$\n\n**测试案例 3 数据**：\n    - $N = 6$\n    - $\\boldsymbol{\\epsilon} = [0.95, 0.10, 0.60, 0.85, 0.40, 0.03]$\n    - $\\mathbf{T} = [1100, 900, 600, 450, 350, 300]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.10  0.20  0.15  0.15  0.20  0.20 \\\\ 0.20  0.10  0.20  0.20  0.15  0.15 \\\\ 0.15  0.20  0.10  0.25  0.15  0.15 \\\\ 0.15  0.20  0.25  0.10  0.15  0.15 \\\\ 0.20  0.15  0.15  0.15  0.10  0.25 \\\\ 0.20  0.15  0.15  0.15  0.25  0.10 \\end{bmatrix}$\n    - $\\mathbf{h} = [25, 30, 12, 8, 10, 5]\\,\\mathrm{W/(m^2\\,K)}$\n    - $\\mathbf{T}^{\\infty} = [300, 300, 300, 300, 300, 300]\\,\\mathrm{K}$\n    - $\\mathbf{k} = [20, 15, 80, 60, 30, 220]\\,\\mathrm{W/(m\\,K)}$\n    - $\\mathbf{L} = [0.03, 0.02, 0.05, 0.04, 0.06, 0.01]\\,\\mathrm{m}$\n\n### 步骤 2：使用提取的已知条件进行验证\n\n该问题具有科学依据，源于传热学的基本原理（Stefan–Boltzmann 定律、Fourier 定律、Newton 冷却定律）。问题是适定的（well-posed），提供了构建和求解系统所需的所有物理属性、温度和几何因子（角系数）。所有案例的角系数矩阵都遵循求和规则（$\\sum_{j=1}^N F_{ij} = 1$）和互易规则（$A_i F_{ij} = A_j F_{ji}$，由于所有 $A_i$ 相等，该规则简化为 $F_{ij} = F_{ji}$，意味着矩阵必须是对称的）。经检查，所有提供的角系数矩阵均满足这些性质。问题是客观的，使用了精确的技术语言。所提供的数据是完整的，且量纲一致。问题在数学和物理上是合理的。\n\n### 步骤 3：结论与行动\n\n问题有效。将提供一个完整的解。\n\n### 推导与方法\n\n求解过程首先推导表面辐射度的线性系统，然后求解该系统，最后计算所有要求的导出量。\n\n**1. 辐射度线性系统的推导**\n\n对于一个漫-灰、不透明的表面 $i$，其辐射度 $J_i$ 是其自身发射和反射的辐射之和：\n$$J_i = E_i + \\rho_i G_i$$\n其中 $E_i$ 是发射功率，$\\rho_i$ 是反射率，$G_i$ 是辐照度。\n\n发射功率由 Stefan–Boltzmann 定律给出，为 $E_i = \\epsilon_i \\sigma T_i^4$。对于不透明表面，反射率 $\\rho_i = 1 - \\alpha_i$。对于灰体表面，吸收率等于发射率，即 $\\alpha_i = \\epsilon_i$。因此，$\\rho_i = 1 - \\epsilon_i$。将这些代入辐射度方程，得到：\n$$J_i = \\epsilon_i \\sigma T_i^4 + (1 - \\epsilon_i) G_i \\quad (1)$$\n\n表面 $i$ 上的辐照度 $G_i$ 是从腔体内所有表面（如果 $F_{ii} > 0$，则包括其自身）到达的辐射能之和。离开表面 $j$ 的能量为单位面积 $J_j$，因此离开的总能量为 $J_j A_j$。这部分能量中照射到表面 $i$ 的部分是角系数 $F_{ji}$。到达表面 $i$ 的总能量为 $\\sum_{j=1}^N A_j J_j F_{ji}$。辐照度是这个能量除以表面 $i$ 的面积：\n$$G_i = \\frac{1}{A_i} \\sum_{j=1}^N A_j J_j F_{ji}$$\n使用互易关系 $A_i F_{ij} = A_j F_{ji}$，上式可简化为：\n$$G_i = \\frac{1}{A_i} \\sum_{j=1}^N A_i J_j F_{ij} = \\sum_{j=1}^N F_{ij} J_j \\quad (2)$$\n\n将方程 $(2)$ 代入方程 $(1)$ 消去 $G_i$：\n$$J_i = \\epsilon_i \\sigma T_i^4 + (1 - \\epsilon_i) \\sum_{j=1}^N F_{ij} J_j$$\n该方程必须对 $N$ 个表面中的每一个都成立。为了构建一个形如 $M\\mathbf{J}=\\mathbf{b}$ 的线性系统（其中 $\\mathbf{J}$ 是未知辐射度向量），我们重新整理该方程：\n$$J_i - (1 - \\epsilon_i) \\sum_{j=1}^N F_{ij} J_j = \\epsilon_i \\sigma T_i^4$$\n这可以用 Kronecker delta $\\delta_{ij}$ 以求和形式写出：\n$$\\sum_{j=1}^N \\delta_{ij} J_j - \\sum_{j=1}^N (1 - \\epsilon_i) F_{ij} J_j = \\epsilon_i \\sigma T_i^4$$\n$$\\sum_{j=1}^N \\left( \\delta_{ij} - (1 - \\epsilon_i) F_{ij} \\right) J_j = \\epsilon_i \\sigma T_i^4$$\n这就定义了矩阵 $M$ 和向量 $\\mathbf{b}$ 的分量：\n- 矩阵元素：$M_{ij} = \\delta_{ij} - (1 - \\epsilon_i) F_{ij}$\n- 右侧向量元素：$b_i = \\epsilon_i \\sigma T_i^4$\n\n现在可以组建系统 $M\\mathbf{J} = \\mathbf{b}$ 并求解辐射度向量 $\\mathbf{J}$。\n\n**2. 导出量的计算**\n\n一旦 $\\mathbf{J}$ 已知，就可以计算其他所需的量。\n\n- **辐照度 ($G_i$) 和净辐射热通量 ($q^{\\mathrm{rad}}_i$)**：离开表面 $i$ 的净辐射热通量是其辐射度与辐照度之差：$q^{\\mathrm{rad}}_i = J_i - G_i$。使用方程 $(2)$，我们可以求出 $G_i$ 并因此求出 $q^{\\mathrm{rad}}_i$：\n$$G_i = \\sum_{j=1}^N F_{ij} J_j \\quad \\implies \\quad \\mathbf{G} = F \\mathbf{J}$$\n$$q^{\\mathrm{rad}}_i = J_i - G_i \\quad \\implies \\quad \\mathbf{q}^{\\mathrm{rad}} = \\mathbf{J} - \\mathbf{G} = (I - F)\\mathbf{J}$$\n问题给出对所有 $i$ 都有 $A_i = 1\\,\\mathrm{m}^2$，因此单位为 $\\mathrm{W/m^2}$ 的热通量 $q^{\\mathrm{rad}}_i$ 在数值上等于单位为 $\\mathrm{W}$ 的总净热率 $Q^{\\mathrm{rad}}_i$。\n\n- **能量守恒残差 ($r$)**：对于封闭腔体，所有净辐射传热之和必须为零，即 $\\sum_{i=1}^N A_i q^{\\mathrm{rad}}_i = 0$。由于 $A_i=1$，残差检查为：\n$$r = \\left| \\sum_{i=1}^N q^{\\mathrm{rad}}_i \\right|$$\n一个小的非零值表示线性求解器中的数值误差水平。\n\n- **对流热通量 ($q^{\\mathrm{conv}}_i$)**：这可以直接从给定的数据计算得出：\n$$q^{\\mathrm{conv}}_i = h_i (T_i - T^{\\infty}_i)$$\n\n- **背面温度 ($T^{\\mathrm{back}}_i$)**：在稳态下，通过壁面传导的热量必须与通过辐射和对流离开表面的热量相平衡。\n$$q^{\\mathrm{cond}}_i = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$$\n代入传导的表达式，我们求解 $T^{\\mathrm{back}}_i$：\n$$\\frac{k_i}{L_i} (T^{\\mathrm{back}}_i - T_i) = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$$\n$$T^{\\mathrm{back}}_i = T_i + \\frac{L_i}{k_i} (q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i)$$\n\n**3. 数值条件与缩放**\n\n矩阵 $M$ 的条件数 $\\kappa_2(M)$ 衡量了解 $\\mathbf{J}$ 对 $\\mathbf{b}$ 中扰动的敏感性。一个大的条件数表示系统是病态的（ill-conditioned），容易产生数值误差。条件数计算为 $\\kappa_2(M) = ||M||_2 ||M^{-1}||_2$。\n\n行缩放是一种用于改善条件数的预处理技术。系统 $(M\\mathbf{J} = \\mathbf{b})$ 的每一行 $i$ 都除以一个缩放因子，通常是该行元素的绝对值之和，即其 $L_1$-范数。缩放后的系统为 $M' \\mathbf{J} = \\mathbf{b}'$，其中：\n$$M'_{ij} = \\frac{M_{ij}}{\\sum_{k=1}^N |M_{ik}|} \\quad \\text{和} \\quad b'_i = \\frac{b_i}{\\sum_{k=1}^N |M_{ik}|}$$\n然后计算缩放后矩阵的条件数 $\\kappa_2(M')$，并与原始条件数进行比较。这种缩放将所有行的 $L_1$-范数均等化为 1，如果原始矩阵的行具有差异巨大的元素量级，这可以显著降低条件数。\n\n算法将为每个测试案例计算并报告 $\\kappa_2(M)$ 和 $\\kappa_2(M')$。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_analysis(case_data):\n    \"\"\"\n    Performs the full heat transfer analysis for a single case.\n    \"\"\"\n    SIGMA = 5.670374419e-8\n    \n    N, epsilon_list, T_list, F_list, h_list, T_inf_list, k_list, L_list = case_data\n    \n    # Convert lists to NumPy arrays for vectorized operations\n    epsilon = np.array(epsilon_list)\n    T = np.array(T_list)\n    F = np.array(F_list)\n    h = np.array(h_list)\n    T_inf = np.array(T_inf_list)\n    k = np.array(k_list)\n    L = np.array(L_list)\n    \n    # 1. Assemble the linear system M*J = b\n    M = np.zeros((N, N))\n    b = np.zeros(N)\n    \n    for i in range(N):\n        b[i] = epsilon[i] * SIGMA * T[i]**4\n        for j in range(N):\n            delta_ij = 1.0 if i == j else 0.0\n            M[i, j] = delta_ij - (1.0 - epsilon[i]) * F[i, j]\n\n    # 6. Compute condition numbers\n    cond_unscaled = np.linalg.cond(M)\n\n    # Row scaling\n    row_sums = np.sum(np.abs(M), axis=1)\n    # The scaling matrix S is diagonal with 1/row_sums on the diagonal.\n    # M_scaled = S @ M, which is equivalent to dividing each row of M by its sum.\n    # A small epsilon is added to avoid division by zero in a pathological case,\n    # though it is not expected for this problem type.\n    M_scaled = M / (row_sums[:, np.newaxis] + 1e-30)\n    \n    cond_scaled = np.linalg.cond(M_scaled)\n\n    # Solve for radiosities J\n    J = np.linalg.solve(M, b)\n\n    # 2. Compute irradiation G and net radiative heat flux q_rad\n    G = F @ J\n    q_rad = J - G\n    \n    # 5. Compute energy conservation residual\n    # Areas A_i are all 1, so sum of fluxes is sum of total heat rates.\n    residual = np.abs(np.sum(q_rad))\n\n    # 3. Compute convective heat flux q_conv\n    q_conv = h * (T - T_inf)\n\n    # 4. Compute required back-side temperature T_back\n    q_total_out = q_rad + q_conv\n    T_back = T + q_total_out * (L / k)\n\n    # Assemble results for this case into a flat list\n    results = [cond_unscaled, cond_scaled, residual]\n    results.extend(J.tolist())\n    results.extend(q_rad.tolist())\n    results.extend(T_back.tolist())\n    \n    return results\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run analysis, and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        (\n            3, # N\n            [0.8, 0.6, 0.9], # epsilon\n            [800, 500, 300], # T (K)\n            [[0.0, 0.6, 0.4], [0.6, 0.0, 0.4], [0.4, 0.4, 0.2]], # F\n            [15, 10, 8], # h\n            [300, 300, 300], # T_inf\n            [16, 40, 100], # k\n            [0.02, 0.05, 0.10] # L\n        ),\n        # Case 2\n        (\n            2, # N\n            [0.02, 0.02], # epsilon\n            [300, 300], # T (K)\n            [[0.0, 1.0], [1.0, 0.0]], # F\n            [5, 5], # h\n            [300, 300], # T_inf\n            [200, 200], # k\n            [0.01, 0.01] # L\n        ),\n        # Case 3\n        (\n            6, # N\n            [0.95, 0.10, 0.60, 0.85, 0.40, 0.03], # epsilon\n            [1100, 900, 600, 450, 350, 300], # T (K)\n            [\n                [0.10, 0.20, 0.15, 0.15, 0.20, 0.20],\n                [0.20, 0.10, 0.20, 0.20, 0.15, 0.15],\n                [0.15, 0.20, 0.10, 0.25, 0.15, 0.15],\n                [0.15, 0.20, 0.25, 0.10, 0.15, 0.15],\n                [0.20, 0.15, 0.15, 0.15, 0.10, 0.25],\n                [0.20, 0.15, 0.15, 0.15, 0.25, 0.10]\n            ], # F\n            [25, 30, 12, 8, 10, 5], # h\n            [300, 300, 300, 300, 300, 300], # T_inf\n            [20, 15, 80, 60, 30, 220], # k\n            [0.03, 0.02, 0.05, 0.04, 0.06, 0.01] # L\n        )\n    ]\n\n    all_results_str = []\n    for case in test_cases:\n        case_result = run_analysis(case)\n        # Format each sublist of numbers into a string without spaces\n        all_results_str.append(f\"[{','.join(f'{x:.15g}' for x in case_result)}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results_str)}]\")\n\n# To generate the answer string, this function would be executed.\n# solve()\n```",
            "answer": "[[2.45701899532598,1.83584859344421,1.13686837721616e-13,20586.2995358055,4203.22067753177,1596.11529949603,13862.6234390097,-5980.25055866179,-7882.37288034795,821.57827988762,507.52563198327,395.22363619844],[99.0000000000001,1.0,0,9.18590659278,9.18590659278,0,0,300,300], [25.794621045233,4.39009893976694,4.54747350886464e-13,83049.2003882793,31081.9332356511,10257.5190984924,4061.34151325732,2343.83403337923,598.021008620894,22874.8856238719,-28117.7562635956,-3214.36437706346,-3390.49080036125,9342.34842100832,2505.37739614013,1214.15584511211,1147.78188168285,607.72898964295,455.705680022699,355.48512533265,300.271827727677]]"
        },
        {
            "introduction": "真实的传热问题通常涉及求解未知温度，这要求处理辐射中非线性的 $T^4$ 项。这个重点练习将带您深入高级计算求解器的数学核心，推导辐射热通量项的线性化形式。掌握这种线性化技术对于实现稳健的牛顿–拉弗森法至关重要，该方法被广泛用于求解完全耦合的导热-对流-辐射问题 。",
            "id": "3972587",
            "problem": "考虑一个均质平板的一维稳态热传导问题，其热导率为 $k$，位于 $x=0$ 的表面通过对流和辐射两种方式与其环境进行热交换。设表面温度为 $T$，环境流体温度为 $T_{\\infty}$，周围大罩壁温度为 $T_{\\mathrm{sur}}$。表面的对流热通量为 $q_{\\mathrm{conv}}(T) = h\\,(T - T_{\\infty})$，其中 $h$ 是对流传热系数。表面的辐射热通量对于漫-灰表面使用 Stefan–Boltzmann 定律建模为 $q_{\\mathrm{rad}}(T) = \\epsilon\\,\\sigma\\,(T^{4} - T_{\\mathrm{sur}}^{4})$，其中 $\\epsilon$ 是发射率，$\\sigma$ 是 Stefan–Boltzmann 常数。在 $x=0$ 处的综合边界能量平衡由 $-k\\,\\partial T/\\partial x \\big|_{x=0} = q_{\\mathrm{conv}}(T) + q_{\\mathrm{rad}}(T)$ 给出。\n\n在一个使用 Newton–Raphson 方法（也称为 Newton 法）求解离散化非线性系统的计算热工学框架中，边界条件贡献了一个取决于 $T$ 的残差。为实现稳健的收敛，需要进行一致的 Newton 线性化。从上面 $q_{\\mathrm{rad}}(T)$ 的定义出发，仅使用基础微积分，在当前迭代值 $T^{n}$ 附近进行一阶 Taylor 展开，以推导辐射热通量的一致 Newton 线性化。然后，写出与辐射相关的 Jacobian 切线贡献的闭式解析表达式，即在 $T^{n}$ 处求值的导数 $\\mathrm{d}q_{\\mathrm{rad}}/\\mathrm{d}T$。\n\n仅提供此切线的最终闭式解析表达式。如果要报告数值，其单位将是瓦特每平方米每开尔文（$\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$）。不需要进行数值计算，也不需要进行四舍五入。",
            "solution": "该问题已被验证，并被认为是合理、适定且可形式化的。任务是为 Newton–Raphson 数值格式推导与辐射热通量项相关的 Jacobian 切线贡献。该贡献在数学上定义为辐射热通量函数关于温度的一阶导数，并在当前温度迭代值 $T^n$ 处求值。\n\n辐射热通量 $q_{\\mathrm{rad}}$ 作为表面温度 $T$ 的函数给出：\n$$q_{\\mathrm{rad}}(T) = \\epsilon\\,\\sigma\\,(T^{4} - T_{\\mathrm{sur}}^{4})$$\n此处，$\\epsilon$ 是表面发射率，$\\sigma$ 是 Stefan–Boltzmann 常数，$T_{\\mathrm{sur}}$ 是周围大环境的温度。这些参数 $\\epsilon$、$\\sigma$ 和 $T_{\\mathrm{sur}}$ 被认为是相对于可变表面温度 $T$ 的常数。\n\n在 Newton–Raphson 方法的背景下，非线性函数通过在当前迭代值 $T^n$ 附近进行一阶 Taylor 级数展开来进行线性化。对于函数 $f(x)$ 在点 $x_0$ 附近的这种展开的一般形式是：\n$$f(x) \\approx f(x_0) + \\frac{df}{dx}\\bigg|_{x=x_0} (x - x_0)$$\n将此应用于辐射热通量函数 $q_{\\mathrm{rad}}(T)$ 在温度 $T^n$ 附近，我们得到：\n$$q_{\\mathrm{rad}}(T) \\approx q_{\\mathrm{rad}}(T^n) + \\frac{dq_{\\mathrm{rad}}}{dT}\\bigg|_{T=T^n} (T - T^n)$$\n项 $\\frac{dq_{\\mathrm{rad}}}{dT}\\big|_{T=T^n}$ 是问题所要求的 Jacobian 贡献，或称“切线”。为了求得此项，我们必须对 $q_{\\mathrm{rad}}(T)$ 的表达式关于 $T$ 求导。\n\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\frac{d}{dT} \\left[ \\epsilon\\,\\sigma\\,(T^{4} - T_{\\mathrm{sur}}^{4}) \\right] $$\n由于 $\\epsilon$ 和 $\\sigma$ 是常数，它们可以从导数中提出：\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\epsilon\\,\\sigma\\,\\frac{d}{dT} (T^{4} - T_{\\mathrm{sur}}^{4}) $$\n使用微分的差分法则，我们分别对括号内的每一项进行微分：\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\epsilon\\,\\sigma\\,\\left( \\frac{d(T^{4})}{dT} - \\frac{d(T_{\\mathrm{sur}}^{4})}{dT} \\right) $$\n$T^4$ 关于 $T$ 的导数使用幂法则 $\\frac{d(x^n)}{dx} = nx^{n-1}$ 求得：\n$$ \\frac{d(T^{4})}{dT} = 4T^{3} $$\n周围环境的温度 $T_{\\mathrm{sur}}$ 独立于表面温度 $T$。因此，$T_{\\mathrm{sur}}^{4}$ 是关于 $T$ 的常数，其导数为零：\n$$ \\frac{d(T_{\\mathrm{sur}}^{4})}{dT} = 0 $$\n将这些结果代回导数的表达式中，得到：\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\epsilon\\,\\sigma\\,(4T^{3} - 0) $$\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = 4\\epsilon\\,\\sigma\\,T^{3} $$\n这个表达式是导数的一般形式。问题特别要求在当前 Newton-Raphson 迭代值 $T = T^n$ 处计算该导数。因此，我们用 $T^n$ 替换 $T$：\n$$ \\frac{dq_{\\mathrm{rad}}}{dT}\\bigg|_{T=T^n} = 4\\epsilon\\,\\sigma\\,(T^{n})^{3} $$\n这就是与辐射相关的 Jacobian 切线贡献的闭式解析表达式。这个量有时被称为在在化温度 $T^n$ 处求值的辐射传热系数 $h_r$。",
            "answer": "$$\\boxed{4\\epsilon\\sigma(T^{n})^{3}}$$"
        }
    ]
}