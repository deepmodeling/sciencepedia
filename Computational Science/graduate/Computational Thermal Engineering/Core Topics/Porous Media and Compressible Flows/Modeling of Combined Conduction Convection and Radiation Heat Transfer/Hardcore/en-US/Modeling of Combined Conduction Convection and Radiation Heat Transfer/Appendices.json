{
    "hands_on_practices": [
        {
            "introduction": "The non-linearity of the Stefan-Boltzmann law, with its dependence on $T^4$, is a central challenge in computational heat transfer. Direct solutions are often impossible, so we rely on iterative numerical methods like the Newton-Raphson technique. This exercise focuses on a critical first step: deriving the consistent Newton linearization of the radiative heat flux. Mastering this fundamental derivation is essential for developing robust and efficient solvers for problems involving combined heat transfer modes. ",
            "id": "3972587",
            "problem": "Consider a one-dimensional, steady-state conduction problem for a homogeneous slab with thermal conductivity $k$ and surface at $x=0$ that exchanges heat with its environment through both convection and radiation. Let the surface temperature be $T$, the ambient fluid temperature be $T_{\\infty}$, and the surrounding large enclosure temperature be $T_{\\mathrm{sur}}$. The convective heat flux at the surface is $q_{\\mathrm{conv}}(T) = h\\,(T - T_{\\infty})$, where $h$ is the convective heat transfer coefficient. The radiative heat flux at the surface is modeled using the Stefan–Boltzmann law for a diffuse-gray surface as $q_{\\mathrm{rad}}(T) = \\epsilon\\,\\sigma\\,(T^{4} - T_{\\mathrm{sur}}^{4})$, where $\\epsilon$ is the emissivity and $\\sigma$ is the Stefan–Boltzmann constant. The combined boundary energy balance at $x=0$ is given by $-k\\,\\partial T/\\partial x \\big|_{x=0} = q_{\\mathrm{conv}}(T) + q_{\\mathrm{rad}}(T)$.\n\nIn a computational thermal engineering framework using a Newton–Raphson method (also called Newton’s method) to solve the discretized nonlinear system, the boundary condition contributes a residual that depends on $T$. For robust convergence, a consistent Newton linearization is required. Starting from the definition of $q_{\\mathrm{rad}}(T)$ above and using only fundamental calculus, perform a first-order Taylor expansion around the current iterate $T^{n}$ to derive the consistent Newton linearization of the radiative heat flux. Then, write the closed-form analytic expression for the Jacobian tangent contribution associated with radiation, that is, the derivative $\\mathrm{d}q_{\\mathrm{rad}}/\\mathrm{d}T$ evaluated at $T^{n}$.\n\nProvide only the final closed-form analytic expression for this tangent. If a numerical value were to be reported, its unit would be watt per square meter per kelvin, $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$. No numerical evaluation is required, and no rounding is necessary.",
            "solution": "The problem has been validated and is deemed sound, well-posed, and formalizable. The task is to derive the Jacobian tangent contribution associated with the radiative heat flux term for a Newton-Raphson numerical scheme. This contribution is mathematically defined as the first derivative of the radiative heat flux function with respect to temperature, evaluated at the current temperature iterate, $T^n$.\n\nThe radiative heat flux, $q_{\\mathrm{rad}}$, is given as a function of the surface temperature $T$:\n$$q_{\\mathrm{rad}}(T) = \\epsilon\\,\\sigma\\,(T^{4} - T_{\\mathrm{sur}}^{4})$$\nHere, $\\epsilon$ is the surface emissivity, $\\sigma$ is the Stefan–Boltzmann constant, and $T_{\\mathrm{sur}}$ is the temperature of the large surroundings. These parameters, $\\epsilon$, $\\sigma$, and $T_{\\mathrm{sur}}$, are considered constants with respect to the variable surface temperature $T$.\n\nIn the context of the Newton-Raphson method, a nonlinear function is linearized using a first-order Taylor series expansion around the current iterate, $T^n$. The general form of this expansion for a function $f(x)$ around a point $x_0$ is:\n$$f(x) \\approx f(x_0) + \\frac{df}{dx}\\bigg|_{x=x_0} (x - x_0)$$\nApplying this to the radiative heat flux function $q_{\\mathrm{rad}}(T)$ around the temperature $T^n$, we get:\n$$q_{\\mathrm{rad}}(T) \\approx q_{\\mathrm{rad}}(T^n) + \\frac{dq_{\\mathrm{rad}}}{dT}\\bigg|_{T=T^n} (T - T^n)$$\nThe term $\\frac{dq_{\\mathrm{rad}}}{dT}\\big|_{T=T^n}$ is the Jacobian contribution, or the \"tangent,\" that the problem asks for. To find this, we must differentiate the expression for $q_{\\mathrm{rad}}(T)$ with respect to $T$.\n\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\frac{d}{dT} \\left[ \\epsilon\\,\\sigma\\,(T^{4} - T_{\\mathrm{sur}}^{4}) \\right] $$\nSince $\\epsilon$ and $\\sigma$ are constants, they can be factored out of the derivative:\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\epsilon\\,\\sigma\\,\\frac{d}{dT} (T^{4} - T_{\\mathrm{sur}}^{4}) $$\nUsing the difference rule for differentiation, we differentiate each term inside the parenthesis separately:\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\epsilon\\,\\sigma\\,\\left( \\frac{d(T^{4})}{dT} - \\frac{d(T_{\\mathrm{sur}}^{4})}{dT} \\right) $$\nThe derivative of $T^4$ with respect to $T$ is found using the power rule, $\\frac{d(x^n)}{dx} = nx^{n-1}$:\n$$ \\frac{d(T^{4})}{dT} = 4T^{3} $$\nThe temperature of the surroundings, $T_{\\mathrm{sur}}$, is independent of the surface temperature $T$. Therefore, $T_{\\mathrm{sur}}^{4}$ is a constant with respect to $T$, and its derivative is zero:\n$$ \\frac{d(T_{\\mathrm{sur}}^{4})}{dT} = 0 $$\nSubstituting these results back into the expression for the derivative gives:\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = \\epsilon\\,\\sigma\\,(4T^{3} - 0) $$\n$$ \\frac{dq_{\\mathrm{rad}}}{dT} = 4\\epsilon\\,\\sigma\\,T^{3} $$\nThis expression is the general form of the derivative. The problem specifically asks for this derivative evaluated at the current Newton-Raphson iterate, $T = T^n$. Therefore, we substitute $T^n$ for $T$:\n$$ \\frac{dq_{\\mathrm{rad}}}{dT}\\bigg|_{T=T^n} = 4\\epsilon\\,\\sigma\\,(T^{n})^{3} $$\nThis is the closed-form analytic expression for the Jacobian tangent contribution associated with radiation. This quantity is sometimes referred to as the radiative heat transfer coefficient, $h_r$, evaluated at the linearization temperature $T^n$.",
            "answer": "$$\\boxed{4\\epsilon\\sigma(T^{n})^{3}}$$"
        },
        {
            "introduction": "Building on the principles of radiative exchange, this practice moves from a single boundary to a complete system of interacting surfaces within an enclosure. You will assemble the linear system for surface radiosities from first principles, a core task in modeling furnaces, spacecraft, and other engineering systems. This comprehensive exercise also delves into the practical computational aspects of solving this system, including assessing the numerical stability through matrix conditioning, which is a vital skill for any computational engineer. ",
            "id": "3972590",
            "problem": "You are to assemble and solve the enclosure radiation linear system for radiosities in a closed, diffuse-gray enclosure, and then couple the result to convection and conduction at the surfaces. Your derivation and algorithm must start from first principles: the Stefan–Boltzmann law, the definition of radiosity and irradiation, and the view factor properties for closed enclosures. You must also assess the numerical conditioning of the resulting linear system and apply a scaling strategy to improve conditioning, reporting the change in condition numbers. Finally, compute derived heat fluxes and the conduction-required back-side temperatures for steady state.\n\nUse the following foundational statements to derive your method:\n- The radiant energy emitted by a surface per unit area is given by the Stefan–Boltzmann law: for a diffuse-gray surface with emissivity $\\epsilon_i$ at temperature $T_i$, the emitted energy is $\\epsilon_i \\sigma T_i^4$, where $\\sigma$ is the Stefan–Boltzmann constant.\n- The radiosity $J_i$ of surface $i$ is the total radiant energy leaving the surface per unit area, and the irradiation $G_i$ is the total radiant energy incident on the surface per unit area.\n- In a closed enclosure of $N$ surfaces with view factor matrix $F \\in \\mathbb{R}^{N \\times N}$, the view factors satisfy $\\sum_{j=1}^N F_{ij} = 1$ for each $i$. Assume each surface has area $A_i = 1\\,\\mathrm{m}^2$, so reciprocity reduces to $F_{ij} = F_{ji}$.\n\nFrom these bases, derive the linear system for the radiosity vector $\\mathbf{J} \\in \\mathbb{R}^N$ in terms of the known temperatures $\\mathbf{T}$, emissivities $\\boldsymbol{\\epsilon}$, and the view factor matrix $F$. Then:\n1. Assemble the matrix and right-hand side from your derivation and solve for $\\mathbf{J}$.\n2. Compute the irradiation $\\mathbf{G}$ and the net radiative heat flux vector $\\mathbf{q}^{\\mathrm{rad}}$ with entries $q^{\\mathrm{rad}}_i$.\n3. For each surface, compute the convective heat flux $q^{\\mathrm{conv}}_i = h_i (T_i - T^{\\infty}_i)$, where $h_i$ is the convective heat transfer coefficient, and $T^{\\infty}_i$ is the ambient fluid temperature adjacent to surface $i$.\n4. Assuming steady one-dimensional heat conduction through a wall of thickness $L_i$ and thermal conductivity $k_i$, compute the required back-side solid temperature $T^{\\mathrm{back}}_i$ such that conduction equals the sum of outward convection and radiation at the surface: $q^{\\mathrm{cond}}_i = \\dfrac{k_i}{L_i} \\left(T^{\\mathrm{back}}_i - T_i\\right)$, and enforce $q^{\\mathrm{cond}}_i = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$ to solve for $T^{\\mathrm{back}}_i$.\n5. Evaluate the energy conservation residual $r = \\left|\\sum_{i=1}^N q^{\\mathrm{rad}}_i\\right|$, which should be near zero in a closed enclosure.\n6. Compute the $2$-norm condition number $\\kappa_2$ of the unscaled linear system matrix and of a row-scaled matrix obtained by dividing each equation by the sum of absolute values in its row (scale the right-hand side consistently). Report both condition numbers.\n\nPhysical units and reporting requirements:\n- Report radiosities $J_i$ and net radiative heat fluxes $q^{\\mathrm{rad}}_i$ in $\\mathrm{W/m^2}$.\n- Report required back-side temperatures $T^{\\mathrm{back}}_i$ in $\\mathrm{K}$.\n- Report condition numbers as unitless floats.\n- Angles do not appear; no angle unit is required.\n- Express all numerical outputs as plain decimals (no percentages).\n\nTest suite:\nProvide results for three test cases. In each case, treat all surface areas as $1\\,\\mathrm{m^2}$.\n\nCase 1 (three-surface, moderate emissivities, mixed concavity):\n- $N = 3$,\n- $\\boldsymbol{\\epsilon} = [0.8,\\,0.6,\\,0.9]$,\n- $\\mathbf{T} = [800,\\,500,\\,300]\\,\\mathrm{K}$,\n- $F = \\begin{bmatrix} 0.0  0.6  0.4 \\\\ 0.6  0.0  0.4 \\\\ 0.4  0.4  0.2 \\end{bmatrix}$,\n- $\\mathbf{h} = [15,\\,10,\\,8]\\,\\mathrm{W/(m^2\\,K)}$,\n- $\\mathbf{T}^{\\infty} = [300,\\,300,\\,300]\\,\\mathrm{K}$,\n- $\\mathbf{k} = [16,\\,40,\\,100]\\,\\mathrm{W/(m\\,K)}$,\n- $\\mathbf{L} = [0.02,\\,0.05,\\,0.10]\\,\\mathrm{m}$.\n\nCase 2 (two-surface, highly reflective, equal temperatures):\n- $N = 2$,\n- $\\boldsymbol{\\epsilon} = [0.02,\\,0.02]$,\n- $\\mathbf{T} = [300,\\,300]\\,\\mathrm{K}$,\n- $F = \\begin{bmatrix} 0.0  1.0 \\\\ 1.0  0.0 \\end{bmatrix}$,\n- $\\mathbf{h} = [5,\\,5]\\,\\mathrm{W/(m^2\\,K)}$,\n- $\\mathbf{T}^{\\infty} = [300,\\,300]\\,\\mathrm{K}$,\n- $\\mathbf{k} = [200,\\,200]\\,\\mathrm{W/(m\\,K)}$,\n- $\\mathbf{L} = [0.01,\\,0.01]\\,\\mathrm{m}$.\n\nCase 3 (six-surface, mixed emissivities with near-mirror, larger enclosure):\n- $N = 6$,\n- $\\boldsymbol{\\epsilon} = [0.95,\\,0.10,\\,0.60,\\,0.85,\\,0.40,\\,0.03]$,\n- $\\mathbf{T} = [1100,\\,900,\\,600,\\,450,\\,350,\\,300]\\,\\mathrm{K}$,\n- $F = \\begin{bmatrix}\n0.10  0.20  0.15  0.15  0.20  0.20 \\\\\n0.20  0.10  0.20  0.20  0.15  0.15 \\\\\n0.15  0.20  0.10  0.25  0.15  0.15 \\\\\n0.15  0.20  0.25  0.10  0.15  0.15 \\\\\n0.20  0.15  0.15  0.15  0.10  0.25 \\\\\n0.20  0.15  0.15  0.15  0.25  0.10\n\\end{bmatrix}$,\n- $\\mathbf{h} = [25,\\,30,\\,12,\\,8,\\,10,\\,5]\\,\\mathrm{W/(m^2\\,K)}$,\n- $\\mathbf{T}^{\\infty} = [300,\\,300,\\,300,\\,300,\\,300,\\,300]\\,\\mathrm{K}$,\n- $\\mathbf{k} = [20,\\,15,\\,80,\\,60,\\,30,\\,220]\\,\\mathrm{W/(m\\,K)}$,\n- $\\mathbf{L} = [0.03,\\,0.02,\\,0.05,\\,0.04,\\,0.06,\\,0.01]\\,\\mathrm{m}$.\n\nFinal output specification:\nYour program should produce a single line of output containing a list of three sublists (one per case). Each sublist must contain, in order:\n- the unscaled condition number $\\kappa_2$ of the system matrix,\n- the row-scaled condition number,\n- the energy conservation residual $r$,\n- the radiosities $J_i$ for all surfaces in the case (in $\\mathrm{W/m^2}$),\n- the net radiative heat fluxes $q^{\\mathrm{rad}}_i$ for all surfaces (in $\\mathrm{W/m^2}$),\n- the required back-side temperatures $T^{\\mathrm{back}}_i$ for all surfaces (in $\\mathrm{K}$).\n\nFormat the entire output as a comma-separated list enclosed in square brackets, with no spaces anywhere, for example:\n\"[case1_sublist,case2_sublist,case3_sublist]\"\nwhere each \"caseX_sublist\" is itself a bracketed, comma-separated list of numbers in the order specified above, with no spaces.\n\nNo external input is permitted; all data are as specified above. Use the Stefan–Boltzmann constant $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W/(m^2\\,K^4)}$.",
            "solution": "The problem requires the derivation and implementation of a numerical model for combined radiation, convection, and conduction heat transfer in a diffuse-gray enclosure. The process begins with problem validation, followed by a first-principles derivation of the governing equations, and concludes with the solution for the specified test cases.\n\n### Step 1: Extract Givens\n\n- **Fundamental Laws  Definitions**:\n    - Emitted energy (Stefan-Boltzmann Law): $E_i = \\epsilon_i \\sigma T_i^4$ for a diffuse-gray surface $i$.\n    - Radiosity: $J_i$, total radiant energy leaving surface $i$ per unit area.\n    - Irradiation: $G_i$, total radiant energy incident on surface $i$ per unit area.\n    - View Factor Summation Rule: $\\sum_{j=1}^N F_{ij} = 1$ for a closed enclosure of $N$ surfaces.\n    - Surface Area: $A_i = 1\\,\\mathrm{m}^2$ for all surfaces $i=1, \\dots, N$.\n    - Reciprocity Rule (with $A_i=A_j$): $F_{ij} = F_{ji}$.\n    - Convective Heat Flux: $q^{\\mathrm{conv}}_i = h_i (T_i - T^{\\infty}_i)$.\n    - Conductive Heat Flux: $q^{\\mathrm{cond}}_i = \\frac{k_i}{L_i} (T^{\\mathrm{back}}_i - T_i)$.\n    - Steady-State Energy Balance at Surface: $q^{\\mathrm{cond}}_i = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$.\n\n- **Constants**:\n    - Stefan-Boltzmann Constant: $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W/(m^2\\,K^4)}$.\n\n- **Test Case 1 Data**:\n    - $N = 3$\n    - $\\boldsymbol{\\epsilon} = [0.8, 0.6, 0.9]$\n    - $\\mathbf{T} = [800, 500, 300]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.0  0.6  0.4 \\\\ 0.6  0.0  0.4 \\\\ 0.4  0.4  0.2 \\end{bmatrix}$\n    - $\\mathbf{h} = [15, 10, 8]\\,\\mathrm{W/(m^2\\,K)}$\n    - $\\mathbf{T}^{\\infty} = [300, 300, 300]\\,\\mathrm{K}$\n    - $\\mathbf{k} = [16, 40, 100]\\,\\mathrm{W/(m\\,K)}$\n    - $\\mathbf{L} = [0.02, 0.05, 0.10]\\,\\mathrm{m}$\n\n- **Test Case 2 Data**:\n    - $N = 2$\n    - $\\boldsymbol{\\epsilon} = [0.02, 0.02]$\n    - $\\mathbf{T} = [300, 300]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.0  1.0 \\\\ 1.0  0.0 \\end{bmatrix}$\n    - $\\mathbf{h} = [5, 5]\\,\\mathrm{W/(m^2\\,K)}$\n    - $\\mathbf{T}^{\\infty} = [300, 300, 300]\\,\\mathrm{K}$\n    - $\\mathbf{k} = [200, 200]\\,\\mathrm{W/(m\\,K)}$\n    - $\\mathbf{L} = [0.01, 0.01]\\,\\mathrm{m}$\n\n- **Test Case 3 Data**:\n    - $N = 6$\n    - $\\boldsymbol{\\epsilon} = [0.95, 0.10, 0.60, 0.85, 0.40, 0.03]$\n    - $\\mathbf{T} = [1100, 900, 600, 450, 350, 300]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.10  0.20  0.15  0.15  0.20  0.20 \\\\ 0.20  0.10  0.20  0.20  0.15  0.15 \\\\ 0.15  0.20  0.10  0.25  0.15  0.15 \\\\ 0.15  0.20  0.25  0.10  0.15  0.15 \\\\ 0.20  0.15  0.15  0.15  0.10  0.25 \\\\ 0.20  0.15  0.15  0.15  0.25  0.10 \\end{bmatrix}$\n    - $\\mathbf{h} = [25, 30, 12, 8, 10, 5]\\,\\mathrm{W/(m^2\\,K)}$\n    - $\\mathbf{T}^{\\infty} = [300, 300, 300, 300, 300, 300]\\,\\mathrm{K}$\n    - $\\mathbf{k} = [20, 15, 80, 60, 30, 220]\\,\\mathrm{W/(m\\,K)}$\n    - $\\mathbf{L} = [0.03, 0.02, 0.05, 0.04, 0.06, 0.01]\\,\\mathrm{m}$\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is scientifically grounded, deriving from fundamental principles of heat transfer (Stefan-Boltzmann law, Fourier's law, Newton's law of cooling). It is well-posed, providing all necessary physical properties, temperatures, and geometric factors (view factors) to construct and solve the system. The view factor matrices for all cases adhere to the summation rule ($\\sum_{j=1}^N F_{ij} = 1$) and the reciprocity rule ($A_i F_{ij} = A_j F_{ji}$, which simplifies to $F_{ij} = F_{ji}$ since all $A_i$ are equal, meaning the matrices must be symmetric). A check confirms that all provided view factor matrices satisfy these properties. The problem is objective, using precise technical language. The data provided is complete and dimensionally consistent. The problem is mathematically and physically sound.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. A complete solution will be provided.\n\n### Derivation and Method\n\nThe solution proceeds by first deriving the linear system for surface radiosities, solving it, and then computing all derived quantities as requested.\n\n**1. Derivation of the Radiosity Linear System**\n\nFor a diffuse-gray, opaque surface $i$, the radiosity $J_i$ is the sum of its emitted and reflected radiation:\n$$J_i = E_i + \\rho_i G_i$$\nwhere $E_i$ is the emissive power, $\\rho_i$ is the reflectivity, and $G_i$ is the irradiation.\n\nThe emissive power is given by the Stefan-Boltzmann law as $E_i = \\epsilon_i \\sigma T_i^4$. For an opaque surface, reflectivity is $\\rho_i = 1 - \\alpha_i$. For a gray surface, absorptivity equals emissivity, $\\alpha_i = \\epsilon_i$. Thus, $\\rho_i = 1 - \\epsilon_i$. Substituting these into the radiosity equation gives:\n$$J_i = \\epsilon_i \\sigma T_i^4 + (1 - \\epsilon_i) G_i \\quad (1)$$\n\nThe irradiation $G_i$ on surface $i$ is the sum of radiant energy arriving from all surfaces (including itself, if $F_{ii}  0$) in the enclosure. The energy leaving surface $j$ is $J_j$ per unit area, so the total energy leaving is $J_j A_j$. The fraction of this energy that strikes surface $i$ is the view factor $F_{ji}$. The total energy arriving at surface $i$ is $\\sum_{j=1}^N A_j J_j F_{ji}$. The irradiation is this energy per unit area of surface $i$:\n$$G_i = \\frac{1}{A_i} \\sum_{j=1}^N A_j J_j F_{ji}$$\nUsing the reciprocity relation $A_i F_{ij} = A_j F_{ji}$, this simplifies to:\n$$G_i = \\frac{1}{A_i} \\sum_{j=1}^N A_i J_j F_{ij} = \\sum_{j=1}^N F_{ij} J_j \\quad (2)$$\n\nSubstituting equation $(2)$ into equation $(1)$ eliminates $G_i$:\n$$J_i = \\epsilon_i \\sigma T_i^4 + (1 - \\epsilon_i) \\sum_{j=1}^N F_{ij} J_j$$\nThis equation must hold for each of the $N$ surfaces. To formulate a linear system of the form $M\\mathbf{J}=\\mathbf{b}$, where $\\mathbf{J}$ is the vector of unknown radiosities, we rearrange the equation:\n$$J_i - (1 - \\epsilon_i) \\sum_{j=1}^N F_{ij} J_j = \\epsilon_i \\sigma T_i^4$$\nThis can be written in summation notation using the Kronecker delta, $\\delta_{ij}$:\n$$\\sum_{j=1}^N \\delta_{ij} J_j - \\sum_{j=1}^N (1 - \\epsilon_i) F_{ij} J_j = \\epsilon_i \\sigma T_i^4$$\n$$\\sum_{j=1}^N \\left( \\delta_{ij} - (1 - \\epsilon_i) F_{ij} \\right) J_j = \\epsilon_i \\sigma T_i^4$$\nThis defines the components of the matrix $M$ and vector $\\mathbf{b}$:\n- Matrix elements: $M_{ij} = \\delta_{ij} - (1 - \\epsilon_i) F_{ij}$\n- Right-hand side vector elements: $b_i = \\epsilon_i \\sigma T_i^4$\n\nThe system $M\\mathbf{J} = \\mathbf{b}$ can now be assembled and solved for the radiosity vector $\\mathbf{J}$.\n\n**2. Calculation of Derived Quantities**\n\nOnce $\\mathbf{J}$ is known, the other required quantities can be computed.\n\n- **Irradiation ($G_i$) and Net Radiative Heat Flux ($q^{\\mathrm{rad}}_i$)**: The net radiative heat flux leaving surface $i$ is the difference between its radiosity and irradiation: $q^{\\mathrm{rad}}_i = J_i - G_i$. Using equation $(2)$, we find $G_i$ and hence $q^{\\mathrm{rad}}_i$:\n$$G_i = \\sum_{j=1}^N F_{ij} J_j \\quad \\implies \\quad \\mathbf{G} = F \\mathbf{J}$$\n$$q^{\\mathrm{rad}}_i = J_i - G_i \\quad \\implies \\quad \\mathbf{q}^{\\mathrm{rad}} = \\mathbf{J} - \\mathbf{G} = (I - F)\\mathbf{J}$$\nThe problem gives $A_i = 1\\,\\mathrm{m}^2$ for all $i$, so the heat flux $q^{\\mathrm{rad}}_i$ in $\\mathrm{W/m^2}$ is numerically equal to the total net heat rate $Q^{\\mathrm{rad}}_i$ in $\\mathrm{W}$.\n\n- **Energy Conservation Residual ($r$)**: For a closed enclosure, the sum of all net radiative heat transfers must be zero, $\\sum_{i=1}^N A_i q^{\\mathrm{rad}}_i = 0$. Since $A_i=1$, the residual check is:\n$$r = \\left| \\sum_{i=1}^N q^{\\mathrm{rad}}_i \\right|$$\nA small non-zero value indicates the level of numerical error in the linear solver.\n\n- **Convective Heat Flux ($q^{\\mathrm{conv}}_i$)**: This is calculated directly from the given data:\n$$q^{\\mathrm{conv}}_i = h_i (T_i - T^{\\infty}_i)$$\n\n- **Back-Side Temperature ($T^{\\mathrm{back}}_i$)**: At steady state, the heat conducted through the wall must balance the heat leaving the surface via radiation and convection.\n$$q^{\\mathrm{cond}}_i = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$$\nSubstituting the expression for conduction, we solve for $T^{\\mathrm{back}}_i$:\n$$\\frac{k_i}{L_i} (T^{\\mathrm{back}}_i - T_i) = q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i$$\n$$T^{\\mathrm{back}}_i = T_i + \\frac{L_i}{k_i} (q^{\\mathrm{rad}}_i + q^{\\mathrm{conv}}_i)$$\n\n**3. Numerical Conditioning and Scaling**\n\nThe condition number $\\kappa_2(M)$ of the matrix $M$ measures the sensitivity of the solution $\\mathbf{J}$ to perturbations in $\\mathbf{b}$. A large condition number signifies an ill-conditioned system prone to numerical errors. The condition number is computed as $\\kappa_2(M) = ||M||_2 ||M^{-1}||_2$.\n\nRow scaling is a preconditioning technique to improve the condition number. Each row $i$ of the system $(M\\mathbf{J} = \\mathbf{b})$ is divided by a scaling factor, typically the sum of the absolute values of the elements in that row, i.e., its $L_1$-norm. The scaled system is $M' \\mathbf{J} = \\mathbf{b}'$, where:\n$$M'_{ij} = \\frac{M_{ij}}{\\sum_{k=1}^N |M_{ik}|} \\quad \\text{and} \\quad b'_i = \\frac{b_i}{\\sum_{k=1}^N |M_{ik}|}$$\nThe condition number $\\kappa_2(M')$ of the scaled matrix is then computed and compared to the original. This scaling equalizes the $L_1$-norms of all rows to $1$, which can significantly reduce the condition number if the original matrix has rows with widely varying element magnitudes.\n\nThe algorithm will compute and report $\\kappa_2(M)$ and $\\kappa_2(M')$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_analysis(case_data):\n    \"\"\"\n    Performs the full heat transfer analysis for a single case.\n    \"\"\"\n    SIGMA = 5.670374419e-8\n    \n    N, epsilon_list, T_list, F_list, h_list, T_inf_list, k_list, L_list = case_data\n    \n    # Convert lists to NumPy arrays for vectorized operations\n    epsilon = np.array(epsilon_list)\n    T = np.array(T_list)\n    F = np.array(F_list)\n    h = np.array(h_list)\n    T_inf = np.array(T_inf_list)\n    k = np.array(k_list)\n    L = np.array(L_list)\n    \n    # 1. Assemble the linear system M*J = b\n    M = np.zeros((N, N))\n    b = np.zeros(N)\n    \n    for i in range(N):\n        b[i] = epsilon[i] * SIGMA * T[i]**4\n        for j in range(N):\n            delta_ij = 1.0 if i == j else 0.0\n            M[i, j] = delta_ij - (1.0 - epsilon[i]) * F[i, j]\n\n    # 6. Compute condition numbers\n    cond_unscaled = np.linalg.cond(M)\n\n    # Row scaling\n    row_sums = np.sum(np.abs(M), axis=1)\n    # The scaling matrix S is diagonal with 1/row_sums on the diagonal.\n    # M_scaled = S @ M, which is equivalent to dividing each row of M by its sum.\n    # A small epsilon is added to avoid division by zero in a pathological case,\n    # though it is not expected for this problem type.\n    M_scaled = M / (row_sums[:, np.newaxis] + 1e-30)\n    \n    cond_scaled = np.linalg.cond(M_scaled)\n\n    # Solve for radiosities J\n    J = np.linalg.solve(M, b)\n\n    # 2. Compute irradiation G and net radiative heat flux q_rad\n    G = F @ J\n    q_rad = J - G\n    \n    # 5. Compute energy conservation residual\n    # Areas A_i are all 1, so sum of fluxes is sum of total heat rates.\n    residual = np.abs(np.sum(q_rad))\n\n    # 3. Compute convective heat flux q_conv\n    q_conv = h * (T - T_inf)\n\n    # 4. Compute required back-side temperature T_back\n    q_total_out = q_rad + q_conv\n    T_back = T + q_total_out * (L / k)\n\n    # Assemble results for this case into a flat list\n    results = [cond_unscaled, cond_scaled, residual]\n    results.extend(J.tolist())\n    results.extend(q_rad.tolist())\n    results.extend(T_back.tolist())\n    \n    return results\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run analysis, and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        (\n            3, # N\n            [0.8, 0.6, 0.9], # epsilon\n            [800, 500, 300], # T (K)\n            [[0.0, 0.6, 0.4], [0.6, 0.0, 0.4], [0.4, 0.4, 0.2]], # F\n            [15, 10, 8], # h\n            [300, 300, 300], # T_inf\n            [16, 40, 100], # k\n            [0.02, 0.05, 0.10] # L\n        ),\n        # Case 2\n        (\n            2, # N\n            [0.02, 0.02], # epsilon\n            [300, 300], # T (K)\n            [[0.0, 1.0], [1.0, 0.0]], # F\n            [5, 5], # h\n            [300, 300], # T_inf\n            [200, 200], # k\n            [0.01, 0.01] # L\n        ),\n        # Case 3\n        (\n            6, # N\n            [0.95, 0.10, 0.60, 0.85, 0.40, 0.03], # epsilon\n            [1100, 900, 600, 450, 350, 300], # T (K)\n            [\n                [0.10, 0.20, 0.15, 0.15, 0.20, 0.20],\n                [0.20, 0.10, 0.20, 0.20, 0.15, 0.15],\n                [0.15, 0.20, 0.10, 0.25, 0.15, 0.15],\n                [0.15, 0.20, 0.25, 0.10, 0.15, 0.15],\n                [0.20, 0.15, 0.15, 0.15, 0.10, 0.25],\n                [0.20, 0.15, 0.15, 0.15, 0.25, 0.10]\n            ], # F\n            [25, 30, 12, 8, 10, 5], # h\n            [300, 300, 300, 300, 300, 300], # T_inf\n            [20, 15, 80, 60, 30, 220], # k\n            [0.03, 0.02, 0.05, 0.04, 0.06, 0.01] # L\n        )\n    ]\n\n    all_results_str = []\n    for case in test_cases:\n        case_result = run_analysis(case)\n        # Format each sublist of numbers into a string\n        all_results_str.append(f\"[{','.join(map(str, case_result))}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Numerical models are built on approximations, and a key task for an engineer is to understand their impact. Having learned how to linearize the radiation term , we now investigate the consequences of this simplification in a sophisticated application: an inverse problem using Bayesian inference. This advanced practice challenges you to quantify the bias introduced by linearization, comparing the results of the simplified model to the exact non-linear formulation. This will provide deep insight into the trade-offs between computational simplicity and model fidelity. ",
            "id": "3972633",
            "problem": "Consider a one-dimensional isothermal boundary subject to combined heat transfer by conduction through the solid interior, convection to an ambient fluid, and thermal radiation exchange with a surrounding enclosure. Focus on the forward boundary heat flux from the control surface to the environment, modeling convection by Newton's law of cooling and radiation by the Stefan–Boltzmann law. For a surface at temperature $T$ (in $\\mathrm{K}$), ambient fluid temperature $T_{\\infty}$ (in $\\mathrm{K}$), and surrounding enclosure temperature $T_{s}$ (in $\\mathrm{K}$), the exact boundary heat flux (in $\\mathrm{W/m^2}$) is\n$$\nq_{\\text{exact}}(T) = h (T - T_{\\infty}) + \\epsilon \\sigma \\left( T^4 - T_{s}^4 \\right),\n$$\nwhere $h$ is the convective heat transfer coefficient (in $\\mathrm{W/(m^2\\cdot K)}$), $\\epsilon$ is the emissivity (dimensionless), and $\\sigma$ is the Stefan–Boltzmann constant (in $\\mathrm{W/(m^2\\cdot K^4)}$). A linearized radiation model is obtained by a first-order Taylor expansion of $T^4$ about a reference temperature $T_{\\mathrm{ref}}$:\n$$\nT^4 \\approx T_{\\mathrm{ref}}^4 + 4 T_{\\mathrm{ref}}^3 (T - T_{\\mathrm{ref}}),\n$$\nyielding the linearized boundary heat flux\n$$\nq_{\\text{lin}}(T) = h (T - T_{\\infty}) + \\epsilon \\sigma \\left( 4 T_{\\mathrm{ref}}^3 T - 3 T_{\\mathrm{ref}}^4 - T_{s}^4 \\right).\n$$\nAssume a single scalar measurement $y$ (in $\\mathrm{W/m^2}$) of the boundary heat flux is available. Model the observational noise as Gaussian with standard deviation $s_n$ (in $\\mathrm{W/m^2}$), giving the Gaussian likelihood for the unknown surface temperature $T$ as\n$$\n\\mathcal{L}(y \\mid T) \\propto \\exp\\left( -\\frac{(y - q(T))^2}{2 s_n^2} \\right),\n$$\nwhere $q(T)$ is either $q_{\\text{exact}}(T)$ or $q_{\\text{lin}}(T)$. Assume a Gaussian prior for $T$ with mean $m_0$ (in $\\mathrm{K}$) and standard deviation $s_0$ (in $\\mathrm{K}$). The negative log-posterior for $T$ is then\n$$\n\\Phi(T) = \\frac{(y - q(T))^2}{2 s_n^2} + \\frac{(T - m_0)^2}{2 s_0^2} + C,\n$$\nwhere $C$ is a constant independent of $T$. Define the negative log-posterior gradient with respect to $T$ as\n$$\n\\frac{d\\Phi}{dT}(T) = -\\frac{(y - q(T))}{s_n^2} \\frac{dq}{dT}(T) + \\frac{T - m_0}{s_0^2}.\n$$\nYour tasks are:\n- Derive the exact and linearized forward models $q_{\\text{exact}}(T)$ and $q_{\\text{lin}}(T)$ starting from Newton's law of cooling and the Stefan–Boltzmann law, and derive their temperature derivatives $\\frac{dq_{\\text{exact}}}{dT}(T)$ and $\\frac{dq_{\\text{lin}}}{dT}(T)$.\n- Construct the negative log-posterior $\\Phi(T)$ and its gradient for both the exact and linearized models.\n- Using $y = q_{\\text{exact}}(T_{\\text{true}})$ (i.e., noise-free data generated from the exact model at the true temperature $T_{\\text{true}}$), evaluate and compare the negative log-posterior gradients from the exact and linearized models at $T = T_{\\text{true}}$. Report the absolute difference $\\Delta g = \\left| \\left. \\frac{d\\Phi_{\\text{lin}}}{dT} \\right|_{T_{\\text{true}}} - \\left. \\frac{d\\Phi_{\\text{exact}}}{dT} \\right|_{T_{\\text{true}}} \\right|$ in units of $\\mathrm{K^{-1}}$.\n- Construct the posterior densities $p_{\\text{exact}}(T \\mid y)$ and $p_{\\text{lin}}(T \\mid y)$ numerically over a specified temperature grid by evaluating the unnormalized densities,\n$$\n\\tilde{p}(T) = \\exp\\left( -\\frac{(y - q(T))^2}{2 s_n^2} - \\frac{(T - m_0)^2}{2 s_0^2} \\right),\n$$\nand normalizing over the grid via numerical quadrature. Compute the posterior means $\\mu_{\\text{exact}}$ and $\\mu_{\\text{lin}}$ (in $\\mathrm{K}$), and quantify the bias introduced by the linearization as $\\Delta \\mu = \\mu_{\\text{lin}} - \\mu_{\\text{exact}}$ (in $\\mathrm{K}$).\n\nImplement a complete, runnable program that performs these steps for the following test suite. Use the Stefan–Boltzmann constant $\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W/(m^2\\cdot K^4)}$. For each case, use a uniform temperature grid as specified.\n\nTest suite:\n1. Case A (happy path, moderate nonlinearity):\n   - $h = 50 \\ \\mathrm{W/(m^2\\cdot K)}$, $\\epsilon = 0.8$, $T_{\\infty} = 300 \\ \\mathrm{K}$, $T_s = 300 \\ \\mathrm{K}$,\n   - $T_{\\text{true}} = 800 \\ \\mathrm{K}$, $T_{\\mathrm{ref}} = 780 \\ \\mathrm{K}$,\n   - $s_n = 500 \\ \\mathrm{W/m^2}$, $m_0 = 780 \\ \\mathrm{K}$, $s_0 = 50 \\ \\mathrm{K}$,\n   - Grid: $T \\in [400, 1200] \\ \\mathrm{K}$ with $5001$ uniformly spaced points.\n2. Case B (boundary case, strong nonlinearity and large mismatch in linearization point):\n   - $h = 20 \\ \\mathrm{W/(m^2\\cdot K)}$, $\\epsilon = 0.9$, $T_{\\infty} = 300 \\ \\mathrm{K}$, $T_s = 300 \\ \\mathrm{K}$,\n   - $T_{\\text{true}} = 1200 \\ \\mathrm{K}$, $T_{\\mathrm{ref}} = 800 \\ \\mathrm{K}$,\n   - $s_n = 300 \\ \\mathrm{W/m^2}$, $m_0 = 900 \\ \\mathrm{K}$, $s_0 = 200 \\ \\mathrm{K}$,\n   - Grid: $T \\in [600, 1500] \\ \\mathrm{K}$ with $5001$ uniformly spaced points.\n3. Case C (edge case, convection-dominated, low emissivity):\n   - $h = 200 \\ \\mathrm{W/(m^2\\cdot K)}$, $\\epsilon = 0.1$, $T_{\\infty} = 300 \\ \\mathrm{K}$, $T_s = 300 \\ \\mathrm{K}$,\n   - $T_{\\text{true}} = 350 \\ \\mathrm{K}$, $T_{\\mathrm{ref}} = 350 \\ \\mathrm{K}$,\n   - $s_n = 50 \\ \\mathrm{W/m^2}$, $m_0 = 330 \\ \\mathrm{K}$, $s_0 = 10 \\ \\mathrm{K}$,\n   - Grid: $T \\in [300, 500] \\ \\mathrm{K}$ with $5001$ uniformly spaced points.\n\nUnits and outputs:\n- Express the gradient discrepancy $\\Delta g$ in $\\mathrm{K^{-1}}$ and the bias $\\Delta \\mu$ in $\\mathrm{K}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[\\Delta g_A, \\Delta \\mu_A, \\Delta g_B, \\Delta \\mu_B, \\Delta g_C, \\Delta \\mu_C]$, where the subscripts denote the case labels.\n\nYour derivation must start from Newton's law of cooling and the Stefan–Boltzmann law and proceed to the posterior construction without introducing shortcut formulas beyond first-order Taylor linearization. All symbols in mathematical expressions must be written in LaTeX. The final answers for each test case must be real numbers (floats).",
            "solution": "We begin with the physical basis of convective and radiative heat transfer at a boundary. The net boundary heat flux directed outward from the surface at temperature $T$ into an environment is the sum of the convective and radiative contributions. Newton's law of cooling provides the convective heat flux:\n$$\nq_{\\text{conv}}(T) = h \\left( T - T_{\\infty} \\right),\n$$\nwhere $h$ is the convective heat transfer coefficient and $T_{\\infty}$ is the ambient fluid temperature. The Stefan–Boltzmann law provides the net radiative heat exchange between a gray diffuse surface and a large surrounding enclosure at temperature $T_{s}$:\n$$\nq_{\\text{rad}}(T) = \\epsilon \\sigma \\left( T^4 - T_{s}^4 \\right),\n$$\nwhere $\\epsilon$ is the emissivity and $\\sigma$ is the Stefan–Boltzmann constant. Summing these yields the exact boundary heat flux:\n$$\nq_{\\text{exact}}(T) = q_{\\text{conv}}(T) + q_{\\text{rad}}(T) = h \\left( T - T_{\\infty} \\right) + \\epsilon \\sigma \\left( T^4 - T_{s}^4 \\right).\n$$\nThe derivative of $q_{\\text{exact}}(T)$ with respect to $T$ follows from differentiation of each term:\n$$\n\\frac{dq_{\\text{exact}}}{dT}(T) = h + \\epsilon \\sigma \\cdot 4 T^3.\n$$\n\nTo construct a linearized radiation model, we perform a first-order Taylor expansion of $T^4$ about a chosen reference temperature $T_{\\mathrm{ref}}$. For a smooth function $f(T)$, the first-order Taylor expansion about $T_{\\mathrm{ref}}$ is $f(T) \\approx f(T_{\\mathrm{ref}}) + f'(T_{\\mathrm{ref}}) (T - T_{\\mathrm{ref}})$. Applying this to $f(T) = T^4$ yields:\n$$\nT^4 \\approx T_{\\mathrm{ref}}^4 + 4 T_{\\mathrm{ref}}^3 (T - T_{\\mathrm{ref}}) = 4 T_{\\mathrm{ref}}^3 T - 3 T_{\\mathrm{ref}}^4.\n$$\nSubstituting the linearized $T^4$ into the radiative term while leaving $T_{s}^4$ as a constant produces the linearized boundary heat flux:\n$$\nq_{\\text{lin}}(T) = h \\left( T - T_{\\infty} \\right) + \\epsilon \\sigma \\left( 4 T_{\\mathrm{ref}}^3 T - 3 T_{\\mathrm{ref}}^4 - T_{s}^4 \\right).\n$$\nThe derivative of $q_{\\text{lin}}(T)$ with respect to $T$ is constant with respect to $T$:\n$$\n\\frac{dq_{\\text{lin}}}{dT}(T) = h + \\epsilon \\sigma \\cdot 4 T_{\\mathrm{ref}}^3.\n$$\n\nWe adopt a Gaussian measurement model. Given a single scalar measurement $y$ of the boundary heat flux and Gaussian observational noise with standard deviation $s_n$, the likelihood of $T$ is:\n$$\n\\mathcal{L}(y \\mid T) \\propto \\exp\\left( -\\frac{(y - q(T))^2}{2 s_n^2} \\right),\n$$\nwhere $q(T)$ denotes either $q_{\\text{exact}}(T)$ or $q_{\\text{lin}}(T)$. The prior on $T$ is Gaussian:\n$$\n\\pi(T) \\propto \\exp\\left( -\\frac{(T - m_0)^2}{2 s_0^2} \\right),\n$$\nwith mean $m_0$ and standard deviation $s_0$. The posterior density is proportional to the product of the likelihood and the prior:\n$$\np(T \\mid y) \\propto \\exp\\left( -\\frac{(y - q(T))^2}{2 s_n^2} - \\frac{(T - m_0)^2}{2 s_0^2} \\right).\n$$\nCorrespondingly, the negative log-posterior is:\n$$\n\\Phi(T) = \\frac{(y - q(T))^2}{2 s_n^2} + \\frac{(T - m_0)^2}{2 s_0^2} + C,\n$$\nwhere $C$ is independent of $T$. Differentiating $\\Phi(T)$ with respect to $T$ yields the gradient:\n$$\n\\frac{d\\Phi}{dT}(T) = -\\frac{(y - q(T))}{s_n^2} \\frac{dq}{dT}(T) + \\frac{T - m_0}{s_0^2}.\n$$\n\nWe now consider the special case where the data are noise-free and generated by the exact model at the true temperature:\n$$\ny = q_{\\text{exact}}(T_{\\text{true}}).\n$$\nEvaluating the gradient at $T = T_{\\text{true}}$, we find for the exact model:\n$$\n\\left. \\frac{d\\Phi_{\\text{exact}}}{dT} \\right|_{T_{\\text{true}}} = -\\frac{\\left( y - q_{\\text{exact}}(T_{\\text{true}}) \\right)}{s_n^2} \\left. \\frac{dq_{\\text{exact}}}{dT} \\right|_{T_{\\text{true}}} + \\frac{T_{\\text{true}} - m_0}{s_0^2}\n= 0 + \\frac{T_{\\text{true}} - m_0}{s_0^2},\n$$\nbecause $y - q_{\\text{exact}}(T_{\\text{true}}) = 0$. For the linearized model evaluated at $T_{\\text{true}}$ using the same $y$,\n$$\n\\left. \\frac{d\\Phi_{\\text{lin}}}{dT} \\right|_{T_{\\text{true}}} = -\\frac{\\left( y - q_{\\text{lin}}(T_{\\text{true}}) \\right)}{s_n^2} \\left( h + 4 \\epsilon \\sigma T_{\\mathrm{ref}}^3 \\right) + \\frac{T_{\\text{true}} - m_0}{s_0^2}.\n$$\nThe absolute discrepancy in gradients at $T_{\\text{true}}$ is then\n$$\n\\Delta g = \\left| \\left. \\frac{d\\Phi_{\\text{lin}}}{dT} \\right|_{T_{\\text{true}}} - \\left. \\frac{d\\Phi_{\\text{exact}}}{dT} \\right|_{T_{\\text{true}}} \\right| = \\left| \\frac{\\left( q_{\\text{exact}}(T_{\\text{true}}) - q_{\\text{lin}}(T_{\\text{true}}) \\right)}{s_n^2} \\left( h + 4 \\epsilon \\sigma T_{\\mathrm{ref}}^3 \\right) \\right|.\n$$\nThis expression shows that the gradient discrepancy arises purely from the model mismatch in the likelihood term when $y$ is generated by the exact model.\n\nNext, we form the posterior densities numerically on a uniform grid over a specified interval $[T_{\\min}, T_{\\max}]$ using the unnormalized densities\n$$\n\\tilde{p}_{\\text{exact}}(T) = \\exp\\left( -\\frac{(y - q_{\\text{exact}}(T))^2}{2 s_n^2} - \\frac{(T - m_0)^2}{2 s_0^2} \\right),\n\\quad\n\\tilde{p}_{\\text{lin}}(T) = \\exp\\left( -\\frac{(y - q_{\\text{lin}}(T))^2}{2 s_n^2} - \\frac{(T - m_0)^2}{2 s_0^2} \\right).\n$$\nTo improve numerical stability, we subtract the maximum of the log-densities before exponentiation (the log-sum-exp trick). We then compute the posterior mean for each model by numerical quadrature:\n$$\n\\mu_{\\text{exact}} = \\frac{\\int_{T_{\\min}}^{T_{\\max}} T \\, \\tilde{p}_{\\text{exact}}(T) \\, dT}{\\int_{T_{\\min}}^{T_{\\max}} \\tilde{p}_{\\text{exact}}(T) \\, dT},\n\\quad\n\\mu_{\\text{lin}} = \\frac{\\int_{T_{\\min}}^{T_{\\max}} T \\, \\tilde{p}_{\\text{lin}}(T) \\, dT}{\\int_{T_{\\min}}^{T_{\\max}} \\tilde{p}_{\\text{lin}}(T) \\, dT}.\n$$\nWe quantify the bias introduced by the linearization as\n$$\n\\Delta \\mu = \\mu_{\\text{lin}} - \\mu_{\\text{exact}}.\n$$\n\nAlgorithmic design:\n- For each test case, compute $y = q_{\\text{exact}}(T_{\\text{true}})$.\n- Evaluate $q_{\\text{exact}}(T_{\\text{true}})$, $q_{\\text{lin}}(T_{\\text{true}})$, $\\frac{dq_{\\text{exact}}}{dT}(T_{\\text{true}})$, and $\\frac{dq_{\\text{lin}}}{dT}(T_{\\text{true}})$, then compute $\\Delta g$ via the formula above.\n- Construct a uniform grid $T$ over the specified interval. Compute the log of the unnormalized posteriors for both models on this grid. Stabilize by subtracting the maximum log density before exponentiation. Use numerical integration (trapezoidal rule) to compute the normalization constants and the posterior means. Compute $\\Delta \\mu$ as the difference between the two means.\n- Aggregate the results for Case A, Case B, and Case C into a single list ordered as $[\\Delta g_A, \\Delta \\mu_A, \\Delta g_B, \\Delta \\mu_B, \\Delta g_C, \\Delta \\mu_C]$.\n- The gradient discrepancy $\\Delta g$ has units of $\\mathrm{K^{-1}}$ and the bias $\\Delta \\mu$ has units of $\\mathrm{K}$; the printed outputs are real numbers corresponding to these quantities.\n\nThis procedure directly compares the inverse reconstructions across the exact and linearized radiation models, assessing the impact of linearization on gradient-based inference and on posterior expectations. The gradient comparison evaluates local behavior at the true temperature, while the posterior mean comparison captures global inference bias arising from the approximation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Stefan–Boltzmann constant\nSIGMA = 5.670374419e-8  # W/(m^2*K^4)\n\ndef q_exact(T, h, eps, T_inf, T_s):\n    \"\"\"Exact combined convection + radiation boundary heat flux.\"\"\"\n    return h * (T - T_inf) + eps * SIGMA * (T**4 - T_s**4)\n\ndef dq_exact_dT(T, h, eps):\n    \"\"\"Derivative of exact flux with respect to T.\"\"\"\n    return h + eps * SIGMA * 4.0 * (T**3)\n\ndef q_lin(T, h, eps, T_inf, T_s, T_ref):\n    \"\"\"Linearized radiation: first-order Taylor expansion of T^4 about T_ref.\"\"\"\n    return h * (T - T_inf) + eps * SIGMA * (4.0 * (T_ref**3) * T - 3.0 * (T_ref**4) - T_s**4)\n\ndef dq_lin_dT(h, eps, T_ref):\n    \"\"\"Derivative of linearized flux with respect to T (constant).\"\"\"\n    return h + eps * SIGMA * 4.0 * (T_ref**3)\n\ndef posterior_stats(y, h, eps, T_inf, T_s, T_ref, s_n, m0, s0, T_min, T_max, n_grid, model='exact'):\n    \"\"\"Compute posterior mean via numerical quadrature for either exact or linearized model.\"\"\"\n    T_grid = np.linspace(T_min, T_max, n_grid)\n    if model == 'exact':\n        q_vals = q_exact(T_grid, h, eps, T_inf, T_s)\n    elif model == 'lin':\n        q_vals = q_lin(T_grid, h, eps, T_inf, T_s, T_ref)\n    else:\n        raise ValueError(\"model must be 'exact' or 'lin'\")\n    # Log unnormalized posterior\n    log_like = -0.5 * ((y - q_vals) ** 2) / (s_n ** 2)\n    log_prior = -0.5 * ((T_grid - m0) ** 2) / (s0 ** 2)\n    log_post = log_like + log_prior\n    # Stabilize\n    log_post -= np.max(log_post)\n    w = np.exp(log_post)\n    # Numerical integration via trapezoidal rule\n    Z = np.trapz(w, T_grid)\n    mean = np.trapz(T_grid * w, T_grid) / Z\n    return mean\n\ndef compute_case(params):\n    \"\"\"Compute metrics for one test case.\"\"\"\n    h = params['h']\n    eps = params['eps']\n    T_inf = params['T_inf']\n    T_s = params['T_s']\n    T_true = params['T_true']\n    T_ref = params['T_ref']\n    s_n = params['s_n']\n    m0 = params['m0']\n    s0 = params['s0']\n    T_min = params['T_min']\n    T_max = params['T_max']\n    n_grid = params['n_grid']\n\n    # Generate noise-free measurement from exact model\n    y = q_exact(T_true, h, eps, T_inf, T_s)\n\n    # Gradients at T_true\n    dq_exact = dq_exact_dT(T_true, h, eps)\n    dq_lin = dq_lin_dT(h, eps, T_ref)\n\n    # Negative log-posterior gradients\n    g_exact = -((y - q_exact(T_true, h, eps, T_inf, T_s)) / (s_n ** 2)) * dq_exact + (T_true - m0) / (s0 ** 2)\n    g_lin = -((y - q_lin(T_true, h, eps, T_inf, T_s, T_ref)) / (s_n ** 2)) * dq_lin + (T_true - m0) / (s0 ** 2)\n\n    delta_g = abs(g_lin - g_exact)  # in 1/K\n\n    # Posterior means\n    mu_exact = posterior_stats(y, h, eps, T_inf, T_s, T_ref, s_n, m0, s0, T_min, T_max, n_grid, model='exact')\n    mu_lin = posterior_stats(y, h, eps, T_inf, T_s, T_ref, s_n, m0, s0, T_min, T_max, n_grid, model='lin')\n\n    delta_mu = mu_lin - mu_exact  # in K\n\n    return float(delta_g), float(delta_mu)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'label': 'A',\n            'h': 50.0,\n            'eps': 0.8,\n            'T_inf': 300.0,\n            'T_s': 300.0,\n            'T_true': 800.0,\n            'T_ref': 780.0,\n            's_n': 500.0,\n            'm0': 780.0,\n            's0': 50.0,\n            'T_min': 400.0,\n            'T_max': 1200.0,\n            'n_grid': 5001\n        },\n        {\n            'label': 'B',\n            'h': 20.0,\n            'eps': 0.9,\n            'T_inf': 300.0,\n            'T_s': 300.0,\n            'T_true': 1200.0,\n            'T_ref': 800.0,\n            's_n': 300.0,\n            'm0': 900.0,\n            's0': 200.0,\n            'T_min': 600.0,\n            'T_max': 1500.0,\n            'n_grid': 5001\n        },\n        {\n            'label': 'C',\n            'h': 200.0,\n            'eps': 0.1,\n            'T_inf': 300.0,\n            'T_s': 300.0,\n            'T_true': 350.0,\n            'T_ref': 350.0,\n            's_n': 50.0,\n            'm0': 330.0,\n            's0': 10.0,\n            'T_min': 300.0,\n            'T_max': 500.0,\n            'n_grid': 5001\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_g, delta_mu = compute_case(case)\n        results.append(delta_g)\n        results.append(delta_mu)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}