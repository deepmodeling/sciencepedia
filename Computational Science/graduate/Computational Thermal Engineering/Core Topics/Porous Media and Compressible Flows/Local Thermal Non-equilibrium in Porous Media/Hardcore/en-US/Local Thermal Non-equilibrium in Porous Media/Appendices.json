{
    "hands_on_practices": [
        {
            "introduction": "The two-equation model for Local Thermal Non-Equilibrium (LTNE) relies on parameters that connect the macroscopic equations to the underlying microscopic structure of the porous medium. A key parameter is the interfacial area density, $a_{sf}$, which quantifies the available surface area for heat exchange between the solid and fluid phases per unit volume. This exercise  provides essential practice in deriving such parameters from fundamental geometric principles, using the common example of a packed bed of spheres.",
            "id": "3968734",
            "problem": "A two-energy-equation model for Local Thermal Non-Equilibrium (LTNE) in porous media introduces an interphase heat exchange term of the form $h_{sf}\\, a_{sf} \\left(T_{s}-T_{f}\\right)$, where $h_{sf}$ is the interfacial heat transfer coefficient, $a_{sf}$ is the interfacial area density between solid and fluid, and $T_{s}$ and $T_{f}$ are the solid and fluid temperatures, respectively. Consider a fixed packed bed composed of monodisperse, non-porous, smooth spheres of diameter $d_{p}$, arranged with porosity $\\varepsilon$ and fully saturated by a single-phase fluid. Assume that the particle contacts occupy a negligible fraction of the surface, that a Representative Elementary Volume (REV) exists, and that the bed is macroscopically homogeneous and isotropic.\n\nStarting only from fundamental geometric relations and definitions, derive the interfacial area density $a_{sf}$ as the total solid–fluid interfacial area per total REV volume, expressed in terms of $d_{p}$ and $\\varepsilon$. Your derivation must begin from the definition of porosity $\\varepsilon$, the surface area and volume of a sphere, and the definition of $a_{sf}$ as an interfacial area per unit total volume, without invoking any pre-memorized shortcut formulas.\n\nExpress your final result for $a_{sf}$ in $\\mathrm{m}^{-1}$. Provide the final answer as a single closed-form symbolic expression in terms of $d_{p}$ and $\\varepsilon$. Do not substitute numerical values and do not approximate.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of heat transfer in porous media, is well-posed with sufficient information for a unique solution, and is stated in objective, formal language. We shall now proceed with its solution.\n\nThe objective is to derive an expression for the interfacial area density, $a_{sf}$, for a packed bed of monodisperse spheres. The derivation will be built from fundamental definitions as stipulated.\n\nLet us consider a Representative Elementary Volume (REV) of the porous medium, with a total volume denoted as $V_{\\text{total}}$. This total volume is composed of the volume occupied by the solid phase, $V_{s}$, and the volume occupied by the fluid phase (the void or pore volume), $V_{f}$.\n$$V_{\\text{total}} = V_{s} + V_{f}$$\n\nThe porosity, $\\varepsilon$, is defined as the fraction of the total volume of the REV that is occupied by the fluid.\n$$\\varepsilon = \\frac{V_{f}}{V_{\\text{total}}}$$\nConsequently, the solid fraction, which is the volume fraction occupied by the solid phase, is given by:\n$$1 - \\varepsilon = \\frac{V_{s}}{V_{\\text{total}}}$$\n\nThe interfacial area density, $a_{sf}$, is defined as the total solid-fluid interfacial area, $A_{sf}$, per unit total volume of the REV.\n$$a_{sf} = \\frac{A_{sf}}{V_{\\text{total}}}$$\n\nThe solid phase consists of monodisperse, non-porous spheres, each with a diameter $d_{p}$. The volume and surface area of a single sphere are given by the standard geometric formulas:\nVolume of a single sphere: $V_{\\text{sphere}} = \\frac{4}{3}\\pi \\left(\\frac{d_{p}}{2}\\right)^{3} = \\frac{1}{6}\\pi d_{p}^{3}$\nSurface area of a single sphere: $A_{\\text{sphere}} = 4\\pi \\left(\\frac{d_{p}}{2}\\right)^{2} = \\pi d_{p}^{2}$\n\nLet $N$ be the number of spheres contained within the REV of total volume $V_{\\text{total}}$. The total volume of the solid phase, $V_{s}$, is the product of the number of spheres and the volume of a single sphere.\n$$V_{s} = N \\cdot V_{\\text{sphere}} = N \\left(\\frac{1}{6}\\pi d_{p}^{3}\\right)$$\n\nThe problem states that particle contacts occupy a negligible fraction of the surface area. Therefore, the total solid-fluid interfacial area, $A_{sf}$, can be taken as the total surface area of all spheres in the REV.\n$$A_{sf} = N \\cdot A_{\\text{sphere}} = N \\left(\\pi d_{p}^{2}\\right)$$\n\nOur goal is to express $a_{sf}$ in terms of $\\varepsilon$ and $d_{p}$. To achieve this, we must eliminate the quantities $N$ and $V_{\\text{total}}$ from the expression for $a_{sf}$. We can establish a relationship between these quantities using the definition of the solid fraction.\n\nFrom the solid fraction definition, we have:\n$$1 - \\varepsilon = \\frac{V_{s}}{V_{\\text{total}}} = \\frac{N \\left(\\frac{1}{6}\\pi d_{p}^{3}\\right)}{V_{\\text{total}}}$$\nThis equation relates the macroscopic property $\\varepsilon$ to the microscopic properties of the particles. We can rearrange this to express the number of particles per unit total volume, $\\frac{N}{V_{\\text{total}}}$:\n$$\\frac{N}{V_{\\text{total}}} = \\frac{6(1 - \\varepsilon)}{\\pi d_{p}^{3}}$$\n\nNow, we return to the definition of the interfacial area density, $a_{sf}$:\n$$a_{sf} = \\frac{A_{sf}}{V_{\\text{total}}} = \\frac{N \\left(\\pi d_{p}^{2}\\right)}{V_{\\text{total}}}$$\nWe can rewrite this as:\n$$a_{sf} = \\left(\\frac{N}{V_{\\text{total}}}\\right) \\left(\\pi d_{p}^{2}\\right)$$\n\nSubstituting the expression for the particle number density, $\\frac{N}{V_{\\text{total}}}$, that we derived from the porosity definition:\n$$a_{sf} = \\left(\\frac{6(1 - \\varepsilon)}{\\pi d_{p}^{3}}\\right) \\left(\\pi d_{p}^{2}\\right)$$\n\nFinally, we simplify the expression by canceling common terms. The term $\\pi$ in the numerator and denominator cancels out. The term $d_{p}^{2}$ in the numerator cancels with two of the three powers of $d_{p}$ in the denominator, leaving a single $d_{p}$ in the denominator.\n$$a_{sf} = \\frac{6(1 - \\varepsilon)}{d_{p}}$$\n\nThis is the desired expression for the interfacial area density for a packed bed of monodisperse spheres, derived from first principles. The units are consistent, as $1-\\varepsilon$ is dimensionless and $d_{p}$ has units of length (e.g., meters, $\\mathrm{m}$), yielding units of $\\mathrm{m}^{-1}$ for $a_{sf}$.",
            "answer": "$$\\boxed{\\frac{6(1 - \\varepsilon)}{d_{p}}}$$"
        },
        {
            "introduction": "With the model parameters defined, we can analyze the core physical behavior predicted by the LTNE equations. This practice  focuses on the fundamental dynamic of interphase heat exchange: the process of thermal relaxation. By deriving the characteristic time constant for the temperature difference between the phases to decay, you will develop a physical intuition for how quickly a system approaches thermal equilibrium and which properties govern this process.",
            "id": "3968695",
            "problem": "Consider a homogeneous, rigid porous medium saturated by a single-phase fluid, modeled under the Local Thermal Non-Equilibrium (LTNE) assumption at the scale of the Representative Elementary Volume (REV). Let the solid-phase temperature be $T_{s}(t)$ and the fluid-phase temperature be $T_{f}(t)$, both assumed spatially uniform (no spatial gradients). The porosity is $\\varepsilon$, the fluid mass density is $\\rho_{f}$, the fluid specific heat at constant pressure is $c_{pf}$, the solid mass density is $\\rho_{s}$, and the solid specific heat is $c_{ps}$. The interfacial area density (area per unit bulk volume) is $a_{sf}$, and the interfacial heat transfer coefficient is $h_{sf}$. Assume all properties are constant, there are no external sources or sinks, and that the only thermal interaction between phases is interfacial heat exchange.\n\nStarting from energy conservation formulated for each phase (fluid and solid) under these assumptions, and without invoking any additional constitutive shortcuts beyond the interfacial exchange term, derive the governing ordinary differential equation for the temperature difference $\\theta(t) = T_{s}(t) - T_{f}(t)$, and from it obtain the characteristic relaxation time $\\tau$ that determines the exponential decay of $\\theta(t)$. Provide the relaxation time as a closed-form analytic expression. Express the relaxation time in seconds. Do not provide intermediate results; report only the final expression for the relaxation time.",
            "solution": "The Local Thermal Non-Equilibrium (LTNE) framework treats the fluid and solid phases as having distinct temperatures $T_{f}(t)$ and $T_{s}(t)$ at the Representative Elementary Volume (REV) scale. Under spatially uniform conditions (no macroscopic gradients), the energy conservation for each phase reduces to lumped energy balances where the only coupling is interfacial heat exchange.\n\nFor the fluid phase, the energy stored per unit bulk volume is $\\varepsilon \\rho_{f} c_{pf} T_{f}$, so the rate of change of stored energy is $\\varepsilon \\rho_{f} c_{pf} \\,\\frac{d T_{f}}{d t}$. The interfacial heat exchange per unit bulk volume flowing into the fluid from the solid is modeled as $h_{sf} a_{sf} (T_{s} - T_{f})$. In the absence of external sources or sinks, the fluid energy balance is\n$$\n\\varepsilon \\rho_{f} c_{pf} \\,\\frac{d T_{f}}{d t} = h_{sf} a_{sf} \\left( T_{s} - T_{f} \\right).\n$$\n\nFor the solid phase, the energy stored per unit bulk volume is $(1 - \\varepsilon) \\rho_{s} c_{ps} T_{s}$, and the interfacial heat exchange per unit bulk volume flowing out of the solid and into the fluid is $h_{sf} a_{sf} (T_{s} - T_{f})$, but with the opposite sign in the solid balance. Hence\n$$\n(1 - \\varepsilon) \\rho_{s} c_{ps} \\,\\frac{d T_{s}}{d t} = -\\, h_{sf} a_{sf} \\left( T_{s} - T_{f} \\right).\n$$\n\nDefine the temperature difference\n$$\n\\theta(t) = T_{s}(t) - T_{f}(t).\n$$\nDifferentiate $\\theta$ with respect to time:\n$$\n\\frac{d \\theta}{d t} = \\frac{d T_{s}}{d t} - \\frac{d T_{f}}{d t}.\n$$\nSolve each balance for the time derivatives. From the solid balance,\n$$\n\\frac{d T_{s}}{d t} = -\\, \\frac{h_{sf} a_{sf}}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\left( T_{s} - T_{f} \\right)\n= -\\, \\frac{h_{sf} a_{sf}}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\,\\theta.\n$$\nFrom the fluid balance,\n$$\n\\frac{d T_{f}}{d t} = \\frac{h_{sf} a_{sf}}{\\varepsilon \\rho_{f} c_{pf}} \\left( T_{s} - T_{f} \\right)\n= \\frac{h_{sf} a_{sf}}{\\varepsilon \\rho_{f} c_{pf}} \\,\\theta.\n$$\nSubstitute into $\\frac{d \\theta}{d t}$:\n$$\n\\frac{d \\theta}{d t} = -\\, \\frac{h_{sf} a_{sf}}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\,\\theta\n- \\frac{h_{sf} a_{sf}}{\\varepsilon \\rho_{f} c_{pf}} \\,\\theta\n= -\\, h_{sf} a_{sf} \\left( \\frac{1}{(1 - \\varepsilon) \\rho_{s} c_{ps}} + \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} \\right) \\theta.\n$$\n\nThis is a first-order linear ordinary differential equation with constant coefficient, of the form\n$$\n\\frac{d \\theta}{d t} = -\\, \\lambda \\,\\theta,\n$$\nwhere\n$$\n\\lambda = h_{sf} a_{sf} \\left( \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} + \\frac{1}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\right).\n$$\nThe solution is exponential decay,\n$$\n\\theta(t) = \\theta(0) \\,\\exp\\!\\left( -\\, \\lambda \\, t \\right).\n$$\nThe characteristic relaxation time $\\tau$ is defined by $\\theta(t) = \\theta(0) \\exp\\!\\left( - t / \\tau \\right)$, so $\\tau = 1 / \\lambda$. Therefore,\n$$\n\\tau = \\frac{1}{h_{sf} a_{sf} \\left( \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} + \\frac{1}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\right)}.\n$$\nThis expression has units of time and is to be expressed in seconds.",
            "answer": "$$\\boxed{\\frac{1}{h_{sf} a_{sf} \\left( \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} + \\frac{1}{(1-\\varepsilon) \\rho_{s} c_{ps}} \\right)}}$$"
        },
        {
            "introduction": "Translating the LTNE partial differential equations into a solvable numerical model presents significant practical challenges, particularly the issue of numerical stiffness. This comprehensive exercise  guides you from the theoretical analysis of this stiffness—which arises from a large disparity in time scales—to the design of an effective computational solution. You will develop and analyze an Implicit-Explicit (IMEX) scheme, a powerful technique used in modern computational codes to efficiently simulate multi-scale physical phenomena like LTNE.",
            "id": "3968701",
            "problem": "Consider a one-dimensional saturated porous medium modeled under Local Thermal Non-Equilibrium (LTNE), where the fluid and solid phases have separate temperatures. Let $x \\in [0,L]$ denote space, and let the fluid temperature be $T_f(x,t)$ and the solid temperature be $T_s(x,t)$. The volumetric heat capacities are $C_f = \\varepsilon \\rho_f c_{pf}$ and $C_s = (1-\\varepsilon)\\rho_s c_{ps}$, where $\\varepsilon$ is porosity, $\\rho_f$ and $\\rho_s$ are densities, and $c_{pf}$ and $c_{ps}$ are specific heats of the fluid and solid phases, respectively. The interphase heat transfer coefficient times specific surface area is $H = h_{sf} a_{sf}$ with units $\\mathrm{W\\,m^{-3}\\,K^{-1}}$. The solid has thermal conductivity $k_s$ in $\\mathrm{W\\,m^{-1}\\,K^{-1}}$, and the fluid advects with a uniform velocity $u$ in $\\mathrm{m\\,s^{-1}}$. Neglect axial conduction in the fluid and any internal heat sources.\n\nThe governing LTNE energy balances are\n$$\nC_f \\frac{\\partial T_f}{\\partial t} + C_f u \\frac{\\partial T_f}{\\partial x} = H \\left( T_s - T_f \\right),\n$$\n$$\nC_s \\frac{\\partial T_s}{\\partial t} = k_s \\frac{\\partial^2 T_s}{\\partial x^2} + H \\left( T_f - T_s \\right).\n$$\nDiscretize space using $N$ uniform grid points with grid spacing $\\Delta x = L/N$ and periodic boundary conditions. Approximate the fluid convection term using first-order upwind differencing, $\\partial T_f/\\partial x \\approx \\left(T_{f,i}-T_{f,i-1}\\right)/\\Delta x$ for $u0$, and approximate the solid diffusion term using second-order central differencing, $\\partial^2 T_s/\\partial x^2 \\approx \\left(T_{s,i+1}-2T_{s,i}+T_{s,i-1}\\right)/\\Delta x^2$. This yields a semi-discrete system of ordinary differential equations for the nodal temperatures.\n\nTask 1 (derivation and explanation): Starting from the semi-discrete nodal balances, isolate the contribution of the interphase exchange term at a single node $i$ by temporarily neglecting convection and diffusion. Show that the exchange-only linear system for $\\left[T_{f,i}(t),T_{s,i}(t)\\right]^\\top$ has the Jacobian\n$$\n\\mathbf{M} = \\begin{bmatrix}\n-\\dfrac{H}{C_f}  \\dfrac{H}{C_f} \\\\\n\\dfrac{H}{C_s}  -\\dfrac{H}{C_s}\n\\end{bmatrix},\n$$\nand compute its eigenvalues. Explain why a large $H$ induces stiffness in the full semi-discrete ordinary differential equation system by comparing the characteristic exchange time scale to the convective and diffusive time scales.\n\nTask 2 (scheme design): Propose an Implicit-Explicit (IMEX) time integration scheme that treats the interphase exchange term implicitly while keeping the fluid convection term explicit. Use forward Euler for the explicit contributions and backward Euler for the implicit exchange coupling. Derive a per-node $2\\times 2$ linear system for $\\left[T_{f,i}^{n+1},T_{s,i}^{n+1}\\right]^\\top$ at each time step $\\Delta t$, in terms of known explicit right-hand sides computed from $\\left[T_{f}^{n},T_{s}^{n}\\right]$.\n\nTask 3 (stability bounds): Using first-order upwind for fluid advection and explicit Euler time stepping, the convective Courant-Friedrichs-Lewy condition gives a bound\n$$\n\\Delta t_{\\mathrm{conv}} \\le \\frac{\\Delta x}{u} \\quad \\text{for } u0.\n$$\nUsing explicit Euler for the solid diffusion with central differencing, derive the bound\n$$\n\\Delta t_{\\mathrm{diff}} \\le \\frac{C_s \\Delta x^2}{2 k_s}.\n$$\nFor the exchange-only explicit Euler update, use the exchange Jacobian eigenvalues to show the bound\n$$\n\\Delta t_{\\mathrm{exch}} \\le \\frac{2}{H\\left(\\dfrac{1}{C_f}+\\dfrac{1}{C_s}\\right)}.\n$$\nExplain why the IMEX scheme that treats exchange implicitly removes the $\\Delta t_{\\mathrm{exch}}$ restriction while retaining the explicit convection and diffusion restrictions.\n\nTask 4 (program and outputs): Write a complete, runnable program that, for each test case provided below, computes the maximum stable time step for a fully explicit scheme\n$$\n\\Delta t_{\\mathrm{explicit}} = \\min\\left\\{\\Delta t_{\\mathrm{conv}},\\ \\Delta t_{\\mathrm{diff}},\\ \\Delta t_{\\mathrm{exch}}\\right\\},\n$$\nand for the proposed IMEX scheme\n$$\n\\Delta t_{\\mathrm{IMEX}} = \\min\\left\\{\\Delta t_{\\mathrm{conv}},\\ \\Delta t_{\\mathrm{diff}}\\right\\}.\n$$\nThe program must output, for each test case, the improvement factor defined as the dimensionless float\n$$\n\\mathcal{I} = \\frac{\\Delta t_{\\mathrm{IMEX}}}{\\Delta t_{\\mathrm{explicit}}}.\n$$\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"). Each result must be rounded to six decimal places. All input physical parameters are specified in the International System of Units (SI), and the computed time steps are in seconds; the improvement factor is dimensionless.\n\nTest suite (use exactly these four cases):\n- Case 1 (moderately large interphase exchange): $\\varepsilon=0.7$, $\\rho_f=1000\\ \\mathrm{kg\\,m^{-3}}$, $c_{pf}=4180\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $\\rho_s=2600\\ \\mathrm{kg\\,m^{-3}}$, $c_{ps}=800\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $u=0.5\\ \\mathrm{m\\,s^{-1}}$, $L=1.0\\ \\mathrm{m}$, $N=100$, $k_s=2.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$, $H=1\\times 10^{8}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$.\n- Case 2 (extremely large interphase exchange): same as Case 1 but with $H=1\\times 10^{10}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$.\n- Case 3 (no convection, extremely large interphase exchange): same material parameters as Case 1 but with $u=0.0\\ \\mathrm{m\\,s^{-1}}$ and $H=1\\times 10^{10}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$.\n- Case 4 (weak interphase exchange): same as Case 1 but with $H=1\\times 10^{2}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$.\n\nScientific realism requirement: Ensure that all reasoning and computations use the fundamental conservation of energy, consistent discretizations, and stability criteria that follow from standard linear analysis. The final answers must be floats printed in a single Python list as specified. No external input is required, and the output values must be dimensionless improvement factors.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of heat transfer and numerical analysis, well-posed with all necessary parameters, and objective in its formulation. It presents a standard, substantive exercise in computational thermal engineering. We may therefore proceed with the solution.\n\nThe solution is presented in four parts, corresponding to the four tasks outlined in the problem statement.\n\nTask 1: Derivation of the Exchange-Only Jacobian, Eigenvalues, and Stiffness Analysis\n\nThe governing energy balance equations for the fluid and solid phases are given as:\n$$\nC_f \\frac{\\partial T_f}{\\partial t} + C_f u \\frac{\\partial T_f}{\\partial x} = H \\left( T_s - T_f \\right)\n$$\n$$\nC_s \\frac{\\partial T_s}{\\partial t} = k_s \\frac{\\partial^2 T_s}{\\partial x^2} + H \\left( T_f - T_s \\right)\n$$\nAfter spatial discretization at a node $i$, the semi-discrete system of ordinary differential equations (ODEs) is:\n$$\n\\frac{dT_{f,i}}{dt} = -u \\frac{T_{f,i} - T_{f, i-1}}{\\Delta x} + \\frac{H}{C_f} (T_{s,i} - T_{f,i})\n$$\n$$\n\\frac{dT_{s,i}}{dt} = \\frac{k_s}{C_s} \\frac{T_{s,i+1} - 2T_{s,i} + T_{s,i-1}}{\\Delta x^2} + \\frac{H}{C_s} (T_{f,i} - T_{s,i})\n$$\nTo analyze the interphase exchange term in isolation, we neglect the transport terms (convection and diffusion):\n$$\n\\frac{dT_{f,i}}{dt} = \\frac{H}{C_f} (T_{s,i} - T_{f,i}) = -\\frac{H}{C_f} T_{f,i} + \\frac{H}{C_f} T_{s,i}\n$$\n$$\n\\frac{dT_{s,i}}{dt} = \\frac{H}{C_s} (T_{f,i} - T_{s,i}) = \\frac{H}{C_s} T_{f,i} - \\frac{H}{C_s} T_{s,i}\n$$\nThis system can be written in matrix form for the temperature vector $\\mathbf{T}_i(t) = [T_{f,i}(t), T_{s,i}(t)]^\\top$ as $\\frac{d\\mathbf{T}_i}{dt} = \\mathbf{M} \\mathbf{T}_i$. The Jacobian matrix $\\mathbf{M}$ is the matrix of partial derivatives of the right-hand side vector with respect to the components of $\\mathbf{T}_i$, which for this linear system is simply the coefficient matrix:\n$$\n\\mathbf{M} = \\begin{bmatrix}\n\\dfrac{\\partial}{\\partial T_{f,i}}\\left(-\\dfrac{H}{C_f} T_{f,i} + \\dfrac{H}{C_f} T_{s,i}\\right)  \\dfrac{\\partial}{\\partial T_{s,i}}\\left(-\\dfrac{H}{C_f} T_{f,i} + \\dfrac{H}{C_f} T_{s,i}\\right) \\\\\n\\dfrac{\\partial}{\\partial T_{f,i}}\\left(\\dfrac{H}{C_s} T_{f,i} - \\dfrac{H}{C_s} T_{s,i}\\right)  \\dfrac{\\partial}{\\partial T_{s,i}}\\left(\\dfrac{H}{C_s} T_{f,i} - \\dfrac{H}{C_s} T_{s,i}\\right)\n\\end{bmatrix} = \\begin{bmatrix}\n-\\dfrac{H}{C_f}  \\dfrac{H}{C_f} \\\\\n\\dfrac{H}{C_s}  -\\dfrac{H}{C_s}\n\\end{bmatrix}\n$$\nThis confirms the specified form of the Jacobian. To find its eigenvalues $\\lambda$, we solve the characteristic equation $\\det(\\mathbf{M} - \\lambda\\mathbf{I}) = 0$:\n$$\n\\det \\begin{bmatrix}\n-\\dfrac{H}{C_f} - \\lambda  \\dfrac{H}{C_f} \\\\\n\\dfrac{H}{C_s}  -\\dfrac{H}{C_s} - \\lambda\n\\end{bmatrix} = 0\n$$\n$$\n\\left(-\\frac{H}{C_f} - \\lambda\\right)\\left(-\\frac{H}{C_s} - \\lambda\\right) - \\left(\\frac{H}{C_f}\\right)\\left(\\frac{H}{C_s}\\right) = 0\n$$\n$$\n\\lambda^2 + \\lambda\\left(\\frac{H}{C_s} + \\frac{H}{C_f}\\right) + \\frac{H^2}{C_f C_s} - \\frac{H^2}{C_f C_s} = 0\n$$\n$$\n\\lambda^2 + \\lambda H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) = 0 \\implies \\lambda \\left[ \\lambda + H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) \\right] = 0\n$$\nThe eigenvalues are $\\lambda_1 = 0$ and $\\lambda_2 = -H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right)$.\n\nStiffness arises when a system of ODEs has characteristic time scales that are widely separated. The time scale associated with an eigenvalue $\\lambda$ is on the order of $1/|\\lambda|$.\n- The eigenvalue $\\lambda_1 = 0$ corresponds to an infinite time scale, representing the conservation of energy within the isolated two-temperature system at a node. The system evolves towards a steady state where $T_f = T_s$, but the total energy is conserved.\n- The eigenvalue $\\lambda_2$ corresponds to the characteristic exchange time scale $\\tau_{\\mathrm{exch}} = 1/|\\lambda_2| = \\frac{1}{H\\left(1/C_f + 1/C_s\\right)}$.\nThe characteristic time scales for convection and diffusion are $\\tau_{\\mathrm{conv}} \\approx \\Delta x/u$ and $\\tau_{\\mathrm{diff}} \\approx C_s \\Delta x^2/k_s$, respectively. When the interphase heat transfer coefficient $H$ is large, $\\tau_{\\mathrm{exch}}$ becomes very small. If $\\tau_{\\mathrm{exch}} \\ll \\tau_{\\mathrm{conv}}$ and $\\tau_{\\mathrm{exch}} \\ll \\tau_{\\mathrm{diff}}$, the system is numerically stiff. Explicit time integration schemes are limited by the smallest time scale in the system to maintain stability, requiring a time step $\\Delta t \\le C/|\\lambda_{\\max}|$, where $\\lambda_{\\max}$ is the eigenvalue with the largest magnitude. For large $H$, this forces an impractically small $\\Delta t$ governed by $\\tau_{\\mathrm{exch}}$, even though the macroscopic evolution of the temperature fields (governed by convection and diffusion) occurs on the much slower time scales $\\tau_{\\mathrm{conv}}$ and $\\tau_{\\mathrm{diff}}$.\n\nTask 2: Design of an IMEX Scheme\n\nWe design an IMEX scheme where the stiff interphase exchange term is treated implicitly (using backward Euler) and the non-stiff transport terms (convection and diffusion) are treated explicitly (using forward Euler). The semi-discrete equations are partitioned as:\n$$\n\\frac{dT_{f,i}}{dt} = \\underbrace{-u \\frac{T_{f,i} - T_{f, i-1}}{\\Delta x}}_{\\text{explicit}} + \\underbrace{\\frac{H}{C_f} (T_{s,i} - T_{f,i})}_{\\text{implicit}}\n$$\n$$\n\\frac{dT_{s,i}}{dt} = \\underbrace{\\frac{k_s}{C_s} \\frac{T_{s,i+1} - 2T_{s,i} + T_{s,i-1}}{\\Delta x^2}}_{\\text{explicit}} + \\underbrace{\\frac{H}{C_s} (T_{f,i} - T_{s,i})}_{\\text{implicit}}\n$$\nLet's define the explicit right-hand side (RHS) terms evaluated at the known time level $n$:\n$$\nR_{f,i}^n = -u \\frac{T_{f,i}^n - T_{f, i-1}^n}{\\Delta x}\n$$\n$$\nR_{s,i}^n = \\frac{k_s}{C_s} \\frac{T_{s,i+1}^n - 2T_{s,i}^n + T_{s,i-1}^n}{\\Delta x^2}\n$$\nApplying the IMEX scheme from time $t_n$ to $t_{n+1} = t_n + \\Delta t$:\n$$\n\\frac{T_{f,i}^{n+1} - T_{f,i}^{n}}{\\Delta t} = R_{f,i}^n + \\frac{H}{C_f} (T_{s,i}^{n+1} - T_{f,i}^{n+1})\n$$\n$$\n\\frac{T_{s,i}^{n+1} - T_{s,i}^{n}}{\\Delta t} = R_{s,i}^n + \\frac{H}{C_s} (T_{f,i}^{n+1} - T_{s,i}^{n+1})\n$$\nWe rearrange these equations to group the unknown terms $T_{f,i}^{n+1}$ and $T_{s,i}^{n+1}$ on the left-hand side:\n$$\nT_{f,i}^{n+1} - \\Delta t \\frac{H}{C_f} (T_{s,i}^{n+1} - T_{f,i}^{n+1}) = T_{f,i}^{n} + \\Delta t R_{f,i}^n\n$$\n$$\nT_{s,i}^{n+1} - \\Delta t \\frac{H}{C_s} (T_{f,i}^{n+1} - T_{s,i}^{n+1}) = T_{s,i}^{n} + \\Delta t R_{s,i}^n\n$$\nFactoring out the unknown temperatures:\n$$\n\\left(1 + \\Delta t \\frac{H}{C_f}\\right) T_{f,i}^{n+1} - \\left(\\Delta t \\frac{H}{C_f}\\right) T_{s,i}^{n+1} = T_{f,i}^{n} + \\Delta t R_{f,i}^n\n$$\n$$\n-\\left(\\Delta t \\frac{H}{C_s}\\right) T_{f,i}^{n+1} + \\left(1 + \\Delta t \\frac{H}{C_s}\\right) T_{s,i}^{n+1} = T_{s,i}^{n} + \\Delta t R_{s,i}^n\n$$\nThis is a $2 \\times 2$ linear system for the unknown temperature vector $[T_{f,i}^{n+1}, T_{s,i}^{n+1}]^\\top$ at each node $i$:\n$$\n\\begin{bmatrix}\n1 + \\dfrac{\\Delta t H}{C_f}  - \\dfrac{\\Delta t H}{C_f} \\\\\n- \\dfrac{\\Delta t H}{C_s}  1 + \\dfrac{\\Delta t H}{C_s}\n\\end{bmatrix}\n\\begin{bmatrix}\nT_{f,i}^{n+1} \\\\ T_{s,i}^{n+1}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nT_{f,i}^{n} + \\Delta t R_{f,i}^n \\\\\nT_{s,i}^{n} + \\Delta t R_{s,i}^n\n\\end{bmatrix}\n$$\nThis system can be solved efficiently at each node at every time step.\n\nTask 3: Stability Bounds\n\nThe stability of an explicit scheme depends on its constituent parts.\n1.  **Convection**: The stability bound for first-order upwind differencing of the advection equation $\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0$ with forward Euler is the Courant-Friedrichs-Lewy (CFL) condition, given as $\\Delta t_{\\mathrm{conv}} \\le \\frac{\\Delta x}{u}$.\n2.  **Diffusion**: To derive the diffusion bound, consider the explicit Euler discretization of the solid heat equation without other terms: $\\frac{dT_{s,i}}{dt} = \\frac{k_s}{C_s} \\frac{T_{s,i+1} - 2T_{s,i} + T_{s,i-1}}{\\Delta x^2}$.\n    $$\n    \\frac{T_{s,i}^{n+1} - T_{s,i}^{n}}{\\Delta t} = \\frac{k_s}{C_s \\Delta x^2} (T_{s,i+1}^n - 2T_{s,i}^n + T_{s,i-1}^n)\n    $$\n    A standard von Neumann stability analysis of this finite difference equation yields the stability restriction $2 \\frac{k_s \\Delta t}{C_s \\Delta x^2} \\le 1$, which rearranges to the required bound:\n    $$\n    \\Delta t_{\\mathrm{diff}} \\le \\frac{C_s \\Delta x^2}{2 k_s}\n    $$\n3.  **Exchange**: To derive the exchange bound, we analyze the stability of the forward Euler scheme applied to the exchange-only system from Task 1, $\\frac{d\\mathbf{T}_i}{dt} = \\mathbf{M} \\mathbf{T}_i$. The update rule is $\\mathbf{T}_i^{n+1} = (\\mathbf{I} + \\Delta t \\mathbf{M})\\mathbf{T}_i^n$. Stability requires that the eigenvalues of the amplification matrix $\\mathbf{G} = \\mathbf{I} + \\Delta t \\mathbf{M}$, denoted $g_j$, satisfy $|g_j| \\le 1$. The eigenvalues of $\\mathbf{G}$ are $g_j = 1 + \\Delta t \\lambda_j$, where $\\lambda_j$ are the eigenvalues of $\\mathbf{M}$. From Task 1, $\\lambda_1 = 0$ and $\\lambda_2 = -H(1/C_f + 1/C_s)$.\n    - For $\\lambda_1=0$, $g_1 = 1 + 0 = 1$, which satisfies $|g_1| \\le 1$.\n    - For $\\lambda_2$, $g_2 = 1 + \\Delta t \\lambda_2 = 1 - \\Delta t H(1/C_f + 1/C_s)$. Stability demands $|g_2| \\le 1$, which means $-1 \\le 1 - \\Delta t H(1/C_f + 1/C_s) \\le 1$. Since all parameters are positive, the right-hand inequality is always satisfied. The left-hand inequality gives:\n    $$\n    -2 \\le - \\Delta t H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) \\implies \\Delta t H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) \\le 2\n    $$\n    This rearranges to the required bound:\n    $$\n    \\Delta t_{\\mathrm{exch}} \\le \\frac{2}{H\\left(\\dfrac{1}{C_f}+\\dfrac{1}{C_s}\\right)}\n    $$\nThe proposed IMEX scheme treats the stiff exchange term implicitly. The backward Euler method is A-stable, meaning its region of absolute stability contains the entire left half of the complex plane. The eigenvalues of the exchange Jacobian $\\mathbf{M}$ are real and non-positive ($\\lambda_1=0$, $\\lambda_2  0$), so they lie within this region. The amplification factor for an eigenvalue $\\lambda$ with backward Euler is $(1-\\Delta t \\lambda)^{-1}$, which has a magnitude less than or equal to $1$ for any $\\Delta t  0$ as long as $\\text{Re}(\\lambda) \\le 0$. Consequently, the implicit treatment of the exchange term is unconditionally stable and imposes no restriction on the time step $\\Delta t$. The overall stability of the IMEX scheme is therefore governed only by the stability limits of the terms treated explicitly, which are convection and diffusion. This removes the restrictive $\\Delta t_{\\mathrm{exch}}$ requirement, allowing for much larger time steps when the exchange process is fast.\n\nTask 4: Program and Computations\n\nThe program will calculate the three time step bounds ($\\Delta t_{\\mathrm{conv}}$, $\\Delta t_{\\mathrm{diff}}$, $\\Delta t_{\\mathrm{exch}}$) for each test case. It will then compute the maximum stable time step for a fully explicit scheme, $\\Delta t_{\\mathrm{explicit}} = \\min(\\Delta t_{\\mathrm{conv}}, \\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{exch}})$, and for the proposed IMEX scheme, $\\Delta t_{\\mathrm{IMEX}} = \\min(\\Delta t_{\\mathrm{conv}}, \\Delta t_{\\mathrm{diff}})$. Finally, it will compute the improvement factor $\\mathcal{I} = \\Delta t_{\\mathrm{IMEX}} / \\Delta t_{\\mathrm{explicit}}$ for each case and output the results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are required for this problem.\n\ndef solve():\n    \"\"\"\n    Computes the stability improvement factor for an IMEX scheme\n    over a fully explicit scheme for a local thermal non-equilibrium model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: moderately large interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.5, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e8},\n        # Case 2: extremely large interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.5, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e10},\n        # Case 3: no convection, extremely large interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.0, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e10},\n        # Case 4: weak interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.5, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e2},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Extract parameters from the case dictionary\n        epsilon = case['epsilon']\n        rho_f = case['rho_f']\n        c_f = case['c_f']\n        rho_s = case['rho_s']\n        c_s = case['c_s']\n        u = case['u']\n        L = case['L']\n        N = case['N']\n        k_s = case['k_s']\n        H = case['H']\n\n        # Calculate intermediate physical properties\n        # Volumetric heat capacity of the fluid phase\n        C_f = epsilon * rho_f * c_f\n        # Volumetric heat capacity of the solid phase\n        C_s = (1.0 - epsilon) * rho_s * c_s\n        # Grid spacing\n        delta_x = L / N\n\n        # Calculate the stability bounds for the three physical processes\n        \n        # Convective time step bound (CFL condition)\n        # If velocity u is zero, the convective limit is infinite.\n        if u > 0:\n            dt_conv = delta_x / u\n        else:\n            dt_conv = np.inf\n\n        # Diffusive time step bound\n        dt_diff = (C_s * delta_x**2) / (2.0 * k_s)\n\n        # Interphase exchange time step bound\n        # The term H * (1/C_f + 1/C_s) cannot be zero given the problem constraints.\n        dt_exch = 2.0 / (H * (1.0/C_f + 1.0/C_s))\n\n        # Determine the maximum stable time step for each scheme\n        \n        # For a fully explicit scheme, the time step is limited by the minimum of all three bounds.\n        dt_explicit = min(dt_conv, dt_diff, dt_exch)\n\n        # For the IMEX scheme, the exchange term is treated implicitly, so its\n        # stability restriction is removed.\n        dt_imex = min(dt_conv, dt_diff)\n\n        # Calculate the improvement factor as the ratio of the two time step limits.\n        # This is guaranteed to be >= 1.0.\n        improvement_factor = dt_imex / dt_explicit\n\n        results.append(improvement_factor)\n\n    # Format the results for the final output string\n    # Each result must be rounded to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}