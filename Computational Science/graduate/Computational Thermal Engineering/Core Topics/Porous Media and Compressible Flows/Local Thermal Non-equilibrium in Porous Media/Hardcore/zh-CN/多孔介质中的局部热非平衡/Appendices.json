{
    "hands_on_practices": [
        {
            "introduction": "局部热非平衡（LTNE）模型依赖于描述多孔介质微观结构的参数。这项实践将指导你从第一性原理出发，为一个由球体构成的填充床推导关键的界面面积密度 $a_{sf}$ 。通过这个练习，你将能深刻理解如何将微观几何信息转化为宏观连续介质模型中至关重要的系数。",
            "id": "3968734",
            "problem": "在多孔介质的局部热非平衡 (LTNE) 双能方程模型中，引入了一个形式为 $h_{sf}\\, a_{sf} \\left(T_{s}-T_{f}\\right)$ 的相间热交换项，其中 $h_{sf}$ 是界面传热系数，$a_{sf}$ 是固液之间的界面面积密度，$T_{s}$ 和 $T_{f}$ 分别是固体和流体的温度。考虑一个固定的填充床，它由直径为 $d_{p}$ 的单分散、无孔、光滑球体组成，孔隙率为 $\\varepsilon$，并被单相流体完全饱和。假设颗粒接触所占的表面积可以忽略不计，存在一个代表性单元体积 (REV)，并且填充床在宏观上是均匀和各向同性的。\n\n仅从基本几何关系和定义出发，推导界面面积密度 $a_{sf}$（定义为单位总 REV 体积内的总固液界面面积），并用 $d_{p}$ 和 $\\varepsilon$ 表示。你的推导必须从孔隙率 $\\varepsilon$ 的定义、球体的表面积和体积、以及 $a_{sf}$ 作为单位总体积界面面积的定义开始，不得使用任何预先记下的简化公式。\n\n将 $a_{sf}$ 的最终结果以 $\\mathrm{m}^{-1}$ 为单位表示。以 $d_{p}$ 和 $\\varepsilon$ 的单个封闭形式符号表达式提供最终答案。不要代入数值，也不要进行近似。",
            "solution": "该问题是有效的，因为它在科学上基于多孔介质传热的原理，提法恰当，具有足够的信息以得到唯一解，并以客观、正式的语言陈述。我们现在开始求解。\n\n目标是为单分散球体填充床的界面面积密度 $a_{sf}$ 推导一个表达式。推导将按照规定从基本定义出发。\n\n让我们考虑多孔介质的一个代表性单元体积 (REV)，其总体积记为 $V_{\\text{total}}$。这个总体积由固相所占的体积 $V_{s}$ 和流相所占的体积（即空隙或孔隙体积）$V_{f}$ 组成。\n$$V_{\\text{total}} = V_{s} + V_{f}$$\n\n孔隙率 $\\varepsilon$ 定义为 REV 总体积中被流体占据的体积分数。\n$$\\varepsilon = \\frac{V_{f}}{V_{\\text{total}}}$$\n因此，固体分数，即固相所占的体积分数，由下式给出：\n$$1 - \\varepsilon = \\frac{V_{s}}{V_{\\text{total}}}$$\n\n界面面积密度 $a_{sf}$ 定义为单位 REV 总体积内的总固液界面面积 $A_{sf}$。\n$$a_{sf} = \\frac{A_{sf}}{V_{\\text{total}}}$$\n\n固相由直径为 $d_{p}$ 的单分散、无孔球体组成。单个球体的体积和表面积由标准几何公式给出：\n单个球体的体积： $V_{\\text{sphere}} = \\frac{4}{3}\\pi \\left(\\frac{d_{p}}{2}\\right)^{3} = \\frac{1}{6}\\pi d_{p}^{3}$\n单个球体的表面积： $A_{\\text{sphere}} = 4\\pi \\left(\\frac{d_{p}}{2}\\right)^{2} = \\pi d_{p}^{2}$\n\n设 $N$ 是总体积为 $V_{\\text{total}}$ 的 REV 中包含的球体数量。固相的总体积 $V_{s}$ 是球体数量与单个球体体积的乘积。\n$$V_{s} = N \\cdot V_{\\text{sphere}} = N \\left(\\frac{1}{6}\\pi d_{p}^{3}\\right)$$\n\n问题陈述颗粒接触所占的表面积可以忽略不计。因此，总固液界面面积 $A_{sf}$ 可以视为 REV 中所有球体的总表面积。\n$$A_{sf} = N \\cdot A_{\\text{sphere}} = N \\left(\\pi d_{p}^{2}\\right)$$\n\n我们的目标是用 $\\varepsilon$ 和 $d_{p}$ 来表示 $a_{sf}$。为此，我们必须从 $a_{sf}$ 的表达式中消去量 $N$ 和 $V_{\\text{total}}$。我们可以利用固体分数的定义来建立这些量之间的关系。\n\n从固体分数的定义，我们有：\n$$1 - \\varepsilon = \\frac{V_{s}}{V_{\\text{total}}} = \\frac{N \\left(\\frac{1}{6}\\pi d_{p}^{3}\\right)}{V_{\\text{total}}}$$\n这个方程将宏观属性 $\\varepsilon$ 与颗粒的微观属性联系起来。我们可以重新整理这个方程来表示单位总体积内的颗粒数 $\\frac{N}{V_{\\text{total}}}$：\n$$\\frac{N}{V_{\\text{total}}} = \\frac{6(1 - \\varepsilon)}{\\pi d_{p}^{3}}$$\n\n现在，我们回到界面面积密度 $a_{sf}$ 的定义：\n$$a_{sf} = \\frac{A_{sf}}{V_{\\text{total}}} = \\frac{N \\left(\\pi d_{p}^{2}\\right)}{V_{\\text{total}}}$$\n我们可以将其改写为：\n$$a_{sf} = \\left(\\frac{N}{V_{\\text{total}}}\\right) \\left(\\pi d_{p}^{2}\\right)$$\n\n代入我们从孔隙率定义中推导出的颗粒数密度 $\\frac{N}{V_{\\text{total}}}$ 的表达式：\n$$a_{sf} = \\left(\\frac{6(1 - \\varepsilon)}{\\pi d_{p}^{3}}\\right) \\left(\\pi d_{p}^{2}\\right)$$\n\n最后，我们通过约去公因式来简化表达式。分子和分母中的项 $\\pi$ 被约去。分子中的项 $d_{p}^{2}$ 与分母中 $d_{p}$ 的三次幂中的两次幂约去，在分母中留下一个 $d_{p}$。\n$$a_{sf} = \\frac{6(1 - \\varepsilon)}{d_{p}}$$\n\n这就是从第一性原理推导出的单分散球体填充床的界面面积密度的所求表达式。单位是一致的，因为 $1-\\varepsilon$ 是无量纲的，而 $d_{p}$ 具有长度单位（例如，米，$\\mathrm{m}$），从而得到 $a_{sf}$ 的单位为 $\\mathrm{m}^{-1}$。",
            "answer": "$$\\boxed{\\frac{6(1 - \\varepsilon)}{d_{p}}}$$"
        },
        {
            "introduction": "在建立了模型的几何参数之后，下一步是理解非平衡本身的动力学特性。本练习将引导你分析一个简化的系统，推导固相和流相之间温度差随时间演变的控制方程，并从中提炼出热弛豫时间 $\\tau$ 。这个核心概念量化了系统恢复到热平衡状态的速度，是判断LTNE效应是否显著的关键指标。",
            "id": "3968695",
            "problem": "考虑一个由单相流体饱和的均质、刚性多孔介质，在代表性单元体积（REV）尺度上，该系统采用局部热非平衡（LTNE）假设进行建模。设固相温度为 $T_{s}(t)$，流相温度为 $T_{f}(t)$，两者均假设为空间均匀（无空间梯度）。孔隙度为 $\\varepsilon$，流体质量密度为 $\\rho_{f}$，流体定压比热为 $c_{pf}$，固体质量密度为 $\\rho_{s}$，固体比热为 $c_{ps}$。界面面积密度（单位总体积的面积）为 $a_{sf}$，界面传热系数为 $h_{sf}$。假设所有物性均为常数，不存在外部源或汇，且两相间唯一的热相互作用是界面热交换。\n\n基于这些假设，从为各相（流相和固相）建立的能量守恒方程出发，并且除了界面交换项外不引入任何额外的本构简化，推导出温差 $\\theta(t) = T_{s}(t) - T_{f}(t)$ 的控制常微分方程，并由此求得决定 $\\theta(t)$ 指数衰减的特征弛豫时间 $\\tau$。以闭式解析表达式的形式给出弛豫时间。以秒为单位表示弛豫时间。不需提供中间结果；仅报告弛豫时间的最终表达式。",
            "solution": "局部热非平衡（LTNE）框架将在代表性单元体积（REV）尺度上，将流相和固相视为具有不同的温度 $T_{f}(t)$ 和 $T_{s}(t)$。在空间均匀（无宏观梯度）的条件下，各相的能量守恒方程简化为集总能量平衡方程，其中唯一的耦合项是界面热交换。\n\n对于流相，单位总体积储存的能量为 $\\varepsilon \\rho_{f} c_{pf} T_{f}$，因此储能的变化率为 $\\varepsilon \\rho_{f} c_{pf} \\,\\frac{d T_{f}}{d t}$。从固相流入流相的单位总体积界面热交换量被建模为 $h_{sf} a_{sf} (T_{s} - T_{f})$。在没有外部源或汇的情况下，流相的能量平衡方程为\n$$\n\\varepsilon \\rho_{f} c_{pf} \\,\\frac{d T_{f}}{d t} = h_{sf} a_{sf} \\left( T_{s} - T_{f} \\right).\n$$\n\n对于固相，单位总体积储存的能量为 $(1 - \\varepsilon) \\rho_{s} c_{ps} T_{s}$，从固相流出进入流相的单位总体积界面热交换量为 $h_{sf} a_{sf} (T_{s} - T_{f})$，但在固相的平衡方程中符号相反。因此\n$$\n(1 - \\varepsilon) \\rho_{s} c_{ps} \\,\\frac{d T_{s}}{d t} = -\\, h_{sf} a_{sf} \\left( T_{s} - T_{f} \\right).\n$$\n\n定义温差\n$$\n\\theta(t) = T_{s}(t) - T_{f}(t).\n$$\n对 $\\theta$ 关于时间求导：\n$$\n\\frac{d \\theta}{d t} = \\frac{d T_{s}}{d t} - \\frac{d T_{f}}{d t}.\n$$\n从每个平衡方程中解出时间导数。由固相平衡方程可得，\n$$\n\\frac{d T_{s}}{d t} = -\\, \\frac{h_{sf} a_{sf}}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\left( T_{s} - T_{f} \\right)\n= -\\, \\frac{h_{sf} a_{sf}}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\,\\theta.\n$$\n由流相平衡方程可得，\n$$\n\\frac{d T_{f}}{d t} = \\frac{h_{sf} a_{sf}}{\\varepsilon \\rho_{f} c_{pf}} \\left( T_{s} - T_{f} \\right)\n= \\frac{h_{sf} a_{sf}}{\\varepsilon \\rho_{f} c_{pf}} \\,\\theta.\n$$\n代入 $\\frac{d \\theta}{d t}$ 中：\n$$\n\\frac{d \\theta}{d t} = -\\, \\frac{h_{sf} a_{sf}}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\,\\theta\n- \\frac{h_{sf} a_{sf}}{\\varepsilon \\rho_{f} c_{pf}} \\,\\theta\n= -\\, h_{sf} a_{sf} \\left( \\frac{1}{(1 - \\varepsilon) \\rho_{s} c_{ps}} + \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} \\right) \\theta.\n$$\n\n这是一个形为如下的一阶线性常系数常微分方程\n$$\n\\frac{d \\theta}{d t} = -\\, \\lambda \\,\\theta,\n$$\n其中\n$$\n\\lambda = h_{sf} a_{sf} \\left( \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} + \\frac{1}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\right).\n$$\n其解为指数衰减，\n$$\n\\theta(t) = \\theta(0) \\,\\exp\\!\\left( -\\, \\lambda \\, t \\right).\n$$\n特征弛豫时间 $\\tau$ 由 $\\theta(t) = \\theta(0) \\exp\\!\\left( - t / \\tau \\right)$ 定义，所以 $\\tau = 1 / \\lambda$。因此，\n$$\n\\tau = \\frac{1}{h_{sf} a_{sf} \\left( \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} + \\frac{1}{(1 - \\varepsilon) \\rho_{s} c_{ps}} \\right)}.\n$$\n该表达式的单位是时间，并以秒为单位表示。",
            "answer": "$$\\boxed{\\frac{1}{h_{sf} a_{sf} \\left( \\frac{1}{\\varepsilon \\rho_{f} c_{pf}} + \\frac{1}{(1-\\varepsilon) \\rho_{s} c_{ps}} \\right)}}$$"
        },
        {
            "introduction": "将理论模型应用于实际工程问题通常需要进行数值模拟，而这一过程充满了挑战。当固相和流相之间的热交换非常迅速时，LTNE方程组会表现出“数值刚性”，使得标准的显式时间积分方法效率极低 。这项综合性实践将带你诊断这种刚性问题，并设计一种隐式-显式（IMEX）混合格式来有效解决它，这是计算热工领域一项非常实用的高级技能。",
            "id": "3968701",
            "problem": "考虑一个在一维饱和多孔介质中根据局部非热平衡（Local Thermal Non-Equilibrium, LTNE）模型建立的模型，其中流体相和固相具有各自独立的温度。设 $x \\in [0,L]$ 表示空间，流体温度为 $T_f(x,t)$，固体温度为 $T_s(x,t)$。体积热容分别为 $C_f = \\epsilon \\rho_f c_f$ 和 $C_s = (1-\\epsilon)\\rho_s c_s$，其中 $\\epsilon$ 是孔隙度，$\\rho_f$ 和 $\\rho_s$ 分别是流体相和固相的密度， $c_f$ 和 $c_s$ 分别是它们的比热。相间传热系数乘以比表面积为 $H = h_{sf} a_{sf}$，单位为 $\\mathrm{W\\,m^{-3}\\,K^{-1}}$。固体的热导率为 $k_s$，单位为 $\\mathrm{W\\,m^{-1}\\,K^{-1}}$，流体以均匀速度 $u$（单位 $\\mathrm{m\\,s^{-1}}$）平流。忽略流体中的轴向传导和任何内部热源。\n\n控制性的 LTNE 能量平衡方程为\n$$\nC_f \\frac{\\partial T_f}{\\partial t} + C_f u \\frac{\\partial T_f}{\\partial x} = H \\left( T_s - T_f \\right), \\\\\nC_s \\frac{\\partial T_s}{\\partial t} = k_s \\frac{\\partial^2 T_s}{\\partial x^2} + H \\left( T_f - T_s \\right).\n$$\n使用 $N$ 个均匀分布的网格点对空间进行离散化，网格间距为 $\\Delta x = L/N$，并采用周期性边界条件。使用一阶迎风差分近似流体对流项，对于 $u>0$，$\\partial T_f/\\partial x \\approx \\left(T_{f,i}-T_{f,i-1}\\right)/\\Delta x$；使用二阶中心差分近似固体扩散项，$\\partial^2 T_s/\\partial x^2 \\approx \\left(T_{s,i+1}-2T_{s,i}+T_{s,i-1}\\right)/\\Delta x^2$。这样可以得到一个关于节点温度的常微分方程半离散系统。\n\n任务 1（推导与解释）：从半离散的节点平衡方程出发，通过暂时忽略对流和扩散，分离出单个节点 $i$ 上相间交换项的贡献。证明仅考虑交换的线性系统对于 $\\left[T_{f,i}(t),T_{s,i}(t)\\right]^\\top$ 具有雅可比矩阵\n$$\n\\mathbf{M} = \\begin{bmatrix}\n-\\dfrac{H}{C_f}   \\dfrac{H}{C_f} \\\\\n\\dfrac{H}{C_s}   -\\dfrac{H}{C_s}\n\\end{bmatrix},\n$$\n并计算其特征值。通过比较特征交换时间尺度与对流和扩散时间尺度，解释为什么大的 $H$ 会在整个半离散常微分方程系统中引发刚性。\n\n任务 2（格式设计）：提出一种隐式-显式（IMEX）时间积分格式，该格式对相间交换项进行隐式处理，同时保持流体对流项为显式。对显式贡献部分使用前向欧拉法，对隐式交换耦合部分使用后向欧拉法。推导出在每个时间步长 $\\Delta t$ 下，关于 $\\left[T_{f,i}^{n+1},T_{s,i}^{n+1}\\right]^\\top$ 的逐节点 $2\\times 2$ 线性系统，该系统以由 $\\left[T_{f}^{n},T_{s}^{n}\\right]$ 计算得到的已知显式右端项表示。\n\n任务 3（稳定性界限）：对流体平流使用一阶迎风格式和显式欧拉时间步进，对流的 Courant-Friedrichs-Lewy 条件给出了一个界限\n$$\n\\Delta t_{\\mathrm{conv}} \\le \\frac{\\Delta x}{u} \\quad \\text{for } u>0\n$$\n对固体扩散使用显式欧拉法和中心差分，推导出界限\n$$\n\\Delta t_{\\mathrm{diff}} \\le \\frac{C_s \\Delta x^2}{2 k_s}\n$$\n对于仅交换的显式欧拉更新，使用交换雅可比矩阵的特征值证明其界限为\n$$\n\\Delta t_{\\mathrm{exch}} \\le \\frac{2}{H\\left(\\dfrac{1}{C_f}+\\dfrac{1}{C_s}\\right)}\n$$\n解释为什么隐式处理交换的 IMEX 格式能够移除 $\\Delta t_{\\mathrm{exch}}$ 的限制，同时保留显式对流和扩散的限制。\n\n任务 4（程序与输出）：编写一个完整、可运行的程序，为下面提供的每个测试用例，计算全显式格式的最大稳定时间步长\n$$\n\\Delta t_{\\mathrm{explicit}} = \\min\\left\\{\\Delta t_{\\mathrm{conv}},\\ \\Delta t_{\\mathrm{diff}},\\ \\Delta t_{\\mathrm{exch}}\\right\\},\n$$\n以及所提出的 IMEX 格式的最大稳定时间步长\n$$\n\\Delta t_{\\mathrm{IMEX}} = \\min\\left\\{\\Delta t_{\\mathrm{conv}},\\ \\Delta t_{\\mathrm{diff}}\\right\\}.\n$$\n程序必须为每个测试用例输出一个改进因子，定义为无量纲浮点数\n$$\n\\mathcal{I} = \\frac{\\Delta t_{\\mathrm{IMEX}}}{\\Delta t_{\\mathrm{explicit}}}.\n$$\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3]\"）。每个结果必须四舍五入到六位小数。所有输入的物理参数均采用国际单位制（SI），计算出的时间步长单位为秒；改进因子是无量纲的。\n\n测试套件（请精确使用这四个案例）：\n- 案例 1（中等强度的相间交换）：$\\epsilon=0.7$, $\\rho_f=1000\\ \\mathrm{kg\\,m^{-3}}$, $c_f=4180\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $\\rho_s=2600\\ \\mathrm{kg\\,m^{-3}}$, $c_s=800\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $u=0.5\\ \\mathrm{m\\,s^{-1}}$, $L=1.0\\ \\mathrm{m}$, $N=100$, $k_s=2.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$, $H=1\\times 10^{8}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$。\n- 案例 2（极强的相间交换）：与案例 1 相同，但 $H=1\\times 10^{10}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$。\n- 案例 3（无对流，极强的相间交换）：与案例 1 相同的材料参数，但 $u=0.0\\ \\mathrm{m\\,s^{-1}}$ 且 $H=1\\times 10^{10}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$。\n- 案例 4（弱相间交换）：与案例 1 相同，但 $H=1\\times 10^{2}\\ \\mathrm{W\\,m^{-3}\\,K^{-1}}$。\n\n科学真实性要求：确保所有推理和计算都使用基本的能量守恒、一致的离散化方法以及源自标准线性分析的稳定性判据。最终答案必须是按指定格式打印在单个 Python 列表中的浮点数。不需要外部输入，输出值必须是无量纲的改进因子。",
            "solution": "该问题经评估为有效，因为它在科学上基于传热和数值分析的原理，所有必要参数均已给出，问题设定良好，并且其表述是客观的。它构成了一个计算热工领域标准的、实质性的练习。因此，我们可以着手解决。\n\n解答分为四个部分，对应问题陈述中列出的四个任务。\n\n任务 1：仅交换项的雅可比矩阵推导、特征值计算和刚性分析\n\n流体相和固相的控制能量平衡方程如下：\n$$\nC_f \\frac{\\partial T_f}{\\partial t} + C_f u \\frac{\\partial T_f}{\\partial x} = H \\left( T_s - T_f \\right)\n$$\n$$\nC_s \\frac{\\partial T_s}{\\partial t} = k_s \\frac{\\partial^2 T_s}{\\partial x^2} + H \\left( T_f - T_s \\right)\n$$\n在节点 $i$ 进行空间离散化后，常微分方程（ODEs）的半离散系统为：\n$$\n\\frac{dT_{f,i}}{dt} = -u \\frac{T_{f,i} - T_{f, i-1}}{\\Delta x} + \\frac{H}{C_f} (T_{s,i} - T_{f,i})\n$$\n$$\n\\frac{dT_{s,i}}{dt} = \\frac{k_s}{C_s} \\frac{T_{s,i+1} - 2T_{s,i} + T_{s,i-1}}{\\Delta x^2} + \\frac{H}{C_s} (T_{f,i} - T_{s,i})\n$$\n为了孤立地分析相间交换项，我们忽略输运项（对流和扩散）：\n$$\n\\frac{dT_{f,i}}{dt} = \\frac{H}{C_f} (T_{s,i} - T_{f,i}) = -\\frac{H}{C_f} T_{f,i} + \\frac{H}{C_f} T_{s,i}\n$$\n$$\n\\frac{dT_{s,i}}{dt} = \\frac{H}{C_s} (T_{f,i} - T_{s,i}) = \\frac{H}{C_s} T_{f,i} - \\frac{H}{C_s} T_{s,i}\n$$\n该系统可以为温度向量 $\\mathbf{T}_i(t) = [T_{f,i}(t), T_{s,i}(t)]^\\top$ 写成矩阵形式 $\\frac{d\\mathbf{T}_i}{dt} = \\mathbf{M} \\mathbf{T}_i$。雅可比矩阵 $\\mathbf{M}$ 是右侧向量关于 $\\mathbf{T}_i$ 各分量的偏导数矩阵，对于这个线性系统，它就是系数矩阵：\n$$\n\\mathbf{M} = \\begin{bmatrix}\n\\dfrac{\\partial}{\\partial T_{f,i}}\\left(-\\dfrac{H}{C_f} T_{f,i} + \\dfrac{H}{C_f} T_{s,i}\\right)   \\dfrac{\\partial}{\\partial T_{s,i}}\\left(-\\dfrac{H}{C_f} T_{f,i} + \\dfrac{H}{C_f} T_{s,i}\\right) \\\\\n\\dfrac{\\partial}{\\partial T_{f,i}}\\left(\\dfrac{H}{C_s} T_{f,i} - \\dfrac{H}{C_s} T_{s,i}\\right)   \\dfrac{\\partial}{\\partial T_{s,i}}\\left(\\dfrac{H}{C_s} T_{f,i} - \\dfrac{H}{C_s} T_{s,i}\\right)\n\\end{bmatrix} = \\begin{bmatrix}\n-\\dfrac{H}{C_f}   \\dfrac{H}{C_f} \\\\\n\\dfrac{H}{C_s}   -\\dfrac{H}{C_s}\n\\end{bmatrix}\n$$\n这证实了雅可比矩阵的指定形式。为了求其特征值 $\\lambda$，我们求解特征方程 $\\det(\\mathbf{M} - \\lambda\\mathbf{I}) = 0$：\n$$\n\\det \\begin{bmatrix}\n-\\dfrac{H}{C_f} - \\lambda   \\dfrac{H}{C_f} \\\\\n\\dfrac{H}{C_s}   -\\dfrac{H}{C_s} - \\lambda\n\\end{bmatrix} = 0\n$$\n$$\n\\left(-\\frac{H}{C_f} - \\lambda\\right)\\left(-\\frac{H}{C_s} - \\lambda\\right) - \\left(\\frac{H}{C_f}\\right)\\left(\\frac{H}{C_s}\\right) = 0\n$$\n$$\n\\lambda^2 + \\lambda\\left(\\frac{H}{C_s} + \\frac{H}{C_f}\\right) + \\frac{H^2}{C_f C_s} - \\frac{H^2}{C_f C_s} = 0\n$$\n$$\n\\lambda^2 + \\lambda H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) = 0 \\implies \\lambda \\left[ \\lambda + H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) \\right] = 0\n$$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = -H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right)$。\n\n当一个常微分方程组的特征时间尺度相差悬殊时，就会出现刚性。与特征值 $\\lambda$ 相关的时间尺度约为 $1/|\\lambda|$。\n- 特征值 $\\lambda_1 = 0$ 对应于一个无限的时间尺度，表示在一个节点上孤立的双温系统内的能量守恒。系统向着 $T_f = T_s$ 的稳态演化，但总能量是守恒的。\n- 特征值 $\\lambda_2$ 对应于特征交换时间尺度 $\\tau_{\\mathrm{exch}} = 1/|\\lambda_2| = \\frac{1}{H\\left(1/C_f + 1/C_s\\right)}$。\n对流和扩散的特征时间尺度分别约为 $\\tau_{\\mathrm{conv}} \\approx \\Delta x/u$ 和 $\\tau_{\\mathrm{diff}} \\approx C_s \\Delta x^2/k_s$。当相间传热系数 $H$ 很大时，$\\tau_{\\mathrm{exch}}$ 变得非常小。如果 $\\tau_{\\mathrm{exch}} \\ll \\tau_{\\mathrm{conv}}$ 且 $\\tau_{\\mathrm{exch}} \\ll \\tau_{\\mathrm{diff}}$，系统在数值上是刚性的。显式时间积分格式为了保持稳定，其时间步长受限于系统中最小的时间尺度，要求时间步长 $\\Delta t \\le C/|\\lambda_{\\max}|$，其中 $\\lambda_{\\max}$ 是模最大的特征值。对于大的 $H$，这会强制要求一个由 $\\tau_{\\mathrm{exch}}$ 决定的、不切实际的小 $\\Delta t$，即使温度场的宏观演化（由对流和扩散控制）发生在慢得多的时间尺度 $\\tau_{\\mathrm{conv}}$ 和 $\\tau_{\\mathrm{diff}}$ 上。\n\n任务 2：IMEX 格式的设计\n\n我们设计一个 IMEX 格式，其中刚性的相间交换项被隐式处理（使用后向欧拉法），而非刚性的输运项（对流和扩散）被显式处理（使用前向欧拉法）。半离散方程被划分为：\n$$\n\\frac{dT_{f,i}}{dt} = \\underbrace{-u \\frac{T_{f,i} - T_{f, i-1}}{\\Delta x}}_{\\text{显式}} + \\underbrace{\\frac{H}{C_f} (T_{s,i} - T_{f,i})}_{\\text{隐式}}\n$$\n$$\n\\frac{dT_{s,i}}{dt} = \\underbrace{\\frac{k_s}{C_s} \\frac{T_{s,i+1} - 2T_{s,i} + T_{s,i-1}}{\\Delta x^2}}_{\\text{显式}} + \\underbrace{\\frac{H}{C_s} (T_{f,i} - T_{s,i})}_{\\text{隐式}}\n$$\n我们定义在已知时间层 $n$ 计算的显式右端（RHS）项：\n$$\nR_{f,i}^n = -u \\frac{T_{f,i}^n - T_{f, i-1}^n}{\\Delta x}\n$$\n$$\nR_{s,i}^n = \\frac{k_s}{C_s} \\frac{T_{s,i+1}^n - 2T_{s,i}^n + T_{s,i-1}^n}{\\Delta x^2}\n$$\n应用 IMEX 格式从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$：\n$$\n\\frac{T_{f,i}^{n+1} - T_{f,i}^{n}}{\\Delta t} = R_{f,i}^n + \\frac{H}{C_f} (T_{s,i}^{n+1} - T_{f,i}^{n+1})\n$$\n$$\n\\frac{T_{s,i}^{n+1} - T_{s,i}^{n}}{\\Delta t} = R_{s,i}^n + \\frac{H}{C_s} (T_{f,i}^{n+1} - T_{s,i}^{n+1})\n$$\n我们重新整理这些方程，将未知项 $T_{f,i}^{n+1}$ 和 $T_{s,i}^{n+1}$ 组合在左侧：\n$$\nT_{f,i}^{n+1} - \\Delta t \\frac{H}{C_f} (T_{s,i}^{n+1} - T_{f,i}^{n+1}) = T_{f,i}^{n} + \\Delta t R_{f,i}^n\n$$\n$$\nT_{s,i}^{n+1} - \\Delta t \\frac{H}{C_s} (T_{f,i}^{n+1} - T_{s,i}^{n+1}) = T_{s,i}^{n} + \\Delta t R_{s,i}^n\n$$\n提出未知温度：\n$$\n\\left(1 + \\Delta t \\frac{H}{C_f}\\right) T_{f,i}^{n+1} - \\left(\\Delta t \\frac{H}{C_f}\\right) T_{s,i}^{n+1} = T_{f,i}^{n} + \\Delta t R_{f,i}^n\n$$\n$$\n-\\left(\\Delta t \\frac{H}{C_s}\\right) T_{f,i}^{n+1} + \\left(1 + \\Delta t \\frac{H}{C_s}\\right) T_{s,i}^{n+1} = T_{s,i}^{n} + \\Delta t R_{s,i}^n\n$$\n这是一个关于未知温度向量 $[T_{f,i}^{n+1}, T_{s,i}^{n+1}]^\\top$ 在每个节点 $i$ 的 $2 \\times 2$ 线性系统：\n$$\n\\begin{bmatrix}\n1 + \\dfrac{\\Delta t H}{C_f}   - \\dfrac{\\Delta t H}{C_f} \\\\\n- \\dfrac{\\Delta t H}{C_s}   1 + \\dfrac{\\Delta t H}{C_s}\n\\end{bmatrix}\n\\begin{bmatrix}\nT_{f,i}^{n+1} \\\\ T_{s,i}^{n+1}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nT_{f,i}^{n} + \\Delta t R_{f,i}^n \\\\\nT_{s,i}^{n} + \\Delta t R_{s,i}^n\n\\end{bmatrix}\n$$\n这个系统可以在每个时间步长在每个节点上高效地求解。\n\n任务 3：稳定性界限\n\n显式格式的稳定性取决于其组成部分。\n1.  **对流**：对于使用前向欧拉法的一阶迎风差分格式求解平流方程 $\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0$ 的稳定性界限是 Courant-Friedrichs-Lewy (CFL) 条件，即 $\\Delta t_{\\mathrm{conv}} \\le \\frac{\\Delta x}{u}$。\n2.  **扩散**：为了推导扩散界限，考虑固体热方程在没有其他项时的显式欧拉离散化：$\\frac{dT_{s,i}}{dt} = \\frac{k_s}{C_s} \\frac{T_{s,i+1} - 2T_{s,i} + T_{s,i-1}}{\\Delta x^2}$。\n    $$\n    \\frac{T_{s,i}^{n+1} - T_{s,i}^{n}}{\\Delta t} = \\frac{k_s}{C_s \\Delta x^2} (T_{s,i+1}^n - 2T_{s,i}^n + T_{s,i-1}^n)\n    $$\n    对此有限差分方程进行标准的 von Neumann 稳定性分析，得到稳定性限制条件 $2 \\frac{k_s \\Delta t}{C_s \\Delta x^2} \\le 1$，整理后得到所需的界限：\n    $$\n    \\Delta t_{\\mathrm{diff}} \\le \\frac{C_s \\Delta x^2}{2 k_s}\n    $$\n3.  **交换**：为了推导交换界限，我们分析应用于任务 1 中仅交换系统 $\\frac{d\\mathbf{T}_i}{dt} = \\mathbf{M} \\mathbf{T}_i$ 的前向欧拉法的稳定性。更新规则为 $\\mathbf{T}_i^{n+1} = (\\mathbf{I} + \\Delta t \\mathbf{M})\\mathbf{T}_i^n$。稳定性要求放大矩阵 $\\mathbf{G} = \\mathbf{I} + \\Delta t \\mathbf{M}$ 的特征值 $g_j$ 满足 $|g_j| \\le 1$。$\\mathbf{G}$ 的特征值为 $g_j = 1 + \\Delta t \\lambda_j$，其中 $\\lambda_j$ 是 $\\mathbf{M}$ 的特征值。根据任务 1，$\\lambda_1 = 0$ 且 $\\lambda_2 = -H(1/C_f + 1/C_s)$。\n    - 对于 $\\lambda_1=0$，$g_1 = 1 + 0 = 1$，满足 $|g_1| \\le 1$。\n    - 对于 $\\lambda_2$，$g_2 = 1 + \\Delta t \\lambda_2 = 1 - \\Delta t H(1/C_f + 1/C_s)$。稳定性要求 $|g_2| \\le 1$，即 $-1 \\le 1 - \\Delta t H(1/C_f + 1/C_s) \\le 1$。由于所有参数均为正，右侧不等式恒成立。左侧不等式给出：\n    $$\n    -2 \\le - \\Delta t H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) \\implies \\Delta t H\\left(\\frac{1}{C_f} + \\frac{1}{C_s}\\right) \\le 2\n    $$\n    整理后得到所需的界限：\n    $$\n    \\Delta t_{\\mathrm{exch}} \\le \\frac{2}{H\\left(\\dfrac{1}{C_f}+\\dfrac{1}{C_s}\\right)}\n    $$\n所提出的 IMEX 格式对刚性交换项进行隐式处理。后向欧拉法是 A-稳定的，意味着其绝对稳定区域包含整个复平面的左半部分。交换雅可比矩阵 $\\mathbf{M}$ 的特征值是实数且非正（$\\lambda_1=0$, $\\lambda_2  0$），因此它们位于该区域内。对于后向欧拉法，特征值 $\\lambda$ 的放大因子为 $(1-\\Delta t \\lambda)^{-1}$，只要 $\\text{Re}(\\lambda) \\le 0$，对于任何 $\\Delta t > 0$，其模都小于等于 1。因此，对交换项的隐式处理是无条件稳定的，对时间步长 $\\Delta t$ 不施加任何限制。IMEX 格式的整体稳定性因此仅由显式处理的项（即对流和扩散）的稳定性限制所决定。这移除了严格的 $\\Delta t_{\\mathrm{exch}}$ 要求，当交换过程很快时，允许使用大得多的时间步长。\n\n任务 4：程序与计算\n\n该程序将为每个测试用例计算三个时间步长界限（$\\Delta t_{\\mathrm{conv}}$, $\\Delta t_{\\mathrm{diff}}$, $\\Delta t_{\\mathrm{exch}}$）。然后，它将计算全显式格式的最大稳定时间步长 $\\Delta t_{\\mathrm{explicit}} = \\min(\\Delta t_{\\mathrm{conv}}, \\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{exch}})$，以及所提出的 IMEX 格式的最大稳定时间步长 $\\Delta t_{\\mathrm{IMEX}} = \\min(\\Delta t_{\\mathrm{conv}}, \\Delta t_{\\mathrm{diff}})$。最后，它将为每个案例计算改进因子 $\\mathcal{I} = \\Delta t_{\\mathrm{IMEX}} / \\Delta t_{\\mathrm{explicit}}$，并输出结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are required for this problem.\n\ndef solve():\n    \"\"\"\n    Computes the stability improvement factor for an IMEX scheme\n    over a fully explicit scheme for a local thermal non-equilibrium model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: moderately large interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.5, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e8},\n        # Case 2: extremely large interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.5, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e10},\n        # Case 3: no convection, extremely large interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.0, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e10},\n        # Case 4: weak interphase exchange\n        {'epsilon': 0.7, 'rho_f': 1000.0, 'c_f': 4180.0, 'rho_s': 2600.0, 'c_s': 800.0,\n         'u': 0.5, 'L': 1.0, 'N': 100, 'k_s': 2.0, 'H': 1e2},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Extract parameters from the case dictionary\n        epsilon = case['epsilon']\n        rho_f = case['rho_f']\n        c_f = case['c_f']\n        rho_s = case['rho_s']\n        c_s = case['c_s']\n        u = case['u']\n        L = case['L']\n        N = case['N']\n        k_s = case['k_s']\n        H = case['H']\n\n        # Calculate intermediate physical properties\n        # Volumetric heat capacity of the fluid phase\n        C_f = epsilon * rho_f * c_f\n        # Volumetric heat capacity of the solid phase\n        C_s = (1.0 - epsilon) * rho_s * c_s\n        # Grid spacing\n        delta_x = L / N\n\n        # Calculate the stability bounds for the three physical processes\n        \n        # Convective time step bound (CFL condition)\n        # If velocity u is zero, the convective limit is infinite.\n        if u > 0:\n            dt_conv = delta_x / u\n        else:\n            dt_conv = np.inf\n\n        # Diffusive time step bound\n        dt_diff = (C_s * delta_x**2) / (2.0 * k_s)\n\n        # Interphase exchange time step bound\n        # The term H * (1/C_f + 1/C_s) cannot be zero given the problem constraints.\n        dt_exch = 2.0 / (H * (1.0/C_f + 1.0/C_s))\n\n        # Determine the maximum stable time step for each scheme\n        \n        # For a fully explicit scheme, the time step is limited by the minimum of all three bounds.\n        dt_explicit = min(dt_conv, dt_diff, dt_exch)\n\n        # For the IMEX scheme, the exchange term is treated implicitly, so its\n        # stability restriction is removed.\n        dt_imex = min(dt_conv, dt_diff)\n\n        # Calculate the improvement factor as the ratio of the two time step limits.\n        # This is guaranteed to be >= 1.0.\n        improvement_factor = dt_imex / dt_explicit\n\n        results.append(improvement_factor)\n\n    # Format the results for the final output string\n    # Each result must be rounded to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}