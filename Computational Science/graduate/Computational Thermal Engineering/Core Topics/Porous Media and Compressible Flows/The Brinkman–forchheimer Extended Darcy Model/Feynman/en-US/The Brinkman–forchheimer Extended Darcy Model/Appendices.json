{
    "hands_on_practices": [
        {
            "introduction": "Understanding complex models often begins with solving them for simplified, canonical scenarios. This practice builds from first principles to derive the governing equation for pressure-driven flow in a porous channel, a fundamental setup in many engineering applications . By solving the model in the limit where inertial effects are negligible, you will obtain an exact analytical solution for the velocity profile, providing insight into how solid boundaries influence flow within a porous medium via the Brinkman viscous shear term.",
            "id": "3989572",
            "problem": "A Newtonian, incompressible fluid of dynamic viscosity $\\mu$ flows steadily through an isotropic, homogeneous porous layer of permeability $K$ that completely fills the gap between two infinite parallel plates separated by distance $2H$. The walls at $y=\\pm H$ are impermeable and impose no slip. The imposed streamwise pressure gradient is uniform, with $\\partial p/\\partial x=-G$ where $G>0$ is constant. The macroscale (volume-averaged) velocity field is unidirectional and fully developed, $\\boldsymbol{u}(x,y,z)=u(y)\\,\\boldsymbol{e}_{x}$. The effective viscosity multiplying the macroscale viscous diffusion (Brinkman) term is $\\mu_{e}$, which may differ from $\\mu$.\n\nStarting solely from conservation of mass (incompressibility) and conservation of linear momentum for a Newtonian fluid, and invoking standard volume-averaging arguments for flows in porous media, derive the one-dimensional canonical flow governed by the Brinkman–Forchheimer extended Darcy model (BFE). Then, in the asymptotic regime where the Forchheimer inertial resistance is negligible at the macroscale, solve the resulting boundary-value problem exactly subject to no slip at $y=\\pm H$, and integrate the velocity profile to obtain the volumetric flow rate per unit width,\n$$\nQ'=\\int_{-H}^{H} u(y)\\,\\mathrm{d}y.\n$$\nFinally, non-dimensionalize $Q'$ by the characteristic Darcy velocity $U_{D}=GK/\\mu$ and the half-gap $H$, and report the exact closed-form expression for the dimensionless flow rate\n$$\n\\Phi=\\frac{Q'}{2HU_{D}}\n$$\nas a function of the single dimensionless Brinkman screening parameter\n$$\n\\Lambda=H\\sqrt{\\frac{\\mu}{\\mu_{e}K}}.\n$$\nProvide your final answer as a single closed-form analytic expression for $\\Phi$ in terms of $\\Lambda$. Do not substitute numerical values and do not include units in your final boxed expression.",
            "solution": "The problem asks for the derivation and solution of a fluid flow problem in a porous medium governed by the Brinkman–Forchheimer extended Darcy (BFE) model, followed by non-dimensionalization of the resulting flow rate.\n\nThe starting point is the conservation of linear momentum for a steady, incompressible Newtonian fluid, which is then volume-averaged to obtain the macroscopic momentum equation for flow in a porous medium. This is the Brinkman–Forchheimer extended Darcy (BFE) equation. For a flow driven by a macroscopic pressure gradient, this vector equation is:\n$$\n\\frac{\\rho}{\\varepsilon^2} (\\boldsymbol{u} \\cdot \\nabla) \\boldsymbol{u} = -\\nabla p + \\mu_e \\nabla^2 \\boldsymbol{u} - \\frac{\\mu}{K} \\boldsymbol{u} - \\rho \\beta |\\boldsymbol{u}|\\boldsymbol{u}\n$$\nHere, $\\boldsymbol{u}$ is the superficial (or Darcy) velocity, $\\rho$ is the fluid density, $\\varepsilon$ is the porosity, $p$ is the macroscopic pressure, $\\mu_e$ is the effective viscosity, $\\mu$ is the fluid viscosity, $K$ is the permeability, and $\\beta$ is the Forchheimer inertial resistance coefficient.\n\nThe problem specifies a fully developed, unidirectional flow field $\\boldsymbol{u}(x,y,z) = u(y)\\,\\boldsymbol{e}_x$ between two parallel plates at $y = \\pm H$. For this velocity field:\n- The continuity equation for an incompressible fluid, $\\nabla \\cdot \\boldsymbol{u} = 0$, is identically satisfied as $\\frac{\\partial u}{\\partial x} = 0$.\n- The convective acceleration term $(\\boldsymbol{u} \\cdot \\nabla) \\boldsymbol{u} = (u(y) \\frac{\\partial}{\\partial x}) (u(y)\\boldsymbol{e}_x)$ is zero because $u$ is not a function of $x$.\n- The viscous diffusion (Brinkman) term becomes $\\mu_e \\nabla^2 \\boldsymbol{u} = \\mu_e (\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2})(u(y)\\boldsymbol{e}_x) = \\mu_e \\frac{d^2 u}{dy^2}\\boldsymbol{e}_x$.\n- The imposed pressure gradient is given as $\\frac{\\partial p}{\\partial x} = -G$, where $G>0$ is a constant. Thus, $-\\nabla p = G\\,\\boldsymbol{e}_x$.\n- Since the flow is driven in the positive $x$-direction by a positive $G$, the velocity $u(y)$ will be non-negative. Therefore, $|\\boldsymbol{u}| = u(y)$. The Forchheimer term simplifies to $-\\rho \\beta u(y)^2\\,\\boldsymbol{e}_x$.\n\nSubstituting these terms into the BFE equation and considering only the non-trivial component in the $\\boldsymbol{e}_x$ direction yields the one-dimensional canonical BFE equation for this problem:\n$$\n0 = G + \\mu_e \\frac{d^2 u}{dy^2} - \\frac{\\mu}{K} u - \\rho \\beta u^2\n$$\nThis completes the requested derivation of the governing equation.\n\nThe problem then asks to analyze the asymptotic regime where the Forchheimer inertial resistance is negligible. This corresponds to setting the term proportional to $u^2$ to zero. The governing equation simplifies to the linear Brinkman equation:\n$$\n\\mu_e \\frac{d^2 u}{dy^2} - \\frac{\\mu}{K} u + G = 0\n$$\nWe can rearrange this into a standard form for a second-order linear ordinary differential equation (ODE):\n$$\n\\frac{d^2 u}{dy^2} - \\frac{\\mu}{\\mu_e K} u = -\\frac{G}{\\mu_e}\n$$\nThis is an inhomogeneous ODE with constant coefficients. The general solution is the sum of a particular solution, $u_p(y)$, and the homogeneous solution, $u_h(y)$.\nFor the particular solution, we assume a constant $u_p = C$. Substituting into the ODE gives:\n$$\n0 - \\frac{\\mu}{\\mu_e K} C = -\\frac{G}{\\mu_e} \\implies C = \\frac{G \\mu_e K}{\\mu \\mu_e} = \\frac{GK}{\\mu}\n$$\nSo, $u_p(y) = \\frac{GK}{\\mu}$. This velocity is recognized as the Darcy velocity, $U_D$.\n\nFor the homogeneous solution, we solve $\\frac{d^2 u_h}{dy^2} - \\frac{\\mu}{\\mu_e K} u_h = 0$. The characteristic equation is $r^2 - \\frac{\\mu}{\\mu_e K} = 0$, with roots $r = \\pm \\sqrt{\\frac{\\mu}{\\mu_e K}}$. Let us define $\\alpha = \\sqrt{\\frac{\\mu}{\\mu_e K}}$. The homogeneous solution is $u_h(y) = C_1 \\cosh(\\alpha y) + C_2 \\sinh(\\alpha y)$.\n\nThe general solution for the velocity profile is:\n$$\nu(y) = C_1 \\cosh(\\alpha y) + C_2 \\sinh(\\alpha y) + \\frac{GK}{\\mu}\n$$\nThe constants $C_1$ and $C_2$ are determined by the no-slip boundary conditions at the walls, $u(y=\\pm H) = 0$.\n$u(H) = C_1 \\cosh(\\alpha H) + C_2 \\sinh(\\alpha H) + \\frac{GK}{\\mu} = 0$\n$u(-H) = C_1 \\cosh(-\\alpha H) + C_2 \\sinh(-\\alpha H) + \\frac{GK}{\\mu} = C_1 \\cosh(\\alpha H) - C_2 \\sinh(\\alpha H) + \\frac{GK}{\\mu} = 0$\nSubtracting the second equation from the first yields $2 C_2 \\sinh(\\alpha H) = 0$. Since $\\alpha > 0$ and $H>0$, $\\sinh(\\alpha H) \\neq 0$, which implies $C_2 = 0$. This confirms the expectation that the velocity profile must be an even function of $y$ due to the symmetry of the problem.\nSubstituting $C_2=0$ into the first boundary condition equation gives:\n$C_1 \\cosh(\\alpha H) + \\frac{GK}{\\mu} = 0 \\implies C_1 = -\\frac{GK/\\mu}{\\cosh(\\alpha H)}$.\n\nSubstituting the constants back into the general solution, we obtain the exact velocity profile:\n$$\nu(y) = \\frac{GK}{\\mu} - \\frac{GK/\\mu}{\\cosh(\\alpha H)} \\cosh(\\alpha y) = \\frac{GK}{\\mu} \\left( 1 - \\frac{\\cosh(\\alpha y)}{\\cosh(\\alpha H)} \\right)\n$$\nNext, we calculate the volumetric flow rate per unit width, $Q'$, by integrating the velocity profile from $y=-H$ to $y=H$:\n$$\nQ' = \\int_{-H}^{H} u(y) \\, \\mathrm{d}y = \\int_{-H}^{H} \\frac{GK}{\\mu} \\left( 1 - \\frac{\\cosh(\\alpha y)}{\\cosh(\\alpha H)} \\right) \\, \\mathrm{d}y\n$$\nSince the integrand is an even function, we can simplify the integral:\n$$\nQ' = 2 \\frac{GK}{\\mu} \\int_{0}^{H} \\left( 1 - \\frac{\\cosh(\\alpha y)}{\\cosh(\\alpha H)} \\right) \\, \\mathrm{d}y\n$$\n$$\nQ' = 2 \\frac{GK}{\\mu} \\left[ y - \\frac{\\sinh(\\alpha y)}{\\alpha \\cosh(\\alpha H)} \\right]_{0}^{H} = 2 \\frac{GK}{\\mu} \\left( (H - \\frac{\\sinh(\\alpha H)}{\\alpha \\cosh(\\alpha H)}) - (0 - 0) \\right)\n$$\n$$\nQ' = 2 \\frac{GK}{\\mu} \\left( H - \\frac{\\tanh(\\alpha H)}{\\alpha} \\right)\n$$\nFinally, we non-dimensionalize the flow rate $Q'$ to obtain $\\Phi$. The problem defines $\\Phi = \\frac{Q'}{2HU_{D}}$, with the characteristic Darcy velocity $U_D = \\frac{GK}{\\mu}$.\n$$\n\\Phi = \\frac{2 \\frac{GK}{\\mu} \\left( H - \\frac{\\tanh(\\alpha H)}{\\alpha} \\right)}{2H \\left(\\frac{GK}{\\mu}\\right)}\n$$\nCanceling common terms gives:\n$$\n\\Phi = \\frac{H - \\frac{\\tanh(\\alpha H)}{\\alpha}}{H} = 1 - \\frac{\\tanh(\\alpha H)}{\\alpha H}\n$$\nThe problem specifies the result in terms of the dimensionless Brinkman screening parameter $\\Lambda = H\\sqrt{\\frac{\\mu}{\\mu_{e}K}}$. Comparing this with our definition $\\alpha = \\sqrt{\\frac{\\mu}{\\mu_e K}}$, we see that $\\alpha H = H\\sqrt{\\frac{\\mu}{\\mu_e K}} = \\Lambda$.\nSubstituting $\\alpha H = \\Lambda$ into the expression for $\\Phi$ yields the final result:\n$$\n\\Phi = 1 - \\frac{\\tanh(\\Lambda)}{\\Lambda}\n$$",
            "answer": "$$\\boxed{1 - \\frac{\\tanh(\\Lambda)}{\\Lambda}}$$"
        },
        {
            "introduction": "While the linear Darcy and Brinkman models are powerful, many real-world flows operate at speeds where inertial effects become significant. This exercise focuses on a crucial aspect of porous media modeling: identifying the transition from the viscous-dominated (Darcy) regime to the inertial-dominated (Forchheimer) regime . Through a scaling analysis, you will determine the critical flow velocity at which the quadratic drag term becomes comparable to the linear viscous drag, a key step in deciding which model is appropriate for a given application.",
            "id": "4079860",
            "problem": "An energy storage system uses a ceramic packed-bed regenerator through which liquid water flows. The packed bed is modeled as a homogeneous, isotropic porous continuum within a Computational Fluid Dynamics (CFD) solver. The fluid is Newtonian and incompressible, and the flow is steady. The porosity is $\\varepsilon$, the permeability is $K$, the dynamic viscosity is $\\mu$, and the density is $\\rho$. The Darcy law expresses a linear relationship between the volume-averaged superficial velocity $\\mathbf{u}$ and the pressure gradient, but at higher flow rates, departures from linearity are observed due to finite-pore viscous diffusion and inertial effects in the pore-scale momentum transport. The Brinkman–Forchheimer extension to Darcy’s law adds a viscous diffusion term that accounts for shear in the porous medium and a quadratic inertial term given by $\\rho \\beta |\\mathbf{u}|\\mathbf{u}$, where $\\beta$ is the Forchheimer inertial resistance coefficient (in $\\text{m}^{-1}$). A common scaling in packed beds is $\\beta = F/\\sqrt{K}$ with a dimensionless form factor $F = \\mathcal{O}(1)$.\n\nStarting from the momentum conservation equation for an incompressible Newtonian fluid at the pore scale, use volume averaging and constitutive closure at the macroscale to identify the correct form of the extended momentum balance and to determine a quantitative condition under which the magnitude of the inertial term, $\\rho \\beta |\\mathbf{u}|^2$, becomes dynamically comparable to the magnitude of the viscous drag term, $(\\mu/K) |\\mathbf{u}|$, at high superficial velocities. For the packed bed considered, take the numerical values:\n- $\\rho = 1000\\,\\mathrm{kg/m^3}$,\n- $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa \\cdot s}$,\n- $K = 5.0\\times 10^{-9}\\,\\mathrm{m^2}$,\n- $\\varepsilon = 0.40$,\n- dimensionless form factor $F = 1.8$, so that $\\beta = F/\\sqrt{K}$.\n\nWhich option correctly provides the extended momentum equation and the critical superficial speed $|\\mathbf{u}|$ at which the magnitude of the inertial term is of the same order as the viscous drag term?\n\nA. $-\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} - \\rho \\beta |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$ with $\\mu_e = \\mu/\\varepsilon$; the inertial term becomes comparable to viscous drag when $\\rho \\beta K |\\mathbf{u}|/\\mu \\approx 1$, giving $|\\mathbf{u}| \\approx 7.9\\times 10^{-3}\\,\\mathrm{m/s}$ for the stated parameters.\n\nB. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} - \\rho \\beta |\\mathbf{u}|^2 = \\mathbf{0}$; the inertial term becomes comparable when $\\rho \\beta K |\\mathbf{u}|^2/\\mu \\approx 1$, yielding $|\\mathbf{u}| \\approx 8.8\\times 10^{-2}\\,\\mathrm{m/s}$.\n\nC. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} = \\mathbf{0}$; the inertial term is negligible unless $\\varepsilon > 0.9$, so no threshold based on $|\\mathbf{u}|$ is needed for the given parameters.\n\nD. $-\\nabla p - \\dfrac{\\mu}{K}\\mathbf{u} - \\rho \\beta |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$; the inertial term becomes comparable when $\\rho \\beta K |\\mathbf{u}|\\varepsilon/\\mu \\approx 1$, giving $|\\mathbf{u}| \\approx 3.1\\times 10^{-3}\\,\\mathrm{m/s}$ for the stated parameters.",
            "solution": "The user wants me to validate and solve a problem concerning fluid flow in a porous medium, governed by the Brinkman-Forchheimer equation.\n\n### Problem Validation\n\nFirst, I will validate the problem statement.\n\n**Step 1: Extract Givens**\n\n-   **System:** A ceramic packed-bed regenerator with liquid water flow, modeled as a homogeneous, isotropic porous continuum.\n-   **Fluid Properties:** Newtonian, incompressible, density $\\rho$, dynamic viscosity $\\mu$.\n-   **Flow:** Steady.\n-   **Porous Medium Properties:** Porosity $\\varepsilon$, permeability $K$.\n-   **Governing Model:** Brinkman–Forchheimer extension to Darcy’s law, which includes a viscous diffusion term and a quadratic inertial term. The inertial term is given as being proportional to $|\\mathbf{u}|\\mathbf{u}$.\n-   **Forchheimer Coefficient:** `β` (units m⁻¹).\n-   **Scaling for Forchheimer Coefficient:** `β = F/√K` where `F` is a dimensionless form factor.\n-   **Numerical Values:**\n    -   $\\rho = 1000\\,\\mathrm{kg/m^3}$\n    -   $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa \\cdot s}$\n    -   $K = 5.0\\times 10^{-9}\\,\\mathrm{m^2}$\n    -   $\\varepsilon = 0.40$\n    -   $F = 1.8$\n-   **Question:**\n    1.  Identify the correct form of the extended momentum balance equation.\n    2.  Determine the condition for which the inertial term's magnitude, `ρβ|u|²`, is dynamically comparable to the viscous drag term's magnitude, `(μ/K)|u|`.\n    3.  Calculate the critical superficial speed $|\\mathbf{u}|$ based on this condition.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded:** The problem is based on the well-established Brinkman-Forchheimer model for flow in porous media. This model is a standard extension of Darcy's law used in computational fluid dynamics and is firmly grounded in fluid mechanics principles.\n-   **Well-Posed:** The problem provides a clear objective and all necessary physical parameters and constitutive relations ($\\rho$, $\\mu$, $K$, $\\varepsilon$, `F`, and the scaling for `β`) to formulate the equations and perform the required calculation. A unique solution for the critical speed can be determined.\n-   **Objective:** The problem is stated using precise, objective, and standard scientific terminology.\n-   **Flaw Checklist:** All checks pass. The problem is valid.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. I will proceed to derive the solution.\n\n### Solution Derivation\n\nThe problem asks for the correct form of the steady-state momentum balance equation for an incompressible fluid in a porous medium, as described by the Brinkman-Forchheimer model, and to perform a subsequent analysis.\n\n**1. The Brinkman-Forchheimer Equation**\n\nThe volume-averaged momentum conservation equation for steady flow in a porous medium balances the pressure gradient force with various resistance (drag) forces and accounts for macroscopic viscous diffusion. The equation is the sum of forces per unit volume.\n\n-   **Pressure Gradient Force:** $-\\nabla p$, where $p$ is the macroscopic pressure.\n-   **Viscous Drag Force (Darcy term):** This term represents the bulk drag from the solid matrix and is given by $-\\dfrac{\\mu}{K}\\mathbf{u}$, where $\\mathbf{u}$ is the superficial velocity.\n-   **Inertial Drag Force (Forchheimer term):** This term accounts for the pressure drop due to inertial effects and is given as $-\\rho \\beta |\\mathbf{u}|\\mathbf{u}$.\n-   **Viscous Diffusion (Brinkman term):** This term accounts for the transport of momentum by viscous shear stresses at the macroscale, written as $\\mu_e \\nabla^2 \\mathbf{u}$, where $\\mu_e$ is an effective viscosity.\n\nSumming these forces to zero gives the standard form of the Brinkman-Forchheimer equation:\n$$ -\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\frac{\\mu}{K}\\mathbf{u} - \\rho \\beta |\\mathbf{u}|\\mathbf{u} = \\mathbf{0} $$\nThe drag terms (Darcy and Forchheimer) oppose the flow and thus have negative signs when summed with the driving pressure force $(-\\nabla p)$.\n\n**2. Condition for Comparing Inertial and Viscous Drag Terms**\n\nThe problem asks to find when the inertial term becomes dynamically comparable to the viscous drag term. This is determined by equating the magnitudes of the two terms.\n-   Magnitude of the inertial term: $\\| -\\rho \\beta |\\mathbf{u}|\\mathbf{u} \\| = \\rho \\beta |\\mathbf{u}|^2$.\n-   Magnitude of the viscous drag term: $\\| -\\dfrac{\\mu}{K}\\mathbf{u} \\| = \\dfrac{\\mu}{K} |\\mathbf{u}|$.\n\nSetting them to be of the same order of magnitude:\n$$ \\rho \\beta |\\mathbf{u}|^2 \\approx \\frac{\\mu}{K} |\\mathbf{u}| $$\nAssuming a non-zero velocity, $|\\mathbf{u}| \\neq 0$, we can divide by $|\\mathbf{u}|$:\n$$ \\rho \\beta |\\mathbf{u}| \\approx \\frac{\\mu}{K} $$\nTo express this as a dimensionless criterion, we can rearrange the terms:\n$$ \\frac{\\rho \\beta K |\\mathbf{u}|}{\\mu} \\approx 1 $$\nThis dimensionless group, sometimes called the Forchheimer number, represents the ratio of inertial drag to viscous drag. The transition to the inertial regime occurs when this number is of order unity.\n\n**3. Calculation of the Critical Superficial Speed $|\\mathbf{u}|$**\n\nWe solve the condition for $|\\mathbf{u}|$:\n$$ |\\mathbf{u}| \\approx \\frac{\\mu}{\\rho \\beta K} $$\nThe problem provides a scaling for $\\beta$: $\\beta = F/\\sqrt{K}$. Substituting this gives:\n$$ |\\mathbf{u}| \\approx \\frac{\\mu}{\\rho (F/\\sqrt{K}) K} = \\frac{\\mu \\sqrt{K}}{\\rho F K} = \\frac{\\mu}{\\rho F \\sqrt{K}} $$\nNow, we substitute the given numerical values:\n-   $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa \\cdot s}$\n-   $F = 1.8$\n-   $\\rho = 1000\\,\\mathrm{kg/m^3}$\n-   $K = 5.0\\times 10^{-9}\\,\\mathrm{m^2}$\n\nFirst, calculate $\\sqrt{K}$:\n$$ \\sqrt{K} = \\sqrt{5.0 \\times 10^{-9}}\\,\\mathrm{m} \\approx 7.07107 \\times 10^{-5}\\,\\mathrm{m} $$\nNow, calculate $|\\mathbf{u}|$:\n$$ |\\mathbf{u}| \\approx \\frac{1.0 \\times 10^{-3}\\,\\mathrm{Pa \\cdot s}}{1000\\,\\mathrm{kg/m^3} \\times 1.8 \\times 7.07107 \\times 10^{-5}\\,\\mathrm{m}} $$\n$$ |\\mathbf{u}| \\approx \\frac{1.0 \\times 10^{-3}}{1.8 \\times 10^3 \\times 7.07107 \\times 10^{-5}} \\,\\mathrm{m/s} $$\n$$ |\\mathbf{u}| \\approx \\frac{1.0 \\times 10^{-3}}{127.279} \\,\\mathrm{m/s} \\approx 7.8567 \\times 10^{-6} \\times 1000/1000 \\approx 7.8567 \\times 10^{-3} / 1 = 7.8567 \\times 10^{-3} m/s$$\n$$ |\\mathbf{u}| \\approx \\frac{1.0 \\times 10^{-3}}{0.127279} \\,\\mathrm{m/s} \\approx 7.8567 \\times 10^{-3}\\,\\mathrm{m/s} $$\nRounding to two significant figures, we get $|\\mathbf{u}| \\approx 7.9 \\times 10^{-3}\\,\\mathrm{m/s}$.\n\n### Option-by-Option Analysis\n\n**A. $-\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} - \\rho \\beta |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$ with $\\mu_e = \\mu/\\varepsilon$; the inertial term becomes comparable to viscous drag when $\\rho \\beta K |\\mathbf{u}|/\\mu \\approx 1$, giving $|\\mathbf{u}| \\approx 7.9\\times 10^{-3}\\,\\mathrm{m/s}$ for the stated parameters.**\n-   **Equation:** This equation correctly contains all components of the Brinkman-Forchheimer model (pressure, Brinkman, Darcy, Forchheimer) with the correct signs for drag terms. The choice of effective viscosity $\\mu_e = \\mu/\\varepsilon$ is a physically plausible closure model.\n-   **Condition:** The condition $\\rho \\beta K |\\mathbf{u}|/\\mu \\approx 1$ correctly represents the ratio of the magnitudes of the inertial and viscous drag terms.\n-   **Calculation:** The calculated speed $|\\mathbf{u}| \\approx 7.9\\times 10^{-3}\\,\\mathrm{m/s}$ matches our derivation.\n-   **Verdict:** **Correct**.\n\n**B. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} - \\rho \\beta |\\mathbf{u}|^2 = \\mathbf{0}$; the inertial term becomes comparable when $\\rho \\beta K |\\mathbf{u}|^2/\\mu \\approx 1$, yielding $|\\mathbf{u}| \\approx 8.8\\times 10^{-2}\\,\\mathrm{m/s}$.**\n-   **Equation:** The term $\\rho \\beta |\\mathbf{u}|^2$ is a scalar quantity. It cannot be added to the other vector terms in the momentum equation. This is a fundamental error in vector algebra.\n-   **Verdict:** **Incorrect**.\n\n**C. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} = \\mathbf{0}$; the inertial term is negligible unless $\\varepsilon > 0.9$, so no threshold based on $|\\mathbf{u}|$ is needed for the given parameters.**\n-   **Equation:** This is the Brinkman-Darcy equation; it omits the Forchheimer inertial term, which is the subject of the question.\n-   **Condition:** The statement that the inertial term is negligible contradicts the premise of the question.\n-   **Verdict:** **Incorrect**.\n\n**D. $-\\nabla p - \\dfrac{\\mu}{K}\\mathbf{u} - \\rho \\beta |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$; the inertial term becomes comparable when $\\rho \\beta K |\\mathbf{u}|\\varepsilon/\\mu \\approx 1$, giving $|\\mathbf{u}| \\approx 3.1\\times 10^{-3}\\,\\mathrm{m/s}$ for the stated parameters.**\n-   **Equation:** This equation omits the Brinkman term ($\\mu_e \\nabla^2 \\mathbf{u}$). The problem explicitly asks for the \"Brinkman-Forchheimer\" model. This equation is incomplete.\n-   **Condition:** The proposed condition $\\rho \\beta K |\\mathbf{u}|\\varepsilon/\\mu \\approx 1$ introduces the porosity $\\varepsilon$ without justification from a direct comparison of the macroscopic drag terms.\n-   **Verdict:** **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A physical model's true value lies in its ability to connect with experimental reality. This final practice moves from theory to application by tasking you with a core engineering problem: determining model parameters from measurement data . You will develop and implement a computational procedure using linear regression to extract the fundamental properties of a porous medium—its permeability $K$ and inertial resistance coefficient $\\beta$—from a set of pressure gradient and flow rate measurements, a common task in material characterization and system validation.",
            "id": "3989580",
            "problem": "You are tasked with deriving, implementing, and validating a parameter identification procedure for flow through a rigid, homogeneous, isotropic porous medium governed by the Brinkman–Forchheimer extended Darcy model. The focus is on the steady, incompressible, isothermal regime with a constant cross-section and negligible body forces. Your work must proceed from fundamental laws and yield a computational method that estimates permeability and inertial resistance from pressure–flow measurements, followed by quantitative model validation.\n\nStarting point and modeling assumptions:\n- Begin from conservation of linear momentum for a Newtonian fluid with dynamic viscosity $\\mu$ and density $\\rho$ moving steadily through a porous medium. Use the volume-averaged form of the equations appropriate for porous media, which include a linear drag term proportional to the superficial velocity (Darcy contribution), a quadratic drag term proportional to the product of the magnitude of superficial velocity and the superficial velocity (Forchheimer contribution), and a viscous diffusion term proportional to the Laplacian of the superficial velocity (Brinkman contribution).\n- Assume one-dimensional, fully developed flow in the streamwise direction, constant porosity, constant cross-section, and negligible spatial variation of the cross-sectionally averaged streamwise velocity profile, so that the cross-sectionally averaged viscous diffusion term can be neglected at the scale of the averaging length in the streamwise direction. State these assumptions explicitly in your derivation.\n\nTasks:\n1) Derive, from first principles under the assumptions above, the one-dimensional, steady, cross-sectionally averaged streamwise momentum balance. Your derivation should show why the streamwise pressure gradient can be represented as a linear combination of two regressors constructed from the superficial velocity, and it must make explicit which unknown parameters enter linearly. Do not invoke any empirical equation beyond the existence of linear and quadratic drag contributions; instead, connect these drag terms to the momentum balance and clearly justify neglect of the cross-section-averaged viscous diffusion term under the stated assumptions. Clearly identify how permeability and the inertial resistance coefficient are related to the linear regression coefficients.\n\n2) Based on your derived regression-ready form, design an ordinary least squares estimator for the unknown parameters. Provide explicit formulas to recover permeability $K$ in $\\text{m}^{2}$ and the Forchheimer inertial resistance coefficient $\\beta$ in $\\text{m}^{-1}$ from the fitted regression coefficients. Define the Root Mean Square Error (RMSE) and the coefficient of determination $R^{2}$ that will be used to assess goodness of fit. The RMSE must be reported in $\\text{Pa}/\\text{m}$. The $R^{2}$ must be reported as a pure number.\n\n3) Implement a complete program that, for each of the following independent test datasets, estimates $\\widehat{K}$ and $\\widehat{\\beta}$ and computes the RMSE and $R^{2}$. Use ordinary least squares on the regression structure implied by your derivation. Use the following material properties for all cases: $\\mu = 1.0\\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$ and $\\rho = 1000\\ \\text{kg}/\\text{m}^{3}$. The superficial velocity is denoted by $U$ in $\\text{m}/\\text{s}$, and the measured streamwise pressure gradient is denoted by $g$ in $\\text{Pa}/\\text{m}$.\n\nTest suite (each case provides $\\{U_{i}\\}$ and $\\{g_{i}\\}$):\n- Case $1$ (general mixed regime):\n  - $U = [0.02, 0.04, 0.06, 0.10, 0.15]\\ \\text{m}/\\text{s}$\n  - $g = [7066.6666667, 14933.3333333, 23600.0, 43333.3333333, 72500.0]\\ \\text{Pa}/\\text{m}$\n- Case $2$ (Darcy-dominated regime):\n  - $U = [0.002, 0.004, 0.006, 0.008, 0.010]\\ \\text{m}/\\text{s}$\n  - $g = [200.8, 403.2, 607.2, 812.8, 1020.0]\\ \\text{Pa}/\\text{m}$\n- Case $3$ (Forchheimer-dominated regime):\n  - $U = [0.5, 0.7, 0.9, 1.1]\\ \\text{m}/\\text{s}$\n  - $g = [635000.0, 1239000.0, 2043000.0, 3047000.0]\\ \\text{Pa}/\\text{m}$\n- Case $4$ (sign change to test handling of direction):\n  - $U = [-0.2, -0.1, 0.0, 0.1, 0.2]\\ \\text{m}/\\text{s}$\n  - $g = [-160000.0, -65000.0, 0.0, 65000.0, 160000.0]\\ \\text{Pa}/\\text{m}$\n- Case $5$ (boundary case with negligible quadratic drag):\n  - $U = [0.01, 0.02, 0.03, 0.04]\\ \\text{m}/\\texts}$\n  - $g = [8333.3333333, 16666.6666667, 25000.0, 33333.3333333]\\ \\text{Pa}/\\text{m}$\n\nNumerical and reporting requirements:\n- Implement ordinary least squares without regularization on the regression structure implied by your derivation and compute estimates $\\widehat{K}$ and $\\widehat{\\beta}$.\n- Compute the RMSE in $\\text{Pa}/\\text{m}$ and $R^{2}$ for each case using your fitted model predictions.\n- Report $\\widehat{K}$ in $\\text{m}^{2}$, $\\widehat{\\beta}$ in $\\text{m}^{-1}$, and RMSE in $\\text{Pa}/\\text{m}$. The $R^{2}$ is unitless. Round each reported number to $6$ significant figures.\n- Your program should produce a single line of output containing the results for all cases as a list of lists in the order of the cases, where each inner list is $[\\widehat{K}, \\widehat{\\beta}, \\text{RMSE}, R^{2}]$. The output must be a single line in the exact format:\n\"[ [k1,beta1,rmse1,r21], [k2,beta2,rmse2,r22], [k3,beta3,rmse3,r23], [k4,beta4,rmse4,r24], [k5,beta5,rmse5,r25] ]\"\nUse standard decimal or scientific notation as needed by rounding to $6$ significant figures. No additional text should be printed.",
            "solution": "We begin with the conservation of linear momentum for a steady, incompressible Newtonian fluid of dynamic viscosity $\\mu$ and density $\\rho$ moving through a rigid, homogeneous, isotropic porous medium. In the volume-averaged formulation suitable for porous media, the Brinkman–Forchheimer extended Darcy model augments Darcy’s linear drag with Brinkman’s viscous diffusion and Forchheimer’s quadratic inertial drag. The streamwise component of the volume-averaged momentum balance can be written as\n$$\n\\mathbf{0} = - \\nabla \\langle p \\rangle + \\mu_{e} \\nabla^{2} \\langle \\mathbf{u} \\rangle - \\frac{\\mu}{K}\\, \\langle \\mathbf{u} \\rangle - \\rho\\, \\beta\\, |\\langle \\mathbf{u} \\rangle| \\langle \\mathbf{u} \\rangle,\n$$\nwhere $\\langle \\cdot \\rangle$ denotes an intrinsic or superficial average over a representative elementary volume, $K$ is the permeability in $\\text{m}^{2}$, and $\\beta$ is the inertial resistance coefficient in $\\text{m}^{-1}$. The term $\\mu_{e} \\nabla^{2} \\langle \\mathbf{u} \\rangle$ is the Brinkman viscous diffusion contribution, with $\\mu_{e}$ an effective viscosity. For steady, one-dimensional, fully developed flow in the $x$ direction with constant cross-section and negligible cross-sectional variation of the average streamwise velocity profile, the cross-sectionally averaged Laplacian of the average streamwise velocity vanishes over the averaging length in the $x$ direction. This is justified when the characteristic streamwise variation length scale is large compared to the pore-scale and the flow is fully developed such that entrance and wall-layer effects are confined to thin regions that do not contribute at the averaging scale. Under these conditions, the cross-sectionally averaged Brinkman term can be neglected in the streamwise balance.\n\nLet $U$ denote the cross-sectionally averaged superficial velocity in the $x$ direction and let $g = - \\mathrm{d}\\langle p \\rangle / \\mathrm{d}x$ denote the streamwise pressure gradient (positive when pressure drops in the direction of the flow). The one-dimensional, fully developed, cross-sectionally averaged streamwise momentum balance simplifies to the algebraic balance of drag forces against the pressure gradient:\n$$\ng = \\frac{\\mu}{K}\\, U + \\rho\\, \\beta\\, \\lvert U \\rvert\\, U.\n$$\nThis expression represents $g$ as a linear combination of two regressors constructed from $U$, namely $U$ and $\\lvert U \\rvert U$, with unknown coefficients that enter linearly. Define two regression coefficients\n$$\na \\equiv \\frac{\\mu}{K}, \\qquad b \\equiv \\rho\\, \\beta.\n$$\nThen the model becomes\n$$\ng = a\\, U + b\\, \\lvert U \\rvert\\, U,\n$$\nwhich is linear in the unknowns $a$ and $b$. Once $a$ and $b$ are estimated from data, the physical parameters are recovered by\n$$\n\\widehat{K} = \\frac{\\mu}{\\widehat{a}}, \\qquad \\widehat{\\beta} = \\frac{\\widehat{b}}{\\rho}.\n$$\n\nGiven $n$ measurements $\\{(U_{i}, g_{i})\\}_{i=1}^{n}$, construct the $n \\times 2$ design matrix\n$$\n\\mathbf{X} = \\begin{bmatrix}\nU_{1} & \\lvert U_{1} \\rvert U_{1} \\\\\nU_{2} & \\lvert U_{2} \\rvert U_{2} \\\\\n\\vdots & \\vdots \\\\\nU_{n} & \\lvert U_{n} \\rvert U_{n}\n\\end{bmatrix},\n$$\nand the observation vector\n$$\n\\mathbf{y} = \\begin{bmatrix} g_{1} \\\\ g_{2} \\\\ \\vdots \\\\ g_{n} \\end{bmatrix}.\n$$\nThe ordinary least squares estimator $\\widehat{\\boldsymbol{\\theta}} = [\\widehat{a}, \\widehat{b}]^{\\top}$ minimizes the residual sum of squares and is given by\n$$\n\\widehat{\\boldsymbol{\\theta}} = \\underset{\\boldsymbol{\\theta} \\in \\mathbb{R}^{2}}{\\arg\\min}\\ \\lVert \\mathbf{X}\\, \\boldsymbol{\\theta} - \\mathbf{y} \\rVert_{2}^{2} = \\left(\\mathbf{X}^{\\top} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\top} \\mathbf{y},\n$$\nprovided $\\mathbf{X}^{\\top} \\mathbf{X}$ is invertible, or by the Moore–Penrose pseudoinverse more generally. The model predictions are $\\widehat{\\mathbf{g}} = \\mathbf{X}\\, \\widehat{\\boldsymbol{\\theta}}$, where $\\widehat{g}_{i}$ is the predicted pressure gradient corresponding to $U_{i}$.\n\nTo quantify model fit, compute the Root Mean Square Error (RMSE) and the coefficient of determination $R^{2}$:\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} \\left(g_{i} - \\widehat{g}_{i}\\right)^{2}}, \\qquad\nR^{2} = 1 - \\frac{\\sum_{i=1}^{n}\\left(g_{i} - \\widehat{g}_{i}\\right)^{2}}{\\sum_{i=1}^{n}\\left(g_{i} - \\overline{g}\\right)^{2}},\n$$\nwhere $\\overline{g} = \\frac{1}{n} \\sum_{i=1}^{n} g_{i}$. The RMSE carries units of $\\text{Pa}/\\text{m}$ and $R^{2}$ is unitless.\n\nAlgorithmic design:\n- For each dataset, assemble $\\mathbf{X}$ with columns $U_{i}$ and $\\lvert U_{i} \\rvert U_{i}$, and $\\mathbf{y}$ from $g_{i}$.\n- Solve for $\\widehat{a}$ and $\\widehat{b}$ using ordinary least squares (for example, via a numerically stable least squares solver).\n- Recover $\\widehat{K} = \\mu / \\widehat{a}$ in $\\text{m}^{2}$ and $\\widehat{\\beta} = \\widehat{b} / \\rho$ in $\\text{m}^{-1}$.\n- Compute $\\widehat{\\mathbf{g}}$, RMSE in $\\text{Pa}/\\text{m}$, and $R^{2}$.\n- Round each reported value to $6$ significant figures for output.\n\nApplication to the provided test suite:\n- All cases share $\\mu = 1.0 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$ and $\\rho = 1000\\ \\text{kg}/\\text{m}^{3}$.\n- The five datasets provide $\\{U_{i}\\}$ and $\\{g_{i}\\}$ with $U_{i}$ in $\\text{m}/\\text{s}$ and $g_{i}$ in $\\text{Pa}/\\text{m}$.\n- Assemble the design matrices and observation vectors, solve the least squares problems, and compute the requested metrics as described.\n\nFinal output specification:\n- Produce a single line containing a list of five inner lists ordered by the cases, where each inner list is $[\\widehat{K}, \\widehat{\\beta}, \\mathrm{RMSE}, R^{2}]$.\n- Units and rounding: $\\widehat{K}$ in $\\text{m}^{2}$, $\\widehat{\\beta}$ in $\\text{m}^{-1}$, $\\mathrm{RMSE}$ in $\\text{Pa}/\\text{m}$, $R^{2}$ unitless; each rounded to $6$ significant figures.\n- The output format must be exactly:\n\"[ [k1,beta1,rmse1,r21], [k2,beta2,rmse2,r22], [k3,beta3,rmse3,r23], [k4,beta4,rmse4,r24], [k5,beta5,rmse5,r25] ]\"\nwith no extra spaces beyond those shown being required, but commas separating entries and lists, and no additional text.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef ols_fit(U, g):\n    \"\"\"\n    Ordinary least squares fit for g = a*U + b*|U|*U.\n    Returns (a_hat, b_hat), predictions g_hat.\n    \"\"\"\n    U = np.asarray(U, dtype=float)\n    g = np.asarray(g, dtype=float)\n    X = np.column_stack([U, np.abs(U) * U])\n    # Use least squares solver for numerical stability\n    theta, *_ = np.linalg.lstsq(X, g, rcond=None)\n    g_hat = X @ theta\n    return theta, g_hat\n\ndef rmse_and_r2(g, g_hat):\n    g = np.asarray(g, dtype=float)\n    g_hat = np.asarray(g_hat, dtype=float)\n    resid = g - g_hat\n    rmse = np.sqrt(np.mean(resid**2))\n    # Numerical guard for tiny negative due to rounding\n    if abs(rmse)  1e-12:\n        rmse = 0.0\n    # R^2\n    denom = np.sum((g - np.mean(g))**2)\n    # If denom is zero (constant g), define R^2 = 1 if perfect fit else 0\n    if denom == 0.0:\n        r2 = 1.0 if np.allclose(g, g_hat, atol=1e-12, rtol=0.0) else 0.0\n    else:\n        r2 = 1.0 - np.sum(resid**2) / denom\n    # Clamp R^2 to [0,1] within numerical tolerance\n    if abs(r2 - 1.0)  1e-12:\n        r2 = 1.0\n    if abs(r2)  1e-12:\n        r2 = 0.0\n    return rmse, r2\n\ndef format_sigfig(x, sig=6):\n    # Format to a string with a given number of significant figures\n    # Use general format; ensure \"0\" for very small numbers\n    if x == 0.0:\n        return \"0\"\n    return f\"{x:.{sig}g}\"\n\ndef solve():\n    # Fluid properties (common to all cases)\n    mu = 1.0e-3  # Pa*s\n    rho = 1000.0  # kg/m^3\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: (U_list [m/s], g_list [Pa/m])\n        ([0.02, 0.04, 0.06, 0.10, 0.15],\n         [7066.6666667, 14933.3333333, 23600.0, 43333.3333333, 72500.0]),\n        ([0.002, 0.004, 0.006, 0.008, 0.010],\n         [200.8, 403.2, 607.2, 812.8, 1020.0]),\n        ([0.5, 0.7, 0.9, 1.1],\n         [635000.0, 1239000.0, 2043000.0, 3047000.0]),\n        ([-0.2, -0.1, 0.0, 0.1, 0.2],\n         [-160000.0, -65000.0, 0.0, 65000.0, 160000.0]),\n        ([0.01, 0.02, 0.03, 0.04],\n         [8333.3333333, 16666.6666667, 25000.0, 33333.3333333]),\n    ]\n\n    results = []\n    for U, g in test_cases:\n        theta, g_hat = ols_fit(U, g)\n        a_hat, b_hat = theta[0], theta[1]\n        # Recover physical parameters\n        # K_hat in m^2, beta_hat in 1/m\n        if abs(a_hat)  1e-12: # Avoid division by zero\n            K_hat = float('inf')\n        else:\n            K_hat = mu / a_hat\n\n        beta_hat = b_hat / rho\n        # Validation metrics\n        rmse, r2 = rmse_and_r2(g, g_hat)\n        results.append([K_hat, beta_hat, rmse, r2])\n\n    # Format results to required 6 significant figures\n    formatted = []\n    for K_hat, beta_hat, rmse, r2 in results:\n        formatted.append(\n            \"[\" + \",\".join([\n                format_sigfig(K_hat, 6),\n                format_sigfig(beta_hat, 6),\n                format_sigfig(rmse, 6),\n                format_sigfig(r2, 6)\n            ]) + \"]\"\n        )\n\n    # Final print statement in the exact required format.\n    print(\"[\" + \", \".join(formatted) + \"]\")\n\nsolve()\n```"
        }
    ]
}