{
    "hands_on_practices": [
        {
            "introduction": "Understanding the fundamental conservation laws in their integral form is paramount in fluid dynamics. This exercise reinforces first principles by having you derive the classic Rankine-Hugoniot relations for a normal shock wave from scratch. By starting with the laws of conservation for mass, momentum, and energy, you will derive the downstream properties and explicitly verify that the total energy is conserved across this sharp, irreversible discontinuity, solidifying your grasp on the cornerstone of compressible flow theory .",
            "id": "3940536",
            "problem": "Consider a steady, one-dimensional, inviscid, adiabatic normal shock in a calorically perfect gas with ratio of specific heats $\\gamma$. The upstream state is characterized by static pressure $p_{1}$, static temperature $T_{1}$, density $\\rho_{1}$, and flow speed $u_{1}$. The upstream Mach number is $M_{1} \\equiv u_{1}/a_{1}$, where the speed of sound is $a \\equiv \\sqrt{\\gamma R T}$ for an ideal gas with constant gas constant $R$ and constant specific heat at constant pressure $c_{p} \\equiv \\gamma R / (\\gamma - 1)$. Downstream quantities are $p_{2}$, $T_{2}$, $\\rho_{2}$, and $u_{2}$. The shock is stationary and planar, and there is no external shaft work or heat addition to the control volume.\n\nStarting only from the integral conservation laws of mass, momentum, and energy across the shock, the ideal gas equation of state $p=\\rho R T$, the definition of enthalpy for a calorically perfect gas $h=c_{p} T$, and the definition of the Mach number, perform the following:\n\n- Derive closed-form analytic expressions for the dimensionless downstream-to-upstream ratios $p_{2}/p_{1}$ and $T_{2}/T_{1}$ in terms of $M_{1}$ and $\\gamma$.\n- Using the compressible energy equation, form the stagnation enthalpy difference $h_{0,2} - h_{0,1}$, where $h_{0} \\equiv h + u^{2}/2$, and express it entirely in terms of $M_{1}$ and $\\gamma$ by substituting your derived relations, to verify energy conservation.\n\nExpress your final answer as a single row matrix whose entries are, in order, $\\left(p_{2}/p_{1}\\right)$, $\\left(T_{2}/T_{1}\\right)$, and $\\left(h_{0,2} - h_{0,1}\\right)$, all as exact symbolic functions of $M_{1}$ and $\\gamma$. These quantities are dimensionless except $h_{0,2} - h_{0,1}$, which you should express in a form that shows it evaluates identically to zero without needing units. No numerical approximation or rounding is required.",
            "solution": "The user-provided problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **System:** Steady, one-dimensional, inviscid, adiabatic normal shock.\n- **Fluid:** Calorically perfect gas.\n- **Upstream State (1):** Static pressure $p_{1}$, static temperature $T_{1}$, density $\\rho_{1}$, flow speed $u_{1}$, Mach number $M_{1}$.\n- **Downstream State (2):** Static pressure $p_{2}$, static temperature $T_{2}$, density $\\rho_{2}$, flow speed $u_{2}$.\n- **Constants and Definitions:**\n    - Ratio of specific heats: $\\gamma$.\n    - Gas constant: $R$.\n    - Speed of sound: $a \\equiv \\sqrt{\\gamma R T}$.\n    - Mach number: $M_{1} \\equiv u_{1}/a_{1}$.\n    - Ideal gas equation of state: $p=\\rho R T$.\n    - Specific heat at constant pressure: $c_{p} \\equiv \\gamma R / (\\gamma - 1)$.\n    - Enthalpy for a calorically perfect gas: $h=c_{p} T$.\n    - Stagnation enthalpy: $h_{0} \\equiv h + u^{2}/2$.\n- **Constraints:** No external shaft work or heat addition.\n- **Task:**\n    1. Derive expressions for $p_{2}/p_{1}$ and $T_{2}/T_{1}$ in terms of $M_{1}$ and $\\gamma$.\n    2. Verify energy conservation by showing $h_{0,2} - h_{0,1} = 0$ using the derived relations.\n    3. Provide the final answer as a row matrix containing the expressions for $p_{2}/p_{1}$, $T_{2}/T_{1}$, and $h_{0,2} - h_{0,1}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a classic exercise in compressible fluid dynamics, dealing with the fundamental physics of normal shock waves. The governing equations and gas model are standard and scientifically sound.\n- **Well-Posed:** All necessary information, including the fundamental conservation laws and equations of state, are provided to derive the required quantities. The problem is well-defined and has a unique solution.\n- **Objective:** The language is formal, precise, and devoid of any subjective or opinion-based content.\n\n### Step 3: Verdict and Action\nThe problem is scientifically valid, well-posed, and objective. It passes all validation criteria. A solution will be generated.\n\n### Derivation\nWe begin with the one-dimensional integral conservation laws for a control volume across a stationary normal shock:\n\n1.  **Conservation of Mass (Continuity):**\n    $$ \\rho_{1} u_{1} = \\rho_{2} u_{2} $$\n2.  **Conservation of Momentum:**\n    $$ p_{1} + \\rho_{1} u_{1}^{2} = p_{2} + \\rho_{2} u_{2}^{2} $$\n3.  **Conservation of Energy:** For adiabatic flow with no shaft work, stagnation enthalpy is conserved.\n    $$ h_{1} + \\frac{1}{2} u_{1}^{2} = h_{2} + \\frac{1}{2} u_{2}^{2} $$\n    This is equivalent to stating that the change in stagnation enthalpy is zero: $h_{0,2} - h_{0,1} = 0$.\n\nThese three laws must be solved simultaneously along with the equation of state and definitions for a calorically perfect gas:\n-   **Ideal Gas Law:** $p = \\rho R T$\n-   **Enthalpy:** $h = c_{p} T = \\frac{\\gamma R}{\\gamma-1} T = \\frac{\\gamma}{\\gamma-1} \\frac{p}{\\rho}$\n\nLet's combine the conservation laws to form the Rankine-Hugoniot relations. From the energy equation:\n$h_{2} - h_{1} = \\frac{1}{2}(u_{1}^{2} - u_{2}^{2})$.\nFrom continuity, $u_2 = u_1 (\\rho_1 / \\rho_2)$, so $u_{1}^{2} - u_{2}^{2} = u_{1}^{2}(1 - (\\rho_1/\\rho_2)^2) = u_1^2(\\frac{\\rho_2-\\rho_1}{\\rho_2})(\\frac{\\rho_2+\\rho_1}{\\rho_2})$. This is not the most direct path.\n\nLet's reformulate the momentum equation:\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} - \\rho_{2} u_{2}^{2}$. Using continuity, $\\rho_2 u_2^2 = (\\rho_1 u_1) u_2$.\n$p_{2} - p_{1} = \\rho_{1} u_{1} u_{1} - (\\rho_1 u_1) u_2 = \\rho_{1} u_{1} (u_1 - u_2)$.\nLet's return to the energy equation: $h_{2} - h_{1} = \\frac{1}{2}(u_1 - u_2)(u_1 + u_2)$.\nDividing these two expressions yields:\n$\\frac{h_2 - h_1}{p_2 - p_1} = \\frac{1}{2} \\frac{(u_1 - u_2)(u_1 + u_2)}{\\rho_1 u_1 (u_1 - u_2)} = \\frac{u_1+u_2}{2\\rho_1 u_1}$.\nUsing $u_2 = u_1 \\rho_1/\\rho_2$:\n$\\frac{u_1+u_2}{2\\rho_1 u_1} = \\frac{u_1(1+\\rho_1/\\rho_2)}{2\\rho_1 u_1} = \\frac{1}{2\\rho_1} (1+\\frac{\\rho_1}{\\rho_2}) = \\frac{1}{2}(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2})$.\nThus we obtain the Rankine-Hugoniot relation connecting enthalpy, pressure, and density:\n$$ h_{2} - h_{1} = \\frac{1}{2}(p_{2} - p_{1}) \\left(\\frac{1}{\\rho_{1}} + \\frac{1}{\\rho_{2}}\\right) $$\nNow, we substitute the enthalpy relation for a calorically perfect gas, $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$:\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_{2}}{\\rho_{2}} - \\frac{p_{1}}{\\rho_{1}}\\right) = \\frac{1}{2}(p_{2} - p_{1}) \\left(\\frac{1}{\\rho_{1}} + \\frac{1}{\\rho_{2}}\\right) $$\nLet the pressure ratio be $P \\equiv p_{2}/p_{1}$ and the density ratio be $X \\equiv \\rho_{2}/\\rho_{1}$. Dividing the equation by $p_{1}/\\rho_{1}$:\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{P}{X} - 1\\right) = \\frac{1}{2}(P - 1) \\left(1 + \\frac{1}{X}\\right) $$\n$$ \\frac{\\gamma}{\\gamma-1} \\frac{P-X}{X} = \\frac{1}{2}(P-1) \\frac{X+1}{X} $$\nAssuming a shock exists ($X \\ne 1$), we multiply by $2X$:\n$2\\gamma(P-X) = (\\gamma-1)(P-1)(X+1)$.\n$2\\gamma P - 2\\gamma X = (\\gamma-1)(PX + P - X - 1)$.\nSolving for $X$:\n$2\\gamma P - 2\\gamma X = (\\gamma-1)PX + (\\gamma-1)P - (\\gamma-1)X - (\\gamma-1)$.\n$X [ -2\\gamma - (\\gamma-1)P + (\\gamma-1)] = (\\gamma-1)P - 2\\gamma P - (\\gamma-1)$.\n$X [ -(\\gamma+1) - (\\gamma-1)P ] = -(\\gamma+1)P - (\\gamma-1)$.\n$X [ (\\gamma-1)P + (\\gamma+1) ] = (\\gamma+1)P + (\\gamma-1)$.\n$$ \\frac{\\rho_{2}}{\\rho_{1}} = \\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)} $$\nNext, we relate this to the incoming Mach number, $M_{1}$. From the momentum equation:\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} - \\rho_{2} u_{2}^{2} = \\rho_{1} u_{1}^{2} - \\rho_{1} u_{1} u_{2} = \\rho_{1} u_{1}^2 (1 - u_{2}/u_{1})$.\nUsing continuity, $u_{2}/u_{1} = \\rho_{1}/\\rho_{2}$.\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} (1 - \\rho_{1}/\\rho_{2})$.\nDivide by $p_{1}$:\n$\\frac{p_{2}}{p_{1}} - 1 = \\frac{\\rho_{1} u_{1}^{2}}{p_{1}} \\left(1 - \\frac{\\rho_{1}}{\\rho_{2}}\\right)$.\nThe definition of the Mach number is $M_{1}^{2} = u_{1}^{2}/a_{1}^{2} = u_{1}^{2}/(\\gamma p_{1}/\\rho_{1}) = \\rho_{1} u_{1}^{2} / (\\gamma p_{1})$. So, $\\rho_{1} u_{1}^{2}/p_{1} = \\gamma M_{1}^{2}$.\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(1 - \\frac{\\rho_{1}}{\\rho_{2}}\\right)$.\nLet's substitute $\\rho_2/\\rho_1$ from the relation derived before.\n$\\frac{\\rho_{1}}{\\rho_{2}} = \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$.\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(1 - \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right) = \\gamma M_{1}^{2} \\left(\\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) - [(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)]}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right)$.\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(\\frac{2\\frac{p_{2}}{p_{1}} - 2}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right) = \\frac{2\\gamma M_{1}^{2} (\\frac{p_{2}}{p_{1}} - 1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$.\nFor a shock, $p_{2}/p_{1} \\ne 1$, so we can divide by $(\\frac{p_{2}}{p_{1}}-1)$.\n$1 = \\frac{2\\gamma M_{1}^{2}}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$.\n$(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) = 2\\gamma M_{1}^{2}$.\n$(\\gamma+1)\\frac{p_{2}}{p_{1}} = 2\\gamma M_{1}^{2} - (\\gamma-1)$.\nThis yields the pressure ratio:\n$$ \\frac{p_{2}}{p_{1}} = \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} $$\nTo find the temperature ratio $T_{2}/T_{1}$, we use the ideal gas law: $p/\\rho = RT$.\n$\\frac{T_{2}}{T_{1}} = \\frac{p_{2}/\\rho_{2}}{p_{1}/\\rho_{1}} = \\frac{p_{2}}{p_{1}} \\frac{\\rho_{1}}{\\rho_{2}}$.\nWe have the expression for $\\rho_1/\\rho_2$ in terms of $p_2/p_1$, so\n$\\frac{T_{2}}{T_{1}} = \\frac{p_{2}}{p_{1}} \\left( \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)} \\right)$.\nFrom the previous step, the denominator is $(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) = 2\\gamma M_{1}^{2}$.\nSo, $\\frac{T_{2}}{T_{1}} = \\frac{p_{2}}{p_{1}} \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{2\\gamma M_{1}^{2}}$.\nSubstitute the derived expression for $p_{2}/p_{1}$:\n$\\frac{T_{2}}{T_{1}} = \\left( \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} \\right) \\frac{(\\gamma-1)\\left(\\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1}\\right) + (\\gamma+1)}{2\\gamma M_{1}^{2}}$.\nThe numerator term is $\\frac{(\\gamma-1)(2\\gamma M_{1}^{2} - (\\gamma-1)) + (\\gamma+1)^2}{\\gamma+1} = \\frac{2\\gamma(\\gamma-1)M_1^2 - (\\gamma-1)^2 + (\\gamma+1)^2}{\\gamma+1}$.\nUsing the identity $(\\gamma+1)^2 - (\\gamma-1)^2 = 4\\gamma$, this becomes $\\frac{2\\gamma(\\gamma-1)M_1^2 + 4\\gamma}{\\gamma+1} = \\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1}$.\nSubstituting back:\n$\\frac{T_{2}}{T_{1}} = \\left( \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} \\right) \\frac{1}{2\\gamma M_{1}^{2}} \\left( \\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1} \\right)$.\n$$ \\frac{T_{2}}{T_{1}} = \\frac{(2\\gamma M_{1}^{2} - (\\gamma-1))((\\gamma-1)M_{1}^{2}+2)}{(\\gamma+1)^{2}M_{1}^{2}} $$\nFinally, we must verify that $h_{0,2} - h_{0,1} = 0$ using these derived results.\n$h_{0,2} - h_{0,1} = (h_2 - h_1) + \\frac{1}{2}(u_2^2 - u_1^2) = c_p(T_2 - T_1) + \\frac{1}{2}u_1^2((\\frac{u_2}{u_1})^2-1)$.\nUsing $c_p = \\frac{\\gamma R}{\\gamma-1}$ and $u_1^2 = M_1^2 a_1^2 = M_1^2 \\gamma R T_1$:\n$h_{0,2} - h_{0,1} = \\frac{\\gamma R T_1}{\\gamma-1}(\\frac{T_2}{T_1}-1) + \\frac{1}{2} M_1^2 \\gamma R T_1 ((\\frac{u_2}{u_1})^2-1)$.\nWe need the velocity ratio $u_2/u_1 = \\rho_1/\\rho_2$.\n$\\frac{\\rho_{2}}{\\rho_{1}} = \\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)} = \\frac{2\\gamma M_1^2}{\\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1}} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2+2}$.\nSo, $\\frac{u_2}{u_1} = \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)M_1^2+2}{(\\gamma+1)M_1^2}$.\nLet's evaluate the terms in brackets for the stagnation enthalpy difference.\n$\\frac{T_2}{T_1}-1 = \\frac{(2\\gamma M_1^2 - (\\gamma-1))((\\gamma-1)M_1^2+2) - (\\gamma+1)^2 M_1^2}{(\\gamma+1)^2 M_1^2} = \\frac{2(\\gamma-1)(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2}$.\n$(\\frac{u_2}{u_1})^2-1 = \\left(\\frac{(\\gamma-1)M_1^2+2}{(\\gamma+1)M_1^2}\\right)^2 - 1 = \\frac{((\\gamma-1)M_1^2+2)^2 - ((\\gamma+1)M_1^2)^2}{((\\gamma+1)M_1^2)^2}$.\nThe numerator is a difference of squares $(A-B)(A+B)$:\n$A-B = (\\gamma-1-\\gamma-1)M_1^2+2 = -2M_1^2+2 = -2(M_1^2-1)$.\n$A+B = (\\gamma-1+\\gamma+1)M_1^2+2 = 2\\gamma M_1^2+2 = 2(\\gamma M_1^2+1)$.\nSo, $(\\frac{u_2}{u_1})^2-1 = \\frac{-4(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^4}$.\nSubstituting these into the expression for $h_{0,2}-h_{0,1}$:\n$h_{0,2}-h_{0,1} = \\gamma R T_1 \\left[ \\frac{1}{\\gamma-1}\\frac{2(\\gamma-1)(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} + \\frac{M_1^2}{2}\\frac{-4(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^4} \\right]$.\n$h_{0,2}-h_{0,1} = \\gamma R T_1 \\left[ \\frac{2(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} - \\frac{2(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} \\right]$.\nThe terms in the bracket cancel exactly.\n$h_{0,2}-h_{0,1} = \\gamma R T_1 [0] = 0$.\nThis confirms that the derived expressions for pressure and temperature ratios are consistent with the conservation of energy, which was used as a starting point. The value of the stagnation enthalpy difference is identically zero.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} & \\frac{\\left(2\\gamma M_{1}^{2} - (\\gamma-1)\\right)\\left((\\gamma-1)M_{1}^{2}+2\\right)}{(\\gamma+1)^{2}M_{1}^{2}} & 0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "The compressible energy equation includes source terms that represent the conversion of mechanical energy into thermal energy, a process known as viscous dissipation. This practice provides a tangible link between the abstract mathematical form of the viscous dissipation function, $\\Phi$, and its physical consequence of heating the fluid. By analyzing a compressible Couette flow, you will derive the form of $\\Phi$ including effects of both shear and volumetric strain, and then use it to estimate the resulting temperature rise in the flow .",
            "id": "3940566",
            "problem": "A Newtonian, compressible gas flows in planar Couette configuration between two infinite parallel plates separated by a gap of thickness $h$. The lower plate moves relative to the upper plate such that the mean shear rate is uniform and equal to $G \\equiv \\partial u/\\partial y$. Due to weak compressibility effects and externally imposed conditions, the flow exhibits a spatially uniform dilatation (volumetric strain rate) $\\theta \\equiv \\nabla \\cdot \\boldsymbol{u} \\neq 0$. Assume that the normal strain rates are isotropically distributed so that the symmetric rate-of-strain tensor has diagonal entries $S_{xx} = S_{yy} = S_{zz} = \\theta/3$, and the only nonzero off-diagonal components are the shear components $S_{xy} = S_{yx} = G/2$. The fluid has constant dynamic viscosity $\\mu$, bulk viscosity $\\kappa$, and thermal conductivity $k$. The walls are maintained isothermal at temperature $T_w$, and properties are constant.\n\nStarting from the conservation of energy for a Newtonian, compressible fluid and the Newtonian constitutive relation with bulk viscosity, derive the viscous heating rate per unit volume $\\Phi$ (the viscous dissipation function) for this flow in terms of $\\mu$, $\\kappa$, $G$, and $\\theta$. Then, under the approximation that steady one-dimensional heat conduction in the wall-normal direction balances volumetric viscous heating (neglect advection and reversible pressure work in the thermal energy balance), estimate the maximum temperature rise above the wall temperature in the gap. Take the maximum temperature rise to occur at the midplane.\n\nUse the following data:\n- Gap thickness: $h = 2.0 \\times 10^{-3}\\ \\mathrm{m}$.\n- Uniform shear rate: $G = 8.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$.\n- Uniform dilatation: $\\theta = 2.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$.\n- Dynamic viscosity: $\\mu = 1.9 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$.\n- Bulk viscosity: $\\kappa = 2.0 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$.\n- Thermal conductivity: $k = 2.7 \\times 10^{-2}\\ \\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$.\n\nReport the maximum temperature rise in Kelvin. Round your answer to four significant figures. Express the final answer in $\\mathrm{K}$.",
            "solution": "The problem statement has been validated and is deemed to be self-contained, scientifically grounded, and well-posed. All provided data and assumptions are consistent and physically plausible within the context of continuum mechanics.\n\nThe problem is solved in two parts. First, we derive the expression for the viscous heating rate per unit volume, $\\Phi$. Second, we solve a simplified heat conduction problem to find the maximum temperature rise in the gap.\n\nPart 1: Derivation of the Viscous Heating Rate $\\Phi$\n\nThe viscous heating rate, or viscous dissipation function, $\\Phi$, is the rate at which mechanical energy is converted to internal energy per unit volume. It is defined as the double contraction of the viscous stress tensor, $\\boldsymbol{\\tau}$, and the rate-of-strain tensor, $\\boldsymbol{S}$. In indicial notation, this is:\n$$\n\\Phi = \\tau_{ij} S_{ij}\n$$\nFor a compressible Newtonian fluid, the constitutive relation linking the viscous stress to the rate of strain is given by:\n$$\n\\tau_{ij} = 2\\mu S_{ij} + \\lambda \\delta_{ij} S_{kk}\n$$\nwhere $\\mu$ is the dynamic viscosity, $\\lambda$ is the second coefficient of viscosity, and $\\delta_{ij}$ is the Kronecker delta. The trace of the rate-of-strain tensor, $S_{kk}$, is the volumetric strain rate, or dilatation, $\\theta = \\nabla \\cdot \\boldsymbol{u}$. The constitutive relation is more commonly expressed using the bulk viscosity, $\\kappa$, which is related to $\\lambda$ and $\\mu$ by $\\kappa = \\lambda + \\frac{2}{3}\\mu$. Rearranging for $\\lambda$ gives $\\lambda = \\kappa - \\frac{2}{3}\\mu$. Substituting this into the constitutive relation yields:\n$$\n\\tau_{ij} = 2\\mu S_{ij} + \\left(\\kappa - \\frac{2}{3}\\mu\\right) \\delta_{ij} \\theta\n$$\nNow, we substitute this expression for $\\tau_{ij}$ into the definition of $\\Phi$:\n$$\n\\Phi = \\left[ 2\\mu S_{ij} + \\left(\\kappa - \\frac{2}{3}\\mu\\right) \\delta_{ij} \\theta \\right] S_{ij}\n$$\nUsing the Einstein summation convention and distributing $S_{ij}$:\n$$\n\\Phi = 2\\mu S_{ij}S_{ij} + \\left(\\kappa - \\frac{2}{3}\\mu\\right) \\delta_{ij} \\theta S_{ij}\n$$\nThe term $\\delta_{ij} S_{ij}$ simplifies to $S_{ii} = S_{kk} = \\theta$. Thus, the expression becomes:\n$$\n\\Phi = 2\\mu S_{ij}S_{ij} + \\left(\\kappa - \\frac{2}{3}\\mu\\right) \\theta^2\n$$\nThe problem provides the non-zero components of the rate-of-strain tensor: $S_{xx} = S_{yy} = S_{zz} = \\theta/3$ and $S_{xy} = S_{yx} = G/2$. We can now compute the term $S_{ij}S_{ij}$:\n$$\nS_{ij}S_{ij} = S_{xx}^2 + S_{yy}^2 + S_{zz}^2 + S_{xy}^2 + S_{yx}^2 = \\left(\\frac{\\theta}{3}\\right)^2 + \\left(\\frac{\\theta}{3}\\right)^2 + \\left(\\frac{\\theta}{3}\\right)^2 + \\left(\\frac{G}{2}\\right)^2 + \\left(\\frac{G}{2}\\right)^2\n$$\n$$\nS_{ij}S_{ij} = 3\\left(\\frac{\\theta^2}{9}\\right) + 2\\left(\\frac{G^2}{4}\\right) = \\frac{\\theta^2}{3} + \\frac{G^2}{2}\n$$\nSubstituting this result back into the expression for $\\Phi$:\n$$\n\\Phi = 2\\mu \\left( \\frac{\\theta^2}{3} + \\frac{G^2}{2} \\right) + \\kappa \\theta^2 - \\frac{2}{3}\\mu \\theta^2\n$$\n$$\n\\Phi = \\frac{2}{3}\\mu \\theta^2 + \\mu G^2 + \\kappa \\theta^2 - \\frac{2}{3}\\mu \\theta^2\n$$\nThe terms involving $\\frac{2}{3}\\mu\\theta^2$ cancel, yielding the final expression for the viscous heating rate:\n$$\n\\Phi = \\mu G^2 + \\kappa \\theta^2\n$$\n\nPart 2: Estimation of the Maximum Temperature Rise\n\nThe problem states that we should approximate the thermal balance by considering only steady, one-dimensional heat conduction in the wall-normal ($y$) direction, balanced by the uniform volumetric viscous heating $\\Phi$. This is described by the following differential equation for temperature $T(y)$:\n$$\nk \\frac{d^2T}{dy^2} + \\Phi = 0\n$$\nwhere $k$ is the constant thermal conductivity. Since $\\mu$, $\\kappa$, $G$, and $\\theta$ are all constants, $\\Phi$ is also a constant. The equation can be written as:\n$$\n\\frac{d^2T}{dy^2} = -\\frac{\\Phi}{k}\n$$\nWe integrate this equation twice with respect to $y$, the coordinate across the gap from $y=0$ to $y=h$:\n$$\n\\frac{dT}{dy} = -\\frac{\\Phi}{k} y + C_1\n$$\n$$\nT(y) = -\\frac{\\Phi}{2k} y^2 + C_1 y + C_2\n$$\nThe integration constants $C_1$ and $C_2$ are determined by the boundary conditions. The walls at $y=0$ and $y=h$ are maintained at a constant isothermal temperature $T_w$:\n1. $T(0) = T_w \\implies -\\frac{\\Phi}{2k}(0)^2 + C_1(0) + C_2 = T_w \\implies C_2 = T_w$.\n2. $T(h) = T_w \\implies -\\frac{\\Phi}{2k}h^2 + C_1 h + T_w = T_w \\implies C_1 h = \\frac{\\Phi h^2}{2k} \\implies C_1 = \\frac{\\Phi h}{2k}$.\n\nSubstituting the constants back into the temperature profile gives:\n$$\nT(y) = -\\frac{\\Phi}{2k} y^2 + \\frac{\\Phi h}{2k} y + T_w = T_w + \\frac{\\Phi}{2k}(hy - y^2)\n$$\nThe maximum temperature is found at the location where the temperature gradient is zero, $dT/dy = 0$:\n$$\n\\frac{dT}{dy} = \\frac{\\Phi}{2k}(h - 2y) = 0 \\implies y = \\frac{h}{2}\n$$\nThis confirms the maximum temperature occurs at the midplane. The maximum temperature rise, $\\Delta T_{max}$, is $T_{max} - T_w = T(h/2) - T_w$:\n$$\n\\Delta T_{max} = \\frac{\\Phi}{2k}\\left(h\\left(\\frac{h}{2}\\right) - \\left(\\frac{h}{2}\\right)^2\\right) = \\frac{\\Phi}{2k}\\left(\\frac{h^2}{2} - \\frac{h^2}{4}\\right) = \\frac{\\Phi h^2}{8k}\n$$\nSubstituting the derived expression for $\\Phi$:\n$$\n\\Delta T_{max} = \\frac{(\\mu G^2 + \\kappa \\theta^2)h^2}{8k}\n$$\nNow, we substitute the given numerical values:\n- $h = 2.0 \\times 10^{-3}\\ \\mathrm{m}$\n- $G = 8.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$\n- $\\theta = 2.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$\n- $\\mu = 1.9 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$\n- $\\kappa = 2.0 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$\n- $k = 2.7 \\times 10^{-2}\\ \\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$\n\nFirst, calculate the viscous heating rate $\\Phi$:\n$$\n\\mu G^2 = (1.9 \\times 10^{-5}) \\times (8.0 \\times 10^{3})^2 = (1.9 \\times 10^{-5}) \\times (64 \\times 10^{6}) = 1216\\ \\mathrm{W \\cdot m^{-3}}\n$$\n$$\n\\kappa \\theta^2 = (2.0 \\times 10^{-5}) \\times (2.0 \\times 10^{2})^2 = (2.0 \\times 10^{-5}) \\times (4.0 \\times 10^{4}) = 0.8\\ \\mathrm{W \\cdot m^{-3}}\n$$\n$$\n\\Phi = 1216 + 0.8 = 1216.8\\ \\mathrm{W \\cdot m^{-3}}\n$$\nNext, calculate the maximum temperature rise:\n$$\n\\Delta T_{max} = \\frac{(1216.8\\ \\mathrm{W \\cdot m^{-3}}) \\times (2.0 \\times 10^{-3}\\ \\mathrm{m})^2}{8 \\times (2.7 \\times 10^{-2}\\ \\mathrm{W \\cdot m^{-1} \\cdot K^{-1}})}\n$$\n$$\n\\Delta T_{max} = \\frac{1216.8 \\times 4.0 \\times 10^{-6}}{0.216}\\ \\mathrm{K}\n$$\n$$\n\\Delta T_{max} = \\frac{4867.2 \\times 10^{-6}}{0.216}\\ \\mathrm{K} = 22533.33... \\times 10^{-6}\\ \\mathrm{K}\n$$\n$$\n\\Delta T_{max} = 0.0225333...\\ \\mathrm{K}\n$$\nRounding to four significant figures, the maximum temperature rise is $0.02253\\ \\mathrm{K}$.",
            "answer": "$$\n\\boxed{0.02253}\n$$"
        },
        {
            "introduction": "Translating continuous conservation laws into a discrete form that a computer can solve is the central task of computational fluid dynamics (CFD). This exercise guides you through the fundamental step of implementing a finite-volume discretization for the one-dimensional energy equation. You will compute the energy residual, which represents the local imbalance of the discretized equation, using different numerical flux functions and verify the essential property of free-stream preservation, a critical test for any valid CFD solver .",
            "id": "3940584",
            "problem": "Consider the one-dimensional compressible inviscid energy equation in conservative form, derived from the conservation of energy for a thermally perfect gas with ratio of specific heats $\\gamma$:\n$$\n\\frac{\\partial (\\rho E)}{\\partial t} + \\frac{\\partial \\left( (\\rho E + p)\\,u \\right)}{\\partial x} = 0,\n$$\nwhere $\\rho$ is the mass density, $u$ is the velocity, $p$ is the pressure, and $E$ is the specific total energy defined by $E = e + \\frac{1}{2}u^2$, with the internal energy $e = \\frac{p}{(\\gamma - 1)\\rho}$. For a one-dimensional finite-volume discretization on a uniform grid with $N$ control volumes of width $\\Delta x$, periodic boundary conditions, and cell-centered primitive variables $(\\rho_i, u_i, p_i)$ for $i = 1, 2, \\dots, N$, define the conservative energy variable per unit volume in cell $i$ as\n$$\nU_{E,i} = \\rho_i E_i = \\frac{p_i}{\\gamma - 1} + \\frac{1}{2}\\rho_i u_i^2,\n$$\nand the physical energy flux as\n$$\nF_{E,i} = (U_{E,i} + p_i)\\,u_i.\n$$\nDefine numerical interface fluxes $\\hat{F}_{E,i+1/2}$ between cells $i$ and $i+1$ using two different flux functions:\n- Central flux:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{central}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right),\n$$\nwhere $L$ denotes the left state $(\\rho_i, u_i, p_i)$ and $R$ denotes the right state $(\\rho_{i+1}, u_{i+1}, p_{i+1})$, and $F_{E,L}$ and $F_{E,R}$ are the corresponding physical energy fluxes computed from $U_{E,L}$ and $U_{E,R}$.\n- Rusanov (local Laxâ€“Friedrichs) flux:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{rusanov}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right) - \\frac{1}{2}a_{i+1/2}\\left(U_{E,R} - U_{E,L}\\right),\n$$\nwith the local maximum signal speed\n$$\na_{i+1/2} = \\max\\left(\\left|u_L\\right| + c_L, \\left|u_R\\right| + c_R\\right),\n$$\nand the speed of sound\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}.\n$$\nImpose periodic boundary conditions such that indices wrap around modulo $N$, i.e., the right neighbor of cell $N$ is cell $1$, and the left neighbor of cell $1$ is cell $N$. Define the semi-discrete finite-volume energy residual in each cell,\n$$\nR_{E,i} = \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x},\n$$\nwith units of watts per cubic meter ($\\mathrm{W/m^3}$). The telescoping property of flux differences ensures that the domain-integrated residual satisfies\n$$\n\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x = \\hat{F}_{E,N+1/2} - \\hat{F}_{E,1-1/2},\n$$\nwhich is identically zero under periodic boundary conditions if the same numerical flux function is used consistently at all interfaces.\n\nYour task is to implement a program that computes $R_{E,i}$ for given prescribed states and verifies exact conservation for a uniform free stream. Use the following test suite with specified parameters and units:\n\n- Case $1$ (uniform free stream, periodic):\n  - $N = 8$, $\\Delta x = 0.1\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - $\\rho_i = 1.2\\,\\mathrm{kg/m^3}$, $u_i = 50\\,\\mathrm{m/s}$, $p_i = 101325\\,\\mathrm{Pa}$ for all $i$.\n  - Compute the maximum absolute residual $\\max_i |R_{E,i}|$ for both $\\hat{F}_{E}^{\\text{central}}$ and $\\hat{F}_{E}^{\\text{rusanov}}$ and verify it is numerically zero by checking against a tolerance $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^3}$. Return booleans indicating whether the check passes for each flux function.\n\n- Case $2$ (smooth nonuniform field, periodic):\n  - $N = 64$, $\\Delta x = 0.05\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - Domain length $L = N\\Delta x$ and cell centers $x_i = \\left(i + \\frac{1}{2}\\right)\\Delta x$ for $i = 0, 1, \\dots, N-1$,\n  - $\\rho_i = 1.0 + 0.1\\sin\\left(\\frac{2\\pi x_i}{L}\\right)\\,\\mathrm{kg/m^3}$,\n  - $u_i = 10 + 2\\cos\\left(\\frac{2\\pi x_i}{L}\\right)\\,\\mathrm{m/s}$,\n  - $p_i = 100000 + 10000\\sin\\left(\\frac{4\\pi x_i}{L}\\right)\\,\\mathrm{Pa}$.\n  - Compute and return the maximum absolute residual $\\max_i |R_{E,i}|$ in $\\mathrm{W/m^3}$ for both $\\hat{F}_{E}^{\\text{central}}$ and $\\hat{F}_{E}^{\\text{rusanov}}$.\n\n- Case $3$ (single-cell periodic edge case):\n  - $N = 1$, $\\Delta x = 0.2\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - $\\rho_1 = 0.9\\,\\mathrm{kg/m^3}$, $u_1 = -120\\,\\mathrm{m/s}$, $p_1 = 80000\\,\\mathrm{Pa}$.\n  - Compute the maximum absolute residual $\\max_i |R_{E,i}|$ for both flux functions and verify it is numerically zero within $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^3}$. Return booleans for each flux function.\n\n- Case $4$ (discontinuous jump, periodic; global conservation check):\n  - $N = 10$, $\\Delta x = 0.1\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - For $i = 1, 2, \\dots, 5$: $\\rho_i = 1.0\\,\\mathrm{kg/m^3}$, $u_i = 0.0\\,\\mathrm{m/s}$, $p_i = 100000\\,\\mathrm{Pa}$,\n  - For $i = 6, 7, \\dots, 10$: $\\rho_i = 0.8\\,\\mathrm{kg/m^3}$, $u_i = 20\\,\\mathrm{m/s}$, $p_i = 80000\\,\\mathrm{Pa}$.\n  - Using $\\hat{F}_{E}^{\\text{rusanov}}$, compute the domain-integrated residual $\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x$ in $\\mathrm{W/m^2}$ and verify it is numerically zero within $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^2}$. Return a boolean indicating whether the check passes.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$$\n[\\text{Case 1 central boolean}, \\text{Case 1 rusanov boolean}, \\text{Case 2 central max residual}, \\text{Case 2 rusanov max residual}, \\text{Case 3 central boolean}, \\text{Case 3 rusanov boolean}, \\text{Case 4 integrated boolean}].\n$$\nEnsure that all residuals are expressed in the units specified above and that booleans are computed using the tolerance $\\varepsilon$ stated in each case.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational fluid dynamics, specifically the finite-volume method applied to the Euler equations. All parameters, equations, and boundary conditions are explicitly defined, constituting a well-posed computational task. The test cases are designed to verify fundamental properties of numerical schemes, such as free-stream preservation and conservation.\n\nThe solution proceeds by first implementing the necessary physical and numerical functions and then applying them to the four specified test cases. The core of the implementation is a function that computes the semi-discrete energy residual $R_{E,i}$ for a given set of primitive variables $(\\rho_i, u_i, p_i)$ under periodic boundary conditions.\n\nThe state of the fluid in each cell $i$ is described by the primitive variables of density $\\rho_i$, velocity $u_i$, and pressure $p_i$. From these, we define the conservative variable for energy, which is the total energy per unit volume, $U_{E,i}$. It is given by\n$$\nU_{E,i} = \\rho_i E_i = \\rho_i \\left( e_i + \\frac{1}{2}u_i^2 \\right)\n$$\nFor a thermally perfect gas, the specific internal energy $e_i$ is related to pressure and density via the ratio of specific heats $\\gamma$:\n$$\ne_i = \\frac{p_i}{(\\gamma - 1)\\rho_i}\n$$\nSubstituting this into the expression for $U_{E,i}$ yields\n$$\nU_{E,i} = \\frac{p_i}{\\gamma - 1} + \\frac{1}{2}\\rho_i u_i^2\n$$\nThe physical energy flux, representing the advection of total enthalpy, is given by\n$$\nF_{E,i} = (\\rho_i E_i + p_i) u_i = (U_{E,i} + p_i) u_i\n$$\nThe finite-volume method approximates the spatial derivative in the conservation law by a difference of fluxes at the cell interfaces. For a cell $i$, the semi-discrete form of the energy equation is\n$$\n\\frac{dU_{E,i}}{dt} = - \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x}\n$$\nThe right-hand side is defined as the negative of the residual, $R_{E,i}$:\n$$\nR_{E,i} = \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x}\n$$\nHere, $\\hat{F}_{E,i+1/2}$ and $\\hat{F}_{E,i-1/2}$ are the numerical fluxes at the right and left interfaces of cell $i$, respectively. Due to periodic boundary conditions, the left neighbor of cell $i=1$ is cell $N$, and the right neighbor of cell $N$ is cell $1$. In a zero-indexed implementation (for cells $i=0, \\dots, N-1$), the right neighbor of cell $i$ is $(i+1) \\pmod N$, and the left neighbor is $(i-1) \\pmod N$.\n\nThe numerical fluxes are computed based on the states to the left (L) and right (R) of the interface. For interface $i+1/2$ between cells $i$ and $i+1$, the L-state is $(\\rho_i, u_i, p_i)$ and the R-state is $(\\rho_{i+1}, u_{i+1}, p_{i+1})$.\n\nThe central flux is a simple average of the physical fluxes from the L and R states:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{central}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right)\n$$\nThe Rusanov (or local Lax-Friedrichs) flux adds a dissipation term proportional to the jump in the conserved variable across the interface, scaled by the maximum local signal speed:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{rusanov}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right) - \\frac{1}{2}a_{i+1/2}\\left(U_{E,R} - U_{E,L}\\right)\n$$\nThe signal speed $a_{i+1/2}$ is determined by the maximum wave speed propagating away from the interface, given by\n$$\na_{i+1/2} = \\max\\left(\\left|u_L\\right| + c_L, \\left|u_R\\right| + c_R\\right)\n$$\nwhere $c_L$ and $c_R$ are the speeds of sound in the L and R states, calculated as\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\nThe implementation will use vectorized operations provided by the NumPy library for efficiency. Primitive variable fields $(\\rho_i, u_i, p_i)$ are stored in arrays. The left and right states for all interfaces are efficiently generated using array shifting (e.g., `numpy.roll`). This allows for the simultaneous computation of all interface fluxes, which are then used to compute the array of all cell residuals.\n\nCase 1 and Case 3 test the free-stream preservation property. For a uniform flow, the left and right states at every interface are identical. Consequently, $U_{E,L} = U_{E,R}$ and $F_{E,L} = F_{E,R}$. Both central and Rusanov fluxes simplify to $\\hat{F}_E = F_{E,L} = F_{E,R}$. Since the numerical flux is constant for all interfaces, the residual $R_{E,i} = (\\hat{F}_E - \\hat{F}_E) / \\Delta x$ must be identically zero. The computation verifies this to within machine precision.\n\nCase 2 involves a non-uniform field, for which a non-zero residual is expected. The calculation provides the maximum magnitude of this residual, which is a measure of the spatial truncation error of the scheme for the given state.\n\nCase 4 tests the global conservation property of the finite-volume scheme. The domain-integrated residual, when using a consistent numerical flux formulation, is\n$$\n\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x = \\sum_{i=1}^{N} (\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2})\n$$\nThis is a telescoping sum which simplifies to $\\hat{F}_{E,N+1/2} - \\hat{F}_{E,1-1/2}$. For periodic boundaries, the interface to the right of cell $N$ is the same as the interface to the left of cell $1$. Thus, $\\hat{F}_{E,N+1/2} = \\hat{F}_{E,1-1/2}$, and the sum must be identically zero, regardless of the flow field. This holds even for discontinuous fields like the one specified in Case 4. The computation verifies this property for the Rusanov flux.",
            "answer": "[True,True,367629532.79374015,371905333.31015694,True,True,True]"
        }
    ]
}