{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will start with a foundational calculation at the heart of the mixing length model. This exercise focuses on the logarithmic layer of a turbulent wall flow, where the model's assumptions are most accurate. By deriving the turbulent eddy viscosity $\\nu_t$ from first principles, you will verify a key feature of the model and solidify your understanding of how it links the abstract concept of a mixing length to a tangible property used in computational models .",
            "id": "3992485",
            "problem": "Consider a statistically steady, fully developed, high-Reynolds-number turbulent wall flow in its logarithmic layer, where the mean streamwise velocity is a function of the wall-normal coordinate $y$ only. Let the friction velocity be $u_{\\tau}$, the fluid density be $\\rho$, and the von Kármán constant be $\\kappa$. In the logarithmic layer, the measured mean shear is given by $\\partial U/\\partial y = u_{\\tau}/(\\kappa y)$, and the mixing length is modeled as $l_{m} = \\kappa y$.\n\nStarting from the Boussinesq eddy-viscosity hypothesis linking the Reynolds shear stress to the mean shear and the definition of Prandtl’s mixing length in terms of turbulent velocity fluctuations and mean shear, derive a closed-form symbolic expression for the turbulent kinematic viscosity $\\nu_{t}(y)$ as a function of $y$, $\\kappa$, and $u_{\\tau}$. Then, verify from your expression whether $\\nu_{t}(y)$ is linear in $y$ within the logarithmic layer.\n\nProvide your final result as a single closed-form symbolic expression for $\\nu_{t}(y)$. Do not evaluate numerically and do not include units in your final answer.",
            "solution": "The problem requires the derivation of an expression for the turbulent kinematic viscosity, $\\nu_{t}(y)$, within the logarithmic layer of a turbulent wall flow. The derivation must start from fundamental principles of turbulence modeling, namely the Boussinesq eddy-viscosity hypothesis and Prandtl's mixing length model, using the specific forms for the mean shear and mixing length provided for this flow regime.\n\nFirst, we state the Boussinesq eddy-viscosity hypothesis. This hypothesis provides an analogy between molecular and turbulent transport of momentum, defining a turbulent (or eddy) viscosity, $\\nu_{t}$. The Reynolds shear stress, $\\tau_{t} = -\\rho \\overline{u'v'}$, where $\\overline{u'v'}$ is the time-averaged product of the streamwise and wall-normal velocity fluctuations, is modeled as being proportional to the mean rate of strain. For a simple shear flow where the mean velocity is $U(y)$, this is expressed as:\n$$ \\tau_{t} = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y} $$\nThe quantity $\\nu_{t}$ is the turbulent kinematic viscosity. By dividing by the fluid density $\\rho$, we can express the kinematic Reynolds shear stress as:\n$$ -\\overline{u'v'} = \\nu_{t} \\frac{\\partial U}{\\partial y} $$\n\nNext, we introduce Prandtl's mixing length model. This model offers a closure for the Reynolds shear stress by relating it to the mean velocity gradient and a characteristic length scale of turbulence, the mixing length $l_m$. The model postulates that the kinematic Reynolds shear stress can be expressed as:\n$$ -\\overline{u'v'} = l_{m}^2 \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y} $$\nFor the specific case of a wall boundary layer, the mean velocity gradient $\\frac{\\partial U}{\\partial y}$ is positive, so the expression simplifies to:\n$$ -\\overline{u'v'} = l_{m}^2 \\left( \\frac{\\partial U}{\\partial y} \\right)^2 $$\n\nNow, we can derive an expression for $\\nu_{t}$ by equating the two models for the kinematic Reynolds shear stress, $-\\overline{u'v'}$.\n$$ \\nu_{t} \\frac{\\partial U}{\\partial y} = l_{m}^2 \\left( \\frac{\\partial U}{\\partial y} \\right)^2 $$\nIn the logarithmic layer, the mean shear $\\frac{\\partial U}{\\partial y}$ is non-zero, allowing us to divide both sides by this term. This yields a direct expression for the turbulent kinematic viscosity based on the mixing length model:\n$$ \\nu_{t} = l_{m}^2 \\frac{\\partial U}{\\partial y} $$\n\nThe problem provides the specific forms for the mixing length and the mean shear that are valid in the logarithmic layer of a high-Reynolds-number turbulent wall flow. These are:\n1.  The mixing length model: $l_{m} = \\kappa y$, where $\\kappa$ is the von Kármán constant and $y$ is the wall-normal coordinate.\n2.  The mean shear profile: $\\frac{\\partial U}{\\partial y} = \\frac{u_{\\tau}}{\\kappa y}$, where $u_{\\tau}$ is the friction velocity.\n\nWe substitute these two expressions into our derived equation for $\\nu_{t}$:\n$$ \\nu_{t}(y) = (\\kappa y)^2 \\left( \\frac{u_{\\tau}}{\\kappa y} \\right) $$\nExpanding the squared term gives:\n$$ \\nu_{t}(y) = (\\kappa^2 y^2) \\left( \\frac{u_{\\tau}}{\\kappa y} \\right) $$\nWe can now simplify this expression by canceling common factors. One factor of $\\kappa$ in the numerator cancels with the $\\kappa$ in the denominator. One factor of $y$ in the numerator cancels with the $y$ in the denominator.\n$$ \\nu_{t}(y) = \\kappa y u_{\\tau} $$\nRearranging for conventional ordering, we obtain the final closed-form symbolic expression for the turbulent kinematic viscosity in the logarithmic layer:\n$$ \\nu_{t}(y) = \\kappa u_{\\tau} y $$\n\nThe second part of the task is to verify whether $\\nu_{t}(y)$ is linear in $y$. A function $f(x)$ is linear in $x$ if it can be written in the form $f(x) = C x$, where $C$ is a constant. In our derived expression, $\\nu_{t}(y) = (\\kappa u_{\\tau}) y$, the von Kármán constant $\\kappa$ is a universal dimensionless constant (approximately $0.41$), and the friction velocity $u_{\\tau}$ is a constant for a given fully developed flow condition. Therefore, the product $\\kappa u_{\\tau}$ is a constant. The expression for $\\nu_{t}(y)$ is of the form $C y$, where the constant of proportionality is $C = \\kappa u_{\\tau}$. Consequently, the turbulent kinematic viscosity $\\nu_{t}(y)$ is indeed linear in the wall-normal coordinate $y$ within the logarithmic layer.",
            "answer": "$$\\boxed{\\kappa u_{\\tau} y}$$"
        },
        {
            "introduction": "Building on the fundamentals, we now apply the mixing length model to a more comprehensive and realistic scenario: predicting the entire velocity profile across one half of a turbulent channel flow. This practice requires you to integrate the Reynolds-averaged momentum equation using a more advanced form of the model that incorporates near-wall damping effects. Deriving the final integral for the dimensionless velocity profile $U^+(y^+)$ will provide you with deep insight into how these models are used to solve for the complete flow structure in a canonical wall-bounded flow .",
            "id": "3992511",
            "problem": "Consider incompressible, isothermal, fully developed turbulent plane channel flow between two parallel plates separated by a distance $2H$. Let the mean streamwise velocity be $U(y)$, where the wall-normal coordinate $y$ is measured from the lower wall at $y=0$ to the channel centerline at $y=H$. The mean pressure gradient $\\partial p/\\partial x$ is constant and negative, and the flow is statistically steady. Adopt the Boussinesq eddy-viscosity hypothesis for the Reynolds shear stress together with the mixing-length model, in which the turbulent kinematic viscosity is modeled as $\\nu_t = l_m^2 \\left|\\partial U / \\partial y\\right|$. Assume a van Driest-type damping near the wall, so that the mixing length is given by $l_m(y) = \\kappa y \\left[1 - \\exp\\!\\left(-y^+/A^+\\right)\\right]$, where $\\kappa$ is the von Kármán constant, $y^+ = y u_\\tau / \\nu$ is the wall coordinate, $u_\\tau = \\sqrt{\\tau_w / \\rho}$ is the friction velocity, $\\tau_w$ is the wall shear stress, $\\rho$ is the density, and $\\nu$ is the kinematic viscosity. Define the friction Reynolds number $\\mathrm{Re}_\\tau = u_\\tau H / \\nu$. \n\nStarting only from the Reynolds-averaged streamwise momentum balance, the Boussinesq hypothesis, and the given mixing-length model, derive the ordinary differential equation governing $U(y)$ and state boundary conditions that ensure physically realistic behavior near the wall and at the centerline. Then, non-dimensionalize the governing equation in wall units to obtain a closed-form analytic expression for the dimensionless mean velocity profile $U^+(y^+) = U(y)/u_\\tau$ as an explicit integral of $y^+$, expressed solely in terms of $\\kappa$, $A^+$, and $\\mathrm{Re}_\\tau$. Provide the final expression for $U^+(y^+)$ as a single closed-form symbolic expression. No numerical evaluation is required.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It provides a complete and consistent set of definitions, models, and constraints to derive the dimensionless velocity profile for turbulent channel flow. All principles and models used are standard in the field of fluid mechanics and turbulence theory. Therefore, the problem is valid, and a solution will be provided.\n\nThe derivation begins with the Reynolds-averaged Navier-Stokes (RANS) equation for the mean streamwise momentum in an incompressible, statistically steady, fully developed turbulent plane channel flow. The coordinate $y$ is the wall-normal distance, with $y=0$ at the lower wall and $y=H$ at the channel centerline. Under these conditions, the momentum equation reduces to:\n$$\n0 = -\\frac{\\partial p}{\\partial x} + \\frac{d}{dy}\\left(\\mu \\frac{dU}{dy} - \\rho \\overline{u'v'}\\right)\n$$\nwhere $\\frac{\\partial p}{\\partial x}$ is the constant mean pressure gradient, $\\mu$ is the dynamic viscosity, $\\rho$ is the density, $U(y)$ is the mean streamwise velocity, and $-\\rho \\overline{u'v'}$ is the Reynolds shear stress. The term in the parentheses represents the total shear stress, $\\tau_{total}(y) = \\mu \\frac{dU}{dy} - \\rho \\overline{u'v'}$.\n\nIntegrating the simplified momentum equation with respect to $y$ yields a linear profile for the total shear stress:\n$$\n\\tau_{total}(y) = y \\frac{\\partial p}{\\partial x} + C_1\n$$\nwhere $C_1$ is an integration constant. By symmetry, the shear stress at the channel centerline ($y=H$) must be zero, so $\\tau_{total}(H) = 0$. This gives $H \\frac{\\partial p}{\\partial x} + C_1 = 0$, which implies $C_1 = -H \\frac{\\partial p}{\\partial x}$. The total stress profile is thus:\n$$\n\\tau_{total}(y) = (y-H)\\frac{\\partial p}{\\partial x}\n$$\nThe wall shear stress, $\\tau_w$, is the total stress evaluated at the wall, $y=0$:\n$$\n\\tau_w = \\tau_{total}(0) = (0-H)\\frac{\\partial p}{\\partial x} = -H \\frac{\\partial p}{\\partial x}\n$$\nThis fundamental relationship allows us to express the pressure gradient in terms of the wall shear stress: $\\frac{\\partial p}{\\partial x} = -\\frac{\\tau_w}{H}$. Substituting this back into the expression for $\\tau_{total}(y)$ gives:\n$$\n\\tau_{total}(y) = \\tau_w \\left(1 - \\frac{y}{H}\\right)\n$$\nNext, we introduce the Boussinesq eddy-viscosity hypothesis, which models the Reynolds shear stress as $-\\rho \\overline{u'v'} = \\rho \\nu_t \\frac{dU}{dy}$, where $\\nu_t$ is the turbulent kinematic viscosity. The total stress is then the sum of the viscous and turbulent contributions:\n$$\n\\tau_{total}(y) = \\mu \\frac{dU}{dy} + \\rho \\nu_t \\frac{dU}{dy} = \\rho(\\nu + \\nu_t) \\frac{dU}{dy}\n$$\nwhere $\\nu = \\mu/\\rho$ is the kinematic viscosity. Equating the two expressions for $\\tau_{total}(y)$ gives the governing ordinary differential equation (ODE) for the mean velocity profile $U(y)$:\n$$\n\\rho(\\nu + \\nu_t) \\frac{dU}{dy} = \\tau_w \\left(1 - \\frac{y}{H}\\right)\n$$\nThe problem specifies the mixing-length model for $\\nu_t$, where $\\nu_t = l_m^2 |\\frac{dU}{dy}|$. Since the velocity increases away from the wall, $\\frac{dU}{dy} > 0$, so $|\\frac{dU}{dy}| = \\frac{dU}{dy}$. The mixing length $l_m$ is given by the van Driest damped model: $l_m(y) = \\kappa y [1 - \\exp(-y^+/A^+)]$.\n\nThe physically realistic boundary conditions for this problem are the no-slip condition at the wall and the symmetry condition at the centerline:\n1. $U(0) = 0$\n2. $\\frac{dU}{dy}|_{y=H} = 0$\n\nTo obtain the dimensionless velocity profile, we non-dimensionalize the governing equation using wall units. The relevant dimensionless variables are the wall-normal coordinate $y^+ = \\frac{y u_\\tau}{\\nu}$, the velocity $U^+ = \\frac{U}{u_\\tau}$, and the friction Reynolds number $\\mathrm{Re}_\\tau = \\frac{H u_\\tau}{\\nu}$. The friction velocity is defined as $u_\\tau = \\sqrt{\\tau_w/\\rho}$.\nFrom these definitions, we have $y = \\frac{y^+\\nu}{u_\\tau}$, $U = U^+ u_\\tau$, and $H = \\frac{\\mathrm{Re}_\\tau \\nu}{u_\\tau}$. The velocity gradient in wall units is $\\frac{dU}{dy} = \\frac{d(U^+ u_\\tau)}{d(y^+\\nu/u_\\tau)} = \\frac{u_\\tau^2}{\\nu}\\frac{dU^+}{dy^+}$.\nSubstituting these into the ODE and dividing by $\\tau_w = \\rho u_\\tau^2$:\n$$\n\\frac{\\rho(\\nu + \\nu_t)}{\\rho u_\\tau^2} \\left(\\frac{u_\\tau^2}{\\nu} \\frac{dU^+}{dy^+}\\right) = 1 - \\frac{y}{H}\n$$\n$$\n\\left(1 + \\frac{\\nu_t}{\\nu}\\right) \\frac{dU^+}{dy^+} = 1 - \\frac{y^+}{\\mathrm{Re}_\\tau}\n$$\nNow we express the eddy viscosity ratio $\\nu_t/\\nu$ in wall units.\n$$\n\\nu_t = l_m^2 \\frac{dU}{dy} = \\left(\\kappa y \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]\\right)^2 \\left(\\frac{u_\\tau^2}{\\nu}\\frac{dU^+}{dy^+}\\right)\n$$\n$$\n\\nu_t = \\left(\\kappa \\frac{y^+\\nu}{u_\\tau} \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]\\right)^2 \\left(\\frac{u_\\tau^2}{\\nu}\\frac{dU^+}{dy^+}\\right) = \\kappa^2 (y^+)^2 \\nu \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]^2 \\frac{dU^+}{dy^+}\n$$\nThe ratio is:\n$$\n\\frac{\\nu_t}{\\nu} = \\kappa^2 (y^+)^2 \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]^2 \\frac{dU^+}{dy^+}\n$$\nSubstituting this into the dimensionless momentum equation gives a quadratic equation for the velocity gradient $\\frac{dU^+}{dy^+}$:\n$$\n\\left(1 + \\kappa^2 (y^+)^2 \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]^2 \\frac{dU^+}{dy^+}\\right) \\frac{dU^+}{dy^+} = 1 - \\frac{y^+}{\\mathrm{Re}_\\tau}\n$$\n$$\n\\left(\\kappa^2 (y^+)^2 \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]^2\\right) \\left(\\frac{dU^+}{dy^+}\\right)^2 + \\frac{dU^+}{dy^+} - \\left(1 - \\frac{y^+}{\\mathrm{Re}_\\tau}\\right) = 0\n$$\nSolving this quadratic equation for $\\frac{dU^+}{dy^+}$ yields two roots. We select the positive root to ensure a physically correct velocity profile where velocity increases away from the wall:\n$$\n\\frac{dU^+}{dy^+} = \\frac{-1 + \\sqrt{1 + 4 \\left(\\kappa^2 (y^+)^2 \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]^2\\right) \\left(1 - \\frac{y^+}{\\mathrm{Re}_\\tau}\\right)}}{2 \\kappa^2 (y^+)^2 \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]^2}\n$$\nTo find the velocity profile $U^+(y^+)$, we integrate this expression from the wall (where $U^+(0)=0$) to an arbitrary position $y^+$. Using a dummy integration variable $\\eta^+$:\n$$\nU^+(y^+) = \\int_0^{y^+} \\frac{dU^+}{d\\eta^+} d\\eta^+\n$$\nThis results in the final closed-form integral expression for the dimensionless mean velocity profile:\n$$\nU^+(y^+) = \\int_{0}^{y^+} \\frac{-1 + \\sqrt{1 + 4 \\kappa^2 (\\eta^+)^2 \\left[1 - \\exp\\left(-\\frac{\\eta^+}{A^+}\\right)\\right]^2 \\left(1 - \\frac{\\eta^+}{\\mathrm{Re}_\\tau}\\right)}}{2 \\kappa^2 (\\eta^+)^2 \\left[1 - \\exp\\left(-\\frac{\\eta^+}{A^+}\\right)\\right]^2} d\\eta^+\n$$\nThis expression is solely in terms of the integration variable $\\eta^+$ and the prescribed constants $\\kappa$, $A^+$, and $\\mathrm{Re}_\\tau$, as requested.",
            "answer": "$$\\boxed{\\int_{0}^{y^+} \\frac{-1 + \\sqrt{1 + 4 \\kappa^2 (\\eta^+)^2 \\left[1 - \\exp\\left(-\\frac{\\eta^+}{A^+}\\right)\\right]^2 \\left(1 - \\frac{\\eta^+}{\\mathrm{Re}_\\tau}\\right)}}{2 \\kappa^2 (\\eta^+)^2 \\left[1 - \\exp\\left(-\\frac{\\eta^+}{A^+}\\right)\\right]^2} d\\eta^+}$$"
        },
        {
            "introduction": "This final practice bridges the gap between analytical theory and computational implementation, a critical skill for any modern computational engineer. You will implement the logarithmic law of the wall, a direct consequence of the mixing length model, to calculate the wall shear stress from a known velocity at a single point near the wall—a technique known as a \"wall function\" in CFD. By developing and applying an iterative numerical solver to find the friction velocity $u_\\tau$, you will gain direct experience with the practical application of turbulence theory in a computational context .",
            "id": "3992497",
            "problem": "You are implementing a near-wall treatment in a Computational Fluid Dynamics (CFD) solver for turbulent wall-bounded flow using the mixing length model. Start from the following fundamental base:\n\n- The Reynolds-Averaged Navier–Stokes (RANS) streamwise mean momentum balance near the wall in an equilibrium turbulent boundary layer with negligible streamwise pressure gradient, expressed as a balance of viscous and turbulent shear stresses: $$\\tau_{\\text{tot}}(y) = \\mu \\,\\frac{dU}{dy} - \\rho \\,\\overline{u'v'} \\approx \\tau_w,$$ where $\\tau_w$ is the wall shear stress, $\\mu$ is the dynamic viscosity, $\\rho$ is the density, $U$ is the mean streamwise velocity, and $\\overline{u'v'}$ is the Reynolds shear stress.\n- The mixing length model of Ludwig Prandtl with mixing length $\\ell_m = \\kappa \\, y$, where $\\kappa$ is the von Kármán constant and $y$ is the wall-normal coordinate.\n- The Boussinesq hypothesis approximating the Reynolds shear stress with an eddy viscosity $\\nu_t = \\ell_m^2 \\,\\left|\\frac{dU}{dy}\\right|$ such that $-\\rho \\,\\overline{u'v'} = \\rho \\,\\nu_t \\,\\frac{dU}{dy}$.\n- In the log region sufficiently far from the wall (fully turbulent), the viscous shear is negligible compared to the turbulent shear so that $\\tau_w \\approx \\rho \\,\\ell_m^2 \\left(\\frac{dU}{dy}\\right)^2$.\n\nUsing only the above as the fundamental base and empirical fact that the fully turbulent log-law holds with a smooth-wall additive constant $B$ and von Kármán constant $\\kappa$, perform the following:\n\n- Derive, from the mixing length model, the logarithmic mean velocity profile in wall units of the form $$U^+ = \\frac{1}{\\kappa}\\,\\ln y^+ + B,$$ where $U^+ = \\frac{U}{u_\\tau}$, $y^+ = \\frac{\\rho \\,u_\\tau \\,y}{\\mu}$, and $u_\\tau = \\sqrt{\\tau_w/\\rho}$ is the friction velocity.\n- Let the first off-wall control volume center be at a known distance $y_p$ from the wall and possess a known mean velocity $U_p$ parallel to the wall. Use the empirical logarithmic law of the wall to write down the implicit equation that determines $u_\\tau$ from $U_p$ and $y_p$.\n- Prove that the equation for $u_\\tau$ has a unique positive solution by analyzing the monotonicity of an appropriate residual.\n- Design a robust iterative numerical method that computes $u_\\tau$ for given $\\rho$, $\\mu$, $U_p$, $y_p$, $\\kappa$, and $B$, with a stopping tolerance on the residual magnitude smaller than $\\varepsilon = 10^{-12}$ or relative change in $u_\\tau$ smaller than $\\delta = 10^{-12}$, and with a maximum of $N_{\\max} = 200$ iterations. If a bracketing method is used, ensure that the initial bracket expands automatically until a sign change is found or until a safe upper limit is reached.\n- From the converged $u_\\tau$, compute the wall shear stress $\\tau_w = \\rho \\,u_\\tau^2$.\n\nImplement your derivation and numerical method in a complete, runnable program that computes $u_\\tau$ and $\\tau_w$ for the following test suite. All quantities are to be treated as constants within each test case, and the chosen parameters are scientifically plausible for smooth-wall, high-Reynolds-number, near-wall cells used with wall functions. Use base International System of Units (SI units). For each case, express $u_\\tau$ in $\\mathrm{m/s}$ and $\\tau_w$ in $\\mathrm{Pa}$, and round each to exactly $6$ decimal places.\n\nTest suite (each case is $(\\rho,\\mu,U_p,y_p,\\kappa,B)$):\n- Case A (air at standard conditions): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.225,\\,1.7894\\times 10^{-5},\\,10.0,\\,1.0\\times 10^{-3},\\,0.41,\\,5.2\\,)$.\n- Case B (air, higher speed, finer first cell): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.225,\\,1.7894\\times 10^{-5},\\,40.0,\\,5.0\\times 10^{-4},\\,0.41,\\,5.2\\,)$.\n- Case C (water at room temperature): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,998.2,\\,1.003\\times 10^{-3},\\,1.0,\\,1.0\\times 10^{-3},\\,0.41,\\,5.2\\,)$.\n- Case D (air, moderate speed, alternative smooth-wall constant): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.2,\\,1.85\\times 10^{-5},\\,5.0,\\,7.5\\times 10^{-4},\\,0.41,\\,5.0\\,)$.\n- Case E (air, small $y_p$, slightly different $B$): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.225,\\,1.7894\\times 10^{-5},\\,15.0,\\,2.0\\times 10^{-4},\\,0.41,\\,5.5\\,)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, where each inner list corresponds to one test case and contains the two rounded floating-point results in order $[u_\\tau,\\tau_w]$. The exact output format is\n\n\"[[u_tau_A,tau_w_A],[u_tau_B,tau_w_B],[u_tau_C,tau_w_C],[u_tau_D,tau_w_D],[u_tau_E,tau_w_E]]\"\n\nwith no spaces added. Ensure that the printed numbers are rounded to exactly $6$ decimal places as specified.",
            "solution": "The task is to derive and implement a numerical method for calculating the friction velocity $u_\\tau$ and wall shear stress $\\tau_w$ based on the logarithmic law of the wall, which itself is to be derived from Prandtl's mixing length model. The method will be applied to a set of test cases with specified physical parameters.\n\n**1. Derivation of the Logarithmic Velocity Profile**\n\nThe problem starts from the Reynolds-Averaged Navier-Stokes (RANS) momentum equation for a fully developed turbulent boundary layer with a negligible pressure gradient, where the total shear stress $\\tau_{\\text{tot}}$ is approximately constant and equal to the wall shear stress $\\tau_w$:\n$$ \\tau_w \\approx \\mu \\frac{dU}{dy} - \\rho \\overline{u'v'} $$\nUsing the Boussinesq hypothesis, the Reynolds shear stress term $-\\rho \\overline{u'v'}$ is modeled as $\\rho \\nu_t \\frac{dU}{dy}$, where $\\nu_t$ is the eddy viscosity. The mixing length model provides an expression for $\\nu_t$:\n$$ \\nu_t = \\ell_m^2 \\left|\\frac{dU}{dy}\\right| $$\nwhere the mixing length is $\\ell_m = \\kappa y$. Here, $\\kappa$ is the von Kármán constant and $y$ is the distance from the wall. We assume $\\frac{dU}{dy} > 0$.\nThe total shear stress balance becomes:\n$$ \\tau_w \\approx \\mu \\frac{dU}{dy} + \\rho (\\kappa y)^2 \\left(\\frac{dU}{dy}\\right)^2 $$\nIn the logarithmic region, which is sufficiently far from the wall for viscous effects to be negligible but close enough for the constant stress assumption to hold, the viscous shear term $\\mu \\frac{dU}{dy}$ is considered much smaller than the turbulent shear term. The balance simplifies to:\n$$ \\tau_w \\approx \\rho (\\kappa y)^2 \\left(\\frac{dU}{dy}\\right)^2 $$\nWe can rearrange this equation to solve for the mean velocity gradient $\\frac{dU}{dy}$:\n$$ \\left(\\frac{dU}{dy}\\right)^2 = \\frac{\\tau_w}{\\rho (\\kappa y)^2} \\implies \\frac{dU}{dy} = \\frac{\\sqrt{\\tau_w/\\rho}}{\\kappa y} $$\nIntroducing the friction velocity $u_\\tau = \\sqrt{\\tau_w/\\rho}$, the equation becomes:\n$$ \\frac{dU}{dy} = \\frac{u_\\tau}{\\kappa y} $$\nTo find the velocity profile $U(y)$, we integrate this ordinary differential equation with respect to $y$:\n$$ \\int dU = \\int \\frac{u_\\tau}{\\kappa y} dy \\implies U(y) = \\frac{u_\\tau}{\\kappa} \\ln(y) + C $$\nwhere $C$ is the constant of integration. To obtain the standard dimensionless form, we introduce wall units:\n-   Dimensionless velocity: $U^+ = \\frac{U}{u_\\tau}$\n-   Dimensionless wall distance: $y^+ = \\frac{\\rho u_\\tau y}{\\mu}$\n\nFrom the definition of $y^+$, we can express $y$ as $y = \\frac{y^+ \\mu}{\\rho u_\\tau}$. Substituting this into the integrated velocity profile:\n$$ U(y) = \\frac{u_\\tau}{\\kappa} \\ln\\left(\\frac{y^+ \\mu}{\\rho u_\\tau}\\right) + C = \\frac{u_\\tau}{\\kappa} \\left[ \\ln(y^+) + \\ln\\left(\\frac{\\mu}{\\rho u_\\tau}\\right) \\right] + C $$\nDividing by $u_\\tau$ to obtain $U^+$:\n$$ U^+ = \\frac{U(y)}{u_\\tau} = \\frac{1}{\\kappa} \\ln(y^+) + \\left[ \\frac{1}{\\kappa} \\ln\\left(\\frac{\\mu}{\\rho u_\\tau}\\right) + \\frac{C}{u_\\tau} \\right] $$\nThe term in the square brackets combines the integration constant and flow parameters. The problem states as an empirical fact that the log-law holds with a smooth-wall additive constant $B$. Thus, we identify the bracketed term with this empirical constant:\n$$ B = \\frac{1}{\\kappa} \\ln\\left(\\frac{\\mu}{\\rho u_\\tau}\\right) + \\frac{C}{u_\\tau} $$\nThis yields the desired logarithmic law of the wall:\n$$ U^+ = \\frac{1}{\\kappa} \\ln(y^+) + B $$\n\n**2. Implicit Equation for Friction Velocity**\n\nGiven a known mean velocity $U_p$ at a specified distance $y_p$ from the wall, these values must satisfy the log-law equation, provided the point $(y_p, U_p)$ lies within the logarithmic region. We substitute $U=U_p$ and $y=y_p$ into the law:\n$$ \\frac{U_p}{u_\\tau} = \\frac{1}{\\kappa} \\ln\\left(\\frac{\\rho u_\\tau y_p}{\\mu}\\right) + B $$\nThis is a transcendental, implicit equation for the unknown friction velocity $u_\\tau$.\n\n**3. Proof of a Unique Positive Solution**\n\nTo prove that a unique positive solution for $u_\\tau$ exists, we define a residual function $f(u_\\tau)$ whose root corresponds to the solution:\n$$ f(u_\\tau) = \\frac{U_p}{u_\\tau} - \\frac{1}{\\kappa} \\ln\\left(\\frac{\\rho u_\\tau y_p}{\\mu}\\right) - B $$\nWe seek $u_\\tau > 0$ such that $f(u_\\tau) = 0$. The uniqueness of the solution can be established by analyzing the monotonicity of $f(u_\\tau)$. We compute its first derivative with respect to $u_\\tau$:\n$$ f'(u_\\tau) = \\frac{d}{du_\\tau} \\left( U_p u_\\tau^{-1} - \\frac{1}{\\kappa} \\left[\\ln(u_\\tau) + \\ln\\left(\\frac{\\rho y_p}{\\mu}\\right)\\right] - B \\right) $$\n$$ f'(u_\\tau) = -U_p u_\\tau^{-2} - \\frac{1}{\\kappa u_\\tau} = -\\left(\\frac{U_p}{u_\\tau^2} + \\frac{1}{\\kappa u_\\tau}\\right) $$\nFor any physically meaningful case, $U_p > 0$, $\\kappa > 0$, and we are searching for a solution where $u_\\tau > 0$. Under these conditions, both terms in the parenthesis are positive, meaning $f'(u_\\tau) < 0$ for all $u_\\tau \\in (0, \\infty)$. Therefore, $f(u_\\tau)$ is a strictly monotonically decreasing function over the domain of positive $u_\\tau$.\n\nNext, we examine the limits of $f(u_\\tau)$ at the boundaries of this domain:\n-   As $u_\\tau \\to 0^+$, the term $\\frac{U_p}{u_\\tau} \\to +\\infty$ and the term $-\\frac{1}{\\kappa}\\ln(u_\\tau) \\to +\\infty$. Thus, $\\lim_{u_\\tau \\to 0^+} f(u_\\tau) = +\\infty$.\n-   As $u_\\tau \\to +\\infty$, the term $\\frac{U_p}{u_\\tau} \\to 0$ and the term $-\\frac{1}{\\kappa}\\ln(u_\\tau) \\to -\\infty$. Thus, $\\lim_{u_\\tau \\to \\infty} f(u_\\tau) = -\\infty$.\n\nSince $f(u_\\tau)$ is a continuous function on $(0, \\infty)$ that decreases strictly from $+\\infty$ to $-\\infty$, the Intermediate Value Theorem guarantees that it must cross the axis $f(u_\\tau)=0$ exactly once. This proves the existence of a unique, positive solution for $u_\\tau$.\n\n**4. Numerical Solution Method**\n\nTo solve the implicit equation $f(u_\\tau) = 0$, we employ Newton's method, which is known for its rapid (quadratic) convergence when the initial guess is sufficiently close to the root. The iterative formula is:\n$$ u_{\\tau, n+1} = u_{\\tau, n} - \\frac{f(u_{\\tau, n})}{f'(u_{\\tau, n})} $$\nSubstituting the expressions for $f(u_\\tau)$ and $f'(u_\\tau)$:\n$$ u_{\\tau, n+1} = u_{\\tau, n} - \\frac{\\frac{U_p}{u_{\\tau, n}} - \\frac{1}{\\kappa} \\ln\\left(\\frac{\\rho u_{\\tau, n} y_p}{\\mu}\\right) - B}{-\\left(\\frac{U_p}{u_{\\tau, n}^2} + \\frac{1}{\\kappa u_{\\tau, n}}\\right)} $$\nThis method is particularly \"robust\" for this specific problem. The second derivative, $f''(u_\\tau) = 2U_p u_\\tau^{-3} + \\frac{1}{\\kappa} u_\\tau^{-2}$, is always positive for $u_\\tau > 0$. This means the function $f(u_\\tau)$ is strictly convex. This property ensures that for any positive initial guess $u_{\\tau,0}$, the sequence of Newton's method iterates will converge monotonically to the unique positive root without divergence or oscillation, making it a highly reliable choice.\n\nThe implementation details are as follows:\n-   **Initial Guess:** A reasonable initial guess can be derived from empirical skin friction correlations. We use $u_{\\tau,0} = 0.05\\,U_p$, a common heuristic.\n-   **Convergence Criteria:** The iteration stops when either of the following conditions is met:\n    1.  The magnitude of the residual is less than a tolerance $\\varepsilon = 10^{-12}$: $|f(u_{\\tau, n+1})| < 10^{-12}$.\n    2.  The relative change in the solution is less than a tolerance $\\delta = 10^{-12}$: $|u_{\\tau, n+1} - u_{\\tau, n}| / |u_{\\tau, n+1}| < 10^{-12}$.\n-   **Termination:** A maximum of $N_{\\max} = 200$ iterations is imposed as a safeguard against unexpected behavior, though convergence is typically achieved in very few steps ($<10$).\n\n**5. Calculation of Wall Shear Stress**\n\nOnce the iterative process has converged to a final value for the friction velocity $u_\\tau$, the corresponding wall shear stress $\\tau_w$ is calculated directly from its definition:\n$$ \\tau_w = \\rho u_\\tau^2 $$\nThe final values for $u_\\tau$ and $\\tau_w$ are computed for each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for friction velocity and wall shear stress for a suite of test cases.\n    \"\"\"\n    \n    # Test suite: (rho, mu, U_p, y_p, kappa, B)\n    test_cases = [\n        # Case A (air at standard conditions)\n        (1.225, 1.7894e-5, 10.0, 1.0e-3, 0.41, 5.2),\n        # Case B (air, higher speed, finer first cell)\n        (1.225, 1.7894e-5, 40.0, 5.0e-4, 0.41, 5.2),\n        # Case C (water at room temperature)\n        (998.2, 1.003e-3, 1.0, 1.0e-3, 0.41, 5.2),\n        # Case D (air, moderate speed, alternative smooth-wall constant)\n        (1.2, 1.85e-5, 5.0, 7.5e-4, 0.41, 5.0),\n        # Case E (air, small y_p, slightly different B)\n        (1.225, 1.7894e-5, 15.0, 2.0e-4, 0.41, 5.5),\n    ]\n\n    results_as_strings = []\n    \n    for case in test_cases:\n        u_tau, tau_w = calculate_wall_quantities(*case)\n        # Format the results to exactly 6 decimal places and create the string for the inner list.\n        results_as_strings.append(f\"[{u_tau:.6f},{tau_w:.6f}]\")\n\n    # Combine the formatted strings into the final output format.\n    final_output = f\"[[{','.join(results_as_strings)}]]\"\n    print(final_output)\n\ndef calculate_wall_quantities(rho, mu, u_p, y_p, kappa, b):\n    \"\"\"\n    Calculates friction velocity (u_tau) and wall shear stress (tau_w) using Newton's method.\n\n    Args:\n        rho (float): Density (kg/m^3)\n        mu (float): Dynamic viscosity (Pa*s)\n        u_p (float): Mean velocity at point P (m/s)\n        y_p (float): Distance of point P from the wall (m)\n        kappa (float): Von Kármán constant\n        b (float): Log-law additive constant\n\n    Returns:\n        tuple[float, float]: A tuple containing the converged u_tau and the calculated tau_w.\n    \"\"\"\n    # Tolerances and iteration limits\n    eps = 1.0e-12\n    delta = 1.0e-12\n    n_max = 200\n\n    # Initial guess for u_tau using a common fluid dynamics heuristic\n    u_tau = 0.05 * u_p\n\n    # Pre-calculate constant term for efficiency\n    log_arg_const = rho * y_p / mu\n    \n    for _ in range(n_max):\n        # Ensure u_tau remains positive; if not, the guess is pathological (unlikely here)\n        if u_tau <= 0:\n            raise ValueError(\"u_tau became non-positive during iteration.\")\n\n        # Evaluate the residual function f(u_tau)\n        # f(u_tau) = Up/u_tau - (1/kappa) * ln(rho*u_tau*y_p/mu) - B\n        # The natural logarithm np.log is used.\n        f_val = u_p / u_tau - (1.0 / kappa) * np.log(log_arg_const * u_tau) - b\n\n        # Check for convergence based on residual magnitude\n        if abs(f_val) < eps:\n            break\n\n        # Evaluate the derivative of the residual function f'(u_tau)\n        # f'(u_tau) = -Up/u_tau^2 - 1/(kappa*u_tau)\n        f_prime_val = -u_p / (u_tau**2) - 1.0 / (kappa * u_tau)\n\n        # Newton's method update step\n        u_tau_new = u_tau - f_val / f_prime_val\n        \n        # Check for convergence based on relative change in u_tau\n        if abs(u_tau_new - u_tau) / abs(u_tau_new) < delta:\n            u_tau = u_tau_new\n            break\n\n        u_tau = u_tau_new\n    else:\n        # This block executes if the loop completes without `break`, indicating failure to converge.\n        raise RuntimeError(f\"Newton's method failed to converge within {n_max} iterations.\")\n\n    # Calculate wall shear stress from the converged friction velocity\n    tau_w = rho * u_tau**2\n\n    return u_tau, tau_w\n\nsolve()\n```"
        }
    ]
}