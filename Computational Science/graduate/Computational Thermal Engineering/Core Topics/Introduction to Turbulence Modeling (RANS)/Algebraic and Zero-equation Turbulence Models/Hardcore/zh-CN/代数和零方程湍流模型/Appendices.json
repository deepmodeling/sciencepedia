{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学（CFD）中，壁面函数是高效模拟壁面束缚湍流的关键技术。本练习将指导您从第一性原理出发，推导壁面律，并实现一个数值算法，利用近壁面的速度数据计算壁面剪切应力。掌握这项技能是湍流模型应用的基础。",
            "id": "3936298",
            "problem": "您需要从计算热工学和代数零方程湍流模型的首要原理出发，推导并实现连接摩擦速度 $u_{\\tau}$、壁面剪切应力 $\\tau_{w}$ 和光滑壁面附近平均速度剖面 $U(y)$ 的关系，并演示如何反演给定的近壁面单元中心数据以获得 $u_{\\tau}$，用于计算流体动力学（CFD）的壁面函数。请从以下基础开始，不援引任何快捷公式：牛顿流体的牛顿黏性定律、湍流动量输运的 Boussinesq 近似、混合长度与壁面法向距离成正比的代数混合长度概念，以及在平衡边界层的近壁面区域总剪切应力近似恒定的观测结果。您的推导必须得出广泛使用的壁面律对数律及其黏性子层对应部分，并生成一个算法，通过第一个离壁点的速度 $U_{P}$、其壁面法向距离 $y_{P}$以及流体性质来反演对数律以计算 $u_{\\tau}$。\n\n实现要求：\n- 使用连接摩擦速度 $u_{\\tau}$、壁面剪切应力 $\\tau_{w}$ 和密度 $\\rho$ 的基本定义来定义摩擦速度。使用混合长度与 $y$ 成正比的混合长度零方程模型，推导以 $u_{\\tau}$ 表示的平均速度剖面的对数律表达式。解释从牛顿黏性定律得出的黏性子层线性关系，并说明它如何通过为光滑壁面进行经验校准得到的加法常数与对数律相匹配。\n- 设计一个稳健的数值反演程序，在给定 $U_{P}$、$y_{P}$ 和运动黏度 $\\nu$ 的情况下，通过适用于光滑壁面的求根方法求解关于 $u_{\\tau}$ 的对数律关系来计算 $u_{\\tau}$。使用黏性子层判据来决定何时应使用线性关系而非对数律。您必须使用一种能确保 $u_{\\tau} > 0$ 且对物理上真实的输入收敛的数值方法。最终的算法必须基于您的推导，而不是黑箱公式。\n- 获得 $u_{\\tau}$ 后，使用 $u_{\\tau}$ 和 $\\tau_{w}$ 之间推导出的关系计算壁面剪切应力 $\\tau_{w}$。\n\n物理单位：\n- 以 $\\mathrm{m/s}$ 表示 $u_{\\tau}$，以 $\\mathrm{Pa}$ 表示 $\\tau_{w}$。所有输入和输出均使用国际单位制（SI）。\n\n水力光滑壁面常数：\n- 使用 von Karman 常数 $\\kappa = 0.41$ 和加法常数 $B = 5.2$。\n- 使用黏性子层切换阈值 $y^{+}_{\\mathrm{switch}} = 11.0$ 来在黏性子层关系和对数律之间进行选择。\n\n测试套件：\n对于下面的每个测试案例，将流动视为在光滑壁面上方，并根据给定的输入参数计算 $u_{\\tau}$ 和 $\\tau_{w}$。每个案例指定 $(U_{P}, y_{P}, \\rho, \\nu)$，其中 $U_{P}$ 是第一个离壁点的平均速度（单位 $\\mathrm{m/s}$），$y_{P}$ 是壁面法向距离（单位 $\\mathrm{m}$），$\\rho$ 是密度（单位 $\\mathrm{kg/m^3}$），$\\nu$ 是运动黏度（单位 $\\mathrm{m^2/s}$）。\n\n- 案例 $1$（明确的对数律区）：$(U_{P} = 10.0,\\ y_{P} = 0.005,\\ \\rho = 1.20,\\ \\nu = 1.50\\times 10^{-5})$。\n- 案例 $2$（切换点附近的过渡区）：$(U_{P} = 5.0,\\ y_{P} = 0.001,\\ \\rho = 1.20,\\ \\nu = 1.50\\times 10^{-5})$。\n- 案例 $3$（黏性子层主导，水）：$(U_{P} = 0.20,\\ y_{P} = 5.0\\times 10^{-5},\\ \\rho = 1000.0,\\ \\nu = 1.00\\times 10^{-6})$。\n- 案例 $4$（高黏度，近壁面线性区，油）：$(U_{P} = 2.00,\\ y_{P} = 0.002,\\ \\rho = 850.0,\\ \\nu = 1.00\\times 10^{-4})$。\n- 案例 $5$（非常大的 $y^{+}$，强对数律）：$(U_{P} = 30.0,\\ y_{P} = 0.020,\\ \\rho = 1.20,\\ \\nu = 1.50\\times 10^{-5})$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素必须是一个包含两个元素的列表，分别为对应测试案例的 $u_{\\tau}$（单位 $\\mathrm{m/s}$）和 $\\tau_{w}$（单位 $\\mathrm{Pa}$）。例如，输出必须类似于 $[[u_{\\tau,1},\\ \\tau_{w,1}],\\ [u_{\\tau,2},\\ \\tau_{w,2}],\\ \\ldots]$。不得打印任何其他文本。",
            "solution": "所提出的问题是为光滑表面上的湍流边界层推导并实现壁面律，并构建一个数值算法，从单个近壁面速度测量值计算摩擦速度 $u_{\\tau}$ 和壁面剪切应力 $\\tau_{w}$。该问题在科学上是合理的、适定的、客观的，并包含了获得唯一解所需的所有信息。这是计算流体动力学（CFD）和热工学中的一个标准且基本的问题。因此，我们可以进行完整的推导和求解。\n\n推导从考虑边界层中的总剪切应力 $\\tau_{total}$ 开始。该应力是黏性（层流）应力 $\\tau_{visc}$ 和湍流（雷诺）应力 $\\tau_{turb}$ 的总和：\n$$\n\\tau_{total}(y) = \\tau_{visc}(y) + \\tau_{turb}(y)\n$$\n其中 $y$ 是壁面法向坐标。对于牛顿流体，黏性应力由牛顿黏性定律给出：\n$$\n\\tau_{visc} = \\mu \\frac{\\mathrm{d}U}{\\mathrm{d}y} = \\rho \\nu \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n其中 $U(y)$ 是平均速度剖面，$\\mu$ 是动力黏度，$\\rho$ 是流体密度，$\\nu = \\mu/\\rho$ 是运动黏度。湍流应力源于速度脉动引起的动量输运的时均效应，即雷诺应力 $-\\rho \\overline{u'v'}$。使用 Boussinesq 近似，该应力通过涡黏度 $\\nu_t$ 类比黏性应力进行建模：\n$$\n\\tau_{turb} = -\\rho \\overline{u'v'} = \\rho \\nu_t \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n在平衡湍流边界层的近壁面区域，总剪切应力近似恒定，并等于壁面处的剪切应力 $\\tau_w$。因此，我们有：\n$$\n\\tau_w = \\tau_{visc} + \\tau_{turb} = \\rho(\\nu + \\nu_t) \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n壁面约束湍流中的一个基本量是摩擦速度 $u_{\\tau}$，它由壁面剪切应力和密度定义：\n$$\nu_{\\tau} \\equiv \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n将此定义代入应力方程可得：\n$$\nu_{\\tau}^2 = (\\nu + \\nu_t) \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n该方程构成了推导近壁面速度剖面的基础。我们在两个不同的区域对其进行分析。\n\n首先，在紧邻壁面的黏性子层中，湍流脉动受到黏性效应的强烈抑制。因此，我们可以假设涡黏度与分子黏度相比可以忽略不计，即 $\\nu_t \\ll \\nu$。方程简化为：\n$$\nu_{\\tau}^2 \\approx \\nu \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n将此方程从壁面（$y=0$，此处无滑移条件要求 $U=0$）积分到距离 $y$ 处，得到线性速度剖面：\n$$\n\\int_0^U \\mathrm{d}U' = \\int_0^y \\frac{u_{\\tau}^2}{\\nu} \\mathrm{d}y' \\implies U(y) = \\frac{u_{\\tau}^2}{\\nu} y\n$$\n习惯上用无量纲壁面单位来表示，其中速度由 $u_{\\tau}$ 进行缩放，长度由黏性长度尺度 $\\nu/u_{\\tau}$ 进行缩放。我们定义无量纲速度 $U^{+} = U/u_{\\tau}$ 和无量纲壁面距离 $y^{+} = y u_{\\tau}/\\nu$。在这些单位中，线性剖面变为：\n$$\n\\frac{U}{u_{\\tau}} = \\frac{y u_{\\tau}}{\\nu} \\implies U^{+} = y^{+}\n$$\n该线性关系对黏性子层成立，通常适用于 $y^{+} \\lesssim 5$。\n\n其次，在对数层（或对数律区）中，该区域离壁面较远，但仍位于内层，湍流输运远大于黏性输运，因此我们假设 $\\nu_t \\gg \\nu$。应力方程近似为：\n$$\nu_{\\tau}^2 \\approx \\nu_t \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n为了继续，我们需要一个涡黏度 $\\nu_t$ 的模型。问题指定了 Prandtl 的混合长度模型，这是一个零方程代数模型。对于 $\\mathrm{d}U/\\mathrm{d}y > 0$ 的边界层，该模型表述为 $\\nu_t = l_m^2 (\\mathrm{d}U/\\mathrm{d}y)$。近壁面区域的一个关键假设是混合长度 $l_m$ 与离壁距离成正比，即 $l_m = \\kappa y$，其中 $\\kappa$ 是 von Karman 常数。将此代入简化的应力方程中得到：\n$$\nu_{\\tau}^2 \\approx \\left((\\kappa y)^2 \\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right) \\frac{\\mathrm{d}U}{\\mathrm{d}y} = (\\kappa y)^2 \\left(\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2\n$$\n对两边取平方根（并注意 $u_{\\tau}$、$\\kappa$、$y$ 和 $\\mathrm{d}U/\\mathrm{d}y$ 均为正值），得到一个可分离的一阶常微分方程：\n$$\nu_{\\tau} = \\kappa y \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\implies \\mathrm{d}U = \\frac{u_{\\tau}}{\\kappa} \\frac{\\mathrm{d}y}{y}\n$$\n积分此方程得到对数速度剖面：\n$$\nU(y) = \\frac{u_{\\tau}}{\\kappa} \\ln(y) + C\n$$\n其中 $C$ 是一个积分常数。为了用壁面单位表示，我们将其改写为：\n$$\n\\frac{U(y)}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln(y) + C' \\implies U^{+} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y u_{\\tau}}{\\nu} \\cdot \\frac{\\nu}{u_{\\tau}}\\right) + C' = \\frac{1}{\\kappa} \\ln(y^{+}) + \\left(C' + \\frac{1}{\\kappa}\\ln\\left(\\frac{\\nu}{u_{\\tau}}\\right)\\right)\n$$\n括号中的项被吸收到一个新的常数 $B$ 中，称为对数律加法常数，该常数由光滑壁面的实验数据经验性地确定。对数律的最终形式是：\n$$\nU^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B\n$$\n问题指定了光滑壁面的标准值：$\\kappa = 0.41$ 和 $B = 5.2$。该定律通常在 $y^{+} \\gtrsim 30$ 时有效。在黏性子层和对数律区之间存在一个缓冲层，其中黏性应力和湍流应力均显著。在 CFD 壁面函数实践中，我们在指定的阈值 $y^{+}_{\\mathrm{switch}} = 11.0$ 处使用两个定律之间的急剧过渡。\n\n核心任务是，在给定来自近壁面计算单元中心的单个数据点 $(y_P, U_P)$ 以及流体性质 $\\rho$ 和 $\\nu$ 的情况下，反演这些关系以求得 $u_{\\tau}$。挑战在于，在线性律和对数律之间的选择取决于 $y_P^{+} = y_P u_{\\tau}/\\nu$ 的值，而这个值本身又依赖于未知的 $u_{\\tau}$。\n\n我们可以通过建立一个基于给定速度 $U_P$ 的判据来设计一个稳健的算法。让我们找到 $u_{\\tau}$ 的阈值，记为 $u_{\\tau, \\mathrm{switch}}$，在该阈值下点 $y_P$ 正好位于过渡边界 $y_P^{+} = y^{+}_{\\mathrm{switch}}$ 上：\n$$\n\\frac{y_P u_{\\tau, \\mathrm{switch}}}{\\nu} = y^{+}_{\\mathrm{switch}} \\implies u_{\\tau, \\mathrm{switch}} = \\frac{y^{+}_{\\mathrm{switch}} \\nu}{y_P}\n$$\n在此过渡点，速度 $U_{\\mathrm{switch}}$ 可以使用线性律计算（因为对于所选的 B 值，定律在此点是连续的）：\n$$\nU^{+}_{\\mathrm{switch}} = y^{+}_{\\mathrm{switch}} \\implies \\frac{U_{\\mathrm{switch}}}{u_{\\tau, \\mathrm{switch}}} = y^{+}_{\\mathrm{switch}} \\implies U_{\\mathrm{switch}} = u_{\\tau, \\mathrm{switch}} y^{+}_{\\mathrm{switch}} = \\left(\\frac{y^{+}_{\\mathrm{switch}} \\nu}{y_P}\\right) y^{+}_{\\mathrm{switch}} = \\frac{(y^{+}_{\\mathrm{switch}})^2 \\nu}{y_P}\n$$\n这个 $U_{\\mathrm{switch}}$ 表示如果点 $y_P$ 恰好位于子层和对数层之间的边界上时，在该距离处测得的速度。我们现在可以将给定的测量速度 $U_P$ 与此阈值进行比较：\n1. 如果 $U_P \\le U_{\\mathrm{switch}}$，点 $(y_P, U_P)$ 位于黏性子层内。因此，我们可以使用显式线性关系来求解 $u_{\\tau}$：\n   $$\n   U_P = \\frac{u_{\\tau}^2 y_P}{\\nu} \\implies u_{\\tau} = \\sqrt{\\frac{U_P \\nu}{y_P}}\n   $$\n2. 如果 $U_P > U_{\\mathrm{switch}}$，点位于对数律区域内。我们必须解下面的超越方程来求 $u_{\\tau}$：\n   $$\n   U_P = u_{\\tau} \\left(\\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\\right)\n   $$\n这需要一个数值求根方法。让我们定义一个残差函数 $R(u_{\\tau})$：\n$$\nR(u_{\\tau}) = u_{\\tau} \\left(\\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\\right) - U_P = 0\n$$\n牛顿法是求解此问题的有效选择。迭代更新为 $u_{\\tau, k+1} = u_{\\tau, k} - R(u_{\\tau, k})/R'(u_{\\tau, k})$。导数 $R'(u_{\\tau})$ 为：\n$$\nR'(u_{\\tau}) = \\frac{\\mathrm{d}}{\\mathrm{d}u_{\\tau}} \\left[ u_{\\tau} \\left(\\frac{U_P}{u_{\\tau}}\\right) - U_P \\right] = \\frac{\\mathrm{d}}{\\mathrm{d}u_{\\tau}} \\left[ u_{\\tau} \\left(\\frac{1}{\\kappa} \\ln(y_P u_{\\tau}/\\nu) + B \\right) \\right]\n$$\n$$\nR'(u_{\\tau}) = \\left(\\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\\right) + u_{\\tau} \\left(\\frac{1}{\\kappa} \\frac{1}{u_{\\tau}}\\right) = \\frac{U_P}{u_{\\tau}} + \\frac{1}{\\kappa}\n$$\n由于 $U_P$、$u_{\\tau}$ 和 $\\kappa$ 均为正值，$R'(u_{\\tau})$ 总是正的，这保证了 $R(u_{\\tau})$ 是单调的并且最多只有一个根。一个有效的迭代初值可以是 $u_{\\tau, 0} = u_{\\tau, \\mathrm{switch}}$ 或其他合理的估计值，例如 $u_{\\tau, 0} = U_P/20$。迭代过程持续进行，直到 $u_{\\tau}$ 的变化小于预设的容差。\n\n一旦通过显式公式或迭代求解器确定了 $u_{\\tau}$，壁面剪切应力 $\\tau_w$ 就直接根据其定义计算：\n$$\n\\tau_w = \\rho u_{\\tau}^2\n$$\n这完成了解决该问题所需的理论框架和算法设计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements the law of the wall to compute friction velocity\n    and wall shear stress from near-wall CFD data.\n    \"\"\"\n\n    # Define physical constants for a hydraulically smooth wall as per the problem.\n    KAPPA = 0.41  # von Karman constant\n    B = 5.2       # Log-law additive constant\n    Y_PLUS_SWITCH = 11.0 # Threshold for switching between viscous and log layers\n\n    # Test cases: (U_P, y_P, rho, nu)\n    # U_P: mean velocity at cell center [m/s]\n    # y_P: wall-normal distance of cell center [m]\n    # rho: fluid density [kg/m^3]\n    # nu: fluid kinematic viscosity [m^2/s]\n    test_cases = [\n        (10.0, 0.005, 1.20, 1.50e-5),  # Case 1 (clear log-law regime)\n        (5.0, 0.001, 1.20, 1.50e-5),   # Case 2 (transitional near the switch)\n        (0.20, 5.0e-5, 1000.0, 1.00e-6),# Case 3 (viscous sublayer dominance, water)\n        (2.00, 0.002, 850.0, 1.00e-4), # Case 4 (high viscosity, linear regime, oil)\n        (30.0, 0.020, 1.20, 1.50e-5),  # Case 5 (very large y+, strong log-law)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        U_P, y_P, rho, nu = case\n\n        # Calculate the threshold velocity U_switch that corresponds to y_P being\n        # at the transition point y_plus_switch.\n        # This determines whether the point (y_P, U_P) is in the viscous sublayer\n        # or the logarithmic layer.\n        u_tau_switch = Y_PLUS_SWITCH * nu / y_P\n        U_switch = u_tau_switch * Y_PLUS_SWITCH\n\n        if U_P = U_switch:\n            # The point is in the viscous sublayer.\n            # U = u_tau^2 * y / nu  =>  u_tau = sqrt(U * nu / y)\n            u_tau = np.sqrt(U_P * nu / y_P)\n        else:\n            # The point is in the logarithmic layer.\n            # We must solve the transcendental equation for u_tau using an iterative method.\n            # U_P = u_tau * (1/KAPPA * ln(y_P * u_tau / nu) + B)\n            # We use Newton's method to solve for R(u_tau) = 0 where\n            # R(u_tau) = u_tau * (1/KAPPA * ln(...) + B) - U_P\n            \n            # A good initial guess for the iteration.\n            # A simple physical heuristic is often sufficient, e.g., u_tau is a few percent of U_P.\n            # Starting from the switch value is also a robust choice.\n            u_tau_k = u_tau_switch \n            \n            # Parameters for Newton's method solver\n            TOLERANCE = 1.0e-9\n            MAX_ITERATIONS = 15\n\n            for i in range(MAX_ITERATIONS):\n                if u_tau_k = 0: # Ensure log argument is positive\n                    # This case is unlikely with good initial guess but is a safeguard.\n                    # A small positive value is used to restart.\n                    u_tau_k = TOLERANCE \n                \n                # Evaluate the residual function R(u_tau)\n                y_plus_k = y_P * u_tau_k / nu\n                U_plus_k = (1.0 / KAPPA) * np.log(y_plus_k) + B\n                R = u_tau_k * U_plus_k - U_P\n\n                # Evaluate the derivative of the residual function R'(u_tau)\n                # R'(u_tau) = U_plus + 1/KAPPA\n                R_prime = U_plus_k + 1.0 / KAPPA\n\n                # Newton's method update step\n                u_tau_k_plus_1 = u_tau_k - R / R_prime\n\n                if abs(u_tau_k_plus_1 - u_tau_k)  TOLERANCE:\n                    break\n                \n                u_tau_k = u_tau_k_plus_1\n            \n            u_tau = u_tau_k_plus_1\n\n        # After finding u_tau, calculate the wall shear stress tau_w.\n        # tau_w = rho * u_tau^2\n        tau_w = rho * u_tau**2\n        \n        results.append([u_tau, tau_w])\n\n    # Format the final output as specified.\n    output_str = \"[\" + \",\".join([f\"[{u_tau:.8e}, {tau_w:.8e}]\" for u_tau, tau_w in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "将代数模型的应用从动量输运推广到热量输运，是计算热工学中的一个重要步骤。本练习将探讨如何通过引入湍流普朗特数（$Pr_t$）来模拟湍流热通量，并分析不同的近壁面阻尼函数——作为混合长度模型的关键修正——对传热预测的影响。这有助于深入理解模型中不同假设的敏感性。",
            "id": "3936299",
            "problem": "考虑一个邻近等温壁面的稳定、充分发展的湍流热边界层，其厚度为 $\\delta$。设流体的密度为 $\\rho$，动力粘度为 $\\mu$，定压比热为 $c_p$，热导率为 $k$。分子运动粘度为 $\\nu = \\mu / \\rho$，分子热扩散率为 $\\alpha = k / (\\rho c_p)$。定义摩擦速度 $u_\\tau = \\sqrt{\\tau_w / \\rho}$，其中 $\\tau_w$ 是壁面剪切应力。无量纲壁面距离为 $y^+ = y u_\\tau / \\nu$，摩擦雷诺数为 $\\mathrm{Re}_\\tau = u_\\tau \\delta / \\nu$。湍流普朗特数（湍流的普朗特数）$\\mathrm{Pr}_t$ 通过 $\\alpha_t = \\nu_t / \\mathrm{Pr}_t$ 将湍流热扩散率 $\\alpha_t$ 和湍流运动粘度 $\\nu_t$ 联系起来。在代数零方程湍流模型中，湍流运动粘度使用 Prandtl 混合长度假设进行建模，其中混合长度为 $l_m = \\kappa y f_d(y^+)$，$\\kappa$ 是 von Kármán 常数，$f_d(y^+)$ 是一个近壁阻尼函数。剪切应力使用 Boussinesq 假设和对数层中平均速度梯度的平衡近似来进行封闭。有效热导率为 $k_\\mathrm{eff}(y) = k + \\rho c_p \\alpha_t(y)$，一维横向热通量为 $q''(y) = -k_\\mathrm{eff}(y) \\,\\mathrm{d}T/\\mathrm{d}y$。在单位面积壁面热输入恒定的充分发展条件下，总横向热通量与 $y$ 无关，这意味着可以将其解释为热阻。因此，壁面传热系数 $h$ 可以用整个边界层的积分热阻表示为 $h = \\left[\\int_0^\\delta \\frac{\\mathrm{d}y}{k_\\mathrm{eff}(y)}\\right]^{-1}$。你的任务是通过以下步骤分析预测的 $h$ 对阻尼函数 $f_d(y^+)$ 选择的敏感性：从 $\\mathrm{Pr}_t$ 和 $l_m = \\kappa y f_d(y^+)$ 计算 $\\alpha_t(y)$，求出 $k_\\mathrm{eff}(y)$，并对热阻进行积分。\n\n使用以下三个科学上合理的阻尼函数 $f_d(y^+)$：\n\n- Van Driest：$f_d(y^+) = 1 - \\exp\\!\\left(-\\dfrac{y^+}{A^+}\\right)$。\n- 双曲正切：$f_d(y^+) = \\tanh\\!\\left(\\dfrac{y^+}{A^+}\\right)$。\n- 代数有理式：$f_d(y^+) = \\dfrac{y^+}{A^+ + y^+}$。\n\n从上述基本关系出发，一致地使用混合长度封闭和平衡对数层近似来确定 $\\nu_t(y)$，然后计算 $\\alpha_t(y)$ 和 $k_\\mathrm{eff}(y)$，最后从积分热阻中获得 $h$。假设 von Kármán 常数为常数 $\\kappa = 0.41$，并对每个测试案例将 $\\mathrm{Pr}_t$ 视为给定的常数。\n\n将最终的传热系数 $h$ 以 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$ 为单位，表示为浮点数值。\n\n测试套件：\n对于以下每个参数集，分别计算与 Van Driest、双曲正切和代数有理阻尼函数相对应的三个值的元组 $\\left[h_\\mathrm{VD}, h_\\mathrm{TH}, h_\\mathrm{AL}\\right]$：\n\n- 案例 1（类空气）：$\\rho = 1.200\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\mu = 1.800\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$， $k = 0.0260\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$， $c_p = 1005\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$， $u_\\tau = 0.500\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$， $\\delta = 0.0100\\,\\mathrm{m}$， $\\mathrm{Pr}_t = 0.85$， $A^+ = 26$。\n- 案例 2（类水）：$\\rho = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\mu = 1.00\\times 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$， $k = 0.600\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$， $c_p = 4180\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$， $u_\\tau = 0.100\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$， $\\delta = 0.0100\\,\\mathrm{m}$， $\\mathrm{Pr}_t = 0.90$， $A^+ = 26$。\n- 案例 3（低摩擦雷诺数边缘情况，类空气）：$\\rho = 1.200\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\mu = 1.800\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$， $k = 0.0260\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$， $c_p = 1005\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$， $u_\\tau = 0.0900\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$， $\\delta = 0.00100\\,\\mathrm{m}$， $\\mathrm{Pr}_t = 0.85$， $A^+ = 26$。\n\n您的程序应生成单行输出，其中包含一个由逗号分隔的三个内部列表组成的列表。每个内部列表包含一个案例的三个浮点数 $h$ 值，按案例 1、案例 2、案例 3 的顺序排列，并用方括号括起来。例如，格式应类似于 $\\left[\\left[h_1^\\mathrm{VD},h_1^\\mathrm{TH},h_1^\\mathrm{AL}\\right],\\left[h_2^\\mathrm{VD},h_2^\\mathrm{TH},h_2^\\mathrm{AL}\\right],\\left[h_3^\\mathrm{VD},h_3^\\mathrm{TH},h_3^\\mathrm{AL}\\right]\\right]$，所有 $h$ 值的单位均为 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$。",
            "solution": "该问题是有效的。它以湍流边界层理论和传热学的原理为科学基础，特别是使用了 Prandtl 混合长度模型，这是一种标准的代数零方程模型。该问题是适定的、客观的、自洽的，并且在计算上是可行的。\n\n目标是针对三组物理参数，为三种不同的阻尼函数 $f_d(y^+)$ 计算传热系数 $h$。传热系数由整个边界层的总热阻的倒数给出：\n$$ h = \\left[\\int_0^\\delta \\frac{\\mathrm{d}y}{k_\\mathrm{eff}(y)}\\right]^{-1} $$\n其中 $\\delta$ 是边界层厚度，$k_\\mathrm{eff}(y)$ 是距离壁面 $y$ 处的有效热导率。\n\n有效热导率是分子热导率 $k$ 和湍流贡献 $k_t = \\rho c_p \\alpha_t$ 的和，其中 $\\rho$ 是密度，$c_p$ 是定压比热，$\\alpha_t$ 是湍流热扩散率。\n$$ k_\\mathrm{eff}(y) = k + \\rho c_p \\alpha_t(y) $$\n湍流热扩散率 $\\alpha_t$ 通过湍流普朗特数 $\\mathrm{Pr}_t$ 与湍流运动粘度 $\\nu_t$ 相关联：\n$$ \\alpha_t(y) = \\frac{\\nu_t(y)}{\\mathrm{Pr}_t} $$\n问题指示使用 Prandtl 混合长度假设 $l_m$ 和“对数层中平均速度梯度的平衡近似”来确定湍流运动粘度 $\\nu_t$。\n\n湍流粘度的混合长度模型是：\n$$ \\nu_t = l_m^2 \\left| \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\right| $$\n混合长度 $l_m$ 给出为：\n$$ l_m = \\kappa y f_d(y^+) $$\n其中 $\\kappa$ 是 von Kármán 常数，$y$ 是壁面距离，$f_d(y^+)$ 是无量纲壁面距离 $y^+ = y u_\\tau / \\nu$ 的近壁阻尼函数。这里，$u_\\tau$ 是摩擦速度，$\\nu$ 是分子运动粘度。\n\n对数层中平均速度梯度的近似为：\n$$ \\frac{\\mathrm{d}U}{\\mathrm{d}y} = \\frac{u_\\tau}{\\kappa y} $$\n将 $l_m$ 和 $\\mathrm{d}U/\\mathrm{d}y$ 的表达式代入 $\\nu_t$ 的方程，得到：\n$$ \\nu_t(y) = (\\kappa y f_d(y^+))^2 \\left( \\frac{u_\\tau}{\\kappa y} \\right) = \\kappa y u_\\tau (f_d(y^+))^2 $$\n现在我们可以组合出 $k_\\mathrm{eff}(y)$ 的完整表达式：\n$$ k_\\mathrm{eff}(y) = k + \\frac{\\rho c_p}{\\mathrm{Pr}_t} \\nu_t(y) = k + \\frac{\\rho c_p}{\\mathrm{Pr}_t} \\kappa y u_\\tau (f_d(y^+))^2 $$\n为简化积分，我们执行从 $y$ 到 $y^+$ 的变量替换。\n$y = y^+ \\nu / u_\\tau$，因此 $\\mathrm{d}y = (\\nu / u_\\tau) \\mathrm{d}y^+$。\n积分上限 $y=\\delta$ 变为 $y^+ = \\delta^+ = \\delta u_\\tau / \\nu = \\mathrm{Re}_\\tau$。\n热阻积分 $R_{th} = 1/h$ 变为：\n$$ R_{th} = \\int_0^{\\mathrm{Re}_\\tau} \\frac{(\\nu / u_\\tau) \\mathrm{d}y^+}{k + \\frac{\\rho c_p}{\\mathrm{Pr}_t} \\kappa \\left( \\frac{y^+\\nu}{u_\\tau} \\right) u_\\tau (f_d(y^+))^2} = \\int_0^{\\mathrm{Re}_\\tau} \\frac{(\\nu / u_\\tau) \\mathrm{d}y^+}{k + \\frac{\\rho c_p \\kappa \\nu}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2} $$\n从分母中提取公因式 $k$，并使用分子普朗特数的定义 $\\mathrm{Pr} = \\nu / \\alpha = \\nu \\rho c_p / k$，我们可以写出 $\\rho c_p \\kappa \\nu = k \\kappa \\mathrm{Pr}$。\n$$ R_{th} = \\int_0^{\\mathrm{Re}_\\tau} \\frac{(\\nu / u_\\tau) \\mathrm{d}y^+}{k \\left( 1 + \\frac{\\kappa \\mathrm{Pr}}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2 \\right)} = \\frac{\\nu}{k u_\\tau} \\int_0^{\\mathrm{Re}_\\tau} \\frac{\\mathrm{d}y^+}{1 + \\frac{\\kappa \\mathrm{Pr}}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2} $$\n那么传热系数为：\n$$ h = \\frac{1}{R_{th}} = \\frac{k u_\\tau}{\\nu} \\left[ \\int_0^{\\mathrm{Re}_\\tau} \\frac{\\mathrm{d}y^+}{1 + \\frac{\\kappa \\mathrm{Pr}}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2} \\right]^{-1} $$\n这个最终形式适用于数值计算。对于每个测试案例，我们首先计算派生参数 $\\nu$、$\\mathrm{Pr}$ 和 $\\mathrm{Re}_\\tau$。然后，对于三个指定的阻尼函数 $f_d(y^+)$ 中的每一个，我们使用数值积分方法对从 $y^+=0$ 到 $y^+=\\mathrm{Re}_\\tau$ 的定积分进行数值求值。最后，我们使用上述公式计算 $h$。\n\n要使用的三个阻尼函数是：\n1.  Van Driest：$f_d(y^+) = 1 - \\exp(-y^+/A^+)$\n2.  双曲正切：$f_d(y^+) = \\tanh(y^+/A^+)$\n3.  代数有理式：$f_d(y^+) = y^+ / (A^+ + y^+)$\n\n数值解是通过定义一个 Python 函数来实现的，该函数将物理参数和阻尼函数类型作为输入，构造被积函数，使用 `scipy.integrate.quad` 执行积分，并返回计算出的 $h$ 值。对测试套件中指定的所有组合重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the turbulent heat transfer problem for the given test cases.\n    \"\"\"\n    # Define physical constants and test case parameters\n    KAPPA = 0.41\n\n    test_cases = [\n        # Case 1 (air-like)\n        {'rho': 1.200, 'mu': 1.800e-5, 'k': 0.0260, 'cp': 1005,\n         'u_tau': 0.500, 'delta': 0.0100, 'Pr_t': 0.85, 'A_plus': 26},\n        # Case 2 (water-like)\n        {'rho': 1000.0, 'mu': 1.00e-3, 'k': 0.600, 'cp': 4180.0,\n         'u_tau': 0.100, 'delta': 0.0100, 'Pr_t': 0.90, 'A_plus': 26},\n        # Case 3 (low-friction Re, air-like)\n        {'rho': 1.200, 'mu': 1.800e-5, 'k': 0.0260, 'cp': 1005,\n         'u_tau': 0.0900, 'delta': 0.00100, 'Pr_t': 0.85, 'A_plus': 26}\n    ]\n\n    damping_model_names = ['VD', 'TH', 'AL']\n    all_results = []\n\n    for params in test_cases:\n        case_results = []\n        for model_name in damping_model_names:\n            h = calculate_heat_transfer_coefficient(params, model_name, KAPPA)\n            case_results.append(h)\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # [[h_1_VD, h_1_TH, h_1_AL], [h_2_VD, h_2_TH, h_2_AL], [h_3_VD, h_3_TH, h_3_AL]]\n    formatted_results = f\"[{','.join([f'[{\",\".join(map(str, inner))}]' for inner in all_results])}]\"\n    print(formatted_results)\n\n\ndef calculate_heat_transfer_coefficient(params, damping_type, kappa):\n    \"\"\"\n    Calculates the heat transfer coefficient h for a given set of parameters\n    and a specific damping function model.\n\n    Args:\n        params (dict): Dictionary of physical and flow parameters.\n        damping_type (str): Type of damping function ('VD', 'TH', 'AL').\n        kappa (float): von Kármán constant.\n\n    Returns:\n        float: The calculated heat transfer coefficient h in W m^-2 K^-1.\n    \"\"\"\n    # Unpack parameters\n    rho = params['rho']\n    mu = params['mu']\n    k = params['k']\n    cp = params['cp']\n    u_tau = params['u_tau']\n    delta = params['delta']\n    Pr_t = params['Pr_t']\n    A_plus = params['A_plus']\n\n    # Calculate derived fluid and flow properties\n    nu = mu / rho\n    Pr = mu * cp / k\n    Re_tau = u_tau * delta / nu  # This is the upper integration limit, delta^+\n\n    # Define the damping functions based on the specified type\n    def f_d(y_plus):\n        if damping_type == 'VD':\n            # Van Driest\n            return 1.0 - np.exp(-y_plus / A_plus)\n        elif damping_type == 'TH':\n            # Hyperbolic tangent\n            return np.tanh(y_plus / A_plus)\n        elif damping_type == 'AL':\n            # Algebraic rational\n            return y_plus / (A_plus + y_plus)\n        else:\n            raise ValueError(f\"Unknown damping type: {damping_type}\")\n\n    # Define the integrand for the non-dimensional resistance integral\n    def integrand_nondim(y_plus):\n        # Integrand for I in R_th = (nu / (k * u_tau)) * I\n        # I = integral from 0 to Re_tau of dy+ / (k_eff/k)\n        # where k_eff/k = 1 + (kappa * Pr / Pr_t) * y_plus * (f_d(y_plus))^2\n        if y_plus == 0:\n            return 1.0  # k_eff/k = 1 at the wall\n\n        fd_val = f_d(y_plus)\n        k_eff_over_k = 1.0 + (kappa * Pr / Pr_t) * y_plus * (fd_val**2)\n        return 1.0 / k_eff_over_k\n\n    # Perform the numerical integration of the non-dimensional thermal resistance\n    integral_val, _ = quad(integrand_nondim, 0, Re_tau)\n\n    # Calculate the heat transfer coefficient h\n    # h = 1/R_th = (k * u_tau / nu) / integral_val\n    h = (k * u_tau / nu) / integral_val\n    \n    return h\n\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "为了更广阔地理解湍流模型，我们将经典的雷诺平均（RANS）壁面函数与大涡模拟（LES）中简化的壁面模型进行比较。本练习通过对比基于对数律的平衡假设与基于局部应变率的 Smagorinsky 模型，揭示了两种主流湍流模拟方法在理论基础和实际应用中的差异。",
            "id": "3936341",
            "problem": "考虑一个不可压缩的湍流壁面有界流，其中在距离无滑移壁面 $y_1$ 处，壁面附近的速度 $U$ 是已知的。您将比较两种用于估算壁面剪切应力和表面摩擦系数的零方程代数闭合模型：(i) 使用简单平衡壁面模型的大涡模拟 (LES) Smagorinsky 闭合模型，以及 (ii) 基于壁面律对数律的雷诺平均纳维-斯托克斯 (RANS) 壁面函数。目标是推导、计算和比较两种方法在 $y_1$ 处的摩擦速度 $u_\\tau$ 和无量纲速度 $U^+$，并计算参考指定流向速度 $U_{\\text{ref}}$ 的表面摩擦系数 $c_f$。\n\n使用的基于原理的设置和定义：\n- 壁面平均剪切应力通过动量的粘性输运和湍流输运之间的平衡来建模。对于有效运动粘度为 $\\nu_{\\mathrm{eff}}$ 的牛顿流体，平均剪切应力为 $\\tau_w = \\rho \\, \\nu_{\\mathrm{eff}} \\, \\left|\\partial U/\\partial y\\right|$，其中 $\\rho$ 是流体密度。摩擦速度为 $u_\\tau = \\sqrt{\\tau_w/\\rho}$。参考 $U_{\\text{ref}}$ 的表面摩擦系数为 $c_f = \\tau_w / \\left(0.5 \\, \\rho \\, U_{\\text{ref}}^2\\right)$。\n- 在 LES Smagorinsky 闭合模型中，湍流涡粘度为 $\\nu_t = \\left(C_s \\, \\Delta\\right)^2 \\, \\left|S\\right|$，其中 $C_s$ 是 Smagorinsky 常数，$\\Delta$ 是滤波宽度，$\\left|S\\right|$ 是特征解析应变率大小。在这个简化的平衡壁面模型中，将第一个离壁位置的解析应变率估计值取为 $S_{\\mathrm{res}} \\approx U_1/\\Delta$，其中 $U_1$ 是在 $y_1$ 处的已知平均速度，$\\Delta$ 是提供的特征长度尺度。有效粘度为 $\\nu_{\\mathrm{eff}} = \\nu + \\nu_t$，其中 $\\nu$ 是分子运动粘度。使用 $\\tau_w^{\\mathrm{LES}} = \\rho \\, \\nu_{\\mathrm{eff}} \\, S_{\\mathrm{res}}$ 来计算 $u_\\tau^{\\mathrm{LES}}$、$U^{+,\\mathrm{LES}} = U_1/u_\\tau^{\\mathrm{LES}}$ 和 $c_f^{\\mathrm{LES}}$。\n- 在 RANS 壁面函数方法中，假设 $U^+ = U/u_\\tau$ 和 $y^+ = y u_\\tau/\\nu$，并且在对数区中 $U^+ = \\dfrac{1}{\\kappa} \\ln\\left(y^+\\right) + B$，其中 $\\kappa$ 是 von Kármán 常数，B 是一个加法常数。给定 $U_1$ 和 $y_1$，从 $U_1/u_\\tau = \\dfrac{1}{\\kappa} \\ln\\left(\\dfrac{y_1 \\, u_\\tau}{\\nu}\\right) + B$ 求解 $u_\\tau$。然后计算 $\\tau_w^{\\mathrm{RANS}} = \\rho \\, u_\\tau^2$、$U^{+,\\mathrm{RANS}} = U_1/u_\\tau$ 和 $c_f^{\\mathrm{RANS}} = \\tau_w^{\\mathrm{RANS}}/\\left(0.5 \\, \\rho \\, U_{\\text{ref}}^2\\right)$。\n\n推导起点：\n- 使用牛顿本构关系来表示带有有效粘度的剪切应力、代数 Smagorinsky 涡粘度闭合模型，以及用于 RANS 壁面函数的壁面律对数律。不要假设任何预设的摩擦速度；相反，应从给定的输入和模型方程中一致地确定它。\n\n数值任务：\n- 实现一个程序，为每个测试用例计算：\n  1. $u_\\tau^{\\mathrm{LES}}$，单位为 $\\mathrm{m/s}$。\n  2. $u_\\tau^{\\mathrm{RANS}}$，单位为 $\\mathrm{m/s}$。\n  3. $c_f^{\\mathrm{LES}}$，作为无量纲小数。\n  4. $c_f^{\\mathrm{RANS}}$，作为无量纲小数。\n  5. $U^{+,\\mathrm{LES}}$，作为无量纲小数。\n  6. $U^{+,\\mathrm{RANS}}$，作为无量纲小数。\n  7. 摩擦速度的相对差异，为 $(u_\\tau^{\\mathrm{LES}} - u_\\tau^{\\mathrm{RANS}})/u_\\tau^{\\mathrm{RANS}}$（无量纲小数）。\n  8. 表面摩擦系数的相对差异，为 $(c_f^{\\mathrm{LES}} - c_f^{\\mathrm{RANS}})/c_f^{\\mathrm{RANS}}$（无量纲小数）。\n  9. 无量纲速度的差异，为 $U^{+,\\mathrm{LES}} - U^{+,\\mathrm{RANS}}$（无量纲小数）。\n\n要求的物理单位：\n- 使用国际单位制 (SI)：$U$、$U_1$ 和 $u_\\tau$ 的单位为 $\\mathrm{m/s}$；$\\rho$ 的单位为 $\\mathrm{kg/m^3}$；$\\nu$ 的单位为 $\\mathrm{m^2/s}$；$y_1$ 和 $\\Delta$ 的单位为 $\\mathrm{m}$。表面摩擦系数 $c_f$ 是无量纲的。\n\n角度单位：\n- 不适用。\n\n百分比：\n- 将所有差异表示为小数，不使用百分号。\n\n测试套件：\n- 提供以下一组科学上合理的测试用例。每个测试用例指定为一个元组 $(\\rho, \\nu, U_{\\text{ref}}, y_1, U_1, \\Delta, C_s, \\kappa, B)$，所有量均采用上述单位。\n  - 用例 $1$（空气，中等对数区，较大的 $\\Delta$）：$(1.2, 1.5\\times10^{-5}, 10.0, 0.0010, 6.7800, 0.0040, 0.17, 0.41, 5.0)$。\n  - 用例 $2$（空气，接近过渡区的 $y^+$，中等的 $\\Delta$）：$(1.2, 1.5\\times10^{-5}, 7.0, 0.0002, 3.6328, 0.0020, 0.17, 0.41, 5.0)$。\n  - 用例 $3$（水，不同的 $\\rho$ 和 $\\nu$，中等的 $\\Delta$）：$(1000.0, 1.0\\times10^{-6}, 1.0, 0.0005, 0.6425, 0.0020, 0.12, 0.41, 5.2)$。\n  - 用例 $4$（空气，较小的 $\\Delta$ 和较大的 $C_s$）：$(1.2, 1.5\\times10^{-5}, 15.0, 0.0015, 8.9940, 0.0005, 0.20, 0.41, 4.9)$。\n\n算法要求：\n- 对于 LES Smagorinsky 壁面模型，计算 $S_{\\mathrm{res}} = U_1/\\Delta$、$\\nu_t = \\left(C_s \\, \\Delta\\right)^2 \\, S_{\\mathrm{res}}$、$\\nu_{\\mathrm{eff}} = \\nu + \\nu_t$ 和 $\\tau_w^{\\mathrm{LES}} = \\rho \\, \\nu_{\\mathrm{eff}} \\, S_{\\mathrm{res}}$。\n- 对于 RANS 壁面函数，使用鲁棒的求根方法求解非线性方程 $F(u_\\tau) = U_1/u_\\tau - \\dfrac{1}{\\kappa} \\ln\\left(\\dfrac{y_1 \\, u_\\tau}{\\nu}\\right) - B = 0$ 以得到 $u_\\tau  0$ 的解，该方法应保证对物理上合理的输入收敛。从得到的 $u_\\tau$ 计算 $\\tau_w^{\\mathrm{RANS}}$、$U^{+,\\mathrm{RANS}}$ 和 $c_f^{\\mathrm{RANS}}$。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含所有用例的结果，形式为包含在方括号中的逗号分隔列表。每个用例的结果必须是按上述顺序排列的 $9$ 个浮点数列表。例如，输出应类似于 $[ [r_{1,1}, r_{1,2}, \\dots, r_{1,9}], [r_{2,1}, \\dots, r_{2,9}], \\dots ]$，除了逗号和括号外，不需要空格。数值必须对应于指定的 SI 单位和适当的无量纲小数。",
            "solution": "问题陈述已经过仔细验证，并被确定为有效。它以计算流体动力学原理为科学基础，特别涉及壁面有界流中的湍流模拟。该问题是良态的、自洽的，并为计算唯一解提供了所有必要的数据和定义。物理参数和情景是现实的，数学任务被清晰地指定。\n\n解决方案分三部分展开：首先，是大涡模拟 (LES) 壁面模型的推导；其次，是雷诺平均纳维-斯托克斯 (RANS) 壁面函数的推导；第三，是比较指标的计算。\n\n### 1. LES Smagorinsky 壁面模型\n\n该模型为壁面剪切应力 $\\tau_w^{\\mathrm{LES}}$ 提供了一个基于简化平衡假设的代数闭合。\n\n问题指定使用 Smagorinsky 模型来计算湍流涡粘度 $\\nu_t$。有效运动粘度 $\\nu_{\\mathrm{eff}}$ 是分子运动粘度 $\\nu$ 和涡粘度 $\\nu_t$ 的和：\n$$ \\nu_{\\mathrm{eff}} = \\nu + \\nu_t $$\n涡粘度由 $\\nu_t = (C_s \\Delta)^2 |S|$ 给出，其中 $C_s$ 是 Smagorinsky 常数，$\\Delta$ 是滤波宽度，而 $|S|$ 是解析应变率张量的大小。对于这个简化的壁面模型，应变率大小在第一个离壁位置处近似为，使用距离 $y_1$ 处的平均速度 $U_1$ 和特征长度尺度 $\\Delta$：\n$$ S_{\\mathrm{res}} \\approx \\frac{U_1}{\\Delta} $$\n将此代入涡粘度公式，得到：\n$$ \\nu_t = (C_s \\Delta)^2 S_{\\mathrm{res}} = (C_s \\Delta)^2 \\left(\\frac{U_1}{\\Delta}\\right) = C_s^2 \\Delta U_1 $$\n然后，使用有效粘度和解析应变率计算壁面剪切应力 $\\tau_w^{\\mathrm{LES}}$：\n$$ \\tau_w^{\\mathrm{LES}} = \\rho \\nu_{\\mathrm{eff}} S_{\\mathrm{res}} = \\rho (\\nu + \\nu_t) S_{\\mathrm{res}} = \\rho (\\nu + C_s^2 \\Delta U_1) \\frac{U_1}{\\Delta} $$\n由壁面剪切应力，推导出摩擦速度 $u_\\tau^{\\mathrm{LES}}$：\n$$ u_\\tau^{\\mathrm{LES}} = \\sqrt{\\frac{\\tau_w^{\\mathrm{LES}}}{\\rho}} = \\sqrt{(\\nu + C_s^2 \\Delta U_1) \\frac{U_1}{\\Delta}} = \\sqrt{\\left(\\frac{\\nu}{\\Delta} + C_s^2 U_1\\right) U_1} $$\n参考速度为 $U_{\\text{ref}}$ 的表面摩擦系数 $c_f^{\\mathrm{LES}}$ 为：\n$$ c_f^{\\mathrm{LES}} = \\frac{\\tau_w^{\\mathrm{LES}}}{0.5 \\rho U_{\\text{ref}}^2} $$\n最后，无量纲速度 $U^{+, \\mathrm{LES}}$ 计算为壁面附近速度 $U_1$ 与摩擦速度之比：\n$$ U^{+, \\mathrm{LES}} = \\frac{U_1}{u_\\tau^{\\mathrm{LES}}} $$\n这些方程提供了一个直接的代数路径，可以从给定的输入计算所有与 LES 相关的量。\n\n### 2. RANS 壁面函数模型\n\n该模型使用广为接受的壁面律对数律来关联壁面附近速度与壁面剪切应力。\n\n壁面律用无量纲变量表示：无量纲速度 $U^+ = U/u_\\tau$ 和无量纲壁面距离 $y^+ = y u_\\tau / \\nu$。边界层的对数部分由以下公式描述：\n$$ U^+ = \\frac{1}{\\kappa} \\ln(y^+) + B $$\n其中 $\\kappa$ 是 von Kármán 常数，B 是一个加法常数。\n\n给定距离壁面 $y_1$ 处的速度 $U_1$，我们可以用这些已知量和未知的摩擦速度 $u_\\tau$ 来写出方程：\n$$ \\frac{U_1}{u_\\tau} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 u_\\tau}{\\nu}\\right) + B $$\n这是一个关于 $u_\\tau$ 的超越方程。为了找到解（我们将其表示为 $u_\\tau^{\\mathrm{RANS}}$），我们必须找到函数 $F(u_\\tau)$ 的根：\n$$ F(u_\\tau) = \\frac{U_1}{u_\\tau} - \\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 u_\\tau}{\\nu}\\right) - B = 0 $$\n该方程需要数值求解。为确保存在唯一解，我们分析函数 $F(u_\\tau)$ 在具有物理意义的值 $u_\\tau  0$ 上的性质。其导数为：\n$$ F'(u_\\tau) = -\\frac{U_1}{u_\\tau^2} - \\frac{1}{\\kappa u_\\tau} $$\n由于 $U_1, \\kappa,$ 和 $u_\\tau$ 都是正数，所以 $F'(u_\\tau)$ 总是负的。这意味着 $F(u_\\tau)$ 是一个单调递减函数。当 $u_\\tau \\to 0^+$ 时，$U_1/u_\\tau \\to +\\infty$ 且 $\\ln(y_1 u_\\tau / \\nu) \\to -\\infty$，因此 $F(u_\\tau) \\to +\\infty$。当 $u_\\tau \\to \\infty$ 时，$U_1/u_\\tau \\to 0$ 且 $\\ln(y_1 u_\\tau / \\nu) \\to +\\infty$，因此 $F(u_\\tau) \\to -\\infty$。一个从 $+\\infty$ 到 $-\\infty$ 的连续单调函数保证在 $u_\\tau  0$ 时有且仅有一个根。可以通过选择一个区间 $[u_{\\tau, \\text{low}}, u_{\\tau, \\text{high}}]$（其中 $F(u_{\\tau, \\text{low}}) > 0$ 且 $F(u_{\\tau, \\text{high}})  0$）来采用鲁棒的数值求根算法，例如 Brent 方法。一个合适的区间是 $[10^{-6}, U_1]$。\n\n一旦求得 $u_\\tau^{\\mathrm{RANS}}$，其他 RANS 相关的量计算如下：\n$$ \\tau_w^{\\mathrm{RANS}} = \\rho (u_\\tau^{\\mathrm{RANS}})^2 $$\n$$ c_f^{\\mathrm{RANS}} = \\frac{\\tau_w^{\\mathrm{RANS}}}{0.5 \\rho U_{\\text{ref}}^2} = \\frac{2 (u_\\tau^{\\mathrm{RANS}})^2}{U_{\\text{ref}}^2} $$\n$$ U^{+, \\mathrm{RANS}} = \\frac{U_1}{u_\\tau^{\\mathrm{RANS}}} $$\n\n### 3. 比较指标\n\n计算出两种模型的值后，最后一步是计算指定的比较指标：\n- 摩擦速度的相对差异：\n$$ \\Delta u_\\tau^{\\mathrm{rel}} = \\frac{u_\\tau^{\\mathrm{LES}} - u_\\tau^{\\mathrm{RANS}}}{u_\\tau^{\\mathrm{RANS}}} $$\n- 表面摩擦系数的相对差异：\n$$ \\Delta c_f^{\\mathrm{rel}} = \\frac{c_f^{\\mathrm{LES}} - c_f^{\\mathrm{RANS}}}{c_f^{\\mathrm{RANS}}} $$\n- 无量纲速度的差异：\n$$ \\Delta U^+ = U^{+, \\mathrm{LES}} - U^{+, \\mathrm{RANS}} $$\n\n总体算法是遍历每个测试用例，对 LES 模型应用直接计算，对 RANS 模型执行数值求根和后续计算，最后计算三个比较指标。然后收集每个用例的九个结果值，并按规定格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the fluid dynamics problem for a suite of test cases, comparing\n    LES and RANS wall models.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (rho, nu, U_ref, y1, U1, Delta, Cs, kappa, B)\n    test_cases = [\n        # Case 1 (air, moderate logarithmic region, larger Delta)\n        (1.2, 1.5e-5, 10.0, 0.0010, 6.7800, 0.0040, 0.17, 0.41, 5.0),\n        # Case 2 (air, near transitional y+, moderate Delta)\n        (1.2, 1.5e-5, 7.0, 0.0002, 3.6328, 0.0020, 0.17, 0.41, 5.0),\n        # Case 3 (water, different rho and nu, moderate Delta)\n        (1000.0, 1.0e-6, 1.0, 0.0005, 0.6425, 0.0020, 0.12, 0.41, 5.2),\n        # Case 4 (air, small Delta and larger Cs)\n        (1.2, 1.5e-5, 15.0, 0.0015, 8.9940, 0.0005, 0.20, 0.41, 4.9),\n    ]\n\n    results = []\n    for case in test_cases:\n        results.append(calculate_metrics_for_case(case))\n\n    # Custom formatting to produce output without spaces, e.g., [[1.0,2.0],[3.0,4.0]]\n    formatted_results = [f\"[{','.join(map(str, r))}]\" for r in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\ndef calculate_metrics_for_case(case_params):\n    \"\"\"\n    Calculates the 9 specified metrics for a single test case.\n    \"\"\"\n    rho, nu, U_ref, y1, U1, Delta, Cs, kappa, B = case_params\n\n    # ===== LES Smagorinsky Wall-Model Calculation =====\n    # Strain rate S_res = U1 / Delta\n    # Eddy viscosity nu_t = (Cs * Delta)^2 * S_res = Cs^2 * Delta * U1\n    # Effective viscosity nu_eff = nu + nu_t\n    # Wall shear stress tau_w_les = rho * nu_eff * S_res\n    # tau_w_les = rho * (nu + Cs^2 * Delta * U1) * (U1 / Delta)\n    tau_w_les = rho * (nu + Cs**2 * Delta * U1) * (U1 / Delta)\n    \n    # Friction velocity u_tau_les = sqrt(tau_w_les / rho)\n    u_tau_les = np.sqrt(tau_w_les / rho)\n    \n    # Skin friction coefficient c_f_les = tau_w_les / (0.5 * rho * U_ref^2)\n    c_f_les = tau_w_les / (0.5 * rho * U_ref**2)\n    \n    # Normalized velocity U_plus_les = U1 / u_tau_les\n    U_plus_les = U1 / u_tau_les\n    \n    # ===== RANS Wall Function Model Calculation =====\n    # Define the nonlinear function F(u_tau) = 0 to be solved for u_tau.\n    # U1/u_tau = (1/kappa) * ln(y1 * u_tau / nu) + B\n    # F(u_tau) = U1/u_tau - (1/kappa) * ln(y1*u_tau/nu) - B\n    def rans_func(u_tau):\n        # The argument of ln must be positive\n        if u_tau = 0:\n            return np.inf\n        return (U1 / u_tau) - (1 / kappa) * np.log(y1 * u_tau / nu) - B\n\n    # Solve for u_tau_rans using Brent's method, a robust root-finder.\n    # A safe bracket is [tiny_positive_number, U1]. F(tiny) > 0 and F(U1) is likely  0.\n    u_tau_rans_lower_bound = 1e-6\n    u_tau_rans_upper_bound = U1 \n    \n    u_tau_rans = brentq(rans_func, u_tau_rans_lower_bound, u_tau_rans_upper_bound)\n    \n    # Wall shear stress tau_w_rans = rho * u_tau_rans^2\n    tau_w_rans = rho * u_tau_rans**2\n    \n    # Skin friction coefficient c_f_rans = tau_w_rans / (0.5 * rho * U_ref^2)\n    c_f_rans = tau_w_rans / (0.5 * rho * U_ref**2)\n    \n    # Normalized velocity U_plus_rans = U1 / u_tau_rans\n    U_plus_rans = U1 / u_tau_rans\n\n    # ===== Comparison Metrics =====\n    # Relative difference in friction velocity\n    rel_diff_u_tau = (u_tau_les - u_tau_rans) / u_tau_rans\n    \n    # Relative difference in skin friction coefficient\n    rel_diff_c_f = (c_f_les - c_f_rans) / c_f_rans\n    \n    # Difference in normalized velocity\n    diff_U_plus = U_plus_les - U_plus_rans\n\n    return [\n        u_tau_les, u_tau_rans,\n        c_f_les, c_f_rans,\n        U_plus_les, U_plus_rans,\n        rel_diff_u_tau,\n        rel_diff_c_f,\n        diff_U_plus\n    ]\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}