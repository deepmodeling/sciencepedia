{
    "hands_on_practices": [
        {
            "introduction": "优秀的湍流模型并非凭空构建，其核心参数的确定往往根植于对流动物理的深刻理解。本练习旨在揭示Spalart-Allmaras模型常数与壁面律之间深刻的内在联系。通过  的推导，您将亲手验证模型如何通过校准其关键系数，来确保其在对数律区域的物理一致性，从而深入理解模型设计的精髓。",
            "id": "3977011",
            "problem": "在用于不可压缩湍流的Spalart–Allmaras (SA) 原始单方程模型中，工作变量$\\tilde{\\nu}$的输运方程模型包含一个与平均剪切成正比的产生项，一个与$(\\tilde{\\nu}/d)^2$成正比的耗散项，以及一个由$(\\nu+\\tilde{\\nu})\\nabla\\tilde{\\nu}$和$|\\nabla\\tilde{\\nu}|^2$构成的扩散项。考虑一个在平衡对数区内的稳定、零压力梯度的湍流边界层，其中平均速度梯度遵循对数律，壁面距离度量满足$d=y$，并且高雷诺数极限$f_{v1}\\to 1$和$f_{w}\\to 1$适用。使用摩擦速度$u_{\\tau}$的定义和对数律剪切$S=dU/dy=u_{\\tau}/(\\kappa y)$，在该区域中强制使产生、耗散和扩散项之间达到平衡，以推导出$c_{w1}$的一个表达式，该表达式用常数$\\kappa$、$\\sigma$、$c_{b1}$和$c_{b2}$表示，并使SA模型与对数律渐近一致。\n\n然后，陈述在原始SA公式中使用的常数$(\\kappa,\\sigma,c_{b1},c_{b2},c_{v1},c_{w2},c_{w3})$的标准值，并最终使用$\\kappa=0.41$，$\\sigma=2/3$，$c_{b1}=0.1355$和$c_{b2}=0.622$计算你推导出的$c_{w1}$。将你得到的$c_{w1}$的最终数值结果四舍五入到$4$位有效数字。将最终答案表示为一个无单位的无量纲数。",
            "solution": "首先验证问题，以确保其具有科学依据、是适定的，并且包含了所有必要的信息。\n\n### 第1步：提取已知条件\n- **模型**: 原始Spalart–Allmaras (SA) 不可压缩湍流单方程模型。\n- **工作变量**: $\\tilde{\\nu}$。\n- **方程项**:\n    - 产生项: 与平均剪切成正比。\n    - 耗散项: 与$(\\tilde{\\nu}/d)^2$成正比。\n    - 扩散项: 由$(\\nu+\\tilde{\\nu})\\nabla\\tilde{\\nu}$和$|\\nabla\\tilde{\\nu}|^2$构成。\n- **流动条件**: 稳定、零压力梯度的湍流边界层。\n- **关注区域**: 平衡对数区。\n- **此区域中的假设**:\n    - 平均速度梯度 (对数律): $S = dU/dy = u_{\\tau}/(\\kappa y)$。\n    - 壁面距离度量: $d=y$。\n    - 高雷诺数极限适用: $f_{v1} \\to 1$, $f_{w} \\to 1$。\n- **用于推导的常数**: $\\kappa$, $\\sigma$, $c_{b1}$, $c_{b2}$。\n- **用于计算的常数**:\n    - $\\kappa = 0.41$\n    - $\\sigma = 2/3$\n    - $c_{b1} = 0.1355$\n    - $c_{b2} = 0.622$\n- **要求输出**:\n    1. 用$\\kappa$, $\\sigma$, $c_{b1}$和$c_{b2}$表示的$c_{w1}$的表达式。\n    2. 常数$(\\kappa, \\sigma, c_{b1}, c_{b2}, c_{v1}, c_{w2}, c_{w3})$的标准值。\n    3. $c_{w1}$的数值，四舍五入到4位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是一个标准的推导过程，用于确保Spalart–Allmaras湍流模型与壁面律（湍流理论中的一个基本概念）的一致性。它在流体动力学和计算流体动力学（CFD）方面具有科学依据。该问题是适定的，具有足够的信息和明确的约束条件来推导出常数$c_{w1}$的唯一表达式。语言客观而精确。该问题被认为是有效的。\n\n### 第3步：结论与行动\n问题有效。将继续进行求解。\n\nSpalart–Allmaras模型中工作变量$\\tilde{\\nu}$的输运方程可以写为：\n$$\n\\frac{D\\tilde{\\nu}}{Dt} = c_{b1} \\tilde{S} \\tilde{\\nu} - c_{w1} f_w \\left(\\frac{\\tilde{\\nu}}{d}\\right)^2 + \\frac{1}{\\sigma} \\left[ \\nabla \\cdot ((\\nu+\\tilde{\\nu})\\nabla\\tilde{\\nu}) + c_{b2} |\\nabla\\tilde{\\nu}|^2 \\right]\n$$\n其中$\\frac{D\\tilde{\\nu}}{Dt}$是物质导数，右侧第一项是产生项，第二项是耗散项，第三项是扩散项。\n\n我们在零压力梯度的平板上的稳定二维湍流边界层中分析此方程。对于这种流动，物质导数得以简化。在边界层的平衡部分，当用局部变量进行标度时，湍流状态是自相似的，并且平流项$\\vec{u} \\cdot \\nabla\\tilde{\\nu}$与源项和汇项相比可以忽略不计。因此，假设存在局部平衡，这意味着$\\frac{D\\tilde{\\nu}}{Dt} \\approx 0$。\n\n问题陈述我们处于对数区，其中高雷诺数条件适用。简化如下：\n1.  **壁面距离**: $d = y$。\n2.  **模型函数**: $f_w \\to 1$。此外，在对数层中，湍流粘性$\\nu_t$由$\\nu_t = \\tilde{\\nu}f_{v1}$给出。由于$f_{v1} \\to 1$，我们有$\\nu_t = \\tilde{\\nu}$。\n3.  **产生变量$\\tilde{S}$**: $\\tilde{S}$与涡量大小$S$有关。在对数层中，我们可以近似认为$\\tilde{S} \\approx S$。对于二维边界层，$S = |\\frac{\\partial U}{\\partial y}| = \\frac{dU}{dy}$。问题中给出$S = \\frac{u_{\\tau}}{\\kappa y}$。\n4.  **粘性**: 湍流粘性$\\nu_t$远大于分子粘性$\\nu$，所以$\\nu+\\tilde{\\nu} \\approx \\tilde{\\nu}$。\n\n基于这些假设，一维边界层（仅在$y$方向有变化）中$\\tilde{\\nu}$的输运方程变为：\n$$\n0 \\approx c_{b1} S \\tilde{\\nu} - c_{w1} \\left(\\frac{\\tilde{\\nu}}{y}\\right)^2 + \\frac{1}{\\sigma} \\left[ \\frac{d}{dy}\\left(\\tilde{\\nu}\\frac{d\\tilde{\\nu}}{dy}\\right) + c_{b2} \\left(\\frac{d\\tilde{\\nu}}{dy}\\right)^2 \\right]\n$$\n我们展开扩散项$\\frac{d}{dy}(\\tilde{\\nu}\\frac{d\\tilde{\\nu}}{dy}) = \\tilde{\\nu}\\frac{d^2\\tilde{\\nu}}{dy^2} + (\\frac{d\\tilde{\\nu}}{dy})^2$。方程现在是：\n$$\n0 \\approx c_{b1} S \\tilde{\\nu} - c_{w1} \\frac{\\tilde{\\nu}^2}{y^2} + \\frac{1}{\\sigma} \\left[ \\tilde{\\nu}\\frac{d^2\\tilde{\\nu}}{dy^2} + (1+c_{b2}) \\left(\\frac{d\\tilde{\\nu}}{dy}\\right)^2 \\right]\n$$\n为使模型与壁面律的对数律部分一致，该区域的涡粘性分布必须是$\\nu_t = \\kappa u_{\\tau} y$。由于在高雷诺数极限下$\\nu_t = \\tilde{\\nu}$，我们必须强制要求：\n$$\n\\tilde{\\nu} = \\kappa u_{\\tau} y\n$$\n我们计算该表达式关于$y$的导数：\n$$\n\\frac{d\\tilde{\\nu}}{dy} = \\kappa u_{\\tau}\n$$\n$$\n\\frac{d^2\\tilde{\\nu}}{dy^2} = 0\n$$\n现在我们将这些表达式，连同$S = u_{\\tau}/(\\kappa y)$，代入简化的输运方程：\n$$\n0 = c_{b1} \\left(\\frac{u_{\\tau}}{\\kappa y}\\right) (\\kappa u_{\\tau} y) - c_{w1} \\frac{(\\kappa u_{\\tau} y)^2}{y^2} + \\frac{1}{\\sigma} \\left[ (\\kappa u_{\\tau} y)(0) + (1+c_{b2}) (\\kappa u_{\\tau})^2 \\right]\n$$\n简化各项：\n$$\n0 = c_{b1} u_{\\tau}^2 - c_{w1} \\frac{\\kappa^2 u_{\\tau}^2 y^2}{y^2} + \\frac{1}{\\sigma} (1+c_{b2}) \\kappa^2 u_{\\tau}^2\n$$\n$$\n0 = c_{b1} u_{\\tau}^2 - c_{w1} \\kappa^2 u_{\\tau}^2 + \\frac{\\kappa^2 (1+c_{b2})}{\\sigma} u_{\\tau}^2\n$$\n由于$u_{\\tau} \\neq 0$，我们可以将整个方程除以$u_{\\tau}^2$：\n$$\n0 = c_{b1} - c_{w1} \\kappa^2 + \\frac{\\kappa^2 (1+c_{b2})}{\\sigma}\n$$\n求解$c_{w1}$：\n$$\nc_{w1} \\kappa^2 = c_{b1} + \\frac{\\kappa^2 (1+c_{b2})}{\\sigma}\n$$\n$$\nc_{w1} = \\frac{c_{b1}}{\\kappa^2} + \\frac{1+c_{b2}}{\\sigma}\n$$\n这就是推导出的$c_{w1}$的表达式，它确保了与壁面律的对数律部分的一致性。\n\n问题接着要求给出原始SA模型中常数的标准值。这些值是根据经验确定的，如下所示：\n- $\\kappa = 0.41$\n- $\\sigma = 2/3$\n- $c_{b1} = 0.1355$\n- $c_{b2} = 0.622$\n- $c_{v1} = 7.1$\n- $c_{w2} = 0.3$\n- $c_{w3} = 2.0$\n\n最后，我们使用给定的值$\\kappa=0.41$，$\\sigma=2/3$，$c_{b1}=0.1355$和$c_{b2}=0.622$来计算$c_{w1}$。\n$$\nc_{w1} = \\frac{0.1355}{(0.41)^2} + \\frac{1+0.622}{2/3}\n$$\n$$\nc_{w1} = \\frac{0.1355}{0.1681} + \\frac{1.622}{2/3}\n$$\n$$\nc_{w1} = 0.80606781677... + 1.622 \\times \\frac{3}{2}\n$$\n$$\nc_{w1} = 0.80606781677... + 2.433\n$$\n$$\nc_{w1} = 3.23906781677...\n$$\n将结果四舍五入到4位有效数字，我们得到$3.239$。",
            "answer": "$$\n\\boxed{3.239}\n$$"
        },
        {
            "introduction": "从理论到应用，将物理概念转化为具体的数值模拟设置是计算工程师的核心技能。本练习  聚焦于壁面解析模拟中至关重要的一步：近壁面网格划分。通过计算确保第一层网格高度满足 $y^{+} \\approx 1$ 的要求，您将掌握在实际CFD工作中如何根据流动条件精确设置网格，以保证对近壁区物理现象的准确捕捉。",
            "id": "3982279",
            "problem": "需要在计算流体力学 (CFD) 中，使用Spalart–Allmaras (SA) 单方程湍流模型对一个处于海平面条件下的光滑翼型截面进行一次外部空气动力学模拟。为确保低雷诺数壁面积分的保真度，第一个离壁单元的高度必须设置得使无量纲壁面距离满足 $y^+ \\approx 1$。假设流动为不可压缩流，并使用光滑壁面的标准壁面摩擦系数定义。\n\n在机翼上的某一特定位置，给定以下数据：\n- 自由来流速度 $U_{\\infty} = 70 \\ \\mathrm{m/s}$。\n- 壁面摩擦系数 $C_{f} = 0.0035$，其定义为 $C_{f} = \\dfrac{\\tau_{w}}{\\frac{1}{2} \\rho U_{\\infty}^{2}}$，其中 $\\tau_{w}$ 是壁面剪切应力。\n- 空气密度 $\\rho = 1.225 \\ \\mathrm{kg/m^{3}}$。\n- 动力粘度 $\\mu = 1.7894 \\times 10^{-5} \\ \\mathrm{kg/(m \\cdot s)}$。\n\n使用摩擦速度的定义和基于运动粘度 $\\nu = \\mu / \\rho$ 的无量纲壁面距离 $y^{+}$，确定所需的第一个单元高度 $\\Delta y$，以使壁面处的 $y^+=1$。以微米为单位表示最终答案，并四舍五入到三位有效数字。",
            "solution": "对问题陈述的有效性进行审查，发现其科学基础扎实、提法恰当、客观且完整。所有提供的数据和定义均符合流体力学和计算流体动力学 (CFD) 的既定原理。海平面空气属性值、自由来流速度和壁面摩擦系数值在物理上是合理的。该任务要求在CFD中为近壁区域的网格生成进行标准计算。因此，该问题是有效的，并将推导求解。\n\n目标是确定所需的第一个离壁单元高度，记为 $\\Delta y$，以使无量纲壁面距离 $y^{+}$ 等于 $1$。在壁面解析模拟的CFD实践中，从壁面到第一个单元中心的距离被设为第一个单元的高度，因此我们取 $y = \\Delta y$。\n\n无量纲壁面距离 $y^{+}$ 定义为：\n$$y^{+} = \\frac{y u_{\\tau}}{\\nu}$$\n其中 $y$ 是离壁的物理距离，$u_{\\tau}$ 是摩擦速度，$\\nu$ 是流体的运动粘度。\n\n根据要求，第一个单元的 $y^{+} = 1$，其中心距壁面距离为 $y = \\Delta y$，我们可以写出：\n$$1 = \\frac{\\Delta y \\cdot u_{\\tau}}{\\nu}$$\n解出第一个单元高度 $\\Delta y$：\n$$\\Delta y = \\frac{\\nu}{u_{\\tau}}$$\n为了求得 $\\Delta y$，我们必须首先根据给定数据确定运动粘度 $\\nu$ 和摩擦速度 $u_{\\tau}$ 的值。\n\n运动粘度 $\\nu$ 定义为动力粘度 $\\mu$ 与密度 $\\rho$ 的比值：\n$$\\nu = \\frac{\\mu}{\\rho}$$\n摩擦速度 $u_{\\tau}$ 由壁面剪切应力 $\\tau_{w}$ 和流体密度 $\\rho$ 定义：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_{w}}{\\rho}}$$\n壁面剪切应力 $\\tau_{w}$ 没有直接给出，但可以从给定的壁面摩擦系数 $C_{f}$ 计算得出，其定义为：\n$$C_{f} = \\frac{\\tau_{w}}{\\frac{1}{2} \\rho U_{\\infty}^{2}}$$\n其中 $U_{\\infty}$ 是自由来流速度。我们可以重新整理这个方程来解出 $\\tau_{w}$：\n$$\\tau_{w} = C_{f} \\cdot \\frac{1}{2} \\rho U_{\\infty}^{2}$$\n现在，我们可以将 $\\tau_{w}$ 的这个表达式代入摩擦速度 $u_{\\tau}$ 的方程中：\n$$u_{\\tau} = \\sqrt{\\frac{C_{f} \\cdot \\frac{1}{2} \\rho U_{\\infty}^{2}}{\\rho}} = \\sqrt{\\frac{1}{2} C_{f} U_{\\infty}^{2}} = U_{\\infty} \\sqrt{\\frac{C_{f}}{2}}$$\n有了 $u_{\\tau}$ 的这个表达式，我们现在可以写出 $\\Delta y$ 的完整符号表达式：\n$$\\Delta y = \\frac{\\nu}{u_{\\tau}} = \\frac{\\mu/\\rho}{U_{\\infty} \\sqrt{C_{f}/2}} = \\frac{\\mu}{\\rho U_{\\infty} \\sqrt{\\frac{C_{f}}{2}}}$$\n现在我们将给定的数值代入这个表达式：\n- 自由来流速度：$U_{\\infty} = 70 \\ \\mathrm{m/s}$\n- 壁面摩擦系数：$C_{f} = 0.0035$\n- 空气密度：$\\rho = 1.225 \\ \\mathrm{kg/m^{3}}$\n- 动力粘度：$\\mu = 1.7894 \\times 10^{-5} \\ \\mathrm{kg/(m \\cdot s)}$\n\n首先，我们计算摩擦速度 $u_{\\tau}$：\n$$u_{\\tau} = 70 \\ \\mathrm{m/s} \\times \\sqrt{\\frac{0.0035}{2}} = 70 \\times \\sqrt{0.00175} \\approx 70 \\times 0.041833 \\ \\mathrm{m/s} \\approx 2.92831 \\ \\mathrm{m/s}$$\n接下来，我们计算运动粘度 $\\nu$：\n$$\\nu = \\frac{1.7894 \\times 10^{-5} \\ \\mathrm{kg/(m \\cdot s)}}{1.225 \\ \\mathrm{kg/m^{3}}} \\approx 1.46073 \\times 10^{-5} \\ \\mathrm{m^2/s}$$\n最后，我们计算第一个单元高度 $\\Delta y$：\n$$\\Delta y = \\frac{\\nu}{u_{\\tau}} \\approx \\frac{1.46073 \\times 10^{-5} \\ \\mathrm{m^2/s}}{2.92831 \\ \\mathrm{m/s}} \\approx 4.9884 \\times 10^{-6} \\ \\mathrm{m}$$\n题目要求答案以微米（$\\mu\\mathrm{m}$）表示，并四舍五入到三位有效数字。\n$1 \\ \\mathrm{m} = 10^{6} \\ \\mu\\mathrm{m}$，因此：\n$$\\Delta y \\approx 4.9884 \\times 10^{-6} \\ \\mathrm{m} \\times \\frac{10^{6} \\ \\mu\\mathrm{m}}{1 \\ \\mathrm{m}} = 4.9884 \\ \\mu\\mathrm{m}$$\n四舍五入到三位有效数字，我们得到：\n$$\\Delta y \\approx 4.99 \\ \\mu\\mathrm{m}$$",
            "answer": "$$\\boxed{4.99}$$"
        },
        {
            "introduction": "深入CFD求解器的核心，理解湍流模型在数值离散化中的实现方式，是高级计算工程师和研究人员的必备技能。本练习  引导您处理Spalart-Allmaras模型在隐式求解器中的一个关键环节：源项的线性化。通过推导和编程实现源项对求解变量的偏导数（即雅可比矩阵项），您将深刻理解保证数值计算稳定收敛的底层机制，这对于开发和优化CFD代码至关重要。",
            "id": "3976986",
            "problem": "考虑湍流的雷诺平均纳维-斯托克斯 (RANS) 模拟，其中 Spalart–Allmaras 单方程模型引入了一个输运工作变量，即修正湍流运动黏度 $\\tilde{\\nu}$，单位为 $\\mathrm{m}^2/\\mathrm{s}$。在一个用于求解 $\\tilde{\\nu}$ 输运方程的隐式有限体积求解器中，一个控制体上的半离散残差包括产生和耗散源项。为了实现鲁棒收敛，必须通过对产生和耗散贡献相对于未知数进行线性化来组装与源项相关的雅可比矩阵项。\n\n从 Spalart–Allmaras 模型的基础定义和经过充分检验的公式（不含转捩触发项）出发，使用以下基本事实：\n\n- 产生项被建模为 $P = c_{b1}\\,\\tilde{S}\\,\\tilde{\\nu}$，其中 $\\tilde{S}$ 是一个修正的涡量大小，它通过壁面距离效应对给定的平均剪切速率大小 $S$ 进行了增广。\n- 耗散项被建模为 $D = c_{w1}\\,f_w\\,\\left(\\dfrac{\\tilde{\\nu}}{d}\\right)^2$，其中 $d$ 是法向壁面距离，$f_w$ 是一个阻尼函数。\n\n增广量级 $\\tilde{S}$ 和辅助函数的定义如下：\n- $\\chi = \\dfrac{\\tilde{\\nu}}{\\nu}$，其中 $\\nu$ 是分子运动黏度（假定已知且均匀）。\n- $f_{v1}(\\chi) = \\dfrac{\\chi^3}{\\chi^3 + c_{v1}^3}$。\n- $f_{v2}(\\chi) = 1 - \\dfrac{\\chi}{1 + \\chi f_{v1}(\\chi)}$。\n- $\\tilde{S} = S + \\dfrac{\\tilde{\\nu}_\\mathrm{avg}}{\\kappa^2 d^2}\\,f_{v2}(\\chi_\\mathrm{avg})$，其中 $\\tilde{\\nu}_\\mathrm{avg} = \\dfrac{\\tilde{\\nu}_i + \\tilde{\\nu}_n}{2}$ 和 $\\chi_\\mathrm{avg} = \\dfrac{\\tilde{\\nu}_\\mathrm{avg}}{\\nu}$ 来自于控制体 $i$ 和一个相邻控制体 $n$ 之间的线性插值，以引入非对角源项耦合。\n- 阻尼函数使用 $r = \\dfrac{\\tilde{\\nu}_i}{\\tilde{S}\\,\\kappa^2 d^2}$、$g = r + c_{w2}\\,(r^6 - r)$ 和 $f_w = g\\,\\left(\\dfrac{1 + c_{w3}^6}{g^6 + c_{w3}^6}\\right)^{1/6}$。\n- 系数 $c_{w1}$ 由 $c_{w1} = \\dfrac{c_{b1}}{\\kappa^2} + \\dfrac{1 + c_{b2}}{\\sigma}$ 给出。\n\n此问题的常数为：\n- $c_{b1} = 0.1355$, $c_{b2} = 0.622$, $\\sigma = \\dfrac{2}{3}$, $\\kappa = 0.41$, $c_{v1} = 7.1$, $c_{w2} = 0.3$, $c_{w3} = 2.0$。\n\n你需要：\n1. 通过一致地应用链式法则和乘法法则，推导源项 $P - D$ 相对于局部未知数 $\\tilde{\\nu}_i$ 和通过面平均值 $\\tilde{\\nu}_\\mathrm{avg}$ 出现在 $\\tilde{S}$ 中以及 $r$ 对 $\\tilde{S}$ 依赖的单个邻居 $\\tilde{\\nu}_n$ 的线性化。具体来说，使用上述定义，为一个控制体 $i$ 推导出偏导数 $\\dfrac{\\partial P}{\\partial \\tilde{\\nu}_i}$、$\\dfrac{\\partial P}{\\partial \\tilde{\\nu}_n}$、$\\dfrac{\\partial D}{\\partial \\tilde{\\nu}_i}$ 和 $\\dfrac{\\partial D}{\\partial \\tilde{\\nu}_n}$ 的解析表达式。\n2. 对于一维网格的每个控制体 $i$，组装对角雅可比贡献 $J_{ii} = \\dfrac{\\partial P}{\\partial \\tilde{\\nu}_i} - \\dfrac{\\partial D}{\\partial \\tilde{\\nu}_i}$ 和非对角贡献 $J_{in} = \\dfrac{\\partial P}{\\partial \\tilde{\\nu}_n} - \\dfrac{\\partial D}{\\partial \\tilde{\\nu}_n}$。\n3. 在一个程序中实现你推导的公式，并为以下测试套件评估雅可比贡献。使用选择邻居索引 $n$ 的规则：如果 $i  N-1$，则 $n=i+1$，否则 $n=i-1$，其中 $N$ 是测试案例中控制体的数量。所有量均采用国际单位制 (SI)。雅可比矩阵项 $J_{ii}$ 和 $J_{in}$ 必须以 $\\mathrm{s}^{-1}$ 为单位报告。\n\n测试套件参数集：\n- 测试用例 1 (正常路径):\n  - $N = 3$\n  - $d = [10^{-3}, 10^{-2}, 10^{-1}]\\,\\mathrm{m}$\n  - $S = [1000, 300, 50]\\,\\mathrm{s}^{-1}$\n  - $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$\n  - $\\tilde{\\nu} = [10^{-5}, 5\\times 10^{-5}, 10^{-6}]\\,\\mathrm{m}^2/\\mathrm{s}$\n- 测试用例 2 (近壁面更强剪切):\n  - $N = 2$\n  - $d = [5\\times 10^{-4}, 2\\times 10^{-3}]\\,\\mathrm{m}$\n  - $S = [2000, 500]\\,\\mathrm{s}^{-1}$\n  - $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$\n  - $\\tilde{\\nu} = [2\\times 10^{-6}, 3\\times 10^{-5}]\\,\\mathrm{m}^2/\\mathrm{s}$\n- 测试用例 3 (弱剪切，较大壁面距离):\n  - $N = 2$\n  - $d = [5\\times 10^{-2}, 5\\times 10^{-2}]\\,\\mathrm{m}$\n  - $S = [10, 10]\\,\\mathrm{s}^{-1}$\n  - $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$\n  - $\\tilde{\\nu} = [10^{-8}, 2\\times 10^{-8}]\\,\\mathrm{m}^2/\\mathrm{s}$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是一个在控制体上遍历的逗号分隔列表，列表中的元素是表示为 $[J_{ii}, J_{in}]$（单位为 $\\mathrm{s}^{-1}$）的二元列表。例如，输出格式为 `[[[J_{11},J_{1n}],[J_{22},J_{2n}],...],[[...]],[[...]]]`，行内不含任何空格。",
            "solution": "用户希望我扮演一名 STEM 教授，解决一个与 Spalart-Allmaras 湍流模型相关的计算热工问题。\n\n该任务有两个方面：\n1.  验证问题陈述：检查其科学合理性、适定性、完整性等。\n2.  解决问题：如果问题有效，推导 Spalart-Allmaras 输运方程源项的雅可比矩阵项，并实现一个 Python 程序来为给定的测试用例计算它们。\n\n让我们首先分解验证过程。\n\n### 第 1 步：提取已知条件\n\n-   **模型**：用于 RANS 的 Spalart-Allmaras 单方程湍流模型。\n-   **工作变量**：修正湍流运动黏度, $\\tilde{\\nu}$ ($\\mathrm{m}^2/\\mathrm{s}$)。\n-   **求解器类型**：隐式有限体积。\n-   **源项**：\n    -   产生项：$P = c_{b1}\\,\\tilde{S}\\,\\tilde{\\nu}_i$。问题陈述为 $\\tilde{\\nu}$，但由于我们是为控制体 $i$ 计算，它必须是 $\\tilde{\\nu}_i$。这是一个局部量。\n    -   耗散项：$D = c_{w1}\\,f_w\\,\\left(\\dfrac{\\tilde{\\nu}_i}{d_i}\\right)^2$。类似地，这适用于控制体 $i$，所以 $d$ 和 $\\tilde{\\nu}$ 必须是局部的。我将它们表示为 $d_i$ 和 $\\tilde{\\nu}_i$。\n-   **辅助定义**：\n    -   $\\chi = \\dfrac{\\tilde{\\nu}}{\\nu}$。对于局部量，这将是 $\\chi_i = \\tilde{\\nu}_i/\\nu$；对于平均量，则是 $\\chi_\\mathrm{avg}$。\n    -   $f_{v1}(\\chi) = \\dfrac{\\chi^3}{\\chi^3 + c_{v1}^3}$。\n    -   $f_{v2}(\\chi) = 1 - \\dfrac{\\chi}{1 + \\chi f_{v1}(\\chi)}$。\n    -   $\\tilde{S} = S_i + \\dfrac{\\tilde{\\nu}_\\mathrm{avg}}{\\kappa^2 d_i^2}\\,f_{v2}(\\chi_\\mathrm{avg})$。这里，$S_i$ 是局部平均剪切速率大小。问题中说的是 $S$，但它必须是局部的。\n    -   $\\tilde{\\nu}_\\mathrm{avg} = \\dfrac{\\tilde{\\nu}_i + \\tilde{\\nu}_n}{2}$。\n    -   $\\chi_\\mathrm{avg} = \\dfrac{\\tilde{\\nu}_\\mathrm{avg}}{\\nu}$。\n    -   $r = \\dfrac{\\tilde{\\nu}_i}{\\tilde{S}\\,\\kappa^2 d_i^2}$。\n    -   $g = r + c_{w2}\\,(r^6 - r)$。\n    -   $f_w = g\\,\\left(\\dfrac{1 + c_{w3}^6}{g^6 + c_{w3}^6}\\right)^{1/6}$。\n    -   $c_{w1} = \\dfrac{c_{b1}}{\\kappa^2} + \\dfrac{1 + c_{b2}}{\\sigma}$。\n-   **常数**：\n    -   $c_{b1} = 0.1355$\n    -   $c_{b2} = 0.622$\n    -   $\\sigma = \\dfrac{2}{3}$\n    -   $\\kappa = 0.41$\n    -   $c_{v1} = 7.1$\n    -   $c_{w2} = 0.3$\n    -   $c_{w3} = 2.0$\n-   **任务**：\n    1.  推导 $\\dfrac{\\partial P}{\\partial \\tilde{\\nu}_i}$、$\\dfrac{\\partial P}{\\partial \\tilde{\\nu}_n}$、$\\dfrac{\\partial D}{\\partial \\tilde{\\nu}_i}$ 和 $\\dfrac{\\partial D}{\\partial \\tilde{\\nu}_n}$ 的表达式。\n    2.  组装雅可比贡献：$J_{ii} = \\dfrac{\\partial P}{\\partial \\tilde{\\nu}_i} - \\dfrac{\\partial D}{\\partial \\tilde{\\nu}_i}$ 和 $J_{in} = \\dfrac{\\partial P}{\\partial \\tilde{\\nu}_n} - \\dfrac{\\partial D}{\\partial \\tilde{\\nu}_n}$。\n    3.  为 3 个测试用例实现并评估。\n-   **邻居规则**：对于大小为 $N$ 的一维网格中的索引 $i$，如果 $i  N-1$，邻居 $n$ 为 $i+1$，否则 $n=i-1$。这定义了一个单侧邻居模板，除了在末端。好的，这有点不寻常但定义明确。通常是 $i-1$ 和 $i+1$。这里说“通过面平均值 $\\tilde{\\nu}_{avg}$ 出现的单个邻居 $\\tilde{\\nu}_n$”。这意味着一个简化的设置，对于一个学术问题来说是可以的。给出的规则是明确的。\n-   **测试用例**：\n    -   **用例 1**：$N=3$, $d = [10^{-3}, 10^{-2}, 10^{-1}]$, $S = [1000, 300, 50]$, $\\nu = 1.5\\times 10^{-5}$, $\\tilde{\\nu} = [10^{-5}, 5\\times 10^{-5}, 10^{-6}]$。\n    -   **用例 2**：$N=2$, $d = [5\\times 10^{-4}, 2\\times 10^{-3}]$, $S = [2000, 500]$, $\\nu = 1.5\\times 10^{-5}$, $\\tilde{\\nu} = [2\\times 10^{-6}, 3\\times 10^{-5}]$。\n    -   **用例 3**：$N=2$, $d = [5\\times 10^{-2}, 5\\times 10^{-2}]$, $S = [10, 10]$, $\\nu = 1.5\\times 10^{-5}$, $\\tilde{\\nu} = [10^{-8}, 2\\times 10^{-8}]$。\n-   **输出格式**：`[[[J_{11},J_{1n}],[J_{22},J_{2n}],...],[[...]],[[...]]]`，无空格。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题涉及 Spalart-Allmaras 湍流模型，这是一个在 CFD 中非常著名且广泛使用的单方程模型。产生项、耗散项以及各种辅助函数（$f_{v1}, f_{v2}, f_w$ 等）的方程都是文献（例如 Spalart  Allmaras, 1992, 1994 的论文）中的标准形式。提供的常数是模型的标准值。在源项 $\\tilde{S}$ 中使用面平均黏度 $\\tilde{\\nu}_{\\mathrm{avg}}$ 是一种已知的数值技术，用于提高稳定性和耦合性，尽管具体形式可能有所不同。这是一个合理的简化。整体设置是科学合理的。\n-   **适定性**：任务是推导和计算偏导数。给定显式函数形式，这是一个标准的微积分练习。对于物理上预期的正值 $\\tilde{\\nu}$，这些函数看起来定义良好且可微。测试用例的值都是正数。问题是适定的。\n-   **客观性**：问题陈述具有明确的定义、数值和所需操作。没有主观或基于意见的陈述。语言精确且正式。\n-   **不完整或矛盾的设置**：问题是自洽的。所有必要的方程、常数和数据都已提供。邻居选择规则是明确的。没有明显的矛盾。问题陈述为 $P = c_{b1}\\,\\tilde{S}\\,\\tilde{\\nu}$ 和 $D = c_{w1}\\,f_w\\,\\left(\\dfrac{\\tilde{\\nu}}{d}\\right)^2$。从上下文中可以清楚地看出，这些是针对单元 $i$ 的，因此是 $P_i = c_{b1}\\tilde{S}_i\\tilde{\\nu}_i$ 和 $D_i = c_{w1}f_{w,i}(\\tilde{\\nu}_i/d_i)^2$。下标 $i$ 明确了局部性。变量 $\\tilde{S}$ 也是单元 $i$ 的局部变量，即 $\\tilde{S}_i=S_i + \\frac{\\tilde{\\nu}_{\\text{avg}}}{\\kappa^2 d_i^2} f_{v2}(\\chi_{\\text{avg}})$。这是一致的。项 $r$ 也是局部的，$r_i = \\frac{\\tilde{\\nu}_i}{\\tilde{S}_i \\kappa^2 d_i^2}$。一切看起来都一致。\n-   **不切实际或不可行**：测试用例中给出的值对于湍流边界层或剪切流是物理上现实的。壁面距离 ($d$) 的范围从非常小（黏性子层）到较大的值。剪切速率 ($S$) 是典型的。运动黏度 ($\\nu, \\tilde{\\nu}$) 在一个合理的范围内。没有量纲不一致的问题。问题是现实的。\n-   **不适定或结构不良**：推导过程直接，虽然冗长。函数已定义，任务是计算导数。存在唯一且有意义的解。没有循环论证。\n-   **故作高深、琐碎或同义反复**：问题复杂但并非人为设计。它需要对许多嵌套函数仔细应用链式法则。这是开发 CFD 代码中的一项真实任务。它并非琐碎。\n-   **超出科学可验证性**：结果可以通过独立的推导和计算来验证。问题是可验证的。\n\n**结论**：该问题有效。这是一个来自计算流体动力学的定义明确、科学合理的问题。我可以继续进行求解。\n\n### 第 3 步：行动\n\n问题是有效的。我将继续进行推导和实现。\n\n---\n\n### 雅可比矩阵项的推导\n\n这是问题的核心。我需要一丝不苟。让我们列出依赖关系。对于一个控制体 $i$ 及其邻居 $n$：\n- $\\tilde{\\nu}_\\mathrm{avg} = \\frac{1}{2}(\\tilde{\\nu}_i + \\tilde{\\nu}_n)$。\n- $\\chi_\\mathrm{avg} = \\frac{\\tilde{\\nu}_\\mathrm{avg}}{\\nu}$。\n- $f_{v1,\\mathrm{avg}} = f_{v1}(\\chi_\\mathrm{avg})$。\n- $f_{v2,\\mathrm{avg}} = f_{v2}(\\chi_\\mathrm{avg})$。\n- $\\tilde{S}_i = S_i + \\frac{\\tilde{\\nu}_\\mathrm{avg}}{\\kappa^2 d_i^2} f_{v2,\\mathrm{avg}}$。\n- $P_i = c_{b1} \\tilde{S}_i \\tilde{\\nu}_i$。\n- $r_i = \\frac{\\tilde{\\nu}_i}{\\tilde{S}_i \\kappa^2 d_i^2}$。\n- $g_i = g(r_i) = r_i + c_{w2}(r_i^6 - r_i)$。\n- $f_{w,i} = f_w(g_i) = g_i \\left( \\frac{1 + c_{w3}^6}{g_i^6 + c_{w3}^6} \\right)^{1/6}$。\n- $D_i = c_{w1} f_{w,i} (\\frac{\\tilde{\\nu}_i}{d_i})^2$。\n\n我们要求导的变量是 $\\tilde{\\nu}_i$ 和 $\\tilde{\\nu}_n$。\n\n让我们先计算所需的中间导数。\n\n**与 $\\tilde{\\nu}_\\mathrm{avg}$ 及其相关函数的导数：**\n$\\frac{\\partial \\tilde{\\nu}_\\mathrm{avg}}{\\partial \\tilde{\\nu}_i} = \\frac{1}{2}$\n$\\frac{\\partial \\tilde{\\nu}_\\mathrm{avg}}{\\partial \\tilde{\\nu}_n} = \\frac{1}{2}$\n\n$\\frac{\\partial \\chi_\\mathrm{avg}}{\\partial \\tilde{\\nu}_i} = \\frac{1}{\\nu} \\frac{\\partial \\tilde{\\nu}_\\mathrm{avg}}{\\partial \\tilde{\\nu}_i} = \\frac{1}{2\\nu}$\n$\\frac{\\partial \\chi_\\mathrm{avg}}{\\partial \\tilde{\\nu}_n} = \\frac{1}{\\nu} \\frac{\\partial \\tilde{\\nu}_\\mathrm{avg}}{\\partial \\tilde{\\nu}_n} = \\frac{1}{2\\nu}$\n\n让我们求 $\\frac{d f_{v1}}{d \\chi} = \\frac{3\\chi^2(\\chi^3+c_{v1}^3) - \\chi^3(3\\chi^2)}{(\\chi^3+c_{v1}^3)^2} = \\frac{3\\chi^2 c_{v1}^3}{(\\chi^3+c_{v1}^3)^2}$。\n我们称之为 $f'_{v1}$。\n\n让我们求 $\\frac{d f_{v2}}{d \\chi} = - \\frac{(1)(1+\\chi f_{v1}) - \\chi(f_{v1} + \\chi f'_{v1})}{(1+\\chi f_{v1})^2} = - \\frac{1 - \\chi^2 f'_{v1}}{(1+\\chi f_{v1})^2}$。\n我们称之为 $f'_{v2}$。\n\n所以，$\\frac{\\partial f_{v2,\\mathrm{avg}}}{\\partial \\tilde{\\nu}_k} = \\frac{d f_{v2}}{d\\chi}\\Big|_{\\chi_\\mathrm{avg}} \\frac{\\partial \\chi_\\mathrm{avg}}{\\partial \\tilde{\\nu}_k} = f'_{v2}(\\chi_\\mathrm{avg}) \\frac{1}{2\\nu}$，对于 $k \\in \\{i, n\\}$。\n\n**$\\tilde{S}_i$ 的导数**：\n$\\tilde{S}_i$ 通过 $\\tilde{\\nu}_\\mathrm{avg}$ 和 $f_{v2,\\mathrm{avg}}$ 依赖于 $\\tilde{\\nu}_i$ 和 $\\tilde{\\nu}_n$。\n$\\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_k} = \\frac{1}{\\kappa^2 d_i^2} \\left[ \\frac{\\partial \\tilde{\\nu}_\\mathrm{avg}}{\\partial \\tilde{\\nu}_k} f_{v2,\\mathrm{avg}} + \\tilde{\\nu}_\\mathrm{avg} \\frac{\\partial f_{v2,\\mathrm{avg}}}{\\partial \\tilde{\\nu}_k} \\right]$\n$\\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_k} = \\frac{1}{\\kappa^2 d_i^2} \\left[ \\frac{1}{2} f_{v2,\\mathrm{avg}} + \\tilde{\\nu}_\\mathrm{avg} \\left( f'_{v2}(\\chi_\\mathrm{avg}) \\frac{1}{2\\nu} \\right) \\right] = \\frac{1}{2 \\kappa^2 d_i^2} \\left[ f_{v2,\\mathrm{avg}} + \\chi_\\mathrm{avg} f'_{v2}(\\chi_\\mathrm{avg}) \\right]$。\n这对 $k=i$ 和 $k=n$ 都成立。所以 $\\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i} = \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_n}$。\n\n**产生项 $P_i = c_{b1} \\tilde{S}_i \\tilde{\\nu}_i$ 的导数**：\n\n$\\frac{\\partial P_i}{\\partial \\tilde{\\nu}_i} = c_{b1} \\left( \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i} \\tilde{\\nu}_i + \\tilde{S}_i \\cdot 1 \\right) = c_{b1} \\left( \\tilde{S}_i + \\tilde{\\nu}_i \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i} \\right)$。\n\n$\\frac{\\partial P_i}{\\partial \\tilde{\\nu}_n} = c_{b1} \\left( \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_n} \\tilde{\\nu}_i \\right) = c_{b1} \\tilde{\\nu}_i \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_n}$。\n\n由于 $\\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i} = \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_n}$，我们称这个共同项为 $\\frac{d\\tilde{S}_i}{d\\tilde{\\nu}_{\\text{avg/n}}}$。\n那么 $\\frac{\\partial P_i}{\\partial \\tilde{\\nu}_n} = c_{b1} \\tilde{\\nu}_i \\frac{d\\tilde{S}_i}{d\\tilde{\\nu}_{\\text{avg/n}}}$。\n并且 $\\frac{\\partial P_i}{\\partial \\tilde{\\nu}_i} = c_{b1} \\tilde{S}_i + \\frac{\\partial P_i}{\\partial \\tilde{\\nu}_n}$。\n这是一个很好的简化。\n\n**耗散项 $D_i = c_{w1} f_{w,i} (\\frac{\\tilde{\\nu}_i}{d_i})^2$ 的导数**：\n这更复杂，因为 $f_{w,i}$ 依赖于 $r_i$，而 $r_i$ 又依赖于 $\\tilde{S}_i$ 和 $\\tilde{\\nu}_i$。\n$\\tilde{S}_i$ 依赖于 $\\tilde{\\nu}_i$ 和 $\\tilde{\\nu}_n$。\n$r_i$ 显式依赖于 $\\tilde{\\nu}_i$ 并通过 $\\tilde{S}_i$ 依赖于 $\\tilde{\\nu}_i$，同时通过 $\\tilde{S}_i$ 依赖于 $\\tilde{\\nu}_n$。\n\n让我们对 $D_i$ 应用链式法则：\n$\\frac{\\partial D_i}{\\partial \\tilde{\\nu}_k} = \\frac{\\partial}{\\partial \\tilde{\\nu}_k} \\left( c_{w1} f_{w}(g(r_i(\\tilde{\\nu}_i, \\tilde{S}_i(\\tilde{\\nu}_i, \\tilde{\\nu}_n)))) \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2 \\right)$\n\n使用乘法法则：\n$\\frac{\\partial D_i}{\\partial \\tilde{\\nu}_k} = c_{w1} \\left[ \\frac{\\partial f_{w,i}}{\\partial \\tilde{\\nu}_k} \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2 + f_{w,i} \\frac{\\partial}{\\partial \\tilde{\\nu}_k} \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2 \\right]$。\n\n首先，我们看第二项。\n$\\frac{\\partial}{\\partial \\tilde{\\nu}_i} \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2 = \\frac{2\\tilde{\\nu}_i}{d_i^2}$。\n$\\frac{\\partial}{\\partial \\tilde{\\nu}_n} \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2 = 0$。\n\n所以对于 $k=n$：\n$\\frac{\\partial D_i}{\\partial \\tilde{\\nu}_n} = c_{w1} \\frac{\\partial f_{w,i}}{\\partial \\tilde{\\nu}_n} \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2$。\n\n对于 $k=i$：\n$\\frac{\\partial D_i}{\\partial \\tilde{\\nu}_i} = c_{w1} \\left[ \\frac{\\partial f_{w,i}}{\\partial \\tilde{\\nu}_i} \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2 + f_{w,i} \\frac{2\\tilde{\\nu}_i}{d_i^2} \\right]$。\n\n现在我们需要 $\\frac{\\partial f_{w,i}}{\\partial \\tilde{\\nu}_k}$。\n$\\frac{\\partial f_{w,i}}{\\partial \\tilde{\\nu}_k} = \\frac{d f_w}{d g} \\frac{d g}{d r} \\frac{\\partial r_i}{\\partial \\tilde{\\nu}_k}$。\n让我们求 $f_w$ 和 $g$ 的导数。\n$f_w(g) = g\\,\\left(\\dfrac{1 + c_{w3}^6}{g^6 + c_{w3}^6}\\right)^{1/6}$。使用对数求导法，$\\frac{df_w}{dg} = f_w \\left(\\frac{1}{g} - \\frac{g^5}{g^6+c_{w3}^6}\\right) = \\frac{f_w}{g} \\frac{c_{w3}^6}{g^6+c_{w3}^6}$。我们称之为 $f'_w$。\n$g(r) = r + c_{w2}(r^6 - r) = r(1-c_{w2}) + c_{w2}r^6$。\n$\\frac{dg}{dr} = (1-c_{w2}) + 6c_{w2}r^5$。我们称之为 $g'$。\n\n现在我们需要 $\\frac{\\partial r_i}{\\partial \\tilde{\\nu}_k}$。回想一下 $r_i = \\frac{\\tilde{\\nu}_i}{\\tilde{S}_i \\kappa^2 d_i^2}$。\n令 $C_i = (\\kappa^2 d_i^2)^{-1}$。那么 $r_i = C_i \\frac{\\tilde{\\nu}_i}{\\tilde{S}_i}$。\n\n对于 $k=n$：\n$\\frac{\\partial r_i}{\\partial \\tilde{\\nu}_n} = C_i \\tilde{\\nu}_i \\left( -\\frac{1}{\\tilde{S}_i^2} \\right) \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_n} = - \\frac{r_i}{\\tilde{S}_i} \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_n}$。\n\n对于 $k=i$：\n$\\frac{\\partial r_i}{\\partial \\tilde{\\nu}_i} = C_i \\frac{1 \\cdot \\tilde{S}_i - \\tilde{\\nu}_i \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i}}{\\tilde{S}_i^2} = C_i \\left( \\frac{1}{\\tilde{S}_i} - \\frac{\\tilde{\\nu}_i}{\\tilde{S}_i^2} \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i} \\right) = \\frac{r_i}{\\tilde{\\nu}_i} - \\frac{r_i}{\\tilde{S}_i} \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i}$。\n\n将耗散项导数的所有部分整合在一起：\n$\\frac{\\partial f_{w,i}}{\\partial \\tilde{\\nu}_k} = f'_{w}(g_i) \\cdot g'(r_i) \\cdot \\frac{\\partial r_i}{\\partial \\tilde{\\nu}_k}$。\n\n对于 $k=n$：\n$\\frac{\\partial D_i}{\\partial \\tilde{\\nu}_n} = c_{w1} \\left[ f'_{w,i} \\cdot g'_{i} \\cdot \\left( - \\frac{r_i}{\\tilde{S}_i} \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_n} \\right) \\right] \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2$。\n\n对于 $k=i$：\n$\\frac{\\partial D_i}{\\partial \\tilde{\\nu}_i} = c_{w1} \\left[ f'_{w,i} \\cdot g'_{i} \\cdot \\left( \\frac{r_i}{\\tilde{\\nu}_i} - \\frac{r_i}{\\tilde{S}_i} \\frac{\\partial \\tilde{S}_i}{\\partial \\tilde{\\nu}_i} \\right) \\left(\\frac{\\tilde{\\nu}_i}{d_i}\\right)^2 + f_{w,i} \\frac{2\\tilde{\\nu}_i}{d_i^2} \\right]$。\n\n最后，雅可比矩阵项是：\n$J_{ii} = \\dfrac{\\partial P_i}{\\partial \\tilde{\\nu}_i} - \\dfrac{\\partial D_i}{\\partial \\tilde{\\nu}_i}$\n$J_{in} = \\dfrac{\\partial P_i}{\\partial \\tilde{\\nu}_n} - \\dfrac{\\partial D_i}{\\partial \\tilde{\\nu}_n}$\n\n这些推导出的表达式在提供的程序中实现，遵循一个结构化的计算计划，以系统地评估所有中间量及其导数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Spalart-Allmaras source term linearization problem.\n    \"\"\"\n    \n    # Define constants from the problem statement\n    C_b1 = 0.1355\n    C_b2 = 0.622\n    SIGMA = 2.0 / 3.0\n    KAPPA = 0.41\n    C_v1 = 7.1\n    C_w2 = 0.3\n    C_w3 = 2.0\n\n    # Derived constants\n    KAPPA2 = KAPPA**2\n    C_w1 = C_b1 / KAPPA2 + (1.0 + C_b2) / SIGMA\n    CV1_3 = C_v1**3\n    CW3_6 = C_w3**6\n\n    def calculate_jacobian_entries(nu_tilde_i, nu_tilde_n, d_i, S_i, nu):\n        \"\"\"\n        Calculates the Jacobian entries J_ii and J_in for a single control volume.\n        \"\"\"\n        # A small number to prevent division by zero in edge cases\n        eps = 1e-12\n\n        # Step 4: Average quantities\n        nu_tilde_avg = (nu_tilde_i + nu_tilde_n) / 2.0\n        chi_avg = nu_tilde_avg / nu\n\n        # Step 5: f_v1, f_v2 and their derivatives w.r.t. chi, evaluated at chi_avg\n        chi_avg3 = chi_avg**3\n        denom_fv1 = chi_avg3 + CV1_3\n        f_v1_avg = chi_avg3 / (denom_fv1 + eps)\n        \n        f_v1_prime_avg = (3.0 * chi_avg**2 * CV1_3) / ((denom_fv1 + eps)**2)\n        \n        denom_fv2_term = 1.0 + chi_avg * f_v1_avg\n        f_v2_avg = 1.0 - chi_avg / (denom_fv2_term + eps)\n        \n        f_v2_prime_avg = -(1.0 - chi_avg**2 * f_v1_prime_avg) / ((denom_fv2_term + eps)**2)\n\n        # Step 6: Common derivative of S_tilde w.r.t nu_tilde_i and nu_tilde_n\n        term_in_ds = f_v2_avg + chi_avg * f_v2_prime_avg\n        dSi_dnu_k = (1.0 / (2.0 * KAPPA2 * d_i**2)) * term_in_ds\n\n        # Step 7: S_tilde\n        S_tilde_i = S_i + (nu_tilde_avg / (KAPPA2 * d_i**2)) * f_v2_avg\n        if S_tilde_i == 0:\n            S_tilde_i = eps # Safety floor for S_tilde\n\n        # Step 8: Production term derivatives\n        dP_dnu_n = C_b1 * nu_tilde_i * dSi_dnu_k\n        dP_dnu_i = C_b1 * S_tilde_i + dP_dnu_n\n\n        # Step 9: Destruction term intermediate quantities\n        r_i = nu_tilde_i / (S_tilde_i * KAPPA2 * d_i**2 + eps)\n        \n        g_i = r_i + C_w2 * (r_i**6 - r_i)\n        \n        g_i_6 = g_i**6\n        f_w_term = (1.0 + CW3_6) / (g_i_6 + CW3_6 + eps)\n        f_w_i = g_i * f_w_term**(1.0/6.0)\n\n        # Step 10: Intermediate derivatives for destruction term\n        f_w_prime_i = (f_w_i / (g_i + eps)) * (CW3_6 / (g_i_6 + CW3_6 + eps))\n        g_prime_i = (1.0 - C_w2) + 6.0 * C_w2 * r_i**5\n        \n        dr_dnu_n = -(r_i / (S_tilde_i + eps)) * dSi_dnu_k\n        dr_dnu_i = (r_i / (nu_tilde_i + eps)) - (r_i / (S_tilde_i + eps)) * dSi_dnu_k\n\n        dfw_dnu_n = f_w_prime_i * g_prime_i * dr_dnu_n\n        dfw_dnu_i = f_w_prime_i * g_prime_i * dr_dnu_i\n        \n        # Step 11: Destruction term derivatives\n        nu_i_over_d_i_sq = (nu_tilde_i / d_i)**2\n        dD_dnu_n = C_w1 * dfw_dnu_n * nu_i_over_d_i_sq\n        dD_dnu_i = C_w1 * (dfw_dnu_i * nu_i_over_d_i_sq + f_w_i * (2.0 * nu_tilde_i / d_i**2))\n\n        # Step 12: Assemble Jacobian entries\n        J_ii = dP_dnu_i - dD_dnu_i\n        J_in = dP_dnu_n - dD_dnu_n\n        \n        return [J_ii, J_in]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"N\": 3,\n            \"d\": np.array([1e-3, 1e-2, 1e-1]),\n            \"S\": np.array([1000, 300, 50]),\n            \"nu\": 1.5e-5,\n            \"nu_tilde\": np.array([1e-5, 5e-5, 1e-6])\n        },\n        {\n            \"N\": 2,\n            \"d\": np.array([5e-4, 2e-3]),\n            \"S\": np.array([2000, 500]),\n            \"nu\": 1.5e-5,\n            \"nu_tilde\": np.array([2e-6, 3e-5])\n        },\n        {\n            \"N\": 2,\n            \"d\": np.array([5e-2, 5e-2]),\n            \"S\": np.array([10, 10]),\n            \"nu\": 1.5e-5,\n            \"nu_tilde\": np.array([1e-8, 2e-8])\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        d_vec = case[\"d\"]\n        S_vec = case[\"S\"]\n        nu = case[\"nu\"]\n        nu_tilde_vec = case[\"nu_tilde\"]\n        \n        case_results = []\n        for i in range(N):\n            if i  N - 1:\n                n = i + 1\n            else:\n                n = i - 1\n\n            nu_tilde_i = nu_tilde_vec[i]\n            nu_tilde_n = nu_tilde_vec[n]\n            d_i = d_vec[i]\n            S_i = S_vec[i]\n\n            J_ii, J_in = calculate_jacobian_entries(nu_tilde_i, nu_tilde_n, d_i, S_i, nu)\n            case_results.append([J_ii, J_in])\n\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}