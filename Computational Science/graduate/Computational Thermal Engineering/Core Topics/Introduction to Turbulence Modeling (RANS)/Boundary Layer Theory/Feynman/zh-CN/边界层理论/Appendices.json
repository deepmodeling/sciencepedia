{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的计算方法之前，理解边界层的物理尺度至关重要。量级分析是一种强大的工具，它通过简化控制方程，揭示了不同物理量之间的核心关系。本练习将指导您通过平衡动量方程中的惯性项和粘性项，来推导边界层厚度 $\\delta$ 和壁面法向速度 $v$ 的尺度律 。这种方法能够培养物理直觉和进行快速估算的能力，这对任何工程师或科学家来说都是一项宝贵的技能。",
            "id": "3938948",
            "problem": "考虑在零压力梯度下，一个与速度为 $U_{\\infty}$ 的均匀自由来流对齐的半无限平板上形成的稳态、二维、不可压缩的层流边界层。从牛顿流体的连续性方程和流向动量方程出发，使用边界层近似进行量级分析，以得出下游位置 $x$ 处边界层厚度 $\\delta(x)$ 的标度律。然后使用相同的框架，获得边界层内部法向速度大小 $v$ 的标度律。\n\n使用您推导出的标度律，计算当 $U_{\\infty}=10\\,\\mathrm{m/s}$、运动粘度 $\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$ 时，在 $x=0.5\\,\\mathrm{m}$ 处的 $\\delta(x)$ 和法向速度尺度 $v$。假设层流标度律的前置因子为1，将基于 $x$ 的雷诺数解释为 $Re_{x} = U_{\\infty} x / \\nu$，并取法向速度尺度为 $U_{\\infty}\\,\\delta/x$。\n\n边界层厚度以米为单位表示，法向速度尺度以米/秒为单位表示。将您的最终数值四舍五入到四位有效数字。您的最终答案必须表示为包含两个量的单行：第一个是 $\\delta(x)$，第二个是法向速度尺度。",
            "solution": "本问题要求对零压力梯度下半无限平板上的稳态、二维、不可压缩层流的边界层方程进行量级分析。该分析将得出边界层厚度 $\\delta(x)$ 和法向速度分量 $v$ 的标度律。推导之后，将使用这些标度律来计算给定流动条件下的数值。\n\n该流动的控制方程是牛顿流体的连续性方程和流向动量方程，分别为：\n连续性方程：\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0\n$$\n流向动量方程：\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = -\\frac{1}{\\rho}\\frac{d p}{d x} + \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n其中，$u$ 和 $v$ 分别是流向（$x$）和法向（$y$）的速度分量，$\\rho$ 是流体密度，$p$ 是压力，$\\nu$ 是运动粘度。问题说明压力梯度为零，因此 $\\frac{dp}{dx} = 0$。\n\n我们通过为下游位置 $x$ 处厚度为 $\\delta$ 的边界层内的变量定义特征尺度来进行量级分析。\n特征长度尺度在流向是 $x$，在法向是 $\\delta$。我们做出基本的边界层假设，即 $\\delta \\ll x$。\n流向的特征速度尺度是自由来流速度 $U_{\\infty}$，因此 $u \\sim U_{\\infty}$。法向速度的特征尺度是未知的，记为 $v \\sim v_{scale}$。\n\n首先，我们分析连续性方程：\n$$\n\\frac{\\partial u}{\\partial x} \\sim \\frac{U_{\\infty}}{x} \\quad \\text{和} \\quad \\frac{\\partial v}{\\partial y} \\sim \\frac{v_{scale}}{\\delta}\n$$\n为了使连续性方程中的两项平衡，它们必须具有相同的量级：\n$$\n\\frac{v_{scale}}{\\delta} \\sim \\frac{U_{\\infty}}{x} \\implies v_{scale} \\sim U_{\\infty} \\frac{\\delta}{x}\n$$\n这提供了法向速度大小的标度律。由于 $\\delta \\ll x$，因此 $v_{scale} \\ll U_{\\infty}$。\n\n接下来，我们分析流向动量方程中的各项：\n惯性项（左侧）：\n$$\nu \\frac{\\partial u}{\\partial x} \\sim U_{\\infty} \\left( \\frac{U_{\\infty}}{x} \\right) = \\frac{U_{\\infty}^2}{x}\n$$\n$$\nv \\frac{\\partial u}{\\partial y} \\sim \\left( U_{\\infty} \\frac{\\delta}{x} \\right) \\left( \\frac{U_{\\infty}}{\\delta} \\right) = \\frac{U_{\\infty}^2}{x}\n$$\n两个惯性项的量级相同。\n\n粘性项（右侧，$\\frac{dp}{dx}=0$）：\n$$\n\\nu \\frac{\\partial^2 u}{\\partial x^2} \\sim \\nu \\frac{U_{\\infty}}{x^2}\n$$\n$$\n\\nu \\frac{\\partial^2 u}{\\partial y^2} \\sim \\nu \\frac{U_{\\infty}}{\\delta^2}\n$$\n因为 $\\delta \\ll x$，所以有 $\\delta^2 \\ll x^2$，这意味着 $\\frac{1}{\\delta^2} \\gg \\frac{1}{x^2}$。因此，与法向扩散相比，流向的粘性扩散可以忽略不计：$\\nu \\frac{\\partial^2 u}{\\partial y^2} \\gg \\nu \\frac{\\partial^2 u}{\\partial x^2}$。\n\n边界层的本质是惯性力与粘性力之间的平衡。因此，惯性项的量级必须与主导粘性项的量级相当：\n$$\n\\underbrace{\\frac{U_{\\infty}^2}{x}}_{\\text{惯性}} \\sim \\underbrace{\\nu \\frac{U_{\\infty}}{\\delta^2}}_{\\text{粘性}}\n$$\n求解边界层厚度的平方 $\\delta^2$：\n$$\n\\delta^2 \\sim \\frac{\\nu x U_{\\infty}}{U_{\\infty}^2} = \\frac{\\nu x}{U_{\\infty}}\n$$\n这给出了边界层厚度的标度律：\n$$\n\\delta(x) \\sim \\sqrt{\\frac{\\nu x}{U_{\\infty}}}\n$$\n为了以无量纲形式表示，我们除以 $x$ 并引入基于 $x$ 的雷诺数 $Re_x = \\frac{U_{\\infty} x}{\\nu}$：\n$$\n\\frac{\\delta(x)}{x} \\sim \\sqrt{\\frac{\\nu}{U_{\\infty} x}} = \\frac{1}{\\sqrt{\\frac{U_{\\infty} x}{\\nu}}} = \\frac{1}{\\sqrt{Re_x}}\n$$\n这证实了经典的标度律 $\\delta(x)/x \\propto Re_x^{-1/2}$。\n\n现在，我们使用给定的数据进行数值计算：$x=0.5\\,\\mathrm{m}$，$U_{\\infty}=10\\,\\mathrm{m/s}$，以及 $\\nu=1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$。\n首先，我们计算雷诺数 $Re_x$：\n$$\nRe_x = \\frac{U_{\\infty} x}{\\nu} = \\frac{(10\\,\\mathrm{m/s})(0.5\\,\\mathrm{m})}{1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}} = \\frac{5}{1.5 \\times 10^{-5}} = \\frac{10}{3} \\times 10^5 \\approx 333333\n$$\n问题指明假设层流标度律的前置因子为1。因此，我们直接使用关系式 $\\delta(x)/x = Re_x^{-1/2}$。\n$$\n\\delta(x) = x \\, Re_x^{-1/2} = x \\sqrt{\\frac{\\nu}{U_{\\infty} x}} = \\sqrt{\\frac{\\nu x}{U_{\\infty}}}\n$$\n代入 $x=0.5\\,\\mathrm{m}$ 处的数值计算 $\\delta(x)$：\n$$\n\\delta(0.5) = \\sqrt{\\frac{(1.5 \\times 10^{-5}\\,\\mathrm{m^2/s})(0.5\\,\\mathrm{m})}{10\\,\\mathrm{m/s}}} = \\sqrt{0.75 \\times 10^{-6}}\\,\\mathrm{m} = \\sqrt{75 \\times 10^{-8}}\\,\\mathrm{m}\n$$\n$$\n\\delta(0.5) = \\sqrt{25 \\times 3} \\times 10^{-4}\\,\\mathrm{m} = 5\\sqrt{3} \\times 10^{-4}\\,\\mathrm{m} \\approx 8.660254 \\times 10^{-4}\\,\\mathrm{m}\n$$\n四舍五入到四位有效数字，边界层厚度为 $\\delta(0.5) = 0.0008660\\,\\mathrm{m}$。\n\n接下来，我们计算法向速度尺度 $v$。问题指明使用关系式 $v = U_{\\infty} \\frac{\\delta}{x}$，这与我们推导的标度律一致。\n$$\nv = (10\\,\\mathrm{m/s}) \\times \\frac{8.660254 \\times 10^{-4}\\,\\mathrm{m}}{0.5\\,\\mathrm{m}} = 20 \\times (8.660254 \\times 10^{-4})\\,\\mathrm{m/s} \\approx 0.0173205\\,\\mathrm{m/s}\n$$\n四舍五入到四位有效数字，法向速度尺度为 $v = 0.01732\\,\\mathrm{m/s}$。\n\n最终结果是边界层厚度和法向速度尺度，均四舍五入到四位有效数字。\n$\\delta(0.5) = 0.0008660\\,\\mathrm{m}$\n$v = 0.01732\\,\\mathrm{m/s}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.0008660  0.01732\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "前一个练习中的尺度分析引出了平板流动自相似解的概念，它将偏微分控制方程简化为单个常微分方程——Blasius方程。这个练习将指导您使用“打靶法”来求解这个经典的边界值问题 。打靶法是一种强大的数值技术，它将边界值问题（BVP）转化为一个初值问题（IVP），并通过迭代求解缺失的初始条件来找到解。通过完成这个练习，您将获得解决流体力学中一个典型问题的实践经验，并掌握一种在工程和物理学中广泛应用的数值方法。",
            "id": "3938896",
            "problem": "考虑一个二维、定常、不可压缩的层流边界层，该边界层形成于与均匀自由流速 $U_{\\infty}$ 对齐的半无限平板上。从边界层流动的质量和动量守恒出发，其控制方程为连续性方程 $\\partial u / \\partial x + \\partial v / \\partial y = 0$ 和流向动量方程 $u \\, \\partial u / \\partial x + v \\, \\partial u / \\partial y = \\nu \\, \\partial^2 u / \\partial y^2$，其中 $u(x,y)$ 和 $v(x,y)$ 分别是流向和壁面法向的速度分量，$\\nu$ 是运动粘度。寻求具有流函数表示的相似解，并使用适当缩放的相似性变量，可将该偏微分方程组简化为关于无量纲流函数剖面 $f(\\eta)$ 的经典 Blasius 常微分方程 (ODE)：\n$$\nf'''(\\eta) + \\tfrac{1}{2} f(\\eta) \\, f''(\\eta) = 0,\n$$\n其边界条件为\n$$\nf(0) = 0, \\quad f'(0) = 0, \\quad \\text{和} \\quad f'(\\eta \\to \\infty) = 1,\n$$\n其中撇号表示对相似性变量 $\\eta$ 的微分。我们感兴趣的量是未知的初始曲率 $f''(0)$，它决定了壁面切应力，并且是一个无量纲数。\n\n您的任务是实现一种数值打靶法来求解上述初值问题 (IVP)，并确定 $f''(0)$ 的值，要求至少有四位有效数字的精度。将 $s = f''(0)$ 视为一个打靶参数。对于任意一个试验值 $s$，使用一个现代的自适应常微分方程求解器，将 Blasius 常微分方程作为一个一阶系统从 $\\eta = 0$ 积分到一个有限的截断值 $\\eta = L$。定义残差\n$$\nR(s; L) = f'(\\eta = L; s) - 1,\n$$\n并找到使 $R(s; L) = 0$ 的 $s$ 值。将您计算出的 $s$ 与经典参考值 $s_{\\mathrm{ref}} = 0.332057336215$ 进行比较，并评估结果是否至少有四位正确的有效数字。对于此评估，如果绝对误差 $|s - s_{\\mathrm{ref}}| \\le 0.00005$，则声明通过，这保证了对于一个接近 $s_{\\mathrm{ref}}$ 的值，其四舍五入到四位有效数字是正确的。\n\n该解决方案必须是纯算法式的和无量纲的。请将您的求解器实现在一个单一程序中，该程序无需任何外部输入即可生成所需的输出。使用标准科学计算库中的自适应常微分方程积分器来精确处理初值问题。您可以使用一维求根方法（如二分法或割线法）来求解打靶参数。\n\n测试套件：\n请提供以下参数集 $(L, \\mathrm{rtol}, \\mathrm{atol})$ 的结果，其中 $L$ 是相似性变量的有限截断值，$\\mathrm{rtol}$ 和 $\\mathrm{atol}$ 分别是常微分方程求解器的相对和绝对容差。所有量均为无量纲。\n\n- 情况 1：$(L, \\mathrm{rtol}, \\mathrm{atol}) = (10.0, 10^{-9}, 10^{-11})$。\n- 情况 2：$(L, \\mathrm{rtol}, \\mathrm{atol}) = (4.0, 10^{-8}, 10^{-10})$。\n- 情况 3：$(L, \\mathrm{rtol}, \\mathrm{atol}) = (20.0, 10^{-8}, 10^{-10})$。\n- 情况 4：$(L, \\mathrm{rtol}, \\mathrm{atol}) = (10.0, 10^{-6}, 10^{-8})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，并且必须是一个形式为 $[s, e, p]$ 的三元素列表，其中 $s$ 是计算出的 $f''(0)$ 值，四舍五入到六位小数；$e$ 是绝对误差 $|s - s_{\\mathrm{ref}}|$，四舍五入到六位小数；$p$ 是一个布尔值，表示是否满足四位有效数字的标准。例如，输出格式必须为\n$$\n[[s_1, e_1, p_1],[s_2, e_2, p_2],[s_3, e_3, p_3],[s_4, e_4, p_4]].\n$$",
            "solution": "用户提出了一个具有科学依据、提法恰当且客观的问题。它涉及使用标准的打靶法对 Blasius 方程进行数值求解，这是流体力学中的一个经典问题。所有必需的数据、边界条件和评估标准均已提供。该问题是有效的。\n\n核心任务是求解一个关于无量纲流函数剖面 $f(\\eta)$ 的三阶非线性常微分方程 (ODE) 边值问题 (BVP)。该常微分方程即 Blasius 方程：\n$$\nf'''(\\eta) + \\tfrac{1}{2} f(\\eta) \\, f''(\\eta) = 0\n$$\n服从以下边界条件：\n$$\nf(0) = 0, \\quad f'(0) = 0, \\quad \\text{和} \\quad f'(\\eta \\to \\infty) = 1\n$$\n目标是找到未知初始条件 $f''(0)$ 的值。这类边值问题非常适合使用打靶法，该方法将边值问题转化为一个可以通过迭代求解的初值问题 (IVP)。\n\n**第一步：转换为一阶常微分方程组**\n为了使用标准的初值问题求解器，必须将三阶常微分方程转换为一个包含三个一阶常微分方程的方程组。我们定义一个状态向量 $y(\\eta)$ 如下：\n$$\ny(\\eta) = \\begin{bmatrix} y_0(\\eta) \\\\ y_1(\\eta) \\\\ y_2(\\eta) \\end{bmatrix} = \\begin{bmatrix} f(\\eta) \\\\ f'(\\eta) \\\\ f''(\\eta) \\end{bmatrix}\n$$\n向量 $y$ 的各分量对 $\\eta$ 的导数构成了以下方程组：\n$$\n\\frac{d y}{d \\eta} = \\begin{bmatrix} y_0' \\\\ y_1' \\\\ y_2' \\end{bmatrix} = \\begin{bmatrix} f' \\\\ f'' \\\\ f''' \\end{bmatrix} = \\begin{bmatrix} y_1 \\\\ y_2 \\\\ -\\frac{1}{2} f f'' \\end{bmatrix} = \\begin{bmatrix} y_1 \\\\ y_2 \\\\ -0.5 \\, y_0 \\, y_2 \\end{bmatrix}\n$$\n这就是将要进行数值积分的一阶常微分方程组。\n\n**第二步：打靶法**\n打靶法通过将缺失的初始条件 $f''(0)$ 视为一个参数（我们称之为 $s$）来解决此问题。我们通过猜测 $s$ 并对初值问题进行积分，从 $\\eta=0$ 开始“发射”解。目标是调整 $s$，直到满足定义域远端的边界条件。\n\n在 $\\eta=0$ 处的初值问题的初始条件为：\n$$\nf(0) = 0 \\quad \\implies \\quad y_0(0) = 0\n$$\n$$\nf'(0) = 0 \\quad \\implies \\quad y_1(0) = 0\n$$\n缺失的条件即为我们的打靶参数：\n$$\nf''(0) = s \\quad \\implies \\quad y_2(0) = s\n$$\n因此，我们初值问题的初始状态向量是 $y(0) = [0, 0, s]^T$。\n\n无穷远处的边界条件 $f'(\\eta \\to \\infty) = 1$ 在数值上是难以处理的。我们通过在一个有限但足够大的相似性变量值 $\\eta = L$ 处施加该条件来进行近似。该条件变为 $f'(L; s) = 1$，或者用我们的状态向量表示为 $y_1(L; s) = 1$。参数 $L$ 是测试套件中指定的输入之一。\n\n我们定义一个残差函数 $R(s; L)$，它衡量给定的猜测值 $s$ 与满足远场边界条件之间的差距：\n$$\nR(s; L) = y_1(L; s) - 1\n$$\n现在，问题简化为找到方程 $R(s;L) = 0$ 的根。\n\n**第三步：数值实现**\n总体算法如下：\n1. 对于由元组 $(L, \\mathrm{rtol}, \\mathrm{atol})$ 指定的每个测试用例，我们需要找到使 $R(s; L) = 0$ 的 $s$ 值。\n2. 对于任何给定的 $s$，计算残差函数 $R(s; L)$ 需要使用初始条件 $y(0) = [0, 0, s]^T$ 对一阶常微分方程组从 $\\eta=0$ 到 $\\eta=L$ 进行数值积分。此积分使用一个现代的自适应常微分方程求解器（具体为 `scipy.integrate.solve_ivp`）以及提供的相对容差 `rtol` 和绝对容差 `atol` 来执行。该求解器会自动调整其内部步长以达到所需的精度。\n3. 使用一个稳健的一维求根算法来找到使 $R(s; L) = 0$ 的 $s$ 值。`scipy.optimize.brentq` 函数，它实现了 Brent 方法，是一个绝佳的选择。它需要一个区间 $[s_a, s_b]$，在该区间端点处残差函数的值异号，即 $R(s_a; L) \\times R(s_b; L) < 0$。一个合适的区间是 $[0, 1]$。对于 $s=0$，解是平凡的 $f(\\eta)=0$，所以 $y_1(L)=0$ 且 $R(0; L) = -1$。对于 $s=1$，初始曲率很大，我们预计速度剖面会超过目标值，使得 $y_1(L) > 1$，因此 $R(1; L) > 0$。这个区间保证了根的存在。\n4. 一旦找到根 $s$（我们对 $f''(0)$ 的近似值），就将其与高精度参考值 $s_{\\mathrm{ref}} = 0.332057336215$ 进行比较。计算绝对误差 $e = |s - s_{\\mathrm{ref}}|$。\n5. 如果满足精度标准 $e \\le 0.00005$，则将通过/失败标志 $p$ 设置为 `True`，否则设置为 `False`。\n6. 将计算出的值 $s$ 和误差 $e$ 四舍五入到六位小数，并存储三元组 $[s, e, p]$。对所有测试用例重复此过程。\n\n最终输出是这些三元组的列表，根据问题规范格式化为字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Blasius equation for f''(0) using a shooting method\n    for a suite of test cases and formats the output.\n    \"\"\"\n\n    # High-precision reference value for f''(0)\n    S_REF = 0.332057336215\n    # Accuracy criterion for passing the test\n    PASS_CRITERION = 0.00005\n\n    def blasius_ode_system(eta, y):\n        \"\"\"\n        Defines the first-order ODE system for the Blasius equation.\n        The state vector y is [f, f', f''].\n        The system returns [y', y'', y'''] = [f', f'', f'''].\n        The Blasius equation is f''' = -0.5 * f * f''.\n        \"\"\"\n        return [y[1], y[2], -0.5 * y[0] * y[2]]\n\n    def solve_blasius(L, rtol, atol):\n        \"\"\"\n        Finds s = f''(0) for a given set of numerical parameters.\n\n        It uses a root-finding algorithm (Brent's method) on a residual\n        function. The residual represents the error in the far-field\n        boundary condition f'(L) = 1.\n\n        Args:\n            L (float): Finite truncation of the semi-infinite domain.\n            rtol (float): Relative tolerance for the ODE solver.\n            atol (float): Absolute tolerance for the ODE solver.\n\n        Returns:\n            float: The computed value of s = f''(0).\n        \"\"\"\n        \n        def residual(s):\n            \"\"\"\n            Computes the residual R(s) = f'(L; s) - 1.\n            This function is the target for the root-finder.\n            It solves the IVP for a given shooting parameter s.\n            \"\"\"\n            # Initial conditions: y(0) = [f(0), f'(0), f''(0)]\n            y0 = [0.0, 0.0, s]\n            \n            # Solve the IVP from eta=0 to eta=L\n            sol = solve_ivp(\n                fun=blasius_ode_system,\n                t_span=[0, L],\n                y0=y0,\n                method='RK45',  # Adaptive Runge-Kutta method\n                rtol=rtol,\n                atol=atol\n            )\n            \n            # Extract f'(L), which is the second component of the solution\n            # at the last time point.\n            f_prime_at_L = sol.y[1, -1]\n            return f_prime_at_L - 1.0\n\n        # Find the root of the residual function s.\n        # A bracket of [0, 1] is robust:\n        # s=0 -> f'=0 -> residual=-1\n        # s=1 -> f' overshoots 1 -> residual > 0\n        try:\n            s_solution = brentq(residual, a=0.0, b=1.0, xtol=1e-15, rtol=1e-15)\n        except ValueError:\n            # In case the bracket is invalid for extreme parameters,\n            # which shouldn't happen for this problem.\n            return np.nan\n            \n        return s_solution\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        (10.0, 1e-9, 1e-11),\n        (4.0, 1e-8, 1e-10),\n        (20.0, 1e-8, 1e-10),\n        (10.0, 1e-6, 1e-8),\n    ]\n\n    results = []\n    for L, rtol, atol in test_cases:\n        s_computed = solve_blasius(L, rtol, atol)\n        \n        error = abs(s_computed - S_REF)\n        passed = (error = PASS_CRITERION)\n        \n        s_rounded = round(s_computed, 6)\n        error_rounded = round(error, 6)\n        \n        results.append([s_rounded, error_rounded, passed])\n\n    # Generate the output string in the exact specified format.\n    # The default string representation of a list of lists matches the format,\n    # and spaces are removed to be precise.\n    output_string = str(results).replace(\" \", \"\")\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "层流边界层不会无限地保持稳定；在一定条件下，它会变得不稳定并转捩为湍流。准确预测转捩发生的位置对于许多工程应用（如空气动力学和热传递）至关重要。$e^N$ 方法是一种在工程实践中广泛应用的半经验工具，用于预测转捩的发生 。在本练习中，您将通过积分沿壁面增长最快的不稳定扰动（Tollmien-Schlichting波）的增长率，来估算转捩位置，从而将线性稳定性理论与实际工程设计问题联系起来。",
            "id": "3938888",
            "problem": "考虑均匀自由流中光滑平板上的二维、不可压缩、层流边界层。假设小振幅扰动在线性稳定性理论的框架下演化，并且其流向空间放大足够缓慢，使得局部增长率的描述有意义。目标是使用指数 $e^N$ 框架，确定累积扰动增长达到指定阈值的流向转捩位置。所有长度必须以米表示，所有速度以米/秒表示，所有黏度以平方米/秒表示，最终的转捩位置必须以米为单位报告，并四舍五入到四位小数。\n\n从基本原理出发，将扰动振幅 $A(x)$ 建模为随流向坐标 $x$ 演化的线性常微分方程，其局部增长率为 $s(x)$，使得 $A(x)$ 相对于 $x$ 的变化率与 $A(x)$ 和 $s(x)$ 成正比。累积增长因子 $N(x)$ 定义为从参考位置 $x_0$ 开始的振幅比的自然对数。当累积增长 $N(x)$ 达到指定阈值 $N_{\\mathrm{th}}$ 时，认为转捩发生在最小的流向位置 $x_t$。如果 $N(x)$ 在计算域内始终未达到 $N_{\\mathrm{th}}$，则转捩位置必须报告为 $-1.0$。\n\n为了在计算上封闭该模型而无需进行完整的 Orr–Sommerfeld 分析，我们采用局部空间放大率 $s(x)$ 的包络模型。该模型在量纲上应保持一致，并能定性地代表在零压力梯度到缓变外部压力梯度中 Tollmien–Schlichting (TS) 波的放大过程。设外部速度模型为 $U_e(x) = U_\\infty \\left(\\frac{x}{x_0}\\right)^m$（适用于 $x \\ge x_0$），其中 $U_\\infty$ 是自由流速度， $m$ 是 Falkner–Skan 压力梯度指数（$m = 0$ 表示零压力梯度，$m  0$ 表示逆压力梯度，$m  0$ 表示顺压力梯度），$x_0$ 是前缘偏移量，在该位置边界层被认为已充分发展，可以支持线性不稳定性分析。定义基于 $x$ 的局部雷诺数为 $Re_x(x) = \\dfrac{U_e(x) \\, x}{\\nu}$，其中 $\\nu$ 是运动黏度。使用以下 $s(x)$ 的包络模型：\n对于 $Re_x(x)  Re_{\\mathrm{crit}}$，令 $s(x) = 0$；对于 $Re_x(x) \\ge Re_{\\mathrm{crit}}$，定义\n$$\ns(x) = F_{\\mathrm{pg}} \\, c_0 \\, \\frac{U_e(x)}{\\nu} \\left( \\frac{Re_x(x) - Re_{\\mathrm{crit}}}{Re_{\\mathrm{ref}}} \\right)^{p} \\exp\\!\\left( -\\beta \\, \\frac{Re_x(x)}{Re_{\\mathrm{ref}}} \\right),\n$$\n其中 $c_0$ 是一个无量纲的缩放常数，$Re_{\\mathrm{crit}}$ 是不稳定性起始的雷诺数，$Re_{\\mathrm{ref}}$ 是用于缩放包络的参考雷诺数，$p$ 是一个控制接近起始点增长行为的正指数，$\\beta$ 是一个正的包络衰减参数。因子 $F_{\\mathrm{pg}} = 1 - r \\, m$ 模拟了压力梯度对扰动增长包络的一阶失稳或稳定影响，其中 $r$ 是一个正常数。函数 $s(x)$ 的单位是米的倒数，这确保了累积增长积分 $N(x)$ 是无量纲的。\n\n你的任务是编写一个程序，根据给定的参数计算累积增长\n$$\nN(x) = \\int_{x_0}^{x} s(\\xi) \\, d\\xi\n$$\n并找到满足 $N(x_t) = N_{\\mathrm{th}}$ 的最小 $x_t \\in [x_0, x_{\\mathrm{end}}]$。如果在 $[x_0, x_{\\mathrm{end}}]$ 内不存在这样的 $x_t$，则必须返回 $-1.0$。在 $x \\in [x_0, x_{\\mathrm{end}}]$ 的均匀网格上使用数值积分，并在相邻网格点之间进行线性插值，以精确确定 $N(x)$ 与 $N_{\\mathrm{th}}$ 的交点位置。输出必须以米表示，并四舍五入到四位小数。\n\n使用以下测试套件实现并测试你的程序。每个测试用例都指定了国际单位制 (SI) 中的参数 $(U_\\infty, \\nu, x_0, x_{\\mathrm{end}}, m, c_0, Re_{\\mathrm{crit}}, Re_{\\mathrm{ref}}, p, \\beta, N_{\\mathrm{th}})$，所有情况下都固定 $r = 1.5$。\n\n- 测试用例 1（一般情况，零压力梯度）：$(U_\\infty = 30.0, \\nu = 1.5 \\times 10^{-5}, x_0 = 0.05, x_{\\mathrm{end}} = 1.5, m = 0.0, c_0 = 5.0 \\times 10^{-6}, Re_{\\mathrm{crit}} = 3.5 \\times 10^{5}, Re_{\\mathrm{ref}} = 1.0 \\times 10^{6}, p = 1.0, \\beta = 0.3, N_{\\mathrm{th}} = 9.0)$。\n- 测试用例 2（域内无转捩）：$(U_\\infty = 15.0, \\nu = 1.5 \\times 10^{-5}, x_0 = 0.05, x_{\\mathrm{end}} = 1.5, m = 0.0, c_0 = 5.0 \\times 10^{-6}, Re_{\\mathrm{crit}} = 3.5 \\times 10^{5}, Re_{\\mathrm{ref}} = 1.0 \\times 10^{6}, p = 1.0, \\beta = 0.3, N_{\\mathrm{th}} = 9.0)$。\n- 测试用例 3（逆压力梯度导致失稳）：$(U_\\infty = 20.0, \\nu = 1.5 \\times 10^{-5}, x_0 = 0.05, x_{\\mathrm{end}} = 1.5, m = -0.25, c_0 = 5.0 \\times 10^{-6}, Re_{\\mathrm{crit}} = 3.5 \\times 10^{5}, Re_{\\mathrm{ref}} = 1.0 \\times 10^{6}, p = 1.0, \\beta = 0.3, N_{\\mathrm{th}} = 9.0)$。\n- 测试用例 4（接近域末端的更高阈值）：$(U_\\infty = 30.0, \\nu = 1.5 \\times 10^{-5}, x_0 = 0.05, x_{\\mathrm{end}} = 1.5, m = 0.0, c_0 = 5.0 \\times 10^{-6}, Re_{\\mathrm{crit}} = 3.5 \\times 10^{5}, Re_{\\mathrm{ref}} = 1.0 \\times 10^{6}, p = 1.0, \\beta = 0.3, N_{\\mathrm{th}} = 11.5)$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[x_{t,1}, x_{t,2}, x_{t,3}, x_{t,4}]$，其中每个 $x_{t,i}$ 是测试用例 $i$ 的转捩位置（以米为单位），四舍五入到四位小数。如果在给定测试用例的域内没有发生转捩，则相应的条目必须是 $-1.0000$。",
            "solution": "问题陈述经评估有效。\n\n### 步骤 1：提取给定信息\n\n- **扰动振幅模型**：扰动振幅 $A(x)$ 的变化率由线性常微分方程给出：$\\frac{dA}{dx} = s(x) A(x)$，其中 $s(x)$ 是局部空间增长率。\n- **累积增长因子**：$N(x) = \\ln\\left(\\frac{A(x)}{A(x_0)}\\right) = \\int_{x_0}^{x} s(\\xi) \\, d\\xi$。\n- **转捩判据**：当 $N(x_t)$ 达到阈值 $N_{\\mathrm{th}}$ 时，转捩发生在最小的流向位置 $x_t$。\n- **无转捩条件**：如果 $N(x)$ 在域 $[x_0, x_{\\mathrm{end}}]$ 内始终未达到 $N_{\\mathrm{th}}$，则转捩位置报告为 $-1.0$。\n- **外部速度模型**：$U_e(x) = U_\\infty \\left(\\frac{x}{x_0}\\right)^m$，适用于 $x \\ge x_0$。\n- **局部雷诺数**：$Re_x(x) = \\dfrac{U_e(x) \\, x}{\\nu}$。\n- **空间放大率模型**：对于 $Re_x(x)  Re_{\\mathrm{crit}}$，$s(x) = 0$。对于 $Re_x(x) \\ge Re_{\\mathrm{crit}}$，\n$$\ns(x) = F_{\\mathrm{pg}} \\, c_0 \\, \\frac{U_e(x)}{\\nu} \\left( \\frac{Re_x(x) - Re_{\\mathrm{crit}}}{Re_{\\mathrm{ref}}} \\right)^{p} \\exp\\!\\left( -\\beta \\, \\frac{Re_x(x)}{Re_{\\mathrm{ref}}} \\right)\n$$\n- **压力梯度因子**：$F_{\\mathrm{pg}} = 1 - r \\, m$，其中 $r = 1.5$ 为固定值。\n- **计算方法**：\n    - 在 $x \\in [x_0, x_{\\mathrm{end}}]$ 的均匀网格上进行数值积分。\n    - 使用线性插值找到交叉点位置 $x_t$。\n- **测试用例**：为四个测试场景提供了参数 $(U_\\infty, \\nu, x_0, x_{\\mathrm{end}}, m, c_0, Re_{\\mathrm{crit}}, Re_{\\mathrm{ref}}, p, \\beta, N_{\\mathrm{th}})$。\n    1.  $(30.0, 1.5 \\times 10^{-5}, 0.05, 1.5, 0.0, 5.0 \\times 10^{-6}, 3.5 \\times 10^{5}, 1.0 \\times 10^{6}, 1.0, 0.3, 9.0)$\n    2.  $(15.0, 1.5 \\times 10^{-5}, 0.05, 1.5, 0.0, 5.0 \\times 10^{-6}, 3.5 \\times 10^{5}, 1.0 \\times 10^{6}, 1.0, 0.3, 9.0)$\n    3.  $(20.0, 1.5 \\times 10^{-5}, 0.05, 1.5, -0.25, 5.0 \\times 10^{-6}, 3.5 \\times 10^{5}, 1.0 \\times 10^{6}, 1.0, 0.3, 9.0)$\n    4.  $(30.0, 1.5 \\times 10^{-5}, 0.05, 1.5, 0.0, 5.0 \\times 10^{-6}, 3.5 \\times 10^{5}, 1.0 \\times 10^{6}, 1.0, 0.3, 11.5)$\n\n### 步骤 2：使用提取的给定信息进行验证\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题基于流体动力学的既定原理，特别是边界层稳定性和转捩。$e^N$ 方法是用于转捩预测的标准工程工具，尽管是半经验性的。速度、雷诺数和扰动增长率包络的模型是简化的，但在该领域具有物理代表性。量纲一致性是合理的：$s(x)$ 的单位是 $m^{-1}$，因此其积分 $N(x)$ 是无量纲的。\n- **适定性**：该问题是适定的。它要求解方程 $N(x) - N_{\\mathrm{th}} = 0$ 的根。由于增长率 $s(x)$ 是非负的，累积增长函数 $N(x)$ 是单调不减的。这确保了如果存在解，该解是唯一的（因为寻找的是最小的 $x_t$）。问题为数值求解提供了清晰的流程，并指定了在给定域内不存在解时的结果。\n- **客观性**：问题以精确、客观和定量的方式陈述。没有主观因素。\n- **完整性和一致性**：问题是自洽的。所有必要的参数、方程、边界条件（域 $[x_0, x_{\\mathrm{end}}]$）和数值程序都已指定。测试用例提供了求解所需的完整数据集。没有内部矛盾。\n- **可行性**：物理参数和范围对于航空和机械工程应用是现实的。计算任务是可行且明确定义的。\n\n### 步骤 3：结论与行动\n\n该问题是 **有效的**。将根据提供的模型和计算指令制定解决方案。\n\n### 解决方案\n\n目标是找到平板上的转捩位置 $x_t$，该位置定义为边界层扰动的累积增长因子 $N(x)$ 首次达到指定阈值 $N_{\\mathrm{th}}$ 的点。累积增长是通过对一个模型化的空间放大率 $s(x)$ 从起始位置 $x_0$ 开始积分来计算的。\n\n求解每个测试用例的 $x_t$ 的算法流程如下：\n\n1.  **离散化域**：将空间域 $[x_0, x_{\\mathrm{end}}]$ 离散化为一个精细的均匀网格点集 $\\{x_i\\}_{i=0}^M$，其中 $x_i = x_0 + i \\cdot \\Delta x$ 且 $\\Delta x = (x_{\\mathrm{end}} - x_0)/M$。选择足够多的点数 $M+1$ 以确保数值积分的准确性。\n\n2.  **计算局部放大率**：对于网格上的每个点 $x_i$，计算局部放大率 $s(x_i)$。这涉及基于所提供模型的一系列计算：\n    a.  计算外部速度 $U_e(x_i) = U_\\infty \\left(\\frac{x_i}{x_0}\\right)^m$。\n    b.  计算局部雷诺数 $Re_x(x_i) = \\frac{U_e(x_i) \\, x_i}{\\nu}$。\n    c.  评估放大率 $s(x_i)$。如果 $Re_x(x_i)$ 低于临界雷诺数 $Re_{\\mathrm{crit}}$，则流动是稳定的，且 $s(x_i) = 0$。否则，使用给定的包络公式计算 $s(x_i)$：\n        $$\n        s(x_i) = (1 - r \\, m) \\, c_0 \\, \\frac{U_e(x_i)}{\\nu} \\left( \\frac{Re_x(x_i) - Re_{\\mathrm{crit}}}{Re_{\\mathrm{ref}}} \\right)^{p} \\exp\\!\\left( -\\beta \\, \\frac{Re_x(x_i)}{Re_{\\mathrm{ref}}} \\right)\n        $$\n\n3.  **计算累积增长因子**：累积增长因子 $N(x)$ 是放大率的积分，$N(x) = \\int_{x_0}^{x} s(\\xi) \\, d\\xi$。该积分在网格上进行数值计算。我们使用梯形法则，它高效且非常适合精细网格。每个网格点 $x_i$ 处的 $N(x_i)$ 值通过累加由 $s(x)$ 函数形成的梯形面积得到：\n    $$\n    N(x_i) \\approx \\sum_{j=1}^{i} \\frac{s(x_{j-1}) + s(x_j)}{2} \\Delta x\n    $$\n    这可以通过使用累积梯形积分函数高效实现，从而得到一个值数组 $\\{N(x_i)\\}_{i=0}^M$，其中 $N(x_0) = 0$。\n\n4.  **确定转捩位置**：我们在数组 $\\{N(x_i)\\}$ 中搜索第一个满足 $N(x_i) \\ge N_{\\mathrm{th}}$ 的索引 $i$。\n    a.  如果直到 $i=M$ 都未找到这样的索引，这意味着 $N(x_{\\mathrm{end}})  N_{\\mathrm{th}}$，转捩在计算域内没有发生。在这种情况下，结果报告为 $-1.0$。\n    b.  如果找到了这样的索引 $i$，则转捩位置 $x_t$ 位于区间 $[x_{i-1}, x_i]$ 内。为了找到其精确值，我们执行线性插值。假设一条直线连接点 $(x_{i-1}, N(x_{i-1}))$ 和 $(x_i, N(x_i))$，我们找到对应于 $N(x_t) = N_{\\mathrm{th}}$ 的值 $x_t$：\n        $$\n        x_t = x_{i-1} + (x_i - x_{i-1}) \\frac{N_{\\mathrm{th}} - N(x_{i-1})}{N(x_i) - N(x_{i-1})}\n        $$\n\n5.  **最终确定输出**：计算出的转捩位置 $x_t$ 四舍五入到四位小数。如果未发生转捩，则根据问题规范将值报告为 $-1.0000$。对所有四个提供的测试用例重复此过程。\n\n实现将使用 `numpy` 库进行高效的向量化计算，并使用 `scipy.integrate.cumulative_trapezoid` 进行精确的数值积分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Main function to solve the boundary layer transition problem for all test cases.\n    \"\"\"\n\n    # Parameter r is fixed for all cases.\n    r = 1.5\n\n    # Test cases: (U_inf, nu, x0, x_end, m, c0, Re_crit, Re_ref, p, beta, N_th)\n    test_cases = [\n        (30.0, 1.5e-5, 0.05, 1.5, 0.0, 5.0e-6, 3.5e5, 1.0e6, 1.0, 0.3, 9.0),\n        (15.0, 1.5e-5, 0.05, 1.5, 0.0, 5.0e-6, 3.5e5, 1.0e6, 1.0, 0.3, 9.0),\n        (20.0, 1.5e-5, 0.05, 1.5, -0.25, 5.0e-6, 3.5e5, 1.0e6, 1.0, 0.3, 9.0),\n        (30.0, 1.5e-5, 0.05, 1.5, 0.0, 5.0e-6, 3.5e5, 1.0e6, 1.0, 0.3, 11.5),\n    ]\n\n    def find_transition_location(params):\n        \"\"\"\n        Calculates the transition location for a single set of parameters.\n        \"\"\"\n        U_inf, nu, x0, x_end, m, c0, Re_crit, Re_ref, p, beta, N_th = params\n        \n        # 1. Discretize the domain\n        num_points = 20001  # Sufficiently large number for accuracy\n        x_grid = np.linspace(x0, x_end, num_points)\n\n        # 2. Calculate the local amplification rate s(x)\n        \n        # 2a. External velocity U_e(x)\n        # Handle the case x0=0 to avoid division by zero, although not needed for these test cases.\n        if x0 == 0:\n            # For Falkner-Skan, x=0 is a singularity if m is not 0 or 1.\n            # Assume Ue=U_inf if x0=0 (or handle as per specific model extension).\n            # This branch is not taken for the given problem.\n            Ue_grid = np.full_like(x_grid, U_inf)\n        else:\n            Ue_grid = U_inf * (x_grid / x0)**m\n\n        # 2b. Local Reynolds number Re_x(x)\n        Rex_grid = Ue_grid * x_grid / nu\n\n        # 2c. Amplification rate s(x)\n        s_grid = np.zeros_like(x_grid)\n        \n        # Create a mask for points where instability can occur\n        mask = Rex_grid >= Re_crit\n        \n        # Calculate s(x) only for the unstable region\n        if np.any(mask):\n            F_pg = 1.0 - r * m\n            \n            # Select values for the unstable region\n            Ue_masked = Ue_grid[mask]\n            Rex_masked = Rex_grid[mask]\n            \n            term1 = F_pg * c0 * Ue_masked / nu\n            term2 = ((Rex_masked - Re_crit) / Re_ref)**p\n            term3 = np.exp(-beta * Rex_masked / Re_ref)\n            \n            s_grid[mask] = term1 * term2 * term3\n\n        # 3. Compute the cumulative growth factor N(x)\n        # Use scipy's cumulative_trapezoid for accurate integration\n        N_grid = cumulative_trapezoid(s_grid, x_grid, initial=0)\n\n        # 4. Determine the transition location\n        # Find indices where N surpasses the threshold N_th\n        crossing_indices = np.where(N_grid >= N_th)[0]\n\n        if crossing_indices.size == 0:\n            # Transition does not occur within the domain\n            return -1.0\n        else:\n            # First index where N >= N_th\n            idx = crossing_indices[0]\n            \n            if idx == 0:\n                # This would mean N(x0) >= N_th, transition is at the start\n                return x0\n\n            # Use linear interpolation to find the precise crossing point\n            x_prev, x_curr = x_grid[idx - 1], x_grid[idx]\n            N_prev, N_curr = N_grid[idx - 1], N_grid[idx]\n            \n            # Avoid division by zero if N_curr == N_prev\n            if N_curr == N_prev:\n                 return x_prev\n\n            xt = x_prev + (x_curr - x_prev) * (N_th - N_prev) / (N_curr - N_prev)\n            return xt\n\n    results = []\n    for case in test_cases:\n        xt = find_transition_location(case)\n        # 5. Format output\n        if xt == -1.0:\n            # As per instruction: \"the corresponding entry must be -1.0000\"\n            results.append(\"-1.0000\")\n        else:\n            results.append(f\"{xt:.4f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}