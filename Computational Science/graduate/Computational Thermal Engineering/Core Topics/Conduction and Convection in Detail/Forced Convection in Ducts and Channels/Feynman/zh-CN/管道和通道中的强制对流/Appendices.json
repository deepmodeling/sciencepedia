{
    "hands_on_practices": [
        {
            "introduction": "现实世界中的热力系统通常涉及跨越多个部件的多种传热模式。热阻网络的概念将复杂的系统简化为电路类比，使分析变得易于处理。本练习将通过系统地推导从内部对流到外部翅片表面的每个热阻，并计算整体系统性能，来磨练您对实际换热器——翅片管——进行建模的技能 。",
            "id": "3955569",
            "problem": "一个长度为 $L$ 的圆形管道承载着体温为 $T_b$ 的热流体，并经历稳定、充分发展的内部强制对流。该管道的内半径为 $r_i$，壁厚为 $t_w$，因此外半径为 $r_o = r_i + t_w$。管壁是均匀的，导热系数为 $k_w$。管道的外表面安装了 $N$ 个相同的、均匀分布的圆柱形针状翅片（圆形杆），其半径为 $a$，高度为 $H_f$，由导热系数为 $k_f$ 的材料制成。周围环境的温度均匀为 $T_{\\infty}$，外部流动在所有暴露表面上产生一个均匀的外部对流换热系数 $h_o$。内壁的内部对流系数为 $h_i$。假设管壁和翅片中的轴向导热可以忽略，系统处于稳态，且翅片尖端是绝热的。翅片附着在圆柱形外壁上，每个翅片的根部温度等于外壁在 $r_o$ 处的温度。将翅片视为一维扩展表面，仅沿其侧面与环境进行热交换（由于绝热尖端假设，无尖端对流）。\n\n仅从牛顿冷却定律和傅里叶导热定律的基本定义出发，并通过翅片上的微分能量平衡严格处理扩展表面效应，完成以下任务：\n\n1. 推导一个热阻网络，该网络通过三个串联元件将主流体温度 $T_b$ 与环境温度 $T_{\\infty}$ 连接起来：管道内部的内对流，通过圆柱壁的径向导热，以及由针状翅片增强的外对流。用考虑翅片效率的有效外部面积，明确表示等效的外部对流热阻。\n\n2. 根据您的热阻网络，推导基于外圆柱面积的总传热系数 $U_o$ 的符号表达式，其定义关系为 $q = U_o A_o \\left(T_b - T_{\\infty}\\right)$，其中 $A_o = 2 \\pi r_o L$。\n\n3. 使用您推导的表达式，为以下几何和热物理参数计算 $U_o$ 的数值：\n- $L = 1.5$ m,\n- $r_i = 0.025$ m,\n- $t_w = 0.003$ m,\n- $k_w = 16$ W m$^{-1}$ K$^{-1}$,\n- $h_i = 800$ W m$^{-2}$ K$^{-1}$,\n- $h_o = 12$ W m$^{-2}$ K$^{-1}$,\n- $N = 132$,\n- $a = 0.002$ m,\n- $H_f = 0.015$ m,\n- $k_f = 200$ W m$^{-1}$ K$^{-1}$。\n\n对于翅片，将每个翅片视为具有圆形截面和绝热尖端的直针状翅片，并从其控制的一维翅片方程推导其效率。在计算等效外部对流热阻时，将翅片之间的基底面积视为直接暴露于对流中，而翅片侧面积则通过翅片效率来贡献。将您最终的 $U_o$ 数值四舍五入到四位有效数字。将 $U_o$ 的最终答案以 W m$^{-2}$ K$^{-1}$ 表示。",
            "solution": "通过构建从主流体到周围空气的热阻网络来分析该问题。总热阻是三个串联热阻之和：内对流、通过管道壁的导热以及来自带翅片外表面的对流。\n\n### 第1部分：热阻网络的推导\n\n从温度为 $T_b$ 的主流体到温度为 $T_{\\infty}$ 的周围环境的总传热速率 $q$ 可以用一个热路来表示。温差 $T_b - T_{\\infty}$ 驱动热流通过一系列热阻。\n\n**1. 内对流热阻, $R_i$**\n从主流体到管道内壁的传热遵循牛顿冷却定律：\n$$q = h_i A_i (T_b - T_{w,i})$$\n其中 $h_i$ 是内对流换热系数，$A_i = 2 \\pi r_i L$ 是管道的内表面积，$T_{w,i}$ 是内壁的温度。这种关系可以用热阻 $R_i$ 来表示：\n$$q = \\frac{T_b - T_{w,i}}{R_i} \\quad \\implies \\quad R_i = \\frac{1}{h_i A_i} = \\frac{1}{2 \\pi r_i L h_i}$$\n\n**2. 壁导热热阻, $R_w$**\n热量通过圆柱壁径向向外传导。对于长度为 $L$ 的空心圆柱体，圆柱坐标系下的傅里叶导热定律为：\n$$q = -k_w A(r) \\frac{dT}{dr} = -k_w (2 \\pi r L) \\frac{dT}{dr}$$\n分离变量并从内半径 $r_i$（温度为 $T_{w,i}$）积分到外半径 $r_o = r_i + t_w$（温度为 $T_{w,o}$）：\n$$\\int_{r_i}^{r_o} \\frac{dr}{r} = -\\frac{2 \\pi k_w L}{q} \\int_{T_{w,i}}^{T_{w,o}} dT$$\n$$\\ln\\left(\\frac{r_o}{r_i}\\right) = \\frac{2 \\pi k_w L}{q} (T_{w,i} - T_{w,o})$$\n导热传热速率为 $q = \\frac{T_{w,i} - T_{w,o}}{R_w}$，由此定义壁导热热阻为：\n$$R_w = \\frac{\\ln(r_o/r_i)}{2 \\pi k_w L}$$\n\n**3. 外对流热阻, $R_{ext}$**\n外表面将热量传递给周围的空气。该表面由基底（无翅片）面积 $A_p$ 和 $N$ 个翅片的表面积组成。来自外表面的总传热是来自这两种表面的传热之和，两者都处于根部温度 $T_{w,o}$：\n$$q = q_p + q_f$$\n来自基底面积的传热为：\n$$q_p = h_o A_p (T_{w,o} - T_{\\infty})$$\n基底面积是圆柱体的总外表面积 $A_o = 2 \\pi r_o L$ 减去 $N$ 个翅片的根部面积 $A_{b,f} = N \\pi a^2$。\n$$A_p = A_o - N \\pi a^2 = 2 \\pi r_o L - N \\pi a^2$$\n单个翅片的传热 $q_{fin}$ 由 $q_{fin} = \\eta_f q_{max}$ 给出，其中 $\\eta_f$ 是翅片效率，$q_{max}$ 是在整个翅片都处于根部温度 $T_{w,o}$ 时的理想传热。\n$$q_{max} = h_o A_f (T_{w,o} - T_{\\infty})$$\n这里，$A_f$ 是单个翅片的传热表面积。对于具有绝热尖端的圆柱形针状翅片，这是侧表面积：\n$$A_f = (2 \\pi a) H_f$$\n来自所有 $N$ 个翅片的总传热为：\n$$q_f = N q_{fin} = N \\eta_f h_o A_f (T_{w,o} - T_{\\infty})$$\n为了找到翅片效率 $\\eta_f$，我们必须求解从翅片微分单元上的能量平衡推导出来的一维稳态翅片方程：\n$$\\frac{d^2\\theta}{dx^2} - m^2 \\theta = 0$$\n其中 $\\theta(x) = T(x) - T_{\\infty}$ 是过余温度，$x$ 是沿翅片轴的坐标，$m = \\sqrt{\\frac{h_o P}{k_f A_c}}$。对于圆柱形翅片，周长为 $P=2\\pi a$，横截面积为 $A_c = \\pi a^2$，所以：\n$$m = \\sqrt{\\frac{h_o (2\\pi a)}{k_f (\\pi a^2)}} = \\sqrt{\\frac{2h_o}{k_f a}}$$\n边界条件是：\n1. 根部温度：$\\theta(0) = T_{w,o} - T_{\\infty} = \\theta_b$。\n2. 绝热尖端：$\\frac{d\\theta}{dx}\\bigg|_{x=H_f} = 0$。\n满足这些边界条件的微分方程的解是 $\\theta(x) = \\theta_b \\frac{\\cosh(m(H_f - x))}{\\cosh(mH_f)}$。\n来自翅片的传热速率是在 $x=0$ 处传导进其根部的热量：\n$$q_{fin} = -k_f A_c \\frac{d\\theta}{dx}\\bigg|_{x=0} = -k_f A_c \\left( -\\theta_b m \\frac{\\sinh(mH_f)}{\\cosh(mH_f)} \\right) = \\theta_b \\sqrt{h_o P k_f A_c} \\tanh(mH_f)$$\n翅片效率定义为 $\\eta_f = \\frac{q_{fin}}{q_{max}} = \\frac{q_{fin}}{h_o A_f \\theta_b}$。\n$$\\eta_f = \\frac{\\sqrt{h_o P k_f A_c} \\tanh(mH_f)}{h_o P H_f \\theta_b} \\frac{\\theta_b}{\\theta_b} = \\frac{\\sqrt{k_f A_c/(h_o P)}}{H_f} \\tanh(mH_f) = \\frac{1/m}{H_f} \\tanh(mH_f) = \\frac{\\tanh(mH_f)}{mH_f}$$\n来自外表面的总传热为：\n$$q = h_o A_p (T_{w,o} - T_{\\infty}) + N \\eta_f h_o A_f (T_{w,o} - T_{\\infty}) = h_o (A_p + N \\eta_f A_f) (T_{w,o} - T_{\\infty})$$\n这可以写成 $q = \\frac{T_{w,o} - T_{\\infty}}{R_{ext}}$，由此定义了等效外部对流热阻：\n$$R_{ext} = \\frac{1}{h_o (A_p + N \\eta_f A_f)} = \\frac{1}{h_o [ (2 \\pi r_o L - N \\pi a^2) + N \\eta_f (2 \\pi a H_f) ]}$$\n\n热阻网络是三个串联的热阻：\n$T_b \\xrightarrow{R_i} T_{w,i} \\xrightarrow{R_w} T_{w,o} \\xrightarrow{R_{ext}} T_{\\infty}$\n总热阻为 $R_{total} = R_i + R_w + R_{ext}$。\n\n### 第2部分：总传热系数 $U_o$ 的推导\n\n总传热速率由 $q = \\frac{T_b - T_{\\infty}}{R_{total}}$ 定义。基于外表面积的总传热系数 $U_o$ 由 $q = U_o A_o (T_b - T_{\\infty})$ 定义。\n将这两个 $q$ 的表达式相等，得到：\n$$U_o A_o = \\frac{1}{R_{total}} = \\frac{1}{R_i + R_w + R_{ext}}$$\n$$U_o = \\frac{1}{A_o (R_i + R_w + R_{ext})} = \\frac{1}{A_o R_i + A_o R_w + A_o R_{ext}}$$\n我们可以计算分母中的每一项：\n$$A_o R_i = (2 \\pi r_o L) \\left( \\frac{1}{2 \\pi r_i L h_i} \\right) = \\frac{r_o}{r_i h_i}$$\n$$A_o R_w = (2 \\pi r_o L) \\left( \\frac{\\ln(r_o/r_i)}{2 \\pi k_w L} \\right) = \\frac{r_o \\ln(r_o/r_i)}{k_w}$$\n$$A_o R_{ext} = \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} = \\frac{2 \\pi r_o L}{h_o [ (2 \\pi r_o L - N \\pi a^2) + N \\eta_f (2 \\pi a H_f) ]}$$\n$U_o$ 的表达式是这些项之和的倒数，这些项代表每单位外表面积的总热阻：\n$$U_o = \\left( \\frac{r_o}{r_i h_i} + \\frac{r_o \\ln(r_o/r_i)}{k_w} + \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} \\right)^{-1}$$\n其中 $A_o = 2 \\pi r_o L$，$A_p = A_o - N\\pi a^2$，$A_f = 2 \\pi a H_f$，以及 $\\eta_f = \\frac{\\tanh(mH_f)}{mH_f}$，其中 $m = \\sqrt{\\frac{2h_o}{k_f a}}$。\n\n### 第3部分：$U_o$ 的数值计算\n\n给定的参数是：\n$L = 1.5$ m, $r_i = 0.025$ m, $t_w = 0.003$ m, $k_w = 16$ W m$^{-1}$ K$^{-1}$, $h_i = 800$ W m$^{-2}$ K$^{-1}$, $h_o = 12$ W m$^{-2}$ K$^{-1}$, $N = 132$, $a = 0.002$ m, $H_f = 0.015$ m, $k_f = 200$ W m$^{-1}$ K$^{-1}$。\n\n首先，我们计算几何参数和翅片参数。\n外半径：$r_o = r_i + t_w = 0.025 + 0.003 = 0.028$ m。\n翅片参数 $m$：\n$$m = \\sqrt{\\frac{2 h_o}{k_f a}} = \\sqrt{\\frac{2(12)}{200(0.002)}} = \\sqrt{\\frac{24}{0.4}} = \\sqrt{60} \\approx 7.74597 \\text{ m}^{-1}$$\n乘积 $mH_f$：\n$$mH_f = \\sqrt{60} \\times 0.015 \\approx 0.116190$$\n翅片效率 $\\eta_f$：\n$$\\eta_f = \\frac{\\tanh(mH_f)}{mH_f} = \\frac{\\tanh(0.116190)}{0.116190} = \\frac{0.115688}{0.116190} \\approx 0.99568$$\n接下来，我们计算面积：\n外表面积（无翅片）：$A_o = 2 \\pi r_o L = 2 \\pi (0.028)(1.5) \\approx 0.263894$ m$^2$。\n总翅片根部面积：$N A_c = N (\\pi a^2) = 132 \\times \\pi (0.002)^2 \\approx 0.0016588$ m$^2$。\n基底面积：$A_p = A_o - N A_c = 0.263894 - 0.0016588 \\approx 0.262235$ m$^2$。\n总翅片侧面积：$N A_f = N (2 \\pi a H_f) = 132 \\times 2 \\pi (0.002)(0.015) \\approx 0.024881$ m$^2$。\n\n现在，我们为 $\\frac{1}{U_o}$ 表达式计算各个热阻项（每单位外表面积的总热阻，$R''_{total}$）：\n$$R''_{i,o} = \\frac{r_o}{r_i h_i} = \\frac{0.028}{0.025 \\times 800} = \\frac{0.028}{20} = 0.0014 \\text{ m}^2\\text{K/W}$$\n$$R''_{w,o} = \\frac{r_o \\ln(r_o/r_i)}{k_w} = \\frac{0.028 \\ln(0.028/0.025)}{16} = \\frac{0.028 \\ln(1.12)}{16} \\approx \\frac{0.028(0.113329)}{16} \\approx 0.0001983 \\text{ m}^2\\text{K/W}$$\n$$R''_{ext,o} = \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} = \\frac{0.263894}{12 \\times (0.262235 + 0.99568 \\times 0.024881)} = \\frac{0.263894}{12 \\times (0.262235 + 0.024775)} = \\frac{0.263894}{12 \\times 0.28701} \\approx 0.076621 \\text{ m}^2\\text{K/W}$$\n每单位外表面积的总热阻为：\n$$R''_{total} = \\frac{1}{U_o} = R''_{i,o} + R''_{w,o} + R''_{ext,o} = 0.0014 + 0.0001983 + 0.076621 = 0.0782193 \\text{ m}^2\\text{K/W}$$\n总传热系数为：\n$$U_o = \\frac{1}{R''_{total}} = \\frac{1}{0.0782193} \\approx 12.7846 \\text{ W m}^{-2}\\text{K}^{-1}$$\n四舍五入到四位有效数字，我们得到 $U_o = 12.78$ W m$^{-2}$ K$^{-1}$。",
            "answer": "$$\n\\boxed{12.78}\n$$"
        },
        {
            "introduction": "准确预测湍流管道流中的传热对于设计高效的热力系统至关重要。本练习利用著名的 Gnielinski 关联式，这是一个半经验公式，它将传热与流体摩擦联系起来，体现了雷诺类比的思想。通过实施此关联式并对湍流普朗特数（$Pr_t$）进行敏感性分析，您将获得使用行业标准工具的实践经验，并理解湍流模型假设如何影响传热预测 。",
            "id": "3955575",
            "problem": "考虑在恒定直径的直圆形管道中，单相牛顿流体的充分发展的湍流强制对流，壁面热流均匀且轴向热传导可忽略。流动是统计稳定且不可压缩的。您将使用一个联系湍流内流动量和热量传递的经典关联式来计算无量纲传热，并结合从隐式光滑至粗糙壁面关系式获得的湍流摩擦因子。然后，您将使用一个基于涉及湍流普朗特数的涡扩散闭合的灵敏度模型来增强该传热关联式，并量化其相对于湍流普朗特数的灵敏度。\n\n将使用的基本依据和定义：\n- 湍流内流中的动量和能量守恒，由雷诺平均方程表示。\n- 雷诺数定义为 $Re = \\dfrac{\\rho U D}{\\mu}$，普朗特数定义为 $Pr = \\dfrac{\\nu}{\\alpha}$，湍流普朗特数定义为 $Pr_t = \\dfrac{\\nu_t}{\\alpha_t}$，其中 $\\nu = \\mu/\\rho$ 是运动粘度，$\\alpha$ 是分子热扩散率，$\\nu_t$ 和 $\\alpha_t$ 是在涡扩散闭合下获得的湍流输运系数。\n- 对于具有相对粗糙度 $\\varepsilon/D$ 的圆形管道中的湍流，达西摩擦因子 $f_D$ 通过求解关于 $f_D$ 的隐式Colebrook关系式获得。\n- 该传热关联式是用于管道的经典湍流强制对流关联式，它以一种与内流的动量-传热类比相一致的非线性耦合方式依赖于 $Re$、$Pr$ 和 $f_D$。在您的推理中，请勿使用任何非基于此基础推导的简化公式。\n\n灵敏度模型说明：\n- 在对数层中，假设采用混合长度涡粘性闭合，冯·卡门常数 $\\kappa = 0.41$。\n- 令代表性的无量纲壁面距离为 $y^+ = 30$，以表征缓冲层/对数层的行为。\n- 在这些假设下，将在代表性位置的湍流动量扩散率与分子动量扩散率之比近似为 $\\dfrac{\\nu_t}{\\nu} \\approx \\kappa y^+$。\n- 使用 $Pr = \\nu/\\alpha$ 和 $Pr_t = \\nu_t/\\alpha_t$，将在代表性位置的总热扩散率与分子热扩散率之比近似为 $1 + \\dfrac{\\alpha_t}{\\alpha} = 1 + \\dfrac{\\nu_t/\\nu}{Pr_t/Pr} = 1 + \\kappa y^+ \\dfrac{Pr}{Pr_t}$。\n- 将温度对数律指数贡献的乘法修正因子定义为 $\\phi(Pr_t) = \\left(1 + \\kappa y^+ \\dfrac{Pr}{Pr_t}\\right)^{-2/3}$。该因子修正了管道经典湍流传热关联式分母中依赖于分子普朗特数的部分。\n\n计算任务：\n1. 对于每个测试案例，在给定湍流区中的 $Re$ 和 $\\varepsilon/D$ 的情况下，求解Colebrook方程以获得 $f_D$。假设定义域为 $3 \\times 10^3 \\le Re \\le 5 \\times 10^6$ 和 $0 \\le \\varepsilon/D \\le 5 \\times 10^{-3}$。\n2. 使用依赖于 $Re$、$Pr$ 和 $f_D$ 的圆形管道经典关联式计算基准湍流努塞尔数 $Nu_{\\text{base}}$。\n3. 应用灵敏度模型，将分母中依赖于分子普朗特数的指数贡献替换为使用 $\\phi(Pr_t)$ 修正后的值，并计算在名义湍流普朗特数 $Pr_t = 0.85$ 时的 $Nu_{\\text{corr}}(Pr_t)$。\n4. 通过使用中心有限差分和微小增量 $\\Delta Pr_t = 0.05$ 计算数值导数 $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\big|_{Pr_t=0.85}$ 来量化灵敏度。\n5. 所有输入均为无量纲；所有输出也均为无量纲。努塞尔数是无量纲的。不涉及角度单位。\n\n测试套件：\n- 案例1: $Re = 1.0 \\times 10^5$, $Pr = 0.7$, $\\varepsilon/D = 0.0$。\n- 案例2: $Re = 5.0 \\times 10^4$, $Pr = 7.0$, $\\varepsilon/D = 0.0$。\n- 案例3: $Re = 1.0 \\times 10^4$, $Pr = 100.0$, $\\varepsilon/D = 2.0 \\times 10^{-4}$。\n- 案例4: $Re = 3.0 \\times 10^3$, $Pr = 0.7$, $\\varepsilon/D = 0.0$。\n- 案例5: $Re = 3.0 \\times 10^4$, $Pr = 200.0$, $\\varepsilon/D = 5.0 \\times 10^{-4}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试案例的结果，结果为逗号分隔的列表，并用方括号括起来，顺序如下：\n  $[Nu_{\\text{base}}^{(1)}, Nu_{\\text{corr}}^{(1)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(1)}, Nu_{\\text{base}}^{(2)}, Nu_{\\text{corr}}^{(2)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(2)}, \\dots, Nu_{\\text{base}}^{(5)}, Nu_{\\text{corr}}^{(5)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(5)}]$。\n- 将所有数字表示为浮点数值。",
            "solution": "解决方案遵循所提供的原理和方程，分步展开。\n\n**第1步：达西摩擦因子 ($f_D$) 计算**\n\n管道中充分发展的湍流的达西摩擦因子 $f_D$ 由Colebrook-White方程确定。这是一个隐式关联式，它将 $f_D$ 与雷诺数 $Re$ 和管道壁的相对粗糙度 $\\varepsilon/D$ 联系起来。该方程由下式给出：\n$$\n\\frac{1}{\\sqrt{f_D}} = -2.0 \\log_{10} \\left( \\frac{\\varepsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f_D}} \\right)\n$$\n该方程是超越方程，无法解析求解 $f_D$。因此，对于由一对 ($Re$, $\\varepsilon/D$) 定义的每个测试案例，必须采用数值求根算法。我们定义一个函数 $g(f_D)$，使得找到 $g(f_D) = 0$ 的根即可得到所需的 $f_D$ 值：\n$$\ng(f_D) = \\frac{1}{\\sqrt{f_D}} + 2.0 \\log_{10} \\left( \\frac{\\varepsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f_D}} \\right)\n$$\n该方程将在一个物理上合理的范围内（例如 $f_D \\in [0.001, 0.1]$）对 $f_D$进行数值求解。\n\n**第2步：基准努塞尔数 ($Nu_{\\text{base}}$) 计算**\n\n问题指定使用与动量-传热类比一致的“用于管道的经典湍流强制对流关联式”。Gnielinski关联式 (1976) 是在给定条件下（圆形管道中充分发展的湍流，壁面热流均匀，适用于 $0.5 \\le Pr \\le 2000$ 和 $3 \\times 10^3 \\le Re \\le 5 \\times 10^6$）的标准且最合适的选择。基准努塞尔数 $Nu_{\\text{base}}$ 使用此关联式计算：\n$$\nNu_{\\text{base}} = \\frac{(f_D/8)(Re-1000)Pr}{1 + 12.7\\sqrt{f_D/8}(Pr^{2/3}-1)}\n$$\n此处，$f_D$ 是第1步中通过求解Colebrook方程获得的值，$Re$ 和 $Pr$ 是特定测试案例的雷诺数和普朗特数。\n\n**第3步：修正后的努塞尔数 ($Nu_{\\text{corr}}$) 计算**\n\n问题引入了一个灵敏度模型来增强传热关联式。该模型引入了一个修正因子 $\\phi(Pr_t)$，它修改了Gnielinski关联式分母中分子普朗特数的贡献。该修正因子定义为：\n$$\n\\phi(Pr_t) = \\left(1 + \\kappa y^+ \\frac{Pr}{Pr_t}\\right)^{-2/3}\n$$\n给定的常数为冯·卡门常数 $\\kappa = 0.41$ 和代表性的无量纲壁面距离 $y^+ = 30$。湍流普朗特数为 $Pr_t$。\n\n问题陈述 $\\phi(Pr_t)$ 是“温度对数律指数贡献的乘法修正因子”。在Gnielinski关联式的背景下，这对应于 $Pr^{2/3}$ 项。因此，为获得修正后的努塞尔数 $Nu_{\\text{corr}}$，我们将原始公式中的 $Pr^{2/3}$ 替换为 $Pr^{2/3} \\phi(Pr_t)$：\n$$\nNu_{\\text{corr}}(Pr_t) = \\frac{(f_D/8)(Re-1000)Pr}{1 + 12.7\\sqrt{f_D/8}\\left(Pr^{2/3}\\phi(Pr_t) - 1\\right)}\n$$\n对于計算任務3，此值在名义湍流普朗特数 $Pr_t = 0.85$ 处计算。\n\n**第4步：灵敏度计算**\n\n修正后的努塞尔数相对于湍流普朗特数的灵敏度通过在 $Pr_t = 0.85$ 处计算的数值导数 $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}$来量化。问题指定使用中心有限差分格式，增量为 $\\Delta Pr_t = 0.05$。公式为：\n$$\n\\frac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\bigg|_{Pr_t=0.85} \\approx \\frac{Nu_{\\text{corr}}(0.85 + \\Delta Pr_t) - Nu_{\\text{corr}}(0.85 - \\Delta Pr_t)}{2 \\Delta Pr_t}\n$$\n代入给定值 $Pr_t = 0.85$ 和 $\\Delta Pr_t = 0.05$，导数近似为：\n$$\n\\frac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\bigg|_{Pr_t=0.85} \\approx \\frac{Nu_{\\text{corr}}(0.90) - Nu_{\\text{corr}}(0.80)}{0.1}\n$$\n这需要计算在另外两个 $Pr_t$ 值（$0.80$ 和 $0.90$）下的 $Nu_{\\text{corr}}$。\n\n**计算流程摘要**\n\n对于由元组 ($Re, Pr, \\varepsilon/D$) 指定的每个测试案例：\n1.  使用给定的 $Re$ 和 $\\varepsilon/D$ 求解Colebrook方程得到 $f_D$。\n2.  使用计算出的 $f_D$ 和给定的 $Re$、$Pr$ 通过Gnielinski关联式计算 $Nu_{\\text{base}}$。\n3.  使用修正的Gnielinski关联式计算 $Nu_{\\text{corr}}(Pr_t=0.85)$。\n4.  使用相同的修正关联式计算 $Nu_{\\text{corr}}(Pr_t=0.80)$ 和 $Nu_{\\text{corr}}(Pr_t=0.90)$。\n5.  使用上一步的值，通过中心差分公式计算灵敏度 $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}$。\n6.  按规定将每个测试案例的三个结果（$Nu_{\\text{base}}$、$Nu_{\\text{corr}}(0.85)$ 和导数）汇编成一个列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing baseline and corrected Nusselt numbers\n    for turbulent forced convection in a duct, along with a sensitivity analysis.\n    \"\"\"\n\n    # Define constants from the problem statement.\n    KAPPA = 0.41\n    Y_PLUS = 30.0\n    PR_T_NOMINAL = 0.85\n    DELTA_PR_T = 0.05\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0e5, 0.7, 0.0),          # Case 1\n        (5.0e4, 7.0, 0.0),          # Case 2\n        (1.0e4, 100.0, 2.0e-4),     # Case 3\n        (3.0e3, 0.7, 0.0),          # Case 4\n        (3.0e4, 200.0, 5.0e-4),     # Case 5\n    ]\n\n    def solve_colebrook(Re, rel_rough):\n        \"\"\"\n        Solves the Colebrook equation for the Darcy friction factor f_D.\n        \n        Args:\n            Re (float): Reynolds number.\n            rel_rough (float): Relative roughness (epsilon/D).\n            \n        Returns:\n            float: Darcy friction factor f_D.\n        \"\"\"\n        if not (Re  2300): # Colebrook is for turbulent flow\n            return 64.0 / Re # Laminar flow, not strictly needed per problem spec\n            \n        # Colebrook equation rearranged to f(f_D) = 0\n        colebrook_func = lambda f_D: 1.0 / np.sqrt(f_D) + 2.0 * np.log10(\n            (rel_rough / 3.7) + (2.51 / (Re * np.sqrt(f_D)))\n        )\n        \n        # Using root_scalar to find the root of the function.\n        # A bracket of [0.001, 0.1] is safe for turbulent flow friction factors.\n        sol = root_scalar(colebrook_func, bracket=[0.001, 0.1], method='brentq')\n        return sol.root\n\n    def calculate_nusselt(Re, Pr, f_D, Pr_t=None):\n        \"\"\"\n        Calculates the Nusselt number using the Gnielinski correlation, with an\n        optional correction based on the turbulent Prandtl number.\n\n        Args:\n            Re (float): Reynolds number.\n            Pr (float): Prandtl number.\n            f_D (float): Darcy friction factor.\n            Pr_t (float, optional): Turbulent Prandtl number. If None, computes\n                                    the baseline Nu. Otherwise, computes the\n                                    corrected Nu.\n\n        Returns:\n            float: Nusselt number.\n        \"\"\"\n        # Common term in Gnielinski correlation\n        f_term = f_D / 8.0\n        \n        # Calculate the molecular prandtl number contribution\n        pr_term_base = Pr**(2.0/3.0)\n        \n        pr_term_modified = pr_term_base\n        if Pr_t is not None:\n            # Apply the sensitivity model correction factor phi(Pr_t)\n            phi = (1.0 + KAPPA * Y_PLUS * Pr / Pr_t)**(-2.0/3.0)\n            pr_term_modified *= phi\n            \n        numerator = f_term * (Re - 1000.0) * Pr\n        denominator = 1.0 + 12.7 * np.sqrt(f_term) * (pr_term_modified - 1.0)\n        \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        Re, Pr, rel_rough = case\n        \n        # 1. Solve for Darcy friction factor\n        f_D = solve_colebrook(Re, rel_rough)\n        \n        # 2. Compute baseline Nusselt number\n        Nu_base = calculate_nusselt(Re, Pr, f_D)\n        \n        # 3. Compute corrected Nusselt number at the nominal Pr_t\n        Nu_corr_nominal = calculate_nusselt(Re, Pr, f_D, Pr_t=PR_T_NOMINAL)\n        \n        # 4. Compute corrected Nu for finite difference calculation\n        Pr_t_plus = PR_T_NOMINAL + DELTA_PR_T\n        Pr_t_minus = PR_T_NOMINAL - DELTA_PR_T\n        \n        Nu_corr_plus = calculate_nusselt(Re, Pr, f_D, Pr_t=Pr_t_plus)\n        Nu_corr_minus = calculate_nusselt(Re, Pr, f_D, Pr_t=Pr_t_minus)\n        \n        # 5. Compute the sensitivity using central finite difference\n        dNu_dPr_t = (Nu_corr_plus - Nu_corr_minus) / (2.0 * DELTA_PR_T)\n        \n        results.extend([Nu_base, Nu_corr_nominal, dNu_dPr_t])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在微流控设备中，像粘性加热这样在宏观尺度上通常可以忽略不计的效应，可能会变得至关重要。本练习要求您使用有限差分法，对包含粘性耗散项的完整能量方程进行数值求解。通过从第一性原理出发建立计算模型来捕捉近壁区域的温度超调，您将直接参与到微观尺度下流体流动与热量生成之间复杂的相互作用中，这是现代热设计的一项关键技能 。",
            "id": "3955530",
            "problem": "考虑一个二维、稳态、不可压缩、充分发展的牛顿流体层流，该流动发生在半高为 $h$、长度为 $L$ 的平面微通道中。轴向坐标为 $x \\in [0,L]$，横向坐标为 $y \\in [0,h]$，其中 $y=0$ 是中心线，$y=h$ 是壁面。轴向速度剖面由经典的平面泊肃叶解给出：$u(y) = u_{\\max} \\left(1 - \\left(\\frac{y}{h}\\right)^2\\right)$，其中 $u_{\\max} = \\frac{3}{2} U$，$U$ 是横截面平均速度。假设物性恒定：密度 $\\rho$、定压比热容 $c_p$、动力粘度 $\\mu$ 和导热系数 $k$。粘性加热通过体积源项 $\\mu \\left(\\frac{du}{dy}\\right)^2$ 进入能量方程。保留轴向热传导，且不采用热力学充分发展的假设。温度场 $T(x,y)$ 满足稳态能量方程\n$$\n\\rho c_p u(y) \\frac{\\partial T}{\\partial x} = k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\mu \\left( \\frac{du}{dy} \\right)^2,\n$$\n边界条件为\n$$\nT(0,y) = T_{\\mathrm{in}}, \\quad T(x,h) = T_w, \\quad \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} = 0, \\quad \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = 0.\n$$\n最后一个条件强制出口处的轴向温度梯度为零。速度剖面的导数为 $\\frac{du}{dy} = -\\frac{2 u_{\\max} y}{h^2}$，因此粘性耗散源项为 $\\mu \\left(\\frac{du}{dy}\\right)^2 = \\mu \\frac{4 u_{\\max}^2 y^2}{h^4}$。热佩克莱特数（Pe）和布林克曼数（Br）分别定义为\n$$\n\\mathrm{Pe} = \\frac{\\rho c_p U h}{k}, \\qquad \\mathrm{Br} = \\frac{\\mu U^2}{k \\Delta T_{\\mathrm{ref}}},\n$$\n其中 $\\Delta T_{\\mathrm{ref}}$ 是一个选定的温标；在本问题中，为报告目的，使用 $\\Delta T_{\\mathrm{ref}} = 1\\,\\mathrm{K}$。目标是计算在高 $\\mathrm{Br}$ 和低 $\\mathrm{Pe}$ 条件下由粘性加热引起的近壁温升过冲，其定义为\n$$\n\\Delta T_{\\mathrm{overshoot}} = \\max_{x \\in [0,L],\\, y \\in [y_*, h)} \\left( T(x,y) - T_w \\right),\n$$\n其中 $y_* = h - \\alpha h$（$\\alpha = 0.1$）指定了一个薄的近壁层（区域 $y \\in [0.9 h, h)$）。将过冲表示为以开尔文（K）为单位的实数。计算方法必须在均匀网格上使用有限差分法数值求解上述边值问题，并采用科学合理的离散化和收敛准则。\n\n从能量守恒出发，结合给定的速度场和粘性耗散，推导出适当的离散方程并加以实现，以计算以下一组物理上合理的微通道案例的 $\\Delta T_{\\mathrm{overshoot}}$。所有案例均设置 $T_{\\mathrm{in}} = T_w = 300\\,\\mathrm{K}$，因此任何温度升高都完全由粘性加热引起：\n\n- 案例 A（理想路径，低 $\\mathrm{Pe}$，中等 $\\mathrm{Br}$，类油流体）：\n  - $\\rho = 900\\,\\mathrm{kg/m^3}$，$c_p = 2000\\,\\mathrm{J/(kg\\,K)}$，$\\mu = 0.20\\,\\mathrm{Pa\\,s}$，$k = 0.14\\,\\mathrm{W/(m\\,K)}$，$U = 0.002\\,\\mathrm{m/s}$，$h = 50\\,\\mu\\mathrm{m}$，$L = 5\\,\\mathrm{mm}$。\n- 案例 B（边界情况，$\\mathrm{Pe}$ 有效为 0，无粘性加热）：\n  - $\\rho = 1000\\,\\mathrm{kg/m^3}$，$c_p = 4180\\,\\mathrm{J/(kg\\,K)}$，$\\mu = 0.001\\,\\mathrm{Pa\\,s}$，$k = 0.60\\,\\mathrm{W/(m\\,K)}$，$U = 0\\,\\mathrm{m/s}$，$h = 50\\,\\mu\\mathrm{m}$，$L = 5\\,\\mathrm{mm}$。\n- 案例 C（边缘情况，较高 $\\mathrm{Pe}$，低 $\\mathrm{Br}$，类水流体）：\n  - $\\rho = 1000\\,\\mathrm{kg/m^3}$，$c_p = 4180\\,\\mathrm{J/(kg\\,K)}$，$\\mu = 0.001\\,\\mathrm{Pa\\,s}$，$k = 0.60\\,\\mathrm{W/(m\\,K)}$，$U = 0.05\\,\\mathrm{m/s}$，$h = 50\\,\\mu\\mathrm{m}$，$L = 5\\,\\mathrm{mm}$。\n- 案例 D（高 $\\mathrm{Br}$ 和低至中等 $\\mathrm{Pe}$，类甘油流体）：\n  - $\\rho = 1260\\,\\mathrm{kg/m^3}$，$c_p = 2400\\,\\mathrm{J/(kg\\,K)}$，$\\mu = 1.50\\,\\mathrm{Pa\\,s}$，$k = 0.285\\,\\mathrm{W/(m\\,K)}$，$U = 0.002\\,\\mathrm{m/s}$，$h = 50\\,\\mu\\mathrm{m}$，$L = 5\\,\\mathrm{mm}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按 $\\left[\\Delta T_{\\mathrm{overshoot}}^{\\mathrm{A}}, \\Delta T_{\\mathrm{overshoot}}^{\\mathrm{B}}, \\Delta T_{\\mathrm{overshoot}}^{\\mathrm{C}}, \\Delta T_{\\mathrm{overshoot}}^{\\mathrm{D}}\\right]$ 的顺序列出上述四个案例的结果。每个值都必须是以开尔文为单位的浮点数，且至少精确到三位有效数字。\n\n以开尔文（K）为单位作答。本问题不使用角度。本问题不出现百分比。",
            "solution": "温度场 $T(x,y)$ 由具有恒定物性的不可压缩流体的稳态能量方程控制，其中包括粘性耗散：\n$$\n\\rho c_p u(y) \\frac{\\partial T}{\\partial x} = k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\mu \\left( \\frac{du}{dy} \\right)^2\n$$\n速度剖面是平面泊肃叶解 $u(y) = u_{\\max} \\left(1 - (y/h)^2\\right)$，其中 $u_{\\max} = \\frac{3}{2}U$。粘性热源项为 $Q(y) = \\mu \\left( \\frac{du}{dy} \\right)^2 = \\mu \\frac{4 u_{\\max}^2 y^2}{h^4}$。\n边界条件为：\n1. 入口：$T(0,y) = T_{\\mathrm{in}}$\n2. 壁面：$T(x,h) = T_w$\n3. 中心线（对称性）：$\\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} = 0$\n4. 出口：$\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = 0$\n\n该椭圆型偏微分方程在均匀的二维网格上使用有限差分法进行数值求解。区域 $[0,L] \\times [0,h]$ 被离散化为一系列网格点 $(x_i, y_j)$，其中 $x_i = i \\Delta x$（$i \\in \\{0, 1, \\dots, N_x\\}$）和 $y_j = j \\Delta y$（$j \\in \\{0, 1, \\dots, N_y\\}$）。这里，$\\Delta x = L/N_x$ 且 $\\Delta y = h/N_y$。网格点上的温度表示为 $T_{i,j} = T(x_i, y_j)$。\n\n控制方程中的所有空间导数均使用二阶中心差分格式进行近似。对于一个内部节点 $(i,j)$，其中 $i \\in \\{1, \\dots, N_x-1\\}$ 且 $j \\in \\{1, \\dots, N_y-1\\}$，离散化方程为：\n$$\n\\rho c_p u_j \\left(\\frac{T_{i+1,j} - T_{i-1,j}}{2 \\Delta x}\\right) = k \\left( \\frac{T_{i+1,j} - 2T_{i,j} + T_{i-1,j}}{(\\Delta x)^2} + \\frac{T_{i,j+1} - 2T_{i,j} + T_{i,j-1}}{(\\Delta y)^2} \\right) + Q_j\n$$\n其中 $u_j = u(y_j)$ 且 $Q_j = Q(y_j)$。对该方程进行重排，以未知温度 $T_{i,j}$ 及其邻点表示，得到一个线性代数方程：\n$$\nT_{i,j} \\left( \\frac{2k}{(\\Delta x)^2} + \\frac{2k}{(\\Delta y)^2} \\right) + T_{i+1,j} \\left( -\\frac{\\rho c_p u_j}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2} \\right) + T_{i-1,j} \\left( \\frac{\\rho c_p u_j}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2} \\right) + T_{i,j+1} \\left( -\\frac{k}{(\\Delta y)^2} \\right) + T_{i,j-1} \\left( -\\frac{k}{(\\Delta y)^2} \\right) = -Q_j\n$$\n该方程构成了一个线性方程组 $A\\mathbf{T} = \\mathbf{b}$ 的基础，其中 $\\mathbf{T}$ 是所有未知温度组成的向量。\n\n边界条件按以下方式并入：\n- **中心线 ($j=0$)：** 对称条件 $\\frac{\\partial T}{\\partial y}=0$ 通过在 $j=-1$ 处使用一个虚拟节点来实现，使得 $T_{i,-1} = T_{i,1}$。二阶导数项变为 $\\frac{\\partial^2 T}{\\partial y^2} \\approx \\frac{2(T_{i,1} - T_{i,0})}{(\\Delta y)^2}$。由此得到的节点 $(i,0)$ 的离散方程为：\n$$\nT_{i,0} \\left( \\frac{2k}{(\\Delta x)^2} + \\frac{2k}{(\\Delta y)^2} \\right) + T_{i+1,0} \\left(-\\frac{\\rho c_p u_0}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2}\\right) + T_{i-1,0} \\left(\\frac{\\rho c_p u_0}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2}\\right) + T_{i,1} \\left(-\\frac{2k}{(\\Delta y)^2}\\right) = -Q_0\n$$\n注意，由于中心线处速度梯度为零，因此 $Q_0=0$。\n\n- **出口 ($i=N_x$)：** 零梯度条件 $\\frac{\\partial T}{\\partial x}=0$ 通过在 $i=N_x+1$ 处使用一个虚拟节点来实现，使得 $T_{N_x+1,j} = T_{N_x-1,j}$。这种代换将对流项简化为零，并修改了轴向扩散项。节点 $(N_x,j)$ 的离散方程变为：\n$$\nT_{N_x,j} \\left( \\frac{2k}{(\\Delta x)^2} + \\frac{2k}{(\\Delta y)^2} \\right) + T_{N_x-1,j} \\left(-\\frac{2k}{(\\Delta x)^2}\\right) + T_{N_x,j+1} \\left(-\\frac{k}{(\\Delta y)^2}\\right) + T_{N_x,j-1} \\left(-\\frac{k}{(\\Delta y)^2}\\right) = -Q_j\n$$\n\n- **狄利克雷边界 ($i=0$ 和 $j=N_y$)：** 温度 $T_{0,j} = T_{\\mathrm{in}}$ 和 $T_{i,N_y} = T_w$ 是已知的。对于涉及这些边界附近节点（即 $i=1$ 或 $j=N_y-1$）的方程，包含这些已知温度的项被移到右侧，成为向量 $\\mathbf{b}$ 的一部分。\n\n未知温度是节点 $(i,j)$ 处的温度，其中 $i \\in \\{1, \\dots, N_x\\}$ 且 $j \\in \\{0, \\dots, N_y-1\\}$。这些节点被映射到一个大小为 $N_x \\times N_y$ 的单一向量 $\\mathbf{T}$ 中。根据所有未知节点的离散方程，构造一个大型稀疏矩阵 $A$ 和一个向量 $\\mathbf{b}$。得到的线性系统使用直接稀疏求解器高效求解，具体是 `scipy.sparse.linalg.spsolve`。\n\n在求解未知温度后，解向量 $\\mathbf{T}$ 被重塑为一个 $N_x \\times N_y$ 的数组。然后将该解与已知的边界温度相结合，形成在完整的 $(N_x+1) \\times (N_y+1)$ 网格上的完整温度场。\n\n最后，根据其定义计算近壁温升过冲 $\\Delta T_{\\mathrm{overshoot}}$：\n$$\n\\Delta T_{\\mathrm{overshoot}} = \\max_{x \\in [0,L],\\, y \\in [y_*, h)} \\left( T(x,y) - T_w \\right)\n$$\n其中 $y_* = 0.9h$。这通过在离散域 $i \\in \\{0, \\dots, N_x\\}$ 和 $j \\in \\{j_*, \\dots, N_y-1\\}$（其中 $j_* = \\mathrm{round}(0.9 N_y)$）上取 $(T_{i,j} - T_w)$ 的最大值来找到。\n\n对于案例 B，其中平均速度 $U=0\\,\\mathrm{m/s}$，速度剖面 $u(y)$ 在各处恒为零。因此，对流项 $\\rho c_p u \\frac{\\partial T}{\\partial x}$ 和粘性耗散项 $\\mu (\\frac{du}{dy})^2$ 均消失。能量方程简化为拉普拉斯方程 $\\nabla^2 T = 0$。给定边界条件 $T(0,y) = T_{\\mathrm{in}} = 300\\,\\mathrm{K}$ 和 $T(x,h) = T_w = 300\\,\\mathrm{K}$，以及另外两个边界上的零通量条件，其唯一解是一个均匀温度场 $T(x,y) = 300\\,\\mathrm{K}$。因此，温升过冲必须恰好为 $0\\,\\mathrm{K}$。这可作为对数值实现的一个验证。其他案例涉及非零流动和耗散，会导致非平凡的温度场和可能非零的过冲。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve_case(params):\n    \"\"\"\n    Solves the 2D steady-state energy equation for flow in a microchannel.\n    \"\"\"\n    rho, cp, mu, k_th, U, h, L, T_in, T_w = params\n\n    # Grid parameters\n    Nx = 250  # Number of grid points in x-direction\n    Ny = 50   # Number of grid points in y-direction (in the half-height)\n\n    dx = L / Nx\n    dy = h / Ny\n\n    # Grid coordinates\n    x = np.linspace(0, L, Nx + 1)\n    y = np.linspace(0, h, Ny + 1)\n\n    # Velocity profile and viscous dissipation source term\n    u_max = 1.5 * U\n    \n    # Evaluate at y_j for j=0..Ny-1\n    y_nodes = y[:Ny]\n    u_profile = u_max * (1 - (y_nodes / h)**2)\n    \n    # du/dy = -2 * u_max * y / h^2\n    # Q(y) = mu * (du/dy)^2 = mu * 4 * u_max^2 * y^2 / h^4\n    Q_source = mu * 4 * u_max**2 * y_nodes**2 / h**4\n\n    # Special case: no flow\n    if U == 0:\n        return 0.0\n\n    # System size\n    num_unknowns = Nx * Ny\n    A = sparse.lil_matrix((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    # Populate the A matrix and b vector\n    # Unknowns are T_ij for i in [1, Nx] and j in [0, Ny-1]\n    # Mapping from (i, j) to 1D index k: k = (i - 1) * Ny + j\n    for i in range(1, Nx + 1):\n        for j in range(Ny):\n            k_idx = (i - 1) * Ny + j\n            \n            # --- Source term ---\n            b[k_idx] = -Q_source[j]\n\n            # --- Central diagonal coefficient for T_ij ---\n            # Default value, modified by Neumann boundaries\n            A[k_idx, k_idx] = 2 * k_th / dx**2 + 2 * k_th / dy**2\n\n            # --- T_{i+1,j} coefficient ---\n            if i  Nx:\n                u_j = u_profile[j]\n                A[k_idx, k_idx + Ny] = -rho * cp * u_j / (2 * dx) - k_th / dx**2\n            # At i=Nx (outlet), the grad T = 0 condition means no T_{i+1,j} term.\n            \n            # --- T_{i-1,j} coefficient ---\n            if i  1:\n                u_j = u_profile[j]\n                A[k_idx, k_idx - Ny] = rho * cp * u_j / (2 * dx) - k_th / dx**2\n            elif i == 1: # Inlet boundary\n                u_j = u_profile[j]\n                b[k_idx] -= (rho * cp * u_j / (2 * dx) - k_th / dx**2) * T_in\n\n            # --- T_{i,j+1} coefficient ---\n            if j  Ny - 1:\n                A[k_idx, k_idx + 1] = -k_th / dy**2\n            elif j == Ny - 1: # Wall boundary\n                b[k_idx] -= (-k_th / dy**2) * T_w\n\n            # --- T_{i,j-1} coefficient ---\n            if j  0:\n                A[k_idx, k_idx - 1] = -k_th / dy**2\n            # At j=0 (centerline), symmetry requires special handling below.\n\n    # Apply special boundary conditions by overwriting rows\n    \n    # Centerline (j=0)\n    for i in range(1, Nx + 1):\n        k_idx = (i - 1) * Ny + 0\n        u_0 = u_profile[0]\n        # Modify T_{i,1} coefficient and remove T_{i,-1} term\n        # The equation for T_i,0 involves T_i,1, so the change is at T_i,1's coefficient\n        # From derivation: A_i,1 coeff is -2k/dy^2\n        A[k_idx, k_idx + 1] = -2 * k_th / dy**2\n\n    # Outlet (i=Nx)\n    for j in range(Ny):\n        k_idx = (Nx - 1) * Ny + j\n        # Modify T_{i-1,j} coefficient and remove T_{i+1,j} term\n        # From derivation: A_i-1,j coeff is -2k/dx^2\n        if i  1: # Should always be true since i=Nx\n          A[k_idx, k_idx - Ny] = -2 * k_th / dx**2\n        \n    # Solve the system\n    A = A.tocsr()\n    T_sol = spsolve(A, b)\n\n    # Reconstruct the full temperature field\n    T_full = np.full((Nx + 1, Ny + 1), T_in)\n    T_full[:, Ny] = T_w\n    \n    T_unknowns = T_sol.reshape((Nx, Ny))\n    T_full[1:, :Ny] = T_unknowns\n\n    # Calculate overshoot\n    j_star = int(0.9 * Ny)\n    # Search region is y in [0.9h, h), corresponding to j in [j_star, Ny-1]\n    # x is over the entire domain, i in [0, Nx]\n    near_wall_region = T_full[:, j_star:Ny]\n    \n    # Ensure region is not empty\n    if near_wall_region.size == 0:\n        return 0.0\n\n    delta_T_overshoot = np.max(near_wall_region - T_w)\n    \n    # Return non-negative overshoot\n    return max(0.0, delta_T_overshoot)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # (rho, cp, mu, k, U, h, L)\n    # Common params\n    T_in = 300.0  # K\n    T_w = 300.0   # K\n    h_val = 50e-6 # m\n    L_val = 5e-3  # m\n\n    test_cases = [\n        # Case A: oil-like\n        (900.0, 2000.0, 0.20, 0.14, 0.002, h_val, L_val, T_in, T_w),\n        # Case B: water-like, U=0\n        (1000.0, 4180.0, 0.001, 0.60, 0.0, h_val, L_val, T_in, T_w),\n        # Case C: water-like, U=0.05\n        (1000.0, 4180.0, 0.001, 0.60, 0.05, h_val, L_val, T_in, T_w),\n        # Case D: glycerol-like\n        (1260.0, 2400.0, 1.50, 0.285, 0.002, h_val, L_val, T_in, T_w),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}