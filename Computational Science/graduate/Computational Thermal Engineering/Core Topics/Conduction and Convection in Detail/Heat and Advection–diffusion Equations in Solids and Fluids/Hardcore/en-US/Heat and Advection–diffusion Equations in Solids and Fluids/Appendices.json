{
    "hands_on_practices": [
        {
            "introduction": "Real-world engineering materials often exhibit thermal properties that change with temperature. This practice moves beyond the textbook assumption of constant thermal conductivity to explore a more realistic scenario where conductivity, $k$, varies linearly with temperature. By deriving the exact analytical solution for steady one-dimensional heat conduction and comparing it to a common linearized approximation, you will gain crucial insight into the impact of material non-linearities and quantify the error introduced by such simplifications .",
            "id": "3959775",
            "problem": "A plane slab of thickness $L$ is in steady one-dimensional heat conduction without internal heat generation. The thermal conductivity depends linearly on temperature according to $k(T) = k_0 \\left(1 + \\beta T \\right)$, where $k_0$ and $\\beta$ are positive constants. The boundary temperatures are prescribed as $T(0) = T_0$ and $T(L) = T_L$ with $T_L > T_0$. Starting only from the statements of steady energy conservation in one dimension ($\\frac{d q_x}{dx} = 0$) and Fourier’s law of heat conduction ($q_x = -k(T) \\frac{dT}{dx}$), do the following:\n\n1. Derive the exact temperature distribution $T_{\\text{exact}}(x)$ in the slab and express the constant heat flux $q_x$ in terms of $k_0$, $\\beta$, $T_0$, $T_L$, and $L$.\n2. Obtain a linearized temperature field $T_{\\text{lin}}(x)$ by “freezing” the conductivity at a reference temperature equal to the arithmetic mean $T_{\\text{ref}} = \\frac{T_0 + T_L}{2}$ and solving the resulting constant-property conduction problem.\n3. Using the parameter values $k_0 = 50\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$, $\\beta = 1.0 \\times 10^{-3}\\,\\text{K}^{-1}$, $L = 0.10\\,\\text{m}$, $T_0 = 300\\,\\text{K}$, and $T_L = 500\\,\\text{K}$, compute the maximum absolute pointwise error between the exact and linearized temperature fields,\n$$\nE_{\\max} \\equiv \\max_{x \\in [0,L]} \\left| T_{\\text{exact}}(x) - T_{\\text{lin}}(x) \\right|.\n$$\n\nExpress the final answer in kelvin (K). Round your answer to four significant figures.",
            "solution": "The problem statement will first be validated for scientific soundness, consistency, and completeness.\n\n### Step 1: Extract Givens\n- Geometry: Plane slab of thickness $L$.\n- Process: Steady one-dimensional heat conduction, no internal heat generation.\n- Material Property: Thermal conductivity $k(T) = k_0 (1 + \\beta T)$, with $k_0 > 0$ and $\\beta > 0$.\n- Governing Equations: $\\frac{d q_x}{dx} = 0$ (steady energy conservation) and $q_x = -k(T) \\frac{dT}{dx}$ (Fourier's law).\n- Boundary Conditions: $T(0) = T_0$ and $T(L) = T_L$, with $T_L > T_0$.\n- Task 1: Derive the exact temperature distribution $T_{\\text{exact}}(x)$ and the constant heat flux $q_x$.\n- Task 2: Derive a linearized temperature field $T_{\\text{lin}}(x)$ by using a constant conductivity $k_{\\text{ref}} = k(T_{\\text{ref}})$ where $T_{\\text{ref}} = \\frac{T_0 + T_L}{2}$.\n- Task 3: Compute the maximum absolute pointwise error $E_{\\max} = \\max_{x \\in [0,L]} | T_{\\text{exact}}(x) - T_{\\text{lin}}(x) |$ using the parameter values $k_0 = 50\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$, $\\beta = 1.0 \\times 10^{-3}\\,\\text{K}^{-1}$, $L = 0.10\\,\\text{m}$, $T_0 = 300\\,\\text{K}$, and $T_L = 500\\,\\text{K}$. The final answer is to be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a classic scenario in heat transfer. The governing equations are the correct forms of the steady-state, one-dimensional heat equation and Fourier's Law. The linear dependence of thermal conductivity on temperature is a common and physically valid approximation for many materials over a limited temperature range.\n- **Well-Posed**: The problem is a second-order ordinary differential equation with two specified Dirichlet boundary conditions. This setup is well-posed and guarantees a unique solution.\n- **Objective**: The problem is stated using precise and unambiguous scientific language. All terms are well-defined.\n- **Completeness and Consistency**: All necessary data, functions, and boundary conditions are provided. There are no internal contradictions.\n- **Realism**: The provided numerical values for $k_0$, $\\beta$, $L$, and the temperatures are physically realistic for engineering materials and scenarios.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, completely specified, and objective. It is therefore deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\n**1. Exact Temperature Distribution and Heat Flux**\n\nThe steady energy conservation equation is $\\frac{d q_x}{dx} = 0$, which implies that the heat flux $q_x$ is a constant throughout the slab. Substituting Fourier's law yields:\n$$\nq_x = -k(T) \\frac{dT}{dx} = -k_0 (1 + \\beta T) \\frac{dT}{dx}\n$$\nThis is a first-order ordinary differential equation with separable variables. We can write:\n$$\nq_x dx = -k_0 (1 + \\beta T) dT\n$$\nTo find the relationship between temperature and position, we integrate from the boundary at $x=0$ to an arbitrary position $x$:\n$$\n\\int_0^x q_x dx' = -\\int_{T(0)}^{T(x)} k_0 (1 + \\beta T') dT'\n$$\nUsing the boundary condition $T(0) = T_0$, we get:\n$$\nq_x x = -k_0 \\left[ T' + \\frac{\\beta}{2} (T')^2 \\right]_{T_0}^{T(x)}\n$$\n$$\nq_x x = -k_0 \\left( \\left( T(x) + \\frac{\\beta}{2} T(x)^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) \\right)\n$$\nTo determine the constant heat flux $q_x$, we apply the second boundary condition, $T(L) = T_L$, to the equation above:\n$$\nq_x L = -k_0 \\left( \\left( T_L + \\frac{\\beta}{2} T_L^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) \\right)\n$$\nRearranging this expression gives the heat flux:\n$$\nq_x = -\\frac{k_0}{L} \\left( (T_L - T_0) + \\frac{\\beta}{2} (T_L^2 - T_0^2) \\right) = -\\frac{k_0}{L} (T_L - T_0) \\left( 1 + \\frac{\\beta}{2} (T_L + T_0) \\right)\n$$\nThis is the required expression for the constant heat flux $q_x$.\n\nTo find the temperature distribution $T_{\\text{exact}}(x)$, we can eliminate $q_x$ by taking the ratio of the two integrated equations:\n$$\n\\frac{x}{L} = \\frac{\\left( T(x) + \\frac{\\beta}{2} T(x)^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right)}{\\left( T_L + \\frac{\\beta}{2} T_L^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right)}\n$$\nThis equation can be rearranged into a quadratic equation for $T(x)$. A more convenient form is obtained by completing the square on the quantity $(1+\\beta T)$:\n$$\n(1+\\beta T_{\\text{exact}}(x))^2 = (1+\\beta T_0)^2 + \\frac{x}{L} \\left[ (1+\\beta T_L)^2 - (1+\\beta T_0)^2 \\right]\n$$\nSolving for $T_{\\text{exact}}(x)$:\n$$\nT_{\\text{exact}}(x) = \\frac{1}{\\beta} \\left( -1 + \\sqrt{(1+\\beta T_0)^2 + \\frac{x}{L}\\left[ (1+\\beta T_L)^2 - (1+\\beta T_0)^2 \\right]} \\right)\n$$\n\n**2. Linearized Temperature Distribution**\n\nFor this part, the thermal conductivity is held constant at $k_{\\text{ref}} = k(T_{\\text{ref}})$ where $T_{\\text{ref}} = \\frac{T_0 + T_L}{2}$.\n$$\nk_{\\text{ref}} = k_0 \\left( 1 + \\beta T_{\\text{ref}} \\right) = k_0 \\left( 1 + \\beta \\frac{T_0 + T_L}{2} \\right)\n$$\nThe governing equation becomes $\\frac{d}{dx} \\left( -k_{\\text{ref}} \\frac{dT}{dx} \\right) = 0$. Since $k_{\\text{ref}}$ is a constant, this simplifies to $\\frac{d^2T}{dx^2} = 0$.\nThe general solution is a linear profile: $T(x) = C_1 x + C_2$.\nApplying the boundary conditions:\n- $T(0) = T_0 \\implies T_0 = C_1(0) + C_2 \\implies C_2 = T_0$.\n- $T(L) = T_L \\implies T_L = C_1 L + T_0 \\implies C_1 = \\frac{T_L - T_0}{L}$.\nThe linearized temperature field is therefore:\n$$\nT_{\\text{lin}}(x) = T_0 + (T_L - T_0) \\frac{x}{L}\n$$\n\n**3. Maximum Absolute Pointwise Error**\n\nThe error is defined as $E(x) = T_{\\text{exact}}(x) - T_{\\text{lin}}(x)$. The maximum error $E_{\\max}$ occurs where the derivative of the error function is zero, i.e., $\\frac{dE}{dx} = 0$.\n$$\n\\frac{dE}{dx} = \\frac{d T_{\\text{exact}}}{dx} - \\frac{d T_{\\text{lin}}}{dx} = 0\n$$\nThis implies $\\frac{d T_{\\text{exact}}}{dx} = \\frac{d T_{\\text{lin}}}{dx}$ at the point of maximum error, let's call it $x_m$.\nFrom Fourier's law for the exact case, $\\frac{dT_{\\text{exact}}}{dx} = -\\frac{q_x}{k(T_{\\text{exact}})}$.\nFrom the linearized case, $\\frac{dT_{\\text{lin}}}{dx} = \\frac{T_L - T_0}{L}$. The heat flux for the linearized case is $q_{\\text{lin}} = -k_{\\text{ref}}\\frac{dT_{\\text{lin}}}{dx} = -k_{\\text{ref}} \\frac{T_L-T_0}{L}$.\nNotice that the expression derived for the exact heat flux $q_x$ is identical to $q_{\\text{lin}}$:\n$q_x = -\\frac{k_0}{L} (T_L - T_0) \\left( 1 + \\frac{\\beta}{2} (T_L + T_0) \\right) = -\\frac{k_{\\text{ref}}}{L}(T_L-T_0) = q_{\\text{lin}}$.\nThe condition for the maximum error thus becomes:\n$$\n-\\frac{q_x}{k(T_{\\text{exact}}(x_m))} = -\\frac{q_{\\text{lin}}}{k_{\\text{ref}}}\n$$\nSince $q_x = q_{\\text{lin}}$, this simplifies to $k(T_{\\text{exact}}(x_m)) = k_{\\text{ref}}$, which in turn implies $T_{\\text{exact}}(x_m) = T_{\\text{ref}} = \\frac{T_0 + T_L}{2}$.\nThe maximum error occurs at the position $x_m$ where the exact temperature equals the reference temperature. We find $x_m$ by setting $T_{\\text{exact}}(x_m) = T_{\\text{ref}}$ in the expression for $T_{\\text{exact}}(x)$:\n$$\n(1+\\beta T_{\\text{ref}})^2 = (1+\\beta T_0)^2 + \\frac{x_m}{L} \\left[ (1+\\beta T_L)^2 - (1+\\beta T_0)^2 \\right]\n$$\nSolving for $x_m/L$:\n$$\n\\frac{x_m}{L} = \\frac{(1+\\beta T_{\\text{ref}})^2 - (1+\\beta T_0)^2}{(1+\\beta T_L)^2 - (1+\\beta T_0)^2}\n$$\nThe maximum error is $E_{\\max} = |T_{\\text{exact}}(x_m) - T_{\\text{lin}}(x_m)| = |T_{\\text{ref}} - T_{\\text{lin}}(x_m)|$.\n$$\nE_{\\max} = \\left| \\frac{T_0+T_L}{2} - \\left(T_0 + (T_L - T_0)\\frac{x_m}{L}\\right) \\right| = \\left| \\frac{T_L-T_0}{2} - (T_L-T_0)\\frac{x_m}{L} \\right| = |T_L - T_0| \\left| \\frac{1}{2} - \\frac{x_m}{L} \\right|\n$$\nLet $a = 1+\\beta T_0$ and $b = 1+\\beta T_L$. Then $1+\\beta T_{\\text{ref}} = 1+\\beta \\frac{T_0+T_L}{2} = \\frac{a+b}{2}$.\nSubstituting these into the expression for $x_m/L$:\n$$\n\\frac{x_m}{L} = \\frac{\\left(\\frac{a+b}{2}\\right)^2 - a^2}{b^2 - a^2} = \\frac{\\left(\\frac{a+b}{2} - a\\right)\\left(\\frac{a+b}{2} + a\\right)}{(b-a)(b+a)} = \\frac{\\left(\\frac{b-a}{2}\\right)\\left(\\frac{3a+b}{2}\\right)}{(b-a)(b+a)} = \\frac{3a+b}{4(a+b)}\n$$\nNow we can find the term needed for the error calculation:\n$$\n\\frac{1}{2} - \\frac{x_m}{L} = \\frac{1}{2} - \\frac{3a+b}{4(a+b)} = \\frac{2(a+b) - (3a+b)}{4(a+b)} = \\frac{2a+2b-3a-b}{4(a+b)} = \\frac{b-a}{4(a+b)}\n$$\nSince $T_L > T_0$ and $\\beta > 0$, we have $b > a$, so this term is positive. We can drop the absolute value.\n$E_{\\max} = (T_L - T_0) \\left( \\frac{b-a}{4(a+b)} \\right)$.\nSubstituting $a$ and $b$ back:\n$b-a = (1+\\beta T_L) - (1+\\beta T_0) = \\beta(T_L - T_0)$.\n$a+b = (1+\\beta T_0) + (1+\\beta T_L) = 2 + \\beta(T_0 + T_L)$.\n$$\nE_{\\max} = (T_L - T_0) \\frac{\\beta(T_L - T_0)}{4(2 + \\beta(T_0 + T_L))} = \\frac{\\beta(T_L - T_0)^2}{4(2 + \\beta(T_0 + T_L))}\n$$\nNow, we substitute the given numerical values:\n$\\beta = 1.0 \\times 10^{-3}\\,\\text{K}^{-1}$, $T_0 = 300\\,\\text{K}$, $T_L = 500\\,\\text{K}$.\n$T_L - T_0 = 500\\,\\text{K} - 300\\,\\text{K} = 200\\,\\text{K}$.\n$T_0 + T_L = 300\\,\\text{K} + 500\\,\\text{K} = 800\\,\\text{K}$.\n$$\nE_{\\max} = \\frac{(1.0 \\times 10^{-3}) (200)^2}{4(2 + (1.0 \\times 10^{-3})(800))}\n$$\n$$\nE_{\\max} = \\frac{(1.0 \\times 10^{-3}) (40000)}{4(2 + 0.8)} = \\frac{40}{4(2.8)} = \\frac{40}{11.2}\n$$\n$$\nE_{\\max} = \\frac{10}{2.8} = \\frac{100}{28} = \\frac{25}{7} \\approx 3.571428... \\,\\text{K}\n$$\nRounding to four significant figures, the maximum absolute pointwise error is $3.571\\,\\text{K}$.",
            "answer": "$$\n\\boxed{3.571}\n$$"
        },
        {
            "introduction": "While analytical solutions provide deep physical insight, most practical transport problems require numerical methods. This exercise provides a foundational introduction to computational fluid dynamics by having you derive the first-order upwind scheme for the linear advection equation directly from conservation principles. A key part of this practice is performing a modified-equation analysis, which uncovers the concept of 'numerical diffusion'—an artificial dissipative effect inherent to the discretization scheme that is crucial for understanding its stability and accuracy .",
            "id": "3959810",
            "problem": "A one-dimensional, constant-coefficient linear advection of a transported scalar is governed by the conservation law stating that changes in the scalar density within a control volume arise solely from the net flux across its boundaries. Starting from this conservation statement and the definition of flux as the product of velocity and scalar density, derive a consistent discrete update for the cell-averaged scalar on a uniform grid using a time-explicit method and a monotone, directionally appropriate numerical flux. This construction must lead to a first-order method that remains stable under a suitable Courant–Friedrichs–Lewy (CFL) condition, spell out the update for both positive and negative advection velocity, and then perform a modified-equation analysis for the fully discrete method to quantify the leading-order truncation effect as an equivalent diffusion term.\n\nFrom first principles and without using any pre-derived advection–diffusion result, you must:\n- Derive the first-order upwind scheme for one-dimensional linear advection driven by a constant velocity $a$ on a uniform mesh with spatial step $\\Delta x$ and time step $\\Delta t$.\n- Use Taylor expansions to obtain the modified equation for the fully discrete method, and identify the coefficient of the leading-order even spatial derivative that acts as a diffusion. Define this coefficient as the numerical diffusion $D_{\\text{num}}$ in units of $\\mathrm{m}^2/\\mathrm{s}$, expressed as a function of $a$, $\\Delta x$, and $\\Delta t$. You must include the dependence on the sign of $a$ correctly and express any stability constraints in terms of the Courant–Friedrichs–Lewy (CFL) number.\n- Relate the sign and magnitude of $D_{\\text{num}}$ to the stabilization of oscillations and the smearing of sharp gradients by considering the damping or growth of Fourier modes.\n\nThen, implement a program that, using your derived expressions, computes for each test case:\n1. The numerical diffusion $D_{\\text{num}}$ in $\\mathrm{m}^2/\\mathrm{s}$.\n2. The one-step amplification magnitude $\\lvert G \\rvert$ of a Fourier mode of wavenumber $k$ (in $\\mathrm{rad}/\\mathrm{m}$) under the fully discrete first-order upwind method you derived.\n3. The one-step amplitude predicted by the equivalent advection–diffusion model using $D_{\\text{num}}$, namely $\\exp\\!\\big(-D_{\\text{num}}\\,k^2\\,\\Delta t\\big)$, which is dimensionless.\n\nPhysical units and angle/unit conventions:\n- Express $a$ in $\\mathrm{m}/\\mathrm{s}$, $\\Delta x$ in $\\mathrm{m}$, $\\Delta t$ in $\\mathrm{s}$, $k$ in $\\mathrm{rad}/\\mathrm{m}$, and $D_{\\text{num}}$ in $\\mathrm{m}^2/\\mathrm{s}$.\n- The Fourier mode wavenumber $k$ is an angular spatial frequency; angles appear as $k\\,\\Delta x$ in radians.\n\nThe test suite consists of four parameter sets $(a,\\Delta x,\\Delta t,k)$:\n- Case A (general stable case): $a=1$, $\\Delta x=1.0\\times 10^{-2}$, $\\Delta t=6.0\\times 10^{-3}$, $k=50$.\n- Case B (CFL boundary): $a=1$, $\\Delta x=1.0\\times 10^{-2}$, $\\Delta t=1.0\\times 10^{-2}$, $k=40$.\n- Case C (CFL violation, antidiffusion): $a=1$, $\\Delta x=1.0\\times 10^{-2}$, $\\Delta t=1.2\\times 10^{-2}$, $k=\\pi/\\Delta x$.\n- Case D (negative velocity): $a=-2$, $\\Delta x=2.0\\times 10^{-2}$, $\\Delta t=5.0\\times 10^{-3}$, $k=10$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the $12$ results for the four cases, ordered as $[D_{\\text{num}}^{(A)},\\lvert G\\rvert^{(A)},\\exp(-D_{\\text{num}}^{(A)}k^2\\Delta t),D_{\\text{num}}^{(B)},\\lvert G\\rvert^{(B)},\\exp(-D_{\\text{num}}^{(B)}k^2\\Delta t),D_{\\text{num}}^{(C)},\\lvert G\\rvert^{(C)},\\exp(-D_{\\text{num}}^{(C)}k^2\\Delta t),D_{\\text{num}}^{(D)},\\lvert G\\rvert^{(D)},\\exp(-D_{\\text{num}}^{(D)}k^2\\Delta t)]$.\n- Each number must be printed as a decimal float rounded to six places after the decimal point.",
            "solution": "The posed problem is valid as it is scientifically grounded in the principles of computational fluid dynamics, well-posed with a clear objective and sufficient data, and free from any factual or logical contradictions. The derivation and analysis of the first-order upwind scheme, including its modified equation and stability properties, constitute a fundamental exercise in the numerical analysis of partial differential equations.\n\nThe derivation and analysis proceed in the following steps.\n\n**1. Derivation of the First-Order Upwind Scheme**\n\nThe one-dimensional linear advection equation for a scalar quantity $u(x, t)$ with a constant velocity $a$ is given by the partial differential equation (PDE) $\\frac{\\partial u}{\\partial t} + \\frac{\\partial F}{\\partial x} = 0$, where the flux is $F(u) = a u$.\n\nWe start from the integral form of this conservation law applied to a control volume, or cell, $C_j = [x_{j-1/2}, x_{j+1/2}]$ of width $\\Delta x = x_{j+1/2} - x_{j-1/2}$, over a time interval $[t^n, t^{n+1}]$ of duration $\\Delta t = t^{n+1} - t^n$.\n$$\n\\int_{x_{j-1/2}}^{x_{j+1/2}} u(x, t^{n+1}) dx - \\int_{x_{j-1/2}}^{x_{j+1/2}} u(x, t^{n}) dx = - \\int_{t^n}^{t^{n+1}} \\left[ F(u(x_{j+1/2}, t)) - F(u(x_{j-1/2}, t)) \\right] dt\n$$\nLet $u_j^n$ be the cell-averaged value of the scalar in cell $C_j$ at time $t^n$:\n$$\nu_j^n = \\frac{1}{\\Delta x} \\int_{x_{j-1/2}}^{x_{j+1/2}} u(x, t^{n}) dx\n$$\nThe integral form can be rewritten in terms of cell averages:\n$$\nu_j^{n+1} \\Delta x - u_j^n \\Delta x = - \\int_{t^n}^{t^{n+1}} \\left[ F_{j+1/2}(t) - F_{j-1/2}(t) \\right] dt\n$$\nwhere $F_{j \\pm 1/2}(t)$ represents the flux at the cell interfaces. Using a first-order explicit Euler time integration, we approximate the time integral:\n$$\nu_j^{n+1} \\Delta x - u_j^n \\Delta x \\approx -\\Delta t \\left[ F_{j+1/2}^n - F_{j-1/2}^n \\right]\n$$\nThis yields the semi-discrete finite volume update formula:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} \\left[ F_{j+1/2}^n - F_{j-1/2}^n \\right]\n$$\nThe numerical flux $F_{j+1/2}^n$ must be chosen appropriately. The upwind principle dictates that the flux at an interface should be determined by the state from the \"upwind\" direction, i.e., the direction from which information is flowing.\n- If $a > 0$, the flow is from left to right. The flux at the interface $x_{j+1/2}$ is determined by the state in cell $j$. Thus, $F_{j+1/2} = a u_j$.\n- If $a  0$, the flow is from right to left. The flux at the interface $x_{j+1/2}$ is determined by the state in cell $j+1$. Thus, $F_{j+1/2} = a u_{j+1}$.\n\nSubstituting these fluxes into the update formula:\n- For $a > 0$:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} \\left( a u_j^n - a u_{j-1}^n \\right) = u_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( u_j^n - u_{j-1}^n \\right)\n$$\n- For $a  0$:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} \\left( a u_{j+1}^n - a u_j^n \\right) = u_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( u_{j+1}^n - u_j^n \\right)\n$$\nThese are the discrete update equations for the first-order upwind method.\n\n**2. Modified Equation and Numerical Diffusion**\n\nTo quantify the leading-order truncation error, we perform a modified-equation analysis by substituting Taylor series expansions for each term in the discrete equation around the point $(x_j, t^n)$. We analyze the case $a > 0$. The scheme is $u_j^{n+1} = u_j^n - \\sigma(u_j^n - u_{j-1}^n)$, where $\\sigma = \\frac{a\\Delta t}{\\Delta x}$ is the Courant number.\n$$\nu(x_j, t^n+\\Delta t) = u_j^n - \\sigma \\left( u_j^n - u(x_j-\\Delta x, t^n) \\right)\n$$\nExpansions are:\n$u(x_j, t^n+\\Delta t) = u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + O(\\Delta t^3)$\n$u(x_j-\\Delta x, t^n) = u - \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} - \\frac{\\Delta x^3}{6} u_{xxx} + O(\\Delta x^4)$\nwhere all partial derivatives are evaluated at $(x_j, t^n)$.\nSubstituting these into the scheme:\n$$\nu + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\dots = u - \\frac{a \\Delta t}{\\Delta x} \\left( u - \\left( u - \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} + \\dots \\right) \\right)\n$$\n$$\n\\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\dots = - \\frac{a \\Delta t}{\\Delta x} \\left( \\Delta x u_x - \\frac{\\Delta x^2}{2} u_{xx} + \\dots \\right)\n$$\nDividing by $\\Delta t$ and simplifying:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\dots = -a u_x + \\frac{a \\Delta x}{2} u_{xx} + \\dots\n$$\nTo form the modified equation, we must express time derivatives in terms of spatial derivatives. From the leading-order terms, $u_t \\approx -a u_x$. Differentiating, we get $u_{tt} \\approx -a u_{xt} = -a (u_t)_x \\approx -a (-a u_x)_x = a^2 u_{xx}$. Substituting this back:\n$$\nu_t + \\frac{\\Delta t}{2} (a^2 u_{xx}) = -a u_x + \\frac{a \\Delta x}{2} u_{xx} + \\dots\n$$\nRearranging gives the modified PDE:\n$$\nu_t + a u_x = \\left( \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + O(\\Delta x^2, \\Delta t^2)\n$$\nThe coefficient of the second spatial derivative, $u_{xx}$, is the numerical diffusion $D_{\\text{num}}$:\n$$\nD_{\\text{num}} = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) \\quad (\\text{for } a > 0)\n$$\nA similar analysis for $a  0$ yields:\n$$\nD_{\\text{num}} = -\\frac{a \\Delta x}{2} \\left(1 + \\frac{a \\Delta t}{\\Delta x}\\right) \\quad (\\text{for } a  0)\n$$\nWe can combine these into a single expression using the absolute value of $a$ and the CFL number $\\nu = \\frac{|a| \\Delta t}{\\Delta x}$. For $a > 0$, $\\nu = \\frac{a \\Delta t}{\\Delta x}$ and $D_{\\text{num}} = \\frac{a \\Delta x}{2} (1 - \\nu) = \\frac{|a| \\Delta x}{2} (1 - \\nu)$. For $a  0$, $\\nu = \\frac{-a \\Delta t}{\\Delta x}$, so $\\frac{a \\Delta t}{\\Delta x} = -\\nu$, and $D_{\\text{num}} = -\\frac{a \\Delta x}{2} (1 - \\nu) = \\frac{|a| \\Delta x}{2} (1 - \\nu)$. Thus, the general expression is:\n$$\nD_{\\text{num}} = \\frac{|a| \\Delta x}{2} \\left(1 - \\frac{|a| \\Delta t}{\\Delta x}\\right)\n$$\n\n**3. Fourier Analysis and Stability**\n\nWe perform a von Neumann stability analysis by substituting a single Fourier mode $u_j^n = G^n \\hat{u}^0 e^{i k x_j}$ into the discrete scheme, where $G$ is the amplification factor and $k$ is the wavenumber.\nFor $a > 0$, the scheme is $u_j^{n+1} = u_j^n - \\sigma(u_j^n - u_{j-1}^n)$ with $\\sigma > 0$.\n$$\nG e^{i k j \\Delta x} = e^{i k j \\Delta x} - \\sigma(e^{i k j \\Delta x} - e^{i k (j-1) \\Delta x})\n$$\n$$\nG = 1 - \\sigma(1 - e^{-i k \\Delta x})\n$$\nThe stability condition is $|G| \\le 1$ for all $k$. The squared magnitude is $|G|^2 = 1 - 2\\sigma(1-\\sigma)(1-\\cos(k\\Delta x))$. For this to be less than or equal to $1$, we require $2\\sigma(1-\\sigma)(1-\\cos(k\\Delta x)) \\ge 0$. As $1-\\cos(k\\Delta x) \\ge 0$, this requires $\\sigma(1-\\sigma) \\ge 0$, which for $\\sigma > 0$ implies $0 \\le \\sigma \\le 1$.\n\nFor $a  0$, the scheme is $u_j^{n+1} = u_j^n - \\sigma(u_{j+1}^n - u_j^n)$ with $\\sigma  0$.\n$$\nG e^{i k j \\Delta x} = e^{i k j \\Delta x} - \\sigma(e^{i k (j+1) \\Delta x} - e^{i k j \\Delta x})\n$$\n$$\nG = 1 - \\sigma(e^{i k \\Delta x} - 1)\n$$\nThe squared magnitude is $|G|^2 = 1 + 2\\sigma(1+\\sigma)(1-\\cos(k\\Delta x))$. For stability, we need $\\sigma(1+\\sigma) \\le 0$. Since $\\sigma  0$, this requires $1+\\sigma \\ge 0$, or $-1 \\le \\sigma \\le 0$.\n\nCombining both cases, the Courant–Friedrichs–Lewy (CFL) stability condition for the first-order upwind method is $|\\sigma| = \\frac{|a| \\Delta t}{\\Delta x} \\le 1$.\n\nThe numerical diffusion $D_{\\text{num}} = \\frac{|a| \\Delta x}{2}(1 - \\frac{|a| \\Delta t}{\\Delta x})$ is non-negative ($D_{\\text{num}} \\ge 0$) if and only if the CFL condition is satisfied. A positive numerical diffusion term $D_{\\text{num}} u_{xx}$ acts to dissipate, or damp, Fourier modes. The decay rate for a mode with wavenumber $k$ in the modified equation is goverened by the factor $e^{-D_{\\text{num}}k^2 t}$. This damping stabilizes the numerical scheme by preventing the growth of high-frequency oscillations that arise from discretization errors. If the CFL condition is violated, $D_{\\text{num}}$ becomes negative, leading to \"anti-diffusion\" which amplifies modes and causes exponential instability. The smearing of sharp gradients is a direct consequence of this numerical diffusion, as sharp features are composed of high-wavenumber modes, which are most strongly damped.\n\nThe one-step amplitude predicted by the equivalent advection-diffusion model is $\\exp(-D_{\\text{num}} k^2 \\Delta t)$.\n\nThe requested quantities are now computed for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical diffusion, amplification factor, and predicted damping\n    for the first-order upwind scheme for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (a, delta_x, delta_t, k)\n    test_cases = [\n        # Case A: General stable case\n        (1.0, 1.0e-2, 6.0e-3, 50.0),\n        # Case B: CFL boundary\n        (1.0, 1.0e-2, 1.0e-2, 40.0),\n        # Case C: CFL violation, antidiffusion\n        (1.0, 1.0e-2, 1.2e-2, np.pi / 1.0e-2),\n        # Case D: Negative velocity\n        (-2.0, 2.0e-2, 5.0e-3, 10.0),\n    ]\n\n    results_flat = []\n    \n    for case in test_cases:\n        a, dx, dt, k = case\n        \n        # Calculate the CFL number (always non-negative)\n        cfl_number = np.abs(a) * dt / dx\n        \n        # 1. Calculate numerical diffusion D_num\n        # D_num = (|a|*dx/2) * (1 - |a|*dt/dx)\n        D_num = (np.abs(a) * dx / 2.0) * (1.0 - cfl_number)\n        \n        # 2. Calculate one-step amplification magnitude |G|\n        sigma = a * dt / dx  # Courant number (can be negative)\n        theta = k * dx       # Dimensionless wavenumber\n        \n        if a >= 0:\n            # G = 1 - sigma * (1 - exp(-i*theta)) for a >= 0\n            G = 1.0 - sigma * (1.0 - np.exp(-1j * theta))\n        else: # a  0\n            # G = 1 - sigma * (exp(i*theta) - 1) for a  0\n            G = 1.0 - sigma * (np.exp(1j * theta) - 1.0)\n            \n        G_magnitude = np.abs(G)\n        \n        # 3. Calculate predicted amplitude from the equivalent advection-diffusion model\n        # Amplitude = exp(-D_num * k^2 * dt)\n        predicted_amplitude = np.exp(-D_num * k**2 * dt)\n        \n        # Append the three results for the current case\n        results_flat.extend([D_num, G_magnitude, predicted_amplitude])\n\n    # Format the results for printing\n    # Each number must be a decimal float rounded to six places after the decimal point.\n    formatted_results = [f\"{val:.6f}\" for val in results_flat]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This practice integrates the physical complexity of variable properties with the practical power of numerical methods. You will develop a second-order accurate Finite Volume Method (FVM) solver for the two-dimensional steady heat conduction equation where conductivity varies spatially, a common scenario in composite materials or systems with large temperature gradients. The exercise emphasizes the physically consistent treatment of fluxes at cell faces using harmonic averaging and employs the method of manufactured solutions to formally verify the accuracy of your implementation .",
            "id": "3959812",
            "problem": "Consider the steady heat conduction operator in two spatial dimensions defined by the divergence of conductive heat flux, namely $\\nabla \\cdot (k \\nabla T)$, where $T$ is temperature and $k$ is thermal conductivity. Starting from the local statement of energy conservation and Fourier’s law of heat conduction, derive a second-order accurate Finite Volume Method (FVM) discretization for a structured Cartesian grid on a unit square domain $[0,1]\\times[0,1]$ with cell-centered unknowns and face-normal fluxes. The derivation must begin from the integral conservation form over a control volume and use a physically consistent definition of face flux. Explicitly show how to handle spatial variability of $k$ by using harmonic averaging at interior faces, and explain the treatment of Dirichlet boundary conditions to maintain second-order spatial accuracy. Assume $k$ is a sufficiently smooth function of position and, unless otherwise stated, depends only on the $x$-coordinate.\n\nYour program must implement the derived discretization to solve the partial differential equation\n$$\n\\nabla \\cdot \\left(k(x)\\nabla T(x,y)\\right) = f(x,y)\n$$\non the domain $x\\in[0,1]$, $y\\in[0,1]$, subject to Dirichlet boundary conditions $T(x,y) = T_{\\text{exact}}(x,y)$ prescribed on all boundaries. Use the method of manufactured solutions with\n$$\nT_{\\text{exact}}(x,y) = \\sin(\\pi x)\\sin(\\pi y),\n$$\nand choose $k(x) = k_0 + \\alpha x$ with constants $k_0 \\ge 0$ and $\\alpha \\ge 0$. Derive the corresponding source term $f(x,y)$ from the exact $T_{\\text{exact}}(x,y)$ and the chosen $k(x)$, and use the midpoint rule to approximate $\\int_{\\Omega_P} f \\, dV$ for each control volume $\\Omega_P$. The grid should be uniform with $N_x$ cells in the $x$-direction and $N_y$ cells in the $y$-direction, with cell widths $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$. Implement harmonic averaging of $k$ at interior faces to compute face conductivities for fluxes, and treat Dirichlet boundary faces by eliminating ghost-cell values to obtain second-order consistent face coefficients and source terms. Assemble the resulting sparse linear system and solve for the cell-centered temperatures.\n\nCompute the error as the discrete $\\ell^2$ norm of the difference between the numerical solution $T_h$ and the exact solution $T_{\\text{exact}}$,\n$$\n\\|e\\|_2 = \\left(\\sum_{P} (T_h(P) - T_{\\text{exact}}(P))^2 \\, \\Delta x \\, \\Delta y \\right)^{1/2},\n$$\nand report it in kelvin. Also compute the observed order of accuracy $p$ for a pair of grids with $(N_x,N_y)$ and $(2N_x,2N_y)$ using\n$$\np = \\frac{\\ln\\left(\\|e\\|_2^{\\text{coarse}}/\\|e\\|_2^{\\text{fine}}\\right)}{\\ln(2)},\n$$\nwhich is dimensionless and must be reported as a decimal number.\n\nTest Suite and Required Output:\nImplement and run the following four test cases:\n- Case $1$ (constant conductivity, general accuracy): $k_0 = 2$, $\\alpha = 0$, $N_x = 40$, $N_y = 40$. Output the discrete $\\ell^2$ error in kelvin.\n- Case $2$ (linearly varying conductivity, general accuracy): $k_0 = 1$, $\\alpha = 1$, $N_x = 40$, $N_y = 40$. Output the discrete $\\ell^2$ error in kelvin.\n- Case $3$ (linearly varying conductivity, coarse grid edge case): $k_0 = 1$, $\\alpha = 1$, $N_x = 8$, $N_y = 8$. Output the discrete $\\ell^2$ error in kelvin.\n- Case $4$ (linearly varying conductivity, observed order on refinement): $k_0 = 1$, $\\alpha = 1$, coarse grid $N_x = 20$, $N_y = 20$, fine grid $N_x = 40$, $N_y = 40$. Output the observed order $p$ as a decimal number.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases described above, for example, $[e_1,e_2,e_3,p_4]$, where $e_i$ are errors in kelvin and $p_4$ is dimensionless. No units should be printed; interpret $e_i$ as kelvin and $p_4$ as a decimal. Angles, if any, must be in radians. Percentages, if any, must be expressed as decimals.\n\nScientific and algorithmic requirements:\n- Begin the derivation from energy conservation and Fourier’s law, not from pre-derived discrete formulas.\n- Use second-order spatial accuracy on a uniform Cartesian grid via central differencing.\n- Use harmonic averaging of $k$ at interior faces.\n- Use consistent Dirichlet boundary treatment with half-cell distances to maintain second-order accuracy.\n- Assemble and solve the resulting sparse linear system.\n- Ensure the scenario is scientifically sound and self-consistent.\n\nThe final program must be complete and runnable, use the specified execution environment, require no external input, and produce the exact required single-line output format.",
            "solution": "The problem requires the derivation and implementation of a second-order accurate Finite Volume Method (FVM) for the steady-state heat conduction equation with a spatially varying thermal conductivity, $k(x)$, on a two-dimensional Cartesian grid. The derivation must originate from the fundamental principles of energy conservation and Fourier's law of heat conduction.\n\nThe governing partial differential equation (PDE) for steady-state heat conduction with a source term $f$ is:\n$$ \\nabla \\cdot \\left(k \\nabla T\\right) = f $$\nwhere $T$ is the temperature, $k$ is the thermal conductivity, and $f$ is the volumetric heat source density.\n\nThe FVM begins with the integral form of the conservation law. Integrating the PDE over an arbitrary control volume (CV), $\\Omega_P$, gives:\n$$ \\int_{\\Omega_P} \\nabla \\cdot \\left(k \\nabla T\\right) \\, dV = \\int_{\\Omega_P} f \\, dV $$\nApplying the divergence theorem to the left-hand side transforms the volume integral of the divergence into a surface integral of the flux over the boundary of the control volume, $\\partial \\Omega_P$:\n$$ \\oint_{\\partial \\Omega_P} (k \\nabla T) \\cdot \\mathbf{n} \\, dS = \\int_{\\Omega_P} f \\, dV $$\nHere, $\\mathbf{n}$ is the outward-pointing unit normal vector to the surface element $dS$. The term $-(k \\nabla T)$ is Fourier's law for the heat flux vector, $\\mathbf{q}$. The equation thus represents a balance of heat fluxes across the CV boundary with the heat generated within it.\n\nWe now discretize this integral equation on a structured Cartesian grid composed of rectangular cells. Consider a generic cell, or control volume, $\\Omega_P$, centered at point $P(x_P, y_P)$ with dimensions $\\Delta x \\times \\Delta y$ and volume $V_P = \\Delta x \\Delta y$ (assuming unit depth). The boundary $\\partial \\Omega_P$ consists of four faces: east ($e$), west ($w$), north ($n$), and south ($s$). The integral balance equation becomes a sum of fluxes over these four faces:\n$$ F_e - F_w + F_n - F_s = \\bar{f}_P V_P $$\nwhere $F_f$ represents the total heat rate crossing face $f$, and $\\bar{f}_P$ is the average source term over the control volume. The total heat rate is the product of the face-normal flux density, $q_f$, and the face area, $A_f$. For our 2D grid, the areas are $A_e = A_w = \\Delta y$ and $A_n = A_s = \\Delta x$. The balance equation is:\n$$ (q_e A_e - q_w A_w) + (q_n A_n - q_s A_s) = (q_e - q_w)\\Delta y + (q_n - q_s)\\Delta x = \\bar{f}_P \\Delta x \\Delta y $$\nThe problem specifies using the midpoint rule to approximate the integrated source term, so $\\bar{f}_P \\approx f(x_P, y_P)$. The fluxes $q_f$ are the components of the heat flux vector normal to the faces, evaluated at the face centers. Using Fourier's law, we approximate these fluxes. For instance, at the east face:\n$$ q_e = (-k\\nabla T)_e \\cdot \\mathbf{i} \\approx -k_e \\left(\\frac{\\partial T}{\\partial x}\\right)_e $$\nwhere $k_e$ is the thermal conductivity at the east face. To maintain second-order accuracy, the gradients at the faces are approximated using central differences between the adjacent cell centers. Let $P$ denote the center of the current cell and $E, W, N, S$ denote the centers of its east, west, north, and south neighbors, respectively. The gradients are:\n$$ \\left(\\frac{\\partial T}{\\partial x}\\right)_e \\approx \\frac{T_E - T_P}{\\Delta x}, \\quad \\left(\\frac{\\partial T}{\\partial y}\\right)_n \\approx \\frac{T_N - T_P}{\\Delta y} $$\nThe fluxes through the four faces of cell $P$ are thus approximated as:\n$$ q_e \\approx -k_e \\frac{T_E - T_P}{\\Delta x}, \\quad q_w \\approx -k_w \\frac{T_P - T_W}{\\Delta x} $$\n$$ q_n \\approx -k_n \\frac{T_N - T_P}{\\Delta y}, \\quad q_s \\approx -k_s \\frac{T_P - T_S}{\\Delta y} $$\n\nFor a spatially variable conductivity $k(x)$, the face conductivities $k_f$ must be evaluated appropriately. For faces normal to the direction of variation (east and west faces), a simple arithmetic average of the cell-center conductivities would lead to first-order accuracy. To ensure second-order accuracy and physical consistency (continuity of flux and temperature), the harmonic mean is used. This is equivalent to modeling the heat transfer across the face as a series of thermal resistances corresponding to the two half-cells adjacent to the face.\nFor an interior east face between cells $P$ and $E$:\n$$ k_e = \\frac{2 k(x_P) k(x_E)}{k(x_P) + k(x_E)} $$\nSimilarly for the west face between cells $W$ and $P$:\n$$ k_w = \\frac{2 k(x_W) k(x_P)}{k(x_W) + k(x_P)} $$\nFor the north and south faces, which are aligned with constant $x$-coordinates, the conductivity $k(x)$ is constant along each face. Thus, no averaging is needed:\n$$ k_n = k_s = k(x_P) $$\nSubstituting these flux approximations into the balance equation yields the discretized equation for an interior cell $P$:\n$$ -k_e \\frac{T_E - T_P}{\\Delta x} \\Delta y - \\left(-k_w \\frac{T_P - T_W}{\\Delta x}\\right) \\Delta y - k_n \\frac{T_N - T_P}{\\Delta y} \\Delta x - \\left(-k_s \\frac{T_P - T_S}{\\Delta y}\\right) \\Delta x = f(x_P, y_P) \\Delta x \\Delta y $$\nRearranging to the standard linear algebraic form $a_P T_P = a_E T_E + a_W T_W + a_N T_N + a_S T_S + b_P$:\n$$ \\left( k_e \\frac{\\Delta y}{\\Delta x} + k_w \\frac{\\Delta y}{\\Delta x} + k_n \\frac{\\Delta x}{\\Delta y} + k_s \\frac{\\Delta x}{\\Delta y} \\right) T_P = \\left( k_e \\frac{\\Delta y}{\\Delta x} \\right) T_E + \\left( k_w \\frac{\\Delta y}{\\Delta x} \\right) T_W + \\left( k_n \\frac{\\Delta x}{\\Delta y} \\right) T_N + \\left( k_s \\frac{\\Delta x}{\\Delta y} \\right) T_S + f_P \\Delta x \\Delta y $$\nHere, we define the coefficients: $a_E = k_e \\frac{\\Delta y}{\\Delta x}$, $a_W = k_w \\frac{\\Delta y}{\\Delta x}$, $a_N = k_n \\frac{\\Delta x}{\\Delta y}$, $a_S = k_s \\frac{\\Delta x}{\\Delta y}$, and the central coefficient $a_P = a_E + a_W + a_N + a_S$. The source term contribution is $b_P = f(x_P, y_P) \\Delta x \\Delta y$.\n\nFor cells adjacent to a Dirichlet boundary, the treatment must be modified to maintain second-order accuracy. Consider a cell $P$ at the west boundary ($x=0$). The west face of the cell lies on the boundary, where the temperature $T_b$ is known. The distance from the cell center $P$ to this boundary is $\\Delta x/2$. The gradient at the west face is approximated using the cell-center and boundary values:\n$$ \\left(\\frac{\\partial T}{\\partial x}\\right)_w \\approx \\frac{T_P - T_{b,w}}{\\Delta x / 2} $$\nwhere $T_{b,w} = T_{\\text{exact}}(0, y_P)$. The flux through the west face is $q_w = -k_w (\\frac{T_P - T_{b,w}}{\\Delta x/2})$, where $k_w = k(0)$ is the conductivity at the boundary. The term in the balance equation is $-q_w \\Delta y$. The coefficient for the west face becomes $a_W = k(0) \\frac{\\Delta y}{\\Delta x/2} = 2k(0)\\frac{\\Delta y}{\\Delta x}$. This modifies the linear equation for the boundary cell: the term $a_W T_W$ is replaced by a known value added to the source term. The final equation for a cell $P$ on the west boundary is:\n$$ (a_E + a_W + a_N + a_S) T_P - a_E T_E - a_N T_N - a_S T_S = b_P + a_W T_{b,w} $$\nThis procedure is applied analogously to all other boundaries (east, north, south), adjusting the coefficient and source term for the respective boundary face. This \"ghost cell\" elimination with a half-cell distance ensures the gradient approximation at the boundary is second-order, thus preserving the overall accuracy of the scheme.\n\nFinally, we use the method of manufactured solutions to define the source term $f(x,y)$. Given $T_{\\text{exact}}(x,y) = \\sin(\\pi x)\\sin(\\pi y)$ and $k(x) = k_0 + \\alpha x$, we compute $f(x,y) = \\nabla \\cdot (k \\nabla T_{\\text{exact}})$.\nWith $\\nabla T_{\\text{exact}} = \\langle \\pi\\cos(\\pi x)\\sin(\\pi y), \\pi\\sin(\\pi x)\\cos(\\pi y) \\rangle$, we have:\n$$ f(x,y) = \\frac{\\partial}{\\partial x}\\left((k_0+\\alpha x)\\pi\\cos(\\pi x)\\sin(\\pi y)\\right) + \\frac{\\partial}{\\partial y}\\left((k_0+\\alpha x)\\pi\\sin(\\pi x)\\cos(\\pi y)\\right) $$\n$$ f(x,y) = \\pi\\sin(\\pi y)\\left[\\alpha\\cos(\\pi x) - (k_0+\\alpha x)\\pi\\sin(\\pi x)\\right] + (k_0+\\alpha x)\\pi\\sin(\\pi x)\\left[-\\pi\\sin(\\pi y)\\right] $$\n$$ f(x,y) = \\pi \\alpha \\cos(\\pi x)\\sin(\\pi y) - 2\\pi^2 (k_0 + \\alpha x) \\sin(\\pi x)\\sin(\\pi y) $$\nThis function is used to compute the source term $b_P$ for each cell. Assembling the equations for all $N_x \\times N_y$ cells results in a sparse linear system $A\\mathbf{T} = \\mathbf{b}$, which can be solved for the vector of cell-centered temperatures $\\mathbf{T}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve_pde(Nx, Ny, k0, alpha):\n    \"\"\"\n    Solves the 2D steady heat conduction equation using a cell-centered FVM.\n\n    Args:\n        Nx (int): Number of cells in the x-direction.\n        Ny (int): Number of cells in the y-direction.\n        k0 (float): Constant term in thermal conductivity k(x).\n        alpha (float): Linear coefficient in thermal conductivity k(x).\n\n    Returns:\n        float: The discrete l2-norm of the error.\n    \"\"\"\n    dx = 1.0 / Nx\n    dy = 1.0 / Ny\n    x_centers = (np.arange(Nx) + 0.5) * dx\n    y_centers = (np.arange(Ny) + 0.5) * dy\n    xx, yy = np.meshgrid(x_centers, y_centers, indexing='xy')\n\n    # Define analytical functions based on the method of manufactured solutions\n    k_func = lambda x: k0 + alpha * x\n    T_exact_func = lambda x, y: np.sin(np.pi * x) * np.sin(np.pi * y)\n    \n    def f_func(x, y):\n        pi = np.pi\n        term1 = pi * alpha * np.cos(pi * x) * np.sin(pi * y)\n        term2 = -2 * pi**2 * (k0 + alpha * x) * np.sin(pi * x) * np.sin(pi * y)\n        return term1 + term2\n\n    N_total = Nx * Ny\n    A = lil_matrix((N_total, N_total))\n    b = np.zeros(N_total)\n\n    # Assemble the sparse matrix A and the source vector b\n    for j in range(Ny):  # y-index\n        for i in range(Nx):  # x-index\n            p = i + j * Nx  # 1D index, mapping (i,j) -> p\n            \n            x_p, y_p = x_centers[i], y_centers[j]\n            \n            # Integrated source term (midpoint rule)\n            b[p] = f_func(x_p, y_p) * dx * dy\n            \n            a_P = 0.0  # Diagonal coefficient\n            \n            # West face\n            if i > 0:  # Interior face\n                x_w_center = x_centers[i-1]\n                k_p = k_func(x_p)\n                k_w_cell = k_func(x_w_center)\n                k_w_face = 2.0 * k_p * k_w_cell / (k_p + k_w_cell) # Harmonic mean\n                a_W = k_w_face * dy / dx\n                A[p, p - 1] = -a_W\n                a_P += a_W\n            else:  # Boundary face (x=0)\n                k_w_face = k_func(0.0)\n                a_W = k_w_face * dy / (dx / 2.0)\n                a_P += a_W\n                T_b = T_exact_func(0.0, y_p)\n                b[p] += a_W * T_b\n                \n            # East face\n            if i  Nx - 1:  # Interior face\n                x_e_center = x_centers[i+1]\n                k_p = k_func(x_p)\n                k_e_cell = k_func(x_e_center)\n                k_e_face = 2.0 * k_p * k_e_cell / (k_p + k_e_cell) # Harmonic mean\n                a_E = k_e_face * dy / dx\n                A[p, p + 1] = -a_E\n                a_P += a_E\n            else:  # Boundary face (x=1)\n                k_e_face = k_func(1.0)\n                a_E = k_e_face * dy / (dx / 2.0)\n                a_P += a_E\n                T_b = T_exact_func(1.0, y_p)\n                b[p] += a_E * T_b\n                \n            # South face\n            if j > 0:  # Interior face\n                k_s_face = k_func(x_p) # k is constant along y-normal face\n                a_S = k_s_face * dx / dy\n                A[p, p - Nx] = -a_S\n                a_P += a_S\n            else:  # Boundary face (y=0)\n                k_s_face = k_func(x_p)\n                a_S = k_s_face * dx / (dy / 2.0)\n                a_P += a_S\n                T_b = T_exact_func(x_p, 0.0)\n                b[p] += a_S * T_b\n\n            # North face\n            if j  Ny - 1:  # Interior face\n                k_n_face = k_func(x_p)\n                a_N = k_n_face * dx / dy\n                A[p, p + Nx] = -a_N\n                a_P += a_N\n            else:  # Boundary face (y=1)\n                k_n_face = k_func(x_p)\n                a_N = k_n_face * dx / (dy / 2.0)\n                a_P += a_N\n                T_b = T_exact_func(x_p, 1.0)\n                b[p] += a_N * T_b\n                \n            A[p, p] = a_P\n\n    # Solve the linear system\n    A_csr = A.tocsr()\n    T_numerical_flat = spsolve(A_csr, b)\n    T_numerical = T_numerical_flat.reshape((Ny, Nx))\n    \n    # Calculate discrete l2-norm of the error\n    T_exact_grid = T_exact_func(xx.T, yy.T) # meshgrid used 'xy' indexing for assembly logic\n    error = np.sqrt(np.sum((T_numerical - T_exact_grid)**2 * dx * dy))\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        {'id': 1, 'k0': 2.0, 'alpha': 0.0, 'Nx': 40, 'Ny': 40, 'type': 'error'},\n        {'id': 2, 'k0': 1.0, 'alpha': 1.0, 'Nx': 40, 'Ny': 40, 'type': 'error'},\n        {'id': 3, 'k0': 1.0, 'alpha': 1.0, 'Nx': 8, 'Ny': 8, 'type': 'error'},\n        {'id': 4, 'k0': 1.0, 'alpha': 1.0, 'Nx_coarse': 20, 'Ny_coarse': 20, 'type': 'order'}\n    ]\n\n    results = []\n    \n    # Case 1\n    case1 = test_cases[0]\n    e1 = solve_pde(case1['Nx'], case1['Ny'], case1['k0'], case1['alpha'])\n    results.append(e1)\n    \n    # Case 2\n    case2 = test_cases[1]\n    e2 = solve_pde(case2['Nx'], case2['Ny'], case2['k0'], case2['alpha'])\n    results.append(e2)\n\n    # Case 3\n    case3 = test_cases[2]\n    e3 = solve_pde(case3['Nx'], case3['Ny'], case3['k0'], case3['alpha'])\n    results.append(e3)\n\n    # Case 4\n    case4 = test_cases[3]\n    e_coarse = solve_pde(case4['Nx_coarse'], case4['Ny_coarse'], case4['k0'], case4['alpha'])\n    e_fine = solve_pde(case4['Nx_coarse'] * 2, case4['Ny_coarse'] * 2, case4['k0'], case4['alpha'])\n    p4 = np.log(e_coarse / e_fine) / np.log(2.0)\n    results.append(p4)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}