{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的数值方法之前，通过解析方法来理解非线性如何影响基本概念是至关重要的。本练习将引导你推导一个具有线性温度相关导热系数的一维平板的有效热阻。通过这个过程，你将掌握处理温度相关物性的基本解析技巧，并为更复杂的计算问题奠定坚实的理论基础。",
            "id": "3976335",
            "problem": "厚度为 $L$、横截面积恒为 $A$ 的长板，在一维空间 $x \\in [0,L]$ 上进行稳态导热，无内部热源。边界温度给定为 $T(0)=T_{0}$ 和 $T(L)=T_{L}$，且 $T_{0} \\neq T_{L}$。热导率随温度变化，其关系为 $k(T)=k_{0}\\left(1+\\beta T\\right)$，其中 $k_{0}0$ 和 $\\beta$ 是常数，并且对于 $T_{0}$ 和 $T_{L}$ 之间的所有温度，都有 $k(T)0$。设通过该板传导的热流率为 $Q$，定义有效热阻 $R_{\\text{eff}}$ 为 $R_{\\text{eff}} \\equiv (T_{0}-T_{L})/Q$。\n\n从稳态一维能量守恒和傅里叶热传导定律出发，推导 $R_{\\text{eff}}$ 关于 $L$、$A$、$k_{0}$、$\\beta$、$T_{0}$ 和 $T_{L}$ 的显式闭合形式表达式。然后，在 $k(T)$ 在该温度范围内保持为正的约束下，简要解释 $R_{\\text{eff}}$ 如何随参数 $\\beta$ 变化。你的最终答案必须是 $R_{\\text{eff}}$ 的一个单一解析表达式；不要提供不等式或方程式。无需进行数值计算。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 几何形状：厚度为 $L$、横截面积恒为 $A$ 的长板。\n- 空间域：一维，$x \\in [0,L]$。\n- 条件：稳态，无内部热源。\n- 边界条件：$T(0)=T_{0}$ 和 $T(L)=T_{L}$。\n- 约束条件：$T_{0} \\neq T_{L}$。\n- 材料性质：热导率 $k(T)=k_{0}(1+\\beta T)$，其中 $k_{0}0$ 和 $\\beta$ 是常数。\n- 物理约束：对于 $T_{0}$ 和 $T_{L}$ 之间的所有温度，都有 $k(T)0$。\n- 定义：热流率为 $Q$；有效热阻为 $R_{\\text{eff}} \\equiv (T_{0}-T_{L})/Q$。\n- 任务：推导 $R_{\\text{eff}}$ 的闭合形式表达式，并解释其随 $\\beta$ 的变化。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于热传导的基本原理，即能量守恒方程和傅里叶定律。使用随温度变化的热导率，特别是线性模型，是简单情况下的一个标准且物理上现实的扩展。该问题在科学上是合理的。\n- **适定性**：该问题是一个一维稳态边值问题。根据物理原理将得到一个一阶常微分方程，两个给定的温度边界条件足以确定温度分布的唯一解，从而确定热流率 $Q$ 的唯一解。该问题是适定的。\n- **客观性**：语言精确，所用术语是热工领域的标准术语。该问题是客观的。\n- **完整性和一致性**：该问题提供了所有必要信息（几何形状、边界条件、材料性质定律），并且不包含内部矛盾。约束条件 $k(T)  0$ 确保了物理模型的有效性。\n- **其他缺陷**：该问题没有表现出任何其他无效标志，如不切实际、结构不良、微不足道或无法验证。\n\n**步骤3：结论与行动**\n该问题被视为**有效**。将推导解答。\n\n无内部热源的一维稳态热传导的控制方程由能量守恒原理导出：\n$$ \\frac{d}{dx} \\left( q_x \\right) = 0 $$\n其中 $q_x$ 是 $x$ 方向的热通量。该方程意味着 $q_x$ 在整个板内是一个常数。通过横截面积恒为 $A$ 的板的总热流率 $Q$ 由 $Q = A q_x$ 给出。因此，$Q$ 相对于 $x$ 也是一个常数。\n\n傅里叶热传导定律将热通量与温度梯度联系起来：\n$$ q_x = -k(T) \\frac{dT}{dx} $$\n代入恒定的热流率 $Q$，我们得到：\n$$ \\frac{Q}{A} = -k(T) \\frac{dT}{dx} $$\n我们已知热导率 $k(T)$ 是温度 $T$ 的线性函数：\n$$ k(T) = k_{0}(1+\\beta T) $$\n将此表达式代入方程，得出：\n$$ \\frac{Q}{A} = -k_{0}(1+\\beta T) \\frac{dT}{dx} $$\n这是一个一阶常微分方程。我们可以用分离变量法求解。我们重新整理方程，将包含 $T$ 的项分到一边，将包含 $x$ 的项分到另一边：\n$$ \\frac{Q}{A} dx = -k_{0}(1+\\beta T) dT $$\n为了求出以边界温度表示的总热流率 $Q$，我们对该方程沿板的厚度进行积分。空间变量 $x$ 从 $0$ 积分到 $L$，而温度 $T$ 从相应的边界温度 $T(0)=T_{0}$ 积分到 $T(L)=T_{L}$。\n$$ \\int_{0}^{L} \\frac{Q}{A} dx = \\int_{T_{0}}^{T_{L}} -k_{0}(1+\\beta T) dT $$\n由于 $Q$、$A$ 和 $k_{0}$ 是常数，我们可以将它们移出积分号：\n$$ \\frac{Q}{A} \\int_{0}^{L} dx = -k_{0} \\int_{T_{0}}^{T_{L}} (1+\\beta T) dT $$\n对两边进行积分：\n$$ \\frac{Q}{A} [x]_{0}^{L} = -k_{0} \\left[ T + \\frac{\\beta T^2}{2} \\right]_{T_{0}}^{T_{L}} $$\n$$ \\frac{Q L}{A} = -k_{0} \\left( \\left( T_{L} + \\frac{\\beta T_{L}^2}{2} \\right) - \\left( T_{0} + \\frac{\\beta T_{0}^2}{2} \\right) \\right) $$\n重新整理括号内的项：\n$$ \\frac{Q L}{A} = -k_{0} \\left( (T_{L} - T_{0}) + \\frac{\\beta}{2}(T_{L}^2 - T_{0}^2) \\right) $$\n我们使用代数恒等式 $a^2 - b^2 = (a-b)(a+b)$ 对 $T_{L}^2 - T_{0}^2$ 项进行因式分解：\n$$ \\frac{Q L}{A} = -k_{0} \\left( (T_{L} - T_{0}) + \\frac{\\beta}{2}(T_{L} - T_{0})(T_{L} + T_{0}) \\right) $$\n提取公因式 $(T_{L} - T_{0})$：\n$$ \\frac{Q L}{A} = -k_{0} (T_{L} - T_{0}) \\left( 1 + \\frac{\\beta}{2}(T_{L} + T_{0}) \\right) $$\n利用 $-(T_L - T_0) = T_0 - T_L$，方程可写为：\n$$ \\frac{Q L}{A} = k_{0} (T_{0} - T_{L}) \\left( 1 + \\frac{\\beta}{2}(T_{0} + T_{L}) \\right) $$\n问题将有效热阻定义为 $R_{\\text{eff}} \\equiv (T_{0}-T_{L})/Q$。我们重新整理上述方程来求这个比值。\n$$ \\frac{T_{0}-T_{L}}{Q} = \\frac{L}{A k_{0} \\left( 1 + \\frac{\\beta}{2}(T_{0} + T_{L}) \\right)} $$\n因此，有效热阻的表达式为：\n$$ R_{\\text{eff}} = \\frac{L}{A k_{0} \\left( 1 + \\frac{\\beta}{2}(T_{0} + T_{L}) \\right)} $$\n这个表达式可以通过定义一个平均热导率 $k_{\\text{avg}}$ 来解释，该平均热导率在边界温度的算术平均值 $T_{\\text{avg}} = (T_{0}+T_{L})/2$ 处计算。\n$$ k_{\\text{avg}} = k(T_{\\text{avg}}) = k_{0}(1 + \\beta T_{\\text{avg}}) = k_{0}\\left(1 + \\beta \\frac{T_{0}+T_{L}}{2}\\right) $$\n于是，有效热阻的形式类似于常数物性情况下的形式：\n$$ R_{\\text{eff}} = \\frac{L}{A k_{\\text{avg}}} $$\n$R_{\\text{eff}}$ 随参数 $\\beta$ 的变化可以从其表达式中分析。热阻 $R_{\\text{eff}}$ 与项 $1 + \\frac{\\beta}{2}(T_{0} + T_{L})$ 成反比。假设温度是在绝对温标（例如，开尔文）上测量的，那么总和 $T_{0}+T_{L}$ 是正的。\n- 如果 $\\beta  0$，热导率随温度升高而增加。分母 $1 + \\frac{\\beta}{2}(T_{0} + T_{L})$ 大于 $1$。与 $\\beta=0$ 的情况相比，这会导致有效热阻 $R_{\\text{eff}}$ 更低。\n- 如果 $\\beta  0$，热导率随温度升高而降低。分母小于 $1$（但必须为正，这由问题中 $k(T)0$ 在整个温度范围内成立的约束所保证）。与 $\\beta=0$ 的情况相比，这会导致有效热阻 $R_{\\text{eff}}$ 更高。\n总而言之，$R_{\\text{eff}}$ 是 $\\beta$ 的单调递减函数。",
            "answer": "$$ \\boxed{\\frac{L}{A k_{0} \\left(1 + \\frac{\\beta}{2}(T_{0} + T_{L})\\right)}} $$"
        },
        {
            "introduction": "在掌握了基本分析之后，我们将转向计算实践，因为大多数真实的非线性问题都无法简单地解析求解。本练习要求你为一个边界温度未知的实际问题建立一个非线性代数方程，并实现强大的牛顿-拉夫逊（Newton-Raphson）方法来求解它。这是任何计算工程师在处理非线性传热问题时都必须具备的核心技能。",
            "id": "3976312",
            "problem": "考虑一个占据域 $0 \\le x \\le L$ 的均匀平板中的一维稳态热传导，其中空间坐标 $x$ 的单位为米。在表面 $x=0$ 处的热通量边界条件被指定为恒定值 $q''_0$，单位为瓦特/平方米。在背面 $x=L$ 处的温度被指定为 $T_b$，单位为开尔文。热导率 $k(T)$ 随温度变化，且该平板内部没有热源。假设该平板处于传导模型有效且 $k(T)  0$ 的温度范围内。使用傅里叶定律的符号约定 $q''(x) = - k(T) \\, dT/dx$，其中 $q''(x)$ 是局部热通量。\n\n从基本热传导原理出发，当 $k(T)$ 依赖于温度时，推导未知表面温度 $T_s = T(x=0)$ 必须满足的控制关系式。证明该关系式是关于 $T_s$ 的非线性代数方程，并设计一个牛顿迭代法，在给定 $q''_0$、$L$、$T_b$ 和 $k(T)$ 的指定函数形式下求解 $T_s$。\n\n您的实现必须遵循以下计算要求：\n- 根据 $T_s$ 定义标量残差函数，该函数强制执行由上述边界条件所隐含的稳态一维传导的相应能量平衡。\n- 使用残差对 $T_s$ 的导数推导牛顿更新公式，该导数用在当前迭代点计算的 $k(T)$ 表示。\n- 实现一个鲁棒的算法，使其能对所提供的测试用例收敛，包括适用于 $k(T)$ 随 $T$ 变化的非线性方程的适当保护措施，并报告每个用例的最终 $T_s$。\n\n物理单位：\n- 表面温度 $T_s$ 以开尔文报告。\n- 所有输入必须按以下单位进行解释：$q''_0$ 的单位是瓦特/平方米 ($\\mathrm{W}/\\mathrm{m}^2$)，$L$ 的单位是米 ($\\mathrm{m}$)，$T$ 的单位是开尔文 ($\\mathrm{K}$)，$k$ 的单位是瓦特/米·开尔文 ($\\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$)。\n\n测试套件：\n使用以下五个参数集。在所有情况下，$T_b$ 都是 $x=L$ 处的温度。\n\n1. 用例 A (线性热导率):\n   - $k(T) = k_0 \\left[ 1 + \\alpha \\left( T - T_{\\mathrm{ref}} \\right) \\right]$\n   - $k_0 = 200 \\ \\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$，$\\alpha = 1\\times 10^{-3} \\ \\mathrm{K}^{-1}$，$T_{\\mathrm{ref}} = 300 \\ \\mathrm{K}$\n   - $L = 0.01 \\ \\mathrm{m}$，$q''_0 = 5\\times 10^{5} \\ \\mathrm{W}/\\mathrm{m}^2$，$T_b = 300 \\ \\mathrm{K}$\n\n2. 用例 B (指数热导率):\n   - $k(T) = k_0 \\exp\\left[ \\beta \\left( T - T_{\\mathrm{ref}} \\right) \\right]$\n   - $k_0 = 150 \\ \\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$，$\\beta = 5\\times 10^{-3} \\ \\mathrm{K}^{-1}$，$T_{\\mathrm{ref}} = 350 \\ \\mathrm{K}$\n   - $L = 0.02 \\ \\mathrm{m}$，$q''_0 = 1\\times 10^{6} \\ \\mathrm{W}/\\mathrm{m}^2$，$T_b = 350 \\ \\mathrm{K}$\n\n3. 用例 C (温度增量的二次热导率):\n   - $k(T) = k_0 \\left[ 1 + a_1 \\left( T - T_{\\mathrm{ref}} \\right) + a_2 \\left( T - T_{\\mathrm{ref}} \\right)^2 \\right]$\n   - $k_0 = 100 \\ \\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$，$a_1 = 2\\times 10^{-3} \\ \\mathrm{K}^{-1}$，$a_2 = 1\\times 10^{-6} \\ \\mathrm{K}^{-2}$，$T_{\\mathrm{ref}} = 300 \\ \\mathrm{K}$\n   - $L = 0.005 \\ \\mathrm{m}$，$q''_0 = -2\\times 10^{5} \\ \\mathrm{W}/\\mathrm{m}^2$，$T_b = 400 \\ \\mathrm{K}$\n\n4. 用例 D (分段线性热导率):\n   - $k(T) = \\begin{cases}\n     50 + 0.1 \\left( T - 300 \\right),   T \\le 600 \\\\\n     80 + 0.05 \\left( T - 600 \\right),   T  600\n     \\end{cases}$\n   - $L = 0.03 \\ \\mathrm{m}$，$q''_0 = 3\\times 10^{5} \\ \\mathrm{W}/\\mathrm{m}^2$，$T_b = 450 \\ \\mathrm{K}$\n\n5. 用例 E (使用指数热导率的零通量检查):\n   - $k(T) = k_0 \\exp\\left( \\beta T \\right)$\n   - $k_0 = 75 \\ \\mathrm{W}/\\mathrm{m}\\cdot\\mathrm{K}$，$\\beta = 2\\times 10^{-3} \\ \\mathrm{K}^{-1}$\n   - $L = 0.01 \\ \\mathrm{m}$，$q''_0 = 0 \\ \\mathrm{W}/\\mathrm{m}^2$，$T_b = 500 \\ \\mathrm{K}$\n\n答案规范：\n- 您的程序必须使用从第一性原理推导出的牛顿迭代法计算五个用例中每一个的表面温度 $T_s$，并且必须包含适当的保护措施以确保对于 $k(T)0$ 的单调函数 $k(T)$ 能够收敛。\n- 将每个计算出的 $T_s$ 以开尔文表示，并四舍五入到六位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按 $\\left[T_s^{(A)}, T_s^{(B)}, T_s^{(C)}, T_s^{(D)}, T_s^{(E)}\\right]$ 的顺序排列，其中上标表示用例标签；例如，$\\left[325.123456,450.654321,390.000000,588.000000,500.000000\\right]$。",
            "solution": "**控制方程和数值方法的推导**\n\n**1. 控制物理原理**\n对于无内部热源的一维稳态热传导，其控制微分方程为：\n$$\n\\frac{d}{dx}\\left( q''(x) \\right) = 0\n$$\n其中 $q''(x)$ 是局部热通量。这意味着热通量 $q''(x)$ 在域 $[0, L]$ 内处处恒定。根据在 $x=0$ 处的边界条件，我们有 $q''(x) = q''(0) = q''_0$。\n\n傅里叶热传导定律将热通量与温度梯度联系起来：\n$$\nq''(x) = -k(T) \\frac{dT}{dx}\n$$\n由于 $q''(x) = q''_0$，我们得到：\n$$\nq''_0 = -k(T) \\frac{dT}{dx}\n$$\n\n**2. 控制方程的积分形式**\n为了找到边界温度之间的关系，我们分离变量并对整个平板从 $x=0$ 到 $x=L$ 进行积分：\n$$\nq''_0 \\, dx = -k(T) \\, dT\n$$\n$$\n\\int_{x=0}^{x=L} q''_0 \\, dx = \\int_{T(0)}^{T(L)} -k(T) \\, dT\n$$\n给定边界条件 $T(0) = T_s$ 和 $T(L) = T_b$，积分结果为：\n$$\nq''_0 [x]_0^L = - \\int_{T_s}^{T_b} k(T) \\, dT\n$$\n$$\nq''_0 L = \\int_{T_b}^{T_s} k(T) \\, dT\n$$\n这就是未知表面温度 $T_s$ 必须满足的基本积分关系式。它将穿过平板的总热流（左侧）与热导率在平板温度范围内的积分（右侧）相等同。\n\n**3. 非线性残差方程的构建**\n为了使用寻根算法求解 $T_s$，我们定义一个残差函数 $R(T_s)$，使其根对应于问题的解。我们将积分方程重排为 $R(T_s) = 0$ 的形式：\n$$\nR(T_s) = \\int_{T_b}^{T_s} k(T) \\, dT - q''_0 L = 0\n$$\n这是一个关于 $T_s$ 的非线性代数方程，因为积分的值通过由 $k(T)$ 定义的非平凡函数关系依赖于 $T_s$。\n\n**4. 牛顿-拉夫逊迭代法**\n牛顿-拉夫逊法是一种用于寻找实值函数根的迭代技术。其迭代更新公式为：\n$$\nT_{s, n+1} = T_{s, n} - \\frac{R(T_{s, n})}{R'(T_{s, n})}\n$$\n其中 $T_{s, n}$ 是在第 $n$ 次迭代时对根的估计值，$R'(T_s)$ 是残差函数对 $T_s$ 的导数。\n\n为了求得 $R'(T_s)$，我们对残差函数求关于 $T_s$ 的导数：\n$$\nR'(T_s) = \\frac{d}{dT_s} \\left( \\int_{T_b}^{T_s} k(T) \\, dT - q''_0 L \\right)\n$$\n根据莱布尼茨积分法则（微积分基本定理的一种特殊情况），积分项的导数为：\n$$\n\\frac{d}{dT_s} \\left( \\int_{T_b}^{T_s} k(T) \\, dT \\right) = k(T_s)\n$$\n$q''_0 L$ 项是关于 $T_s$ 的常数，因此其导数为零。所以，残差的导数就是热导率在表面温度 $T_s$ 处的值：\n$$\nR'(T_s) = k(T_s)\n$$\n将 $R(T_s)$ 和 $R'(T_s)$ 的表达式代入牛顿-拉夫逊公式，得到此问题的特定更新规则：\n$$\nT_{s, n+1} = T_{s, n} - \\frac{\\int_{T_b}^{T_{s, n}} k(T) \\, dT - q''_0 L}{k(T_{s, n})}\n$$\n\n**5. 实现策略**\n通过实现此迭代方案来找到解。\n- **初始猜测**：一个好的初始猜测值 $T_{s,0}$ 可以通过将问题线性化得到，即假设 $k(T)$ 为常数且等于其在已知边界处的值 $k(T_b)$。这样积分关系简化为 $q''_0 L \\approx k(T_b)(T_s - T_b)$，从而给出初始猜测值：\n  $$\n  T_{s,0} = T_b + \\frac{q''_0 L}{k(T_b)}\n  $$\n- **迭代**：迭代过程持续进行，直到残差的绝对值 $|R(T_s)|$ 低于指定的容差，或者达到最大迭代次数。\n- **保护措施**：由于问题保证 $k(T)  0$，函数 $R(T_s)$ 是单调的，这确保了唯一解的存在，并且牛顿法通常是鲁棒的。主要的保护措施是设置最大迭代次数以防止无限循环（在此不太可能发生），以及检查除数是否过小（如果 $k(T_s)$ 趋近于零），但这在这些测试用例中不是问题。\n- **积分**：对于每种 $k(T)$ 的函数形式，其定积分都通过解析方式计算，以便在残差计算中使用。对于给定的函数，这比数值求积更准确、更高效。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the surface temperature of a slab with temperature-dependent\n    thermal conductivity using a Newton-Raphson solver.\n    \"\"\"\n\n    def newton_solver(residual_func, derivative_func, T0, tol=1e-8, max_iter=50):\n        \"\"\"\n        A robust Newton-Raphson solver for a scalar nonlinear equation.\n        \"\"\"\n        Ts = float(T0)\n        for _ in range(max_iter):\n            res = residual_func(Ts)\n            if abs(res)  tol:\n                return Ts\n\n            deriv = derivative_func(Ts)\n            if abs(deriv)  1e-12:  # Safeguard against division by zero\n                # This should not be reached for k(T) > 0.\n                raise ValueError(\"Derivative is too small; Newton's method fails.\")\n            \n            # Standard Newton-Raphson step\n            step = -res / deriv\n            \n            # A simple step-size damper for robustness, although not strictly\n            # necessary for these monotonic problems.\n            max_step = 100.0 # Limit temperature change to 100K per step\n            if abs(step) > max_step:\n                step = np.sign(step) * max_step\n\n            Ts += step\n\n        # If loop finishes without convergence, raise an error.\n        raise RuntimeError(f\"Newton's method did not converge after {max_iter} iterations.\")\n\n    # --- Test Case Definitions ---\n    \n    # Case A: Linear conductivity\n    # k(T) = k0 * (1 + alpha * (T - T_ref))\n    params_A = {'k0': 200.0, 'alpha': 1e-3, 'T_ref': 300.0, \n                'L': 0.01, 'q0': 5e5, 'Tb': 300.0}\n    \n    def k_A(T, p):\n        return p['k0'] * (1.0 + p['alpha'] * (T - p['T_ref']))\n    \n    def integral_k_A(Ts, p):\n        # Antiderivative of k0*(1-alpha*T_ref) + k0*alpha*T is\n        # k0*(1-alpha*T_ref)*T + 0.5*k0*alpha*T^2\n        def primitive(T_val):\n            return p['k0'] * ((1.0 - p['alpha'] * p['T_ref']) * T_val + \\\n                              0.5 * p['alpha'] * T_val**2)\n        return primitive(Ts) - primitive(p['Tb'])\n\n    # Case B: Exponential conductivity\n    # k(T) = k0 * exp(beta * (T - T_ref))\n    params_B = {'k0': 150.0, 'beta': 5e-3, 'T_ref': 350.0,\n                'L': 0.02, 'q0': 1e6, 'Tb': 350.0}\n    \n    def k_B(T, p):\n        return p['k0'] * np.exp(p['beta'] * (T - p['T_ref']))\n    \n    def integral_k_B(Ts, p):\n        # Antiderivative of k0 * exp(beta*(T-T_ref)) is (k0/beta) * exp(beta*(T-T_ref))\n        def primitive(T_val):\n            return (p['k0'] / p['beta']) * np.exp(p['beta'] * (T_val - p['T_ref']))\n        return primitive(Ts) - primitive(p['Tb'])\n\n    # Case C: Quadratic conductivity\n    # k(T) = k0 * (1 + a1*(T-T_ref) + a2*(T-T_ref)^2)\n    params_C = {'k0': 100.0, 'a1': 2e-3, 'a2': 1e-6, 'T_ref': 300.0,\n                'L': 0.005, 'q0': -2e5, 'Tb': 400.0}\n\n    def k_C(T, p):\n        dT = T - p['T_ref']\n        return p['k0'] * (1.0 + p['a1'] * dT + p['a2'] * dT**2)\n\n    def integral_k_C(Ts, p):\n        # Antiderivative of k0*(1+a1*u+a2*u^2) where u=T-T_ref is\n        # k0*(u + a1/2*u^2 + a2/3*u^3)\n        def primitive(T_val):\n            dT = T_val - p['T_ref']\n            return p['k0'] * (dT + (p['a1'] / 2.0) * dT**2 + (p['a2'] / 3.0) * dT**3)\n        return primitive(Ts) - primitive(p['Tb'])\n\n    # Case D: Piecewise-linear conductivity\n    params_D = {'L': 0.03, 'q0': 3e5, 'Tb': 450.0, 'T_split': 600.0}\n\n    def k_D(T, p):\n        if T = p['T_split']:\n            return 50.0 + 0.1 * (T - 300.0) # 20 + 0.1*T\n        else:\n            return 80.0 + 0.05 * (T - 600.0) # 50 + 0.05*T\n\n    def integral_k_D(Ts, p):\n        T_split = p['T_split']\n\n        def primitive_1(T): return 20.0 * T + 0.05 * T**2\n        def primitive_2(T): return 50.0 * T + 0.025 * T**2\n        \n        # Integral from a common reference point (arbitrarily 0K) to T\n        def integral_from_ref(T):\n            if T = T_split:\n                return primitive_1(T)\n            else:\n                # Value at split + integral over the second part\n                val_at_split = primitive_1(T_split)\n                integral_part2 = primitive_2(T) - primitive_2(T_split)\n                return val_at_split + integral_part2\n        \n        return integral_from_ref(Ts) - integral_from_ref(p['Tb'])\n\n\n    # Case E: Zero-flux check\n    params_E = {'k0': 75.0, 'beta': 2e-3, 'L': 0.01, 'q0': 0.0, 'Tb': 500.0}\n\n    def k_E(T, p):\n        return p['k0'] * np.exp(p['beta'] * T)\n\n    def integral_k_E(Ts, p):\n        def primitive(T_val):\n            return (p['k0'] / p['beta']) * np.exp(p['beta'] * T_val)\n        return primitive(Ts) - primitive(p['Tb'])\n\n    test_cases = [\n        (params_A, k_A, integral_k_A),\n        (params_B, k_B, integral_k_B),\n        (params_C, k_C, integral_k_C),\n        (params_D, k_D, integral_k_D),\n        (params_E, k_E, integral_k_E),\n    ]\n\n    results = []\n    for params, k_func, integral_k_func in test_cases:\n        q0 = params['q0']\n        L = params['L']\n        Tb = params['Tb']\n        \n        # Define residual and its derivative for the solver\n        residual = lambda Ts: integral_k_func(Ts, params) - q0 * L\n        derivative = lambda Ts: k_func(Ts, params)\n        \n        # Calculate a physically-based initial guess\n        k_at_Tb = k_func(Tb, params)\n        if abs(k_at_Tb)  1e-12: # Avoid division by zero in guess\n            T0 = Tb \n        else:\n            # T_s approx T_b + (q0 * L) / k(T_b)\n            T0 = Tb + (q0 * L) / k_at_Tb\n\n        # In zero-flux case, initial guess is the exact solution\n        if q0 == 0.0:\n            T_final = Tb\n        else:\n            T_final = newton_solver(residual, derivative, T0)\n        \n        # Append result rounded to 6 decimal places\n        results.append(f\"{T_final:.6f}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "编写求解器只是战斗的一半；我们还必须验证其正确性。本练习将介绍代码验证的关键步骤，即“制造解方法”（Method of Manufactured Solutions, MMS）。你将学习如何通过构造一个具有已知精确解的问题，来严格验证数值代码的正确性和精度，这是确保计算结果可靠性的黄金标准。",
            "id": "3976326",
            "problem": "考虑在一个单连通域 $\\Omega = (0,1)\\times(0,1)$ 内的稳态二维热传导，其热导率随温度变化。对于具有体积热源的连续介质，其能量平衡的控制方程强形式为\n$$\n\\nabla \\cdot \\big(k(T)\\,\\nabla T\\big) + \\dot{q}(T) = 0 \\quad \\text{in } \\Omega,\n$$\n在边界 $\\partial \\Omega$ 上给定狄利克雷边界条件 $T = T^{\\star}(x,y)$。请您在构造解法（Method of Manufactured Solutions, MMS）的框架内构造一个解，该方法定义为有意选择一个精确解 $T(x,y)$ 及相关数据，使得控制方程被恒等满足。请按以下步骤进行：\n\n- 选择构造的精确温度场为\n$$\nT(x,y) = T_{c} + \\gamma\\,(x^{2} + y^{2}),\n$$\n其中 $T_{c}  0$ 和 $\\gamma  0$ 是常数，并令边界条件为 $T^{\\star}(x,y) = T(x,y)$，适用于 $(x,y) \\in \\partial \\Omega$。\n\n- 设定一个严格为正且单调的指数形式热导率\n$$\nk(T) = k_{0}\\,\\exp(\\alpha\\,T),\n$$\n其中 $k_{0}  0$，$\\alpha$ 为实参数。\n\n从上述守恒定律和适用于 $\\nabla \\cdot \\big(k(T)\\,\\nabla T\\big)$ 的基本矢量微积分恒等式出发，推导一个源函数 $\\dot{q}(T)$，该函数严格表示为 $T$ 的函数（不含显式的 $x$ 或 $y$），使得所选的 $T(x,y)$ 对于给定的 $k(T)$ 能精确满足控制方程。您的推导必须从所述的能量平衡方程开始，并遵循基本原理进行；除了标准的微分法则外，不要引用任何专门的预推导公式。\n\n此外，请为一个求解非线性问题的高级计算热工代码概述一个合适的验证计划，包括但不限于：牛顿型求解器的线性化一致性、在构造解处的离散残差评估，以及数值误差范数相对于精确解 $T(x,y)$ 的网格收敛性评估。\n\n请以闭式表达式对 $\\big(k(T),\\,\\dot{q}(T)\\big)$ 的形式提供您的最终答案，$k(T)$ 的单位为 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，$\\dot{q}(T)$ 的单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}$。无需进行数值计算；给出精确的符号表达式。请按照最终答案指南中指定的方式，将最终的表达式对以单行矩阵形式呈现。",
            "solution": "首先对该问题进行严格的验证过程。\n\n### 步骤1：提取给定条件\n- **控制方程**：稳态能量平衡方程为 $\\nabla \\cdot \\big(k(T)\\,\\nabla T\\big) + \\dot{q}(T) = 0$，在域 $\\Omega$ 内。\n- **域**：$\\Omega = (0,1)\\times(0,1)$，一个单连通的方形域。\n- **边界条件**：在边界 $\\partial \\Omega$ 上给定狄利克雷条件 $T = T^{\\star}(x,y)$。\n- **构造解**：选择的精确温度场为 $T(x,y) = T_{c} + \\gamma\\,(x^{2} + y^{2})$，其中 $T_{c}  0$ 和 $\\gamma  0$ 为常数。边界数据设为 $T^{\\star}(x,y) = T(x,y)$，适用于 $(x,y) \\in \\partial \\Omega$。\n- **热导率**：随温度变化的热导率为 $k(T) = k_{0}\\,\\exp(\\alpha\\,T)$，其中 $k_{0}  0$，$\\alpha$ 为实参数。\n- **目标1**：推导一个源函数 $\\dot{q}(T)$，该函数严格表示为温度 $T$ 的函数，并且对于给定的 $T(x,y)$ 和 $k(T)$ 满足控制方程。推导必须从控制方程开始，并使用基本原理。\n- **目标2**：为一个使用所推导的构造解的计算代码概述一个验证计划。\n- **最终答案格式**：最终答案为表达式对 $\\big(k(T),\\,\\dot{q}(T)\\big)$。\n\n### 步骤2：使用提取的给定条件进行验证\n1.  **科学依据**：该问题基于热传导方程，这是一条基本的物理定律。构造解法（MMS）是计算科学与工程领域中用于代码验证的一种标准且严谨的技术。所选的温度场和热导率形式均为数学上有效的函数。该问题在科学上是合理的。\n2.  **适定性**：该问题不是要求解 $T$，而是要构造一个源项 $\\dot{q}(T)$，使得所选的 $T(x,y)$ 成为一个精确解。这是MMS的定义，是一个适定的任务。可以从所提供的函数中确定唯一的源项。\n3.  **目标**：问题使用精确的数学和技术语言陈述，没有歧义或主观论断。\n4.  **不完整或矛盾的设置**：问题提供了所有必要信息：控制偏微分方程、域、待构造解的显式形式，以及材料属性的函数形式。不存在矛盾。约束条件 $T_c  0$、$\\gamma  0$ 和 $k_0  0$ 确保了物理属性和温度在域上为正且表现良好。\n5.  **不切实际或不可行**：虽然构造解是人为的，但它并非物理上不可能。温度场是一个简单的抛物面，指数型热导率模型也很常见。MMS的目的不是模拟特定的物理实验，而是创建一个具有已知解析解的问题，用于验证数值代码。在此背景下，该设置是完全可行的。\n6.  **病态或结构不良**：任务定义清晰，能够得到 $\\dot{q}(T)$ 的唯一解。各项术语均无歧义。\n7.  **伪深刻、琐碎或同义反复**：该问题需要对矢量微积分和代数运算进行非平凡的应用。它涉及MMS的核心概念，包括将空间坐标的函数转换为因变量的函数，这是创建物理上合理的构造解的关键步骤。它并非琐碎问题。\n8.  **超出科学可验证性范围**：推导过程是一个完全可验证的数学过程。所提出的验证计划是计算物理领域的标准实践。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它在科学上合理、适定、完整，并符合计算工程领域中用于代码验证的既定实践。将推导解答。\n\n### 源函数 $\\dot{q}(T)$ 的推导\n起点是稳态热传导的控制方程：\n$$\n\\nabla \\cdot \\big(k(T)\\,\\nabla T\\big) + \\dot{q}(T) = 0\n$$\n由此，分离出源函数 $\\dot{q}(T)$：\n$$\n\\dot{q}(T) = -\\nabla \\cdot \\big(k(T)\\,\\nabla T\\big)\n$$\n我们对标量场 $k(T)$ 与矢量场 $\\nabla T$ 乘积的散度应用乘积法则，即 $\\nabla \\cdot (f\\mathbf{A}) = (\\nabla f) \\cdot \\mathbf{A} + f (\\nabla \\cdot \\mathbf{A})$：\n$$\n\\nabla \\cdot \\big(k(T)\\,\\nabla T\\big) = \\big(\\nabla k(T)\\big) \\cdot (\\nabla T) + k(T) \\big(\\nabla \\cdot (\\nabla T)\\big)\n$$\n梯度的散度是拉普拉斯算子，$\\nabla \\cdot (\\nabla T) = \\nabla^2 T$。对于 $\\nabla k(T)$ 项，我们使用梯度的链式法则：$\\nabla k(T) = \\frac{dk}{dT} \\nabla T$。\n将这些恒等式代回，得到：\n$$\n\\nabla \\cdot \\big(k(T)\\,\\nabla T\\big) = \\left(\\frac{dk}{dT} \\nabla T\\right) \\cdot (\\nabla T) + k(T) \\nabla^2 T = \\frac{dk}{dT} |\\nabla T|^2 + k(T) \\nabla^2 T\n$$\n因此，源函数必须是：\n$$\n\\dot{q}(T) = - \\left( \\frac{dk}{dT} |\\nabla T|^2 + k(T) \\nabla^2 T \\right)\n$$\n接下来，我们根据给定的构造解 $T(x,y) = T_{c} + \\gamma\\,(x^{2} + y^{2})$ 和热导率 $k(T) = k_{0}\\,\\exp(\\alpha\\,T)$ 来计算所需的各项。\n\n首先，我们计算温度场 $T(x,y)$ 的梯度和拉普拉斯算子：\n偏导数为：\n$$\n\\frac{\\partial T}{\\partial x} = 2\\gamma x \\quad \\text{and} \\quad \\frac{\\partial T}{\\partial y} = 2\\gamma y\n$$\n梯度矢量为 $\\nabla T = 2\\gamma x \\,\\mathbf{i} + 2\\gamma y \\,\\mathbf{j}$。\n梯度大小的平方是：\n$$\n|\\nabla T|^2 = \\left(\\frac{\\partial T}{\\partial x}\\right)^2 + \\left(\\frac{\\partial T}{\\partial y}\\right)^2 = (2\\gamma x)^2 + (2\\gamma y)^2 = 4\\gamma^2 (x^2 + y^2)\n$$\n二阶偏导数为：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} = 2\\gamma \\quad \\text{and} \\quad \\frac{\\partial^2 T}{\\partial y^2} = 2\\gamma\n$$\n温度场的拉普拉斯算子是：\n$$\n\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 2\\gamma + 2\\gamma = 4\\gamma\n$$\n其次，我们计算热导率 $k(T)$ 对温度 $T$ 的导数：\n$$\n\\frac{dk}{dT} = \\frac{d}{dT} \\left( k_{0}\\,\\exp(\\alpha\\,T) \\right) = \\alpha\\,k_{0}\\,\\exp(\\alpha\\,T) = \\alpha\\,k(T)\n$$\n现在我们将这些分量代入 $\\dot{q}(T)$ 的表达式中：\n$$\n\\dot{q}(T) = - \\left( \\big(\\alpha\\,k(T)\\big) \\big(4\\gamma^2(x^2+y^2)\\big) + k(T) (4\\gamma) \\right)\n$$\n我们可以提出公因式 $4\\gamma$ 和 $k(T)$：\n$$\n\\dot{q}(T) = -4\\gamma\\,k(T) \\left( \\alpha\\gamma(x^2+y^2) + 1 \\right)\n$$\n问题要求 $\\dot{q}(T)$ 严格表示为温度 $T$ 的函数，不显式依赖于空间坐标 $x$ 和 $y$。我们使用构造解的定义来建立这种关系：\n$$\nT = T_{c} + \\gamma(x^2+y^2) \\implies \\gamma(x^2+y^2) = T - T_c\n$$\n将此式代入 $\\dot{q}(T)$ 的表达式中，以消除显式的空间依赖性：\n$$\n\\dot{q}(T) = -4\\gamma\\,k(T) \\left( \\alpha(T - T_c) + 1 \\right)\n$$\n最后，我们代入 $k(T)$ 的完整表达式：\n$$\n\\dot{q}(T) = -4\\gamma\\,k_{0}\\,\\exp(\\alpha\\,T) \\big( \\alpha(T - T_{c}) + 1 \\big)\n$$\n这就是所要求的源函数。\n\n### 验证计划纲要\n对于一个高级计算热工代码（例如，有限元法代码），使用此构造解的验证计划将包括以下步骤：\n\n1.  **实现**：\n    -   将推导出的源函数 $\\dot{q}(T) = -4\\gamma\\,k_{0}\\,\\exp(\\alpha\\,T) \\big( \\alpha(T - T_{c}) + 1 \\big)$ 和热导率函数 $k(T) = k_0\\exp(\\alpha T)$ 实现到代码的材料属性和源项例程中。\n    -   通过在边界节点上计算 $T^{\\star}(x,y) = T_{c} + \\gamma(x^2+y^2)$ 来实现狄利克雷边界条件。\n\n2.  **线性化一致性（雅可比矩阵验证）**：\n    -   由有限元离散化产生的非线性方程组 $\\mathbf{R}(\\mathbf{T}) = \\mathbf{0}$，使用牛顿-拉弗森法求解，这需要雅可比矩阵 $\\mathbf{J} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{T}}$。\n    -   推导非线性项 $k(T)$ 和 $\\dot{q}(T)$ 对雅可比矩阵贡献的解析形式。这涉及导数 $\\frac{dk}{dT}$ 和 $\\frac{d\\dot{q}}{dT}$。\n    -   使用有限差分法数值逼近雅可比矩阵，例如，$J_{ij} \\approx \\frac{R_i(\\mathbf{T} + \\epsilon \\mathbf{e}_j) - R_i(\\mathbf{T})}{\\epsilon}$，其中 $\\mathbf{e}_j$ 是单位矢量。\n    -   在任意状态 $\\mathbf{T}$ 下，比较解析和数值逼近的雅可比矩阵。两者在取决于 $\\epsilon$ 的容差范围内一致，即验证了解析雅可比矩阵实现的正确性，这对牛顿求解器的二次收敛至关重要。\n\n3.  **离散残差评估**：\n    -   在网格的每个节点上评估精确的构造解 $T(x,y)$，以创建一个精确的离散解向量 $\\mathbf{T}_{exact}$。\n    -   将 $\\mathbf{T}_{exact}$ 代入代码的离散残差组装例程中，以计算 $\\mathbf{R}(\\mathbf{T}_{exact})$。\n    -   由于离散误差，$\\mathbf{R}(\\mathbf{T}_{exact})$ 不会为零。MMS是为了满足偏微分方程，而不是其离散近似。然而，当网格尺寸 $h \\to 0$ 时，范数 $||\\mathbf{R}(\\mathbf{T}_{exact})||$ 应以可预测的速率收敛到零。此测试可确认离散算子和源项的实现是一致的。\n\n4.  **网格收敛性评估**：\n    -   这是决定性的验证测试。\n    -   在域 $\\Omega = (0,1)\\times(0,1)$ 上定义一系列相继加密的网格。\n    -   在每个网格上，求解完整的非线性问题以获得数值解 $\\mathbf{T}_h$。\n    -   对于每个 $\\mathbf{T}_h$，通过与已知的精确解 $T(x,y)$ 比较来计算误差。误差使用函数范数来衡量，通常是 $L^2$ 范数：$e_{L^2} = \\left( \\int_\\Omega (T_h - T)^2 d\\Omega \\right)^{1/2}$。\n    -   理论收敛阶 $p$ 通过 $e \\approx C h^p$ 将误差与网格尺寸 $h$ 联系起来。通过在至少两个网格 $h_1$ 和 $h_2$ 上计算误差，可以计算出观察到的收敛阶 $p_{obs} = \\frac{\\ln(e_1/e_2)}{\\ln(h_1/h_2)}$。\n    -   验证 $p_{obs}$ 与离散化所用单元类型的理论收敛阶 $p$ 相匹配（例如，对于线性基函数，$L^2$ 范数的 $p \\approx 2$ 是预期的）。这验证了代码没有会破坏其设计精度的错误。\n\n$k(T)$ 和 $\\dot{q}(T)$ 的最终表达式如下所示。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} k_{0}\\,\\exp(\\alpha\\,T)  -4\\gamma\\,k_{0}\\,\\exp(\\alpha\\,T) \\big( \\alpha(T - T_{c}) + 1 \\big) \\end{pmatrix}\n}\n$$"
        }
    ]
}