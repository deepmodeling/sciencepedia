{
    "hands_on_practices": [
        {
            "introduction": "In ideal models, we often assume perfect contact between material layers. However, in real-world composites, microscopic gaps and imperfections at interfaces create a resistance to heat flow, resulting in a measurable temperature jump. This exercise  provides a foundational understanding of this phenomenon by modeling the interface as a layer with finite thermal contact resistance, $R_c$. By deriving the temperature drop from first principles and applying it to a multi-interface system, you will solidify your grasp of how to handle these non-ideal, yet critical, features in thermal analysis.",
            "id": "3960077",
            "problem": "A one-dimensional, steady, through-thickness heat flux $q''$ is imposed across a stack of four highly conductive solid layers arranged in series, producing three mechanical interfaces. The bulk conduction resistances of the solids are negligible compared to the interfacial resistances, so the total temperature drop is dominated by the interfaces. There is no internal heat generation, and the cross-sectional area is uniform and sufficiently large that edge effects may be neglected.\n\nYou are to model each imperfect mechanical contact as a vanishingly thin interphase that sustains the same heat flux $q''$ as the adjacent solids but allows a finite temperature jump across it.\n\nStarting from the heat diffusion equation, Fourier’s law, and interfacial energy balance, treat each interface as a thin layer of thickness $\\varepsilon \\to 0^{+}$ with finite effective thermal conductivity $k_{\\text{int}}$ and derive the expression for the temperature drop across a single interface in terms of $q''$ and a suitable interfacial resistance parameter. Then, using the result for interfaces in series, compute the temperature drops across all interfaces and the total interfacial temperature drop for the following data:\n- Through-thickness heat flux: $q'' = 1.75 \\times 10^{5}\\ \\mathrm{W\\,m^{-2}}$.\n- Interfacial thermal contact resistances: $R_{c,1} = 2.50 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}$, $R_{c,2} = 6.00 \\times 10^{-5}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}$, $R_{c,3} = 1.20 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}$.\n\nVerify that the sum of the individual interfacial temperature drops equals the total interfacial temperature drop obtained by treating the three interfaces as a single equivalent interface.\n\nExpress your final answer as a single row matrix $\\big[\\Delta T_{1}\\ \\Delta T_{2}\\ \\Delta T_{3}\\ \\Delta T_{\\text{total}}\\big]$ in Kelvin, rounded to four significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in one-dimensional, steady-state heat conduction involving thermal contact resistance. All necessary data are provided, and the assumptions are physically reasonable and clearly stated.\n\nThe solution proceeds in three parts as requested: first, the derivation of the temperature drop across an interface; second, the calculation of specific temperature drops; and third, the verification of the series resistance model.\n\n**Part 1: Derivation of the Interfacial Temperature Drop**\n\nWe begin with the general heat diffusion equation. For a one-dimensional, steady-state system with no internal heat generation, the equation simplifies to:\n$$ \\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) = 0 $$\nwhere $k$ is the thermal conductivity, $T$ is the temperature, and $x$ is the spatial coordinate. Integrating this equation once with respect to $x$ yields:\n$$ k \\frac{dT}{dx} = C_1 $$\nwhere $C_1$ is a constant of integration. By Fourier's law of conduction, the heat flux in the $x$-direction, $q_x''$, is given by:\n$$ q_x'' = -k \\frac{dT}{dx} $$\nComparing these two equations, we see that $C_1 = -q_x''$. This demonstrates that for this case, the heat flux must be constant throughout the conducting medium. The problem specifies a through-thickness heat flux $q''$, so we have $q_x'' = q''$.\n\nThe problem asks to model an imperfect interface as a vanishingly thin layer of thickness $\\varepsilon$ and effective thermal conductivity $k_{\\text{int}}$. Let this layer be centered at position $x_i$. The heat flux $q''$ is constant across this layer. Applying Fourier's law to this thin layer, we can write:\n$$ q'' = -k_{\\text{int}} \\frac{T(x_i + \\varepsilon/2) - T(x_i - \\varepsilon/2)}{\\varepsilon} $$\nwhere $T(x_i - \\varepsilon/2)$ and $T(x_i + \\varepsilon/2)$ are the temperatures at the two faces of the thin layer.\n\nThe temperature drop across this layer, $\\Delta T_{\\text{layer}} = T(x_i - \\varepsilon/2) - T(x_i + \\varepsilon/2)$, can be expressed as:\n$$ \\Delta T_{\\text{layer}} = q'' \\frac{\\varepsilon}{k_{\\text{int}}} $$\nThe problem states that there is a finite temperature jump across the interface, which implies that $\\Delta T$ remains finite and non-zero as the layer thickness $\\varepsilon$ approaches zero. This is only possible if the ratio $\\varepsilon/k_{\\text{int}}$ approaches a finite, non-zero constant in the limit as $\\varepsilon \\to 0^{+}$. We define this limit as the thermal contact resistance, $R_c$:\n$$ R_c \\equiv \\lim_{\\varepsilon \\to 0, k_{\\text{int}} \\to 0} \\left( \\frac{\\varepsilon}{k_{\\text{int}}} \\right) $$\nThe units of $R_c$ are $\\mathrm{m} / (\\mathrm{W\\,m^{-1}\\,K^{-1}}) = \\mathrm{m^2\\,K\\,W^{-1}}$, which is consistent with the provided data.\n\nTaking the limit of the temperature drop expression, the temperature jump across the interface at $x_i$, denoted $\\Delta T_i$, is:\n$$ \\Delta T_i = \\lim_{\\varepsilon \\to 0} ( \\Delta T_{\\text{layer}} ) = q'' \\left( \\lim_{\\varepsilon \\to 0} \\frac{\\varepsilon}{k_{\\text{int}}} \\right) $$\nSubstituting the definition of $R_c$, we arrive at the desired expression for the temperature drop across a single interface:\n$$ \\Delta T_i = q'' R_c $$\nThis relationship arises from the energy balance at the interface, which dictates that the heat flux is continuous, even though the temperature is discontinuous. The problem states that bulk resistances are negligible, so the total temperature drop across the entire stack is the sum of the temperature drops at the interfaces.\n\n**Part 2: Calculation of Interfacial Temperature Drops**\n\nWe are given the following data:\n- Heat flux: $q'' = 1.75 \\times 10^{5}\\ \\mathrm{W\\,m^{-2}}$\n- Interfacial thermal contact resistances:\n  - $R_{c,1} = 2.50 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}$\n  - $R_{c,2} = 6.00 \\times 10^{-5}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}$\n  - $R_{c,3} = 1.20 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}$\n\nUsing the derived formula $\\Delta T_i = q'' R_{c,i}$, we calculate the temperature drop across each of the three interfaces:\n- For interface $1$:\n$$ \\Delta T_1 = (1.75 \\times 10^{5}\\ \\mathrm{W\\,m^{-2}}) \\times (2.50 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}) = 43.75\\ \\mathrm{K} $$\n- For interface $2$:\n$$ \\Delta T_2 = (1.75 \\times 10^{5}\\ \\mathrm{W\\,m^{-2}}) \\times (6.00 \\times 10^{-5}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}) = 10.5\\ \\mathrm{K} $$\n- For interface $3$:\n$$ \\Delta T_3 = (1.75 \\times 10^{5}\\ \\mathrm{W\\,m^{-2}}) \\times (1.20 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}) = 21.0\\ \\mathrm{K} $$\n\n**Part 3: Verification**\n\nThe three interfaces act as thermal resistances in series. The total equivalent thermal contact resistance, $R_{c,\\text{total}}$, is the sum of the individual resistances:\n$$ R_{c,\\text{total}} = R_{c,1} + R_{c,2} + R_{c,3} $$\n$$ R_{c,\\text{total}} = (2.50 \\times 10^{-4}) + (6.00 \\times 10^{-5}) + (1.20 \\times 10^{-4}) \\ \\mathrm{m^{2}\\,K\\,W^{-1}} $$\n$$ R_{c,\\text{total}} = (2.50 \\times 10^{-4}) + (0.600 \\times 10^{-4}) + (1.20 \\times 10^{-4}) = 4.300 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}} $$\n\nThe total interfacial temperature drop, $\\Delta T_{\\text{total}}$, can be calculated directly using this total resistance:\n$$ \\Delta T_{\\text{total}} = q'' R_{c,\\text{total}} = (1.75 \\times 10^{5}\\ \\mathrm{W\\,m^{-2}}) \\times (4.300 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K\\,W^{-1}}) = 75.25\\ \\mathrm{K} $$\n\nTo verify this result, we sum the individual temperature drops calculated in Part 2:\n$$ \\Delta T_{\\text{total}} = \\Delta T_1 + \\Delta T_2 + \\Delta T_3 = 43.75\\ \\mathrm{K} + 10.5\\ \\mathrm{K} + 21.0\\ \\mathrm{K} = 75.25\\ \\mathrm{K} $$\nThe results match perfectly, which verifies that the total temperature drop is the sum of the individual drops, consistent with the principle of series thermal resistances.\n\nThe final values, rounded to four significant figures as requested, are:\n- $\\Delta T_1 = 43.75\\ \\mathrm{K}$\n- $\\Delta T_2 = 10.50\\ \\mathrm{K}$\n- $\\Delta T_3 = 21.00\\ \\mathrm{K}$\n- $\\Delta T_{\\text{total}} = 75.25\\ \\mathrm{K}$\nThese values will be presented in a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n43.75 & 10.50 & 21.00 & 75.25\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Many high-performance composites, such as carbon-fiber-reinforced polymers, exhibit anisotropic behavior—their properties depend on direction. This exercise  moves beyond simple scalar conductivity to the more powerful tensorial representation required for such materials. You will derive the transformation rule for the thermal conductivity tensor, $\\boldsymbol{K}$, under a coordinate rotation, a fundamental skill in continuum mechanics, and then apply it to determine how the heat-flow characteristics of a composite lamina change with its orientation.",
            "id": "3960036",
            "problem": "A unidirectional fiber-reinforced lamina is modeled as an orthotropic, homogeneous layer for steady heat conduction. In the local material principal basis $\\{ \\boldsymbol{e}_{1}, \\boldsymbol{e}_{2}, \\boldsymbol{e}_{3} \\}$, where $\\boldsymbol{e}_{1}$ aligns with the fibers, $\\boldsymbol{e}_{2}$ lies in-plane transverse to the fibers, and $\\boldsymbol{e}_{3}$ is the through-thickness direction, the conductivity tensor is diagonal:\n$$\n\\boldsymbol{K}^{(m)} = \\begin{pmatrix}\nk_{1} & 0 & 0\\\\\n0 & k_{2} & 0\\\\\n0 & 0 & k_{3}\n\\end{pmatrix},\n$$\nwith $k_{1}$, $k_{2}$, and $k_{3}$ constant. The lamina is embedded in a global Cartesian basis $\\{ \\boldsymbol{e}_{x}, \\boldsymbol{e}_{y}, \\boldsymbol{e}_{z} \\}$ such that the layer normal is aligned with $\\boldsymbol{e}_{z}$, but the in-plane fiber direction is oblique: the material basis $\\{ \\boldsymbol{e}_{1}, \\boldsymbol{e}_{2} \\}$ is obtained from $\\{ \\boldsymbol{e}_{x}, \\boldsymbol{e}_{y} \\}$ by a right-handed rotation about $\\boldsymbol{e}_{z}$ by an angle $\\theta$ (counterclockwise when viewed from $+\\boldsymbol{e}_{z}$). \n\nStarting from Fourier’s law of heat conduction and the transformation properties of vectors under orthogonal changes of basis, derive the transformation law for the conductivity tensor under this in-plane rotation and obtain the global conductivity tensor $\\boldsymbol{K}^{(g)}$ in the basis $\\{ \\boldsymbol{e}_{x}, \\boldsymbol{e}_{y}, \\boldsymbol{e}_{z} \\}$ as a function of $k_{1}$, $k_{2}$, $k_{3}$, and $\\theta$. Then, evaluate its components explicitly for\n$$\nk_{1} = 23.75\\ \\mathrm{W\\,m^{-1}\\,K^{-1}},\\quad\nk_{2} = 0.57\\ \\mathrm{W\\,m^{-1}\\,K^{-1}},\\quad\nk_{3} = 0.41\\ \\mathrm{W\\,m^{-1}\\,K^{-1}},\n$$\nand an in-plane fiber orientation angle\n$$\n\\theta = 36.86989765^\\circ\\ \\text{(degrees)}.\n$$\n\nExpress each of the nine components of $\\boldsymbol{K}^{(g)}$ in $\\mathrm{W\\,m^{-1}\\,K^{-1}}$, and round your numerical results to four significant figures. Report the final answer as a single row matrix in the order\n$$\n\\big(k_{xx},\\ k_{xy},\\ k_{xz},\\ k_{yx},\\ k_{yy},\\ k_{yz},\\ k_{zx},\\ k_{zy},\\ k_{zz}\\big).\n$$",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the principles of continuum mechanics and heat transfer, is well-posed, objective, and contains sufficient information for a unique solution.\n\nThe fundamental relationship governing steady-state heat conduction is Fourier's law, which relates the heat flux vector $\\boldsymbol{q}$ to the temperature gradient vector $\\nabla T$:\n$$\n\\boldsymbol{q} = -\\boldsymbol{K} \\nabla T\n$$\nHere, $\\boldsymbol{K}$ is the second-rank thermal conductivity tensor. This law is tensorial and thus holds true independent of the coordinate system chosen.\n\nWe are given the conductivity tensor $\\boldsymbol{K}^{(m)}$ in the material principal basis $\\{\\boldsymbol{e}_1, \\boldsymbol{e}_2, \\boldsymbol{e}_3\\}$ as a diagonal matrix:\n$$\n\\boldsymbol{K}^{(m)} = \\begin{pmatrix} k_{1} & 0 & 0 \\\\ 0 & k_{2} & 0 \\\\ 0 & 0 & k_{3} \\end{pmatrix}\n$$\nWe need to find its representation, $\\boldsymbol{K}^{(g)}$, in the global Cartesian basis $\\{\\boldsymbol{e}_x, \\boldsymbol{e}_y, \\boldsymbol{e}_z\\}$.\n\nThe transformation from the global basis to the material basis is a right-handed rotation by an angle $\\theta$ about the $\\boldsymbol{e}_z$ axis. The basis vectors are related as:\n$$\n\\boldsymbol{e}_1 = \\cos\\theta \\, \\boldsymbol{e}_x + \\sin\\theta \\, \\boldsymbol{e}_y \\\\\n\\boldsymbol{e}_2 = -\\sin\\theta \\, \\boldsymbol{e}_x + \\cos\\theta \\, \\boldsymbol{e}_y \\\\\n\\boldsymbol{e}_3 = \\boldsymbol{e}_z\n$$\nLet $\\boldsymbol{v}^{(g)}$ be the column vector of components of a vector $\\boldsymbol{v}$ in the global basis, and $\\boldsymbol{v}^{(m)}$ be its components in the material basis. The components transform according to $\\boldsymbol{v}^{(m)} = \\boldsymbol{R} \\boldsymbol{v}^{(g)}$, where $\\boldsymbol{R}$ is the rotation matrix. The elements of $\\boldsymbol{R}$ are given by $R_{ij} = \\boldsymbol{e}_i \\cdot \\boldsymbol{e}_j^{(g)}$, where $\\{\\boldsymbol{e}_i\\}$ is the material basis and $\\{\\boldsymbol{e}_j^{(g)}\\}$ is the global basis. This yields:\n$$\n\\boldsymbol{R} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta & 0 \\\\ -\\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nTo derive the transformation law for the tensor $\\boldsymbol{K}$, we write Fourier's law in both bases.\nIn the material basis: $\\boldsymbol{q}^{(m)} = -\\boldsymbol{K}^{(m)} (\\nabla T)^{(m)}$.\nIn the global basis: $\\boldsymbol{q}^{(g)} = -\\boldsymbol{K}^{(g)} (\\nabla T)^{(g)}$.\n\nUsing the vector transformation rule for the heat flux and the temperature gradient:\n$$\n\\boldsymbol{q}^{(m)} = \\boldsymbol{R} \\boldsymbol{q}^{(g)} \\quad \\text{and} \\quad (\\nabla T)^{(m)} = \\boldsymbol{R} (\\nabla T)^{(g)}\n$$\nSubstituting these into the material-basis Fourier's law:\n$$\n\\boldsymbol{R} \\boldsymbol{q}^{(g)} = -\\boldsymbol{K}^{(m)} \\boldsymbol{R} (\\nabla T)^{(g)}\n$$\nTo isolate $\\boldsymbol{q}^{(g)}$, we multiply from the left by the inverse of $\\boldsymbol{R}$. Since $\\boldsymbol{R}$ is an orthogonal matrix, its inverse is its transpose, $\\boldsymbol{R}^{-1} = \\boldsymbol{R}^T$.\n$$\n\\boldsymbol{R}^T \\boldsymbol{R} \\boldsymbol{q}^{(g)} = -\\boldsymbol{R}^T \\boldsymbol{K}^{(m)} \\boldsymbol{R} (\\nabla T)^{(g)}\n$$\nSince $\\boldsymbol{R}^T \\boldsymbol{R} = \\boldsymbol{I}$ (the identity matrix), we have:\n$$\n\\boldsymbol{q}^{(g)} = -(\\boldsymbol{R}^T \\boldsymbol{K}^{(m)} \\boldsymbol{R}) (\\nabla T)^{(g)}\n$$\nBy comparing this with $\\boldsymbol{q}^{(g)} = -\\boldsymbol{K}^{(g)} (\\nabla T)^{(g)}$, we obtain the transformation law for the second-rank conductivity tensor:\n$$\n\\boldsymbol{K}^{(g)} = \\boldsymbol{R}^T \\boldsymbol{K}^{(m)} \\boldsymbol{R}\n$$\nWe now perform the matrix multiplication. Let $c = \\cos\\theta$ and $s = \\sin\\theta$.\n$$\n\\boldsymbol{R}^T = \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{K}^{(g)} = \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} k_{1} & 0 & 0 \\\\ 0 & k_{2} & 0 \\\\ 0 & 0 & k_{3} \\end{pmatrix} \\begin{pmatrix} c & s & 0 \\\\ -s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{K}^{(g)} = \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} k_1 c & k_1 s & 0 \\\\ -k_2 s & k_2 c & 0 \\\\ 0 & 0 & k_3 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{K}^{(g)} = \\begin{pmatrix}\nc(k_1 c) - s(-k_2 s) & c(k_1 s) - s(k_2 c) & 0 \\\\\ns(k_1 c) + c(-k_2 s) & s(k_1 s) + c(k_2 c) & 0 \\\\\n0 & 0 & k_3\n\\end{pmatrix}\n$$\nSimplifying the components:\n$k_{xx} = k_1 c^2 + k_2 s^2 = k_1 \\cos^2\\theta + k_2 \\sin^2\\theta$\n$k_{xy} = k_1 cs - k_2 sc = (k_1 - k_2) \\sin\\theta \\cos\\theta$\n$k_{yx} = k_1 sc - k_2 cs = (k_1 - k_2) \\sin\\theta \\cos\\theta$\n$k_{yy} = k_1 s^2 + k_2 c^2 = k_1 \\sin^2\\theta + k_2 \\cos^2\\theta$\n$k_{zz} = k_3$\nAll other components ($k_{xz}, k_{zx}, k_{yz}, k_{zy}$) are zero.\n\nThe symbolic form of the global conductivity tensor is:\n$$\n\\boldsymbol{K}^{(g)} = \\begin{pmatrix}\nk_1 \\cos^2\\theta + k_2 \\sin^2\\theta & (k_1 - k_2) \\sin\\theta \\cos\\theta & 0 \\\\\n(k_1 - k_2) \\sin\\theta \\cos\\theta & k_1 \\sin^2\\theta + k_2 \\cos^2\\theta & 0 \\\\\n0 & 0 & k_3\n\\end{pmatrix}\n$$\nNext, we evaluate the components for the given numerical values:\n$k_1 = 23.75\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$k_2 = 0.57\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$k_3 = 0.41\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$\\theta = 36.86989765^\\circ$\n\nThe angle $\\theta$ is such that $\\tan\\theta = 0.75 = 3/4$. This corresponds to a right triangle with sides $3$, $4$, and $5$. Therefore, the trigonometric functions have exact rational values:\n$\\sin\\theta = 3/5 = 0.6$\n$\\cos\\theta = 4/5 = 0.8$\n\nNow, we substitute these values into the expressions for the components of $\\boldsymbol{K}^{(g)}$:\n$k_{xx} = (23.75)(0.8)^2 + (0.57)(0.6)^2 = (23.75)(0.64) + (0.57)(0.36) = 15.2 + 0.2052 = 15.4052$\n$k_{yy} = (23.75)(0.6)^2 + (0.57)(0.8)^2 = (23.75)(0.36) + (0.57)(0.64) = 8.55 + 0.3648 = 8.9148$\n$k_{xy} = k_{yx} = (23.75 - 0.57)(0.6)(0.8) = (23.18)(0.48) = 11.1264$\n$k_{zz} = k_3 = 0.41$\n$k_{xz} = k_{zx} = 0$\n$k_{yz} = k_{zy} = 0$\n\nRounding these numerical results to four significant figures:\n$k_{xx} = 15.41$\n$k_{yy} = 8.915$\n$k_{xy} = k_{yx} = 11.13$\n$k_{zz} = 0.4100$\n$k_{xz} = k_{zx} = 0$\n$k_{yz} = k_{zy} = 0$\n\nWe report the nine components in the specified order $(k_{xx}, k_{xy}, k_{xz}, k_{yx}, k_{yy}, k_{yz}, k_{zx}, k_{zy}, k_{zz})$.\nThe final answer is composed of the following values:\n$k_{xx} = 15.41$, $k_{xy} = 11.13$, $k_{xz} = 0$, $k_{yx} = 11.13$, $k_{yy} = 8.915$, $k_{yz} = 0$, $k_{zx} = 0$, $k_{zy} = 0$, $k_{zz} = 0.4100$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 15.41 & 11.13 & 0 & 11.13 & 8.915 & 0 & 0 & 0 & 0.4100 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While analytical solutions are invaluable for understanding fundamental principles, most real-world engineering problems require numerical methods. This practice  guides you through the process of building and validating a one-dimensional Finite Volume Method (FVM) solver for heat conduction in a multi-layered composite wall. Critically, it challenges you to compare a physically robust method for handling interface conductivities (the harmonic mean) against a naive, but common, alternative (the arithmetic mean). This exercise not only builds your coding and numerical analysis skills but also provides a crucial lesson in the importance of selecting appropriate numerical schemes to ensure the physical accuracy of a simulation.",
            "id": "3960075",
            "problem": "Consider one-dimensional steady heat conduction through a planar composite wall consisting of multiple layers stacked in series along the spatial coordinate $x$, with the left boundary at $x=0$ and the right boundary at $x=L_{\\text{tot}}$. Each layer $i$ has thickness $L_i$ and constant thermal conductivity $k_i$, and there may exist thermal contact resistances $R_{c,i}$ located at the zero-thickness interfaces between adjacent layers. Assume no internal heat generation and no lateral heat flow. The left boundary temperature is prescribed as $T(0)=T_{\\mathrm{L}}$ and the right boundary temperature is prescribed as $T(L_{\\text{tot}})=T_{\\mathrm{R}}$. All temperatures must be expressed in Kelvin (K), all lengths in meters (m), and all thermal conductivities in watts per meter-kelvin ($\\mathrm{W\\,m^{-1}\\,K^{-1}}$); thermal contact resistances are in square-meter kelvin per watt ($\\mathrm{m^2\\,K\\,W^{-1}}$). Angles are not involved in this problem.\n\nStarting from the following foundational principles:\n- Fourier’s law of heat conduction: the local heat flux satisfies $q(x)=-k(x)\\,\\dfrac{dT}{dx}$ in one dimension,\n- Steady-state energy conservation in one dimension with no heat sources: the heat flux $q(x)$ is spatially constant,\n- Interface conditions: at perfect interfaces, the heat flux is continuous; at a contact resistance $R_c$ located at an interface, the temperature exhibits a jump $\\Delta T=q\\,R_c$ across the interface while the heat flux remains continuous,\n\nderive the analytical piecewise temperature field for a multilayer wall with the above properties, expressed at arbitrary positions $x$. Then, construct a one-dimensional finite volume discretization (define control volumes with cell centers and planar faces) and assemble the resulting linear algebraic system for the nodal temperatures. Implement and compare two distinct numerical interface treatments:\n\n- Model $\\mathrm{H}$ (physically consistent face-resistance treatment): treat each interior face as a series combination of half-cell conduction resistances, namely use the harmonic-resistance sum $R_{f}=\\dfrac{\\Delta x_{\\mathrm{W}}}{2\\,k_{\\mathrm{W}}}+\\dfrac{\\Delta x_{\\mathrm{E}}}{2\\,k_{\\mathrm{E}}}$, and add any thermal contact resistance present at that interface $R_{c}$ so that the total face resistance is $R_{f}+R_{c}$. The resulting face conductance is $G_f=\\dfrac{1}{R_f+R_c}$, and the discrete flux between adjacent cell centers is $q_{f}=-G_f\\,(T_{\\mathrm{E}}-T_{\\mathrm{W}})$. For boundary faces, use half-cell resistances to impose the Dirichlet boundary temperatures via source terms.\n\n- Model $\\mathrm{A}$ (naïve arithmetic-mean treatment): approximate each interior face with a single conductivity $k_{f}=\\dfrac{k_{\\mathrm{W}}+k_{\\mathrm{E}}}{2}$ and a face thickness equal to the distance between adjacent cell centers $\\Delta x_{f}=\\dfrac{\\Delta x_{\\mathrm{W}}}{2}+\\dfrac{\\Delta x_{\\mathrm{E}}}{2}$, giving a face resistance $R_{f}=\\dfrac{\\Delta x_{f}}{k_{f}}$ without adding any contact resistance, even if present physically. Boundary faces are treated via half-cell Dirichlet imposition as in Model $\\mathrm{H}$.\n\nUsing the analytical solution obtained from first principles and both numerical models, compute, for each test case listed below, the root-mean-square (RMS) difference between the numerical temperature field evaluated at cell centers and the analytical temperature field evaluated at the same cell centers. Report the RMS differences for both Model $\\mathrm{H}$ and Model $\\mathrm{A}$ for each test case. All RMS differences must be expressed in Kelvin (K) as real-valued floats.\n\nDiscretization specification for the numerical models:\n- For each layer $i$, divide the thickness $L_i$ into $N_i$ uniform control volumes of width $\\Delta x_i=L_i/N_i$; assemble these consecutively to form the global grid. The cell centers lie midway within each control volume.\n- Use the finite volume method (FVM) to assemble a tridiagonal linear system based on face conductances between adjacent cell centers. For left and right boundaries, use half-cell resistances to connect the boundary to the adjacent cell center, imposing the Dirichlet temperatures via source terms.\n\nAnalytical evaluation at cell centers:\n- Compute the constant heat flux $q$ and the cumulative thermal resistance from the left boundary to an arbitrary position $x$ by summing all layer conduction resistances encountered up to $x$ plus any contact resistances at interfaces already crossed. The temperature at position $x$ is $T(x)=T_{\\mathrm{L}}-q\\,R_{\\mathrm{left}}(x)$, where $R_{\\mathrm{left}}(x)$ is the cumulative resistance from the left boundary to $x$. Apply the temperature jump $\\Delta T=q\\,R_c$ at each contact resistance interface when crossing it.\n\nTest suite:\n- Case $\\mathrm{A}$ (two layers, strong conductivity contrast, no contact resistance): \n  - Layer $1$: $L_1=0.04\\,\\mathrm{m}$, $k_1=10\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $N_1=20$.\n  - Layer $2$: $L_2=0.06\\,\\mathrm{m}$, $k_2=1\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $N_2=30$.\n  - Boundary temperatures: $T_{\\mathrm{L}}=400\\,\\mathrm{K}$, $T_{\\mathrm{R}}=300\\,\\mathrm{K}$.\n  - Contact resistances: none, so the list of $R_c$ values is empty.\n- Case $\\mathrm{B}$ (three layers, ultrathin highly conductive middle layer, no contact resistance):\n  - Layer $1$: $L_1=0.03\\,\\mathrm{m}$, $k_1=0.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $N_1=15$.\n  - Layer $2$: $L_2=0.002\\,\\mathrm{m}$, $k_2=400\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $N_2=2$.\n  - Layer $3$: $L_3=0.03\\,\\mathrm{m}$, $k_3=0.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $N_3=15$.\n  - Boundary temperatures: $T_{\\mathrm{L}}=350\\,\\mathrm{K}$, $T_{\\mathrm{R}}=300\\,\\mathrm{K}$.\n  - Contact resistances: none, so the list of $R_c$ values is empty.\n- Case $\\mathrm{C}$ (two layers, equal conductivity, nonzero contact resistance at the interface):\n  - Layer $1$: $L_1=0.05\\,\\mathrm{m}$, $k_1=15\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $N_1=25$.\n  - Layer $2$: $L_2=0.05\\,\\mathrm{m}$, $k_2=15\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $N_2=25$.\n  - Boundary temperatures: $T_{\\mathrm{L}}=350\\,\\mathrm{K}$, $T_{\\mathrm{R}}=330\\,\\mathrm{K}$.\n  - Contact resistances: a single interface resistance $R_{c,1}=2\\times 10^{-4}\\,\\mathrm{m^2\\,K\\,W^{-1}}$.\n\nOutput specification:\n- For each case, compute two RMS differences in Kelvin: one for Model $\\mathrm{H}$ and one for Model $\\mathrm{A}$.\n- Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, ordered as $[\\text{Case A Model H},\\text{Case A Model A},\\text{Case B Model H},\\text{Case B Model A},\\text{Case C Model H},\\text{Case C Model A}]$.",
            "solution": "The user-provided problem is assessed as valid. It is scientifically grounded in the principles of steady-state heat conduction, is well-posed with sufficient data and clear boundary conditions for a unique solution, and is formulated objectively using precise technical language. The problem is a standard exercise in computational heat transfer, comparing a physically consistent numerical scheme (Model H) with a common but less accurate one (Model A) against an exact analytical solution.\n\n### 1. Analytical Solution\nThe problem describes one-dimensional, steady-state heat conduction through a composite plane wall with no internal heat generation. The governing equation is derived from Fourier's Law and energy conservation.\n\n**Principles:**\n1.  **Fourier's Law:** The heat flux $q$ (in $\\mathrm{W/m^2}$) is proportional to the negative temperature gradient: $q = -k \\frac{dT}{dx}$, where $k$ is the thermal conductivity.\n2.  **Energy Conservation:** For steady-state 1D conduction with no generation, $\\frac{d}{dx}(q) = 0$, which implies that the heat flux $q$ is constant throughout the wall.\n\n**Derivation:**\nIntegrating Fourier's law across a single homogeneous layer $i$ of thickness $L_i$ and conductivity $k_i$ gives a temperature drop $\\Delta T_i$:\n$$ q = -k_i \\frac{\\Delta T_i}{-L_i} \\implies \\Delta T_i = q \\frac{L_i}{k_i} $$\nThe term $R_i = L_i / k_i$ is the thermal resistance of layer $i$ (in $\\mathrm{m^2\\,K\\,W^{-1}}$).\n\nAt an interface between two layers, a thermal contact resistance $R_c$ can cause an abrupt temperature drop $\\Delta T_c = q R_c$, while the heat flux $q$ remains continuous.\n\nFor a composite wall of $M$ layers with boundary temperatures $T(0) = T_{\\mathrm{L}}$ and $T(L_{\\text{tot}}) = T_{\\mathrm{R}}$, the total temperature drop is the sum of the drops across all layers and all interfaces:\n$$ T_{\\mathrm{L}} - T_{\\mathrm{R}} = \\sum_{i=1}^{M} \\Delta T_i + \\sum_{j=1}^{M-1} \\Delta T_{c,j} = q \\left( \\sum_{i=1}^{M} \\frac{L_i}{k_i} + \\sum_{j=1}^{M-1} R_{c,j} \\right) $$\nThe total thermal resistance is $R_{\\text{tot}} = \\sum R_i + \\sum R_{c,j}$. The constant heat flux is therefore:\n$$ q = \\frac{T_{\\mathrm{L}} - T_{\\mathrm{R}}}{R_{\\text{tot}}} $$\n\nThe temperature $T(x)$ at an arbitrary position $x$ is found by integrating from the left boundary:\n$$ T(x) = T_{\\mathrm{L}} - \\int_0^x \\frac{q}{k(\\xi)} d\\xi + \\sum_{x_j < x} (-q R_{c,j}) $$\nwhere the summation accounts for temperature drops at interfaces located at positions $x_j$ that have been crossed. This is more conveniently written as $T(x) = T_{\\mathrm{L}} - q \\cdot R_{\\text{left}}(x)$, where $R_{\\text{left}}(x)$ is the cumulative thermal resistance from the left boundary to position $x$.\n\nIf position $x$ is within layer $j$ (which starts at position $x_{j-1}^{\\text{end}}$), the resistance is:\n$$ R_{\\text{left}}(x) = \\left( \\sum_{i=1}^{j-1} \\frac{L_i}{k_i} \\right) + \\left( \\sum_{i=1}^{j-1} R_{c,i} \\right) + \\frac{x - x_{j-1}^{\\text{end}}}{k_j} $$\nwhere $x_{j-1}^{\\text{end}} = \\sum_{i=1}^{j-1} L_i$. This provides the piecewise analytical temperature profile.\n\n### 2. Finite Volume Method (FVM) Discretization\nWe discretize the domain into a series of non-overlapping control volumes (CVs), with a node (cell center) $P_i$ at the center of each CV $i$. Applying energy conservation to CV $i$ yields:\n$$ (q_f A)_{\\text{east}} - (q_f A)_{\\text{west}} = 0 $$\nwhere $A$ is the cross-sectional area (which is constant and cancels out) and $q_f$ is the heat flux at the CV faces. The flux between two adjacent nodes $P_i$ and $P_{i+1}$ is approximated as:\n$$ q_{f, i+1/2} = G_{f, i+1/2} (T_i - T_{i+1}) $$\nwhere $G_{f, i+1/2}$ is the thermal conductance between the nodes. The energy balance for an interior node $i$ becomes:\n$$ G_{f, i+1/2}(T_i - T_{i+1}) + G_{f, i-1/2}(T_i - T_{i-1}) = 0 $$\nThis is rearranged into a linear algebraic equation:\n$$ (G_{f, i-1/2} + G_{f, i+1/2}) T_i - G_{f, i-1/2} T_{i-1} - G_{f, i+1/2} T_{i+1} = 0 $$\nFor boundary nodes, the prescribed temperatures are incorporated via source terms. For the first node ($i=0$), the left boundary flux is modeled as $q_{\\mathrm{L}} = G_{\\mathrm{L}} (T_{\\mathrm{L}} - T_0)$. The energy balance is:\n$$ G_{f, 1/2}(T_1 - T_0) - G_{\\mathrm{L}}(T_0 - T_{\\mathrm{L}}) = 0 \\implies (G_{\\mathrm{L}} + G_{f, 1/2})T_0 - G_{f, 1/2}T_1 = G_{\\mathrm{L}}T_{\\mathrm{L}} $$\nA similar equation is derived for the last node. This set of equations forms a tridiagonal linear system $\\mathbf{A}\\mathbf{T} = \\mathbf{b}$, which can be solved for the nodal temperatures $\\mathbf{T}$.\n\n### 3. Numerical Interface Models\n\n#### Model H: Physically Consistent (Harmonic) Treatment\nThis model correctly represents thermal resistances in series. The conductance $G_f$ at a face between cell $W$ (west) and cell $E$ (east) is the inverse of the total face resistance $R_{f, \\text{tot}}$.\n- The total resistance is the sum of the half-cell conduction resistances and any contact resistance $R_c$ at that face:\n$$ R_{f, \\text{tot}} = R_{\\text{cond},W} + R_{\\text{cond},E} + R_c = \\frac{\\Delta x_W/2}{k_W} + \\frac{\\Delta x_E/2}{k_E} + R_c $$\n- The face conductance is $G_f = 1 / R_{f, \\text{tot}}$.\n- For a boundary face, the resistance is a single half-cell resistance, e.g., $R_{\\mathrm{L}} = (\\Delta x_0/2)/k_0$, so the boundary conductance is $G_{\\mathrm{L}} = k_0 / (\\Delta x_0/2)$.\n\nThis approach correctly reduces to the harmonic mean of conductivities for uniform grids and is physically accurate for composite media.\n\n#### Model A: Naïve Arithmetic-Mean Treatment\nThis model incorrectly averages conductivities at interfaces.\n- The face conductivity is the arithmetic mean: $k_f = (k_W + k_E)/2$.\n- This effective conductivity is assumed to act over the distance between cell centers, $\\Delta x_f = \\Delta x_W/2 + \\Delta x_E/2$.\n- The face resistance is $R_f = \\Delta x_f / k_f = (\\Delta x_W + \\Delta x_E) / (k_W + k_E)$.\n- The face conductance is $G_f = 1 / R_f$.\n- **Crucially, this model completely ignores any physical contact resistance $R_c$.**\n- Boundary conductances are handled the same as in Model H, as specified.\n\nThis model is known to be inaccurate, especially for large conductivity contrasts, as it violates the series resistance analogy.\n\n### 4. Evaluation\nFor each test case, we will:\n1.  Generate the grid (cell center locations, cell widths, and material properties per cell).\n2.  Compute the analytical temperature at each cell center using the derived formula for $T(x)$.\n3.  For each model (H and A), assemble and solve the FVM tridiagonal system to find the numerical temperatures at cell centers.\n4.  Calculate the Root-Mean-Square (RMS) difference between the numerical and analytical temperature fields:\n    $$ \\text{RMSD} = \\sqrt{\\frac{1}{N_{\\text{tot}}} \\sum_{i=0}^{N_{\\text{tot}}-1} (T_{\\text{num},i} - T_{\\text{ana},i})^2} $$\nThe implementation will follow these steps to produce the required six RMSD values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main driver function to solve the heat conduction problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"layers\": [ (0.04, 10.0, 20), (0.06, 1.0, 30) ],\n            \"boundary_temps\": (400.0, 300.0),\n            \"contact_res\": []\n        },\n        {\n            \"name\": \"Case B\",\n            \"layers\": [ (0.03, 0.5, 15), (0.002, 400.0, 2), (0.03, 0.5, 15) ],\n            \"boundary_temps\": (350.0, 300.0),\n            \"contact_res\": []\n        },\n        {\n            \"name\": \"Case C\",\n            \"layers\": [ (0.05, 15.0, 25), (0.05, 15.0, 25) ],\n            \"boundary_temps\": (350.0, 330.0),\n            \"contact_res\": [2.0e-4]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        rms_h, rms_a = run_case(case)\n        all_results.extend([rms_h, rms_a])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\ndef run_case(case_data):\n    \"\"\"\n    Runs a single test case: generates grid, solves analytically and numerically,\n    and computes RMS differences.\n    \"\"\"\n    layers, (T_L, T_R), Rcs = case_data[\"layers\"], case_data[\"boundary_temps\"], case_data[\"contact_res\"]\n    \n    # 1. Generate grid and properties\n    grid_props = generate_grid(layers, Rcs)\n    \n    # 2. Get analytical solution at cell centers\n    T_analytical = solve_analytical(grid_props, T_L, T_R, layers, Rcs)\n    \n    # 3. Get numerical solutions for Model H and Model A\n    T_model_H = solve_fvm(grid_props, T_L, T_R, 'H')\n    T_model_A = solve_fvm(grid_props, T_L, T_R, 'A')\n    \n    # 4. Calculate RMS differences\n    rms_h = np.sqrt(np.mean((T_model_H - T_analytical)**2))\n    rms_a = np.sqrt(np.mean((T_model_A - T_analytical)**2))\n    \n    return rms_h, rms_a\n\ndef generate_grid(layers, Rcs):\n    \"\"\"\n    Generates grid properties: cell centers, widths, conductivities, and interface data.\n    \"\"\"\n    N_total = sum(layer[2] for layer in layers)\n    \n    x_centers = np.zeros(N_total)\n    dx_vals = np.zeros(N_total)\n    k_vals = np.zeros(N_total)\n    \n    interface_indices = set()\n    rc_map = {}\n    \n    current_pos = 0.0\n    cell_idx = 0\n    for i, (L, k, N) in enumerate(layers):\n        dx = L / N\n        for _ in range(N):\n            dx_vals[cell_idx] = dx\n            k_vals[cell_idx] = k\n            x_centers[cell_idx] = current_pos + dx / 2.0\n            current_pos += dx\n            cell_idx += 1\n        \n        if i < len(layers) - 1:\n            interface_idx = cell_idx - 1\n            interface_indices.add(interface_idx)\n            if i < len(Rcs):\n                rc_map[interface_idx] = Rcs[i]\n\n    return {\n        \"N_total\": N_total,\n        \"x_centers\": x_centers,\n        \"dx_vals\": dx_vals,\n        \"k_vals\": k_vals,\n        \"interface_indices\": interface_indices,\n        \"rc_map\": rc_map\n    }\n\ndef solve_analytical(grid_props, T_L, T_R, layers, Rcs):\n    \"\"\"\n    Calculates the exact analytical temperature at the specified cell centers.\n    \"\"\"\n    # Calculate total resistance and heat flux\n    R_cond_total = sum(L / k for L, k, N in layers)\n    R_contact_total = sum(Rcs)\n    R_total = R_cond_total + R_contact_total\n    \n    # Avoid division by zero if T_L == T_R (isothermal case)\n    if R_total > 0:\n        q = (T_L - T_R) / R_total\n    else:\n        q = 0.0\n\n    # Pre-calculate layer start positions and cumulative resistances\n    layer_start_x = [0.0]\n    layer_start_R = [0.0]\n    cumulative_L = 0.0\n    cumulative_R = 0.0\n    for i, (L, k, N) in enumerate(layers):\n        cumulative_L += L\n        cumulative_R += L / k\n        if i < len(Rcs):\n            cumulative_R += Rcs[i]\n        if i < len(layers) - 1:\n            layer_start_x.append(cumulative_L)\n            layer_start_R.append(cumulative_R)\n\n    # Calculate temperature at each cell center\n    x_coords = grid_props['x_centers']\n    T_ana = np.zeros_like(x_coords)\n    \n    for i, x in enumerate(x_coords):\n        # Find which layer the coordinate x is in\n        layer_idx = np.searchsorted(layer_start_x, x, side='right') - 1\n        \n        # Resistance up to the start of the current layer\n        R_upto_layer_start = layer_start_R[layer_idx]\n        \n        # Position relative to the start of the current layer\n        x_in_layer = x - layer_start_x[layer_idx]\n        \n        # Resistance within the current layer up to position x\n        R_in_layer = x_in_layer / layers[layer_idx][1]\n        \n        R_at_x = R_upto_layer_start + R_in_layer\n        \n        T_ana[i] = T_L - q * R_at_x\n\n    return T_ana\n\ndef solve_fvm(grid_props, T_L, T_R, model):\n    \"\"\"\n    Assembles and solves the FVM linear system for a given model ('H' or 'A').\n    \"\"\"\n    N_total = grid_props['N_total']\n    dx_vals = grid_props['dx_vals']\n    k_vals = grid_props['k_vals']\n    interface_indices = grid_props['interface_indices']\n    rc_map = grid_props['rc_map']\n\n    A_main = np.zeros(N_total)\n    A_upper = np.zeros(N_total)\n    A_lower = np.zeros(N_total)\n    b = np.zeros(N_total)\n    \n    # Loop over interior faces\n    for i in range(N_total - 1):\n        k_W, k_E = k_vals[i], k_vals[i+1]\n        dx_W, dx_E = dx_vals[i], dx_vals[i+1]\n\n        if model == 'H':\n            R_f = (dx_W / 2.0) / k_W + (dx_E / 2.0) / k_E\n            if i in interface_indices:\n                R_f += rc_map.get(i, 0.0)\n            G_f = 1.0 / R_f\n        elif model == 'A':\n            # Contact resistance is ignored in Model A\n            k_f = (k_W + k_E) / 2.0\n            dx_f = (dx_W + dx_E) / 2.0\n            G_f = k_f / dx_f if dx_f > 0 else 0\n        else:\n            raise ValueError(\"Invalid model type specified.\")\n\n        A_main[i] += G_f\n        A_main[i+1] += G_f\n        A_upper[i] = -G_f\n        A_lower[i] = -G_f\n\n    # Left boundary condition\n    G_L = k_vals[0] / (dx_vals[0] / 2.0)\n    A_main[0] += G_L\n    b[0] += G_L * T_L\n\n    # Right boundary condition\n    G_R = k_vals[N_total-1] / (dx_vals[N_total-1] / 2.0)\n    A_main[N_total-1] += G_R\n    b[N_total-1] += G_R * T_R\n    \n    # Assemble banded matrix for SciPy solver\n    # The format is (lu+ld+1, M) with lu=1, ld=1\n    # Row 0: upper diagonal (shifted)\n    # Row 1: main diagonal\n    # Row 2: lower diagonal\n    A_banded = np.zeros((3, N_total))\n    A_banded[0, 1:] = A_upper[:-1]\n    A_banded[1, :] = A_main\n    A_banded[2, :-1] = A_lower[:-1]\n\n    # Solve the system\n    T_num = solve_banded((1, 1), A_banded, b)\n    \n    return T_num\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}