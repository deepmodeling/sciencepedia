{
    "hands_on_practices": [
        {
            "introduction": "任何一个稳健的数值方案都必须能够精确地维持一个恒定的物理场，这被称为“零检验”（zero test），是验证代码时至关重要的一步。本练习为以单元为中心和以顶点为中心的有限体积法提供了一个基础的“健全性检查”。我们将通过一个思想实验验证，对于一个恒定的温度场 $T = C$，两种方案计算出的穿过控制体边界的离散净通量都精确为零，这证实了它们满足守恒律和一致性，是任何有效离散化方案的基本要求。",
            "id": "3939387",
            "problem": "考虑一个边长为 $L$ 的方形区域上，一个关于被动标量温度 $T$ 的二维、稳态、无源平流-扩散问题，所有边界均为周期性边界。热导率 $k$、质量密度 $\\rho$ 和定压比热 $c_{p}$ 均为正常数。速度场是无散的常数场 $\\boldsymbol{u}=(u_{0},v_{0})$，其中 $u_0$ 和 $v_0$ 在空间和时间上均为常数。其控制物理原理是任意控制体上的积分形式能量守恒：在稳态且无源项的情况下，穿过其边界的净外向扩散热通量与平流热通量之和必须为零。你将研究两种离散化方法：单元中心格式和节点中心格式，两者均在有限体积法 (FVM) 框架下构建。\n\n将该区域均匀地进行笛卡尔划分为 $N_{x}\\times N_{y}$ 个矩形主网格单元，尺寸为 $\\Delta x=L/N_{x}$ 和 $\\Delta y=L/N_{y}$。在单元中心格式中，控制体是主网格单元，未知量 $T_{i,j}$ 位于单元中心。在节点中心格式中，控制体是围绕网格节点构建的中分对偶矩形，未知量 $T_{i,j}$ 位于节点上。\n\n从稳态、无源的平流-扩散问题的积分守恒形式出发，扩散项仅使用最基本的两点面法向梯度近似，平流项使用在均匀场上有界且相容的面值插值，计算穿过以下控制体边界的离散净外向通量：\n- 对于单元中心格式，一个任意的内部主网格单元，以及\n- 对于节点中心格式，围绕一个节点的相应内部对偶控制体。\n\n假设垂直面的面积为 $\\Delta y$，水平面的面积为 $\\Delta x$，且每个面上的单位外法线从控制体内部指向外部。设测试场为常数 $T\\equiv C$，其中 $C$ 是一个有限实常数。在此测试下，以闭合形式计算两种格式的离散净通量和，并以有序对 $\\left(R_{\\mathrm{CC}},R_{\\mathrm{VC}}\\right)$ 的形式返回你的答案，其中 $R_{\\mathrm{CC}}$ 是单元中心控制体的离散残差（净外向通量），而 $R_{\\mathrm{VC}}$ 是节点中心控制体的离散残差。将最终答案表示为无量纲量。结果是精确的，无需四舍五入。最终答案必须是包含这两个值的单行矩阵。",
            "solution": "问题要求计算当温度场为常数 $T \\equiv C$ 时，单元中心 (CC) 和节点中心 (VC) 有限体积格式的离散净外向通量（残差）。\n\n对于一个稳态、无源的系统，其控制物理原理是能量的积分守恒。对于任意控制体 $\\Omega_{\\text{CV}}$，这可以表示为：\n$$\n\\oint_{\\partial\\Omega_{\\text{CV}}} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, dA = 0\n$$\n其中 $\\boldsymbol{n}$ 是边界 $\\partial\\Omega_{\\text{CV}}$ 上的单位外法向量，$\\boldsymbol{F}$ 是总热通量向量。总热通量是扩散通量 (Fourier's law) 和平流通量之和：\n$$\n\\boldsymbol{F} = -k \\nabla T + \\rho c_p \\boldsymbol{u} T\n$$\n在此，热导率 $k$、质量密度 $\\rho$、比热 $c_p$ 以及速度场 $\\boldsymbol{u}=(u_0, v_0)$ 均为常数。\n\n在有限体积法 (FVM) 中，该积分被近似为对构成控制体边界的离散面 $f$ 的求和：\n$$\nR \\equiv \\sum_{f \\in \\partial\\Omega_{\\text{CV}}} (\\boldsymbol{F}_f \\cdot \\boldsymbol{n}_f) A_f\n$$\n其中 $R$ 是离散残差，或称净外向通量。$\\boldsymbol{F}_f$ 是面 $f$ 中心的通量向量的近似值，$\\boldsymbol{n}_f$ 是面 $f$ 的单位外法线，$A_f$ 是面 $f$ 的面积。\n\n通过一个面 $f$ 的总通量可以分解为其扩散分量和平流分量：\n$$\nF_f = (\\boldsymbol{F}_f \\cdot \\boldsymbol{n}_f) A_f = \\underbrace{\\left(-k (\\nabla T)_f \\cdot \\boldsymbol{n}_f\\right) A_f}_{F_{\\text{diff},f}} + \\underbrace{\\left((\\rho c_p \\boldsymbol{u} T)_f \\cdot \\boldsymbol{n}_f\\right) A_f}_{F_{\\text{adv},f}}\n$$\n我们需要针对温度场为常数 $T(x,y) = C$ 的特定测试用例，计算总残差 $R = \\sum_f (F_{\\text{diff},f} + F_{\\text{adv},f})$。\n\n让我们分析每种通量类型的贡献。\n\n1.  **扩散通量的贡献：**\n问题指定使用“最基本的两点面法向梯度近似”。对于分隔两个节点（单元中心或顶点）的任意面 $f$，记为 $P$ 和 $N$（代表“主”和“邻”），其法向梯度分量近似为：\n$$\n(\\nabla T)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{T_N - T_P}{d_{PN}}\n$$\n其中 $T_P$ 和 $T_N$ 是节点上的温度值，$d_{PN}$ 是它们之间的垂直距离。\n在测试用例中，温度场是常数 $T \\equiv C$。这意味着网格中每个节点的温度都是 $C$。因此，对于任意面，$T_N = C$ 且 $T_P = C$。\n法向梯度近似变为：\n$$\n(\\nabla T)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{C-C}{d_{PN}} = 0\n$$\n因此，通过任意面的扩散通量为零：\n$$\nF_{\\text{diff},f} = -k \\left( (\\nabla T)_f \\cdot \\boldsymbol{n}_f \\right) A_f = -k(0)A_f = 0\n$$\n这对任何控制体的每个面都成立，无论格式是单元中心还是节点中心。因此，控制体所有面上的扩散通量之和为零：\n$$\nR_{\\text{diff}} = \\sum_f F_{\\text{diff},f} = 0\n$$\n\n2.  **平流通量的贡献：**\n通过一个面 $f$ 的平流通量由 $F_{\\text{adv},f} = ((\\rho c_p \\boldsymbol{u} T)_f \\cdot \\boldsymbol{n}_f) A_f$ 给出。材料属性 $\\rho, c_p$ 和速度 $\\boldsymbol{u}$ 是常数。项 $T_f$ 是插值到面中心的温度。\n问题陈述面值插值格式“在均匀场上是相容的”。常数场 $T(x,y)=C$ 是一个均匀场。相容性意味着插值必须精确地恢复该常数值。因此，对于任意面 $f$，插值温度为 $T_f = C$。\n\n当 $T_f = C$ 且所有其他属性均为常数时，通过面 $f$ 的平流通量为：\n$$\nF_{\\text{adv},f} = (\\rho c_p \\boldsymbol{u} C \\cdot \\boldsymbol{n}_f) A_f\n$$\n由于 $\\rho, c_p, C$ 和 $\\boldsymbol{u}$ 均为常数，我们可以将它们从点积中提出来：\n$$\nF_{\\text{adv},f} = \\rho c_p C (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f\n$$\n对残差的总平流贡献是控制体所有面上的总和：\n$$\nR_{\\text{adv}} = \\sum_f F_{\\text{adv},f} = \\sum_f \\rho c_p C (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f\n$$\n我们可以将常数从求和中提出来：\n$$\nR_{\\text{adv}} = \\rho c_p C \\boldsymbol{u} \\cdot \\left( \\sum_f \\boldsymbol{n}_f A_f \\right)\n$$\n项 $\\sum_f \\boldsymbol{n}_f A_f$ 是一个封闭控制体的面积加权外法向量之和。对于任何封闭多面体，这个和恒为零。这是一个基本的几何属性，是高斯定理 $\\oint_S \\boldsymbol{n} \\, dA = \\boldsymbol{0}$ 对于封闭曲面 $S$ 的离散模拟。\n\n让我们为所讨论的矩形控制体验证这一点。主网格单元（对于 CC）和中分对偶单元（对于均匀网格上的 VC）都是尺寸为 $\\Delta x \\times \\Delta y$ 的矩形。我们用 $e, w, n, s$ 分别表示东、西、北、南四个面。\n指向外部的、面积加权的法向量为：\n-   $\\boldsymbol{n}_e A_e = (1, 0) \\Delta y$\n-   $\\boldsymbol{n}_w A_w = (-1, 0) \\Delta y$\n-   $\\boldsymbol{n}_n A_n = (0, 1) \\Delta x$\n-   $\\boldsymbol{n}_s A_s = (0, -1) \\Delta x$\n将这些向量相加得到：\n$$\n\\sum_f \\boldsymbol{n}_f A_f = (1, 0)\\Delta y + (-1, 0)\\Delta y + (0, 1)\\Delta x + (0, -1)\\Delta x = (\\Delta y - \\Delta y, \\Delta x - \\Delta x) = (0, 0) = \\boldsymbol{0}\n$$\n这个几何恒等式对主控制体和对偶控制体都成立。因此，总平流通量为：\n$$\nR_{\\text{adv}} = \\rho c_p C \\boldsymbol{u} \\cdot \\boldsymbol{0} = 0\n$$\n\n**对两种格式的结论：**\n总残差 $R$ 是扩散残差与平流残差之和。\n$$\nR = R_{\\text{diff}} + R_{\\text{adv}} = 0 + 0 = 0\n$$\n这个结果与选择单元中心格式还是节点中心格式无关，只要 a) 控制体是封闭多边形（它们确实是），b) 扩散通量近似对于常数场为零，以及 c) 平流通量近似对于常数场是相容的。问题陈述保证了这些条件的满足。\n\n因此，单元中心格式的离散净通量和为 $R_{\\mathrm{CC}} = 0$，节点中心格式的为 $R_{\\mathrm{VC}} = 0$。所求的有序对是 $(R_{\\mathrm{CC}}, R_{\\mathrm{VC}}) = (0, 0)$。值 $0$ 是一个无量纲数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在验证了方案的基本一致性之后，下一步是在一个具有非平凡解析解的问题上评估其性能和准确性。本练习探讨了一个经典的稳态热传导问题，其温度场呈线性分布。我们将比较以单元为中心和以顶点为中心的方案在计算边界热通量这一关键工程量时的具体方法，从而揭示两者在边界条件处理和结果解读上的实践差异。",
            "id": "3939451",
            "problem": "考虑在单位正方形区域 $\\Omega = \\{(x,y) \\mid 0 \\leq x \\leq 1, 0 \\leq y \\leq 1\\}$ 内，一种均匀、各向同性、具有恒定热导率 $k$ 的材料中的稳态热传导。控制方程为拉普拉斯方程 $\\nabla^{2}T = 0$，边界条件为：对于 $0 \\leq y \\leq 1$，$T(0,y) = 1$，$T(1,y) = 0$；顶部和底部为绝热（齐次诺伊曼）边界，即在 $y=0$ 和 $y=1$ 处 $\\partial T/\\partial y = 0$。内部没有热源产生。\n\n在一系列均匀笛卡尔网格上，比较两种有限体积格式：\n- 一种单元中心有限体积法 (FVM)，其中未知量位于单元中心，边界通量在边界面上保守地计算，并对狄利克雷边界采用与格式一致的二阶精确处理。\n- 一种节点中心 FVM，其中未知量位于网格节点，控制体围绕节点构建，边界节点处的法向通量使用与格式一致的二阶精确单边近似进行计算。\n\n对于每种格式，使用傅里叶定律 $\\mathbf{q}=-k \\nabla T$ 定义边界法向热通量，并按如下方式构建穿过左边界 $x=0$ 的面积平均法向通量：\n- 对于单元中心格式，计算沿 $x=0$ 的每个边界面上的通量，并对所有这些面进行平均（在均匀网格上，每个面的长度相等）。\n- 对于节点中心格式，计算在 $x=0$ 的每个边界节点处的逐点法向通量，并对所有这些节点进行平均。\n\n令 $q_{\\mathrm{CC}}$ 表示单元中心格式得到的面积平均法向通量大小，令 $q_{\\mathrm{VC}}$ 表示节点中心格式得到的节点法向通量大小的平均值。从第一性原理（控制方程、边界条件和傅里叶定律）出发，推导此问题中 $q_{\\mathrm{CC}}$ 和 $q_{\\mathrm{VC}}$ 的表达式。然后，计算比值\n$$ R = \\frac{q_{\\mathrm{CC}}}{q_{\\mathrm{VC}}}. $$\n将 $R$ 以无量纲数的形式报告。将你的答案四舍五入到四位有效数字。如果在任何阶段计算通量，请以 $\\mathrm{W/m^{2}}$ 为单位表示。",
            "solution": "### 步骤1：解析解与精确通量\n\n首先，我们确定问题的解析解。对于给定的拉普拉斯方程和边界条件，温度场只随 $x$ 变化，即 $T(x,y) = T(x)$。控制方程简化为 $\\frac{d^2 T}{dx^2} = 0$，其通解为 $T(x) = Ax + B$。\n应用边界条件 $T(0)=1$ 和 $T(1)=0$，我们得到 $B=1$ 和 $A=-1$。因此，解析解为：\n$$ T(x,y) = 1 - x $$\n该解自动满足顶部和底部的绝热边界条件 $\\partial T/\\partial y = 0$。\n\n根据傅里叶定律 $\\mathbf{q} = -k \\nabla T$，热通量矢量为 $\\mathbf{q} = -k(-1, 0) = (k, 0)$。\n在左边界 ($x=0$)，向外的单位法向量为 $\\mathbf{n} = (-1, 0)$。穿过边界的法向热通量为 $\\mathbf{q} \\cdot \\mathbf{n} = (k, 0) \\cdot (-1, 0) = -k$。\n问题要求的是通量的大小，因此精确的法向通量大小为 $|-k| = k$。由于该值沿边界恒定，面积平均的精确通量大小也是 $q_{\\text{exact}} = k$。\n\n### 步骤2：单元中心格式 (CC-FVM) 通量计算\n\n对于线性的温度场，任何一致的有限体积格式都应能精确地重现解（在机器精度内）。因此，我们预期数值计算得到的通量也应是精确的。\n在单元中心格式中，未知数位于单元中心。对于邻近 $x=0$ 边界的第一个单元，其中心位于 $x_1 = \\Delta x/2$。其温度为 $T_1 = T(x_1) = 1 - \\Delta x/2$。\n问题规定对狄利克雷边界采用二阶精确处理。一个标准方法是使用幽灵单元。我们将一个虚拟的幽灵单元中心置于 $x_G = -\\Delta x/2$。其温度 $T_G$ 通过线性外插来设定，使得 $x=0$ 处的温度为 $T(0)=1$。在对称网格中，这意味着边界温度是相邻单元中心温度的平均值：$1 = (T_G + T_1) / 2$。\n解出幽灵单元温度：$T_G = 2 - T_1 = 2 - (1 - \\Delta x/2) = 1 + \\Delta x/2$。\n边界上的通量可以使用以边界为中心的二阶差分格式计算：\n$$ q_{\\mathrm{CC}} = \\left| -k \\frac{T_1 - T_G}{\\Delta x} \\right| = \\left| -k \\frac{(1 - \\Delta x/2) - (1 + \\Delta x/2)}{\\Delta x} \\right| = \\left| -k \\frac{-\\Delta x}{\\Delta x} \\right| = |-k(-1)| = k $$\n由于此结果与 $y$ 无关，沿边界的面积平均通量大小为 $q_{\\mathrm{CC}} = k$。\n\n### 步骤3：节点中心格式 (VC-FVM) 通量计算\n\n在节点中心格式中，未知数位于网格节点上。同样，对于线性解，数值解在节点上是精确的。因此，在 $x=0$ 边界和其邻近节点上的温度为：\n- $T_{0,j} = T(0, y_j) = 1$\n- $T_{1,j} = T(\\Delta x, y_j) = 1 - \\Delta x$\n- $T_{2,j} = T(2\\Delta x, y_j) = 1 - 2\\Delta x$\n\n问题规定使用二阶精确的单边近似来计算边界节点的法向通量。对于函数 $f(x)$ 在 $x_0$ 处的导数，使用 $x_0$, $x_0+\\Delta x$, $x_0+2\\Delta x$ 处的函数值的标准二阶向前差分公式为：\n$$ f'(x_0) \\approx \\frac{-3f(x_0) + 4f(x_0+\\Delta x) - f(x_0+2\\Delta x)}{2\\Delta x} $$\n将此应用于 $x=0$ 处的温度梯度计算：\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} \\approx \\frac{-3T_{0,j} + 4T_{1,j} - T_{2,j}}{2\\Delta x} = \\frac{-3(1) + 4(1 - \\Delta x) - (1 - 2\\Delta x)}{2\\Delta x} = \\frac{-3 + 4 - 4\\Delta x - 1 + 2\\Delta x}{2\\Delta x} = \\frac{-2\\Delta x}{2\\Delta x} = -1 $$\n该公式精确地得到了梯度。因此，在每个边界节点上的法向通量大小为：\n$$ q_{\\text{node}} = \\left| -k \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} \\right| = |-k(-1)| = k $$\n由于每个节点的通量大小都是 $k$，其平均值也为 $k$。因此，$q_{\\mathrm{VC}} = k$。\n\n### 步骤4：比值计算\n\n最后，我们计算两种格式得到的通量之比：\n$$ R = \\frac{q_{\\mathrm{CC}}}{q_{\\mathrm{VC}}} = \\frac{k}{k} = 1 $$\n结果为精确的 1。",
            "answer": "$$\\boxed{1.000}$$"
        }
    ]
}