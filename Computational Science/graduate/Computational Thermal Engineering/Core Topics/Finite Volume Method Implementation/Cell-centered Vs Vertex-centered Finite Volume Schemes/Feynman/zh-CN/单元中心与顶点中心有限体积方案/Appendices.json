{
    "hands_on_practices": [
        {
            "introduction": "任何数值格式的首要检验标准是其处理最简单物理情景——均匀场——的能力。本练习  探讨了单元中心和顶点中心格式的这一基本一致性要求。通过验证该格式对于恒定温度场能够正确计算出零净通量，我们可以在离散层面确认其守恒性，这是有限体积法的一个核心原则。",
            "id": "3939387",
            "problem": "考虑一个边长为 $L$ 的正方形域上被动标量温度 $T$ 的二维、稳态、无源的对流扩散问题，所有边界均为周期性边界。热导率 $k$、质量密度 $\\rho$ 和定压比热容 $c_{p}$ 均为正常数。速度场是恒定且无散的，$\\boldsymbol{u}=(u_{0},v_{0})$，其中 $u_{0}$ 和 $v_{0}$ 在空间和时间上均为常数。控制物理原理是任意控制体上的积分形式能量守恒：在没有源项的稳态下，穿过其边界的净向外扩散热通量和对流热通量之和必须为零。你将研究两种离散化方法：一种是单元中心格式，另一种是节点中心格式，两者都在有限体积法 (FVM) 框架下建立。\n\n将区域均匀划分为 $N_{x} \\times N_{y}$ 个尺寸为 $\\Delta x = L/N_{x}$ 和 $\\Delta y = L/N_{y}$ 的矩形主单元。在单元中心格式中，控制体是主单元，未知量 $T_{i,j}$ 位于单元中心。在节点中心格式中，控制体是围绕网格节点构建的中分对偶矩形，未知量 $T_{i,j}$ 位于节点。\n\n从稳态、无源对流扩散的积分守恒方程出发，仅使用最基本的两点面法向梯度近似来处理扩散项，并使用在均匀场上有界且相容的面值插值来处理对流项，构建穿过以下边界的离散净向外通量：\n- 对于单元中心格式，一个任意的内部主单元，以及\n- 对于节点中心格式，围绕一个节点的相应内部对偶控制体。\n\n假设垂直面的面积为 $\\Delta y$，水平面的面积为 $\\Delta x$，并且每个面上的向外单位法向量从控制体内部指向外部。设测试场为常数 $T\\equiv C$，其中 $C$ 为一个有限实常数。在此测试下，以闭合形式计算两种格式的离散净通量和，并以有序对 $\\left(R_{\\mathrm{CC}},R_{\\mathrm{VC}}\\right)$ 的形式返回你的答案，其中 $R_{\\mathrm{CC}}$ 是单元中心控制体的离散残差（净向外通量），$R_{\\mathrm{VC}}$ 是节点中心控制体的离散残差。最终答案表示为无量纲量。结果是精确的，因此无需四舍五入。最终答案必须是包含这两个值的单行矩阵。",
            "solution": "问题要求在温度场为常数 $T \\equiv C$ 时，计算单元中心 (CC) 和节点中心 (VC) 有限体积格式的离散净向外通量（残差）。\n\n控制物理原理是稳态、无源系统的积分形式能量守恒。对于任意控制体 $\\Omega_{\\text{CV}}$，这表示为：\n$$\n\\oint_{\\partial\\Omega_{\\text{CV}}} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, dA = 0\n$$\n其中 $\\boldsymbol{n}$ 是边界 $\\partial\\Omega_{\\text{CV}}$ 上的向外单位法向量，$\\boldsymbol{F}$ 是总热通量矢量。总热通量是扩散通量（傅里叶定律）和对流通量之和：\n$$\n\\boldsymbol{F} = -k \\nabla T + \\rho c_p \\boldsymbol{u} T\n$$\n在这里，热导率 $k$、质量密度 $\\rho$、比热容 $c_p$ 和速度场 $\\boldsymbol{u}=(u_0, v_0)$ 均为常数。\n\n在有限体积法 (FVM) 中，该积分通过对构成控制体边界的离散面 $f$ 求和来近似：\n$$\nR \\equiv \\sum_{f \\in \\partial\\Omega_{\\text{CV}}} (\\boldsymbol{F}_f \\cdot \\boldsymbol{n}_f) A_f\n$$\n其中 $R$ 是离散残差，或称净向外通量。$\\boldsymbol{F}_f$ 是在面 $f$ 中心的通量矢量的近似值，$\\boldsymbol{n}_f$ 是面 $f$ 的向外单位法向量，$A_f$ 是面 $f$ 的面积。\n\n穿过一个面 $f$ 的总通量可以分解为其扩散分量和对流分量：\n$$\nF_f = (\\boldsymbol{F}_f \\cdot \\boldsymbol{n}_f) A_f = \\underbrace{\\left(-k (\\nabla T)_f \\cdot \\boldsymbol{n}_f\\right) A_f}_{F_{\\text{diff},f}} + \\underbrace{\\left((\\rho c_p \\boldsymbol{u} T)_f \\cdot \\boldsymbol{n}_f\\right) A_f}_{F_{\\text{adv},f}}\n$$\n我们需要针对温度场为常数 $T(x,y) = C$ 的特定测试案例，计算总残差 $R = \\sum_f (F_{\\text{diff},f} + F_{\\text{adv},f})$。\n\n让我们分析每种通量类型的贡献。\n\n1.  **扩散通量的贡献：**\n问题指明使用“最基本的两点面法向梯度近似”。对于分隔两个节点（单元中心或顶点）的任意面 $f$，这两个节点记为 $P$（主节点）和 $N$（邻近节点），垂直于该面的梯度分量近似为：\n$$\n(\\nabla T)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{T_N - T_P}{d_{PN}}\n$$\n其中 $T_P$ 和 $T_N$ 是节点上的温度值，$d_{PN}$ 是它们之间的垂直距离。\n在该测试案例中，温度场是常数 $T \\equiv C$。这意味着网格中每个节点上的温度都是 $C$。因此，对于任意面，都有 $T_N = C$ 和 $T_P = C$。\n法向梯度近似变为：\n$$\n(\\nabla T)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{C-C}{d_{PN}} = 0\n$$\n因此，通过任意面的扩散通量为零：\n$$\nF_{\\text{diff},f} = -k \\left( (\\nabla T)_f \\cdot \\boldsymbol{n}_f \\right) A_f = -k(0)A_f = 0\n$$\n这对任何控制体的每个面都成立，无论格式是单元中心还是节点中心。因此，控制体所有面上的扩散通量之和为零：\n$$\nR_{\\text{diff}} = \\sum_f F_{\\text{diff},f} = 0\n$$\n\n2.  **对流通量的贡献：**\n通过面 $f$ 的对流通量由 $F_{\\text{adv},f} = ((\\rho c_p \\boldsymbol{u} T)_f \\cdot \\boldsymbol{n}_f) A_f$ 给出。材料属性 $\\rho, c_p$ 和速度 $\\boldsymbol{u}$ 是常数。项 $T_f$ 是插值到面中心的温度。\n问题指出面值插值格式“在均匀场上是相容的”。常数场 $T(x,y)=C$ 是一个均匀场。相容性意味着插值必须精确地恢复该常数值。因此，对于任意面 $f$，插值温度为 $T_f = C$。\n\n当 $T_f = C$ 且所有其他属性均为常数时，通过面 $f$ 的对流通量为：\n$$\nF_{\\text{adv},f} = (\\rho c_p \\boldsymbol{u} C \\cdot \\boldsymbol{n}_f) A_f\n$$\n由于 $\\rho, c_p, C,$ 和 $\\boldsymbol{u}$ 都是常数，我们可以将它们从点积中提取出来：\n$$\nF_{\\text{adv},f} = \\rho c_p C (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f\n$$\n对残差的总对流贡献是控制体所有面上的总和：\n$$\nR_{\\text{adv}} = \\sum_f F_{\\text{adv},f} = \\sum_f \\rho c_p C (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f\n$$\n我们可以从求和中提取出常数：\n$$\nR_{\\text{adv}} = \\rho c_p C \\boldsymbol{u} \\cdot \\left( \\sum_f \\boldsymbol{n}_f A_f \\right)\n$$\n项 $\\sum_f \\boldsymbol{n}_f A_f$ 是一个闭合控制体所有面积加权的向外法向量之和。对于任何闭合多面体，这个和恒等于零。这是一个基本的几何性质，是高斯定理恒等式 $\\oint_S \\boldsymbol{n} \\, dA = \\boldsymbol{0}$ (对于一个闭合曲面 $S$) 的离散形式。\n\n让我们对所讨论的矩形控制体验证这一点。主单元（对于CC）和中分对偶单元（对于均匀网格上的VC）都是尺寸为 $\\Delta x \\times \\Delta y$ 的矩形。我们用 $e, w, n, s$ 表示东、西、北、南四个面。\n指向外部的、面积加权的法向量是：\n-   $\\boldsymbol{n}_e A_e = (1, 0) \\Delta y$\n-   $\\boldsymbol{n}_w A_w = (-1, 0) \\Delta y$\n-   $\\boldsymbol{n}_n A_n = (0, 1) \\Delta x$\n-   $\\boldsymbol{n}_s A_s = (0, -1) \\Delta x$\n将这些向量相加得到：\n$$\n\\sum_f \\boldsymbol{n}_f A_f = (1, 0)\\Delta y + (-1, 0)\\Delta y + (0, 1)\\Delta x + (0, -1)\\Delta x = (\\Delta y - \\Delta y, \\Delta x - \\Delta x) = (0, 0) = \\boldsymbol{0}\n$$\n这个几何恒等式对主控制体和对偶控制体都成立。因此，总对流通量为：\n$$\nR_{\\text{adv}} = \\rho c_p C \\boldsymbol{u} \\cdot \\boldsymbol{0} = 0\n$$\n\n**两种格式的结论：**\n总残差 $R$ 是扩散残差和对流残差之和。\n$$\nR = R_{\\text{diff}} + R_{\\text{adv}} = 0 + 0 = 0\n$$\n这个结果与单元中心或节点中心格式的具体选择无关，只要 a) 控制体是闭合多边形（它们是），b) 扩散通量近似对于常数场为零，以及 c) 对流通量近似对于常数场是相容的。问题陈述保证了这些条件。\n\n因此，单元中心格式的离散净通量和为 $R_{\\mathrm{CC}} = 0$，节点中心格式的离散净通量和为 $R_{\\mathrm{VC}} = 0$。所求的有序对是 $(R_{\\mathrm{CC}}, R_{\\mathrm{VC}}) = (0, 0)$。数值 $0$ 是一个无量纲数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确认了基本的一致性之后，下一步是评估数值格式在处理非平凡解时的精度，以及其计算重要工程量的能力。本练习  研究了一个具有线性温度分布的经典热传导问题，重点关注计算边界热通量这一关键任务。它直接比较了单元中心和顶点中心方法如何处理边界条件和梯度计算，而这些方面正是两者在实际应用中的重要区别点。",
            "id": "3939451",
            "problem": "考虑在占据单位正方形域 $\\Omega = \\{(x,y) \\mid 0 \\leq x \\leq 1, 0 \\leq y \\leq 1\\}$ 的均匀、各向同性材料中的稳态热传导，该材料具有恒定的导热系数 $k$。控制方程为拉普拉斯方程 $ \\nabla^{2} T = 0$，边界条件为 $T(0,y) = 1$、$T(1,y) = 0$（对于 $0 \\leq y \\leq 1$），以及顶部和底部的绝热（齐次诺伊曼）边界，即在 $y=0$ 和 $y=1$ 处 $\\partial T/\\partial y = 0$。没有内部热源。\n\n在一系列均匀的笛卡尔网格上，比较两种有限体积格式：\n- 一种单元中心有限体积法（FVM），其中未知量位于单元中心，边界通量在边界面上使用与格式一致的狄利克雷边界二阶精确处理方法进行保守计算。\n- 一种节点中心有限体积法（FVM），其中未知量位于网格节点，控制体围绕节点构建，边界节点处的法向通量使用与格式一致的二阶精确单边近似方法进行计算。\n\n对于每种格式，使用傅里叶定律 $ \\mathbf{q} = -k \\nabla T$ 定义边界法向热通量，并按如下方式构建穿过左边界 $x=0$ 的面积平均边界法向通量：\n- 对于单元中心格式，计算沿 $x=0$ 的每个边界面上基于面的通量，并对所有这些面进行平均（在均匀网格上，每个面的长度相等）。\n- 对于节点中心格式，计算在 $x=0$ 的每个边界节点处的逐点节点边界法向通量，并对所有这些节点进行平均。\n\n令 $q_{\\mathrm{CC}}$ 表示单元中心格式计算出的面积平均边界法向通量大小，令 $q_{\\mathrm{VC}}$ 表示节点中心格式计算出的节点边界法向通量大小的平均值。从第一性原理（控制方程、边界条件和傅里叶定律）出发，推导该问题中 $q_{\\mathrm{CC}}$ 和 $q_{\\mathrm{VC}}$ 的表达式。然后，计算比值\n$$ R = \\frac{q_{\\mathrm{CC}}}{q_{\\mathrm{VC}}}. $$\n将 $R$ 以无量纲数的形式报告。将答案四舍五入到四位有效数字。如果在任何阶段计算通量，请以 $\\mathrm{W/m^{2}}$ 为单位表示。",
            "solution": "### 步骤1：解析解与精确通量\n首先，我们求解该问题的解析解。控制方程为拉普拉斯方程 $\\nabla^2 T = 0$。鉴于边界条件在 $y$ 方向上是均匀的（$x$ 方向为狄利克雷条件，$y$ 方向为绝热条件），我们可以假设解只与 $x$ 相关，即 $T(x,y) = T(x)$。\n代入拉普拉斯方程得到 $\\frac{d^2 T}{dx^2} = 0$。\n其通解为 $T(x) = Ax + B$。\n应用边界条件：\n- 在 $x=0$ 处：$T(0) = A(0) + B = 1 \\implies B=1$。\n- 在 $x=1$ 处：$T(1) = A(1) + 1 = 0 \\implies A=-1$。\n因此，该问题的精确解析解为 $T(x,y) = 1 - x$。该解也自动满足在 $y=0$ 和 $y=1$ 处的绝热边界条件，因为 $\\frac{\\partial T}{\\partial y} = \\frac{\\partial (1-x)}{\\partial y} = 0$。\n\n根据傅里叶定律 $\\mathbf{q} = -k \\nabla T$，热通量矢量为：\n$\\mathbf{q} = -k \\nabla(1-x) = -k(-1, 0) = (k, 0)$。\n在左边界 ($x=0$)，向外的单位法向量为 $\\mathbf{n} = (-1, 0)$。穿过该边界的法向热通量为 $\\mathbf{q} \\cdot \\mathbf{n} = (k, 0) \\cdot (-1, 0) = -k$。\n问题要求的是通量的大小，因此精确的边界通量大小为 $q_{\\text{exact}} = |-k| = k$。由于该值在整个边界上是恒定的，其面积平均值也是 $k$。\n\n### 步骤2：单元中心有限体积法 (CC-FVM) 通量计算\n问题指出，单元中心格式使用“二阶精确”的方法计算边界通量。对于线性解 $T=1-x$，任何二阶或更高阶精确的格式都应该能得到精确解。我们通过一个标准的二阶方法来验证这一点。\n考虑左边界 $x=0$ 处的一个面。我们可以使用虚拟单元法来计算通过该面的通量。设第一个内部单元的中心位于 $x_1 = \\Delta x/2$，其温度为 $T_1 = T(x_1) = 1 - \\Delta x/2$。为了在边界 $x=0$ 上强制施加 $T_b=1$ 的条件，我们引入一个位于 $x_G = -\\Delta x/2$ 的虚拟单元中心，其温度为 $T_G$。通过线性插值，边界温度为 $T_b = (T_1 + T_G)/2$。\n因此，$T_G = 2T_b - T_1 = 2(1) - (1 - \\Delta x/2) = 1 + \\Delta x/2$。\n穿过边界面的通量（从单元1向外）由中心差分近似给出：\n$q_{\\text{face}} = -k \\frac{T_1 - T_G}{\\Delta x} = -k \\frac{(1 - \\Delta x/2) - (1 + \\Delta x/2)}{\\Delta x} = -k \\frac{-\\Delta x}{\\Delta x} = k$。\n通量的大小为 $k$。由于该值对于沿 $x=0$ 的所有边界面都是相同的，因此面积平均边界法向通量大小 $q_{\\mathrm{CC}} = k$。\n\n### 步骤3：节点中心有限体积法 (VC-FVM) 通量计算\n问题指出，节点中心格式在边界节点处使用“二阶精确的单边近似”来计算梯度。标准的二阶向前差分公式用于计算函数 $f(x)$ 在 $x_0$ 处的导数，使用 $x_0$, $x_1=x_0+\\Delta x$, $x_2=x_0+2\\Delta x$ 三个点的值：\n$$ f'(x_0) \\approx \\frac{-3f(x_0) + 4f(x_1) - f(x_2)}{2\\Delta x} $$\n我们将此公式应用于在左边界 $x=0$ 上的任意节点 $(0,j)$。节点上的温度值是精确解在该点的取值：\n- $T_{0,j} = T(0) = 1$\n- $T_{1,j} = T(\\Delta x) = 1 - \\Delta x$\n- $T_{2,j} = T(2\\Delta x) = 1 - 2\\Delta x$\n代入公式计算 $x$ 方向的梯度：\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} \\approx \\frac{-3(1) + 4(1 - \\Delta x) - (1 - 2\\Delta x)}{2\\Delta x} = \\frac{-3 + 4 - 4\\Delta x - 1 + 2\\Delta x}{2\\Delta x} = \\frac{-2\\Delta x}{2\\Delta x} = -1 $$\n这正是精确的梯度值。因此，在任一边界节点处的法向通量大小为：\n$q_{\\text{node}} = \\left| -k \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} \\right| = |-k(-1)| = k$。\n由于左边界上每个节点的通量大小均为 $k$，这些值的平均值 $q_{\\mathrm{VC}}$ 也是 $k$。\n\n### 步骤4：最终比值计算\n我们计算所求的比值 $R = \\frac{q_{\\mathrm{CC}}}{q_{\\mathrm{VC}}}$。\n根据以上推导：\n- $q_{\\mathrm{CC}} = k$\n- $q_{\\mathrm{VC}} = k$\n因此，比值为：\n$$ R = \\frac{k}{k} = 1 $$\n问题要求将答案四舍五入到四位有效数字。",
            "answer": "$$\\boxed{1.000}$$"
        }
    ]
}