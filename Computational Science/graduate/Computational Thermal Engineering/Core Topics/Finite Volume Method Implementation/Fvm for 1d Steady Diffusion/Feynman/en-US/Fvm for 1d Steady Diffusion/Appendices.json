{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex scenarios, it is crucial to verify that our numerical method behaves as expected on a simple, well-understood problem. This practice guides you through the fundamental process of code verification by comparing your Finite Volume Method (FVM) implementation against a known analytical solution for steady diffusion with a uniform heat source. By performing a grid refinement study, you will confirm the second-order accuracy of the standard cell-centered FVM scheme, a cornerstone of computational analysis. ",
            "id": "3956039",
            "problem": "Consider one-dimensional, steady heat conduction in a homogeneous rod of length $L$ with constant thermal conductivity $k$, constant cross-sectional area $A$, and uniform volumetric heat generation $\\dot{q}'''$. The governing energy conservation law for one-dimensional, steady diffusion with internal generation is the divergence form of Fourier’s law integrated over a control volume, which reduces in the continuum limit to a second-order ordinary differential equation for the temperature field. The unknown field is the temperature $T(x)$ defined for $x \\in [0,L]$. Assume Dirichlet boundary conditions $T(0) = T_0$ and $T(L) = T_L$.\n\nTasks:\n- From the fundamental energy conservation law and Fourier’s law, derive the continuous equation for $T(x)$, and solve exactly for $T(x)$ under the Dirichlet boundary conditions stated above. Show that the exact solution is quadratic in $x$ and uniquely determined by $k$, $A$, $\\dot{q}'''$, $T_0$, $T_L$, and $L$. Temperature must be expressed in kelvin ($\\mathrm{K}$), thermal conductivity in $\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, cross-sectional area in $\\mathrm{m}^2$, volumetric generation in $\\mathrm{W}/\\mathrm{m}^3$, and length in meters ($\\mathrm{m}$).\n- Derive a cell-centered Finite Volume Method (FVM) discretization on a uniform grid with $N$ control volumes of size $\\Delta x = L/N$. Use two-point, centered approximations for face-normal gradients and treat Dirichlet boundary faces with the half-control-volume distance. Write the discrete equations in the canonical FVM form $a_P T_P = a_W T_W + a_E T_E + S_u$ for each control volume, where $T_P$ denotes the cell-center temperature, $T_W$ and $T_E$ its west and east neighbors, and $S_u$ the integrated source contribution.\n- Implement a program to assemble and solve the resulting tridiagonal linear system for $T_P$ at the cell centers. Then evaluate the exact continuous solution at the same cell-center locations and compute the error norm. Use the discrete $L^2$ (integral) norm computed as $\\sqrt{\\sum_{i=1}^N \\left(T_i^{\\text{disc}} - T(x_i)^{\\text{exact}}\\right)^2 \\Delta x}$, where $x_i$ are the cell-center coordinates and $T_i^{\\text{disc}}$ are the discrete temperatures at those centers.\n- Confirm second-order spatial accuracy by computing the observed order $p$ via $p = \\log_2\\left(E_h/E_{h/2}\\right)$, where $E_h$ is the error norm on a grid with spacing $h=\\Delta x$ and $E_{h/2}$ is the error norm on the grid refined by a factor of $2$.\n\nTest suite and required outputs:\n- Use the following three test cases to evaluate the implementation:\n  1. Case A (symmetric boundary temperatures, nonzero generation): $L = 0.2\\,\\mathrm{m}$, $k = 15.0\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $A = 1.0\\times 10^{-3}\\,\\mathrm{m}^2$, $\\dot{q}''' = 2.0\\times 10^{5}\\,\\mathrm{W}/\\mathrm{m}^3$, $T_0 = 300.0\\,\\mathrm{K}$, $T_L = 300.0\\,\\mathrm{K}$, with two grids $N=40$ and $N=80$. Output the observed order $p$ as a float.\n  2. Case B (asymmetric boundary temperatures, nonzero generation): $L = 0.1\\,\\mathrm{m}$, $k = 200.0\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $A = 5.0\\times 10^{-4}\\,\\mathrm{m}^2$, $\\dot{q}''' = 1.0\\times 10^{6}\\,\\mathrm{W}/\\mathrm{m}^3$, $T_0 = 300.0\\,\\mathrm{K}$, $T_L = 350.0\\,\\mathrm{K}$, with two grids $N=20$ and $N=40$. Output the observed order $p$ as a float.\n  3. Case C (edge case, zero generation): $L = 0.3\\,\\mathrm{m}$, $k = 50.0\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $A = 2.0\\times 10^{-4}\\,\\mathrm{m}^2$, $\\dot{q}''' = 0.0\\,\\mathrm{W}/\\mathrm{m}^3$, $T_0 = 300.0\\,\\mathrm{K}$, $T_L = 350.0\\,\\mathrm{K}$, with two grids $N=10$ and $N=20$. Since the exact solution is linear, the centered FVM should reproduce it to within round-off; output a boolean that is True if both grid errors are below $1.0\\times 10^{-11}\\,\\mathrm{K}$ in the discrete $L^2$ norm and False otherwise.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Case A, Case B, Case C (for example, $[p_A,p_B,\\text{boolean}_C]$). The numbers $p_A$ and $p_B$ are dimensionless and must be printed as floating-point numbers. The boolean for Case C must be printed as either True or False.",
            "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded problem in computational heat transfer that is self-contained and free of ambiguity or contradiction.\n\n### Part 1: Continuous Governing Equation and Exact Solution\n\nThe fundamental principle governing the process is the conservation of energy. For a one-dimensional, steady-state system, the energy balance on an arbitrary control volume of length $\\Delta x$ and constant cross-sectional area $A$ is:\n\n(Rate of energy conducted in) + (Rate of energy generated) = (Rate of energy conducted out)\n\nLet $q(x)$ be the heat flux in the positive $x$-direction in units of $\\mathrm{W}/\\mathrm{m}^2$. The rate of heat transfer (heat current) is $Q(x) = q(x) A$. The energy balance becomes:\n$$Q(x) - Q(x+\\Delta x) + \\dot{q}''' (A \\Delta x) = 0$$\nwhere $\\dot{q}'''$ is the uniform volumetric heat generation rate in $\\mathrm{W}/\\mathrm{m}^3$. Dividing by the volume $A \\Delta x$ and taking the limit as $\\Delta x \\to 0$ gives the differential form of the energy conservation equation:\n$$-\\frac{d}{dx}q(x) + \\dot{q}''' = 0$$\nFourier's law of heat conduction relates the heat flux to the temperature gradient:\n$$q(x) = -k \\frac{dT}{dx}$$\nwhere $k$ is the thermal conductivity in $\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$ and $T(x)$ is the temperature field. Substituting Fourier's law into the conservation equation yields:\n$$-\\frac{d}{dx}\\left(-k \\frac{dT}{dx}\\right) + \\dot{q}''' = 0$$\nSince the thermal conductivity $k$ is assumed to be constant, this simplifies to the second-order ordinary differential equation (ODE) for $T(x)$:\n$$\\frac{d^2T}{dx^2} = -\\frac{\\dot{q}'''}{k}$$\nTo find the exact solution, we integrate this ODE twice with respect to $x$:\n$$\\frac{dT}{dx} = -\\frac{\\dot{q}'''}{k}x + C_1$$\n$$T(x) = -\\frac{\\dot{q}'''}{2k}x^2 + C_1 x + C_2$$\nThis demonstrates that the exact solution is a quadratic function of $x$. The integration constants $C_1$ and $C_2$ are determined by applying the Dirichlet boundary conditions, $T(0) = T_0$ and $T(L) = T_L$.\n\nAt $x=0$:\n$$T(0) = T_0 = -\\frac{\\dot{q}'''}{2k}(0)^2 + C_1(0) + C_2 \\implies C_2 = T_0$$\nAt $x=L$:\n$$T(L) = T_L = -\\frac{\\dot{q}'''}{2k}L^2 + C_1 L + T_0$$\nSolving for $C_1$:\n$$C_1 L = T_L - T_0 + \\frac{\\dot{q}'''L^2}{2k} \\implies C_1 = \\frac{T_L - T_0}{L} + \\frac{\\dot{q}'''L}{2k}$$\nSubstituting $C_1$ and $C_2$ back into the expression for $T(x)$ gives the unique exact solution:\n$$T(x) = -\\frac{\\dot{q}'''}{2k}x^2 + \\left(\\frac{T_L - T_0}{L} + \\frac{\\dot{q}'''L}{2k}\\right)x + T_0$$\nThis can be rearranged into a superposition of the linear profile (conduction without source) and the parabolic profile (source with zero boundary temperatures):\n$$T(x)^{\\text{exact}} = T_0 + (T_L - T_0)\\frac{x}{L} + \\frac{\\dot{q}'''}{2k}(Lx - x^2)$$\nThis solution is uniquely determined by the parameters $k, \\dot{q}''', T_0, T_L,$ and $L$. The area $A$ does not appear in the governing equation for temperature, as it cancels out, but is required for calculating total heat rates.\n\n### Part 2: Finite Volume Method (FVM) Discretization\n\nWe discretize the domain $x \\in [0, L]$ into $N$ uniform, cell-centered control volumes (CVs), each of width $\\Delta x = L/N$. The center of the $i$-th CV is denoted by $P$ (or $i$), with coordinate $x_i = (i-0.5)\\Delta x$ for $i=1, 2, \\dots, N$. The west and east faces of the $i$-th CV are located at $x_w = (i-1)\\Delta x$ and $x_e = i\\Delta x$, respectively.\n\nWe integrate the original conservation law, $\\frac{d}{dx}(k \\frac{dT}{dx}) + \\dot{q}''' = 0$, over the $i$-th control volume:\n$$\\int_{x_w}^{x_e} \\left(\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) + \\dot{q}'''\\right) A \\, dx = 0$$\n$$A \\int_{x_w}^{x_e} \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dx + A \\int_{x_w}^{x_e} \\dot{q}''' \\, dx = 0$$\nApplying the fundamental theorem of calculus to the first term and evaluating the integral of the constant source term:\n$$A \\left[k \\frac{dT}{dx}\\right]_w^e + A \\dot{q}''' \\Delta x = 0$$\n$$A \\left(k \\frac{dT}{dx}\\right)_e - A \\left(k \\frac{dT}{dx}\\right)_w + A \\dot{q}''' \\Delta x = 0$$\nThe gradients at the cell faces are approximated using centered differences between adjacent cell-center temperatures. For an internal cell $i$, its neighbors are cell $W$ (west, $i-1$) and cell $E$ (east, $i+1$).\n$$\\left(\\frac{dT}{dx}\\right)_e \\approx \\frac{T_E - T_P}{\\Delta x} \\quad \\text{and} \\quad \\left(\\frac{dT}{dx}\\right)_w \\approx \\frac{T_P - T_W}{\\Delta x}$$\nSubstituting these into the integrated balance equation for an internal CV ($i=2, \\dots, N-1$):\n$$A k \\frac{T_E - T_P}{\\Delta x} - A k \\frac{T_P - T_W}{\\Delta x} + A \\dot{q}''' \\Delta x = 0$$\nRearranging to the canonical FVM form $a_P T_P = a_W T_W + a_E T_E + S_u$:\n$$\\left(\\frac{kA}{\\Delta x} + \\frac{kA}{\\Delta x}\\right) T_P = \\left(\\frac{kA}{\\Delta x}\\right) T_W + \\left(\\frac{kA}{\\Delta x}\\right) T_E + \\dot{q}''' A \\Delta x$$\nThe coefficients for an internal cell are: $a_P = \\frac{2kA}{\\Delta x}$, $a_W = a_E = \\frac{kA}{\\Delta x}$, and the source term is $S_u = \\dot{q}''' A \\Delta x$.\n\nFor boundary cells, the treatment is modified:\n**Cell 1 (West Boundary):** The west face is the physical boundary at $x=0$ with temperature $T_0$. The gradient at this face is approximated over the half-cell distance $\\Delta x/2$:\n$$\\left(\\frac{dT}{dx}\\right)_w \\approx \\frac{T_P - T_0}{\\Delta x / 2} = \\frac{T_1 - T_0}{\\Delta x / 2}$$\nThe east face gradient is standard: $(\\frac{dT}{dx})_e \\approx \\frac{T_2 - T_1}{\\Delta x}$. Substituting into the balance:\n$$A k \\frac{T_2 - T_1}{\\Delta x} - A k \\frac{T_1 - T_0}{\\Delta x/2} + A \\dot{q}''' \\Delta x = 0$$\nRearranging for $T_P = T_1$:\n$$\\left(\\frac{kA}{\\Delta x} + \\frac{2kA}{\\Delta x}\\right) T_1 = \\left(\\frac{kA}{\\Delta x}\\right) T_2 + \\left(\\frac{2kA}{\\Delta x} T_0 + \\dot{q}''' A \\Delta x\\right)$$\nHere, $a_P = \\frac{3kA}{\\Delta x}$, $a_W = 0$, $a_E = \\frac{kA}{\\Delta x}$, and $S_u = \\frac{2kA}{\\Delta x} T_0 + \\dot{q}''' A \\Delta x$.\n\n**Cell N (East Boundary):** The east face is the boundary at $x=L$ with $T_L$. The gradient is approximated as:\n$$\\left(\\frac{dT}{dx}\\right)_e \\approx \\frac{T_L - T_P}{\\Delta x / 2} = \\frac{T_L - T_N}{\\Delta x / 2}$$\nThe west face gradient is $(\\frac{dT}{dx})_w \\approx \\frac{T_N - T_{N-1}}{\\Delta x}$. Substituting into the balance:\n$$A k \\frac{T_L - T_N}{\\Delta x/2} - A k \\frac{T_N - T_{N-1}}{\\Delta x} + A \\dot{q}''' \\Delta x = 0$$\nRearranging for $T_P = T_N$:\n$$\\left(\\frac{2kA}{\\Delta x} + \\frac{kA}{\\Delta x}\\right) T_N = \\left(\\frac{kA}{\\Delta x}\\right) T_{N-1} + \\left(\\frac{2kA}{\\Delta x} T_L + \\dot{q}''' A \\Delta x\\right)$$\nHere, $a_P = \\frac{3kA}{\\Delta x}$, $a_W = \\frac{kA}{\\Delta x}$, $a_E = 0$, and $S_u = \\frac{2kA}{\\Delta x} T_L + \\dot{q}''' A \\Delta x$.\n\n### Part 3: Linear System and Accuracy Verification\n\nThe set of $N$ linear algebraic equations forms a tridiagonal system $\\mathbf{M}\\mathbf{T} = \\mathbf{b}$, where $\\mathbf{T} = [T_1, T_2, \\dots, T_N]^T$. For implementation, it is convenient to divide all equations by $kA/\\Delta x$:\n- **Equation 1:** $3 T_1 - T_2 = \\frac{\\dot{q}''' (\\Delta x)^2}{k} + 2 T_0$\n- **Equations i=2..N-1:** $-T_{i-1} + 2 T_i - T_{i+1} = \\frac{\\dot{q}''' (\\Delta x)^2}{k}$\n- **Equation N:** $-T_{N-1} + 3 T_N = \\frac{\\dot{q}''' (\\Delta x)^2}{k} + 2 T_L$\n\nThis system is solved numerically for the discrete temperatures $T_i^{\\text{disc}}$. The error is evaluated against the exact solution at the cell-center coordinates $x_i$ using the discrete $L^2$ norm:\n$$E = \\sqrt{\\sum_{i=1}^N \\left(T_i^{\\text{disc}} - T(x_i)^{\\text{exact}}\\right)^2 \\Delta x}$$\nThe theoretical order of accuracy for this centered-difference scheme is second-order, meaning the error $E$ is proportional to $(\\Delta x)^2$. We verify this by computing the observed order of accuracy, $p$, from solutions on two grids with spacing $h$ and $h/2$:\n$$p = \\log_2\\left(\\frac{E_h}{E_{h/2}}\\right)$$\nFor a second-order scheme, we expect $p \\approx 2$.\n\nFor Case C where $\\dot{q}'''=0$, the exact solution is linear. As algebraic manipulation confirms, the FVM scheme (including boundary treatment) is satisfied exactly by the linear solution, so the numerical solution should match the exact solution to within machine floating-point precision.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem, run test cases, and print the final output.\n    \"\"\"\n\n    def compute_error(L, k, A, q_gen, T0, TL, N):\n        \"\"\"\n        Solves the 1D steady diffusion problem using FVM and returns the L2 error norm.\n        \n        Args:\n            L (float): Length of the rod [m].\n            k (float): Thermal conductivity [W/(m.K)].\n            A (float): Cross-sectional area [m^2].\n            q_gen (float): Volumetric heat generation [W/m^3].\n            T0 (float): Temperature at x=0 [K].\n            TL (float): Temperature at x=L [K].\n            N (int): Number of control volumes.\n        \n        Returns:\n            float: The discrete L2 norm of the error.\n        \"\"\"\n        # 1. Grid setup\n        dx = L / N\n        x_centers = np.linspace(dx / 2, L - dx / 2, N)\n\n        # 2. Assemble the linear system M*T = b (simplified form)\n        M = np.zeros((N, N))\n        b = np.zeros(N)\n\n        # Fill main and off-diagonals\n        np.fill_diagonal(M, 2.0)\n        np.fill_diagonal(M[1:], -1.0)\n        np.fill_diagonal(M[:, 1:], -1.0)\n        \n        # Apply boundary condition modifications\n        M[0, 0] = 3.0\n        M[N - 1, N - 1] = 3.0\n\n        # Assemble the RHS vector b\n        source_term = (q_gen * dx**2) / k\n        b.fill(source_term)\n        b[0] += 2 * T0\n        b[N - 1] += 2 * TL\n\n        # 3. Solve the linear system\n        T_fvm = np.linalg.solve(M, b)\n\n        # 4. Calculate the exact solution at cell centers\n        # T_exact(x) = T0 + (TL - T0)*x/L + (q_gen/(2*k))*(L*x - x**2)\n        term1 = T0\n        term2 = (TL - T0) * x_centers / L\n        term3 = (q_gen / (2 * k)) * (L * x_centers - x_centers**2)\n        T_exact = term1 + term2 + term3\n        \n        # 5. Compute the discrete L2 error norm\n        error_norm = np.sqrt(np.sum((T_fvm - T_exact)**2) * dx)\n        \n        return error_norm\n\n    results = []\n\n    # Case A: Symmetric BCs, with generation\n    L_A, k_A, A_A, q_gen_A, T0_A, TL_A = 0.2, 15.0, 1.0e-3, 2.0e5, 300.0, 300.0\n    N1_A, N2_A = 40, 80\n    error_h_A = compute_error(L_A, k_A, A_A, q_gen_A, T0_A, TL_A, N1_A)\n    error_h2_A = compute_error(L_A, k_A, A_A, q_gen_A, T0_A, TL_A, N2_A)\n    # Avoid division by zero if error is zero\n    if error_h2_A > 0:\n        p_A = np.log2(error_h_A / error_h2_A)\n    else:\n        p_A = np.inf # Or some other indicator of exactness\n    results.append(p_A)\n\n    # Case B: Asymmetric BCs, with generation\n    L_B, k_B, A_B, q_gen_B, T0_B, TL_B = 0.1, 200.0, 5.0e-4, 1.0e6, 300.0, 350.0\n    N1_B, N2_B = 20, 40\n    error_h_B = compute_error(L_B, k_B, A_B, q_gen_B, T0_B, TL_B, N1_B)\n    error_h2_B = compute_error(L_B, k_B, A_B, q_gen_B, T0_B, TL_B, N2_B)\n    if error_h2_B > 0:\n        p_B = np.log2(error_h_B / error_h2_B)\n    else:\n        p_B = np.inf\n    results.append(p_B)\n\n    # Case C: Zero generation (linear solution)\n    L_C, k_C, A_C, q_gen_C, T0_C, TL_C = 0.3, 50.0, 2.0e-4, 0.0, 300.0, 350.0\n    N1_C, N2_C = 10, 20\n    error_1_C = compute_error(L_C, k_C, A_C, q_gen_C, T0_C, TL_C, N1_C)\n    error_2_C = compute_error(L_C, k_C, A_C, q_gen_C, T0_C, TL_C, N2_C)\n    threshold = 1.0e-11\n    result_C = (error_1_C  threshold) and (error_2_C  threshold)\n    results.append(result_C)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Real-world engineering problems often involve properties and sources that are not uniform. This exercise challenges you to move beyond simplified assumptions by deriving the exact source term contribution, $S_U$, for a control volume where both the cross-sectional area and the volumetric heat generation vary linearly. This practice reinforces the fundamental principle that source terms in the FVM are integrated over the control volume and demonstrates how to handle such variations analytically for higher-order accuracy. ",
            "id": "3956036",
            "problem": "Consider one-dimensional ($1$D) steady heat conduction in a slender body with spatial coordinate $x$ and cross-sectional area that varies within each control volume. Let the volumetric heat generation be spatially varying as $\\dot{q}'''(x)=\\alpha+\\beta x$, where $\\alpha$ and $\\beta$ are real constants. Using the Finite Volume Method (FVM), focus on a single interior control volume indexed by $i$, bounded by the west and east faces located at $x_{i-\\frac{1}{2}}$ and $x_{i+\\frac{1}{2}}$, respectively. Assume the cross-sectional area varies linearly within the control volume between the face values $A_{i-\\frac{1}{2}}$ and $A_{i+\\frac{1}{2}}$. Starting from conservation of energy and without invoking any shortcut formulas, derive the exact control-volume integral for the source contribution $S_{U,i}$ that enters the discretized algebraic energy equation as the constant (temperature-independent) term. Express your final result in closed form in terms of $\\alpha$, $\\beta$, $x_{i-\\frac{1}{2}}$, $x_{i+\\frac{1}{2}}$, $A_{i-\\frac{1}{2}}$, and $A_{i+\\frac{1}{2}}$.\n\nYour final answer must be a single closed-form analytic expression. Do not substitute numerical values and do not attach units; present $S_{U,i}$ symbolically.",
            "solution": "The problem requires the derivation of the exact integral for the source contribution term, $S_{U,i}$, in the discretized energy equation for a single interior control volume using the Finite Volume Method (FVM). The derivation must start from the principle of energy conservation.\n\nThe conservation of energy for a steady-state process within a control volume $V_i$ dictates that the rate of heat generation within the volume must be equal to the net rate of heat flux leaving through its boundary surfaces. The total heat generation rate, which corresponds to the constant part of the source term $S_{U,i}$ in the FVM algebraic equation, is obtained by integrating the volumetric heat generation rate $\\dot{q}'''(x)$ over the control volume $V_i$.\n\nFor a one-dimensional system with a spatially varying cross-sectional area $A(x)$, the differential volume element is $dV = A(x) dx$. The control volume for node $i$ is defined by the interval $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$. The source term is therefore given by the definite integral:\n$$\nS_{U,i} = \\int_{V_i} \\dot{q}'''(x) dV = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\dot{q}'''(x) A(x) dx\n$$\nThe problem specifies the volumetric heat generation as a linear function of position:\n$$\n\\dot{q}'''(x) = \\alpha + \\beta x\n$$\nand the cross-sectional area $A(x)$ as varying linearly within the control volume between its values at the faces. The equation for the line representing $A(x)$ passing through the points $(x_{i-\\frac{1}{2}}, A_{i-\\frac{1}{2}})$ and $(x_{i+\\frac{1}{2}}, A_{i+\\frac{1}{2}})$ is:\n$$\nA(x) = A_{i-\\frac{1}{2}} + \\frac{A_{i+\\frac{1}{2}} - A_{i-\\frac{1}{2}}}{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}} (x - x_{i-\\frac{1}{2}})\n$$\nSubstituting the expressions for $\\dot{q}'''(x)$ and $A(x)$ into the integral for $S_{U,i}$ yields:\n$$\nS_{U,i} = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} (\\alpha + \\beta x) \\left( A_{i-\\frac{1}{2}} + \\frac{A_{i+\\frac{1}{2}} - A_{i-\\frac{1}{2}}}{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}} (x - x_{i-\\frac{1}{2}}) \\right) dx\n$$\nTo evaluate this integral, we can expand the integrand. A more structured approach is to split the integral based on the components of $\\dot{q}'''(x)$:\n$$\nS_{U,i} = \\alpha \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} A(x) dx + \\beta \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} x A(x) dx\n$$\nLet us evaluate each integral separately. For notational convenience, let $x_w = x_{i-\\frac{1}{2}}$, $x_e = x_{i+\\frac{1}{2}}$, $A_w = A_{i-\\frac{1}{2}}$, and $A_e = A_{i+\\frac{1}{2}}$. The length of the control volume is $\\Delta x_i = x_e - x_w$.\n\nThe first integral, $\\int_{x_w}^{x_e} A(x) dx$, represents the volume of the control volume, $V_i$. Since $A(x)$ is linear, the volume is the product of the average cross-sectional area and the length:\n$$\n\\int_{x_w}^{x_e} A(x) dx = V_i = \\frac{A_w + A_e}{2} (x_e - x_w)\n$$\nThe second integral, $\\int_{x_w}^{x_e} x A(x) dx$, requires integrating the product of $x$ and the linear function $A(x)$. The integrand $x A(x)$ is a quadratic polynomial.\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\int_{x_w}^{x_e} x \\left( A_w + \\frac{A_e-A_w}{x_e-x_w}(x-x_w) \\right) dx\n$$\nThe integration of this polynomial expression yields:\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\left( A_w - \\frac{A_e-A_w}{x_e-x_w}x_w \\right) \\frac{x_e^2-x_w^2}{2} + \\left( \\frac{A_e-A_w}{x_e-x_w} \\right) \\frac{x_e^3-x_w^3}{3}\n$$\nUsing the identities $x_e^2-x_w^2 = (x_e-x_w)(x_e+x_w)$ and $x_e^3-x_w^3 = (x_e-x_w)(x_e^2+x_ex_w+x_w^2)$, the expression simplifies to:\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\left( A_w - \\frac{A_e-A_w}{x_e-x_w}x_w \\right) \\frac{(x_e-x_w)(x_e+x_w)}{2} + \\left( \\frac{A_e-A_w}{x_e-x_w} \\right) \\frac{(x_e-x_w)(x_e^2+x_ex_w+x_w^2)}{3}\n$$\nAfter algebraic manipulation and simplification, this integral can be expressed in the symmetric and compact form:\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\frac{x_e-x_w}{6} \\left[ A_w(x_e + 2x_w) + A_e(2x_e + x_w) \\right]\n$$\nNow, we combine the results for both integrals to obtain the final expression for $S_{U,i}$:\n$$\nS_{U,i} = \\alpha \\left( \\frac{A_w + A_e}{2} \\right) (x_e - x_w) + \\beta \\left( \\frac{x_e-x_w}{6} \\left[ A_w(x_e + 2x_w) + A_e(2x_e + x_w) \\right] \\right)\n$$\nTo obtain a single expression, we factor out the common term $\\frac{x_e-x_w}{6}$:\n$$\nS_{U,i} = \\frac{x_e-x_w}{6} \\left[ 3\\alpha(A_w + A_e) + \\beta \\left( A_w(x_e + 2x_w) + A_e(2x_e + x_w) \\right) \\right]\n$$\nWe can group terms by $A_w$ and $A_e$ for a more organized final form:\n$$\nS_{U,i} = \\frac{x_e-x_w}{6} \\left[ A_w(3\\alpha + \\beta(x_e + 2x_w)) + A_e(3\\alpha + \\beta(2x_e + x_w)) \\right]\n$$\nFinally, restoring the original index notation:\n$$\nS_{U,i} = \\frac{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}}{6} \\left[ A_{i-\\frac{1}{2}} \\left(3\\alpha + \\beta(x_{i+\\frac{1}{2}} + 2x_{i-\\frac{1}{2}})\\right) + A_{i+\\frac{1}{2}} \\left(3\\alpha + \\beta(2x_{i+\\frac{1}{2}} + x_{i-\\frac{1}{2}})\\right) \\right]\n$$\nThis is the exact, closed-form expression for the source term contribution $S_{U,i}$, derived from first principles as required.",
            "answer": "$$\n\\boxed{\\frac{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}}{6} \\left[ A_{i-\\frac{1}{2}} \\left(3\\alpha + \\beta(x_{i+\\frac{1}{2}} + 2x_{i-\\frac{1}{2}})\\right) + A_{i+\\frac{1}{2}} \\left(3\\alpha + \\beta(2x_{i+\\frac{1}{2}} + x_{i-\\frac{1}{2}})\\right) \\right]}\n$$"
        },
        {
            "introduction": "A significant challenge in computational modeling is accurately representing the physics at the interface between different materials. This practice explores the crucial choice of how to approximate thermal conductivity at a cell face separating two materials with different $k$ values. By implementing and comparing the results of arithmetic and harmonic averaging against an exact solution, you will gain direct insight into why the harmonic mean is essential for preserving the continuity of heat flux and achieving accurate solutions for composite systems. ",
            "id": "3956020",
            "problem": "Consider one-dimensional, steady-state diffusion of nondimensional temperature $T(x)$ along a line segment $x \\in [0,L]$, with no volumetric sources. The thermal conductivity is piecewise constant:\n$$\nk(x) = \\begin{cases}\nk_1,  0 \\le x \\le a,\\\\\nk_2,  a  x \\le L,\n\\end{cases}\n$$\nwhere $k_1  0$, $k_2  0$, $L  0$, and $a \\in (0,L)$ are given constants. The boundary conditions are Dirichlet at both ends: $T(0) = T_0$ and $T(L) = T_L$. All quantities are nondimensional. \n\nTasks:\n1) Starting from the conservation of energy for a steady, one-dimensional control volume and Fourier’s law of heat conduction, derive the exact, piecewise solution $T(x)$ that satisfies the above boundary conditions and continuity of both temperature and heat flux at $x=a$. Do not assume any particular form a priori; derive $T(x)$ and the constant heat flux from the governing principles.\n\n2) Discretize the domain into $N$ uniform control volumes of width $\\Delta x = L/N$ with cell centers at $x_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$ for $i=0,1,\\dots,N-1$. Construct a linear Finite Volume Method (FVM) system using a standard two-point flux approximation across faces. For internal faces, implement two variants for the face conductivity: \n- the harmonic mean of neighboring cell conductivities, and \n- the arithmetic mean of neighboring cell conductivities.\nImpose Dirichlet boundary conditions at $x=0$ and $x=L$ using consistent boundary-face conductances between the boundary and the adjacent cell.\n\n3) For each test case, compute the discrete solution at cell centers using both the harmonic-mean and arithmetic-mean face conductivities. Compare each discrete solution to the exact solution at the same cell centers using the following nondimensional errors:\n- the normalized discrete $\\ell_2$ error\n$$\nE_2 = \\frac{\\left( \\frac{1}{N}\\sum_{i=0}^{N-1} \\left[T_i^{\\text{num}} - T(x_i)\\right]^2 \\right)^{1/2}}{|T_L - T_0|},\n$$\n- the normalized discrete $\\ell_\\infty$ error\n$$\nE_\\infty = \\frac{\\max_{0 \\le i \\le N-1} \\left| T_i^{\\text{num}} - T(x_i) \\right|}{|T_L - T_0|}.\n$$\n\nYour program must evaluate the following test suite, which probes misaligned and aligned interfaces, uniform conductivity, and high contrast:\n- Case $1$: $L=1$, $a=0.3$, $k_1=1$, $k_2=10$, $T_0=0$, $T_L=1$, $N=40$.\n- Case $2$: $L=1$, $a=0.5$, $k_1=1$, $k_2=10$, $T_0=0$, $T_L=1$, $N=20$.\n- Case $3$: $L=1$, $a=0.6$, $k_1=5$, $k_2=5$, $T_0=0$, $T_L=1$, $N=30$.\n- Case $4$: $L=1$, $a=0.45$, $k_1=1$, $k_2=10^6$, $T_0=0$, $T_L=1$, $N=60$.\n\nFor each case, produce a result list containing four floats in the following order: $[E_2^{\\text{harm}}, E_2^{\\text{arith}}, E_\\infty^{\\text{harm}}, E_\\infty^{\\text{arith}}]$. \n\nFinal output format:\nYour program should produce a single line of output containing the results for all four cases as a comma-separated list of lists enclosed in square brackets. For example, the output must look like:\n$$\n\\left[\\left[E_2^{\\text{harm},(1)}, E_2^{\\text{arith},(1)}, E_\\infty^{\\text{harm},(1)}, E_\\infty^{\\text{arith},(1)}\\right], \\dots, \\left[E_2^{\\text{harm},(4)}, E_2^{\\text{arith},(4)}, E_\\infty^{\\text{harm},(4)}, E_\\infty^{\\text{arith},(4)}\\right]\\right].\n$$\nNo additional text should be printed. All numbers must be finite real values. All quantities are nondimensional; no physical units are required for the output.",
            "solution": "The user has provided a well-posed problem statement for one-dimensional, steady-state heat diffusion, which will be analyzed and solved.\n\n### Step 1: Derivation of the Exact Solution\n\nThe problem considers one-dimensional, steady-state heat diffusion with no internal heat generation. The governing principle is the conservation of energy, which simplifies to the statement that the heat flux, $q(x)$, must be constant throughout the domain. From Fourier's law of heat conduction, the heat flux is given by $q(x) = -k(x) \\frac{dT}{dx}$. Therefore, the governing equation is:\n$$\n\\frac{d}{dx}\\left(-k(x) \\frac{dT}{dx}\\right) = 0\n$$\nIntegrating this equation once with respect to $x$ confirms that the heat flux is constant:\n$$\n-k(x) \\frac{dT}{dx} = q_0\n$$\nwhere $q_0$ is the constant heat flux. This can be rewritten as $\\frac{dT}{dx} = -\\frac{q_0}{k(x)}$. We solve this ordinary differential equation piecewise for the two regions of constant conductivity.\n\nFor the region $0 \\le x \\le a$, where $k(x)=k_1$:\n$$\n\\frac{dT}{dx} = -\\frac{q_0}{k_1} \\implies T_1(x) = -\\frac{q_0}{k_1}x + C_1\n$$\nFor the region $a  x \\le L$, where $k(x)=k_2$:\n$$\n\\frac{dT}{dx} = -\\frac{q_0}{k_2} \\implies T_2(x) = -\\frac{q_0}{k_2}x + C_2\n$$\nThe constants $q_0$, $C_1$, and $C_2$ are determined by the boundary conditions and the interface conditions.\n1.  Boundary condition at $x=0$: $T(0) = T_0$. Applying this to $T_1(x)$:\n    $T_1(0) = C_1 = T_0$. Thus, $T_1(x) = T_0 - \\frac{q_0}{k_1}x$.\n2.  Boundary condition at $x=L$: $T(L) = T_L$. Applying this to $T_2(x)$:\n    $T_L = -\\frac{q_0}{k_2}L + C_2$.\n3.  Interface conditions at $x=a$:\n    a. Continuity of temperature: $T_1(a) = T_2(a)$.\n       $T_0 - \\frac{q_0}{k_1}a = -\\frac{q_0}{k_2}a + C_2$\n    b. Continuity of heat flux: This condition is already satisfied by using a single constant $q_0$ throughout the domain.\n\nWe have a system of two linear equations for $q_0$ and $C_2$. From condition 3a, we express $C_2$:\n$C_2 = T_0 - q_0\\left(\\frac{a}{k_1} - \\frac{a}{k_2}\\right)$.\nSubstitute this into the equation from condition 2:\n$T_L = -\\frac{q_0}{k_2}L + T_0 - q_0\\left(\\frac{a}{k_1} - \\frac{a}{k_2}\\right)$\n$T_L - T_0 = -q_0 \\left( \\frac{L}{k_2} + \\frac{a}{k_1} - \\frac{a}{k_2} \\right) = -q_0 \\left( \\frac{a}{k_1} + \\frac{L-a}{k_2} \\right)$\nThe terms $\\frac{a}{k_1}$ and $\\frac{L-a}{k_2}$ represent the thermal resistances of the two layers, let's call them $R_1$ and $R_2$ respectively. The total resistance is $R_{tot} = R_1 + R_2$. The constant heat flux is then:\n$$\nq_0 = - \\frac{T_L - T_0}{R_1 + R_2} = \\frac{T_0 - T_L}{R_1 + R_2}\n$$\nWith $q_0$ known, we can find the temperature at the interface, $T(a)$:\n$T(a) = T_1(a) = T_0 - \\frac{q_0}{k_1}a = T_0 + \\frac{T_L-T_0}{R_1+R_2} \\frac{a}{k_1} = T_0 + \\frac{T_L-T_0}{R_1+R_2}R_1 = \\frac{T_0(R_1+R_2) + (T_L-T_0)R_1}{R_1+R_2} = \\frac{T_0 R_2 + T_L R_1}{R_1+R_2}$.\nSubstituting the expressions for $R_1$ and $R_2$:\n$$\nT(a) = \\frac{T_0 \\frac{L-a}{k_2} + T_L \\frac{a}{k_1}}{\\frac{L-a}{k_2} + \\frac{a}{k_1}}\n$$\nThe temperature profile within each segment is linear. The final exact solution is:\n$$\nT(x) = \\begin{cases}\nT_0 + \\left(T(a) - T_0\\right)\\frac{x}{a},  0 \\le x \\le a \\\\\nT_L + \\left(T(a) - T_L\\right)\\frac{L-x}{L-a},  a  x \\le L\n\\end{cases}\n$$\n\n### Step 2: Finite Volume Method (FVM) Discretization\n\nThe domain $[0,L]$ is divided into $N$ uniform control volumes (CVs) of width $\\Delta x = L/N$. The $i$-th CV spans $[x_{i-1/2}, x_{i+1/2}]$ with its center (node) at $x_i = (i+1/2)\\Delta x$ for $i=0, \\dots, N-1$. The faces are located at $x_{i+1/2} = (i+1)\\Delta x$.\n\nThe integral form of the energy conservation equation for a CV $i$ is:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}\\left(-k \\frac{dT}{dx}\\right) dx = \\left[-k \\frac{dT}{dx}\\right]_{x_{i-1/2}}^{x_{i+1/2}} = q_{i+1/2} - q_{i-1/2} = 0\n$$\nwhere $q_{i \\pm 1/2}$ are the heat fluxes at the east and west faces of the CV. We use a two-point approximation for the flux at an internal face $i+1/2$ between nodes $i$ and $i+1$:\n$$\nq_{i+1/2} \\approx -k_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta x}\n$$\nwhere $T_i$ is the temperature at node $x_i$ and $k_{i+1/2}$ is the thermal conductivity at the face. The conductivity for the CV centered at $x_i$ is $k_{cv,i} = k(x_i)$.\n\nFor an internal node $i \\in [1, N-2]$, the discretized equation is:\n$$\n-k_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta x} - \\left(-k_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta x}\\right) = 0\n$$\n$$\n\\left(\\frac{k_{i-1/2}}{\\Delta x} + \\frac{k_{i+1/2}}{\\Delta x}\\right)T_i - \\frac{k_{i-1/2}}{\\Delta x} T_{i-1} - \\frac{k_{i+1/2}}{\\Delta x} T_{i+1} = 0\n$$\nThis gives a tridiagonal system of linear equations $A\\mathbf{T}=\\mathbf{b}$ for the vector of nodal temperatures $\\mathbf{T} = [T_0, \\dots, T_{N-1}]^T$.\n\nThe face conductivity $k_{i+1/2}$ is computed using two methods:\n1.  **Arithmetic Mean**: $k_{i+1/2}^{\\text{arith}} = \\frac{k_{cv,i} + k_{cv,i+1}}{2}$\n2.  **Harmonic Mean**: $k_{i+1/2}^{\\text{harm}} = \\frac{2 k_{cv,i} k_{cv,i+1}}{k_{cv,i} + k_{cv,i+1}}$\n\nFor the boundary CVs, we incorporate the Dirichlet conditions.\nFor CV $0$ (at $x=0$), the equation is $q_{1/2} - q_w = 0$, where $q_w$ is the flux at the west boundary face. We model $q_w$ as:\n$q_w = -k_{w} \\frac{T_0 - T(0)}{\\Delta x/2}$, where $T(0)=T_0^{\\text{given}}$ and the face conductivity $k_w$ is taken as $k_{cv,0}$.\n$$\n-k_{1/2} \\frac{T_1 - T_0}{\\Delta x} + k_{cv,0}\\frac{T_0 - T_0^{\\text{given}}}{\\Delta x/2} = 0\n$$\nRearranging gives the equation for $T_0$:\n$$\n\\left(\\frac{k_{1/2}}{\\Delta x} + \\frac{2k_{cv,0}}{\\Delta x}\\right)T_0 - \\frac{k_{1/2}}{\\Delta x}T_1 = \\frac{2k_{cv,0}}{\\Delta x}T_0^{\\text{given}}\n$$\n\nFor CV $N-1$ (at $x=L$), the equation is $q_e - q_{N-1/2} = 0$, where $q_e$ is the flux at the east boundary face.\n$q_e = -k_{e} \\frac{T_L^{\\text{given}} - T_{N-1}}{\\Delta x/2}$, with $k_e = k_{cv,N-1}$.\n$$\n-k_{cv,N-1}\\frac{T_L^{\\text{given}} - T_{N-1}}{\\Delta x/2} + k_{N-1/2}\\frac{T_{N-1} - T_{N-2}}{\\Delta x} = 0\n$$\nRearranging gives the equation for $T_{N-1}$:\n$$\n\\left(\\frac{k_{N-1/2}}{\\Delta x} + \\frac{2k_{cv,N-1}}{\\Delta x}\\right)T_{N-1} - \\frac{k_{N-1/2}}{\\Delta x}T_{N-2} = \\frac{2k_{cv,N-1}}{\\Delta x}T_L^{\\text{given}}\n$$\nThese equations define the first and last rows of the system $A\\mathbf{T}=\\mathbf{b}$, which is then solved for $\\mathbf{T}$.\n\n### Step 3: Error Calculation\n\nThe numerical solution $\\mathbf{T}^{\\text{num}}$ is compared to the exact solution $T(x_i)$ at the cell centers using two normalized error metrics:\n-   The normalized discrete $\\ell_2$ error: $E_2 = \\frac{\\left( \\frac{1}{N}\\sum_{i=0}^{N-1} \\left[T_i^{\\text{num}} - T(x_i)\\right]^2 \\right)^{1/2}}{|T_L - T_0|}$\n-   The normalized discrete $\\ell_\\infty$ error: $E_\\infty = \\frac{\\max_{0 \\le i \\le N-1} \\left| T_i^{\\text{num}} - T(x_i) \\right|}{|T_L - T_0|}$\n\nWhen the material interface at $x=a$ is aligned with a CV face, the thermal resistance between the two adjacent cell centers is exactly captured by the harmonic mean of their conductivities. Consequently, the FVM with harmonic mean averaging is expected to yield the exact solution at the cell centers, resulting in errors close to machine precision. The arithmetic mean does not have this property and will exhibit a discretization error. For a uniform conductivity medium, both harmonic and arithmetic means are identical, and the FVM scheme is exact for a linear profile.",
            "answer": "```python\nimport numpy as np\n\ndef _get_exact_solution(x_coords, L, a, k1, k2, T0, TL):\n    \"\"\"\n    Computes the exact analytical solution at given coordinates.\n    \"\"\"\n    # Thermal resistances\n    # Handle k1 or k2 being extremely large, a or L-a being zero.\n    R1 = a / k1 if k1 > 0 and a > 0 else 0\n    R2 = (L - a) / k2 if k2 > 0 and L-a > 0 else 0\n\n    if R1 + R2 == 0:\n        # This case happens if the domain has infinite conductivity everywhere,\n        # or if T0==TL. Solution is constant/indeterminate.\n        # But problem constraints ensure R1+R2 > 0.\n        # However, for robustness: if both T0 and TL are the same, temp is uniform.\n        if T0 == TL:\n             return np.full_like(x_coords, T0)\n        # Undefined otherwise, a should be in (0,L) and k>0\n        # For simplicity, for perfect conductor, treat as linear profile.\n        T_a = T0 + (TL-T0) * (a/L)\n    else:\n        # Interface temperature (voltage divider analogy)\n        T_a = (T0 * R2 + TL * R1) / (R1 + R2)\n\n    # Piecewise linear solution\n    T_exact = np.piecewise(\n        x_coords,\n        [x_coords = a, x_coords > a],\n        [\n            lambda x: T0 + (T_a - T0) * x / a if a > 0 else T_a,\n            lambda x: TL + (T_a - TL) * (L - x) / (L - a) if (L - a) > 0 else T_a,\n        ]\n    )\n    return T_exact\n\ndef _solve_fvm(N, L, a, k1, k2, T0, TL, method):\n    \"\"\"\n    Builds and solves the FVM linear system.\n    \"\"\"\n    dx = L / N\n    x_centers = (np.arange(N) + 0.5) * dx\n\n    # Cell-center conductivities\n    k_cv = np.where(x_centers = a, k1, k2)\n\n    # Face conductivities for internal faces (i=0 to N-2)\n    k_face = np.zeros(N - 1)\n    if method == 'harmonic':\n        # Harmonic mean: 2*k_i*k_{i+1} / (k_i + k_{i+1})\n        k_face = 2 * k_cv[:-1] * k_cv[1:] / (k_cv[:-1] + k_cv[1:])\n    elif method == 'arithmetic':\n        # Arithmetic mean: (k_i + k_{i+1}) / 2\n        k_face = 0.5 * (k_cv[:-1] + k_cv[1:])\n    else:\n        raise ValueError(\"Method must be 'harmonic' or 'arithmetic'\")\n    \n    # Assemble the linear system A*T = b\n    A = np.zeros((N, N))\n    b = np.zeros(N)\n\n    # Left boundary (i=0)\n    A[0, 0] = k_face[0] / dx + 2 * k_cv[0] / dx\n    A[0, 1] = -k_face[0] / dx\n    b[0] = 2 * k_cv[0] / dx * T0\n\n    # Internal nodes (i=1 to N-2)\n    for i in range(1, N - 1):\n        A[i, i - 1] = -k_face[i - 1] / dx\n        A[i, i] = k_face[i - 1] / dx + k_face[i] / dx\n        A[i, i + 1] = -k_face[i] / dx\n\n    # Right boundary (i=N-1)\n    A[N - 1, N - 2] = -k_face[N - 2] / dx\n    A[N - 1, N - 1] = k_face[N - 2] / dx + 2 * k_cv[N - 1] / dx\n    b[N - 1] = 2 * k_cv[N - 1] / dx * TL\n    \n    # Solve for temperature vector T\n    T_num = np.linalg.solve(A, b)\n    return T_num\n\ndef _process_case(L, a, k1, k2, T0, TL, N):\n    \"\"\"\n    Handles all calculations for a single test case.\n    \"\"\"\n    dx = L / N\n    x_centers = (np.arange(N) + 0.5) * dx\n\n    # Get exact solution at cell centers\n    T_exact = _get_exact_solution(x_centers, L, a, k1, k2, T0, TL)\n\n    # Get numerical solutions\n    T_harm = _solve_fvm(N, L, a, k1, k2, T0, TL, 'harmonic')\n    T_arith = _solve_fvm(N, L, a, k1, k2, T0, TL, 'arithmetic')\n\n    # Calculate errors\n    norm_factor = abs(TL - T0)\n    if norm_factor == 0:\n        # If T0==TL, exact solution is T0 everywhere. Use absolute error instead.\n        norm_factor = 1.0 \n\n    # Harmonic mean errors\n    err_harm = T_harm - T_exact\n    E2_harm = np.sqrt(np.mean(err_harm**2)) / norm_factor\n    Einf_harm = np.max(np.abs(err_harm)) / norm_factor\n\n    # Arithmetic mean errors\n    err_arith = T_arith - T_exact\n    E2_arith = np.sqrt(np.mean(err_arith**2)) / norm_factor\n    Einf_arith = np.max(np.abs(err_arith)) / norm_factor\n\n    return [E2_harm, E2_arith, Einf_harm, Einf_arith]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'L': 1, 'a': 0.3, 'k1': 1, 'k2': 10, 'T0': 0, 'TL': 1, 'N': 40},\n        {'L': 1, 'a': 0.5, 'k1': 1, 'k2': 10, 'T0': 0, 'TL': 1, 'N': 20},\n        {'L': 1, 'a': 0.6, 'k1': 5, 'k2': 5, 'T0': 0, 'TL': 1, 'N': 30},\n        {'L': 1, 'a': 0.45, 'k1': 1, 'k2': 10**6, 'T0': 0, 'TL': 1, 'N': 60},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _process_case(**case)\n        results.append(result)\n    \n    # Final print statement in the exact required format.\n    # Convert list of lists to string and remove spaces for compactness.\n    final_output = str(results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}