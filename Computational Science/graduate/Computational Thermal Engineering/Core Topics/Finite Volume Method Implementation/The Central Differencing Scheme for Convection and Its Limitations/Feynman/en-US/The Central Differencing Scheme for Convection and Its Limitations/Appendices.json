{
    "hands_on_practices": [
        {
            "introduction": "Theory can tell us a scheme's order of accuracy, but a well-chosen example can reveal its character. This first practice provides a stark and memorable demonstration of the fundamental flaw in using central differencing for convection-dominated problems. By performing a single time step for a pure advection scenario, you will see how a scheme can generate physically impossible results, violating the basic principle that a transported quantity cannot fall below its initial minimum or exceed its maximum in the absence of sources or sinks. This exercise highlights the critical concept of numerical monotonicity and its importance in producing physically realistic simulations .",
            "id": "3989802",
            "problem": "Consider the one-dimensional linear advection equation for a transported scalar field $\\,\\phi(x,t)\\,$,\n$$\\frac{\\partial \\phi}{\\partial t} + u \\,\\frac{\\partial \\phi}{\\partial x} = 0,$$\non the spatial domain $\\,x \\in [0,L]\\,$ with constant advection speed $\\,u>0\\,$. The boundary conditions are fixed and strictly positive for all times,\n$$\\phi(0,t) = 1, \\qquad \\phi(L,t) = 1.$$\nLet $\\,L = 4\\,\\Delta x\\,$ and define a uniform grid of cell centers at $\\,x_j = j\\,\\Delta x\\,$ for $\\,j = 0,1,2,3,4\\,$. The interior nodes are $\\,j=1,2,3\\,$. At time $\\,t=0\\,$, suppose the interior values are strictly positive but nonuniform:\n$$\\phi_1^0 = 0.05, \\qquad \\phi_2^0 = 0.413, \\qquad \\phi_3^0 = 1.2,$$\nwhile the boundary nodes satisfy $\\,\\phi_0^n = \\phi_4^n = 1\\,$ for all time levels $\\,n \\ge 0\\,$. Let $\\,u = 1\\,\\mathrm{m/s}\\,$, $\\,\\Delta x = 1\\,\\mathrm{m}\\,$, and $\\,\\Delta t = 0.9\\,\\mathrm{s}\\,$.\n\nStarting from the governing equation and using only standard, second-order central differencing in space for $\\,\\partial \\phi/\\partial x\\,$ and forward Euler in time for $\\,\\partial \\phi/\\partial t\\,$, derive the semi-discrete update at interior nodes and carry out a single time step to compute the value of $\\,\\phi_2^1\\,$. Your derivation must begin from the partial differential equation and the stated discretization choices; do not invoke any monotonicity or positivity-preserving results. Explain briefly why the computed result demonstrates a violation of a discrete comparison principle (maximum principle) for this central differencing convection discretization, despite strictly positive boundary and initial interior values.\n\nRound your final numerical answer for $\\,\\phi_2^1\\,$ to five significant figures. Express the final value as a dimensionless number.",
            "solution": "The problem is valid as it presents a well-posed question in computational fluid dynamics, grounded in established mathematical and physical principles, with a complete and consistent set of data.\n\nThe governing equation is the one-dimensional linear advection equation:\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} = 0\n$$\nWe are tasked with discretizing this equation using the forward Euler method in time and a second-order central differencing scheme in space.\n\nThe time derivative at a grid node $j$ is approximated using the forward Euler scheme:\n$$\n\\frac{\\partial \\phi}{\\partial t} \\bigg|_{j}^n \\approx \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t}\n$$\nwhere the superscript $n$ denotes the time level $t = n \\Delta t$, and the subscript $j$ denotes the spatial location $x = x_j$.\n\nThe spatial derivative is approximated using a second-order central differencing scheme:\n$$\n\\frac{\\partial \\phi}{\\partial x} \\bigg|_{j}^n \\approx \\frac{\\phi_{j+1}^n - \\phi_{j-1}^n}{2 \\Delta x}\n$$\nSubstituting these approximations into the governing equation, we obtain the fully discrete representation:\n$$\n\\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} + u \\left( \\frac{\\phi_{j+1}^n - \\phi_{j-1}^n}{2 \\Delta x} \\right) = 0\n$$\nTo derive the update rule for the value of $\\phi$ at the next time step, $\\phi_j^{n+1}$, we rearrange the equation:\n$$\n\\phi_j^{n+1} = \\phi_j^n - u \\frac{\\Delta t}{2 \\Delta x} (\\phi_{j+1}^n - \\phi_{j-1}^n)\n$$\nWe define the dimensionless Courant number, $C$, as:\n$$\nC = \\frac{u \\Delta t}{\\Delta x}\n$$\nUsing the given parameters, $u = 1\\,\\mathrm{m/s}$, $\\Delta t = 0.9\\,\\mathrm{s}$, and $\\Delta x = 1\\,\\mathrm{m}$, the Courant number is:\n$$\nC = \\frac{(1\\,\\mathrm{m/s})(0.9\\,\\mathrm{s})}{1\\,\\mathrm{m}} = 0.9\n$$\nThe update equation can now be written in terms of the Courant number:\n$$\n\\phi_j^{n+1} = \\phi_j^n - \\frac{C}{2} (\\phi_{j+1}^n - \\phi_{j-1}^n)\n$$\nThis equation is valid for the interior nodes, which are $j=1, 2, 3$. We are asked to compute the value of $\\phi_2^1$, which corresponds to the node $j=2$ at the time level $n+1=1$. Setting $j=2$ and $n=0$ in the update equation gives:\n$$\n\\phi_2^1 = \\phi_2^0 - \\frac{C}{2} (\\phi_3^0 - \\phi_1^0)\n$$\nWe are given the initial values at time $t=0$ (i.e., $n=0$): $\\phi_1^0 = 0.05$, $\\phi_2^0 = 0.413$, and $\\phi_3^0 = 1.2$. Substituting these values along with $C=0.9$ into the equation for $\\phi_2^1$:\n$$\n\\phi_2^1 = 0.413 - \\frac{0.9}{2} (1.2 - 0.05)\n$$\n$$\n\\phi_2^1 = 0.413 - 0.45 (1.15)\n$$\n$$\n\\phi_2^1 = 0.413 - 0.5175\n$$\n$$\n\\phi_2^1 = -0.1045\n$$\nRounding this to five significant figures gives $\\phi_2^1 = -0.10450$.\n\nThis result demonstrates a violation of the discrete comparison principle (or maximum/minimum principle). The physical advection equation, without sources or sinks, cannot create new extrema. The value of the scalar field $\\phi$ at any point and time must be bounded by the minimum and maximum values present in the initial data and at the boundaries. At time $t=0$, the set of all specified values is $\\{\\phi_0^0, \\phi_1^0, \\phi_2^0, \\phi_3^0, \\phi_4^0\\} = \\{1, 0.05, 0.413, 1.2, 1\\}$. The minimum value in the entire domain at $t=0$ is therefore $\\phi_{\\min}^0 = 0.05$. The maximum is $\\phi_{\\max}^0 = 1.2$. All initial and boundary values are strictly positive. However, our computation yields $\\phi_2^1 = -0.10450$, which is less than the initial minimum of $0.05$. The numerical scheme has created a new, unphysical minimum.\n\nThe mathematical reason for this violation lies in the structure of the discrete update equation. If we rewrite the equation for $\\phi_j^{n+1}$ as a linear combination of the values at the previous time step:\n$$\n\\phi_j^{n+1} = \\left(\\frac{C}{2}\\right) \\phi_{j-1}^n + (1) \\phi_j^n + \\left(-\\frac{C}{2}\\right) \\phi_{j+1}^n\n$$\nFor a discrete comparison principle to hold, the solution $\\phi_j^{n+1}$ must be a convex combination of its neighboring values from the previous time step, which requires all coefficients in the linear combination to be non-negative. In this case, the coefficient of $\\phi_{j+1}^n$ is $-\\frac{C}{2}$. Since $C=0.9>0$, this coefficient is negative ($-0.45$). This negative coefficient allows a large value at $\\phi_{j+1}^n$ to subtract from the other terms, potentially driving the result $\\phi_j^{n+1}$ to a value outside the bounds of the data at time $n$. The specified initial condition, with a sharp increase from $\\phi_1^0 = 0.05$ to $\\phi_3^0 = 1.2$, was chosen specifically to highlight this unconditional instability of the central differencing scheme for pure advection, which leads to non-physical oscillations and violation of positivity.",
            "answer": "$$\n\\boxed{-0.10450}\n$$"
        },
        {
            "introduction": "Moving from a single counterexample to a systematic investigation, this practice challenges you to implement the central differencing scheme for a steady convection-diffusion problem and quantify its accuracy. By comparing your numerical results against a derived analytical solution, you will explore the relationship between numerical error, grid spacing $\\Delta x$, and the crucial dimensionless parameter—the Peclet number $Pe$. This comprehensive coding exercise will provide a clear, quantitative understanding of how the scheme's performance degrades as convection begins to dominate diffusion, a core concept in computational fluid dynamics .",
            "id": "3989805",
            "problem": "Consider a one-dimensional slab of length $L$ with steady, one-dimensional heat transfer under combined convection and diffusion and uniform internal volumetric heat generation. The governing energy balance for the steady state, under constant properties and uniform velocity, is the ordinary differential equation\n$$\nk \\frac{d^2 T}{dx^2} - \\rho c_p u \\frac{d T}{dx} + \\dot{q} = 0,\n$$\non the domain $x \\in [0,L]$, subject to Dirichlet boundary conditions $T(0) = T_0$ and $T(L) = T_L$, where $T$ is temperature, $k$ is thermal conductivity, $\\rho$ is density, $c_p$ is specific heat at constant pressure, $u$ is the uniform velocity, and $\\dot{q}$ is the uniform volumetric heat generation rate. Define the thermal diffusivity $\\alpha = k / (\\rho c_p)$. Let the local thermal Peclet number (defined per grid spacing) be $\\mathrm{Pe}_T = u \\Delta x / \\alpha$, where $\\Delta x$ is the uniform grid spacing arising from a uniform grid of $N$ equal cells on $[0,L]$, so that $\\Delta x = L / N$. All quantities must be treated in International System of Units (SI), with $L$ in meters, $u$ in meters per second, $k$ in watts per meter-kelvin, $\\rho$ in kilograms per cubic meter, $c_p$ in joules per kilogram-kelvin, $\\dot{q}$ in watts per cubic meter, and $T$ in kelvin.\n\nStarting only from this energy balance and the stated boundary conditions, you must:\n\n- Derive the discrete interior-node equation using the central differencing scheme for both the convective term and the diffusive term on a uniform grid, and enforce the Dirichlet boundary conditions consistently to construct and solve the resulting linear algebraic system for the nodal temperatures. The grid is node-based with $N+1$ nodes including boundaries, and the unknowns are the $N-1$ interior nodal temperatures.\n- Derive the analytical (continuous) solution $T(x)$ of the differential equation and evaluate it at the grid nodes to obtain a reference solution at the same nodal locations.\n- Compute, for each specified test case, the maximum absolute nodal temperature error, defined as $\\max_{i} |T_i^{\\text{num}} - T_i^{\\text{exact}}|$, expressed in kelvin, and the discrete $L_2$ relative error, defined as\n$$\n\\left( \\frac{\\sum_{i=0}^{N} \\left(T_i^{\\text{num}} - T_i^{\\text{exact}}\\right)^2}{\\sum_{i=0}^{N} \\left(T_i^{\\text{exact}}\\right)^2} \\right)^{1/2},\n$$\nwhich is dimensionless. Here $T_i^{\\text{num}}$ denotes the numerical solution at node $i$ and $T_i^{\\text{exact}}$ denotes the exact solution at node $i$ as obtained from the analytical solution. You must treat the limits and scaling correctly so that the program is numerically stable for the provided test cases.\n\nUse the material and boundary parameters:\n- $L = 1$ $\\mathrm{m}$,\n- $k = 10$ $\\mathrm{W/(m \\cdot K)}$,\n- $\\rho = 1000$ $\\mathrm{kg/m^3}$,\n- $c_p = 1000$ $\\mathrm{J/(kg \\cdot K)}$,\n- $\\dot{q} = 10^4$ $\\mathrm{W/m^3}$,\n- $T_0 = 400$ $\\mathrm{K}$,\n- $T_L = 300$ $\\mathrm{K}$.\n\nThe velocity $u$ is not given directly. For each test case, compute $u$ from the specified local thermal Peclet number $\\mathrm{Pe}_T$ and the grid spacing $\\Delta x$ using $u = \\mathrm{Pe}_T \\, \\alpha / \\Delta x$, where $\\alpha = k / (\\rho c_p)$.\n\nYour program must implement the central differencing scheme for the convection and diffusion terms and compute the numerical solution and the analytical solution at the same nodes. Then compute and report the errors. The final output must emphasize the limitations of the central differencing scheme for convection by revealing how the error behaves as a function of $\\mathrm{Pe}_T$ and grid size $N$.\n\nTest Suite:\nProvide results for the following five parameter sets, chosen to exercise different regimes including diffusion-dominated, near the central differencing limit, convection-dominated, coarse-grid effects, and fine-grid effects:\n- Case $1$: $N = 50$, $\\mathrm{Pe}_T = 1$.\n- Case $2$: $N = 50$, $\\mathrm{Pe}_T = 2$.\n- Case $3$: $N = 10$, $\\mathrm{Pe}_T = 5$.\n- Case $4$: $N = 5$, $\\mathrm{Pe}_T = 1$.\n- Case $5$: $N = 200$, $\\mathrm{Pe}_T = 0.2$.\n\nAnswer Specification and Units:\n- For each case, compute and return the pair $[E_{\\max}, E_{L_2}]$ where $E_{\\max}$ is the maximum absolute error in $\\mathrm{K}$ and $E_{L_2}$ is the discrete $L_2$ relative error (dimensionless).\n- Your program should produce a single line of output containing the results as a comma-separated list of these pairs enclosed in square brackets, in the exact format\n$$\n\\left[ [E_{\\max}^{(1)}, E_{L_2}^{(1)}], [E_{\\max}^{(2)}, E_{L_2}^{(2)}], [E_{\\max}^{(3)}, E_{L_2}^{(3)}], [E_{\\max}^{(4)}, E_{L_2}^{(4)}], [E_{\\max}^{(5)}, E_{L_2}^{(5)}] \\right],\n$$\nwith all numeric values written in decimal form.\n\nScientific realism must be maintained. You must implement the full derivations in code without using shortcut formulas that bypass the above derivation pathway. Explicitly use the central differencing scheme for the convection and diffusion terms, and the analytical solution must be derived from the given differential equation. All angles, if any were present, must be in radians, but angles are not used in this problem. No percentages should appear in the output; all ratios must be decimals.",
            "solution": "This solution section outlines the derivation of the analytical and numerical solutions required to solve the problem.\n\n### 1. Analytical Solution Derivation\nThe governing differential equation is a second-order linear non-homogeneous ordinary differential equation:\n$$ k \\frac{d^2 T}{dx^2} - \\rho c_p u \\frac{d T}{dx} + \\dot{q} = 0 $$\nLet's define the thermal diffusivity $\\alpha = k / (\\rho c_p)$ and a parameter $P = u/\\alpha$. Dividing the equation by $k$ gives:\n$$ \\frac{d^2 T}{dx^2} - P \\frac{d T}{dx} = -\\frac{\\dot{q}}{k} $$\nThe general solution is the sum of a homogeneous solution, $T_h(x)$, and a particular solution, $T_p(x)$.\n\nThe homogeneous equation is $T_h'' - P T_h' = 0$. Its characteristic equation is $r^2 - Pr = 0$, which has roots $r_1=0$ and $r_2=P$. The homogeneous solution is:\n$$ T_h(x) = C_1 e^{0 \\cdot x} + C_2 e^{Px} = C_1 + C_2 e^{Px} $$\nFor the particular solution, we assume a form $T_p(x) = Ax$. Substituting this into the ODE yields $0 - P(A) = -\\dot{q}/k$, which gives $A = \\dot{q}/(kP)$. Thus, the particular solution is:\n$$ T_p(x) = \\frac{\\dot{q}}{kP}x $$\nThe general solution is the sum of the homogeneous and particular solutions:\n$$ T(x) = C_1 + C_2 e^{Px} + \\frac{\\dot{q}}{kP}x $$\nWe apply the Dirichlet boundary conditions $T(0) = T_0$ and $T(L) = T_L$ to determine the integration constants $C_1$ and $C_2$.\nAt $x=0$:\n$$ T(0) = T_0 = C_1 + C_2 e^0 + 0 \\implies C_1 = T_0 - C_2 $$\nAt $x=L$:\n$$ T(L) = T_L = C_1 + C_2 e^{PL} + \\frac{\\dot{q}L}{kP} $$\nSubstituting the expression for $C_1$:\n$$ T_L = (T_0 - C_2) + C_2 e^{PL} + \\frac{\\dot{q}L}{kP} $$\n$$ T_L - T_0 - \\frac{\\dot{q}L}{kP} = C_2(e^{PL} - 1) $$\nSolving for $C_2$:\n$$ C_2 = \\frac{T_L - T_0 - \\frac{\\dot{q}L}{kP}}{e^{PL} - 1} $$\nWith both $C_1$ and $C_2$ determined, the exact analytical solution $T(x)$ is fully specified.\n\n### 2. Numerical Scheme Derivation\nWe discretize the domain using $N+1$ nodes, $x_i = i\\Delta x$ for $i=0, \\dots, N$. We approximate the derivatives at an interior node $i$ using second-order central differences:\n$$ \\frac{d^2 T}{dx^2} \\bigg|_i \\approx \\frac{T_{i+1} - 2T_i + T_{i-1}}{\\Delta x^2} $$\n$$ \\frac{dT}{dx} \\bigg|_i \\approx \\frac{T_{i+1} - T_{i-1}}{2\\Delta x} $$\nSubstituting these into the governing ODE:\n$$ k \\left( \\frac{T_{i+1} - 2T_i + T_{i-1}}{\\Delta x^2} \\right) - \\rho c_p u \\left( \\frac{T_{i+1} - T_{i-1}}{2\\Delta x} \\right) + \\dot{q} = 0 $$\nMultiplying by $\\Delta x^2/k$ gives:\n$$ (T_{i+1} - 2T_i + T_{i-1}) - \\frac{\\rho c_p u \\Delta x}{k} \\left( \\frac{T_{i+1} - T_{i-1}}{2} \\right) + \\frac{\\dot{q}\\Delta x^2}{k} = 0 $$\nRecognizing the grid Peclet number $\\mathrm{Pe}_T = \\frac{u \\Delta x}{\\alpha} = \\frac{\\rho c_p u \\Delta x}{k}$:\n$$ (T_{i+1} - 2T_i + T_{i-1}) - \\frac{\\mathrm{Pe}_T}{2} (T_{i+1} - T_{i-1}) + \\frac{\\dot{q}\\Delta x^2}{k} = 0 $$\nGrouping terms by nodal index ($i-1, i, i+1$) to form the linear equation for node $i$:\n$$ \\left(1 + \\frac{\\mathrm{Pe}_T}{2}\\right) T_{i-1} - 2T_i + \\left(1 - \\frac{\\mathrm{Pe}_T}{2}\\right) T_{i+1} = -\\frac{\\dot{q}\\Delta x^2}{k} $$\n\n### 3. Linear System Formulation\nFor the $N-1$ interior nodes, we have a system of $N-1$ linear equations, which can be written in matrix form $A \\mathbf{T} = \\mathbf{b}$. The matrix $A$ is tridiagonal:\n- Lower diagonal: $a_{i, i-1} = 1 + \\mathrm{Pe}_T/2$\n- Main diagonal: $a_{i, i} = -2$\n- Upper diagonal: $a_{i, i+1} = 1 - \\mathrm{Pe}_T/2$\n\nThe right-hand side vector $\\mathbf{b}$ includes the source term and the known boundary values $T_0$ and $T_L$. For a general interior row $i$:\n$$ \\left(1 + \\frac{\\mathrm{Pe}_T}{2}\\right) T_{i-1} - 2T_i + \\left(1 - \\frac{\\mathrm{Pe}_T}{2}\\right) T_{i+1} = -\\frac{\\dot{q}\\Delta x^2}{k} $$\nFor the first interior node ($i=1$), $T_{i-1}=T_0$ is known and moved to the RHS:\n$$ -2T_1 + \\left(1 - \\frac{\\mathrm{Pe}_T}{2}\\right) T_2 = -\\frac{\\dot{q}\\Delta x^2}{k} - \\left(1 + \\frac{\\mathrm{Pe}_T}{2}\\right) T_0 $$\nFor the last interior node ($i=N-1$), $T_{i+1}=T_N=T_L$ is known and moved to the RHS:\n$$ \\left(1 + \\frac{\\mathrm{Pe}_T}{2}\\right) T_{N-2} - 2T_{N-1} = -\\frac{\\dot{q}\\Delta x^2}{k} - \\left(1 - \\frac{\\mathrm{Pe}_T}{2}\\right) T_L $$\nSolving this tridiagonal system yields the numerical solution $T_i^{\\text{num}}$ for $i=1, \\dots, N-1$. The full numerical solution vector is then constructed by including the boundary values $T_0$ and $T_L$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady convection-diffusion problem with heat generation\n    for a suite of test cases, comparing numerical and analytical solutions.\n    \"\"\"\n    # Material and boundary parameters\n    L = 1.0  # m\n    k = 10.0  # W/(m.K)\n    rho = 1000.0  # kg/m^3\n    cp = 1000.0  # J/(kg.K)\n    q_dot = 1e4  # W/m^3\n    T0 = 400.0  # K\n    TL = 300.0  # K\n\n    # Thermal diffusivity\n    alpha = k / (rho * cp)\n\n    test_cases = [\n        (50, 1.0),   # Case 1: N=50, Pe_T=1\n        (50, 2.0),   # Case 2: N=50, Pe_T=2\n        (10, 5.0),   # Case 3: N=10, Pe_T=5\n        (5, 1.0),    # Case 4: N=5, Pe_T=1\n        (200, 0.2),  # Case 5: N=200, Pe_T=0.2\n    ]\n\n    results = []\n\n    for N, PeT in test_cases:\n        # Calculate derived parameters for the case\n        dx = L / N\n        u = PeT * alpha / dx\n        x_nodes = np.linspace(0, L, N + 1)\n\n        # 1. Analytical Solution\n        # Parameter P = u / alpha\n        P = u / alpha\n        \n        # The case u=0 (P=0) is handled to avoid division by zero, although not\n        # strictly needed for the given test cases where u is always positive.\n        if np.isclose(P, 0):\n            C1 = (TL - T0) / L + q_dot * L / (2 * k)\n            C2 = T0\n            T_exact = -q_dot / (2 * k) * x_nodes**2 + C1 * x_nodes + C2\n        else:\n            # Integration constants C1 and C2 for T(x) = C1 + C2*exp(P*x) + (q_dot/(k*P))*x\n            # Let src_term = q_dot * L / (u * rho * cp) = q_dot * L / (k * P)\n            src_term_L = q_dot * L / (k * P)\n            exp_PL = np.exp(P * L)\n            \n            C2 = (TL - T0 - src_term_L) / (exp_PL - 1)\n            C1 = T0 - C2\n            \n            T_exact = C1 + C2 * np.exp(P * x_nodes) + (q_dot / (k * P)) * x_nodes\n\n        # 2. Numerical Solution using Central Differencing\n        num_interior_nodes = N - 1\n        \n        if num_interior_nodes > 0:\n            # Coefficients from discretization:\n            # (1 + PeT/2)T_{i-1} - 2*T_i + (1 - PeT/2)T_{i+1} = -q_dot*dx^2/k\n            C_W = 1.0 + PeT / 2.0  # West coefficient (for T_{i-1})\n            C_E = 1.0 - PeT / 2.0  # East coefficient (for T_{i+1})\n            C_P = -2.0             # Center coefficient (for T_i)\n    \n            # Assemble the (N-1)x(N-1) matrix A for interior nodes\n            A = np.zeros((num_interior_nodes, num_interior_nodes))\n            \n            # Main diagonal\n            np.fill_diagonal(A, C_P)\n            # Upper diagonal\n            if num_interior_nodes > 1:\n                np.fill_diagonal(A[0:, 1:], C_E)\n            # Lower diagonal\n            if num_interior_nodes > 1:\n                np.fill_diagonal(A[1:, 0:], C_W)\n    \n            # Assemble the right-hand side vector b\n            b = np.full(num_interior_nodes, -q_dot * dx**2 / k)\n            # Apply boundary conditions\n            b[0] -= C_W * T0\n            b[-1] -= C_E * TL\n    \n            # Solve the linear system A * T_interior = b\n            T_interior = np.linalg.solve(A, b)\n            \n            # Construct full numerical solution vector\n            T_num = np.concatenate(([T0], T_interior, [TL]))\n        else: # Handle coarse grids like N=1\n              # For N=1, there are no interior nodes. The solution is just the boundary points.\n            T_num = np.array([T0, TL])\n            \n        # 3. Error Calculation\n        # Ensure T_num and T_exact cover the same nodes (which they do by construction)\n        # Maximum absolute nodal temperature error\n        E_max = np.max(np.abs(T_num - T_exact))\n\n        # Discrete L2 relative error\n        numerator = np.sum((T_num - T_exact)**2)\n        denominator = np.sum(T_exact**2)\n        \n        # Avoid division by zero if exact solution is all zeros (not possible here)\n        if denominator > 0:\n            E_L2 = np.sqrt(numerator / denominator)\n        else:\n            E_L2 = 0.0\n\n        results.append(f\"[{E_max},{E_L2}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having observed the failure of central differencing and quantified its error, we now turn to a theoretical analysis to understand the root cause and derive a solution. This practice guides you through a pen-and-paper derivation of the discrete equation coefficients for both central differencing and the more robust upwind scheme. By imposing a mathematical condition for boundedness—the M-matrix property—you will determine the precise requirement on the cell Peclet number, $|Pe| \\le 2$, for central differencing to be stable, and derive a formula for the blending required to restore stability when this condition is violated. This exercise provides the theoretical foundation for understanding why central differencing fails and how hybrid schemes are constructed to overcome its limitations .",
            "id": "3989762",
            "problem": "Consider steady one-dimensional convection–diffusion of a passive scalar field $\\,\\phi(x)\\,$ in a stationary medium with constant properties on a uniform mesh of spacing $\\,\\Delta x\\,$, cross-sectional area $\\,A\\,$, molecular diffusivity $\\,\\Gamma\\,$, density $\\,\\rho\\,$, and constant velocity $\\,u\\,$. The governing conservation law is\n$$\\frac{d}{dx}\\!\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)-\\rho u\\,\\frac{d\\phi}{dx}=0,$$\nwith no volumetric sources and appropriate boundary conditions such that a unique steady state exists. Let $\\,F:=\\rho u A\\,$ denote the convective mass flux and $\\,D:=\\Gamma A/\\Delta x\\,$ the diffusive conductance. Using the Finite Volume Method (FVM), integrate over a generic control volume centered at node $\\,P\\,$ with west and east neighbors $\\,W\\,$ and $\\,E\\,$, respectively. For the convective flux at faces, consider a linear blending between the Central Differencing Scheme (CDS) and the Upwind Differencing Scheme (UDS): with a blending fraction $\\,w\\in[0,1]\\,$, the discrete stencil coefficients are obtained by taking a convex combination of the CDS and UDS discrete operators. The Peclet number is defined as $\\,\\mathrm{Pe}:=F/D\\,$, and its magnitude is $\\,|\\mathrm{Pe}|=\\rho |u| \\Delta x/\\Gamma\\,$.\n\nStarting from the above conservation law and the definitions of $\\,F\\,$ and $\\,D\\,$, derive the discrete equation at node $\\,P\\,$ and explicitly obtain the neighbor coefficients $\\,a_W\\,$ and $\\,a_E\\,$ for CDS and UDS. Then, form the blended coefficients as a convex combination with fraction $\\,w\\,$. Impose the conditions required for the coefficient matrix to be an $\\,\\mathrm{M}$-matrix in the standard FVM sense (positive diagonal entry, nonnegative neighbor coefficients when the equation is written as $\\,a_P\\phi_P=\\sum a_{nb}\\phi_{nb}\\,$, and weak diagonal dominance per row), which are sufficient to guarantee boundedness (no spurious oscillations) of the discrete solution for this problem.\n\nDetermine, in closed form, the smallest blending fraction $\\,w_{\\min}(\\mathrm{Pe})\\,$ as a function of the cell Peclet number $\\,\\mathrm{Pe}\\,$ that guarantees the $\\,\\mathrm{M}$-matrix property for any flow direction. Express your final result as a single analytic expression. No numerical rounding is required.",
            "solution": "The process begins with the validation of the provided problem statement.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Steady 1-D convection-diffusion equation for a passive scalar $\\phi(x)$: $\\frac{d}{dx}\\!\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)-\\rho u\\,\\frac{d\\phi}{dx}=0$.\n- **Physical Parameters**: Constant density $\\rho$, constant velocity $u$, constant molecular diffusivity $\\Gamma$, and constant cross-sectional area $A$.\n- **Discretization**: Uniform mesh with spacing $\\Delta x$. Finite Volume Method (FVM) on a control volume centered at node $P$ with neighbors $W$ (west) and $E$ (east).\n- **Defined Quantities**:\n    - Convective mass flux: $F := \\rho u A$.\n    - Diffusive conductance: $D := \\Gamma A/\\Delta x$.\n    - Cell Peclet number: $\\mathrm{Pe} := F/D = \\rho u \\Delta x/\\Gamma$.\n- **Numerical Schemes**:\n    - Central Differencing Scheme (CDS).\n    - Upwind Differencing Scheme (UDS).\n    - Blended scheme: A convex combination of CDS and UDS coefficients with a blending fraction $w \\in [0,1]$.\n- **Constraint**: The resulting coefficient matrix must be an $\\mathrm{M}$-matrix, which for this problem requires the off-diagonal (neighbor) coefficients to be non-negative when the discrete equation is written in the form $a_P\\phi_P = \\sum a_{nb}\\phi_{nb}$.\n- **Objective**: Determine the smallest blending fraction, $w_{\\min}(\\mathrm{Pe})$, as a function of the cell Peclet number $\\mathrm{Pe}$, that guarantees the $\\mathrm{M}$-matrix property for any flow direction.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is based on the fundamental 1D steady convection-diffusion equation, a cornerstone of transport phenomena. The Finite Volume Method, CDS, UDS, Peclet number, and M-matrix stability criteria are all standard, well-established concepts in computational fluid dynamics and numerical heat transfer. The problem is scientifically sound.\n- **Well-Posedness and Completeness**: The problem statement is self-contained, providing all necessary equations, definitions, and constraints to derive the requested quantity, $w_{\\min}(\\mathrm{Pe})$. The objective is clearly defined, and a unique solution is expected.\n- **Objectivity**: The problem is stated in precise, objective, and mathematical language, free from any subjective or ambiguous terms.\n- **Consistency**: All definitions are consistent. For instance, $\\mathrm{Pe} = F/D = (\\rho u A)/(\\Gamma A/\\Delta x) = \\rho u \\Delta x / \\Gamma$, which matches the given definition.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, and internally consistent. A solution will be derived.\n\n### Derivation\nWe begin by integrating the governing equation over a control volume (CV) of length $\\Delta x$ and area $A$, centered at node $P$. The faces of the CV are at $x_w$ (west) and $x_e$ (east).\n$$ \\int_{x_w}^{x_e} \\left[ \\frac{d}{dx}\\!\\left(\\Gamma A \\frac{d\\phi}{dx}\\right) - \\frac{d}{dx}(\\rho u A \\phi) \\right] dx = 0 $$\nNote that the convective term $\\rho u \\frac{d\\phi}{dx}$ can be written as $\\frac{d}{dx}(\\rho u \\phi)$ because $\\rho$, $u$, and $A$ are constant. Applying the fundamental theorem of calculus, we get the balance of fluxes at the CV faces:\n$$ \\left[ \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right]_{x_e} - \\left[ \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right]_{x_w} = 0 $$\nThe terms represent the total flux (diffusive + convective) crossing the faces. We discretize these terms. The diffusive fluxes are approximated using central differences:\n$$ \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_{x_e} \\approx \\Gamma A \\frac{\\phi_E - \\phi_P}{\\Delta x} = D(\\phi_E - \\phi_P) $$\n$$ \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_{x_w} \\approx \\Gamma A \\frac{\\phi_P - \\phi_W}{\\Delta x} = D(\\phi_P - \\phi_W) $$\nThe convective fluxes are $(\\rho u A \\phi)_{x_e} = F \\phi_e$ and $(\\rho u A \\phi)_{x_w} = F \\phi_w$, where $\\phi_e$ and $\\phi_w$ are the scalar values at the faces. The integrated equation becomes:\n$$ D(\\phi_E - \\phi_P) - D(\\phi_P - \\phi_W) - (F\\phi_e - F\\phi_w) = 0 $$\n\nNext, we evaluate the face values $\\phi_e$ and $\\phi_w$ using CDS and UDS to find their respective coefficients.\n\n**1. Central Differencing Scheme (CDS)**\nIn CDS, face values are linearly interpolated: $\\phi_e = \\frac{1}{2}(\\phi_P + \\phi_E)$ and $\\phi_w = \\frac{1}{2}(\\phi_W + \\phi_P)$. Substituting these into the flux balance equation:\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - F\\left( \\frac{\\phi_P + \\phi_E}{2} - \\frac{\\phi_W + \\phi_P}{2} \\right) = 0 $$\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - \\frac{F}{2}(\\phi_E - \\phi_W) = 0 $$\nRearranging into the form $a_P\\phi_P = a_W\\phi_W + a_E\\phi_E$:\n$$ (2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E $$\nThe CDS coefficients are:\n$$ a_{W, \\text{CDS}} = D + \\frac{F}{2} \\quad , \\quad a_{E, \\text{CDS}} = D - \\frac{F}{2} $$\n\n**2. Upwind Differencing Scheme (UDS)**\nIn UDS, the face value is taken from the upwind node. This can be expressed compactly using the $\\max$ function. The net convective flux out of the CV is:\n$$ F\\phi_e - F\\phi_w = \\left(\\max(F,0)\\phi_P + \\min(F,0)\\phi_E\\right) - \\left(\\max(F,0)\\phi_W + \\min(F,0)\\phi_P\\right) $$\nUsing $\\min(F,0) = -\\max(-F,0)$, the flux balance equation is:\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - \\left[ (\\max(F,0)-\\min(F,0))\\phi_P - \\max(F,0)\\phi_W - \\min(F,0)\\phi_E \\right] = 0 $$\nNoting that $\\max(F,0)-\\min(F,0) = \\max(F,0)+\\max(-F,0) = |F|$, we get:\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - |F|\\phi_P + \\max(F,0)\\phi_W - \\min(F,0)\\phi_E = 0 $$\nRearranging to the standard form:\n$$ (2D+|F|)\\phi_P = (D+\\max(F,0))\\phi_W + (D-\\min(F,0))\\phi_E $$\n$$ (2D+|F|)\\phi_P = (D+\\max(F,0))\\phi_W + (D+\\max(-F,0))\\phi_E $$\nThe UDS coefficients are:\n$$ a_{W, \\text{UDS}} = D + \\max(F,0) \\quad , \\quad a_{E, \\text{UDS}} = D + \\max(-F,0) $$\n\n**3. Blended Scheme and M-Matrix Condition**\nThe blended coefficients are a convex combination, with blending fraction $w$:\n$$ a_W = (1-w)a_{W, \\text{CDS}} + w a_{W, \\text{UDS}} = (1-w)\\left(D+\\frac{F}{2}\\right) + w\\left(D+\\max(F,0)\\right) $$\n$$ a_E = (1-w)a_{E, \\text{CDS}} + w a_{E, \\text{UDS}} = (1-w)\\left(D-\\frac{F}{2}\\right) + w\\left(D+\\max(-F,0)\\right) $$\nSimplifying these expressions:\n$$ a_W = D + (1-w)\\frac{F}{2} + w\\max(F,0) $$\n$$ a_E = D - (1-w)\\frac{F}{2} + w\\max(-F,0) $$\nThe M-matrix property requires non-negative neighbor coefficients: $a_W \\ge 0$ and $a_E \\ge 0$. We normalize by $D$ and use the Peclet number $\\mathrm{Pe}=F/D$:\n$$ \\frac{a_W}{D} = 1 + (1-w)\\frac{\\mathrm{Pe}}{2} + w\\max(\\mathrm{Pe},0) \\ge 0 $$\n$$ \\frac{a_E}{D} = 1 - (1-w)\\frac{\\mathrm{Pe}}{2} + w\\max(-\\mathrm{Pe},0) \\ge 0 $$\nWe analyze these two inequalities for different signs of $\\mathrm{Pe}$.\n\n- **Case 1: $\\mathrm{Pe} > 0$**\nFor $\\mathrm{Pe} > 0$, $\\max(\\mathrm{Pe},0)=\\mathrm{Pe}$ and $\\max(-\\mathrm{Pe},0)=0$.\nThe inequality for $a_W$ becomes: $1 + (1-w)\\frac{\\mathrm{Pe}}{2} + w\\mathrm{Pe} = 1 + \\frac{\\mathrm{Pe}}{2} + w\\frac{\\mathrm{Pe}}{2} = 1 + \\frac{\\mathrm{Pe}}{2}(1+w)$. Since $\\mathrm{Pe}>0$ and $w \\ge 0$, this is always positive.\nThe inequality for $a_E$ becomes: $1 - (1-w)\\frac{\\mathrm{Pe}}{2} \\ge 0$. This is the constraining condition.\n$$ 1 \\ge (1-w)\\frac{\\mathrm{Pe}}{2} \\implies \\frac{2}{\\mathrm{Pe}} \\ge 1-w \\implies w \\ge 1 - \\frac{2}{\\mathrm{Pe}} $$\n\n- **Case 2: $\\mathrm{Pe} < 0$**\nFor $\\mathrm{Pe} < 0$, $\\max(\\mathrm{Pe},0)=0$ and $\\max(-\\mathrm{Pe},0)=-\\mathrm{Pe}=|\\mathrm{Pe}|$.\nThe inequality for $a_W$ becomes: $1 + (1-w)\\frac{\\mathrm{Pe}}{2} \\ge 0$. This is the constraining condition.\nUsing $|\\mathrm{Pe}|=-\\mathrm{Pe}$: $1 - (1-w)\\frac{|\\mathrm{Pe}|}{2} \\ge 0 \\implies 1 \\ge (1-w)\\frac{|\\mathrm{Pe}|}{2} \\implies w \\ge 1 - \\frac{2}{|\\mathrm{Pe}|}$.\nThe inequality for $a_E$ becomes: $1 - (1-w)\\frac{\\mathrm{Pe}}{2} - w\\mathrm{Pe} = 1 - \\frac{\\mathrm{Pe}}{2} - w\\frac{\\mathrm{Pe}}{2} = 1 - \\frac{\\mathrm{Pe}}{2}(1+w) = 1+\\frac{|\\mathrm{Pe}|}{2}(1+w)$. This is always positive.\n\n**4. Final Expression for $w_{\\min}$**\nIn both cases ($\\mathrm{Pe}>0$ and $\\mathrm{Pe}<0$), the condition is $w \\ge 1 - 2/|\\mathrm{Pe}|$. Since $w$ must also be non-negative, the full condition is $w \\ge \\max(0, 1 - 2/|\\mathrm{Pe}|)$.\nIf $|\\mathrm{Pe}| \\le 2$, then $1-2/|\\mathrm{Pe}| \\le 0$, so the condition is $w \\ge 0$, which is satisfied for any $w \\in [0,1]$. For this range, $w_{\\min}=0$, meaning pure CDS is stable.\nIf $|\\mathrm{Pe}| > 2$, we need $w \\ge 1 - 2/|\\mathrm{Pe}| > 0$.\nThe smallest blending fraction $w_{\\min}$ that guarantees the M-matrix property for any Peclet number $\\mathrm{Pe}$ is the lower bound of this condition.\nTherefore, the single analytic expression for $w_{\\min}$ as a function of $\\mathrm{Pe}$ is:\n$$ w_{\\min}(\\mathrm{Pe}) = \\max\\left(0, 1 - \\frac{2}{|\\mathrm{Pe}|}\\right) $$\nThis expression correctly captures the behavior: for low Peclet numbers ($|\\mathrm{Pe}| \\le 2$), no upwinding is needed ($w_{\\min}=0$), while for high Peclet numbers, an increasing amount of upwinding is required, approaching full upwinding ($w \\to 1$) as $|\\mathrm{Pe}| \\to \\infty$.",
            "answer": "$$\\boxed{\\max\\left(0, 1 - \\frac{2}{|\\mathrm{Pe}|}\\right)}$$"
        }
    ]
}