{
    "hands_on_practices": [
        {
            "introduction": "在上一个练习中，我们观察到中心差分在对流主导的流动中会产生振荡。本实践将深入探究其失效的根本原因：数值色散。通过对纯对流方程应用傅里叶分析 ()，你将推导出该格式的色散关系，并发现不同的傅里叶模态以错误的、依赖于波数的速度传播，这与物理系统中的情况不同。这一实践分析揭示了解决方案相位信息的失真如何直接导致伪振荡的产生。",
            "id": "3989790",
            "problem": "考虑在没有扩散和源项的情况下，通过能量守恒建模的流动流体的一维瞬态加热。温度场 $T(x,t)$ 由线性平流方程 $\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0$ 控制，该方程定义在长度为 $L$ 的周期性空间域上，流速 $u>0$ 为常数。该域被划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀间隔的控制体积。对流项在空间上使用网格上的中心差分格式进行离散化，从而得到一个关于单元中心 $x_j = j\\Delta x$ 处节点温度 $T_j(t)$ 的半离散常微分方程组，索引具有周期性。\n\n仅从平流的能量守恒基本形式以及空间导数的中心差分近似的定义出发，使用离散傅里叶分析推导该半离散系统在周期性边界条件下的离散色散关系。利用该色散关系，求出半离散中心差分算子的每个离散傅里叶模式随时间精确演化的解，并由此根据下面指定的初始条件构建时间 $t=\\Delta t$ 时的温度场。\n\n设初始温度场表示一个幅度为 $\\Delta T=1\\,\\text{K}$ 的急剧热锋：当 $x  L/3$ 时 $T(x,0) = 0\\,\\text{K}$，当 $x \\ge L/3$ 时 $T(x,0)=1\\,\\text{K}$。",
            "solution": "该问题陈述被评估为有效。它在科学上基于流体动力学和数值分析的原理，特别是针对线性平流方程的离散化误差研究。该问题是适定的，提供了所有必要的参数、定义和边界条件。目标明确，语言精确客观。\n\n### 1. 半离散系统的推导\n\n控制方程是关于温度 $T(x,t)$ 的一维线性平流方程，如下所示：\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0\n$$\n其中 $u$ 是恒定的正流速。空间域为 $[0, L)$，具有周期性边界条件。\n\n我们将域离散为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀控制体积。第 $j$ 个单元中心的温度表示为 $T_j(t)$，位于 $x_j = j\\Delta x$ 处，其中 $j = 0, 1, \\dots, N-1$。在节点 $x_j$ 处的空间导数 $\\partial T/\\partial x$ 使用二阶中心差分格式进行近似：\n$$\n\\left. \\frac{\\partial T}{\\partial x} \\right|_{x_j} \\approx \\frac{T(x_{j+1}, t) - T(x_{j-1}, t)}{2\\Delta x} \\approx \\frac{T_{j+1}(t) - T_{j-1}(t)}{2\\Delta x}\n$$\n将此近似代入控制偏微分方程，得到关于节点温度 $T_j(t)$ 的半离散常微分方程(ODE)组：\n$$\n\\frac{dT_j(t)}{dt} + u \\frac{T_{j+1}(t) - T_{j-1}(t)}{2\\Delta x} = 0, \\quad \\text{for } j=0, 1, \\dots, N-1\n$$\n由于周期性边界条件，索引按模 $N$ 计算，即 $T_N(t) = T_0(t)$ 且 $T_{-1}(t) = T_{N-1}(t)$。\n\n### 2. 离散傅里叶分析与色散关系\n\n为分析该系统的行为，我们采用离散傅里叶分析。我们考虑一个单一傅里叶模式的解，形式如下：\n$$\nT_j(t) = \\hat{T}_k(t) e^{i k x_j}\n$$\n其中 $k$ 是波数，$\\hat{T}_k(t)$ 是该模式的复振幅。周期性网格上的离散波数为 $k_m = \\frac{2\\pi m}{L}$，其中 $m = -N/2+1, \\dots, N/2$。这里我们使用通用波数 $k$。\n\n将模式解代入半离散方程：\n$$\n\\frac{d}{dt} \\left( \\hat{T}_k(t) e^{i k x_j} \\right) + u \\frac{\\hat{T}_k(t) e^{i k x_{j+1}} - \\hat{T}_k(t) e^{i k x_{j-1}}}{2\\Delta x} = 0\n$$\n使用 $x_{j\\pm1} = (j\\pm1)\\Delta x = x_j \\pm \\Delta x$，我们可以提出公因子 $\\hat{T}_k(t) e^{i k x_j}$：\n$$\ne^{i k x_j} \\frac{d\\hat{T}_k(t)}{dt} + \\frac{u \\hat{T}_k(t) e^{i k x_j}}{2\\Delta x} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right) = 0\n$$\n除以公共的非零因子 $e^{i k x_j}$ 并使用欧拉公式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，我们得到：\n$$\n\\frac{d\\hat{T}_k(t)}{dt} + \\frac{u \\hat{T}_k(t)}{2\\Delta x} (2i \\sin(k\\Delta x)) = 0\n$$\n这可以简化为关于模式振幅 $\\hat{T}_k(t)$ 的一阶线性常微分方程：\n$$\n\\frac{d\\hat{T}_k(t)}{dt} = -i \\left( \\frac{u \\sin(k\\Delta x)}{\\Delta x} \\right) \\hat{T}_k(t)\n$$\n括号中的项是数值角频率 $\\omega_{\\text{num}}(k)$：\n$$\n\\omega_{\\text{num}}(k) = \\frac{u \\sin(k\\Delta x)}{\\Delta x}\n$$\n这个方程是中心差分格式的离散色散关系。该常微分方程的解为：\n$$\n\\hat{T}_k(t) = \\hat{T}_k(0) e^{-i \\omega_{\\text{num}}(k) t}\n$$\n其中 $\\hat{T}_k(0)$ 是模式在时间 $t=0$ 时的振幅。这为半离散系统的每个傅里叶模式提供了随时间精确演化的解。\n\n### 3. 数值相速度与误差\n\n对于连续偏微分方程，代入波动解 $T(x,t) = \\hat{T}e^{i(kx - \\omega t)}$ 会得到精确的色散关系 $\\omega_{\\text{true}}(k) = uk$。精确相速度为 $c_{\\text{true}}(k) = \\omega_{\\text{true}}/k = u$，它与波数 $k$ 无关。这意味着所有傅里叶分量都以相同的速度传播，波形得以保持。\n\n数值相速度 $c_{\\text{num}}(k)$ 从数值色散关系推导得出：\n$$\nc_{\\text{num}}(k) = \\frac{\\omega_{\\text{num}}(k)}{k} = \\frac{u \\sin(k\\Delta x)/\\Delta x}{k} = u \\frac{\\sin(k\\Delta x)}{k\\Delta x}\n$$\n数值相速度 $c_{\\text{num}}(k)$ 依赖于波数 $k$，这表明该数值格式是色散的。解的不同傅里叶分量以不同的速度传播，导致波形随时间失真。被称为“振铃”的非物理振荡是这种色散误差的直接后果。\n\n### 4. 求解方法\n\n温度场 $T_j(\\Delta t)$ 是通过在傅里叶空间中对初始条件 $T_j(0)$ 进行时间演化来构建的。\n\n1.  **初始条件**：初始条件是一个阶跃函数：当 $x  L/3$ 时 $T(x,0) = 0\\,\\text{K}$，当 $x \\ge L/3$ 时 $T(x,0)=1\\,\\text{K}$。在网格 $x_j = j\\Delta x$ 上将其离散化，以获得初始向量 $T_j(0)$。\n\n2.  **傅里叶分解**：使用离散傅里叶变换(DFT)将初始离散场 $T_j(0)$ 分解为其谱分量 $\\hat{T}_k(0)$。\n\n3.  **傅里叶空间中的时间演化**：每个谱振幅 $\\hat{T}_k(0)$ 使用半离散系统的精确解演化到时间 $\\Delta t$：\n    $$\n    \\hat{T}_k(\\Delta t) = \\hat{T}_k(0) e^{-i \\omega_{\\text{num}}(k) \\Delta t}\n    $$\n    其中 $k$ 取与网格兼容的离散值 $k_m = 2\\pi m/L$。\n\n4.  **重构**：通过对演化后的谱振幅 $\\hat{T}_k(\\Delta t)$ 应用逆离散傅里叶变换(IDFT)来重构最终温度场 $T_j(\\Delta t)$。\n\n### 5. 度量 $R$ 和 $D$ 的计算\n\n**振铃幅度 ($R$)**：\n振铃幅度是温度超出物理预期范围 $[0\\,\\text{K}, 1\\,\\text{K}]$ 的最大偏移量。它根据解 $T_j(\\Delta t)$ 计算如下：\n$$\nR = \\max\\left( 0, \\max_j(T_j(\\Delta t)) - 1, -\\min_j(T_j(\\Delta t)) \\right)\n$$\n这捕捉了超过 $1\\,\\text{K}$ 的最大过冲或低于 $0\\,\\text{K}$ 的最大下冲的幅度。\n\n**色散度量 ($D$)**：\n度量 $D$ 是相对相速度误差的均方根，按初始条件的谱功率加权。对于每个非零离散波数 $k$，相对相速度误差为：\n$$\n\\epsilon(k) = \\frac{c_{\\text{num}}(k) - c_{\\text{true}}}{c_{\\text{true}}} = \\frac{u \\frac{\\sin(k\\Delta x)}{k\\Delta x} - u}{u} = \\frac{\\sin(k\\Delta x)}{k\\Delta x} - 1\n$$\n每个模式的权重 $w(k)$ 是其归一化的谱功率，其中归一化是针对所有非零波数进行的：\n$$\nw(k) = \\frac{|\\hat{T}_k(0)|^2}{\\sum_{k' \\ne 0} |\\hat{T}_{k'}(0)|^2}\n$$\n然后，色散度量计算如下：\n$$\nD = \\sqrt{\\sum_{k\\neq 0} w(k) \\left( \\epsilon(k) \\right)^2}\n$$\n该度量量化了由特定初始条件激发的格式的内在色散性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the ringing amplitude and dispersion metric for the central\n    differencing scheme applied to the 1D linear advection equation.\n    \"\"\"\n    test_cases = [\n        # (L, u, N, dt)\n        (1.0, 1.0, 256, 0.002),\n        (1.0, 1.0, 256, 0.0002),\n        (1.0, 1.0, 64, 0.01),\n        (1.0, 2.0, 32, 0.01),\n    ]\n\n    results = []\n\n    for L, u, N, dt in test_cases:\n        # 1. Setup Grid and Initial Condition\n        dx = L / N\n        x = np.arange(N) * dx\n        x0 = L / 3.0\n        T0 = np.where(x = x0, 1.0, 0.0)\n\n        # 2. Fourier Analysis and Time Evolution\n        # DFT of the initial condition\n        T0_hat = np.fft.fft(T0)\n        \n        # Get discrete wavenumbers\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n        # Numerical dispersion relation for Central Differencing scheme\n        # omega_num = u * sin(k*dx) / dx\n        # For k=0, this is 0, so no NaN is produced.\n        omega_num = u * np.sin(k * dx) / dx\n\n        # Evolve spectral coefficients exactly in time for the semi-discrete system\n        evolution_operator = np.exp(-1j * omega_num * dt)\n        T_dt_hat = T0_hat * evolution_operator\n\n        # Inverse DFT to get solution in physical space at t=dt\n        T_dt = np.fft.ifft(T_dt_hat).real\n\n        # 3. Compute Metrics R and D\n        # Ringing Amplitude R: maximum excursion outside [0, 1]\n        R_overshoot = np.max(T_dt) - 1.0\n        R_undershoot = -np.min(T_dt)\n        R = np.max([0.0, R_overshoot, R_undershoot])\n\n        # Dispersion Metric D\n        # Exclude the k=0 (DC) mode\n        mask_nz = (k != 0)\n        k_nz = k[mask_nz]\n        T0_hat_nz = T0_hat[mask_nz]\n\n        # Spectral power of non-zero modes\n        power_nz = np.abs(T0_hat_nz)**2\n        total_power_nz = np.sum(power_nz)\n        \n        # Weights w(k) for k!=0\n        weights = power_nz / total_power_nz\n\n        # Relative phase speed error: c_num/c_true - 1 = sin(k*dx)/(k*dx) - 1\n        # np.sinc(x) is defined as sin(pi*x)/(pi*x)\n        # So, sin(k*dx)/(k*dx) is equivalent to np.sinc(k*dx/pi)\n        rel_phase_speed_error = np.sinc(k_nz * dx / np.pi) - 1.0\n\n        # Calculate D as the weighted root-mean-square of the relative error\n        D_squared = np.sum(weights * (rel_phase_speed_error**2))\n        D = np.sqrt(D_squared)\n\n        results.append([R, D])\n\n    # Format output as specified in the problem statement\n    output_str = f\"[{','.join([f'[{r[0]},{r[1]}]' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在展示了中心差分格式的缺点并分析其根源之后，一个自然的问题是：我们如何修正它？本实践将通过构建一个混合格式来探索一种常见的补救措施，该格式将中心差分与更稳定的一阶迎风格式相融合。你的任务是通过强制施加M-矩阵条件，推导出保证解有界、无振荡所需的最小混合分数 ()。这个练习连接了理论与实践，展示了如何构建一个稳健的格式来克服纯中心差分的局限性。",
            "id": "3989762",
            "problem": "考虑在静止介质中，具有恒定物性的被动标量场 $\\phi(x)$ 的稳态一维对流扩散问题。该问题设定在间距为 $\\Delta x$ 的均匀网格上，横截面积为 $A$，分子扩散率为 $\\Gamma$，密度为 $\\rho$，速度为恒定的 $u$。其控制守恒律为\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} = 0$$\n其中无体积源项，并设有适当的边界条件以确保存在唯一的稳态解。令 $F := \\rho u A$ 表示对流质量通量，$D := \\Gamma A / \\Delta x$ 表示扩散导率。使用有限体积法 (FVM)，在一个以节点 $P$ 为中心、西侧和东侧相邻节点分别为 $W$ 和 $E$ 的通用控制体上进行积分。对于控制体表面的对流通量，考虑中心差分格式 (CDS) 和迎风差分格式 (UDS) 之间的线性混合：设混合分数为 $w \\in [0,1]$，离散格式的系数通过对 CDS 和 UDS 的离散算子进行凸组合得到。佩克莱数定义为 $\\mathrm{Pe} := F/D$，其绝对值为 $|\\mathrm{Pe}| = \\rho |u| \\Delta x / \\Gamma$。\n\n从上述守恒律以及 $F$ 和 $D$ 的定义出发，推导节点 $P$ 处的离散方程，并显式地求出 CDS 和 UDS 的相邻节点系数 $a_W$ 和 $a_E$。然后，以分数 $w$ 通过凸组合构造混合格式的系数。施加所需条件，以使系数矩阵在标准 FVM 意义上成为一个 $\\mathrm{M}$-矩阵（当方程写作 $a_P\\phi_P = \\sum a_{nb}\\phi_{nb}$ 时，对角线元素为正，相邻节点系数为非负，并且每行弱对角占优），这些条件足以保证该问题离散解的有界性（无伪振荡）。\n\n以闭合形式确定最小混合分数 $w_{\\min}(\\mathrm{Pe})$，它作为网格佩克莱数 $\\mathrm{Pe}$ 的函数，能保证对任意流动方向都满足 $\\mathrm{M}$-矩阵性质。请将最终结果表示为单一的解析表达式。无需进行数值取整。",
            "solution": "过程始于对所给问题陈述的验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：稳态一维被动标量 $\\phi(x)$ 对流扩散方程：$\\frac{d}{dx}\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)-\\rho u\\,\\frac{d\\phi}{dx}=0$。\n- **物理参数**：恒定的密度 $\\rho$、恒定的速度 $u$、恒定的分子扩散率 $\\Gamma$ 和恒定的横截面积 $A$。\n- **离散化**：间距为 $\\Delta x$ 的均匀网格。在一个以节点 $P$ 为中心、相邻节点为 $W$ (西) 和 $E$ (东) 的控制体上使用有限体积法 (FVM)。\n- **定义的量**：\n    - 对流质量通量：$F := \\rho u A$。\n    - 扩散导率：$D := \\Gamma A/\\Delta x$。\n    - 网格佩克莱数：$\\mathrm{Pe} := F/D = \\rho u \\Delta x/\\Gamma$。\n- **数值格式**：\n    - 中心差分格式 (CDS)。\n    - 迎风差分格式 (UDS)。\n    - 混合格式：CDS 和 UDS 系数以混合分数 $w \\in [0,1]$ 进行的凸组合。\n- **约束条件**：当离散方程写作 $a_P\\phi_P = \\sum a_{nb}\\phi_{nb}$ 形式时，最终的系数矩阵必须是一个 $\\mathrm{M}$-矩阵，对本问题而言，这要求非对角线（相邻节点）系数为非负。\n- **目标**：确定最小混合分数 $w_{\\min}(\\mathrm{Pe})$，它作为网格佩克莱数 $\\mathrm{Pe}$ 的函数，能保证对任意流动方向都满足 $\\mathrm{M}$-矩阵性质。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于基本的一维稳态对流扩散方程，这是输运现象的基石。有限体积法、CDS、UDS、佩克莱数和 M-矩阵稳定性准则都是计算流体动力学和数值传热学中标准的、公认的概念。该问题具有科学合理性。\n- **适定性与完整性**：问题陈述是自洽的，提供了推导所求量 $w_{\\min}(\\mathrm{Pe})$ 所需的所有方程、定义和约束。目标明确，并且预期有唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述，没有任何主观或模棱两可的术语。\n- **一致性**：所有定义都是一致的。例如，$\\mathrm{Pe} = F/D = (\\rho u A)/(\\Gamma A/\\Delta x) = \\rho u \\Delta x / \\Gamma$，这与给定的定义相符。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**，因其具有科学依据、适定且内部一致。将进行求解。\n\n### 推导\n我们首先将控制方程在一个以节点 P 为中心、长度为 $\\Delta x$、面积为 $A$ 的控制体 (CV) 上进行积分。控制体的表面分别位于 $x_w$ (西) 和 $x_e$ (东)。\n$$ \\int_{x_w}^{x_e} \\left[ \\frac{d}{dx}\\left(\\Gamma A \\frac{d\\phi}{dx}\\right) - \\frac{d}{dx}(\\rho u A \\phi) \\right] dx = 0 $$\n注意，由于 $\\rho$、$u$ 和 $A$ 是常数，对流项 $\\rho u \\frac{d\\phi}{dx}$ 可以写成 $\\frac{d}{dx}(\\rho u \\phi)$。应用微积分基本定理，我们得到控制体表面的通量平衡：\n$$ \\left[ \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right]_{x_e} - \\left[ \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right]_{x_w} = 0 $$\n这些项代表穿过控制体表面的总通量（扩散+对流）。我们对这些项进行离散。扩散通量使用中心差分进行近似：\n$$ \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_{x_e} \\approx \\Gamma A \\frac{\\phi_E - \\phi_P}{\\Delta x} = D(\\phi_E - \\phi_P) $$\n$$ \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_{x_w} \\approx \\Gamma A \\frac{\\phi_P - \\phi_W}{\\Delta x} = D(\\phi_P - \\phi_W) $$\n对流通量为 $(\\rho u A \\phi)_{x_e} = F \\phi_e$ 和 $(\\rho u A \\phi)_{x_w} = F \\phi_w$，其中 $\\phi_e$ 和 $\\phi_w$ 是控制体表面上的标量值。积分后的方程变为：\n$$ D(\\phi_E - \\phi_P) - D(\\phi_P - \\phi_W) - (F\\phi_e - F\\phi_w) = 0 $$\n\n接下来，我们使用中心差分格式 (CDS) 和迎风差分格式 (UDS) 来计算表面值 $\\phi_e$ 和 $\\phi_w$，以求得它们各自的系数。\n\n**1. 中心差分格式 (CDS)**\n在 CDS 中，表面值是线性插值的：$\\phi_e = \\frac{1}{2}(\\phi_P + \\phi_E)$ 和 $\\phi_w = \\frac{1}{2}(\\phi_W + \\phi_P)$。将这些代入通量平衡方程：\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - F\\left( \\frac{\\phi_P + \\phi_E}{2} - \\frac{\\phi_W + \\phi_P}{2} \\right) = 0 $$\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - \\frac{F}{2}(\\phi_E - \\phi_W) = 0 $$\n整理成 $a_P\\phi_P = a_W\\phi_W + a_E\\phi_E$ 的形式：\n$$ (2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E $$\nCDS 的系数为：\n$$ a_{W, \\text{CDS}} = D + \\frac{F}{2} \\quad , \\quad a_{E, \\text{CDS}} = D - \\frac{F}{2} $$\n\n**2. 迎风差分格式 (UDS)**\n在 UDS 中，表面值取自上游节点。这可以用 $\\max$ 函数紧凑地表示。流出控制体的净对流通量是：\n$$ F\\phi_e - F\\phi_w = \\left(\\max(F,0)\\phi_P + \\min(F,0)\\phi_E\\right) - \\left(\\max(F,0)\\phi_W + \\min(F,0)\\phi_P\\right) $$\n使用 $\\min(F,0) = -\\max(-F,0)$，通量平衡方程为：\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - \\left[ (\\max(F,0)-\\min(F,0))\\phi_P - \\max(F,0)\\phi_W - \\min(F,0)\\phi_E \\right] = 0 $$\n注意到 $\\max(F,0)-\\min(F,0) = \\max(F,0)+\\max(-F,0) = |F|$，我们得到：\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - |F|\\phi_P + \\max(F,0)\\phi_W - \\min(F,0)\\phi_E = 0 $$\n整理成标准形式：\n$$ (2D+|F|)\\phi_P = (D+\\max(F,0))\\phi_W + (D-\\min(F,0))\\phi_E $$\n$$ (2D+|F|)\\phi_P = (D+\\max(F,0))\\phi_W + (D+\\max(-F,0))\\phi_E $$\nUDS 的系数为：\n$$ a_{W, \\text{UDS}} = D + \\max(F,0) \\quad , \\quad a_{E, \\text{UDS}} = D + \\max(-F,0) $$\n\n**3. 混合格式与 M-矩阵条件**\n混合格式的系数是混合分数为 $w$ 的凸组合：\n$$ a_W = (1-w)a_{W, \\text{CDS}} + w a_{W, \\text{UDS}} = (1-w)\\left(D+\\frac{F}{2}\\right) + w\\left(D+\\max(F,0)\\right) $$\n$$ a_E = (1-w)a_{E, \\text{CDS}} + w a_{E, \\text{UDS}} = (1-w)\\left(D-\\frac{F}{2}\\right) + w\\left(D+\\max(-F,0)\\right) $$\n简化这些表达式：\n$$ a_W = D + (1-w)\\frac{F}{2} + w\\max(F,0) $$\n$$ a_E = D - (1-w)\\frac{F}{2} + w\\max(-F,0) $$\nM-矩阵性质要求相邻节点系数为非负：$a_W \\ge 0$ 和 $a_E \\ge 0$。我们用 $D$ 进行归一化，并使用佩克莱数 $\\mathrm{Pe}=F/D$：\n$$ \\frac{a_W}{D} = 1 + (1-w)\\frac{\\mathrm{Pe}}{2} + w\\max(\\mathrm{Pe},0) \\ge 0 $$\n$$ \\frac{a_E}{D} = 1 - (1-w)\\frac{\\mathrm{Pe}}{2} + w\\max(-\\mathrm{Pe},0) \\ge 0 $$\n我们针对 $\\mathrm{Pe}$ 的不同符号分析这两个不等式。\n\n- **情况 1: $\\mathrm{Pe} > 0$**\n当 $\\mathrm{Pe} > 0$ 时，$\\max(\\mathrm{Pe},0)=\\mathrm{Pe}$ 且 $\\max(-\\mathrm{Pe},0)=0$。\n关于 $a_W$ 的不等式变为：$1 + (1-w)\\frac{\\mathrm{Pe}}{2} + w\\mathrm{Pe} = 1 + \\frac{\\mathrm{Pe}}{2} + w\\frac{\\mathrm{Pe}}{2} = 1 + \\frac{\\mathrm{Pe}}{2}(1+w)$。由于 $\\mathrm{Pe}>0$ 且 $w \\ge 0$，该式恒为正。\n关于 $a_E$ 的不等式变为：$1 - (1-w)\\frac{\\mathrm{Pe}}{2} \\ge 0$。这是约束条件。\n$$ 1 \\ge (1-w)\\frac{\\mathrm{Pe}}{2} \\implies \\frac{2}{\\mathrm{Pe}} \\ge 1-w \\implies w \\ge 1 - \\frac{2}{\\mathrm{Pe}} $$\n\n- **情况 2: $\\mathrm{Pe}  0$**\n当 $\\mathrm{Pe}  0$ 时，$\\max(\\mathrm{Pe},0)=0$ 且 $\\max(-\\mathrm{Pe},0)=-\\mathrm{Pe}=|\\mathrm{Pe}|$。\n关于 $a_W$ 的不等式变为：$1 + (1-w)\\frac{\\mathrm{Pe}}{2} \\ge 0$。这是约束条件。\n使用 $|\\mathrm{Pe}|=-\\mathrm{Pe}$：$1 - (1-w)\\frac{|\\mathrm{Pe}|}{2} \\ge 0 \\implies 1 \\ge (1-w)\\frac{|\\mathrm{Pe}|}{2} \\implies w \\ge 1 - \\frac{2}{|\\mathrm{Pe}|}$。\n关于 $a_E$ 的不等式变为：$1 - (1-w)\\frac{\\mathrm{Pe}}{2} - w\\mathrm{Pe} = 1 - \\frac{\\mathrm{Pe}}{2} - w\\frac{\\mathrm{Pe}}{2} = 1 - \\frac{\\mathrm{Pe}}{2}(1+w) = 1+\\frac{|\\mathrm{Pe}|}{2}(1+w)$。该式恒为正。\n\n**4. $w_{\\min}$ 的最终表达式**\n在两种情况（$\\mathrm{Pe}>0$ 和 $\\mathrm{Pe}0$）下，条件均为 $w \\ge 1 - 2/|\\mathrm{Pe}|$。由于 $w$ 还必须为非负数，因此完整的条件是 $w \\ge \\max(0, 1 - 2/|\\mathrm{Pe}|)$。\n如果 $|\\mathrm{Pe}| \\le 2$，那么 $1-2/|\\mathrm{Pe}| \\le 0$，所以条件是 $w \\ge 0$，这对任何 $w \\in [0,1]$ 都成立。在此范围内，$w_{\\min}=0$，意味着纯中心差分格式是稳定的。\n如果 $|\\mathrm{Pe}|  2$，我们需要 $w \\ge 1 - 2/|\\mathrm{Pe}|  0$。\n保证对任意佩克莱数 $\\mathrm{Pe}$ 都具有 M-矩阵性质的最小混合分数 $w_{\\min}$ 是该条件的下界。\n因此，作为 $\\mathrm{Pe}$ 的函数的 $w_{\\min}$ 的单一解析表达式为：\n$$ w_{\\min}(\\mathrm{Pe}) = \\max\\left(0, 1 - \\frac{2}{|\\mathrm{Pe}|}\\right) $$\n该表达式正确地捕捉了其行为：对于低佩克莱数（$|\\mathrm{Pe}| \\le 2$），不需要迎风格式（$w_{\\min}=0$）；而对于高佩克莱数，则需要逐渐增加的迎风权重，当 $|\\mathrm{Pe}| \\to \\infty$ 时，趋向于完全迎风（$w \\to 1$）。",
            "answer": "$$\\boxed{\\max\\left(0, 1 - \\frac{2}{|\\mathrm{Pe}|}\\right)}$$"
        }
    ]
}