{
    "hands_on_practices": [
        {
            "introduction": "理解中心差分格式局限性的最直接方法之一，是观察其在纯对流问题中的表现。本练习提供了一个动手计算的机会，通过一个具体的例子展示该格式如何从严格为正的初始数据和边界条件中产生非物理的负值 。这个结果清晰地揭示了该格式违反了物理守恒的基本原则，即有界性或最大值原理。",
            "id": "3989802",
            "problem": "考虑一个被输运的标量场$\\,\\phi(x,t)\\,$的一维线性平流方程，\n$$\\frac{\\partial \\phi}{\\partial t} + u \\,\\frac{\\partial \\phi}{\\partial x} = 0,$$\n该方程定义在空间域$\\,x \\in [0,L]\\,$上，具有恒定的平流速度$\\,u0\\,$。边界条件在所有时刻都是固定的且严格为正，\n$$\\phi(0,t) = 1, \\qquad \\phi(L,t) = 1.$$\n设$\\,L = 4\\,\\Delta x\\,$，并定义一个均匀的单元中心网格，其位置为$\\,x_j = j\\,\\Delta x\\,$，其中$\\,j = 0,1,2,3,4\\,$。内部节点为$\\,j=1,2,3\\,$。在时间$\\,t=0\\,$时，假设内部值严格为正但非均匀：\n$$\\phi_1^0 = 0.05, \\qquad \\phi_2^0 = 0.413, \\qquad \\phi_3^0 = 1.2,$$\n而边界节点在所有时间层$\\,n \\ge 0\\,$上满足$\\,\\phi_0^n = \\phi_4^n = 1\\,$。设$\\,u = 1\\,\\mathrm{m/s}\\,$，$\\,\\Delta x = 1\\,\\mathrm{m}\\,$，以及$\\,\\Delta t = 0.9\\,\\mathrm{s}\\,$。\n\n从控制方程出发，仅使用标准的二阶中心差分法对$\\,\\partial \\phi/\\partial x\\,$进行空间离散，并使用前向欧拉法对$\\,\\partial \\phi/\\partial t\\,$进行时间离散，推导内部节点的半离散更新式，并执行一个时间步来计算$\\,\\phi_2^1\\,$的值。您的推导必须从偏微分方程和指定的离散化选择开始；不要引用任何单调性或保正性结果。简要解释为什么尽管边界和初始内部值都严格为正，计算出的结果仍然表明该中心差分对流离散化违反了离散比较原理（极值原理）。\n\n将您最终的$\\,\\phi_2^1\\,$数值答案四舍五入到五位有效数字。将最终值表示为无量纲数。",
            "solution": "该问题是有效的，因为它提出了一个在计算流体动力学领域中定义明确的问题，该问题基于已建立的数学和物理原理，并提供了一套完整且一致的数据。\n\n控制方程是一维线性平流方程：\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} = 0\n$$\n我们的任务是使用时间上的前向欧拉法和空间上的二阶中心差分格式来离散化这个方程。\n\n在网格节点 $j$ 处的时间导数使用前向欧拉格式进行近似：\n$$\n\\frac{\\partial \\phi}{\\partial t} \\bigg|_{j}^n \\approx \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t}\n$$\n其中上标 $n$ 表示时间层 $t = n \\Delta t$，下标 $j$ 表示空间位置 $x = x_j$。\n\n空间导数使用二阶中心差分格式进行近似：\n$$\n\\frac{\\partial \\phi}{\\partial x} \\bigg|_{j}^n \\approx \\frac{\\phi_{j+1}^n - \\phi_{j-1}^n}{2 \\Delta x}\n$$\n将这些近似值代入控制方程，我们得到全离散表示：\n$$\n\\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} + u \\left( \\frac{\\phi_{j+1}^n - \\phi_{j-1}^n}{2 \\Delta x} \\right) = 0\n$$\n为了推导下一个时间步的$\\phi$值（即$\\phi_j^{n+1}$）的更新规则，我们重新整理该方程：\n$$\n\\phi_j^{n+1} = \\phi_j^n - u \\frac{\\Delta t}{2 \\Delta x} (\\phi_{j+1}^n - \\phi_{j-1}^n)\n$$\n我们定义无量纲的库朗数 $C$ 为：\n$$\nC = \\frac{u \\Delta t}{\\Delta x}\n$$\n使用给定参数 $u = 1\\,\\mathrm{m/s}$、$\\Delta t = 0.9\\,\\mathrm{s}$ 和 $\\Delta x = 1\\,\\mathrm{m}$，库朗数为：\n$$\nC = \\frac{(1\\,\\mathrm{m/s})(0.9\\,\\mathrm{s})}{1\\,\\mathrm{m}} = 0.9\n$$\n现在，更新方程可以用库朗数表示：\n$$\n\\phi_j^{n+1} = \\phi_j^n - \\frac{C}{2} (\\phi_{j+1}^n - \\phi_{j-1}^n)\n$$\n该方程对内部节点 $j=1, 2, 3$ 有效。我们需要计算$\\phi_2^1$的值，它对应于时间层 $n+1=1$ 时的节点 $j=2$。在更新方程中设 $j=2$ 和 $n=0$ 可得：\n$$\n\\phi_2^1 = \\phi_2^0 - \\frac{C}{2} (\\phi_3^0 - \\phi_1^0)\n$$\n给定时间 $t=0$ (即 $n=0$) 时的初始值：$\\phi_1^0 = 0.05$，$\\phi_2^0 = 0.413$，以及 $\\phi_3^0 = 1.2$。将这些值以及 $C=0.9$ 代入$\\phi_2^1$的方程中：\n$$\n\\phi_2^1 = 0.413 - \\frac{0.9}{2} (1.2 - 0.05)\n$$\n$$\n\\phi_2^1 = 0.413 - 0.45 (1.15)\n$$\n$$\n\\phi_2^1 = 0.413 - 0.5175\n$$\n$$\n\\phi_2^1 = -0.1045\n$$\n将其四舍五入到五位有效数字，得到$\\phi_2^1 = -0.10450$。\n\n这个结果表明违反了离散比较原理（或极值原理）。物理平流方程在没有源项或汇项的情况下，不能产生新的极值。标量场$\\phi$在任何点和任何时间的值都必须被初始数据和边界上的最小值和最大值所界定。在时间 $t=0$ 时，所有给定值的集合为 $\\{\\phi_0^0, \\phi_1^0, \\phi_2^0, \\phi_3^0, \\phi_4^0\\} = \\{1, 0.05, 0.413, 1.2, 1\\}$。因此，在 $t=0$ 时整个域的最小值为 $\\phi_{\\min}^0 = 0.05$。最大值为 $\\phi_{\\max}^0 = 1.2$。所有的初始值和边界值都严格为正。然而，我们的计算得出了 $\\phi_2^1 = -0.10450$，这个值小于初始最小值 $0.05$。该数值格式产生了一个新的、非物理的最小值。\n\n这种违背现象的数学原因在于离散更新方程的结构。如果我们将$\\phi_j^{n+1}$的方程重写为前一时间步值的线性组合：\n$$\n\\phi_j^{n+1} = \\left(\\frac{C}{2}\\right) \\phi_{j-1}^n + (1) \\phi_j^n + \\left(-\\frac{C}{2}\\right) \\phi_{j+1}^n\n$$\n为了使离散比较原理成立，解$\\phi_j^{n+1}$必须是其前一时间步邻近值的凸组合，这要求线性组合中的所有系数都为非负。在这种情况下，$\\phi_{j+1}^n$的系数是$-\\frac{C}{2}$。由于$C=0.90$，这个系数是负的（$-0.45$）。这个负系数使得$\\phi_{j+1}^n$处的一个较大值可以从其他项中减去，有可能将结果$\\phi_j^{n+1}$推到时间 $n$ 时数据范围之外。指定的初始条件，从$\\phi_1^0 = 0.05$急剧增加到$\\phi_3^0 = 1.2$，是特意选择来突显中心差分格式用于纯平流问题时的无条件不稳定性，这种不稳定性会导致非物理振荡和对正定性的违背。",
            "answer": "$$\n\\boxed{-0.10450}\n$$"
        },
        {
            "introduction": "在观察到中心差分格式可能失效后，下一个逻辑步骤是探究其背后的原因。本练习利用傅里叶分析方法，深入探讨问题的数学根源 。通过分析，您将发现该格式的数值频散（numerical dispersion）特性如何导致热锋面中的不同波分量以错误的速度传播，从而产生特有的“振铃”或非物理振荡现象。",
            "id": "3989790",
            "problem": "考虑流体流动在一维瞬态加热过程，其模型由无扩散和无源项的能量守恒方程描述。温度场 $T(x,t)$ 由线性平流方程 $\\,\\partial T/\\partial t + u\\,\\partial T/\\partial x = 0\\,$ 控制，定义在一个长度为 $L$ 的周期性空间域上，流速 $u0$ 为常数。该域被划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀间隔的控制体。对流项在空间上使用网格上的中心差分格式进行离散化，从而得到一个关于单元中心 $x_j = j\\,\\Delta x$ 处节点温度 $T_j(t)$ 的常微分方程半离散系统，其中索引为周期性的。\n\n仅从平流能量守恒的基本形式以及空间导数的中心差分近似的定义出发，使用离散傅里叶分析，在周期性边界条件下推导此半离散系统的离散色散关系。利用该色散关系，获得半离散中心差分算子的每个离散傅里叶模态随时间精确演化的表达式，并由此根据下述初始条件构建时刻 $t=\\Delta t$ 的温度场。\n\n设初始温度场代表一个幅值为 $\\Delta T=1\\,\\mathrm{K}$ 的陡峭热锋面：对于 $x  L/3$，$T(x,0) = 0\\,\\mathrm{K}$；对于 $x \\ge L/3$，$T(x,0)=1\\,\\mathrm{K}$。\n\n您必须计算两个值：(1) **振铃幅值** $\\,R\\,$，定义为时刻 $\\,\\Delta t\\,$ 温度场超出其物理边界 $\\,[0\\,\\mathrm{K}, 1\\,\\mathrm{K}]\\,$ 的最大绝对偏差；(2) **色散度量** $\\,D\\,$，定义为由初始条件的谱功率加权的相对相速度误差的均方根。\n\n提供一个 Python 脚本，该脚本对以下四种情况中的每一种都计算 $\\,[R, D]\\,$：\n1. $L=1\\,\\mathrm{m}, u=1\\,\\mathrm{m/s}, N=256, \\Delta t=0.002\\,\\mathrm{s}$\n2. $L=1\\,\\mathrm{m}, u=1\\,\\mathrm{m/s}, N=256, \\Delta t=0.0002\\,\\mathrm{s}$\n3. $L=1\\,\\mathrm{m}, u=1\\,\\mathrm{m/s}, N=64, \\Delta t=0.01\\,\\mathrm{s}$\n4. $L=1\\,\\mathrm{m}, u=2\\,\\mathrm{m/s}, N=32, \\Delta t=0.01\\,\\mathrm{s}$\n\n将您的最终答案格式化为包含四个 `[R,D]` 对的单个嵌套列表：`[[R1,D1],[R2,D2],[R3,D3],[R4,D4]]`。",
            "solution": "问题陈述被评估为有效。其科学基础在于流体动力学和数值分析的原理，特别是针对线性平流方程的离散化误差研究。问题是适定的，所有必要的参数、定义和边界条件都已提供。目标明确，语言精确客观。\n\n### 1. 半离散系统的推导\n\n控制方程是关于温度 $T(x,t)$ 的一维线性平流方程，给定为：\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = 0\n$$\n其中 $u$ 是恒定的正流速。空间域为 $[0, L)$，具有周期性边界条件。\n\n我们将该域离散化为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀控制体。第 $j$ 个单元中心的温度表示为 $T_j(t)$，位于 $x_j = j\\Delta x$ 处，其中 $j = 0, 1, \\dots, N-1$。节点 $x_j$ 处的空间导数 $\\partial T/\\partial x$ 使用二阶中心差分格式进行近似：\n$$\n\\left. \\frac{\\partial T}{\\partial x} \\right|_{x_j} \\approx \\frac{T(x_{j+1}, t) - T(x_{j-1}, t)}{2\\Delta x} \\approx \\frac{T_{j+1}(t) - T_{j-1}(t)}{2\\Delta x}\n$$\n将此近似代入控制偏微分方程，得到关于节点温度 $T_j(t)$ 的常微分方程 (ODEs) 半离散系统：\n$$\n\\frac{dT_j(t)}{dt} + u \\frac{T_{j+1}(t) - T_{j-1}(t)}{2\\Delta x} = 0, \\quad \\text{对于 } j=0, 1, \\dots, N-1\n$$\n由于周期性边界条件，索引按 $N$ 取模，即 $T_N(t) = T_0(t)$ 和 $T_{-1}(t) = T_{N-1}(t)$。\n\n### 2. 离散傅里葉分析與色散關係\n\n为了分析此系统的行为，我们采用离散傅里叶分析。我们考虑一个单一傅里叶模态解，其形式为：\n$$\nT_j(t) = \\hat{T}_k(t) e^{i k x_j}\n$$\n其中 $k$ 是波数，$\\hat{T}_k(t)$ 是该模态的复振幅。周期性网格上的离散波数为 $k_m = \\frac{2\\pi m}{L}$，其中 $m = -N/2+1, \\dots, N/2$。这里我们使用通用波数 $k$。\n\n将模态解代入半离散方程：\n$$\n\\frac{d}{dt} \\left( \\hat{T}_k(t) e^{i k x_j} \\right) + u \\frac{\\hat{T}_k(t) e^{i k x_{j+1}} - \\hat{T}_k(t) e^{i k x_{j-1}}}{2\\Delta x} = 0\n$$\n利用 $x_{j\\pm1} = (j\\pm1)\\Delta x = x_j \\pm \\Delta x$，我们可以提出公因子 $\\hat{T}_k(t) e^{i k x_j}$：\n$$\ne^{i k x_j} \\frac{d\\hat{T}_k(t)}{dt} + \\frac{u \\hat{T}_k(t) e^{i k x_j}}{2\\Delta x} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right) = 0\n$$\n除以公共非零因子 $e^{i k x_j}$ 并使用欧拉公式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，我们得到：\n$$\n\\frac{d\\hat{T}_k(t)}{dt} + \\frac{u \\hat{T}_k(t)}{2\\Delta x} (2i \\sin(k\\Delta x)) = 0\n$$\n这简化为一个关于模态振幅 $\\hat{T}_k(t)$ 的一阶线性常微分方程：\n$$\n\\frac{d\\hat{T}_k(t)}{dt} = -i \\left( \\frac{u \\sin(k\\Delta x)}{\\Delta x} \\right) \\hat{T}_k(t)\n$$\n括号中的项是数值角频率 $\\omega_{\\text{num}}(k)$：\n$$\n\\omega_{\\text{num}}(k) = \\frac{u \\sin(k\\Delta x)}{\\Delta x}\n$$\n此方程即为中心差分格式的离散色散关系。此常微分方程的解为：\n$$\n\\hat{T}_k(t) = \\hat{T}_k(0) e^{-i \\omega_{\\text{num}}(k) t}\n$$\n其中 $\\hat{T}_k(0)$ 是时刻 $t=0$ 时的模态振幅。这为半离散系统的每个傅里叶模态提供了时间上精确的演化。\n\n### 3. 数值相速度与误差\n\n对于连续偏微分方程，代入波动解 $T(x,t) = \\hat{T}e^{i(kx - \\omega t)}$ 可得到精确色散关系 $\\omega_{\\text{true}}(k) = uk$。精确相速度为 $c_{\\text{true}}(k) = \\omega_{\\text{true}}/k = u$，它与波数 $k$ 无关。这意味着所有傅里叶分量都以相同的速度传播，波形得以保持。\n\n数值相速度 $c_{\\text{num}}(k)$ 从数值色散关系导出：\n$$\nc_{\\text{num}}(k) = \\frac{\\omega_{\\text{num}}(k)}{k} = \\frac{u \\sin(k\\Delta x)/\\Delta x}{k} = u \\frac{\\sin(k\\Delta x)}{k\\Delta x}\n$$\n数值相速度 $c_{\\text{num}}(k)$ 依赖于波数 $k$，这表明该数值格式是色散的。解的不同傅里叶分量以不同速度传播，导致波形随时间发生畸变。被称为振铃的非物理振荡现象就是这种色散误差的直接后果。\n\n### 4. 求解方法\n\n温度场 $T_j(\\Delta t)$ 是通过在傅里叶空间中演化初始条件 $T_j(0)$ 来构建的。\n\n1.  **初始条件**：初始条件是一个阶跃函数：对于 $x  L/3$，$T(x,0) = 0\\,\\mathrm{K}$；对于 $x \\ge L/3$，$T(x,0)=1\\,\\mathrm{K}$。这在网格 $x_j = j\\Delta x$ 上离散化，以获得初始向量 $T_j(0)$。\n\n2.  **傅里叶分解**：使用离散傅里叶变换 (DFT) 将初始离散场 $T_j(0)$ 分解为其谱分量 $\\hat{T}_k(0)$。\n\n3.  **傅里叶空间中的时间演化**：利用半离散系统的精确解，将每个谱振幅 $\\hat{T}_k(0)$ 演化至时间 $\\Delta t$：\n    $$\n    \\hat{T}_k(\\Delta t) = \\hat{T}_k(0) e^{-i \\omega_{\\text{num}}(k) \\Delta t}\n    $$\n    其中 $k$ 取与网格兼容的离散值 $k_m = 2\\pi m/L$。\n\n4.  **重构**：通过对演化后的谱振幅 $\\hat{T}_k(\\Delta t)$ 应用离散傅里叶逆变换 (IDFT)，重构最终温度场 $T_j(\\Delta t)$。\n\n### 5. 度量 $R$ 和 $D$ 的计算\n\n**振铃幅值 ($R$)**:\n振铃幅值是温度超出物理预期范围 $[0\\,\\mathrm{K}, 1\\,\\mathrm{K}]$ 的最大偏移量。它根据解 $T_j(\\Delta t)$ 计算得出：\n$$\nR = \\max\\left( 0, \\max_j(T_j(\\Delta t)) - 1, -\\min_j(T_j(\\Delta t)) \\right)\n$$\n这捕捉了高于 $1\\,\\mathrm{K}$ 的最大过冲或低于 $0\\,\\mathrm{K}$ 的最大下冲的幅值。\n\n**色散度量 ($D$)**:\n度量 $D$ 是由初始条件谱功率加权的相对相速度误差的均方根。对于每个非零离散波数 $k$，相对相速度误差为：\n$$\n\\epsilon(k) = \\frac{c_{\\text{num}}(k) - c_{\\text{true}}}{c_{\\text{true}}} = \\frac{u \\frac{\\sin(k\\Delta x)}{k\\Delta x} - u}{u} = \\frac{\\sin(k\\Delta x)}{k\\Delta x} - 1\n$$\n每个模态的权重 $w(k)$ 是其归一化谱功率，其中归一化是针对所有非零波数进行的：\n$$\nw(k) = \\frac{|\\hat{T}_k(0)|^2}{\\sum_{k' \\ne 0} |\\hat{T}_{k'}(0)|^2}\n$$\n色散度量随后计算为：\n$$\nD = \\sqrt{\\sum_{k\\neq 0} w(k) \\left( \\epsilon(k) \\right)^2}\n$$\n该度量量化了由特定初始条件激发的格式固有色散性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the ringing amplitude and dispersion metric for the central\n    differencing scheme applied to the 1D linear advection equation.\n    \"\"\"\n    test_cases = [\n        # (L, u, N, dt)\n        (1.0, 1.0, 256, 0.002),\n        (1.0, 1.0, 256, 0.0002),\n        (1.0, 1.0, 64, 0.01),\n        (1.0, 2.0, 32, 0.01),\n    ]\n\n    results = []\n\n    for L, u, N, dt in test_cases:\n        # 1. Setup Grid and Initial Condition\n        dx = L / N\n        x = np.arange(N) * dx\n        x0 = L / 3.0\n        T0 = np.where(x = x0, 1.0, 0.0)\n\n        # 2. Fourier Analysis and Time Evolution\n        # DFT of the initial condition\n        T0_hat = np.fft.fft(T0)\n        \n        # Get discrete wavenumbers\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n        # Numerical dispersion relation for Central Differencing scheme\n        # omega_num = u * sin(k*dx) / dx\n        # For k=0, this is 0, so no NaN is produced.\n        omega_num = u * np.sin(k * dx) / dx\n\n        # Evolve spectral coefficients exactly in time for the semi-discrete system\n        evolution_operator = np.exp(-1j * omega_num * dt)\n        T_dt_hat = T0_hat * evolution_operator\n\n        # Inverse DFT to get solution in physical space at t=dt\n        T_dt = np.fft.ifft(T_dt_hat).real\n\n        # 3. Compute Metrics R and D\n        # Ringing Amplitude R: maximum excursion outside [0, 1]\n        R_overshoot = np.max(T_dt) - 1.0\n        R_undershoot = -np.min(T_dt)\n        R = np.max([0.0, R_overshoot, R_undershoot])\n\n        # Dispersion Metric D\n        # Exclude the k=0 (DC) mode\n        mask_nz = (k != 0)\n        k_nz = k[mask_nz]\n        T0_hat_nz = T0_hat[mask_nz]\n\n        # Spectral power of non-zero modes\n        power_nz = np.abs(T0_hat_nz)**2\n        total_power_nz = np.sum(power_nz)\n        \n        # Weights w(k) for k!=0\n        weights = power_nz / total_power_nz\n\n        # Relative phase speed error: c_num/c_true - 1 = sin(k*dx)/(k*dx) - 1\n        # np.sinc(x) is defined as sin(pi*x)/(pi*x)\n        # So, sin(k*dx)/(k*dx) is equivalent to np.sinc(k*dx/pi)\n        rel_phase_speed_error = np.sinc(k_nz * dx / np.pi) - 1.0\n\n        # Calculate D as the weighted root-mean-square of the relative error\n        D_squared = np.sum(weights * (rel_phase_speed_error**2))\n        D = np.sqrt(D_squared)\n\n        results.append([R, D])\n\n    # Format output as specified in the problem statement\n    output_str = f\"[{','.join([f'[{r[0]},{r[1]}]' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "认识到中心差分格式的缺陷后，自然会引出如何修正它的问题。本练习探讨了一种常见的实用解法：将中心差分与稳定的一阶迎风格式进行混合 。通过引导式推导，您将确定纯中心差分格式保持稳定的精确条件，并量化在不稳定情况下为保证解的物理真实性（有界性）所需的迎风格式混合比例。",
            "id": "3989762",
            "problem": "考虑一个被动标量场 $\\,\\phi(x)\\,$ 在具有恒定物性的静止介质中的稳态一维对流-扩散。该介质使用均匀网格进行离散，网格间距为 $\\,\\Delta x\\,$，横截面积为 $\\,A\\,$，分子扩散率为 $\\,\\Gamma\\,$，密度为 $\\,\\rho\\,$，速度为常数 $\\,u\\,$。控制守恒律为\n$$\\frac{d}{dx}\\!\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)-\\rho u\\,\\frac{d\\phi}{dx}=0,$$\n方程不含体积源，并具有合适的边界条件，以确保存在唯一的稳态解。令 $\\,F:=\\rho u A\\,$ 表示对流通量，$\\,D:=\\Gamma A/\\Delta x\\,$ 表示扩散传导系数。使用有限体积法 (FVM)，对以节点 $\\,P\\,$ 为中心、西侧和东侧邻居节点分别为 $\\,W\\,$ 和 $\\,E\\,$ 的通用控制体进行积分。对于控制体表面的对流通量，考虑中心差分格式 (CDS) 和迎风差分格式 (UDS) 之间的线性混合：通过混合因子 $\\,w\\in[0,1]\\,$，将 CDS 和 UDS 离散算子进行凸组合，从而获得离散格式的系数。佩克莱数 (Peclet number) 定义为 $\\,\\mathrm{Pe}:=F/D\\,$，其大小为 $\\,|\\mathrm{Pe}|=\\rho |u| \\Delta x/\\Gamma\\,$。\n\n从上述守恒律以及 $\\,F\\,$ 和 $\\,D\\,$ 的定义出发，推导节点 $\\,P\\,$ 处的离散方程，并明确求出 CDS 和 UDS 的邻点系数 $\\,a_W\\,$ 和 $\\,a_E\\,$。然后，以因子 $\\,w\\,$ 进行凸组合，构建混合格式的系数。施加系数矩阵在标准 FVM 意义下成为 $\\,\\mathrm{M}$-矩阵所需的条件（当方程写作 $\\,a_P\\phi_P=\\sum a_{nb}\\phi_{nb}\\,$ 形式时，对角元为正，邻点系数为非负，并且每行满足弱对角占优），这些条件足以保证该问题的离散解具有有界性（无非物理振荡）。\n\n以闭合形式确定最小混合因子 $\\,w_{\\min}(\\mathrm{Pe})\\,$，它作为单元佩克莱数 $\\,\\mathrm{Pe}\\,$ 的函数，能保证对于任意流动方向，系数矩阵都具有 $\\,\\mathrm{M}$-矩阵性质。将最终结果表示为单一解析表达式。无需进行数值取整。",
            "solution": "该过程始于对所提供问题陈述的验证。\n\n### 第 1 步：提取已知条件\n- **控制方程**：被动标量 $\\phi(x)$ 的稳态一维对流-扩散方程：$\\frac{d}{dx}\\!\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)-\\rho u\\,\\frac{d\\phi}{dx}=0$。\n- **物理参数**：恒定的密度 $\\rho$、恒定的速度 $u$、恒定的分子扩散率 $\\Gamma$ 和恒定的横截面积 $A$。\n- **离散化**：间距为 $\\Delta x$ 的均匀网格。在以节点 $P$ 为中心、邻居为 $W$ (西) 和 $E$ (东) 的控制体上使用有限体积法 (FVM)。\n- **定义的量**：\n    - 对流通量：$F := \\rho u A$。\n    - 扩散传导系数：$D := \\Gamma A/\\Delta x$。\n    - 单元佩克莱数：$\\mathrm{Pe} := F/D = \\rho u \\Delta x/\\Gamma$。\n- **数值格式**：\n    - 中心差分格式 (CDS)。\n    - 迎风差分格式 (UDS)。\n    - 混合格式：CDS 和 UDS 系数通过混合因子 $w \\in [0,1]$ 进行的凸组合。\n- **约束条件**：当离散方程写作 $a_P\\phi_P = \\sum a_{nb}\\phi_{nb}$ 形式时，得到的系数矩阵必须是 $\\mathrm{M}$-矩阵，这对于本问题要求非对角（邻点）系数为非负。\n- **目标**：确定最小混合因子 $w_{\\min}(\\mathrm{Pe})$，它作为单元佩克莱数 $\\mathrm{Pe}$ 的函数，能够保证对于任意流动方向，系数矩阵都具有 $\\mathrm{M}$-矩阵性质。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于基本的一维稳态对流-扩散方程，这是输运现象的基石。有限体积法、CDS、UDS、佩克莱数和 M-矩阵稳定性准则都是计算流体动力学和数值传热学中标准的、已被广泛接受的概念。该问题在科学上是合理的。\n- **适定性和完备性**：问题陈述是自洽的，提供了推导所求量 $w_{\\min}(\\mathrm{Pe})$ 所需的所有方程、定义和约束。目标定义清晰，预期有唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述，没有任何主观或模糊的术语。\n- **一致性**：所有定义都是一致的。例如，$\\mathrm{Pe} = F/D = (\\rho u A)/(\\Gamma A/\\Delta x) = \\rho u \\Delta x / \\Gamma$，这与给定的定义相匹配。\n\n### 第 3 步：结论与行动\n该问题被认为是**有效**的，因为它具有科学依据、适定性且内部一致。将进行求解。\n\n### 推导\n我们首先将控制方程在一个以节点 $P$ 为中心、长度为 $\\Delta x$、面积为 $A$ 的控制体 (CV) 上进行积分。控制体的西、东表面分别位于 $x_w$ 和 $x_e$。\n$$ \\int_{x_w}^{x_e} \\left[ \\frac{d}{dx}\\!\\left(\\Gamma A \\frac{d\\phi}{dx}\\right) - \\frac{d}{dx}(\\rho u A \\phi) \\right] dx = 0 $$\n注意，由于 $\\rho$、$u$ 和 $A$ 是常数，对流项 $\\rho u \\frac{d\\phi}{dx}$ 可以写成 $\\frac{d}{dx}(\\rho u \\phi)$。应用微积分基本定理，我们得到控制体表面的通量平衡：\n$$ \\left[ \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right]_{x_e} - \\left[ \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right]_{x_w} = 0 $$\n这些项代表穿过控制体表面的总通量（扩散通量 + 对流通量）。我们对这些项进行离散。扩散通量使用中心差分进行近似：\n$$ \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_{x_e} \\approx \\Gamma A \\frac{\\phi_E - \\phi_P}{\\Delta x} = D(\\phi_E - \\phi_P) $$\n$$ \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_{x_w} \\approx \\Gamma A \\frac{\\phi_P - \\phi_W}{\\Delta x} = D(\\phi_P - \\phi_W) $$\n对流通量为 $(\\rho u A \\phi)_{x_e} = F \\phi_e$ 和 $(\\rho u A \\phi)_{x_w} = F \\phi_w$，其中 $\\phi_e$ 和 $\\phi_w$ 是控制体表面上的标量值。积分后的方程变为：\n$$ D(\\phi_E - \\phi_P) - D(\\phi_P - \\phi_W) - (F\\phi_e - F\\phi_w) = 0 $$\n\n接下来，我们使用 CDS 和 UDS 来计算表面值 $\\phi_e$ 和 $\\phi_w$，以求得它们各自的系数。\n\n**1. 中心差分格式 (CDS)**\n在 CDS 中，表面值是线性插值的：$\\phi_e = \\frac{1}{2}(\\phi_P + \\phi_E)$ 和 $\\phi_w = \\frac{1}{2}(\\phi_W + \\phi_P)$。将它们代入通量平衡方程：\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - F\\left( \\frac{\\phi_P + \\phi_E}{2} - \\frac{\\phi_W + \\phi_P}{2} \\right) = 0 $$\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - \\frac{F}{2}(\\phi_E - \\phi_W) = 0 $$\n整理成 $a_P\\phi_P = a_W\\phi_W + a_E\\phi_E$ 的形式：\n$$ (2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E $$\nCDS 系数为：\n$$ a_{W, \\text{CDS}} = D + \\frac{F}{2} \\quad , \\quad a_{E, \\text{CDS}} = D - \\frac{F}{2} $$\n\n**2. 迎风差分格式 (UDS)**\n在 UDS 中，表面值取自上游节点。这可以使用 $\\max$ 函数紧凑地表示。离开控制体的净对流通量为：\n$$ F\\phi_e - F\\phi_w = \\left(\\max(F,0)\\phi_P + \\min(F,0)\\phi_E\\right) - \\left(\\max(F,0)\\phi_W + \\min(F,0)\\phi_P\\right) $$\n使用 $\\min(F,0) = -\\max(-F,0)$，通量平衡方程为：\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - \\left[ (\\max(F,0)-\\min(F,0))\\phi_P - \\max(F,0)\\phi_W - \\min(F,0)\\phi_E \\right] = 0 $$\n注意到 $\\max(F,0)-\\min(F,0) = \\max(F,0)+\\max(-F,0) = |F|$，我们得到：\n$$ D(\\phi_E - 2\\phi_P + \\phi_W) - |F|\\phi_P + \\max(F,0)\\phi_W - \\min(F,0)\\phi_E = 0 $$\n整理成标准形式：\n$$ (2D+|F|)\\phi_P = (D+\\max(F,0))\\phi_W + (D-\\min(F,0))\\phi_E $$\n$$ (2D+|F|)\\phi_P = (D+\\max(F,0))\\phi_W + (D+\\max(-F,0))\\phi_E $$\nUDS 系数为：\n$$ a_{W, \\text{UDS}} = D + \\max(F,0) \\quad , \\quad a_{E, \\text{UDS}} = D + \\max(-F,0) $$\n\n**3. 混合格式与 M-矩阵条件**\n混合格式的系数是一个凸组合，混合因子为 $w$：\n$$ a_W = (1-w)a_{W, \\text{CDS}} + w a_{W, \\text{UDS}} = (1-w)\\left(D+\\frac{F}{2}\\right) + w\\left(D+\\max(F,0)\\right) $$\n$$ a_E = (1-w)a_{E, \\text{CDS}} + w a_{E, \\text{UDS}} = (1-w)\\left(D-\\frac{F}{2}\\right) + w\\left(D+\\max(-F,0)\\right) $$\n简化这些表达式：\n$$ a_W = D + (1-w)\\frac{F}{2} + w\\max(F,0) $$\n$$ a_E = D - (1-w)\\frac{F}{2} + w\\max(-F,0) $$\nM-矩阵性质要求邻点系数为非负：$a_W \\ge 0$ 和 $a_E \\ge 0$。我们用 $D$ 进行归一化，并使用佩克莱数 $\\mathrm{Pe}=F/D$：\n$$ \\frac{a_W}{D} = 1 + (1-w)\\frac{\\mathrm{Pe}}{2} + w\\max(\\mathrm{Pe},0) \\ge 0 $$\n$$ \\frac{a_E}{D} = 1 - (1-w)\\frac{\\mathrm{Pe}}{2} + w\\max(-\\mathrm{Pe},0) \\ge 0 $$\n我们针对 $\\mathrm{Pe}$ 的不同符号来分析这两个不等式。\n\n- **情况 1：$\\mathrm{Pe} > 0$**\n对于 $\\mathrm{Pe} > 0$，$\\max(\\mathrm{Pe},0)=\\mathrm{Pe}$ 且 $\\max(-\\mathrm{Pe},0)=0$。\n关于 $a_W$ 的不等式变为：$1 + (1-w)\\frac{\\mathrm{Pe}}{2} + w\\mathrm{Pe} = 1 + \\frac{\\mathrm{Pe}}{2} + w\\frac{\\mathrm{Pe}}{2} = 1 + \\frac{\\mathrm{Pe}}{2}(1+w)$。由于 $\\mathrm{Pe}0$ 且 $w \\ge 0$，该式恒为正。\n关于 $a_E$ 的不等式变为：$1 - (1-w)\\frac{\\mathrm{Pe}}{2} \\ge 0$。这是约束性条件。\n$$ 1 \\ge (1-w)\\frac{\\mathrm{Pe}}{2} \\implies \\frac{2}{\\mathrm{Pe}} \\ge 1-w \\implies w \\ge 1 - \\frac{2}{\\mathrm{Pe}} $$\n\n- **情况 2：$\\mathrm{Pe}  0$**\n对于 $\\mathrm{Pe}  0$，$\\max(\\mathrm{Pe},0)=0$ 且 $\\max(-\\mathrm{Pe},0)=-\\mathrm{Pe}=|\\mathrm{Pe}|$。\n关于 $a_W$ 的不等式变为：$1 + (1-w)\\frac{\\mathrm{Pe}}{2} \\ge 0$。这是约束性条件。\n使用 $|\\mathrm{Pe}|=-\\mathrm{Pe}$：$1 - (1-w)\\frac{|\\mathrm{Pe}|}{2} \\ge 0 \\implies 1 \\ge (1-w)\\frac{|\\mathrm{Pe}|}{2} \\implies w \\ge 1 - \\frac{2}{|\\mathrm{Pe}|}$。\n关于 $a_E$ 的不等式变为：$1 - (1-w)\\frac{\\mathrm{Pe}}{2} - w\\mathrm{Pe} = 1 - \\frac{\\mathrm{Pe}}{2} - w\\frac{\\mathrm{Pe}}{2} = 1 - \\frac{\\mathrm{Pe}}{2}(1+w) = 1+\\frac{|\\mathrm{Pe}|}{2}(1+w)$。该式恒为正。\n\n**4. $w_{\\min}$ 的最终表达式**\n在两种情况（$\\mathrm{Pe}0$ 和 $\\mathrm{Pe}0$）下，条件都是 $w \\ge 1 - 2/|\\mathrm{Pe}|$。由于 $w$ 也必须是非负的，因此完整的条件是 $w \\ge \\max(0, 1 - 2/|\\mathrm{Pe}|)$。\n如果 $|\\mathrm{Pe}| \\le 2$，那么 $1-2/|\\mathrm{Pe}| \\le 0$，所以条件是 $w \\ge 0$，这对任意 $w \\in [0,1]$ 都成立。在此范围内，$w_{\\min}=0$，意味着纯 CDS 格式是稳定的。\n如果 $|\\mathrm{Pe}| > 2$，我们需要 $w \\ge 1 - 2/|\\mathrm{Pe}| > 0$。\n保证 M-矩阵性质对于任意佩克莱数 $\\mathrm{Pe}$ 都成立的最小混合因子 $w_{\\min}$ 是该条件的下界。\n因此，作为 $\\mathrm{Pe}$ 函数的 $w_{\\min}$ 的单一解析表达式为：\n$$ w_{\\min}(\\mathrm{Pe}) = \\max\\left(0, 1 - \\frac{2}{|\\mathrm{Pe}|}\\right) $$\n这个表达式正确地描述了其行为：对于低佩克莱数（$|\\mathrm{Pe}| \\le 2$），不需要迎风格式（$w_{\\min}=0$）；而对于高佩克莱数，则需要越来越大比例的迎风格式，当 $|\\mathrm{Pe}| \\to \\infty$ 时，趋近于完全迎风（$w \\to 1$）。",
            "answer": "$$\\boxed{\\max\\left(0, 1 - \\frac{2}{|\\mathrm{Pe}|}\\right)}$$"
        }
    ]
}