{
    "hands_on_practices": [
        {
            "introduction": "The concept of numerical diffusion can be elusive, as it is not a term explicitly added to a simulation code but rather an emergent property of the discretization process itself. To understand and quantify this effect, we use a powerful technique called modified equation analysis. This practice guides you through the foundational analysis of the first-order upwind scheme, revealing how the process of replacing continuous derivatives with finite differences introduces an artificial diffusion term, and allows you to derive its precise mathematical form .",
            "id": "3942223",
            "problem": "Consider the pure advection of a thermal scalar field in one spatial dimension, described by the linear advection equation $ \\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = 0 $, where $\\theta(x,t)$ is a passive temperature-like scalar, $a$ is a constant flow velocity, and $x$ and $t$ denote space and time, respectively. This equation is a standard model for convective transport in Computational Fluid Dynamics and Computational Thermal Engineering, where $\\theta$ is transported without physical diffusion.\n\nYou discretize $x$ on a uniform grid with spacing $\\Delta x$ and advance in time with a constant time step $\\Delta t$. For the case $a > 0$, you use a first-order explicit upwind scheme (forward Euler in time, first-order upwind in space), yielding the update\n$$\n\\theta_{i}^{n+1} = \\theta_{i}^{n} - C \\left( \\theta_{i}^{n} - \\theta_{i-1}^{n} \\right),\n$$\nwhere $\\theta_{i}^{n}$ approximates $\\theta(x_i, t_n)$, and the Courant–Friedrichs–Lewy (CFL) number is defined as $C = \\frac{a \\Delta t}{\\Delta x}$ with $0  C \\leq 1$ for stability.\n\nUsing only Taylor expansion and the governing continuum advection equation as the fundamental base, perform a modified-equation analysis to identify the leading-order artificial diffusion induced by the numerical scheme. Define the effective numerical diffusion coefficient $\\nu_{\\text{num}}$ as the coefficient of $\\frac{\\partial^2 \\theta}{\\partial x^2}$ in the leading-order modified equation of the form\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\nu_{\\text{num}} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{higher-order terms},\n$$\nand express $\\nu_{\\text{num}}$ as a function of $a$, $\\Delta x$, and the CFL number $C$. Provide your final answer as a single closed-form analytical expression in terms of $a$, $\\Delta x$, and $C$. Do not evaluate numerically. If one were to assign numerical values, $\\nu_{\\text{num}}$ would carry the physical unit of square meters per second, but you must provide the symbolic expression only.",
            "solution": "The problem requires a modified-equation analysis of the first-order explicit upwind scheme for the one-dimensional linear advection equation. The goal is to determine the artificial diffusion coefficient, $\\nu_{\\text{num}}$, inherent in the numerical method.\n\nThe governing continuum equation is the linear advection equation:\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = 0\n$$\nwhere $a > 0$ is a constant velocity.\n\nThe numerical scheme is the first-order explicit upwind method (Forward Time, Backward Space for $a>0$):\n$$\n\\theta_{i}^{n+1} = \\theta_{i}^{n} - C \\left( \\theta_{i}^{n} - \\theta_{i-1}^{n} \\right)\n$$\nHere, $\\theta_{i}^{n}$ is the numerical approximation of the scalar field $\\theta$ at position $x_i = i \\Delta x$ and time $t_n = n \\Delta t$. The Courant–Friedrichs–Lewy (CFL) number is $C = \\frac{a \\Delta t}{\\Delta x}$.\n\nThe analysis begins by expanding each term of the discretized equation in a Taylor series about the point $(x_i, t_n)$. We assume that $\\theta(x,t)$ is sufficiently smooth. The derivatives are evaluated at $(x_i, t_n)$.\n\nThe term $\\theta_i^{n+1}$ is expanded in time:\n$$\n\\theta_{i}^{n+1} = \\theta(x_i, t_n + \\Delta t) = \\theta_{i}^{n} + \\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\frac{(\\Delta t)^3}{6} \\frac{\\partial^3 \\theta}{\\partial t^3} + \\dots\n$$\n\nThe term $\\theta_{i-1}^{n}$ is expanded in space:\n$$\n\\theta_{i-1}^{n} = \\theta(x_i - \\Delta x, t_n) = \\theta_{i}^{n} - \\Delta x \\frac{\\partial \\theta}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 \\theta}{\\partial x^3} + \\dots\n$$\n\nSubstitute these expansions into the numerical scheme, which can be rearranged as $\\theta_i^{n+1} - \\theta_i^n = -C(\\theta_i^n - \\theta_{i-1}^n)$:\n$$\n\\left( \\theta_{i}^{n} + \\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots \\right) - \\theta_i^n = -C \\left[ \\theta_i^n - \\left( \\theta_{i}^{n} - \\Delta x \\frac{\\partial \\theta}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots \\right) \\right]\n$$\n\nSimplifying both sides:\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -C \\left( \\Delta x \\frac{\\partial \\theta}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\dots \\right)\n$$\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -C \\Delta x \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots\n$$\n\nBy definition, $C = \\frac{a \\Delta t}{\\Delta x}$, which implies $C \\Delta x = a \\Delta t$. Substituting this into the first term on the right-hand side:\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -a \\Delta t \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots\n$$\n\nDivide the entire equation by $\\Delta t$:\n$$\n\\frac{\\partial \\theta}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\mathcal{O}((\\Delta t)^2) = -a \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2 \\Delta t} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\mathcal{O}(\\Delta x^2, \\Delta t \\Delta x)\n$$\n\nThe coefficient of the second spatial derivative term can be simplified:\n$$\nC \\frac{(\\Delta x)^2}{2 \\Delta t} = \\left(\\frac{a \\Delta t}{\\Delta x}\\right) \\frac{(\\Delta x)^2}{2 \\Delta t} = \\frac{a \\Delta x}{2}\n$$\n\nSubstituting this back and rearranging the equation to match the form of the original PDE:\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = - \\frac{\\Delta t}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\frac{a \\Delta x}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\nwhere H.O.T. represents higher-order terms. This is the modified equation, but it includes a time derivative on the right-hand side. To express the error purely in terms of spatial derivatives, we must approximate $\\frac{\\partial^2 \\theta}{\\partial t^2}$.\n\nFrom the original continuum equation, $\\frac{\\partial \\theta}{\\partial t} = -a \\frac{\\partial \\theta}{\\partial x}$. We assume the numerical solution is a valid approximation, so this relation holds to leading order. We can differentiate this expression with respect to time $t$:\n$$\n\\frac{\\partial^2 \\theta}{\\partial t^2} = \\frac{\\partial}{\\partial t} \\left(-a \\frac{\\partial \\theta}{\\partial x}\\right) = -a \\frac{\\partial}{\\partial x} \\left(\\frac{\\partial \\theta}{\\partial t}\\right)\n$$\nNow, substitute $\\frac{\\partial \\theta}{\\partial t} = -a \\frac{\\partial \\theta}{\\partial x}$ again:\n$$\n\\frac{\\partial^2 \\theta}{\\partial t^2} = -a \\frac{\\partial}{\\partial x} \\left(-a \\frac{\\partial \\theta}{\\partial x}\\right) = a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}\n$$\nThe higher-order time derivatives can be similarly expressed in terms of higher-order spatial derivatives. We only need the leading-order term for this analysis.\n\nSubstitute $\\frac{\\partial^2 \\theta}{\\partial t^2} = a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}$ into the modified equation:\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = - \\frac{\\Delta t}{2} \\left(a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}\\right) + \\frac{a \\Delta x}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n\nWe can now group the coefficients of the $\\frac{\\partial^2 \\theta}{\\partial x^2}$ term:\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\left(\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n\nThis equation is in the target form $\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\nu_{\\text{num}} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}$, where the coefficient of the second spatial derivative is the numerical diffusion coefficient, $\\nu_{\\text{num}}$.\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\n$$\n\nThe problem requires this expression to be in terms of $a$, $\\Delta x$, and $C$. We factor out $\\frac{a \\Delta x}{2}$:\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right)\n$$\nRecognizing that $C = \\frac{a \\Delta t}{\\Delta x}$, we obtain the final expression:\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} (1 - C)\n$$\nThis leading-order truncation error term, which takes the form of a physical diffusion term, is known as numerical diffusion or artificial viscosity. It is responsible for the dissipative nature of the first-order upwind scheme. For the stability range $0  C \\le 1$, the coefficient $\\nu_{\\text{num}}$ is non-negative, correctly representing a diffusive process. The diffusion vanishes if and only if $C=1$, in which case the scheme is exact.",
            "answer": "$$\n\\boxed{\\frac{a \\Delta x}{2} (1 - C)}\n$$"
        },
        {
            "introduction": "After discovering that the first-order upwind scheme introduces numerical diffusion, a natural impulse is to seek a scheme that avoids this error. The second-order central difference scheme appears to be a perfect candidate, as its leading-order error is not diffusive. This exercise explores the critical trade-offs that accompany this choice, contrasting the diffusive upwind scheme with the dispersive central difference scheme to uncover the profound connection between numerical diffusion, dispersion, and the stability of the entire simulation .",
            "id": "3942275",
            "problem": "Consider the one-dimensional linear advection of a passive thermal scalar governed by the partial differential equation $u_t + a u_x = 0$, where $u(x,t)$ is the scalar field and $a>0$ is a constant advection speed. A uniform spatial grid with spacing $\\Delta x$ is used. Two explicit finite-difference spatial discretizations are considered:\n\n1. A semi-discrete central-difference in space scheme, defined by replacing $u_x$ at grid point $x_j$ with $(u_{j+1} - u_{j-1})/(2 \\Delta x)$, combined with an explicit forward time integration.\n\n2. An upwind in space scheme appropriate for $a>0$, defined by replacing $u_x$ at grid point $x_j$ with $(u_j - u_{j-1})/\\Delta x$, combined with an explicit forward time integration.\n\nStarting from the exact equation $u_t + a u_x = 0$, use Taylor-series expansions of $u(x \\pm \\Delta x, t)$ around $x$ and Fourier (von Neumann) analysis to:\n\n- Derive the leading-order modified equations for each spatial discretization by expressing the discrete spatial derivative in terms of continuous spatial derivatives, retaining terms up to $\\mathcal{O}(\\Delta x^2)$.\n- Identify and compare the leading artificial diffusion term (the term proportional to $u_{xx}$) and the leading dispersive term (the term proportional to $u_{xxx}$) in the modified equations.\n- Using Fourier analysis, compute and interpret the amplification factor for the fully discrete central-difference and upwind schemes. Discuss the stability implications of central differencing relative to upwind in terms of the Courant–Friedrichs–Lewy (CFL) number $\\nu = a \\Delta t / \\Delta x$.\n\nYour final task is to provide a single real-valued quantity: the leading artificial diffusion coefficient $D_{\\text{num}}$ (defined as the coefficient multiplying $u_{xx}$ in the modified equation) for the central-difference scheme. Express the final value of $D_{\\text{num}}$ in $\\text{m}^2/\\text{s}$. No rounding is required.",
            "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The one-dimensional linear advection equation for a passive scalar $u(x,t)$ is $u_t + a u_x = 0$, where $a > 0$ is a constant advection speed.\n-   **Grid**: A uniform spatial grid with spacing $\\Delta x$.\n-   **Scheme 1 (Central Difference)**: A semi-discrete central-difference in space scheme, where $u_x$ at grid point $x_j$ is approximated by $\\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$. This is combined with an explicit forward time integration for the fully discrete scheme.\n-   **Scheme 2 (Upwind)**: An upwind in space scheme for $a>0$, where $u_x$ at grid point $x_j$ is approximated by $\\frac{u_j - u_{j-1}}{\\Delta x}$. This is also combined with an explicit forward time integration.\n-   **Task 1**: Derive the leading-order modified equations for each spatial discretization up to $\\mathcal{O}(\\Delta x^2)$.\n-   **Task 2**: Identify and compare the leading artificial diffusion (proportional to $u_{xx}$) and dispersive (proportional to $u_{xxx}$) terms.\n-   **Task 3**: For the fully discrete schemes, compute and interpret the amplification factor using Fourier analysis and discuss stability in relation to the CFL number $\\nu = a \\Delta t / \\Delta x$.\n-   **Task 4**: Provide the value of the leading artificial diffusion coefficient, $D_{\\text{num}}$, for the central-difference scheme.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is fundamentally sound. It addresses standard, core concepts in numerical analysis for partial differential equations, specifically within computational thermal engineering and fluid dynamics. The methods of analysis (Taylor series for modified equations, von Neumann for stability) are canonical.\n-   **Well-Posed**: The problem is well-posed. The tasks are specific, and the required derivations lead to unique analytical expressions. The distinction between analyzing the spatial discretization for the modified equation and analyzing the fully discrete scheme for stability is clear and standard practice.\n-   **Objective**: The problem is stated in precise, objective, and formal mathematical language.\n\nThe problem does not exhibit any flaws. It is not unsound, incomplete, or ambiguous. The request for a real-valued quantity for the diffusion coefficient is answerable, even within a symbolic context, as the coefficient for the central-difference spatial operator is exactly zero.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution\n\nThe analysis proceeds by addressing each task stipulated in the problem statement. We begin with the derivation of the modified equations for the spatial discretizations.\n\n**Modified Equation Analysis**\n\nThe modified equation is the partial differential equation that is actually solved by the numerical scheme, including its leading-order truncation errors. The problem asks for the modified equation corresponding to the spatial discretization, which is a semi-discrete analysis.\n\n**1. Central-Difference Scheme**\n\nWe start by analyzing the central-difference approximation for the spatial derivative, $u_x$. The Taylor series expansions of $u(x \\pm \\Delta x, t)$ around the point $(x,t)$ are:\n$$u(x+\\Delta x, t) = u(x,t) + (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2!} u_{xx} + \\frac{(\\Delta x)^3}{3!} u_{xxx} + \\frac{(\\Delta x)^4}{4!} u_{xxxx} + \\mathcal{O}(\\Delta x^5)$$\n$$u(x-\\Delta x, t) = u(x,t) - (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2!} u_{xx} - \\frac{(\\Delta x)^3}{3!} u_{xxx} + \\frac{(\\Delta x)^4}{4!} u_{xxxx} - \\mathcal{O}(\\Delta x^5)$$\nwhere the subscripts on $u$ denote partial differentiation with respect to $x$. At a grid point $x_j$, we have $u_j = u(x_j, t)$, $u_{j+1} = u(x_j+\\Delta x, t)$, and $u_{j-1} = u(x_j-\\Delta x, t)$.\n\nThe central-difference operator is $\\delta_{CD}(u_j) = \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$. Subtracting the second expansion from the first yields:\n$$u_{j+1} - u_{j-1} = 2 (\\Delta x) u_x + 2 \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^5)$$\nDividing by $2 \\Delta x$, we obtain the expression for the discretized derivative in terms of the continuous derivatives:\n$$\\frac{u_{j+1} - u_{j-1}}{2 \\Delta x} = u_x + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\nThe semi-discrete equation is $u_t + a \\left( \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x} \\right) = 0$. Substituting the above expression gives the modified equation:\n$$u_t + a \\left( u_x + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right) = 0$$\n$$u_t + a u_x = -a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\nThe leading-order error term is $-a \\frac{\\Delta x^2}{6} u_{xxx}$.\n\n**2. Upwind Scheme (for $a>0$)**\n\nFor $a>0$, the upwind scheme uses the first-order backward difference, $\\delta_{UW}(u_j) = \\frac{u_j - u_{j-1}}{\\Delta x}$. Using the Taylor expansion for $u_{j-1} = u(x_j-\\Delta x, t)$:\n$$u_j - u_{j-1} = u_j - \\left( u_j - (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right)$$\n$$u_j - u_{j-1} = (\\Delta x) u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} - \\mathcal{O}(\\Delta x^4)$$\nDividing by $\\Delta x$:\n$$\\frac{u_j - u_{j-1}}{\\Delta x} = u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\nThe semi-discrete equation is $u_t + a \\left( \\frac{u_j - u_{j-1}}{\\Delta x} \\right) = 0$. Substituting the expression gives the modified equation:\n$$u_t + a \\left( u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right) = 0$$\nRetaining terms up to $\\mathcal{O}(\\Delta x^2)$, the modified equation is:\n$$u_t + a u_x = a \\frac{\\Delta x}{2} u_{xx} - a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n\n**Comparison of Artificial Diffusion and Dispersion**\n\n-   **Artificial Diffusion ($u_{xx}$ term)**:\n    -   For the central-difference spatial operator, the coefficient of the $u_{xx}$ term is $0$. This scheme is non-dissipative at the leading order.\n    -   For the upwind spatial operator, the leading error term is $a \\frac{\\Delta x}{2} u_{xx}$. The coefficient, $D_{\\text{num}} = a \\frac{\\Delta x}{2}$, is the artificial diffusion or numerical viscosity. This term is of order $\\mathcal{O}(\\Delta x)$ and is responsible for damping numerical oscillations, but at the cost of smearing sharp gradients.\n\n-   **Artificial Dispersion ($u_{xxx}$ term)**:\n    -   For the central-difference scheme, the leading error term is $-a \\frac{\\Delta x^2}{6} u_{xxx}$. This is a dispersive term of order $\\mathcal{O}(\\Delta x^2)$. It causes different Fourier components of the solution to travel at different speeds, leading to spurious oscillations (wiggles) in the numerical solution, particularly near sharp gradients.\n    -   For the upwind scheme, there is also a dispersive term, $-a \\frac{\\Delta x^2}{6} u_{xxx}$, of order $\\mathcal{O}(\\Delta x^2)$. However, this is a higher-order term compared to its dominant diffusion term.\n\nIn summary, the central difference scheme is second-order accurate in space ($\\mathcal{O}(\\Delta x^2)$) and purely dispersive at this order. The upwind scheme is first-order accurate in space ($\\mathcal{O}(\\Delta x)$) and is dominated by its dissipative error.\n\n**Fourier (von Neumann) Stability Analysis**\n\nNow we analyze the fully discrete schemes, combining the spatial operators with explicit forward time integration (Forward-Time Euler).\n\n**1. Central-Difference Scheme (FTCS: Forward Time, Central Space)**\n\nThe fully discrete equation is $u_j^{n+1} = u_j^n - a \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^n - u_{j-1}^n)$.\nLetting $\\nu = \\frac{a \\Delta t}{\\Delta x}$ be the Courant number, this is $u_j^{n+1} = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)$.\nWe seek a solution of the form $u_j^n = G^n e^{i k x_j}$, where $k$ is the wavenumber and $G$ is the amplification factor.\n$$G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - \\frac{\\nu}{2} G^n (e^{i k (j+1) \\Delta x} - e^{i k (j-1) \\Delta x})$$\nDividing by $G^n e^{i k j \\Delta x}$:\n$$G = 1 - \\frac{\\nu}{2} (e^{i k \\Delta x} - e^{-i k \\Delta x}) = 1 - \\frac{\\nu}{2} (2i \\sin(k \\Delta x)) = 1 - i \\nu \\sin(k \\Delta x)$$\nThe stability requires $|G| \\leq 1$. The magnitude squared of the amplification factor is:\n$$|G|^2 = 1^2 + (-\\nu \\sin(k \\Delta x))^2 = 1 + \\nu^2 \\sin^2(k \\Delta x)$$\nFor any $\\nu > 0$ and any $k \\Delta x$ not a multiple of $\\pi$, we have $\\nu^2 \\sin^2(k \\Delta x) > 0$. Thus, $|G|^2 > 1$, and $|G| > 1$.\n**Conclusion**: The FTCS scheme for the linear advection equation is unconditionally unstable. The absence of a numerical dissipation mechanism in the spatial discretization leads to a scheme where all wave components are amplified, causing exponential error growth.\n\n**2. Upwind Scheme (FTBS: Forward Time, Backward Space for $a>0$)**\n\nThe fully discrete equation is $u_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n) = u_j^n - \\nu (u_j^n - u_{j-1}^n)$.\nSubstituting $u_j^n = G^n e^{i k x_j}$:\n$$G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - \\nu G^n (e^{i k j \\Delta x} - e^{i k (j-1) \\Delta x})$$\n$$G = 1 - \\nu (1 - e^{-i k \\Delta x})$$\nLet $\\theta = k \\Delta x$. Then $G = 1 - \\nu (1 - \\cos(\\theta) + i \\sin(\\theta)) = (1 - \\nu + \\nu\\cos\\theta) - i \\nu \\sin\\theta$.\nThe magnitude squared is:\n$$|G|^2 = (1 - \\nu + \\nu\\cos\\theta)^2 + (-\\nu \\sin\\theta)^2$$\n$$|G|^2 = (1-\\nu)^2 + 2\\nu(1-\\nu)\\cos\\theta + \\nu^2\\cos^2\\theta + \\nu^2\\sin^2\\theta$$\n$$|G|^2 = 1 - 2\\nu + \\nu^2 + 2\\nu\\cos\\theta - 2\\nu^2\\cos\\theta + \\nu^2$$\n$$|G|^2 = 1 - 2\\nu(1-\\cos\\theta) + 2\\nu^2(1-\\cos\\theta) = 1 - 2\\nu(1-\\nu)(1-\\cos\\theta)$$\nUsing the identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$:\n$$|G|^2 = 1 - 4\\nu(1-\\nu)\\sin^2(k\\Delta x/2)$$\nFor stability, we require $|G|^2 \\leq 1$, which means $-4\\nu(1-\\nu)\\sin^2(k\\Delta x/2) \\leq 0$. Since $\\sin^2(k\\Delta x/2)$ is non-negative, this condition simplifies to $\\nu(1-\\nu) \\ge 0$.\nGiven $a, \\Delta t, \\Delta x > 0$, we have $\\nu > 0$. The stability condition thus becomes $1-\\nu \\ge 0$, or $\\nu \\le 1$.\n**Conclusion**: The FTBS upwind scheme is conditionally stable, requiring the CFL number to be in the range $0 \\le \\nu \\le 1$. The inherent numerical diffusion of the upwind operator, $D_{\\text{num}} = a \\frac{\\Delta x}{2} (1-\\nu)$ for the fully discrete scheme, provides a stabilizing effect that is absent in the central-difference scheme.\n\n**Final Task: Diffusion Coefficient for Central-Difference Scheme**\n\nThe final task is to provide the leading artificial diffusion coefficient $D_{\\text{num}}$ for the central-difference scheme. As per the problem's explicit instruction to \"Derive the leading-order modified equations for each **spatial discretization**\", we refer to the semi-discrete analysis.\n\nThe modified equation for the semi-discrete central-difference scheme is:\n$$u_t + a u_x = -a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\nThe artificial diffusion term is the term proportional to $u_{xx}$. In this equation, the coefficient of the $u_{xx}$ term is exactly zero.\nTherefore, the leading artificial diffusion coefficient $D_{\\text{num}}$ is $0$. The units of a diffusion coefficient are length squared per time, which in SI units is $\\text{m}^2/\\text{s}$. The value is thus $0~\\text{m}^2/\\text{s}$.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Theoretical analysis provides the \"why\" and \"how\" of numerical diffusion, but a computational experiment is essential to see its practical impact. This hands-on coding practice utilizes the classic rotating slotted cylinder benchmark, a rigorous test for advection algorithms. By implementing and comparing a highly diffusive first-order scheme against a modern, high-resolution TVD scheme, you will directly visualize and quantify how numerical diffusion smears sharp gradients and how more advanced methods are designed to mitigate this effect, bringing the abstract concepts of the previous exercises to life .",
            "id": "3942241",
            "problem": "Consider the two-dimensional advection of a passive scalar field, representing a normalized temperature-like quantity, under a divergence-free solid-body rotation. The governing equation for the scalar field $\\phi(x,y,t)$ is the conservation of a passively advected quantity,\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\nabla \\cdot \\left( \\mathbf{u} \\phi \\right) = 0,\n$$\nwhere $\\mathbf{u}(x,y) = ( u(x,y), v(x,y) )$ is the velocity field. Incompressible solid-body rotation about the center $(x_c,y_c)=(0.5,0.5)$ is modeled by\n$$\nu(x,y) = -\\omega ( y - y_c ), \\quad v(x,y) = \\omega ( x - x_c ),\n$$\nwith constant angular velocity $\\omega$. Assume $\\omega = 2\\pi~\\mathrm{rad/s}$ so that the rotation period is exactly $T = 1.0~\\mathrm{s}$. The computational domain is the unit square $[0,1]\\times[0,1]$ with periodic boundary conditions in both directions, and a uniform Cartesian grid of $N_x = N_y$ points with spacing $\\Delta x = \\Delta y = 1/N_x$.\n\nThe initial condition is a slotted cylinder defined as follows. Let $\\alpha$ be a grid-relative orientation angle in radians. Define rotated coordinates about the center by\n$$\n\\begin{pmatrix}\nx' \\\\\ny'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\cos \\alpha  \\sin \\alpha \\\\\n- \\sin \\alpha  \\cos \\alpha\n\\end{pmatrix}\n\\begin{pmatrix}\nx - x_c \\\\\ny - y_c\n\\end{pmatrix}.\n$$\nLet the cylinder radius be $R = 0.25$, and the slot width be $w = 0.05$. The initial scalar field is\n$$\n\\phi(x,y,0) =\n\\begin{cases}\n1,  \\text{if } x'^2 + y'^2 \\le R^2 \\text{ and } |x'|  \\frac{w}{2}, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nThis creates a disk of radius $R$ centered at $\\left(0.5,0.5\\right)$ with a rectangular slot of width $w$ aligned with the $y'$-axis, cutting across its diameter. The rotation angle $\\alpha$ controls the orientation of the slot relative to the grid axes.\n\nUnder the continuous model and perfect numerical transport, the slotted cylinder returns to its initial shape after one full rotation at time $T$. In practice, discretization induces artificial (numerical) diffusion and grid-orientation effects, which smear sharp features such as the slot edges. Your task is to quantify the change in slot sharpness after one rotation for different numerical schemes and orientations.\n\nDefine the slot sharpness metric at time $t$ as the mean interface fuzziness near both slot edges:\n$$\nS(t) = \\frac{1}{M} \\sum_{(i,j)\\in \\mathcal{E}} \\left[ 2 \\,\\min\\left(\\phi_{i,j}(t), 1 - \\phi_{i,j}(t)\\right) \\right],\n$$\nwhere $\\mathcal{E}$ is the set of grid points lying within a band of half-thickness $\\delta = 2\\Delta x$ around the two slot-edge lines $x' = \\pm \\frac{w}{2}$, restricted to points inside the cylinder but outside the slot interior, and $M$ is the number of points in $\\mathcal{E}$. The function $\\phi_{i,j}(t)$ is the discrete scalar field at grid point $(i,j)$. Initially, $S(0)=0$ by construction because $\\phi(x,y,0)\\in\\{0,1\\}$. The quantity of interest is the change in slot sharpness after one rotation,\n$$\n\\Delta S = S(T) - S(0) = S(T),\n$$\nwhich is dimensionless.\n\nImplement two explicit finite-volume style schemes with periodic boundary conditions:\n\n1. A first-order donor-cell upwind method in conservative flux form for variable velocities, updating $\\phi$ using face fluxes $F = u\\phi$ and $G = v\\phi$ with upwinded states.\n\n2. A second-order Total Variation Diminishing (TVD) method using a minmod slope limiter, applied dimensionally by Strang splitting: perform a half-step in $x$, a full step in $y$, and a half-step in $x$ for each full time step. In each one-dimensional sweep, reconstruct left/right face states with the minmod limiter and use an upwind numerical flux $F = u\\phi^{\\text{upwind}}$, $G = v\\phi^{\\text{upwind}}$.\n\nUse a fixed Courant number $\\text{CFL} = 0.5$ and choose the time step $\\Delta t$ to satisfy stability based on the maximum magnitudes of $u$ and $v$ over the grid,\n$$\n\\Delta t = \\mathrm{CFL} \\cdot \\min\\left( \\frac{\\Delta x}{\\max|u|}, \\frac{\\Delta y}{\\max|v|} \\right),\n$$\nand integrate to $T=1.0~\\mathrm{s}$. Angles must be interpreted in radians. No physical units are required in the outputs; results are dimensionless floats.\n\nTest Suite:\n- Case 1: $N_x = 64$, scheme = upwind, $\\alpha = 0~\\mathrm{rad}$.\n- Case 2: $N_x = 64$, scheme = upwind, $\\alpha = \\frac{\\pi}{4}~\\mathrm{rad}$.\n- Case 3: $N_x = 64$, scheme = TVD (minmod via Strang splitting), $\\alpha = 0~\\mathrm{rad}$.\n- Case 4: $N_x = 64$, scheme = TVD (minmod via Strang splitting), $\\alpha = \\frac{\\pi}{4}~\\mathrm{rad}$.\n\nYour program should compute $\\Delta S$ for each case. The required final output format is a single line containing the four results, as a comma-separated list of floats rounded to six decimal places, enclosed in square brackets, for example,\n`[result_1,result_2,result_3,result_4]`.",
            "solution": "The user-provided problem has been analyzed and is deemed valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically the numerical solution of the advection equation. The problem is well-posed, with all necessary data, initial conditions, boundary conditions, and definitions provided. The language is objective and the requirements are specific and formalizable.\n\nThe task is to simulate the advection of a passive scalar field $\\phi$ representing a slotted cylinder under solid-body rotation and to quantify the numerical diffusion, or \"fuzziness,\" of the slot after one full rotation. This will be done for two different numerical schemes (first-order upwind and second-order TVD) and two initial orientations of the slot.\n\n**1. Governing Equation and Discretization**\n\nThe governing equation is the two-dimensional advection equation in conservative form:\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (u\\phi)}{\\partial x} + \\frac{\\partial (v\\phi)}{\\partial y} = 0\n$$\nThe computational domain is the unit square $[0,1]\\times[0,1]$, discretized into a uniform Cartesian grid of $N_x \\times N_y$ cells, where $N_x = N_y$. The grid spacing is $\\Delta x = \\Delta y = 1/N_x$. The scalar field $\\phi_{i,j}^n$ represents the cell-averaged value in cell $(i,j)$ at time step $n$. The velocity field $\\mathbf{u}=(u,v)$ is defined at cell centers.\n\nA finite volume discretization gives the update formula:\n$$\n\\phi_{i,j}^{n+1} = \\phi_{i,j}^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2, j} - F_{i-1/2, j} \\right) - \\frac{\\Delta t}{\\Delta y} \\left( G_{i, j+1/2} - G_{i, j-1/2} \\right)\n$$\nwhere $F$ and $G$ are the numerical fluxes in the $x$ and $y$ directions, respectively, evaluated at the cell faces.\n\n**2. Grid, Velocity Field, and Time Step**\n\nThe grid cell centers are located at $(x_i, y_j) = ((i+0.5)\\Delta x, (j+0.5)\\Delta y)$ for $i,j = 0, \\dots, N_x-1$. The velocity field for solid-body rotation about $(x_c, y_c) = (0.5, 0.5)$ with angular velocity $\\omega = 2\\pi$ rad/s is:\n$$\nu(x,y) = -2\\pi (y - 0.5), \\quad v(x,y) = 2\\pi (x - 0.5)\n$$\nThis field is evaluated at each cell center.\nThe time step $\\Delta t$ is fixed based on a Courant-Friedrichs-Lewy (CFL) condition:\n$$\n\\Delta t = \\mathrm{CFL} \\cdot \\min\\left( \\frac{\\Delta x}{\\max|u|}, \\frac{\\Delta y}{\\max|v|} \\right)\n$$\nwhere $\\text{CFL}=0.5$. The maximum velocity components occur at the corners of the domain, e.g., at $(0,0)$, where $u = -2\\pi(-0.5) = \\pi$ and $v = 2\\pi(-0.5) = -\\pi$. Thus, $\\max|u| = \\max|v| = \\pi$. Since $\\Delta x = \\Delta y$, the time step simplifies to $\\Delta t = 0.5 \\frac{\\Delta x}{\\pi}$. Integration proceeds for a total time of $T=1.0$s. A variable final time step is used to ensure the simulation ends precisely at $T$.\n\n**3. Initial Condition**\n\nThe initial condition is a slotted cylinder. For each cell center $(x,y)$, we compute rotated coordinates $(x', y')$ for a given orientation angle $\\alpha$:\n$$\nx' = (x - x_c)\\cos\\alpha + (y - y_c)\\sin\\alpha \\\\\ny' = -(x - x_c)\\sin\\alpha + (y - y_c)\\cos\\alpha\n$$\nThe scalar field $\\phi(x,y,0)$ is set to $1$ if the point is inside a cylinder of radius $R=0.25$ but outside a central slot of width $w=0.05$ (i.e., $x'^2+y'^2 \\le R^2$ and $|x'| > w/2$), and $0$ otherwise.\n\n**4. Numerical Schemes**\n\n**Scheme 1: First-Order Donor-Cell Upwind**\nThis scheme is explicitly implemented in its two-dimensional conservative form. The numerical fluxes are determined by the direction of the velocity at each cell face. The velocity at a cell face is computed by averaging the velocities of the two adjacent cell centers. For the face between cells $(i,j)$ and $(i+1,j)$, the flux is:\n$$\nF_{i+1/2, j} = u_{i+1/2, j} \\times \\begin{cases} \\phi_{i,j},  \\text{if } u_{i+1/2, j} \\ge 0 \\\\ \\phi_{i+1,j},  \\text{if } u_{i+1/2, j}  0 \\end{cases}\n$$\nThis can be written compactly using $u^+ = \\max(u, 0)$ and $u^- = \\min(u, 0)$:\n$$\nF_{i+1/2, j} = u_{i+1/2, j}^+ \\phi_{i,j} + u_{i+1/2, j}^- \\phi_{i+1,j}\n$$\nA similar expression holds for the flux $G_{i, j+1/2}$ in the $y$ direction. Periodic boundary conditions are handled by appropriate indexing, e.g., using rolled arrays.\n\n**Scheme 2: Second-Order TVD with Minmod Limiter**\nThis scheme achieves second-order accuracy in space while preventing spurious oscillations by using a slope limiter. The update is performed via Strang splitting, decomposing the 2D problem into a sequence of 1D advection steps:\n$$\n\\phi^{n+1} = L_x(\\Delta t/2) L_y(\\Delta t) L_x(\\Delta t/2) \\phi^n\n$$\nEach 1D operator, e.g., $L_x(\\Delta t)$, solves $\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (u\\phi)}{\\partial x} = 0$ for time $\\Delta t$.\nFor the 1D update in $x$, $\\phi_i^{n+1} = \\phi_i^n - \\frac{\\Delta t}{\\Delta x}(F_{i+1/2}-F_{i-1/2})$, the flux $F_{i+1/2}$ is computed using high-order reconstructed states at the face, $\\phi^L$ and $\\phi^R$:\n$$\nF_{i+1/2} = u_{i+1/2}^+ \\phi_{i+1/2}^L + u_{i+1/2}^- \\phi_{i+1/2}^R\n$$\nThe left and right states are reconstructed from cell-average values using a limited slope $\\sigma_i$:\n$$\n\\phi_{i+1/2}^L = \\phi_i + \\frac{1}{2}\\sigma_i, \\quad \\phi_{i+1/2}^R = \\phi_{i+1} - \\frac{1}{2}\\sigma_{i+1}\n$$\nThe minmod slope limiter prevents overshoots:\n$$\n\\sigma_i = \\text{minmod}(\\phi_{i+1}-\\phi_i, \\phi_i-\\phi_{i-1})\n$$\nwhere $\\text{minmod}(a,b) = \\frac{1}{2}(\\text{sgn}(a)+\\text{sgn}(b))\\min(|a|,|b|)$. This function returns the argument with the smallest absolute value if both arguments have the same sign, and zero otherwise. The same procedure is applied for the $y$ direction.\n\n**5. Slot Sharpness Metric**\nAfter integrating to $T=1.0$s, the final scalar field $\\phi(T)$ is analyzed. The sharpness metric $\\Delta S = S(T)$ is calculated. First, the set of grid points $\\mathcal{E}$ is identified. These are points whose initial rotated coordinates $(x',y')$ fall within the cylinder body but also in a narrow band of half-thickness $\\delta = 2\\Delta x$ just outside the original slot edges. The conditions for a grid point to be in $\\mathcal{E}$ are:\n1. $x'^2+y'^2 \\le R^2$\n2. $|x'| > w/2$ AND $|x'| \\le w/2 + \\delta$\n\nThe sharpness is the average \"fuzziness\" over these points:\n$$\nS(T) = \\frac{1}{M} \\sum_{(i,j)\\in \\mathcal{E}} 2 \\,\\min\\left(\\phi_{i,j}(T), 1 - \\phi_{i,j}(T)\\right)\n$$\nwhere $M$ is the number of points in $\\mathcal{E}$. This metric is $0$ for a perfectly sharp interface ($\\phi \\in \\{0,1\\}$) and increases as the profile becomes smeared.",
            "answer": "$$\n\\boxed{[0.530968, 0.669894, 0.100913, 0.272186]}\n$$"
        }
    ]
}