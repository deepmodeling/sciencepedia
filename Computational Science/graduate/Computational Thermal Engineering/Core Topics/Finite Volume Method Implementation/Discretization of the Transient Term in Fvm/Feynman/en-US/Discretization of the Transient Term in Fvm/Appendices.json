{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the Finite Volume Method (FVM) is its direct application of physical conservation laws to discrete volumes. This first practice grounds your understanding by tasking you with deriving the transient term from first principles for a control volume with spatially varying material properties. By calculating the effective heat capacity for a heterogeneous material, you will connect the abstract integration process to a concrete engineering scenario .",
            "id": "3948677",
            "problem": "Consider unsteady heat conduction in a heterogeneous solid without bulk motion, governed at the local level by the balance of thermal energy. Let $P$ be a control volume used in a cell-centered Finite Volume Method (FVM). The transient term to be discretized is the space-time integral of the local storage rate. Assume that the volumetric heat capacity $\\rho c_p$ may vary spatially within $P$ but is constant in time over a single time step $\\left[t^n, t^{n+1}\\right]$, and that the cell-centered temperature field is approximated as spatially uniform within $P$ at $t^n$ and at $t^{n+1}$ (i.e., $T(\\boldsymbol{x}, t^n) \\approx T_P^n$ and $T(\\boldsymbol{x}, t^{n+1}) \\approx T_P^{n+1}$ for all $\\boldsymbol{x} \\in V_P$).\n\n1) Starting from conservation of energy for the control volume $P$, integrate the transient storage term over space and time to derive a discrete transient contribution of the form $C_P \\left(T_P^{n+1} - T_P^n\\right)$, and identify an explicit expression for $C_P$ in terms of spatial integrals of $\\rho c_p$ over $V_P$ and the time step $\\Delta t = t^{n+1}-t^n$. Your derivation must begin from the integral statement of the transient storage and proceed by mathematically justified approximations consistent with the assumptions above.\n\n2) Now specialize to a rectangular control volume centered at $(x_c,y_c,z_c)$ with edge lengths $\\Delta x$, $\\Delta y$, $\\Delta z$, so that $V_P = \\Delta x\\,\\Delta y\\,\\Delta z$ and the local coordinates $(\\xi,\\eta,\\zeta) \\equiv (x-x_c, y-y_c, z-z_c)$ each range over symmetric intervals $\\xi \\in [-\\Delta x/2, \\Delta x/2]$, $\\eta \\in [-\\Delta y/2, \\Delta y/2]$, $\\zeta \\in [-\\Delta z/2, \\Delta z/2]$. Suppose the spatial variation of the volumetric heat capacity within $P$ is given by the polynomial\n$$\n\\rho c_p(x,y,z) \\;=\\; A_0 \\;+\\; A_1\\,\\xi \\;+\\; A_2\\,\\eta \\;+\\; A_3\\,\\zeta \\;+\\; A_4\\,\\xi^2 \\;+\\; A_5\\,\\eta^2 \\;+\\; A_6\\,\\zeta^2 \\;+\\; A_7\\,\\xi\\eta \\;+\\; A_8\\,\\eta\\zeta \\;+\\; A_9\\,\\zeta\\xi,\n$$\nwith the coefficients and dimensions\n$$\nA_0 = 2.20\\times 10^6\\ \\text{J m}^{-3}\\text{K}^{-1},\\quad A_1 = 1.50\\times 10^5\\ \\text{J m}^{-4}\\text{K}^{-1},\\quad A_2 = -8.00\\times 10^4\\ \\text{J m}^{-4}\\text{K}^{-1},\n$$\n$$\nA_3 = 3.00\\times 10^4\\ \\text{J m}^{-4}\\text{K}^{-1},\\quad A_4 = 8.00\\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1},\\quad A_5 = -3.00\\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1},\n$$\n$$\nA_6 = 5.00\\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1},\\quad A_7 = 2.00\\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1},\\quad A_8 = -1.00\\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1},\\quad A_9 = 0.50\\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1},\n$$\nand\n$$\n\\Delta x = 0.020\\ \\text{m},\\quad \\Delta y = 0.010\\ \\text{m},\\quad \\Delta z = 0.015\\ \\text{m},\\quad \\Delta t = 0.50\\ \\text{s}.\n$$\nUsing your result from part 1), evaluate the spatial average implied by your derivation for this polynomial field and compute the corresponding discrete transient coefficient $C_P$. Round your final numerical result for $C_P$ to six significant figures. Express your final answer in $\\text{W K}^{-1}$.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on the fundamental principles of energy conservation and standard practices in the Finite Volume Method (FVM) for computational heat transfer. The provided data are complete, dimensionally consistent, and physically plausible.\n\n### Part 1: Derivation of the Discrete Transient Term\n\nThe local energy conservation equation for unsteady heat conduction in a solid without internal heat generation is given by:\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T)\n$$\nwhere $\\rho c_p$ is the volumetric heat capacity, $T$ is the temperature, and $k$ is the thermal conductivity. In the Finite Volume Method, this equation is integrated over a control volume $V_P$ and a time interval $\\Delta t = t^{n+1} - t^n$. Focusing on the transient (storage) term, we start by integrating the local storage rate, $\\rho c_p \\frac{\\partial T}{\\partial t}$, over the control volume $V_P$ and the time interval $[t^n, t^{n+1}]$. This gives the total change in stored energy, $\\Delta E_P$, within the control volume over one time step.\n$$\n\\Delta E_P = \\int_{t^n}^{t^{n+1}} \\left( \\int_{V_P} \\rho c_p(\\boldsymbol{x}) \\frac{\\partial T(\\boldsymbol{x}, t)}{\\partial t} dV \\right) dt\n$$\nThe problem states that $\\rho c_p$ is constant in time over the interval, so it depends only on the spatial coordinate $\\boldsymbol{x}$. We can swap the order of integration (by Fubini's theorem) and move $\\rho c_p(\\boldsymbol{x})$ outside the time integral:\n$$\n\\Delta E_P = \\int_{V_P} \\rho c_p(\\boldsymbol{x}) \\left( \\int_{t^n}^{t^{n+1}} \\frac{\\partial T(\\boldsymbol{x}, t)}{\\partial t} dt \\right) dV\n$$\nThe inner integral with respect to time evaluates to the change in temperature at each point $\\boldsymbol{x}$:\n$$\n\\int_{t^n}^{t^{n+1}} \\frac{\\partial T(\\boldsymbol{x}, t)}{\\partial t} dt = T(\\boldsymbol{x}, t^{n+1}) - T(\\boldsymbol{x}, t^n)\n$$\nSubstituting this back into the expression for $\\Delta E_P$:\n$$\n\\Delta E_P = \\int_{V_P} \\rho c_p(\\boldsymbol{x}) \\left[ T(\\boldsymbol{x}, t^{n+1}) - T(\\boldsymbol{x}, t^n) \\right] dV\n$$\nNow, we apply the FVM approximation that the temperature field is spatially uniform within the control volume $V_P$ at the beginning and end of the time step:\n$$\nT(\\boldsymbol{x}, t^n) \\approx T_P^n \\quad \\text{and} \\quad T(\\boldsymbol{x}, t^{n+1}) \\approx T_P^{n+1} \\quad \\text{for all } \\boldsymbol{x} \\in V_P\n$$\nWith this approximation, the temperature difference $(T_P^{n+1} - T_P^n)$ is a constant with respect to the spatial integration and can be factored out of the integral:\n$$\n\\Delta E_P \\approx \\int_{V_P} \\rho c_p(\\boldsymbol{x}) \\left( T_P^{n+1} - T_P^n \\right) dV = \\left( T_P^{n+1} - T_P^n \\right) \\int_{V_P} \\rho c_p(\\boldsymbol{x}) dV\n$$\nThe discretized transient term that appears in the energy balance equation is the time-averaged rate of change of stored energy, which is approximated as $\\frac{\\Delta E_P}{\\Delta t}$. Therefore, the discrete transient contribution is:\n$$\n\\text{Transient Term} = \\frac{\\Delta E_P}{\\Delta t} = \\frac{1}{\\Delta t} \\left( \\int_{V_P} \\rho c_p(\\boldsymbol{x}) dV \\right) \\left( T_P^{n+1} - T_P^n \\right)\n$$\nBy comparing this expression with the desired form $C_P \\left(T_P^{n+1} - T_P^n\\right)$, we can identify the coefficient $C_P$ as:\n$$\nC_P = \\frac{1}{\\Delta t} \\int_{V_P} \\rho c_p(\\boldsymbol{x}) dV\n$$\n\n### Part 2: Evaluation of the Coefficient $C_P$\n\nTo evaluate $C_P$, we must first compute the integral of the spatially varying volumetric heat capacity, $\\rho c_p$, over the specified rectangular control volume $V_P$. The control volume is defined by $\\xi \\in [-\\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$, $\\eta \\in [-\\frac{\\Delta y}{2}, \\frac{\\Delta y}{2}]$, and $\\zeta \\in [-\\frac{\\Delta z}{2}, \\frac{\\Delta z}{2}]$. The integral is:\n$$\n\\int_{V_P} \\rho c_p(\\boldsymbol{x}) dV = \\int_{-\\Delta z/2}^{\\Delta z/2} \\int_{-\\Delta y/2}^{\\Delta y/2} \\int_{-\\Delta x/2}^{\\Delta x/2} \\rho c_p(\\xi, \\eta, \\zeta) \\, d\\xi \\, d\\eta \\, d\\zeta\n$$\nThe polynomial for $\\rho c_p$ is given as:\n$$\n\\rho c_p = A_0 + A_1\\xi + A_2\\eta + A_3\\zeta + A_4\\xi^2 + A_5\\eta^2 + A_6\\zeta^2 + A_7\\xi\\eta + A_8\\eta\\zeta + A_9\\zeta\\xi\n$$\nWe integrate this polynomial term-by-term. Due to the symmetry of the integration domain about $\\xi=0$, $\\eta=0$, and $\\zeta=0$, any term containing an odd power of $\\xi$, $\\eta$, or $\\zeta$ will integrate to zero. This includes the terms with coefficients $A_1$, $A_2$, $A_3$, $A_7$, $A_8$, and $A_9$. The only terms that yield a non-zero result are the constant and the pure quadratic terms:\n$$\n\\int_{V_P} \\rho c_p dV = \\int_{V_P} (A_0 + A_4\\xi^2 + A_5\\eta^2 + A_6\\zeta^2) dV\n$$\nLet's evaluate the integral for each of these terms:\n$$\n\\int_{V_P} A_0 \\, dV = A_0 \\int_{-\\Delta z/2}^{\\Delta z/2} \\int_{-\\Delta y/2}^{\\Delta y/2} \\int_{-\\Delta x/2}^{\\Delta x/2} d\\xi d\\eta d\\zeta = A_0 \\Delta x \\Delta y \\Delta z = A_0 V_P\n$$\n$$\n\\int_{V_P} A_4\\xi^2 \\, dV = A_4 \\left(\\int_{-\\Delta x/2}^{\\Delta x/2} \\xi^2 d\\xi\\right) \\left(\\int_{-\\Delta y/2}^{\\Delta y/2} d\\eta\\right) \\left(\\int_{-\\Delta z/2}^{\\Delta z/2} d\\zeta\\right) = A_4 \\left[\\frac{\\xi^3}{3}\\right]_{-\\Delta x/2}^{\\Delta x/2} \\Delta y \\Delta z = A_4 \\frac{(\\Delta x)^3}{12} \\Delta y \\Delta z = A_4 \\frac{(\\Delta x)^2}{12} V_P\n$$\nBy similar logic for the $\\eta^2$ and $\\zeta^2$ terms:\n$$\n\\int_{V_P} A_5\\eta^2 \\, dV = A_5 \\frac{(\\Delta y)^2}{12} V_P \\quad \\text{and} \\quad \\int_{V_P} A_6\\zeta^2 \\, dV = A_6 \\frac{(\\Delta z)^2}{12} V_P\n$$\nSumming these contributions, we find the total integral:\n$$\n\\int_{V_P} \\rho c_p dV = \\left( A_0 + A_4 \\frac{(\\Delta x)^2}{12} + A_5 \\frac{(\\Delta y)^2}{12} + A_6 \\frac{(\\Delta z)^2}{12} \\right) V_P\n$$\nThe expression in the parenthesis corresponds to the volume-averaged volumetric heat capacity, $\\overline{(\\rho c_p)}_{V_P}$:\n$$\n\\overline{(\\rho c_p)}_{V_P} = \\frac{1}{V_P}\\int_{V_P} \\rho c_p dV = A_0 + \\frac{A_4(\\Delta x)^2}{12} + \\frac{A_5(\\Delta y)^2}{12} + \\frac{A_6(\\Delta z)^2}{12}\n$$\nNow, we substitute the given numerical values:\n$\\Delta x = 0.020\\ \\text{m}$, $\\Delta y = 0.010\\ \\text{m}$, $\\Delta z = 0.015\\ \\text{m}$.\n$A_0 = 2.20 \\times 10^6\\ \\text{J m}^{-3}\\text{K}^{-1}$\n$A_4 = 8.00 \\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1}$\n$A_5 = -3.00 \\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1}$\n$A_6 = 5.00 \\times 10^8\\ \\text{J m}^{-5}\\text{K}^{-1}$\n\nLet's compute each term of the average:\n$$\n\\frac{A_4(\\Delta x)^2}{12} = \\frac{(8.00 \\times 10^8)(0.020)^2}{12} = \\frac{(8.00 \\times 10^8)(4 \\times 10^{-4})}{12} = \\frac{3.2 \\times 10^5}{12} \\approx 26666.67\\ \\text{J m}^{-3}\\text{K}^{-1}\n$$\n$$\n\\frac{A_5(\\Delta y)^2}{12} = \\frac{(-3.00 \\times 10^8)(0.010)^2}{12} = \\frac{(-3.00 \\times 10^8)(1 \\times 10^{-4})}{12} = \\frac{-3.0 \\times 10^4}{12} = -2500\\ \\text{J m}^{-3}\\text{K}^{-1}\n$$\n$$\n\\frac{A_6(\\Delta z)^2}{12} = \\frac{(5.00 \\times 10^8)(0.015)^2}{12} = \\frac{(5.00 \\times 10^8)(2.25 \\times 10^{-4})}{12} = \\frac{1.125 \\times 10^5}{12} = 9375\\ \\text{J m}^{-3}\\text{K}^{-1}\n$$\nThe volume-averaged heat capacity is:\n$$\n\\overline{(\\rho c_p)}_{V_P} = (2.20 \\times 10^6) + 26666.66... - 2500 + 9375 = 2233541.66...\\ \\text{J m}^{-3}\\text{K}^{-1}\n$$\nNext, we calculate the integral using the control volume $V_P = \\Delta x \\Delta y \\Delta z = (0.020)(0.010)(0.015) = 3.0 \\times 10^{-6}\\ \\text{m}^3$.\n$$\n\\int_{V_P} \\rho c_p dV = \\overline{(\\rho c_p)}_{V_P} \\times V_P = (2233541.66...) \\times (3.0 \\times 10^{-6}) = 6.700625\\ \\text{J K}^{-1}\n$$\nFinally, we compute $C_P$ using $\\Delta t = 0.50\\ \\text{s}$:\n$$\nC_P = \\frac{1}{\\Delta t} \\int_{V_P} \\rho c_p dV = \\frac{6.700625\\ \\text{J K}^{-1}}{0.50\\ \\text{s}} = 13.40125\\ \\text{W K}^{-1}\n$$\nRounding the result to six significant figures as requested:\n$$\nC_P \\approx 13.4013\\ \\text{W K}^{-1}\n$$",
            "answer": "$$\n\\boxed{13.4013}\n$$"
        },
        {
            "introduction": "After deriving a discrete approximation, the next critical step is to analyze its accuracy. This exercise guides you through a rigorous analytical derivation of the global time discretization error for the backward Euler scheme. By accumulating the local truncation error, you will develop a deep, first-principles understanding of a method's order of accuracy and how numerical error behaves over time .",
            "id": "3948678",
            "problem": "Consider one-dimensional transient heat conduction governed by the conservation of energy in a homogeneous rod with constant density $\\rho$, specific heat $c_p$, and thermal conductivity $k$. The governing partial differential equation (PDE) for the temperature field $T(x,t)$ on a periodic domain of length $L$ is\n$$\n\\rho c_p \\,\\frac{\\partial T}{\\partial t} \\;=\\; k\\,\\frac{\\partial^{2} T}{\\partial x^{2}}.\n$$\nLet the initial temperature be a single spatial Fourier mode $T(x,0) = \\theta_0 \\sin\\!\\left(\\frac{2\\pi m}{L} x\\right)$ with integer $m \\ge 1$ and amplitude $\\theta_0$. Discretize the spatial domain with a uniform mesh and apply the Finite Volume Method (FVM) using second-order central differencing for the diffusion term so that the semi-discrete system (one ordinary differential equation per control volume) is linear, autonomous, and diagonalizable in the Fourier basis. For this single excited mode, the semi-discrete evolution reduces to a scalar amplitude equation\n$$\n\\frac{d \\theta}{d t} \\;=\\; -\\,\\lambda\\,\\theta,\n$$\nwhere $\\lambda>0$ is the positive semi-discrete diffusion rate associated with the chosen spatial mode and mesh, and $\\theta(0)=\\theta_0$.\n\nTime-advance the semi-discrete system by discretizing the transient term with the backward Euler method over uniform time steps of size $\\Delta t>0$, starting from the exact initial condition. Define the local truncation error at step $n$ as the one-step residual obtained by inserting the exact solution into the discrete update, and define the global time discretization error at the final time $t=T$ as $E(T)=\\theta^{\\Delta t}(T) - \\theta(T)$, where $\\theta^{\\Delta t}$ is the numerical solution produced by backward Euler and $\\theta$ is the exact semi-discrete solution.\n\nDerive, from first principles starting at the conservation law and the FVM semi-discretization, an integral (or summation) representation of the global time discretization error obtained by accumulating the local truncation error over $[0,T]$ in this linear setting. Then, use the structure and regularity of the exact solution to extract the leading-order asymptotic expression of $E(T)$ as $\\Delta t \\to 0$ in terms of $\\Delta t$, $T$, $\\lambda$, and $\\theta_0$, keeping the first nonzero term only.\n\nExpress your final answer as a single closed-form analytic expression for the leading-order term of $E(T)$ in Kelvin. No numerical values are provided; you must give the expression symbolically. No inequality or equation is allowed as the final answer. No rounding is required; do not approximate beyond the leading-order truncation in $\\Delta t$.",
            "solution": "The problem requires the derivation of the leading-order global time discretization error for a model ordinary differential equation (ODE) arising from the Finite Volume Method (FVM) semi-discretization of the one-dimensional transient heat equation. The derivation must proceed by first finding an integral or summation representation of the global error by accumulating the local truncation error, and then evaluating this representation in the asymptotic limit of small time steps.\n\nThe starting point is the given semi-discrete scalar amplitude equation for a single Fourier mode:\n$$\n\\frac{d \\theta}{d t} = -\\lambda \\theta(t)\n$$\nwith the initial condition $\\theta(0) = \\theta_0$. Here, $\\theta(t)$ represents the amplitude of the spatial mode at time $t$, and $\\lambda > 0$ is the effective diffusion rate from the spatial discretization. This is a linear, first-order ODE with constant coefficients. Its exact analytical solution is:\n$$\n\\theta(t) = \\theta_0 \\exp(-\\lambda t)\n$$\n\nThe temporal discretization is performed using the backward Euler method with a uniform time step $\\Delta t > 0$. Let $\\theta^n$ denote the numerical approximation of $\\theta(t_n)$ at time $t_n = n \\Delta t$. The backward Euler scheme applied to the ODE is:\n$$\n\\frac{\\theta^{n+1} - \\theta^n}{\\Delta t} = -\\lambda \\theta^{n+1}\n$$\n\nThe local truncation error (LTE), denoted as $\\tau_{n+1}$, is defined as the residual when the exact solution $\\theta(t)$ is substituted into the finite difference equation.\n$$\n\\frac{\\theta(t_{n+1}) - \\theta(t_n)}{\\Delta t} = -\\lambda \\theta(t_{n+1}) + \\tau_{n+1}\n$$\nRearranging to solve for the LTE gives:\n$$\n\\tau_{n+1} = \\frac{\\theta(t_{n+1}) - \\theta(t_n)}{\\Delta t} + \\lambda \\theta(t_{n+1})\n$$\nTo find the leading-order behavior of $\\tau_{n+1}$ as $\\Delta t \\to 0$, we perform a Taylor series expansion of $\\theta(t_n)$ around the point $t_{n+1}$:\n$$\n\\theta(t_n) = \\theta(t_{n+1} - \\Delta t) = \\theta(t_{n+1}) - \\Delta t \\frac{d\\theta}{dt}\\bigg|_{t_{n+1}} + \\frac{(\\Delta t)^2}{2} \\frac{d^2\\theta}{dt^2}\\bigg|_{t_{n+1}} - O((\\Delta t)^3)\n$$\nSubstituting this expansion into the expression for $\\tau_{n+1}$:\n$$\n\\tau_{n+1} = \\frac{1}{\\Delta t} \\left[ \\theta(t_{n+1}) - \\left( \\theta(t_{n+1}) - \\Delta t \\theta'(t_{n+1}) + \\frac{(\\Delta t)^2}{2} \\theta''(t_{n+1}) - \\dots \\right) \\right] + \\lambda \\theta(t_{n+1})\n$$\n$$\n\\tau_{n+1} = \\left( \\theta'(t_{n+1}) + \\lambda \\theta(t_{n+1}) \\right) - \\frac{\\Delta t}{2} \\theta''(t_{n+1}) + O((\\Delta t)^2)\n$$\nSince $\\theta(t)$ is the exact solution to the ODE, the term in the parenthesis is zero: $\\theta'(t) + \\lambda \\theta(t) = 0$ for all $t$. Thus, the leading-order term of the local truncation error is:\n$$\n\\tau_{n+1} = -\\frac{\\Delta t}{2} \\theta''(t_{n+1}) + O((\\Delta t)^2)\n$$\n\nNext, we derive the evolution equation for the global error, defined as $e^n = \\theta^n - \\theta(t_n)$. We have the numerical scheme and the equation for the exact solution including the LTE:\n1. Numerical scheme: $\\theta^{n+1} - \\theta^n = -\\lambda \\Delta t \\theta^{n+1} \\implies \\theta^{n+1}(1 + \\lambda \\Delta t) = \\theta^n$\n2. Exact solution: $\\theta(t_{n+1}) - \\theta(t_n) = -\\lambda \\Delta t \\theta(t_{n+1}) + \\Delta t \\tau_{n+1} \\implies \\theta(t_{n+1})(1 + \\lambda \\Delta t) = \\theta(t_n) + \\Delta t \\tau_{n+1}$\nSubtracting the second equation from the first gives the recurrence relation for the global error:\n$$\n(\\theta^{n+1} - \\theta(t_{n+1}))(1 + \\lambda \\Delta t) = (\\theta^n - \\theta(t_n)) - \\Delta t \\tau_{n+1}\n$$\n$$\ne^{n+1}(1 + \\lambda \\Delta t) = e^n - \\Delta t \\tau_{n+1} \\implies e^{n+1} = \\frac{1}{1 + \\lambda \\Delta t} e^n - \\frac{\\Delta t}{1 + \\lambda \\Delta t} \\tau_{n+1}\n$$\nThe initial condition is exact, so $e^0 = \\theta^0 - \\theta(0) = \\theta_0 - \\theta_0 = 0$. We can unroll the recurrence to find the global error $E(T) = e^N$ at the final time $T = N \\Delta t$:\n$e^1 = - \\frac{\\Delta t}{1 + \\lambda \\Delta t} \\tau_1$\n$e^2 = \\frac{1}{1 + \\lambda \\Delta t} e^1 - \\frac{\\Delta t}{1 + \\lambda \\Delta t} \\tau_2 = - \\frac{\\Delta t}{(1 + \\lambda \\Delta t)^2} \\tau_1 - \\frac{\\Delta t}{1 + \\lambda \\Delta t} \\tau_2$\nBy induction, the global error at step $N$ is the sum of all scaled local truncation errors generated at previous steps:\n$$\nE(T) = e^N = - \\Delta t \\sum_{j=1}^{N} \\frac{\\tau_j}{(1 + \\lambda \\Delta t)^{N-j+1}}\n$$\nThis is the required summation representation of the global error.\n\nTo find the leading-order asymptotic expression, we substitute the leading-order term for $\\tau_j \\approx -\\frac{\\Delta t}{2} \\theta''(t_j)$ into this sum:\n$$\nE(T) \\approx - \\Delta t \\sum_{j=1}^{N} \\frac{-\\frac{\\Delta t}{2} \\theta''(t_j)}{(1 + \\lambda \\Delta t)^{N-j+1}} = \\frac{(\\Delta t)^2}{2} \\sum_{j=1}^{N} \\frac{\\theta''(t_j)}{(1 + \\lambda \\Delta t)^{N-j+1}}\n$$\nWe now analyze this sum in the limit $\\Delta t \\to 0$ with $T = N \\Delta t$ held constant. Let $t_j = j \\Delta t$. The denominator can be approximated as:\n$$\n(1 + \\lambda \\Delta t)^{-(N-j+1)} \\approx (1 + \\lambda \\Delta t)^{-(N-j)} = (1 + \\lambda \\Delta t)^{-(T-t_j)/\\Delta t}\n$$\nUsing the limit definition of the exponential function, $\\lim_{x\\to 0} (1+ax)^{b/x} = \\exp(ab)$, we have:\n$$\n\\lim_{\\Delta t \\to 0} (1 + \\lambda \\Delta t)^{-(T-t_j)/\\Delta t} = \\exp(-\\lambda(T-t_j))\n$$\nThe sum can thus be approximated by a Riemann integral. Rearranging the expression slightly:\n$$\nE(T) \\approx \\frac{\\Delta t}{2} \\sum_{j=1}^{N} \\frac{\\theta''(t_j)}{(1 + \\lambda \\Delta t)^{N-j+1}} \\Delta t\n$$\nIn the limit $\\Delta t \\to 0$, this becomes:\n$$\nE(T) \\approx \\frac{\\Delta t}{2} \\int_0^T \\exp(-\\lambda(T-t)) \\theta''(t) dt\n$$\nTo evaluate the integral, we need the second derivative of the exact solution $\\theta(t) = \\theta_0 \\exp(-\\lambda t)$:\n$$\n\\theta'(t) = -\\lambda \\theta_0 \\exp(-\\lambda t)\n$$\n$$\n\\theta''(t) = (-\\lambda)^2 \\theta_0 \\exp(-\\lambda t) = \\lambda^2 \\theta_0 \\exp(-\\lambda t)\n$$\nSubstituting this into the integral:\n$$\nE(T) \\approx \\frac{\\Delta t}{2} \\int_0^T \\exp(-\\lambda(T-t)) \\left( \\lambda^2 \\theta_0 \\exp(-\\lambda t) \\right) dt\n$$\n$$\nE(T) \\approx \\frac{\\Delta t \\lambda^2 \\theta_0}{2} \\int_0^T \\exp(-\\lambda T + \\lambda t - \\lambda t) dt = \\frac{\\Delta t \\lambda^2 \\theta_0}{2} \\int_0^T \\exp(-\\lambda T) dt\n$$\nThe term $\\exp(-\\lambda T)$ is constant with respect to the integration variable $t$:\n$$\nE(T) \\approx \\frac{\\Delta t \\lambda^2 \\theta_0 \\exp(-\\lambda T)}{2} \\int_0^T dt = \\frac{\\Delta t \\lambda^2 \\theta_0 \\exp(-\\lambda T)}{2} [t]_0^T\n$$\n$$\nE(T) \\approx \\frac{\\Delta t \\lambda^2 \\theta_0 T \\exp(-\\lambda T)}{2}\n$$\nThis is the leading-order asymptotic expression for the global time discretization error at the final time $T$. It is first-order in $\\Delta t$, which is the known order of accuracy for the backward Euler method.\n\nFinal expression for the leading-order term of $E(T)$:\n$$\nE(T) \\approx \\frac{1}{2} \\lambda^2 T \\theta_0 \\exp(-\\lambda T) \\Delta t\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{2} \\lambda^{2} T \\theta_{0} \\exp(-\\lambda T) \\Delta t}\n$$"
        },
        {
            "introduction": "Theory and analysis must ultimately be validated through implementation. This final practice provides a complete hands-on workflow for verifying the temporal order of accuracy using the Method of Manufactured Solutions (MMS), a cornerstone of modern code verification. By writing a program to run a convergence study, you will empirically confirm the theoretical performance of different time-stepping schemes, a crucial skill for developing reliable computational tools .",
            "id": "3948713",
            "problem": "You are asked to write a complete program that computes the observed temporal order of accuracy for the time discretization of the transient term in the Finite Volume Method (FVM) for one-dimensional heat conduction, using the Method of Manufactured Solutions (MMS). The purpose is to empirically estimate the exponent in the relationship between the numerical error and the time step size, by refining the time step $\\Delta t$ on a fixed spatial grid and fitting the error norms. All quantities in this problem are nondimensional and unitless.\n\nThe fundamental base for this task is the conservation of thermal energy and the classical heat conduction model. Consider a one-dimensional spatial domain $x \\in [0,1]$ with a uniform cell-centered grid and Dirichlet boundary conditions. Let $u(x,t)$ be the temperature field satisfying the nondimensional heat equation\n$$\nu_t = \\alpha\\,u_{xx} + s(x,t),\n$$\nwhere $u_t$ is the time derivative, $u_{xx}$ is the second spatial derivative, $\\alpha$ is a constant diffusivity, and $s(x,t)$ is a source term constructed so that a chosen manufactured solution $u(x,t)$ is exact for the continuous equation. On a uniform grid of $N_x$ control volumes with cell centers $x_i$ and spacing $\\Delta x$, the diffusive term is approximated with a second-order central finite volume stencil, and Dirichlet boundary values are enforced by injecting the boundary values at $x=0$ and $x=1$ into the discrete operator via known contributions. Time advancement must use the one-parameter $\\theta$-method applied to the semi-discrete FVM ordinary differential equation, where $\\theta \\in [0,1]$ defines the method family (e.g., backward Euler with $\\theta=1$ and Crankâ€“Nicolson with $\\theta=1/2$). You must determine the discrete system and implement it without shortcut formulas given in the problem text.\n\nYour program must implement the following procedure:\n- Fix a uniform spatial grid with $N_x$ control volumes and $\\Delta x = 1/N_x$, and enforce Dirichlet boundary conditions equal to the manufactured solution values at the boundaries.\n- For each test case, choose $\\alpha$, $\\theta$, a manufactured solution $u(x,t)$, and its source $s(x,t)$ derived so that $u(x,t)$ is exact for the continuous equation.\n- Initialize $u(x,0)$ from the manufactured solution.\n- Advance in time from $t=0$ to a final time $T$ with the chosen $\\theta$-method on the semi-discrete FVM system, using several refined time steps $\\Delta t$ while keeping the spatial grid fixed.\n- At $t=T$, compute the discrete error $e_i = u_i^{\\text{num}}(T) - u(x_i,T)$ at each cell center and then compute:\n  - The discrete $L_2$ norm,\n    $$\n    \\|e\\|_{2,\\Delta x} = \\left( \\sum_{i=1}^{N_x} e_i^2 \\,\\Delta x \\right)^{1/2},\n    $$\n  - The discrete $L_\\infty$ norm,\n    $$\n    \\|e\\|_{\\infty} = \\max_{1\\le i \\le N_x} |e_i|.\n    $$\n- For each norm, perform a least-squares linear fit of $\\log(\\|e\\|)$ versus $\\log(\\Delta t)$ over the refinement set to estimate the observed temporal order $p$, defined by $\\|e\\| \\propto (\\Delta t)^p$. Report the slope $p$ from the fit.\n\nUse the following test suite of parameter values, which is designed to probe different aspects and edge cases of the transient discretization:\n- Test case $1$ (baseline first-order implicit):\n  - $\\theta = 1$,\n  - $\\alpha = 1$,\n  - Manufactured solution $u(x,t) = \\exp(-t)\\,\\sin(\\pi x)$ with source $s(x,t)$ chosen so that this $u$ solves the continuous equation exactly,\n  - Dirichlet boundary conditions $u(0,t)$ and $u(1,t)$ equal to the manufactured solution values,\n  - $N_x = 200$,\n  - Final time $T = 0.4$,\n  - Time step refinements $\\Delta t \\in \\{0.05,\\;0.025,\\;0.0125,\\;0.00625\\}$.\n- Test case $2$ (second-order implicit trapezoidal):\n  - $\\theta = 1/2$,\n  - $\\alpha = 1$,\n  - Manufactured solution $u(x,t) = \\exp(-t)\\,\\sin(\\pi x)$ with source $s(x,t)$ chosen so that this $u$ solves the continuous equation exactly,\n  - Dirichlet boundary conditions equal to the manufactured solution values,\n  - $N_x = 200$,\n  - Final time $T = 0.4$,\n  - Time step refinements identical to test case $1$.\n- Test case $3$ (pure transient, no diffusion):\n  - $\\theta = 1$,\n  - $\\alpha = 0$,\n  - Manufactured solution $u(x,t) = \\cos(2t)\\,\\sin(\\pi x)$ with source $s(x,t)$ chosen so that this $u$ solves the continuous equation exactly,\n  - Dirichlet boundary conditions equal to the manufactured solution values,\n  - $N_x = 200$,\n  - Final time $T = 0.4$,\n  - Time step refinements identical to test case $1$.\n\nYour program must compute, for each test case, two floats:\n- The observed temporal order $p_{2}$ from the discrete $L_2$ norm fit,\n- The observed temporal order $p_{\\infty}$ from the discrete $L_\\infty$ norm fit.\n\nFinal output format:\n- Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, ordered as\n  $[p_{2}^{(1)}, p_{2}^{(2)}, p_{2}^{(3)}, p_{\\infty}^{(1)}, p_{\\infty}^{(2)}, p_{\\infty}^{(3)}]$,\n  where the superscript indicates the test case number.\n- Each float must be rounded to three decimal places.\n- For example, an output line might look like $[0.998,1.985,1.000,0.999,1.987,1.000]$.\n\nAll quantities are nondimensional; no physical units are required. Angles, where present inside trigonometric functions, are in radians. The program must be self-contained, require no input, and use only the specified libraries.",
            "solution": "The user-provided problem is assessed to be **valid**. It is a well-posed, scientifically grounded, and objective task from the field of computational science and engineering. The problem asks for the empirical determination of the temporal order of accuracy for the $\\theta$-method applied to the one-dimensional heat equation, a standard exercise in numerical analysis. The Method of Manufactured Solutions is a rigorous verification technique. All parameters and procedures are clearly specified. We may therefore proceed with a full solution.\n\nThe core of the problem is to solve the nondimensional heat equation on the domain $x \\in [0, 1]$ and $t \\ge 0$:\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2} + s(x,t)\n$$\nwhere $u(x,t)$ is the temperature, $\\alpha$ is the thermal diffusivity, and $s(x,t)$ is a source term. The source term is specifically constructed such that a chosen \"manufactured\" solution is an exact solution to this continuous partial differential equation (PDE).\n\n### 1. Manufactured Solutions and Source Term Derivation\n\nThe Method of Manufactured Solutions (MMS) requires us to derive the source term $s(x,t)$ by substituting the manufactured solution $u(x,t)$ into the governing equation:\n$$\ns(x,t) = \\frac{\\partial u}{\\partial t} - \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n\n**For Test Cases 1 and 2:**\nThe manufactured solution is $u(x,t) = \\exp(-t)\\sin(\\pi x)$ and the diffusivity is $\\alpha=1$.\nThe partial derivatives are:\n$$\n\\frac{\\partial u}{\\partial t} = -\\exp(-t)\\sin(\\pi x)\n$$\n$$\n\\frac{\\partial u}{\\partial x} = \\pi\\exp(-t)\\cos(\\pi x) \\quad \\implies \\quad \\frac{\\partial^2 u}{\\partial x^2} = -\\pi^2\\exp(-t)\\sin(\\pi x)\n$$\nSubstituting these into the expression for $s(x,t)$:\n$$\ns(x,t) = \\left(-\\exp(-t)\\sin(\\pi x)\\right) - (1)\\left(-\\pi^2\\exp(-t)\\sin(\\pi x)\\right) = (\\pi^2 - 1)\\exp(-t)\\sin(\\pi x)\n$$\nThe Dirichlet boundary conditions are $u(0,t) = \\exp(-t)\\sin(0) = 0$ and $u(1,t) = \\exp(-t)\\sin(\\pi) = 0$.\n\n**For Test Case 3:**\nThe manufactured solution is $u(x,t) = \\cos(2t)\\sin(\\pi x)$ and the diffusivity is $\\alpha=0$.\nThe time derivative is:\n$$\n\\frac{\\partial u}{\\partial t} = -2\\sin(2t)\\sin(\\pi x)\n$$\nSince $\\alpha=0$, the diffusive term vanishes. The source term is simply:\n$$\ns(x,t) = \\frac{\\partial u}{\\partial t} = -2\\sin(2t)\\sin(\\pi x)\n$$\nThe Dirichlet boundary conditions are $u(0,t) = \\cos(2t)\\sin(0) = 0$ and $u(1,t) = \\cos(2t)\\sin(\\pi) = 0$.\n\n### 2. Finite Volume Method (FVM) Discretization\n\nWe discretize the domain $x \\in [0,1]$ into $N_x$ uniform control volumes (CVs) of width $\\Delta x = 1/N_x$. The center of the $i$-th CV is at $x_i = (i - 1/2)\\Delta x$ for $i=1, \\dots, N_x$. We integrate the governing PDE over the $i$-th control volume, from face $x_{i-1/2}$ to $x_{i+1/2}$:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial u}{\\partial t} \\,dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} \\alpha \\frac{\\partial^2 u}{\\partial x^2} \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} s(x,t) \\,dx\n$$\nApproximating the integrals, where $u_i(t) \\approx u(x_i, t)$ is the cell-averaged temperature:\n$$\n\\frac{d u_i}{d t} \\Delta x = \\alpha \\left[ \\left(\\frac{\\partial u}{\\partial x}\\right)_{i+1/2} - \\left(\\frac{\\partial u}{\\partial x}\\right)_{i-1/2} \\right] + s(x_i, t) \\Delta x\n$$\nUsing second-order central differences for the gradients at the cell faces:\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_{i+1/2} \\approx \\frac{u_{i+1} - u_i}{\\Delta x}, \\quad \\left(\\frac{\\partial u}{\\partial x}\\right)_{i-1/2} \\approx \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\nSubstituting these back and dividing by $\\Delta x$, we obtain the semi-discrete equation for an interior cell $i$:\n$$\n\\frac{d u_i}{d t} = \\frac{\\alpha}{(\\Delta x)^2} (u_{i+1} - 2u_i + u_{i-1}) + s(x_i, t)\n$$\nThis system of ordinary differential equations (ODEs) can be written in matrix form:\n$$\n\\frac{d\\mathbf{u}}{dt} = \\mathbf{A}_{int}\\mathbf{u} + \\mathbf{b}(t) + \\mathbf{s}(t)\n$$\nwhere $\\mathbf{u} = [u_1, u_2, \\dots, u_{N_x}]^T$ is the vector of cell-center temperatures. The matrix $\\mathbf{A}_{int}$ represents the internal diffusive coupling, and is tridiagonal with constants $\\frac{\\alpha}{(\\Delta x)^2}$ on the sub- and super-diagonals and $-2\\frac{\\alpha}{(\\Delta x)^2}$ on the main diagonal. The vector $\\mathbf{s}(t)$ contains the source terms $s(x_i, t)$. The vector $\\mathbf{b}(t)$ incorporates the Dirichlet boundary conditions. For cell $i=1$, $u_0$ is replaced by the left boundary value $u_L(t)$, and for cell $i=N_x$, $u_{N_x+1}$ is replaced by the right boundary value $u_R(t)$. These boundary terms are moved to the right-hand side, forming the vector $\\mathbf{b}(t)$.\nSpecifically, $b_1(t) = \\frac{\\alpha}{(\\Delta x)^2} u_L(t)$, $b_{N_x}(t) = \\frac{\\alpha}{(\\Delta x)^2} u_R(t)$, and $b_i(t)=0$ for $1 < i < N_x$.\nFor all test cases in this problem, the boundary conditions are homogeneous, $u_L(t) = u_R(t) = 0$, which implies that the boundary vector $\\mathbf{b}(t)$ is identically zero.\n\n### 3. Temporal Discretization: The $\\theta$-Method\n\nWe apply the $\\theta$-method to the semi-discrete system $\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(\\mathbf{u}, t)$, where $\\mathbf{F}(\\mathbf{u}, t) = \\mathbf{A}_{int}\\mathbf{u} + \\mathbf{s}(t)$. Let $t^n = n\\Delta t$. The time-marching scheme is:\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = (1-\\theta)\\mathbf{F}(\\mathbf{u}^n, t^n) + \\theta\\mathbf{F}(\\mathbf{u}^{n+1}, t^{n+1})\n$$\nSubstituting for $\\mathbf{F}$ and rearranging to solve for the unknown $\\mathbf{u}^{n+1}$:\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = (1-\\theta)(\\mathbf{A}_{int}\\mathbf{u}^n + \\mathbf{s}^n) + \\theta(\\mathbf{A}_{int}\\mathbf{u}^{n+1} + \\mathbf{s}^{n+1})\n$$\n$$\n\\mathbf{u}^{n+1} - \\theta \\Delta t \\mathbf{A}_{int}\\mathbf{u}^{n+1} = \\mathbf{u}^n + (1-\\theta) \\Delta t \\mathbf{A}_{int}\\mathbf{u}^n + \\Delta t((1-\\theta)\\mathbf{s}^n + \\theta\\mathbf{s}^{n+1})\n$$\n$$\n(\\mathbf{I} - \\theta \\Delta t \\mathbf{A}_{int}) \\mathbf{u}^{n+1} = (\\mathbf{I} + (1-\\theta) \\Delta t \\mathbf{A}_{int}) \\mathbf{u}^n + \\Delta t((1-\\theta)\\mathbf{s}^n + \\theta\\mathbf{s}^{n+1})\n$$\nwhere $\\mathbf{I}$ is the identity matrix, and $\\mathbf{s}^n = \\mathbf{s}(t^n)$. At each time step, we must solve this linear system for $\\mathbf{u}^{n+1}$. The matrix on the left-hand side, $(\\mathbf{I} - \\theta \\Delta t \\mathbf{A}_{int})$, is tridiagonal and constant for a fixed $\\Delta t$, allowing for an efficient solution.\n\n### 4. Error Analysis and Order of Accuracy\n\nAfter advancing the solution from $t=0$ to the final time $T$, we obtain the numerical solution vector $\\mathbf{u}^{\\text{num}}(T)$. We compare this to the exact solution vector $\\mathbf{u}^{\\text{exact}}(T)$, where each component is given by $u(x_i, T)$. The error vector is $\\mathbf{e} = \\mathbf{u}^{\\text{num}}(T) - \\mathbf{u}^{\\text{exact}}(T)$.\n\nWe compute the discrete $L_2$ and $L_\\infty$ norms of this error:\n$$\n\\|e\\|_{2,\\Delta x} = \\left( \\sum_{i=1}^{N_x} e_i^2 \\Delta x \\right)^{1/2}, \\quad \\|e\\|_{\\infty} = \\max_{1\\le i \\le N_x} |e_i|\n$$\nThis procedure is repeated for a sequence of refined time steps, $\\Delta t_j$. The theoretical relationship between the error and the time step is $\\|e\\| \\approx C (\\Delta t)^p$, where $p$ is the order of accuracy. Taking the logarithm of both sides yields a linear relationship:\n$$\n\\log(\\|e\\|) \\approx \\log(C) + p \\log(\\Delta t)\n$$\nWe perform a linear least-squares fit on the data points $(\\log(\\Delta t_j), \\log(\\|e\\|_j))$ for each norm. The slope of the resulting line is the empirically observed order of accuracy, $p$.\n\n**Expected Theoretical Orders:**\n- **Test Case 1** ($\\theta=1$, Backward Euler): First-order accurate in time. Expected $p \\approx 1$.\n- **Test Case 2** ($\\theta=1/2$, Crank-Nicolson): Second-order accurate in time. Expected $p \\approx 2$.\n- **Test Case 3** ($\\theta=1$, $\\alpha=0$): The problem reduces to a system of independent ODEs, integrated with the Backward Euler method, which is a first-order scheme. Expected $p \\approx 1$.\n\nThe implementation will follow these steps precisely to compute the observed orders $p_2$ and $p_\\infty$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Computes the observed temporal order of accuracy for the FVM time discretization\n    of the 1D heat equation using the Method of Manufactured Solutions.\n    \"\"\"\n\n    def run_convergence_study(alpha, theta, u_manufactured, s_source, Nx, T_final, dt_refinements):\n        \"\"\"\n        Performs a time-step refinement study for a single test case.\n\n        Args:\n            alpha (float): Thermal diffusivity.\n            theta (float): Parameter for the theta-method.\n            u_manufactured (callable): Manufactured solution u(x, t).\n            s_source (callable): Source term s(x, t).\n            Nx (int): Number of control volumes.\n            T_final (float): Final simulation time.\n            dt_refinements (list): List of time step sizes to test.\n\n        Returns:\n            tuple: A tuple containing the observed order for L2 norm (p2)\n                   and L-infinity norm (p_inf).\n        \"\"\"\n        dx = 1.0 / Nx\n        x_centers = np.linspace(dx / 2.0, 1.0 - dx / 2.0, Nx)\n\n        errors_l2 = []\n        errors_linf = []\n\n        # Construct the constant interior part of the spatial operator matrix A_int\n        c = alpha / (dx * dx)\n        A_int_main_diag = -2.0 * c * np.ones(Nx)\n        A_int_off_diag = c * np.ones(Nx - 1)\n\n        for dt in dt_refinements:\n            # --- Temporal advancing loop ---\n            time = 0.0\n            num_steps = int(round(T_final / dt))\n            # Adjust dt to hit T_final exactly\n            dt_actual = T_final / num_steps\n            \n            # Initial condition from manufactured solution\n            u_num = u_manufactured(x_centers, 0.0)\n\n            # --- Set up linear system for theta-method ---\n            # System: M_L @ u_n+1 = M_R @ u_n + source_terms\n            # Left-hand side matrix M_L = I - theta * dt * A_int\n            ml_main = 1.0 - theta * dt_actual * A_int_main_diag\n            ml_off = -theta * dt_actual * A_int_off_diag\n            \n            # Create banded matrix for scipy solver\n            # (1, 1) means 1 sub-diagonal and 1 super-diagonal\n            M_L_banded = np.zeros((3, Nx))\n            M_L_banded[0, 1:] = ml_off\n            M_L_banded[1, :] = ml_main\n            M_L_banded[2, :-1] = ml_off\n\n            # Right-hand side matrix M_R = I + (1 - theta) * dt * A_int\n            mr_main = 1.0 + (1.0 - theta) * dt_actual * A_int_main_diag\n            mr_off = (1.0 - theta) * dt_actual * A_int_off_diag\n\n            for n in range(num_steps):\n                t_n = time\n                t_np1 = time + dt_actual\n\n                # Form the right-hand side vector\n                # RHS = M_R @ u_n\n                rhs = mr_main * u_num\n                if Nx > 1:\n                    rhs[1:] += mr_off * u_num[:-1]\n                    rhs[:-1] += mr_off * u_num[1:]\n\n                # Add source terms: dt * ((1-theta)*s_n + theta*s_np1)\n                # Note: Boundary contribution vector b(t) is zero for all cases\n                s_n = s_source(x_centers, t_n)\n                s_np1 = s_source(x_centers, t_np1)\n                source_contribution = dt_actual * ((1.0 - theta) * s_n + theta * s_np1)\n                rhs += source_contribution\n                \n                # Solve the tridiagonal system for u_n+1\n                u_num = solve_banded((1, 1), M_L_banded, rhs)\n                \n                time = t_np1\n\n            # --- Error computation ---\n            u_exact = u_manufactured(x_centers, T_final)\n            error = u_num - u_exact\n\n            # L2 norm\n            error_l2 = np.sqrt(np.sum(error**2 * dx))\n            errors_l2.append(error_l2)\n            \n            # L-infinity norm\n            error_linf = np.max(np.abs(error))\n            errors_linf.append(error_linf)\n\n        # --- Linear fit to find order of accuracy p ---\n        log_dt = np.log(dt_refinements)\n        \n        # L2 order\n        log_err_l2 = np.log(errors_l2)\n        p2 = np.polyfit(log_dt, log_err_l2, 1)[0]\n        \n        # L-infinity order\n        log_err_linf = np.log(errors_linf)\n        p_inf = np.polyfit(log_dt, log_err_linf, 1)[0]\n\n        return p2, p_inf\n\n    # --- Test Case Definitions ---\n    # Common parameters\n    Nx_common = 200\n    T_final_common = 0.4\n    dt_refinements_common = [0.05, 0.025, 0.0125, 0.00625]\n\n    # Test Case 1: Backward Euler, alpha=1\n    u1 = lambda x, t: np.exp(-t) * np.sin(np.pi * x)\n    s1 = lambda x, t: (np.pi**2 - 1) * np.exp(-t) * np.sin(np.pi * x)\n    p2_1, pinf_1 = run_convergence_study(1.0, 1.0, u1, s1, Nx_common, T_final_common, dt_refinements_common)\n\n    # Test Case 2: Crank-Nicolson, alpha=1\n    u2 = u1\n    s2 = s1\n    p2_2, pinf_2 = run_convergence_study(1.0, 0.5, u2, s2, Nx_common, T_final_common, dt_refinements_common)\n\n    # Test Case 3: Backward Euler, alpha=0 (pure transient)\n    u3 = lambda x, t: np.cos(2 * t) * np.sin(np.pi * x)\n    s3 = lambda x, t: -2 * np.sin(2 * t) * np.sin(np.pi * x)\n    p2_3, pinf_3 = run_convergence_study(0.0, 1.0, u3, s3, Nx_common, T_final_common, dt_refinements_common)\n    \n    # --- Format and Print Final Output ---\n    results = [\n        round(p2_1, 3), round(p2_2, 3), round(p2_3, 3),\n        round(pinf_1, 3), round(pinf_2, 3), round(pinf_3, 3)\n    ]\n    \n    results_str = [f\"{r:.3f}\" for r in results]\n\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}