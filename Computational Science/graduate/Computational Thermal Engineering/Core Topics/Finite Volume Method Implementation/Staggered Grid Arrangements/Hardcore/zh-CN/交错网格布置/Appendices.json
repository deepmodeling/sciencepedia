{
    "hands_on_practices": [
        {
            "introduction": "理解交错网格必要性的最佳方式，是亲手验证一种更直观的同位网格（collocated grid）布局为何会失效。这项练习将通过一个一维的简化思想实验，揭示同位网格方案中存在的虚假压力-速度解耦问题。通过计算一个特定的振荡压力场在其上的离散梯度，您将亲自发现该数值格式的“盲点”，并从根本上理解为何需要交错网格 。",
            "id": "3986241",
            "problem": "考虑无体力情况下一维不可压缩动量平衡方程，其在间距为 $\\Delta x$ 的均匀网格上，以索引 $i$ 为中心的控制体写成的半离散有限体积形式如下：净压力贡献近似为东西两面的压力差除以 $\\Delta x$。在同位网格（collocated arrangement）布置中，压力和速度都存储在单元中心，并使用常见的中心线性插值来获得面上的压力。具体而言，面上的压力通过 $p_{i+\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i}+p_{i+1}\\right)$ 和 $p_{i-\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i-1}+p_{i}\\right)$ 计算，其中 $p_{j}$ 表示单元中心 $x_{j}=j\\,\\Delta x$ 处的压力。定义控制体 $i$ 上的无量纲压力为\n$$\n\\Phi_{i} \\equiv \\frac{-\\left(p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}\\right)}{\\Delta x\\,p_{0}}.\n$$\n你需要设计一个最小的反例，通过考虑振荡的、单元间交替的压力场 $p_{j}=p_{0}\\,(-1)^{j}$（其中 $p_{0}\\neq 0$ 是一个常数振幅），来展示同位网格上的伪压力-速度解耦现象。从线动量守恒以及给定的插值和差分规则出发，计算该 $p_{j}$ 下 $\\Phi_{i}$ 的单一值，并证明其与 $i$ 无关。然后，使用有限体积法和网格布置的第一性原理，定性解释为什么这个结果意味着在采用中心插值的同位网格上存在伪压力-速度解耦，以及为什么将速度置于面上、压力置于单元中心（一种交错网格布置）可以对相同的振荡压力场 $p_{j}$ 避免这种解耦。你最终报告的答案必须是 $\\Phi_{i}$ 的值，作为一个实数。无需四舍五入。答案应表示为无量纲数。",
            "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n**步骤1：提取已知条件**\n- 背景是一维不可压缩动量平衡。\n- 空间离散化方法是在间距为 $\\Delta x$ 的均匀网格上使用有限体积法。\n- 网格布置为同位网格，压力 $p$ 和速度 $u$ 存储在单元中心 $x_j=j\\,\\Delta x$。\n- 控制体 $i$ 东面的压力通过 $p_{i+\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i}+p_{i+1}\\right)$ 插值得到。\n- 控制体 $i$ 西面的压力通过 $p_{i-\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i-1}+p_{i}\\right)$ 插值得到。\n- 控制体 $i$ 上单位体积的净压力贡献为 $-\\frac{p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}}{\\Delta x}$。\n- 无量纲压力定义为 $\\Phi_{i} \\equiv \\frac{-\\left(p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}\\right)}{\\Delta x\\,p_{0}}$。\n- 待分析的压力场是振荡的、单元间交替的场：$p_{j}=p_{0}\\,(-1)^{j}$，其中 $p_{0}\\neq 0$ 是一个常数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题探讨了计算流体动力学（CFD）中的一个经典且根本性的问题，即同位网格上的压力-速度解耦。其设置，包括使用中心插值和分析高频“棋盘格”压力模式，是标准的教科书示例，用以说明此数值格式的缺陷以及引入交错网格的动机。这些原理牢固地建立在应用于流体动力学的数值分析之上。\n- **适定性**：该问题提供了计算 $\\Phi_{i}$ 值所需的所有必要定义和方程。关于定性解释的说明清晰，并涉及该领域的既定概念。存在唯一且有意义的解。\n- **客观性**：该问题以精确的技术语言陈述，没有主观或含糊的术语。\n\n该问题被认为是有效的，因为它具有科学依据、适定且客观。它没有违反任何无效标准。我们可以继续求解。\n\n**$\\Phi_{i}$ 的定量计算**\n\n目标是针对给定的压力场 $p_{j}=p_{0}\\,(-1)^{j}$ 计算无量纲压力 $\\Phi_{i}$。$\\Phi_{i}$ 的定义为：\n$$\n\\Phi_{i} = \\frac{-\\left(p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}\\right)}{\\Delta x\\,p_{0}}\n$$\n首先，我们使用给定的中心插值格式计算单元面上的压力 $p_{i+\\frac{1}{2}}$ 和 $p_{i-\\frac{1}{2}}$。任意单元中心 $j$ 处的压力由 $p_{j} = p_{0}\\,(-1)^{j}$ 给出。\n\n东面上的压力 $p_{i+\\frac{1}{2}}$ 取决于单元中心 $i$ 和 $i+1$ 处的压力：\n$$\np_{i} = p_{0}\\,(-1)^{i}\n$$\n$$\np_{i+1} = p_{0}\\,(-1)^{i+1} = p_{0}\\,(-1) \\cdot (-1)^{i} = -p_{0}\\,(-1)^{i}\n$$\n使用插值公式：\n$$\np_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(p_{i}+p_{i+1}\\right) = \\frac{1}{2}\\left(p_{0}\\,(-1)^{i} + (-p_{0}\\,(-1)^{i})\\right) = \\frac{1}{2}\\left(0\\right) = 0\n$$\n接下来，西面上的压力 $p_{i-\\frac{1}{2}}$ 取决于单元中心 $i-1$ 和 $i$ 处的压力：\n$$\np_{i-1} = p_{0}\\,(-1)^{i-1} = p_{0}\\,(-1)^{-1} \\cdot (-1)^{i} = -p_{0}\\,(-1)^{i}\n$$\n使用插值公式：\n$$\np_{i-\\frac{1}{2}} = \\frac{1}{2}\\left(p_{i-1}+p_{i}\\right) = \\frac{1}{2}\\left(-p_{0}\\,(-1)^{i} + p_{0}\\,(-1)^{i}\\right) = \\frac{1}{2}\\left(0\\right) = 0\n$$\n现在，将这些面压力代入 $\\Phi_{i}$ 的表达式中：\n$$\n\\Phi_{i} = \\frac{-\\left(0 - 0\\right)}{\\Delta x\\,p_{0}} = \\frac{0}{\\Delta x\\,p_{0}}\n$$\n根据定义，$\\Delta x \\neq 0$ 且 $p_{0} \\neq 0$，因此结果为：\n$$\n\\Phi_{i} = 0\n$$\n该值为常数 $0$，因此与索引 $i$ 无关，符合题目要求。\n\n**伪压力-速度解耦的定性解释**\n\n单元 $i$ 的动量方程中的压力梯度项在数值上近似为 $-\\frac{p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}}{\\Delta x}$。我们的计算表明，对于高度振荡的非均匀压力场 $p_{j} = p_{0}\\,(-1)^{j}$，这个离散的压力梯度对于每个控制体 $i$ 都恰好为零。\n\n这个结果是压力-速度解耦的核心。控制速度场的离散动量方程对这个特定的压力场完全“视而不见”。尽管压力场表现出强烈的单元间振荡（一种“棋盘格”或“锯齿”模式），数值格式计算出的压力梯度却处处为零。零压力梯度是人们在均匀压力场 $p_j = \\text{constant}$ 下会计算得到的结果。\n\n因此，速度场解不会对这些高频压力振荡做出响应。一个非物理的、振荡的压力场可以作为伪数值产物存在，而不会产生任何相应的流动，因为离散算子未能将其与速度场联系起来。这使得非物理的解能够满足离散化方程。压力场和速度场在这种意义上是“解耦”的，即速度不受这种非均匀压力模式的驱动。\n\n**关于交错网格为何能防止解耦的定性解释**\n\n由 Harlow 和 Welch 提出的交错网格布置（MAC 格式）解决了这个问题。在一维交错网格中，标量（如压力 $p$）存储在单元中心（例如 $p_i, p_{i+1}$），而矢量（如速度 $u$）存储在单元面上（例如 $u_{i-\\frac{1}{2}}, u_{i+\\frac{1}{2}}$）。\n\n考虑速度分量 $u_{i+\\frac{1}{2}}$ 的动量方程，该方程定义在以面 $i+\\frac{1}{2}$ 为中心的控制体上。驱动该速度的压力的自然位置是相邻的单元中心 $i$ 和 $i+1$。因此，压力梯度项直接使用这些节点值进行近似，无需插值：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2}} \\approx \\frac{p_{i+1} - p_{i}}{\\Delta x}\n$$\n让我们对相同的振荡压力场 $p_{j}=p_{0}\\,(-1)^{j}$ 计算这个离散梯度：\n$$\np_{i+1} - p_{i} = p_{0}\\,(-1)^{i+1} - p_{0}\\,(-1)^{i} = p_{0}\\,(-1)^{i}(-1 - 1) = -2p_{0}\\,(-1)^{i}\n$$\n因此，面 $i+\\frac{1}{2}$ 处的压力梯度为：\n$$\n\\frac{p_{i+1} - p_{i}}{\\Delta x} = \\frac{-2p_{0}\\,(-1)^{i}}{\\Delta x}\n$$\n此结果非零（因为 $p_0 \\neq 0$）。离散压力梯度现在能够正确地“感知”到相邻单元之间的巨大压力差。这个强烈的非零梯度将驱动显著的速度响应。因为交错布置在最近邻压力与位于它们之间的速度分量之间建立了这种紧密的耦合关系，所以一个伪振荡压力场不可能在不被速度场感知的情况下存在。任何此类压力模式都会被立即检测到并影响流动，从而防止在采用中心插值的同位网格中所见到的非物理解耦。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "采用交错网格的直接后果是，像温度和速度这样的不同物理量被存储在空间中的不同位置。因此，要在控制体表面或中心计算通量和进行项的组合，就必须在这些不同的位置之间进行插值。这项练习将指导您为非均匀交错网格推导标准的线性插值格式，并运用泰勒级数展开来严格分析其截断误差，从而确定该数值操作的精度阶 。",
            "id": "3986256",
            "problem": "考虑一个用于计算流体动力学（CFD）中有限体积法（FVM）的二维正交直线网格，该网格采用交错布局：标量温度场 $T(x,y)$ 存储在位于 $(x_i,y_j)$ 的标量控制体中心，而速度分量 $u(x,y)$ 和 $v(x,y)$ 分别存储在标量控制体法向面的中心，对于 $u$ 位于 $(x_{i+\\frac{1}{2}},y_j)$，对于 $v$ 位于 $(x_i,y_{j+\\frac{1}{2}})$。假设每个方向上的网格间距均为正且有限，在均匀网格上 $x_{i+\\frac{1}{2}}=\\frac{x_i+x_{i+1}}{2}$ 且 $y_{j+\\frac{1}{2}}=\\frac{y_j+y_{j+1}}{2}$，但在推导中允许非均匀间距 $x_{i+1}-x_i$ 和 $y_{j+1}-y_j$。设 $T(x,y)$ 和 $u(x,y)$ 足够光滑，在每个目标位置的邻域内具有最高三阶的连续偏导数。\n\n你的任务是：\n- 仅使用沿网格线的线性和距离插值，构建离散插值格式，将标量场 $T$ 从其存储位置 $(x_i,y_j)$ 映射到速度存储位置 $(x_{i+\\frac{1}{2}},y_j)$ 和 $(x_i,y_{j+\\frac{1}{2}})$。\n- 仅使用沿网格线的线性和距离插值，构建离散插值格式，将 $x$ 方向速度分量 $u$ 从其存储位置 $(x_{i+\\frac{1}{2}},y_j)$ 映射到标量控制体北面中心 $(x_i,y_{j+\\frac{1}{2}})$。\n- 从相容性的定义出发，并利用关于目标位置的泰勒级数展开，分析每种插值的截断误差，并确定形式相容阶 $p$，使得插值误差对于趋于零的特征网格尺寸 $\\Delta$ 呈 $C\\Delta^p$ 的比例关系。\n\n给出三种插值共有的相容阶 $p$ 的单个整数值作为最终答案。无需四舍五入。最终答案不得有单位。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n- 一个用于计算流体动力学（CFD）中有限体积法（FVM）的二维正交直线网格。\n- 网格布局是交错的。\n- 标量温度场 $T(x,y)$ 存储在位于 $(x_i,y_j)$ 的标量控制体中心。\n- 速度分量 $u(x,y)$ 存储在标量控制体法向面的中心，位于 $(x_{i+\\frac{1}{2}},y_j)$。\n- 速度分量 $v(x,y)$ 存储在标量控制体法向面的中心，位于 $(x_i,y_{j+\\frac{1}{2}})$。\n- 每个方向上的网格间距均为正且有限。\n- 允许非均匀间距 $x_{i+1}-x_i$ 和 $y_{j+1}-y_j$。\n- 面中心位置定义为 $x_{i+\\frac{1}{2}}=\\frac{x_i+x_{i+1}}{2}$ 和 $y_{j+\\frac{1}{2}}=\\frac{y_j+y_{j+1}}{2}$。\n- $T(x,y)$ 和 $u(x,y)$ 足够光滑，具有最高三阶的连续偏导数。\n- 任务是为 $T$ 到速度位置和 $u$ 到标量面位置构建离散线性插值。\n- 任务包括分析每种插值的截断误差，以找到共同的相容阶 $p$。\n\n#### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：问题涉及交错网格上插值格式的推导与精度分析，这是计算流体力学的核心数值分析内容。线性插值和泰勒级数展开是分析截断误差的标准工具。\n- **适定性**：问题清晰地定义了网格布局、变量位置和插值任务。它提供了所有必要的信息来推导插值格式并分析其精度。有一个明确的、可确定的答案。\n- **客观性**：问题是纯数学推导，不含任何主观成分。\n\n问题有效，可以继续求解。\n\n### 求解\n\n#### 插值1：将 $T$ 从 $(x_i, y_j)$ 插值到 $(x_{i+1/2}, y_j)$\n\n该插值为一维线性插值。根据问题定义，面心位于相邻单元中心的正中间，即 $x_{i+1/2} = \\frac{x_i+x_{i+1}}{2}$。这使得面心到两侧单元中心的距离相等：$x_{i+1/2}-x_i = x_{i+1}-x_{i+1/2} = \\frac{x_{i+1}-x_i}{2}$。因此，距离加权线性插值简化为算术平均值：\n$$\n\\tilde{T}_{i+1/2, j} = \\frac{T_{i,j} + T_{i+1,j}}{2}\n$$\n其中 $\\tilde{T}$ 表示插值得到的值。为分析其精度，我们在 $x_{i+1/2}$ 处对 $T_{i,j}$ 和 $T_{i+1,j}$ 进行泰勒级数展开。令 $\\Delta x = x_{i+1}-x_i$。\n$$\nT_{i,j} = T(x_{i+1/2} - \\frac{\\Delta x}{2}, y_j) = T_{i+1/2, j} - \\frac{\\Delta x}{2} \\frac{\\partial T}{\\partial x} + \\frac{1}{2}\\left(\\frac{\\Delta x}{2}\\right)^2 \\frac{\\partial^2 T}{\\partial x^2} - O(\\Delta x^3)\n$$\n$$\nT_{i+1,j} = T(x_{i+1/2} + \\frac{\\Delta x}{2}, y_j) = T_{i+1/2, j} + \\frac{\\Delta x}{2} \\frac{\\partial T}{\\partial x} + \\frac{1}{2}\\left(\\frac{\\Delta x}{2}\\right)^2 \\frac{\\partial^2 T}{\\partial x^2} + O(\\Delta x^3)\n$$\n将以上两式相加并除以2：\n$$\n\\tilde{T}_{i+1/2, j} = \\frac{T_{i,j} + T_{i+1,j}}{2} = T_{i+1/2, j} + \\frac{(\\Delta x)^2}{8} \\frac{\\partial^2 T}{\\partial x^2} + O(\\Delta x^4)\n$$\n截断误差为 $\\tilde{T}_{i+1/2, j} - T_{i+1/2, j} = O(\\Delta x^2)$。因此，该插值是**二阶**精确的。\n\n#### 插值2：将 $T$ 从 $(x_i, y_j)$ 插值到 $(x_i, y_{j+1/2})$\n\n此情况与插值1完全类似，只是方向变为 $y$ 方向。插值格式为：\n$$\n\\tilde{T}_{i, j+1/2} = \\frac{T_{i,j} + T_{i,j+1}}{2}\n$$\n通过类似的泰勒展开分析，可以得到截断误差为 $O(\\Delta y^2)$。因此，该插值也是**二阶**精确的。\n\n#### 插值3：将 $u$ 从 $(x_{i+1/2}, y_j)$ 插值到 $(x_i, y_{j+1/2})$\n\n这是一个二维插值问题。根据题目“仅使用沿网格线的线性和距离插值”，我们采用两步法：\n1.  **第一步 (y方向插值)**：在 $x=x_{i-1/2}$ 和 $x=x_{i+1/2}$ 两条垂线上，分别将 $u$ 从 $y_j$ 和 $y_{j+1}$ 位置插值到 $y_{j+1/2}$。\n    $$\n    \\tilde{u}_{i-1/2, j+1/2} = \\frac{u_{i-1/2,j} + u_{i-1/2,j+1}}{2}\n    $$\n    $$\n    \\tilde{u}_{i+1/2, j+1/2} = \\frac{u_{i+1/2,j} + u_{i+1/2,j+1}}{2}\n    $$\n    根据插值2的分析，这两个插值步骤均为二阶精确，即 $\\tilde{u}_{i\\pm1/2, j+1/2} = u_{i\\pm1/2, j+1/2} + O(\\Delta y^2)$。\n\n2.  **第二步 (x方向插值)**：使用上一步得到的两个值 $\\tilde{u}_{i-1/2, j+1/2}$ 和 $\\tilde{u}_{i+1/2, j+1/2}$，沿 $y=y_{j+1/2}$ 这条水平线插值到 $x_i$。\n    目标位置 $x_i$ 到源位置 $x_{i-1/2}$ 和 $x_{i+1/2}$ 的距离分别为：\n    $$\n    d_L = x_i - x_{i-1/2} = x_i - \\frac{x_{i-1}+x_i}{2} = \\frac{x_i - x_{i-1}}{2} = \\frac{\\Delta x_{i-1}}{2}\n    $$\n    $$\n    d_R = x_{i+1/2} - x_i = \\frac{x_i+x_{i+1}}{2} - x_i = \\frac{x_{i+1} - x_i}{2} = \\frac{\\Delta x_i}{2}\n    $$\n    总距离 $D = d_L + d_R = \\frac{\\Delta x_{i-1} + \\Delta x_i}{2}$。\n    距离加权线性插值公式为：\n    $$\n    \\tilde{u}_{i, j+1/2} = \\tilde{u}_{i-1/2, j+1/2} \\frac{d_R}{D} + \\tilde{u}_{i+1/2, j+1/2} \\frac{d_L}{D}\n    $$\n    $$\n    \\tilde{u}_{i, j+1/2} = \\tilde{u}_{i-1/2, j+1/2} \\frac{\\Delta x_i}{\\Delta x_{i-1} + \\Delta x_i} + \\tilde{u}_{i+1/2, j+1/2} \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i}\n    $$\n    对 $\\tilde{u}_{i\\pm1/2, j+1/2}$ 在 $x_i$ 处进行泰勒展开，可证该线性插值为二阶精确，即 $\\tilde{u}_{i, j+1/2} = u_{i, j+1/2} + O(\\Delta x^2) + \\text{Error from Step 1}$。\n\n由于第一步的误差是 $O(\\Delta y^2)$，第二步的误差是 $O(\\Delta x^2)$，整个插值过程的误差由两者中阶数较低者决定。因此，总的截断误差是 $O(\\Delta x^2, \\Delta y^2)$。\n\n### 结论\n所有三种插值操作（$T \\to u$ 位置，$T \\to v$ 位置，以及 $u \\to v$ 面位置）都使用了线性插值格式，在问题所给的网格定义下，分析表明它们均为二阶精确。\n因此，相容阶 $p$ 为2。\n$$\np = 2\n$$",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "将交错网格的离散化原理付诸实践的最终环节之一，是验证一个完整的计算流体动力学求解器的正确性。本练习将介绍一种强大而严谨的验证技术——“制造解方法”（Method of Manufactured Solutions, MMS）。您将为一个包含对流、扩散、压力和浮力的完整热流问题，通过从预设的精确解反向推导所需源项的方式，来构建一个精确的验证算例 。",
            "id": "3986249",
            "problem": "考虑在二维单位正方形域 $\\Omega = [0,1] \\times [0,1]$ 上的不可压缩、常物性热对流方程，其在两个空间方向上均采用周期性边界条件。方程以原始变量形式给出，对于速度 $\\mathbf{u} = (u,v)$、压力 $p$ 和温度 $T$，其形式如下：\n$$\n\\nabla \\cdot \\mathbf{u} = 0,\n$$\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\mathbf{u} + g \\beta \\left(T - T_{r}\\right)\\,\\hat{\\mathbf{e}}_{y} + \\mathbf{s}_{\\mathbf{u}},\n$$\n$$\n\\frac{\\partial T}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)T = \\alpha \\nabla^{2} T + s_{T},\n$$\n其中 $\\rho$ 是恒定的质量密度，$\\nu$ 是运动粘度，$\\alpha$ 是热扩散系数，$\\beta$ 是热膨胀系数，$g$ 是重力加速度的大小，$T_{r}$ 是参考温度，$\\hat{\\mathbf{e}}_{y}$ 是 $y$ 方向的单位向量，$\\mathbf{s}_{\\mathbf{u}} = (s_{u}, s_{v})$ 是单位质量的人造动量源（单位为 $\\mathrm{m}\\,\\mathrm{s}^{-2}$），$s_{T}$ 是人造热源（单位为 $\\mathrm{K}\\,\\mathrm{s}^{-1}$）。验证目标是在交错网格排列上的有限体积离散化：速度分量位于面心，而压力和温度位于体心。\n\n使用人造解方法（MMS），提出以下旨在在其各自的交错位置上进行采样的精确、光滑、周期场：\n$$\nu(x,y,t) = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\nv(x,y,t) = -\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t),\n$$\n$$\nT(x,y,t) = \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t),\n$$\n$$\np(x,y,t) = \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t).\n$$\n假设 $T_{r} = 0$ 且 $\\rho$、$\\nu$、$\\alpha$、$\\beta$ 和 $g$ 均为严格正常数。从上述基本定律出发，不借助任何快捷公式，推导使这些人造场逐点满足控制方程的精确闭式源项 $s_{u}(x,y,t)$、$s_{v}(x,y,t)$ 和 $s_{T}(x,y,t)$。以符号形式表示最终结果，并明确保留 $\\rho$、$\\nu$、$\\alpha$、$\\beta$ 和 $g$。\n\n答案形式与单位：\n- 使用 $\\mathrm{pmatrix}$ 环境，将三个源项按 $\\left(s_{u}, s_{v}, s_{T}\\right)$ 的顺序排列在一个单行矩阵中，给出一个解析表达式。\n- 单位质量的动量源以 $\\mathrm{m}\\,\\mathrm{s}^{-2}$ 表示，热源以 $\\mathrm{K}\\,\\mathrm{s}^{-1}$ 表示（不要在最终的方框表达式中包含单位）。\n- 无需进行数值舍入；请给出精确表达式。",
            "solution": "人造解方法（MMS）指定光滑、精确的场，并推导出使这些场满足控制方程的源项。我们从不可压缩连续性方程、包含 Boussinesq 浮力的动量方程以及对流-扩散能量方程开始：\n$$\n\\nabla \\cdot \\mathbf{u} = 0,\n$$\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\mathbf{u} + g \\beta T\\,\\hat{\\mathbf{e}}_{y} + \\mathbf{s}_{\\mathbf{u}},\n$$\n$$\n\\frac{\\partial T}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)T = \\alpha \\nabla^{2} T + s_{T},\n$$\n其中我们设定 $T_{r} = 0$。\n\n我们首先验证人造速度场的不可压缩性：\n$$\nu(x,y,t) = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t), \\quad\nv(x,y,t) = -\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t).\n$$\n计算散度：\n$$\n\\frac{\\partial u}{\\partial x} = 2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\frac{\\partial v}{\\partial y} = -2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n因此\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0,\n$$\n符合要求。\n\n接下来，我们计算推导源项所需的各项。\n\n时间导数：\n$$\n\\frac{\\partial u}{\\partial t} = u = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\frac{\\partial v}{\\partial t} = v = -\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\frac{\\partial T}{\\partial t} = 2\\,T = 2\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t),\n$$\n$$\n\\frac{\\partial p}{\\partial t} = 3\\,p = 3\\,\\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t).\n$$\n\n动量方程中对流项的空间导数：\n\n对于 $u$，\n$$\n\\frac{\\partial u}{\\partial x} = 2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t), \\quad\n\\frac{\\partial u}{\\partial y} = -2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t).\n$$\n对于 $v$，\n$$\n\\frac{\\partial v}{\\partial x} = 2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t), \\quad\n\\frac{\\partial v}{\\partial y} = -2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t).\n$$\n对流项贡献：\n$$\n(\\mathbf{u}\\cdot\\nabla)u = u\\,\\frac{\\partial u}{\\partial x} + v\\,\\frac{\\partial u}{\\partial y}\n= \\left[\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\n$$\n$$\n\\quad + \\left[-\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\\left[-2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\n$$\n$$\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\\,\\left[\\cos^{2}(2\\pi y) + \\sin^{2}(2\\pi y)\\right]\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x).\n$$\n类似地，\n$$\n(\\mathbf{u}\\cdot\\nabla)v = u\\,\\frac{\\partial v}{\\partial x} + v\\,\\frac{\\partial v}{\\partial y}\n$$\n$$\n= \\left[\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\n+ \\left[-\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\\left[-2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\n$$\n$$\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi y)\\,\\cos(2\\pi y)\\,\\left[\\sin^{2}(2\\pi x) + \\cos^{2}(2\\pi x)\\right]\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi y)\\,\\cos(2\\pi y).\n$$\n\n压力梯度：\n$$\n\\frac{\\partial p}{\\partial x} = -2\\pi \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t), \\quad\n\\frac{\\partial p}{\\partial y} = -2\\pi \\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(3t).\n$$\n\n拉普拉斯算子：\n对于在 $x$ 和 $y$ 方向具有相同波数 $2\\pi$ 的三角函数乘积，我们使用 $\\nabla^{2}[\\sin(2\\pi x)\\cos(2\\pi y)] = -\\left((2\\pi)^{2} + (2\\pi)^{2}\\right)\\sin(2\\pi x)\\cos(2\\pi y) = -8\\pi^{2}\\sin(2\\pi x)\\cos(2\\pi y)$，其他组合也类似。\n因此，\n$$\n\\nabla^{2}u = -8\\pi^{2}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\nabla^{2}v = +8\\pi^{2}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\nabla^{2}T = -8\\pi^{2}\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t).\n$$\n\n温度对流：\n$$\n\\frac{\\partial T}{\\partial x} = 2\\pi \\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t), \\quad\n\\frac{\\partial T}{\\partial y} = 2\\pi \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(2t),\n$$\n所以\n$$\n(\\mathbf{u}\\cdot\\nabla)T = u\\,\\frac{\\partial T}{\\partial x} + v\\,\\frac{\\partial T}{\\partial y}\n$$\n$$\n= \\left[\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t)\\right]\n+ \\left[-\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(2t)\\right]\n$$\n$$\n= 2\\pi \\exp(3t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\sin(2\\pi y)\n- 2\\pi \\exp(3t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\sin(2\\pi y)\n= 0.\n$$\n\n有了这些分量，通过重新整理每个方程以求解源项，来组装人造源。\n\n对于单位质量的动量源，按分量计算：\n$$\ns_{u} = \\frac{\\partial u}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)u + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} - \\nu \\nabla^{2}u,\n$$\n$$\ns_{v} = \\frac{\\partial v}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)v + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial y} - \\nu \\nabla^{2}v - g\\beta T,\n$$\n其中最后一项是 $y$ 方向的 Boussinesq 浮力项。\n\n代入计算出的各项：\n$$\ns_{u}(x,y,t) = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t) + 2\\pi \\exp(2t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\n- \\frac{2\\pi}{\\rho}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t)\n+ 8\\nu \\pi^{2}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t).\n$$\n对于 $s_{v}$，\n$$\ns_{v}(x,y,t) = -\\cos(2\\pi x)\\,\\sin(2pi y)\\,\\exp(t) + 2\\pi \\exp(2t)\\,\\sin(2\\pi y)\\,\\cos(2\\pi y)\n- \\frac{2\\pi}{\\rho}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(3t)\n- 8\\nu \\pi^{2}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\n- g\\beta\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t).\n$$\n\n对于热源，\n$$\ns_{T} = \\frac{\\partial T}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)T - \\alpha \\nabla^{2}T\n= 2\\,T + 0 - \\alpha \\left[-8\\pi^{2} T\\right]\n= \\left(2 + 8\\alpha \\pi^{2}\\right)\\,T,\n$$\n所以\n$$\ns_{T}(x,y,t) = \\left(2 + 8\\alpha \\pi^{2}\\right)\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t).\n$$\n\n这些源项是光滑、周期的，并且与交错网格排列兼容：面心速度场在连续层级上精确满足不可压缩性，确保在使用二阶中心差分进行离散且采样一致时，离散散度在截断和舍入误差范围内为零。压力和温度位于体心；上面计算的人造梯度和拉普拉斯算子是良定义的，并为代码验证提供了精确的右端项。\n\n按照要求的顺序收集三个源项以得到最终答案。",
            "answer": "$$\\boxed{\n\\begin{pmatrix}\ns_{u} \\\\\ns_{v} \\\\\ns_{T}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sin(2\\pi x)\\cos(2\\pi y)\\exp(t) + 2\\pi \\exp(2t)\\sin(2\\pi x)\\cos(2\\pi x) - \\frac{2\\pi}{\\rho}\\sin(2\\pi x)\\cos(2\\pi y)\\exp(3t) + 8\\nu \\pi^{2}\\sin(2\\pi x)\\cos(2\\pi y)\\exp(t) \\\\\n-\\cos(2\\pi x)\\sin(2\\pi y)\\exp(t) + 2\\pi \\exp(2t)\\sin(2\\pi y)\\cos(2\\pi y) - \\frac{2\\pi}{\\rho}\\cos(2\\pi x)\\sin(2\\pi y)\\exp(3t) - 8\\nu \\pi^{2}\\cos(2\\pi x)\\sin(2\\pi y)\\exp(t) - g\\beta\\sin(2\\pi x)\\sin(2\\pi y)\\exp(2t) \\\\\n\\left(2 + 8\\alpha \\pi^{2}\\right)\\sin(2\\pi x)\\sin(2\\pi y)\\exp(2t)\n\\end{pmatrix}\n}$$"
        }
    ]
}