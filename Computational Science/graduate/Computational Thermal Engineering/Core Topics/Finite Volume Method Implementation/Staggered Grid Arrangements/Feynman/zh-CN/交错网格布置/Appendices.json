{
    "hands_on_practices": [
        {
            "introduction": "压力速度解耦是同位网格方案中的一个关键数值问题，可能导致非物理解的产生。本练习通过一个简单的一维思想实验，揭示了标准中心差分格式如何无法“感知”特定的高频压力场。这个实践将为我们理解为何需要采用交错网格来确保压力与速度场之间的紧密耦合提供基本论据 。",
            "id": "3986241",
            "problem": "考虑在无体力情况下，以索引 $i$ 为中心的控制体的一维不可压缩动量平衡方程，其在间距为 $\\Delta x$ 的均匀网格上写为半离散有限体积形式：净压力贡献近似为东、西界面上的压力差除以 $\\Delta x$。在同位网格布局中，压力和速度都存储在单元中心，并使用常见的中心线性插值来获得界面压力。具体来说，设界面压力通过 $p_{i+\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i}+p_{i+1}\\right)$ 和 $p_{i-\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i-1}+p_{i}\\right)$ 计算，其中 $p_{j}$ 表示单元中心 $x_{j}=j\\,\\Delta x$ 处的压力。将作用在控制体 $i$ 上的无量纲压力定义为\n$$\n\\Phi_{i} \\equiv \\frac{-\\left(p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}\\right)}{\\Delta x\\,p_{0}}.\n$$\n你需要通过考虑振荡的、单元间交替的压力场 $p_{j}=p_{0}\\,(-1)^{j}$（其中 $p_{0}\\neq 0$ 是一个恒定振幅）来设计一个最小反例，以展示同位网格上的伪压力-速度解耦现象。从线性动量守恒以及所述的插值和差分规则出发，计算该 $p_{j}$ 对应的 $\\Phi_{i}$ 的单一值，并证明该值与 $i$ 无关。然后，运用有限体积法和网格布局的基本原理，定性解释为什么这个结果意味着在使用中心插值的同位网格上存在伪压力-速度解耦，以及为什么将速度置于界面、压力置于单元中心（一种交错网格布局）可以对相同的振荡压力场 $p_j$ 防止这种解耦。你最终报告的答案必须是 $\\Phi_{i}$ 的值，一个实数。无需四舍五入。请将答案表示为一个无量纲数。",
            "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n**第一步：提取已知条件**\n- 背景是一维不可压缩动量平衡。\n- 空间离散化方法是在间距为 $\\Delta x$ 的均匀网格上使用有限体积法。\n- 网格布局为同位网格，压力 $p$ 和速度 $u$ 存储在单元中心 $x_j=j\\,\\Delta x$。\n- 控制体 $i$ 的东界面上的压力通过插值得到 $p_{i+\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i}+p_{i+1}\\right)$。\n- 控制体 $i$ 的西界面上的压力通过插值得到 $p_{i-\\frac{1}{2}}=\\frac{1}{2}\\left(p_{i-1}+p_{i}\\right)$。\n- 作用在控制体 $i$ 上的净压力贡献除以体积为 $-\\frac{p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}}{\\Delta x}$。\n- 无量纲压力定义为 $\\Phi_{i} \\equiv \\frac{-\\left(p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}\\right)}{\\Delta x\\,p_{0}}$。\n- 待分析的压力场是一个振荡的、单元间交替的场：$p_{j}=p_{0}\\,(-1)^{j}$，其中 $p_{0}\\neq 0$ 是一个常数。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学基础**：该问题涉及计算流体动力学（CFD）中的一个经典且根本性的问题，即同位网格上的压力-速度解耦。其设置，包括使用中心插值和分析高频“棋盘格”压力模式，是一个标准的教科书示例，用以说明这种数值格式的缺陷以及采用交错网格的动机。这些原理牢固地建立在应用于流体动力学的数值分析之上。\n- **适定性**：该问题提供了计算 $\\Phi_{i}$ 值所需的所有定义和方程。关于定性解释的说明清晰，并与该领域的既定概念相关。存在一个唯一且有意义的解。\n- **客观性**：该问题以精确的技术语言陈述，不含主观或模糊的术语。\n\n该问题被认为是有效的，因为它具有科学基础、适定性和客观性。它没有违反任何无效标准。我们可以继续进行求解。\n\n**$\\Phi_{i}$ 的定量计算**\n\n目标是针对给定的压力场 $p_{j}=p_{0}\\,(-1)^{j}$ 计算无量纲压力 $\\Phi_{i}$。$\\Phi_{i}$ 的定义是：\n$$\n\\Phi_{i} = \\frac{-\\left(p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}\\right)}{\\Delta x\\,p_{0}}\n$$\n首先，我们使用给定的中心插值格式来计算单元界面上的压力 $p_{i+\\frac{1}{2}}$ 和 $p_{i-\\frac{1}{2}}$。任意单元中心 $j$ 处的压力由 $p_{j} = p_{0}\\,(-1)^{j}$ 给出。\n\n东界面处的压力 $p_{i+\\frac{1}{2}}$ 取决于单元中心 $i$ 和 $i+1$ 处的压力：\n$$\np_{i} = p_{0}\\,(-1)^{i}\n$$\n$$\np_{i+1} = p_{0}\\,(-1)^{i+1} = p_{0}\\,(-1) \\cdot (-1)^{i} = -p_{0}\\,(-1)^{i}\n$$\n使用插值公式：\n$$\np_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(p_{i}+p_{i+1}\\right) = \\frac{1}{2}\\left(p_{0}\\,(-1)^{i} + (-p_{0}\\,(-1)^{i})\\right) = \\frac{1}{2}\\left(0\\right) = 0\n$$\n接下来，西界面处的压力 $p_{i-\\frac{1}{2}}$ 取决于单元中心 $i-1$ 和 $i$ 处的压力：\n$$\np_{i-1} = p_{0}\\,(-1)^{i-1} = p_{0}\\,(-1)^{-1} \\cdot (-1)^{i} = -p_{0}\\,(-1)^{i}\n$$\n使用插值公式：\n$$\np_{i-\\frac{1}{2}} = \\frac{1}{2}\\left(p_{i-1}+p_{i}\\right) = \\frac{1}{2}\\left(-p_{0}\\,(-1)^{i} + p_{0}\\,(-1)^{i}\\right) = \\frac{1}{2}\\left(0\\right) = 0\n$$\n现在，将这些界面压力代回 $\\Phi_{i}$ 的表达式中：\n$$\n\\Phi_{i} = \\frac{-\\left(0 - 0\\right)}{\\Delta x\\,p_{0}} = \\frac{0}{\\Delta x\\,p_{0}}\n$$\n根据定义，由于 $\\Delta x \\neq 0$ 且 $p_{0} \\neq 0$，结果为：\n$$\n\\Phi_{i} = 0\n$$\n该值为常数 $0$，因此与索引 $i$ 无关，符合题目要求。\n\n**伪压力-速度解耦的定性解释**\n\n单元 $i$ 的动量方程中的压力梯度项在数值上近似为 $-\\frac{p_{i+\\frac{1}{2}}-p_{i-\\frac{1}{2}}}{\\Delta x}$。我们的计算表明，对于高度振荡的非均匀压力场 $p_{j} = p_{0}\\,(-1)^{j}$，这个离散压力梯度对每个控制体 $i$ 都恰好为零。\n\n这个结果是压力-速度解耦的核心。控制速度场的离散动量方程对这个特定的压力场变得完全“视而不见”。尽管压力场表现出强烈的单元间振荡（一种“棋盘格”或“锯齿”模式），数值格式计算出的压力梯度在任何地方都为零。而零压力梯度是人们在均匀压力场（$p_j = \\text{constant}$）下会计算出的结果。\n\n因此，速度场解不会对这些高频压力振荡做出响应。一个非物理的振荡压力场可以作为伪数值产物存在，而不会产生任何相应的流动，因为离散算子未能将其与速度场联系起来。这使得非物理的解能够满足离散化方程。压力场和速度场是“解耦”的，即速度不受这种非均匀压力模式的驱动。\n\n**关于交错网格为何能防止解耦的定性解释**\n\n由 Harlow 和 Welch 提出的交错网格布局（MAC 格式）解决了这个问题。在一维交错网格中，像压力 $p$ 这样的标量存储在单元中心（例如 $p_i, p_{i+1}$），而像速度 $u$ 这样的矢量存储在单元界面（例如 $u_{i-\\frac{1}{2}}, u_{i+\\frac{1}{2}}$）。\n\n考虑速度分量 $u_{i+\\frac{1}{2}}$ 的动量方程，该方程定义在以界面 $i+\\frac{1}{2}$ 为中心的控制体上。驱动该速度的压力的自然位置是相邻的单元中心 $i$ 和 $i+1$。因此，压力梯度项直接使用这些节点值进行近似，无需插值：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2}} \\approx \\frac{p_{i+1} - p_{i}}{\\Delta x}\n$$\n让我们对相同的振荡压力场 $p_{j}=p_{0}\\,(-1)^{j}$ 计算这个离散梯度：\n$$\np_{i+1} - p_{i} = p_{0}\\,(-1)^{i+1} - p_{0}\\,(-1)^{i} = p_{0}\\,(-1)^{i}(-1 - 1) = -2p_{0}\\,(-1)^{i}\n$$\n因此，界面 $i+\\frac{1}{2}$ 处的压力梯度为：\n$$\n\\frac{p_{i+1} - p_{i}}{\\Delta x} = \\frac{-2p_{0}\\,(-1)^{i}}{\\Delta x}\n$$\n这个结果是非零的（因为 $p_0 \\neq 0$）。离散压力梯度现在正确地“感知”到相邻单元之间巨大的压力差。这个强烈的非零梯度将驱动显著的速度响应。因为交错网格布局在最近邻压力和位于它们之间的速度分量之间建立了这种紧密的耦合，所以伪振荡压力场就不可能在不被速度场感知的情况下存在。任何此类压力模式都会被立即检测到并影响流动，从而防止了在采用中心插值的同位网格中出现的非物理解耦。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在一维案例的基础上，本练习将压力解耦的概念扩展到更实际的二维场景。通过构建一个二维“棋盘”压力场，我们将具体展示同位网格中心差分梯度算子的失效，并与交错网格梯度算子的有效性进行对比。这个练习不仅巩固了核心概念，还介绍了在二维有限体积法中使用的特定离散梯度算子 。",
            "id": "3986262",
            "problem": "考虑一个用于计算流体动力学(CFD)中的有限体积法(FVM)的二维均匀笛卡尔网格，其单元中心由整数 $(i,j)$ 索引，$x$ 和 $y$ 方向上的均匀间距分别为 $\\Delta x$ 和 $\\Delta y$，内部面位于半整数索引处。在单元中心定义了一个合成压力场 $p_{i,j}=(-1)^{i+j}$，适用于所有整数 $i,j$。在同位单元中心 $(i,j)$ 处的离散梯度算子是使用沿每个坐标方向的最近邻单元中心压力的二阶对称中心差分来定义的。在交错面处的离散法向梯度定义为两个相邻单元中心压力之差除以沿面法向的网格间距。从这些离散化定义和场 $p_{i,j}=(-1)^{i+j}$ 出发，推导以下量的解析表达式：\n- 在单元中心 $(i,j)$ 处的离散同位中心梯度的两个分量，以及\n- 同一单元的东面 $(i+\\tfrac{1}{2},j)$ 和北面 $(i,j+\\tfrac{1}{2})$ 处的面法向离散梯度。\n将每个量精确地用 $i$、$j$、$\\Delta x$ 和 $\\Delta y$ 表示。你的最终答案必须是一个将这四个量聚合为行矩阵的单一解析表达式。最终表达式中不包含单位。无需进行数值舍入。",
            "solution": "该问题是有效的，因为它在科学上基于计算流体动力学的原理，是适定的、客观的且内部一致的。我们将继续对所需量进行形式推导。\n\n该问题要求在给定的二维均匀笛卡尔网格上，针对给定的压力场，计算四个离散梯度量。压力场在由整数 $(i,j)$ 索引的单元中心处定义为：\n$$ p_{i,j} = (-1)^{i+j} $$\n\n首先，我们计算在单元中心 $(i,j)$ 处的离散同位中心梯度的两个分量。该算子使用二阶对称中心差分定义。\n\n同位梯度的 $x$ 分量，我们记为 $(\\nabla p)_{x,i,j}$，定义为：\n$$ (\\nabla p)_{x,i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2\\Delta x} $$\n为计算此值，我们首先求出相邻单元中心的压力值 $p_{i+1,j}$ 和 $p_{i-1,j}$。\n根据给定的压力场定义：\n$$ p_{i+1,j} = (-1)^{(i+1)+j} = (-1)^{i+j+1} = -(-1)^{i+j} $$\n$$ p_{i-1,j} = (-1)^{(i-1)+j} = (-1)^{i+j-1} = -(-1)^{i+j} $$\n将这些值代入梯度公式：\n$$ (\\nabla p)_{x,i,j} = \\frac{-(-1)^{i+j} - (-(-1)^{i+j})}{2\\Delta x} = \\frac{-(-1)^{i+j} + (-1)^{i+j}}{2\\Delta x} = \\frac{0}{2\\Delta x} = 0 $$\n\n同位梯度的 $y$ 分量 $(\\nabla p)_{y,i,j}$ 的定义类似：\n$$ (\\nabla p)_{y,i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2\\Delta y} $$\n相邻单元中心的压力值为：\n$$ p_{i,j+1} = (-1)^{i+(j+1)} = (-1)^{i+j+1} = -(-1)^{i+j} $$\n$$ p_{i,j-1} = (-1)^{i+(j-1)} = (-1)^{i+j-1} = -(-1)^{i+j} $$\n将这些值代入公式：\n$$ (\\nabla p)_{y,i,j} = \\frac{-(-1)^{i+j} - (-(-1)^{i+j})}{2\\Delta y} = \\frac{-(-1)^{i+j} + (-1)^{i+j}}{2\\Delta y} = \\frac{0}{2\\Delta y} = 0 $$\n对于这种“棋盘格”压力场，同位中心差分梯度的两个分量均为零，这一结果意义重大。它表明该离散格式无法检测到压力场中的高频振荡，这也是在流体动力学模拟中使用交错网格布置以避免此类伪压力模式的主要动机。\n\n其次，我们计算东面 $(i+\\frac{1}{2},j)$ 和北面 $(i,j+\\frac{1}{2})$ 处的面法向离散梯度。这种交错梯度定义为两个相邻单元中心压力之差除以网格间距。\n\n东面 $(i+\\frac{1}{2},j)$ 处的面法向梯度垂直于 $x$ 方向。相邻的单元中心是 $(i,j)$ 和 $(i+1,j)$。网格间距为 $\\Delta x$。我们将此量记为 $(\\nabla_n p)_{e}$。\n$$ (\\nabla_n p)_{e} = \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x} $$\n我们有 $p_{i,j} = (-1)^{i+j}$ 和 $p_{i+1,j} = -(-1)^{i+j}$。代入这些值可得：\n$$ (\\nabla_n p)_{e} = \\frac{-(-1)^{i+j} - (-1)^{i+j}}{\\Delta x} = \\frac{-2(-1)^{i+j}}{\\Delta x} $$\n\n北面 $(i,j+\\frac{1}{2})$ 处的面法向梯度垂直于 $y$ 方向。相邻的单元中心是 $(i,j)$ 和 $(i,j+1)$。网格间距为 $\\Delta y$。我们将此量记为 $(\\nabla_n p)_{n}$。\n$$ (\\nabla_n p)_{n} = \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}} = \\frac{p_{i,j+1} - p_{i,j}}{\\Delta y} $$\n我们有 $p_{i,j} = (-1)^{i+j}$ 和 $p_{i,j+1} = -(-1)^{i+j}$。代入这些值可得：\n$$ (\\nabla_n p)_{n} = \\frac{-(-1)^{i+j} - (-1)^{i+j}}{\\Delta y} = \\frac{-2(-1)^{i+j}}{\\Delta y} $$\n与同位梯度不同，交错梯度正确地得出了一个非零值，这表明它有能力解析棋盘格压力场。\n\n所需的四个量是：\n$1$. 在 $(i,j)$ 处的离散同位中心梯度的 $x$ 分量：$0$。\n$2$. 在 $(i,j)$ 处的离散同位中心梯度的 $y$ 分量：$0$。\n$3$. 在东面 $(i+\\frac{1}{2},j)$ 处的面法向离散梯度：$\\frac{-2(-1)^{i+j}}{\\Delta x}$。\n$4$. 在北面 $(i,j+\\frac{1}{2})$ 处的面法向离散梯度：$\\frac{-2(-1)^{i+j}}{\\Delta y}$。\n\n按要求将这四个量聚合为一个行矩阵，即可得出最终答案。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0 & 0 & \\frac{-2(-1)^{i+j}}{\\Delta x} & \\frac{-2(-1)^{i+j}}{\\Delta y} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在确立了为何使用交错网格之后，我们必须解决其带来的一个实际挑战：变量并非存储在同一位置。本练习专注于一项基本技能——在不同网格点之间进行数据插值，这对于构建对流项等至关重要。此外，本练习还通过泰勒级数展开来分析这些插值格式的精度，这是评估任何数值格式性能的核心步骤 。",
            "id": "3986256",
            "problem": "考虑一个用于计算流体力学 (CFD) 的有限体积法 (FVM) 的二维正交直线网格，该网格采用交错布局：标量温度场 $T(x,y)$ 存储在位于 $(x_i,y_j)$ 的标量控制体中心，而速度分量 $u(x,y)$ 和 $v(x,y)$ 分别存储在标量控制体法向面的中心，对于 $u$ 位于 $(x_{i+\\frac{1}{2}},y_j)$，对于 $v$ 位于 $(x_i,y_{j+\\frac{1}{2}})$。假设每个方向上的网格间距均为正且有限，在均匀网格上 $x_{i+\\frac{1}{2}}=\\frac{x_i+x_{i+1}}{2}$ 和 $y_{j+\\frac{1}{2}}=\\frac{y_j+y_{j+1}}{2}$，但在推导中允许非均匀间距 $x_{i+1}-x_i$ 和 $y_{j+1}-y_j$。设 $T(x,y)$ 和 $u(x,y)$ 足够光滑，在每个目标位置的邻域内具有直到三阶的连续偏导数。\n\n您的任务是：\n- 仅使用线性插值和沿网格线的距离，构建离散插值格式，将标量场 $T$ 从其存储位置 $(x_i,y_j)$ 映射到速度存储位置 $(x_{i+\\frac{1}{2}},y_j)$ 和 $(x_i,y_{j+\\frac{1}{2}})$。\n- 仅使用线性插值和沿网格线的距离，构建离散插值格式，将x方向速度分量 $u$ 从其存储位置 $(x_{i+\\frac{1}{2}},y_j)$ 映射到标量控制体北面中心 $(x_i,y_{j+\\frac{1}{2}})$。\n- 从相容性的定义出发，并围绕目标位置使用泰勒级数展开，分析每种插值的截断误差，并确定形式相容阶 $p$，使得当特征网格尺寸 $\\Delta$ 趋于零时，插值误差与 $C\\Delta^p$ 成比例。\n\n给出这三种插值共有的相容阶 $p$ 的单一整数值作为最终答案。无需四舍五入。最终答案必须没有单位。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n#### 第一步：提取已知条件\n- 使用二维正交直线网格进行计算流体力学 (CFD) 的有限体积法 (FVM) 计算。\n- 网格布局是交错的。\n- 标量温度场 $T(x,y)$ 存储在位于 $(x_i,y_j)$ 的标量控制体中心。\n- 速度分量 $u(x,y)$ 存储在标量控制体法向面的中心，位于 $(x_{i+\\frac{1}{2}},y_j)$。\n- 速度分量 $v(x,y)$ 存储在标量控制体法向面的中心，位于 $(x_i,y_{j+\\frac{1}{2}})$。\n- 每个方向上的网格间距均为正且有限。\n- 允许非均匀间距 $x_{i+1}-x_i$ 和 $y_{j+1}-y_j$。\n- 面中心位置定义为 $x_{i+\\frac{1}{2}}=\\frac{x_i+x_{i+1}}{2}$ 和 $y_{j+\\frac{1}{2}}=\\frac{y_j+y_{j+1}}{2}$。\n- $T(x,y)$ 和 $u(x,y)$ 足够光滑，具有直到三阶的连续偏导数。\n- 任务是为 $T$ 到速度位置以及为 $u$ 到标量面位置构建离散线性插值。\n- 任务包括分析每种插值的截断误差以找到共同的相容阶 $p$。\n\n#### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题是计算流体力学领域的一个基础练习，具体涉及交错网格（也称为MAC网格）上的数值离散化。所涉及的方法——线性插值和通过泰勒级数进行的截断误差分析——是数值分析中标准且严谨的数学技术。\n- **适定性**：问题陈述清晰，提供了所有必要的定义和条件。它要求推导特定的插值公式并对其精度进行形式化分析，从而得出一个唯一且有意义的解。\n- **客观性**：问题使用来自数学和工程学的精确、客观和标准的术语进行陈述。它没有歧义和主观内容。\n\n该问题没有违反任何无效性标准。它是分析离散格式的一个教科书式例子。\n\n#### 第三步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n解答按要求分为三部分：标量场 $T$ 的插值、速度分量 $u$ 的插值，以及对每种插值的相容性分析。\n\n#### 1. 将标量场 $T$ 插值到速度位置\n\na) **将 $T$ 插值到东面中心 $(x_{i+\\frac{1}{2}},y_j)$**\n\n目标位置位于标量节点 $(x_i, y_j)$ 和 $(x_{i+1}, y_j)$ 之间。沿 $x$ 轴使用线性插值：\n$$ T_{i+\\frac{1}{2},j}^{\\text{interp}} = T_{i,j} \\frac{x_{i+1} - x_{i+\\frac{1}{2}}}{x_{i+1} - x_i} + T_{i+1,j} \\frac{x_{i+\\frac{1}{2}} - x_i}{x_{i+1} - x_i} $$\n根据问题定义，$x_{i+\\frac{1}{2}} = \\frac{x_i+x_{i+1}}{2}$。代入后，权重都变为 $1/2$：\n$$ T_{i+\\frac{1}{2},j}^{\\text{interp}} = \\frac{T_{i,j} + T_{i+1,j}}{2} $$\n要分析截断误差，我们将 $T_{i,j}$ 和 $T_{i+1,j}$ 在目标点 $(x_{i+\\frac{1}{2}},y_j)$ 周围进行泰勒级数展开。令 $h_x = x_{i+1} - x_i$。\n$$ T_{i,j} = T(x_{i+\\frac{1}{2}}-\\frac{h_x}{2}, y_j) = T_{i+\\frac{1}{2},j} - \\frac{h_x}{2}\\frac{\\partial T}{\\partial x} + \\frac{1}{2}\\left(\\frac{h_x}{2}\\right)^2\\frac{\\partial^2 T}{\\partial x^2} - O(h_x^3) $$\n$$ T_{i+1,j} = T(x_{i+\\frac{1}{2}}+\\frac{h_x}{2}, y_j) = T_{i+\\frac{1}{2},j} + \\frac{h_x}{2}\\frac{\\partial T}{\\partial x} + \\frac{1}{2}\\left(\\frac{h_x}{2}\\right)^2\\frac{\\partial^2 T}{\\partial x^2} + O(h_x^3) $$\n将两者相加并除以 2：\n$$ \\frac{T_{i,j} + T_{i+1,j}}{2} = T_{i+\\frac{1}{2},j} + \\frac{h_x^2}{8}\\frac{\\partial^2 T}{\\partial x^2} + O(h_x^4) $$\n插值误差为 $T_{i+\\frac{1}{2},j}^{\\text{interp}} - T_{i+\\frac{1}{2},j}^{\\text{exact}} = \\frac{h_x^2}{8}\\frac{\\partial^2 T}{\\partial x^2} + O(h_x^4)$。误差与 $h_x^2$ 成正比，因此相容阶为 $p=2$。\n\nb) **将 $T$ 插值到北面中心 $(x_i,y_{j+\\frac{1}{2}})$**\n\n同理，沿 $y$ 轴在节点 $(x_i, y_j)$ 和 $(x_i, y_{j+1})$ 之间进行线性插值：\n$$ T_{i,j+\\frac{1}{2}}^{\\text{interp}} = \\frac{T_{i,j} + T_{i,j+1}}{2} $$\n其截断误差与 $h_y^2 = (y_{j+1}-y_j)^2$ 成正比。相容阶同样为 $p=2$。\n\n#### 2. 将 $x$ 方向速度分量 $u$ 插值到标量控制体北面中心\n\n目标位置是 $(x_i, y_{j+\\frac{1}{2}})$。该点被四个 $u$ 速度节点所包围：$u_{i-\\frac{1}{2},j}$、 $u_{i+\\frac{1}{2},j}$、 $u_{i-\\frac{1}{2},j+1}$ 和 $u_{i+\\frac{1}{2},j+1}$。最直接的线性插值方法是四点平均（或称双线性插值），这等效于先在一个方向插值，再在另一个方向插值。\n$$ u_{i,j+\\frac{1}{2}}^{\\text{interp}} = \\frac{u_{i-\\frac{1}{2},j} + u_{i+\\frac{1}{2},j} + u_{i-\\frac{1}{2},j+1} + u_{i+\\frac{1}{2},j+1}}{4} $$\n为分析其精度，我们在目标点 $(x_i, y_{j+\\frac{1}{2}})$ 周围展开所有四个点的值。为简单起见，假设网格均匀，间距为 $h_x$ 和 $h_y$。四个点的位置相对于目标点是 $(\\mp h_x/2, \\mp h_y/2)$。\n$$ u(x_i \\mp \\frac{h_x}{2}, y_{j+\\frac{1}{2}} \\mp \\frac{h_y}{2}) = u \\mp \\frac{h_x}{2}\\frac{\\partial u}{\\partial x} \\mp \\frac{h_y}{2}\\frac{\\partial u}{\\partial y} + \\frac{1}{2}\\left( \\frac{h_x^2}{4}\\frac{\\partial^2 u}{\\partial x^2} + \\frac{h_y^2}{4}\\frac{\\partial^2 u}{\\partial y^2} \\pm 2\\frac{h_x h_y}{4}\\frac{\\partial^2 u}{\\partial x \\partial y} \\right) + O(\\Delta^3) $$\n其中 $u$ 及其导数均在目标点 $(x_i, y_{j+\\frac{1}{2}})$ 处取值。\n将四个点的展开式相加时：\n- 一阶导数项（$\\frac{\\partial u}{\\partial x}$ 和 $\\frac{\\partial u}{\\partial y}$）两两抵消。\n- 二阶混合偏导数项（$\\frac{\\partial^2 u}{\\partial x \\partial y}$）也两两抵消。\n- 纯二阶导数项（$\\frac{\\partial^2 u}{\\partial x^2}$ 和 $\\frac{\\partial^2 u}{\\partial y^2}$）相加。\n总和为：\n$$ \\sum u = 4u + 4 \\cdot \\frac{1}{2} \\left( \\frac{h_x^2}{4}\\frac{\\partial^2 u}{\\partial x^2} + \\frac{h_y^2}{4}\\frac{\\partial^2 u}{\\partial y^2} \\right) + O(\\Delta^4) $$\n因此，四点平均值为：\n$$ u_{i,j+\\frac{1}{2}}^{\\text{interp}} = u + \\frac{1}{8} \\left( h_x^2\\frac{\\partial^2 u}{\\partial x^2} + h_y^2\\frac{\\partial^2 u}{\\partial y^2} \\right) + O(\\Delta^4) $$\n插值误差与 $h_x^2$ 和 $h_y^2$ 成正比。因此，该插值格式的相容阶也是 $p=2$。\n\n#### 3. 共同的相容阶\n\n所有三种线性插值格式的分析都表明，它们的截断误差与网格尺寸的平方成正比。因此，它们共有的相容阶是 $p=2$。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}