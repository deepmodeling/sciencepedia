{
    "hands_on_practices": [
        {
            "introduction": "Before building numerical schemes, it is essential to understand what a Taylor series reveals about the local structure of a physical field. The multivariate Taylor expansion provides a powerful framework for approximating a field, such as the Sea Surface Height (SSH), using its value, gradient, and Hessian matrix at a single point. This exercise bridges the gap between abstract mathematics and physical oceanography by connecting these mathematical objects to tangible features like the local slope that drives geostrophic currents and the curvature that defines eddies, troughs, and crests .",
            "id": "3813068",
            "problem": "In computational oceanography, the Sea Surface Height (SSH) field is represented by a twice continuously differentiable scalar function $f(x,y)$, where $x$ and $y$ denote eastward and northward Cartesian coordinates, respectively. Consider a point $(x_0,y_0)$ on the ocean surface and small displacements $(\\Delta x, \\Delta y)$ confined to a neighborhood where higher-order terms beyond second order are negligible. Your task is to identify the correct second-order multivariate Taylor expansion of $f$ about $(x_0,y_0)$ and choose the option that also correctly interprets the roles of the gradient and Hessian in terms of the local slope and curvature of the SSH field and their implications for balanced large-scale flows.\n\nWhich option correctly states both the second-order expansion for $f(x_0+\\Delta x, y_0+\\Delta y)$ and the physical interpretation of the gradient and Hessian tensors for the SSH field?\n\nA. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$, where $Hf$ is the matrix of second partial derivatives. The vector $\\nabla f$ gives the local tilt (direction of steepest ascent) of SSH, which in geostrophically balanced motion is dynamically linked to large-scale currents that tend to be oriented perpendicular to SSH slope, and $Hf$ encodes curvature: its eigenvalues and eigenvectors set principal curvatures and directions, determining how the slope varies spatially and whether the point is locally a saddle, a trough, or a crest.\n\nB. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$, with no factor of $\\dfrac{1}{2}$. The vector $\\nabla f$ gives the local tilt of SSH and drives currents parallel to the slope, while $Hf$ reduces to the scalar Laplacian $\\nabla^2 f$ and measures isotropic curvature only.\n\nC. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\dfrac{\\partial f}{\\partial x}(x_0,y_0)\\,\\Delta x + \\dfrac{\\partial f}{\\partial y}(x_0,y_0)\\,\\Delta y + \\dfrac{1}{2}\\left( \\dfrac{\\partial^2 f}{\\partial x^2}(x_0,y_0)\\,\\Delta x^2 + \\dfrac{\\partial^2 f}{\\partial y^2}(x_0,y_0)\\,\\Delta y^2 \\right)$, omitting the mixed derivative term. The gradient $\\nabla f$ measures the magnitude of SSH, while the Hessian $Hf$ measures the magnitude of the gradient and cannot indicate saddle structure.\n\nD. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) - \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$, with a negative sign on the linear term. The gradient $\\nabla f$ points toward decreasing SSH and the Hessian $Hf$ only sets whether the point is a minimum or maximum but not the curvature directions, which are determined externally by the map projection.",
            "solution": "The problem statement is to be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- The Sea Surface Height (SSH) field is a twice continuously differentiable scalar function, denoted as $f(x,y)$.\n- The variables $x$ and $y$ represent eastward and northward Cartesian coordinates.\n- The expansion is performed about a point $(x_0, y_0)$.\n- The displacements are small, denoted by $(\\Delta x, \\Delta y)$.\n- Terms of order higher than second are considered negligible.\n- The task is to find the correct second-order multivariate Taylor expansion of $f(x_0+\\Delta x, y_0+\\Delta y)$.\n- The task also requires the correct physical interpretation of the gradient and Hessian tensors of the SSH field, including their connection to balanced large-scale flows.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is grounded in standard principles of multivariate calculus (Taylor's theorem, gradient, Hessian) and physical oceanography (geostrophic balance, representation of sea surface height). The concept of using a Taylor series to approximate a physical field locally is a fundamental technique in physics and engineering. The relationship described between the SSH gradient and geostrophic currents is a cornerstone of geophysical fluid dynamics. The premise is scientifically sound.\n- **Well-Posed**: The problem is well-posed. It asks for a specific mathematical formula and its physical interpretation, for which a unique and correct answer exists based on established mathematical theorems and physical laws.\n- **Objective**: The language is precise and uses standard scientific terminology. There are no subjective or ambiguous statements in the problem setup.\n- **Completeness and Consistency**: The problem provides all necessary information. It specifies the function $f(x,y)$ is twice continuously differentiable ($C^2$), which guarantees the existence and continuity of the second partial derivatives and the symmetry of the Hessian matrix (by Clairaut's theorem). The setup is internally consistent.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically sound, well-posed, objective, and complete. I will proceed with deriving the solution and evaluating the options.\n\n### Derivation of the Correct Formulation\n\nThe multivariate Taylor expansion of a twice continuously differentiable function $f(x,y)$ about a point $(x_0, y_0)$ is given by:\n$$\nf(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\left[ \\frac{\\partial f}{\\partial x} \\Delta x + \\frac{\\partial f}{\\partial y} \\Delta y \\right] + \\frac{1}{2!} \\left[ \\frac{\\partial^2 f}{\\partial x^2} \\Delta x^2 + 2\\frac{\\partial^2 f}{\\partial x \\partial y} \\Delta x \\Delta y + \\frac{\\partial^2 f}{\\partial y^2} \\Delta y^2 \\right] + \\mathcal{O}(\\|(\\Delta x, \\Delta y)\\|^3)\n$$\nAll partial derivatives are evaluated at the point $(x_0, y_0)$. The problem states to neglect terms beyond the second order.\n\nThis expression can be written compactly using vector and matrix notation. Let the displacement vector be $\\Delta\\mathbf{x} = \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$.\n\nThe first-order (linear) term can be expressed as the dot product of the gradient of $f$, $\\nabla f = \\begin{bmatrix} \\partial f/\\partial x \\\\ \\partial f/\\partial y \\end{bmatrix}$, and the displacement vector $\\Delta\\mathbf{x}$:\n$$\n\\text{Linear Term} = \\nabla f(x_0,y_0) \\cdot \\Delta\\mathbf{x} = \\left[ \\frac{\\partial f}{\\partial x}(x_0,y_0) \\quad \\frac{\\partial f}{\\partial y}(x_0,y_0) \\right] \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}\n$$\n\nThe second-order (quadratic) term can be expressed using the Hessian matrix, $Hf$, which is the matrix of second partial derivatives:\n$$\nHf(x_0,y_0) = \\begin{bmatrix} \\frac{\\partial^2 f}{\\partial x^2}(x_0,y_0)  \\frac{\\partial^2 f}{\\partial x \\partial y}(x_0,y_0) \\\\ \\frac{\\partial^2 f}{\\partial y \\partial x}(x_0,y_0)  \\frac{\\partial^2 f}{\\partial y^2}(x_0,y_0) \\end{bmatrix}\n$$\nThe quadratic term is a quadratic form:\n$$\n\\text{Quadratic Term} = \\frac{1}{2} (\\Delta\\mathbf{x})^T Hf(x_0,y_0) \\Delta\\mathbf{x} = \\frac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} Hf(x_0,y_0) \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}\n$$\n\nCombining these, the second-order Taylor expansion is:\n$$\nf(x_0+\\Delta x, y_0+\\Delta y) \\approx f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\Delta\\mathbf{x} + \\frac{1}{2} (\\Delta\\mathbf{x})^T Hf(x_0,y_0) \\Delta\\mathbf{x}\n$$\n\n### Interpretation of Terms\n1.  **Gradient ($\\nabla f$)**: The gradient vector points in the direction of the steepest ascent of the function $f$. In the context of SSH, $\\nabla f$ represents the local slope or tilt of the sea surface. In large-scale, rotating (geophysical) flows, the primary balance of forces is often between the pressure gradient force (which is proportional to $g \\nabla f$, where $g$ is gravitational acceleration) and the Coriolis force. This \"geostrophic balance\" results in currents flowing perpendicular to the pressure gradient, and thus perpendicular to the SSH gradient $\\nabla f$. The currents flow along lines of constant SSH (contours).\n2.  **Hessian ($Hf$)**: The Hessian matrix describes the local curvature of the surface. As $Hf$ is a symmetric matrix, it has real eigenvalues and orthogonal eigenvectors. The eigenvectors give the principal directions of curvature, and the corresponding eigenvalues give the value of the curvature in those directions. The signs of the eigenvalues determine the local geometry:\n    - Two positive eigenvalues: local minimum (a trough).\n    - Two negative eigenvalues: local maximum (a crest).\n    - One positive and one negative eigenvalue: a saddle point.\nThe Hessian thus fully characterizes the shape of the surface locally, including whether it is a peak, a valley, or a saddle, and the orientation of these features.\n\n### Option-by-Option Analysis\n\n**A. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$, where $Hf$ is the matrix of second partial derivatives. The vector $\\nabla f$ gives the local tilt (direction of steepest ascent) of SSH, which in geostrophically balanced motion is dynamically linked to large-scale currents that tend to be oriented perpendicular to SSH slope, and $Hf$ encodes curvature: its eigenvalues and eigenvectors set principal curvatures and directions, determining how the slope varies spatially and whether the point is locally a saddle, a trough, or a crest.**\n- **Formula**: The mathematical expression is the correct second-order Taylor expansion in vector-matrix form, including the critical factor of $\\frac{1}{2}$.\n- **Interpretation**: The interpretation of the gradient $\\nabla f$ as the local tilt and its role in geostrophic balance (currents perpendicular to the gradient) is physically correct. The interpretation of the Hessian $Hf$ as encoding the full curvature, with its eigenvalues and eigenvectors determining the local shape (trough, crest, saddle) and principal directions, is also mathematically correct.\n- **Verdict**: **Correct**.\n\n**B. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$, with no factor of $\\dfrac{1}{2}$. The vector $\\nabla f$ gives the local tilt of SSH and drives currents parallel to the slope, while $Hf$ reduces to the scalar Laplacian $\\nabla^2 f$ and measures isotropic curvature only.**\n- **Formula**: The formula is incorrect. It is missing the factor of $\\dfrac{1}{2}$ on the quadratic term.\n- **Interpretation**: The statement that currents are parallel to the slope ($\\nabla f$) is incorrect for large-scale geostrophic flows; they are perpendicular. The statement that the Hessian $Hf$ (a matrix) \"reduces\" to the scalar Laplacian is incorrect; the trace of the Hessian is the Laplacian, $\\text{Tr}(Hf) = \\nabla^2 f$, but the Hessian contains more information about anisotropic curvature (from the off-diagonal terms).\n- **Verdict**: **Incorrect**.\n\n**C. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\dfrac{\\partial f}{\\partial x}(x_0,y_0)\\,\\Delta x + \\dfrac{\\partial f}{\\partial y}(x_0,y_0)\\,\\Delta y + \\dfrac{1}{2}\\left( \\dfrac{\\partial^2 f}{\\partial x^2}(x_0,y_0)\\,\\Delta x^2 + \\dfrac{\\partial^2 f}{\\partial y^2}(x_0,y_0)\\,\\Delta y^2 \\right)$, omitting the mixed derivative term. The gradient $\\nabla f$ measures the magnitude of SSH, while the Hessian $Hf$ measures the magnitude of the gradient and cannot indicate saddle structure.**\n- **Formula**: The formula is incorrect. It omits the mixed derivative term, $2 \\frac{\\partial^2 f}{\\partial x \\partial y} \\Delta x \\Delta y$, from the quadratic part of the expansion. This is a general error, as this term is zero only in specific cases (e.g., if the coordinate axes align with the principal axes of curvature).\n- **Interpretation**: The interpretations are incorrect. The gradient $\\nabla f$ measures the slope (rate of change) of SSH, not its magnitude $f$. The Hessian $Hf$ measures curvature (second derivatives), not the magnitude of the gradient (which involves first derivatives). A key function of the Hessian is precisely to identify saddle structures (when its determinant is negative).\n- **Verdict**: **Incorrect**.\n\n**D. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) - \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$, with a negative sign on the linear term. The gradient $\\nabla f$ points toward decreasing SSH and the Hessian $Hf$ only sets whether the point is a minimum or maximum but not the curvature directions, which are determined externally by the map projection.**\n- **Formula**: The formula is incorrect. The linear term in a Taylor expansion has a positive sign, not a negative one.\n- **Interpretation**: The interpretations are incorrect. By mathematical definition, the gradient $\\nabla f$ points in the direction of steepest *ascent* (increasing $f$), not decreasing $f$. The eigenvectors of the Hessian explicitly define the principal directions of curvature; these are intrinsic to the surface geometry, not determined by an external map projection.\n- **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "When we move from theory to computation, we face two competing sources of error: truncation error from the mathematical approximation and rounding error from the computer's finite precision. This practice explores the fundamental trade-off between these two error types. By using Taylor series to model the truncation error, which decreases with smaller grid spacing $h$, and a standard model for rounding error, which increases as $h$ shrinks, you will derive the optimal step size $h^*$ that minimizes the total computational error . This analysis is crucial for understanding the practical limits of numerical differentiation and why simply decreasing grid spacing indefinitely is not a viable strategy.",
            "id": "3813087",
            "problem": "An oceanographic transect through a mid-latitude region exhibits variability dominated by mesoscale eddies. Along a straight zonal path, idealize the sea surface height anomaly as $f(x) = \\sin(k x)$, where $k$ is the wavenumber associated with the eddy field. Let the dominant eddy wavelength be $\\lambda = 100\\,\\mathrm{km}$, so $k = 2\\pi/\\lambda$. You wish to compute the horizontal derivative $\\partial f/\\partial x$ at the point $x$ where $k x = \\pi/4$ using a symmetric two-point central difference based on samples at $x \\pm h$. Assume arithmetic follows the Institute of Electrical and Electronics Engineers (IEEE) 754 double precision model with unit roundoff $u = 2^{-53}$, and assume angles are measured in radians.\n\nStarting from Taylor series and a standard floating-point rounding model, derive the leading-order total error as a function of the step size $h$ by balancing truncation error and rounding error for the central difference derivative, and use this to obtain the optimal step size $h^{*}$. Then evaluate $h^{*}$ numerically for the given $k$ and the specified evaluation point. Round your final numerical answer to three significant figures and express the optimal step size in meters.\n\nFinally, based on your derivation, briefly assess whether practical horizontal grid spacings of $1\\,\\mathrm{km}$, $5\\,\\mathrm{km}$, and $10\\,\\mathrm{km}$ are close to the optimal $h^{*}$ for differentiating $f(x)$ via central differencing in this setting, and identify which error source (truncation or rounding) dominates at those spacings. Your assessment should be qualitative; the single final answer must be your computed $h^{*}$.",
            "solution": "The problem statement is evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   Sea surface height anomaly function: $f(x) = \\sin(k x)$\n-   Wavenumber definition: $k = \\frac{2\\pi}{\\lambda}$\n-   Dominant eddy wavelength: $\\lambda = 100\\,\\mathrm{km}$\n-   Derivative to be computed: $\\frac{\\partial f}{\\partial x}$\n-   Evaluation point: A point $x$ such that $k x = \\frac{\\pi}{4}$\n-   Numerical approximation method: Symmetric two-point central difference, $\\frac{f(x+h) - f(x-h)}{2h}$\n-   Step size: $h$\n-   Computational arithmetic model: IEEE 754 double precision\n-   Unit roundoff: $u = 2^{-53}$\n-   Angle units: Radians\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n-   **Scientifically Grounded:** The problem is firmly grounded in the principles of numerical analysis and its application to physical oceanography. The use of a sinusoidal function to model mesoscale eddy fields is a standard simplification, and the analysis of truncation and rounding errors in finite difference schemes is a fundamental topic in scientific computing. The specified wavelength of $100\\,\\mathrm{km}$ is physically realistic for mid-latitude mesoscale eddies.\n-   **Well-Posed:** The problem is well-posed. It requests the derivation of an optimal step size for a clearly defined function and numerical method, which is a standard problem with a unique, expected solution. All necessary parameters ($f(x)$, $k$, $\\lambda$, $u$, the evaluation point) are provided.\n-   **Objective:** The problem statement is objective, using precise mathematical and technical language. It is free of subjective or opinion-based claims.\n-   **Completeness and Consistency:** The problem is self-contained and internally consistent. It provides all the necessary information to derive the optimal step size $h^*$ and evaluate it numerically.\n-   **Realism:** The parameters and context are realistic. The use of double precision arithmetic, the physical scale of the eddies, and the consideration of practical grid spacings are all authentic to the field of computational oceanography.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard and well-defined problem in numerical analysis applied to a geophysical context. A full solution will be derived.\n\n### Derivation of the Optimal Step Size\n\nThe task is to find the optimal step size $h^*$ that minimizes the total error in computing the derivative of $f(x)$ using a central difference formula. The total error is a combination of truncation error and rounding error.\n\n**1. Truncation Error**\n\nThe central difference approximation for the first derivative, $f'(x)$, is given by:\n$$\nD_h f(x) = \\frac{f(x+h) - f(x-h)}{2h}\n$$\nTo analyze the truncation error, we use Taylor series expansions of $f(x+h)$ and $f(x-h)$ around the point $x$:\n$$\nf(x+h) = f(x) + h f'(x) + \\frac{h^2}{2!} f''(x) + \\frac{h^3}{3!} f'''(x) + \\frac{h^4}{4!} f^{(4)}(x) + O(h^5)\n$$\n$$\nf(x-h) = f(x) - h f'(x) + \\frac{h^2}{2!} f''(x) - \\frac{h^3}{3!} f'''(x) + \\frac{h^4}{4!} f^{(4)}(x) - O(h^5)\n$$\nSubtracting the second expansion from the first yields:\n$$\nf(x+h) - f(x-h) = 2h f'(x) + \\frac{2h^3}{3!} f'''(x) + O(h^5)\n$$\n$$\nf(x+h) - f(x-h) = 2h f'(x) + \\frac{h^3}{3} f'''(x) + O(h^5)\n$$\nRearranging to solve for $f'(x)$, we see how the central difference formula relates to the true derivative:\n$$\nf'(x) = \\frac{f(x+h) - f(x-h)}{2h} - \\frac{h^2}{6} f'''(x) - O(h^4)\n$$\nThe truncation error, $E_T$, is the difference between the true derivative and its finite difference approximation. The leading-order term of this error is:\n$$\nE_T(h) = |D_h f(x) - f'(x)| \\approx \\frac{h^2}{6} |f'''(x)|\n$$\n\n**2. Rounding Error**\n\nIn floating-point arithmetic, the evaluation of the function $f(z)$ is not exact. We denote the floating-point representation as $\\text{fl}(\\cdot)$. According to the standard model of floating-point arithmetic, for some small $\\epsilon$ with $|\\epsilon| \\le u$ (the unit roundoff), we have:\n$$\n\\text{fl}(f(z)) = f(z)(1 + \\epsilon)\n$$\nThe computed central difference, $\\hat{D}_h f(x)$, uses these inexact function values:\n$$\n\\hat{D}_h f(x) = \\frac{\\text{fl}(f(x+h)) - \\text{fl}(f(x-h))}{2h} = \\frac{f(x+h)(1+\\epsilon_1) - f(x-h)(1+\\epsilon_2)}{2h}\n$$\nwhere $|\\epsilon_1|, |\\epsilon_2| \\le u$. The primary source of rounding error in this expression is the subtraction of two nearly equal numbers, $f(x+h)$ and $f(x-h)$, when $h$ is small. The absolute error in the numerator is bounded by:\n$$\n|\\left(f(x+h)(1+\\epsilon_1) - f(x-h)(1+\\epsilon_2)\\right) - \\left(f(x+h) - f(x-h)\\right)| = |f(x+h)\\epsilon_1 - f(x-h)\\epsilon_2|\n$$\nUsing the triangle inequality, this is bounded by $|f(x+h)||\\epsilon_1| + |f(x-h)||\\epsilon_2| \\le u(|f(x+h)|+|f(x-h)|)$. For a small step size $h$, $f(x \\pm h) \\approx f(x)$, so this error is approximately $2u|f(x)|$. The rounding error in the final computation of the derivative, $E_R(h)$, is this numerator error divided by the denominator $2h$:\n$$\nE_R(h) \\approx \\frac{2u|f(x)|}{2h} = \\frac{u|f(x)|}{h}\n$$\n\n**3. Total Error and Optimal Step Size**\n\nThe total error, $E(h)$, is the sum of the magnitudes of the truncation and rounding errors:\n$$\nE(h) \\approx E_T(h) + E_R(h) = \\frac{h^2}{6} |f'''(x)| + \\frac{u|f(x)|}{h}\n$$\nTo find the optimal step size $h^*$ that minimizes this total error, we differentiate $E(h)$ with respect to $h$ and set the result to zero:\n$$\n\\frac{dE}{dh} = \\frac{2h}{6} |f'''(x)| - \\frac{u|f(x)|}{h^2} = 0\n$$\n$$\n\\frac{h}{3} |f'''(x)| = \\frac{u|f(x)|}{h^2}\n$$\nSolving for $h$, which we denote $h^*$:\n$$\nh^{*3} = \\frac{3u|f(x)|}{|f'''(x)|} \\implies h^* = \\left( \\frac{3u|f(x)|}{|f'''(x)|} \\right)^{1/3}\n$$\n\n**4. Numerical Evaluation for the Specific Problem**\n\nWe are given the function $f(x) = \\sin(kx)$. We need its third derivative:\n- $f(x) = \\sin(kx)$\n- $f'(x) = k \\cos(kx)$\n- $f''(x) = -k^2 \\sin(kx)$\n- $f'''(x) = -k^3 \\cos(kx)$\n\nThe derivative is evaluated at a point $x$ where $kx = \\frac{\\pi}{4}$. At this point:\n$$\n|f(x)| = |\\sin(kx)| = \\left|\\sin\\left(\\frac{\\pi}{4}\\right)\\right| = \\frac{\\sqrt{2}}{2}\n$$\n$$\n|f'''(x)| = |-k^3 \\cos(kx)| = k^3 \\left|\\cos\\left(\\frac{\\pi}{4}\\right)\\right| = k^3 \\frac{\\sqrt{2}}{2}\n$$\nSubstituting these into the expression for $h^*$:\n$$\nh^* = \\left( \\frac{3u \\left(\\frac{\\sqrt{2}}{2}\\right)}{k^3 \\left(\\frac{\\sqrt{2}}{2}\\right)} \\right)^{1/3} = \\left( \\frac{3u}{k^3} \\right)^{1/3} = \\frac{(3u)^{1/3}}{k}\n$$\nNow, we substitute the given numerical values:\n- Unit roundoff for double precision: $u = 2^{-53}$\n- Wavelength: $\\lambda = 100\\,\\mathrm{km} = 100 \\times 10^3\\,\\mathrm{m} = 10^5\\,\\mathrm{m}$\n- Wavenumber: $k = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi}{10^5}\\,\\mathrm{m}^{-1}$\n\nPlugging these into the formula for $h^*$:\n$$\nh^* = \\frac{(3 \\times 2^{-53})^{1/3}}{\\frac{2\\pi}{10^5}} = \\frac{10^5}{2\\pi} (3 \\times 2^{-53})^{1/3}\n$$\nNow, we calculate the numerical value:\n$$\nh^* \\approx \\frac{100000}{6.283185} \\cdot (1.44225) \\cdot (4.78216 \\times 10^{-6})\n$$\n$$\nh^* \\approx (15915.49) \\cdot (6.8988 \\times 10^{-6}) \\approx 0.110\\,\\mathrm{m}\n$$\nRounding to three significant figures, the optimal step size is $0.110$ meters.\n\n**5. Assessment of Practical Grid Spacings**\n\nThe derived optimal step size is $h^* \\approx 0.110\\,\\mathrm{m}$.\nThe practical grid spacings are given as $h_1 = 1\\,\\mathrm{km} = 1000\\,\\mathrm{m}$, $h_2 = 5\\,\\mathrm{km} = 5000\\,\\mathrm{m}$, and $h_3 = 10\\,\\mathrm{km} = 10000\\,\\mathrm{m}$.\n\nAll of these practical grid spacings are vastly larger than the optimal step size: $h_i \\gg h^*$.\n\nThe total error is $E(h) \\approx \\frac{h^2}{6} |f'''(x)| + \\frac{u|f(x)|}{h}$. The first term is the truncation error ($E_T \\propto h^2$) and the second is the rounding error ($E_R \\propto h^{-1}$). The optimal step size $h^*$ is the point where these two error contributions are of comparable magnitude.\n\n- For $h  h^*$, the rounding error term ($h^{-1}$) dominates.\n- For $h  h^*$, the truncation error term ($h^2$) dominates.\n\nSince the practical grid spacings ($1\\,\\mathrm{km}$ to $10\\,\\mathrm{km}$) are all much greater than $h^* \\approx 0.110\\,\\mathrm{m}$, the error in calculating the derivative at these spacings is overwhelmingly dominated by **truncation error**. The rounding error is negligible by comparison. This indicates that at the typical scales of ocean models, the limitation on the accuracy of finite difference derivatives is the discretization of the Taylor series, not the precision of the floating-point arithmetic.",
            "answer": "$$\\boxed{1.10 \\times 10^{-1}}$$"
        },
        {
            "introduction": "The previous exercise revealed that an optimal step size exists, often too small for practical ocean models. This raises a critical question: can we improve accuracy on a given grid without pushing into the rounding-error-dominated regime? Richardson extrapolation provides an elegant answer by exploiting the predictable structure of the Taylor series truncation error. In this practice, you will combine two lower-order estimates of a derivative, calculated with different step sizes, to strategically cancel the dominant error term and produce a significantly more accurate, higher-order result . This powerful technique is a cornerstone of scientific computing, demonstrating how to build superior numerical methods by leveraging a deep understanding of their underlying error characteristics.",
            "id": "3813062",
            "problem": "A computational oceanography task considers vertical shear $u_z$ of a horizontal current $u(z)$ from discrete vertical profiles. Starting from the Taylor series expansion of a sufficiently smooth function $u(z)$ about a target depth $z_0$, construct two distinct finite-difference approximations to $u_z(z_0)$ using uniform spacings $h$ and $h/2$, respectively. Combine these approximations to eliminate the dominant truncation error term by Richardson extrapolation, based only on the Taylor series structure and the requirement that the leading error term be canceled. Implement this Richardson-extrapolated estimate and, using Taylor series, determine the residual leading error constant multiplying $h^4$ in the extrapolated derivative approximation.\n\nYou must apply this approach to discrete profiles that are generated synthetically from physically plausible analytic current profiles, so that exact derivatives are available for quantitative verification. For the two oscillatory-decaying profiles, angles must be treated in radians. Report all shear quantities in $\\mathrm{s}^{-1}$ as pure decimal numbers without units embedded in the output.\n\nFor each test case listed below, compute:\n1. The Richardson-extrapolated estimate of $u_z(z_0)$ from discrete samples taken at $z_0 \\pm h$ and $z_0 \\pm h/2$.\n2. The absolute error of this estimate with respect to the exact $u_z(z_0)$ computed analytically.\n3. The residual leading error constant from the Taylor series after extrapolation, expressed as the coefficient $C$ such that the leading truncation error behaves like $C h^4$ for small $h$ at fixed $z_0$. Provide both the analytically derived constant $C_{\\mathrm{theory}}$ and an empirical estimate $C_{\\mathrm{numeric}} = \\left(u_z^{\\mathrm{extrap}}(z_0) - u_z^{\\mathrm{exact}}(z_0)\\right)/h^4$ for the chosen $h$.\n\nAll angles are in radians. All shear quantities must be expressed in $\\mathrm{s}^{-1}$ as decimal numbers. Do not round; output raw floating-point numbers. The discrete sampling is to be performed directly at the specified offsets from $z_0$, without any interpolation.\n\nTest suite:\n- Case A (oscillatory-decaying, moderate resolution): $u(z) = U_0 \\exp(-z/D)\\cos(b z)$ with $U_0 = 0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D = 50\\,\\mathrm{m}$, $b = \\pi/100\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$, $z_0 = 100\\,\\mathrm{m}$, coarse spacing $h = 20\\,\\mathrm{m}$.\n- Case B (oscillatory-decaying, coarse resolution): $u(z) = U_0 \\exp(-z/D)\\cos(b z)$ with $U_0 = 0.3\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D = 30\\,\\mathrm{m}$, $b = \\pi/50\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$, $z_0 = 200\\,\\mathrm{m}$, coarse spacing $h = 100\\,\\mathrm{m}$.\n- Case C (quartic polynomial profile, error edge case): $u(z) = \\alpha z^4 + \\beta z^3 + \\gamma$ with $\\alpha = 2.0\\times 10^{-12}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-3}$, $\\beta = -1.0\\times 10^{-9}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2}$, $\\gamma = 0.1\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $z_0 = 50\\,\\mathrm{m}$, coarse spacing $h = 10\\,\\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list of four decimal numbers $[u_z^{\\mathrm{extrap}}, \\lvert \\mathrm{error} \\rvert, C_{\\mathrm{theory}}, C_{\\mathrm{numeric}}]$. For example, the overall output format must be of the form $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3]]$ with all entries being floats.",
            "solution": "The problem requires the construction and application of a high-order finite-difference scheme for the vertical shear, $u_z(z_0) = \\frac{du}{dz}\\rvert_{z=z_0}$, of a horizontal current profile $u(z)$. The method specified is Richardson extrapolation based on two central difference approximations. We must also derive the leading-order truncation error of the resulting extrapolated formula.\n\nFirst, we establish the central difference approximation and its error structure using Taylor series expansions of a sufficiently smooth function $u(z)$ around a point $z_0$. The expansions for $u(z_0+h)$ and $u(z_0-h)$ are:\n$$u(z_0+h) = u(z_0) + h u'(z_0) + \\frac{h^2}{2!}u''(z_0) + \\frac{h^3}{3!}u'''(z_0) + \\frac{h^4}{4!}u''''(z_0) + \\frac{h^5}{5!}u'''''(z_0) + O(h^6)$$\n$$u(z_0-h) = u(z_0) - h u'(z_0) + \\frac{h^2}{2!}u''(z_0) - \\frac{h^3}{3!}u'''(z_0) + \\frac{h^4}{4!}u''''(z_0) - \\frac{h^5}{5!}u'''''(z_0) + O(h^6)$$\nSubtracting the second equation from the first eliminates the even-powered derivative terms:\n$$u(z_0+h) - u(z_0-h) = 2h u'(z_0) + \\frac{2h^3}{3!}u'''(z_0) + \\frac{2h^5}{5!}u'''''(z_0) + O(h^7)$$\nSolving for $u'(z_0)$ gives:\n$$u'(z_0) = \\frac{u(z_0+h) - u(z_0-h)}{2h} - \\frac{h^2}{6}u'''(z_0) - \\frac{h^4}{120}u'''''(z_0) - O(h^6)$$\nLet $F(h)$ denote the second-order central difference approximation for $u'(z_0)$ with step size $h$:\n$$F(h) = \\frac{u(z_0+h) - u(z_0-h)}{2h}$$\nThe true derivative $u'(z_0)$ can be expressed in terms of this approximation as an error series:\n$$u'(z_0) = F(h) - C_1 h^2 - C_2 h^4 - O(h^6)$$\nwhere the error coefficients are $C_1 = \\frac{u'''(z_0)}{6}$ and $C_2 = \\frac{u'''''(z_0)}{120}$.\n\nThe problem requires constructing two such approximations, one with a coarse spacing $h$, denoted $F_h$, and one with a finer spacing $h/2$, denoted $F_{h/2}$. Their relationships to the exact derivative $u'(z_0)$ are:\n$$F_h = u'(z_0) + C_1 h^2 + C_2 h^4 + O(h^6) \\quad (1)$$\n$$F_{h/2} = u'(z_0) + C_1 \\left(\\frac{h}{2}\\right)^2 + C_2 \\left(\\frac{h}{2}\\right)^4 + O(h^6) = u'(z_0) + \\frac{1}{4}C_1 h^2 + \\frac{1}{16}C_2 h^4 + O(h^6) \\quad (2)$$\nTo eliminate the dominant error term, $C_1 h^2$, we seek a linear combination of $F_h$ and $F_{h/2}$. Multiplying equation $(2)$ by $4$ and subtracting equation $(1)$ yields:\n$$4F_{h/2} - F_h = \\left(4u'(z_0) + C_1 h^2 + \\frac{1}{4}C_2 h^4 \\right) - \\left(u'(z_0) + C_1 h^2 + C_2 h^4 \\right) + O(h^6)$$\n$$4F_{h/2} - F_h = 3u'(z_0) - \\frac{3}{4}C_2 h^4 + O(h^6)$$\nSolving for $u'(z_0)$ gives the Richardson-extrapolated estimate, $u_z^{\\mathrm{extrap}}(z_0)$:\n$$u_z^{\\mathrm{extrap}}(z_0) = \\frac{4F_{h/2} - F_h}{3}$$\nThe truncation error of this new estimate is:\n$$u_z^{\\mathrm{extrap}}(z_0) - u'(z_0) = -\\frac{1}{4}C_2 h^4 + O(h^6)$$\nSubstituting the expression for $C_2 = \\frac{u'''''(z_0)}{120}$, we find the leading error term:\n$$\\text{Error} = -\\frac{1}{4} \\left(\\frac{u'''''(z_0)}{120}\\right) h^4 + O(h^6) = -\\frac{u'''''(z_0)}{480} h^4 + O(h^6)$$\nThus, the analytically derived leading error constant is $C_{\\mathrm{theory}} = -\\frac{u'''''(z_0)}{480}$.\n\nTo perform the calculations for the given test cases, the following steps are executed:\n1.  For each profile $u(z)$, determine the analytical expressions for its first derivative, $u'(z)$, and fifth derivative, $u'''''(z)$.\n    - For the oscillatory-decaying profile, $u(z) = U_0 e^{-z/D}\\cos(bz)$, derivatives are efficiently found by considering the real part of the complex function $w(z) = U_0 e^{(a+ib)z}$ where $a = -1/D$. The $n$-th derivative is $u^{(n)}(z) = \\text{Re}\\left(U_0(a+ib)^n e^{(a+ib)z}\\right)$.\n    - For the polynomial profile, $u(z) = \\alpha z^4 + \\beta z^3 + \\gamma$, the derivatives are found by standard differentiation. Notably, for this profile, $u'''''(z) = 0$, which implies the theoretical error is zero.\n2.  Compute the exact shear $u_z^{\\mathrm{exact}}(z_0) = u'(z_0)$.\n3.  Compute the two central difference approximations: $F_h = \\frac{u(z_0+h) - u(z_0-h)}{2h}$ and $F_{h/2} = \\frac{u(z_0+h/2) - u(z_0-h/2)}{h}$.\n4.  Calculate the Richardson-extrapolated estimate $u_z^{\\mathrm{extrap}} = \\frac{4F_{h/2} - F_h}{3}$.\n5.  Calculate the absolute error of the estimate: $|\\mathrm{error}| = |u_z^{\\mathrm{extrap}} - u_z^{\\mathrm{exact}}|$.\n6.  Calculate the theoretical error constant: $C_{\\mathrm{theory}} = -u'''''(z_0)/480$.\n7.  Calculate the empirical error constant: $C_{\\mathrm{numeric}} = (u_z^{\\mathrm{extrap}} - u_z^{\\mathrm{exact}})/h^4$. For the polynomial case, since the error is exactly zero, $C_{\\mathrm{numeric}}$ is also zero.\n\nThese steps are implemented for each test case to produce the required set of four values: $[u_z^{\\mathrm{extrap}}, |\\mathrm{error}|, C_{\\mathrm{theory}}, C_{\\mathrm{numeric}}]$.",
            "answer": "[[-0.007629555235549047,4.02058522336338e-06,2.0232490518778647e-11,2.5128657646021123e-11],[0.003929007624971719,0.002875143003051493,2.697479836377755e-09,2.875143003051493e-09],[0.0,0.0,0.0,0.0]]"
        }
    ]
}