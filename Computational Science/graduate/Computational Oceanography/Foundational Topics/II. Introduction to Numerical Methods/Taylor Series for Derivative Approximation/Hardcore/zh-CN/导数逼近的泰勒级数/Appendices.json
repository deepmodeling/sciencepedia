{
    "hands_on_practices": [
        {
            "introduction": "我们首先探讨多元泰勒级数如何为理解海洋学场的局部结构提供一个强大的框架。第一个练习  要求您将展开式中的数学项——梯度和黑塞矩阵——与海表面高度（Sea Surface Height, SSH）等场的关键物理性质联系起来。这些性质，如局部坡度和曲率，对于解释地转流和中尺度涡旋等海洋动力学现象至关重要，此练习旨在巩固理论与物理直觉之间的联系。",
            "id": "3813068",
            "problem": "在计算海洋学中，海面高度 (SSH) 场由一个二次连续可微的标量函数 $f(x,y)$ 表示，其中 $x$ 和 $y$ 分别表示向东和向北的笛卡尔坐标。考虑海面上的一个点 $(x_0,y_0)$ 以及限制在一个邻域内的微小位移 $(\\Delta x, \\Delta y)$，在该邻域中，高于二阶的高阶项可以忽略不计。您的任务是确定 $f$ 关于点 $(x_0,y_0)$ 的正确的二阶多元泰勒展开式，并选择一个能同时正确解释梯度和黑塞矩阵在海面高度场的局部斜率和曲率方面的作用，及其对平衡大尺度流的影响的选项。\n\n哪个选项既正确陈述了 $f(x_0+\\Delta x, y_0+\\Delta y)$ 的二阶展开式，又正确陈述了海面高度场的梯度和黑塞张量的物理释义？\n\nA. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$，其中 $Hf$ 是二阶偏导数矩阵。向量 $\\nabla f$ 给出了海面高度的局部倾斜（最陡上升方向），在地转平衡运动中，这与大尺度流动力学相关，这些流往往垂直于海面高度的斜率；而 $Hf$ 编码了曲率：它的特征值和特征向量设定了主曲率和主方向，从而决定了斜率在空间上如何变化，以及该点局部是鞍点、槽还是脊。\n\nB. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$，没有因子 $\\dfrac{1}{2}$。向量 $\\nabla f$ 给出了海面高度的局部倾斜，并驱动平行于斜率的流，而 $Hf$ 简化为标量拉普拉斯算子 $\\nabla^2 f$ 且仅测量各向同性的曲率。\n\nC. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\dfrac{\\partial f}{\\partial x}(x_0,y_0)\\,\\Delta x + \\dfrac{\\partial f}{\\partial y}(x_0,y_0)\\,\\Delta y + \\dfrac{1}{2}\\left( \\dfrac{\\partial^2 f}{\\partial x^2}(x_0,y_0)\\,\\Delta x^2 + \\dfrac{\\partial^2 f}{\\partial y^2}(x_0,y_0)\\,\\Delta y^2 \\right)$，省略了混合偏导数项。梯度 $\\nabla f$ 测量海面高度的大小，而黑塞矩阵 $Hf$ 测量梯度的大小，且不能指示鞍点结构。\n\nD. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) - \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$，线性项带有负号。梯度 $\\nabla f$ 指向海面高度减小的方向，而黑塞矩阵 $Hf$ 仅确定该点是最小值点还是最大值点，而不确定曲率方向，曲率方向由地图投影从外部确定。",
            "solution": "在尝试解答之前，需要对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 海面高度 (SSH) 场是一个二次连续可微的标量函数，记为 $f(x,y)$。\n- 变量 $x$ 和 $y$ 分别表示向东和向北的笛卡尔坐标。\n- 展开是围绕点 $(x_0, y_0)$ 进行的。\n- 位移是微小的，记为 $(\\Delta x, \\Delta y)$。\n- 高于二阶的项被认为是可忽略的。\n- 任务是找到 $f(x_0+\\Delta x, y_0+\\Delta y)$ 的正确的二阶多元泰勒展开式。\n- 任务还要求对海面高度场的梯度和黑塞张量给出正确的物理释义，包括它们与平衡大尺度流的联系。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于多元微积分（泰勒定理、梯度、黑塞矩阵）和物理海洋学（地转平衡、海面高度表示）的标准原理。使用泰勒级数局部逼近物理场的概念是物理学和工程学中的一项基本技术。所描述的海面高度梯度与地转流之间的关系是地球物理流体动力学的基石。该前提在科学上是合理的。\n- **适定性**：该问题是适定的。它要求一个特定的数学公式及其物理释义，基于已建立的数学定理和物理定律，存在唯一且正确的答案。\n- **客观性**：语言精确，并使用了标准的科学术语。问题设置中没有主观或模糊的陈述。\n- **完整性与一致性**：该问题提供了所有必要的信息。它指明函数 $f(x,y)$ 是二次连续可微的 ($C^2$)，这保证了二阶偏导数的存在性和连续性，以及黑塞矩阵的对称性（根据 Clairaut 定理）。该设置是内部一致的。\n\n### 步骤3：结论与行动\n问题陈述有效。它在科学上是合理的、适定的、客观的和完整的。我将继续推导解答并评估各个选项。\n\n### 正确公式的推导\n\n一个二次连续可微函数 $f(x,y)$ 关于点 $(x_0, y_0)$ 的多元泰勒展开式由下式给出：\n$$\nf(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\left[ \\frac{\\partial f}{\\partial x} \\Delta x + \\frac{\\partial f}{\\partial y} \\Delta y \\right] + \\frac{1}{2!} \\left[ \\frac{\\partial^2 f}{\\partial x^2} \\Delta x^2 + 2\\frac{\\partial^2 f}{\\partial x \\partial y} \\Delta x \\Delta y + \\frac{\\partial^2 f}{\\partial y^2} \\Delta y^2 \\right] + \\mathcal{O}(\\|(\\Delta x, \\Delta y)\\|^3)\n$$\n所有偏导数都在点 $(x_0, y_0)$ 处求值。问题陈述要求忽略高于二阶的项。\n\n这个表达式可以用向量和矩阵表示法紧凑地写出。设位移向量为 $\\Delta\\mathbf{x} = \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$。\n\n一阶（线性）项可以表示为 $f$ 的梯度 $\\nabla f = \\begin{bmatrix} \\partial f/\\partial x \\\\ \\partial f/\\partial y \\end{bmatrix}$ 与位移向量 $\\Delta\\mathbf{x}$ 的点积：\n$$\n\\text{线性项} = \\nabla f(x_0,y_0) \\cdot \\Delta\\mathbf{x} = \\left[ \\frac{\\partial f}{\\partial x}(x_0,y_0) \\quad \\frac{\\partial f}{\\partial y}(x_0,y_0) \\right] \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}\n$$\n\n二阶（二次）项可以使用黑塞矩阵 $Hf$ 来表示，它是二阶偏导数的矩阵：\n$$\nHf(x_0,y_0) = \\begin{bmatrix} \\frac{\\partial^2 f}{\\partial x^2}(x_0,y_0)  \\frac{\\partial^2 f}{\\partial x \\partial y}(x_0,y_0) \\\\ \\frac{\\partial^2 f}{\\partial y \\partial x}(x_0,y_0)  \\frac{\\partial^2 f}{\\partial y^2}(x_0,y_0) \\end{bmatrix}\n$$\n二次项是一个二次型：\n$$\n\\text{二次项} = \\frac{1}{2} (\\Delta\\mathbf{x})^T Hf(x_0,y_0) \\Delta\\mathbf{x} = \\frac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} Hf(x_0,y_0) \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}\n$$\n\n结合这些，二阶泰勒展开式为：\n$$\nf(x_0+\\Delta x, y_0+\\Delta y) \\approx f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\Delta\\mathbf{x} + \\frac{1}{2} (\\Delta\\mathbf{x})^T Hf(x_0,y_0) \\Delta\\mathbf{x}\n$$\n\n### 各项的释义\n1.  **梯度 ($\\nabla f$)**：梯度向量指向函数 $f$ 的最陡上升方向。在海面高度的背景下，$\\nabla f$ 代表海面的局部斜率或倾斜。在大尺度的旋转（地球物理）流中，主要的力量平衡通常发生在压力梯度力（与 $g \\nabla f$ 成正比，其中 $g$ 是重力加速度）和科里奥利力之间。这种“地转平衡”导致水流垂直于压力梯度方向流动，因此也垂直于海面高度梯度 $\\nabla f$。水流沿着等海面高度线（等值线）流动。\n2.  **黑塞矩阵 ($Hf$)**：黑塞矩阵描述了曲面的局部曲率。由于 $Hf$ 是一个对称矩阵，它有实特征值和正交特征向量。特征向量给出了曲率的主方向，而相应的特征值给出了这些方向上的曲率值。特征值的符号决定了局部几何形状：\n    - 两个正特征值：局部最小值（一个槽）。\n    - 两个负特征值：局部最大值（一个脊）。\n    - 一个正特征值和一个负特征值：一个鞍点。\n因此，黑塞矩阵完全刻画了曲面的局部形状，包括它是一个峰、一个谷还是一个鞍点，以及这些特征的方向。\n\n### 逐项分析\n\n**A. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$，其中 $Hf$ 是二阶偏导数矩阵。向量 $\\nabla f$ 给出了海面高度的局部倾斜（最陡上升方向），在地转平衡运动中，这与大尺度流动力学相关，这些流往往垂直于海面高度的斜率；而 $Hf$ 编码了曲率：它的特征值和特征向量设定了主曲率和主方向，从而决定了斜率在空间上如何变化，以及该点局部是鞍点、槽还是脊。**\n- **公式**：该数学表达式是正确的向量-矩阵形式的二阶泰勒展开式，包括了关键因子 $\\frac{1}{2}$。\n- **释义**：将梯度 $\\nabla f$ 解释为局部倾斜及其在地转平衡中的作用（水流垂直于梯度）在物理上是正确的。将黑塞矩阵 $Hf$ 解释为编码了完整曲率，其特征值和特征向量决定了局部形状（槽、脊、鞍点）和主方向，这在数学上也是正确的。\n- **结论**：**正确**。\n\n**B. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$，没有因子 $\\dfrac{1}{2}$。向量 $\\nabla f$ 给出了海面高度的局部倾斜，并驱动平行于斜率的流，而 $Hf$ 简化为标量拉普拉斯算子 $\\nabla^2 f$ 且仅测量各向同性的曲率。**\n- **公式**：公式不正确。它在二次项上缺少了因子 $\\dfrac{1}{2}$。\n- **释义**：对于大尺度地转流，水流平行于斜率 ($\\nabla f$) 的说法是不正确的；它们是垂直的。黑塞矩阵 $Hf$（一个矩阵）“简化”为标量拉普拉斯算子的说法是不正确的；黑塞矩阵的迹是拉普拉斯算子，$\\text{Tr}(Hf) = \\nabla^2 f$，但黑塞矩阵包含更多关于各向异性曲率的信息（来自非对角线项）。\n- **结论**：**不正确**。\n\n**C. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) + \\dfrac{\\partial f}{\\partial x}(x_0,y_0)\\,\\Delta x + \\dfrac{\\partial f}{\\partial y}(x_0,y_0)\\,\\Delta y + \\dfrac{1}{2}\\left( \\dfrac{\\partial^2 f}{\\partial x^2}(x_0,y_0)\\,\\Delta x^2 + \\dfrac{\\partial^2 f}{\\partial y^2}(x_0,y_0)\\,\\Delta y^2 \\right)$，省略了混合偏导数项。梯度 $\\nabla f$ 测量海面高度的大小，而黑塞矩阵 $Hf$ 测量梯度的大小，且不能指示鞍点结构。**\n- **公式**：公式不正确。它从展开式的二次部分中省略了混合偏导数项 $2 \\frac{\\partial^2 f}{\\partial x \\partial y} \\Delta x \\Delta y$。这是一个普遍性错误，因为只有在特定情况下（例如，坐标轴与曲率主轴对齐时），该项才为零。\n- **释义**：释义不正确。梯度 $\\nabla f$ 测量的是海面高度的斜率（变化率），而不是其大小 $f$。黑塞矩阵 $Hf$ 测量的是曲率（二阶导数），而不是梯度的大小（其涉及一阶导数）。黑塞矩阵的一个关键功能恰恰是识别鞍点结构（当其行列式为负时）。\n- **结论**：**不正确**。\n\n**D. $f(x_0+\\Delta x, y_0+\\Delta y) = f(x_0,y_0) - \\nabla f(x_0,y_0) \\cdot \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix} + \\dfrac{1}{2} \\begin{bmatrix} \\Delta x  \\Delta y \\end{bmatrix} \\, Hf(x_0,y_0) \\, \\begin{bmatrix} \\Delta x \\\\ \\Delta y \\end{bmatrix}$，线性项带有负号。梯度 $\\nabla f$ 指向海面高度减小的方向，而黑塞矩阵 $Hf$ 仅确定该点是最小值点还是最大值点，而不确定曲率方向，曲率方向由地图投影从外部确定。**\n- **公式**：公式不正确。泰勒展开式中的线性项应为正号，而不是负号。\n- **释义**：释义不正确。根据数学定义，梯度 $\\nabla f$ 指向最陡*上升*（$f$ 增加）的方向，而不是 $f$ 减小的方向。黑塞矩阵的特征向量明确定义了曲率的主方向；这些是曲面几何的内在属性，不是由外部的地图投影决定的。\n- **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然泰勒级数使我们能够近似导数，但实际计算会引入两种相互竞争的误差：源于近似本身的截断误差，以及源于有限精度计算的舍入误差。本练习  将引导您进行一项关键分析，以平衡这两种误差，从而推导出能使总误差最小化的最佳步长 $h^*$。理解这种权衡对于在数值模型中就网格分辨率做出明智的决策至关重要。",
            "id": "3813087",
            "problem": "一个穿过中纬度区域的海洋学断面显示出以中尺度涡为主的变化特征。沿一条笔直的纬向路径，将海面高度异常理想化为 $f(x) = \\sin(k x)$，其中 $k$ 是与涡旋场相关的波数。设主导的涡旋波长为 $\\lambda = 100\\,\\mathrm{km}$，因此 $k = 2\\pi/\\lambda$。您希望使用基于 $x \\pm h$ 处采样的对称两点中心差分法，在 $k x = \\pi/4$ 的点 $x$ 处计算水平导数 $\\partial f/\\partial x$。假设算术运算遵循电气与电子工程师协会（IEEE）754双精度模型，单位舍入误差为 $u = 2^{-53}$，并假设角度以弧度为单位。\n\n从泰勒级数和标准浮点舍入模型出发，通过平衡中心差分导数的截断误差和舍入误差，推导总误差的主导项作为步长 $h$ 的函数，并用此求得最优步长 $h^{*}$。然后，根据给定的 $k$ 和指定的求值点，对 $h^{*}$ 进行数值计算。将您的最终数值答案四舍五入至三位有效数字，并以米为单位表示最优步长。\n\n最后，根据您的推导，简要评估 $1\\,\\mathrm{km}$、$5\\,\\mathrm{km}$ 和 $10\\,\\mathrm{km}$ 的实际水平网格间距是否接近于在此设置下通过中心差分法对 $f(x)$ 求导的最优步长 $h^{*}$，并指出在这些间距下哪种误差源（截断误差或舍入误差）占主导地位。您的评估应为定性评估；唯一的最终答案必须是您计算出的 $h^{*}$。",
            "solution": "在进行求解之前，首先评估问题陈述的有效性。\n\n### 第1步：提取已知条件\n-   海面高度异常函数：$f(x) = \\sin(k x)$\n-   波数定义：$k = \\frac{2\\pi}{\\lambda}$\n-   主导涡旋波长：$\\lambda = 100\\,\\mathrm{km}$\n-   待计算的导数：$\\frac{\\partial f}{\\partial x}$\n-   求值点：一个点 $x$，使得 $k x = \\frac{\\pi}{4}$\n-   数值近似方法：对称两点中心差分，$\\frac{f(x+h) - f(x-h)}{2h}$\n-   步长：$h$\n-   计算算术模型：IEEE 754 双精度\n-   单位舍入误差：$u = 2^{-53}$\n-   角度单位：弧度\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n-   **科学依据：** 该问题牢固地植根于数值分析原理及其在物理海洋学中的应用。使用正弦函数模拟中尺度涡旋场是一种标准的简化方法，而分析有限差分格式中的截断误差和舍入误差是科学计算中的一个基本课题。指定的 $100\\,\\mathrm{km}$ 波长对于中纬度中尺度涡旋是物理上现实的。\n-   **适定性：** 该问题是适定的。它要求为一个明确定义的函数和数值方法推导最优步长，这是一个具有唯一预期解的标准问题。所有必需的参数（$f(x)$、$k$、$\\lambda$、$u$、求值点）都已提供。\n-   **客观性：** 问题陈述是客观的，使用了精确的数学和技术语言。它不含主观或基于意见的论断。\n-   **完整性和一致性：** 该问题是自洽且内部一致的。它提供了推导最优步长 $h^*$ 并对其进行数值计算所需的所有信息。\n-   **现实性：** 参数和背景是现实的。双精度算术的使用、涡旋的物理尺度以及对实际网格间距的考虑都符合计算海洋学领域的实际情况。\n\n### 第3步：结论与行动\n该问题是有效的。这是一个应用于地球物理背景下的标准且定义明确的数值分析问题。将推导完整的解答。\n\n### 最优步长的推导\n\n任务是找到最优步长 $h^*$，使得在使用中心差分公式计算 $f(x)$ 导数时的总误差最小。总误差是截断误差和舍入误差的组合。\n\n**1. 截断误差**\n\n一阶导数 $f'(x)$ 的中心差分近似由下式给出：\n$$\nD_h f(x) = \\frac{f(x+h) - f(x-h)}{2h}\n$$\n为了分析截断误差，我们使用 $f(x+h)$ 和 $f(x-h)$ 在点 $x$ 附近的泰勒级数展开：\n$$\nf(x+h) = f(x) + h f'(x) + \\frac{h^2}{2!} f''(x) + \\frac{h^3}{3!} f'''(x) + \\frac{h^4}{4!} f^{(4)}(x) + O(h^5)\n$$\n$$\nf(x-h) = f(x) - h f'(x) + \\frac{h^2}{2!} f''(x) - \\frac{h^3}{3!} f'''(x) + \\frac{h^4}{4!} f^{(4)}(x) - O(h^5)\n$$\n将第二个展开式从第一个中减去，得到：\n$$\nf(x+h) - f(x-h) = 2h f'(x) + \\frac{2h^3}{3!} f'''(x) + O(h^5)\n$$\n$$\nf(x+h) - f(x-h) = 2h f'(x) + \\frac{h^3}{3} f'''(x) + O(h^5)\n$$\n重新整理以求解 $f'(x)$，我们可以看到中心差分公式与真实导数的关系：\n$$\nf'(x) = \\frac{f(x+h) - f(x-h)}{2h} - \\frac{h^2}{6} f'''(x) - O(h^4)\n$$\n截断误差 $E_T$ 是真实导数与其有限差分近似之间的差。该误差的主导项是：\n$$\nE_T(h) = |D_h f(x) - f'(x)| \\approx \\frac{h^2}{6} |f'''(x)|\n$$\n\n**2. 舍入误差**\n\n在浮点运算中，函数 $f(z)$ 的求值不是精确的。我们将浮点表示法记为 $\\text{fl}(\\cdot)$。根据标准浮点算术模型，对于某个小的 $\\epsilon$ 且 $|\\epsilon| \\le u$（单位舍入误差），我们有：\n$$\n\\text{fl}(f(z)) = f(z)(1 + \\epsilon)\n$$\n计算出的中心差分 $\\hat{D}_h f(x)$ 使用了这些不精确的函数值：\n$$\n\\hat{D}_h f(x) = \\frac{\\text{fl}(f(x+h)) - \\text{fl}(f(x-h))}{2h} = \\frac{f(x+h)(1+\\epsilon_1) - f(x-h)(1+\\epsilon_2)}{2h}\n$$\n其中 $|\\epsilon_1|, |\\epsilon_2| \\le u$。此表达式中舍入误差的主要来源是当 $h$ 很小时，两个几乎相等的数 $f(x+h)$ 和 $f(x-h)$ 相减。分子中的绝对误差有界于：\n$$\n|\\left(f(x+h)(1+\\epsilon_1) - f(x-h)(1+\\epsilon_2)\\right) - \\left(f(x+h) - f(x-h)\\right)| = |f(x+h)\\epsilon_1 - f(x-h)\\epsilon_2|\n$$\n使用三角不等式，其界限为 $|f(x+h)||\\epsilon_1| + |f(x-h)||\\epsilon_2| \\le u(|f(x+h)|+|f(x-h)|)$。对于小步长 $h$，$f(x \\pm h) \\approx f(x)$，因此这个误差大约是 $2u|f(x)|$。导数最终计算中的舍入误差 $E_R(h)$ 是这个分子误差除以分母 $2h$：\n$$\nE_R(h) \\approx \\frac{2u|f(x)|}{2h} = \\frac{u|f(x)|}{h}\n$$\n\n**3. 总误差和最优步长**\n\n总误差 $E(h)$ 是截断误差和舍入误差大小之和：\n$$\nE(h) \\approx E_T(h) + E_R(h) = \\frac{h^2}{6} |f'''(x)| + \\frac{u|f(x)|}{h}\n$$\n为了找到最小化该总误差的最优步长 $h^*$，我们将 $E(h)$ 对 $h$ 求导并令其结果为零：\n$$\n\\frac{dE}{dh} = \\frac{2h}{6} |f'''(x)| - \\frac{u|f(x)|}{h^2} = 0\n$$\n$$\n\\frac{h}{3} |f'''(x)| = \\frac{u|f(x)|}{h^2}\n$$\n求解 $h$，我们将其表示为 $h^*$：\n$$\nh^{*3} = \\frac{3u|f(x)|}{|f'''(x)|} \\implies h^* = \\left( \\frac{3u|f(x)|}{|f'''(x)|} \\right)^{1/3}\n$$\n\n**4. 针对具体问题的数值计算**\n\n我们给定的函数是 $f(x) = \\sin(kx)$。我们需要它的三阶导数：\n- $f(x) = \\sin(kx)$\n- $f'(x) = k \\cos(kx)$\n- $f''(x) = -k^2 \\sin(kx)$\n- $f'''(x) = -k^3 \\cos(kx)$\n\n导数在点 $x$ 处求值，其中 $kx = \\frac{\\pi}{4}$。在该点：\n$$\n|f(x)| = |\\sin(kx)| = \\left|\\sin\\left(\\frac{\\pi}{4}\\right)\\right| = \\frac{\\sqrt{2}}{2}\n$$\n$$\n|f'''(x)| = |-k^3 \\cos(kx)| = k^3 \\left|\\cos\\left(\\frac{\\pi}{4}\\right)\\right| = k^3 \\frac{\\sqrt{2}}{2}\n$$\n将这些代入 $h^*$ 的表达式中：\n$$\nh^* = \\left( \\frac{3u \\left(\\frac{\\sqrt{2}}{2}\\right)}{k^3 \\left(\\frac{\\sqrt{2}}{2}\\right)} \\right)^{1/3} = \\left( \\frac{3u}{k^3} \\right)^{1/3} = \\frac{(3u)^{1/3}}{k}\n$$\n现在，我们代入给定的数值：\n- 双精度单位舍入误差：$u = 2^{-53}$\n- 波长：$\\lambda = 100\\,\\mathrm{km} = 100 \\times 10^3\\,\\mathrm{m} = 10^5\\,\\mathrm{m}$\n- 波数：$k = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi}{10^5}\\,\\mathrm{m}^{-1}$\n\n将这些值代入 $h^*$ 的公式中：\n$$\nh^* = \\frac{(3 \\times 2^{-53})^{1/3}}{\\frac{2\\pi}{10^5}} = \\frac{10^5}{2\\pi} (3 \\times 2^{-53})^{1/3}\n$$\n现在，我们计算数值：\n$$\nh^* = \\frac{10^5}{2\\pi} \\cdot 3^{1/3} \\cdot 2^{-53/3} \\approx \\frac{100000}{6.283185} \\cdot (1.44225) \\cdot (4.78216 \\times 10^{-6})\n$$\n$$\nh^* \\approx (15915.49) \\cdot (6.8988 \\times 10^{-6}) \\approx 0.110\\,\\mathrm{m}\n$$\n四舍五入至三位有效数字，最优步长为 $0.110$ 米。\n\n**5. 对实际网格间距的评估**\n\n推导出的最优步长为 $h^* \\approx 0.110\\,\\mathrm{m}$。\n给出的实际网格间距为 $h_1 = 1\\,\\mathrm{km} = 1000\\,\\mathrm{m}$、$h_2 = 5\\,\\mathrm{km} = 5000\\,\\mathrm{m}$ 和 $h_3 = 10\\,\\mathrm{km} = 10000\\,\\mathrm{m}$。\n\n所有这些实际网格间距都远大于最优步长：$h_i \\gg h^*$。\n\n总误差为 $E(h) \\approx \\frac{h^2}{6} |f'''(x)| + \\frac{u|f(x)|}{h}$。第一项是截断误差（$E_T \\propto h^2$），第二项是舍入误差（$E_R \\propto h^{-1}$）。最优步长 $h^*$ 是这两个误差贡献量级相当的点。\n\n- 对于 $h \\ll h^*$，舍入误差项（$h^{-1}$）占主导。\n- 对于 $h > h^*$，截断误差项（$h^2$）占主导。\n\n由于实际的网格间距（$1\\,\\mathrm{km}$ 到 $10\\,\\mathrm{km}$）都远大于 $h^* \\approx 0.110\\,\\mathrm{m}$，所以在这些间距上计算导数的误差绝大部分由**截断误差**主导。相比之下，舍入误差可以忽略不计。这表明，在海洋模型的典型尺度上，有限差分导数精度的限制因素是泰勒级数的离散化，而不是浮点运算的精度。",
            "answer": "$$\\boxed{1.10 \\times 10^{-1}}$$"
        },
        {
            "introduction": "除了仅仅分析误差，我们还可以利用对泰勒级数误差结构的理解来主动提升我们数值估计的精度。在最后的这个练习  中，您将实现理查森外推法（Richardson extrapolation）。这是一种巧妙的技术，它将两个在不同步长下计算的相对不准确的导数估计相结合，从而产生一个精度阶数显著更高的新估计，清晰地展示了如何通过系统性地消除主导截断误差项来提高计算模型的准确性。",
            "id": "3813062",
            "problem": "一个计算海洋学任务考虑从离散的垂直剖面计算水平流$u(z)$的垂直切变$u_z$。从一个充分光滑的函数$u(z)$在目标深度$z_0$的泰勒级数展开出发，分别使用均匀间距$h$和$h/2$构造$u_z(z_0)$的两个不同的有限差分近似。仅基于泰勒级数的结构和消除主导误差项的要求，通过Richardson外推法组合这些近似，以消除主导的截断误差项。实现这个Richardson外推估计，并利用泰勒级数，确定外推导数近似中乘以$h^4$的残余主导误差常数。\n\n您必须将此方法应用于从物理上合理的解析流剖面合成生成的离散剖面，以便获得精确的导数进行定量验证。对于两个振荡衰减剖面，角度必须以弧度处理。以$\\mathrm{s}^{-1}$为单位报告所有切变量，作为纯十进制数，输出中不嵌入单位。\n\n对下面列出的每个测试用例，计算：\n1. 从在$z_0 \\pm h$和$z_0 \\pm h/2$处采集的离散样本得到的$u_z(z_0)$的Richardson外推估计值。\n2. 此估计值相对于解析计算的精确$u_z(z_0)$的绝对误差。\n3. 外推后泰勒级数中的残余主导误差常数，表示为系数$C$，使得对于固定的$z_0$和小的$h$，主导截断误差的行为类似于$C h^4$。提供解析推导的常数$C_{\\mathrm{theory}}$和针对所选$h$的经验估计$C_{\\mathrm{numeric}} = \\left(u_z^{\\mathrm{extrap}}(z_0) - u_z^{\\mathrm{exact}}(z_0)\\right)/h^4$。\n\n所有角度均以弧度为单位。所有切变量必须以$\\mathrm{s}^{-1}$为单位表示为十进制数。不要四舍五入；输出原始浮点数。离散采样将在距$z_0$的指定偏移处直接执行，不进行任何插值。\n\n测试套件：\n- 情况A（振荡衰减，中等分辨率）：$u(z) = U_0 \\exp(-z/D)\\cos(b z)$，其中$U_0 = 0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 50\\,\\mathrm{m}$，$b = \\pi/100\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$，$z_0 = 100\\,\\mathrm{m}$，粗间距$h = 20\\,\\mathrm{m}$。\n- 情况B（振荡衰减，粗分辨率）：$u(z) = U_0 \\exp(-z/D)\\cos(b z)$，其中$U_0 = 0.3\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 30\\,\\mathrm{m}$，$b = \\pi/50\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$，$z_0 = 200\\,\\mathrm{m}$，粗间距$h = 100\\,\\mathrm{m}$。\n- 情况C（四次多项式剖面，误差边界情况）：$u(z) = \\alpha z^4 + \\beta z^3 + \\gamma$，其中$\\alpha = 2.0\\times 10^{-12}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-3}$，$\\beta = -1.0\\times 10^{-9}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2}$，$\\gamma = 0.1\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$z_0 = 50\\,\\mathrm{m}$，粗间距$h = 10\\,\\mathrm{m}$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个包含四个十进制数$[u_z^{\\mathrm{extrap}}, \\lvert \\mathrm{error} \\rvert, C_{\\mathrm{theory}}, C_{\\mathrm{numeric}}]$的子列表。例如，整体输出格式必须为$[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3]]$，所有条目均为浮点数。",
            "solution": "该问题要求为水平流剖面$u(z)$的垂直切变$u_z(z_0) = \\frac{du}{dz}\\rvert_{z=z_0}$构建并应用一种高阶有限差分格式。指定的方法是基于两个中心差分近似的Richardson外推法。我们还必须推导得到的外推公式的主阶截断误差。\n\n首先，我们利用一个充分光滑的函数$u(z)$在点$z_0$周围的泰勒级数展开，建立中心差分近似及其误差结构。$u(z_0+h)$和$u(z_0-h)$的展开式为：\n$$u(z_0+h) = u(z_0) + h u'(z_0) + \\frac{h^2}{2!}u''(z_0) + \\frac{h^3}{3!}u'''(z_0) + \\frac{h^4}{4!}u''''(z_0) + \\frac{h^5}{5!}u'''''(z_0) + O(h^6)$$\n$$u(z_0-h) = u(z_0) - h u'(z_0) + \\frac{h^2}{2!}u''(z_0) - \\frac{h^3}{3!}u'''(z_0) + \\frac{h^4}{4!}u''''(z_0) - \\frac{h^5}{5!}u'''''(z_0) + O(h^6)$$\n将第二个方程从第一个方程中减去，可以消去偶数次幂的导数项：\n$$u(z_0+h) - u(z_0-h) = 2h u'(z_0) + \\frac{2h^3}{3!}u'''(z_0) + \\frac{2h^5}{5!}u'''''(z_0) + O(h^7)$$\n解出$u'(z_0)$得：\n$$u'(z_0) = \\frac{u(z_0+h) - u(z_0-h)}{2h} - \\frac{h^2}{6}u'''(z_0) - \\frac{h^4}{120}u'''''(z_0) - O(h^6)$$\n令$F(h)$表示步长为$h$的$u'(z_0)$的二阶中心差分近似：\n$$F(h) = \\frac{u(z_0+h) - u(z_0-h)}{2h}$$\n真实导数$u'(z_0)$可以用这个近似表示为一个误差级数：\n$$u'(z_0) = F(h) - C_1 h^2 - C_2 h^4 - O(h^6)$$\n其中误差系数为$C_1 = \\frac{u'''(z_0)}{6}$和$C_2 = \\frac{u'''''(z_0)}{120}$。\n\n问题要求构造两个这样的近似，一个使用粗间距$h$，记为$F_h$，另一个使用更精细的间距$h/2$，记为$F_{h/2}$。它们与精确导数$u'(z_0)$的关系是：\n$$F_h = u'(z_0) + C_1 h^2 + C_2 h^4 + O(h^6) \\quad (1)$$\n$$F_{h/2} = u'(z_0) + C_1 \\left(\\frac{h}{2}\\right)^2 + C_2 \\left(\\frac{h}{2}\\right)^4 + O(h^6) = u'(z_0) + \\frac{1}{4}C_1 h^2 + \\frac{1}{16}C_2 h^4 + O(h^6) \\quad (2)$$\n为了消除主导误差项$C_1 h^2$，我们寻找$F_h$和$F_{h/2}$的线性组合。将方程(2)乘以4，然后减去方程(1)得到：\n$$4F_{h/2} - F_h = \\left(4u'(z_0) + C_1 h^2 + \\frac{1}{4}C_2 h^4 \\right) - \\left(u'(z_0) + C_1 h^2 + C_2 h^4 \\right) + O(h^6)$$\n$$4F_{h/2} - F_h = 3u'(z_0) - \\frac{3}{4}C_2 h^4 + O(h^6)$$\n解出$u'(z_0)$得到Richardson外推估计值$u_z^{\\mathrm{extrap}}(z_0)$：\n$$u_z^{\\mathrm{extrap}}(z_0) = \\frac{4F_{h/2} - F_h}{3}$$\n这个新估计的截断误差是：\n$$u_z^{\\mathrm{extrap}}(z_0) - u'(z_0) = -\\frac{1}{4}C_2 h^4 + O(h^6)$$\n代入$C_2 = \\frac{u'''''(z_0)}{120}$的表达式，我们得到主导误差项：\n$$\\text{Error} = -\\frac{1}{4} \\left(\\frac{u'''''(z_0)}{120}\\right) h^4 + O(h^6) = -\\frac{u'''''(z_0)}{480} h^4 + O(h^6)$$\n因此，解析推导出的主导误差常数为$C_{\\mathrm{theory}} = -\\frac{u'''''(z_0)}{480}$。\n\n为给定的测试用例执行计算，需遵循以下步骤：\n1.  对每个剖面$u(z)$，确定其一阶导数$u'(z)$和五阶导数$u'''''(z)$的解析表达式。\n    - 对于振荡衰减剖面$u(z) = U_0 e^{-z/D}\\cos(bz)$，通过考虑复函数$w(z) = U_0 e^{(a+ib)z}$（其中$a = -1/D$）的实部，可以高效地求导。其$n$阶导数为$u^{(n)}(z) = \\text{Re}\\left(U_0(a+ib)^n e^{(a+ib)z}\\right)$。\n    - 对于多项式剖面$u(z) = \\alpha z^4 + \\beta z^3 + \\gamma$，导数通过标准微分法求得。值得注意的是，对于此剖面，$u'''''(z) = 0$，这意味着理论误差为零。\n2.  计算精确切变$u_z^{\\mathrm{exact}}(z_0) = u'(z_0)$。\n3.  计算两个中心差分近似：$F_h = \\frac{u(z_0+h) - u(z_0-h)}{2h}$和$F_{h/2} = \\frac{u(z_0+h/2) - u(z_0-h/2)}{h}$。\n4.  计算Richardson外推估计值$u_z^{\\mathrm{extrap}} = \\frac{4F_{h/2} - F_h}{3}$。\n5.  计算估计的绝对误差：$|\\mathrm{error}| = |u_z^{\\mathrm{extrap}} - u_z^{\\mathrm{exact}}|$。\n6.  计算理论误差常数：$C_{\\mathrm{theory}} = -u'''''(z_0)/480$。\n7.  计算经验误差常数：$C_{\\mathrm{numeric}} = (u_z^{\\mathrm{extrap}} - u_z^{\\mathrm{exact}})/h^4$。对于多项式情况，由于误差恰好为零，$C_{\\mathrm{numeric}}$也为零。\n\n对每个测试用例执行这些步骤，以生成所需的一组四个值：$[u_z^{\\mathrm{extrap}}, |\\mathrm{error}|, C_{\\mathrm{theory}}, C_{\\mathrm{numeric}}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# No other libraries outside the Python standard library are permitted.\n\ndef u_osc(z, U0, D, b):\n    \"\"\"Computes the oscillatory-decaying profile u(z).\"\"\"\n    return U0 * np.exp(-z/D) * np.cos(b*z)\n\ndef du_osc_dz(z, U0, D, b):\n    \"\"\"Computes the exact first derivative of the oscillatory profile.\"\"\"\n    a = -1.0/D\n    return U0 * np.exp(a*z) * (a * np.cos(b*z) - b * np.sin(b*z))\n\ndef d5u_osc_dz5(z, U0, D, b):\n    \"\"\"Computes the exact fifth derivative of the oscillatory profile.\"\"\"\n    a = -1.0/D\n    # (a+ib)^5 = c_re + i * c_im\n    c_re = a**5 - 10*a**3*b**2 + 5*a*b**4\n    c_im = 5*a**4*b - 10*a**2*b**3 + b**5\n    # d5u/dz5 = Re( U0 * (c_re + i*c_im) * exp(az) * (cos(bz) + i*sin(bz)) )\n    return U0 * np.exp(a*z) * (c_re * np.cos(b*z) - c_im * np.sin(b*z))\n\ndef u_poly(z, alpha, beta, gamma):\n    \"\"\"Computes the quartic polynomial profile u(z).\"\"\"\n    return alpha * z**4 + beta * z**3 + gamma\n\ndef du_poly_dz(z, alpha, beta, gamma):\n    \"\"\"Computes the exact first derivative of the polynomial profile.\"\"\"\n    return 4 * alpha * z**3 + 3 * beta * z**2\n\ndef d5u_poly_dz5(z, alpha, beta, gamma):\n    \"\"\"Computes the exact fifth derivative of the polynomial profile.\"\"\"\n    return 0.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (oscillatory-decaying, moderate resolution)\n        {'type': 'osc', 'params': {'U0': 0.5, 'D': 50, 'b': np.pi/100}, 'z0': 100, 'h': 20},\n        # Case B (oscillatory-decaying, coarse resolution)\n        {'type': 'osc', 'params': {'U0': 0.3, 'D': 30, 'b': np.pi/50}, 'z0': 200, 'h': 100},\n        # Case C (quartic polynomial profile, error edge case)\n        {'type': 'poly', 'params': {'alpha': 2.0e-12, 'beta': -1.0e-9, 'gamma': 0.1}, 'z0': 50, 'h': 10},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        z0, h = case['z0'], case['h']\n        params = case['params']\n        \n        if case['type'] == 'osc':\n            u_func = u_osc\n            du_func = du_osc_dz\n            d5u_func = d5u_osc_dz5\n        else: # 'poly'\n            u_func = u_poly\n            du_func = du_poly_dz\n            d5u_func = d5u_poly_dz5\n\n        # 1. Compute exact shear at z0\n        uz_exact = du_func(z0, **params)\n\n        # 2. Compute two central difference approximations\n        F_h = (u_func(z0 + h, **params) - u_func(z0 - h, **params)) / (2*h)\n        h_half = h / 2.0\n        F_h_half = (u_func(z0 + h_half, **params) - u_func(z0 - h_half, **params)) / (h)\n\n        # 3. Compute Richardson-extrapolated estimate\n        uz_extrap = (4.0 * F_h_half - F_h) / 3.0\n\n        # 4. Compute absolute error\n        abs_error = np.abs(uz_extrap - uz_exact)\n        \n        # 5. Compute theoretical leading error constant\n        d5u_at_z0 = d5u_func(z0, **params)\n        C_theory = -d5u_at_z0 / 480.0\n\n        # 6. Compute empirical estimate of the error constant\n        error_val = uz_extrap - uz_exact\n        if h == 0:\n            C_numeric = 0.0 if error_val == 0.0 else np.inf\n        else:\n            C_numeric = error_val / (h**4)\n\n        results.append([uz_extrap, abs_error, C_theory, C_numeric])\n\n    # Final print statement in the exact required format.\n    # We construct the string manually to avoid spaces introduced by str(list).\n    print(\"[\" + \",\".join([f\"[{','.join(map(str, sublist))}]\" for sublist in results]) + \"]\")\n\nsolve()\n```"
        }
    ]
}