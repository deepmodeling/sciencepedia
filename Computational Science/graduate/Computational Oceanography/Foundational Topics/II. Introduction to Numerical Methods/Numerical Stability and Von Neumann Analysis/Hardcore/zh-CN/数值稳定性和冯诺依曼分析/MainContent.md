## 引言
在计算海洋学及其他科学与工程领域，[数值模拟](@entry_id:146043)是理解复杂物理过程不可或缺的工具。然而，一个数值模型的有效性取决于其解是否能可靠地逼近真实物理。这一挑战的核心在于**[数值稳定性](@entry_id:175146)**——即模型抑制计算误差增长的能力。不稳定的格式会产生无界的、非物理的解，使模拟结果毫无意义。因此，理解和分析数值稳定性是开发和应用任何[计算模型](@entry_id:637456)的首要任务。

本文旨在系统性地解决一个核心问题：我们如何严格地评估一个数值格式的稳定性？[拉克斯等价定理](@entry_id:139112)为我们指明了方向，它将难以[直接证明](@entry_id:141172)的**收敛性**分解为更易于分析的**相容性**和**稳定性**。本文将重点介绍[冯·诺依曼分析](@entry_id:153661)，这是迄今为止分析线性、[常系数](@entry_id:269842)[偏微分](@entry_id:194612)方程离散格式稳定性的最强大、最广泛使用的工具。

通过学习本文，读者将全面掌握冯·诺依曼分析的理论与实践。在“**原理与机制**”章节中，我们将深入探讨其数学基础，包括[放大因子](@entry_id:144315)的推导、CFL条件以及如何利用它来诊断数值频散和耗散等特性。在“**应用与交叉学科联系**”章节中，我们将展示该方法如何应用于分析海洋与大气模型中的关键问题，如空间离散方案的选择（阿[拉卡](@entry_id:195257)瓦网格）、[时间积分格式](@entry_id:165373)的缺陷，以及如何启发[IMEX方法](@entry_id:170079)和模态分离等高级技术。最后，在“**动手实践**”部分，读者将有机会亲手应用所学知识，分析典型[海洋学](@entry_id:149256)问题的数值格式。本文将引导您从理论基础走向实际应用，为您的计算科学研究奠定坚实的分析基础。

## 原理与机制

本章深入探讨[数值稳定性分析](@entry_id:201462)的核心原理与机制，重点介绍冯·诺依曼（Von Neumann）分析方法。我们将从数值分析的理论基石出发，建立[相容性、稳定性与收敛性](@entry_id:747727)之间的基本关系。随后，我们将系统地阐述冯·诺依曼分析的数学框架，并通过一系列典型的平流-扩散方程离散格式，展示如何应用该方法来评估数值格式的稳定性和其他重要属性。最后，我们将讨论冯·诺依曼分析的[适用范围](@entry_id:636189)及其局限性，并简要介绍适用于更一般情况的[稳定性分析](@entry_id:144077)工具。

### 理论基石：[相容性、稳定性与收敛性](@entry_id:747727)

在为[偏微分](@entry_id:194612)方程（PDE）设计数值格式时，我们的最终目标是获得一个能够准确逼近真实解的数值解。这一概念被形式化为**收敛性（Convergence）**。然而，[直接证明](@entry_id:141172)收敛性通常是困难的。幸运的是，[拉克斯-里奇特迈尔等价定理](@entry_id:142693)（Lax-Richtmyer Equivalence Theorem）为我们提供了一条更易于操作的路径，它将收敛性问题分解为两个相对更容易验证的属性：相容性和稳定性。

我们首先精确定义这三个核心概念。考虑一个适定的（well-posed）线性[初值问题](@entry_id:142753)，抽象地写作 $u_t = L u$，其解在时间区间 $[0, T]$ 内存在且唯一。我们使用一个离散格式在时空网格上求解该问题，其中时间步长为 $\Delta t$，空间步长为 $\Delta x$。

- **相容性（Consistency）**：一个数值格式是相容的，如果它在网格步长趋于零时，能够逼近原[偏微分](@entry_id:194612)方程。我们通过将PDE的精确解 $u(x,t)$ 代入离散格式来量化这一点。由于精确解通常不满足离散方程，代入后会产生一个非零的余项，这个余项被称为**[局部截断误差](@entry_id:147703)（Local Truncation Error, LTE）**，记为 $\tau^n$。如果当 $\Delta t \to 0$ 和 $\Delta x \to 0$ 时，该误差在适当的范数意义下一致地趋于零，即 $\sup_{0 \le n\Delta t \le T} \|\tau^n\| \to 0$，则称该格式是相容的。

- **稳定性（Stability）**：一个数值格式是稳定的，如果它能抑制计算过程中引入的误差（如初始条件的微小扰动或每一步的舍入误差）的增长。对于一个线性演化格式 $U^{n+1} = B_{\Delta t, \Delta x} U^n$，其在时间区间 $[0,T]$ 上是稳定的，如果存在一个不依赖于 $\Delta t$ 和 $\Delta x$ 的常数 $C_T > 0$，使得对于所有满足 $n\Delta t \le T$ 的时间步 $n$，数值解的范数都有界：$\|U^n\| \le C_T \|U^0\|$。

- **收敛性（Convergence）**：一个数值格式是收敛的，如果当网格步长趋于零时，其数值解 $U^n$ 在整个求解域和时间区间上一致地逼近PDE的精确解在网格点上的采样值 $u^n$。形式上，这意味着 $\sup_{0 \le n\Delta t \le T} \|U^n - u^n\| \to 0$，当 $\Delta t \to 0$ 和 $\Delta x \to 0$ 时。

这三个概念通过**拉克斯等价定理（Lax Equivalence Theorem）**紧密联系在一起：**对于一个适定的线性初值问题，一个相容的线性[有限差分格式](@entry_id:749361)是收敛的，当且仅当它是稳定的。** 这一定理是[计算流体动力学](@entry_id:142614)的基石，它告诉我们，要保证数值解的收敛性，我们必须确保格式既是相容的（忠实于原方程）又是稳定的（对误差具有鲁棒性）。这正是我们投入大量精力研究[数值稳定性](@entry_id:175146)的根本原因。

### [冯·诺依曼分析](@entry_id:153661)方法：傅里叶方法

[冯·诺依曼分析](@entry_id:153661)是研究线性、[常系数](@entry_id:269842)[偏微分](@entry_id:194612)方程在[周期性边界条件](@entry_id:753346)（或无限域）下离散格式稳定性的最常用工具。其核心思想是将数值解分解为一系列傅里叶模式，并独立考察每个模式随时间的演化行为。

#### 前提：周期域上的[傅里叶分解](@entry_id:160101)

任何定义在周期性区间 $[0, L]$ 上的函数都可以表示为一个[傅里叶级数](@entry_id:139455)。类似地，一个定义在具有 $N$ 个点、间距为 $\Delta x = L/N$ 的均匀周期网格上的网格函数 $u_j$ ($j=0, 1, \dots, N-1$)，可以通过**[离散傅里叶变换](@entry_id:144032)（Discrete Fourier Transform, DFT）**表示为一组离散傅里叶模式的叠加。

一个标准的DFT对可以定义如下 ：
- **正变换（分析）**: $\displaystyle \hat{u}_n = \frac{1}{N}\sum_{j=0}^{N-1} u_j\,e^{-i\,\frac{2\pi n j}{N}}$
- **逆变换（综合）**: $\displaystyle u_j = \sum_{n=0}^{N-1} \hat{u}_n\,e^{i\,\frac{2\pi n j}{N}}$

其中，$\hat{u}_n$ 是第 $n$ 个傅里叶模式的[复振幅](@entry_id:164138)。离散的模式指数 $n$ 对应着物理波数 $k_n = \frac{2\pi n}{L}$。冯·诺依曼分析中更常用的量是无量纲的**网格相位（grid phase）** 或波数角 $\theta$，定义为 $\theta_n = k_n \Delta x$。利用 $\Delta x = L/N$ 的关系，我们得到 $\theta_n = \frac{2\pi n}{N}$。因此，基函数可以写作 $e^{i j \theta_n}$。网格所能解析的最高波数称为**奈奎斯特（Nyquist）波数**，对应于波长为 $2\Delta x$ 的模式，其 $\theta = \pi$。

#### [放大因子](@entry_id:144315)

[冯·诺依曼分析](@entry_id:153661)的关键假设是，对于一个线性、[常系数](@entry_id:269842)、空间平移不变的差分格式，各个傅里叶模式在演化过程中是[相互独立](@entry_id:273670)的。这意味着，如果初始解是单个傅里叶模式 $u_j^n = \hat{u}^n(\theta) e^{ij\theta}$，那么经过一个时间步后，解的形式仍然是同一个傅里叶模式，只是振幅发生了改变：$u_j^{n+1} = \hat{u}^{n+1}(\theta) e^{ij\theta}$。

这个振幅的变化比例被定义为**放大因子（Amplification Factor）** $G(\theta)$：
$$
\hat{u}^{n+1}(\theta) = G(\theta) \hat{u}^{n}(\theta)
$$
我们可以通过将单个傅里叶模式代入差分格式来推导 $G(\theta)$。考虑一个通用的显式一步格式 ：
$$
q_j^{n+1} = \sum_{m=-M}^{M} a_m q_{j+m}^{n}
$$
其中系数 $a_m$ 是常数。将 $q_j^n = \hat{q}^n e^{ij\theta}$ 代入，我们得到：
$$
G(\theta)\hat{q}^n e^{ij\theta} = \sum_{m=-M}^{M} a_m \hat{q}^n e^{i(j+m)\theta} = \hat{q}^n e^{ij\theta} \left( \sum_{m=-M}^{M} a_m e^{im\theta} \right)
$$
因此，放大因子由差分格式的系数和模板结构唯一确定：
$$
G(\theta) = \sum_{m=-M}^{M} a_m e^{im\theta}
$$

#### [冯·诺依曼稳定性](@entry_id:756579)判据

由于经过 $n$ 个时间步后，模式的振幅变为 $\hat{u}^n(\theta) = (G(\theta))^n \hat{u}^0(\theta)$，为了防止解的无界增长，任何傅里叶模式的振幅都不能随时间增长。这就导出了**[冯·诺依曼稳定性](@entry_id:756579)判据**：对于所有在网格上可表示的波数 $\theta$（通常是 $\theta \in [-\pi, \pi]$），[放大因子](@entry_id:144315)的模必须不大于1。
$$
\sup_{\theta} |G(\theta)| \le 1
$$
这个判据与离散 $L^2$ 范数下的稳定性密切相关。根据**[帕塞瓦尔定理](@entry_id:139215)（Parseval's Theorem）**，网格函数在物理空间的 $L^2$ 范数的平方（$\|q^n\|_2^2 = \Delta x \sum_j |q_j^n|^2$）正比于其在傅里叶空间的能量总和（$\sum_\theta |\hat{q}^n(\theta)|^2$）。由于 $\sum_\theta |\hat{q}^{n+1}(\theta)|^2 = \sum_\theta |G(\theta)|^2 |\hat{q}^n(\theta)|^2$，要保证 $\|q^{n+1}\|_2 \le \|q^n\|_2$ 对任意初始条件成立，就必须满足 $|G(\theta)| \le 1$ 对所有 $\theta$ 成立。
- 如果 $|G(\theta)| < 1$，该模式被耗散（damped）。
- 如果 $|G(\theta)| = 1$，该模式是中性稳定的（neutrally stable）。
- 如果存在任何一个 $\theta$ 使得 $|G(\theta)| > 1$，该模式将[指数增长](@entry_id:141869)，格式是**不稳定**的。

### 分析应用：案例研究

理论必须通过实践来检验。下面我们应用[冯·诺依曼分析](@entry_id:153661)来评估几个经典的[平流方程](@entry_id:144869) $u_t + c u_x = 0$ 的差分格式。

#### 一个经典的不稳定格式：FTCS

**前差时间，中心差分空间（FTCS）** 格式写作：
$$
\frac{u_j^{n+1} - u_j^n}{\Delta t} + c \frac{u_{j+1}^n - u_{j-1}^n}{2\Delta x} = 0
$$
代入傅里叶模式 $u_j^n = G^n e^{ij\theta}$ 并化简，可得[放大因子](@entry_id:144315)为：
$$
G(\theta) = 1 - c \frac{\Delta t}{\Delta x} \frac{e^{i\theta} - e^{-i\theta}}{2i} = 1 - i C \sin\theta
$$
其中 $C = c\Delta t/\Delta x$ 是**库朗（Courant）数**。计算其模的平方：
$$
|G(\theta)|^2 = 1^2 + (-C \sin\theta)^2 = 1 + C^2 \sin^2\theta
$$
只要 $C \ne 0$ 且 $\sin\theta \ne 0$，我们总有 $|G(\theta)|^2 > 1$。例如，对于波数 $\theta=\pi/2$（波长为 $4\Delta x$ 的模式），$|G(\pi/2)| = \sqrt{1+C^2}$，这显然大于1。 因此，[FTCS格式](@entry_id:146585)对于纯平流问题是**无条件不稳定**的，无论时间步长和空间步长取得多小。

#### 一个经典的稳定格式：[一阶迎风格式](@entry_id:749417)

为了克服FTCS的稳定性问题，我们可以采用**一阶迎风格式（First-Order Upwind）**。该格式根据平流速度 $c$ 的方向选择“上游”的节点来构造空间差分。其统一形式可以写作 ：
$$
u_j^{n+1} = (1-|C|)u_j^n + |C|u_{j-\mathrm{sgn}(c)}^n
$$
代入傅里叶模式，我们得到放大因子：
$$
G(\theta) = (1-|C|) + |C|e^{-i\,\mathrm{sgn}(c)\,\theta}
$$
其模的平方经过计算为：
$$
|G(\theta)|^2 = 1 - 2|C|(1-|C|)(1-\cos\theta)
$$
为了保证稳定性，即 $|G(\theta)|^2 \le 1$，我们必须有 $2|C|(1-|C|)(1-\cos\theta) \ge 0$。由于 $|C| \ge 0$ 且 $(1-\cos\theta) \ge 0$，该不等式成立的充要条件是 $1-|C| \ge 0$。这导出了著名的**[CFL稳定性条件](@entry_id:747253)**：
$$
|C| = \frac{|c|\Delta t}{\Delta x} \le 1
$$
这意味着，在一个时间步内，[信息传播](@entry_id:1126500)的物理距离 $|c|\Delta t$ 不能超过一个空间网格的宽度 $\Delta x$。此外，只要 $0 < |C| < 1$，对于 $\theta \ne 0$，我们有 $|G(\theta)| < 1$。这表明迎风格式是**耗散的**，它会衰减波的振幅，尤其是高频（短波）模式，因为 $(1-\cos\theta)$ 在 $\theta=\pi$ 附近最大。这种耗散被称为**[数值耗散](@entry_id:168584)（numerical dissipation）**。

### 超越稳定性：分析格式特性

[放大因子](@entry_id:144315) $G(\theta)$ 不仅告诉我们格式是否稳定，还揭示了其精度特性，即它在多大程度上复现了真实解的传播和振幅行为。

#### 数值频散与[数值耗散](@entry_id:168584)

真实物理波的演化可以用[复频率](@entry_id:266400) $\omega$ 来描述，其解形式为 $\exp(i(kx-\omega t))$。类似地，我们可以为数值格式定义一个**离散频散关系（discrete dispersion relation）** $\omega_d(\theta)$，通过关系式 $G(\theta) = \exp(-i \omega_d(\theta) \Delta t)$。
通过求解该式，我们得到 $\omega_d(\theta) = \frac{i}{\Delta t} \mathrm{Log}\,G(\theta)$。将 $G(\theta)$ 写成极坐标形式 $G(\theta) = |G(\theta)|e^{i\phi(\theta)}$，其中 $\phi(\theta)=\arg G(\theta)$ 是相位角，代入可得：
$$
\Re(\omega_d(\theta)) = -\frac{\phi(\theta)}{\Delta t}, \qquad \Im(\omega_d(\theta)) = \frac{\ln|G(\theta)|}{\Delta t}
$$
这两部分有明确的物理意义：
- **数值频散（Numerical Dispersion）**：$\Re(\omega_d)$ 是数值[角频率](@entry_id:261565)。它决定了数值波的**相速度** $c_p(\theta) = \Re(\omega_d)/k$。如果 $c_p(\theta)$ 依赖于波数 $\theta$，不同波长的模式将以不同速度传播，导致波形变形，这种现象称为频散。数值格式的相速度与真实物理相速度之间的差异，就是**频散误差**。
- **[数值耗散](@entry_id:168584)（Numerical Dissipation）**：$\Im(\omega_d)$ 决定了波振幅的变化。根据关系式 $|G(\theta)| = \exp(\Im(\omega_d)\Delta t)$，我们看到：
    - $\Im(\omega_d) < 0$ 对应 $|G(\theta)|<1$，表示振幅衰减，即**耗散**。
    - $\Im(\omega_d) > 0$ 对应 $|G(\theta)|>1$，表示振幅增长，即**不稳定**。
    - $\Im(\omega_d) = 0$ 对应 $|G(\theta)|=1$，表示振幅守恒。

理想的格式应该精确地复现真实解的频散和耗散特性。对于纯平流问题，真实解是无耗散、无频散的，任何由数值格式引入的频散和耗散都是误差。

#### “线方法”：组合空间与时间格式

在实践中，一种强大的[模块化分析](@entry_id:900446)方法是**线方法（Method of Lines）**。该方法首先只对空间导数进行离散，将PDE转化为一个[常微分方程](@entry_id:147024)（ODE）组：$\frac{d\vec{u}}{dt} = \mathcal{L}_h \vec{u}$，其中 $\mathcal{L}_h$ 是[离散空间](@entry_id:155685)算子。

对这个[半离散系统](@entry_id:754680)进行傅里叶分析，我们发现每个傅里叶模式 $\hat{u}(\theta)$ 满足一个独立的ODE：$\frac{d\hat{u}}{dt} = \lambda(\theta)\hat{u}$。这里的 $\lambda(\theta)$ 是空间算子 $\mathcal{L}_h$ 作用于模式 $e^{ij\theta}$ 时的特征值，被称为该算子的**符号（symbol）**。

接着，我们为这个ODE[组选择](@entry_id:175784)一个时间积分方法（如[龙格-库塔法](@entry_id:140014)）。任何一步时间积分方法应用于测试方程 $\dot{y} = \lambda y$ 时，其行为可以由一个**稳定性函数** $R(z)$ 来刻画，其中 $z = \lambda \Delta t$。经过一个时间步，数值解更新为 $y^{n+1} = R(z)y^n$。

将这两个概念结合，整个全离散格式的[放大因子](@entry_id:144315)就是空间算子符号和时间积分器[稳定性函数](@entry_id:178107)的复合：
$$
G(\theta) = R(\Delta t \lambda(\theta))
$$
稳定性条件 $|G(\theta)| \le 1$ 等价于要求对于所有的 $\theta$，复数 $z(\theta) = \Delta t \lambda(\theta)$ 都必须落在[时间积分](@entry_id:267413)器 $R(z)$ 的**[绝对稳定域](@entry_id:171484)**内。

例如，对于使用[中心差分](@entry_id:173198)的平流方程，$c u_x$，其符号为 $\lambda(\theta) = -c \frac{i\sin\theta}{\Delta x}$，是纯虚数。若采用一个三阶[龙格-库塔法](@entry_id:140014)，其[稳定性函数](@entry_id:178107)为 $R(z) = 1+z+z^2/2+z^3/6$，通过分析 $|R(i y)| \le 1$（其中 $y$ 为实数），我们可以得到该组合格式的稳定性约束，如库朗数上限 $C_{\max} = \sqrt{3}$。

#### [隐式方法](@entry_id:138537)与A-稳定性：[Crank-Nicolson格式](@entry_id:147733)

[隐式时间积分](@entry_id:171761)方法通常具有更好的稳定性。以**Crank-Nicolson (CN)** 格式为例，它对测试方程 $\dot{y} = \lambda y$ 的稳定性函数为 ：
$$
R(z) = \frac{1 + z/2}{1 - z/2}
$$
其[绝对稳定域](@entry_id:171484)，即满足 $|R(z)| \le 1$ 的复数 $z$ 的集合，被证明是整个左半复平面，即 $\{z \in \mathbb{C} : \Re(z) \le 0\}$。拥有此属性的格式被称为**A-稳定（A-stable）**。

A-稳定性的意义重大：对于任何物理上稳定或衰减的过程（其特征值 $\lambda$ 满足 $\Re(\lambda) \le 0$，如[扩散过程](@entry_id:268015)），CN格式在数值上都是稳定的，无论时间步长 $\Delta t$ 取多大。这使得它在处理**刚性（stiff）**问题时特别有吸[引力](@entry_id:189550)，因为显式方法会受到极其苛刻的时间步长限制。

然而，A-稳定性并非万能。我们考察在刚性极限下，即 $\Re(z) \to -\infty$ 时 $R(z)$ 的行为。对于CN格式：
$$
\lim_{\Re(z)\to-\infty} |R(z)| = \lim_{|z|\to\infty} \left| \frac{1+z/2}{1-z/2} \right| = |-1| = 1
$$
这个极限不为零。这意味着CN格式虽然稳定，但它不能有效衰减高频（大波数）的刚性模式，这些模式的振幅在一个时间步后几乎不变，只是改变了符号。这种性质导致CN格式不是**L-稳定**的（[L-稳定性](@entry_id:143644)要求该极限为0）。在海洋模型等应用中，这意味着由[截断误差](@entry_id:140949)或[非线性](@entry_id:637147)过程产生的高频数值噪声可能不会被[时间积分格式](@entry_id:165373)有效抑制，而是在解中以网格尺度振荡的形式持续存在，污染物理结果。

### 冯·诺依曼分析的局限性与其他方法

尽管冯·诺依曼分析非常强大，但我们必须清醒地认识到它的应用前提和局限性。

#### 边界条件的作用

[冯·诺依曼分析](@entry_id:153661)的数学基础是傅里叶模式是离散算子的[特征函数](@entry_id:186820)，这使得各个模式的演化得以[解耦](@entry_id:160890)。这一性质严格依赖于一个关键假设：**差分格式在具有周期性边界条件的均匀网格上是线性且系数恒定的**。在这种情况下，离散算子可以用一个**[循环矩阵](@entry_id:143620)（circulant matrix）**来表示，而[循环矩阵](@entry_id:143620)的[特征向量](@entry_id:151813)正是离散傅里叶模式。

当问题涉及[非周期性](@entry_id:275873)边界（如固壁边界、开放边界）时，[边界点](@entry_id:176493)或其邻近点的差分格式必须修改，导致算子矩阵不再是[循环矩阵](@entry_id:143620)。傅里叶模式不再是系统的特征函数，不同模式之间会在边界处发生耦合和散射。此时，一个在内部（根据冯·诺依曼分析）稳定的格式，可能会因为不恰当的边界处理而变得不稳定。因此，对这类**[初边值问题](@entry_id:1126514)（Initial-Boundary Value Problem, IBVP）** 的[稳定性分析](@entry_id:144077)需要更严格的工具。

#### 替代方法简介

处理IBVP稳定性的主要理论工具包括：
- **正规[模态分析](@entry_id:163921)（Normal Mode Analysis / GKS理论）**：由 Gustafsson, Kreiss, 和 Sundström 发展的理论。它通过寻找形如 $u_j^n = z^n \phi_j$ 且满足内部差分格式和边界条件的非[平凡解](@entry_id:155162)来分析不稳定性。如果存在任何 $|z|>1$ 的解，则格式不稳定。这个理论为双曲型[初边值问题](@entry_id:1126514)（hyperbolic IBVPs）提供了坚实的数学基础。
- **能量方法（Energy Method）**：该方法通过构造一个离散的**[能量范数](@entry_id:274966)**（通常是离散 $L^2$ 范数），并证明该能量随时间有界或衰减，来[直接证明](@entry_id:141172)稳定性。现代能量方法常使用满足**[分部求和](@entry_id:755630)（Summation-by-Parts, SBP）**性质的差分算子，并结合**同时逼近项（Simultaneous Approximation Term, SAT）**或[罚函数](@entry_id:638029)方法来弱形式地施加边界条件，从而系统地推导出能量不等式。

#### 周期域上的能量方法

为了将能量方法与我们之前讨论的内容联系起来，我们可以考察它在周期域上的应用。对于线性、[常系数](@entry_id:269842)、周期性问题，能量方法和[冯·诺依曼分析](@entry_id:153661)是等价的，它们应该给出相同的稳定性结论。

让我们以周期域上的平流-扩散方程的[Crank-Nicolson格式](@entry_id:147733)为例 。定义离散[内积](@entry_id:750660) $\langle v, w \rangle_h = \sum_{j=0}^{N-1} v_j w_j \Delta x$ 和范数 $\|v\|_h^2 = \langle v, v \rangle_h$。将CN格式与 $\frac{u^{n+1}+u^n}{2}$ 做[内积](@entry_id:750660)，我们得到能量演化方程：
$$
\frac{\|u^{n+1}\|_h^2 - \|u^n\|_h^2}{2\Delta t} = -c \left\langle D\left(\frac{u^{n+1}+u^n}{2}\right), \frac{u^{n+1}+u^n}{2} \right\rangle_h + \kappa \left\langle L\left(\frac{u^{n+1}+u^n}{2}\right), \frac{u^{n+1}+u^n}{2} \right\rangle_h
$$
利用周期性边界条件下的[分部求和](@entry_id:755630)性质，可以证明：
- 中心差分平流算子 $D$ 是**斜对称的**：$\langle Dv, v \rangle_h = 0$。因此，平流项不改变系统的总能量。
- 中心差分[扩散算子](@entry_id:136699) $L$ 是**负半定的**：$\langle Lv, v \rangle_h \le 0$。因此，扩散项只会耗散能量。

综合起来，能量演化变为：
$$
\|u^{n+1}\|_h^2 - \|u^n\|_h^2 \le 0
$$
这表明 $\|u^{n+1}\|_h \le \|u^n\|_h$ 对任意 $\Delta t > 0$ 成立。因此，能量方法证明了该格式是无条件稳定的。这个结论与我们之前通过冯·诺依曼分析得到的CN格式是A-稳定的结论完全一致，验证了两种方法在共同适用领域内的自洽性。