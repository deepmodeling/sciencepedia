{
    "hands_on_practices": [
        {
            "introduction": "在计算海洋学中，扩散过程是模拟示踪剂混合、热量传输等现象的基础。前向欧拉法等显式时间积分方案因其简单性而备受青睐，但其稳定性受到严格的时间步长限制。本练习将通过冯·诺依曼分析，推导二维扩散方程在使用显式格式时必须满足的稳定性条件，这是每个计算建模者都应掌握的基本功。",
            "id": "3804352",
            "problem": "一个海洋内部被動示踪剂的浓度场 $C(x,y,t)$ 遵循具有恒定涡动扩散系数 $K_{x}$ 和 $K_{y}$ 的水平各向异性扩散方程演变：\n$$\n\\frac{\\partial C}{\\partial t} \\;=\\; K_{x}\\,\\frac{\\partial^{2} C}{\\partial x^{2}} \\;+\\; K_{y}\\,\\frac{\\partial^{2} C}{\\partial y^{2}}\\,,\n$$\n该方程作用于一个矩形的、水平周期性的区域上。考虑一个间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格，并使用大小为 $\\Delta t$ 的显式前向欧拉时间步长，空间二阶导数则采用二阶中心有限差分格式。在网格点 $(i,j)$ 处的离散更新方程为\n$$\nC_{i,j}^{n+1} \\;=\\; C_{i,j}^{n} \\;+\\; \\Delta t \\left[ K_{x}\\,\\frac{C_{i+1,j}^{n} - 2\\,C_{i,j}^{n} + C_{i-1,j}^{n}}{\\Delta x^{2}} \\;+\\; K_{y}\\,\\frac{C_{i,j+1}^{n} - 2\\,C_{i,j}^{n} + C_{i,j-1}^{n}}{\\Delta y^{2}} \\right].\n$$\n使用冯·诺依曼稳定性分析（VNA），推导能够保证对网格上所有可表示的水平波数都稳定的最大时间步长 $\\Delta t_{\\max}$。冯·诺依曼分析指出，对于周期性区域上的线性常系数格式，其稳定的充要条件是：对于所有允许的离散傅里葉模态，增长因子的模都不超过1。\n\n您的推导必须从离散傅里叶模态的增长因子以及二阶中心二阶导数的离散符号的定义开始。最后，以 $K_{x}$、$K_{y}$、$\\Delta x$ 和 $\\Delta y$ 的形式，给出一个关于 $\\Delta t_{\\max}$ 的单一闭式符号表达式。最终答案以秒为单位。不要代入任何数值，也不要给出不等式；只提供最大稳定时间步长的闭式表达式。",
            "solution": "所述问题是有效的。这是一个计算科学领域中有科学依据、适定且客观的问题，具体涉及二维各向异性扩散方程有限差分格式的数值稳定性。问题提供了所有必要信息，目标是使用指定的方法（冯·诺依曼分析）推导出一个标准结果。\n\n分析首先考虑离散解 $C_{i,j}^n$ 的单个通用傅里叶模态的演化。一个二维离散傅里叶模态由以下拟设表示：\n$$\nC_{i,j}^{n} = \\hat{C}^{n}(k_x, k_y) \\exp[\\mathrm{i} (k_x x_i + k_y y_j)]\n$$\n其中 $x_i = i \\Delta x$ 和 $y_j = j \\Delta y$ 是网格点坐标，$i$ 和 $j$ 是整数网格指数，$k_x$ 和 $k_y$ 分别是 $x$ 和 $y$ 方向上的实值波数，$n$ 是时间步指数，$\\mathrm{i} \\equiv \\sqrt{-1}$ 是虚数单位。项 $\\hat{C}^{n}(k_x, k_y)$ 表示模态 $(k_x, k_y)$ 在时间层 $n$ 的复振幅。\n\n冯·诺依曼分析假定，对于一个线性格式，每个模态的振幅根据一个乘法因子（即增长因子 $G(k_x, k_y, \\Delta t)$）独立演化，使得：\n$$\n\\hat{C}^{n+1} = G \\, \\hat{C}^{n}\n$$\n将傅里葉模态拟设代入此关系式得到：\n$$\nC_{i,j}^{n+1} = G \\, C_{i,j}^{n}\n$$\n现在我们将 $C_{i,j}^n$ 的傅里叶模态表达式代入给定的有限差分方程：\n$$\nC_{i,j}^{n+1} = C_{i,j}^{n} + \\frac{K_x \\Delta t}{\\Delta x^2} \\left(C_{i+1,j}^{n} - 2C_{i,j}^{n} + C_{i-1,j}^{n}\\right) + \\frac{K_y \\Delta t}{\\Delta y^2} \\left(C_{i,j+1}^{n} - 2C_{i,j}^{n} + C_{i,j-1}^{n}\\right)\n$$\n为了计算相邻网格点上的各项，我们注意到它们与 $C_{i,j}^n$ 的关系如下：\n$$\nC_{i \\pm 1, j}^{n} = \\hat{C}^n \\exp[\\mathrm{i}(k_x (i \\pm 1)\\Delta x + k_y j \\Delta y)] = C_{i,j}^n \\exp[\\pm \\mathrm{i} k_x \\Delta x]\n$$\n$$\nC_{i, j \\pm 1}^{n} = \\hat{C}^n \\exp[\\mathrm{i}(k_x i \\Delta x + k_y (j \\pm 1) \\Delta y)] = C_{i,j}^n \\exp[\\pm \\mathrm{i} k_y \\Delta y]\n$$\n将这些表达式代入有限差分方程，得到：\n$$\nG C_{i,j}^n = C_{i,j}^n + \\frac{K_x \\Delta t}{\\Delta x^2} \\left(C_{i,j}^n e^{\\mathrm{i} k_x \\Delta x} - 2C_{i,j}^n + C_{i,j}^n e^{-\\mathrm{i} k_x \\Delta x}\\right) + \\frac{K_y \\Delta t}{\\Delta y^2} \\left(C_{i,j}^n e^{\\mathrm{i} k_y \\Delta y} - 2C_{i,j}^n + C_{i,j}^n e^{-\\mathrm{i} k_y \\Delta y}\\right)\n$$\n两边同除以非零公因子 $C_{i,j}^n$，我们得到增长因子 $G$ 的表达式：\n$$\nG = 1 + \\frac{K_x \\Delta t}{\\Delta x^2} \\left(e^{\\mathrm{i} k_x \\Delta x} - 2 + e^{-\\mathrm{i} k_x \\Delta x}\\right) + \\frac{K_y \\Delta t}{\\Delta y^2} \\left(e^{\\mathrm{i} k_y \\Delta y} - 2 + e^{-\\mathrm{i} k_y \\Delta y}\\right)\n$$\n括号中的表达式代表了二阶中心二阶导数算子的离散符号。使用欧拉恒等式 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$，我们简化这些表达式：\n$$\ne^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta) - 2\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们发现：\n$$\n2\\cos(\\theta) - 2 = -2(1-\\cos(\\theta)) = -4\\sin^2(\\theta/2)\n$$\n将此结果应用于 $\\theta_x = k_x \\Delta x$ 和 $\\theta_y = k_y \\Delta y$，增长因子变为：\n$$\nG = 1 + \\frac{K_x \\Delta t}{\\Delta x^2} \\left[-4\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right)\\right] + \\frac{K_y \\Delta t}{\\Delta y^2} \\left[-4\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right)\\right]\n$$\n$$\nG = 1 - 4 \\Delta t \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]\n$$\n为使数值格式稳定，对所有可能的波数，增长因子的模都不能超过1，即 $|G| \\leq 1$。由于 $K_x$, $K_y$, $\\Delta t$, $\\Delta x^2$ 和 $\\Delta y^2$ 都是正数，且正弦平方项是非负的，因此从1中减去的项总是非负的。这意味着 $G \\leq 1$ 总是满足的。稳定性的关键条件来自于下界：\n$$\nG \\geq -1\n$$\n代入 $G$ 的表达式：\n$$\n1 - 4 \\Delta t \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right] \\geq -1\n$$\n重新整理不等式以求解 $\\Delta t$：\n$$\n2 \\geq 4 \\Delta t \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]\n$$\n$$\n\\Delta t \\leq \\frac{2}{4 \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]} = \\frac{1}{2 \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]}\n$$\n这个不等式必须对网格上所有可表示的波数 $(k_x, k_y)$ 都成立。为了找到对 $\\Delta t$ 最严格的条件，我们必须使分母最大化。$\\sin^2(\\theta)$ 的最大值是 $1$。这种情况发生在最高频率（最短波长）的模态，即所谓的奈奎斯特频率。$x$ 方向上最短可分辨波长是 $\\lambda_x = 2 \\Delta x$，对应的波数为 $k_x = \\pi/\\Delta x$。对于这个模态，正弦函数的自变量是 $(k_x \\Delta x)/2 = \\pi/2$，因此 $\\sin^2(\\pi/2) = 1$。类似地，$y$ 方向项的最大值也是 $1$，发生在 $k_y = \\pi/\\Delta y$ 时。\n当两个正弦项同时达到最大值时，出现最严格的约束：\n$$\n\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\rightarrow 1 \\quad \\text{and} \\quad \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\rightarrow 1\n$$\n将这些最大值代入关于 $\\Delta t$ 的不等式，得到稳定性极限：\n$$\n\\Delta t \\leq \\frac{1}{2 \\left( \\frac{K_x}{\\Delta x^2} \\cdot 1 + \\frac{K_y}{\\Delta y^2} \\cdot 1 \\right)}\n$$\n最大的稳定时间步长 $\\Delta t_{\\max}$ 是使此条件取等号时的值。\n$$\n\\Delta t_{\\max} = \\frac{1}{2 \\left( \\frac{K_x}{\\Delta x^2} + \\frac{K_y}{\\Delta y^2} \\right)}\n$$\n该表达式给出了确保对所有波数都数值稳定的最大允许时间步长。",
            "answer": "$$\n\\boxed{\\frac{1}{2\\left(\\frac{K_x}{\\Delta x^2} + \\frac{K_y}{\\Delta y^2}\\right)}}\n$$"
        },
        {
            "introduction": "平流是海洋中物质输运的核心过程，而蛙跳格式（Leapfrog scheme）因其在时间上具有二阶精度且不引入数值耗散，常被用于模拟波动现象。然而，这种多层时间格式的优点也伴随着一个独特的挑战：它会产生一个与物理波解共存的、非物理的“计算模”。本练习将引导你推导蛙跳格式的两个放大因子，从而学会辨别物理模与虚假的计算模，这是解读数值模拟结果时至关重要的一课。",
            "id": "3804397",
            "problem": "考虑一个周期性海洋通道中被动示踪剂的一维线性平流，其由偏微分方程 $u_{t} + a\\,u_{x} = 0$ 控制，其中 $a$ 是一个恒定的纬向速度。在均匀网格 $x_{j} = j\\,\\Delta x$ 上对空间进行离散，在 $t^{n} = n\\,\\Delta t$ 上对时间进行离散。应用空间中心差分的蛙跳时间步进格式，即时间中心空间中心（CTCS）格式，\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\n其中库朗数（Courant number）为 $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$。\n\n使用冯·诺依曼分析（傅里叶或正大规模态分析），推导与无量纲波数 $\\theta = k\\,\\Delta x$ 的空间傅里叶模态相关的复放大因子 $g$，并确定该格式对所有可解波数保持中性稳定的条件。识别出蛙跳法固有的计算模态，并明确地用 $C$ 和 $\\theta$ 表示其放大行为。\n\n以仅包含初等函数的显式闭式解析表达式形式，给出两个放大因子。将两个放大因子在同一行中表示作为最终答案。",
            "solution": "该问题要求对一维线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的时间中心空间中心（CTCS）格式进行冯·诺依曼稳定性分析。离散格式为：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n其中 $C = \\frac{a\\,\\Delta t}{\\Delta x}$ 是库朗数，$u_j^n$ 表示在空间网格点 $j$ 和时间层 $n$ 的数值解。\n\n对于冯·诺依曼分析，我们考虑一个形式如下的单一傅里叶模态解：\n$$\nu_{j}^{n} = \\hat{u}^{n} e^{\\mathrm{i} k x_{j}}\n$$\n其中 $k$ 是波数，$x_j = j \\Delta x$。我们引入无量纲波数 $\\theta = k \\Delta x$，因此该模态可以写为 $u_{j}^{n} = \\hat{u}^{n} e^{\\mathrm{i}j\\theta}$。\n放大因子 $g$ 关联了模态在连续时间层上的振幅，即 $\\hat{u}^{n+1} = g \\hat{u}^{n}$。因为CTCS格式是一个三层格式（涉及时间层 $n-1$、$n$ 和 $n+1$），所以相隔两个时间步长的振幅之间的关系是 $\\hat{u}^{n+1} = g^2 \\hat{u}^{n-1}$。\n\n我们将傅里叶模态代入离散方程。各项变为：\n- $u_{j}^{n+1} = \\hat{u}^{n+1} e^{\\mathrm{i}j\\theta} = g^2 \\hat{u}^{n-1} e^{\\mathrm{i}j\\theta}$\n- $u_{j}^{n-1} = \\hat{u}^{n-1} e^{\\mathrm{i}j\\theta}$\n- $u_{j+1}^{n} = \\hat{u}^{n} e^{\\mathrm{i}(j+1)\\theta} = (g \\hat{u}^{n-1}) e^{\\mathrm{i}j\\theta} e^{\\mathrm{i}\\theta}$\n- $u_{j-1}^{n} = \\hat{u}^{n} e^{\\mathrm{i}(j-1)\\theta} = (g \\hat{u}^{n-1}) e^{\\mathrm{i}j\\theta} e^{-\\mathrm{i}\\theta}$\n\n将这些代入CTCS格式得到：\n$$\ng^2 \\hat{u}^{n-1} e^{\\mathrm{i}j\\theta} = \\hat{u}^{n-1} e^{\\mathrm{i}j\\theta} - C \\left( g \\hat{u}^{n-1} e^{\\mathrm{i}j\\theta} e^{\\mathrm{i}\\theta} - g \\hat{u}^{n-1} e^{\\mathrm{i}j\\theta} e^{-\\mathrm{i}\\theta} \\right)\n$$\n我们可以（在非平凡解的假设下）除以公因子 $\\hat{u}^{n-1} e^{\\mathrm{i}j\\theta}$：\n$$\ng^2 = 1 - Cg \\left( e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta} \\right)\n$$\n使用欧拉恒等式 $e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta} = 2\\mathrm{i} \\sin(\\theta)$，关于 $g$ 的方程变为：\n$$\ng^2 = 1 - 2\\mathrm{i}Cg \\sin(\\theta)\n$$\n将其整理成标准二次型，我们得到放大因子 $g$ 的特征方程：\n$$\ng^2 + (2\\mathrm{i}C \\sin(\\theta))g - 1 = 0\n$$\n这是一个关于 $g$ 的二次方程，形式为 $Ag^2 + Bg + D = 0$，系数为 $A=1$、$B=2\\mathrm{i}C \\sin(\\theta)$ 和 $D=-1$。我们使用二次公式 $g = \\frac{-B \\pm \\sqrt{B^2 - 4AD}}{2A}$ 求解 $g$：\n$$\ng = \\frac{-2\\mathrm{i}C \\sin(\\theta) \\pm \\sqrt{(2\\mathrm{i}C \\sin(\\theta))^2 - 4(1)(-1)}}{2(1)}\n$$\n$$\ng = \\frac{-2\\mathrm{i}C \\sin(\\theta) \\pm \\sqrt{-4C^2 \\sin^2(\\theta) + 4}}{2}\n$$\n从平方根中提出因子 $4$：\n$$\ng = \\frac{-2\\mathrm{i}C \\sin(\\theta) \\pm 2\\sqrt{1 - C^2 \\sin^2(\\theta)}}{2}\n$$\n这给出了两个不同的放大因子：\n$$\ng_{1,2} = -\\mathrm{i}C \\sin(\\theta) \\pm \\sqrt{1 - C^2 \\sin^2(\\theta)}\n$$\n\n为了使格式数值稳定，对于所有可能的 $\\theta$ 值，放大因子的模必须小于或等于1，即 $|g| \\le 1$。\n\n如果 $1 - C^2 \\sin^2(\\theta) \\ge 0$，这等价于 $|C\\sin(\\theta)| \\le 1$，则平方根下的项是实数。设该项为 $R = \\sqrt{1 - C^2 \\sin^2(\\theta)}$。放大因子为 $g = -\\mathrm{i}C\\sin(\\theta) \\pm R$。$g$ 的模的平方是其实部和虚部平方的和：\n$$\n|g|^2 = (\\pm R)^2 + (-C\\sin(\\theta))^2 = R^2 + C^2\\sin^2(\\theta)\n$$\n代入 $R^2$ 的表达式：\n$$\n|g|^2 = (1 - C^2 \\sin^2(\\theta)) + C^2 \\sin^2(\\theta) = 1\n$$\n这意味着 $|g|=1$，因此格式是中性稳定的。为了使该条件对所有可解波数 $\\theta \\in [-\\pi, \\pi]$ 成立，我们必须对所有 $\\theta$ 都有 $|C\\sin(\\theta)| \\le 1$。由于 $|\\sin(\\theta)|$ 的最大值是 $1$，这要求 $|C| \\le 1$。这就是该格式的库朗-弗里德里希斯-列维（CFL）稳定性条件。\n\n如果 $|C|  1$，则存在一个 $\\theta$ 的范围，使得 $1 - C^2 \\sin^2(\\theta)  0$。在这种情况下，平方根变为虚数，并且 $g$ 的一个根的模将大于 $1$，导致指数增长和不稳定。\n\n两个根 $g_1$ 和 $g_2$ 对应于一个物理模态和一个计算模态。物理模态应近似于真实的物理波传播。该偏微分方程的精确放大因子是 $g_{\\text{exact}} = \\exp(-\\mathrm{i}k a \\Delta t) = \\exp(-\\mathrm{i}C\\theta)$。\n根 $g_1 = -\\mathrm{i}C \\sin(\\theta) + \\sqrt{1 - C^2 \\sin^2(\\theta)}$ 在 $C$ 和 $\\theta$ 很小时近似于 $g_{\\text{exact}}$，因此被识别为**物理模态**。\n另一个根 $g_2 = -\\mathrm{i}C \\sin(\\theta) - \\sqrt{1 - C^2 \\sin^2(\\theta)}$ 是三层格式的人为产物，被称为**计算模态**。其放大行为由该表达式给出。在稳定性条件 $|C| \\le 1$ 下，该模态的模为 $|g_2|=1$，因此它不会衰减。在 $C\\theta$ 很小的极限下，$g_2 \\approx -1$，这表明该模态会在数值解中引入周期为 $2\\Delta t$ 的虚假振荡。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\mathrm{i}C \\sin(\\theta) + \\sqrt{1 - C^2 \\sin^2(\\theta)}  -\\mathrm{i}C \\sin(\\theta) - \\sqrt{1 - C^2 \\sin^2(\\theta)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "浅水方程是地球物理流体动力学的基石，用于模拟大规模的海洋和大气环流。在对其进行数值离散时，变量在网格上的空间布局（即网格交错策略）对模型能否准确再现物理波动的行为有着深远影响。本练习通过对一个半离散系统的分析，揭示了看似直观的同点网格（Arakawa A-grid）如何在一个关键问题上失败：它无法正确模拟最短的波，反而允许一个静止的、非物理的“棋盘”模式存在，从而突显了离散化选择与模拟物理保真度之间的深刻联系。",
            "id": "3804301",
            "problem": "考虑恒定深度上小振幅自由表面重力波的一维线性化浅水方程，\n$$\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial x}, \\qquad \\frac{\\partial \\eta}{\\partial t} = - H \\frac{\\partial u}{\\partial x},$$\n其中 $u$ 是深度平均速度，$\\eta$ 是自由表面高程，$g$ 是重力加速度，$H$ 是平均深度。在一个间距为 $\\Delta x$ 的均匀空间网格上，使用 Arakawa A-网格（Arakawa A-grid (A-grid) 意味着 $u$ 和 $\\eta$ 配置在相同的网格点上）上的二阶中心差分来离散化压力梯度项 $- g \\partial \\eta/\\partial x$ 和散度项 $\\partial u/\\partial x$。将时间视为连续的，即，形成一个仅空间被离散化的半离散系统。\n\n使用 von Neumann 简正模分析（假设在均匀网格索引 $j$ 上的解的形式为 $u_j(t) = \\hat{u} \\exp\\!\\big(\\mathrm{i} (j \\theta - \\omega t)\\big)$ 和 $\\eta_j(t) = \\hat{\\eta} \\exp\\!\\big(\\mathrm{i} (j \\theta - \\omega t)\\big)$），推导这种 A-网格中心差分离散化所蕴含的半离散色散关系。然后，分析无量纲相角 $\\theta = \\pi$（设 $\\theta$ 以弧度为单位）的离散模态，以展示压力梯度和散度的同位中心差分如何引入一个伪计算模态。计算在 $\\theta = \\pi$ 时表征此模态的角频率 $\\omega$。以弧度/秒表示最终的角频率。不需要数值参数值；在整个过程中保持 $g$、$H$ 和 $\\Delta x$ 为符号。最终答案必须是一个实数。无需四舍五入。",
            "solution": "该问题要求推导和分析一维线性化浅水系统的半离散色散关系，该系统使用 Arakawa A-网格上的二阶中心差分进行离散化。\n\n连续线性化浅水方程如下：\n$$\n\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} = - H \\frac{\\partial u}{\\partial x}\n$$\n其中 $u$ 是速度，$\\eta$ 是自由表面高程，$g$ 是重力加速度，$H$ 是恒定的平均深度。\n\n我们被要求在间距为 $\\Delta x$ 的均匀网格上离散化空间导数。该网格是 Arakawa A-网格，意味着 $u$ 和 $\\eta$ 配置在网格点 $x_j = j \\Delta x$ 上。我们使用二阶中心差分来计算空间导数。设 $u_j(t)$ 和 $\\eta_j(t)$ 分别是 $u(x_j, t)$ 和 $\\eta(x_j, t)$ 的近似值。导数的近似为：\n$$\n\\left(\\frac{\\partial \\eta}{\\partial x}\\right)_j \\approx \\frac{\\eta_{j+1}(t) - \\eta_{j-1}(t)}{2 \\Delta x}\n$$\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_j \\approx \\frac{u_{j+1}(t) - u_{j-1}(t)}{2 \\Delta x}\n$$\n\n将这些近似代入控制方程，得到半离散系统（时间保持连续）：\n$$\n\\frac{d u_j}{d t} = -g \\left( \\frac{\\eta_{j+1} - \\eta_{j-1}}{2 \\Delta x} \\right)\n$$\n$$\n\\frac{d \\eta_j}{d t} = -H \\left( \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x} \\right)\n$$\n\n为了进行 von Neumann 稳定性分析，我们假设简正模解的形式为：\n$$\nu_j(t) = \\hat{u} \\exp(\\mathrm{i} (j \\theta - \\omega t))\n$$\n$$\n\\eta_j(t) = \\hat{\\eta} \\exp(\\mathrm{i} (j \\theta - \\omega t))\n$$\n其中 $\\hat{u}$ 和 $\\hat{\\eta}$ 是常数复振幅，$\\theta = k \\Delta x$ 是无量纲相角（$k$ 是波数），$\\omega$ 是角频率。\n\n模态解的时间导数为：\n$$\n\\frac{d u_j}{d t} = -\\mathrm{i} \\omega \\hat{u} \\exp(\\mathrm{i} (j \\theta - \\omega t)) = -\\mathrm{i} \\omega u_j\n$$\n$$\n\\frac{d \\eta_j}{d t} = -\\mathrm{i} \\omega \\hat{\\eta} \\exp(\\mathrm{i} (j \\theta - \\omega t)) = -\\mathrm{i} \\omega \\eta_j\n$$\n\n空间差分项变为：\n$$\n\\eta_{j+1} - \\eta_{j-1} = \\hat{\\eta} \\exp(\\mathrm{i}((j+1)\\theta - \\omega t)) - \\hat{\\eta} \\exp(\\mathrm{i}((j-1)\\theta - \\omega t))\n$$\n$$\n= \\hat{\\eta} \\exp(\\mathrm{i}(j\\theta - \\omega t)) \\left( \\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta) \\right)\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta)}{2\\mathrm{i}}$，我们有 $\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta) = 2\\mathrm{i} \\sin(\\theta)$。\n$$\n\\eta_{j+1} - \\eta_{j-1} = \\eta_j (2\\mathrm{i} \\sin(\\theta))\n$$\n类似地，对于速度差分：\n$$\nu_{j+1} - u_{j-1} = u_j (2\\mathrm{i} \\sin(\\theta))\n$$\n\n将这些结果代入半离散系统：\n$$\n-\\mathrm{i} \\omega u_j = -g \\frac{\\eta_j (2\\mathrm{i} \\sin(\\theta))}{2 \\Delta x}\n$$\n$$\n-\\mathrm{i} \\omega \\eta_j = -H \\frac{u_j (2\\mathrmi} \\sin(\\theta))}{2 \\Delta x}\n$$\n\n通过消去公因子 $-\\mathrm{i}$ 并将 $u_j$ 和 $\\eta_j$ 替换为它们的振幅 $\\hat{u}$ 和 $\\hat{\\eta}$，我们得到一个关于振幅的代数系统：\n$$\n\\omega \\hat{u} = \\frac{g \\sin(\\theta)}{\\Delta x} \\hat{\\eta}\n$$\n$$\n\\omega \\hat{\\eta} = \\frac{H \\sin(\\theta)}{\\Delta x} \\hat{u}\n$$\n\n该系统可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n\\omega  - \\frac{g \\sin(\\theta)}{\\Delta x} \\\\\n- \\frac{H \\sin(\\theta)}{\\Delta x}  \\omega\n\\end{pmatrix}\n\\begin{pmatrix}\n\\hat{u} \\\\\n\\hat{\\eta}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n为了存在非平凡解 $(\\hat{u}, \\hat{\\eta}) \\neq (0, 0)$，系数矩阵的行列式必须为零：\n$$\n\\det\\begin{pmatrix}\n\\omega  - \\frac{g \\sin(\\theta)}{\\Delta x} \\\\\n- \\frac{H \\sin(\\theta)}{\\Delta x}  \\omega\n\\end{pmatrix} = \\omega^2 - \\left(-\\frac{g \\sin(\\theta)}{\\Delta x}\\right) \\left(-\\frac{H \\sin(\\theta)}{\\Delta x}\\right) = 0\n$$\n$$\n\\omega^2 - \\frac{gH}{(\\Delta x)^2} \\sin^2(\\theta) = 0\n$$\n这就得到了半离散色散关系：\n$$\n\\omega^2 = \\frac{gH}{(\\Delta x)^2} \\sin^2(\\theta) \\implies \\omega = \\pm \\sqrt{gH} \\frac{|\\sin(\\theta)|}{\\Delta x}\n$$\n\n问题要求分析无量纲相角 $\\theta = \\pi$ 的模态。这对应于可以在网格上表示的最短波长，$\\lambda = 2\\pi/k = 2\\pi/(\\theta/\\Delta x) = 2\\Delta x$。\n将 $\\theta = \\pi$ 代入色散关系：\n$$\n\\omega^2 = \\frac{gH}{(\\Delta x)^2} \\sin^2(\\pi) = \\frac{gH}{(\\Delta x)^2} (0)^2 = 0\n$$\n因此，该模态的角频率为：\n$$\n\\omega = 0\n$$\n\n这个 $\\omega = 0$ 的结果识别出一个伪计算模态。该模态的空间结构由 $\\exp(\\mathrm{i}j\\theta) = \\exp(\\mathrm{i}j\\pi) = (\\exp(\\mathrm{i}\\pi))^j = (-1)^j$ 给出。这是一个“棋盘”模式，其中每个网格点的值是其相邻点的负值。二阶中心差分算子 $(f_{j+1} - f_{j-1})/(2\\Delta x)$ 应用于锯齿形模式 $f_j = C(-1)^j$ 得到：\n$$\n\\frac{C(-1)^{j+1} - C(-1)^{j-1}}{2\\Delta x} = \\frac{-C(-1)^j - (-C)(-1)^j}{2\\Delta x} = \\frac{-C(-1)^j + C(-1)^j}{2\\Delta x} = 0\n$$\n中心差分格式对 $2\\Delta x$ 波是“盲目”的，将其视为导数为零的场。因此，对于 $u$ 和 $\\eta$ 中的棋盘状剖面，离散的压力梯度和散度项都为零。半离散方程简化为 $\\frac{du_j}{dt} = 0$ 和 $\\frac{d\\eta_j}{dt} = 0$。这意味着任何任意的棋盘模式都是一个静止解，这是不符合物理规律的。真实的重力波必须传播，因此一个仅因离散化选择而存在的静止模态，根据定义，是一个伪计算模态。表征此静止模态的频率是 $\\omega = 0$ 弧度/秒。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}