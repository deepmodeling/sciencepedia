{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides foundational practice in applying Von Neumann analysis to a multi-dimensional problem. By analyzing the forward-in-time, centered-in-space (FTCS) scheme for the anisotropic diffusion equation, you will derive the precise relationship between the time step, grid spacings, and diffusivities that guarantees numerical stability . Mastering this derivation is a critical first step toward understanding and controlling numerical behavior in more complex ocean models.",
            "id": "3804352",
            "problem": "An ocean interior passive tracer with concentration field $C(x,y,t)$ evolves according to horizontal anisotropic diffusion with constant eddy diffusivities $K_{x}$ and $K_{y}$:\n$$\n\\frac{\\partial C}{\\partial t} \\;=\\; K_{x}\\,\\frac{\\partial^{2} C}{\\partial x^{2}} \\;+\\; K_{y}\\,\\frac{\\partial^{2} C}{\\partial y^{2}}\\,,\n$$\non a rectangular, horizontally periodic domain. Consider a uniform grid with spacings $\\Delta x$ and $\\Delta y$ and an explicit forward Euler time step of size $\\Delta t$, with second-order centered finite differences for the spatial second derivatives. The discrete update at grid point $(i,j)$ is\n$$\nC_{i,j}^{n+1} \\;=\\; C_{i,j}^{n} \\;+\\; \\Delta t \\left[ K_{x}\\,\\frac{C_{i+1,j}^{n} - 2\\,C_{i,j}^{n} + C_{i-1,j}^{n}}{\\Delta x^{2}} \\;+\\; K_{y}\\,\\frac{C_{i,j+1}^{n} - 2\\,C_{i,j}^{n} + C_{i,j-1}^{n}}{\\Delta y^{2}} \\right].\n$$\nUsing von Neumann analysis (VNA), which states that linear constant-coefficient schemes on periodic domains are stable only if the magnitude of the amplification factor does not exceed unity for all admissible discrete Fourier modes, derive the largest stable time step $\\Delta t_{\\max}$ that guarantees stability for all horizontal wavenumbers representable on the grid.\n\nYour derivation must start from the definition of the amplification factor for a discrete Fourier mode and the discrete symbol of the second-order centered second derivative. Conclude with a single closed-form symbolic expression for $\\Delta t_{\\max}$ in terms of $K_{x}$, $K_{y}$, $\\Delta x$, and $\\Delta y$. Express your final answer in seconds. Do not substitute numerical values and do not present an inequality; provide only the closed-form expression for the largest stable time step.",
            "solution": "The problem as stated is valid. It is a scientifically grounded, well-posed, and objective problem in the field of computational science, specifically concerning the numerical stability of a finite difference scheme for the two-dimensional anisotropic diffusion equation. All necessary information is provided, and the objective is to derive a standard result using a specified method, the von Neumann analysis.\n\nThe analysis begins by considering the evolution of a single, generic Fourier mode of the discrete solution $C_{i,j}^n$. A two-dimensional discrete Fourier mode is represented by the ansatz:\n$$\nC_{i,j}^{n} = \\hat{C}^{n}(k_x, k_y) e^{I (k_x x_i + k_y y_j)}\n$$\nwhere $x_i = i \\Delta x$ and $y_j = j \\Delta y$ are the grid point coordinates, $i$ and $j$ are the integer grid indices, $k_x$ and $k_y$ are the real-valued wavenumbers in the $x$ and $y$ directions, respectively, $n$ is the time-step index, and $I \\equiv \\sqrt{-1}$ is the imaginary unit. The term $\\hat{C}^{n}(k_x, k_y)$ represents the complex amplitude of the mode $(k_x, k_y)$ at time level $n$.\n\nThe von Neumann analysis postulates that for a linear scheme, the amplitude of each mode evolves independently according to a multiplicative factor, the amplification factor $G(k_x, k_y, \\Delta t)$, such that:\n$$\n\\hat{C}^{n+1} = G \\, \\hat{C}^{n}\n$$\nSubstituting the Fourier mode ansatz into this relationship gives:\n$$\nC_{i,j}^{n+1} = G \\, C_{i,j}^{n}\n$$\nWe now substitute the Fourier mode expression for $C_{i,j}^n$ into the given finite difference equation:\n$$\nC_{i,j}^{n+1} = C_{i,j}^{n} + \\frac{K_x \\Delta t}{\\Delta x^2} \\left(C_{i+1,j}^{n} - 2C_{i,j}^{n} + C_{i-1,j}^{n}\\right) + \\frac{K_y \\Delta t}{\\Delta y^2} \\left(C_{i,j+1}^{n} - 2C_{i,j}^{n} + C_{i,j-1}^{n}\\right)\n$$\nTo evaluate the terms at neighboring grid points, we note their relationship to $C_{i,j}^n$:\n$$\nC_{i \\pm 1, j}^{n} = \\hat{C}^n e^{I(k_x (i \\pm 1)\\Delta x + k_y j \\Delta y)} = C_{i,j}^n e^{\\pm I k_x \\Delta x}\n$$\n$$\nC_{i, j \\pm 1}^{n} = \\hat{C}^n e^{I(k_x i \\Delta x + k_y (j \\pm 1) \\Delta y)} = C_{i,j}^n e^{\\pm I k_y \\Delta y}\n$$\nSubstituting these expressions into the finite difference equation yields:\n$$\nG C_{i,j}^n = C_{i,j}^n + \\frac{K_x \\Delta t}{\\Delta x^2} \\left(C_{i,j}^n e^{I k_x \\Delta x} - 2C_{i,j}^n + C_{i,j}^n e^{-I k_x \\Delta x}\\right) + \\frac{K_y \\Delta t}{\\Delta y^2} \\left(C_{i,j}^n e^{I k_y \\Delta y} - 2C_{i,j}^n + C_{i,j}^n e^{-I k_y \\Delta y}\\right)\n$$\nDividing through by the non-zero common factor $C_{i,j}^n$, we obtain the expression for the amplification factor $G$:\n$$\nG = 1 + \\frac{K_x \\Delta t}{\\Delta x^2} \\left(e^{I k_x \\Delta x} - 2 + e^{-I k_x \\Delta x}\\right) + \\frac{K_y \\Delta t}{\\Delta y^2} \\left(e^{I k_y \\Delta y} - 2 + e^{-I k_y \\Delta y}\\right)\n$$\nThe expressions in parentheses represent the discrete symbols of the second-order centered second derivative operator. Using Euler's identity, $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$, we simplify these expressions:\n$$\ne^{I\\theta} - 2 + e^{-I\\theta} = 2\\cos(\\theta) - 2\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we find:\n$$\n2\\cos(\\theta) - 2 = -2(1-\\cos(\\theta)) = -4\\sin^2(\\theta/2)\n$$\nApplying this result with $\\theta_x = k_x \\Delta x$ and $\\theta_y = k_y \\Delta y$, the amplification factor becomes:\n$$\nG = 1 + \\frac{K_x \\Delta t}{\\Delta x^2} \\left[-4\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right)\\right] + \\frac{K_y \\Delta t}{\\Delta y^2} \\left[-4\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right)\\right]\n$$\n$$\nG = 1 - 4 \\Delta t \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed unity for all possible wavenumbers, i.e., $|G| \\leq 1$. Since $K_x$, $K_y$, $\\Delta t$, $\\Delta x^2$, and $\\Delta y^2$ are positive, and the sine-squared terms are non-negative, the term being subtracted from $1$ is always non-negative. This means $G \\leq 1$ is always satisfied. The critical condition for stability is the lower bound:\n$$\nG \\geq -1\n$$\nSubstituting the expression for $G$:\n$$\n1 - 4 \\Delta t \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right] \\geq -1\n$$\nRearranging the inequality to solve for $\\Delta t$:\n$$\n2 \\geq 4 \\Delta t \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]\n$$\n$$\n\\Delta t \\leq \\frac{2}{4 \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]} = \\frac{1}{2 \\left[ \\frac{K_x}{\\Delta x^2}\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{K_y}{\\Delta y^2}\\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]}\n$$\nThis inequality must hold for all wavenumbers $(k_x, k_y)$ that are representable on the grid. To find the most restrictive condition on $\\Delta t$, we must maximize the denominator. The maximum value of $\\sin^2(\\theta)$ is $1$. This occurs for the highest frequency (shortest wavelength) modes, known as the Nyquist frequencies. The shortest resolvable wavelength in the $x$-direction is $\\lambda_x = 2 \\Delta x$, which corresponds to a wavenumber $k_x = \\pi/\\Delta x$. For this mode, the argument of the sine function is $(k_x \\Delta x)/2 = \\pi/2$, and thus $\\sin^2(\\pi/2) = 1$. Similarly, the maximum value for the $y$-direction term is also $1$, occurring at $k_y = \\pi/\\Delta y$.\nThe most stringent constraint arises when both sinusoidal terms are simultaneously maximized:\n$$\n\\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\rightarrow 1 \\quad \\text{and} \\quad \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\rightarrow 1\n$$\nSubstituting these maximum values into the inequality for $\\Delta t$ gives the stability limit:\n$$\n\\Delta t \\leq \\frac{1}{2 \\left( \\frac{K_x}{\\Delta x^2} \\cdot 1 + \\frac{K_y}{\\Delta y^2} \\cdot 1 \\right)}\n$$\nThe largest stable time step, $\\Delta t_{\\max}$, is the value that satisfies this condition as an equality.\n$$\n\\Delta t_{\\max} = \\frac{1}{2 \\left( \\frac{K_x}{\\Delta x^2} + \\frac{K_y}{\\Delta y^2} \\right)}\n$$\nThis expression provides the maximum permissible time step size that ensures numerical stability for all wavenumbers.",
            "answer": "$$\n\\boxed{\\frac{1}{2\\left(\\frac{K_x}{\\Delta x^2} + \\frac{K_y}{\\Delta y^2}\\right)}}\n$$"
        },
        {
            "introduction": "Moving from dissipative to propagative systems, this problem explores the widely used leapfrog scheme for the advection equation. Your analysis will reveal that three-level time schemes can support not only a physical mode that approximates the true solution, but also a spurious computational mode . Identifying this unphysical solution and its amplification factor is a crucial skill for diagnosing and interpreting numerical simulations of wave phenomena.",
            "id": "3804397",
            "problem": "Consider one-dimensional linear advection of a passive tracer in a periodic oceanic channel governed by the partial differential equation $u_{t} + a\\,u_{x} = 0$, where $a$ is a constant zonal velocity. Discretize space on a uniform grid $x_{j} = j\\,\\Delta x$ and time at $t^{n} = n\\,\\Delta t$. Apply the leapfrog time-stepping with centered-in-space, that is, the Centered-in-Time Centered-in-Space (CTCS) scheme,\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\nwhere the Courant number is $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$.\n\nUsing Von Neumann analysis (Fourier or normal mode analysis), derive the complex amplification factors $g$ associated with a spatial Fourier mode of nondimensional wavenumber $\\theta = k\\,\\Delta x$, and establish the condition under which the scheme is neutrally stable with respect to all resolvable wavenumbers. Identify the computational mode intrinsic to the leapfrog method and obtain its amplification behavior explicitly in terms of $C$ and $\\theta$.\n\nProvide the two amplification factors as explicit closed-form analytic expressions in terms of $C$ and $\\theta$, written only with elementary functions. Express both amplification factors in a single row as your final answer.",
            "solution": "The problem requires a Von Neumann stability analysis of the Centered-in-Time Centered-in-Space (CTCS) scheme for the one-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$. The discretization is given by:\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nwhere $C = \\frac{a\\,\\Delta t}{\\Delta x}$ is the Courant number, $u_j^n$ represents the numerical solution at spatial grid point $j$ and time level $n$.\n\nFor the Von Neumann analysis, we consider a single Fourier mode solution of the form:\n$$\nu_{j}^{n} = \\hat{u}^{n} e^{i k x_{j}}\n$$\nwhere $k$ is the wavenumber and $x_j = j \\Delta x$. We introduce the nondimensional wavenumber $\\theta = k \\Delta x$, so the mode can be written as $u_{j}^{n} = \\hat{u}^{n} e^{ij\\theta}$.\nThe amplification factor, $g$, relates the amplitude of the mode at successive time levels, $\\hat{u}^{n+1} = g \\hat{u}^{n}$. Because the CTCS scheme is a three-level scheme (involving time levels $n-1$, $n$, and $n+1$), the relationship between amplitudes separated by two time steps is $\\hat{u}^{n+1} = g^2 \\hat{u}^{n-1}$.\n\nWe substitute the Fourier mode into the discrete equation. The terms become:\n- $u_{j}^{n+1} = \\hat{u}^{n+1} e^{ij\\theta} = g^2 \\hat{u}^{n-1} e^{ij\\theta}$\n- $u_{j}^{n-1} = \\hat{u}^{n-1} e^{ij\\theta}$\n- $u_{j+1}^{n} = \\hat{u}^{n} e^{i(j+1)\\theta} = (g \\hat{u}^{n-1}) e^{ij\\theta} e^{i\\theta}$\n- $u_{j-1}^{n} = \\hat{u}^{n} e^{i(j-1)\\theta} = (g \\hat{u}^{n-1}) e^{ij\\theta} e^{-i\\theta}$\n\nSubstituting these into the CTCS scheme yields:\n$$\ng^2 \\hat{u}^{n-1} e^{ij\\theta} = \\hat{u}^{n-1} e^{ij\\theta} - C \\left( g \\hat{u}^{n-1} e^{ij\\theta} e^{i\\theta} - g \\hat{u}^{n-1} e^{ij\\theta} e^{-i\\theta} \\right)\n$$\nWe can divide through by the common term $\\hat{u}^{n-1} e^{ij\\theta}$ (assuming a non-trivial solution):\n$$\ng^2 = 1 - Cg \\left( e^{i\\theta} - e^{-i\\theta} \\right)\n$$\nUsing Euler's identity, $e^{i\\theta} - e^{-i\\theta} = 2i \\sin(\\theta)$, the equation for $g$ becomes:\n$$\ng^2 = 1 - 2iCg \\sin(\\theta)\n$$\nRearranging this into a standard quadratic form, we get the characteristic equation for the amplification factor $g$:\n$$\ng^2 + (2iC \\sin(\\theta))g - 1 = 0\n$$\nThis is a quadratic equation in $g$ of the form $Ag^2 + Bg + D = 0$, with coefficients $A=1$, $B=2iC \\sin(\\theta)$, and $D=-1$. We solve for $g$ using the quadratic formula, $g = \\frac{-B \\pm \\sqrt{B^2 - 4AD}}{2A}$:\n$$\ng = \\frac{-2iC \\sin(\\theta) \\pm \\sqrt{(2iC \\sin(\\theta))^2 - 4(1)(-1)}}{2(1)}\n$$\n$$\ng = \\frac{-2iC \\sin(\\theta) \\pm \\sqrt{-4C^2 \\sin^2(\\theta) + 4}}{2}\n$$\nFactoring out a $4$ from the square root:\n$$\ng = \\frac{-2iC \\sin(\\theta) \\pm 2\\sqrt{1 - C^2 \\sin^2(\\theta)}}{2}\n$$\nThis gives the two distinct amplification factors:\n$$\ng_{1,2} = -iC \\sin(\\theta) \\pm \\sqrt{1 - C^2 \\sin^2(\\theta)}\n$$\n\nFor the scheme to be numerically stable, the magnitude of the amplification factors must be less than or equal to one, i.e., $|g| \\le 1$, for all possible values of $\\theta$.\n\nIf $1 - C^2 \\sin^2(\\theta) \\ge 0$, which is equivalent to $|C\\sin(\\theta)| \\le 1$, the term under the square root is real. Let this term be $R = \\sqrt{1 - C^2 \\sin^2(\\theta)}$. The amplification factors are $g = -iC\\sin(\\theta) \\pm R$. The magnitude squared of $g$ is the sum of the squares of its real and imaginary parts:\n$$\n|g|^2 = (\\pm R)^2 + (-C\\sin(\\theta))^2 = R^2 + C^2\\sin^2(\\theta)\n$$\nSubstituting the expression for $R^2$:\n$$\n|g|^2 = (1 - C^2 \\sin^2(\\theta)) + C^2 \\sin^2(\\theta) = 1\n$$\nThis implies $|g|=1$, so the scheme is neutrally stable. For this condition to hold for all resolvable wavenumbers $\\theta \\in [-\\pi, \\pi]$, we must have $|C\\sin(\\theta)| \\le 1$ for all $\\theta$. Since the maximum value of $|\\sin(\\theta)|$ is $1$, this requires $|C| \\le 1$. This is the Courant-Friedrichs-Lewy (CFL) stability condition for this scheme.\n\nIf $|C|  1$, there exists a range of $\\theta$ for which $1 - C^2 \\sin^2(\\theta)  0$. In this case, the square root becomes imaginary, and one of the roots for $g$ will have a magnitude greater than $1$, leading to exponential growth and instability.\n\nThe two roots, $g_1$ and $g_2$, correspond to a physical mode and a computational mode. The physical mode should approximate the true physical wave propagation. The exact amplification factor for the PDE is $g_{\\text{exact}} = \\exp(-ika \\Delta t) = \\exp(-iC\\theta)$.\nThe root $g_1 = -iC \\sin(\\theta) + \\sqrt{1 - C^2 \\sin^2(\\theta)}$ approximates $g_{\\text{exact}}$ for small $C$ and $\\theta$, and is thus identified as the **physical mode**.\nThe other root, $g_2 = -iC \\sin(\\theta) - \\sqrt{1 - C^2 \\sin^2(\\theta)}$, is an artifact of the three-level scheme and is known as the **computational mode**. Its amplification behavior is given by this expression. Under the stability condition $|C| \\le 1$, this mode has a magnitude of $|g_2|=1$, so it does not decay. In the limit of small $C\\theta$, $g_2 \\approx -1$, indicating that this mode introduces spurious oscillations with a period of $2\\Delta t$ into the numerical solution.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -iC \\sin(\\theta) + \\sqrt{1 - C^2 \\sin^2(\\theta)}  -iC \\sin(\\theta) - \\sqrt{1 - C^2 \\sin^2(\\theta)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between analytical theory and computational practice, a vital transition for any computational scientist. You are tasked with creating a versatile numerical tool to automatically perform a Von Neumann analysis on a variety of common finite difference schemes . By implementing this procedure, you will not only reinforce your theoretical understanding of stability and dispersion but also gain a powerful, reusable method for evaluating and comparing numerical methods in your own research.",
            "id": "3804367",
            "problem": "Consider the one-dimensional linear advection of a passive tracer, described by the partial differential equation $u_t + c\\,u_x = 0$, where $c$ is a constant advection speed. For a uniform grid with spacing $\\Delta x$, a translation-invariant spatial discretization of $u_x$ can be represented as a finite stencil with coefficients $\\{a_m\\}_{m=-M}^{M}$, yielding the semi-discrete form $u_t = -\\frac{c}{\\Delta x}\\sum_{m=-M}^{M} a_m\\,u_{j+m}$. Under the Von Neumann analysis framework, the discrete Fourier mode $u_j^n = A^n e^{\\mathrm{i} j \\theta}$, for mode angle $\\theta \\in [-\\pi,\\pi]$ in radians, is an eigenfunction of any such linear translation-invariant scheme. The corresponding spatial symbol is $S(\\theta) = \\sum_{m=-M}^{M} a_m e^{\\mathrm{i} m \\theta}$ and the semi-discrete eigenvalue is $\\lambda(\\theta) = -\\frac{c}{\\Delta x} S(\\theta)$. For a time step $\\Delta t$, the Courant number is defined as $\\mu = \\frac{c\\,\\Delta t}{\\Delta x}$, and the nondimensional eigenvalue is $z(\\theta) = \\lambda(\\theta)\\,\\Delta t = -\\mu\\,S(\\theta)$.\n\nA one-step time integrator applied to the scalar linear ordinary differential equation $A'(t) = \\lambda(\\theta)\\,A(t)$ produces an amplification factor $G(\\theta)$ such that $A^{n+1} = G(\\theta)\\,A^n$. For explicit Runge–Kutta methods defined by a Butcher tableau $(A,b)$, the stages can be computed recursively for the scalar problem to obtain $G(\\theta)$ without closed-form shortcuts. For the trapezoidal (Crank–Nicolson) method, the update is defined implicitly for the scalar linear equation and can be evaluated directly for $G(\\theta)$. Using these principles:\n\n1. Implement a general numerical procedure that, given a stencil $\\{a_m\\}$ and a time integrator specification, computes the amplification factor $G(\\theta)$ for any $\\theta \\in [-\\pi,\\pi]$ (radians).\n2. Implement a sampling strategy for $\\theta$ over the interval $[-\\pi,\\pi]$ (radians) to assess both stability and dispersion. Your sampling must:\n   - Use a uniform grid of $N$ angles including the endpoints $-\\pi$ and $\\pi$.\n   - Avoid division by zero in dispersion calculations by excluding angles with $|\\theta|$ below a small threshold.\n3. Assess stability by computing $\\max_{\\theta} |G(\\theta)|$ over the sampled angles and declaring the scheme stable if and only if $\\max_{\\theta} |G(\\theta)| \\leq 1$.\n4. Assess dispersion by computing the root-mean-square (RMS) phase speed error with respect to the exact advection speed $c$. For each sampled angle with $|\\theta|$ above threshold, define the numerical phase speed $v_{p,\\mathrm{num}}(\\theta) = -\\frac{\\operatorname{arg}(G(\\theta))\\,\\Delta x}{\\theta\\,\\Delta t}$, where $\\operatorname{arg}(\\cdot)$ is the principal value of the complex argument in radians. Compute the RMS of $v_{p,\\mathrm{num}}(\\theta) - c$ over the sampled angles that satisfy the threshold. All angles must be in radians; speeds are dimensionless in this problem.\n\nYour program must support the following stencils and time integrators:\n\n- Stencils for $u_x$:\n  - Upwind first-order: $a_{-1} = -1$, $a_{0} = 1$.\n  - Centered second-order: $a_{-1} = -\\frac{1}{2}$, $a_{1} = \\frac{1}{2}$.\n\n- Time integrators:\n  - Forward Euler (one-stage explicit Runge–Kutta).\n  - Explicit midpoint (two-stage, second-order Runge–Kutta).\n  - Classical three-stage, third-order Runge–Kutta.\n  - Trapezoidal rule (Crank–Nicolson).\n\nYou must implement the explicit Runge–Kutta amplification numerically via the Butcher tableau recursion for the scalar linear problem. You must implement the trapezoidal rule amplification for the scalar linear problem by directly evaluating the scalar implicit update.\n\nSampling requirement: Use $N=257$ uniformly spaced angles over $[-\\pi,\\pi]$ (radians). For dispersion, exclude angles with $|\\theta|  10^{-6}$.\n\nTest suite:\n- Case 1: Upwind first-order, Forward Euler, Courant number $\\mu = 0.8$.\n- Case 2: Upwind first-order, Forward Euler, Courant number $\\mu = 1.2$.\n- Case 3: Centered second-order, Classical three-stage third-order Runge–Kutta, Courant number $\\mu = 0.5$.\n- Case 4: Centered second-order, Forward Euler, Courant number $\\mu = 0.1$.\n- Case 5: Centered second-order, Trapezoidal rule (Crank–Nicolson), Courant number $\\mu = 2.0$.\n\nIn all test cases, take $c = 1$ and $\\Delta x = 1$, so that $\\Delta t = \\mu$; angles are in radians.\n\nProgram output specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of the form $[\\text{stable\\_flag}, \\max|G|, \\text{RMS\\_phase\\_speed\\_error}]$, where $\\text{stable\\_flag}$ is a boolean, and the remaining entries are floating-point numbers. For example, the output should look like $[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$ with no additional text.",
            "solution": "The supplied problem is a well-posed and scientifically sound exercise in the numerical analysis of partial differential equations, specifically using Von Neumann analysis to assess the stability and dispersion properties of several common finite difference schemes for the linear advection equation. The given definitions, parameters, and required computations are standard in the field of computational science and engineering. The problem statement is complete, consistent, and unambiguous. We therefore proceed with the solution.\n\nThe governing equation is the one-dimensional linear advection equation for a passive tracer concentration $u(x,t)$:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $c$ is the constant advection speed.\n\nWe discretize this equation on a uniform spatial grid $x_j = j\\Delta x$ and for discrete time levels $t^n = n\\Delta t$. The problem specifies a semi-discretization in space of the form:\n$$\n\\frac{du_j(t)}{dt} = -\\frac{c}{\\Delta x} \\sum_{m=-M}^{M} a_m u_{j+m}(t)\n$$\nwhere $\\{a_m\\}$ are the coefficients of the finite difference stencil approximating the spatial derivative $\\partial u / \\partial x$.\n\nTo perform Von Neumann stability analysis, we consider the evolution of a single Fourier mode, $u_j(t) = A(t) e^{\\mathrm{i} j \\theta}$, where $\\theta = k \\Delta x$ is the non-dimensional wavenumber (or mode angle) and $k$ is the wavenumber. Substituting this into the semi-discrete equation yields an ordinary differential equation (ODE) for the modal amplitude $A(t)$:\n$$\n\\frac{dA(t)}{dt} e^{\\mathrm{i} j \\theta} = -\\frac{c}{\\Delta x} \\sum_{m=-M}^{M} a_m A(t) e^{\\mathrm{i} (j+m) \\theta}\n$$\nDividing by $e^{\\mathrm{i} j \\theta}$ and factoring out $A(t)$, we get:\n$$\n\\frac{dA(t)}{dt} = \\left( -\\frac{c}{\\Delta x} \\sum_{m=-M}^{M} a_m e^{\\mathrm{i} m \\theta} \\right) A(t)\n$$\nThis is an ODE of the form $A'(t) = \\lambda(\\theta) A(t)$, where the complex number $\\lambda(\\theta)$ is the eigenvalue of the semi-discrete operator for the mode $\\theta$:\n$$\n\\lambda(\\theta) = -\\frac{c}{\\Delta x} S(\\theta), \\quad \\text{with} \\quad S(\\theta) = \\sum_{m=-M}^{M} a_m e^{\\mathrm{i} m \\theta}\n$$\nHere, $S(\\theta)$ is the spatial symbol of the discretization. The spatial stencils provided are:\n1.  **First-order upwind:** For $c0$, this uses a backward difference, $\\{a_{-1}=-1, a_0=1\\}$. The symbol is $S(\\theta) = -1 \\cdot e^{\\mathrm{i}(-1)\\theta} + 1 \\cdot e^{\\mathrm{i}(0)\\theta} = 1 - e^{-\\mathrm{i}\\theta}$.\n2.  **Second-order centered:** $\\{a_{-1}=-1/2, a_1=1/2\\}$. The symbol is $S(\\theta) = -\\frac{1}{2} e^{-\\mathrm{i}\\theta} + \\frac{1}{2} e^{\\mathrm{i}\\theta} = \\mathrm{i}\\sin(\\theta)$.\n\nNext, we apply a one-step time integration scheme. The update from time $t^n$ to $t^{n+1} = t^n + \\Delta t$ can be written as $A^{n+1} = G(\\theta) A^n$, where $G(\\theta)$ is the amplification factor. The stability of the fully discrete scheme requires that $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$.\n\nThe amplification factor $G(\\theta)$ is a function of the non-dimensional eigenvalue $z(\\theta) = \\lambda(\\theta) \\Delta t$. Using the Courant number $\\mu = \\frac{c \\Delta t}{\\Delta x}$, we have:\n$$\nz(\\theta) = -\\frac{c \\Delta t}{\\Delta x} S(\\theta) = -\\mu S(\\theta)\n$$\n\nThe amplification factors for the specified time integrators are as follows:\n\n**Explicit Runge-Kutta (RK) Methods:**\nFor a scalar ODE $A' = \\lambda A$, a general $s$-stage explicit RK method defined by a Butcher tableau with coefficients $A_{ij}$ and weights $b_i$ computes the next state as $A^{n+1} = A^n + \\Delta t \\sum_{i=1}^s b_i k_i$, where the stages $k_i$ are given by $k_i = \\lambda(A^n + \\Delta t \\sum_{j=1}^{i-1} A_{ij} k_j)$.\nTo compute $G(z)$, we define normalized stage derivatives $K_i = k_i / (\\lambda A^n)$, which obey the recurrence relation:\n$$\nK_1 = 1, \\quad K_i = 1 + z \\sum_{j=1}^{i-1} A_{ij} K_j \\quad \\text{for } i=2, \\dots, s\n$$\nThe amplification factor is then $G(z) = A^{n+1}/A^n = 1 + z \\sum_{i=1}^s b_i K_i$.\nThe specific RK methods are defined by their Butcher tableaux $(A,b)$:\n-   Forward Euler (1-stage): $A=[0], b=[1]$.\n-   Explicit Midpoint (2-stage): $A=\\begin{pmatrix} 0  0 \\\\ 1/2  0 \\end{pmatrix}, b=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n-   Classical RK3 (3-stage): $A=\\begin{pmatrix} 0  0  0 \\\\ 1/2  0  0 \\\\ -1  2  0 \\end{pmatrix}, b=\\begin{pmatrix} 1/6 \\\\ 2/3 \\\\ 1/6 \\end{pmatrix}$.\n\n**Trapezoidal Rule (Crank-Nicolson):**\nThis is an implicit method defined for $A'=\\lambda A$ by $A^{n+1} = A^n + \\frac{\\Delta t}{2}(\\lambda A^n + \\lambda A^{n+1})$.\nSolving for the ratio $G(z) = A^{n+1}/A^n$ with $z=\\lambda \\Delta t$:\n$$\nG = 1 + \\frac{z}{2}(1+G) \\implies G(1 - z/2) = 1 + z/2 \\implies G(z) = \\frac{1 + z/2}{1 - z/2}\n$$\n\n**Analysis Procedure:**\nThe analysis for each test case follows these steps:\n1.  Define the angle grid: a set of $N=257$ uniformly spaced points $\\theta_j$ in $[-\\pi, \\pi]$.\n2.  Compute the spatial symbol $S(\\theta_j)$ for all angles on the grid based on the chosen stencil.\n3.  Compute the non-dimensional eigenvalue $z(\\theta_j) = -\\mu S(\\theta_j)$ for the given Courant number $\\mu$.\n4.  Compute the amplification factor $G(\\theta_j)$ for all $z(\\theta_j)$ using the function corresponding to the chosen time integrator.\n5.  **Stability assessment:** Calculate $\\max_j |G(\\theta_j)|$. The scheme is declared stable if and only if this maximum is less than or equal to $1$.\n6.  **Dispersion assessment:** The numerical phase speed is $v_{p,\\text{num}}(\\theta) = -\\frac{\\arg(G(\\theta))\\Delta x}{\\theta\\Delta t}$. We are given $c=1$ and $\\Delta x=1$, so $\\Delta t = \\mu$. The formula becomes $v_{p,\\text{num}}(\\theta) = -\\frac{\\arg(G(\\theta))}{\\theta \\mu}$. The Root-Mean-Square (RMS) phase speed error is calculated over all angles where $|\\theta| \\geq 10^{-6}$:\n$$\n\\text{RMS Error} = \\sqrt{\\text{mean}[(v_{p,\\text{num}}(\\theta) - c)^2]}\n$$\nThe results for each test case are compiled into the required output format.",
            "answer": "[[true,1.000000,0.170564],[false,1.077033,0.288219],[true,1.000000,0.000085],[false,1.004988,0.001639],[true,1.000000,0.239333]]"
        }
    ]
}