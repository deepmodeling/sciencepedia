{
    "hands_on_practices": [
        {
            "introduction": "Mastering the finite difference method begins with the ability to construct numerical approximations from first principles. While many standard stencils are found in textbooks, real-world ocean modeling often requires deriving custom schemes for complex geometries, boundary conditions, or non-uniform grids. This exercise provides foundational practice in using the method of undetermined coefficients, grounded in Taylor series expansions, to derive a high-order, one-sided stencil for a first derivativeâ€”a common requirement for approximating gradients at a model boundary.",
            "id": "3792784",
            "problem": "An ocean model resolves along-shelf momentum on a uniform one-dimensional transect adjacent to a straight coastline at position $x_{0}$. The model grid spacing is $\\,\\Delta x\\,>0$ and only ocean points exist for $x \\geq x_{0}$. Let $f(x)$ be a sufficiently smooth scalar field representing the along-shelf velocity component restricted to ocean points. To compute the spatial gradient at the coastline, the model uses a one-sided finite-difference approximation to the first derivative at $x_{0}$ built from the five ocean grid points $x_{0}+m\\,\\Delta x$ for $m \\in \\{0,1,2,3,4\\}$:\n$$\nf'(x_{0}) \\approx \\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m}\\,f\\!\\left(x_{0}+m\\,\\Delta x\\right),\n$$\nwhere the coefficients $c_{m}$ are to be determined.\n\nStarting from the Taylor series expansion of $f(x)$ about $x_{0}$ and the definition of truncation error order, determine the coefficients $c_{0},c_{1},c_{2},c_{3},c_{4}$ that maximize the algebraic order of accuracy subject to the given stencil-width constraint. Then report the resulting integer order $p$ such that the truncation error is $\\,\\mathcal{O}(\\Delta x^{p})\\,$.\n\nExpress the coefficients and the order in exact rational form. Provide your final answer as a single row matrix containing $c_{0},c_{1},c_{2},c_{3},c_{4}$ and $p$ in that order. No rounding is required, and no physical units should be included in the final answer.",
            "solution": "The problem requires the determination of five coefficients, $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}$, for a one-sided finite-difference approximation of the first derivative $f'(x_{0})$ that maximizes the order of accuracy. The given approximation is:\n$$\nf'(x_{0}) \\approx \\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m}\\,f(x_{0}+m\\,\\Delta x)\n$$\nThe method of undetermined coefficients, based on Taylor series expansions, is the standard procedure for this task. We expand each function evaluation $f(x_{0}+m\\,\\Delta x)$ in a Taylor series around the point $x_{0}$. Since $f(x)$ is assumed to be sufficiently smooth, these expansions are valid. The expansion for each term is:\n$$\nf(x_{0}+m\\,\\Delta x) = f(x_{0}) + (m\\,\\Delta x)f'(x_{0}) + \\frac{(m\\,\\Delta x)^{2}}{2!}f''(x_{0}) + \\frac{(m\\,\\Delta x)^{3}}{3!}f'''(x_{0}) + \\dots = \\sum_{k=0}^{\\infty} \\frac{(m\\,\\Delta x)^{k}}{k!} f^{(k)}(x_{0})\n$$\nwhere $f^{(k)}(x_{0})$ denotes the $k$-th derivative of $f$ evaluated at $x_{0}$.\n\nSubstituting these expansions into the finite-difference formula, we get:\n$$\n\\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m} \\left( \\sum_{k=0}^{\\infty} \\frac{(m\\,\\Delta x)^{k}}{k!} f^{(k)}(x_{0}) \\right)\n$$\nWe can swap the order of summation and rearrange the expression by grouping terms with the same derivative of $f$:\n$$\n\\sum_{k=0}^{\\infty} \\frac{(\\Delta x)^{k-1}}{k!} f^{(k)}(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{k} \\right)\n$$\nLet's write out the first few terms of this expansion:\n$$\n\\frac{1}{\\Delta x} f(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{0} \\right) + f'(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{1} \\right) + \\frac{\\Delta x}{2} f''(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{2} \\right) + \\frac{(\\Delta x)^{2}}{6} f'''(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{3} \\right) + \\dots\n$$\nFor this expression to be an approximation of $f'(x_{0})$, the coefficient of $f'(x_{0})$ must be $1$, and the coefficients of other terms should be zero, up to the highest possible order. With five unknown coefficients ($c_{0}$ through $c_{4}$), we can satisfy five linear constraints. To maximize the order of accuracy, we set the coefficients of the lowest-order terms in the error to zero.\nThis leads to the following system of linear equations:\n\\begin{enumerate}\n    \\item The coefficient of $f(x_{0})$ must be zero: $\\frac{1}{\\Delta x} \\left(\\sum_{m=0}^{4} c_{m}m^{0}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m} = 0$.\n    \\item The coefficient of $f'(x_{0})$ must be one: $\\sum_{m=0}^{4} c_{m}m^{1} = 1$.\n    \\item The coefficient of $f''(x_{0})$ must be zero: $\\frac{\\Delta x}{2} \\left(\\sum_{m=0}^{4} c_{m}m^{2}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{2} = 0$.\n    \\item The coefficient of $f'''(x_{0})$ must be zero: $\\frac{(\\Delta x)^{2}}{6} \\left(\\sum_{m=0}^{4} c_{m}m^{3}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{3} = 0$.\n    \\item The coefficient of $f^{(4)}(x_{0})$ must be zero: $\\frac{(\\Delta x)^{3}}{24} \\left(\\sum_{m=0}^{4} c_{m}m^{4}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{4} = 0$.\n\\end{enumerate}\nWriting these equations explicitly for $m \\in \\{0, 1, 2, 3, 4\\}$:\n$$\n\\begin{array}{rcrcrcrcrcr}\nc_{0} &+& c_{1} &+& c_{2} &+& c_{3} &+& c_{4} &=& 0 \\\\\n0 c_{0} &+& 1 c_{1} &+& 2 c_{2} &+& 3 c_{3} &+& 4 c_{4} &=& 1 \\\\\n0 c_{0} &+& 1 c_{1} &+& 4 c_{2} &+& 9 c_{3} &+& 16 c_{4} &=& 0 \\\\\n0 c_{0} &+& 1 c_{1} &+& 8 c_{2} &+& 27 c_{3} &+& 64 c_{4} &=& 0 \\\\\n0 c_{0} &+& 1 c_{1} &+& 16 c_{2} &+& 81 c_{3} &+& 256 c_{4} &=& 0 \\\\\n\\end{array}\n$$\nThis is a system of five linear equations for the five unknown coefficients. The terms involving $c_{0}$ are zero for the last four equations. From the first equation, we have $c_{0} = -(c_{1} + c_{2} + c_{3} + c_{4})$. The remaining four equations form a $4 \\times 4$ system for $c_{1}, c_{2}, c_{3}, c_{4}$. Solving this system yields:\n$$\nc_{1} = 4\n$$\n$$\nc_{2} = -3\n$$\n$$\nc_{3} = \\frac{4}{3}\n$$\n$$\nc_{4} = -\\frac{1}{4}\n$$\nNow we find $c_{0}$:\n$$\nc_{0} = -\\left(4 - 3 + \\frac{4}{3} - \\frac{1}{4}\\right) = -\\left(1 + \\frac{16-3}{12}\\right) = -\\left(1 + \\frac{13}{12}\\right) = -\\frac{25}{12}\n$$\nSo the coefficients are:\n$c_{0} = -\\frac{25}{12}$, $c_{1} = 4$, $c_{2} = -3$, $c_{3} = \\frac{4}{3}$, $c_{4} = -\\frac{1}{4}$.\n\nThe next step is to determine the algebraic order of accuracy, $p$. The truncation error is given by the first non-zero term in the Taylor series expansion. This corresponds to the $k=5$ term:\n$$\n\\text{Truncation Error} = \\frac{(\\Delta x)^{5-1}}{5!} f^{(5)}(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{5} \\right) + \\mathcal{O}((\\Delta x)^5)\n$$\n$$\n\\text{Truncation Error} = \\frac{(\\Delta x)^{4}}{120} f^{(5)}(x_{0}) \\left( 0^{5}c_{0} + 1^{5}c_{1} + 2^{5}c_{2} + 3^{5}c_{3} + 4^{5}c_{4} \\right) + \\mathcal{O}((\\Delta x)^5)\n$$\nWe must evaluate the sum to ensure it is non-zero:\n$$\n\\sum_{m=0}^{4} c_{m}m^{5} = c_{1} + 32c_{2} + 243c_{3} + 1024c_{4} = 4 + 32(-3) + 243\\left(\\frac{4}{3}\\right) + 1024\\left(-\\frac{1}{4}\\right)\n$$\n$$\n= 4 - 96 + 81 \\times 4 - 256 = 4 - 96 + 324 - 256 = 328 - 352 = -24\n$$\nSince this sum is non-zero, the leading term of the truncation error is:\n$$\n\\text{Truncation Error} = \\frac{(\\Delta x)^{4}}{120} (-24) f^{(5)}(x_{0}) + \\mathcal{O}((\\Delta x)^5) = -\\frac{1}{5}(\\Delta x)^{4} f^{(5)}(x_{0}) + \\mathcal{O}((\\Delta x)^5)\n$$\nThe error is proportional to $(\\Delta x)^{4}$. Therefore, the order of accuracy is $p=4$.\n\nThe final results are the coefficients $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}$ and the order $p$, all in exact rational form.\n$c_{0} = -\\frac{25}{12}$, $c_{1} = 4$, $c_{2} = -3$, $c_{3} = \\frac{4}{3}$, $c_{4} = -\\frac{1}{4}$, $p=4$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{25}{12} & 4 & -3 & \\frac{4}{3} & -\\frac{1}{4} & 4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After learning how to construct a finite difference stencil, the next critical skill is to analyze and compare its accuracy. Two schemes may share the same formal order of accuracy, but their actual performance can differ significantly due to the magnitude of their leading truncation error terms. This practice delves into this concept by tasking you with a direct comparison between a symmetric interior stencil and a one-sided boundary stencil for the second derivative, quantifying exactly how much less accurate the one-sided scheme is. This analysis is vital for understanding why numerical solutions are often less accurate near boundaries and for making informed decisions in model development.",
            "id": "3792839",
            "problem": "A one-dimensional vertical column model for ocean heat diffusion uses the second derivative operator on temperature $T(z)$, where $z$ is the vertical coordinate increasing downward. The discretization is on a uniform grid with spacing $h$, with grid points $z_j = z_0 + j h$ for integer $j$. Two second-order approximations to the second derivative $T''(z)$ are used in different parts of the column:\n(1) At interior points $z_i$, a symmetric three-point stencil is used, written in the general form $D_{\\text{cen}}^{(2)} T(z_i) = \\dfrac{\\alpha\\, T(z_{i-1}) + \\beta\\, T(z_i) + \\gamma\\, T(z_{i+1})}{h^2}$, where $\\alpha$, $\\beta$, and $\\gamma$ are constants chosen to ensure second-order consistency.\n(2) At the surface boundary $z_0$, a forward one-sided four-point stencil is used, written in the general form $D_{\\text{one}}^{(2)} T(z_0) = \\dfrac{a\\, T(z_0) + b\\, T(z_1) + c\\, T(z_2) + d\\, T(z_3)}{h^2}$, where $a$, $b$, $c$, and $d$ are constants chosen to ensure second-order consistency using only points $z_0, z_1, z_2, z_3$.\n\nStarting from the Taylor series of $T(z)$ about the evaluation points and the definition of truncation error, determine the coefficients $\\alpha$, $\\beta$, $\\gamma$ and $a$, $b$, $c$, $d$ that yield second-order consistency for each stencil. Then, explicitly compute the leading truncation term for each approximation, in the sense of determining the constant $C$ in the expansion\n$$\nD^{(2)} T = T'' + C\\, h^2\\, T^{(4)} + \\mathcal{O}(h^4).\n$$\nFinally, compute the ratio of the magnitudes of these leading truncation constants between the one-sided boundary stencil and the symmetric interior stencil,\n$$\n\\rho = \\frac{|C_{\\text{one-sided}}|}{|C_{\\text{central}}|}.\n$$\nExpress your final answer for $\\rho$ as an exact rational number, with no units.",
            "solution": "The problem requires the determination of coefficients for two finite difference stencils approximating the second derivative, the calculation of their leading truncation error terms, and the ratio of the magnitudes of the error constants. The analysis proceeds by using Taylor series expansions.\n\nLet $T(z)$ be a sufficiently smooth function. We use the notation $T_j = T(z_j)$ and $T^{(k)}(z)$ for the $k$-th derivative of $T$ with respect to $z$. All expansions will be around a specific grid point, and derivatives not explicitly evaluated at another point are assumed to be at the expansion point.\n\nPart 1: Symmetric Three-Point Central Stencil\n\nThe central difference approximation for $T''(z_i)$ at an interior point $z_i$ is given by:\n$$\nD_{\\text{cen}}^{(2)} T(z_i) = \\frac{\\alpha T(z_{i-1}) + \\beta T(z_i) + \\gamma T(z_{i+1})}{h^2}\n$$\nWe expand $T(z_{i-1}) = T(z_i - h)$ and $T(z_{i+1}) = T(z_i + h)$ in Taylor series around $z_i$. Let $T^{(k)}$ denote $T^{(k)}(z_i)$.\n$$\nT(z_{i-1}) = T_i - h T' + \\frac{h^2}{2} T'' - \\frac{h^3}{6} T''' + \\frac{h^4}{24} T^{(4)} + \\mathcal{O}(h^5)\n$$\n$$\nT(z_{i+1}) = T_i + h T' + \\frac{h^2}{2} T'' + \\frac{h^3}{6} T''' + \\frac{h^4}{24} T^{(4)} + \\mathcal{O}(h^5)\n$$\nSubstituting these into the numerator of the stencil expression gives:\n$$\n\\alpha T_{i-1} + \\beta T_i + \\gamma T_{i+1} = \\alpha\\left(T_i - hT' + \\frac{h^2}{2}T'' - \\dots\\right) + \\beta T_i + \\gamma\\left(T_i + hT' + \\frac{h^2}{2}T'' + \\dots\\right)\n$$\nGrouping terms by the order of the derivative of $T$ at $z_i$:\n$$\n(\\alpha + \\beta + \\gamma)T_i + h(-\\alpha + \\gamma)T' + h^2\\left(\\frac{\\alpha}{2} + \\frac{\\gamma}{2}\\right)T'' + h^3\\left(-\\frac{\\alpha}{6} + \\frac{\\gamma}{6}\\right)T''' + h^4\\left(\\frac{\\alpha}{24} + \\frac{\\gamma}{24}\\right)T^{(4)} + \\mathcal{O}(h^5)\n$$\nFor this expression to be an approximation of $h^2 T''$, we set the coefficients of lower-order terms to zero and the coefficient of $h^2 T''$ to $1$.\n\\begin{enumerate}\n    \\item Coefficient of $T_i$: $\\alpha + \\beta + \\gamma = 0$\n    \\item Coefficient of $hT'$: $-\\alpha + \\gamma = 0 \\implies \\alpha = \\gamma$\n    \\item Coefficient of $h^2T''$: $\\frac{\\alpha}{2} + \\frac{\\gamma}{2} = 1 \\implies \\alpha + \\gamma = 2$\n\\end{enumerate}\nSolving this system, from $\\alpha = \\gamma$ and $\\alpha + \\gamma = 2$, we find $2\\alpha = 2$, which gives $\\alpha = 1$ and $\\gamma = 1$. Substituting into the first equation, $1 + \\beta + 1 = 0$, we find $\\beta = -2$.\nThe coefficients are $\\alpha=1$, $\\beta=-2$, $\\gamma=1$.\n\nThe stencil is $D_{\\text{cen}}^{(2)} T(z_i) = \\frac{T(z_{i-1}) - 2T(z_i) + T(z_{i+1})}{h^2}$.\nTo find the leading truncation term, we examine the next non-zero terms in the Taylor expansion.\nThe $T'''$ term coefficient is $h^3(-\\frac{\\alpha}{6} + \\frac{\\gamma}{6}) = h^3(-\\frac{1}{6} + \\frac{1}{6}) = 0$.\nThe $T^{(4)}$ term coefficient is $h^4(\\frac{\\alpha}{24} + \\frac{\\gamma}{24}) = h^4(\\frac{1}{24} + \\frac{1}{24}) = \\frac{2h^4}{24} = \\frac{h^4}{12}$.\nSo, the expansion of the numerator is $h^2 T'' + \\frac{h^4}{12} T^{(4)} + \\mathcal{O}(h^6)$.\nDividing by $h^2$, we get the expansion for the operator:\n$$\nD_{\\text{cen}}^{(2)} T(z_i) = T''(z_i) + \\frac{h^2}{12} T^{(4)}(z_i) + \\mathcal{O}(h^4)\n$$\nComparing this to the form $D^{(2)}T = T'' + C h^2 T^{(4)} + \\mathcal{O}(h^4)$, we identify the central difference truncation constant as $C_{\\text{central}} = \\frac{1}{12}$.\n\nPart 2: One-Sided Four-Point Forward Stencil\n\nThe one-sided stencil for $T''(z_0)$ at the boundary $z_0$ is:\n$$\nD_{\\text{one}}^{(2)} T(z_0) = \\frac{a T(z_0) + b T(z_1) + c T(z_2) + d T(z_3)}{h^2}\n$$\nwhere $z_j = z_0 + jh$. We expand $T(z_1)$, $T(z_2)$, and $T(z_3)$ in Taylor series around $z_0$. Let $T^{(k)}$ denote $T^{(k)}(z_0)$.\n$$\nT(z_j) = T(z_0 + jh) = \\sum_{k=0}^{\\infty} \\frac{(jh)^k}{k!} T^{(k)}\n$$\nSubstituting these into the numerator:\n$$\na T_0 + b T_1 + c T_2 + d T_3 = a T_0 + b \\sum_{k=0}^{\\infty} \\frac{h^k}{k!} T^{(k)} + c \\sum_{k=0}^{\\infty} \\frac{(2h)^k}{k!} T^{(k)} + d \\sum_{k=0}^{\\infty} \\frac{(3h)^k}{k!} T^{(k)}\n$$\nGrouping by derivative order $T^{(k)}$:\n$$\n\\sum_{k=0}^{\\infty} \\frac{h^k T^{(k)}}{k!} \\left( a \\cdot \\delta_{k0} + b \\cdot 1^k + c \\cdot 2^k + d \\cdot 3^k \\right) \\quad (\\text{using } 0^0=1, 0^k=0 \\text{ for } k>0)\n$$\nWe need this sum to approximate $h^2 T''$. To achieve second-order accuracy, the error for the operator $D_{\\text{one}}^{(2)}$ must be $\\mathcal{O}(h^2)$, which means the expansion of the numerator $aT_0 + bT_1 + cT_2 + dT_3$ should start with $h^2 T''$, and the term proportional to $h^3 T'''$ must be zero.\n\\begin{enumerate}\n    \\item Coefficient of $T_0$ ($k=0$): $a + b + c + d = 0$\n    \\item Coefficient of $hT'$ ($k=1$): $b + 2c + 3d = 0$\n    \\item Coefficient of $\\frac{h^2}{2}T''$ ($k=2$): $b + 4c + 9d = 2$ (so the term is $h^2 T''$)\n    \\item Coefficient of $\\frac{h^3}{6}T'''$ ($k=3$): $b + 8c + 27d = 0$\n\\end{enumerate}\nWe solve this system of four linear equations. From $(2)$, $b = -2c - 3d$.\nSubstitute $b$ into $(3)$: $(-2c - 3d) + 4c + 9d = 2 \\implies 2c + 6d = 2 \\implies c + 3d = 1$.\nSubstitute $b$ into $(4)$: $(-2c - 3d) + 8c + 27d = 0 \\implies 6c + 24d = 0 \\implies c + 4d = 0$.\nFrom the two new equations, we have $c = 1 - 3d$ and $c = -4d$.\nEquating them: $1 - 3d = -4d \\implies d = -1$.\nThen $c = -4(-1) = 4$.\nThen $b = -2(4) - 3(-1) = -8 + 3 = -5$.\nFinally, $a = -b - c - d = -(-5) - 4 - (-1) = 5 - 4 + 1 = 2$.\nThe coefficients are $a=2$, $b=-5$, $c=4$, $d=-1$.\n\nNow, we find the leading truncation term. The next term in the expansion is for $k=4$:\n$$\n\\text{Term for } T^{(4)} = \\frac{h^4 T^{(4)}}{4!} (b \\cdot 1^4 + c \\cdot 2^4 + d \\cdot 3^4) = \\frac{h^4 T^{(4)}}{24} (b + 16c + 81d)\n$$\nSubstituting the coefficients:\n$$\n\\frac{h^4 T^{(4)}}{24} (-5 + 16(4) + 81(-1)) = \\frac{h^4 T^{(4)}}{24} (-5 + 64 - 81) = \\frac{h^4 T^{(4)}}{24} (-22) = -\\frac{11 h^4}{12} T^{(4)}\n$$\nThe expansion of the numerator is $h^2 T'' - \\frac{11 h^4}{12} T^{(4)} + \\mathcal{O}(h^5)$.\nDividing by $h^2$:\n$$\nD_{\\text{one}}^{(2)} T(z_0) = T''(z_0) - \\frac{11 h^2}{12} T^{(4)}(z_0) + \\mathcal{O}(h^3)\n$$\nThe leading term of the truncation error is proportional to $h^2$. We identify the one-sided truncation constant as $C_{\\text{one-sided}} = -\\frac{11}{12}$.\n\nPart 3: Ratio of Truncation Constants\n\nThe problem asks for the ratio $\\rho = \\frac{|C_{\\text{one-sided}}|}{|C_{\\text{central}}|}$.\nWe have $C_{\\text{central}} = \\frac{1}{12}$ and $C_{\\text{one-sided}} = -\\frac{11}{12}$.\nTaking the magnitudes:\n$$\n|C_{\\text{central}}| = \\left|\\frac{1}{12}\\right| = \\frac{1}{12}\n$$\n$$\n|C_{\\text{one-sided}}| = \\left|-\\frac{11}{12}\\right| = \\frac{11}{12}\n$$\nThe ratio is:\n$$\n\\rho = \\frac{\\frac{11}{12}}{\\frac{1}{12}} = 11\n$$\nThe ratio is a dimensionless rational number, as required. This result signifies that, for a given grid spacing $h$, the leading truncation error of the second-order one-sided stencil is $11$ times larger in magnitude than that of the standard second-order central stencil.",
            "answer": "$$\\boxed{11}$$"
        },
        {
            "introduction": "The principles of discretization become more subtle and powerful when applied to the nonlinear equations that govern ocean dynamics. A scheme that is formally accurate for a linear operator may fail to preserve fundamental physical properties when used to approximate a nonlinear term, leading to unphysical model behavior such as spurious energy generation. This advanced exercise explores this critical issue by analyzing the discretization of the nonlinear advection term $u u_x$. You will first prove that a naive approach fails to conserve discrete energy and then derive an alternative, skew-symmetric formulation that correctly guarantees energy conservation, illustrating a cornerstone of modern numerical scheme design for fluid dynamics.",
            "id": "3792775",
            "problem": "Consider one-dimensional inviscid advection of a scalar velocity field $u(x,t)$ along an idealized periodic oceanic channel of length $L$, described by the continuous equation $u_t + u\\,u_x = 0$. Let a uniform grid with $N$ points and spacing $h = L/N$ approximate the channel, with periodic indexing $j \\in \\{0,1,\\dots,N-1\\}$ and $u_j(t) \\approx u(x_j,t)$ at $x_j = j h$. Define the centered finite difference operator $D_0$ by $D_0 u_j = \\frac{u_{j+1} - u_{j-1}}{2 h}$ and the discrete energy by\n$$\nE(t) = \\frac{h}{2} \\sum_{j=0}^{N-1} u_j(t)^2.\n$$\nAssume periodic boundary conditions so that index operations are modulo $N$. Consider the semi-discrete ordinary differential equation $u_t + \\mathcal{N}(u) = 0$, where $\\mathcal{N}(u)$ is a spatial finite-difference approximation to $u\\,u_x$.\n\nStarting from first principles, including the properties of the centered difference operator and the discrete inner product, do the following:\n\n1. Using the naive product-form discretization $\\mathcal{N}_{\\text{naive}}(u)_j = u_j \\, D_0 u_j$, derive an analytic expression for the discrete energy tendency $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ in terms of a discrete sum, and argue explicitly why it does not vanish in general for arbitrary $u_j$ under periodic boundary conditions.\n\n2. Propose a skew-symmetric split-form discretization of $\\mathcal{N}(u)$ of the type\n$$\n\\mathcal{N}_{\\text{skew}}(u)_j = \\alpha\\, u_j\\, D_0 u_j + \\beta\\, D_0\\!\\big(u_j^2\\big),\n$$\nwith constants $\\alpha$ and $\\beta$ chosen so that the approximation is consistent with $u\\,u_x$ and the discrete energy tendency vanishes under periodic boundary conditions. Derive the conditions on $\\alpha$ and $\\beta$ from first principles and construct explicit values for $\\alpha$ and $\\beta$.\n\n3. Using your skew-symmetric choice of $\\alpha$ and $\\beta$, compute the exact closed-form value of the discrete energy tendency $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ under periodic boundary conditions.\n\nYour final answer must be the single real number representing the value of $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ for the skew-symmetric discretization. No rounding is required, and no physical units are needed.",
            "solution": "The problem asks for an analysis of the discrete energy conservation properties of two finite difference schemes for the one-dimensional inviscid advection equation, $u_t + u u_x = 0$. We will address each of the three parts of the problem sequentially, starting from first principles.\n\nThe discrete energy is defined as\n$$\nE(t) = \\frac{h}{2} \\sum_{j=0}^{N-1} u_j(t)^2.\n$$\nIts time rate of change, or energy tendency, is found by differentiating with respect to time $t$. Applying the chain rule, we have\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( \\frac{h}{2} \\sum_{j=0}^{N-1} u_j^2 \\right) = \\frac{h}{2} \\sum_{j=0}^{N-1} 2 u_j \\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = h \\sum_{j=0}^{N-1} u_j \\frac{\\mathrm{d}u_j}{\\mathrm{d}t}.\n$$\nThe semi-discrete ordinary differential equation is given by $\\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = - \\mathcal{N}(u)_j$. Substituting this into the expression for the energy tendency yields\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j \\mathcal{N}(u)_j.\n$$\nThis expression forms the basis for our analysis.\n\nPart 1: Analysis of the naive discretization $\\mathcal{N}_{\\text{naive}}(u)_j = u_j D_0 u_j$.\n\nFor this scheme, the energy tendency is\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j (u_j D_0 u_j) = -h \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\nSubstituting the definition of the centered difference operator, $D_0 u_j = \\frac{u_{j+1} - u_{j-1}}{2h}$, we get\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j^2 \\left( \\frac{u_{j+1} - u_{j-1}}{2h} \\right) = -\\frac{1}{2} \\sum_{j=0}^{N-1} u_j^2 (u_{j+1} - u_{j-1}).\n$$\nThis is the analytic expression for the discrete energy tendency. To show that it does not vanish in general, we can manipulate the sum. Let's split the sum into two parts:\n$$\n\\sum_{j=0}^{N-1} u_j^2 (u_{j+1} - u_{j-1}) = \\sum_{j=0}^{N-1} u_j^2 u_{j+1} - \\sum_{j=0}^{N-1} u_j^2 u_{j-1}.\n$$\nWe perform a change of index on the second summation. Let $k = j-1$, so $j = k+1$. Since the indices are periodic modulo $N$, the summation over $j \\in \\{0, \\dots, N-1\\}$ is equivalent to a summation over $k \\in \\{0, \\dots, N-1\\}$. Replacing the dummy index $k$ with $j$, the second sum becomes $\\sum_{j=0}^{N-1} u_{j+1}^2 u_j$.\nThus, the total sum is\n$$\n\\sum_{j=0}^{N-1} u_j^2 u_{j+1} - \\sum_{j=0}^{N-1} u_{j+1}^2 u_j = \\sum_{j=0}^{N-1} (u_j^2 u_{j+1} - u_j u_{j+1}^2) = \\sum_{j=0}^{N-1} u_j u_{j+1} (u_j - u_{j+1}).\n$$\nThe energy tendency is therefore\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{1}{2} \\sum_{j=0}^{N-1} u_j u_{j+1} (u_j - u_{j+1}).\n$$\nThis sum is not identically zero for an arbitrary field $u_j$. For example, consider a simple case with $N=3$ and $u = (u_0, u_1, u_2) = (1, 2, 3)$. The sum becomes\n$u_0 u_1 (u_0 - u_1) + u_1 u_2 (u_1 - u_2) + u_2 u_0 (u_2 - u_0) = (1)(2)(1-2) + (2)(3)(2-3) + (3)(1)(3-1) = -2 - 6 + 6 = -2$.\nIn this case, $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{1}{2}(-2) = 1 \\neq 0$. Therefore, the naive discretization does not conserve discrete energy in general.\n\nPart 2: Derivation of the skew-symmetric discretization.\n\nWe are given the form $\\mathcal{N}_{\\text{skew}}(u)_j = \\alpha\\, u_j\\, D_0 u_j + \\beta\\, D_0\\!\\big(u_j^2\\big)$. We must find constants $\\alpha$ and $\\beta$ to satisfy two conditions: consistency and energy conservation.\n\nCondition 1: Consistency. The discrete operator must be a consistent approximation to the continuous term $u u_x$. We analyze each term in $\\mathcal{N}_{\\text{skew}}$ using Taylor expansions around $x_j$.\nThe first term gives: $u_j D_0 u_j = u(x_j) \\frac{u(x_j+h)-u(x_j-h)}{2h} = u(x_j) [u_x(x_j) + O(h^2)] = u u_x + O(h^2)$.\nThe second term gives: $D_0(u_j^2) = \\frac{u(x_j+h)^2 - u(x_j-h)^2}{2h}$. This is the centered difference of the function $f(u) = u^2$, which approximates $\\frac{d}{dx}(u^2)$. Thus, $D_0(u_j^2) = \\frac{d}{dx}(u^2) + O(h^2) = 2 u u_x + O(h^2)$.\nCombining these, the discretization approximates:\n$$\n\\mathcal{N}_{\\text{skew}}(u)_j \\approx \\alpha (u u_x) + \\beta (2 u u_x) = (\\alpha + 2\\beta) u u_x.\n$$\nFor consistency with $u u_x$, we must have $\\alpha + 2\\beta = 1$.\n\nCondition 2: Energy Conservation. The scheme must conserve discrete energy, which means $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = 0$. This requires the sum $\\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j$ to be zero.\n$$\n\\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j = \\sum_{j=0}^{N-1} u_j \\left[ \\alpha u_j D_0 u_j + \\beta D_0(u_j^2) \\right] = \\alpha \\sum_{j=0}^{N-1} u_j^2 D_0 u_j + \\beta \\sum_{j=0}^{N-1} u_j D_0(u_j^2).\n$$\nTo evaluate this, we use the property of summation by parts for the centered difference operator under periodic boundary conditions. For any two periodic grid functions $f_j$ and $g_j$, we have:\n$$\n\\sum_{j=0}^{N-1} f_j D_0 g_j = \\sum_{j=0}^{N-1} f_j \\left( \\frac{g_{j+1} - g_{j-1}}{2h} \\right) = \\frac{1}{2h} \\left( \\sum_{j=0}^{N-1} f_j g_{j+1} - \\sum_{j=0}^{N-1} f_j g_{j-1} \\right).\n$$\nRe-indexing the sums (e.g., $k=j+1$ in the first, $k=j-1$ in the second and using periodicity) yields:\n$$\n\\frac{1}{2h} \\left( \\sum_{k=0}^{N-1} f_{k-1} g_k - \\sum_{k=0}^{N-1} f_{k+1} g_k \\right) = \\sum_{k=0}^{N-1} g_k \\left( \\frac{f_{k-1} - f_{k+1}}{2h} \\right) = -\\sum_{k=0}^{N-1} g_k D_0 f_k.\n$$\nThis shows that $D_0$ is skew-adjoint with respect to the standard discrete inner product.\nApplying this property to the second term of our sum with $f_j = u_j$ and $g_j = u_j^2$:\n$$\n\\sum_{j=0}^{N-1} u_j D_0(u_j^2) = - \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\nSubstituting this back into the expression for the sum:\n$$\n\\alpha \\sum_{j=0}^{N-1} u_j^2 D_0 u_j - \\beta \\sum_{j=0}^{N-1} u_j^2 D_0 u_j = (\\alpha - \\beta) \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\nAs shown in Part 1, the sum $\\sum_j u_j^2 D_0 u_j$ is not identically zero for arbitrary $u_j$. Therefore, for the total expression to vanish for any $u_j$, the coefficient must be zero. This gives our second condition: $\\alpha - \\beta = 0$, or $\\alpha = \\beta$.\n\nSolving for $\\alpha$ and $\\beta$: We have a system of two linear equations:\n1) $\\alpha + 2\\beta = 1$\n2) $\\alpha = \\beta$\nSubstituting (2) into (1) gives $\\beta + 2\\beta = 1$, which means $3\\beta = 1$, so $\\beta = \\frac{1}{3}$. From (2), it follows that $\\alpha = \\frac{1}{3}$.\nThe explicit values are $\\alpha = 1/3$ and $\\beta = 1/3$.\n\nPart 3: Calculation of the energy tendency for the skew-symmetric scheme.\n\nUsing the derived values $\\alpha = 1/3$ and $\\beta = 1/3$, the energy tendency is given by:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j = -h \\sum_{j=0}^{N-1} u_j \\left[ \\frac{1}{3} u_j D_0 u_j + \\frac{1}{3} D_0(u_j^2) \\right].\n$$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ \\sum_{j=0}^{N-1} u_j^2 D_0 u_j + \\sum_{j=0}^{N-1} u_j D_0(u_j^2) \\right].\n$$\nAs established in Part 2 from the skew-adjoint property of $D_0$, we have $\\sum_{j} u_j D_0(u_j^2) = - \\sum_{j} u_j^2 D_0(u_j)$. Substituting this into the expression for the energy tendency:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ \\sum_{j=0}^{N-1} u_j^2 D_0 u_j - \\sum_{j=0}^{N-1} u_j^2 D_0 u_j \\right].\n$$\nThe two sums inside the brackets cancel each other exactly:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ 0 \\right] = 0.\n$$\nThe exact closed-form value of the discrete energy tendency for the skew-symmetric discretization is precisely zero, by construction. This indicates that the scheme conserves the discrete energy $E(t)$.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}