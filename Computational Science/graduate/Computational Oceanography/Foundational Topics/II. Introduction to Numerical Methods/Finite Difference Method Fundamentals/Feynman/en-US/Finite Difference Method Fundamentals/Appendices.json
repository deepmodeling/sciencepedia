{
    "hands_on_practices": [
        {
            "introduction": "At the heart of the finite difference method lies the ability to construct accurate approximations of derivatives using grid point data. This exercise provides fundamental practice in this skill, employing the method of undetermined coefficients based on Taylor series expansions. By deriving the coefficients for a high-order, one-sided stencil—a common necessity at domain boundaries like a coastline in an ocean model—you will gain a deep, practical understanding of how accuracy is formally defined and achieved .",
            "id": "3792784",
            "problem": "An ocean model resolves along-shelf momentum on a uniform one-dimensional transect adjacent to a straight coastline at position $x_{0}$. The model grid spacing is $\\,\\Delta x\\,>0$ and only ocean points exist for $x \\geq x_{0}$. Let $f(x)$ be a sufficiently smooth scalar field representing the along-shelf velocity component restricted to ocean points. To compute the spatial gradient at the coastline, the model uses a one-sided finite-difference approximation to the first derivative at $x_{0}$ built from the five ocean grid points $x_{0}+m\\,\\Delta x$ for $m \\in \\{0,1,2,3,4\\}$:\n$$\nf'(x_{0}) \\approx \\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m}\\,f\\!\\left(x_{0}+m\\,\\Delta x\\right),\n$$\nwhere the coefficients $c_{m}$ are to be determined.\n\nStarting from the Taylor series expansion of $f(x)$ about $x_{0}$ and the definition of truncation error order, determine the coefficients $c_{0},c_{1},c_{2},c_{3},c_{4}$ that maximize the algebraic order of accuracy subject to the given stencil-width constraint. Then report the resulting integer order $p$ such that the truncation error is $\\,\\mathcal{O}(\\Delta x^{p})\\,$.\n\nExpress the coefficients and the order in exact rational form. Provide your final answer as a single row matrix containing $c_{0},c_{1},c_{2},c_{3},c_{4}$ and $p$ in that order. No rounding is required, and no physical units should be included in the final answer.",
            "solution": "The problem requires the determination of five coefficients, $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}$, for a one-sided finite-difference approximation of the first derivative $f'(x_{0})$ that maximizes the order of accuracy. The given approximation is:\n$$\nf'(x_{0}) \\approx \\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m}\\,f(x_{0}+m\\,\\Delta x)\n$$\nThe method of undetermined coefficients, based on Taylor series expansions, is the standard procedure for this task. We expand each function evaluation $f(x_{0}+m\\,\\Delta x)$ in a Taylor series around the point $x_{0}$. Since $f(x)$ is assumed to be sufficiently smooth, these expansions are valid. The expansion for each term is:\n$$\nf(x_{0}+m\\,\\Delta x) = f(x_{0}) + (m\\,\\Delta x)f'(x_{0}) + \\frac{(m\\,\\Delta x)^{2}}{2!}f''(x_{0}) + \\frac{(m\\,\\Delta x)^{3}}{3!}f'''(x_{0}) + \\dots = \\sum_{k=0}^{\\infty} \\frac{(m\\,\\Delta x)^{k}}{k!} f^{(k)}(x_{0})\n$$\nwhere $f^{(k)}(x_{0})$ denotes the $k$-th derivative of $f$ evaluated at $x_{0}$.\n\nSubstituting these expansions into the finite-difference formula, we get:\n$$\n\\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m} \\left( \\sum_{k=0}^{\\infty} \\frac{(m\\,\\Delta x)^{k}}{k!} f^{(k)}(x_{0}) \\right)\n$$\nWe can swap the order of summation and rearrange the expression by grouping terms with the same derivative of $f$:\n$$\n\\sum_{k=0}^{\\infty} \\frac{(\\Delta x)^{k-1}}{k!} f^{(k)}(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{k} \\right)\n$$\nLet's write out the first few terms of this expansion:\n$$\n\\frac{1}{\\Delta x} f(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{0} \\right) + f'(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{1} \\right) + \\frac{\\Delta x}{2} f''(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{2} \\right) + \\frac{(\\Delta x)^{2}}{6} f'''(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{3} \\right) + \\dots\n$$\nFor this expression to be an approximation of $f'(x_{0})$, the coefficient of $f'(x_{0})$ must be $1$, and the coefficients of other terms should be zero, up to the highest possible order. With five unknown coefficients ($c_{0}$ through $c_{4}$), we can satisfy five linear constraints. To maximize the order of accuracy, we set the coefficients of the lowest-order terms in the error to zero.\nThis leads to the following system of linear equations:\n\\begin{enumerate}\n    \\item The coefficient of $f(x_{0})$ must be zero: $\\frac{1}{\\Delta x} \\left(\\sum_{m=0}^{4} c_{m}m^{0}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m} = 0$.\n    \\item The coefficient of $f'(x_{0})$ must be one: $\\sum_{m=0}^{4} c_{m}m^{1} = 1$.\n    \\item The coefficient of $f''(x_{0})$ must be zero: $\\frac{\\Delta x}{2} \\left(\\sum_{m=0}^{4} c_{m}m^{2}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{2} = 0$.\n    \\item The coefficient of $f'''(x_{0})$ must be zero: $\\frac{(\\Delta x)^{2}}{6} \\left(\\sum_{m=0}^{4} c_{m}m^{3}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{3} = 0$.\n    \\item The coefficient of $f^{(4)}(x_{0})$ must be zero: $\\frac{(\\Delta x)^{3}}{24} \\left(\\sum_{m=0}^{4} c_{m}m^{4}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{4} = 0$.\n\\end{enumerate}\nWriting these equations explicitly for $m \\in \\{0, 1, 2, 3, 4\\}$:\n$$\n\\begin{array}{rcrcrcrcrcr}\nc_{0} &+& c_{1} &+& c_{2} &+& c_{3} &+& c_{4} &=& 0 \\\\\n0 c_{0} &+& 1 c_{1} &+& 2 c_{2} &+& 3 c_{3} &+& 4 c_{4} &=& 1 \\\\\n0 c_{0} &+& 1 c_{1} &+& 4 c_{2} &+& 9 c_{3} &+& 16 c_{4} &=& 0 \\\\\n0 c_{0} &+& 1 c_{1} &+& 8 c_{2} &+& 27 c_{3} &+& 64 c_{4} &=& 0 \\\\\n0 c_{0} &+& 1 c_{1} &+& 16 c_{2} &+& 81 c_{3} &+& 256 c_{4} &=& 0 \\\\\n\\end{array}\n$$\nThis is a system of five linear equations for the five unknown coefficients. The terms involving $c_{0}$ are zero for the last four equations. From the first equation, we have $c_{0} = -(c_{1} + c_{2} + c_{3} + c_{4})$. The remaining four equations form a $4 \\times 4$ system for $c_{1}, c_{2}, c_{3}, c_{4}$. Solving this system yields:\n$$\nc_{1} = 4\n$$\n$$\nc_{2} = -3\n$$\n$$\nc_{3} = \\frac{4}{3}\n$$\n$$\nc_{4} = -\\frac{1}{4}\n$$\nNow we find $c_{0}$:\n$$\nc_{0} = -\\left(4 - 3 + \\frac{4}{3} - \\frac{1}{4}\\right) = -\\left(1 + \\frac{16-3}{12}\\right) = -\\left(1 + \\frac{13}{12}\\right) = -\\frac{25}{12}\n$$\nSo the coefficients are:\n$c_{0} = -\\frac{25}{12}$, $c_{1} = 4$, $c_{2} = -3$, $c_{3} = \\frac{4}{3}$, $c_{4} = -\\frac{1}{4}$.\n\nThe next step is to determine the algebraic order of accuracy, $p$. The truncation error is given by the first non-zero term in the Taylor series expansion. This corresponds to the $k=5$ term:\n$$\n\\text{Truncation Error} = \\frac{(\\Delta x)^{5-1}}{5!} f^{(5)}(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{5} \\right) + \\mathcal{O}((\\Delta x)^5)\n$$\n$$\n\\text{Truncation Error} = \\frac{(\\Delta x)^{4}}{120} f^{(5)}(x_{0}) \\left( 0^{5}c_{0} + 1^{5}c_{1} + 2^{5}c_{2} + 3^{5}c_{3} + 4^{5}c_{4} \\right) + \\mathcal{O}((\\Delta x)^5)\n$$\nWe must evaluate the sum to ensure it is non-zero:\n$$\n\\sum_{m=0}^{4} c_{m}m^{5} = c_{1} + 32c_{2} + 243c_{3} + 1024c_{4} = 4 + 32(-3) + 243\\left(\\frac{4}{3}\\right) + 1024\\left(-\\frac{1}{4}\\right)\n$$\n$$\n= 4 - 96 + 81 \\times 4 - 256 = 4 - 96 + 324 - 256 = 328 - 352 = -24\n$$\nSince this sum is non-zero, the leading term of the truncation error is:\n$$\n\\text{Truncation Error} = \\frac{(\\Delta x)^{4}}{120} (-24) f^{(5)}(x_{0}) + \\mathcal{O}((\\Delta x)^5) = -\\frac{1}{5}(\\Delta x)^{4} f^{(5)}(x_{0}) + \\mathcal{O}((\\Delta x)^5)\n$$\nThe error is proportional to $(\\Delta x)^{4}$. Therefore, the order of accuracy is $p=4$.\n\nThe final results are the coefficients $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}$ and the order $p$, all in exact rational form.\n$c_{0} = -\\frac{25}{12}$, $c_{1} = 4$, $c_{2} = -3$, $c_{3} = \\frac{4}{3}$, $c_{4} = -\\frac{1}{4}$, $p=4$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{25}{12} & 4 & -3 & \\frac{4}{3} & -\\frac{1}{4} & 4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The Lax Equivalence Theorem is a pillar of numerical analysis, stating that for a linear PDE, a consistent scheme converges if and only if it is stable. This computational exercise provides a powerful, hands-on demonstration of this principle's critical importance. By implementing the Forward-Time Centered-Space (FTCS) scheme—a method that is consistent with the advection equation but unconditionally unstable—you will witness firsthand how numerical error can grow catastrophically, leading to a complete failure of convergence .",
            "id": "3792747",
            "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $u_t + c\\,u_x = 0$ for a periodic domain $x \\in [0,L]$, where $c$ is a constant advection speed. The numerical method to be examined is the forward-time centered-space (FTCS) finite difference scheme applied to this PDE. The goal is to construct a numerical example that demonstrates that a scheme which is consistent but unstable can fail to converge to the exact PDE solution as the spatial grid is refined, and to quantify the divergence using error norms as $\\Delta x \\to 0$. All variables are dimensionless, so no physical units are required.\n\nYou must implement the FTCS scheme with periodic boundary conditions, using spatial step size $\\Delta x = L/N$, time step $\\Delta t = \\lambda\\,\\Delta x/c$, and Courant–Friedrichs–Lewy (CFL) number $\\lambda = c\\,\\Delta t/\\Delta x$. Use $L=1$, $c=1$, and final time $T=1$. The FTCS update is computed for grid points $x_j = j\\,\\Delta x$, $j=0,\\dots,N-1$, and time levels $t^n = n\\,\\Delta t$, $n=0,\\dots,N_t$, with $N_t = T/\\Delta t$ chosen so that $N_t$ is an integer.\n\nConstruct a grid-dependent initial condition that excites a high-frequency Fourier mode relative to the grid: for each $N$ in the test suite, set $m = N/4$ and define the discrete initial condition $u_j^0 = \\sin\\!\\big(2\\pi\\, m\\, x_j / L\\big)$. This choice implies a wavelength of $4\\,\\Delta x$, which is a fixed fraction of the Nyquist limit across refinements and is specifically designed to provoke instability in the FTCS scheme. The exact solution of the PDE at time $T$ with periodic boundary conditions is $u_{\\text{exact}}(x_j,T) = \\sin\\!\\left(2\\pi\\, m\\, (x_j - c\\,T)/L\\right)$. With $L=1$, $c=1$, and $T=1$, this reduces to $u_{\\text{exact}}(x_j,T) = \\sin\\!\\left(2\\pi\\, m\\, x_j/L\\right)$, because the shift by one domain length returns the wave to its original phase on the periodic interval.\n\nCompute the numerical FTCS solution $u_j^{N_t}$ at time $T$ and quantify the error against the exact solution using the following norms:\n- The discrete $L^2$ error norm defined by $\\|e\\|_2 = \\sqrt{\\Delta x \\sum_{j=0}^{N-1} \\left(u_j^{N_t} - u_{\\text{exact}}(x_j,T)\\right)^2}$.\n- The discrete $L^\\infty$ error norm defined by $\\|e\\|_\\infty = \\max_{0 \\le j \\le N-1} \\left|u_j^{N_t} - u_{\\text{exact}}(x_j,T)\\right|$.\n\nUse the fixed Courant–Friedrichs–Lewy (CFL) number $\\lambda = 0.01$. The time step is $\\Delta t = \\lambda\\,\\Delta x/c$, and $N_t = T/\\Delta t$ must be exactly an integer so that the final time is reached.\n\nTest Suite:\n- Case $1$: $N=64$, $m=N/4=16$.\n- Case $2$: $N=128$, $m=N/4=32$.\n- Case $3$: $N=256$, $m=N/4=64$.\n- Case $4$: $N=400$, $m=N/4=100$.\n\nYour program must compute, for each test case, the $L^2$ and $L^\\infty$ error norms at time $T$. To quantify divergence as $\\Delta x \\to 0$, also compute two booleans that indicate whether the sequence of $L^2$ errors is nondecreasing across the ordered test cases and whether the sequence of $L^\\infty$ errors is nondecreasing across the ordered test cases. Nondecreasing means each error is less than or equal to the next when moving from coarse to fine grids.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The format is $[E_2,E_\\infty, B]$, where $E_2$ is the list of $L^2$ errors for the test suite, $E_\\infty$ is the list of $L^\\infty$ errors for the test suite, and $B$ is the list containing the two booleans described above. All floating-point numbers in the output must be rounded to six decimal places. For example, the output should look like $[[e_{2,1},e_{2,2},e_{2,3},e_{2,4}],[e_{\\infty,1},e_{\\infty,2},e_{\\infty,3},e_{\\infty,4}],[b_1,b_2]]$.",
            "solution": "The problem requires a numerical demonstration of the concept that a finite difference scheme that is consistent but unstable will fail to converge to the true solution of a partial differential equation (PDE) as the grid is refined. Specifically, we will analyze the Forward-Time Centered-Space (FTCS) scheme applied to the one-dimensional linear advection equation.\n\nThe governing PDE is the linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x,t)$ is the transported quantity, $c$ is the constant advection speed, $t$ is time, and $x$ is the spatial coordinate. The domain $x \\in [0, L]$ is periodic.\n\nThe FTCS scheme discretizes this PDE on a grid with spatial step $\\Delta x = L/N$ and time step $\\Delta t$. The grid points are $x_j = j\\,\\Delta x$ and time levels are $t^n = n\\,\\Delta t$. The partial derivatives are approximated by finite differences:\n- Forward difference in time (at $x_j, t^n$): $u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}$\n- Centered difference in space (at $x_j, t^n$): $u_x \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}$\n\nSubstituting these into the PDE gives:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} \\right) = 0\n$$\nRearranging for the solution at the next time step, $u_j^{n+1}$, yields the FTCS update rule:\n$$\nu_j^{n+1} = u_j^n - \\frac{c \\Delta t}{2 \\Delta x} \\left( u_{j+1}^n - u_{j-1}^n \\right)\n$$\nIntroducing the Courant–Friedrichs–Lewy (CFL) number, $\\lambda = c\\,\\Delta t / \\Delta x$, the scheme is written as:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2} \\left( u_{j+1}^n - u_{j-1}^n \\right)\n$$\nThe FTCS scheme is consistent with the PDE, with a truncation error of order $O(\\Delta t, (\\Delta x)^2)$. However, consistency alone is not sufficient for convergence. The Lax Equivalence Theorem states that for a consistent linear scheme, stability is the necessary and sufficient condition for convergence.\n\nTo assess the stability of the FTCS scheme, we perform a von Neumann stability analysis. We consider the evolution of a single Fourier mode of the solution, $u_j^n = G(k)^n e^{i k x_j}$, where $k$ is the wavenumber and $G(k)$ is the amplification factor per time step. Substituting this into the FTCS update rule:\n$$\nG(k)^{n+1} e^{i k x_j} = G(k)^n e^{i k x_j} - \\frac{\\lambda}{2} \\left( G(k)^n e^{i k x_{j+1}} - G(k)^n e^{i k x_{j-1}} \\right)\n$$\nDividing by $G(k)^n e^{i k x_j}$:\n$$\nG(k) = 1 - \\frac{\\lambda}{2} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right)\n$$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, we get:\n$$\nG(k) = 1 - i \\lambda \\sin(k \\Delta x)\n$$\nFor a scheme to be stable, the magnitude of the amplification factor must satisfy $|G(k)| \\le 1$ for all wavenumbers $k$. The magnitude of $G(k)$ is:\n$$\n|G(k)| = \\sqrt{1^2 + (-\\lambda \\sin(k \\Delta x))^2} = \\sqrt{1 + \\lambda^2 \\sin^2(k \\Delta x)}\n$$\nFor any non-zero $\\lambda$ and any $k$ such that $\\sin(k \\Delta x) \\neq 0$, the term $\\lambda^2 \\sin^2(k \\Delta x)$ is positive. Therefore, $|G(k)| > 1$. This means that Fourier modes of the numerical solution will be amplified at every time step, leading to exponential growth and unconditional instability, regardless of the value of $\\lambda$.\n\nThis problem is designed to demonstrate this instability. The initial condition is chosen to be a high-frequency mode relative to the grid: $u_j^0 = \\sin(2\\pi m x_j/L)$ with $m = N/4$. The dimensionless wavenumber for this mode is $k \\Delta x = (2\\pi m/L) \\Delta x = (2\\pi (N/4)/L)(L/N) = \\pi/2$. For this specific mode, which is re-introduced at each level of grid refinement, the amplification factor is constant:\n$$\n|G| = \\sqrt{1 + \\lambda^2 \\sin^2(\\pi/2)} = \\sqrt{1 + \\lambda^2}\n$$\nWith the given $\\lambda=0.01$, this is $|G| = \\sqrt{1.0001} \\approx 1.00005$. While this amplification is small for a single time step, it is compounded over $N_t$ steps. The number of time steps is $N_t = T/\\Delta t = T / (\\lambda \\Delta x / c) = (cT)/(\\lambda L) \\cdot N$. Since $c=1$, $T=1$, $L=1$, and $\\lambda=0.01$, we have $N_t = 100N$. As $N$ increases (i.e., as $\\Delta x \\to 0$), $N_t$ also increases. The total amplification of the initial mode's amplitude over the simulation time $T$ is $|G|^{N_t} = (\\sqrt{1+\\lambda^2})^{100N}$. This quantity grows exponentially with $N$. Consequently, the error between the numerical solution and the exact solution is expected to grow, demonstrating divergence.\n\nThe exact solution for the initial condition $u(x,0) = \\sin(2\\pi m x/L)$ is $u(x,t) = \\sin(2\\pi m (x-ct)/L)$. At the final time $T=1$, with $c=1$ and $L=1$, this is $u(x_j,1) = \\sin(2\\pi m(x_j-1))$. The phase shift is $2\\pi m = 2\\pi(N/4) = N\\pi/2$. Since $N$ is a multiple of $4$ in all test cases, $N/2$ is an even integer, and the phase shift is an integer multiple of $2\\pi$. Thus, $\\sin(2\\pi m(x_j-1)) = \\sin(2\\pi m x_j - N\\pi/2) = \\sin(2\\pi m x_j)$. The exact solution at time $T$ is identical to the initial condition.\n\nThe computational procedure is as follows:\n1. Iterate through each specified value of $N$ from the test suite.\n2. For each $N$, set up the grid $x_j$, calculate $\\Delta x, \\Delta t, N_t$, and define the initial condition array $u^0$ and the exact solution array $u_{\\text{exact}}$.\n3. Initialize the numerical solution array $u$ with the initial condition $u^0$.\n4. Loop for $N_t$ time steps, at each step updating $u$ using the vectorized FTCS rule: $u_{\\text{new}} = u_{\\text{old}} - (\\lambda/2) (\\text{roll}(u_{\\text{old}},-1) - \\text{roll}(u_{\\text{old}},1))$, where $\\text{roll}$ implements the periodic boundary conditions.\n5. After the time-stepping loop, compute the error vector $e_j = u_j^{N_t} - u_{\\text{exact}}(x_j, T)$.\n6. Calculate the discrete $L^2$ error norm $\\|e\\|_2 = \\sqrt{\\Delta x \\sum e_j^2}$ and the $L^\\infty$ error norm $\\|e\\|_\\infty = \\max_j |e_j|$.\n7. After computing errors for all $N$, check if the sequence of $L^2$ errors and $L^\\infty$ errors are nondecreasing.\n8. Format the collected error norms and boolean flags into the specified output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the numerical solution of the 1D linear advection equation\n    using the unstable FTCS scheme to demonstrate divergence.\n    \"\"\"\n    \n    # Problem constants\n    L = 1.0\n    c = 1.0\n    T = 1.0\n    lam = 0.01  # CFL number lambda\n\n    # Test suite\n    test_cases = [64, 128, 256, 400]\n\n    l2_errors = []\n    linf_errors = []\n\n    for N in test_cases:\n        # Discretization parameters\n        m = N // 4\n        dx = L / N\n        # dt must be calculated to ensure Nt is an integer\n        # Nt = T / dt => dt = T / Nt\n        # We also need dt = lam * dx / c\n        # So Nt = T / (lam * dx / c) = (T * c) / (lam * L / N) = (T*c*N)/(lam*L)\n        Nt = int((T * c * N) / (lam * L))\n        # Ensure Nt is exactly integer, which it is for these parameters\n        # Nt = (1*1*N)/(0.01*1) = 100*N\n        \n        # Spatial grid (periodic, so endpoint is not included)\n        x = np.linspace(0, L, N, endpoint=False)\n\n        # Initial condition\n        u_initial = np.sin(2 * np.pi * m * x / L)\n        \n        # The exact solution at time T=1.\n        # For the given parameters, u_exact(x, T) is the same as u_initial(x).\n        # u_exact(x,T) = sin(2*pi*m*(x-c*T)/L)\n        # Phase shift: 2*pi*m*c*T/L = 2*pi*(N/4)*1*1/1 = N*pi/2\n        # Since N is a multiple of 4, N/2 is an even integer.\n        # N*pi/2 is an integer multiple of 2*pi.\n        # So sin(A - N*pi/2) = sin(A).\n        u_exact_T = u_initial.copy()\n\n        # Initialize numerical solution\n        u = u_initial.copy()\n        \n        # Time-stepping loop\n        for n in range(Nt):\n            # Apply the FTCS update rule with periodic boundary conditions\n            # u_j^{n+1} = u_j^n - (lambda/2) * (u_{j+1}^n - u_{j-1}^n)\n            # np.roll(u, -1) gives u_{j+1} and np.roll(u, 1) gives u_{j-1}\n            u = u - 0.5 * lam * (np.roll(u, -1) - np.roll(u, 1))\n\n        # Compute error vector at final time T\n        error_vec = u - u_exact_T\n\n        # Compute L2 error norm\n        l2_error = np.sqrt(dx * np.sum(error_vec**2))\n        l2_errors.append(l2_error)\n\n        # Compute L-infinity error norm\n        linf_error = np.max(np.abs(error_vec))\n        linf_errors.append(linf_error)\n\n    # Check for nondecreasing error sequences\n    is_nondecreasing_l2 = all(l2_errors[i] <= l2_errors[i+1] for i in range(len(l2_errors) - 1))\n    is_nondecreasing_linf = all(linf_errors[i] <= linf_errors[i+1] for i in range(len(linf_errors) - 1))\n    \n    bool_checks = [is_nondecreasing_l2, is_nondecreasing_linf]\n\n    # Format the output as specified\n    l2_errors_str = f\"[{','.join(f'{e:.6f}' for e in l2_errors)}]\"\n    linf_errors_str = f\"[{','.join(f'{e:.6f}' for e in linf_errors)}]\"\n    bool_checks_str = f\"[{','.join(str(b) for b in bool_checks)}]\"\n    \n    # Final print statement in the exact required format\n    print(f\"[{l2_errors_str},{linf_errors_str},{bool_checks_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In geophysical fluid dynamics, it is crucial that numerical models do not create or destroy conserved quantities like energy or mass spuriously. This exercise delves into the subtle but vital topic of designing discretizations that preserve the conservation laws of the underlying physical system. You will analyze the nonlinear advection term $u u_x$, show how a naive discretization fails to conserve energy, and then construct a skew-symmetric form that guarantees discrete energy conservation, a technique essential for building robust, long-term ocean circulation models .",
            "id": "3792775",
            "problem": "Consider one-dimensional inviscid advection of a scalar velocity field $u(x,t)$ along an idealized periodic oceanic channel of length $L$, described by the continuous equation $u_t + u\\,u_x = 0$. Let a uniform grid with $N$ points and spacing $h = L/N$ approximate the channel, with periodic indexing $j \\in \\{0,1,\\dots,N-1\\}$ and $u_j(t) \\approx u(x_j,t)$ at $x_j = j h$. Define the centered finite difference operator $D_0$ by $D_0 u_j = \\frac{u_{j+1} - u_{j-1}}{2 h}$ and the discrete energy by\n$$\nE(t) = \\frac{h}{2} \\sum_{j=0}^{N-1} u_j(t)^2.\n$$\nAssume periodic boundary conditions so that index operations are modulo $N$. Consider the semi-discrete ordinary differential equation $u_t + \\mathcal{N}(u) = 0$, where $\\mathcal{N}(u)$ is a spatial finite-difference approximation to $u\\,u_x$.\n\nStarting from first principles, including the properties of the centered difference operator and the discrete inner product, do the following:\n\n1. Using the naive product-form discretization $\\mathcal{N}_{\\text{naive}}(u)_j = u_j \\, D_0 u_j$, derive an analytic expression for the discrete energy tendency $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ in terms of a discrete sum, and argue explicitly why it does not vanish in general for arbitrary $u_j$ under periodic boundary conditions.\n\n2. Propose a skew-symmetric split-form discretization of $\\mathcal{N}(u)$ of the type\n$$\n\\mathcal{N}_{\\text{skew}}(u)_j = \\alpha\\, u_j\\, D_0 u_j + \\beta\\, D_0\\!\\big(u_j^2\\big),\n$$\nwith constants $\\alpha$ and $\\beta$ chosen so that the approximation is consistent with $u\\,u_x$ and the discrete energy tendency vanishes under periodic boundary conditions. Derive the conditions on $\\alpha$ and $\\beta$ from first principles and construct explicit values for $\\alpha$ and $\\beta$.\n\n3. Using your skew-symmetric choice of $\\alpha$ and $\\beta$, compute the exact closed-form value of the discrete energy tendency $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ under periodic boundary conditions.\n\nYour final answer must be the single real number representing the value of $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ for the skew-symmetric discretization. No rounding is required, and no physical units are needed.",
            "solution": "The problem asks for an analysis of the discrete energy conservation properties of two finite difference schemes for the one-dimensional inviscid advection equation, $u_t + u u_x = 0$. We will address each of the three parts of the problem sequentially, starting from first principles.\n\nThe discrete energy is defined as\n$$\nE(t) = \\frac{h}{2} \\sum_{j=0}^{N-1} u_j(t)^2.\n$$\nIts time rate of change, or energy tendency, is found by differentiating with respect to time $t$. Applying the chain rule, we have\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( \\frac{h}{2} \\sum_{j=0}^{N-1} u_j^2 \\right) = \\frac{h}{2} \\sum_{j=0}^{N-1} 2 u_j \\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = h \\sum_{j=0}^{N-1} u_j \\frac{\\mathrm{d}u_j}{\\mathrm{d}t}.\n$$\nThe semi-discrete ordinary differential equation is given by $\\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = - \\mathcal{N}(u)_j$. Substituting this into the expression for the energy tendency yields\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j \\mathcal{N}(u)_j.\n$$\nThis expression forms the basis for our analysis.\n\nPart 1: Analysis of the naive discretization $\\mathcal{N}_{\\text{naive}}(u)_j = u_j D_0 u_j$.\n\nFor this scheme, the energy tendency is\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j (u_j D_0 u_j) = -h \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\nSubstituting the definition of the centered difference operator, $D_0 u_j = \\frac{u_{j+1} - u_{j-1}}{2h}$, we get\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j^2 \\left( \\frac{u_{j+1} - u_{j-1}}{2h} \\right) = -\\frac{1}{2} \\sum_{j=0}^{N-1} u_j^2 (u_{j+1} - u_{j-1}).\n$$\nThis is the analytic expression for the discrete energy tendency. To show that it does not vanish in general, we can manipulate the sum. Let's split the sum into two parts:\n$$\n\\sum_{j=0}^{N-1} u_j^2 (u_{j+1} - u_{j-1}) = \\sum_{j=0}^{N-1} u_j^2 u_{j+1} - \\sum_{j=0}^{N-1} u_j^2 u_{j-1}.\n$$\nWe perform a change of index on the second summation. Let $k = j-1$, so $j = k+1$. Since the indices are periodic modulo $N$, the summation over $j \\in \\{0, \\dots, N-1\\}$ is equivalent to a summation over $k \\in \\{0, \\dots, N-1\\}$. Replacing the dummy index $k$ with $j$, the second sum becomes $\\sum_{j=0}^{N-1} u_{j+1}^2 u_j$.\nThus, the total sum is\n$$\n\\sum_{j=0}^{N-1} u_j^2 u_{j+1} - \\sum_{j=0}^{N-1} u_{j+1}^2 u_j = \\sum_{j=0}^{N-1} (u_j^2 u_{j+1} - u_j u_{j+1}^2) = \\sum_{j=0}^{N-1} u_j u_{j+1} (u_j - u_{j+1}).\n$$\nThe energy tendency is therefore\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{1}{2} \\sum_{j=0}^{N-1} u_j u_{j+1} (u_j - u_{j+1}).\n$$\nThis sum is not identically zero for an arbitrary field $u_j$. For example, consider a simple case with $N=3$ and $u = (u_0, u_1, u_2) = (1, 2, 3)$. The sum becomes\n$u_0 u_1 (u_0 - u_1) + u_1 u_2 (u_1 - u_2) + u_2 u_0 (u_2 - u_0) = (1)(2)(1-2) + (2)(3)(2-3) + (3)(1)(3-1) = -2 - 6 + 6 = -2$.\nIn this case, $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{1}{2}(-2) = 1 \\neq 0$. Therefore, the naive discretization does not conserve discrete energy in general.\n\nPart 2: Derivation of the skew-symmetric discretization.\n\nWe are given the form $\\mathcal{N}_{\\text{skew}}(u)_j = \\alpha\\, u_j\\, D_0 u_j + \\beta\\, D_0\\!\\big(u_j^2\\big)$. We must find constants $\\alpha$ and $\\beta$ to satisfy two conditions: consistency and energy conservation.\n\nCondition 1: Consistency. The discrete operator must be a consistent approximation to the continuous term $u u_x$. We analyze each term in $\\mathcal{N}_{\\text{skew}}$ using Taylor expansions around $x_j$.\nThe first term gives: $u_j D_0 u_j = u(x_j) \\frac{u(x_j+h)-u(x_j-h)}{2h} = u(x_j) [u_x(x_j) + O(h^2)] = u u_x + O(h^2)$.\nThe second term gives: $D_0(u_j^2) = \\frac{u(x_j+h)^2 - u(x_j-h)^2}{2h}$. This is the centered difference of the function $f(u) = u^2$, which approximates $\\frac{d}{dx}(u^2)$. Thus, $D_0(u_j^2) = \\frac{d}{dx}(u^2) + O(h^2) = 2 u u_x + O(h^2)$.\nCombining these, the discretization approximates:\n$$\n\\mathcal{N}_{\\text{skew}}(u)_j \\approx \\alpha (u u_x) + \\beta (2 u u_x) = (\\alpha + 2\\beta) u u_x.\n$$\nFor consistency with $u u_x$, we must have $\\alpha + 2\\beta = 1$.\n\nCondition 2: Energy Conservation. The scheme must conserve discrete energy, which means $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = 0$. This requires the sum $\\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j$ to be zero.\n$$\n\\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j = \\sum_{j=0}^{N-1} u_j \\left[ \\alpha u_j D_0 u_j + \\beta D_0(u_j^2) \\right] = \\alpha \\sum_{j=0}^{N-1} u_j^2 D_0 u_j + \\beta \\sum_{j=0}^{N-1} u_j D_0(u_j^2).\n$$\nTo evaluate this, we use the property of summation by parts for the centered difference operator under periodic boundary conditions. For any two periodic grid functions $f_j$ and $g_j$, we have:\n$$\n\\sum_{j=0}^{N-1} f_j D_0 g_j = \\sum_{j=0}^{N-1} f_j \\left( \\frac{g_{j+1} - g_{j-1}}{2h} \\right) = \\frac{1}{2h} \\left( \\sum_{j=0}^{N-1} f_j g_{j+1} - \\sum_{j=0}^{N-1} f_j g_{j-1} \\right).\n$$\nRe-indexing the sums (e.g., $k=j+1$ in the first, $k=j-1$ in the second and using periodicity) yields:\n$$\n\\frac{1}{2h} \\left( \\sum_{k=0}^{N-1} f_{k-1} g_k - \\sum_{k=0}^{N-1} f_{k+1} g_k \\right) = \\sum_{k=0}^{N-1} g_k \\left( \\frac{f_{k-1} - f_{k+1}}{2h} \\right) = -\\sum_{k=0}^{N-1} g_k D_0 f_k.\n$$\nThis shows that $D_0$ is skew-adjoint with respect to the standard discrete inner product.\nApplying this property to the second term of our sum with $f_j = u_j$ and $g_j = u_j^2$:\n$$\n\\sum_{j=0}^{N-1} u_j D_0(u_j^2) = - \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\nSubstituting this back into the expression for the sum:\n$$\n\\alpha \\sum_{j=0}^{N-1} u_j^2 D_0 u_j - \\beta \\sum_{j=0}^{N-1} u_j^2 D_0 u_j = (\\alpha - \\beta) \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\nAs shown in Part 1, the sum $\\sum_j u_j^2 D_0 u_j$ is not identically zero for arbitrary $u_j$. Therefore, for the total expression to vanish for any $u_j$, the coefficient must be zero. This gives our second condition: $\\alpha - \\beta = 0$, or $\\alpha = \\beta$.\n\nSolving for $\\alpha$ and $\\beta$: We have a system of two linear equations:\n1) $\\alpha + 2\\beta = 1$\n2) $\\alpha = \\beta$\nSubstituting (2) into (1) gives $\\beta + 2\\beta = 1$, which means $3\\beta = 1$, so $\\beta = \\frac{1}{3}$. From (2), it follows that $\\alpha = \\frac{1}{3}$.\nThe explicit values are $\\alpha = 1/3$ and $\\beta = 1/3$.\n\nPart 3: Calculation of the energy tendency for the skew-symmetric scheme.\n\nUsing the derived values $\\alpha = 1/3$ and $\\beta = 1/3$, the energy tendency is given by:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j = -h \\sum_{j=0}^{N-1} u_j \\left[ \\frac{1}{3} u_j D_0 u_j + \\frac{1}{3} D_0(u_j^2) \\right].\n$$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ \\sum_{j=0}^{N-1} u_j^2 D_0 u_j + \\sum_{j=0}^{N-1} u_j D_0(u_j^2) \\right].\n$$\nAs established in Part 2 from the skew-adjoint property of $D_0$, we have $\\sum_{j} u_j D_0(u_j^2) = - \\sum_{j} u_j^2 D_0(u_j)$. Substituting this into the expression for the energy tendency:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ \\sum_{j=0}^{N-1} u_j^2 D_0 u_j - \\sum_{j=0}^{N-1} u_j^2 D_0 u_j \\right].\n$$\nThe two sums inside the brackets cancel each other exactly:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ 0 \\right] = 0.\n$$\nThe exact closed-form value of the discrete energy tendency for the skew-symmetric discretization is precisely zero, by construction. This indicates that the scheme conserves the discrete energy $E(t)$.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}