{
    "hands_on_practices": [
        {
            "introduction": "$\\beta$ 平面近似是地球物理流体动力学的基石，它将地球的球形几何简化为一个笛卡尔平面，在该平面上科里奥利效应随纬度线性变化。本练习旨在从基本定义出发，推导该近似中的关键参数 $\\beta$。通过计算 $\\beta$ 的值，您将具体理解地球的自转和曲率如何被浓缩在一个强大的参数中，用以控制大规模的海洋和大气波动与环流。",
            "id": "3926055",
            "problem": "考虑一个位于球形地球上的中纬度大气或海洋的局地笛卡尔坐标系区域，其中心位于参考纬度 $\\phi_{0}=45^{\\circ}$。地球半径 $a=6.371\\times 10^{6}\\,\\mathrm{m}$，自转角速度恒为 $\\Omega=7.2921\\times 10^{-5}\\,\\mathrm{s}^{-1}$。局地经向坐标 $y$ 是指从参考纬度沿大圆测量的物理距离。纬度 $\\phi$ 处的科里奥利参数 $f$ 定义为 $f=2\\Omega\\sin\\phi$。在 $\\beta$ 平面近似中，$f$ 随纬度的变化在 $\\phi_{0}$ 附近被线性化为 $f(y)\\approx f_{0}+\\beta\\,y$，其中 $f_{0}$ 是 $f$ 在 $\\phi_{0}$ 处的值，$\\beta$ 是在 $\\phi_{0}$ 处计算的行星涡度的经向梯度。\n\n仅从 $f$ 的定义以及球面上经向弧长与纬度之间的几何关系出发，推导在 $\\phi_{0}=45^{\\circ}$ 处 $\\beta$ 的解析表达式，然后计算其数值。将 $\\beta$ 的单位表示为 $\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1}$，并将最终数值结果四舍五入到四位有效数字。通过量化在 $\\phi_{0}$ 处每单位经向距离上 $f$ 的分数变化，简要解释 $\\beta$ 相对于 $f_{0}$ 的量级；请在演算过程中用文字形式给出此解释，但最终答案只提交 $\\beta$ 的数值。",
            "solution": "问题要求推导贝塔参数 $\\beta$ 的解析表达式，并在参考纬度 $\\phi_{0}=45^{\\circ}$ 处进行数值计算。$\\beta$ 平面近似将科里奥利参数 $f$ 相对于经向距离 $y$ 线性化为 $f(y) \\approx f_{0} + \\beta y$。系数 $\\beta$ 是在参考纬度（即 $y=0$ 处）计算的 $f$ 的经向梯度。\n\n根据定义，$\\beta$ 由下式给出：\n$$ \\beta = \\left. \\frac{df}{dy} \\right|_{y=0} $$\n科里奥利参数 $f$ 是纬度 $\\phi$ 的函数，由 $f(\\phi) = 2\\Omega\\sin\\phi$ 给出，其中 $\\Omega$ 是地球的自转角速度。经向坐标 $y$ 是从参考纬度 $\\phi_{0}$ 在半径为 $a$ 的球面上向北的弧长距离。经向距离 $dy$ 和纬度微小变化 $d\\phi$（以弧度为单位）之间的微分关系是：\n$$ dy = a \\, d\\phi $$\n这意味着 $\\frac{d\\phi}{dy} = \\frac{1}{a}$。\n\n为了计算 $\\frac{df}{dy}$，我们使用链式法则，因为 $f$ 是 $\\phi$ 的函数，而 $\\phi$ 又是 $y$ 的函数：\n$$ \\frac{df}{dy} = \\frac{df}{d\\phi} \\frac{d\\phi}{dy} $$\n首先，我们求 $f$ 对 $\\phi$ 的导数：\n$$ \\frac{df}{d\\phi} = \\frac{d}{d\\phi} (2\\Omega\\sin\\phi) = 2\\Omega\\cos\\phi $$\n将此结果和 $\\frac{d\\phi}{dy} = \\frac{1}{a}$ 代入链式法则表达式，得到：\n$$ \\frac{df}{dy} = (2\\Omega\\cos\\phi) \\left(\\frac{1}{a}\\right) = \\frac{2\\Omega\\cos\\phi}{a} $$\n参数 $\\beta$ 是在参考纬度 $\\phi_{0}$ 处计算的这个梯度：\n$$ \\beta = \\left. \\frac{df}{dy} \\right|_{\\phi = \\phi_{0}} = \\frac{2\\Omega\\cos\\phi_{0}}{a} $$\n这就是所求的 $\\beta$ 的解析表达式。\n\n现在，我们使用给定的常数计算 $\\beta$ 的数值：\n参考纬度 $\\phi_{0} = 45^{\\circ}$。\n地球自转速率 $\\Omega = 7.2921 \\times 10^{-5}\\,\\mathrm{s}^{-1}$。\n地球半径 $a = 6.371 \\times 10^{6}\\,\\mathrm{m}$。\n\n参考纬度的余弦值为 $\\cos(45^{\\circ}) = \\frac{\\sqrt{2}}{2}$。\n将这些值代入 $\\beta$ 的表达式中：\n$$ \\beta = \\frac{2 \\times (7.2921 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times \\cos(45^{\\circ})}{6.371 \\times 10^{6}\\,\\mathrm{m}} $$\n$$ \\beta = \\frac{2 \\times (7.2921 \\times 10^{-5}) \\times \\frac{\\sqrt{2}}{2}}{6.371 \\times 10^{6}}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta = \\frac{7.2921 \\times \\sqrt{2} \\times 10^{-5}}{6.371 \\times 10^{6}}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta \\approx \\frac{7.2921 \\times 1.41421356}{6.371} \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta \\approx \\frac{10.31263}{6.371} \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta \\approx 1.618683 \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ \\beta \\approx 1.619 \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n\n至于解释，我们计算每单位经向距离上 $f$ 的分数变化，即比率 $\\frac{\\beta}{f_{0}}$。\n参考纬度处的科里奥利参数是 $f_{0} = 2\\Omega\\sin\\phi_{0}$。\n该比率为：\n$$ \\frac{\\beta}{f_{0}} = \\frac{2\\Omega\\cos\\phi_{0} / a}{2\\Omega\\sin\\phi_{0}} = \\frac{\\cot\\phi_{0}}{a} $$\n在 $\\phi_{0} = 45^{\\circ}$ 处，$\\cot(45^{\\circ}) = 1$。因此，该比率简化为：\n$$ \\frac{\\beta}{f_{0}} = \\frac{1}{a} = \\frac{1}{6.371 \\times 10^{6}\\,\\mathrm{m}} \\approx 1.57 \\times 10^{-7}\\,\\mathrm{m}^{-1} $$\n这个值表示在此纬度，每向北位移一米，科里奥利参数大约变化 $1.57 \\times 10^{-5}\\,\\%$。一个更直观的解释是考虑一个更大的天气尺度距离，例如 $1000\\,\\mathrm{km}$ ($10^6\\,\\mathrm{m}$)。在这个距离上，$f$ 的分数变化为 $(\\frac{\\beta}{f_0}) \\times (10^6\\,\\mathrm{m}) = \\frac{1}{a} \\times (10^6\\,\\mathrm{m}) \\approx 0.157$。这意味着从 $\\phi_{0}=45^{\\circ}$ 向北每位移 $1000\\,\\mathrm{km}$，科里奥利参数大约增加其局地值 $f_0$ 的 $15.7\\%$。这表明行星涡度的经向变化对于大尺度大气和海洋运动是一个显著的效应。",
            "answer": "$$\\boxed{1.619 \\times 10^{-11}}$$"
        },
        {
            "introduction": "斯维尔德鲁普平衡（Sverdrup balance）是 $\\beta$ 平面近似的一个深刻结论，它揭示了风应力旋度与海洋内部经向输送之间的直接联系。本练习要求您应用 $\\beta$ 效应推导这一平衡关系，并针对特定的风场模式求解大尺度海洋环流。掌握这个问题是理解风如何驱动大尺度海洋环流（全球海洋环流最显著的特征之一）的关键。",
            "id": "3788695",
            "problem": "考虑一个在旋转地球上的定常、大尺度海洋环流，其可由一个$\\beta$-平面近似，科里奥利参数为 $f = f_0 + \\beta y$，其中 $\\beta$ 是常数，$f_0$ 是一个常数参考值。假定一个静水、Boussinesq流体，其具有恒定的参考密度 $\\rho_0$，位于一个封闭的矩形盆地中，占据 $0 \\le x \\le L_x$ 和 $0 \\le y \\le L_y$ 的区域。设风应力场为\n$$\n\\tau_x(x,y) = \\tau_0 \\cos\\!\\left(\\frac{\\pi y}{L_y}\\right) \\exp\\!\\left(-\\frac{x}{L_x}\\right), \n\\quad\n\\tau_y(x,y) = \\frac{\\tau_0}{2} \\sin\\!\\left(\\frac{2\\pi x}{L_x}\\right) \\sin\\!\\left(\\frac{\\pi y}{L_y}\\right),\n$$\n其中 $\\tau_0$ 为一个常数振幅。定义垂直积分的输送流函数 $\\psi(x,y)$ 为 $U = -\\partial \\psi/\\partial y$ 和 $V = \\partial \\psi/\\partial x$，其中 $U$ 和 $V$ 分别是纬向和经向的深度积分输送量。\n\n从旋转的原始动量方程和连续性方程出发，利用静水力平衡、地转主导动量平衡，以及与大尺度内部动力学一致的垂直积分，推导出适用于Sverdrup内部的内部涡度平衡方程。利用此平衡关系以及给定的风应力场，求出盆地内各处内部流函数 $\\psi(x,y)$ 的显式闭合表达式。在所有四个边界上施加不可渗透的固壁边界条件，并采用一个与封闭盆地中闭合环流的西边界层相一致的内部边界条件。明确说明你使用的边界条件。\n\n将你的最终答案表示为关于参数 $\\tau_0$、$\\beta$、$\\rho_0$、$L_x$、$L_y$ 以及坐标 $x$ 和 $y$ 的单个解析表达式。不要代入数值。不需要四舍五入。最终答案必须是 $\\psi(x,y)$ 的表达式，且最终表达式中不得包含单位。",
            "solution": "该问题要求推导风生海洋盆地内部的垂直积分输送流函数 $\\psi(x,y)$。求解过程主要分为三个阶段：首先，从原始方程推导 Sverdrup 关系；其次，计算风应力旋度；第三，在适用于内部流的边界条件下，对 Sverdrup 关系进行积分。\n\n**1. Sverdrup 关系的推导**\n\n我们从旋转地球上的 Boussinesq 流体的定常水平动量方程开始，忽略非线性平流和水平摩擦，因为对于大尺度内部流动，这些项很小。\n$$\n-f v = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_{xz}}{\\partial z}\n$$\n$$\nf u = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_{yz}}{\\partial z}\n$$\n此处，$u$ 和 $v$ 分别是纬向（$x$）和经向（$y$）的速度分量。$p$ 是压力，$\\rho_0$ 是恒定的参考密度，$f = f_0 + \\beta y$ 是 $\\beta$-平面近似下的科里奥利参数。$\\tau_{xz}$ 和 $\\tau_{yz}$ 是垂直切应力。\n\n我们将这些方程从海底 $z=-H$ 到海面 $z=0$ 进行垂直积分（近似海面高度 $\\eta \\ll H$）。令 $U = \\int_{-H}^{0} u \\,dz$ 和 $V = \\int_{-H}^{0} v \\,dz$ 为单位长度的纬向和经向体积输送量。对这些方程进行积分得到：\n$$\n-f V = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial x} dz + \\frac{1}{\\rho_0} \\left[ \\tau_{xz} \\right]_{-H}^{0}\n$$\n$$\nf U = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial y} dz + \\frac{1}{\\rho_0} \\left[ \\tau_{yz} \\right]_{-H}^{0}\n$$\n海面（$z=0$）的应力是风应力 $(\\tau_x, \\tau_y)$。海底（$z=-H$）的应力是底摩擦，对于无粘性的 Sverdrup 内部流，此项被忽略。因此，$[\\tau_{xz}]_{-H}^{0} = \\tau_x$ 且 $[\\tau_{yz}]_{-H}^{0} = \\tau_y$。积分后的方程变为：\n$$\n-f V = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial x} + \\frac{\\tau_x}{\\rho_0}\n$$\n$$\nf U = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial y} + \\frac{\\tau_y}{\\rho_0}\n$$\n其中 $P = \\int_{-H}^{0} p \\,dz$ 是垂直积分的压力。\n\n为了消去压力项 $P$，我们对第二个方程求 $\\frac{\\partial}{\\partial x}$，然后减去对第一个方程求 $\\frac{\\partial}{\\partial y}$，从而构成涡度方程：\n$$\n\\frac{\\partial}{\\partial x}(fU) - \\frac{\\partial}{\\partial y}(-fV) = -\\frac{1}{\\rho_0} \\left( \\frac{\\partial^2 P}{\\partial x \\partial y} - \\frac{\\partial^2 P}{\\partial y \\partial x} \\right) + \\frac{1}{\\rho_0} \\left( \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y} \\right)\n$$\n由于混合偏导数的相等性，压力项消失。左侧可以展开为：\n$$\nf\\left(\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y}\\right) + U\\frac{\\partial f}{\\partial x} + V\\frac{\\partial f}{\\partial y} = \\frac{1}{\\rho_0} \\text{curl}_z(\\vec{\\tau})\n$$\n不可压缩流体的垂直积分连续性方程为 $\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = 0$。利用此式，左侧的第一项为零。对于 $\\beta$-平面，$f = f_0 + \\beta y$，因此 $\\frac{\\partial f}{\\partial x} = 0$ 且 $\\frac{\\partial f}{\\partial y} = \\beta$。方程简化为：\n$$\n\\beta V = \\frac{1}{\\rho_0} \\text{curl}_z(\\vec{\\tau})\n$$\n这就是 Sverdrup 关系，它表明海洋内部的经向输送由当地风应力的旋度决定。\n\n**2. 风应力旋度的计算**\n\n风应力矢量由 $\\vec{\\tau} = (\\tau_x, \\tau_y)$ 给出，其分量为：\n$$\n\\tau_x(x,y) = \\tau_0 \\cos\\left(\\frac{\\pi y}{L_y}\\right) \\exp\\left(-\\frac{x}{L_x}\\right)\n$$\n$$\n\\tau_y(x,y) = \\frac{\\tau_0}{2} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) \\sin\\left(\\frac{\\pi y}{L_y}\\right)\n$$\n风应力旋度的垂直分量为 $\\text{curl}_z(\\vec{\\tau}) = \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}$。我们计算其偏导数：\n$$\n\\frac{\\partial \\tau_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\frac{\\tau_0}{2} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\right] = \\frac{\\tau_0}{2} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{2\\pi}{L_x} \\cos\\left(\\frac{2\\pi x}{L_x}\\right) \\right] = \\frac{\\pi \\tau_0}{L_x} \\cos\\left(\\frac{2\\pi x}{L_x}\\right) \\sin\\left(\\frac{\\pi y}{L_y}\\right)\n$$\n$$\n\\frac{\\partial \\tau_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\tau_0 \\cos\\left(\\frac{\\pi y}{L_y}\\right) \\exp\\left(-\\frac{x}{L_x}\\right) \\right] = \\tau_0 \\exp\\left(-\\frac{x}{L_x}\\right) \\left[ -\\frac{\\pi}{L_y} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\right] = -\\frac{\\pi \\tau_0}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) \\sin\\left(\\frac{\\pi y}{L_y}\\right)\n$$\n将它们组合起来，风应力旋度为：\n$$\n\\text{curl}_z(\\vec{\\tau}) = \\frac{\\pi \\tau_0}{L_x} \\cos\\left(\\frac{2\\pi x}{L_x}\\right) \\sin\\left(\\frac{\\pi y}{L_y}\\right) - \\left( -\\frac{\\pi \\tau_0}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\right)\n$$\n$$\n\\text{curl}_z(\\vec{\\tau}) = \\pi \\tau_0 \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{L_x} \\cos\\left(\\frac{2\\pi x}{L_x}\\right) + \\frac{1}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) \\right]\n$$\n\n**3. 流函数 $\\psi(x,y)$ 的积分**\n\n输送流函数 $\\psi(x,y)$ 由 $U = -\\frac{\\partial \\psi}{\\partial y}$ 和 $V = \\frac{\\partial \\psi}{\\partial x}$ 定义。将后者代入 Sverdrup 关系，得到关于 $\\psi$ 的一阶偏微分方程：\n$$\n\\beta \\frac{\\partial \\psi}{\\partial x} = \\frac{1}{\\rho_0} \\text{curl}_z(\\vec{\\tau})\n$$\n$$\n\\frac{\\partial \\psi}{\\partial x} = \\frac{\\pi \\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{L_x} \\cos\\left(\\frac{2\\pi x}{L_x}\\right) + \\frac{1}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) \\right]\n$$\n我们对这个方程关于 $x$ 进行积分：\n$$\n\\psi(x,y) = \\int \\frac{\\partial \\psi}{\\partial x} dx = \\frac{\\pi \\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\int \\left[ \\frac{1}{L_x} \\cos\\left(\\frac{2\\pi x}{L_x}\\right) + \\frac{1}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) \\right] dx\n$$\n执行积分：\n$$\n\\int \\frac{1}{L_x} \\cos\\left(\\frac{2\\pi x}{L_x}\\right) dx = \\frac{1}{L_x} \\frac{L_x}{2\\pi} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) = \\frac{1}{2\\pi} \\sin\\left(\\frac{2\\pi x}{L_x}\\right)\n$$\n$$\n\\int \\frac{1}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) dx = \\frac{1}{L_y} (-L_x) \\exp\\left(-\\frac{x}{L_x}\\right) = -\\frac{L_x}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right)\n$$\n因此，流函数的一般解为：\n$$\n\\psi(x,y) = \\frac{\\pi \\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{2\\pi} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) - \\frac{L_x}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) \\right] + C(y)\n$$\n其中 $C(y)$ 是一个可以依赖于 $y$ 的积分常数。\n\n为了确定 $C(y)$，我们必须应用一个边界条件。对于一个封闭的盆地，环流由一个强的、狭窄的西边界流闭合，在西边界流区域 Sverdrup 平衡不成立。因此，Sverdrup 平衡在整个内部区域都有效，包括东部边界 $x=L_x$。对于一个封闭的盆地，流函数 $\\psi$ 必须沿边界为常数。我们可以将此常数设为零。具体来说，对于内部解，我们施加在东部边界没有流入的条件，这意味着流函数在该处必须为常数。我们设定 $\\psi(L_x,y) = 0$。\n$$\n\\psi(L_x,y) = \\frac{\\pi \\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{2\\pi} \\sin\\left(\\frac{2\\pi L_x}{L_x}\\right) - \\frac{L_x}{L_y} \\exp\\left(-\\frac{L_x}{L_x}\\right) \\right] + C(y) = 0\n$$\n因为 $\\sin(2\\pi)=0$，这简化为：\n$$\n\\frac{\\pi \\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ - \\frac{L_x}{L_y} \\exp(-1) \\right] + C(y) = 0\n$$\n解出 $C(y)$：\n$$\nC(y) = \\frac{\\pi \\tau_0 L_x}{\\beta \\rho_0 L_y} \\exp(-1) \\sin\\left(\\frac{\\pi y}{L_y}\\right)\n$$\n将 $C(y)$ 的这个表达式代回到 $\\psi(x,y)$ 的一般解中：\n$$\n\\psi(x,y) = \\frac{\\pi \\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{2\\pi} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) - \\frac{L_x}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) \\right] + \\frac{\\pi \\tau_0 L_x}{\\beta \\rho_0 L_y} \\exp(-1) \\sin\\left(\\frac{\\pi y}{L_y}\\right)\n$$\n我们可以提取公因式以获得最终表达式：\n$$\n\\psi(x,y) = \\frac{\\pi \\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{2\\pi} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) - \\frac{L_x}{L_y} \\exp\\left(-\\frac{x}{L_x}\\right) + \\frac{L_x}{L_y} \\exp(-1) \\right]\n$$\n$$\n\\psi(x,y) = \\frac{\\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{2} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) + \\frac{\\pi L_x}{L_y} \\left( \\exp(-1) - \\exp\\left(-\\frac{x}{L_x}\\right) \\right) \\right]\n$$\n这就是内部输送流函数 $\\psi(x,y)$ 的显式闭合表达式。",
            "answer": "$$\\boxed{\\frac{\\tau_0}{\\beta \\rho_0} \\sin\\left(\\frac{\\pi y}{L_y}\\right) \\left[ \\frac{1}{2} \\sin\\left(\\frac{2\\pi x}{L_x}\\right) + \\frac{\\pi L_x}{L_y} \\left( \\exp(-1) - \\exp\\left(-\\frac{x}{L_x}\\right) \\right) \\right]}$$"
        },
        {
            "introduction": "斯维尔德鲁普平衡虽然能解释海洋内部的流动，但无法描述像湾流（Gulf Stream）那样封闭环流的强烈而狭窄的边界流。斯托梅尔模型（Stommel model）通过引入海底摩擦来解决此问题，从而为风生环流提供了更完整的图像。本计算练习将指导您实现斯托梅尔方程的数值求解器，模拟完整的海盆环流，并验证质量守恒等基本物理原理。",
            "id": "3788715",
            "problem": "考虑一个传统的β平面上深度恒定的矩形均匀海洋盆地，其中科里奥利参数近似为 $f(y) = f_0 + \\beta y$，$\\beta$为常数。假设存在由表面特定风应力场驱动的稳态、深度积分的正压环流，并伴有线性底拖曳。垂直积分涡度的控制平衡是经典的 Stommel 模型，由关于输送流函数 $\\Psi(x,y)$ 的线性椭圆偏微分方程给出：\n$$\n\\beta \\frac{\\partial \\Psi}{\\partial x} + r \\nabla^2 \\Psi = \\frac{1}{\\rho_0}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right),\n$$\n其中 $\\rho_0$ 是参考海水密度，$r$ 是线性底拖曳系数，$\\tau_x(x,y)$、$\\tau_y(x,y)$ 是风应力矢量的分量。单位宽度的输送速度定义为 $U(x,y) = -\\frac{\\partial \\Psi}{\\partial y}$ 和 $V(x,y) = \\frac{\\partial \\Psi}{\\partial x}$。在所有盆地边界上施加无垂向流边界条件，对于具有输送流函数的单连通域，这通过在整个边界上设置 $\\Psi = 0$ 来实现。\n\n从 f 平面上的深度积分动量方程出发，引入 β 平面近似 $f(y) = f_0 + \\beta y$，通过取旋度的垂直分量、调用主导阶内部流的地转关系并包含线性底拖曳来推导上述 Stommel 方程。然后，在一个均匀的笛卡尔网格上实现 Stommel 方程的数值求解器，对空间导数使用二阶中心有限差分，并对具有狄利克雷边界条件的内部网格点求解稀疏线性系统。\n\n计算出 $\\Psi(x,y)$ 后，评估以下验证指标以检验物理一致性：\n- 输送的离散散度 $D(x,y) = \\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y}$，对于任何可微流函数，该值应恒为零，因此可作为数值质量守恒的检验。报告所有内部网格点上最大绝对值 $\\max|D|$，以 $\\mathrm{m/s}$ 为单位。\n- 内部 Sverdrup 残差 $R_S(x,y) = \\beta \\frac{\\partial \\Psi}{\\partial x} - \\frac{1}{\\rho_0}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right)$，在线性拖曳效应较弱时，该值在远离边界的区域应较小。报告在排除邻近西边界和东边界宽度为 $0.1L_x$、邻近南边界和北边界宽度为 $0.1L_y$ 的缓冲带后的网格点子集上计算的内部平均绝对值 $\\langle |R_S| \\rangle$。此平均残差以 $\\mathrm{m/s^2}$ 为单位表示。\n\n对以下测试案例集进行数值求解并报告这些指标；在所有案例中，使用 $\\rho_0 = 1025\\,\\mathrm{kg/m^3}$ 并采用以下风应力模式：\n- 模式A：$\\tau_x(x,y) = \\tau_0 \\cos\\left(\\pi y / L_y\\right)$ 和 $\\tau_y(x,y) = 0$，给出一个经向变化的纬向风。\n- 模式B：$\\tau_x(x,y) = \\tau_0 \\sin\\left(2\\pi x / L_x\\right)\\cos\\left(\\pi y / L_y\\right)$ 和 $\\tau_y(x,y) = 0$，耦合了纬向和经向的变率。\n\n测试案例：\n1. 盆地尺寸 $L_x = 3.0\\times 10^6\\,\\mathrm{m}$ 和 $L_y = 2.0\\times 10^6\\,\\mathrm{m}$，网格分辨率 $N_x = 128$，$N_y = 96$，$\\beta = 2.0\\times 10^{-11}\\,\\mathrm{m^{-1}\\,s^{-1}}$，$r = 1.0\\times 10^{-6}\\,\\mathrm{s^{-1}}$，风应力振幅 $\\tau_0 = 0.20\\,\\mathrm{N/m^2}$，模式A。\n2. 与案例1相同的盆地和网格，但 $r = 5.0\\times 10^{-8}\\,\\mathrm{s^{-1}}$（较弱的拖曳），模式A。\n3. 盆地尺寸 $L_x = 1.0\\times 10^6\\,\\mathrm{m}$ 和 $L_y = 1.0\\times 10^6\\,\\mathrm{m}$，网格分辨率 $N_x = 64$，$N_y = 64$，$\\beta = 2.0\\times 10^{-11}\\,\\mathrm{m^{-1}\\,s^{-1}}$，$r = 5.0\\times 10^{-6}\\,\\mathrm{s^{-1}}$（较强的拖曳），风应力振幅 $\\tau_0 = 0.15\\,\\mathrm{N/m^2}$，模式B。\n\n对每个测试案例，计算：\n- 指标1：在所有内部点上的 $\\max|D|$，单位为 $\\mathrm{m/s}$。\n- 指标2：在带缓冲的内部子集上的内部平均绝对值 $\\langle |R_S| \\rangle$，单位为 $\\mathrm{m/s^2}$。\n\n您的程序应生成单行输出，其中包含按测试案例顺序排列的六个结果，每个测试案例贡献其两个指标，形式为方括号内以逗号分隔的列表（例如，\"[m1_case1,m2_case1,m1_case2,m2_case2,m1_case3,m2_case3]\"）。这些值必须是浮点数，表示指定单位的量。",
            "solution": "该问题要求推导风驱动海洋环流的 Stommel 模型，并实现一个数值求解器，用以计算输送流函数 $\\Psi$ 以及几个测试案例的相关物理指标。\n\n### Stommel 方程的理论推导\n\n我们从深度为 $H$、参考密度为 $\\rho_0$ 的正压流体的稳态、线性、垂直积分动量方程开始。单位宽度的输送矢量为 $\\mathbf{U} = (U, V)$。控制方程包括科里奥利力、压力梯度力、表面风应力 $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ 和线性底拖曳，具体如下：\n$$\n-fV = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial x} + \\frac{\\tau_x}{\\rho_0 H} - \\frac{r'}{H} U\n$$\n$$\nfU = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial y} + \\frac{\\tau_y}{\\rho_0 H} - \\frac{r'}{H} V\n$$\n这里，$f$ 是科里奥利参数，$P$ 是垂直积分的压力，$r'$ 是一个无量纲的拖曳系数。问题陈述提供了一个简化形式，其中摩擦项和风应力项的表示没有显式地依赖于 $H$。我们采用这样的约定：$U$ 和 $V$ 是单位宽度的输送量（单位为 $\\mathrm{m^2/s}$），方程直接针对这些输送量编写，拖曳系数为 $r$（单位为 $\\mathrm{s^{-1}}$），风应力为 $\\boldsymbol{\\tau}$（单位为 $\\mathrm{N/m^2} = \\mathrm{Pa}$）。压力项对应于海面高度 $\\eta$ 的梯度。动量平衡变为：\n$$\n-fV = -gH \\frac{\\partial \\eta}{\\partial x} + \\frac{\\tau_x}{\\rho_0} - rU \\quad (1)\n$$\n$$\nfU = -gH \\frac{\\partial \\eta}{\\partial y} + \\frac{\\tau_y}{\\rho_0} - rV \\quad (2)\n$$\n为获得涡度平衡，我们取动量方程的旋度的垂直分量。这通过对等式 $(2)$ 关于 $x$ 求导，并减去等式 $(1)$ 关于 $y$ 的导数来实现：\n$$\n\\frac{\\partial}{\\partial x}(fU + rV) - \\frac{\\partial}{\\partial y}(-fV + rU) = \\frac{\\partial}{\\partial x}\\left(\\frac{\\tau_y}{\\rho_0}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{\\tau_x}{\\rho_0}\\right)\n$$\n压力梯度（海面高度）项被消去，因为对于足够平滑的函数 $\\eta$，有 $\\frac{\\partial^2 (-gH\\eta)}{\\partial x \\partial y} - \\frac{\\partial^2 (-gH\\eta)}{\\partial y \\partial x} = 0$。\n\n展开左侧可得：\n$$\nf\\left(\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y}\\right) + U\\frac{\\partial f}{\\partial x} + V\\frac{\\partial f}{\\partial y} + r\\left(\\frac{\\partial V}{\\partial x} - \\frac{\\partial U}{\\partial y}\\right) = \\frac{1}{\\rho_0}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right)\n$$\n我们现在引入两个基本近似：\n1.  **质量守恒**：对于深度恒定的海洋，垂直积分的连续性方程为 $\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = 0$。这意味着存在一个输送流函数 $\\Psi(x,y)$，使得：\n    $$\n    U = -\\frac{\\partial \\Psi}{\\partial y}, \\quad V = \\frac{\\partial \\Psi}{\\partial x}\n    $$\n    因此，涡度方程中的项 $f(\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y})$ 为零。\n2.  **β平面近似**：假设科里奥利参数 $f$ 随经向坐标 $y$ 线性变化，而随纬向坐标 $x$ 保持不变。以参考纬度 $\\phi_0$ 为中心，我们有 $f(y) = f_0 + \\beta y$，其中 $f_0 = 2\\Omega\\sin\\phi_0$ 且 $\\beta = \\frac{df}{dy}|_{\\phi_0} = \\frac{2\\Omega\\cos\\phi_0}{R}$ 是常数（$R$ 是地球半径，$\\Omega$ 是其自转速率）。因此，$\\frac{\\partial f}{\\partial x} = 0$ 且 $\\frac{\\partial f}{\\partial y} = \\beta$。\n\n将这些近似和流函数的定义代入涡度方程：\n-   行星涡度平流项变为 $V\\frac{\\partial f}{\\partial y} = \\beta V = \\beta \\frac{\\partial \\Psi}{\\partial x}$。\n-   底部摩擦项变为拖曳力的旋度，它与输送的相对涡度成正比：$r(\\frac{\\partial V}{\\partial x} - \\frac{\\partial U}{\\partial y}) = r\\left(\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial \\Psi}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(-\\frac{\\partial \\Psi}{\\partial y}\\right)\\right) = r\\left(\\frac{\\partial^2 \\Psi}{\\partial x^2} + \\frac{\\partial^2 \\Psi}{\\partial y^2}\\right) = r \\nabla^2 \\Psi$。\n\n将所有项组合起来，得到关于输送流函数 $\\Psi$ 的线性椭圆偏微分方程——Stommel 方程：\n$$\n\\beta \\frac{\\partial \\Psi}{\\partial x} + r \\nabla^2 \\Psi = \\frac{1}{\\rho_0}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right)\n$$\n此推导是合理的，并确立了问题中提出的控制方程。\n\n### 数值方法\n\nStommel 方程在一个覆盖矩形域 $[0, L_x] \\times [0, L_y]$ 的均匀笛卡尔网格上进行数值求解。该网格在 $x$ 方向上有 $N_x+1$ 个点，在 $y$ 方向上有 $N_y+1$ 个点，间距分别为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。在网格点 $(x_i, y_j) = (i\\Delta x, j\\Delta y)$ 处的流函数值记为 $\\Psi_{i,j}$。\n\n空间导数使用二阶中心有限差分进行近似：\n$$\n\\frac{\\partial \\Psi}{\\partial x}\\bigg|_{i,j} \\approx \\frac{\\Psi_{i+1,j} - \\Psi_{i-1,j}}{2\\Delta x}\n$$\n$$\n\\nabla^2 \\Psi\\bigg|_{i,j} \\approx \\frac{\\Psi_{i+1,j} - 2\\Psi_{i,j} + \\Psi_{i-1,j}}{\\Delta x^2} + \\frac{\\Psi_{i,j+1} - 2\\Psi_{i,j} + \\Psi_{i,j-1}}{\\Delta y^2}\n$$\n将这些近似代入每个内部网格点（$i=1, \\dots, N_x-1$，$j=1, \\dots, N_y-1$）的 Stommel 方程，得到一个线性代数方程组：\n$$\n\\beta \\left(\\frac{\\Psi_{i+1,j} - \\Psi_{i-1,j}}{2\\Delta x}\\right) + r \\left(\\frac{\\Psi_{i+1,j} - 2\\Psi_{i,j} + \\Psi_{i-1,j}}{\\Delta x^2} + \\frac{\\Psi_{i,j+1} - 2\\Psi_{i,j} + \\Psi_{i,j-1}}{\\Delta y^2}\\right) = F_{i,j}\n$$\n其中 $F_{i,j}$ 是在 $(x_i, y_j)$ 处计算的风应力旋度。\n\n该方程可以重排为五点模板形式：\n$$\nC_W \\Psi_{i-1,j} + C_E \\Psi_{i+1,j} + C_S \\Psi_{i,j-1} + C_N \\Psi_{i,j+1} + C_C \\Psi_{i,j} = F_{i,j}\n$$\n系数如下：\n$$\nC_W = \\frac{r}{\\Delta x^2} - \\frac{\\beta}{2\\Delta x}, \\quad C_E = \\frac{r}{\\Delta x^2} + \\frac{\\beta}{2\\Delta x}\n$$\n$$\nC_S = \\frac{r}{\\Delta y^2}, \\quad C_N = \\frac{r}{\\Delta y^2}\n$$\n$$\nC_C = -2r\\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2}\\right)\n$$\n问题指定了在所有边界上 $\\Psi=0$ 的狄利克雷边界条件。这简化了系统，因为任何 $i$ 或 $j$ 落在边界上的项 $\\Psi_{i,j}$ 都已知为零。$(N_x-1) \\times (N_y-1)$ 个未知的内部 $\\Psi$ 值被组织成一个单一的解向量 $\\boldsymbol{\\psi}$。这导致了一个形如 $A\\boldsymbol{\\psi} = \\mathbf{b}$ 的大型稀疏线性系统，其中 $A$ 是系数矩阵，$\\mathbf{b}$ 是风应力旋度值 $F_{i,j}$ 的向量。该系统使用稀疏线性代数求解器进行高效求解。\n\n### 验证指标\n\n在获得 $\\Psi$ 的解之后，计算两个指标。\n\n1.  **最大绝对离散散度 ($\\max|D|$)**：\n    输送场的散度为 $D = \\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y}$。代入流函数定义 $U = -\\partial\\Psi/\\partial y$ 和 $V = \\partial\\Psi/\\partial x$，我们得到 $D = -\\frac{\\partial^2\\Psi}{\\partial x \\partial y} + \\frac{\\partial^2\\Psi}{\\partial y \\partial x}$。对于任何二次连续可微的函数 $\\Psi$，根据关于混合偏导数相等的 Clairaut 定理，该值恒为零。\n    在数值上，如果我们对所有导数一致地使用二阶中心差分，由于项的抵消，离散散度也恒为零。\n    $$\n    U_{i,j} = -\\frac{\\Psi_{i,j+1} - \\Psi_{i,j-1}}{2\\Delta y}, \\quad V_{i,j} = \\frac{\\Psi_{i+1,j} - \\Psi_{i-1,j}}{2\\Delta x}\n    $$\n    $$\n    D_{i,j} = \\frac{U_{i+1,j} - U_{i-1,j}}{2\\Delta x} + \\frac{V_{i,j+1} - V_{i,j-1}}{2\\Delta y} = 0\n    $$\n    该指标的计算可作为所选有限差分格式的代数自洽性验证。任何非零结果都应在机器浮点精度误差的量级。该值以 $\\mathrm{m/s}$ 报告。\n\n2.  **内部平均绝对 Sverdrup 残差 ($\\langle |R_S| \\rangle$)**：\n    Sverdrup 平衡，即 $\\beta V = \\text{curl}_z(\\boldsymbol{\\tau})/\\rho_0$，是在远离边界、摩擦可忽略的海洋内部区域的主导平衡。Sverdrup 残差 $R_S$ 量化了对这种平衡的偏离。其定义为：\n    $$\n    R_S = \\beta \\frac{\\partial \\Psi}{\\partial x} - \\frac{1}{\\rho_0}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right)\n    $$\n    从完整的 Stommel 方程可以看出，$R_S = -r\\nabla^2\\Psi$。这个残差在海洋内部预计会很小，而在摩擦项 $r\\nabla^2\\Psi$ 显著的边界层中会很大。我们计算它在一个内部区域的平均绝对值，该区域排除了距纬向边界宽度为 $0.1 L_x$ 和距经向边界宽度为 $0.1 L_y$ 的缓冲带。这提供了一个衡量内部流在多大程度上由 Sverdrup 动力学控制的度量。该值以 $\\mathrm{m/s^2}$ 报告。\n\n以下 Python 代码实现了此数值过程，用以解决三个指定的测试案例并报告所需的指标。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csc_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run the Stommel model for all specified test cases\n    and print the formatted results.\n    \"\"\"\n    rho0 = 1025.0  # kg/m^3\n\n    # (Lx, Ly, Nx, Ny, beta, r, tau0, pattern)\n    test_cases = [\n        (3.0e6, 2.0e6, 128, 96, 2.0e-11, 1.0e-6, 0.20, 'A'),\n        (3.0e6, 2.0e6, 128, 96, 2.0e-11, 5.0e-8, 0.20, 'A'),\n        (1.0e6, 1.0e6, 64, 64, 2.0e-11, 5.0e-6, 0.15, 'B'),\n    ]\n\n    results = []\n    for Lx, Ly, Nx, Ny, beta, r, tau0, pattern in test_cases:\n        m1, m2 = solve_stommel_case(Lx, Ly, Nx, Ny, beta, r, tau0, rho0, pattern)\n        results.extend([m1, m2])\n\n    print(f\"[{','.join(f'{val:.6e}' for val in results)}]\")\n\ndef solve_stommel_case(Lx, Ly, Nx, Ny, beta, r, tau0, rho0, pattern):\n    \"\"\"\n    Solves the Stommel equation for a single test case and computes metrics.\n    \n    Returns:\n        tuple: (max_abs_divergence, mean_abs_sverdrup_residual)\n    \"\"\"\n    dx = Lx / Nx\n    dy = Ly / Ny\n\n    # Grid for interior points (1..Nx-1, 1..Ny-1)\n    x_int = np.linspace(dx, Lx - dx, Nx - 1)\n    y_int = np.linspace(dy, Ly - dy, Ny - 1)\n    X_int, Y_int = np.meshgrid(x_int, y_int)\n\n    # Calculate wind stress curl (forcing term F)\n    if pattern == 'A':\n        F = (tau0 * np.pi / (rho0 * Ly)) * np.sin(np.pi * Y_int / Ly)\n    elif pattern == 'B':\n        F = (tau0 * np.pi / (rho0 * Ly)) * np.sin(2 * np.pi * X_int / Lx) * np.sin(np.pi * Y_int / Ly)\n    else:\n        raise ValueError(\"Unknown wind stress pattern\")\n\n    # Assemble the sparse matrix A for the linear system A*psi = b\n    num_unknowns = (Nx - 1) * (Ny - 1)\n    A = lil_matrix((num_unknowns, num_unknowns))\n    b = F.flatten()\n\n    c_w = r / dx**2 - beta / (2 * dx)\n    c_e = r / dx**2 + beta / (2 * dx)\n    c_s = r / dy**2\n    c_n = r / dy**2\n    c_c = -2 * r * (1 / dx**2 + 1 / dy**2)\n\n    for j in range(Ny - 1):      # Corresponds to y-indices 1..Ny-1\n        for i in range(Nx - 1):  # Corresponds to x-indices 1..Nx-1\n            k = j * (Nx - 1) + i  # Flattened index\n            \n            A[k, k] = c_c\n            \n            if i > 0:\n                A[k, k - 1] = c_w # West\n            if i  Nx - 2:\n                A[k, k + 1] = c_e # East\n            if j > 0:\n                A[k, k - (Nx - 1)] = c_s # South\n            if j  Ny - 2:\n                A[k, k + (Nx - 1)] = c_n # North\n\n    # Solve the system\n    A_csc = csc_matrix(A)\n    psi_flat = spsolve(A_csc, b)\n    psi_int = psi_flat.reshape((Ny - 1, Nx - 1))\n\n    # Embed solution in a full grid with zero boundaries\n    Psi = np.zeros((Ny + 1, Nx + 1))\n    Psi[1:Ny, 1:Nx] = psi_int\n\n    # --- Metric 1: Max absolute discrete divergence ---\n    # Centered-difference divergence is algebraically zero.\n    # U = -dPsi/dy, V = dPsi/dx\n    # D = dU/dx + dV/dy\n    # We calculate it to verify it's close to machine epsilon.\n    U = np.zeros_like(psi_int)\n    V = np.zeros_like(psi_int)\n    \n    # Calculate U and V on interior points\n    U = -(Psi[2:Ny+1, 1:Nx] - Psi[0:Ny-1, 1:Nx]) / (2 * dy)\n    V = (Psi[1:Ny, 2:Nx+1] - Psi[1:Ny, 0:Nx-1]) / (2 * dx)\n\n    # Calculate divergence D\n    # We need a smaller grid for D as its stencil accesses neighbors of U and V.\n    D = np.zeros((Ny - 3, Nx - 3))\n    # U is (Ny-1, Nx-1), V is (Ny-1, Nx-1)\n    # D is defined on grid points (i, j) where i=[2..Nx-2], j=[2..Ny-2]\n    dUdx = (U[1:-1, 2:] - U[1:-1, :-2]) / (2 * dx)\n    dVdy = (V[2:, 1:-1] - V[:-2, 1:-1]) / (2 * dy)\n    D = dUdx + dVdy\n    max_abs_D = np.max(np.abs(D)) if D.size > 0 else 0.0\n\n    # --- Metric 2: Interior mean absolute Sverdrup residual ---\n    # Rs = beta * dPsi/dx - F\n    dPsidx_int = (Psi[1:Ny, 2:Nx+1] - Psi[1:Ny, 0:Nx-1]) / (2 * dx)\n    Rs = beta * dPsidx_int - F\n\n    # Define the averaging region (excluding 0.1 buffers)\n    i_min = int(np.ceil(0.1 * Nx))\n    i_max = int(np.floor(0.9 * Nx))\n    j_min = int(np.ceil(0.1 * Ny))\n    j_max = int(np.floor(0.9 * Ny))\n\n    # Slice the Rs array. Note that Rs is on interior grid (indices 1..Nx-1, 1..Ny-1)\n    # The Rs array is indexed 0..Nx-2 and 0..Ny-2.\n    # Full grid index i maps to Rs index i-1.\n    Rs_subset = Rs[j_min-1:j_max, i_min-1:i_max]\n    \n    mean_abs_Rs = np.mean(np.abs(Rs_subset)) if Rs_subset.size > 0 else 0.0\n\n    return max_abs_D, mean_abs_Rs\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}