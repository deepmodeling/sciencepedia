{
    "hands_on_practices": [
        {
            "introduction": "掌握拉格朗日和欧拉描述的第一个关键技能，是将固定的欧拉速度场转化为运动的拉格朗日粒子轨迹。这个练习提供了一个清晰的解析范例，演示了如何在简单的旋转流场中完成这一转化。通过求解描述粒子运动的常微分方程，我们可以精确地描绘出其路径，为理解更复杂的流动场景奠定基础。",
            "id": "1769254",
            "problem": "在一个微流控装置中，建立了一个稳定的二维流体场来产生一个微型涡旋。该流场在 $xy$-平面内的欧拉速度场由 $\\boldsymbol{v}(x, y) = -\\Omega y \\hat{\\mathbf{i}} + \\Omega x \\hat{\\mathbf{j}}$ 给出，其中 $\\Omega$ 是一个正常数，代表流体类刚体旋转的角频率，$\\hat{\\mathbf{i}}$ 和 $\\hat{\\mathbf{j}}$ 分别是 $x$ 和 $y$ 方向的单位向量。一个小的、中性悬浮的粒子被释放到这个流场中，并被假定为一个被动示踪剂，这意味着它的速度总是与当地的流体速度相同。在时间 $t=0$ 时，该粒子位于初始位置 $(x_0, y_0) = (L, 0)$，其中 $L$ 是一个正常数。\n\n确定该粒子的拉格朗日位置，由其坐标 $(x(t), y(t))$ 给出，对于任意时间 $t \\geq 0$。将您的答案表示为关于 $L$、$\\Omega$ 和 $t$ 的函数对 $x(t)$ 和 $y(t)$。",
            "solution": "因为粒子是一个被动示踪剂，其速度等于当地的流体速度。因此，其拉格朗日坐标满足方程组\n$$\\frac{dx}{dt}=-\\Omega y,\\qquad \\frac{dy}{dt}=\\Omega x,$$\n初始条件为 $x(0)=L$ 和 $y(0)=0$。\n\n对第一个方程关于 $t$ 求导，并使用第二个方程消去 $y$：\n$$\\frac{d^{2}x}{dt^{2}}=-\\Omega \\frac{dy}{dt}=-\\Omega(\\Omega x)=-\\Omega^{2}x.$$\n这是一个谐振子方程，其通解为\n$$x(t)=A\\cos(\\Omega t)+B\\sin(\\Omega t).$$\n应用 $x(0)=L$ 可得 $A=L$。接下来，计算 $\\frac{dx}{dt}$：\n$$\\frac{dx}{dt}=-A\\Omega \\sin(\\Omega t)+B\\Omega \\cos(\\Omega t).$$\n使用 $\\frac{dx}{dt}=-\\Omega y$ 和 $y(0)=0$ 得到 $\\frac{dx}{dt}\\big|_{t=0}=0$，因此\n$$0=\\frac{dx}{dt}\\big|_{t=0}=B\\Omega \\quad \\Rightarrow \\quad B=0.$$\n所以，\n$$x(t)=L\\cos(\\Omega t).$$\n由 $\\frac{dy}{dt}=\\Omega x$ 和 $y(0)=0$ 可得，\n$$y(t)=\\int_{0}^{t}\\Omega x(s)\\,ds=\\int_{0}^{t}\\Omega L\\cos(\\Omega s)\\,ds=L\\sin(\\Omega t).$$\n直接检验表明 $\\frac{dx}{dt}=-\\Omega y$ 和 $\\frac{dy}{dt}=\\Omega x$ 均被满足，因此解是一致的。\n\n因此，拉格朗日位置是 $\\big(x(t),y(t)\\big)=\\big(L\\cos(\\Omega t),\\,L\\sin(\\Omega t)\\big)$。",
            "answer": "$$\\boxed{\\begin{pmatrix}L\\cos(\\Omega t)  L\\sin(\\Omega t)\\end{pmatrix}}$$"
        },
        {
            "introduction": "在稳定流中，路径线、流线和迹线是重合的，但在真实海洋中常见的非稳定流中，这三者则会产生显著差异。本练习通过分析一个时变流场，旨在厘清这三种流动可视化工具之间的关键概念区别。准确理解这些差异对于正确解读海洋观测数据和数值模型输出至关重要。",
            "id": "3796714",
            "problem": "考虑一个二维、水平均匀但随时间变化的海洋表面流，在欧拉框架下，其速度场由 $\\boldsymbol{u}(x,y,t) = \\left(U_0 + U_1 \\sin(\\omega t)\\right)\\,\\hat{\\mathbf{i}}$ 描述，其中 $U_0$、$U_1$ 和 $\\omega$ 为正常数，且满足 $U_0  |U_1|$ 以确保流向在任何时候都保持在下游方向（$+ \\hat{\\mathbf{i}}$）。从时间 $t=0$ 开始，一个位于原点 $(x,y)=(0,0)$ 的点源持续释放一种被动染料。在整个过程中，假设表面流是不可压缩、无散度的，并忽略垂直运动。\n\n仅使用基本运动学以及流体力学中拉格朗日和欧拉描述的定义，完成以下任务：\n\n1) 从迹线作为单个流体单元的拉格朗日轨迹的定义出发，该轨迹满足常微分方程 (ODEs) $dx/dt = u(x(t),y(t),t)$ 和 $dy/dt = v(x(t),y(t),t)$ 以及初始条件 $x(t_0)=x_0$ 和 $y(t_0)=y_0$，推导出一个在时间 $t_0$ 位于 $(x_0,y_0)$ 的粒子其迹线 $(x(t),y(t))$ 的解析表达式。\n\n2) 使用固定时间 $t^{\\ast}$ 的流线的定义，即处处与瞬时速度场相切的曲线，满足 $dy/dx = v(x,y,t^{\\ast})/u(x,y,t^{\\ast})$，推导出在时间 $t^{\\ast}$ 经过一个通用点 $(x^{\\ast},y^{\\ast})$ 的流线方程。\n\n3) 使用在时间 $t=T$ 的脉线的定义，即所有在某个释放时间 $\\tau \\in [0,T]$ 曾经过源点 $(0,0)$ 的流体质点的轨迹集合，推导出时间 $T$ 时脉线的参数表示（以释放时间 $\\tau$ 为参数）。然后，利用假设 $U_0  |U_1|$，确定哪个释放时间 $\\tau$ 会产生脉线的最下游点，并推导出时间 $T$ 时脉线下游延伸范围的显式闭式表达式。\n\n4) 简要但严谨地讨论该流动的迹线、流线（在固定时间）和脉线之间的异同点，强调哪些方面是相同的，哪些方面取决于流的时间变化性。\n\n最后，以 $U_0$、$U_1$、$\\omega$ 和 $T$ 的形式给出第3部分推导出的下游延伸范围的单一闭式表达式。由于 $U_0$ 和 $U_1$ 是以米/秒为单位的速度，$\\omega$ 是以弧度/秒为单位的角速度，而 $T$ 是以秒为单位的时间，因此下游延伸范围的单位是米。以 $U_0$、$U_1$、$\\omega$ 和 $T$ 的符号形式表示最终结果；不要在你的方框最终答案中附加单位。",
            "solution": "该问题描述了一个二维、随时间变化但空间均匀的海洋表面流。欧拉速度场由 $\\boldsymbol{u}(x,y,t) = \\left(U_0 + U_1 \\sin(\\omega t)\\right)\\,\\hat{\\mathbf{i}}$ 给出，其分量为 $u(x,y,t) = U_0 + U_1 \\sin(\\omega t)$ 和 $v(x,y,t) = 0$。常数 $U_0$、$U_1$ 和 $\\omega$ 均为正，且条件 $U_0  U_1$ 确保流动始终沿正 $\\hat{\\mathbf{i}}$ 方向。\n\n1) 迹线，记为 $(x(t), y(t))$，是单个流体质点的轨迹。它通过对速度场随时间积分来确定，并满足初始条件 $(x(t_0), y(t_0)) = (x_0, y_0)$。控制常微分方程为：\n$$\n\\frac{dx}{dt} = u(x(t), y(t), t) = U_0 + U_1 \\sin(\\omega t)\n$$\n$$\n\\frac{dy}{dt} = v(x(t), y(t), t) = 0\n$$\n我们对 $y$ 分量的方程从初始时间 $t_0$ 积分到任意时间 $t$：\n$$\n\\int_{y_0}^{y(t)} dy' = \\int_{t_0}^{t} 0 \\, dt' \\implies y(t) - y_0 = 0 \\implies y(t) = y_0\n$$\n这个结果表明，质点的运动被限制在其起始的水平线上。\n接下来，我们对 $x$ 分量的方程从 $t_0$ 积分到 $t$：\n$$\n\\int_{x_0}^{x(t)} dx' = \\int_{t_0}^{t} \\left( U_0 + U_1 \\sin(\\omega t') \\right) \\, dt'\n$$\n$$\nx(t) - x_0 = \\int_{t_0}^{t} U_0 \\, dt' + \\int_{t_0}^{t} U_1 \\sin(\\omega t') \\, dt'\n$$\n$$\nx(t) - x_0 = U_0 [t']_{t_0}^{t} + U_1 \\left[ -\\frac{1}{\\omega}\\cos(\\omega t') \\right]_{t_0}^{t}\n$$\n$$\nx(t) - x_0 = U_0(t - t_0) - \\frac{U_1}{\\omega} \\left( \\cos(\\omega t) - \\cos(\\omega t_0) \\right)\n$$\n因此，质点 x 坐标的解析表达式为：\n$$\nx(t) = x_0 + U_0(t - t_0) - \\frac{U_1}{\\omega}(\\cos(\\omega t) - \\cos(\\omega t_0))\n$$\n完整的迹线由数对 $(x(t), y(t))$ 给出。\n\n2) 流线是在固定时间 $t^{\\ast}$ 处处与瞬时速度场相切的曲线。其在 $(x,y)$ 平面上的斜率由以下微分方程定义：\n$$\n\\frac{dy}{dx} = \\frac{v(x,y,t^{\\ast})}{u(x,y,t^{\\ast})}\n$$\n在固定时间 $t^{\\ast}$，速度分量为 $u(x,y,t^{\\ast}) = U_0 + U_1 \\sin(\\omega t^{\\ast})$ 和 $v(x,y,t^{\\ast}) = 0$。将它们代入方程得到：\n$$\n\\frac{dy}{dx} = \\frac{0}{U_0 + U_1 \\sin(\\omega t^{\\ast})}\n$$\n条件 $U_0  U_1$ 确保分母 $U_0 + U_1 \\sin(\\omega t^{\\ast})$ 始终为正，因为其最小值为 $U_0 - U_1  0$。因此，流线的斜率始终为零：\n$$\n\\frac{dy}{dx} = 0\n$$\n对此方程积分得到 $y = C$，其中 $C$ 是一个常数。对于通过点 $(x^{\\ast}, y^{\\ast})$ 的流线，常数必须是 $C = y^{\\ast}$。因此，流线的方程为：\n$$\ny = y^{\\ast}\n$$\n这表明，对于该流动，任何时刻的流线都是一族水平线。\n\n3) 在时间 $T$ 的脉线是所有在某个先前的释放时间 $\\tau$（其中 $0 \\le \\tau \\le T$）经过一个特定点——在本例中是位于原点 $(0,0)$ 的源——的流体质点的位置集合。为了找到脉线，我们考虑一个从 $(x_0, y_0) = (0,0)$ 在时间 $t_0=\\tau$ 释放的质点，并确定其在观测时间 $t=T$ 的位置 $(x,y)$。我们使用第(1)部分中推导出的迹线方程以及这些特定参数。\n任何这样一个质点在时间 $T$ 的 y 坐标为 $y(T) = y_0 = 0$。\nx 坐标通过在迹线方程 $x(t)$ 中设置 $x_0=0$、$t_0=\\tau$ 和 $t=T$ 来找到：\n$$\nx(T; \\tau) = 0 + U_0(T - \\tau) - \\frac{U_1}{\\omega}(\\cos(\\omega T) - \\cos(\\omega \\tau))\n$$\n为了清晰起见，重新整理后，我们得到时间 $T$ 时脉线 x 坐标的参数表示，参数为 $\\tau$：\n$$\nx_{\\text{streak}}(T; \\tau) = U_0(T - \\tau) + \\frac{U_1}{\\omega}(\\cos(\\omega \\tau) - \\cos(\\omega T))\n$$\n脉线本身位于 x 轴上，从原点（$\\tau=T$ 时刚释放的质点）延伸到对应于 $\\tau=0$ 时释放的质点的点。\n为了找到最下游的点，我们必须求出当 $\\tau \\in [0, T]$ 时 $x_{\\text{streak}}(T; \\tau)$ 的最大值。我们将 $x_{\\text{streak}}(T; \\tau)$ 对 $\\tau$ 求导：\n$$\n\\frac{d}{d\\tau}x_{\\text{streak}}(T; \\tau) = -U_0 - U_1 \\sin(\\omega \\tau)\n$$\n为了找到临界点，我们会将此导数设为零，即 $\\sin(\\omega \\tau) = -\\frac{U_0}{U_1}$。然而，给定的约束 $U_0  U_1  0$ 意味着 $-\\frac{U_0}{U_1}  -1$。正弦函数不能取此值，因此在定义域内部没有临界点。因此，最大值必须出现在区间 $\\tau \\in [0, T]$ 的边界之一，即在 $\\tau=0$ 或 $\\tau=T$ 处。\n我们可以检查导数的符号。由于 $-1 \\le \\sin(\\omega \\tau) \\le 1$，项 $-U_1 \\sin(\\omega \\tau)$ 位于 $[-U_1, U_1]$ 区间内。因此导数是有界的：$\\frac{d}{d\\tau}x_{\\text{streak}}(T; \\tau) \\le -U_0 + U_1$。由于 $U_0  U_1$，$-U_0 + U_1$ 这个量是负的。因此，对于所有的 $\\tau$ 值，都有 $\\frac{d}{d\\tau}x_{\\text{streak}}(T; \\tau)  0$。\n这意味着 $x_{\\text{streak}}(T; \\tau)$ 是关于 $\\tau$ 的严格递减函数。最大值必须在 $\\tau$ 的最小值处取得，即 $\\tau=0$。物理上，这对应于最早释放、运动时间最长的那个质点。下游延伸范围就是这个最大的 x 值：\n$$\nx_{\\text{max}} = x_{\\text{streak}}(T; 0) = U_0(T - 0) + \\frac{U_1}{\\omega}(\\cos(\\omega \\cdot 0) - \\cos(\\omega T))\n$$\n$$\nx_{\\text{max}} = U_0 T + \\frac{U_1}{\\omega}(1 - \\cos(\\omega T))\n$$\n这就是所要求的脉线下游延伸范围的闭式表达式。\n\n4) 对于这个特定的单向但非定常流动，迹线、流线和脉线之间的关系如下：\n- **相似之处**：这三种曲线在几何上是相同的：它们都是水平直线。这是速度场是单向（始终在 $+\\hat{\\mathbf{i}}$ 方向）的直接结果。流线是一条 $y = \\text{常数}$ 的线。迹线是这样一条线的一段。来自点源的脉线也是这样一条线的一段。\n- **不同之处**：主要的区别是概念上的，源于流动的非定常性（$U_1 \\neq 0$）。\n  - **流线**是流动方向的瞬时‘地图’。在这里，无论时间 $t^{\\ast}$ 如何，它始终是一条水平线。\n  - **迹线**是单个质点运动的积分历史。虽然路径是直线，但质点沿其运动的速度 $u(t) = U_0 + U_1 \\sin(\\omega t)$ 随时间变化。\n  - **脉线**是一组具有不同历史的质点的瞬时快照。在时间 $T$，它显示了所有在 $0 \\le \\tau \\le T$ 时间段内从源点释放的质点的位置。如第(3)部分所求，脉线的长度取决于时间积分的流动历史，并且不是时间的简单线性函数。\n  - 如果流动是定常的（$U_1=0$），速度将是一个常数 $U_0\\,\\hat{\\mathbf{i}}$。在这种情况下，迹线、流线和脉线将完全相同。即使在这种特殊情况下它们具有简单的几何形状，非定常性也是使它们成为不同概念的原因。",
            "answer": "$$\n\\boxed{U_0 T + \\frac{U_1}{\\omega}(1 - \\cos(\\omega T))}\n$$"
        },
        {
            "introduction": "真实海洋的流场通常非常复杂，无法通过解析方法求解粒子轨迹，因此数值积分成为计算海洋学中的核心工具。本练习将带领我们进入计算实践的核心：使用经典的四阶龙格-库塔（RK4）方法来近似计算粒子在时变涡旋中的轨迹。更重要的是，我们将通过与精确解的比较来量化该数值方法的局部截断误差，这是评估和验证拉格朗日模型精度的关键一步。",
            "id": "3796715",
            "problem": "考虑一个二维拉格朗日粒子轨迹，其运动由常微分方程 $\\dot{\\boldsymbol{X}}=\\boldsymbol{u}(\\boldsymbol{X},t)$ 控制，其中 $\\boldsymbol{X}(t)\\in\\mathbb{R}^2$ 表示粒子位置，$\\boldsymbol{u}(\\boldsymbol{x},t)$ 是欧拉速度场。目标是构建一个数值积分器，并从第一性原理分析其局部截断误差。从拉格朗日和欧拉流动描述的核心定义，以及单步法的局部截断误差定义开始。仅使用基本定律 $\\dot{\\boldsymbol{X}}=\\boldsymbol{u}(\\boldsymbol{X},t)$、时间步长 $h0$ 的定义，以及围绕点 $(\\boldsymbol{X}(t_0),t_0)$ 的泰勒级数展开。\n\n您必须实现一个经典的四阶龙格-库塔 (RK) 格式，用于单个时间步长，通过在中间阶段点上对 $\\boldsymbol{u}$ 进行求值，将 $\\boldsymbol{X}(t_0)$推进到 $\\boldsymbol{X}(t_0+h)$ 的一个近似值。然后，您必须计算此单步的局部截断误差，即对于一个给定的随时间变化的中尺度速度场，数值单步更新与精确单步解之间差值的欧几里得范数（以米为单位）。\n\n使用以下科学上真实的、随时间变化的中尺度涡旋场，该场由时变角速度定义：\n- 速度场为 $\\boldsymbol{u}(\\boldsymbol{x},t)=\\Omega(t)\\,(-y,x)$，其中 $\\boldsymbol{x}=(x,y)$。\n- 角速度为 $\\Omega(t)=\\Omega_0+\\Omega_1\\sin(\\sigma t)$。\n- 所有角度必须以弧度为单位。\n\n在此场下，从 $(\\boldsymbol{X}(t_0),t_0)$ 到时间 $t_0+h$ 的精确单步解是初始位置旋转一个角度，该角度等于 $\\Omega(t)$ 在区间 $[t_0,t_0+h]$ 上的时间积分。您必须使用此性质来计算精确的单步位置，并由此计算局部截断误差。\n\n物理和数值单位：\n- 位置必须以米 (m) 为单位。\n- 时间必须以秒 (s) 为单位。\n- 所有输出均以米 (m) 表示，通过正常的浮点表示法进行舍入。角度以弧度为单位。\n\n测试套件：\n实现您的程序以计算以下四个测试用例的结果。每个用例都指定了 $(\\Omega_0,\\Omega_1,\\sigma)$、初始条件 $\\boldsymbol{X}_0$、初始时间 $t_0$ 和步长 $h$。对于收敛性用例，您必须计算两个步长下局部截断误差的比率。\n\n- 用例 $1$（通用、时变涡旋；“理想路径”）：\n  - $\\Omega_0=1.2\\times 10^{-5}\\ \\text{s}^{-1}$，$\\Omega_1=4.0\\times 10^{-6}\\ \\text{s}^{-1}$，$\\sigma=\\dfrac{2\\pi}{5\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\boldsymbol{X}_0=(5.0\\times 10^{4},-2.5\\times 10^{4})\\ \\text{m}$。\n  - $t_0=0\\ \\text{s}$。\n  - $h=3600\\ \\text{s}$。\n  - 以浮点数形式输出局部截断误差（单位：米）。\n\n- 用例 $2$（通过误差比率观察阶数）：\n  - $\\Omega_0=9.5\\times 10^{-6}\\ \\text{s}^{-1}$，$\\Omega_1=3.5\\times 10^{-6}\\ \\text{s}^{-1}$，$\\sigma=\\dfrac{2\\pi}{3\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\boldsymbol{X}_0=(8.0\\times 10^{4},3.0\\times 10^{4})\\ \\text{m}$。\n  - $t_0=2\\times 86400\\ \\text{s}$。\n  - 计算在 $h=7200\\ \\text{s}$ 和 $h/2=3600\\ \\text{s}$ 时的局部截断误差，并以浮点数（无单位）形式输出比率 $E(h)/E(h/2)$。对于四阶格式的局部截断误差行为，该比率应接近 $2^{5}$。\n\n- 用例 $3$（边界条件：零初始位置）：\n  - $\\Omega_0=1.0\\times 10^{-5}\\ \\text{s}^{-1}$，$\\Omega_1=6.0\\times 10^{-6}\\ \\text{s}^{-1}$，$\\sigma=\\dfrac{2\\pi}{7\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\boldsymbol{X}_0=(0,0)\\ \\text{m}$。\n  - $t_0=1\\times 86400\\ \\text{s}$。\n  - $h=3600\\ \\text{s}$。\n  - 以浮点数形式输出局部截断误差（单位：米）。由于原点处流动的对称性，理论上该值应精确为 $0$。\n\n- 用例 $4$（边缘情况：快速变化的角速度）：\n  - $\\Omega_0=1.0\\times 10^{-5}\\ \\text{s}^{-1}$，$\\Omega_1=1.0\\times 10^{-5}\\ \\text{s}^{-1}$，$\\sigma=\\dfrac{2\\pi}{0.5\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\boldsymbol{X}_0=(2.0\\times 10^{4},2.0\\times 10^{4})\\ \\text{m}$。\n  - $t_0=0.25\\times 86400\\ \\text{s}$。\n  - $h=1800\\ \\text{s}$。\n  - 以浮点数形式输出局部截断误差（单位：米）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$），其中各项分别对应于用例 $1$ 到 $4$。不应打印任何其他文本。",
            "solution": "我们从拉格朗日运动描述开始，其中流体质点的轨迹 $\\boldsymbol{X}(t)$ 满足 $\\dot{\\boldsymbol{X}}(t)=\\boldsymbol{u}(\\boldsymbol{X}(t),t)$。欧拉速度场 $\\boldsymbol{u}(\\boldsymbol{x},t)$ 给出固定位置和时间点的速度。数值任务是使用单步法从 $\\boldsymbol{X}(t_0)$ 近似计算 $\\boldsymbol{X}(t_0+h)$，并评估局部截断误差。局部截断误差定义为从相同初始数据出发，经过一步后数值更新与精确解之间的差异。\n\n基于原理的经典四阶龙格-库塔 (RK) 单步法的推导是通过匹配初值问题 $\\dot{\\boldsymbol{X}}=\\boldsymbol{u}(\\boldsymbol{X},t)$，$\\boldsymbol{X}(t_0)=\\boldsymbol{X}_0$ 精确解的泰勒级数来进行的。设 $h0$ 为步长，展开精确解：\n$$\n\\boldsymbol{X}(t_0+h) = \\boldsymbol{X}_0 + h\\,\\dot{\\boldsymbol{X}}_0 + \\frac{h^2}{2}\\,\\ddot{\\boldsymbol{X}}_0 + \\frac{h^3}{6}\\,\\boldsymbol{X}^{(3)}_0 + \\frac{h^4}{24}\\,\\boldsymbol{X}^{(4)}_0 + \\mathcal{O}(h^5),\n$$\n其中导数在 $t_0$ 处求值。使用 $\\dot{\\boldsymbol{X}}=\\boldsymbol{u}(\\boldsymbol{X},t)$ 和链式法则，\n$$\n\\ddot{\\boldsymbol{X}} = \\frac{d}{dt}\\boldsymbol{u}(\\boldsymbol{X},t) = \\partial_t \\boldsymbol{u} + (\\nabla_{\\boldsymbol{X}}\\boldsymbol{u})\\,\\dot{\\boldsymbol{X}} = \\partial_t \\boldsymbol{u} + (\\nabla_{\\boldsymbol{X}}\\boldsymbol{u})\\,\\boldsymbol{u},\n$$\n更高阶的导数可以类似地用 $\\boldsymbol{u}$ 的时间导数和空间导数与 $\\boldsymbol{X}(t)$ 的复合函数来表示。\n\n龙格-库塔方法通过在中间阶段对速度进行加权组合求值来构造一个近似解，这些中间阶段的选择是为了使结果与上述泰勒级数在给定阶数上相匹配。经典的四阶格式使用四个阶段\n$$\n\\boldsymbol{k}_1 = \\boldsymbol{u}(\\boldsymbol{X}_0,t_0),\n\\quad\n\\boldsymbol{k}_2 = \\boldsymbol{u}\\!\\left(\\boldsymbol{X}_0 + \\frac{h}{2}\\boldsymbol{k}_1,\\, t_0 + \\frac{h}{2}\\right),\n\\quad\n\\boldsymbol{k}_3 = \\boldsymbol{u}\\!\\left(\\boldsymbol{X}_0 + \\frac{h}{2}\\boldsymbol{k}_2,\\, t_0 + \\frac{h}{2}\\right),\n\\quad\n\\boldsymbol{k}_4 = \\boldsymbol{u}\\!\\left(\\boldsymbol{X}_0 + h\\,\\boldsymbol{k}_3,\\, t_0 + h\\right),\n$$\n并进行如下更新\n$$\n\\boldsymbol{X}_{\\text{RK4}}(t_0+h) = \\boldsymbol{X}_0 + \\frac{h}{6}\\left(\\boldsymbol{k}_1 + 2\\boldsymbol{k}_2 + 2\\boldsymbol{k}_3 + \\boldsymbol{k}_4\\right).\n$$\n通过泰勒展开和阶数条件（可以编码在布彻表 (Butcher tableau) 中）来匹配系数，确保该方法达到四阶精度，即\n$$\n\\boldsymbol{X}(t_0+h) - \\boldsymbol{X}_{\\text{RK4}}(t_0+h) = \\mathcal{O}(h^5).\n$$\n局部截断误差 (LTE) 是这一单步差值的范数。对于足够光滑的 $\\boldsymbol{u}$，LTE 允许一个渐近展开\n$$\n\\|\\boldsymbol{X}(t_0+h) - \\boldsymbol{X}_{\\text{RK4}}(t_0+h)\\|_2 \\sim C(\\boldsymbol{X}_0,t_0)\\,h^5 \\quad \\text{as } h\\to 0,\n$$\n其中 $C(\\boldsymbol{X}_0,t_0)$ 取决于沿轨迹的 $\\boldsymbol{u}$ 的导数。因此，将步长减半会得到比率\n$$\n\\frac{E(h)}{E(h/2)} \\approx \\frac{C\\,h^5}{C\\,(h/2)^5} = 2^5 = 32,\n$$\n这为 LTE 的缩放行为提供了一个阶数观测检验。\n\n对于指定的速度场，精确的单步解可从其结构中获得。对于 $\\boldsymbol{u}(\\boldsymbol{x},t)=\\Omega(t)\\,(-y,x)=\\Omega(t)\\,\\mathbf{J}\\,\\boldsymbol{x}$，其中\n$$\n\\mathbf{J}=\\begin{pmatrix}0  -1 \\\\ 1  0\\end{pmatrix},\n$$\n该系统是线性的，具有一个时变标量系数乘以一个固定矩阵。由于 $\\mathbf{J}$ 是常数，且矩阵 $\\Omega(t_1)\\mathbf{J}$ 和 $\\Omega(t_2)\\mathbf{J}$ 可交换，因此在 $[t_0,t_0+h]$ 上的基本矩阵是一个旋转，旋转角度为\n$$\n\\theta = \\int_{t_0}^{t_0+h} \\Omega(t)\\,dt = \\Omega_0\\,h + \\frac{\\Omega_1}{\\sigma}\\left[\\cos(\\sigma t_0) - \\cos\\!\\big(\\sigma (t_0+h)\\big)\\right].\n$$\n因此，\n$$\n\\boldsymbol{X}_{\\text{exact}}(t_0+h) = \\mathbf{R}(\\theta)\\,\\boldsymbol{X}_0,\n\\quad\n\\mathbf{R}(\\theta) = \\begin{pmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{pmatrix}.\n$$\n那么，对于大小为 $h$ 的单步，其局部截断误差为\n$$\nE(h)=\\left\\|\\boldsymbol{X}_{\\text{RK4}}(t_0+h) - \\boldsymbol{X}_{\\text{exact}}(t_0+h)\\right\\|_2,\n$$\n以米 (m) 表示。\n\n算法设计：\n- 实现 $\\Omega(t)=\\Omega_0+\\Omega_1\\sin(\\sigma t)$。\n- 实现 $\\boldsymbol{u}(\\boldsymbol{x},t)=\\Omega(t)\\,(-y,x)$。\n- 使用四个阶段 $\\boldsymbol{k}_1,\\boldsymbol{k}_2,\\boldsymbol{k}_3,\\boldsymbol{k}_4$ 和加权组合实现单步经典四阶龙格-库塔方法。\n- 使用上述的 $\\theta$ 实现精确的单步旋转，并计算 $\\boldsymbol{X}_{\\text{exact}}(t_0+h)=\\mathbf{R}(\\theta)\\,\\boldsymbol{X}_0$。\n- 计算局部截断误差 $E(h)$，即 RK4 更新与精确更新之差的欧几里得范数。\n- 对于收敛性测试，计算 $E(h)$ 和 $E(h/2)$ 并构成比率 $E(h)/E(h/2)$。\n\n测试套件中的科学真实性和覆盖范围：\n- 用例 1 使用与中尺度一致的参数，其中 $\\Omega_0$ 的量级为 $10^{-5}\\ \\text{s}^{-1}$，并带有周期为 5 天（$5\\times 86400\\ \\text{s}$）的中等正弦调制。\n- 用例 2 通过构建误差比率来检查观测阶数，应得到一个接近 32 的值。\n- 用例 3 验证了涡旋中心的边界条件，在该处运动为零，数值更新与精确更新重合，从而产生 0 误差。\n- 用例 4 探讨了一个快速调制（周期 0.5 天）的边缘情况，以确保在更快速变化的 $\\Omega(t)$ 条件下计算方法的 LTE 行为。\n\n您的程序必须生成单行输出，其中包含按指定顺序和格式排列的用例 1 到 4 的结果，即 $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$，其中 $\\text{result1}$、$\\text{result3}$ 和 $\\text{result4}$ 是以米为单位的浮点数，而 $\\text{result2}$ 是一个无单位的浮点数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef omega(t, params):\n    \"\"\"Angular velocity Omega(t) = Omega0 + Omega1 * sin(sigma * t).\"\"\"\n    return params[\"Omega0\"] + params[\"Omega1\"] * np.sin(params[\"sigma\"] * t)\n\ndef velocity(x, t, params):\n    \"\"\"Velocity field u(x,t) = Omega(t) * (-y, x).\"\"\"\n    om = omega(t, params)\n    return np.array([-om * x[1], om * x[0]])\n\ndef rk4_step(x, t, h, params):\n    \"\"\"Classical fourth-order Runge–Kutta one-step update for x' = u(x,t).\"\"\"\n    k1 = velocity(x, t, params)\n    k2 = velocity(x + 0.5 * h * k1, t + 0.5 * h, params)\n    k3 = velocity(x + 0.5 * h * k2, t + 0.5 * h, params)\n    k4 = velocity(x + h * k3, t + h, params)\n    return x + (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n\ndef exact_step(x, t, h, params):\n    \"\"\"Exact one-step solution via rotation by theta = integral Omega(t) dt over [t, t+h].\"\"\"\n    # theta = Omega0*h + (Omega1/sigma) * [cos(sigma t) - cos(sigma (t+h))]\n    theta = params[\"Omega0\"] * h + (params[\"Omega1\"] / params[\"sigma\"]) * (\n        np.cos(params[\"sigma\"] * t) - np.cos(params[\"sigma\"] * (t + h))\n    )\n    c, s = np.cos(theta), np.sin(theta)\n    R = np.array([[c, -s], [s, c]])\n    return R @ x\n\ndef local_truncation_error(x, t, h, params):\n    \"\"\"Euclidean norm of the local truncation error for one RK4 step.\"\"\"\n    x_rk = rk4_step(x, t, h, params)\n    x_ex = exact_step(x, t, h, params)\n    return float(np.linalg.norm(x_rk - x_ex))\n\ndef solve():\n    days = 86400.0  # seconds in a day\n\n    results = []\n\n    # Case 1: general time-dependent vortex; happy path\n    params1 = {\n        \"Omega0\": 1.2e-5,\n        \"Omega1\": 4.0e-6,\n        \"sigma\": 2.0 * np.pi / (5.0 * days),\n    }\n    X01 = np.array([50e3, -25e3])\n    t01 = 0.0\n    h1 = 3600.0\n    err1 = local_truncation_error(X01, t01, h1, params1)\n    results.append(err1)\n\n    # Case 2: observed order via error ratio E(h)/E(h/2)\n    params2 = {\n        \"Omega0\": 9.5e-6,\n        \"Omega1\": 3.5e-6,\n        \"sigma\": 2.0 * np.pi / (3.0 * days),\n    }\n    X02 = np.array([80e3, 30e3])\n    t02 = 2.0 * days\n    h2_big = 7200.0\n    h2_small = h2_big / 2.0\n    err2_big = local_truncation_error(X02, t02, h2_big, params2)\n    err2_small = local_truncation_error(X02, t02, h2_small, params2)\n    ratio2 = err2_big / err2_small if err2_small != 0.0 else float(\"nan\")\n    results.append(ratio2)\n\n    # Case 3: boundary condition at origin; exact error is zero\n    params3 = {\n        \"Omega0\": 1.0e-5,\n        \"Omega1\": 6.0e-6,\n        \"sigma\": 2.0 * np.pi / (7.0 * days),\n    }\n    X03 = np.array([0.0, 0.0])\n    t03 = 1.0 * days\n    h3 = 3600.0\n    err3 = local_truncation_error(X03, t03, h3, params3)\n    results.append(err3)\n\n    # Case 4: edge case with rapidly varying angular velocity\n    params4 = {\n        \"Omega0\": 1.0e-5,\n        \"Omega1\": 1.0e-5,\n        \"sigma\": 2.0 * np.pi / (0.5 * days),\n    }\n    X04 = np.array([20e3, 20e3])\n    t04 = 0.25 * days\n    h4 = 1800.0\n    err4 = local_truncation_error(X04, t04, h4, params4)\n    results.append(err4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}