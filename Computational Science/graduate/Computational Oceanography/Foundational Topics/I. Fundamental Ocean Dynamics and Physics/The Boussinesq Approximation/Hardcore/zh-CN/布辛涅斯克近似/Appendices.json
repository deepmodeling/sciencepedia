{
    "hands_on_practices": [
        {
            "introduction": "Boussinesq近似通过在动量方程中将密度视为常数（浮力项除外）来简化方程。这个练习将引导您量化在惯性项中进行此简化所引入的误差。通过这种尺度分析，您将具体理解为何该近似在大多数海洋场景中如此有效。",
            "id": "3813996",
            "problem": "考虑一个由 Newton 第二定律对连续介质流体推导出的动量方程所描述的变密度海洋流，\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) = -\\nabla p - 2\\rho\\,\\boldsymbol{\\Omega}\\times \\boldsymbol{u} + \\rho\\,\\boldsymbol{g} + \\mu\\nabla^{2}\\boldsymbol{u},\n$$\n其中 $\\rho$ 是密度，$\\boldsymbol{u}$ 是速度，$p$ 是压力，$\\boldsymbol{\\Omega}$ 是行星旋转矢量，$\\boldsymbol{g}$ 是重力加速度，$\\mu$ 是动力粘度。在 Boussinesq 近似中，除了浮力项 $\\rho\\,\\boldsymbol{g}$ 中的密度变化被保留外，惯性项 $\\rho(\\partial\\boldsymbol{u}/\\partial t + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u})$ 以及科里奥利项和粘性项中的 $\\rho$ 都被替换为常数参考密度 $\\rho_{0}$。设密度分解为 $\\rho(\\boldsymbol{x},t) = \\rho_{0} + \\rho'(\\boldsymbol{x},t)$，其中 $|\\rho'| \\le \\Delta \\rho \\ll \\rho_{0}$。\n\n定义将 $\\rho$ 替换为 $\\rho_{0}$ 而在惯性项中引起的相对误差为\n$$\nE \\equiv \\frac{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) - \\rho_{0}\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}.\n$$\n使用标度分析，对于典型的海洋流，特征速度标度为 $U$，特征长度标度为 $L$，因此 $\\left|\\partial \\boldsymbol{u}/\\partial t + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right|$ 的标度为 $U^{2}/L$。请推导在所有满足 $|\\rho'| \\le \\Delta \\rho$ 的允许 $\\rho'$ 上，最大可能相对误差 $E_{\\max}$ 的闭式表达式。对于弱分层海洋，在 $\\Delta \\rho / \\rho_{0} \\le 5 \\times 10^{-3}$ 的条件下，计算 $E_{\\max}$ 的值。将最终答案表示为单个无量纲数或单个闭式解析表达式；不需要单位，也无需四舍五入。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n### 步骤1：提取已知条件\n- 变密度海洋流的动量方程：\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) = -\\nabla p - 2\\rho\\,\\boldsymbol{\\Omega}\\times \\boldsymbol{u} + \\rho\\,\\boldsymbol{g} + \\mu\\nabla^{2}\\boldsymbol{u}\n$$\n- 密度分解：$\\rho(\\boldsymbol{x},t) = \\rho_{0} + \\rho'(\\boldsymbol{x},t)$。\n- 密度扰动的约束条件：$|\\rho'| \\le \\Delta \\rho$。\n- Boussinesq 条件：$\\Delta \\rho \\ll \\rho_{0}$。\n- Boussinesq 近似涉及将除浮力项 $\\rho\\boldsymbol{g}$ 之外的所有项中的 $\\rho$ 替换为 $\\rho_0$。\n- 惯性项中相对误差 $E$ 的定义：\n$$\nE \\equiv \\frac{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) - \\rho_{0}\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}\n$$\n- 标度分析：$|\\partial \\boldsymbol{u}/\\partial t + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}|$ 非零，其标度为 $U^2/L$。\n- 求值条件：$\\Delta \\rho / \\rho_{0} \\le 5 \\times 10^{-3}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是科学合理的，因为它基于标准的 Navier-Stokes 方程和 Boussinesq 近似，这两者是地球物理流体动力学的基础。该问题是适定的，它清楚地定义了待计算的量（$E_{\\max}$）并提供了所有必要的约束条件。语言客观而精确。为 $\\Delta \\rho / \\rho_{0}$ 提供的数值对于海洋流是物理上现实的。该问题是自洽的，不包含任何矛盾或含糊之处。\n\n### 步骤3：结论与行动\n该问题被判定为 **有效**。将提供完整解答。\n\n### 解题推导\n目标是在给定密度扰动 $\\rho'$ 约束条件的情况下，求出惯性项中相对误差 $E$ 的最大可能值。\n\n相对误差的定义为：\n$$\nE \\equiv \\frac{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) - \\rho_{0}\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}\n$$\n令速度的物质导数表示为矢量 $\\boldsymbol{a} \\equiv \\frac{D\\boldsymbol{u}}{Dt} = \\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}$。问题陈述通过其标度分析暗示该项非零，即 $\\boldsymbol{a} \\neq \\boldsymbol{0}$。$E$ 的表达式可以重写为：\n$$\nE = \\frac{|\\rho \\boldsymbol{a} - \\rho_{0} \\boldsymbol{a}|}{|\\rho \\boldsymbol{a}|}\n$$\n从分子和分母中提出矢量 $\\boldsymbol{a}$：\n$$\nE = \\frac{|(\\rho - \\rho_{0}) \\boldsymbol{a}|}{|\\rho \\boldsymbol{a}|} = \\frac{|\\rho - \\rho_{0}| |\\boldsymbol{a}|}{|\\rho| |\\boldsymbol{a}|}\n$$\n因为 $\\boldsymbol{a} \\neq \\boldsymbol{0}$，我们可以消去模 $|\\boldsymbol{a}|$：\n$$\nE = \\frac{|\\rho - \\rho_{0}|}{|\\rho|}\n$$\n使用密度分解 $\\rho = \\rho_{0} + \\rho'$，分子中的项变为 $|\\rho - \\rho_{0}| = |(\\rho_{0} + \\rho') - \\rho_{0}| = |\\rho'|$。\n分母中的项为 $|\\rho| = |\\rho_{0} + \\rho'|$。由于该问题植根于 $\\Delta \\rho \\ll \\rho_{0}$ 的物理背景，且 $\\rho_0$ 是一个正的参考密度，总密度 $\\rho = \\rho_{0} + \\rho'$ 必须为正。因此，$|\\rho| = \\rho = \\rho_{0} + \\rho'$。\n将这些代回 $E$ 的表达式中：\n$$\nE = \\frac{|\\rho'|}{\\rho_{0} + \\rho'}\n$$\n我们需要在约束条件 $|\\rho'| \\le \\Delta \\rho$（等价于 $-\\Delta \\rho \\le \\rho' \\le \\Delta \\rho$）下，求出 $E$ 的最大值，记为 $E_{\\max}$。我们来分析函数 $f(\\rho') = \\frac{|\\rho'|}{\\rho_{0} + \\rho'}$。\n\n情况1：$0 \\le \\rho' \\le \\Delta \\rho$。\n在此范围内， $|\\rho'| = \\rho'$，因此函数为 $E(\\rho') = \\frac{\\rho'}{\\rho_{0} + \\rho'}$。为了求最大值，我们可以考察其关于 $\\rho'$ 的导数：\n$$\n\\frac{dE}{d\\rho'} = \\frac{(1)(\\rho_{0} + \\rho') - (\\rho')(1)}{(\\rho_{0} + \\rho')^2} = \\frac{\\rho_{0}}{(\\rho_{0} + \\rho')^2}\n$$\n由于 $\\rho_{0}  0$，导数恒为正。这意味着 $E(\\rho')$ 是 $\\rho'$ 的单调递增函数。此区间内的最大值将出现在上界，即 $\\rho' = \\Delta \\rho$。\n该值为 $E_1 = \\frac{\\Delta \\rho}{\\rho_{0} + \\Delta \\rho}$。\n\n情况2：$-\\Delta \\rho \\le \\rho'  0$。\n在此范围内， $|\\rho'| = -\\rho'$，因此函数为 $E(\\rho') = \\frac{-\\rho'}{\\rho_{0} + \\rho'}$。其导数为：\n$$\n\\frac{dE}{d\\rho'} = \\frac{(-1)(\\rho_{0} + \\rho') - (-\\rho')(1)}{(\\rho_{0} + \\rho')^2} = \\frac{-\\rho_{0} - \\rho' + \\rho'}{(\\rho_{0} + \\rho')^2} = \\frac{-\\rho_{0}}{(\\rho_{0} + \\rho')^2}\n$$\n由于 $\\rho_{0}  0$，导数恒为负。这意味着 $E(\\rho')$ 是 $\\rho'$ 的单调递减函数。此区间内的最大值将出现在下界，即 $\\rho' = -\\Delta \\rho$。\n该值为 $E_2 = \\frac{-(-\\Delta \\rho)}{\\rho_{0} + (-\\Delta \\rho)} = \\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}$。\n\n现在我们必须通过比较 $E_1$ 和 $E_2$ 来找到全局最大值 $E_{\\max}$：\n$$\nE_1 = \\frac{\\Delta \\rho}{\\rho_{0} + \\Delta \\rho} \\quad \\text{和} \\quad E_2 = \\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}\n$$\n因为 $\\rho_{0}  0$ 且 $\\Delta \\rho  0$，我们有 $0  \\rho_{0} - \\Delta \\rho  \\rho_{0} + \\Delta \\rho$。取倒数会反转不等式：\n$$\n\\frac{1}{\\rho_{0} - \\Delta \\rho}  \\frac{1}{\\rho_{0} + \\Delta \\rho}\n$$\n乘以正量 $\\Delta \\rho$ 保持不等式不变：\n$$\n\\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}  \\frac{\\Delta \\rho}{\\rho_{0} + \\Delta \\rho}\n$$\n因此，$E_2  E_1$。最大可能相对误差为 $E_{\\max} = E_2$。\n$$\nE_{\\max} = \\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}\n$$\n为了用给定的比率 $\\Delta \\rho / \\rho_{0}$ 来表示，我们将分子和分母同除以 $\\rho_{0}$：\n$$\nE_{\\max} = \\frac{\\Delta \\rho / \\rho_{0}}{(\\rho_{0} - \\Delta \\rho)/\\rho_{0}} = \\frac{\\Delta \\rho / \\rho_{0}}{1 - \\Delta \\rho / \\rho_{0}}\n$$\n这就是所求的 $E_{\\max}$ 的闭式表达式。\n\n最后，我们在指定条件 $\\Delta \\rho / \\rho_{0} \\le 5 \\times 10^{-3}$ 下计算该表达式。最大误差将在该比率取最大值时出现，因此我们取 $\\Delta \\rho / \\rho_{0} = 5 \\times 10^{-3} = 0.005$。\n$$\nE_{\\max} = \\frac{0.005}{1 - 0.005} = \\frac{0.005}{0.995}\n$$\n该分数可以简化为：\n$$\nE_{\\max} = \\frac{5/1000}{995/1000} = \\frac{5}{995}\n$$\n将分子和分母同除以 $5$：\n$$\nE_{\\max} = \\frac{1}{199}\n$$\n这就是最大可能相对误差的最终数值答案。",
            "answer": "$$\n\\boxed{\\frac{1}{199}}\n$$"
        },
        {
            "introduction": "Boussinesq近似的一个关键推论是螺线管（无辐散）速度场条件，即 $\\nabla \\cdot \\boldsymbol{u} = 0$。本练习旨在澄清一个常见的困惑点：为什么不直接使用看似更基本的无辐散*质量通量*条件 $\\nabla \\cdot (\\rho \\boldsymbol{u}) = 0$？通过本练习，您将辨析这两种表述的细微但至关重要的区别，并量化因错误表述而产生的误差，从而突显其在构建精确数值模型中的重要性。",
            "id": "3813981",
            "problem": "一个实现了Boussinesq近似的海洋模型计算了一个无散速度场。考虑一个分层流，其密度表示为 $\\rho = \\rho_{0} + \\rho'$，其中 $\\rho_{0}$ 是一个恒定的参考密度，$\\rho'$ 是一个小扰动，满足 $|\\rho'| / \\rho_{0} \\ll 1$。基本的质量守恒定律表述为 $\\partial \\rho / \\partial t + \\nabla \\cdot (\\rho \\boldsymbol{u}) = 0$，其中 $\\boldsymbol{u}$ 是速度场。在Boussinesq近似中，模型强制速度场无散，即 $\\nabla \\cdot \\boldsymbol{u} = 0$。一位同事提议，在动量方程中仍然将 $\\rho_{0}$ 视为常数的同时，在数值上强制执行一个无散的质量通量 $\\nabla \\cdot (\\rho \\boldsymbol{u}) = 0$，他认为当 $\\rho'$ 变化时，这是一个更普适的约束。\n\n仅使用基本的质量守恒定律和矢量微积分的标准法则，并将 $|\\rho'| / \\rho_{0}$ 视为一个小参数，推导这两个约束之间的一阶关系，并量化强制执行 $\\nabla \\cdot (\\rho \\boldsymbol{u}) = 0$ 对速度场散度的影响。定义一个特征速度尺度 $U$ 和一个密度梯度长度尺度 $L$，使得 $|\\boldsymbol{u}| \\sim U$ 和 $|\\nabla \\rho| \\sim |\\rho'|/L$。将无量纲误差 $E$ 定义为因强制执行 $\\nabla \\cdot (\\rho \\boldsymbol{u}) = 0$ 而非 $\\nabla \\cdot \\boldsymbol{u} = 0$ 所引起的虚假散度的归一化大小，\n$$\nE \\equiv \\frac{|\\nabla \\cdot \\boldsymbol{u}|}{U/L}.\n$$\n假设在Boussinesq机制下 $|\\rho'| / \\rho_{0} \\sim 10^{-3}$，计算 $E$ 关于 $|\\rho'|/\\rho_{0}$ 的一阶项。将您的最终答案表示为一个无量纲小数，四舍五入到三位有效数字。不要包含任何单位。",
            "solution": "该问题要求在Boussinesq近似的背景下，分析强制执行无散质量通量 $\\nabla \\cdot (\\rho \\boldsymbol{u}) = 0$ 的后果，并量化其在速度场散度中产生的误差。\n\n流体中质量守恒的基本原理由连续性方程给出：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u}) = 0\n$$\n此处，$\\rho$ 是流体密度，$t$ 是时间，$\\boldsymbol{u}$ 是速度场。Boussinesq近似通常应用于密度变化很小的分层流，它简化了控制方程。对于连续性方程，该近似导致了速度场无散的约束：\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0\n$$\n这是合理的，因为对于缓慢的、近乎不可压缩的流动，跟随流体质点的密度变化非常小，因此项 $\\frac{1}{\\rho}\\frac{D\\rho}{Dt}$ 与速度梯度相比可以忽略不计，从而得到 $\\nabla \\cdot \\boldsymbol{u} \\approx 0$。\n\n同事的提议是强制执行一个替代约束：\n$$\n\\nabla \\cdot (\\rho \\boldsymbol{u}) = 0\n$$\n如果强制执行此约束，那么根据基本的质量守恒定律 $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u}) = 0$，这意味着数值模型被迫满足 $\\frac{\\partial \\rho}{\\partial t} = 0$。这意味着空间中任何固定点的密度都不能随时间变化，这是一个高度限制性的条件，它阻止模型表示诸如内波或分层平流等随时间演变的现象。\n\n我们的任务是确定由施加同事的约束而产生的人为的速度场散度 $\\nabla \\cdot \\boldsymbol{u}$。我们从该约束本身开始，并应用矢量微积分中关于标量场 ($\\rho$) 与矢量场 ($\\boldsymbol{u}$) 乘积的散度的乘法法则：\n$$\n\\nabla \\cdot (\\rho \\boldsymbol{u}) = (\\nabla \\rho) \\cdot \\boldsymbol{u} + \\rho (\\nabla \\cdot \\boldsymbol{u})\n$$\n根据提议将此表达式设为零：\n$$\n(\\nabla \\rho) \\cdot \\boldsymbol{u} + \\rho (\\nabla \\cdot \\boldsymbol{u}) = 0\n$$\n我们可以求解这个关于速度场散度 $\\nabla \\cdot \\boldsymbol{u}$ 的代数方程：\n$$\n\\nabla \\cdot \\boldsymbol{u} = - \\frac{(\\nabla \\rho) \\cdot \\boldsymbol{u}}{\\rho}\n$$\n这个方程给出了通过强制执行无散质量通量而隐式产生的速度场散度的精确非零值。\n\n接下来，我们在Boussinesq近似的框架内分析这个表达式。密度 $\\rho$ 被分解为一个恒定的参考密度 $\\rho_{0}$ 和一个小扰动 $\\rho'$：\n$$\n\\rho = \\rho_{0} + \\rho'\n$$\n其中 $|\\rho'| / \\rho_{0} \\ll 1$。由于 $\\rho_{0}$ 是一个空间常数，其梯度为零，所以 $\\nabla \\rho = \\nabla (\\rho_{0} + \\rho') = \\nabla \\rho'$。将这些代入散度的表达式中，得到：\n$$\n\\nabla \\cdot \\boldsymbol{u} = - \\frac{(\\nabla \\rho') \\cdot \\boldsymbol{u}}{\\rho_{0} + \\rho'}\n$$\n为了找到一阶关系，我们对项 $\\frac{1}{\\rho_{0} + \\rho'}$ 就小的 $\\rho'/\\rho_{0}$ 进行泰勒展开：\n$$\n\\frac{1}{\\rho_{0} + \\rho'} = \\frac{1}{\\rho_{0}(1 + \\rho'/\\rho_{0})} = \\frac{1}{\\rho_{0}} \\left(1 - \\frac{\\rho'}{\\rho_{0}} + O\\left(\\left(\\frac{\\rho'}{\\rho_{0}}\\right)^2\\right)\\right)\n$$\n只保留一阶项，我们得到近似的虚假散度：\n$$\n\\nabla \\cdot \\boldsymbol{u} \\approx - \\frac{(\\nabla \\rho') \\cdot \\boldsymbol{u}}{\\rho_{0}}\n$$\n这就是同事的约束与由此产生的速度场散度之间的一阶关系。\n\n为了量化该散度的典型量级，我们进行一次尺度分析。散度的量级为：\n$$\n|\\nabla \\cdot \\boldsymbol{u}| \\approx \\left|- \\frac{(\\nabla \\rho') \\cdot \\boldsymbol{u}}{\\rho_{0}}\\right| = \\frac{|(\\nabla \\rho') \\cdot \\boldsymbol{u}|}{\\rho_{0}}\n$$\n使用点积的性质， $|(\\nabla \\rho') \\cdot \\boldsymbol{u}| \\le |\\nabla \\rho'| |\\boldsymbol{u}|$。为了进行尺度分析，我们假设这些矢量不是系统性地正交，并关联它们的特征尺度：\n$$\n|\\nabla \\cdot \\boldsymbol{u}| \\sim \\frac{|\\nabla \\rho'| |\\boldsymbol{u}|}{\\rho_{0}}\n$$\n问题定义了特征速度尺度 $|\\boldsymbol{u}| \\sim U$ 和密度梯度长度尺度 $L$，使得 $|\\nabla \\rho| \\sim |\\rho'|/L$。由于 $\\nabla\\rho = \\nabla\\rho'$，这意味着 $|\\nabla \\rho'| \\sim |\\rho'|/L$。将这些尺度代入散度量级的表达式中，得到：\n$$\n|\\nabla \\cdot \\boldsymbol{u}| \\sim \\frac{(|\\rho'|/L) U}{\\rho_{0}} = \\frac{U}{L} \\frac{|\\rho'|}{\\rho_{0}}\n$$\n问题将无量纲误差 $E$ 定义为虚假散度的归一化大小：\n$$\nE \\equiv \\frac{|\\nabla \\cdot \\boldsymbol{u}|}{U/L}\n$$\n代入我们对 $|\\nabla \\cdot \\boldsymbol{u}|$ 的尺度化表达式：\n$$\nE \\sim \\frac{\\frac{U}{L} \\frac{|\\rho'|}{\\rho_{0}}}{U/L} = \\frac{|\\rho'|}{\\rho_{0}}\n$$\n因此，在一阶上，速度场散度中产生的无量纲误差等于密度扰动分数。\n\n最后，我们被要求在Boussinesq机制下 $|\\rho'|/\\rho_{0} \\sim 10^{-3}$ 的条件下计算 $E$ 的数值。\n$$\nE \\sim 10^{-3} = 0.001\n$$\n问题要求将此结果表示为一个无量纲小数，四舍五入到三位有效数字。为了将 $0.001$ 表示为三位有效数字，我们将其写为 $0.00100$。",
            "answer": "$$\\boxed{0.00100}$$"
        },
        {
            "introduction": "在确立了控制方程之后，下一步便是对其进行数值求解。本练习将带您深入现代计算流体动力学的核心，探索用于强制执行不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u} = 0$ 的投影法。您将为一个给定的流场推导并求解压力泊松方程，这是许多海洋模型中的基石。",
            "id": "3813983",
            "problem": "考虑在双周期域 $[0,L] \\times [0,H]$ 中，$x$–$z$ 平面上的一个二维、有粘、分层流，该流动遵循 Boussinesq 近似。参考密度为 $\\rho_{0}$，重力为 $g$，浮力 $b(x,z)$ 通过 Boussinesq 近似与密度扰动相关联。设速度场为 $\\boldsymbol{u}(x,z) = \\big(u(x,z), w(x,z)\\big)$，在投影步开始时该速度场是精确无散度的。假设在此步骤中，进入临时显式动量更新的非压力项汇集为\n$$\n\\boldsymbol{R}(x,z) = g\\,b(x,z)\\,\\hat{\\boldsymbol{z}} + \\nu\\,\\nabla^{2}\\boldsymbol{u}(x,z),\n$$\n其中 $\\nu$ 是常数运动粘度，$\\hat{\\boldsymbol{z}}$ 是 $z$ 方向的单位向量。投影步中使用的压力增量 $p'(x,z)$ 是通过求解一个泊松方程来定义的（相差一个任意常数），该方程是通过对校正后的速度强制施加不可压缩性条件而得到的。\n\n设无散度速度场和浮力分布由以下傅里叶模态指定\n$$\nu(x,z) = U_{0}\\,\\cos(k x)\\,\\cos(m z), \\qquad w(x,z) = U_{0}\\,\\frac{k}{m}\\,\\sin(k x)\\,\\sin(m z),\n$$\n$$\nb(x,z) = B_{0}\\,\\sin(k x)\\,\\sin(m z),\n$$\n其中 $U_{0}  0$，$B_{0}  0$，波数 $k = \\frac{2\\pi \\ell}{L}$，$m = \\frac{2\\pi n}{H}$，$\\ell, n \\geq 1$ 为整数。假设在 $x$ 和 $z$ 方向上采用双周期边界条件，并通过零均值条件 $\\int_{0}^{L}\\int_{0}^{H} p'(x,z)\\,\\mathrm{d}x\\,\\mathrm{d}z = 0$ 来确定压力增量。\n\n从 Boussinesq 方程和不可压缩性约束出发，利用投影法的逻辑，推导与临时更新相关的压力泊松方程及其必须满足的可解性条件。然后，对于给定的场，计算 $\\nabla\\cdot\\boldsymbol{R}$，解析地验证在所述边界条件下泊松方程是否有解，并求出相应的闭式解 $p'(x,z)$，该解能确保校正后的速度场是不可压缩的。\n\n用帕斯卡（Pascals）表示最终的压力增量。最终答案必须是 $p'(x,z)$ 的单个闭式解析表达式。",
            "solution": "用户提供的问题陈述已经过验证，被确定为计算流体动力学领域一个有效、自洽且适定的问题。它在科学上基于 Boussinesq 近似和不可压缩流投影法的原理。\n\n该问题要求推导压力泊松方程、其可解性条件，并针对一组给定的强迫项和初始场，求出压力增量 $p'(x,z)$ 的具体解。\n\n### 步骤1：压力泊松方程和可解性条件的推导\n\n在投影法中，压力增量 $p'$ 的作用是在时间步结束时对速度场施加不可压缩性约束。在非压力强迫项 $\\boldsymbol{R}$ 和压力梯度的影响下，速度场 $\\boldsymbol{u}$ 的演化由下式给出\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} = \\boldsymbol{F} = -\\frac{1}{\\rho_0} \\nabla p' + \\boldsymbol{R}\n$$\n其中 $p'$ 是动压场（单位为帕斯卡），$\\rho_0$ 是恒定的参考密度。不可压缩性条件要求速度场在任何时候都是无散度的：\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0\n$$\n对不可压缩性条件求时间导数，可得：\n$$\n\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\boldsymbol{u}) = \\nabla \\cdot \\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t}\\right) = 0\n$$\n将 $\\frac{\\partial \\boldsymbol{u}}{\\partial t}$ 的表达式代入此方程，得到：\n$$\n\\nabla \\cdot \\left(-\\frac{1}{\\rho_0} \\nabla p' + \\boldsymbol{R}\\right) = 0\n$$\n由于 $\\rho_0$ 是常数，我们可以重新排列各项，得到压力泊松方程（PPE）：\n$$\n\\nabla^2 p' = \\rho_0 \\nabla \\cdot \\boldsymbol{R}\n$$\n这个椭圆型偏微分方程定义了为确保速度场保持无散度所需的压力场 $p'$。\n\n为了使该泊松方程在双周期域上存在解，必须满足一个可解性条件。该条件通过在整个域 $\\Omega = [0,L] \\times [0,H]$ 上对 PPE 进行积分来推导：\n$$\n\\int_{\\Omega} \\nabla^2 p' \\, \\mathrm{d}A = \\int_{\\Omega} \\rho_0 \\nabla \\cdot \\boldsymbol{R} \\, \\mathrm{d}A\n$$\n对两边应用散度定理：\n$$\n\\oint_{\\partial\\Omega} (\\nabla p') \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = \\rho_0 \\oint_{\\partial\\Omega} \\boldsymbol{R} \\cdot \\boldsymbol{n} \\, \\mathrm{d}s\n$$\n其中 $\\boldsymbol{n}$ 是边界 $\\partial\\Omega$ 的外向单位法向量。由于双周期边界条件，任何函数及其导数在相对边界上的值都相同。因此，沿矩形域相对两侧的线积分相互抵消。例如，$\\int_0^H \\frac{\\partial p'}{\\partial x}|_{x=L} \\mathrm{d}z + \\int_H^0 \\frac{\\partial p'}{\\partial x}|_{x=0} \\mathrm{d}z = \\int_0^H \\frac{\\partial p'}{\\partial x}|_{x=L} \\mathrm{d}z - \\int_0^H \\frac{\\partial p'}{\\partial x}|_{x=0} \\mathrm{d}z = 0$，因为 $\\frac{\\partial p'}{\\partial x}$ 在 x 方向上是周期的。因此，两个边界积分均为零。这意味着由散度定理导出的可解性条件对于任何周期场都是自然满足的。然而，积分形式 $\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{R} \\, \\mathrm{d}A = 0$ 是必须检查的实际条件。\n\n### 步骤2：计算 $\\nabla \\cdot \\boldsymbol{R}$\n\n问题将强迫项定义为 $\\boldsymbol{R}(x,z) = g\\,b(x,z)\\,\\hat{\\boldsymbol{z}} + \\nu\\,\\nabla^{2}\\boldsymbol{u}(x,z)$。以分量形式表示，即 $\\boldsymbol{R} = (R_x, R_z)$，其中 $R_x = \\nu \\nabla^2 u$ 和 $R_z = g b + \\nu \\nabla^2 w$。\n$\\boldsymbol{R}$ 的散度为：\n$$\n\\nabla \\cdot \\boldsymbol{R} = \\frac{\\partial R_x}{\\partial x} + \\frac{\\partial R_z}{\\partial z} = \\frac{\\partial}{\\partial x}(\\nu \\nabla^2 u) + \\frac{\\partial}{\\partial z}(g b + \\nu \\nabla^2 w)\n$$\n假设 $\\nu$ 和 $g$ 是常数：\n$$\n\\nabla \\cdot \\boldsymbol{R} = \\nu \\frac{\\partial}{\\partial x}(\\nabla^2 u) + g \\frac{\\partial b}{\\partial z} + \\nu \\frac{\\partial}{\\partial z}(\\nabla^2 w)\n$$\n拉普拉斯算子和偏微分算子是可交换的。整理各项：\n$$\n\\nabla \\cdot \\boldsymbol{R} = \\nu \\nabla^2 \\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z}\\right) + g \\frac{\\partial b}{\\partial z}\n$$\n问题陈述初始速度场是无散度的，即 $\\nabla \\cdot \\boldsymbol{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0$。这极大地简化了 $\\nabla \\cdot \\boldsymbol{R}$ 的表达式：\n$$\n\\nabla \\cdot \\boldsymbol{R} = g \\frac{\\partial b}{\\partial z}\n$$\n现在，我们代入给定的浮力场 $b(x,z) = B_{0}\\,\\sin(k x)\\,\\sin(m z)$：\n$$\n\\frac{\\partial b}{\\partial z} = \\frac{\\partial}{\\partial z}\\left(B_{0}\\,\\sin(k x)\\,\\sin(m z)\\right) = m B_{0}\\,\\sin(k x)\\,\\cos(m z)\n$$\n因此，强迫项的散度为：\n$$\n\\nabla \\cdot \\boldsymbol{R} = g m B_{0}\\,\\sin(k x)\\,\\cos(m z)\n$$\n\n### 步骤3：验证可解性条件\n\n可解性条件是 $\\int_{0}^{L}\\int_{0}^{H} (\\nabla \\cdot \\boldsymbol{R})\\,\\mathrm{d}x\\,\\mathrm{d}z = 0$。我们来计算这个积分：\n$$\n\\int_{0}^{L}\\int_{0}^{H} g m B_0 \\sin(kx) \\cos(mz) \\, \\mathrm{d}x \\, \\mathrm{d}z = g m B_0 \\left(\\int_{0}^{L} \\sin(kx) \\, \\mathrm{d}x\\right) \\left(\\int_{0}^{H} \\cos(mz) \\, \\mathrm{d}z\\right)\n$$\n问题指定 $k = \\frac{2\\pi \\ell}{L}$，其中整数 $\\ell \\geq 1$。关于 $x$ 的积分为：\n$$\n\\int_{0}^{L} \\sin\\left(\\frac{2\\pi \\ell}{L}x\\right) \\, \\mathrm{d}x = \\left[-\\frac{L}{2\\pi \\ell} \\cos\\left(\\frac{2\\pi \\ell}{L}x\\right)\\right]_{0}^{L} = -\\frac{L}{2\\pi \\ell}(\\cos(2\\pi \\ell) - \\cos(0)) = -\\frac{L}{2\\pi \\ell}(1 - 1) = 0\n$$\n由于乘积中的一个积分为零，整个二重积分也为零。可解性条件得到满足，因此 $p'$ 的解存在。\n\n### 步骤4：求解压力泊松方程\n\n我们现在必须求解 $p'(x,z)$ 的 PPE：\n$$\n\\nabla^2 p' = \\frac{\\partial^2 p'}{\\partial x^2} + \\frac{\\partial^2 p'}{\\partial z^2} = \\rho_0 (g m B_{0}\\,\\sin(k x)\\,\\cos(m z))\n$$\n考虑到源项的正弦形式，我们寻求形式为 $p'(x,z) = C \\sin(kx)\\cos(mz)$ 的解。我们计算其拉普拉斯算子：\n$$\n\\frac{\\partial p'}{\\partial x} = Ck \\cos(kx) \\cos(mz) \\implies \\frac{\\partial^2 p'}{\\partial x^2} = -Ck^2 \\sin(kx) \\cos(mz)\n$$\n$$\n\\frac{\\partial p'}{\\partial z} = -Cm \\sin(kx) \\sin(mz) \\implies \\frac{\\partial^2 p'}{\\partial z^2} = -Cm^2 \\sin(kx) \\cos(mz)\n$$\n将二阶偏导数相加得到：\n$$\n\\nabla^2 p' = (-Ck^2 - Cm^2)\\sin(kx) \\cos(mz) = -C(k^2 + m^2)\\sin(kx) \\cos(mz)\n$$\n将此结果与 PPE 中的源项相等：\n$$\n-C(k^2 + m^2)\\sin(kx) \\cos(mz) = \\rho_0 g m B_{0}\\,\\sin(k x)\\,\\cos(m z)\n$$\n为了使该等式对所有 $x$ 和 $z$ 都成立，系数必须相等：\n$$\n-C(k^2 + m^2) = \\rho_0 g m B_0\n$$\n求解常数 $C$：\n$$\nC = -\\frac{\\rho_0 g m B_0}{k^2 + m^2}\n$$\n因此，特解为：\n$$\np'_{p}(x,z) = -\\frac{\\rho_0 g m B_0}{k^2 + m^2} \\sin(kx) \\cos(mz)\n$$\n通解为 $p'(x,z) = p'_{p}(x,z) + p'_{h}(x,z)$，其中 $p'_{h}$ 是齐次拉普拉斯方程 $\\nabla^2 p'_{h} = 0$ 的解。对于双周期域，唯一的非平凡解是常数，即 $p'_{h}(x,z) = C_0$。\n问题通过施加零均值条件来确定这个常数：$\\int_{0}^{L}\\int_{0}^{H} p'(x,z)\\,\\mathrm{d}x\\,\\mathrm{d}z = 0$。\n$$\n\\int_{0}^{L}\\int_{0}^{H} \\left( -\\frac{\\rho_0 g m B_0}{k^2 + m^2} \\sin(kx) \\cos(mz) + C_0 \\right) \\mathrm{d}x\\,\\mathrm{d}z = 0\n$$\n$$\n-\\frac{\\rho_0 g m B_0}{k^2 + m^2} \\int_{0}^{L}\\int_{0}^{H} \\sin(kx) \\cos(mz) \\, \\mathrm{d}x\\,\\mathrm{d}z + \\int_{0}^{L}\\int_{0}^{H} C_0 \\, \\mathrm{d}x\\,\\mathrm{d}z = 0\n$$\n如步骤3所示，第一个积分为零。第二个积分为 $C_0 L H$。\n因此，$0 + C_0 L H = 0$，这意味着 $C_0 = 0$。\n满足所有条件的唯一压力增量是：\n$$\np'(x,z) = -\\frac{\\rho_0 g m B_0}{k^2 + m^2} \\sin(kx) \\cos(mz)\n$$\n该表达式表示压力，单位为帕斯卡，与推导过程一致。",
            "answer": "$$\n\\boxed{-\\frac{\\rho_{0} g m B_{0}}{k^{2} + m^{2}} \\sin(k x) \\cos(m z)}\n$$"
        }
    ]
}