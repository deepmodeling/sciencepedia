{
    "hands_on_practices": [
        {
            "introduction": "在运行复杂的海洋数值模型之前，一个关键步骤是建立一个物理上自洽的初始状态。对于大尺度海洋环流，这个基本状态通常是地转平衡和静力平衡的。本练习将指导您从第一性原理出发，实现这两个基本平衡关系，将理论转化为从给定的密度和海面高度数据构建模型初始场的实用算法，这是计算海洋学的一项核心技能。",
            "id": "3815721",
            "problem": "您的任务是根据给定的密度和海面高度，通过一致地执行在旋转坐标系中由动量方程产生的静力关系和地转关系，来构建地转平衡的三维速度场。您的推导和算法必须从计算海洋学的第一性原理出发，不得依赖本说明中提供的快捷公式。\n\n从应用于Boussinesq流体的旋转坐标系中的牛顿第二定律开始，其中行星旋转的影响由科里奥利加速度表示。基本基础如下：物质导数 $D\\boldsymbol{u}/Dt$、重力加速度 $g$、压力 $p$、密度 $\\rho$、参考密度 $\\rho_0$ 以及由地球自转定义的科里奥利参数 $f$。在静力近似下，垂直动量平衡简化为将垂直压力梯度与当地密度联系起来的静力关系。在大尺度、缓变流中，水平动量平衡简化为科里奥利加速度和水平压力梯度之间的地转平衡。\n\n您的程序必须：\n- 将一个矩形海洋区域离散化，该区域具有水平坐标 $x$ 和 $y$ 以及垂直坐标 $z$（向上为正），其中 $x \\in [0,L_x]$，$y \\in [0,L_y]$，以及 $z \\in [-H,0]$。分别使用具有 $N_x$、$N_y$ 和 $N_z$ 个点的均匀网格。您必须设置 $L_x = 10^5\\ \\mathrm{m}$、$L_y = 10^5\\ \\mathrm{m}$、$H = 10^3\\ \\mathrm{m}$、$N_x = 64$、$N_y = 64$ 和 $N_z = 80$。\n- 假设重力加速度 $g = 9.81\\ \\mathrm{m\\,s^{-2}}$，参考密度 $\\rho_0 = 1025\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$。为方便起见，将海面的大气压力设为零，这不影响水平压力梯度。\n- 在计算水平导数时，在水平方向上施加周期性边界条件。对水平导数和内部的垂直导数使用二阶中心差分（在计算基于垂直导数的残差时，忽略垂直边界点）。\n\n您将获得叠加在稳定层结上的水平变化的密度异常，以及一个给定的海面高度 (SSH)。对于每个测试用例，按如下方式定义密度场 $\\rho(x,y,z)$ 和SSH $\\eta(x,y)$：\n- 设层结随深度呈线性关系：$\\rho_\\mathrm{strat}(z) = \\rho_0 + s(-z)$，其中 $s > 0$ 为常数。\n- 设水平密度异常为 $\\rho_\\mathrm{anom}(x,y,z) = b \\cos\\!\\left(2\\pi x/L_x\\right)\\cos\\!\\left(2\\pi y/L_y\\right)\\exp\\!\\left(z/H_s\\right)$，其中 $b$ 是异常幅度，$H_s$ 是垂直衰减尺度。\n- 总密度为 $\\rho(x,y,z) = \\rho_\\mathrm{strat}(z) + \\rho_\\mathrm{anom}(x,y,z)$。\n- SSH场为 $\\eta(x,y) = A_\\eta \\sin\\!\\left(2\\pi y/L_y\\right) + B_\\eta \\cos\\!\\left(2\\pi x/L_x\\right)$。\n\n利用静力关系，从 $z=0$ 处的上边界条件（在小振幅极限下，由SSH引起的海面压力异常由一个正压贡献表示）：$p(x,y,0) = \\rho_0 g \\eta(x,y)$，构建整个水体中的压力场 $p(x,y,z)$，并以离散形式强制满足垂直平衡 $+\\partial p/\\partial z + \\rho g = 0$。然后，在每个水平层面上，强制满足科里奥利加速度和水平压力梯度之间的地转平衡，其中科里奥利参数 (CP) $f$ 在每个测试用例中指定。构建与您通过静力重构获得的水平压力梯度一致的水平无辐散的地转速度 $\\boldsymbol{u}(x,y,z) = (u(x,y,z), v(x,y,z))$。您不得引入任何摩擦项或非地转项。\n\n为了量化您构建的一致性，请计算以下残差：\n- 静力残差\n$$\nr_h = \\max_{x,y,z\\ \\text{(interior in }z\\text{)}} \\left| \\frac{\\partial p}{\\partial z} + \\rho g \\right| \\Big/ \\rho_0,\n$$\n其单位为 $\\mathrm{m\\,s^{-2}}$。\n- 地转残差\n$$\nr_g = \\max_{x,y,z} \\left\\{ \\left[ -f v + \\frac{1}{\\rho_0}\\frac{\\partial p}{\\partial x} \\right]^2 + \\left[ f u + \\frac{1}{\\rho_0}\\frac{\\partial p}{\\partial y} \\right]^2 \\right\\}^{1/2},\n$$\n其单位也为 $\\mathrm{m\\,s^{-2}}$。\n\n对于每个测试用例，报告单个标量\n$$\nr = \\max(r_h, r_g),\n$$\n以 $\\mathrm{m\\,s^{-2}}$ 为单位表示。\n\n在以下四个测试套件上实现您的解决方案。每个元组列出了 $(f, s, b, H_s, A_\\eta, B_\\eta)$，单位为 $(\\mathrm{s}^{-1}, \\mathrm{kg}\\ \\mathrm{m}^{-4}, \\mathrm{kg}\\ \\mathrm{m}^{-3}, \\mathrm{m}, \\mathrm{m}, \\mathrm{m})$：\n1. 中纬度混合斜压-正压情况：$(1.0\\times 10^{-4}, 5.0\\times 10^{-4}, 0.20, 500, 0.15, 0.10)$。\n2. 仅正压强迫情况（水平均匀密度，非零SSH梯度）：$(1.0\\times 10^{-4}, 5.0\\times 10^{-4}, 0.00, 500, 0.20, 0.00)$。\n3. 近赤道情况（小 $f$）：$(1.0\\times 10^{-6}, 5.0\\times 10^{-4}, 0.10, 300, 0.05, 0.15)$。\n4. 均匀场情况（无水平梯度）：$(1.0\\times 10^{-4}, 5.0\\times 10^{-4}, 0.00, 500, 0.00, 0.00)$。\n\n您的程序必须生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$，其中每个 $\\text{result}_i$ 是相应测试用例的 $r$ 值，以 $\\mathrm{m\\,s^{-2}}$ 为单位表示。",
            "solution": "该问题要求在一个离散的矩形海洋区域内，根据指定的密度和海面高度场，构建地转和静力平衡的速度场。数值构建的一致性将通过计算静力残差和地转残差来评估。\n\n其控制物理基于旋转参考系中Boussinesq流体动量方程的简化形式。对于大尺度、缓变的海洋流，垂直动量方程简化为静力平衡，水平动量方程简化为地转平衡。\n\n静力平衡将垂直压力梯度与当地流体密度 $\\rho$ 和重力加速度 $g$ 联系起来：\n$$\n\\frac{\\partial p}{\\partial z} = -g\\rho\n$$\n这里，$p$ 是压力，$z$ 是垂直坐标，向上为正。\n\n地转平衡将水平速度分量 $(u, v)$ 与水平压力梯度和科里奥利参数 $f$ 联系起来。在Boussinesq近似下，即在惯性项中忽略密度变化，该平衡表示为：\n$$\n-f v = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x}\n$$\n$$\nf u = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y}\n$$\n其中 $\\rho_0$ 是一个常数参考密度。这些方程可以重新整理以求解速度分量：\n$$\nu(x,y,z) = -\\frac{1}{\\rho_0 f} \\frac{\\partial p}{\\partial y}\n$$\n$$\nv(x,y,z) = \\frac{1}{\\rho_0 f} \\frac{\\partial p}{\\partial x}\n$$\n\n求解算法按构造顺序进行，将这些连续方程转化为离散的数值实现。\n\n**1. 区域离散化与场初始化**\n\n区域是一个由 $x \\in [0, L_x]$、$y \\in [0, L_y]$ 和 $z \\in [-H, 0]$ 定义的矩形盒子。该区域使用具有 $N_x, N_y, N_z$ 个点的均匀网格进行离散化。网格间距为 $\\Delta x = L_x / N_x$、$\\Delta y = L_y / N_y$ 和 $\\Delta z = H / (N_z - 1)$。网格坐标为：\n- $x_i = i \\Delta x$，对于 $i=0, \\dots, N_x-1$\n- $y_j = j \\Delta y$，对于 $j=0, \\dots, N_y-1$\n- $z_k = -H + k \\Delta z$，对于 $k=0, \\dots, N_z-1$\n\n在该网格上，根据提供的公式为每个测试用例定义密度场 $\\rho(x,y,z)$ 和海面高度 $\\eta(x,y)$：\n$$\n\\rho(x_i, y_j, z_k) = (\\rho_0 - s z_k) + b \\cos\\!\\left(\\frac{2\\pi x_i}{L_x}\\right)\\cos\\!\\left(\\frac{2\\pi y_j}{L_y}\\right)\\exp\\!\\left(\\frac{z_k}{H_s}\\right)\n$$\n$$\n\\eta(x_i, y_j) = A_\\eta \\sin\\!\\left(\\frac{2\\pi y_j}{L_y}\\right) + B_\\eta \\cos\\!\\left(\\frac{2\\pi x_i}{L_x}\\right)\n$$\n\n**2. 静力压力重构**\n\n压力场 $p(x,y,z)$ 通过从海面开始向下积分静力方程来计算。海面（$z=0$，对应于索引 $k=N_z-1$）的压力由海面高度异常 $\\eta(x,y)$ 决定，代表正压压力贡献：\n$$\np(x_i, y_j, z_{N_z-1}) = \\rho_0 g \\eta(x_i, y_j)\n$$\n我们从海面向下积分方程 $\\partial p / \\partial z = -g\\rho$。使用二阶精度的梯形法则离散化积分 $\\int_{z_k}^{z_{k+1}} dp = \\int_{z_k}^{z_{k+1}} (-g\\rho) dz'$ 得到：\n$$\np_{k+1} - p_k = -g \\frac{\\rho_{k+1} + \\rho_k}{2} (z_{k+1} - z_k) = -g \\frac{\\rho_{k+1} + \\rho_k}{2} \\Delta z\n$$\n重新整理以从上层 $k+1$ 计算下层 $k$ 的压力，得到迭代公式：\n$$\np_{i,j,k} = p_{i,j,k+1} + \\frac{g \\Delta z}{2} \\left[ \\rho_{i,j,k+1} + \\rho_{i,j,k} \\right]\n$$\n此计算从 $k$ 等于 $N_z-2$ 向下执行到 $0$，从而填充整个三维压力场。\n\n**3. 地转速度计算**\n\n建立压力场后，根据地转关系计算水平速度分量 $(u,v)$。水平压力梯度使用二阶中心差分进行近似。考虑到 $x$ 和 $y$ 方向的周期性边界条件，离散导数为：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j,k} = \\frac{p_{i+1, j, k} - p_{i-1, j, k}}{2\\Delta x}\n$$\n$$\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j,k} = \\frac{p_{i, j+1, k} - p_{i, j-1, k}}{2\\Delta y}\n$$\n指数按周期性处理，例如 $p_{-1,j,k} = p_{N_x-1,j,k}$ 和 $p_{N_x,j,k} = p_{0,j,k}$。那么，每个网格点上的地转速度为：\n$$\nu_{i,j,k} = -\\frac{1}{\\rho_0 f} \\frac{p_{i,j+1,k} - p_{i,j-1,k}}{2\\Delta y}\n$$\n$$\nv_{i,j,k} = \\frac{1}{\\rho_0 f} \\frac{p_{i+1,j,k} - p_{i-1,j,k}}{2\\Delta x}\n$$\n这些计算在所有网格点 $(i, j, k)$ 上执行。\n\n**4. 残差计算**\n\n最后，我们通过计算两个残差来量化我们数值方案的一致性。\n\n静力残差 $r_h$ 衡量当使用与积分方案（梯形法则）不同的差分格式（中心差分）计算导数时，计算出的压力场在多大程度上满足静力方程。它在内部垂直层（$k=1, \\dots, N_z-2$）上计算：\n$$\n\\left(\\frac{\\partial p}{\\partial z}\\right)_{i,j,k}^{\\text{CD}} = \\frac{p_{i,j,k+1} - p_{i,j,k-1}}{2\\Delta z}\n$$\n$$\nr_h = \\max_{i,j,k \\in \\text{interior}} \\left| \\frac{p_{i,j,k+1} - p_{i,j,k-1}}{2\\Delta z} + g \\rho_{i,j,k} \\right| \\Big/ \\rho_0\n$$\n该残差的非零值是截断误差的直接度量，预计该误差与 $\\Delta z^2$ 和密度的二阶垂直导数成正比。\n\n地转残差 $r_g$ 衡量计算出的速度和压力场在多大程度上满足地转平衡。\n$$\nr_g = \\max_{i,j,k} \\left\\{ \\left[ -f v_{i,j,k} + \\frac{1}{\\rho_0}\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j,k} \\right]^2 + \\left[ f u_{i,j,k} + \\frac{1}{\\rho_0}\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j,k} \\right]^2 \\right\\}^{1/2}\n$$\n由于速度 $(u,v)$ 是使用与残差公式中出现的压力梯度相同的中心差分算子明确定义的，因此方括号内的项将达到机器精度级别的零。因此，我们预计 $r_g \\approx 0$。\n\n每个测试用例最终报告的值是 $r = \\max(r_h, r_g)$。鉴于 $r_g$ 预计可以忽略不计，结果将由静力残差主导，$r=r_h$。这可作为对静力积分和数值微分正确实现的验证。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_residuals(f, s, b, Hs, A_eta, B_eta):\n    \"\"\"\n    Constructs geostrophic velocity fields and computes consistency residuals\n    for a given set of physical parameters.\n    \"\"\"\n    # 1. Domain and Constants\n    Lx, Ly, H = 1e5, 1e5, 1e3\n    Nx, Ny, Nz = 64, 64, 80\n    g = 9.81\n    rho0 = 1025.0\n\n    # 2. Grid Discretization\n    dx = Lx / Nx\n    dy = Ly / Ny\n    dz = H / (Nz - 1)\n\n    x_vec = np.linspace(0, Lx, Nx, endpoint=False)\n    y_vec = np.linspace(0, Ly, Ny, endpoint=False)\n    z_vec = np.linspace(-H, 0, Nz)\n\n    # Use 'ij' indexing for (x, y, z) to match array dimensions (Nx, Ny, Nz)\n    x, y, z = np.meshgrid(x_vec, y_vec, z_vec, indexing='ij')\n\n    # 3. Define Density and SSH fields\n    # Stratification component\n    rho_strat = rho0 + s * (-z)\n    \n    # Anomaly component\n    rho_anom = b * np.cos(2 * np.pi * x / Lx) * np.cos(2 * np.pi * y / Ly) * np.exp(z / Hs)\n    \n    # Full density field\n    rho = rho_strat + rho_anom\n    \n    # SSH field (note: z is 3D, we need a 2D grid for eta)\n    x_2d, y_2d = np.meshgrid(x_vec, y_vec, indexing='ij')\n    eta = A_eta * np.sin(2 * np.pi * y_2d / Ly) + B_eta * np.cos(2 * np.pi * x_2d / Lx)\n\n    # 4. Pressure Calculation (Hydrostatic Integration)\n    p = np.zeros_like(rho)\n    \n    # Surface boundary condition (at k = Nz-1)\n    p[:, :, -1] = rho0 * g * eta\n    \n    # Integrate downwards from z=0 using the trapezoidal rule\n    for k in range(Nz - 2, -1, -1):\n        p[:, :, k] = p[:, :, k + 1] + (g * dz / 2.0) * (rho[:, :, k] + rho[:, :, k + 1])\n\n    # 5. Velocity Calculation (Geostrophic Balance)\n    # Note: For case 3, f is small, but non-zero, so division is safe.\n    \n    # Central difference for dp/dx with periodic boundaries\n    dp_dx = (np.roll(p, -1, axis=0) - np.roll(p, 1, axis=0)) / (2 * dx)\n    \n    # Central difference for dp/dy with periodic boundaries\n    dp_dy = (np.roll(p, -1, axis=1) - np.roll(p, 1, axis=1)) / (2 * dy)\n    \n    u = -1.0 / (rho0 * f) * dp_dy\n    v =  1.0 / (rho0 * f) * dp_dx\n    \n    # 6. Residual Calculation\n    # 6.1. Hydrostatic Residual (rh)\n    # Central difference for dp/dz in the interior\n    p_interior = p[:, :, 1:-1]\n    rho_interior = rho[:, :, 1:-1]\n    dp_dz_cd = (p[:, :, 2:] - p[:, :, :-2]) / (2 * dz)\n    \n    hydrostatic_residual_field = np.abs(dp_dz_cd + g * rho_interior) / rho0\n    r_h = np.max(hydrostatic_residual_field)\n\n    # 6.2. Geostrophic Residual (rg)\n    # The pressure gradients dp_dx and dp_dy are the same as used for u and v.\n    # The residual terms are constructed to be numerically zero by definition.\n    res_g_x = -f * v + (1.0 / rho0) * dp_dx\n    res_g_y =  f * u + (1.0 / rho0) * dp_dy\n    \n    geostrophic_residual_field = np.sqrt(res_g_x**2 + res_g_y**2)\n    r_g = np.max(geostrophic_residual_field)\n\n    # For case 4 (uniform fields), all gradients are zero, so u, v are zero.\n    # The Coriolis parameter f is non-zero, but this does not cause issues.\n    # If f were zero, the definition of geostrophy would break down, but the test cases avoid this.\n    if f == 0:\n        # This case is not tested, but as a safeguard:\n        r_g = np.max(np.sqrt(((1/rho0)*dp_dx)**2 + ((1/rho0)*dp_dy)**2))\n\n    # 7. Final Result\n    return max(r_h, r_g)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple: (f, s, b, Hs, A_eta, B_eta)\n    test_cases = [\n        (1.0e-4, 5.0e-4, 0.20, 500, 0.15, 0.10),\n        (1.0e-4, 5.0e-4, 0.00, 500, 0.20, 0.00),\n        (1.0e-6, 5.0e-4, 0.10, 300, 0.05, 0.15),\n        (1.0e-4, 5.0e-4, 0.00, 500, 0.00, 0.00),\n    ]\n\n    results = []\n    for case in test_cases:\n        f, s, b, Hs, A_eta, B_eta = case\n        \n        # Handle the special case where horizontal gradients are zero\n        if b == 0.0 and A_eta == 0.0 and B_eta == 0.0:\n            results.append(0.0) # r_h and r_g will be numerically zero\n            continue\n            \n        result = calculate_residuals(f, s, b, Hs, A_eta, B_eta)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然地转平衡描述了海洋的大尺度稳定状态，但海洋中充满了各种瞬变运动。当流体质点偏离平衡位置时，最纯粹的运动形式便是惯性振荡。本练习在一个简化的海洋混合层“板”模型中探讨这种振荡，并引入了由摩擦引起的现实阻尼效应，您将推导出其解析解，以理解旋转如何设定振荡频率，而摩擦又如何导致其衰减。",
            "id": "3815732",
            "problem": "考虑一个位于 $f$ 平面上的水平均匀海洋混合层，其厚度 $h$ 均一，科里奥利参数为 $f$。假设混合层内的速度 $(u,v)$ 在该层中垂直均一，且下方的海洋层是静止的。从旋转参考系中的 Newton 第二定律出发，并将动量方程沿深度积分，将混合层底部的湍流切变和层内未解析的摩擦的净效应模拟为线性拖曳项。具体来说，将底部的界面切应力参数化为 $\\boldsymbol{\\tau}_{b}=\\rho\\,\\gamma\\,\\boldsymbol{u}$，其中 $\\rho$ 是海水密度，$\\gamma$ 是一个单位为 $\\mathrm{m\\,s^{-1}}$ 的常数；并将混合层内部摩擦表示为 $-\\rho h r_{v}\\boldsymbol{u}$，其中 $r_{v}$ 是一个单位为 $\\mathrm{s^{-1}}$ 的常数。忽略所有水平压力梯度和外力强迫。\n\n使用这个带有线性拖曳的板层模型，推导 $(u(t),v(t))$ 的闭合形式时间相关解，并确定由切变和摩擦共同作用引起的速度振幅的 e-折时间。然后，使用以下物理上合理的参数估算 e-折时间：混合层深度 $h=40\\,\\mathrm{m}$，界面切变系数 $\\gamma=1.2\\times 10^{-4}\\,\\mathrm{m\\,s^{-1}}$，内部摩擦率 $r_{v}=1.8\\times 10^{-6}\\,\\mathrm{s^{-1}}$，以及科里奥利参数 $f=1.1\\times 10^{-4}\\,\\mathrm{s^{-1}}$。假设初始条件为 $u(0)=U_{0}$ 和 $v(0)=0$，其中 $U_{0}\\neq 0$ 为任意值。\n\n将最终的 e-折时间以小时为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "适用的基本原理是在均匀旋转参考系中应用的 Newton 第二定律。对于一个厚度为 $h$、流动水平均匀的深度均一板层，在 $f$ 平面上的深度积分动量方程可以写为\n$$\n\\rho h \\frac{d\\boldsymbol{u}}{dt} + \\rho h\\, f\\, \\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}\n= \\boldsymbol{\\tau}_{s} - \\boldsymbol{\\tau}_{b} - \\rho h\\, r_{v}\\,\\boldsymbol{u},\n$$\n其中 $\\boldsymbol{u}=(u,v)$ 是水平速度，$\\hat{\\boldsymbol{k}}$ 是垂直单位向量，$\\boldsymbol{\\tau}_{s}$ 是表面应力，$\\boldsymbol{\\tau}_{b}$ 是混合层底部的界面应力，$r_{v}$ 是线性内部摩擦率。在这里提出的无强迫惯性衰减问题中，我们设置 $\\boldsymbol{\\tau}_{s}=\\boldsymbol{0}$。界面切应力被参数化为 $\\boldsymbol{\\tau}_{b}=\\rho\\,\\gamma\\,\\boldsymbol{u}$，其中 $\\gamma$ 为常数。两边同除以 $\\rho h$ 并代入参数化表达式，得到\n$$\n\\frac{d\\boldsymbol{u}}{dt} + f\\, \\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}\n= -\\left(\\frac{\\gamma}{h} + r_{v}\\right)\\boldsymbol{u}.\n$$\n定义总线性阻尼率\n$$\nr \\equiv r_{v} + \\frac{\\gamma}{h},\n$$\n并明确写出其分量形式，我们得到耦合线性系统\n$$\n\\frac{d u}{dt} - f v = - r u, \\qquad\n\\frac{d v}{dt} + f u = - r v.\n$$\n将此系统改写为复数形式会很方便。定义 $w(t) \\equiv u(t) + i v(t)$。利用 $\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u} = (-v,u)$ 和上述恒等式，该系统变为一个单一的一阶常微分方程\n$$\n\\frac{d w}{dt} + (r + i f)\\, w = 0.\n$$\n这可以通过将第一个方程与第二个方程乘以 $i$ 后的结果相加得到：\n\\begin{align*}\n\\frac{d u}{dt} - f v = - r u, \\\\\ni\\left(\\frac{d v}{dt} + f u\\right) = - i r v,\n\\end{align*}\n求和可得\n$$\n\\frac{d}{dt}(u + i v) + i f (u + i v) = - r (u + i v),\n$$\n即\n$$\n\\frac{d w}{dt} = - (r + i f)\\, w.\n$$\n这个线性齐次方程有闭合形式解\n$$\nw(t) = w(0)\\, \\exp\\!\\big(- (r + i f)\\, t\\big).\n$$\n取模以获得速度振幅，\n$$\n|w(t)| = |w(0)|\\, \\exp(- r t).\n$$\n因此，速度振幅的 e-折时间，记为 $\\tau_{e}$，是使得 $|w(t)|/|w(0)| = \\exp(-1)$ 的时间，由此得出\n$$\n\\tau_{e} = \\frac{1}{r} = \\frac{1}{r_{v} + \\gamma/h}.\n$$\n此表达式量化了由切变（通过 $\\gamma/h$）和内部摩擦（$r_{v}$）共同引起的阻尼。\n\n我们现在使用给定的参数估算 $\\tau_{e}$。首先计算总阻尼率：\n$$\nr = r_{v} + \\frac{\\gamma}{h}\n= \\left(1.8\\times 10^{-6}\\,\\mathrm{s^{-1}}\\right) + \\frac{1.2\\times 10^{-4}\\,\\mathrm{m\\,s^{-1}}}{40\\,\\mathrm{m}}\n= 1.8\\times 10^{-6}\\,\\mathrm{s^{-1}} + 3.0\\times 10^{-6}\\,\\mathrm{s^{-1}}\n= 4.8\\times 10^{-6}\\,\\mathrm{s^{-1}}.\n$$\n因此，\n$$\n\\tau_{e} = \\frac{1}{4.8\\times 10^{-6}\\,\\mathrm{s^{-1}}}\n= 2.0833333\\times 10^{5}\\,\\mathrm{s}.\n$$\n使用 $1\\,\\mathrm{hour} = 3600\\,\\mathrm{s}$ 将其转换为小时，\n$$\n\\tau_{e,\\mathrm{hours}} = \\frac{2.0833333\\times 10^{5}\\,\\mathrm{s}}{3600\\,\\mathrm{s\\,hour^{-1}}}\n= 57.870370\\ldots\\,\\mathrm{hours}.\n$$\n四舍五入到四位有效数字，e-折时间为\n$$\n57.87\\,\\mathrm{hours}.\n$$\n请注意，惯性频率 $f$ 控制振荡周期，而阻尼率 $r$ 决定指数衰减；对于此线性系统，e-折时间仅取决于 $r$，与 $f$ 和初始振幅 $U_{0}$ 无关。",
            "answer": "$$\\boxed{57.87}$$"
        },
        {
            "introduction": "除了分析力的平衡或简单的振荡，我们还可以从动量方程中推导出强大的守恒定律。对于大尺度旋转流体，其中最重要的便是位势涡度（Potential Vorticity, PV）守恒。本练习将引导您为一个浅水系统推导位势涡度，然后应用此守恒定律来理解流体厚度的变化（拉伸或压缩）如何强制其相对涡度发生改变。掌握位势涡度是理解涡旋生成、西边界流以及流动与地形相互作用等众多地球物理流体动力学现象的关键。",
            "id": "3815711",
            "problem": "考虑一个位于旋转坐标系中 $f$ 平面上的无粘性单层浅水海洋，其科里奥利参数 $f$ 为常数。我们识别一个物质流体柱，其水平流动由旋转坐标系中的动量方程和质量守恒定律描述。不存在外力矩、摩擦应力以及非绝热效应。自由面位移可以内部调整，但没有外部强迫。该流体柱初始层厚为 $h_0$，相对涡度为 $\\zeta_0$。在短时间间隔内，该流体柱经历纯粹的垂直拉伸，使其厚度变为 $h_1 = \\lambda h_0$，其中 $\\lambda > 0$ 是一个给定的因子，且在此过程中没有外力矩作用。\n\n从适用于此背景的基本定律——即旋转坐标系中针对水平动量的牛顿第二定律和针对该层的质量守恒定律——出发，推导由绝对涡度和层厚度构成的、与浅水动力学相关的物质守恒标量。利用此推导，计算当流体柱如所述拉伸因子 $\\lambda$ 时位涡（PV）的变化量（记为 $\\Delta q = q_1 - q_0$）的解析表达式，然后确定最终的相对涡度 $\\zeta_1$（用 $\\lambda$、$\\zeta_0$ 和 $f$ 表示）。将你的最终答案表示为一个双分量行矩阵，其中依次包含 $\\Delta q$ 的值和 $\\zeta_1$ 的表达式。此外，推断北半球相对涡度变化的符号。\n\n不需要数值近似；请提供精确的解析表达式。如果在任何中间推理中引入角度，请以弧度表示。最终表达式中无需包含单位。",
            "solution": "本问题要求推导在 $f$ 平面上单层浅水系统中的守恒量——位涡（PV），然后应用此守恒原理来确定经历垂直拉伸的流体柱的位涡变化量和最终相对涡度。\n\n控制该系统的基本定律是旋转坐标系中无粘性流体的水平动量方程和流体层的质量守恒方程。\n\n水平动量方程为：\n$$\n\\frac{Du}{Dt} - fv = -g \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{Dv}{Dt} + fu = -g \\frac{\\partial \\eta}{\\partial y}\n$$\n其中 $\\mathbf{u} = (u,v)$ 是水平速度矢量，$\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y}$ 是物质导数，$f$ 是常数科里奥利参数，$g$ 是重力加速度，$\\eta$ 是自由面高度。\n\n对于厚度为 $h$ 的浅水层，其质量守恒方程（或连续性方程）为：\n$$\n\\frac{\\partial h}{\\partial t} + \\nabla \\cdot (h\\mathbf{u}) = 0\n$$\n这可以展开为 $\\frac{\\partial h}{\\partial t} + \\mathbf{u} \\cdot \\nabla h + h(\\nabla \\cdot \\mathbf{u}) = 0$，使用物质导数可以表示为：\n$$\n\\frac{Dh}{Dt} + h (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n整理此方程可得到水平散度 $\\nabla \\cdot \\mathbf{u}$ 的关系式：\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{h}\\frac{Dh}{Dt}\n$$\n\n接下来，我们推导涡度方程。相对涡度的垂直分量定义为 $\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。我们对动量方程求旋度，即对 $v$ 方程求 $\\frac{\\partial}{\\partial x}$，再减去对 $u$ 方程求 $\\frac{\\partial}{\\partial y}$。压力梯度项（含 $g\\eta$）相消，得到：\n$$\n\\frac{D}{Dt}\\left(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right) + (\\zeta + f) \\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0\n$$\n用 $\\zeta$ 和水平散度 $\\nabla \\cdot \\mathbf{u}$ 表示，此方程为：\n$$\n\\frac{D\\zeta}{Dt} + (\\zeta + f)(\\nabla \\cdot \\mathbf{u}) = 0\n$$\n由于在 $f$ 平面上 $f$ 是常数，其物质导数为零，即 $\\frac{Df}{Dt} = 0$。因此，我们可以用绝对涡度 $\\omega_a = \\zeta + f$ 来写此方程：\n$$\n\\frac{D(\\zeta+f)}{Dt} + (\\zeta + f)(\\nabla \\cdot \\mathbf{u}) = 0\n$$\n\n现在我们结合连续性方程和涡度方程。从涡度方程，我们有：\n$$\n\\frac{D(\\zeta+f)}{Dt} = -(\\zeta + f)(\\nabla \\cdot \\mathbf{u})\n$$\n代入从整理后的连续性方程得到的 $\\nabla \\cdot \\mathbf{u}$ 表达式：\n$$\n\\frac{D(\\zeta+f)}{Dt} = -(\\zeta + f)\\left(-\\frac{1}{h}\\frac{Dh}{Dt}\\right) = \\frac{\\zeta + f}{h}\\frac{Dh}{Dt}\n$$\n整理此方程得到：\n$$\n\\frac{1}{\\zeta+f}\\frac{D(\\zeta+f)}{Dt} - \\frac{1}{h}\\frac{Dh}{Dt} = 0\n$$\n这可以写成一个对数表达式的物质导数：\n$$\n\\frac{D}{Dt}\\left( \\ln(\\zeta+f) \\right) - \\frac{D}{Dt}\\left( \\ln(h) \\right) = 0\n$$\n$$\n\\frac{D}{Dt}\\left( \\ln\\left(\\frac{\\zeta+f}{h}\\right) \\right) = 0\n$$\n该方程表明量 $\\ln\\left(\\frac{\\zeta+f}{h}\\right)$ 跟随流体质点是守恒的。因此，这个量本身，我们定义为浅水位涡 $q$，是物质守恒的。\n$$\nq = \\frac{\\zeta+f}{h}\n$$\n因此，$\\frac{Dq}{Dt} = 0$。这就是所要求的、由绝对涡度和层厚度构成的物质守恒标量。\n\n问题指出，一个具有初始位涡 $q_0$ 的流体柱演化到一个具有最终位涡 $q_1$ 的状态。因为位涡对于此流体柱是物质守恒的，所以我们必有 $q_1 = q_0$。因此，位涡的变化量 $\\Delta q$ 为：\n$$\n\\Delta q = q_1 - q_0 = 0\n$$\n\n接下来，我们使用该守恒定律来求最终的相对涡度 $\\zeta_1$。初始状态和最终状态通过以下关系联系：\n$$\nq_0 = \\frac{\\zeta_0 + f}{h_0} \\quad \\text{and} \\quad q_1 = \\frac{\\zeta_1 + f}{h_1}\n$$\n令 $q_1 = q_0$：\n$$\n\\frac{\\zeta_1 + f}{h_1} = \\frac{\\zeta_0 + f}{h_0}\n$$\n我们已知流体柱被拉伸，使其新厚度为 $h_1 = \\lambda h_0$。将此代入方程：\n$$\n\\frac{\\zeta_1 + f}{\\lambda h_0} = \\frac{\\zeta_0 + f}{h_0}\n$$\n我们可以消去 $h_0$（因为 $h_0 > 0$）并求解 $\\zeta_1$：\n$$\n\\zeta_1 + f = \\lambda (\\zeta_0 + f)\n$$\n$$\n\\zeta_1 = \\lambda (\\zeta_0 + f) - f\n$$\n$$\n\\zeta_1 = \\lambda \\zeta_0 + (\\lambda - 1)f\n$$\n这就是最终相对涡度的表达式。\n\n最后，我们推断相对涡度变化量 $\\Delta \\zeta = \\zeta_1 - \\zeta_0$ 的符号。\n$$\n\\Delta \\zeta = (\\lambda \\zeta_0 + (\\lambda - 1)f) - \\zeta_0 = (\\lambda - 1)\\zeta_0 + (\\lambda - 1)f\n$$\n$$\n\\Delta \\zeta = (\\lambda - 1)(\\zeta_0 + f)\n$$\n在北半球，科里奥利参数 $f$ 是正的（$f > 0$）。对于大尺度地球物理流体，相对涡度的大小通常远小于行星涡度，即 $|\\zeta_0| \\ll |f|$。因此，在北半球，绝对涡度 $\\zeta_0 + f$ 是正的。问题描述了“垂直拉伸”，这意味着流体柱变高，所以 $h_1 > h_0$，即因子 $\\lambda > 1$。因此，项 $(\\lambda - 1)$ 也是正的。相对涡度的变化量 $\\Delta \\zeta$ 是两个正项的乘积：\n$$\n\\Delta \\zeta = \\underbrace{(\\lambda - 1)}_{>0} \\underbrace{(\\zeta_0 + f)}_{>0} > 0\n$$\n因此，在北半球相对涡度的变化是正的。水柱的拉伸使其以与行星自转相同的方向（气旋式）加速旋转。\n\n最终答案要求一个包含 $\\Delta q$ 和 $\\zeta_1$ 表达式的双分量行矩阵。\n第一个分量是 $\\Delta q = 0$。\n第二个分量是 $\\zeta_1 = \\lambda \\zeta_0 + (\\lambda - 1)f$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\lambda \\zeta_0 + (\\lambda - 1)f \\end{pmatrix}}\n$$"
        }
    ]
}