{
    "hands_on_practices": [
        {
            "introduction": "理解任何近似方法的第一步是量化被忽略的部分。本练习将引导您推导出完整的科里奥利加速度，然后使用真实的海洋速度尺度来计算被忽略的“非传统”项与保留的“传统”项之比。这将为传统近似在大尺度动力学中的应用提供一个具体、数值化的合理解释。",
            "id": "3816580",
            "problem": "海洋中的一个三维速度场在局部东-北-上坐标系中表示为 $\\boldsymbol{u} = (u, v, w)$，其中 $u$ 是东向速度，$v$ 是北向速度，$w$ 是垂直速度。考虑地球上纬度为 $\\phi$ 的一点，地球的自转速率为 $\\Omega$。科里奥利加速度由基本表达式 $-2 \\boldsymbol{\\Omega} \\times \\boldsymbol{u}$ 给出，其中 $\\boldsymbol{\\Omega}$ 是地球的自转矢量。在许多采用传统近似的数值海洋模型中，纬向科里奥利加速度分量 $C_x$ 仅用 $f v$ 项来近似，其中 $f$ 是科里奥利参数。\n\n从 $-2 \\boldsymbol{\\Omega} \\times \\boldsymbol{u}$ 出发，并对纬度为 $\\phi$ 处的 $\\boldsymbol{\\Omega}$ 进行正确的局部东-北-上分解，推导出纬向科里奥利加速度分量 $C_x$ 的精确表达式，该表达式保留了与 $w$ 成正比的贡献（即非传统项）。然后，定义并计算无量纲比\n$$\nR \\equiv \\frac{\\text{非传统项在 } C_x \\text{ 中的大小}}{\\text{传统贡献 } f v \\text{ 的大小}}\n$$\n对于中纬度参数。\n\n使用以下科学上符合实际的中纬度输入参数：\n- $\\phi = 45^\\circ$（在计算三角函数时将角度转换为弧度），\n- $v = 0.50~\\mathrm{m~s^{-1}}$，\n- $w = 1.0 \\times 10^{-4}~\\mathrm{m~s^{-1}}$。\n\n将 $R$ 的最终答案表示为科学记数法形式的无量纲数。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导科里奥利加速度的纬向（东向）分量的精确表达式，然后计算比较该加速度中非传统分量与传统分量的无量纲比。\n\n设纬度 $\\phi$ 处的局部坐标系由一组右手系正交单位矢量 $(\\hat{\\boldsymbol{\\imath}}, \\hat{\\boldsymbol{\\jmath}}, \\hat{\\boldsymbol{k}})$ 定义，分别指向东、北、上。在此坐标系中，三维速度矢量 $\\boldsymbol{u}$ 表示为 $\\boldsymbol{u} = u\\hat{\\boldsymbol{\\imath}} + v\\hat{\\boldsymbol{\\jmath}} + w\\hat{\\boldsymbol{k}}$。\n\n地球的自转矢量 $\\boldsymbol{\\Omega}$ 的大小为 $\\Omega$，方向与地球自转轴平行。在纬度 $\\phi$ 处，该矢量可以分解到局部坐标系中。它在东向没有分量。其在当地子午面上的投影产生一个北向（$\\hat{\\boldsymbol{\\jmath}}$）分量 $\\Omega \\cos\\phi$ 和一个向上（$\\hat{\\boldsymbol{k}}$）分量 $\\Omega \\sin\\phi$。因此，自转矢量为：\n$$\n\\boldsymbol{\\Omega} = 0\\hat{\\boldsymbol{\\imath}} + (\\Omega\\cos\\phi)\\hat{\\boldsymbol{\\jmath}} + (\\Omega\\sin\\phi)\\hat{\\boldsymbol{k}}\n$$\n科里奥利加速度定义为 $\\boldsymbol{C} = -2\\boldsymbol{\\Omega} \\times \\boldsymbol{u}$。我们使用行列式形式计算叉积 $\\boldsymbol{\\Omega} \\times \\boldsymbol{u}$：\n$$\n\\boldsymbol{\\Omega} \\times \\boldsymbol{u} = \\begin{vmatrix}\n\\hat{\\boldsymbol{\\imath}} & \\hat{\\boldsymbol{\\jmath}} & \\hat{\\boldsymbol{k}} \\\\\n0 & \\Omega\\cos\\phi & \\Omega\\sin\\phi \\\\\nu & v & w\n\\end{vmatrix}\n$$\n展开行列式，我们得到：\n$$\n\\boldsymbol{\\Omega} \\times \\boldsymbol{u} = \\hat{\\boldsymbol{\\imath}}((\\Omega\\cos\\phi)(w) - (\\Omega\\sin\\phi)(v)) - \\hat{\\boldsymbol{\\jmath}}((0)(w) - (\\Omega\\sin\\phi)(u)) + \\hat{\\boldsymbol{k}}((0)(v) - (\\Omega\\cos\\phi)(u))\n$$\n$$\n\\boldsymbol{\\Omega} \\times \\boldsymbol{u} = (w\\Omega\\cos\\phi - v\\Omega\\sin\\phi)\\hat{\\boldsymbol{\\imath}} + (u\\Omega\\sin\\phi)\\hat{\\boldsymbol{\\jmath}} - (u\\Omega\\cos\\phi)\\hat{\\boldsymbol{k}}\n$$\n完整的科里奥利加速度矢量 $\\boldsymbol{C}$ 是该结果的 $-2$ 倍：\n$$\n\\boldsymbol{C} = -2 \\left( (w\\Omega\\cos\\phi - v\\Omega\\sin\\phi)\\hat{\\boldsymbol{\\imath}} + (u\\Omega\\sin\\phi)\\hat{\\boldsymbol{\\jmath}} - (u\\Omega\\cos\\phi)\\hat{\\boldsymbol{k}} \\right)\n$$\n$$\n\\boldsymbol{C} = (2v\\Omega\\sin\\phi - 2w\\Omega\\cos\\phi)\\hat{\\boldsymbol{\\imath}} - (2u\\Omega\\sin\\phi)\\hat{\\boldsymbol{\\jmath}} + (2u\\Omega\\cos\\phi)\\hat{\\boldsymbol{k}}\n$$\n纬向科里奥利加速度分量 $C_x$ 是东向（$\\hat{\\boldsymbol{\\imath}}$）的分量。这是要求的第一个表达式。\n$$\nC_x = 2v\\Omega\\sin\\phi - 2w\\Omega\\cos\\phi\n$$\n标准的科里奥利参数定义为 $f = 2\\Omega\\sin\\phi$。将其代入 $C_x$ 的表达式中，我们可以识别出传统和非传统部分：\n$$\nC_x = (2\\Omega\\sin\\phi)v - 2w\\Omega\\cos\\phi = fv - 2w\\Omega\\cos\\phi\n$$\n题目指出，$C_x$ 的传统近似是 $fv$ 项。这是“传统贡献”。剩下的项 $-2w\\Omega\\cos\\phi$ 与垂直速度 $w$ 成正比，是“非传统贡献”。\n\n接下来，我们计算无量纲比 $R$，其定义为非传统贡献的大小除以传统贡献的大小：\n$$\nR \\equiv \\frac{\\text{非传统项在 } C_x \\text{ 中的大小}}{\\text{传统贡献 } f v \\text{ 的大小}} = \\frac{|-2w\\Omega\\cos\\phi|}{|fv|}\n$$\n将 $f = 2\\Omega\\sin\\phi$ 代入分母：\n$$\nR = \\frac{|-2w\\Omega\\cos\\phi|}{|(2\\Omega\\sin\\phi)v|} = \\frac{2\\Omega|w||\\cos\\phi|}{2\\Omega|v||\\sin\\phi|}\n$$\n假设自转速率不为零（$\\Omega \\neq 0$），因子 $2\\Omega$ 被消掉：\n$$\nR = \\frac{|w|}{|v|} \\frac{|\\cos\\phi|}{|\\sin\\phi|} = \\frac{|w|}{|v|} |\\cot\\phi|\n$$\n我们被给予以下中纬度参数进行计算：\n- 纬度 $\\phi = 45^\\circ$\n- 北向速度 $v = 0.50~\\mathrm{m~s^{-1}}$\n- 垂直速度 $w = 1.0 \\times 10^{-4}~\\mathrm{m~s^{-1}}$\n\n由于 $v > 0$，$w > 0$，且对于 $\\phi = 45^\\circ$（位于第一象限），$\\cot\\phi$ 为正，因此可以去掉绝对值符号。\n$$\nR = \\frac{w}{v}\\cot\\phi\n$$\n代入给定的数值：\n$$\nR = \\frac{1.0 \\times 10^{-4}~\\mathrm{m~s^{-1}}}{0.50~\\mathrm{m~s^{-1}}} \\cot(45^\\circ)\n$$\n$\\cot(45^\\circ)$ 的值恰好为 $1$。\n$$\nR = \\frac{1.0 \\times 10^{-4}}{0.50} \\times 1 = 2.0 \\times 10^{-4}\n$$\n问题要求最终答案以科学记数法表示，并四舍五入到四位有效数字。\n$$\nR = 2.000 \\times 10^{-4}\n$$\n这个结果在数值上证实了，对于典型的中纬度海洋条件，纬向科里奥利加速度的非传统分量远小于传统分量，这也为在许多数值模型中实施传统近似提供了理由。",
            "answer": "$$\\boxed{2.000 \\times 10^{-4}}$$"
        },
        {
            "introduction": "在验证了近似的合理性之后，下一步是探索它所产生的动力学行为。本问题通过移除所有其他作用力，分离出简化后科里奥利力的效应。您将推导并求解惯性振荡的方程，这是由传统近似所描述的最基本运动，从而揭示在旋转行星上流体质点所特有的圆周运动模式。",
            "id": "3816634",
            "problem": "考虑一个位于纬度 $\\phi$ 的 $f$ 平面上的水平均匀、不可压缩、密度恒定的海洋，其中科里奥利参数为 $f = 2 \\Omega \\sin \\phi$，$\\Omega$ 是地球的自转角速度。在传统近似（该近似仅保留地球自转的垂直分量，并忽略科里奥利加速度中的水平分量）下，关注在没有气压梯度、垂直运动和摩擦力情况下的流体质点的水平动量。从旋转参考系中的牛顿第二定律和所述近似出发，推导水平速度 $u(t)$（向东）和 $v(t)$（向北）的线性控制方程。\n\n在时间 $t = 0$ 时，施加一个单位质量的水平动量点脉冲，瞬时将速度设定为 $u(0^{+}) = U_{0}$ 和 $v(0^{+}) = 0$，而初始状态为 $u(0^{-}) = 0$ 和 $v(0^{-}) = 0$，其中 $U_{0}$ 是一个给定的恒定振幅。对于 $t > 0$，计算脉冲响应，并求得 $u(t)$ 和 $v(t)$ 随时间演化的闭合形式解析表达式。\n\n请用米/秒表示最终的 $u(t)$ 和 $v(t)$，并将所有三角函数的参数写成弧度。请将最终答案表示为一个仅包含 $U_{0}$、$f$ 和 $t$ 的单行矩阵，其中包含 $u(t)$ 和 $v(t)$，不附带任何额外评注。",
            "solution": "在尝试求解之前，将首先验证该问题，以确保其科学上合理、内容自洽且提法适定。\n\n### 第1步：提取已知条件\n- **系统**：一个水平均匀、不可压缩、密度恒定的海洋。\n- **参考系**：位于纬度 $\\phi$ 的 $f$ 平面。\n- **科里奥利参数**：$f = 2 \\Omega \\sin \\phi$，其中 $\\Omega$ 是地球的自转角速度。\n- **近似**：使用传统近似（科里奥利加速度仅考虑地球自转的垂直分量）。\n- **忽略项**：不存在气压梯度、垂直运动（$w=0$）和摩擦力。\n- **变量**：水平速度为 $u(t)$（向东）和 $v(t)$（向北）。\n- **初始条件**：在 $t=0$ 时，一个单位质量的水平动量点脉冲导致以下条件：\n  - $u(0^{-}) = 0$ 且 $v(0^{-}) = 0$。\n  - $u(0^{+}) = U_{0}$ 且 $v(0^{+}) = 0$，其中 $U_{0}$ 是一个给定的恒定振幅。\n- **目标**：对于 $t > 0$，推导 $u(t)$ 和 $v(t)$ 的线性控制方程，并求出它们的闭合形式解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础**：该问题描述了惯性振荡，这是地球物理流体动力学中的一个基本概念。包括 $f$ 平面近似和传统近似在内的设定，是用于分离这些动力学过程的标准且有效的简化方法。所有原理都植根于经典力学和流体动力学。该问题具有科学依据。\n- **适定性**：任务是求解一个具有指定初始条件的线性一阶常微分方程组。这样的系统存在唯一且稳定的解。该问题是适定的。\n- **客观性**：该问题使用精确、正式的语言和定量条件进行陈述。没有主观或模糊的术语。该问题是客观的。\n- **完整性与一致性**：所有必要信息（控制近似、初始条件、忽略的力）均已提供。设定中没有矛盾之处。\n- **可行性**：这些条件（例如，无摩擦、无气压梯度）是理想化情况，但它们是旨在阐明特定物理原理的教科书式问题的标准设定。它们并不构成会使问题无效的物理不可能性。\n\n### 第3步：结论与行动\n该问题是有效的，因为它在科学上是合理的、适定的、客观的且自洽的。将推导其完整解。\n\n### 解题推导\n\n在旋转参考系中，流体质点的运动由牛顿第二定律描述，其中包括科里奥利加速度。在一个局地坐标系中，$x$ 指向东，$y$ 指向北，$z$ 垂直向上，速度矢量为 $\\boldsymbol{u} = (u, v, w)$，地球的旋转矢量为 $\\boldsymbol{\\Omega} = (0, \\Omega \\cos\\phi, \\Omega \\sin\\phi)$。\n\n科里奥利加速度项由 $-2\\boldsymbol{\\Omega} \\times \\boldsymbol{u}$ 给出。我们来计算这个叉积：\n$$\n-2\\boldsymbol{\\Omega} \\times \\boldsymbol{u} = -2\\begin{vmatrix} \\hat{\\boldsymbol{\\imath}} & \\hat{\\boldsymbol{\\jmath}} & \\hat{\\boldsymbol{k}} \\\\ 0 & \\Omega \\cos \\phi & \\Omega \\sin \\phi \\\\ u & v & w \\end{vmatrix} = -2 \\left( w\\Omega\\cos\\phi - v\\Omega\\sin\\phi \\right) \\hat{\\boldsymbol{\\imath}} -2 \\left( -u\\Omega\\sin\\phi \\right) \\hat{\\boldsymbol{\\jmath}} -2 \\left( -u\\Omega\\cos\\phi \\right) \\hat{\\boldsymbol{k}}\n$$\n科里奥利加速度的分量为：\n- $x$分量：$2v\\Omega\\sin\\phi - 2w\\Omega\\cos\\phi$\n- $y$分量：$-2u\\Omega\\sin\\phi$\n- $z$分量：$2u\\Omega\\cos\\phi$\n\n传统近似忽略了包含地球自转水平分量 $\\Omega\\cos\\phi$ 的项。这在物理上是合理的，因为在大尺度海洋动力学中，水平速度（$u,v$）远大于垂直速度（$w$），而垂直加速度通常由气压梯度和重力之间的平衡（静力平衡）主导。在此近似下，科里奥利加速度的水平分量得到显著简化。\n\n令 $f = 2\\Omega\\sin\\phi$。科里奥利加速度的水平分量变为：\n- $x$分量：$fv$\n- $y$分量：$-fu$\n\n水平动量方程为：\n$$\n\\frac{Du}{Dt} = fv - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} + F_{x}\n$$\n$$\n\\frac{Dv}{Dt} = -fu - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial y} + F_{y}\n$$\n其中 $\\frac{D}{Dt}$ 是物质导数，$\\rho$ 是密度，$p$ 是气压，$F$ 代表摩擦力。\n\n问题陈述中指出，没有气压梯度（$\\nabla p = 0$）和摩擦力（$\\vec{F} = 0$）。物质导数为 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y} + w\\frac{\\partial}{\\partial z}$。问题指明“水平均匀”，这意味着 $\\frac{\\partial}{\\partial x}=0$ 和 $\\frac{\\partial}{\\partial y}=0$。问题还指明“无垂直运动”，所以 $w=0$。因此，物质导数的平流部分 $(u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y} + w\\frac{\\partial}{\\partial z})\\boldsymbol{u}$ 为零。物质导数简化为局地时间导数 $\\frac{d}{dt}$，因为速度仅是时间的函数。\n\n因此，水平速度 $u(t)$ 和 $v(t)$ 的控制方程简化为以下线性系统：\n$$\n\\begin{aligned}\n\\frac{du}{dt} &= fv \\quad (1) \\\\\n\\frac{dv}{dt} &= -fu \\quad (2)\n\\end{aligned}\n$$\n\n为求解该方程组，我们可以将其解耦。对方程(1)关于时间 $t$ 求导：\n$$\n\\frac{d^2u}{dt^2} = f \\frac{dv}{dt}\n$$\n将方程(2)代入此表达式：\n$$\n\\frac{d^2u}{dt^2} = f(-fu) = -f^2 u\n$$\n这就得到了一个关于 $u(t)$ 的二阶线性齐次常微分方程：\n$$\n\\frac{d^2u}{dt^2} + f^2 u = 0\n$$\n这是简谐振子的方程。$u(t)$ 的通解为：\n$$\nu(t) = A \\cos(ft) + B \\sin(ft)\n$$\n其中 $A$ 和 $B$ 是积分常数。\n\n为了求 $v(t)$，我们使用方程(1)：$v = \\frac{1}{f} \\frac{du}{dt}$。\n首先，我们求 $\\frac{du}{dt}$：\n$$\n\\frac{du}{dt} = -Af \\sin(ft) + Bf \\cos(ft)\n$$\n然后，我们求 $v(t)$：\n$$\nv(t) = \\frac{1}{f} \\left( -Af \\sin(ft) + Bf \\cos(ft) \\right) = -A \\sin(ft) + B \\cos(ft)\n$$\n\n现在，我们应用在 $t=0^{+}$ 时的初始条件（对于 $t>0$ 成立的解，我们将其记为 $t=0$）：$u(0) = U_{0}$ 和 $v(0) = 0$。\n对于 $u(t)$：\n$$\nu(0) = A \\cos(0) + B \\sin(0) = A \\cdot 1 + B \\cdot 0 = A\n$$\n因此，$A = U_{0}$。\n\n对于 $v(t)$：\n$$\nv(0) = -A \\sin(0) + B \\cos(0) = -A \\cdot 0 + B \\cdot 1 = B\n$$\n因此，$B = 0$。\n\n将常数 $A=U_{0}$ 和 $B=0$ 的值代回通解，我们得到 $u(t)$ 和 $v(t)$ 的特解：\n$$\nu(t) = U_{0} \\cos(ft)\n$$\n$$\nv(t) = -U_{0} \\sin(ft)\n$$\n这些方程描述了当 $t>0$ 时速度分量的时间演化。这种运动被称为惯性振荡，其中速度矢量以恒定的大小 $|U_{0}|$ 和角频率 $f$ 顺时针旋转（对于北半球 $f>0$ 的情况）。这种振荡的周期是惯性周期，$T = \\frac{2\\pi}{|f|}$。\n速度 $u(t)$ 和 $v(t)$ 的单位与 $U_{0}$ 相同，即速度单位（米/秒）。三角函数的参数 $ft$ 是无量纲的（弧度），符合要求。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} U_{0}\\cos(ft) & -U_{0}\\sin(ft) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然传统近似很有用，但它并非普遍适用。这项高级练习要求您设计一个数值实验，以比较在有无此近似的情况下内重力波的行为。通过分析波的频散关系和群速度，您将能看到该近似如何改变波的传播特性，尤其是在被忽略项变得重要的低纬度地区，这有助于培养计算建模和物理近似批判性分析的能力。",
            "id": "3816621",
            "problem": "您的任务是设计并执行一个可复现的数值实验，该实验在一个适用于计算海洋学的局部笛卡尔坐标系中，比较在均匀层化的Boussinesq流体中，三维内重力波包在传统科里奥利力近似和完整科里奥利力作用下的动力学。您的程序必须实现一个在线性、无粘、不可压缩模型下，在谱（傅里叶）空间中演化的过程，并生成清晰的诊断量，以量化两种动力学处理方式之间的差异。\n\n从以下基本理论出发：\n- 在局部笛卡尔坐标系 $(x,y,z)$ 中，对于旋转、稳定层化的流体，其线性化的Boussinesq方程由速度 $\\mathbf{u}=(u,v,w)$、压强 $p$ 和浮力 $b$ 给出：\n$$\\frac{\\partial \\mathbf{u}}{\\partial t} + 2\\boldsymbol{\\Omega}\\times \\mathbf{u} = -\\nabla p + b\\,\\hat{\\mathbf{z}},$$\n$$\\frac{\\partial b}{\\partial t} + N^2 w = 0,$$\n$$\\nabla\\cdot \\mathbf{u} = 0,$$\n其中 $N$ 是Brunt–Väisälä频率，$\\boldsymbol{\\Omega}$ 是地球的角速度矢量，$\\hat{\\mathbf{z}}$ 是垂直方向的单位矢量。\n- 传统近似（TA）在科里奥利项中仅保留旋转的局地垂直分量 $2\\Omega\\sin\\phi$，其中 $\\Omega$ 是地球的自转速率，$\\phi$ 是纬度（以度为单位的角度；您的程序必须在内部转换为弧度）。完整的科里奥利力同时保留垂直分量 $2\\Omega\\sin\\phi$ 和水平分量 $2\\Omega\\cos\\phi$。\n- 在谱空间中对波数矢量为 $\\mathbf{k}=(k_x,k_y,m)$ 的单个傅里叶模态进行研究，并使用不可压缩投影，通过将右侧项投影到无散子空间上来消除压强。\n\n推导状态矢量 $(u,v,w,b)$ 的谱演化算子，并按如下方式进行数值实现：\n- 定义 $3\\times 3$ 投影矩阵\n$$\\mathbf{P} = \\mathbf{I} - \\hat{\\mathbf{k}}\\,\\hat{\\mathbf{k}}^{\\mathsf{T}},\\quad \\hat{\\mathbf{k}}=\\frac{\\mathbf{k}}{\\lVert \\mathbf{k}\\rVert},$$\n以及线性科里奥利叉乘算子 $\\mathbf{B}$，使得在局部坐标系 $(x,y,z)$ 中 $2\\boldsymbol{\\Omega}\\times \\mathbf{u}=\\mathbf{B}\\,\\mathbf{u}$，其中 $2\\boldsymbol{\\Omega}=(0,2\\Omega\\cos\\phi,2\\Omega\\sin\\phi)$。具体地，使用\n$$\\mathbf{B}=\\begin{pmatrix}\n0 & -f_v & f_h \\\\\nf_v & 0 & 0 \\\\\n-f_h & 0 & 0\n\\end{pmatrix},\\quad f_v=2\\Omega\\sin\\phi,\\quad f_h=2\\Omega\\cos\\phi,$$\n对于传统近似，设置 $f_h=0$ 同时保留 $f_v$。\n- $3\\times 3$ 速度算子是 $\\mathbf{M}=-\\mathbf{P}\\mathbf{B}$，浮力强迫通过 $\\mathbf{F}_b=\\mathbf{P}\\,\\hat{\\mathbf{z}}$ 进入速度方程。耦合的 $4\\times 4$ 线性算子 $\\mathbf{L}$ 对于 $(u,v,w,b)$ 是\n$$\\mathbf{L}=\\begin{pmatrix}\n\\mathbf{M} & \\mathbf{F}_b \\\\\n\\mathbf{0}_{1\\times 3} & 0\n\\end{pmatrix}\n+\\begin{pmatrix}\n\\mathbf{0}_{3\\times 3} & \\mathbf{0}_{3\\times 1} \\\\\n\\begin{matrix} 0 & 0 & -N^2 \\end{matrix} & 0\n\\end{pmatrix},$$\n这意味着\n$$\\frac{d}{dt}\\begin{pmatrix} u \\\\ v \\\\ w \\\\ b \\end{pmatrix} = \\mathbf{L}\\begin{pmatrix} u \\\\ v \\\\ w \\\\ b \\end{pmatrix}。$$\n\n设计一个以中心波数 $\\mathbf{k}_0=(k_{0x},k_{0y},m_0)$ 为特征的波包，并通过分析内重力波的本征频率及其相对于波数的梯度来量化以下诊断量：\n- 对于传统近似和完整科里奥利算子，从 $\\mathbf{L}$ 的谱中提取正的内重力波本征频率 $\\omega(\\mathbf{k}_0)$。计算频率差\n$$\\Delta\\omega = \\left\\lvert\\omega_{\\mathrm{full}}(\\mathbf{k}_0)-\\omega_{\\mathrm{TA}}(\\mathbf{k}_0)\\right\\rvert\\quad\\text{单位：}\\ \\mathrm{s^{-1}}。$$\n- 对两种模型，使用中心有限差分法估算群速度 $\\mathbf{c}_g(\\mathbf{k}_0)=\\nabla_{\\mathbf{k}}\\omega(\\mathbf{k}_0)$，波数增量等于由区域尺寸决定的基本谱间距 $\\delta k_x=2\\pi/L_x$，$\\delta k_y=2\\pi/L_y$ 和 $\\delta m=2\\pi/L_z$。计算群速度差异的模\n$$\\Delta c_g = \\left\\lVert \\mathbf{c}_{g,\\mathrm{full}}(\\mathbf{k}_0) - \\mathbf{c}_{g,\\mathrm{TA}}(\\mathbf{k}_0)\\right\\rVert\\quad\\text{单位：}\\ \\mathrm{m/s}。$$\n- 计算群速度的水平与垂直各向异性比\n$$R=\\frac{\\sqrt{c_{g,x}^2+c_{g,y}^2}}{\\lvert c_{g,z}\\rvert},$$\n对两种模型都进行计算，并报告无量纲比值 $R_{\\mathrm{full}}/R_{\\mathrm{TA}}$。\n\n您的数值实验必须由以下每个测试案例的域和分辨率，以及中心波数和层化频率完全指定。角度以度为单位提供，必须在内部转换为弧度。使用地球自转速率 $\\Omega=7.2921159\\times 10^{-5}\\ \\mathrm{s^{-1}}$。每个测试案例的最终输出必须是三个浮点数：$\\Delta\\omega$（单位 $\\mathrm{s^{-1}}$），$\\Delta c_g$（单位 $\\mathrm{m/s}$），以及 $R_{\\mathrm{full}}/R_{\\mathrm{TA}}$（无量纲）。将每个值打印并四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 1（近赤道，非传统效应最强）：\n  - 纬度 $\\phi=0^\\circ$，\n  - 层化频率 $N=1.0\\times 10^{-3}\\ \\mathrm{s^{-1}}$，\n  - 区域尺寸 $L_x=160{,}000\\ \\mathrm{m}$，$L_y=160{,}000\\ \\mathrm{m}$，$L_z=4{,}000\\ \\mathrm{m}$，\n  - 分辨率 $N_x=64$，$N_y=64$，$N_z=64$，\n  - 中心波数分量 $k_{0x}=2\\pi/(20{,}000\\ \\mathrm{m})$，$k_{0y}=2\\pi/(40{,}000\\ \\mathrm{m})$，$m_0=2\\pi/(500\\ \\mathrm{m})$。\n- 案例 2（中纬度）：\n  - 纬度 $\\phi=45^\\circ$，\n  - 层化频率 $N=1.2\\times 10^{-3}\\ \\mathrm{s^{-1}}$，\n  - 区域尺寸 $L_x=200{,}000\\ \\mathrm{m}$，$L_y=200{,}000\\ \\mathrm{m}$，$L_z=5{,}000\\ \\mathrm{m}$，\n  - 分辨率 $N_x=64$，$N_y=64$，$N_z=64$，\n  - 中心波数分量 $k_{0x}=2\\pi/(30{,}000\\ \\mathrm{m})$，$k_{0y}=2\\pi/(30{,}000\\ \\mathrm{m})$，$m_0=2\\pi/(1{,}000\\ \\mathrm{m})$。\n- 案例 3（高纬度）：\n  - 纬度 $\\phi=80^\\circ$，\n  - 层化频率 $N=8.0\\times 10^{-4}\\ \\mathrm{s^{-1}}$，\n  - 区域尺寸 $L_x=150{,}000\\ \\mathrm{m}$，$L_y=150{,}000\\ \\mathrm{m}$，$L_z=3{,}000\\ \\mathrm{m}$，\n  - 分辨率 $N_x=48$，$N_y=48$，$N_z=48$，\n  - 中心波数分量 $k_{0x}=2\\pi/(50{,}000\\ \\mathrm{m})$，$k_{0y}=2\\pi/(25{,}000\\ \\mathrm{m})$，$m_0=2\\pi/(300\\ \\mathrm{m})$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个案例的结果，格式为逗号分隔的列表的列表，每个内部列表按顺序包含三个诊断量 $[\\Delta\\omega,\\Delta c_g,R_{\\mathrm{full}}/R_{\\mathrm{TA}}]$，每个数字四舍五入到 $6$ 位小数，并用方括号括起来。例如，打印的行应如下所示\n$$[[0.000123,0.012345,1.234567],[...],[...]]。$$",
            "solution": "用户提供的问题是有效的。它在科学上基于地球物理流体动力学原理，特别是关于科里奥利力影响下的内重力波研究。该问题是适定的，提供了完整的数学框架和所有必要的参数来计算一个唯一的、可验证的解。任务是客观的，其方法基于谱分析和数值微分，是计算物理学中的标准方法。\n\n求解过程如下：首先，我们为线性化、无粘、不可压缩的Boussinesq方程的单个傅里叶模态构建线性演化算子 $\\mathbf{L}$。该算子的形式取决于使用的是完整科里奥利力还是传统近似。其次，我们通过计算 $\\mathbf{L}$ 的特征值来找到内重力波模态的本征频率 $\\omega$。第三，我们使用中心有限差分格式数值估算群速度 $\\mathbf{c}_g = \\nabla_{\\mathbf{k}}\\omega$。最后，我们针对代表赤道、中纬度和高纬度海洋条件的三个不同测试案例，计算指定的诊断量——频率差 $\\Delta\\omega$、群速度差的模 $\\Delta c_g$ 和群速度各向异性比 $R_{\\mathrm{full}}/R_{\\mathrm{TA}}$。\n\n对于波数矢量为 $\\mathbf{k}=(k_x, k_y, m)$ 的单个傅里叶模态，流体的状态由速度和浮力的复振幅描述，形成一个状态矢量 $\\hat{\\boldsymbol{\\psi}} = (\\hat{u}, \\hat{v}, \\hat{w}, \\hat{b})^{\\mathsf{T}}$。其时间演化由一个线性常微分方程组控制：\n$$ \\frac{d}{dt}\\hat{\\boldsymbol{\\psi}} = \\mathbf{L} \\hat{\\boldsymbol{\\psi}} $$\n$4 \\times 4$ 矩阵算子 $\\mathbf{L}$ 包含了动力学过程。我们按照问题的规定构建它。科里奥利力在动量方程中表现为 $2\\boldsymbol{\\Omega}\\times \\mathbf{u}$ 项。在我们的局部笛卡尔坐标系中，地球的旋转矢量是 $2\\boldsymbol{\\Omega} = (0, f_h, f_v)$，其中 $f_v = 2\\Omega\\sin\\phi$ 是垂直分量（行星涡度），$f_h = 2\\Omega\\cos\\phi$ 是水平分量。这里，$\\Omega$ 是地球的自转速率，$\\phi$ 是纬度。叉乘由矩阵 $\\mathbf{B}$ 表示：\n$$ 2\\boldsymbol{\\Omega}\\times \\mathbf{u} = \\begin{pmatrix} 0 & -f_v & f_h \\\\ f_v & 0 & 0 \\\\ -f_h & 0 & 0 \\end{pmatrix} \\begin{pmatrix} u \\\\ v \\\\ w \\end{pmatrix} = \\mathbf{B}\\mathbf{u} $$\n传统近似（TA）在于忽略旋转的水平分量，这等效于设置 $f_h=0$。这种近似对于具有大纵横比（水平尺度远大于垂直尺度）的运动是有效的，但对于亚中尺度现象或在赤道附近则会失效。\n\n不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$ 在傅里叶空间中变为 $i\\mathbf{k} \\cdot \\hat{\\mathbf{u}} = 0$。这是通过将动量方程的右侧项投影到无散子空间（即垂直于波数矢量 $\\mathbf{k}$ 的平面）上来实现的。投影算子是 $\\mathbf{P} = \\mathbf{I} - \\hat{\\mathbf{k}}\\hat{\\mathbf{k}}^{\\mathsf{T}}$，其中 $\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵，$\\hat{\\mathbf{k}} = \\mathbf{k}/\\lVert\\mathbf{k}\\rVert$ 是单位波数矢量。\n\n投影后的动量方程变为：\n$$ \\frac{\\partial \\hat{\\mathbf{u}}}{\\partial t} = -\\mathbf{P}(\\mathbf{B}\\hat{\\mathbf{u}}) + \\mathbf{P}(b\\,\\hat{\\mathbf{z}}) = \\mathbf{M}\\hat{\\mathbf{u}} + \\mathbf{F}_b \\hat{b} $$\n其中 $\\mathbf{M} = -\\mathbf{P}\\mathbf{B}$ 是 $3 \\times 3$ 速度算子，$\\mathbf{F}_b = \\mathbf{P}\\hat{\\mathbf{z}}$ 是速度子空间中的浮力强迫矢量。浮力方程是 $\\partial \\hat{b}/\\partial t = -N^2 \\hat{w}$。将这些组合起来，我们组装出完整的 $4 \\times 4$ 算子 $\\mathbf{L}$：\n$$ \\mathbf{L} = \\begin{pmatrix} M_{11} & M_{12} & M_{13} & F_{b,1} \\\\ M_{21} & M_{22} & M_{23} & F_{b,2} \\\\ M_{31} & M_{32} & M_{33} & F_{b,3} \\\\ 0 & 0 & -N^2 & 0 \\end{pmatrix} $$\n形如 $\\hat{\\boldsymbol{\\psi}}(t) = \\hat{\\boldsymbol{\\psi}}_0 e^{\\lambda t}$ 的波状解存在，当且仅当 $\\lambda$ 是 $\\mathbf{L}$ 的一个特征值。对于一个无耗散系统，这些特征值是纯虚数，$\\lambda = \\pm i\\omega$，其中 $\\omega$ 是波的频率。内重力波频率 $\\omega(\\mathbf{k})$ 是通过对给定的 $\\mathbf{k}$ 数值计算 $\\mathbf{L}$ 的特征值，并在特征值的虚部中识别出唯一的正频率来找到的。\n\n群速度 $\\mathbf{c}_g = \\nabla_{\\mathbf{k}}\\omega$ 描述了波包能量的传播速度。我们按照规定，使用二阶中心有限差分公式来估计其分量：\n$$ c_{g,x}(\\mathbf{k}_0) = \\frac{\\partial\\omega}{\\partial k_x}\\bigg|_{\\mathbf{k}_0} \\approx \\frac{\\omega(k_{0x}+\\delta k_x, k_{0y}, m_0) - \\omega(k_{0x}-\\delta k_x, k_{0y}, m_0)}{2\\delta k_x} $$\n类似地，对于 $c_{g,y}$ 和 $c_{g,z}$ 也使用相同的表达式。波数增量 $\\delta k_x$、$\\delta k_y$ 和 $\\delta m$ 分别由指定的区域尺寸 $L_x$、$L_y$ 和 $L_z$ 的基模决定（例如，$\\delta k_x = 2\\pi/L_x$）。\n\n数值实现包括一个主函数，它为每个测试案例计算科里奥利参数（$f_v, f_h$）和波数增量。然后它调用一个核心例程两次：一次用于完整科里奥利模型（$f_h \\neq 0$），一次用于传统近似（$f_h=0$）。这个核心例程为中心波数 $\\mathbf{k}_0$ 以及有限差分格式所需的邻近波数构建算子 $\\mathbf{L}$。它通过特征值分解计算相应的频率，然后组装群速度矢量 $\\mathbf{c}_g(\\mathbf{k}_0)$。最后，主函数计算差异 $\\Delta\\omega$ 和 $\\Delta c_g$，以及各向异性比 $R_{\\mathrm{full}}/R_{\\mathrm{TA}}$，然后返回三个所需的诊断量。对所有提供的测试案例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for all test cases and print the results.\n    \"\"\"\n    OMEGA = 7.2921159e-5  # Earth's rotation rate in rad/s\n\n    test_cases = [\n        {\n            \"phi_deg\": 0, \"N\": 1.0e-3,\n            \"Lx\": 160000, \"Ly\": 160000, \"Lz\": 4000,\n            \"k0x\": 2 * np.pi / 20000, \"k0y\": 2 * np.pi / 40000, \"m0\": 2 * np.pi / 500\n        },\n        {\n            \"phi_deg\": 45, \"N\": 1.2e-3,\n            \"Lx\": 200000, \"Ly\": 200000, \"Lz\": 5000,\n            \"k0x\": 2 * np.pi / 30000, \"k0y\": 2 * np.pi / 30000, \"m0\": 2 * np.pi / 1000\n        },\n        {\n            \"phi_deg\": 80, \"N\": 8.0e-4,\n            \"Lx\": 150000, \"Ly\": 150000, \"Lz\": 3000,\n            \"k0x\": 2 * np.pi / 50000, \"k0y\": 2 * np.pi / 25000, \"m0\": 2 * np.pi / 300\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        results = compute_diagnostics(case, OMEGA)\n        all_results.append([f\"{val:.6f}\" for val in results])\n\n    # Format the final output as a string representing a list of lists.\n    output_str = \"[\" + ','.join([f\"[{','.join(res)}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\ndef compute_diagnostics(params, OMEGA):\n    \"\"\"\n    Computes the diagnostics for a single test case.\n    \"\"\"\n    phi_rad = np.deg2rad(params[\"phi_deg\"])\n    N = params[\"N\"]\n    k0 = np.array([params[\"k0x\"], params[\"k0y\"], params[\"m0\"]])\n    \n    # Fundamental wavenumber spacings for finite differences\n    dk_vec = np.array([\n        2 * np.pi / params[\"Lx\"],\n        2 * np.pi / params[\"Ly\"],\n        2 * np.pi / params[\"Lz\"]\n    ])\n    \n    fv = 2 * OMEGA * np.sin(phi_rad)\n    fh = 2 * OMEGA * np.cos(phi_rad)\n\n    # Calculate diagnostics for the full model\n    omega_full, cg_full, R_full = calculate_wave_properties(k0, dk_vec, N, fv, fh)\n    \n    # Calculate diagnostics for the Traditional Approximation (TA) model\n    omega_TA, cg_TA, R_TA = calculate_wave_properties(k0, dk_vec, N, fv, 0.0)\n    \n    # Compute the final comparative diagnostics\n    delta_omega = np.abs(omega_full - omega_TA)\n    \n    delta_cg_vec = cg_full - cg_TA\n    delta_cg_mag = np.linalg.norm(delta_cg_vec)\n    \n    # Handle potential division by zero if R_TA is zero\n    ratio_R = R_full / R_TA if R_TA != 0 else np.inf\n\n    return delta_omega, delta_cg_mag, ratio_R\n\ndef get_igw_frequency(k, N, fv, fh):\n    \"\"\"\n    Constructs the linear operator L and finds the internal gravity wave frequency.\n    \"\"\"\n    kx, ky, m = k\n    k_norm = np.linalg.norm(k)\n    \n    if k_norm == 0:\n        return 0.0\n    \n    k_hat = k / k_norm\n    \n    # Projection matrix P = I - k_hat . k_hat^T\n    P = np.identity(3) - np.outer(k_hat, k_hat)\n    \n    # Coriolis matrix B\n    B = np.array([\n        [0, -fv, fh],\n        [fv, 0, 0],\n        [-fh, 0, 0]\n    ])\n    \n    # Velocity operator M = -P * B\n    M = -P @ B\n    \n    # Buoyancy forcing vector Fb = P * z_hat\n    z_hat = np.array([0, 0, 1.0])\n    Fb = P @ z_hat\n    \n    # Assemble the 4x4 linear operator L\n    L = np.zeros((4, 4), dtype=np.complex128)\n    L[:3, :3] = M\n    L[:3, 3] = Fb\n    L[3, 2] = -N**2\n    \n    # Eigenvalues of L are lambda = +/- i*omega\n    # Frequencies are |imag(eigenvalues)|\n    eigenvalues = np.linalg.eigvals(L)\n    frequencies = np.abs(np.imag(eigenvalues))\n    \n    # The IGW frequency is the largest non-zero frequency\n    return np.max(frequencies)\n\ndef calculate_wave_properties(k0, dk_vec, N, fv, fh):\n    \"\"\"\n    Calculates omega(k0), cg(k0), and the anisotropy ratio R for a given model.\n    \"\"\"\n    \n    # Central frequency\n    omega0 = get_igw_frequency(k0, N, fv, fh)\n    \n    # Group velocity via centered finite differences\n    cg = np.zeros(3)\n    \n    # x-component\n    kx_plus = k0 + np.array([dk_vec[0], 0, 0])\n    kx_minus = k0 - np.array([dk_vec[0], 0, 0])\n    omega_x_plus = get_igw_frequency(kx_plus, N, fv, fh)\n    omega_x_minus = get_igw_frequency(kx_minus, N, fv, fh)\n    cg[0] = (omega_x_plus - omega_x_minus) / (2 * dk_vec[0])\n    \n    # y-component\n    ky_plus = k0 + np.array([0, dk_vec[1], 0])\n    ky_minus = k0 - np.array([0, dk_vec[1], 0])\n    omega_y_plus = get_igw_frequency(ky_plus, N, fv, fh)\n    omega_y_minus = get_igw_frequency(ky_minus, N, fv, fh)\n    cg[1] = (omega_y_plus - omega_y_minus) / (2 * dk_vec[1])\n    \n    # z-component\n    km_plus = k0 + np.array([0, 0, dk_vec[2]])\n    km_minus = k0 - np.array([0, 0, dk_vec[2]])\n    omega_m_plus = get_igw_frequency(km_plus, N, fv, fh)\n    omega_m_minus = get_igw_frequency(km_minus, N, fv, fh)\n    cg[2] = (omega_m_plus - omega_m_minus) / (2 * dk_vec[2])\n    \n    # Anisotropy ratio R\n    cg_horiz_mag = np.sqrt(cg[0]**2 + cg[1]**2)\n    cg_vert_mag = np.abs(cg[2])\n    \n    R = cg_horiz_mag / cg_vert_mag if cg_vert_mag != 0 else np.inf\n    \n    return omega0, cg, R\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}