{
    "hands_on_practices": [
        {
            "introduction": "Understanding the properties of incompressible flow begins with mastering its mathematical representation. This exercise provides a foundational, hands-on opportunity to construct a classic two-dimensional, divergence-free velocity field—the Taylor-Green vortex—from a scalar streamfunction. By explicitly calculating the divergence and observing its effect on a passive tracer, you will gain a concrete understanding of how the mathematical condition $\\nabla \\cdot \\mathbf{u} = 0$ guarantees volume conservation and how this directly impacts the advection of properties like density within the fluid .",
            "id": "3814264",
            "problem": "Consider a two-dimensional periodic oceanic domain with coordinates $(x,y) \\in [0,L] \\times [0,L]$ and periodic boundary conditions in both directions. Let $L>0$ be given and define a wavenumber $k = \\frac{2\\pi}{L}$. Choose a smooth scalar streamfunction $\\psi(x,y)$ of the form\n$$\n\\psi(x,y) = \\frac{U}{k}\\sin(k x)\\sin(k y),\n$$\nwhere $U>0$ is a constant speed scale. Define the velocity field $\\mathbf{u}(x,y) = (u(x,y), v(x,y))$ by the standard streamfunction construction $u(x,y) = \\frac{\\partial \\psi}{\\partial y}(x,y)$ and $v(x,y) = -\\frac{\\partial \\psi}{\\partial x}(x,y)$. This defines a time-independent, analytic velocity field that is spatially periodic on the domain. Assume an incompressible fluid with variable density $\\rho(x,y,t)$ evolving under mass conservation without sources or sinks.\n\nStarting from physical mass conservation at the control-volume level and proceeding to its local differential form, derive the appropriate evolution equation for $\\rho(x,y,t)$ in this domain. Using the constructed $\\mathbf{u}(x,y)$, evaluate $\\nabla \\cdot \\mathbf{u}(x,y)$ explicitly. Then, with the initial condition $\\rho(x,y,0) = \\rho_{0}$ where $\\rho_{0}>0$ is a spatially uniform constant, determine the analytic expression for $\\rho(x,y,t)$ for all $t \\ge 0$.\n\nReport the two requested quantities in the final answer as a single row matrix $\\big(\\nabla \\cdot \\mathbf{u}(x,y)\\,,\\,\\rho(x,y,t)\\big)$. If any physical unit is required, express density in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$. No rounding is required.",
            "solution": "The analysis begins with the fundamental principle of mass conservation, from which the evolution equation for the density field $\\rho(x,y,t)$ is derived. The problem then requires the evaluation of the velocity field's divergence and the solution of the resulting equation for $\\rho$ given a specific initial condition.\n\nFirst, we derive the evolution equation for density. For an arbitrary control volume $V$ within the fluid, with boundary $\\partial V$, the rate of change of mass inside the volume must equal the negative of the net mass flux out of the volume, assuming no sources or sinks. This is expressed in integral form as:\n$$\n\\frac{d}{dt} \\int_V \\rho \\, dV = -\\oint_{\\partial V} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dS\n$$\nwhere $\\mathbf{u}$ is the velocity field and $\\mathbf{n}$ is the outward-pointing unit normal vector to the surface $\\partial V$.\n\nUsing the Reynolds transport theorem on the left side and the divergence theorem on the right side, we can convert this to a local, differential form. The divergence theorem states that $\\oint_{\\partial V} \\mathbf{F} \\cdot \\mathbf{n} \\, dS = \\int_V (\\nabla \\cdot \\mathbf{F}) \\, dV$. Applying this with $\\mathbf{F} = \\rho \\mathbf{u}$, we get:\n$$\n\\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV = -\\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV\n$$\nCombining the integrals, we have:\n$$\n\\int_V \\left( \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) \\right) dV = 0\n$$\nSince this equation must hold for any arbitrary control volume $V$, the integrand itself must be zero. This yields the continuity equation, which is the governing evolution equation for the density $\\rho(x,y,t)$:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nUsing the vector calculus identity $\\nabla \\cdot (f\\mathbf{A}) = (\\nabla f) \\cdot \\mathbf{A} + f(\\nabla \\cdot \\mathbf{A})$, we can expand the second term:\n$$\n\\frac{\\partial \\rho}{\\partial t} + (\\mathbf{u} \\cdot \\nabla \\rho) + \\rho(\\nabla \\cdot \\mathbf{u}) = 0\n$$\nThis equation describes the evolution of a variable density field in a generic flow. The term \"incompressible fluid\" in this context implies a kinematic constraint on the velocity field, namely that it is divergence-free: $\\nabla \\cdot \\mathbf{u} = 0$. We must verify this for the given velocity field.\n\nThe velocity components $u(x,y)$ and $v(x,y)$ are defined via the streamfunction $\\psi(x,y) = \\frac{U}{k}\\sin(k x)\\sin(k y)$, where $k = \\frac{2\\pi}{L}$.\nThe $x$-component of velocity is:\n$$\nu(x,y) = \\frac{\\partial \\psi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\frac{U}{k}\\sin(k x)\\sin(k y) \\right) = \\frac{U}{k}\\sin(k x) (k \\cos(k y)) = U\\sin(k x)\\cos(k y)\n$$\nThe $y$-component of velocity is:\n$$\nv(x,y) = -\\frac{\\partial \\psi}{\\partial x} = -\\frac{\\partial}{\\partial x} \\left( \\frac{U}{k}\\sin(k x)\\sin(k y) \\right) = -\\frac{U}{k}\\sin(k y) (k \\cos(k x)) = -U\\cos(k x)\\sin(k y)\n$$\nNow, we compute the divergence of the velocity field, $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}$.\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( U\\sin(k x)\\cos(k y) \\right) = Uk\\cos(k x)\\cos(k y)\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( -U\\cos(k x)\\sin(k y) \\right) = -Uk\\cos(k x)\\cos(k y)\n$$\nSumming these two terms gives the divergence:\n$$\n\\nabla \\cdot \\mathbf{u}(x,y) = Uk\\cos(k x)\\cos(k y) - Uk\\cos(k x)\\cos(k y) = 0\n$$\nThis confirms that the velocity field is indeed divergence-free, which is a general property of any velocity field derived from a streamfunction in two dimensions, as $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial^2 \\psi}{\\partial y \\partial x}$, which is zero for a smooth function $\\psi$ by Clairaut's theorem. This is the first quantity requested.\n\nWith $\\nabla \\cdot \\mathbf{u} = 0$, the density evolution equation simplifies significantly:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\rho = 0\n$$\nThis is a first-order linear homogeneous partial differential equation. It states that the material derivative of the density, $\\frac{D\\rho}{Dt} = \\frac{\\partial \\rho}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\rho$, is zero. This means that the density of any given fluid parcel is constant as it moves with the flow.\n\nWe are given the initial condition that the density is spatially uniform at time $t=0$:\n$$\n\\rho(x,y,0) = \\rho_{0}\n$$\nwhere $\\rho_{0} > 0$ is a constant. We can test the trivial solution $\\rho(x,y,t) = \\rho_{0}$ for all $t \\ge 0$.\nLet's substitute this proposed solution into the simplified evolution equation:\nThe partial derivative with respect to time is $\\frac{\\partial \\rho}{\\partial t} = \\frac{\\partial}{\\partial t}(\\rho_0) = 0$.\nThe gradient of the density is $\\nabla \\rho = \\left( \\frac{\\partial \\rho_0}{\\partial x}, \\frac{\\partial \\rho_0}{\\partial y} \\right) = (0,0)$.\nThe advection term is therefore $\\mathbf{u} \\cdot \\nabla \\rho = u(x,y) \\cdot 0 + v(x,y) \\cdot 0 = 0$.\nThe equation becomes $0 + 0 = 0$, which is true for all $(x,y,t)$. Thus, $\\rho(x,y,t) = \\rho_{0}$ is a solution to the PDE.\n\nFurthermore, this solution satisfies the initial condition, since at $t=0$, $\\rho(x,y,0) = \\rho_{0}$.\nFor a first-order hyperbolic equation with a given initial condition and a smooth velocity field, the solution is unique. Therefore, the analytic expression for the density for all time $t \\ge 0$ is:\n$$\n\\rho(x,y,t) = \\rho_{0}\n$$\nThis is the second quantity requested. Physically, since the initial density field is perfectly uniform, and the density is simply advected with the flow, there are no density gradients to be rearranged. Every fluid parcel starts with density $\\rho_{0}$ and maintains this density for all time, so the entire field remains at this uniform density.\n\nThe two requested quantities are $\\nabla \\cdot \\mathbf{u}(x,y) = 0$ and $\\rho(x,y,t) = \\rho_{0}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\rho_0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The incompressibility assumption is a cornerstone of large-scale ocean modeling, but why is it justified? This practice moves from pure mathematics to physical reasoning through the powerful technique of scale analysis. By estimating the characteristic magnitude of the velocity divergence for a typical oceanic flow, you will quantify just how small it is compared to other flow dynamics . This type of \"back-of-the-envelope\" calculation is a critical skill for a physical oceanographer, providing the physical intuition needed to justify the simplifying approximations that make complex systems computationally tractable.",
            "id": "3814285",
            "problem": "In computational oceanography, numerical models often invoke the incompressible approximation at synoptic scales. To justify this approximation from first principles, consider a three-dimensional ocean flow with characteristic horizontal speed $U$ and horizontal length scale $L$. Let the speed of sound in seawater be $c$. Assume seawater behaves as a weakly compressible fluid undergoing adiabatic adjustments, and adopt the following fundamental bases:\n- The compressible continuity equation, written in terms of the material derivative: $D\\rho/Dt + \\rho \\nabla \\cdot \\mathbf{u} = 0$, where $\\rho$ is density and $D/Dt$ is the material derivative $D/Dt = \\partial/\\partial t + \\mathbf{u} \\cdot \\nabla$.\n- The isentropic relation between small density and pressure changes, $\\Delta \\rho / \\rho \\approx \\Delta p / (\\rho c^{2})$, where $c$ is the sound speed.\n- A well-tested dynamical scaling for pressure perturbations in subsonic geophysical flow, $\\Delta p \\sim \\rho U^{2}$, and a characteristic advective timescale $T \\sim L/U$.\n\nUsing only these bases, derive a leading-order estimate for the magnitude $|\\nabla \\cdot \\mathbf{u}|$ in terms of $U$, $L$, and $c$. Then evaluate your expression for $U = 0.5$ m s$^{-1}$, $L = 1.0 \\times 10^{5}$ m, and $c = 1.5 \\times 10^{3}$ m s$^{-1}$. Express your final estimate in s$^{-1}$ and round your answer to two significant figures.",
            "solution": "The problem asks for a leading-order estimate of the magnitude of the fluid velocity divergence, $|\\nabla \\cdot \\mathbf{u}|$, for a large-scale ocean flow, and its numerical evaluation given a set of characteristic scales. The derivation must be based on a specified set of fundamental principles and scaling relations.\n\nFirst, we begin with the compressible continuity equation, provided in terms of the material derivative $D/Dt$:\n$$\n\\frac{D\\rho}{Dt} + \\rho \\nabla \\cdot \\mathbf{u} = 0\n$$\nwhere $\\rho$ is the fluid density and $\\mathbf{u}$ is the velocity vector. We can rearrange this equation to solve for the divergence, $\\nabla \\cdot \\mathbf{u}$:\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\nTo find a leading-order estimate for the magnitude of the divergence, we perform a scaling analysis on this equation. Let the notation $[X]$ represent the characteristic scale (or magnitude) of a quantity $X$. Then, the scale of the divergence is given by:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\left[ \\frac{1}{\\rho} \\frac{D\\rho}{Dt} \\right] = \\frac{1}{[\\rho]} \\left[ \\frac{D\\rho}{Dt} \\right]\n$$\nFor a weakly compressible fluid, density variations $\\Delta\\rho$ are small compared to a reference density $\\rho_0$. Thus, we can approximate $[\\rho] \\sim \\rho_0$.\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\frac{1}{\\rho_0} \\left[ \\frac{D\\rho}{Dt} \\right]\n$$\nNext, we estimate the scale of the material derivative of density, $[D\\rho/Dt]$. The material derivative represents the rate of change of density following a fluid parcel. Its scale can be estimated as the characteristic density change, $\\Delta\\rho$, divided by the characteristic timescale, $T$, over which this change occurs.\n$$\n\\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{[\\rho_{\\text{variation}}]}{[T]} = \\frac{\\Delta\\rho}{T}\n$$\nThe problem specifies the characteristic advective timescale, $T \\sim L/U$, where $L$ is the characteristic length scale and $U$ is the characteristic speed. Substituting this into our estimate gives:\n$$\n\\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{\\Delta\\rho}{L/U} = \\frac{U \\Delta\\rho}{L}\n$$\nNow, we must find an estimate for the scale of density perturbations, $\\Delta\\rho$. The problem provides two key relations for this purpose. First, the isentropic relation for a weakly compressible fluid:\n$$\n\\frac{\\Delta \\rho}{\\rho_0} \\approx \\frac{\\Delta p}{\\rho_0 c^{2}}\n$$\nwhere $\\Delta p$ is the characteristic pressure perturbation and $c$ is the speed of sound. This simplifies to $\\Delta \\rho \\sim \\Delta p / c^2$. Second, the problem provides a dynamical scaling for pressure perturbations in subsonic geophysical flow:\n$$\n\\Delta p \\sim \\rho_0 U^{2}\n$$\nThis scaling connects pressure variations to the kinetic energy per unit volume (dynamic pressure) of the flow.\n\nCombining these two relations, we can express the density perturbation scale, $\\Delta\\rho$, in terms of the fundamental flow scales $U$ and $c$:\n$$\n\\Delta \\rho \\sim \\frac{\\Delta p}{c^2} \\sim \\frac{\\rho_0 U^{2}}{c^2}\n$$\nNow we substitute this expression for $\\Delta\\rho$ back into our estimate for the scale of the material derivative:\n$$\n\\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{U}{L} \\Delta\\rho \\sim \\frac{U}{L} \\left( \\frac{\\rho_0 U^{2}}{c^2} \\right) = \\frac{\\rho_0 U^3}{L c^2}\n$$\nFinally, we substitute this result into our scaling for the divergence, $|\\nabla \\cdot \\mathbf{u}|$:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\frac{1}{\\rho_0} \\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{1}{\\rho_0} \\left( \\frac{\\rho_0 U^3}{L c^2} \\right) = \\frac{U^3}{L c^2}\n$$\nThis is the desired leading-order estimate for the magnitude of the divergence in terms of $U$, $L$, and $c$. This expression can also be written as $(U/L) (U^2/c^2)$, which is the product of the characteristic strain rate ($U/L$) and the square of the Mach number ($M^2 = U^2/c^2$). This shows that the divergence is second-order in the Mach number, and for low-Mach-number flows ($U \\ll c$), the divergence is very small compared to the overall strain rate, justifying the incompressible approximation $(\\nabla \\cdot \\mathbf{u} = 0)$.\n\nNow, we evaluate this expression using the given numerical values:\n- $U = 0.5 \\text{ m s}^{-1}$\n- $L = 1.0 \\times 10^5 \\text{ m}$\n- $c = 1.5 \\times 10^3 \\text{ m s}^{-1}$\n\nSubstituting these values into our derived expression:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx \\frac{(0.5)^3}{(1.0 \\times 10^5) \\times (1.5 \\times 10^3)^2}\n$$\nFirst, calculate the terms in the numerator and denominator:\n$$\nU^3 = (0.5)^3 = 0.125\n$$\n$$\nc^2 = (1.5 \\times 10^3)^2 = (1.5)^2 \\times (10^3)^2 = 2.25 \\times 10^6\n$$\n$$\nL c^2 = (1.0 \\times 10^5) \\times (2.25 \\times 10^6) = 2.25 \\times 10^{11}\n$$\nNow, compute the final value:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx \\frac{0.125}{2.25 \\times 10^{11}} = \\frac{1.25 \\times 10^{-1}}{2.25 \\times 10^{11}} = \\left(\\frac{1.25}{2.25}\\right) \\times 10^{-12}\n$$\nThe fraction is $\\frac{1.25}{2.25} = \\frac{125}{225} = \\frac{5 \\times 25}{9 \\times 25} = \\frac{5}{9} \\approx 0.555...$\nSo,\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx 0.555... \\times 10^{-12} \\text{ s}^{-1} = 5.555... \\times 10^{-13} \\text{ s}^{-1}\n$$\nThe problem requires the answer to be rounded to two significant figures.\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx 5.6 \\times 10^{-13} \\text{ s}^{-1}\n$$\nThis extremely small value for the divergence confirms that, for typical synoptic scales in the ocean, the flow is very nearly incompressible, validating the use of the incompressible approximation in numerical models.",
            "answer": "$$\n\\boxed{5.6 \\times 10^{-13}}\n$$"
        },
        {
            "introduction": "Bridging the gap between a continuous partial differential equation and a discrete numerical algorithm is a central task in computational oceanography. This problem guides you through the formulation of the incompressible continuity equation on an unstructured grid, which is typical of modern coastal ocean models. By applying the divergence theorem to a finite control volume, you will derive the discrete divergence operator from first principles, gaining insight into how the abstract mathematical constraint $\\nabla \\cdot \\mathbf{u} = 0$ is practically enforced in the code that simulates ocean currents .",
            "id": "3814328",
            "problem": "Consider a horizontally incompressible ocean flow in a coastal domain discretized by an unstructured polygonal mesh in the plane. Each cell $i$ is a simple polygon with area $A_i$ and boundary $\\partial i$ composed of faces (edges) $f$. Each face $f$ has length $l_f$ and an associated unit outward normal vector $\\boldsymbol{n}_{i,f}$ defined with respect to cell $i$. A face-centered velocity $\\boldsymbol{u}_f$ is available from the numerical solver and, on boundary faces, either a no-normal-flow condition $(\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_{i,f} = 0)$ is imposed at impermeable coastlines or a prescribed normal inflow $(\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_{i,f} = g_f(t))$ is given at open boundaries, where $g_f(t)$ is a known function of time. Begin from the local integral statement of mass conservation for a control volume and the definition of an incompressible fluid, and deduce how the net volumetric flux across $\\partial i$ relates to the divergence of the velocity field.\n\nUsing only cell areas $A_i$, face lengths $l_f$, the outward normals $\\boldsymbol{n}_{i,f}$, and the face-centered velocities $\\boldsymbol{u}_f$, select the option that correctly defines a consistent discrete divergence operator mapping face velocities to a cell-centered divergence, and states the corresponding discrete incompressible continuity constraint for each cell. Assume a planar ($2$D) mesh and that the velocity is sufficiently smooth that face-centered values represent the velocity along each face.\n\nA. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, l_f$, with the discrete incompressible continuity equation $(\\mathcal{D}\\boldsymbol{u})_i = 0$. On boundary faces, replace $\\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)$ by the prescribed normal velocity $g_f(t)$ at open boundaries and by $0$ at impermeable coastlines.\n\nB. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{P_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, l_f$, where $P_i$ is the cell perimeter, with the discrete incompressible continuity equation $(\\mathcal{D}\\boldsymbol{u})_i = 0$.\n\nC. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{t}_{i,f}\\right)\\, l_f$, where $\\boldsymbol{t}_{i,f}$ is the unit tangent along face $f$, with $(\\mathcal{D}\\boldsymbol{u})_i = 0$.\n\nD. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, A_f$, where $A_f$ is the area associated with face $f$, with $(\\mathcal{D}\\boldsymbol{u})_i = 0$.\n\nE. $(\\mathcal{D}\\boldsymbol{u})_i = -\\,\\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, l_f$, with $(\\mathcal{D}\\boldsymbol{u})_i = 0$ constructed from inward normals to ensure sign consistency.",
            "solution": "The goal is to find a discrete representation of the divergence operator, $(\\mathcal{D}\\boldsymbol{u})_i$, for a cell $i$ in a 2D mesh, based on the fundamental principles of incompressible flow.\n\n1.  **Start with the Divergence Theorem:** The core principle connecting the divergence of a vector field $\\mathbf{u}$ within a region to the flux across its boundary is the Divergence Theorem (in 2D, this is a special case of Green's Theorem). For a cell $i$ with area $A_i$ and boundary $\\partial i$, it states:\n    $$ \\int_{A_i} (\\nabla \\cdot \\mathbf{u}) \\, dA = \\oint_{\\partial i} (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl $$\n    where $\\mathbf{n}$ is the outward unit normal vector on the boundary and $dl$ is an element of length along the boundary.\n\n2.  **Define the Discrete Divergence:** The cell-centered discrete divergence, $(\\mathcal{D}\\mathbf{u})_i$, is defined as the average value of the continuous divergence over the cell area $A_i$.\n    $$ (\\mathcal{D}\\mathbf{u})_i \\approx \\frac{1}{A_i} \\int_{A_i} (\\nabla \\cdot \\mathbf{u}) \\, dA $$\n    By substituting the Divergence Theorem into this definition, we can express the discrete divergence in terms of the boundary flux:\n    $$ (\\mathcal{D}\\mathbf{u})_i \\approx \\frac{1}{A_i} \\oint_{\\partial i} (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl $$\n\n3.  **Discretize the Boundary Integral:** The boundary $\\partial i$ is composed of a finite set of faces (edges), denoted by $f$. The integral along the entire boundary can be replaced by a sum of integrals over each face:\n    $$ \\oint_{\\partial i} (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl = \\sum_{f \\in \\partial i} \\int_f (\\mathbf{u} \\cdot \\mathbf{n}_{i,f}) \\, dl $$\n\n4.  **Apply Finite-Volume Assumptions:** The problem provides a single face-centered velocity $\\mathbf{u}_f$ and a constant outward normal $\\mathbf{n}_{i,f}$ for each face. We can assume these values are constant along the face's length. This allows us to take the term $(\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f})$ outside the integral. The remaining integral, $\\int_f dl$, is simply the length of the face, $l_f$.\n    $$ \\int_f (\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f}) \\, dl = (\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f}) l_f $$\n\n5.  **Assemble the Final Operator:** Substituting this result back gives the complete expression for the discrete divergence operator:\n    $$ (\\mathcal{D}\\mathbf{u})_i = \\frac{1}{A_i} \\sum_{f \\in \\partial i} (\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f}) l_f $$\n\n6.  **The Incompressible Constraint:** For an incompressible fluid, the continuity equation is $\\nabla \\cdot \\mathbf{u} = 0$. The discrete form of this constraint is therefore $(\\mathcal{D}\\mathbf{u})_i = 0$. This also implies that the total net flux out of the cell, $\\sum_{f \\in \\partial i} (\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f}) l_f$, must be zero. The provided boundary conditions for impermeable walls ($\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f} = 0$) and open boundaries ($\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f} = g_f(t)$) are incorporated directly into this summation for the respective boundary faces.\n\n**Evaluation of Options:**\n*   **A:** This option perfectly matches our derived operator and the corresponding discrete continuity equation, including the correct handling of boundary conditions.\n*   **B:** This option incorrectly normalizes by the cell perimeter $P_i$ instead of the cell area $A_i$. The divergence theorem relates a boundary integral to an area integral, so normalization must be by area to approximate the average value of the divergence.\n*   **C:** This option incorrectly uses the tangential component of velocity, $\\mathbf{u}_f \\cdot \\mathbf{t}_{i,f}$. This term is related to fluid circulation and the curl operator, not divergence and mass flux.\n*   **D:** This option uses a face area $A_f$, which is dimensionally incorrect for a 2D problem where flux is calculated over a 1D face length $l_f$.\n*   **E:** This option introduces a non-standard negative sign. The Divergence Theorem, as conventionally defined with an outward normal, does not have a negative sign.\n\nTherefore, Option A is the only one that correctly represents the discrete divergence operator derived from first principles.",
            "answer": "$$\n\\boxed{A}\n$$"
        }
    ]
}