{
    "hands_on_practices": [
        {
            "introduction": "A clear understanding of the continuity equation for an incompressible fluid begins with appreciating what the condition $\\nabla \\cdot \\mathbf{u} = 0$ implies—and what it does not. This exercise tackles a common misconception by challenging the notion that a divergence-free flow must also be irrotational ($\\nabla \\times \\mathbf{u} = \\mathbf{0}$). By evaluating several candidate velocity fields, you will build a robust conceptual foundation, recognizing that incompressibility constrains volume change but permits the rich, rotational dynamics characteristic of oceanic eddies and gyres. ",
            "id": "3814304",
            "problem": "In computational oceanography, one frequently enforces incompressibility of seawater at large scales. Consider a three-dimensional, horizontally periodic domain with period $L$ in both $x$ and $y$, and rigid, free-slip top and bottom boundaries at $z=0$ and $z=H$ (so the normal velocity satisfies $w=0$ at $z=0$ and $z=H$). The mass conservation law for an incompressible fluid is $\\nabla \\cdot \\mathbf{u} = 0$, where $\\mathbf{u} = (u,v,w)$ is the velocity field. The vorticity is defined by $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}$. A claim sometimes encountered is: “Every divergence-free velocity field is irrotational.” \n\nEvaluate the following statements about candidate flows and interpretations, and select all statements that are correct on the stated domain. Throughout, assume that wave numbers satisfy $k = \\dfrac{2\\pi n}{L}$ for some integer $n \\ge 1$, ensuring horizontal periodicity.\n\nA. The two-dimensional Taylor–Green vortex $\\mathbf{u}(x,y,z) = \\big(U \\sin(k x)\\cos(k y),\\,-U \\cos(k x)\\sin(k y),\\,0\\big)$ satisfies $\\nabla \\cdot \\mathbf{u} = 0$ but has $\\nabla \\times \\mathbf{u} \\neq \\mathbf{0}$; therefore it is a counterexample to the claim.\n\nB. The uniform current $\\mathbf{u}(x,y,z) = (U_0,\\,0,\\,0)$ is divergence-free and irrotational; therefore it is a counterexample to the claim.\n\nC. Incompressibility constrains only the divergence of $\\mathbf{u}$, not its curl; hence, in general ocean models, enforcing $\\nabla \\cdot \\mathbf{u} = 0$ does not preclude rotational motion or nonzero relative vorticity.\n\nD. On a horizontally periodic domain, if $\\nabla \\cdot \\mathbf{u} = 0$ for all time, then the domain-integrated vertical vorticity must vanish at all times, which implies $\\nabla \\times \\mathbf{u}=\\mathbf{0}$ everywhere; thus any divergence-free flow is irrotational.\n\nE. The three-dimensional horizontally sheared flow $\\mathbf{u}(x,y,z) = \\big(a \\cos(\\pi z/H),\\,0,\\,0\\big)$ with $w=0$ at $z=0,H$ is divergence-free and has nonzero vorticity; therefore it is a counterexample to the claim.\n\nF. The potential flow $\\mathbf{u}(x,y,z) = \\nabla \\phi$ with $\\phi(x,y,z)=\\cos(k x)$ on the periodic domain provides a counterexample because it is divergence-free but has nonzero curl near the boundaries.\n\nSelect all that apply.",
            "solution": "The problem asks us to evaluate the claim “Every divergence-free velocity field is irrotational” within the context of a specific physical system in computational oceanography. A divergence-free velocity field $\\mathbf{u}$ satisfies the incompressibility condition $\\nabla \\cdot \\mathbf{u} = 0$. An irrotational velocity field has zero vorticity, $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u} = \\mathbf{0}$. The claim is a universal statement: if $\\nabla \\cdot \\mathbf{u} = 0$, then $\\nabla \\times \\mathbf{u} = \\mathbf{0}$. To disprove such a claim, one only needs to find a single counterexample—a velocity field that is divergence-free ($\\nabla \\cdot \\mathbf{u} = 0$) but not irrotational ($\\nabla \\times \\mathbf{u} \\neq \\mathbf{0}$) and that satisfies the given domain constraints.\n\nThe domain is defined as three-dimensional, horizontally periodic with period $L$ in the $x$ and $y$ directions. It has rigid, free-slip boundaries at the top ($z=H$) and bottom ($z=0$). The boundary conditions are therefore:\n1.  Periodicity: $\\mathbf{u}(x+L, y, z) = \\mathbf{u}(x, y+L, z) = \\mathbf{u}(x,y,z)$.\n2.  Impermeable boundaries: The normal velocity component $w$ must be zero at the top and bottom, i.e., $w(x,y,0) = 0$ and $w(x,y,H) = 0$.\n3.  Free-slip boundaries: The shear stress at the top and bottom boundaries must be zero. For an incompressible fluid with viscosity $\\mu$, the stress tensor components are $\\tau_{xz} = \\mu(\\partial u / \\partial z + \\partial w / \\partial x)$ and $\\tau_{yz} = \\mu(\\partial v / \\partial z + \\partial w / \\partial y)$. Since $w$ must be zero for all $x,y$ at $z=0$ and $z=H$, its horizontal derivatives $\\partial w / \\partial x$ and $\\partial w / \\partial y$ are also zero on these planes. The free-slip condition thus simplifies to $\\partial u / \\partial z = 0$ and $\\partial v / \\partial z = 0$ at $z=0$ and $z=H$.\n\nWe will now evaluate each statement.\n\n**A. The two-dimensional Taylor–Green vortex $\\mathbf{u}(x,y,z) = \\big(U \\sin(k x)\\cos(k y),\\,-U \\cos(k x)\\sin(k y),\\,0\\big)$ satisfies $\\nabla \\cdot \\mathbf{u} = 0$ but has $\\nabla \\times \\mathbf{u} \\neq \\mathbf{0}$; therefore it is a counterexample to the claim.**\n\nFirst, we check if this velocity field satisfies the domain constraints.\n-   Velocity components are $u = U \\sin(k x)\\cos(k y)$, $v = -U \\cos(k x)\\sin(k y)$, and $w=0$.\n-   Periodicity: With $k = \\dfrac{2\\pi n}{L}$, the trigonometric functions are periodic with period $L/n$, and thus also with period $L$. The field is horizontally periodic.\n-   Boundary conditions: $w=0$ everywhere, so $w(x,y,0)=0$ and $w(x,y,H)=0$ are satisfied. For the free-slip condition, we check the vertical derivatives of the horizontal velocity components. Since $u$ and $v$ do not depend on $z$, $\\partial u/\\partial z = 0$ and $\\partial v/\\partial z = 0$ everywhere, including at $z=0$ and $z=H$. All boundary conditions are satisfied.\n\nNext, we calculate the divergence:\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z}\n= \\frac{\\partial}{\\partial x}\\big(U \\sin(k x)\\cos(k y)\\big) + \\frac{\\partial}{\\partial y}\\big(-U \\cos(k x)\\sin(k y)\\big) + \\frac{\\partial}{\\partial z}(0)\n$$\n$$\n\\nabla \\cdot \\mathbf{u} = U k \\cos(k x)\\cos(k y) - U k \\cos(k x)\\cos(k y) + 0 = 0\n$$\nThe flow is indeed divergence-free.\n\nFinally, we calculate the curl (vorticity):\n$$\n\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u} = \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\mathbf{i} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\mathbf{j} + \\left(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right)\\mathbf{k}\n$$\nThe $x$- and $y$-components of vorticity are zero because $w=0$ and $u,v$ are independent of $z$: $\\omega_x = 0$, $\\omega_y = 0$. The $z$-component is:\n$$\n\\omega_z = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial x}\\big(-U \\cos(k x)\\sin(k y)\\big) - \\frac{\\partial}{\\partial y}\\big(U \\sin(k x)\\cos(k y)\\big)\n$$\n$$\n\\omega_z = U k \\sin(k x)\\sin(k y) - \\big(-U k \\sin(k x)\\sin(k y)\\big) = 2 U k \\sin(k x)\\sin(k y)\n$$\nSince $\\omega_z$ is not identically zero (assuming $U \\neq 0$ and $k \\neq 0$), the vorticity vector $\\boldsymbol{\\omega}$ is not zero.\nThe Taylor-Green vortex is divergence-free but has non-zero vorticity and satisfies all system constraints. It is a valid counterexample.\nVerdict: **Correct**.\n\n**B. The uniform current $\\mathbf{u}(x,y,z) = (U_0,\\,0,\\,0)$ is divergence-free and irrotational; therefore it is a counterexample to the claim.**\n\nLet's analyze this flow.\n-   It satisfies periodicity and all boundary conditions ($w=0$, $\\partial u/\\partial z=0$, $\\partial v/\\partial z=0$).\n-   Divergence: $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial U_0}{\\partial x} + \\frac{\\partial 0}{\\partial y} + \\frac{\\partial 0}{\\partial z} = 0$. The flow is divergence-free.\n-   Curl: $\\nabla \\times \\mathbf{u} = \\mathbf{0}$ because all components of $\\mathbf{u}$ are constants. The flow is irrotational.\nThe statement asserts that this flow is a counterexample to the claim \"divergence-free implies irrotational\". A counterexample must satisfy the premise ($\\nabla \\cdot \\mathbf{u} = 0$) but violate the conclusion ($\\nabla \\times \\mathbf{u} \\neq \\mathbf{0}$). This flow is divergence-free and irrotational. It is an example consistent with the claim, not one that refutes it. The reasoning provided is incorrect.\nVerdict: **Incorrect**.\n\n**C. Incompressibility constrains only the divergence of $\\mathbf{u}$, not its curl; hence, in general ocean models, enforcing $\\nabla \\cdot \\mathbf{u} = 0$ does not preclude rotational motion or nonzero relative vorticity.**\n\nThis is a general statement about the principles of fluid dynamics. The incompressibility condition $\\nabla \\cdot \\mathbf{u} = 0$ is a scalar equation derived from the continuity equation (mass conservation) under the assumption of constant density. It constrains the velocity field. The vorticity, $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}$, is a different property of the flow field. The Helmholtz decomposition theorem in vector calculus formalizes that a vector field can be decomposed into a curl-free (irrotational) part and a divergence-free (solenoidal) part. A field being solenoidal ($\\nabla \\cdot \\mathbf{u} = 0$) does not, in general, imply that its curl is zero. Ocean currents, eddies, and gyres are prime examples of fluid motions that are treated as incompressible but are fundamentally rotational. The statement correctly captures this fundamental concept.\nVerdict: **Correct**.\n\n**D. On a horizontally periodic domain, if $\\nabla \\cdot \\mathbf{u} = 0$ for all time, then the domain-integrated vertical vorticity must vanish at all times, which implies $\\nabla \\times \\mathbf{u}=\\mathbf{0}$ everywhere; thus any divergence-free flow is irrotational.**\n\nThis statement contains a chain of reasoning that must be examined.\nLet's first check if the domain-integrated vertical vorticity vanishes. The vertical component of vorticity is $\\omega_z = \\partial v/\\partial x - \\partial u/\\partial y$. We integrate this over one horizontal period:\n$$\n\\int_0^L \\int_0^L \\omega_z \\,dx\\,dy = \\int_0^L \\int_0^L \\left(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right) \\,dx\\,dy\n$$\nUsing the fundamental theorem of calculus:\n$$\n= \\int_0^L \\left[ v(x,y,z) \\right]_{x=0}^{x=L} \\,dy - \\int_0^L \\left[ u(x,y,z) \\right]_{y=0}^{y=L} \\,dx\n$$\nDue to periodicity, $v(L,y,z) = v(0,y,z)$ and $u(x,L,z) = u(x,0,z)$. Therefore, both terms on the right-hand side are zero. So, $\\int_0^L \\int_0^L \\omega_z \\,dx\\,dy = 0$. The first part of the statement is correct.\nHowever, the statement then concludes \"...which implies $\\nabla \\times \\mathbf{u}=\\mathbf{0}$ everywhere\". This is a logical fallacy. The fact that the integral of a function over a domain is zero does not imply that the function itself is zero everywhere in that domain. A function can have positive and negative regions that cancel upon integration. The Taylor-Green vortex from option A is a perfect counterexample to this flawed logic: we showed its $\\omega_z = 2 U k \\sin(k x)\\sin(k y)$ is non-zero, but its integral over the periodic domain is zero.\n$$\n\\int_0^L \\int_0^L 2 U k \\sin(kx)\\sin(ky) \\,dx\\,dy = 2Uk \\left(\\int_0^L \\sin\\left(\\frac{2\\pi n x}{L}\\right) dx\\right) \\left(\\int_0^L \\sin\\left(\\frac{2\\pi m y}{L}\\right) dy\\right) = 0\n$$\n(assuming $k_x=k_y=k$ for simplicity).\nThe reasoning is invalid.\nVerdict: **Incorrect**.\n\n**E. The three-dimensional horizontally sheared flow $\\mathbf{u}(x,y,z) = \\big(a \\cos(\\pi z/H),\\,0,\\,0\\big)$ with $w=0$ at $z=0,H$ is divergence-free and has nonzero vorticity; therefore it is a counterexample to the claim.**\n\nLet's check this velocity field.\n-   Velocity components: $u = a \\cos(\\pi z/H)$, $v=0$, $w=0$.\n-   Periodicity: The flow is independent of $x$ and $y$, so it is trivially periodic for any period $L$.\n-   Boundary conditions: $w=0$ everywhere, so the impermeability condition is met. For the free-slip condition, we check $\\partial u/\\partial z$ at the boundaries:\n    $$ \\frac{\\partial u}{\\partial z} = \\frac{\\partial}{\\partial z}\\left(a \\cos\\left(\\frac{\\pi z}{H}\\right)\\right) = -a \\frac{\\pi}{H} \\sin\\left(\\frac{\\pi z}{H}\\right) $$\n    At $z=0$, $\\partial u/\\partial z = -a (\\pi/H) \\sin(0) = 0$.\n    At $z=H$, $\\partial u/\\partial z = -a (\\pi/H) \\sin(\\pi) = 0$.\n    Since $\\partial v/\\partial z=0$ also holds, the free-slip conditions are met.\n\nNext, we check divergence and curl.\n-   Divergence:\n    $$ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 + 0 + 0 = 0 $$\n    The flow is divergence-free.\n-   Curl:\n    $$ \\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u} = \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\mathbf{i} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\mathbf{j} + \\left(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right)\\mathbf{k} $$\n    $$ \\boldsymbol{\\omega} = (0-0)\\mathbf{i} + \\left(-a \\frac{\\pi}{H} \\sin\\left(\\frac{\\pi z}{H}\\right) - 0\\right)\\mathbf{j} + (0-0)\\mathbf{k} = -a \\frac{\\pi}{H} \\sin\\left(\\frac{\\pi z}{H}\\right) \\mathbf{j} $$\n    This vorticity is non-zero for $z \\in (0, H)$ (assuming $a \\neq 0$).\nThis flow is divergence-free, has non-zero vorticity, and satisfies all system constraints. It is another valid counterexample.\nVerdict: **Correct**.\n\n**F. The potential flow $\\mathbf{u}(x,y,z) = \\nabla \\phi$ with $\\phi(x,y,z)=\\cos(k x)$ on the periodic domain provides a counterexample because it is divergence-free but has nonzero curl near the boundaries.**\n\nA flow derived from a scalar potential, $\\mathbf{u} = \\nabla \\phi$, is called a potential flow. By the vector calculus identity $\\nabla \\times (\\nabla \\phi) \\equiv \\mathbf{0}$, any potential flow is necessarily irrotational (has zero curl) everywhere it is defined. The statement's claim that it has \"nonzero curl\" is false from the outset.\nLet's examine its other properties for completeness.\n-   Velocity field: $\\mathbf{u} = \\nabla(\\cos(k x)) = (-k \\sin(kx),\\, 0,\\, 0)$.\n-   Curl: $\\nabla \\times \\mathbf{u} = \\mathbf{0}$, as expected.\n-   Divergence:\n    $$ \\nabla \\cdot \\mathbf{u} = \\nabla \\cdot (\\nabla \\phi) = \\nabla^2\\phi = \\frac{\\partial^2}{\\partial x^2}(\\cos(kx)) = -k^2 \\cos(kx) $$\n    The divergence is not zero. Therefore, the flow is not divergence-free. The premise of the statement \"it is divergence-free\" is also false.\nThis flow is neither divergence-free nor does it have non-zero curl. It cannot be a counterexample. The statement is incorrect on multiple points.\nVerdict: **Incorrect**.\n\nSummary of analysis:\n-   Statement A: Correct. Provides a valid counterexample.\n-   Statement B: Incorrect. Logical flaw in defining a counterexample.\n-   Statement C: Correct. Correctly states the general principle.\n-   Statement D: Incorrect. Logical fallacy in the reasoning.\n-   Statement E: Correct. Provides another valid counterexample.\n-   Statement F: Incorrect. False claims about the properties of the given flow.\n\nThe correct statements are A, C, and E.",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "The incompressible approximation is a cornerstone of large-scale ocean modeling, but why is it physically valid? This practice bridges theory and application by using scaling analysis—a powerful tool in geophysical fluid dynamics—to estimate the magnitude of divergence in a typical oceanic setting. By deriving an order-of-magnitude estimate for $|\\nabla \\cdot \\mathbf{u}|$, you will quantitatively justify why seawater can be treated as incompressible for synoptic-scale phenomena, where flow speeds are much smaller than the speed of sound. ",
            "id": "3814285",
            "problem": "In computational oceanography, numerical models often invoke the incompressible approximation at synoptic scales. To justify this approximation from first principles, consider a three-dimensional ocean flow with characteristic horizontal speed $U$ and horizontal length scale $L$. Let the speed of sound in seawater be $c$. Assume seawater behaves as a weakly compressible fluid undergoing adiabatic adjustments, and adopt the following fundamental bases:\n- The compressible continuity equation, written in terms of the material derivative: $D\\rho/Dt + \\rho \\nabla \\cdot \\mathbf{u} = 0$, where $\\rho$ is density and $D/Dt$ is the material derivative $D/Dt = \\partial/\\partial t + \\mathbf{u} \\cdot \\nabla$.\n- The isentropic relation between small density and pressure changes, $\\Delta \\rho / \\rho \\approx \\Delta p / (\\rho c^{2})$, where $c$ is the sound speed.\n- A well-tested dynamical scaling for pressure perturbations in subsonic geophysical flow, $\\Delta p \\sim \\rho U^{2}$, and a characteristic advective timescale $T \\sim L/U$.\n\nUsing only these bases, derive a leading-order estimate for the magnitude $|\\nabla \\cdot \\mathbf{u}|$ in terms of $U$, $L$, and $c$. Then evaluate your expression for $U = 0.5$ m s$^{-1}$, $L = 1.0 \\times 10^{5}$ m, and $c = 1.5 \\times 10^{3}$ m s$^{-1}$. Express your final estimate in s$^{-1}$ and round your answer to two significant figures.",
            "solution": "The problem asks for a leading-order estimate of the magnitude of the fluid velocity divergence, $|\\nabla \\cdot \\mathbf{u}|$, for a large-scale ocean flow, and its numerical evaluation given a set of characteristic scales. The derivation must be based on a specified set of fundamental principles and scaling relations.\n\nFirst, we begin with the compressible continuity equation, provided in terms of the material derivative $D/Dt$:\n$$\n\\frac{D\\rho}{Dt} + \\rho \\nabla \\cdot \\mathbf{u} = 0\n$$\nwhere $\\rho$ is the fluid density and $\\mathbf{u}$ is the velocity vector. We can rearrange this equation to solve for the divergence, $\\nabla \\cdot \\mathbf{u}$:\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\nTo find a leading-order estimate for the magnitude of the divergence, we perform a scaling analysis on this equation. Let the notation $[X]$ represent the characteristic scale (or magnitude) of a quantity $X$. Then, the scale of the divergence is given by:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\left[ \\frac{1}{\\rho} \\frac{D\\rho}{Dt} \\right] = \\frac{1}{[\\rho]} \\left[ \\frac{D\\rho}{Dt} \\right]\n$$\nFor a weakly compressible fluid, density variations $\\Delta\\rho$ are small compared to a reference density $\\rho_0$. Thus, we can approximate $[\\rho] \\sim \\rho_0$.\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\frac{1}{\\rho_0} \\left[ \\frac{D\\rho}{Dt} \\right]\n$$\nNext, we estimate the scale of the material derivative of density, $[D\\rho/Dt]$. The material derivative represents the rate of change of density following a fluid parcel. Its scale can be estimated as the characteristic density change, $\\Delta\\rho$, divided by the characteristic timescale, $T$, over which this change occurs.\n$$\n\\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{[\\rho_{\\text{variation}}]}{[T]} = \\frac{\\Delta\\rho}{T}\n$$\nThe problem specifies the characteristic advective timescale, $T \\sim L/U$, where $L$ is the characteristic length scale and $U$ is the characteristic speed. Substituting this into our estimate gives:\n$$\n\\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{\\Delta\\rho}{L/U} = \\frac{U \\Delta\\rho}{L}\n$$\nNow, we must find an estimate for the scale of density perturbations, $\\Delta\\rho$. The problem provides two key relations for this purpose. First, the isentropic relation for a weakly compressible fluid:\n$$\n\\frac{\\Delta \\rho}{\\rho_0} \\approx \\frac{\\Delta p}{\\rho_0 c^{2}}\n$$\nwhere $\\Delta p$ is the characteristic pressure perturbation and $c$ is the speed of sound. This simplifies to $\\Delta \\rho \\sim \\Delta p / c^2$. Second, the problem provides a dynamical scaling for pressure perturbations in subsonic geophysical flow:\n$$\n\\Delta p \\sim \\rho_0 U^{2}\n$$\nThis scaling connects pressure variations to the kinetic energy per unit volume (dynamic pressure) of the flow.\n\nCombining these two relations, we can express the density perturbation scale, $\\Delta\\rho$, in terms of the fundamental flow scales $U$ and $c$:\n$$\n\\Delta \\rho \\sim \\frac{\\Delta p}{c^2} \\sim \\frac{\\rho_0 U^{2}}{c^2}\n$$\nNow we substitute this expression for $\\Delta\\rho$ back into our estimate for the scale of the material derivative:\n$$\n\\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{U}{L} \\Delta\\rho \\sim \\frac{U}{L} \\left( \\frac{\\rho_0 U^{2}}{c^2} \\right) = \\frac{\\rho_0 U^3}{L c^2}\n$$\nFinally, we substitute this result into our scaling for the divergence, $|\\nabla \\cdot \\mathbf{u}|$:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\frac{1}{\\rho_0} \\left[ \\frac{D\\rho}{Dt} \\right] \\sim \\frac{1}{\\rho_0} \\left( \\frac{\\rho_0 U^3}{L c^2} \\right) = \\frac{U^3}{L c^2}\n$$\nThis is the desired leading-order estimate for the magnitude of the divergence in terms of $U$, $L$, and $c$. This expression can also be written as $(U/L) (U^2/c^2)$, which is the product of the characteristic strain rate ($U/L$) and the square of the Mach number ($M^2 = U^2/c^2$). This shows that the divergence is second-order in the Mach number, and for low-Mach-number flows ($U \\ll c$), the divergence is very small compared to the overall strain rate, justifying the incompressible approximation $(\\nabla \\cdot \\mathbf{u} = 0)$.\n\nNow, we evaluate this expression using the given numerical values:\n- $U = 0.5 \\text{ m s}^{-1}$\n- $L = 1.0 \\times 10^5 \\text{ m}$\n- $c = 1.5 \\times 10^3 \\text{ m s}^{-1}$\n\nSubstituting these values into our derived expression:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx \\frac{(0.5)^3}{(1.0 \\times 10^5) \\times (1.5 \\times 10^3)^2}\n$$\nFirst, calculate the terms in the numerator and denominator:\n$$\nU^3 = (0.5)^3 = 0.125\n$$\n$$\nc^2 = (1.5 \\times 10^3)^2 = (1.5)^2 \\times (10^3)^2 = 2.25 \\times 10^6\n$$\n$$\nL c^2 = (1.0 \\times 10^5) \\times (2.25 \\times 10^6) = 2.25 \\times 10^{11}\n$$\nNow, compute the final value:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx \\frac{0.125}{2.25 \\times 10^{11}} = \\frac{1.25 \\times 10^{-1}}{2.25 \\times 10^{11}} = \\left(\\frac{1.25}{2.25}\\right) \\times 10^{-12}\n$$\nThe fraction is $\\frac{1.25}{2.25} = \\frac{125}{225} = \\frac{5 \\times 25}{9 \\times 25} = \\frac{5}{9} \\approx 0.555...$\nSo,\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx 0.555... \\times 10^{-12} \\text{ s}^{-1} = 5.555... \\times 10^{-13} \\text{ s}^{-1}\n$$\nThe problem requires the answer to be rounded to two significant figures.\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx 5.6 \\times 10^{-13} \\text{ s}^{-1}\n$$\nThis extremely small value for the divergence confirms that, for typical synoptic scales in the ocean, the flow is very nearly incompressible, validating the use of the incompressible approximation in numerical models.",
            "answer": "$$\n\\boxed{5.6 \\times 10^{-13}}\n$$"
        },
        {
            "introduction": "Translating continuous physical laws into algorithms a computer can execute is the essence of computational science. This exercise takes the incompressible continuity equation from the page to the grid by deriving its discrete form using the finite-volume method, a technique widely used in modern ocean models for its inherent conservation properties. Starting from the integral form of mass conservation, you will formulate a discrete divergence operator for an unstructured mesh, providing a direct look at how the condition $\\nabla \\cdot \\mathbf{u} = 0$ is numerically enforced. ",
            "id": "3814328",
            "problem": "Consider a horizontally incompressible ocean flow in a coastal domain discretized by an unstructured polygonal mesh in the plane. Each cell $i$ is a simple polygon with area $A_i$ and boundary $\\partial i$ composed of faces (edges) $f$. Each face $f$ has length $l_f$ and an associated unit outward normal vector $\\boldsymbol{n}_{i,f}$ defined with respect to cell $i$. A face-centered velocity $\\boldsymbol{u}_f$ is available from the numerical solver and, on boundary faces, either a no-normal-flow condition $(\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_{i,f} = 0)$ is imposed at impermeable coastlines or a prescribed normal inflow $(\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_{i,f} = g_f(t))$ is given at open boundaries, where $g_f(t)$ is a known function of time. Begin from the local integral statement of mass conservation for a control volume and the definition of an incompressible fluid, and deduce how the net volumetric flux across $\\partial i$ relates to the divergence of the velocity field.\n\nUsing only cell areas $A_i$, face lengths $l_f$, the outward normals $\\boldsymbol{n}_{i,f}$, and the face-centered velocities $\\boldsymbol{u}_f$, select the option that correctly defines a consistent discrete divergence operator mapping face velocities to a cell-centered divergence, and states the corresponding discrete incompressible continuity constraint for each cell. Assume a planar ($2$D) mesh and that the velocity is sufficiently smooth that face-centered values represent the velocity along each face.\n\nA. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, l_f$, with the discrete incompressible continuity equation $(\\mathcal{D}\\boldsymbol{u})_i = 0$. On boundary faces, replace $\\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)$ by the prescribed normal velocity $g_f(t)$ at open boundaries and by $0$ at impermeable coastlines.\n\nB. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{P_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, l_f$, where $P_i$ is the cell perimeter, with the discrete incompressible continuity equation $(\\mathcal{D}\\boldsymbol{u})_i = 0$.\n\nC. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{t}_{i,f}\\right)\\, l_f$, where $\\boldsymbol{t}_{i,f}$ is the unit tangent along face $f$, with $(\\mathcal{D}\\boldsymbol{u})_i = 0$.\n\nD. $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, A_f$, where $A_f$ is the area associated with face $f$, with $(\\mathcal{D}\\boldsymbol{u})_i = 0$.\n\nE. $(\\mathcal{D}\\boldsymbol{u})_i = -\\,\\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, l_f$, with $(\\mathcal{D}\\boldsymbol{u})_i = 0$ constructed from inward normals to ensure sign consistency.",
            "solution": "The task is to derive a discrete form of the divergence operator for a 2D unstructured mesh, starting from fundamental principles. This is a core concept in the Finite Volume Method.\n\n1.  **Start with the Divergence Theorem:** The divergence theorem relates the integral of the divergence of a vector field $\\mathbf{u}$ over an area $A$ to the flux of the field through its boundary $\\partial A$. In 2D, this is written as:\n    $$\n    \\int_{A} (\\nabla \\cdot \\mathbf{u}) \\, dA = \\oint_{\\partial A} (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl\n    $$\n    Here, $\\mathbf{n}$ is the unit outward normal vector to the boundary, and $dl$ is an infinitesimal element of the boundary's length.\n\n2.  **Define the Cell-Averaged Divergence:** We want to find a single value for the divergence that represents the entire cell $i$. A natural choice is the average divergence over the cell's area, $A_i$. The discrete divergence operator $(\\mathcal{D}\\mathbf{u})_i$ should approximate this average:\n    $$\n    (\\mathcal{D}\\mathbf{u})_i \\approx \\langle \\nabla \\cdot \\mathbf{u} \\rangle_i = \\frac{1}{A_i} \\int_{A_i} (\\nabla \\cdot \\mathbf{u}) \\, dA\n    $$\n\n3.  **Apply the Divergence Theorem:** Substitute the boundary integral from the divergence theorem into the definition of the average divergence:\n    $$\n    (\\mathcal{D}\\mathbf{u})_i = \\frac{1}{A_i} \\oint_{\\partial i} (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl\n    $$\n    This equation is exact. We now need to discretize it for our polygonal cell.\n\n4.  **Discretize the Boundary Integral:** The boundary $\\partial i$ of the cell is composed of a set of straight faces (edges), indexed by $f$. The integral around the closed boundary can be replaced by a sum of integrals over each face:\n    $$\n    \\oint_{\\partial i} (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl = \\sum_{f \\in \\partial i} \\int_f (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl\n    $$\n\n5.  **Apply the Finite Volume Approximation:** The problem states we have a face-centered velocity $\\mathbf{u}_f$. The finite volume method assumes this velocity is representative of the entire face. Since the face $f$ is a straight line segment, its outward normal vector $\\mathbf{n}_{i,f}$ is also constant. Therefore, the term $(\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f})$ is constant over the face and can be taken out of the integral. The remaining integral, $\\int_f dl$, is simply the length of the face, $l_f$.\n    $$\n    \\int_f (\\mathbf{u} \\cdot \\mathbf{n}) \\, dl \\approx (\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f}) l_f\n    $$\n\n6.  **Assemble the Discrete Operator:** Substitute the discretized face integral back into the sum:\n    $$\n    (\\mathcal{D}\\mathbf{u})_i = \\frac{1}{A_i} \\sum_{f \\in \\partial i} (\\mathbf{u}_f \\cdot \\mathbf{n}_{i,f}) l_f\n    $$\n    This is our final discrete divergence operator.\n\n7.  **Formulate the Continuity Constraint:** The continuity equation for an incompressible fluid is $\\nabla \\cdot \\mathbf{u} = 0$. The discrete equivalent is that our cell-averaged discrete divergence must be zero for every cell $i$:\n    $$\n    (\\mathcal{D}\\mathbf{u})_i = 0\n    $$\n\n8.  **Evaluate the Options:**\n    *   **A:** $(\\mathcal{D}\\boldsymbol{u})_i = \\dfrac{1}{A_i}\\displaystyle\\sum_{f\\in\\partial i} \\left(\\boldsymbol{u}_f\\cdot\\boldsymbol{n}_{i,f}\\right)\\, l_f$, with $(\\mathcal{D}\\boldsymbol{u})_i = 0$. This exactly matches our derivation. The description of boundary conditions is also the standard implementation. This option is correct.\n    *   **B:** Normalizes by the perimeter $P_i$ instead of the area $A_i$. This is incorrect. The operator must approximate the average divergence over the area.\n    *   **C:** Uses the tangential component of velocity ($\\mathbf{u}_f \\cdot \\mathbf{t}_{i,f}$). This would be used to calculate circulation or curl, not divergence.\n    *   **D:** Multiplies by a face area $A_f$, which is dimensionally incorrect for a 2D problem where the flux is through a line segment of length $l_f$.\n    *   **E:** Introduces an incorrect negative sign. The divergence theorem, using outward normals, has a positive sign.\n\nTherefore, option A provides the correct, consistent discrete divergence operator and continuity constraint.",
            "answer": "$$\n\\boxed{A}\n$$"
        }
    ]
}