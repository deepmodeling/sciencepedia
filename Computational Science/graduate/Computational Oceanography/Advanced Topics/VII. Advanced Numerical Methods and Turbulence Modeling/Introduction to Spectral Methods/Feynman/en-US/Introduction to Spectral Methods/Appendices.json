{
    "hands_on_practices": [
        {
            "introduction": "In computational oceanography, we analyze time series data from sources like moorings, satellites, or models, which are discrete samples of continuous physical processes. This practice  explores a critical consequence of this sampling: aliasing. By working through the derivation from first principles, you will understand how a signal with a true frequency higher than the Nyquist frequency can be misinterpreted as a lower-frequency signal, a phenomenon that can severely corrupt spectral estimates if not properly handled.",
            "id": "3796086",
            "problem": "Consider a continuous-time sea level signal modeled locally as a single real sinusoid $s(t) = A \\cos(\\omega_{0} t + \\phi)$, where $A$ is amplitude, $\\phi$ is phase, and $\\omega_{0} > 0$ is the true angular frequency. The signal is sampled uniformly at interval $\\Delta t > 0$, producing a discrete-time sequence $x[n] = s(n \\Delta t)$ for integer $n$. Let the sampling angular frequency be $\\omega_{s} = \\frac{2\\pi}{\\Delta t}$ and the Nyquist angular frequency be $\\omega_{N} = \\frac{\\pi}{\\Delta t}$. Using only first principles about sampling represented as multiplication by a Dirac comb and the periodicity of the discrete-time complex exponential, derive an expression for the aliased angular frequency that would be observed in the principal discrete-time baseband $[0, \\omega_{N}]$ when $\\omega_{0} > \\omega_{N}$. Explicitly justify how the integer indexing of spectral replicas enters the expression and why the absolute value appears for a real cosine.\n\nThen, illustrate the result with a physically realistic computational oceanography scenario: the principal lunar semidiurnal tide ($\\mathrm{M2}$) has period $P = 12.4206012$ hours. Suppose sea level is sampled every $\\Delta t = 13$ hours. Compute the aliased frequency in cycles per day (cpd) that would be estimated from the sampled time series if a spectral method such as the Discrete Fourier Transform (DFT) is applied. For the numerical part, express your final answer for the aliased frequency in cpd and round your answer to five significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in signal processing applied to a realistic geophysical context. The provided data are sufficient and consistent.\n\nThe problem asks for a derivation of the aliased frequency and a numerical calculation for a specific oceanographic scenario.\n\n**Part 1: Derivation of the Aliased Frequency**\n\nA continuous-time sinusoidal signal is given by $s(t) = A \\cos(\\omega_{0} t + \\phi)$, where $A$ is the amplitude, $\\phi$ is the phase, and $\\omega_{0} > 0$ is the true angular frequency. Using Euler's formula, we can express the real-valued cosine as the sum of two complex exponentials:\n$$s(t) = \\frac{A}{2} \\left( e^{i(\\omega_{0} t + \\phi)} + e^{-i(\\omega_{0} t + \\phi)} \\right) = \\frac{A}{2} e^{i\\phi} e^{i\\omega_{0} t} + \\frac{A}{2} e^{-i\\phi} e^{-i\\omega_{0} t}$$\nThe continuous-time Fourier Transform (CTFT) of $s(t)$, denoted $S(\\omega)$, is found by using the transform pair $\\mathcal{F}\\{e^{i\\omega_{a}t}\\} = 2\\pi\\delta(\\omega - \\omega_{a})$, where $\\delta(\\cdot)$ is the Dirac delta function. The spectrum is:\n$$S(\\omega) = \\frac{A}{2} e^{i\\phi} (2\\pi\\delta(\\omega - \\omega_{0})) + \\frac{A}{2} e^{-i\\phi} (2\\pi\\delta(\\omega + \\omega_{0})) = A\\pi \\left( e^{i\\phi}\\delta(\\omega - \\omega_{0}) + e^{-i\\phi}\\delta(\\omega + \\omega_{0}) \\right)$$\nThis shows that the spectrum of the continuous signal consists of two impulses at angular frequencies $\\omega = \\omega_{0}$ and $\\omega = -\\omega_{0}$.\n\nSampling the signal $s(t)$ at a uniform interval $\\Delta t$ is modeled as multiplying $s(t)$ by an infinite train of Dirac delta functions, known as a Dirac comb:\n$$p(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t-n\\Delta t)$$\nThe sampled signal in the continuous domain is $s_{p}(t) = s(t)p(t)$. The Fourier transform of the Dirac comb is another Dirac comb, scaled and with a reciprocal period:\n$$P(\\omega) = \\mathcal{F}\\{p(t)\\} = \\frac{2\\pi}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} \\delta\\left(\\omega - k \\frac{2\\pi}{\\Delta t}\\right) = \\omega_{s} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k\\omega_{s})$$\nwhere $\\omega_{s} = \\frac{2\\pi}{\\Delta t}$ is the sampling angular frequency and $k$ is an integer index.\n\nMultiplication in the time domain corresponds to convolution in the frequency domain. The spectrum of the sampled signal, $S_{p}(\\omega)$, is given by:\n$$S_{p}(\\omega) = \\frac{1}{2\\pi} (S(\\omega) * P(\\omega)) = \\frac{1}{2\\pi} \\left( S(\\omega) * \\left( \\omega_{s} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k\\omega_{s}) \\right) \\right)$$\n$$S_{p}(\\omega) = \\frac{\\omega_{s}}{2\\pi} \\sum_{k=-\\infty}^{\\infty} (S(\\omega) * \\delta(\\omega - k\\omega_{s})) = \\frac{1}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} S(\\omega - k\\omega_{s})$$\nThis fundamental result shows that the spectrum of the sampled signal consists of periodically repeated replicas of the original signal's spectrum $S(\\omega)$, shifted by integer multiples of the sampling frequency $\\omega_{s}$.\n\nSubstituting the expression for $S(\\omega)$, we get:\n$$S_{p}(\\omega) = \\frac{A\\pi}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} \\left( e^{i\\phi}\\delta(\\omega - \\omega_{0} - k\\omega_{s}) + e^{-i\\phi}\\delta(\\omega + \\omega_{0} - k\\omega_{s}) \\right)$$\nThe spectral replicas of the original impulses at $\\pm\\omega_{0}$ are now located at all frequencies $\\omega = \\pm \\omega_{0} + k\\omega_{s}$ for all integers $k$. This explicitly shows how the integer indexing $k$ of spectral replicas arises from the sampling process.\n\nA discrete-time system, such as one analyzing the sequence $x[n] = s(n\\Delta t)$, can only unambiguously represent frequencies within the principal baseband, which for a real signal is typically taken as $[0, \\omega_{N}]$, where $\\omega_{N} = \\frac{\\pi}{\\Delta t} = \\frac{\\omega_{s}}{2}$ is the Nyquist frequency. If the true frequency $\\omega_0$ is greater than $\\omega_N$, its spectral energy will be \"aliased\" or \"folded\" into the baseband.\n\nThe aliased frequency, $\\omega_{a}'$, is the frequency of the replica that falls into the interval $[-\\omega_{N}, \\omega_{N}]$. We must find an integer $k_{m}$ such that $\\omega'_{a} = \\omega_{0} - k_{m}\\omega_{s}$ satisfies $|\\omega'_{a}| \\le \\omega_{N}$.\n$$|\\omega_{0} - k_{m}\\omega_{s}| \\le \\frac{\\omega_{s}}{2}$$\nDividing by $\\omega_{s}$ gives:\n$$|\\frac{\\omega_{0}}{\\omega_{s}} - k_{m}| \\le \\frac{1}{2}$$\nThis inequality defines $k_{m}$ as the integer closest to the ratio $\\frac{\\omega_{0}}{\\omega_{s}}$. Therefore, $k_{m} = \\text{round}(\\frac{\\omega_{0}}{\\omega_{s}})$. The aliased frequency in the range $[-\\omega_{N}, \\omega_{N}]$ is $\\omega'_{a} = \\omega_{0} - \\omega_{s} \\cdot \\text{round}(\\frac{\\omega_{0}}{\\omega_{s}})$.\n\nThe reason for the absolute value comes from the fact that a real signal $s(t)$ has a conjugate-symmetric spectrum, with power at both $+\\omega_{0}$ and $-\\omega_{0}$. After sampling, the replicas of $+\\omega_{0}$ alias to $\\omega'_{a}$, and the replicas of $-\\omega_{0}$ alias to $-\\omega'_{a}$ (since they are mapped symmetrically around $\\omega=0$). The discrete-time sequence $x[n]$ therefore contains components corresponding to both $\\pm\\omega'_{a}$. A spectral analysis method like the DFT will reveal power at a single positive frequency. The observed aliased angular frequency, $\\omega_{alias}$, in the principal baseband $[0, \\omega_{N}]$ is the magnitude of this frequency:\n$$\\omega_{alias} = |\\omega'_{a}| = \\left|\\omega_{0} - \\omega_{s} \\cdot \\text{round}\\left(\\frac{\\omega_{0}}{\\omega_{s}}\\right)\\right|$$\n\n**Part 2: Numerical Illustration**\n\nWe are given the period of the $\\mathrm{M2}$ tide, $P = 12.4206012$ hours, and a sampling interval $\\Delta t = 13$ hours. We need to find the aliased frequency in cycles per day (cpd). It is convenient to work with frequency $f = \\frac{\\omega}{2\\pi}$ rather than angular frequency $\\omega$. The aliasing formula is analogous: $f_{alias} = |f_{0} - f_{s} \\cdot \\text{round}(\\frac{f_{0}}{f_{s}})|$.\n\n1.  **Calculate the true frequency $f_0$**:\n    The period is $P = 12.4206012$ hours. The frequency in cycles per hour (cph) is $f_{0} = \\frac{1}{P} = \\frac{1}{12.4206012}$ cph.\n    To convert to cycles per day (cpd), we multiply by $24$ hours/day:\n    $$f_{0} = \\frac{24}{12.4206012} \\text{ cpd} \\approx 1.93227365 \\text{ cpd}$$\n\n2.  **Calculate the sampling frequency $f_s$**:\n    The sampling interval is $\\Delta t = 13$ hours. The sampling frequency is $f_{s} = \\frac{1}{\\Delta t} = \\frac{1}{13}$ cph.\n    Converting to cpd:\n    $$f_{s} = \\frac{24}{13} \\text{ cpd} \\approx 1.84615385 \\text{ cpd}$$\n\n3.  **Check for aliasing**:\n    The Nyquist frequency is $f_{N} = \\frac{f_{s}}{2} = \\frac{12}{13} \\text{ cpd} \\approx 0.92307692 \\text{ cpd}$.\n    Since $f_{0} \\approx 1.932 \\text{ cpd}$ is greater than $f_{N} \\approx 0.923 \\text{ cpd}$, aliasing will occur.\n\n4.  **Calculate the aliased frequency $f_{alias}$**:\n    First, find the integer index $k_{m}$:\n    $$k_{m} = \\text{round}\\left(\\frac{f_{0}}{f_{s}}\\right) = \\text{round}\\left(\\frac{24/12.4206012}{24/13}\\right) = \\text{round}\\left(\\frac{13}{12.4206012}\\right)$$\n    $$k_{m} = \\text{round}(1.046648...) = 1$$\n    Now, apply the aliasing formula:\n    $$f_{alias} = |f_{0} - k_{m}f_{s}| = \\left|\\frac{24}{12.4206012} - 1 \\cdot \\frac{24}{13}\\right|$$\n    $$f_{alias} = 24 \\left| \\frac{1}{12.4206012} - \\frac{1}{13} \\right|$$\n    Since $12.4206012 < 13$, the term inside the absolute value is positive.\n    $$f_{alias} = 24 \\left( \\frac{1}{12.4206012} - \\frac{1}{13} \\right) \\text{ cpd}$$\n    $$f_{alias} \\approx 24 \\times (0.0805118 - 0.0769231) \\text{ cpd} \\approx 24 \\times 0.0035887 \\text{ cpd}$$\n    $$f_{alias} \\approx 0.0861288 \\text{ cpd}$$\n    Using higher precision for the intermediate values:\n    $f_{0} \\approx 1.932273654$ cpd\n    $f_{s} \\approx 1.846153846$ cpd\n    $f_{alias} = |1.932273654 - 1.846153846| \\text{ cpd} = 0.086119808 \\text{ cpd}$\n\n    Rounding to five significant figures, we get $0.086120$.",
            "answer": "$$\\boxed{0.086120}$$"
        },
        {
            "introduction": "Once a time series is collected, the Discrete Fourier Transform (DFT) is our primary tool for examining its frequency content. A common computational trick is to \"zero-pad\" the data before applying a Fast Fourier Transform (FFT). This numerical experiment  is designed to provide a hands-on understanding of what zero-padding actually accomplishes—it interpolates the underlying spectrum, allowing for better peak localization—and what it does not: it cannot improve the fundamental resolution to separate closely spaced frequencies, which is dictated solely by the original observation duration.",
            "id": "3796017",
            "problem": "You will design and implement a numerical experiment to demonstrate, using the Discrete Fourier Transform (DFT), how zero-padding in time affects interpolated spectra and peak localization without increasing true resolution. The experiment must be self-contained and must generate synthetic time series, compute their spectra with and without zero-padding, and quantify specific properties of peak estimation and resolvability.\n\nStart from the following foundational base:\n- A uniformly sampled, finite-length scalar time series $\\{x[n]\\}_{n=0}^{N-1}$ with sampling interval $\\Delta t$ in days represents the restriction of a continuous signal to discrete times $t_n = n \\Delta t$.\n- The Discrete Fourier Transform (DFT) of $x[n]$ is defined by $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-i 2 \\pi k n/N}$ for integer $k$ in $\\{0,\\dots,N-1\\}$, and the corresponding Fourier frequencies are $f_k = \\frac{k}{N \\Delta t}$ in cycles per day (cpd).\n- The positive-frequency spectrum for real-valued signals is fully represented by the nonnegative-frequency subset (for example, the real-valued Fast Fourier Transform implementation that returns nonnegative frequencies).\n\nYour program must implement the following logic and use the following physical and numerical settings:\n- Construct synthetic oceanographic time series by summing a small number of sinusoids:\n  - For each sinusoid, use $x_i(t) = A_i \\cos\\left(2 \\pi f_i t + \\phi_i\\right)$, where $A_i$ is amplitude, $f_i$ is frequency in cycles per day (cpd), and $\\phi_i$ is phase in radians.\n  - Use $\\phi_i = 0$ radians for all sinusoids to avoid phase confounding, and use amplitudes $A_i = 1$ for all components.\n- Use a sampling interval $\\Delta t = \\frac{1}{24}$ days (that is, one-hour sampling) unless otherwise specified, and ensure that all frequency outputs and errors are expressed in cycles per day (cpd). All angles are in radians.\n\nZero-padding protocol:\n- Given a time series of length $N$, define a zero-padding factor $M \\in \\mathbb{N}$. Create a zero-padded series of length $N_p = M N$ by appending zeros and compute the DFT on the zero-padded series. This refines the frequency grid to $f_k = \\frac{k}{N_p \\Delta t}$ while keeping the original time information unchanged.\n- Peak frequency localization must be performed by selecting the frequency corresponding to the maximum magnitude of the nonnegative-frequency spectrum. Do not use any parametric fitting beyond this grid-based peak selection, since the goal is to demonstrate that zero-padding refines the sampling of the underlying discrete-time Fourier transform without injecting new information.\n\nResolvability assessment:\n- Define the non-padded frequency bin width as $\\Delta f_0 = \\frac{1}{N \\Delta t}$ in cycles per day (cpd).\n- Given a magnitude spectrum over nonnegative frequencies, define the set of local maxima as those indices $k$ such that the value at $k$ strictly exceeds its immediate neighbors. A spectrum is considered to exhibit two resolved peaks if there exist two local maxima that both exceed a specified relative height threshold $\\eta$ times the global maximum and are separated in frequency by at least $\\Delta f_0$. Use $\\eta = 0.4$.\n- Apply this resolvability criterion both without and with zero-padding; in the latter case, use the refined frequency grid to find local maxima but keep the separation threshold $\\Delta f_0$ referenced to the original non-padded record.\n\nTest suite:\nImplement the following four cases. In all cases except the last, use $\\Delta t = \\frac{1}{24}$ days, $N = 720$ samples (which corresponds to $30$ days), and a zero-padding factor $M = 8$. All amplitudes are $1$ and all phases are $0$ radians.\n1. Single sinusoid for peak localization:\n   - Frequencies: $\\{f_1\\} = \\{0.2\\}$ cpd.\n   - Compute the absolute errors in the peak frequency estimates (in cpd) for the non-padded spectrum and for the zero-padded spectrum. Output both errors as floats in cpd.\n2. Two close sinusoids below the nominal resolving capability:\n   - Frequencies: $\\{f_1, f_2\\} = \\{0.20, 0.22\\}$ cpd.\n   - Determine the resolvability booleans for the non-padded and zero-padded spectra according to the criterion above. Output both booleans.\n3. Two sinusoids sufficiently separated:\n   - Frequencies: $\\{f_1, f_2\\} = \\{0.20, 0.25\\}$ cpd.\n   - Determine the resolvability booleans for the non-padded and zero-padded spectra. Output both booleans.\n4. Boundary case with a very short record:\n   - Set $\\Delta t = \\frac{1}{24}$ days, $N = 64$ samples (which corresponds to approximately $2.666\\ldots$ days), and $M = 16$.\n   - Frequencies: $\\{f_1, f_2\\} = \\{0.20, 0.47\\}$ cpd.\n   - Determine the resolvability booleans for the non-padded and zero-padded spectra. Output both booleans.\n\nFinal output format:\n- Your program should produce a single line of output containing the results aggregated across the four cases as a comma-separated list enclosed in square brackets.\n- The required output is a list that contains:\n  - For case $1$: a two-element list $[\\text{error\\_no\\_pad}, \\text{error\\_pad}]$ with both entries as floats in cpd.\n  - For cases $2$, $3$, and $4$: a two-element list $[\\text{resolved\\_no\\_pad}, \\text{resolved\\_pad}]$ with boolean entries.\n- Concretely, the output must have the form\n  - $[[e_1^{\\text{no}}, e_1^{\\text{pad}}],[b_2^{\\text{no}}, b_2^{\\text{pad}}],[b_3^{\\text{no}}, b_3^{\\text{pad}}],[b_4^{\\text{no}}, b_4^{\\text{pad}}]]$\n  where $e_1^{\\text{no}}$ and $e_1^{\\text{pad}}$ are floats in cpd and $b_j^{\\text{no}}, b_j^{\\text{pad}}$ are booleans.\n\nScientific realism requirement:\n- Ensure that all computations use physically plausible frequencies and sampling consistent with oceanographic time series analysis. All frequency errors must be reported in cycles per day (cpd), and all angles are in radians.\n\nYour program must be a complete, runnable script that produces the specified single-line output without any user input or external files.",
            "solution": "The user has provided a problem statement that is scientifically grounded, well-posed, and objective. It outlines a standard numerical experiment in signal processing to demonstrate the properties of zero-padding in spectral analysis. All parameters and criteria are explicitly defined, allowing for a unique and computable solution. The problem is therefore deemed **valid**.\n\n### Principle-Based Solution Design\n\nThe core of this problem is to understand the relationship between a continuous-time signal, its discrete-time representation, and its computed spectrum via the Discrete Fourier Transform (DFT). The experiment contrasts the properties of a standard DFT with a zero-padded DFT to illustrate how padding affects spectral interpolation and peak estimation without altering the fundamental spectral resolution.\n\n**1. Theoretical Foundation: Continuous vs. Discrete Spectra**\n\nA continuous signal $x(t)$ has a continuous Fourier Transform. When we sample this signal at intervals of $\\Delta t$ to get a finite sequence $\\{x[n]\\}_{n=0}^{N-1}$, where $t_n = n \\Delta t$, we are working with a discrete and finite representation. The Fourier transform of this discrete sequence is the Discrete-Time Fourier Transform (DTFT), which is a continuous and periodic function of frequency:\n$$\nX(e^{j\\omega}) = \\sum_{n=0}^{N-1} x[n] e^{-j \\omega n}\n$$\nHere, $\\omega = 2 \\pi f \\Delta t$ is the normalized angular frequency. The shape of the DTFT is determined by the $N$ data points and is influenced by spectral leakage, which is the convolution of the true signal's spectrum with the spectrum of the implicit rectangular window of duration $T = N \\Delta t$.\n\nThe Discrete Fourier Transform (DFT), which is what computers calculate, is a *sampling* of the DTFT at a discrete set of frequencies. For an $N$-point DFT, these frequencies are $f_k = \\frac{k}{N \\Delta t}$ for $k=0, \\dots, N-1$. The DFT provides values of the DTFT only at these specific grid points.\n\n**2. The Role of Zero-Padding**\n\nZero-padding is the process of appending zeros to the time series $\\{x[n]\\}$ to create a longer series of length $N_p = M N$, where $M$ is the padding factor. Computing the DFT of this padded series does not add any new information about the original continuous signal $x(t)$; the information content is still limited by the original $N$ samples. However, what it does is compute the DFT on a finer frequency grid. The new frequency bins are located at $f_k' = \\frac{k}{N_p \\Delta t} = \\frac{k}{M N \\Delta t}$.\n\nThis is equivalent to evaluating the *original* DTFT, $X(e^{j\\omega})$, at $M$ times as many frequency points. The practical effect is a smooth interpolation of the spectrum between the original coarse DFT points, which can reveal details of the DTFT's shape, such as the true location and height of a spectral peak that falls between original DFT bins.\n\n**3. Spectral Resolution and Peak Resolvability**\n\nThe fundamental spectral resolution, often described by the Rayleigh criterion, is the ability to distinguish two nearby frequency components. This is primarily determined by the total observation time $T = N \\Delta t$. The minimum resolvable frequency separation is on the order of $\\Delta f_0 = \\frac{1}{T} = \\frac{1}{N \\Delta t}$. Zero-padding does not change $T$ and therefore does not improve this fundamental resolution. Two sinusoids with a frequency separation less than $\\Delta f_0$ will have their main lobes in the DTFT overlap to such an extent that they merge into a single peak. Zero-padding will simply show a more detailed view of this single, merged peak.\n\nThe problem defines a specific numerical criterion for resolvability: the existence of at least two local spectral maxima (peaks that are strictly greater than their neighbors) that both exceed a threshold of $\\eta=0.4$ times the global maximum and are separated in frequency by at least the fundamental resolution $\\Delta f_0$. This criterion is applied to both the non-padded and zero-padded spectra to quantify the effects.\n\n### Implementation Strategy\n\nThe solution is implemented by processing four distinct test cases. For each case, we perform the following steps:\n\n1.  **Generate Signal**: A synthetic time series is created by summing cosines with the specified frequencies, amplitudes ($A_i=1$), and phases ($\\phi_i=0$) over a discrete time grid defined by $N$ and $\\Delta t$.\n2.  **Compute Spectra**: Two spectra are computed:\n    *   **Non-padded**: An $N$-point Real Fast Fourier Transform (rFFT) is computed on the original time series.\n    *   **Zero-padded**: The time series is padded with zeros to length $N_p = M N$, and an $N_p$-point rFFT is computed.\n    For both, the corresponding frequency array and magnitude spectrum are obtained.\n3.  **Analyze and Quantify**:\n    *   **Case 1 (Peak Localization)**: The frequency corresponding to the maximum spectral magnitude is found for both spectra. The absolute error is calculated as $|f_{\\text{peak}} - f_{\\text{true}}|$.\n    *   **Cases 2, 3, 4 (Resolvability)**: The resolvability criterion is applied to both spectra. This involves identifying all local maxima, filtering them by the relative height threshold $\\eta$, and then checking if any pair of the remaining peaks has a frequency separation of at least $\\Delta f_0$. The reference separation $\\Delta f_0$ is always calculated from the original, non-padded length $N$.\n\nThis systematic process allows for a direct comparison of the results with and without zero-padding, demonstrating its utility and limitations.\n\n*   **Case 1**: Since the true frequency $f_1=0.2$ cpd is an exact multiple of the non-padded frequency bin width for $N=720$ ($\\Delta f_0 = 1/30$ cpd, and $0.2 = 6/30$), the peak falls exactly on a DFT bin. Thus, no localization error is expected in either the non-padded or padded case.\n*   **Case 2**: The frequency separation $\\delta f=0.02$ cpd is less than the resolution limit $\\Delta f_0 \\approx 0.0333$ cpd. The peaks are expected to be unresolvable in both spectra.\n*   **Case 3**: The separation $\\delta f=0.05$ cpd is greater than $\\Delta f_0$. The peaks are theoretically resolvable. However, the coarse grid of the non-padded DFT may fail to capture the valley between the peaks, leading to them being unresolved. The dense grid of the padded DFT should clearly reveal two separate peaks, demonstrating how padding helps visualize resolvable features.\n*   **Case 4**: The true frequency separation $\\delta f = 0.27$ cpd is less than the required separation threshold defined by the rule, $\\Delta f_0 = 0.375$ cpd. Therefore, even if two peaks are visible, they cannot satisfy the criterion, and the result should be unresolved in both cases. This case tests the strict application of the problem's custom rule.\n\nThe final code implements these steps for all four cases and formats the output as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy.fft import rfft, rfftfreq\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for all test cases and print results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Structure: (case_id, N, dt, M, frequencies, eta)\n    test_cases = [\n        (1, 720, 1/24, 8, [0.2], 0.4),\n        (2, 720, 1/24, 8, [0.20, 0.22], 0.4),\n        (3, 720, 1/24, 8, [0.20, 0.25], 0.4),\n        (4, 64, 1/24, 16, [0.20, 0.47], 0.4),\n    ]\n\n    results = []\n    for case_id, N, dt, M, freqs_true, eta in test_cases:\n        case_result = _process_case(case_id, N, dt, M, freqs_true, eta)\n        results.append(case_result)\n    \n    # Format the final output string exactly as required\n    # str(list) automatically adds spaces, which is fine according to the example structure.\n    # The template f\"[{','.join(map(str, results))}]\" correctly handles lists of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef _generate_time_series(frequencies, N, dt):\n    \"\"\"\n    Generates a synthetic time series by summing sinusoids.\n    Amplitudes are 1 and phases are 0 as per the problem statement.\n    \"\"\"\n    t = np.arange(N) * dt\n    x = np.zeros(N)\n    for f in frequencies:\n        x += 1.0 * np.cos(2 * np.pi * f * t + 0.0)\n    return x\n\ndef _compute_spectrum(x, dt, M_pad):\n    \"\"\"\n    Computes the non-negative frequency spectrum of a time series x,\n    with an optional zero-padding factor M_pad.\n    \"\"\"\n    N = len(x)\n    N_padded = N * M_pad\n    \n    if M_pad > 1:\n        x_padded = np.zeros(N_padded)\n        x_padded[:N] = x\n    else:\n        x_padded = x\n\n    # Use rfft for real-valued signals\n    spec = rfft(x_padded)\n    freqs = rfftfreq(N_padded, d=dt)\n    \n    # Return frequencies and magnitude spectrum\n    return freqs, np.abs(spec)\n\ndef _find_peak_frequency(freqs, spec):\n    \"\"\"\n    Finds the frequency corresponding to the maximum spectral magnitude.\n    \"\"\"\n    peak_idx = np.argmax(spec)\n    return freqs[peak_idx]\n\ndef _check_resolvability(freqs, spec, df0, eta):\n    \"\"\"\n    Applies the custom resolvability criterion from the problem statement.\n    \n    A spectrum has resolved peaks if:\n    1. There are at least two local maxima.\n    2. Each local maximum's magnitude is > eta * global_max_magnitude.\n    3. At least one pair of such peaks is separated by >= df0.\n    \"\"\"\n    if len(spec) < 3:\n        return False\n        \n    spec_max = np.max(spec)\n    threshold = eta * spec_max\n\n    local_max_indices = []\n    # A point is a local max if it's strictly greater than its neighbors\n    for k in range(1, len(spec) - 1):\n        if spec[k] > spec[k-1] and spec[k] > spec[k+1]:\n            if spec[k] > threshold:\n                local_max_indices.append(k)\n\n    if len(local_max_indices) < 2:\n        return False\n\n    peak_freqs = freqs[local_max_indices]\n\n    # Check all pairs of found peaks for the separation criterion\n    for i in range(len(peak_freqs)):\n        for j in range(i + 1, len(peak_freqs)):\n            if np.abs(peak_freqs[j] - peak_freqs[i]) >= df0:\n                return True\n    \n    return False\n\ndef _process_case(case_id, N, dt, M, freqs_true, eta):\n    \"\"\"\n    Processes a single test case, returning the required result structure.\n    \"\"\"\n    x = _generate_time_series(freqs_true, N, dt)\n    df0 = 1.0 / (N * dt)\n\n    # --- Non-padded analysis ---\n    freqs_no_pad, spec_no_pad = _compute_spectrum(x, dt, M_pad=1)\n    \n    if case_id == 1:\n        peak_freq_no_pad = _find_peak_frequency(freqs_no_pad, spec_no_pad)\n        error_no_pad = np.abs(peak_freq_no_pad - freqs_true[0])\n        result_no_pad = error_no_pad\n    else:\n        resolved_no_pad = _check_resolvability(freqs_no_pad, spec_no_pad, df0, eta)\n        result_no_pad = resolved_no_pad\n\n    # --- Zero-padded analysis ---\n    freqs_pad, spec_pad = _compute_spectrum(x, dt, M_pad=M)\n\n    if case_id == 1:\n        peak_freq_pad = _find_peak_frequency(freqs_pad, spec_pad)\n        error_pad = np.abs(peak_freq_pad - freqs_true[0])\n        result_pad = error_pad\n    else:\n        # The separation threshold df0 remains referenced to the UNPADDED record\n        resolved_pad = _check_resolvability(freqs_pad, spec_pad, df0, eta)\n        result_pad = resolved_pad\n        \n    return [result_no_pad, result_pad]\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "Spectral methods extend far beyond signal analysis; they offer exceptionally accurate techniques for solving the differential equations that model ocean dynamics. This exercise  introduces the Chebyshev collocation method, a powerful \"pseudospectral\" approach. You will learn how to discretize a complex integro-differential equation by enforcing it at a specific set of grid points (the Chebyshev-Gauss-Lobatto nodes), thereby transforming the continuous problem into a high-precision algebraic system for the unknown solution values.",
            "id": "2114664",
            "problem": "Consider the one-dimensional integro-differential equation on the domain $x \\in [-1, 1]$:\n$$-u_{xx}(x) + \\alpha u(x) = f(x) + \\beta \\int_{-1}^{1} u(y) \\, dy$$\nThe solution $u(x)$ is subject to the boundary conditions:\n$$u(-1) = 0 \\quad \\text{and} \\quad u'(1) = \\gamma u(1)$$\nHere, $\\alpha$, $\\beta$, and $\\gamma$ are real constants.\n\nWe aim to solve this problem numerically using a Chebyshev collocation (pseudospectral) method. The solution $u(x)$ is approximated by a single global polynomial $u_N(x)$ of degree at most $N$. The collocation points are the $N+1$ Chebyshev-Gauss-Lobatto (CGL) nodes, given by $x_j = \\cos\\left(\\frac{j\\pi}{N}\\right)$ for $j=0, 1, \\dots, N$. The values of the polynomial at these nodes, $u_j = u_N(x_j)$, are the unknowns to be determined. The differential equation and boundary conditions are enforced exactly at these nodes.\n\nFor a discretization with $N=3$, a forcing function $f(x) = 2x^2 - 1$, and constants $\\alpha=1$, $\\beta=1$, $\\gamma=1$, find the value of the solution at the node $x_1$, which is denoted by $u_1$.\n\nExpress your answer for $u_1$ as an exact fraction in simplest form.",
            "solution": "We discretize with $N=3$ Chebyshev-Gauss-Lobatto nodes $x_{j}=\\cos\\left(\\frac{j\\pi}{3}\\right)$ for $j=0,1,2,3$, which are\n$$\nx_{0}=1,\\quad x_{1}=\\frac{1}{2},\\quad x_{2}=-\\frac{1}{2},\\quad x_{3}=-1.\n$$\nLet $u_{j}=u(x_{j})$. The first-derivative Chebyshev differentiation matrix $D$ at these nodes has entries\n$$\nD_{ij}=\\begin{cases}\n\\dfrac{c_{i}}{c_{j}}\\dfrac{(-1)^{i+j}}{x_{i}-x_{j}}, & i\\neq j, \\\\[6pt]\n\\dfrac{2N^{2}+1}{6}, & i=j=0, \\\\[4pt]\n-\\dfrac{2N^{2}+1}{6}, & i=j=N, \\\\[4pt]\n-\\dfrac{x_{j}}{2(1-x_{j}^{2})}, & \\text{otherwise},\n\\end{cases}\n$$\nwith $c_{0}=c_{N}=2$ and $c_{1}=c_{2}=1$, $N=3$. A direct computation gives\n$$\nD=\\begin{pmatrix}\n\\dfrac{19}{6} & -4 & \\dfrac{4}{3} & -\\dfrac{1}{2} \\\\[6pt]\n1 & -\\dfrac{1}{3} & -1 & \\dfrac{1}{3} \\\\[6pt]\n-\\dfrac{1}{3} & 1 & \\dfrac{1}{3} & -1 \\\\[6pt]\n\\dfrac{1}{2} & -\\dfrac{4}{3} & 4 & -\\dfrac{19}{6}\n\\end{pmatrix}.\n$$\nThe second-derivative matrix is $D^{(2)}=D^{2}$. Multiplying, the rows needed at the interior nodes $j=1,2$ are\n$$\nD^{(2)}_{1,\\cdot}=\\left(\\dfrac{10}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{2}{3}\\right),\\qquad\nD^{(2)}_{2,\\cdot}=\\left(-\\dfrac{2}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{10}{3}\\right).\n$$\n\nWe enforce the PDE at the interior nodes and the boundary conditions at the endpoints. With $\\alpha=\\beta=\\gamma=1$ and $f(x)=2x^{2}-1$, the discrete equations at $j=1,2$ are\n$$\n-\\left(D^{(2)}u\\right)_{j}+u_{j}=f_{j}+I,\\quad j=1,2,\n$$\nwhere $I=\\int_{-1}^{1}u(y)\\,dy$ is approximated by exactly integrating the degree-$3$ interpolant $u_{N}$:\n$$\nI=\\sum_{j=0}^{3}w_{j}u_{j},\\quad w_{j}=\\int_{-1}^{1}\\ell_{j}(x)\\,dx.\n$$\nImposing exactness for monomials up to degree $3$ and using symmetry gives $w_{0}=w_{3}=a$, $w_{1}=w_{2}=b$ with\n$$\na+b=1,\\qquad 2a+\\frac{b}{2}=\\frac{2}{3}\\ \\Longrightarrow\\ a=\\frac{1}{9},\\ b=\\frac{8}{9}.\n$$\nHence\n$$\nI=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}+\\frac{1}{9}u_{3}.\n$$\n\nThe boundary conditions are $u(-1)=0\\Rightarrow u_{3}=0$ and $u'(1)=u(1)\\Rightarrow (Du)_{0}=u_{0}$, i.e.\n$$\n\\left(\\frac{19}{6}\\right)u_{0}-4u_{1}+\\left(\\frac{4}{3}\\right)u_{2}-\\left(\\frac{1}{2}\\right)u_{3}=u_{0}\\ \\Longrightarrow\\ 13u_{0}-24u_{1}+8u_{2}=0.\n$$\n\nEvaluate $f$ at the nodes:\n$$\nf_{0}=1,\\quad f_{1}=-\\frac{1}{2},\\quad f_{2}=-\\frac{1}{2},\\quad f_{3}=1.\n$$\nUsing $u_{3}=0$ and $I=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}$, the interior equations become\n$$\n-\\left(\\frac{10}{3}u_{0}-\\frac{16}{3}u_{1}+\\frac{8}{3}u_{2}\\right)+u_{1}=-\\frac{1}{2}+I,\n$$\n$$\n-\\left(-\\frac{2}{3}u_{0}+\\frac{8}{3}u_{1}-\\frac{16}{3}u_{2}\\right)+u_{2}=-\\frac{1}{2}+I.\n$$\nMultiplying both equations by $3$ and substituting $3I=\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}$ yields\n$$\n-10u_{0}+19u_{1}-8u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2},\n$$\n$$\n2u_{0}-8u_{1}+19u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}.\n$$\nBringing all terms to the left and clearing denominators (multiply by $6$) gives\n$$\n-62u_{0}+98u_{1}-64u_{2}=-9,\\qquad 10u_{0}-64u_{1}+98u_{2}=-9,\n$$\ntogether with the boundary-condition equation\n$$\n13u_{0}-24u_{1}+8u_{2}=0.\n$$\nFrom $13u_{0}-24u_{1}+8u_{2}=0$ we get $u_{0}=\\frac{24}{13}u_{1}-\\frac{8}{13}u_{2}$. Substituting this into the two interior equations yields the $2\\times 2$ system\n$$\n214u_{1}+336u_{2}=117,\\qquad 592u_{1}-1194u_{2}=117.\n$$\nSolving, one finds\n$$\nu_{1}=\\frac{765}{1942},\\qquad u_{2}=\\frac{189}{1942}.\n$$\nTherefore, the requested value at node $x_{1}$ is the exact fraction $u_{1}=\\frac{765}{1942}$.",
            "answer": "$$\\boxed{\\frac{765}{1942}}$$"
        }
    ]
}