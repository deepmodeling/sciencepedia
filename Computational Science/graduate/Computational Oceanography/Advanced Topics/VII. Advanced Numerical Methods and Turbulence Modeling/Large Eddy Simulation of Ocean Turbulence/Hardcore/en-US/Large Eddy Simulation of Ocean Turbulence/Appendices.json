{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp Large Eddy Simulation (LES), one must first see a subgrid-scale (SGS) model in action. The classic Smagorinsky model provides a foundational example, parameterizing the effect of unresolved turbulence as an \"eddy\" viscosity, $\\nu_t$, which is proportional to the shear in the resolved flow. This hands-on practice guides you through the implementation of this core concept, translating the filtered momentum equations into a tangible numerical simulation for a simplified shear flow. By computing the eddy viscosity and its diffusive effect, you will bridge the gap between theory and a working LES code. ",
            "id": "3798395",
            "problem": "Consider a depth-invariant barotropic plane shear current resolved in Large Eddy Simulation (LES) for ocean turbulence. The resolved velocity field is assumed horizontally homogeneous in the $x$ direction and vertically invariant, so that the two-dimensional velocity can be written as $\\mathbf{u}(y,t) = (u(y,t), 0)$ with $y \\in [0,L_y)$ and periodic boundary conditions in $y$. The filtered incompressible momentum equation is the starting point. With molecular viscosity $\\nu$ and subgrid-scale (SGS) stress $\\tau_{ij}$ arising from filtering, the resolved momentum equation is\n$$\n\\frac{\\partial u_i}{\\partial t} + \\frac{\\partial (u_i u_j)}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j} - \\frac{\\partial \\tau_{ij}}{\\partial x_j},\n$$\nwhere $\\rho$ is the density and $p$ is the pressure. In the Smagorinsky closure, the deviatoric part of $\\tau_{ij}$ is modeled using an eddy viscosity $\\nu_t$ built from the magnitude of the resolved rate-of-strain tensor $S_{ij}$, with\n$$\nS_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right), \\quad \\nu_t = (C_s \\Delta)^2 \\, \\lVert S \\rVert, \\quad \\lVert S \\rVert = \\sqrt{2 S_{ij} S_{ij}},\n$$\nwhere $C_s$ is the Smagorinsky constant and $\\Delta$ is the filter width, here taken equal to the uniform grid spacing $\\Delta y$. For the described one-dimensional shear flow $u(y,t)$, you must derive the appropriate expression for $\\lVert S \\rVert$ and formulate the update of $u$ over one explicit time step $\\Delta t$ using only the diffusive contribution from molecular viscosity and subgrid-scale eddy viscosity. Use a conservative discretization on a uniform periodic grid: compute the diffusive flux at cell faces as $f = (\\nu + \\nu_t) \\, \\partial_y u$ and then take its divergence at cell centers to obtain $\\partial_t u$.\n\nImplement a numerical solver that:\n- Builds the initial resolved velocity profile $u(y,0)$.\n- Computes the subgrid-scale eddy viscosity $\\nu_t$ at cell faces from the resolved shear magnitude at faces.\n- Forms the face diffusive flux $f$ and its discrete divergence to compute the tendency $\\partial_t u$ at cell centers.\n- Advances $u$ by one forward-Euler time step using only the diffusive term.\n- Reports the resolved velocity profile adjustment $\\Delta u(y) = u(y,\\Delta t) - u(y,0)$ and the updated center-point velocity $u(y=L_y/2,\\Delta t)$.\n\nAll computations and outputs must be expressed in meters per second ($\\mathrm{m/s}$). Angles, if present, must be in radians. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[\\max|\\Delta u|, u_{\\mathrm{center}}]$ with both entries in $\\mathrm{m/s}$. The center point is the grid point at index $\\lfloor N/2 \\rfloor$.\n\nUse the following test suite of parameter sets, each specified as $(U_0, L_y, N, C_s, \\Delta t, \\nu, n)$, where $U_0$ is the amplitude of the initial profile, $L_y$ is the domain length, $N$ is the number of grid points, $C_s$ is the Smagorinsky constant, $\\Delta t$ is the time step, $\\nu$ is the molecular viscosity, and $n$ is the integer wavenumber in the periodic initial profile $u(y,0) = U_0 \\sin(2\\pi n y / L_y)$; for the uniform-flow edge case, use a constant initial profile $u(y,0) = U_0$:\n1. Case A (happy path, periodic shear): $(U_0 = 1.0\\,\\mathrm{m/s}, L_y = 2000\\,\\mathrm{m}, N = 129, C_s = 0.12, \\Delta t = 50\\,\\mathrm{s}, \\nu = 1\\times 10^{-5}\\,\\mathrm{m^2/s}, n = 1)$.\n2. Case B (edge case, uniform flow): $(U_0 = 0.8\\,\\mathrm{m/s}, L_y = 1000\\,\\mathrm{m}, N = 128, C_s = 0.17, \\Delta t = 100\\,\\mathrm{s}, \\nu = 1\\times 10^{-5}\\,\\mathrm{m^2/s}, \\text{uniform profile})$.\n3. Case C (stronger shear, higher wavenumber): $(U_0 = 0.5\\,\\mathrm{m/s}, L_y = 1000\\,\\mathrm{m}, N = 257, C_s = 0.20, \\Delta t = 10\\,\\mathrm{s}, \\nu = 1\\times 10^{-5}\\,\\mathrm{m^2/s}, n = 2)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case yielding $[\\max|\\Delta u|, u_{\\mathrm{center}}]$ in $\\mathrm{m/s}$, for example, $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically Large Eddy Simulation (LES). The problem is well-posed, with a clear initial condition, periodic boundary conditions, and a defined (albeit simplified) governing equation. All terms, parameters, and required outputs are defined objectively and unambiguously. The requested task is a standard numerical exercise in discretizing and solving a partial differential equation.\n\nThe solution proceeds in two main parts: first, a theoretical derivation of the simplified governing equation for the specified flow conditions, and second, a detailed description of the numerical algorithm used to solve it.\n\n### Theoretical Formulation\n\nThe problem starts with the filtered incompressible momentum equation and asks to formulate an update for a one-dimensional shear flow $\\mathbf{u}(y,t) = (u(y,t), 0, 0)$ considering only diffusive terms. The governing equation for this simplified system is:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial y} \\left( (\\nu + \\nu_t) \\frac{\\partial u}{\\partial y} \\right)\n$$\nwhere $\\nu$ is the molecular viscosity and $\\nu_t$ is the subgrid-scale (SGS) eddy viscosity. The eddy viscosity is defined by the Smagorinsky model as $\\nu_t = (C_s \\Delta)^2 \\lVert S \\rVert$, where $C_s$ is the Smagorinsky constant, $\\Delta$ is the filter width (equal to the grid spacing $\\Delta y$), and $\\lVert S \\rVert$ is the magnitude of the resolved rate-of-strain tensor $S_{ij}$.\n\nOur first step is to derive the specific expression for $\\lVert S \\rVert$ for the given velocity field $\\mathbf{u} = (u_1, u_2, u_3) = (u(y,t), 0, 0)$ in Cartesian coordinates $(x_1, x_2, x_3) = (x, y, z)$.\n\nThe components of the rate-of-strain tensor $S_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)$ are calculated as follows:\n- The diagonal components are all zero:\n  $S_{11} = \\frac{\\partial u}{\\partial x} = 0$, since $u$ does not depend on $x$.\n  $S_{22} = \\frac{\\partial 0}{\\partial y} = 0$.\n  $S_{33} = \\frac{\\partial 0}{\\partial z} = 0$.\n- The off-diagonal components involving derivatives with respect to $x$ or $z$ are zero. The only non-zero components are:\n  $S_{12} = S_{21} = \\frac{1}{2} \\left( \\frac{\\partial u_1}{\\partial x_2} + \\frac{\\partial u_2}{\\partial x_1} \\right) = \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial 0}{\\partial x} \\right) = \\frac{1}{2} \\frac{\\partial u}{\\partial y}$.\n  $S_{13} = S_{31} = 0$ and $S_{23} = S_{32} = 0$.\n\nThe rate-of-strain tensor is thus:\n$$\nS = \\begin{pmatrix} 0 & \\frac{1}{2} \\frac{\\partial u}{\\partial y} & 0 \\\\ \\frac{1}{2} \\frac{\\partial u}{\\partial y} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe magnitude $\\lVert S \\rVert$ is defined as $\\lVert S \\rVert = \\sqrt{2 S_{ij} S_{ij}}$, where $S_{ij} S_{ij}$ is the sum of the squares of the tensor components (the squared Frobenius norm):\n$$\nS_{ij} S_{ij} = \\sum_{i,j=1}^3 S_{ij}^2 = S_{12}^2 + S_{21}^2 = \\left(\\frac{1}{2} \\frac{\\partial u}{\\partial y}\\right)^2 + \\left(\\frac{1}{2} \\frac{\\partial u}{\\partial y}\\right)^2 = 2 \\cdot \\frac{1}{4} \\left(\\frac{\\partial u}{\\partial y}\\right)^2 = \\frac{1}{2} \\left(\\frac{\\partial u}{\\partial y}\\right)^2\n$$\nSubstituting this into the definition of the magnitude:\n$$\n\\lVert S \\rVert = \\sqrt{2 \\cdot \\left(\\frac{1}{2} \\left(\\frac{\\partial u}{\\partial y}\\right)^2\\right)} = \\sqrt{\\left(\\frac{\\partial u}{\\partial y}\\right)^2} = \\left| \\frac{\\partial u}{\\partial y} \\right|\n$$\nThus, for this one-dimensional shear flow, the strain-rate magnitude is simply the absolute value of the velocity gradient. The eddy viscosity then becomes:\n$$\n\\nu_t = (C_s \\Delta y)^2 \\left| \\frac{\\partial u}{\\partial y} \\right|\n$$\n\n### Numerical Discretization\n\nWe employ a conservative finite volume method on a uniform, periodic grid. The domain $y \\in [0, L_y)$ is discretized into $N$ cells.\n\n1.  **Grid and Initial Profile:**\n    - The grid spacing is $\\Delta y = L_y / N$.\n    - Cell centers are located at $y_j = j \\Delta y$ for $j = 0, 1, \\ldots, N-1$. The velocity $u_j(t)$ is defined at these points.\n    - Cell faces are located at $y_{j+1/2} = (j+1/2)\\Delta y$.\n    - The initial velocity profile $u_j^0 = u(y_j, 0)$ is set according to the test case:\n      - For periodic shear: $u_j^0 = U_0 \\sin(2\\pi n y_j / L_y) = U_0 \\sin(2\\pi n j / N)$.\n      - For uniform flow: $u_j^0 = U_0$.\n\n2.  **Shear and Eddy Viscosity at Faces:**\n    The problem specifies that the eddy viscosity $\\nu_t$ is computed at cell faces based on the shear at faces. We approximate the shear at the face $j+1/2$ (between cells $j$ and $j+1$) using a second-order central difference:\n    $$\n    \\left( \\frac{\\partial u}{\\partial y} \\right)_{j+1/2} \\approx \\frac{u_{j+1} - u_j}{\\Delta y}\n    $$\n    Due to periodicity, $u_N = u_0$. This discrete shear is computed for all $N$ faces. The eddy viscosity at each face is then:\n    $$\n    \\nu_{t, j+1/2} = (C_s \\Delta y)^2 \\left| \\frac{u_{j+1} - u_j}{\\Delta y} \\right|\n    $$\n\n3.  **Diffusive Flux at Faces:**\n    The diffusive flux is $f = (\\nu + \\nu_t) \\frac{\\partial u}{\\partial y}$. At face $j+1/2$, the discrete flux $f_{j+1/2}$ is computed using the quantities already evaluated at the face:\n    $$\n    f_{j+1/2} = (\\nu + \\nu_{t, j+1/2}) \\left( \\frac{u_{j+1} - u_j}{\\Delta y} \\right)\n    $$\n\n4.  **Flux Divergence at Centers:**\n    The time tendency of the velocity at cell center $j$ is given by the divergence of the flux, $\\partial_t u = \\partial f / \\partial y$. This is discretized as a central difference of the face fluxes:\n    $$\n    \\left( \\frac{\\partial u}{\\partial t} \\right)_j = \\left( \\frac{\\partial f}{\\partial y} \\right)_j \\approx \\frac{f_{j+1/2} - f_{j-1/2}}{\\Delta y}\n    $$\n    For periodicity, the face \"left\" of cell $0$ (at $y_{-1/2}$) is the same as the face \"right\" of cell $N-1$ (at $y_{N-1/2}$). This is applied to all $N$ cell centers to find the array of time derivatives, $(\\partial u/\\partial t)_j$.\n\n5.  **Time Integration:**\n    A single forward-Euler step is used to update the velocity profile from time $t=0$ to $t=\\Delta t$. For each cell $j$:\n    $$\n    u_j(\\Delta t) = u_j(0) + \\Delta t \\left( \\frac{\\partial u}{\\partial t} \\right)_j\n    $$\n\n6.  **Output Calculation:**\n    - The velocity profile adjustment is $\\Delta u_j = u_j(\\Delta t) - u_j(0) = \\Delta t (\\partial u/\\partial t)_j$. The required output is $\\max_j |\\Delta u_j|$.\n    - The updated center-point velocity is $u_{\\mathrm{center}} = u_k(\\Delta t)$, where $k = \\lfloor N/2 \\rfloor$ is the index of the grid point at the center of the domain.\n\nThis numerical procedure is applied to each test case to generate the required results. For the uniform flow case, the initial shear is zero everywhere, leading to zero eddy viscosity and zero flux, resulting in no change in the velocity profile, as expected physically.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A: (U0, Ly, N, Cs, dt, nu, n)\n        (1.0, 2000.0, 129, 0.12, 50.0, 1e-5, 1),\n        # Case B: uniform flow, n is None\n        (0.8, 1000.0, 128, 0.17, 100.0, 1e-5, None),\n        # Case C\n        (0.5, 1000.0, 257, 0.20, 10.0, 1e-5, 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation_step(*case)\n        results.append(result)\n\n    # Format the final output string to be exactly [[r1_1,r1_2],[r2_1,r2_2],...]\n    # without any spaces as per the example in the problem description.\n    output_str = str(results).replace(' ', '')\n    print(output_str)\n\ndef run_simulation_step(U0, Ly, N, Cs, dt, nu, n_wave):\n    \"\"\"\n    Performs a single time step of the diffusive LES model for a 1D shear flow.\n\n    Args:\n        U0 (float): Amplitude of the initial velocity profile [m/s].\n        Ly (float): Domain length [m].\n        N (int): Number of grid points.\n        Cs (float): Smagorinsky constant.\n        dt (float): Time step [s].\n        nu (float): Molecular viscosity [m^2/s].\n        n_wave (int or None): Wavenumber for the sinusoidal profile. If None, a uniform profile is used.\n\n    Returns:\n        list: A list containing [max|Δu|, u_center] in m/s.\n    \"\"\"\n    \n    # 1. Grid and Initial Profile\n    # The filter width Delta is equal to the grid spacing dy.\n    dy = Ly / N\n    # Grid points are at cell centers y_j = j * dy.\n    y = np.arange(N) * dy\n    \n    if n_wave is not None:\n        # Periodic shear profile: u(y,0) = U0 * sin(2*pi*n*y / Ly)\n        # which simplifies to u_j = U0 * sin(2*pi*n*j / N)\n        u0 = U0 * np.sin(2 * np.pi * n_wave * y / Ly)\n    else:\n        # Uniform flow profile\n        u0 = U0 * np.ones(N)\n\n    # 2. Compute shear and eddy viscosity at cell faces\n    # The shear at face j+1/2 is (u_{j+1} - u_j) / dy.\n    # np.roll(u0, -1) provides u_{j+1} with periodic boundary conditions.\n    shear_at_faces = (np.roll(u0, -1) - u0) / dy\n    \n    # Eddy viscosity nu_t = (Cs * Delta)^2 * |S|, where |S| = |du/dy|\n    nu_t_faces = (Cs * dy)**2 * np.abs(shear_at_faces)\n    \n    # 3. Compute diffusive flux at faces\n    # The flux is f = (nu + nu_t) * (du/dy). All terms are evaluated at faces.\n    flux_faces = (nu + nu_t_faces) * shear_at_faces\n    \n    # 4. Compute flux divergence at cell centers\n    # The divergence at cell j is (f_{j+1/2} - f_{j-1/2}) / dy.\n    # np.roll(flux_faces, 1) provides f_{j-1/2}.\n    flux_divergence = (flux_faces - np.roll(flux_faces, 1)) / dy\n    dudt = flux_divergence\n    \n    # 5. Advance in time with a single forward-Euler step\n    # u_new = u_old + dt * (du/dt)\n    u1 = u0 + dt * dudt\n    \n    # 6. Calculate and report outputs\n    # Velocity adjustment is Δu = u1 - u0 = dt * dudt\n    delta_u = dt * dudt\n    max_abs_delta_u = np.max(np.abs(delta_u))\n    \n    # Center-point is at index floor(N/2)\n    center_index = N // 2\n    u_center = u1[center_index]\n    \n    return [max_abs_delta_u, u_center]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A crucial challenge in LES is distinguishing between the physical effects of the SGS model and the non-physical artifacts introduced by the numerical discretization scheme. This exercise confronts this issue head-on by using modified equation analysis, a powerful technique for revealing the \"implicit\" numerical diffusion inherent in a given numerical scheme. You will derive the leading-order error term for a common advection scheme, which manifests as a diffusive process. By comparing this numerical diffusivity, $\\kappa_{\\mathrm{num}}$, to the explicit physical diffusivity from a Smagorinsky model, $\\kappa_{S}$, you will gain essential insight into the delicate balance required to ensure that the modeled physics are not overwhelmed by numerical errors. ",
            "id": "3798414",
            "problem": "Consider Large Eddy Simulation (LES) of a passive tracer in horizontally homogeneous oceanic flow. The resolved tracer field $\\theta(x,t)$ obeys the one-dimensional linear advection equation $\\partial_{t} \\theta + U \\,\\partial_{x} \\theta = 0$, with constant velocity $U>0$. The tracer is discretized on a uniform grid with spacing $\\Delta x$ (identify the LES filter scale with $\\Delta \\equiv \\Delta x$), and advanced in time with step $\\Delta t$ using a first-order upwind spatial discretization and forward Euler time stepping. The explicit update at grid point $x_i$ and time level $t^{n}$ is\n$\\theta_i^{n+1} = \\theta_i^{n} - C \\left(\\theta_i^{n} - \\theta_{i-1}^{n}\\right)$\nfor Courant number $C \\equiv U \\,\\Delta t / \\Delta x$.\n\nStarting from the continuous advection equation and this explicit scheme definition (no other numerical-analysis shortcuts are permitted), perform a modified-equation analysis that is valid for sufficiently smooth $\\theta$ and sufficiently small wavenumber $k$ to derive the leading-order continuous equation that the scheme actually integrates. Isolate the nonphysical diffusive term of the form $\\kappa_{\\mathrm{num}}\\,\\partial_{x}^{2} \\theta$ that arises from the discretization, and express the effective numerical diffusivity $\\kappa_{\\mathrm{num}}$ in terms of $U$, $\\Delta$, and $C$.\n\nIn the Smagorinsky subgrid-scale closure for LES, the eddy viscosity is $\\nu_{S} = \\left(C_{s}\\,\\Delta\\right)^{2}\\,|S|$, where $C_{s}$ is the Smagorinsky constant and $|S|$ is the magnitude of the resolved strain-rate tensor. Assume a turbulent Prandtl number equal to $1$, so that the eddy diffusivity for the passive tracer is $\\kappa_{S} = \\nu_{S}$. Using your derived $\\kappa_{\\mathrm{num}}$, quantify the relative strength of numerical diffusion to Smagorinsky diffusion at the grid scale by forming the ratio $R \\equiv \\kappa_{\\mathrm{num}} / \\kappa_{S}$.\n\nProvide your final answer as a single closed-form analytic expression for $R$ in terms of $U$, $C$, $C_{s}$, $\\Delta$, and $|S|$. No numerical evaluation or rounding is required. The ratio is dimensionless, so no units should be reported.",
            "solution": "This problem requires a modified-equation analysis of the first-order upwind scheme to find its leading-order truncation error, which manifests as numerical diffusion. This numerical diffusivity is then compared to the physical subgrid-scale (SGS) diffusivity from a Smagorinsky model.\n\n**1. Modified-Equation Analysis**\n\nThe given numerical scheme is:\n$$ \\theta_i^{n+1} = \\theta_i^{n} - C \\left(\\theta_i^{n} - \\theta_{i-1}^{n}\\right) $$\nwhere $C = U \\Delta t / \\Delta x$ is the Courant number. We rearrange this to represent a finite-difference approximation of the time derivative:\n$$ \\frac{\\theta_i^{n+1} - \\theta_i^{n}}{\\Delta t} = - \\frac{U}{\\Delta x} \\left(\\theta_i^{n} - \\theta_{i-1}^{n}\\right) $$\nNow, we expand each term in a Taylor series around the point $(x_i, t^n)$, assuming the function $\\theta(x,t)$ is sufficiently smooth.\n\nThe left-hand side (LHS) is a forward difference in time:\n$$ \\text{LHS} = \\frac{\\theta(x_i, t^n + \\Delta t) - \\theta(x_i, t^n)}{\\Delta t} = \\partial_t \\theta + \\frac{\\Delta t}{2} \\partial_{tt} \\theta + O((\\Delta t)^2) $$\nThe right-hand side (RHS) contains a backward difference in space. We first expand $\\theta(x_i - \\Delta x, t^n)$:\n$$ \\theta_{i-1}^{n} = \\theta_i^n - \\Delta x \\, \\partial_x \\theta + \\frac{(\\Delta x)^2}{2} \\, \\partial_{xx} \\theta + O((\\Delta x)^3) $$\nSubstituting this into the spatial difference term of the RHS gives:\n$$ \\theta_i^n - \\theta_{i-1}^n = \\Delta x \\, \\partial_x \\theta - \\frac{(\\Delta x)^2}{2} \\, \\partial_{xx} \\theta + O((\\Delta x)^3) $$\nThe full RHS becomes:\n$$ \\text{RHS} = - \\frac{U}{\\Delta x} \\left( \\Delta x \\, \\partial_x \\theta - \\frac{(\\Delta x)^2}{2} \\, \\partial_{xx} \\theta + \\dots \\right) = -U \\partial_x \\theta + \\frac{U \\Delta x}{2} \\partial_{xx} \\theta + O((\\Delta x)^2) $$\n\nEquating the expanded LHS and RHS gives the modified equation:\n$$ \\partial_t \\theta + \\frac{\\Delta t}{2} \\partial_{tt} \\theta = -U \\partial_x \\theta + \\frac{U \\Delta x}{2} \\partial_{xx} \\theta + \\text{H.O.T.} $$\n$$ \\implies \\partial_t \\theta + U \\partial_x \\theta = \\frac{U \\Delta x}{2} \\partial_{xx} \\theta - \\frac{\\Delta t}{2} \\partial_{tt} \\theta + \\text{H.O.T.} $$\nTo isolate the diffusive term, we must express $\\partial_{tt} \\theta$ in terms of spatial derivatives. To leading order, the scheme approximates the original PDE, so we can state $\\partial_t \\theta \\approx -U \\partial_x \\theta$. Differentiating this gives $\\partial_{tt} \\theta \\approx -U \\partial_t(\\partial_x \\theta) = -U \\partial_x(\\partial_t \\theta) \\approx -U \\partial_x(-U \\partial_x \\theta) = U^2 \\partial_{xx} \\theta$.\n\nSubstituting this back into the modified equation:\n$$ \\partial_t \\theta + U \\partial_x \\theta = \\frac{U \\Delta x}{2} \\partial_{xx} \\theta - \\frac{\\Delta t}{2} (U^2 \\partial_{xx} \\theta) = \\left(\\frac{U \\Delta x}{2} - \\frac{U^2 \\Delta t}{2}\\right) \\partial_{xx} \\theta $$\nThe coefficient of the second derivative is the numerical diffusivity, $\\kappa_{\\mathrm{num}}$:\n$$ \\kappa_{\\mathrm{num}} = \\frac{U \\Delta x}{2} \\left(1 - \\frac{U \\Delta t}{\\Delta x}\\right) $$\nUsing the problem's notation $\\Delta = \\Delta x$ and $C = U \\Delta t / \\Delta x$, we have:\n$$ \\kappa_{\\mathrm{num}} = \\frac{U \\Delta}{2} (1 - C) $$\n\n**2. Ratio of Diffusivities**\n\nThe problem states that the Smagorinsky eddy diffusivity for the tracer is $\\kappa_S = \\nu_S$, since the turbulent Prandtl number is 1. The eddy viscosity is given as $\\nu_S = (C_s \\Delta)^2 |S|$. Therefore:\n$$ \\kappa_S = (C_s \\Delta)^2 |S| $$\nThe ratio $R$ of numerical to physical SGS diffusivity is:\n$$ R = \\frac{\\kappa_{\\mathrm{num}}}{\\kappa_S} = \\frac{\\frac{U \\Delta}{2} (1 - C)}{(C_s \\Delta)^2 |S|} $$\nSimplifying the expression by canceling a factor of $\\Delta$:\n$$ R = \\frac{U (1 - C)}{2 C_s^2 \\Delta |S|} $$\nThis is the final required expression.",
            "answer": "$$ \\boxed{ R = \\frac{U (1 - C)}{2 C_s^2 \\Delta |S|} } $$"
        },
        {
            "introduction": "A significant limitation of the basic Smagorinsky model is its reliance on a user-specified constant, $C_s$, which is not universally applicable. Dynamic models overcome this by calculating an appropriate coefficient directly from the resolved flow field. This practice delves into the theoretical heart of this procedure: the Germano identity, which relates the SGS stresses at two different filter scales. You will perform a concrete calculation on a discrete dataset to decompose the sub-test-scale stress, $T_{ij}$, into its three constituent parts—the Leonard, cross, and Reynolds terms. This decomposition provides a tangible understanding of how information from the resolved scales is leveraged to create a more intelligent and adaptive turbulence model. ",
            "id": "3798422",
            "problem": "Consider a one-dimensional transect across an ocean mixed layer where the horizontally homogeneous, incompressible velocity field has two nonzero Cartesian components, $u_{1}(x)$ and $u_{2}(x)$, interpreted as the zonal and meridional velocities, respectively. In a Large Eddy Simulation (LES), define a spatial filtering operator at the grid scale $\\Delta$ as $\\overline{f}(x) = \\int G_{\\Delta}(\\xi) f(x-\\xi) \\, d\\xi$ and a second, coarser test filter at $\\tilde{\\Delta} = \\alpha \\Delta$ as $\\widehat{f}(x) = \\int G_{\\tilde{\\Delta}}(\\xi) f(x-\\xi) \\, d\\xi$, where $G_{\\Delta}$ and $G_{\\tilde{\\Delta}}$ are normalized, even kernels. The subgrid-scale (SGS) stress at the grid scale is defined by $\\tau_{ij}(x) = \\overline{u_{i} u_{j}}(x) - \\overline{u}_{i}(x)\\,\\overline{u}_{j}(x)$, and the SGS stress at the test scale is $T_{ij}(x) = \\widehat{u_{i} u_{j}}(x) - \\widehat{u}_{i}(x)\\,\\widehat{u}_{j}(x)$. Start from these definitions and, by writing $u_{i} = \\overline{u}_{i} + u_{i}'$ with $u_{i}'$ the grid-scale subfilter fluctuation, derive the Germano decomposition of $T_{ij}$ into Leonard, cross, and Reynolds terms at the test scale.\n\nThen, compute these three terms for the off-diagonal component $i=1$, $j=2$ at a specific location $x_{0}$, using the following discrete, periodic, three-point representation. You are given the raw velocities at three equally spaced points with periodic boundary conditions:\n$$\nu_{1} = \\begin{pmatrix} 0.40 & 0.55 & 0.70 \\end{pmatrix} \\, , \\quad\nu_{2} = \\begin{pmatrix} 0.10 & -0.05 & 0.25 \\end{pmatrix} \\, ,\n$$\nwhere the entries correspond to $x_{1}$, $x_{2}=x_{0}$, $x_{3}$. The grid filter at scale $\\Delta$ is a discrete convolution centered at each point with weights $\\left( \\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4} \\right)$ applied to the nearest neighbors and the point itself (using periodic extension), i.e.,\n$$\n\\overline{f}(x_{k}) = \\frac{1}{4} f(x_{k-1}) + \\frac{1}{2} f(x_{k}) + \\frac{1}{4} f(x_{k+1}) \\, ,\n$$\nwith indices taken modulo $3$. The test filter at scale $\\tilde{\\Delta}$ is the equal-weight average over the three points,\n$$\n\\widehat{f}(x_{2}) = \\frac{1}{3}\\left[ f(x_{1}) + f(x_{2}) + f(x_{3}) \\right] \\, .\n$$\nProceed as follows:\n1. Using the above definitions, derive the decomposition of $T_{12}$ at $x_{2}$ into a sum of three contributions that are customarily called the Leonard, cross, and Reynolds terms.\n2. Compute the filtered fields $\\overline{u}_{i}(x_{k})$, the fluctuations $u_{i}'(x_{k})$, and all test-filtered quantities needed to evaluate each term at $x_{2}$.\n3. Report the three values for the off-diagonal component at $x_{2}$ as a single row vector $\\left( L_{12}, C_{12}, R_{12} \\right)$.\n\nExpress the final components in $\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$. Provide exact values; do not round. The final answer must be a single row matrix containing the three components in the order Leonard, cross, Reynolds.",
            "solution": "This problem requires both a theoretical derivation of the Germano decomposition and a concrete numerical calculation of its components for a given discrete velocity field.\n\n**1. Derivation of the Germano Decomposition**\n\nThe test-scale subgrid-scale (SGS) stress is defined as $T_{ij} = \\widehat{u_i u_j} - \\widehat{u}_i \\widehat{u}_j$. We decompose the velocity field into its grid-filtered (resolved) part and its subfilter part: $u_i = \\overline{u}_i + u'_i$. Substituting this into the definition of $T_{ij}$ and expanding gives:\n$$ T_{ij} = \\widehat{(\\overline{u}_i + u'_i)(\\overline{u}_j + u'_j)} - \\widehat{(\\overline{u}_i + u'_i)} \\widehat{(\\overline{u}_j + u'_j)} $$\n$$ T_{ij} = \\left(\\widehat{\\overline{u}_i \\overline{u}_j} + \\widehat{\\overline{u}_i u'_j} + \\widehat{u'_i \\overline{u}_j} + \\widehat{u'_i u'_j}\\right) - \\left(\\widehat{\\overline{u}}_i \\widehat{\\overline{u}}_j + \\widehat{\\overline{u}}_i \\widehat{u'_j} + \\widehat{u'_i} \\widehat{\\overline{u}}_j + \\widehat{u'_i} \\widehat{u'_j}\\right) $$\nThis expression can be grouped into three physically distinct terms:\n\n-   The **Leonard term ($L_{ij}$)**, which represents stresses from resolved-scale interactions:\n    $$ L_{ij} = \\widehat{\\overline{u}_i \\overline{u}_j} - \\widehat{\\overline{u}}_i \\widehat{\\overline{u}}_j $$\n-   The **cross term ($C_{ij}$)**, which represents interactions between resolved and subfilter scales:\n    $$ C_{ij} = (\\widehat{\\overline{u}_i u'_j} + \\widehat{u'_i \\overline{u}_j}) - (\\widehat{\\overline{u}}_i \\widehat{u'_j} + \\widehat{u'_i} \\widehat{\\overline{u}}_j) $$\n-   The **Reynolds term ($R_{ij}$)**, which represents stresses from subfilter-scale interactions:\n    $$ R_{ij} = \\widehat{u'_i u'_j} - \\widehat{u'_i} \\widehat{u'_j} $$\nThe full decomposition is thus $T_{ij} = L_{ij} + C_{ij} + R_{ij}$.\n\n**2. Numerical Computation at $x_2$**\n\nWe are given the raw velocity data:\n$u_{1} = \\begin{pmatrix} 0.40 & 0.55 & 0.70 \\end{pmatrix}$\n$u_{2} = \\begin{pmatrix} 0.10 & -0.05 & 0.25 \\end{pmatrix}$\n\nFirst, we compute the grid-filtered fields $\\overline{u}_i$ using the filter weights $(\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4})$ with periodic boundaries:\n$\\overline{u}_{1}(x_1) = \\frac{1}{4}(0.70) + \\frac{1}{2}(0.40) + \\frac{1}{4}(0.55) = 0.5125$\n$\\overline{u}_{1}(x_2) = \\frac{1}{4}(0.40) + \\frac{1}{2}(0.55) + \\frac{1}{4}(0.70) = 0.55$\n$\\overline{u}_{1}(x_3) = \\frac{1}{4}(0.55) + \\frac{1}{2}(0.70) + \\frac{1}{4}(0.40) = 0.5875$\nSo, $\\overline{u}_{1} = \\begin{pmatrix} 0.5125 & 0.55 & 0.5875 \\end{pmatrix}$.\n\n$\\overline{u}_{2}(x_1) = \\frac{1}{4}(0.25) + \\frac{1}{2}(0.10) + \\frac{1}{4}(-0.05) = 0.10$\n$\\overline{u}_{2}(x_2) = \\frac{1}{4}(0.10) + \\frac{1}{2}(-0.05) + \\frac{1}{4}(0.25) = 0.0625$\n$\\overline{u}_{2}(x_3) = \\frac{1}{4}(-0.05) + \\frac{1}{2}(0.25) + \\frac{1}{4}(0.10) = 0.1375$\nSo, $\\overline{u}_{2} = \\begin{pmatrix} 0.10 & 0.0625 & 0.1375 \\end{pmatrix}$.\n\nNext, we compute the fluctuations $u'_i = u_i - \\overline{u}_i$:\n$u'_{1} = \\begin{pmatrix} 0.40 - 0.5125 \\\\ 0.55 - 0.55 \\\\ 0.70 - 0.5875 \\end{pmatrix} = \\begin{pmatrix} -0.1125 & 0 & 0.1125 \\end{pmatrix}$\n$u'_{2} = \\begin{pmatrix} 0.10 - 0.10 \\\\ -0.05 - 0.0625 \\\\ 0.25 - 0.1375 \\end{pmatrix} = \\begin{pmatrix} 0 & -0.1125 & 0.1125 \\end{pmatrix}$\n\nNow we apply the test filter (3-point average) to all necessary fields to evaluate the terms at $x_2$:\n$\\widehat{\\overline{u}}_1 = \\frac{1}{3}(0.5125 + 0.55 + 0.5875) = 0.55$\n$\\widehat{\\overline{u}}_2 = \\frac{1}{3}(0.10 + 0.0625 + 0.1375) = 0.10$\n$\\widehat{u'}_1 = \\frac{1}{3}(-0.1125 + 0 + 0.1125) = 0$\n$\\widehat{u'}_2 = \\frac{1}{3}(0 - 0.1125 + 0.1125) = 0$\n\nWe also need the test-filtered products:\n$\\widehat{\\overline{u}_1 \\overline{u}_2} = \\frac{1}{3}( (0.5125)(0.10) + (0.55)(0.0625) + (0.5875)(0.1375) ) = \\frac{1}{3}(0.05125 + 0.034375 + 0.08078125) = 0.05546875$\n$\\widehat{u'_1 u'_2} = \\frac{1}{3}( (-0.1125)(0) + (0)(-0.1125) + (0.1125)(0.1125) ) = \\frac{1}{3}(0 + 0 + 0.01265625) = 0.00421875$\n$\\widehat{\\overline{u}_1 u'_2 + u'_1 \\overline{u}_2} = \\frac{1}{3}( (-0.01125) + (-0.061875) + (0.0815625) ) = \\frac{1}{3}(0.0084375) = 0.0028125$\n\nFinally, we calculate the three components for the off-diagonal term $T_{12}$ at $x_2$:\n**Leonard term:**\n$L_{12} = \\widehat{\\overline{u}_1 \\overline{u}_2} - \\widehat{\\overline{u}}_1 \\widehat{\\overline{u}}_2 = 0.05546875 - (0.55)(0.10) = 0.00046875$\n\n**Cross term:**\n$C_{12} = (\\widehat{\\overline{u}_1 u'_2 + u'_1 \\overline{u}_2}) - (\\widehat{\\overline{u}}_1 \\widehat{u'_2} + \\widehat{u'_1} \\widehat{\\overline{u}}_2) = 0.0028125 - ((0.55)(0) + (0)(0.10)) = 0.0028125$\n\n**Reynolds term:**\n$R_{12} = \\widehat{u'_1 u'_2} - \\widehat{u'_1} \\widehat{u'_2} = 0.00421875 - (0)(0) = 0.00421875$\n\nThe resulting vector $(L_{12}, C_{12}, R_{12})$ at $x_2$ is $(0.00046875, 0.0028125, 0.00421875)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.00046875 & 0.0028125 & 0.00421875\n\\end{pmatrix}\n}\n$$"
        }
    ]
}