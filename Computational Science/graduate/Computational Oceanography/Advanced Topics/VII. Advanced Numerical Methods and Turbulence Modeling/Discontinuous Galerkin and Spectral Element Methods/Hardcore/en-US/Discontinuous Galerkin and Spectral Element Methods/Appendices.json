{
    "hands_on_practices": [
        {
            "introduction": "Understanding a numerical method begins with building it from the ground up on a simple, representative problem. This first practice focuses on the linear advection equation, $u_t + a u_x = 0$, to guide you through the explicit construction of a Discontinuous Galerkin (DG) scheme. By deriving the element mass and stiffness matrices, assembling the global system with upwind flux, and analyzing its stability via the spectral radius, you will gain a concrete, hands-on understanding of the fundamental mechanics of the DG method .",
            "id": "4031827",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a  0$ on the periodic domain $[0,2h]$, partitioned into $2$ uniform elements $K_{1} = [0,h]$ and $K_{2} = [h,2h]$. On each element $K_{e}$, use a Discontinuous Galerkin (DG) discretization of polynomial degree $p=1$ with the local nodal (Lagrange) basis $\\{\\psi_{e,1},\\psi_{e,2}\\}$ defined by $\\psi_{e,1}(x_{e-1/2})=1$, $\\psi_{e,1}(x_{e+1/2})=0$, $\\psi_{e,2}(x_{e-1/2})=0$, and $\\psi_{e,2}(x_{e+1/2})=1$, where $x_{e-1/2}$ and $x_{e+1/2}$ are the left and right endpoints of $K_{e}$, respectively. Use the standard weak DG form obtained by integrating by parts once on each element, exact quadrature for all integrals, and the upwind numerical flux for $a0$, namely $\\hat{u}$ at any interface equals the left trace. Impose periodic boundary conditions at $x=0$ and $x=2h$.\n\nLet the semi-discrete DG approximation be $u_{h}(x,t)\\big|_{K_{e}}=\\sum_{j=1}^{2}u_{e,j}(t)\\,\\psi_{e,j}(x)$, and collect the degrees of freedom into the vector $\\mathbf{u}(t) = \\big(u_{1,1}(t),u_{1,2}(t),u_{2,1}(t),u_{2,2}(t)\\big)^{\\top}$. \n\nTasks:\n- Starting from the DG weak form, derive the element-level mass and volume terms and the numerical flux contributions, and assemble the explicit semi-discrete $4\\times 4$ linear system $\\dot{\\mathbf{u}} = \\mathcal{A}\\,\\mathbf{u}$ under the stated upwind flux and periodicity.\n- For this two-element periodic system, compute the spectral radius $\\rho(\\mathcal{A})$ of the semi-discrete spatial operator as a closed-form expression in terms of $a$ and $h$.\n\nProvide your final answer as a single closed-form expression for $\\rho(\\mathcal{A})$ in terms of $a$ and $h$. No rounding is required and no units should be included in the final answer.",
            "solution": "The user wants me to solve the problem by following these steps:\n\n1.  **Validate the problem:** The problem statement is scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in the numerical analysis of partial differential equations, specifically focusing on the Discontinuous Galerkin (DG) method. All required information is provided, and there are no contradictions or ambiguities. The problem is valid.\n\n2.  **Provide a solution:**\n    *   I will start by deriving the semi-discrete system, including elemental matrices and flux contributions.\n    *   Then, I will assemble the global $4 \\times 4$ system matrix.\n    *   Finally, I will compute the eigenvalues of this matrix to find its spectral radius.\n\n### Derivation of the Semi-Discrete System\n\nThe problem considers the linear advection equation $u_{t} + a\\,u_{x} = 0$ with $a  0$. The Discontinuous Galerkin (DG) weak formulation on an element $K_e$ is obtained by multiplying the PDE by a test function $v_h$ from the same polynomial space as the trial function $u_h$, integrating over $K_e$, and applying integration by parts to the spatial derivative term:\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx - a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx + [a\\, u_h v_h]_{x_{e-1/2}}^{x_{e+1/2}} = 0\n$$\nThe boundary term is replaced by numerical fluxes, leading to:\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx = a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx - a \\hat{u}(x_{e+1/2}) v_h(x_{e+1/2}^{-}) + a \\hat{u}(x_{e-1/2}) v_h(x_{e-1/2}^{+})\n$$\nwhere $x_{e-1/2}$ and $x_{e+1/2}$ are the left and right endpoints of element $K_e$, and $\\hat{u}$ is the numerical flux.\n\nThe solution on element $K_e$ is approximated as $u_h(x,t) = \\sum_{j=1}^{2} u_{e,j}(t) \\psi_{e,j}(x)$, where $\\{\\psi_{e,j}\\}$ is the local nodal basis of degree $p=1$. On a uniform element of length $h$, we can define local coordinates $x' = x - x_{e-1/2} \\in [0, h]$. The basis functions are linear polynomials:\n$$\n\\psi_{e,1}(x') = 1 - \\frac{x'}{h}, \\quad \\psi_{e,2}(x') = \\frac{x'}{h}\n$$\nTheir derivatives are:\n$$\n\\frac{d\\psi_{e,1}}{dx} = -\\frac{1}{h}, \\quad \\frac{d\\psi_{e,2}}{dx} = \\frac{1}{h}\n$$\nChoosing the test functions $v_h$ to be the basis functions $\\psi_{e,i}$, we obtain an element-wise system of ordinary differential equations (ODEs):\n$$\n\\mathbf{M}^e \\dot{\\mathbf{u}}_e = a \\mathbf{S}^e \\mathbf{u}_e + \\mathbf{F}^e\n$$\nwhere $\\mathbf{u}_e(t) = (u_{e,1}(t), u_{e,2}(t))^{\\top}$. The element mass matrix $\\mathbf{M}^e$ and stiffness matrix $\\mathbf{S}^e$ have components:\n$M^e_{ij} = \\int_{K_e} \\psi_{e,j} \\psi_{e,i} \\,dx$ and $S^e_{ij} = \\int_{K_e} \\psi_{e,j} \\frac{d\\psi_{e,i}}{dx} \\,dx$. Exact integration yields:\n$$\n\\mathbf{M}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})^2  \\frac{x'}{h}(1-\\frac{x'}{h}) \\\\ \\frac{x'}{h}(1-\\frac{x'}{h})  (\\frac{x'}{h})^2 \\end{pmatrix} dx' = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\n\\mathbf{S}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})(-\\frac{1}{h})  \\frac{x'}{h}(-\\frac{1}{h}) \\\\ (1-\\frac{x'}{h})(\\frac{1}{h})  \\frac{x'}{h}(\\frac{1}{h}) \\end{pmatrix} dx' = \\frac{1}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}\n$$\nThe flux vector $\\mathbf{F}^e$ for test functions $\\psi_{e,i}$ is:\n$$\nF^e_i = -a \\hat{u}(x_{e+1/2}) \\psi_{e,i}(x_{e+1/2}) + a \\hat{u}(x_{e-1/2}) \\psi_{e,i}(x_{e-1/2})\n$$\nFor $i=1$, $\\psi_{e,1}(x_{e-1/2})=1, \\psi_{e,1}(x_{e+1/2})=0$, so $F^e_1 = a \\hat{u}(x_{e-1/2})$.\nFor $i=2$, $\\psi_{e,2}(x_{e-1/2})=0, \\psi_{e,2}(x_{e+1/2})=1$, so $F^e_2 = -a \\hat{u}(x_{e+1/2})$.\nThus, $\\mathbf{F}^e = a \\begin{pmatrix} \\hat{u}(x_{e-1/2}) \\\\ -\\hat{u}(x_{e+1/2}) \\end{pmatrix}$.\n\n### Assembling the Global System\n\nThe domain $[0, 2h]$ is split into $K_1=[0,h]$ and $K_2=[h,2h]$. The global vector of degrees of freedom is $\\mathbf{u} = (u_{1,1}, u_{1,2}, u_{2,1}, u_{2,2})^{\\top}$. The problem specifies upwind flux for $a0$, so $\\hat{u}=u^{-}$, and periodic boundary conditions.\n- At the interface $x=h$: $\\hat{u}(h) = u^{-}(h) = u_h(h)|_{K_1} = u_{1,2}$.\n- At the interface $x=0 \\equiv 2h$: Periodicity implies the state \"left\" of $x=0$ is the state at $x=2h$. Thus, $\\hat{u}(0) = u^{-}(0) = u_h(2h)|_{K_2} = u_{2,2}$. The flux at $x=2h$ is also $\\hat{u}(2h) = u_h(2h)|_{K_2} = u_{2,2}$.\n\n**For element $K_1 = [0,h]$:**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{1,1} \\\\ \\dot{u}_{1,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(0) \\\\ -\\hat{u}(h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix}$.\nThe right-hand side (RHS) is:\n$a \\frac{1}{2} \\begin{pmatrix} -u_{1,1}-u_{1,2} \\\\ u_{1,1}+u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} -u_{1,1} - u_{1,2} + 2u_{2,2} \\\\ u_{1,1} - u_{1,2} \\end{pmatrix}$.\n\n**For element $K_2 = [h,2h]$:**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{2,1} \\\\ \\dot{u}_{2,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(h) \\\\ -\\hat{u}(2h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix}$.\nThe RHS is:\n$a \\frac{1}{2} \\begin{pmatrix} -u_{2,1}-u_{2,2} \\\\ u_{2,1}+u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 2u_{1,2} - u_{2,1} - u_{2,2} \\\\ u_{2,1} - u_{2,2} \\end{pmatrix}$.\n\nThe global semi-discrete system is $\\mathbf{M} \\dot{\\mathbf{u}} = \\mathbf{R}_{glob} \\mathbf{u}$.\nThe global mass matrix $\\mathbf{M}$ is block-diagonal:\n$$\n\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}^e  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{M}^e \\end{pmatrix} = \\frac{h}{6} \\begin{pmatrix} 2  1  0  0 \\\\ 1  2  0  0 \\\\ 0  0  2  1 \\\\ 0  0  1  2 \\end{pmatrix}\n$$\nThe global RHS matrix $\\mathbf{R}_{glob}$ is:\n$$\n\\mathbf{R}_{glob} = \\frac{a}{2} \\begin{pmatrix} -1  -1  0  2 \\\\ 1  -1  0  0 \\\\ 0  2  -1  -1 \\\\ 0  0  1  -1 \\end{pmatrix}\n$$\nThe system operator is $\\mathcal{A} = \\mathbf{M}^{-1} \\mathbf{R}_{glob}$. The inverse of the mass matrix is:\n$$\n\\mathbf{M}^{-1} = \\frac{1}{h} \\begin{pmatrix} 4  -2  0  0 \\\\ -2  4  0  0 \\\\ 0  0  4  -2 \\\\ 0  0  -2  4 \\end{pmatrix}\n$$\nMultiplying the matrices, we get $\\mathcal{A}$:\n$$\n\\mathcal{A} = \\frac{1}{h} \\begin{pmatrix} 4  -2  0  0 \\\\ -2  4  0  0 \\\\ 0  0  4  -2 \\\\ 0  0  -2  4 \\end{pmatrix} \\frac{a}{2} \\begin{pmatrix} -1  -1  0  2 \\\\ 1  -1  0  0 \\\\ 0  2  -1  -1 \\\\ 0  0  1  -1 \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} -3  -1  0  4 \\\\ 3  -1  0  -2 \\\\ 0  4  -3  -1 \\\\ 0  -2  3  -1 \\end{pmatrix}\n$$\n\n### Computing the Spectral Radius\n\nTo find the eigenvalues of $\\mathcal{A}$, we analyze its structure. Due to periodicity, the eigenvectors must be discrete Fourier modes. The degrees of freedom on element $K_{e+1}$ are related to those on $K_e$ by a phase factor $e^{i\\kappa}$, where $\\kappa = k \\Delta x$ is the dimensionless wavenumber. For a $2$-element domain, the discrete wavenumbers correspond to modes $m=0,1$ over the full period $L=2h$, giving physical wavenumbers $k=0$ and $k=\\pi/h$. Let $\\mathbf{u}_e = (u_{e,1}, u_{e,2})^{\\top}$. The periodic structure implies that $\\mathbf{u}_2 = e^{ikh} \\mathbf{u}_1$. Let $\\mathbf{v} = \\mathbf{u}_1$. The eigenvalue problem $\\mathcal{A}\\mathbf{u} = \\lambda \\mathbf{u}$ decouples into $2 \\times 2$ problems. Let $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$.\n$$\n\\begin{pmatrix} -3  -1 \\\\ 3  -1 \\end{pmatrix} \\mathbf{v} + e^{ikh} \\begin{pmatrix} 0  4 \\\\ 0  -2 \\end{pmatrix} \\mathbf{v} = \\frac{h}{a} \\lambda \\mathbf{v}\n$$\nThis gives the eigenvalue problem for the $2 \\times 2$ matrix $\\mathbf{A}_k$:\n$$\n\\mathbf{A}_k = \\begin{pmatrix} -3  -1 + 4e^{ikh} \\\\ 3  -1 - 2e^{ikh} \\end{pmatrix}\n$$\nThe four eigenvalues of $\\mathbf{A}'$ are the union of the eigenvalues of $\\mathbf{A}_k$ for $k=0$ and $k=\\pi/h$.\n\n**Case 1: $k=0$ (constant mode)**\n$e^{ikh} = 1$. The matrix is $\\mathbf{A}_0 = \\begin{pmatrix} -3  3 \\\\ 3  -3 \\end{pmatrix}$.\nThe characteristic equation is $(-3-\\mu)^2 - 9 = 0$, giving $\\mu+3=\\pm 3$. The eigenvalues are $\\mu_1=0$ and $\\mu_2=-6$.\n\n**Case 2: $k=\\pi/h$ (alternating mode)**\n$e^{ikh} = e^{i\\pi} = -1$. The matrix is $\\mathbf{A}_{\\pi/h} = \\begin{pmatrix} -3  -5 \\\\ 3  1 \\end{pmatrix}$.\nThe characteristic equation is $(-3-\\mu)(1-\\mu) - (3)(-5) = 0$, which simplifies to $\\mu^2 + 2\\mu + 12 = 0$.\nThe roots are $\\mu = \\frac{-2 \\pm \\sqrt{4-48}}{2} = -1 \\pm i\\sqrt{11}$.\n\nThe eigenvalues of the scaled matrix $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$ are $\\{0, -6, -1+i\\sqrt{11}, -1-i\\sqrt{11}\\}$.\nThe eigenvalues of $\\mathcal{A}$ are $\\frac{a}{h}$ times these values:\n$$\n\\lambda \\in \\left\\{ 0, -6\\frac{a}{h}, \\frac{a}{h}(-1+i\\sqrt{11}), \\frac{a}{h}(-1-i\\sqrt{11}) \\right\\}\n$$\nThe spectral radius $\\rho(\\mathcal{A})$ is the maximum of the moduli of these eigenvalues:\n- $|0|=0$\n- $|-6\\frac{a}{h}| = 6\\frac{a}{h}$\n- $|\\frac{a}{h}(-1 \\pm i\\sqrt{11})| = \\frac{a}{h}\\sqrt{(-1)^2 + (\\pm\\sqrt{11})^2} = \\frac{a}{h}\\sqrt{1+11} = \\frac{a}{h}\\sqrt{12}$\n\nWe compare $6\\frac{a}{h}$ and $\\sqrt{12}\\frac{a}{h}$. Since $6 = \\sqrt{36}$ and $\\sqrt{36}  \\sqrt{12}$, the maximum modulus is $6\\frac{a}{h}$.\n\nThe spectral radius of the operator $\\mathcal{A}$ is $\\rho(\\mathcal{A}) = 6\\frac{a}{h}$.",
            "answer": "$$\\boxed{6\\frac{a}{h}}$$"
        },
        {
            "introduction": "High-order numerical schemes can sometimes produce unphysical results, such as negative water depth, when applied to nonlinear conservation laws like the shallow water equations. This exercise addresses this critical challenge by exploring the concept of positivity-preserving schemes, which are essential for robust ocean modeling. You will derive a CFL-like condition for ensuring positivity and design a mass-preserving limiter, learning how to enforce physical constraints without sacrificing the high-order accuracy of the DG method .",
            "id": "3790493",
            "problem": "Consider the one-dimensional shallow water equations over a flat bathymetry, written in conservative form for water depth $h(x,t)$ and momentum $m(x,t)=h(x,t)\\,u(x,t)$, where $u(x,t)$ is the velocity and $g$ is gravitational acceleration:\n$$\n\\partial_{t} h + \\partial_{x} m = 0, \\qquad \\partial_{t} m + \\partial_{x} \\left( \\frac{m^{2}}{h} + \\frac{1}{2} g h^{2} \\right) = 0.\n$$\nA Discontinuous Galerkin (DG) method approximates $h$ and $m$ by polynomials in each element $K$ of a uniform mesh, using Legendre-Gauss-Lobatto nodes typical of the spectral element method. Let $\\bar{h}^{n}$ denote the cell-average of $h$ at time $t^{n}$ over an element $K$, and let $h^{n}(x)$ be its polynomial representation with degree $p \\geq 1$. Assume a Strong Stability Preserving Runge-Kutta (SSP-RK) time integrator built from forward Euler steps and a local Lax-Friedrichs numerical flux with dissipation parameter $\\alpha \\geq \\max\\{ |u_{L}| + \\sqrt{g h_{L}}, |u_{R}| + \\sqrt{g h_{R}} \\}$ on each face, where subscripts $L$ and $R$ denote the left and right traces. The DG scheme uses quadrature rules that are exact for polynomials up to degree $2p-1$ in the volume and up to degree $2p-1$ on faces, and the forward Euler update is applied to the modal coefficients in the usual way.\n\nStarting from the fundamental facts that (i) the first-order finite volume scheme with a monotone flux preserves nonnegativity of $h$ under an appropriate Courant–Friedrichs–Lewy (CFL) time-step restriction, (ii) SSP-RK time stepping can be written as convex combinations of forward Euler steps, and (iii) Legendre-Gauss-Lobatto quadrature provides positive weights with endpoints included, answer the following:\n\n1. Derive a sufficient CFL-type condition on the forward Euler time step $\\Delta t$ and wave speeds ensuring that, if $h^{n}(x) \\geq 0$ at the quadrature points used by the DG scheme in element $K$ and its neighbors, then the forward Euler update preserves the nonnegativity of the cell-average $\\bar{h}^{n+1}$ and the nodal values of $h^{n+1}(x)$ at those quadrature points. Your condition should be expressed symbolically in terms of the element measure $|K|$, face measures, the local Lax-Friedrichs parameters $\\alpha$ at faces, and the smallest Legendre-Gauss-Lobatto weight $w_{\\min}$.\n\n2. Using mass conservation and convexity arguments, derive a high-order positivity-preserving, mass-preserving limiter for $h$ of the form\n$$\nh^{\\mathrm{lim}}(x) = \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h},\n$$\nwith a scalar $\\theta \\in [0,1]$ chosen to enforce $h^{\\mathrm{lim}}(x) \\geq \\varepsilon$ at the chosen positivity points, where $\\varepsilon  0$ is a small floor representing a physically meaningful dryness threshold. Provide a closed-form expression for $\\theta$ in terms of $\\bar{h}$, $\\varepsilon$, and the minimum of $h(x)$ over the positivity points, denoted $h_{\\min}$.\n\n3. On a particular element $K$, suppose the DG polynomial $h(x)$ at the positivity points has minimum value $h_{\\min} = -0.3$ and the cell average is $\\bar{h} = 2.0$. Take the dryness floor to be $\\varepsilon = 10^{-3}$. Compute the value of the limiter parameter $\\theta$ implied by your expression, and round your answer to four significant figures. The final answer is dimensionless and should be reported without units.",
            "solution": "The problem is divided into three parts concerning the positivity of the water depth $h$ in a Discontinuous Galerkin (DG) scheme for the one-dimensional shallow water equations.\n\n### Part 1: Derivation of the CFL-type Condition\n\nThe goal is to find a sufficient condition on the forward Euler time step $\\Delta t$ to preserve the non-negativity of the water depth $h$ at the Legendre-Gauss-Lobatto (LGL) quadrature points. The problem provides several key facts that guide the derivation:\n1.  The first-order finite volume (FV) scheme with a monotone flux preserves non-negativity under a Courant–Friedrichs–Lewy (CFL) condition.\n2.  Strong Stability Preserving Runge-Kutta (SSP-RK) methods are convex combinations of forward Euler steps. Thus, if a forward Euler step preserves positivity, so will the full SSP-RK step (under the same or a scaled time-step restriction).\n3.  The DG scheme uses LGL quadrature points and weights, which are positive. The mass matrix for this choice of basis and quadrature is diagonal.\n\nLet us analyze the forward Euler update for the DG approximation. The semi-discrete DG formulation for the continuity equation $\\partial_t h + \\partial_x m = 0$ in an element $K$ is: for all test functions $v(x)$ in the polynomial space,\n$$ \\int_K \\frac{\\partial h}{\\partial t} v \\, dx = \\int_K m \\frac{\\partial v}{\\partial x} \\, dx - \\left[ m^* v \\right]_{\\partial K} $$\nHere, $m^*$ is the numerical flux, and $\\left[ \\cdot \\right]_{\\partial K}$ denotes the difference of values at the element boundaries, e.g., $f(x_{k+1/2}) - f(x_{k-1/2})$.\n\nUsing a nodal basis composed of Lagrange polynomials $L_j(x)$ centered at the LGL quadrature points $\\{x_j\\}_{j=0}^p$, the approximate solution is $h(x,t) = \\sum_{j=0}^{p} h_j(t) L_j(x)$. We choose the test function $v(x) = L_i(x)$. The mass matrix $M_{ij} = \\int_K L_i(x) L_j(x) \\, dx$ becomes diagonal due to the LGL quadrature rule, which is exact for polynomials of degree up to $2p-1$ (since $L_i L_j$ is of degree at most $2p$). The diagonal entries are $M_{ii} = \\int_K L_i^2(x) dx = w_i^{\\text{ref}} \\frac{|K|}{2}$, where $w_i^{\\text{ref}}$ are the LGL weights on the reference element $[-1,1]$ and $|K|$ is the measure (length) of element $K$. Let us denote $w_i = w_i^{\\text{ref}}$ for simplicity.\n\nThe semi-discrete equation for the nodal value $h_i(t)$ is:\n$$ \\frac{|K|}{2} w_i \\frac{d h_i}{dt} = \\int_K m(x,t) L_i'(x) \\, dx - \\left[ m^* L_i \\right]_{\\partial K} $$\nApplying a forward Euler step:\n$$ h_i^{n+1} = h_i^n + \\frac{2 \\Delta t}{|K| w_i} \\left( \\int_K m^n(x) L_i'(x) \\, dx - \\left[ m^{*,n} L_i \\right]_{\\partial K} \\right) $$\nA rigorous derivation from this point is highly technical. However, a key result in the theory of positivity-preserving DG schemes, developed by Zhang and Shu, is that the DG update at a quadrature point can be interpreted as a finite volume update on a sub-cell. The 'volume' of the sub-cell associated with node $x_i$ is its corresponding mass matrix entry, $V_i = \\frac{|K|}{2} w_i$. The condition for positivity preservation can then be derived by analogy with a first-order FV scheme.\n\nFor a 1D FV scheme $h_j^{n+1} = h_j^n - \\frac{\\Delta t}{\\Delta x_j} (F^*_{j+1/2} - F^*_{j-1/2})$ with a Lax-Friedrichs flux $F^*(h_L, h_R) = \\frac{f(h_L)+f(h_R)}{2} - \\frac{\\alpha}{2}(h_R - h_L)$, the coefficient of $h_j^n$ in the update is $1 - \\frac{\\Delta t}{2\\Delta x_j} (\\alpha_{j+1/2} + \\alpha_{j-1/2})$. For positivity, this coefficient must be non-negative, yielding the CFL condition $\\Delta t \\le \\frac{2 \\Delta x_j}{\\alpha_{j+1/2} + \\alpha_{j-1/2}}$.\n\nBy analogy, for the DG scheme, we consider the sub-cell with the smallest effective volume, which corresponds to the minimum LGL weight $w_{\\min}$. We replace $\\Delta x_j$ with $V_{\\min} = \\frac{|K|}{2} w_{\\min}$. The term $\\alpha_{j+1/2} + \\alpha_{j-1/2}$ represents the sum of dissipation coefficients over the faces of the cell. For the DG element $K$, the relevant dissipation parameters are those at its external faces, $\\alpha_L$ and $\\alpha_R$. The influence of these boundary fluxes propagates into the entire element and affects all nodal values due to the high-order polynomial representation. The condition for preserving positivity at all nodes must therefore account for the total dissipation entering the element.\n\nThe sufficient condition is that the time step must be small enough so that the total flux leaving any sub-cell does not deplete its content. The most restrictive case is for the sub-cell with the smallest volume $V_{\\min}$. The total outgoing flux is driven by the sum of dissipative effects from all element faces. In 1D, we have two faces with measures $|\\partial K_L|=1$ and $|\\partial K_R|=1$. The sum of LF parameters weighted by face measures is $\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|$.\n\nApplying the analogy, we replace $\\frac{1}{2}(\\alpha_L + \\alpha_R)$ with $\\frac{1}{2}(\\alpha_L|\\partial K_L|+\\alpha_R|\\partial K_R|)$ and $\\Delta x_j$ with $\\frac{|K|}{2} w_{\\min}$. This yields:\n$$ \\Delta t \\le \\frac{2 \\left( \\frac{|K|}{2} w_{\\min} \\right)}{\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|} = \\frac{|K| w_{\\min}}{\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|} $$\nThis condition ensures that if $h^n(x_j) \\geq 0$ at all LGL points in element $K$ and its neighbors, then the forward Euler update $h^{n+1}(x_j)$ will also be non-negative. Because the LGL nodes include the endpoints, non-negativity at the nodes implies non-negativity of the polynomial $h(x)$ throughout the element, which in turn ensures that the cell average $\\bar{h}^{n+1}$ is non-negative. Thus, this single condition is sufficient for both nodal and cell-average positivity.\n\n### Part 2: Derivation of the Positivity-Preserving Limiter\n\nWe are given a limiter of the form $h^{\\mathrm{lim}}(x) = \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h}$ with $\\theta \\in [0,1]$.\n\nFirst, we verify that this limiter is mass-preserving. The new cell average is:\n$$ \\overline{h^{\\mathrm{lim}}} = \\frac{1}{|K|} \\int_K h^{\\mathrm{lim}}(x) \\, dx = \\frac{1}{|K|} \\int_K \\left[ \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h} \\right] \\, dx $$\n$$ \\overline{h^{\\mathrm{lim}}} = \\frac{\\theta}{|K|} \\int_K h(x) \\, dx - \\frac{\\theta}{|K|} \\int_K \\bar{h} \\, dx + \\frac{1}{|K|} \\int_K \\bar{h} \\, dx $$\nUsing the definition $\\bar{h} = \\frac{1}{|K|} \\int_K h(x) \\, dx$, we get:\n$$ \\overline{h^{\\mathrm{lim}}} = \\theta \\bar{h} - \\theta \\bar{h} + \\bar{h} = \\bar{h} $$\nThe limiter is mass-preserving for any $\\theta$.\n\nNext, we enforce the positivity constraint, $h^{\\mathrm{lim}}(x) \\geq \\varepsilon$, at a set of positivity points (e.g., the quadrature points). Let $h_{\\min} = \\min_x h(x)$ be the minimum value of the un-limited polynomial $h(x)$ over these points. The minimum value of the limited polynomial $h^{\\mathrm{lim}}(x)$ is:\n$$ h^{\\mathrm{lim}}_{\\min} = \\min_x \\left[ \\theta h(x) + (1-\\theta)\\bar{h} \\right] = \\theta h_{\\min} + (1-\\theta)\\bar{h} $$\nbecause $\\theta \\in [0,1]$.\nWe require $h^{\\mathrm{lim}}_{\\min} \\geq \\varepsilon$:\n$$ \\theta h_{\\min} + (1-\\theta)\\bar{h} \\geq \\varepsilon $$\n$$ \\theta h_{\\min} + \\bar{h} - \\theta\\bar{h} \\geq \\varepsilon $$\n$$ \\theta(h_{\\min} - \\bar{h}) \\geq \\varepsilon - \\bar{h} $$\nThe limiter is only applied if $h_{\\min}$ violates the positivity constraint, i.e., $h_{\\min}  \\varepsilon$. By definition, $h_{\\min} \\le \\bar{h}$. If $h_{\\min} = \\bar{h}$, the polynomial is a constant, and no limiting is needed unless this constant is below $\\varepsilon$. We assume $h_{\\min}  \\bar{h}$, which makes the term $(h_{\\min} - \\bar{h})$ strictly negative. Dividing the inequality by this negative term reverses the inequality sign:\n$$ \\theta \\le \\frac{\\varepsilon - \\bar{h}}{h_{\\min} - \\bar{h}} = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\nTo be as minimally intrusive as possible, we want to choose the largest possible $\\theta$ that satisfies this condition, while also respecting $\\theta \\in [0, 1]$. We choose $\\theta$ to be the upper bound:\n$$ \\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\nThis value of $\\theta$ is used only when limiting is necessary, i.e., when $h_{\\min}  \\varepsilon$. If $h_{\\min} \\ge \\varepsilon$, no limiting is applied, which corresponds to $\\theta = 1$. The derived expression for $\\theta$ is consistent with this, since $h_{\\min}  \\varepsilon \\implies \\bar{h} - h_{\\min}  \\bar{h} - \\varepsilon \\implies \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}}  1$. Also, for the limited solution to be able to satisfy the condition, the cell average $\\bar{h}$ must be greater than $\\varepsilon$. If $\\bar{h} \\le \\varepsilon$, no value of $\\theta \\in [0,1]$ can guarantee $h^{\\mathrm{lim}}(x) \\ge \\varepsilon$ while preserving the mean (unless $h(x)=\\bar{h}=\\varepsilon$). In such cases, one typically sets $\\theta=0$, resulting in $h^{\\mathrm{lim}}(x) = \\bar{h}$. Assuming $\\bar{h}  \\varepsilon$, our expression for $\\theta$ is well-defined and lies in $[0,1)$.\n\nThe complete procedure is:\nIf $h_{\\min}  \\varepsilon$ and $\\bar{h}  \\varepsilon$, set $\\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}}$. Otherwise, set $\\theta=1$. The problem asks for the expression for $\\theta$ to enforce the condition, which is the formula derived.\n\n### Part 3: Calculation of the Limiter Parameter $\\theta$\n\nWe are given the following values for a particular element:\n- Minimum value of $h(x)$ at positivity points: $h_{\\min} = -0.3$\n- Cell average of $h(x)$: $\\bar{h} = 2.0$\n- Dryness floor: $\\varepsilon = 10^{-3} = 0.001$\n\nWe check the conditions for applying the limiter. We have $h_{\\min} = -0.3  0.001 = \\varepsilon$, so limiting is required. We also have $\\bar{h} = 2.0  0.001 = \\varepsilon$, so a valid, mass-preserving limited solution exists.\n\nWe use the formula derived in Part 2:\n$$ \\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\nSubstituting the given values:\n$$ \\theta = \\frac{2.0 - 0.001}{2.0 - (-0.3)} = \\frac{1.999}{2.3} $$\nComputing the numerical value:\n$$ \\theta \\approx 0.8691304347... $$\nRounding the result to four significant figures, we get $\\theta = 0.8691$.",
            "answer": "$$\\boxed{0.8691}$$"
        },
        {
            "introduction": "One of the elegant features of Discontinuous Galerkin methods is the phenomenon of superconvergence, where the numerical solution exhibits unexpectedly high accuracy at specific points within an element. This final practice delves into this advanced topic, first by analyzing why the solution is more accurate at downwind element boundaries for advection problems. You will then apply this insight to design a powerful post-processing technique that leverages these superconvergent points to extract a highly accurate estimate of a physical parameter from the numerical solution .",
            "id": "3790452",
            "problem": "Consider the one-dimensional, periodic, linear advection model for a small-amplitude barotropic surface elevation in a straight channel, given by $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $ on $ x \\in [0,L] $ with unknown constant wave speed $ c  0 $. Assume the initial condition is a single Fourier mode $ \\eta(x,0) = \\exp(i k x) $ with $ k = 2 \\pi m / L $ for some integer $ m \\geq 1 $. The solution is $ \\eta(x,t) = \\exp(i (k x - \\omega t)) $ with $ \\omega = c k $. The field $ \\eta $ represents a passive linear signal whose speed is determined by background hydrostatic balance $ c = \\sqrt{g H} $ for depth $ H $, but in this exercise $ c $ is unknown and must be estimated numerically.\n\nDiscretize this model using a discontinuous Galerkin (DG) spectral element method of polynomial degree $ r \\geq 0 $ on a uniform mesh of $ N_{e} $ elements of size $ h = L / N_{e} $, with a Legendre–Gauss–Lobatto nodal basis in each element, mapping the reference coordinate $ \\xi \\in [-1,1] $ to physical coordinate $ x $ by an affine map. Use the standard upwind numerical flux at all interfaces. Denote the DG semi-discrete solution by $ \\eta_{h}(x,t) $ and its trace from the interior of element $ j $ at the right (downwind) interface by $ \\eta_{h}(x_{j+1/2}^{-},t) $, where $ x_{j+1/2} $ is the location of the right interface of element $ j $.\n\nIt is empirically observed in the DG literature that evaluation of $ \\eta_{h} $ at downwind points exhibits enhanced accuracy (superconvergence) compared to generic interior points for linear advection with upwind flux. In this problem, you will analyze the superconvergence points and design a postprocessing that increases the accuracy of wave speed estimation for the given Fourier signal.\n\nTasks:\n1. Starting from the DG weak form for linear advection with upwind numerical flux and the orthogonality of Legendre polynomials, analyze the pointwise error structure of $ \\eta_{h} $ within an element. Identify and justify the location(s) of superconvergence points in the reference element $ \\xi \\in [-1,1] $ as a consequence of the upwind flux and the polynomial basis structure. In particular, explain why the downwind boundary point $ \\xi = +1 $ is superconvergent and state the leading order of its pointwise error in terms of $ h $ and $ r $ for the semi-discrete scheme with exact time integration.\n\n2. Using the identified superconvergence at downwind nodes, construct a postprocessed global complex diagnostic\n$$\nZ(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}),\n$$\nand explain how $ Z(t) $ isolates the temporal phase of the Fourier mode. Then, derive a closed-form analytic expression for a postprocessed estimator $ \\widehat{c} $ of the true wave speed $ c $ using two time samples $ Z(t) $ and $ Z(t+\\Delta t) $ for a given $ \\Delta t  0 $, ensuring your derivation starts from the governing advection model and the DG structure, invoking only well-tested facts about Fourier-mode transport and polynomial approximation. Your estimator must directly use the downwind-node superconvergent information in $ Z(t) $.\n\nProvide the final answer as a single closed-form analytic expression in terms of $ k $, $ \\Delta t $, and the DG solution samples at downwind nodes. No numerical evaluation is required. Do not include units inside your final boxed expression. No rounding is required.",
            "solution": "The problem statement is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Governing Equation:** $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $\n-   **Domain:** $ x \\in [0,L] $, periodic.\n-   **Wave Speed:** Constant $ c  0 $, unknown.\n-   **Initial Condition:** $ \\eta(x,0) = \\exp(i k x) $\n-   **Wavenumber:** $ k = 2 \\pi m / L $ for some integer $ m \\geq 1 $.\n-   **Exact Solution:** $ \\eta(x,t) = \\exp(i (k x - \\omega t)) $ with $ \\omega = c k $.\n-   **Physical Context:** $ c = \\sqrt{g H} $.\n-   **Numerical Method:** Discontinuous Galerkin (DG) spectral element method.\n    -   Polynomial degree: $ r \\geq 0 $.\n    -   Mesh: Uniform with $ N_{e} $ elements.\n    -   Element size: $ h = L / N_{e} $.\n    -   Basis: Legendre–Gauss–Lobatto (LGL) nodal basis on the reference element $ \\xi \\in [-1,1] $.\n    -   Numerical Flux: Upwind flux.\n-   **Notation:**\n    -   DG solution: $ \\eta_{h}(x,t) $.\n    -   Trace from interior of element $ j $ at right interface: $ \\eta_{h}(x_{j+1/2}^{-},t) $.\n-   **Premise:** Evaluation of $ \\eta_{h} $ at downwind points exhibits superconvergence.\n-   **Tasks:**\n    1.  Analyze and justify the location of superconvergence points, specifically $ \\xi = +1 $, and state the leading order of its pointwise error for the semi-discrete scheme.\n    2.  Construct a postprocessed diagnostic $ Z(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}) $ and use it to derive a closed-form estimator $ \\widehat{c} $ for the wave speed $ c $ using samples at $ t $ and $ t+\\Delta t $.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is based on the linear advection equation, a cornerstone of wave physics, and the discontinuous Galerkin method, a well-established and powerful numerical technique in computational science. The concept of superconvergence is a known and rigorously studied phenomenon in DG methods. The problem is scientifically and mathematically sound.\n-   **Well-Posed:** The problem is well-defined. It asks for a qualitative analysis based on known properties of a numerical method and the derivation of a specific formula. The tasks are clear and lead to a unique analytical result.\n-   **Objective:** The problem is stated in precise, formal, and unbiased language. All terms are defined within the context of numerical analysis for PDEs.\n-   **Completeness and Consistency:** The problem provides all necessary information to perform the analysis and derivation. The setup is self-contained and internally consistent.\n-   **Feasibility and Realism:** The physical model and numerical setup are standard in computational oceanography and fluid dynamics. The analysis required is standard in the study of numerical methods.\n-   **Structure and Other Criteria:** The problem is logically structured, non-trivial, and verifiable within the principles of numerical analysis.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\n### Solution\n\nThis problem is addressed in two parts as requested. The first part analyzes the superconvergence properties of the DG method for linear advection. The second part leverages this property to construct a high-accuracy estimator for the wave speed.\n\n**Part 1: Superconvergence Analysis**\n\nThe semi-discrete discontinuous Galerkin (DG) formulation for the linear advection equation, $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $ with $ c  0 $, on an element $ K_j = [x_{j-1/2}, x_{j+1/2}] $ is found by multiplying by a test function $ v_h $ from the polynomial space $ P^r(K_j) $ and integrating over the element. After integration by parts of the spatial term, we obtain:\n$$ \\int_{K_j} (\\partial_t \\eta_h) v_h \\, dx - \\int_{K_j} c \\eta_h (\\partial_x v_h) \\, dx + c \\left[ \\eta_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0 \\quad \\forall v_h \\in P^r(K_j) $$\nHere, $ \\eta_h $ is the polynomial approximation of $ \\eta $ in $ K_j $, and $ \\eta_h^* $ is the numerical flux at the element interfaces. The problem specifies an upwind flux. Since $ c  0 $, information propagates from left to right. The upwind flux is thus the trace of the solution from the upwind (left) side of each interface: $ \\eta_h^*(x) = \\lim_{\\epsilon \\to 0^+} \\eta_h(x-\\epsilon) $. The boundary term becomes:\n$$ c \\left[ \\eta_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = c \\, \\eta_h(x_{j+1/2}^{-}) v_h(x_{j+1/2}^{-}) - c \\, \\eta_h(x_{j-1/2}^{-}) v_h(x_{j-1/2}^{+}) $$\nThe error, $ e_h = \\eta_h - \\eta $, of the DG method is governed by the properties of this formulation. It is a well-established result in the analysis of DG methods for linear advection that the pointwise error does not behave uniformly across the element. Specifically, the error structure is influenced by the direction of advection and the choice of polynomial basis.\n\nFor a basis constructed from Legendre polynomials on the reference element $ \\xi \\in [-1,1] $, the error $ e_h $ at a point $ x(\\xi) $ inside an element has a leading term that depends on the $(r+1)$-th derivative of the exact solution and a specific polynomial of degree $ r+1 $. Theoretical analyses show that for the steady-state problem, this polynomial part is proportional to $ L_{r+1}(\\xi) - L_r(\\xi) $, where $ L_k $ is the Legendre polynomial of degree $ k $.\n\nSuperconvergence occurs at points where this leading error term vanishes. We examine the value of this polynomial at the endpoints of the reference element, $ \\xi = \\pm 1 $.\n-   At the downwind boundary, $ \\xi = +1 $, we use the property $ L_k(1) = 1 $ for all $ k \\geq 0 $. The error polynomial evaluates to $ L_{r+1}(1) - L_r(1) = 1 - 1 = 0 $. This cancellation of the leading $ O(h^{r+1}) $ error term signifies that the point $ \\xi = +1 $ is a point of superconvergence.\n-   At the upwind boundary, $ \\xi = -1 $, we use the property $ L_k(-1) = (-1)^k $. The error polynomial is $ L_{r+1}(-1) - L_r(-1) = (-1)^{r+1} - (-1)^r = -2(-1)^r \\neq 0 $. No such cancellation occurs at the upwind boundary.\n\nThe vanishing of the leading error term at the downwind boundary means that the error there is of a higher order. While the above heuristic using $ L_{r+1} - L_r $ comes from steady-state analysis, a more rigorous analysis for the time-dependent problem with exact time integration (the semi-discrete case) confirms this phenomenon. For the DG method of polynomial degree $ r $ applied to the linear advection equation, the pointwise error at generic interior points is $ O(h^{r+1}) $, but at the downwind boundary nodes (corresponding to $ \\xi = +1 $), the error is one order higher.\n\nTherefore, the location of superconvergence is the downwind boundary of each element, $ \\xi=+1 $. For the semi-discrete scheme, the leading order of the pointwise error at this point is $ \\boldsymbol{O(h^{r+2})} $.\n\n**Part 2: Wave Speed Estimator**\n\nWe are asked to construct an estimator $ \\widehat{c} $ for the wave speed $ c $ using a postprocessed diagnostic $ Z(t) $, which is defined using the superconvergent downwind node values:\n$$ Z(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}) $$\nThe purpose of this diagnostic is to isolate the temporal component of the propagating Fourier mode. To see this, let's consider what $ Z(t) $ would be if we used the exact solution $ \\eta(x,t) = \\exp(i(kx - \\omega t)) $:\n$$ Z_{\\text{exact}}(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta(x_{j+1/2},t) \\, \\exp(-i k x_{j+1/2}) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\exp(i(k x_{j+1/2} - \\omega t)) \\, \\exp(-i k x_{j+1/2}) $$\n$$ Z_{\\text{exact}}(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\exp(-i \\omega t) = \\frac{1}{N_{e}} (N_e \\exp(-i \\omega t)) = \\exp(-i \\omega t) $$\nThe numerical diagnostic $ Z(t) $ is an approximation of $ \\exp(-i \\omega t) $. The accuracy of this approximation depends on the error in the numerical solution $ \\eta_h $ at the sampling points. Since we are sampling at the downwind nodes $ x_{j+1/2}^{-} $, where the pointwise error is superconvergent of order $ O(h^{r+2}) $, we have:\n$$ \\eta_h(x_{j+1/2}^{-}, t) = \\eta(x_{j+1/2}, t) + O(h^{r+2}) $$\nSubstituting this into the definition of $ Z(t) $ gives:\n$$ Z(t) = Z_{\\text{exact}}(t) + \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} O(h^{r+2}) \\exp(-i k x_{j+1/2}) = \\exp(-i \\omega t) + O(h^{r+2}) $$\nThus, $ Z(t) $ is a very accurate approximation of the solution's temporal phase factor. We can use this to estimate $ \\omega $. Given two samples, $ Z(t) $ and $ Z(t+\\Delta t) $, we can form their ratio:\n$$ \\frac{Z(t+\\Delta t)}{Z(t)} \\approx \\frac{\\exp(-i \\omega (t+\\Delta t))}{\\exp(-i \\omega t)} = \\exp(-i \\omega \\Delta t) $$\nThe complex number on the right has a magnitude of $ 1 $ and a phase (argument) of $ -\\omega \\Delta t $. We can therefore extract $ \\omega $ by taking the argument of the ratio of our numerical diagnostics. Let $ \\widehat{\\omega} $ be our estimate for $ \\omega $.\n$$ \\arg\\left( \\frac{Z(t+\\Delta t)}{Z(t)} \\right) \\approx -\\widehat{\\omega} \\Delta t $$\nThe argument of a complex number $ z $ can be written as the imaginary part of its natural logarithm, $ \\arg(z) = \\mathrm{Im}(\\ln(z)) $, where $ \\ln $ denotes the principal value of the complex logarithm. This gives an expression for $ \\widehat{\\omega} $:\n$$ \\widehat{\\omega} = -\\frac{1}{\\Delta t} \\mathrm{Im}\\left( \\ln\\left( \\frac{Z(t+\\Delta t)}{Z(t)} \\right) \\right) $$\nThe problem asks for an estimator for the wave speed $ c $. Using the exact dispersion relation $ \\omega = c k $, our estimator for $ c $ is $ \\widehat{c} = \\widehat{\\omega} / k $. Substituting the expression for $ \\widehat{\\omega} $ and the definition of $ Z(t) $ yields the final closed-form expression for $ \\widehat{c} $:\n$$ \\widehat{c} = -\\frac{1}{k \\Delta t} \\mathrm{Im}\\left[ \\ln\\left( \\frac{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t+\\Delta t) \\exp(-i k x_{j+1/2})}{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\exp(-i k x_{j+1/2})} \\right) \\right] $$\nThis estimator for $ c $ is constructed directly from the DG solution samples at the superconvergent downwind nodes, as required.",
            "answer": "$$ \\boxed{- \\frac{1}{k \\Delta t} \\mathrm{Im}\\left( \\ln\\left( \\frac{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t+\\Delta t) \\exp(-i k x_{j+1/2})}{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\exp(-i k x_{j+1/2})} \\right) \\right)} $$"
        }
    ]
}