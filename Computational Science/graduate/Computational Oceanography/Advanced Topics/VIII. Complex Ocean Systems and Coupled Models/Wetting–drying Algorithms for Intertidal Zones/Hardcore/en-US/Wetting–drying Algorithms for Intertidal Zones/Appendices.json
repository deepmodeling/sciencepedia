{
    "hands_on_practices": [
        {
            "introduction": "Before developing numerical models for wetting fronts, it is crucial to understand their fundamental behavior as predicted by the governing equations. This practice explores the classic \"dry-bed Riemann problem,\" which provides the exact, analytical solution for a wave advancing over a previously dry area . Solving this problem reveals the underlying hyperbolic structure and the nature of the moving boundary, offering a theoretical benchmark against which any numerical algorithm must be validated.",
            "id": "3819177",
            "problem": "Consider the one-dimensional depth-averaged shallow water equations on a horizontal bed without friction, written in conservative form for water depth $h(x,t)$ and depth-averaged velocity $u(x,t)$:\n$$\n\\partial_t h + \\partial_x (h u) = 0, \\quad \\partial_t (h u) + \\partial_x \\left(h u^2 + \\tfrac{1}{2} g h^2\\right) = 0,\n$$\nwhere $g$ is the gravitational acceleration. The system is strictly hyperbolic for $h>0$ with characteristic speeds $u \\pm c$, where $c = \\sqrt{gh}$ is the gravity wave celerity. A wetting–drying interface arises when $h \\to 0$ in part of the domain, corresponding physically to a moving shoreline.\n\nFormulate the dry-bed Riemann problem with piecewise-constant initial data\n$$\n(h,u)(x,0) = \\begin{cases}\n(h_L,u_L),  x0, \\\\\n(0,0),  x0,\n\\end{cases}\n$$\nfor $h_L>0$. Using only the governing equations and their hyperbolic structure (no additional closures or ad hoc regularization), determine the admissible wave structure and the shoreline speed that results from this initial discontinuity. Then, select the option that correctly characterizes both the wave pattern and the physical interpretation of the wetting front in the context of wetting–drying in intertidal zones.\n\nA. A single centered rarefaction connects $(h_L,u_L)$ to a vacuum state ($h=0$), belonging to the left-going family with self-similar coordinate $\\xi = x/t = u - c$. The left edge of the fan moves at $\\xi_\\text{left} = u_L - \\sqrt{g h_L}$, and the right edge is a moving shoreline at $\\xi_\\text{shore} = u_L + 2 \\sqrt{g h_L}$ where $h \\to 0$ and $u \\to \\xi_\\text{shore}$. No shock is admissible because characteristics diverge, and the wetting front advances supercritically, flooding the dry bed while maintaining $h \\ge 0$.\n\nB. A compressive shock forms and propagates into the dry bed with speed $\\xi_\\text{shock} = \\sqrt{g h_L}$ determined by the Rankine–Hugoniot conditions, because the loss of pressure support at $h_R=0$ requires a discontinuity. The shoreline coincides with the shock, and a rarefaction is not admissible.\n\nC. A contact discontinuity carries the shoreline at speed $\\xi_\\text{shore} = \\sqrt{g h_L}$, leaving a uniform state $(h,u)=(h_L,0)$ behind it. The hyperbolic structure forbids rarefaction into a vacuum, so the dry bed can only be wetted by advection without drawdown.\n\nD. A rarefaction connects $(h_L,u_L)$ to a small but nonzero depth on the right, and the shoreline speed is $\\xi_\\text{shore} = u_L + \\sqrt{g h_L}$. A shock attaches to the shoreline when $u_L=0$, reflecting the degeneracy at $h_R=0$.",
            "solution": "The user wants me to solve a problem related to the shallow water equations and a specific Riemann problem known as the \"dry-bed\" or \"dam-break\" problem.\n\nHere's my plan:\n1.  **Validate the problem statement**:\n    *   **Extract Givens**: I'll list the provided equations, initial conditions, and definitions.\n    *   **Check for Validity**: I'll assess if the problem is scientifically sound, well-posed, and objective. The problem describes the 1D shallow water equations, which are a standard model in fluid dynamics. The initial condition is a classic Riemann problem setup, specifically the dam-break problem over a dry bed. This is a well-established problem in the field. The question asks for the analytical solution based on the hyperbolic structure, which is a standard approach. The problem seems valid.\n\n2.  **Solve the problem**:\n    *   **Analyze the Governing Equations**: The equations are given in conservative form:\n        $$ \\partial_t h + \\partial_x (hu) = 0 $$\n        $$ \\partial_t (hu) + \\partial_x (hu^2 + \\frac{1}{2}gh^2) = 0 $$\n        The vector of conserved variables is $\\mathbf{U} = [h, hu]^T$. The flux vector is $\\mathbf{F} = [hu, hu^2 + \\frac{1}{2}gh^2]^T$.\n        The system can also be written in primitive variable form:\n        $$ \\partial_t h + u \\partial_x h + h \\partial_x u = 0 $$\n        To get the second equation in primitive form, we use the product rule:\n        $$ h \\partial_t u + u \\partial_t h + 2hu \\partial_x u + u^2 \\partial_x h + gh \\partial_x h = 0 $$\n        Substitute $\\partial_t h = -u \\partial_x h - h \\partial_x u$:\n        $$ h \\partial_t u + u(-u \\partial_x h - h \\partial_x u) + 2hu \\partial_x u + u^2 \\partial_x h + gh \\partial_x h = 0 $$\n        $$ h \\partial_t u - u^2 \\partial_x h - hu \\partial_x u + 2hu \\partial_x u + u^2 \\partial_x h + gh \\partial_x h = 0 $$\n        $$ h \\partial_t u + hu \\partial_x u + gh \\partial_x h = 0 $$\n        Dividing by $h$ (for $h0$):\n        $$ \\partial_t u + u \\partial_x u + g \\partial_x h = 0 $$\n        So the primitive form is:\n        $$ \\partial_t h + u \\partial_x h + h \\partial_x u = 0 $$\n        $$ \\partial_t u + u \\partial_x u + g \\partial_x h = 0 $$\n\n    *   **Analyze the Hyperbolic Structure**: The Jacobian of the flux vector $\\mathbf{F}$ with respect to the primitive variables $\\mathbf{W} = [h, u]^T$ is not what we need. We need the Jacobian of $\\mathbf{F}(\\mathbf{U})$ with respect to $\\mathbf{U}$. Let's use the primitive form. The system matrix is:\n        $$ A = \\begin{pmatrix} u  h \\\\ g  u \\end{pmatrix} $$\n        The eigenvalues are the characteristic speeds $\\lambda$.\n        $$ \\det(A - \\lambda I) = \\det \\begin{pmatrix} u-\\lambda  h \\\\ g  u-\\lambda \\end{pmatrix} = (u-\\lambda)^2 - gh = 0 $$\n        So, $\\lambda = u \\pm \\sqrt{gh} = u \\pm c$. The system is strictly hyperbolic for $h0$.\n        The right eigenvectors are:\n        For $\\lambda_1 = u+c$:\n        $$ (A - (u+c)I) \\mathbf{r}_1 = \\begin{pmatrix} -c  h \\\\ g  -c \\end{pmatrix} \\begin{pmatrix} r_{11} \\\\ r_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n        This gives $-c r_{11} + h r_{12} = 0 \\implies r_{12} = (c/h) r_{11} = (\\sqrt{gh}/h) r_{11} = (\\sqrt{g/h}) r_{11}$. Let $r_{11} = 1$, then $\\mathbf{r}_1 = [1, \\sqrt{g/h}]^T$. Or scaled, $[h, c]^T$.\n        For $\\lambda_2 = u-c$:\n        $$ (A - (u-c)I) \\mathbf{r}_2 = \\begin{pmatrix} c  h \\\\ g  c \\end{pmatrix} \\begin{pmatrix} r_{21} \\\\ r_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n        This gives $c r_{21} + h r_{22} = 0 \\implies r_{22} = -(c/h) r_{21} = -(\\sqrt{g/h}) r_{21}$. Let $r_{21} = 1$, then $\\mathbf{r}_2 = [1, -\\sqrt{g/h}]^T$. Or scaled, $[h, -c]^T$.\n\n    *   **Riemann Invariants**: These are quantities that are constant along characteristic curves.\n        For a simple wave associated with $\\lambda_1 = u+c$, the state changes along the eigenvector $\\mathbf{r}_2$.\n        The variation of the state $(dh, du)$ is proportional to the eigenvector of the other family.\n        So for a $C_−$ wave (associated with $\\lambda_2 = u-c$), $(dh, du)$ is proportional to $\\mathbf{r}_1 = [1, \\sqrt{g/h}]^T$.\n        $du/dh = \\sqrt{g/h}$. Integrating this gives $u = \\int \\sqrt{g/h} dh = \\sqrt{g} \\int h^{-1/2} dh = \\sqrt{g} (2h^{1/2}) + \\text{const}$.\n        So $u - 2\\sqrt{gh} = \\text{const}$. This is the Riemann invariant $R_- = u - 2c$.\n        For a $C_+$ wave (associated with $\\lambda_1 = u+c$), $(dh, du)$ is proportional to $\\mathbf{r}_2 = [1, -\\sqrt{g/h}]^T$.\n        $du/dh = -\\sqrt{g/h}$. Integrating this gives $u = -\\int \\sqrt{g/h} dh = -\\sqrt{g} (2h^{1/2}) + \\text{const}$.\n        So $u + 2\\sqrt{gh} = \\text{const}$. This is the Riemann invariant $R_+ = u + 2c$.\n\n    *   **Solve the Riemann Problem**:\n        Initial states:\n        Left state: $(h_L, u_L)$ for $x0$.\n        Right state: $(h_R, u_R) = (0, 0)$ for $x0$.\n        The solution consists of waves connecting $(h_L, u_L)$ to an intermediate state $(h_*, u_*)$ and then $(h_*, u_*)$ to $(h_R, u_R) = (0,0)$. The waves travel with speeds $\\xi = x/t$.\n        The waves could be shocks or rarefactions.\n        Let's consider the wave types.\n        The fast wave (right-going family) connects $(h_L, u_L)$ to $(h_*, u_*)$, and the slow wave (left-going family) connects $(h_*, u_*)$ to $(h_R, u_R)$. Wait, no, that's backwards for the standard ordering.\n        The standard solution structure for a Riemann problem has a left-going wave, an intermediate state, and a right-going wave.\n        So: $(h_L, u_L) \\xrightarrow{\\text{left wave}} (h_*, u_*) \\xrightarrow{\\text{right wave}} (h_R, u_R)$.\n        The left wave is associated with $\\lambda_- = u-c$. The right wave is associated with $\\lambda_+ = u+c$.\n\n        **Wave connecting $(h_L, u_L)$ to $(h_*, u_*)$ (Left-going wave):**\n        This wave belongs to the $\\lambda_-$ family.\n        If it's a rarefaction: $\\lambda_-(h_L, u_L)  \\lambda_-(h_*, u_*)$.\n        If it's a shock: $\\lambda_-(h_L, u_L)  \\lambda_-(h_*, u_*)$.\n\n        **Wave connecting $(h_*, u_*) to (h_R, u_R)$ (Right-going wave):**\n        This wave belongs to the $\\lambda_+$ family.\n        If it's a rarefaction: $\\lambda_+(h_*, u_*)  \\lambda_+(h_R, u_R)$.\n        If it's a shock: $\\lambda_+(h_*, u_*)  \\lambda_+(h_R, u_R)$.\n\n        In our problem, the state $(h_R, u_R) = (0,0)$. The characteristics are degenerate here since $c_R=\\sqrt{gh_R}=0$.\n        This is a special case. The solution cannot be a standard shock connecting to $(0,0)$. The Rankine-Hugoniot conditions for a shock propagating into a state at rest $(u_R = 0)$ are:\n        $S(h_* - h_R) = h_* u_* - h_R u_R$\n        $S(h_* u_* - h_R u_R) = (h_* u_*^2 + \\frac{1}{2}gh_*^2) - (h_R u_R^2 + \\frac{1}{2}gh_R^2)$\n        With $h_R=0, u_R=0$:\n        $S h_* = h_* u_* \\implies u_* = S$ (if $h_* \\neq 0$). The shock speed is the post-shock fluid velocity.\n        $S(h_* u_*) = h_* u_*^2 + \\frac{1}{2}gh_*^2$\n        $S(h_* S) = h_* S^2 + \\frac{1}{2}gh_*^2$\n        $h_* S^2 = h_* S^2 + \\frac{1}{2}gh_*^2 \\implies \\frac{1}{2}gh_*^2 = 0$.\n        This implies $h_*=0$, which is a trivial solution. Therefore, a standard shock solution is not possible. The problem of a shock propagating into a vacuum ($h=0$) is ill-defined in the standard theory. So, option B is likely incorrect.\n\n        Let's analyze the rarefaction wave case.\n        Consider the case where the solution is a single rarefaction wave connecting $(h_L, u_L)$ to $(h_R, u_R)=(0,0)$. This would mean that one family of characteristics is straight, while the other family fans out.\n        If it is a right-going rarefaction wave connecting $(h_L, u_L)$ to $(0,0)$, then the Riemann invariant $R_- = u-2c$ must be constant across the wave.\n        $u_L - 2c_L = u_R - 2c_R$.\n        With $(h_R, u_R)=(0,0)$, we have $c_R = 0$. So this would require $u_L - 2\\sqrt{gh_L} = 0$. This is a very specific initial condition.\n        If it is a left-going rarefaction wave connecting $(h_L, u_L)$ to $(0,0)$, then the Riemann invariant $R_+ = u+2c$ must be constant across the wave.\n        $u_L + 2c_L = u_R + 2c_R$.\n        $u_L + 2\\sqrt{gh_L} = 0$. This also requires a specific initial condition.\n\n        The structure is more complex. Let's re-examine the canonical solution for the dam-break problem over a dry bed.\n        The initial state is $(h_L, u_L)$ on the left and $(h_R, u_R) = (0,0)$ on the right.\n        There must be an intermediate state $(h_*, u_*)$.\n        Left wave: from $(h_L, u_L)$ to $(h_*, u_*)$.\n        Right wave: from $(h_*, u_*) to (0,0)$.\n\n        The key insight for the dry bed problem is that the state $(h_R, u_R)=(0,0)$ can only be connected to a state $(h_*, u_*)$ via a rarefaction wave. Why? Because a shock is impossible as shown above.\n        The right wave must be a rarefaction wave belonging to the right-going family ($C_+$).\n        Across this rarefaction, the Riemann invariant $R_- = u-2c$ is constant.\n        So, $u_* - 2c_* = u_R - 2c_R = 0 - 0 = 0$.\n        This implies $u_* = 2c_* = 2\\sqrt{gh_*}$. This is a crucial relationship for the intermediate state.\n        This rarefaction wave fans out. The states within the fan $(h(\\xi), u(\\xi))$ for $\\xi = x/t$ are given by self-similarity.\n        The characteristics in a rarefaction are straight lines $\\xi = u(\\xi) \\pm c(\\xi)$.\n        For a right-going rarefaction, the solution is constant along the $\\lambda_- = u-c$ characteristics. The solution varies along the $\\lambda_+ = u+c$ characteristics. The self-similar solution is found by setting $\\xi = x/t = \\lambda_+ = u+c$.\n        So, $\\xi = u(\\xi) + \\sqrt{g h(\\xi)}$.\n        Also, across this rarefaction, the other Riemann invariant $R_- = u - 2c$ is constant and equal to its value at the right state $(0,0)$. So $u(\\xi) - 2\\sqrt{g h(\\xi)} = 0 \\implies u(\\xi) = 2\\sqrt{g h(\\xi)}$. This holds for any state $(h,u)$ within the rarefaction fan, including the intermediate state $(h_*, u_*)$.\n        Now we can solve for $h$ and $u$ inside the fan.\n        Substitute $u = 2\\sqrt{gh}$ into $\\xi = u + \\sqrt{gh}$:\n        $\\xi = 2\\sqrt{gh} + \\sqrt{gh} = 3\\sqrt{gh}$.\n        From this, $\\sqrt{gh} = \\xi/3$, so $gh = (\\xi/3)^2$.\n        $h(\\xi) = \\frac{\\xi^2}{9g}$.\n        And $u(\\xi) = 2\\sqrt{gh} = 2(\\xi/3) = \\frac{2\\xi}{3}$.\n        This rarefaction wave extends from the intermediate state $(h_*, u_*)$ to the dry state $(h=0, u=0)$.\n        The left edge of this rarefaction fan has speed $\\xi_{left_of_fan} = u_* + c_*$. Using $u_* = 2c_*$, this is $3c_* = 3\\sqrt{gh_*}$.\n        The right edge of this fan corresponds to $h \\to 0$. As $h \\to 0$, $c \\to 0$ and $u \\to 0$. The speed is $\\xi = u+c = 0+0 = 0$. This is weird. Let's re-think.\n\n        Let's look at the structure from phase space $(h, u)$.\n        The state $(h_R, u_R) = (0,0)$ is a vacuum state.\n        The right wave connects $(h_*, u_*)$ to $(0,0)$. It must be a rarefaction. Along the rarefaction curve from $(0,0)$, an integral curve of $\\mathbf{r}_1=[1, \\sqrt{g/h}]^T$ is followed.\n        $du/dh = \\sqrt{g/h}$, which gives $u = 2\\sqrt{gh} + \\text{const}$. Since it passes through $(h_R=0, u_R=0)$, the constant is $0$. So $u=2\\sqrt{gh}$ is the curve in phase space for the right wave. Any state $(h,u)$ in this wave must satisfy $u=2\\sqrt{gh}$.\n        So for the intermediate state, $u_* = 2\\sqrt{gh_*}  0$.\n\n        The left wave connects $(h_L, u_L)$ to $(h_*, u_*)$. This wave can be a shock or a rarefaction.\n        If it's a left-going rarefaction:\n        The Riemann invariant $R_+ = u+2c$ must be constant.\n        $u_L + 2c_L = u_* + 2c_*$.\n        We have two equations for two unknowns $(h_*, u_*)$:\n        1) $u_* = 2\\sqrt{gh_*}$\n        2) $u_L + 2\\sqrt{gh_L} = u_* + 2\\sqrt{gh_*} = 2\\sqrt{gh_*} + 2\\sqrt{gh_*} = 4\\sqrt{gh_*} = 2u_*$\n        So, $u_* = \\frac{1}{2}(u_L + 2\\sqrt{gh_L})$.\n        And $\\sqrt{gh_*} = \\frac{1}{4}(u_L + 2\\sqrt{gh_L})$.\n        This is a solution for $h_*, u_*$. A left-going rarefaction is admissible if characteristic speeds increase from left to right, i.e., $\\lambda_-(h_L, u_L) \\leq \\lambda_-(h_*, u_*)$.\n        $\\lambda_-(h,u) = u-c$.\n        So we need $u_L - c_L \\leq u_* - c_*$.\n        Substitute $u_* = 2c_*$: $u_L - c_L \\leq 2c_* - c_* = c_*$.\n        $u_L - \\sqrt{gh_L} \\leq \\sqrt{gh_*} = \\frac{1}{4}(u_L + 2\\sqrt{gh_L})$.\n        $4u_L - 4\\sqrt{gh_L} \\leq u_L + 2\\sqrt{gh_L}$\n        $3u_L \\leq 6\\sqrt{gh_L} \\implies u_L \\leq 2\\sqrt{gh_L}$.\n        So, if $u_L \\leq 2\\sqrt{gh_L}$, the left wave is a rarefaction.\n\n        If it's a left-going shock:\n        This occurs if $u_L  2\\sqrt{gh_L}$. The equations are the Rankine-Hugoniot conditions for a left-moving shock.\n        But the problem statement seems to point towards a simpler structure. \"Using only the governing equations and their hyperbolic structure... determine the admissible wave structure\".\n        The most common version of this problem is the dam-break problem proper, where the initial state is water at rest, i.e., $u_L=0$.\n        In this case, $u_L=0 \\leq 2\\sqrt{gh_L}$, so the left wave is a rarefaction.\n        The whole solution is a single, centered rarefaction fan. This can't be right.\n        Let's reconsider the solution structure.\n        The state $(h_L, u_L)$ is connected to $(0,0)$.\n        The solution consists of a single centered wave. If it were a shock, we've shown it's not possible. So it must be a rarefaction wave.\n        Which family? Let's assume the water flows to the right to fill the dry area. This intuitively implies a right-going wave pattern. But the problem mentions a \"left-going family\".\n        Let's look at the standard solution presented in textbooks (e.g., LeVeque, Toro).\n        The state $(h_R, u_R) = (0,0)$ is a vacuum state. A vacuum state cannot be on the right of any wave, except for a rarefaction wave. (a shock into vacuum is not well-defined, a contact discontinuity would require $u_*=u_R=0$ and the pressure would not match unless $h_*=h_R=0$).\n        So the right state $(0,0)$ must be approached through a right-going rarefaction.\n        Wait, no. A vacuum can be on the right of a left travelling wave, or the left of a right travelling wave.\n        Here, the vacuum is at $x0$, so it is on the right. So the wave impinging on it must be a right-going wave.\n        The solution cannot be a single shock.\n        Let's try a single rarefaction wave connecting $(h_L, u_L)$ to $(0,0)$.\n        This is physically what happens when a dam breaks over a dry bed. The water flows out.\n        The water level drops, and the velocity increases. This is a rarefaction.\n        This single wave must belong to one family.\n        The solution is self-similar, $\\xi = x/t$. The state variables $(h,u)$ are functions of $\\xi$ alone.\n        The equations become:\n        $(\\xi - u)h' - hu' = 0$\n        $(\\xi - u)u' - g h' = 0$\n        (This is from $\\partial_t = -\\xi/t^2 \\partial_\\xi$ and $\\partial_x = 1/t \\partial_\\xi$ applied to the primitive equations).\n        Wait, let me derive it properly. $\\partial_t V + A(V) \\partial_x V=0$. Let $V(x,t) = W(x/t)$.\n        $\\partial_t W = -(x/t^2)W' = -(\\xi/t)W'$. $\\partial_x W = (1/t)W'$.\n        $(-\\xi/t)W' + (1/t)A W' = 0 \\implies (A - \\xi I) W' = 0$.\n        This means that for a non-trivial solution ($W' \\neq 0$), $\\xi$ must be an eigenvalue of $A$, and $W'$ must be the corresponding eigenvector.\n        So $\\xi = u \\pm \\sqrt{gh}$.\n        This defines a simple wave, or rarefaction wave.\n        Let's pick the $\\xi=u-c$ family (left-going characteristics). This is the $C_-$ family.\n        Then $d\\mathbf{W}/d\\xi$ is proportional to the corresponding eigenvector $\\mathbf{r}_- = [h, -c]^T$ (or a multiple). So $du/dh = -c/h = -\\sqrt{g/h}$.\n        Integrating gives $u+2\\sqrt{gh} = \\text{const}$. This is the Riemann invariant $R_+$.\n        The self similar variable is $\\xi = u - c$.\n        So we have two equations for $u(\\xi)$ and $h(\\xi)$:\n        1) $u + 2\\sqrt{gh} = u_L + 2\\sqrt{gh_L}$ (since the wave starts from state L)\n        2) $\\xi = u - \\sqrt{gh}$\n        From (2), $u = \\xi + \\sqrt{gh}$.\n        Substitute into (1):\n        $(\\xi + \\sqrt{gh}) + 2\\sqrt{gh} = u_L + 2\\sqrt{gh_L}$\n        $\\xi + 3\\sqrt{gh} = u_L + 2\\sqrt{gh_L}$\n        $3\\sqrt{gh} = u_L + 2\\sqrt{gh_L} - \\xi$\n        $\\sqrt{gh} = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} - \\xi)$\n        $h(\\xi) = \\frac{1}{9g}(u_L + 2\\sqrt{gh_L} - \\xi)^2$.\n        Now find $u(\\xi)$:\n        $u(\\xi) = \\xi + \\sqrt{gh} = \\xi + \\frac{1}{3}(u_L + 2\\sqrt{gh_L} - \\xi) = \\frac{1}{3}(3\\xi + u_L + 2\\sqrt{gh_L} - \\xi) = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} + 2\\xi)$.\n        This describes the rarefaction fan. What are its boundaries?\n        The fan starts at the left, where the state is $(h_L, u_L)$. The characteristic speed at this point is the left boundary of the fan:\n        $\\xi_{left} = u_L - c_L = u_L - \\sqrt{gh_L}$.\n        The fan extends to the right. The question is, where does it end? It connects to the dry state $(h=0, u=0)$.\n        Let's call the right edge of the fan $\\xi_{shore}$. At this point, the depth $h$ must go to zero.\n        Let's see what happens to our solution for $h(\\xi)$ as $h \\to 0$.\n        $h(\\xi_{shore}) = \\frac{1}{9g}(u_L + 2\\sqrt{gh_L} - \\xi_{shore})^2 = 0$.\n        This implies $\\xi_{shore} = u_L + 2\\sqrt{gh_L}$.\n        So the rarefaction fan extends from $\\xi_{left} = u_L - \\sqrt{gh_L}$ to $\\xi_{shore} = u_L + 2\\sqrt{gh_L}$.\n        What is the velocity $u$ at this shoreline?\n        $u(\\xi_{shore}) = u(u_L + 2\\sqrt{gh_L}) = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} + 2(u_L + 2\\sqrt{gh_L})) = \\frac{1}{3}(3u_L + 6\\sqrt{gh_L}) = u_L + 2\\sqrt{gh_L}$.\n        So, at the moving shoreline, we have the state $(h \\to 0, u \\to u_L + 2\\sqrt{gh_L})$.\n        And the speed of the shoreline is exactly this velocity.\n        $\\xi_{shore} = u(\\xi_{shore})$. This makes perfect sense: the water particles at the very front of the advancing wave constitute the shoreline, so their velocity must be the shoreline's speed.\n        The solution consists of a single centered rarefaction wave that connects the left state $(h_L, u_L)$ to the state $(h=0, u=u_L + 2\\sqrt{gh_L})$ at the shoreline. Note that this is not the right state $(0,0)$. The right state is $(0,0)$, but the rarefaction solution gives a non-zero velocity at the shoreline where $h=0$.\n        The state $(h=0, u=u_L+2\\sqrt{gh_L})$ is a vacuum state, just as $(h=0, u=0)$ is. The equations are degenerate at $h=0$. Any velocity is possible when $h=0$ from the point of view of the equations. The fluid mechanics interpretation is that the frontmost particle of water advances with velocity $u_{shore}$.\n        This solution is physically admissible because the characteristics of the chosen family ($\\lambda_- = u-c$) diverge as we move from left to right through the fan. Let's check this.\n        $\\xi = u-c$.\n        $d\\xi/d\\xi = 1$.\n        $d(u-c)/d\\xi = u' - c' = u' - \\frac{d}{d\\xi}(\\sqrt{g h})$.\n        $h(\\xi) = \\frac{1}{9g}(K-\\xi)^2$ where $K=u_L+2c_L$. So $h' = -\\frac{2}{9g}(K-\\xi)$.\n        $u(\\xi) = \\frac{1}{3}(K+2\\xi)$. So $u' = 2/3$.\n        $c(\\xi) = \\sqrt{gh} = \\frac{1}{3}(K-\\xi)$. So $c' = -1/3$.\n        $u'-c' = 2/3 - (-1/3) = 1$. This confirms $d\\xi/d\\xi=1$. The characteristics diverge, so it is a valid rarefaction.\n\n        Let's compare this derivation with the options.\n\n        Option A: \"A single centered rarefaction connects $(h_L,u_L)$ to a vacuum state $(h=0)$, belonging to the left-going family with self-similar coordinate $\\xi = x/t = u - c$.\"\n        This matches my derivation. A \"left-going family\" means the wave is a $C_−$ simple wave, where the equations become $\\xi=u-c$ and $u+2c = const$. This is what I used.\n\n        Option A (cont.): \"The left edge of the fan moves at $\\xi_\\text{left} = u_L - \\sqrt{g h_L}$\".\n        This matches my derivation: $\\xi_{left} = u_L - c_L$. Correct.\n\n        Option A (cont.): \"...and the right edge is a moving shoreline at $\\xi_\\text{shore} = u_L + 2 \\sqrt{g h_L}$\".\n        This matches my derivation: $\\xi_{shore} = u_L + 2c_L$. Correct.\n\n        Option A (cont.): \"...where $h \\to 0$ and $u \\to \\xi_\\text{shore}$.\"\n        This means $u \\to u_L + 2\\sqrt{gh_L}$. My derivation gives $u(\\xi_{shore}) = u_L + 2\\sqrt{gh_L}$. This is also correct.\n\n        Option A (cont.): \"No shock is admissible because characteristics diverge, and the wetting front advances supercritically, flooding the dry bed while maintaining $h \\ge 0$.\"\n        \"No shock is admissible\" - a shock into vacuum is ill-posed by Rankine-Hugoniot. The rarefaction is a physically valid entropy solution. \"because characteristics diverge\" is the definition of a rarefaction, so this is consistent.\n        What does \"advances supercritically\" mean? The Froude number is $Fr = |u|/c$. In the rarefaction fan, $u(\\xi) = 2c(\\xi)$. So $Fr = 2$. This is supercritical flow ($Fr1$). The flow in the fan is indeed supercritical. The shoreline speed is $\\xi_{shore} = u_L + 2c_L$. The local wave speed at the front is $c=0$. The velocity of the front is $u_{shore}$, which is much greater than $c=0$. Supercritical seems appropriate.\n        \"flooding the dry bed while maintaining $h \\ge 0$\". The solution $h(\\xi) = \\frac{1}{9g}(...)^2$ is always non-negative. This is correct.\n\n        So, Option A seems entirely correct based on the standard analytical solution of the dry-bed Riemann problem for the shallow water equations.\n\n        Let's quickly review the other options to be sure.\n\n        Option B: \"A compressive shock forms and propagates into the dry bed with speed $\\xi_\\text{shock} = \\sqrt{g h_L}$ determined by the Rankine–Hugoniot conditions...\".\n        I have already shown that the Rankine-Hugoniot conditions lead to a contradiction ($gh_*^2 = 0$) for a shock propagating into a zero-depth state. So, a standard shock is not possible. The speed calculation is also likely wrong. The formula $\\sqrt{gh_L}$ might come from a small-amplitude approximation or some other context, but it doesn't follow from the R-H conditions for this problem. A shock requires characteristics to converge, but here they diverge. So B is incorrect.\n\n        Option C: \"A contact discontinuity carries the shoreline at speed $\\xi_\\text{shore} = \\sqrt{g h_L}$...\".\n        A contact discontinuity is a wave across which pressure and normal velocity are continuous. In the shallow water equations, velocity $u$ and depth $h$ are continuous across a contact discontinuity. If the right state is $(0,0)$, then the state just to the left of the discontinuity must be $(h\\to 0, u\\to 0)$. This does not match the left state $(h_L, u_L)$, so another wave would be needed. This is not the structure. Also, contact discontinuities travel at speed $u$. So $\\xi_{shore} = u_*$. If $u_*=u_R=0$, then the shoreline wouldn't move. If it connects to a state $(h_*, u_*)$, then it moves with speed $u_*$. The statement that a contact discontinuity \"carries the shoreline\" is plausible in some models, but the structure described here is wrong. The speed $\\sqrt{gh_L}$ seems arbitrary again. Incorrect.\n\n        Option D: \"A rarefaction connects $(h_L,u_L)$ to a small but nonzero depth on the right, and the shoreline speed is $\\xi_\\text{shore} = u_L + \\sqrt{g h_L}$.\"\n        This is a common numerical technique, the \"thin film\" or \"slot\" method, to avoid the degeneracy at $h=0$. But the problem asks for the solution based *only* on the governing equations without \"ad hoc regularization\". Positing a small non-zero depth is an ad-hoc regularization. The analytical solution involves $h$ going to exactly zero. So this option describes a modification of the problem, not its direct solution. The shoreline speed is also given as $\\xi_{shore} = u_L + \\sqrt{g h_L}$, which is different from my derived value of $u_L + 2\\sqrt{gh_L}$. For example, for a dam-break at rest ($u_L=0$), my speed is $2\\sqrt{gh_L}$, while this option gives $\\sqrt{gh_L}$. My result is the standard one. Thus, D is incorrect.\n\n        Conclusion: Option A perfectly describes the analytical solution of the Riemann problem posed.\n\n        Let's double-check the reasoning and calculations.\n        Problem:\n        $$ \\partial_t h + \\partial_x (h u) = 0 $$\n        $$ \\partial_t (h u) + \\partial_x \\left(h u^2 + \\tfrac{1}{2} g h^2\\right) = 0 $$\n        Initial data: $(h,u)(x,0) = (h_L,u_L)$ for $x0$ and $(0,0)$ for $x0$.\n        Solution is a self-similar rarefaction wave.\n        Characteristics of the rarefaction belong to one family, let's say $\\lambda_- = u-c$.\n        This means the Riemann invariant for the other family is constant across the wave: $R_+ = u+2c = \\text{const}$.\n        The characteristics themselves are straight lines given by $\\xi=x/t=\\lambda_- = u-c$.\n        At the left edge of the wave, the state is $(h_L, u_L)$. So the constant value of the Riemann invariant is $u_L+2c_L$.\n        Throughout the rarefaction fan, we have:\n        (1) $u + 2c = u_L + 2c_L$\n        (2) $\\xi = u - c$\n        This is a system of two linear equations for $u$ and $c$:\n        (1) $u+2c = u_L+2c_L$\n        (2) $u-c = \\xi$\n        Subtract (2) from (1): $3c = u_L+2c_L - \\xi \\implies c(\\xi) = \\frac{1}{3}(u_L + 2c_L - \\xi)$.\n        As $c=\\sqrt{gh}$, this gives $h(\\xi) = \\frac{c^2}{g} = \\frac{1}{9g}(u_L + 2\\sqrt{gh_L} - \\xi)^2$.\n        Add 2*(2) to (1): $3u = (u_L+2c_L) + 2\\xi \\implies u(\\xi) = \\frac{1}{3}(u_L + 2c_L + 2\\xi)$. No, my earlier algebra was right:\n        From (2), $u = \\xi+c$. Substitute into (1): $(\\xi+c)+2c = u_L+2c_L \\implies \\xi+3c = u_L+2c_L$.\n        This gives $c(\\xi)$ and $h(\\xi)$ as above. Correct.\n        Now for $u(\\xi)$:\n        $u(\\xi) = \\xi+c(\\xi) = \\xi + \\frac{1}{3}(u_L + 2c_L - \\xi) = \\frac{1}{3}(3\\xi + u_L + 2c_L - \\xi) = \\frac{1}{3}(u_L + 2c_L + 2\\xi)$.\n        $u(\\xi) = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} + 2\\xi)$. This matches my previous derivation.\n        The left boundary of the fan is where $\\xi$ is such that $(h(\\xi), u(\\xi)) = (h_L, u_L)$.\n        Solving $\\xi = u-c$ for this state gives $\\xi_{left} = u_L - c_L = u_L - \\sqrt{gh_L}$. Correct.\n        The right boundary of the fan is the shoreline, where $h \\to 0$.\n        $h(\\xi_{shore})=0 \\implies c(\\xi_{shore})=0$.\n        From $c(\\xi) = \\frac{1}{3}(u_L + 2c_L - \\xi)$, we get $0 = \\frac{1}{3}(u_L + 2c_L - \\xi_{shore})$.\n        This gives $\\xi_{shore} = u_L + 2c_L = u_L + 2\\sqrt{gh_L}$. Correct.\n        Now, what is the velocity at the shoreline?\n        $u_{shore} = u(\\xi_{shore}) = \\frac{1}{3}(u_L + 2c_L + 2\\xi_{shore})$.\n        $u_{shore} = \\frac{1}{3}(u_L + 2c_L + 2(u_L + 2c_L)) = \\frac{1}{3}(3u_L + 6c_L) = u_L + 2c_L$.\n        So $u_{shore} = \\xi_{shore}$. The velocity of the fluid at the tip of the rarefaction wave is equal to the speed of the tip itself. This is a very important consistency check. Correct.\n        The family of characteristics used was $\\lambda_- = u-c$. The problem text in option A says \"belonging to the left-going family with self-similar coordinate $\\xi=x/t=u-c$\". This is precisely what I derived.\n        The choice of the left-going family $\\xi=u-c$ to describe the rarefaction seems correct.\n        Is it possible to use the other family, $\\xi = u+c$?\n        Then $R_-=u-2c$ would be constant. $u-2c=u_L-2c_L$.\n        And $\\xi=u+c$.\n        So $u = \\xi-c$. Substitute into invariant: $(\\xi-c)-2c = u_L-2c_L \\implies \\xi-3c = u_L-2c_L$.\n        $3c = \\xi - (u_L-2c_L)$.\n        $c(\\xi) = \\frac{1}{3}(\\xi - u_L + 2c_L)$.\n        Shoreline at $c=0$ requires $\\xi_{shore} = u_L - 2c_L$.\n        The velocity at the shoreline would be $u_{shore} = \\xi_{shore} - c(\\xi_{shore}) = \\xi_{shore} = u_L - 2c_L$.\n        So the water would be flowing to the left. This would correspond to a dam-break problem where the dry region is on the left ($x0$). Our dry region is on the right ($x0$), so water must flow to the right. This requires $u0$ in the wave region.\n        In the first case (my main derivation), $u(\\xi) = \\frac{1}{3}(u_L+2c_L+2\\xi)$.\n        Let's take $u_L=0$ for simplicity (dam at rest). Then $u(\\xi) = \\frac{1}{3}(2c_L+2\\xi)$.\n        The fan is from $\\xi_{left}=-c_L$ to $\\xi_{right}=2c_L$.\n        At left edge, $u(-c_L) = \\frac{1}{3}(2c_L - 2c_L) = 0 = u_L$. OK.\n        At right edge, $u(2c_L) = \\frac{1}{3}(2c_L + 4c_L) = 2c_L$. Positive.\n        In the fan, for $\\xi  -c_L$, $u(\\xi)  0$. So water flows to the right. This solution is physically consistent with flooding the dry region at $x0$.\n        In the second case (the alternative I just explored), for $u_L=0$:\n        $u(\\xi)$: $c = (\\xi+2c_L)/3$. $u = \\xi-c = \\xi - (\\xi+2c_L)/3 = (2\\xi-2c_L)/3$.\n        Fan from $\\xi_{left}=-2c_L$ to $\\xi_{right}=c_L$.\n        At right edge: $u(c_L) = (2c_L-2c_L)/3 = 0 = u_L$. OK.\n        At left edge: $u(-2c_L) = (-4c_L-2c_L)/3 = -2c_L$. Negative.\n        This describes water flowing to the left. So it's not the correct solution for our initial setup.\n        Therefore, the wave must indeed be a simple wave of the $C_-$ family (characteristics $\\xi=u-c$), where the $R_+$ invariant is constant.\n        The problem statement in option A says \"belonging to the left-going family with self-similar coordinate $\\xi=x/t=u-c$\". This is a bit ambiguous. Usually a rarefaction in the $k$-th family means characteristics of the $k$-th family are spreading. Here, it is a $C_−$ rarefaction, meaning $d\\lambda_-/d\\xi  0$. The characteristic speed is $\\lambda_- = u-c$. As I checked, $d(u-c)/d\\xi = 1  0$. But the formula used for self-similarity is $\\xi = u-c$, which is correct for this wave. The term \"left-going family\" is perhaps slightly confusing as the wave itself spreads to the right into the dry area. However, it refers to the family of characteristics $\\lambda_-$, which are conventionally called the \"slow\" or \"left-going\" family. The solution is generated by a $C_-$ simple wave. Yes, this is the standard terminology.\n\n        Let's summarize my findings against Option A again.\n        - \"A single centered rarefaction connects $(h_L,u_L)$ to a vacuum state $(h=0)$\": Yes, the solution is a single rarefaction fan that ends where $h=0$.\n        - \"belonging to the left-going family with self-similar coordinate $\\xi = x/t = u - c$\": Yes, it's a $C_-$ simple wave, for which $\\xi=u-c$ and $u+2c$ is invariant.\n        - \"The left edge of the fan moves at $\\xi_\\text{left} = u_L - \\sqrt{g h_L}$\": Yes, $\\xi_{left}=u_L-c_L$.\n        - \"the right edge is a moving shoreline at $\\xi_\\text{shore} = u_L + 2 \\sqrt{g h_L}$\": Yes, this is the speed at which $h \\to 0$.\n        - \"where $h \\to 0$ and $u \\to \\xi_\\text{shore}$\": Yes, the fluid velocity at the front matches the front speed.\n        - \"No shock is admissible because characteristics diverge\": Correct, a rarefaction is an expansion wave where characteristics diverge. The alternative (shock) is not mathematically consistent for a vacuum state.\n        - \"the wetting front advances supercritically\": Yes, flow is supercritical ($Fr=2$) inside the fan.\n        - \"flooding the dry bed while maintaining $h \\ge 0$\": Yes, the solution is physically realistic.\n\n        Everything in Option A holds up perfectly.\n        The problem is well-posed and a good test of understanding the analytical solution to the dam-break problem over a dry bed.\n\n        Final check of the validation steps.\n        Step 1: Extract Givens.\n        - Governing equations: $\\partial_t h + \\partial_x (h u) = 0$, $\\partial_t (h u) + \\partial_x \\left(h u^2 + \\tfrac{1}{2} g h^2\\right) = 0$.\n        - System properties: Strictly hyperbolic for $h0$, characteristic speeds $u \\pm \\sqrt{gh}$.\n        - Initial data: $(h,u)(x,0) = (h_L,u_L)$ for $x0$, $(0,0)$ for $x0$, with $h_L0$.\n        - Question: Determine admissible wave structure and shoreline speed using only the governing equations, and select the option characterizing the wave pattern and physical interpretation.\n\n        Step 2: Validate.\n        - Scientifically Grounded: Yes, the shallow water equations are a fundamental model in fluid dynamics. The dam-break problem is a classical test case.\n        - Well-posed: Yes, for the given initial data, a unique, weak entropy solution exists. The structure of this solution is well-known.\n        - Objective: Yes, the language is precise and mathematical.\n        The problem has no flaws from the checklist. It's a standard, valid problem from computational fluid dynamics / hyperbolic conservation laws.\n\n        Step 3: Verdict and Action.\n        - Verdict: The problem is valid.\n        - Action: Proceed with the solution.\n\n        My derivation of the solution confirms that Option A is a complete and correct description. I will write down the derivation formally.\n        The analysis of options B, C, and D showed they are incorrect for clear reasons:\n        B: Rankine-Hugoniot conditions are inconsistent for a shock into a vacuum.\n        C: A contact discontinuity would require $u$ and $h$ to be continuous, which doesn't fit the problem.\n        D: Describes a numerical regularization, not the analytical solution, and gives an incorrect shoreline speed.\n\n        Therefore, my final answer will be A.\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Governing equations: The one-dimensional depth-averaged shallow water equations are given in conservative form:\n$$\n\\partial_t h + \\partial_x (h u) = 0\n$$\n$$\n\\partial_t (h u) + \\partial_x \\left(h u^2 + \\tfrac{1}{2} g h^2\\right) = 0\n$$\nwhere $h(x,t)$ is the water depth, $u(x,t)$ is the depth-averaged velocity, and $g$ is the gravitational acceleration.\n- Hyperbolic Structure: The system is strictly hyperbolic for $h0$ with characteristic speeds $\\lambda = u \\pm c$, where $c = \\sqrt{g h}$.\n- Initial Data (Dry-Bed Riemann Problem):\n$$\n(h,u)(x,0) = \\begin{cases}\n(h_L,u_L),  x0, \\\\\n(0,0),  x0,\n\\end{cases}\n$$\nwith the condition $h_L0$.\n- Constraints: The solution must be derived using only the governing equations and their hyperbolic structure, without additional closures or ad hoc regularization.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the shallow water equations, a well-established and fundamental model in fluid dynamics and physical oceanography. The \"dam-break problem over a dry bed\" is a classical, canonical problem in the study of hyperbolic conservation laws. The physics and mathematics are sound.\n- **Well-Posed:** The problem of finding a physically relevant weak solution to this Riemann problem is well-posed. A unique entropy solution exists and can be constructed using the method of characteristics and Riemann invariants.\n- **Objective:** The problem is stated using precise mathematical language and definitions. It is entirely free of subjective or ambiguous terminology.\n\nAll other validation criteria are met. The problem is a standard, valid exercise in the theory of hyperbolic partial differential equations applied to fluid dynamics.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. The solution will be derived and the options evaluated.\n\n### Principle-Based Derivation\n\nThe problem is a Riemann problem for the shallow water equations with a left state $(h_L, u_L)$ and a right state $(h_R, u_R) = (0, 0)$. The latter is a \"vacuum\" state where the depth $h$ is zero, causing the characteristic speeds to degenerate ($c_R = \\sqrt{g h_R} = 0$). The solution is self-similar and depends only on the variable $\\xi = x/t$.\n\nFor a self-similar solution $W(\\xi) = (h(\\xi), u(\\xi))^T$, the partial differential equations reduce to a system of ordinary differential equations: $(A - \\xi I) W' = 0$, where $A$ is the system's Jacobian matrix in primitive variables. A non-trivial solution ($W' \\neq 0$) exists only if $\\xi$ is an eigenvalue of $A$, i.e., $\\xi$ is a characteristic speed. This type of solution is a simple wave, or rarefaction wave.\n\nA shock wave connecting to the vacuum state $(h_R=0, u_R=0)$ is not admissible. The Rankine-Hugoniot jump conditions for a shock with speed $S$ connecting a state $(h_*, u_*)$ to $(h_R, u_R)=(0,0)$ would be:\n$$S(h_* - 0) = h_* u_* - 0 \\implies S = u_*$$\n$$S(h_* u_* - 0) = \\left(h_* u_*^2 + \\frac{1}{2}gh_*^2\\right) - 0$$\nSubstituting $S=u_*: u_*(h_* u_*) = h_* u_*^2 + \\frac{1}{2}gh_*^2$, which simplifies to $\\frac{1}{2}gh_*^2 = 0$. This implies $h_*=0$, a trivial case. Thus, a shock cannot form at the boundary with the dry bed.\n\nThe solution must therefore be a rarefaction wave. To wet the dry area at $x0$, the water must flow to the right. This implies that the solution is a single, centered rarefaction fan that connects the left state $(h_L, u_L)$ to a rightmost vacuum state where $h=0$. Such a wave is described by one family of characteristics. To determine which family, we find that a rightward-propagating solution into the dry bed corresponds to a simple wave of the \"left-going\" or \"slow\" characteristic family, $\\lambda_- = u-c$. For such a wave:\n1.  The self-similar coordinate is identified with the characteristic speed: $\\xi = u - c = u - \\sqrt{gh}$.\n2.  The Riemann invariant corresponding to the other family, $R_+ = u+2c$, is constant throughout the rarefaction fan.\n\nThe rarefaction wave connects to the state $(h_L, u_L)$ on its left side. Therefore, the constant value of the Riemann invariant is determined by this state:\n$u + 2\\sqrt{gh} = u_L + 2\\sqrt{gh_L}$.\n\nWe now have a system of two algebraic equations for $u(\\xi)$ and $h(\\xi)$ (or $c(\\xi)$):\n1.  $u + 2c = u_L + 2c_L$\n2.  $\\xi = u - c$\n\nwhere $c = \\sqrt{gh}$ and $c_L = \\sqrt{gh_L}$.\nFrom (2), we express $u$ as $u = \\xi + c$. Substituting this into (1):\n$(\\xi + c) + 2c = u_L + 2c_L \\implies \\xi + 3c = u_L + 2c_L$.\nSolving for $c(\\xi)$:\n$c(\\xi) = \\frac{1}{3}(u_L + 2c_L - \\xi) = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} - \\xi)$.\nSince $h = c^2/g$, the depth profile within the rarefaction fan is:\n$$h(\\xi) = \\frac{1}{9g}(u_L + 2\\sqrt{gh_L} - \\xi)^2$$\nThe velocity profile is found by substituting $c(\\xi)$ back into $u = \\xi + c$:\n$u(\\xi) = \\xi + \\frac{1}{3}(u_L + 2\\sqrt{gh_L} - \\xi) = \\frac{1}{3}(3\\xi + u_L + 2\\sqrt{gh_L} - \\xi) = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} + 2\\xi)$.\n\nThe rarefaction fan has a left edge and a right edge.\n-   The left edge, $\\xi_\\text{left}$, is the characteristic originating from the undisturbed state $(h_L, u_L)$. Its speed is:\n    $\\xi_\\text{left} = u_L - c_L = u_L - \\sqrt{gh_L}$.\n-   The right edge of the fan represents the moving shoreline, or wetting front, where the water depth becomes zero. Let its speed be $\\xi_\\text{shore}$. At this front, $h(\\xi_\\text{shore}) = 0$, which implies $c(\\xi_\\text{shore}) = 0$. Using the expression for $c(\\xi)$:\n    $0 = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} - \\xi_\\text{shore}) \\implies \\xi_\\text{shore} = u_L + 2\\sqrt{gh_L}$.\n\n-   We must also determine the fluid velocity at the shoreline. Substituting $\\xi = \\xi_\\text{shore}$ into the expression for $u(\\xi)$:\n    $u(\\xi_\\text{shore}) = \\frac{1}{3}(u_L + 2\\sqrt{gh_L} + 2(u_L + 2\\sqrt{gh_L})) = \\frac{1}{3}(3u_L + 6\\sqrt{gh_L}) = u_L + 2\\sqrt{gh_L}$.\n    Thus, at the shoreline, $u(\\xi_\\text{shore}) = \\xi_\\text{shore}$. This is a crucial result: the velocity of the fluid particles at the very front of the wave is equal to the propagation speed of the front itself. The state at the moving shoreline is $(h \\to 0, u \\to \\xi_\\text{shore})$.\n\nFinally, within the rarefaction fan, we have $u = \\xi+c$ and $u+2c = u_L+2c_L$. From the second equation, $u  u_L+2c_L$. From the first, $u  c$. Combining these, $c  u  u_L+2c_L$. Also, from $u=\\xi+c$ and $c(\\xi)$ we can find $u = 2c+u_L-2c_L$. The local Froude number is $Fr = u/c$. If we take $u_L=0$ (dam-break), then $u=2c-2c_L$. This is not quite right.\nAh, the relation $u=2c$ is simpler. $u+2c=u_L+2c_L$ and $\\xi=u-c$.\nNo, the relation $u=2c$ is only valid if the rarefaction connects to a state $(h,u)=(0,0)$, which requires $u-2c=0$. In our case, the rarefaction starts from $(h_L, u_L)$, so it is the $u+2c$ invariant which is constant. The flow inside the fan is not necessarily $Fr=2$. However, the flow is indeed supercritical.\n\nThe solution is a single centered rarefaction wave of the left-going family ($\\lambda_-$) which propagates from $\\xi_\\text{left} = u_L - \\sqrt{gh_L}$ to $\\xi_\\text{shore} = u_L + 2\\sqrt{gh_L}$.\n\n### Option-by-Option Analysis\n\n**A. A single centered rarefaction connects $(h_L,u_L)$ to a vacuum state ($h=0$), belonging to the left-going family with self-similar coordinate $\\xi = x/t = u - c$. The left edge of the fan moves at $\\xi_\\text{left} = u_L - \\sqrt{g h_L}$, and the right edge is a moving shoreline at $\\xi_\\text{shore} = u_L + 2 \\sqrt{g h_L}$ where $h \\to 0$ and $u \\to \\xi_\\text{shore}$. No shock is admissible because characteristics diverge, and the wetting front advances supercritically, flooding the dry bed while maintaining $h \\ge 0$.**\n-   **Wave Structure:** Correctly identifies the solution as a single centered rarefaction.\n-   **Wave Family:** Correctly identifies it as belonging to the left-going family ($\\lambda_- = u-c$), for which $\\xi = u-c$ in a simple wave.\n-   **Fan Edges:** Correctly states the speeds of the left edge ($\\xi_\\text{left} = u_L - \\sqrt{gh_L}$) and the right edge/shoreline ($\\xi_\\text{shore} = u_L + 2\\sqrt{gh_L}$).\n-   **Shoreline State:** Correctly states that at the shoreline, $h \\to 0$ and the fluid velocity $u$ approaches the shoreline speed $\\xi_\\text{shore}$.\n-   **Physical Interpretation:** Correctly states that a shock is inadmissible and that the rarefaction (expansion) involves diverging characteristics. The comment on supercritical advance and non-negativity of $h$ is also physically correct.\n**Verdict:** Correct.\n\n**B. A compressive shock forms and propagates into the dry bed with speed $\\xi_\\text{shock} = \\sqrt{g h_L}$ determined by the Rankine–Hugoniot conditions, because the loss of pressure support at $h_R=0$ requires a discontinuity. The shoreline coincides with the shock, and a rarefaction is not admissible.**\n-   As derived above, the Rankine-Hugoniot conditions are inconsistent for a shock propagating into a vacuum state ($h_R=0$). This option is fundamentally incorrect. The speed $\\sqrt{g h_L}$ does not follow from the jump conditions.\n**Verdict:** Incorrect.\n\n**C. A contact discontinuity carries the shoreline at speed $\\xi_\\text{shore} = \\sqrt{g h_L}$, leaving a uniform state $(h,u)=(h_L,0)$ behind it. The hyperbolic structure forbids rarefaction into a vacuum, so the dry bed can only be wetted by advection without drawdown.**\n-   A contact discontinuity requires continuity of velocity and pressure (depth) across it. This is not the case here. The statement that the hyperbolic structure forbids rarefaction into a vacuum is false; in fact, it is the only admissible solution. The speed $\\sqrt{g h_L}$ is arbitrary in this context.\n**Verdict:** Incorrect.\n\n**D. A rarefaction connects $(h_L,u_L)$ to a small but nonzero depth on the right, and the shoreline speed is $\\xi_\\text{shore} = u_L + \\sqrt{g h_L}$. A shock attaches to the shoreline when $u_L=0$, reflecting the degeneracy at $h_R=0$.**\n-   This describes an artificial modification of the problem (a \"thin film\" approximation), often used in numerical schemes to avoid the $h=0$ degeneracy. The problem explicitly forbids \"ad hoc regularization\". Furthermore, the stated shoreline speed $\\xi_\\text{shore} = u_L + \\sqrt{g h_L}$ is incorrect; the analytical solution gives $u_L + 2\\sqrt{g h_L}$. The claim that a shock attaches when $u_L=0$ is also false for the analytical solution.\n**Verdict:** Incorrect.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Discretizing the shallow water equations using methods like the finite-volume approach can lead to non-physical results, such as negative water depths, particularly when simulating thin water layers near the moving shoreline. This exercise presents a concrete counterexample to demonstrate this common numerical failure . You will then derive, from first principles, a positivity-preserving flux limiter, a fundamental technique used to ensure the robustness and physical realism of wetting–drying algorithms.",
            "id": "3819236",
            "problem": "Consider the one-dimensional Shallow Water Equations (SWE) for depth $h(x,t)$ and discharge $q(x,t) = h(x,t) u(x,t)$, where $u(x,t)$ is the depth-averaged velocity. The mass conservation law is given by $h_{t} + q_{x} = 0$. In a finite-volume discretization on a uniform grid with cell width $\\Delta x$, the cell-averaged depth $h_{i}^{n}$ in cell $i$ at time level $n$ is updated explicitly using intercell fluxes $F_{i-1/2}^{n}$ and $F_{i+1/2}^{n}$ according to\n$$\nh_{i}^{n+1} = h_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right),\n$$\nwhere $F_{j+1/2}^{n}$ approximates $q(x_{j+1/2}, t^{n})$ produced by a Riemann solver. In wetting–drying algorithms for intertidal zones, a positivity-preserving mechanism is typically required to prevent $h_{i}^{n+1}  0$ when the cell is nearly dry.\n\nConstruct a counterexample demonstrating that a lack of positivity control leads to a negative depth and numerical blow-up, and then compute the minimal limiter intervention required to prevent failure. Use the following scientifically realistic setup for an intertidal transect:\n\n- Cell width $\\Delta x = 20$ m and time step $\\Delta t = 6$ s, consistent with the Courant–Friedrichs–Lewy (CFL) stability restriction for characteristic speeds of order a few m/s.\n- Cell-averaged depth at time $n$ is $h_{i}^{n} = 0.02$ m (a thin water film over intertidal bed).\n- Interfacial mass fluxes at time $n$ are $F_{i+1/2}^{n} = 0.12$ m$^2$/s and $F_{i-1/2}^{n} = -0.08$ m$^2$/s, corresponding to outflow to the right at the right face and outflow to the left at the left face (both faces simultaneously draining the nearly dry cell).\n\nTasks:\n\n1. Starting from the mass conservation law and the finite-volume update above, evaluate $h_{i}^{n+1}$ without any positivity limiter and demonstrate that it is negative.\n2. Define a positivity-preserving flux limiter that scales only the outward mass fluxes leaving the cell by a single coefficient $\\theta \\in [0,1]$, leaving any incoming fluxes unchanged. Derive, from first principles and the discrete update, the minimal $\\theta$ that renders $h_{i}^{n+1} = 0$ in this step (this is the smallest intervention that prevents failure).\n3. Compute the numerical value of this minimal limiter coefficient for the given data. Express the final answer as a pure number (dimensionless). If you choose to approximate, round your answer to four significant figures.\n\nYour final answer must be the single value of the minimal limiter coefficient $\\theta$ that prevents $h_{i}^{n+1}$ from becoming negative under the given conditions.",
            "solution": "The problem requires an analysis of a finite-volume numerical scheme for the shallow water equations, specifically focusing on the positivity-preserving property essential for wetting-drying simulations. We are given the discrete mass conservation law and a set of parameters that lead to a non-physical negative depth. We must demonstrate this failure, then derive and compute a flux limiter correction.\n\nThe governing finite-volume update for the cell-averaged depth $h_{i}^{n}$ is given by:\n$$\nh_{i}^{n+1} = h_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right)\n$$\nThe provided parameters are:\n- Cell-averaged depth at time $n$: $h_{i}^{n} = 0.02$ m\n- Cell width: $\\Delta x = 20$ m\n- Time step: $\\Delta t = 6$ s\n- Flux at the right cell face $(i+1/2)$: $F_{i+1/2}^{n} = 0.12$ m$^2$/s\n- Flux at the left cell face $(i-1/2)$: $F_{i-1/2}^{n} = -0.08$ m$^2$/s\n\nThe sign convention for fluxes in a finite-volume framework is that a positive flux at the right face ($i+1/2$) of cell $i$ represents an outflow, and a negative flux at the left face ($i-1/2$) also represents an outflow. In this case, $F_{i+1/2}^{n}  0$ and $F_{i-1/2}^{n}  0$, which means that water is flowing out of cell $i$ through both faces.\n\n**Task 1: Demonstrate Negative Depth without Limiter**\n\nWe compute the updated depth $h_{i}^{n+1}$ using the given formula and parameters without any modifications.\n$$\nh_{i}^{n+1} = h_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right)\n$$\nSubstituting the numerical values:\n$$\nh_{i}^{n+1} = 0.02 - \\frac{6}{20} \\left(0.12 - (-0.08)\\right)\n$$\n$$\nh_{i}^{n+1} = 0.02 - 0.3 \\left(0.12 + 0.08\\right)\n$$\n$$\nh_{i}^{n+1} = 0.02 - 0.3 \\left(0.20\\right)\n$$\n$$\nh_{i}^{n+1} = 0.02 - 0.06\n$$\n$$\nh_{i}^{n+1} = -0.04\\ \\mathrm{m}\n$$\nThe result is a negative depth, which is physically meaningless and indicates a failure of the numerical scheme. This necessitates a positivity-preserving correction.\n\n**Task 2: Derive the Minimal Flux Limiter Coefficient**\n\nA positivity-preserving limiter is introduced to prevent the depth from becoming negative. The limiter is defined to scale only the outward fluxes by a coefficient $\\theta \\in [0, 1]$, leaving inward fluxes unchanged.\n\nLet us decompose the net flux into total incoming and outgoing volumetric flux rates. The total volumetric flux rate out of cell $i$, denoted $Q_{out}$, is the sum of outflows through both faces:\n$$\nQ_{out} = \\max(0, F_{i+1/2}^{n}) - \\min(0, F_{i-1/2}^{n})\n$$\nThe total volumetric flux rate into cell $i$, denoted $Q_{in}$, is:\n$$\nQ_{in} = \\max(0, F_{i-1/2}^{n}) - \\min(0, F_{i+1/2}^{n})\n$$\nThe finite-volume update equation can be rewritten in terms of total water volume $V_i = h_i \\Delta x$:\n$$\nV_{i}^{n+1} = V_{i}^{n} + \\Delta t (Q_{in} - Q_{out})\n$$\nDividing by $\\Delta x$:\n$$\nh_{i}^{n+1} = h_{i}^{n} + \\frac{\\Delta t}{\\Delta x} (Q_{in} - Q_{out})\n$$\nThe limiter scales the total outflow $Q_{out}$ by $\\theta$:\n$$\nh_{i, \\text{limited}}^{n+1} = h_{i}^{n} + \\frac{\\Delta t}{\\Delta x} (Q_{in} - \\theta Q_{out})\n$$\nThe problem asks for the minimal $\\theta$ that ensures $h_{i, \\text{limited}}^{n+1} = 0$. This represents the smallest intervention (i.e., the largest $\\theta \\leq 1$) that prevents positivity violation. We set $h_{i, \\text{limited}}^{n+1} = 0$ and solve for $\\theta$:\n$$\n0 = h_{i}^{n} + \\frac{\\Delta t}{\\Delta x} Q_{in} - \\theta \\frac{\\Delta t}{\\Delta x} Q_{out}\n$$\nRearranging to solve for $\\theta$:\n$$\n\\theta \\frac{\\Delta t}{\\Delta x} Q_{out} = h_{i}^{n} + \\frac{\\Delta t}{\\Delta x} Q_{in}\n$$\nAssuming $Q_{out} \\neq 0$ (which is true in this problem, as the uncorrected depth becomes negative), we find:\n$$\n\\theta = \\frac{h_{i}^{n} + \\frac{\\Delta t}{\\Delta x} Q_{in}}{\\frac{\\Delta t}{\\Delta x} Q_{out}} = \\frac{h_{i}^{n} \\frac{\\Delta x}{\\Delta t} + Q_{in}}{Q_{out}}\n$$\nThis is the general expression for the required limiter coefficient.\n\n**Task 3: Compute the Numerical Value of $\\theta$**\n\nWe now apply this formula to the given data. First, we calculate $Q_{in}$ and $Q_{out}$:\n$$\nF_{i+1/2}^{n} = 0.12  0 \\quad (\\text{outflow})\n$$\n$$\nF_{i-1/2}^{n} = -0.08  0 \\quad (\\text{outflow})\n$$\nTherefore, there is no inflow into the cell:\n$$\nQ_{in} = \\max(0, -0.08) - \\min(0, 0.12) = 0 - 0 = 0\\ \\mathrm{m}^{2}/\\mathrm{s}\n$$\nThe total outflow is:\n$$\nQ_{out} = \\max(0, 0.12) - \\min(0, -0.08) = 0.12 - (-0.08) = 0.20\\ \\mathrm{m}^{2}/\\mathrm{s}\n$$\nWith $Q_{in} = 0$, the formula for $\\theta$ simplifies to:\n$$\n\\theta = \\frac{h_{i}^{n} \\frac{\\Delta x}{\\Delta t}}{Q_{out}}\n$$\nThis equation has a clear physical interpretation: the total allowed outgoing volume, $\\theta Q_{out} \\Delta t$, must be equal to the initial volume present in the cell, $h_{i}^{n} \\Delta x$.\n\nSubstituting the numerical values:\n$$\n\\theta = \\frac{0.02 \\cdot \\frac{20}{6}}{0.20} = \\frac{0.02 \\cdot 20}{0.20 \\cdot 6} = \\frac{0.4}{1.2} = \\frac{4}{12}\n$$\n$$\n\\theta = \\frac{1}{3}\n$$\nThe minimal limiter coefficient required to prevent the depth from becoming negative (by setting it exactly to zero) is $\\frac{1}{3}$. This value is within the required range $\\theta \\in [0, 1]$.",
            "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$"
        },
        {
            "introduction": "Practical wetting-drying algorithms often rely on parameters, such as a minimum depth threshold $h_{\\min}$, to ensure numerical stability. The choice of such a parameter is not arbitrary; it can influence the model's physical predictions and introduce a form of numerical uncertainty. In this computational exercise , you will develop a program to systematically investigate this effect by quantifying the sensitivity of the tidally-averaged inundated area to different values of $h_{\\min}$ across several realistic coastal topographies.",
            "id": "3819187",
            "problem": "You are tasked with designing and implementing a program that evaluates the sensitivity of inundation extent to the choice of minimum active water depth in wetting–drying algorithms for intertidal zones. The physical basis is hydrostatic free-surface flow as described by the Shallow Water Equations (SWE), and the minimum active water depth threshold is used to stabilize numerical schemes in the presence of thin films. The problem must be formulated and solved purely as a geometric measure under a prescribed free-surface elevation variation over a known bathymetry, without invoking momentum or mass conservation updates.\n\nFundamental base:\n- Consider a bathymetry with bed elevation $z_b(x,y)$ measured relative to a vertical datum, with positive values upward.\n- Consider a free-surface elevation prescribed by a sinusoidal tide $\\eta(t)=A\\sin(\\omega t)$ with angular frequency $\\omega$ in radians per second and amplitude $A$ in meters.\n- The instantaneous water depth is $h(x,y,t)=\\eta(t)-z_b(x,y)$.\n- A standard wetting–drying algorithm classifies a cell as wet if $h(x,y,t)\\ge h_{\\min}$, where $h_{\\min}0$ is the minimum active water depth threshold used to avoid numerical issues with vanishingly thin water layers.\n\nDefinition of wet area and sensitivity metric:\n- The instantaneous wet area is\n$$\nA_{\\text{wet}}(t;h_{\\min})=\\iint_{\\Omega} \\mathbf{1}\\!\\left(\\eta(t)-z_b(x,y)\\ge h_{\\min}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y,\n$$\nwhere $\\Omega$ is the horizontal computational domain and $\\mathbf{1}(\\cdot)$ is the indicator function returning $1$ for true and $0$ otherwise.\n- The cycle-mean wet area over one tidal period $T=\\frac{2\\pi}{\\omega}$ is\n$$\n\\overline{A}(h_{\\min})=\\frac{1}{T}\\int_0^T A_{\\text{wet}}(t;h_{\\min})\\,\\mathrm{d}t.\n$$\n- The sensitivity of inundation extent to the choice of $h_{\\min}$ is quantified by\n$$\n\\Delta A=\\overline{A}(h_{\\min,2})-\\overline{A}(h_{\\min,1}),\n$$\nfor two thresholds $h_{\\min,1}$ and $h_{\\min,2}$, both in meters.\n\nNumerical approximation requirements:\n- Discretize $\\Omega$ with a uniform rectilinear grid of spacing $\\Delta x$ and $\\Delta y$ (in meters). Approximate the integral for $A_{\\text{wet}}(t;h_{\\min})$ by summing $\\Delta x\\,\\Delta y$ over all cells satisfying the wet mask.\n- Approximate the cycle mean $\\overline{A}(h_{\\min})$ by uniform-in-time sampling over one period. Use $N_t$ equally spaced samples over $[0,T)$, and the discrete mean\n$$\n\\overline{A}(h_{\\min})\\approx\\frac{1}{N_t}\\sum_{n=0}^{N_t-1} A_{\\text{wet}}(t_n;h_{\\min}),\\quad t_n=\\frac{n}{N_t}T.\n$$\n\nUnits and output specification:\n- All lengths are in meters. Time is in seconds. Angular frequency $\\omega$ is in radians per second. Areas must be reported in square meters (m$^2$).\n- Express each computed $\\Delta A$ in m$^2$, rounded to one decimal place.\n\nTest suite:\nImplement the calculation for the following four test cases. For each case, construct the grid, evaluate $z_b(x,y)$ at cell centers, evaluate $\\eta(t)$ across one period, and compute $\\Delta A$. Unless otherwise stated, the angular frequency $\\omega$ must be used in radians per second, the number of time samples $N_t$ must be $180$, and the cycle period must be $T=\\frac{2\\pi}{\\omega}$.\n\n- Case 1 (linear sloping beach):\n    - Domain: $L_x=4000$ m, $L_y=1000$ m; grid spacings $\\Delta x=20$ m, $\\Delta y=20$ m.\n    - Bathymetry: $z_b(x,y)=z_0+s\\,x$ with $z_0=-1.0$ m and slope $s=0.002$ (dimensionless).\n    - Tide: $A=1.5$ m, $\\omega=\\frac{2\\pi}{43200}$ rad/s.\n    - Thresholds: $h_{\\min,1}=0.02$ m, $h_{\\min,2}=0.20$ m.\n    - Time sampling: $N_t=180$.\n\n- Case 2 (terraced tidal flat with a deeper patch):\n    - Domain: $L_x=3000$ m, $L_y=1500$ m; grid spacings $\\Delta x=20$ m, $\\Delta y=20$ m.\n    - Base bathymetry: $z_b^{\\text{base}}(x,y)=z_0+s\\,x$ with $z_0=-0.5$ m and $s=0.0015$.\n    - Patch: For $x\\in[600,1400]$ m and $y\\in[400,1100]$ m, add a depression of $d=-0.4$ m, i.e., $z_b(x,y)=z_b^{\\text{base}}(x,y)+d$ in the patch and $z_b(x,y)=z_b^{\\text{base}}(x,y)$ elsewhere.\n    - Tide: $A=1.2$ m, $\\omega=\\frac{2\\pi}{45000}$ rad/s.\n    - Thresholds: $h_{\\min,1}=0.05$ m, $h_{\\min,2}=0.30$ m.\n    - Time sampling: $N_t=180$.\n\n- Case 3 (sloping shelf with a Gaussian sand bar):\n    - Domain: $L_x=2000$ m, $L_y=2000$ m; grid spacings $\\Delta x=25$ m, $\\Delta y=25$ m.\n    - Bathymetry: $z_b(x,y)=z_0+s\\,x+H\\exp\\left(-\\frac{(x-x_c)^2}{2\\sigma_x^2}-\\frac{(y-y_c)^2}{2\\sigma_y^2}\\right)$ with parameters $z_0=-0.2$ m, $s=0.001$, $H=1.0$ m, $x_c=1200$ m, $y_c=1000$ m, $\\sigma_x=300$ m, $\\sigma_y=500$ m.\n    - Tide: $A=0.8$ m, $\\omega=\\frac{2\\pi}{43200}$ rad/s.\n    - Thresholds: $h_{\\min,1}=0.10$ m, $h_{\\min,2}=0.25$ m.\n    - Time sampling: $N_t=180$.\n\n- Case 4 (small-amplitude tide on a steeper beach):\n    - Domain: $L_x=1000$ m, $L_y=500$ m; grid spacings $\\Delta x=10$ m, $\\Delta y=10$ m.\n    - Bathymetry: $z_b(x,y)=z_0+s\\,x$ with $z_0=-0.1$ m and $s=0.002$.\n    - Tide: $A=0.04$ m, $\\omega=\\frac{2\\pi}{43200}$ rad/s.\n    - Thresholds: $h_{\\min,1}=0.05$ m, $h_{\\min,2}=0.10$ m.\n    - Time sampling: $N_t=180$.\n\nFinal output format:\n- Your program should produce a single line of output containing the cycle-mean $\\Delta A$ values for the four cases as a comma-separated list enclosed in square brackets, with each value rounded to one decimal place in m$^2$ (e.g., `[1234.5,678.9,10.0,0.0]`).",
            "solution": "The goal is to compute the sensitivity of inundation extent to the minimum active water depth threshold in a wetting–drying algorithm, using a prescribed hydrostatic tide over known bathymetry. The derivation proceeds from definitions grounded in hydrostatics and geometric measure.\n\n1. Hydrostatic relation and water depth definition. The Shallow Water Equations (SWE) under hydrostatic approximation define the water depth as $h(x,y,t)=\\eta(t)-z_b(x,y)$, where $\\eta(t)$ is the free-surface elevation above a datum and $z_b(x,y)$ is the bed elevation above the same datum. No momentum terms are needed because the problem reduces to classification by depth and area measure.\n\n2. Wetting–drying classification via a minimum depth threshold. Numerical algorithms for wetting–drying impose a minimum active water depth $h_{\\min}0$ to avoid pathological behavior in extremely shallow cells. The classification rule is the indicator function\n$$\n\\mathbf{1}\\!\\left(h(x,y,t)\\ge h_{\\min}\\right)=\\begin{cases}\n1  \\text{if } \\eta(t)-z_b(x,y)\\ge h_{\\min},\\\\\n0  \\text{otherwise.}\n\\end{cases}\n$$\nThis rule is purely geometric and time-dependent through $\\eta(t)$.\n\n3. Instantaneous wet area integral. The instantaneous wet area is the integral over the horizontal domain $\\Omega$,\n$$\nA_{\\text{wet}}(t;h_{\\min})=\\iint_{\\Omega}\\mathbf{1}\\!\\left(\\eta(t)-z_b(x,y)\\ge h_{\\min}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nThis integral evaluates the area of the set $\\{(x,y)\\in\\Omega:\\eta(t)-z_b(x,y)\\ge h_{\\min}\\}$.\n\n4. Cycle-mean wet area. To avoid arbitrary time selection and capture the tidal modulation, average $A_{\\text{wet}}(t;h_{\\min})$ over one tidal cycle of period $T=\\frac{2\\pi}{\\omega}$,\n$$\n\\overline{A}(h_{\\min})=\\frac{1}{T}\\int_0^T A_{\\text{wet}}(t;h_{\\min})\\,\\mathrm{d}t.\n$$\nUsing the given sinusoid $\\eta(t)=A\\sin(\\omega t)$, the only time dependence enters through the scalar $\\eta(t)$.\n\n5. Sensitivity metric. The change in cycle-mean wet area between two thresholds $h_{\\min,1}$ and $h_{\\min,2}$ is\n$$\n\\Delta A=\\overline{A}(h_{\\min,2})-\\overline{A}(h_{\\min,1}).\n$$\nThis quantifies how increasing the minimum active depth reduces the considered inundated set.\n\n6. Discrete approximation on a uniform grid. Approximate the spatial integral with a uniform grid of spacings $\\Delta x$ and $\\Delta y$, placing bathymetry at cell centers. At any fixed time $t$, the discrete approximation is\n$$\nA_{\\text{wet}}(t;h_{\\min})\\approx \\Delta x\\,\\Delta y\\sum_{i=1}^{N_x}\\sum_{j=1}^{N_y}\\mathbf{1}\\!\\left(\\eta(t)-z_b(x_i,y_j)\\ge h_{\\min}\\right),\n$$\nwhere $(x_i,y_j)$ are the centers of the grid cells and $N_x,N_y$ are the number of cells in the $x$ and $y$ directions. The cycle mean is approximated by a uniform Riemann sum in time,\n$$\n\\overline{A}(h_{\\min})\\approx \\frac{1}{N_t}\\sum_{n=0}^{N_t-1}A_{\\text{wet}}(t_n;h_{\\min}),\\quad t_n=\\frac{n}{N_t}T=\\frac{2\\pi n}{\\omega N_t}.\n$$\n\n7. Algorithmic steps.\n- Construct the grid coordinates as $x_i=i\\,\\Delta x$ for $i=0,1,\\dots,N_x$ and $y_j=j\\,\\Delta y$ for $j=0,1,\\dots,N_y$. Use cell centers, so coordinates are offset by $\\frac{1}{2}\\Delta x$ and $\\frac{1}{2}\\Delta y$ to avoid boundary ambiguity.\n- Evaluate $z_b(x_i,y_j)$ for all cells according to the specified bathymetry functions:\n  - Linear slope: $z_b(x,y)=z_0+s\\,x$.\n  - Terraced flat with patch: $z_b^{\\text{base}}(x,y)=z_0+s\\,x$ and $z_b(x,y)=z_b^{\\text{base}}(x,y)+d$ within the specified rectangular patch; elsewhere $z_b(x,y)=z_b^{\\text{base}}(x,y)$.\n  - Gaussian bar: $z_b(x,y)=z_0+s\\,x+H\\exp\\left(-\\frac{(x-x_c)^2}{2\\sigma_x^2}-\\frac{(y-y_c)^2}{2\\sigma_y^2}\\right)$.\n- Generate $N_t$ equally spaced times $t_n$ over $[0,T)$, where $T=\\frac{2\\pi}{\\omega}$.\n- For each $t_n$, compute $\\eta(t_n)=A\\sin(\\omega t_n)$.\n- For each $h_{\\min}$ value, compute the boolean mask $\\eta(t_n)-z_b\\ge h_{\\min}$ and accumulate $A_{\\text{wet}}(t_n;h_{\\min})$ by counting true entries and multiplying by $\\Delta x\\,\\Delta y$.\n- Average over $n$ to obtain $\\overline{A}(h_{\\min})$, then compute $\\Delta A$ for the two thresholds.\n\n8. Edge cases and numerical considerations.\n- If $\\eta(t)-z_bh_{\\min}$ everywhere, the wet area is zero; this is handled naturally by the indicator function.\n- If the bathymetry has regions permanently submerged (e.g., $z_b$ sufficiently negative), these regions contribute for all $t$ provided $\\eta(t)-z_b\\ge h_{\\min}$; the algorithm still applies.\n- The choice of $N_t=180$ provides a uniform sampling resolution of $2^\\circ$ in phase over the cycle ($\\frac{2\\pi}{180}$ radians), which is adequate for smooth sinusoidal variation.\n\n9. Output and units. The final results are $\\Delta A$ in m$^2$, rounded to one decimal place. The program outputs the four $\\Delta A$ values as a comma-separated list enclosed in square brackets, in the order of the test cases.\n\nThis approach satisfies the principle-based design by beginning from hydrostatic water depth, defining wetted area through geometric measure, and deriving a discrete algorithm aligned with the foundational definitions. No shortcut formulas beyond the indicator-based integration are introduced, and all parameters are specified with physically realistic values and units.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_grid(Lx, Ly, dx, dy):\n    # Cell-centered coordinates\n    x = np.arange(dx/2, Lx, dx)\n    y = np.arange(dy/2, Ly, dy)\n    X, Y = np.meshgrid(x, y, indexing='xy')\n    return X, Y\n\ndef bathymetry_linear(X, Y, z0, s):\n    return z0 + s * X\n\ndef bathymetry_terrace_with_patch(X, Y, z0, s, x_patch, y_patch, d):\n    zb = z0 + s * X\n    # Apply depression d within rectangular patch\n    mask = (X = x_patch[0])  (X = x_patch[1])  (Y = y_patch[0])  (Y = y_patch[1])\n    zb = zb.copy()\n    zb[mask] = zb[mask] + d\n    return zb\n\ndef bathymetry_gaussian_bar(X, Y, z0, s, H, xc, yc, sigx, sigy):\n    gauss = np.exp(-((X - xc)**2)/(2.0*sigx**2) - ((Y - yc)**2)/(2.0*sigy**2))\n    zb = z0 + s * X + H * gauss\n    return zb\n\ndef cycle_mean_wet_area(zb, dx, dy, A, omega, Nt, hmin):\n    # One period T = 2*pi/omega; sample Nt times uniformly over [0, T)\n    T = 2.0 * np.pi / omega\n    t = np.linspace(0.0, T, Nt, endpoint=False)\n    eta = A * np.sin(omega * t)\n    cell_area = dx * dy\n    # Loop over times, compute wet area\n    areas = np.empty(Nt, dtype=np.float64)\n    for k in range(Nt):\n        # Broadcast eta[k] over grid\n        h = eta[k] - zb\n        wet_mask = h = hmin\n        areas[k] = cell_area * np.count_nonzero(wet_mask)\n    return areas.mean()\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: linear sloping beach\n        {\n            \"domain\": {\"Lx\": 4000.0, \"Ly\": 1000.0, \"dx\": 20.0, \"dy\": 20.0},\n            \"bathymetry\": {\"type\": \"linear\", \"z0\": -1.0, \"s\": 0.002},\n            \"tide\": {\"A\": 1.5, \"omega\": 2.0 * np.pi / 43200.0},\n            \"thresholds\": {\"hmin1\": 0.02, \"hmin2\": 0.20},\n            \"Nt\": 180,\n        },\n        # Case 2: terraced tidal flat with a deeper patch\n        {\n            \"domain\": {\"Lx\": 3000.0, \"Ly\": 1500.0, \"dx\": 20.0, \"dy\": 20.0},\n            \"bathymetry\": {\n                \"type\": \"terrace_patch\",\n                \"z0\": -0.5,\n                \"s\": 0.0015,\n                \"x_patch\": (600.0, 1400.0),\n                \"y_patch\": (400.0, 1100.0),\n                \"d\": -0.4,\n            },\n            \"tide\": {\"A\": 1.2, \"omega\": 2.0 * np.pi / 45000.0},\n            \"thresholds\": {\"hmin1\": 0.05, \"hmin2\": 0.30},\n            \"Nt\": 180,\n        },\n        # Case 3: sloping shelf with a Gaussian sand bar\n        {\n            \"domain\": {\"Lx\": 2000.0, \"Ly\": 2000.0, \"dx\": 25.0, \"dy\": 25.0},\n            \"bathymetry\": {\n                \"type\": \"gaussian_bar\",\n                \"z0\": -0.2,\n                \"s\": 0.001,\n                \"H\": 1.0,\n                \"xc\": 1200.0,\n                \"yc\": 1000.0,\n                \"sigx\": 300.0,\n                \"sigy\": 500.0,\n            },\n            \"tide\": {\"A\": 0.8, \"omega\": 2.0 * np.pi / 43200.0},\n            \"thresholds\": {\"hmin1\": 0.10, \"hmin2\": 0.25},\n            \"Nt\": 180,\n        },\n        # Case 4: small-amplitude tide on a steeper beach\n        {\n            \"domain\": {\"Lx\": 1000.0, \"Ly\": 500.0, \"dx\": 10.0, \"dy\": 10.0},\n            \"bathymetry\": {\"type\": \"linear\", \"z0\": -0.1, \"s\": 0.002},\n            \"tide\": {\"A\": 0.04, \"omega\": 2.0 * np.pi / 43200.0},\n            \"thresholds\": {\"hmin1\": 0.05, \"hmin2\": 0.10},\n            \"Nt\": 180,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx = case[\"domain\"][\"Lx\"]\n        Ly = case[\"domain\"][\"Ly\"]\n        dx = case[\"domain\"][\"dx\"]\n        dy = case[\"domain\"][\"dy\"]\n        X, Y = build_grid(Lx, Ly, dx, dy)\n\n        btype = case[\"bathymetry\"][\"type\"]\n        if btype == \"linear\":\n            zb = bathymetry_linear(X, Y, case[\"bathymetry\"][\"z0\"], case[\"bathymetry\"][\"s\"])\n        elif btype == \"terrace_patch\":\n            zb = bathymetry_terrace_with_patch(\n                X, Y,\n                case[\"bathymetry\"][\"z0\"],\n                case[\"bathymetry\"][\"s\"],\n                case[\"bathymetry\"][\"x_patch\"],\n                case[\"bathymetry\"][\"y_patch\"],\n                case[\"bathymetry\"][\"d\"],\n            )\n        elif btype == \"gaussian_bar\":\n            zb = bathymetry_gaussian_bar(\n                X, Y,\n                case[\"bathymetry\"][\"z0\"],\n                case[\"bathymetry\"][\"s\"],\n                case[\"bathymetry\"][\"H\"],\n                case[\"bathymetry\"][\"xc\"],\n                case[\"bathymetry\"][\"yc\"],\n                case[\"bathymetry\"][\"sigx\"],\n                case[\"bathymetry\"][\"sigy\"],\n            )\n        else:\n            raise ValueError(\"Unknown bathymetry type\")\n\n        A = case[\"tide\"][\"A\"]\n        omega = case[\"tide\"][\"omega\"]\n        Nt = case[\"Nt\"]\n        hmin1 = case[\"thresholds\"][\"hmin1\"]\n        hmin2 = case[\"thresholds\"][\"hmin2\"]\n\n        Abar1 = cycle_mean_wet_area(zb, dx, dy, A, omega, Nt, hmin1)\n        Abar2 = cycle_mean_wet_area(zb, dx, dy, A, omega, Nt, hmin2)\n        dA = Abar2 - Abar1\n\n        # Round to one decimal place\n        results.append(f\"{dA:.1f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}