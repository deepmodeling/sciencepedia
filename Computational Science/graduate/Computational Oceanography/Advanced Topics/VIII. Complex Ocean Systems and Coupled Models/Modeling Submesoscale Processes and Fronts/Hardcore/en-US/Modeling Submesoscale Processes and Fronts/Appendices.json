{
    "hands_on_practices": [
        {
            "introduction": "This exercise delves into the heart of frontal dynamics by quantifying the rate at which horizontal gradients intensify. You will derive the frontogenesis function, a key diagnostic that connects the straining components of the velocity field directly to the sharpening of a temperature or buoyancy front. Mastering this calculation  builds a fundamental understanding of how fluid motion creates the sharp features characteristic of submesoscale processes.",
            "id": "3801116",
            "problem": "Consider a horizontally two-dimensional, inviscid, adiabatic, and incompressible submesoscale flow in the ocean. Let the horizontal velocity field be locally linear in space so that its horizontal gradient tensor at a point is the constant matrix $\\nabla_{h} \\mathbf{u}_{h} = \\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$. The local horizontal temperature field is also taken to be linear, $T(x,y) = T_{0} + \\alpha x + \\beta y$, with constant horizontal gradient $\\nabla_{h} T = (\\alpha, \\beta)^{\\top}$. The frontogenesis function is defined here as the material derivative of the magnitude of the horizontal temperature gradient, $F = \\frac{D}{Dt} \\left| \\nabla_{h} T \\right|$.\n\nUsing only the scalar advection equation for temperature, $\\frac{D T}{D t} = 0$, the definition of the material derivative, and the decomposition of a matrix into its symmetric (strain-rate) and antisymmetric (rotation-rate) parts, derive an exact expression for $F$ in terms of the symmetric strain-rate tensor $\\mathbf{S} = \\frac{1}{2} \\left( \\mathbf{A} + \\mathbf{A}^{\\top} \\right)$ and the horizontal temperature gradient $\\nabla_{h} T$. Clearly state all assumptions used.\n\nThen evaluate your expression at a point where the velocity gradient tensor is\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\na  b - \\omega \\\\\nb + \\omega  -a\n\\end{pmatrix},\n$$\nwith $a = 3.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$, $b = 2.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$, and $\\omega = 5.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$, and where the horizontal temperature gradient is given by $\\alpha = 2.0 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ and $\\beta = 1.5 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$.\n\nExpress the final numerical value of $F$ in $\\mathrm{K} \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$ and round your answer to three significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in geophysical fluid dynamics concerning the process of frontogenesis. All necessary information is provided, and the given physical parameters are consistent and realistic. We may therefore proceed with the solution.\n\nThe key assumptions stated or implied in the problem text are:\n1.  The flow is horizontally two-dimensional, inviscid, adiabatic, and incompressible. The incompressibility condition for a two-dimensional flow, $\\nabla_{h} \\cdot \\mathbf{u}_{h} = 0$, implies that the trace of the velocity gradient tensor $\\mathbf{A}$ must be zero, which is satisfied by the given matrix structure.\n2.  The adiabatic condition implies that temperature $T$ is conserved following a fluid parcel, which is expressed by the material derivative being zero: $\\frac{DT}{Dt} = 0$.\n3.  The horizontal velocity field $\\mathbf{u}_{h}$ and the temperature field $T$ are locally linear in the horizontal coordinates $(x,y)$. This means their respective gradients, $\\nabla_{h} \\mathbf{u}_{h} = \\mathbf{A}$ and $\\nabla_{h} T = \\mathbf{g}$, are constant in the local region of interest.\n4.  The magnitude of the temperature gradient is non-zero, i.e., $|\\nabla_h T| \\neq 0$.\n\nThe frontogenesis function $F$ is defined as the material derivative of the magnitude of the horizontal temperature gradient vector $\\mathbf{g} = \\nabla_h T$. Let us denote the magnitude by $G = |\\mathbf{g}| = |\\nabla_h T|$.\n$$\nF = \\frac{D G}{D t} = \\frac{D}{D t} |\\nabla_{h} T|\n$$\nWe can express the magnitude squared as $G^2 = \\mathbf{g} \\cdot \\mathbf{g} = g_i g_i$. Taking the material derivative of $G^2$:\n$$\n\\frac{D}{Dt}(G^2) = \\frac{D}{Dt}(\\mathbf{g} \\cdot \\mathbf{g}) = \\frac{D\\mathbf{g}}{Dt} \\cdot \\mathbf{g} + \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt} = 2 \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt}\n$$\nAlso, by the chain rule, $\\frac{D}{Dt}(G^2) = 2G \\frac{DG}{Dt} = 2G F$.\nEquating the two expressions gives:\n$$\n2G F = 2 \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt} \\implies F = \\frac{1}{G} \\left(\\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt}\\right) = \\frac{\\mathbf{g}}{|\\mathbf{g}|^2} \\cdot \\frac{D\\mathbf{g}}{Dt}\n$$\nThe next step is to find an expression for $\\frac{D\\mathbf{g}}{Dt} = \\frac{D(\\nabla_h T)}{Dt}$. We use the standard identity for the commutation of the material derivative and the gradient operator:\n$$\n\\frac{D}{Dt}(\\nabla_h T) = \\nabla_h \\left(\\frac{DT}{Dt}\\right) - (\\nabla_h \\mathbf{u}_h)^{\\top} (\\nabla_h T)\n$$\nGiven the adiabatic assumption, $\\frac{DT}{Dt} = 0$, so $\\nabla_h(\\frac{DT}{Dt}) = 0$. The expression simplifies to:\n$$\n\\frac{D\\mathbf{g}}{Dt} = -(\\nabla_h \\mathbf{u}_h)^{\\top} \\mathbf{g}\n$$\nUsing the problem's notation, $\\nabla_h \\mathbf{u}_h = \\mathbf{A}$, we have:\n$$\n\\frac{D\\mathbf{g}}{Dt} = -\\mathbf{A}^{\\top} \\mathbf{g}\n$$\nSubstituting this back into the expression for $F$:\n$$\nF = \\frac{1}{|\\mathbf{g}|} (\\mathbf{g} \\cdot (-\\mathbf{A}^{\\top} \\mathbf{g}))\n$$\nThis dot product can be written as a quadratic form using transpose notation: $\\mathbf{x} \\cdot (\\mathbf{M} \\mathbf{y}) = \\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{y}$. So,\n$$\nF = -\\frac{\\mathbf{g}^{\\top} \\mathbf{A}^{\\top} \\mathbf{g}}{|\\mathbf{g}|}\n$$\nThe problem requires the expression in terms of the symmetric strain-rate tensor $\\mathbf{S}$. We decompose the velocity gradient tensor $\\mathbf{A}$ into its symmetric part $\\mathbf{S}$ and its antisymmetric part $\\mathbf{\\Omega}$ (the rotation-rate tensor):\n$$\n\\mathbf{A} = \\mathbf{S} + \\mathbf{\\Omega}, \\quad \\text{where} \\quad \\mathbf{S} = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^{\\top}) \\quad \\text{and} \\quad \\mathbf{\\Omega} = \\frac{1}{2}(\\mathbf{A} - \\mathbf{A}^{\\top})\n$$\nTaking the transpose of $\\mathbf{A}$ gives $\\mathbf{A}^{\\top} = \\mathbf{S}^{\\top} + \\mathbf{\\Omega}^{\\top}$. By definition, $\\mathbf{S}$ is symmetric ($\\mathbf{S}^{\\top} = \\mathbf{S}$) and $\\mathbf{\\Omega}$ is antisymmetric ($\\mathbf{\\Omega}^{\\top} = -\\mathbf{\\Omega}$). Therefore, $\\mathbf{A}^{\\top} = \\mathbf{S} - \\mathbf{\\Omega}$.\nSubstituting this into the expression for $F$:\n$$\nF = -\\frac{\\mathbf{g}^{\\top} (\\mathbf{S} - \\mathbf{\\Omega}) \\mathbf{g}}{|\\mathbf{g}|} = -\\frac{\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g} - \\mathbf{g}^{\\top} \\mathbf{\\Omega} \\mathbf{g}}{|\\mathbf{g}|}\n$$\nFor any vector $\\mathbf{x}$ and any antisymmetric matrix $\\mathbf{M}$, the quadratic form $\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x}$ is identically zero. This is because $(\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x})^{\\top} = \\mathbf{x}^{\\top} \\mathbf{M}^{\\top} \\mathbf{x} = \\mathbf{x}^{\\top} (-\\mathbf{M}) \\mathbf{x} = -(\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x})$. Since the quantity is a scalar and is equal to its negative, it must be zero. Thus, $\\mathbf{g}^{\\top} \\mathbf{\\Omega} \\mathbf{g} = 0$.\n\nThe final expression for the frontogenesis function in terms of the strain-rate tensor and the temperature gradient is:\n$$\nF = -\\frac{\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g}}{|\\mathbf{g}|} = -\\frac{(\\nabla_{h} T)^{\\top} \\mathbf{S} (\\nabla_{h} T)}{|\\nabla_{h} T|}\n$$\nThis result shows that frontogenesis is driven by the strain field, not the rotational part of the flow.\n\nNow, we evaluate this expression for the given parameters. The velocity gradient tensor is:\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\na  b - \\omega \\\\\nb + \\omega  -a\n\\end{pmatrix}\n$$\nThe symmetric strain-rate tensor $\\mathbf{S}$ is:\n$$\n\\mathbf{S} = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^{\\top}) = \\frac{1}{2} \\left( \\begin{pmatrix} a  b - \\omega \\\\ b + \\omega  -a \\end{pmatrix} + \\begin{pmatrix} a  b + \\omega \\\\ b - \\omega  -a \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 2a  2b \\\\ 2b  -2a \\end{pmatrix} = \\begin{pmatrix} a  b \\\\ b  -a \\end{pmatrix}\n$$\nThe horizontal temperature gradient is $\\mathbf{g} = (\\alpha, \\beta)^{\\top}$. The quadratic form in the numerator of $F$ is:\n$$\n\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g} = \\begin{pmatrix} \\alpha  \\beta \\end{pmatrix} \\begin{pmatrix} a  b \\\\ b  -a \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} a\\alpha + b\\beta  b\\alpha - a\\beta \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = a\\alpha^2 + b\\alpha\\beta + b\\alpha\\beta - a\\beta^2 = a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta\n$$\nThe magnitude of the gradient is $|\\mathbf{g}| = \\sqrt{\\alpha^2 + \\beta^2}$.\nSo, the specific expression for $F$ is:\n$$\nF = - \\frac{a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta}{\\sqrt{\\alpha^2 + \\beta^2}}\n$$\nWe are given the values:\n$a = 3.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$\n$b = 2.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$\n$\\alpha = 2.0 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$\n$\\beta = 1.5 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$\n(Note that the value of $\\omega$ is not needed, as rotation does not contribute to frontogenesis.)\n\nLet's compute the terms:\n$\\alpha^2 = (2.0 \\times 10^{-4})^2 = 4.0 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\beta^2 = (1.5 \\times 10^{-4})^2 = 2.25 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\alpha^2 - \\beta^2 = (4.0 - 2.25) \\times 10^{-8} = 1.75 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\alpha\\beta = (2.0 \\times 10^{-4})(1.5 \\times 10^{-4}) = 3.0 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n\nThe numerator term is:\n$a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta = (3.0 \\times 10^{-5})(1.75 \\times 10^{-8}) + 2(2.0 \\times 10^{-5})(3.0 \\times 10^{-8})$\n$= 5.25 \\times 10^{-13} + 12.0 \\times 10^{-13} = 17.25 \\times 10^{-13} \\ \\mathrm{K}^2 \\mathrm{m}^{-2} \\mathrm{s}^{-1}$\n\nThe denominator term is:\n$\\sqrt{\\alpha^2 + \\beta^2} = \\sqrt{4.0 \\times 10^{-8} + 2.25 \\times 10^{-8}} = \\sqrt{6.25 \\times 10^{-8}} = 2.5 \\times 10^{-4} \\ \\mathrm{K} \\mathrm{m}^{-1}$\n\nFinally, we compute $F$:\n$$\nF = - \\frac{17.25 \\times 10^{-13} \\ \\mathrm{K}^2 \\mathrm{m}^{-2} \\mathrm{s}^{-1}}{2.5 \\times 10^{-4} \\ \\mathrm{K} \\mathrm{m}^{-1}} = -6.9 \\times 10^{-9} \\ \\mathrm{K} \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}\n$$\nThe problem asks to round the answer to three significant figures. The exact answer is $-6.9 \\times 10^{-9}$. Expressed with three significant figures, this is $-6.90 \\times 10^{-9}$.",
            "answer": "$$\n\\boxed{-6.90 \\times 10^{-9}}\n$$"
        },
        {
            "introduction": "Translating physical theory into a viable numerical simulation requires a principled approach to model setup. This practice guides you through the process of determining the necessary grid resolution and stable time step for a nonhydrostatic model of a sharp front . By deriving these parameters from physical scales, such as the Froude number $Fr$ and internal wave speeds, you will learn to justify the fundamental choices that underpin a credible numerical experiment.",
            "id": "3801124",
            "problem": "You are asked to construct a principled nonhydrostatic numerical model setup for a sharp surface-intensified front in a stably stratified oceanic mixed layer. Your task is to determine, from first principles, appropriate horizontal grid resolution, vertical discretization, and a stable explicit time step for an advection–internal-wave resolving, incompressible, Boussinesq, nonhydrostatic solver. The derivation must start from the incompressible Boussinesq momentum and continuity equations, the definition of the Froude number, and well-tested stability constraints based on the Courant–Friedrichs–Lewy (CFL) condition. You must provide a quantitative procedure that uses the Froude number to justify resolution choices and uses CFL constraints to select the maximum stable time step. All results must be expressed using physically consistent scalings and must be defensible by reference to the underlying equations and linear internal-wave theory in uniformly stratified fluid.\n\nThe fundamental base you must use includes:\n- The incompressible Boussinesq momentum equations with nonhydrostatic pressure, where the acceleration, Coriolis force, pressure gradient, and buoyancy enter the dynamics.\n- The continuity equation for incompressible flow, and the tracer equation for buoyancy under advection and diffusion.\n- The definition of the Froude number $Fr$ as the ratio of advective time scale to stratification time scale based on mixed-layer depth and characteristic horizontal speed, namely $Fr$ comparing $U$ against $N H$.\n- The existence of linear internal gravity wave modes in uniformly stratified fluid of depth $H$ and their characteristic modal speeds, used to constrain explicit time stepping for wave-resolving models.\n- The Courant–Friedrichs–Lewy (CFL) condition for explicit schemes constraining the time step by advective and wave propagation speeds.\n\nYour program must implement the following overall tasks for each test case:\n1. Compute the Froude number $Fr$ using the provided characteristic speed $U$, buoyancy frequency $N$, and mixed layer depth $H$.\n2. Choose a horizontal grid spacing that resolves the frontal width and a stratification-controlled advective length scale derived from fundamental balances, without relying on hydrodynamic shortcuts. The resolution must be justified by the requirement to represent sharp horizontal gradients and ageostrophic motions that are significant when $Fr$ is not asymptotically small.\n3. Choose a vertical grid spacing that resolves the first baroclinic mode structure of internal gravity waves in a uniformly stratified layer of depth $H$ sufficiently to minimize numerical dispersion and resolve vertical shear associated with the frontal dynamics.\n4. Compute the maximum stable explicit time step constrained by both horizontal and vertical advection CFL conditions and by internal gravity wave propagation in the horizontal.\n5. Return, for each test case, a compact summary containing the computed $Fr$, the recommended horizontal grid spacing, the recommended vertical grid spacing, the maximum stable time step, and booleans indicating that the selected time step satisfies the advective and gravity-wave CFL constraints.\n\nPhysical units and format requirements:\n- Express all lengths in meters and all times in seconds.\n- Express all angles, if any arise, in radians, but no angles are required in this task.\n- Express dimensionless quantities as plain decimals.\n- Round all floating-point outputs to six decimal places.\n- Booleans must be literal `True` or `False`.\n\nTest suite:\nFor coverage of different dynamical regimes and constraints, apply your derivation and algorithm to the following parameter sets, each describing a surface-intensified front in a uniformly stratified mixed layer:\n\n- Case A (general submesoscale front):\n  - Characteristic horizontal speed $U = 0.50 \\,\\mathrm{m\\,s^{-1}}$\n  - Characteristic vertical speed $W = 0.010 \\,\\mathrm{m\\,s^{-1}}$\n  - Buoyancy frequency $N = 1.0\\times 10^{-2} \\,\\mathrm{s^{-1}}$\n  - Mixed layer depth $H = 100 \\,\\mathrm{m}$\n  - Coriolis parameter $f = 1.0\\times 10^{-4} \\,\\mathrm{s^{-1}}$\n  - Frontal width (density gradient scale) $L_f = 2000 \\,\\mathrm{m}$\n  - Allowed Courant number $C = 0.50$\n\n- Case B (narrow, weaker front):\n  - $U = 0.20 \\,\\mathrm{m\\,s^{-1}}$, $W = 0.005 \\,\\mathrm{m\\,s^{-1}}$, $N = 5.0\\times 10^{-3} \\,\\mathrm{s^{-1}}$, $H = 50 \\,\\mathrm{m}$, $f = 1.0\\times 10^{-4} \\,\\mathrm{s^{-1}}$, $L_f = 500 \\,\\mathrm{m}$, $C = 0.70$\n\n- Case C (very sharp front with strong stratification):\n  - $U = 0.60 \\,\\mathrm{m\\,s^{-1}}$, $W = 0.030 \\,\\mathrm{m\\,s^{-1}}$, $N = 1.5\\times 10^{-2} \\,\\mathrm{s^{-1}}$, $H = 30 \\,\\mathrm{m}$, $f = 8.0\\times 10^{-5} \\,\\mathrm{s^{-1}}$, $L_f = 200 \\,\\mathrm{m}$, $C = 0.40$\n\nFor resolution sufficiency targets, use the following minimum discretization criteria that must be encoded in your algorithm and justified in your solution:\n- At least $n_f = 10$ grid points across the frontal width $L_f$ in the horizontal.\n- At least $n_b = 6$ grid points across the stratification-controlled advective length scale that is set by $U$ and $N$.\n- At least $s_z = 20$ vertical grid points resolving the depth $H$ to represent the first baroclinic mode shape and vertical shear.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the form:\n$[Fr,\\;dx,\\;dz,\\;dt,\\;\\text{advective\\_CFL\\_ok},\\;\\text{gravitywave\\_CFL\\_ok}]$\nAll floating-point values must be rounded to six decimal places. For example, the final printed line must look like:\n`[[Fr_A,dx_A,dz_A,dt_A,advective_A,gravity_A],[Fr_B,dx_B,dz_B,dt_B,advective_B,gravity_B],[Fr_C,dx_C,dz_C,dt_C,advective_C,gravity_C]]`",
            "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of geophysical fluid dynamics, well-posed with a complete and consistent set of parameters, and objective in its formulation. The task is to derive and implement a quantitative procedure for establishing a numerical model configuration for simulating an oceanic front. This involves determining grid resolutions and a stable time step from first principles.\n\nThe analysis begins with the incompressible Boussinesq equations, which govern the motion of a stratified fluid where density variations are small except in their contribution to the buoyancy force. In a rotating reference frame, the momentum equation is:\n$$\n\\frac{D\\mathbf{u}}{Dt} + f \\mathbf{k} \\times \\mathbf{u} = -\\frac{1}{\\rho_0} \\nabla p' + b \\mathbf{k}\n$$\nwhere $\\mathbf{u} = (u, v, w)$ is the velocity vector, $f$ is the Coriolis parameter, $\\mathbf{k}$ is the vertical unit vector, $\\rho_0$ is a constant reference density, $p'$ is the nonhydrostatic pressure perturbation, and $b = -g(\\rho - \\rho_0)/\\rho_0$ is the buoyancy. The material derivative is $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$. The system is closed by the continuity equation for incompressible flow, $\\nabla \\cdot \\mathbf{u} = 0$, and a conservation equation for buoyancy, $\\frac{Db}{Dt} = 0$, neglecting explicit diffusion for scaling purposes. The background stratification is quantified by the buoyancy frequency $N$, defined by $N^2 = \\frac{\\partial b}{\\partial z}$ for a background state in hydrostatic balance.\n\nThe procedure to determine the numerical parameters is as follows:\n\n**1. Froude Number Computation**\n\nThe internal Froude number, $Fr$, compares the characteristic horizontal velocity $U$ to the speed of long internal gravity waves, which scales with $NH$. This dimensionless number indicates the importance of stratification in resisting vertical motion induced by the flow. It is defined as:\n$$\nFr = \\frac{U}{NH}\n$$\nwhere $U$ is the characteristic horizontal speed, $N$ is the buoyancy frequency, and $H$ is the mixed-layer depth. A Froude number of order unity or greater suggests that the flow is energetic enough to overcome the restoring force of stratification, leading to significant ageostrophic motions and potential for mixing.\n\n**2. Horizontal Grid Spacing ($\\Delta x$)**\n\nThe horizontal resolution must be fine enough to resolve the key physical processes and gradients. The problem specifies two critical length scales to resolve.\n\nFirst, the frontal zone itself, characterized by a density gradient scale length $L_f$, must be well-represented. To capture the structure of the front, we require at least $n_f = 10$ grid points across this width. This imposes a constraint on the grid spacing $\\Delta x$:\n$$\n\\Delta x \\le \\frac{L_f}{n_f} = \\frac{L_f}{10}\n$$\n\nSecond, for flows with a non-negligible Froude number, ageostrophic dynamics become important. A fundamental length scale arises from balancing horizontal advection with the restoring force of stratification. The time scale for stratification to act is the inverse of the buoyancy frequency, $T_N = 1/N$. In this time, a fluid parcel moving at speed $U$ travels a horizontal distance $L_b = U/N$. This \"stratification-controlled advective length scale\" must also be resolved to accurately capture processes like frontogenesis and vertical circulation. The problem requires at least $n_b = 6$ grid points across this scale, leading to the constraint:\n$$\n\\Delta x \\le \\frac{L_b}{n_b} = \\frac{U}{6N}\n$$\n\nTo satisfy both criteria simultaneously, the horizontal grid spacing $\\Delta x$ must be chosen as the minimum of the two upper bounds:\n$$\n\\Delta x = \\min\\left(\\frac{L_f}{10}, \\frac{U}{6N}\\right)\n$$\n\nThe Coriolis parameter $f$ defines the internal Rossby radius of deformation, $L_R = NH/f$, which sets the scale for geostrophic balance. The provided cases describe submesoscale fronts where $L_f  L_R$ and the Rossby number $Ro = U/(fL_f)$ is of order unity or larger, justifying the focus on ageostrophic scales ($L_b$) rather than geostrophic scales ($L_R$) for determining resolution.\n\n**3. Vertical Grid Spacing ($\\Delta z$)**\n\nThe vertical grid spacing must resolve the vertical structure of the flow and internal waves. In a uniformly stratified layer of depth $H$, the gravest ($m=1$) baroclinic mode of internal waves has a vertical structure proportional to $\\sin(\\pi z / H)$. Adequate resolution of this half-sine wave structure is critical for minimizing numerical dispersion and accurately representing vertical shear. The problem mandates a minimum of $s_z = 20$ grid points over the depth $H$, which leads to a straightforward definition for the vertical grid spacing $\\Delta z$:\n$$\n\\Delta z = \\frac{H}{s_z} = \\frac{H}{20}\n$$\n\n**4. Maximum Stable Time Step ($\\Delta t$)**\n\nFor an explicit time-stepping scheme, the time step $\\Delta t$ is limited by the Courant–Friedrichs–Lewy (CFL) condition, which ensures that information does not propagate across more than one grid cell in a single time step. We must consider all relevant propagation speeds: advection and internal gravity waves. The general condition is $\\Delta t \\le C \\cdot (\\text{characteristic time})$, where $C$ is the Courant number.\n\na. **Advective Constraint:** The flow advects tracers and momentum at speeds $U$ and $W$ in the horizontal and vertical directions, respectively. This gives two constraints:\n   - Horizontal advection: $\\Delta t_{adv,x} \\le C \\frac{\\Delta x}{U}$\n   - Vertical advection: $\\Delta t_{adv,z} \\le C \\frac{\\Delta z}{W}$\n\nb. **Internal Gravity Wave Constraint:** A nonhydrostatic model resolves the full spectrum of internal gravity waves. The fastest propagating signal sets the most stringent stability limit. In a uniformly stratified fluid of depth $H$, the maximum speed of internal gravity waves corresponds to the phase speed of the first baroclinic mode ($m=1$) in the long-wavelength limit ($k_h \\to 0$). This speed is given by:\n$$\nc_{gw,max} = \\frac{NH}{\\pi}\n$$\nThe corresponding CFL constraint on the horizontal grid is:\n$$\n\\Delta t_{gw} \\le C \\frac{\\Delta x}{c_{gw,max}} = C \\frac{\\pi \\Delta x}{NH}\n$$\n\nThe final, globally stable time step $\\Delta t$ must be the minimum of all these constraints to ensure numerical stability with respect to all resolved processes:\n$$\n\\Delta t = \\min\\left( C \\frac{\\Delta x}{U}, C \\frac{\\Delta z}{W}, C \\frac{\\pi \\Delta x}{NH} \\right)\n$$\n\n**5. Verification Booleans**\n\nThe final required outputs are two boolean flags, `advective_CFL_ok` and `gravitywave_CFL_ok`. These flags are to confirm that the computed time step $\\Delta t$ satisfies the respective stability conditions. By defining $\\Delta t$ as the minimum of all constraining time scales, it is guaranteed by construction that both conditions are met. Thus, both booleans will evaluate to `True`. They serve as a logical self-consistency check on the calculation.\n\nThis principled procedure yields a complete set of numerical parameters ($Fr, \\Delta x, \\Delta z, \\Delta t$) for each test case, derived directly from the fundamental physics of stratified flows and standard numerical stability theory.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical model parameters for simulating oceanic fronts based on\n    physical principles and stability constraints.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (general submesoscale front)\n        {'U': 0.50, 'W': 0.010, 'N': 1.0e-2, 'H': 100.0, 'f': 1.0e-4, 'L_f': 2000.0, 'C': 0.50, 'n_f': 10, 'n_b': 6, 's_z': 20},\n        # Case B (narrow, weaker front)\n        {'U': 0.20, 'W': 0.005, 'N': 5.0e-3, 'H': 50.0, 'f': 1.0e-4, 'L_f': 500.0, 'C': 0.70, 'n_f': 10, 'n_b': 6, 's_z': 20},\n        # Case C (very sharp front with strong stratification)\n        {'U': 0.60, 'W': 0.030, 'N': 1.5e-2, 'H': 30.0, 'f': 8.0e-5, 'L_f': 200.0, 'C': 0.40, 'n_f': 10, 'n_b': 6, 's_z': 20},\n    ]\n\n    results = []\n    for case in test_cases:\n        U = case['U']\n        W = case['W']\n        N = case['N']\n        H = case['H']\n        L_f = case['L_f']\n        C = case['C']\n        n_f = case['n_f']\n        n_b = case['n_b']\n        s_z = case['s_z']\n\n        # 1. Compute the Froude number Fr\n        # Fr = U / (N * H)\n        fr = U / (N * H)\n\n        # 2. Choose horizontal grid spacing dx\n        # Constraint from frontal width Lf\n        dx_f = L_f / n_f\n        # Constraint from stratification-controlled advective length scale U/N\n        dx_b = U / (n_b * N)\n        # Choose the more restrictive (smaller) grid spacing\n        dx = min(dx_f, dx_b)\n\n        # 3. Choose vertical grid spacing dz\n        # Constraint from resolving the first baroclinic mode structure\n        dz = H / s_z\n\n        # 4. Compute maximum stable explicit time step dt\n        # Constraint from horizontal advection\n        dt_adv_x = C * dx / U\n        # Constraint from vertical advection\n        dt_adv_z = C * dz / W\n        \n        # Aggregate advective constraint limit\n        dt_adv_limit = min(dt_adv_x, dt_adv_z)\n        \n        # Constraint from internal gravity wave propagation\n        # Max wave speed c_gw_max = N * H / pi\n        c_gw_max = (N * H) / np.pi\n        dt_gw_limit = C * dx / c_gw_max\n        \n        # Final time step is the minimum of all constraints\n        dt = min(dt_adv_limit, dt_gw_limit)\n        \n        # 5. Check if the final dt satisfies the constraints\n        # These will be True by construction, serving as a check.\n        advective_cfl_ok = (dt = dt_adv_limit)\n        gravitywave_cfl_ok = (dt = dt_gw_limit)\n\n        # Round all floating point outputs to six decimal places\n        current_result = [\n            round(fr, 6),\n            round(dx, 6),\n            round(dz, 6),\n            round(dt, 6),\n            advective_cfl_ok,\n            gravitywave_cfl_ok\n        ]\n        results.append(current_result)\n\n    # Format the final output string to have no spaces, for consistency\n    # with the problem's example format and other problems.\n    output_str = \"[\" + \",\".join([str(r).replace(\" \", \"\") for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "A successful simulation requires not only a proper setup but also a critical evaluation of its output for numerical artifacts. This exercise  tackles the challenge of quantifying spurious mixing—non-physical diffusion introduced by the numerical advection scheme itself. By implementing sophisticated diagnostics based on tracer entropy and variance decay, you will develop the skills to assess the fidelity of a model and understand the trade-offs between different numerical methods and resolutions.",
            "id": "3801164",
            "problem": "You are tasked with quantifying spurious mixing introduced by numerical advection schemes when simulating a passive tracer in an incompressible, periodic, submesoscale-like flow. Begin from the conservation law for a passive tracer governed by the advection–diffusion equation and the incompressibility constraint: $$\\frac{\\partial C}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla C = \\kappa \\nabla^2 C,\\quad \\nabla\\cdot\\boldsymbol{u} = 0,$$ where $C(x,y,t)$ is the tracer concentration, $\\boldsymbol{u}(x,y)$ is the velocity field, and $\\kappa$ is the molecular diffusivity. In the ideal limit $\\kappa = 0$, advection is reversible and conserves information content and tracer variance. However, numerical discretization and interpolation typically produce irreversible mixing mimicking $\\kappa \\gt 0$; your goal is to quantify this spurious mixing using two diagnostics derived from first principles.\n\nDefine the following domain, flow, and initial condition to model submesoscale frontal stirring:\n\n- A square periodic domain of side length $L$ in meters with coordinates $(x,y)\\in[0,L)\\times[0,L)$.\n- A steady, periodic, incompressible Taylor–Green vortex (TGV) flow defined by the streamfunction $$\\psi(x,y) = \\frac{U_0 L}{2\\pi}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\sin\\left(\\frac{2\\pi y}{L}\\right),$$ whose velocity is $$u(x,y) = \\frac{\\partial \\psi}{\\partial y} = U_0 \\sin\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{L}\\right),\\quad v(x,y) = -\\frac{\\partial \\psi}{\\partial x} = -U_0 \\cos\\left(\\frac{2\\pi x}{L}\\right)\\sin\\left(\\frac{2\\pi y}{L}\\right).$$ This periodic straining and rotational flow is a standard idealization of submesoscale stirring.\n- A frontlike, periodic initial tracer given by $$C_0(x,y) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\beta \\cos\\left(\\frac{2\\pi y}{L}\\right)\\right)\\right],$$ where $\\beta\\gt 0$ controls frontal sharpness. This yields two alternating bands in $y$ with sharp gradients reminiscent of a front, and is strictly periodic.\n\nSet $\\kappa=0$ in the governing equation for the numerical experiment (pure advection) and use a semi-Lagrangian time stepper that backtraces grid points along trajectories by $\\Delta t$ using the steady velocity. The semi-Lagrangian update maps each grid point $(x,y)$ to a departure location $(x',y') = \\left(x - u(x,y)\\Delta t,\\; y - v(x,y)\\Delta t\\right)$ (wrap periodically into $[0,L)$) and updates $C$ at $(x,y)$ by interpolating $C$ from $(x',y')$. Use two interpolation configurations: bilinear periodic interpolation and nearest-neighbor periodic interpolation. The bilinear scheme generally smooths and thus mixes more; the nearest-neighbor scheme preserves piecewise values but still mixes due to area-distortion and remapping.\n\nFrom first principles, define two spurious mixing diagnostics computed for each time $t$:\n\n1. The irreversible entropy production rate, based on the Boltzmann-like entropy density of the tracer: $$S(t) = -\\frac{1}{A}\\int_{A} C(x,y,t)\\,\\ln\\left(C(x,y,t)\\right)\\,\\mathrm{d}A,$$ where $A=L^2$ and the natural logarithm is used. In the ideal advection limit with perfectly conservative numerics, $\\mathrm{d}S/\\mathrm{d}t = 0$. Numerically induced mixing generally increases $S$. Estimate the mean irreversible entropy production rate in $\\mathrm{s}^{-1}$ as the time average $$\\overline{\\sigma_S} = \\frac{1}{T-\\Delta t}\\int_{\\Delta t}^{T} \\frac{S(t) - S(t-\\Delta t)}{\\Delta t}\\,\\mathrm{d}t,$$ discretized using a finite difference over the simulated time window of length $T$.\n2. The tracer variance decay and a corresponding effective diffusivity. Define the spatial mean $$\\overline{C}(t) = \\frac{1}{A}\\int_A C(x,y,t)\\,\\mathrm{d}A,$$ and the variance $$\\mathrm{Var}(t) = \\frac{1}{A}\\int_A \\left(C(x,y,t) - \\overline{C}(t)\\right)^2\\,\\mathrm{d}A.$$ In the continuum with $\\kappa = 0$ and exact advection, $\\mathrm{Var}(t)$ is conserved. With diffusion, a standard result is $$\\frac{\\mathrm{d}\\,\\mathrm{Var}}{\\mathrm{d}t} = -2\\kappa \\frac{1}{A}\\int_A \\left|\\nabla C\\right|^2\\,\\mathrm{d}A,$$ where $\\left|\\nabla C\\right|^2 = \\left(\\frac{\\partial C}{\\partial x}\\right)^2 + \\left(\\frac{\\partial C}{\\partial y}\\right)^2$. Use this relation as a definition of an effective numerical diffusivity by substituting the measured $\\mathrm{d}\\,\\mathrm{Var}/\\mathrm{d}t$ in an advection-only run with $\\kappa=0$: $$\\kappa_{\\mathrm{eff}}(t) = -\\frac{\\frac{\\mathrm{d}\\,\\mathrm{Var}}{\\mathrm{d}t}}{2\\,\\Gamma(t)},\\quad \\Gamma(t) = \\frac{1}{A}\\int_A \\left|\\nabla C(x,y,t)\\right|^2\\,\\mathrm{d}A.$$ Estimate the mean effective diffusivity $\\overline{\\kappa}_{\\mathrm{eff}}$ in $\\mathrm{m}^2/\\mathrm{s}$ by time-averaging $\\kappa_{\\mathrm{eff}}(t)$. Also report the mean fractional variance decay rate in $\\mathrm{s}^{-1}$ defined by $$\\overline{r_{\\mathrm{var}}} = \\frac{1}{T-\\Delta t}\\int_{\\Delta t}^{T} \\frac{\\mathrm{Var}(t) - \\mathrm{Var}(t-\\Delta t)}{\\mathrm{Var}(t-\\Delta t)\\,\\Delta t}\\,\\mathrm{d}t.$$\n\nImplement the following:\n\n- Use angles in radians for all trigonometric functions.\n- Use physical units meters and seconds for all quantities. Express $\\overline{\\kappa}_{\\mathrm{eff}}$ in $\\mathrm{m}^2/\\mathrm{s}$ and both $\\overline{\\sigma_S}$ and $\\overline{r_{\\mathrm{var}}}$ in $\\mathrm{s}^{-1}$.\n- Discretize the domain using $N\\times N$ points (square grid), uniform spacings $\\Delta x = \\Delta y = L/N$, and periodic boundary conditions.\n- Use a semi-Lagrangian step with backtraced positions $(x',y')$ and periodic interpolation according to the specified scheme.\n- Compute $\\overline{\\sigma_S}$, $\\overline{\\kappa}_{\\mathrm{eff}}$, and $\\overline{r_{\\mathrm{var}}}$ by discrete time averaging over the simulated window.\n\nTest Suite and Parameter Sets:\n\nLet $L = 10^4$ meters, $U_0 = 0.2$ meters per second, $\\beta = 5$, $\\Delta t = 50$ seconds, and total simulation time $T = 18{,}000$ seconds. Evaluate the following four cases:\n\n1. Bilinear periodic interpolation, $N = 128$.\n2. Nearest-neighbor periodic interpolation, $N = 128$.\n3. Bilinear periodic interpolation, $N = 64$.\n4. Bilinear periodic interpolation, $N = 256$.\n\nFinal Output Specification:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a three-element list in the order $[\\overline{\\sigma_S},\\overline{\\kappa}_{\\mathrm{eff}},\\overline{r_{\\mathrm{var}}}]$. Aggregate the four test case results into one list, resulting in a single line of the form [[case1_values],[case2_values],[case3_values],[case4_values]] with numbers formatted as plain decimal floats and with no spaces. For example: [[v11,v12,v13],[v21,v22,v23],[v31,v32,v33],[v41,v42,v43]].",
            "solution": "The derivation and algorithm proceed from the passive scalar conservation law and incompressibility. The governing partial differential equation is $$\\frac{\\partial C}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla C = \\kappa \\nabla^2 C,\\quad \\nabla\\cdot\\boldsymbol{u}=0,$$ with $\\kappa=0$ in the numerical experiment. The incompressibility condition implies that fluid parcels preserve area, and pure advection is a measure-preserving mapping on the domain. In the continuum, such a transformation does not change the probability density function of $C$ nor any functional that depends only on its distribution (under exact transport). Two pertinent diagnostics are derived.\n\nThe first diagnostic is the entropy density of the tracer, $$S(t) = -\\frac{1}{A}\\int_A C(x,y,t)\\,\\ln C(x,y,t)\\,\\mathrm{d}A.$$ This functional is analogous to information entropy in statistical mechanics for a positive scalar $C$. In ideal advection, the mapping preserves $C$ along characteristics, so any integral of a function of $C$ over the area $A$ is invariant; specifically, $\\mathrm{d}S/\\mathrm{d}t = 0$. However, numerical advection combines interpolation and discrete remapping, which smooths small-scale variations created by straining and filamentation. This smoothing increases $S$ because $-C\\ln C$ is convex for $C\\in(0,1)$, and mixing decreases gradients and sharpness, thus making the distribution of $C$ more uniform. Therefore, the irreversible entropy production rate $$\\sigma_S(t) = \\frac{S(t) - S(t-\\Delta t)}{\\Delta t}$$ is a measure of spurious mixing, with a positive mean value $\\overline{\\sigma_S}$ indicating entropy increase.\n\nThe second diagnostic uses the variance of the tracer, $$\\overline{C}(t) = \\frac{1}{A}\\int_A C\\,\\mathrm{d}A,\\quad \\mathrm{Var}(t) = \\frac{1}{A}\\int_A \\left(C - \\overline{C}\\right)^2\\,\\mathrm{d}A.$$ For advection-only and exact numerics, $\\overline{C}(t)$ and $\\mathrm{Var}(t)$ are conserved because advection redistributes constants conservatively with no diffusion. In the presence of diffusion, the evolution of variance can be derived by differentiating under the integral sign and applying the conservation equation and incompressibility. Compute $$\\frac{\\mathrm{d}\\,\\mathrm{Var}}{\\mathrm{d}t} = \\frac{2}{A}\\int_A \\left(C - \\overline{C}\\right)\\frac{\\partial C}{\\partial t}\\,\\mathrm{d}A,$$ where $\\frac{\\mathrm{d}\\overline{C}}{\\mathrm{d}t}=0$ for incompressible advection and periodic boundaries. Substituting $\\partial C/\\partial t = \\kappa \\nabla^2 C$ and using integration by parts under periodic boundaries yields $$\\frac{\\mathrm{d}\\,\\mathrm{Var}}{\\mathrm{d}t} = \\frac{2\\kappa}{A}\\int_A \\left(C - \\overline{C}\\right)\\nabla^2 C\\,\\mathrm{d}A = -\\frac{2\\kappa}{A}\\int_A \\left|\\nabla C\\right|^2\\,\\mathrm{d}A.$$ The last equality follows because $\\int_A \\overline{C}\\,\\nabla^2 C\\,\\mathrm{d}A = \\overline{C}\\int_A \\nabla^2 C\\,\\mathrm{d}A = 0$ by periodicity, and $\\int_A C \\nabla^2 C\\,\\mathrm{d}A = -\\int_A \\left|\\nabla C\\right|^2\\,\\mathrm{d}A$ by integration by parts with no boundary flux. This identity establishes a direct link between variance decay and diffusion coefficient. In our purely advective numerical scheme where $\\kappa=0$ physically, numerical smoothing produces a nonzero $\\mathrm{d}\\,\\mathrm{Var}/\\mathrm{d}t$. We therefore define an effective numerical diffusivity by the relation $$\\kappa_{\\mathrm{eff}}(t) = -\\frac{\\frac{\\mathrm{d}\\,\\mathrm{Var}}{\\mathrm{d}t}}{2\\,\\Gamma(t)},\\quad \\Gamma(t) = \\frac{1}{A}\\int_A \\left|\\nabla C(x,y,t)\\right|^2\\,\\mathrm{d}A.$$ Time-averaging $\\kappa_{\\mathrm{eff}}(t)$ yields $\\overline{\\kappa}_{\\mathrm{eff}}$ in $\\mathrm{m}^2/\\mathrm{s}$, a diagnostic comparable across resolutions and schemes. Additionally, the mean fractional variance decay rate $$\\overline{r_{\\mathrm{var}}} = \\left\\langle \\frac{\\mathrm{Var}(t) - \\mathrm{Var}(t-\\Delta t)}{\\mathrm{Var}(t-\\Delta t)\\,\\Delta t} \\right\\rangle$$ is a dimensionless (per second) normalized measure of variance decay.\n\nAlgorithmic design integrates these principles:\n\n1. Discretize the domain with a periodic $N\\times N$ grid over $[0,L)\\times[0,L)$. Use angles in radians for trigonometric functions and ensure all physical units are meters and seconds.\n2. Construct the Taylor–Green vortex velocity field $\\boldsymbol{u}(x,y)$ via the streamfunction. This ensures $\\nabla\\cdot\\boldsymbol{u} = 0$ and periodicity.\n3. Initialize $C_0(x,y)$ using the periodic frontlike function with parameter $\\beta$, clipped to a small positive lower bound to avoid $\\ln 0$.\n4. Step forward in time with a semi-Lagrangian scheme: for each grid point $(x,y)$, compute the departure point $(x',y') = (x - u(x,y)\\Delta t,\\; y - v(x,y)\\Delta t)$ and wrap periodically. Interpolate $C$ at $(x',y')$ using either bilinear periodic interpolation or nearest-neighbor periodic interpolation:\n   - Bilinear interpolation computes a convex combination of the four surrounding grid values with weights determined by fractional indices; periodic indexing with modulo arithmetic ensures wrap-around.\n   - Nearest neighbor selects the closest grid point’s value, again with periodic wrap-around.\n   Both methods conserve neither mass nor energy exactly; their smoothing differences will be reflected in the diagnostics.\n5. At each time step, compute:\n   - The spatial mean $\\overline{C}(t)$ and variance $\\mathrm{Var}(t)$ via discrete area averages.\n   - The entropy density $S(t)$ via $-\\langle C\\ln C\\rangle$, where angle brackets denote spatial averaging.\n   - The squared gradient average $\\Gamma(t)$ via centered, periodic finite differences: $$\\frac{\\partial C}{\\partial x} \\approx \\frac{C(x+\\Delta x,y) - C(x-\\Delta x,y)}{2\\Delta x},\\quad \\frac{\\partial C}{\\partial y} \\approx \\frac{C(x,y+\\Delta y) - C(x,y-\\Delta y)}{2\\Delta y},$$ and $\\Gamma(t) = \\langle |\\nabla C|^2 \\rangle$.\n6. Compute discrete time derivatives using finite differences: $$\\sigma_S(t) \\approx \\frac{S(t) - S(t-\\Delta t)}{\\Delta t},\\quad \\frac{\\mathrm{d}\\,\\mathrm{Var}}{\\mathrm{d}t} \\approx \\frac{\\mathrm{Var}(t) - \\mathrm{Var}(t-\\Delta t)}{\\Delta t},$$ and $$\\kappa_{\\mathrm{eff}}(t) = -\\frac{\\frac{\\mathrm{Var}(t) - \\mathrm{Var}(t-\\Delta t)}{\\Delta t}}{2\\,\\Gamma(t)},\\quad r_{\\mathrm{var}}(t) = \\frac{\\mathrm{Var}(t) - \\mathrm{Var}(t-\\Delta t)}{\\mathrm{Var}(t-\\Delta t)\\,\\Delta t}.$$\n   Time-average these quantities over the simulated window to obtain $\\overline{\\sigma_S}$, $\\overline{\\kappa}_{\\mathrm{eff}}$, and $\\overline{r_{\\mathrm{var}}}$.\n7. Repeat for all configurations and resolutions in the test suite. Expect bilinear interpolation to produce larger $\\overline{\\sigma_S}$ and $\\overline{\\kappa}_{\\mathrm{eff}}$ than nearest neighbor due to increased smoothing, and coarser grids to induce larger spurious mixing than finer grids.\n\nFinally, emit the four results as a single list of lists, with each inner list containing the three diagnostics $[\\overline{\\sigma_S},\\overline{\\kappa}_{\\mathrm{eff}},\\overline{r_{\\mathrm{var}}}]$ and formatted with no spaces, in compliance with the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef tgv_velocity(U0, L, X, Y):\n    \"\"\"\n    Taylor-Green vortex velocity field:\n    u = U0 * sin(2*pi*x/L) * cos(2*pi*y/L)\n    v = -U0 * cos(2*pi*x/L) * sin(2*pi*y/L)\n    \"\"\"\n    k = 2.0 * np.pi / L\n    sin_kx = np.sin(k * X)\n    cos_kx = np.cos(k * X)\n    sin_ky = np.sin(k * Y)\n    cos_ky = np.cos(k * Y)\n    u = U0 * sin_kx * cos_ky\n    v = -U0 * cos_kx * sin_ky\n    return u, v\n\ndef initial_tracer(L, X, Y, beta):\n    \"\"\"\n    Periodic frontlike tracer:\n    C0(x,y) = 0.5 * [1 + tanh(beta * cos(2*pi*y/L))]\n    \"\"\"\n    k = 2.0 * np.pi / L\n    C = 0.5 * (1.0 + np.tanh(beta * np.cos(k * Y)))\n    # Avoid exact zeros or ones to keep log well-defined.\n    eps = 1e-12\n    C = np.clip(C, eps, 1.0 - eps)\n    return C\n\ndef semi_lagrangian_step(C, u, v, dt, L, dx, dy, scheme, X, Y):\n    \"\"\"\n    Semi-Lagrangian update of C using departure points computed with Euler backtrace.\n    Periodic bilinear or nearest-neighbor interpolation implemented via modulo indexing.\n    Grid is uniform with coordinates X, Y representing positions of cell centers.\n    \"\"\"\n    # Compute departure points with Euler backtrace.\n    Xd = X - u * dt\n    Yd = Y - v * dt\n    # Periodic wrap into [0, L)\n    Xd = np.mod(Xd, L)\n    Yd = np.mod(Yd, L)\n\n    # Map physical positions to fractional grid indices\n    # Grid indices: i in [0, Nx-1], j in [0, Ny-1], with x = i*dx, y = j*dy\n    Nx = C.shape[1]\n    Ny = C.shape[0]\n    ix = Xd / dx\n    iy = Yd / dy\n\n    if scheme == \"bilinear\":\n        # Lower-left indices\n        i0 = np.floor(ix).astype(np.int64) % Nx\n        j0 = np.floor(iy).astype(np.int64) % Ny\n        # Upper-right neighbor indices\n        i1 = (i0 + 1) % Nx\n        j1 = (j0 + 1) % Ny\n        # Fractional weights\n        fx = ix - np.floor(ix)\n        fy = iy - np.floor(iy)\n        # Gather corner values\n        C00 = C[j0, i0]\n        C10 = C[j0, i1]\n        C01 = C[j1, i0]\n        C11 = C[j1, i1]\n        # Bilinear interpolation\n        C_new = (1.0 - fx) * (1.0 - fy) * C00 + fx * (1.0 - fy) * C10 + (1.0 - fx) * fy * C01 + fx * fy * C11\n    elif scheme == \"nearest\":\n        i_nn = np.round(ix).astype(np.int64) % Nx\n        j_nn = np.round(iy).astype(np.int64) % Ny\n        C_new = C[j_nn, i_nn]\n    else:\n        raise ValueError(\"Unknown scheme: \" + str(scheme))\n\n    # Clip to bounds to avoid log issues\n    eps = 1e-12\n    C_new = np.clip(C_new, eps, 1.0 - eps)\n    return C_new\n\ndef compute_entropy(C):\n    # Entropy density S = -  C ln C \n    return -np.mean(C * np.log(C))\n\ndef compute_variance(C):\n    meanC = np.mean(C)\n    return np.mean((C - meanC) ** 2), meanC\n\ndef compute_gradients_squared(C, dx, dy):\n    # Periodic centered differences\n    dCdx = (np.roll(C, -1, axis=1) - np.roll(C, 1, axis=1)) / (2.0 * dx)\n    dCdy = (np.roll(C, -1, axis=0) - np.roll(C, 1, axis=0)) / (2.0 * dy)\n    grad2 = dCdx * dCdx + dCdy * dCdy\n    return np.mean(grad2)\n\ndef run_case(L, U0, beta, N, dt, T, scheme):\n    # Grid setup\n    Nx = N\n    Ny = N\n    dx = L / Nx\n    dy = L / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    X, Y = np.meshgrid(x, y)  # shape (Ny, Nx)\n\n    # Velocity field (steady in time)\n    u, v = tgv_velocity(U0, L, X, Y)\n\n    # Initial tracer\n    C = initial_tracer(L, X, Y, beta)\n\n    # Time-stepping\n    steps = int(T // dt)\n    S_series = []\n    Var_series = []\n    Grad_series = []\n\n    # Diagnostics at initial time\n    S_series.append(compute_entropy(C))\n    var, meanC = compute_variance(C)\n    Var_series.append(var)\n    Grad_series.append(compute_gradients_squared(C, dx, dy))\n\n    for _ in range(steps):\n        C = semi_lagrangian_step(C, u, v, dt, L, dx, dy, scheme, X, Y)\n        S_series.append(compute_entropy(C))\n        var, meanC = compute_variance(C)\n        Var_series.append(var)\n        Grad_series.append(compute_gradients_squared(C, dx, dy))\n\n    S_series = np.array(S_series)\n    Var_series = np.array(Var_series)\n    Grad_series = np.array(Grad_series)\n\n    # Time derivatives via finite differences\n    # Use S[1:] - S[:-1], Var[1:] - Var[:-1], Grad[1:] for kappa_eff pairing\n    dSdt = (S_series[1:] - S_series[:-1]) / dt\n    dVdt = (Var_series[1:] - Var_series[:-1]) / dt\n    # Effective diffusivity at each step (use Grad at current time step)\n    kappa_eff_t = -dVdt / (2.0 * Grad_series[1:])\n    # Fractional variance decay rate\n    r_var_t = (Var_series[1:] - Var_series[:-1]) / (Var_series[:-1] * dt)\n\n    # Time-averages\n    sigma_S_mean = float(np.mean(dSdt))\n    kappa_eff_mean = float(np.mean(kappa_eff_t))\n    r_var_mean = float(np.mean(r_var_t))\n\n    return sigma_S_mean, kappa_eff_mean, r_var_mean\n\ndef format_results_no_spaces(results):\n    # results is a list of tuples/floats; produce nested list string with no spaces\n    inner = []\n    for trip in results:\n        inner.append(\"[\" + \",\".join(f\"{v:.8e}\" for v in trip) + \"]\")\n    return \"[\" + \",\".join(inner) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    L = 1.0e4  # meters\n    U0 = 0.2   # m/s\n    beta = 5.0\n    dt = 50.0  # seconds\n    T = 18000.0  # seconds\n\n    test_cases = [\n        (\"bilinear\", 128),\n        (\"nearest\", 128),\n        (\"bilinear\", 64),\n        (\"bilinear\", 256),\n    ]\n\n    results = []\n    for scheme, N in test_cases:\n        sigma_S_mean, kappa_eff_mean, r_var_mean = run_case(L, U0, beta, N, dt, T, scheme)\n        results.append((sigma_S_mean, kappa_eff_mean, r_var_mean))\n\n    # Final print statement in the exact required format: nested list, no spaces.\n    print(format_results_no_spaces(results))\n\nsolve()\n```"
        }
    ]
}