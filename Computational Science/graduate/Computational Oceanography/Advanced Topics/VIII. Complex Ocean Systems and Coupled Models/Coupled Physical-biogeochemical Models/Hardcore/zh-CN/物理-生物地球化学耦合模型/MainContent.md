## 引言
耦合物理-[生物地球化学模型](@entry_id:1121600)是现代[海洋学](@entry_id:149256)和地球系统科学中不可或缺的研究工具。它们通过数学方程和[计算模拟](@entry_id:146373)，将控制[海洋环流](@entry_id:195237)、混合与层化的物理过程，同驱动[元素循环](@entry_id:202524)、生态系统动态的生物和化学过程紧密地联系在一起。理解海洋这样一个复杂系统的关键，正是在于揭示这些不同领域过程之间错综复杂的相互作用与[反馈机制](@entry_id:269921)，而这正是耦合模型所要解决的核心科学问题。本文旨在系统性地剖析这些模型的构建原理、数值挑战及其在科学探究中的广泛应用。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。第一章“原理与机制”将深入探讨模型构建的基石，从基本的[平流-扩散-反应](@entry_id:746316)控制方程出发，详细解析[生物地球化学](@entry_id:152189)源汇项的构建方法，并阐明解决模型中多时间尺度“刚性”问题的先进数值策略。随后，第二章“应用与交叉学科联系”将展示这些模型作为科学工具的强大功能，通过一系列实例说明如何利用模型进行过程研究、量化[生物地球化学](@entry_id:152189)通量，以及通过[数据同化技术](@entry_id:637566)融合模型与观测。最后，第三章“动手实践”部分将提供一系列精心设计的问题，帮助读者将理论知识应用于解决具体的计算和分析挑战。

## 原理与机制

本章旨在深入探讨耦合物理-[生物地球化学模型](@entry_id:1121600)的核心原理与内在机制。在前一章介绍背景之后，我们将系统地构建这些模型的数学和计算基础。我们将从描述海洋示踪剂演化的基本守恒定律出发，逐步构建描述[生物地球化学](@entry_id:152189)相互作用的[复杂反应](@entry_id:166407)项，最后探讨求解这些耦合方程组时所面临的关键数值挑战及其解决方案。

### 控制方程：平流、[扩散与反应](@entry_id:1123704)

任何耦合物理-[生物地球化学模型](@entry_id:1121600)的核心都是一套描述各种生物地球化学示踪剂（如营养盐、浮游生物、有机碎屑等）浓度变化的[偏微分](@entry_id:194612)方程。这些方程的普适形式是**[平流-扩散-反应](@entry_id:746316)（Advection-Diffusion-Reaction, ADR）方程**，它源于基本的[质量守恒](@entry_id:204015)原理。

对于一个由多种示踪剂浓度组成的向量 $\mathbf{C} = (C_1, C_2, \dots, C_n)^\top$，其在三维空间中的演化可以用以下**[通量守恒形式](@entry_id:147745)**的方程组来描述 ：

$$
\frac{\partial \mathbf{C}}{\partial t} + \nabla \cdot (\mathbf{u}\mathbf{C} - \mathbf{K}\nabla \mathbf{C}) = \mathbf{R}(\mathbf{C}, T, S, I)
$$

这个方程表明了示踪剂浓度的[局部变化率](@entry_id:264961)（$\frac{\partial \mathbf{C}}{\partial t}$）由物理输运通量的散度（$\nabla \cdot (\dots)$）和本地[生物地球化学](@entry_id:152189)源汇项（$\mathbf{R}$）共同决定。让我们仔细剖析该方程的每一个组成部分。

#### 物理输运算子

方程左侧的第二项代表了物理输运过程，它本身包含平流和扩散两个部分。

**平流通量**，由项 $\mathbf{u}\mathbf{C}$ 描述，代表了示踪剂随流体宏观运动（即由速度场 $\mathbf{u}(\mathbf{x}, t)$ 描述的洋流）的输运。在方程的向量形式中，$\nabla \cdot (\mathbf{u}\mathbf{C})$ 算子作用于每个示踪剂分量 $C_j$，即 $\nabla \cdot (\mathbf{u} C_j)$。在海洋模型中，我们通常采用 Boussinesq 近似，假设海水是不可压缩的，即速度场的散度为零（$\nabla \cdot \mathbf{u} = 0$）。在这种情况下，平流项可以展开为 $\nabla \cdot (\mathbf{u} C_j) = (\nabla \cdot \mathbf{u}) C_j + \mathbf{u} \cdot \nabla C_j = \mathbf{u} \cdot \nabla C_j$，后者被称为“平流形式”。然而，**[通量守恒形式](@entry_id:147745)**在数值计算中具有特殊优势，因为它能更好地保证离散化后示踪剂总量的守恒。

**扩散通量**，由项 $-\mathbf{K}\nabla \mathbf{C}$ 描述，代表了由未解析的亚格子尺度[湍流](@entry_id:151300)和[分子运动](@entry_id:140498)引起的输运。这遵循**菲克定律（Fick's law）**，即通量与浓度梯度成正比，方向指向浓度降低的方向（由负号表示）。这里的 $\mathbf{K}(\mathbf{x}, t)$ 是一个二阶**扩散系数张量**，其单位为 $\mathrm{m}^2\mathrm{s}^{-1}$。它允许[扩散过程](@entry_id:268015)具有各向异性，例如，海洋中的水平扩散通常比垂直扩散强几个数量级。为了保证[扩散过程](@entry_id:268015)总是耗散能量并使梯度变得平滑（符合[热力学](@entry_id:172368)第二定律），$\mathbf{K}$ 必须是**[对称正定](@entry_id:145886)**的。

#### 生物地球化学反应项 $\mathbf{R}$

方程右侧的 $\mathbf{R}(\mathbf{C}, T, S, I)$ 是模型的“生物心脏”，它封装了所有局部的生物和化学过程，这些过程在原位改变示踪剂的浓度。它是一个向量函数，其每个分量 $R_j$ 代表第 $j$ 个示踪剂的净源汇速率（源减去汇）。这些速率通常是高度[非线性](@entry_id:637147)的，并且依赖于示踪剂本身的浓度 $\mathbf{C}$ 以及一系列环境物理变量，如温度 $T$、盐度 $S$ 和光合有效辐射 $I$。例如，[浮游植物](@entry_id:184206)的生长速率会受到营养盐浓度、光照强度和温度的共同影响。构建一个科学合理的反应项 $\mathbf{R}$ 是生物地球化学建模的核心挑战之一，我们将在下文中详细探讨。

### 构建生物地球化学源汇项 $\mathbf{R}$

反应项 $\mathbf{R}$ 的形式决定了模型的生态学和地球化学行为。其构建需要遵循基本的[化学计量](@entry_id:137450)原理，并对复杂的[生物过程](@entry_id:164026)进行合理的数学抽象。

#### 化学计量约束与[元素循环](@entry_id:202524)

[生物地球化学](@entry_id:152189)过程的本质是元素的转化与循环。因此，一个基本约束是反应必须遵循特定的**[化学计量](@entry_id:137450)**关系。海洋中最著名的例子是**[雷德菲尔德比](@entry_id:146354)（Redfield ratio）**，它描述了海洋[浮游植物](@entry_id:184206)的平均[元素组成](@entry_id:161166)以及有机物分解时营养盐的释放比例，通常表示为 $106\text{C}:16\text{N}:1\text{P}$。

这意味着，由浮游生物介导的净生物反应所引起的溶解无机碳（DIC）、氮（DIN）和磷（DIP）的局部变化速率 $R_C, R_N, R_P$ 必须遵循固定的[摩尔比](@entry_id:193577) ：
$$
\frac{R_C(\mathbf{x},t)}{106} = \frac{R_N(\mathbf{x},t)}{16} = \frac{R_P(\mathbf{x},t)}{1}
$$
这个局部速率关系可以直接推广到整个模型区域的积分变化。考虑一个物理上封闭的控制体积（即边界净通量为零），在该体积内，由生物反应引起的溶解[无机物](@entry_id:152980)储量的净变化 $\Delta C, \Delta N, \Delta P$ 也必须遵循相同的比例：
$$
\frac{\Delta C}{106} = \frac{\Delta N}{16} = \Delta P
$$
例如，如果一个封闭系统在一个时间段内净消耗了 $2.0 \, \mathrm{mol}$ 的无机氮（$\Delta N = -2.0 \, \mathrm{mol}$），那么根据[雷德菲尔德比](@entry_id:146354)，它必然同时消耗了 $0.125 \, \mathrm{mol}$ 的无机磷，并产生了 $13.25 \, \mathrm{mol}$ 的溶解有机碳（如果考虑光合作用）。这种[化学计量](@entry_id:137450)约束是模型验证和保证元素守恒的关键。

#### 模拟营养盐的吸收与限制

[浮游植物](@entry_id:184206)的生长是海洋生态系统的基础，其速率受到多种资源的限制，主要是营养盐和光。

**从[酶动力学](@entry_id:145769)到生态系统：Monod 方程**

在模型中，我们通常使用经验性的**[莫诺方程](@entry_id:261052)（Monod function）**来描述单位浮游生物量对单一限制性营养盐 $N$ 的比吸收速率 $U_N$：
$$
U_N = \frac{V_{\max} \cdot N}{K_N + N}
$$
其中，$V_{\max}$ 是最大比吸收速率，$K_N$ 是**[半饱和常数](@entry_id:1125887)**，即吸收速率达到 $V_{\max}/2$ 时的营养盐浓度。这个方程形式优雅地捕捉了两个关键行为：在低浓度时，吸收速率近似与营养盐浓度成正比（$U_N \approx (V_{\max}/K_N)N$）；在高浓度时，吸收速率趋于饱和，达到最大值 $V_{\max}$。

[莫诺方程](@entry_id:261052)并非纯粹的经验拟合，它具有深刻的机理基础，可以从**[米氏方程](@entry_id:146495)（[Michaelis-Menten](@entry_id:145978) kinetics）**推导而来 。[米氏方程](@entry_id:146495)描述了由酶 $E$ 催化的单底物 $N$ 反应：
$$
E + N \;\underset{k_{-1}}{\overset{k_1}{\rightleftharpoons}}\; EN \;\xrightarrow{k_{\text{cat}}}\; E + X
$$
在**[准稳态假设](@entry_id:273480)（Quasi-Steady-State Assumption, QSSA）**下（即中间复合物 $EN$ 的浓度变化很慢），单位体积的[反应速率](@entry_id:185114) $v$ 为：
$$
v = \frac{k_{\text{cat}} [E]_{\text{tot}} N}{K_M + N}, \quad \text{其中 } K_M = \frac{k_{-1} + k_{\text{cat}}}{k_1}
$$
要将这个分子层面的速率与种群层面的比吸收速率 $U_N$ 联系起来，我们需要一个关键的“尺度提升”假设：**细胞内的总吸收酶浓度 $[E]_{\text{tot}}$ 与浮游生物量 $P$ 成正比**，即 $[E]_{\text{tot}} = \alpha P$。基于此，比吸收速率 $U_N = v/P$ 就变为：
$$
U_N = \frac{k_{\text{cat}} (\alpha P) N / P}{K_M + N} = \frac{k_{\text{cat}} \alpha N}{K_M + N}
$$
通过比较，我们发现[莫诺方程](@entry_id:261052)的参数可以解释为 $V_{\max} = k_{\text{cat}} \alpha$ 和 $K_N = K_M$。这个推导揭示了宏观生态参数如何植根于微观的生物化学机制。

**多营养盐限制：[李比希最低量定律](@entry_id:204497)**

当多种营养盐（如氮、磷、硅）都可能成为限制因子时，模型必须决定它们的共同作用方式。一个经典且广泛应用的模型是**[李比希最低量定律](@entry_id:204497)（Liebig's Law of the Minimum）**，它指出生长速率由最稀缺的资源决定。

如果每种营养盐 $N_i$ 对应一个限制因子 $L_i = N_i / (K_i + N_i)$，那么遵循[李比希定律](@entry_id:203198)的总吸收（或生长）速率 $U$ 可以表示为 ：
$$
U(\mathbf{N}) = V_{\max} \cdot \min_{i} \{L_i(\mathbf{N})\}
$$
这种形式在生物学上非常直观，但在数值上带来了一个严峻的挑战：$\min$ 函数是**不可微的**。在两种或多种营养盐同样稀缺的“[拐点](@entry_id:144929)”（tie points）处，函数的梯度没有唯一定义。这对于依赖梯度的先进数值方法，如**[四维变分同化](@entry_id:749536)（4D-Var）**或伴随方法进行[参数优化](@entry_id:151785)，是致命的。

为了解决这个问题，可以使用一个光滑函数来近似 $\min$ 函数，例如 **Log-Sum-Exp (LSE)** 技巧，构造一个“软最小值”（soft-min）：
$$
\mathrm{smin}_{\alpha}(\{L_i\}) = -\frac{1}{\alpha} \ln\left(\sum_{i=1}^{m} e^{-\alpha L_i}\right)
$$
这个函数在任何地方都是可微的，并且当参数 $\alpha \to \infty$ 时，它[一致收敛](@entry_id:146084)于真实的最小值。这为在耦合模型中实现梯度计算提供了一个优雅的解决方案。

#### 与[环境强迫](@entry_id:185244)的耦合：光场

生物地球化学过程不仅依赖于其他示踪剂，还强烈地受到物理环境的驱动。光照是驱动海洋初级生产力的主要能源。因此，准确模拟光在水中的衰减至关重要。

光在水中的衰减遵循**比尔-朗伯定律（Beer-Lambert Law）**。对于一个垂直的一维水柱，深度 $z$ 处的光合有效辐射（PAR）强度 $I(z)$ 可以通过对其表面值 $I_0$ 进行积分衰减得到 ：
$$
\frac{dI}{dz} = -K_d(z) I(z)
$$
其中 $K_d(z)$ 是随深度变化的漫射[衰减系数](@entry_id:920164)。这个系数本身由多个部分组成，最主要的是纯水自身的吸收 $k_w$ 和由浮游植物色素（以[叶绿素](@entry_id:143697)Chl(z)浓度为代表）引起的吸收。假设这些贡献是可加的，我们有：
$$
K_d(z) = k_w + k_c \cdot \mathrm{Chl}(z)
$$
这里，$k_w$ 是纯水的[衰减系数](@entry_id:920164)（单位 $\mathrm{m}^{-1}$），$k_c$ 是**[叶绿素](@entry_id:143697)比[衰减系数](@entry_id:920164)**（单位 $\mathrm{m}^2 (\mathrm{mg}\,\mathrm{Chl})^{-1}$），它量化了单位[叶绿素](@entry_id:143697)对光的吸收能力。

对上述[微分](@entry_id:158422)方程从水面（$z=0$）到深度 $z$ 进行积分，可得 $I(z)$ 的解析表达式：
$$
I(z) = I_0 \exp\left(-k_w z - k_c \int_{0}^{z} \mathrm{Chl}(z')\,dz'\right)
$$
这个方程完美地展示了物理-生物地球化学耦合的本质：光（物理场）驱动[浮游植物](@entry_id:184206)生长，而浮游植物的生物量（以叶绿素 Chl 表示，是生物场）反过来又决定了光的衰减，从而影响更深水层的光合作用。

#### 一个概念性应用：[临界深度](@entry_id:275576)假说

将光限制的生长与损失过程相结合，我们可以构建一个简洁但极具洞察力的[概念模型](@entry_id:1122832)——**[临界深度](@entry_id:275576)假说（Critical Depth Hypothesis）**，由 Sverdrup 首次提出，用于解释春季水华的发生。

该理论假设在一个深度为 $D$ 的均匀混合层内，[浮游植物](@entry_id:184206)的净增长取决于水柱积分的生产力是否能超过水柱积分的损失。假设光合生[产率](@entry_id:141402)与光强成正比 $g(z) = \alpha I(z)$，而呼吸和捕食等损失率为常数 $\lambda$。**[临界深度](@entry_id:275576) $D_c$** 被定义为使得混合层内净生产力恰好为零的深度 ：
$$
\int_{0}^{D_c} [g(z) - \lambda] \, dz = \int_{0}^{D_c} [\alpha I_0 \exp(-Kz) - \lambda] \, dz = 0
$$
求解这个[积分方程](@entry_id:138643)可以得到 $D_c$ 的值。例如，对于一组春季陆架海的典型参数：$I_{0} = 40 \, \mathrm{W\,m^{-2}}$，$K = 0.08 \, \mathrm{m^{-1}}$，$\alpha = 0.006 \, \mathrm{d^{-1}\,(W\,m^{-2})^{-1}}$，$\lambda = 0.12 \, \mathrm{d^{-1}}$，计算可得[临界深度](@entry_id:275576)约为 $D_c \approx 19.92 \, \mathrm{m}$。

这个理论的启示是：只有当混合层深度 $D$ 浅于[临界深度](@entry_id:275576) $D_c$ 时，[浮游植物](@entry_id:184206)在混合层内的平均光照才足以支撑其种群的净增长，从而引发[水华](@entry_id:182413)。这解释了为何春季随着日照增强和水体层化（混合层变浅），会爆发大规模的[浮游植物水华](@entry_id:185666)。这是连接物理过程（层化、混合）和生物响应（[水华](@entry_id:182413)）的经典范例。

### 耦合模型的数值原理

构建了连续的数学方程后，下一个挑战是如何在计算机上对其进行求解。耦合[ADR方程](@entry_id:1120828)的数值解法涉及一系列独特的挑战，主要源于模型中并存的不同过程的数学特性和时间尺度。

#### [算子分裂](@entry_id:634210)与多时间尺度的挑战：刚性问题

完整的[ADR方程](@entry_id:1120828) $\frac{\partial C}{\partial t} = \mathcal{L}_{\text{transport}}(C) + \mathcal{L}_{\text{reaction}}(C)$ 包含一个输运算子和一个反应算子。这两个算子具有截然不同的数学特性 ：
- **输运算子** $\mathcal{L}_{\text{transport}}$ 是一个微分算子（涉及空间梯度），它将不同空间点的浓度联系起来（全局耦合）。在示踪剂浓度不影响流场的前提下，它是一个**线性算子**。
- **反应算子** $\mathcal{L}_{\text{reaction}}$ 通常是一个[代数函数](@entry_id:187534)（不涉及空间梯度），它只作用于每个空间点内部的浓度（**局部**）。然而，它通常是**高度[非线性](@entry_id:637147)**的。

这种结构上的差异使得采用**[算子分裂](@entry_id:634210)（Operator Splitting）**方法变得非常有效。其思想是将一个复杂[问题分解](@entry_id:272624)为一系列更简单的子问题，然后依次求解。例如，在一个时间步内，可以先只考虑输运过程更新浓度，然后再基于更新后的浓度计算反应过程。

然而，这种方法必须面对生物地球化学反应项带来的一个核心数值难题：**刚性（Stiffness）**。[刚性系统](@entry_id:146021)是指一个常微分方程组（ODEs）中包含多个相互作用但时间尺度差异巨大的过程 。[生物地球化学](@entry_id:152189)反应网络正是典型的刚性系统：[光化学反应](@entry_id:184924)可能在微秒尺度上发生，而种群的增长和死亡则在天到周的尺度上进行。

这种时间尺度的巨大差异对**显式时间积分方法**（如前向欧拉法）是致命的。为了保证数值稳定，显式方法的时间步长 $\Delta t$ 必须小于由系统中最快过程决定的一个阈值。具体来说，$\Delta t$ 必须满足 $\Delta t \lesssim 2/|\lambda_{\max}|$，其中 $|\lambda_{\max}|$ 是反应项[雅可比矩阵](@entry_id:178326)[最大特征值](@entry_id:1127078)的模 。如果模型中包含一个时间尺度为 $1$ 秒的快速反应，那么即使我们关心的是季节变化（时间尺度为数月），显式积分的时间步长也不得不被限制在秒级，这将导致惊人的计算成本。

例如，在一个平流占主导的系统中，输运过程的[稳定时间步长](@entry_id:755325)（由CFL条件决定）可能为 $\Delta t_{\text{adv}} = 1.25 \times 10^4 \, \mathrm{s}$。但如果系统中最快的反应特征时间为 $1/\lambda_{\max} \approx 1/(4.0 \times 10^{-4} \, \mathrm{s}^{-1}) = 2500 \, \mathrm{s}$，那么显式反应积分的稳定步长则为 $\Delta t_{\text{react}} \le 2/\lambda_{\max} \approx 5000 \, \mathrm{s}$。整个耦合模型的显式积分步长必须取两者中的较小者，即 $\Delta t \le 5000 \, \mathrm{s}$，此时时间步长由反应的刚性所限制。

#### 先进的时间积分策略：IMEX 和异步耦合

为了克服刚性问题，同时保持[计算效率](@entry_id:270255)，现代耦合模型广泛采用**隐式-显式（Implicit-Explicit, IMEX）**积分格式。其核心思想是“对症下药” ：
- 对引起刚性的**反应项** $R(C)$ 采用**[隐式方法](@entry_id:138537)**（如后向欧拉法）。[隐式方法](@entry_id:138537)具有优越的稳定性，允许使用远大于刚性尺度的时间步长。由于反应项是局部的，隐式求解需要在每个网格点上解一个小的（通常是[非线性](@entry_id:637147)的）代数方程组，这在计算上是可行的。
- 对通常非刚性的**输运项** $\mathcal{A}C$ 采用**显式方法**。显式方法计算简单（通常只需矩阵-向量乘法），其稳定性约束（[CFL条件](@entry_id:178032)）通常与模型要解析的物理过程的时间尺度相匹配。

一个一阶的IMEX（或半隐式）欧拉格式可以写成：
$$
\frac{C^{n+1} - C^n}{\Delta t} = \mathcal{A}C^n + R(C^{n+1})
$$
该格式的稳定区结合了显式和[隐式方法](@entry_id:138537)的优点。其单步扩增因子 $G$ 对于线性测试问题 $\frac{dC}{dt} = \lambda_A C + \lambda_R C$ 为 $G = (1 + z_A) / (1 - z_R)$，其中 $z_A = \Delta t \lambda_A$ 和 $z_R = \Delta t \lambda_R$。稳定性由非刚性项的显式部分决定，而刚性项的稳定性则得到保证。

此外，物理过程和[生物过程](@entry_id:164026)的时间步长也可以不同，这种策略称为**异步耦合（Asynchronous Coupling）**和**[子循环](@entry_id:755594)（Subcycling）** 。例如，物理模块（输运）可以使用一个较大的时间步长 $\Delta t_p$，而在每个物理步长内，生物模块（反应）则以一个较小的时间步长 $\Delta t_b = \Delta t_p / r$ 运行 $r$ 次。

选择合适的[子循环](@entry_id:755594)比率 $r$ 需要权衡多个因素：
1.  **物理稳定性**：$\Delta t_p$ 必须满足其CFL和扩散数约束。
2.  **生物积分稳定性**：$\Delta t_b$ 必须满足其（显式或隐式）积分格式的稳定性要求。对于[显式格式](@entry_id:1124773)，这通常要求 $\Delta t_b$ 小于某个阈值。
3.  **生物积分精度**：为准确解析[生物过程](@entry_id:164026)，$\Delta t_b$ 应远小于最快的生物特征时间尺度，例如 $\Delta t_b \le \theta \tau_{\text{bio}}$，其中 $\theta$ 是一个小于1的因子。
4.  **耦合误差**：算子分裂会引入与[算子对易子](@entry_id:152475)范数 $\|[\mathcal{L}_{\text{phys}}, \mathcal{L}_{\text{bio}}]\|$ 相关的误差。该误差通常与 $\Delta t_p \Delta t_b$ 成正比。为将[误差控制](@entry_id:169753)在容忍度 $\varepsilon$ 以内，需要满足 $\Delta t_b \le \varepsilon / (M \Delta t_p)$，其中 $M$ 是对易子范数的上界。

最优的 $\Delta t_b$ 必须满足所有这些约束中最严格的一条，从而决定了最小的子循环次数 $r$。这是一个在实际建模中平衡精度、稳定性和计算成本的典型例子。

#### 一个实际要务：[质量守恒](@entry_id:204015)

最后，一个长期稳定运行的海洋模型必须严格遵守质量守恒。然而，由于[数值离散化](@entry_id:752782)误差、[时间插值](@entry_id:755845)或[非线性](@entry_id:637147)过程的近似处理，即使是理论上守恒的格式，在长时间积分后也可能出现**数值漂移（numerical drift）**，导致总质量（如全海域的总氮储量）发生不应有的增减。

为了应对这个问题，模型中常常会引入**质量修正器（mass fixer）**的模块 。这是一种务实的、有时略带“ad-hoc”性质的校正程序，其目标是在每个时间步或特定间隔后，强制使模型中的总质量与理论上应有的总质量相符。

一个设计良好的质量修正器必须是**保正的（positivity-preserving）**，即不能在修正过程中产生不符合物理实际的负浓度。其基本逻辑是：
- **诊断漂移**：计算当前时刻的实际总质量 $M^{\mathrm{real}}$ 与基于源汇项和边界通量计算出的期望总质量 $M^{\mathrm{exp}}$ 之间的差异 $\Delta M = M^{\mathrm{real}} - M^{\mathrm{exp}}$。
- **添加亏损**（若 $\Delta M  0$）：将亏损的质量 $-\Delta M$ [按比例分配](@entry_id:634725)到所有含水的网格单元中。一种常见的分配方式是与网格体积成正比，这相当于给所有水体施加一个均匀的浓度增量。
- **移除盈余**（若 $\Delta M > 0$）：将多余的质量 $\Delta M$ 从有质量的网格单元中移除。为保证保正性，移除量应与该单元当前质量成正比，且从任何单元移除的质量不能超过该单元本身所含的质量。这个过程可能需要迭代进行，直到所有盈余质量被移除或所有可移除的质量都被清空。

虽然质量修正器在理论上可能不那么“优雅”，但它对于防止模型在气候尺度等长期模拟中出现灾难性的质量不守恒问题，是不可或缺的实用工具，保证了模型的鲁棒性。