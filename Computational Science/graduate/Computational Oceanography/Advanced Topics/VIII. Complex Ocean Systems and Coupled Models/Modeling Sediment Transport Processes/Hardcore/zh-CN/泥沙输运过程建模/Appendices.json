{
    "hands_on_practices": [
        {
            "introduction": "Exner方程是地貌动力学建模的基石，它描述了泥沙输运率的空间梯度如何导致河床高程的变化。这项练习将引导您从质量守恒这一基本物理原理出发，推导该方程，并澄清在推导过程中如何处理孔隙率以及区分颗粒体积通量与混合物体积通量。通过解决这一问题，您将对地貌演化模型的核心方程建立起直观且深刻的理解。",
            "id": "3800701",
            "problem": "一个一维、沿岸均匀的海岸沙床由等直径、近似球形的石英颗粒组成。假设静止床层是固体体积分数为 $0.64$ 的单分散球体的随机密堆积。近床运动层是一个膨胀的颗粒组合体，近似为固体体积分数为 $0.55$ 的随机疏松堆积。设相对于固定基准面的床面高程为 $\\eta(x,t)$，其中 $x$ 是以米为单位的沿岸坐标，$t$ 是以秒为单位的时间。单位宽度的沿岸总体积底沙输运率（即运动混合物（包括其颗粒间空隙）的体积通量）经测量随 $x$ 呈线性变化，关系为 $q_{\\mathrm{bulk}}(x) = q_{0} + a x$，其中 $q_{0} = 2.50 \\times 10^{-4} \\, \\mathrm{m^2/s}$，$a = 1.00 \\times 10^{-6} \\, \\mathrm{m/s}$。\n\n从固相质量守恒和孔隙度的定义出发，(i) 确定由所述静止床层颗粒堆积所隐含的床层孔隙度 $\\lambda_{p}$，(ii) 将测得的总体积输运率 $q_{\\mathrm{bulk}}(x)$ 与固体体积输运率建立一致的关系，以及 (iii) 利用这些关系推导瞬时床面高程变化率 $\\frac{\\partial \\eta}{\\partial t}$ 关于空间梯度 $\\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x}$ 的局部关系式。在 $x^{\\star} = 300$ 处计算该变化率。\n\n将 $x^{\\star}$ 处的瞬时床面高程变化率 $\\frac{\\partial \\eta}{\\partial t}$ 作为你的最终数值答案。最终答案以 $\\mathrm{m/s}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求基于泥沙质量守恒原理，推导并计算床面高程的变化率 $\\frac{\\partial \\eta}{\\partial t}$。我们首先将床面高程变化与泥沙输运的空间梯度之间的关系（通常称为Exner方程）形式化。\n\n首先，我们按要求解决问题的三个部分。\n\n(i) 确定床层孔隙度 $\\lambda_{p}$。\n孔隙度 $\\lambda_{p}$ 定义为多孔介质中孔隙体积与总体积之比。固体体积分数（我们记为 $\\phi$）是固体体积与总体积之比。根据定义，对于静止床层：\n$$ \\lambda_{p} + \\phi_{\\mathrm{bed}} = 1 $$\n问题指出，静止床层是随机密堆积，其固体体积分数为 $\\phi_{\\mathrm{bed}} = 0.64$。因此，床层孔隙度为：\n$$ \\lambda_{p} = 1 - \\phi_{\\mathrm{bed}} = 1 - 0.64 = 0.36 $$\n\n(ii) 将测得的总体积输运率 $q_{\\mathrm{bulk}}(x)$ 与固体体积输运率建立关系。\n总体积输运率 $q_{\\mathrm{bulk}}$ 表示单位时间内单位宽度上通过某点的运动混合物（固体加间隙流体）的体积。固体体积输运率 $q_{s}$ 仅为输运的固体颗粒的体积。它们之间的关系由运动层的固体体积分数 $\\phi_{\\mathrm{moving}}$ 决定。问题指出该层是随机疏松堆积，其 $\\phi_{\\mathrm{moving}} = 0.55$。因此，关系式为：\n$$ q_{s}(x) = \\phi_{\\mathrm{moving}} \\cdot q_{\\mathrm{bulk}}(x) $$\n\n(iii) 利用这些关系推导 $\\frac{\\partial \\eta}{\\partial t}$ 的局部关系式并进行计算。\n静止床层中固相的质量守恒是核心原理。考虑一个床层的一维控制体积，其长度为无穷小量 $dx$，宽度为单位宽度。此床层段内的固体体积为 $V_{s, \\mathrm{bed}} = \\phi_{\\mathrm{bed}} \\cdot \\eta \\cdot dx$。该固体体积的变化率必须等于流入控制体积的固体体积净通量。\n控制体积内固体体积的变化率为：\n$$ \\frac{\\partial V_{s, \\mathrm{bed}}}{\\partial t} = \\frac{\\partial}{\\partial t} (\\phi_{\\mathrm{bed}} \\eta \\, dx) = \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} dx $$\n此处，我们假设静止床层的堆积方式 $\\phi_{\\mathrm{bed}}$ 不随时间变化。\n流入控制体积的固体净通量是位置 $x$ 处流入的通量与位置 $x+dx$ 处流出的通量之差：\n$$ \\text{Net Flux} = q_{s}(x) - q_{s}(x+dx) $$\n对于无穷小量 $dx$，这可以使用一阶泰勒展开来表示：$q_{s}(x+dx) \\approx q_{s}(x) + \\frac{\\partial q_{s}}{\\partial x} dx$。于是净通量为：\n$$ \\text{Net Flux} \\approx q_{s}(x) - \\left( q_{s}(x) + \\frac{\\partial q_{s}}{\\partial x} dx \\right) = -\\frac{\\partial q_{s}}{\\partial x} dx $$\n将体积变化率与净通量（守恒原理）相等，可得：\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} dx = -\\frac{\\partial q_{s}}{\\partial x} dx $$\n两边同除以 $dx$，得到一维泥沙连续性Exner方程：\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\partial q_{s}}{\\partial x} $$\n注意，$\\phi_{\\mathrm{bed}}$ 等价于 $(1-\\lambda_p)$。\n\n现在，我们将(ii)部分中 $q_s$ 的表达式代入Exner方程：\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left( \\phi_{\\mathrm{moving}} q_{\\mathrm{bulk}}(x) \\right) $$\n问题指出，运动层是随机疏松堆积，这意味着其固体体积分数 $\\phi_{\\mathrm{moving}}$ 也是一个常数。因此，我们可以将其移到空间导数之外：\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\phi_{\\mathrm{moving}} \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} $$\n求解床面高程变化率 $\\frac{\\partial \\eta}{\\partial t}$，我们得到所需的关系式：\n$$ \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\phi_{\\mathrm{moving}}}{\\phi_{\\mathrm{bed}}} \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} $$\n问题指明总体积输运率是 $x$ 的线性函数：\n$$ q_{\\mathrm{bulk}}(x) = q_{0} + a x $$\n其中 $q_{0} = 2.50 \\times 10^{-4} \\, \\mathrm{m^2/s}$ 且 $a = 1.00 \\times 10^{-6} \\, \\mathrm{m/s}$。\n因此，总体积输运的空间梯度是一个常数：\n$$ \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} = \\frac{\\partial}{\\partial x}(q_{0} + a x) = a $$\n将此结果代入我们关于 $\\frac{\\partial \\eta}{\\partial t}$ 的表达式中：\n$$ \\frac{\\partial \\eta}{\\partial t} = -a \\frac{\\phi_{\\mathrm{moving}}}{\\phi_{\\mathrm{bed}}} $$\n这表明床面高程的变化率在整个沿岸是均匀的，也就是说，它不是 $x$ 的函数。因此，在 $x^{\\star} = 300 \\, \\mathrm{m}$ 处的值与其他任何地方的值都相同。\n\n最后，我们代入所给的数值：\n$$ \\phi_{\\mathrm{bed}} = 0.64 $$\n$$ \\phi_{\\mathrm{moving}} = 0.55 $$\n$$ a = 1.00 \\times 10^{-6} \\, \\mathrm{m/s} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -(1.00 \\times 10^{-6}) \\frac{0.55}{0.64} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -(1.00 \\times 10^{-6}) \\times 0.859375 \\, \\mathrm{m/s} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -8.59375 \\times 10^{-7} \\, \\mathrm{m/s} $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\frac{\\partial \\eta}{\\partial t} \\approx -8.594 \\times 10^{-7} \\, \\mathrm{m/s} $$\n负号表示床层正在发生侵蚀，这是预料之中的，因为输运率随 $x$ 增加（$\\partial q_{\\mathrm{bulk}}/\\partial x > 0$），意味着离开任何给定区域的泥沙多于进入该区域的泥沙。",
            "answer": "$$\\boxed{-8.594 \\times 10^{-7}}$$"
        },
        {
            "introduction": "在现实世界中，泥沙并非只是被动输运的示踪剂，它的存在会通过改变水体密度来反作用于流动本身。本练习将带您探究悬沙引起的密度分层如何抑制湍流混合，这是高含沙水流中的一个关键物理过程。您将学习计算梯度理查森数（gradient Richardson number）$Ri$，并用它来量化湍流涡黏性系数的衰减，从而理解泥沙-湍流相互作用的基本机制。",
            "id": "3800685",
            "problem": "沙质陆架上一个活跃的潮汐边界层携带悬浮泥沙混合物，其存在改变了水柱密度并抑制了湍流混合。考虑垂直坐标 $z$，从河床向上测量。在近底床高度 $z_b = 0.05 \\, \\mathrm{m}$ 处，原位剖面测量提供了局部浓度梯度 $\\left.\\frac{dC}{dz}\\right|_{z_b} = -10 \\, \\mathrm{kg\\,m^{-4}}$ 和局部平均速度切变 $\\left.\\frac{dU}{dz}\\right|_{z_b} = S = 2 \\, \\mathrm{s^{-1}}$。混合物密度模型为 $\\rho(z) = \\rho_0 + \\alpha \\, C(z)$，其中 $\\rho_0 = 1025 \\, \\mathrm{kg\\,m^{-3}}$ 是参考海水密度，$\\alpha = 0.5$ 是单位质量浓度的无量纲密度增量。重力加速度为 $g = 9.81 \\, \\mathrm{m\\,s^{-2}}$。假设湍流施密特数（涡黏度与涡扩散系数之比）为 $\\mathrm{Sc_t} = 1$，并采用混合长度 $l_m = \\kappa z$，其中 von Kármán 常数 $\\kappa = 0.4$。\n\n从稳定分层剪切流中湍流动能（TKE）和标量输运的基本平衡方程出发，推导在 $z_b$ 处与稳定性相关的泥沙浓度涡扩散系数 $K_c$，用中性（未分层）涡扩散系数 $K_0 = l_m^2 S$ 和梯度理查森数表示，并利用获得的测量数据量化由泥沙引起的分层导致的混合减弱程度。取临界梯度理查森数为 $Ri_c = 0.25$，并使用一个与在 $Ri = Ri_c$ 时混合消失相一致的一阶小 $Ri$ 闭合方案。\n\n此外，在沉降速度为 $w_s = 0.01 \\, \\mathrm{m\\,s^{-1}}$ 且平均垂直平流可忽略的稳定一维垂直输运条件下，使用通量平衡来评估近底床浓度在 $z_b$ 处相对于在 $z_r = 0.10 \\, \\mathrm{m}$ 处的参考测量值 $C(z_r) = 0.05 \\, \\mathrm{kg\\,m^{-3}}$ 的增强情况，假设 $K$ 在 $z_b$ 和 $z_r$ 之间近似恒定，并等于 $K_0$（中性情况）或分层情况下的 $K_c$。\n\n报告在 $z_b$ 处的分层涡扩散系数 $K_c$。用 $\\mathrm{m^2/s}$ 表示最终答案，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算在泥沙引起的水体密度分层影响下的涡扩散系数 $K_c$。关键步骤是首先计算梯度理查森数 $Ri$，它量化了分层的稳定性，然后利用一个稳定性函数来修正中性（未分层）情况下的涡扩散系数。\n\n**步骤1：计算梯度理查森数 ($Ri$)**\n梯度理查森数定义为 $Ri = \\frac{N^2}{S^2}$，其中 $S = \\frac{dU}{dz}$ 是速度切变，$N^2$ 是浮力频率的平方。浮力频率由密度梯度决定：$N^2 = -\\frac{g}{\\rho_0} \\frac{d\\rho}{dz}$。\n根据给定的密度模型 $\\rho(z) = \\rho_0 + \\alpha C(z)$，密度梯度为：\n$$\\frac{d\\rho}{dz} = \\alpha \\frac{dC}{dz}$$\n在高度 $z_b = 0.05 \\, \\mathrm{m}$ 处，代入给定值：\n$$\\left.\\frac{d\\rho}{dz}\\right|_{z_b} = 0.5 \\times (-10 \\, \\mathrm{kg\\,m^{-4}}) = -5 \\, \\mathrm{kg\\,m^{-4}}$$\n这表明密度随高度减小，水柱是稳定分层的。\n现在计算浮力频率的平方：\n$$N^2 = -\\frac{g}{\\rho_0} \\frac{d\\rho}{dz} = -\\frac{9.81 \\, \\mathrm{m/s^2}}{1025 \\, \\mathrm{kg/m^3}} \\times (-5 \\, \\mathrm{kg/m^4}) \\approx 0.047854 \\, \\mathrm{s^{-2}}$$\n利用给定的速度切变 $S = 2 \\, \\mathrm{s^{-1}}$，可以计算梯度理查森数：\n$$Ri = \\frac{N^2}{S^2} = \\frac{0.047854 \\, \\mathrm{s^{-2}}}{(2 \\, \\mathrm{s^{-1}})^2} \\approx 0.0119635$$\n\n**步骤2：计算中性涡扩散系数 ($K_0$)**\n在中性（未分层）条件下，涡扩散系数 $K_0$ 由混合长度 $l_m$ 和速度切变 $S$ 决定。\n混合长度为 $l_m = \\kappa z_b = 0.4 \\times 0.05 \\, \\mathrm{m} = 0.02 \\, \\mathrm{m}$。\n根据问题给出的公式 $K_0 = l_m^2 S$：\n$$K_0 = (0.02 \\, \\mathrm{m})^2 \\times (2 \\, \\mathrm{s^{-1}}) = 0.0008 \\, \\mathrm{m^2/s}$$\n\n**步骤3：计算分层涡扩散系数 ($K_c$)**\n分层通过一个稳定性函数 $\\Phi_c(Ri)$ 抑制湍流混合，该函数将分层扩散系数 $K_c$ 与中性扩散系数 $K_0$ 联系起来：$K_c = K_0 \\cdot \\Phi_c(Ri)$。\n问题要求一个在 $Ri = Ri_c$ 时混合消失的一阶闭合方案。一个满足此条件的常用形式是：\n$$\\Phi_c(Ri) = 1 - \\frac{Ri}{Ri_c}$$\n代入临界理查森数 $Ri_c = 0.25$：\n$$K_c = K_0 \\left(1 - \\frac{Ri}{Ri_c}\\right) = (0.0008 \\, \\mathrm{m^2/s}) \\times \\left(1 - \\frac{0.0119635}{0.25}\\right)$$\n$$K_c = (0.0008 \\, \\mathrm{m^2/s}) \\times (1 - 0.047854)$$\n$$K_c = (0.0008 \\, \\mathrm{m^2/s}) \\times (0.952146) \\approx 0.0007617168 \\, \\mathrm{m^2/s}$$\n将结果四舍五入到四位有效数字，得到：\n$$K_c \\approx 0.0007617 \\, \\mathrm{m^2/s}$$",
            "answer": "$$\\boxed{0.0007617}$$"
        },
        {
            "introduction": "将连续的偏微分方程转化为稳健的计算机代码是计算海洋学的核心任务。本练习要求您为推移质输运问题实现一个Godunov型数值通量，这是现代有限体积法中的前沿技术。您将应用HLL（Harten-Lax-van Leer）近似黎曼求解器计算界面处的水动力状态，并结合经典的Meyer-Peter–Müller公式来确定泥沙通量，从而将水动力学与泥沙动力学在数值层面耦合起来。",
            "id": "3800731",
            "problem": "您的任务是在计算海洋学中，为进入泥沙质量守恒（Exner）方程的推移质输运实现一个一维 Godunov 型数值通量。请从第一性原理和广泛接受的闭合关系出发，设计一个算法，使用近似黎曼求解器确定水动力界面状态，以计算在有限体积法中使用的界面推移质通量。您的最终程序必须为一组给定的左右状态计算界面处的 Exner 通量，并为指定的测试套件输出结果。\n\n使用的基本原理：\n- 泥沙质量守恒（Exner 方程）：床面高程 $z_b(x,t)$ 的演变遵循\n$$\n\\frac{\\partial z_b}{\\partial t} + \\frac{1}{1-\\lambda_p} \\frac{\\partial q_s}{\\partial x} = 0,\n$$\n其中 $q_s(x,t)$ 是单位宽度的推移质输运率，$\\lambda_p$ 是床面孔隙率。\n- 浅水水动力学：守恒变量为 $U = [h, h u]^\\top$，其中 $h(x,t)$ 是水深，$u(x,t)$ 是水深平均流速；通量函数为 $F(U) = [h u, h u^2 + \\tfrac{1}{2} g h^2]^\\top$。特征速度为 $u \\pm \\sqrt{g h}$。\n- 通过 Meyer-Peter–Müller 公式的推移质输运闭合关系：定义 Shields 参数\n$$\n\\theta^\\ast = \\frac{\\tau_b}{(\\rho_s - \\rho_w) g D},\n$$\n其中床面切应力建模为\n$$\n\\tau_b = \\rho_w C_f u^2,\n$$\n其中 $\\rho_w$ 是水体密度，$\\rho_s$ 是泥沙密度，$g$ 是重力加速度，$D$ 是粒径，$C_f$ 是无量纲摩擦系数。当 $\\theta^\\ast  \\theta_c$ 时，无量纲推移质输运率为\n$$\n\\Phi_b = 8\\left(\\theta^\\ast - \\theta_c\\right)^{3/2},\n$$\n推移质输运量级为\n$$\nq_b = \\Phi_b \\sqrt{(s - 1) g D^3},\\quad s = \\frac{\\rho_s}{\\rho_w}.\n$$\n如果 $\\theta^\\ast \\le \\theta_c$，则设 $q_b = 0$。\n- 坡度修正：通过应用于量级的乘法因子来考虑平缓的顺流向河床坡度 $S_b$，\n$$\nq_b' = q_b \\max\\left(0, 1 - \\beta_s S_b\\right),\\quad S_b \\approx \\frac{z_{b,R} - z_{b,L}}{\\Delta x},\n$$\n并使用从水动力黎曼求解器获得的界面速度 $u^\\ast$ 的符号 $\\operatorname{sign}(u^\\ast)$ 来确定输运方向。\n\n近似黎曼求解器策略：\n- 使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器，根据从特征速度 $u \\pm \\sqrt{g h}$ 计算出的极值波速 $S_L$ 和 $S_R$，从左右状态 $(h_L,u_L)$ 和 $(h_R,u_R)$ 构建界面水动力状态 $U^\\ast$。\n- 从 $U^\\ast$ 中提取 $h^\\ast$ 和 $u^\\ast = (h u)^\\ast / h^\\ast$（并对水深趋于零的情况进行适当的保护处理），然后如上所述评估 $q_b'$ 并构建 Exner 数值通量\n$$\n\\mathcal{F}_{\\text{Exner}} = \\frac{q_b'}{1 - \\lambda_p}.\n$$\n\n单位与输出：\n- 所有物理量必须采用国际单位制处理：水深单位为米（$\\mathrm{m}$），速度单位为米/秒（$\\mathrm{m/s}$），密度单位为千克/立方米（$\\mathrm{kg/m^3}$），重力加速度单位为米/平方秒（$\\mathrm{m/s^2}$），粒径单位为米（$\\mathrm{m}$），推移质和 Exner 通量单位为平方米/秒（$\\mathrm{m^2/s}$）每单位宽度。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[r_1,r_2,\\dots]$，其中每个 $r_i$ 是相应测试用例的 Exner 数值通量 $\\mathcal{F}_{\\text{Exner}}$，单位为 $\\mathrm{m^2/s}$。\n\n测试套件：\n对于每个测试用例，您将获得左右水动力和床面状态及材料参数，形式为一个元组\n$$\n(h_L, u_L, h_R, u_R, z_{b,L}, z_{b,R}, D, \\lambda_p, C_f, \\beta_s, \\Delta x, g, \\rho_w, \\rho_s, \\theta_c),\n$$\n所有单位均如上所述。请使用以下五个案例：\n- 案例 1: $(3.0, 1.2, 2.5, 1.0, 0.0, 0.05, 0.0005, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n- 案例 2: $(2.0, 0.2, 2.0, 0.15, 0.1, 0.099, 0.0010, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n- 案例 3: $(1.0, 0.48, 1.1, 0.5, 0.0, -0.02, 0.0010, 0.35, 0.004, 0.5, 20.0, 9.81, 1025.0, 2650.0, 0.047)$\n- 案例 4: $(1.5, 1.4, 0.01, 0.0, 0.2, 0.21, 0.0007, 0.4, 0.005, 0.5, 5.0, 9.81, 1025.0, 2650.0, 0.047)$\n- 案例 5: $(2.0, 1.0, 2.5, -0.8, 0.0, 0.0, 0.0006, 0.4, 0.0045, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n\n要求：\n- 实现 Harten–Lax–van Leer (HLL) 近似黎曼求解器以计算界面水动力状态 $U^\\ast$。\n- 使用 Meyer-Peter–Müller 闭合关系和指定的坡度修正来计算 $q_b'$ 和 Exner 数值通量 $\\mathcal{F}_{\\text{Exner}}$。\n- 对于每个测试用例，计算并返回单个浮点数 $\\mathcal{F}_{\\text{Exner}}$，单位为 $\\mathrm{m^2/s}$。\n- 您的程序应生成单行输出，包含一个具有五个数值通量的列表，格式严格为 $[r_1,r_2,r_3,r_4,r_5]$，使用 Python 3.12 及指定的库。",
            "solution": "这项任务是为泥沙质量守恒（Exner）方程实现一个 Godunov 型数值通量，该方程用于地貌动力学建模的有限体积法中。该方法的核心是在每个单元界面求解一个局部黎曼问题，以确定控制通量的状态。该过程分为两个主要部分：首先，使用近似求解器求解水动力黎曼问题，找到界面流动状态；其次，利用此流动状态通过经验闭合关系计算推移质泥沙输运率。\n\n床面高程 $z_b(x,t)$ 的演变由泥沙床质量守恒的 Exner 方程描述：\n$$\n\\frac{\\partial z_b}{\\partial t} + \\frac{1}{1-\\lambda_p} \\frac{\\partial q_s}{\\partial x} = 0\n$$\n此处，$q_s(x,t)$ 是单位宽度的体积推移质输运率，$\\lambda_p$ 是泥沙床的孔隙率。在有限体积框架中，将此方程在一个控制体积上积分，会得到一个需要单元界面处数值通量 $\\mathcal{F}_{\\text{Exner}}$ 的更新公式。该通量与泥沙输运率的关系为 $\\mathcal{F}_{\\text{Exner}} = q_s / (1 - \\lambda_p)$。\n\n泥沙输运 $q_s$ 主要由上覆水流驱动，此处由一维浅水方程（SWE）建模。SWE 的守恒变量为 $U = [h, hu]^\\top$，其中 $h$ 是水深，$u$ 是水深平均流速。这些量的通量由向量 $F(U) = [hu, hu^2 + \\tfrac{1}{2}gh^2]^\\top$ 给出，其中 $g$ 是重力加速度。该系统是双曲型的，其特征速度（特征值）为 $\\lambda = u \\pm \\sqrt{gh}$。\n\n床面与水流之间的耦合处理方式是假设在水动力黎曼问题的快速时间尺度上，床面是固定的。首先求解水动力学，然后利用得到的界面流动状态来计算泥沙输运，而泥沙输运反过来在较慢的时间尺度上驱动床面演变。\n\n**步骤 1：通过 HLL 黎曼求解器获得水动力界面状态**\n\n在左状态 $(h_L, u_L)$ 和右状态 $(h_R, u_R)$ 之间的界面上，形成一个黎曼问题。我们使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器来寻找界面水动力状态。HLL 求解器近似了黎曼扇内的解，该扇由最慢和最快的波速 $S_L$ 和 $S_R$ 界定。估算这些速度的标准方法是取左右状态特征速度的最小值和最大值：\n$$\nS_L = \\min(u_L - \\sqrt{gh_L}, u_R - \\sqrt{gh_R})\n$$\n$$\nS_R = \\max(u_L + \\sqrt{gh_L}, u_R + \\sqrt{gh_R})\n$$\nHLL 求解器假设在 $S_L  x/t  S_R$ 定义的区域内存在一个单一的恒定状态 $U^\\ast = [h^\\ast, (hu)^\\ast]^\\top$。界面（$x/t=0$）处的状态由 $S_L$ 和 $S_R$ 的符号决定：\n- 如果 $S_L \\ge 0$，整个波结构向右传播，界面处的状态为左状态 $U_L$。\n- 如果 $S_R \\le 0$，整个波结构向左传播，界面处的状态为右状态 $U_R$。\n- 如果 $S_L  0  S_R$，界面位于“星”区内。HLL 平均状态 $U^\\ast$ 由下式给出：\n$$\nU^\\ast = \\frac{S_R U_R - S_L U_L - (F_R - F_L)}{S_R - S_L}\n$$\n其中 $U_L = [h_L, h_L u_L]^\\top$，$U_R = [h_R, h_R u_R]^\\top$，$F_L, F_R$ 是相应的 SWE 通量向量。从守恒状态 $U^\\ast$ 中，我们提取界面流的原始变量：水深 $h^\\ast$ 和速度 $u^\\ast = (hu)^\\ast / h^\\ast$。对于 $h^\\ast$ 接近零的情况，需要采取保护措施，此时可将 $u^\\ast$ 设为零。\n\n**步骤 2：推移质输运计算**\n\n确定界面速度 $u^\\ast$ 后，我们使用 Meyer-Peter–Müller (MPM) 经验公式计算推移质输运率。\n首先，我们计算由水流引起的床面切应力 $\\tau_b^\\ast$，其通过二次摩擦定律建模：\n$$\n\\tau_b^\\ast = \\rho_w C_f (u^\\ast)^2\n$$\n其中 $\\rho_w$ 是水体密度，$C_f$ 是无量纲摩擦系数。\n\n接下来，我们计算 Shields 参数 $\\theta^\\ast$，它是切应力的无量纲度量：\n$$\n\\theta^{\\ast\\ast} = \\frac{\\tau_b^\\ast}{(\\rho_s - \\rho_w) g D}\n$$\n其中 $\\rho_s$ 是泥沙密度，$D$ 是中值粒径。\n\nMPM 公式包含一个临界 Shields 参数 $\\theta_c$，代表运动的起动阈值。只有当 $\\theta^{\\ast\\ast} > \\theta_c$ 时才会发生泥沙输运。如果满足此条件，无量纲推移质输运率 $\\Phi_b$ 为：\n$$\n\\Phi_b^\\ast = 8 (\\theta^{\\ast\\ast} - \\theta_c)^{3/2}\n$$\n如果 $\\theta^{\\ast\\ast} \\le \\theta_c$，则 $\\Phi_b^\\ast = 0$。\n\n推移质输运率的量纲量级 $q_b$ 通过缩放 $\\Phi_b$ 得到：\n$$\nq_b^\\ast = \\Phi_b^\\ast \\sqrt{(s-1)gD^3}\n$$\n其中 $s = \\rho_s / \\rho_w$ 是泥沙的比重。\n\n**步骤 3：坡度修正与最终 Exner 通量**\n\n局部河床坡度影响输运率。作用在泥沙颗粒上的重力下坡分量会增强输运，而上坡分量则会阻碍输运。这通过一个乘法修正因子来体现。首先，界面处的河床坡度 $S_b$ 使用相邻单元的床面高程 $z_{b,L}$ 和 $z_{b,R}$ 以及单元宽度 $\\Delta x$ 来近似：\n$$\nS_b = \\frac{z_{b,R} - z_{b,L}}{\\Delta x}\n$$\n修正后的推移质输运量级 $q_b'^\\ast$ 为：\n$$\nq_b'^\\ast = q_b^\\ast \\max(0, 1 - \\beta_s S_b)\n$$\n其中 $\\beta_s$ 是一个经验参数。$\\max(0, \\dots)$ 项防止了泥沙在非常陡峭的逆坡上输运。\n\n最后，推移质输运是一个矢量。其方向由水流方向决定。界面处的有向泥沙输运率 $q_s^\\ast$ 为：\n$$\nq_s^\\ast = \\operatorname{sign}(u^\\ast) q_b'^\\ast\n$$\n其中 $\\operatorname{sign}(u^\\ast)$ 在 $u^\\ast > 0$ 时为 $+1$，$u^\\ast  0$ 时为 $-1$，$u^\\ast = 0$ 时为 $0$。\n\n然后，Exner 方程的数值通量计算如下：\n$$\n\\mathcal{F}_{\\text{Exner}} = \\frac{q_s^\\ast}{1 - \\lambda_p}\n$$\n该值代表了跨界面的泥沙体积交换速率，并用活动层体积进行了归一化，用于在有限体积格式中更新床面高程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are imported.\n\ndef solve():\n    \"\"\"\n    Computes the Godunov-type Exner numerical flux for bedload transport for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (h_L, u_L, h_R, u_R, z_b_L, z_b_R, D, lambda_p, C_f, beta_s, delta_x, g, rho_w, rho_s, theta_c)\n        (3.0, 1.2, 2.5, 1.0, 0.0, 0.05, 0.0005, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047),\n        (2.0, 0.2, 2.0, 0.15, 0.1, 0.099, 0.0010, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047),\n        (1.0, 0.48, 1.1, 0.5, 0.0, -0.02, 0.0010, 0.35, 0.004, 0.5, 20.0, 9.81, 1025.0, 2650.0, 0.047),\n        (1.5, 1.4, 0.01, 0.0, 0.2, 0.21, 0.0007, 0.4, 0.005, 0.5, 5.0, 9.81, 1025.0, 2650.0, 0.047),\n        (2.0, 1.0, 2.5, -0.8, 0.0, 0.0, 0.0006, 0.4, 0.0045, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        h_L, u_L, h_R, u_R, z_b_L, z_b_R, D, lambda_p, C_f, beta_s, delta_x, g, rho_w, rho_s, theta_c = case\n        \n        # --- Step 1: HLL Approximate Riemann Solver ---\n        \n        # Handle dry states safely\n        h_L = max(0, h_L)\n        h_R = max(0, h_R)\n\n        c_L = np.sqrt(g * h_L)\n        c_R = np.sqrt(g * h_R)\n\n        # Estimate wave speeds (Davis, 1988)\n        S_L = min(u_L - c_L, u_R - c_R)\n        S_R = max(u_L + c_L, u_R + c_R)\n        \n        h_star, u_star = 0.0, 0.0\n\n        if S_L >= 0:\n            # Entire wave structure moves right, state at interface is Left state\n            h_star, u_star = h_L, u_L\n        elif S_R = 0:\n            # Entire wave structure moves left, state at interface is Right state\n            h_star, u_star = h_R, u_R\n        else: # S_L  0  S_R, interface is in star region\n            # Conservative states\n            U_L = np.array([h_L, h_L * u_L])\n            U_R = np.array([h_R, h_R * u_R])\n            \n            # Flux vectors\n            F_L = np.array([h_L * u_L, h_L * u_L**2 + 0.5 * g * h_L**2])\n            F_R = np.array([h_R * u_R, h_R * u_R**2 + 0.5 * g * h_R**2])\n            \n            # HLL-averaged state U*\n            if abs(S_R - S_L) > 1e-9:\n                U_star = (S_R * U_R - S_L * U_L - (F_R - F_L)) / (S_R - S_L)\n                h_star = U_star[0]\n                \n                # Safeguard for vanishing depth\n                if h_star > 1e-9:\n                    u_star = U_star[1] / h_star\n                else:\n                    h_star = 0.0\n                    u_star = 0.0 # No depth, no velocity\n            else: # States are nearly identical\n                h_star, u_star = (h_L + h_R) / 2, (u_L + u_R) / 2\n\n        # --- Step 2: Bedload Transport Calculation (Meyer-Peter-Müller) ---\n        \n        q_s_star = 0.0\n        \n        if h_star > 1e-9:\n            # Bed shear stress\n            tau_b_star = rho_w * C_f * u_star**2\n            \n            # Shields parameter\n            rho_diff_g_D = (rho_s - rho_w) * g * D\n            if rho_diff_g_D > 1e-9:\n                theta_star_star = tau_b_star / rho_diff_g_D\n            else:\n                theta_star_star = 0.0\n\n            if theta_star_star > theta_c:\n                # Dimensionless bedload transport rate\n                Phi_b_star = 8.0 * (theta_star_star - theta_c)**1.5\n                \n                # Dimensional bedload transport magnitude\n                s = rho_s / rho_w\n                q_b_star_factor = np.sqrt(max(0, s - 1.0) * g * D**3)\n                q_b_star = Phi_b_star * q_b_star_factor\n                \n                # --- Step 3: Slope Correction and Final Flux ---\n                \n                # Bed slope\n                S_b = (z_b_R - z_b_L) / delta_x\n                \n                # Corrected bedload magnitude\n                q_b_prime_star = q_b_star * max(0.0, 1.0 - beta_s * S_b)\n                \n                # Directed sediment transport rate\n                q_s_star = np.sign(u_star) * q_b_prime_star\n\n        # Exner numerical flux\n        exner_flux = q_s_star / (1.0 - lambda_p)\n        results.append(exner_flux)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}