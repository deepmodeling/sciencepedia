{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any morphodynamic model is the principle of mass conservation, mathematically expressed through the Exner equation. This first practice  provides a crucial exercise in deriving this equation from first principles. By considering the physical packing of sediment grains, you will connect the microscopic concept of porosity to the macroscopic rate of bed elevation change, learning to distinguish between the bulk transport of a sediment-fluid mixture and the net flux of solid grains that truly governs morphology.",
            "id": "3800701",
            "problem": "A one-dimensional, laterally uniform coastal sand bed is composed of equal-diameter, nearly spherical quartz grains. Assume the stationary bed is a random close packing of monodisperse spheres with solid volume fraction $0.64$. The near-bed moving layer is a dilated granular assembly approximated as a random loose packing with solid volume fraction $0.55$. Let the bed elevation relative to a fixed datum be $\\eta(x,t)$, where $x$ is the alongshore coordinate in meters and $t$ is time in seconds. The alongshore bulk volumetric bedload transport per unit width (that is, the volumetric flux of the moving mixture including its intergranular voids) is measured to vary linearly with $x$ as $q_{\\mathrm{bulk}}(x) = q_{0} + a x$, where $q_{0} = 2.50 \\times 10^{-4}$ and $a = 1.00 \\times 10^{-6}$; the units of $q_{0}$ and $q_{\\mathrm{bulk}}$ are cubic meters per second per meter of channel width, and the units of $a$ are cubic meters per second per meter squared.\n\nStarting from conservation of mass of the solid phase and the definition of porosity, (i) determine the bed porosity $\\lambda_{p}$ implied by the stated grain packing of the stationary bed, (ii) consistently relate the measured bulk volumetric transport $q_{\\mathrm{bulk}}(x)$ to the volumetric transport of solids, and (iii) use these to derive a local relation for the instantaneous bed elevation change rate $\\partial \\eta / \\partial t$ in terms of the spatial gradient $\\partial q_{\\mathrm{bulk}} / \\partial x$. Evaluate this rate at $x^{\\star} = 300$.\n\nReport the instantaneous bed elevation change rate $\\partial \\eta / \\partial t$ at $x^{\\star}$ as your final numerical answer. Express the final answer in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ and round to four significant figures.",
            "solution": "The problem requires the derivation and evaluation of the rate of change of bed elevation, $\\partial \\eta / \\partial t$, based on the principle of conservation of sediment mass. We begin by formalizing the relationship between bed elevation change and the spatial gradient of sediment transport, often known as the Exner equation.\n\nFirst, we address the three parts of the problem as requested.\n\n(i) Determine the bed porosity $\\lambda_{p}$.\nPorosity, $\\lambda_{p}$, is defined as the ratio of the volume of voids to the total volume of a porous medium. The solid volume fraction, which we denote as $\\phi$, is the ratio of the volume of solids to the total volume. By definition, for the stationary bed:\n$$ \\lambda_{p} + \\phi_{\\mathrm{bed}} = 1 $$\nThe problem states that the stationary bed is a random close packing with a solid volume fraction $\\phi_{\\mathrm{bed}} = 0.64$. Therefore, the bed porosity is:\n$$ \\lambda_{p} = 1 - \\phi_{\\mathrm{bed}} = 1 - 0.64 = 0.36 $$\n\n(ii) Relate the measured bulk volumetric transport $q_{\\mathrm{bulk}}(x)$ to the volumetric transport of solids.\nThe bulk volumetric transport rate, $q_{\\mathrm{bulk}}$, represents the volume of the moving mixture (solids plus interstitial fluid) passing a point per unit width per unit time. The volumetric solids transport rate, $q_{s}$, is the volume of only the solid grains transported. The relationship between them is determined by the solid volume fraction of the moving layer, $\\phi_{\\mathrm{moving}}$. The problem states this layer is a random loose packing with $\\phi_{\\mathrm{moving}} = 0.55$. The relationship is thus:\n$$ q_{s}(x) = \\phi_{\\mathrm{moving}} \\cdot q_{\\mathrm{bulk}}(x) $$\n\n(iii) Use these to derive a local relation for $\\partial \\eta / \\partial t$ and evaluate it.\nThe conservation of mass for the solid phase in the stationary bed is the core principle. Consider a one-dimensional control volume of the bed with an infinitesimal length $dx$ and a unit width. The volume of solids within this segment of the bed is $V_{s, \\mathrm{bed}} = \\phi_{\\mathrm{bed}} \\cdot \\eta \\cdot dx$. The rate of change of this solid volume must equal the net flux of solid volume into the control volume.\nThe rate of change of solid volume within the control volume is:\n$$ \\frac{\\partial V_{s, \\mathrm{bed}}}{\\partial t} = \\frac{\\partial}{\\partial t} (\\phi_{\\mathrm{bed}} \\eta \\, dx) = \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} dx $$\nHere, we assume the packing of the stationary bed, $\\phi_{\\mathrm{bed}}$, is constant over time.\nThe net flux of solids into the control volume is the difference between the flux entering at position $x$ and the flux exiting at position $x+dx$:\n$$ \\text{Net Flux} = q_{s}(x) - q_{s}(x+dx) $$\nFor an infinitesimal $dx$, this can be expressed using a first-order Taylor expansion: $q_{s}(x+dx) \\approx q_{s}(x) + \\frac{\\partial q_{s}}{\\partial x} dx$. The net flux is then:\n$$ \\text{Net Flux} \\approx q_{s}(x) - \\left( q_{s}(x) + \\frac{\\partial q_{s}}{\\partial x} dx \\right) = -\\frac{\\partial q_{s}}{\\partial x} dx $$\nEquating the rate of change of volume with the net flux (the principle of conservation) gives:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} dx = -\\frac{\\partial q_{s}}{\\partial x} dx $$\nDividing by $dx$ yields the one-dimensional Exner equation for sediment continuity:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\partial q_{s}}{\\partial x} $$\nNote that $\\phi_{\\mathrm{bed}}$ is equivalent to $(1-\\lambda_p)$.\n\nNow, we substitute the expression for $q_s$ from part (ii) into the Exner equation:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left( \\phi_{\\mathrm{moving}} q_{\\mathrm{bulk}}(x) \\right) $$\nThe problem states that the moving layer is a random loose packing, which implies its solid volume fraction $\\phi_{\\mathrm{moving}}$ is also a constant. We can therefore move it outside the spatial derivative:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\phi_{\\mathrm{moving}} \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} $$\nSolving for the rate of bed elevation change, $\\partial \\eta / \\partial t$, we obtain the desired relation:\n$$ \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\phi_{\\mathrm{moving}}}{\\phi_{\\mathrm{bed}}} \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} $$\nThe problem specifies the bulk transport rate as a linear function of $x$:\n$$ q_{\\mathrm{bulk}}(x) = q_{0} + a x $$\nwhere $q_{0} = 2.50 \\times 10^{-4} \\, \\mathrm{m^2 \\, s^{-1}}$ and $a = 1.00 \\times 10^{-6} \\, \\mathrm{m \\, s^{-1}}$.\nThe spatial gradient of the bulk transport is therefore a constant:\n$$ \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} = \\frac{\\partial}{\\partial x}(q_{0} + a x) = a $$\nSubstituting this result into our expression for $\\partial \\eta / \\partial t$:\n$$ \\frac{\\partial \\eta}{\\partial t} = -a \\frac{\\phi_{\\mathrm{moving}}}{\\phi_{\\mathrm{bed}}} $$\nThis shows that the rate of bed elevation change is uniform along the entire-shore, i.e., it is not a function of $x$. Thus, the value at $x^{\\star} = 300 \\, \\mathrm{m}$ is the same as everywhere else.\n\nFinally, we substitute the numerical values provided:\n$$ \\phi_{\\mathrm{bed}} = 0.64 $$\n$$ \\phi_{\\mathrm{moving}} = 0.55 $$\n$$ a = 1.00 \\times 10^{-6} \\, \\mathrm{m \\, s^{-1}} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -(1.00 \\times 10^{-6}) \\frac{0.55}{0.64} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -(1.00 \\times 10^{-6}) \\times 0.859375 \\, \\mathrm{m \\, s^{-1}} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -8.59375 \\times 10^{-7} \\, \\mathrm{m \\, s^{-1}} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\frac{\\partial \\eta}{\\partial t} \\approx -8.594 \\times 10^{-7} \\, \\mathrm{m \\, s^{-1}} $$\nThe negative sign indicates that the bed is eroding, which is expected since the transport rate increases with $x$ ($\\partial q_{\\mathrm{bulk}}/\\partial x  0$), meaning more sediment leaves any given region than enters it.",
            "answer": "$$\\boxed{-8.594 \\times 10^{-7}}$$"
        },
        {
            "introduction": "A correct continuous model is only useful if it can be solved accurately on a computer. This computational practice  delves into the critical choice of numerical time-stepping schemes for coupled systems like sediment-flow interaction. By implementing and comparing a \"loose\" (explicit) coupling scheme with a \"strong\" (implicit) one, you will gain firsthand experience with their profound differences in ensuring numerical stability and strict mass conservation, properties that are essential for the long-term predictive power of any morphodynamic model.",
            "id": "3800686",
            "problem": "Consider a one-dimensional, depth-averaged open-channel flow of seawater with suspended sediment, represented by a control volume of constant depth and cross-section. The fluid velocity and sediment concentration are coupled through buoyancy and bed exchange. You will implement and compare two numerical coupling schemes—loose coupling versus strong coupling—for the evolution of the flow velocity and sediment concentration, and quantify errors in sediment mass conservation and momentum closure.\n\nFundamental base and governing relations:\n\n- Start from Newton's Second Law for the depth-averaged horizontal momentum of the control volume. Under the Boussinesq approximation (BA), with density variations entering only through buoyancy, the depth-averaged velocity $u(t)$ obeys\n$$\n\\frac{du}{dt} = g S \\left(1 + \\frac{c}{\\rho_0}\\right) - \\frac{C_f}{H} u |u| ,\n$$\nwhere $g$ is gravitational acceleration, $S$ is the bed slope (dimensionless), $H$ is the water depth, $\\rho_0$ is the reference water density, $C_f$ is a dimensionless bed-friction coefficient, and $c(t)$ is the suspended sediment concentration in units of kilograms per cubic meter.\n\n- Sediment mass conservation holds separately for the water column and the bed. Let $B(t)$ denote the bed sediment mass per unit area in kilograms per square meter. The column-integrated suspended mass per unit area is $H c$. The exchange fluxes are erosion $e(u)$ upward from the bed and deposition $w_s c$ downward, both in kilograms per square meter per second. The continuous-time mass balances are\n$$\n\\frac{d(H c)}{dt} = e(u) - w_s c, \\quad \\frac{dB}{dt} = -e(u) + w_s c,\n$$\nensuring that the total sediment mass per unit area $M_{\\mathrm{tot}}(t) = H c(t) + B(t)$ is conserved.\n\n- The bed shear stress is modeled as\n$$\n\\tau_b(u) = \\rho_0 C_f u^2,\n$$\nand the erosion flux follows a threshold law\n$$\ne(u) = M \\max\\!\\left( \\frac{\\tau_b(u) - \\tau_c}{\\tau_c}, \\, 0 \\right),\n$$\nwhere $M$ is an erosion rate coefficient in kilograms per square meter per second, $\\tau_c$ is the critical shear stress in pascals, and $w_s$ is the particle settling velocity in meters per second.\n\nNumerical schemes to implement:\n\n- Loose coupling (sequential, explicitly decoupled):\n  - Update velocity using the previous concentration:\n  $$\n  u^{n+1} = u^n + \\Delta t \\left[ g S \\left(1 + \\frac{c^n}{\\rho_0}\\right) - \\frac{C_f}{H} u^n |u^n| \\right].\n  $$\n  - Update suspended concentration using the erosion evaluated at the newly updated velocity but using the old concentration for deposition:\n  $$\n  c^{n+1} = c^n + \\frac{\\Delta t}{H} \\left[ e(u^{n+1}) - w_s c^n \\right].\n  $$\n  - Update bed mass using the previous-step fluxes:\n  $$\n  B^{n+1} = B^n - \\Delta t \\left[ e(u^n) - w_s c^n \\right].\n  $$\n  This scheme may introduce inconsistency between the bed and water-column fluxes within a time step.\n\n- Strong coupling (simultaneous, fully implicit for state variables):\n  - Solve for $u^{n+1}$ and $c^{n+1}$ simultaneously from\n  $$\n  u^{n+1} = u^n + \\Delta t \\left[ g S \\left(1 + \\frac{c^{n+1}}{\\rho_0}\\right) - \\frac{C_f}{H} u^{n+1} |u^{n+1}| \\right],\n  $$\n  $$\n  H c^{n+1} = H c^n + \\Delta t \\left[ e(u^{n+1}) - w_s c^{n+1} \\right],\n  $$\n  and then update the bed mass consistently at the same time level:\n  $$\n  B^{n+1} = B^n - \\Delta t \\left[ e(u^{n+1}) - w_s c^{n+1} \\right].\n  $$\n  The discrete total mass $H c^{n+1} + B^{n+1}$ is preserved to within the solver tolerance.\n\nError metrics to compute:\n\n- Sediment mass conservation error at the final time $T$:\n$$\n\\varepsilon_{\\mathrm{mass}} = \\frac{\\left| \\left( H c(T) + B(T) \\right) - \\left( H c(0) + B(0) \\right) \\right|}{H c(0) + B(0)},\n$$\nwhich is dimensionless.\n\n- Momentum closure residual over the simulation, measured as the root-mean-square (RMS) of the stepwise residual using midpoint evaluations:\n$$\nr_k = \\frac{u^{k+1} - u^{k}}{\\Delta t} - \\left[ g S \\left(1 + \\frac{c^{k+1/2}}{\\rho_0}\\right) - \\frac{C_f}{H} u^{k+1/2} \\left| u^{k+1/2} \\right| \\right],\n$$\n$$\nu^{k+1/2} = \\frac{u^k + u^{k+1}}{2}, \\quad c^{k+1/2} = \\frac{c^k + c^{k+1}}{2},\n$$\nand the RMS is\n$$\n\\varepsilon_{\\mathrm{mom}} = \\sqrt{ \\frac{1}{N} \\sum_{k=0}^{N-1} r_k^2 },\n$$\nwith units of meters per second squared, where $N$ is the number of time steps.\n\nTask:\n\n- Implement both coupling schemes to integrate the system from time $t=0$ to $t=T$ for several parameter sets.\n- For each test case, compute and return four numbers: the sediment mass conservation error for the loose scheme, the sediment mass conservation error for the strong scheme, the momentum closure RMS residual for the loose scheme, and the momentum closure RMS residual for the strong scheme.\n\nUnits and numerical details:\n\n- Use the International System of Units (SI). All inputs and outputs must be in SI units.\n- The momentum closure RMS residual must be reported in meters per second squared.\n- The mass conservation error must be reported as a dimensionless ratio.\n\nTest suite:\n\nProvide results for the following three test cases. For all cases, gravitational acceleration is $g = 9.81 \\, \\mathrm{m/s^2}$ and reference density is $\\rho_0 = 1025 \\, \\mathrm{kg/m^3}$. The suspended sediment concentration $c$ is in $\\mathrm{kg/m^3}$, the bed mass per unit area $B$ is in $\\mathrm{kg/m^2}$, and velocity $u$ is in $\\mathrm{m/s}$.\n\n- Case $1$ (happy path, moderate slope, fine mud):\n  - $H = 10 \\, \\mathrm{m}$, $S = 1.0 \\times 10^{-4}$, $C_f = 3.0 \\times 10^{-3}$, $\\tau_c = 0.20 \\, \\mathrm{Pa}$, $M = 5.0 \\times 10^{-5} \\, \\mathrm{kg/(m^2 \\, s)}$, $w_s = 1.0 \\times 10^{-3} \\, \\mathrm{m/s}$,\n  - $u_0 = 0.30 \\, \\mathrm{m/s}$, $c_0 = 0.10 \\, \\mathrm{kg/m^3}$, $B_0 = 10.0 \\, \\mathrm{kg/m^2}$,\n  - $\\Delta t = 2.0 \\, \\mathrm{s}$, $T = 1800.0 \\, \\mathrm{s}$.\n\n- Case $2$ (boundary condition near erosion threshold):\n  - $H = 10 \\, \\mathrm{m}$, $S = 1.0 \\times 10^{-4}$, $C_f = 3.0 \\times 10^{-3}$, $\\tau_c = 0.20 \\, \\mathrm{Pa}$, $M = 1.0 \\times 10^{-5} \\, \\mathrm{kg/(m^2 \\, s)}$, $w_s = 1.0 \\times 10^{-3} \\, \\mathrm{m/s}$,\n  - $u_0 = 0.25 \\, \\mathrm{m/s}$, $c_0 = 0.05 \\, \\mathrm{kg/m^3}$, $B_0 = 8.0 \\, \\mathrm{kg/m^2}$,\n  - $\\Delta t = 5.0 \\, \\mathrm{s}$, $T = 1800.0 \\, \\mathrm{s}$.\n\n- Case $3$ (edge case with coarse time step and faster settling):\n  - $H = 5 \\, \\mathrm{m}$, $S = 1.5 \\times 10^{-4}$, $C_f = 3.0 \\times 10^{-3}$, $\\tau_c = 0.20 \\, \\mathrm{Pa}$, $M = 5.0 \\times 10^{-5} \\, \\mathrm{kg/(m^2 \\, s)}$, $w_s = 2.0 \\times 10^{-3} \\, \\mathrm{m/s}$,\n  - $u_0 = 0.40 \\, \\mathrm{m/s}$, $c_0 = 0.20 \\, \\mathrm{kg/m^3}$, $B_0 = 12.0 \\, \\mathrm{kg/m^2}$,\n  - $\\Delta t = 30.0 \\, \\mathrm{s}$, $T = 3600.0 \\, \\mathrm{s}$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\"). The list must contain $12$ floats in the following order:\n$$\n[\\varepsilon_{\\mathrm{mass}}^{\\mathrm{loose}}(\\text{case }1), \\, \\varepsilon_{\\mathrm{mass}}^{\\mathrm{strong}}(\\text{case }1), \\, \\varepsilon_{\\mathrm{mom}}^{\\mathrm{loose}}(\\text{case }1), \\, \\varepsilon_{\\mathrm{mom}}^{\\mathrm{strong}}(\\text{case }1), \\,\n\\varepsilon_{\\mathrm{mass}}^{\\mathrm{loose}}(\\text{case }2), \\, \\varepsilon_{\\mathrm{mass}}^{\\mathrm{strong}}(\\text{case }2), \\, \\varepsilon_{\\mathrm{mom}}^{\\mathrm{loose}}(\\text{case }2), \\, \\varepsilon_{\\mathrm{mom}}^{\\mathrm{strong}}(\\text{case }2), \\,\n\\varepsilon_{\\mathrm{mass}}^{\\mathrm{loose}}(\\text{case }3), \\, \\varepsilon_{\\mathrm{mass}}^{\\mathrm{strong}}(\\text{case }3), \\, \\varepsilon_{\\mathrm{mom}}^{\\mathrm{loose}}(\\text{case }3), \\, \\varepsilon_{\\mathrm{mom}}^{\\mathrm{strong}}(\\text{case }3)].\n$$",
            "solution": "The user has requested the implementation and comparison of two numerical coupling schemes—loose versus strong—for a simplified one-dimensional sediment transport model. The analysis involves solving a system of coupled ordinary differential equations (ODEs) for fluid velocity $u(t)$ and suspended sediment concentration $c(t)$, and then quantifying the errors in sediment mass conservation and momentum closure for each scheme.\n\n**1. Problem Formulation**\n\nThe physical system is described by a set of coupled ODEs. The depth-averaged fluid velocity $u(t)$ is governed by the momentum equation, which balances acceleration against the driving force of gravity on a slope (including buoyancy effects from suspended sediment) and the retarding force of bed friction:\n$$\n\\frac{du}{dt} = g S \\left(1 + \\frac{c}{\\rho_0}\\right) - \\frac{C_f}{H} u |u|\n$$\nThe suspended sediment concentration $c(t)$ is governed by a mass balance equation for the water column, accounting for erosion from the bed, $e(u)$, and deposition to the bed, $d(c) = w_s c$:\n$$\n\\frac{d(H c)}{dt} = e(u) - w_s c\n$$\nThe erosion flux $e(u)$ is a function of the bed shear stress $\\tau_b(u) = \\rho_0 C_f u^2$, and is non-zero only when this stress exceeds a critical threshold $\\tau_c$:\n$$\ne(u) = M \\max\\!\\left( \\frac{\\tau_b(u) - \\tau_c}{\\tau_c}, \\, 0 \\right)\n$$\nThe bed mass per unit area, $B(t)$, changes according to the net flux at the bed-water interface, ensuring that the total mass $H c(t) + B(t)$ is conserved in the continuous system.\n\n**2. Numerical Schemes and Implementation**\n\nThe core of the task is to discretize this system in time using two different coupling strategies and step from an initial state $(u_0, c_0, B_0)$ at $t=0$ to a final time $t=T$ with a time step $\\Delta t$.\n\n**2.1. Loose Coupling Scheme (Explicit Sequential)**\n\nThis scheme updates the state variables sequentially, using values from the previous time step to calculate the new state. This is computationally inexpensive but can introduce inconsistencies and numerical errors.\nThe steps at each time level $n$ to find the state at $n+1$ are:\n1.  Update velocity $u^{n+1}$: The right-hand side of the momentum equation is evaluated entirely at time $n$. This is a simple Forward Euler step.\n    $$u^{n+1} = u^n + \\Delta t \\left[ g S \\left(1 + \\frac{c^n}{\\rho_0}\\right) - \\frac{C_f}{H} u^n |u^n| \\right]$$\n2.  Update concentration $c^{n+1}$: The concentration equation is updated using the newly computed velocity $u^{n+1}$ for the erosion term, but the old concentration $c^n$ for the deposition term.\n    $$c^{n+1} = c^n + \\frac{\\Delta t}{H} \\left[ e(u^{n+1}) - w_s c^n \\right]$$\n3.  Update bed mass $B^{n+1}$: According to the problem statement, the bed mass is updated using fluxes evaluated entirely at the old time step $n$.\n    $$B^{n+1} = B^n - \\Delta t \\left[ e(u^n) - w_s c^n \\right]$$\nThe key issue here is the inconsistency in the erosion flux calculation. The water column gains mass based on $e(u^{n+1})$ while the bed loses mass based on $e(u^n)$. This leads to a violation of discrete mass conservation.\n\n**2.2. Strong Coupling Scheme (Implicit Simultaneous)**\n\nThis scheme solves for the new state variables $u^{n+1}$ and $c^{n+1}$ simultaneously, ensuring that the coupling terms are mutually consistent at the new time level. This is a form of the Backward Euler method, which is typically more stable and accurate for stiff systems, albeit more computationally intensive.\nThe scheme requires solving the following system of non-linear algebraic equations for $(u^{n+1}, c^{n+1})$:\n$$\nu^{n+1} - u^n - \\Delta t \\left[ g S \\left(1 + \\frac{c^{n+1}}{\\rho_0}\\right) - \\frac{C_f}{H} u^{n+1} |u^{n+1}| \\right] = 0\n$$\n$$\nH c^{n+1} - H c^n - \\Delta t \\left[ e(u^{n+1}) - w_s c^{n+1} \\right] = 0\n$$\nThis system can be simplified. The second equation can be rearranged to express $c^{n+1}$ as an explicit function of $u^{n+1}$:\n$$\nc^{n+1}(H + \\Delta t w_s) = H c^n + \\Delta t \\, e(u^{n+1}) \\implies c^{n+1} = \\frac{H c^n + \\Delta t \\, e(u^{n+1})}{H + \\Delta t w_s}\n$$\nSubstituting this expression for $c^{n+1}$ into the first equation yields a single non-linear scalar equation for $u^{n+1}$:\n$$\nf(u^{n+1}) = u^{n+1} - u^n - \\Delta t \\left[ g S \\left(1 + \\frac{1}{\\rho_0}\\left(\\frac{H c^n + \\Delta t \\, e(u^{n+1})}{H + \\Delta t w_s}\\right)\\right) - \\frac{C_f}{H} u^{n+1} |u^{n+1}| \\right] = 0\n$$\nThis scalar equation $f(x)=0$ for $x=u^{n+1}$ can be solved efficiently using a numerical root-finding algorithm. Since the function $f(x)$ is monotonic for $x \\ge 0$, a robust bracketing method like Brent's method is suitable. We will use `scipy.optimize.root_scalar` for this purpose. Once $u^{n+1}$ is found, $c^{n+1}$ is calculated directly.\nThe bed mass is then updated consistently with the fluxes at time $n+1$:\n$$\nB^{n+1} = B^n - \\Delta t \\left[ e(u^{n+1}) - w_s c^{n+1} \\right]\n$$\nThis construction guarantees that $(H c^{n+1} + B^{n+1}) - (H c^n + B^n) = 0$ at each step, thus conserving total sediment mass to within the tolerance of the numerical solver.\n\n**3. Error Quantification**\n\nTwo metrics are computed to evaluate the performance of each scheme.\n\n- **Sediment Mass Conservation Error ($\\varepsilon_{\\mathrm{mass}}$)**: This dimensionless metric quantifies the failure to conserve the total sediment mass $(H c + B)$ over the entire simulation. It is calculated as the absolute difference between the final and initial total mass, normalized by the initial total mass. For the strong coupling scheme, this error is expected to be near machine precision. For the loose coupling scheme, as specified, the error arises from the mismatch $e(u^{n+1}) - e(u^n)$ in each time step.\n\n- **Momentum Closure Residual ($\\varepsilon_{\\mathrm{mom}}$)**: This metric measures how well the numerical solution satisfies the original momentum ODE. It is computed as the Root-Mean-Square (RMS) of the residuals $r_k$ at each time step $k$, where $r_k$ is the difference between the finite-difference approximation of the time derivative and the forcing terms evaluated at the time-step's midpoint:\n  $$r_k = \\frac{u^{k+1} - u^{k}}{\\Delta t} - \\left[ g S \\left(1 + \\frac{c^{k+1/2}}{\\rho_0}\\right) - \\frac{C_f}{H} u^{k+1/2} \\left| u^{k+1/2} \\right| \\right]$$\n  where $u^{k+1/2}$ and $c^{k+1/2}$ are the arithmetic means of the values at steps $k$ and $k+1$. A smaller residual indicates a solution that is more consistent with the continuous governing equation.\n\n**4. Algorithmic Procedure**\n\nThe overall algorithm is as follows:\n1.  Initialize constants $g$ and $\\rho_0$.\n2.  For each test case provided:\n    a. Set model parameters ($H, S, C_f, \\dots$), initial conditions ($u_0, c_0, B_0$), and time-stepping parameters ($\\Delta t, T$).\n    b. **Loose Coupling Simulation**:\n        i.   Initialize arrays to store the history of $u$ and $c$.\n        ii.  Iterate from $t=0$ to $T$, applying the loose coupling update rules at each step.\n        iii. After the final step, compute $\\varepsilon_{\\mathrm{mass}}^{\\mathrm{loose}}$ and $\\varepsilon_{\\mathrm{mom}}^{\\mathrm{loose}}$.\n    c. **Strong Coupling Simulation**:\n        i.   Initialize arrays to store the history of $u$ and $c$.\n        ii.  Iterate from $t=0$ to $T$. At each step, solve the non-linear equation for $u^{n+1}$ using `scipy.optimize.root_scalar`, then compute $c^{n+1}$ and $B^{n+1}$.\n        iii. After the final step, compute $\\varepsilon_{\\mathrm{mass}}^{\\mathrm{strong}}$ and $\\varepsilon_{\\mathrm{mom}}^{\\mathrm{strong}}$.\n    d. Collate the four computed error metrics for the current test case.\n3.  Combine the results from all test cases into a single list and format for final output.\n\nThis procedure will be implemented in Python, utilizing `numpy` for numerical operations and `scipy.optimize` for the root-finding step in the strong coupling scheme.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the sediment transport problem for three test cases using both\n    loose and strong coupling schemes and computes specified error metrics.\n    \"\"\"\n    g = 9.81  # Gravitational acceleration [m/s^2]\n    rho0 = 1025.0  # Reference water density [kg/m^3]\n\n    test_cases = [\n        # Case 1 (happy path, moderate slope, fine mud)\n        {\n            \"H\": 10.0, \"S\": 1.0e-4, \"Cf\": 3.0e-3, \"tau_c\": 0.20, \"M\": 5.0e-5, \"ws\": 1.0e-3,\n            \"u0\": 0.30, \"c0\": 0.10, \"B0\": 10.0,\n            \"dt\": 2.0, \"T\": 1800.0\n        },\n        # Case 2 (boundary condition near erosion threshold)\n        {\n            \"H\": 10.0, \"S\": 1.0e-4, \"Cf\": 3.0e-3, \"tau_c\": 0.20, \"M\": 1.0e-5, \"ws\": 1.0e-3,\n            \"u0\": 0.25, \"c0\": 0.05, \"B0\": 8.0,\n            \"dt\": 5.0, \"T\": 1800.0\n        },\n        # Case 3 (edge case with coarse time step and faster settling)\n        {\n            \"H\": 5.0, \"S\": 1.5e-4, \"Cf\": 3.0e-3, \"tau_c\": 0.20, \"M\": 5.0e-5, \"ws\": 2.0e-3,\n            \"u0\": 0.40, \"c0\": 0.20, \"B0\": 12.0,\n            \"dt\": 30.0, \"T\": 3600.0\n        }\n    ]\n\n    all_results = []\n\n    def erosion_flux(u, params):\n        \"\"\"Calculates erosion flux e(u).\"\"\"\n        tau_b = rho0 * params[\"Cf\"] * u**2\n        e = params[\"M\"] * np.maximum((tau_b - params[\"tau_c\"]) / params[\"tau_c\"], 0)\n        return e\n\n    def run_loose_coupling(params):\n        \"\"\"Simulates the system using the loose coupling scheme.\"\"\"\n        u, c, B = params[\"u0\"], params[\"c0\"], params[\"B0\"]\n        num_steps = int(params[\"T\"] / params[\"dt\"])\n        \n        u_hist = [u]\n        c_hist = [c]\n\n        for _ in range(num_steps):\n            # Store current values\n            u_n, c_n = u, c\n            \n            # Update velocity (explicit)\n            u = u_n + params[\"dt\"] * (g * params[\"S\"] * (1 + c_n / rho0) - (params[\"Cf\"] / params[\"H\"]) * u_n * np.abs(u_n))\n            \n            # Update concentration (semi-implicit)\n            e_new = erosion_flux(u, params)\n            c = c_n + (params[\"dt\"] / params[\"H\"]) * (e_new - params[\"ws\"] * c_n)\n\n            # Update bed mass (fully explicit on old fluxes)\n            e_old = erosion_flux(u_n, params)\n            B = B - params[\"dt\"] * (e_old - params[\"ws\"] * c_n)\n\n            u_hist.append(u)\n            c_hist.append(c)\n\n        return np.array(u_hist), np.array(c_hist), B\n\n    def run_strong_coupling(params):\n        \"\"\"Simulates the system using the strong coupling scheme.\"\"\"\n        u, c, B = params[\"u0\"], params[\"c0\"], params[\"B0\"]\n        num_steps = int(params[\"T\"] / params[\"dt\"])\n\n        u_hist = [u]\n        c_hist = [c]\n\n        for _ in range(num_steps):\n            u_n, c_n = u, c\n            \n            # Define the function G(u^{n+1}) = 0 to be solved\n            def G(u_next):\n                e_next = erosion_flux(u_next, params)\n                c_next_expr = (params[\"H\"] * c_n + params[\"dt\"] * e_next) / (params[\"H\"] + params[\"dt\"] * params[\"ws\"])\n                \n                term_buoyancy = g * params[\"S\"] * (1 + c_next_expr / rho0)\n                term_friction = (params[\"Cf\"] / params[\"H\"]) * u_next * np.abs(u_next)\n                \n                return u_next - u_n - params[\"dt\"] * (term_buoyancy - term_friction)\n\n            # Solve for u^{n+1}\n            # The root is bracketed by 0 and a sufficiently large velocity\n            sol = root_scalar(G, bracket=[0, 10.0], method='brentq')\n            u = sol.root\n\n            # Calculate c^{n+1}\n            e = erosion_flux(u, params)\n            c = (params[\"H\"] * c_n + params[\"dt\"] * e) / (params[\"H\"] + params[\"dt\"] * params[\"ws\"])\n\n            # Update bed mass\n            B = B - params[\"dt\"] * (e - params[\"ws\"] * c)\n            \n            u_hist.append(u)\n            c_hist.append(c)\n            \n        return np.array(u_hist), np.array(c_hist), B\n\n    def calculate_errors(u_hist, c_hist, B_final, params):\n        H, u0, c0, B0, dt = params[\"H\"], params[\"u0\"], params[\"c0\"], params[\"B0\"], params[\"dt\"]\n        \n        # Mass conservation error\n        initial_mass = H * c0 + B0\n        final_mass = H * c_hist[-1] + B_final\n        if initial_mass == 0:\n            err_mass = 0 if final_mass == 0 else np.inf\n        else:\n            err_mass = np.abs(final_mass - initial_mass) / initial_mass\n\n        # Momentum closure residual\n        N = len(u_hist) - 1\n        res_sq_sum = 0.0\n        for k in range(N):\n            u_k, u_k1 = u_hist[k], u_hist[k+1]\n            c_k, c_k1 = c_hist[k], c_hist[k+1]\n            \n            u_mid = (u_k + u_k1) / 2.0\n            c_mid = (c_k + c_k1) / 2.0\n            \n            dudt_approx = (u_k1 - u_k) / dt\n            forcing_mid = g * params[\"S\"] * (1 + c_mid / rho0) - (params[\"Cf\"] / H) * u_mid * np.abs(u_mid)\n            \n            residual_k = dudt_approx - forcing_mid\n            res_sq_sum += residual_k**2\n        \n        err_mom = np.sqrt(res_sq_sum / N)\n        \n        return err_mass, err_mom\n\n    for case_params in test_cases:\n        # Run loose coupling\n        u_hist_loose, c_hist_loose, B_final_loose = run_loose_coupling(case_params)\n        err_mass_loose, err_mom_loose = calculate_errors(u_hist_loose, c_hist_loose, B_final_loose, case_params)\n\n        # Run strong coupling\n        u_hist_strong, c_hist_strong, B_final_strong = run_strong_coupling(case_params)\n        err_mass_strong, err_mom_strong = calculate_errors(u_hist_strong, c_hist_strong, B_final_strong, case_params)\n        \n        all_results.extend([err_mass_loose, err_mass_strong, err_mom_loose, err_mom_strong])\n\n    print(f\"[{','.join(f'{x:.6e}' for x in all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Modern morphodynamic models rely on sophisticated numerical methods to handle complex flow conditions like shocks and wetting-drying fronts. This advanced practice  introduces a powerful Godunov-type finite-volume approach for calculating the bedload flux. You will implement the Harten–Lax–van Leer (HLL) approximate Riemann solver to determine the governing hydrodynamic state at a cell interface, and then use this state to compute a robust, physically-grounded sediment flux, providing a foundational skill for developing state-of-the-art computational models.",
            "id": "3800731",
            "problem": "You are tasked with implementing a one-dimensional Godunov-type numerical flux for bedload transport that enters the sediment mass conservation (Exner) equation in computational oceanography. Begin from first principles and widely accepted closures, and design an algorithm that computes the interface bedload flux used in a finite-volume method, using an approximate Riemann solver to determine the hydrodynamic interface state. Your final program must compute the Exner flux at the interface for a given set of left and right states and output the results for a specified test suite.\n\nFundamental base to use:\n- Sediment mass conservation (Exner equation): the bed elevation $z_b(x,t)$ evolves according to\n$$\n\\frac{\\partial z_b}{\\partial t} + \\frac{1}{1-\\lambda_p} \\frac{\\partial q_s}{\\partial x} = 0,\n$$\nwhere $q_s(x,t)$ is the bedload transport rate per unit width and $\\lambda_p$ is the bed porosity.\n- Shallow water hydrodynamics: the conservative variables are $U = [h, h u]^\\top$ with water depth $h(x,t)$ and depth-averaged velocity $u(x,t)$; the flux function is $F(U) = [h u, h u^2 + \\tfrac{1}{2} g h^2]^\\top$. The characteristic speeds are $u \\pm \\sqrt{g h}$.\n- Bedload transport closure via the Meyer-Peter–Müller formula: define the Shields parameter\n$$\n\\theta^\\ast = \\frac{\\tau_b}{(\\rho_s - \\rho_w) g D},\n$$\nwith bed shear stress modeled as\n$$\n\\tau_b = \\rho_w C_f u^2,\n$$\nwhere $\\rho_w$ is water density, $\\rho_s$ is sediment density, $g$ is gravitational acceleration, $D$ is grain size, and $C_f$ is a dimensionless friction coefficient. For $\\theta^\\ast  \\theta_c$, the dimensionless bedload rate is\n$$\n\\Phi_b = 8\\left(\\theta^\\ast - \\theta_c\\right)^{3/2},\n$$\nand the bedload transport magnitude is\n$$\nq_b = \\Phi_b \\sqrt{(s - 1) g D^3},\\quad s = \\frac{\\rho_s}{\\rho_w}.\n$$\nIf $\\theta^\\ast \\le \\theta_c$, set $q_b = 0$.\n- Slope correction: account for mild along-stream bed slope $S_b$ via a multiplicative factor applied to the magnitude,\n$$\nq_b' = q_b \\max\\left(0, 1 - \\beta_s S_b\\right),\\quad S_b \\approx \\frac{z_{b,R} - z_{b,L}}{\\Delta x},\n$$\nand apply the transport direction with $\\operatorname{sign}(u^\\ast)$, where $u^\\ast$ is the interfacial velocity obtained from the hydrodynamic Riemann solver.\n\nApproximate Riemann solver strategy:\n- Use the Harten–Lax–van Leer (HLL) approximate Riemann solver to construct an interfacial hydrodynamic state $U^\\ast$ from left and right states $(h_L,u_L)$ and $(h_R,u_R)$, based on the extremal wave speeds $S_L$ and $S_R$ computed from the characteristic speeds $u \\pm \\sqrt{g h}$.\n- From $U^\\ast$, extract $h^\\ast$ and $u^\\ast = (h u)^\\ast / h^\\ast$ (with appropriate safeguards for vanishing depth), then evaluate $q_b'$ as above and form the Exner numerical flux\n$$\n\\mathcal{F}_{\\text{Exner}} = \\frac{q_b'}{1 - \\lambda_p}.\n$$\n\nUnits and output:\n- All physical quantities must be handled in International System of Units: depths in meters ($\\mathrm{m}$), velocities in meters per second ($\\mathrm{m/s}$), densities in kilograms per cubic meter ($\\mathrm{kg/m^3}$), gravitational acceleration in meters per second squared ($\\mathrm{m/s^2}$), grain size in meters ($\\mathrm{m}$), and bedload and Exner fluxes in square meters per second ($\\mathrm{m^2/s}$) per unit width.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,\\dots]$, where each $r_i$ is the Exner numerical flux $\\mathcal{F}_{\\text{Exner}}$ in $\\mathrm{m^2/s}$ for the corresponding test case.\n\nTest suite:\nFor each test case, you are given the left and right hydrodynamic and bed states and material parameters as a tuple\n$$\n(h_L, u_L, h_R, u_R, z_{b,L}, z_{b,R}, D, \\lambda_p, C_f, \\beta_s, \\Delta x, g, \\rho_w, \\rho_s, \\theta_c),\n$$\nall in the units specified above. Use the following five cases:\n- Case $1$: $(3.0, 1.2, 2.5, 1.0, 0.0, 0.05, 0.0005, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $2$: $(2.0, 0.2, 2.0, 0.15, 0.1, 0.099, 0.0010, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $3$: $(1.0, 0.48, 1.1, 0.5, 0.0, -0.02, 0.0010, 0.35, 0.004, 0.5, 20.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $4$: $(1.5, 1.4, 0.01, 0.0, 0.2, 0.21, 0.0007, 0.4, 0.005, 0.5, 5.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $5$: $(2.0, 1.0, 2.5, -0.8, 0.0, 0.0, 0.0006, 0.4, 0.0045, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n\nRequirements:\n- Implement the Harten–Lax–van Leer (HLL) approximate Riemann solver to compute the interfacial hydrodynamic state $U^\\ast$.\n- Use the Meyer-Peter–Müller closure and the specified slope correction to compute $q_b'$ and the Exner numerical flux $\\mathcal{F}_{\\text{Exner}}$.\n- For each test case, compute and return the single float $\\mathcal{F}_{\\text{Exner}}$ in $\\mathrm{m^2/s}$.\n- Your program should produce a single line of output containing a list with the five numerical fluxes in the exact format $[r_1,r_2,r_3,r_4,r_5]$, using Python $3.12$ with the libraries specified.",
            "solution": "The task is to implement a Godunov-type numerical flux for the sediment mass conservation (Exner) equation, which is used in finite-volume methods for modeling morphodynamics. The core of this approach is to solve a local Riemann problem at each cell interface to determine the state that governs the flux. The process is divided into two main parts: first, solving the hydrodynamic Riemann problem using an approximate solver to find an interfacial flow state; and second, using this flow state to compute the bedload sediment transport rate via an empirical closure.\n\nThe evolution of the bed elevation, $z_b(x,t)$, is described by the Exner equation for mass conservation of the sediment bed:\n$$\n\\frac{\\partial z_b}{\\partial t} + \\frac{1}{1-\\lambda_p} \\frac{\\partial q_s}{\\partial x} = 0\n$$\nHere, $q_s(x,t)$ is the volumetric bedload transport rate per unit width, and $\\lambda_p$ is the porosity of the sediment bed. In a finite-volume framework, integrating this equation over a control volume leads to an update formula that requires a numerical flux, $\\mathcal{F}_{\\text{Exner}}$, at the cell interfaces. The flux is related to the sediment transport rate by $\\mathcal{F}_{\\text{Exner}} = q_s / (1 - \\lambda_p)$.\n\nThe sediment transport $q_s$ is primarily driven by the overlying water flow, which is modeled here by the one-dimensional shallow water equations (SWE). The conservative variables for the SWE are $U = [h, hu]^\\top$, where $h$ is the water depth and $u$ is the depth-averaged velocity. The flux of these quantities is given by the vector $F(U) = [hu, hu^2 + \\tfrac{1}{2}gh^2]^\\top$, where $g$ is the acceleration due to gravity. The system is hyperbolic with characteristic speeds (eigenvalues) $\\lambda = u \\pm \\sqrt{gh}$.\n\nThe coupling between the bed and the flow is handled by assuming that on the fast timescale of the hydrodynamic Riemann problem, the bed is fixed. The hydrodynamics are solved first, and the resulting interfacial flow state is then used to calculate the sediment transport, which in turn drives the bed evolution on a slower timescale.\n\n**Step 1: Hydrodynamic Interfacial State via HLL Riemann Solver**\n\nAt an interface between a left state $(h_L, u_L)$ and a right state $(h_R, u_R)$, a Riemann problem is formed. We use the Harten–Lax–van Leer (HLL) approximate Riemann solver to find the interfacial hydrodynamic state. The HLL solver approximates the solution within the Riemann fan, which is bounded by the slowest and fastest wave speeds, $S_L$ and $S_R$. A standard method to estimate these speeds is to take the minimum and maximum of the characteristic speeds from the left and right states:\n$$\nS_L = \\min(u_L - \\sqrt{gh_L}, u_R - \\sqrt{gh_R})\n$$\n$$\nS_R = \\max(u_L + \\sqrt{gh_L}, u_R + \\sqrt{gh_R})\n$$\nThe HLL solver assumes a single constant state, $U^\\ast = [h^\\ast, (hu)^\\ast]^\\top$, within the region defined by $S_L  x/t  S_R$. The state at the interface ($x/t=0$) is determined by the signs of $S_L$ and $S_R$:\n- If $S_L \\ge 0$, the entire wave structure propagates to the right, and the state at the interface is the left state, $U_L$.\n- If $S_R \\le 0$, the entire wave structure propagates to the left, and the state at the interface is the right state, $U_R$.\n- If $S_L  0  S_R$, the interface is within the \"star\" region. The HLL-averaged state $U^\\ast$ is given by:\n$$\nU^\\ast = \\frac{S_R U_R - S_L U_L - (F_R - F_L)}{S_R - S_L}\n$$\nwhere $U_L = [h_L, h_L u_L]^\\top$, $U_R = [h_R, h_R u_R]^\\top$, and $F_L, F_R$ are the corresponding SWE flux vectors. From the conservative state $U^\\ast$, we extract the primitive variables for the interfacial flow: the depth $h^\\ast$ and the velocity $u^\\ast = (hu)^\\ast / h^\\ast$. A safeguard is necessary for the case where $h^\\ast$ is close to zero, in which case $u^\\ast$ can be set to zero.\n\n**Step 2: Bedload Transport Calculation**\n\nWith the interfacial velocity $u^\\ast$ determined, we compute the bedload transport rate using the Meyer-Peter–Müller (MPM) empirical formula.\nFirst, we calculate the bed shear stress, $\\tau_b$, induced by the flow, modeled with a quadratic friction law:\n$$\n\\tau_b^\\ast = \\rho_w C_f (u^\\ast)^2\n$$\nwhere $\\rho_w$ is the water density and $C_f$ is a dimensionless friction coefficient.\n\nNext, we compute the Shields parameter, $\\theta^\\ast$, which is a dimensionless measure of the shear stress:\n$$\n\\theta^{\\ast\\ast} = \\frac{\\tau_b^\\ast}{(\\rho_s - \\rho_w) g D}\n$$\nwhere $\\rho_s$ is the sediment density and $D$ is the median grain size.\n\nThe MPM formula includes a critical Shields parameter, $\\theta_c$, representing the threshold for the initiation of motion. Sediment transport occurs only if $\\theta^{\\ast\\ast}  \\theta_c$. If this condition is met, the dimensionless bedload transport rate, $\\Phi_b$, is given by:\n$$\n\\Phi_b^\\ast = 8 (\\theta^{\\ast\\ast} - \\theta_c)^{3/2}\n$$\nIf $\\theta^{\\ast\\ast} \\le \\theta_c$, then $\\Phi_b^\\ast = 0$.\n\nThe dimensional magnitude of the bedload transport rate, $q_b$, is then found by scaling $\\Phi_b$:\n$$\nq_b^\\ast = \\Phi_b^\\ast \\sqrt{(s-1)gD^3}\n$$\nwhere $s = \\rho_s / \\rho_w$ is the specific gravity of the sediment.\n\n**Step 3: Slope Correction and Final Exner Flux**\n\nThe local bed slope affects the transport rate. A downslope component of gravity acting on the sediment grains enhances transport, while an upslope component hinders it. This is incorporated via a multiplicative correction factor. First, the bed slope $S_b$ at the interface is approximated using the bed elevations of the adjacent cells, $z_{b,L}$ and $z_{b,R}$, and the cell width $\\Delta x$:\n$$\nS_b = \\frac{z_{b,R} - z_{b,L}}{\\Delta x}\n$$\nThe corrected bedload transport magnitude, $q_b'$, is then:\n$$\nq_b'^\\ast = q_b^\\ast \\max(0, 1 - \\beta_s S_b)\n$$\nwhere $\\beta_s$ is an empirical parameter. The $\\max(0, \\dots)$ term prevents sediment transport up a very steep adverse slope.\n\nFinally, the bedload transport is a vector quantity. Its direction is determined by the flow direction. The directed sediment transport rate at the interface, $q_s^\\ast$, is:\n$$\nq_s^\\ast = \\operatorname{sign}(u^\\ast) q_b'^\\ast\n$$\nwhere $\\operatorname{sign}(u^\\ast)$ is $+1$ for $u^\\ast  0$, $-1$ for $u^\\ast  0$, and $0$ for $u^\\ast = 0$.\n\nThe numerical flux for the Exner equation is then computed as:\n$$\n\\mathcal{F}_{\\text{Exner}} = \\frac{q_s^\\ast}{1 - \\lambda_p}\n$$\nThis value represents the rate of sediment volume exchange across the interface, normalized by the active layer volume, and is used to update the bed elevation in the finite-volume scheme.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are imported.\n\ndef solve():\n    \"\"\"\n    Computes the Godunov-type Exner numerical flux for bedload transport for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (h_L, u_L, h_R, u_R, z_b_L, z_b_R, D, lambda_p, C_f, beta_s, delta_x, g, rho_w, rho_s, theta_c)\n        (3.0, 1.2, 2.5, 1.0, 0.0, 0.05, 0.0005, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047),\n        (2.0, 0.2, 2.0, 0.15, 0.1, 0.099, 0.0010, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047),\n        (1.0, 0.48, 1.1, 0.5, 0.0, -0.02, 0.0010, 0.35, 0.004, 0.5, 20.0, 9.81, 1025.0, 2650.0, 0.047),\n        (1.5, 1.4, 0.01, 0.0, 0.2, 0.21, 0.0007, 0.4, 0.005, 0.5, 5.0, 9.81, 1025.0, 2650.0, 0.047),\n        (2.0, 1.0, 2.5, -0.8, 0.0, 0.0, 0.0006, 0.4, 0.0045, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        h_L, u_L, h_R, u_R, z_b_L, z_b_R, D, lambda_p, C_f, beta_s, delta_x, g, rho_w, rho_s, theta_c = case\n        \n        # --- Step 1: HLL Approximate Riemann Solver ---\n        \n        # Handle dry states safely\n        h_L = max(0, h_L)\n        h_R = max(0, h_R)\n\n        c_L = np.sqrt(g * h_L)\n        c_R = np.sqrt(g * h_R)\n\n        # Estimate wave speeds (Davis, 1988)\n        S_L = min(u_L - c_L, u_R - c_R)\n        S_R = max(u_L + c_L, u_R + c_R)\n        \n        h_star, u_star = 0.0, 0.0\n\n        if S_L >= 0:\n            # Entire wave structure moves right, state at interface is Left state\n            h_star, u_star = h_L, u_L\n        elif S_R = 0:\n            # Entire wave structure moves left, state at interface is Right state\n            h_star, u_star = h_R, u_R\n        else: # S_L  0  S_R, interface is in star region\n            # Conservative states\n            U_L = np.array([h_L, h_L * u_L])\n            U_R = np.array([h_R, h_R * u_R])\n            \n            # Flux vectors\n            F_L = np.array([h_L * u_L, h_L * u_L**2 + 0.5 * g * h_L**2])\n            F_R = np.array([h_R * u_R, h_R * u_R**2 + 0.5 * g * h_R**2])\n            \n            # HLL-averaged state U*\n            if abs(S_R - S_L) > 1e-9:\n                U_star = (S_R * U_R - S_L * U_L - (F_R - F_L)) / (S_R - S_L)\n                h_star = U_star[0]\n                \n                # Safeguard for vanishing depth\n                if h_star > 1e-9:\n                    u_star = U_star[1] / h_star\n                else:\n                    h_star = 0.0\n                    u_star = 0.0 # No depth, no velocity\n            else: # States are nearly identical\n                h_star, u_star = (h_L + h_R) / 2, (u_L + u_R) / 2\n\n        # --- Step 2: Bedload Transport Calculation (Meyer-Peter-Müller) ---\n        \n        q_s_star = 0.0\n        \n        if h_star > 1e-9:\n            # Bed shear stress\n            tau_b_star = rho_w * C_f * u_star**2\n            \n            # Shields parameter\n            rho_diff_g_D = (rho_s - rho_w) * g * D\n            if rho_diff_g_D > 1e-9:\n                theta_star_star = tau_b_star / rho_diff_g_D\n            else:\n                theta_star_star = 0.0\n\n            if theta_star_star > theta_c:\n                # Dimensionless bedload transport rate\n                Phi_b_star = 8.0 * (theta_star_star - theta_c)**1.5\n                \n                # Dimensional bedload transport magnitude\n                s = rho_s / rho_w\n                q_b_star_factor = np.sqrt(max(0, s - 1.0) * g * D**3)\n                q_b_star = Phi_b_star * q_b_star_factor\n                \n                # --- Step 3: Slope Correction and Final Flux ---\n                \n                # Bed slope\n                S_b = (z_b_R - z_b_L) / delta_x\n                \n                # Corrected bedload magnitude\n                q_b_prime_star = q_b_star * max(0.0, 1.0 - beta_s * S_b)\n                \n                # Directed sediment transport rate\n                q_s_star = np.sign(u_star) * q_b_prime_star\n\n        # Exner numerical flux\n        exner_flux = q_s_star / (1.0 - lambda_p)\n        results.append(exner_flux)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}