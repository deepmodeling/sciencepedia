{
    "hands_on_practices": [
        {
            "introduction": "The evolution of riverbeds, coastlines, and deltas is fundamentally governed by the conservation of sediment mass, a principle mathematically encapsulated in the Exner equation. This equation links the rate of change in bed elevation to the spatial gradient of the sediment transport rate. This foundational exercise  guides you through the derivation of the Exner equation from first principles, requiring a careful distinction between the bulk motion of the sediment-fluid mixture and the net flux of solid grains, and clarifying the critical role of bed porosity in morphodynamic calculations.",
            "id": "3800701",
            "problem": "A one-dimensional, laterally uniform coastal sand bed is composed of equal-diameter, nearly spherical quartz grains. Assume the stationary bed is a random close packing of monodisperse spheres with solid volume fraction $0.64$. The near-bed moving layer is a dilated granular assembly approximated as a random loose packing with solid volume fraction $0.55$. Let the bed elevation relative to a fixed datum be $\\eta(x,t)$, where $x$ is the alongshore coordinate in meters and $t$ is time in seconds. The alongshore bulk volumetric bedload transport per unit width (that is, the volumetric flux of the moving mixture including its intergranular voids) is measured to vary linearly with $x$ as $q_{\\mathrm{bulk}}(x) = q_{0} + a x$, where $q_{0} = 2.50 \\times 10^{-4}$ and $a = 1.00 \\times 10^{-6}$; the units of $q_{0}$ and $q_{\\mathrm{bulk}}$ are cubic meters per second per meter of channel width, and the units of $a$ are cubic meters per second per meter squared.\n\nStarting from conservation of mass of the solid phase and the definition of porosity, (i) determine the bed porosity $\\lambda_{p}$ implied by the stated grain packing of the stationary bed, (ii) consistently relate the measured bulk volumetric transport $q_{\\mathrm{bulk}}(x)$ to the volumetric transport of solids, and (iii) use these to derive a local relation for the instantaneous bed elevation change rate $\\partial \\eta / \\partial t$ in terms of the spatial gradient $\\partial q_{\\mathrm{bulk}} / \\partial x$. Evaluate this rate at $x^{\\star} = 300$.\n\nReport the instantaneous bed elevation change rate $\\partial \\eta / \\partial t$ at $x^{\\star}$ as your final numerical answer. Express the final answer in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ and round to four significant figures.",
            "solution": "The problem requires the derivation and evaluation of the rate of change of bed elevation, $\\partial \\eta / \\partial t$, based on the principle of conservation of sediment mass. We begin by formalizing the relationship between bed elevation change and the spatial gradient of sediment transport, often known as the Exner equation.\n\nFirst, we address the three parts of the problem as requested.\n\n(i) Determine the bed porosity $\\lambda_{p}$.\nPorosity, $\\lambda_{p}$, is defined as the ratio of the volume of voids to the total volume of a porous medium. The solid volume fraction, which we denote as $\\phi$, is the ratio of the volume of solids to the total volume. By definition, for the stationary bed:\n$$ \\lambda_{p} + \\phi_{\\mathrm{bed}} = 1 $$\nThe problem states that the stationary bed is a random close packing with a solid volume fraction $\\phi_{\\mathrm{bed}} = 0.64$. Therefore, the bed porosity is:\n$$ \\lambda_{p} = 1 - \\phi_{\\mathrm{bed}} = 1 - 0.64 = 0.36 $$\n\n(ii) Relate the measured bulk volumetric transport $q_{\\mathrm{bulk}}(x)$ to the volumetric transport of solids.\nThe bulk volumetric transport rate, $q_{\\mathrm{bulk}}$, represents the volume of the moving mixture (solids plus interstitial fluid) passing a point per unit width per unit time. The volumetric solids transport rate, $q_{s}$, is the volume of only the solid grains transported. The relationship between them is determined by the solid volume fraction of the moving layer, $\\phi_{\\mathrm{moving}}$. The problem states this layer is a random loose packing with $\\phi_{\\mathrm{moving}} = 0.55$. The relationship is thus:\n$$ q_{s}(x) = \\phi_{\\mathrm{moving}} \\cdot q_{\\mathrm{bulk}}(x) $$\n\n(iii) Use these to derive a local relation for $\\partial \\eta / \\partial t$ and evaluate it.\nThe conservation of mass for the solid phase in the stationary bed is the core principle. Consider a one-dimensional control volume of the bed with an infinitesimal length $dx$ and a unit width. The volume of solids within this segment of the bed is $V_{s, \\mathrm{bed}} = \\phi_{\\mathrm{bed}} \\cdot \\eta \\cdot dx$. The rate of change of this solid volume must equal the net flux of solid volume into the control volume.\nThe rate of change of solid volume within the control volume is:\n$$ \\frac{\\partial V_{s, \\mathrm{bed}}}{\\partial t} = \\frac{\\partial}{\\partial t} (\\phi_{\\mathrm{bed}} \\eta \\, dx) = \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} dx $$\nHere, we assume the packing of the stationary bed, $\\phi_{\\mathrm{bed}}$, is constant over time.\nThe net flux of solids into the control volume is the difference between the flux entering at position $x$ and the flux exiting at position $x+dx$:\n$$ \\text{Net Flux} = q_{s}(x) - q_{s}(x+dx) $$\nFor an infinitesimal $dx$, this can be expressed using a first-order Taylor expansion: $q_{s}(x+dx) \\approx q_{s}(x) + \\frac{\\partial q_{s}}{\\partial x} dx$. The net flux is then:\n$$ \\text{Net Flux} \\approx q_{s}(x) - \\left( q_{s}(x) + \\frac{\\partial q_{s}}{\\partial x} dx \\right) = -\\frac{\\partial q_{s}}{\\partial x} dx $$\nEquating the rate of change of volume with the net flux (the principle of conservation) gives:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} dx = -\\frac{\\partial q_{s}}{\\partial x} dx $$\nDividing by $dx$ yields the one-dimensional Exner equation for sediment continuity:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\partial q_{s}}{\\partial x} $$\nNote that $\\phi_{\\mathrm{bed}}$ is equivalent to $(1-\\lambda_p)$.\n\nNow, we substitute the expression for $q_s$ from part (ii) into the Exner equation:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left( \\phi_{\\mathrm{moving}} q_{\\mathrm{bulk}}(x) \\right) $$\nThe problem states that the moving layer is a random loose packing, which implies its solid volume fraction $\\phi_{\\mathrm{moving}}$ is also a constant. We can therefore move it outside the spatial derivative:\n$$ \\phi_{\\mathrm{bed}} \\frac{\\partial \\eta}{\\partial t} = -\\phi_{\\mathrm{moving}} \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} $$\nSolving for the rate of bed elevation change, $\\partial \\eta / \\partial t$, we obtain the desired relation:\n$$ \\frac{\\partial \\eta}{\\partial t} = -\\frac{\\phi_{\\mathrm{moving}}}{\\phi_{\\mathrm{bed}}} \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} $$\nThe problem specifies the bulk transport rate as a linear function of $x$:\n$$ q_{\\mathrm{bulk}}(x) = q_{0} + a x $$\nwhere $q_{0} = 2.50 \\times 10^{-4} \\, \\mathrm{m^2 \\, s^{-1}}$ and $a = 1.00 \\times 10^{-6} \\, \\mathrm{m \\, s^{-1}}$.\nThe spatial gradient of the bulk transport is therefore a constant:\n$$ \\frac{\\partial q_{\\mathrm{bulk}}}{\\partial x} = \\frac{\\partial}{\\partial x}(q_{0} + a x) = a $$\nSubstituting this result into our expression for $\\partial \\eta / \\partial t$:\n$$ \\frac{\\partial \\eta}{\\partial t} = -a \\frac{\\phi_{\\mathrm{moving}}}{\\phi_{\\mathrm{bed}}} $$\nThis shows that the rate of bed elevation change is uniform along the entire shore, i.e., it is not a function of $x$. Thus, the value at $x^{\\star} = 300 \\, \\mathrm{m}$ is the same as everywhere else.\n\nFinally, we substitute the numerical values provided:\n$$ \\phi_{\\mathrm{bed}} = 0.64 $$\n$$ \\phi_{\\mathrm{moving}} = 0.55 $$\n$$ a = 1.00 \\times 10^{-6} \\, \\mathrm{m \\, s^{-1}} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -(1.00 \\times 10^{-6}) \\frac{0.55}{0.64} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -(1.00 \\times 10^{-6}) \\times 0.859375 \\, \\mathrm{m \\, s^{-1}} $$\n$$ \\frac{\\partial \\eta}{\\partial t} = -8.59375 \\times 10^{-7} \\, \\mathrm{m \\, s^{-1}} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\frac{\\partial \\eta}{\\partial t} \\approx -8.594 \\times 10^{-7} \\, \\mathrm{m \\, s^{-1}} $$\nThe negative sign indicates that the bed is eroding, which is expected since the transport rate increases with $x$ ($\\partial q_{\\mathrm{bulk}}/\\partial x > 0$), meaning more sediment leaves any given region than enters it.",
            "answer": "$$\\boxed{-8.594 \\times 10^{-7}}$$"
        },
        {
            "introduction": "After establishing the governing equation for bed evolution, a critical step in computational modeling is understanding how uncertainties in physical parameters propagate into model predictions. This practice  builds directly upon the Exner equation by having you implement a simple analytical model of bed evolution and perform a first-order sensitivity analysis. By deriving and computing the model's sensitivity to parameters like bed porosity ($\\lambda_p$) and sediment flux magnitude ($s$), you will gain hands-on experience in quantifying model uncertainty, a crucial skill for interpreting simulation results and guiding future research.",
            "id": "3800689",
            "problem": "Consider a one-dimensional seabed profile along the horizontal coordinate $x$ (in meters) subject to bedload sediment transport. Let the bed elevation be $\\eta(x,t)$ (in meters), bed porosity be $\\lambda_p$ (dimensionless), and bedload volumetric flux per unit width be $q_b(x,t)$ (in square meters per second). The bed evolution is governed by conservation of solids within an infinitesimal control volume of the bed. Starting from the conservation of mass principle and the definition of porosity, derive an expression for the bed elevation change $\\Delta \\eta(x,T)$ (in meters) over a finite horizon $T$ (in seconds) in terms of $\\lambda_p$ and the spatial gradient of $q_b(x,t)$, assuming $q_b$ is time-independent over $[0,T]$ and the initial bed elevation is flat with $\\eta(x,0)=0$.\n\nModel the bedload flux as a smooth baseline function scaled by an uncertain magnitude parameter $s$ (dimensionless):\n$$\nq_b(x) = s \\left( A \\sin(k x) + B x + C \\right),\n$$\nwhere $A$ (in square meters per second) sets the sinusoidal amplitude, $k$ (in radians per meter) is the wavenumber of the sinusoidal variation and all trigonometric arguments must be evaluated in radians, $B$ (in square meters per second per meter) sets a linear trend, and $C$ (in square meters per second) is a constant offset. Treat $s$ and $\\lambda_p$ as uncertain scalars with small one-standard-deviation uncertainties $\\delta s$ and $\\delta \\lambda_p$ respectively.\n\nPerform a first-order sensitivity analysis with respect to $\\lambda_p$ and $s$ to quantify how their uncertainties impact the predicted bed elevation change. Specifically:\n- Derive expressions for the first-order sensitivities $\\partial \\Delta \\eta / \\partial \\lambda_p$ and $\\partial \\Delta \\eta / \\partial s$ evaluated at the baseline $(\\lambda_p, s)$.\n- Using these sensitivities, compute spatially averaged expected magnitudes of bed elevation change due to the uncertainties, defined as\n$$\nM_{\\lambda_p} = \\left\\langle \\left| \\frac{\\partial \\Delta \\eta}{\\partial \\lambda_p}(x) \\right| \\right\\rangle \\, \\delta \\lambda_p, \\quad\nM_{s} = \\left\\langle \\left| \\frac{\\partial \\Delta \\eta}{\\partial s}(x) \\right| \\right\\rangle \\, \\delta s,\n$$\nwhere $\\langle \\cdot \\rangle$ denotes the average over the spatial domain $x \\in [0,L]$ and $L$ is the domain length (in meters). Report $M_{\\lambda_p}$ and $M_{s}$ in meters.\n\nImplement a program that:\n- Uses the derived analytical formula for $\\Delta \\eta(x,T)$ and the sensitivities.\n- Discretizes the domain $[0,L]$ uniformly with $N_x$ points to evaluate spatial averages numerically.\n- Produces, for each specified test case, the pair of floats $(M_{\\lambda_p}, M_{s})$.\n\nTest suite:\n- Case $1$ (general variation): $L=1000$ (meters), $T=86400$ (seconds), $\\lambda_p=0.4$, $\\delta \\lambda_p=0.05$, $s=1.0$, $\\delta s=0.1$, $A=0.001$ (square meters per second), $k=0.01$ (radians per meter), $B=1\\times 10^{-7}$ (square meters per second per meter), $C=0.001$ (square meters per second), $N_x=1001$.\n- Case $2$ (uniform bedload, zero gradient edge): $L=500$ (meters), $T=43200$ (seconds), $\\lambda_p=0.5$, $\\delta \\lambda_p=0.05$, $s=1.0$, $\\delta s=0.2$, $A=0.0$ (square meters per second), $k=0.02$ (radians per meter), $B=0.0$ (square meters per second per meter), $C=0.002$ (square meters per second), $N_x=501$.\n- Case $3$ (steeper gradient): $L=2000$ (meters), $T=172800$ (seconds), $\\lambda_p=0.35$, $\\delta \\lambda_p=0.03$, $s=0.8$, $\\delta s=0.15$, $A=0.0005$ (square meters per second), $k=0.02$ (radians per meter), $B=5\\times 10^{-6}$ (square meters per second per meter), $C=0.0$ (square meters per second), $N_x=2001$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\left[ M_{\\lambda_p}^{(1)}, M_s^{(1)}, M_{\\lambda_p}^{(2)}, M_s^{(2)}, M_{\\lambda_p}^{(3)}, M_s^{(3)} \\right],\n$$\nwhere superscripts indicate the test case index. All values must be floats in meters. No additional text should be printed.",
            "solution": "**1. Derivation of the Governing Equation for Bed Evolution**\n\nThe evolution of the seabed is governed by the conservation of sediment mass. Consider a one-dimensional control volume of the bed of length $\\Delta x$ and unit width. The total volume of this section of the bed is $V_{total} = \\eta(x,t) \\Delta x$. The bed is a porous medium with porosity $\\lambda_p$, defined as the ratio of void volume to total volume. Therefore, the volume of solid sediment particles, $V_{solid}$, in the control volume is:\n$$\nV_{solid} = (1 - \\lambda_p) V_{total} = (1 - \\lambda_p) \\eta(x,t) \\Delta x\n$$\nThe principle of mass conservation dictates that the time rate of change of the sediment volume within this control volume must equal the net flux of sediment into it. The volumetric flux per unit width is denoted by $q_b(x,t)$. The flux into the control volume at position $x$ is $q_b(x,t)$ and the flux out at $x+\\Delta x$ is $q_b(x+\\Delta x, t)$. Thus, the net flux is $q_b(x,t) - q_b(x+\\Delta x, t)$.\n\nEquating the rate of change of sediment volume to the net flux, we get:\n$$\n\\frac{\\partial V_{solid}}{\\partial t} = q_b(x,t) - q_b(x+\\Delta x, t)\n$$\nAssuming the porosity $\\lambda_p$ is constant in space and time, the left-hand side becomes:\n$$\n\\frac{\\partial}{\\partial t} \\left[ (1 - \\lambda_p) \\eta(x,t) \\Delta x \\right] = (1 - \\lambda_p) \\Delta x \\frac{\\partial \\eta(x,t)}{\\partial t}\n$$\nSubstituting this into the conservation equation and dividing by $\\Delta x$:\n$$\n(1 - \\lambda_p) \\frac{\\partial \\eta}{\\partial t} = - \\frac{q_b(x+\\Delta x, t) - q_b(x,t)}{\\Delta x}\n$$\nTaking the limit as $\\Delta x \\to 0$ yields the one-dimensional Exner equation for bed evolution:\n$$\n(1 - \\lambda_p) \\frac{\\partial \\eta}{\\partial t} = - \\frac{\\partial q_b}{\\partial x}\n$$\nThis can be rearranged to express the rate of change of bed elevation directly:\n$$\n\\frac{\\partial \\eta}{\\partial t} = - \\frac{1}{1 - \\lambda_p} \\frac{\\partial q_b}{\\partial x}\n$$\n\n**2. Bed Elevation Change over a Finite Time Horizon**\n\nThe problem asks for the total change in bed elevation, $\\Delta \\eta(x,T) = \\eta(x,T) - \\eta(x,0)$, over a time horizon $T$. This is obtained by integrating the rate of change from $t=0$ to $t=T$:\n$$\n\\Delta \\eta(x,T) = \\int_0^T \\frac{\\partial \\eta}{\\partial t} \\mathrm{d}t = \\int_0^T \\left( - \\frac{1}{1 - \\lambda_p} \\frac{\\partial q_b}{\\partial x} \\right) \\mathrm{d}t\n$$\nThe problem specifies that the bedload flux $q_b$ is time-independent over the interval $[0, T]$, so $q_b(x, t) = q_b(x)$. As a result, the term $\\frac{\\partial q_b}{\\partial x}$ is also constant in time. The integral simplifies to:\n$$\n\\Delta \\eta(x,T) = \\left( - \\frac{1}{1 - \\lambda_p} \\frac{\\partial q_b}{\\partial x} \\right) \\int_0^T \\mathrm{d}t = - \\frac{T}{1 - \\lambda_p} \\frac{\\partial q_b}{\\partial x}\n$$\nGiven the initial condition $\\eta(x,0)=0$, this expression directly gives the bed elevation at time $T$.\n\nNow, we substitute the given model for the bedload flux:\n$$\nq_b(x) = s \\left( A \\sin(k x) + B x + C \\right)\n$$\nThe spatial gradient of the flux is:\n$$\n\\frac{\\partial q_b}{\\partial x} = \\frac{d}{dx} \\left[ s \\left( A \\sin(k x) + B x + C \\right) \\right] = s \\left( A k \\cos(k x) + B \\right)\n$$\nNote that the constant offset $C$ in the flux does not contribute to the bed elevation change, as it has no spatial gradient. Substituting this gradient into the equation for $\\Delta \\eta(x,T)$ yields the final analytical expression for the bed elevation change:\n$$\n\\Delta \\eta(x,T) = - \\frac{s T}{1 - \\lambda_p} (A k \\cos(k x) + B)\n$$\n\n**3. First-Order Sensitivity Analysis**\n\nWe now compute the first-order sensitivities of $\\Delta \\eta(x,T)$ with respect to the uncertain parameters $\\lambda_p$ and $s$.\n\n*   **Sensitivity with respect to porosity $\\lambda_p$:**\n    $$\n    \\frac{\\partial \\Delta \\eta}{\\partial \\lambda_p} = \\frac{\\partial}{\\partial \\lambda_p} \\left[ - s T (A k \\cos(k x) + B) (1 - \\lambda_p)^{-1} \\right]\n    $$\n    Treating everything except $(1 - \\lambda_p)^{-1}$ as a constant factor with respect to $\\lambda_p$ and applying the chain rule: $\\frac{d}{d\\lambda_p}(1-\\lambda_p)^{-1} = -1(1-\\lambda_p)^{-2}(-1) = (1-\\lambda_p)^{-2}$.\n    $$\n    \\frac{\\partial \\Delta \\eta}{\\partial \\lambda_p} = - s T (A k \\cos(k x) + B) \\frac{1}{(1 - \\lambda_p)^2} = - \\frac{s T (A k \\cos(k x) + B)}{(1 - \\lambda_p)^2}\n    $$\n\n*   **Sensitivity with respect to flux magnitude $s$:**\n    $$\n    \\frac{\\partial \\Delta \\eta}{\\partial s} = \\frac{\\partial}{\\partial s} \\left[ - \\frac{s T}{1 - \\lambda_p} (A k \\cos(k x) + B) \\right]\n    $$\n    Here, $s$ is the variable of differentiation, and the rest are factors.\n    $$\n    \\frac{\\partial \\Delta \\eta}{\\partial s} = - \\frac{T}{1 - \\lambda_p} (A k \\cos(k x) + B)\n    $$\n\n**4. Uncertainty Metrics and Numerical Implementation**\n\nThe metrics $M_{\\lambda_p}$ and $M_s$ quantify the expected magnitude of bed elevation change due to uncertainties $\\delta \\lambda_p$ and $\\delta s$. They are defined using the spatially-averaged absolute values of the sensitivities. Let $\\langle \\cdot \\rangle$ denote the spatial average over $x \\in [0,L]$.\n\nFor $M_{\\lambda_p}$:\n$$\nM_{\\lambda_p} = \\left\\langle \\left| \\frac{\\partial \\Delta \\eta}{\\partial \\lambda_p}(x) \\right| \\right\\rangle \\delta \\lambda_p = \\left\\langle \\left| - \\frac{s T (A k \\cos(k x) + B)}{(1 - \\lambda_p)^2} \\right| \\right\\rangle \\delta \\lambda_p\n$$\nSince $s, T, \\delta \\lambda_p$, and $(1-\\lambda_p)^2$ are positive constants, they can be factored out of the spatial average:\n$$\nM_{\\lambda_p} = \\frac{s T \\delta \\lambda_p}{(1 - \\lambda_p)^2} \\left\\langle \\left| A k \\cos(k x) + B \\right| \\right\\rangle\n$$\n\nFor $M_s$:\n$$\nM_{s} = \\left\\langle \\left| \\frac{\\partial \\Delta \\eta}{\\partial s}(x) \\right| \\right\\rangle \\delta s = \\left\\langle \\left| - \\frac{T (A k \\cos(k x) + B)}{1 - \\lambda_p} \\right| \\right\\rangle \\delta s\n$$\nSimilarly, factoring out the positive constants:\n$$\nM_{s} = \\frac{T \\delta s}{1 - \\lambda_p} \\left\\langle \\left| A k \\cos(k x) + B \\right| \\right\\rangle\n$$\nNotice both metrics share the term $\\langle | A k \\cos(k x) + B | \\rangle$. For numerical computation, we discretize the domain $[0,L]$ into $N_x$ uniform points $x_i$. The spatial average of a function $f(x)$ is approximated by the arithmetic mean of its values on this grid:\n$$\n\\langle f(x) \\rangle \\approx \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} f(x_i)\n$$\nWe define $G(x) = A k \\cos(k x) + B$ and compute its average absolute value:\n$$\n\\bar{G}_{abs} = \\langle |G(x)| \\rangle \\approx \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} |A k \\cos(k x_i) + B|\n$$\nThe metrics are then calculated as:\n$$\nM_{\\lambda_p} = \\frac{s T \\delta \\lambda_p}{(1 - \\lambda_p)^2} \\bar{G}_{abs}\n\\qquad \\text{and} \\qquad\nM_{s} = \\frac{T \\delta s}{1 - \\lambda_p} \\bar{G}_{abs}\n$$\nThese formulas are implemented for each test case to obtain the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spatially averaged expected magnitudes of bed elevation change due to\n    uncertainties in porosity and a sediment flux scaling parameter.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general variation)\n        {'L': 1000, 'T': 86400, 'lambda_p': 0.4, 'd_lambda_p': 0.05,\n         's': 1.0, 'd_s': 0.1, 'A': 0.001, 'k': 0.01,\n         'B': 1e-7, 'C': 0.001, 'Nx': 1001},\n        # Case 2 (uniform bedload, zero gradient edge)\n        {'L': 500, 'T': 43200, 'lambda_p': 0.5, 'd_lambda_p': 0.05,\n         's': 1.0, 'd_s': 0.2, 'A': 0.0, 'k': 0.02,\n         'B': 0.0, 'C': 0.002, 'Nx': 501},\n        # Case 3 (steeper gradient)\n        {'L': 2000, 'T': 172800, 'lambda_p': 0.35, 'd_lambda_p': 0.03,\n         's': 0.8, 'd_s': 0.15, 'A': 0.0005, 'k': 0.02,\n         'B': 5e-6, 'C': 0.0, 'Nx': 2001}\n    ]\n\n    results = []\n    for params in test_cases:\n        # Extract parameters for the current case\n        L = params['L']\n        T = params['T']\n        lambda_p = params['lambda_p']\n        d_lambda_p = params['d_lambda_p']\n        s = params['s']\n        d_s = params['d_s']\n        A = params['A']\n        k = params['k']\n        B = params['B']\n        Nx = params['Nx']\n\n        # Create the uniformly discretized spatial domain\n        # x is a vector of Nx points from 0 to L\n        x = np.linspace(0, L, Nx)\n\n        # Calculate the spatial gradient term G(x) = A*k*cos(k*x) + B\n        # This term comes from differentiating the sediment flux q_b with respect to x.\n        g_x = A * k * np.cos(k * x) + B\n\n        # Compute the spatially averaged absolute value of G(x)\n        # This is the core term |G(x)| in the sensitivity formulas.\n        g_bar_abs = np.mean(np.abs(g_x))\n\n        # Calculate the uncertainty metric M_lambda_p\n        # M_lambda_p = (s * T * d_lambda_p / (1 - lambda_p)^2) * |G(x)|\n        m_lambda_p = (s * T * d_lambda_p / (1 - lambda_p)**2) * g_bar_abs\n\n        # Calculate the uncertainty metric M_s\n        # M_s = (T * d_s / (1 - lambda_p)) * |G(x)|\n        m_s = (T * d_s / (1 - lambda_p)) * g_bar_abs\n\n        results.extend([m_lambda_p, m_s])\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of floats enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While simple analytical models provide valuable insight, real-world morphodynamic simulations require robust numerical schemes capable of handling complex flows, such as those involving shocks or sharp gradients in depth and velocity. This advanced exercise  moves from basic implementations to a state-of-the-art numerical method, tasking you with constructing a Godunov-type numerical flux for the Exner equation. By implementing an HLL approximate Riemann solver for the hydrodynamics and coupling it with the Meyer-Peter-Müller bedload formula, you will develop a core component of a modern finite-volume morphodynamic model and gain a deeper understanding of how the physics of flow and transport are discretized in research-grade codes.",
            "id": "3800731",
            "problem": "You are tasked with implementing a one-dimensional Godunov-type numerical flux for bedload transport that enters the sediment mass conservation (Exner) equation in computational oceanography. Begin from first principles and widely accepted closures, and design an algorithm that computes the interface bedload flux used in a finite-volume method, using an approximate Riemann solver to determine the hydrodynamic interface state. Your final program must compute the Exner flux at the interface for a given set of left and right states and output the results for a specified test suite.\n\nFundamental base to use:\n- Sediment mass conservation (Exner equation): the bed elevation $z_b(x,t)$ evolves according to\n$$\n\\frac{\\partial z_b}{\\partial t} + \\frac{1}{1-\\lambda_p} \\frac{\\partial q_s}{\\partial x} = 0,\n$$\nwhere $q_s(x,t)$ is the bedload transport rate per unit width and $\\lambda_p$ is the bed porosity.\n- Shallow water hydrodynamics: the conservative variables are $U = [h, h u]^\\top$ with water depth $h(x,t)$ and depth-averaged velocity $u(x,t)$; the flux function is $F(U) = [h u, h u^2 + \\tfrac{1}{2} g h^2]^\\top$. The characteristic speeds are $u \\pm \\sqrt{g h}$.\n- Bedload transport closure via the Meyer-Peter–Müller formula: define the Shields parameter\n$$\n\\theta^* = \\frac{\\tau_b}{(\\rho_s - \\rho_w) g D},\n$$\nwith bed shear stress modeled as\n$$\n\\tau_b = \\rho_w C_f u^2,\n$$\nwhere $\\rho_w$ is water density, $\\rho_s$ is sediment density, $g$ is gravitational acceleration, $D$ is grain size, and $C_f$ is a dimensionless friction coefficient. For $\\theta^*  \\theta_c$, the dimensionless bedload rate is\n$$\n\\Phi_b = 8\\left(\\theta^* - \\theta_c\\right)^{3/2},\n$$\nand the bedload transport magnitude is\n$$\nq_b = \\Phi_b \\sqrt{(s - 1) g D^3},\\quad s = \\frac{\\rho_s}{\\rho_w}.\n$$\nIf $\\theta^* \\le \\theta_c$, set $q_b = 0$.\n- Slope correction: account for mild along-stream bed slope $S_b$ via a multiplicative factor applied to the magnitude,\n$$\nq_b' = q_b \\max\\left(0, 1 - \\beta_s S_b\\right),\\quad S_b \\approx \\frac{z_{b,R} - z_{b,L}}{\\Delta x},\n$$\nand apply the transport direction with $\\operatorname{sign}(u^\\ast)$, where $u^\\ast$ is the interfacial velocity obtained from the hydrodynamic Riemann solver.\n\nApproximate Riemann solver strategy:\n- Use the Harten–Lax–van Leer (HLL) approximate Riemann solver to construct an interfacial hydrodynamic state $U^\\ast$ from left and right states $(h_L,u_L)$ and $(h_R,u_R)$, based on the extremal wave speeds $S_L$ and $S_R$ computed from the characteristic speeds $u \\pm \\sqrt{g h}$.\n- From $U^\\ast$, extract $h^\\ast$ and $u^\\ast = (h u)^\\ast / h^\\ast$ (with appropriate safeguards for vanishing depth), then evaluate $q_b'$ as above and form the Exner numerical flux\n$$\n\\mathcal{F}_{\\text{Exner}} = \\frac{q_b'}{1 - \\lambda_p}.\n$$\n\nUnits and output:\n- All physical quantities must be handled in International System of Units: depths in meters ($\\mathrm{m}$), velocities in meters per second ($\\mathrm{m/s}$), densities in kilograms per cubic meter ($\\mathrm{kg/m^3}$), gravitational acceleration in meters per second squared ($\\mathrm{m/s^2}$), grain size in meters ($\\mathrm{m}$), and bedload and Exner fluxes in square meters per second ($\\mathrm{m^2/s}$) per unit width.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,\\dots]$, where each $r_i$ is the Exner numerical flux $\\mathcal{F}_{\\text{Exner}}$ in $\\mathrm{m^2/s}$ for the corresponding test case.\n\nTest suite:\nFor each test case, you are given the left and right hydrodynamic and bed states and material parameters as a tuple\n$$\n(h_L, u_L, h_R, u_R, z_{b,L}, z_{b,R}, D, \\lambda_p, C_f, \\beta_s, \\Delta x, g, \\rho_w, \\rho_s, \\theta_c),\n$$\nall in the units specified above. Use the following five cases:\n- Case $1$: $(3.0, 1.2, 2.5, 1.0, 0.0, 0.05, 0.0005, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $2$: $(2.0, 0.2, 2.0, 0.15, 0.1, 0.099, 0.0010, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $3$: $(1.0, 0.48, 1.1, 0.5, 0.0, -0.02, 0.0010, 0.35, 0.004, 0.5, 20.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $4$: $(1.5, 1.4, 0.01, 0.0, 0.2, 0.21, 0.0007, 0.4, 0.005, 0.5, 5.0, 9.81, 1025.0, 2650.0, 0.047)$\n- Case $5$: $(2.0, 1.0, 2.5, -0.8, 0.0, 0.0, 0.0006, 0.4, 0.0045, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)$\n\nRequirements:\n- Implement the Harten–Lax–van Leer (HLL) approximate Riemann solver to compute the interfacial hydrodynamic state $U^\\ast$.\n- Use the Meyer-Peter–Müller closure and the specified slope correction to compute $q_b'$ and the Exner numerical flux $\\mathcal{F}_{\\text{Exner}}$.\n- For each test case, compute and return the single float $\\mathcal{F}_{\\text{Exner}}$ in $\\mathrm{m^2/s}$.\n- Your program should produce a single line of output containing a list with the five numerical fluxes in the exact format $[r_1,r_2,r_3,r_4,r_5]$, using Python $3.12$ with the libraries specified.",
            "solution": "The task is to implement a Godunov-type numerical flux for the sediment mass conservation (Exner) equation, which is used in finite-volume methods for modeling morphodynamics. The core of this approach is to solve a local Riemann problem at each cell interface to determine the state that governs the flux. The process is divided into two main parts: first, solving the hydrodynamic Riemann problem using an approximate solver to find an interfacial flow state; and second, using this flow state to compute the bedload sediment transport rate via an empirical closure.\n\nThe evolution of the bed elevation, $z_b(x,t)$, is described by the Exner equation for mass conservation of the sediment bed:\n$$\n\\frac{\\partial z_b}{\\partial t} + \\frac{1}{1-\\lambda_p} \\frac{\\partial q_s}{\\partial x} = 0\n$$\nHere, $q_s(x,t)$ is the volumetric bedload transport rate per unit width, and $\\lambda_p$ is the porosity of the sediment bed. In a finite-volume framework, integrating this equation over a control volume leads to an update formula that requires a numerical flux, $\\mathcal{F}_{\\text{Exner}}$, at the cell interfaces. The flux is related to the sediment transport rate by $\\mathcal{F}_{\\text{Exner}} = q_s / (1 - \\lambda_p)$.\n\nThe sediment transport $q_s$ is primarily driven by the overlying water flow, which is modeled here by the one-dimensional shallow water equations (SWE). The conservative variables for the SWE are $U = [h, hu]^\\top$, where $h$ is the water depth and $u$ is the depth-averaged velocity. The flux of these quantities is given by the vector $F(U) = [hu, hu^2 + \\tfrac{1}{2}gh^2]^\\top$, where $g$ is the acceleration due to gravity. The system is hyperbolic with characteristic speeds (eigenvalues) $\\lambda = u \\pm \\sqrt{gh}$.\n\nThe coupling between the bed and the flow is handled by assuming that on the fast timescale of the hydrodynamic Riemann problem, the bed is fixed. The hydrodynamics are solved first, and the resulting interfacial flow state is then used to calculate the sediment transport, which in turn drives the bed evolution on a slower timescale.\n\n**Step 1: Hydrodynamic Interfacial State via HLL Riemann Solver**\n\nAt an interface between a left state $(h_L, u_L)$ and a right state $(h_R, u_R)$, a Riemann problem is formed. We use the Harten–Lax–van Leer (HLL) approximate Riemann solver to find the interfacial hydrodynamic state. The HLL solver approximates the solution within the Riemann fan, which is bounded by the slowest and fastest wave speeds, $S_L$ and $S_R$. A standard method to estimate these speeds is to take the minimum and maximum of the characteristic speeds from the left and right states:\n$$\nS_L = \\min(u_L - \\sqrt{gh_L}, u_R - \\sqrt{gh_R})\n$$\n$$\nS_R = \\max(u_L + \\sqrt{gh_L}, u_R + \\sqrt{gh_R})\n$$\nThe HLL solver assumes a single constant state, $U^\\ast = [h^\\ast, (hu)^\\ast]^\\top$, within the region defined by $S_L  x/t  S_R$. The state at the interface ($x/t=0$) is determined by the signs of $S_L$ and $S_R$:\n- If $S_L \\ge 0$, the entire wave structure propagates to the right, and the state at the interface is the left state, $U_L$.\n- If $S_R \\le 0$, the entire wave structure propagates to the left, and the state at the interface is the right state, $U_R$.\n- If $S_L  0  S_R$, the interface is within the \"star\" region. The HLL-averaged state $U^\\ast$ is given by:\n$$\nU^\\ast = \\frac{S_R U_R - S_L U_L - (F_R - F_L)}{S_R - S_L}\n$$\nwhere $U_L = [h_L, h_L u_L]^\\top$, $U_R = [h_R, h_R u_R]^\\top$, and $F_L, F_R$ are the corresponding SWE flux vectors. From the conservative state $U^\\ast$, we extract the primitive variables for the interfacial flow: the depth $h^\\ast$ and the velocity $u^\\ast = (hu)^\\ast / h^\\ast$. A safeguard is necessary for the case where $h^\\ast$ is close to zero, in which case $u^\\ast$ can be set to zero.\n\n**Step 2: Bedload Transport Calculation**\n\nWith the interfacial velocity $u^\\ast$ determined, we compute the bedload transport rate using the Meyer-Peter–Müller (MPM) empirical formula.\nFirst, we calculate the bed shear stress, $\\tau_b^*$, induced by the flow, modeled with a quadratic friction law:\n$$\n\\tau_b^* = \\rho_w C_f (u^\\ast)^2\n$$\nwhere $\\rho_w$ is the water density and $C_f$ is a dimensionless friction coefficient.\n\nNext, we compute the Shields parameter, $\\theta^*$, which is a dimensionless measure of the shear stress:\n$$\n\\theta^* = \\frac{\\tau_b^*}{(\\rho_s - \\rho_w) g D}\n$$\nwhere $\\rho_s$ is the sediment density and $D$ is the median grain size.\n\nThe MPM formula includes a critical Shields parameter, $\\theta_c$, representing the threshold for the initiation of motion. Sediment transport occurs only if $\\theta^* > \\theta_c$. If this condition is met, the dimensionless bedload transport rate, $\\Phi_b^*$, is given by:\n$$\n\\Phi_b^* = 8 (\\theta^* - \\theta_c)^{3/2}\n$$\nIf $\\theta^* \\le \\theta_c$, then $\\Phi_b^* = 0$.\n\nThe dimensional magnitude of the bedload transport rate, $q_b^*$, is then found by scaling $\\Phi_b$:\n$$\nq_b^* = \\Phi_b^* \\sqrt{(s-1)gD^3}\n$$\nwhere $s = \\rho_s / \\rho_w$ is the specific gravity of the sediment.\n\n**Step 3: Slope Correction and Final Exner Flux**\n\nThe local bed slope affects the transport rate. A downslope component of gravity acting on the sediment grains enhances transport, while an upslope component hinders it. This is incorporated via a multiplicative correction factor. First, the bed slope $S_b$ at the interface is approximated using the bed elevations of the adjacent cells, $z_{b,L}$ and $z_{b,R}$, and the cell width $\\Delta x$:\n$$\nS_b = \\frac{z_{b,R} - z_{b,L}}{\\Delta x}\n$$\nThe corrected bedload transport magnitude, $q_b'^*$, is then:\n$$\nq_b'^* = q_b^* \\max(0, 1 - \\beta_s S_b)\n$$\nwhere $\\beta_s$ is an empirical parameter. The $\\max(0, \\dots)$ term prevents sediment transport up a very steep adverse slope.\n\nFinally, the bedload transport is a vector quantity. Its direction is determined by the flow direction. The directed sediment transport rate at the interface, $q_s^*$, is:\n$$\nq_s^* = \\operatorname{sign}(u^\\ast) q_b'^*\n$$\nwhere $\\operatorname{sign}(u^\\ast)$ is $+1$ for $u^\\ast > 0$, $-1$ for $u^\\ast  0$, and $0$ for $u^\\ast = 0$.\n\nThe numerical flux for the Exner equation is then computed as:\n$$\n\\mathcal{F}_{\\text{Exner}} = \\frac{q_s^*}{1 - \\lambda_p}\n$$\nThis value represents the rate of sediment volume exchange across the interface, normalized by the active layer volume, and is used to update the bed elevation in the finite-volume scheme.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are imported.\n\ndef solve():\n    \"\"\"\n    Computes the Godunov-type Exner numerical flux for bedload transport for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (h_L, u_L, h_R, u_R, z_b_L, z_b_R, D, lambda_p, C_f, beta_s, delta_x, g, rho_w, rho_s, theta_c)\n        (3.0, 1.2, 2.5, 1.0, 0.0, 0.05, 0.0005, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047),\n        (2.0, 0.2, 2.0, 0.15, 0.1, 0.099, 0.0010, 0.4, 0.004, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047),\n        (1.0, 0.48, 1.1, 0.5, 0.0, -0.02, 0.0010, 0.35, 0.004, 0.5, 20.0, 9.81, 1025.0, 2650.0, 0.047),\n        (1.5, 1.4, 0.01, 0.0, 0.2, 0.21, 0.0007, 0.4, 0.005, 0.5, 5.0, 9.81, 1025.0, 2650.0, 0.047),\n        (2.0, 1.0, 2.5, -0.8, 0.0, 0.0, 0.0006, 0.4, 0.0045, 0.5, 10.0, 9.81, 1025.0, 2650.0, 0.047)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        h_L, u_L, h_R, u_R, z_b_L, z_b_R, D, lambda_p, C_f, beta_s, delta_x, g, rho_w, rho_s, theta_c = case\n        \n        # --- Step 1: HLL Approximate Riemann Solver ---\n        \n        # Handle dry states safely\n        h_L = max(0, h_L)\n        h_R = max(0, h_R)\n\n        c_L = np.sqrt(g * h_L)\n        c_R = np.sqrt(g * h_R)\n\n        # Estimate wave speeds (Davis, 1988)\n        S_L = min(u_L - c_L, u_R - c_R)\n        S_R = max(u_L + c_L, u_R + c_R)\n        \n        h_star, u_star = 0.0, 0.0\n\n        if S_L >= 0:\n            # Entire wave structure moves right, state at interface is Left state\n            h_star, u_star = h_L, u_L\n        elif S_R = 0:\n            # Entire wave structure moves left, state at interface is Right state\n            h_star, u_star = h_R, u_R\n        else: # S_L  0  S_R, interface is in star region\n            # Conservative states\n            U_L = np.array([h_L, h_L * u_L])\n            U_R = np.array([h_R, h_R * u_R])\n            \n            # Flux vectors\n            F_L = np.array([h_L * u_L, h_L * u_L**2 + 0.5 * g * h_L**2])\n            F_R = np.array([h_R * u_R, h_R * u_R**2 + 0.5 * g * h_R**2])\n            \n            # HLL-averaged state U*\n            if abs(S_R - S_L) > 1e-9:\n                U_star = (S_R * U_R - S_L * U_L - (F_R - F_L)) / (S_R - S_L)\n                h_star = U_star[0]\n                \n                # Safeguard for vanishing depth\n                if h_star > 1e-9:\n                    u_star = U_star[1] / h_star\n                else:\n                    h_star = 0.0\n                    u_star = 0.0 # No depth, no velocity\n            else: # States are nearly identical\n                h_star, u_star = (h_L + h_R) / 2, (u_L + u_R) / 2\n\n        # --- Step 2: Bedload Transport Calculation (Meyer-Peter-Müller) ---\n        \n        q_s_star = 0.0\n        \n        if h_star > 1e-9:\n            # Bed shear stress\n            tau_b_star = rho_w * C_f * u_star**2\n            \n            # Shields parameter\n            rho_diff_g_D = (rho_s - rho_w) * g * D\n            if rho_diff_g_D > 1e-9:\n                theta_star_star = tau_b_star / rho_diff_g_D\n            else:\n                theta_star_star = 0.0\n\n            if theta_star_star > theta_c:\n                # Dimensionless bedload transport rate\n                Phi_b_star = 8.0 * (theta_star_star - theta_c)**1.5\n                \n                # Dimensional bedload transport magnitude\n                s = rho_s / rho_w\n                q_b_star_factor = np.sqrt(max(0, s - 1.0) * g * D**3)\n                q_b_star = Phi_b_star * q_b_star_factor\n                \n                # --- Step 3: Slope Correction and Final Flux ---\n                \n                # Bed slope\n                S_b = (z_b_R - z_b_L) / delta_x\n                \n                # Corrected bedload magnitude\n                q_b_prime_star = q_b_star * max(0.0, 1.0 - beta_s * S_b)\n                \n                # Directed sediment transport rate\n                q_s_star = np.sign(u_star) * q_b_prime_star\n\n        # Exner numerical flux\n        exner_flux = q_s_star / (1.0 - lambda_p)\n        results.append(exner_flux)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}