{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any wave model is an understanding of how quickly disturbances propagate. This first exercise takes you back to fundamental principles, guiding you through the derivation of the phase speed for long waves, $c = \\sqrt{gh}$, from the linearized shallow-water equations. By calculating the travel time of a tsunami-like wave across a basin, you will solidify your understanding of the core physics governing these large-scale phenomena .",
            "id": "3811914",
            "problem": "Consider a rectangular basin of uniform depth $h$ and width $L$, aligned along the horizontal coordinate $x \\in [0,L]$. Assume an inviscid, incompressible fluid of constant density, hydrostatic balance, and a free surface displacement $\\eta(x,t)$ with depth-averaged horizontal velocity $u(x,t)$ satisfying the linearized one-dimensional shallow-water equations. Let the basin be bounded by vertical sidewalls at $x=0$ and $x=L$ with no-normal-flow boundary conditions. An initial, localized free-surface disturbance is imposed near the left end, $\\eta(x,0)=\\eta_{0}\\exp\\!\\big(-x^{2}/(2\\sigma^{2})\\big)$ with $\\sigma \\gg h$ and $u(x,0)=0$, and thereafter the system evolves freely without external forcing. Neglect Earth’s rotation on the grounds that the travel time across the basin is much shorter than the local inertial period.\n\nStarting from conservation of mass and momentum and the hydrostatic approximation, derive the nondispersive long-wave propagation speed in terms of the gravitational acceleration $g$ and the basin depth $h$. Using that result, estimate the earliest arrival time of the leading disturbance at $x=L$.\n\nUse the parameter values $h=75\\,\\mathrm{m}$, $L=180\\,\\mathrm{km}$, and $g=9.81\\,\\mathrm{m\\,s^{-2}}$. Express the wave speed in $\\mathrm{m\\,s^{-1}}$ and the travel time in hours. Round both quantities to $4$ significant figures. The final answer must be presented as two values in a single row matrix corresponding to $\\big(\\text{speed},\\ \\text{travel time}\\big)$ in the order stated.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   **Geometry and Coordinates**: Rectangular basin of uniform depth $h$ and width $L$. Horizontal coordinate $x \\in [0,L]$.\n-   **Fluid Properties**: Inviscid, incompressible fluid of constant density $\\rho$.\n-   **Physical Approximations**: Hydrostatic balance. Neglect Earth’s rotation.\n-   **Variables**: Free surface displacement $\\eta(x,t)$, depth-averaged horizontal velocity $u(x,t)$.\n-   **Governing Equations**: Linearized one-dimensional shallow-water equations.\n-   **Boundary Conditions**: Vertical sidewalls at $x=0$ and $x=L$ with no-normal-flow, i.e., $u(0,t)=0$ and $u(L,t)=0$.\n-   **Initial Conditions**: $u(x,0)=0$. Initial free-surface disturbance $\\eta(x,0)=\\eta_{0}\\exp(-x^{2}/(2\\sigma^{2}))$.\n-   **Parameter Constraints**: $\\sigma \\gg h$. System evolves freely (no external forcing).\n-   **Constants**: Gravitational acceleration $g=9.81\\,\\mathrm{m\\,s^{-2}}$, basin depth $h=75\\,\\mathrm{m}$, basin width $L=180\\,\\mathrm{km}$.\n-   **Required Tasks**:\n    1.  Derive the nondispersive long-wave propagation speed in terms of $g$ and $h$.\n    2.  Estimate the earliest arrival time of the leading disturbance at $x=L$.\n-   **Output Format**: Wave speed in $\\mathrm{m\\,s^{-1}}$ and travel time in hours, rounded to $4$ significant figures, presented as a row matrix.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the shallow-water equations, a cornerstone of geophysical fluid dynamics for modeling tsunamis, tides, and storm surges. The assumptions (inviscid, incompressible, hydrostatic) are standard for deriving these equations. The setup is physically realistic.\n-   **Well-Posed**: The problem provides governing equations, initial conditions, and boundary conditions. The initial disturbance is localized, and its characteristic length scale $\\sigma$ is much larger than the depth $h$, which is the condition for the validity of the shallow-water approximation ($\\lambda \\gg h$, where the characteristic wavelength $\\lambda$ is of order $\\sigma$). A unique solution exists.\n-   **Objective**: The problem is stated using precise, formal, and unbiased scientific language.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard exercise in wave dynamics. The solution will be provided.\n\n### Derivation of the Nondispersive Long-Wave Speed\n\nWe begin with the fundamental principles of fluid dynamics for an inviscid, incompressible fluid in a two-dimensional $(x,z)$ vertical plane, where $z$ is the vertical coordinate, positive upwards, with $z=0$ at the undisturbed free surface.\n\nThe conservation of momentum in the vertical direction is given by the Euler equation:\n$$\n\\frac{Dw}{Dt} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} - g\n$$\nwhere $w$ is the vertical velocity, $p$ is the pressure, $\\rho$ is the constant density, and $g$ is the acceleration due to gravity. The long-wave or shallow-water approximation assumes that the horizontal length scale of the motion is much larger than the vertical length scale (the depth $h$). This implies that vertical accelerations are negligible compared to gravity, $\\frac{Dw}{Dt} \\ll g$. The momentum equation thus reduces to the hydrostatic balance equation:\n$$\n\\frac{\\partial p}{\\partial z} = -\\rho g\n$$\nIntegrating this equation from a depth $z$ to the free surface at $z=\\eta(x,t)$, where the pressure is atmospheric $p_{atm}$, we get:\n$$\np(x,z,t) - p_{atm} = \\int_{z}^{\\eta(x,t)} \\rho g \\,dz' = \\rho g (\\eta(x,t) - z)\n$$\nAssuming $p_{atm}$ is constant and can be set to zero for gauge pressure, we have $p(x,z,t) = \\rho g (\\eta(x,t) - z)$.\n\nThe horizontal momentum equation is:\n$$\n\\frac{Du}{Dt} = \\frac{\\partial u}{\\partial t} + u\\frac{\\partial u}{\\partial x} + w\\frac{\\partial u}{\\partial z} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}\n$$\nTaking the horizontal pressure gradient from our hydrostatic expression for $p$:\n$$\n\\frac{\\partial p}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\rho g (\\eta(x,t) - z) \\right] = \\rho g \\frac{\\partial \\eta}{\\partial x}\n$$\nThis gradient is independent of depth $z$. Consequently, the horizontal acceleration is uniform with depth. If the fluid starts from rest, the horizontal velocity $u$ will remain independent of depth, so $u=u(x,t)$. The horizontal momentum equation becomes:\n$$\n\\frac{\\partial u}{\\partial t} + u\\frac{\\partial u}{\\partial x} = -g \\frac{\\partial \\eta}{\\partial x}\n$$\nNext, we derive the continuity equation. For an incompressible fluid, $\\nabla \\cdot \\mathbf{v} = 0$, which in 2D is $\\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0$. We integrate this over the water column, from the flat bottom at $z=-h$ to the free surface at $z=\\eta$:\n$$\n\\int_{-h}^{\\eta} \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} \\right) dz = 0\n$$\nSince $u$ is independent of $z$, the first term is $\\int_{-h}^{\\eta} \\frac{\\partial u}{\\partial x} dz = \\frac{\\partial u}{\\partial x} \\int_{-h}^{\\eta} dz = (h+\\eta)\\frac{\\partial u}{\\partial x}$. The second term integrates to $w(x,\\eta,t) - w(x,-h,t)$. The bottom at $z=-h$ is impermeable, so $w(x,-h,t)=0$. At the free surface $z=\\eta$, fluid particles must follow the surface, which gives the kinematic boundary condition $w(x,\\eta,t) = \\frac{D\\eta}{Dt} = \\frac{\\partial \\eta}{\\partial t} + u\\frac{\\partial \\eta}{\\partial x}$.\nSubstituting these into the integrated continuity equation gives:\n$$\n(h+\\eta)\\frac{\\partial u}{\\partial x} + \\frac{\\partial \\eta}{\\partial t} + u\\frac{\\partial \\eta}{\\partial x} = 0\n$$\nThis can be written as $\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x} [u(h+\\eta)] = 0$.\n\nThe nonlinear shallow-water equations are thus:\n1.  $\\frac{\\partial u}{\\partial t} + u\\frac{\\partial u}{\\partial x} + g \\frac{\\partial \\eta}{\\partial x} = 0$\n2.  $\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x} [u(h+\\eta)] = 0$\n\nFor small-amplitude waves, we assume the disturbance is small, i.e., $|\\eta| \\ll h$, and the resulting velocities are also small. We can linearize the equations by neglecting products of small quantities (e.g., $u\\frac{\\partial u}{\\partial x}$ and $u\\eta$).\nThe momentum equation becomes:\n$$\n\\frac{\\partial u}{\\partial t} + g \\frac{\\partial \\eta}{\\partial x} = 0\n$$\nThe continuity equation becomes:\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}(uh) = 0 \\implies \\frac{\\partial \\eta}{\\partial t} + h\\frac{\\partial u}{\\partial x} = 0\n$$\nTo obtain a single wave equation for $\\eta$, we differentiate the linearized momentum equation with respect to $x$ and the linearized continuity equation with respect to $t$:\n$$\n\\frac{\\partial^2 u}{\\partial t \\partial x} + g \\frac{\\partial^2 \\eta}{\\partial x^2} = 0\n$$\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + h \\frac{\\partial^2 u}{\\partial t \\partial x} = 0\n$$\nSubstituting $\\frac{\\partial^2 u}{\\partial t \\partial x} = -g \\frac{\\partial^2 \\eta}{\\partial x^2}$ from the first into the second equation, we get:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + h \\left(-g \\frac{\\partial^2 \\eta}{\\partial x^2}\\right) = 0 \\implies \\frac{\\partial^2 \\eta}{\\partial t^2} = gh \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\nThis is the one-dimensional classical wave equation, $\\frac{\\partial^2 \\eta}{\\partial t^2} = c^2 \\frac{\\partial^2 \\eta}{\\partial x^2}$, where the wave propagation speed $c$ is given by:\n$$\nc = \\sqrt{gh}\n$$\nThis speed is independent of wavelength or frequency, hence the waves are \"nondispersive\".\n\n### Calculation of Wave Speed and Travel Time\n\nUsing the given parameter values:\n-   $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n-   $h = 75\\,\\mathrm{m}$\n-   $L = 180\\,\\mathrm{km} = 180 \\times 10^3\\,\\mathrm{m}$\n\nThe wave speed $c$ is:\n$$\nc = \\sqrt{9.81\\,\\mathrm{m\\,s^{-2}} \\times 75\\,\\mathrm{m}} = \\sqrt{735.75}\\,\\mathrm{m\\,s^{-1}} \\approx 27.124712\\,\\mathrm{m\\,s^{-1}}\n$$\nRounding to $4$ significant figures, the wave speed is $c = 27.12\\,\\mathrm{m\\,s^{-1}}$.\n\nThe initial disturbance is localized near $x=0$. The earliest arrival of the leading edge of this disturbance at the other end of the basin, $x=L$, is estimated by the time it takes for the wave to travel this distance at the constant speed $c$.\nThe travel time $t$ is:\n$$\nt = \\frac{L}{c} = \\frac{180 \\times 10^3\\,\\mathrm{m}}{27.124712\\,\\mathrm{m\\,s^{-1}}} \\approx 6636.032\\,\\mathrm{s}\n$$\nTo express this time in hours, we divide by the number of seconds in an hour ($3600\\,\\mathrm{s}$):\n$$\nt_{\\text{hours}} = \\frac{6636.032\\,\\mathrm{s}}{3600\\,\\mathrm{s/h}} \\approx 1.843342\\,\\mathrm{h}\n$$\nRounding to $4$ significant figures, the travel time is $t = 1.843\\,\\mathrm{h}$.\n\nThe two requested values are the wave speed ($27.12\\,\\mathrm{m\\,s^{-1}}$) and the travel time ($1.843\\,\\mathrm{h}$).",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 27.12 & 1.843 \\end{pmatrix} } $$"
        },
        {
            "introduction": "While the simple wave speed provides a crucial first estimate, real-world storm surges are governed by a complex interplay of forces. This practice introduces the powerful technique of scaling analysis to determine the dominant dynamical balances in a realistic storm surge scenario. By calculating key dimensionless numbers—the Froude, Rossby, and Reynolds numbers—you will learn to justify which physical effects, such as Earth's rotation or nonlinear advection, are critical to include in a predictive model .",
            "id": "3811860",
            "problem": "A landfalling tropical cyclone drives a storm surge over a mid-latitude continental shelf. Consider the depth-averaged barotropic dynamics over a shelf of approximately uniform depth. Your goal is to determine which terms dominate the horizontal momentum balance by nondimensionalizing the governing equations and evaluating the resulting dimensionless numbers.\n\nAssume the following scientifically realistic characteristic scales and parameters:\n- Characteristic horizontal velocity magnitude: $U = 2.0 \\ \\mathrm{m \\ s^{-1}}$.\n- Mean water depth on the shelf: $H = 20 \\ \\mathrm{m}$.\n- Horizontal length scale representative of the across-shelf surge gradient: $L = 50 \\ \\mathrm{km}$.\n- Gravitational acceleration: $g = 9.81 \\ \\mathrm{m \\ s^{-2}}$.\n- Planetary rotation rate: $\\Omega = 7.2921159 \\times 10^{-5} \\ \\mathrm{s^{-1}}$.\n- Latitude: $\\phi = 30^{\\circ}$, so the Coriolis parameter is $f = 2 \\Omega \\sin \\phi$.\n- Effective horizontal eddy viscosity (representative of depth-averaged mesoscale/turbulent mixing used in storm surge models): $\\nu = 20 \\ \\mathrm{m^{2} \\ s^{-1}}$.\n\nTasks:\n1. Starting from the depth-averaged, hydrostatic, incompressible shallow water momentum equations derived from the Navier–Stokes equations under the Boussinesq approximation, nondimensionalize the equations using the characteristic scales $U$, $L$, and $H$. Identify the dimensionless groups that multiply the free-surface pressure gradient, Coriolis, and viscous diffusion terms. Denote these dimensionless numbers by the Froude number $Fr$, the Rossby number $Ro$, and the Reynolds number $Re = UL/\\nu$.\n2. Using the provided numerical values, compute $Fr$, $Ro$, and $Re$.\n3. Based on the magnitudes of $Fr$, $Ro$, and $Re$, argue which leading-order balances dominate the interior surge dynamics on the shelf, commenting on the relative importance of pressure gradient, Coriolis, nonlinear advection, and viscosity.\n\nAnswer specification:\n- Express the final answer as the row vector $\\big[ Fr \\ \\ Ro \\ \\ Re \\big]$, rounded to three significant figures, with no units.\n- Angles are given in degrees in the data above; you may evaluate trigonometric functions accordingly.",
            "solution": "We begin from the depth-averaged barotropic shallow water momentum equations, which follow from the incompressible Navier–Stokes equations under the Boussinesq and hydrostatic approximations and vertical integration over depth:\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla \\boldsymbol{u} + f \\, \\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}\n= - g \\, \\nabla \\eta + \\nu \\, \\nabla^{2} \\boldsymbol{u} + \\boldsymbol{\\mathcal{F}},\n$$\nwhere $\\boldsymbol{u}(x,y,t)$ is the depth-averaged horizontal velocity, $\\eta(x,y,t)$ is the free-surface elevation, $f$ is the Coriolis parameter, $g$ is gravitational acceleration, $\\nu$ is an effective horizontal eddy viscosity, $\\hat{\\boldsymbol{k}}$ is the vertical unit vector, and $\\boldsymbol{\\mathcal{F}}$ represents parameterized stresses (e.g., wind and bottom friction). The depth-averaged continuity equation is\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\nabla \\cdot (H \\boldsymbol{u}) = 0,\n$$\nwith $H$ the mean depth.\n\nTo assess dynamical regimes, we nondimensionalize. Define characteristic scales: horizontal velocity $U$, horizontal length $L$, time $T = L/U$, and free-surface elevation scale $\\eta_{0}$. Introduce nondimensional variables:\n$$\n\\boldsymbol{x} = L \\boldsymbol{x}', \\quad t = T t', \\quad \\boldsymbol{u} = U \\boldsymbol{u}', \\quad \\eta = \\eta_{0} \\eta', \\quad \\nabla = \\frac{1}{L} \\nabla'.\n$$\nSubstituting into the momentum equation and dividing by the inertial scale $U^{2}/L$ gives\n$$\n\\underbrace{\\frac{\\partial \\boldsymbol{u}'}{\\partial t'} + \\boldsymbol{u}' \\cdot \\nabla' \\boldsymbol{u}'}_{\\text{order }1}\n+ \\underbrace{\\frac{fL}{U}}_{Ro^{-1}} \\, \\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}'\n= - \\underbrace{\\frac{g \\eta_{0}}{U^{2}}}_{\\Pi_{p}} \\, \\nabla' \\eta' + \\underbrace{\\frac{\\nu}{U L}}_{Re^{-1}} \\, \\nabla'^{2} \\boldsymbol{u}' + \\frac{L}{U^{2}} \\boldsymbol{\\mathcal{F}}.\n$$\nHere we have identified a Rossby number\n$$\nRo = \\frac{U}{f L},\n$$\nand a Reynolds number\n$$\nRe = \\frac{U L}{\\nu}.\n$$\nTo connect the free-surface pressure gradient to the Froude number, we relate the elevation scale $\\eta_{0}$ to kinematics via the continuity equation. Nondimensionalizing continuity:\n$$\n\\frac{\\eta_{0}}{T} \\frac{\\partial \\eta'}{\\partial t'} + H \\frac{U}{L} \\nabla' \\cdot \\boldsymbol{u}' = 0 \\quad \\Rightarrow \\quad \\frac{\\eta_{0}}{T} \\sim H \\frac{U}{L}.\n$$\nWith $T = L/U$, this yields $\\eta_{0} \\sim H$. Using $\\eta_{0} \\sim H$ in the pressure gradient prefactor gives\n$$\n\\Pi_{p} = \\frac{g \\eta_{0}}{U^{2}} \\sim \\frac{g H}{U^{2}} = \\frac{1}{Fr^{2}},\n$$\nwhere the Froude number is\n$$\nFr = \\frac{U}{\\sqrt{g H}}.\n$$\nThus the nondimensional momentum balance reads\n$$\n\\frac{\\partial \\boldsymbol{u}'}{\\partial t'} + \\boldsymbol{u}' \\cdot \\nabla' \\boldsymbol{u}' + Ro^{-1} \\, \\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}'\n= - Fr^{-2} \\, \\nabla' \\eta' + Re^{-1} \\, \\nabla'^{2} \\boldsymbol{u}' + \\cdots,\n$$\nwith ellipsis denoting additional nondimensionalized forcing terms (e.g., wind stress and bottom drag), whose relative sizes can be compared separately.\n\nWe now evaluate the dimensionless numbers using the given data.\n\nCoriolis parameter at latitude $\\phi = 30^{\\circ}$:\n$$\nf = 2 \\Omega \\sin \\phi = 2 \\times \\left(7.2921159 \\times 10^{-5} \\ \\mathrm{s^{-1}}\\right) \\times \\sin(30^{\\circ})\n= 7.2921159 \\times 10^{-5} \\ \\mathrm{s^{-1}}.\n$$\n\nFroude number:\n$$\nFr = \\frac{U}{\\sqrt{g H}} = \\frac{2.0}{\\sqrt{9.81 \\times 20}} = \\frac{2.0}{\\sqrt{196.2}}.\n$$\nCompute $\\sqrt{196.2} \\approx 14.007$; hence\n$$\nFr \\approx \\frac{2.0}{14.007} \\approx 0.1428 \\quad \\Rightarrow \\quad Fr \\text{ (three significant figures)} = 0.143.\n$$\n\nRossby number:\n$$\nRo = \\frac{U}{f L} = \\frac{2.0}{\\left(7.2921159 \\times 10^{-5}\\right) \\times \\left(5.0 \\times 10^{4}\\right)}\n= \\frac{2.0}{3.64605795} \\approx 0.5486 \\quad \\Rightarrow \\quad Ro \\text{ (three significant figures)} = 0.549.\n$$\n\nReynolds number:\n$$\nRe = \\frac{U L}{\\nu} = \\frac{2.0 \\times 5.0 \\times 10^{4}}{20} = \\frac{1.0 \\times 10^{5}}{20} = 5.0 \\times 10^{3}.\n$$\nRounded to three significant figures, $Re = 5.00 \\times 10^{3}$.\n\nInterpretation of dynamical balances:\n- Since $Fr \\ll 1$ (here $Fr \\approx 0.143$), the flow is strongly subcritical and hydrostatic, with surface gravity restoring forces large compared to inertial acceleration. This supports the use of shallow water dynamics and implies that free-surface pressure gradients are an order-one control on the momentum balance.\n- With $Ro = \\mathcal{O}(1)$ (here $\\approx 0.55$), rotational effects are comparable to inertial terms. Thus, a near-geostrophic balance between the free-surface pressure gradient and the Coriolis force is expected at leading order in the surge interior, with ageostrophic contributions from local acceleration and advection that are not negligible.\n- With $Re \\gg 1$ (here $5.00 \\times 10^{3}$), viscous diffusion at the scale $L$ is weak relative to inertia; interior horizontal viscous terms are subdominant. Momentum dissipation is expected to occur primarily through boundary layers and parameterized bottom drag rather than through Laplacian diffusion, consistent with depth-averaged storm surge modeling practice.\n\nTherefore, the dominant interior balance on the shelf during surge is between the free-surface pressure gradient and the Coriolis force, modulated by finite but secondary unsteady and advective effects; horizontal viscous diffusion is negligible at the scale $L$ considered.\n\nFinally, we present the requested row vector, rounded to three significant figures and with no units.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.143 & 0.549 & 5.00 \\times 10^{3}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving from theory to computation, this final practice addresses a critical numerical challenge in inundation modeling: the moving boundary between wet and dry areas. You will design and implement a finite volume solver for the nonlinear shallow water equations, incorporating essential stabilization techniques like momentum capping to handle shoreline advancement and retreat robustly. This exercise provides direct, hands-on experience in building a stable and physically realistic model for coastal flooding scenarios .",
            "id": "3811923",
            "problem": "You are asked to design and implement a one-dimensional numerical solver for the depth-averaged nonlinear shallow water equations to model shoreline motion at wet/dry fronts in the context of storm surge and tsunami modeling, and to use it to verify physical plausibility of shoreline movement under controlled scenarios. Your derivation and implementation must start from the following fundamental base and proceed in a logically consistent way:\n\n- The one-dimensional nonlinear shallow water equations over a horizontal bed are\n$$\n\\frac{\\partial h}{\\partial t} + \\frac{\\partial (h u)}{\\partial x} = 0,\n\\qquad\n\\frac{\\partial (h u)}{\\partial t} + \\frac{\\partial \\left(h u^2 + \\tfrac{1}{2} g h^2\\right)}{\\partial x} = 0,\n$$\nwhere $h$ is the water depth in $\\mathrm{m}$, $u$ is the depth-averaged velocity in $\\mathrm{m/s}$, and $g$ is the gravitational acceleration in $\\mathrm{m/s^2}$.\n\n- A wet/dry front occurs when $h \\to 0$ locally, which can destabilize naive discretizations due to division by $h$ in $u = (h u)/h$ and the lack of positivity-preserving reconstruction. Your numerical design must enforce $h \\ge 0$ at all times and avoid unphysical velocities in near-dry cells.\n\nYou must:\n\n1. Explain conceptually how either hydrostatic reconstruction or momentum capping stabilizes wet/dry fronts, starting from the above equations and the properties of their characteristic speeds, and how this prevents spurious shoreline motion. Your implementation must reflect this design choice by including both a positivity-preserving reconstruction of states at cell interfaces and a velocity cap proportional to local gravity wave speed.\n\n2. Implement a consistent explicit finite volume method on a uniform grid in one spatial dimension with transmissive boundary conditions, using an upwind flux that respects the characteristic wave speeds $u \\pm \\sqrt{g h}$. Your numerical flux must be positivity-preserving and handle $h \\to 0$ without producing negative depths. You must use a Courant–Friedrichs–Lewy (CFL) condition to set the time step, with $0 < \\mathrm{CFL} \\le 1$.\n\n3. Enforce hydrostatic reconstruction that guarantees non-negative reconstructed interface states by ensuring that any reconstructed water height is truncated to maintain $h \\ge 0$ at interfaces. In addition, enforce momentum capping by bounding the velocity according to\n$$\n|u| \\le \\alpha \\sqrt{g h},\n$$\nfor a chosen constant $\\alpha$ in dimensionless form, which operates pointwise in cells after each update. This is to prevent unphysically large $|u|$ in near-dry regions.\n\n4. Construct and run the following test suite, all with $g$ expressed in $\\mathrm{m/s^2}$, spatial positions in $\\mathrm{m}$, time in $\\mathrm{s}$, depths in $\\mathrm{m}$, and velocities in $\\mathrm{m/s}$:\n   - Test $1$ (dam-break onto dry bed, happy path): $L = 100.0$, $\\Delta x = 0.5$, $g = 9.81$, $T_{\\text{end}} = 10.0$, $\\mathrm{CFL} = 0.9$, $\\alpha = 2.0$, initial condition $h(x,0) = h_L$ for $x \\le L/2$ and $h(x,0) = h_R$ for $x > L/2$ with $h_L = 1.0$ and $h_R = 0.0$, and $u(x,0) = 0$. Track the shoreline defined by the rightmost location where $h$ exceeds a dryness threshold $h_{\\text{th}} = 10^{-4}$. Compute the average shoreline speed $\\bar{s}$ over $[0, T_{\\text{end}}]$ as shoreline displacement divided by $T_{\\text{end}}$. The physically plausible range is anchored by the gravity-wave head speed $s_* = 2 \\sqrt{g h_L}$. Declare the result for this test as a boolean that is true if $0.8 s_* \\le \\bar{s} \\le 1.2 s_*$ and false otherwise.\n   - Test $2$ (dam-break with near-dry left pool, edge case): $L = 20.0$, $\\Delta x = 0.1$, $g = 9.81$, $T_{\\text{end}} = 5.0$, $\\mathrm{CFL} = 0.9$, $\\alpha = 2.0$, $h_L = 0.01$, $h_R = 0.0$, $u(x,0) = 0$, and the same shoreline tracking and dryness threshold as Test $1$. Compute $\\bar{s}$ and compare to $s_* = 2 \\sqrt{g h_L}$. Declare the boolean true if $0.8 s_* \\le \\bar{s} \\le 1.2 s_*$ and false otherwise.\n   - Test $3$ (still water, boundary case): $L = 50.0$, $\\Delta x = 0.5$, $g = 9.81$, $T_{\\text{end}} = 5.0$, $\\mathrm{CFL} = 0.9$, $\\alpha = 2.0$, uniform initial condition $h(x,0) = 1.0$, $u(x,0) = 0$. Declare the boolean true if the maximum absolute velocity over all cells and times remains below $10^{-3}$, and false otherwise.\n\n5. Use transmissive boundary conditions so that waves can leave the domain without artificial reflection. Guarantee that $h \\ge 0$ throughout by truncation if necessary.\n\n6. Your program must produce a single line of output containing the three boolean results for Tests $1$–$3$ as a comma-separated list enclosed in square brackets (for example, $[{\\text{True}},{\\text{False}},{\\text{True}}]$). No other text should be printed.\n\nAll results must be computed in the specified units, and angles (if any) must be in radians. Your implementation must not require any external inputs. The numerical method must be sufficiently accurate to resolve the test behaviors under the given discretizations without producing unphysical negative depths or runaway velocities. The code must be self-contained and runnable \"as is\".",
            "solution": "The user requests the design and implementation of a one-dimensional numerical solver for the nonlinear shallow water equations (SWEs), with a focus on stable and physically plausible modeling of shoreline motion at wet/dry fronts.\n\n### Governing Equations and System Properties\n\nThe one-dimensional nonlinear shallow water equations for a flat, frictionless bed are given as a system of conservation laws:\n$$\n\\frac{\\partial h}{\\partial t} + \\frac{\\partial (h u)}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial (h u)}{\\partial t} + \\frac{\\partial \\left(h u^2 + \\tfrac{1}{2} g h^2\\right)}{\\partial x} = 0\n$$\nwhere $h(x,t)$ is the water depth, $u(x,t)$ is the depth-averaged velocity, and $g$ is the gravitational acceleration.\n\nThis system can be written in vector form $\\frac{\\partial \\mathbf{Q}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}$, with the vector of conserved quantities $\\mathbf{Q}$ and the flux vector $\\mathbf{F}(\\mathbf{Q})$ defined as:\n$$\n\\mathbf{Q} = \\begin{pmatrix} h \\\\ hu \\end{pmatrix}, \\qquad\n\\mathbf{F}(\\mathbf{Q}) = \\begin{pmatrix} hu \\\\ hu^2 + \\frac{1}{2}gh^2 \\end{pmatrix}\n$$\nThis system is hyperbolic. The local propagation speeds of information are given by the eigenvalues of the flux Jacobian matrix $\\mathbf{A} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{Q}}$. These eigenvalues, known as the characteristic speeds, are $\\lambda_{1,2} = u \\pm \\sqrt{gh}$. These speeds represent the velocities of right- and left-propagating surface gravity waves relative to the fluid's bulk motion.\n\n### Numerical Method: Explicit Finite Volume Scheme\n\nWe discretize the spatial domain into uniform cells of width $\\Delta x$. The cell-averaged conserved quantities at time $t^n$ in cell $i$ are denoted by $\\mathbf{Q}_i^n$. An explicit finite volume method updates these quantities from time $t^n$ to $t^{n+1} = t^n + \\Delta t$ using the formula:\n$$\n\\mathbf{Q}_i^{n+1} = \\mathbf{Q}_i^n - \\frac{\\Delta t}{\\Delta x} \\left( \\mathbf{F}_{i+1/2} - \\mathbf{F}_{i-1/2} \\right)\n$$\nwhere $\\mathbf{F}_{i\\pm 1/2}$ are the numerical fluxes at the cell interfaces. The choice of numerical flux is critical for stability and accuracy, especially in the presence of shocks, discontinuities, and wet/dry fronts.\n\n### Challenges and Stabilization at Wet/Dry Fronts\n\nA wet/dry front, where $h \\to 0$, poses significant numerical challenges:\n1.  **Positivity Violation**: Standard numerical schemes can produce small negative values for water depth $h$ due to numerical oscillations near sharp gradients (Gibbs phenomenon). A negative water depth is unphysical and can lead to simulation failure, as terms like $\\sqrt{gh}$ become undefined.\n2.  **Spurious Velocities**: The velocity $u$ is computed from the conserved quantities as $u = (hu)/h$. When $h$ becomes very small, any small numerical error in the momentum $hu$ can be amplified into a large, unphysical velocity $u$. This can lead to jets of water spuriously emanating from nearly dry cells, violating conservation principles and causing instability.\n\nTo address these issues, specialized techniques are required. The problem specifies hydrostatic reconstruction and momentum capping.\n\n#### 1. Positivity-Preserving Reconstruction and Upwind Flux\n\nThe term \"hydrostatic reconstruction\" typically refers to a technique for well-balanced schemes that accurately preserve a state of rest ($u=0$) over non-flat bathymetry. For the specified problem with a flat bed, the core idea is to ensure the scheme is **positivity-preserving**. This means that if all cell-average depths $h_i^n$ are non-negative, the scheme must guarantee that all $h_i^{n+1}$ are also non-negative, under a suitable time-step restriction.\n\nAn upwind numerical flux that respects the characteristic speeds is essential. We will use the Harten-Lax-van Leer (HLL) approximate Riemann solver, which is well-suited for the SWEs due to its robustness and positivity-preserving properties. The HLL flux at an interface between a left state $\\mathbf{Q}_L$ and a right state $\\mathbf{Q}_R$ is:\n$$\n\\mathbf{F}^{\\text{HLL}}(\\mathbf{Q}_L, \\mathbf{Q}_R) =\n\\begin{cases}\n\\mathbf{F}(\\mathbf{Q}_L) & \\text{if } S_L \\ge 0 \\\\\n\\frac{S_R \\mathbf{F}(\\mathbf{Q}_L) - S_L \\mathbf{F}(\\mathbf{Q}_R) + S_L S_R (\\mathbf{Q}_R - \\mathbf{Q}_L)}{S_R - S_L} & \\text{if } S_L < 0 < S_R \\\\\n\\mathbf{F}(\\mathbf{Q}_R) & \\text{if } S_R \\le 0\n\\end{cases}\n$$\nThe signal velocities $S_L$ and $S_R$ are estimates for the minimum and maximum characteristic speeds in the Riemann fan. A common and robust choice is:\n$$\nS_L = \\min(u_L - \\sqrt{gh_L}, u_R - \\sqrt{gh_R})\n$$\n$$\nS_R = \\max(u_L + \\sqrt{gh_L}, u_R + \\sqrt{gh_R})\n$$\nAt a wet/dry front (e.g., $h_L > 0$ and $h_R = 0$), these wave speed estimates correctly account for the one-sided nature of the information flow, preventing spurious fluxes into the dry region. For a first-order scheme, we reconstruct the states at the interface by simply taking the cell-average values: $\\mathbf{Q}_L = \\mathbf{Q}_i$ and $\\mathbf{Q}_R = \\mathbf{Q}_{i+1}$.\n\nIn addition to the HLL flux, a robust implementation includes an explicit truncation step after the main update to enforce positivity as required:\n$$\nh_i^{n+1} \\leftarrow \\max(0, h_i^{n+1})\n$$\nIf this truncation sets $h_i^{n+1}$ to $0$, the corresponding momentum $(hu)_i^{n+1}$ must also be set to $0$ to maintain consistency. This combination ensures that the water depth remains non-negative and prevents the creation of spurious mass.\n\n#### 2. Momentum Capping\n\nTo prevent the generation of unphysically large velocities in near-dry cells (where $h$ is small but non-zero), momentum capping is applied. After each time step update, the velocity in each cell is checked and limited. As specified, the velocity magnitude $|u|$ is capped by a value proportional to the local gravity wave speed:\n$$\n|u_i^{n+1}| \\le \\alpha \\sqrt{g h_i^{n+1}}\n$$\nwhere $\\alpha$ is a dimensionless constant (e.g., $\\alpha=2.0$). This is performed pointwise after the new state $\\mathbf{Q}_i^{n+1}$ is computed:\n1.  If $h_i^{n+1}$ is above a small dry-state threshold, compute $u_i^{n+1} = (hu)_i^{n+1} / h_i^{n+1}$.\n2.  Calculate the velocity limit $u_{\\text{cap}} = \\alpha \\sqrt{g h_i^{n+1}}$.\n3.  If $|u_i^{n+1}| > u_{\\text{cap}}$, update the velocity: $u_i^{n+1} \\leftarrow \\text{sign}(u_i^{n+1}) u_{\\text{cap}}$.\n4.  Update the momentum to be consistent with the capped velocity: $(hu)_i^{n+1} \\leftarrow h_i^{n+1} u_i^{n+1}$.\n\nThis procedure directly prevents the numerical instability caused by dividing a small non-zero momentum by a near-zero depth, thus ensuring a stable evolution of the shoreline.\n\n### Implementation Algorithm Summary\n\nThe solver is implemented as follows:\n1.  **Initialization**: Set up a uniform spatial grid with $N$ cells of size $\\Delta x$ over the domain of length $L$. Include one ghost cell at each end to handle boundary conditions. Initialize the cell-averaged state vectors $\\mathbf{Q}_i$ (i.e., $h_i$ and $(hu)_i$) according to the test case's initial conditions.\n2.  **Time Loop**: Iterate from $t=0$ until $t \\ge T_{\\text{end}}$.\n    a. **Boundary Conditions**: Apply transmissive boundary conditions by copying the state from the adjacent interior cell to the ghost cell (zero-order extrapolation). E.g., $\\mathbf{Q}_0 = \\mathbf{Q}_1$ and $\\mathbf{Q}_{N+1} = \\mathbf{Q}_N$.\n    b. **Time Step Calculation**: Compute the maximum signal speed over the entire domain, $S_{\\max} = \\max_i(|u_i| + \\sqrt{gh_i})$. Calculate the time step $\\Delta t$ using the Courant–Friedrichs–Lewy (CFL) condition: $\\Delta t = \\text{CFL} \\cdot \\Delta x / S_{\\max}$. Ensure $\\Delta t$ does not step over $T_{\\text{end}}$.\n    c. **Flux Calculation**: Loop through all interfaces $i+1/2$ (from the leftmost ghost cell to the rightmost interior cell). At each interface, determine the left and right states $(\\mathbf{Q}_L, \\mathbf{Q}_R)$ and compute the HLL numerical flux $\\mathbf{F}_{i+1/2}$.\n    d. **State Update**: Update the state vectors $\\mathbf{Q}_i$ for all interior cells using the finite volume formula.\n    e. **Positivity Enforcement**: After the update, enforce positivity by setting any $h_i < 0$ to $0$ and setting the corresponding $(hu)_i$ to $0$.\n    f. **Momentum Capping**: Apply the velocity capping procedure to each cell to prevent spurious velocities.\n    g. **Data Logging**: Collect data required for test case validation (e.g., maximum velocity, shoreline position).\n    h. **Advance Time**: $t \\leftarrow t + \\Delta t$.\n3.  **Post-processing**: After the time loop finishes, compute the final metrics for the test case and determine the boolean result.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the 1D shallow water solver.\n    \"\"\"\n\n    def run_simulation(L, dx, g, T_end, cfl, alpha, h_init, u_init, test_case_id):\n        \"\"\"\n        Executes a single simulation of the 1D shallow water equations.\n        \n        Args:\n            L (float): Domain length.\n            dx (float): Spatial step size.\n            g (float): Gravitational acceleration.\n            T_end (float): End time of the simulation.\n            cfl (float): CFL number for time step calculation.\n            alpha (float): Momentum capping factor.\n            h_init (function): Function h(x) for initial water depth.\n            u_init (function): Function u(x) for initial velocity.\n            test_case_id (int): Identifier for the test case (1, 2, or 3).\n        \n        Returns:\n            bool: The result of the test case verification.\n        \"\"\"\n        N = int(L / dx)\n        # Grid with 1 ghost cell on each side\n        x = np.linspace(-dx / 2, L + dx / 2, N + 2)\n        \n        # State vectors (h, hu)\n        h = h_init(x)\n        u = u_init(x)\n        hu = h * u\n        q = np.array([h, hu])\n\n        h_th = 1e-4  # Dryness threshold for shoreline definition\n        h_dry_num = 1e-8 # Numerical threshold for dry cells\n\n        initial_shoreline_pos = 0.0\n        if test_case_id in [1, 2]:\n            shoreline_indices = np.where(q[0, :] > h_th)[0]\n            if len(shoreline_indices) > 0:\n                initial_shoreline_pos = x[shoreline_indices[-1]]\n\n        t = 0.0\n        max_abs_u_so_far = 0.0\n\n        while t  T_end:\n            # 1. Transmissive Boundary Conditions (zero-order extrapolation)\n            q[:, 0] = q[:, 1]\n            q[:, -1] = q[:, -2]\n\n            # 2. Calculate time step (CFL condition)\n            h, hu = q[0], q[1]\n            u = np.divide(hu, h, out=np.zeros_like(hu), where=h > h_dry_num)\n            \n            wave_speeds = np.abs(u) + np.sqrt(g * h)\n            max_speed = np.max(wave_speeds)\n            if max_speed == 0:\n                dt = cfl * dx # Or some other default for still water\n            else:\n                dt = cfl * dx / max_speed\n            \n            dt = min(dt, T_end - t)\n\n            # Store max velocity for Test 3\n            if test_case_id == 3:\n                max_abs_u_so_far = max(max_abs_u_so_far, np.max(np.abs(u)))\n\n            # 3. Compute fluxes at interfaces using HLL solver\n            fluxes = np.zeros_like(q)\n            \n            # Left and right states at interfaces\n            q_L = q[:, :-1]\n            q_R = q[:, 1:]\n            \n            h_L, hu_L = q_L[0], q_L[1]\n            h_R, hu_R = q_R[0], q_R[1]\n\n            u_L = np.divide(hu_L, h_L, out=np.zeros_like(hu_L), where=h_L > h_dry_num)\n            u_R = np.divide(hu_R, h_R, out=np.zeros_like(hu_R), where=h_R > h_dry_num)\n\n            # Physical fluxes\n            F_L = np.array([hu_L, hu_L * u_L + 0.5 * g * h_L**2])\n            F_R = np.array([hu_R, hu_R * u_R + 0.5 * g * h_R**2])\n\n            # HLL wave speed estimates\n            s_L = np.minimum(u_L - np.sqrt(g * h_L), u_R - np.sqrt(g * h_R))\n            s_R = np.maximum(u_L + np.sqrt(g * h_L), u_R + np.sqrt(g * h_R))\n\n            # HLL flux computation (vectorized)\n            hll_flux = np.zeros_like(F_L)\n            \n            idx_sl_pos = s_L >= 0\n            idx_sr_neg = s_R = 0\n            idx_hll = ~idx_sl_pos  ~idx_sr_neg\n\n            hll_flux[:, idx_sl_pos] = F_L[:, idx_sl_pos]\n            hll_flux[:, idx_sr_neg] = F_R[:, idx_sr_neg]\n            \n            hll_flux[:, idx_hll] = (s_R[idx_hll] * F_L[:, idx_hll] -\n                                     s_L[idx_hll] * F_R[:, idx_hll] +\n                                     s_L[idx_hll] * s_R[idx_hll] * (q_R[:, idx_hll] - q_L[:, idx_hll])) / (s_R[idx_hll] - s_L[idx_hll])\n            \n            # 4. Update state vectors (interior cells)\n            q[:, 1:-1] -= (dt / dx) * (hll_flux[:, 1:] - hll_flux[:, :-1])\n\n            # 5. Positivity-preserving enforcement\n            q[0, :] = np.maximum(q[0, :], 0.0)\n            q[1, q[0, :] = h_dry_num] = 0.0\n\n            # 6. Momentum capping\n            h, hu = q[0], q[1]\n            u = np.divide(hu, h, out=np.zeros_like(hu), where=h > h_dry_num)\n            u_cap = alpha * np.sqrt(g * h)\n            u_capped = np.clip(u, -u_cap, u_cap)\n            q[1, :] = h * u_capped\n\n            t += dt\n\n        # --- Post-processing and Validation ---\n        if test_case_id in [1, 2]:\n            shoreline_indices = np.where(q[0, :] > h_th)[0]\n            if len(shoreline_indices) > 0:\n                final_shoreline_pos = x[shoreline_indices[-1]]\n            else: # All dry\n                final_shoreline_pos = initial_shoreline_pos\n            \n            # For Test 1, the domain is small, so the wave hits the boundary.\n            # The shoreline 'position' is tracked as the rightmost wet cell.\n            # Once the wave fills the domain, this position becomes the rightmost grid point.\n            if test_case_id == 1:\n                final_shoreline_pos = min(final_shoreline_pos, L - dx/2)\n\n            displacement = final_shoreline_pos - initial_shoreline_pos\n            avg_speed = displacement / T_end\n            \n            hL = h_init(0) # Get h_L from the initial condition\n            s_star = 2 * np.sqrt(g * hL)\n            \n            return 0.8 * s_star = avg_speed = 1.2 * s_star\n\n        if test_case_id == 3:\n            return max_abs_u_so_far  1e-3\n        \n        return False\n\n    # --- Define Test Cases ---\n    test_cases = [\n        # Test 1: Dam-break onto dry bed\n        {\n            \"id\": 1, \"L\": 100.0, \"dx\": 0.5, \"g\": 9.81, \"T_end\": 10.0, \"cfl\": 0.9, \"alpha\": 2.0,\n            \"h_init\": lambda x: np.where(x = 50.0, 1.0, 0.0),\n            \"u_init\": lambda x: np.zeros_like(x)\n        },\n        # Test 2: Dam-break with near-dry left pool\n        {\n            \"id\": 2, \"L\": 20.0, \"dx\": 0.1, \"g\": 9.81, \"T_end\": 5.0, \"cfl\": 0.9, \"alpha\": 2.0,\n            \"h_init\": lambda x: np.where(x = 10.0, 0.01, 0.0),\n            \"u_init\": lambda x: np.zeros_like(x)\n        },\n        # Test 3: Still water\n        {\n            \"id\": 3, \"L\": 50.0, \"dx\": 0.5, \"g\": 9.81, \"T_end\": 5.0, \"cfl\": 0.9, \"alpha\": 2.0,\n            \"h_init\": lambda x: np.full_like(x, 1.0),\n            \"u_init\": lambda x: np.zeros_like(x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(\n            case[\"L\"], case[\"dx\"], case[\"g\"], case[\"T_end\"], case[\"cfl\"], case[\"alpha\"],\n            case[\"h_init\"], case[\"u_init\"], case[\"id\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}