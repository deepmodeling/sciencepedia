{
    "hands_on_practices": [
        {
            "introduction": "Understanding the dynamics of western boundary currents begins with identifying the key physical balances at play. This first practice uses the powerful tool of scaling analysis to derive the characteristic widths of the two foundational models: the Stommel model, based on bottom friction, and the Munk model, based on lateral viscosity. By comparing the resulting scales, you will develop a core intuition for how different frictional mechanisms shape the structure of these intense currents. ",
            "id": "3802187",
            "problem": "In a rectangular, mid-latitude ocean basin of uniform depth on a beta-plane, consider the classical western boundary current closures for steady, linear barotropic flow. The interior flow satisfies the Sverdrup balance, and the boundary layer at the western boundary adjusts to enforce a no-normal-flow condition. In the Stommel model, friction is represented by a linear bottom drag proportional to the velocity with coefficient $r$ (in $\\mathrm{s^{-1}}$), which in the barotropic vorticity equation acts as a linear damping of the relative vorticity. In the Munk model, friction is represented by a lateral kinematic viscosity $A_h$ (in $\\mathrm{m^2\\,s^{-1}}$), which in the barotropic vorticity equation acts through a Laplacian of the relative vorticity. The planetary vorticity gradient parameter is $\\beta$ (in $\\mathrm{s^{-1}\\,m^{-1}}$).\n\nStarting from the steady, linear barotropic vorticity equation on a beta-plane, and using boundary-layer scaling arguments in the western boundary layer (dominant cross-boundary variations in the zonal direction $x$, with boundary-layer width $\\delta$ and meridional velocity scale $V$), derive the scaling expressions for the western boundary layer width in the Stommel and Munk models. Then, using the parameter values $A_h = 1000\\ \\mathrm{m^2\\,s^{-1}}$, $\\beta = 2\\times 10^{-11}\\ \\mathrm{s^{-1}\\,m^{-1}}$, and $r = 10^{-7}\\ \\mathrm{s^{-1}}$, compute the Munk boundary layer width $\\delta_{M}$ and the Stommel boundary layer width $\\delta_{S}$. Express both $\\delta_{M}$ and $\\delta_{S}$ in $\\mathrm{m}$.\n\nFinally, report the dimensionless ratio $\\delta_{M}/\\delta_{S}$ as your answer. Round your answer to four significant figures.",
            "solution": "The starting point is the steady, linear barotropic vorticity equation on a beta-plane, which broadly takes the form of a balance between the planetary vorticity advection and the frictional dissipation of relative vorticity. This can be written as:\n$$\n\\beta v = D\n$$\nwhere $v$ is the meridional velocity, $\\beta$ is the planetary vorticity gradient, and $D$ represents the friction term. The problem specifies the forms of $D$ for the Stommel and Munk models.\n\nWe analyze the western boundary layer, a narrow region of width $\\delta$ adjacent to the western boundary (let's say at $x=0$). We use scaling arguments where the zonal length scale is $\\delta$ and the meridional length scale is the basin scale $L$, with $\\delta \\ll L$. Let the characteristic meridional velocity be $V$ and the characteristic zonal velocity be $U$. The continuity equation for an incompressible fluid of uniform depth is $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$. Scaling this gives:\n$$\n\\frac{U}{\\delta} \\sim \\frac{V}{L} \\implies U \\sim V \\frac{\\delta}{L}\n$$\nSince $\\delta \\ll L$, it follows that $U \\ll V$.\n\nThe relative vorticity is $\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$. The scales of the two terms are:\n$$\n\\frac{\\partial v}{\\partial x} \\sim \\frac{V}{\\delta} \\quad \\text{and} \\quad \\frac{\\partial u}{\\partial y} \\sim \\frac{U}{L} \\sim \\frac{V\\delta}{L^2}\n$$\nBecause $\\delta \\ll L$, we have $\\frac{V}{\\delta} \\gg \\frac{V\\delta}{L^2}$, which means the relative vorticity in the boundary layer is dominated by the zonal shear of the meridional flow:\n$$\n\\zeta \\approx \\frac{\\partial v}{\\partial x}\n$$\nThe scale of the relative vorticity is therefore $\\zeta \\sim \\frac{V}{\\delta}$.\n\nDerivation of the Stommel boundary layer width $\\delta_S$:\nIn the Stommel model, friction is a linear bottom drag with coefficient $r$. The frictional term in the vorticity equation is $D = -r\\zeta$. The governing equation is:\n$$\n\\beta v = -r\\zeta\n$$\nSubstituting the approximation for vorticity in the boundary layer, we get:\n$$\n\\beta v \\approx -r \\frac{\\partial v}{\\partial x}\n$$\nIn the western boundary layer, a balance must exist between the advection of planetary vorticity and the frictional term. We perform a scale analysis of this equation. The terms scale as:\nLeft-hand side: $\\beta v \\sim \\beta V$\nRight-hand side: $-r \\frac{\\partial v}{\\partial x} \\sim r \\frac{V}{\\delta_S}$\nwhere $\\delta_S$ is the Stommel boundary layer width. Equating the scales of these dominant terms gives:\n$$\n\\beta V \\sim r \\frac{V}{\\delta_S} \\implies \\beta \\sim \\frac{r}{\\delta_S}\n$$\nSolving for the boundary layer width, we obtain the scaling expression:\n$$\n\\delta_S = \\frac{r}{\\beta}\n$$\n\nDerivation of the Munk boundary layer width $\\delta_M$:\nIn the Munk model, friction is due to lateral viscosity $A_h$. The frictional term in the vorticity equation is $D = A_h \\nabla^2 \\zeta$. The governing equation is:\n$$\n\\beta v = A_h \\nabla^2 \\zeta\n$$\nAgain, we use $\\zeta \\approx \\frac{\\partial v}{\\partial x}$. The friction term becomes $A_h \\nabla^2(\\frac{\\partial v}{\\partial x})$. The Laplacian operator is $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$. Applying this to $\\frac{\\partial v}{\\partial x}$:\n$$\n\\nabla^2 \\left(\\frac{\\partial v}{\\partial x}\\right) = \\frac{\\partial^3 v}{\\partial x^3} + \\frac{\\partial^3 v}{\\partial y^2 \\partial x}\n$$\nLet's scale the two components of this term, using $\\delta_M$ as the Munk boundary layer width:\n$$\n\\frac{\\partial^3 v}{\\partial x^3} \\sim \\frac{V}{\\delta_M^3} \\quad \\text{and} \\quad \\frac{\\partial^3 v}{\\partial y^2 \\partial x} \\sim \\frac{V}{L^2 \\delta_M}\n$$\nSince $\\delta_M \\ll L$, the term $\\frac{V}{\\delta_M^3}$ is much larger than $\\frac{V}{L^2 \\delta_M}$. Therefore, the friction term is dominated by the highest-order derivative in $x$:\n$$\nA_h \\nabla^2 \\zeta \\sim A_h \\frac{\\partial^3 v}{\\partial x^3}\n$$\nThe governing equation in the Munk boundary layer is approximately:\n$$\n\\beta v \\approx A_h \\frac{\\partial^3 v}{\\partial x^3}\n$$\nWe perform a scale analysis of this equation. The terms scale as:\nLeft-hand side: $\\beta v \\sim \\beta V$\nRight-hand side: $A_h \\frac{\\partial^3 v}{\\partial x^3} \\sim A_h \\frac{V}{\\delta_M^3}$\nEquating the scales gives the balance:\n$$\n\\beta V \\sim A_h \\frac{V}{\\delta_M^3} \\implies \\beta \\sim \\frac{A_h}{\\delta_M^3}\n$$\nSolving for the boundary layer width, we get the scaling expression:\n$$\n\\delta_M = \\left(\\frac{A_h}{\\beta}\\right)^{1/3}\n$$\n\nNow, we compute the numerical values using the given parameters: $A_h = 1000\\ \\mathrm{m^2\\,s^{-1}}$, $\\beta = 2\\times 10^{-11}\\ \\mathrm{s^{-1}\\,m^{-1}}$, and $r = 10^{-7}\\ \\mathrm{s^{-1}}$.\n\nStommel boundary layer width $\\delta_S$:\n$$\n\\delta_S = \\frac{r}{\\beta} = \\frac{10^{-7}\\ \\mathrm{s^{-1}}}{2 \\times 10^{-11}\\ \\mathrm{s^{-1}\\,m^{-1}}} = 0.5 \\times 10^4\\ \\mathrm{m} = 5000\\ \\mathrm{m}\n$$\n\nMunk boundary layer width $\\delta_M$:\n$$\n\\delta_M = \\left(\\frac{A_h}{\\beta}\\right)^{1/3} = \\left(\\frac{1000\\ \\mathrm{m^2\\,s^{-1}}}{2 \\times 10^{-11}\\ \\mathrm{s^{-1}\\,m^{-1}}}\\right)^{1/3} = \\left(\\frac{10^3}{2 \\times 10^{-11}}\\ \\mathrm{m^3}\\right)^{1/3} = (0.5 \\times 10^{14}\\ \\mathrm{m^3})^{1/3} = (50 \\times 10^{12}\\ \\mathrm{m^3})^{1/3}\n$$\n$$\n\\delta_M = (50)^{1/3} \\times 10^4\\ \\mathrm{m} \\approx 3.684031 \\times 10^4\\ \\mathrm{m} \\approx 36840.31\\ \\mathrm{m}\n$$\n\nFinally, we compute the dimensionless ratio $\\frac{\\delta_M}{\\delta_S}$:\n$$\n\\frac{\\delta_M}{\\delta_S} = \\frac{36840.31\\ \\mathrm{m}}{5000\\ \\mathrm{m}} \\approx 7.368062\n$$\nRounding the result to four significant figures gives $7.368$.",
            "answer": "$$\\boxed{7.368}$$"
        },
        {
            "introduction": "While scaling analysis provides the characteristic width, a full analytical solution reveals the detailed internal structure of the flow. This exercise takes the next step by guiding you through the mathematical derivation of the streamfunction profile within a Munk boundary layer. Solving the governing fourth-order differential equation with appropriate boundary conditions, including the no-slip condition at the coast, will uncover the complex dynamics and spatial structure that simple scaling arguments cannot predict. ",
            "id": "3802237",
            "problem": "Consider a steady, wind-driven, single-layer, constant-depth basin on a beta-plane with a straight western boundary at $x=0$ and interior to the east ($x>0$). Assume linear dynamics with lateral eddy viscosity and neglect nonlinear advection. Let the barotropic streamfunction be $\\psi(x,y)$ so that the horizontal velocity is $(u,v)=(-\\partial\\psi/\\partial y,\\ \\partial\\psi/\\partial x)$. Taking the vertical curl of the depth-integrated linear momentum equations yields the linear barotropic vorticity balance\n$$\n\\beta\\,\\frac{\\partial \\psi}{\\partial x} \\;=\\; \\frac{1}{\\rho_{0} H}\\,\\hat{\\boldsymbol{z}}\\cdot\\nabla\\times\\boldsymbol{\\tau}(y) \\;+\\; A_{h}\\,\\nabla^{4}\\psi,\n$$\nwhere $\\beta$ is the meridional gradient of the Coriolis parameter, $\\rho_{0}$ is a constant reference density, $H$ is the layer thickness, $\\boldsymbol{\\tau}(y)$ is a zonally uniform wind stress, and $A_{h}$ is the constant lateral eddy viscosity. In the interior, the flow is Sverdrup such that $\\psi_{I}=\\psi_{I}(y)$ depends only on $y$. Near the western boundary, a viscous boundary layer adjusts $\\psi$ from the wall to the interior.\n\nUsing a boundary-layer stretched coordinate $X = x/\\delta_{M}$, where $\\delta_{M}$ is to be determined by asymptotic balance, derive the leading-order one-dimensional boundary-layer equation for $\\psi(X,y)$ under the assumption that meridional derivatives are subdominant to zonal derivatives in the layer and the wind-stress curl is balanced in the interior. Impose an impermeable, no-slip wall at $x=0$ (so $\\psi$ is constant along the wall and $v=0$ at the wall), and match to the interior as $X\\to+\\infty$.\n\nThen, solve the resulting ordinary differential equation for the streamfunction profile in the boundary layer, expressing your result in closed form as a function of $X$ and $\\psi_{I}(y)$. You may set the constant wall value of $\\psi$ to $0$ without loss of generality. Your final answer must be a single analytic expression for $\\psi(X,y)$ in terms of $X$ and $\\psi_{I}(y)$. Do not provide intermediate steps in the final answer. Express no units, and no numerical approximation or rounding is required.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n-   Governing Equation: The linear barotropic vorticity balance is given as $\\beta\\,\\frac{\\partial \\psi}{\\partial x} \\;=\\; \\frac{1}{\\rho_{0} H}\\,\\hat{\\boldsymbol{z}}\\cdot\\nabla\\times\\boldsymbol{\\tau}(y) \\;+\\; A_{h}\\,\\nabla^{4}\\psi$.\n-   Variables and Constants: $\\psi(x,y)$ is the barotropic streamfunction, $\\beta$ is the planetary vorticity gradient, $\\rho_0$ is a reference density, $H$ is layer thickness, $\\boldsymbol{\\tau}(y)$ is the zonally uniform wind stress, and $A_h$ is the lateral eddy viscosity.\n-   Velocity-Streamfunction Relation: $(u,v)=(-\\partial\\psi/\\partial y,\\ \\partial\\psi/\\partial x)$.\n-   Domain: A basin with a western boundary at $x=0$ and an interior for $x>0$.\n-   Assumptions:\n    1.  Steady, linear dynamics.\n    2.  Meridional derivatives are subdominant to zonal derivatives in the boundary layer, i.e., $|\\partial/\\partial y| \\ll |\\partial/\\partial x|$.\n    3.  The wind-stress curl term is balanced in the interior Sverdrup flow.\n-   Interior Solution: The streamfunction in the interior, to which the boundary layer solution must match, is denoted $\\psi_I(y)$.\n-   Boundary Conditions at the wall ($x=0$):\n    1.  Impermeable wall: $\\psi$ is constant. It is specified to take $\\psi(0,y) = 0$.\n    2.  No-slip condition: The tangential velocity is zero. This corresponds to the meridional velocity $v=0$. Since $v = \\partial\\psi/\\partial x$, this implies $\\partial\\psi/\\partial x|_{x=0} = 0$.\n-   Matching Condition: As $x \\to \\infty$ (or the stretched coordinate $X \\to \\infty$), the solution must approach the interior solution, i.e., $\\psi(x,y) \\to \\psi_I(y)$.\n-   Stretched Coordinate: $X = x/\\delta_M$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem describes the derivation of the Munk model for a western boundary current. This is a canonical model in physical oceanography, based on fundamental principles of fluid dynamics on a rotating planet. The setup is scientifically valid.\n-   **Well-Posed**: The problem asks for the solution of a fourth-order ordinary differential equation with four boundary/matching conditions (one at infinity, two at the wall, and one for the constant part of the general solution). This constitutes a well-posed boundary value problem.\n-   **Objective**: The language is precise, formal, and free of any subjective or ambiguous statements.\n-   **Completeness and Consistency**: All necessary equations, assumptions, and boundary conditions are provided to find a unique solution. The assumptions are internally consistent. The statement that \"$\\psi_I = \\psi_I(y)$\" is a standard simplification in boundary layer theory, representing the interior Sverdrup solution evaluated at the edge of the boundary layer, which the boundary layer solution must match. The statement that \"the wind-stress curl is balanced in the interior\" correctly implies that this forcing term does not appear in the dominant balance of the homogeneous boundary layer equation.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation of the Solution**\nThe governing barotropic vorticity equation is:\n$$ \\beta\\,\\frac{\\partial \\psi}{\\partial x} \\;=\\; \\frac{1}{\\rho_{0} H}\\,\\hat{\\boldsymbol{z}}\\cdot\\nabla\\times\\boldsymbol{\\tau}(y) \\;+\\; A_{h}\\,\\nabla^{4}\\psi $$\nIn the western boundary layer, we anticipate that zonal gradients are much larger than meridional gradients. The problem states this explicitly, so for the viscous term, we have $\\nabla^4\\psi = (\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2})^2\\psi \\approx \\frac{\\partial^4 \\psi}{\\partial x^4}$.\n\nThe problem also states that the wind-stress curl term is balanced in the Sverdrup interior. This implies that in the boundary layer, the dominant balance is between the planetary vorticity advection ($\\beta$-term) and the highest-order friction term. The wind-stress curl term is of a lower order in the boundary layer's dynamics. Thus, the leading-order equation for the streamfunction $\\psi$ inside the boundary layer is:\n$$ \\beta\\,\\frac{\\partial \\psi}{\\partial x} \\;=\\; A_{h}\\,\\frac{\\partial^4 \\psi}{\\partial x^4} $$\nWe introduce the stretched boundary-layer coordinate $X = x/\\delta_{M}$, where $\\delta_M$ is the characteristic width of the boundary layer. The derivatives with respect to $x$ are transformed as:\n$$ \\frac{\\partial}{\\partial x} = \\frac{1}{\\delta_M}\\frac{d}{dX}, \\quad \\frac{\\partial^4}{\\partial x^4} = \\frac{1}{\\delta_M^4}\\frac{d^4}{dX^4} $$\nSubstituting these into the boundary-layer equation gives:\n$$ \\frac{\\beta}{\\delta_M}\\frac{d\\psi}{dX} = \\frac{A_h}{\\delta_M^4}\\frac{d^4\\psi}{dX^4} $$\nTo achieve a dominant balance, the coefficients of these two terms must be of the same order of magnitude. This defines the scale $\\delta_M$:\n$$ \\frac{\\beta}{\\delta_M} \\sim \\frac{A_h}{\\delta_M^4} \\implies \\delta_M^3 = \\frac{A_h}{\\beta} $$\nThe Munk layer width is therefore $\\delta_M = (A_h/\\beta)^{1/3}$. With this choice for $\\delta_M$, the equation simplifies to a parameter-free ordinary differential equation (ODE), where we treat $\\psi$ as a function of $X$ only (with $y$ dependence entering via integration constants):\n$$ \\frac{d^4\\psi}{dX^4} - \\frac{d\\psi}{dX} = 0 $$\nThis is a fourth-order linear homogeneous ODE with constant coefficients. The characteristic equation is $r^4 - r = 0$, which factors as $r(r^3 - 1) = 0$. The roots are $r=0$ and the three cubic roots of unity. The roots of $r^3 = 1$ are $r=1$, $r = \\exp(i2\\pi/3) = -1/2 + i\\sqrt{3}/2$, and $r = \\exp(i4\\pi/3) = -1/2 - i\\sqrt{3}/2$.\nThe four roots of the characteristic equation are:\n$$ r_0 = 0, \\quad r_1 = 1, \\quad r_2 = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}, \\quad r_3 = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2} $$\nThe general solution for $\\psi(X,y)$ is a linear combination of the exponential functions corresponding to these roots:\n$$ \\psi(X,y) = C_0(y) + C_1(y)e^X + e^{-X/2}\\left(C_2(y)\\cos\\left(\\frac{\\sqrt{3}}{2}X\\right) + C_3(y)\\sin\\left(\\frac{\\sqrt{3}}{2}X\\right)\\right) $$\nThe coefficients $C_i(y)$ are determined by applying the boundary and matching conditions.\n\n1.  **Matching Condition**: As $X \\to +\\infty$, $\\psi(X,y) \\to \\psi_I(y)$.\n    The term $C_1(y)e^X$ grows exponentially as $X \\to \\infty$. For the solution to remain bounded and match the interior value, we must have $C_1(y) = 0$. The terms multiplied by $e^{-X/2}$ decay to zero. This leaves $\\lim_{X\\to\\infty} \\psi(X,y) = C_0(y)$. Therefore, we must have $C_0(y) = \\psi_I(y)$.\n\n2.  **Impermeable Wall Condition**: At $X=0$, $\\psi(0,y) = 0$.\n    With $C_1=0$ and $C_0=\\psi_I$, the solution is $\\psi(X,y) = \\psi_I(y) + e^{-X/2}\\left(C_2(y)\\cos\\left(\\frac{\\sqrt{3}}{2}X\\right) + C_3(y)\\sin\\left(\\frac{\\sqrt{3}}{2}X\\right)\\right)$.\n    Applying the condition at $X=0$:\n    $$ \\psi(0,y) = \\psi_I(y) + e^0\\left(C_2(y)\\cos(0) + C_3(y)\\sin(0)\\right) = \\psi_I(y) + C_2(y) = 0 $$\n    This gives $C_2(y) = -\\psi_I(y)$.\n\n3.  **No-Slip Condition**: At $x=0$ (so $X=0$), $\\partial\\psi/\\partial x = 0$. This is equivalent to $d\\psi/dX|_{X=0} = 0$.\n    First, we find the derivative of our solution with respect to $X$:\n    $$ \\frac{d\\psi}{dX} = \\frac{d}{dX} \\left[ \\psi_I(y) + e^{-X/2}\\left(-\\psi_I(y)\\cos\\left(\\frac{\\sqrt{3}}{2}X\\right) + C_3(y)\\sin\\left(\\frac{\\sqrt{3}}{2}X\\right)\\right) \\right] $$\n    $$ \\frac{d\\psi}{dX} = -\\frac{1}{2}e^{-X/2}\\left(-\\psi_I\\cos + C_3\\sin\\right) + e^{-X/2}\\left(\\psi_I\\frac{\\sqrt{3}}{2}\\sin + C_3\\frac{\\sqrt{3}}{2}\\cos\\right) $$\n    where the arguments of $\\cos$ and $\\sin$ are $\\frac{\\sqrt{3}}{2}X$.\n    Evaluating at $X=0$:\n    $$ \\left.\\frac{d\\psi}{dX}\\right|_{X=0} = -\\frac{1}{2}e^0\\left(-\\psi_I(y)\\cos(0) + C_3(y)\\sin(0)\\right) + e^0\\left(\\psi_I(y)\\frac{\\sqrt{3}}{2}\\sin(0) + C_3(y)\\frac{\\sqrt{3}}{2}\\cos(0)\\right) = 0 $$\n    $$ -\\frac{1}{2}(-\\psi_I(y)) + \\frac{\\sqrt{3}}{2}C_3(y) = 0 $$\n    $$ \\frac{1}{2}\\psi_I(y) + \\frac{\\sqrt{3}}{2}C_3(y) = 0 $$\n    Solving for $C_3(y)$ yields $C_3(y) = -\\frac{1}{\\sqrt{3}}\\psi_I(y)$.\n\nFinally, we substitute the determined coefficients back into the general solution:\n$$ \\psi(X,y) = \\psi_I(y) + e^{-X/2}\\left( (-\\psi_I(y))\\cos\\left(\\frac{\\sqrt{3}}{2}X\\right) + \\left(-\\frac{1}{\\sqrt{3}}\\psi_I(y)\\right)\\sin\\left(\\frac{\\sqrt{3}}{2}X\\right) \\right) $$\nFactoring out $\\psi_I(y)$ gives the final expression for the streamfunction profile in the Munk boundary layer:\n$$ \\psi(X,y) = \\psi_I(y) \\left( 1 - e^{-X/2} \\left[ \\cos\\left(\\frac{\\sqrt{3}}{2}X\\right) + \\frac{1}{\\sqrt{3}} \\sin\\left(\\frac{\\sqrt{3}}{2}X\\right) \\right] \\right) $$\nThis expression satisfies all the conditions: it is zero at the wall ($X=0$), its derivative is zero at the wall, and it asymptotically approaches the interior value $\\psi_I(y)$ as $X\\to\\infty$.",
            "answer": "$$ \\boxed{ \\psi_I(y) \\left( 1 - \\exp\\left(-\\frac{X}{2}\\right) \\left( \\cos\\left(\\frac{\\sqrt{3}}{2}X\\right) + \\frac{1}{\\sqrt{3}} \\sin\\left(\\frac{\\sqrt{3}}{2}X\\right) \\right) \\right) } $$"
        },
        {
            "introduction": "The final and crucial step in modeling is translating theory into a viable numerical simulation. This practice bridges the gap between the analytical concept of the Munk layer width, $\\delta_M$, and the practical requirements of setting up a computational grid. By performing a grid convergence analysis, you will determine the minimum grid resolution needed to accurately capture the strong shear within the boundary current, a fundamental consideration for any computational oceanographer. ",
            "id": "3802228",
            "problem": "Consider a rectilinear, mid-latitude, wind-driven gyre on a beta-plane, governed at leading order by the steady, linear, barotropic vorticity balance between planetary vorticity advection and lateral friction. Let the planetary vorticity gradient be $\\beta$ (in $\\mathrm{m^{-1}\\,s^{-1}}$) and the constant lateral viscosity be $A_h$ (in $\\mathrm{m^2\\,s^{-1}}$). A Western Boundary Current (WBC) emerges with a viscous boundary layer whose characteristic width can be obtained by scale analysis. Your goal is to determine, via a principled grid convergence analysis, the minimum horizontal grid spacing $\\Delta x$ that is required to resolve the near-wall shear of the WBC to within a specified relative error tolerance.\n\nStarting point and modeling assumptions:\n- Begin from the steady, linear, barotropic vorticity equation on a beta-plane with constant lateral viscosity. Do not assume any closed-form boundary current solution; instead, use scale analysis to determine a boundary layer width scale. Let this scale be denoted by $\\delta_M$, in meters.\n- Adopt the canonical, dimensionless boundary-layer prototype profile for the along-boundary velocity magnitude as a function of the offshore coordinate $x$: $u(x) = U\\,f(x/\\delta_M)$ with $f(X)=e^{-X}$, where $X=x/\\delta_M$ and $U$ is a characteristic velocity scale that cancels in the relative error metric defined below.\n- To quantify resolution of the boundary current shear at the coast $x=0$, use the one-sided, three-point, second-order Finite Difference (FD) approximation for the first derivative at the wall:\n$$\n\\left.\\frac{du}{dx}\\right|_{x=0}\\approx \\frac{-3u(0)+4u(\\Delta x)-u(2\\Delta x)}{2\\Delta x}.\n$$\n- Define the dimensionless grid size as $h=\\Delta x/\\delta_M$. The exact, dimensionless wall derivative for $f(X)=e^{-X}$ is $-1$ at $X=0$. Define the relative error of the wall shear approximation as\n$$\n\\mathcal{E}(h)=\\left|\\frac{\\frac{-3+4e^{-h}-e^{-2h}}{2h}-(-1)}{-1}\\right|=\\left|\\frac{-3+4e^{-h}-e^{-2h}}{2h}+1\\right|.\n$$\n\nTasks:\n1. From the vorticity balance, use scale analysis to derive the Munk boundary layer width scale $\\delta_M$ in meters as a function of $\\beta$ and $A_h$. Use only foundational reasoning from the governing equation; do not assume a target formula.\n2. Using the error metric $\\mathcal{E}(h)$, perform a grid convergence analysis to compute the largest admissible non-dimensional grid size $h_\\star$ such that $\\mathcal{E}(h_\\star)=\\varepsilon$ for a specified tolerance $\\varepsilon$ (unitless, given as a decimal). Interpret the minimum grid spacing required to resolve the boundary shear as $\\Delta x_{\\text{req}} = h_\\star\\,\\delta_M$.\n3. Implement a robust numerical procedure to determine $h_\\star$ for given $\\varepsilon$. Your method must not assume an a priori polynomial error model; it must use the exact $\\mathcal{E}(h)$ and find the smallest $h$ satisfying $\\mathcal{E}(h)\\le \\varepsilon$ to within an absolute tolerance of $10^{-6}$ in $h$.\n4. For each test case below, compute $\\delta_M$ (in meters) and then $\\Delta x_{\\text{req}}$ (in meters), and report the final answers as $\\Delta x_{\\text{req}}$ in kilometers. Express the final answers in kilometers (km), each rounded to three decimal places.\n\nTest suite:\n- Case $1$: $\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=400\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.05$.\n- Case $2$: $\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=1600\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.05$.\n- Case $3$: $\\beta=1.6\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=400\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.02$.\n- Case $4$: $\\beta=2.5\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=50\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.10$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, with each entry equal to $\\Delta x_{\\text{req}}$ in kilometers (km), rounded to three decimal places (e.g., $\\left[\\text{val}_1,\\text{val}_2,\\text{val}_3,\\text{val}_4\\right]$).",
            "solution": "The user has provided a problem that requires a multi-step analysis involving geophysical fluid dynamics, scale analysis, and numerical methods. I will first validate the problem statement and then provide a detailed solution.\n\n### Step 1: Extract Givens\n- **Governing Physics**: Steady, linear, barotropic vorticity balance on a beta-plane. The balance is between planetary vorticity advection and lateral friction.\n- **Parameters**:\n    - $\\beta$: Planetary vorticity gradient ($\\mathrm{m^{-1}\\,s^{-1}}$).\n    - $A_h$: Constant lateral viscosity ($\\mathrm{m^2\\,s^{-1}}$).\n- **Definitions**:\n    - $\\delta_M$: Munk boundary layer width scale (m).\n    - $u(x)$: Along-boundary velocity magnitude as a function of the offshore coordinate $x$.\n    - Velocity profile model: $u(x) = U\\,f(x/\\delta_M)$ with $f(X)=e^{-X}$ and $X=x/\\delta_M$.\n    - $\\Delta x$: Horizontal grid spacing (m).\n    - $h$: Dimensionless grid size, $h = \\Delta x / \\delta_M$.\n- **Numerical Scheme**:\n    - One-sided, three-point, second-order finite difference approximation for the wall shear:\n    $$\n    \\left.\\frac{du}{dx}\\right|_{x=0}\\approx \\frac{-3u(0)+4u(\\Delta x)-u(2\\Delta x)}{2\\Delta x}\n    $$\n- **Error Metric**:\n    - Relative error of the wall shear approximation:\n    $$\n    \\mathcal{E}(h)=\\left|\\frac{\\frac{-3+4e^{-h}-e^{-2h}}{2h}-(-1)}{-1}\\right|=\\left|\\frac{-3+4e^{-h}-e^{-2h}}{2h}+1\\right|\n    $$\n- **Task Objective**:\n    - Find the largest admissible non-dimensional grid size $h_\\star$ such that $\\mathcal{E}(h_\\star)=\\varepsilon$ for a given tolerance $\\varepsilon$.\n    - The required minimum grid spacing is $\\Delta x_{\\text{req}} = h_\\star\\,\\delta_M$.\n    - The numerical solver for $h_\\star$ must have an absolute tolerance of $10^{-6}$.\n- **Test Cases**:\n    - Case 1: $\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=400\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.05$.\n    - Case 2: $\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=1600\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.05$.\n    - Case 3: $\\beta=1.6\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=400\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.02$.\n    - Case 4: $\\beta=2.5\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$, $A_h=50\\ \\mathrm{m^2\\,s^{-1}}$, $\\varepsilon=0.10$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is based on the Munk model for a wind-driven western boundary current, a canonical model in physical oceanography. The governing equation, the balance of forces (planetary vorticity advection vs. friction), the resulting boundary layer scale, and the exponential velocity profile are all standard and well-established concepts. The numerical analysis task, involving a finite difference scheme and error analysis, is a standard procedure in computational science. The problem is scientifically sound.\n- **Well-Posed**: The problem is defined with precision. It provides the governing equation, the model for the velocity profile, the specific finite difference formula to be used, and a clear error metric. The objective is to find a specific quantity ($h_\\star$) by solving a well-defined equation ($\\mathcal{E}(h)=\\varepsilon$). All necessary physical parameters and numerical tolerances are provided. The function $\\mathcal{E}(h)$ is monotonic for $h > 0$, ensuring a unique solution for $h_\\star$. The problem is well-posed.\n- **Objective**: The problem is stated in objective, quantitative terms, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is scientifically valid, well-posed, and objective. I will now proceed with the solution.\n\n### Solution\n\nThe solution proceeds in three parts. First, we derive the Munk boundary layer width scale, $\\delta_M$. Second, we detail the numerical procedure for finding the required non-dimensional grid size, $h_\\star$. Finally, we execute the calculations for each test case.\n\n#### 1. Derivation of the Munk Boundary Layer Width Scale ($\\delta_M$)\n\nThe governing equation is the steady, linear, barotropic vorticity equation. For a western boundary current, the dominant balance is between the advection of planetary vorticity and lateral friction. This balance is expressed as:\n$$\n\\beta v \\approx A_h \\nabla^2 \\zeta\n$$\nwhere $v$ is the meridional velocity, $\\beta$ is the planetary vorticity gradient, $A_h$ is the lateral eddy viscosity, and $\\zeta$ is the relative vorticity, $\\zeta = \\partial v/\\partial x - \\partial u/\\partial y$.\n\nWe perform a scale analysis in the boundary layer. Let $\\delta_M$ be the characteristic width (in the $x$-direction) of the boundary current and $L$ be its characteristic length (in the $y$-direction), with $L \\gg \\delta_M$. Let $V$ and $U$ be the characteristic velocity scales in the $y$ and $x$ directions, respectively. From the continuity equation, $\\partial u / \\partial x + \\partial v / \\partial y = 0$, we have the scaling $U/\\delta_M \\sim V/L$, which implies $U \\sim V(\\delta_M/L) \\ll V$.\n\nIn the boundary layer, derivatives in the cross-stream ($x$) direction are much larger than those in the along-stream ($y$) direction, i.e., $\\partial/\\partial x \\gg \\partial/\\partial y$.\nThus, the relative vorticity scale is dominated by the shear in the $x$-direction:\n$$\n\\zeta \\sim \\frac{\\partial v}{\\partial x} \\sim \\frac{V}{\\delta_M}\n$$\nThe lateral friction term is $A_h \\nabla^2 \\zeta = A_h (\\partial^2/\\partial x^2 + \\partial^2/\\partial y^2)\\zeta$. The dominant term is the highest derivative with respect to $x$:\n$$\nA_h \\nabla^2 \\zeta \\sim A_h \\frac{\\partial^2 \\zeta}{\\partial x^2} \\sim A_h \\frac{\\partial^2}{\\partial x^2}\\left(\\frac{V}{\\delta_M}\\right) \\sim A_h \\frac{V}{\\delta_M^3}\n$$\nThe planetary vorticity advection term scales as:\n$$\n\\beta v \\sim \\beta V\n$$\nEquating the scales of the two dominant terms in the vorticity balance:\n$$\n\\beta V \\sim A_h \\frac{V}{\\delta_M^3}\n$$\nThe velocity scale $V$ cancels, yielding the relationship for the boundary layer width:\n$$\n\\beta \\sim \\frac{A_h}{\\delta_M^3}\n$$\nSolving for $\\delta_M$, we obtain the Munk boundary layer width scale:\n$$\n\\delta_M = \\left(\\frac{A_h}{\\beta}\\right)^{1/3}\n$$\n\n#### 2. Numerical Determination of the Non-dimensional Grid Size ($h_\\star$)\n\nThe problem requires finding the largest non-dimensional grid size $h_\\star = \\Delta x_{\\text{req}}/\\delta_M$ such that the relative error in approximating the wall shear is equal to a specified tolerance $\\varepsilon$. The relative error is given by:\n$$\n\\mathcal{E}(h) = \\left|\\frac{-3+4e^{-h}-e^{-2h}}{2h}+1\\right|\n$$\nWe need to solve the equation $\\mathcal{E}(h) = \\varepsilon$. Let's define a function $G(h) = \\mathcal{E}(h) - \\varepsilon$. We are seeking the root of $G(h)=0$.\n\nA Taylor series expansion of $\\mathcal{E}(h)$ around $h=0$ reveals that $\\mathcal{E}(h) = \\frac{1}{3}h^2 + O(h^4)$, indicating that the finite difference scheme is second-order accurate as stated, and the error increases with $h$. Since $\\mathcal{E}(h)$ is a monotonically increasing function for $h > 0$, there is a unique root $h_\\star > 0$ for any given $\\varepsilon \\in (0, 1)$.\n\nTo find this root with high precision, we employ a robust numerical root-finding algorithm. The bisection method or Brent's method are excellent choices. Given that we can easily bracket the root (e.g., for $h \\to 0$, $G(h) \\to -\\varepsilon < 0$, and for sufficiently large $h$, $G(h) > 0$), these methods are guaranteed to converge. We will use a numerical solver to find $h_\\star$ that satisfies $G(h_\\star) = 0$ to an absolute tolerance of $10^{-6}$ on $h$.\n\n#### 3. Calculation of Required Grid Spacing ($\\Delta x_{\\text{req}}$)\n\nFor each test case, we perform the following steps:\n1.  Calculate the Munk width $\\delta_M$ using the derived formula $\\delta_M = (A_h / \\beta)^{1/3}$.\n2.  Numerically solve for $h_\\star$ by finding the root of the equation $\\mathcal{E}(h) - \\varepsilon = 0$.\n3.  Calculate the required physical grid spacing $\\Delta x_{\\text{req}} = h_\\star \\cdot \\delta_M$.\n4.  Convert $\\Delta x_{\\text{req}}$ from meters to kilometers and round the result to three decimal places.\n\n**Case 1**: $\\beta=2.0\\times 10^{-11}$, $A_h=400$, $\\varepsilon=0.05$\n- $\\delta_M = (400 / (2.0 \\times 10^{-11}))^{1/3} = (2 \\times 10^{13})^{1/3} \\approx 27144.176\\ \\mathrm{m}$.\n- Solve $\\mathcal{E}(h) = 0.05$. The solver yields $h_\\star \\approx 0.45534$.\n- $\\Delta x_{\\text{req}} = 0.45534 \\times 27144.176 \\approx 12361.6\\ \\mathrm{m}$.\n- $\\Delta x_{\\text{req}} \\approx 12.362\\ \\mathrm{km}$.\n\n**Case 2**: $\\beta=2.0\\times 10^{-11}$, $A_h=1600$, $\\varepsilon=0.05$\n- $\\delta_M = (1600 / (2.0 \\times 10^{-11}))^{1/3} = (8 \\times 10^{13})^{1/3} \\approx 43088.694\\ \\mathrm{m}$.\n- $\\varepsilon$ is unchanged, so $h_\\star$ is the same: $h_\\star \\approx 0.45534$.\n- $\\Delta x_{\\text{req}} = 0.45534 \\times 43088.694 \\approx 19616.9\\ \\mathrm{m}$.\n- $\\Delta x_{\\text{req}} \\approx 19.617\\ \\mathrm{km}$.\n\n**Case 3**: $\\beta=1.6\\times 10^{-11}$, $A_h=400$, $\\varepsilon=0.02$\n- $\\delta_M = (400 / (1.6 \\times 10^{-11}))^{1/3} = (2.5 \\times 10^{13})^{1/3} \\approx 29240.177\\ \\mathrm{m}$.\n- Solve $\\mathcal{E}(h) = 0.02$. The solver yields $h_\\star \\approx 0.28422$.\n- $\\Delta x_{\\text{req}} = 0.28422 \\times 29240.177 \\approx 8310.2\\ \\mathrm{m}$.\n- $\\Delta x_{\\text{req}} \\approx 8.310\\ \\mathrm{km}$.\n\n**Case 4**: $\\beta=2.5\\times 10^{-11}$, $A_h=50$, $\\varepsilon=0.10$\n- $\\delta_M = (50 / (2.5 \\times 10^{-11}))^{1/3} = (2 \\times 10^{12})^{1/3} \\approx 12599.210\\ \\mathrm{m}$.\n- Solve $\\mathcal{E}(h) = 0.10$. The solver yields $h_\\star \\approx 0.63004$.\n- $\\Delta x_{\\text{req}} = 0.63004 \\times 12599.210 \\approx 7938.0\\ \\mathrm{m}$.\n- $\\Delta x_{\\text{req}} \\approx 7.938\\ \\mathrm{km}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the required grid spacing to resolve a Western Boundary Current\n    shear for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (beta, A_h, epsilon)\n    test_cases = [\n        (2.0e-11, 400.0, 0.05),  # Case 1\n        (2.0e-11, 1600.0, 0.05), # Case 2\n        (1.6e-11, 400.0, 0.02),  # Case 3\n        (2.5e-11, 50.0, 0.10)   # Case 4\n    ]\n\n    results = []\n    \n    # Define the relative error function E(h)\n    def error_function(h):\n        # Using np.exp for vectorized/robust exponential calculation\n        # The expression inside the absolute value is E_term = ((-3 + 4*exp(-h) - exp(-2h))/(2h)) + 1\n        # A Taylor expansion shows this term is positive for h > 0, so abs() is not strictly needed.\n        if h == 0:\n            return 0.0\n        return ((-3.0 + 4.0 * np.exp(-h) - np.exp(-2.0 * h)) / (2.0 * h)) + 1.0\n\n    for case in test_cases:\n        beta, A_h, epsilon = case\n        \n        # 1. Calculate the Munk boundary layer width scale (delta_M) in meters.\n        delta_M = (A_h / beta)**(1/3)\n        \n        # 2. Define the target function for the root-finder: G(h) = E(h) - epsilon.\n        #    We need to find the root h_star such that G(h_star) = 0.\n        def target_function(h):\n            return error_function(h) - epsilon\n\n        # 3. Use a robust root-finding algorithm (Brent's method) to find h_star.\n        #    The root must be between 0 and some upper bound.\n        #    We can analyze that E(h) is monotonic and E(h->inf) -> 1.\n        #    So for epsilon  1, a root exists. A bracket of [1e-9, 2.0] is safe.\n        h_low = 1e-9\n        h_high = 2.0 \n        \n        # Verify the bracket signs. target_function(h_low) should be negative.\n        # target_function(h_high) should be positive for the given epsilon values.\n        # error_function(2.0) = 0.35..., so h_high=2.0 is a safe upper bound for all given epsilons.\n        h_star = brentq(target_function, h_low, h_high, xtol=1e-6)\n        \n        # 4. Calculate the required grid spacing (dx_req) in meters.\n        dx_req_m = h_star * delta_M\n        \n        # 5. Convert to kilometers.\n        dx_req_km = dx_req_m / 1000.0\n        \n        # 6. Format the result to three decimal places and add to the list.\n        # Using an f-string for rounding handles cases like 8.310 correctly.\n        results.append(f\"{dx_req_km:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}