{
    "hands_on_practices": [
        {
            "introduction": "在深入研究西边界流的复杂动态之前，我们首先需要理解为何它们被视为独特的区域。此练习通过对海洋内部（即满足斯维尔德鲁普平衡的区域）进行尺度分析，来量化风应力强迫和底部摩擦耗散的相对重要性。通过这个实践，你将亲自验证为何在大尺度上摩擦是一个次要效应，从而为边界层理论的引入奠定基础。",
            "id": "3802199",
            "problem": "一个西边界流及其风生内部环流可以在一个单层、深度平均的框架内，使用正压涡度方程进行建模。该方程由深度积分的水平动量方程和涡度的运动学定义导出。考虑一个中纬度海盆内部，其中侧向粘性的影响可以忽略不计，且与行星涡度平流和风强迫相比，非线性平流很小。正压流函数 $\\psi$ 定义为 $u=-\\partial\\psi/\\partial y$ 和 $v=\\partial\\psi/\\partial x$，其中 $u$ 和 $v$ 是深度平均速度。相对涡度为 $\\zeta=\\nabla^{2}\\psi$。在具有线性底拖曳的 Stommel 模型中，在存在垂直均匀风应力 $\\boldsymbol{\\tau}$ 的情况下，深度平均的正压涡度方程在主导阶上可写为：\n$$\n\\frac{\\partial \\zeta}{\\partial t} + \\beta v \\approx \\frac{(\\nabla\\times\\boldsymbol{\\tau})_{z}}{\\rho_{0}H} - r\\,\\zeta,\n$$\n其中 $\\beta$ 是科里奥利参数的经向导数，$\\rho_{0}$ 是参考密度，$H$ 是平均深度，$r$ 是线性底拖曳系数。在内部的 Sverdrup 机制中，行星涡度平流在主导阶上与风应力旋度相平衡。\n\n使用典型的中纬度参数 $\\beta = 2\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$H=4000\\ \\mathrm{m}$，$\\rho_{0}=1025\\ \\mathrm{kg\\,m^{-3}}$，风应力旋度大小 $|(\\nabla\\times\\boldsymbol{\\tau})_{z}|=10^{-7}\\ \\mathrm{N\\,m^{-3}}$，以及线性底拖曳 $r=10^{-7}\\ \\mathrm{s^{-1}}$，并假设内部变化的主导水平尺度为 $L=1000\\ \\mathrm{km}$。从正压涡度方程和 Sverdrup 内部平衡出发，通过 Sverdrup 关系和水平尺度 $L$ 将 $\\nabla^{2}\\psi$ 与内部经向速度联系起来，从而推导出风生涡度输入（由风应力旋度引起的内部涡度倾向）的尺度，\n$$\nF \\equiv \\frac{(\\nabla\\times\\boldsymbol{\\tau})_{z}}{\\rho_{0}H},\n$$\n以及 Stommel 底拖曳项 $r\\nabla^{2}\\psi$ 的尺度。然后计算：\n\n1. $F$ 的大小，单位为 $\\mathrm{s^{-2}}$。\n2. 在上述尺度分析下的无量纲比率 $R \\equiv \\dfrac{r\\nabla^{2}\\psi}{F}$。\n\n按如下方式表示最终数值：将两个数字作为一个单行向量提供，四舍五入到三位有效数字。第一个条目必须是以 $\\mathrm{s^{-2}}$ 为单位的 $F$，第二个条目必须是无量纲的 $R$。在最终的方框答案中不要包含单位。",
            "solution": "问题陈述具有科学依据，内容自洽，且提法明确。所有参数和控制方程在风生海洋环流理论，特别是 Stommel 模型中，都是标准的。因此，我们可以着手求解。\n\n问题要求计算两个量：风生涡度输入 $F$ 的大小，以及基于对海洋内部的尺度分析得出的底摩擦项与风强迫项的无量纲比率 $R$。\n\n**1. 风生涡度输入 $F$ 的计算**\n\n风生涡度输入定义为\n$$\nF \\equiv \\frac{(\\nabla\\times\\boldsymbol{\\tau})_{z}}{\\rho_{0}H}\n$$\n问题提供了以下数值：\n- 风应力旋度垂直分量的大小：$|(\\nabla\\times\\boldsymbol{\\tau})_{z}| = 10^{-7}\\ \\mathrm{N\\,m^{-3}}$\n- 海水参考密度：$\\rho_{0} = 1025\\ \\mathrm{kg\\,m^{-3}}$\n- 平均海洋深度：$H = 4000\\ \\mathrm{m}$\n\n将这些值代入 $F$ 的定义中：\n$$\nF = \\frac{10^{-7}\\ \\mathrm{N\\,m^{-3}}}{(1025\\ \\mathrm{kg\\,m^{-3}}) \\times (4000\\ \\mathrm{m})}\n$$\n为了验证单位，我们回想一下牛顿的定义是 $1\\ \\mathrm{N} = 1\\ \\mathrm{kg\\,m\\,s^{-2}}$。\n$$\n\\frac{\\mathrm{N\\,m^{-3}}}{\\mathrm{kg\\,m^{-3}} \\cdot \\mathrm{m}} = \\frac{\\mathrm{kg\\,m\\,s^{-2}\\,m^{-3}}}{\\mathrm{kg\\,m^{-2}}} = \\frac{\\mathrm{kg\\,m^{-2}\\,s^{-2}}}{\\mathrm{kg\\,m^{-2}}} = \\mathrm{s^{-2}}\n$$\n对于涡度倾向来说，单位是正确的。现在，我们计算其数值：\n$$\nF = \\frac{10^{-7}}{1025 \\times 4000} = \\frac{10^{-7}}{4100000} = \\frac{10^{-7}}{4.1 \\times 10^{6}} = \\frac{1}{4.1} \\times 10^{-13}\\ \\mathrm{s^{-2}}\n$$\n$$\nF \\approx 0.2439024... \\times 10^{-13}\\ \\mathrm{s^{-2}} = 2.439024... \\times 10^{-14}\\ \\mathrm{s^{-2}}\n$$\n\n**2. 无量纲比率 $R$ 的计算**\n\n无量纲比率定义为\n$$\nR \\equiv \\frac{r\\nabla^{2}\\psi}{F}\n$$\n为计算此比率，我们必须首先为 $r\\nabla^{2}\\psi$ 项建立一个特征尺度。问题陈述中提到，在 Sverdrup 内部，行星涡度平流 $\\beta v$ 与风应力旋度强迫相平衡。\n$$\n\\beta v \\approx \\frac{(\\nabla\\times\\boldsymbol{\\tau})_{z}}{\\rho_{0}H} = F\n$$\n这个关系为经向速度 $v$ 提供了一个尺度。设 $V$ 为经向速度的特征尺度，则有，\n$$\n\\beta V \\sim F \\implies V \\sim \\frac{F}{\\beta}\n$$\n接下来，我们将相对涡度 $\\zeta = \\nabla^{2}\\psi$ 与速度尺度 $V$ 以及给定的水平长度尺度 $L = 1000\\ \\mathrm{km}$ 联系起来。经向速度通过流函数定义为 $v = \\partial\\psi/\\partial x$。根据这个定义，我们可以为流函数 $\\Psi$ 建立一个尺度：\n$$\nV \\sim \\frac{\\Psi}{L} \\implies \\Psi \\sim V L\n$$\n相对涡度为 $\\zeta = \\nabla^{2}\\psi$。拉普拉斯算子 $\\nabla^2$ 的尺度为 $1/L^2$。因此，相对涡度的尺度是：\n$$\n\\text{Scale}(\\nabla^2\\psi) \\sim \\frac{\\Psi}{L^2}\n$$\n代入 $\\Psi$ 的尺度：\n$$\n\\text{Scale}(\\nabla^2\\psi) \\sim \\frac{V L}{L^2} = \\frac{V}{L}\n$$\n现在，我们代入 Sverdrup 速度尺度 $V \\sim F/\\beta$：\n$$\n\\text{Scale}(\\nabla^2\\psi) \\sim \\frac{F/\\beta}{L} = \\frac{F}{\\beta L}\n$$\n那么，底拖曳项 $r\\nabla^{2}\\psi$ 的尺度为：\n$$\n\\text{Scale}(r\\nabla^{2}\\psi) \\sim r \\cdot \\text{Scale}(\\nabla^2\\psi) \\sim \\frac{rF}{\\beta L}\n$$\n现在我们可以通过将分子尺度除以分母尺度（$F$）来构建无量纲比率 $R$：\n$$\nR \\sim \\frac{\\text{Scale}(r\\nabla^{2}\\psi)}{F} = \\frac{rF/(\\beta L)}{F} = \\frac{r}{\\beta L}\n$$\n这个比率代表了底摩擦相对于行星涡度平流的重要性。我们现在代入给定的数值：\n- 线性底拖曳系数：$r = 10^{-7}\\ \\mathrm{s^{-1}}$\n- 行星涡度梯度：$\\beta = 2\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$\n- 水平长度尺度：$L = 1000\\ \\mathrm{km} = 1000 \\times 10^3\\ \\mathrm{m} = 10^6\\ \\mathrm{m}$\n\n$$\nR = \\frac{10^{-7}\\ \\mathrm{s^{-1}}}{(2\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}) \\times (10^6\\ \\mathrm{m})} = \\frac{10^{-7}}{2 \\times 10^{-5}} = \\frac{1}{2} \\times 10^{-2} = 0.005\n$$\n结果是无量纲的，正如预期。\n\n**总结与最终答案格式**\n\n我们得到了两个所求的数值：\n1.  $F \\approx 2.439024... \\times 10^{-14}\\ \\mathrm{s^{-2}}$\n2.  $R = 0.005$\n\n问题要求四舍五入到三位有效数字。\n1.  $F \\approx 2.44 \\times 10^{-14}\\ \\mathrm{s^{-2}}$\n2.  $R = 0.005 = 5.00 \\times 10^{-3}$\n\n这些值将以单行向量的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.44 \\times 10^{-14}  & 5.00 \\times 10^{-3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一旦我们认识到需要在西边界设置一个摩擦层来闭合环流 ，下一个关键问题就是如何对摩擦过程进行数学建模。此练习将引导你推导并比较两种经典的西边界流模型——斯托梅尔（Stommel）模型和芒克（Munk）模型——中的边界层宽度。通过直接对比基于底部摩擦（斯托梅尔）和侧向粘性（芒克）的不同物理机制，你将能深刻理解模型假设对结果（例如海流宽度）的决定性影响。",
            "id": "3802187",
            "problem": "在一个beta平面上，考虑一个深度均匀的矩形中纬度海盆中稳定、线性正压流的经典西边界流闭合。内部流满足Sverdrup平衡，而西边界的边界层进行调整以满足无穿界流动条件。在Stommel模型中，摩擦由与速度成正比的线性底拖曳表示，其系数为 $r$ (单位为 $\\mathrm{s^{-1}}$)，在正压涡度方程中，该项作为相对涡度的线性阻尼。在Munk模型中，摩擦由侧向运动粘性系数 $\\nu$ (单位为 $\\mathrm{m^2\\,s^{-1}}$) 表示，在正压涡度方程中，该项通过相对涡度的拉普拉斯算子起作用。行星涡度梯度参数为 $\\beta$ (单位为 $\\mathrm{m^{-1}\\,s^{-1}}$)。\n\n从beta平面上的稳定、线性正压涡度方程出发，并利用西边界层中的边界层尺度分析（在纬向 $x$ 方向上，跨边界的变化占主导地位，边界层宽度为 $\\delta$，经向速度尺度为 $V$），推导出Stommel模型和Munk模型中西边界层宽度的尺度表达式。\n\n然后，使用参数值 $\\nu = 1000\\ \\mathrm{m^2\\,s^{-1}}$，$\\beta = 2\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$ 和 $r = 10^{-7}\\ \\mathrm{s^{-1}}$，计算Munk边界层宽度 $\\delta_{M}$ 和Stommel边界层宽度 $\\delta_{S}$。将 $\\delta_{M}$ 和 $\\delta_{S}$ 都以米（$\\mathrm{m}$）为单位表示。\n\n最后，报告无量纲比 $\\delta_{M}/\\delta_{S}$作为你的答案。将你的答案四舍五入到四位有效数字。",
            "solution": "出发点是beta平面上的稳定、线性正压涡度方程，其大致形式为行星涡度平流与相对涡度摩擦耗散之间的平衡。这可以写成：\n$$\n\\beta v = D\n$$\n其中 $v$ 是经向速度，$\\beta$ 是行星涡度梯度，$D$ 代表摩擦项。问题指明了Stommel模型和Munk模型中 $D$ 的形式。\n\n我们分析西边界层，这是一个邻近西边界（比如在 $x=0$ 处）、宽度为 $\\delta$ 的狭窄区域。我们使用尺度分析，其中纬向长度尺度为 $\\delta$，经向长度尺度为海盆尺度 $L$，且 $\\delta \\ll L$。设特征经向速度为 $V$，特征纬向速度为 $U$。对于深度均匀的不可压缩流体，其连续性方程为 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$。对其进行尺度分析得到：\n$$\n\\frac{U}{\\delta} \\sim \\frac{V}{L} \\implies U \\sim V \\frac{\\delta}{L}\n$$\n由于 $\\delta \\ll L$，可得出 $U \\ll V$。\n\n相对涡度为 $\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。这两项的尺度分别为：\n$$\n\\frac{\\partial v}{\\partial x} \\sim \\frac{V}{\\delta} \\quad \\text{and} \\quad \\frac{\\partial u}{\\partial y} \\sim \\frac{U}{L} \\sim \\frac{V\\delta}{L^2}\n$$\n因为 $\\delta \\ll L$，我们有 $\\frac{V}{\\delta} \\gg \\frac{V\\delta}{L^2}$，这意味着边界层中的相对涡度由经向流的纬向切变主导：\n$$\n\\zeta \\approx \\frac{\\partial v}{\\partial x}\n$$\n因此，相对涡度的尺度为 $\\zeta \\sim \\frac{V}{\\delta}$。\n\nStommel边界层宽度 $\\delta_S$ 的推导：\n在Stommel模型中，摩擦是系数为 $r$ 的线性底拖曳。涡度方程中的摩擦项为 $D = -r\\zeta$。控制方程为：\n$$\n\\beta v = -r\\zeta\n$$\n将边界层中涡度的近似表达式代入，我们得到：\n$$\n\\beta v \\approx -r \\frac{\\partial v}{\\partial x}\n$$\n在西边界层中，行星涡度的平流和摩擦项之间必须存在平衡。我们对此方程进行尺度分析。各项的尺度为：\n左侧项：$\\beta v \\sim \\beta V$\n右侧项：$-r \\frac{\\partial v}{\\partial x} \\sim r \\frac{V}{\\delta_S}$\n其中 $\\delta_S$ 是Stommel边界层宽度。令这些主导项的尺度相等，得到：\n$$\n\\beta V \\sim r \\frac{V}{\\delta_S} \\implies \\beta \\sim \\frac{r}{\\delta_S}\n$$\n求解边界层宽度，我们得到尺度表达式：\n$$\n\\delta_S = \\frac{r}{\\beta}\n$$\n\nMunk边界层宽度 $\\delta_M$ 的推导：\n在Munk模型中，摩擦是由侧向粘性 $\\nu$ 引起的。涡度方程中的摩擦项为 $D = \\nu \\nabla^2 \\zeta$。控制方程为：\n$$\n\\beta v = \\nu \\nabla^2 \\zeta\n$$\n同样，我们使用 $\\zeta \\approx \\frac{\\partial v}{\\partial x}$。摩擦项变为 $\\nu \\nabla^2(\\frac{\\partial v}{\\partial x})$。拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。将其应用于 $\\frac{\\partial v}{\\partial x}$：\n$$\n\\nabla^2 \\left(\\frac{\\partial v}{\\partial x}\\right) = \\frac{\\partial^3 v}{\\partial x^3} + \\frac{\\partial^3 v}{\\partial y^2 \\partial x}\n$$\n让我们以 $\\delta_M$ 作为Munk边界层宽度，对该项的两个分量进行尺度分析：\n$$\n\\frac{\\partial^3 v}{\\partial x^3} \\sim \\frac{V}{\\delta_M^3} \\quad \\text{and} \\quad \\frac{\\partial^3 v}{\\partial y^2 \\partial x} \\sim \\frac{V}{L^2 \\delta_M}\n$$\n由于 $\\delta_M \\ll L$，项 $\\frac{V}{\\delta_M^3}$ 远大于 $\\frac{V}{L^2 \\delta_M}$。因此，摩擦项由关于 $x$ 的最高阶导数主导：\n$$\n\\nu \\nabla^2 \\zeta \\sim \\nu \\frac{\\partial^3 v}{\\partial x^3}\n$$\nMunk边界层中的控制方程近似为：\n$$\n\\beta v \\approx \\nu \\frac{\\partial^3 v}{\\partial x^3}\n$$\n我们对此方程进行尺度分析。各项的尺度为：\n左侧项：$\\beta v \\sim \\beta V$\n右侧项：$\\nu \\frac{\\partial^3 v}{\\partial x^3} \\sim \\nu \\frac{V}{\\delta_M^3}$\n令各项尺度相等得到平衡关系：\n$$\n\\beta V \\sim \\nu \\frac{V}{\\delta_M^3} \\implies \\beta \\sim \\frac{\\nu}{\\delta_M^3}\n$$\n求解边界层宽度，我们得到尺度表达式：\n$$\n\\delta_M = \\left(\\frac{\\nu}{\\beta}\\right)^{1/3}\n$$\n\n现在，我们使用给定的参数计算数值：$\\nu = 1000\\ \\mathrm{m^2\\,s^{-1}}$，$\\beta = 2\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，和 $r = 10^{-7}\\ \\mathrm{s^{-1}}$。\n\nStommel边界层宽度 $\\delta_S$：\n$$\n\\delta_S = \\frac{r}{\\beta} = \\frac{10^{-7}\\ \\mathrm{s^{-1}}}{2 \\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}} = 0.5 \\times 10^4\\ \\mathrm{m} = 5000\\ \\mathrm{m}\n$$\n\nMunk边界层宽度 $\\delta_M$：\n$$\n\\delta_M = \\left(\\frac{\\nu}{\\beta}\\right)^{1/3} = \\left(\\frac{1000\\ \\mathrm{m^2\\,s^{-1}}}{2 \\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}}\\right)^{1/3} = \\left(\\frac{10^3}{2 \\times 10^{-11}}\\ \\mathrm{m^3}\\right)^{1/3} = (0.5 \\times 10^{14}\\ \\mathrm{m^3})^{1/3} = (50 \\times 10^{12}\\ \\mathrm{m^3})^{1/3}\n$$\n$$\n\\delta_M = (50)^{1/3} \\times 10^4\\ \\mathrm{m} \\approx 3.684031 \\times 10^4\\ \\mathrm{m} \\approx 36840.31\\ \\mathrm{m}\n$$\n\n最后，我们计算无量纲比 $\\frac{\\delta_M}{\\delta_S}$：\n$$\n\\frac{\\delta_M}{\\delta_S} = \\frac{36840.31\\ \\mathrm{m}}{5000\\ \\mathrm{m}} \\approx 7.368062\n$$\n将结果四舍五入到四位有效数字，得到 $7.368$。",
            "answer": "$$\\boxed{7.368}$$"
        },
        {
            "introduction": "物理理论与计算实践在此交汇。对芒克边界层宽度的理论理解并不仅仅是学术推导，它直接决定了数值海洋模型的基本设置。这个练习将指导你完成一个网格收敛性分析，从而将芒克层的物理尺度 $\\delta_M$  与精确模拟边界流剪切所需的最小网格分辨率联系起来。这是一个将理论知识转化为实际计算参数的关键实践。",
            "id": "3802228",
            "problem": "考虑一个在β平面上的正交、中纬度、风生环流，其主导项由行星涡度平流和侧向摩擦之间的定常、线性、正压涡度平衡所控制。设行星涡度梯度为 $\\beta$（单位为 $\\mathrm{m^{-1}\\,s^{-1}}$），常数侧向粘性系数为 $A_h$（单位为 $\\mathrm{m^2\\,s^{-1}}$）。一个西边界流 (WBC) 出现，并带有一个粘性边界层，其特征宽度可通过尺度分析获得。您的目标是通过基于原则的网格收敛性分析，确定在指定的相对误差容限内解析WBC近壁面切变所需的最小水平网格间距 $\\Delta x$。\n\n起点和建模假设：\n- 从β平面上具有常数侧向粘性系数的定常、线性、正压涡度方程出发。不要假定任何闭合形式的边界流解；相反，使用尺度分析来确定一个边界层宽度尺度。设此尺度记为 $\\delta_M$，单位为米。\n- 采用沿边界速度大小随离岸坐标 $x$ 变化的典型无量纲边界层原型剖面：$u(x) = U\\,f(x/\\delta_M)$，其中 $f(X)=e^{-X}$，$X=x/\\delta_M$，$U$ 是一个特征速度尺度，在下面定义的相对误差度量中被抵消。\n- 为量化海岸 $x=0$ 处边界流切变的分辨率，使用壁面处一阶导数的单边、三点、二阶有限差分 (FD) 近似：\n$$\n\\left.\\frac{du}{dx}\\right|_{x=0}\\approx \\frac{-3u(0)+4u(\\Delta x)-u(2\\Delta x)}{2\\Delta x}.\n$$\n- 定义无量纲网格尺寸为 $h=\\Delta x/\\delta_M$。对于 $f(X)=e^{-X}$，在 $X=0$ 处的精确无量纲壁面导数为 $-1$。定义壁面切变近似的相对误差为\n$$\n\\mathcal{E}(h)=\\left|\\frac{\\frac{-3+4e^{-h}-e^{-2h}}{2h}-(-1)}{-1}\\right|=\\left|\\frac{-3+4e^{-h}-e^{-2h}}{2h}+1\\right|.\n$$\n\n任务：\n1. 根据涡度平衡，使用尺度分析推导出 Munk 边界层宽度尺度 $\\delta_M$（单位为米），作为 $\\beta$ 和 $A_h$ 的函数。仅使用控制方程的基本推理；不要假定目标公式。\n2. 使用误差度量 $\\mathcal{E}(h)$，进行网格收敛性分析，以计算满足 $\\mathcal{E}(h_\\star)=\\varepsilon$ 的最大允许无量纲网格尺寸 $h_\\star$，其中 $\\varepsilon$ 为指定的容限（无单位，以小数形式给出）。将解析边界切变所需的最小网格间距解释为 $\\Delta x_{\\text{req}} = h_\\star\\,\\delta_M$。\n3. 为给定的 $\\varepsilon$ 实现一个稳健的数值程序来确定 $h_\\star$。您的方法不得假定先验的多项式误差模型；它必须使用精确的 $\\mathcal{E}(h)$，并找到满足 $\\mathcal{E}(h)\\le \\varepsilon$ 的最小 $h$，其 $h$ 的绝对容差在 $10^{-6}$ 以内。\n4. 对于下面的每个测试用例，计算 $\\delta_M$（单位为米），然后计算 $\\Delta x_{\\text{req}}$（单位为米），并以公里为单位报告最终答案 $\\Delta x_{\\text{req}}$。最终答案以公里（km）表示，每个答案四舍五入到三位小数。\n\n测试套件：\n- 用例 1：$\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=400\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.05$。\n- 用例 2：$\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=1600\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.05$。\n- 用例 3：$\\beta=1.6\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=400\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.02$。\n- 用例 4：$\\beta=2.5\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=50\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.10$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按上述用例的顺序排列结果，每个条目等于以公里（km）为单位的 $\\Delta x_{\\text{req}}$，四舍五入到三位小数（例如，$\\left[\\text{val}_1,\\text{val}_2,\\text{val}_3,\\text{val}_4\\right]$）。",
            "solution": "用户提供了一个需要多步分析的问题，涉及地球物理流体动力学、尺度分析和数值方法。我将首先验证问题陈述，然后提供详细的解决方案。\n\n### 步骤 1：提取给定信息\n- **控制物理**：β平面上的定常、线性、正压涡度平衡。平衡发生在行星涡度平流和侧向摩擦之间。\n- **参数**：\n    - $\\beta$：行星涡度梯度（$\\mathrm{m^{-1}\\,s^{-1}}$）。\n    - $A_h$：常数侧向粘性系数（$\\mathrm{m^2\\,s^{-1}}$）。\n- **定义**：\n    - $\\delta_M$：Munk 边界层宽度尺度（m）。\n    - $u(x)$：沿边界速度大小作为离岸坐标 $x$ 的函数。\n    - 速度剖面模型：$u(x) = U\\,f(x/\\delta_M)$，其中 $f(X)=e^{-X}$ 且 $X=x/\\delta_M$。\n    - $\\Delta x$：水平网格间距（m）。\n    - $h$：无量纲网格尺寸，$h = \\Delta x / \\delta_M$。\n- **数值格式**：\n    - 壁面切变的单边、三点、二阶有限差分近似：\n    $$\n    \\left.\\frac{du}{dx}\\right|_{x=0}\\approx \\frac{-3u(0)+4u(\\Delta x)-u(2\\Delta x)}{2\\Delta x}\n    $$\n- **误差度量**：\n    - 壁面切变近似的相对误差：\n    $$\n    \\mathcal{E}(h)=\\left|\\frac{\\frac{-3+4e^{-h}-e^{-2h}}{2h}-(-1)}{-1}\\right|=\\left|\\frac{-3+4e^{-h}-e^{-2h}}{2h}+1\\right|\n    $$\n- **任务目标**：\n    - 找到满足 $\\mathcal{E}(h_\\star)=\\varepsilon$ 的最大允许无量纲网格尺寸 $h_\\star$，其中 $\\varepsilon$ 为给定的容限。\n    - 所需的最小网格间距为 $\\Delta x_{\\text{req}} = h_\\star\\,\\delta_M$。\n    - $h_\\star$ 的数值求解器必须具有 $10^{-6}$ 的绝对容差。\n- **测试用例**：\n    - 用例 1：$\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=400\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.05$。\n    - 用例 2：$\\beta=2.0\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=1600\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.05$。\n    - 用例 3：$\\beta=1.6\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=400\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.02$。\n    - 用例 4：$\\beta=2.5\\times 10^{-11}\\ \\mathrm{m^{-1}\\,s^{-1}}$，$A_h=50\\ \\mathrm{m^2\\,s^{-1}}$，$\\varepsilon=0.10$。\n\n### 步骤 2：使用提取的给定信息进行验证\n根据验证标准评估该问题：\n- **科学依据**：该问题基于 Munk 模型，这是一个关于风生西边界流的物理海洋学中的经典模型。控制方程、力的平衡（行星涡度平流与摩擦）、由此产生的边界层尺度以及指数速度剖面都是标准且成熟的概念。涉及有限差分格式和误差分析的数值分析任务是计算科学中的标准程序。该问题在科学上是合理的。\n- **适定性**：该问题定义精确。它提供了控制方程、速度剖面模型、要使用的特定有限差分公式以及清晰的误差度量。目标是通过求解一个定义明确的方程（$\\mathcal{E}(h)=\\varepsilon$）来找到一个特定的量（$h_\\star$）。所有必要的物理参数和数值容差都已提供。函数 $\\mathcal{E}(h)$ 在 $h > 0$ 时是单调的，确保了 $h_\\star$ 的唯一解。该问题是适定的。\n- **客观性**：该问题以客观、定量的术语陈述，没有歧义或主观主张。\n\n### 步骤 3：结论与行动\n该问题在科学上有效、适定且客观。我现在将开始进行解答。\n\n### 解答\n\n解答过程分为三部分。首先，我们推导 Munk 边界层宽度尺度 $\\delta_M$。其次，我们详细说明了寻找所需无量纲网格尺寸 $h_\\star$ 的数值程序。最后，我们对每个测试用例进行计算。\n\n#### 1. Munk 边界层宽度尺度 ($\\delta_M$) 的推导\n\n控制方程是定常、线性、正压涡度方程。对于西边界流，主导平衡发生在行星涡度平流和侧向摩擦之间。该平衡表示为：\n$$\n\\beta v \\approx A_h \\nabla^2 \\zeta\n$$\n其中 $v$ 是经向速度，$\\beta$ 是行星涡度梯度， $A_h$ 是侧向涡动粘性系数，$\\zeta$ 是相对涡度，$\\zeta = \\partial v/\\partial x - \\partial u/\\partial y$。\n\n我们在边界层内进行尺度分析。设 $\\delta_M$ 为边界流的特征宽度（$x$ 方向），$L$ 为其特征长度（$y$ 方向），且 $L \\gg \\delta_M$。设 $V$ 和 $U$ 分别为 $y$ 和 $x$ 方向的特征速度尺度。根据连续性方程 $\\partial u / \\partial x + \\partial v / \\partial y = 0$，我们有尺度关系 $U/\\delta_M \\sim V/L$，这意味着 $U \\sim V(\\delta_M/L) \\ll V$。\n\n在边界层中，横流（$x$）方向的导数远大于沿流（$y$）方向的导数，即 $\\partial/\\partial x \\gg \\partial/\\partial y$。\n因此，相对涡度尺度由 $x$ 方向的切变主导：\n$$\n\\zeta \\sim \\frac{\\partial v}{\\partial x} \\sim \\frac{V}{\\delta_M}\n$$\n侧向摩擦项为 $A_h \\nabla^2 \\zeta = A_h (\\partial^2/\\partial x^2 + \\partial^2/\\partial y^2)\\zeta$。主导项是关于 $x$ 的最高阶导数：\n$$\nA_h \\nabla^2 \\zeta \\sim A_h \\frac{\\partial^2 \\zeta}{\\partial x^2} \\sim A_h \\frac{\\partial^2}{\\partial x^2}\\left(\\frac{V}{\\delta_M}\\right) \\sim A_h \\frac{V}{\\delta_M^3}\n$$\n行星涡度平流项的尺度为：\n$$\n\\beta v \\sim \\beta V\n$$\n令涡度平衡中两个主导项的尺度相等：\n$$\n\\beta V \\sim A_h \\frac{V}{\\delta_M^3}\n$$\n速度尺度 $V$ 被抵消，得到边界层宽度的关系：\n$$\n\\beta \\sim \\frac{A_h}{\\delta_M^3}\n$$\n求解 $\\delta_M$，我们得到 Munk 边界层宽度尺度：\n$$\n\\delta_M = \\left(\\frac{A_h}{\\beta}\\right)^{1/3}\n$$\n\n#### 2. 无量纲网格尺寸 ($h_\\star$) 的数值确定\n\n该问题要求找到最大的无量纲网格尺寸 $h_\\star = \\Delta x_{\\text{req}}/\\delta_M$，使得近似壁面切变的相对误差等于指定的容限 $\\varepsilon$。相对误差由下式给出：\n$$\n\\mathcal{E}(h) = \\left|\\frac{-3+4e^{-h}-e^{-2h}}{2h}+1\\right|\n$$\n我们需要求解方程 $\\mathcal{E}(h) = \\varepsilon$。我们定义一个函数 $G(h) = \\mathcal{E}(h) - \\varepsilon$。我们正在寻找 $G(h)=0$ 的根。\n\n$\\mathcal{E}(h)$ 在 $h=0$ 附近的泰勒级数展开显示 $\\mathcal{E}(h) = \\frac{1}{3}h^2 + O(h^4)$，表明该有限差分格式如所述是二阶精确的，并且误差随 $h$ 的增大而增大。由于 $\\mathcal{E}(h)$ 是一个在 $h > 0$ 时单调递增的函数，对于任何给定的 $\\varepsilon \\in (0, 1)$，存在一个唯一的根 $h_\\star > 0$。\n\n为了高精度地找到这个根，我们采用一个稳健的数值求根算法。二分法或 Brent 方法是绝佳的选择。鉴于我们可以轻易地为根确定区间（例如，当 $h \\to 0$ 时，$G(h) \\to -\\varepsilon  0$，而对于足够大的 $h$，$G(h) > 0$），这些方法保证收敛。我们将使用一个数值求解器来找到满足 $G(h_\\star) = 0$ 的 $h_\\star$，其 $h$ 的绝对容差为 $10^{-6}$。\n\n#### 3. 所需网格间距 ($\\Delta x_{\\text{req}}$) 的计算\n\n对于每个测试用例，我们执行以下步骤：\n1.  使用推导出的公式 $\\delta_M = (A_h / \\beta)^{1/3}$ 计算 Munk 宽度 $\\delta_M$。\n2.  通过求解方程 $\\mathcal{E}(h) - \\varepsilon = 0$ 的根来数值求解 $h_\\star$。\n3.  计算所需的物理网格间距 $\\Delta x_{\\text{req}} = h_\\star \\cdot \\delta_M$。\n4.  将 $\\Delta x_{\\text{req}}$ 从米转换为公里，并将结果四舍五入到三位小数。\n\n**用例 1**：$\\beta=2.0\\times 10^{-11}$，$A_h=400$，$\\varepsilon=0.05$\n- $\\delta_M = (400 / (2.0 \\times 10^{-11}))^{1/3} = (2 \\times 10^{13})^{1/3} \\approx 27144.176\\ \\mathrm{m}$。\n- 求解 $\\mathcal{E}(h) = 0.05$。求解器得出 $h_\\star \\approx 0.45534$。\n- $\\Delta x_{\\text{req}} = 0.45534 \\times 27144.176 \\approx 12361.6\\ \\mathrm{m}$。\n- $\\Delta x_{\\text{req}} \\approx 12.362\\ \\mathrm{km}$。\n\n**用例 2**：$\\beta=2.0\\times 10^{-11}$，$A_h=1600$，$\\varepsilon=0.05$\n- $\\delta_M = (1600 / (2.0 \\times 10^{-11}))^{1/3} = (8 \\times 10^{13})^{1/3} \\approx 43088.694\\ \\mathrm{m}$。\n- $\\varepsilon$ 不变，所以 $h_\\star$ 相同：$h_\\star \\approx 0.45534$。\n- $\\Delta x_{\\text{req}} = 0.45534 \\times 43088.694 \\approx 19616.9\\ \\mathrm{m}$。\n- $\\Delta x_{\\text{req}} \\approx 19.617\\ \\mathrm{km}$。\n\n**用例 3**：$\\beta=1.6\\times 10^{-11}$，$A_h=400$，$\\varepsilon=0.02$\n- $\\delta_M = (400 / (1.6 \\times 10^{-11}))^{1/3} = (2.5 \\times 10^{13})^{1/3} \\approx 29240.177\\ \\mathrm{m}$。\n- 求解 $\\mathcal{E}(h) = 0.02$。求解器得出 $h_\\star \\approx 0.28422$。\n- $\\Delta x_{\\text{req}} = 0.28422 \\times 29240.177 \\approx 8310.2\\ \\mathrm{m}$。\n- $\\Delta x_{\\text{req}} \\approx 8.310\\ \\mathrm{km}$。\n\n**用例 4**：$\\beta=2.5\\times 10^{-11}$，$A_h=50$，$\\varepsilon=0.10$\n- $\\delta_M = (50 / (2.5 \\times 10^{-11}))^{1/3} = (2 \\times 10^{12})^{1/3} \\approx 12599.210\\ \\mathrm{m}$。\n- 求解 $\\mathcal{E}(h) = 0.10$。求解器得出 $h_\\star \\approx 0.63004$。\n- $\\Delta x_{\\text{req}} = 0.63004 \\times 12599.210 \\approx 7938.0\\ \\mathrm{m}$。\n- $\\Delta x_{\\text{req}} \\approx 7.938\\ \\mathrm{km}$。",
            "answer": "$$\n\\boxed{[12.362,19.617,8.310,7.938]}\n$$"
        }
    ]
}