{
    "hands_on_practices": [
        {
            "introduction": "A crucial aspect of developing a stable numerical model is understanding how physical wave speeds constrain the choice of computational parameters. This exercise connects the physics of fast-propagating coastal Kelvin waves to the numerics of explicit time-stepping schemes through the Courant–Friedrichs–Lewy (CFL) condition. By deriving the non-dispersive wave speed and performing a von Neumann stability analysis, you will determine the maximum stable time step, a fundamental skill for setting up any time-dependent simulation in geophysical fluid dynamics. ",
            "id": "3800496",
            "problem": "Consider an inviscid, linear, rotating shallow-water system on a constant-$f$ plane with uniform depth $H$ and gravitational acceleration $g$. Let the coastline be a straight boundary aligned with the $x$-axis at $y=0$, with a no-normal-flow boundary condition $v(x,0,t)=0$. Assume small perturbations with sea surface height $\\eta(x,y,t)$ and depth-averaged velocities $u(x,y,t)$ and $v(x,y,t)$ that satisfy the linearized rotating shallow-water equations:\n$$\nu_{t} - f v = - g \\,\\eta_{x}, \\quad v_{t} + f u = - g \\,\\eta_{y}, \\quad \\eta_{t} + H\\,(u_{x} + v_{y}) = 0,\n$$\nwhere subscripts denote partial derivatives. A coastal Kelvin wave is a boundary-trapped solution that decays offshore and propagates along the coast. Starting from the equations above, derive the non-dispersive phase speed $c$ of this Kelvin wave as a function of $g$ and $H$.\n\nNow consider the one-way alongshore propagation of the Kelvin wave envelope governed by the linear advection partial differential equation (PDE) $\\eta_{t} + c\\,\\eta_{x} = 0$. Discretize this PDE using a first-order upwind finite difference for space and forward Euler for time on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, assuming $c>0$. Perform a von Neumann stability analysis of the resulting explicit scheme to determine the stability constraint on $\\Delta t$ in terms of $\\Delta x$ and $c$. In your derivation, explicitly introduce the Courant–Friedrichs–Lewy (CFL) number $\\lambda$ and the amplification factor, and obtain the condition under which the amplification factor has magnitude less than or equal to one for all Fourier modes.\n\nFinally, for a basin-scale model configured with $H = 4000\\,\\mathrm{m}$, $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$, and horizontal grid spacing $\\Delta x = 25\\,\\mathrm{km}$ along the coast, use your stability result to compute the largest stable explicit time step $\\Delta t_{\\max}$ that resolves the fast barotropic Kelvin wave. Round your numerical answer to four significant figures and express it in seconds. Briefly explain, based on your derivation, the implications of this stability constraint for resolving slow planetary Rossby waves within the same explicit model.",
            "solution": "The user has provided a multi-part problem concerning coastal Kelvin waves and the numerical stability of their simulation. The problem is scientifically sound, well-posed, and objective. It is a standard problem in geophysical fluid dynamics and computational methods. I will solve it in three parts as requested.\n\nPart 1: Derivation of the Kelvin Wave Phase Speed\n\nThe governing equations are the linearized rotating shallow-water equations on a constant-$f$ plane for an inviscid fluid of uniform depth $H$:\n$$u_{t} - f v = - g \\,\\eta_{x} \\quad (1)$$\n$$v_{t} + f u = - g \\,\\eta_{y} \\quad (2)$$\n$$\\eta_{t} + H\\,(u_{x} + v_{y}) = 0 \\quad (3)$$\nThe boundary condition is no-normal-flow at the coast $y=0$, which means $v(x,0,t) = 0$.\n\nA coastal Kelvin wave is a specific solution to this system that is trapped at the boundary and propagates along it. A defining characteristic of the Kelvin wave is that the cross-shore velocity is zero everywhere, i.e., $v(x,y,t) = 0$ for all $x, y, t$. This identically satisfies the boundary condition at $y=0$. With $v=0$, the system of equations simplifies considerably:\nFrom $(1)$: $u_{t} = -g\\eta_{x} \\quad (4)$\nFrom $(2)$: $f u = -g\\eta_{y} \\quad (5)$\nFrom $(3)$: $\\eta_{t} + H u_{x} = 0 \\quad (6)$\n\nEquation $(5)$ represents a geostrophic balance in the cross-shore ($y$) direction. Equations $(4)$ and $(6)$ describe the wave propagation in the along-shore ($x$) direction. To find the phase speed, we can combine $(4)$ and $(6)$. Differentiate $(6)$ with respect to $t$ and $(4)$ with respect to $x$:\n$$\\eta_{tt} + H u_{xt} = 0$$\n$$u_{tx} = -g \\eta_{xx}$$\nAssuming the fields are sufficiently smooth, the order of differentiation does not matter ($u_{xt} = u_{tx}$). Substituting the second into the first yields:\n$$\\eta_{tt} - gH \\eta_{xx} = 0$$\nThis is the one-dimensional wave equation for the sea surface height $\\eta$. The general solution describes waves propagating in the $\\pm x$ direction with a phase speed $c$ given by $c^2 = gH$. Therefore, the phase speed is:\n$$c = \\sqrt{gH}$$\nSince the phase speed $c$ does not depend on the wavenumber or frequency, the wave is non-dispersive.\n\nTo confirm the boundary-trapped nature, we examine equation $(5)$, $fu = -g\\eta_y$. We look for a solution propagating in the $+x$ direction, of the form $\\eta(x,y,t) = F(y)G(x-ct)$. From the wave equation, we know $u$ will also have this form. From $(4)$, $u_t = -c u'$, and $\\eta_x = \\eta'$, where prime denotes differentiation with respect to the argument $x-ct$. So, $-cu' = -g\\eta'$, which integrates to $u = (g/c)\\eta$ (assuming zero integration constant for a pure wave solution). Substituting this into $(5)$:\n$$f \\left(\\frac{g}{c}\\eta\\right) = -g \\frac{\\partial \\eta}{\\partial y}$$\n$$\\frac{\\partial \\eta}{\\partial y} = -\\frac{f}{c}\\eta$$\nThe solution for the offshore structure of $\\eta$ is $\\eta(x,y,t) = \\eta_0(x-ct) \\exp\\left(-\\frac{f}{c}y\\right)$. For the wave to be trapped at the coast (i.e., decay as $y \\rightarrow \\infty$), the exponent must be negative. Since $c=\\sqrt{gH}$ is positive and $y>0$, this requires the Coriolis parameter $f$ to be positive. This corresponds to a wave propagating with the coast on its right in the Northern Hemisphere.\n\nPart 2: Von Neumann Stability Analysis\n\nThe problem asks to analyze the stability of the numerical scheme for the one-way advection equation $\\eta_t + c\\,\\eta_x=0$, where $c > 0$. The scheme is forward Euler in time and first-order upwind in space.\nLet $\\eta_j^n$ denote the numerical solution at grid point $x_j=j\\Delta x$ and time $t_n=n\\Delta t$.\nThe forward Euler time difference is: $\\eta_t \\approx \\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t}$.\nSince the wave propagates in the $+x$ direction ($c>0$), the \"upwind\" direction is the $-x$ direction. Therefore, we use a first-order backward difference for the spatial derivative: $\\eta_x \\approx \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x}$.\n\nSubstituting these into the PDE gives the finite difference equation:\n$$\\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t} + c \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x} = 0$$\nWe solve for $\\eta_j^{n+1}$:\n$$\\eta_j^{n+1} = \\eta_j^n - \\frac{c \\Delta t}{\\Delta x} (\\eta_j^n - \\eta_{j-1}^n)$$\nWe introduce the Courant–Friedrichs–Lewy (CFL) number, $\\lambda = \\frac{c \\Delta t}{\\Delta x}$. The equation becomes:\n$$\\eta_j^{n+1} = \\eta_j^n - \\lambda (\\eta_j^n - \\eta_{j-1}^n) = (1-\\lambda)\\eta_j^n + \\lambda \\eta_{j-1}^n$$\nFor the von Neumann stability analysis, we consider a single Fourier mode as a solution:\n$$\\eta_j^n = G^n e^{ik j \\Delta x}$$\nHere, $k$ is the wavenumber and $G$ is the complex amplification factor. A scheme is stable if $|G| \\le 1$ for all possible wavenumbers.\nSubstituting the Fourier mode into the difference equation:\n$$G^{n+1} e^{ik j \\Delta x} = (1-\\lambda) G^n e^{ik j \\Delta x} + \\lambda G^n e^{ik (j-1) \\Delta x}$$\nDividing by $G^n e^{ik j \\Delta x}$:\n$$G = (1-\\lambda) + \\lambda e^{-ik \\Delta x}$$\nLet the dimensionless wavenumber be $\\theta = k \\Delta x$. Then $e^{-ik \\Delta x} = \\cos(\\theta) - i\\sin(\\theta)$.\n$$G = (1-\\lambda) + \\lambda (\\cos(\\theta) - i\\sin(\\theta)) = (1-\\lambda + \\lambda\\cos(\\theta)) - i(\\lambda\\sin(\\theta))$$\nThe magnitude squared of the amplification factor is $|G|^2$:\n$$|G|^2 = (1-\\lambda + \\lambda\\cos(\\theta))^2 + (-\\lambda\\sin(\\theta))^2$$\n$$|G|^2 = (1-\\lambda)^2 + 2\\lambda(1-\\lambda)\\cos(\\theta) + \\lambda^2\\cos^2(\\theta) + \\lambda^2\\sin^2(\\theta)$$\n$$|G|^2 = (1-2\\lambda+\\lambda^2) + 2\\lambda(1-\\lambda)\\cos(\\theta) + \\lambda^2(\\cos^2(\\theta)+\\sin^2(\\theta))$$\n$$|G|^2 = 1-2\\lambda+\\lambda^2 + 2\\lambda\\cos(\\theta) - 2\\lambda^2\\cos(\\theta) + \\lambda^2$$\n$$|G|^2 = 1 - 2\\lambda(1-\\cos(\\theta)) + 2\\lambda^2(1-\\cos(\\theta))$$\n$$|G|^2 = 1 - 2\\lambda(1-\\lambda)(1-\\cos\\theta)$$\nFor stability, we require $|G|^2 \\le 1$ for all real $\\theta$. This means:\n$$1 - 2\\lambda(1-\\lambda)(1-\\cos\\theta) \\le 1$$\n$$-2\\lambda(1-\\lambda)(1-\\cos\\theta) \\le 0$$\nSince $\\Delta t>0$ and $\\Delta x>0$, and we are given $c>0$, the CFL number $\\lambda$ is positive. The term $(1-\\cos\\theta)$ is always non-negative for any real $\\theta$. Thus, we can divide the inequality by the non-positive term $-2(1-\\cos\\theta)$ (for $\\theta \\neq 2n\\pi$) and reverse the inequality sign, or we can analyze the factors. For the inequality to hold, the product $\\lambda(1-\\lambda)$ must be non-negative.\nSince $\\lambda > 0$, we must have $1-\\lambda \\ge 0$, which implies $\\lambda \\le 1$.\nCombining the positivity of $\\lambda$ with this result, the stability condition is:\n$$0 \\le \\lambda \\le 1$$\nSubstituting back $\\lambda = \\frac{c \\Delta t}{\\Delta x}$:\n$$0 \\le \\frac{c \\Delta t}{\\Delta x} \\le 1$$\nThis yields the stability constraint on the time step $\\Delta t$:\n$$\\Delta t \\le \\frac{\\Delta x}{c}$$\n\nPart 3: Numerical Calculation and Implications\n\nFirst, we calculate the phase speed $c$ of the barotropic Kelvin wave using the given values $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$ and $H = 4000\\,\\mathrm{m}$.\n$$c = \\sqrt{gH} = \\sqrt{(9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2})(4000\\,\\mathrm{m})} = \\sqrt{39240\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} \\approx 198.0909\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$$\nNext, we determine the largest stable time step, $\\Delta t_{\\max}$, using the stability constraint derived in Part 2. The grid spacing is given as $\\Delta x = 25\\,\\mathrm{km} = 25000\\,\\mathrm{m}$.\n$$\\Delta t_{\\max} = \\frac{\\Delta x}{c} = \\frac{25000\\,\\mathrm{m}}{198.0909\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx 126.204\\,\\mathrm{s}$$\nRounding to four significant figures, the largest stable time step is $126.2\\,\\mathrm{s}$.\n\nImplications for resolving slow planetary Rossby waves:\nThe stability of the explicit time-stepping scheme is dictated by the Courant–Friedrichs–Lewy (CFL) condition. This condition ensures that the numerical domain of dependence contains the physical domain of dependence. The constraint $\\Delta t \\le \\Delta x/c$ is determined by the fastest propagating wave in the system, which in this case is the barotropic Kelvin wave with a speed of approximately $200\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$. This results in a very small maximum allowable time step, $\\Delta t_{\\max} \\approx 2.1\\,\\mathrm{minutes}$.\n\nPlanetary Rossby waves, however, are much slower phenomena. Their propagation speeds are orders of magnitude smaller than the Kelvin wave speed, and their characteristic time scales are on the order of weeks to years. To simulate the evolution of these slow waves over climatologically relevant periods (e.g., decades), an enormous number of time steps would be required if the model is constrained by $\\Delta t_{\\max}$. For example, simulating one year would require approximately $(365 \\times 24 \\times 3600) / 126.2 \\approx 2.5 \\times 10^5$ steps. This makes the use of a simple explicit model computationally prohibitive for studying slow-moving Rossby waves. This issue, known as stiffness, where the system contains processes with vastly different time scales, is a major challenge in computational modeling of geophysical fluids. To overcome this, ocean models often employ semi-implicit or fully implicit time-stepping methods, or mode-splitting techniques that treat the fast and slow modes of the system differently, allowing for a much larger time step for the slow dynamics.",
            "answer": "$$\n\\boxed{126.2}\n$$"
        },
        {
            "introduction": "Beyond temporal stability, the spatial accuracy of a model is paramount, especially for resolving features trapped over specific length scales like the Rossby deformation radius, $R_d$. This practice provides a quantitative framework for a core question in model setup: how many grid points are needed to accurately represent a wave's structure? You will write a program to measure the numerical error of a finite-difference approximation as a function of grid resolution, establishing a concrete, error-based criterion for model configuration. ",
            "id": "3800508",
            "problem": "You are tasked with quantifying how grid resolution relative to the deformation radius $R_d$ impacts the numerical accuracy of trapped wave structures associated with planetary Rossby and Kelvin waves, and then proposing a minimal resolution criterion in terms of points per $R_d$. The computational base must derive from the linearized rotating shallow-water equations on either an $f$-plane or $\\beta$-plane and the known trapped eigenfunctions for coastal and equatorial waveguides.\n\nFundamental base and definitions to use:\n- The deformation radius $R_d$ is defined by $R_d = \\sqrt{g H} / |f|$ on an $f$-plane, where $g$ is gravitational acceleration, $H$ is the layer depth, and $f$ is the Coriolis parameter; it sets the cross-waveguide trapping scale for coastal Kelvin waves. For equatorial waveguides on a $\\beta$-plane, the meridional trapping scale is $L_e = \\sqrt{c / \\beta}$ with gravity wave speed $c = \\sqrt{g H}$ and $\\beta = \\partial f / \\partial y$. In this problem, treat the symbol $R_d$ as the trapping scale to be used for both coastal and equatorial meridional structures.\n- Coastal Kelvin wave meridional structure on a straight coast ($y \\ge 0$) can be represented by the cross-shore amplitude $\\phi_K(y) = \\exp(-y / R_d)$.\n- Equatorial trapped modes have meridional structures proportional to Gaussian functions and Hermite functions. Use the following canonical forms:\n  1. Equatorial Kelvin wave: $\\phi_{EK}(y) = \\exp\\left(-\\dfrac{y^2}{2 R_d^2}\\right)$.\n  2. First equatorial Rossby mode ($n = 1$): $\\phi_{ER1}(y) = 2 \\dfrac{y}{R_d} \\exp\\left(-\\dfrac{y^2}{2 R_d^2}\\right)$.\n\nObjective:\n- For each trapped structure $\\phi(y)$, discretize the meridional coordinate $y \\in [0, L]$ on a uniform grid with spacing $\\Delta y = R_d / p$, where $p$ is the number of grid points per $R_d$, and domain length $L = N_{R_d} R_d$ with integer $N_{R_d}$. All lengths must be handled in meters.\n- Using the centered second-order finite difference operator, approximate the meridional derivative:\n  $$D_{\\Delta y} \\phi(y_i) = \\dfrac{\\phi(y_{i+1}) - \\phi(y_{i-1})}{2 \\Delta y},$$\n  at interior grid points $y_i$ for $i = 1, \\dots, N-2$, where $N$ is the number of grid points.\n- Compute the analytical meridional derivative $\\dfrac{d \\phi}{d y}$ for each structure and evaluate the relative discrete $L^2$ error of the numerical derivative approximation:\n  $$E = \\dfrac{\\left( \\int_{0}^{L} \\left[ D_{\\Delta y} \\phi(y) - \\dfrac{d \\phi}{d y}(y) \\right]^2 \\, dy \\right)^{1/2}}{\\left( \\int_{0}^{L} \\left[ \\dfrac{d \\phi}{d y}(y) \\right]^2 \\, dy \\right)^{1/2}}.$$\n  Approximate the integrals with Riemann sums over the interior grid points and use $\\Delta y$ as the quadrature weight. Angles are not used in this problem, so no angle unit specification is needed.\n- For a given tolerance $\\varepsilon$ (expressed as a decimal), determine the minimal integer $p$ such that $E \\le \\varepsilon$. If no tested value satisfies the tolerance, return $-1$.\n\nTest suite:\n- Case $1$: Coastal Kelvin wave, $R_d = 50000$ meters, $N_{R_d} = 5$, tolerance $\\varepsilon = 0.05$.\n- Case $2$: Equatorial Kelvin wave, $R_d = 150000$ meters, $N_{R_d} = 6$, tolerance $\\varepsilon = 0.02$.\n- Case $3$: First equatorial Rossby mode, $R_d = 150000$ meters, $N_{R_d} = 6$, tolerance $\\varepsilon = 0.03$.\n- Case $4$: Coastal Kelvin wave, $R_d = 30000$ meters, $N_{R_d} = 3$, tolerance $\\varepsilon = 0.01$.\n- Case $5$: Equatorial Kelvin wave, $R_d = 100000$ meters, $N_{R_d} = 2$, tolerance $\\varepsilon = 0.08$.\n\nSearch $p$ over the candidate set $\\{2, 3, 4, 5, 6, 8, 10, 12, 16, 20, 24, 32, 40, 48, 64\\}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the minimal points-per-$R_d$ values for the five test cases as a comma-separated list enclosed in square brackets, for example, $[p_1,p_2,p_3,p_4,p_5]$, where each $p_i$ is an integer or $-1$ if the criterion is not met by any candidate.\n\nAll lengths must be in meters. The tolerance $\\varepsilon$ must be treated as a decimal.",
            "solution": "The problem is deemed valid. It is scientifically grounded in the principles of geophysical fluid dynamics and numerical analysis, specifically concerning the discretization of wave equations. The problem is well-posed, with all necessary functions, parameters, and evaluation criteria explicitly defined, allowing for a unique and verifiable solution. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe core task is to determine the minimum required grid resolution, quantified by the number of grid points per deformation radius ($p$), to accurately represent the meridional structure of oceanic trapped waves using a finite difference method. The accuracy is measured by the relative $L^2$ error of the numerically computed first derivative compared to the analytical derivative, which must be below a specified tolerance $\\varepsilon$.\n\nThe methodology proceeds as follows for each test case:\n1.  **Define Analytical Structures**: The problem specifies three canonical meridional structures, $\\phi(y)$, and their analytical first derivatives, $\\dfrac{d\\phi}{dy}$.\n    *   For the Coastal Kelvin wave:\n        $$ \\phi_K(y) = \\exp(-y / R_d) $$\n        $$ \\dfrac{d\\phi_K}{dy} = -\\dfrac{1}{R_d} \\exp(-y / R_d) $$\n    *   For the Equatorial Kelvin wave:\n        $$ \\phi_{EK}(y) = \\exp\\left(-\\dfrac{y^2}{2 R_d^2}\\right) $$\n        $$ \\dfrac{d\\phi_{EK}}{dy} = -\\dfrac{y}{R_d^2} \\exp\\left(-\\dfrac{y^2}{2 R_d^2}\\right) $$\n    *   For the first Equatorial Rossby mode ($n=1$):\n        $$ \\phi_{ER1}(y) = 2 \\dfrac{y}{R_d} \\exp\\left(-\\dfrac{y^2}{2 R_d^2}\\right) $$\n        $$ \\dfrac{d\\phi_{ER1}}{dy} = \\dfrac{2}{R_d} \\left(1 - \\dfrac{y^2}{R_d^2}\\right) \\exp\\left(-\\dfrac{y^2}{2 R_d^2}\\right) $$\n    In these equations, $y$ is the meridional coordinate and $R_d$ is the relevant trapping scale (deformation radius).\n\n2.  **Establish the Numerical Grid**: The continuous domain $y \\in [0, L]$ is discretized into a uniform grid. The domain length is $L = N_{R_d} R_d$, where $N_{R_d}$ is a specified integer multiplier. The grid spacing is $\\Delta y = R_d / p$, where $p$ is the number of points per $R_d$. The total number of grid points is $N = N_{R_d} p + 1$. The grid points are located at $y_i = i \\cdot \\Delta y$ for $i = 0, 1, \\dots, N-1$.\n\n3.  **Approximate the Derivative**: The first derivative is approximated using a second-order centered finite difference scheme at the interior grid points $y_i$ for $i = 1, \\dots, N-2$:\n    $$ D_{\\Delta y} \\phi(y_i) = \\dfrac{\\phi(y_{i+1}) - \\phi(y_{i-1})}{2 \\Delta y} $$\n    This formula provides a numerical approximation to $\\dfrac{d\\phi}{dy}$ at each interior point $y_i$.\n\n4.  **Compute the Discretized Error**: The relative $L^2$ error, $E$, is calculated. The integrals in the definition of $E$ are approximated using Riemann sums over the set of interior grid points $\\{y_i\\}_{i=1}^{N-2}$.\n    $$ E = \\dfrac{\\left( \\sum_{i=1}^{N-2} \\left[ D_{\\Delta y} \\phi(y_i) - \\dfrac{d \\phi}{d y}(y_i) \\right]^2 \\Delta y \\right)^{1/2}}{\\left( \\sum_{i=1}^{N-2} \\left[ \\dfrac{d \\phi}{d y}(y_i) \\right]^2 \\Delta y \\right)^{1/2}} $$\n    The quadrature weight $\\Delta y$ is common to both the numerator and denominator and thus cancels. The expression simplifies to the ratio of vector norms:\n    $$ E = \\dfrac{\\left\\| \\mathbf{D}_{\\text{num}} - \\mathbf{D}_{\\text{ana}} \\right\\|_2}{\\left\\| \\mathbf{D}_{\\text{ana}} \\right\\|_2} $$\n    where $\\mathbf{D}_{\\text{num}}$ is the vector of numerical derivative values at the interior points, $\\mathbf{D}_{\\text{ana}}$ is the vector of analytical derivative values at the same points, and $\\| \\cdot \\|_2$ denotes the Euclidean norm.\n\n5.  **Determine Minimal Resolution**: For each test case, we iterate through the ordered candidate set for $p$, which is $\\{2, 3, 4, 5, 6, 8, 10, 12, 16, 20, 24, 32, 40, 48, 64\\}$. For each value of $p$, the error $E$ is calculated. The first value of $p$ in the set for which $E \\le \\varepsilon$ is the minimal required resolution for that case. If no value of $p$ in the set satisfies the criterion, the result for that case is $-1$.\n\nThis procedure is systematically applied to each of the five test cases provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimal grid resolution (points per deformation radius)\n    for accurately representing oceanic wave structures.\n    \"\"\"\n\n    # --- Analytical Wave Structures and Their Derivatives ---\n\n    def phi_coastal_kelvin(y, Rd):\n        \"\"\"Meridional structure of a Coastal Kelvin wave.\"\"\"\n        return np.exp(-y / Rd)\n\n    def d_phi_coastal_kelvin(y, Rd):\n        \"\"\"Analytical derivative of the Coastal Kelvin wave structure.\"\"\"\n        return (-1 / Rd) * np.exp(-y / Rd)\n\n    def phi_equatorial_kelvin(y, Rd):\n        \"\"\"Meridional structure of an Equatorial Kelvin wave.\"\"\"\n        return np.exp(-y**2 / (2 * Rd**2))\n\n    def d_phi_equatorial_kelvin(y, Rd):\n        \"\"\"Analytical derivative of the Equatorial Kelvin wave structure.\"\"\"\n        return (-y / Rd**2) * np.exp(-y**2 / (2 * Rd**2))\n\n    def phi_equatorial_rossby1(y, Rd):\n        \"\"\"Meridional structure of the first Equatorial Rossby mode.\"\"\"\n        return 2 * (y / Rd) * np.exp(-y**2 / (2 * Rd**2))\n\n    def d_phi_equatorial_rossby1(y, Rd):\n        \"\"\"Analytical derivative of the first Equatorial Rossby mode structure.\"\"\"\n        term1 = 2 / Rd\n        term2 = 1 - y**2 / Rd**2\n        term3 = np.exp(-y**2 / (2 * Rd**2))\n        return term1 * term2 * term3\n\n    # Dictionary to map wave types to their respective functions\n    wave_functions = {\n        'Coastal Kelvin': {'phi': phi_coastal_kelvin, 'd_phi': d_phi_coastal_kelvin},\n        'Equatorial Kelvin': {'phi': phi_equatorial_kelvin, 'd_phi': d_phi_equatorial_kelvin},\n        'First equatorial Rossby': {'phi': phi_equatorial_rossby1, 'd_phi': d_phi_equatorial_rossby1}\n    }\n\n    # --- Problem Parameters ---\n\n    # Candidate set for p (points per deformation radius)\n    p_candidates = [2, 3, 4, 5, 6, 8, 10, 12, 16, 20, 24, 32, 40, 48, 64]\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (wave_type, Rd_meters, N_Rd, epsilon_tolerance)\n        ('Coastal Kelvin', 50000.0, 5, 0.05),\n        ('Equatorial Kelvin', 150000.0, 6, 0.02),\n        ('First equatorial Rossby', 150000.0, 6, 0.03),\n        ('Coastal Kelvin', 30000.0, 3, 0.01),\n        ('Equatorial Kelvin', 100000.0, 2, 0.08)\n    ]\n\n    results = []\n    for case in test_cases:\n        wave_type, Rd, N_Rd, epsilon = case\n        \n        phi_func = wave_functions[wave_type]['phi']\n        d_phi_func = wave_functions[wave_type]['d_phi']\n        \n        minimal_p = -1\n        \n        # Iterate through the ordered candidate set to find the minimal p\n        for p in p_candidates:\n            # 1. Set up the numerical grid\n            domain_length_L = N_Rd * Rd\n            delta_y = Rd / p\n            # Total number of points is N_Rd*p intervals + 1\n            num_points_N = N_Rd * p + 1\n            \n            # The centered difference scheme requires at least 3 points\n            if num_points_N  3:\n                continue\n\n            y_grid = np.linspace(0.0, domain_length_L, num_points_N)\n            \n            # 2. Evaluate functions and derivatives on the grid\n            \n            # The calculation is performed on interior points\n            y_interior = y_grid[1:-1]\n            \n            # Analytical derivative on interior points\n            d_phi_analytical = d_phi_func(y_interior, Rd)\n            \n            # Numerical derivative using centered second-order finite difference\n            phi_on_grid = phi_func(y_grid, Rd)\n            # D(y_i) = (phi(y_{i+1}) - phi(y_{i-1})) / (2 * dy)\n            d_phi_numerical = (phi_on_grid[2:] - phi_on_grid[:-2]) / (2 * delta_y)\n\n            # 3. Compute the relative L2 error\n            \n            # The problem's error metric simplifies to the ratio of vector norms\n            # because the integration weight (delta_y) cancels out.\n            norm_of_error_vector = np.linalg.norm(d_phi_numerical - d_phi_analytical)\n            norm_of_analytical_derivative = np.linalg.norm(d_phi_analytical)\n            \n            if norm_of_analytical_derivative == 0:\n                # Handle the case where the analytical derivative is zero everywhere on the domain.\n                # The error is 0 if the numerical is also 0, otherwise it's undefined (infinite).\n                # This is not expected for the given wave functions and domains.\n                error = 0.0 if norm_of_error_vector == 0.0 else np.inf\n            else:\n                error = norm_of_error_vector / norm_of_analytical_derivative\n            \n            # 4. Check if the error meets the tolerance\n            if error = epsilon:\n                minimal_p = p\n                break  # Found the first (and thus minimal) p that satisfies the criterion\n            \n        results.append(minimal_p)\n\n    # Format and print the final output as a single-line string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice integrates the concepts of wave theory and numerical analysis into a complete numerical experiment, a workflow central to computational oceanography. You will simulate the evolution of a Rossby wave packet governed by the quasi-geostrophic potential vorticity equation. The main task is to analyze the simulation output using wavenumber–frequency spectral diagnostics to measure the packet's group velocity and validate this numerical result against the analytical prediction derived from the dispersion relation. ",
            "id": "3800483",
            "problem": "You are to design and implement a numerical experiment that launches a planetary-scale Rossby wave packet on a midlatitude beta-plane and measures the zonal group velocity using wavenumber–frequency diagnostics. The mathematical and computational starting point must be the linear quasi-geostrophic potential vorticity equation on a beta-plane. Assume a baroclinic deformation radius $R_d$ is finite and constant, and use geostrophic streamfunction $\\psi(x,y,t)$ as the prognostic variable for the wave packet. All physical quantities must be expressed in International System of Units (SI), with lengths in meters and times in seconds.\n\nFundamental base and governing equation:\n- Begin from the quasi-geostrophic potential vorticity $q(x,y,t)$ defined by $q = \\nabla^2 \\psi - \\psi / R_d^2$, where $\\nabla^2$ is the two-dimensional Laplacian in a Cartesian coordinate system with $x$ as zonal distance and $y$ as meridional distance.\n- On a beta-plane at latitude $\\varphi_0$, the linear evolution of $q$ is governed by $q_t + \\beta \\psi_x = 0$, where $\\beta = \\left. \\frac{\\partial f}{\\partial y} \\right|_{\\varphi_0}$ is the meridional gradient of the Coriolis parameter $f$; the subscript denotes partial differentiation.\n- The experiment must excite a localized, small-amplitude wave packet centered at $(x_0,y_0)$ with a Gaussian envelope and a monochromatic carrier in both $x$ and $y$ directions, i.e., initialize $\\psi(x,y,0)$ as a real-valued Gaussian envelope multiplied by a cosine carrier with specified zonal and meridional wavenumbers.\n\nWavenumber–frequency diagnostics:\n- Construct a one-dimensional space–time dataset $s(x,t)$ by sampling $\\psi(x,y,t)$ along a fixed meridional transect at $y=y_0$ over a finite time interval $t \\in [0,T]$.\n- Compute the two-dimensional discrete Fourier transform in $(x,t)$ to obtain spectral power as a function of zonal wavenumber $k_x$ and temporal frequency $\\omega$.\n- Identify the dominant frequency for three neighboring discrete zonal wavenumbers around the packet’s carrier wavenumber, and estimate the zonal group velocity $c_{gx}$ in meters per second as a finite-difference slope $c_{gx} \\approx \\Delta \\omega / \\Delta k_x$ based on the ridge of maximal spectral power.\n\nAnalytical prediction:\n- Starting from the governing equation stated above, derive the dispersion relation for plane-wave solutions and then derive an analytical expression for the zonal group velocity $c_{gx}(k_x,k_y)$ as the appropriate partial derivative of frequency with respect to zonal wavenumber. Use this analytical $c_{gx}$ to predict the group velocity at the packet’s carrier $(k_0,l_0)$.\n- The program must compare the measured $c_{gx}$ against the analytical $c_{gx}$ at $(k_0,l_0)$ and return the absolute error in meters per second.\n\nNumerical requirements:\n- Use a doubly periodic rectangular domain with lengths $L_x$ and $L_y$, and uniform grids of $N_x$ and $N_y$ points, respectively. Use a uniform time step $\\Delta t$ and $N_t$ steps covering $T=N_t \\Delta t$.\n- Evolve $\\psi$ spectrally in time by integrating the linear dynamics implied by the stated governing equation. You may use exact spectral phase evolution implied by the linear operator, or a sufficiently accurate time integrator for the linear ordinary differential equation in spectral space. Ensure numerical parameters are chosen to resolve the packet and its spectral ridge in $(k_x,\\omega)$.\n- For spectral diagnostics, apply separable tapering windows in both $x$ and $t$ prior to the discrete Fourier transform to minimize leakage. Use Hann windows or equivalent tapering functions.\n\nUnits and outputs:\n- All inputs and outputs must use SI units. Express the final group velocity in meters per second.\n- Your program must produce a single line of output containing the absolute errors for the test suite as a comma-separated list enclosed in square brackets, where each entry is rounded to six decimal places (e.g., \"[0.123456,0.000001,0.010203]\").\n\nTest suite:\nImplement the following three parameter sets to ensure coverage across typical, boundary, and sign-change scenarios. For each case, use a Gaussian envelope width $\\sigma=1.0\\times 10^6$ meters and packet center $(x_0,y_0)=(L_x/2,L_y/2)$. Use amplitude $A=1.0\\times 10^5$ square meters per second for the initial streamfunction.\n\n- Case 1 (typical midlatitude packet):\n    - $L_x = 1.0\\times 10^7$ meters, $L_y = 8.0\\times 10^6$ meters, $N_x=256$, $N_y=128$.\n    - $\\Delta t = 2.16\\times 10^4$ seconds, $N_t = 240$.\n    - $\\beta = 2.0\\times 10^{-11}$ per meter per second, $R_d = 2.0\\times 10^6$ meters.\n    - Carrier wavenumbers: $k_0 = 2\\pi / (3.0\\times 10^6)$ radians per meter, $l_0 = 0.0$ radians per meter.\n\n- Case 2 (anisotropic packet with westward carrier):\n    - $L_x = 1.0\\times 10^7$ meters, $L_y = 8.0\\times 10^6$ meters, $N_x=256$, $N_y=128$.\n    - $\\Delta t = 2.16\\times 10^4$ seconds, $N_t = 240$.\n    - $\\beta = 2.0\\times 10^{-11}$ per meter per second, $R_d = 1.5\\times 10^6$ meters.\n    - Carrier wavenumbers: $k_0 = -2\\pi / (4.0\\times 10^6)$ radians per meter, $l_0 = 2\\pi / (6.0\\times 10^6)$ radians per meter.\n\n- Case 3 (nearly barotropic long-wave limit):\n    - $L_x = 1.0\\times 10^7$ meters, $L_y = 8.0\\times 10^6$ meters, $N_x=256$, $N_y=128$.\n    - $\\Delta t = 2.16\\times 10^4$ seconds, $N_t = 240$.\n    - $\\beta = 2.0\\times 10^{-11}$ per meter per second, $R_d = 1.0\\times 10^9$ meters.\n    - Carrier wavenumbers: $k_0 = 2\\pi / (8.0\\times 10^6)$ radians per meter, $l_0 = 2\\pi / (8.0\\times 10^6)$ radians per meter.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, with each entry being the absolute error between measured and analytical zonal group velocity in meters per second, rounded to six decimal places, in the order of the cases listed above (i.e., \"[error_case1,error_case2,error_case3]\").",
            "solution": "The problem requires the design of a numerical experiment to measure the zonal group velocity of a planetary Rossby wave packet and compare it to the analytical prediction. The process involves three main stages: deriving the analytical solution, performing a numerical simulation, and analyzing the simulation output to measure the group velocity.\n\n### **1. Analytical Derivation**\n\nThe governing physics are described by the linear quasi-geostrophic potential vorticity (QGPV) equation on a beta-plane. The potential vorticity $q$ is related to the streamfunction $\\psi(x,y,t)$ by:\n$$q(x,y,t) = \\nabla^2 \\psi - \\frac{1}{R_d^2} \\psi$$\nwhere $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the Laplacian operator and $R_d$ is the baroclinic deformation radius. The linear evolution of $q$ is given by:\n$$\\frac{\\partial q}{\\partial t} + \\beta \\frac{\\partial \\psi}{\\partial x} = 0$$\nwhere $\\beta$ is the constant meridional gradient of the Coriolis parameter.\n\nTo find the dispersion relation for plane waves, we substitute the QGPV definition into the evolution equation:\n$$\\frac{\\partial}{\\partial t} \\left(\\nabla^2 \\psi - \\frac{1}{R_d^2} \\psi\\right) + \\beta \\frac{\\partial \\psi}{\\partial x} = 0$$\nWe seek plane-wave solutions of the form $\\psi(x,y,t) = \\hat{\\psi} e^{i(k_x x + k_y y - \\omega t)}$, where $\\hat{\\psi}$ is the constant amplitude, $k_x$ and $k_y$ are the zonal and meridional wavenumbers, and $\\omega$ is the temporal frequency. Substituting this into the equation yields:\n$$-i\\omega \\left( -(k_x^2 + k_y^2) - \\frac{1}{R_d^2} \\right) \\hat{\\psi} e^{i(\\dots)} + \\beta (ik_x) \\hat{\\psi} e^{i(\\dots)} = 0$$\nDividing by $i\\hat{\\psi}e^{i(\\dots)}$ (assuming a non-trivial solution) gives:\n$$\\omega \\left( k_x^2 + k_y^2 + \\frac{1}{R_d^2} \\right) + \\beta k_x = 0$$\nSolving for $\\omega$ gives the dispersion relation for Rossby waves:\n$$\\omega(k_x, k_y) = - \\frac{\\beta k_x}{k_x^2 + k_y^2 + R_d^{-2}}$$\n\nThe zonal group velocity, $c_{gx}$, is the partial derivative of the frequency with respect to the zonal wavenumber:\n$$c_{gx}(k_x, k_y) = \\frac{\\partial \\omega}{\\partial k_x}$$\nUsing the quotient rule for differentiation on the expression for $\\omega(k_x, k_y)$:\n$$c_{gx} = \\frac{(-\\beta)(k_x^2 + k_y^2 + R_d^{-2}) - (-\\beta k_x)(2k_x)}{(k_x^2 + k_y^2 + R_d^{-2})^2}$$\nSimplifying the numerator, we obtain the analytical expression for the zonal group velocity:\n$$c_{gx}(k_x, k_y) = \\frac{\\beta (k_x^2 - k_y^2 - R_d^{-2})}{(k_x^2 + k_y^2 + R_d^{-2})^2}$$\nThis expression will be used to calculate the predicted group velocity for each test case at its carrier wavenumbers $(k_0, l_0)$.\n\n### **2. Numerical Simulation Design**\n\nThe simulation evolves the initial wave packet forward in time. A spectral method is employed for its accuracy and efficiency in solving linear, constant-coefficient partial differential equations on periodic domains.\n\n#### **2.1. Time Evolution in Spectral Space**\nThe governing equation in Fourier (wavenumber) space is an ordinary differential equation (ODE) for the Fourier transform of the streamfunction, $\\hat{\\psi}(k_x, k_y, t)$. Transforming the governing PDE gives:\n$$\\frac{d\\hat{\\psi}}{dt} = -i\\omega(k_x, k_y)\\hat{\\psi}$$\nwhere $\\omega(k_x, k_y)$ is the frequency derived previously. This linear ODE has the exact solution:\n$$\\hat{\\psi}(k_x, k_y, t) = \\hat{\\psi}(k_x, k_y, 0) e^{-i\\omega(k_x, k_y) t}$$\nThe numerical algorithm thus consists of:\n1.  Defining an initial condition $\\psi(x, y, 0)$ in physical space.\n2.  Computing its $2$D Fast Fourier Transform (FFT) to get $\\hat{\\psi}(k_x, k_y, 0)$.\n3.  For each desired time $t$, calculating $\\hat{\\psi}(k_x, k_y, t)$ using the exact phase evolution formula above.\n4.  Applying an inverse $2$D FFT to obtain the physical space solution $\\psi(x, y, t)$.\n\n#### **2.2. Initial Condition**\nThe initial streamfunction $\\psi(x,y,0)$ is a Gaussian-modulated wave packet centered at $(x_0, y_0)=(L_x/2, L_y/2)$:\n$$\\psi(x,y,0) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{2\\sigma^2}\\right) \\cos(k_0 (x-x_0) + l_0(y-y_0))$$\nwhere $A$ is the amplitude, $\\sigma$ is the envelope width, and $(k_0,l_0)$ are the carrier wavenumbers.\n\n### **3. Wavenumber–Frequency Diagnostics**\n\nThe zonal group velocity is measured from the simulation output using spectral analysis.\n\n1.  **Data Collection**: A one-dimensional space-time dataset $s(x,t) = \\psi(x, y_0, t)$ is created by recording the streamfunction along the central zonal transect $y=y_0$ at each time step.\n2.  **Windowing**: To mitigate spectral leakage from the finite duration and length of the dataset, a $2$D Hann window is applied to $s(x,t)$. The window is separable, formed by the outer product of two $1$D Hann windows, one for the time dimension and one for the spatial dimension.\n3.  **Spectral Analysis**: The $2$D FFT of the windowed dataset $s(x,t)$ is computed to get the complex spectrum $S(k_x, \\omega)$. The power spectrum is then $P(k_x, \\omega) = |S(k_x, \\omega)|^2$.\n4.  **Group Velocity Estimation**: The group velocity is the slope of the ridge of maximum power in the $(k_x, \\omega)$ plane. To estimate this slope, we identify the discrete zonal wavenumber $k_{d0}$ closest to the carrier wavenumber $k_0$. We then find the frequencies, $\\omega_{-1}$ and $\\omega_{+1}$, corresponding to the maximum spectral power at the neighboring discrete wavenumbers $k_{d0} - \\Delta k_x$ and $k_{d0} + \\Delta k_x$, where $\\Delta k_x$ is the zonal wavenumber grid spacing. The numerical group velocity is estimated using a centered finite-difference approximation:\n$$c_{gx, \\text{measured}} \\approx \\frac{\\omega_{+1} - \\omega_{-1}}{(k_{d0} + \\Delta k_x) - (k_{d0} - \\Delta k_x)} = \\frac{\\omega_{+1} - \\omega_{-1}}{2\\Delta k_x}$$\n\nFinally, the absolute error is calculated as $|c_{gx, \\text{measured}} - c_{gx, \\text{analytical}}|$. This entire procedure is implemented for each of the three test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        { # Case 1\n            \"Lx\": 1.0e7, \"Ly\": 8.0e6, \"Nx\": 256, \"Ny\": 128,\n            \"dt\": 2.16e4, \"Nt\": 240,\n            \"beta\": 2.0e-11, \"Rd\": 2.0e6,\n            \"k0\": 2 * np.pi / (3.0e6), \"l0\": 0.0,\n            \"A\": 1.0e5, \"sigma\": 1.0e6\n        },\n        { # Case 2\n            \"Lx\": 1.0e7, \"Ly\": 8.0e6, \"Nx\": 256, \"Ny\": 128,\n            \"dt\": 2.16e4, \"Nt\": 240,\n            \"beta\": 2.0e-11, \"Rd\": 1.5e6,\n            \"k0\": -2 * np.pi / (4.0e6), \"l0\": 2 * np.pi / (6.0e6),\n            \"A\": 1.0e5, \"sigma\": 1.0e6\n        },\n        { # Case 3\n            \"Lx\": 1.0e7, \"Ly\": 8.0e6, \"Nx\": 256, \"Ny\": 128,\n            \"dt\": 2.16e4, \"Nt\": 240,\n            \"beta\": 2.0e-11, \"Rd\": 1.0e9,\n            \"k0\": 2 * np.pi / (8.0e6), \"l0\": 2 * np.pi / (8.0e6),\n            \"A\": 1.0e5, \"sigma\": 1.0e6\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        error = run_and_analyze_case(case_params)\n        results.append(f\"{error:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef run_and_analyze_case(params):\n    \"\"\"\n    Runs the simulation and analysis for a single test case.\n    \"\"\"\n    # Unpack parameters\n    Lx, Ly, Nx, Ny = params[\"Lx\"], params[\"Ly\"], params[\"Nx\"], params[\"Ny\"]\n    dt, Nt = params[\"dt\"], params[\"Nt\"]\n    beta, Rd = params[\"beta\"], params[\"Rd\"]\n    k0, l0 = params[\"k0\"], params[\"l0\"]\n    A, sigma = params[\"A\"], params[\"sigma\"]\n\n    x0, y0 = Lx / 2.0, Ly / 2.0\n\n    # 1. Analytical Group Velocity\n    def analytical_cgx(k_x, k_y, b, R_d):\n        k_sq = k_x**2 + k_y**2\n        R_d_inv_sq = 1.0 / R_d**2\n        denom_term = k_sq + R_d_inv_sq\n        \n        num = b * (k_x**2 - k_y**2 - R_d_inv_sq)\n        den = denom_term**2\n        return num / den\n\n    cgx_analytical = analytical_cgx(k0, l0, beta, Rd)\n\n    # 2. Numerical Simulation\n    # Spatial grids and wavenumbers\n    dx, dy = Lx / Nx, Ly / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    xx, yy = np.meshgrid(x, y)\n\n    kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n    ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n    kx, ky = np.meshgrid(kx_vec, ky_vec)\n\n    # Initial condition\n    psi0 = A * np.exp(-((xx - x0)**2 + (yy - y0)**2) / (2 * sigma**2)) * \\\n           np.cos(k0 * (xx - x0) + l0 * (yy - y0))\n           \n    # Time evolution using exact spectral solution\n    psi0_hat = np.fft.fft2(psi0)\n    \n    # Dispersion relation omega(kx, ky)\n    K_sq = kx**2 + ky**2\n    denom_omega = K_sq + 1.0/Rd**2\n    omega = np.zeros_like(denom_omega, dtype=float)\n    mask = (denom_omega != 0)\n    omega[mask] = -beta * kx[mask] / denom_omega[mask]\n\n    # Store transect data s(x,t)\n    y_idx_center = Ny // 2\n    s_xt = np.zeros((Nt, Nx), dtype=float)\n    t_vec = np.arange(Nt) * dt\n\n    for i, t in enumerate(t_vec):\n        psi_hat_t = psi0_hat * np.exp(-1j * omega * t)\n        psi_t = np.fft.ifft2(psi_hat_t)\n        s_xt[i, :] = np.real(psi_t[y_idx_center, :])\n        \n    # 3. Wavenumber-Frequency Diagnostics\n    # Apply Hann window\n    window_t = np.hanning(Nt)\n    window_x = np.hanning(Nx)\n    window_2d = window_t[:, np.newaxis] * window_x[np.newaxis, :]\n    s_xt_windowed = s_xt * window_2d\n    \n    # 2D FFT and power spectrum\n    S_kw = np.fft.fftshift(np.fft.fft2(s_xt_windowed))\n    power_spectrum = np.abs(S_kw)**2\n    \n    # Diagnostic wavenumber and frequency axes\n    k_diag_vec = 2 * np.pi * np.fft.fftshift(np.fft.fftfreq(Nx, d=dx))\n    om_diag_vec = 2 * np.pi * np.fft.fftshift(np.fft.fftfreq(Nt, d=dt))\n    \n    # Find indices and wavenumbers for finite difference\n    idx_k0_carrier = np.argmin(np.abs(k_diag_vec - k0))\n    idx_k_minus = idx_k0_carrier - 1\n    idx_k_plus = idx_k0_carrier + 1\n    \n    # Find peak frequencies at neighboring wavenumbers\n    idx_w_minus = np.argmax(power_spectrum[:, idx_k_minus])\n    idx_w_plus = np.argmax(power_spectrum[:, idx_k_plus])\n    \n    k_minus = k_diag_vec[idx_k_minus]\n    k_plus = k_diag_vec[idx_k_plus]\n    w_minus = om_diag_vec[idx_w_minus]\n    w_plus = om_diag_vec[idx_w_plus]\n    \n    # Measured group velocity using centered difference\n    dk = k_plus - k_minus\n    dw = w_plus - w_minus\n    cgx_measured = dw / dk if dk != 0 else 0.0\n        \n    # 4. Absolute Error\n    error = np.abs(cgx_measured - cgx_analytical)\n    return error\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}