{
    "hands_on_practices": [
        {
            "introduction": "在我们将运动分解为正压和斜压模态之前，必须首先对允许这些模态存在的海洋环境进行刻画。本练习专注于计算浮力频率（$N^2$），这是一个衡量海洋层结强度并决定内波行为的基本物理量。通过从温度和盐度剖面推导$N^2$，你将亲身体验作为垂直模态分解基础的物理原理和数值技术。",
            "id": "3799111",
            "problem": "给定一个海洋水柱的离散温度和盐度垂直剖面，它们是深度的函数。目标是使用物理上一致的海水状态方程，在Boussinesq和静水力近似下，计算浮力频率的平方 $N^2(z)$，然后准备一个光滑、非负的函数 $N^2(z)$，以适用于正压和斜压运动的垂直模态分解。推导必须从第一性原理开始，程序必须相应地实现该算法。\n\n假设使用以下广泛应用的近似：\n- Boussinesq近似，其中参考密度 $\\rho_0$ 为常数。\n- 静水力平衡和小振幅扰动，由此导出线性稳定性度量 $N^2$。\n- 线性化海水状态方程：$\\rho(T,S) = \\rho_0 \\left(1 - \\alpha \\left(T - T_\\mathrm{ref}\\right) + \\beta \\left(S - S_\\mathrm{ref}\\right)\\right)$，其中 $\\alpha$ 是热膨胀系数，$\\beta$ 是盐收缩系数，$T$ 是以摄氏度为单位的位温，$S$ 是以无量纲实用盐度单位（PSU）计量的实用盐度。参考值 $T_\\mathrm{ref}$ 和 $S_\\mathrm{ref}$ 是常数，在垂直微分中被抵消，不影响 $N^2$。\n\n使用以下标准常数：\n- 重力加速度 $g = 9.81$，单位为 $\\mathrm{m\\,s^{-2}}$。\n- 热膨胀系数 $\\alpha = 2.0 \\times 10^{-4}$，单位为 $\\mathrm{K^{-1}}$。\n- 盐收缩系数 $\\beta = 7.6 \\times 10^{-4}$，单位为 $\\mathrm{(PSU)^{-1}}$。\n- 参考密度 $\\rho_0$ 是常数（其确切数值在下面的 $N^2$ 线性化公式中被抵消，在数值计算中不需要）。\n\n设深度 $d$ 以米为单位，向下为正，在自由表面处 $d = 0$。设 $T(d)$ 和 $S(d)$ 是在跨度为 $[0,1000]$ 米的离散网格 $\\{d_i\\}_{i=0}^{N-1}$ 上采样的给定剖面。从第一性原理出发，使用指向上方的垂直坐标 $z$ 定义的浮力频率平方为\n$$\nN^2(z) = -\\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial z}.\n$$\n当深度坐标 $d$ 向下为正时，根据链式法则可得\n$$\n\\frac{\\partial}{\\partial z} = -\\frac{\\partial}{\\partial d},\n$$\n并使用线性化的海水状态方程，密度相对于深度的垂直导数为\n$$\n\\frac{\\partial \\rho}{\\partial d} = \\rho_0\\left(-\\alpha\\, \\frac{\\partial T}{\\partial d} + \\beta\\, \\frac{\\partial S}{\\partial d}\\right).\n$$\n因此，\n$$\nN^2(d) = \\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial d} = g\\left(\\beta\\, \\frac{\\partial S}{\\partial d} - \\alpha\\, \\frac{\\partial T}{\\partial d}\\right).\n$$\n\n为将 $N^2(d)$ 准备成一个适用于垂直模态分解的函数，算法要求如下：\n1. 在给定的深度网格上，使用一致的有限差分方法计算离散垂直梯度 $\\frac{\\partial T}{\\partial d}$ 和 $\\frac{\\partial S}{\\partial d}$，该方法在内部为二阶精度，在边界为单边。\n2. 通过线性化公式 $N^2(d) = g\\left(\\beta\\, \\frac{\\partial S}{\\partial d} - \\alpha\\, \\frac{\\partial T}{\\partial d}\\right)$ 计算 $N^2(d)$，单位为 $\\mathrm{s^{-2}}$。\n3. 为满足Sturm–Liouville问题的适定性所要求的非负性，将 $N^2(d)$ 裁剪到一个最小下限值 $N^2_\\mathrm{min} = 10^{-6}$ $\\mathrm{s^{-2}}$，即，设置 $N^2(d) \\leftarrow \\max\\left(N^2(d), N^2_\\mathrm{min}\\right)$。\n4. 使用分段三次Hermite插值多项式（PCHIP）构建一个光滑、保形的插值函数 $\\widehat{N^2}(d)$，以便 $\\widehat{N^2}(d)$ 可以在垂直模态求解器所需的任意深度上进行求值，而不会产生过冲伪影。\n\n您的程序必须实现上述算法，并在多个测试用例中，在一组指定的查询深度上评估准备好的函数 $\\widehat{N^2}(d)$。所有输出都必须以 $\\mathrm{s^{-2}}$ 为单位，使用科学记数法表示，并至少保留六位小数。本问题不使用角度。最终输出必须是单行文本，包含所有测试用例的聚合结果，形式为逗号分隔的列表并用方括号括起，其中每个测试用例的结果本身也是一个逗号分隔的数值列表并用方括号括起，例如：$[[r_{1,1},r_{1,2}],[r_{2,1},r_{2,2}]]$，不含空格。\n\n测试套件（以物理上合理的形式提供所有 $T(d)$ 和 $S(d)$）：\n\n- 测试用例1（分层良好的温跃层）：\n  - 深度网格：$d_i \\in [0,1000]$ 米，共 $N = 501$ 个均匀间隔点。\n  - 温度：$T(d) = 20 - 15\\, \\tanh\\left(\\frac{d - 200}{150}\\right)$，单位为摄氏度。\n  - 盐度：$S(d) = 34.5 + 0.5\\, \\tanh\\left(\\frac{d - 300}{200}\\right)$，单位为PSU。\n  - 查询深度（单位：米）：$[0,100,250,500,1000]$。\n\n- 测试用例2（近乎未分层的水柱）：\n  - 深度网格：$d_i \\in [0,1000]$ 米，共 $N = 501$ 个均匀间隔点。\n  - 温度：$T(d) = 10$，单位为摄氏度。\n  - 盐度：$S(d) = 35$，单位为PSU。\n  - 查询深度（单位：米）：$[0,100,250,500,1000]$。\n\n- 测试用例3（具有小振荡的弱不稳定层，需要裁剪）：\n  - 深度网格：$d_i \\in [0,1000]$ 米，共 $N = 501$ 个均匀间隔点。\n  - 温度：$T(d) = 14 + 0.5\\, \\sin\\left(\\frac{2\\pi d}{120}\\right) - 11\\, \\frac{d}{1000}$，单位为摄氏度。\n  - 盐度：$S(d) = 34.8 + 0.2\\, \\cos\\left(\\frac{2\\pi d}{180}\\right) + 0.1\\, \\frac{d}{1000}$，单位为PSU。\n  - 查询深度（单位：米）：$[0,100,250,500,1000]$。\n\n您的程序应生成单行输出，其中包含结果，形式为用方括号括起来的逗号分隔列表，每个测试用例的结果是在指定查询深度处的 $\\widehat{N^2}(d)$ 值的逗号分隔列表（单位为 $\\mathrm{s^{-2}}$），采用科学记数法，至少有六位小数，并且没有任何空格。例如，格式必须是 $[[v_{1,1},v_{1,2},\\ldots,v_{1,5}],[v_{2,1},\\ldots,v_{2,5}],[v_{3,1},\\ldots,v_{3,5}]]$。",
            "solution": "该问题是有效的，因为它在科学上基于地球物理流体动力学的原理，是适定的，有清晰的算法路径可以得到唯一解，并且使用客观、正式的语言表述。我们继续进行解答。\n\n目标是根据位温 $T(d)$ 和盐度 $S(d)$ 的垂直剖面计算浮力频率的平方，记为 $N^2$，其中 $d$ 是深度，向下为正。这个量对于分析分层流体柱的稳定性以及将海洋运动分解为其垂直正压和斜压模态至关重要。该过程涉及从第一性原理推导 $N^2$，然后实现一个数值算法，以准备一个适合在数值模型中使用的光滑、非负的剖面。\n\n**基于原理的推导**\n\n浮力频率的平方 $N^2$ 量化了在分层介质中垂直位移的流体质点所受的恢复力。在稳定分层中，一个被位移的质点比其新环境的密度小（如果向上位移）或密度大（如果向下位移），这使其围绕其平衡位置振荡。$N$ 代表了这种振荡的频率。\n\n设垂直坐标 $z$ 指向上方，则 $N^2(z)$ 定义为：\n$$\nN^2(z) = - \\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial z}\n$$\n其中 $g$ 是重力加速度，$\\rho$ 是位密度，$\\rho_0$ 是一个与Boussinesq近似一致的常数参考密度。该近似假设密度变化与参考密度相比很小，除非与 $g$ 相乘。\n\n该问题使用一个向下为正的深度坐标 $d$，并在海面处 $d=0$。两个坐标之间的关系意味着 $\\partial/\\partial z = -\\partial/\\partial d$。将此代入 $N^2$ 的定义中得到：\n$$\nN^2(d) = \\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial d}\n$$\n\n位密度 $\\rho$ 是位温 $T$ 和盐度 $S$ 的函数。问题提供了一个线性化的状态方程：\n$$\n\\rho(T, S) = \\rho_0 \\left(1 - \\alpha (T - T_{\\mathrm{ref}}) + \\beta (S - S_{\\mathrm{ref}})\\right)\n$$\n这里，$\\alpha$ 是热膨胀系数，$\\beta$ 是盐收缩系数，$T_{\\mathrm{ref}}$ 和 $S_{\\mathrm{ref}}$ 是常数参考值。为了求得垂直密度梯度，我们使用链式法则对 $\\rho$ 关于深度 $d$ 求导：\n$$\n\\frac{\\partial \\rho}{\\partial d} = \\frac{\\partial \\rho}{\\partial T} \\frac{\\partial T}{\\partial d} + \\frac{\\partial \\rho}{\\partial S} \\frac{\\partial S}{\\partial d}\n$$\n从线性化状态方程可知，偏导数为 $\\partial \\rho / \\partial T = -\\rho_0 \\alpha$ 和 $\\partial \\rho / \\partial S = \\rho_0 \\beta$。代入这些可得：\n$$\n\\frac{\\partial \\rho}{\\partial d} = \\rho_0 \\left(-\\alpha \\frac{\\partial T}{\\partial d} + \\beta \\frac{\\partial S}{\\partial d}\\right)\n$$\n\n最后，将这个密度梯度的表达式代回 $N^2(d)$ 的公式中：\n$$\nN^2(d) = \\frac{g}{\\rho_0} \\left[ \\rho_0 \\left(-\\alpha \\frac{\\partial T}{\\partial d} + \\beta \\frac{\\partial S}{\\partial d}\\right) \\right]\n$$\n参考密度 $\\rho_0$ 被抵消，得到最终的计算公式：\n$$\nN^2(d) = g \\left(\\beta \\frac{\\partial S}{\\partial d} - \\alpha \\frac{\\partial T}{\\partial d}\\right)\n$$\n该方程表明，稳定性（$N^2 > 0$）会因盐度随深度增加（$\\partial S/\\partial d > 0$，即更咸、更密的水在下方）以及温度随深度降低（$\\partial T/\\partial d  0$，即更冷、更密的水在下方）而增强。\n\n**数值算法设计**\n\n该问题要求一个四步算法，将离散的 $T(d)$ 和 $S(d)$ 剖面转换为一个连续、光滑且非负的函数 $\\widehat{N^2}(d)$。\n\n1.  **离散梯度计算**：给定在间距为 $h = d_{i+1} - d_i$ 的均匀深度网格 $\\{d_i\\}_{i=0}^{N-1}$ 上的离散剖面 $T_i = T(d_i)$ 和 $S_i = S(d_i)$，必须对垂直梯度 $\\partial T/\\partial d$ 和 $\\partial S/\\partial d$ 进行数值近似。为保持良好精度，指定使用二阶有限差分格式。对于内部点（$1 \\le i \\le N-2$），使用中心差分公式：\n    $$\n    f'(d_i) \\approx \\frac{f(d_{i+1}) - f(d_{i-1})}{2h}\n    $$\n    对于边界，需要使用二阶精度的单边公式，以避免降低整体精度。在表面（$i=0$）：\n    $$\n    f'(d_0) \\approx \\frac{-3f(d_0) + 4f(d_1) - f(d_2)}{2h}\n    $$\n    在底部（$i=N-1$）：\n    $$\n    f'(d_{N-1}) \\approx \\frac{3f(d_{N-1}) - 4f(d_{N-2}) + f(d_{N-3})}{2h}\n    $$\n    这些计算得到 $(\\partial T/\\partial d)_i$ 和 $(\\partial S/\\partial d)_i$ 的离散数组。\n\n2.  **$N^2(d)$ 剖面计算**：使用计算出的梯度和给定的常数 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$\\alpha = 2.0 \\times 10^{-4}\\,\\mathrm{K^{-1}}$ 和 $\\beta = 7.6 \\times 10^{-4}\\,\\mathrm{(PSU)^{-1}}$，在每个网格点 $d_i$ 上使用推导出的公式计算离散的浮力频率平方剖面 $(N^2)_i$：\n    $$\n    (N^2)_i = g \\left(\\beta \\left(\\frac{\\partial S}{\\partial d}\\right)_i - \\alpha \\left(\\frac{\\partial T}{\\partial d}\\right)_i\\right)\n    $$\n\n3.  **强制非负性**：使用 $N^2(d)$ 作为系数的垂直模态问题通常被构建为一个Sturm-Liouville特征值问题。为了使该问题适定，系数 $N^2(d)$ 必须处处非负。物理上，$N^2  0$ 对应于一个静力不稳定的水柱，其中会发生对流，从而使线性稳定性模型失效。为了继续进行线性分析，通过将计算出的 $N^2$ 值裁剪到一个小的正下限值 $N^2_{\\mathrm{min}} = 10^{-6}\\,\\mathrm{s^{-2}}$，对这些不稳定区域进行数值正则化。\n    $$\n    (N^2_{\\text{clipped}})_i = \\max\\left((N^2)_i, N^2_{\\mathrm{min}}\\right)\n    $$\n    此步骤确保了模态分析具有物理上和数学上稳定的背景状态。\n\n4.  **光滑保形插值**：离散的、裁剪后的剖面 $(N^2_{\\text{clipped}})_i$ 必须被转换为一个可以在任何深度求值的连续函数 $\\widehat{N^2}(d)$。标准的立方样条可能会在网格点之间引入虚假振荡（过冲），这可能违反非负性约束。问题指定使用分段三次Hermite插值多项式（PCHIP），因为它是保形的。它能保持所提供数据点的单调性，确保如果离散数据是非负的，那么插值函数在点之间也将是非负的。这会产生一个光滑的函数 $\\widehat{N^2}(d)$，它能准确反映物理分层而不会引入数值伪影。然后使用此函数在每个测试用例的指定查询深度处评估 $N^2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import PchipInterpolator\n\ndef solve():\n    \"\"\"\n    Computes and prepares the squared buoyancy frequency profile N^2(d)\n    for several test cases, following the algorithm specified in the problem.\n    \"\"\"\n    # Define physical constants.\n    g = 9.81  # Gravitational acceleration in m/s^2\n    alpha = 2.0e-4  # Thermal expansion coefficient in K^-1\n    beta = 7.6e-4  # Haline contraction coefficient in (PSU)^-1\n    N2_min = 1.0e-6  # Minimum floor for N^2 in s^-2\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"d_range\": (0.0, 1000.0),\n            \"N_points\": 501,\n            \"T_func\": lambda d: 20.0 - 15.0 * np.tanh((d - 200.0) / 150.0),\n            \"S_func\": lambda d: 34.5 + 0.5 * np.tanh((d - 300.0) / 200.0),\n            \"query_depths\": [0.0, 100.0, 250.0, 500.0, 1000.0],\n        },\n        {\n            \"d_range\": (0.0, 1000.0),\n            \"N_points\": 501,\n            \"T_func\": lambda d: np.full_like(d, 10.0),\n            \"S_func\": lambda d: np.full_like(d, 35.0),\n            \"query_depths\": [0.0, 100.0, 250.0, 500.0, 1000.0],\n        },\n        {\n            \"d_range\": (0.0, 1000.0),\n            \"N_points\": 501,\n            \"T_func\": lambda d: 14.0 + 0.5 * np.sin(2.0 * np.pi * d / 120.0) - 11.0 * d / 1000.0,\n            \"S_func\": lambda d: 34.8 + 0.2 * np.cos(2.0 * np.pi * d / 180.0) + 0.1 * d / 1000.0,\n            \"query_depths\": [0.0, 100.0, 250.0, 500.0, 1000.0],\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Generate the depth grid and corresponding T/S profiles.\n        d_grid = np.linspace(case[\"d_range\"][0], case[\"d_range\"][1], case[\"N_points\"])\n        T_profile = case[\"T_func\"](d_grid)\n        S_profile = case[\"S_func\"](d_grid)\n        \n        # Calculate grid spacing for finite differences.\n        h = d_grid[1] - d_grid[0]\n\n        # Step 1: Compute discrete vertical gradients using second-order accurate differences.\n        # np.gradient with edge_order=2 uses second-order central differences for the interior\n        # and second-order one-sided differences for the boundaries.\n        dT_dd = np.gradient(T_profile, h, edge_order=2)\n        dS_dd = np.gradient(S_profile, h, edge_order=2)\n\n        # Step 2: Compute N^2(d) via the linearized formula.\n        N2_profile = g * (beta * dS_dd - alpha * dT_dd)\n\n        # Step 3: Enforce non-negativity by clipping to a minimum floor.\n        N2_clipped = np.maximum(N2_profile, N2_min)\n\n        # Step 4: Construct a smooth, shape-preserving interpolant (PCHIP).\n        pchip_N2 = PchipInterpolator(d_grid, N2_clipped)\n        \n        # Evaluate the prepared function at the specified query depths.\n        query_depths = np.array(case[\"query_depths\"])\n        N2_interpolated = pchip_N2(query_depths)\n        \n        # Format results for the current case into a string list.\n        # The format must use scientific notation with at least 6 decimal digits.\n        case_results_str = [f\"{val:.7e}\" for val in N2_interpolated]\n        all_results.append(f\"[{','.join(case_results_str)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "模态分裂的主要动机在于外模态波和内模态波之间巨大的速度差异，这造成了计算上的瓶颈。本练习将让你扮演一个数值模式开发者的角色，任务是为一个快速移动的正压模态计算其最大稳定时间步长。通过在具有真实陡峭地形的断面上应用Courant-Friedrichs-Lewy (CFL) 稳定性条件，你将直接量化地形如何决定正压求解器的计算成本，并理解为何将其与较慢的斜压计算分离开来是如此关键。",
            "id": "3799110",
            "problem": "考虑一个分离显式海洋模型，该模型分别解析正压（外部）和斜压（内部）运动。正压模态采用显式格式推进，该格式需要满足 Courant–Friedrichs–Lewy (CFL) 稳定性限制。给定一个在 Arakawa C-网格上的一维沿断面离散化：海面高度 $\\eta$ 位于网格中心，正压速度 $u$ 位于网格面。正压模态的控制性线性化浅水方程（忽略科里奥利力和摩擦力）为\n$$\n\\eta_{t} + \\partial_{x}\\left(H u\\right) = 0, \\qquad u_{t} + g\\,\\eta_{x} = 0,\n$$\n其中 $H(x)$ 是水深， $g$ 是重力加速度。在离散通量中，网格面的深度取相邻网格中心深度的算术平均值。\n\n沿着长度为 $L = 50\\,\\mathrm{km}$、均匀网格间距为 $\\Delta x = 10\\,\\mathrm{km}$ 的断面，六个网格中心的深度分别为\n$$\nH_{1} = 50\\,\\mathrm{m},\\quad H_{2} = 75\\,\\mathrm{m},\\quad H_{3} = 150\\,\\mathrm{m},\\quad H_{4} = 1000\\,\\mathrm{m},\\quad H_{5} = 3000\\,\\mathrm{m},\\quad H_{6} = 3800\\,\\mathrm{m}.\n$$\n设重力加速度为 $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。正压求解器使用统一的快模态时间步长 $\\Delta t_{\\mathrm{b}}$ 和相对于稳定性极限的安全 Courant 因子 $\\nu = 0.80$。\n\n从上述给定的线性化浅水方程、指定的网格交错方式和网格面深度定义出发，推导沿每个网格面的离散外部重力波传播速度，确定该断面所施加的最严格的稳定性约束，并计算能确保沿整个断面处处稳定的单一全局 $\\Delta t_{\\mathrm{b}}$。最终答案以秒为单位表示，并四舍五入到三位有效数字。在你的推理过程中，明确地根据给定的 $H_i$ 构建有效网格面深度 $H_{\\mathrm{f}}$，并说明陡峭的水深地形如何改变不同区域的逐面传播速度，从而影响允许的快模态时间步长。",
            "solution": "用户希望我严格验证一个计算海洋学问题，并在其有效的情况下进行求解。\n\n### **问题验证**\n\n**步骤1：提取已知条件**\n\n*   **模型与网格：** 分离显式海洋模型，采用一维 Arakawa C-网格离散化。海面高度 $\\eta$ 位于网格中心，正压速度 $u$ 位于网格面。\n*   **控制方程（线性化浅水方程）：**\n    $$\n    \\eta_{t} + \\partial_{x}\\left(H u\\right) = 0, \\qquad u_{t} + g\\,\\eta_{x} = 0\n    $$\n*   **参数与定义：**\n    *   $H(x)$: 水深。\n    *   $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$: 重力加速度。\n    *   离散网格面深度：网格面的深度是两个相邻网格中心深度的算术平均值。\n*   **区域与离散化：**\n    *   断面长度：$L = 50\\,\\mathrm{km}$。\n    *   均匀网格间距：$\\Delta x = 10\\,\\mathrm{km}$。\n    *   六个网格中心（$i=1, \\dots, 6$）的深度：\n        *   $H_{1} = 50\\,\\mathrm{m}$\n        *   $H_{2} = 75\\,\\mathrm{m}$\n        *   $H_{3} = 150\\,\\mathrm{m}$\n        *   $H_{4} = 1000\\,\\mathrm{m}$\n        *   $H_{5} = 3000\\,\\mathrm{m}$\n        *   $H_{6} = 3800\\,\\mathrm{m}$\n*   **数值格式：**\n    *   正压求解器使用统一的快模态时间步长 $\\Delta t_{\\mathrm{b}}$。\n    *   它是一种受 Courant–Friedrichs–Lewy (CFL) 稳定性限制的显式格式。\n    *   使用了安全 Courant 因子 $\\nu = 0.80$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n1.  **科学基础：**该问题牢固地植根于计算流体动力学和物理海洋学的基本原理。线性化浅水方程是正压重力波的标准模型，而 Arakawa C-网格、分离显式时间步进和 CFL 条件是数值海洋模型中的经典概念。\n2.  **适定性：**该问题是适定的。它提供了计算稳定时间步长的单一、唯一确定的数值所需的所有信息。\n3.  **客观性：**该问题以精确、客观和标准的科学术语陈述。\n4.  **一致性：**存在一个潜在的歧义：6个宽度为 $\\Delta x = 10\\,\\mathrm{km}$ 的网格将跨越 $60\\,\\mathrm{km}$ 的总长度，而不是 $50\\,\\mathrm{km}$。然而，通过将“断面长度” $ L = 50\\,\\mathrm{km}$ 解释为计算动力学的距离，这个问题可以得到解决。在一个有 $N=6$ 个标量网格的 C-网格上，有 $N-1=5$ 个内部网格面用于计算速度。这个速度网格的总长度是 $(N-1)\\Delta x = 5 \\times 10\\,\\mathrm{km} = 50\\,\\mathrm{km}$。这种解释使得问题陈述完全一致。\n5.  **真实性：**给定的深度代表了从大陆架到深海平原的真实过渡。物理常数和数值参数都是标准的。\n\n**步骤3：结论与行动**\n\n该问题有效。其前提在科学上是合理的，在对网格设置进行标准解释的情况下数据是一致的，并且问题是适定的。我将继续进行求解。\n\n### **问题求解**\n\n目标是找到正压模态求解器所允许的最大稳定时间步长 $\\Delta t_{\\mathrm{b}}$。这由显式数值格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件决定。\n\n控制方程描述了外部重力波的传播。通过对第一个方程求时间导数，对第二个方程求空间导数（并假设 $H$ 变化缓慢，这是推导波速的常见简化），将两个给定的方程结合起来，得到波动方程：\n$$ \\eta_{tt} = \\partial_t(-\\partial_x(Hu)) = -\\partial_x(H u_t) = -\\partial_x(H(-g\\eta_x)) = g\\partial_x(H\\eta_x) \\approx gH \\eta_{xx} $$\n这是一个标准的波动方程，$\\eta_{tt} = c^2 \\eta_{xx}$，其中重力波的相速度为 $c = \\sqrt{gH}$。\n\n对于网格间距为 $\\Delta x$ 的显式数值格式，CFL 稳定性条件要求数值的依赖域必须包含物理的依赖域。对于以速度 $c$ 传播的波，该条件由下式给出：\n$$ \\Delta t \\le \\frac{\\Delta x}{c} $$\n由于正压时间步长 $\\Delta t_{\\mathrm{b}}$ 必须确保整个计算域的稳定性，它必须受到模型网格中任何地方出现的最快波速 $c_{\\max}$ 的约束：\n$$ \\Delta t_{\\mathrm{b}} \\le \\frac{\\Delta x}{c_{\\max}} $$\n问题指定了安全 Courant 因子 $\\nu = 0.80$。因此，所选择的时间步长为：\n$$ \\Delta t_{\\mathrmb} = \\nu \\frac{\\Delta x}{c_{\\max}} $$\n波速 $c$ 取决于局部深度 $H$。在交错的 Arakawa C-网格上，速度 $u$ 在网格单元之间​​的面上计算。速度更新的稳定性取决于质量通量项 $(Hu)$ 中使用的深度。问题陈述，面上的深度（我们表示为 $H_{\\mathrmf}$）是两个相邻网格深度的算术平均值。因此，对于单元 $i$ 和单元 $i+1$ 之间，索引为 $i+1/2$ 的面，有效深度为：\n$$ H_{\\mathrmf, i+1/2} = \\frac{H_i + H_{i+1}}{2} $$\n因此，该面上的局部重力波速度为 $c_{i+1/2} = \\sqrt{g H_{\\mathrmf, i+1/2}}$。最严格的条件，也就是决定全局时间步长的条件，对应于最大波速，该波速出现在具有最大有效深度 $H_{\\mathrmf, \\max}$ 的面上。\n$$ c_{\\max} = \\sqrt{g H_{\\mathrmf, \\max}} $$\n我们有 $6$ 个网格单元，因此有 $5$ 个内部面，在这些面上定义了速度 $u$ 和相应的有效面深度 $H_{\\mathrmf}$。让我们根据给定的网格中心深度 $H_i$ 计算这些面深度：\n$H_{1} = 50\\,\\mathrm{m}$，$H_{2} = 75\\,\\mathrm{m}$，$H_{3} = 150\\,\\mathrm{m}$，$H_{4} = 1000\\,\\mathrm{m}$，$H_{5} = 3000\\,\\mathrm{m}$，$H_{6} = 3800\\,\\mathrm{m}$。\n\n五个面深度为：\n$H_{\\mathrmf, 1.5} = \\frac{H_1 + H_2}{2} = \\frac{50 + 75}{2} = 62.5\\,\\mathrm{m}$\n$H_{\\mathrmf, 2.5} = \\frac{H_2 + H_3}{2} = \\frac{75 + 150}{2} = 112.5\\,\\mathrm{m}$\n$H_{\\mathrmf, 3.5} = \\frac{H_3 + H_4}{2} = \\frac{150 + 1000}{2} = 575\\,\\mathrm{m}$\n$H_{\\mathrmf, 4.5} = \\frac{H_4 + H_5}{2} = \\frac{1000 + 3000}{2} = 2000\\,\\mathrm{m}$\n$H_{\\mathrmf, 5.5} = \\frac{H_5 + H_6}{2} = \\frac{3000 + 3800}{2} = 3400\\,\\mathrm{m}$\n\n最大面深度为 $H_{\\mathrmf, \\max} = H_{\\mathrmf, 5.5} = 3400\\,\\mathrm{m}$。这是向深海过渡最显著的区域，也是外部重力波传播最快的地方。\n\n最大波速为：\n$$ c_{\\max} = \\sqrt{g H_{\\mathrmf, \\max}} = \\sqrt{(9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2})(3400\\,\\mathrm{m})} = \\sqrt{33354}\\,\\mathrm{m}\\,\\mathrm{s}^{-1} \\approx 182.631\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n现在我们可以计算稳定时间步长 $\\Delta t_{\\mathrmb}$。给定的国际单位制（SI）参数为：\n$\\nu = 0.80$\n$\\Delta x = 10\\,\\mathrm{km} = 10000\\,\\mathrm{m}$\n$g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n$H_{\\mathrmf, \\max} = 3400\\,\\mathrm{m}$\n\n$$ \\Delta t_{\\mathrmb} = \\nu \\frac{\\Delta x}{\\sqrt{g H_{\\mathrmf, \\max}}} = 0.80 \\times \\frac{10000\\,\\mathrm{m}}{\\sqrt{9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2} \\times 3400\\,\\mathrm{m}}} $$\n$$ \\Delta t_{\\mathrmb} = \\frac{8000}{\\sqrt{33354}}\\,\\mathrm{s} \\approx \\frac{8000}{182.631}\\,\\mathrm{s} \\approx 43.8043\\,\\mathrm{s} $$\n问题要求最终答案四舍五入到三位有效数字。\n$$ \\Delta t_{\\mathrmb} \\approx 43.8\\,\\mathrm{s} $$\n这个单一的全局时间步长确保了正压模态的数值解在整个断面上保持稳定，即使在 Courant 数本可能最大的最深区域也是如此。$H_5$ 和 $H_6$ 之间的陡峭水深坡度产生了最大的面深度，从而带来了最严格的稳定性约束。",
            "answer": "$$\n\\boxed{43.8}\n$$"
        },
        {
            "introduction": "在理解了不同模态的特性及其带来的限制之后，我们现在可以利用它们的差异来解决实际的建模挑战。本练习将指导你设计一个“海绵层”，这是一种在开放边界处吸收出射波以防止不真实反射的常用技术。你将学习如何构建一个阻尼剖面，使其能够选择性地针对并消除快速的正压波，同时基本不影响速度较慢且物理上重要的斜压运动，从而展示模态分裂原理的一个巧妙应用。",
            "id": "3799089",
            "problem": "考虑一个分层海洋模型中的一维开边界，其中坐标 $x$ 从内部 ($x=0$) 向开边界 ($x=L_{\\mathrm{s}}$) 增加。您将设计一个海绵层，该海绵层能够阻尼快速的外部（正压）重力波，同时不会显著影响慢速的内部（斜压）模态。目标是计算应用于正压模态的空间变化的瑞利阻尼系数，并评估允许泄漏到斜压模态的量。\n\n从以下基于物理学的基础开始：\n\n- 一维水平方向上线性化浅水方程的外部（正压）模态来自垂直积分的动量和连续性方程。对于恒定深度 $H$ 和重力加速度 $g$，其无色散相速度为 $c_{\\mathrm{e}}=\\sqrt{g H}$。\n- 在双层海洋中，上层厚度为 $h_1$，下层厚度为 $h_2$，折合重力为 $g'$ 的第一内部（斜压）模态具有无色散相速度 $c_{\\mathrm{i}}=\\sqrt{\\frac{g' \\, h_1 \\, h_2}{h_1 + h_2}}$。\n- 一个系数为 $\\sigma(x)$ 的瑞利阻尼应用于海绵层中的正压预报变量，导致前向传播的无色散波的振幅 $A(x)$ 沿着一条射线根据从局部能量平衡和 Wentzel–Kramers–Brillouin (WKB) 近似导出的指数定律衰减：振幅满足 $\\frac{\\mathrm{d}A}{\\mathrm{d}x} = -\\frac{\\sigma(x)}{c} A$，其中 $c$ 是模态的相速度。假设阻尼对称地作用于正压动量和自由表面预报变量，因此振幅衰减率等于 $\\sigma(x)$。\n- 在模态分裂下，从正压子系统到斜压子系统的阻尼数值泄漏可以被建模为作用于内模的正压阻尼的一小部分 $\\alpha$。也就是说，内部振幅在以速度 $c_{\\mathrm{i}}$ 传播时，会受到有效阻尼 $\\alpha \\, \\sigma(x)$ 的影响。\n\n您将使用一个平滑的坡道作为海绵层剖面，\n$$\nS(\\xi) = \\sin^2\\!\\left(\\frac{\\pi \\xi}{2}\\right), \\quad \\xi = \\frac{x}{L_{\\mathrm{s}}}, \\quad x \\in [0, L_{\\mathrm{s}}],\n$$\n并设置\n$$\n\\sigma(x) = \\sigma_{\\max} \\, S\\!\\left(\\frac{x}{L_{\\mathrm{s}}}\\right),\n$$\n其中对于 $x0$ 有 $\\sigma(x)=0$。设计目标是：\n1. 对于外部模态，在整个海绵层上实现一个预定的外部振幅衰减因子 $R_{\\mathrm{e}} \\in (0,1)$，即 $A(L_{\\mathrm{s}})/A(0)=R_{\\mathrm{e}}$。\n2. 保证在泄漏分数 $\\alpha$ 作用于内部模态的情况下，穿过同一海绵层的内部振幅衰减满足 $A_{\\mathrm{i}}(L_{\\mathrm{s}})/A_{\\mathrm{i}}(0) \\ge R_{\\mathrm{i}}^{\\min} \\in (0,1)$。\n3. 估算与这两个目标兼容的最大允许泄漏分数 $\\alpha_{\\max}$。\n\n任务：\n- 从第一性原理出发，从无色散波的 WKB 振幅方程和给定的 $\\sigma(x)$ 开始，推导外部振幅衰减 $R_{\\mathrm{e}}$ 如何通过 $S(\\xi)$ 的积分来约束乘积 $\\sigma_{\\max} L_{\\mathrm{s}}$。\n- 使用相同的原理，说明内部振幅衰减如何依赖于 $\\alpha$、$c_{\\mathrm{i}}$ 以及 $S(\\xi)$ 的相同积分，并推导出一个表达式 $\\alpha_{\\max}$，以保证在满足外部目标的同时，$A_{\\mathrm{i}}(L_{\\mathrm{s}})/A_{\\mathrm{i}}(0) \\ge R_{\\mathrm{i}}^{\\min}$。\n- 实现一个程序，为每个测试用例计算：\n  - 外部相速度 $c_{\\mathrm{e}}$，单位为米/秒 (m/s)。\n  - 内部相速度 $c_{\\mathrm{i}}$，单位为米/秒 (m/s)。\n  - 积分 $I_S = \\int_0^1 S(\\xi) \\,\\mathrm{d}\\xi$（无量纲）。\n  - 所需的最大阻尼 $\\sigma_{\\max}$，单位为秒的倒数 (s$^{-1}$)。\n  - 最小局部阻尼时间尺度 $\\tau_{\\min} = 1/\\sigma_{\\max}$，单位为秒 (s)。\n  - 与指定的内模保留阈值兼容的最大泄漏分数 $\\alpha_{\\max}$（无量纲）。\n所有物理量必须以上述指定单位表示。$S(\\xi)$ 中使用的角度以弧度为单位。\n\n测试套件：\n对于以下每个案例，使用给定的参数。所有距离单位为米 (m)，时间单位为秒 (s)，加速度单位为米/秒平方 (m/s$^2$) 。\n\n- 案例1（深海，中等衰减目标）：\n  - $g = 9.81$, $H = 4000$, $h_1 = 200$, $h_2 = 3800$, $g' = 0.019$, $L_{\\mathrm{s}} = 50000$, $R_{\\mathrm{e}} = 0.05$, $R_{\\mathrm{i}}^{\\min} = 0.95$。\n- 案例2（大陆架，轻度衰减目标）：\n  - $g = 9.81$, $H = 100$, $h_1 = 20$, $h_2 = 80$, $g' = 0.01$, $L_{\\mathrm{s}} = 20000$, $R_{\\mathrm{e}} = 0.10$, $R_{\\mathrm{i}}^{\\min} = 0.95$。\n- 案例3（弱分层，较强衰减目标）：\n  - $g = 9.81$, $H = 3000$, $h_1 = 100$, $h_2 = 2900$, $g' = 0.005$, $L_{\\mathrm{s}} = 30000$, $R_{\\mathrm{e}} = 0.02$, $R_{\\mathrm{i}}^{\\min} = 0.95$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果列表，每个测试用例的结果是一个包含三个浮点数的列表 $[\\sigma_{\\max}, \\tau_{\\min}, \\alpha_{\\max}]$。$\\sigma_{\\max}$ 以 s$^{-1}$ 表示，$\\tau_{\\min}$ 以 s 表示，$\\alpha_{\\max}$ 以小数形式表示。将每个数字四舍五入到六位小数。该行应是由方括号括起来的这些子列表的逗号分隔列表，例如：[[s1,t1,a1],[s2,t2,a2],[s3,t3,a3]]。",
            "solution": "该问题是有效的，因为它在科学上基于流体动力学原理，问题设定良好，并为推导解决方案提供了完整且一致的信息集。\n\n目标是为数值海洋模型中的开放边界设计一个瑞利阻尼海绵层。该设计必须有效阻尼快速移动的外部（正压）重力波，同时最小化对慢速移动的内部（斜压）波的影响。这涉及到推导满足指定性能标准的最大阻尼系数 $\\sigma_{\\max}$ 和最大允许泄漏分数 $\\alpha_{\\max}$ 的表达式。\n\n首先，我们推导波振幅穿过海绵层衰减的一般表达式。问题陈述，前向传播波的振幅 $A(x)$ 根据 WKB 近似衰减：\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}x} = -\\frac{\\sigma(x)}{c} A\n$$\n其中 $\\sigma(x)$ 是空间变化的阻尼系数， $c$ 是波的相速度。这是一个一阶线性常微分方程。我们可以通过分离变量法来求解：\n$$\n\\frac{\\mathrm{d}A}{A} = -\\frac{\\sigma(x)}{c} \\mathrm{d}x\n$$\n将等式两边在海绵层上从内部边缘 $x=0$ 到边界 $x=L_{\\mathrm{s}}$ 进行积分，我们得到：\n$$\n\\int_{A(0)}^{A(L_{\\mathrm{s}})} \\frac{\\mathrm{d}A}{A} = \\int_{0}^{L_{\\mathrm{s}}} -\\frac{\\sigma(x)}{c} \\mathrm{d}x\n$$\n$$\n\\ln\\left(\\frac{A(L_{\\mathrm{s}})}{A(0)}\\right) = -\\frac{1}{c} \\int_{0}^{L_{\\mathrm{s}}} \\sigma(x) \\mathrm{d}x\n$$\n因此，振幅衰减因子 $R = A(L_{\\mathrm{s}})/A(0)$ 由下式给出：\n$$\nR = \\exp\\left(-\\frac{1}{c} \\int_{0}^{L_{\\mathrm{s}}} \\sigma(x) \\mathrm{d}x\\right)\n$$\n阻尼系数定义为 $\\sigma(x) = \\sigma_{\\max} S(x/L_{\\mathrm{s}})$，其中剖面函数为 $S(\\xi) = \\sin^2(\\pi\\xi/2)$，对于 $\\xi = x/L_{\\mathrm{s}} \\in [0, 1]$。我们可以计算 $\\sigma(x)$ 的积分：\n$$\n\\int_{0}^{L_{\\mathrm{s}}} \\sigma(x) \\mathrm{d}x = \\sigma_{\\max} \\int_{0}^{L_{\\mathrm{s}}} S\\left(\\frac{x}{L_{\\mathrm{s}}}\\right) \\mathrm{d}x\n$$\n使用代换 $\\xi = x/L_{\\mathrm{s}}$，这意味着 $\\mathrm{d}x = L_{\\mathrm{s}}\\mathrm{d}\\xi$，积分变为：\n$$\n\\int_{0}^{L_{\\mathrm{s}}} \\sigma(x) \\mathrm{d}x = \\sigma_{\\max} L_{\\mathrm{s}} \\int_{0}^{1} S(\\xi) \\mathrm{d}\\xi = \\sigma_{\\max} L_{\\mathrm{s}} I_S\n$$\n其中 $I_S = \\int_0^1 S(\\xi) \\mathrm{d}\\xi$。我们使用三角恒等式 $\\sin^2\\theta = (1-\\cos(2\\theta))/2$ 来计算这个无量纲积分：\n$$\nI_S = \\int_{0}^{1} \\sin^2\\left(\\frac{\\pi\\xi}{2}\\right) \\mathrm{d}\\xi = \\int_{0}^{1} \\frac{1}{2}\\left(1 - \\cos(\\pi\\xi)\\right) \\mathrm{d}\\xi\n$$\n$$\nI_S = \\frac{1}{2} \\left[ \\xi - \\frac{\\sin(\\pi\\xi)}{\\pi} \\right]_{0}^{1} = \\frac{1}{2} \\left( \\left(1 - \\frac{\\sin(\\pi)}{\\pi}\\right) - \\left(0 - \\frac{\\sin(0)}{\\pi}\\right) \\right) = \\frac{1}{2} \\left( (1-0) - (0-0) \\right) = \\frac{1}{2}\n$$\n所以，阻尼的积分就是 $\\frac{1}{2}\\sigma_{\\max}L_{\\mathrm{s}}$。\n\n现在，我们将这些结果应用于外部和内部模态。\n\n对于外部（正压）模态，相速度为 $c_{\\mathrm{e}} = \\sqrt{gH}$。设计目标是实现衰减因子 $R_{\\mathrm{e}}$。将我们的发现代入通用衰减公式：\n$$\nR_{\\mathrm{e}} = \\exp\\left(-\\frac{\\sigma_{\\max} L_{\\mathrm{s}} I_S}{c_{\\mathrm{e}}}\\right)\n$$\n为了求得所需的最大阻尼 $\\sigma_{\\max}$，我们对其求解：\n$$\n\\ln(R_{\\mathrm{e}}) = -\\frac{\\sigma_{\\max} L_{\\mathrm{s}} I_S}{c_{\\mathrm{e}}}\n$$\n$$\n\\sigma_{\\max} = -\\frac{c_{\\mathrm{e}} \\ln(R_{\\mathrm{e}})}{L_{\\mathrm{s}} I_S} = -\\frac{2 c_{\\mathrm{e}} \\ln(R_{\\mathrm{e}})}{L_{\\mathrm{s}}}\n$$\n由于 $R_{\\mathrm{e}} \\in (0,1)$，其对数 $\\ln(R_{\\mathrm{e}})$ 为负，确保 $\\sigma_{\\max}$ 为正。最小局部阻尼时间尺度为 $\\tau_{\\min} = 1/\\sigma_{\\max}$。\n\n对于内部（斜压）模态，相速度为 $c_{\\mathrm{i}} = \\sqrt{\\frac{g'h_1h_2}{h_1+h_2}}$。作用于此模态的阻尼受到数值泄漏的影响，表示为 $\\alpha \\sigma(x)$，其中 $\\alpha$ 是泄漏分数。因此，内部模态的衰减因子 $R_{\\mathrm{i}}$ 为：\n$$\nR_{\\mathrm{i}} = \\exp\\left(-\\frac{1}{c_{\\mathrm{i}}} \\int_{0}^{L_{\\mathrm{s}}} \\alpha \\sigma(x) \\mathrm{d}x\\right) = \\exp\\left(-\\frac{\\alpha \\sigma_{\\max} L_{\\mathrm{s}} I_S}{c_{\\mathrm{i}}}\\right)\n$$\n设计约束是内部模态必须尽可能被保留，具体为 $R_{\\mathrm{i}} \\ge R_{\\mathrm{i}}^{\\min}$。\n$$\n\\exp\\left(-\\frac{\\alpha \\sigma_{\\max} L_{\\mathrm{s}} I_S}{c_{\\mathrm{i}}}\\right) \\ge R_{\\mathrm{i}}^{\\min}\n$$\n对两侧取自然对数（这是一个单调函数，所以不等式得以保留）：\n$$\n-\\frac{\\alpha \\sigma_{\\max} L_{\\mathrm{s}} I_S}{c_{\\mathrm{i}}} \\ge \\ln(R_{\\mathrm{i}}^{\\min})\n$$\n我们想要找到最大允许泄漏分数 $\\alpha_{\\max}$。求解 $\\alpha$：\n$$\n\\alpha \\le -\\frac{c_{\\mathrm{i}} \\ln(R_{\\mathrm{i}}^{\\min})}{\\sigma_{\\max} L_{\\mathrm{s}} I_S}\n$$\n这里，我们除以了负量 $-\\sigma_{\\max} L_{\\mathrm{s}} I_S / c_{\\mathrm{i}}$，这会反转不等号（注意 $\\ln(R_{\\mathrm{i}}^{\\min})$ 是负数，但我们可以将其写为 $-\\alpha \\times (\\text{正数}) \\ge (\\text{负数})$，所以 $\\alpha \\le (\\text{正数})$）。因此，最大值为：\n$$\n\\alpha_{\\max} = -\\frac{c_{\\mathrm{i}} \\ln(R_{\\mathrm{i}}^{\\min})}{\\sigma_{\\max} L_{\\mathrm{s}} I_S}\n$$\n我们从外部模态约束中得到了项 $\\sigma_{\\max} L_{\\mathrm{s}} I_S$ 的表达式：$\\sigma_{\\max} L_{\\mathrm{s}} I_S = -c_{\\mathrm{e}} \\ln(R_{\\mathrm{e}})$。将其代入 $\\alpha_{\\max}$ 的方程中，可以得到一个更简洁的形式：\n$$\n\\alpha_{\\max} = -\\frac{c_{\\mathrm{i}} \\ln(R_{\\mathrm{i}}^{\\min})}{-c_{\\mathrm{e}} \\ln(R_{\\mathrm{e}})} = \\frac{c_{\\mathrm{i}}}{c_{\\mathrm{e}}} \\frac{\\ln(R_{\\mathrm{i}}^{\\min})}{\\ln(R_{\\mathrm{e}})}\n$$\n这个最终表达式巧妙地表明，最大允许泄漏量取决于相速度之比以及目标衰减因子对数之比。\n\n每个测试用例的计算过程如下：\n1.  计算外部相速度：$c_{\\mathrm{e}} = \\sqrt{g H}$。\n2.  计算内部相速度：$c_{\\mathrm{i}} = \\sqrt{\\frac{g' h_1 h_2}{h_1 + h_2}}$。\n3.  海绵层剖面积分为常数：$I_S = 0.5$。\n4.  计算最大阻尼：$\\sigma_{\\max} = -\\frac{c_{\\mathrm{e}} \\ln(R_{\\mathrm{e}})}{L_{\\mathrm{s}} I_S}$。\n5.  计算最小阻尼时间尺度：$\\tau_{\\min} = 1/\\sigma_{\\max}$。\n6.  计算最大泄漏分数：$\\alpha_{\\max} = \\frac{c_{\\mathrm{i}}}{c_{\\mathrm{e}}} \\frac{\\ln(R_{\\mathrm{i}}^{\\min})}{\\ln(R_{\\mathrm{e}})}$。\n这些计算将在下面的程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sponge layer parameters for given oceanographic test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (deep ocean, moderate attenuation target)\n        {'g': 9.81, 'H': 4000.0, 'h1': 200.0, 'h2': 3800.0, 'gp': 0.019,\n         'Ls': 50000.0, 'Re': 0.05, 'Rimin': 0.95},\n        # Case 2 (continental shelf, mild attenuation target)\n        {'g': 9.81, 'H': 100.0, 'h1': 20.0, 'h2': 80.0, 'gp': 0.01,\n         'Ls': 20000.0, 'Re': 0.10, 'Rimin': 0.95},\n        # Case 3 (weak stratification, stronger attenuation target)\n        {'g': 9.81, 'H': 3000.0, 'h1': 100.0, 'h2': 2900.0, 'gp': 0.005,\n         'Ls': 30000.0, 'Re': 0.02, 'Rimin': 0.95},\n    ]\n\n    results = []\n    for params in test_cases:\n        g = params['g']\n        H = params['H']\n        h1 = params['h1']\n        h2 = params['h2']\n        gp = params['gp']\n        Ls = params['Ls']\n        Re = params['Re']\n        Rimin = params['Rimin']\n\n        # Task: Compute external phase speed ce\n        # Formula: c_e = sqrt(g * H)\n        c_e = np.sqrt(g * H)\n\n        # Task: Compute internal phase speed ci\n        # Formula: c_i = sqrt((g' * h1 * h2) / (h1 + h2))\n        c_i = np.sqrt((gp * h1 * h2) / (h1 + h2))\n\n        # Task: Compute the integral of the sponge profile function S(xi)\n        # Formula: I_S = integral from 0 to 1 of sin^2(pi*xi/2) dxi = 1/2\n        I_S = 0.5\n\n        # Task: Compute the required maximum damping sigma_max\n        # Formula: sigma_max = - (c_e * ln(R_e)) / (L_s * I_S)\n        sigma_max = - (c_e * np.log(Re)) / (Ls * I_S)\n\n        # Task: Compute the minimum local damping timescale tau_min\n        # Formula: tau_min = 1 / sigma_max\n        tau_min = 1.0 / sigma_max\n\n        # Task: Compute the maximum leakage fraction alpha_max\n        # Formula: alpha_max = (c_i / c_e) * (ln(R_i_min) / ln(R_e))\n        alpha_max = (c_i / c_e) * (np.log(Rimin) / np.log(Re))\n        \n        results.append([sigma_max, tau_min, alpha_max])\n\n    # Format the final output string as a list of lists with 6 decimal places.\n    case_outputs = []\n    for case_result in results:\n        formatted_numbers = [f\"{num:.6f}\" for num in case_result]\n        case_outputs.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    final_string = f\"[{','.join(case_outputs)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_string)\n\nsolve()\n```"
        }
    ]
}