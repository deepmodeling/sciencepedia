{
    "hands_on_practices": [
        {
            "introduction": "The fundamental behavior of any physical system that supports waves is encapsulated in its dispersion relation. This exercise guides you through the derivation of the dispersion relation for inertia-gravity waves, which arise from the linear shallow water equations on a rotating plane . By connecting wave frequency $\\omega$ to the horizontal wavenumbers $k$ and $l$, this relation governs how waves of different lengths propagate and disperse, providing the theoretical foundation for understanding a vast range of oceanic phenomena.",
            "id": "3815344",
            "problem": "Consider the linearized shallow water equations on an $f$-plane (constant Coriolis parameter $f$) over a horizontally unbounded, resting ocean of constant mean depth $H$ and gravitational acceleration $g$. Let $(x,y)$ denote horizontal Cartesian coordinates and $t$ time. The linear momentum and mass-conservation equations for the depth-averaged horizontal velocity $(u,v)$ and free-surface displacement $\\eta$ are\n$$\nu_{t} - f v = - g \\,\\eta_{x}, \\quad v_{t} + f u = - g \\,\\eta_{y}, \\quad \\eta_{t} + H\\left(u_{x} + v_{y}\\right) = 0.\n$$\nAssume space-time normal modes of the form\n$$\n\\big(u,v,\\eta\\big)(x,y,t) = \\Re\\left\\{\\big(\\hat{u},\\hat{v},\\hat{\\eta}\\big)\\,\\exp\\!\\big(i (k x + l y - \\omega t)\\big)\\right\\},\n$$\nwith real wavenumbers $k$, $l$ and (real) angular frequency $\\omega$. Starting from the above equations, derive the dispersion relation that connects $\\omega$ to $k$ and $l$ for the inertia–gravity wave branches. Then, analyze the asymptotic limits $|k|,|l|\\to 0$ and $|k|,|l|\\to \\infty$ of the positive-frequency branch to recover the leading-order inertial and non-rotating gravity-wave behaviors, respectively.\n\nProvide your final answer as the ordered pair of leading-order asymptotic expressions for the positive-frequency branch,\n$$\n\\big(\\lim_{K\\to 0}\\omega_{+}(k,l),\\;\\lim_{K\\to \\infty}\\omega_{+}(k,l)\\big),\n$$\nwith $K \\equiv \\sqrt{k^{2}+l^{2}}$. Express the frequency in radians per second. No numerical evaluation is required. Your final answer must be a single ordered pair of analytic expressions. Do not include any units in your final boxed answer.",
            "solution": "The problem statement is a standard exercise in geophysical fluid dynamics, involving the derivation and analysis of the dispersion relation for inertia-gravity waves from the linear shallow water equations.\n\n**Problem Validation:**\n1.  **Extract Givens:**\n    -   Governing equations: $u_{t} - f v = - g \\,\\eta_{x}$, $v_{t} + f u = - g \\,\\eta_{y}$, $\\eta_{t} + H\\left(u_{x} + v_{y}\\right) = 0$.\n    -   Constants: $f$ (Coriolis parameter), $H$ (mean depth), $g$ (gravitational acceleration).\n    -   Assumed solution form: $(u,v,\\eta)(x,y,t) = \\Re\\left\\{\\big(\\hat{u},\\hat{v},\\hat{\\eta}\\big)\\,\\exp\\!\\big(i (k x + l y - \\omega t)\\big)\\right\\}$.\n    -   Parameters: $k, l$ (real wavenumbers), $\\omega$ (real angular frequency), $(\\hat{u}, \\hat{v}, \\hat{\\eta})$ (complex amplitudes).\n2.  **Validate:**\n    -   The problem is **scientifically grounded**. The linear shallow water equations are a fundamental model in oceanography and atmospheric science.\n    -   The problem is **well-posed**. It asks for a standard derivation and asymptotic analysis, which leads to a unique, meaningful result.\n    -   The problem is **objective** and uses clear, standard terminology.\n    -   The problem is free of any of the invalidity flaws listed in the instructions. It is a complete, consistent, and solvable problem.\n\n**Verdict:** The problem is valid.\n\n**Solution Derivation:**\n\nWe begin by substituting the assumed plane-wave (normal mode) solution into the governing linearized shallow water equations. The partial derivatives transform as follows: $\\partial_{t} \\rightarrow -i\\omega$, $\\partial_{x} \\rightarrow ik$, and $\\partial_{y} \\rightarrow il$.\n\nApplying these transformations to the three equations yields a system of linear algebraic equations for the constant complex amplitudes $(\\hat{u}, \\hat{v}, \\hat{\\eta})$:\n$$\n-i\\omega \\hat{u} - f \\hat{v} = -g (ik) \\hat{\\eta}\n$$\n$$\n-i\\omega \\hat{v} + f \\hat{u} = -g (il) \\hat{\\eta}\n$$\n$$\n-i\\omega \\hat{\\eta} + H(ik \\hat{u} + il \\hat{v}) = 0\n$$\n\nRearranging these equations into a homogeneous system, we get:\n$$\n-i\\omega \\hat{u} - f \\hat{v} + igk \\hat{\\eta} = 0\n$$\n$$\nf \\hat{u} - i\\omega \\hat{v} + igl \\hat{\\eta} = 0\n$$\n$$\nikH \\hat{u} + ilH \\hat{v} - i\\omega \\hat{\\eta} = 0\n$$\n\nThis system can be written in matrix form as $\\mathbf{M} \\mathbf{x} = \\mathbf{0}$, where $\\mathbf{x} = (\\hat{u}, \\hat{v}, \\hat{\\eta})^T$ and the coefficient matrix $\\mathbf{M}$ is:\n$$\n\\mathbf{M} = \\begin{pmatrix}\n-i\\omega & -f & igk \\\\\nf & -i\\omega & igl \\\\\nikH & ilH & -i\\omega\n\\end{pmatrix}\n$$\n\nFor non-trivial solutions to exist (i.e., for waves to exist, where the amplitudes are non-zero), the determinant of the coefficient matrix $\\mathbf{M}$ must be zero.\n$$\n\\det(\\mathbf{M}) = 0\n$$\n\nWe compute the determinant:\n$$\n\\det(\\mathbf{M}) = (-i\\omega) \\begin{vmatrix} -i\\omega & igl \\\\ ilH & -i\\omega \\end{vmatrix} - (-f) \\begin{vmatrix} f & igl \\\\ ikH & -i\\omega \\end{vmatrix} + (igk) \\begin{vmatrix} f & -i\\omega \\\\ ikH & ilH \\end{vmatrix}\n$$\nLet's evaluate each part:\n1.  The first term:\n    $$\n    (-i\\omega) [(-i\\omega)(-i\\omega) - (igl)(ilH)] = (-i\\omega) [i^2\\omega^2 - i^2glH] = (-i\\omega) [-\\omega^2 + glH] = i\\omega^3 - i\\omega glH\n    $$\n2.  The second term:\n    $$\n    +f [f(-i\\omega) - (igl)(ikH)] = f [-i\\omega f - i^2gklH] = f [-i\\omega f + gklH] = -i\\omega f^2 + fgklH\n    $$\n3.  The third term:\n    $$\n    +igk [f(ilH) - (-i\\omega)(ikH)] = igk [iflH + i^2kH\\omega] = igk [iflH - kH\\omega] = i^2gfklH - i\\omega gk^2H = -gfklH - i\\omega gk^2H\n    $$\n\nSumming these three parts gives the total determinant:\n$$\n\\det(\\mathbf{M}) = (i\\omega^3 - i\\omega glH) + (-i\\omega f^2 + fgklH) + (-gfklH - i\\omega gk^2H)\n$$\nThe terms $+fgklH$ and $-gfklH$ cancel out. Combining the remaining terms:\n$$\n\\det(\\mathbf{M}) = i\\omega^3 - i\\omega f^2 - i\\omega glH - i\\omega gk^2H = i\\omega \\left[ \\omega^2 - f^2 - gH(k^2 + l^2) \\right]\n$$\n\nSetting the determinant to zero, $i\\omega \\left[ \\omega^2 - f^2 - gH(k^2 + l^2) \\right] = 0$, yields two possible classes of solutions:\n1.  $\\omega = 0$: This is a steady, geostrophically balanced solution, not a wave.\n2.  $\\omega^2 - f^2 - gH(k^2 + l^2) = 0$: This is the dispersion relation for inertia-gravity waves.\n\nThe dispersion relation is therefore:\n$$\n\\omega^2 = f^2 + gH(k^2 + l^2)\n$$\nLet $K = \\sqrt{k^2+l^2}$ be the total horizontal wavenumber. The relation becomes $\\omega^2 = f^2 + gHK^2$. The problem asks for the positive-frequency branch, which we denote as $\\omega_{+}$.\n$$\n\\omega_{+}(K) = \\sqrt{f^2 + gHK^2}\n$$\n\nNext, we analyze the asymptotic limits.\n\n**Asymptotic limit for long waves ($|k|, |l| \\to 0$, i.e., $K \\to 0$):**\nIn this limit, the wavelength of the waves is very large.\n$$\n\\lim_{K\\to 0} \\omega_{+}(K) = \\lim_{K\\to 0} \\sqrt{f^2 + gHK^2} = \\sqrt{f^2 + 0} = \\sqrt{f^2} = |f|\n$$\nThe frequency approaches the inertial frequency, $|f|$. This limit describes inertial oscillations, where fluid parcels move in circles (inertial circles) due to the Coriolis force, with negligible influence from pressure gradients over these large scales. The leading-order expression is $|f|$.\n\n**Asymptotic limit for short waves ($|k|, |l| \\to \\infty$, i.e., $K \\to \\infty$):**\nIn this limit, the wavelength is very short. The term $gHK^2$ dominates over the constant $f^2$.\n$$\n\\omega_{+}(K) = \\sqrt{f^2 + gHK^2} = \\sqrt{gHK^2 \\left(1 + \\frac{f^2}{gHK^2}\\right)} = \\sqrt{gH} K \\sqrt{1 + \\frac{f^2}{gHK^2}}\n$$\nFor large $K$, the term $f^2/(gHK^2)$ is small. Using the binomial approximation $\\sqrt{1+x} \\approx 1 + x/2$ for small $x$, we get:\n$$\n\\omega_{+}(K) \\approx \\sqrt{gH}K \\left(1 + \\frac{f^2}{2gHK^2}\\right) = \\sqrt{gH}K + \\frac{f^2}{2\\sqrt{gH}K}\n$$\nThe leading-order asymptotic expression is the dominant term as $K \\to \\infty$, which is:\n$$\n\\omega_{+}(K) \\sim \\sqrt{gH}K\n$$\nThis is the dispersion relation for non-rotating ($f=0$) shallow water gravity waves. At very short wavelengths, the wave period is too short for the Coriolis force to have a significant effect on the dynamics. Substituting $K = \\sqrt{k^2+l^2}$, the expression is $\\sqrt{gH(k^2+l^2)}$.\n\nThe problem asks for the ordered pair of these two leading-order asymptotic expressions.\nThe first expression is for $K \\to 0$, which is $|f|$.\nThe second expression is for $K \\to \\infty$, which is $\\sqrt{gH(k^2+l^2)}$.\n\nThe final ordered pair is $\\left(|f|, \\sqrt{gH(k^2+l^2)}\\right)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n|f| & \\sqrt{gH\\left(k^{2}+l^{2}\\right)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Translating continuous physical laws into discrete computational models requires a rigorous analysis to ensure the numerical algorithm is stable and produces physically meaningful results. This practice focuses on applying von Neumann stability analysis to the leapfrog scheme, a common method for time-stepping the shallow water equations . Successfully deriving the Courant-Friedrichs-Lewy (CFL) condition provides critical insight into how the physical wave speed $c$, grid spacing $\\Delta x$, and time step $\\Delta t$ are fundamentally linked in any explicit numerical simulation.",
            "id": "3815346",
            "problem": "Consider the linear shallow water equations on a periodic, one-dimensional, uniform domain with constant mean depth $H$ and gravitational acceleration $g$, neglecting planetary rotation and external forcing. The prognostic variables are the depth-averaged velocity $u(x,t)$ and the free-surface displacement $\\eta(x,t)$. The governing equations are\n$$\n\\frac{\\partial u}{\\partial t} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0, \n\\qquad\n\\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0,\n$$\nwith gravity wave speed $c = \\sqrt{gH}$. Discretize these equations on an Arakawa A-grid (collocated $u$ and $\\eta$) with uniform grid spacing $\\Delta x$ and time step $\\Delta t$, using a centered-in-time, centered-in-space explicit leapfrog scheme:\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - 2\\,\\Delta t\\,g\\,\\left(\\frac{\\eta_{j+1}^{n} - \\eta_{j-1}^{n}}{2\\,\\Delta x}\\right), \n\\qquad\n\\eta_{j}^{n+1} = \\eta_{j}^{n-1} - 2\\,\\Delta t\\,H\\,\\left(\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x}\\right),\n$$\nfor all interior grid indices $j$ with periodic boundary conditions.\n\nStarting from the conservation laws above as the fundamental base, perform a linear stability analysis of this fully discrete scheme under Fourier-normal-mode perturbations. Determine the sharp Courant–Friedrichs–Lewy (CFL) time-step restriction that guarantees that all Fourier modes remain bounded in time. Then, report the maximum stable time step as a single closed-form analytic expression in terms of $\\Delta x$ and $c = \\sqrt{gH}$. Express your final answer in seconds. Do not report an inequality; report only the single analytic expression for the maximum stable time step.",
            "solution": "The problem requires a linear stability analysis of the provided finite difference scheme for the one-dimensional linear shallow water equations. The analysis will be performed using a Fourier-normal-mode approach, also known as von Neumann stability analysis, to determine the Courant–Friedrichs–Lewy (CFL) condition.\n\nThe governing continuous equations are:\n$$\n\\frac{\\partial u}{\\partial t} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0, \\qquad (1)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0, \\qquad (2)\n$$\nwhere $u$ is the depth-averaged velocity, $\\eta$ is the free-surface displacement, $g$ is the gravitational acceleration, and $H$ is the constant mean depth.\n\nThe provided discrete scheme is the explicit leapfrog method on a collocated (Arakawa A-type) grid:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + g\\,\\left(\\frac{\\eta_{j+1}^{n} - \\eta_{j-1}^{n}}{2\\,\\Delta x}\\right) = 0, \\qquad (3)\n$$\n$$\n\\frac{\\eta_{j}^{n+1} - \\eta_{j}^{n-1}}{2\\,\\Delta t} + H\\,\\left(\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x}\\right) = 0. \\qquad (4)\n$$\nHere, the subscript $j$ denotes the spatial grid point index, the superscript $n$ denotes the time level index, $\\Delta x$ is the uniform grid spacing, and $\\Delta t$ is the uniform time step.\n\nTo perform the stability analysis, we introduce Fourier-normal-mode trial solutions of the form:\n$$\nu_j^n = \\hat{u} G^n e^{i k j \\Delta x}\n$$\n$$\n\\eta_j^n = \\hat{\\eta} G^n e^{i k j \\Delta x}\n$$\nwhere $k$ is the wavenumber, $i = \\sqrt{-1}$, $\\hat{u}$ and $\\hat{\\eta}$ are the constant complex amplitudes of the modes, and $G = G(k)$ is the amplification factor per time step. The scheme is stable if and only if $|G| \\le 1$ for all wavenumbers $k$.\n\nSubstituting these trial solutions into the discrete equations (3) and (4):\nFor equation (3):\n$$\n\\frac{\\hat{u} G^{n+1} e^{i k j \\Delta x} - \\hat{u} G^{n-1} e^{i k j \\Delta x}}{2\\,\\Delta t} + g\\,\\left(\\frac{\\hat{\\eta} G^n e^{i k (j+1) \\Delta x} - \\hat{\\eta} G^n e^{i k (j-1) \\Delta x}}{2\\,\\Delta x}\\right) = 0\n$$\nDividing by $G^{n-1} e^{i k j \\Delta x}$ (assuming it is non-zero) and simplifying yields:\n$$\n\\hat{u} \\frac{G^2 - 1}{2\\,\\Delta t} + g \\hat{\\eta} G \\left(\\frac{e^{i k \\Delta x} - e^{-i k \\Delta x}}{2\\,\\Delta x}\\right) = 0\n$$\nUsing the identity $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, this becomes:\n$$\n\\hat{u} \\frac{G^2 - 1}{2\\,\\Delta t} + g \\hat{\\eta} G \\frac{2i\\sin(k \\Delta x)}{2\\,\\Delta x} = 0\n$$\n$$\n(G^2 - 1)\\hat{u} + \\frac{2i g \\Delta t \\sin(k \\Delta x)}{\\Delta x} G \\hat{\\eta} = 0 \\qquad (5)\n$$\n\nSimilarly, for equation (4):\n$$\n\\frac{\\hat{\\eta} G^{n+1} e^{i k j \\Delta x} - \\hat{\\eta} G^{n-1} e^{i k j \\Delta x}}{2\\,\\Delta t} + H\\,\\left(\\frac{\\hat{u} G^n e^{i k (j+1) \\Delta x} - \\hat{u} G^n e^{i k (j-1) \\Delta x}}{2\\,\\Delta x}\\right) = 0\n$$\nDividing by $G^{n-1} e^{i k j \\Delta x}$ and simplifying:\n$$\n\\hat{\\eta} \\frac{G^2 - 1}{2\\,\\Delta t} + H \\hat{u} G \\left(\\frac{e^{i k \\Delta x} - e^{-i k \\Delta x}}{2\\,\\Delta x}\\right) = 0\n$$\n$$\n\\frac{2i H \\Delta t \\sin(k \\Delta x)}{\\Delta x} G \\hat{u} + (G^2 - 1)\\hat{\\eta} = 0 \\qquad (6)\n$$\n\nEquations (5) and (6) form a homogeneous linear system for the amplitudes $\\hat{u}$ and $\\hat{\\eta}$:\n$$\n\\begin{pmatrix}\nG^2 - 1 & \\frac{2i g \\Delta t \\sin(k \\Delta x)}{\\Delta x} G \\\\\n\\frac{2i H \\Delta t \\sin(k \\Delta x)}{\\Delta x} G & G^2 - 1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\hat{u} \\\\\n\\hat{\\eta}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFor a non-trivial solution $(\\hat{u}, \\hat{\\eta}) \\neq (0, 0)$ to exist, the determinant of the coefficient matrix must be zero:\n$$\n(G^2 - 1)^2 - \\left(\\frac{2i g \\Delta t \\sin(k \\Delta x)}{\\Delta x} G\\right) \\left(\\frac{2i H \\Delta t \\sin(k \\Delta x)}{\\Delta x} G\\right) = 0\n$$\n$$\n(G^2 - 1)^2 - (2i)^2 \\frac{g H (\\Delta t)^2}{(\\Delta x)^2} \\sin^2(k \\Delta x) G^2 = 0\n$$\n$$\n(G^2 - 1)^2 - (-4) \\frac{g H (\\Delta t)^2}{(\\Delta x)^2} \\sin^2(k \\Delta x) G^2 = 0\n$$\n$$\n(G^2 - 1)^2 + 4 \\frac{g H (\\Delta t)^2}{(\\Delta x)^2} \\sin^2(k \\Delta x) G^2 = 0\n$$\nLet's define the gravity wave speed $c = \\sqrt{gH}$ and the Courant number $\\sigma = \\frac{c\\Delta t}{\\Delta x}$. The equation becomes:\n$$\n(G^2 - 1)^2 + 4 \\sigma^2 \\sin^2(k \\Delta x) G^2 = 0\n$$\nTaking the square root of both sides gives:\n$$\nG^2 - 1 = \\pm \\sqrt{-4 \\sigma^2 \\sin^2(k \\Delta x) G^2} = \\pm 2i \\sigma \\sin(k \\Delta x) G\n$$\nThis gives a quadratic equation for $G$:\n$$\nG^2 \\mp \\left(2i \\sigma \\sin(k \\Delta x)\\right) G - 1 = 0\n$$\nUsing the quadratic formula, the solutions for $G$ are:\n$$\nG = \\frac{\\pm 2i \\sigma \\sin(k \\Delta x) \\pm \\sqrt{(-2i \\sigma \\sin(k \\Delta x))^2 - 4(1)(-1)}}{2}\n$$\n$$\nG = \\pm i \\sigma \\sin(k \\Delta x) \\pm \\sqrt{1 - \\sigma^2 \\sin^2(k \\Delta x)}\n$$\nFor stability, we require $|G| \\le 1$ for all wavenumbers $k$. Let's analyze the argument of the square root.\n\nCase 1: $1 - \\sigma^2 \\sin^2(k \\Delta x) \\ge 0$.\nThis is equivalent to $|\\sigma \\sin(k \\Delta x)| \\le 1$. In this case, the square root term is real. Let $\\alpha = \\sigma \\sin(k \\Delta x)$. The solutions for $G$ are of the form $G = \\pm i\\alpha \\pm \\sqrt{1 - \\alpha^2}$. The modulus of $G$ is:\n$$\n|G|^2 = (\\pm \\sqrt{1 - \\alpha^2})^2 + (\\pm \\alpha)^2 = (1 - \\alpha^2) + \\alpha^2 = 1\n$$\nSo, $|G| = 1$. The modes are neutrally stable, their amplitude does not grow.\n\nCase 2: $1 - \\sigma^2 \\sin^2(k \\Delta x) < 0$.\nThis is equivalent to $|\\sigma \\sin(k \\Delta x)| > 1$. The term under the square root is negative, so its root is imaginary. Let $\\alpha = \\sigma \\sin(k \\Delta x)$.\n$$\nG = \\pm i \\alpha \\pm \\sqrt{-(\\alpha^2 - 1)} = \\pm i \\alpha \\pm i \\sqrt{\\alpha^2 - 1} = i(\\pm \\alpha \\pm \\sqrt{\\alpha^2 - 1})\n$$\nThe amplification factor $G$ is purely imaginary. Let's examine its magnitude. Consider one of the roots, for instance, with the positive signs: $G = i(\\alpha + \\sqrt{\\alpha^2 - 1})$. If we assume $\\alpha > 1$, then its magnitude is $|G| = \\alpha + \\sqrt{\\alpha^2 - 1}$. Since $\\alpha > 1$, $\\alpha^2 > 1$, and $\\sqrt{\\alpha^2 - 1} > 0$. Thus, $|G| > 1$. This corresponds to an exponentially growing, unstable mode. A similar argument holds if $\\alpha < -1$ for another of the four roots.\n\nTherefore, for the scheme to be stable for any given mode $k$, we must be in Case 1, which requires:\n$$\n|\\sigma \\sin(k \\Delta x)| \\le 1\n$$\nThis condition must hold for all possible wavenumbers $k$ that can be represented on the grid. The most restrictive case occurs when $|\\sin(k \\Delta x)|$ reaches its maximum value, which is $1$. This happens for the shortest resolvable wavelength (the $2\\Delta x$ wave), where $k \\Delta x = \\pi/2$.\nTo ensure stability for all modes, we must satisfy:\n$$\n|\\sigma| \\times \\max_k|\\sin(k \\Delta x)| \\le 1\n$$\n$$\n|\\sigma| \\times 1 \\le 1 \\implies |\\sigma| \\le 1\n$$\nSince the Courant number $\\sigma = \\frac{c\\Delta t}{\\Delta x}$ is defined with positive quantities, this simplifies to:\n$$\n\\frac{c\\Delta t}{\\Delta x} \\le 1\n$$\nThis is the Courant–Friedrichs–Lewy (CFL) stability condition for this scheme. The problem asks for the maximum stable time step, $\\Delta t_{max}$. This is found when the equality holds:\n$$\n\\frac{c \\Delta t_{max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{max}$ gives:\n$$\n\\Delta t_{max} = \\frac{\\Delta x}{c}\n$$\nThis is the sharpest possible restriction, providing the maximum time step for which all Fourier modes remain bounded.",
            "answer": "$$\\boxed{\\frac{\\Delta x}{c}}$$"
        },
        {
            "introduction": "A robust numerical simulation requires not only a stable core algorithm but also effective boundary conditions that prevent non-physical wave reflections. This capstone practice challenges you to build a one-dimensional numerical model of the linear shallow water equations, complete with a \"sponge layer\" designed to absorb incident wave energy and mimic an open or infinite domain . By implementing and testing this absorbing layer, you will integrate physical theory with practical coding, learning to quantify a model's performance by calculating reflection coefficients and tackling a ubiquitous problem in computational fluid dynamics.",
            "id": "3815408",
            "problem": "You are tasked with constructing and evaluating an absorbing (sponge) layer for the Linear Shallow Water Equations (LSWE) in one spatial dimension. The LSWE arise from Newton’s second law applied to a hydrostatic, inviscid, shallow fluid layer and the vertically integrated mass conservation. In one spatial dimension, with constant mean depth $H$ and gravitational acceleration $g$, small free-surface displacement $\\eta(x,t)$, and depth-averaged velocity $u(x,t)$, the linearized system without forcing is governed by the momentum and continuity equations. To model an absorbing layer, you will augment the equations with spatially varying linear damping terms that act within a finite region near the right boundary of the computational domain.\n\nYour program must discretize and time-integrate the LSWE with an absorbing layer and estimate reflection coefficients for incident rightward-propagating gravity waves that encounter the sponge. The simulation must be expressed in purely mathematical terms, and the numerical outputs must be dimensionless floats. All physical quantities must be expressed in the specified units.\n\n1. Governing equations and absorbing layer:\n   - The one-dimensional LSWE with spatially varying linear damping are\n     $$\\frac{\\partial u}{\\partial t} = -\\,g\\,\\frac{\\partial \\eta}{\\partial x} \\,-\\, \\sigma(x)\\,u,$$\n     $$\\frac{\\partial \\eta}{\\partial t} = -\\,H\\,\\frac{\\partial u}{\\partial x} \\,-\\, \\sigma(x)\\,\\eta,$$\n     where $u(x,t)$ is in $\\mathrm{m\\,s^{-1}}$, $\\eta(x,t)$ is in $\\mathrm{m}$, $g$ is in $\\mathrm{m\\,s^{-2}}$, $H$ is in $\\mathrm{m}$, and $\\sigma(x)$ is in $\\mathrm{s^{-1}}$. The damping coefficient $\\sigma(x)$ is identically zero outside the sponge region and increases smoothly from zero at the interior-sponge interface to a prescribed maximum within the sponge.\n\n2. Computational domain and discretization:\n   - Use a periodic one-dimensional domain $x \\in [0,L)$ of length $L$ in $\\mathrm{m}$, discretized with $N_x$ uniformly spaced points. Use second-order centered finite differences for spatial derivatives with periodic indexing. Use an explicit, stable time integrator for the semi-discrete system. The time step $\\Delta t$ must satisfy a Courant–Friedrichs–Lewy (CFL) condition based on the wave speed derived from the LSWE to ensure stability.\n\n3. Incident wave packet:\n   - Initialize a rightward-propagating gravity wave packet:\n     $$\\eta(x,0) = A \\,\\cos\\!\\big(k\\,(x-x_0)\\big)\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\,\\sigma_x^2}\\right),$$\n     with amplitude $A$ in $\\mathrm{m}$, carrier wavenumber $k$ in $\\mathrm{rad\\,m^{-1}}$, center $x_0$ in $\\mathrm{m}$, and Gaussian width $\\sigma_x$ in $\\mathrm{m}$. Choose the initial velocity $u(x,0)$ consistent with a rightward-propagating gravity wave implied by the LSWE’s characteristic structure. All angles are implicitly in radians.\n\n4. Absorbing layer (sponge) specification:\n   - The sponge occupies the interval $x \\in [L-W,\\,L)$, where $W$ is the sponge width in $\\mathrm{m}$. Within this interval, define\n     $$\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x-(L-W)}{W}\\right)^n,$$\n     for $x \\in [L-W,L)$ and zero otherwise, with exponent $n \\ge 2$ to ensure smoothness at the interface ($n=2$ is acceptable). Here $\\sigma_{\\max}$ is the peak damping in $\\mathrm{s^{-1}}$.\n\n5. Reflection coefficient estimation:\n   - Derive the rightward- and leftward-propagating characteristic combinations of $u$ and $\\eta$ implied by the LSWE’s eigenstructure. Use these to define an incident amplitude time series and a reflected amplitude time series at a fixed probe location $x_p$ that lies just inside the interior side of the sponge (for example $x_p=L-W-\\alpha W$ with $0<\\alpha<1$). Estimate the incident amplitude by the maximum absolute value of the rightward-propagating characteristic combination observed at $x_p$ before the wave interacts with the sponge. Estimate the reflected amplitude by the maximum absolute value of the leftward-propagating characteristic combination observed at $x_p$ after the wave has interacted with the sponge. The reflection coefficient $\\mathcal{R}$ is the ratio of reflected amplitude to incident amplitude and is dimensionless.\n\n6. Physical and numerical parameters (use these values unless otherwise specified):\n   - Domain length: $L = 2000\\,\\mathrm{m}$.\n   - Grid points: $N_x = 512$.\n   - Depth: $H = 50\\,\\mathrm{m}$.\n   - Gravity: $g = 9.81\\,\\mathrm{m\\,s^{-2}}$.\n   - Incident packet amplitude: $A = 0.05\\,\\mathrm{m}$.\n   - Carrier wavelength: $\\lambda = 200\\,\\mathrm{m}$, so $k = 2\\pi/\\lambda$ in $\\mathrm{rad\\,m^{-1}}$.\n   - Packet center: $x_0 = 500\\,\\mathrm{m}$.\n   - Gaussian width: $\\sigma_x = 200\\,\\mathrm{m}$.\n   - Characteristic probe location: $x_p = L - W - 0.25\\,W$ (if $W=0$ use $x_p = 1500\\,\\mathrm{m}$).\n   - Time step: choose $\\Delta t$ using a CFL number of $0.45$ based on the LSWE gravity wave speed you derive from first principles.\n   - Final time: choose a simulation end time sufficient to capture the incident and reflected signals at $x_p$ without contamination by wrap-around due to periodicity. A physically justified constant end time across tests is acceptable provided it exceeds the round-trip travel time from $x_0$ to the sponge and back to $x_p$.\n\n7. Test suite:\n   - Run the program for the following four parameter sets to assess different absorbing layer configurations:\n     - Test $1$: $W = 400\\,\\mathrm{m}$, $\\sigma_{\\max} = 0.20\\,\\mathrm{s^{-1}}$, $n = 2$.\n     - Test $2$: $W = 400\\,\\mathrm{m}$, $\\sigma_{\\max} = 0.00\\,\\mathrm{s^{-1}}$, $n = 2$.\n     - Test $3$: $W = 100\\,\\mathrm{m}$, $\\sigma_{\\max} = 1.00\\,\\mathrm{s^{-1}}$, $n = 2$.\n     - Test $4$: $W = 800\\,\\mathrm{m}$, $\\sigma_{\\max} = 0.50\\,\\mathrm{s^{-1}}$, $n = 2$.\n\n8. Required outputs and units:\n   - For each test, compute the reflection coefficient $\\mathcal{R}$ (dimensionless) at $x_p$. Express the final outputs as dimensionless floats rounded to six decimal places. No physical units should be attached to the numeric outputs.\n\n9. Final output format:\n   - Your program should produce a single line of output containing the reflection coefficients for the four tests as a comma-separated list enclosed in square brackets (for example, $[\\mathcal{R}_1,\\mathcal{R}_2,\\mathcal{R}_3,\\mathcal{R}_4]$).\n\nYour solution must start from fundamental physical laws and core definitions, derive the relevant wave speed and characteristic structure needed to separate incident and reflected components, motivate the spatially varying linear damping as an absorbing layer, and justify the numerical discretization and stability conditions. The code must be complete and runnable without any external input, using the specified numerical values and producing the required single-line output. All angles are in radians, and all physical quantities must use the specified units. The final answers must be floats as described in item $9$.",
            "solution": "The problem requires the construction and analysis of a numerical model for the one-dimensional Linear Shallow Water Equations (LSWE) incorporating an absorbing sponge layer. The goal is to compute the reflection coefficient of this layer for an incident gravity wave packet. The solution involves several stages: theoretical analysis of the governing equations, development of a numerical scheme, and implementation of the simulation to evaluate the sponge layer's performance under various parameter settings.\n\nFirst, we analyze the governing equations. The LSWE in one dimension for a fluid of constant mean depth $H$ are given by:\n$$\n\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x} - \\sigma(x)\\,u\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} = -H\\,\\frac{\\partial u}{\\partial x} - \\sigma(x)\\,\\eta\n$$\nHere, $u(x,t)$ is the depth-averaged horizontal velocity, $\\eta(x,t)$ is the free-surface elevation, $g$ is the acceleration due to gravity, and $\\sigma(x)$ is a spatially-dependent damping coefficient. The terms involving $\\sigma(x)$ represent a sponge layer designed to absorb wave energy and prevent reflections from the computational boundary.\n\nTo understand the wave propagation and to properly initialize the simulation, we must analyze the characteristic structure of the undamped system (where $\\sigma(x) = 0$). We can write the system in matrix form as $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}$, where $\\mathbf{q} = [u, \\eta]^T$ and the matrix $\\mathbf{A}$ is:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & g \\\\ H & 0 \\end{pmatrix}\n$$\nThe eigenvalues of $\\mathbf{A}$ give the characteristic wave speeds. They are the roots of $\\det(\\mathbf{A} - c\\mathbf{I}) = 0$, which yields $c^2 - gH = 0$. The eigenvalues are thus $c = \\pm\\sqrt{gH}$. These represent the speeds of rightward- and leftward-propagating gravity waves.\n\nThe left eigenvectors of $\\mathbf{A}$ are used to find the characteristic variables (or Riemann invariants), which are quantities that are conserved along the characteristic curves $dx/dt = c$. For the eigenvalue $c_1 = +\\sqrt{gH}$, the left eigenvector is $\\mathbf{l}_1^T = [1, \\sqrt{g/H}]$. For $c_2 = -\\sqrt{gH}$, the left eigenvector is $\\mathbf{l}_2^T = [1, -\\sqrt{g/H}]$. The characteristic variables are linear combinations of $u$ and $\\eta$ formed using these eigenvectors:\n$$\nR^+ = u + \\sqrt{\\frac{g}{H}}\\eta \\quad \\text{(propagates rightward at speed } +\\sqrt{gH} \\text{)}\n$$\n$$\nR^- = u - \\sqrt{\\frac{g}{H}}\\eta \\quad \\text{(propagates leftward at speed } -\\sqrt{gH} \\text{)}\n$$\nThese relationships are fundamental for both initializing a purely directional wave and for separating incident and reflected waves in the analysis.\n\nThe problem specifies an initial free-surface displacement $\\eta(x,0)$ corresponding to a wave packet. To create a purely rightward-propagating wave, the leftward-propagating characteristic $R^-$ must be initially zero everywhere. This implies $u(x,0) - \\sqrt{g/H}\\eta(x,0) = 0$, which gives the required initial condition for the velocity:\n$$\nu(x,0) = \\sqrt{\\frac{g}{H}}\\eta(x,0)\n$$\nWith the given $\\eta(x,0) = A \\cos(k(x-x_0))\\exp(-\\frac{(x-x_0)^2}{2\\sigma_x^2})$, the initial state of the system is fully defined.\n\nNext, we establish the numerical framework. The domain $x \\in [0, L)$ is discretized into $N_x$ grid points $x_j = j \\Delta x$ for $j=0, \\dots, N_x-1$, with grid spacing $\\Delta x = L/N_x$. The boundary conditions are periodic. Spatial derivatives are approximated using second-order centered finite differences:\n$$\n\\left(\\frac{\\partial f}{\\partial x}\\right)_j \\approx \\frac{f_{j+1} - f_{j-1}}{2\\Delta x}\n$$\nwhere indices are handled periodically (e.g., $f_{N_x} = f_0$, $f_{-1} = f_{N_x-1}$). This transforms the partial differential equations into a large system of coupled ordinary differential equations (ODEs) in time, $\\frac{d\\mathbf{Q}}{dt} = \\mathcal{L}(\\mathbf{Q})$, where $\\mathbf{Q}$ is the state vector of all $u_j$ and $\\eta_j$.\n\nThis system of ODEs is integrated forward in time using an explicit scheme. A third-order Runge-Kutta (RK3) method is suitable, offering a good balance of accuracy and stability. For a generic ODE $\\frac{dy}{dt} = F(y, t)$, the RK3 update from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ is:\n$$\ny^{(1)} = y_n + \\Delta t F(y_n, t_n)\n$$\n$$\ny^{(2)} = \\frac{3}{4}y_n + \\frac{1}{4}y^{(1)} + \\frac{1}{4}\\Delta t F(y^{(1)}, t_n + \\Delta t)\n$$\n$$\ny_{n+1} = \\frac{1}{3}y_n + \\frac{2}{3}y^{(2)} + \\frac{2}{3}\\Delta t F(y^{(2)}, t_n + \\frac{1}{2}\\Delta t)\n$$\nThe stability of this explicit scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition, which requires that the numerical domain of dependence contain the physical domain of dependence. For the LSWE, this dictates the maximum allowable time step $\\Delta t$:\n$$\n\\Delta t \\le \\text{CFL} \\frac{\\Delta x}{c} = \\text{CFL} \\frac{\\Delta x}{\\sqrt{gH}}\n$$\nA CFL number of $0.45$ is specified, ensuring stability.\n\nThe sponge layer is defined by the damping profile $\\sigma(x)$. For $x$ in the sponge region $[L-W, L)$, the coefficient is $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x-(L-W)}{W}\\right)^n$. The exponent $n=2$ ensures that $\\sigma(x)$ and its first derivative are zero at the interior interface $x=L-W$, which helps to reduce spurious reflections generated by an abrupt start to the damping region.\n\nTo quantify the sponge layer's effectiveness, we calculate the reflection coefficient $\\mathcal{R}$. A probe is placed at location $x_p$ just outside the sponge. At this location, we record the time series of the rightward- and leftward-propagating characteristics, $R^+(x_p, t)$ and $R^-(x_p, t)$. The incident wave packet will pass $x_p$ traveling rightward, contributing primarily to $R^+$. After interacting with the sponge layer, any reflected part of the wave will travel leftward past $x_p$, contributing to $R^-$.\nThe incident amplitude $A_{inc}$ is the maximum absolute value of $R^+$ observed at $x_p$ during the passage of the initial wave packet. The reflected amplitude $A_{refl}$ is the maximum absolute value of $R^-$ observed after the interaction. The reflection coefficient is the ratio $\\mathcal{R} = A_{refl}/A_{inc}$. To distinguish between the \"before\" and \"after\" periods, we define a split time $T_{split}$. This time is calculated as the midpoint between the expected arrival time of the incident packet's peak at $x_p$ and the expected arrival time of the reflected packet's peak at $x_p$, assuming reflection from the sponge's leading edge.\n\nThe simulation proceeds for a total time $T_{final}$, chosen to be long enough to capture both the incident and reflected signals at all relevant probe locations, but short enough to prevent the primary wave packet from circumnavigating the periodic domain and contaminating the reflected signal. A time of $T_{final} = 85\\,\\text{s}$ is sufficient for the given parameters. The simulation is run for each of the four test cases provided, and the corresponding reflection coefficient $\\mathcal{R}$ is calculated and reported.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    # Physical and numerical parameters from the problem statement\n    params = {\n        'L': 2000.0,      # Domain length (m)\n        'Nx': 512,        # Number of grid points\n        'H': 50.0,        # Mean depth (m)\n        'g': 9.81,        # Gravitational acceleration (m/s^2)\n        'A': 0.05,        # Incident packet amplitude (m)\n        'wavelength': 200.0, # Carrier wavelength (m)\n        'x0': 500.0,      # Packet center (m)\n        'sigma_x': 200.0, # Gaussian width (m)\n        'cfl_number': 0.45,\n        't_final': 85.0   # Total simulation time (s)\n    }\n\n    # Test cases for the absorbing layer\n    test_cases = [\n        {'W': 400.0, 'sigma_max': 0.20, 'n': 2},\n        {'W': 400.0, 'sigma_max': 0.00, 'n': 2},\n        {'W': 100.0, 'sigma_max': 1.00, 'n': 2},\n        {'W': 800.0, 'sigma_max': 0.50, 'n': 2}\n    ]\n\n    results = []\n    for test_params in test_cases:\n        # Combine base parameters with test-specific parameters\n        current_params = params.copy()\n        current_params.update(test_params)\n        \n        # Calculate reflection coefficient for the current case\n        R_coeff = run_simulation(**current_params)\n        results.append(np.round(R_coeff, 6))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef run_simulation(L, Nx, H, g, A, wavelength, x0, sigma_x, cfl_number, t_final, W, sigma_max, n):\n    \"\"\"\n    Performs a single simulation run for a given set of parameters.\n    \"\"\"\n    # 1. Setup grid and derived parameters\n    dx = L / Nx\n    x = np.linspace(0, L, Nx, endpoint=False)\n    c = np.sqrt(g * H)\n    dt = cfl_number * dx / c\n    k = 2 * np.pi / wavelength\n\n    # 2. Initial conditions\n    eta_0 = A * np.cos(k * (x - x0)) * np.exp(-((x - x0)**2) / (2 * sigma_x**2))\n    u_0 = np.sqrt(g / H) * eta_0\n    \n    eta = eta_0.copy()\n    u = u_0.copy()\n\n    # 3. Absorbing layer (sponge) specification\n    sigma = np.zeros(Nx)\n    if W > 0:\n        sponge_start_x = L - W\n        is_in_sponge = x >= sponge_start_x\n        sigma[is_in_sponge] = sigma_max * ((x[is_in_sponge] - sponge_start_x) / W)**n\n\n    # 4. Probe location and analysis setup\n    if W == 0:\n        xp = 1500.0\n    else:\n        xp = L - W - 0.25 * W\n    xp_idx = np.argmin(np.abs(x - xp))\n    \n    # Time splitting for incident/reflected analysis\n    t_inc_arrival = (xp - x0) / c\n    sponge_interface = L - W\n    t_refl_arrival = ((sponge_interface - x0) + (sponge_interface - xp)) / c\n    t_split = (t_inc_arrival + t_refl_arrival) / 2.0\n\n    # History arrays for characteristic variables at probe\n    num_steps = int(t_final / dt)\n    time_hist = np.linspace(0, t_final, num_steps)\n    R_plus_hist = []\n    R_minus_hist = []\n\n    # 5. Time integration loop (RK3)\n    def rhs(u_in, eta_in, sigma_in, dx_in):\n        # Calculate spatial derivatives with periodic boundary conditions\n        u_dx = (np.roll(u_in, -1) - np.roll(u_in, 1)) / (2 * dx_in)\n        eta_dx = (np.roll(eta_in, -1) - np.roll(eta_in, 1)) / (2 * dx_in)\n        \n        # RHS of the governing equations\n        du_dt = -g * eta_dx - sigma_in * u_in\n        deta_dt = -H * u_dx - sigma_in * eta_in\n        return du_dt, deta_dt\n\n    for i in range(num_steps):\n        # Store characteristic variables at probe location\n        R_plus_hist.append(u[xp_idx] + np.sqrt(g / H) * eta[xp_idx])\n        R_minus_hist.append(u[xp_idx] - np.sqrt(g / H) * eta[xp_idx])\n\n        # RK3 Stage 1\n        du1, deta1 = rhs(u, eta, sigma, dx)\n        u1 = u + dt * du1\n        eta1 = eta + dt * deta1\n        \n        # RK3 Stage 2\n        du2, deta2 = rhs(u1, eta1, sigma, dx)\n        u2 = 0.75 * u + 0.25 * u1 + 0.25 * dt * du2\n        eta2 = 0.75 * eta + 0.25 * eta1 + 0.25 * dt * deta2\n        \n        # RK3 Stage 3\n        du3, deta3 = rhs(u2, eta2, sigma, dx)\n        u_new = (1/3) * u + (2/3) * u2 + (2/3) * dt * du3\n        eta_new = (1/3) * eta + (2/3) * eta2 + (2/3) * dt * deta3\n        \n        u, eta = u_new, eta_new\n\n    # 6. Reflection coefficient estimation\n    R_plus_hist = np.array(R_plus_hist)\n    R_minus_hist = np.array(R_minus_hist)\n    \n    incident_mask = time_hist < t_split\n    reflected_mask = time_hist > t_split\n    \n    # Handle cases where mask might be empty\n    if np.any(incident_mask):\n        incident_amplitude = np.max(np.abs(R_plus_hist[incident_mask]))\n    else:\n        incident_amplitude = 0\n    \n    if np.any(reflected_mask):\n        reflected_amplitude = np.max(np.abs(R_minus_hist[reflected_mask]))\n    else:\n        reflected_amplitude = 0\n\n    if incident_amplitude == 0:\n        reflection_coeff = 0.0 # Or np.nan, but 0 seems more appropriate\n    else:\n        reflection_coeff = reflected_amplitude / incident_amplitude\n        \n    return reflection_coeff\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}