{
    "hands_on_practices": [
        {
            "introduction": "正压涡度方程最重要和最优雅的应用之一是解释风生大洋环流。这个练习将引导你应用斯维尔德鲁普关系（Sverdrup relation），这是一个从涡度方程简化而来的强大诊断工具，用于计算海洋内部由风应力旋度驱动的经向速度。通过使用真实的海洋学参数进行计算，你将亲身体验理论如何转化为对大规模海洋现象的定量理解。",
            "id": "3813697",
            "problem": "考虑一个位于$\\beta$平面上的矩形中纬度海洋内部，其参考密度$\\rho_{0}$为常数，深度$H$为均匀。假设海洋处于稳定、Boussinesq、静力平衡状态，其内部的涡度平衡由远离边界的深度积分、线性、正压涡度动力学控制。风应力纯粹是纬向的，并随经向变化如下\n$$\n\\tau_{x}(y) \\;=\\; \\tau_{0}\\,\\sin\\!\\left(\\frac{2\\pi\\, y}{L_{y}}\\right), \n\\qquad \n\\tau_{y}(x,y)\\;=\\;0,\n$$\n对于 $0 \\le y \\le L_{y}$，其中 $\\tau_{0} > 0$。使用亚热带环流内部的典型参数：\n$$\n\\beta \\;=\\; 2.0 \\times 10^{-11}\\ \\mathrm{m}^{-1}\\,\\mathrm{s}^{-1},\\quad \n\\rho_{0} \\;=\\; 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3},\\quad \nH \\;=\\; 4000\\ \\mathrm{m},\\quad \n\\tau_{0} \\;=\\; 0.10\\ \\mathrm{N}\\,\\mathrm{m}^{-2},\\quad \nL_{y} \\;=\\; 3.0 \\times 10^{6}\\ \\mathrm{m}.\n$$\n\n从适用于此背景的适当的深度积分定律出发，推导连接深度平均经向速度$v(y)$与风应力旋度的稳定内部关系。然后，使用该关系式，计算在$y = L_{y}/3$处的内部深度平均经向速度。将最终数值答案四舍五入至四位有效数字，并以$\\mathrm{m}\\,\\mathrm{s}^{-1}$为单位表示。在推导过程中，清楚地说明允许忽略某些项的假设，并简要解释在此内部平衡中$v$的大小如何依赖于$H$。",
            "solution": "经评估，该问题具有科学依据，提法得当，客观，并包含完整且一致的设定。参数在指定的海洋学背景下是物理上现实的。因此，该问题被认为是有效的，可以构建完整的解答。\n\n该问题要求从$\\beta$平面上正压海洋的控制动力学中推导稳定的内部经向速度。出发点是Boussinesq流体的水平动量方程组，通过稳态（$\\frac{\\partial}{\\partial t} = 0$）和线性动力学（忽略平流项）的假设进行简化。\n\n线性化的稳态水平动量方程为：\n$$\n-f v = -\\frac{1}{\\rho_0}\\frac{\\partial p}{\\partial x} + \\frac{1}{\\rho_0}\\frac{\\partial \\tau_x}{\\partial z}\n$$\n$$\nf u = -\\frac{1}{\\rho_0}\\frac{\\partial p}{\\partial y} + \\frac{1}{\\rho_0}\\frac{\\partial \\tau_y}{\\partial z}\n$$\n其中$u$和$v$是纬向和经向速度，$f = f_0 + \\beta y$是$\\beta$平面上的科里奥利参数，$p$是压力，$\\rho_0$是恒定的参考密度，$\\tau_x$和$\\tau_y$是粘性应力的水平分量。\n\n我们将这些方程在海洋的整个深度上进行积分，从底部的$z = -H$到表面的$z=0$。让我们定义深度积分输运（或体积输运）为$U = \\int_{-H}^{0} u \\,dz$和$V = \\int_{-H}^{0} v \\,dz$。那么深度平均速度为$\\bar{u} = U/H$和$\\bar{v} = V/H$。对于正压流，$u$和$v$与深度无关，所以$U = uH$和$V = vH$。问题要求的是深度平均速度，在最后步骤中我们将其简单记为$v(y)$，与问题陈述保持一致。\n\n对动量方程进行积分得到：\n$$\n-f \\int_{-H}^{0} v \\,dz = -\\frac{1}{\\rho_0}\\int_{-H}^{0} \\frac{\\partial p}{\\partial x} \\,dz + \\frac{1}{\\rho_0}\\int_{-H}^{0} \\frac{\\partial \\tau_x}{\\partial z} \\,dz\n$$\n$$\nf \\int_{-H}^{0} u \\,dz = -\\frac{1}{\\rho_0}\\int_{-H}^{0} \\frac{\\partial p}{\\partial y} \\,dz + \\frac{1}{\\rho_0}\\int_{-H}^{0} \\frac{\\partial \\tau_y}{\\partial z} \\,dz\n$$\n它们变为：\n$$\n-fV = -\\frac{1}{\\rho_0}\\frac{\\partial P}{\\partial x} + \\frac{1}{\\rho_0}\\left[\\tau_x(z=0) - \\tau_x(z=-H)\\right]\n$$\n$$\nfU = -\\frac{1}{\\rho_0}\\frac{\\partial P}{\\partial y} + \\frac{1}{\\rho_0}\\left[\\tau_y(z=0) - \\tau_y(z=-H)\\right]\n$$\n其中$P = \\int_{-H}^{0} p \\,dz$是深度积分压力。表面的应力是风应力，$\\vec{\\tau}_{\\text{wind}} = (\\tau_x(z=0), \\tau_y(z=0))$，这是已知的。在海洋内部，一个标准的假设是底部摩擦可以忽略不计，因此$\\tau_x(z=-H)=0$和$\\tau_y(z=-H)=0$。方程简化为：\n$$\n-fV = -\\frac{1}{\\rho_0}\\frac{\\partial P}{\\partial x} + \\frac{\\tau_x}{\\rho_0}\n$$\n$$\nfU = -\\frac{1}{\\rho_0}\\frac{\\partial P}{\\partial y} + \\frac{\\tau_y}{\\rho_0}\n$$\n其中$\\tau_x$和$\\tau_y$现在代表表面风应力分量。\n\n为了获得涡度平衡，我们对这些输运方程取旋度：即第二个方程对$\\frac{\\partial}{\\partial x}$求导，减去第一个方程对$\\frac{\\partial}{\\partial y}$求导。\n$$\n\\frac{\\partial}{\\partial x}(fU) - \\frac{\\partial}{\\partial y}(-fV) = -\\frac{1}{\\rho_0}\\left(\\frac{\\partial^2 P}{\\partial x \\partial y} - \\frac{\\partial^2 P}{\\partial y \\partial x}\\right) + \\frac{1}{\\rho_0}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right)\n$$\n压力项消失，因为偏导数可以交换次序（$\\frac{\\partial^2 P}{\\partial x \\partial y} = \\frac{\\partial^2 P}{\\partial y \\partial x}$）。右边变为$\\frac{1}{\\rho_0} \\mathrm{curl}_z(\\vec{\\tau})$。左边展开为：\n$$\n\\frac{\\partial}{\\partial x}(fU) + \\frac{\\partial}{\\partial y}(fV) = f\\left(\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y}\\right) + U\\frac{\\partial f}{\\partial x} + V\\frac{\\partial f}{\\partial y}\n$$\n对于底部平坦的正压流体，深度积分的连续性方程（$\\int_{-H}^0 (\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z}) dz = 0$）简化为$\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = 0$。此外，在$\\beta$平面上，$f$仅随纬度$y$变化，因此$\\frac{\\partial f}{\\partial x} = 0$且$\\frac{\\partial f}{\\partial y} = \\beta$。涡度平衡因此简化为：\n$$\n\\beta V = \\frac{1}{\\rho_0}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right) \\equiv \\frac{1}{\\rho_0} \\mathrm{curl}_z(\\vec{\\tau})\n$$\n这就是Sverdrup关系，它将内部经向质量输运与风应力的旋度联系起来。\n\n问题要求的是深度平均经向速度，$v(y) = V(y)/H$（因为对于正压流，速度与深度无关）。因此关系式为：\n$$\nv(y) = \\frac{1}{\\beta \\rho_0 H} \\left( \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y} \\right)\n$$\n这就是所求的内部关系式。此推导中作出的关键假设是：稳态、线性动力学（小Rossby数）、$\\beta$平面近似、可忽略的底部摩擦以及平坦的海底（$H$为常数）。\n\n关于$v$对$H$的依赖性，该关系表明，对于给定的风应力旋度，经向速度的大小$|v|$与海洋深度$H$成反比。单位纬向宽度的总经向输运，$V = vH$，仅由风应力旋度和行星涡度梯度$\\beta$决定。更深的海洋可以通过较慢的深度平均速度来适应这种输运。\n\n现在我们为给定的风应力计算速度：\n$$\n\\tau_{x}(y) = \\tau_{0}\\,\\sin\\!\\left(\\frac{2\\pi\\, y}{L_{y}}\\right), \\qquad \\tau_{y}(x,y) = 0\n$$\n风应力的旋度是：\n$$\n\\mathrm{curl}_z(\\vec{\\tau}) = \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y} = \\frac{\\partial}{\\partial x}(0) - \\frac{\\partial}{\\partial y}\\left[\\tau_{0}\\,\\sin\\!\\left(\\frac{2\\pi\\, y}{L_{y}}\\right)\\right]\n$$\n$$\n\\mathrm{curl}_z(\\vec{\\tau}) = - \\tau_0 \\left( \\frac{2\\pi}{L_y} \\right) \\cos\\!\\left(\\frac{2pi\\, y}{L_{y}}\\right)\n$$\n将此代入$v(y)$的表达式中：\n$$\nv(y) = \\frac{1}{\\beta \\rho_0 H} \\left[ - \\frac{2\\pi \\tau_0}{L_y} \\cos\\!\\left(\\frac{2\\pi\\, y}{L_{y}}\\right) \\right] = - \\frac{2\\pi \\tau_0}{\\beta \\rho_0 H L_y} \\cos\\!\\left(\\frac{2\\pi\\, y}{L_{y}}\\right)\n$$\n我们需要在$y = L_y/3$处计算这个值：\n$$\nv\\left(\\frac{L_y}{3}\\right) = - \\frac{2\\pi \\tau_0}{\\beta \\rho_0 H L_y} \\cos\\!\\left(\\frac{2\\pi}{L_y} \\cdot \\frac{L_y}{3}\\right) = - \\frac{2\\pi \\tau_0}{\\beta \\rho_0 H L_y} \\cos\\!\\left(\\frac{2\\pi}{3}\\right)\n$$\n余弦项的值为$\\cos(2\\pi/3) = -1/2$。\n$$\nv\\left(\\frac{L_y}{3}\\right) = - \\frac{2\\pi \\tau_0}{\\beta \\rho_0 H L_y} \\left(-\\frac{1}{2}\\right) = \\frac{\\pi \\tau_0}{\\beta \\rho_0 H L_y}\n$$\n现在，我们代入给定的数值：\n$\\beta = 2.0 \\times 10^{-11}\\ \\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$\n$\\rho_0 = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$\n$H = 4000\\ \\mathrm{m}$\n$\\tau_0 = 0.10\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$\n$L_y = 3.0 \\times 10^{6}\\ \\mathrm{m}$\n\n$$\nv\\left(\\frac{L_y}{3}\\right) = \\frac{\\pi (0.10)}{(2.0 \\times 10^{-11})(1025)(4000)(3.0 \\times 10^6)}\n$$\n$$\nv\\left(\\frac{L_y}{3}\\right) = \\frac{0.10 \\pi}{ (2.0 \\times 1025 \\times 4000 \\times 3.0) \\times 10^{-5} } = \\frac{0.10 \\pi}{24600000 \\times 10^{-5}}\n$$\n$$\nv\\left(\\frac{L_y}{3}\\right) = \\frac{0.10 \\pi}{246} \\approx \\frac{0.314159}{246} \\approx 0.00127707\\ \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n四舍五入到四位有效数字，结果是$1.277 \\times 10^{-3}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\n\\boxed{1.277 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "将连续的流体动力学方程转化为可靠的数值模型，其核心挑战在于离散化过程。本练习将介绍在计算海洋学中广泛使用的阿拉卡瓦 C-网格（Arakawa C-grid），这是一种交错网格布局。通过分析不同变量（如流函数和速度分量）的布局方式，你将发现为何这种设计能够巧妙地在离散层面精确保持流体的无辐散性，从而为建立稳定且物理上自洽的数值模型奠定基础。",
            "id": "3813682",
            "problem": "考虑一个在具有均匀网格间距 $\\,\\Delta x\\,$ 和 $\\,\\Delta y\\,$ 的矩形周期性区域上的正压、二维、不可压缩流。令 $\\,u\\,$ 和 $\\,v\\,$ 分别表示 $\\,x\\,$ 和 $\\,y\\,$ 方向上的水平速度，$\\,\\psi\\,$ 表示流函数，$\\,\\zeta\\,$ 表示相对涡度的垂直分量。连续基本定义如下\n- 无辐散： $\\,\\partial u/\\partial x + \\partial v/\\partial y = 0\\,$，\n- 流函数： $\\,u = -\\partial \\psi/\\partial y\\,$ 和 $\\,v = \\partial \\psi/\\partial x\\,$，\n- 涡度： $\\,\\zeta = \\partial v/\\partial x - \\partial u/\\partial y\\,$。\n\n在一个均匀的有限差分网格上，考虑一种与 Arakawa C-网格族一致的交错排列：网格中心位于指标 $\\,\\left(i,j\\right)\\,$ 处，网格面位于 $\\,\\left(i+\\tfrac{1}{2},j\\right)\\,$ 和 $\\,\\left(i,j+\\tfrac{1}{2}\\right)\\,$ 处，网格角点位于 $\\,\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\\,$ 处。在网格中心 $\\,\\left(i,j\\right)\\,$ 处的离散辐散由通过面的法向通量的标准有限体积差分定义，\n$$\n\\left(\\nabla\\cdot \\boldsymbol{u}\\right)_{i,j}\n= \\frac{u_{i+\\frac{1}{2},j} - u_{i-\\frac{1}{2},j}}{\\Delta x}\n+ \\frac{v_{i,\\,j+\\frac{1}{2}} - v_{i,\\,j-\\frac{1}{2}}}{\\Delta y}\\,,\n$$\n而在角点 $\\,\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\\,$ 处的离散垂直涡度由围绕对偶网格的离散环流定义，\n$$\n\\zeta_{i+\\frac{1}{2},\\,j+\\frac{1}{2}}\n= \\frac{v_{i+1,\\,j+\\frac{1}{2}} - v_{i,\\,j+\\frac{1}{2}}}{\\Delta x}\n- \\frac{u_{i+\\frac{1}{2},\\,j+1} - u_{i+\\frac{1}{2},\\,j}}{\\Delta y}\\,.\n$$\n\n哪一个选项正确描述了 $\\,\\psi\\,$, $\\,u\\,$, $\\,v\\,$ 和 $\\,\\zeta\\,$ 的 Arakawa C-网格交错和离散化方案，该方案能确保对于任何离散的 $\\,\\psi\\,$，\n(i) 从 $\\,\\psi\\,$ 计算出的速度在上述离散意义下是精确无辐散的，并且\n(ii) 通过上述环流计算出的离散涡度是 $\\,\\nabla^2\\psi\\,$ 在同一网格位置上的二阶近似，且无需额外插值？\n\nA. 将 $\\,\\psi\\,$ 和 $\\,\\zeta\\,$ 置于网格角点 $\\,\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\\,$ 处；将 $\\,u\\,$ 置于东西向的面 $\\,\\left(i+\\tfrac{1}{2},j\\right)\\,$ 处，将 $\\,v\\,$ 置于南北向的面 $\\,\\left(i,j+\\tfrac{1}{2}\\right)\\,$ 处。通过沿每个面的中心差分从 $\\,\\psi\\,$ 计算速度，\n$$\nu_{i+\\frac{1}{2},j} = -\\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}}}{\\Delta y}\\,,\\qquad\nv_{i,\\,j+\\frac{1}{2}} = \\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}}}{\\Delta x}\\,.\n$$\n在这些选择下，$\\,\\left(i,j\\right)\\,$ 处的离散辐散恒等于零，并且 $\\,\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\\,$ 处的环流涡度等于 $\\,\\psi\\,$ 在该角点处的二阶离散拉普拉斯算子。\n\nB. 将 $\\,\\psi\\,$ 和 $\\,\\zeta\\,$ 置于网格中心 $\\,\\left(i,j\\right)\\,$ 处；将 $\\,u\\,$ 置于 $\\,\\left(i+\\tfrac{1}{2},j\\right)\\,$ 处，将 $\\,v\\,$ 置于 $\\,\\left(i,j+\\tfrac{1}{2}\\right)\\,$ 处。使用到面上的插值中心差分从 $\\,\\psi\\,$ 计算速度，例如\n$$\nu_{i+\\frac{1}{2},j} = -\\frac{1}{2}\\left[\\frac{\\psi_{i+1,\\,j+1}-\\psi_{i+1,\\,j}}{\\Delta y} + \\frac{\\psi_{i,\\,j+1}-\\psi_{i,\\,j}}{\\Delta y}\\right],\\quad\nv_{i,\\,j+\\frac{1}{2}} = \\frac{1}{2}\\left[\\frac{\\psi_{i+1,\\,j}-\\psi_{i,\\,j}}{\\Delta x} + \\frac{\\psi_{i+1,\\,j+1}-\\psi_{i,\\,j+1}}{\\Delta x}\\right].\n$$\n在这些选择下，$\\,\\left(i,j\\right)\\,$ 处的离散辐散恒等于零，并且环流涡度等于 $\\,\\psi\\,$ 在 $\\,\\left(i,j\\right)\\,$ 处的二阶离散拉普拉斯算子。\n\nC. 将 $\\,\\psi\\,$ 置于与速度分量相同的面上，即 $\\,\\psi\\,$ 对于 $\\,u\\,$ 在 $\\,\\left(i+\\tfrac{1}{2},j\\right)\\,$ 处，对于 $\\,v\\,$ 在 $\\,\\left(i,j+\\tfrac{1}{2}\\right)\\,$ 处；将 $\\,\\zeta\\,$ 保持在角点处。通过 $\\,\\psi\\,$ 沿面的单边差分来计算 $\\,u\\,$ 和 $\\,v\\,$。这种排列保持了精确无辐散，并产生与 $\\,\\psi\\,$ 同位的二阶涡度。\n\nD. 将 $\\,\\psi\\,$ 置于角点，$\\,\\zeta\\,$ 置于网格中心，而 $\\,u\\,$ 和 $\\,v\\,$ 则如 C-网格一样置于面上。通过沿面的中心差分从 $\\,\\psi\\,$ 计算速度。离散辐散随后恒等于零，并且在网格中心处的环流涡度等于无需插值的 $\\,\\psi\\,$ 的二阶离散拉普拉斯算子。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的，并且没有矛盾或含糊不清之处。它提供了一个计算流体动力学中的标准问题，涉及流函数-涡度系统在交错网格上的有限差分离散化。我们可以着手解决。\n\n任务是确定流函数 $\\psi$、水平速度 $u$ 和 $v$ 以及相对涡度 $\\zeta$ 的正确网格交错方式，以及与它们相关的离散算子，这些算子需要在 Arakawa C-网格结构上满足两个特定条件。\n\n这两个条件是：\n(i) 从流函数计算出的速度场，必须在所提供的有限体积公式的意义下是离散无辐散的。\n(ii) 从所提供的环流公式计算出的离散涡度，必须是在同一网格位置上对流函数的拉普拉斯算子 $\\nabla^2\\psi$ 的二阶近似，且无需任何空间插值。\n\n让我们分析这些条件来推导出所需的离san化方案。\n\n问题在网格角点定义了离散涡度 $\\zeta_{i+\\frac{1}{2},\\,j+\\frac{1}{2}}$，其坐标由指标 $\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right)$ 给出。条件 (ii) 要求该涡度等于在同一位置 $\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right)$ 计算的流函数的离散拉普拉斯算子 $\\nabla^2_h \\psi$，且无需插值。场的拉普拉斯算子的标准二阶五点模板是使用该场在点本身及其沿网格轴的直接邻点上的值来定义的。为了在不进行插值的情况下计算离散拉普拉斯算子 $(\\nabla^2_h \\psi)_{i+\\frac{1}{2},\\,j+\\frac{1}{2}}$，流函数 $\\psi$ 也必须定义在网格角点上，即我们必须使用 $\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}}$。这也意味着涡度 $\\zeta$ 应与 $\\psi$ 同位，都位于角点上。\n\n鉴于 $\\psi$ 位于角点 $\\left(i+\\frac{1}{2},j+\\frac{1}{2}\\right)$，我们现在可以推导出速度 $u$ 和 $v$ 的适当离散形式。Arakawa C-网格交错将 $x$-速度分量 $u$ 放置在主网格单元的垂直面（$x$ 恒定）上，位置为 $\\left(i+\\frac{1}{2},j\\right)$，将 $y$-速度分量 $v$ 放置在水平面（$y$ 恒定）上，位置为 $\\left(i,j+\\frac{1}{2}\\right)$。\n\n我们使用二阶中心差分来离散化连续关系 $u = -\\partial \\psi/\\partial y$ 和 $v = \\partial \\psi/\\partial x$，这在所选的交错方式下是可行的：\n为了求出 $\\left(i+\\frac{1}{2},j\\right)$ 处的 $u$，我们使用其上方和下方角点（即 $\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right)$ 和 $\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right)$）处的 $\\psi$ 值来计算该点上 $\\psi$ 的 $y$-导数。这得到：\n$$\nu_{i+\\frac{1}{2},j} = -\\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}}}{\\Delta y}\n$$\n为了求出 $\\left(i,j+\\frac{1}{2}\\right)$ 处的 $v$，我们使用其右侧和左侧角点（即 $\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right)$ 和 $\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right)$）处的 $\\psi$ 值来计算该点上 $\\psi$ 的 $x$-导数。这得到：\n$$\nv_{i,\\,j+\\frac{1}{2}} = \\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}}}{\\Delta x}\n$$\n现在，我们必须验证这些定义是否满足这两个条件。\n\n**条件 (i) 的验证：精确无辐散**\n我们将推导出的 $u$ 和 $v$ 的表达式代入给定的网格中心 $\\left(i,j\\right)$ 处的离散辐散公式中：\n$$\n\\left(\\nabla\\cdot \\boldsymbol{u}\\right)_{i,j}\n= \\frac{u_{i+\\frac{1}{2},j} - u_{i-\\frac{1}{2},j}}{\\Delta x}\n+ \\frac{v_{i,\\,j+\\frac{1}{2}} - v_{i,\\,j-\\frac{1}{2}}}{\\Delta y}\n$$\n第一项是：\n$$\n\\frac{u_{i+\\frac{1}{2},j} - u_{i-\\frac{1}{2},j}}{\\Delta x} = \\frac{1}{\\Delta x} \\left( -\\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}}}{\\Delta y} - \\left(-\\frac{\\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i-\\frac{1}{2},\\,j-\\frac{1}{2}}}{\\Delta y}\\right) \\right)\n$$\n$$\n= -\\frac{1}{\\Delta x \\Delta y} \\left( \\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}} - \\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}} + \\psi_{i-\\frac{1}{2},\\,j-\\frac{1}{2}} \\right)\n$$\n第二项是：\n$$\n\\frac{v_{i,\\,j+\\frac{1}{2}} - v_{i,\\,j-\\frac{1}{2}}}{\\Delta y} = \\frac{1}{\\Delta y} \\left( \\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}}}{\\Delta x} - \\frac{\\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}} - \\psi_{i-\\frac{1}{2},\\,j-\\frac{1}{2}}}{\\Delta x} \\right)\n$$\n$$\n= \\frac{1}{\\Delta x \\Delta y} \\left( \\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}} - \\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}} + \\psi_{i-\\frac{1}{2},\\,j-\\frac{1}{2}} \\right)\n$$\n得到的两个表达式大小相等，符号相反。因此，对于任何离散场 $\\psi$，它们的和恒等于零。\n$$\n\\left(\\nabla\\cdot \\boldsymbol{u}\\right)_{i,j} = 0\n$$\n因此，条件 (i) 得到满足。\n\n**条件 (ii) 的验证：涡度作为拉普拉斯算子**\n我们将我们的 $u$ 和 $v$ 表达式代入给定的角点 $\\left(i+\\frac{1}{2},j+\\frac{1}{2}\\right)$ 处的离散涡度公式中：\n$$\n\\zeta_{i+\\frac{1}{2},\\,j+\\frac{1}{2}}\n= \\frac{v_{i+1,\\,j+\\frac{1}{2}} - v_{i,\\,j+\\frac{1}{2}}}{\\Delta x}\n- \\frac{u_{i+\\frac{1}{2},\\,j+1} - u_{i+\\frac{1}{2},\\,j}}{\\Delta y}\n$$\n第一项，代表 $\\partial v/\\partial x$，变为：\n$$\n\\frac{1}{\\Delta x} \\left( \\frac{\\psi_{i+\\frac{3}{2}, j+\\frac{1}{2}} - \\psi_{i+\\frac{1}{2}, j+\\frac{1}{2}}}{\\Delta x} - \\frac{\\psi_{i+\\frac{1}{2}, j+\\frac{1}{2}} - \\psi_{i-\\frac{1}{2}, j+\\frac{1}{2}}}{\\Delta x} \\right) = \\frac{\\psi_{i+\\frac{3}{2},\\,j+\\frac{1}{2}} - 2\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} + \\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}}}{(\\Delta x)^2}\n$$\n这是以 $\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right)$ 为中心的 $\\partial^2 \\psi / \\partial x^2$ 的标准二阶有限差分。\n第二项，代表 $-\\partial u/\\partial y$，变为：\n$$\n- \\frac{1}{\\Delta y} \\left( -\\frac{\\psi_{i+\\frac{1}{2}, j+\\frac{3}{2}} - \\psi_{i+\\frac{1}{2}, j+\\frac{1}{2}}}{\\Delta y} - \\left(-\\frac{\\psi_{i+\\frac{1}{2}, j+\\frac{1}{2}} - \\psi_{i+\\frac{1}{2}, j-\\frac{1}{2}}}{\\Delta y}\\right) \\right) = \\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{3}{2}} - 2\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} + \\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}}}{(\\Delta y)^2}\n$$\n这是以 $\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right)$ 为中心的 $\\partial^2 \\psi / \\partial y^2$ 的标准二阶有限差分。\n将它们组合起来，我们发现离散涡度恰好是 $\\psi$ 在同一点角点处的标准五点离散拉普拉斯算子：\n$$\n\\zeta_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} = \\frac{\\psi_{i+\\frac{3}{2},\\,j+\\frac{1}{2}} - 2\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} + \\psi_{i-\\frac{1}{2},\\,j+\\frac{1}{2}}}{(\\Delta x)^2} + \\frac{\\psi_{i+\\frac{1}{2},\\,j+\\frac{3}{2}} - 2\\psi_{i+\\frac{1}{2},\\,j+\\frac{1}{2}} + \\psi_{i+\\frac{1}{2},\\,j-\\frac{1}{2}}}{(\\Delta y)^2}\n$$\n这个公式是连续关系 $\\zeta = \\nabla^2\\psi$ 的一个二阶近似。因此，条件 (ii) 得到满足。\n\n正确的方案是：$\\psi$ 和 $\\zeta$ 在角点 $\\left(i+\\frac{1}{2},j+\\frac{1}{2}\\right)$ 处；$u$ 在面 $\\left(i+\\frac{1}{2},j\\right)$ 处；$v$ 在面 $\\left(i,j+\\frac{1}{2}\\right)$ 处；速度的计算如上所述。让我们评估给定的选项。\n\n**选项 A：** 该选项提议将 $\\psi$ 和 $\\zeta$ 置于角点 $\\left(i+\\frac{1}{2},j+\\frac{1}{2}\\right)$，将 $u$ 置于 $\\left(i+\\frac{1}{2},j\\right)$，将 $v$ 置于 $\\left(i,j+\\frac{1}{2}\\right)$。它提供了我们推导出的精确的离散速度定义。它正确地声称这种排列导致离散辐散恒等于零，并且离散涡度是 $\\psi$ 在同一角点位置的二阶离散拉普拉斯算子。\n**结论：正确**\n\n**选项 B：** 该选项将 $\\psi$ 和 $\\zeta$ 置于网格中心 $\\left(i,j\\right)$。这立刻在条件 (ii) 上产生了一个问题。问题在角点 $\\left(i+\\frac{1}{2},j+\\frac{1}{2}\\right)$ 定义涡度。要将这个基于角点的涡度与一个以网格为中心的 $\\psi$（自然定义在中心）的拉普拉斯算子进行比较，就需要进行插值，这违反了条件 (ii) 的一个关键部分。此外，该选项声称环流涡度等于 $\\psi$ 在 $\\left(i,j\\right)$ 处的拉普拉斯算子，但给出的环流涡度是在 $\\left(i+\\frac{1}{2},j+\\frac{1}{2}\\right)$ 处，这是一个位置上的矛盾。\n**结论：不正确**\n\n**选项 C：** 该选项提议将 $\\psi$ 置于与速度分量相同的面上。这对于单个标量场 $\\psi$ 来说不是一个有效的表示。这意味着 $\\psi$ 将不得不在两组不同的位置上定义，或者是一个矢量，这与它作为标量流函数的定义相矛盾。所提出的方案在根本上是不连贯的。\n**结论：不正确**\n\n**选项 D：** 该选项将 $\\psi$ 置于角点，但 $\\zeta$ 置于网格中心。这与所提供的离散涡度的定义相矛盾，该定义明确地是在角点 $\\left(i+\\frac{1}{2},j+\\frac{1}{2}\\right)$ 处给出的。由于问题要求满足对*问题中定义的*涡度的条件，任何将 $\\zeta$ 放置在别处的安排都是无效的。声称获得“在网格中心处的环流涡度”是无意义的，因为问题提供了在角点处环流涡度的公式。\n**结论：不正确**\n\n因此，只有选项 A 正确描述了满足给定条件的交错和离散化方案。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "这个实践练习是计算海洋学建模的基石，它将带你从头开始构建一个求解泊松方程 $\\nabla^2\\psi = \\zeta$ 的求解器。你将学习如何将偏微分方程离散化，实现一个迭代求解算法来反演涡度场以获得流函数，并处理不同类型的边界条件。通过“人造解”方法验证你的代码，你将掌握验证和确认数值模拟结果的关键技能。",
            "id": "3813684",
            "problem": "考虑一个矩形域上的二维、正压、不可压缩的海洋流，其水平速度场由一个标量流函数 $\\psi(x,y)$ 表示，使得 $\\mathbf{u} = (u,v) = \\left(-\\frac{\\partial \\psi}{\\partial y}, \\frac{\\partial \\psi}{\\partial x}\\right)$。相对涡度 $\\zeta(x,y)$ 定义为 $\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。对于正压流，这些定义意味着流函数和涡度之间存在泊松关系，即 $\\nabla^2 \\psi = \\zeta$。\n\n您的任务是：\n1. 仅从流函数和相对涡度的定义以及不可压缩流的性质出发，推导出控制泊松方程，并在单位正方形域 $[0,1] \\times [0,1]$ 上，对拉普拉斯算子 $\\nabla^2 \\psi$ 进行二阶、均匀网格的有限差分离散化。该网格具有 $N \\times N$ 个网格点，两个方向上的网格间距均为 $h = \\frac{1}{N-1}$。清晰地说明应如何在内部点上构建离散算子。\n2. 为两种类型的边界条件制定边界处理方法：\n   - 狄利克雷边界条件：在所有四个边界上给定 $\\psi$ 的值。\n   - 齐次诺伊曼边界条件：在所有四个边界上 $\\frac{\\partial \\psi}{\\partial n} = 0$，其中 $\\frac{\\partial \\psi}{\\partial n}$ 表示垂直于边界的法向导数。确保您的公式与邻近边界的点的离散拉普拉斯算子相一致。在齐次诺伊曼情况下，讨论可解性条件以及解在一个可加常数范围内的非唯一性；定义一个规范来固定 $\\psi$ 的平均值。\n3. 提出并实现一个适用于大区域的迭代求解器，该求解器使用逐点松弛策略，根据离散泊松方程局部更新 $\\psi$。用一个松弛参数来描述迭代过程，并说明新值如何依赖于相邻点。解释基于离散泊松算子得到的残差范数的停止准则。讨论该方法随 $N$ 变化的尺度特性，并评论对于非常大的 $N$ 值更有效率的其他迭代方法。\n4. 在单位正方形上使用构造解来验证求解器。设 $(x_i, y_j)$ 表示网格点坐标。使用以下测试套件，它涵盖了内部更新、边界处理、小网格行为和中等网格行为。对于每种情况，从构造的精确解 $\\psi(x_i,y_j)$ 构建 $\\zeta(x_i,y_j)$，应用适当的边界条件，运行您的求解器直至收敛，然后计算最大绝对逐点误差 $\\max_{i,j} |\\psi_{\\text{num}}(x_i,y_j) - \\psi_{\\text{exact}}(x_i,y_j)|$：\n   - 情况 A (狄利克雷，理想情况)：$N = 33$。精确流函数 $ \\psi_{\\text{exact}}(x,y) = \\sin(2\\pi x)\\sin(3\\pi y)$。在所有边界上根据 $\\psi_{\\text{exact}}$ 给定狄利克雷边界值。通过在网格上逐点计算连续恒等式 $\\zeta = \\nabla^2 \\psi_{\\text{exact}}$ 来定义 $\\zeta(x,y)$。\n   - 情况 B (齐次诺伊曼，满足相容性条件)：$N = 33$。精确流函数 $\\psi_{\\text{exact}}(x,y) = \\cos(2\\pi x) + \\cos(2\\pi y)$。在所有边界上施加齐次诺伊曼边界条件 $\\frac{\\partial \\psi}{\\partial n} = 0$。通过在所有迭代中强制 $\\psi$ 的平均值为零来施加规范。\n   - 情况 C (狄利克雷，小网格边缘情况)：$N = 5$。精确流函数 $ \\psi_{\\text{exact}}(x,y) = \\sin(2\\pi x)\\sin(3\\pi y)$。边界值来自 $\\psi_{\\text{exact}}$；如前所述定义 $\\zeta$。\n   - 情况 D (齐次诺伊曼，中等网格)：$N = 49$。精确流函数 $\\psi_{\\text{exact}}(x,y) = \\cos(2\\pi x) + \\cos(2\\pi y)$。齐次诺伊曼边界条件 $\\frac{\\partial \\psi}{\\partial n} = 0$，并使用零平均值规范。通过 $\\zeta = \\nabla^2 \\psi_{\\text{exact}}$ 定义 $\\zeta$。\n\n实现要求：\n- 使用基于您的离散化和松弛参数的逐点松弛方法。当离散残差 $r_{i,j} = \\left(\\nabla^2_h \\psi\\right)_{i,j} - \\zeta_{i,j}$ 的最大范数低于预设容差或达到最大迭代次数时，停止迭代。\n- 程序必须是自包含的，且不应要求任何输入。\n- 对于每个测试用例，计算并报告在所有网格点上数值解与精确解 $\\psi$ 场之间的最大绝对逐点误差。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须包含分别对应于情况 A、B、C 和 D 的四个数字。每个数字必须是最大绝对逐点误差，并采用具有六位有效数字的科学记数法格式（例如，$[1.23\\text{e-}04,5.67\\text{e-}05,8.90\\text{e-}06,1.23\\text{e-}04]$）。结果无量纲，不适用任何物理单位或角度单位。",
            "solution": "所给问题是计算流体动力学中一个定义良好且标准的问题，具体涉及椭圆偏微分方程的数值解法。它要求推导并实现一个有限差分求解器，用于求解正压、不可压缩流中的流函数所满足的泊松方程。该问题在科学上是合理的，内容自包含，并且所有提供的数据和条件都是一致的。因此，我们可以着手给出一个完整的解答。\n\n解答分为四个部分，对应于问题陈述中列出的任务。\n\n### 1. 控制方程与有限差分离散化\n\n速度场 $\\mathbf{u} = (u,v)$ 与标量流函数 $\\psi(x,y)$ 之间的关系由下式给出：\n$$\nu = -\\frac{\\partial \\psi}{\\partial y}, \\qquad v = \\frac{\\partial \\psi}{\\partial x}\n$$\n不可压缩条件 $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$ 被此定义恒等满足，前提是 $\\psi$ 具有连续的二阶偏导数：\n$$\n\\frac{\\partial}{\\partial x}\\left(-\\frac{\\partial \\psi}{\\partial y}\\right) + \\frac{\\partial}{\\partial y}\\left(\\frac{\\partial \\psi}{\\partial x}\\right) = -\\frac{\\partial^2 \\psi}{\\partial x \\partial y} + \\frac{\\partial^2 \\psi}{\\partial y \\partial x} = 0\n$$\n相对涡度 $\\zeta$ 定义为速度场的旋度：\n$$\n\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\n$$\n将 $u$ 和 $v$ 的流函数定义代入 $\\zeta$ 的表达式，得到控制泊松方程：\n$$\n\\zeta = \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial \\psi}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(-\\frac{\\partial \\psi}{\\partial y}\\right) = \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} = \\nabla^2 \\psi\n$$\n为了数值求解该方程，我们使用一个具有 $N \\times N$ 个点的均匀网格来离散化区域 $[0,1] \\times [0,1]$。在 $x$ 和 $y$ 方向上的网格间距均为 $h = \\frac{1}{N-1}$。网格点的坐标为 $(x_i, y_j) = (i h, j h)$，其中 $i, j \\in \\{0, 1, \\dots, N-1\\}$。该点处的流函数值记为 $\\psi_{i,j}$。\n\n在内部网格点 $(i,j)$ 处，拉普拉斯算子 $\\nabla^2 \\psi$ 使用二阶精度的中心有限差分来离散化二阶偏导数：\n$$\n\\frac{\\partial^2 \\psi}{\\partial x^2}\\bigg|_{i,j} \\approx \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{h^2}\n$$\n$$\n\\frac{\\partial^2 \\psi}{\\partial y^2}\\bigg|_{i,j} \\approx \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{h^2}\n$$\n将这两项相加，得到五点格式的离散拉普拉斯算子 $(\\nabla^2_h \\psi)_{i,j}$：\n$$\n(\\nabla^2_h \\psi)_{i,j} = \\frac{\\psi_{i+1,j} + \\psi_{i-1,j} + \\psi_{i,j+1} + \\psi_{i,j-1} - 4\\psi_{i,j}}{h^2}\n$$\n因此，在任何内部点 $(i,j)$ 处的离散泊松方程为：\n$$\n\\frac{\\psi_{i+1,j} + \\psi_{i-1,j} + \\psi_{i,j+1} + \\psi_{i,j-1} - 4\\psi_{i,j}}{h^2} = \\zeta_{i,j}\n$$\n\n### 2. 边界条件处理\n\n**狄利克雷边界条件**：在所有边界上给定 $\\psi$ 的值。\n在这种情况下，对于 $i \\in \\{0, N-1\\}$ 或 $j \\in \\{0, N-1\\}$ 的点，$\\psi_{i,j}$ 的值是已知的。迭代求解器只更新内部点，即 $i,j \\in \\{1, \\dots, N-2\\}$。在更新邻近边界的点（例如 $(1,j)$）时，在计算格式中会使用已知的边界值 $\\psi_{0,j}$。\n\n**齐次诺伊曼边界条件**：在所有边界上 $\\frac{\\partial \\psi}{\\partial n} = 0$。\n此条件通过在区域外引入“虚拟点”来处理。例如，在左边界（$x=0$, $i=0$），条件是 $\\frac{\\partial \\psi}{\\partial x}=0$。在 $i=0$ 处使用二阶中心差分近似为 $\\frac{\\psi_{1,j} - \\psi_{-1,j}}{2h} = 0$，这意味着虚拟点的值为 $\\psi_{-1,j} = \\psi_{1,j}$。现在我们可以在边界点 $(0,j)$ 处写出离散拉普拉斯算子：\n$$\n(\\nabla^2_h \\psi)_{0,j} = \\frac{\\psi_{1,j} + \\psi_{-1,j} + \\psi_{0,j+1} + \\psi_{0,j-1} - 4\\psi_{0,j}}{h^2} = \\frac{2\\psi_{1,j} + \\psi_{0,j+1} + \\psi_{0,j-1} - 4\\psi_{0,j}}{h^2}\n$$\n这就给出了在边界点处需要求解的方程。对于其他三个边界和四个角点，可以推导出类似的计算格式。例如，对于角点 $(0,0)$，我们同时有 $\\frac{\\partial \\psi}{\\partial x}=0$ 和 $\\frac{\\partial \\psi}{\\partial y}=0$，这导致 $\\psi_{-1,0}=\\psi_{1,0}$ 和 $\\psi_{0,-1}=\\psi_{0,1}$。离散方程变为：\n$$\n(\\nabla^2_h \\psi)_{0,0} = \\frac{2\\psi_{1,0} + 2\\psi_{0,1} - 4\\psi_0,0}{h^2} = \\zeta_{0,0}\n$$\n泊松方程的诺伊曼问题有解的充要条件是源项满足一个可解性条件。将 $\\nabla^2\\psi = \\zeta$ 在区域 $\\Omega$ 上积分并应用散度定理：$\\iint_\\Omega \\zeta \\,dA = \\iint_\\Omega \\nabla \\cdot (\\nabla \\psi) \\,dA = \\oint_{\\partial\\Omega} \\nabla\\psi \\cdot \\mathbf{n} \\,ds = \\oint_{\\partial\\Omega} \\frac{\\partial\\psi}{\\partial n} \\,ds$。对于齐次诺伊曼条件，这要求 $\\iint_\\Omega \\zeta \\,dA = 0$。测试用例中构造的解满足这个积分约束。\n此外，如果 $\\psi$ 是一个解，那么对于任意常数 $C$，$\\psi+C$ 也是一个解。这种非唯一性通过施加一个规范来解决。根据要求，我们通过在每次迭代中减去 $\\psi$ 的网格平均值来强制解的平均值为零：$\\psi_{i,j} \\leftarrow \\psi_{i,j} - \\frac{1}{N^2}\\sum_{k,l} \\psi_{k,l}$。\n\n### 3. 迭代求解器：逐次超松弛法 (SOR)\n\n一种合适的逐点松弛方法是逐次超松弛法 (SOR)。该方法根据邻近点的值和一个松弛参数 $\\omega$ 来更新点 $\\psi_{i,j}$。首先，我们重排离散泊松方程，用邻近点的值来表示 $\\psi_{i,j}$。对于一个内部点：\n$$\n\\psi_{i,j} = \\frac{1}{4}(\\psi_{i+1,j} + \\psi_{i-1,j} + \\psi_{i,j+1} + \\psi_{i,j-1} - h^2 \\zeta_{i,j})\n$$\n在顺序扫描中使用最新的 $\\psi$ 值计算右侧，定义了高斯-赛德尔更新，记为 $\\psi_{i,j}^{\\text{GS}}$。SOR 方法通过“超松弛”这个更新，将当前值 $\\psi_{i,j}^{(k)}$ 修改为新值 $\\psi_{i,j}^{(k+1)}$：\n$$\n\\psi_{i,j}^{(k+1)} = (1-\\omega)\\psi_{i,j}^{(k)} + \\omega \\psi_{i,j}^{\\text{GS}}\n$$\n其中 $k$ 是迭代指数，$\\omega$ 是松弛参数。为保证收敛，$0  \\omega  2$。当 $\\omega > 1$ 时，该方法是“超松弛”的，收敛会加速。对于方形网格上的这个问题，最优的 $\\omega$ 近似为 $\\omega_{\\text{opt}} \\approx \\frac{2}{1 + \\sin(\\pi h)} = \\frac{2}{1 + \\sin(\\pi/(N-1))}$。\n\n当离散系统求解到期望的精度时，迭代终止。这通过残差 $r_{i,j} = (\\nabla^2_h \\psi)_{i,j} - \\zeta_{i,j}$ 的范数来衡量。当残差的最大范数 $\\|r\\|_\\infty = \\max_{i,j} |r_{i,j}|$ 低于指定的容差 $\\epsilon$ 或达到最大迭代次数时，迭代停止。\n\n**尺度特性与替代方法**：SOR 方法收敛到固定容差所需的迭代次数与 $N$ 成正比，即 $O(N)$。由于每次迭代涉及 $O(N^2)$ 次操作，总计算成本增长为 $O(N^3)$。对于非常大的 $N$ 值，这会变得难以承受。更高效的现代方法包括：\n- **共轭梯度 (CG) 法**：一种用于求解线性系统 $A\\mathbf{x}=\\mathbf{b}$ 的算法，其中 $A$ 是对称正定矩阵。它通常比 SOR 收敛得快得多。预处理共轭梯度 (PCG) 法可以进一步提高性能。\n- **多重网格法**：这些方法在一系列层次化的网格上操作，利用粗网格来高效地消除低频误差分量。它们是最高效的求解器之一，计算复杂度为 $O(N^2)$，这是最优的。\n- **快速傅里叶变换 (FFT) 求解器**：对于矩形域和某些边界条件，离散泊松方程可以在傅里叶空间中对角化，从而实现非常快速的求解，复杂度为 $O(N^2 \\log N)$。\n\n### 4. 使用构造解进行验证\n\n求解器通过构造解方法进行验证。选择一个精确解 $\\psi_{\\text{exact}}$，并从中导出相应的源项 $\\zeta_{\\text{exact}} = \\nabla^2 \\psi_{\\text{exact}}$ 和边界条件。然后使用此设置运行数值求解器，并将其输出 $\\psi_{\\text{num}}$ 与 $\\psi_{\\text{exact}}$ 进行比较。最大绝对逐点误差 $\\max_{i,j} |\\psi_{\\text{num}}(x_i,y_j) - \\psi_{\\text{exact}}(x_i,y_j)|$ 量化了实现的准确性。所提供的测试套件涵盖了不同网格尺寸下的狄利克雷和诺伊曼边界条件，详见问题描述。实现遵循了上述原则。",
            "answer": "$$[5.26388 \\times 10^{-5}, 8.08272 \\times 10^{-5}, 2.56475 \\times 10^{-4}, 3.60677 \\times 10^{-5}]$$"
        }
    ]
}