{
    "hands_on_practices": [
        {
            "introduction": "要充分理解刚盖近似（rigid-lid approximation）的计算优势，我们必须首先理解它所解决的问题。本练习将引导您计算外部重力波的速度，这是正压海洋模型中最快的信号。通过确定这些波在 Courant-Friedrichs-Lewy (CFL) 条件下施加的严格时间步长限制，您将对在气候尺度模拟中滤除它们的动机有一个定量的理解 。",
            "id": "4072669",
            "problem": "考虑一个海洋环流模型（OGCM）的自由面正压模，在长波、静水和 Boussinesq 近似下，该模式由常数平均深度 $H$ 的笛卡尔平面上的一层线性化浅水方程表示：\n$$\n\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x},\\quad \\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0,\n$$\n其中 $u$ 是 $x$ 方向上深度平均的水平速度，$\\eta$ 是自由面位移， $g$ 是重力加速度。从这些方程和第一性原理（动量和质量守恒）出发，推导小振幅平面波的频散关系，并得到以外部重力波相速度，用 $g$ 和 $H$ 表示。然后，对于具有代表性平均深度 $H = 4000\\,\\mathrm{m}$ 和重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$ 的全球海洋，计算外部重力波的相速度。使用您推导出的速度，论证由 Courant-Friedrichs-Lewy (CFL) 条件对具有均匀网格间距 $\\Delta x = 25\\,\\mathrm{km}$ 的一维正压自由面求解器所施加的显式时间步长约束，并定性比较如果模型采用去除外部模的刚盖近似，该约束会如何变化。\n\n您的最终数值答案应为在 $H = 4000\\,\\mathrm{m}$ 处计算的外部重力波相速度。最终速度以 $\\mathrm{m\\,s^{-1}}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "评估问题陈述的有效性。\n\n**步骤 1：提取已知条件**\n- 控制方程：$\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x}$ 和 $\\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0$。\n- 变量：$u$（深度平均的水平速度），$\\eta$（自由面位移），$x$（水平坐标），$t$（时间）。\n- 常数：$g$（重力加速度），$H$（常数平均深度）。\n- 模型背景：用于海洋环流模型（OGCM）自由面正压模的一层线性化浅水方程。\n- 近似：长波、静水、Boussinesq。\n- 用于分析的具体数值：$H = 4000\\,\\mathrm{m}$，$g = 9.81\\,\\mathrm{m\\,s^{-2}}$，网格间距 $\\Delta x = 25\\,\\mathrm{km}$。\n- 任务组成：\n    1. 推导频散关系和外部重力波相速度 $c$，用 $g$ 和 $H$ 表示。\n    2. 根据给定的 $g$ 和 $H$ 值计算 $c$。\n    3. 讨论 Courant-Friedrichs-Lewy (CFL) 条件带来的时间步长约束。\n    4. 将此约束与刚盖模型的约束进行定性比较。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于线性化浅水方程，这是地球物理流体动力学的基础，也是正压表面重力波的标准模型。$g$、$H$ 和 $\\Delta x$ 的值对于全球海洋建模拟是现实的。这是一个经典的教科书问题。\n- **适定性：** 问题陈述清晰，包含推导频散关系、计算相速度和分析 CFL 条件所需的所有信息。存在唯一且有意义的解。\n- **客观性：** 语言精确，没有偏见或主观陈述。\n\n**步骤 3：结论与行动**\n问题有效。它在科学上是合理的，内容是自洽的，并且是适定的。可以进行求解过程。\n\n求解从推导给定方程组的频散关系开始。该方程组为：\n$$\n\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0 \\quad (2)\n$$\n我们寻求如下形式的平面波解：\n$$\nu(x, t) = U_0 \\exp[i(kx - \\omega t)]\n$$\n$$\n\\eta(x, t) = \\eta_0 \\exp[i(kx - \\omega t)]\n$$\n其中 $k$ 是波数，$\\omega$ 是角频率，$U_0$ 是速度的复振幅，$\\eta_0$ 是表面位移的复振幅。\n\n将这些形式代入方程 $(1)$ 和 $(2)$ 需要进行偏微分：\n$\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$\n$\\frac{\\partial}{\\partial x} \\rightarrow ik$\n\n将这些应用于方程 $(1)$：\n$$\n-i\\omega (U_0 \\exp[i(kx - \\omega t)]) = -g (ik) (\\eta_0 \\exp[i(kx - \\omega t)])\n$$\n除以指数项和 $-i$，我们得到一个关联振幅的线性代数方程：\n$$\n\\omega U_0 = gk \\eta_0 \\quad (3)\n$$\n\n对（2）式应用同样的操作：\n$$\n-i\\omega (\\eta_0 \\exp[i(kx - \\omega t)]) + H (ik) (U_0 \\exp[i(kx - \\omega t)]) = 0\n$$\n除以指数项和 $i$：\n$$\n-\\omega \\eta_0 + Hk U_0 = 0 \\quad (4)\n$$\n\n我们现在得到了一个关于 $U_0$ 和 $\\eta_0$ 的齐次线性方程组：\n$$\n\\omega U_0 - gk \\eta_0 = 0\n$$\n$$\nHk U_0 - \\omega \\eta_0 = 0\n$$\n为了得到非平凡解（即 $U_0$ 和 $\\eta_0$ 不全为零），系数矩阵的行列式必须为零。\n$$\n\\det \\begin{pmatrix} \\omega  -gk \\\\ Hk  -\\omega \\end{pmatrix} = (\\omega)(-\\omega) - (-gk)(Hk) = 0\n$$\n$$\n-\\omega^2 + gHk^2 = 0\n$$\n这就导出了这些波的频散关系：\n$$\n\\omega^2 = gHk^2\n$$\n相速度 $c$ 定义为角频率与波数之比，$c = \\omega/k$。从频散关系中，我们可以解出这个比值：\n$$\n\\frac{\\omega^2}{k^2} = gH \\implies \\left(\\frac{\\omega}{k}\\right)^2 = gH\n$$\n取平方根得到相速度：\n$$\nc = \\pm \\sqrt{gH}\n$$\n相速度是一个标量，因此我们取正根。这就是外部（正压）重力波的相速度：\n$$\nc = \\sqrt{gH}\n$$\n这些波是非频散的，因为相速度 $c$ 不依赖于波数 $k$。\n\n接下来，我们用给定的参数计算这个速度：$H = 4000\\,\\mathrm{m}$ 和 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n$$\nc = \\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}}) (4000\\,\\mathrm{m})} = \\sqrt{39240\\,\\mathrm{m^2\\,s^{-2}}}\n$$\n$$\nc \\approx 198.090888\\,\\mathrm{m\\,s^{-1}}\n$$\n按要求四舍五入到四位有效数字，相速度为 $198.1\\,\\mathrm{m\\,s^{-1}}$。\n\n最后，我们考虑这对数值时间步长约束的影响。对于波传播的显式数值格式，Courant-Friedrichs-Lewy (CFL) 条件要求数值依赖域必须包含物理依赖域。对于一维平流/波动方程，这表示为：\n$$\nC_{cfl} = \\frac{c_{max} \\Delta t}{\\Delta x} \\le 1\n$$\n其中 $c_{max}$ 是系统中的最大波速，$\\Delta t$ 是时间步长，$\\Delta x$ 是网格间距。这对数值稳定性的时间步长施加了一个上限：\n$$\n\\Delta t \\le \\frac{\\Delta x}{c_{max}}\n$$\n在自由面模型中，最快的波是我们刚刚分析的外部重力波。因此，$c_{max} = c = \\sqrt{gH} \\approx 198.1\\,\\mathrm{m\\,s^{-1}}$。当网格间距为 $\\Delta x = 25\\,\\mathrm{km} = 25000\\,\\mathrm{m}$ 时，允许的最大时间步长为：\n$$\n\\Delta t \\le \\frac{25000\\,\\mathrm{m}}{198.1\\,\\mathrm{m\\,s^{-1}}} \\approx 126.2\\,\\mathrm{s}\n$$\n对于必须运行数百年或数千年的气候模拟来说，这个大约 $2$ 分钟的时间步长非常短，使得这类模型的计算成本非常高。\n\n相比之下，采用刚盖近似的模型强制 $\\eta = \\text{常数}$，或者在动力学中更典型地是 $\\frac{\\partial \\eta}{\\partial t} = 0$。观察方程 $(2)$，这意味着 $\\frac{\\partial u}{\\partial x} = 0$，即流体是水平无辐散的。这种近似有效地滤除了快速的外部重力波，因为它们的存在与自由面位移 $\\eta$ 相关联。\n去除了外部重力波后，模型中的最大波速 $c_{max}$ 则由其他慢得多的波动现象决定。这些通常包括内重力波（与密度分层相关，速度量级为 $1-3\\,\\mathrm{m\\,s^{-1}}$）和行星 Rossby 波（速度更慢）。如果剩余的最快波速为，例如，$c_{internal} \\approx 3\\,\\mathrm{m\\,s^{-1}}$，则 CFL 条件变为：\n$$\n\\Delta t \\le \\frac{25000\\,\\mathrm{m}}{3\\,\\mathrm{m\\,s^{-1}}} \\approx 8333\\,\\mathrm{s}\n$$\n这对应于大约 $2.3$ 小时的时间步长，比自由面模型允许的时间步长要大得多（大约 $66$ 倍）。因此，刚盖近似允许对海洋模型进行效率高得多的长期积分，代价是排除了依赖于自由面动力学的现象，如潮汐和海啸。",
            "answer": "$$\n\\boxed{198.1}\n$$"
        },
        {
            "introduction": "虽然刚盖近似在计算上非常强大，但它仅在特定的物理条件下有效。本练习通过对深度积分连续性方程进行尺度分析，深入探讨了其适用范围。您将推导决定该近似有效性的关键无量纲参数，并针对不同的真实世界情景进行评估，从而学会区分刚盖近似作为稳健工具的适用场景以及其失效的场景 。",
            "id": "3815928",
            "problem": "考虑一个平均深度为 $H$ 的静力、Boussinesq 海洋，其自由表面位移为 $\\eta(x,y,t)$，水平速度为 $\\mathbf{u}_h(x,y,z,t)$。假设流体不可压缩，因此 $\\nabla \\cdot \\mathbf{u} = 0$，其中 $\\mathbf{u} = (u,v,w)$，并且在平坦的海底 $z=-H$ 和移动的自由表面 $z=\\eta(x,y,t)$ 处满足标准的运动学边界条件。从这些基本原理出发，并且不引用任何专门的刚盖（rigid-lid）公式，执行以下操作：\n\n1) 使用运动学边界条件对不可压缩质量守恒方程进行深度积分，以获得关于自由表面位移 $\\eta(x,y,t)$ 和深度积分的水平输运 $\\displaystyle \\mathbf{Q}(x,y,t) = \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz$ 的精确的深度积分连续性方程。然后，引入水平长度的特征尺度 $L$、水平速度大小的特征尺度 $U$、垂直长度的特征尺度 $H$、自由表面振幅的特征尺度 $\\eta_0$，以及平流时间尺度 $T=L/U$。对深度积分的连续性方程进行无量纲化，并确定乘以局部自由表面趋势项的无量纲参数。将此参数纯粹用振幅 $\\eta_0$ 和平均深度 $H$ 表示。\n\n2) 使用第 1 部分的结果，评估该参数在三种科学相关的场景下的值：\n- 开阔大洋背景变率：$H \\sim 4000\\,\\mathrm{m}$，$\\eta_0 \\sim 0.1\\,\\mathrm{m}$。\n- 强潮大陆架：$H \\sim 100\\,\\mathrm{m}$，$\\eta_0 \\sim 2\\,\\mathrm{m}$。\n- 浅海陆架上的极端风暴潮：$H \\sim 20\\,\\mathrm{m}$，$\\eta_0 \\sim 3\\,\\mathrm{m}$。\n\n将这三个无量纲值按上述顺序以单个行向量的形式报告。\n\n3) 简要地，并严格根据你的无量纲结果，解释刚盖近似在何种机制下是渐近一致的，以及何时预计会在动力学上失效。\n\n对于第 2 项，将每个报告值四舍五入到 4 位有效数字。这些量是无量纲的；报告时无需单位。最终答案必须是包含按指定顺序排列的三个四舍五入值的单个行向量。",
            "solution": "我们从 Boussinesq 流体的不可压缩连续性方程开始，\n$$\n\\nabla \\cdot \\mathbf{u} \\equiv \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0.\n$$\n从平坦的海底 $z=-H$ 到自由表面 $z=\\eta(x,y,t)$ 进行垂直积分：\n$$\n\\int_{-H}^{\\eta} \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} \\right) dz = 0.\n$$\n对垂直散度项使用微积分基本定理，并将水平导数与积分交换，得到\n$$\n\\nabla_h \\cdot \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz + \\left. w \\right|_{z=\\eta} - \\left. w \\right|_{z=-H} = 0,\n$$\n其中 $\\nabla_h \\cdot (\\cdot) = \\frac{\\partial}{\\partial x}(\\cdot) + \\frac{\\partial}{\\partial y}(\\cdot)$ 且 $\\mathbf{u}_h = (u,v)$。\n\n应用运动学边界条件。对于平坦的海底，不渗透性意味着\n$$\n\\left. w \\right|_{z=-H} = 0.\n$$\n在自由表面，表面的物质守恒得出\n$$\n\\left. w \\right|_{z=\\eta} = \\frac{\\partial \\eta}{\\partial t} + \\mathbf{u}_h(x,y,\\eta,t) \\cdot \\nabla_h \\eta.\n$$\n将这些代入垂直积分的连续性方程，得到精确的深度积分方程\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\nabla_h \\cdot \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz + \\mathbf{u}_h(x,y,\\eta,t) \\cdot \\nabla_h \\eta = 0.\n$$\n定义深度积分输运\n$$\n\\mathbf{Q}(x,y,t) = \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz,\n$$\n这样方程就写为\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\nabla_h \\cdot \\mathbf{Q} + \\mathbf{u}_h(x,y,\\eta,t) \\cdot \\nabla_h \\eta = 0.\n$$\n\n为了揭示相对于深度积分输运控制自由表面动力学的小参数，引入特征尺度：水平长度 $L$、速度 $U$、深度 $H$、自由表面振幅 $\\eta_0$ 和平流时间 $T=L/U$。定义无量纲变量\n$$\nx' = \\frac{x}{L}, \\quad y' = \\frac{y}{L}, \\quad z' = \\frac{z}{H}, \\quad t' = \\frac{t}{T}, \\quad \\eta' = \\frac{\\eta}{\\eta_0}, \\quad \\mathbf{u}_h' = \\frac{\\mathbf{u}_h}{U}.\n$$\n深度积分输运的尺度为\n$$\n\\mathbf{Q} \\sim \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz \\sim U H,\n$$\n我们设 $\\mathbf{Q}' = \\mathbf{Q}/(U H)$，因此 $\\nabla_h \\cdot \\mathbf{Q} = (U H / L)\\, \\nabla_h' \\cdot \\mathbf{Q}'$。自由表面趋势的尺度为 $\\partial \\eta / \\partial t \\sim \\eta_0 / T$。表面坡度项 $\\mathbf{u}_h(\\eta) \\cdot \\nabla_h \\eta$ 的尺度为 $U \\, (\\eta_0 / L)$，因此当表面坡度很小，即 $|\\nabla_h \\eta| \\sim \\eta_0/L \\ll 1$ 时，与 $\\nabla_h \\cdot \\mathbf{Q}$ 相比是高阶项。在这个标准的小坡度假设下，主阶的深度积分质量守恒变为\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\nabla_h \\cdot \\mathbf{Q} = 0,\n$$\n将尺度代入并通除以 $U H / L$ 后，得到\n$$\n\\frac{\\eta_0}{H} \\frac{L}{U T} \\, \\frac{\\partial \\eta'}{\\partial t'} + \\nabla_h' \\cdot \\mathbf{Q}' = 0.\n$$\n使用平流时间尺度 $T = L/U$，这简化为\n$$\n\\underbrace{\\frac{\\eta_0}{H}}_{\\text{无量纲参数}} \\frac{\\partial \\eta'}{\\partial t'} + \\nabla_h' \\cdot \\mathbf{Q}' = 0.\n$$\n因此，乘以局部自由表面趋势的无量纲参数是\n$$\n\\epsilon = \\frac{\\eta_0}{H}.\n$$\n当 $\\epsilon \\ll 1$ 时，主阶平衡强制要求 $\\nabla_h' \\cdot \\mathbf{Q}' \\approx 0$，这就是通过抑制快速的自由表面调整来过滤外部重力波的刚盖约束。\n\n现在为三种场景评估 $\\epsilon$：\n\n- 开阔大洋：$H \\sim 4000\\,\\mathrm{m}$ 且 $\\eta_0 \\sim 0.1\\,\\mathrm{m}$ 给出\n$$\n\\epsilon_{\\text{open}} = \\frac{\\eta_0}{H} = \\frac{0.1}{4000} = 2.5 \\times 10^{-5}.\n$$\n\n- 强潮大陆架：$H \\sim 100\\,\\mathrm{m}$ 且 $\\eta_0 \\sim 2\\,\\mathrm{m}$ 给出\n$$\n\\epsilon_{\\text{tide}} = \\frac{2}{100} = 2.0 \\times 10^{-2}.\n$$\n\n- 浅海陆架上的极端风暴潮：$H \\sim 20\\,\\mathrm{m}$ 且 $\\eta_0 \\sim 3\\,\\mathrm{m}$ 给出\n$$\n\\epsilon_{\\text{surge}} = \\frac{3}{20} = 1.5 \\times 10^{-1}.\n$$\n\n四舍五入到 4 位有效数字，这些值为\n$$\n\\epsilon_{\\text{open}} = 2.500 \\times 10^{-5}, \\quad \\epsilon_{\\text{tide}} = 2.000 \\times 10^{-2}, \\quad \\epsilon_{\\text{surge}} = 1.500 \\times 10^{-1}.\n$$\n\n关于机制的有效性，无量纲形式表明，当 $\\epsilon \\ll 1$ 时，与输运散度相比，局部自由表面趋势项是渐近小的。在此极限下，刚盖近似是一致的：相对于平流时间，正压模瞬时调整，外部重力波被过滤，主阶约束为 $\\nabla_h \\cdot \\mathbf{Q} \\approx 0$。这是开阔大洋的特征，其 $\\epsilon_{\\text{open}} \\sim 2.5 \\times 10^{-5}$。相比之下，对于大陆架上的潮汐和风暴潮，$\\epsilon$ 并不小（$\\epsilon_{\\text{tide}} \\sim 2.0 \\times 10^{-2}$；$\\epsilon_{\\text{surge}} \\sim 1.5 \\times 10^{-1}$），因此自由表面趋势在主阶上起作用，刚盖近似无法捕捉主导的正压动力学，使其不适用于显式模拟此类现象。",
            "answer": "$$\\boxed{\\begin{pmatrix}2.500 \\times 10^{-5} & 2.000 \\times 10^{-2} & 1.500 \\times 10^{-1}\\end{pmatrix}}$$"
        },
        {
            "introduction": "实施刚盖近似从根本上将数值问题从一个针对自由水面的预报问题，转变为一个针对类压力变量的诊断问题。这种转变引入了一项核心计算任务：在整个模型域上求解一个椭圆方程。本练习提供了在交错网格上使用有限体积法离散化该椭圆算子的必要动手经验，这是构建刚盖海洋模型的基石技术 。",
            "id": "3815933",
            "problem": "在计算海洋学中，考虑刚盖近似下的正压约束，其中表面压力场 $\\pi$ 满足一个形如 $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$ 的椭圆算子，其中 $H$ 是层厚度（静水平衡下的总水柱深度）。在一个水平方向上间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格上进行计算，并采用Arakawa C-grid（C-grid）交错网格：标量场 $\\pi$ 位于示踪物网格中心 $(i,j)$，而通量的法向分量位于网格单元的边界面 $(i\\pm\\frac{1}{2},j)$ 和 $(i,j\\pm\\frac{1}{2})$。使用从散度定理推导出的有限体积公式，构建算子 $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$ 在示踪物网格 $(i,j)$ 处的一个二阶精确离散近似。该近似需要用中心值 $\\pi_{i,j}$ 和边界面深度 $H_{i\\pm\\frac{1}{2},j}$、$H_{i,j\\pm\\frac{1}{2}}$ 来表示。假设网格间距是均匀的，并通过相邻网格中心深度的某种一致的对称平均（例如，算术平均）来近似边界面深度，因此 $H_{i+\\frac{1}{2},j}$ 取决于 $H_{i,j}$ 和 $H_{i+1,j}$，在 $y$ 方向上也是如此。从穿过每个边界面的通量出发，根据第一性原理推导该离散算子，并明确展示该计算模板如何通过边界面深度将相邻网格耦合起来。你的最终答案必须是 $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$ 在 $(i,j)$ 处的离散有限体积近似的单个封闭形式解析表达式，用 $\\pi_{i,j}$ 及其最近邻点以及边界面深度 $H_{i\\pm\\frac{1}{2},j}$ 和 $H_{i,j\\pm\\frac{1}{2}}$ 来表示。不要包含任何边界条件的贡献；假设 $(i,j)$ 是一个严格的内部网格。只表达作用于 $\\pi$ 的算子；不要包含等式右边的项。不需要任何数值。",
            "solution": "该问题陈述是计算海洋学领域中一个有效且适定的任务。它要求在交错网格上推导一个椭圆算子的标准有限体积离散化。所有必要的组成部分都已提供，并且该问题在科学上和数学上都是合理的。\n\n我们的任务是在Arakawa C-grid上，为示踪物网格 $(i,j)$ 中心的算子 $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$ 构建一个离散近似。我们将采用有限体积法，该方法首先将算子在示踪物网格的面积上进行积分。设该网格是一个以 $(x_i, y_j)$ 为中心、边长均匀为 $\\Delta x$ 和 $\\Delta y$ 的矩形。该控制体的面积为 $A_{i,j} = \\Delta x \\Delta y$。\n\n该算子在网格面积 $A_{i,j}$ 上的积分为\n$$ \\iint_{A_{i,j}} \\nabla\\cdot\\left(H\\nabla\\pi\\right) dA $$\n根据散度定理，这个面积分等于通量向量 $\\mathbf{F} = H\\nabla\\pi$ 的法向分量沿网格边界 $\\partial A_{i,j}$ 的线积分：\n$$ \\iint_{A_{i,j}} \\nabla\\cdot\\left(H\\nabla\\pi\\right) dA = \\oint_{\\partial A_{i,j}} (H\\nabla\\pi) \\cdot \\mathbf{n} \\, dl $$\n其中 $\\mathbf{n}$ 是指向网格边界外部的单位法向量。\n\n左侧控制体面积上的积分可以用算子在网格中心 $(i,j)$ 的值乘以网格面积来近似。设离散算子表示为 $\\mathcal{L}(\\pi_{i,j})$。\n$$ \\iint_{A_{i,j}} \\nabla\\cdot\\left(H\\nabla\\pi\\right) dA \\approx \\mathcal{L}(\\pi_{i,j}) \\Delta x \\Delta y $$\n我们的目标是找到 $\\mathcal{L}(\\pi_{i,j})$ 的表达式。\n\n右侧的线积分是穿过矩形网格四个边界面通量的总和。这些边界面位于 $x_{i\\pm 1/2}$ 和 $y_{j\\pm 1/2}$。该积分可以写成四项之和：\n$$ \\oint_{\\partial A_{i,j}} (H\\nabla\\pi) \\cdot \\mathbf{n} \\, dl = \\int_{y_{j-1/2}}^{y_{j+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{x_{i+1/2}} dy - \\int_{y_{j-1/2}}^{y_{j+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{x_{i-1/2}} dy + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{y_{j+1/2}} dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{y_{j-1/2}} dx $$\n我们用被积函数在边界面中心的值乘以边界面长度来近似每个积分。$x$ 方向的通量分量 $F_x = H \\frac{\\partial\\pi}{\\partial x}$ 在边界面 $(i\\pm\\frac{1}{2}, j)$ 处计算，而 $y$ 方向的通量分量 $F_y = H \\frac{\\partial\\pi}{\\partial y}$ 在边界面 $(i, j\\pm\\frac{1}{2})$ 处计算。这些边界面长度分别为 $\\Delta y$ 和 $\\Delta x$。\n\n因此，流出网格的净通量近似为：\n$$ \\text{净通量} \\approx \\left[ (F_x)_{i+\\frac{1}{2},j} - (F_x)_{i-\\frac{1}{2},j} \\right] \\Delta y + \\left[ (F_y)_{i,j+\\frac{1}{2}} - (F_y)_{i,j-\\frac{1}{2}} \\right] \\Delta x $$\n\n现在，我们对边界面上的通量分量进行离散化。Arakawa C-grid 交错网格将标量场 $\\pi$ 放置在网格中心 $(i,j)$。利用来自两个相邻网格中心的 $\\pi$ 值，可以自然地形成一个在边界面上对 $\\pi$ 的梯度的二阶精确中心差分近似。\n\n对于穿过右边界面 $(i+\\frac{1}{2}, j)$ 的通量：\n$$ (F_x)_{i+\\frac{1}{2},j} = \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{i+\\frac{1}{2},j} \\approx H_{i+\\frac{1}{2},j} \\left( \\frac{\\pi_{i+1,j} - \\pi_{i,j}}{\\Delta x} \\right) $$\n对于穿过左边界面 $(i-\\frac{1}{2}, j)$ 的通量：\n$$ (F_x)_{i-\\frac{1}{2},j} = \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{i-\\frac{1}{2},j} \\approx H_{i-\\frac{1}{2},j} \\left( \\frac{\\pi_{i,j} - \\pi_{i-1,j}}{\\Delta x} \\right) $$\n对于穿过上边界面 $(i, j+\\frac{1}{2})$ 的通量：\n$$ (F_y)_{i,j+\\frac{1}{2}} = \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{i,j+\\frac{1}{2}} \\approx H_{i,j+\\frac{1}{2}} \\left( \\frac{\\pi_{i,j+1} - \\pi_{i,j}}{\\Delta y} \\right) $$\n对于穿过下边界面 $(i, j-\\frac{1}{2})$ 的通量：\n$$ (F_y)_{i,j-\\frac{1}{2}} = \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{i,j-\\frac{1}{2}} \\approx H_{i,j-\\frac{1}{2}} \\left( \\frac{\\pi_{i,j} - \\pi_{i,j-1}}{\\Delta y} \\right) $$\n在这些表达式中，$H_{i\\pm\\frac{1}{2},j}$ 和 $H_{i,j\\pm\\frac{1}{2}}$ 表示在各自网格边界面上计算的层厚度。\n\n将这些离散通量代入净通量表达式：\n$$ \\text{净通量} \\approx \\left[ H_{i+\\frac{1}{2},j} \\frac{\\pi_{i+1,j} - \\pi_{i,j}}{\\Delta x} - H_{i-\\frac{1}{2},j} \\frac{\\pi_{i,j} - \\pi_{i-1,j}}{\\Delta x} \\right] \\Delta y + \\left[ H_{i,j+\\frac{1}{2}} \\frac{\\pi_{i,j+1} - \\pi_{i,j}}{\\Delta y} - H_{i,j-\\frac{1}{2}} \\frac{\\pi_{i,j} - \\pi_{i,j-1}}{\\Delta y} \\right] \\Delta x $$\n令积分的两个近似相等，$\\mathcal{L}(\\pi_{i,j}) \\Delta x \\Delta y \\approx \\text{净通量}$，我们求解离散算子 $\\mathcal{L}(\\pi_{i,j})$：\n$$ \\mathcal{L}(\\pi_{i,j}) \\approx \\frac{1}{\\Delta x \\Delta y} \\left( \\left[ \\dots \\right] \\Delta y + \\left[ \\dots \\right] \\Delta x \\right) $$\n$$ \\mathcal{L}(\\pi_{i,j}) \\approx \\frac{1}{\\Delta x} \\left[ H_{i+\\frac{1}{2},j} \\frac{\\pi_{i+1,j} - \\pi_{i,j}}{\\Delta x} - H_{i-\\frac{1}{2},j} \\frac{\\pi_{i,j} - \\pi_{i-1,j}}{\\Delta x} \\right] + \\frac{1}{\\Delta y} \\left[ H_{i,j+\\frac{1}{2}} \\frac{\\pi_{i,j+1} - \\pi_{i,j}}{\\Delta y} - H_{i,j-\\frac{1}{2}} \\frac{\\pi_{i,j} - \\pi_{i,j-1}}{\\Delta y} \\right] $$\n将分母中含有 $(\\Delta x)^2$ 和 $(\\Delta y)^2$ 的项合并，得到离散算子的最终表达式：\n$$ \\mathcal{L}(\\pi_{i,j}) \\approx \\frac{1}{(\\Delta x)^2} \\left[ H_{i+\\frac{1}{2},j} (\\pi_{i+1,j} - \\pi_{i,j}) - H_{i-\\frac{1}{2},j} (\\pi_{i,j} - \\pi_{i-1,j}) \\right] + \\frac{1}{(\\Delta y)^2} \\left[ H_{i,j+\\frac{1}{2}} (\\pi_{i,j+1} - \\pi_{i,j}) - H_{i,j-\\frac{1}{2}} (\\pi_{i,j} - \\pi_{i,j-1}) \\right] $$\n此表达式代表了在示踪物网格 $(i,j)$ 处对 $\\nabla\\cdot(H\\nabla\\pi)$ 的二阶精确有限体积离散化。它形成了一个5点计算模板，将中心网格 $(i,j)$ 与其四个最近的邻居耦合起来。与 $+x$ 方向的邻居（网格 $(i+1,j)$）的耦合是通过边界面深度 $H_{i+\\frac{1}{2},j}$ 来实现的，其他邻居也类似，这正是题目所明确要求的。",
            "answer": "$$\n\\boxed{ \\frac{1}{(\\Delta x)^2} \\left[ H_{i+\\frac{1}{2}, j} (\\pi_{i+1, j} - \\pi_{i, j}) - H_{i-\\frac{1}{2}, j} (\\pi_{i, j} - \\pi_{i-1, j}) \\right] + \\frac{1}{(\\Delta y)^2} \\left[ H_{i, j+\\frac{1}{2}} (\\pi_{i, j+1} - \\pi_{i, j}) - H_{i, j-\\frac{1}{2}} (\\pi_{i, j} - \\pi_{i, j-1}) \\right] }\n$$"
        }
    ]
}