{
    "hands_on_practices": [
        {
            "introduction": "The validity of any physical approximation is not absolute but depends critically on the scales of the phenomena being studied. This first practice guides you through a formal scale analysis of the governing equations to uncover the physical foundation of the rigid-lid approximation. By nondimensionalizing the depth-integrated continuity equation, you will derive the key dimensionless parameter that determines the approximation's accuracy and explore realistic oceanic scenarios where it is justified and where it fails .",
            "id": "3815928",
            "problem": "Consider a hydrostatic, Boussinesq ocean of mean depth $H$ with a free surface displacement $\\eta(x,y,t)$ and horizontal velocity $\\mathbf{u}_h(x,y,z,t)$. Assume an incompressible fluid so that $\\nabla \\cdot \\mathbf{u} = 0$, with $\\mathbf{u} = (u,v,w)$, and the standard kinematic boundary conditions at the flat bottom $z=-H$ and at the moving free surface $z=\\eta(x,y,t)$. Starting from these principles and without invoking any specialized rigid-lid formulas, perform the following:\n\n1) Depth-integrate the incompressible mass conservation equation using the kinematic boundary conditions to obtain an exact depth-integrated continuity equation for the free surface displacement $\\eta(x,y,t)$ and the depth-integrated horizontal transport $\\displaystyle \\mathbf{Q}(x,y,t) = \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz$. Then, introduce characteristic scales $L$ for horizontal length, $U$ for horizontal velocity magnitude, $H$ for vertical length, and $\\eta_0$ for free surface amplitude, together with the advective timescale $T=L/U$. Nondimensionalize the depth-integrated continuity equation and identify the dimensionless parameter that multiplies the local free surface tendency term. Express this parameter purely in terms of the amplitude ratio $\\eta_0$ and the mean depth $H$.\n\n2) Using your result from part $1)$, evaluate this parameter for three scientifically relevant scenarios:\n- Open-ocean background variability: $H \\sim 4000\\,\\mathrm{m}$, $\\eta_0 \\sim 0.1\\,\\mathrm{m}$.\n- Macrotidal continental shelf: $H \\sim 100\\,\\mathrm{m}$, $\\eta_0 \\sim 2\\,\\mathrm{m}$.\n- Extreme storm surge over a shallow shelf: $H \\sim 20\\,\\mathrm{m}$, $\\eta_0 \\sim 3\\,\\mathrm{m}$.\n\nReport the three nondimensional values as a single row vector, in the order listed above.\n\n3) Briefly, and strictly in terms of your nondimensional result, explain the regime in which the rigid-lid approximation is asymptotically consistent and when it is expected to fail dynamically.\n\nFor item $2)$, round each reported value to $4$ significant figures. These quantities are nondimensional; report without units. The final answer must be the single row vector containing the three rounded values, in the order specified above.",
            "solution": "We begin from the incompressible continuity equation for a Boussinesq fluid,\n$$\n\\nabla \\cdot \\mathbf{u} \\equiv \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0.\n$$\nIntegrate in the vertical from the flat bottom $z=-H$ to the free surface $z=\\eta(x,y,t)$:\n$$\n\\int_{-H}^{\\eta} \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} \\right) dz = 0.\n$$\nUsing the fundamental theorem of calculus on the vertical divergence term and exchanging horizontal derivatives with the integral gives\n$$\n\\nabla_h \\cdot \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz + \\left. w \\right|_{z=\\eta} - \\left. w \\right|_{z=-H} = 0,\n$$\nwhere $\\nabla_h \\cdot (\\cdot) = \\frac{\\partial}{\\partial x}(\\cdot) + \\frac{\\partial}{\\partial y}(\\cdot)$ and $\\mathbf{u}_h = (u,v)$.\n\nApply the kinematic boundary conditions. For a flat bottom, impermeability implies\n$$\n\\left. w \\right|_{z=-H} = 0.\n$$\nAt the free surface, material conservation of the surface yields\n$$\n\\left. w \\right|_{z=\\eta} = \\frac{\\partial \\eta}{\\partial t} + \\mathbf{u}_h(x,y,\\eta,t) \\cdot \\nabla_h \\eta.\n$$\nSubstituting these into the vertically integrated continuity gives the exact depth-integrated equation\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\nabla_h \\cdot \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz + \\mathbf{u}_h(x,y,\\eta,t) \\cdot \\nabla_h \\eta = 0.\n$$\nDefine the depth-integrated transport\n$$\n\\mathbf{Q}(x,y,t) = \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz,\n$$\nso that the equation reads\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\nabla_h \\cdot \\mathbf{Q} + \\mathbf{u}_h(x,y,\\eta,t) \\cdot \\nabla_h \\eta = 0.\n$$\n\nTo expose the small parameter controlling the free surface dynamics relative to the depth-integrated transport, introduce characteristic scales: horizontal length $L$, velocity $U$, depth $H$, free surface amplitude $\\eta_0$, and the advective time $T=L/U$. Define nondimensional variables\n$$\nx' = \\frac{x}{L}, \\quad y' = \\frac{y}{L}, \\quad z' = \\frac{z}{H}, \\quad t' = \\frac{t}{T}, \\quad \\eta' = \\frac{\\eta}{\\eta_0}, \\quad \\mathbf{u}_h' = \\frac{\\mathbf{u}_h}{U}.\n$$\nThe depth-integrated transport scales as\n$$\n\\mathbf{Q} \\sim \\int_{-H}^{\\eta} \\mathbf{u}_h \\, dz \\sim U H,\n$$\nand we set $\\mathbf{Q}' = \\mathbf{Q}/(U H)$ so that $\\nabla_h \\cdot \\mathbf{Q} = (U H / L)\\, \\nabla_h' \\cdot \\mathbf{Q}'$. The free surface tendency scales as $\\partial \\eta / \\partial t \\sim \\eta_0 / T$. The surface slope term $\\mathbf{u}_h(\\eta) \\cdot \\nabla_h \\eta$ scales as $U \\, (\\eta_0 / L)$ and is thus higher order compared to $\\nabla_h \\cdot \\mathbf{Q}$ when surface slopes are small, that is, when $|\\nabla_h \\eta| \\sim \\eta_0/L \\ll 1$. Under this standard small-slope assumption, the leading-order depth-integrated mass conservation becomes\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\nabla_h \\cdot \\mathbf{Q} = 0,\n$$\nwhich, upon substituting scales and dividing through by $U H / L$, yields\n$$\n\\frac{\\eta_0}{H} \\frac{L}{U T} \\, \\frac{\\partial \\eta'}{\\partial t'} + \\nabla_h' \\cdot \\mathbf{Q}' = 0.\n$$\nWith the advective timescale $T = L/U$, this reduces to\n$$\n\\underbrace{\\frac{\\eta_0}{H}}_{\\text{dimensionless parameter}} \\frac{\\partial \\eta'}{\\partial t'} + \\nabla_h' \\cdot \\mathbf{Q}' = 0.\n$$\nTherefore, the nondimensional parameter multiplying the local free surface tendency is\n$$\n\\epsilon = \\frac{\\eta_0}{H}.\n$$\nWhen $\\epsilon \\ll 1$, the leading-order balance enforces $\\nabla_h' \\cdot \\mathbf{Q}' \\approx 0$, which is the rigid-lid constraint that filters external gravity waves by suppressing the fast free surface adjustment.\n\nNow evaluate $\\epsilon$ for the three scenarios:\n\n- Open ocean: $H \\sim 4000\\,\\mathrm{m}$ and $\\eta_0 \\sim 0.1\\,\\mathrm{m}$ give\n$$\n\\epsilon_{\\text{open}} = \\frac{\\eta_0}{H} = \\frac{0.1}{4000} = 2.5 \\times 10^{-5}.\n$$\n\n- Macrotidal shelf: $H \\sim 100\\,\\mathrm{m}$ and $\\eta_0 \\sim 2\\,\\mathrm{m}$ give\n$$\n\\epsilon_{\\text{tide}} = \\frac{2}{100} = 2.0 \\times 10^{-2}.\n$$\n\n- Extreme storm surge on a shallow shelf: $H \\sim 20\\,\\mathrm{m}$ and $\\eta_0 \\sim 3\\,\\mathrm{m}$ give\n$$\n\\epsilon_{\\text{surge}} = \\frac{3}{20} = 1.5 \\times 10^{-1}.\n$$\n\nRounded to $4$ significant figures, these are\n$$\n\\epsilon_{\\text{open}} = 2.500 \\times 10^{-5}, \\quad \\epsilon_{\\text{tide}} = 2.000 \\times 10^{-2}, \\quad \\epsilon_{\\text{surge}} = 1.500 \\times 10^{-1}.\n$$\n\nRegarding regime validity, the nondimensional form shows that when $\\epsilon \\ll 1$ the local free surface tendency term is asymptotically small compared to the transport divergence. In this limit, the rigid-lid approximation is consistent: the barotropic mode adjusts instantaneously relative to the advective time, external gravity waves are filtered, and the leading-order constraint is $\\nabla_h \\cdot \\mathbf{Q} \\approx 0$. This is characteristic of the open ocean with $\\epsilon_{\\text{open}} \\sim 2.5 \\times 10^{-5}$. In contrast, for tides and storm surges on shelves, $\\epsilon$ is not small ($\\epsilon_{\\text{tide}} \\sim 2.0 \\times 10^{-2}$; $\\epsilon_{\\text{surge}} \\sim 1.5 \\times 10^{-1}$), so free surface tendencies contribute at leading order, and the rigid-lid approximation fails to capture the dominant barotropic dynamics, rendering it inappropriate for explicitly simulating such phenomena.",
            "answer": "$$\\boxed{\\begin{pmatrix}2.500 \\times 10^{-5} & 2.000 \\times 10^{-2} & 1.500 \\times 10^{-1}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Beyond its physical rationale for large-scale flows, the rigid-lid approximation is primarily employed for its immense computational advantage. This exercise explores the dynamics of the fast-moving external gravity waves that the approximation is designed to filter out. By deriving the wave speed and analyzing the stringent time-step constraint imposed by the Courant-Friedrichs-Lewy (CFL) condition in a free-surface model, you will quantify the dramatic increase in computational efficiency that the rigid-lid model affords .",
            "id": "4072669",
            "problem": "Consider an Ocean General Circulation Model (OGCM) free-surface barotropic mode represented, in the long-wave, hydrostatic, and Boussinesq limit, by the one-layer linearized shallow-water equations on a Cartesian plane with constant mean depth $H$:\n$$\n\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x},\\quad \\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0,\n$$\nwhere $u$ is the depth-averaged horizontal velocity in the $x$ direction, $\\eta$ is the free-surface displacement, and $g$ is gravitational acceleration. Starting from these equations and first principles (conservation of momentum and mass), derive the dispersion relation for small-amplitude plane waves and obtain the external gravity-wave phase speed in terms of $g$ and $H$. Then, for a global ocean with representative mean depth $H = 4000\\ \\mathrm{m}$ and gravitational acceleration $g = 9.81\\ \\mathrm{m/s^{2}}$, evaluate the external gravity-wave phase speed. Using your derived speed, reason about the explicit time-step constraint implied by the Courant-Friedrichs-Lewy (CFL) condition for a one-dimensional barotropic free-surface solver with uniform grid spacing $\\Delta x = 25\\ \\mathrm{km}$, and compare qualitatively how this constraint changes if the model employs a rigid-lid approximation that removes the external mode.\n\nYour final numerical answer should be the external gravity-wave phase speed evaluated at $H = 4000\\ \\mathrm{m}$. Express the final speed in $\\mathrm{m/s}$ and round to four significant figures.",
            "solution": "The solution begins with the derivation of the dispersion relation for the given system of equations. The system is:\n$$\n\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0 \\quad (2)\n$$\nWe seek plane-wave solutions of the form:\n$$\nu(x, t) = U_0 \\exp[i(kx - \\omega t)]\n$$\n$$\n\\eta(x, t) = \\eta_0 \\exp[i(kx - \\omega t)]\n$$\nwhere $k$ is the wavenumber, $\\omega$ is the angular frequency, $U_0$ is the complex amplitude of the velocity, and $\\eta_0$ is the complex amplitude of the surface displacement.\n\nSubstituting these forms into equations $(1)$ and $(2)$ involves taking partial derivatives:\n$\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$\n$\\frac{\\partial}{\\partial x} \\rightarrow ik$\n\nApplying these to equation $(1)$:\n$$\n-i\\omega (U_0 \\exp[i(kx - \\omega t)]) = -g (ik) (\\eta_0 \\exp[i(kx - \\omega t)])\n$$\nDividing by the exponential term and $-i$, we obtain a linear algebraic equation relating the amplitudes:\n$$\n\\omega U_0 = gk \\eta_0 \\quad (3)\n$$\n\nApplying the same to equation $(2)$:\n$$\n-i\\omega (\\eta_0 \\exp[i(kx - \\omega t)]) + H (ik) (U_0 \\exp[i(kx - \\omega t)]) = 0\n$$\nDividing by the exponential term and $i$:\n$$\n-\\omega \\eta_0 + Hk U_0 = 0 \\quad (4)\n$$\n\nWe now have a system of two homogeneous linear equations for $U_0$ and $\\eta_0$:\n$$\n\\omega U_0 - gk \\eta_0 = 0\n$$\n$$\nHk U_0 - \\omega \\eta_0 = 0\n$$\nFor a non-trivial solution (where $U_0$ and $\\eta_0$ are not both zero), the determinant of the coefficient matrix must be zero.\n$$\n\\det \\begin{pmatrix} \\omega & -gk \\\\ Hk & -\\omega \\end{pmatrix} = (\\omega)(-\\omega) - (-gk)(Hk) = 0\n$$\n$$\n-\\omega^2 + gHk^2 = 0\n$$\nThis leads to the dispersion relation for these waves:\n$$\n\\omega^2 = gHk^2\n$$\nThe phase speed, $c$, is defined as the ratio of angular frequency to wavenumber, $c = \\omega/k$. From the dispersion relation, we can solve for this ratio:\n$$\n\\frac{\\omega^2}{k^2} = gH \\implies \\left(\\frac{\\omega}{k}\\right)^2 = gH\n$$\nTaking the square root gives the phase speed:\n$$\nc = \\pm \\sqrt{gH}\n$$\nThe phase speed is a magnitude, so we take the positive root. This is the phase speed for external (barotropic) gravity waves:\n$$\nc = \\sqrt{gH}\n$$\nThe waves are non-dispersive, as the phase speed $c$ does not depend on the wavenumber $k$.\n\nNext, we evaluate this speed for the given parameters: $H = 4000\\ \\mathrm{m}$ and $g = 9.81\\ \\mathrm{m/s^{2}}$.\n$$\nc = \\sqrt{(9.81\\ \\mathrm{m/s^{2}}) (4000\\ \\mathrm{m})} = \\sqrt{39240\\ \\mathrm{m^2/s^{2}}}\n$$\n$$\nc \\approx 198.090888\\ \\mathrm{m/s}\n$$\nRounding to four significant figures as requested, the phase speed is $198.1\\ \\mathrm{m/s}$.\n\nFinally, we consider the implications for the numerical time-step constraint. The Courant-Friedrichs-Lewy (CFL) condition for an explicit numerical scheme for wave propagation dictates that the numerical domain of dependence must contain the physical domain of dependence. For a one-dimensional advection/wave equation, this is expressed as:\n$$\nC_{cfl} = \\frac{c_{max} \\Delta t}{\\Delta x} \\le 1\n$$\nwhere $c_{max}$ is the maximum wave speed in the system, $\\Delta t$ is the time step, and $\\Delta x$ is the grid spacing. This imposes an upper limit on the time step for numerical stability:\n$$\n\\Delta t \\le \\frac{\\Delta x}{c_{max}}\n$$\nIn the free-surface model, the fastest waves are the external gravity waves we have just analyzed. Therefore, $c_{max} = c = \\sqrt{gH} \\approx 198.1\\ \\mathrm{m/s}$. With a grid spacing of $\\Delta x = 25\\ \\mathrm{km} = 25000\\ \\mathrm{m}$, the maximum allowable time step is:\n$$\n\\Delta t \\le \\frac{25000\\ \\mathrm{m}}{198.1\\ \\mathrm{m/s}} \\approx 126.2\\ \\mathrm{s}\n$$\nThis time step of approximately $2$ minutes is very short for climate simulations, which must run for centuries or millennia, making such models computationally expensive.\n\nIn contrast, a model that employs a rigid-lid approximation enforces $\\eta = \\text{constant}$ or, more typically for dynamics, $\\frac{\\partial \\eta}{\\partial t} = 0$. Looking at equation $(2)$, this implies that $\\frac{\\partial u}{\\partial x} = 0$, meaning the flow is horizontally non-divergent. This approximation effectively filters out the fast external gravity waves, as their existence is tied to the free-surface displacement $\\eta$.\nWith the external gravity waves removed, the maximum wave speed $c_{max}$ in the model is then determined by other, much slower, wave phenomena. These typically include internal gravity waves (associated with density stratification, with speeds on the order of $1-3\\ \\mathrm{m/s}$) and planetary Rossby waves (even slower). If the fastest remaining waves have a speed of, for example, $c_{internal} \\approx 3\\ \\mathrm{m/s}$, the CFL condition becomes:\n$$\n\\Delta t \\le \\frac{25000\\ \\mathrm{m}}{3\\ \\mathrm{m/s}} \\approx 8333\\ \\mathrm{s}\n$$\nThis corresponds to a time step of about $2.3$ hours, which is much larger (a factor of roughly $66$) than the time step allowed in the free-surface model. Consequently, the rigid-lid approximation allows for vastly more efficient long-term integration of ocean models, at the cost of excluding phenomena like tides and tsunamis that depend on free-surface dynamics.",
            "answer": "$$\n\\boxed{198.1}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between continuous theory and discrete numerical implementation, revealing how the rigid-lid constraint reshapes the computational problem. Instead of prognosing the free-surface height with a wave equation, the approximation leads to a diagnostic elliptic equation for a surface pressure field. You will derive the finite-volume discretization of this elliptic operator on a staggered grid, a core skill for constructing and understanding the architecture of many ocean general circulation models .",
            "id": "3815933",
            "problem": "Consider the barotropic constraint under the rigid-lid approximation in computational oceanography, in which the surface pressure field $\\pi$ satisfies an elliptic operator of the form $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$, where $H$ is the layer thickness (total water column depth under hydrostatic balance). Work on a uniform horizontal grid with spacings $\\Delta x$ and $\\Delta y$, and adopt an Arakawa C-grid (C-grid) staggering: the scalar field $\\pi$ resides at tracer cell centers $(i,j)$, while normal components of fluxes reside on cell faces at $(i\\pm\\frac{1}{2},j)$ and $(i,j\\pm\\frac{1}{2})$. Using the finite-volume formulation derived from the divergence theorem, construct a second-order accurate discrete approximation of the operator $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$ evaluated at a tracer cell $(i,j)$ in terms of center values $\\pi_{i,j}$ and face depths $H_{i\\pm\\frac{1}{2},j}$, $H_{i,j\\pm\\frac{1}{2}}$. Assume uniform spacings and approximate face depths by a consistent symmetric average of adjacent cell-center depths (e.g., the arithmetic mean) so that $H_{i+\\frac{1}{2},j}$ depends on $H_{i,j}$ and $H_{i+1,j}$, and similarly in $y$. Derive the discrete operator from first principles starting from fluxes across each face, and show explicitly how the stencil couples adjacent cells through the face depths. Your final answer must be a single closed-form analytic expression for the discrete finite-volume approximation of $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$ at $(i,j)$ written in terms of $\\pi_{i,j}$ and its nearest neighbors and the face depths $H_{i\\pm\\frac{1}{2},j}$ and $H_{i,j\\pm\\frac{1}{2}}$. Do not include any boundary-condition contributions; assume $(i,j)$ is a strict interior cell. Express only the operator applied to $\\pi$; do not include equality to a right-hand side. No numerical values are required.",
            "solution": "We are tasked with constructing a discrete approximation for the operator $\\nabla\\cdot\\left(H\\nabla\\pi\\right)$ at the center of a tracer cell $(i,j)$ on an Arakawa C-grid. We will employ the finite-volume method, which begins by integrating the operator over the area of the tracer cell. Let the cell be a rectangle centered at $(x_i, y_j)$ with uniform side lengths $\\Delta x$ and $\\Delta y$. The area of this control volume is $A_{i,j} = \\Delta x \\Delta y$.\n\nThe integral of the operator over the cell area $A_{i,j}$ is\n$$ \\iint_{A_{i,j}} \\nabla\\cdot\\left(H\\nabla\\pi\\right) dA $$\nBy the divergence theorem, this area integral is equal to the line integral of the normal component of the flux vector $\\mathbf{F} = H\\nabla\\pi$ around the boundary of the cell, $\\partial A_{i,j}$:\n$$ \\iint_{A_{i,j}} \\nabla\\cdot\\left(H\\nabla\\pi\\right) dA = \\oint_{\\partial A_{i,j}} (H\\nabla\\pi) \\cdot \\mathbf{n} \\, dl $$\nwhere $\\mathbf{n}$ is the outward-pointing unit normal vector to the cell boundary.\n\nThe integral over the control volume area on the left-hand side can be approximated by the value of the operator at the cell center $(i,j)$ multiplied by the cell area. Let the discrete operator be denoted by $\\mathcal{L}(\\pi_{i,j})$.\n$$ \\iint_{A_{i,j}} \\nabla\\cdot\\left(H\\nabla\\pi\\right) dA \\approx \\mathcal{L}(\\pi_{i,j}) \\Delta x \\Delta y $$\nOur goal is to find an expression for $\\mathcal{L}(\\pi_{i,j})$.\n\nThe line integral on the right-hand side is the sum of the fluxes across the four faces of the rectangular cell. The faces are located at $x_{i\\pm 1/2}$ and $y_{j\\pm 1/2}$. The integral can be written as the sum of four terms:\n$$ \\oint_{\\partial A_{i,j}} (H\\nabla\\pi) \\cdot \\mathbf{n} \\, dl = \\int_{y_{j-1/2}}^{y_{j+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{x_{i+1/2}} dy - \\int_{y_{j-1/2}}^{y_{j+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{x_{i-1/2}} dy + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{y_{j+1/2}} dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{y_{j-1/2}} dx $$\nWe approximate each integral by the value of the integrand at the center of the face multiplied by the length of the face. The flux components in the $x$-direction, $F_x = H \\frac{\\partial\\pi}{\\partial x}$, are evaluated at faces $(i\\pm\\frac{1}{2}, j)$, and the flux components in the $y$-direction, $F_y = H \\frac{\\partial\\pi}{\\partial y}$, are evaluated at faces $(i, j\\pm\\frac{1}{2})$. The lengths of the faces are $\\Delta y$ and $\\Delta x$, respectively.\n\nThe net flux out of the cell is therefore approximated as:\n$$ \\text{Net Flux} \\approx \\left[ (F_x)_{i+\\frac{1}{2},j} - (F_x)_{i-\\frac{1}{2},j} \\right] \\Delta y + \\left[ (F_y)_{i,j+\\frac{1}{2}} - (F_y)_{i,j-\\frac{1}{2}} \\right] \\Delta x $$\n\nNow, we discretize the flux components at the cell faces. The Arakawa C-grid staggering places the scalar field $\\pi$ at cell centers $(i,j)$. A second-order accurate centered difference approximation for the gradient of $\\pi$ at a face is naturally formed using the $\\pi$ values from the two adjacent cell centers.\n\nFor the flux across the right face at $(i+\\frac{1}{2}, j)$:\n$$ (F_x)_{i+\\frac{1}{2},j} = \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{i+\\frac{1}{2},j} \\approx H_{i+\\frac{1}{2},j} \\left( \\frac{\\pi_{i+1,j} - \\pi_{i,j}}{\\Delta x} \\right) $$\nFor the flux across the left face at $(i-\\frac{1}{2}, j)$:\n$$ (F_x)_{i-\\frac{1}{2},j} = \\left(H \\frac{\\partial\\pi}{\\partial x}\\right)\\Big|_{i-\\frac{1}{2},j} \\approx H_{i-\\frac{1}{2},j} \\left( \\frac{\\pi_{i,j} - \\pi_{i-1,j}}{\\Delta x} \\right) $$\nFor the flux across the top face at $(i, j+\\frac{1}{2})$:\n$$ (F_y)_{i,j+\\frac{1}{2}} = \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{i,j+\\frac{1}{2}} \\approx H_{i,j+\\frac{1}{2}} \\left( \\frac{\\pi_{i,j+1} - \\pi_{i,j}}{\\Delta y} \\right) $$\nFor the flux across the bottom face at $(i, j-\\frac{1}{2})$:\n$$ (F_y)_{i,j-\\frac{1}{2}} = \\left(H \\frac{\\partial\\pi}{\\partial y}\\right)\\Big|_{i,j-\\frac{1}{2}} \\approx H_{i,j-\\frac{1}{2}} \\left( \\frac{\\pi_{i,j} - \\pi_{i,j-1}}{\\Delta y} \\right) $$\nIn these expressions, $H_{i\\pm\\frac{1}{2},j}$ and $H_{i,j\\pm\\frac{1}{2}}$ represent the layer thickness evaluated at the respective cell faces.\n\nSubstituting these discrete fluxes into the net flux expression:\n$$ \\text{Net Flux} \\approx \\left[ H_{i+\\frac{1}{2},j} \\frac{\\pi_{i+1,j} - \\pi_{i,j}}{\\Delta x} - H_{i-\\frac{1}{2},j} \\frac{\\pi_{i,j} - \\pi_{i-1,j}}{\\Delta x} \\right] \\Delta y + \\left[ H_{i,j+\\frac{1}{2}} \\frac{\\pi_{i,j+1} - \\pi_{i,j}}{\\Delta y} - H_{i,j-\\frac{1}{2}} \\frac{\\pi_{i,j} - \\pi_{i,j-1}}{\\Delta y} \\right] \\Delta x $$\nEquating the two approximations for the integral, $\\mathcal{L}(\\pi_{i,j}) \\Delta x \\Delta y \\approx \\text{Net Flux}$, we solve for the discrete operator $\\mathcal{L}(\\pi_{i,j})$:\n$$ \\mathcal{L}(\\pi_{i,j}) \\approx \\frac{1}{\\Delta x \\Delta y} \\left( \\left[ \\dots \\right] \\Delta y + \\left[ \\dots \\right] \\Delta x \\right) $$\n$$ \\mathcal{L}(\\pi_{i,j}) \\approx \\frac{1}{\\Delta x} \\left[ H_{i+\\frac{1}{2},j} \\frac{\\pi_{i+1,j} - \\pi_{i,j}}{\\Delta x} - H_{i-\\frac{1}{2},j} \\frac{\\pi_{i,j} - \\pi_{i-1,j}}{\\Delta x} \\right] + \\frac{1}{\\Delta y} \\left[ H_{i,j+\\frac{1}{2}} \\frac{\\pi_{i,j+1} - \\pi_{i,j}}{\\Delta y} - H_{i,j-\\frac{1}{2}} \\frac{\\pi_{i,j} - \\pi_{i,j-1}}{\\Delta y} \\right] $$\nCollecting terms with $(\\Delta x)^2$ and $(\\Delta y)^2$ in the denominators gives the final expression for the discrete operator:\n$$ \\mathcal{L}(\\pi_{i,j}) \\approx \\frac{1}{(\\Delta x)^2} \\left[ H_{i+\\frac{1}{2},j} (\\pi_{i+1,j} - \\pi_{i,j}) - H_{i-\\frac{1}{2},j} (\\pi_{i,j} - \\pi_{i-1,j}) \\right] + \\frac{1}{(\\Delta y)^2} \\left[ H_{i,j+\\frac{1}{2}} (\\pi_{i,j+1} - \\pi_{i,j}) - H_{i,j-\\frac{1}{2}} (\\pi_{i,j} - \\pi_{i,j-1}) \\right] $$\nThis expression represents the second-order accurate finite-volume discretization of $\\nabla\\cdot(H\\nabla\\pi)$ at the tracer cell $(i,j)$. It forms a 5-point stencil, coupling the central cell $(i,j)$ to its four nearest neighbors. The coupling to the neighbor in the $+x$ direction (cell $(i+1,j)$) is mediated by the face depth $H_{i+\\frac{1}{2},j}$, and similarly for the other neighbors, as explicitly requested.",
            "answer": "$$\n\\boxed{ \\frac{1}{(\\Delta x)^2} \\left[ H_{i+\\frac{1}{2}, j} (\\pi_{i+1, j} - \\pi_{i, j}) - H_{i-\\frac{1}{2}, j} (\\pi_{i, j} - \\pi_{i-1, j}) \\right] + \\frac{1}{(\\Delta y)^2} \\left[ H_{i, j+\\frac{1}{2}} (\\pi_{i, j+1} - \\pi_{i, j}) - H_{i, j-\\frac{1}{2}} (\\pi_{i, j} - \\pi_{i, j-1}) \\right] }\n$$"
        }
    ]
}