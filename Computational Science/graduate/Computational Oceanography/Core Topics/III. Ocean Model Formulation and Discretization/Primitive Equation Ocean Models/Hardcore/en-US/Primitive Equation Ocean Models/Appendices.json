{
    "hands_on_practices": [
        {
            "introduction": "In primitive equation models using explicit time-stepping, the maximum permissible time step, $\\Delta t$, is governed by the fastest-propagating waves in the system. This practice  guides you through deriving the speed of external gravity waves, $c_e$, and calculating the strict time-step limit they impose via the Courant–Friedrichs–Lewy (CFL) condition. This exercise reveals a critical challenge in computational oceanography and highlights why modelers often employ specialized numerical strategies to overcome this computational bottleneck.",
            "id": "3809052",
            "problem": "A hydrostatic, Boussinesq primitive equation ocean model with a free surface supports fast external gravity waves that constrain explicit time stepping through the Courant–Friedrichs–Lewy (CFL) condition. Consider the one-dimensional, linearized, inviscid, non-rotating shallow-water form of the external (barotropic) mode, derived from the primitive equations by depth-averaging the horizontal momentum and using mass conservation for the free surface. Starting from first principles, derive the phase speed of long external gravity waves and then determine the maximum explicit time step permitted by a CFL constraint when discretized on a uniform grid.\n\nAssume a uniform ocean of depth $H = 4000\\,\\mathrm{m}$, gravitational acceleration $g = 9.81\\,\\mathrm{m\\,s^{-2}}$, and a uniform horizontal grid spacing $\\Delta x = 10\\,\\mathrm{km}$. Use the CFL condition $c_{e}\\,\\Delta t / \\Delta x \\le 0.5$, where $c_{e}$ is the external gravity-wave phase speed that you will derive. Compute the maximum stable explicit time step $\\Delta t_{\\max}$ implied by this constraint.\n\nExpress your final answer in seconds, and round your answer to four significant figures. In addition, briefly explain in words the implications of this bound for model design choices in primitive equation ocean models, but ensure that the final numeric answer you report is only $\\Delta t_{\\max}$.",
            "solution": "The problem is subjected to validation.\n\nGivens are extracted verbatim from the problem statement:\n- Model type: Hydrostatic, Boussinesq primitive equation ocean model.\n- Governing equations for the external mode: One-dimensional, linearized, inviscid, non-rotating shallow-water form.\n- Uniform ocean depth: $H = 4000\\,\\mathrm{m}$.\n- Gravitational acceleration: $g = 9.81\\,\\mathrm{m\\,s^{-2}}$.\n- Uniform horizontal grid spacing: $\\Delta x = 10\\,\\mathrm{km}$.\n- CFL condition: $c_{e}\\,\\Delta t / \\Delta x \\le 0.5$.\n- $c_e$ is the external gravity-wave phase speed.\n- The task is to derive $c_e$ and compute the maximum stable explicit time step $\\Delta t_{\\max}$.\n\nThe problem is validated as follows:\n- **Scientifically Grounded**: The problem is based on the fundamental principles of geophysical fluid dynamics, specifically the theory of shallow water waves, which is a standard approximation in oceanography. The governing equations and the CFL stability condition are core concepts in computational fluid dynamics. The physical constants and model parameters ($H$, $g$, $\\Delta x$) are realistic for large-scale ocean modeling.\n- **Well-Posed**: The problem is clearly stated and provides all necessary information to derive the phase speed and calculate the time step. A unique and meaningful solution exists.\n- **Objective**: The problem is expressed in precise, quantitative scientific language, free of subjective or ambiguous terminology.\n\nThe problem is deemed **valid** as it is scientifically sound, well-posed, and objective. The solution process may proceed.\n\nThe first step is to derive the phase speed, $c_e$, of long external gravity waves. We start from the one-dimensional, linearized, inviscid, non-rotating shallow water equations. These equations describe the depth-averaged horizontal velocity $u(x, t)$ and the free surface elevation $\\eta(x, t)$ relative to the mean depth $H$. The equations are:\n\n1.  The momentum equation:\n    $$ \\frac{\\partial u}{\\partial t} = -g \\frac{\\partial \\eta}{\\partial x} $$\n2.  The continuity equation (mass conservation):\n    $$ \\frac{\\partial \\eta}{\\partial t} = -H \\frac{\\partial u}{\\partial x} $$\n\nTo find the characteristics of wave propagation, we seek plane wave solutions of the form:\n$$ u(x, t) = u_0 \\exp\\left(i(kx - \\omega t)\\right) $$\n$$ \\eta(x, t) = \\eta_0 \\exp\\left(i(kx - \\omega t)\\right) $$\nwhere $u_0$ and $\\eta_0$ are the constant amplitudes, $k$ is the wavenumber ($k = 2\\pi/\\lambda$, where $\\lambda$ is the wavelength), and $\\omega$ is the angular frequency.\n\nSubstituting these forms into the governing equations, the partial derivatives become:\n$$ \\frac{\\partial}{\\partial t} \\rightarrow -i\\omega $$\n$$ \\frac{\\partial}{\\partial x} \\rightarrow ik $$\n\nApplying these to the momentum and continuity equations yields a system of algebraic equations for the amplitudes $u_0$ and $\\eta_0$:\n$$ -i\\omega u_0 = -g (ik) \\eta_0 \\implies \\omega u_0 = gk \\eta_0 $$\n$$ -i\\omega \\eta_0 = -H (ik) u_0 \\implies \\omega \\eta_0 = Hk u_0 $$\n\nThis can be written in matrix form:\n$$\n\\begin{pmatrix}\n\\omega  -gk \\\\\n-Hk  \\omega\n\\end{pmatrix}\n\\begin{pmatrix}\nu_0 \\\\\n\\eta_0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFor a non-trivial solution (where $u_0$ and $\\eta_0$ are not both zero), the determinant of the coefficient matrix must be zero:\n$$ \\det \\begin{pmatrix}\n\\omega  -gk \\\\\n-Hk  \\omega\n\\end{pmatrix} = \\omega^2 - (-gk)(-Hk) = \\omega^2 - gHk^2 = 0 $$\nThis equation is the dispersion relation for shallow water waves:\n$$ \\omega^2 = gHk^2 $$\nSolving for $\\omega$ gives $\\omega = \\pm k \\sqrt{gH}$. The phase speed, $c_e$, is defined as the ratio of angular frequency to wavenumber, $c_e = \\omega/k$. Therefore, the phase speed of external gravity waves is:\n$$ c_e = \\sqrt{gH} $$\n\nThe next step is to calculate the numerical value of $c_e$ using the provided constants:\n$$ g = 9.81\\,\\mathrm{m\\,s^{-2}} $$\n$$ H = 4000\\,\\mathrm{m} $$\n$$ c_e = \\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}}) \\times (4000\\,\\mathrm{m})} = \\sqrt{39240\\,\\mathrm{m^2\\,s^{-2}}} \\approx 198.090888\\,\\mathrm{m\\,s^{-1}} $$\n\nNow, we determine the maximum stable explicit time step, $\\Delta t_{\\max}$, using the Courant–Friedrichs–Lewy (CFL) condition provided:\n$$ \\frac{c_e \\Delta t}{\\Delta x} \\le 0.5 $$\nThe maximum time step is found when the expression equals the upper limit:\n$$ \\frac{c_e \\Delta t_{\\max}}{\\Delta x} = 0.5 $$\nSolving for $\\Delta t_{\\max}$:\n$$ \\Delta t_{\\max} = \\frac{0.5 \\Delta x}{c_e} $$\nWe are given the grid spacing $\\Delta x = 10\\,\\mathrm{km}$. We must convert this to SI units to be consistent with $c_e$:\n$$ \\Delta x = 10\\,\\mathrm{km} = 10 \\times 10^3\\,\\mathrm{m} = 10000\\,\\mathrm{m} $$\nSubstituting the values for $\\Delta x$ and $c_e$:\n$$ \\Delta t_{\\max} = \\frac{0.5 \\times 10000\\,\\mathrm{m}}{198.090888\\,\\mathrm{m\\,s^{-1}}} \\approx 25.24090\\,\\mathrm{s} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\Delta t_{\\max} \\approx 25.24\\,\\mathrm{s} $$\n\nFinally, we briefly explain the implications of this bound for model design. The derived maximum time step of approximately $25$ seconds is very short, especially for climate simulations that must be integrated for many centuries or millennia. This severe limitation arises because the external gravity wave speed ($c_e \\approx 200\\,\\mathrm{m/s}$) is very high, propagating information rapidly across the grid. Using such a small time step for all oceanic processes, many of which are much slower (e.g., advection by ocean currents), is computationally prohibitive.\n\nThis constraint has driven the development of specific numerical techniques in primitive equation ocean models. The two most common strategies are:\n1.  **Split-Explicit Time Stepping (Mode Splitting):** The governing equations are separated into components describing the fast-moving external (barotropic) mode and the slower internal (baroclinic) modes. The barotropic mode is integrated with the small time step required by the CFL condition ($\\Delta t_{\\max}$), while the rest of the model, representing the bulk of the computation, is integrated with a much larger time step.\n2.  **Implicit Time Stepping:** The terms responsible for propagating the fast external waves are treated with a numerically implicit scheme. Implicit methods are not limited by the same CFL condition and can remain stable with much larger time steps, at the cost of having to solve a large system of linear equations (typically an elliptic problem for the sea surface height) at each time step.\n\nThese strategies allow ocean models to use a time step appropriate for the slower, energy-containing motions (e.g., eddies and currents) without becoming numerically unstable, thereby making long-term climate simulations computationally feasible.\n\nThe final numerical answer required is the value for $\\Delta t_{\\max}$.",
            "answer": "$$\n\\boxed{25.24}\n$$"
        },
        {
            "introduction": "While physical wave speeds set one limit, the numerical algorithms used to solve the governing equations impose their own stability constraints. This exercise  focuses on deriving the specific CFL condition for the advection of a tracer using a first-order upwind scheme. You will apply the fundamental method of von Neumann stability analysis to understand how grid spacing, flow speed, and the time step are intricately linked for a stable simulation.",
            "id": "3809026",
            "problem": "In a Primitive Equation ocean model, consider the one-dimensional horizontal advection of a passive tracer along the $x$-direction with constant velocity $U$ on a uniform rectilinear grid with spacings $\\Delta x=\\Delta y=5\\,\\mathrm{km}$ and $\\Delta z=50\\,\\mathrm{m}$. The tracer advection term is discretized using a first-order upwind spatial flux and forward Euler time stepping. Starting from the linear advection equation and using a Fourier (von Neumann) stability analysis, derive the Courant-Friedrichs-Lewy (CFL) stability requirement for this explicit advection scheme. Then, for the given maximum zonal velocity $U=0.5\\,\\mathrm{m\\,s^{-1}}$ and horizontal grid spacing $\\Delta x=5\\,\\mathrm{km}$, compute the largest stable time step $\\Delta t_{\\max}$ that satisfies the derived CFL constraint. Express your final numerical answer for $\\Delta t_{\\max}$ in seconds, and round your answer to four significant figures. Note that only the $x$-direction advection and the given $U$ should be used when assessing the advective stability in this calculation.",
            "solution": "The user wants to solve a problem in numerical methods for ocean modeling. I will first validate the problem statement according to the specified criteria.\n\n### Step 1: Extract Givens\n- **Model Context**: Primitive Equation ocean model.\n- **Physical Process**: One-dimensional horizontal advection of a passive tracer along the $x$-direction.\n- **Velocity**: Constant velocity $U$.\n- **Grid Type**: Uniform rectilinear grid.\n- **Grid Spacings**: $\\Delta x = \\Delta y = 5\\,\\mathrm{km}$, $\\Delta z = 50\\,\\mathrm{m}$.\n- **Numerical Scheme**:\n    - **Time Stepping**: Forward Euler.\n    - **Spatial Discretization**: First-order upwind spatial flux.\n- **Governing Equation**: Linear advection equation.\n- **Analysis Method**: Fourier (von Neumann) stability analysis.\n- **Objective 1**: Derive the Courant-Friedrichs-Lewy (CFL) stability requirement for the specified scheme.\n- **Objective 2**: Compute the largest stable time step, $\\Delta t_{\\max}$, for the given parameters.\n- **Parameters for Objective 2**:\n    - Maximum zonal velocity $U = 0.5\\,\\mathrm{m\\,s^{-1}}$.\n    - Horizontal grid spacing $\\Delta x = 5\\,\\mathrm{km}$.\n- **Final Answer Format**: Numerical value for $\\Delta t_{\\max}$ in seconds, rounded to four significant figures.\n- **Constraint**: Only the $x$-direction advection is to be considered.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is fundamentally sound. It addresses the stability of a numerical scheme for the linear advection equation, a core topic in computational fluid dynamics and numerical analysis. The methods employed (Forward Euler, upwind differencing, von Neumann analysis) and the result (CFL condition) are standard and well-established scientific concepts.\n- **Well-Posed**: The problem is well-posed. It provides all necessary information to uniquely derive the stability condition and compute the required time step. The problem specifies the equation, the discretization, the analysis method, and the parameters for calculation.\n- **Objective**: The problem is stated in precise, objective, and unambiguous language.\n- **Completeness and Consistency**: The problem is self-contained. While grid spacings $\\Delta y$ and $\\Delta z$ are provided, the explicit instruction to consider only one-dimensional advection in the $x$-direction makes this information extraneous but not contradictory. The data values are physically realistic for an ocean model and are dimensionally consistent once units are converted.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, well-posed problem in computational science. I will now proceed with the solution.\n\nThe one-dimensional linear advection equation for a passive tracer with concentration $C$ is given by:\n$$\n\\frac{\\partial C}{\\partial t} + U \\frac{\\partial C}{\\partial x} = 0\n$$\nwhere $U$ is the constant advection velocity in the $x$-direction.\n\nThe problem specifies a forward Euler scheme for the time derivative and a first-order upwind scheme for the spatial derivative. Let $C_j^n$ represent the tracer concentration at grid point $j$ and time step $n$, such that $x = j\\Delta x$ and $t = n\\Delta t$.\n\nThe forward Euler discretization of the time derivative is:\n$$\n\\frac{\\partial C}{\\partial t} \\approx \\frac{C_j^{n+1} - C_j^n}{\\Delta t}\n$$\nThe first-order upwind scheme for the spatial derivative depends on the sign of the velocity $U$. The problem gives $U = 0.5\\,\\mathrm{m\\,s^{-1}}$, which is positive. For $U  0$, the \"upwind\" direction is from the left (i.e., from grid point $j-1$), so a backward difference is used:\n$$\n\\frac{\\partial C}{\\partial x} \\approx \\frac{C_j^n - C_{j-1}^n}{\\Delta x}\n$$\nSubstituting these discretizations into the governing equation yields the finite-difference equation:\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} + U \\frac{C_j^n - C_{j-1}^n}{\\Delta x} = 0\n$$\nSolving for the concentration at the next time step, $C_j^{n+1}$:\n$$\nC_j^{n+1} = C_j^n - \\frac{U \\Delta t}{\\Delta x} (C_j^n - C_{j-1}^n)\n$$\nWe define the Courant number, $c$, as the dimensionless quantity:\n$$\nc = \\frac{U \\Delta t}{\\Delta x}\n$$\nThe finite-difference equation can then be written as:\n$$\nC_j^{n+1} = C_j^n - c(C_j^n - C_{j-1}^n) = (1 - c)C_j^n + cC_{j-1}^n\n$$\nTo perform a von Neumann stability analysis, we consider a single Fourier mode solution of the form:\n$$\nC_j^n = A^n e^{i k x_j} = A^n e^{i k j \\Delta x}\n$$\nwhere $i = \\sqrt{-1}$ is the imaginary unit, $k$ is the wavenumber, and $A^n$ is the amplitude at time step $n$. The solution at the next time step is related by an amplification factor $G$:\n$$\nC_j^{n+1} = A^{n+1} e^{i k j \\Delta x} = G A^n e^{i k j \\Delta x}\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must satisfy $|G| \\leq 1$ for all possible wavenumbers $k$.\n\nSubstituting the Fourier mode representation into the finite-difference equation:\n$$\nG A^n e^{i k j \\Delta x} = (1 - c) A^n e^{i k j \\Delta x} + c A^n e^{i k (j-1) \\Delta x}\n$$\nDividing by $A^n e^{i k j \\Delta x}$ (which is non-zero) isolates the amplification factor $G$:\n$$\nG = (1 - c) + c e^{-i k \\Delta x}\n$$\nUsing Euler's formula, $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$, with $\\theta = k \\Delta x$:\n$$\nG = 1 - c + c(\\cos(k \\Delta x) - i\\sin(k \\Delta x))\n$$\n$$\nG = (1 - c + c\\cos(k \\Delta x)) - i(c\\sin(k \\Delta x))\n$$\nThe stability condition is $|G| \\leq 1$, which is equivalent to $|G|^2 \\leq 1$. We compute the squared magnitude of $G$:\n$$\n|G|^2 = (\\mathrm{Re}(G))^2 + (\\mathrm{Im}(G))^2\n$$\n$$\n|G|^2 = (1 - c + c\\cos(k \\Delta x))^2 + (-c\\sin(k \\Delta x))^2\n$$\n$$\n|G|^2 = (1 - c(1 - \\cos(k \\Delta x)))^2 + c^2\\sin^2(k \\Delta x)\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(1 - \\cos(k \\Delta x))^2 + c^2\\sin^2(k \\Delta x)\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(1 - 2\\cos(k \\Delta x) + \\cos^2(k \\Delta x)) + c^2\\sin^2(k \\Delta x)\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(1 - 2\\cos(k \\Delta x) + \\cos^2(k \\Delta x) + \\sin^2(k \\Delta x))\n$$\nSince $\\cos^2(k \\Delta x) + \\sin^2(k \\Delta x) = 1$:\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(2 - 2\\cos(k \\Delta x))\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + 2c^2(1 - \\cos(k \\Delta x))\n$$\n$$\n|G|^2 = 1 + (2c^2 - 2c)(1 - \\cos(k \\Delta x))\n$$\nFor the scheme to be stable, we require $|G|^2 \\leq 1$ for all wavenumbers $k$:\n$$\n1 + (2c^2 - 2c)(1 - \\cos(k \\Delta x)) \\leq 1\n$$\n$$\n(2c^2 - 2c)(1 - \\cos(k \\Delta x)) \\leq 0\n$$\nThe term $(1 - \\cos(k \\Delta x))$ is always non-negative, ranging from $0$ to $2$. For the inequality to hold for all $k$, the other factor must be non-positive:\n$$\n2c^2 - 2c \\leq 0 \\implies 2c(c - 1) \\leq 0\n$$\nSince $U$, $\\Delta t$, and $\\Delta x$ are all positive physical quantities, the Courant number $c$ must be non-negative, i.e., $c \\geq 0$. For the product $c(c-1)$ to be non-positive under this condition, we must have $(c-1) \\leq 0$, which means $c \\leq 1$.\nThe complete stability criterion is therefore $0 \\leq c \\leq 1$. This is the Courant-Friedrichs-Lewy (CFL) stability requirement for this explicit advection scheme.\n$$\nc = \\frac{U \\Delta t}{\\Delta x} \\leq 1\n$$\nTo find the largest stable time step, $\\Delta t_{\\max}$, we set the Courant number to its maximum allowed value of $1$:\n$$\n\\frac{U \\Delta t_{\\max}}{\\Delta x} = 1 \\implies \\Delta t_{\\max} = \\frac{\\Delta x}{U}\n$$\nNow we substitute the given numerical values:\n- Velocity $U = 0.5\\,\\mathrm{m\\,s^{-1}}$.\n- Grid spacing $\\Delta x = 5\\,\\mathrm{km}$.\n\nFirst, we must ensure consistent units. We convert $\\Delta x$ from kilometers to meters:\n$$\n\\Delta x = 5\\,\\mathrm{km} = 5 \\times 1000\\,\\mathrm{m} = 5000\\,\\mathrm{m}\n$$\nNow, we can compute $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{5000\\,\\mathrm{m}}{0.5\\,\\mathrm{m\\,s^{-1}}} = 10000\\,\\mathrm{s}\n$$\nThe problem requires the answer to be rounded to four significant figures. The exact value is $10000$. To express this with four significant figures, we write it in scientific notation.\n$$\n\\Delta t_{\\max} = 1.000 \\times 10^4\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.000 \\times 10^4}\n$$"
        },
        {
            "introduction": "Numerical schemes can do more than just become unstable; their inherent discretization errors often introduce artificial effects that mimic physical processes. This advanced practice  delves into the concept of numerical diffusion, using a modified-equation analysis to quantify the spurious mixing introduced by a common advection scheme. This exercise demonstrates the critical task of balancing these numerical artifacts with explicit physical parameterizations to maintain the integrity of a model's solution.",
            "id": "3809018",
            "problem": "In a hydrostatic primitive equation ocean model, consider the horizontally homogeneous advection–diffusion of a passive tracer under a constant zonal velocity. The tracer conservation equation in one horizontal dimension is\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\kappa_{h}\\,\\frac{\\partial C}{\\partial x}\\right),\n$$\nwhere $C$ is tracer concentration, $u$ is the zonal velocity, and $\\kappa_{h}$ is the explicit horizontal diffusivity associated with a Laplacian mixing operator. Assume that the model advances $C$ using a first-order upwind (donor-cell) advection scheme on a uniform grid of spacing $\\Delta x$ and time step $\\Delta t$, with $u  0$.\n\nStarting from the conservation law and the discrete donor-cell update form, perform a modified-equation analysis to determine the leading-order spurious diffusion coefficient $\\kappa_{\\text{num}}$ induced by the advection scheme in terms of $u$, $\\Delta x$, and the Courant–Friedrichs–Lewy (CFL) number $C = u\\,\\Delta t / \\Delta x$. Then, require the total effective horizontal mixing to match a prescribed target $K_{\\text{tot}}$ by enforcing\n$$\nK_{\\text{tot}} = \\kappa_{h} + \\kappa_{\\text{num}}.\n$$\nGiven $u = 0.05$ m s$^{-1}$, $\\Delta x = 5.0 \\times 10^{3}$ m, $\\Delta t = 600$ s, and $K_{\\text{tot}} = 3.00 \\times 10^{2}$ m$^{2}$ s$^{-1}$, compute the required explicit horizontal diffusivity $\\kappa_{h}$ that ensures realistic tracer budgets (i.e., a nonnegative $\\kappa_{h}$). Round your final answer to four significant figures and express it in m$^{2}$ s$^{-1}$.",
            "solution": "The user has requested the computation of the required explicit horizontal diffusivity, $\\kappa_h$, in a hydrostatic primitive equation ocean model. This requires balancing a target total diffusivity, $K_{\\text{tot}}$, against the sum of the explicit diffusivity and the numerical (or spurious) diffusivity, $\\kappa_{\\text{num}}$, which arises from the discretization of the advection term.\n\nThe problem can be solved in two main steps:\n1.  Derive the expression for the leading-order numerical diffusion coefficient, $\\kappa_{\\text{num}}$, introduced by the first-order upwind (donor-cell) advection scheme. This is accomplished through a modified-equation analysis, which involves a Taylor series expansion of the discrete finite-difference equation.\n2.  Use the derived expression and the given parameters to calculate the numerical value of $\\kappa_{\\text{num}}$. Then, solve for $\\kappa_h$ using the provided relation $K_{\\text{tot}} = \\kappa_h + \\kappa_{\\text{num}}$.\n\n**Step 1: Modified-Equation Analysis**\n\nThe governing equation for the tracer $C$ is given by:\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\kappa_{h}\\,\\frac{\\partial C}{\\partial x}\\right)\n$$\nThe numerical scheme is applied to the advection part of the equation:\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = 0\n$$\nFor a constant positive velocity $u  0$, the first-order upwind (donor-cell) scheme on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$ is:\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} + u \\frac{C_j^n - C_{j-1}^n}{\\Delta x} = 0\n$$\nHere, $C_j^n$ represents the concentration $C$ at grid point $x_j = j \\Delta x$ and time $t^n = n \\Delta t$.\n\nTo find the modified equation that this scheme actually solves, we perform a Taylor series expansion of each term around the point $(x_j, t^n)$. Let partial derivatives at this point be denoted by subscripts (e.g., $C_t = \\frac{\\partial C}{\\partial t}$, $C_{xx} = \\frac{\\partial^2 C}{\\partial x^2}$).\n\nThe expansion for $C_j^{n+1} = C(x_j, t^n + \\Delta t)$ is:\n$$\nC_j^{n+1} = C_j^n + \\Delta t \\, C_t + \\frac{(\\Delta t)^2}{2} C_{tt} + O((\\Delta t)^3)\n$$\nThe expansion for $C_{j-1}^n = C(x_j - \\Delta x, t^n)$ is:\n$$\nC_{j-1}^n = C_j^n - \\Delta x \\, C_x + \\frac{(\\Delta x)^2}{2} C_{xx} - O((\\Delta x)^3)\n$$\nSubstituting these expansions into the finite-difference scheme:\n$$\n\\frac{1}{\\Delta t} \\left( C_j^n + \\Delta t \\, C_t + \\frac{(\\Delta t)^2}{2} C_{tt} + \\dots - C_j^n \\right) + \\frac{u}{\\Delta x} \\left( C_j^n - \\left( C_j^n - \\Delta x \\, C_x + \\frac{(\\Delta x)^2}{2} C_{xx} - \\dots \\right) \\right) = 0\n$$\nSimplifying the terms:\n$$\n\\left( C_t + \\frac{\\Delta t}{2} C_{tt} + \\dots \\right) + \\frac{u}{\\Delta x} \\left( \\Delta x \\, C_x - \\frac{(\\Delta x)^2}{2} C_{xx} + \\dots \\right) = 0\n$$\nRearranging to match the form of the original advection equation gives the modified equation:\n$$\nC_t + u C_x = - \\frac{\\Delta t}{2} C_{tt} + \\frac{u \\Delta x}{2} C_{xx} - \\text{H.O.T.}\n$$\nThe terms on the right-hand side represent the truncation error of the scheme. The leading-order error terms are proportional to $\\Delta t$ and $\\Delta x$. To express this error purely in terms of spatial derivatives, we can approximate the time derivative term $C_{tt}$ using the original PDE. The original PDE states $C_t = -u C_x$. Differentiating with respect to time gives $C_{tt} = \\frac{\\partial}{\\partial t}(-u C_x) = -u \\frac{\\partial}{\\partial x}(C_t)$. Substituting $C_t = -u C_x$ again yields:\n$$\nC_{tt} = -u \\frac{\\partial}{\\partial x}(-u C_x) = u^2 C_{xx}\n$$\nSubstituting this into the modified equation:\n$$\nC_t + u C_x = - \\frac{\\Delta t}{2} (u^2 C_{xx}) + \\frac{u \\Delta x}{2} C_{xx} - \\text{H.O.T.}\n$$\n$$\nC_t + u C_x = \\left( \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} \\right) C_{xx} - \\text{H.O.T.}\n$$\nFactoring out the term $\\frac{u \\Delta x}{2}$:\n$$\nC_t + u C_x = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right) C_{xx} - \\text{H.O.T.}\n$$\nThe dimensionless group $\\mathcal{C} = \\frac{u \\Delta t}{\\Delta x}$ is the Courant–Friedrichs–Lewy (CFL) number. The modified equation reveals that the first-order upwind scheme numerically solves the advection equation with an added second-derivative term, which has the form of a diffusion term.\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = \\kappa_{\\text{num}} \\frac{\\partial^2 C}{\\partial x^2}\n$$\nBy comparison, the leading-order spurious (or numerical) diffusion coefficient is:\n$$\n\\kappa_{\\text{num}} = \\frac{u \\Delta x}{2} (1 - \\mathcal{C}) = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n\n**Step 2: Calculation of the Explicit Diffusivity $\\kappa_h$**\n\nThe total effective horizontal diffusion in the model is the sum of the explicitly added diffusion $\\kappa_h$ and the numerical diffusion $\\kappa_{\\text{num}}$. The problem requires this sum to equal a target value $K_{\\text{tot}}$:\n$$\nK_{\\text{tot}} = \\kappa_h + \\kappa_{\\text{num}}\n$$\nFrom this, we can solve for the required explicit diffusivity:\n$$\n\\kappa_h = K_{\\text{tot}} - \\kappa_{\\text{num}} = K_{\\text{tot}} - \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\nNow, we substitute the provided numerical values:\n- $u = 0.05$ m s$^{-1}$\n- $\\Delta x = 5.0 \\times 10^{3}$ m\n- $\\Delta t = 600$ s\n- $K_{\\text{tot}} = 3.00 \\times 10^{2}$ m$^{2}$ s$^{-1}$\n\nFirst, we compute the CFL number $\\mathcal{C}$:\n$$\n\\mathcal{C} = \\frac{u \\Delta t}{\\Delta x} = \\frac{(0.05 \\, \\text{m s}^{-1}) (600 \\, \\text{s})}{5.0 \\times 10^{3} \\, \\text{m}} = \\frac{30}{5000} = 0.006\n$$\nSince $0  \\mathcal{C} \\le 1$, the upwind scheme is stable, and the numerical diffusion $\\kappa_{\\text{num}}$ is positive.\n\nNext, we compute the numerical diffusivity $\\kappa_{\\text{num}}$:\n$$\n\\kappa_{\\text{num}} = \\frac{u \\Delta x}{2} (1 - \\mathcal{C}) = \\frac{(0.05 \\, \\text{m s}^{-1})(5.0 \\times 10^{3} \\, \\text{m})}{2} (1 - 0.006)\n$$\n$$\n\\kappa_{\\text{num}} = \\frac{250}{2} (0.994) \\, \\text{m}^2 \\text{s}^{-1} = 125 \\times 0.994 \\, \\text{m}^2 \\text{s}^{-1} = 124.25 \\, \\text{m}^2 \\text{s}^{-1}\n$$\nFinally, we compute the required explicit diffusivity $\\kappa_h$:\n$$\n\\kappa_h = K_{\\text{tot}} - \\kappa_{\\text{num}} = 300 \\, \\text{m}^2 \\text{s}^{-1} - 124.25 \\, \\text{m}^2 \\text{s}^{-1} = 175.75 \\, \\text{m}^2 \\text{s}^{-1}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\kappa_h \\approx 175.8 \\, \\text{m}^2 \\text{s}^{-1}\n$$\nThis value is positive, which satisfies the condition for a realistic tracer budget, as it corresponds to a physically-based diffusive process rather than an anti-diffusive one.",
            "answer": "$$\n\\boxed{175.8}\n$$"
        }
    ]
}