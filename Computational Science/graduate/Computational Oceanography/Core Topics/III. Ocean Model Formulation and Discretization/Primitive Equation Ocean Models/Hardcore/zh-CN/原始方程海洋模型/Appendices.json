{
    "hands_on_practices": [
        {
            "introduction": "我们首先来解决许多显式海洋模型中最严格的稳定性约束：外部重力波的速度。本练习将引导您从浅水方程推导出波速，然后应用 Courant-Friedrichs-Lewy (CFL) 条件来确定最大允许时间步长 。掌握这一计算对于理解为何像时间分裂或隐式方法等技术对于实现计算上可行的气候模拟至关重要。",
            "id": "3809052",
            "problem": "一个具有自由表面的静力、Boussinesq原始方程海洋模型支持快速的外部重力波，这些重力波通过Courant–Friedrichs–Lewy (CFL) 条件约束了显式时间步长。考虑外部（正压）模的一维、线性化、无粘性、无旋转的浅水形式，该形式是通过对水平动量进行深度平均并利用自由表面的质量守恒从原始方程推导出来的。从第一性原理出发，推导长外部重力波的相速度，然后确定在均匀网格上离散化时，CFL约束所允许的最大显式时间步长。\n\n假设海洋深度均匀，为 $H = 4000\\,\\mathrm{m}$，重力加速度为 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，水平网格间距均匀，为 $\\Delta x = 10\\,\\mathrm{km}$。使用CFL条件 $c_{e}\\,\\Delta t / \\Delta x \\le 0.5$，其中 $c_{e}$ 是您将要推导的外部重力波相速度。计算此约束所隐含的最大稳定显式时间步长 $\\Delta t_{\\max}$。\n\n以秒为单位表示您的最终答案，并四舍五入到四位有效数字。此外，用文字简要解释此界限对原始方程海洋模型的设计选择有何影响，但请确保您报告的最终数值答案仅为 $\\Delta t_{\\max}$。",
            "solution": "此问题需要经过验证。\n\n从问题陈述中逐字提取给定条件：\n- 模型类型：静力、Boussinesq原始方程海洋模型。\n- 外部模的控制方程：一维、线性化、无粘性、无旋转的浅水形式。\n- 均匀海洋深度：$H = 4000\\,\\mathrm{m}$。\n- 重力加速度：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n- 均匀水平网格间距：$\\Delta x = 10\\,\\mathrm{km}$。\n- CFL条件：$c_{e}\\,\\Delta t / \\Delta x \\le 0.5$。\n- $c_e$ 是外部重力波相速度。\n- 任务是推导 $c_e$ 并计算最大稳定显式时间步长 $\\Delta t_{\\max}$。\n\n问题验证如下：\n- **科学依据**：该问题基于地球物理流体动力学的基本原理，特别是浅水波理论，这是海洋学中的一个标准近似。控制方程和CFL稳定性条件是计算流体动力学的核心概念。物理常数和模型参数（$H$、$g$、$\\Delta x$）对于大规模海洋模拟是现实的。\n- **适定性**：问题陈述清晰，并提供了推导相速度和计算时间步长所需的所有必要信息。存在唯一且有意义的解。\n- **客观性**：问题以精确、定量的科学语言表达，没有主观或模糊的术语。\n\n该问题被认为是**有效的**，因为其科学上合理、适定且客观。可以继续求解过程。\n\n第一步是推导长外部重力波的相速度 $c_e$。我们从一维、线性化、无粘性、无旋转的浅水方程开始。这些方程描述了相对于平均深度 $H$ 的深度平均水平速度 $u(x, t)$ 和自由表面高程 $\\eta(x, t)$。方程如下：\n\n1.  动量方程：\n    $$ \\frac{\\partial u}{\\partial t} = -g \\frac{\\partial \\eta}{\\partial x} $$\n2.  连续性方程（质量守恒）：\n    $$ \\frac{\\partial \\eta}{\\partial t} = -H \\frac{\\partial u}{\\partial x} $$\n\n为了找到波传播的特性，我们寻找如下形式的平面波解：\n$$ u(x, t) = u_0 \\exp\\left(i(kx - \\omega t)\\right) $$\n$$ \\eta(x, t) = \\eta_0 \\exp\\left(i(kx - \\omega t)\\right) $$\n其中 $u_0$ 和 $\\eta_0$ 是常数振幅，$k$ 是波数（$k = 2\\pi/\\lambda$，其中 $\\lambda$ 是波长），$\\omega$ 是角频率。\n\n将这些形式代入控制方程，偏导数变为：\n$$ \\frac{\\partial}{\\partial t} \\rightarrow -i\\omega $$\n$$ \\frac{\\partial}{\\partial x} \\rightarrow ik $$\n\n将这些应用于动量和连续性方程，得到一个关于振幅 $u_0$ 和 $\\eta_0$ 的代数方程组：\n$$ -i\\omega u_0 = -g (ik) \\eta_0 \\implies \\omega u_0 = gk \\eta_0 $$\n$$ -i\\omega \\eta_0 = -H (ik) u_0 \\implies \\omega \\eta_0 = Hk u_0 $$\n\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n\\omega  -gk \\\\\n-Hk  \\omega\n\\end{pmatrix}\n\\begin{pmatrix}\nu_0 \\\\\n\\eta_0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n为了得到非平凡解（即 $u_0$ 和 $\\eta_0$ 不全为零），系数矩阵的行列式必须为零：\n$$ \\det \\begin{pmatrix}\n\\omega  -gk \\\\\n-Hk  \\omega\n\\end{pmatrix} = \\omega^2 - (-gk)(-Hk) = \\omega^2 - gHk^2 = 0 $$\n这个方程是浅水波的色散关系：\n$$ \\omega^2 = gHk^2 $$\n求解 $\\omega$ 得到 $\\omega = \\pm k \\sqrt{gH}$。相速度 $c_e$ 定义为角频率与波数之比，即 $c_e = \\omega/k$。因此，外部重力波的相速度为：\n$$ c_e = \\sqrt{gH} $$\n\n下一步是使用给定的常数计算 $c_e$ 的数值：\n$$ g = 9.81\\,\\mathrm{m\\,s^{-2}} $$\n$$ H = 4000\\,\\mathrm{m} $$\n$$ c_e = \\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}}) \\times (4000\\,\\mathrm{m})} = \\sqrt{39240\\,\\mathrm{m^2\\,s^{-2}}} \\approx 198.090888\\,\\mathrm{m\\,s^{-1}} $$\n\n现在，我们使用给定的Courant–Friedrichs–Lewy (CFL) 条件来确定最大稳定显式时间步长 $\\Delta t_{\\max}$：\n$$ \\frac{c_e \\Delta t}{\\Delta x} \\le 0.5 $$\n当表达式等于上限时，找到最大时间步长：\n$$ \\frac{c_e \\Delta t_{\\max}}{\\Delta x} = 0.5 $$\n求解 $\\Delta t_{\\max}$：\n$$ \\Delta t_{\\max} = \\frac{0.5 \\Delta x}{c_e} $$\n给定网格间距 $\\Delta x = 10\\,\\mathrm{km}$。我们必须将其转换为国际单位制（SI units）以与 $c_e$ 保持一致：\n$$ \\Delta x = 10\\,\\mathrm{km} = 10 \\times 10^3\\,\\mathrm{m} = 10000\\,\\mathrm{m} $$\n代入 $\\Delta x$ 和 $c_e$ 的值：\n$$ \\Delta t_{\\max} = \\frac{0.5 \\times 10000\\,\\mathrm{m}}{198.090888\\,\\mathrm{m\\,s^{-1}}} \\approx 25.24090\\,\\mathrm{s} $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\Delta t_{\\max} \\approx 25.24\\,\\mathrm{s} $$\n\n最后，我们简要解释此界限对模型设计的影响。推导出的最大时间步长约为 $25$ 秒，这个时间非常短，特别是对于必须积分数百年或数千年的气候模拟而言。这个严格的限制是因为外部重力波的速度（$c_e \\approx 200\\,\\mathrm{m/s}$）非常高，能在网格上快速传播信息。对所有海洋过程（其中许多过程要慢得多，例如洋流的平流）都使用如此小的时间步长，在计算上是不可行的。\n\n这一约束推动了原始方程海洋模型中特定数值技术的发展。两种最常见的策略是：\n1.  **分裂显式时间步进（模态分裂）**：将控制方程分为描述快速移动的外部（正压）模和较慢的内部（斜压）模的分量。正压模使用CFL条件所需的小时间步长（$\\Delta t_{\\max}$）进行积分，而模型的其余部分（代表了大部分计算量）则使用大得多的时间步长进行积分。\n2.  **隐式时间步进**：负责传播快速外部波的项采用数值隐式格式处理。隐式方法不受相同的CFL条件限制，可以在大得多的时间步长下保持稳定，但代价是在每个时间步长都必须求解一个大型线性方程组（通常是关于海面高度的椭圆问题）。\n\n这些策略使得海洋模型可以对较慢的含能运动（例如涡流和洋流）使用合适的时间步长，而不会变得数值不稳定，从而使长期气候模拟在计算上变得可行。\n\n最终需要的数值答案是 $\\Delta t_{\\max}$ 的值。",
            "answer": "$$\n\\boxed{25.24}\n$$"
        },
        {
            "introduction": "尽管重力波通常设定了最严格的时间步长限制，但洋流对示踪剂和动量的平流过程也带来了其自身的稳定性要求。本练习侧重于使用强大的冯·诺依曼稳定性分析方法，为一个常见的平流方案推导其特定的 CFL 条件 。通过完成这一分析，您将掌握一项核心技能，用于评估海洋模型中各种数值方法的稳定性。",
            "id": "3809026",
            "problem": "在一个原始方程海洋模型中，考虑一个被动示踪剂沿 $x$ 方向以恒定速度 $U$ 在一个均匀的直线网格上进行的一维水平平流，其网格间距为 $\\Delta x=\\Delta y=5\\,\\mathrm{km}$ 和 $\\Delta z=50\\,\\mathrm{m}$。示踪剂平流项采用一阶迎风空间通量和向前欧拉时间步进进行离散化。从线性平流方程出发，使用傅里叶 (von Neumann) 稳定性分析，推导该显式平流格式的 Courant-Friedrichs-Lewy (CFL) 稳定性要求。然后，对于给定的最大纬向速度 $U=0.5\\,\\mathrm{m\\,s^{-1}}$ 和水平网格间距 $\\Delta x=5\\,\\mathrm{km}$，计算满足所推导的 CFL 约束的最大稳定时间步长 $\\Delta t_{\\max}$。将您计算出的 $\\Delta t_{\\max}$ 的最终数值答案以秒为单位表示，并四舍五入到四位有效数字。请注意，在评估此计算中的平流稳定性时，只应使用 $x$ 方向的平流和给定的 $U$。",
            "solution": "用户想要解决一个海洋模型数值方法中的问题。我将首先根据指定标准验证问题陈述。\n\n### 第 1 步：提取已知条件\n- **模型背景**：原始方程海洋模型。\n- **物理过程**：被动示踪剂沿 $x$ 方向的一维水平平流。\n- **速度**：恒定速度 $U$。\n- **网格类型**：均匀直线网格。\n- **网格间距**：$\\Delta x = \\Delta y = 5\\,\\mathrm{km}$，$\\Delta z = 50\\,\\mathrm{m}$。\n- **数值格式**：\n    - **时间步进**：向前欧拉法。\n    - **空间离散化**：一阶迎风空间通量。\n- **控制方程**：线性平流方程。\n- **分析方法**：傅里叶 (von Neumann) 稳定性分析。\n- **目标 1**：推导指定格式的 Courant-Friedrichs-Lewy (CFL) 稳定性要求。\n- **目标 2**：根据给定参数计算最大稳定时间步长 $\\Delta t_{\\max}$。\n- **目标 2 的参数**：\n    - 最大纬向速度 $U = 0.5\\,\\mathrm{m\\,s^{-1}}$。\n    - 水平网格间距 $\\Delta x = 5\\,\\mathrm{km}$。\n- **最终答案格式**：$\\Delta t_{\\max}$ 的数值，单位为秒，四舍五入到四位有效数字。\n- **约束**：只考虑 $x$ 方向的平流。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础**：该问题在根本上是合理的。它涉及线性平流方程数值格式的稳定性，这是计算流体动力学和数值分析的核心课题。所采用的方法（向前欧拉法、迎风差分、von Neumann 分析）和结果（CFL 条件）都是标准的、成熟的科学概念。\n- **适定性**：该问题是适定的。它提供了唯一推导稳定性条件和计算所需时间步长的所有必要信息。问题明确了方程、离散化方法、分析方法和计算参数。\n- **目标**：问题陈述精确、客观、无歧义。\n- **完整性与一致性**：该问题是自洽的。虽然提供了网格间距 $\\Delta y$ 和 $\\Delta z$，但明确指示只考虑 $x$ 方向的一维平流，使得这些信息是多余的但并不矛盾。数据值对于海洋模型是物理上现实的，并且在单位转换后维度上是一致的。\n\n### 第 3 步：结论与行动\n该问题是有效的。它是计算科学中一个标准的、适定的问题。我现在将着手解决。\n\n浓度为 $C$ 的被动示踪剂的一维线性平流方程由下式给出：\n$$\n\\frac{\\partial C}{\\partial t} + U \\frac{\\partial C}{\\partial x} = 0\n$$\n其中 $U$ 是 $x$ 方向的恒定平流速度。\n\n该问题指定了时间导数采用向前欧拉格式，空间导数采用一阶迎风格式。令 $C_j^n$ 表示在网格点 $j$ 和时间步 $n$ 处的示踪剂浓度，使得 $x = j\\Delta x$ 和 $t = n\\Delta t$。\n\n时间导数的向前欧拉离散化为：\n$$\n\\frac{\\partial C}{\\partial t} \\approx \\frac{C_j^{n+1} - C_j^n}{\\Delta t}\n$$\n空间导数的一阶迎风格式取决于速度 $U$ 的符号。问题给出 $U = 0.5\\,\\mathrm{m\\,s^{-1}}$，为正值。对于 $U > 0$， “迎风”方向来自左侧（即来自网格点 $j-1$），因此使用后向差分：\n$$\n\\frac{\\partial C}{\\partial x} \\approx \\frac{C_j^n - C_{j-1}^n}{\\Delta x}\n$$\n将这些离散化形式代入控制方程，得到有限差分方程：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} + U \\frac{C_j^n - C_{j-1}^n}{\\Delta x} = 0\n$$\n求解下一时间步的浓度 $C_j^{n+1}$：\n$$\nC_j^{n+1} = C_j^n - \\frac{U \\Delta t}{\\Delta x} (C_j^n - C_{j-1}^n)\n$$\n我们将库朗数（Courant number），$c$，定义为无量纲量：\n$$\nc = \\frac{U \\Delta t}{\\Delta x}\n$$\n于是，有限差分方程可以写成：\n$$\nC_j^{n+1} = C_j^n - c(C_j^n - C_{j-1}^n) = (1 - c)C_j^n + cC_{j-1}^n\n$$\n为了进行 von Neumann 稳定性分析，我们考虑一个单一傅里叶模态解，其形式为：\n$$\nC_j^n = A^n e^{i k x_j} = A^n e^{i k j \\Delta x}\n$$\n其中 $i = \\sqrt{-1}$ 是虚数单位，$k$ 是波数，$A^n$ 是在时间步 $n$ 的振幅。下一时间步的解通过一个增长因子 $G$ 相关联：\n$$\nC_j^{n+1} = A^{n+1} e^{i k j \\Delta x} = G A^n e^{i k j \\Delta x}\n$$\n为使数值格式稳定，增长因子的模必须对所有可能的波数 $k$ 满足 $|G| \\leq 1$。\n\n将傅里叶模态表示代入有限差分方程：\n$$\nG A^n e^{i k j \\Delta x} = (1 - c) A^n e^{i k j \\Delta x} + c A^n e^{i k (j-1) \\Delta x}\n$$\n等式两边同除以非零项 $A^n e^{i k j \\Delta x}$，分离出增长因子 $G$：\n$$\nG = (1 - c) + c e^{-i k \\Delta x}\n$$\n使用欧拉公式 $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$，其中 $\\theta = k \\Delta x$：\n$$\nG = 1 - c + c(\\cos(k \\Delta x) - i\\sin(k \\Delta x))\n$$\n$$\nG = (1 - c + c\\cos(k \\Delta x)) - i(c\\sin(k \\Delta x))\n$$\n稳定性条件是 $|G| \\leq 1$，这等价于 $|G|^2 \\leq 1$。我们计算 $G$ 的模的平方：\n$$\n|G|^2 = (\\mathrm{Re}(G))^2 + (\\mathrm{Im}(G))^2\n$$\n$$\n|G|^2 = (1 - c + c\\cos(k \\Delta x))^2 + (-c\\sin(k \\Delta x))^2\n$$\n$$\n|G|^2 = (1 - c(1 - \\cos(k \\Delta x)))^2 + c^2\\sin^2(k \\Delta x)\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(1 - \\cos(k \\Delta x))^2 + c^2\\sin^2(k \\Delta x)\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(1 - 2\\cos(k \\Delta x) + \\cos^2(k \\Delta x)) + c^2\\sin^2(k \\Delta x)\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(1 - 2\\cos(k \\Delta x) + \\cos^2(k \\Delta x) + \\sin^2(k \\Delta x))\n$$\n由于 $\\cos^2(k \\Delta x) + \\sin^2(k \\Delta x) = 1$：\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + c^2(2 - 2\\cos(k \\Delta x))\n$$\n$$\n|G|^2 = 1 - 2c(1 - \\cos(k \\Delta x)) + 2c^2(1 - \\cos(k \\Delta x))\n$$\n$$\n|G|^2 = 1 + (2c^2 - 2c)(1 - \\cos(k \\Delta x))\n$$\n为了使格式稳定，我们要求对于所有波数 $k$ 都有 $|G|^2 \\leq 1$：\n$$\n1 + (2c^2 - 2c)(1 - \\cos(k \\Delta x)) \\leq 1\n$$\n$$\n(2c^2 - 2c)(1 - \\cos(k \\Delta x)) \\leq 0\n$$\n项 $(1 - \\cos(k \\Delta x))$ 总是非负的，范围从 $0$ 到 $2$。为了使不等式对所有 $k$ 都成立，另一个因子必须是非正的：\n$$\n2c^2 - 2c \\leq 0 \\implies 2c(c - 1) \\leq 0\n$$\n由于 $U$、$\\Delta t$ 和 $\\Delta x$ 都是正的物理量，库朗数 $c$ 必须是非负的，即 $c \\geq 0$。在此条件下，要使乘积 $c(c-1)$ 为非正，我们必须有 $(c-1) \\leq 0$，即 $c \\leq 1$。\n因此，完整的稳定性判据是 $0 \\leq c \\leq 1$。这就是该显式平流格式的 Courant-Friedrichs-Lewy (CFL) 稳定性要求。\n$$\nc = \\frac{U \\Delta t}{\\Delta x} \\leq 1\n$$\n为了找到最大稳定时间步长 $\\Delta t_{\\max}$，我们将库朗数设置为其允许的最大值 $1$：\n$$\n\\frac{U \\Delta t_{\\max}}{\\Delta x} = 1 \\implies \\Delta t_{\\max} = \\frac{\\Delta x}{U}\n$$\n现在我们代入给定的数值：\n- 速度 $U = 0.5\\,\\mathrm{m\\,s^{-1}}$。\n- 网格间距 $\\Delta x = 5\\,\\mathrm{km}$。\n\n首先，我们必须确保单位一致。我们将 $\\Delta x$ 从千米转换为米：\n$$\n\\Delta x = 5\\,\\mathrm{km} = 5 \\times 1000\\,\\mathrm{m} = 5000\\,\\mathrm{m}\n$$\n现在，我们可以计算 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{5000\\,\\mathrm{m}}{0.5\\,\\mathrm{m\\,s^{-1}}} = 10000\\,\\mathrm{s}\n$$\n问题要求答案四舍五入到四位有效数字。确切值为 $10000$。为了用四位有效数字表示，我们将其写成科学记数法形式。\n$$\n\\Delta t_{\\max} = 1.000 \\times 10^4\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.000 \\times 10^4}\n$$"
        },
        {
            "introduction": "一个稳定的数值方案未必是准确的，它可能引入非物理的人为效应，从而降低解的精度。本练习介绍修正方程分析，以揭示平流方案的主导阶误差，该误差表现为一种“伪”或数值扩散 。接着，您将学习如何通过调整模型的显式扩散参数来补偿这种效应，这是确保模拟结果物理真实性的一个常见且关键的任务。",
            "id": "3809018",
            "problem": "在一个静力学原始方程海洋模型中，考虑在恒定纬向速度作用下，惰性示踪剂的水平均匀平流-扩散过程。一维水平方向的示踪剂守恒方程为\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\kappa_{h}\\,\\frac{\\partial C}{\\partial x}\\right),\n$$\n其中，$C$ 是示踪剂浓度，$u$ 是纬向速度，$\\kappa_{h}$ 是与拉普拉斯混合算子相关的显式水平扩散系数。假设模型在一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，使用一阶迎风（施主单元）平流格式来推进 $C$ 的演化，且 $u  0$。\n\n从守恒定律和离散的施主单元更新形式出发，进行修正方程分析，以确定由平流格式引起的领先阶伪扩散系数 $\\kappa_{\\text{num}}$，并用 $u$、$\\Delta x$ 和 Courant–Friedrichs–Lewy (CFL) 数 $\\mathcal{C} = u\\,\\Delta t / \\Delta x$ 来表示。然后，通过强制满足以下关系式，要求总有效水平混合与一个预设的目标值 $K_{\\text{tot}}$ 相匹配：\n$$\nK_{\\text{tot}} = \\kappa_{h} + \\kappa_{\\text{num}}.\n$$\n给定 $u = 0.05\\,\\text{m s}^{-1}$，$\\Delta x = 5.0 \\times 10^{3}\\,\\text{m}$，$\\Delta t = 600\\,\\text{s}$，以及 $K_{\\text{tot}} = 3.00 \\times 10^{2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，计算所需的显式水平扩散系数 $\\kappa_{h}$，以确保示踪剂收支的真实性（即 $\\kappa_{h}$ 非负）。将最终答案四舍五入至四位有效数字，并以 $\\text{m}^{2}\\,\\text{s}^{-1}$ 为单位表示。",
            "solution": "用户要求计算在一个静力学原始方程海洋模型中所需的显式水平扩散系数 $\\kappa_h$。这需要将一个目标总扩散系数 $K_{\\text{tot}}$ 与显式扩散系数和数值（或伪）扩散系数 $\\kappa_{\\text{num}}$ 之和进行平衡，其中数值扩散系数是由平流项的离散化引起的。\n\n该问题可通过以下两个主要步骤解决：\n1.  推导由一阶迎风（施主单元）平流格式引入的领先阶数值扩散系数 $\\kappa_{\\text{num}}$ 的表达式。这通过修正方程分析来完成，该分析涉及对离散有限差分方程进行泰勒级数展开。\n2.  使用推导出的表达式和给定的参数计算 $\\kappa_{\\text{num}}$ 的数值。然后，使用给定的关系式 $K_{\\text{tot}} = \\kappa_h + \\kappa_{\\text{num}}$ 求解 $\\kappa_h$。\n\n**步骤 1：修正方程分析**\n\n示踪剂 $C$ 的控制方程由下式给出：\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\kappa_{h}\\,\\frac{\\partial C}{\\partial x}\\right)\n$$\n数值格式应用于方程的平流部分：\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = 0\n$$\n对于恒定的正速度 $u > 0$，在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，一阶迎风（施主单元）格式为：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} + u \\frac{C_j^n - C_{j-1}^n}{\\Delta x} = 0\n$$\n这里，$C_j^n$ 表示在网格点 $x_j = j \\Delta x$ 和时间 $t^n = n \\Delta t$ 处的浓度 $C$。\n\n为了找出该格式实际求解的修正方程，我们围绕点 $(x_j, t^n)$ 对每一项进行泰勒级数展开。设该点的偏导数用下标表示（例如，$C_t = \\frac{\\partial C}{\\partial t}$，$C_{xx} = \\frac{\\partial^2 C}{\\partial x^2}$）。\n\n$C_j^{n+1} = C(x_j, t^n + \\Delta t)$ 的展开式为：\n$$\nC_j^{n+1} = C_j^n + \\Delta t \\, C_t + \\frac{(\\Delta t)^2}{2} C_{tt} + O((\\Delta t)^3)\n$$\n$C_{j-1}^n = C(x_j - \\Delta x, t^n)$ 的展开式为：\n$$\nC_{j-1}^n = C_j^n - \\Delta x \\, C_x + \\frac{(\\Delta x)^2}{2} C_{xx} - O((\\Delta x)^3)\n$$\n将这些展开式代入有限差分格式中：\n$$\n\\frac{1}{\\Delta t} \\left( C_j^n + \\Delta t \\, C_t + \\frac{(\\Delta t)^2}{2} C_{tt} + \\dots - C_j^n \\right) + \\frac{u}{\\Delta x} \\left( C_j^n - \\left( C_j^n - \\Delta x \\, C_x + \\frac{(\\Delta x)^2}{2} C_{xx} - \\dots \\right) \\right) = 0\n$$\n简化各项：\n$$\n\\left( C_t + \\frac{\\Delta t}{2} C_{tt} + \\dots \\right) + \\frac{u}{\\Delta x} \\left( \\Delta x \\, C_x - \\frac{(\\Delta x)^2}{2} C_{xx} + \\dots \\right) = 0\n$$\n重新整理以匹配原始平流方程的形式，得到修正方程：\n$$\nC_t + u C_x = - \\frac{\\Delta t}{2} C_{tt} + \\frac{u \\Delta x}{2} C_{xx} - \\text{H.O.T.}\n$$\n右侧的项代表格式的截断误差。领先阶误差项与 $\\Delta t$ 和 $\\Delta x$ 成正比。为了将此误差纯粹用空间导数表示，我们可以使用原始偏微分方程（PDE）来近似时间导数项 $C_{tt}$。原始 PDE 表明 $C_t = -u C_x$。对时间求导得到 $C_{tt} = \\frac{\\partial}{\\partial t}(-u C_x) = -u \\frac{\\partial}{\\partial x}(C_t)$。再次代入 $C_t = -u C_x$ 得到：\n$$\nC_{tt} = -u \\frac{\\partial}{\\partial x}(-u C_x) = u^2 C_{xx}\n$$\n将此代入修正方程中：\n$$\nC_t + u C_x = - \\frac{\\Delta t}{2} (u^2 C_{xx}) + \\frac{u \\Delta x}{2} C_{xx} - \\text{H.O.T.}\n$$\n$$\nC_t + u C_x = \\left( \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} \\right) C_{xx} - \\text{H.O.T.}\n$$\n提出因子 $\\frac{u \\Delta x}{2}$：\n$$\nC_t + u C_x = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right) C_{xx} - \\text{H.O.T.}\n$$\n无量纲数组合 $\\mathcal{C} = \\frac{u \\Delta t}{\\Delta x}$ 是 Courant–Friedrichs–Lewy (CFL) 数。修正方程揭示了，一阶迎风格式在数值上求解的是平流方程，但附加了一个具有扩散项形式的二阶导数项。\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = \\kappa_{\\text{num}} \\frac{\\partial^2 C}{\\partial x^2}\n$$\n通过比较，领先阶伪（或数值）扩散系数为：\n$$\n\\kappa_{\\text{num}} = \\frac{u \\Delta x}{2} (1 - \\mathcal{C}) = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n\n**步骤 2：计算显式扩散系数 $\\kappa_h$**\n\n模型中的总有效水平扩散是显式加入的扩散 $\\kappa_h$ 和数值扩散 $\\kappa_{\\text{num}}$ 的和。问题要求这个和等于一个目标值 $K_{\\text{tot}}$：\n$$\nK_{\\text{tot}} = \\kappa_h + \\kappa_{\\text{num}}\n$$\n由此，我们可以求解所需的显式扩散系数：\n$$\n\\kappa_h = K_{\\text{tot}} - \\kappa_{\\text{num}} = K_{\\text{tot}} - \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n现在，我们代入给定的数值：\n- $u = 0.05\\,\\text{m s}^{-1}$\n- $\\Delta x = 5.0 \\times 10^{3}\\,\\text{m}$\n- $\\Delta t = 600\\,\\text{s}$\n- $K_{\\text{tot}} = 3.00 \\times 10^{2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n\n首先，我们计算 CFL 数 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\frac{u \\Delta t}{\\Delta x} = \\frac{(0.05 \\, \\text{m s}^{-1}) (600 \\, \\text{s})}{5.0 \\times 10^{3} \\, \\text{m}} = \\frac{30}{5000} = 0.006\n$$\n由于 $0  \\mathcal{C} \\le 1$，迎风格式是稳定的，且数值扩散 $\\kappa_{\\text{num}}$ 是正的。\n\n接下来，我们计算数值扩散系数 $\\kappa_{\\text{num}}$：\n$$\n\\kappa_{\\text{num}} = \\frac{u \\Delta x}{2} (1 - \\mathcal{C}) = \\frac{(0.05 \\, \\text{m s}^{-1})(5.0 \\times 10^{3} \\, \\text{m})}{2} (1 - 0.006)\n$$\n$$\n\\kappa_{\\text{num}} = \\frac{250}{2} (0.994) \\, \\text{m}^2 \\text{s}^{-1} = 125 \\times 0.994 \\, \\text{m}^2 \\text{s}^{-1} = 124.25 \\, \\text{m}^2 \\text{s}^{-1}\n$$\n最后，我们计算所需的显式扩散系数 $\\kappa_h$：\n$$\n\\kappa_h = K_{\\text{tot}} - \\kappa_{\\text{num}} = 300 \\, \\text{m}^2 \\text{s}^{-1} - 124.25 \\, \\text{m}^2 \\text{s}^{-1} = 175.75 \\, \\text{m}^2 \\text{s}^{-1}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\kappa_h \\approx 175.8 \\, \\text{m}^2 \\text{s}^{-1}\n$$\n这个值是正的，满足了示踪剂收支真实性的条件，因为它对应于一个基于物理的扩散过程，而不是一个反扩散过程。",
            "answer": "$$\n\\boxed{175.8}\n$$"
        }
    ]
}