{
    "hands_on_practices": [
        {
            "introduction": "在具有自由水面的原始方程模型中，传播速度最快的信号是外重力波。这些波的传播速度由海洋深度决定，它们对任何显式数值格式的时间步长都施加了严格的限制。本练习将引导你推导这些波的速度，并计算出最大的稳定时间步长，这是每位海洋模型开发者都必须掌握的一项基本计算，以设计出计算上可行的模拟。",
            "id": "3809052",
            "problem": "一个静水、Boussinesq近似的原始方程海洋模型支持快速的外部重力波，这些波通过Courant–Friedrichs–Lewy (CFL)条件对显式时间步长构成约束。考虑外部（正压）模的一维、线性化、无粘性、无旋转的浅水形式，该形式是通过对水平动量进行深度平均并对自由表面使用质量守恒从原始方程推导出来的。从第一性原理出发，推导长外部重力波的相速度，然后确定在均匀网格上离散化时CFL约束所允许的最大显式时间步长。\n\n假设海洋深度均匀为 $H = 4000\\,\\mathrm{m}$，重力加速度为 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，水平网格间距均匀为 $\\Delta x = 10\\,\\mathrm{km}$。使用CFL条件 $c_{e}\\,\\Delta t / \\Delta x \\le 0.5$，其中 $c_{e}$ 是您将要推导的外部重力波相速度。计算该约束所蕴含的最大稳定显式时间步长 $\\Delta t_{\\max}$。\n\n您的最终答案以秒为单位，并四舍五入到四位有效数字。此外，请用文字简要解释此界限对原始方程海洋模型设计选择的影响，但请确保您报告的最终数值答案仅为 $\\Delta t_{\\max}$。",
            "solution": "问题需要经过验证。\n\n已知条件逐字从问题陈述中提取：\n- 模型类型：静水、Boussinesq近似的原始方程海洋模型。\n- 外部模的控制方程：一维、线性化、无粘性、无旋转的浅水形式。\n- 均匀海洋深度：$H = 4000\\,\\mathrm{m}$。\n- 重力加速度：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n- 均匀水平网格间距：$\\Delta x = 10\\,\\mathrm{km}$。\n- CFL条件：$c_{e}\\,\\Delta t / \\Delta x \\le 0.5$。\n- $c_e$ 是外部重力波相速度。\n- 任务是推导 $c_e$ 并计算最大稳定显式时间步长 $\\Delta t_{\\max}$。\n\n问题验证如下：\n- **科学依据**：该问题基于地球物理流体动力学的基本原理，特别是浅水波理论，这是海洋学中的一个标准近似。控制方程和CFL稳定性条件是计算流体动力学的核心概念。物理常数和模型参数（$H$、$g$、$\\Delta x$）对于大规模海洋模拟是符合实际的。\n- **适定性**：问题陈述清晰，并提供了推导相速度和计算时间步长所需的所有信息。存在唯一且有意义的解。\n- **客观性**：问题以精确、定量的科学语言表达，没有主观或模糊的术语。\n\n该问题被认为是**有效的**，因为它是科学上合理的、适定的和客观的。可以继续求解过程。\n\n第一步是推导长外部重力波的相速度 $c_e$。我们从一维、线性化、无粘性、无旋转的浅水方程开始。这些方程描述了相对于平均深度 $H$ 的深度平均水平速度 $u(x, t)$ 和自由表面高程 $\\eta(x, t)$。方程如下：\n\n1.  动量方程：\n    $$ \\frac{\\partial u}{\\partial t} = -g \\frac{\\partial \\eta}{\\partial x} $$\n2.  连续性方程（质量守恒）：\n    $$ \\frac{\\partial \\eta}{\\partial t} = -H \\frac{\\partial u}{\\partial x} $$\n\n为了找到波传播的特性，我们寻求以下形式的平面波解：\n$$ u(x, t) = u_0 \\exp\\left(i(kx - \\omega t)\\right) $$\n$$ \\eta(x, t) = \\eta_0 \\exp\\left(i(kx - \\omega t)\\right) $$\n其中 $u_0$ 和 $\\eta_0$ 是常数振幅，$k$ 是波数（$k = 2\\pi/\\lambda$，其中 $\\lambda$ 是波长），$\\omega$ 是角频率。\n\n将这些形式代入控制方程，偏导数变为：\n$$ \\frac{\\partial}{\\partial t} \\rightarrow -i\\omega $$\n$$ \\frac{\\partial}{\\partial x} \\rightarrow ik $$\n\n将这些应用于动量和连续性方程，得到一个关于振幅 $u_0$ 和 $\\eta_0$ 的代数方程组：\n$$ -i\\omega u_0 = -g (ik) \\eta_0 \\implies \\omega u_0 = gk \\eta_0 $$\n$$ -i\\omega \\eta_0 = -H (ik) u_0 \\implies \\omega \\eta_0 = Hk u_0 $$\n\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n\\omega  & -gk \\\\\n-Hk  & \\omega\n\\end{pmatrix}\n\\begin{pmatrix}\nu_0 \\\\\n\\eta_0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n为了得到非平凡解（即 $u_0$ 和 $\\eta_0$ 不全为零），系数矩阵的行列式必须为零：\n$$ \\det \\begin{pmatrix}\n\\omega  & -gk \\\\\n-Hk  & \\omega\n\\end{pmatrix} = \\omega^2 - (-gk)(-Hk) = \\omega^2 - gHk^2 = 0 $$\n该方程是浅水波的色散关系：\n$$ \\omega^2 = gHk^2 $$\n求解 $\\omega$ 得到 $\\omega = \\pm k \\sqrt{gH}$。相速度 $c_e$ 定义为角频率与波数之比，即 $c_e = \\omega/k$。因此，外部重力波的相速度为：\n$$ c_e = \\sqrt{gH} $$\n\n下一步是使用给定的常数计算 $c_e$ 的数值：\n$$ g = 9.81\\,\\mathrm{m\\,s^{-2}} $$\n$$ H = 4000\\,\\mathrm{m} $$\n$$ c_e = \\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}}) \\times (4000\\,\\mathrm{m})} = \\sqrt{39240\\,\\mathrm{m^2\\,s^{-2}}} \\approx 198.090888\\,\\mathrm{m\\,s^{-1}} $$\n\n现在，我们使用给定的Courant–Friedrichs–Lewy (CFL)条件来确定最大稳定显式时间步长 $\\Delta t_{\\max}$：\n$$ \\frac{c_e \\Delta t}{\\Delta x} \\le 0.5 $$\n当表达式等于上限时，找到最大时间步长：\n$$ \\frac{c_e \\Delta t_{\\max}}{\\Delta x} = 0.5 $$\n求解 $\\Delta t_{\\max}$：\n$$ \\Delta t_{\\max} = \\frac{0.5 \\Delta x}{c_e} $$\n我们已知网格间距 $\\Delta x = 10\\,\\mathrm{km}$。我们必须将其转换为国际单位制（SI units）以与 $c_e$ 保持一致：\n$$ \\Delta x = 10\\,\\mathrm{km} = 10 \\times 10^3\\,\\mathrm{m} = 10000\\,\\mathrm{m} $$\n代入 $\\Delta x$ 和 $c_e$ 的值：\n$$ \\Delta t_{\\max} = \\frac{0.5 \\times 10000\\,\\mathrm{m}}{198.090888\\,\\mathrm{m\\,s^{-1}}} \\approx 25.24090\\,\\mathrm{s} $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\Delta t_{\\max} \\approx 25.24\\,\\mathrm{s} $$\n\n最后，我们简要解释这一限制对模型设计的影响。推导出的约25秒的最大时间步长非常短，特别是对于必须积分数百年或数千年的气候模拟而言。这个严苛的限制源于外部重力波的速度（$c_e \\approx 200\\,\\mathrm{m/s}$）非常高，使得信息在网格上迅速传播。对所有海洋过程（其中许多过程要慢得多，例如洋流的平流）都使用如此小的时间步长，在计算上是不可行的。\n\n这一约束推动了原始方程海洋模型中特定数值技术的发展。两种最常见的策略是：\n1.  **分裂显式时间步进（模态分裂）：** 将控制方程分解为描述快速移动的外部（正压）模和较慢的内部（斜压）模的分量。正压模使用CFL条件所要求的小时间步长（$\\Delta t_{\\max}$）进行积分，而模型的其余部分（代表了大部分计算量）则使用大得多的时间步长进行积分。\n2.  **隐式时间步进：** 负责传播快速外部波的项采用数值隐式格式处理。隐式方法不受相同的CFL条件限制，可以在大得多的时间步长下保持稳定，但代价是在每个时间步都必须求解一个大型线性方程组（通常是关于海面高度的椭圆问题）。\n\n这些策略使得海洋模型能够使用适合较慢的含能运动（例如涡流和洋流）的时间步长，而不会变得数值不稳定，从而使长期气候模拟在计算上变得可行。\n\n最终要求的数值答案是 $\\Delta t_{\\max}$ 的值。",
            "answer": "$$\n\\boxed{25.24}\n$$"
        },
        {
            "introduction": "海面高度的演变是原始方程海洋模型的基石，它直接反映了水体内质量的辐合与辐散。理解三维流场如何决定海平面的变化，对于解释模型输出和确保物理一致性至关重要。本练习要求你从质量守恒基本原理出发，推导海面高度趋势方程，并将其应用于给定的流场，从而在三维动力学和二维自由水面之间建立联系。",
            "id": "3809021",
            "problem": "考虑一个矩形海盆，其水平坐标为 $x$ 和 $y$，垂直坐标 $z$ 向上为正，自由表面位于 $z=0$，平坦刚性底位于 $z=-H$。假设 Boussinesq 近似和原始方程 (PE)，三维连续性方程为 $\\partial u/\\partial x + \\partial v/\\partial y + \\partial w/\\partial z = 0$，其中 $u$、$v$ 和 $w$ 分别是 $x$、$y$ 和 $z$ 方向的速度分量。设 $z=0$ 处的小坡度线性化自由表面运动学边界条件为 $w(0) = \\eta_{t} - F_{S}$，其中 $\\eta(x,y,t)$ 是海面高度，$F_{S}(x,y,t)$ 是进入海洋的净淡水体积通量（降水量减去蒸发量），当其增加海洋体积时为正。在底部 $z=-H$ 处，施加 $w(-H)=0$（不可渗透底）。从这些基本原理出发，推导一个关于 $\\eta_{t}$ 的垂直积分倾向方程，然后使用下述速度场和参数在指定位置对其进行评估。\n\n该海盆是双周期的，域长度为 $L_{x}$ 和 $L_{y}$，深度 $H$ 均匀。水平速度场指定为\n$$\nu(x,y,z) = U_{0}\\,\\cos\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right)\\left(1+\\frac{z}{H}\\right),\\qquad\nv(x,y,z) = V_{0}\\,\\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\sin\\!\\left(\\frac{\\pi y}{L_{y}}\\right)\\left(1+\\frac{z}{H}\\right),\n$$\n常数 $H=4000\\ \\mathrm{m}$，$L_{x}=1.0\\times 10^{7}\\ \\mathrm{m}$，$L_{y}=1.0\\times 10^{7}\\ \\mathrm{m}$，$U_{0}=2.0\\times 10^{-3}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ 和 $V_{0}=1.0\\times 10^{-3}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。表面淡水通量在空间上均匀且稳定，为 $F_{S}=2\\ \\mathrm{mm}\\ \\mathrm{day}^{-1}$。\n\n计算在点 $(x^{\\ast},y^{\\ast})$ 处的海面高度倾向 $\\eta_{t}$，该点由 $x^{\\ast}=L_{x}/12$ 和条件 $\\cos\\!\\left(\\pi y^{\\ast}/L_{y}\\right)=1/20$ 定义。将 $\\eta_{t}$ 的最终数值以毫米/天 (mm day$^{-1}$) 为单位表示，并将答案四舍五入到四位有效数字。简要讨论所得结果的符号和量级是否与垂直积分连续性框架下的质量守恒一致。",
            "solution": "首先评估问题的有效性。\n\n**步骤1：提取已知条件**\n- **连续性方程：** $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0$\n- **速度分量：** $u, v, w$ 分别在 $x, y, z$ 方向。\n- **几何结构：** 平坦刚性底位于 $z=-H$，线性化自由表面位于 $z=0$。\n- **表面边界条件 ($z=0$)：** $w(0) = \\eta_{t} - F_{S}$，其中 $\\eta_{t} = \\frac{\\partial \\eta}{\\partial t}$。\n- **底部边界条件 ($z=-H$)：** $w(-H) = 0$。\n- **水平速度场：**\n  - $u(x,y,z) = U_{0}\\,\\cos\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right)\\left(1+\\frac{z}{H}\\right)$\n  - $v(x,y,z) = V_{0}\\,\\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\sin\\!\\left(\\frac{\\pi y}{L_{y}}\\right)\\left(1+\\frac{z}{H}\\right)$\n- **常数：**\n  - $H=4000\\ \\mathrm{m}$\n  - $L_{x}=1.0\\times 10^{7}\\ \\mathrm{m}$\n  - $L_{y}=1.0\\times 10^{7}\\ \\mathrm{m}$\n  - $U_{0}=2.0\\times 10^{-3}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n  - $V_{0}=1.0\\times 10^{-3}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n- **表面淡水通量：** $F_{S}=2\\ \\mathrm{mm}\\ \\mathrm{day}^{-1}$（空间均匀且稳定）。\n- **评估点 $(x^{\\ast},y^{\\ast})$：**\n  - $x^{\\ast}=L_{x}/12$\n  - $\\cos(\\pi y^{\\ast}/L_{y})=1/20$\n- **域：** 描述为“双周期的，域长度为 $L_{x}$ 和 $L_{y}$”。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，植根于物理海洋学的原始方程。设置是适定的，提供了推导倾向方程和计算其值所需的所有信息。语言客观明确。存在一个微小的不一致之处：问题将域描述为“双周期的”，但给定的速度场 $u$ 和 $v$ 在 $y$ 方向上是反周期的，即 $u(x, y+L_y, z) = -u(x,y,z)$ 和 $v(x, y+L_y, z) = -v(x,y,z)$。然而，这并不妨碍所要求的导数的局部计算或控制方程的推导。指定的速度场在数学上是明确定义的，且在整个域上积分的净输送散度为零，这与封闭或周期性海盆的情况相符。因此，这个微小的描述性缺陷不会使问题的核心任务失效。物理参数对于大尺度海盆是现实的。\n\n**步骤3：结论与行动**\n问题被判定为有效。将提供完整的解答。\n\n**海面高度倾向方程的推导**\n我们从 Boussinesq 近似下不可压缩流体的三维连续性方程开始：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n我们将此方程从海底 $z=-H$ 垂直积分到平均海平面 $z=0$：\n$$ \\int_{-H}^{0} \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} \\right) dz = 0 $$\n使用莱布尼兹积分法则，我们可以交换水平导数的积分和微分顺序，因为积分限 $-H$ 和 $0$ 相对于 $x$ 和 $y$ 是常数：\n$$ \\frac{\\partial}{\\partial x} \\left( \\int_{-H}^{0} u \\, dz \\right) + \\frac{\\partial}{\\partial y} \\left( \\int_{-H}^{0} v \\, dz \\right) + \\int_{-H}^{0} \\frac{\\partial w}{\\partial z} \\, dz = 0 $$\n让我们将垂直积分的水平输送 $U$ 和 $V$ 定义为：\n$$ U = \\int_{-H}^{0} u \\, dz \\qquad \\text{和} \\qquad V = \\int_{-H}^{0} v \\, dz $$\n垂直速度项的积分使用微积分基本定理进行计算：\n$$ \\int_{-H}^{0} \\frac{\\partial w}{\\partial z} \\, dz = w(z)\\Big|_{-H}^{0} = w(0) - w(-H) $$\n代入给定的边界条件 $w(0) = \\eta_{t} - F_{S}$ 和 $w(-H)=0$：\n$$ w(0) - w(-H) = (\\eta_{t} - F_{S}) - 0 = \\eta_{t} - F_{S} $$\n将这些结果代回积分后的连续性方程，得到：\n$$ \\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} + \\eta_{t} - F_{S} = 0 $$\n求解海面高度倾向 $\\eta_{t}$，我们得到所需的方程：\n$$ \\eta_{t} = - \\left( \\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} \\right) + F_{S} $$\n这个方程表示，海面高度的变化率由深度积分的水平水输送的辐合加上表面的净淡水通量决定。\n\n**海面高度倾向的评估**\n首先，我们通过对给定的速度场进行深度积分来计算输送量 $U$ 和 $V$。速度的垂直结构由因子 $(1+z/H)$ 给出。我们将此因子从 $z=-H$ 积分到 $z=0$：\n$$ \\int_{-H}^{0} \\left(1 + \\frac{z}{H}\\right) dz = \\left[ z + \\frac{z^2}{2H} \\right]_{-H}^{0} = (0+0) - \\left(-H + \\frac{(-H)^2}{2H}\\right) = - \\left(-H + \\frac{H}{2}\\right) = \\frac{H}{2} $$\n因此，输送量 $U$ 和 $V$ 为：\n$$ U(x,y) = U_{0}\\,\\cos\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) \\int_{-H}^{0} \\left(1+\\frac{z}{H}\\right) dz = \\frac{U_{0}H}{2} \\cos\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) $$\n$$ V(x,y) = V_{0}\\,\\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\sin\\!\\left(\\frac{\\pi y}{L_{y}}\\right) \\int_{-H}^{0} \\left(1+\\frac{z}{H}\\right) dz = \\frac{V_{0}H}{2} \\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\sin\\!\\left(\\frac{\\pi y}{L_{y}}\\right) $$\n接下来，我们计算输送的水平散度 $\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y}$：\n$$ \\frac{\\partial U}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\frac{U_{0}H}{2} \\cos\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) \\right] = -\\frac{\\pi U_{0}H}{L_{x}} \\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) $$\n$$ \\frac{\\partial V}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\frac{V_{0}H}{2} \\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\sin\\!\\left(\\frac{\\pi y}{L_{y}}\\right) \\right] = \\frac{\\pi V_{0}H}{2L_{y}} \\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) $$\n散度是这两项之和：\n$$ \\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = \\left( -\\frac{\\pi U_{0}H}{L_{x}} + \\frac{\\pi V_{0}H}{2L_{y}} \\right) \\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) $$\n将此代入倾向方程：\n$$ \\eta_{t}(x,y) = - \\left( -\\frac{\\pi U_{0}H}{L_{x}} + \\frac{\\pi V_{0}H}{2L_{y}} \\right) \\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) + F_{S} $$\n$$ \\eta_{t}(x,y) = \\pi H \\left( \\frac{U_{0}}{L_{x}} - \\frac{V_{0}}{2L_{y}} \\right) \\sin\\!\\left(\\frac{2\\pi x}{L_{x}}\\right)\\cos\\!\\left(\\frac{\\pi y}{L_{y}}\\right) + F_{S} $$\n现在我们在点 $(x^{\\ast}, y^{\\ast})$ 处评估此表达式，其中 $x^{\\ast}=L_{x}/12$ 且 $\\cos(\\pi y^{\\ast}/L_{y})=1/20$。正弦项变为：\n$$ \\sin\\!\\left(\\frac{2\\pi x^{\\ast}}{L_{x}}\\right) = \\sin\\!\\left(\\frac{2\\pi}{L_{x}} \\frac{L_{x}}{12}\\right) = \\sin\\!\\left(\\frac{\\pi}{6}\\right) = \\frac{1}{2} $$\n将这些代入 $\\eta_{t}$ 的表达式中：\n$$ \\eta_{t}(x^{\\ast},y^{\\ast}) = \\pi H \\left( \\frac{U_{0}}{L_{x}} - \\frac{V_{0}}{2L_{y}} \\right) \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{20}\\right) + F_{S} = \\frac{\\pi H}{40} \\left( \\frac{U_{0}}{L_{x}} - \\frac{V_{0}}{2L_{y}} \\right) + F_{S} $$\n现在我们代入数值。我们称第一项为 $\\eta_{t, \\text{dyn}}$。\n$$ \\eta_{t, \\text{dyn}} = \\frac{\\pi (4000 \\ \\mathrm{m})}{40} \\left( \\frac{2.0\\times 10^{-3} \\ \\mathrm{m}\\ \\mathrm{s}^{-1}}{1.0\\times 10^{7} \\ \\mathrm{m}} - \\frac{1.0\\times 10^{-3} \\ \\mathrm{m}\\ \\mathrm{s}^{-1}}{2(1.0\\times 10^{7} \\ \\mathrm{m})} \\right) $$\n$$ \\eta_{t, \\text{dyn}} = 100\\pi \\left( 2.0\\times 10^{-10} \\ \\mathrm{s}^{-1} - 0.5\\times 10^{-10} \\ \\mathrm{s}^{-1} \\right) = 100\\pi \\left( 1.5\\times 10^{-10} \\ \\mathrm{s}^{-1} \\right) = 1.5\\pi \\times 10^{-8} \\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n问题要求答案以 mm day$^{-1}$ 为单位。我们转换 $\\eta_{t, \\text{dyn}}$：\n$$ \\eta_{t, \\text{dyn}} = (1.5\\pi \\times 10^{-8} \\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\times (1000 \\ \\mathrm{mm}\\ \\mathrm{m}^{-1}) \\times (86400 \\ \\mathrm{s}\\ \\mathrm{day}^{-1}) $$\n$$ \\eta_{t, \\text{dyn}} = 1.5\\pi \\times 10^{-8} \\times 10^{3} \\times 8.64 \\times 10^{4} \\ \\mathrm{mm}\\ \\mathrm{day}^{-1} = 1.5 \\times 8.64 \\times \\pi \\times 10^{-1} \\ \\mathrm{mm}\\ \\mathrm{day}^{-1} = 1.296\\pi \\ \\mathrm{mm}\\ \\mathrm{day}^{-1} $$\n使用 $\\pi \\approx 3.14159$，我们发现 $\\eta_{t, \\text{dyn}} \\approx 4.0715 \\ \\mathrm{mm}\\ \\mathrm{day}^{-1}$。\n总的海面高度倾向是动力部分和表面通量部分之和：\n$$ \\eta_{t} = \\eta_{t, \\text{dyn}} + F_{S} = 1.296\\pi \\ \\mathrm{mm}\\ \\mathrm{day}^{-1} + 2 \\ \\mathrm{mm}\\ \\mathrm{day}^{-1} \\approx 4.0715 + 2 = 6.0715 \\ \\mathrm{mm}\\ \\mathrm{day}^{-1} $$\n将结果四舍五入到四位有效数字，得到 $6.072 \\ \\mathrm{mm}\\ \\mathrm{day}^{-1}$。\n\n**一致性讨论**\n推导出的关系式 $\\eta_{t} = - \\nabla_h \\cdot \\mathbf{U} + F_S$ 是水柱体积守恒的直接表达。如果存在水平输送的净辐合（$-\\nabla_h \\cdot \\mathbf{U} > 0$）和/或来自大气的正淡水通量（$F_S > 0$），海面就会上升（$\\eta_t > 0$）。\n在指定点，输送散度为：\n$$ \\nabla_h \\cdot \\mathbf{U} = \\pi H \\left( \\frac{V_{0}}{2L_{y}} - \\frac{U_{0}}{L_{x}} \\right) \\sin\\left(\\frac{\\pi}{6}\\right)\\cos\\left(\\frac{\\pi y^*}{L_y}\\right)  0 $$\n负号的出现是因为 $(V_0/(2L_y) - U_0/L_x)  0$。负散度意味着输送的辐合。因此，动力项 $-\\nabla_h \\cdot \\mathbf{U}$ 为正，对海平面上升的贡献约为 $4.072 \\ \\mathrm{mm}\\ \\mathrm{day}^{-1}$。淡水通量 $F_S = 2 \\ \\mathrm{mm}\\ \\mathrm{day}^{-1}$ 也为正。这两种效应都导致海平面上升，因此它们的和必须为正，这与我们得到的最终结果 $6.072 \\ \\mathrm{mm}\\ \\mathrm{day}^{-1}$ 一致。对于大尺度海洋环流内强输送辐合的区域，这个量级是合理的，在这些区域，海平面异常可以以每天几毫米的速率累积。",
            "answer": "$$\\boxed{6.072}$$"
        },
        {
            "introduction": "为模拟热量和盐度等物质输运而设计的平流数值格式，不可避免地会引入可能模拟物理过程的误差。其中最重要的“人造物”之一是数值扩散，如果不加以适当考虑，它会人为地平滑梯度并改变示踪剂的收支。本练习介绍了一种强大的技术——修正方程分析，用以量化一种常用平流格式产生的伪扩散，这是评估数值模型真实耗散特性的关键技能。",
            "id": "3809018",
            "problem": "在一个静力原始方程海洋模型中，考虑一个惰性示踪剂在恒定纬向速度下的水平均匀平流-扩散过程。其一维水平方向上的示踪剂守恒方程为\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\kappa_{h}\\,\\frac{\\partial C}{\\partial x}\\right),\n$$\n其中 $C$ 是示踪剂浓度，$u$ 是纬向速度，$\\kappa_{h}$ 是与拉普拉斯混合算子相关的显式水平扩散系数。假设模型在一个间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，使用一阶迎风（施主单元）平流格式来推进 $C$，且 $u  0$。\n\n从守恒律和离散的施主单元更新形式出发，进行修正方程分析，以确定由平流格式引起的领先阶伪扩散系数 $\\kappa_{\\text{num}}$，并用 $u$、$\\Delta x$ 和库朗-弗里德里希-列维（CFL）数 $\\mathcal{C} = u\\,\\Delta t / \\Delta x$ 表示。然后，通过强制执行以下关系，要求总有效水平混合与一个指定的目标值 $K_{\\text{tot}}$ 相匹配：\n$$\nK_{\\text{tot}} = \\kappa_{h} + \\kappa_{\\text{num}}.\n$$\n给定 $u = 0.05$ m s$^{-1}$，$\\Delta x = 5.0 \\times 10^{3}$ m，$\\Delta t = 600$ s，以及 $K_{\\text{tot}} = 3.00 \\times 10^{2}$ m$^{2}$ s$^{-1}$，计算所需的显式水平扩散系数 $\\kappa_{h}$，以确保示踪剂收支的真实性（即 $\\kappa_{h}$ 为非负值）。将最终答案四舍五入至四位有效数字，并以 m$^{2}$ s$^{-1}$ 为单位表示。",
            "solution": "用户要求计算静力原始方程海洋模型中所需的显式水平扩散系数 $\\kappa_h$。这需要将目标总扩散系数 $K_{\\text{tot}}$ 与显式扩散系数和由平流项离散化产生的数值（或伪）扩散系数 $\\kappa_{\\text{num}}$ 之和进行平衡。\n\n该问题可通过两个主要步骤解决：\n1.  推导由一阶迎风（施主单元）平流格式引入的领先阶数值扩散系数 $\\kappa_{\\text{num}}$ 的表达式。这通过修正方程分析来完成，该分析涉及对离散有限差分方程进行泰勒级数展开。\n2.  使用推导出的表达式和给定参数计算 $\\kappa_{\\text{num}}$ 的数值。然后，利用给定的关系式 $K_{\\text{tot}} = \\kappa_h + \\kappa_{\\text{num}}$ 求解 $\\kappa_h$。\n\n**步骤 1：修正方程分析**\n\n示踪剂 $C$ 的控制方程由下式给出：\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\kappa_{h}\\,\\frac{\\partial C}{\\partial x}\\right)\n$$\n数值格式应用于方程的平流部分：\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = 0\n$$\n对于一个恒定的正速度 $u  0$，在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，一阶迎风（施主单元）格式为：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} + u \\frac{C_j^n - C_{j-1}^n}{\\Delta x} = 0\n$$\n此处，$C_j^n$ 表示在网格点 $x_j = j \\Delta x$ 和时间 $t^n = n \\Delta t$ 处的浓度 $C$。\n\n为了找出该格式实际求解的修正方程，我们对每一项在点 $(x_j, t^n)$ 附近进行泰勒级数展开。设该点的偏导数用下标表示（例如，$C_t = \\frac{\\partial C}{\\partial t}$，$C_{xx} = \\frac{\\partial^2 C}{\\partial x^2}$）。\n\n对 $C_j^{n+1} = C(x_j, t^n + \\Delta t)$ 的展开式为：\n$$\nC_j^{n+1} = C_j^n + \\Delta t \\, C_t + \\frac{(\\Delta t)^2}{2} C_{tt} + O((\\Delta t)^3)\n$$\n对 $C_{j-1}^n = C(x_j - \\Delta x, t^n)$ 的展开式为：\n$$\nC_{j-1}^n = C_j^n - \\Delta x \\, C_x + \\frac{(\\Delta x)^2}{2} C_{xx} - O((\\Delta x)^3)\n$$\n将这些展开式代入有限差分格式：\n$$\n\\frac{1}{\\Delta t} \\left( C_j^n + \\Delta t \\, C_t + \\frac{(\\Delta t)^2}{2} C_{tt} + \\dots - C_j^n \\right) + \\frac{u}{\\Delta x} \\left( C_j^n - \\left( C_j^n - \\Delta x \\, C_x + \\frac{(\\Delta x)^2}{2} C_{xx} - \\dots \\right) \\right) = 0\n$$\n简化各项：\n$$\n\\left( C_t + \\frac{\\Delta t}{2} C_{tt} + \\dots \\right) + \\frac{u}{\\Delta x} \\left( \\Delta x \\, C_x - \\frac{(\\Delta x)^2}{2} C_{xx} + \\dots \\right) = 0\n$$\n重新整理以匹配原始平流方程的形式，得到修正方程：\n$$\nC_t + u C_x = - \\frac{\\Delta t}{2} C_{tt} + \\frac{u \\Delta x}{2} C_{xx} - \\text{H.O.T.}\n$$\n右侧的项代表了格式的截断误差。领先阶误差项与 $\\Delta t$ 和 $\\Delta x$ 成正比。为了将此误差纯粹用空间导数表示，我们可以使用原始偏微分方程来近似时间导数项 $C_{tt}$。原始偏微分方程表明 $C_t = -u C_x$。对时间求导得到 $C_{tt} = \\frac{\\partial}{\\partial t}(-u C_x) = -u \\frac{\\partial}{\\partial x}(C_t)$。再次代入 $C_t = -u C_x$ 可得：\n$$\nC_{tt} = -u \\frac{\\partial}{\\partial x}(-u C_x) = u^2 C_{xx}\n$$\n将此代入修正方程：\n$$\nC_t + u C_x = - \\frac{\\Delta t}{2} (u^2 C_{xx}) + \\frac{u \\Delta x}{2} C_{xx} - \\text{H.O.T.}\n$$\n$$\nC_t + u C_x = \\left( \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} \\right) C_{xx} - \\text{H.O.T.}\n$$\n提出公因子项 $\\frac{u \\Delta x}{2}$：\n$$\nC_t + u C_x = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right) C_{xx} - \\text{H.O.T.}\n$$\n无量纲群 $\\mathcal{C} = \\frac{u \\Delta t}{\\Delta x}$ 是库朗-弗里德里希-列维（CFL）数。修正方程表明，一阶迎风格式在数值上求解的是一个附加了二阶导数项的平流方程，该项具有扩散项的形式。\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = \\kappa_{\\text{num}} \\frac{\\partial^2 C}{\\partial x^2}\n$$\n通过比较，领先阶伪（或数值）扩散系数为：\n$$\n\\kappa_{\\text{num}} = \\frac{u \\Delta x}{2} (1 - \\mathcal{C}) = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n\n**步骤 2：计算显式扩散系数 $\\kappa_h$**\n\n模型中的总有效水平扩散是显式增加的扩散 $\\kappa_h$ 和数值扩散 $\\kappa_{\\text{num}}$ 的和。问题要求这个和等于一个目标值 $K_{\\text{tot}}$：\n$$\nK_{\\text{tot}} = \\kappa_h + \\kappa_{\\text{num}}\n$$\n由此，我们可以解出所需的显式扩散系数：\n$$\n\\kappa_h = K_{\\text{tot}} - \\kappa_{\\text{num}} = K_{\\text{tot}} - \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n现在，我们代入给定的数值：\n- $u = 0.05$ m s$^{-1}$\n- $\\Delta x = 5.0 \\times 10^{3}$ m\n- $\\Delta t = 600$ s\n- $K_{\\text{tot}} = 3.00 \\times 10^{2}$ m$^{2}$ s$^{-1}$\n\n首先，我们计算 CFL 数 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\frac{u \\Delta t}{\\Delta x} = \\frac{(0.05 \\, \\text{m s}^{-1}) (600 \\, \\text{s})}{5.0 \\times 10^{3} \\, \\text{m}} = \\frac{30}{5000} = 0.006\n$$\n由于 $0  \\mathcal{C} \\le 1$，迎风格式是稳定的，并且数值扩散 $\\kappa_{\\text{num}}$ 是正的。\n\n接下来，我们计算数值扩散系数 $\\kappa_{\\text{num}}$：\n$$\n\\kappa_{\\text{num}} = \\frac{u \\Delta x}{2} (1 - \\mathcal{C}) = \\frac{(0.05 \\, \\text{m s}^{-1})(5.0 \\times 10^{3} \\, \\text{m})}{2} (1 - 0.006)\n$$\n$$\n\\kappa_{\\text{num}} = \\frac{250}{2} (0.994) \\, \\text{m}^2 \\text{s}^{-1} = 125 \\times 0.994 \\, \\text{m}^2 \\text{s}^{-1} = 124.25 \\, \\text{m}^2 \\text{s}^{-1}\n$$\n最后，我们计算所需的显式扩散系数 $\\kappa_h$：\n$$\n\\kappa_h = K_{\\text{tot}} - \\kappa_{\\text{num}} = 300 \\, \\text{m}^2 \\text{s}^{-1} - 124.25 \\, \\text{m}^2 \\text{s}^{-1} = 175.75 \\, \\text{m}^2 \\text{s}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\kappa_h \\approx 175.8 \\, \\text{m}^2 \\text{s}^{-1}\n$$\n这个值是正数，满足了真实示踪剂收支的条件，因为它对应于一个基于物理的扩散过程，而不是反扩散过程。",
            "answer": "$$\n\\boxed{175.8}\n$$"
        }
    ]
}