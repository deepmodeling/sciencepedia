{
    "hands_on_practices": [
        {
            "introduction": "预测-校正 (Predictor-Corrector) 方法巧妙地结合了显式方法的计算效率和隐式方法的稳定性优势。本练习将引导你从数值积分的基本原理出发，推导一个经典的二阶 Adams-Bashforth (AB2) 预测器和二阶 Adams-Moulton (AM2) 校正器，并将其组合成一个完整的 PECE 格式 。通过这个过程，你将深入理解这类常用格式的构造、精度阶数和稳定性边界。",
            "id": "3798652",
            "problem": "考虑一个半离散海洋模型的时间趋势，其形式为一个常微分方程初值问题 $y^{\\prime}(t)=f(t,y(t))$，其中右侧函数 $f$ 是光滑的。从积分形式 $y(t_{n+1})=y(t_{n})+\\int_{t_{n}}^{t_{n+1}} f(s,y(s))\\,\\mathrm{d}s$ 出发，并仅使用数值求积和对过去时间层上的 $f$ 进行多项式插值的原理，完成以下任务：\n\n1) 推导二阶两步 Adams–Moulton 校正子（梯形法则），以单步形式表示为关于 $f_{n+1}$ 和 $f_{n}$ 的 $y_{n+1}$ 的隐式更新，其中 $f_{k}=f(t_{k},y_{k})$ 且 $t_{k}=t_{0}+k h$，步长 $h0$ 为固定值。\n\n2) 通过在 $[t_{n-1},t_{n}]$ 上用一个经过 $\\{(t_{n-1},f_{n-1}),(t_{n},f_{n})\\}$ 的一次插值多项式来近似 $f$，推导二阶两步 Adams–Bashforth 预报子，并用它来构造在 $t_{n+1}$ 处的预报值 $y_{n+1}^{p}$。\n\n3) 将您的结果组合成一个单一的预报–求值–校正–求值 (PECE) 格式，其中第一次求值计算 $f_{n+1}^{p}=f(t_{n+1},y_{n+1}^{p})$，第二次求值计算 $f_{n+1}=f(t_{n+1},y_{n+1})$。基于关于 $t_{n}$ 的泰勒展开，说明并论证此 PECE 方法的全局精度阶 $p$。\n\n4) 将 PECE 方法应用于 Dahlquist 测试方程 $y^{\\prime}=\\lambda y$（其中 $\\lambda\\in\\mathbb{C}$），并定义 $z=h\\lambda$，来分析该方法的线性稳定性。推导 $y_{n}$ 作为 $z$ 的函数所满足的两步标量递推关系，然后确定最大的负实数 $z^{\\star}$，使得对于所有满足 $z\\in[z^{\\star},0]$ 的实数 $z$，该方法特征多项式的每个根的模都小于或等于 $1$。您最终报告的答案应该是 $z^{\\star}$ 的精确值，无需四舍五入，也无单位。\n\n最终答案必须是一个实数。",
            "solution": "该问题要求推导和分析一个用于求解形式为 $y^{\\prime}(t) = f(t, y(t))$ 的常微分方程的预报-校正数值格式。我们将依次解决问题的四个部分。\n\n1) 两步 Adams-Moulton 校正子（梯形法则）的推导\n我们从微分方程在区间 $[t_n, t_{n+1}]$ 上的积分形式开始：\n$$y(t_{n+1}) = y(t_n) + \\int_{t_n}^{t_{n+1}} f(s, y(s)) \\, \\mathrm{d}s$$\n数值积分的梯形法则将函数 $g(s)$ 在 $[a, b]$ 上的积分近似为 $\\frac{b-a}{2}(g(a)+g(b))$。将此法则应用于我们的积分，步长为 $h = t_{n+1} - t_n$，我们使用被积函数 $f(s, y(s))$ 在端点 $s=t_n$ 和 $s=t_{n+1}$ 处的值来近似它。这得到：\n$$\\int_{t_n}^{t_{n+1}} f(s, y(s)) \\, \\mathrm{d}s \\approx \\frac{h}{2} \\left[ f(t_n, y(t_n)) + f(t_{n+1}, y(t_{n+1})) \\right]$$\n用数值近似解 $y_k$ 替换精确解 $y(t_k)$，并定义 $f_k = f(t_k, y_k)$，我们得到以下数值格式：\n$$y_{n+1} = y_n + \\frac{h}{2} (f_n + f_{n+1})$$\n这就是梯形法则的单步隐式公式，也称为二阶两步 Adams-Moulton 方法。术语“两步”指的是用于构造 $f$ 的基础一次插值多项式的两个点 $(t_n, f_n)$ 和 $(t_{n+1}, f_{n+1})$。\n\n2) 两步 Adams-Bashforth 预报子的推导\n为了推导预报子，我们再次从积分形式开始。对于显式预报子，我们必须仅使用来自时间 $t_n$ 及更早时间的信息来近似积分。问题指定使用一个一次多项式 $P(s)$，它在点 $(t_{n-1}, f_{n-1})$ 和 $(t_n, f_n)$ 处对 $f$ 进行插值。使用该多项式的拉格朗日形式：\n$$P(s) = f_{n-1} \\frac{s - t_n}{t_{n-1} - t_n} + f_n \\frac{s - t_{n-1}}{t_n - t_{n-1}}$$\n由于 $t_k = t_0 + kh$，我们有 $t_n - t_{n-1} = h$。该多项式变为：\n$$P(s) = f_{n-1} \\frac{s - t_n}{-h} + f_n \\frac{s - t_{n-1}}{h} = \\frac{1}{h} \\left[ f_n(s - t_{n-1}) - f_{n-1}(s - t_n) \\right]$$\n我们现在通过将此多项式从 $s=t_n$ 积分到 $s=t_{n+1}$ 来近似该积分：\n$$\\int_{t_n}^{t_{n+1}} f(s, y(s)) \\, \\mathrm{d}s \\approx \\int_{t_n}^{t_{n+1}} P(s) \\, \\mathrm{d}s$$\n为了简化积分，我们使用换元法，令 $u = s - t_n$，则 $\\mathrm{d}u = \\mathrm{d}s$。积分上下限变为 $u=0$ 到 $u=h$。此外，$s - t_{n-1} = (s - t_n) + (t_n - t_{n-1}) = u + h$。\n\\begin{align*} \\int_0^h \\frac{1}{h} \\left[ f_n(u+h) - f_{n-1}(u) \\right] \\, \\mathrm{d}u = \\frac{1}{h} \\left[ f_n\\left(\\frac{u^2}{2} + hu\\right) - f_{n-1}\\left(\\frac{u^2}{2}\\right) \\right]_0^h \\\\ = \\frac{1}{h} \\left[ f_n\\left(\\frac{h^2}{2} + h^2\\right) - f_{n-1}\\left(\\frac{h^2}{2}\\right) \\right] \\\\ = \\frac{1}{h} \\left[ \\frac{3}{2}h^2 f_n - \\frac{1}{2}h^2 f_{n-1} \\right] \\\\ = h \\left( \\frac{3}{2} f_n - \\frac{1}{2} f_{n-1} \\right)\\end{align*}\n因此，$y_{n+1}$ 的预报值，记作 $y_{n+1}^p$，是：\n$$y_{n+1}^p = y_n + \\frac{h}{2} (3 f_n - f_{n-1})$$\n这就是二阶两步 Adams-Bashforth 方法的公式。\n\n3) PECE 格式和精度阶\n预报-求值-校正-求值 (PECE) 格式将前面的结果组合起来，每个时间步如下进行：\n(P) 预报 (Predict)：使用 Adams-Bashforth 预报子计算一个初步估计值 $y_{n+1}^p$。\n$$y_{n+1}^p = y_n + \\frac{h}{2} (3 f_n - f_{n-1})$$\n(E) 求值 (Evaluate)：在预报解处计算导数。\n$$f_{n+1}^p = f(t_{n+1}, y_{n+1}^p)$$\n(C) 校正 (Correct)：在 Adams-Moulton 校正子中使用此导数估计值，以获得该步的最终值 $y_{n+1}$。\n$$y_{n+1} = y_n + \\frac{h}{2} (f_n + f_{n+1}^p)$$\n(E) 求值 (Evaluate)：在校正解处计算导数，用于下一个时间步。\n$$f_{n+1} = f(t_{n+1}, y_{n+1})$$\n\n为了确定精度阶，我们分析局部截断误差 (LTE)，即假设步开始时解是精确的情况下，单步所产生的误差。AB2 预报子的 LTE 是 $\\tau_p = y(t_{n+1}) - y_{n+1}^p = \\frac{5}{12}h^3 y'''(t_n) + O(h^4)$。AM2 校正子的 LTE 是 $\\tau_c = y(t_{n+1}) - (y_n + \\frac{h}{2}(f_n + f(t_{n+1}, y(t_{n+1})))) = -\\frac{1}{12}h^3 y'''(t_n) + O(h^4)$。这两种基本方法都是 2 阶的。\n对于 PECE 格式，从精确值 $y_n = y(t_n)$ 和 $f_{n-1} = f(t_{n-1}, y(t_{n-1}))$ 开始，预报值的误差为：\n$$y_{n+1}^p = y(t_{n+1}) - \\frac{5}{12}h^3 y'''(t_n) + O(h^4)$$\n校正步骤中 $f$ 的参数是 $f(t_{n+1}, y_{n+1}^p)$。根据泰勒定理：\n$$f_{n+1}^p = f(t_{n+1}, y(t_{n+1}) - \\frac{5}{12}h^3 y'''(t_n) + O(h^4)) = f(t_{n+1}, y(t_{n+1})) - \\frac{\\partial f}{\\partial y} \\frac{5}{12}h^3 y'''(t_n) + O(h^4)$$\n校正后的值为 $y_{n+1} = y_n + \\frac{h}{2}(f_n + f_{n+1}^p)$。代入 $f_{n+1}^p$ 的展开式：\n$$y_{n+1} = \\left(y_n + \\frac{h}{2}(f_n + f(t_{n+1}, y(t_{n+1})))\\right) - \\frac{h}{2}\\left(\\frac{5}{12}h^3 \\frac{\\partial f}{\\partial y} y'''(t_n)\\right) + O(h^5)$$\n括号中的项是隐式 AM2 方法应用于精确数据的结果。其值为 $y(t_{n+1}) - \\tau_c = y(t_{n+1}) + \\frac{1}{12}h^3 y'''(t_n) + O(h^4)$。\n因此，\n$$y_{n+1} = y(t_{n+1}) + \\frac{1}{12}h^3 y'''(t_n) + O(h^4)$$\n包含 $\\frac{\\partial f}{\\partial y}$ 的项被吸收到 $O(h^4)$ 项中。完整的 PECE 步的 LTE 是：\n$$\\tau_{\\text{PECE}} = y(t_{n+1}) - y_{n+1} = -\\frac{1}{12}h^3 y'''(t_n) + O(h^4)$$\n由于 LTE 是 $O(h^3)$ 阶的，全局误差（在大约 $T/h$ 步上累积）是 $O(h^2)$ 阶的。因此，全局精度阶为 $p=2$。\n\n4) 线性稳定性分析\n我们将 PECE 格式应用于 Dahlquist 测试方程 $y' = \\lambda y$，其中 $\\lambda \\in \\mathbb{C}$。对于此方程，$f_k = f(t_k, y_k) = \\lambda y_k$。令 $z = h\\lambda$。\nPECE 的步骤变为：\n(P) $y_{n+1}^p = y_n + \\frac{h}{2}(3\\lambda y_n - \\lambda y_{n-1}) = y_n + \\frac{z}{2}(3y_n - y_{n-1}) = (1+\\frac{3z}{2})y_n - \\frac{z}{2}y_{n-1}$。\n(E) $f_{n+1}^p = \\lambda y_{n+1}^p$。\n(C) $y_{n+1} = y_n + \\frac{h}{2}(f_n + f_{n+1}^p) = y_n + \\frac{h}{2}(\\lambda y_n + \\lambda y_{n+1}^p) = (1+\\frac{z}{2})y_n + \\frac{z}{2}y_{n+1}^p$。\n\n现在，我们将 $y_{n+1}^p$ 的表达式代入校正子方程，以获得序列 $\\{y_k\\}$ 的单个递推关系：\n$$y_{n+1} = \\left(1+\\frac{z}{2}\\right)y_n + \\frac{z}{2}\\left[ \\left(1+\\frac{3z}{2}\\right)y_n - \\frac{z}{2}y_{n-1} \\right]$$\n$$y_{n+1} = \\left(1+\\frac{z}{2} + \\frac{z}{2} + \\frac{3z^2}{4}\\right)y_n - \\frac{z^2}{4}y_{n-1}$$\n$$y_{n+1} = \\left(1+z+\\frac{3z^2}{4}\\right)y_n - \\frac{z^2}{4}y_{n-1}$$\n这给出了两步标量递推关系：\n$$y_{n+1} - \\left(1+z+\\frac{3z^2}{4}\\right)y_n + \\frac{z^2}{4}y_{n-1} = 0$$\n为了找到稳定区域，我们检验特征多项式的根，该多项式通过代入 $y_n = \\xi^n$ 得到：\n$$\\xi^2 - \\left(1+z+\\frac{3z^2}{4}\\right)\\xi + \\frac{z^2}{4} = 0$$\n为了保证稳定性，所有根 $\\xi$ 必须满足 $|\\xi|\\le 1$。我们对二次多项式 $P(\\xi) = \\xi^2+a_1\\xi+a_0=0$ 使用 Jury 稳定性判据。所有根都在单位圆内或单位圆上 ($|\\xi| \\le 1$) 的条件是：\n1) $|a_0| \\le 1$\n2) $|a_1| \\le 1+a_0$\n\n这里，$a_0 = \\frac{z^2}{4}$ 且 $a_1 = -(1+z+\\frac{3z^2}{4})$。我们针对实数 $z  0$ 分析这些条件。\n\n条件 1：$|a_0| \\le 1$ 给出 $|\\frac{z^2}{4}| \\le 1$，这意味着 $z^2 \\le 4$，或 $|z| \\le 2$。对于负数 $z$，这是 $-2 \\le z \\le 0$。\n\n条件 2：$|a_1| \\le 1+a_0$ 等价于 $- (1+a_0) \\le a_1 \\le 1+a_0$。\n第一个不等式：$a_1 \\le 1+a_0$\n$$-(1+z+\\frac{3z^2}{4}) \\le 1+\\frac{z^2}{4} \\implies 0 \\le 2+z+z^2$$\n二次多项式 $z^2+z+2$ 的判别式为 $\\Delta = 1^2 - 4(1)(2) = -7  0$。由于首项系数为正，该二次式恒为正。因此这个不等式对所有实数 $z$ 都成立。\n\n第二个不等式：$a_1 \\ge -(1+a_0)$\n$$-(1+z+\\frac{3z^2}{4}) \\ge -(1+\\frac{z^2}{4}) \\implies 1+z+\\frac{3z^2}{4} \\le 1+\\frac{z^2}{4}$$\n$$z + \\frac{2z^2}{4} \\le 0 \\implies z + \\frac{z^2}{2} \\le 0 \\implies z(1+\\frac{z}{2}) \\le 0$$\n$z(1+z/2)=0$ 的根是 $z=0$ 和 $z=-2$。抛物线 $z(1+z/2)$ 开口向上，因此在其根之间是非正的。此不等式对 $z \\in [-2, 0]$ 成立。\n\n对于实数 $z$，综合所有条件，稳定区域是 $[-2, 0]$、$\\mathbb{R}$ 和 $[-2, 0]$ 的交集，即 $[-2, 0]$。\n问题要求最大的负实数 $z^{\\star}$，使得对于所有 $z \\in [z^{\\star}, 0]$，稳定性都成立。这对应于所推导的稳定区间的左端点。因此，$z^{\\star} = -2$。",
            "answer": "$$\\boxed{-2}$$"
        },
        {
            "introduction": "像 Adams-Bashforth 这样的多步法的一个关键挑战是它们需要若干个历史时间点上的解作为计算起点。本练习聚焦于这个“启动问题”，演示如何推导并使用一个高阶单步法（如 Runge-Kutta 法）来生成必要的初始值 。这确保了整个数值模拟的全局精度不会因为初始几步的误差而受到影响，是实现高阶多步积分方案的必备技能。",
            "id": "3798641",
            "problem": "在计算海洋学中，一个常见的显式多步积分器是$k$阶Adams–Bashforth方法（Adams–Bashforth (AB$k$)）。因为AB$k$方法需要$k$个过去的解值$\\{y^{n}, y^{n-1}, \\ldots, y^{n-k+1}\\}$来从时间$t^{n}$推进到$t^{n+1}$，所以需要一个精确的启动程序来从给定的初始条件构造这些初始值。考虑混合层纬向流，其模型为一个标量初值问题\n$$\n\\frac{du}{dt} \\;=\\; -\\alpha\\,u \\;+\\; F_0\\,\\cos(\\omega t),\n$$\n其中$u(0)=0$，$\\alpha0$是线性阻尼率，$F_00$是恒定的风力振幅，$\\omega0$是特征近惯性频率。这个标量模型被广泛用作表层混合层中风生近惯性流的简化描述。\n\n您将使用固定的时间步长$\\Delta t$来构造$u^1 \\approx u(\\Delta t)$和$u^2 \\approx u(2\\Delta t)$，以初始化三阶Adams–Bashforth方法（AB3）。从单步Runge–Kutta方法的基本定义（即沿试验阶段轨迹应用的右端项的积分）出发，并使用泰勒级数阶条件推导一个三级三阶显式Runge–Kutta（Runge–Kutta (RK)）格式。然后应用该格式计算$u^1$和$u^2$。在您的推导中，清楚地说明为什么AB2只需要一个二阶精度的启动值$y^1$，而AB3需要两个三阶精度的启动值$\\{y^1,y^2\\}$来保持多步方法的全局阶。\n\n使用以下物理上一致的参数值，这些值是中纬度近惯性强迫的代表值：\n- $\\alpha = \\frac{1}{86400}\\ \\mathrm{s}^{-1}$，\n- $F_0 = 1 \\times 10^{-4}\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$，\n- $\\omega = 1 \\times 10^{-4}\\ \\mathrm{rad}\\ \\mathrm{s}^{-1}$，\n- $\\Delta t = 3600\\ \\mathrm{s}$。\n\n使用推导出的三阶RK启动程序计算$u^2$，并以$\\mathrm{m}\\ \\mathrm{s}^{-1}$为单位报告$u^2$的值。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题是适定的，具有科学依据，并为获得唯一解提供了所有必要信息。这是数值方法在海洋学中一个简化但物理相关的模型上的标准应用。因此，该问题被认为是有效的。\n\n求解过程包括三个主要部分：\n1.  推导一个三级三阶显式Runge-Kutta (RK3) 格式。\n2.  解释Adams-Bashforth (AB) 方法的启动精度要求。\n3.  应用推导出的RK3格式计算给定初值问题的要求值。\n\n**第一部分：三级三阶显式Runge-Kutta格式的推导**\n\n对于初值问题$\\frac{dy}{dt} = f(t, y)$，一个$s$级显式Runge-Kutta (RK) 方法由下式给出\n$$\ny^{n+1} = y^n + \\Delta t \\sum_{i=1}^{s} b_i k_i\n$$\n其中$k_i$为\n$$\nk_i = f\\left(t^n + c_i \\Delta t, y^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} k_j\\right).\n$$\n对于显式方法，我们施加条件$c_i = \\sum_{j=1}^{i-1} a_{ij}$。为了使方法达到$p=3$阶，系数$\\{a_{ij}, b_i, c_i\\}$必须满足一组阶条件，这些条件是通过将数值解的泰勒级数展开式与真解的展开式匹配到$(\\Delta t)^3$阶项而得出的。对于$s=3$级，三阶及以下的阶条件为：\n1.  1阶：$\\sum_{i=1}^3 b_i = 1$\n2.  2阶：$\\sum_{i=1}^3 b_i c_i = \\frac{1}{2}$\n3.  3阶：\n    a) $\\sum_{i=1}^3 b_i c_i^2 = \\frac{1}{3}$\n    b) $\\sum_{i,j=1}^3 b_i a_{ij} c_j = \\frac{1}{6}$\n\n由于该方法是显式的，$j \\ge i$时$a_{ij}=0$，$c_1=0$，$c_2 = a_{21}$，以及$c_3 = a_{31} + a_{32}$。阶条件简化为：\n1.  $b_1 + b_2 + b_3 = 1$\n2.  $b_2 c_2 + b_3 c_3 = \\frac{1}{2}$\n3.  $b_2 c_2^2 + b_3 c_3^2 = \\frac{1}{3}$\n4.  $b_3 a_{32} c_2 = \\frac{1}{6}$\n\n这是一个包含$6$个未知数（$b_1, b_2, b_3, c_2, c_3, a_{32}$）的$4$个方程组，因此我们有两个自由参数。一个常见且规范的选择是设$c_2 = \\frac{1}{2}$和$c_3 = 1$。将这些值代入方程（2）和（3）：\n$$\n\\frac{1}{2} b_2 + b_3 = \\frac{1}{2}\n$$\n$$\n\\frac{1}{4} b_2 + b_3 = \\frac{1}{3}\n$$\n第一个方程减去第二个方程得到$\\frac{1}{4} b_2 = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}$，从而得出$b_2 = \\frac{4}{6} = \\frac{2}{3}$。\n将$b_2$代回，我们得到$b_3 = \\frac{1}{3} - \\frac{1}{4} b_2 = \\frac{1}{3} - \\frac{1}{4} \\left(\\frac{2}{3}\\right) = \\frac{1}{3} - \\frac{1}{6} = \\frac{1}{6}$。\n从方程（1）中，我们得到$b_1 = 1 - b_2 - b_3 = 1 - \\frac{2}{3} - \\frac{1}{6} = \\frac{6-4-1}{6} = \\frac{1}{6}$。\n现在，我们使用方程（4）以及已知的$b_3$和$c_2$的值来求解$a_{32}$：\n$$\n\\frac{1}{6} a_{32} \\left(\\frac{1}{2}\\right) = \\frac{1}{6} \\implies \\frac{a_{32}}{12} = \\frac{1}{6} \\implies a_{32} = 2.\n$$\n最后，我们使用显式方法的条件来找到剩余的系数：\n$a_{21} = c_2 = \\frac{1}{2}$。\n$a_{31} = c_3 - a_{32} = 1 - 2 = -1$。\n得到的格式被称为Kutta三阶方法，定义如下：\n$$\nk_1 = f(t^n, y^n)\n$$\n$$\nk_2 = f\\left(t^n + \\frac{1}{2}\\Delta t, y^n + \\frac{1}{2}\\Delta t k_1\\right)\n$$\n$$\nk_3 = f\\left(t^n + \\Delta t, y^n - \\Delta t k_1 + 2\\Delta t k_2\\right)\n$$\n$$\ny^{n+1} = y^n + \\frac{\\Delta t}{6}(k_1 + 4 k_2 + k_3)\n$$\n这是一个有效的三级三阶显式RK格式。\n\n**第二部分：Adams-Bashforth方法的启动精度**\n\n一个$p$阶Adams-Bashforth方法（AB$p$）是一个$p$步线性多步方法。只要该方法是稳定的，并且其局部截断误差（LTE）为$O(\\Delta t^{p+1})$，其全局误差的阶为$O(\\Delta t^p)$。全局误差$e^n = y(t^n) - y^n$取决于两个来源：每一步LTE的累积，以及初始启动值$\\{y^1, \\dots, y^{p-1}\\}$误差的传播。\n\n对于一个稳定的$p$步方法，在时间$t^n$的全局误差受一个量所限制，该量与初始误差和累积LTE之和成正比。为达到$O(\\Delta t^p)$的整体全局精度，来自启动值的误差贡献不能是更低的阶。也就是说，启动值中的误差，$e^i = y(t^i) - y^i$（对于$i=1, \\dots, p-1$），其本身必须至少为$O(\\Delta t^p)$。\n\n为了生成这些启动值，通常使用单步方法。一个$p$阶单步方法，例如RK$p$格式，其全局误差为$O(\\Delta t^p)$。因此，要计算一个值$y^i = y(i\\Delta t)$，使其误差$e^i = O(\\Delta t^p)$，必须使用一个至少为$p$阶的启动方法。\n\n-   **对于AB2（$p=2$）：** 这是一个全局阶为$O(\\Delta t^2)$的2步方法。除了初始条件$y^0=y(0)$外，它还需要一个启动值$y^1$。为了保持$O(\\Delta t^2)$的全局精度，启动值的误差$|y(\\Delta t) - y^1|$必须是$O(\\Delta t^2)$。这需要一个至少为二阶精度的启动程序。\n\n-   **对于AB3（$p=3$）：** 这是一个全局阶为$O(\\Delta t^3)$的3步方法。它需要两个启动值$\\{y^1, y^2\\}$。为了保持$O(\\Delta t^3)$的全局精度，误差$|y(\\Delta t) - y^1|$和$|y(2\\Delta t) - y^2|$都必须是$O(\\Delta t^3)$。这需要一个至少为三阶精度的启动程序，例如上面推导的RK3格式。\n\n**第三部分：在混合层纬向流模型中的应用**\n\n初值问题由下式给出\n$$\n\\frac{du}{dt} = -\\alpha u + F_0 \\cos(\\omega t), \\quad u(0) = 0.\n$$\n我们定义函数$f(t,u) = -\\alpha u + F_0 \\cos(\\omega t)$。给定的参数是：\n- $\\alpha = \\frac{1}{86400}\\ \\mathrm{s}^{-1}$\n- $F_0 = 1 \\times 10^{-4}\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$\n- $\\omega = 1 \\times 10^{-4}\\ \\mathrm{rad}\\ \\mathrm{s}^{-1}$\n- $\\Delta t = 3600\\ \\mathrm{s}$\n- $u^0 = u(0) = 0$\n\n我们将使用推导出的RK3格式来计算$u^1 \\approx u(\\Delta t)$，然后计算$u^2 \\approx u(2\\Delta t)$。\n\n**第一步：计算$u^1$**\n我们从$t^0=0$推进到$t^1 = \\Delta t = 3600$。初始条件是$u^0=0$。\n\n1.  计算$k_1$：\n    $k_1 = f(t^0, u^0) = f(0, 0) = -\\alpha(0) + F_0 \\cos(0) = F_0 = 10^{-4}$。\n\n2.  计算$k_2$：\n    参数为$t^0 + \\frac{1}{2}\\Delta t = 1800$和$u^0 + \\frac{1}{2}\\Delta t k_1 = 0 + \\frac{3600}{2}(10^{-4}) = 0.18$。\n    $k_2 = f(1800, 0.18) = -\\alpha(0.18) + F_0 \\cos(\\omega \\cdot 1800) = -\\frac{0.18}{86400} + 10^{-4}\\cos(0.18) \\approx 9.6303354 \\times 10^{-5}$。\n\n3.  计算$k_3$：\n    参数为$t^0 + \\Delta t = 3600$和$u_k = u^0 + \\Delta t(-k_1 + 2k_2) = 0 + 3600(-10^{-4} + 2(9.6303354 \\times 10^{-5})) \\approx 0.33338415$。\n    $k_3 = f(3600, 0.33338415) = -\\alpha(0.33338415) + F_0 \\cos(\\omega \\cdot 3600) = -\\frac{0.33338415}{86400} + 10^{-4}\\cos(0.36) \\approx 8.9690330 \\times 10^{-5}$。\n\n4.  计算$u^1$：\n    $u^1 = u^0 + \\frac{\\Delta t}{6}(k_1 + 4k_2 + k_3) = 0 + \\frac{3600}{6}(10^{-4} + 4(9.6303354 \\times 10^{-5}) + 8.9690330 \\times 10^{-5})$。\n    $u^1 \\approx 600(10^{-4} + 3.8521342 \\times 10^{-4} + 8.9690330 \\times 10^{-5}) = 600(5.7490375 \\times 10^{-4}) \\approx 0.34494225$。\n\n**第二步：计算$u^2$**\n我们从$t^1=3600$推进到$t^2 = 2\\Delta t = 7200$。初始条件是$(t^1, u^1) = (3600, 0.34494225)$。让我们将新的阶段表示为$k'_i$。\n\n1.  计算$k'_1$：\n    $k'_1 = f(t^1, u^1) = f(3600, 0.34494225) = -\\alpha(0.34494225) + F_0 \\cos(\\omega \\cdot 3600) = -\\frac{0.34494225}{86400} + 10^{-4}\\cos(0.36) \\approx 8.9556555 \\times 10^{-5}$。\n\n2.  计算$k'_2$：\n    参数为$t^1 + \\frac{1}{2}\\Delta t = 5400$和$u^1 + \\frac{1}{2}\\Delta t k'_1 \\approx 0.34494225 + \\frac{3600}{2}(8.9556555 \\times 10^{-5}) \\approx 0.50614405$。\n    $k'_2 = f(5400, 0.50614405) = -\\alpha(0.50614405) + F_0 \\cos(\\omega \\cdot 5400) = -\\frac{0.50614405}{86400} + 10^{-4}\\cos(0.54) \\approx 7.9912733 \\times 10^{-5}$。\n\n3.  计算$k'_3$：\n    参数为$t^1 + \\Delta t = 7200$和$u_k = u^1 + \\Delta t(-k'_1 + 2k'_2) \\approx 0.34494225 + 3600(-8.9556555 \\times 10^{-5} + 2(7.9912733 \\times 10^{-5})) \\approx 0.59791032$。\n    $k'_3 = f(7200, 0.59791032) = -\\alpha(0.59791032) + F_0 \\cos(\\omega \\cdot 7200) = -\\frac{0.59791032}{86400} + 10^{-4}\\cos(0.72) \\approx 6.8266206 \\times 10^{-5}$。\n\n4.  计算$u^2$：\n    $u^2 = u^1 + \\frac{\\Delta t}{6}(k'_1 + 4k'_2 + k'_3)$。\n    $u^2 \\approx 0.34494225 + \\frac{3600}{6}(8.9556555 \\times 10^{-5} + 4(7.9912733 \\times 10^{-5}) + 6.8266206 \\times 10^{-5})$。\n    $u^2 \\approx 0.34494225 + 600(8.9556555 \\times 10^{-5} + 3.1965093 \\times 10^{-4} + 6.8266206 \\times 10^{-5})$。\n    $u^2 \\approx 0.34494225 + 600(4.7747369 \\times 10^{-4}) \\approx 0.34494225 + 0.28648421$。\n    $u^2 \\approx 0.63142646$。\n\n四舍五入到四位有效数字，我们得到$u^2 \\approx 0.6314$。",
            "answer": "$$\n\\boxed{0.6314}\n$$"
        },
        {
            "introduction": "在许多实际的海洋学模拟中，过程的特征时间尺度会发生变化，使用固定的时间步长效率低下。本练习将带你超越教科书中恒定步长的情况，探讨如何推导变步长的 Adams-Bashforth 方法 。通过从拉格朗日插值多项式出发，你将掌握修改数值格式以适应可变时间步长的核心技巧，这是开发自适应数值模型的关键一步。",
            "id": "3798668",
            "problem": "考虑一个在计算海洋学中常见的标量预报常微分方程，例如空间均匀的示踪剂收支方程，\n$$\n\\frac{d u}{d t} = F\\!\\left(u(t), t\\right),\n$$\n其中 $u$ 表示一个预报变量，$F$ 代表已解析和参数化的源项。时间层级为 $t_{n-1}$、$t_{n}$ 和 $t_{n+1}$，时间步长可变，分别为 $h_{n-1} = t_{n} - t_{n-1}$ 和 $h_{n} = t_{n+1} - t_{n}$。经典的两步 Adams-Bashforth (AB) 方法的核心思想是，对利用过去数据构建的趋势项 $F$ 的多项式插值函数进行时间积分。\n\n请从多项式插值的角度解释，为何当 $h_{n} \\neq h_{n-1}$ 时，固定步长的两步 Adams-Bashforth 方法的固定系数不再适用。然后，通过构建穿过节点 $(t_{n-1}, F_{n-1})$ 和 $(t_{n}, F_{n})$ 的 $F(t)$ 的一阶拉格朗日时间插值多项式，并将该插值多项式从 $t_{n}$ 积分到 $t_{n+1}$，推导出以下形式的可变步长两步 Adams-Bashforth 更新格式\n$$\nu^{n+1} = u^{n} + h_{n}\\,\\big[a(r)\\,F_{n} + b(r)\\,F_{n-1}\\big],\n$$\n其中 $F_{k} = F\\!\\left(u^{k}, t_{k}\\right)$ 且 $r = h_{n}/h_{n-1}$。请以 $r$ 的闭式表达式形式，给出系数函数对 $\\big(a(r), b(r)\\big)$ 作为你的最终答案。无需进行数值计算。请将你的最终答案表示为行向量。最终答案必须是符号形式的计算结果，且不包含任何单位。",
            "solution": "该问题首先要求解释为何固定步长的两步 Adams-Bashforth (AB2) 方法的系数不适用于可变时间步长，其次要求推导可变步长 AB2 方法的系数。\n\n我们考虑的常微分方程是\n$$\n\\frac{du}{dt} = F(u(t), t)\n$$\n将此方程从时间 $t_n$ 积分到 $t_{n+1}$，得到精确关系：\n$$\nu(t_{n+1}) = u(t_n) + \\int_{t_n}^{t_{n+1}} F(u(t), t) \\,dt\n$$\nAdams-Bashforth 方法族通过用一个多项式替换函数 $F(u(t), t)$ 来近似该积分，该多项式对函数在先前时间步长的已知值进行插值。对于两步法 (AB2)，我们使用一个一阶多项式 $P_1(t)$，它穿过点 $(t_{n-1}, F_{n-1})$ 和 $(t_n, F_n)$，其中 $F_k = F(u^k, t_k)$ 是在第 $k$ 步计算出的趋势项。于是，数值格式定义为：\n$$\nu^{n+1} = u^n + \\int_{t_n}^{t_{n+1}} P_1(t) \\,dt\n$$\n解释的核心在于如何从这个积分中推导出该格式的系数。该积分的值取决于插值点 $t_{n-1}$ 和 $t_n$ 相对于积分区间 $[t_n, t_{n+1}]$ 的位置。\n\n对于经典的固定步长情况，时间步长是均匀的，即 $h_n = t_{n+1} - t_n = h$ 且 $h_{n-1} = t_n - t_{n-1} = h$。这种几何结构是固定的：定义插值点的区间 $[t_{n-1}, t_n]$ 的长度等于积分区间 $[t_n, t_{n+1}]$ 的长度。在进行积分并按时间步长 $h$ 进行归一化后，这种特定的几何构型会为 $F_n$ 和 $F_{n-1}$ 带来一组唯一的无量纲常系数。\n\n在可变步长情况下，$h_{n-1} \\neq h_n$。点 $t_{n-1}$、$t_n$ 和 $t_{n+1}$ 的相对间距不再是固定的。现在的几何结构由时间步长之比 $r = h_n / h_{n-1}$ 参数化。由于插值多项式 $P_1(t)$ 的定积分值取决于积分限和插值点，其值会随着比率 $r$ 的变化而变化。因此，最终格式中乘以 $F_n$ 和 $F_{n-1}$ 的系数不可能是常数；它们必须是描述时间步长几何结构的参数 $r$ 的函数。固定步长方法的固定系数仅在 $r=1$ 的特定情况下有效。\n\n我们现在推导可变步长系数 $a(r)$ 和 $b(r)$。\n穿过点 $(t_{n-1}, F_{n-1})$ 和 $(t_n, F_n)$ 的一阶拉格朗日插值多项式 $P_1(t)$ 由下式给出：\n$$\nP_1(t) = F_n \\frac{t - t_{n-1}}{t_n - t_{n-1}} + F_{n-1} \\frac{t - t_n}{t_{n-1} - t_n}\n$$\n使用定义 $h_{n-1} = t_n - t_{n-1}$ 和 $t_{n-1} - t_n = -h_{n-1}$，我们可以将多项式重写为：\n$$\nP_1(t) = F_n \\frac{t - t_{n-1}}{h_{n-1}} - F_{n-1} \\frac{t - t_n}{h_{n-1}}\n$$\n任务是计算积分 $I = \\int_{t_n}^{t_{n+1}} P_1(t) \\,dt$。为简化积分，我们通过变换 $t = t_n + \\tau h_n$ 引入一个无量纲时间变量 $\\tau$，其中 $h_n = t_{n+1} - t_n$。微分变为 $dt = h_n \\,d\\tau$。积分限从 $t=t_n$ 变为 $\\tau=0$，从 $t=t_{n+1}$ 变为 $\\tau=1$。\n\n我们用 $\\tau$ 表示 $P_1(t)$ 中的各项：\n$$\nt - t_n = \\tau h_n\n$$\n$$\nt - t_{n-1} = (t_n + \\tau h_n) - t_{n-1} = (t_n - t_{n-1}) + \\tau h_n = h_{n-1} + \\tau h_n\n$$\n将这些代入 $P_1(t)$ 的表达式，得到以 $\\tau$ 表示的多项式：\n$$\nP_1(t_n + \\tau h_n) = F_n \\frac{h_{n-1} + \\tau h_n}{h_{n-1}} - F_{n-1} \\frac{\\tau h_n}{h_{n-1}}\n$$\n我们可以通过引入比率 $r = h_n / h_{n-1}$ 来简化此式：\n$$\nP_1(t_n + \\tau h_n) = F_n (1 + \\tau r) - F_{n-1} (\\tau r)\n$$\n现在我们计算积分：\n$$\nI = \\int_0^1 \\left[ F_n (1 + \\tau r) - F_{n-1} (\\tau r) \\right] h_n \\,d\\tau = h_n \\int_0^1 \\left[ (1 + \\tau r) F_n - \\tau r F_{n-1} \\right] \\,d\\tau\n$$\n对 $\\tau$ 进行积分：\n$$\nI = h_n \\left[ \\left(\\tau + \\frac{r\\tau^2}{2}\\right) F_n - \\left(\\frac{r\\tau^2}{2}\\right) F_{n-1} \\right]_0^1\n$$\n在积分限 $\\tau=1$ 和 $\\tau=0$ 处求值：\n$$\nI = h_n \\left[ \\left(1 + \\frac{r(1)^2}{2}\\right) F_n - \\left(\\frac{r(1)^2}{2}\\right) F_{n-1} - (0) \\right]\n$$\n$$\nI = h_n \\left[ \\left(1 + \\frac{r}{2}\\right) F_n - \\frac{r}{2} F_{n-1} \\right]\n$$\n$u^{n+1}$ 的更新式为 $u^{n+1} = u^n + I$：\n$$\nu^{n+1} = u^n + h_n \\left[ \\left(1 + \\frac{r}{2}\\right) F_n - \\frac{r}{2} F_{n-1} \\right]\n$$\n将此结果与所需形式 $u^{n+1} = u^{n} + h_{n}\\,\\big[a(r)\\,F_{n} + b(r)\\,F_{n-1}\\big]$ 进行比较，我们可以确定系数函数 $a(r)$ 和 $b(r)$：\n$$\na(r) = 1 + \\frac{r}{2}\n$$\n$$\nb(r) = -\\frac{r}{2}\n$$\n这些就是可变步长两步 Adams-Bashforth 方法的系数。作为检验，如果步长是固定的，即 $h_n = h_{n-1}$，则 $r=1$。系数变为 $a(1) = 1 + \\frac{1}{2} = \\frac{3}{2}$ 和 $b(1) = -\\frac{1}{2}$，这正是固定步长 AB2 方法的著名系数。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 + \\frac{r}{2}  -\\frac{r}{2} \\end{pmatrix}}\n$$"
        }
    ]
}