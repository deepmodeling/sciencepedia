{
    "hands_on_practices": [
        {
            "introduction": "To truly understand the effect of the Robert-Asselin filter, one must analyze how it alters the fundamental properties of the time-stepping scheme. This exercise guides you through a von Neumann stability analysis to derive the amplification factor for the leapfrog scheme, both with and without the filter . By comparing these two dispersion relations, you will see precisely how the filter damps the computational mode and slightly modifies the physical mode.",
            "id": "3816242",
            "problem": "Consider one-dimensional linear advection, $u_{t} + c\\,u_{x} = 0$, on a uniform grid with spatial interval $\\Delta x$ and time step $\\Delta t$. The field is discretized with centered differences in space and the leapfrog scheme in time, and the Robert–Asselin time filter (RA) is optionally applied. Let the discrete state at grid point $x_{j} = j\\,\\Delta x$ and time $t^{n} = n\\,\\Delta t$ be $u_{j}^{n}$. The leapfrog update is defined by the centered-difference approximation for $u_{x}$ and the centered-in-time approximation for $u_{t}$. The RA filter has coefficient $\\epsilon \\in [0,1)$ and is applied after each leapfrog step to the intermediate time level according to the standard practice for the Robert–Asselin time filter (RA), namely replacing $u_{j}^{n}$ by $u_{j}^{n} + \\epsilon\\,(u_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1})$.\n\nAdopt a normal-mode ansatz $u_{j}^{n} = \\hat{u}\\,\\exp\\!\\big(i\\,k\\,x_{j}\\big)\\,\\lambda^{n}$, where $k$ is the continuous wavenumber, $\\kappa \\equiv k\\,\\Delta x$ is the dimensionless grid wavenumber, and $\\lambda$ is the one-step amplification factor. Define the Courant number $\\mu \\equiv c\\,\\Delta t / \\Delta x$. Starting from the partial differential equation and the above discretization definitions, derive the closed-form discrete dispersion relations for the one-step amplification factor $\\lambda$ as functions of $\\mu$ and $\\kappa$:\n- Without the Robert–Asselin time filter (i.e., $\\epsilon = 0$).\n- With the Robert–Asselin time filter of coefficient $\\epsilon$.\n\nExpress both final relations as closed-form analytic expressions for the amplification factor of the physical (advecting) mode, in terms of $\\mu$, $\\kappa$, and $\\epsilon$. Do not present intermediate equations; provide only the final expressions. No rounding is required, and no units are to be reported.",
            "solution": "The problem requires the derivation of the discrete dispersion relation, specifically the one-step amplification factor $\\lambda$, for the linear advection equation discretized using the leapfrog scheme, both with and without the Robert–Asselin (RA) time filter.\n\nThe one-dimensional linear advection equation is given by:\n$$\nu_{t} + c\\,u_{x} = 0\n$$\nwhere $u$ is the field variable, $t$ is time, $x$ is the spatial coordinate, and $c$ is the constant advection speed.\n\nThe problem is discretized on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. The state is denoted $u_j^n = u(j\\Delta x, n\\Delta t)$. The leapfrog scheme uses a centered difference in time, and the spatial derivative is approximated by a centered difference:\n$$\n\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0\n$$\nThis can be rearranged to express the state at the new time level $n+1$:\n$$\nu_j^{n+1} = u_j^{n-1} - \\frac{c\\Delta t}{\\Delta x} (u_{j+1}^n - u_{j-1}^n)\n$$\nUsing the definition of the Courant number $\\mu \\equiv c\\,\\Delta t / \\Delta x$, the update rule becomes:\n$$\nu_j^{n+1} = u_j^{n-1} - \\mu (u_{j+1}^n - u_{j-1}^n)\n$$\nTo analyze the stability and dispersion of this scheme, we use the von Neumann method, substituting the normal-mode ansatz $u_j^n = \\hat{u}\\,\\exp\\!\\big(i\\,k\\,x_{j}\\big)\\,\\lambda^{n}$ into the discrete equation. Here $i = \\sqrt{-1}$, $k$ is the wavenumber, $\\lambda$ is the amplification factor per time step, and $\\hat{u}$ is a constant amplitude. Substituting $x_j=j\\Delta x$ gives $u_j^n = \\hat{u} \\lambda^n e^{ikj\\Delta x}$.\n\nPlugging the ansatz into the discrete equation:\n$$\n\\hat{u}\\lambda^{n+1} e^{ikj\\Delta x} = \\hat{u}\\lambda^{n-1} e^{ikj\\Delta x} - \\mu \\left( \\hat{u}\\lambda^{n} e^{ik(j+1)\\Delta x} - \\hat{u}\\lambda^{n} e^{ik(j-1)\\Delta x} \\right)\n$$\nDividing by $\\hat{u}\\lambda^{n-1} e^{ikj\\Delta x}$ (assuming it is non-zero):\n$$\n\\lambda^2 = 1 - \\mu \\lambda (e^{ik\\Delta x} - e^{-ik\\Delta x})\n$$\nUsing the identity $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ and the definition of the dimensionless wavenumber $\\kappa \\equiv k\\Delta x$:\n$$\n\\lambda^2 = 1 - \\mu \\lambda (2i\\sin\\kappa)\n$$\nThis gives the characteristic polynomial for the amplification factor $\\lambda$:\n$$\n\\lambda^2 + 2i\\mu\\sin(\\kappa)\\lambda - 1 = 0\n$$\n\n**Case 1: Without the Robert–Asselin time filter ($\\epsilon = 0$)**\n\nThis is the standard leapfrog scheme. The characteristic equation is the quadratic equation derived above. We solve for $\\lambda$:\n$$\n\\lambda = \\frac{-2i\\mu\\sin\\kappa \\pm \\sqrt{(2i\\mu\\sin\\kappa)^2 - 4(1)(-1)}}{2} = \\frac{-2i\\mu\\sin\\kappa \\pm \\sqrt{-4\\mu^2\\sin^2\\kappa + 4}}{2}\n$$\n$$\n\\lambda = -i\\mu\\sin\\kappa \\pm \\sqrt{1 - \\mu^2\\sin^2\\kappa}\n$$\nThis equation yields two roots for $\\lambda$, corresponding to a physical mode and a computational mode. The physical mode is the one that approximates the analytical amplification factor of the true solution, which is $e^{-i\\omega\\Delta t} = e^{-ikc\\Delta t} = e^{-i\\mu\\kappa}$. For small $\\mu$ and $\\kappa$, $e^{-i\\mu\\kappa} \\approx 1 - i\\mu\\kappa - \\frac{1}{2}(\\mu\\kappa)^2$.\nThe Taylor expansion of the root with the positive sign is $\\lambda \\approx -i\\mu\\kappa + (1 - \\frac{1}{2}\\mu^2\\kappa^2) = 1 - i\\mu\\kappa - \\frac{1}{2}\\mu^2\\kappa^2$, which matches the expansion of the analytical solution. Thus, the physical mode is:\n$$\n\\lambda_{\\text{physical}} = -i\\mu\\sin\\kappa + \\sqrt{1 - \\mu^2\\sin^2\\kappa}\n$$\n\n**Case 2: With the Robert–Asselin time filter of coefficient $\\epsilon$**\n\nThe RA filter is applied sequentially. First, a provisional value $u_j^{*,n+1}$ is computed using the leapfrog step. Then, the value at the central time level, $u_j^n$, is updated using this provisional value.\n1.  **Predictor step (Leapfrog):** $u_j^{*,n+1} = u_j^{n-1} - \\mu(u_{j+1}^n - u_{j-1}^n)$\n2.  **Corrector step (Filter):** The value $u_j^n$ is replaced by $\\bar{u}_j^n = u_j^n + \\epsilon(u_j^{*,n+1} - 2u_j^n + u_j^{n-1})$.\nThe new state carried forward to the next time step consists of $(\\bar{u}_j^n, u_j^{n+1})$, where $u_j^{n+1} = u_j^{*,n+1}$.\n\nWe perform a Fourier analysis of this two-stage process. Let $\\hat{u}^n$ be the Fourier amplitude of $u_j^n$. The spatial difference operator becomes a multiplication by $2i\\sin\\kappa$. Let $\\sigma = \\mu\\sin\\kappa$.\nThe system in Fourier space is:\n1.  $\\hat{u}^{*,n+1} = \\hat{u}^{n-1} - 2i\\sigma \\hat{u}^n$\n2.  $\\bar{u}^n = \\hat{u}^n + \\epsilon(\\hat{u}^{*,n+1} - 2\\hat{u}^n + \\hat{u}^{n-1})$\n\nThe state at any time can be described by a vector of amplitudes at two consecutive time levels, $V_n = \\begin{pmatrix} \\hat{u}^n \\\\ \\hat{u}^{n-1} \\end{pmatrix}$. The evolution to the next state $V_{n+1} = \\begin{pmatrix} \\hat{u}^{n+1} \\\\ \\bar{u}^n \\end{pmatrix}$ is given by a matrix $G$: $V_{n+1} = G V_n$.\nThe components of $V_{n+1}$ are:\n$\\hat{u}^{n+1} = \\hat{u}^{*,n+1} = -2i\\sigma \\hat{u}^n + \\hat{u}^{n-1}$\n$\\bar{u}^n = \\hat{u}^n + \\epsilon((\\hat{u}^{n-1} - 2i\\sigma \\hat{u}^n) - 2\\hat{u}^n + \\hat{u}^{n-1}) = (1 - 2\\epsilon - 2i\\sigma\\epsilon)\\hat{u}^n + 2\\epsilon \\hat{u}^{n-1}$\n\nThe amplification matrix $G$ is therefore:\n$$\nG = \\begin{pmatrix} -2i\\sigma  1 \\\\ 1 - 2\\epsilon(1+i\\sigma)  2\\epsilon \\end{pmatrix}\n$$\nThe amplification factors $\\lambda$ are the eigenvalues of $G$, found by solving $\\det(G - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -2i\\sigma - \\lambda  1 \\\\ 1 - 2\\epsilon(1+i\\sigma)  2\\epsilon - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-2i\\sigma - \\lambda)(2\\epsilon - \\lambda) - (1 - 2\\epsilon(1+i\\sigma)) = 0\n$$\nExpanding this determinant gives the characteristic equation:\n$$\n\\lambda^2 - 2\\epsilon\\lambda + 2i\\sigma\\lambda - 4i\\sigma\\epsilon - 1 + 2\\epsilon + 2i\\sigma\\epsilon = 0\n$$\n$$\n\\lambda^2 + 2(i\\sigma - \\epsilon)\\lambda + (2\\epsilon - 1 - 2i\\sigma\\epsilon) = 0\n$$\nSolving this quadratic equation for $\\lambda$:\n$$\n\\lambda = -(i\\sigma - \\epsilon) \\pm \\sqrt{(i\\sigma - \\epsilon)^2 - (2\\epsilon - 1 - 2i\\sigma\\epsilon)}\n$$\n$$\n\\lambda = \\epsilon - i\\sigma \\pm \\sqrt{(-\\sigma^2 - 2i\\sigma\\epsilon + \\epsilon^2) - (2\\epsilon - 1 - 2i\\sigma\\epsilon)}\n$$\n$$\n\\lambda = \\epsilon - i\\sigma \\pm \\sqrt{-\\sigma^2 + \\epsilon^2 - 2\\epsilon + 1} = \\epsilon - i\\sigma \\pm \\sqrt{(1-\\epsilon)^2 - \\sigma^2}\n$$\nSubstituting $\\sigma = \\mu\\sin\\kappa$ back:\n$$\n\\lambda = \\epsilon - i\\mu\\sin\\kappa \\pm \\sqrt{(1-\\epsilon)^2 - \\mu^2\\sin^2\\kappa}\n$$\nTo identify the physical mode, we examine the limit as $\\epsilon \\to 0$. The expression becomes $-i\\mu\\sin\\kappa \\pm \\sqrt{1 - \\mu^2\\sin^2\\kappa}$, which is the result for the unfiltered scheme. As established before, the physical mode corresponds to taking the positive sign for the square root. Thus, the amplification factor for the physical mode with the RA filter is:\n$$\n\\lambda_{\\text{physical}} = \\epsilon - i\\mu\\sin\\kappa + \\sqrt{(1-\\epsilon)^2 - \\mu^2\\sin^2\\kappa}\n$$\nThis expression correctly reduces to the unfiltered physical mode amplification factor when $\\epsilon=0$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -i\\mu\\sin(\\kappa) + \\sqrt{1 - \\mu^{2}\\sin^{2}(\\kappa)}  \\epsilon - i\\mu\\sin(\\kappa) + \\sqrt{(1-\\epsilon)^{2} - \\mu^{2}\\sin^{2}(\\kappa)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With a theoretical understanding of the filter's mechanism, the next practical step is to determine an appropriate value for the filter coefficient, $\\alpha$. This problem establishes a direct and useful relationship between $\\alpha$ and a desired e-folding timescale, $T_d$, for damping the computational mode . This provides a rational basis for calibrating the filter in a numerical model to achieve a specific level of stability without excessive damping.",
            "id": "3816230",
            "problem": "In many ocean general circulation models, prognostic equations are advanced with the centered-in-time leapfrog scheme, which supports a parasitic two-time-level oscillation known as the computational mode. To control this mode, models commonly apply the Robert–Asselin (RA) time filter after each leapfrog update. Consider a single prognostic scalar variable $u$ whose continuous-time tendency is constant in time, so that the underlying physical solution is time-independent. The leapfrog discretization then admits two discrete temporal components: a physical mode that is constant in $n$ and a computational mode that alternates sign as $(-1)^{n}$, where $n$ indexes discrete time levels separated by a constant time step $\\Delta t$.\n\nThe RA filter updates the just-computed field at time level $n$ according to\n$$\nu^{n} \\leftarrow u^{n} + \\frac{\\alpha}{2}\\left(u^{n-1} - 2 u^{n} + u^{n+1}\\right),\n$$\nwhere $\\alpha$ is a dimensionless filter strength applied at every time step. An e-folding timescale $T_{d}$ is prescribed for the amplitude decay of the computational mode, meaning that the magnitude of the computational-mode component should decay as $\\exp\\!\\left(-t/T_{d}\\right)$ with physical time $t$. Assume that the filter is applied once every time step and that the choice of $\\alpha$ should minimize the impact on the physical mode subject to achieving the specified e-folding of the computational mode.\n\nStarting from the definitions above and the decomposition of $u^{n}$ into physical and computational components, derive the per-step amplification factor of the computational mode under the RA filter, equate it to the desired discrete-time decay factor implied by the continuous e-folding timescale $T_{d}$, and determine a closed-form expression for $\\alpha$ in terms of $\\Delta t$ and $T_{d}$. State clearly any constraint you impose on $\\alpha$ to ensure minimal impact on the physical mode. Your final answer must be a single analytic expression for $\\alpha$ with no units. Do not approximate; no rounding is required.",
            "solution": "The problem requires the derivation of an expression for the Robert-Asselin (RA) filter coefficient, $\\alpha$, in terms of the model time step, $\\Delta t$, and a prescribed e-folding timescale for the computational mode, $T_d$. The derivation will proceed by analyzing the effect of the filter on the physical and computational modes of the solution.\n\nFirst, we validate the problem statement.\n\n**Step 1: Extract Givens**\n- Prognostic variable: a single scalar $u$.\n- Underlying physical solution: time-independent.\n- Discretization: centered-in-time leapfrog scheme.\n- Time levels: indexed by $n$, with a constant time step $\\Delta t$.\n- Physical mode: constant in $n$.\n- Computational mode: alternates sign as $(-1)^{n}$.\n- Robert-Asselin (RA) filter equation: $u^{n} \\leftarrow u^{n} + \\frac{\\alpha}{2}\\left(u^{n-1} - 2 u^{n} + u^{n+1}\\right)$.\n- Filter strength: $\\alpha$, a dimensionless parameter.\n- Filter application: once every time step.\n- Computational mode decay: magnitude decays as $\\exp(-t/T_d)$, where $t$ is physical time and $T_d$ is the prescribed e-folding timescale.\n- Constraint: The choice of $\\alpha$ must minimize the impact on the physical mode while achieving the specified decay of the computational mode.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard method for controlling numerical oscillations in geophysical fluid dynamics models. The concepts of physical and computational modes of the leapfrog scheme are fundamental in numerical analysis. The provided information is self-contained and sufficient to establish a relationship between $\\alpha$, $\\Delta t$, and $T_d$. The constraint to \"minimize the impact on the physical mode\" is a standard consideration in filter design, which, in this context, implies selecting the smallest possible value of $\\alpha$ that meets the primary objective, thereby preventing excessive damping of physically meaningful motions. The problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\nThe solution $u^n$ at time level $n$ can be decomposed into a physical component $u_p^n$ and a computational component $u_c^n$:\n$$\nu^n = u_p^n + u_c^n\n$$\nAccording to the problem statement:\n1.  The physical mode is constant in time. Let $U_p$ be a constant amplitude. Then, for all $n$,\n    $$\n    u_p^n = U_p\n    $$\n2.  The computational mode alternates in sign at each time step. Let $C^n$ be its amplitude at time level $n$. Then,\n    $$\n    u_c^n = C^n (-1)^n\n    $$\nThe RA filter is a linear operator. Therefore, we can analyze its effect on each component of the solution independently. Let $u_f^n$ denote the filtered value of $u^n$. The filter is defined as:\n$$\nu_f^n = u^n + \\frac{\\alpha}{2}\\left(u^{n-1} - 2 u^n + u^{n+1}\\right)\n$$\nThis can be rewritten as:\n$$\nu_f^n = (1-\\alpha)u^n + \\frac{\\alpha}{2}(u^{n-1} + u^{n+1})\n$$\n\nFirst, we analyze the filter's effect on the physical mode, $u_p^n$. Substituting $u^n = u_p^n = U_p$ into the filter equation:\n$$\n(u_p)_f^n = U_p + \\frac{\\alpha}{2}\\left(U_p - 2 U_p + U_p\\right) = U_p + \\frac{\\alpha}{2}(0) = U_p\n$$\nThe filter has no effect on a perfectly time-independent physical mode. For physical modes that are not strictly constant but slowly varying, the term $(u^{n-1} - 2u^n + u^{n+1})$ is a discrete approximation of $(\\Delta t)^2 \\frac{\\partial^2 u}{\\partial t^2}$. For low-frequency physical waves, this term is small, but the filter will introduce some damping proportional to $\\alpha$. The constraint to minimize the impact on the physical mode thus translates to minimizing the value of $\\alpha$.\n\nNext, we analyze the filter's effect on the computational mode, $u_c^n$. For this analysis, we consider the amplitude $C$ to be constant over the three time levels $\\{n-1, n, n+1\\}$ used in a single filter application.\n$$\nu_c^{n-1} = C(-1)^{n-1}, \\quad u_c^n = C(-1)^n, \\quad u_c^{n+1} = C(-1)^{n+1}\n$$\nSubstituting these into the filter equation gives the filtered computational mode at time level $n$:\n$$\n(u_c)_f^n = u_c^n + \\frac{\\alpha}{2}\\left(u_c^{n-1} - 2 u_c^n + u_c^{n+1}\\right)\n$$\n$$\n(u_c)_f^n = C(-1)^n + \\frac{\\alpha}{2}\\left(C(-1)^{n-1} - 2C(-1)^n + C(-1)^{n+1}\\right)\n$$\nFactor out $C(-1)^n$:\n$$\n(u_c)_f^n = C(-1)^n \\left[1 + \\frac{\\alpha}{2}\\left(\\frac{(-1)^{n-1}}{(-1)^n} - 2 + \\frac{(-1)^{n+1}}{(-1)^n}\\right)\\right]\n$$\n$$\n(u_c)_f^n = C(-1)^n \\left[1 + \\frac{\\alpha}{2}\\left((-1)^{-1} - 2 + (-1)^1\\right)\\right]\n$$\n$$\n(u_c)_f^n = C(-1)^n \\left[1 + \\frac{\\alpha}{2}(-1 - 2 - 1)\\right] = C(-1)^n \\left[1 + \\frac{\\alpha}{2}(-4)\\right]\n$$\n$$\n(u_c)_f^n = (1 - 2\\alpha) C(-1)^n = (1 - 2\\alpha) u_c^n\n$$\nThis demonstrates that a single application of the RA filter reduces the amplitude of the computational mode by a factor of $(1-2\\alpha)$. Since the filter is applied at every time step, this factor, let's call it $\\lambda_c$, is the per-step amplification factor for the computational mode:\n$$\n\\lambda_c = 1 - 2\\alpha\n$$\nThe problem requires that the magnitude of the computational mode decays with an e-folding timescale of $T_d$. The amplitude $A(t)$ at a physical time $t$ is given by $A(t) = A_0 \\exp(-t/T_d)$, where $A_0$ is the initial amplitude.\nOver a single time step of duration $\\Delta t$, the amplitude of the mode changes by a factor:\n$$\n\\frac{A(t+\\Delta t)}{A(t)} = \\frac{A_0 \\exp(-(t+\\Delta t)/T_d)}{A_0 \\exp(-t/T_d)} = \\exp(-\\Delta t/T_d)\n$$\nThis is the desired discrete-time decay factor per time step.\n\nTo achieve the specified decay, the amplification factor of the filter must match this required decay factor. A smaller amplification factor (i.e., a larger $\\alpha$) would lead to faster-than-required decay, but would also increase the undesirable damping of the physical modes. The constraint to \"minimize the impact on the physical mode\" instructs us to find the value of $\\alpha$ that produces exactly the desired decay, and no more. This means we must set the per-step amplification factor equal to the required decay factor:\n$$\n\\lambda_c = \\exp(-\\Delta t/T_d)\n$$\nSubstituting our expression for $\\lambda_c$:\n$$\n1 - 2\\alpha = \\exp(-\\Delta t/T_d)\n$$\nWe now solve this equation for $\\alpha$:\n$$\n2\\alpha = 1 - \\exp(-\\Delta t/T_d)\n$$\n$$\n\\alpha = \\frac{1 - \\exp(-\\Delta t/T_d)}{2}\n$$\nThis is the closed-form expression for $\\alpha$. The constraint imposed on $\\alpha$ to ensure minimal impact on the physical mode was to select the smallest value of $\\alpha$ consistent with the required damping, which corresponds to equating the filter's amplification factor with the target decay factor.\nFor damping to occur, we require $\\lambda_c  1$, which means $1 - 2\\alpha  1$, implying $\\alpha > 0$. Given that $\\Delta t > 0$ and $T_d > 0$, we have $\\exp(-\\Delta t/T_d)  1$, which ensures $\\alpha > 0$. To avoid changing the sign of the computational mode in one step, we require $\\lambda_c \\ge 0$, which implies $1 - 2\\alpha \\ge 0$, so $\\alpha \\le 1/2$. This condition is also generally satisfied in practical applications, as $\\Delta t \\ll T_d$.",
            "answer": "$$\n\\boxed{\\frac{1 - \\exp\\left(-\\frac{\\Delta t}{T_{d}}\\right)}{2}}\n$$"
        },
        {
            "introduction": "Applying the Robert-Asselin filter is not without consequences, and a crucial trade-off involves the scheme's accuracy. This hands-on coding exercise directs you to perform a numerical convergence study to measure the filter's impact on the formal order of accuracy of the leapfrog scheme . You will empirically confirm that a constant filter coefficient reduces the scheme to first-order accuracy and discover how scaling $\\alpha$ with the time step can restore the desired second-order accuracy.",
            "id": "3816241",
            "problem": "Consider the linear inertial oscillation obtained from the horizontal momentum equations under the Coriolis force with no pressure gradients, which is a standard test in computational oceanography. Let $u(t)$ and $v(t)$ denote the zonal and meridional velocity components, respectively. The governing equations are\n$$\n\\frac{d u}{d t} = f\\, v, \\qquad \\frac{d v}{d t} = -f\\, u,\n$$\nwhere $f$ is the Coriolis parameter in $\\mathrm{s}^{-1}$. Introducing the complex variable $z(t) = u(t) + i\\, v(t)$ gives the scalar ordinary differential equation\n$$\n\\frac{d z}{d t} = i\\, f\\, z,\n$$\nwith exact solution $z(t) = z(0)\\, e^{i f t}$, which is smooth for all $t$. The inertial period is $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ seconds.\n\nA common explicit time-discretization in geophysical fluid dynamics is the leapfrog scheme. For a time step $\\Delta t$ (in seconds), the leapfrog update for the scalar equation is\n$$\nz^{n+1} = z^{n-1} + 2\\, \\Delta t\\, i\\, f\\, z^{n},\n$$\nwhere $z^{n}$ approximates $z(n \\Delta t)$. The leapfrog method is known to be second-order accurate in time for smooth solutions, but it admits a decoupled computational mode. A widespread stabilization is the Robert–Asselin time filter (RA filter), defined by the smoothing operation\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right),\n$$\nwhere $\\alpha$ is a dimensionless filter parameter. The RA filter suppresses the computational mode but may alter the formal order of accuracy of the physical mode depending on the scaling of $\\alpha$ with $\\Delta t$.\n\nYour task is to design and implement a numerical test to measure the observed order of accuracy of the leapfrog scheme with the RA filter for the smooth exact solution $z(t) = e^{i f t}$ under different scalings of $\\alpha$. Start from the fundamental base given above (the inertial oscillation and the leapfrog scheme), and construct a procedure to:\n\n1. Integrate one inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ using the leapfrog scheme with the RA filter applied at every interior time level.\n2. Initialize using the exact values $z^{0} = 1$ and $z^{1} = e^{i f \\Delta t}$ so that the starting procedure does not contaminate the asymptotic accuracy measurement.\n3. For a sequence of time step sizes $\\Delta t_{k} = \\frac{T_{\\mathrm{I}}}{N_{k}}$ with $N_{k} \\in \\{32, 64, 128, 256\\}$, compute the numerical solution $z^{N_{k}}$ at $t = T_{\\mathrm{I}}$ and the absolute error $E(\\Delta t_{k}) = \\left| z^{N_{k}} - e^{i f T_{\\mathrm{I}}} \\right|$, which is unitless.\n4. Estimate the observed order of accuracy $p$ by fitting a straight line to $(\\log(\\Delta t_{k}), \\log(E(\\Delta t_{k})))$ and taking the slope $p$ (since a method of order $p$ satisfies $E(\\Delta t) \\approx C\\, \\Delta t^{p}$ for small $\\Delta t$).\n\nPerform the above test under the following three cases:\n\n- Case A (no filter): $\\alpha = 0$.\n- Case B (constant RA filter): $\\alpha = 0.05$.\n- Case C (quadratic scaling): $\\alpha = \\kappa\\, \\Delta t^{2}$ with $\\kappa = \\dfrac{0.05}{T_{\\mathrm{I}}^{2}}$ so that $\\alpha$ decreases as $\\Delta t^{2}$.\n\nUse $f = 10^{-4}\\ \\mathrm{s}^{-1}$ and integrate exactly one inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ seconds. Angles are measured in radians implicitly through $e^{i f t}$, but no angle unit need be output. The error is a float with no physical unit. The final reported observed orders $p$ are unitless floats.\n\nYour program should compute the three observed orders $p$ corresponding to the above cases and produce a single line of output containing the three values, in the order [Case A, Case B, Case C], as a comma-separated list enclosed in square brackets, rounded to three decimal places (for example, \"[2.001,0.998,2.000]\").\n\nTest suite and coverage:\n\n- Happy path: Case A (no filter) should demonstrate second-order convergence for the leapfrog method.\n- Significant modification: Case B (constant $\\alpha$) is expected to alter the observed order.\n- Scaling edge: Case C ($\\alpha \\propto \\Delta t^{2}$) is expected to recover higher-order behavior consistent with the leapfrog core.\n\nYour implementation must be a complete, runnable program that performs these experiments and outputs the required single-line format. All computations should be carried out in seconds for time and with $f$ in $\\mathrm{s}^{-1}$. The only numerical inputs to the test are the prescribed $f$, the set $\\{N_{k}\\}$, and the scalings of $\\alpha$ defined above. The outputs are three floats estimated from the log–log slope.",
            "solution": "The inertial oscillation equations are a canonical base for testing temporal accuracy because they produce smooth sinusoidal solutions and isolate the effect of time discretization. Starting from the horizontal momentum equations under the Coriolis force,\n$$\n\\frac{d u}{d t} = f\\, v, \\qquad \\frac{d v}{d t} = -f\\, u,\n$$\none obtains the scalar complex ordinary differential equation via $z = u + i v$,\n$$\n\\frac{d z}{d t} = i\\, f\\, z, \\quad z(t) = z(0)\\, e^{i f t}.\n$$\nThis exact solution is smooth and periodic with inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$.\n\nThe leapfrog method is derived by approximating the time derivative at $t^{n}$ by a centered difference,\n$$\n\\left.\\frac{d z}{d t}\\right|_{t^{n}} \\approx \\frac{z^{n+1} - z^{n-1}}{2 \\Delta t},\n$$\nand setting it equal to the right-hand side $i f z^{n}$. This yields\n$$\nz^{n+1} = z^{n-1} + 2\\, \\Delta t\\, i\\, f\\, z^{n}.\n$$\nA Taylor series expansion of the exact solution shows that the local truncation error of leapfrog is $O(\\Delta t^{3})$, and the global error is $O(\\Delta t^{2})$ for sufficiently smooth $z(t)$. However, leapfrog admits a computational mode associated with the decoupling of even and odd time levels, which can pollute solutions in practical settings.\n\nTo suppress the computational mode, the Robert–Asselin time filter applies a smoothing operation to the current time level after computing $z^{n+1}$:\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right).\n$$\nThe term in parentheses is the second time-difference, which, by Taylor expansion of $z^{n\\pm 1}$ around $t^{n}$, satisfies\n$$\nz^{n-1} - 2 z^{n} + z^{n+1} = \\Delta t^{2}\\, \\frac{d^{2} z}{d t^{2}}(t^{n}) + \\frac{\\Delta t^{4}}{12}\\, \\frac{d^{4} z}{d t^{4}}(t^{n}) + O(\\Delta t^{6}).\n$$\nIf this smoothing were applied to a continuous solution once, its leading-order change would appear to be $O(\\alpha\\, \\Delta t^{2})$. However, in the discrete multistep context, the RA filter perturbs the time-centering property of leapfrog because it updates $z^{n}$ using $z^{n+1}$, breaking the strict symmetry of the two-time-level stencil. A modified equation analysis for the combined leapfrog-plus-filter method reveals that the physical mode acquires a leading error term proportional to $\\alpha$ times lower-order time derivatives, and the cumulative effect of applying the filter at every time level over an $O(1)$ time interval produces a global error scaling as $O(\\Delta t)$ when $\\alpha$ is held constant. Therefore:\n- With $\\alpha = 0$, the method is the standard leapfrog scheme, which is second-order accurate.\n- With $\\alpha$ constant (for example, $\\alpha = 0.05$), the filter introduces a persistent asymmetry each step, and the global error typically scales as $O(\\Delta t)$, so the observed order is approximately one.\n- If $\\alpha$ is scaled to decay sufficiently rapidly with $\\Delta t$, the filter’s perturbation becomes higher-order. A commonly cited sufficient scaling is $\\alpha = O(\\Delta t^{2})$, for which the additive perturbation at each step is $O(\\Delta t^{4})$, and the cumulative global error over $O(\\Delta t^{-1})$ steps remains $O(\\Delta t^{3})$ at leading order. In this case, the core second-order behavior of leapfrog is recovered in the observed global error.\n\nBased on these principles, we design the numerical test as follows. We set $f = 10^{-4}\\ \\mathrm{s}^{-1}$ and integrate exactly one inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ seconds. To ensure coverage and asymptotic behavior, we choose numbers of steps $N \\in \\{32, 64, 128, 256\\}$ and corresponding time steps $\\Delta t = T_{\\mathrm{I}}/N$. For each $\\Delta t$, we initialize $z^{0} = 1$ and $z^{1} = e^{i f \\Delta t}$ from the exact solution to avoid startup errors. Then we iterate for $n = 1, 2, \\dots, N-1$:\n1. Compute the leapfrog update $z^{n+1} = z^{n-1} + 2\\, \\Delta t\\, i\\, f\\, z^{n}$.\n2. Apply the RA filter to $z^{n}$ using the prescribed $\\alpha$ scaling for the case under consideration:\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right).\n$$\nWe do not filter $z^{0}$ or $z^{N}$.\n\nAfter $N$ steps, we compute the error $E(\\Delta t) = \\left| z^{N} - e^{i f T_{\\mathrm{I}}} \\right|$. Since $e^{i f T_{\\mathrm{I}}} = e^{i 2\\pi} = 1$, this reduces to $E(\\Delta t) = \\left| z^{N} - 1 \\right|$. For each case (no filter, constant $\\alpha = 0.05$, and quadratic scaling $\\alpha = \\kappa \\Delta t^{2}$ with $\\kappa = \\frac{0.05}{T_{\\mathrm{I}}^{2}}$), we compute $E(\\Delta t)$ for the four $\\Delta t$ values and estimate the observed order $p$ by least-squares fitting of a straight line to the pairs $(\\log(\\Delta t), \\log(E(\\Delta t)))$. If $E(\\Delta t) \\approx C\\, \\Delta t^{p}$, then $\\log(E(\\Delta t)) \\approx \\log C + p \\log(\\Delta t)$, so the slope $p$ is the observed order.\n\nThe expected outcomes, grounded in the above analysis, are:\n- Case A ($\\alpha = 0$): $p \\approx 2$ (second order).\n- Case B ($\\alpha = 0.05$): $p \\approx 1$ (first order due to persistent filter asymmetry).\n- Case C ($\\alpha = \\kappa \\Delta t^{2}$): $p \\approx 2$ (second order recovered because the filter perturbation vanishes quadratically with $\\Delta t$).\n\nThe algorithmic implementation follows these steps, and the final program outputs a single line containing three floats corresponding to the observed $p$ values for the three cases, rounded to three decimal places and enclosed in square brackets, as required. All variables with physical units are specified in seconds or inverse seconds, and the outputs are unitless floats.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef inertial_period(f):\n    return 2.0 * np.pi / f\n\ndef exact_solution(f, t):\n    # z(t) = exp(i f t)\n    return np.exp(1j * f * t)\n\ndef leapfrog_ra_integrate(f, dt, N, alpha_mode, T_I):\n    \"\"\"\n    Integrate z' = i f z over N steps of size dt using leapfrog and RA filter.\n    alpha_mode: 'none', 'const', or 'quad'\n    \"\"\"\n    # Determine alpha for this dt\n    if alpha_mode == 'none':\n        alpha = 0.0\n    elif alpha_mode == 'const':\n        alpha = 0.05\n    elif alpha_mode == 'quad':\n        # alpha = k * dt^2, with k = 0.05 / T_I^2 to keep scale comparable\n        alpha = 0.05 * (dt**2) / (T_I**2)\n    else:\n        raise ValueError(\"Unknown alpha_mode\")\n\n    # Initialize with exact values\n    z_prev = exact_solution(f, 0.0)                 # z^0\n    z_curr = exact_solution(f, dt)                  # z^1\n\n    # Time stepping\n    for n in range(1, N):\n        # Leapfrog update to get z^{n+1}\n        z_next = z_prev + 2.0 * dt * 1j * f * z_curr\n        # Apply RA filter to z^n (current)\n        # z^n - z^n + alpha (z^{n-1} - 2 z^n + z^{n+1})\n        z_curr = z_curr + alpha * (z_prev - 2.0 * z_curr + z_next)\n        # Shift for next iteration: (n+1) becomes current, filtered z^n becomes previous\n        z_prev, z_curr = z_curr, z_next\n\n    # After N steps, z_curr is z^N (unfiltered at final level)\n    return z_curr\n\ndef observed_order(log_dt, log_err):\n    # Fit log(err) = a + p * log(dt); return p\n    # Use least squares linear fit\n    p, a = np.polyfit(log_dt, log_err, 1)\n    return p\n\ndef solve():\n    # Define the test cases from the problem statement.\n    f = 1e-4  # s^-1\n    T_I = inertial_period(f)  # seconds, one inertial period\n\n    # Numbers of steps for dt = T_I / N\n    N_list = [32, 64, 128, 256]\n\n    # Alpha modes to test: Case A, Case B, Case C\n    alpha_modes = ['none', 'const', 'quad']\n\n    results = []\n    for mode in alpha_modes:\n        dt_list = []\n        err_list = []\n        for N in N_list:\n            dt = T_I / N\n            zN = leapfrog_ra_integrate(f, dt, N, mode, T_I)\n            # Exact at T_I is exp(i f T_I) = exp(i 2 pi) = 1\n            exact_T = 1.0 + 0.0j\n            err = abs(zN - exact_T)\n            dt_list.append(dt)\n            err_list.append(err)\n\n        # Compute observed order via log-log slope\n        log_dt = np.log(np.array(dt_list))\n        log_err = np.log(np.array(err_list))\n        p = observed_order(log_dt, log_err)\n        results.append(p)\n\n    # Final print statement in the exact required format: three values rounded to three decimals\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}