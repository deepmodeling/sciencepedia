{
    "hands_on_practices": [
        {
            "introduction": "在数值海洋模型中，一个基本的设计问题是如何确定海绵层的适当尺寸。本练习通过计算系统中最快波（外重力波）的传播速度，为海绵层设定一个最小宽度。这确保了任何来自数值边界的不可避免的反射都会被延迟，从而防止它们污染感兴趣区域的模拟结果。此实践将系统的物理特性与数值模型的配置直接联系起来 。",
            "id": "3809295",
            "problem": "一个正压（深度无关）外模的海洋模型被配置在一个一维水平维度上，矩形域的长度为 $L=1000\\,\\mathrm{km}$，两端各有一个开放边界。未扰动深度为 $H=4000\\,\\mathrm{m}$，重力加速度为 $g=9.81\\,\\mathrm{m\\,s^{-2}}$。开放边界强制实施 Orlanski 类型的单向波辐射边界条件 (RBC)，并且在每个开放边界的内侧邻近施加一个宽度为 $W$ 的瑞利阻尼海绵层。\n\n从外模的线性化一维浅水方程出发，并使用关于占主导地位、最快的正压重力波信号的科学上可辩护的假设，完成以下任务：\n\n1. 推导外重力波的适当传播速度，并用它计算从区域中心到最近开放边界的最短传播时间。\n\n2. 对海绵层施加以下要求：为使任何残余的边界反射与内部动力学在时间上分离，源于海绵层内缘的最坏情况下的虚假反射必须比其生成时间晚至少 $\\Delta T_{\\mathrm{sep}}=1\\,\\mathrm{hour}$ 才返回到内部。利用因果关系和外模的非色散传播，推导出满足此分离要求的最小海绵层宽度 $W_{\\min}$ 的下界。\n\n将传播时间以秒为单位表示，最小海绵层宽度以公里为单位表示。将两个量都四舍五入到四位有效数字。只提供最终的数值答案；所有推理和中间步骤必须出现在您的解题过程中。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观且自洽的。这是计算海洋学中的一个标准问题。我们开始解题。\n\n问题要求计算与一维海洋模型中正压重力波传播相关的两个量。我们首先分析控制方程。\n\n未扰动深度为 $H$ 的流体的线性化一维浅水方程由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} = -g \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} = -H \\frac{\\partial u}{\\partial x}\n$$\n其中 $u(x, t)$ 是深度无关的水平速度，$\\eta(x, t)$ 是海面高程异常， $g$ 是重力加速度，在这个一维设置中忽略了科里奥利效应。\n\n为了找到由该系统控制的波的传播速度，我们将这两个方程组合成一个单一的波动方程。我们将第一个方程对 $x$ 求导，第二个方程对 $t$ 求导：\n$$\n\\frac{\\partial^2 u}{\\partial x \\partial t} = -g \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = -H \\frac{\\partial^2 u}{\\partial t \\partial x}\n$$\n将第二个方程的时间导数中的项 $\\frac{\\partial^2 u}{\\partial t \\partial x}$ 代入第一个方程的空间导数中，我们得到：\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = gH \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\n这是形式为 $\\frac{\\partial^2 y}{\\partial t^2} = c^2 \\frac{\\partial^2 y}{\\partial x^2}$ 的经典一维波动方程。通过比较，正压重力波的相速度 $c$ 是：\n$$\nc = \\sqrt{gH}\n$$\n这个速度是恒定的，不依赖于波长，这与问题中关于最快的、占主导地位的外模的非色散传播的假设是一致的。\n\n已知条件是：\n- 重力加速度, $g = 9.81 \\, \\mathrm{m \\, s^{-2}}$\n- 未扰动深度, $H = 4000 \\, \\mathrm{m}$\n- 区域长度, $L = 1000 \\, \\mathrm{km} = 10^6 \\, \\mathrm{m}$\n\n首先，我们计算波传播速度 $c$ 的数值：\n$$\nc = \\sqrt{9.81 \\, \\mathrm{m \\, s^{-2}} \\times 4000 \\, \\mathrm{m}} = \\sqrt{39240} \\, \\mathrm{m \\, s^{-1}} \\approx 198.0909 \\, \\mathrm{m \\, s^{-1}}\n$$\n\n**第1部分：从区域中心到最近边界的传播时间**\n\n该区域的长度为 $L$。区域中心距离两端的距离为 $\\frac{L}{2}$，开放边界就位于这两端。从中心到最近边界的最短传播时间 $T_{\\mathrm{travel}}$ 是此距离除以传播速度 $c$。\n\n到边界的距离, $d = \\frac{L}{2} = \\frac{1000 \\, \\mathrm{km}}{2} = 500 \\, \\mathrm{km} = 5 \\times 10^5 \\, \\mathrm{m}$。\n\n因此，传播时间 $T_{\\mathrm{travel}}$ 为：\n$$\nT_{\\mathrm{travel}} = \\frac{d}{c} = \\frac{L/2}{\\sqrt{gH}}\n$$\n代入数值：\n$$\nT_{\\mathrm{travel}} = \\frac{5 \\times 10^5 \\, \\mathrm{m}}{\\sqrt{39240} \\, \\mathrm{m \\, s^{-1}}} \\approx \\frac{5 \\times 10^5}{198.0909} \\, \\mathrm{s} \\approx 2524.093 \\, \\mathrm{s}\n$$\n四舍五入到四位有效数字，传播时间为 $2524 \\, \\mathrm{s}$。\n\n**第2部分：最小海绵层宽度 $W_{\\min}$**\n\n问题的第二部分涉及海绵层的设计。一个从区域内部传播的波到达海绵层的内缘。然后，这个波穿过宽度为 $W$ 的海绵层，由于辐射边界条件的不完美性而从开放边界反射，再穿过海绵层返回，重新进入内部区域。问题要求这次往返行程所花费的时间至少为 $\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour}$。这确保了任何虚假的边界反射与区域内部的动力学在时间上是分离的。\n\n我们将“生成时间”定义为出射波穿过内部区域和海绵层之间交界面的时刻。波行进距离 $W$ 到达开放边界，反射，再行进距离 $W$ 返回。在海绵层内的这个往返行程的总路径长度是 $2W$。\n\n这个往返行程所用的时间 $\\Delta T_{\\mathrm{roundtrip}}$ 是总行进距离除以波速 $c$：\n$$\n\\Delta T_{\\mathrm{roundtrip}} = \\frac{2W}{c}\n$$\n问题施加了要求，即这个时间延迟至少为 $\\Delta T_{\\mathrm{sep}}$：\n$$\n\\frac{2W}{c} \\ge \\Delta T_{\\mathrm{sep}}\n$$\n我们可以解这个不等式，求得最小海绵层宽度 $W_{\\min}$。当等式成立时，达到下界：\n$$\nW_{\\min} = \\frac{c \\cdot \\Delta T_{\\mathrm{sep}}}{2}\n$$\n给定 $\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour}$，为了与 $c$ 的单位保持一致，必须将其转换为秒：\n$$\n\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour} \\times \\frac{60 \\, \\mathrm{min}}{1 \\, \\mathrm{hour}} \\times \\frac{60 \\, \\mathrm{s}}{1 \\, \\mathrm{min}} = 3600 \\, \\mathrm{s}\n$$\n现在我们可以代入 $c$ 和 $\\Delta T_{\\mathrm{sep}}$ 的数值：\n$$\nW_{\\min} = \\frac{(\\sqrt{39240} \\, \\mathrm{m \\, s^{-1}}) \\times 3600 \\, \\mathrm{s}}{2} \\approx \\frac{198.0909 \\, \\mathrm{m \\, s^{-1}} \\times 3600 \\, \\mathrm{s}}{2} \\approx 356563.6 \\, \\mathrm{m}\n$$\n问题要求答案以公里为单位。我们将米转换为公里：\n$$\nW_{\\min} \\approx 356.5636 \\, \\mathrm{km}\n$$\n四舍五入到四位有效数字，所需的最小海绵层宽度为 $356.6 \\, \\mathrm{km}$。\n\n最终答案是 $T_{\\mathrm{travel}} \\approx 2524 \\, \\mathrm{s}$ 和 $W_{\\min} \\approx 356.6 \\, \\mathrm{km}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2524  356.6 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "确定海绵层的物理尺寸后，下一步是其数值实现。本练习探讨了用于表示海绵层的数值方案的稳定性，特别是在使用显式时间步进时。它展示了松弛（阻尼）项如何与平流项相互作用，从而产生一个耦合的稳定性约束，该约束将阻尼系数、时间步长和平流Courant-Friedrichs-Lewy（CFL）数联系起来。理解这一约束对于防止数值振荡并确保模拟的稳定和物理真实性至关重要 。",
            "id": "3809236",
            "problem": "考虑一个一维、深度平均的示踪剂 $q(x,t)$，它以恒定的正压速度 $U>0$ 平流向位于 $x=0$ 处的开放海洋边界。为了最小化与辐射边界条件一致的反射，在 $0 \\le x \\le L_s$ 的区域应用了一个宽度为 $L_s$ 的海绵层，该海绵层通过牛顿弛豫将 $q$ 弛豫至一个给定的目标廓线 $q^\\ast(x)$。弛豫系数为 $\\alpha>0$，在海绵层内是均匀的。海绵层内的控制方程为\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha\\left(q - q^\\ast\\right).\n$$\n设网格是均匀的，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。平流项使用针对 $U>0$ 的一阶上游（迎风）差分进行离散化，而弛豫项则用显式欧拉法处理。定义平流 Courant-Friedrichs-Lewy (CFL) 数 $\\mu = U \\Delta t / \\Delta x$。假设 $q^\\ast$ 足够光滑，以至于为了进行局部稳定性分析，其在单个网格单元上的空间变化可以忽略。分析弛豫误差 $e_j^n = q_j^n - q_j^\\ast$ 的离散演化。\n\n从带源项的守恒律和给定的离散化方法出发，推导出 $e_j^n$ 的单步更新式，并用它来推断显式弛豫如何与上游平流相互作用以在网格尺度上产生过冲或数值振荡。然后，基于单调性和线性稳定性的基本原理，确定一个关联 $\\alpha$、$\\Delta t$ 和 $\\mu$ 的耦合约束，以确保更新在海绵层中既稳定又非振荡。下列哪个陈述最好地描述了正确的机制和耦合约束？\n\nA. 当 $e_j^n$ 的局部权重变为负值时，即当 $1 - \\mu - \\alpha \\Delta t  0$ 时，会出现过冲和时间上的网格尺度振荡。对于显式上游-弛豫更新，一个充分的非振荡稳定性条件是 $0 \\le \\mu \\le 1$ 以及 $0 \\le \\alpha \\Delta t \\le 1 - \\mu$，这保证了更新是 $e_j^n$ 和 $e_{j-1}^n$ 的带有净阻尼的凸组合。\n\nB. 无论平流 CFL 数是多少，弛豫总是能稳定上游平流，因此不会发生过冲。唯一的要求是 $0 \\le \\mu \\le 1$；$\\alpha \\Delta t$ 可以任意大，而无需与 $\\mu$ 耦合。\n\nC. 更强的平流总是能抑制由弛豫引起的振荡，从而得到稳定性条件 $\\alpha \\Delta t \\le \\mu$，且无需对 $\\mu$ 施加超出 $\\mu \\le 2$ 的任何上限。\n\nD. 正确的耦合线性稳定性界是 $\\alpha \\Delta t \\le 2(1 - \\mu)$，它保证了当 $0 \\le \\mu \\le 1$ 时所有可解波数的非振荡衰减；此外，在此界限下不会发生网格尺度的过冲。\n\nE. 显式弛豫的稳定性与平流无关；为避免振荡，只需要 $0 \\le \\alpha \\Delta t \\le 2$ 和 $0 \\le \\mu \\le 1$，而 $\\alpha \\Delta t$ 和 $\\mu$ 之间没有进一步的耦合约束。",
            "solution": "用户希望我解决一个计算海洋学中的问题。\n\n### 步骤1：提取已知条件\n- **控制方程（在海绵层中，$0 \\le x \\le L_s$）：** $\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha(q - q^\\ast)$，其中 $U>0$ 且 $\\alpha>0$。\n- **示踪剂：** $q(x,t)$，一个一维、深度平均的示踪剂。\n- **速度：** $U$，一个恒定的正正压速度。\n- **弛豫系数：** $\\alpha$，一个正常数。\n- **目标廓线：** $q^\\ast(x)$，一个给定的廓线。\n- **离散化：**\n    - 网格：均匀，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。\n    - 平流项 ($U \\frac{\\partial q}{\\partial x}$)：对于 $U>0$ 采用一阶上游（迎风）差分。\n    - 时间步进 / 弛豫项 ($-\\alpha(q-q^\\ast)$)：显式欧拉法。\n- **定义：**\n    - 平流 CFL 数：$\\mu = U \\Delta t / \\Delta x$。\n    - 弛豫误差：$e_j^n = q_j^n - q_j^\\ast$。\n- **假设：** $q^\\ast$ 足够光滑，以至于为了进行局部稳定性分析，其在单个网格单元上的空间变化可以忽略。\n\n### 步骤2：使用提取的已知条件进行验证\n依据验证标准对问题陈述进行分析。\n\n- **有科学依据：** 该问题描述了带有牛顿弛豫的海绵层的数值实现，这是计算流体动力学和海洋模拟中实现开放边界条件的一种标准且广泛使用的技术。控制方程是一个线性平流-反应（或阻尼）方程，这是一个基本的模型方程。离散化方法（一阶迎风，显式欧拉）是标准的。该问题在根本上是合理的。\n- **适定性：** 该问题是适定的。它要求为一个特定的、完全定义的数值格式推导稳定性与单调性条件。可以从数值分析的基本原理中推导出唯一的条件。\n- **客观性：** 语言精确、技术性强且没有主观性。所有术语要么是领域内的标准术语（例如，CFL 数、上游差分），要么是明确定义的。\n- **未检测到缺陷：** 该问题没有违反任何无效性标准。它不是科学上不合理、不可形式化、不完整、矛盾、不切实际、不适定或琐碎的。这是偏微分方程数值方法领域一个格式良好的问题。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。解法推导如下。\n\n### 数值格式与稳定性条件的推导\n\n海绵层内的控制偏微分方程（PDE）为：\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha(q - q^\\ast)\n$$\n我们被要求分析弛豫误差 $e(x,t) = q(x,t) - q^\\ast(x)$ 的演化。由于目标廓线 $q^\\ast(x)$ 假设不随时间变化，因此 $\\frac{\\partial q^\\ast}{\\partial t} = 0$。通过将 $q = e + q^\\ast$ 代入控制方程，可以找到误差 $e$ 的偏微分方程：\n$$\n\\frac{\\partial (e + q^\\ast)}{\\partial t} + U \\frac{\\partial (e + q^\\ast)}{\\partial x} = -\\alpha e\n$$\n$$\n\\frac{\\partial e}{\\partial t} + U \\frac{\\partial e}{\\partial x} + U \\frac{\\partial q^\\ast}{\\partial x} = -\\alpha e\n$$\n为了进行局部稳定性分析，问题陈述指出我们可以忽略 $q^\\ast$ 在一个网格单元上的空间变化。这等价于在局部分析中将项 $U \\frac{\\partial q^\\ast}{\\partial x}$ 置为零。误差的简化偏微分方程变为：\n$$\n\\frac{\\partial e}{\\partial t} + U \\frac{\\partial e}{\\partial x} = -\\alpha e\n$$\n现在我们在均匀网格上离散化这个方程，其中 $e_j^n \\approx e(j\\Delta x, n\\Delta t)$。\n- 时间导数 $\\frac{\\partial e}{\\partial t}$ 使用向前（显式）欧拉法离散化为：$\\frac{e_j^{n+1} - e_j^n}{\\Delta t}$。\n- 平流项 $U\\frac{\\partial e}{\\partial x}$ 使用一阶上游差分进行离散化。由于 $U0$，上游方向是朝向较小的 $x$（较小的索引 $j$），因此导数近似为 $U \\frac{e_j^n - e_{j-1}^n}{\\Delta x}$。\n- 弛豫项 $-\\alpha e$ 采用显式处理，在时间层 $n$ 上取值为：$-\\alpha e_j^n$。\n\n将这些离散化形式代入误差的偏微分方程，得到有限差分方程：\n$$\n\\frac{e_j^{n+1} - e_j^n}{\\Delta t} + U \\frac{e_j^n - e_{j-1}^n}{\\Delta x} = -\\alpha e_j^n\n$$\n我们的目标是找到 $e_j^{n+1}$ 的更新规则。我们乘以 $\\Delta t$ 并重新整理：\n$$\ne_j^{n+1} - e_j^n = -\\Delta t \\left( U \\frac{e_j^n - e_{j-1}^n}{\\Delta x} \\right) - \\alpha \\Delta t e_j^n\n$$\n$$\ne_j^{n+1} = e_j^n - \\frac{U \\Delta t}{\\Delta x} (e_j^n - e_{j-1}^n) - \\alpha \\Delta t e_j^n\n$$\n使用 CFL 数的定义，$\\mu = \\frac{U \\Delta t}{\\Delta x}$：\n$$\ne_j^{n+1} = e_j^n - \\mu (e_j^n - e_{j-1}^n) - \\alpha \\Delta t e_j^n\n$$\n将时间层 $n$ 上的项按其空间索引分组：\n$$\ne_j^{n+1} = (1 - \\mu - \\alpha \\Delta t) e_j^n + \\mu e_{j-1}^n\n$$\n这就是误差的单步更新方程。\n\n为了确保更新是非振荡的（即，它不会产生新的局部极大值或极小值），该格式必须是单调的。对于这种形式的线性格式，一个使其单调的充分条件是时间层 $n$ 上所有项的系数都是非负的。\n这些系数是 $(1 - \\mu - \\alpha \\Delta t)$ 和 $\\mu$。\n\n1.  **$e_{j-1}^n$ 的系数：** 我们要求 $\\mu \\ge 0$。由于 $U  0$、$\\Delta t  0$ 和 $\\Delta x  0$，这个条件是内在地满足的。\n2.  **$e_j^n$ 的系数：** 我们要求 $1 - \\mu - \\alpha \\Delta t \\ge 0$。\n\n第二个条件给出了耦合约束：\n$$\n\\alpha \\Delta t \\le 1 - \\mu\n$$\n从这个不等式中，我们可以推断出另一个约束。由于 $\\alpha  0$ 且 $\\Delta t  0$，左手边的 $\\alpha \\Delta t$ 是正的。因此，右手边必须是非负的：\n$$\n1 - \\mu \\ge 0 \\implies \\mu \\le 1\n$$\n这恢复了纯平流问题中一阶迎风格式的标准 Courant-Friedrichs-Lewy (CFL) 稳定性条件。\n\n因此，确保更新稳定且非振荡（单调）的组合约束集是：\n$$\n0 \\le \\mu \\le 1 \\quad \\text{and} \\quad 0 \\le \\alpha \\Delta t \\le 1 - \\mu\n$$\n当满足这些条件时，$e_j^{n+1}$ 的更新是 $e_j^n$ 和 $e_{j-1}^n$ 的一个线性组合，其非负权重之和为 $ (1 - \\mu - \\alpha \\Delta t) + \\mu = 1 - \\alpha \\Delta t$。由于 $0 \\le \\alpha \\Delta t \\le 1-\\mu \\le 1$，和在 0 和 1 之间，表明这是一个阻尼的、非振荡的更新。过冲或下冲（数值振荡）恰好在 $e_j^n$ 的系数变为负值时发生，即 $1 - \\mu - \\alpha \\Delta t  0$，这允许在解中本不应出现符号改变的地方出现符号改变。\n\n### 选项评估\n\n**A. 过冲和时间上的网格尺度振荡在 $e_j^n$ 的局部权重变为负值时出现，即当 $1 - \\mu - \\alpha \\Delta t  0$ 时。显式上游-弛豫更新的一个充分非振荡稳定性条件是 $0 \\le \\mu \\le 1$ 以及 $0 \\le \\alpha \\Delta t \\le 1 - \\mu$，这保证了更新是 $e_j^n$ 和 $e_{j-1}^n$ 的带有净阻尼的凸组合。**\n- 该陈述准确地指出了当 $e_j^n$ 的系数变为负值时会产生振荡。推导出的更新方程是 $e_j^{n+1} = (1 - \\mu - \\alpha \\Delta t) e_j^n + \\mu e_{j-1}^n$，所以系数确实是 $1 - \\mu - \\alpha \\Delta t$。\n- 所述条件 $0 \\le \\mu \\le 1$ 和 $0 \\le \\alpha \\Delta t \\le 1 - \\mu$ 正是两个系数非负的条件，这确保了格式是单调、非振荡的。这个条件也保证了稳定性。\n- 将更新描述为“带有净阻尼的凸组合”在物理上和数学上都是合理的。\n- 权重是非负的，它们的和是 $1 - \\alpha \\Delta t \\le 1$，这对应于一个凸组合后跟一个阻尼过程。\n- **结论：正确。**\n\n**B. 无论平流 CFL 数是多少，弛豫总是能稳定上游平流，因此不会发生过冲。唯一的要求是 $0 \\le \\mu \\le 1$；$\\alpha \\Delta t$ 可以任意大，而无需与 $\\mu$ 耦合。**\n- 这是不正确的。推导显示 $\\alpha \\Delta t$ 和 $\\mu$ 通过约束 $\\alpha \\Delta t \\le 1 - \\mu$ 直接耦合。如果 $\\alpha \\Delta t$太大（例如，$\\alpha \\Delta t > 1 - \\mu$），$e_j^n$ 的系数会变为负值，导致振荡。\n- **结论：不正确。**\n\n**C. 更强的平流总是能抑制由弛豫引起的振荡，从而得到稳定性条件 $\\alpha \\Delta t \\le \\mu$，且无需对 $\\mu$ 施加超出 $\\mu \\le 2$ 的任何上限。**\n- 这是不正确的。推导出的条件是 $\\alpha \\Delta t \\le 1 - \\mu$。更强的平流（更大的 $\\mu$）使右侧更小，从而*收紧*了对 $\\alpha \\Delta t$ 的约束，而不是抑制振荡。条件 $\\alpha \\Delta t \\le \\mu$ 是不正确的。此外，一阶迎风格式在 $\\mu > 1$ 时是不稳定的；提及 $\\mu \\le 2$ 在此无关。\n- **结论：不正确。**\n\n**D. 正确的耦合线性稳定性界是 $\\alpha \\Delta t \\le 2(1 - \\mu)$，它保证了当 $0 \\le \\mu \\le 1$ 时所有可解波数的非振荡衰减；此外，在此界限下不会发生网格尺度的过冲。**\n- von Neumann 稳定性分析表明，线性稳定性的一般条件（$|G| \\le 1$）确实是对于 $0 \\le \\mu \\le 1$ 的 $\\alpha \\Delta t \\le 2(1 - \\mu)$。然而，区域 $1 - \\mu  \\alpha \\Delta t \\le 2(1 - \\mu)$ 是稳定但*振荡*的。问题明确要求一个“稳定且非振荡”的条件。非振荡行为（单调性）的条件是更严格的 $\\alpha \\Delta t \\le 1 - \\mu$。因此，声称 $\\alpha \\Delta t \\le 2(1 - \\mu)$ “保证非振荡衰减”是错误的。\n- **结论：不正确。**\n\n**E. 显式弛豫的稳定性与平流无关；为避免振荡，只需要 $0 \\le \\alpha \\Delta t \\le 2$ 和 $0 \\le \\mu \\le 1$，而 $\\alpha \\Delta t$ 和 $\\mu$ 之间没有进一步的耦合约束。**\n- 这是不正确的。推导明确建立了耦合条件 $\\alpha \\Delta t \\le 1 - \\mu$。组合系统的稳定性不仅仅是单个分量（平流和弛豫）稳定性区域的交集。这些项是相互作用的。条件 $\\alpha \\Delta t \\le 2$ 是纯弛豫的稳定性极限，但在存在平流时是不够的。\n- **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "处理开放边界的最后一步是验证其性能。本练习介绍了一种严谨的方法，通过分析模型的输出数据来诊断辐射边界条件在防止波反射方面的效果。利用特征分解，我们可以将边界处的波场分离为入射和出射分量，并计算反射系数。这个诊断工具对于验证模型配置和量化所选开放边界策略的有效性非常有价值 。",
            "id": "3809230",
            "problem": "考虑一个正压、静水、Boussinesq、密度恒定的海洋，其深度为常数 $H$，重力加速度为 $g$。该海洋由线性化的一维浅水方程（SWE）建模，沿一条笔直的开放边界，其向外的单位法线指向正 $x$ 方向。在边界 $x=L$ 处，您有同步的深度平均法向速度 $u(t)$ 和自由表面高程 $\\eta(t)$ 的时间序列。在开放边界处定义一个反射系数 $R$，其为入射与出射的深度积分波能通量大小之比，该比值在一个时间窗口内平均，该时间窗口与主波周期相比足够长，但与任何缓慢调制相比足够短。严格从控制方程及其所蕴含的机械能平衡出发，并假设线性波叠加，且在平均窗口内反向传播分量之间的相关性可忽略不计，哪个选项最佳地指定了 $R$ 并给出了一个仅使用边界时间序列 $(\\eta(t),u(t))$ 的一致且可实现的估计量？\n\nA. 计算 $c=\\sqrt{gH}$。在边界处形成特征分解\n$$\\eta_{\\text{out}}(t)=\\dfrac{\\eta(t)+\\dfrac{H}{c}u(t)}{2},\\quad \\eta_{\\text{in}}(t)=\\dfrac{\\eta(t)-\\dfrac{H}{c}u(t)}{2},$$\n并估计\n$$R=\\dfrac{\\langle \\eta_{\\text{in}}(t)^2\\rangle}{\\langle \\eta_{\\text{out}}(t)^2\\rangle},$$\n其中 $\\langle\\cdot\\rangle$ 表示时间平均。这等于入射与出射的深度积分能量通量大小之比，因为每个通量都是 $\\rho g c$ 乘以相应的均方特征高程。\n\nB. 从主频率下的振幅比估计 $R$，\n$$R=\\left|\\dfrac{\\widehat{\\eta}(\\omega_0)}{\\widehat{u}(\\omega_0)}\\right|,$$\n其中 $\\widehat{\\cdot}$ 表示傅里叶变换，$\\omega_0$ 是峰值频率。\n\nC. 将 $R$ 估计为一个归一化的能量通量代理，\n$$R=\\dfrac{\\langle \\eta(t)u(t)\\rangle}{\\langle \\eta(t)^2\\rangle},$$\n理由是分子测量净能量输运，分母与波能成比例。\n\nD. 使用未经方向分离的能量密度，\n$$R=\\dfrac{\\left\\langle \\dfrac{1}{2}g\\,\\eta(t)^2+\\dfrac{1}{2}H\\,u(t)^2\\right\\rangle_{\\text{incoming}}}{\\left\\langle \\dfrac{1}{2}g\\,\\eta(t)^2+\\dfrac{1}{2}H\\,u(t)^2\\right\\rangle_{\\text{outgoing}}},$$\n并通过边界处 $u(t)$ 的符号来指定入射与出射。\n\nE. 计算 $c=\\sqrt{gH}$ 并定义\n$$\\eta_{\\text{out}}(t)=\\dfrac{\\eta(t)-\\dfrac{H}{c}u(t)}{2},\\quad \\eta_{\\text{in}}(t)=\\dfrac{\\eta(t)+\\dfrac{H}{c}u(t)}{2},$$\n然后估计\n$$R=\\dfrac{\\langle \\eta_{\\text{in}}(t)^2\\rangle}{\\langle \\eta_{\\text{out}}(t)^2\\rangle}.$$",
            "solution": "从静水和 Boussinesq 假设下，深度为常数 $H$、密度为常数 $\\rho$ 的线性化一维浅水方程（SWE）开始：\n$$\\eta_t + H u_x = 0,\\qquad u_t + g \\eta_x = 0.$$\n为获得机械能平衡，将动量方程乘以 $\\rho H u$，将连续性方程乘以 $\\rho g \\eta$，然后相加：\n$$\\rho H u\\,u_t + \\rho g \\eta\\,\\eta_t + \\rho g H \\eta\\,u_x = 0.$$\n识别出全时间导数和散度项：\n$$\\frac{\\partial}{\\partial t}\\left(\\frac{\\rho H}{2}u^2 + \\frac{\\rho g}{2}\\eta^2\\right) + \\frac{\\partial}{\\partial x}\\left(\\rho g H \\eta u\\right) = 0.$$\n因此，深度积分的波能密度为\n$$\\mathcal{E} = \\frac{\\rho H}{2}u^2 + \\frac{\\rho g}{2}\\eta^2,$$\n而相应的沿 $+x$ 方向的深度积分能量通量为\n$$\\mathcal{F} = \\rho g H \\eta u.$$\n在向外法线指向 $+x$ 方向的边界处，离开区域的能量具有 $\\mathcal{F}>0$（出射），进入区域的能量具有 $\\mathcal{F}0$（入射）。\n\n接下来，使用特征形式将边值信号分解为反向传播的浅水波。定义重力波速 $c=\\sqrt{gH}$。浅水方程允许黎曼不变量\n$$r_{\\pm} = u \\pm \\frac{c}{H}\\eta,$$\n它们分别以速度 $\\mp c$ 和 $+c$ 平流。一个向右传播（出射，朝向 $+x$）的线性浅水波满足 $u = \\frac{c}{H}\\eta$，而一个向左传播（入射，朝向 $-x$）的波满足 $u = -\\frac{c}{H}\\eta$。令 $\\eta_{\\text{out}}$ 和 $\\eta_{\\text{in}}$ 分别表示与出射波和入射波相关的自由表面分量，因此\n$$\\eta = \\eta_{\\text{out}} + \\eta_{\\text{in}},\\qquad u = \\frac{c}{H}\\eta_{\\text{out}} - \\frac{c}{H}\\eta_{\\text{in}}.$$\n根据测量的 $\\eta$ 和 $u$ 求解 $\\eta_{\\text{out}}$ 和 $\\eta_{\\text{in}}$ 可得\n$$\\eta_{\\text{out}} = \\frac{1}{2}\\left(\\eta + \\frac{H}{c}u\\right),\\qquad \\eta_{\\text{in}} = \\frac{1}{2}\\left(\\eta - \\frac{H}{c}u\\right).$$\n相应的速度为\n$$u_{\\text{out}} = \\frac{c}{H}\\eta_{\\text{out}},\\qquad u_{\\text{in}} = -\\frac{c}{H}\\eta_{\\text{in}}.$$\n将这些代入通量表达式中，以将能量通量分离为方向分量。由出射分量引起的瞬时通量为\n$$\\mathcal{F}_{\\text{out}} = \\rho g H \\,\\eta_{\\text{out}}\\,u_{\\text{out}} = \\rho g H \\,\\eta_{\\text{out}}\\,\\frac{c}{H}\\eta_{\\text{out}} = \\rho g c\\,\\eta_{\\text{out}}^2 \\ge 0,$$\n而入射分量为\n$$\\mathcal{F}_{\\text{in}} = \\rho g H \\,\\eta_{\\text{in}}\\,u_{\\text{in}} = \\rho g H \\,\\eta_{\\text{in}}\\left(-\\frac{c}{H}\\eta_{\\text{in}}\\right) = -\\rho g c\\,\\eta_{\\text{in}}^2 \\le 0.$$\n对于一个远长于波周期的窗口进行时间平均 $\\langle\\cdot\\rangle$，在线性情况下，反向传播的分量是不相关的，因此在考虑总通量时，交叉项会消失。方向性时间平均能量通量的大小为\n$$\\Phi_{\\text{out}} = \\langle \\mathcal{F}_{\\text{out}} \\rangle = \\rho g c\\,\\langle \\eta_{\\text{out}}^2 \\rangle,\\qquad \\Phi_{\\text{in}} = \\langle -\\mathcal{F}_{\\text{in}} \\rangle = \\rho g c\\,\\langle \\eta_{\\text{in}}^2 \\rangle.$$\n因此，定义为入射与出射的深度积分能量通量大小之比的反射系数为\n$$R = \\frac{\\Phi_{\\text{in}}}{\\Phi_{\\text{out}}} = \\frac{\\langle \\eta_{\\text{in}}^2 \\rangle}{\\langle \\eta_{\\text{out}}^2 \\rangle}.$$\n这提供了一个直接、可实现的基于边界时间序列的估计量：计算 $c=\\sqrt{gH}$，通过上述公式从测量的 $(\\eta,u)$ 构建 $\\eta_{\\text{out}}$ 和 $\\eta_{\\text{in}}$，计算它们在平均窗口内的均方值，然后取其比值。\n\n逐项分析：\n\nA. 该选项完全遵循了上述推导。它使用了边界处正确的特征分解，即\n$$\\eta_{\\text{out}}=\\frac{1}{2}\\left(\\eta + \\frac{H}{c}u\\right),\\quad \\eta_{\\text{in}}=\\frac{1}{2}\\left(\\eta - \\frac{H}{c}u\\right),$$\n然后估计\n$$R=\\frac{\\langle \\eta_{\\text{in}}^2\\rangle}{\\langle \\eta_{\\text{out}}^2\\rangle},$$\n这等于所求的通量比，因为 $\\Phi_{\\text{in}}=\\rho g c\\langle \\eta_{\\text{in}}^2\\rangle$ 且 $\\Phi_{\\text{out}}=\\rho g c\\langle \\eta_{\\text{out}}^2\\rangle$。正确。\n\nB. 该选项忽略了相位以及 $\\eta$ 和 $u$ 之间的动力学关系。比值 $|\\widehat{\\eta}|/|\\widehat{u}|$ 的单位是时间，不代表能量通量大小的比率。它既没有分离入射和出射分量，也没有使用正确的通量定义。不正确。\n\nC. 该选项使用单一的协矩 $\\langle \\eta u\\rangle$ 并用 $\\langle \\eta^2\\rangle$ 进行归一化，这对于通量比来说量纲不一致，并且同样没有分离方向性。此外，$\\langle \\eta u\\rangle$ 测量的是净通量（出射减去入射），而不是方向性大小的比值。不正确。\n\nD. 该选项混淆了能量密度（非方向性）和能量通量（方向性）。通过 $u$ 的符号来分类方向并不能在线性浅水波中得到正确的方向性能量通量，因为方向取决于相位关系 $u=\\pm \\frac{c}{H}\\eta$，而不仅仅是 $u$ 的瞬时符号。没有进行适当的分解，所提出的分子和分母没有被良好定义，也不对应于通量的大小。不正确。\n\nE. 该选项交换了入射和出射特征组合的角色。对于指向 $+x$ 方向的向外法线，正确的分解如选项 A 所示；选项 E 中的分配会将入射标记为出射，反之亦然，从而使比值倒置。因此，它不能一致地估计预期的 $R$。不正确。\n\n因此，选项 A 是正确的规范和估计量。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}