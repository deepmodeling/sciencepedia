{
    "hands_on_practices": [
        {
            "introduction": "A primary function of a sponge layer is to prevent spurious wave reflections from the model boundary from contaminating the dynamics in the domain's interior. The most basic design consideration is ensuring that any residual reflection is temporally separated from the physically relevant signals. This practice connects the fundamental physics of the fastest-propagating waves—the barotropic gravity waves—to a practical, first-order design criterion for determining the minimum required width of a sponge layer .",
            "id": "3809295",
            "problem": "An ocean model of the barotropic (depth-independent) external mode is configured in one horizontal dimension with an open boundary at each end of a rectangular domain of length $L=1000\\,\\mathrm{km}$. The undisturbed depth is $H=4000\\,\\mathrm{m}$ and the gravitational acceleration is $g=9.81\\,\\mathrm{m\\,s^{-2}}$. The open boundary enforces a one-way wave Radiation Boundary Condition (RBC) of Orlanski type, and a Rayleigh-damped sponge layer of width $W$ is applied adjacent to each open boundary on the interior side.\n\nStarting from the linearized one-dimensional shallow water equations for the external mode and using scientifically defensible assumptions about the dominant, fastest barotropic gravity-wave signal, do the following:\n\n1. Derive the appropriate propagation speed of the external gravity wave and use it to compute the shortest travel time from the domain center to the nearest open boundary.\n\n2. Impose the following requirement on the sponge layer: to keep any residual boundary reflection temporally separated from interior dynamics, the worst-case spurious reflection originating at the inner edge of the sponge must arrive back in the interior at least $\\Delta T_{\\mathrm{sep}}=1\\,\\mathrm{hour}$ later than its generation time. Using causality and non-dispersive propagation of the external mode, derive a lower bound for the minimum sponge width $W_{\\min}$ that meets this separation requirement.\n\nExpress the travel time in seconds and the minimum sponge width in kilometers. Round both quantities to four significant figures. Provide your final numerical answers only; all reasoning and intermediate steps must appear in your solution.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in computational oceanography. We proceed with the solution.\n\nThe problem asks for two quantities related to the propagation of barotropic gravity waves in a one-dimensional ocean model. We begin by analyzing the governing equations.\n\nThe linearized one-dimensional shallow water equations for a fluid of undisturbed depth $H$ are given by:\n$$\n\\frac{\\partial u}{\\partial t} = -g \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} = -H \\frac{\\partial u}{\\partial x}\n$$\nwhere $u(x, t)$ is the depth-independent horizontal velocity, $\\eta(x, t)$ is the sea surface elevation anomaly, $g$ is the gravitational acceleration, and the Coriolis effect is neglected in this one-dimensional setup.\n\nTo find the propagation speed of waves governed by this system, we combine the two equations into a single wave equation. We differentiate the first equation with respect to $x$ and the second equation with respect to $t$:\n$$\n\\frac{\\partial^2 u}{\\partial x \\partial t} = -g \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = -H \\frac{\\partial^2 u}{\\partial t \\partial x}\n$$\nSubstituting the term $\\frac{\\partial^2 u}{\\partial t \\partial x}$ from the time derivative of the second equation into the space derivative of the first, we get:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = gH \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\nThis is the classical one-dimensional wave equation of the form $\\frac{\\partial^2 y}{\\partial t^2} = c^2 \\frac{\\partial^2 y}{\\partial x^2}$. By comparison, the phase speed $c$ of the barotropic gravity waves is:\n$$\nc = \\sqrt{gH}\n$$\nThis speed is constant and does not depend on wavelength, which is consistent with the problem's assumption of non-dispersive propagation for the fastest, dominant external mode.\n\nThe givens are:\n- Gravitational acceleration, $g = 9.81 \\, \\mathrm{m \\, s^{-2}}$\n- Undisturbed depth, $H = 4000 \\, \\mathrm{m}$\n- Domain length, $L = 1000 \\, \\mathrm{km} = 10^6 \\, \\mathrm{m}$\n\nFirst, we compute the numerical value of the wave propagation speed $c$:\n$$\nc = \\sqrt{9.81 \\, \\mathrm{m \\, s^{-2}} \\times 4000 \\, \\mathrm{m}} = \\sqrt{39240} \\, \\mathrm{m \\, s^{-1}} \\approx 198.0909 \\, \\mathrm{m \\, s^{-1}}\n$$\n\n**Part 1: Travel time from the domain center to the nearest boundary**\n\nThe domain has a length $L$. The center of the domain is at a distance of $\\frac{L}{2}$ from either end, which is where the open boundaries are located. The shortest travel time, $T_{\\mathrm{travel}}$, from the center to the nearest boundary is this distance divided by the propagation speed $c$.\n\nDistance to boundary, $d = \\frac{L}{2} = \\frac{1000 \\, \\mathrm{km}}{2} = 500 \\, \\mathrm{km} = 5 \\times 10^5 \\, \\mathrm{m}$.\n\nThe travel time $T_{\\mathrm{travel}}$ is therefore:\n$$\nT_{\\mathrm{travel}} = \\frac{d}{c} = \\frac{L/2}{\\sqrt{gH}}\n$$\nSubstituting the numerical values:\n$$\nT_{\\mathrm{travel}} = \\frac{5 \\times 10^5 \\, \\mathrm{m}}{\\sqrt{39240} \\, \\mathrm{m \\, s^{-1}}} \\approx \\frac{5 \\times 10^5}{198.0909} \\, \\mathrm{s} \\approx 2524.093 \\, \\mathrm{s}\n$$\nRounding to four significant figures, the travel time is $2524 \\, \\mathrm{s}$.\n\n**Part 2: Minimum sponge width $W_{\\min}$**\n\nThe second part of the problem concerns the design of the sponge layer. A wave propagating from the interior of the domain reaches the inner edge of the sponge layer. This wave then travels through the sponge layer of width $W$, reflects off the open boundary due to imperfections in the Radiation Boundary Condition, and travels back through the sponge to re-enter the interior domain. The problem requires that the time taken for this round trip be at least $\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour}$. This ensures that any spurious boundary reflection is temporally separated from the dynamics in the domain's interior.\n\nLet us define the \"generation time\" as the moment the outgoing wave crosses the interface between the interior domain and the sponge layer. The wave travels a distance $W$ to the open boundary, reflects, and travels a distance $W$ back. The total path length for this round trip within the sponge layer is $2W$.\n\nThe time taken for this round trip, $\\Delta T_{\\mathrm{roundtrip}}$, is the total distance traveled divided by the wave speed $c$:\n$$\n\\Delta T_{\\mathrm{roundtrip}} = \\frac{2W}{c}\n$$\nThe problem imposes the requirement that this time delay is at least $\\Delta T_{\\mathrm{sep}}$:\n$$\n\\frac{2W}{c} \\ge \\Delta T_{\\mathrm{sep}}\n$$\nWe can solve this inequality for the minimum sponge width, $W_{\\min}$. The lower bound is met when equality holds:\n$$\nW_{\\min} = \\frac{c \\cdot \\Delta T_{\\mathrm{sep}}}{2}\n$$\nWe are given $\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour}$, which must be converted to seconds for consistency with the units of $c$:\n$$\n\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour} \\times \\frac{60 \\, \\mathrm{min}}{1 \\, \\mathrm{hour}} \\times \\frac{60 \\, \\mathrm{s}}{1 \\, \\mathrm{min}} = 3600 \\, \\mathrm{s}\n$$\nNow we can substitute the numerical values for $c$ and $\\Delta T_{\\mathrm{sep}}$:\n$$\nW_{\\min} = \\frac{(\\sqrt{39240} \\, \\mathrm{m \\, s^{-1}}) \\times 3600 \\, \\mathrm{s}}{2} \\approx \\frac{198.0909 \\, \\mathrm{m \\, s^{-1}} \\times 3600 \\, \\mathrm{s}}{2} \\approx 356563.6 \\, \\mathrm{m}\n$$\nThe problem requests the answer in kilometers. We convert meters to kilometers:\n$$\nW_{\\min} \\approx 356.5636 \\, \\mathrm{km}\n$$\nRounding to four significant figures, the minimum required sponge width is $356.6 \\, \\mathrm{km}$.\n\nThe final answers are $T_{\\mathrm{travel}} \\approx 2524 \\, \\mathrm{s}$ and $W_{\\min} \\approx 356.6 \\, \\mathrm{km}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2524 & 356.6 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Once an open boundary condition is implemented, a crucial task is to quantify its performance by measuring how much wave energy is reflected back into the domain. This exercise introduces a rigorous method to diagnose boundary performance directly from model output. By applying characteristic decomposition to time series of velocity and sea surface elevation at the boundary, we can separate the wave field into its incoming and outgoing components and thereby calculate a physically meaningful reflection coefficient based on energy flux .",
            "id": "3809230",
            "problem": "Consider a barotropic, hydrostatic, Boussinesq, constant-density ocean with constant depth $H$ and gravitational acceleration $g$, modeled by the linearized $1$-dimensional shallow water equations (SWE) along a straight open boundary with outward unit normal pointing in the positive $x$-direction. You have synchronized time series of the depth-averaged normal velocity $u(t)$ and free-surface elevation $\\eta(t)$ at the boundary $x=L$. Define a reflection coefficient $R$ at the open boundary as the ratio of the incoming to the outgoing depth-integrated wave energy flux magnitudes, averaged over a time window long compared to the dominant wave period but short compared to any slow modulation. Starting strictly from the governing equations and the mechanical energy balance they imply, and assuming linear wave superposition with negligible correlation between counter-propagating components over the averaging window, which option best specifies $R$ and gives a consistent, implementable estimator using only the boundary time series $\\big(\\eta(t),u(t)\\big)$?\n\nA. Compute $c=\\sqrt{gH}$. Form the characteristic decomposition at the boundary\n$$\\eta_{\\text{out}}(t)=\\dfrac{\\eta(t)+\\dfrac{H}{c}u(t)}{2},\\quad \\eta_{\\text{in}}(t)=\\dfrac{\\eta(t)-\\dfrac{H}{c}u(t)}{2},$$\nand estimate\n$$R=\\dfrac{\\langle \\eta_{\\text{in}}(t)^2\\rangle}{\\langle \\eta_{\\text{out}}(t)^2\\rangle},$$\nwhere $\\langle\\cdot\\rangle$ denotes a time average. This equals the ratio of incoming to outgoing depth-integrated energy flux magnitudes because each flux is $\\rho g c$ times the corresponding mean-square characteristic elevation.\n\nB. Estimate $R$ from the ratio of amplitudes at the dominant frequency,\n$$R=\\left|\\dfrac{\\widehat{\\eta}(\\omega_0)}{\\widehat{u}(\\omega_0)}\\right|,$$\nwhere $\\widehat{\\cdot}$ denotes the Fourier transform and $\\omega_0$ is the peak frequency.\n\nC. Estimate $R$ as a normalized energy-flux proxy,\n$$R=\\dfrac{\\langle \\eta(t)u(t)\\rangle}{\\langle \\eta(t)^2\\rangle},$$\narguing that the numerator measures net energy transport and the denominator scales with wave energy.\n\nD. Use energy density without directional separation,\n$$R=\\dfrac{\\left\\langle \\dfrac{1}{2}g\\,\\eta(t)^2+\\dfrac{1}{2}H\\,u(t)^2\\right\\rangle_{\\text{incoming}}}{\\left\\langle \\dfrac{1}{2}g\\,\\eta(t)^2+\\dfrac{1}{2}H\\,u(t)^2\\right\\rangle_{\\text{outgoing}}},$$\nand assign incoming versus outgoing by the sign of $u(t)$ at the boundary.\n\nE. Compute $c=\\sqrt{gH}$ and define\n$$\\eta_{\\text{out}}(t)=\\dfrac{\\eta(t)-\\dfrac{H}{c}u(t)}{2},\\quad \\eta_{\\text{in}}(t)=\\dfrac{\\eta(t)+\\dfrac{H}{c}u(t)}{2},$$\nthen estimate\n$$R=\\dfrac{\\langle \\eta_{\\text{in}}(t)^2\\rangle}{\\langle \\eta_{\\text{out}}(t)^2\\rangle}.$$",
            "solution": "Begin with the linearized $1$-dimensional shallow water equations (SWE) under hydrostatic and Boussinesq assumptions with constant depth $H$ and constant density $\\rho$:\n$$\\eta_t + H u_x = 0,\\qquad u_t + g \\eta_x = 0.$$\nTo obtain the mechanical energy balance, multiply the momentum equation by $\\rho H u$ and the continuity equation by $\\rho g \\eta$, and add:\n$$\\rho H u\\,u_t + \\rho g \\eta\\,\\eta_t + \\rho g H \\eta\\,u_x = 0.$$\nRecognize total time derivatives and a divergence:\n$$\\frac{\\partial}{\\partial t}\\left(\\frac{\\rho H}{2}u^2 + \\frac{\\rho g}{2}\\eta^2\\right) + \\frac{\\partial}{\\partial x}\\left(\\rho g H \\eta u\\right) = 0.$$\nThus, the depth-integrated wave energy density is\n$$\\mathcal{E} = \\frac{\\rho H}{2}u^2 + \\frac{\\rho g}{2}\\eta^2,$$\nand the corresponding depth-integrated energy flux in the $+x$ direction is\n$$\\mathcal{F} = \\rho g H \\eta u.$$\nAt the boundary with outward normal in the $+x$ direction, energy leaving the domain has $\\mathcal{F}>0$ (outgoing), and energy entering has $\\mathcal{F}<0$ (incoming).\n\nNext, decompose the boundary signal into counter-propagating shallow-water waves using the characteristic form. Define the gravity wave speed $c=\\sqrt{gH}$. The SWE admit Riemann invariants\n$$r_{\\pm} = u \\pm \\frac{c}{H}\\eta,$$\nwhich satisfy advection at speeds $\\mp c$ and $+c$, respectively. A right-going (outward, toward $+x$) linear shallow-water wave satisfies $u = \\frac{c}{H}\\eta$, whereas a left-going (incoming, toward $-x$) wave satisfies $u = -\\frac{c}{H}\\eta$. Let $\\eta_{\\text{out}}$ and $\\eta_{\\text{in}}$ denote the free-surface components associated with the outgoing and incoming waves, respectively, so that\n$$\\eta = \\eta_{\\text{out}} + \\eta_{\\text{in}},\\qquad u = \\frac{c}{H}\\eta_{\\text{out}} - \\frac{c}{H}\\eta_{\\text{in}}.$$\nSolving for $\\eta_{\\text{out}}$ and $\\eta_{\\text{in}}$ in terms of the measured $\\eta$ and $u$ gives\n$$\\eta_{\\text{out}} = \\frac{1}{2}\\left(\\eta + \\frac{H}{c}u\\right),\\qquad \\eta_{\\text{in}} = \\frac{1}{2}\\left(\\eta - \\frac{H}{c}u\\right).$$\nThe corresponding velocities are\n$$u_{\\text{out}} = \\frac{c}{H}\\eta_{\\text{out}},\\qquad u_{\\text{in}} = -\\frac{c}{H}\\eta_{\\text{in}}.$$\nSubstitute these into the flux expression to separate the energy flux into directional components. The instantaneous flux due to the outgoing component is\n$$\\mathcal{F}_{\\text{out}} = \\rho g H \\,\\eta_{\\text{out}}\\,u_{\\text{out}} = \\rho g H \\,\\eta_{\\text{out}}\\,\\frac{c}{H}\\eta_{\\text{out}} = \\rho g c\\,\\eta_{\\text{out}}^2 \\ge 0,$$\nand the incoming component is\n$$\\mathcal{F}_{\\text{in}} = \\rho g H \\,\\eta_{\\text{in}}\\,u_{\\text{in}} = \\rho g H \\,\\eta_{\\text{in}}\\left(-\\frac{c}{H}\\eta_{\\text{in}}\\right) = -\\rho g c\\,\\eta_{\\text{in}}^2 \\le 0.$$\nFor a time average $\\langle\\cdot\\rangle$ over a window long compared to wave periods, the counter-propagating components are uncorrelated in the linear regime, so cross terms vanish when considering the total flux. The magnitudes of the directional, time-mean energy fluxes are\n$$\\Phi_{\\text{out}} = \\langle \\mathcal{F}_{\\text{out}} \\rangle = \\rho g c\\,\\langle \\eta_{\\text{out}}^2 \\rangle,\\qquad \\Phi_{\\text{in}} = \\langle -\\mathcal{F}_{\\text{in}} \\rangle = \\rho g c\\,\\langle \\eta_{\\text{in}}^2 \\rangle.$$\nTherefore, the reflection coefficient defined as the ratio of incoming to outgoing depth-integrated energy flux magnitudes is\n$$R = \\frac{\\Phi_{\\text{in}}}{\\Phi_{\\text{out}}} = \\frac{\\langle \\eta_{\\text{in}}^2 \\rangle}{\\langle \\eta_{\\text{out}}^2 \\rangle}.$$\nThis provides a direct, implementable estimator from the boundary time series: compute $c=\\sqrt{gH}$, form $\\eta_{\\text{out}}$ and $\\eta_{\\text{in}}$ from the measured $(\\eta,u)$ via the formulas above, compute their mean squares over the averaging window, and take the ratio.\n\nOption-by-option analysis:\n\nA. This option exactly follows the derivation above. It uses the correct characteristic decomposition at the boundary, with\n$$\\eta_{\\text{out}}=\\frac{1}{2}\\left(\\eta + \\frac{H}{c}u\\right),\\quad \\eta_{\\text{in}}=\\frac{1}{2}\\left(\\eta - \\frac{H}{c}u\\right),$$\nand then estimates\n$$R=\\frac{\\langle \\eta_{\\text{in}}^2\\rangle}{\\langle \\eta_{\\text{out}}^2\\rangle},$$\nwhich equals the desired flux ratio because $\\Phi_{\\text{in}}=\\rho g c\\langle \\eta_{\\text{in}}^2\\rangle$ and $\\Phi_{\\text{out}}=\\rho g c\\langle \\eta_{\\text{out}}^2\\rangle$. Correct.\n\nB. This option ignores phase and the dynamical relation between $\\eta$ and $u$. The ratio $|\\widehat{\\eta}|/|\\widehat{u}|$ has units of time and does not represent a ratio of energy flux magnitudes. It neither separates incoming and outgoing components nor uses the correct flux definition. Incorrect.\n\nC. This option uses a single co-moment $\\langle \\eta u\\rangle$ normalized by $\\langle \\eta^2\\rangle$, which is dimensionally inconsistent for a flux ratio and again does not separate directionality. Moreover, $\\langle \\eta u\\rangle$ measures net flux (outgoing minus incoming), not the ratio of directional magnitudes. Incorrect.\n\nD. This option confuses energy density (which is not directional) with energy flux (which is directional). Classifying direction by the sign of $u$ does not yield the correct directional energy flux in linear shallow-water waves, where direction depends on the phase relationship $u=\\pm \\frac{c}{H}\\eta$, not merely on the instantaneous sign of $u$. Without proper decomposition, the proposed numerator and denominator are not well defined and do not correspond to flux magnitudes. Incorrect.\n\nE. This option swaps the roles of the incoming and outgoing characteristic combinations. For an outward normal in the $+x$ direction, the correct decomposition is as in option A; the assignment in E would label incoming as outgoing and vice versa, inverting the ratio. Consequently, it does not consistently estimate the intended $R$. Incorrect.\n\nTherefore, option A is the correct specification and estimator.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The successful implementation of a sponge layer depends not only on its physical formulation but also on its numerical stability within the discrete model grid. This practice explores the crucial interaction between the physical relaxation term and the numerical scheme used for advection. You will discover how an explicit time-stepping approach can introduce numerical oscillations and derive the coupled stability constraint that links the relaxation rate, the time step, and the Courant number to ensure a robust and physically realistic simulation .",
            "id": "3809236",
            "problem": "Consider a one-dimensional, depth-averaged tracer $q(x,t)$ being advected toward an open ocean boundary at $x=0$ with a constant barotropic velocity $U>0$. To minimize reflection consistent with a radiation boundary condition, a sponge layer of width $L_s$ is applied for $0 \\le x \\le L_s$ that relaxes $q$ toward a prescribed target profile $q^\\ast(x)$ via Newtonian relaxation with coefficient $\\alpha>0$, uniform within the sponge layer. The governing equation in the sponge is\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha\\left(q - q^\\ast\\right).\n$$\nLet the grid be uniform with spacing $\\Delta x$ and time step $\\Delta t$, and discretize the advection term using first-order upstream (upwind) differencing for $U>0$, while the relaxation term is treated by explicit Euler. Define the advective Courant-Friedrichs-Lewy (CFL) number $\\mu = U \\Delta t / \\Delta x$. Assume $q^\\ast$ is sufficiently smooth that its spatial variation can be neglected over one grid cell for the purpose of local stability analysis, and analyze the discrete evolution of the relaxation error $e_j^n = q_j^n - q_j^\\ast$.\n\nStarting from the conservation law with source term and the stated discretizations, derive the single-step update for $e_j^n$ and use it to reason about how explicit relaxation interacts with upstream advection to produce overshoots or numerical oscillations at grid scale. Then, based on first principles of monotonicity and linear stability, determine a coupled constraint relating $\\alpha$, $\\Delta t$, and $\\mu$ that ensures the update is both stable and non-oscillatory in the sponge layer. Which of the following statements best captures the correct mechanism and the coupled constraint?\n\nA. Overshoots and temporal grid-scale oscillations arise when the local weighting of $e_j^n$ becomes negative, i.e., when $1 - \\mu - \\alpha \\Delta t < 0$. A sufficient non-oscillatory stability condition for the explicit upstream-relaxation update is $0 \\le \\mu \\le 1$ together with $0 \\le \\alpha \\Delta t \\le 1 - \\mu$, which guarantees the update is a convex combination of $e_j^n$ and $e_{j-1}^n$ with net damping.\n\nB. Relaxation always stabilizes upstream advection regardless of the advective CFL number, so no overshoots can occur. The only requirement is $0 \\le \\mu \\le 1$; $\\alpha \\Delta t$ may be arbitrarily large without coupling to $\\mu$.\n\nC. Stronger advection always suppresses oscillations induced by relaxation, leading to the condition $\\alpha \\Delta t \\le \\mu$ for stability, with no need to impose any upper bound on $\\mu$ beyond $\\mu \\le 2$.\n\nD. The correct coupled linear stability bound is $\\alpha \\Delta t \\le 2(1 - \\mu)$, which guarantees non-oscillatory decay for all resolved wavenumbers when $0 \\le \\mu \\le 1$; moreover, grid-scale overshoots cannot occur under this bound.\n\nE. The stability of explicit relaxation is independent of advection; to avoid oscillations one only needs $0 \\le \\alpha \\Delta t \\le 2$ and $0 \\le \\mu \\le 1$, with no further coupling constraint between $\\alpha \\Delta t$ and $\\mu$.",
            "solution": "The user wants me to solve a problem in computational oceanography.\n\n### Step 1: Extract Givens\n- **Governing Equation (in sponge layer, $0 \\le x \\le L_s$):** $\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha(q - q^\\ast)$, where $U>0$ and $\\alpha>0$.\n- **Tracer:** $q(x,t)$, a one-dimensional, depth-averaged tracer.\n- **Velocity:** $U$, a constant positive barotropic velocity.\n- **Relaxation Coefficient:** $\\alpha$, a positive constant.\n- **Target Profile:** $q^\\ast(x)$, a prescribed profile.\n- **Discretization:**\n    - Grid: Uniform with spacing $\\Delta x$ and time step $\\Delta t$.\n    - Advection Term ($U \\frac{\\partial q}{\\partial x}$): First-order upstream (upwind) differencing for $U>0$.\n    - Time Stepping / Relaxation Term ($-\\alpha(q-q^\\ast)$): Explicit Euler.\n- **Definitions:**\n    - Advective CFL number: $\\mu = U \\Delta t / \\Delta x$.\n    - Relaxation error: $e_j^n = q_j^n - q_j^\\ast$.\n- **Assumption:** $q^\\ast$ is sufficiently smooth that its spatial variation can be neglected over one grid cell for local stability analysis.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is analyzed against the validation criteria.\n\n- **Scientifically Grounded:** The problem describes the numerical implementation of a sponge layer with Newtonian relaxation, a standard and widely used technique in computational fluid dynamics and ocean modeling to implement open boundary conditions. The governing equation is a linear advection-reaction (or damping) equation, which is a fundamental model equation. The discretization methods (first-order upwind, explicit Euler) are standard. The problem is fundamentally sound.\n- **Well-Posed:** The problem is well-posed. It asks for the derivation of a stability and monotonicity condition for a specific, fully-defined numerical scheme. A unique condition can be derived from first principles of numerical analysis.\n- **Objective:** The language is precise, technical, and free of subjectivity. All terms are either standard in the field (e.g., CFL number, upstream differencing) or explicitly defined.\n- **No Flaws Detected:** The problem does not violate any of the invalidity criteria. It is not scientifically unsound, non-formalizable, incomplete, contradictory, unrealistic, ill-posed, or trivial. It is a well-formed question in the field of numerical methods for partial differential equations.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The solution will be derived as follows.\n\n### Derivation of the Numerical Scheme and Stability Condition\n\nThe governing partial differential equation (PDE) within the sponge layer is:\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha(q - q^\\ast)\n$$\nWe are asked to analyze the evolution of the relaxation error, $e(x,t) = q(x,t) - q^\\ast(x)$. Since the target profile $q^\\ast(x)$ is assumed to be time-invariant, $\\frac{\\partial q^\\ast}{\\partial t} = 0$. The PDE for the error $e$ is found by substituting $q = e + q^\\ast$ into the governing equation:\n$$\n\\frac{\\partial (e + q^\\ast)}{\\partial t} + U \\frac{\\partial (e + q^\\ast)}{\\partial x} = -\\alpha e\n$$\n$$\n\\frac{\\partial e}{\\partial t} + U \\frac{\\partial e}{\\partial x} + U \\frac{\\partial q^\\ast}{\\partial x} = -\\alpha e\n$$\nFor the purpose of a local stability analysis, the problem states we can neglect the spatial variation of $q^\\ast$ over a grid cell. This is equivalent to setting the term $U \\frac{\\partial q^\\ast}{\\partial x}$ to zero in the local analysis. The simplified PDE for the error becomes:\n$$\n\\frac{\\partial e}{\\partial t} + U \\frac{\\partial e}{\\partial x} = -\\alpha e\n$$\nWe now discretize this equation on a uniform grid where $e_j^n \\approx e(j\\Delta x, n\\Delta t)$.\n- The time derivative $\\frac{\\partial e}{\\partial t}$ is discretized using forward (explicit) Euler: $\\frac{e_j^{n+1} - e_j^n}{\\Delta t}$.\n- The advection term $U\\frac{\\partial e}{\\partial x}$ is discretized using first-order upstream differencing. Since $U>0$, the upstream direction is towards smaller $x$ (smaller index $j$), so the derivative is approximated as $U \\frac{e_j^n - e_{j-1}^n}{\\Delta x}$.\n- The relaxation term $-\\alpha e$ is treated explicitly, evaluated at time level $n$: $-\\alpha e_j^n$.\n\nSubstituting these discretizations into the error PDE gives the finite difference equation:\n$$\n\\frac{e_j^{n+1} - e_j^n}{\\Delta t} + U \\frac{e_j^n - e_{j-1}^n}{\\Delta x} = -\\alpha e_j^n\n$$\nOur goal is to find the update rule for $e_j^{n+1}$. We multiply by $\\Delta t$ and rearrange:\n$$\ne_j^{n+1} - e_j^n = -\\Delta t \\left( U \\frac{e_j^n - e_{j-1}^n}{\\Delta x} \\right) - \\alpha \\Delta t e_j^n\n$$\n$$\ne_j^{n+1} = e_j^n - \\frac{U \\Delta t}{\\Delta x} (e_j^n - e_{j-1}^n) - \\alpha \\Delta t e_j^n\n$$\nUsing the definition of the CFL number, $\\mu = \\frac{U \\Delta t}{\\Delta x}$:\n$$\ne_j^{n+1} = e_j^n - \\mu (e_j^n - e_{j-1}^n) - \\alpha \\Delta t e_j^n\n$$\nGrouping the terms by their spatial indices at time level $n$:\n$$\ne_j^{n+1} = (1 - \\mu - \\alpha \\Delta t) e_j^n + \\mu e_{j-1}^n\n$$\nThis is the single-step update equation for the error.\n\nTo ensure the update is non-oscillatory (i.e., it does not create new local maxima or minima), the scheme must be monotone. A sufficient condition for a linear scheme of this form to be monotone is that all the coefficients of the terms at time level $n$ are non-negative.\nThe coefficients are $(1 - \\mu - \\alpha \\Delta t)$ and $\\mu$.\n\n1.  **Coefficient of $e_{j-1}^n$:** We require $\\mu \\ge 0$. Since $U > 0$, $\\Delta t > 0$, and $\\Delta x > 0$, this condition is inherently satisfied.\n2.  **Coefficient of $e_j^n$:** We require $1 - \\mu - \\alpha \\Delta t \\ge 0$.\n\nThis second condition gives the coupled constraint:\n$$\n\\alpha \\Delta t \\le 1 - \\mu\n$$\nFrom this inequality, we can infer another constraint. Since $\\alpha > 0$ and $\\Delta t > 0$, the left-hand side $\\alpha \\Delta t$ is positive. Therefore, the right-hand side must be non-negative:\n$$\n1 - \\mu \\ge 0 \\implies \\mu \\le 1\n$$\nThis recovers the standard Courant-Friedrichs-Lewy (CFL) stability condition for the first-order upwind scheme for pure advection.\n\nThus, the combined set of constraints to ensure a stable and non-oscillatory (monotone) update is:\n$$\n0 \\le \\mu \\le 1 \\quad \\text{and} \\quad 0 \\le \\alpha \\Delta t \\le 1 - \\mu\n$$\nWhen these conditions are met, the update for $e_j^{n+1}$ is a linear combination of $e_j^n$ and $e_{j-1}^n$ with non-negative weights that sum to $ (1 - \\mu - \\alpha \\Delta t) + \\mu = 1 - \\alpha \\Delta t$. Since $0 \\le \\alpha \\Delta t \\le 1-\\mu \\le 1$, the sum is between $0$ and $1$, indicating a damped, non-oscillatory update. Overshoots or undershoots (numerical oscillations) occur precisely when the coefficient of $e_j^n$ becomes negative, i.e., $1 - \\mu - \\alpha \\Delta t < 0$, allowing for a sign change in the solution where none should exist.\n\n### Evaluation of Options\n\n**A. Overshoots and temporal grid-scale oscillations arise when the local weighting of $e_j^n$ becomes negative, i.e., when $1 - \\mu - \\alpha \\Delta t < 0$. A sufficient non-oscillatory stability condition for the explicit upstream-relaxation update is $0 \\le \\mu \\le 1$ together with $0 \\le \\alpha \\Delta t \\le 1 - \\mu$, which guarantees the update is a convex combination of $e_j^n$ and $e_{j-1}^n$ with net damping.**\n- This statement accurately identifies that oscillations arise when the coefficient of $e_j^n$ becomes negative. The derived update equation is $e_j^{n+1} = (1 - \\mu - \\alpha \\Delta t) e_j^n + \\mu e_{j-1}^n$, so the coefficient is indeed $1 - \\mu - \\alpha \\Delta t$.\n- The stated condition, $0 \\le \\mu \\le 1$ and $0 \\le \\alpha \\Delta t \\le 1 - \\mu$, is precisely the condition for non-negativity of both coefficients, which ensures a monotone, non-oscillatory scheme. This condition also guarantees stability.\n- The description of the update as a \"convex combination... with net damping\" is physically and mathematically sound. The weights are non-negative, and their sum is $1 - \\alpha \\Delta t \\le 1$, which corresponds to a convex combination followed by damping.\n- **Verdict: Correct.**\n\n**B. Relaxation always stabilizes upstream advection regardless of the advective CFL number, so no overshoots can occur. The only requirement is $0 \\le \\mu \\le 1$; $\\alpha \\Delta t$ may be arbitrarily large without coupling to $\\mu$.**\n- This is incorrect. The derivation shows a direct coupling between $\\alpha \\Delta t$ and $\\mu$ via the constraint $\\alpha \\Delta t \\le 1 - \\mu$. If $\\alpha \\Delta t$ is too large (e.g., $\\alpha \\Delta t > 1 - \\mu$), the coefficient of $e_j^n$ becomes negative, leading to oscillations.\n- **Verdict: Incorrect.**\n\n**C. Stronger advection always suppresses oscillations induced by relaxation, leading to the condition $\\alpha \\Delta t \\le \\mu$ for stability, with no need to impose any upper bound on $\\mu$ beyond $\\mu \\le 2$.**\n- This is incorrect. The derived condition is $\\alpha \\Delta t \\le 1 - \\mu$. Stronger advection (larger $\\mu$) makes the right side smaller, thus *tightening* the constraint on $\\alpha \\Delta t$, not suppressing oscillations. The condition $\\alpha \\Delta t \\le \\mu$ is incorrect. Furthermore, the first-order upwind scheme is unstable for $\\mu > 1$; the mention of $\\mu \\le 2$ has no relevance here.\n- **Verdict: Incorrect.**\n\n**D. The correct coupled linear stability bound is $\\alpha \\Delta t \\le 2(1 - \\mu)$, which guarantees non-oscillatory decay for all resolved wavenumbers when $0 \\le \\mu \\le 1$; moreover, grid-scale overshoots cannot occur under this bound.**\n- A von Neumann stability analysis shows that the general condition for linear stability ($|G| \\le 1$) is indeed $\\alpha \\Delta t \\le 2(1 - \\mu)$ for $0 \\le \\mu \\le 1$. However, the regime $1 - \\mu < \\alpha \\Delta t \\le 2(1 - \\mu)$ is stable but *oscillatory*. The question specifically asks for a condition that is \"stable and non-oscillatory\". The condition for non-oscillatory behavior (monotonicity) is the stricter $\\alpha \\Delta t \\le 1 - \\mu$. Therefore, the claim that $\\alpha \\Delta t \\le 2(1 - \\mu)$ \"guarantees non-oscillatory decay\" is false.\n- **Verdict: Incorrect.**\n\n**E. The stability of explicit relaxation is independent of advection; to avoid oscillations one only needs $0 \\le \\alpha \\Delta t \\le 2$ and $0 \\le \\mu \\le 1$, with no further coupling constraint between $\\alpha \\Delta t$ and $\\mu$.**\n- This is incorrect. The derivation clearly establishes the coupling condition $\\alpha \\Delta t \\le 1 - \\mu$. The stability of the combined system is not simply the intersection of the stability regions of the individual components (advection and relaxation). The terms interact. The condition $\\alpha \\Delta t \\le 2$ is the stability limit for pure relaxation, but it is not sufficient when advection is present.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}