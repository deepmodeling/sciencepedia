{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in designing an open boundary is to determine the physical scale of the required sponge layer. This practice connects the fundamental physics of wave propagation to the practical design of a numerical model. By calculating the propagation speed of the fastest waves in the system, you will determine a minimum sponge width necessary to prevent spurious reflections from contaminating the interior domain's dynamics, providing a tangible link between theory and model setup .",
            "id": "3809295",
            "problem": "An ocean model of the barotropic (depth-independent) external mode is configured in one horizontal dimension with an open boundary at each end of a rectangular domain of length $L=1000\\,\\mathrm{km}$. The undisturbed depth is $H=4000\\,\\mathrm{m}$ and the gravitational acceleration is $g=9.81\\,\\mathrm{m\\,s^{-2}}$. The open boundary enforces a one-way wave Radiation Boundary Condition (RBC) of Orlanski type, and a Rayleigh-damped sponge layer of width $W$ is applied adjacent to each open boundary on the interior side.\n\nStarting from the linearized one-dimensional shallow water equations for the external mode and using scientifically defensible assumptions about the dominant, fastest barotropic gravity-wave signal, do the following:\n\n1. Derive the appropriate propagation speed of the external gravity wave and use it to compute the shortest travel time from the domain center to the nearest open boundary.\n\n2. Impose the following requirement on the sponge layer: to keep any residual boundary reflection temporally separated from interior dynamics, the worst-case spurious reflection originating at the inner edge of the sponge must arrive back in the interior at least $\\Delta T_{\\mathrm{sep}}=1\\,\\mathrm{hour}$ later than its generation time. Using causality and non-dispersive propagation of the external mode, derive a lower bound for the minimum sponge width $W_{\\min}$ that meets this separation requirement.\n\nExpress the travel time in seconds and the minimum sponge width in kilometers. Round both quantities to four significant figures. Provide your final numerical answers only; all reasoning and intermediate steps must appear in your solution.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in computational oceanography. We proceed with the solution.\n\nThe problem asks for two quantities related to the propagation of barotropic gravity waves in a one-dimensional ocean model. We begin by analyzing the governing equations.\n\nThe linearized one-dimensional shallow water equations for a fluid of undisturbed depth $H$ are given by:\n$$\n\\frac{\\partial u}{\\partial t} = -g \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} = -H \\frac{\\partial u}{\\partial x}\n$$\nwhere $u(x, t)$ is the depth-independent horizontal velocity, $\\eta(x, t)$ is the sea surface elevation anomaly, $g$ is the gravitational acceleration, and the Coriolis effect is neglected in this one-dimensional setup.\n\nTo find the propagation speed of waves governed by this system, we combine the two equations into a single wave equation. We differentiate the first equation with respect to $x$ and the second equation with respect to $t$:\n$$\n\\frac{\\partial^2 u}{\\partial x \\partial t} = -g \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = -H \\frac{\\partial^2 u}{\\partial t \\partial x}\n$$\nSubstituting the term $\\frac{\\partial^2 u}{\\partial t \\partial x}$ from the time derivative of the second equation into the space derivative of the first, we get:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = gH \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\nThis is the classical one-dimensional wave equation of the form $\\frac{\\partial^2 y}{\\partial t^2} = c^2 \\frac{\\partial^2 y}{\\partial x^2}$. By comparison, the phase speed $c$ of the barotropic gravity waves is:\n$$\nc = \\sqrt{gH}\n$$\nThis speed is constant and does not depend on wavelength, which is consistent with the problem's assumption of non-dispersive propagation for the fastest, dominant external mode.\n\nThe givens are:\n- Gravitational acceleration, $g = 9.81 \\, \\mathrm{m \\, s^{-2}}$\n- Undisturbed depth, $H = 4000 \\, \\mathrm{m}$\n- Domain length, $L = 1000 \\, \\mathrm{km} = 10^6 \\, \\mathrm{m}$\n\nFirst, we compute the numerical value of the wave propagation speed $c$:\n$$\nc = \\sqrt{9.81 \\, \\mathrm{m \\, s^{-2}} \\times 4000 \\, \\mathrm{m}} = \\sqrt{39240} \\, \\mathrm{m \\, s^{-1}} \\approx 198.0909 \\, \\mathrm{m \\, s^{-1}}\n$$\n\n**Part 1: Travel time from the domain center to the nearest boundary**\n\nThe domain has a length $L$. The center of the domain is at a distance of $\\frac{L}{2}$ from either end, which is where the open boundaries are located. The shortest travel time, $T_{\\mathrm{travel}}$, from the center to the nearest boundary is this distance divided by the propagation speed $c$.\n\nDistance to boundary, $d = \\frac{L}{2} = \\frac{1000 \\, \\mathrm{km}}{2} = 500 \\, \\mathrm{km} = 5 \\times 10^5 \\, \\mathrm{m}$.\n\nThe travel time $T_{\\mathrm{travel}}$ is therefore:\n$$\nT_{\\mathrm{travel}} = \\frac{d}{c} = \\frac{L/2}{\\sqrt{gH}}\n$$\nSubstituting the numerical values:\n$$\nT_{\\mathrm{travel}} = \\frac{5 \\times 10^5 \\, \\mathrm{m}}{\\sqrt{39240} \\, \\mathrm{m \\, s^{-1}}} \\approx \\frac{5 \\times 10^5}{198.0909} \\, \\mathrm{s} \\approx 2524.093 \\, \\mathrm{s}\n$$\nRounding to four significant figures, the travel time is $2524 \\, \\mathrm{s}$.\n\n**Part 2: Minimum sponge width $W_{\\min}$**\n\nThe second part of the problem concerns the design of the sponge layer. A wave propagating from the interior of the domain reaches the inner edge of the sponge layer. This wave then travels through the sponge layer of width $W$, reflects off the open boundary due to imperfections in the Radiation Boundary Condition, and travels back through the sponge to re-enter the interior domain. The problem requires that the time taken for this round trip be at least $\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour}$. This ensures that any spurious boundary reflection is temporally separated from the dynamics in the domain's interior.\n\nLet us define the \"generation time\" as the moment the outgoing wave crosses the interface between the interior domain and the sponge layer. The wave travels a distance $W$ to the open boundary, reflects, and travels a distance $W$ back. The total path length for this round trip within the sponge layer is $2W$.\n\nThe time taken for this round trip, $\\Delta T_{\\mathrm{roundtrip}}$, is the total distance traveled divided by the wave speed $c$:\n$$\n\\Delta T_{\\mathrm{roundtrip}} = \\frac{2W}{c}\n$$\nThe problem imposes the requirement that this time delay is at least $\\Delta T_{\\mathrm{sep}}$:\n$$\n\\frac{2W}{c} \\ge \\Delta T_{\\mathrm{sep}}\n$$\nWe can solve this inequality for the minimum sponge width, $W_{\\min}$. The lower bound is met when equality holds:\n$$\nW_{\\min} = \\frac{c \\cdot \\Delta T_{\\mathrm{sep}}}{2}\n$$\nWe are given $\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour}$, which must be converted to seconds for consistency with the units of $c$:\n$$\n\\Delta T_{\\mathrm{sep}} = 1 \\, \\mathrm{hour} \\times \\frac{60 \\, \\mathrm{min}}{1 \\, \\mathrm{hour}} \\times \\frac{60 \\, \\mathrm{s}}{1 \\, \\mathrm{min}} = 3600 \\, \\mathrm{s}\n$$\nNow we can substitute the numerical values for $c$ and $\\Delta T_{\\mathrm{sep}}$:\n$$\nW_{\\min} = \\frac{(\\sqrt{39240} \\, \\mathrm{m \\, s^{-1}}) \\times 3600 \\, \\mathrm{s}}{2} \\approx \\frac{198.0909 \\, \\mathrm{m \\, s^{-1}} \\times 3600 \\, \\mathrm{s}}{2} \\approx 356563.6 \\, \\mathrm{m}\n$$\nThe problem requests the answer in kilometers. We convert meters to kilometers:\n$$\nW_{\\min} \\approx 356.5636 \\, \\mathrm{km}\n$$\nRounding to four significant figures, the minimum required sponge width is $356.6 \\, \\mathrm{km}$.\n\nThe final answers are $T_{\\mathrm{travel}} \\approx 2524 \\, \\mathrm{s}$ and $W_{\\min} \\approx 356.6 \\, \\mathrm{km}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2524  356.6 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Implementing a sponge layer involves discretizing both the advection and damping terms, a process that can introduce numerical artifacts if not handled carefully. This exercise explores the interaction between an explicit relaxation term and an upstream advection scheme, a common combination in sponge layer design. You will derive the coupled stability constraint that links the advective Courant-Friedrichs-Lewy (CFL) number, the time step, and the relaxation coefficient, gaining essential insight into ensuring a numerically stable and non-oscillatory implementation .",
            "id": "3809236",
            "problem": "Consider a one-dimensional, depth-averaged tracer $q(x,t)$ being advected toward an open ocean boundary at $x=0$ with a constant barotropic velocity $U0$. To minimize reflection consistent with a radiation boundary condition, a sponge layer of width $L_s$ is applied for $0 \\le x \\le L_s$ that relaxes $q$ toward a prescribed target profile $q^\\ast(x)$ via Newtonian relaxation with coefficient $\\alpha0$, uniform within the sponge layer. The governing equation in the sponge is\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha\\left(q - q^\\ast\\right).\n$$\nLet the grid be uniform with spacing $\\Delta x$ and time step $\\Delta t$, and discretize the advection term using first-order upstream (upwind) differencing for $U0$, while the relaxation term is treated by explicit Euler. Define the advective Courant-Friedrichs-Lewy (CFL) number $\\mu = U \\Delta t / \\Delta x$. Assume $q^\\ast$ is sufficiently smooth that its spatial variation can be neglected over one grid cell for the purpose of local stability analysis, and analyze the discrete evolution of the relaxation error $e_j^n = q_j^n - q_j^\\ast$.\n\nStarting from the conservation law with source term and the stated discretizations, derive the single-step update for $e_j^n$ and use it to reason about how explicit relaxation interacts with upstream advection to produce overshoots or numerical oscillations at grid scale. Then, based on first principles of monotonicity and linear stability, determine a coupled constraint relating $\\alpha$, $\\Delta t$, and $\\mu$ that ensures the update is both stable and non-oscillatory in the sponge layer. Which of the following statements best captures the correct mechanism and the coupled constraint?\n\nA. Overshoots and temporal grid-scale oscillations arise when the local weighting of $e_j^n$ becomes negative, i.e., when $1 - \\mu - \\alpha \\Delta t  0$. A sufficient non-oscillatory stability condition for the explicit upstream-relaxation update is $0 \\le \\mu \\le 1$ together with $0 \\le \\alpha \\Delta t \\le 1 - \\mu$, which guarantees the update is a convex combination of $e_j^n$ and $e_{j-1}^n$ with net damping.\n\nB. Relaxation always stabilizes upstream advection regardless of the advective CFL number, so no overshoots can occur. The only requirement is $0 \\le \\mu \\le 1$; $\\alpha \\Delta t$ may be arbitrarily large without coupling to $\\mu$.\n\nC. Stronger advection always suppresses oscillations induced by relaxation, leading to the condition $\\alpha \\Delta t \\le \\mu$ for stability, with no need to impose any upper bound on $\\mu$ beyond $\\mu \\le 2$.\n\nD. The correct coupled linear stability bound is $\\alpha \\Delta t \\le 2(1 - \\mu)$, which guarantees non-oscillatory decay for all resolved wavenumbers when $0 \\le \\mu \\le 1$; moreover, grid-scale overshoots cannot occur under this bound.\n\nE. The stability of explicit relaxation is independent of advection; to avoid oscillations one only needs $0 \\le \\alpha \\Delta t \\le 2$ and $0 \\le \\mu \\le 1$, with no further coupling constraint between $\\alpha \\Delta t$ and $\\mu$.",
            "solution": "The user wants me to solve a problem in computational oceanography.\n\n### Step 1: Extract Givens\n- **Governing Equation (in sponge layer, $0 \\le x \\le L_s$):** $\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha(q - q^\\ast)$, where $U0$ and $\\alpha0$.\n- **Tracer:** $q(x,t)$, a one-dimensional, depth-averaged tracer.\n- **Velocity:** $U$, a constant positive barotropic velocity.\n- **Relaxation Coefficient:** $\\alpha$, a positive constant.\n- **Target Profile:** $q^\\ast(x)$, a prescribed profile.\n- **Discretization:**\n    - Grid: Uniform with spacing $\\Delta x$ and time step $\\Delta t$.\n    - Advection Term ($U \\frac{\\partial q}{\\partial x}$): First-order upstream (upwind) differencing for $U0$.\n    - Time Stepping / Relaxation Term ($-\\alpha(q-q^\\ast)$): Explicit Euler.\n- **Definitions:**\n    - Advective CFL number: $\\mu = U \\Delta t / \\Delta x$.\n    - Relaxation error: $e_j^n = q_j^n - q_j^\\ast$.\n- **Assumption:** $q^\\ast$ is sufficiently smooth that its spatial variation can be neglected over one grid cell for local stability analysis.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is analyzed against the validation criteria.\n\n- **Scientifically Grounded:** The problem describes the numerical implementation of a sponge layer with Newtonian relaxation, a standard and widely used technique in computational fluid dynamics and ocean modeling to implement open boundary conditions. The governing equation is a linear advection-reaction (or damping) equation, which is a fundamental model equation. The discretization methods (first-order upwind, explicit Euler) are standard. The problem is fundamentally sound.\n- **Well-Posed:** The problem is well-posed. It asks for the derivation of a stability and monotonicity condition for a specific, fully-defined numerical scheme. A unique condition can be derived from first principles of numerical analysis.\n- **Objective:** The language is precise, technical, and free of subjectivity. All terms are either standard in the field (e.g., CFL number, upstream differencing) or explicitly defined.\n- **No Flaws Detected:** The problem does not violate any of the invalidity criteria. It is not scientifically unsound, non-formalizable, incomplete, contradictory, unrealistic, ill-posed, or trivial. It is a well-formed question in the field of numerical methods for partial differential equations.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The solution will be derived as follows.\n\n### Derivation of the Numerical Scheme and Stability Condition\n\nThe governing partial differential equation (PDE) within the sponge layer is:\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} = -\\alpha(q - q^\\ast)\n$$\nWe are asked to analyze the evolution of the relaxation error, $e(x,t) = q(x,t) - q^\\ast(x)$. Since the target profile $q^\\ast(x)$ is assumed to be time-invariant, $\\frac{\\partial q^\\ast}{\\partial t} = 0$. The PDE for the error $e$ is found by substituting $q = e + q^\\ast$ into the governing equation:\n$$\n\\frac{\\partial (e + q^\\ast)}{\\partial t} + U \\frac{\\partial (e + q^\\ast)}{\\partial x} = -\\alpha e\n$$\n$$\n\\frac{\\partial e}{\\partial t} + U \\frac{\\partial e}{\\partial x} + U \\frac{\\partial q^\\ast}{\\partial x} = -\\alpha e\n$$\nFor the purpose of a local stability analysis, the problem states we can neglect the spatial variation of $q^\\ast$ over a grid cell. This is equivalent to setting the term $U \\frac{\\partial q^\\ast}{\\partial x}$ to zero in the local analysis. The simplified PDE for the error becomes:\n$$\n\\frac{\\partial e}{\\partial t} + U \\frac{\\partial e}{\\partial x} = -\\alpha e\n$$\nWe now discretize this equation on a uniform grid where $e_j^n \\approx e(j\\Delta x, n\\Delta t)$.\n- The time derivative $\\frac{\\partial e}{\\partial t}$ is discretized using forward (explicit) Euler: $\\frac{e_j^{n+1} - e_j^n}{\\Delta t}$.\n- The advection term $U\\frac{\\partial e}{\\partial x}$ is discretized using first-order upstream differencing. Since $U0$, the upstream direction is towards smaller $x$ (smaller index $j$), so the derivative is approximated as $U \\frac{e_j^n - e_{j-1}^n}{\\Delta x}$.\n- The relaxation term $-\\alpha e$ is treated explicitly, evaluated at time level $n$: $-\\alpha e_j^n$.\n\nSubstituting these discretizations into the error PDE gives the finite difference equation:\n$$\n\\frac{e_j^{n+1} - e_j^n}{\\Delta t} + U \\frac{e_j^n - e_{j-1}^n}{\\Delta x} = -\\alpha e_j^n\n$$\nOur goal is to find the update rule for $e_j^{n+1}$. We multiply by $\\Delta t$ and rearrange:\n$$\ne_j^{n+1} - e_j^n = -\\Delta t \\left( U \\frac{e_j^n - e_{j-1}^n}{\\Delta x} \\right) - \\alpha \\Delta t e_j^n\n$$\n$$\ne_j^{n+1} = e_j^n - \\frac{U \\Delta t}{\\Delta x} (e_j^n - e_{j-1}^n) - \\alpha \\Delta t e_j^n\n$$\nUsing the definition of the CFL number, $\\mu = \\frac{U \\Delta t}{\\Delta x}$:\n$$\ne_j^{n+1} = e_j^n - \\mu (e_j^n - e_{j-1}^n) - \\alpha \\Delta t e_j^n\n$$\nGrouping the terms by their spatial indices at time level $n$:\n$$\ne_j^{n+1} = (1 - \\mu - \\alpha \\Delta t) e_j^n + \\mu e_{j-1}^n\n$$\nThis is the single-step update equation for the error.\n\nTo ensure the update is non-oscillatory (i.e., it does not create new local maxima or minima), the scheme must be monotone. A sufficient condition for a linear scheme of this form to be monotone is that all the coefficients of the terms at time level $n$ are non-negative.\nThe coefficients are $(1 - \\mu - \\alpha \\Delta t)$ and $\\mu$.\n\n1.  **Coefficient of $e_{j-1}^n$:** We require $\\mu \\ge 0$. Since $U  0$, $\\Delta t  0$, and $\\Delta x  0$, this condition is inherently satisfied.\n2.  **Coefficient of $e_j^n$:** We require $1 - \\mu - \\alpha \\Delta t \\ge 0$.\n\nThis second condition gives the coupled constraint:\n$$\n\\alpha \\Delta t \\le 1 - \\mu\n$$\nFrom this inequality, we can infer another constraint. Since $\\alpha  0$ and $\\Delta t  0$, the left-hand side $\\alpha \\Delta t$ is positive. Therefore, the right-hand side must be non-negative:\n$$\n1 - \\mu \\ge 0 \\implies \\mu \\le 1\n$$\nThis recovers the standard Courant-Friedrichs-Lewy (CFL) stability condition for the first-order upwind scheme for pure advection.\n\nThus, the combined set of constraints to ensure a stable and non-oscillatory (monotone) update is:\n$$\n0 \\le \\mu \\le 1 \\quad \\text{and} \\quad 0 \\le \\alpha \\Delta t \\le 1 - \\mu\n$$\nWhen these conditions are met, the update for $e_j^{n+1}$ is a linear combination of $e_j^n$ and $e_{j-1}^n$ with non-negative weights that sum to $ (1 - \\mu - \\alpha \\Delta t) + \\mu = 1 - \\alpha \\Delta t$. Since $0 \\le \\alpha \\Delta t \\le 1-\\mu \\le 1$, the sum is between $0$ and $1$, indicating a damped, non-oscillatory update. Overshoots or undershoots (numerical oscillations) occur precisely when the coefficient of $e_j^n$ becomes negative, i.e., $1 - \\mu - \\alpha \\Delta t  0$, allowing for a sign change in the solution where none should exist.\n\n### Evaluation of Options\n\n**A. Overshoots and temporal grid-scale oscillations arise when the local weighting of $e_j^n$ becomes negative, i.e., when $1 - \\mu - \\alpha \\Delta t  0$. A sufficient non-oscillatory stability condition for the explicit upstream-relaxation update is $0 \\le \\mu \\le 1$ together with $0 \\le \\alpha \\Delta t \\le 1 - \\mu$, which guarantees the update is a convex combination of $e_j^n$ and $e_{j-1}^n$ with net damping.**\n- This statement accurately identifies that oscillations arise when the coefficient of $e_j^n$ becomes negative. The derived update equation is $e_j^{n+1} = (1 - \\mu - \\alpha \\Delta t) e_j^n + \\mu e_{j-1}^n$, so the coefficient is indeed $1 - \\mu - \\alpha \\Delta t$.\n- The stated condition, $0 \\le \\mu \\le 1$ and $0 \\le \\alpha \\Delta t \\le 1 - \\mu$, is precisely the condition for non-negativity of both coefficients, which ensures a monotone, non-oscillatory scheme. This condition also guarantees stability.\n- The description of the update as a \"convex combination... with net damping\" is physically and mathematically sound. The weights are non-negative, and their sum is $1 - \\alpha \\Delta t \\le 1$, which corresponds to a convex combination followed by damping.\n- **Verdict: Correct.**\n\n**B. Relaxation always stabilizes upstream advection regardless of the advective CFL number, so no overshoots can occur. The only requirement is $0 \\le \\mu \\le 1$; $\\alpha \\Delta t$ may be arbitrarily large without coupling to $\\mu$.**\n- This is incorrect. The derivation shows a direct coupling between $\\alpha \\Delta t$ and $\\mu$ via the constraint $\\alpha \\Delta t \\le 1 - \\mu$. If $\\alpha \\Delta t$ is too large (e.g., $\\alpha \\Delta t  1 - \\mu$), the coefficient of $e_j^n$ becomes negative, leading to oscillations.\n- **Verdict: Incorrect.**\n\n**C. Stronger advection always suppresses oscillations induced by relaxation, leading to the condition $\\alpha \\Delta t \\le \\mu$ for stability, with no need to impose any upper bound on $\\mu$ beyond $\\mu \\le 2$.**\n- This is incorrect. The derived condition is $\\alpha \\Delta t \\le 1 - \\mu$. Stronger advection (larger $\\mu$) makes the right side smaller, thus *tightening* the constraint on $\\alpha \\Delta t$, not suppressing oscillations. The condition $\\alpha \\Delta t \\le \\mu$ is incorrect. Furthermore, the first-order upwind scheme is unstable for $\\mu  1$; the mention of $\\mu \\le 2$ has no relevance here.\n- **Verdict: Incorrect.**\n\n**D. The correct coupled linear stability bound is $\\alpha \\Delta t \\le 2(1 - \\mu)$, which guarantees non-oscillatory decay for all resolved wavenumbers when $0 \\le \\mu \\le 1$; moreover, grid-scale overshoots cannot occur under this bound.**\n- A von Neumann stability analysis shows that the general condition for linear stability ($|G| \\le 1$) is indeed $\\alpha \\Delta t \\le 2(1 - \\mu)$ for $0 \\le \\mu \\le 1$. However, the regime $1 - \\mu  \\alpha \\Delta t \\le 2(1 - \\mu)$ is stable but *oscillatory*. The question specifically asks for a condition that is \"stable and non-oscillatory\". The condition for non-oscillatory behavior (monotonicity) is the stricter $\\alpha \\Delta t \\le 1 - \\mu$. Therefore, the claim that $\\alpha \\Delta t \\le 2(1 - \\mu)$ \"guarantees non-oscillatory decay\" is false.\n- **Verdict: Incorrect.**\n\n**E. The stability of explicit relaxation is independent of advection; to avoid oscillations one only needs $0 \\le \\alpha \\Delta t \\le 2$ and $0 \\le \\mu \\le 1$, with no further coupling constraint between $\\alpha \\Delta t$ and $\\mu$.**\n- This is incorrect. The derivation clearly establishes the coupling condition $\\alpha \\Delta t \\le 1 - \\mu$. The stability of the combined system is not simply the intersection of the stability regions of the individual components (advection and relaxation). The terms interact. The condition $\\alpha \\Delta t \\le 2$ is the stability limit for pure relaxation, but it is not sufficient when advection is present.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While simple radiation conditions are useful, their effectiveness depends on knowing the precise wave phase speed at the boundary. This exercise introduces a more advanced, data-driven approach common in adaptive boundary conditions. You will use the principle of least squares to derive a closed-form estimator for the effective phase speed from the model's own output, a foundational technique for building more robust and accurate open boundaries that can adjust to the evolving wave field .",
            "id": "3809256",
            "problem": "Consider a linear free-surface wave signal $\\phi$ in a two-dimensional coastal ocean model near an open boundary equipped with a sponge layer. The outward unit normal to the boundary is denoted by $n$. In order to impose a physically consistent radiation condition at the boundary, assume that in a thin strip adjacent to the boundary (within the sponge layer) the signal satisfies an approximate one-way form of the linear wave relation,\n$$\n\\partial_{t}\\phi + c_{n}\\,\\partial_{n}\\phi \\approx 0,\n$$\nwhere $c_{n}$ is an unknown effective outward phase speed to be inferred from data. You are given discrete samples of $\\phi$ at $J$ boundary-aligned locations $s_{j}$, with indices $j=1,\\dots,J$, at two normal positions $n_{0}=0$ (boundary) and $n_{1}=\\Delta n$ (first interior point), and at $K$ time levels $t_{k}$ with indices $k=1,\\dots,K$, where the spacings $\\Delta t0$ and $\\Delta n0$ are uniform and known. Denote the samples by $\\phi_{j,\\ell}^{k} \\equiv \\phi(s_{j},n_{\\ell},t_{k})$ for $\\ell\\in\\{0,1\\}$.\n\nDefine discrete derivatives at the boundary-aligned locations using a backward finite difference in time and a one-sided forward finite difference in the outward normal:\n$$\n(D_{t}\\phi)_{j}^{k} \\equiv \\frac{\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1}}{\\Delta t}\\quad\\text{for }k=2,\\dots,K,\\qquad (D_{n}\\phi)_{j}^{k} \\equiv \\frac{\\phi_{j,1}^{k}-\\phi_{j,0}^{k}}{\\Delta n}\\quad\\text{for }k=2,\\dots,K.\n$$\n\nAssume $c_{n}$ is constant over the chosen boundary-aligned locations and time window. By appealing to the least-squares principle applied to the radiation residual, estimate $c_{n}$ by minimizing the discrete squared two-norm of the residual $\\partial_{t}\\phi + c_{n}\\,\\partial_{n}\\phi$ over all available samples,\n$$\n\\mathcal{J}(c_{n}) \\equiv \\sum_{j=1}^{J}\\sum_{k=2}^{K}\\big((D_{t}\\phi)_{j}^{k} + c_{n}\\,(D_{n}\\phi)_{j}^{k}\\big)^{2}.\n$$\n\nDerive, from first principles, the closed-form least-squares estimator for $c_{n}$ and provide the explicit expression for $c_{n}$ written purely in terms of the discrete data $\\{\\phi_{j,\\ell}^{k}\\}$, $\\Delta t$, and $\\Delta n$ as defined above. Your final answer must be a single closed-form analytical expression for $c_{n}$. Do not include units in your final boxed answer. No numerical rounding is required.",
            "solution": "The problem requires the derivation of a closed-form least-squares estimator for the effective outward phase speed $c_{n}$ in a sponge layer. The estimator is to be found by minimizing the objective function $\\mathcal{J}(c_{n})$, which represents the discrete squared two-norm of the residual of the approximate one-way wave equation.\n\nThe provided objective function is:\n$$\n\\mathcal{J}(c_{n}) \\equiv \\sum_{j=1}^{J}\\sum_{k=2}^{K}\\big((D_{t}\\phi)_{j}^{k} + c_{n}\\,(D_{n}\\phi)_{j}^{k}\\big)^{2}\n$$\nwhere $(D_{t}\\phi)_{j}^{k}$ and $(D_{n}\\phi)_{j}^{k}$ are the discrete approximations of the time and normal derivatives, respectively. The parameter to be estimated is $c_{n}$.\n\nThe principle of least squares dictates that the optimal value of $c_{n}$ is the one that minimizes the function $\\mathcal{J}(c_{n})$. Since $\\mathcal{J}(c_{n})$ is a continuously differentiable function of $c_{n}$, a necessary condition for a minimum is that its first derivative with respect to $c_{n}$ is zero.\n$$\n\\frac{d\\mathcal{J}}{dc_{n}} = 0\n$$\nWe compute the derivative of $\\mathcal{J}(c_{n})$ with respect to $c_{n}$. The differentiation can be performed inside the summation:\n$$\n\\frac{d\\mathcal{J}}{dc_{n}} = \\sum_{j=1}^{J}\\sum_{k=2}^{K} \\frac{d}{dc_{n}}\\left[ \\big((D_{t}\\phi)_{j}^{k} + c_{n}\\,(D_{n}\\phi)_{j}^{k}\\big)^{2} \\right]\n$$\nUsing the chain rule, where the inner function is $u = (D_{t}\\phi)_{j}^{k} + c_{n}\\,(D_{n}\\phi)_{j}^{k}$ and the outer function is $u^2$, we have $\\frac{d(u^2)}{dc_n} = 2u \\frac{du}{dc_n}$. Here, $\\frac{du}{dc_n} = (D_{n}\\phi)_{j}^{k}$.\n$$\n\\frac{d\\mathcal{J}}{dc_{n}} = \\sum_{j=1}^{J}\\sum_{k=2}^{K} 2 \\big((D_{t}\\phi)_{j}^{k} + c_{n}\\,(D_{n}\\phi)_{j}^{k}\\big) (D_{n}\\phi)_{j}^{k} = 0\n$$\nWe can divide by the constant $2$ and distribute the $(D_{n}\\phi)_{j}^{k}$ term:\n$$\n\\sum_{j=1}^{J}\\sum_{k=2}^{K} \\left[ (D_{t}\\phi)_{j}^{k} (D_{n}\\phi)_{j}^{k} + c_{n} \\big((D_{n}\\phi)_{j}^{k}\\big)^{2} \\right] = 0\n$$\nNext, we split the summation and isolate the terms containing $c_{n}$:\n$$\n\\sum_{j=1}^{J}\\sum_{k=2}^{K} (D_{t}\\phi)_{j}^{k} (D_{n}\\phi)_{j}^{k} + c_{n} \\sum_{j=1}^{J}\\sum_{k=2}^{K} \\big((D_{n}\\phi)_{j}^{k}\\big)^{2} = 0\n$$\nSolving for $c_{n}$, we obtain the estimator in terms of the discrete derivatives:\n$$\nc_{n} = - \\frac{\\sum_{j=1}^{J}\\sum_{k=2}^{K} (D_{t}\\phi)_{j}^{k} (D_{n}\\phi)_{j}^{k}}{\\sum_{j=1}^{J}\\sum_{k=2}^{K} \\big((D_{n}\\phi)_{j}^{k}\\big)^{2}}\n$$\nNote that this expression is valid provided that the denominator is non-zero, which is true as long as the normal derivative approximation is not identically zero for all data points. This is physically expected for a dynamic wave signal. The second derivative, $\\frac{d^2\\mathcal{J}}{dc_n^2} = 2 \\sum_{j=1}^{J}\\sum_{k=2}^{K} \\big((D_{n}\\phi)_{j}^{k}\\big)^{2}$, is positive, confirming that this stationary point is indeed a minimum.\n\nNow, we substitute the given definitions for the discrete derivatives:\n$$\n(D_{t}\\phi)_{j}^{k} \\equiv \\frac{\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1}}{\\Delta t} \\quad \\text{and} \\quad (D_{n}\\phi)_{j}^{k} \\equiv \\frac{\\phi_{j,1}^{k}-\\phi_{j,0}^{k}}{\\Delta n}\n$$\nSubstituting these into the numerator's summand:\n$$\n(D_{t}\\phi)_{j}^{k} (D_{n}\\phi)_{j}^{k} = \\left(\\frac{\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1}}{\\Delta t}\\right) \\left(\\frac{\\phi_{j,1}^{k}-\\phi_{j,0}^{k}}{\\Delta n}\\right) = \\frac{1}{\\Delta t \\Delta n} (\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1})(\\phi_{j,1}^{k}-\\phi_{j,0}^{k})\n$$\nAnd into the denominator's summand:\n$$\n\\big((D_{n}\\phi)_{j}^{k}\\big)^{2} = \\left(\\frac{\\phi_{j,1}^{k}-\\phi_{j,0}^{k}}{\\Delta n}\\right)^{2} = \\frac{1}{(\\Delta n)^{2}} (\\phi_{j,1}^{k}-\\phi_{j,0}^{k})^{2}\n$$\nNow, substitute these back into the expression for $c_{n}$:\n$$\nc_{n} = - \\frac{\\sum_{j=1}^{J}\\sum_{k=2}^{K} \\frac{1}{\\Delta t \\Delta n} (\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1})(\\phi_{j,1}^{k}-\\phi_{j,0}^{k})}{\\sum_{j=1}^{J}\\sum_{k=2}^{K} \\frac{1}{(\\Delta n)^{2}} (\\phi_{j,1}^{k}-\\phi_{j,0}^{k})^{2}}\n$$\nThe constants $\\Delta t$ and $\\Delta n$ can be factored out of the summations:\n$$\nc_{n} = - \\frac{\\frac{1}{\\Delta t \\Delta n} \\sum_{j=1}^{J}\\sum_{k=2}^{K} (\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1})(\\phi_{j,1}^{k}-\\phi_{j,0}^{k})}{\\frac{1}{(\\Delta n)^{2}} \\sum_{j=1}^{J}\\sum_{k=2}^{K} (\\phi_{j,1}^{k}-\\phi_{j,0}^{k})^{2}}\n$$\nSimplifying the constant factor pre-multiplying the ratio of sums:\n$$\n\\frac{\\frac{1}{\\Delta t \\Delta n}}{\\frac{1}{(\\Delta n)^{2}}} = \\frac{1}{\\Delta t \\Delta n} \\cdot \\frac{(\\Delta n)^{2}}{1} = \\frac{\\Delta n}{\\Delta t}\n$$\nThus, the final closed-form expression for the least-squares estimator $c_{n}$ is:\n$$\nc_{n} = - \\frac{\\Delta n}{\\Delta t} \\frac{\\sum_{j=1}^{J}\\sum_{k=2}^{K} (\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1})(\\phi_{j,1}^{k}-\\phi_{j,0}^{k})}{\\sum_{j=1}^{J}\\sum_{k=2}^{K} (\\phi_{j,1}^{k}-\\phi_{j,0}^{k})^{2}}\n$$\nThis expression is written purely in terms of the discrete data samples $\\{\\phi_{j,\\ell}^{k}\\}$ and the known spacings $\\Delta t$ and $\\Delta n$, as required.",
            "answer": "$$\n\\boxed{- \\frac{\\Delta n}{\\Delta t} \\frac{\\sum_{j=1}^{J}\\sum_{k=2}^{K} (\\phi_{j,0}^{k}-\\phi_{j,0}^{k-1})(\\phi_{j,1}^{k}-\\phi_{j,0}^{k})}{\\sum_{j=1}^{J}\\sum_{k=2}^{K} (\\phi_{j,1}^{k}-\\phi_{j,0}^{k})^{2}}}\n$$"
        }
    ]
}