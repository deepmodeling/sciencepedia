{
    "hands_on_practices": [
        {
            "introduction": "Gent-McWilliams (GM) 参数化的核心思想是，涡旋引起的输运主要沿着等浮力面（或等密度面）发生。因此，理解这些表面的几何形态是掌握该参数化的第一步。本练习将引导你通过一个理想化的场景，从最基本的流体静力学原理出发，推导出等密度面的斜率，揭示其与垂向分层和横向浮力梯度之间的直接定量关系。",
            "id": "3793909",
            "problem": "在 Gent-McWilliams (GM) 涡旋参数化中，中尺度涡效应被表示为沿着等浮力面（在 Boussinesq 框架下常称为等密度面）的平流输运。考虑一个稳定层化的海洋内部，其中浮力场 $b(x,y,z)$ 是光滑的，并且通过垂直梯度 $N^{2} \\equiv \\partial_{z} b$ 定义了浮力频率的平方 $N^{2}$。一个等密度面（等浮力面）由满足 $\\mathrm{d}b = 0$ 的微分位移 $(\\mathrm{d}x,\\mathrm{d}y,\\mathrm{d}z)$ 来表征。$x$ 方向的等密度面斜率定义为 $s_{x} \\equiv \\left(\\partial z / \\partial x\\right)_{b}$，即沿着等浮力面，深度随水平距离的变化率。\n\n假设存在一个与稳定层化一致的局部线性浮力结构，由 $b(z) = N^{2} z$（其中常数 $N^{2} > 0$）和一个均匀的侧向浮力梯度 $\\partial_{x} b = \\alpha$（其中 $\\alpha$ 是一个给定的常数）给出。仅使用等密度面是常数 $b$ 的曲面这一看以及标准多元微积分，推导以 $\\alpha$ 和 $N^{2}$ 表示的等密度面斜率 $s_{x}$。然后，根据你推导出的表达式，解释 $s_{x}$ 的符号如何依赖于 $\\alpha$ 的符号，并评论在稳定层化流中 $|s_{x}|$ 的大小与 $|\\alpha|$ 和 $N^{2}$ 的关系。将 $s_{x}$ 的最终答案表示为以 $\\alpha$ 和 $N^{2}$ 表示的单个闭合形式的解析表达式。无需进行数值计算；最终表达式中不应包含单位。",
            "solution": "该问题是有效的，因为它具有物理海洋学的科学基础，是适定且客观的。它提供了一组一致的定义和假设，通过标准的数学程序可以从中推导出一个唯一的、有意义的解。该问题要求根据侧向浮力梯度 $\\alpha$ 和浮力频率的平方 $N^2$ 来推导等密度面斜率 $s_x$。\n\n推导从等密度面的基本定义开始，即浮力 $b$ 为常数的曲面。对于一个依赖于空间坐标的浮力场 $b(x, y, z)$，等密度面由方程 $b(x, y, z) = C$ 描述，其中 $C$ 是一个常数。\n\n浮力的微分变化 $\\mathrm{d}b$ 可以用全微分表示：\n$$\n\\mathrm{d}b = \\frac{\\partial b}{\\partial x} \\mathrm{d}x + \\frac{\\partial b}{\\partial y} \\mathrm{d}y + \\frac{\\partial b}{\\partial z} \\mathrm{d}z\n$$\n根据定义，沿着等密度面，浮力是恒定的，这意味着其全微分为零：\n$$\n\\mathrm{d}b = 0\n$$\n问题将 $x$ 方向的等密度面斜率 $s_x$ 定义为 $s_x \\equiv (\\partial z / \\partial x)_b$。这表示在保持浮力 $b$ 恒定的曲面上，深度 $z$ 相对于水平位置 $x$ 的变化。为了求得此量，我们通过设置 $\\mathrm{d}y = 0$ 来考虑纯粹在 $x$-$z$ 平面内的位移。$\\mathrm{d}b = 0$ 的条件于是简化为：\n$$\n\\frac{\\partial b}{\\partial x} \\mathrm{d}x + \\frac{\\partial b}{\\partial z} \\mathrm{d}z = 0\n$$\n这个方程关联了为保持在等密度面上所需的微分位移 $\\mathrm{d}x$ 和 $\\mathrm{d}z$。我们可以重新排列这个方程来求得沿该曲面的斜率 $\\mathrm{d}z/\\mathrm{d}x$。\n$$\n\\frac{\\partial b}{\\partial z} \\mathrm{d}z = - \\frac{\\partial b}{\\partial x} \\mathrm{d}x\n$$\n假设 $\\partial b / \\partial z \\neq 0$（这一点由稳定层化条件 $N^2 > 0$ 保证），我们可以除以 $\\mathrm{d}x$ 和 $\\partial b / \\partial z$ 来获得斜率：\n$$\n\\frac{\\mathrm{d}z}{\\mathrm{d}x} = - \\frac{\\partial b / \\partial x}{\\partial b / \\partial z}\n$$\n这个在 $x$-$z$ 平面中沿着常数 $b$ 曲线的斜率表达式，恰好是保持 $b$ 恒定时 $z$ 对 $x$ 的偏导数的定义。因此，我们有：\n$$\ns_x = \\left(\\frac{\\partial z}{\\partial x}\\right)_{b} = - \\frac{\\partial b / \\partial x}{\\partial b / \\partial z}\n$$\n问题提供了计算此表达式所需的要素。在 $x$ 方向上的均匀侧向浮力梯度由下式给出：\n$$\n\\frac{\\partial b}{\\partial x} = \\alpha\n$$\n浮力频率的平方，一个衡量垂直层化程度的量，定义并给出为：\n$$\nN^2 \\equiv \\frac{\\partial b}{\\partial z}\n$$\n问题指出 $N^2$ 是一个正常数，这与稳定层化的假设一致。将这些给定的量代入 $s_x$ 的表达式，得到最终结果：\n$$\ns_x = - \\frac{\\alpha}{N^2}\n$$\n这个表达式给出了以给定常数 $\\alpha$ 和 $N^2$ 表示的等密度面斜率 $s_x$。\n\n基于这个推导出的表达式，我们可以分析斜率的性质：\n\n1.  **$s_x$ 的符号**：问题指明层化是稳定的，这意味着 $N^2 > 0$。因此，等密度面斜率 $s_x$ 的符号完全由侧向浮力梯度 $\\alpha$ 的符号决定。具体来说，$s_x$ 的符号与 $\\alpha$ 相反。\n    *   如果 $\\alpha > 0$，意味着浮力在正 $x$ 方向上增加（例如，水变得更不密集），那么 $s_x < 0$。这表明当向正 $x$ 方向移动时，等密度面向下倾斜。为了保持在等浮力面上，必须移动到更深的深度（如果 $z$ 向上为正，则为更负的 $z$），那里的背景浮力较低，以补偿来自侧向梯度的增加。\n    *   如果 $\\alpha < 0$，意味着浮力在正 $x$ 方向上减小，那么 $s_x > 0$。这表明等密度面在正 $x$ 方向上向上倾斜。\n\n2.  **$|s_x|$ 的大小**：斜率的大小由 $|s_x| = \\frac{|\\alpha|}{N^2}$ 给出。\n    *   斜率的大小与侧向浮力梯度的大小 $|\\alpha|$ 成正比。更强的水平浮力差异需要更陡峭的斜率来维持恒定的浮力值。\n    *   斜率的大小与浮力频率的平方 $N^2$ 成反比。更大的 $N^2$ 表示更强的垂直层化，意味着浮力随深度变化更快。在这样的流体中，只需要一个较小的垂直位移来抵消给定的水平浮力变化，从而导致一个更平缓（不那么陡峭）的等密度面斜率。在典型的海洋条件下，水平浮力梯度的大小远小于垂直层化，即 $|\\alpha| \\ll N^2$。因此，等密度面斜率 $|s_x|$ 通常非常小，量级在 $10^{-4}$ 到 $10^{-2}$ 之间，这表明等密度面几乎是水平的。",
            "answer": "$$\n\\boxed{-\\frac{\\alpha}{N^{2}}}\n$$"
        },
        {
            "introduction": "在建立了等密度面的几何概念后，我们接下来需要量化涡旋混合的强度，这在 GM 参数化中由涡旋扩散系数 $K$ 来表示。这个练习旨在揭开 $K$ 的神秘面纱，它将指导你使用经典的混合长度理论，将这个看似抽象的参数与中尺度涡旋的物理尺度——即涡旋的特征尺寸 $l$ 和速度 $U_e$——联系起来。通过这种方式，你将为这个关键参数建立起一个坚实的物理直觉。",
            "id": "3793926",
            "problem": "在无法解析中尺度涡的大尺度海洋环流模型中，Gent-McWilliams涡旋参数化方案（GM）通过涡致（平流）输运和相关的等密度面厚度扩散率来表示示踪物沿等密度面的侧向搅拌。考虑一个浓度场为 $c(\\mathbf{x},t)$ 的被动示踪物，它在一个不可压缩速度场 $\\mathbf{u}(\\mathbf{x},t)$ 的作用下，在近似等密度面上被输运。从被动示踪物的平流和雷诺分解（将物理量分解为平均部分和脉动部分，即 $\\mathbf{u} = \\overline{\\mathbf{u}} + \\mathbf{u}'$ 和 $c = \\overline{c} + c'$) 出发，并考虑等密度面涡旋输运的标准顺梯度通量闭合，其中涡通量被建模为 $\\overline{\\mathbf{u}' c'} \\approx - K \\nabla_{\\sigma} \\overline{c}$，这里 $K$ 是一个等密度面涡扩散率，$\\nabla_{\\sigma}$ 表示沿等密度面的梯度。使用混合长度理论以及对涡速度和示踪物脉动量级的物理解释，推导 $K$ 关于等密度面涡混合长度 $l$ 和涡速度尺度 $U_{e}$ 的数量级表达式。然后，使用符合实际的中尺度数值 $l = 30\\,\\mathrm{km}$ 和 $U_{e} = 0.1\\,\\mathrm{m\\,s^{-1}}$ 来计算 $K$。将你的数值答案保留三位有效数字，并以 $\\mathrm{m^{2}\\,s^{-1}}$ 为单位表示最终的扩散率。",
            "solution": "该问题要求基于混合长度理论推导等密度面涡扩散率 $K$ 的数量级表达式，并进行随后的数值计算。\n\n出发点是被动示踪物 $c$ 的雷诺平均平流。未解析涡的影响表现为一个涡通量项 $\\overline{\\mathbf{u}' c'}$，其中 $\\mathbf{u}'$ 和 $c'$ 分别是速度和示踪物浓度的脉动部分。问题为此项提供了一个顺梯度通量闭合，将其与沿等密度面的平均示踪物梯度 $\\nabla_{\\sigma} \\overline{c}$ 联系起来：\n$$\n\\overline{\\mathbf{u}' c'} \\approx -K \\nabla_{\\sigma} \\overline{c} \\quad (1)\n$$\n我们的目标是利用物理论证来推导 $K$ 的表达式。\n\n我们采用混合长度理论，这是湍流模拟中的一个经典概念。该理论假定，一个流体包裹在与其新环境混合之前，会在一个称为混合长度的特征位移距离内保持其属性（在这里是示踪物浓度）不变。让我们考虑一个被向量 $\\mathbf{l}'$ 位移的流体包裹。该包裹相对于其新环境所代表的浓度异常 $c'$ 是由平均浓度梯度 $\\nabla_{\\sigma} \\overline{c}$ 引起的。对于小位移，这个异常可以用泰勒展开的一阶项来近似：\n$$\nc' \\approx - \\mathbf{l}' \\cdot \\nabla_{\\sigma} \\overline{c}\n$$\n负号表示，一个源自浓度高于平均值区域（$\\mathbf{l}' \\cdot \\nabla_{\\sigma} \\overline{c} < 0$）的流体包裹在其新位置将具有正异常（$c' > 0$）。\n\n将 $c'$ 的这个表达式代入涡通量项，得到：\n$$\n\\overline{\\mathbf{u}' c'} \\approx \\overline{\\mathbf{u}' (-\\mathbf{l}' \\cdot \\nabla_{\\sigma} \\overline{c})}\n$$\n假设平均梯度 $\\nabla_{\\sigma} \\overline{c}$ 在涡的空间尺度上近似恒定，那么在平均运算中可以将其视为常数：\n$$\n\\overline{\\mathbf{u}' c'} \\approx - \\left( \\overline{\\mathbf{u}' \\otimes \\mathbf{l}'} \\right) \\nabla_{\\sigma} \\overline{c}\n$$\n其中 $\\otimes$ 代表张量（或外）积。项 $\\overline{\\mathbf{u}' \\otimes \\mathbf{l}'}$ 是一个表示涡输运系数的二阶张量。\n\n为了进行数量级分析，我们可以使用所涉及各量的特征尺度。设 $U_e$ 为涡速度的特征量级，$U_e \\sim |\\mathbf{u}'|$，设 $l$ 为特征混合长度，$l \\sim |\\mathbf{l}'|$。假设涡速度和涡浓度脉动的量级是相关的。浓度脉动的量级可表示为：\n$$\n|c'| \\sim l |\\nabla_{\\sigma} \\overline{c}|\n$$\n于是，涡通量的量级可表示为特征涡速度与特征浓度脉动的乘积：\n$$\n|\\overline{\\mathbf{u}' c'}| \\sim U_e |c'| \\sim U_e l |\\nabla_{\\sigma} \\overline{c}|\n$$\n由于通量是“顺梯度”的，其方向与梯度相反。因此，我们用负号来书写这个矢量关系，这与我们之前的推导是一致的：\n$$\n\\overline{\\mathbf{u}' c'} \\sim - (l U_e) \\nabla_{\\sigma} \\overline{c} \\quad (2)\n$$\n这个表达式提供了基于混合长度理论的涡通量标度关系。\n\n通过将此结果（2）与所给的通量-梯度关系（1）进行比较，我们可以确定涡扩散率 $K$：\n$$\nK \\sim l U_e\n$$\n这就是所求的 $K$ 关于等密度面涡混合长度 $l$ 和涡速度尺度 $U_e$ 的数量级表达式。\n\n问题的第二部分是利用给定的数值计算 $K$：\n等密度面涡混合长度，$l = 30\\,\\mathrm{km}$。\n涡速度尺度，$U_e = 0.1\\,\\mathrm{m\\,s^{-1}}$。\n\n为保持单位一致，我们必须将所有量用国际单位制（SI）表示。我们将混合长度从千米转换为米：\n$$\nl = 30\\,\\mathrm{km} = 30 \\times 10^3\\,\\mathrm{m} = 3 \\times 10^4\\,\\mathrm{m}\n$$\n涡速度已用国际单位制给出：\n$$\nU_e = 0.1\\,\\mathrm{m\\,s^{-1}} = 1 \\times 10^{-1}\\,\\mathrm{m\\,s^{-1}}\n$$\n现在，我们可以计算 $K$ 的数值：\n$$\nK = l U_e = (3 \\times 10^4\\,\\mathrm{m}) \\times (1 \\times 10^{-1}\\,\\mathrm{m\\,s^{-1}})\n$$\n$$\nK = 3 \\times 10^{3}\\,\\mathrm{m^2\\,s^{-1}} = 3000\\,\\mathrm{m^2\\,s^{-1}}\n$$\n问题要求将结果保留三位有效数字。为了表示这个精度，我们用科学记数法来书写结果：\n$$\nK = 3.00 \\times 10^3\\,\\mathrm{m^2\\,s^{-1}}\n$$\n这个值是粗分辨率海洋模型中用于参数化中尺度涡影响的等密度面涡扩散率的一个典型估值。",
            "answer": "$$\\boxed{3.00 \\times 10^{3}}$$"
        },
        {
            "introduction": "最后的这个实践练习将前面的概念整合到一个更完整、更接近实际的计算海洋学模型场景中。它要求你超越简单的公式推导，亲手实现并对比两种不同的 GM 参数化方案：一种是使用常数扩散系数的标准方法，另一种是考虑了能量收支平衡的先进版本。通过分析和比较它们对大尺度环流（如剩余翻转环流）和海洋能量收支的影响，你将深刻理解参数化方案的选择如何在根本上影响气候模型的模拟结果。",
            "id": "3793967",
            "problem": "考虑一个纬向周期性、满足 Boussinesq 近似和静力平衡的海洋通道，其经向坐标为 $y \\in [0,W]$，垂直坐标为 $z \\in [0,H]$，纬向长度为 $L_x$。Gent-McWilliams 涡旋参数化（Gent-McWilliams (GM)）通过一种涡致（bolus）输运来表示未解析的涡旋效应，该输运作用是沿等密度面平流示踪物。在变换欧拉平均框架中，剩余翻转流函数 $\\Psi^{\\mathrm{res}}(y,z)$ 等于欧拉平均流函数 $\\Psi^{\\mathrm{E}}(y,z)$ 与 GM bolus 流函数 $\\Psi^{\\mathrm{GM}}(y,z)$ 之和。假设 $\\Psi^{\\mathrm{E}}(y,z)=0$，因此 $\\Psi^{\\mathrm{res}}(y,z)=\\Psi^{\\mathrm{GM}}(y,z)$。\n\n您需要将标准的恒定厚度扩散率 GM 方案与一个变体进行比较，该变体中的厚度扩散率受到给定能量收支的约束。此比较必须基于第一性原理。仅从以下基本依据和核心定义开始：\n\n- Boussinesq 浮力为 $b = -g \\rho' / \\rho_0$，其中 $g$ 是重力加速度，$\\rho'$ 是密度扰动，$\\rho_0$ 是一个恒定的参考密度。\n- Brunt–Väisälä 频率满足 $N^2 = \\partial b / \\partial z$。\n- 经向的等密度面斜率为 $s(y,z) = \\partial \\eta(y,z) / \\partial y$，其中 $\\eta(y,z)$ 是等密度面相对于一个平坦参考面的位移。\n- 对于小位移，有效势能（APE）密度为 $e_p = \\tfrac{1}{2} \\rho_0 N^2 \\eta^2$。\n- GM 中的涡致 bolus 输运由一个流函数 $\\Psi^{\\mathrm{GM}}(y,z)$ 表示，其大小必须从示踪物平流扩散方程和等密度面几何形态中推导出来，以确保量纲一致性并与厚度扩散率的作用相符。\n\n基于这些依据，推导：\n\n1. 在二维 $(y,z)$ 结构下，GM bolus 流函数 $\\Psi^{\\mathrm{GM}}(y,z)$ 关于厚度扩散率 $K$ 和等密度面斜率场 $s(y,z)$ 的量纲一致表达式，并将沿纬向积分的总经向翻转强度定义为一个单位为 $\\mathrm{m}^3\\mathrm{s}^{-1}$ 的输运量。\n\n2. 全域积分的、由 GM bolus 输运引起的 APE 耗散率的表达式，用 $K$、$N^2$ 和 $s$ 表示，单位为 $\\mathrm{W}$。\n\n3. 一个能量约束的厚度扩散率 $K_{\\mathrm{energy}}$，其通过施加 GM 引起的 APE 耗散率等于给定的风功输入 $P_w$ 这一约束条件获得，并受上限 $K_{\\max}$ 的限制，因此 $K_{\\mathrm{energy}} = \\min\\left(K_{\\max}, \\text{从能量约束中推导出的值}\\right)$。\n\n然后，在一个具有给定稳定等密度面斜率场\n$$\ns(y,z) = s_0 \\exp\\left(-\\frac{(y - W/2)^2}{2 \\sigma^2}\\right)\\cos\\left(\\frac{\\pi z}{H}\\right),\n$$\n和恒定层结 $N(z) = N_0$ 的纬向通道中，对这些表达式进行数值实现。在 $y$ 和 $z$ 方向使用均匀网格来近似所有需要的积分和最大值。具体来说，使用 $N_y=200$ 和 $N_z=100$ 个网格点。设 $\\Delta y = W/(N_y-1)$ 和 $\\Delta z = H/(N_z-1)$，并通过网格上的黎曼和来近似域积分。\n\n对于每个测试案例，计算：\n\n- 恒定 $K$ 的 GM 方案的最大剩余翻转输运强度，定义为 $L_x \\max_{y,z} \\left|\\Psi^{\\mathrm{GM}}(y,z)\\right|$，单位为 $\\mathrm{m}^3\\mathrm{s}^{-1}$。\n- 能量约束方案的最大剩余翻转输运强度，定义为 $L_x \\max_{y,z} \\left|\\Psi^{\\mathrm{GM}}(y,z)\\right|$，其中 $K=K_{\\mathrm{energy}}$，单位为 $\\mathrm{m}^3\\mathrm{s}^{-1}$。\n- 恒定 $K$ 的 GM 方案的全域积分 APE 耗散率，单位为 $\\mathrm{W}$。\n- 能量约束方案的全域积分 APE 耗散率，单位为 $\\mathrm{W}$。\n\n设计程序以评估以下一组符合物理现实的参数值的测试套件：\n\n- 案例 1（一般情况，中等层结和风功率）：\n  - $W = 1.0\\times 10^{6}\\ \\mathrm{m}$, $H = 4.0\\times 10^{3}\\ \\mathrm{m}$, $L_x = 2.0\\times 10^{6}\\ \\mathrm{m}$,\n  - $\\rho_0 = 1025\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$, $g = 9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$,\n  - $N_0 = 1.0\\times 10^{-3}\\ \\mathrm{s}^{-1}$,\n  - $s_0 = 1.0\\times 10^{-3}$, $\\sigma = W/4$,\n  - $K_{\\mathrm{const}} = 1.0\\times 10^{3}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$,\n  - $P_w = 5.0\\times 10^{9}\\ \\mathrm{W}$,\n  - $K_{\\max} = 3.0\\times 10^{3}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$。\n- 案例 2（边界情况，零风功）：\n  - 与案例 1 相同，但 $P_w = 0\\ \\mathrm{W}$。\n- 案例 3（极端情况，弱层结需要被 $K_{\\max}$ 限制）：\n  - 与案例 1 相同，但 $N_0 = 2.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果，顺序如下\n$$\n[\\psi_{\\mathrm{const},1},\\ \\psi_{\\mathrm{energy},1},\\ D_{\\mathrm{const},1},\\ D_{\\mathrm{energy},1},\\ \\psi_{\\mathrm{const},2},\\ \\psi_{\\mathrm{energy},2},\\ D_{\\mathrm{const},2},\\ D_{\\mathrm{energy},2},\\ \\psi_{\\mathrm{const},3},\\ \\psi_{\\mathrm{energy},3},\\ D_{\\mathrm{const},3},\\ D_{\\mathrm{energy},3}],\n$$\n其中每个 $\\psi$ 是最大剩余翻转输运量（单位 $\\mathrm{m}^3\\mathrm{s}^{-1}$），每个 $D$ 是 APE 耗散率（单位 $\\mathrm{W}$）。不应打印任何其他文本。所有引入的角度（如有）必须以弧度为单位。所有带物理单位的量都必须以上述指定单位进行计算和理解。",
            "solution": "用户在物理海洋学领域提供了一个定义明确、有科学依据的问题。要求是推导与 Gent–McWilliams (GM) 涡旋参数化方案相关的基本表达式，然后进行数值实现以分析三个测试案例。验证确认了问题的完整性，我将开始解答。\n\n解答分为三个部分：\n1. GM Bolus 流函数 $\\Psi^{\\mathrm{GM}}$ 的推导。\n2. 全域积分的有效势能（APE）耗散率 $D$ 的推导。\n3. 能量约束的厚度扩散率 $K_{\\mathrm{energy}}$ 的推导。\n在这些推导之后，将总结数值实现方法。\n\n### 1. GM Bolus 流函数 $\\Psi^{\\mathrm{GM}}$ 的推导\n\nGent-McWilliams 参数化将次网格尺度涡旋的效应模拟为由涡致（bolus）速度场 $\\vec{u}^* = (v^*, w^*)$ 在经向-垂直 $(y,z)$ 平面上对示踪物的平流。该速度场是无辐散的，因此可以定义一个流函数 $\\Psi^{\\mathrm{GM}}(y,z)$，使得：\n$$\nv^*(y,z) = -\\frac{\\partial \\Psi^{\\mathrm{GM}}}{\\partial z} \\quad \\text{和} \\quad w^*(y,z) = \\frac{\\partial \\Psi^{\\mathrm{GM}}}{\\partial y}\n$$\nGM 方案的物理原理是涡旋作用于使等密度面（即等浮力 $b$ 的面）变平。这被参数化为等密度层厚度的扩散。此过程在欧拉坐标系中的数学表示，给出了 bolus 流函数 $\\Psi^{\\mathrm{GM}}$ 和等密度面斜率 $s(y,z)$ 之间的直接关系。标准公式为：\n$$\n\\Psi^{\\mathrm{GM}}(y,z) = -K s(y,z)\n$$\n其中 $K$ 是涡旋厚度扩散率，单位为 $\\mathrm{m}^2\\mathrm{s}^{-1}$，$s$ 是无量纲的等密度面斜率，定义为 $s(y,z) = \\partial \\eta / \\partial y$，其中 $\\eta$ 是等密度面的垂直位移。\n\n流函数 $\\Psi^{\\mathrm{GM}}$ 的单位是 $\\mathrm{m}^2\\mathrm{s}^{-1}$，表示单位纬向长度的体积输运。对于一个纬向长度为 $L_x$ 的通道，总经向翻转输运由 $L_x \\Psi^{\\mathrm{GM}}$ 给出，单位为 $\\mathrm{m}^3\\mathrm{s}^{-1}$。问题要求计算该量的最大强度，即 $L_x \\max_{y,z} \\left|\\Psi^{\\mathrm{GM}}(y,z)\\right|$。\n\n### 2. APE 耗散率 $D$ 的推导\n\n有效势能（APE）是可以转化为动能的那部分势能。涡旋可以产生或耗散 APE。在 GM 框架中，涡旋通过使等密度面变平来减小平均 APE。这个过程通过涡旋浮力通量所做的功的速率来量化。\n\n由涡旋产生的单位体积 APE 生成率由 $\\rho_0 \\overline{w'b'}$ 给出，其中 $\\overline{w'b'}$ 是垂直涡旋浮力通量。在 GM 参数化中，此通量与等密度面斜率 $s$ 和背景层结有关，背景层结由 Brunt–Väisälä 频率的平方 $N^2 = \\partial b / \\partial z$ 来量化。浮力的垂直涡旋通量由下式给出：\n$$\n\\overline{w'b'} = -K s^2 N^2\n$$\n此表达式是负定的（因为 $K>0$, $N^2 \\ge 0$），表明参数化的涡旋总是从平均态中提取能量，导致 APE 的耗散。因此，APE 的耗散率是正的。\n\n全域积分的总 APE 耗散率 $D$ 是通过在整个流体体积 $V$ 上对此表达式的负值进行积分得到的：\n$$\nD = -\\iiint_V \\rho_0 \\overline{w'b'} \\, dV = -\\int_0^{L_x} \\int_0^W \\int_0^H \\rho_0 (-K s^2 N^2) \\, dz \\, dy \\, dx\n$$\n由于问题在纬向上是均匀的，对 $x$ 的积分变成了乘以通道长度 $L_x$：\n$$\nD = \\rho_0 L_x \\int_0^W \\int_0^H K s(y,z)^2 N(z)^2 \\, dz \\, dy\n$$\n$D$ 的单位是瓦特（$\\mathrm{W}$），符合要求：$(\\mathrm{kg}\\,\\mathrm{m}^{-3}) \\cdot \\mathrm{m} \\cdot (\\mathrm{m}^2\\mathrm{s}^{-1}) \\cdot (\\mathrm{s}^{-2}) \\cdot \\mathrm{m} \\cdot \\mathrm{m} = \\mathrm{kg}\\,\\mathrm{m}^2\\mathrm{s}^{-3} = \\mathrm{J}\\,\\mathrm{s}^{-1}$。\n\n### 3. 能量约束的扩散率 $K_{\\mathrm{energy}}$ 的推导\n\n一个能量上一致的参数化方案要求，由参数化涡旋耗散的能量与供给系统的能量相平衡。在这里，我们施加约束，使总 APE 耗散率 $D$ 等于给定的风功率输入 $P_w$。我们假设能量约束的扩散率 $K_{\\mathrm{energy}}$ 是一个空间上恒定的参数。\n\n设 $D = P_w$，并使用第 2 部分中 $D$ 的表达式，其中 $K = K_{\\mathrm{energy}}$：\n$$\nP_w = \\rho_0 L_x \\int_0^W \\int_0^H K_{\\mathrm{energy}} s(y,z)^2 N(z)^2 \\, dz \\, dy\n$$\n由于 $K_{\\mathrm{energy}}$ 是常数，可以从积分中提出：\n$$\nP_w = K_{\\mathrm{energy}} \\left( \\rho_0 L_x \\int_0^W \\int_0^H s(y,z)^2 N(z)^2 \\, dz \\, dy \\right)\n$$\n解出 $K_{\\mathrm{energy}}$ 得到未约束的值：\n$$\nK_{\\mathrm{energy}}^\\text{unconstrained} = \\frac{P_w}{\\rho_0 L_x \\int_0^W \\int_0^H s(y,z)^2 N(z)^2 \\, dz \\, dy}\n$$\n该值必须受到一个物理上合理的上限 $K_{\\max}$ 的约束，因为扩散率不能任意大。因此，$K_{\\mathrm{energy}}$ 的最终表达式为：\n$$\nK_{\\mathrm{energy}} = \\min\\left(K_{\\max}, K_{\\mathrm{energy}}^\\text{unconstrained}\\right)\n$$\n如果 $P_w=0$，这将正确地得出 $K_{\\mathrm{energy}}=0$。如果层结 $N$ 非常弱，分母会变小，导致一个很大的 $K_{\\mathrm{energy}}^\\text{unconstrained}$，它将被上限 $K_{\\max}$ 所限制。\n\n### 数值实现\n\n对推导出的表达式进行数值实现。\n1.  为 $(y,z)$ 构建一个具有 $N_y=200$ 和 $N_z=100$ 个点的均匀二维网格，网格间距为 $\\Delta y = W/(N_y-1)$ 和 $\\Delta z = H/(N_z-1)$。\n2.  在每个网格点上计算等密度面斜率场 $s(y,z)$ 和层结场 $N^2(z)$。\n3.  对于恒定 $K$ 方案，$\\Psi^{\\mathrm{GM}}$ 计算为 $-K_{\\mathrm{const}}s$。最大输运量 $\\psi_{\\mathrm{const}}$ 通过在网格上取 $L_x \\Psi^{\\mathrm{GM}}$ 的最大绝对值得到。APE 耗散 $D_{\\mathrm{const}}$ 通过对网格单元上的 $\\rho_0 L_x K_{\\mathrm{const}} s^2 N^2$ 进行黎曼和来计算。\n4.  对于能量约束方案，通过黎曼和计算积分 $I_s = \\rho_0 L_x \\iint s^2 N^2 \\, dy \\, dz$。然后使用导出的公式以及给定的 $P_w$ 和 $K_{\\max}$ 计算 $K_{\\mathrm{energy}}$。\n5.  使用计算出的 $K_{\\mathrm{energy}}$，采用与恒定 $K$ 情况相同的方法计算最大输运量 $\\psi_{\\mathrm{energy}}$ 和 APE 耗散 $D_{\\mathrm{energy}}$，但用 $K_{\\mathrm{energy}}$ 替代 $K_{\\mathrm{const}}$。\n6.  对所有三个测试案例重复此过程，并按指定格式收集和整理结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Gent-McWilliams parameterization problem for three test cases.\n    \"\"\"\n    # Grid parameters\n    Ny, Nz = 200, 100\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Case 1: General case\n            \"W\": 1.0e6, \"H\": 4.0e3, \"Lx\": 2.0e6,\n            \"rho0\": 1025.0, \"g\": 9.81,\n            \"N0\": 1.0e-3,\n            \"s0\": 1.0e-3,\n            \"K_const\": 1.0e3,\n            \"Pw\": 5.0e9,\n            \"K_max\": 3.0e3\n        },\n        {\n            # Case 2: Zero wind work\n            \"W\": 1.0e6, \"H\": 4.0e3, \"Lx\": 2.0e6,\n            \"rho0\": 1025.0, \"g\": 9.81,\n            \"N0\": 1.0e-3,\n            \"s0\": 1.0e-3,\n            \"K_const\": 1.0e3,\n            \"Pw\": 0.0,\n            \"K_max\": 3.0e3\n        },\n        {\n            # Case 3: Weak stratification\n            \"W\": 1.0e6, \"H\": 4.0e3, \"Lx\": 2.0e6,\n            \"rho0\": 1025.0, \"g\": 9.81,\n            \"N0\": 2.0e-4,\n            \"s0\": 1.0e-3,\n            \"K_const\": 1.0e3,\n            \"Pw\": 5.0e9,\n            \"K_max\": 3.0e3\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        W = case[\"W\"]\n        H = case[\"H\"]\n        Lx = case[\"Lx\"]\n        rho0 = case[\"rho0\"]\n        N0 = case[\"N0\"]\n        s0 = case[\"s0\"]\n        sigma = W / 4.0\n        K_const = case[\"K_const\"]\n        Pw = case[\"Pw\"]\n        K_max = case[\"K_max\"]\n\n        # Setup grid\n        dy = W / (Ny - 1)\n        dz = H / (Nz - 1)\n        y_vec = np.linspace(0, W, Ny)\n        z_vec = np.linspace(0, H, Nz)\n        Y, Z = np.meshgrid(y_vec, z_vec, indexing='ij')\n\n        # Calculate physical fields on the grid\n        N2 = N0**2\n        S = s0 * np.exp(-((Y - W / 2.0)**2) / (2.0 * sigma**2)) * np.cos(np.pi * Z / H)\n\n        # --- Constant-K GM Scheme Calculations ---\n        \n        # 1. Residual overturning streamfunction\n        Psi_gm_const = -K_const * S\n        \n        # 2. Maximum residual overturning transport magnitude\n        psi_const = Lx * np.max(np.abs(Psi_gm_const))\n        \n        # 3. Domain-integrated APE destruction rate\n        integrand_D_const = rho0 * K_const * S**2 * N2\n        # Riemann sum for the integral\n        D_const = Lx * np.sum(integrand_D_const) * dy * dz\n        \n        # --- Energy-Constrained GM Scheme Calculations ---\n        \n        # 1. Calculate the integral part of the K_energy denominator\n        integrand_K_denom = rho0 * S**2 * N2\n        Is = Lx * np.sum(integrand_K_denom) * dy * dz\n        \n        # 2. Calculate energy-constrained diffusivity K_energy\n        if Is > 1e-9: # Avoid division by zero, though not expected here\n            K_energy_unconstrained = Pw / Is\n        else:\n            K_energy_unconstrained = 0.0 if Pw == 0.0 else np.inf\n            \n        K_energy = min(K_max, K_energy_unconstrained)\n        \n        # 3. Residual overturning streamfunction for the energy-constrained case\n        Psi_gm_energy = -K_energy * S\n        \n        # 4. Maximum residual overturning transport magnitude\n        psi_energy = Lx * np.max(np.abs(Psi_gm_energy))\n        \n        # 5. Domain-integrated APE destruction rate\n        # D_energy = K_energy * Is by definition\n        D_energy = K_energy * Is\n\n        results.extend([psi_const, psi_energy, D_const, D_energy])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}