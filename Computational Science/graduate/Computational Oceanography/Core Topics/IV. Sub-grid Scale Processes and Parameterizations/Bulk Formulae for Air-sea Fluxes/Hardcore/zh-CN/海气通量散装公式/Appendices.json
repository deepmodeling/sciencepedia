{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你直接应用整体动力学公式来计算海气界面的能量交换。通过这个基础计算，你将熟悉感热通量和潜热通量的核心方程，并对它们在典型海洋条件下的相对重要性建立起物理直觉。这项实践是理解海洋表面能量收支的第一步。",
            "id": "4020233",
            "problem": "考虑一个数值天气预报模式中的中性层结海洋大气表面层，其中空气以在标准高度测得的参考风速流过洋面。海面与大气之间的湍流感热和潜热交换将使用一阶湍流闭合和表面层相似性理论来表示。从湍流通量的雷诺平均定义和表面层的适当闭合假设出发，推导向上感热通量和向上潜热通量的块体空气动力学表达式，该表达式应使用空气密度、热力学常数、地表与上覆空气之间标量的近地表差异、一个输送系数和参考风速来表示。然后，针对以下科学上真实的案例计算感热通量和潜热通量，并评论它们的相对大小及其对地表能量收支和气候模拟中通量调整的物理意义。\n\n使用以下参数值，所有值均为海洋上空标准近地表高度的参考值：\n- 空气密度 $\\,\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$。\n- 空气定压比热 $\\,c_{p} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 蒸发潜热 $\\,L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n- 参考风速 $\\,U = 6\\,\\mathrm{m\\,s^{-1}}$。\n- 海-气温差 $\\,T_{s} - T_{a} = 2\\,\\mathrm{K}$。\n- 海-气比湿差 $\\,q_{s} - q_{a} = 4 \\times 10^{-3}$。\n- 中性输送系数 $\\,C_{H} = C_{E} = 1.2 \\times 10^{-3}$。\n\n采用从海面向大气为正的向上通量符号约定。推导出块体表达式后，使用给定参数数值计算感热通量 $\\,H\\,$ 和潜热通量 $\\,E\\,$。将两种通量均以 $\\mathrm{W\\,m^{-2}}$ 为单位表示，并将最终数值结果四舍五入至四位有效数字。最后，简要评估哪种通量占主导地位并解释其物理原因，包括简要说明输送系数或近地表标量差异的调整将如何影响气候模型中地表能量的分配。",
            "solution": "该问题要求从第一性原理推导感热和潜热通量的块体空气动力学公式，然后进行数值计算并对结果进行物理解释。该问题具有科学依据，是适定的，并提供了所有必要的参数。\n\n**第一部分：块体空气动力学公式的推导**\n\n大气表面层中的热量和水汽湍流通量是基于雷诺平均定义的。设 $w$ 为垂直速度，$T$ 为温度，$q$ 为比湿。每个变量都可以分解为一个平均分量（例如 $\\overline{w}$）和一个湍流脉动分量（例如 $w'$），使得 $w = \\overline{w} + w'$。根据定义，脉动分量的平均值为零，即 $\\overline{w'} = 0$。对于水平均匀的表面层，假定平均垂直速度 $\\overline{w}$ 为零。\n\n通用标量 $\\phi$ 的垂直湍流通量由垂直速度脉动和标量脉动的协方差给出，即 $\\overline{w' \\phi'}$。\n\n向上感热通量 $H$ 是位温 $\\theta$ 的湍流通量乘以空气密度 $\\rho$ 和定压比热 $c_p$。在表面层中，位温 $\\theta$ 和绝对温度 $T$ 之间的差异很小，因此我们可以使用 $T$ 来近似通量。\n$$H = \\rho c_p \\overline{w' T'}$$\n向上潜热通量 $E$ 是水汽的湍流质量通量 $\\overline{w' q'}$ 乘以空气密度 $\\rho$ 和蒸发潜热 $L_v$。\n$$E = \\rho L_v \\overline{w' q'}$$\n符号约定为向上通量（从海洋到大气）为正。当平均而言，上升的气块（$w' > 0$）比下沉的气块（$w'  0$）更暖（$T' > 0$）和更湿（$q' > 0$），而下沉的气块更冷（$T'  0$）和更干（$q'  0$）时，就会发生这种情况，从而导致正的协方差 $\\overline{w' \\phi'}$。\n\n为了闭合这个系统（即用已知的平均量表示未知的协方差），我们采用一阶闭合，也称为K理论。该理论假定湍流混合的作用类似于分子扩散，其中通量与平均量的梯度成正比。\n$$\\overline{w' T'} = -K_H \\frac{\\partial \\overline{T}}{\\partial z}$$\n$$\\overline{w' q'} = -K_E \\frac{\\partial \\overline{q}}{\\partial z}$$\n在这里，$z$ 是垂直坐标，$K_H$ 是热量的涡动扩散系数，$K_E$ 是水汽的涡动扩散系数。负号表示通量沿着梯度的反方向（从高值到低值）。\n\n将这些闭合假设代入通量定义中，我们得到：\n$$H = -\\rho c_p K_H \\frac{\\partial \\overline{T}}{\\partial z}$$\n$$E = -\\rho L_v K_E \\frac{\\partial \\overline{q}}{\\partial z}$$\n块体空气动力学方法通过将梯度在大气表面层上进行积分来简化此问题，积分范围从地表本身（高度 $z=0$，用下标 $s$ 表示）到空气中的参考高度（高度 $z_a$，用下标 $a$ 表示）。梯度通过有限差分近似：\n$$\\frac{\\partial \\overline{T}}{\\partial z} \\approx \\frac{\\overline{T}_a - T_s}{z_a - 0} = \\frac{T_a - T_s}{z_a}$$\n$$\\frac{\\partial \\overline{q}}{\\partial z} \\approx \\frac{\\overline{q}_a - q_s}{z_a - 0} = \\frac{q_a - q_s}{z_a}$$\n在这里，$T_s$ 和 $q_s$ 是海面的温度和比湿，而 $T_a$ 和 $q_a$ 是参考高度的值。\n\n将这些近似值代入通量方程中：\n$$H \\approx -\\rho c_p K_H \\frac{T_a - T_s}{z_a} = \\rho c_p \\frac{K_H}{z_a} (T_s - T_a)$$\n$$E \\approx -\\rho L_v K_E \\frac{q_a - q_s}{z_a} = \\rho L_v \\frac{K_E}{z_a} (q_s - q_a)$$\n这些表达式证实了对于 $T_s > T_a$ 或 $q_s > q_a$ 的情况，通量为正（向上），与约定一致。\n\n最后一步是将涡动扩散项与可直接测量的量联系起来。表面层相似性理论和经验证据表明，湍流输送的效率取决于参考高度处的平均风速 $U$。块体输送系数 $C_H$ 和 $C_E$ 被定义为概括了湍流混合的综合效应，使得：\n$$\\frac{K_H}{z_a} \\propto C_H U$$\n$$\\frac{K_E}{z_a} \\propto C_E U$$\n因此，块体空气动力学公式的最终形式定义为：\n$$H = \\rho c_p C_H U (T_s - T_a)$$\n$$E = \\rho L_v C_E U (q_s - q_a)$$\n这些表达式是所期望的结果。它们将湍流通量与平均大气状态变量（$\\rho$, $U$）、热力学常数（$c_p$, $L_v$）、跨界面的平均差异（$T_s - T_a$, $q_s - q_a$）以及经验确定的输送系数（$C_H$, $C_E$）联系起来。问题指出这些是中性系数，意味着它们不依赖于大气稳定度，这是一个对给定的中性层结条件有效的简化。\n\n**第二部分：数值计算**\n\n我们给出了以下参数值：\n- $\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$\n- $c_{p} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- $L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$\n- $U = 6\\,\\mathrm{m\\,s^{-1}}$\n- $T_{s} - T_{a} = 2\\,\\mathrm{K}$\n- $q_{s} - q_{a} = 4 \\times 10^{-3}$\n- $C_{H} = C_{E} = 1.2 \\times 10^{-3}$\n\n首先，我们计算感热通量 $H$：\n$$H = \\rho c_p C_H U (T_s - T_a)$$\n$$H = (1.2\\,\\mathrm{kg\\,m^{-3}}) \\times (1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) \\times (1.2 \\times 10^{-3}) \\times (6\\,\\mathrm{m\\,s^{-1}}) \\times (2\\,\\mathrm{K})$$\n$$H = 1.2 \\times 1004 \\times 1.2 \\times 10^{-3} \\times 6 \\times 2\\,\\mathrm{W\\,m^{-2}}$$\n$$H = 17.34912\\,\\mathrm{W\\,m^{-2}}$$\n四舍五入到四位有效数字，我们得到 $H = 17.35\\,\\mathrm{W\\,m^{-2}}$。\n\n接下来，我们计算潜热通量 $E$：\n$$E = \\rho L_v C_E U (q_s - q_a)$$\n$$E = (1.2\\,\\mathrm{kg\\,m^{-3}}) \\times (2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}) \\times (1.2 \\times 10^{-3}) \\times (6\\,\\mathrm{m\\,s^{-1}}) \\times (4 \\times 10^{-3})$$\n$$E = 1.2 \\times 2.5 \\times 10^6 \\times 1.2 \\times 10^{-3} \\times 6 \\times 4 \\times 10^{-3}\\,\\mathrm{W\\,m^{-2}}$$\n$$E = 86.4\\,\\mathrm{W\\,m^{-2}}$$\n为了用四位有效数字表示，我们写作 $E = 86.40\\,\\mathrm{W\\,m^{-2}}$。\n\n**第三部分：评估与物理解释**\n\n比较这两个通量，$H = 17.35\\,\\mathrm{W\\,m^{-2}}$ 和 $E = 86.40\\,\\mathrm{W\\,m^{-2}}$，很明显潜热通量远大于感热通量。它们的量级之比为 $E/H \\approx 86.40 / 17.35 \\approx 4.98$。这对于开阔洋面是一个典型的结果。定义为 $B = H/E$ 的波文比（Bowen ratio）约为 $0.2$，证实了潜热通量的主导地位。\n\n这种主导地位的物理原因有两个方面：\n1.  **蒸发潜热（$L_v$）值高：** $L_v = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$ 的值非常大。这意味着蒸发少量水就需要巨大的能量。因此，即使从海面蒸发少量水，也会以潜热的形式将大量能量输送到大气中。\n2.  **充足的水分供应：** 海洋为蒸发提供了几乎无限的水源。因此，潜热通量主要受到可用能量和上覆空气吸收水汽能力的限制，而这又由湿度梯度（$q_s - q_a$）和风速（$U$）决定。\n\n相比之下，感热通量受限于空气相对较小的比热（$c_p$）和通常较小的温度梯度。海洋的高热惯性意味着其表面温度（$T_s$）变化缓慢，从而调节了海气温差（$T_s - T_a$）。\n\n关于气候模型中的通量调整，块体公式表明计算出的通量与输送系数（$C_H, C_E$）和海气差异（$\\Delta T, \\Delta q$）成正比。在耦合的海洋-大气模型中，预测的海面温度或近地表大气属性的微小系统性偏差可能导致地表通量出现大的、持续的误差，从而导致模型气候在长期积分中“漂移”。例如，一个具有大气冷偏差的模型会产生过大的 $T_s - T_a$，导致海洋出现虚假的热量损失。为了抵消这种漂移，早期的模型经常应用人为的“通量调整”。由于潜热通量是海洋上空湍流能量交换的主要组成部分，地表能量收支对湿度场的偏差和 $C_E$ 的参数化尤为敏感。对 $C_H$ 或 $C_E$ 的调整，或对平均差异 $\\Delta T$ 和 $\\Delta q$ 的调整，会直接改变地表能量在感热和潜热形式之间的分配。现代模型旨在通过改进耦合过程的底层物理参数化来减少和消除这些临时的调整。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n17.35  86.40\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实世界中，海气相互作用包含着复杂的反馈循环。本练习将超越使用固定系数的简化情景，进入一个更贴近现实的设置，其中海面粗糙度以及拖曳系数本身都依赖于风应力。你将通过实施一个迭代算法来求解一个自洽的解，这是地球物理建模中的一项基本技能。",
            "id": "3786683",
            "problem": "您的任务是基于 Monin–Obukhov 相似理论和 Charnock 关系，使用一种有物理依据的迭代方法来计算中性 10 米拖曳系数。该场景假设海洋上空存在一个中性层结的海洋大气边界层。\n\n基本原理：\n- 中性层结的对数风廓线指出，高度 $z$ 处的平均风速与摩擦速度 $u_*$ 和粗糙度长度 $z_{0m}$ 的关系如下\n$$\nU(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0m}}\\right),\n$$\n其中 $\\kappa$ 是 von Kármán 常数。\n- Charnock 关系给出了动量粗糙度长度为\n$$\nz_{0m} = \\alpha \\frac{u_*^2}{g},\n$$\n其中 $g$ 是重力加速度，$\\alpha$ 是 Charnock 参数。\n- 高度 $z$ 处的中性拖曳系数由风应力和风速之间的关系定义。对于 $z = 10 \\,\\mathrm{m}$ 处的中性条件，中性 10 米拖曳系数 $C_{D,N}$ 定义为\n$$\nC_{D,N} = \\frac{u_*^2}{U_{10}^2},\n$$\n其中 $U_{10}$ 是 $z = 10 \\,\\mathrm{m}$ 处的平均风速。\n\n任务：\n- 对于给定的配对 $(U_{10}, \\alpha)$，通过求解在 $z = 10 \\,\\mathrm{m}$ 处结合对数风廓线和 Charnock 关系得到的隐式方程，迭代求解摩擦速度 $u_*$，\n$$\nU_{10} = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10}{\\alpha u_*^2 / g}\\right),\n$$\n然后计算 $C_{D,N}$。\n- 在获得 $C_{D,N}$ 后，使用对数敏感度\n$$\nS_{\\alpha} = \\frac{\\partial \\ln C_{D,N}}{\\partial \\ln \\alpha},\n$$\n分析其对 Charnock 参数 $\\alpha$ 的局部敏感度，该敏感度通过对 $\\alpha$ 应用指定的微小相对扰动的对称有限差分进行数值近似。\n\n常量：\n- 使用 $\\kappa = 0.4$ (无量纲)。\n- 使用 $g = 9.80665 \\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n- 所有计算均假设中性稳定性和对数风廓线的有效性。\n- 摩擦速度 $u_*$ 必须为严格正值，并且数值方案必须确保收敛到一个有物理意义的解。\n\n数值要求：\n- 基于隐式方程的单调性，为 $u_*$ 实现一个稳健的迭代求根方案，例如在区间 $u_* \\in (0, u_{\\max})$ 上使用二分法，其中 $u_{\\max} > 0$ 足够大以包围根。\n- 使用相对扰动因子 $r = 0.01$ (即 $1\\%$) 来计算 $S_{\\alpha}$ 的有限差分近似：\n$$\nS_{\\alpha} \\approx \\frac{\\ln C_{D,N}(\\alpha(1+r)) - \\ln C_{D,N}(\\alpha(1-r))}{\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r))}.\n$$\n\n单位和输出：\n- 输入风速 $U_{10}$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 重力加速度 $g$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n- Charnock 参数 $\\alpha$ 是无量纲的。\n- 拖曳系数 $C_{D,N}$ 是无量纲的。\n- 敏感度 $S_{\\alpha}$ 是无量纲的。\n- 将每个输出值表示为四舍五入到六位小数的浮点数。\n\n测试套件：\n评估程序，针对以下六个测试用例，每个用例指定为 $(U_{10}, \\alpha)$：\n1. $(10.0, 0.011)$\n2. $(5.0, 0.018)$\n3. $(20.0, 0.011)$\n4. $(1.0, 0.011)$\n5. $(30.0, 0.020)$\n6. $(8.0, 0.005)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有六个测试用例的结果，格式为一个用方括号括起来的逗号分隔列表，其中每个元素是一个包含该测试用例的 $[C_{D,N}, S_{\\alpha}]$ 的双元素列表。\n- 例如：\n\"[[c1,s1],[c2,s2],[c3,s3],[c4,s4],[c5,s5],[c6,s6]]\"",
            "solution": "根据既定标准对问题陈述进行严格审查和验证。\n\n### 步骤 1：提取已知条件\n- **对数风廓线**：$U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0m}}\\right)$\n- **关于粗糙度长度的 Charnock 关系**：$z_{0m} = \\alpha \\frac{u_*^2}{g}$\n- **中性 10 米拖曳系数定义**：$C_{D,N} = \\frac{u_*^2}{U_{10}^2}$，其中 $U_{10} = U(z=10 \\,\\mathrm{m})$\n- **摩擦速度的隐式方程**：$U_{10} = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right)$\n- **$C_{D,N}$ 对 $\\alpha$ 的对数敏感度**：$S_{\\alpha} = \\frac{\\partial \\ln C_{D,N}}{\\partial \\ln \\alpha}$\n- **敏感度的数值近似**：$S_{\\alpha} \\approx \\frac{\\ln C_{D,N}(\\alpha(1+r)) - \\ln C_{D,N}(\\alpha(1-r))}{\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r))}$\n- **常量**：von Kármán 常数 $\\kappa = 0.4$，重力加速度 $g = 9.80665 \\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n- **数值参数**：用于敏感度计算的相对扰动因子 $r = 0.01$。\n- **约束条件**：计算假设中性稳定性。摩擦速度 $u_*$ 必须为严格正值。\n- **测试套件**：提供了六对 $(U_{10}, \\alpha)$：$(10.0, 0.011)$、$(5.0, 0.018)$、$(20.0, 0.011)$、$(1.0, 0.011)$、$(30.0, 0.020)$、$(8.0, 0.005)$。\n- **输出要求**：对于每个测试用例，输出一个包含两个项目的列表 $[C_{D,N}, S_{\\alpha}]$，其值四舍五入到六位小数。最终输出是一个表示这些列表的列表的单行字符串。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行验证。\n- **科学依据**：该问题基于边界层气象学的基石原理，即 Monin–Obukhov 相似理论和关于海面空气动力学粗糙度的 Charnock 关系。所提供的方程是这些原理在中性层结海洋大气边界层中的标准表示。该问题在事实上和科学上都是合理的。\n- **适定性**：该问题需要求解摩擦速度 $u_*$ 的一个超越方程。设待解函数为 $f(u_*) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right) - U_{10} = 0$。对此函数的分析表明，在给定的物理参数范围内，它有两个正根。较小的根对应于风浪生成中的物理现实解，而较大的根通常被认为是非物理的。通过将求根算法的搜索区间限制在适当的范围内，例如 $u_* \\in (0, 3]$，可以唯一确定较小的、有物理意义的根。因此，该问题是适定的。\n- **客观性**：问题使用精确、明确的数学和物理术语陈述。它不含主观或基于观点的论断。\n- **完整性和一致性**：提供了所有必要的常量、方程和数值参数。定义内部一致，并与标准文献相符。\n- **真实性**：提供的风速 $U_{10}$、Charnock 参数 $\\alpha$ 以及物理常数 $\\kappa$ 和 $g$ 的值是现实的，并代表了地球的海洋-大气系统。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个在计算海洋学中定义明确、有科学依据的问题。将开发一个解决方案。\n\n### 算法设计与原理\n\n解决方案的结构是首先计算中性拖曳系数 $C_{D,N}$，然后利用这个结果来确定其对 Charnock 参数的敏感度 $S_{\\alpha}$。\n\n**1. 中性拖曳系数 $C_{D,N}$ 的计算**\n\n问题的核心是通过求解给定 10 米风速 $U_{10}$ 和 Charnock 参数 $\\alpha$ 的隐式方程来找到摩擦速度 $u_*$：\n$$\nU_{10} = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right)\n$$\n这个方程无法解析求解 $u_*$。因此，需要一种数值求根方法。我们定义一个我们寻求其根的函数 $f(u_*)$：\n$$\nf(u_*) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right) - U_{10}\n$$\n问题指定使用像二分法这样的迭代方案。要应用此方法，我们必须确定一个区间 $[a, b]$，它包围一个单根，即在该区间内 $f(a)$ 和 $f(b)$ 符号相反。\n\n我们来分析 $f(u_*)$：\n- 当 $u_* \\to 0^+$ 时，项 $u_* \\ln(1/u_*^2) = -2u_* \\ln(u_*)$ 趋近于 $0$。因此，$f(u_*) \\to -U_{10}$。函数以负值开始。\n- 函数增加到最大值然后减少。对于给定的风速，存在一个有物理意义的解。可以建立一个合适的搜索区间，例如 $[10^{-6}, 3.0]$。下界是一个小的正数以避免在 $u_*=0$ 处的奇点，而上界是一个足够大的 $u_*$ 值，以确保对于所有测试用例，$f(3.0) > 0$，从而包围物理根。\n\n二分法算法过程如下：\n1. 初始化区间 $[a, b]$ 和一个容差 $\\epsilon$。\n2. 计算中点 $c = (a+b)/2$。\n3. 如果 $f(c)$ 足够接近 $0$ (即 $|f(c)|  \\epsilon$) 或者区间宽度 $(b-a)/2$ 小于 $\\epsilon$，算法终止，c 即为近似根。\n4. 否则，如果 $f(a)$ 和 $f(c)$ 符号相同，根位于 $[c, b]$ 中，因此我们设置 $a=c$。\n5. 如果它们符号相反，根位于 $[a, c]$ 中，因此我们设置 $b=c$。\n6. 从步骤 2 重复。\n\n一旦获得收敛的 $u_*$ 值，中性 10 米拖曳系数 $C_{D,N}$ 就直接根据其定义计算：\n$$\nC_{D,N} = \\left(\\frac{u_*}{U_{10}}\\right)^2\n$$\n\n**2. 对数敏感度 $S_{\\alpha}$ 的计算**\n\n对数敏感度 $S_{\\alpha} = \\frac{\\partial \\ln C_{D,N}}{\\partial \\ln \\alpha}$ 量化了 $C_{D,N}$ 相对于 $\\alpha$ 相对变化的相对变化。它将使用对称有限差分方案进行近似。提供的公式是：\n$$\nS_{\\alpha} \\approx \\frac{\\ln C_{D,N}(\\alpha(1+r)) - \\ln C_{D,N}(\\alpha(1-r))}{\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r))}\n$$\n其中 $r = 0.01$ 是相对扰动。\n\n分母可以简化以提高数值精度：\n$$\n\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r)) = \\ln(\\alpha) + \\ln(1+r) - (\\ln(\\alpha) + \\ln(1-r)) = \\ln\\left(\\frac{1+r}{1-r}\\right)\n$$\n$S_{\\alpha}$ 的计算过程是：\n1. 对于给定的配对 $(U_{10}, \\alpha)$，定义扰动后的 Charnock 参数：$\\alpha_{+} = \\alpha(1+r)$ 和 $\\alpha_{-} = \\alpha(1-r)$。\n2. 使用 $\\alpha_{+}$ 和 $U_{10}$ 求解 $u_*$ 来计算 $C_{D,N}(\\alpha_{+})$，然后计算拖曳系数。\n3. 使用 $\\alpha_{-}$ 和 $U_{10}$ 求解 $u_*$ 来计算 $C_{D,N}(\\alpha_{-})$，然后计算拖曳系数。\n4. 将这些值代入敏感度公式：\n$$\nS_{\\alpha} \\approx \\frac{\\ln(C_{D,N}(\\alpha_{+})) - \\ln(C_{D,N}(\\alpha_{-}))}{\\ln\\left(\\frac{1+r}{1-r}\\right)}\n$$\n\n**3. 最终实现**\n\n整体算法遍历六个测试用例中的每一个。对于每个用例 $(U_{10}, \\alpha)$：\n1. 调用一个函数 `calculate_C_D_N(U10, alpha)` 来计算拖曳系数。该函数内部实现二分法来找到 $u_*$。\n2. 为未扰动的 $\\alpha$ 计算基础拖曳系数 $C_{D,N}$。\n3. 计算扰动后的拖曳系数 $C_{D,N}(\\alpha_{+})$ 和 $C_{D,N}(\\alpha_{-})$。\n4. 使用有限差分公式计算敏感度 $S_{\\alpha}$。\n5. 将得到的配对 $[C_{D,N}, S_{\\alpha}]$ 四舍五入到六位小数并存储。\n6. 处理完所有测试用例后，将收集到的结果按规定格式化为单个字符串并打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the neutral 10-meter drag coefficient and its sensitivity to the\n    Charnock parameter for a set of test cases.\n    \"\"\"\n    \n    # Define physical and numerical constants from the problem statement.\n    KAPPA = 0.4  # von Kármán constant (dimensionless)\n    G = 9.80665   # Acceleration due to gravity (m/s^2)\n    R = 0.01      # Relative perturbation factor for sensitivity (dimensionless)\n    REFERENCE_HEIGHT = 10.0 # Reference height in meters\n\n    def bisection(func, a, b, tol=1e-12, max_iter=100):\n        \"\"\"\n        Finds a root of `func` within the interval [a, b] using the bisection method.\n        `func` must be a single-variable function.\n        `a` and `b` must bracket the root, i.e., func(a) and func(b) have opposite signs.\n        \"\"\"\n        fa = func(a)\n        if fa * func(b) > 0:\n            raise ValueError(\"Root is not bracketed or multiple roots exist in the interval.\")\n        \n        for _ in range(max_iter):\n            c = (a + b) / 2.0\n            fc = func(c)\n            \n            if abs(fc)  tol or (b - a) / 2.0  tol:\n                return c\n            \n            if fa * fc  0:\n                b = c\n            else:\n                a = c\n                fa = fc\n        return (a + b) / 2.0\n\n    def calculate_C_D_N(U10, alpha):\n        \"\"\"\n        Calculates the neutral 10-m drag coefficient for a given U10 and alpha.\n        \"\"\"\n        if U10 = 0 or alpha = 0:\n            # Handle non-physical inputs, though not expected from test cases.\n            return np.nan\n        \n        # Define the residual function f(u_*) = 0 that needs to be solved.\n        # u_star is the friction velocity.\n        def residual_func(u_star):\n            # The argument of the logarithm must be positive. This implies\n            # z0m = alpha * u_star**2 / G  REFERENCE_HEIGHT\n            # This condition holds for the physical root.\n            if u_star = 0:\n                return -U10  # Maintain function continuity for robust bisection\n            \n            log_arg = (REFERENCE_HEIGHT * G) / (alpha * u_star**2)\n            \n            # If u_star is too large, log_arg can be = 0.\n            # The search interval for bisection is chosen to avoid this.\n            if log_arg = 0:\n                # This corresponds to a very large u_star, making the function\n                # effectively -infinity. Return a large negative number.\n                return -1e9 \n\n            return (u_star / KAPPA) * np.log(log_arg) - U10\n\n        # Bisection search interval for u_star.\n        # Based on physical intuition and analysis, the physical root for u_star\n        # will be a small fraction of U10. An interval of [1e-6, 3.0]\n        # is robust enough to bracket the physical root for all test cases.\n        # f(1e-6) will be negative, f(3.0) will be positive for the given U10 range.\n        u_star_lower_bound = 1e-6\n        u_star_upper_bound = 3.0\n        \n        try:\n            # Solve for the friction velocity u_star\n            u_star = bisection(residual_func, u_star_lower_bound, u_star_upper_bound)\n            \n            # Calculate the drag coefficient\n            C_D_N = (u_star / U10)**2\n            return C_D_N\n        except ValueError:\n            return np.nan\n\n    # Test cases as specified in the problem: (U10, alpha)\n    test_cases = [\n        (10.0, 0.011),\n        (5.0, 0.018),\n        (20.0, 0.011),\n        (1.0, 0.011),\n        (30.0, 0.020),\n        (8.0, 0.005)\n    ]\n\n    results = []\n    for U10, alpha in test_cases:\n        # 1. Calculate the base drag coefficient C_D_N for the given alpha.\n        C_D_N_base = calculate_C_D_N(U10, alpha)\n\n        # 2. Calculate sensitivity S_alpha using a finite difference approximation.\n        alpha_plus = alpha * (1.0 + R)\n        alpha_minus = alpha * (1.0 - R)\n\n        C_D_N_plus = calculate_C_D_N(U10, alpha_plus)\n        C_D_N_minus = calculate_C_D_N(U10, alpha_minus)\n        \n        # Denominator of the sensitivity formula: ln(alpha_plus/alpha_minus)\n        # This simplifies to ln((1+R)/(1-R)) for better numerical stability.\n        log_alpha_ratio = np.log((1.0 + R) / (1.0 - R))\n\n        # Numerator of the sensitivity formula: ln(C_D_N_plus/C_D_N_minus)\n        log_C_D_N_ratio = np.log(C_D_N_plus) - np.log(C_D_N_minus)\n\n        S_alpha = log_C_D_N_ratio / log_alpha_ratio\n        \n        # Round the final values to six decimal places as required.\n        rounded_C_D_N = round(C_D_N_base, 6)\n        rounded_S_alpha = round(S_alpha, 6)\n        \n        results.append([rounded_C_D_N, rounded_S_alpha])\n\n    # Format the output string to perfectly match \"[[c1,s1],[c2,s2],...]\"\n    # by converting the list of lists to a string and removing whitespace.\n    final_output_string = str(results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "整体公式在气候和天气模型中至关重要，因此理解哪些输入变量对计算出的通量影响最大是关键。本练习将热力学原理与微积分相结合，进行一次敏感性分析。通过这个过程，你将揭示海气能量交换的主要驱动因素，并深入了解模型不确定性的潜在来源。",
            "id": "3786625",
            "problem": "考虑一个中纬度开阔大洋情景，其大气层结为近中性，且条件稳定、均匀。从海气界面湍流标量通量的梯度传输假说和水汽含量的热力学定义出发。使用以下科学标准作为基础：\n- 在海洋表面，被动标量 $\\phi$ 的湍流标量通量与空气密度、一个传输效率、一个近地表速度尺度以及海气标量差成正比，这与 Monin–Obukhov 相似性理论（MOST）一致。\n- 潜热通量 $Q_{L}$ 等于汽化潜热乘以水汽的质量通量。\n- 感热通量 $Q_{S}$ 等于定压比热乘以湍流热通量。\n- 比湿 $q$ 通过湿热力学定义 $q = \\frac{0.622\\,e}{p - 0.378\\,e}$ 与水汽压 $e$ 和总压 $p$ 相关联，而液态水上方的饱和水汽压在温度 $T$（单位为摄氏度）下，可以从一个经过充分检验的 Clausius–Clapeyron 关系式的经验近似中获得。\n\n假设在 $10\\,\\mathrm{m}$ 高度和海气界面有以下典型的海洋大气条件：\n- $10\\,\\mathrm{m}$ 处的风速：$U_{10} = 8\\,\\mathrm{m\\,s^{-1}}$。\n- 海面温度 (SST)：$T_{s} = 301\\,\\mathrm{K}$。\n- 气温：$T_{a} = 298\\,\\mathrm{K}$。\n- 海平面气压：$p = 101325\\,\\mathrm{Pa}$。\n- 近地表相对湿度：$\\mathrm{RH} = 0.80$。\n- 空气密度：$\\rho = 1.22\\,\\mathrm{kg\\,m^{-3}}$。\n- 汽化潜热：$L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n- 定压比热：$c_{p} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 中性稳定度交换系数：水汽为 $C_{E} = 1.2 \\times 10^{-3}$，热量为 $C_{H} = 1.1 \\times 10^{-3}$。\n- 饱和水汽压近似公式（温度单位为摄氏度）：$e_{s}(T_{C}) = 6.112 \\exp\\!\\left(\\frac{17.67\\,T_{C}}{T_{C} + 243.5}\\right)\\,\\mathrm{hPa}$。\n\n任务：\n1. 从上述基础出发，推导 $Q_{L}$ 和 $Q_{S}$ 关于输入变量 $U_{10}$、$q_{s}$、$q_{a}$、$T_{s}$ 和 $T_{a}$ 的表达式，其中 $q_{s}$ 是海面饱和比湿，$q_{a}$ 是由给定的 $\\mathrm{RH}$ 和 $T_{a}$ 决定的环境空气比湿。\n2. 使用给定的热力学关系和常数，在所述条件下计算 $q_{s}$ 和 $q_{a}$。\n3. 在所述条件下，计算偏导数 $\\frac{\\partial Q_{L}}{\\partial U_{10}}$、$\\frac{\\partial Q_{L}}{\\partial q_{s}}$、$\\frac{\\partial Q_{L}}{\\partial q_{a}}$，以及 $\\frac{\\partial Q_{S}}{\\partial U_{10}}$、$\\frac{\\partial Q_{S}}{\\partial T_{s}}$、$\\frac{\\partial Q_{S}}{\\partial T_{a}}$。\n4. 为每个输入变量定义一个典型扰动：$\\delta U_{10} = 1\\,\\mathrm{m\\,s^{-1}}$，$\\delta q_{s} = 0.001\\,\\mathrm{kg\\,kg^{-1}}$，$\\delta q_{a} = 0.001\\,\\mathrm{kg\\,kg^{-1}}$，$\\delta T_{s} = 1\\,\\mathrm{K}$，$\\delta T_{a} = 1\\,\\mathrm{K}$。对于每种通量，根据乘积 $|\\frac{\\partial Q}{\\partial x}\\,\\delta x|$ 的大小，对主要贡献者进行排序。\n5. 令优势指数 $D$ 为各自变量集合中最大的 $|\\frac{\\partial Q_{L}}{\\partial x}\\,\\delta x|$ 与最大的 $|\\frac{\\partial Q_{S}}{\\partial x}\\,\\delta x|$ 之比。在所述条件下计算 $D$。\n\n将 $D$ 的最终值四舍五入到四位有效数字。将 $D$ 表示为一个没有单位的纯数。",
            "solution": "该问题已经过验证，被认为是有效的。它在科学上基于已确立的海气相互作用物理学和热力学原理，在数学上是适定的、客观的、自洽的，并且没有矛盾或含糊之处。所有必要的信息都已提供，以推导出唯一的解。\n\n求解过程遵循问题陈述中列出的五个任务。\n\n任务1：通量表达式的推导\n梯度传输假说，在近中性条件下的地表层（即整体空气动力学方法）中，将标量 $\\phi$ 的湍流通量建模为与该标量的平均垂直梯度成正比。对于海气界面的通量，其表达式为：\n$$ F_{\\phi} = \\rho C_{\\phi} U_{10} (\\phi_s - \\phi_a) $$\n这里，$F_{\\phi}$ 是 $\\phi$ 的湍流通量，$\\rho$ 是空气密度，$C_{\\phi}$ 是标量 $\\phi$ 的无量纲整体输送系数，$U_{10}$ 是参考高度 $10\\,\\mathrm{m}$ 处的风速，$\\phi_s$ 是海面处标量的值，$\\phi_a$ 是参考高度处环境空气中该标量的值。\n\n对于潜热通量 $Q_L$，相关标量是比湿 $q$。水汽的质量通量，用 $E$（蒸发）表示，由下式给出：\n$$ E = \\rho C_E U_{10} (q_s - q_a) $$\n其中 $C_E$ 是水汽的输送系数，$q_s$ 是海面的比湿（假定在海面温度下为饱和状态），$q_a$ 是空气的比湿。问题陈述指出，潜热通量 $Q_L$ 是汽化潜热 $L_v$ 和质量通量 $E$ 的乘积：\n$$ Q_L = L_v E = L_v \\rho C_E U_{10} (q_s - q_a) $$\n\n对于感热通量 $Q_S$，相关标量是位温 $\\theta$。对于近地表计算，使用绝对温度 $T$ 代替 $\\theta$ 是一个可接受的近似。湍流热通量由下式给出：\n$$ H_{flux} = \\rho C_H U_{10} (T_s - T_a) $$\n其中 $C_H$ 是热量的输送系数，$T_s$ 是海面温度，$T_a$ 是气温。根据标准的定义，感热通量 $Q_S$ 是：\n$$ Q_S = \\rho c_p C_H U_{10} (T_s - T_a) $$\n这是标准公式，将予以使用。\n\n任务2：$q_s$ 和 $q_a$ 的计算\n首先，将给定的开尔文温度转换为摄氏度，以便在饱和水汽压公式中使用：\n海面温度为 $T_s = 301\\,\\mathrm{K}$，因此 $T_{s,C} = 301 - 273.15 = 27.85\\,^\\circ\\mathrm{C}$。\n气温为 $T_a = 298\\,\\mathrm{K}$，因此 $T_{a,C} = 298 - 273.15 = 24.85\\,^\\circ\\mathrm{C}$。\n\n接下来，使用提供的公式计算海面饱和水汽压 $e_s(T_s)$，其中 $p$ 的单位是帕斯卡，$e_s$ 的单位是百帕：\n$$ e_s(T_{s,C}) = 6.112 \\exp\\left(\\frac{17.67 \\times 27.85}{27.85 + 243.5}\\right) = 6.112 \\exp\\left(\\frac{492.1095}{271.35}\\right) \\approx 37.4790\\,\\mathrm{hPa} $$\n转换为帕斯卡（$1\\,\\mathrm{hPa} = 100\\,\\mathrm{Pa}$），我们得到 $e_s(T_s) \\approx 3747.90\\,\\mathrm{Pa}$。\n饱和比湿 $q_s$ 是在海面计算的，假定该处的空气在温度 $T_s$ 下被水汽饱和：\n$$ q_s = \\frac{0.622\\,e_s(T_s)}{p - 0.378\\,e_s(T_s)} = \\frac{0.622 \\times 3747.90}{101325 - 0.378 \\times 3747.90} \\approx \\frac{2331.19}{101325 - 1416.71} \\approx \\frac{2331.19}{99908.29} \\approx 0.023333\\,\\mathrm{kg\\,kg^{-1}} $$\n\n接下来，计算环境空气比湿 $q_a$。首先，求出气温下的饱和水汽压 $e_s(T_a)$：\n$$ e_s(T_{a,C}) = 6.112 \\exp\\left(\\frac{17.67 \\times 24.85}{24.85 + 243.5}\\right) = 6.112 \\exp\\left(\\frac{439.1}{268.35}\\right) \\approx 31.3915\\,\\mathrm{hPa} $$\n这对应于 $e_s(T_a) \\approx 3139.15\\,\\mathrm{Pa}$。\n空气的实际水汽压 $e_a$ 由相对湿度 $\\mathrm{RH} = 0.80$ 决定：\n$$ e_a = \\mathrm{RH} \\times e_s(T_a) = 0.80 \\times 3139.15 \\approx 2511.32\\,\\mathrm{Pa} $$\n现在，计算空气比湿 $q_a$：\n$$ q_a = \\frac{0.622\\,e_a}{p - 0.378\\,e_a} = \\frac{0.622 \\times 2511.32}{101325 - 0.378 \\times 2511.32} \\approx \\frac{1562.04}{101325 - 949.28} \\approx \\frac{1562.04}{100375.72} \\approx 0.015562\\,\\mathrm{kg\\,kg^{-1}} $$\n\n任务3：偏导数的计算\n通量的表达式为：\n$Q_L = L_v \\rho C_E U_{10} (q_s - q_a)$\n$Q_S = c_p \\rho C_H U_{10} (T_s - T_a)$\n\n$Q_L$ 的偏导数为：\n$$ \\frac{\\partial Q_L}{\\partial U_{10}} = L_v \\rho C_E (q_s - q_a) $$\n$$ \\frac{\\partial Q_L}{\\partial q_s} = L_v \\rho C_E U_{10} $$\n$$ \\frac{\\partial Q_L}{\\partial q_a} = -L_v \\rho C_E U_{10} $$\n代入给定值和计算值：\n$L_v = 2.5 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$，$\\rho = 1.22\\,\\mathrm{kg\\,m^{-3}}$，$C_E = 1.2 \\times 10^{-3}$，$U_{10} = 8\\,\\mathrm{m\\,s^{-1}}$。\n$q_s - q_a \\approx 0.023333 - 0.015562 = 0.007771\\,\\mathrm{kg\\,kg^{-1}}$。\n$$ \\frac{\\partial Q_L}{\\partial U_{10}} \\approx (2.5 \\times 10^6)(1.22)(1.2 \\times 10^{-3})(0.007771) = 3660 \\times 0.007771 \\approx 28.45\\,\\mathrm{W\\,s\\,m^{-3}} $$\n$$ \\frac{\\partial Q_L}{\\partial q_s} = 3660 \\times 8 = 29280\\,\\mathrm{W\\,m^{-2}} $$\n$$ \\frac{\\partial Q_L}{\\partial q_a} = -29280\\,\\mathrm{W\\,m^{-2}} $$\n\n$Q_S$ 的偏导数为：\n$$ \\frac{\\partial Q_S}{\\partial U_{10}} = c_p \\rho C_H (T_s - T_a) $$\n$$ \\frac{\\partial Q_S}{\\partial T_s} = c_p \\rho C_H U_{10} $$\n$$ \\frac{\\partial Q_S}{\\partial T_a} = -c_p \\rho C_H U_{10} $$\n代入给定值：\n$c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$\\rho = 1.22\\,\\mathrm{kg\\,m^{-3}}$，$C_H = 1.1 \\times 10^{-3}$，$U_{10} = 8\\,\\mathrm{m\\,s^{-1}}$。\n$T_s - T_a = 301 - 298 = 3\\,\\mathrm{K}$。\n$$ \\frac{\\partial Q_S}{\\partial U_{10}} \\approx (1004)(1.22)(1.1 \\times 10^{-3})(3) \\approx 1.3474 \\times 3 \\approx 4.042\\,\\mathrm{W\\,s\\,m^{-3}} $$\n$$ \\frac{\\partial Q_S}{\\partial T_s} = (1004)(1.22)(1.1 \\times 10^{-3})(8) \\approx 1.3474 \\times 8 \\approx 10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n$$ \\frac{\\partial Q_S}{\\partial T_a} = -10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n\n任务4：主要贡献者的排序\n我们针对给定的扰动，评估由 $\\frac{\\partial Q}{\\partial x}\\delta x$ 近似的通量变化 $\\delta Q$。\n对于潜热通量 ($Q_L$)：\n$$ |\\frac{\\partial Q_L}{\\partial U_{10}}\\delta U_{10}| = |28.45\\,\\mathrm{W\\,s\\,m^{-3}}| \\times |1\\,\\mathrm{m\\,s^{-1}}| \\approx 28.45\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_L}{\\partial q_s}\\delta q_s| = |29280\\,\\mathrm{W\\,m^{-2}}| \\times |0.001| = 29.28\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_L}{\\partial q_a}\\delta q_a| = |-29280\\,\\mathrm{W\\,m^{-2}}| \\times |0.001| = 29.28\\,\\mathrm{W\\,m^{-2}} $$\n基于量级的 $Q_L$ 排序：\n1. 海气湿度差（由 $q_s$ 和 $q_a$ 驱动）：$29.28\\,\\mathrm{W\\,m^{-2}}$。\n2. 风速 ($U_{10}$)：$28.45\\,\\mathrm{W\\,m^{-2}}$。\n\n对于感热通量 ($Q_S$)：\n$$ |\\frac{\\partial Q_S}{\\partial U_{10}}\\delta U_{10}| = |4.042\\,\\mathrm{W\\,s\\,m^{-3}}| \\times |1\\,\\mathrm{m\\,s^{-1}}| \\approx 4.042\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_S}{\\partial T_s}\\delta T_s| = |10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}| \\times |1\\,\\mathrm{K}| \\approx 10.779\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_S}{\\partial T_a}\\delta T_a| = |-10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}| \\times |1\\,\\mathrm{K}| \\approx 10.779\\,\\mathrm{W\\,m^{-2}} $$\n基于量级的 $Q_S$ 排序：\n1. 海气温差（由 $T_s$ 和 $T_a$ 驱动）：$10.779\\,\\mathrm{W\\,m^{-2}}$。\n2. 风速 ($U_{10}$)：$4.042\\,\\mathrm{W\\,m^{-2}}$。\n\n任务5：优势指数 $D$ 的计算\n优势指数 $D$ 是 $Q_L$ 的最大灵敏度量级与 $Q_S$ 的最大灵敏度量级之比。\n$$ D = \\frac{\\max(|\\frac{\\partial Q_{L}}{\\partial x}\\,\\delta x|)}{\\max(|\\frac{\\partial Q_{S}}{\\partial x}\\,\\delta x|)} $$\n根据任务4：\n最大的 $|\\frac{\\partial Q_{L}}{\\partial x}\\,\\delta x|$ 是 $29.28\\,\\mathrm{W\\,m^{-2}}$。\n最大的 $|\\frac{\\partial Q_{S}}{\\partial x}\\,\\delta x|$ 是 $10.779\\,\\mathrm{W\\,m^{-2}}$。\n$$ D = \\frac{29.28}{10.779} \\approx 2.71641... $$\n四舍五入到四位有效数字，优势指数 $D$ 为 $2.716$。这个无量纲数表明，对于给定的典型扰动，潜热通量的响应强度大约是感热通量响应强度的 $2.7$ 倍。",
            "answer": "$$\\boxed{2.716}$$"
        }
    ]
}