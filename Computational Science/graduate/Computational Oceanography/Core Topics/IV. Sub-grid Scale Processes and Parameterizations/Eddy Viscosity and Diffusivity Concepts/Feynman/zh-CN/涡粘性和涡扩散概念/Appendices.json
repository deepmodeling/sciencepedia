{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基本问题开始：为什么海洋模型不能简单地使用海水的分子黏度和扩散率？本练习  通过对控制方程进行尺度分析来回答这个问题。通过计算典型海洋情景下的雷诺数 ($Re$) 和佩克莱数 ($Pe$)，您将定量地理解为何分子输运与平流相比可以忽略不计，以及为何对未解析的湍流输运进行参数化是必不可少的。",
            "id": "3791297",
            "problem": "考虑一个水平均匀的海洋混合层，该混合层被湍流充分搅拌，并且在其深度上近似为非分层的。假设流动受不可压缩动量方程和被动标量平流-扩散方程控制，并取特征尺度为速度尺度 $U$、代表混合层深度的长度尺度 $L$、海水的运动粘度 $\\nu$ 和标量（温度）的分子扩散率 $\\kappa$。从动量和标量输运方程出发，使用尺度 $U$ 和 $L$ 进行无量纲化，并确定衡量动量和标量输运中平流过程与扩散过程相对重要性的无量纲参数。然后，使用以下代表中纬度风混合表层的科学合理值：\n- $U = 0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$，\n- $L = 60 \\ \\mathrm{m}$，\n- $\\nu = 1.05 \\times 10^{-6} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$ （中等温度下海水的运动粘度），\n- $\\kappa = 1.40 \\times 10^{-7} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$ （海水的分子热扩散率），\n\n计算该混合层的雷诺数（记为 $\\mathrm{Re}$）和佩克莱数（记为 $\\mathrm{Pe}$）。根据您推导出的这些无量纲数的大小，推断在这种情况下，在计算海洋学中通过涡粘度和涡扩散系数来表示未解析的湍流输运是否合适。将 $\\mathrm{Re}$ 和 $\\mathrm{Pe}$ 的最终数值结果表示为行矩阵 $\\left( \\mathrm{Re} \\ \\mathrm{Pe} \\right)$，并四舍五入到三位有效数字。由于这些是无量纲数，最终答案中不应包含物理单位。",
            "solution": "首先对问题进行验证，发现其具有科学依据、提法恰当、客观且自洽。所提供的物理参数对于指定的海洋学情景是符合实际的。因此，有必要给出一个完整的解。\n\n该问题要求我们分析海洋混合层中动量和被动标量的平流与扩散输运机制的相对重要性。这通过对控制方程进行无量纲化来实现。\n\n设速度场为 $\\mathbf{u}(\\mathbf{x}, t)$，被动标量浓度为 $C(\\mathbf{x}, t)$。流动由不可压缩动量（Navier-Stokes）方程控制，标量输运由平流-扩散方程控制。我们关注代表平流和扩散的项。\n\n不可压缩流体的动量方程为：\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\mathbf{f} + \\nu \\nabla^2 \\mathbf{u}\n$$\n其中，项 $(\\mathbf{u} \\cdot \\nabla)\\mathbf{u}$ 代表动量的平流（惯性），项 $\\nu \\nabla^2 \\mathbf{u}$ 代表动量的粘性扩散。这里，$\\rho$ 是流体密度，$p$ 是压力，$\\mathbf{f}$ 代表体积力（如重力和科里奥利力），$\\nu$ 是运动粘度。\n\n被动标量 $C$ 的输运方程为：\n$$\n\\frac{\\partial C}{\\partial t} + (\\mathbf{u} \\cdot \\nabla)C = \\kappa \\nabla^2 C\n$$\n其中，项 $(\\mathbf{u} \\cdot \\nabla)C$ 代表标量的平流，而 $\\kappa \\nabla^2 C$ 代表其分子扩散。这里，$\\kappa$ 是标量的分子扩散率。\n\n为了对这些方程进行无量纲化，我们引入用上标 $*$ 表示的无量纲变量。我们使用特征速度尺度 $U$ 和长度尺度 $L$：\n$$\n\\mathbf{x} = L\\mathbf{x}^* \\quad \\implies \\quad \\nabla = \\frac{1}{L}\\nabla^*\n$$\n$$\n\\mathbf{u} = U\\mathbf{u}^*\n$$\n平流的特征时间尺度为 $T = L/U$，因此我们定义无量纲时间为：\n$$\nt = \\frac{L}{U}t^* \\quad \\implies \\quad \\frac{\\partial}{\\partial t} = \\frac{U}{L}\\frac{\\partial}{\\partial t^*}\n$$\n我们以类似的方式定义无量纲标量 $C^*$，$C = C_{scale}C^*$，其中 $C_{scale}$ 是标量的特征尺度。\n\n将这些代入动量平流和扩散项中：\n- 平流项：$(\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = (U\\mathbf{u}^* \\cdot \\frac{1}{L}\\nabla^*)(U\\mathbf{u}^*) = \\frac{U^2}{L}(\\mathbf{u}^* \\cdot \\nabla^*)\\mathbf{u}^*$\n- 粘性项：$\\nu \\nabla^2 \\mathbf{u} = \\nu \\left(\\frac{1}{L^2}\\nabla^{*2}\\right)(U\\mathbf{u}^*) = \\frac{\\nu U}{L^2}\\nabla^{*2}\\mathbf{u}^*$\n\n平流项与粘性项的量级之比为：\n$$\n\\frac{|(\\mathbf{u} \\cdot \\nabla)\\mathbf{u}|}{|\\nu \\nabla^2 \\mathbf{u}|} \\sim \\frac{U^2/L}{\\nu U/L^2} = \\frac{UL}{\\nu}\n$$\n这个无量纲数就是雷诺数，$\\mathrm{Re}$。\n$$\n\\mathrm{Re} = \\frac{UL}{\\nu}\n$$\n它代表惯性力与粘性力之比。\n\n类似地，将无量纲变量代入标量输运方程中：\n- 平流项：$(\\mathbf{u} \\cdot \\nabla)C = (U\\mathbf{u}^* \\cdot \\frac{1}{L}\\nabla^*)(C_{scale}C^*) = \\frac{U C_{scale}}{L}(\\mathbf{u}^* \\cdot \\nabla^*)C^*$\n- 扩散项：$\\kappa \\nabla^2 C = \\kappa \\left(\\frac{1}{L^2}\\nabla^{*2}\\right)(C_{scale}C^*) = \\frac{\\kappa C_{scale}}{L^2}\\nabla^{*2}C^*$\n\n平流项与扩散项的量级之比为：\n$$\n\\frac{|(\\mathbf{u} \\cdot \\nabla)C|}{|\\kappa \\nabla^2 C|} \\sim \\frac{U C_{scale}/L}{\\kappa C_{scale}/L^2} = \\frac{UL}{\\kappa}\n$$\n这个无量纲数就是佩克莱数，$\\mathrm{Pe}$。\n$$\n\\mathrm{Pe} = \\frac{UL}{\\kappa}\n$$\n它代表了物理量被流体平流输运的速率与该物理量在适当梯度驱动下扩散的速率之比。\n\n现在我们使用给定的数据计算 $\\mathrm{Re}$ 和 $\\mathrm{Pe}$ 的值：\n- $U = 0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$\n- $L = 60 \\ \\mathrm{m}$\n- $\\nu = 1.05 \\times 10^{-6} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$\n- $\\kappa = 1.40 \\times 10^{-7} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$\n\n雷诺数为：\n$$\n\\mathrm{Re} = \\frac{UL}{\\nu} = \\frac{(0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1})(60 \\ \\mathrm{m})}{1.05 \\times 10^{-6} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}} = \\frac{18}{1.05 \\times 10^{-6}} \\approx 17142857\n$$\n四舍五入到三位有效数字，$\\mathrm{Re} = 1.71 \\times 10^7$。\n\n佩克莱数为：\n$$\n\\mathrm{Pe} = \\frac{UL}{\\kappa} = \\frac{(0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1})(60 \\ \\mathrm{m})}{1.40 \\times 10^{-7} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}} = \\frac{18}{1.40 \\times 10^{-7}} \\approx 128571428\n$$\n四舍五入到三位有效数字，$\\mathrm{Pe} = 1.29 \\times 10^8$。\n\n计算出的雷诺数 $\\mathrm{Re} \\approx 1.71 \\times 10^7$ 非常大。对于大多数流体流动，向湍流的过渡发生在 $\\mathrm{Re}$ 值量级为 $10^3 - 10^5$ 时。如此量级的雷诺数表明流动是高度湍流的。在这样的状态下，动量的平流输运（惯性）在量级上远超过分子粘性扩散多个数量级。\n\n同样，佩克莱数 $\\mathrm{Pe} \\approx 1.29 \\times 10^8$ 也非常大。这表明标量（温度）通过流动的平流输运远远超过其在分子水平上的扩散。\n\n在计算海洋学中，数值模型将海洋离散化到网格上。网格分辨率通常在水平方向上为公里量级，在垂直方向上为米到几十米的量级。在如此高能的环境中，这些网格间距太粗，无法解析湍流运动的最小尺度（Kolmogorov尺度）或标量混合的最小尺度（Batchelor尺度），这些尺度在毫米量级或更小。\n\n由于分子粘度和扩散率的直接影响在模型可解析的尺度上完全可以忽略不计，但未解析的湍流涡旋的集体效应是高效地混合动量和标量，因此这些次网格尺度的湍流输运过程必须被参数化。涡粘度（$A_v$）和涡扩散率（$K_v$）的概念是用于此参数化的一种常用但简化的方法。这些涡系数不是流体本身的属性，而是流动的属性，代表了由湍流引起的增强混合。它们通常比其分子对应物（$\\nu$ 和 $\\kappa$）大几个数量级。\n\n因此，$\\mathrm{Re}$ 和 $\\mathrm{Pe}$ 的极大值明确证实了流动处于湍流状态，在这种状态下，与大尺度上的平流相比，分子输运是微不足道的。这为需要参数化未解析的湍流混合提供了基本的物理依据。在这种情况下，使用涡粘度和涡扩散系数是计算海洋模型中表示这些效应的标准且适当的方法。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.71 \\times 10^{7}  1.29 \\times 10^{8}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "既然我们理解了引入涡动系数的必要性，那么我们如何从实际测量中确定它们的值呢？本实践  探讨了一种从微结构数据中估算跨等密度面扩散率 ($K_{\\rho}$) 的常用海洋学方法。您将从第一性原理推导著名的 Osborn 模型，并应用误差传播技术来理解湍流能量耗散率 ($\\epsilon$) 和层结 ($N^2$) 的测量不确定性如何影响最终的扩散率估算值。",
            "id": "3791296",
            "problem": "海洋内部的一项跨等密度面混合研究使用微结构测量来估算一个垂直均匀区域内的湍动能（TKE）耗散率 $\\epsilon$ 和浮力频率的平方 $N^{2}$。其目标是推断跨等密度面扩散率 $K_{\\rho}$，并量化由 $\\epsilon$ 和 $N^{2}$ 的测量误差所带来的不确定性。从第一性原理出发：稳态湍动能收支、跨等密度面浮力通量的定义，以及恒定混合效率 $\\Gamma$（假定在该区域内与 $\\epsilon$ 和 $N^{2}$ 无关）的概念。在不使用任何快捷公式的情况下，推导一个将 $K_{\\rho}$ 与 $\\epsilon$、$N^{2}$ 和 $\\Gamma$ 联系起来的表达式。然后，将 $K_{\\rho}$ 视为测量量的函数，进行一阶不确定性传播分析。\n\n假设有以下科学上真实的条件和数据：\n- 在该区域内，混合效率是恒定的，等于 $\\Gamma = 0.2$。\n- 测得的平均耗散率为 $\\epsilon = 5.0 \\times 10^{-10}$ 瓦特/千克。\n- 测得的平均浮力频率的平方为 $N^{2} = 2.0 \\times 10^{-5}$ /秒平方。\n- 两个测量平均值的分数（相对）一西格玛不确定度服从零均值高斯分布，其标准差分别为 $\\sigma_{\\epsilon,\\mathrm{rel}} = 0.40$ 和 $\\sigma_{N^{2},\\mathrm{rel}} = 0.20$。\n- 由于采样期间共同的环境变异性，$\\epsilon$ 和 $N^{2}$ 的分数误差具有 $r = 0.25$ 的相关系数。\n\n使用关于测量平均值的线性化方法，传播这些误差，以获得 $K_{\\rho}$ 的一西格玛标准不确定度。将最终的不确定度以平方米/秒为单位表示，并将您的答案四舍五入到三位有效数字。",
            "solution": "该问题要求从第一性原理推导跨等密度面扩散率 $K_{\\rho}$，并根据给定的测量误差计算其不确定性。\n\n首先，我们推导 $K_{\\rho}$ 的表达式。推导始于跨等密度面浮力通量 $B$ 的定义，它表示湍流运动克服稳定密度层结所做的单位质量功的速率。它是湍动能（TKE）的一个汇，也是平均势能的一个源。浮力通量定义为：\n$$ B = \\frac{g}{\\rho_0} \\overline{w' \\rho'} $$\n其中 $g$ 是重力加速度，$\\rho_0$ 是参考密度，$\\overline{w' \\rho'}$ 是垂直方向上的平均湍流密度通量。为了在稳定层结中发生湍流混合，相对于其平均位置，必须有较重水的净向上输运和较轻水的净向下输运。这对应于垂直速度脉动 $w'$ 和密度脉动 $\\rho'$ 之间的正相关，因此有 $\\overline{w' \\rho'}  0$ 和 $B  0$。\n\n湍流密度通量使用涡动扩散率，或称跨等密度面扩散率 $K_{\\rho}$ 进行参数化：\n$$ \\overline{w' \\rho'} = -K_{\\rho} \\frac{d\\bar{\\rho}}{dz} $$\n其中 $\\frac{d\\bar{\\rho}}{dz}$ 是平均垂直密度梯度。将其代入 $B$ 的定义中得到：\n$$ B = \\frac{g}{\\rho_0} \\left( -K_{\\rho} \\frac{d\\bar{\\rho}}{dz} \\right) = K_{\\rho} \\left( -\\frac{g}{\\rho_0} \\frac{d\\bar{\\rho}}{dz} \\right) $$\n括号中的项是浮力频率的平方 $N^2$ 的定义：\n$$ N^2 = -\\frac{g}{\\rho_0} \\frac{d\\bar{\\rho}}{dz} $$\n对于稳定层结，$\\frac{d\\bar{\\rho}}{dz}  0$，所以 $N^2  0$。因此，我们建立了浮力通量、跨等密度面扩散率和层结之间的关系：\n$$ B = K_{\\rho} N^2 $$\n\n问题陈述使用恒定混合效率 $\\Gamma$ 的概念。在稳态湍动能收支（其中产生项平衡耗散项和浮力通量，即 $P = \\epsilon + B$）的背景下，混合效率正式定义为浮力通量与湍动能产生项的比值，$\\Gamma = B/P$。由 Osborn (1980) 提出的一个常见且更简单的模型，将浮力通量参数化为湍动能耗散率 $\\epsilon$ 的一部分。该模型有效地将混合效率定义为：\n$$ \\Gamma = \\frac{B}{\\epsilon} $$\n该模型假设耗散的能量是湍流级串可用总能量的一个良好代理。将其与我们关于 $B$ 的表达式相结合，我们得到：\n$$ \\Gamma \\epsilon = K_{\\rho} N^2 $$\n求解跨等密度面扩散率 $K_{\\rho}$，得到所需的表达式：\n$$ K_{\\rho} = \\frac{\\Gamma \\epsilon}{N^2} $$\n\n接下来，我们进行一阶不确定性传播，以求出 $K_{\\rho}$ 的标准不确定度。量 $K_{\\rho}$ 是测量变量 $\\epsilon$ 和 $N^2$ 的函数。混合效率 $\\Gamma$ 是一个给定的常数，没有不确定性。对于两个相关变量的函数 $K_{\\rho}(\\epsilon, N^2)$，其方差 $\\sigma_{K_{\\rho}}^2$ 的通用公式为：\n$$ \\sigma_{K_{\\rho}}^2 \\approx \\left(\\frac{\\partial K_{\\rho}}{\\partial \\epsilon}\\right)^2 \\sigma_{\\epsilon}^2 + \\left(\\frac{\\partial K_{\\rho}}{\\partial N^2}\\right)^2 \\sigma_{N^2}^2 + 2 \\left(\\frac{\\partial K_{\\rho}}{\\partial \\epsilon}\\right) \\left(\\frac{\\partial K_{\\rho}}{\\partial N^2}\\right) \\mathrm{Cov}(\\epsilon, N^2) $$\n其中 $\\sigma_{\\epsilon}^2$ 和 $\\sigma_{N^2}^2$ 分别是 $\\epsilon$ 和 $N^2$ 的方差，$\\mathrm{Cov}(\\epsilon, N^2)$ 是它们的协方差。偏导数在变量的平均值处求值。\n\n使用分数（相对）不确定度更为方便。我们可以用相对方差 $\\sigma_{K_{\\rho},\\mathrm{rel}}^2 = \\sigma_{K_{\\rho}}^2 / K_{\\rho}^2$ 来表示上述公式。对于形式为 $K_{\\rho} = \\Gamma \\epsilon^a (N^2)^b$ 且 $a=1$ 和 $b=-1$ 的函数，其相对方差由下式给出：\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx a^2 \\sigma_{\\epsilon,\\mathrm{rel}}^2 + b^2 \\sigma_{N^2,\\mathrm{rel}}^2 + 2ab \\, r \\, \\sigma_{\\epsilon,\\mathrm{rel}} \\sigma_{N^2,\\mathrm{rel}} $$\n其中 $\\sigma_{\\epsilon,\\mathrm{rel}} = \\sigma_{\\epsilon}/\\epsilon$ 和 $\\sigma_{N^2,\\mathrm{rel}} = \\sigma_{N^2}/N^2$ 是相对标准不确定度，$r$ 是 $\\epsilon$ 和 $N^2$ 分数误差之间的相关系数。代入 $a=1$ 和 $b=-1$：\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx (1)^2 \\sigma_{\\epsilon,\\mathrm{rel}}^2 + (-1)^2 \\sigma_{N^2,\\mathrm{rel}}^2 + 2(1)(-1) r \\, \\sigma_{\\epsilon,\\mathrm{rel}} \\sigma_{N^2,\\mathrm{rel}} $$\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx \\sigma_{\\epsilon,\\mathrm{rel}}^2 + \\sigma_{N^2,\\mathrm{rel}}^2 - 2 r \\, \\sigma_{\\epsilon,\\mathrm{rel}} \\sigma_{N^2,\\mathrm{rel}} $$\n我们已知以下数值：\n-   $\\sigma_{\\epsilon,\\mathrm{rel}} = 0.40$\n-   $\\sigma_{N^2,\\mathrm{rel}} = 0.20$\n-   $r = 0.25$\n\n将这些值代入 $K_{\\rho}$ 的相对方差方程中：\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx (0.40)^2 + (0.20)^2 - 2(0.25)(0.40)(0.20) $$\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx 0.16 + 0.04 - (0.5)(0.08) $$\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx 0.20 - 0.04 = 0.16 $$\n$K_{\\rho}$ 的相对标准不确定度是该值的平方根：\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}} = \\sqrt{0.16} = 0.40 $$\n\n为了求得绝对标准不确定度 $\\sigma_{K_{\\rho}}$，我们必须首先使用给定的 $\\epsilon$ 和 $N^2$ 的平均值以及常数 $\\Gamma$ 来计算 $K_{\\rho}$ 的平均值：\n-   $\\Gamma = 0.2$\n-   $\\epsilon = 5.0 \\times 10^{-10} \\text{ W/kg} = 5.0 \\times 10^{-10} \\text{ m}^2/\\text{s}^3$\n-   $N^2 = 2.0 \\times 10^{-5} \\text{ s}^{-2}$\n\n$$ K_{\\rho} = \\frac{\\Gamma \\epsilon}{N^2} = \\frac{(0.2)(5.0 \\times 10^{-10} \\text{ m}^2/\\text{s}^3)}{2.0 \\times 10^{-5} \\text{ s}^{-2}} $$\n$$ K_{\\rho} = \\frac{1.0 \\times 10^{-10} \\text{ m}^2/\\text{s}^3}{2.0 \\times 10^{-5} \\text{ s}^{-2}} = 0.5 \\times 10^{-5} \\text{ m}^2/\\text{s} = 5.0 \\times 10^{-6} \\text{ m}^2/\\text{s} $$\n那么，$K_{\\rho}$ 的绝对一西格玛标准不确定度为：\n$$ \\sigma_{K_{\\rho}} = K_{\\rho} \\times \\sigma_{K_{\\rho},\\mathrm{rel}} = (5.0 \\times 10^{-6} \\text{ m}^2/\\text{s}) \\times 0.40 $$\n$$ \\sigma_{K_{\\rho}} = 2.0 \\times 10^{-6} \\text{ m}^2/\\text{s} $$\n问题要求将答案四舍五入到三位有效数字。\n$$ \\sigma_{K_{\\rho}} = 2.00 \\times 10^{-6} \\text{ m}^2/\\text{s} $$",
            "answer": "$$\n\\boxed{2.00 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "最后的步骤是在数值海洋模型中实现涡动扩散的概念。本练习  将指导您在交错网格上对垂直扩散方程进行离散化，这是计算流体动力学中的一项核心技术。通过推导隐式求解器所需的三对角矩阵系数，您将了解湍流输运是如何在模型中被稳定而高效地表示和求解的。",
            "id": "3791243",
            "problem": "考虑一个处于静力平衡状态的一维垂直海水柱，其中被动示踪剂浓度 $T(z,t)$ 的演化仅由涡动扩散系数为 $K(z)$ 的垂直湍流扩散控制。从示踪剂守恒定律和 Fick 扩散定律出发，其连续形式的控制方程为\n$$\n\\frac{\\partial T}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial z}\\!\\left(K(z)\\,\\frac{\\partial T}{\\partial z}\\right).\n$$\n假设在交错的垂直网格上进行有限体积离散化：示踪剂未知量 $T_i$ 位于网格中心 $z_i$（$i=1,\\dots,N$），而涡动扩散系数为 $K$ 的湍流通量在网格界面 $z_{i+1/2}$（$i=1,\\dots,N-1$）上进行计算。设网格厚度为 $\\Delta z_i = z_{i+1/2} - z_{i-1/2}$，中心间距为 $\\Delta z_{i+1/2} = z_{i+1} - z_i$。用 $K_{i+1/2} = K(z_{i+1/2})$ 表示界面涡动扩散系数。在顶部和底部边界施加零通量边界条件，即扩散通量 $F_{1/2}$ 和 $F_{N+1/2}$ 为零。\n\n单独对扩散项使用时间步长为 $\\Delta t$ 的后向欧拉（BE）隐式时间离散化方法，推导有限体积形式的离散垂直扩散算子，并为新时间层 $t^{n+1}$ 的未知向量 $\\boldsymbol{T}^{n+1} = (T_1^{n+1},\\dots,T_N^{n+1})^{\\top}$ 组装生成的线性系统。你的推导必须从连续的示踪剂守恒定律和 Fick 定律开始，在交错网格上一致地表示通量及其散度，并仔细考虑不均匀的垂直间距。\n\n最后，通过给出内部模板系数 $a_i$、$b_i$ 和 $c_i$（$i = 2,\\dots,N-1$）的闭式解析表达式，写出隐式求解器中使用的三对角矩阵形式，其中 $a_i$ 乘以 $T_{i-1}^{n+1}$，$b_i$ 乘以 $T_i^{n+1}$，$c_i$ 乘以 $T_{i+1}^{n+1}$。将你的最终答案表示为关于 $\\Delta t$、$K_{i\\pm 1/2}$、$\\Delta z_i$ 和 $\\Delta z_{i\\pm 1/2}$ 的 $(a_i, b_i, c_i)$ 的单个解析表达式。不需要进行数值计算。如果引入任何首字母缩略词，请在首次使用时定义（例如，首次出现时写“后向欧拉（BE）”）。",
            "solution": "该问题是有效的。这是一个计算流体动力学中适定的、有科学依据的问题，要求推导一个标准的数值格式。\n\n推导从控制体示踪剂守恒定律的积分形式开始。对于一维垂直柱，我们考虑示踪剂 $T$ 的一个有限体积，或网格单元 $V_i$。该网格单元 $i$ 以 $z_i$ 为中心，从界面 $z_{i-1/2}$ 延伸到界面 $z_{i+1/2}$。示踪剂守恒定律指出，体积内示踪剂总量的变化率等于穿过其边界的示踪剂净通量。\n设垂直扩散通量用 $F(z,t)$ 表示。网格单元 $i$ 的守恒定律为：\n$$\n\\frac{d}{dt} \\int_{z_{i-1/2}}^{z_{i+1/2}} T(z,t) \\, dz = F(z_{i-1/2}, t) - F(z_{i+1/2}, t)\n$$\n在有限体积法中，我们用网格平均浓度 $T_i(t)$ 与网格单元的体积（此处为厚度）$\\Delta z_i = z_{i+1/2} - z_{i-1/2}$ 的乘积来近似该积分：\n$$\n\\int_{z_{i-1/2}}^{z_{i+1/2}} T(z,t) \\, dz \\approx T_i(t) \\Delta z_i\n$$\n将此代入守恒定律，得到网格平均浓度的半离散方程：\n$$\n\\Delta z_i \\frac{d T_i}{dt} = F_{i-1/2} - F_{i+1/2}\n$$\n其中 $F_{i\\pm 1/2}$ 表示网格界面 $z_{i\\pm 1/2}$ 处的通量。\n\n问题陈述在控制方程 $\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial z}\\left(K(z)\\,\\frac{\\partial T}{\\partial z}\\right)$ 中给出了通量和示踪剂梯度之间的关系，这是一种 Fick 定律的形式。这意味着扩散通量为 $F = -K(z)\\frac{\\partial T}{\\partial z}$，守恒定律为 $\\frac{\\partial T}{\\partial t} + \\frac{\\partial F}{\\partial z} = 0$。因此我们有 $F_{i+1/2} = - \\left( K(z)\\frac{\\partial T}{\\partial z} \\right)_{z=z_{i+1/2}}$。\n在交错网格上，界面 $z_{i+1/2}$ 处的梯度使用相邻网格中心 $z_i$ 和 $z_{i+1}$ 处的示踪剂值来近似：\n$$\n\\left(\\frac{\\partial T}{\\partial z}\\right)_{z=z_{i+1/2}} \\approx \\frac{T_{i+1}(t) - T_i(t)}{z_{i+1} - z_i} = \\frac{T_{i+1}(t) - T_i(t)}{\\Delta z_{i+1/2}}\n$$\n界面处的涡动扩散系数给定为 $K_{i+1/2}$。因此，网格单元 $i$ 的上界面处的离散通量为：\n$$\nF_{i+1/2} = -K_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta z_{i+1/2}}\n$$\n类似地，下界面处的通量为：\n$$\nF_{i-1/2} = -K_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta z_{i-1/2}}\n$$\n将这些离散通量代入半离散守恒定律得到：\n$$\n\\Delta z_i \\frac{d T_i}{dt} = \\left(-K_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta z_{i-1/2}}\\right) - \\left(-K_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta z_{i+1/2}}\\right)\n$$\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta z_i} \\left( K_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta z_{i+1/2}} - K_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta z_{i-1/2}} \\right)\n$$\n这就是描述离散示踪剂浓度时间演化的常微分方程组。\n\n接下来，我们使用时间步长为 $\\Delta t$ 的后向欧拉（BE）隐式格式进行时间离散化。对于形式为 $\\frac{dy}{dt} = f(y)$ 的方程，BE 格式为 $\\frac{y^{n+1}-y^n}{\\Delta t} = f(y^{n+1})$。我们将此应用于我们的半离散方程，在新的时间层 $n+1$ 上计算右侧项（扩散项）：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{1}{\\Delta z_i} \\left( K_{i+1/2} \\frac{T_{i+1}^{n+1} - T_i^{n+1}}{\\Delta z_{i+1/2}} - K_{i-1/2} \\frac{T_i^{n+1} - T_{i-1}^{n+1}}{\\Delta z_{i-1/2}} \\right)\n$$\n我们的目标是组装一个形式为 $\\mathbf{A} \\boldsymbol{T}^{n+1} = \\boldsymbol{T}^n$ 的线性系统，这需要重排方程，将含有未知数 $T_j^{n+1}$ 的项分组到左侧，将已知数 $T_i^n$ 放在右侧。\n首先，乘以 $\\Delta t$：\n$$\nT_i^{n+1} - T_i^n = \\frac{\\Delta t}{\\Delta z_i} \\left( K_{i+1/2} \\frac{T_{i+1}^{n+1} - T_i^{n+1}}{\\Delta z_{i+1/2}} - K_{i-1/2} \\frac{T_i^{n+1} - T_{i-1}^{n+1}}{\\Delta z_{i-1/2}} \\right)\n$$\n现在，展开并合并乘以 $T_{i-1}^{n+1}$、$T_i^{n+1}$ 和 $T_{i+1}^{n+1}$ 的项：\n$$\nT_i^{n+1} - T_i^n = \\left(\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\\right) T_{i+1}^{n+1} - \\left(\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\\right) T_i^{n+1} - \\left(\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_i^{n+1} + \\left(\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_{i-1}^{n+1}\n$$\n将所有带上标 $n+1$ 的项移到左侧：\n$$\n-\\left(\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_{i-1}^{n+1} + \\left(1 + \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}} + \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_i^{n+1} - \\left(\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\\right) T_{i+1}^{n+1} = T_i^n\n$$\n这是内部网格点 $i$（$i=2,\\dots,N-1$）的线性方程。该方程具有三对角形式 $a_i T_{i-1}^{n+1} + b_i T_i^{n+1} + c_i T_{i+1}^{n+1} = T_i^n$。\n通过比较系数，我们可以确定 $a_i$、$b_i$ 和 $c_i$：\n\n- $T_{i-1}^{n+1}$ 的系数是 $a_i$：\n$$\na_i = - \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\n$$\n- $T_i^{n+1}$ 的系数是 $b_i$：\n$$\nb_i = 1 + \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}} + \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\n$$\n- $T_{i+1}^{n+1}$ 的系数是 $c_i$：\n$$\nc_i = - \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\n$$\n这些是用于隐式求解器的三对角矩阵的内部模板系数的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}  1 + \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}} + \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}  -\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}} \\end{pmatrix}}\n$$"
        }
    ]
}