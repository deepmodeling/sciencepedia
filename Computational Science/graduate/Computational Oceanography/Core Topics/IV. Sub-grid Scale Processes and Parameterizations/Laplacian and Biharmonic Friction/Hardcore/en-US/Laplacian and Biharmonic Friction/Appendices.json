{
    "hands_on_practices": [
        {
            "introduction": "To apply concepts like friction in a computational model, we must first translate continuous mathematical operators into a discrete form that a computer can process. This foundational exercise () walks you through the derivation of the finite-difference stencil for the Laplacian operator, $\\nabla^2$, on an Arakawa C-grid. By using Taylor series expansions, you will build the discrete operator from first principles, gaining essential insight into how spatial derivatives are represented in many ocean circulation models.",
            "id": "3798097",
            "problem": "Consider the horizontal friction term in an ocean circulation model, which uses the Laplacian operator acting on the zonal velocity component. The model is discretized on the Arakawa C-grid (C-grid), where the zonal velocity component $u$ resides at the eastern and western faces of each cell. Let the grid be uniform in both horizontal directions with spacings $\\Delta x$ and $\\Delta y$. Denote the location of a generic $u$-point as $(x_{i+\\frac{1}{2}}, y_{j})$, and define $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$ on the $u$-grid. Assume smoothness of $u(x,y)$ such that Taylor series expansions are valid.\n\nStarting only from the definition of the Laplacian $\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}$ and Taylor series expansions around $(x_{i+\\frac{1}{2}}, y_{j})$, derive the second-order centered finite-difference discretization for $\\nabla^{2} u$ evaluated at the $u$-point $(x_{i+\\frac{1}{2}}, y_{j})$ on the C-grid with uniform spacings $\\Delta x$ and $\\Delta y$. In your derivation, identify which neighboring $u$-points are required to form the stencil at $(i,j)$. Express your final result as a single closed-form analytical expression in terms of $u_{i,j}$ and its neighboring $u$-points, $\\Delta x$, and $\\Delta y$. No numerical evaluation is required, and no physical units are to be reported in the final expression.",
            "solution": "The problem statement is a valid and well-posed exercise in numerical methods for partial differential equations, specifically within the context of computational oceanography. It asks for the derivation of a standard finite-difference approximation. All necessary information is provided, the assumptions are physically and mathematically sound for this type of problem, and there are no contradictions or ambiguities.\n\nThe objective is to derive the second-order centered finite-difference approximation for the Laplacian operator, $\\nabla^{2} u$, evaluated at a zonal velocity point $u_{i,j}$ on an Arakawa C-grid. The position of this point is defined as $(x_{i+\\frac{1}{2}}, y_{j})$, and the velocity value is denoted $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$. The grid is uniform with spacings $\\Delta x$ and $\\Delta y$.\n\nThe Laplacian operator in two dimensions is defined as:\n$$\n\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}\n$$\nWe will derive the finite-difference approximations for each second-derivative term separately and then sum them. The derivation relies on Taylor series expansions of the function $u(x,y)$, which is assumed to be sufficiently smooth.\n\nFirst, let us discretize the $\\frac{\\partial^{2} u}{\\partial x^{2}}$ term at the point $(x_{i+\\frac{1}{2}}, y_{j})$. We need to use neighboring points on the $u$-grid. In the $x$-direction, the neighbors of $u_{i,j}$ are $u_{i+1,j}$ and $u_{i-1,j}$, which are located at distances $+\\Delta x$ and $-\\Delta x$ respectively.\nThe coordinates are:\n- Central point: $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$\n- Neighbor to the east: $u_{i+1,j} = u(x_{i+1+\\frac{1}{2}}, y_{j}) = u(x_{i+\\frac{1}{2}} + \\Delta x, y_{j})$\n- Neighbor to the west: $u_{i-1,j} = u(x_{i-1+\\frac{1}{2}}, y_{j}) = u(x_{i+\\frac{1}{2}} - \\Delta x, y_{j})$\n\nThe Taylor series expansion of $u$ around the point $(x_{i+\\frac{1}{2}}, y_{j})$ for the neighbors in the $x$-direction are:\n$$\nu_{i+1,j} = u_{i,j} + \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i,j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\n$$\nu_{i-1,j} = u_{i,j} - \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i,j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} - \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\nTo obtain an expression for the second derivative, we sum these two equations. The odd-order derivative terms cancel out:\n$$\nu_{i+1,j} + u_{i-1,j} = 2u_{i,j} + (\\Delta x)^{2} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\nRearranging to solve for the second partial derivative with respect to $x$ yields:\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} = \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + O((\\Delta x)^{2})\n$$\nThis is the second-order accurate centered finite-difference approximation for $\\frac{\\partial^{2} u}{\\partial x^{2}}$.\n\nNext, we follow an analogous procedure for the $\\frac{\\partial^{2} u}{\\partial y^{2}}$ term. The neighbors of $u_{i,j}$ in the $y$-direction are $u_{i,j+1}$ and $u_{i,j-1}$, located at distances $+\\Delta y$ and $-\\Delta y$.\n- Neighbor to the north: $u_{i,j+1} = u(x_{i+\\frac{1}{2}}, y_{j+1}) = u(x_{i+\\frac{1}{2}}, y_{j} + \\Delta y)$\n- Neighbor to the south: $u_{i,j-1} = u(x_{i+\\frac{1}{2}}, y_{j-1}) = u(x_{i+\\frac{1}{2}}, y_{j} - \\Delta y)$\n\nThe Taylor series expansions for these neighbors around $(x_{i+\\frac{1}{2}}, y_{j})$ are:\n$$\nu_{i,j+1} = u_{i,j} + \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i,j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} + \\frac{(\\Delta y)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial y^{3}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\n$$\nu_{i,j-1} = u_{i,j} - \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i,j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} - \\frac{(\\Delta y)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial y^{3}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\nSumming these two equations cancels the odd-order derivative terms:\n$$\nu_{i,j+1} + u_{i,j-1} = 2u_{i,j} + (\\Delta y)^{2} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\nSolving for the second partial derivative with respect to $y$ gives:\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} = \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}} + O((\\Delta y)^{2})\n$$\nThis is the second-order accurate centered finite-difference approximation for $\\frac{\\partial^{2} u}{\\partial y^{2}}$.\n\nFinally, we combine the approximations for the two partial derivatives to obtain the discretization of the Laplacian operator. The truncation errors are additive.\n$$\n(\\nabla^{2} u)_{i,j} = \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j}\n$$\nSubstituting the derived finite-difference formulas:\n$$\n(\\nabla^{2} u)_{i,j} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}}\n$$\nThe neighboring $u$-points required to form the stencil at the point $(i,j)$ are $u_{i+1,j}$, $u_{i-1,j}$, $u_{i,j+1}$, and $u_{i,j-1}$. This constitutes the standard five-point stencil for the Laplacian operator on a rectangular grid. This expression is the required second-order centered finite-difference discretization.",
            "answer": "$$\n\\boxed{\\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}}}\n$$"
        },
        {
            "introduction": "Coupling a spatial discretization with a time-stepping scheme raises the critical issue of numerical stability, where a poor choice of time step, $\\Delta t$, can lead to explosive and unphysical error growth. This practice () introduces one of the most powerful tools for analyzing this issue: von Neumann stability analysis. You will apply this method to a diffusion equation to derive the strict upper limit on the time step, a crucial skill for ensuring the robustness of any explicit numerical simulation.",
            "id": "3798049",
            "problem": "Consider a two-dimensional, horizontally homogeneous ocean mixed-layer tracer field subject to Laplacian diffusion with a constant mixing coefficient $A_{2}$, governed by the partial differential equation $T_{t} = A_{2} \\nabla_{h}^{2} T$, where $\\nabla_{h}^{2}$ is the horizontal Laplacian. The field $T(x,y,t)$ is initially uniform in the meridional direction $y$ and remains so for all time due to the imposed initial and boundary conditions, but it can vary zonally in $x$. The domain is doubly periodic, and the horizontal grid is uniform with spacings $\\Delta x$ and $\\Delta y$. The explicit forward-Euler, second-order centered finite-difference time-stepping for the two-dimensional Laplacian is\n$$\nT_{i,j}^{n+1} = T_{i,j}^{n} + \\Delta t \\, A_{2} \\left[\\frac{T_{i+1,j}^{n} - 2 T_{i,j}^{n} + T_{i-1,j}^{n}}{\\Delta x^{2}} + \\frac{T_{i,j+1}^{n} - 2 T_{i,j}^{n} + T_{i,j-1}^{n}}{\\Delta y^{2}}\\right].\n$$\nUsing von Neumann stability analysis (Fourier-mode analysis of the linear update), derive the maximum allowable explicit time step $\\Delta t$ that guarantees stability for all admissible zonal wavenumbers under the stated meridional uniformity (that is, for modes with meridional wavenumber equal to zero). Your derivation must start from the governing equation and the given finite-difference scheme, and proceed by analyzing the amplification factor for Fourier modes. Express your final bound for $\\Delta t$ as a closed-form analytic expression in terms of $A_{2}$ and $\\Delta x$. Express your answer in seconds. Do not use any empirical or memorized stability formulas; derive the result from first principles. The final answer must be a single analytic expression.",
            "solution": "We begin from the linear tracer diffusion equation $T_{t} = A_{2} \\nabla_{h}^{2} T$ on a uniform grid with spacings $\\Delta x$ and $\\Delta y$, discretized in time by an explicit forward Euler step and in space by second-order centered differences for the two-dimensional Laplacian. The fully discrete update is\n$$\nT_{i,j}^{n+1} = T_{i,j}^{n} + \\Delta t \\, A_{2} \\left[\\frac{T_{i+1,j}^{n} - 2 T_{i,j}^{n} + T_{i-1,j}^{n}}{\\Delta x^{2}} + \\frac{T_{i,j+1}^{n} - 2 T_{i,j}^{n} + T_{i,j-1}^{n}}{\\Delta y^{2}}\\right].\n$$\nThe stated meridional uniformity means that the field is independent of $y$ at all times: $T_{i,j}^{n} = \\theta_{i}^{n}$ for all $j$. Because the spatial operator is linear and the initial condition has zero meridional variation, the discrete meridional second difference vanishes:\n$$\n\\frac{T_{i,j+1}^{n} - 2 T_{i,j}^{n} + T_{i,j-1}^{n}}{\\Delta y^{2}} = \\frac{\\theta_{i}^{n} - 2 \\theta_{i}^{n} + \\theta_{i}^{n}}{\\Delta y^{2}} = 0.\n$$\nTherefore, under this constraint, the update reduces to the one-dimensional explicit diffusion scheme in $x$,\n$$\n\\theta_{i}^{n+1} = \\theta_{i}^{n} + \\Delta t \\, A_{2} \\frac{\\theta_{i+1}^{n} - 2 \\theta_{i}^{n} + \\theta_{i-1}^{n}}{\\Delta x^{2}}.\n$$\nTo analyze stability via von Neumann analysis, we consider discrete Fourier modes in the zonal index $i$:\n$$\n\\theta_{i}^{n} = \\hat{\\theta}^{n} \\exp\\!\\bigl(\\mathrm{i} k_{x} \\, i \\, \\Delta x\\bigr),\n$$\nwhere $k_{x}$ is the zonal wavenumber and $\\mathrm{i} = \\sqrt{-1}$. Substituting this ansatz into the update yields the amplification relation $\\hat{\\theta}^{n+1} = G(k_{x}) \\, \\hat{\\theta}^{n}$ with amplification factor $G(k_{x})$ determined by\n$$\nG(k_{x}) = 1 + \\Delta t \\, A_{2} \\frac{\\exp(\\mathrm{i} k_{x} \\Delta x) - 2 + \\exp(-\\mathrm{i} k_{x} \\Delta x)}{\\Delta x^{2}}.\n$$\nUsing the identity $\\exp(\\mathrm{i}\\phi) + \\exp(-\\mathrm{i}\\phi) = 2 \\cos \\phi$ and $\\cos \\phi - 1 = -2 \\sin^{2}(\\phi/2)$, we simplify the numerator:\n$$\n\\exp(\\mathrm{i} k_{x} \\Delta x) - 2 + \\exp(-\\mathrm{i} k_{x} \\Delta x) = 2 \\cos(k_{x} \\Delta x) - 2 = -4 \\sin^{2}\\!\\left(\\frac{k_{x} \\Delta x}{2}\\right).\n$$\nThus,\n$$\nG(k_{x}) = 1 - \\Delta t \\, A_{2} \\frac{4}{\\Delta x^{2}} \\sin^{2}\\!\\left(\\frac{k_{x} \\Delta x}{2}\\right).\n$$\nFor explicit forward Euler applied to a linear constant-coefficient diffusion operator, stability in the von Neumann sense requires that the magnitude of the amplification factor not exceed unity for all resolvable wavenumbers, namely $|G(k_{x})| \\leq 1$ for all $k_{x}$ in the discrete spectrum. Because $G(k_{x})$ is real and less than or equal to $1$, the most restrictive condition arises from the lower bound $G(k_{x}) \\geq -1$. Therefore, we impose\n$$\n1 - \\Delta t \\, A_{2} \\frac{4}{\\Delta x^{2}} \\sin^{2}\\!\\left(\\frac{k_{x} \\Delta x}{2}\\right) \\geq -1 \\quad \\text{for all admissible } k_{x}.\n$$\nRearranging,\n$$\n\\Delta t \\, A_{2} \\frac{4}{\\Delta x^{2}} \\sin^{2}\\!\\left(\\frac{k_{x} \\Delta x}{2}\\right) \\leq 2.\n$$\nThe left-hand side is maximized when $\\sin^{2}((k_{x} \\Delta x)/2)$ attains its maximal value of $1$, corresponding to the highest resolvable wavenumber (the grid-scale mode). Hence the necessary and sufficient stability condition is\n$$\n\\Delta t \\, A_{2} \\frac{4}{\\Delta x^{2}} \\leq 2,\n$$\nwhich yields the maximum allowable explicit time step\n$$\n\\Delta t \\leq \\frac{\\Delta x^{2}}{2 A_{2}}.\n$$\nThis is the desired bound expressed in terms of $A_{2}$ and $\\Delta x$. Dimensionally, $A_{2}$ has units of $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$, $\\Delta x^{2}$ has units of $\\mathrm{m}^{2}$, so the ratio has units of seconds, as required.",
            "answer": "$$\\boxed{\\frac{\\Delta x^{2}}{2 A_{2}}}$$"
        },
        {
            "introduction": "The choice between Laplacian ($\\nabla^2$) and biharmonic ($\\nabla^4$) friction is motivated by their differing effects across various spatial scales. Biharmonic friction, or hyperviscosity, is prized for its ability to damp small-scale numerical noise while preserving larger-scale physical structures. This culminating exercise () is a hands-on numerical experiment where you will verify this 'scale-selective' damping, directly comparing the two operators and quantifying why hyperviscosity is an essential tool for modern high-resolution ocean modeling.",
            "id": "3798048",
            "problem": "Consider the doubly periodic, barotropic quasi-geostrophic (QG) model in a square domain of side length $L$ under linear friction, where the nonlinear advection is suppressed to isolate the action of viscous operators. Let $q(x,y,t)$ denote a scalar field (e.g., potential vorticity anomaly) with periodic boundary conditions in both directions, and let $q_{\\mathbf{k}}(t)$ denote its Fourier coefficient at wavenumber vector $\\mathbf{k} = (k_x,k_y)$, with $k_x$ and $k_y$ integers determined by the discrete Fourier transform on the domain. Define two linear damping operators:\n- Laplacian (viscous) friction: $D_2[q] = \\nu_2 \\nabla^2 q$.\n- Biharmonic (hyperviscous) friction: $D_4[q] = - \\nu_4 \\nabla^4 q$.\n\nWith nonlinear advection removed and external forcing set to zero, the evolution equation reduces to\n$$\n\\frac{\\partial q}{\\partial t} = D[q] ,\n$$\nwhere $D[q]$ is either $D_2[q]$ or $D_4[q]$ depending on the selected friction. In Fourier space, using that the Fourier symbol of the Laplacian is $-k^2$ with $k^2 = k_x^2+k_y^2$, the mode amplitude $q_{\\mathbf{k}}(t)$ evolves independently via\n$$\n\\frac{d q_{\\mathbf{k}}}{d t} = - \\lambda_p(\\mathbf{k}) q_{\\mathbf{k}} ,\n$$\nwhere for Laplacian friction ($p=2$), the damping rate is $\\lambda_2(\\mathbf{k}) = \\nu_2 k^2$, and for biharmonic friction ($p=4$), it is $\\lambda_4(\\mathbf{k}) = \\nu_4 k^4$. This implies exact exponential decay\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left(- \\nu_2 k^2 t \\right) \\quad \\text{for Laplacian friction,}\n$$\nand\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left(- \\nu_4 k^4 t \\right) \\quad \\text{for biharmonic friction.}\n$$\n\nYour task is to design and implement a spectral test that verifies the selective damping of biharmonic (hyperviscous) friction relative to Laplacian friction by measuring the decay of mode amplitudes in a doubly periodic QG model. The test must:\n1. Use a discrete Fourier representation on a square domain of size $L = 2\\pi$ with $N$ grid points per direction, so that the discrete wavenumbers satisfy $k_x, k_y \\in \\{-N/2+1, \\ldots, -1, 0, 1, \\ldots, N/2\\}$ and the fundamental wavenumber scale is $1$.\n2. Initialize spectral coefficients $q_{\\mathbf{k}}(0)$ such that only prescribed modes are nonzero and equal to $1$ (dimensionless), to isolate their independent decay under the friction operator.\n3. Time-step the spectral coefficients $q_{\\mathbf{k}}(t)$ under pure friction using a forward Euler method with time step $\\Delta t$:\n$$\nq_{\\mathbf{k}}^{n+1} = q_{\\mathbf{k}}^{n} \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right) ,\n$$\nfor $n = 0, 1, \\ldots, N_t-1$ where $N_t$ is the number of time steps and $t = N_t \\Delta t$. This discretization must be applied in spectral space and must not include nonlinear advection or external forcing.\n4. Measure the numerically evolved amplitudes $q_{\\mathbf{k}}(t)$ for the selected modes and compare them to the exact analytical amplitudes to quantify the error.\n5. Construct a selectivity metric that compares the relative damping of a high-wavenumber mode to a low-wavenumber mode under hyperviscosity versus Laplacian friction. Define\n$$\nR = \\frac{\\left( \\frac{A_{\\text{high}}^{(4)}}{A_{\\text{low}}^{(4)}} \\right)}{\\left( \\frac{A_{\\text{high}}^{(2)}}{A_{\\text{low}}^{(2)}} \\right)} ,\n$$\nwhere $A_{\\text{high}}^{(4)}$ and $A_{\\text{low}}^{(4)}$ are the analytical amplitudes under biharmonic friction at time $t$ for a high-wavenumber mode and a low-wavenumber mode, respectively, and $A_{\\text{high}}^{(2)}$ and $A_{\\text{low}}^{(2)}$ are the corresponding analytical amplitudes under Laplacian friction. Selective damping by hyperviscosity is indicated by $R < 1$, meaning hyperviscosity damps high wavenumbers more strongly relative to low wavenumbers than Laplacian friction.\n\nAll quantities are nondimensional; no physical units are required. Angles do not appear; no angle unit is required.\n\nImplement a program that performs the following test suite and outputs the results:\n\n- Common spectral parameters:\n  - Domain size $L = 2\\pi$ (dimensionless).\n  - Grid size $N = 64$.\n  - Total integration time $T = 10$.\n  - Time step $\\Delta t = 0.005$.\n  - Biharmonic friction coefficient $\\nu_4 = 5.0 \\times 10^{-6}$.\n  - Laplacian friction coefficient $\\nu_2 = 1.0 \\times 10^{-3}$.\n  - Low-wavenumber mode $\\mathbf{k}_{\\text{low}} = (1,0)$.\n  - High-wavenumber mode $\\mathbf{k}_{\\text{high}} = (16,16)$.\n  - Zero-wavenumber mode $\\mathbf{k}_{\\text{zero}} = (0,0)$.\n\n- Test cases and required outputs:\n  1. Under biharmonic friction, initialize only $\\mathbf{k}_{\\text{low}}$ to $1$ at $t=0$, evolve to $t=T$, and compute the relative error between the numerical amplitude and the analytical amplitude. Output this error as a float.\n  2. Under biharmonic friction, initialize only $\\mathbf{k}_{\\text{high}}$ to $1$ at $t=0$, evolve to $t=T$, and compute the relative error between the numerical amplitude and the analytical amplitude. Output this error as a float.\n  3. Compute the selectivity metric $R$ defined above using analytical amplitudes at $t=T$. Output $R$ as a float.\n  4. Under biharmonic friction, initialize only $\\mathbf{k}_{\\text{zero}}$ to $1$ at $t=0$, evolve to $t=T$, and compute the absolute change in amplitude $|q_{\\mathbf{k}_{\\text{zero}}}(T) - q_{\\mathbf{k}_{\\text{zero}}}(0)|$. Output this change as a float.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be a float in standard decimal notation. The program must be self-contained and require no user input or external files.",
            "solution": "The user has provided a valid, well-posed problem statement from the field of computational oceanography. The task is to implement a spectral test to verify the selective damping properties of biharmonic friction compared to Laplacian friction and to quantify the accuracy of a numerical time-stepping scheme against the exact analytical solution.\n\nThe physical model is a simplified barotropic quasi-geostrophic (QG) model where only linear friction is active. The evolution of a scalar field's Fourier coefficient, $q_{\\mathbf{k}}(t)$, at wavenumber vector $\\mathbf{k}=(k_x, k_y)$ is given by the ordinary differential equation:\n$$\n\\frac{d q_{\\mathbf{k}}}{d t} = - \\lambda_p(\\mathbf{k}) q_{\\mathbf{k}}\n$$\nwhere the damping rate $\\lambda_p(\\mathbf{k})$ depends on the type of friction. For Laplacian friction ($p=2$), the damping rate is $\\lambda_2(\\mathbf{k}) = \\nu_2 k^2$, and for biharmonic friction ($p=4$), it is $\\lambda_4(\\mathbf{k}) = \\nu_4 k^4$. Here, $k^2 = k_x^2 + k_y^2$ is the squared wavenumber magnitude, and $\\nu_2$ and $\\nu_4$ are the respective friction coefficients.\n\nThe analytical solution to this equation, given an initial amplitude $q_{\\mathbf{k}}(0)$, is an exponential decay:\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left( - \\lambda_p(\\mathbf{k}) t \\right)\n$$\nThe problem requires simulating this decay using a forward Euler numerical scheme with a time step $\\Delta t$. The update rule for a single time step is:\n$$\nq_{\\mathbf{k}}^{n+1} = q_{\\mathbf{k}}^{n} \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right)\n$$\nAfter $N_t$ steps, where the total integration time is $T = N_t \\Delta t$, the numerical solution is:\n$$\nq_{\\mathbf{k}}(T) = q_{\\mathbf{k}}(0) \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right)^{N_t}\n$$\nThe following values are provided for the test:\n- Domain size $L = 2\\pi$.\n- Grid size $N = 64$.\n- Total integration time $T = 10$.\n- Time step $\\Delta t = 0.005$, which implies $N_t = T / \\Delta t = 10 / 0.005 = 2000$ steps.\n- Biharmonic friction coefficient $\\nu_4 = 5.0 \\times 10^{-6}$.\n- Laplacian friction coefficient $\\nu_2 = 1.0 \\times 10^{-3}$.\n- Initial amplitude for all test modes is $q_{\\mathbf{k}}(0) = 1$.\nThe specific modes under consideration are the low-wavenumber mode $\\mathbf{k}_{\\text{low}} = (1,0)$, the high-wavenumber mode $\\mathbf{k}_{\\text{high}} = (16,16)$, and the zero-wavenumber mode $\\mathbf{k}_{\\text{zero}} = (0,0)$.\n\nThe solution proceeds by evaluating each of the four test cases.\n\n**Test Case 1: Relative error for $\\mathbf{k}_{\\text{low}}$ under biharmonic friction**\n\nFor $\\mathbf{k}_{\\text{low}} = (1,0)$, the squared wavenumber magnitude is $k_{\\text{low}}^2 = 1^2 + 0^2 = 1$, and its fourth power is $k_{\\text{low}}^4 = (1)^2 = 1$.\nThe biharmonic damping rate is $\\lambda_4(\\mathbf{k}_{\\text{low}}) = \\nu_4 k_{\\text{low}}^4 = (5.0 \\times 10^{-6}) \\times 1 = 5.0 \\times 10^{-6}$.\nThe exact analytical amplitude at $t=T$ is:\n$$\nA_{\\text{low, analyt}}^{(4)} = q_{\\mathbf{k}_{\\text{low}}}(0) \\exp(-\\lambda_4(\\mathbf{k}_{\\text{low}}) T) = 1 \\cdot \\exp(-5.0 \\times 10^{-6} \\times 10) = \\exp(-5.0 \\times 10^{-5})\n$$\nThe numerical amplitude at $t=T$ is:\n$$\nA_{\\text{low, num}}^{(4)} = q_{\\mathbf{k}_{\\text{low}}}(0) (1 - \\Delta t \\lambda_4(\\mathbf{k}_{\\text{low}}))^{N_t} = 1 \\cdot (1 - 0.005 \\times 5.0 \\times 10^{-6})^{2000} = (1 - 2.5 \\times 10^{-8})^{2000}\n$$\nThe relative error is $\\text{err}_1 = |A_{\\text{low, num}}^{(4)} - A_{\\text{low, analyt}}^{(4)}| / |A_{\\text{low, analyt}}^{(4)}|$.\n\n**Test Case 2: Relative error for $\\mathbf{k}_{\\text{high}}$ under biharmonic friction**\n\nFor $\\mathbf{k}_{\\text{high}} = (16,16)$, the squared wavenumber magnitude is $k_{\\text{high}}^2 = 16^2 + 16^2 = 256 + 256 = 512$. The fourth power is $k_{\\text{high}}^4 = 512^2 = 262144$.\nThe biharmonic damping rate is $\\lambda_4(\\mathbf{k}_{\\text{high}}) = \\nu_4 k_{\\text{high}}^4 = (5.0 \\times 10^{-6}) \\times 262144 = 1.31072$.\nThe exact analytical amplitude at $t=T$ is:\n$$\nA_{\\text{high, analyt}}^{(4)} = q_{\\mathbf{k}_{\\text{high}}}(0) \\exp(-\\lambda_4(\\mathbf{k}_{\\text{high}}) T) = \\exp(-1.31072 \\times 10) = \\exp(-13.1072)\n$$\nThe numerical amplitude at $t=T$ is:\n$$\nA_{\\text{high, num}}^{(4)} = q_{\\mathbf{k}_{\\text{high}}}(0) (1 - \\Delta t \\lambda_4(\\mathbf{k}_{\\text{high}}))^{N_t} = (1 - 0.005 \\times 1.31072)^{2000} = (1 - 0.0065536)^{2000}\n$$\nThe relative error is $\\text{err}_2 = |A_{\\text{high, num}}^{(4)} - A_{\\text{high, analyt}}^{(4)}| / |A_{\\text{high, analyt}}^{(4)}|$.\n\n**Test Case 3: Selectivity Metric $R$**\n\nThe selectivity metric $R$ is defined based on analytical amplitudes:\n$$\nR = \\frac{\\left( A_{\\text{high}}^{(4)} / A_{\\text{low}}^{(4)} \\right)}{\\left( A_{\\text{high}}^{(2)} / A_{\\text{low}}^{(2)} \\right)}\n$$\nWe have already found $A_{\\text{low}}^{(4)} = \\exp(-5.0 \\times 10^{-5})$ and $A_{\\text{high}}^{(4)} = \\exp(-13.1072)$. We now compute the amplitudes for Laplacian friction.\nThe Laplacian damping rate for $\\mathbf{k}_{\\text{low}}$ is $\\lambda_2(\\mathbf{k}_{\\text{low}}) = \\nu_2 k_{\\text{low}}^2 = (1.0 \\times 10^{-3}) \\times 1 = 1.0 \\times 10^{-3}$.\nThe corresponding amplitude is $A_{\\text{low}}^{(2)} = \\exp(-\\lambda_2(\\mathbf{k}_{\\text{low}}) T) = \\exp(-1.0 \\times 10^{-3} \\times 10) = \\exp(-0.01)$.\nThe Laplacian damping rate for $\\mathbf{k}_{\\text{high}}$ is $\\lambda_2(\\mathbf{k}_{\\text{high}}) = \\nu_2 k_{\\text{high}}^2 = (1.0 \\times 10^{-3}) \\times 512 = 0.512$.\nThe corresponding amplitude is $A_{\\text{high}}^{(2)} = \\exp(-\\lambda_2(\\mathbf{k}_{\\text{high}}) T) = \\exp(-0.512 \\times 10) = \\exp(-5.12)$.\nSubstituting these into the formula for $R$:\n$$\nR = \\frac{\\exp(-13.1072) / \\exp(-5.0 \\times 10^{-5})}{\\exp(-5.12) / \\exp(-0.01)} = \\frac{\\exp(-13.1072 + 0.00005)}{\\exp(-5.12 + 0.01)} = \\frac{\\exp(-13.10715)}{\\exp(-5.11)}\n$$\n$$\nR = \\exp(-13.10715 - (-5.11)) = \\exp(-7.99715)\n$$\nA value of $R < 1$ indicates that biharmonic friction damps high wavenumbers more strongly relative to low wavenumbers than Laplacian friction does. The calculated value is expected to be very small, confirming the high selectivity of hyperviscosity.\n\n**Test Case 4: Absolute change for $\\mathbf{k}_{\\text{zero}}$ under biharmonic friction**\n\nFor the zero-wavenumber mode $\\mathbf{k}_{\\text{zero}}=(0,0)$, the wavenumber magnitude is $k_{\\text{zero}} = 0$. Consequently, $k_{\\text{zero}}^2 = 0$ and $k_{\\text{zero}}^4 = 0$.\nThe biharmonic damping rate is $\\lambda_4(\\mathbf{k}_{\\text{zero}}) = \\nu_4 k_{\\text{zero}}^4 = 0$.\nThe evolution of this mode is trivial. The analytical solution is $q_{\\mathbf{k}_{\\text{zero}}}(t) = q_{\\mathbf{k}_{\\text{zero}}}(0) \\exp(0) = q_{\\mathbf{k}_{\\text{zero}}}(0) = 1$.\nThe numerical solution is $q_{\\mathbf{k}_{\\text{zero}}}(T) = q_{\\mathbf{k}_{\\text{zero}}}(0) (1 - \\Delta t \\cdot 0)^{N_t} = 1 \\cdot (1)^{2000} = 1$.\nThe absolute change in amplitude is $|q_{\\mathbf{k}_{\\text{zero}}}(T) - q_{\\mathbf{k}_{\\text{zero}}}(0)| = |1 - 1| = 0$. This demonstrates that the mean component of the field is conserved under both friction operators, a crucial physical property correctly captured by the numerical scheme.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a spectral test to verify selective damping of biharmonic friction\n    and compare numerical results to analytical solutions.\n    \"\"\"\n\n    # Common parameters as specified in the problem statement\n    T = 10.0\n    dt = 0.005\n    nu4 = 5.0e-6\n    nu2 = 1.0e-3\n    k_low_vec = (1, 0)\n    k_high_vec = (16, 16)\n    k_zero_vec = (0, 0)\n\n    # Initial amplitude for all test modes is 1\n    q0 = 1.0\n\n    # Calculate number of time steps\n    Nt = int(T / dt)\n\n    results = []\n\n    # --- Test Case 1: Relative error for the low-wavenumber mode ---\n    k_low_sq = float(k_low_vec[0]**2 + k_low_vec[1]**2)\n    k_low_4 = k_low_sq**2\n    lambda_4_low = nu4 * k_low_4\n\n    # Analytical solution\n    q_analyt_low = q0 * np.exp(-lambda_4_low * T)\n\n    # Numerical solution using Forward Euler\n    q_num_low = q0 * (1.0 - dt * lambda_4_low)**Nt\n    \n    # Relative error\n    err1 = np.abs(q_num_low - q_analyt_low) / np.abs(q_analyt_low)\n    results.append(err1)\n\n    # --- Test Case 2: Relative error for the high-wavenumber mode ---\n    k_high_sq = float(k_high_vec[0]**2 + k_high_vec[1]**2)\n    k_high_4 = k_high_sq**2\n    lambda_4_high = nu4 * k_high_4\n\n    # Analytical solution\n    q_analyt_high = q0 * np.exp(-lambda_4_high * T)\n\n    # Numerical solution using Forward Euler\n    q_num_high = q0 * (1.0 - dt * lambda_4_high)**Nt\n    \n    # Relative error\n    err2 = np.abs(q_num_high - q_analyt_high) / np.abs(q_analyt_high)\n    results.append(err2)\n\n    # --- Test Case 3: Selectivity Metric R ---\n    # Amplitudes under biharmonic friction (already calculated)\n    A_low_4 = q_analyt_low\n    A_high_4 = q_analyt_high\n\n    # Amplitudes under Laplacian friction (analytical)\n    lambda_2_low = nu2 * k_low_sq\n    A_low_2 = q0 * np.exp(-lambda_2_low * T)\n    \n    lambda_2_high = nu2 * k_high_sq\n    A_high_2 = q0 * np.exp(-lambda_2_high * T)\n    \n    # Selectivity metric R\n    R = (A_high_4 / A_low_4) / (A_high_2 / A_low_2)\n    results.append(R)\n\n    # --- Test Case 4: Absolute change for the zero-wavenumber mode ---\n    k_zero_sq = float(k_zero_vec[0]**2 + k_zero_vec[1]**2)\n    k_zero_4 = k_zero_sq**2\n    lambda_4_zero = nu4 * k_zero_4\n    \n    # Numerical solution\n    q_num_zero = q0 * (1.0 - dt * lambda_4_zero)**Nt\n    \n    # Absolute change\n    abs_change_zero = np.abs(q_num_zero - q0)\n    results.append(abs_change_zero)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}