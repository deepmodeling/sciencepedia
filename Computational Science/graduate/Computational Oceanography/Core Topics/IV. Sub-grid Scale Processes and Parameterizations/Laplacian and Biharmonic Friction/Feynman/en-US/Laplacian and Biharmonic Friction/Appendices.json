{
    "hands_on_practices": [
        {
            "introduction": "The first step in numerically representing any differential operator is to formulate its discrete counterpart, or \"stencil.\" This foundational exercise guides you through deriving the classic five-point Laplacian stencil on an Arakawa C-grid, a ubiquitous tool in ocean modeling. By applying Taylor series expansions, you will translate the continuous operator into a finite-difference approximation, a core skill for any computational fluid dynamicist. ",
            "id": "3798097",
            "problem": "Consider the horizontal friction term in an ocean circulation model, which uses the Laplacian operator acting on the zonal velocity component. The model is discretized on the Arakawa C-grid (C-grid), where the zonal velocity component $u$ resides at the eastern and western faces of each cell. Let the grid be uniform in both horizontal directions with spacings $\\Delta x$ and $\\Delta y$. Denote the location of a generic $u$-point as $(x_{i+\\frac{1}{2}}, y_{j})$, and define $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$ on the $u$-grid. Assume smoothness of $u(x,y)$ such that Taylor series expansions are valid.\n\nStarting only from the definition of the Laplacian $\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}$ and Taylor series expansions around $(x_{i+\\frac{1}{2}}, y_{j})$, derive the second-order centered finite-difference discretization for $\\nabla^{2} u$ evaluated at the $u$-point $(x_{i+\\frac{1}{2}}, y_{j})$ on the C-grid with uniform spacings $\\Delta x$ and $\\Delta y$. In your derivation, identify which neighboring $u$-points are required to form the stencil at $(i,j)$. Express your final result as a single closed-form analytical expression in terms of $u_{i,j}$ and its neighboring $u$-points, $\\Delta x$, and $\\Delta y$. No numerical evaluation is required, and no physical units are to be reported in the final expression.",
            "solution": "The problem statement is a valid and well-posed exercise in numerical methods for partial differential equations, specifically within the context of computational oceanography. It asks for the derivation of a standard finite-difference approximation. All necessary information is provided, the assumptions are physically and mathematically sound for this type of problem, and there are no contradictions or ambiguities.\n\nThe objective is to derive the second-order centered finite-difference approximation for the Laplacian operator, $\\nabla^{2} u$, evaluated at a zonal velocity point $u_{i,j}$ on an Arakawa C-grid. The position of this point is defined as $(x_{i+\\frac{1}{2}}, y_{j})$, and the velocity value is denoted $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$. The grid is uniform with spacings $\\Delta x$ and $\\Delta y$.\n\nThe Laplacian operator in two dimensions is defined as:\n$$\n\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}\n$$\nWe will derive the finite-difference approximations for each second-derivative term separately and then sum them. The derivation relies on Taylor series expansions of the function $u(x,y)$, which is assumed to be sufficiently smooth.\n\nFirst, let us discretize the $\\frac{\\partial^{2} u}{\\partial x^{2}}$ term at the point $(x_{i+\\frac{1}{2}}, y_{j})$. We need to use neighboring points on the $u$-grid. In the $x$-direction, the neighbors of $u_{i,j}$ are $u_{i+1,j}$ and $u_{i-1,j}$, which are located at distances $+\\Delta x$ and $-\\Delta x$ respectively.\nThe coordinates are:\n- Central point: $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$\n- Neighbor to the east: $u_{i+1,j} = u(x_{i+1+\\frac{1}{2}}, y_{j}) = u(x_{i+\\frac{1}{2}} + \\Delta x, y_{j})$\n- Neighbor to the west: $u_{i-1,j} = u(x_{i-1+\\frac{1}{2}}, y_{j}) = u(x_{i+\\frac{1}{2}} - \\Delta x, y_{j})$\n\nThe Taylor series expansion of $u$ around the point $(x_{i+\\frac{1}{2}}, y_{j})$ for the neighbors in the $x$-direction are:\n$$\nu_{i+1,j} = u_{i,j} + \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i,j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\n$$\nu_{i-1,j} = u_{i,j} - \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i,j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} - \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\nTo obtain an expression for the second derivative, we sum these two equations. The odd-order derivative terms cancel out:\n$$\nu_{i+1,j} + u_{i-1,j} = 2u_{i,j} + (\\Delta x)^{2} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\nRearranging to solve for the second partial derivative with respect to $x$ yields:\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} = \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + O((\\Delta x)^{2})\n$$\nThis is the second-order accurate centered finite-difference approximation for $\\frac{\\partial^{2} u}{\\partial x^{2}}$.\n\nNext, we follow an analogous procedure for the $\\frac{\\partial^{2} u}{\\partial y^{2}}$ term. The neighbors of $u_{i,j}$ in the $y$-direction are $u_{i,j+1}$ and $u_{i,j-1}$, located at distances $+\\Delta y$ and $-\\Delta y$.\n- Neighbor to the north: $u_{i,j+1} = u(x_{i+\\frac{1}{2}}, y_{j+1}) = u(x_{i+\\frac{1}{2}}, y_{j} + \\Delta y)$\n- Neighbor to the south: $u_{i,j-1} = u(x_{i+\\frac{1}{2}}, y_{j-1}) = u(x_{i+\\frac{1}{2}}, y_{j} - \\Delta y)$\n\nThe Taylor series expansions for these neighbors around $(x_{i+\\frac{1}{2}}, y_{j})$ are:\n$$\nu_{i,j+1} = u_{i,j} + \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i,j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} + \\frac{(\\Delta y)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial y^{3}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\n$$\nu_{i,j-1} = u_{i,j} - \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i,j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} - \\frac{(\\Delta y)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial y^{3}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\nSumming these two equations cancels the odd-order derivative terms:\n$$\nu_{i,j+1} + u_{i,j-1} = 2u_{i,j} + (\\Delta y)^{2} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\nSolving for the second partial derivative with respect to $y$ gives:\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} = \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}} + O((\\Delta y)^{2})\n$$\nThis is the second-order accurate centered finite-difference approximation for $\\frac{\\partial^{2} u}{\\partial y^{2}}$.\n\nFinally, we combine the approximations for the two partial derivatives to obtain the discretization of the Laplacian operator. The truncation errors are additive.\n$$\n(\\nabla^{2} u)_{i,j} = \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j}\n$$\nSubstituting the derived finite-difference formulas:\n$$\n(\\nabla^{2} u)_{i,j} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}}\n$$\nThe neighboring $u$-points required to form the stencil at the point $(i,j)$ are $u_{i+1,j}$, $u_{i-1,j}$, $u_{i,j+1}$, and $u_{i,j-1}$. This constitutes the standard five-point stencil for the Laplacian operator on a rectangular grid. This expression is the required second-order centered finite-difference discretization.",
            "answer": "$$\n\\boxed{\\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}}}\n$$"
        },
        {
            "introduction": "While biharmonic friction offers superior scale selectivity, its higher-order derivatives impose stricter stability constraints on explicit time-stepping schemes. This practice challenges you to derive this constraint from first principles for a biharmonic operator constructed from a nine-point Laplacian stencil. Mastering this von Neumann stability analysis is crucial for building robust and efficient numerical models that employ hyperviscosity. ",
            "id": "3798050",
            "problem": "Consider the linear momentum equation in a barotropic ocean model with only biharmonic friction, written for a single velocity component as $\\partial_{t} u = -A_{4} \\nabla^{4} u$, where $A_{4} > 0$ is the biharmonic viscosity coefficient. Assume a doubly periodic square domain and a uniform Cartesian grid with spacing $\\Delta x = \\Delta y$. Let the time stepping be explicit forward Euler applied to a grid function $u_{i,j}^{n}$, and let the horizontal biharmonic operator be discretized as the composition of a nine-point discrete Laplacian with itself. The nine-point Laplacian $L_{h}$ is defined by\n$$\n(L_{h} u)_{i,j} = \\frac{1}{6 \\Delta x^{2}}\\Big(-20\\,u_{i,j} + 4\\big(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}\\big) + \\big(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\big)\\Big),\n$$\nand the discrete biharmonic operator is $\\nabla^{4}_{h} u = L_{h}(L_{h} u)$. Starting from first principles of linear stability via Fourier mode analysis on a periodic grid, determine the explicit time step upper bound for stability and show that it scales with grid spacing and biharmonic viscosity as $\\Delta t_{\\max} \\propto \\Delta x^{4}/A_{4}$. Compute the proportionality constant $C$ for the above stencil so that the bound can be written as $\\Delta t_{\\max} = C\\,\\Delta x^{4}/A_{4}$. Express $C$ as an exact, dimensionless number in simplest form. No rounding is necessary, and do not report any units with your final value of $C$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and contains all necessary information for a rigorous solution. We can therefore proceed with the validation and calculation.\n\nThe governing partial differential equation for a velocity component $u$ with biharmonic friction is\n$$\n\\frac{\\partial u}{\\partial t} = -A_{4} \\nabla^{4} u\n$$\nwhere $A_{4} > 0$ is the biharmonic viscosity coefficient. The problem specifies a spatial discretization on a uniform Cartesian grid with spacing $\\Delta x = \\Delta y$, and a temporal discretization using the explicit forward Euler method. The fully discretized equation is:\n$$\n\\frac{u_{i,j}^{n+1} - u_{i,j}^{n}}{\\Delta t} = -A_{4} \\nabla_{h}^{4} u_{i,j}^{n}\n$$\nwhere $u_{i,j}^{n}$ is the value of the velocity component at grid point $(i,j)$ and time step $n$. The discrete biharmonic operator is given by $\\nabla_{h}^{4} = L_{h}(L_{h})$, where $L_{h}$ is the nine-point discrete Laplacian. Thus, the time-stepping scheme is:\n$$\nu_{i,j}^{n+1} = u_{i,j}^{n} - \\Delta t A_{4} (L_{h}(L_{h}u^{n}))_{i,j}\n$$\nTo analyze the stability of this scheme, we perform a von Neumann stability analysis. We consider a single Fourier mode on the periodic grid:\n$$\nu_{i,j}^{n} = \\hat{u}^{n}(k_x, k_y) \\exp\\big(I(k_x i \\Delta x + k_y j \\Delta y)\\big)\n$$\nwhere $I = \\sqrt{-1}$ is the imaginary unit, and $k_x$, $k_y$ are the wavenumbers in the $x$ and $y$ directions, respectively. Substituting this into the time-stepping equation, we find how the amplitude of the mode, $\\hat{u}^{n}$, evolves. The action of a linear finite-difference operator on a Fourier mode is to multiply it by a complex number called the symbol of the operator. Let $\\hat{L}_h(k_x, k_y)$ be the symbol of the discrete Laplacian $L_h$. The symbol for the biharmonic operator $\\nabla_{h}^{4}$ is then $(\\hat{L}_h)^2$. The equation for the amplitude becomes:\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} - \\Delta t A_{4} (\\hat{L}_h)^2 \\hat{u}^{n}\n$$\nThe amplification factor $G(k_x, k_y)$ is the ratio of successive amplitudes, $G = \\hat{u}^{n+1} / \\hat{u}^{n}$:\n$$\nG(k_x, k_y) = 1 - \\Delta t A_{4} (\\hat{L}_h(k_x, k_y))^2\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any possible wavenumber, i.e., $|G| \\leq 1$.\n\nFirst, we must find the symbol $\\hat{L}_h$ of the nine-point Laplacian operator. Applying $L_h$ to the Fourier mode $u_{i,j} = \\exp(I(k_x i \\Delta x + k_y j \\Delta y))$:\n$$\n(L_{h} u)_{i,j} = \\frac{u_{i,j}}{6 \\Delta x^{2}}\\Big(-20 + 4(\\mathrm{e}^{I k_x \\Delta x} + \\mathrm{e}^{-I k_x \\Delta x} + \\mathrm{e}^{I k_y \\Delta y} + \\mathrm{e}^{-I k_y \\Delta y}) + (\\mathrm{e}^{I(k_x \\Delta x+k_y \\Delta y)} + \\mathrm{e}^{I(k_x \\Delta x-k_y \\Delta y)} + \\mathrm{e}^{I(-k_x \\Delta x+k_y \\Delta y)} + \\mathrm{e}^{I(-k_x \\Delta x-k_y \\Delta y)})\\Big)\n$$\nUsing the identity $2\\cos\\theta = \\mathrm{e}^{I\\theta} + \\mathrm{e}^{-I\\theta}$, we simplify the expression. The sum of the corner terms is $(\\mathrm{e}^{I k_x \\Delta x} + \\mathrm{e}^{-I k_x \\Delta x})(\\mathrm{e}^{I k_y \\Delta y} + \\mathrm{e}^{-I k_y \\Delta y}) = 4\\cos(k_x \\Delta x)\\cos(k_y \\Delta y)$. The symbol $\\hat{L}_h$ is therefore:\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^{2}} \\Big[ -20 + 8\\cos(k_x \\Delta x) + 8\\cos(k_y \\Delta y) + 4\\cos(k_x \\Delta x)\\cos(k_y \\Delta y) \\Big]\n$$\nUsing the identity $\\cos\\theta = 1 - 2\\sin^2(\\theta/2)$, let $\\alpha = k_x \\Delta x$ and $\\beta = k_y \\Delta y$.\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -20 + 8(1-2\\sin^2(\\alpha/2)) + 8(1-2\\sin^2(\\beta/2)) + 4(1-2\\sin^2(\\alpha/2))(1-2\\sin^2(\\beta/2)) \\Big]\n$$\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -20 + 8 - 16s_x^2 + 8 - 16s_y^2 + 4(1 - 2s_x^2 - 2s_y^2 + 4s_x^2 s_y^2) \\Big]\n$$\nwhere $s_x = \\sin(\\alpha/2)$ and $s_y = \\sin(\\beta/2)$.\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -4 - 16s_x^2 - 16s_y^2 + 4 - 8s_x^2 - 8s_y^2 + 16s_x^2 s_y^2 \\Big]\n$$\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -24s_x^2 - 24s_y^2 + 16s_x^2 s_y^2 \\Big] = -\\frac{4}{\\Delta x^2} \\Big[ \\sin^2\\Big(\\frac{k_x \\Delta x}{2}\\Big) + \\sin^2\\Big(\\frac{k_y \\Delta y}{2}\\Big) - \\frac{2}{3}\\sin^2\\Big(\\frac{k_x \\Delta x}{2}\\Big)\\sin^2\\Big(\\frac{k_y \\Delta y}{2}\\Big) \\Big]\n$$\nSince $\\hat{L}_h$ is real, $(\\hat{L}_h)^2 \\ge 0$. The amplification factor $G = 1 - \\Delta t A_4 (\\hat{L}_h)^2$ is also real. The stability condition $|G| \\le 1$ becomes $-1 \\le 1 - \\Delta t A_4 (\\hat{L}_h)^2 \\le 1$.\nThe right inequality implies $-\\Delta t A_4 (\\hat{L}_h)^2 \\le 0$, which is always true since $\\Delta t > 0$ and $A_4 > 0$.\nThe left inequality provides the constraint:\n$$\n-1 \\le 1 - \\Delta t A_4 (\\hat{L}_h)^2 \\implies \\Delta t A_4 (\\hat{L}_h)^2 \\le 2\n$$\nThis must hold for all wavenumbers. The most restrictive condition occurs when $(\\hat{L}_h)^2$ is maximum. Therefore, the maximum allowable time step is:\n$$\n\\Delta t_{\\max} = \\frac{2}{A_4 \\max_{k_x, k_y} \\big[(\\hat{L}_h)^2\\big]}\n$$\nWe need to find the maximum of $|\\hat{L}_h|$. Let $S_x = \\sin^2(k_x \\Delta x/2)$ and $S_y = \\sin^2(k_y \\Delta y/2)$. On a periodic grid, the non-dimensional wavenumbers $k_x \\Delta x$ and $k_y \\Delta y$ range from $-\\pi$ to $\\pi$. Thus $S_x$ and $S_y$ range from $0$ to $1$. We need to maximize the function $f(S_x, S_y) = S_x + S_y - \\frac{2}{3}S_x S_y$ on the unit square $[0,1] \\times [0,1]$.\nThe partial derivatives are $\\partial f/\\partial S_x = 1 - \\frac{2}{3}S_y$ and $\\partial f/\\partial S_y = 1 - \\frac{2}{3}S_x$. There are no critical points inside the domain, so the maximum must lie on the boundary. Evaluation on the boundary shows the maximum occurs at the corner $(S_x, S_y) = (1,1)$, which corresponds to the highest frequency (Nyquist) modes where $k_x \\Delta x = \\pm \\pi$ and $k_y \\Delta y = \\pm \\pi$.\n$$\n\\max f(S_x, S_y) = f(1,1) = 1 + 1 - \\frac{2}{3}(1)(1) = \\frac{4}{3}\n$$\nNow we can compute the maximum of $|\\hat{L}_h|$:\n$$\n\\max |\\hat{L}_h| = \\frac{4}{\\Delta x^2} \\left| \\max f(S_x, S_y) \\right| = \\frac{4}{\\Delta x^2} \\cdot \\frac{4}{3} = \\frac{16}{3\\Delta x^2}\n$$\nThe maximum of $(\\hat{L}_h)^2$ is simply the square of this value:\n$$\n\\max \\big[(\\hat{L}_h)^2\\big] = \\left(\\frac{16}{3\\Delta x^2}\\right)^2 = \\frac{256}{9\\Delta x^4}\n$$\nSubstituting this into the expression for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{2}{A_4 \\left(\\frac{256}{9\\Delta x^4}\\right)} = \\frac{18 \\Delta x^4}{256 A_4} = \\frac{9 \\Delta x^4}{128 A_4}\n$$\nThe problem asks for the proportionality constant $C$ in the relation $\\Delta t_{\\max} = C \\frac{\\Delta x^4}{A_4}$. By comparison, we find:\n$$\nC = \\frac{9}{128}\n$$",
            "answer": "$$\n\\boxed{\\frac{9}{128}}\n$$"
        },
        {
            "introduction": "The theoretical advantage of biharmonic friction lies in its ability to selectively damp small-scale numerical noise while preserving large-scale features of the flow. This hands-on coding exercise provides a clear, quantitative demonstration of this property by tracking the decay of different Fourier modes in a simplified spectral model. By comparing the effects of Laplacian ($D_2$) and biharmonic ($D_4$) operators, you will directly observe and measure the superior scale selectivity of hyperviscosity. ",
            "id": "3798048",
            "problem": "Consider the doubly periodic, barotropic quasi-geostrophic (QG) model in a square domain of side length $L$ under linear friction, where the nonlinear advection is suppressed to isolate the action of viscous operators. Let $q(x,y,t)$ denote a scalar field (e.g., potential vorticity anomaly) with periodic boundary conditions in both directions, and let $q_{\\mathbf{k}}(t)$ denote its Fourier coefficient at wavenumber vector $\\mathbf{k} = (k_x,k_y)$, with $k_x$ and $k_y$ integers determined by the discrete Fourier transform on the domain. Define two linear damping operators:\n- Laplacian (viscous) friction: $D_2[q] = \\nu_2 \\nabla^2 q$.\n- Biharmonic (hyperviscous) friction: $D_4[q] = - \\nu_4 \\nabla^4 q$.\n\nWith nonlinear advection removed and external forcing set to zero, the evolution equation reduces to\n$$\n\\frac{\\partial q}{\\partial t} = D[q] ,\n$$\nwhere $D[q]$ is either $D_2[q]$ or $D_4[q]$ depending on the selected friction. In Fourier space, using that the Fourier symbol of the Laplacian is $-k^2$ with $k^2 = k_x^2+k_y^2$, the mode amplitude $q_{\\mathbf{k}}(t)$ evolves independently via\n$$\n\\frac{d q_{\\mathbf{k}}}{d t} = - \\lambda_p(\\mathbf{k}) q_{\\mathbf{k}} ,\n$$\nwhere $p \\in \\{1,2\\}$, $\\lambda_1(\\mathbf{k}) = \\nu_2 k^2$ for Laplacian friction, and $\\lambda_2(\\mathbf{k}) = \\nu_4 k^4$ for biharmonic friction. This implies exact exponential decay\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left(- \\nu_2 k^2 t \\right) \\quad \\text{for Laplacian friction,}\n$$\nand\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left(- \\nu_4 k^4 t \\right) \\quad \\text{for biharmonic friction.}\n$$\n\nYour task is to design and implement a spectral test that verifies the selective damping of biharmonic (hyperviscous) friction relative to Laplacian friction by measuring the decay of mode amplitudes in a doubly periodic QG model. The test must:\n1. Use a discrete Fourier representation on a square domain of size $L = 2\\pi$ with $N$ grid points per direction, so that the discrete wavenumbers satisfy $k_x, k_y \\in \\{-N/2+1, \\ldots, -1, 0, 1, \\ldots, N/2\\}$ and the fundamental wavenumber scale is $1$.\n2. Initialize spectral coefficients $q_{\\mathbf{k}}(0)$ such that only prescribed modes are nonzero and equal to $1$ (dimensionless), to isolate their independent decay under the friction operator.\n3. Time-step the spectral coefficients $q_{\\mathbf{k}}(t)$ under pure friction using a forward Euler method with time step $\\Delta t$:\n$$\nq_{\\mathbf{k}}^{n+1} = q_{\\mathbf{k}}^{n} \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right) ,\n$$\nfor $n = 0, 1, \\ldots, N_t-1$ where $N_t$ is the number of time steps and $t = N_t \\Delta t$. This discretization must be applied in spectral space and must not include nonlinear advection or external forcing.\n4. Measure the numerically evolved amplitudes $q_{\\mathbf{k}}(t)$ for the selected modes and compare them to the exact analytical amplitudes to quantify the error.\n5. Construct a selectivity metric that compares the relative damping of a high-wavenumber mode to a low-wavenumber mode under hyperviscosity versus Laplacian friction. Define\n$$\nR = \\frac{\\left( \\frac{A_{\\text{high}}^{(4)}}{A_{\\text{low}}^{(4)}} \\right)}{\\left( \\frac{A_{\\text{high}}^{(2)}}{A_{\\text{low}}^{(2)}} \\right)} ,\n$$\nwhere $A_{\\text{high}}^{(4)}$ and $A_{\\text{low}}^{(4)}$ are the analytical amplitudes under biharmonic friction at time $t$ for a high-wavenumber mode and a low-wavenumber mode, respectively, and $A_{\\text{high}}^{(2)}$ and $A_{\\text{low}}^{(2)}$ are the corresponding analytical amplitudes under Laplacian friction. Selective damping by hyperviscosity is indicated by $R < 1$, meaning hyperviscosity damps high wavenumbers more strongly relative to low wavenumbers than Laplacian friction.\n\nAll quantities are nondimensional; no physical units are required. Angles do not appear; no angle unit is required.\n\nImplement a program that performs the following test suite and outputs the results:\n\n- Common spectral parameters:\n  - Domain size $L = 2\\pi$ (dimensionless).\n  - Grid size $N = 64$.\n  - Total integration time $T = 10$.\n  - Time step $\\Delta t = 0.005$.\n  - Biharmonic friction coefficient $\\nu_4 = 5.0 \\times 10^{-6}$.\n  - Laplacian friction coefficient $\\nu_2 = 1.0 \\times 10^{-3}$.\n  - Low-wavenumber mode $\\mathbf{k}_{\\text{low}} = (1,0)$.\n  - High-wavenumber mode $\\mathbf{k}_{\\text{high}} = (16,16)$.\n  - Zero-wavenumber mode $\\mathbf{k}_{\\text{zero}} = (0,0)$.\n\n- Test cases and required outputs:\n  1. Under biharmonic friction, initialize only $\\mathbf{k}_{\\text{low}}$ to $1$ at $t=0$, evolve to $t=T$, and compute the relative error between the numerical amplitude and the analytical amplitude. Output this error as a float.\n  2. Under biharmonic friction, initialize only $\\mathbf{k}_{\\text{high}}$ to $1$ at $t=0$, evolve to $t=T$, and compute the relative error between the numerical amplitude and the analytical amplitude. Output this error as a float.\n  3. Compute the selectivity metric $R$ defined above using analytical amplitudes at $t=T$. Output $R$ as a float.\n  4. Under biharmonic friction, initialize only $\\mathbf{k}_{\\text{zero}}$ to $1$ at $t=0$, evolve to $t=T$, and compute the absolute change in amplitude $|q_{\\mathbf{k}_{\\text{zero}}}(T) - q_{\\mathbf{k}_{\\text{zero}}}(0)|$. Output this change as a float.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be a float in standard decimal notation. The program must be self-contained and require no user input or external files.",
            "solution": "The user has provided a valid, well-posed problem statement from the field of computational oceanography. The task is to implement a spectral test to verify the selective damping properties of biharmonic friction compared to Laplacian friction and to quantify the accuracy of a numerical time-stepping scheme against the exact analytical solution.\n\nThe physical model is a simplified barotropic quasi-geostrophic (QG) model where only linear friction is active. The evolution of a scalar field's Fourier coefficient, $q_{\\mathbf{k}}(t)$, at wavenumber vector $\\mathbf{k}=(k_x, k_y)$ is given by the ordinary differential equation:\n$$\n\\frac{d q_{\\mathbf{k}}}{d t} = - \\lambda_p(\\mathbf{k}) q_{\\mathbf{k}}\n$$\nwhere the damping rate $\\lambda_p(\\mathbf{k})$ depends on the type of friction. For Laplacian friction ($p=1$), the damping rate is $\\lambda_1(\\mathbf{k}) = \\nu_2 k^2$, and for biharmonic friction ($p=2$), it is $\\lambda_2(\\mathbf{k}) = \\nu_4 k^4$. Here, $k^2 = k_x^2 + k_y^2$ is the squared wavenumber magnitude, and $\\nu_2$ and $\\nu_4$ are the respective friction coefficients.\n\nThe analytical solution to this equation, given an initial amplitude $q_{\\mathbf{k}}(0)$, is an exponential decay:\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left( - \\lambda_p(\\mathbf{k}) t \\right)\n$$\nThe problem requires simulating this decay using a forward Euler numerical scheme with a time step $\\Delta t$. The update rule for a single time step is:\n$$\nq_{\\mathbf{k}}^{n+1} = q_{\\mathbf{k}}^{n} \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right)\n$$\nAfter $N_t$ steps, where the total integration time is $T = N_t \\Delta t$, the numerical solution is:\n$$\nq_{\\mathbf{k}}(T) = q_{\\mathbf{k}}(0) \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right)^{N_t}\n$$\nThe following values are provided for the test:\n- Domain size $L = 2\\pi$.\n- Grid size $N = 64$.\n- Total integration time $T = 10$.\n- Time step $\\Delta t = 0.005$, which implies $N_t = T / \\Delta t = 10 / 0.005 = 2000$ steps.\n- Biharmonic friction coefficient $\\nu_4 = 5.0 \\times 10^{-6}$.\n- Laplacian friction coefficient $\\nu_2 = 1.0 \\times 10^{-3}$.\n- Initial amplitude for all test modes is $q_{\\mathbf{k}}(0) = 1$.\nThe specific modes under consideration are the low-wavenumber mode $\\mathbf{k}_{\\text{low}} = (1,0)$, the high-wavenumber mode $\\mathbf{k}_{\\text{high}} = (16,16)$, and the zero-wavenumber mode $\\mathbf{k}_{\\text{zero}} = (0,0)$.\n\nThe solution proceeds by evaluating each of the four test cases.\n\n**Test Case 1: Relative error for $\\mathbf{k}_{\\text{low}}$ under biharmonic friction**\n\nFor $\\mathbf{k}_{\\text{low}} = (1,0)$, the squared wavenumber magnitude is $k_{\\text{low}}^2 = 1^2 + 0^2 = 1$, and its fourth power is $k_{\\text{low}}^4 = (1)^2 = 1$.\nThe biharmonic damping rate is $\\lambda_2(\\mathbf{k}_{\\text{low}}) = \\nu_4 k_{\\text{low}}^4 = (5.0 \\times 10^{-6}) \\times 1 = 5.0 \\times 10^{-6}$.\nThe exact analytical amplitude at $t=T$ is:\n$$\nA_{\\text{low, analyt}}^{(4)} = q_{\\mathbf{k}_{\\text{low}}}(0) \\exp(-\\lambda_2(\\mathbf{k}_{\\text{low}}) T) = 1 \\cdot \\exp(-5.0 \\times 10^{-6} \\times 10) = \\exp(-5.0 \\times 10^{-5})\n$$\nThe numerical amplitude at $t=T$ is:\n$$\nA_{\\text{low, num}}^{(4)} = q_{\\mathbf{k}_{\\text{low}}}(0) (1 - \\Delta t \\lambda_2(\\mathbf{k}_{\\text{low}}))^{N_t} = 1 \\cdot (1 - 0.005 \\times 5.0 \\times 10^{-6})^{2000} = (1 - 2.5 \\times 10^{-8})^{2000}\n$$\nThe relative error is $\\text{err}_1 = |A_{\\text{low, num}}^{(4)} - A_{\\text{low, analyt}}^{(4)}| / |A_{\\text{low, analyt}}^{(4)}|$.\n\n**Test Case 2: Relative error for $\\mathbf{k}_{\\text{high}}$ under biharmonic friction**\n\nFor $\\mathbf{k}_{\\text{high}} = (16,16)$, the squared wavenumber magnitude is $k_{\\text{high}}^2 = 16^2 + 16^2 = 256 + 256 = 512$. The fourth power is $k_{\\text{high}}^4 = 512^2 = 262144$.\nThe biharmonic damping rate is $\\lambda_2(\\mathbf{k}_{\\text{high}}) = \\nu_4 k_{\\text{high}}^4 = (5.0 \\times 10^{-6}) \\times 262144 = 1.31072$.\nThe exact analytical amplitude at $t=T$ is:\n$$\nA_{\\text{high, analyt}}^{(4)} = q_{\\mathbf{k}_{\\text{high}}}(0) \\exp(-\\lambda_2(\\mathbf{k}_{\\text{high}}) T) = \\exp(-1.31072 \\times 10) = \\exp(-13.1072)\n$$\nThe numerical amplitude at $t=T$ is:\n$$\nA_{\\text{high, num}}^{(4)} = q_{\\mathbf{k}_{\\text{high}}}(0) (1 - \\Delta t \\lambda_2(\\mathbf{k}_{\\text{high}}))^{N_t} = (1 - 0.005 \\times 1.31072)^{2000} = (1 - 0.0065536)^{2000}\n$$\nThe relative error is $\\text{err}_2 = |A_{\\text{high, num}}^{(4)} - A_{\\text{high, analyt}}^{(4)}| / |A_{\\text{high, analyt}}^{(4)}|$.\n\n**Test Case 3: Selectivity Metric $R$**\n\nThe selectivity metric $R$ is defined based on analytical amplitudes:\n$$\nR = \\frac{\\left( A_{\\text{high}}^{(4)} / A_{\\text{low}}^{(4)} \\right)}{\\left( A_{\\text{high}}^{(2)} / A_{\\text{low}}^{(2)} \\right)}\n$$\nWe have already found $A_{\\text{low}}^{(4)} = \\exp(-5.0 \\times 10^{-5})$ and $A_{\\text{high}}^{(4)} = \\exp(-13.1072)$. We now compute the amplitudes for Laplacian friction.\nThe Laplacian damping rate for $\\mathbf{k}_{\\text{low}}$ is $\\lambda_1(\\mathbf{k}_{\\text{low}}) = \\nu_2 k_{\\text{low}}^2 = (1.0 \\times 10^{-3}) \\times 1 = 1.0 \\times 10^{-3}$.\nThe corresponding amplitude is $A_{\\text{low}}^{(2)} = \\exp(-\\lambda_1(\\mathbf{k}_{\\text{low}}) T) = \\exp(-1.0 \\times 10^{-3} \\times 10) = \\exp(-0.01)$.\nThe Laplacian damping rate for $\\mathbf{k}_{\\text{high}}$ is $\\lambda_1(\\mathbf{k}_{\\text{high}}) = \\nu_2 k_{\\text{high}}^2 = (1.0 \\times 10^{-3}) \\times 512 = 0.512$.\nThe corresponding amplitude is $A_{\\text{high}}^{(2)} = \\exp(-\\lambda_1(\\mathbf{k}_{\\text{high}}) T) = \\exp(-0.512 \\times 10) = \\exp(-5.12)$.\nSubstituting these into the formula for $R$:\n$$\nR = \\frac{\\exp(-13.1072) / \\exp(-5.0 \\times 10^{-5})}{\\exp(-5.12) / \\exp(-0.01)} = \\frac{\\exp(-13.1072 + 0.00005)}{\\exp(-5.12 + 0.01)} = \\frac{\\exp(-13.10715)}{\\exp(-5.11)}\n$$\n$$\nR = \\exp(-13.10715 - (-5.11)) = \\exp(-7.99715)\n$$\nA value of $R < 1$ indicates that biharmonic friction damps high wavenumbers more strongly relative to low wavenumbers than Laplacian friction does. The calculated value is expected to be very small, confirming the high selectivity of hyperviscosity.\n\n**Test Case 4: Absolute change for $\\mathbf{k}_{\\text{zero}}$ under biharmonic friction**\n\nFor the zero-wavenumber mode $\\mathbf{k}_{\\text{zero}}=(0,0)$, the wavenumber magnitude is $k_{\\text{zero}} = 0$. Consequently, $k_{\\text{zero}}^2 = 0$ and $k_{\\text{zero}}^4 = 0$.\nThe biharmonic damping rate is $\\lambda_2(\\mathbf{k}_{\\text{zero}}) = \\nu_4 k_{\\text{zero}}^4 = 0$.\nThe evolution of this mode is trivial. The analytical solution is $q_{\\mathbf{k}_{\\text{zero}}}(t) = q_{\\mathbf{k}_{\\text{zero}}}(0) \\exp(0) = q_{\\mathbf{k}_{\\text{zero}}}(0) = 1$.\nThe numerical solution is $q_{\\mathbf{k}_{\\text{zero}}}(T) = q_{\\mathbf{k}_{\\text{zero}}}(0) (1 - \\Delta t \\cdot 0)^{N_t} = 1 \\cdot (1)^{2000} = 1$.\nThe absolute change in amplitude is $|q_{\\mathbf{k}_{\\text{zero}}}(T) - q_{\\mathbf{k}_{\\text{zero}}}(0)| = |1 - 1| = 0$. This demonstrates that the mean component of the field is conserved under both friction operators, a crucial physical property correctly captured by the numerical scheme.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a spectral test to verify selective damping of biharmonic friction\n    and compare numerical results to analytical solutions.\n    \"\"\"\n\n    # Common parameters as specified in the problem statement\n    T = 10.0\n    dt = 0.005\n    nu4 = 5.0e-6\n    nu2 = 1.0e-3\n    k_low_vec = (1, 0)\n    k_high_vec = (16, 16)\n    k_zero_vec = (0, 0)\n\n    # Initial amplitude for all test modes is 1\n    q0 = 1.0\n\n    # Calculate number of time steps\n    Nt = int(T / dt)\n\n    results = []\n\n    # --- Test Case 1: Relative error for the low-wavenumber mode ---\n    k_low_sq = float(k_low_vec[0]**2 + k_low_vec[1]**2)\n    k_low_4 = k_low_sq**2\n    lambda_2_low = nu4 * k_low_4\n\n    # Analytical solution\n    q_analyt_low = q0 * np.exp(-lambda_2_low * T)\n\n    # Numerical solution using Forward Euler\n    q_num_low = q0 * (1.0 - dt * lambda_2_low)**Nt\n    \n    # Relative error\n    err1 = np.abs(q_num_low - q_analyt_low) / np.abs(q_analyt_low)\n    results.append(err1)\n\n    # --- Test Case 2: Relative error for the high-wavenumber mode ---\n    k_high_sq = float(k_high_vec[0]**2 + k_high_vec[1]**2)\n    k_high_4 = k_high_sq**2\n    lambda_2_high = nu4 * k_high_4\n\n    # Analytical solution\n    q_analyt_high = q0 * np.exp(-lambda_2_high * T)\n\n    # Numerical solution using Forward Euler\n    q_num_high = q0 * (1.0 - dt * lambda_2_high)**Nt\n    \n    # Relative error\n    err2 = np.abs(q_num_high - q_analyt_high) / np.abs(q_analyt_high)\n    results.append(err2)\n\n    # --- Test Case 3: Selectivity Metric R ---\n    # Amplitudes under biharmonic friction (already calculated)\n    A_low_4 = q_analyt_low\n    A_high_4 = q_analyt_high\n\n    # Amplitudes under Laplacian friction (analytical)\n    lambda_1_low = nu2 * k_low_sq\n    A_low_2 = q0 * np.exp(-lambda_1_low * T)\n    \n    lambda_1_high = nu2 * k_high_sq\n    A_high_2 = q0 * np.exp(-lambda_1_high * T)\n    \n    # Selectivity metric R\n    R = (A_high_4 / A_low_4) / (A_high_2 / A_low_2)\n    results.append(R)\n\n    # --- Test Case 4: Absolute change for the zero-wavenumber mode ---\n    k_zero_sq = float(k_zero_vec[0]**2 + k_zero_vec[1]**2)\n    k_zero_4 = k_zero_sq**2\n    lambda_2_zero = nu4 * k_zero_4\n    \n    # Numerical solution\n    q_num_zero = q0 * (1.0 - dt * lambda_2_zero)**Nt\n    \n    # Absolute change\n    abs_change_zero = np.abs(q_num_zero - q0)\n    results.append(abs_change_zero)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}