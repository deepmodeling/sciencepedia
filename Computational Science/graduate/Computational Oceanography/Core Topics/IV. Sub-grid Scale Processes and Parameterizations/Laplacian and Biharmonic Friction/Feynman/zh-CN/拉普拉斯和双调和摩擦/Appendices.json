{
    "hands_on_practices": [
        {
            "introduction": "任何数值海洋模型的基础都植根于其在离散网格上近似连续物理定律的能力。拉普拉斯算子 $\\nabla^2$ 是这些模型的基石，用于表示摩擦等扩散过程。第一个实践练习要求你从第一性原理出发，使用泰勒级数展开，在 Arakawa C-网格上推导出经典的拉普拉斯算子五点差分格式。掌握这一推导  对于理解连续的物理世界如何被转化为计算机的离散语言至关重要。",
            "id": "3798097",
            "problem": "考虑一个海洋环流模型中的水平摩擦项，该项使用作用于纬向速度分量的拉普拉斯算子。该模型在Arakawa C-网格（C-网格）上进行离散化，其中纬向速度分量 $u$ 位于每个网格单元的东、西侧面上。假设网格在两个水平方向上都是均匀的，间距分别为 $\\Delta x$ 和 $\\Delta y$。将一个通用 $u$ 点的位置记为 $(x_{i+\\frac{1}{2}}, y_{j})$，并在 $u$-网格上定义 $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$。假设 $u(x,y)$ 足够光滑，使得泰勒级数展开有效。\n\n仅从拉普拉斯算子的定义 $\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}$ 和在点 $(x_{i+\\frac{1}{2}}, y_{j})$ 周围的泰勒级数展开出发，推导在具有均匀间距 $\\Delta x$ 和 $\\Delta y$ 的C-网格上，于 $u$ 点 $(x_{i+\\frac{1}{2}}, y_{j})$ 处求值的 $\\nabla^{2} u$ 的二阶中心有限差分离散格式。在推导过程中，请指明构建点 $(i,j)$ 处模板所需的相邻 $u$ 点。将最终结果表示为以 $u_{i,j}$ 及其相邻 $u$ 点、$\\Delta x$ 和 $\\Delta y$ 表示的单一闭式解析表达式。无需进行数值计算，最终表达式中也无需报告任何物理单位。",
            "solution": "问题陈述是偏微分方程数值方法领域一个有效且适定的练习，特别是在计算海洋学的背景下。它要求推导一个标准的有限差分近似。所有必要的信息都已提供，对于这类问题，所作的假设在物理上和数学上都是合理的，并且没有矛盾或含糊不清之处。\n\n目标是在Arakawa C-网格上，推导在纬向速度点 $u_{i,j}$ 处求值的拉普拉斯算子 $\\nabla^{2} u$ 的二阶中心有限差分近似。该点的位置定义为 $(x_{i+\\frac{1}{2}}, y_{j})$，速度值记为 $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$。网格是均匀的，间距分别为 $\\Delta x$ 和 $\\Delta y$。\n\n二维拉普拉斯算子定义为：\n$$\n\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}\n$$\n我们将分别推导每个二阶导数项的有限差分近似，然后将它们相加。该推导依赖于函数 $u(x,y)$ 的泰勒级数展开，并假设该函数足够光滑。\n\n首先，我们来离散化在点 $(x_{i+\\frac{1}{2}}, y_{j})$ 处的 $\\frac{\\partial^{2} u}{\\partial x^{2}}$ 项。我们需要使用 $u$-网格上的相邻点。在 $x$ 方向上，$u_{i,j}$ 的邻点是 $u_{i+1,j}$ 和 $u_{i-1,j}$，它们分别位于距离 $+\\Delta x$ 和 $-\\Delta x$ 处。\n坐标为：\n- 中心点: $u_{i,j} = u(x_{i+\\frac{1}{2}}, y_{j})$\n- 东侧邻点: $u_{i+1,j} = u(x_{i+1+\\frac{1}{2}}, y_{j}) = u(x_{i+\\frac{1}{2}} + \\Delta x, y_{j})$\n- 西侧邻点: $u_{i-1,j} = u(x_{i-1+\\frac{1}{2}}, y_{j}) = u(x_{i+\\frac{1}{2}} - \\Delta x, y_{j})$\n\n函数 $u$ 在点 $(x_{i+\\frac{1}{2}}, y_{j})$ 周围，对 $x$ 方向上的邻点的泰勒级数展开为：\n$$\nu_{i+1,j} = u_{i,j} + \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i,j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\n$$\nu_{i-1,j} = u_{i,j} - \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i,j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} - \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\n为了获得二阶导数的表达式，我们将这两个方程相加。奇数阶导数项会相互抵消：\n$$\nu_{i+1,j} + u_{i-1,j} = 2u_{i,j} + (\\Delta x)^{2} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + O((\\Delta x)^{4})\n$$\n重新整理以求解关于 $x$ 的二阶偏导数，得到：\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} = \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + O((\\Delta x)^{2})\n$$\n这就是 $\\frac{\\partial^{2} u}{\\partial x^{2}}$ 的二阶精度中心有限差分近似。\n\n接下来，我们对 $\\frac{\\partial^{2} u}{\\partial y^{2}}$ 项采用类似的过程。在 $y$ 方向上，$u_{i,j}$ 的邻点是 $u_{i,j+1}$ 和 $u_{i,j-1}$，分别位于距离 $+\\Delta y$ 和 $-\\Delta y$ 处。\n- 北侧邻点: $u_{i,j+1} = u(x_{i+\\frac{1}{2}}, y_{j+1}) = u(x_{i+\\frac{1}{2}}, y_{j} + \\Delta y)$\n- 南侧邻点: $u_{i,j-1} = u(x_{i+\\frac{1}{2}}, y_{j-1}) = u(x_{i+\\frac{1}{2}}, y_{j} - \\Delta y)$\n\n对这些邻点在 $(x_{i+\\frac{1}{2}}, y_{j})$ 周围的泰勒级数展开为：\n$$\nu_{i,j+1} = u_{i,j} + \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i,j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} + \\frac{(\\Delta y)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial y^{3}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\n$$\nu_{i,j-1} = u_{i,j} - \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i,j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} - \\frac{(\\Delta y)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial y^{3}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\n将这两个方程相加，奇数阶导数项会相互抵消：\n$$\nu_{i,j+1} + u_{i,j-1} = 2u_{i,j} + (\\Delta y)^{2} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} + O((\\Delta y)^{4})\n$$\n求解关于 $y$ 的二阶偏导数，得到：\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j} = \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}} + O((\\Delta y)^{2})\n$$\n这就是 $\\frac{\\partial^{2} u}{\\partial y^{2}}$ 的二阶精度中心有限差分近似。\n\n最后，我们将两个偏导数的近似相结合，以获得拉普拉斯算子的离散化形式。截断误差是可加的。\n$$\n(\\nabla^{2} u)_{i,j} = \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i,j} + \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i,j}\n$$\n代入推导出的有限差分公式：\n$$\n(\\nabla^{2} u)_{i,j} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}}\n$$\n构建点 $(i,j)$ 处模板所需的相邻 $u$ 点是 $u_{i+1,j}$、$u_{i-1,j}$、$u_{i,j+1}$ 和 $u_{i,j-1}$。这构成了矩形网格上拉普拉斯算子的标准五点模板。此表达式即为所要求的二阶中心有限差分离散格式。",
            "answer": "$$\n\\boxed{\\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^{2}} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^{2}}}\n$$"
        },
        {
            "introduction": "虽然拉普拉斯摩擦能够提供数值稳定性，但它常常会阻尼我们希望保留的、物理上重要的大尺度流动特征。双调和摩擦 ($-\\nabla^4$) 提供了一种更精巧的解决方案，因为它具有高度的“尺度选择性”，即它主要针对小尺度的数值噪音，而对大尺度运动的影响相对较小。这个动手实践的光谱分析练习  让你能够亲手验证这一关键特性，通过比较不同波数的衰减率，来量化超粘性的优越选择性，并理解其在现代海洋模拟中的核心作用。",
            "id": "3798048",
            "problem": "考虑一个边长为 $L$ 的方形域中的双周期、正压准地转（QG）模型，该模型受线性摩擦作用，且非线性平流被抑制，以分离粘性算子的作用。设 $q(x,y,t)$ 表示一个在两个方向上都具有周期性边界条件的标量场（例如，位涡异常），并设 $q_{\\mathbf{k}}(t)$ 为其在波数向量 $\\mathbf{k} = (k_x,k_y)$ 处的傅里叶系数，其中 $k_x$ 和 $k_y$ 是由域上的离散傅里叶变换确定的整数。定义两个线性阻尼算子：\n- 拉普拉斯（粘性）摩擦：$D_2[q] = \\nu_2 \\nabla^2 q$。\n- 双调和（超粘性）摩擦：$D_4[q] = - \\nu_4 \\nabla^4 q$。\n\n在移除非线性平流并将外力设置为零后，演化方程简化为\n$$\n\\frac{\\partial q}{\\partial t} = D[q] ,\n$$\n其中 $D[q]$ 根据所选的摩擦类型，为 $D_2[q]$ 或 $D_4[q]$。在傅里叶空间中，利用拉普拉斯算子的傅里叶符号为 $-k^2$（其中 $k^2 = k_x^2+k_y^2$），模态振幅 $q_{\\mathbf{k}}(t)$ 通过以下方式独立演化\n$$\n\\frac{d q_{\\mathbf{k}}}{d t} = - \\lambda_p(\\mathbf{k}) q_{\\mathbf{k}} ,\n$$\n其中 $p \\in \\{1,2\\}$，对于拉普拉斯摩擦，$\\lambda_1(\\mathbf{k}) = \\nu_2 k^2$；对于双调和摩擦，$\\lambda_2(\\mathbf{k}) = \\nu_4 k^4$。这意味着精确的指数衰减\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left(- \\nu_2 k^2 t \\right) \\quad \\text{对于拉普拉斯摩擦，}\n$$\n和\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left(- \\nu_4 k^4 t \\right) \\quad \\text{对于双调和摩擦。}\n$$\n\n你的任务是设计并实现一个谱测试，通过测量双周期QG模型中模态振幅的衰减，来验证双调和（超粘性）摩擦相对于拉普拉斯摩擦的选择性阻尼特性。该测试必须：\n1. 在尺寸为 $L = 2\\pi$、每个方向有 $N$ 个网格点的方形域上使用离散傅里叶表示，使得离散波数满足 $k_x, k_y \\in \\{-N/2+1, \\ldots, -1, 0, 1, \\ldots, N/2\\}$，且基本波数尺度为 $1$。\n2. 初始化谱系数 $q_{\\mathbf{k}}(0)$，使得只有指定的模态为非零且等于 $1$（无量纲），以便在摩擦算子作用下分离它们的独立衰减。\n3. 使用时间步长为 $\\Delta t$ 的前向欧拉法，对纯摩擦作用下的谱系数 $q_{\\mathbf{k}}(t)$ 进行时间步进：\n$$\nq_{\\mathbf{k}}^{n+1} = q_{\\mathbf{k}}^{n} \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right) ,\n$$\n对于 $n = 0, 1, \\ldots, N_t-1$，其中 $N_t$ 是时间步数，$t = N_t \\Delta t$。此离散化必须在谱空间中应用，并且不得包含非线性平流或外力。\n4. 测量所选模态的数值演化振幅 $q_{\\mathbf{k}}(t)$，并将其与精确的解析振幅进行比较，以量化误差。\n5. 构建一个选择性度量 $R$，用于比较超粘性与拉普拉斯摩擦对高波数模态相对于低波数模态的相对阻尼。定义\n$$\nR = \\frac{\\left( \\frac{A_{\\text{high}}^{(4)}}{A_{\\text{low}}^{(4)}} \\right)}{\\left( \\frac{A_{\\text{high}}^{(2)}}{A_{\\text{low}}^{(2)}} \\right)} ,\n$$\n其中 $A_{\\text{high}}^{(4)}$ 和 $A_{\\text{low}}^{(4)}$ 分别是双调和摩擦下，在时间 $t$ 时高波数模态和低波数模态的解析振幅，$A_{\\text{high}}^{(2)}$ 和 $A_{\\text{low}}^{(2)}$ 是拉普拉斯摩擦下对应的解析振幅。$R \\ll 1$ 表明超粘性具有选择性阻尼，意味着相对于低波数，超粘性对高波数的阻尼作用强于拉普拉斯摩擦。\n\n所有量均为无量纲；无需物理单位。未出现角度；无需角度单位。\n\n实现一个程序，执行以下测试套件并输出结果：\n\n- 公共谱参数：\n  - 域尺寸 $L = 2\\pi$（无量纲）。\n  - 网格尺寸 $N = 64$。\n  - 总积分时间 $T = 10$。\n  - 时间步长 $\\Delta t = 0.005$。\n  - 双调和摩擦系数 $\\nu_4 = 5.0 \\times 10^{-6}$。\n  - 拉普拉斯摩擦系数 $\\nu_2 = 1.0 \\times 10^{-3}$。\n  - 低波数模态 $\\mathbf{k}_{\\text{low}} = (1,0)$。\n  - 高波数模态 $\\mathbf{k}_{\\text{high}} = (16,16)$。\n  - 零波数模态 $\\mathbf{k}_{\\text{zero}} = (0,0)$。\n\n- 测试用例及所需输出：\n  1. 在双调和摩擦下，仅将 $t=0$ 时的 $\\mathbf{k}_{\\text{low}}$ 初始化为 $1$，演化至 $t=T$，并计算数值振幅与解析振幅之间的相对误差。将此误差作为浮点数输出。\n  2. 在双调和摩擦下，仅将 $t=0$ 时的 $\\mathbf{k}_{\\text{high}}$ 初始化为 $1$，演化至 $t=T$，并计算数值振幅与解析振幅之间的相对误差。将此误差作为浮点数输出。\n  3. 使用 $t=T$ 时的解析振幅计算上面定义的选择性度量 $R$。将 $R$ 作为浮点数输出。\n  4. 在双调和摩擦下，仅将 $t=0$ 时的 $\\mathbf{k}_{\\text{zero}}$ 初始化为 $1$，演化至 $t=T$，并计算振幅的绝对变化 $|q_{\\mathbf{k}_{\\text{zero}}}(T) - q_{\\mathbf{k}_{\\text{zero}}}(0)|$。将此变化作为浮点数输出。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,result4]”）。每个结果必须是标准十进制表示的浮点数。程序必须是独立自足的，无需用户输入或外部文件。",
            "solution": "用户提供了一个来自计算海洋学领域的有效、良构的问题陈述。任务是实现一个谱测试，以验证双调和摩擦相对于拉普拉斯摩擦的选择性阻尼特性，并量化数值时间步进格式相对于精确解析解的准确性。\n\n物理模型是一个简化的正压准地转（QG）模型，其中只有线性摩擦是活跃的。标量场的傅里叶系数 $q_{\\mathbf{k}}(t)$（在波数向量 $\\mathbf{k}=(k_x, k_y)$ 处）的演化由以下常微分方程给出：\n$$\n\\frac{d q_{\\mathbf{k}}}{d t} = - \\lambda_p(\\mathbf{k}) q_{\\mathbf{k}}\n$$\n其中阻尼率 $\\lambda_p(\\mathbf{k})$ 取决于摩擦类型。对于拉普拉斯摩擦（$p=1$），阻尼率为 $\\lambda_1(\\mathbf{k}) = \\nu_2 k^2$；对于双调和摩擦（$p=2$），阻尼率为 $\\lambda_2(\\mathbf{k}) = \\nu_4 k^4$。这里，$k^2 = k_x^2 + k_y^2$ 是波数大小的平方，$\\nu_2$ 和 $\\nu_4$ 分别是各自的摩擦系数。\n\n给定初始振幅 $q_{\\mathbf{k}}(0)$，该方程的解析解是一个指数衰减：\n$$\nq_{\\mathbf{k}}(t) = q_{\\mathbf{k}}(0) \\exp\\left( - \\lambda_p(\\mathbf{k}) t \\right)\n$$\n问题要求使用时间步长为 $\\Delta t$ 的前向欧拉数值格式来模拟此衰减。单个时间步的更新规则是：\n$$\nq_{\\mathbf{k}}^{n+1} = q_{\\mathbf{k}}^{n} \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right)\n$$\n经过 $N_t$ 步后，其中总积分时间为 $T = N_t \\Delta t$，数值解为：\n$$\nq_{\\mathbf{k}}(T) = q_{\\mathbf{k}}(0) \\left( 1 - \\Delta t \\, \\lambda_p(\\mathbf{k}) \\right)^{N_t}\n$$\n为测试提供了以下值：\n- 域尺寸 $L = 2\\pi$。\n- 网格尺寸 $N = 64$。\n- 总积分时间 $T = 10$。\n- 时间步长 $\\Delta t = 0.005$，这意味着步数为 $N_t = T / \\Delta t = 10 / 0.005 = 2000$ 步。\n- 双调和摩擦系数 $\\nu_4 = 5.0 \\times 10^{-6}$。\n- 拉普拉斯摩擦系数 $\\nu_2 = 1.0 \\times 10^{-3}$。\n- 所有测试模态的初始振幅为 $q_{\\mathbf{k}}(0) = 1$。\n所考虑的特定模态是低波数模态 $\\mathbf{k}_{\\text{low}} = (1,0)$、高波数模态 $\\mathbf{k}_{\\text{high}} = (16,16)$ 和零波数模态 $\\mathbf{k}_{\\text{zero}} = (0,0)$。\n\n解决方案通过评估四个测试用例中的每一个来继续进行。\n\n**测试用例1：双调和摩擦下 $\\mathbf{k}_{\\text{low}}$ 的相对误差**\n\n对于 $\\mathbf{k}_{\\text{low}} = (1,0)$，波数大小的平方为 $k_{\\text{low}}^2 = 1^2 + 0^2 = 1$，其四次方为 $k_{\\text{low}}^4 = (1)^2 = 1$。\n双调和阻尼率为 $\\lambda_2(\\mathbf{k}_{\\text{low}}) = \\nu_4 k_{\\text{low}}^4 = (5.0 \\times 10^{-6}) \\times 1 = 5.0 \\times 10^{-6}$。\n在 $t=T$ 时的精确解析振幅为：\n$$\nA_{\\text{low, analyt}}^{(4)} = q_{\\mathbf{k}_{\\text{low}}}(0) \\exp(-\\lambda_2(\\mathbf{k}_{\\text{low}}) T) = 1 \\cdot \\exp(-5.0 \\times 10^{-6} \\times 10) = \\exp(-5.0 \\times 10^{-5})\n$$\n在 $t=T$ 时的数值振幅为：\n$$\nA_{\\text{low, num}}^{(4)} = q_{\\mathbf{k}_{\\text{low}}}(0) (1 - \\Delta t \\lambda_2(\\mathbf{k}_{\\text{low}}))^{N_t} = 1 \\cdot (1 - 0.005 \\times 5.0 \\times 10^{-6})^{2000} = (1 - 2.5 \\times 10^{-8})^{2000}\n$$\n相对误差为 $\\text{err}_1 = |A_{\\text{low, num}}^{(4)} - A_{\\text{low, analyt}}^{(4)}| / |A_{\\text{low, analyt}}^{(4)}|$。\n\n**测试用例2：双调和摩擦下 $\\mathbf{k}_{\\text{high}}$ 的相对误差**\n\n对于 $\\mathbf{k}_{\\text{high}} = (16,16)$，波数大小的平方为 $k_{\\text{high}}^2 = 16^2 + 16^2 = 256 + 256 = 512$。其四次方为 $k_{\\text{high}}^4 = 512^2 = 262144$。\n双调和阻尼率为 $\\lambda_2(\\mathbf{k}_{\\text{high}}) = \\nu_4 k_{\\text{high}}^4 = (5.0 \\times 10^{-6}) \\times 262144 = 1.31072$。\n在 $t=T$ 时的精确解析振幅为：\n$$\nA_{\\text{high, analyt}}^{(4)} = q_{\\mathbf{k}_{\\text{high}}}(0) \\exp(-\\lambda_2(\\mathbf{k}_{\\text{high}}) T) = \\exp(-1.31072 \\times 10) = \\exp(-13.1072)\n$$\n在 $t=T$ 时的数值振幅为：\n$$\nA_{\\text{high, num}}^{(4)} = q_{\\mathbf{k}_{\\text{high}}}(0) (1 - \\Delta t \\lambda_2(\\mathbf{k}_{\\text{high}}))^{N_t} = (1 - 0.005 \\times 1.31072)^{2000} = (1 - 0.0065536)^{2000}\n$$\n相对误差为 $\\text{err}_2 = |A_{\\text{high, num}}^{(4)} - A_{\\text{high, analyt}}^{(4)}| / |A_{\\text{high, analyt}}^{(4)}|$。\n\n**测试用例3：选择性度量 $R$**\n\n选择性度量 $R$ 是基于解析振幅定义的：\n$$\nR = \\frac{\\left( A_{\\text{high}}^{(4)} / A_{\\text{low}}^{(4)} \\right)}{\\left( A_{\\text{high}}^{(2)} / A_{\\text{low}}^{(2)} \\right)}\n$$\n我们已经找到了 $A_{\\text{low}}^{(4)} = \\exp(-5.0 \\times 10^{-5})$ 和 $A_{\\text{high}}^{(4)} = \\exp(-13.1072)$。现在我们计算拉普拉斯摩擦下的振幅。\n$\\mathbf{k}_{\\text{low}}$ 的拉普拉斯阻尼率为 $\\lambda_1(\\mathbf{k}_{\\text{low}}) = \\nu_2 k_{\\text{low}}^2 = (1.0 \\times 10^{-3}) \\times 1 = 1.0 \\times 10^{-3}$。\n对应的振幅为 $A_{\\text{low}}^{(2)} = \\exp(-\\lambda_1(\\mathbf{k}_{\\text{low}}) T) = \\exp(-1.0 \\times 10^{-3} \\times 10) = \\exp(-0.01)$。\n$\\mathbf{k}_{\\text{high}}$ 的拉普拉斯阻尼率为 $\\lambda_1(\\mathbf{k}_{\\text{high}}) = \\nu_2 k_{\\text{high}}^2 = (1.0 \\times 10^{-3}) \\times 512 = 0.512$。\n对应的振幅为 $A_{\\text{high}}^{(2)} = \\exp(-\\lambda_1(\\mathbf{k}_{\\text{high}}) T) = \\exp(-0.512 \\times 10) = \\exp(-5.12)$。\n将这些代入 $R$ 的公式中：\n$$\nR = \\frac{\\exp(-13.1072) / \\exp(-5.0 \\times 10^{-5})}{\\exp(-5.12) / \\exp(-0.01)} = \\frac{\\exp(-13.1072 + 0.00005)}{\\exp(-5.12 + 0.01)} = \\frac{\\exp(-13.10715)}{\\exp(-5.11)}\n$$\n$$\nR = \\exp(-13.10715 - (-5.11)) = \\exp(-7.99715)\n$$\n$R \\ll 1$ 的值表明，相对于低波数，双调和摩擦对高波数的阻尼作用强于拉普拉斯摩擦。计算出的值预计会非常小，这证实了超粘性的高选择性。\n\n**测试用例4：双调和摩擦下 $\\mathbf{k}_{\\text{zero}}$ 的绝对变化**\n\n对于零波数模态 $\\mathbf{k}_{\\text{zero}}=(0,0)$，波数大小为 $k_{\\text{zero}} = 0$。因此，$k_{\\text{zero}}^2 = 0$ 且 $k_{\\text{zero}}^4 = 0$。\n双调和阻尼率为 $\\lambda_2(\\mathbf{k}_{\\text{zero}}) = \\nu_4 k_{\\text{zero}}^4 = 0$。\n该模态的演化是平凡的。解析解为 $q_{\\mathbf{k}_{\\text{zero}}}(t) = q_{\\mathbf{k}_{\\text{zero}}}(0) \\exp(0) = q_{\\mathbf{k}_{\\text{zero}}}(0) = 1$。\n数值解为 $q_{\\mathbf{k}_{\\text{zero}}}(T) = q_{\\mathbf{k}_{\\text{zero}}}(0) (1 - \\Delta t \\cdot 0)^{N_t} = 1 \\cdot (1)^{2000} = 1$。\n振幅的绝对变化为 $|q_{\\mathbf{k}_{\\text{zero}}}(T) - q_{\\mathbf{k}_{\\text{zero}}}(0)| = |1 - 1| = 0$。这表明场的平均分量在两种摩擦算子下都是守恒的，这是一个被数值格式正确捕捉到的关键物理特性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a spectral test to verify selective damping of biharmonic friction\n    and compare numerical results to analytical solutions.\n    \"\"\"\n\n    # Common parameters as specified in the problem statement\n    T = 10.0\n    dt = 0.005\n    nu4 = 5.0e-6\n    nu2 = 1.0e-3\n    k_low_vec = (1, 0)\n    k_high_vec = (16, 16)\n    k_zero_vec = (0, 0)\n\n    # Initial amplitude for all test modes is 1\n    q0 = 1.0\n\n    # Calculate number of time steps\n    Nt = int(T / dt)\n\n    results = []\n\n    # --- Test Case 1: Relative error for the low-wavenumber mode ---\n    k_low_sq = float(k_low_vec[0]**2 + k_low_vec[1]**2)\n    k_low_4 = k_low_sq**2\n    lambda_2_low = nu4 * k_low_4\n\n    # Analytical solution\n    q_analyt_low = q0 * np.exp(-lambda_2_low * T)\n\n    # Numerical solution using Forward Euler\n    q_num_low = q0 * (1.0 - dt * lambda_2_low)**Nt\n    \n    # Relative error\n    err1 = np.abs(q_num_low - q_analyt_low) / np.abs(q_analyt_low)\n    results.append(err1)\n\n    # --- Test Case 2: Relative error for the high-wavenumber mode ---\n    k_high_sq = float(k_high_vec[0]**2 + k_high_vec[1]**2)\n    k_high_4 = k_high_sq**2\n    lambda_2_high = nu4 * k_high_4\n\n    # Analytical solution\n    q_analyt_high = q0 * np.exp(-lambda_2_high * T)\n\n    # Numerical solution using Forward Euler\n    q_num_high = q0 * (1.0 - dt * lambda_2_high)**Nt\n    \n    # Relative error\n    err2 = np.abs(q_num_high - q_analyt_high) / np.abs(q_analyt_high)\n    results.append(err2)\n\n    # --- Test Case 3: Selectivity Metric R ---\n    # Amplitudes under biharmonic friction (already calculated)\n    A_low_4 = q_analyt_low\n    A_high_4 = q_analyt_high\n\n    # Amplitudes under Laplacian friction (analytical)\n    lambda_1_low = nu2 * k_low_sq\n    A_low_2 = q0 * np.exp(-lambda_1_low * T)\n    \n    lambda_1_high = nu2 * k_high_sq\n    A_high_2 = q0 * np.exp(-lambda_1_high * T)\n    \n    # Selectivity metric R\n    R = (A_high_4 / A_low_4) / (A_high_2 / A_low_2)\n    results.append(R)\n\n    # --- Test Case 4: Absolute change for the zero-wavenumber mode ---\n    k_zero_sq = float(k_zero_vec[0]**2 + k_zero_vec[1]**2)\n    k_zero_4 = k_zero_sq**2\n    lambda_2_zero = nu4 * k_zero_4\n    \n    # Numerical solution\n    q_num_zero = q0 * (1.0 - dt * lambda_2_zero)**Nt\n    \n    # Absolute change\n    abs_change_zero = np.abs(q_num_zero - q0)\n    results.append(abs_change_zero)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "双调和摩擦增强的尺度选择性是以巨大的计算成本为代价的，这是数值模拟中固有的权衡取舍的一个典型例子。高阶算子对显式时间积分格式的稳定性施加了更严格的约束。在这个练习  中，你将使用冯·诺伊曼稳定性分析来推导双调和算子的时间步长限制，并亲自发现它对网格间距的严格依赖性，即 $\\Delta t \\propto (\\Delta x)^4$。这一基础分析揭示了为获得超粘性的物理优势所需付出的实际计算代价。",
            "id": "3798050",
            "problem": "考虑一个仅含双调和摩擦的正压海洋模型中的线性动量方程，其单个速度分量的表达式为 $\\partial_{t} u = -A_{4} \\nabla^{4} u$，其中 $A_{4} > 0$ 是双调和粘性系数。假设一个双周期正方形域和间距为 $\\Delta x = \\Delta y$ 的均匀笛卡尔网格。设时间步进为应用于网格函数 $u_{i,j}^{n}$ 的显式前向欧拉法，且水平双调和算子离散化为九点离散拉普拉斯算子与其自身的复合。九点拉普拉斯算子 $L_{h}$ 定义为\n$$\n(L_{h} u)_{i,j} = \\frac{1}{6 \\Delta x^{2}}\\Big(-20\\,u_{i,j} + 4\\big(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}\\big) + \\big(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\big)\\Big),\n$$\n且离散双调和算子为 $\\nabla^{4}_{h} u = L_{h}(L_{h} u)$。从周期性网格上傅里叶模态分析的线性稳定性第一性原理出发，确定稳定性的显式时间步长上限，并证明其与网格间距和双调和粘性的关系为 $\\Delta t_{\\max} \\propto \\Delta x^{4}/A_{4}$。计算上述格式的比例常数 $C$，使得该界限可以写为 $\\Delta t_{\\max} = C\\,\\Delta x^{4}/A_{4}$。将 $C$ 表示为一个精确、无量纲的最简形式数值。无需四舍五入，最终值 $C$ 不报告任何单位。",
            "solution": "该问题陈述具有科学依据，提法恰当，并包含了严谨求解所需的所有必要信息。因此，我们可以进行验证和计算。\n\n带双调和摩擦的速度分量 $u$ 的控制偏微分方程为\n$$\n\\frac{\\partial u}{\\partial t} = -A_{4} \\nabla^{4} u\n$$\n其中 $A_{4} > 0$ 是双调和粘性系数。问题指定了在间距为 $\\Delta x = \\Delta y$ 的均匀笛卡尔网格上的空间离散化，以及使用显式前向欧拉法的时间离散化。完全离散化的方程为：\n$$\n\\frac{u_{i,j}^{n+1} - u_{i,j}^{n}}{\\Delta t} = -A_{4} \\nabla_{h}^{4} u_{i,j}^{n}\n$$\n其中 $u_{i,j}^{n}$ 是在网格点 $(i,j)$ 和时间步 $n$ 处速度分量的值。离散双调和算子由 $\\nabla_{h}^{4} = L_{h}(L_{h})$ 给出，其中 $L_{h}$ 是九点离散拉普拉斯算子。因此，时间步进格式为：\n$$\nu_{i,j}^{n+1} = u_{i,j}^{n} - \\Delta t A_{4} (L_{h}(L_{h}u^{n}))_{i,j}\n$$\n为分析此格式的稳定性，我们进行冯·诺依曼稳定性分析。我们考虑周期性网格上的单个傅里叶模态：\n$$\nu_{i,j}^{n} = \\hat{u}^{n}(k_x, k_y) \\exp\\big(I(k_x i \\Delta x + k_y j \\Delta y)\\big)\n$$\n其中 $I = \\sqrt{-1}$ 是虚数单位，$k_x$ 和 $k_y$ 分别是 $x$ 和 $y$ 方向的波数。将此代入时间步进方程，我们可求得模态振幅 $\\hat{u}^{n}$ 如何演化。线性有限差分算子对傅里叶模态的作用，是将其乘以一个称为算子符号的复数。设 $\\hat{L}_h(k_x, k_y)$ 为离散拉普拉斯算子 $L_h$ 的符号。双调和算子 $\\nabla_{h}^{4}$ 的符号则为 $(\\hat{L}_h)^2$。振幅方程变为：\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} - \\Delta t A_{4} (\\hat{L}_h)^2 \\hat{u}^{n}\n$$\n放大因子 $G(k_x, k_y)$ 是连续振幅之比，$G = \\hat{u}^{n+1} / \\hat{u}^{n}$：\n$$\nG(k_x, k_y) = 1 - \\Delta t A_{4} (\\hat{L}_h(k_x, k_y))^2\n$$\n为使格式稳定，对于任何可能的波数，放大因子的模都不能超过1，即 $|G| \\leq 1$。\n\n首先，我们必须求出九点拉普拉斯算子的符号 $\\hat{L}_h$。将 $L_h$ 应用于傅里叶模态 $u_{i,j} = \\exp(I(k_x i \\Delta x + k_y j \\Delta y))$：\n$$\n(L_{h} u)_{i,j} = \\frac{u_{i,j}}{6 \\Delta x^{2}}\\Big(-20 + 4(\\mathrm{e}^{I k_x \\Delta x} + \\mathrm{e}^{-I k_x \\Delta x} + \\mathrm{e}^{I k_y \\Delta y} + \\mathrm{e}^{-I k_y \\Delta y}) + (\\mathrm{e}^{I(k_x \\Delta x+k_y \\Delta y)} + \\mathrm{e}^{I(k_x \\Delta x-k_y \\Delta y)} + \\mathrm{e}^{I(-k_x \\Delta x+k_y \\Delta y)} + \\mathrm{e}^{I(-k_x \\Delta x-k_y \\Delta y)})\\Big)\n$$\n使用恒等式 $2\\cos\\theta = \\mathrm{e}^{I\\theta} + \\mathrm{e}^{-I\\theta}$，我们简化该表达式。对角项之和为 $(\\mathrm{e}^{I k_x \\Delta x} + \\mathrm{e}^{-I k_x \\Delta x})(\\mathrm{e}^{I k_y \\Delta y} + \\mathrm{e}^{-I k_y \\Delta y}) = 4\\cos(k_x \\Delta x)\\cos(k_y \\Delta y)$。因此，符号 $\\hat{L}_h$ 为：\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^{2}} \\Big[ -20 + 8\\cos(k_x \\Delta x) + 8\\cos(k_y \\Delta y) + 4\\cos(k_x \\Delta x)\\cos(k_y \\Delta y) \\Big]\n$$\n使用恒等式 $\\cos\\theta = 1 - 2\\sin^2(\\theta/2)$，令 $\\alpha = k_x \\Delta x$ 且 $\\beta = k_y \\Delta y$。\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -20 + 8(1-2\\sin^2(\\alpha/2)) + 8(1-2\\sin^2(\\beta/2)) + 4(1-2\\sin^2(\\alpha/2))(1-2\\sin^2(\\beta/2)) \\Big]\n$$\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -20 + 8 - 16s_x^2 + 8 - 16s_y^2 + 4(1 - 2s_x^2 - 2s_y^2 + 4s_x^2 s_y^2) \\Big]\n$$\n其中 $s_x = \\sin(\\alpha/2)$ 且 $s_y = \\sin(\\beta/2)$。\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -4 - 16s_x^2 - 16s_y^2 + 4 - 8s_x^2 - 8s_y^2 + 16s_x^2 s_y^2 \\Big]\n$$\n$$\n\\hat{L}_h = \\frac{1}{6 \\Delta x^2} \\Big[ -24s_x^2 - 24s_y^2 + 16s_x^2 s_y^2 \\Big] = -\\frac{4}{\\Delta x^2} \\Big[ \\sin^2\\Big(\\frac{k_x \\Delta x}{2}\\Big) + \\sin^2\\Big(\\frac{k_y \\Delta y}{2}\\Big) - \\frac{2}{3}\\sin^2\\Big(\\frac{k_x \\Delta x}{2}\\Big)\\sin^2\\Big(\\frac{k_y \\Delta y}{2}\\Big) \\Big]\n$$\n由于 $\\hat{L}_h$ 是实数，所以 $(\\hat{L}_h)^2 \\ge 0$。放大因子 $G = 1 - \\Delta t A_4 (\\hat{L}_h)^2$ 也是实数。稳定性条件 $|G| \\le 1$ 变为 $-1 \\le 1 - \\Delta t A_4 (\\hat{L}_h)^2 \\le 1$。\n右侧不等式意味着 $-\\Delta t A_4 (\\hat{L}_h)^2 \\le 0$，因为 $\\Delta t > 0$ 且 $A_4 > 0$，所以此式恒成立。\n左侧不等式给出了约束条件：\n$$\n-1 \\le 1 - \\Delta t A_4 (\\hat{L}_h)^2 \\implies \\Delta t A_4 (\\hat{L}_h)^2 \\le 2\n$$\n这必须对所有波数都成立。最严格的条件出现在 $(\\hat{L}_h)^2$ 为最大值时。因此，最大允许时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{A_4 \\max_{k_x, k_y} \\big[(\\hat{L}_h)^2\\big]}\n$$\n我们需要找到 $|\\hat{L}_h|$ 的最大值。令 $S_x = \\sin^2(k_x \\Delta x/2)$ 且 $S_y = \\sin^2(k_y \\Delta y/2)$。在周期性网格上，无量纲波数 $k_x \\Delta x$ 和 $k_y \\Delta y$ 的范围是从 $-\\pi$ 到 $\\pi$。因此 $S_x$ 和 $S_y$ 的范围是从 $0$ 到 $1$。我们需要在单位正方形 $[0,1] \\times [0,1]$ 上求函数 $f(S_x, S_y) = S_x + S_y - \\frac{2}{3}S_x S_y$ 的最大值。\n偏导数为 $\\partial f/\\partial S_x = 1 - \\frac{2}{3}S_y$ 和 $\\partial f/\\partial S_y = 1 - \\frac{2}{3}S_x$。域内没有临界点，因此最大值必须位于边界上。在边界上的求值表明，最大值出现在角点 $(S_x, S_y) = (1,1)$，这对应于最高频率（奈奎斯特）模态，其中 $k_x \\Delta x = \\pm \\pi$ 且 $k_y \\Delta y = \\pm \\pi$。\n$$\n\\max f(S_x, S_y) = f(1,1) = 1 + 1 - \\frac{2}{3}(1)(1) = \\frac{4}{3}\n$$\n现在我们可以计算 $|\\hat{L}_h|$ 的最大值：\n$$\n\\max |\\hat{L}_h| = \\frac{4}{\\Delta x^2} \\left| \\max f(S_x, S_y) \\right| = \\frac{4}{\\Delta x^2} \\cdot \\frac{4}{3} = \\frac{16}{3\\Delta x^2}\n$$\n$(\\hat{L}_h)^2$ 的最大值就是这个值的平方：\n$$\n\\max \\big[(\\hat{L}_h)^2\\big] = \\left(\\frac{16}{3\\Delta x^2}\\right)^2 = \\frac{256}{9\\Delta x^4}\n$$\n将此代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\Delta t_{\\max} = \\frac{2}{A_4 \\left(\\frac{256}{9\\Delta x^4}\\right)} = \\frac{18 \\Delta x^4}{256 A_4} = \\frac{9 \\Delta x^4}{128 A_4}\n$$\n问题要求关系式 $\\Delta t_{\\max} = C \\frac{\\Delta x^4}{A_4}$ 中的比例常数 $C$。通过比较，我们得出：\n$$\nC = \\frac{9}{128}\n$$",
            "answer": "$$\n\\boxed{\\frac{9}{128}}\n$$"
        }
    ]
}