{
    "hands_on_practices": [
        {
            "introduction": "The behavior of plasma waves is fundamentally governed by the collective motion and interaction of charged particles, a domain described by kinetic theory. This practice will guide you through a foundational derivation, showing how the familiar fluid-like dispersion relation for ion acoustic waves emerges from the more comprehensive Vlasov-Poisson kinetic framework. By applying appropriate approximations for hot electrons and cold ions , you will bridge the gap between microscopic particle dynamics and the macroscopic wave properties we observe.",
            "id": "271848",
            "problem": "In the kinetic theory of plasma waves, the general dispersion relation for electrostatic waves in an unmagnetized, collisionless plasma is given by $\\epsilon(\\omega, k) = 1 + \\sum_s \\chi_s(\\omega,k) = 0$, where the sum is over all plasma species (electrons and ions). For a plasma with Maxwellian velocity distributions, the susceptibility for species $s$ (where $s=e$ for electrons and $s=i$ for ions) can be written as:\n$$\n\\chi_s(\\omega, k) = \\frac{2\\omega_{ps}^2}{k^2 v_{ts}^2} \\left[ 1 + \\zeta_s Z(\\zeta_s) \\right]\n$$\nHere, $\\omega$ is the wave frequency and $k$ is the wavenumber. The other quantities are defined as:\n- $\\omega_{ps} = \\sqrt{\\frac{n_s q_s^2}{\\epsilon_0 m_s}}$: plasma frequency of species $s$.\n- $v_{ts} = \\sqrt{\\frac{2 k_B T_s}{m_s}}$: thermal speed of species $s$.\n- $\\zeta_s = \\frac{\\omega}{k v_{ts}}$: ratio of phase velocity to thermal speed.\n- $Z(\\zeta)$ is the plasma dispersion function.\n\nIon acoustic waves are low-frequency oscillations that exist under the condition of hot electrons and cold ions, $T_e \\gg T_i$. This corresponds to a phase velocity $\\omega/k$ that is much smaller than the electron thermal speed but much larger than the ion thermal speed, i.e., $v_{ti} \\ll \\omega/k \\ll v_{te}$. Consequently, the arguments of the plasma dispersion function for each species are in opposite limits: $|\\zeta_e| \\ll 1$ and $|\\zeta_i| \\gg 1$.\n\nThe asymptotic expansions of the real part of the plasma dispersion function for these limits are:\n- For small argument, $|\\zeta| \\ll 1$: $Z(\\zeta) \\approx -2\\zeta$.\n- For large argument, $|\\zeta| \\gg 1$: $Z(\\zeta) \\approx -\\frac{1}{\\zeta} - \\frac{1}{2\\zeta^3}$.\n\nConsider a plasma composed of electrons and singly charged positive ions ($q_i = e, q_e = -e$) with quasi-neutrality ($n_e \\approx n_i = n$). By applying the appropriate asymptotic limits for both species, derive the dispersion relation $\\omega(k)$ for ion acoustic waves.\n\nExpress your final answer for $\\omega(k)$ in terms of the wavenumber $k$, the ion acoustic speed $C_s = \\sqrt{\\frac{k_B T_e}{m_i}}$, and the electron Debye length $\\lambda_{De} = \\sqrt{\\frac{\\epsilon_0 k_B T_e}{n e^2}}$.",
            "solution": "Starting from the longitudinal dielectric function  \n$$\n\\epsilon(\\omega,k)=1+\\chi_e+\\chi_i=0\n$$\nwith  \n$$\n\\chi_s(\\omega,k)=\\frac{2\\omega_{ps}^2}{k^2v_{ts}^2}\\bigl[1+\\zeta_sZ(\\zeta_s)\\bigr],\\quad \n\\zeta_s=\\frac{\\omega}{kv_{ts}}.\n$$\n\n1. Electron susceptibility ($|\\zeta_e|\\ll1$):  \n   Use $Z(\\zeta_e)\\approx-2\\zeta_e$ so  \n   $1+\\zeta_eZ(\\zeta_e)=1-2\\zeta_e^2$.  Hence  \n   $$\n   \\chi_e=\\frac{2\\omega_{pe}^2}{k^2v_{te}^2}(1-2\\zeta_e^2)\n   \\approx\\frac{2\\omega_{pe}^2}{k^2v_{te}^2}\n   =\\frac{1}{k^2\\lambda_{De}^2},\n   $$\n   where $\\lambda_{De}^2=\\epsilon_0k_BT_e/(ne^2)$ and we dropped the ${\\cal O}(\\zeta_e^2)$ term.\n\n2. Ion susceptibility ($|\\zeta_i|\\gg1$):  \n   Use $Z(\\zeta_i)\\approx -\\frac1{\\zeta_i}-\\frac1{2\\zeta_i^3}$ so  \n   $1+\\zeta_iZ(\\zeta_i)=-\\frac1{2\\zeta_i^2}$ and  \n   $$\n   \\chi_i\n   =\\frac{2\\omega_{pi}^2}{k^2v_{ti}^2}\\Bigl(-\\frac1{2\\zeta_i^2}\\Bigr)\n   =-\\frac{\\omega_{pi}^2}{\\omega^2}.\n   $$\n\n3. Dispersion relation:  \n   $$\n   0=1+\\frac{1}{k^2\\lambda_{De}^2}-\\frac{\\omega_{pi}^2}{\\omega^2}\n   \\;\\Longrightarrow\\;\n   \\omega^2=\\frac{\\omega_{pi}^2}{1+1/(k^2\\lambda_{De}^2)}\n   =\\frac{k^2\\,k_BT_e/m_i}{1+k^2\\lambda_{De}^2}.\n   $$\n\n4. Defining the ion acoustic speed $C_s=\\sqrt{k_BT_e/m_i}$ gives  \n$$\n\\omega(k)=\\frac{k\\,C_s}{\\sqrt{1+k^2\\lambda_{De}^2}}.\n$$",
            "answer": "$$\\boxed{\\omega(k)=\\frac{k\\,C_s}{\\sqrt{1+k^2\\lambda_{De}^2}}}$$"
        },
        {
            "introduction": "A dispersion relation $\\omega(k)$ is the cornerstone for understanding wave phenomena, but its true power lies in the physical properties we can derive from it. This exercise focuses on calculating the group velocity, $v_g = d\\omega/dk$, which dictates the speed at which wave energy and information propagate through the plasma. Using a fluid dispersion relation that includes the effects of finite ion temperature , you will explore how thermal pressure modifies the propagation of ion acoustic waves, a crucial aspect of dispersive media.",
            "id": "271825",
            "problem": "In a one-dimensional, unmagnetized, collisionless plasma consisting of electrons and a single species of ions, the propagation of ion acoustic waves can be studied using a fluid model. We assume the electrons are massless, inertialess, and follow an isothermal equation of state ($p_e = n_e k_B T_e$), while the ions are warm and follow an adiabatic equation of state ($p_i \\propto n_i^{\\gamma_i}$).\n\nFor electrostatic waves of the form $e^{i(kx - \\omega t)}$, the resulting linear dispersion relation, which accounts for both ion thermal effects and charge separation, is given by:\n$$\n\\omega^2 = \\frac{k^2 c_s^2}{1 + k^2 \\lambda_{De}^2} + \\gamma_i k^2 v_{Ti}^2\n$$\nHere, $\\omega$ is the angular frequency, $k$ is the wavenumber, $c_s = \\sqrt{k_B T_e/m_i}$ is the ion acoustic speed (with $k_B$ the Boltzmann constant, $T_e$ the electron temperature, and $m_i$ the ion mass), $\\lambda_{De}$ is the electron Debye length, $\\gamma_i$ is the adiabatic index for the ions, and $v_{Ti} = \\sqrt{k_B T_i/m_i}$ is the ion thermal speed (with $T_i$ the ion temperature).\n\nDefine the ion-to-electron temperature ratio as $\\sigma = T_i/T_e$. Derive an explicit expression for the group velocity, $v_g = \\frac{d\\omega}{dk}$, of these waves. Your final answer should be expressed in terms of $k$, $c_s$, $\\lambda_{De}$, $\\gamma_i$, and $\\sigma$.",
            "solution": "1. Start from the dispersion relation  \n$$\\omega^2=\\frac{k^2c_s^2}{1+k^2\\lambda_{De}^2}+\\gamma_i\\,k^2v_{Ti}^2\\,. $$  \nDefine $\\sigma=T_i/T_e$, so $v_{Ti}^2=\\sigma c_s^2$. Then  \n$$\\omega^2=k^2c_s^2\\Bigl[\\frac{1}{1+k^2\\lambda_{De}^2}+\\gamma_i\\sigma\\Bigr]\\equiv k^2c_s^2A(k)\\,. $$  \n\n2. Thus  \n$$\\omega=c_s\\,k\\sqrt{A(k)},\\quad A(k)=\\frac{1}{1+k^2\\lambda_{De}^2}+\\gamma_i\\sigma\\,. $$  \n\n3. The group velocity is  \n$$v_g=\\frac{d\\omega}{dk}\n=\\frac{d}{dk}\\bigl[c_s\\,k\\sqrt{A(k)}\\bigr]\n=c_s\\Bigl[\\sqrt{A}+\\frac{k}{2\\sqrt{A}}\\frac{dA}{dk}\\Bigr]\\,. $$  \n\n4. Compute  \n$$\\frac{dA}{dk}\n=-\\frac{2k\\lambda_{De}^2}{(1+k^2\\lambda_{De}^2)^2}\\,. $$  \nHence  \n$$v_g\n=c_s\\Bigl[\\sqrt{A}-\\frac{k^2\\lambda_{De}^2}{\\sqrt{A}\\,(1+k^2\\lambda_{De}^2)^2}\\Bigr]\n=\\;c_s\\frac{\\displaystyle\\gamma_i\\sigma+\\frac{1}{(1+k^2\\lambda_{De}^2)^2}}{\\displaystyle\\sqrt{\\gamma_i\\sigma+\\frac{1}{1+k^2\\lambda_{De}^2}}}\\,. $$  \nThis is the desired expression.",
            "answer": "$$\\boxed{v_g=c_s\\;\\frac{\\gamma_i\\sigma+\\bigl(1+k^2\\lambda_{De}^2\\bigr)^{-2}}{\\sqrt{\\gamma_i\\sigma+\\bigl(1+k^2\\lambda_{De}^2\\bigr)^{-1}}}}$$"
        },
        {
            "introduction": "Modern plasma physics relies heavily on numerical simulations to explore complex, non-linear phenomena that are analytically intractable. This hands-on computational exercise bridges the gap between abstract theory and practical research by guiding you through the setup of a Particle-In-Cell (PIC) simulation. You will use fundamental physical scales like the Debye length and plasma frequency to determine the necessary spatial and temporal resolution required to accurately capture both ion acoustic and Langmuir wave dynamics , a critical first step in any numerical investigation.",
            "id": "3998536",
            "problem": "Consider a one-dimensional electrostatic Particle-In-Cell (PIC) simulation intended to resolve both Langmuir waves and ion acoustic waves in a quasineutral plasma relevant to computational fusion science and engineering. The model is based on the following fundamental and widely accepted relations and definitions, which you must use as the starting point to design spatial and temporal resolution requirements:\n\n- Debye shielding sets a characteristic screening scale given by the electron Debye length $$\\lambda_{D} = \\sqrt{\\frac{\\varepsilon_{0} k_{B} T_{e}}{n_{e} e^{2}}}$$ where $\\varepsilon_{0}$ is the vacuum permittivity, $k_{B}$ is the Boltzmann constant, $T_{e}$ is the electron temperature, $n_{e}$ is the electron number density, and $e$ is the elementary charge. When the electron temperature is expressed in electronvolts, the thermal energy satisfies $k_{B} T_{e} = e T_{e}$.\n\n- Linearized electron fluid oscillations couple to Poissonâ€™s equation to produce Langmuir waves characterized by the electron plasma frequency $$\\omega_{pe} = \\sqrt{\\frac{n_{e} e^{2}}{\\varepsilon_{0} m_{e}}}$$ where $m_{e}$ is the electron mass.\n\n- The ion acoustic wave phase speed for ions with charge state $Z$, electron temperature $T_{e}$, and ion temperature $T_{i}$ is, under isothermal electrons and ions with an effective ion adiabatic index $\\gamma_{i}$, $$c_{s} = \\sqrt{\\frac{Z k_{B} T_{e} + \\gamma_{i} k_{B} T_{i}}{m_{i}}}$$ where $m_{i}$ is the ion mass. For temperatures expressed in electronvolts, use $k_{B} T_{e} = e T_{e}$ and $k_{B} T_{i} = e T_{i}$.\n\n- The fundamental wavenumber of interest is $k$, with corresponding wavelength $\\lambda = \\frac{2 \\pi}{k}$. You must treat $k$ as the highest wavenumber to be resolved in the simulation.\n\n- To faithfully resolve dynamics, invoke the sampling principle that a discrete grid must place multiple points across the smallest physically relevant spatial scale and multiple samples across the fastest temporal oscillation. In concrete terms, enforce a user-chosen number of grid points across the Debye length and across a wave of wavelength $\\lambda$, and a user-chosen number of time samples across a Langmuir period $\\frac{2\\pi}{\\omega_{pe}}$ and across an ion acoustic period $\\frac{2\\pi}{k c_{s}}$. You must formalize these requirements into explicit constraints on the grid spacing $\\Delta x$ and time step $\\Delta t$, each expressed as inequalities that ensure at least the requested number of samples.\n\nDesign the program to compute recommended numerical resolution for the PIC model from first principles as follows:\n\n1. For each test case, derive $\\lambda_{D}$, $\\omega_{pe}$, $c_{s}$, and $\\lambda$ from the provided physical parameters $n_{e}$, $T_{e}$, $T_{i}$, $Z$, $m_{i}$, and $k$.\n\n2. From the sampling requirements, determine a spatial grid spacing $\\Delta x$ that simultaneously resolves the Debye length and the wave of wavelength $\\lambda$. You must choose $\\Delta x$ small enough to place at least the specified number of points over $\\lambda_{D}$ and over $\\lambda$. Then, given a domain length $L$, compute the number of grid points $N_{x}$ required. To support spectral Poisson solvers, round $N_{x}$ up to the next power of $2$.\n\n3. From the sampling requirements, determine a time step $\\Delta t$ that simultaneously resolves the fastest electron plasma oscillations and the ion acoustic oscillations at $k$. Compute the number of time steps $N_{t}$ needed to simulate a total time equal to a specified number of ion acoustic periods.\n\nYour program must implement the above derivations without using any shortcut formulas not justified by these bases. The constants $\\varepsilon_{0}$, $e$, and $m_{e}$ must be used with their accepted International System of Units (SI) values. All quantities must be computed in SI units. Express $\\Delta x$ in meters and $\\Delta t$ in seconds.\n\nYour program must process the following test suite. Each test case is a tuple containing $(n_{e}, T_{e}, T_{i}, Z, m_{i}, k, L, \\gamma_{i}, N_{x,D}, N_{x,\\lambda}, N_{t,e}, N_{t,s}, M)$ where\n- $n_{e}$ is in $\\mathrm{m}^{-3}$,\n- $T_{e}$ and $T_{i}$ are in electronvolts,\n- $Z$ is dimensionless,\n- $m_{i}$ is in $\\mathrm{kg}$,\n- $k$ is in $\\mathrm{m}^{-1}$,\n- $L$ is in $\\mathrm{m}$,\n- $\\gamma_{i}$ is dimensionless,\n- $N_{x,D}$ is the requested minimum number of grid points across $\\lambda_{D}$,\n- $N_{x,\\lambda}$ is the requested minimum number of grid points across $\\lambda$,\n- $N_{t,e}$ is the requested minimum number of time samples across one Langmuir period $\\frac{2\\pi}{\\omega_{pe}}$,\n- $N_{t,s}$ is the requested minimum number of time samples across one ion acoustic period $\\frac{2\\pi}{k c_{s}}$,\n- $M$ is the number of ion acoustic periods to simulate for the total duration.\n\nUse the following scientifically plausible test suite:\n- Case $1$: $(10^{19}, 100, 20, 1, m_{p}, 800, 0.1, 1, 10, 30, 50, 60, 10)$\n- Case $2$: $(10^{20}, 10, 5, 1, 2 m_{p}, 2000, 0.05, 1, 12, 40, 60, 80, 15)$\n- Case $3$: $(10^{16}, 100, 100, 1, 4 m_{p}, 100, 1.0, 1, 8, 30, 40, 50, 8)$\n- Case $4$: $(5 \\times 10^{18}, 5, 5, 1, 12 m_{p}, 50, 2.0, 1, 10, 20, 40, 60, 12)$\n\nHere $m_{p}$ is the proton mass.\n\nFor each case, the program must output a list $[\\Delta x, \\Delta t, N_{x}, N_{t}]$ where $\\Delta x$ is in $\\mathrm{m}$, $\\Delta t$ is in $\\mathrm{s}$, $N_{x}$ is an integer number of grid points (rounded up to the next power of $2$), and $N_{t}$ is an integer number of time steps to cover $M$ ion acoustic periods.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one item per test case in the order listed. Each item is itself the list $[\\Delta x, \\Delta t, N_{x}, N_{t}]$ for that case. There must be no spaces in the output. For example, $[[a,b,c,d],[e,f,g,h]]$.\n\nAll answers must be expressed in SI units as specified above, and angles do not appear in this problem. Percentages do not appear in this problem. Ensure scientific realism by using the above derivations and constraints only.",
            "solution": "The problem requires the design of a program to calculate the necessary spatial and temporal resolution for a one-dimensional electrostatic Particle-In-Cell (PIC) simulation. The resolution must be sufficient to resolve both electron-scale phenomena (Langmuir waves, Debye shielding) and ion-scale phenomena (ion acoustic waves). The derivation proceeds from first principles as laid out in the problem statement.\n\nFirst, we establish the fundamental physical constants in SI units that will be used in all calculations. These are the vacuum permittivity $\\varepsilon_{0}$, the elementary charge $e$, the electron mass $m_{e}$, and the proton mass $m_{p}$.\n\nFor each test case, characterized by the parameter set $(n_{e}, T_{e}, T_{i}, Z, m_{i}, k, L, \\gamma_{i}, N_{x,D}, N_{x,\\lambda}, N_{t,e}, N_{t,s}, M)$, we perform the following sequence of calculations.\n\n**1. Calculation of Characteristic Plasma Parameters**\n\nThe physical behavior of the plasma is described by several key parameters, which we must first calculate from the given inputs.\n\n-   **Electron Debye Length ($\\lambda_D$):** This is the characteristic distance over which charge is screened. Using the provided formula and the conversion for temperatures in electronvolts ($k_B T = eT$), we have:\n    $$ \\lambda_{D} = \\sqrt{\\frac{\\varepsilon_{0} k_{B} T_{e}}{n_{e} e^{2}}} = \\sqrt{\\frac{\\varepsilon_{0} (e T_{e,\\text{eV}})}{n_{e} e^{2}}} = \\sqrt{\\frac{\\varepsilon_{0} T_{e,\\text{eV}}}{n_{e} e}} $$\n    Here, $T_{e,\\text{eV}}$ represents the numerical value of the electron temperature given in electronvolts.\n\n-   **Electron Plasma Frequency ($\\omega_{pe}$):** This is the natural frequency of oscillation for electrons displaced from a uniform ion background.\n    $$ \\omega_{pe} = \\sqrt{\\frac{n_{e} e^{2}}{\\varepsilon_{0} m_{e}}} $$\n\n-   **Ion Acoustic Speed ($c_s$):** This is the phase speed of longitudinal waves in the ion density, mediated by electron pressure.\n    $$ c_{s} = \\sqrt{\\frac{Z k_{B} T_{e} + \\gamma_{i} k_{B} T_{i}}{m_{i}}} = \\sqrt{\\frac{e(Z T_{e,\\text{eV}} + \\gamma_{i} T_{i,\\text{eV}})}{m_{i}}} $$\n    Here, $T_{e,\\text{eV}}$ and $T_{i,\\text{eV}}$ are the numerical values of the electron and ion temperatures in electronvolts.\n\n-   **Wavelength ($\\lambda$):** This is the spatial period of the wave of interest, corresponding to the highest resolved wavenumber $k$.\n    $$ \\lambda = \\frac{2 \\pi}{k} $$\n\n**2. Determination of Spatial Resolution ($\\Delta x$ and $N_x$)**\n\nA PIC simulation grid must be fine enough to resolve the smallest relevant physical length scales. In this problem, two scales are critical: the Debye length $\\lambda_D$ and the shortest wavelength of interest $\\lambda$.\n\n-   **Grid Spacing ($\\Delta x$):** The grid spacing $\\Delta x$ is constrained by two simultaneous requirements:\n    1.  To resolve the Debye length with at least $N_{x,D}$ points: $\\Delta x \\le \\frac{\\lambda_D}{N_{x,D}}$.\n    2.  To resolve the wavelength $\\lambda$ with at least $N_{x,\\lambda}$ points: $\\Delta x \\le \\frac{\\lambda}{N_{x,\\lambda}}$.\n\n    To satisfy both conditions, we must choose $\\Delta x$ to be smaller than or equal to the minimum of these two upper bounds. The largest permissible value for $\\Delta x$ is therefore:\n    $$ \\Delta x = \\min\\left(\\frac{\\lambda_D}{N_{x,D}}, \\frac{\\lambda}{N_{x,\\lambda}}\\right) = \\min\\left(\\frac{\\lambda_D}{N_{x,D}}, \\frac{2\\pi}{k N_{x,\\lambda}}\\right) $$\n\n-   **Number of Grid Points ($N_x$):** For a simulation domain of length $L$, the minimum number of grid cells required is $N_{x, \\text{min}} = \\lceil \\frac{L}{\\Delta x} \\rceil$. The problem specifies that this number must be rounded up to the next power of $2$, a common requirement for algorithms using the Fast Fourier Transform (FFT), such as spectral Poisson solvers. Therefore, we calculate $N_x$ as the smallest power of $2$ that is greater than or equal to $N_{x, \\text{min}}$.\n\n**3. Determination of Temporal Resolution ($\\Delta t$ and $N_t$)**\n\nThe simulation time step $\\Delta t$ must be small enough to resolve the fastest oscillations in the system. Here, we consider the electron plasma oscillations and the ion acoustic oscillations.\n\n-   **Time Step ($\\Delta t$):** The time step $\\Delta t$ is constrained by:\n    1.  To resolve the Langmuir period ($T_{pe} = 2\\pi/\\omega_{pe}$) with at least $N_{t,e}$ samples: $\\Delta t \\le \\frac{2\\pi}{\\omega_{pe} N_{t,e}}$.\n    2.  To resolve the ion acoustic period at wavenumber $k$ ($T_s = 2\\pi/(kc_s)$) with at least $N_{t,s}$ samples: $\\Delta t \\le \\frac{2\\pi}{k c_s N_{t,s}}$.\n\n    To resolve both phenomena, $\\Delta t$ must be chosen to satisfy the more stringent condition:\n    $$ \\Delta t = \\min\\left(\\frac{2\\pi}{\\omega_{pe} N_{t,e}}, \\frac{2\\pi}{k c_s N_{t,s}}\\right) $$\n\n-   **Number of Time Steps ($N_t$):** The total simulation is to run for a duration equal to $M$ ion acoustic periods. The total time $T_{\\text{total}}$ is:\n    $$ T_{\\text{total}} = M \\cdot T_s = M \\cdot \\frac{2\\pi}{k c_s} $$\n    The number of time steps required to cover this duration is then found by dividing the total time by the time step size and rounding up to the nearest integer to ensure the full duration is simulated:\n    $$ N_t = \\left\\lceil \\frac{T_{\\text{total}}}{\\Delta t} \\right\\rceil $$\n\nThe implementation will apply this sequence of calculations to each provided test case, yielding the four required output values: $\\Delta x$ in meters, $\\Delta t$ in seconds, and the integer counts $N_x$ and $N_t$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.constants import epsilon_0, e, m_e, m_p\n\ndef solve():\n    \"\"\"\n    Calculates the required spatial and temporal resolution for a 1D PIC simulation\n    based on fundamental plasma physics principles.\n    \"\"\"\n    \n    # Fundamental constants from scipy.constants in SI units\n    E_CHARGE = e\n    EPSILON_0 = epsilon_0\n    M_ELECTRON = m_e\n    M_PROTON = m_p\n\n    # Test suite as defined in the problem statement\n    # Format: (n_e, T_e, T_i, Z, m_i, k, L, gamma_i, Nx_D, Nx_lambda, Nt_e, Nt_s, M)\n    test_cases = [\n        (1e19, 100.0, 20.0, 1, M_PROTON, 800.0, 0.1, 1.0, 10, 30, 50, 60, 10),\n        (1e20, 10.0, 5.0, 1, 2 * M_PROTON, 2000.0, 0.05, 1.0, 12, 40, 60, 80, 15),\n        (1e16, 100.0, 100.0, 1, 4 * M_PROTON, 100.0, 1.0, 8, 30, 40, 50, 8),\n        (5e18, 5.0, 5.0, 1, 12 * M_PROTON, 50.0, 2.0, 1.0, 10, 20, 40, 60, 12)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n_e, T_e_eV, T_i_eV, Z, m_i, k, L, gamma_i, Nx_D, Nx_lambda, Nt_e, Nt_s, M = case\n\n        # Step 1: Calculate fundamental plasma parameters in SI units\n        \n        # Electron Debye Length (lambda_D)\n        # lambda_D = sqrt(eps0 * kB * Te / (ne * e^2))\n        # Since Te is in eV, kB * Te = e * Te_eV\n        lambda_D = np.sqrt(EPSILON_0 * T_e_eV / (n_e * E_CHARGE))\n\n        # Electron Plasma Frequency (omega_pe)\n        # omega_pe = sqrt(ne * e^2 / (eps0 * me))\n        omega_pe = np.sqrt(n_e * E_CHARGE**2 / (EPSILON_0 * M_ELECTRON))\n\n        # Ion Acoustic Speed (c_s)\n        # c_s = sqrt((Z * kB * Te + gamma_i * kB * Ti) / mi)\n        # Again, use kB * T = e * T_eV\n        numerator_cs = E_CHARGE * (Z * T_e_eV + gamma_i * T_i_eV)\n        c_s = np.sqrt(numerator_cs / m_i)\n\n        # Wavelength (lambda) for the given wavenumber k\n        lambda_k = 2 * np.pi / k\n\n        # Step 2: Determine spatial resolution (Delta x and Nx)\n\n        # Constraint from resolving Debye length\n        dx_bound_D = lambda_D / Nx_D\n        \n        # Constraint from resolving wavelength lambda\n        dx_bound_lambda = lambda_k / Nx_lambda\n\n        # Choose Delta x to satisfy the most stringent constraint\n        delta_x = min(dx_bound_D, dx_bound_lambda)\n\n        # Calculate number of grid points Nx, rounded up to the next power of 2\n        Nx_min = np.ceil(L / delta_x)\n        if Nx_min <= 1:\n            Nx = 1\n        else:\n            Nx = int(1 << (int(Nx_min) - 1).bit_length())\n\n        # Step 3: Determine temporal resolution (Delta t and Nt)\n        \n        # Constraint from resolving Langmuir period (2*pi/omega_pe)\n        dt_bound_e = (2 * np.pi / omega_pe) / Nt_e\n\n        # Constraint from resolving ion acoustic period (2*pi/(k*c_s))\n        dt_bound_s = (2 * np.pi / (k * c_s)) / Nt_s\n        \n        # Choose Delta t to satisfy the most stringent constraint\n        delta_t = min(dt_bound_e, dt_bound_s)\n\n        # Calculate total simulation time for M ion acoustic periods\n        ion_acoustic_period = 2 * np.pi / (k * c_s)\n        T_total = M * ion_acoustic_period\n\n        # Calculate number of time steps Nt, rounded up\n        Nt = int(np.ceil(T_total / delta_t))\n\n        results.append([delta_x, delta_t, Nx, Nt])\n\n    # Format the final output string as specified\n    # e.g., [[val1,val2,val3,val4],[val5,val6,val7,val8]]\n    result_strings = [str(r).replace(\" \", \"\") for r in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}