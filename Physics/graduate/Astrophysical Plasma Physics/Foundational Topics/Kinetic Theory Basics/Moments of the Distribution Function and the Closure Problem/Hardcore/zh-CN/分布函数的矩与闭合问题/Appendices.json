{
    "hands_on_practices": [
        {
            "introduction": "天体物理等离子体通常远离热平衡，其粒子速度分布呈现出具有高能拖尾的非麦克斯韦形态，一个典型的例子是卡帕分布（kappa distribution）。本练习将指导您为由卡帕分布描述的等离子体推导一个闭合关系。通过这个实践，您将了解分布函数的具体形态，特别是其高能粒子拖尾，如何直接决定流体方程中的闭合形式。",
            "id": "4221724",
            "problem": "考虑一个天体物理等离子体中的各向同性电子群，其速度分布函数为非麦克斯韦分布，由三维卡帕分布给出。设速率分布定义为\n$$\nf(v) = A \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)},\n$$\n其中 $v$ 是粒子速率，$\\kappa > \\frac{5}{2}$ 是控制高能尾部的卡帕指数，$\\theta$ 是一个特征速率标度，而 $A$ 是一个归一化常数，其选择使得数密度 $n$ 满足\n$$\nn = \\int f(\\boldsymbol{v})\\,d^{3}v = 4\\pi \\int_{0}^{\\infty} f(v)\\,v^{2}\\,dv.\n$$\n将速度矩定义为\n$$\n\\langle v^{m} \\rangle = \\frac{1}{n}\\int v^{m}\\,f(\\boldsymbol{v})\\,d^{3}v = \\frac{4\\pi}{n}\\int_{0}^{\\infty} v^{m+2}\\,f(v)\\,dv.\n$$\n在无碰撞等离子体的流体闭合背景下，一个常见的标量四阶矩闭合通过以下方式将四阶速度矩与二阶速度矩的平方联系起来\n$$\n\\langle v^{4} \\rangle = C(\\kappa)\\,\\langle v^{2} \\rangle^{2}.\n$$\n从上述定义出发，并仅假设各向同性和给定的 $f(v)$ 卡帕分布形式，推导与卡帕相关的精确闭合系数 $C(\\kappa)$ 的闭合形式解析表达式。将最终答案表示为仅含 $\\kappa$ 的函数。不需要数值近似，最终答案中不应包含任何单位。",
            "solution": "首先验证问题，以确保其自洽、科学上合理且适定。\n\n### 第1步：提取已知条件\n- 粒子群是各向同性的。\n- 速率的速度分布由卡帕分布给出：$f(v) = A \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)}$。\n- 卡帕指数为 $\\kappa > \\frac{5}{2}$。\n- $\\theta$ 是一个特征速率标度。\n- $A$ 是一个归一化常数。\n- 数密度为 $n = \\int f(\\boldsymbol{v})\\,d^{3}v = 4\\pi \\int_{0}^{\\infty} f(v)\\,v^{2}\\,dv$。\n- 速度矩定义为 $\\langle v^{m} \\rangle = \\frac{1}{n}\\int v^{m}\\,f(\\boldsymbol{v})\\,d^{3}v = \\frac{4\\pi}{n}\\int_{0}^{\\infty} v^{m+2}\\,f(v)\\,dv$。\n- 给出了一个四阶矩闭合关系：$\\langle v^{4} \\rangle = C(\\kappa)\\,\\langle v^{2} \\rangle^{2}$。\n- 目标是推导闭合系数 $C(\\kappa)$ 的精确解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题设置在天体物理等离子体物理学的标准理论框架内。卡帕分布是用于描述空间等离子体中观测到的非热粒子群的一种广泛使用的标准模型。速度矩和流体闭合问题的概念是动理学理论及其流体近似的基础。该问题在科学上是有效且相关的。\n- **适定性：** 提供了所有必要的定义和函数。条件 $\\kappa > \\frac{5}{2}$ 具有重要的物理意义，因为它确保了四阶矩 $\\langle v^4 \\rangle$ 积分的收敛性。该问题是自洽的，并且在数学上结构良好，可以为 $C(\\kappa)$ 产生唯一解。\n- **目标：** 问题以精确的数学语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。这是一个在理论等离子体物理学中适定且科学上合理的问​​题。我现在将继续进行推导。\n\n### 推导过程\n目标是从关系式 $\\langle v^{4} \\rangle = C(\\kappa)\\,\\langle v^{2} \\rangle^{2}$ 中求出闭合系数 $C(\\kappa)$。这可以改写为：\n$$\nC(\\kappa) = \\frac{\\langle v^{4} \\rangle}{\\langle v^{2} \\rangle^{2}}\n$$\n我们必须首先计算二阶和四阶速度矩，即 $\\langle v^{2} \\rangle$ 和 $\\langle v^{4} \\rangle$。\n\n根据所提供的定义，$m$ 阶矩为：\n$$\n\\langle v^{m} \\rangle = \\frac{4\\pi}{n}\\int_{0}^{\\infty} v^{m+2}\\,f(v)\\,dv\n$$\n代入 $f(v)$ 的表达式可得：\n$$\n\\langle v^{m} \\rangle = \\frac{4\\pi A}{n}\\int_{0}^{\\infty} v^{m+2} \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)} dv\n$$\n归一化条件是 $n = 4\\pi A \\int_{0}^{\\infty} v^{2} \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)} dv$。\n我们可以将比率 $\\frac{4\\pi A}{n}$ 表示为：\n$$\n\\frac{4\\pi A}{n} = \\frac{1}{\\int_{0}^{\\infty} v^{2} \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)} dv}\n$$\n因此，矩 $\\langle v^m \\rangle$ 可以写成积分之比，这样可以方便地消去归一化常数 $A$：\n$$\n\\langle v^{m} \\rangle = \\frac{\\int_{0}^{\\infty} v^{m+2} \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)} dv}{\\int_{0}^{\\infty} v^{2} \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)} dv}\n$$\n让我们定义一个通用积分 $J_{p}$ 为：\n$$\nJ_{p} = \\int_{0}^{\\infty} v^{p} \\left(1 + \\frac{v^{2}}{\\kappa \\,\\theta^{2}}\\right)^{-(\\kappa+1)} dv\n$$\n用这些积分表示，矩为：\n$$\n\\langle v^{2} \\rangle = \\frac{J_{4}}{J_{2}} \\quad \\text{and} \\quad \\langle v^{4} \\rangle = \\frac{J_{6}}{J_{2}}\n$$\n将这些代入 $C(\\kappa)$ 的表达式中：\n$$\nC(\\kappa) = \\frac{\\langle v^{4} \\rangle}{\\langle v^{2} \\rangle^{2}} = \\frac{J_{6}/J_{2}}{(J_{4}/J_{2})^{2}} = \\frac{J_{6} J_{2}}{J_{4}^{2}}\n$$\n为了计算 $J_{p}$，我们进行变量替换。令 $x = \\frac{v^{2}}{\\kappa \\theta^{2}}$。\n那么 $v^{2} = \\kappa \\theta^{2} x$，这意味着 $v = \\sqrt{\\kappa} \\theta x^{1/2}$。\n微分是 $dv = \\sqrt{\\kappa} \\theta \\frac{1}{2} x^{-1/2} dx$。\n积分 $J_p$ 变为：\n$$\nJ_{p} = \\int_{0}^{\\infty} (\\sqrt{\\kappa} \\theta x^{1/2})^{p} (1+x)^{-(\\kappa+1)} \\left(\\sqrt{\\kappa} \\theta \\frac{1}{2} x^{-1/2}\\right) dx\n$$\n$$\nJ_{p} = \\frac{(\\sqrt{\\kappa} \\theta)^{p+1}}{2} \\int_{0}^{\\infty} x^{p/2} x^{-1/2} (1+x)^{-(\\kappa+1)} dx\n$$\n$$\nJ_{p} = \\frac{(\\kappa \\theta^{2})^{(p+1)/2}}{2} \\int_{0}^{\\infty} x^{(p-1)/2} (1+x)^{-(\\kappa+1)} dx\n$$\n该积分是贝塔函数的一种表示形式，$B(z_{1}, z_{2}) = \\int_{0}^{\\infty} t^{z_{1}-1} (1+t)^{-(z_{1}+z_{2})} dt$。\n通过比较，我们设 $z_{1}-1 = \\frac{p-1}{2}$，得到 $z_{1} = \\frac{p+1}{2}$。\n并且 $z_{1}+z_{2} = \\kappa+1$，得到 $z_{2} = \\kappa+1 - z_{1} = \\kappa+1 - \\frac{p+1}{2} = \\kappa - \\frac{p-1}{2}$。\n该积分在 $z_{1} > 0$ 和 $z_{2} > 0$ 时收敛。条件 $z_2 > 0$ 要求 $\\kappa > \\frac{p-1}{2}$。对于 $p=6$，此条件为 $\\kappa > \\frac{5}{2}$，这正是问题陈述中给出的条件，证实了该问题是适定的。\n\n所以，$J_{p}$ 由下式给出：\n$$\nJ_{p} = \\frac{(\\kappa \\theta^{2})^{(p+1)/2}}{2} B\\left(\\frac{p+1}{2}, \\kappa - \\frac{p-1}{2}\\right)\n$$\n使用关系式 $B(z_{1}, z_{2}) = \\frac{\\Gamma(z_{1})\\Gamma(z_{2})}{\\Gamma(z_{1}+z_{2})}$，我们得到：\n$$\nJ_{p} = \\frac{(\\kappa \\theta^{2})^{(p+1)/2}}{2} \\frac{\\Gamma\\left(\\frac{p+1}{2}\\right)\\Gamma\\left(\\kappa - \\frac{p-1}{2}\\right)}{\\Gamma(\\kappa+1)}\n$$\n现在我们可以构造 $C(\\kappa) = \\frac{J_{6} J_{2}}{J_{4}^{2}}$ 的比率。包含 $\\kappa$ 和 $\\theta$ 的前置因子将抵消：\n$$\n\\frac{(\\kappa\\theta^2)^{(6+1)/2} (\\kappa\\theta^2)^{(2+1)/2}}{[(\\kappa\\theta^2)^{(4+1)/2}]^2} = \\frac{(\\kappa\\theta^2)^{7/2} (\\kappa\\theta^2)^{3/2}}{(\\kappa\\theta^2)^{10/2}} = \\frac{(\\kappa\\theta^2)^{10/2}}{(\\kappa\\theta^2)^{5}}=1\n$$\n每个 $J_p$ 项中的因子 $1/2$ 和 $\\Gamma(\\kappa+1)$ 也在比率中抵消：\n$$\nC(\\kappa) = \\frac{\\left[\\Gamma\\left(\\frac{7}{2}\\right)\\Gamma\\left(\\kappa-\\frac{5}{2}\\right)\\right] \\left[\\Gamma\\left(\\frac{3}{2}\\right)\\Gamma\\left(\\kappa-\\frac{1}{2}\\right)\\right]}{\\left[\\Gamma\\left(\\frac{5}{2}\\right)\\Gamma\\left(\\kappa-\\frac{3}{2}\\right)\\right]^{2}}\n$$\n我们使用伽马函数的递推关系 $\\Gamma(z+1)=z\\Gamma(z)$ 来简化此表达式。\n让我们将各项分组：\n$$\nC(\\kappa) = \\left(\\frac{\\Gamma(\\frac{7}{2})\\Gamma(\\frac{3}{2})}{\\Gamma(\\frac{5}{2})^{2}}\\right) \\left(\\frac{\\Gamma(\\kappa-\\frac{5}{2})\\Gamma(\\kappa-\\frac{1}{2})}{\\Gamma(\\kappa-\\frac{3}{2})^{2}}\\right)\n$$\n首先，我们简化包含数值参数的常数部分：\n$\\Gamma(\\frac{7}{2}) = \\frac{5}{2}\\Gamma(\\frac{5}{2})$\n$\\Gamma(\\frac{5}{2}) = \\frac{3}{2}\\Gamma(\\frac{3}{2})$\n所以，$\\frac{\\Gamma(\\frac{7}{2})}{\\Gamma(\\frac{5}{2})} = \\frac{5}{2}$ 且 $\\frac{\\Gamma(\\frac{3}{2})}{\\Gamma(\\frac{5}{2})} = \\frac{\\Gamma(\\frac{3}{2})}{\\frac{3}{2}\\Gamma(\\frac{3}{2})} = \\frac{2}{3}$。\n常数部分是 $(\\frac{5}{2})(\\frac{2}{3}) = \\frac{5}{3}$。\n\n接下来，我们简化与 $\\kappa$ 相关的部分：\n$\\Gamma(\\kappa-\\frac{1}{2}) = (\\kappa-\\frac{3}{2})\\Gamma(\\kappa-\\frac{3}{2})$\n$\\Gamma(\\kappa-\\frac{3}{2}) = (\\kappa-\\frac{5}{2})\\Gamma(\\kappa-\\frac{5}{2})$\n所以，$\\frac{\\Gamma(\\kappa-\\frac{1}{2})}{\\Gamma(\\kappa-\\frac{3}{2})} = \\kappa-\\frac{3}{2}$ 且 $\\frac{\\Gamma(\\kappa-\\frac{5}{2})}{\\Gamma(\\kappa-\\frac{3}{2})} = \\frac{\\Gamma(\\kappa-\\frac{5}{2})}{(\\kappa-\\frac{5}{2})\\Gamma(\\kappa-\\frac{5}{2})} = \\frac{1}{\\kappa-\\frac{5}{2}}$。\n与 $\\kappa$ 相关的部分是 $(\\kappa-\\frac{3}{2})(\\frac{1}{\\kappa-\\frac{5}{2}}) = \\frac{\\kappa-\\frac{3}{2}}{\\kappa-\\frac{5}{2}}$。\n\n结合两部分，我们得到：\n$$\nC(\\kappa) = \\frac{5}{3} \\frac{\\kappa-\\frac{3}{2}}{\\kappa-\\frac{5}{2}}\n$$\n为了以更简洁的形式呈现，我们可以将分数的分子和分母同乘以 $2$：\n$$\nC(\\kappa) = \\frac{5}{3} \\frac{2\\kappa-3}{2\\kappa-5}\n$$\n作为最终检验，在极限 $\\kappa \\to \\infty$ 下，卡帕分布趋近于麦克斯韦分布。对于麦克斯韦分布，已知 $\\langle v^4 \\rangle / \\langle v^2 \\rangle^2 = 5/3$。\n我们的结果给出 $\\lim_{\\kappa \\to \\infty} C(\\kappa) = \\lim_{\\kappa \\to \\infty} \\frac{5}{3} \\frac{2\\kappa-3}{2\\kappa-5} = \\frac{5}{3} \\lim_{\\kappa \\to \\infty} \\frac{2-3/\\kappa}{2-5/\\kappa} = \\frac{5}{3}$。\n该结果正确地再现了麦克斯韦极限，这为我们的推导提供了信心。",
            "answer": "$$\n\\boxed{\\frac{5}{3}\\frac{2\\kappa - 3}{2\\kappa - 5}}\n$$"
        },
        {
            "introduction": "在构建或应用任何流体闭合之前，一个根本问题是：给定的一组矩（如密度、温度、热流）是否在物理上“可实现”？本练习将引导您实现一个检验器，用于验证任何矩集都必须满足的基本可实现性条件。通过检验这些源于分布函数非负性的数学不等式，您将深入理解所有动力学和流体模型背后的根本约束。",
            "id": "4221722",
            "problem": "考虑一个一维、非相对论性天体物理等离子体，其特征在于一个速度分布函数 $f(v)$，该函数在所有实数速度 $v$ 上是非负且可积的。设数密度 $n$、整体速度 $u$ 和中心矩由以下基本矩积分定义\n$$\nn = \\int_{-\\infty}^{\\infty} f(v)\\, dv,\\qquad\nu = \\frac{1}{n}\\int_{-\\infty}^{\\infty} v\\, f(v)\\, dv,\n$$\n$$\n\\mu_k = \\frac{1}{n}\\int_{-\\infty}^{\\infty} (v - u)^k\\, f(v)\\, dv,\\qquad k\\in\\{2,3,4\\}.\n$$\n量 $\\mu_2$ 是二阶中心矩，等于热速度的平方 $\\Theta$，即 $\\Theta = \\mu_2$。三阶中心矩 $\\mu_3$ 与一维参考系中的热流密度有关（除了对于这个纯数学验证任务而言非必需的物理常数乘数），而四阶中心矩 $\\mu_4$ 则表征了分布的峰度。\n\n在从Vlasov方程（或对于无碰撞动力学，从无碰撞的Boltzmann方程）推导出的动理学矩层次中，需要使用闭合关系来用低阶矩表示高阶矩。本问题专注于基于 $f(v)$ 的非负性所蕴含的必要不等式以及最大熵（ME）闭合的特征，对此类闭合进行数值可实现性和验证。最大熵（ME）指的是在给定 $n$、$u$ 和 $\\Theta$ 约束条件下，最大化Boltzmann-Shannon熵的闭合，这会产生一个速度上的高斯（麦克斯韦）分布。\n\n您必须编写一个程序，对于每个提供的测试用例，接收 $(n, u, \\Theta, \\mu_3, \\mu_4)$ 作为输入，并返回两个布尔值输出：\n- 第一个布尔值 $B_{\\mathrm{real}}$ 通过检查以下条件来验证矩集的一般数值可实现性：\n  1. 正性约束：$n > 0$ 和 $\\Theta > 0$。\n  2. 由 $f(v)$ 的非负性所蕴含的类柯西-施瓦茨不等式：$\\mu_4 \\ge \\mu_2^2$。\n  3. 混合矩柯西-施瓦茨界：$\\lvert \\mu_3 \\rvert \\le \\sqrt{\\mu_4\\, \\mu_2}$。\n\n- 第二个布尔值 $B_{\\mathrm{ME}}$ 验证与ME闭合的一致性，定义为麦克斯韦分布的矩关系特征：$\\mu_3 = 0$ 和 $\\mu_4 = 3\\, \\mu_2^2$。在实践中，数值浮点比较必须使用一个小的容差。\n\n科学和单位要求：\n- 所有输入和计算量必须按以下单位处理：$n$ 单位为 $\\mathrm{m}^{-3}$，$u$ 单位为 $\\mathrm{m/s}$，$\\Theta$ 单位为 $\\mathrm{m}^2/\\mathrm{s}^2$，$\\mu_3$ 单位为 $\\mathrm{m}^3/\\mathrm{s}^3$，$\\mu_4$ 单位为 $\\mathrm{m}^4/\\mathrm{s}^4$。\n- 所有要求相等的比较都应使用适合浮点运算的相对容差。\n\n测试套件：\n为以下六个测试用例实现您的程序。每个测试用例是一个元组 $(n, u, \\Theta, \\mu_3, \\mu_4)$，其值采用指定单位。\n\n1. 典型的麦克斯韦分布，符合实际的天体物理数值：\n   - $n = 10^6$, $u = 3\\times 10^4$, $\\Theta = 10^8$, $\\mu_3 = 0$, $\\mu_4 = 3\\times (10^8)^2 = 3\\times 10^{16}$。\n\n2. 接近冷极限的麦克斯韦分布（温度极小的边界情况）：\n   - $n = 10^6$, $u = 0$, $\\Theta = 10^{-12}$, $\\mu_3 = 0$, $\\mu_4 = 3\\times (10^{-12})^2 = 3\\times 10^{-24}$。\n\n3. 非麦克斯韦分布但可实现（中等峰度，非零偏度在界限内）：\n   - $n = 10^6$, $u = 10^3$, $\\Theta = 10^6$, $\\mu_4 = 2\\times (10^6)^2 = 2\\times 10^{12}$, $\\mu_3 = \\tfrac{1}{2}\\sqrt{\\mu_4\\, \\Theta} = \\tfrac{1}{2}\\sqrt{2\\times 10^{18}}$。\n\n4. 因违反四阶矩下界而不可实现：\n   - $n = 10^6$, $u = 0$, $\\Theta = 10^6$, $\\mu_4 = \\tfrac{1}{2}\\times (10^6)^2 = 5\\times 10^{11}$, $\\mu_3 = 0$。\n\n5. 因偏度过大违反柯西-施瓦茨界而不可实现：\n   - $n = 10^6$, $u = 0$, $\\Theta = 10^8$, $\\mu_4 = 3\\times (10^8)^2 = 3\\times 10^{16}$, $\\mu_3 = 2\\sqrt{\\mu_4\\, \\Theta} = 2\\sqrt{3\\times 10^{24}}$。\n\n6. 因密度为负而不可实现：\n   - $n = -10^3$, $u = 0$, $\\Theta = 10^8$, $\\mu_4 = 3\\times (10^8)^2 = 3\\times 10^{16}$, $\\mu_3 = 0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表的每个元素是对应测试用例的一个双元素列表 $[B_{\\mathrm{real}}, B_{\\mathrm{ME}}]$，例如 $[[\\mathrm{True},\\mathrm{False}],[\\mathrm{True},\\mathrm{True}],\\dots]$。布尔值必须打印为规范的Python字面量 $\\mathrm{True}$ 或 $\\mathrm{False}$，逗号后无空格。",
            "solution": "所述问题是有效的。它在科学上基于动理学理论和统计力学的原理，特别是求解Vlasov-Boltzmann方程的矩方法。数密度 $n$、整体速度 $u$ 和中心矩 $\\mu_k$ 的定义是标准的。可实现性条件是分布函数 $f(v)$ 非负性的必然结果，而最大熵（ME）闭合条件正确地指定了麦克斯韦分布的性质。问题陈述清晰，目标明确，并为得到唯一解提供了所有必要信息。\n\n目标是开发一个计算程序，以根据两个不同标准来验证矩集 $(n, u, \\Theta, \\mu_3, \\mu_4)$：一般数值可实现性 $B_{\\mathrm{real}}$，以及与最大熵（麦克斯韦）闭合的一致性 $B_{\\mathrm{ME}}$。鉴于 $\\Theta = \\mu_2$，我们将在表达式中使用 $\\Theta$ 以保持一致。\n\n首先，我们处理由布尔值 $B_{\\mathrm{real}}$ 表示的一般数值可实现性。如果存在至少一个非负分布函数 $f(v) \\ge 0$ 能够产生这些矩，那么该矩集就是可实现的。这施加了几个必须满足的数学约束。\n\n1.  **正性约束**：数密度 $n$ 必须为正，$n > 0$，因为它表示单位体积内的粒子数。热速度的平方 $\\Theta = \\mu_2$ 表示速度分布的方差。对于任何非狄拉克δ函数的分布，此方差必须严格为正，即 $\\Theta > 0$。$\\Theta = 0$ 的值对应于所有粒子具有相同速度 $u$ 的“冷”等离子体，但问题指定 $\\Theta > 0$。\n\n2.  **峰度的柯西-施瓦茨不等式**：条件 $\\mu_4 \\ge \\mu_2^2$ 是一个基本的统计不等式。令 $X = v-u$ 为一个随机变量，其概率密度与 $f(v)$ 成正比。其均值为 $E[X] = \\mu_1 = 0$。中心矩为 $\\mu_k = E[X^k]$。该不等式可写作 $E[X^4] \\ge (E[X^2])^2$。这是将凸函数 $\\phi(z) = z^2$ 应用于随机变量 $Y = X^2$ 时，由詹森不等式（Jensen's inequality）得出的直接结果：$E[Y^2] \\ge (E[Y])^2$。它也可以被看作是陈述 $X^2$ 的方差非负：$\\mathrm{Var}(X^2) = E[(X^2)^2] - (E[X^2])^2 = \\mu_4 - \\mu_2^2 \\ge 0$。用 $\\Theta$ 替换 $\\mu_2$，此条件为 $\\mu_4 \\ge \\Theta^2$。\n\n3.  **混合矩柯西-施瓦茨界**：条件 $\\lvert \\mu_3 \\rvert \\le \\sqrt{\\mu_4\\, \\mu_2}$ 来自于将柯西-施瓦茨不等式应用于一个以内积空间，其中函数由 $f(v)$ 加权。考虑内积 $\\langle g, h \\rangle = \\int_{-\\infty}^{\\infty} g(v) h(v) f(v) dv$。令 $g(v) = (v-u)$ 和 $h(v) = (v-u)^2$。柯西-施瓦茨不等式表明 $\\lvert \\langle g, h \\rangle \\rvert^2 \\le \\langle g, g \\rangle \\langle h, h \\rangle$。这可以转化为：\n    $$\n    \\left| \\int_{-\\infty}^{\\infty} (v-u)^3 f(v) dv \\right|^2 \\le \\left( \\int_{-\\infty}^{\\infty} (v-u)^2 f(v) dv \\right) \\left( \\int_{-\\infty}^{\\infty} (v-u)^4 f(v) dv \\right)\n    $$\n    两边除以 $n^2$，我们得到 $(\\mu_3 n)^2 \\le (\\mu_2 n)(\\mu_4 n)$，简化为 $\\mu_3^2 \\le \\mu_2 \\mu_4$。取平方根得到 $|\\mu_3| \\le \\sqrt{\\mu_2 \\mu_4}$。由于 $\\Theta = \\mu_2$，该条件为 $|\\mu_3| \\le \\sqrt{\\mu_4 \\Theta}$。\n\n布尔值 $B_{\\mathrm{real}}$ 是这三个条件的逻辑与（合取）：\n$B_{\\mathrm{real}} = (n > 0) \\land (\\Theta > 0) \\land (\\mu_4 \\ge \\Theta^2) \\land (|\\mu_3| \\le \\sqrt{\\mu_4 \\Theta})$。\n\n其次，我们处理由布尔值 $B_{\\mathrm{ME}}$ 表示的与最大熵（ME）闭合的一致性。ME原理指出，在给定一组约束条件下，最可能的分布是最大化玻尔兹曼-香农熵 $S = -\\int f(v) \\ln f(v) dv$ 的分布。当约束是 $n$、$u$ 和 $\\Theta$ 的固定值时，得到的分布是高斯分布，或称麦克斯韦分布：\n$$\nf_{\\mathrm{M}}(v) = n \\left( \\frac{1}{2\\pi\\Theta} \\right)^{1/2} \\exp\\left(-\\frac{(v-u)^2}{2\\Theta}\\right)\n$$\n这个特定分布的矩必须满足某些关系。\n\n1.  **偏度**：高斯分布关于其均值 $u$ 是对称的。因此，其所有奇数阶中心矩均为零。特别是，与偏度相关的三阶中心矩必须为零：$\\mu_3 = 0$。\n\n2.  **峰度**：方差为 $\\Theta$ 的高斯分布的偶数阶中心矩由 $\\mu_{2k} = \\frac{(2k)!}{2^k k!} \\Theta^k$ 给出。对于四阶中心矩（$k=2$），这得出 $\\mu_4 = \\frac{4!}{2^2 2!} \\Theta^2 = \\frac{24}{8} \\Theta^2 = 3\\Theta^2 = 3\\mu_2^2$。\n\n布尔值 $B_{\\mathrm{ME}}$ 是这两个特定等式的逻辑与。由于这些是浮点数之间的相等性检查，需要一个数值容差。我们使用一个标准的相对容差 $r_{tol}$ 和绝对容差 $a_{tol}$ 来检查两个数 $a$ 和 $b$ 是否接近，即 $|a-b| \\le a_{tol} + r_{tol} |b|$。\n$B_{\\mathrm{ME}} = (\\mathrm{isclose}(\\mu_3, 0)) \\land (\\mathrm{isclose}(\\mu_4, 3\\Theta^2))$。\n\n最终的实现将通过依次应用这两组检查来处理每个测试用例，以生成布尔值对 $[B_{\\mathrm{real}}, B_{\\mathrm{ME}}]$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates astrophysical plasma moment sets against realizability and\n    Maximum Entropy (ME) closure conditions.\n    \"\"\"\n    # Test suite with each case as a tuple (n, u, Theta, mu3, mu4).\n    # Units: n [m^-3], u [m/s], Theta [m^2/s^2], mu3 [m^3/s^3], mu4 [m^4/s^4].\n    test_cases = [\n        # 1. Typical Maxwellian\n        (1e6, 3e4, 1e8, 0.0, 3 * (1e8)**2),\n        # 2. Maxwellian in near-cold limit\n        (1e6, 0.0, 1e-12, 0.0, 3 * (1e-12)**2),\n        # 3. Non-Maxwellian but realizable\n        (1e6, 1e3, 1e6, 0.5 * np.sqrt(2 * (1e6)**2 * 1e6), 2 * (1e6)**2),\n        # 4. Unrealizable (violates mu4 >= mu2^2)\n        (1e6, 0.0, 1e6, 0.0, 0.5 * (1e6)**2),\n        # 5. Unrealizable (violates skewness bound)\n        (1e6, 0.0, 1e8, 2 * np.sqrt(3 * (1e8)**2 * 1e8), 3 * (1e8)**2),\n        # 6. Unrealizable (negative density)\n        (-1e3, 0.0, 1e8, 0.0, 3 * (1e8)**2),\n    ]\n\n    results = []\n    # Set tolerances for floating-point equality checks.\n    rtol = 1e-9  # Relative tolerance\n    atol = 1e-12 # Absolute tolerance\n\n    for case in test_cases:\n        n, u, Theta, mu3, mu4 = case\n\n        # --- Part 1: General Numerical Realizability (B_real) ---\n        # Condition 1: Positivity of number density and thermal energy.\n        cond_positivity = (n > 0) and (Theta > 0)\n\n        # Ensure subsequent calculations are safe if Theta=0, though problem\n        # states Theta > 0.\n        b_real = False\n        if cond_positivity:\n            # Condition 2: Cauchy-Schwarz for kurtosis (mu4 >= mu2^2).\n            # This is equivalent to Var((v-u)^2) >= 0.\n            # No tolerance needed for inequality unless boundary cases are finely tuned.\n            cond_kurtosis = mu4 >= Theta**2\n\n            # Condition 3: Mixed-moment Cauchy-Schwarz bound.\n            # |mu3| <= sqrt(mu4 * mu2)\n            cond_skewness_bound = abs(mu3) <= np.sqrt(mu4 * Theta)\n            \n            b_real = cond_positivity and cond_kurtosis and cond_skewness_bound\n        else:\n            b_real = False\n\n        # --- Part 2: Maximum Entropy (ME) Closure Consistency (B_ME) ---\n        # ME closure implies a Maxwellian distribution.\n        \n        # Condition 1 for ME: Zero skewness (mu3 = 0).\n        # Use absolute tolerance for comparison to zero.\n        cond_me_skewness = np.isclose(mu3, 0.0, rtol=rtol, atol=atol)\n\n        # Condition 2 for ME: Gaussian kurtosis (mu4 = 3 * mu2^2).\n        # Use relative tolerance for comparing non-zero values.\n        cond_me_kurtosis = np.isclose(mu4, 3.0 * Theta**2, rtol=rtol, atol=atol)\n\n        b_me = cond_me_skewness and cond_me_kurtosis\n\n        results.append([b_real, b_me])\n\n    # Format the final output string exactly as specified.\n    # e.g., [[True,False],[True,True],...]\n    output_str = f\"[{','.join([f'[{r[0]},{r[1]}]' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "随着大规模动力学模拟（如质点云法，PIC）的兴起，直接从数据中推导闭合关系成为可能，这为处理复杂系统提供了一种强有力的替代方法。本练习让您扮演一名计算物理学家的角色，任务是从模拟数据集中为热流通量找到最佳拟合的闭合模型。通过应用加权最小二乘法，您将确定闭合系数，从而架起从原始动力学数据到简化流体描述的桥梁。",
            "id": "4221734",
            "problem": "考虑吸积盘冕中的一个弱碰撞磁化电子群，其动力学行为由分布函数 $ f(s, v_{\\parallel}, t) $ 描述，该函数沿着局域磁场对齐坐标 $ s $ 遵循弗拉索夫-麦克斯韦方程组演化。平行电子热通量矩 $ q_{\\parallel}(s,t) $ 定义为 $ f $ 相对于平行体块流 $ u_{\\parallel}(s,t) $ 的三阶中心矩，\n\n$$\nq_{\\parallel}(s,t) = \\frac{m_e}{2} \\int_{-\\infty}^{\\infty} \\left(v_{\\parallel} - u_{\\parallel}(s,t)\\right)^{3} f(s, v_{\\parallel}, t) \\, \\mathrm{d} v_{\\parallel},\n$$\n\n并通过 $ \\partial_s q_{\\parallel} $ 项进入平行能量输运方程。在流体闭合中，$ q_{\\parallel} $ 必须用诸如平行温度 $ T_{\\parallel}(s,t) $ 和体块流 $ u_{\\parallel}(s,t) $ 等低阶矩来建模。受从 Particle-In-Cell (PIC) 模拟中推断出的数据驱动闭合的启发，考虑以下线性两项模型\n\n$$\nq_{\\parallel}(s) \\approx - \\chi \\, \\partial_s T_{\\parallel}(s) - \\beta \\, T_{\\parallel}(s) \\, \\partial_s u_{\\parallel}(s),\n$$\n\n其中 $ \\chi $ 和 $ \\beta $ 是常系数，将通过对固定时刻沿某一条磁力线上的动力学数据进行拟合来确定。\n\n给定一个由 $ M $ 个样本组成的数据集，索引为 $ i = 1, 2, \\dots, M $。对于每个样本，测量的量为\n\n$$\nQ_i = q_{\\parallel}(s_i), \\quad A_i = \\partial_s T_{\\parallel}(s_i), \\quad B_i = T_{\\parallel}(s_i) \\, \\partial_s u_{\\parallel}(s_i),\n$$\n\n以及一个严格为正的权重 $ w_i > 0 $，该权重编码了测量置信度和相空间采样质量。假设回归量 $ A_i $ 和 $ B_i $ 在由 $ w_i $ 导出的加权内积下是线性无关的，因此加权协方差矩阵是可逆的。\n\n根据数据集定义以下加权和：\n\n$$\nS_{AA} = \\sum_{i=1}^{M} w_i A_i^{2}, \\quad\nS_{BB} = \\sum_{i=1}^{M} w_i B_i^{2}, \\quad\nS_{AB} = \\sum_{i=1}^{M} w_i A_i B_i,\n$$\n\n\n$$\nS_{AQ} = \\sum_{i=1}^{M} w_i A_i Q_i, \\quad\nS_{BQ} = \\sum_{i=1}^{M} w_i B_i Q_i.\n$$\n\n\n从 $ q_{\\parallel} $ 作为 $ f $ 的矩的定义出发，并考虑到需要用 $ T_{\\parallel} $ 和 $ u_{\\parallel} $ 来闭合能量级阶，构建加权最小二乘准则，以最小化动力学热通量 $ Q_i $ 与闭合模型预测值 $ - \\chi A_i - \\beta B_i $ 之间的矩不匹配。从第一性原理出发，推导最小化此准则的 $ \\chi $ 和 $ \\beta $ 的解析表达式，并用 $ S_{AA} $、$ S_{BB} $、$ S_{AB} $、$ S_{AQ} $ 和 $ S_{BQ} $ 完全表示您的最终结果。\n\n将您的最终答案以包含 $ \\chi $ 和 $ \\beta $ 的单行矩阵形式给出。不需要进行数值计算。如果您选择展示任何中间表达式，请确保所有数学符号都使用 LaTeX 设置。最终答案必须是一个无单位的闭式解析表达式。",
            "solution": "该问题要求通过最小化与给定数据集之间的加权最小二乘误差，来推导平行电子热通量 $q_{\\parallel}$ 的线性闭合模型的系数 $\\chi$ 和 $\\beta$。该模型由 $q_{\\parallel}(s) \\approx - \\chi \\, \\partial_s T_{\\parallel}(s) - \\beta \\, T_{\\parallel}(s) \\, \\partial_s u_{\\parallel}(s)$ 给出。数据集包含 $M$ 个样本，对于每个样本 $i$，我们有测量得到的热通量 $Q_i = q_{\\parallel}(s_i)$、回归量 $A_i = \\partial_s T_{\\parallel}(s_i)$ 和 $B_i = T_{\\parallel}(s_i) \\, \\partial_s u_{\\parallel}(s_i)$，以及一个正权重 $w_i$。\n\n问题的核心是找到使模型与数据最佳拟合的 $\\chi$ 和 $\\beta$ 的值。“最佳拟合”是在加权最小二乘的意义上定义的。我们首先构建目标函数，即加权残差平方和 $\\mathcal{L}(\\chi, \\beta)$。模型对样本 $i$ 的热通量预测值为 $\\hat{Q}_i = - \\chi A_i - \\beta B_i$。样本 $i$ 的残差是测量值 $Q_i$ 和预测值 $\\hat{Q}_i$ 之间的差值：\n$$\nr_i = Q_i - \\hat{Q}_i = Q_i - (-\\chi A_i - \\beta B_i) = Q_i + \\chi A_i + \\beta B_i\n$$\n加权最小二乘准则旨在最小化这些残差的平方和，其中每一项都由 $w_i$ 加权。因此，目标函数 $\\mathcal{L}(\\chi, \\beta)$ 为：\n$$\n\\mathcal{L}(\\chi, \\beta) = \\sum_{i=1}^{M} w_i r_i^2 = \\sum_{i=1}^{M} w_i (Q_i + \\chi A_i + \\beta B_i)^2\n$$\n为了找到最小化该函数的 $\\chi$ 和 $\\beta$ 的值，我们必须找到 $\\mathcal{L}$ 关于其参数的梯度为零的点。这需要将 $\\mathcal{L}$ 对 $\\chi$ 和 $\\beta$ 的偏导数设为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\chi} = 0 \\quad \\text{和} \\quad \\frac{\\partial \\mathcal{L}}{\\partial \\beta} = 0\n$$\n我们计算关于 $\\chi$ 的一阶偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\chi} = \\frac{\\partial}{\\partial \\chi} \\sum_{i=1}^{M} w_i (Q_i + \\chi A_i + \\beta B_i)^2 = \\sum_{i=1}^{M} w_i \\cdot 2(Q_i + \\chi A_i + \\beta B_i) \\cdot A_i\n$$\n将其设为零并除以 $2$ 得到：\n$$\n\\sum_{i=1}^{M} (w_i A_i Q_i + \\chi w_i A_i^2 + \\beta w_i A_i B_i) = 0\n$$\n通过分配求和项并使用所提供的加权和定义（$S_{AA}$、$S_{AB}$、$S_{AQ}$），该方程变为：\n$$\nS_{AQ} + \\chi S_{AA} + \\beta S_{AB} = 0\n$$\n这是我们两个正规方程中的第一个：\n$$\nS_{AA} \\chi + S_{AB} \\beta = -S_{AQ}\n$$\n接下来，我们计算关于 $\\beta$ 的偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\sum_{i=1}^{M} w_i (Q_i + \\chi A_i + \\beta B_i)^2 = \\sum_{i=1}^{M} w_i \\cdot 2(Q_i + \\chi A_i + \\beta B_i) \\cdot B_i\n$$\n将其设为零并除以 $2$ 得到：\n$$\n\\sum_{i=1}^{M} (w_i B_i Q_i + \\chi w_i A_i B_i + \\beta w_i B_i^2) = 0\n$$\n使用所提供的加权和定义（$S_{BB}$、$S_{AB}$、$S_{BQ}$），该方程变为：\n$$\nS_{BQ} + \\chi S_{AB} + \\beta S_{BB} = 0\n$$\n这是我们的第二个正规方程：\n$$\nS_{AB} \\chi + S_{BB} \\beta = -S_{BQ}\n$$\n现在我们得到了一个关于两个未知数 $\\chi$ 和 $\\beta$ 的二元线性方程组：\n\\begin{align*}\nS_{AA} \\chi + S_{AB} \\beta = -S_{AQ} \\quad (1) \\\\\nS_{AB} \\chi + S_{BB} \\beta = -S_{BQ} \\quad (2)\n\\end{align*}\n该方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix} S_{AA} & S_{AB} \\\\ S_{AB} & S_{BB} \\end{pmatrix} \\begin{pmatrix} \\chi \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} -S_{AQ} \\\\ -S_{BQ} \\end{pmatrix}\n$$\n问题陈述，回归量 $A_i$ 和 $B_i$ 在加权内积下是线性无关的，这保证了左侧的 $2 \\times 2$ 矩阵（通常称为格拉姆矩阵）是可逆的。其行列式 $D = S_{AA} S_{BB} - S_{AB}^2$ 非零。我们可以通过对该矩阵求逆或使用克莱默法则来求解 $\\chi$ 和 $\\beta$。使用克莱默法则：\n$$\n\\chi = \\frac{\\det \\begin{pmatrix} -S_{AQ} & S_{AB} \\\\ -S_{BQ} & S_{BB} \\end{pmatrix}}{D} = \\frac{(-S_{AQ})(S_{BB}) - (S_{AB})(-S_{BQ})}{S_{AA} S_{BB} - S_{AB}^2} = \\frac{S_{AB} S_{BQ} - S_{AQ} S_{BB}}{S_{AA} S_{BB} - S_{AB}^2}\n$$\n$$\n\\beta = \\frac{\\det \\begin{pmatrix} S_{AA} & -S_{AQ} \\\\ S_{AB} & -S_{BQ} \\end{pmatrix}}{D} = \\frac{(S_{AA})(-S_{BQ}) - (-S_{AQ})(S_{AB})}{S_{AA} S_{BB} - S_{AB}^2} = \\frac{S_{AQ} S_{AB} - S_{AA} S_{BQ}}{S_{AA} S_{BB} - S_{AB}^2}\n$$\n这些表达式仅用从数据集中预先计算的加权和，就为系数 $\\chi$ 和 $\\beta$ 提供了解析解。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{S_{AB} S_{BQ} - S_{AQ} S_{BB}}{S_{AA} S_{BB} - S_{AB}^{2}} & \\frac{S_{AQ} S_{AB} - S_{AA} S_{BQ}}{S_{AA} S_{BB} - S_{AB}^{2}} \\end{pmatrix}}\n$$"
        }
    ]
}