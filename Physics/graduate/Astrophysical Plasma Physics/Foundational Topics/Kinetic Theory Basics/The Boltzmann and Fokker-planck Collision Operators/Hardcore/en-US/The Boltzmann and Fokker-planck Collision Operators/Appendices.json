{
    "hands_on_practices": [
        {
            "introduction": "Collision operators, whether Boltzmann or Fokker-Planck, describe the process by which a plasma relaxes towards thermodynamic equilibrium. This equilibrium state is described by the Maxwellian distribution function. Before delving into the complex dynamics of the collision operators themselves, it is essential to have a firm grasp of this foundational distribution. This first practice  provides a crucial check on your understanding by having you verify the normalization of the Maxwellian, connecting its mathematical form directly to the physical definition of number density.",
            "id": "4229584",
            "problem": "In a spatially homogeneous, isotropic, non-drifting single-species astrophysical plasma, the stationary velocity distribution that extremizes entropy subject to fixed number density and energy is the Maxwellian function. For a species of mass $m$ at scalar temperature $T$ and number density $n$, consider the isotropic Maxwellian velocity distribution\n$$\nf_{M}(\\boldsymbol{v}) \\;=\\; n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right),\n$$\nwhere $v \\equiv |\\boldsymbol{v}|$. The fundamental definition of number density in kinetic theory is\n$$\nn \\;=\\; \\int_{\\mathbb{R}^{3}} f(\\boldsymbol{v})\\,\\mathrm{d}^{3}v.\n$$\nState the normalization condition that expresses particle-number conservation by binary collisions for both the Boltzmann collision operator and the Fokker–Planck collision operator, and then, starting from the above definition, explicitly evaluate the velocity-space integral\n$$\nI \\;\\equiv\\; \\int_{\\mathbb{R}^{3}} f_{M}(\\boldsymbol{v})\\,\\mathrm{d}^{3}v\n$$\nfor the provided $f_{M}(\\boldsymbol{v})$. Express your final answer for $I$ as a closed-form analytic expression in terms of $n$, $m$, and $T$. If you report a numerical value, round to four significant figures and express it in the same units as $n$ (number density), but a symbolic expression is preferred.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard exercise in kinetic theory: to state a fundamental conservation law for collision operators and to verify the normalization of the Maxwell-Boltzmann distribution. All terms are standard and well-defined, and the premises are consistent with the principles of statistical mechanics and plasma physics. The calculation required is a standard Gaussian integral. The problem is therefore valid.\n\nThe problem asks for two distinct items: first, the normalization condition for collision operators, and second, the evaluation of a specific velocity-space integral.\n\nPart 1: Normalization Condition for Collision Operators\n\nIn kinetic theory, the evolution of the velocity distribution function $f(\\boldsymbol{r}, \\boldsymbol{v}, t)$ is described by the kinetic equation. For a spatially homogeneous, non-drifting plasma with no external forces, the equation simplifies to\n$$\n\\frac{\\partial f(\\boldsymbol{v}, t)}{\\partial t} \\;=\\; C[f]\n$$\nwhere $C[f]$ is the collision operator, which can be the Boltzmann operator, the Fokker-Planck operator, or another relevant form.\n\nThe number density $n$ is defined as the zeroth moment of the distribution function over velocity space:\n$$\nn \\;=\\; \\int_{\\mathbb{R}^{3}} f(\\boldsymbol{v}, t)\\,\\mathrm{d}^{3}v\n$$\nThe conservation of the total number of particles of the species under consideration implies that the total number density must be constant in time, i.e., $\\frac{\\mathrm{d}n}{\\mathrm{d}t} = 0$. Taking the time derivative of the definition of $n$, and assuming we can interchange differentiation and integration, we find:\n$$\n\\frac{\\mathrm{d}n}{\\mathrm{d}t} \\;=\\; \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\mathbb{R}^{3}} f(\\boldsymbol{v}, t)\\,\\mathrm{d}^{3}v \\;=\\; \\int_{\\mathbb{R}^{3}} \\frac{\\partial f(\\boldsymbol{v}, t)}{\\partial t} \\,\\mathrm{d}^{3}v\n$$\nSubstituting the simplified kinetic equation, we obtain:\n$$\n\\frac{\\mathrm{d}n}{\\mathrm{d}t} \\;=\\; \\int_{\\mathbb{R}^{3}} C[f] \\,\\mathrm{d}^{3}v\n$$\nTherefore, the condition for particle-number conservation by binary collisions is that the integral of the collision operator over all of velocity space must be zero. This is the normalization condition that expresses particle-number conservation.\n$$\n\\int_{\\mathbb{R}^{3}} C[f] \\,\\mathrm{d}^{3}v \\;=\\; 0\n$$\nThis condition holds for both the Boltzmann collision operator and the Fokker-Planck collision operator. They are constructed precisely to conserve particle number (as well as momentum and energy). For the Fokker-Planck operator, which can be written in the form of a divergence in velocity space, $C_{FP}[f] = -\\boldsymbol{\\nabla}_{\\boldsymbol{v}} \\cdot \\boldsymbol{J}_{\\boldsymbol{v}}$, where $\\boldsymbol{J}_{\\boldsymbol{v}}$ is the velocity-space flux, this integral vanishes by application of the divergence theorem, provided the flux $\\boldsymbol{J}_{\\boldsymbol{v}}$ (which depends on $f$ and its derivatives) vanishes sufficiently rapidly as $|\\boldsymbol{v}| \\to \\infty$.\n\nPart 2: Evaluation of the Integral\n\nThe second part of the task is to explicitly evaluate the integral $I$:\n$$\nI \\;\\equiv\\; \\int_{\\mathbb{R}^{3}} f_{M}(\\boldsymbol{v})\\,\\mathrm{d}^{3}v\n$$\nwhere the Maxwellian distribution function $f_{M}(\\boldsymbol{v})$ is given as:\n$$\nf_{M}(\\boldsymbol{v}) \\;=\\; n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right)\n$$\nHere, the temperature $T$ is in units of energy, so the Boltzmann constant $k_B$ is implicitly absorbed.\n\nWe substitute the expression for $f_{M}(\\boldsymbol{v})$ into the integral for $I$:\n$$\nI \\;=\\; \\int_{\\mathbb{R}^{3}} n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right)\\,\\mathrm{d}^{3}v\n$$\nThe terms that do not depend on the integration variable $\\boldsymbol{v}$ can be factored out of the integral:\n$$\nI \\;=\\; n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\int_{\\mathbb{R}^{3}} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right)\\,\\mathrm{d}^{3}v\n$$\nLet us define the constant $\\alpha \\equiv \\frac{m}{2T}$. The integral becomes:\n$$\nI \\;=\\; n \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\int_{\\mathbb{R}^{3}} \\exp(-\\alpha v^{2})\\,\\mathrm{d}^{3}v\n$$\nThe integral portion can be evaluated in Cartesian coordinates. We write $\\mathrm{d}^{3}v = \\mathrm{d}v_x \\mathrm{d}v_y \\mathrm{d}v_z$ and $v^2 = v_x^2 + v_y^2 + v_z^2$. The integral over $\\mathbb{R}^3$ is separable into three identical one-dimensional Gaussian integrals:\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-\\alpha v^{2})\\,\\mathrm{d}^{3}v \\;=\\; \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\exp(-\\alpha (v_x^2 + v_y^2 + v_z^2)) \\,\\mathrm{d}v_x \\mathrm{d}v_y \\mathrm{d}v_z\n$$\n$$\n\\;=\\; \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_x^2) \\,\\mathrm{d}v_x\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_y^2) \\,\\mathrm{d}v_y\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_z^2) \\,\\mathrm{d}v_z\\right)\n$$\nThe value of the definite integral $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x$ is a standard result, given by $\\sqrt{\\frac{\\pi}{a}}$. In our case, the constant is $\\alpha$, so each of the three integrals evaluates to $\\sqrt{\\frac{\\pi}{\\alpha}}$.\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_i^2) \\,\\mathrm{d}v_i \\;=\\; \\sqrt{\\frac{\\pi}{\\alpha}} \\quad \\text{for } i = x, y, z\n$$\nTherefore, the three-dimensional integral is the product of these three results:\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-\\alpha v^{2})\\,\\mathrm{d}^{3}v \\;=\\; \\left(\\sqrt{\\frac{\\pi}{\\alpha}}\\right)^3 \\;=\\; \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}\n$$\nNow, we substitute this result back into the expression for $I$:\n$$\nI \\;=\\; n \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}\n$$\nThe two terms in parentheses are reciprocals, so their product is $1$:\n$$\nI \\;=\\; n \\cdot 1 \\;=\\; n\n$$\nThis calculation confirms that the integral of the Maxwellian distribution $f_M(\\boldsymbol{v})$ over all of velocity space is indeed the number density $n$, which is consistent with the initial definition of $n$ provided in the problem statement. The constant pre-factor in the definition of $f_M(\\boldsymbol{v})$ is precisely the normalization constant required to satisfy this condition. The final answer is requested as a closed-form analytic expression.",
            "answer": "$$\\boxed{n}$$"
        },
        {
            "introduction": "The Fokker-Planck equation elegantly captures the cumulative effect of many small-angle Coulomb collisions, which dominate interactions in a weakly coupled plasma. A key outcome of this formalism is the appearance of the Coulomb logarithm, $\\ln\\Lambda$, a term that encapsulates the physics of long-range interactions and screening. This exercise  moves from abstract theory to a concrete calculation, asking you to estimate the value of $\\ln\\Lambda$ for a realistic astrophysical plasma and assess its sensitivity, thereby revealing why this single parameter is so robust and central to plasma physics.",
            "id": "4229568",
            "problem": "In a weakly coupled, fully ionized, nonrelativistic astrophysical plasma, the small-angle Coulomb collisions that underlie the Fokker-Planck description generate a logarithmic factor known as the Coulomb logarithm. In a kinetic theory treatment, the natural logarithm of the ratio of the largest to smallest effective impact parameters appears after regularizing the otherwise divergent integral over impact parameter. The largest impact parameter is set by electrostatic screening, taken as the electron Debye length $\\,\\lambda_{D}\\,$, and the smallest impact parameter is set by the larger of the classical distance of closest approach for a $90^\\circ$ deflection, $\\,b_{90}\\,$, and the electron thermal de Broglie wavelength $\\,\\lambda_{\\mathrm{dB}}\\,$. Consider electron-electron collisions in a hydrogenic plasma with electron number density $\\,n = 10^{6}\\,\\mathrm{m}^{-3}\\,$ and electron temperature $\\,T = 10^{6}\\,\\mathrm{K}\\,$. \n\nStarting from the following foundational definitions:\n- The electron Debye length $\\,\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n e^{2}}}\\,$.\n- The electron thermal speed $\\,v_{\\mathrm{th}} = \\sqrt{\\frac{2 k_{B} T}{m_{e}}}\\,$.\n- The classical $90^\\circ$ impact parameter $\\,b_{90} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} m_{e} v_{\\mathrm{th}}^{2}}\\,$.\n- The electron thermal de Broglie wavelength $\\,\\lambda_{\\mathrm{dB}} = \\frac{\\hbar}{m_{e} v_{\\mathrm{th}}}\\,$.\n\nUse the physically motivated cutoffs $\\,b_{\\min} = \\max\\!\\left(b_{90}, \\lambda_{\\mathrm{dB}}\\right)\\,$ and $\\,b_{\\max} = \\lambda_{D}\\,$ to evaluate the Coulomb logarithm $\\,\\ln\\Lambda = \\ln\\!\\left(\\frac{b_{\\max}}{b_{\\min}}\\right)\\,$. Express the final result as a dimensionless number rounded to four significant figures. Additionally, in your reasoning, assess which of $\\,b_{90}\\,$ or $\\,\\lambda_{\\mathrm{dB}}\\,$ controls $\\,b_{\\min}\\,$ and explain qualitatively how sensitive $\\,\\ln\\Lambda\\,$ is to modest variations of either cutoff.",
            "solution": "The problem statement is first subjected to a validation procedure.\n\n**Step 1: Extract Givens**\nThe following information is provided in the problem statement:\n- Plasma conditions: weakly coupled, fully ionized, nonrelativistic astrophysical plasma (hydrogenic).\n- Electron number density: $n = 10^{6}\\,\\mathrm{m}^{-3}$\n- Electron temperature: $T = 10^{6}\\,\\mathrm{K}$\n- Electron Debye length definition: $\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n e^{2}}}$\n- Electron thermal speed definition: $v_{\\mathrm{th}} = \\sqrt{\\frac{2 k_{B} T}{m_{e}}}$\n- Classical $90^\\circ$ impact parameter definition: $b_{90} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} m_{e} v_{\\mathrm{th}}^{2}}$\n- Electron thermal de Broglie wavelength definition: $\\lambda_{\\mathrm{dB}} = \\frac{\\hbar}{m_{e} v_{\\mathrm{th}}}$\n- Maximum impact parameter (cutoff): $b_{\\max} = \\lambda_{D}$\n- Minimum impact parameter (cutoff): $b_{\\min} = \\max\\!\\left(b_{90}, \\lambda_{\\mathrm{dB}}\\right)$\n- Coulomb logarithm definition: $\\ln\\Lambda = \\ln\\!\\left(\\frac{b_{\\max}}{b_{\\min}}\\right)$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the validation criteria:\n1.  **Scientifically Grounded:** The problem describes the calculation of the Coulomb logarithm, a fundamental concept in the kinetic theory of plasmas. The given definitions for $\\lambda_D$, $v_{\\mathrm{th}}$, $b_{90}$, and $\\lambda_{\\mathrm{dB}}$ are standard and correct. The physical motivation for the cutoffs $b_{\\max}$ and $b_{\\min}$ is a well-established procedure for regularizing a divergent integral in collision theory.\n2.  **Well-Posed:** All necessary physical constants are known, and all required parameters ($n$, $T$) and functional forms are explicitly provided. The task is clearly defined, leading to a unique numerical answer.\n3.  **Objective:** The problem is phrased in unambiguous, quantitative language, free from subjective assertions.\n4.  **Consistency and Feasibility:** The given parameters $n = 10^{6}\\,\\mathrm{m}^{-3}$ and $T = 10^{6}\\,\\mathrm{K}$ are plausible for astrophysical environments like the solar corona or the warm-hot intergalactic medium. The \"nonrelativistic\" condition must be checked. The electron thermal speed is $v_{\\mathrm{th}} = \\sqrt{2 k_B T / m_e} \\approx \\sqrt{2 (1.38 \\times 10^{-23} \\text{ J/K}) (10^6 \\text{ K}) / (9.11 \\times 10^{-31} \\text{ kg})} \\approx 5.5 \\times 10^6 \\text{ m/s}$. This is approximately $1.8\\%$ of the speed of light $c$, so the nonrelativistic treatment is justified.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. It is scientifically sound, well-posed, and internally consistent. A solution will be provided.\n\nThe task is to evaluate the Coulomb logarithm $\\ln\\Lambda = \\ln(b_{\\max}/b_{\\min})$ for the given plasma parameters. This requires calculating the values of the cutoffs $b_{\\max} = \\lambda_D$ and $b_{\\min} = \\max(b_{90}, \\lambda_{\\mathrm{dB}})$. We will use the following values for the fundamental constants:\n- Permittivity of vacuum, $\\epsilon_{0} \\approx 8.854 \\times 10^{-12}\\,\\mathrm{F \\cdot m^{-1}}$\n- Boltzmann constant, $k_{B} \\approx 1.381 \\times 10^{-23}\\,\\mathrm{J \\cdot K^{-1}}$\n- Elementary charge, $e \\approx 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n- Electron mass, $m_{e} \\approx 9.109 \\times 10^{-31}\\,\\mathrm{kg}$\n- Reduced Planck constant, $\\hbar \\approx 1.055 \\times 10^{-34}\\,\\mathrm{J \\cdot s}$\n\nFirst, we calculate the electron thermal speed, $v_{\\mathrm{th}}$:\n$$v_{\\mathrm{th}} = \\sqrt{\\frac{2 k_{B} T}{m_{e}}} = \\sqrt{\\frac{2 (1.381 \\times 10^{-23}) (10^{6})}{9.109 \\times 10^{-31}}} \\approx 5.506 \\times 10^{6} \\, \\mathrm{m \\cdot s^{-1}}$$\nNow, we can compute the length scales.\n\nThe maximum impact parameter, $b_{\\max}$, is the electron Debye length, $\\lambda_D$:\n$$\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n e^{2}}} = \\sqrt{\\frac{(8.854 \\times 10^{-12}) (1.381 \\times 10^{-23}) (10^{6})}{(10^{6}) (1.602 \\times 10^{-19})^{2}}} \\approx \\sqrt{\\frac{1.222 \\times 10^{-28}}{2.566 \\times 10^{-32}}} \\approx \\sqrt{4762} \\approx 69.01 \\, \\mathrm{m}$$\nSo, $b_{\\max} \\approx 69.01 \\, \\mathrm{m}$.\n\nNext, we evaluate the two potential scales for the minimum impact parameter, $b_{\\min}$.\nThe classical $90^\\circ$ impact parameter, $b_{90}$, can be simplified by substituting $m_{e} v_{\\mathrm{th}}^2 = 2 k_B T$:\n$$b_{90} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} m_{e} v_{\\mathrm{th}}^{2}} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} (2 k_{B} T)} = \\frac{e^2}{8 \\pi \\epsilon_0 k_B T}$$\n$$b_{90} = \\frac{(1.602 \\times 10^{-19})^2}{8 \\pi (8.854 \\times 10^{-12}) (1.381 \\times 10^{-23}) (10^6)} \\approx \\frac{2.566 \\times 10^{-38}}{3.072 \\times 10^{-27}} \\approx 8.356 \\times 10^{-12} \\, \\mathrm{m}$$\n\nThe electron thermal de Broglie wavelength, $\\lambda_{\\mathrm{dB}}$:\n$$\\lambda_{\\mathrm{dB}} = \\frac{\\hbar}{m_{e} v_{\\mathrm{th}}} = \\frac{1.055 \\times 10^{-34}}{(9.109 \\times 10^{-31}) (5.506 \\times 10^{6})} \\approx \\frac{1.055 \\times 10^{-34}}{5.015 \\times 10^{-24}} \\approx 2.104 \\times 10^{-11} \\, \\mathrm{m}$$\n\nNow we determine $b_{\\min}$ by comparing $b_{90}$ and $\\lambda_{\\mathrm{dB}}$:\n$b_{90} \\approx 8.356 \\times 10^{-12}\\,\\mathrm{m}$\n$\\lambda_{\\mathrm{dB}} \\approx 2.104 \\times 10^{-11}\\,\\mathrm{m}$\nSince $2.104 \\times 10^{-11} > 8.356 \\times 10^{-12}$, we have $\\lambda_{\\mathrm{dB}} > b_{90}$.\nTherefore, the minimum impact parameter is controlled by the quantum mechanical scale:\n$$b_{\\min} = \\max(b_{90}, \\lambda_{\\mathrm{dB}}) = \\lambda_{\\mathrm{dB}} \\approx 2.104 \\times 10^{-11} \\, \\mathrm{m}$$\nThis indicates that for collisions at the typical thermal energy, quantum diffraction effects are more important than the classical large-angle scattering picture. This is characteristic of hot, diffuse plasmas. The crossover between the classical and quantum regimes occurs at a temperature $T_c$ where $b_{90} \\approx \\lambda_{\\mathrm{dB}}$, which evaluates to $T_c = m_e c^2 \\alpha^2 / (2 k_B) \\approx 1.57 \\times 10^5\\,\\mathrm{K}$, where $\\alpha$ is the fine-structure constant. Since the given temperature $T = 10^6\\,\\mathrm{K}$ is greater than $T_c$, our finding is consistent with theory.\n\nWe can now calculate the argument of the logarithm, $\\Lambda$:\n$$\\Lambda = \\frac{b_{\\max}}{b_{\\min}} = \\frac{\\lambda_{D}}{\\lambda_{\\mathrm{dB}}} \\approx \\frac{69.01}{2.104 \\times 10^{-11}} \\approx 3.280 \\times 10^{12}$$\nFinally, we compute the Coulomb logarithm, $\\ln\\Lambda$:\n$$\\ln\\Lambda = \\ln(3.280 \\times 10^{12}) \\approx 28.82$$\nRounding to four significant figures gives the value $28.82$.\n\nRegarding the qualitative sensitivity of $\\ln\\Lambda$ to the cutoffs: the use of the logarithm function is key. Let $\\ln\\Lambda = f(\\Lambda) = \\ln(b_{\\max}/b_{\\min})$. A change in either cutoff by a factor $k$ will change $\\Lambda$ by a factor of $k$ or $1/k$. The new value of the logarithm would be $\\ln(k\\Lambda) = \\ln(k) + \\ln(\\Lambda)$ or $\\ln(\\Lambda/k) = \\ln(\\Lambda) - \\ln(k)$. For typical plasmas, $\\Lambda$ is a very large number, and thus $\\ln\\Lambda$ is moderately large (typically $10$ to $30$). A change in $\\Lambda$ by an order of magnitude (a factor of $k=10$) only results in an additive change of $\\ln(10) \\approx 2.3$ to $\\ln\\Lambda$. Given that $\\ln\\Lambda \\approx 28.82$ in this case, such a large uncertainty in the cutoffs would only alter the result by less than $10\\%$. This logarithmic insensitivity makes the Coulomb logarithm a robust parameter, justifying the use of physically-motivated, order-of-magnitude estimates for the impact parameter cutoffs.",
            "answer": "$$\\boxed{28.82}$$"
        },
        {
            "introduction": "While the continuous form of the Landau-Fokker-Planck operator exactly conserves particle number, momentum, and energy, these fundamental physical laws are not automatically preserved when the operator is discretized for computer simulation. This final practice  bridges the critical gap between continuous theory and computational practice. You will derive the discrete conditions for momentum and energy conservation in a finite-volume scheme and explore a powerful numerical technique to enforce these constraints, a vital skill for developing physically faithful simulation codes.",
            "id": "4229587",
            "problem": "Consider the Landau collision operator, which is the Fokker–Planck (FP) collision operator for Coulomb interactions in velocity space. Let $f(\\mathbf{v},t)$ be the single-species distribution function and $\\mathbf{v} \\in \\mathbb{R}^3$ the velocity. The Landau operator $Q_{\\mathrm{L}}[f]$ can be written in divergence form in velocity space as $Q_{\\mathrm{L}}[f] = \\nabla_{\\mathbf{v}} \\cdot \\mathbf{J}[f]$, where $\\mathbf{J}[f]$ is a collision flux that depends bilinearly on $f$ through a symmetric tensor called the Landau tensor. A fundamental property of binary collisions in the Landau operator is the exact conservation of the collision invariants: particle number, momentum, and kinetic energy. In continuous form, for any sufficiently decaying $f$, the invariants satisfy $\\int \\phi(\\mathbf{v}) \\, Q_{\\mathrm{L}}[f](\\mathbf{v}) \\, d^3\\mathbf{v} = 0$ for $\\phi(\\mathbf{v}) \\in \\left\\{ 1, \\mathbf{v}, \\tfrac{1}{2} \\lvert \\mathbf{v} \\rvert^2 \\right\\}$.\n\nYou are asked to explain how to enforce conservation of momentum and energy in a discrete velocity-space finite-volume scheme for the Landau operator and to write the corresponding discrete constraints. Then, you must implement the constraints and test their enforcement numerically on several discrete grids.\n\nStart from the following fundamental base:\n- The Landau operator $Q_{\\mathrm{L}}[f]$ is a divergence in velocity space: $Q_{\\mathrm{L}}[f] = \\nabla_{\\mathbf{v}} \\cdot \\mathbf{J}[f]$.\n- The collision invariants $1$, $\\mathbf{v}$, and $\\tfrac{1}{2}\\lvert \\mathbf{v} \\rvert^2$ are conserved: $\\int \\phi(\\mathbf{v}) \\, Q_{\\mathrm{L}}[f] \\, d^3\\mathbf{v} = 0$ for each invariant $\\phi$.\n- In a finite-volume discretization on a Cartesian velocity grid, the discrete divergence theorem converts cell-wise integrals of $\\nabla_{\\mathbf{v}}\\cdot \\mathbf{J}$ into sums of fluxes across cell faces.\n\nDiscretization model. Consider a Cartesian grid in velocity space with $d \\in \\{1,2,3\\}$ dimensions and shape $(n_1,\\ldots,n_d)$. Let the cell-centered velocities be $\\mathbf{v}_j \\in \\mathbb{R}^d$, where $j$ indexes the cells, and let the set of oriented interior faces (interfaces) be indexed by $e$, each connecting a left cell $L(e)$ and a right cell $R(e)$ along one coordinate direction. Denote by $s_e$ the signed scalar face flux equal to the dot product of the discrete collision flux at face $e$ with the outward normal times the face area. The semi-discrete finite-volume update for the collision term in cell $j$ can be abstracted as\n$$ Q_j \\, \\Delta V_j = \\sum_{e \\in \\mathcal{F}(j)} \\sigma_{j,e} \\, s_e, $$\nwhere $\\Delta V_j$ is the cell volume in velocity space, $\\mathcal{F}(j)$ is the set of faces adjacent to cell $j$, and $\\sigma_{j,e} \\in \\{-1,+1\\}$ gives the orientation of face $e$ relative to cell $j$. This ensures $s_e = - s_{\\bar{e}}$ if $e$ and $\\bar{e}$ are the same geometric face with opposite orientation. Assume vanishing boundary fluxes at the domain boundary (e.g., decay at large $\\lvert \\mathbf{v} \\rvert$).\n\nUsing the discrete divergence theorem, show that conservation of momentum and energy imposes the following linear constraints on the face fluxes $\\{s_e\\}$:\n- Momentum conservation for each component $\\alpha = 1,\\ldots,d$:\n$$ \\sum_{e} \\Delta v_{e,\\alpha} \\, s_e = 0, $$\nwhere $\\Delta v_{e,\\alpha} = v_{R(e),\\alpha} - v_{L(e),\\alpha}$ is the difference of the $\\alpha$-th component of velocity across face $e$.\n- Energy conservation:\n$$ \\sum_{e} \\Delta \\varepsilon_e \\, s_e = 0, \\quad \\text{with} \\quad \\Delta \\varepsilon_e = \\tfrac{1}{2} \\left( \\lvert \\mathbf{v}_{R(e)} \\rvert^2 - \\lvert \\mathbf{v}_{L(e)} \\rvert^2 \\right). $$\n\nConstruct the constraint matrix $C \\in \\mathbb{R}^{(d+1) \\times E}$, where $E$ is the number of interior faces, by stacking the $d$ momentum rows followed by the energy row. The discrete constraints are then $C \\, \\mathbf{s} = \\mathbf{0}$, where $\\mathbf{s} \\in \\mathbb{R}^E$ is the vector of face fluxes.\n\nEnforcement strategy. In practical schemes, a preliminary face flux $\\mathbf{s}^{\\mathrm{raw}}$ (from a chosen discretization of $\\mathbf{J}$) may not satisfy $C\\,\\mathbf{s}^{\\mathrm{raw}}=\\mathbf{0}$ exactly. A minimal correction that enforces the constraints is found by orthogonal projection onto the null space of $C$, namely\n$$ \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{s}^{\\mathrm{raw}} - \\mathbf{P} \\, \\mathbf{s}^{\\mathrm{raw}}, $$\nwhere $\\mathbf{P}$ is the orthogonal projector onto the column space of $C^\\top$. Equivalently, if $C = U \\Sigma V^\\top$ is a singular value decomposition, the projector onto the column space of $C^\\top$ in the face-flux space is $\\mathbf{P} = V_r V_r^\\top$, where $V_r$ collects the right singular vectors associated with nonzero singular values. Then $C \\, \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{0}$ by construction.\n\nImplementation task. Write a complete program that:\n1. Constructs $\\mathbf{v}_j$ and interior faces for each of the following test suites. The velocities must be expressed in $\\mathrm{m/s}$. Use the symmetrically centered Cartesian coordinates $\\mathbf{v}_j = \\left( x_1, \\ldots, x_d \\right)$ with $x_i = \\Delta u_i \\left( k_i - \\tfrac{n_i - 1}{2} \\right)$ for $k_i \\in \\{0,\\ldots,n_i-1\\}$ and prescribed spacings $\\Delta u_i$ in $\\mathrm{m/s}$.\n2. Builds the constraint matrix $C$ from $\\Delta \\mathbf{v}_e$ and $\\Delta \\varepsilon_e$.\n3. Generates a reproducible random raw face-flux vector $\\mathbf{s}^{\\mathrm{raw}}$ for each test case.\n4. Projects $\\mathbf{s}^{\\mathrm{raw}}$ onto $\\mathrm{null}(C)$ to obtain $\\mathbf{s}^{\\mathrm{cons}}$.\n5. Computes the residual $\\lVert C \\, \\mathbf{s}^{\\mathrm{cons}} \\rVert_2$ (unit consistent with the face flux magnitude; report as a dimensionless floating-point number).\n6. Outputs the residuals as specified.\n\nTest suite (each case specifies $(n_1,\\ldots,n_d)$, spacings $(\\Delta u_1,\\ldots,\\Delta u_d)$ in $\\mathrm{m/s}$, and a random seed):\n- Case 1 (general $3\\mathrm{D}$ happy path): $(2,2,2)$, spacings $(1.0\\times 10^5, 1.0\\times 10^5, 1.0\\times 10^5)$, seed $42$.\n- Case 2 ($1\\mathrm{D}$ line, boundary-like): $(3)$, spacing $(5.0\\times 10^4)$, seed $7$.\n- Case 3 (degenerate single cell edge case): $(1,1,1)$, spacings $(1.0\\times 10^5, 1.0\\times 10^5, 1.0\\times 10^5)$, seed $0$.\n- Case 4 ($2\\mathrm{D}$ anisotropic spacing): $(2,3)$, spacings $(1.5\\times 10^5, 0.8\\times 10^5)$, seed $100$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$), where each $\\text{result}$ is the residual $\\lVert C \\, \\mathbf{s}^{\\mathrm{cons}} \\rVert_2$ for the corresponding case, expressed as a floating-point number. Angles do not appear in this problem. No percentages are involved. The output is unitless because it is a norm of a linear constraint applied to a face-flux vector that is internal to the discretization.",
            "solution": "The problem requires us to first derive the discrete conservation laws for momentum and energy for a finite-volume discretization of the Landau collision operator, and then to implement a numerical procedure to enforce these constraints.\n\nFirst, we will derive the discrete conservation constraints. The continuous Landau operator, $Q_{\\mathrm{L}}[f] = \\nabla_{\\mathbf{v}} \\cdot \\mathbf{J}[f]$, conserves a quantity $\\phi(\\mathbf{v})$ if the total amount of this quantity over the entire velocity space does not change due to collisions. This is expressed as $\\int \\phi(\\mathbf{v}) \\, Q_{\\mathrm{L}}[f](\\mathbf{v}) \\, d^3\\mathbf{v} = 0$. Using the divergence theorem and assuming the flux $\\mathbf{J}[f]$ vanishes at infinity, this integral becomes $\\int \\nabla_{\\mathbf{v}} \\cdot (\\phi \\mathbf{J}) \\, d^3\\mathbf{v} - \\int \\mathbf{J} \\cdot \\nabla_{\\mathbf{v}} \\phi \\, d^3\\mathbf{v} = 0$. The first term is zero. Thus, conservation is equivalent to $\\int \\mathbf{J}[f] \\cdot \\nabla_{\\mathbf{v}} \\phi \\, d^3\\mathbf{v} = 0$. The given collision invariants are $\\phi(\\mathbf{v}) \\in \\{1, \\mathbf{v}, \\frac{1}{2}|\\mathbf{v}|^2\\}$.\n\nIn a finite-volume scheme on a Cartesian velocity grid, the computational domain is partitioned into cells indexed by $j$. The discrete equivalent of the total change of the quantity $\\phi$ is the sum over all cells of the change within each cell:\n$$ \\frac{d}{dt} \\sum_j \\phi(\\mathbf{v}_j) n_j = \\sum_j \\phi_j Q_j \\Delta V_j $$\nwhere $\\phi_j = \\phi(\\mathbf{v}_j)$, $Q_j$ is the discrete collision operator in cell $j$, and $\\Delta V_j$ is the cell volume. For conservation, this sum must be zero. The problem states that the semi-discrete update for cell $j$ is given by a sum over its adjacent faces $e \\in \\mathcal{F}(j)$:\n$$ Q_j \\Delta V_j = \\sum_{e \\in \\mathcal{F}(j)} \\sigma_{j,e} \\, s_e $$\nwhere $s_e$ is the scalar flux across face $e$ and $\\sigma_{j,e}$ is a sign factor. Let's adopt a convention where the set of faces $\\{e\\}$ contains a single unique entry for each interior interface, with an orientation defined from a \"left\" cell $L(e)$ to a \"right\" cell $R(e)$. The flux $s_e$ is then defined as positive if it flows from $L(e)$ to $R(e)$. With this, the update for cell $L(e)$ includes a term $-s_e$ (flux leaving), and the update for cell $R(e)$ includes a term $+s_e$ (flux entering).\n\nThe total change is $\\sum_j \\phi_j Q_j \\Delta V_j$. We can reorder this sum over cells into a sum over the unique interior faces. Each face $e$ is shared by two cells, $L(e)$ and $R(e)$. Its contribution to the total sum is:\n$$ \\phi_{L(e)} (\\text{term for } e \\text{ in } Q_{L(e)}\\Delta V_{L(e)}) + \\phi_{R(e)} (\\text{term for } e \\text{ in } Q_{R(e)}\\Delta V_{R(e)}) = \\phi_{L(e)} (-s_e) + \\phi_{R(e)} (+s_e) = s_e (\\phi_{R(e)} - \\phi_{L(e)}) $$\nThis is a discrete form of summation by parts, analogous to the divergence theorem. The assumption of vanishing boundary fluxes ensures that no boundary terms appear. Thus, the discrete conservation law for a quantity $\\phi$ is:\n$$ \\sum_{e} s_e (\\phi_{R(e)} - \\phi_{L(e)}) = 0 $$\nwhere the sum is over all unique interior faces.\n\nNow we apply this general result to the specific invariants.\nParticle number conservation: $\\phi(\\mathbf{v}) = 1$. The condition is $\\sum_e s_e (1 - 1) = 0$, which is always true. This confirms that the divergence form of the operator intrinsically conserves particle number.\n\nMomentum conservation: $\\phi(\\mathbf{v}) = \\mathbf{v}$. This is a vector quantity, so we consider each component $\\phi_\\alpha(\\mathbf{v}) = v_\\alpha$ for $\\alpha = 1, \\ldots, d$. The conservation condition for each component is:\n$$ \\sum_{e} s_e (v_{R(e),\\alpha} - v_{L(e),\\alpha}) = 0 $$\nDefining $\\Delta v_{e,\\alpha} = v_{R(e),\\alpha} - v_{L(e),\\alpha}$, this becomes $\\sum_{e} \\Delta v_{e,\\alpha} s_e = 0$, which is the required momentum constraint.\n\nEnergy conservation: $\\phi(\\mathbf{v}) = \\frac{1}{2} |\\mathbf{v}|^2$. The condition reads:\n$$ \\sum_{e} s_e \\left( \\frac{1}{2} |\\mathbf{v}_{R(e)}|^2 - \\frac{1}{2} |\\mathbf{v}_{L(e)}|^2 \\right) = 0 $$\nDefining $\\Delta \\varepsilon_e = \\frac{1}{2} (|\\mathbf{v}_{R(e)}|^2 - |\\mathbf{v}_{L(e)}|^2)$, this becomes $\\sum_{e} \\Delta \\varepsilon_e s_e = 0$, the required energy constraint.\n\nThese $d+1$ linear constraints on the vector of face fluxes $\\mathbf{s} \\in \\mathbb{R}^E$ can be written in matrix form as $C \\mathbf{s} = \\mathbf{0}$, where $C \\in \\mathbb{R}^{(d+1) \\times E}$ is the constraint matrix. The rows of $C$ are constructed from the coefficients $\\Delta v_{e,\\alpha}$ and $\\Delta \\varepsilon_e$.\n\nSecond, we discuss the enforcement strategy. A numerical scheme might produce a set of raw fluxes $\\mathbf{s}^{\\mathrm{raw}}$ that do not satisfy the constraints, i.e., $C \\mathbf{s}^{\\mathrm{raw}} \\neq \\mathbf{0}$. We need to find a corrected flux vector $\\mathbf{s}^{\\mathrm{cons}}$ that is \"close\" to $\\mathbf{s}^{\\mathrm{raw}}$ and satisfies $C \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{0}$. The vector $\\mathbf{s}^{\\mathrm{cons}}$ must lie in the null space of $C$, denoted $\\mathrm{null}(C)$. The problem of finding the closest vector in a subspace is solved by orthogonal projection.\n\nThe space of fluxes $\\mathbb{R}^E$ can be decomposed into the orthogonal sum of the row space of $C$, denoted $\\mathcal{R}(C^\\top)$, and its null space, $\\mathrm{null}(C)$. Any vector $\\mathbf{s}^{\\mathrm{raw}}$ can be uniquely written as $\\mathbf{s}^{\\mathrm{raw}} = \\mathbf{s}_{\\mathcal{R}} + \\mathbf{s}_{\\mathcal{N}}$, where $\\mathbf{s}_{\\mathcal{R}} \\in \\mathcal{R}(C^\\top)$ and $\\mathbf{s}_{\\mathcal{N}} \\in \\mathrm{null}(C)$. The desired conserved flux is simply the component of $\\mathbf{s}^{\\mathrm{raw}}$ in the null space: $\\mathbf{s}^{\\mathrm{cons}} = \\mathbf{s}_{\\mathcal{N}}$.\n\nTo compute this projection, we use the Singular Value Decomposition (SVD) of the constraint matrix: $C = U \\Sigma V^\\top$. The columns of $V$ form an orthonormal basis for $\\mathbb{R}^E$. If $C$ has rank $r$, the first $r$ columns of $V$ (denoted $V_r$) span $\\mathcal{R}(C^\\top)$, and the remaining $E-r$ columns (denoted $V_n$) span $\\mathrm{null}(C)$.\nThe orthogonal projector onto $\\mathrm{null}(C)$ is $P_{\\mathrm{null}} = V_n V_n^\\top$.\nThus, the conserved flux vector is obtained by projecting the raw flux vector onto the null space:\n$$ \\mathbf{s}^{\\mathrm{cons}} = P_{\\mathrm{null}} \\, \\mathbf{s}^{\\mathrm{raw}} = (V_n V_n^\\top) \\mathbf{s}^{\\mathrm{raw}} $$\nBy construction, $C \\mathbf{s}^{\\mathrm{cons}} = C (V_n V_n^\\top \\mathbf{s}^{\\mathrm{raw}})$. Since the columns of $V_n$ are a basis for $\\mathrm{null}(C)$, we have $C V_n = \\mathbf{0}$. Therefore, $C \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{0}$, and the constraints are satisfied up to machine precision. The program will implement this procedure to construct the matrix $C$ for various grid configurations, generate a random $\\mathbf{s}^{\\mathrm{raw}}$, compute $\\mathbf{s}^{\\mathrm{cons}}$ using SVD, and verify that the residual norm $\\lVert C \\mathbf{s}^{\\mathrm{cons}} \\rVert_2$ is negligible.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Constructs and enforces conservation constraints for a discretized Landau operator.\n\n    For several test cases, this function:\n    1. Sets up a Cartesian velocity grid.\n    2. Identifies all interior cell faces.\n    3. Builds the constraint matrix 'C' for momentum and energy conservation.\n    4. Generates a random raw flux vector 's_raw'.\n    5. Projects 's_raw' onto the null space of 'C' to get a conserved flux 's_cons'.\n    6. Calculates the L2 norm of the residual 'C @ s_cons' to verify constraint satisfaction.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: 3D, (2,2,2) grid, isotropic spacing, seed 42\n        {'shape': (2, 2, 2), 'spacings': (1.0e5, 1.0e5, 1.0e5), 'seed': 42},\n        # Case 2: 1D, (3,) grid, seed 7\n        {'shape': (3,), 'spacings': (5.0e4,), 'seed': 7},\n        # Case 3: 3D, single cell (1,1,1) grid, seed 0\n        {'shape': (1, 1, 1), 'spacings': (1.0e5, 1.0e5, 1.0e5), 'seed': 0},\n        # Case 4: 2D, (2,3) grid, anisotropic spacing, seed 100\n        {'shape': (2, 3), 'spacings': (1.5e5, 0.8e5), 'seed': 100},\n    ]\n\n    results = []\n    for case in test_cases:\n        n_dims = case['shape']\n        spacings = case['spacings']\n        seed = case['seed']\n        d = len(n_dims)\n\n        # 1. Construct cell-centered velocities v_j\n        axis_coords = []\n        for i in range(d):\n            k_i = np.arange(n_dims[i])\n            x_i = spacings[i] * (k_i - (n_dims[i] - 1) / 2.0)\n            axis_coords.append(x_i)\n        \n        grid = np.meshgrid(*axis_coords, indexing='ij')\n        # Each element of grid is a (n1, n2, ...) array for one coordinate\n        # Stack them to get a single (d, n1, n2, ...) array\n        grid_stacked = np.stack(grid, axis=0)\n        # Reshape to (d, N_cells) and transpose to (N_cells, d)\n        velocities = grid_stacked.reshape(d, -1).T\n        num_cells = velocities.shape[0]\n        \n        # Edge case: single cell grids have no interior faces\n        if num_cells <= 1:\n            results.append(0.0)\n            continue\n\n        # 2. Build the list of interior faces\n        faces = []\n        cell_indices_grid = np.arange(num_cells).reshape(n_dims)\n\n        for dim_idx in range(d):\n            # A face exists between cell(k_i) and cell(k_i+1) along dimension i\n            # Create slices to select all \"left\" and \"right\" cells along this dim\n            left_slice = [slice(None)] * d\n            left_slice[dim_idx] = slice(None, -1)\n            \n            right_slice = [slice(None)] * d\n            right_slice[dim_idx] = slice(1, None)\n\n            left_cell_indices = cell_indices_grid[tuple(left_slice)].flatten()\n            right_cell_indices = cell_indices_grid[tuple(right_slice)].flatten()\n\n            for l_idx, r_idx in zip(left_cell_indices, right_cell_indices):\n                faces.append((l_idx, r_idx))\n        \n        num_faces = len(faces)\n\n        # 3. Build the constraint matrix C\n        C = np.zeros((d + 1, num_faces))\n\n        for e, (l_idx, r_idx) in enumerate(faces):\n            v_L = velocities[l_idx]\n            v_R = velocities[r_idx]\n\n            # Momentum constraints (d rows)\n            delta_v = v_R - v_L\n            C[0:d, e] = delta_v\n\n            # Energy constraint (1 row)\n            delta_eps = 0.5 * (np.dot(v_R, v_R) - np.dot(v_L, v_L))\n            C[d, e] = delta_eps\n            \n        # 4. Generate a random raw flux vector s_raw\n        rng = np.random.default_rng(seed)\n        s_raw = rng.random(num_faces)\n\n        # 5. Project s_raw onto the null space of C to get s_cons\n        if num_faces == 0:\n            residual = 0.0\n        else:\n            # U, S, Vh = C.svd()\n            # Vh is the transpose of the matrix of right singular vectors\n            U, S, Vh = scipy.linalg.svd(C, full_matrices=False)\n            \n            # Determine rank by finding non-zero singular values with a tolerance\n            tol = S[0] * max(C.shape) * np.finfo(S.dtype).eps if S.size > 0 else 0\n            rank = np.sum(S > tol)\n\n            # The rows of Vh form an orthonormal basis. The last (E-r) rows\n            # span the null space of C.\n            Vn_T = Vh[rank:] # These rows are an orthonormal basis for null(C)\n\n            # Project s_raw onto the null space.\n            # Projector P_null = Vn @ Vn.T = Vn_T.T @ Vn_T\n            if rank == num_faces: # Null space is trivial\n                 s_cons = np.zeros_like(s_raw)\n            else:\n                 s_cons = Vn_T.T @ (Vn_T @ s_raw)\n\n            # 6. Compute the residual norm ||C @ s_cons||_2\n            residual_vector = C @ s_cons\n            residual = np.linalg.norm(residual_vector)\n            \n        results.append(residual)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}