{
    "hands_on_practices": [
        {
            "introduction": "这项首个练习将引导你在最简化的情形下计算纵向不变量 $J$。通过将磁阱近似为谐振子势，我们可以推导出精确的解析解，并验证一个连接 $J$ 与粒子弹跳周期的基本性质。这个练习旨在为你处理更复杂情况奠定坚实的数学基础。",
            "id": "4226738",
            "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子在天体物理等离子体中沿磁力线进行导心运动，电场可忽略不计，且磁场的空间变化足够缓慢，足以证明绝热不变量的合理性。在磁场极小值点附近（例如，类偶极场的赤道面附近），沿弧长坐标 $s$ 的磁场大小可近似为\n$$\nB(s) = B_0 \\left( 1 + \\alpha s^2 \\right),\n$$\n其中 $B_0  0$ 是最小场强，$\\alpha  0$ 表征了沿磁力线的磁场大小的局部曲率，且 $|s|$ 足够小，以至于 $s$ 的高阶项可以忽略不计。第一绝热不变量（磁矩）$\\mu$ 定义为\n$$\n\\mu = \\frac{mv_{\\perp}^2}{2B},\n$$\n并假定其为常数。总能量 $E$ 守恒，可写为\n$$\nE = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s),\n$$\n其中 $v_{\\parallel}$ 是沿磁力线的速度分量。\n\n使用第二绝热不变量的纵向作用量变量定义，\n$$\nJ = \\oint p_{\\parallel} ds,\n$$\n其中 $p_{\\parallel} = m v_{\\parallel}$，环路积分是在两个磁镜点之间完成一次完整的反弹，请在给定的二次场近似下，推导 $J$ 作为 $E$、$\\mu$、$B_0$、$\\alpha$ 和 $m$ 的函数的显式表达式。从得到的有效一维动力学中，求出此近似下的反弹角频率 $\\omega_b$，并由此得到反弹周期 $T_b$。最后，将你推导出的 $J$ 对 $E$ 求导，并验证关系式\n$$\n\\frac{dJ}{dE} = T_b.\n$$\n\n将最终的反弹周期以秒为单位表示，并给出关于 $m$、$\\mu$、$B_0$ 和 $\\alpha$ 的单个闭式符号表达式。无需进行数值四舍五入。假设 $E  \\mu B_0$，以便粒子在转折点之间反弹。",
            "solution": "首先验证问题，以确保其自洽、科学上合理且提法恰当。\n\n**步骤 1：提取已知条件**\n- 粒子质量：$m$\n- 粒子电荷：$q$\n- 沿弧长 $s$ 的磁场大小：$B(s) = B_0 ( 1 + \\alpha s^2 )$，其中 $B_0  0$ 且 $\\alpha  0$。\n- 第一绝热不变量：$\\mu = \\frac{mv_{\\perp}^2}{2B}$ (常数)。\n- 守恒总能量：$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s)$。\n- 第二绝热不变量定义：$J = \\oint p_{\\parallel} ds$，其中 $p_{\\parallel} = m v_{\\parallel}$。\n- 积分范围为一个完整的反弹周期。\n- 反弹运动的条件：$E  \\mu B_0$。\n- 待验证的关系式：$\\frac{dJ}{dE} = T_b$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了磁镜位形中粒子俘获的标准模型，这是等离子体物理学的基石。在磁场极小值点附近对磁场进行二次近似是分析反弹运动的一种有效且常用的技术，它会导致简谐运动。绝热不变量 $\\mu$ 和 $J$ 以及能量 $E$ 的定义都是标准的。问题提法恰当，提供了计算所需量所需的所有必要信息。语言客观且正式。不存在科学缺陷、矛盾或歧义。\n\n**结论**：问题有效。\n\n**解答推导**\n粒子平行于磁力线的运动由能量守恒定律决定。总能量 $E$ 由下式给出：\n$$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s)$$\n此处，$\\frac{1}{2} m v_{\\parallel}^2$ 是平行运动的动能，而 $U(s) = \\mu B(s)$ 充当有效势能。代入给定的 $B(s)$ 表达式：\n$$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B_0 (1 + \\alpha s^2)$$\n平行动量为 $p_{\\parallel} = m v_{\\parallel}$。我们可以将 $p_{\\parallel}$ 表示为位置 $s$ 的函数：\n$$p_{\\parallel}^2 = (m v_{\\parallel})^2 = 2m(E - \\mu B_0(1 + \\alpha s^2)) = 2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)$$\n所以，动量为：\n$$p_{\\parallel}(s) = \\pm \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)}$$\n粒子被俘获并在两个转折点（或磁镜点）$s = \\pm s_m$ 之间反弹，在这些点其平行速度变为零。这些点可以通过设置 $p_{\\parallel}(s) = 0$ 来找到：\n$$E - \\mu B_0 - \\mu B_0 \\alpha s_m^2 = 0$$\n$$s_m^2 = \\frac{E - \\mu B_0}{\\mu B_0 \\alpha}$$\n转折点位于 $s_m = \\pm \\sqrt{\\frac{E - \\mu B_0}{\\mu B_0 \\alpha}}$。条件 $E  \\mu B_0$ 确保 $s_m^2  0$，因此存在实数转折点。\n\n接下来，我们计算第二绝热不变量 $J$，其定义为：\n$$J = \\oint p_{\\parallel} ds$$\n积分在一个完整的反弹周期内进行，从 $s = -s_m$ 到 $s = s_m$（此时 $p_{\\parallel}  0$），再从 $s = s_m$ 返回到 $s = -s_m$（此时 $p_{\\parallel}  0$）。这可以写成：\n$$J = 2 \\int_{-s_m}^{s_m} \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)} \\, ds$$\n$$J = 2 \\int_{-s_m}^{s_m} \\sqrt{2m\\mu B_0 \\alpha \\left(\\frac{E - \\mu B_0}{\\mu B_0 \\alpha} - s^2\\right)} \\, ds$$\n设 $A^2 = s_m^2 = \\frac{E - \\mu B_0}{\\mu B_0 \\alpha}$。$J$ 的表达式变为：\n$$J = 2 \\sqrt{2m\\mu B_0 \\alpha} \\int_{-A}^{A} \\sqrt{A^2 - s^2} \\, ds$$\n积分 $\\int_{-A}^{A} \\sqrt{A^2 - s^2} \\, ds$ 表示半径为 $A$ 的半圆面积，即 $\\frac{1}{2}\\pi A^2$。\n$$J = 2 \\sqrt{2m\\mu B_0 \\alpha} \\left( \\frac{\\pi A^2}{2} \\right) = \\pi A^2 \\sqrt{2m\\mu B_0 \\alpha}$$\n代入 $A^2$ 的表达式：\n$$J = \\pi \\left( \\frac{E - \\mu B_0}{\\mu B_0 \\alpha} \\right) \\sqrt{2m\\mu B_0 \\alpha} = \\pi (E - \\mu B_0) \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}}$$\n这是 $J$ 的显式表达式。\n\n现在，我们推导反弹频率 $\\omega_b$ 和周期 $T_b$。平行分量的运动方程由牛顿第二定律给出，$F_{\\parallel} = m \\ddot{s}$，其中 $F_{\\parallel}$ 是沿磁力线的力。这个力是有效势 $U(s) = \\mu B(s)$ 的负梯度：\n$$F_{\\parallel} = -\\frac{d}{ds}U(s) = -\\frac{d}{ds} \\left( \\mu B_0 (1 + \\alpha s^2) \\right) = -2\\mu B_0 \\alpha s$$\n运动方程是：\n$$m \\ddot{s} = -2\\mu B_0 \\alpha s \\implies m \\ddot{s} + (2\\mu B_0 \\alpha) s = 0$$\n这是简谐振子的方程，$\\ddot{s} + \\omega_b^2 s = 0$，其角频率 $\\omega_b$ 由下式给出：\n$$\\omega_b^2 = \\frac{2\\mu B_0 \\alpha}{m} \\implies \\omega_b = \\sqrt{\\frac{2\\mu B_0 \\alpha}{m}}$$\n反弹周期 $T_b$ 与角频率的关系为 $T_b = \\frac{2\\pi}{\\omega_b}$：\n$$T_b = 2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\n\n最后，我们验证关系式 $\\frac{dJ}{dE} = T_b$。我们将推导出的 $J$ 的表达式对 $E$ 求导，将 $m$、$\\mu$、$B_0$ 和 $\\alpha$ 视为常数：\n$$J(E) = \\pi (E - \\mu B_0) \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}}$$\n$$\\frac{dJ}{dE} = \\frac{d}{dE} \\left( E \\pi \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}} - \\pi \\mu B_0 \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}} \\right) = \\pi \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}}$$\n从我们的反弹周期表达式，我们有 $T_b = 2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}} = 2\\pi \\frac{\\sqrt{m}}{\\sqrt{2\\mu B_0 \\alpha}} = \\sqrt{2}\\pi\\frac{\\sqrt{m}}{\\sqrt{\\mu B_0 \\alpha}}$.\n我们的导数是 $\\frac{dJ}{dE} = \\pi \\sqrt{2} \\frac{\\sqrt{m}}{\\sqrt{\\mu B_0 \\alpha}}$.\n比较这两个结果，我们看到该关系得到了验证：\n$$\\frac{dJ}{dE} = T_b$$\n题目要求将最终的反弹周期表示为单个闭式符号表达式。这就是我们推导出的 $T_b$ 表达式。",
            "answer": "$$\n\\boxed{2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}}\n$$"
        },
        {
            "introduction": "在掌握了计算 $J$ 的基本方法后 ，我们现在将重点转向概念层面的理解。本练习挑战你思考，当改变粒子的磁矩时，其囚禁区域和 $J$ 的值会如何变化。这对于建立关于粒子在磁镜中行为的物理直觉至关重要。",
            "id": "4226790",
            "problem": "一个质量为 $m$、电荷为 $q$ 的非相对论带电粒子沿着一条磁场线运动，该磁场线的大小 $B(s)$ 随弧长 $s$ 缓慢变化。这种缓慢变化确保了绝热不变量的有效性。第一绝热不变量（磁矩）$\\mu$ 和总能量 $E$ 是守恒的。第二绝热不变量 $J$ 是与粒子沿磁场线在磁镜点之间被捕获并做弹跳运动相关的纵向不变量。\n\n假设 $B(s)$ 是对称的，在 $s=0$ 处有唯一的最小值 $B_{\\min}$，并且随着 $|s|$ 的增大单调增加至 $B_{\\max}$，这在日冕环或行星磁层场线中是典型的情况。考虑 $B_{\\min}  E/\\mu  B_{\\max}$ 的捕获区域，因此在 $s_\\pm$ 处存在磁镜点，且 $s_-  0  s_+$。在总能量 $E$ 固定的情况下，考虑 $J$ 如何依赖于 $\\mu$。\n\n哪个选项正确地描述了在固定 $E$ 时 $J$ 对 $\\mu$ 的依赖关系，并从磁镜势垒和可及构型空间在 $s$ 上的收缩方面给出了物理上一致的解释？\n\nA. 在固定 $E$ 时，$J$ 随着 $\\mu$ 的增加而单调减少；增加 $\\mu$ 会提高等效磁镜势垒，使转折点向内移动到更小的 $|s|$ 处，并收缩允许存在非零平行方向动量的运动区域，从而减小弹跳作用量。\n\nB. 在固定 $E$ 时，$J$ 随着 $\\mu$ 的增加而单调增加；更大的 $\\mu$ 意味着更大的垂直方向动量，这会增加每次弹跳累积的总作用量，从而增加 $J$。\n\nC. 在固定 $E$ 时，$J$ 与 $\\mu$ 无关，因为 $\\mu$ 和 $J$ 都是绝热不变量，因此它们的值不相互参数化。\n\nD. 在捕获区域内，$J$ 对 $\\mu$ 的依赖关系是非单调的；当磁镜点出现时，$J$ 首先随 $\\mu$ 增加，然后随着捕获作用的进一步增强而减少。",
            "solution": "用户希望对问题陈述进行批判性验证，然后进行严格的求解推导，并对所提供的选项进行评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 一个质量为 $m$、电荷为 $q$ 的非相对论带电粒子。\n- 粒子沿着一条磁场线运动。\n- 磁场大小 $B(s)$ 随弧长 $s$ 缓慢变化。\n- 第一绝热不变量（磁矩）$\\mu$ 是守恒的。\n- 总能量 $E$ 是守恒的。\n- 第二绝热不变量 $J$（纵向不变量）与弹跳运动相关。\n- 磁场分布 $B(s)$ 是对称的，在 $s=0$ 处有唯一的最小值 $B_{\\min}$。\n- $B(s)$ 随 $|s|$ 单调增加至一个值 $B_{\\max}$。\n- 粒子处于捕获区域，其中 $B_{\\min}  E/\\mu  B_{\\max}$。\n- 在 $s_\\pm$ 处存在磁镜点，其中 $s_-  0  s_+$。\n- 问题是确定在总能量 $E$ 固定的情况下，$J$ 对 $\\mu$ 的依赖关系。\n\n**步骤2：使用已知条件进行验证**\n- **科学依据：**该问题基于成熟的带电粒子在磁场中运动的绝热不变量理论，这是等离子体物理学、天体物理学（例如，Van Allen belts）和聚变研究（例如，磁镜）中的一个基本概念。该设置是用于阐释这些原理的一个标准的、典型的例子。\n- **适定性：**该问题提供了一个清晰的物理场景，并要求一个特定的函数依赖关系，即在恒定 $E$ 下的 $\\frac{\\partial J}{\\partial \\mu}$。物理量 $E$、$\\mu$ 和 $J$ 都是标准的，磁场 $B(s)$ 的性质也得到了充分的定义，足以得出一个唯一的、有意义的定性解。\n- **客观性：**该问题使用精确、标准的物理学术语陈述，没有歧义或主观性语言。\n\n**缺陷清单：**\n1.  **科学或事实不健全：**无。在导心理论和绝热不变量的框架内，其前提是正确的。\n2.  **不可形式化或不相关：**无。该问题可以直接使用所涉及物理量的定义进行形式化。\n3.  **不完整或矛盾的设置：**无。信息足以确定定性依赖关系。$B(s)$ 的对称性意味着 $s_- = -s_+$。\n4.  **不切实际或不可行：**无。所描述的磁场几何结构是自然等离子体和实验室等离子体（例如，磁偶极子场线）的标准模型。\n5.  **不适定或结构不良：**无。可以从提供的信息中推导出唯一的答案。\n6.  **伪深刻、琐碎或同义反复：**无。该问题需要对不同守恒量之间的关系有扎实的概念和数学理解。\n7.  **超出科学可验证性：**无。该关系可以通过数学推导和验证。\n\n**步骤3：结论与行动**\n问题陈述有效。我将继续进行求解。\n\n### 推导\n\n非相对论粒子的总能量 $E$ 是其平行和垂直于磁场线的动能之和：\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\frac{1}{2}m v_{\\perp}^2$$\n由于 $E$ 是守恒的，它是一个运动常数。\n\n第一绝热不变量，即磁矩 $\\mu$，定义为：\n$$\\mu = \\frac{\\frac{1}{2}m v_{\\perp}^2}{B(s)}$$\n当粒子沿磁场线运动时，$\\mu$ 也是守恒的。我们可以将垂直动能表示为 $\\frac{1}{2}m v_{\\perp}^2 = \\mu B(s)$。\n\n将此代入能量守恒方程，得到平行速度 $v_{\\parallel}$ 的表达式：\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B(s)$$\n$$v_{\\parallel}^2(s) = \\frac{2}{m} (E - \\mu B(s))$$\n粒子被捕获，意味着它在两个磁镜点之间“弹跳”。这些点 $s_-$ 和 $s_+$ 是平行速度变为零的位置，即 $v_{\\parallel} = 0$。这发生在以下情况：\n$$E - \\mu B(s_{\\pm}) = 0 \\implies B(s_{\\pm}) = \\frac{E}{\\mu}$$\n由于磁场 $B(s)$ 在 $s=0$ 处有最小值，并随 $|s|$ 单调增加，所以磁镜点是对称分布的，即 $s_- = -s_+$。\n\n第二绝热不变量，即纵向不变量 $J$，是一个完整弹跳周期内的作用量积分。它定义为 $J = \\oint p_{\\parallel} ds$，其中 $p_{\\parallel} = m v_{\\parallel}$ 是平行动量。粒子以正 $p_{\\parallel}$ 从 $s_-$ 运动到 $s_+$，再以负 $p_{\\parallel}$ 从 $s_+$ 返回到 $s_-$。该积分变为：\n$$J = \\int_{s_-}^{s_+} m v_{\\parallel}(s) ds + \\int_{s_+}^{s_-} (-m v_{\\parallel}(s)) ds = 2 \\int_{s_-}^{s_+} m v_{\\parallel}(s) ds$$\n代入 $v_{\\parallel}(s) = \\sqrt{\\frac{2}{m}(E - \\mu B(s))}$ 的表达式：\n$$J(\\mu, E) = 2 \\int_{s_-}^{s_+} m \\sqrt{\\frac{2}{m}(E - \\mu B(s))} ds$$\n$$J(\\mu, E) = \\sqrt{8m} \\int_{s_-}^{s_+} \\sqrt{E - \\mu B(s)} ds$$\n问题要求在固定能量 $E$ 下 $J$ 对 $\\mu$ 的依赖关系。我们需要计算偏导数 $\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E$。我们使用莱布尼茨法则来对积分进行微分，因为积分的上下限和被积函数都依赖于微分变量 $\\mu$：\n$$\\frac{\\partial J}{\\partial \\mu} = \\sqrt{8m} \\left[ \\int_{s_-}^{s_+} \\frac{\\partial}{\\partial \\mu}\\left(\\sqrt{E - \\mu B(s)}\\right) ds + \\sqrt{E - \\mu B(s_+)} \\frac{\\partial s_+}{\\partial \\mu} - \\sqrt{E - \\mu B(s_-)} \\frac{\\partial s_-}{\\partial \\mu} \\right]$$\n在磁镜点 $s_{\\pm}$ 处，我们有 $E - \\mu B(s_{\\pm}) = 0$。因此，边界项（方括号中的第二项和第三项）为零。导数简化为：\n$$\\frac{\\partial J}{\\partial \\mu} = \\sqrt{8m} \\int_{s_-}^{s_+} \\frac{\\partial}{\\partial \\mu}\\left(\\sqrt{E - \\mu B(s)}\\right) ds$$\n被积函数的偏导数为：\n$$\\frac{\\partial}{\\partial \\mu}\\left(\\sqrt{E - \\mu B(s)}\\right) = \\frac{1}{2\\sqrt{E - \\mu B(s)}}(-B(s)) = -\\frac{B(s)}{2\\sqrt{E - \\mu B(s)}}$$\n将此代回 $\\frac{\\partial J}{\\partial \\mu}$ 的表达式：\n$$\\frac{\\partial J}{\\partial \\mu} = \\sqrt{8m} \\int_{s_-}^{s_+} \\left(-\\frac{B(s)}{2\\sqrt{E - \\mu B(s)}}\\right) ds = -\\sqrt{2m} \\int_{s_-}^{s_+} \\frac{B(s)}{\\sqrt{E - \\mu B(s)}} ds$$\n对于一个被捕获的粒子，积分区间 $(s_-, s_+)$ 的长度非零。在此区间内，$E - \\mu B(s)  0$，所以平方根是实数且为正。磁场大小 $B(s)$ 也是正的。因此，被积函数 $\\frac{B(s)}{\\sqrt{E - \\mu B(s)}}$ 在开区间 $(s_-, s_+)$ 内处处严格为正。一个正函数在正区间上的积分是正的。\n因此，$\\frac{\\partial J}{\\partial \\mu}$ 是一个负常数 ($-\\sqrt{2m}$) 与一个正积分的乘积。这意味着：\n$$\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E  0$$\n这证明了在总能量 $E$ 固定的情况下，纵向不变量 $J$ 是磁矩 $\\mu$ 的单调递减函数。\n\n**物理解释：**\n1.  **等效势：**沿场线的运动由 $E = \\frac{1}{2}m v_{\\parallel}^2 + U_{eff}(s)$ 控制，其中 $U_{eff}(s) = \\mu B(s)$ 是一个等效势。\n2.  **磁镜点：**粒子被捕获在由 $U_{eff}(s)$ 定义的势阱中。转折点（磁镜点）$s_{\\pm}$ 是平行方向动能为零的地方，即 $E = U_{eff}(s_{\\pm}) = \\mu B(s_{\\pm})$。\n3.  **增加 $\\mu$ 的效应：**对于固定的能量 $E$，增加 $\\mu$ 会抬高整个等效势的“基底”$U_{eff}(s)$。为了满足转折点条件 $B(s_{\\pm}) = E/\\mu$，磁镜点必须移动到磁场值更小的位置。由于 $B(s)$ 在 $s=0$ 处有最小值并随 $|s|$ 增加，更小的 $B$ 意味着更小的 $|s|$。磁镜点向内移动，朝向 $s=0$。\n4.  **对 $J$ 的影响：**纵向不变量 $J$ 代表了弹跳轨道在 $(s, p_{\\parallel})$ 相空间中所包围的面积。随着 $\\mu$ 的增加：\n    - 位置空间中的运动范围 $[s_-, s_+]$ 收缩。\n    - 在捕获区域内的任何给定位置 $s$，平行方向动量 $p_{\\parallel}(s) = \\sqrt{2m(E - \\mu B(s))}$ 会减小，因为 $\\mu B(s)$ 增加了。\n    相空间轨道的宽度 ($s_+ - s_-$) 和高度（$p_{\\parallel}$ 的大小）都减小了。因此，所包围的面积 $J$ 必然减小。\n\n### 逐项分析\n\n**A. 在固定 E 时，J 随着 μ 的增加而单调减少；增加 μ 会提高等效磁镜势垒，使转折点向内移动到更小的 |s| 处，并收缩允许存在非零平行方向动量的运动区域，从而减小弹跳作用量。**\n- `$J$ 随着 $\\mu$ 的增加而单调减少`：这与我们的数学结果 $\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E  0$ 相符。\n- `增加 μ 会提高等效磁镜势垒`：这正确地指出了等效势 $U_{eff}(s) = \\mu B(s)$ 随 $\\mu$ 增加而增加。\n- `使转折点向内移动到更小的 |s| 处`：这是抬高有效势垒基底的正确结果，如物理解释中所述。\n- `收缩允许存在非零平行方向动量的运动区域`：这正确地描述了捕获区域 $[s_-, s_+]$ 的变窄。\n- `从而减小弹跳作用量`：这正确地总结了综合效应导致 $J$ 的减小。\n此选项提供了一个完整且物理上一致的解释。\n**结论：正确。**\n\n**B. 在固定 E 时，J 随着 μ 的增加而单调增加；更大的 μ 意味着更大的垂直方向动量，这会增加每次弹跳累积的总作用量，从而增加 J。**\n- `$J$ 随着 $\\mu$ 的增加而单调增加`：这与数学推导相矛盾。所提供的推理是错误的；它混淆了原因（更大的 μ）与对*纵向*作用量 J 的影响。虽然垂直能量更大，但平行能量和运动范围更小，而这才是决定 J 的因素。\n**结论：错误。**\n\n**C. 在固定 E 时，J 与 μ 无关，因为 μ 和 J 都是绝热不变量，因此它们的值不相互参数化。**\n- `$J$ 与 $\\mu$ 无关`：这与数学推导相矛盾。这个推理从根本上误解了绝热不变量的性质。虽然对于*给定的随时间演化的轨道*，μ 和 J 是运动常数，但它们是定义一族可能轨道的参数。一条轨道 J 的值是系统参数和其他守恒量（即 $J = J(E, \\mu)$）的函数。在这个参数意义上，它们不是独立的。\n**结论：错误。**\n\n**D. 在捕获区域内，J 对 μ 的依赖关系是非单调的；当磁镜点出现时，J 首先随 μ 增加，然后随着捕获作用的进一步增强而减少。**\n- 依赖关系是非单调的：这与数学证明相矛盾，该证明表明在捕获区域内（$B_{\\min}  E/\\mu  B_{\\max}$）的所有 μ 值，导数 $\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E$ 都严格为负。增加 μ 的效果始终是收缩相空间面积 J。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "超越了简化的模型，这最后一个练习将理论带入了现实的天体物理情景中。你将编写一个程序，数值计算在地球偶极磁场中运动的粒子的纵向不变量 $J$。这项任务模拟了空间等离子体物理学家的日常研究工作，将理论知识与计算技能结合起来解决实际问题。",
            "id": "4226798",
            "problem": "考虑一个质量为 $m$、动能为 $E$ 的非相对论性带电粒子，在轴对称偶极磁场中运动。该磁场变化缓慢，因此导心理论适用。利用总动能守恒和第一绝热不变量（磁矩）守恒来确定磁镜纬度，并计算反弹运动的第二绝热不变量（纵向不变量）。\n\n假设磁场是理想偶极子。沿一条由壳参数 $L$ 参数化的给定偶极磁力线，其方程为 $r = L R_p \\cos^2 \\lambda$，其中 $r$ 是径向距离，$R_p$ 是行星半径，$\\lambda$ 是从磁赤道（赤道处 $\\lambda = 0$）测量的磁纬。沿这条磁力线的磁场强度为\n$$\nB(\\lambda) = B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda},\n$$\n其中，在该 $L$ 壳层上的赤道磁场强度为 $B_{eq}(L) = B_0 L^{-3}$，$B_0$ 是赤道表面磁场强度。沿磁力线的微分弧长为\n$$\n\\frac{ds}{d\\lambda} = L R_p \\cos \\lambda \\,\\sqrt{1 + 3 \\sin^2 \\lambda}.\n$$\n\n粒子的赤道投掷角为 $\\alpha_{eq}$，定义为 $\\tan \\alpha_{eq} = v_{\\perp}(0)/v_{\\parallel}(0)$，其中 $v_{\\perp}(0)$ 和 $v_{\\parallel}(0)$ 是在磁赤道处速度的垂直和平行分量。在静磁场中的导心近似下，总动能和磁矩守恒：\n$$\nE = \\tfrac{1}{2} m v^2 = \\text{constant}, \\quad \\mu = \\frac{m v_{\\perp}^2}{2 B} = \\text{constant}.\n$$\n\n根据磁镜条件，磁镜纬度 $\\lambda_m$ 满足\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B(\\lambda_m)},\n$$\n这在给定 $\\alpha_{eq}$ 的情况下确定了 $\\lambda_m$。\n\n反弹运动的第二绝热不变量（纵向不变量）定义为两个磁镜点之间平行正则动量的线积分，\n$$\nJ = \\oint p_{\\parallel} \\, ds,\n$$\n其中，对于非相对论性粒子，$p_{\\parallel} = m v_{\\parallel}$，积分路径是沿磁力线从一个磁镜点到另一个。利用关于磁赤道的对称性，该积分可以写为从赤道到北磁镜点积分的两倍。\n\n您的任务是编写一个程序，该程序：\n- 对于每个指定的测试案例，根据磁镜条件数值求解磁镜纬度 $\\lambda_m$（以度为单位）。\n- 利用 $E$ 和 $\\mu$ 的守恒，用 $\\alpha_{eq}$、$E$、$m$、$B(\\lambda)$ 和 $B_{eq}(L)$ 表示 $v_{\\parallel}(\\lambda)$，并通过沿磁力线从赤道积分到 $\\lambda_m$ 并乘以 $2$（以考虑两个半球）来数值计算纵向不变量 $J$。\n\n常数和单位：\n- 全程使用国际单位制（SI）。取行星半径 $R_p = 6.371 \\times 10^6\\ \\mathrm{m}$，赤道表面磁场强度 $B_0 = 3.12 \\times 10^{-5}\\ \\mathrm{T}$，质子质量 $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$，元电荷 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n- 将粒子视为质量为 $m = m_p$ 的质子。\n- 测试套件中输入的动能 $E$ 以千电子伏（$\\mathrm{keV}$）为单位，因此请使用 $E\\ [\\mathrm{J}] = E\\ [\\mathrm{keV}] \\times 10^3 \\times e$ 将 $E$ 从 $\\mathrm{keV}$ 转换为 $\\mathrm{J}$。\n- 在测试套件中和报告磁镜纬度 $\\lambda_m$ 时使用度为单位；您的程序内部可以使用弧度。\n- 最终的纵向不变量 $J$ 以 $\\mathrm{kg\\ m^2\\ s^{-1}}$ 为单位表示。\n\n测试套件：\n- 案例 1：$E = 10\\ \\mathrm{keV}$，$\\alpha_{eq} = 60^\\circ$，$L = 4$。\n- 案例 2：$E = 1\\ \\mathrm{keV}$，$\\alpha_{eq} = 85^\\circ$，$L = 6$。\n- 案例 3：$E = 100\\ \\mathrm{keV}$，$\\alpha_{eq} = 30^\\circ$，$L = 3$。\n- 案例 4：$E = 50\\ \\mathrm{keV}$，$\\alpha_{eq} = 5^\\circ$，$L = 5$。\n- 案例 5：$E = 20\\ \\mathrm{keV}$，$\\alpha_{eq} = 75^\\circ$，$L = 8$。\n\n您的程序应生成单行输出，其中包含一个用逗号分隔并用方括号括起来的结果列表，格式如下：\n$$\n\\big[\\,[\\lambda_{m,1}, J_1],\\,[\\lambda_{m,2}, J_2],\\,\\dots\\,\\big],\n$$\n其中每个 $\\lambda_{m,i}$ 是磁镜纬度（以度为单位），每个 $J_i$ 是为相应测试案例计算的纵向不变量（以 $\\mathrm{kg\\ m^2\\ s^{-1}}$ 为单位）。",
            "solution": "问题陈述经评估有效。这是一个来自天体物理等离子体物理学领域的适定、有科学依据的问题。它内容自洽，为获得唯一且有意义的解提供了所有必要的物理原理、方程和常数。该任务要求在偶极磁场中应用导心理论和绝热不变量的标准概念，这是该学科的一个基础课题。\n\n求解过程主要分两个阶段：首先，通过解一个超越方程来确定磁镜纬度 $\\lambda_m$；其次，通过计算一个定积分来评估第二绝热不变量 $J$。\n\n**第一部分：确定磁镜纬度 $\\lambda_m$**\n\n带电粒子在会聚磁场中的轨迹以一个“磁镜点”为特征，在该点，其平行于磁场的速度分量 $v_{\\parallel}$ 变为零，粒子被反射。这种现象是由于第一绝热不变量（磁矩） $\\mu = \\frac{m v_{\\perp}^2}{2B}$ 和总动能 $E = \\frac{1}{2}mv^2$ 的守恒而发生的。\n\n在纬度 $\\lambda_m$ 处发生磁镜反射的条件由赤道投掷角 $\\alpha_{eq}$ 与赤道处磁场强度 $B_{eq}(L)$ 和磁镜点处磁场强度 $B(\\lambda_m)$ 之间的关系给出：\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B(\\lambda_m)}\n$$\n问题给出了沿偶极磁力线的磁场强度作为磁纬 $\\lambda$ 的函数表达式：\n$$\nB(\\lambda) = B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda}\n$$\n通过将其代入磁镜条件，我们得到一个仅含 $\\lambda_m$ 和已知 $\\alpha_{eq}$ 的方程：\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda_m}}{\\cos^6 \\lambda_m}} = \\frac{\\cos^6 \\lambda_m}{\\sqrt{1 + 3 \\sin^2 \\lambda_m}}\n$$\n这是一个关于 $\\lambda_m$ 的超越方程。为了便于数值求解，我们定义一个函数 $f(\\lambda)$，其根对应于 $\\lambda_m$：\n$$\nf(\\lambda) = \\frac{\\cos^6 \\lambda}{\\sqrt{1 + 3 \\sin^2 \\lambda}} - \\sin^2 \\alpha_{eq} = 0\n$$\n解 $\\lambda_m$ 位于区间 $[0, \\pi/2]$ 弧度内。使用数值求根算法，如 Brent-Dekker 方法，适合于找到满足此方程的 $\\lambda_m$ 值。\n\n**第二部分：评估第二绝热不变量 $J$**\n\n第二绝热不变量，或称纵向不变量 $J$，与粒子在其两个磁镜点之间的周期性“反弹”运动相关。它被定义为在一个完整反弹周期内平行方向动量 $p_{\\parallel} = m v_{\\parallel}$ 的线积分：\n$$\nJ = \\oint p_{\\parallel} \\, ds\n$$\n积分路径沿磁力线。由于偶极场相对于磁赤道的对称性，一个完整反弹（从 $-\\lambda_m$ 到 $+\\lambda_m$）的积分是从赤道（$\\lambda=0$）到一个磁镜点（$\\lambda_m$）积分的两倍：\n$$\nJ = 2 \\int_{0}^{\\lambda_m} m v_{\\parallel}(\\lambda) \\, ds\n$$\n该积分必须表示为以纬度 $\\lambda$ 为积分变量的形式。微分弧长 $ds$ 由下式给出：\n$$\nds = L R_p \\cos \\lambda \\,\\sqrt{1 + 3 \\sin^2 \\lambda} \\, d\\lambda\n$$\n平行速度 $v_{\\parallel}(\\lambda)$ 由能量和磁矩守恒确定。由于总能量 $E$ 守恒，粒子的速率 $v = \\sqrt{2E/m}$ 是恒定的。速度分量满足 $v^2 = v_{\\parallel}^2 + v_{\\perp}^2$。$\\mu$ 的守恒意味着 $\\frac{v_{\\perp}(\\lambda)^2}{B(\\lambda)} = \\frac{v_{\\perp}(0)^2}{B_{eq}(L)}$，其中 $v_{\\perp}(0) = v \\sin \\alpha_{eq}$ 是赤道处的垂直速度。这得到：\n$$\nv_{\\perp}(\\lambda)^2 = v^2 \\sin^2 \\alpha_{eq} \\frac{B(\\lambda)}{B_{eq}(L)}\n$$\n因此，平行速度的平方为：\n$$\nv_{\\parallel}(\\lambda)^2 = v^2 - v_{\\perp}(\\lambda)^2 = v^2 \\left( 1 - \\sin^2 \\alpha_{eq} \\frac{B(\\lambda)}{B_{eq}(L)} \\right)\n$$\n对远离赤道方向的速度分量取平方根：\n$$\nv_{\\parallel}(\\lambda) = v \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}}\n$$\n将所有分量代入 $J$ 的积分中：\n$$\nJ = 2 \\int_{0}^{\\lambda_m} m \\left( \\sqrt{\\frac{2E}{m}} \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}} \\right) \\left( L R_p \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\right) d\\lambda\n$$\n此表达式简化为：\n$$\nJ = 2 \\sqrt{2mE} \\, L R_p \\int_{0}^{\\lambda_m} \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}} \\, \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\, d\\lambda\n$$\n通过代入比率 $B(\\lambda)/B_{eq}(L)$ 的公式，我们得到被积函数的最终形式：\n$$\nJ = 2 \\sqrt{2mE} \\, L R_p \\int_{0}^{\\lambda_m} \\sqrt{1 - \\left( \\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda} \\right) \\sin^2 \\alpha_{eq}} \\, \\left( \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\right) \\, d\\lambda\n$$\n这个定积分没有闭式解析解，必须使用合适的求积算法进行数值计算。\n\n**计算流程**\n\n每个测试案例的总体流程如下：\n$1$. 将输入参数（$E$ 从 $\\mathrm{keV}$ 转换为焦耳，$\\alpha_{eq}$ 从度转换为弧度）转换为国际单位制（SI）单位。\n$2$. 使用给定的物理常数：$R_p = 6.371 \\times 10^6\\ \\mathrm{m}$，$m = m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$ 和 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n$3$. 使用求根方法对方程 $f(\\lambda)=0$ 进行数值求解，得到磁镜纬度 $\\lambda_m$（以弧度为单位）。\n$4$. 对 $J$ 的积分从 $\\lambda=0$ 到已确定的 $\\lambda_m$ 进行数值计算。\n$5$. 整理最终结果，将 $\\lambda_m$ 转换回度以供输出，并按指定格式呈现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize, integrate\n\ndef solve():\n    \"\"\"\n    Computes the mirror latitude and second adiabatic invariant for a proton\n    in a dipole magnetic field for a given set of test cases.\n    \"\"\"\n    # Define physical constants in SI units.\n    R_p = 6.371e6  # Planetary radius (m)\n    B_0 = 3.12e-5  # Equatorial surface field magnitude (T)\n    m_p = 1.67262192369e-27  # Proton mass (kg)\n    e = 1.602176634e-19  # Elementary charge (C)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E in keV, alpha_eq in degrees, L-shell)\n        (10.0, 60.0, 4.0),\n        (1.0, 85.0, 6.0),\n        (100.0, 30.0, 3.0),\n        (50.0, 5.0, 5.0),\n        (20.0, 75.0, 8.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_kev, alpha_eq_deg, L = case\n\n        # --- Convert inputs to SI units ---\n        E_joule = E_kev * 1000.0 * e\n        alpha_eq_rad = np.deg2rad(alpha_eq_deg)\n\n        # --- Step 1: Solve for the mirror latitude lambda_m ---\n\n        # Define the function whose root is lambda_m.\n        # f(lam) = cos^6(lam) / sqrt(1 + 3sin^2(lam)) - sin^2(alpha_eq)\n        def lambda_m_func(lam, alpha_rad):\n            sin_lam = np.sin(lam)\n            cos_lam = np.cos(lam)\n            # To avoid division by zero at lam=pi/2, although brentq should not hit it\n            if np.isclose(cos_lam, 0.0):\n                 return -np.sin(alpha_rad)**2\n            term1 = cos_lam**6 / np.sqrt(1.0 + 3.0 * sin_lam**2)\n            term2 = np.sin(alpha_rad)**2\n            return term1 - term2\n\n        # Use Brent's method to find the root in the interval [0, pi/2].\n        # The function value is > 0 at lam=0 and  0 at lam=pi/2,\n        # so a root is guaranteed.\n        try:\n            lambda_m_rad = optimize.brentq(\n                lambda_m_func, 0, np.pi / 2, args=(alpha_eq_rad,)\n            )\n        except ValueError:\n            # This should not happen for the given range of alpha_eq\n            results.append([np.nan, np.nan])\n            continue\n            \n        lambda_m_deg = np.rad2deg(lambda_m_rad)\n\n        # --- Step 2: Evaluate the longitudinal invariant J ---\n        \n        # If alpha_eq = 90 deg, particle mirrors at equator, lambda_m = 0, J = 0.\n        if np.isclose(alpha_eq_deg, 90.0):\n            results.append([0.0, 0.0])\n            continue\n\n        # Define the integrand for the integral part of J.\n        # Integrand = sqrt(1 - (B(lam)/B_eq)*sin^2(alpha_eq)) * (ds/dlam)\n        # where ds/dlam_term = cos(lam) * sqrt(1 + 3sin^2(lam))\n        sin2_alpha_eq = np.sin(alpha_eq_rad)**2\n        def j_integrand(lam):\n            sin_lam = np.sin(lam)\n            cos_lam = np.cos(lam)\n            \n            # The term inside this sqrt approaches 0 as lam -> lambda_m.\n            # It can be numerically unstable if lam slightly exceeds lambda_m\n            # due to integrator step choices. We protect against this.\n            B_ratio = np.sqrt(1.0 + 3.0 * sin_lam**2) / (cos_lam**6)\n            inner_sqrt_term = 1.0 - B_ratio * sin2_alpha_eq\n            if inner_sqrt_term  0: inner_sqrt_term = 0.0\n            \n            sqrt_v_parallel = np.sqrt(inner_sqrt_term)\n            \n            ds_dlam_term = cos_lam * np.sqrt(1.0 + 3.0 * sin_lam**2)\n            \n            return sqrt_v_parallel * ds_dlam_term\n\n        # Numerically integrate from 0 to lambda_m_rad.\n        # quad returns (integral_value, error_estimate). We need the first element.\n        integral_val, _ = integrate.quad(j_integrand, 0, lambda_m_rad, epsabs=1e-12, epsrel=1e-12)\n        \n        # Calculate J using the full formula.\n        prefactor = 2.0 * np.sqrt(2.0 * m_p * E_joule) * L * R_p\n        J = prefactor * integral_val\n\n        results.append([lambda_m_deg, J])\n\n    # Format the final output string as requested.\n    output_str = '[' + ','.join([f'[{res[0]:.15g},{res[1]:.15g}]' for res in results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}