{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of the longitudinal invariant $J$, we begin with a foundational calculation in an idealized magnetic trap. This exercise  models the magnetic field near its minimum as a simple quadratic well, an approximation that allows for an exact analytical solution. By working through this problem, you will not only derive an explicit expression for $J$ but also uncover the fundamental relationship between this adiabatic invariant and the bounce period of the trapped particle, a key concept in Hamiltonian mechanics.",
            "id": "4226738",
            "problem": "A charged particle of mass $m$ and charge $q$ executes guiding-center motion along a magnetic field line in an astrophysical plasma, with negligible electric field and sufficiently slow spatial variation of the magnetic field to justify the adiabatic invariants. In the vicinity of a magnetic minimum (e.g., near the equatorial plane of a dipole-like field), approximate the magnetic field magnitude along the arc length coordinate $s$ by\n$$\nB(s) = B_0 \\left( 1 + \\alpha s^2 \\right),\n$$\nwhere $B_0 > 0$ is the minimum field strength, $\\alpha > 0$ characterizes the local curvature of the magnetic field magnitude along the field line, and $|s|$ is small enough that higher-order terms in $s$ are negligible. The first adiabatic invariant (magnetic moment) $\\mu$ is defined by\n$$\n\\mu = \\frac{m v_{\\perp}^2}{2 B},\n$$\nand is assumed constant. The total energy $E$ is conserved and can be written as\n$$\nE = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s),\n$$\nwhere $v_{\\parallel}$ is the velocity component along the field line.\n\nUsing the longitudinal action variable definition for the second adiabatic invariant,\n$$\nJ = \\oint p_{\\parallel}\\, ds,\n$$\nwith $p_{\\parallel} = m v_{\\parallel}$ and the loop integral taken over one complete bounce between the two mirror points, derive the explicit expression for $J$ as a function of $E$, $\\mu$, $B_0$, $\\alpha$, and $m$ under the given quadratic-field approximation. From the resulting effective one-dimensional dynamics, obtain the bounce angular frequency $\\omega_b$ and hence the bounce period $T_b \\approx \\frac{2\\pi}{\\omega_b}$ in this approximation. Finally, differentiate your derived $J$ with respect to $E$ and verify the relation\n$$\n\\frac{dJ}{dE} = T_b.\n$$\n\nExpress the final bounce period in seconds and give your answer as a single closed-form symbolic expression in terms of $m$, $\\mu$, $B_0$, and $\\alpha$. No numerical rounding is required. Assume $E > \\mu B_0$ so that the particle bounces between turning points.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically sound, and well-posed.\n\n**Step 1: Extract Givens**\n- Particle mass: $m$\n- Particle charge: $q$\n- Magnetic field magnitude along arc length $s$: $B(s) = B_0 ( 1 + \\alpha s^2 )$ with $B_0 > 0$ and $\\alpha > 0$.\n- First adiabatic invariant: $\\mu = \\frac{m v_{\\perp}^2}{2 B}$ (constant).\n- Conserved total energy: $E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s)$.\n- Second adiabatic invariant definition: $J = \\oint p_{\\parallel}\\, ds$, with $p_{\\parallel} = m v_{\\parallel}$.\n- The integral is over one complete bounce cycle.\n- Condition for bouncing motion: $E > \\mu B_0$.\n- Relation to verify: $\\frac{dJ}{dE} = T_b$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing the standard model of particle trapping in a magnetic mirror configuration, a cornerstone of plasma physics. The quadratic approximation of the magnetic field near its minimum is a valid and common technique for analyzing the bounce motion, leading to simple harmonic motion. The definitions for the adiabatic invariants $\\mu$ and $J$, and the energy $E$, are standard. The problem is well-posed, providing all necessary information to calculate the required quantities. The language is objective and formal. No scientific flaws, contradictions, or ambiguities are present.\n\n**Verdict**: The problem is valid.\n\n**Solution Derivation**\nThe motion of the particle parallel to the magnetic field line is governed by the conservation of energy. The total energy $E$ is given by:\n$$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s)$$\nHere, $\\frac{1}{2} m v_{\\parallel}^2$ is the kinetic energy of parallel motion, and $U(s) = \\mu B(s)$ acts as an effective potential energy. Substituting the given expression for $B(s)$:\n$$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B_0 (1 + \\alpha s^2)$$\nThe parallel momentum is $p_{\\parallel} = m v_{\\parallel}$. We can express $p_{\\parallel}$ as a function of the position $s$:\n$$p_{\\parallel}^2 = (m v_{\\parallel})^2 = 2m(E - \\mu B_0(1 + \\alpha s^2)) = 2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)$$\nSo, the momentum is:\n$$p_{\\parallel}(s) = \\pm \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)}$$\nThe particle is trapped and bounces between two turning points, or mirror points, $s = \\pm s_m$, where its parallel velocity becomes zero. These points are found by setting $p_{\\parallel}(s) = 0$:\n$$E - \\mu B_0 - \\mu B_0 \\alpha s_m^2 = 0$$\n$$s_m^2 = \\frac{E - \\mu B_0}{\\mu B_0 \\alpha}$$\nThe turning points are at $s_m = \\pm \\sqrt{\\frac{E - \\mu B_0}{\\mu B_0 \\alpha}}$. The condition $E > \\mu B_0$ ensures that $s_m^2 > 0$, so real turning points exist.\n\nNext, we calculate the second adiabatic invariant, $J$, defined as:\n$$J = \\oint p_{\\parallel}\\, ds$$\nThe integral is taken over one full bounce cycle. This represents the area of the closed loop in phase space traced by the particle. It can be calculated as:\n$$J = \\int_{-s_m}^{s_m} \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)} \\, ds + \\int_{s_m}^{-s_m} (-\\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)}) \\, ds$$\nBy reversing the limits of the second integral, we change its sign, making it identical to the first:\n$$J = 2 \\int_{-s_m}^{s_m} \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)} \\, ds = 2 \\int_{-s_m}^{s_m} \\sqrt{2m\\mu B_0 \\alpha \\left(\\frac{E - \\mu B_0}{\\mu B_0 \\alpha} - s^2\\right)} \\, ds$$\nLet $A^2 = s_m^2 = \\frac{E - \\mu B_0}{\\mu B_0 \\alpha}$. The expression for $J$ becomes:\n$$J = 2 \\sqrt{2m\\mu B_0 \\alpha} \\int_{-A}^{A} \\sqrt{A^2 - s^2} \\, ds$$\nThe integral $\\int_{-A}^{A} \\sqrt{A^2 - s^2} \\, ds$ represents the area of a semicircle with radius $A$, which is $\\frac{1}{2}\\pi A^2$.\n$$J = 2 \\sqrt{2m\\mu B_0 \\alpha} \\left( \\frac{\\pi A^2}{2} \\right) = \\pi A^2 \\sqrt{2m\\mu B_0 \\alpha}$$\nSubstituting the expression for $A^2$:\n$$J = \\pi \\left( \\frac{E - \\mu B_0}{\\mu B_0 \\alpha} \\right) \\sqrt{2m\\mu B_0 \\alpha} = \\pi (E - \\mu B_0) \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}}$$\nThis is the explicit expression for $J$.\n\nNow, we derive the bounce frequency $\\omega_b$ and period $T_b$. The equation of motion for the parallel component is given by Newton's second law, $F_{\\parallel} = m \\ddot{s}$, where $F_{\\parallel}$ is the force along the field line. This force is the negative gradient of the effective potential $U(s) = \\mu B(s)$:\n$$F_{\\parallel} = -\\frac{d}{ds}U(s) = -\\frac{d}{ds} \\left( \\mu B_0 (1 + \\alpha s^2) \\right) = -2\\mu B_0 \\alpha s$$\nThe equation of motion is:\n$$m \\ddot{s} = -2\\mu B_0 \\alpha s \\implies m \\ddot{s} + (2\\mu B_0 \\alpha) s = 0$$\nThis is the equation for a simple harmonic oscillator, $\\ddot{s} + \\omega_b^2 s = 0$, with an angular frequency $\\omega_b$ given by:\n$$\\omega_b^2 = \\frac{2\\mu B_0 \\alpha}{m} \\implies \\omega_b = \\sqrt{\\frac{2\\mu B_0 \\alpha}{m}}$$\nThe bounce period $T_b$ is related to the angular frequency by $T_b = \\frac{2\\pi}{\\omega_b}$:\n$$T_b = 2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\n\nFinally, we verify the relation $\\frac{dJ}{dE} = T_b$. We differentiate our derived expression for $J$ with respect to $E$, treating $m$, $\\mu$, $B_0$, and $\\alpha$ as constants:\n$$J(E) = \\pi (E - \\mu B_0) \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}}$$\n$$\\frac{dJ}{dE} = \\frac{d}{dE} \\left( \\pi E \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}} - \\pi \\mu B_0 \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}} \\right) = \\pi \\sqrt{\\frac{2m}{\\mu B_0 \\alpha}}$$\nWe can rewrite this as:\n$$\\frac{dJ}{dE} = \\pi \\sqrt{\\frac{4m}{2\\mu B_0 \\alpha}} = 2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\nFrom our expression for the bounce period, we see that this is exactly $T_b$:\n$$T_b = 2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\nComparing the two results, we see that the relation is verified:\n$$\\frac{dJ}{dE} = T_b$$\nThe problem asks for the final bounce period as a single closed-form symbolic expression. This is our derived expression for $T_b$.",
            "answer": "$$\n\\boxed{2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}}\n$$"
        },
        {
            "introduction": "With the analytical form of $J$ established in a simple case, we now shift our focus to building a deeper physical intuition. This practice  presents a thought experiment that challenges you to reason about the interplay between a particle's total energy $E$, its magnetic moment $\\mu$, and its longitudinal invariant $J$. By analyzing how the particle's accessible path and phase-space orbit change with $\\mu$, you will solidify your conceptual grasp of what $J$ represents physically, beyond the mathematical formalism.",
            "id": "4226790",
            "problem": "A nonrelativistic charged particle of mass $m$ and charge $q$ moves along a magnetic field line whose magnitude $B(s)$ varies slowly with arc-length $s$. The slow variation ensures validity of adiabatic invariants. The first adiabatic invariant (magnetic moment) $\\mu$ and the total energy $E$ are conserved. The second adiabatic invariant $J$ is the longitudinal invariant associated with the bounce motion of a particle trapped between mirror points along the field line.\n\nAssume $B(s)$ is symmetric with a single minimum $B_{\\min}$ at $s=0$ and increases monotonically with $|s|$ to $B_{\\max}$ as $|s|$ grows, as is typical of a coronal loop or a planetary magnetospheric field line. Consider the trapped regime where $B_{\\min} < E/\\mu < B_{\\max}$, so that mirror points exist at $s_\\pm$ with $s_- < 0 < s_+$. At fixed total energy $E$, consider how $J$ depends on $\\mu$.\n\nWhich option correctly characterizes the dependence of $J$ on $\\mu$ at fixed $E$, and provides a physically consistent interpretation in terms of mirror barriers and the narrowing of the accessible configuration space in $s$?\n\nA. At fixed $E$, $J$ decreases monotonically as $\\mu$ increases; increasing $\\mu$ raises the effective mirror barriers, moving the turning points inward toward lower $|s|$ and shrinking the region where motion with nonzero parallel momentum is allowed, thereby reducing the bounce action.\n\nB. At fixed $E$, $J$ increases monotonically as $\\mu$ increases; a larger $\\mu$ means larger perpendicular momentum, which increases the overall action accumulated per bounce and thus increases $J$.\n\nC. At fixed $E$, $J$ is independent of $\\mu$ because both $\\mu$ and $J$ are adiabatic invariants and therefore do not parametrize each other’s values.\n\nD. The dependence of $J$ on $\\mu$ is nonmonotonic within the trapped regime; $J$ first increases with $\\mu$ when mirror points appear and then decreases as the trapping strengthens further.",
            "solution": "The user wants a critical validation of the problem statement, followed by a rigorous derivation of the solution and an evaluation of the provided options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- A nonrelativistic charged particle of mass $m$ and charge $q$.\n- The particle moves along a magnetic field line.\n- The magnetic field magnitude $B(s)$ varies slowly with arc-length $s$.\n- The first adiabatic invariant (magnetic moment), $\\mu$, is conserved.\n- The total energy, $E$, is conserved.\n- The second adiabatic invariant, $J$ (longitudinal invariant), is associated with the bounce motion.\n- The magnetic field profile $B(s)$ is symmetric, with a single minimum $B_{\\min}$ at $s=0$.\n- $B(s)$ increases monotonically with $|s|$ to a value $B_{\\max}$.\n- The particle is in the trapped regime, where $B_{\\min} < E/\\mu < B_{\\max}$.\n- Mirror points exist at $s_\\pm$, where $s_- < 0 < s_+$.\n- The question is to determine the dependence of $J$ on $\\mu$ at a fixed total energy $E$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the well-established theory of adiabatic invariants for charged particle motion in magnetic fields, a fundamental concept in plasma physics, astrophysics (e.g., Van Allen belts), and fusion research (e.g., magnetic mirrors). The setup is a standard, canonical example used to illustrate these principles.\n- **Well-Posed:** The problem provides a clear physical scenario and asks for a specific functional dependence, $\\frac{\\partial J}{\\partial \\mu}$ at constant $E$. The quantities $E$, $\\mu$, and $J$ are standard, and the properties of the magnetic field $B(s)$ are sufficiently defined to allow for a unique and meaningful qualitative solution.\n- **Objective:** The problem is stated using precise, standard terminology from physics, free of ambiguity or subjective language.\n\n**Flaw Checklist:**\n1.  **Scientific or Factual Unsoundness:** None. The premises are correct within the framework of guiding-center theory and adiabatic invariants.\n2.  **Non-Formalizable or Irrelevant:** None. The problem is directly formalizable using the definitions of the physical quantities involved.\n3.  **Incomplete or Contradictory Setup:** None. The information is sufficient to determine the qualitative dependence. The symmetry of $B(s)$ implies $s_- = -s_+$.\n4.  **Unrealistic or Infeasible:** None. The described magnetic field geometry is a standard model for natural and laboratory plasmas (e.g., a magnetic dipole field line).\n5.  **Ill-Posed or Poorly Structured:** None. A unique answer can be derived from the provided information.\n6.  **Pseudo-Profound, Trivial, or Tautological:** None. The problem requires a solid conceptual and mathematical understanding of the relationship between the different conserved quantities.\n7.  **Outside Scientific Verifiability:** None. The relationship can be derived and verified mathematically.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with the solution.\n\n### Derivation\n\nThe total energy $E$ of the nonrelativistic particle is the sum of its kinetic energy parallel and perpendicular to the magnetic field line:\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\frac{1}{2}m v_{\\perp}^2$$\nSince $E$ is conserved, it is a constant of motion.\n\nThe first adiabatic invariant, the magnetic moment $\\mu$, is defined as:\n$$\\mu = \\frac{\\frac{1}{2}m v_{\\perp}^2}{B(s)}$$\nAs the particle moves along the field line, $\\mu$ is also conserved. We can express the perpendicular kinetic energy as $\\frac{1}{2}m v_{\\perp}^2 = \\mu B(s)$.\n\nSubstituting this into the energy conservation equation gives an expression for the parallel velocity $v_{\\parallel}$:\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B(s)$$\n$$v_{\\parallel}^2(s) = \\frac{2}{m} (E - \\mu B(s))$$\nThe particle is trapped, meaning it \"bounces\" between two mirror points. These points, $s_-$ and $s_+$, are the locations where the parallel velocity becomes zero, $v_{\\parallel} = 0$. This occurs when:\n$$E - \\mu B(s_{\\pm}) = 0 \\implies B(s_{\\pm}) = \\frac{E}{\\mu}$$\nSince the field $B(s)$ has a minimum at $s=0$ and increases monotonically with $|s|$, the mirror points are located symmetrically, $s_- = -s_+$.\n\nThe second adiabatic invariant, the longitudinal invariant $J$, is the action integral over one full bounce period. It is defined as $J = \\oint p_{\\parallel} ds$, where $p_{\\parallel} = m v_{\\parallel}$ is the parallel momentum. This integral represents the area enclosed by the particle's orbit in $(s, p_{\\parallel})$ phase space.\n$$J(\\mu, E) = \\oint p_\\parallel ds = 2 \\int_{s_-}^{s_+} \\sqrt{2m(E - \\mu B(s))} ds$$\nThe problem asks for the dependence of $J$ on $\\mu$ at a fixed energy $E$. We need to compute the partial derivative $\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E$. We use Leibniz's rule for differentiating an integral whose limits and integrand depend on the differentiation variable $\\mu$:\n$$\\frac{\\partial J}{\\partial \\mu} = 2 \\left[ \\int_{s_-}^{s_+} \\frac{\\partial}{\\partial \\mu}\\left(\\sqrt{2m(E - \\mu B(s))}\\right) ds + \\sqrt{2m(E - \\mu B(s_+))} \\frac{\\partial s_+}{\\partial \\mu} - \\sqrt{2m(E - \\mu B(s_-))} \\frac{\\partial s_-}{\\partial \\mu} \\right]$$\nAt the mirror points $s_{\\pm}$, we have $E - \\mu B(s_{\\pm}) = 0$. Therefore, the boundary terms (the second and third terms in the brackets) are zero. The derivative simplifies to:\n$$\\frac{\\partial J}{\\partial \\mu} = 2 \\int_{s_-}^{s_+} \\frac{\\partial}{\\partial \\mu}\\left(\\sqrt{2m(E - \\mu B(s))}\\right) ds$$\nThe partial derivative of the integrand is:\n$$\\frac{\\partial}{\\partial \\mu}\\left(\\sqrt{2m(E - \\mu B(s))}\\right) = \\sqrt{2m} \\frac{1}{2\\sqrt{E - \\mu B(s)}}(-B(s)) = -\\frac{\\sqrt{2m} B(s)}{2\\sqrt{E - \\mu B(s)}}$$\nSubstituting this back into the expression for $\\frac{\\partial J}{\\partial \\mu}$:\n$$\\frac{\\partial J}{\\partial \\mu} = 2 \\int_{s_-}^{s_+} \\left(-\\frac{\\sqrt{2m}B(s)}{2\\sqrt{E - \\mu B(s)}}\\right) ds = -\\sqrt{2m} \\int_{s_-}^{s_+} \\frac{B(s)}{\\sqrt{E - \\mu B(s)}} ds$$\nFor a trapped particle, the integration interval $(s_-, s_+)$ has a non-zero length. Within this interval, $E - \\mu B(s) > 0$, so the square root is real and positive. The magnetic field magnitude $B(s)$ is also positive. Thus, the integrand $\\frac{B(s)}{\\sqrt{E - \\mu B(s)}}$ is strictly positive everywhere in the open interval $(s_-, s_+)$. The integral of a positive function over a positive interval is positive.\nTherefore, $\\frac{\\partial J}{\\partial \\mu}$ is the product of a negative constant ($-\\sqrt{2m}$) and a positive integral. This means:\n$$\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E < 0$$\nThis proves that at a fixed total energy $E$, the longitudinal invariant $J$ is a monotonically decreasing function of the magnetic moment $\\mu$.\n\n**Physical Interpretation:**\n1.  **Effective Potential:** The motion along the field line is governed by $E = \\frac{1}{2}m v_{\\parallel}^2 + U_{eff}(s)$, where $U_{eff}(s) = \\mu B(s)$ is an effective potential.\n2.  **Mirror Points:** The particle is trapped in the potential well defined by $U_{eff}(s)$. The turning points (mirror points) $s_{\\pm}$ are where the parallel kinetic energy is zero, i.e., $E = U_{eff}(s_{\\pm}) = \\mu B(s_{\\pm})$.\n3.  **Effect of Increasing $\\mu$:** For a fixed energy $E$, increasing $\\mu$ raises the entire effective potential \"floor\" $U_{eff}(s)$. To satisfy the turning point condition $B(s_{\\pm}) = E/\\mu$, the mirror points must move to locations with a smaller magnetic field value. Since $B(s)$ is minimum at $s=0$ and increases with $|s|$, a smaller $B$ means a smaller $|s|$. The mirror points move inward, toward $s=0$.\n4.  **Effect on $J$:** The longitudinal invariant $J$ represents the area in the $(s, p_{\\parallel})$ phase space enclosed by the bounce orbit. As $\\mu$ increases:\n    - The range of motion in position space, $[s_-, s_+]$, shrinks.\n    - At any given position $s$ within the trapping region, the parallel momentum $p_{\\parallel}(s) = \\sqrt{2m(E - \\mu B(s))}$ decreases because $\\mu B(s)$ increases.\n    Both the width ($s_+ - s_-$) and the height (the magnitude of $p_{\\parallel}$) of the phase space orbit decrease. Consequently, the enclosed area $J$ must decrease.\n\n### Option-by-Option Analysis\n\n**A. At fixed E, J decreases monotonically as μ increases; increasing μ raises the effective mirror barriers, moving the turning points inward toward lower |s| and shrinking the region where motion with nonzero parallel momentum is allowed, thereby reducing the bounce action.**\n- `$J$ decreases monotonically as $\\mu$ increases`: This matches our mathematical result $\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E < 0$.\n- `increasing μ raises the effective mirror barriers`: This correctly identifies that the effective potential $U_{eff}(s) = \\mu B(s)$ increases with $\\mu$.\n- `moving the turning points inward toward lower |s|`: This is the correct consequence of raising the effective potential floor, as explained in the physical interpretation.\n- `shrinking the region where motion with nonzero parallel momentum is allowed`: This correctly describes the narrowing of the trapping region $[s_-, s_+]$.\n- `thereby reducing the bounce action`: This correctly concludes that the combined effects lead to a reduction in $J$.\nThis option provides a complete and physically consistent explanation.\n**Verdict: Correct.**\n\n**B. At fixed E, J increases monotonically as μ increases; a larger μ means larger perpendicular momentum, which increases the overall action accumulated per bounce and thus increases J.**\n- `$J$ increases monotonically as $\\mu$ increases`: This contradicts the mathematical derivation. The reasoning provided is fallacious; it confuses the cause (larger $\\mu$) with the effect on the *longitudinal* action $J$. While perpendicular energy is larger, the parallel energy and range of motion are smaller, which is what determines $J$.\n**Verdict: Incorrect.**\n\n**C. At fixed E, J is independent of μ because both μ and J are adiabatic invariants and therefore do not parametrize each other’s values.**\n- `$J$ is independent of $\\mu$`: This contradicts the mathematical derivation. The reasoning fundamentally misunderstands the nature of adiabatic invariants. While $\\mu$ and $J$ are constants of motion *for a given trajectory over time*, they are parameters that define a family of possible trajectories. The value of $J$ for a trajectory is a function of the system parameters and the other conserved quantities, namely $J = J(E, \\mu)$. They are not independent in this parametric sense.\n**Verdict: Incorrect.**\n\n**D. The dependence of J on μ is nonmonotonic within the trapped regime; J first increases with μ when mirror points appear and then decreases as the trapping strengthens further.**\n- The dependence is nonmonotonic: This contradicts the mathematical proof that the derivative $\\left(\\frac{\\partial J}{\\partial \\mu}\\right)_E$ is strictly negative for all values of $\\mu$ within the trapped regime ($B_{\\min} < E/\\mu < B_{\\max}$). The effect of increasing $\\mu$ is consistently to shrink the phase space area $J$.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Our final practice bridges the gap between idealized models and real-world astrophysical scenarios. While the quadratic well provides insight, many natural magnetic traps, such as planetary magnetospheres, are described by complex dipole fields where analytical solutions for $J$ are intractable. This computational exercise  guides you through the process of numerically calculating the mirror points and the longitudinal invariant for a particle in a realistic dipole field, equipping you with practical skills for research in magnetospheric and space plasma physics.",
            "id": "4226798",
            "problem": "Consider a non-relativistic charged particle of mass $m$ and kinetic energy $E$ moving in an axisymmetric dipole magnetic field, with slowly varying field so that guiding-center theory applies. Use the conservation of total kinetic energy and the conservation of the first adiabatic invariant (magnetic moment) to determine the mirror latitude and evaluate the second adiabatic invariant (longitudinal invariant) for bounce motion.\n\nAssume the magnetic field is an ideal dipole. Along a given dipole field line parameterized by the shell parameter $L$, the field line equation is $r = L R_p \\cos^2 \\lambda$, where $r$ is radial distance, $R_p$ is the planetary radius, and $\\lambda$ is the magnetic latitude measured from the magnetic equator ($\\lambda = 0$ at the equator). The magnetic field magnitude along this field line is\n$$\nB(\\lambda) = B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda},\n$$\nwhere the equatorial field magnitude at that $L$ shell is $B_{eq}(L) = B_0 L^{-3}$ and $B_0$ is the equatorial surface field magnitude. The differential arc length along the field line is\n$$\n\\frac{ds}{d\\lambda} = L R_p \\cos \\lambda \\,\\sqrt{1 + 3 \\sin^2 \\lambda}.\n$$\n\nThe particle's equatorial pitch angle is $\\alpha_{eq}$, defined by $\\tan \\alpha_{eq} = v_\\perp(0)/v_\\parallel(0)$, where $v_\\perp(0)$ and $v_\\parallel(0)$ are the perpendicular and parallel components of the velocity at the magnetic equator. Under the guiding-center approximation in a static magnetic field, total kinetic energy and magnetic moment are conserved:\n$$\nE = \\tfrac{1}{2} m v^2 = \\text{constant}, \\quad \\mu = \\frac{m v_\\perp^2}{2 B} = \\text{constant}.\n$$\n\nBy the mirror condition, the mirror latitude $\\lambda_m$ satisfies\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B(\\lambda_m)},\n$$\nwhich determines $\\lambda_m$ given $\\alpha_{eq}$.\n\nThe second adiabatic invariant (longitudinal invariant) for bounce motion is defined as the line integral of parallel momentum over one complete bounce cycle,\n$$\nJ = \\oint p_\\parallel \\, ds,\n$$\nwhere $p_\\parallel = m v_\\parallel$ for a non-relativistic particle. Using symmetry about the magnetic equator, the integral can be written as twice the integral from the equator to the northern mirror point.\n\nYour task is to write a program that:\n- For each specified test case, solves numerically for the mirror latitude $\\lambda_m$ (in degrees) from the mirror condition.\n- Using conservation of $E$ and $\\mu$, expresses $v_\\parallel(\\lambda)$ in terms of $\\alpha_{eq}$, $E$, $m$, $B(\\lambda)$, and $B_{eq}(L)$, and evaluates the longitudinal invariant $J$ numerically by integrating along the field line from the equator to $\\lambda_m$ and multiplying by $4$ to account for the full bounce cycle.\n\nConstants and units:\n- Use International System of Units (SI) throughout. Take the planetary radius $R_p = 6.371 \\times 10^6\\ \\mathrm{m}$, the equatorial surface field magnitude $B_0 = 3.12 \\times 10^{-5}\\ \\mathrm{T}$, the proton mass $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$, and the elementary charge $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$.\n- Treat the particle as a proton of mass $m = m_p$.\n- The input kinetic energy $E$ in the test suite is given in kilo-electronvolts, so convert $E$ from $\\mathrm{keV}$ to $\\mathrm{J}$ using $E\\ [\\mathrm{J}] = E\\ [\\mathrm{keV}] \\times 10^3 \\times e$.\n- Use degrees for angles in the test suite and for reporting the mirror latitude $\\lambda_m$; internally your program may use radians.\n- Express the final longitudinal invariant $J$ in $\\mathrm{kg\\ m^2\\ s^{-1}}$.\n\nTest suite:\n- Case $1$: $E = 10\\ \\mathrm{keV}$, $\\alpha_{eq} = 60^\\circ$, $L = 4$.\n- Case $2$: $E = 1\\ \\mathrm{keV}$, $\\alpha_{eq} = 85^\\circ$, $L = 6$.\n- Case $3$: $E = 100\\ \\mathrm{keV}$, $\\alpha_{eq} = 30^\\circ$, $L = 3$.\n- Case $4$: $E = 50\\ \\mathrm{keV}$, $\\alpha_{eq} = 5^\\circ$, $L = 5$.\n- Case $5$: $E = 20\\ \\mathrm{keV}$, $\\alpha_{eq} = 75^\\circ$, $L = 8$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the form\n$$\n\\big[\\,[\\lambda_{m,1}, J_1],\\,[\\lambda_{m,2}, J_2],\\,\\dots\\,\\big],\n$$\nwhere each $\\lambda_{m,i}$ is the mirror latitude in degrees and each $J_i$ is the longitudinal invariant in $\\mathrm{kg\\ m^2\\ s^{-1}}$ computed for the corresponding test case.",
            "solution": "The problem statement is evaluated as valid. It is a well-posed, scientifically grounded problem from the field of astrophysical plasma physics. It is self-contained, with all necessary physical principles, equations, and constants provided for a unique and meaningful solution. The task requires the application of standard concepts of guiding-center theory and adiabatic invariants in a dipole magnetic field, which is a fundamental topic in the discipline.\n\nThe solution proceeds in two primary stages: first, determining the mirror latitude $\\lambda_m$ by solving a transcendental equation, and second, evaluating the second adiabatic invariant $J$ by computing a definite integral.\n\n**Part 1: Determination of the Mirror Latitude $\\lambda_m$**\n\nA charged particle's trajectory in a converging magnetic field is characterized by a \"mirror point,\" where its velocity component parallel to the magnetic field, $v_\\parallel$, becomes zero, and the particle is reflected. This phenomenon occurs due to the conservation of the first adiabatic invariant, the magnetic moment $\\mu = \\frac{m v_\\perp^2}{2B}$, and the total kinetic energy $E = \\frac{1}{2}mv^2$.\n\nThe condition for mirroring at a latitude $\\lambda_m$ is given by the relation between the equatorial pitch angle $\\alpha_{eq}$ and the magnetic field strengths at the equator, $B_{eq}(L)$, and at the mirror point, $B(\\lambda_m)$:\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B(\\lambda_m)}\n$$\nThe problem provides the expression for the magnetic field magnitude along a dipole field line as a function of magnetic latitude $\\lambda$:\n$$\nB(\\lambda) = B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda}\n$$\nBy substituting this into the mirror condition, we obtain an equation solely in terms of $\\lambda_m$ and the known $\\alpha_{eq}$:\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda_m}}{\\cos^6 \\lambda_m}} = \\frac{\\cos^6 \\lambda_m}{\\sqrt{1 + 3 \\sin^2 \\lambda_m}}\n$$\nThis is a transcendental equation for $\\lambda_m$. To facilitate a numerical solution, we define a function $f(\\lambda)$ whose root corresponds to $\\lambda_m$:\n$$\nf(\\lambda) = \\frac{\\cos^6 \\lambda}{\\sqrt{1 + 3 \\sin^2 \\lambda}} - \\sin^2 \\alpha_{eq} = 0\n$$\nThe solution $\\lambda_m$ lies within the interval $[0, \\pi/2]$ radians. A numerical root-finding algorithm, such as the Brent-Dekker method, is suitable for finding the value of $\\lambda_m$ that satisfies this equation.\n\n**Part 2: Evaluation of the Second Adiabatic Invariant $J$**\n\nThe second adiabatic invariant, or longitudinal invariant $J$, is associated with the periodic \"bounce\" motion of a particle between its two mirror points. It is defined as the line integral of parallel momentum over one full bounce cycle:\n$$\nJ = \\oint p_\\parallel \\, ds\n$$\nThe integration path follows the magnetic field line. Due to the symmetry of the dipole field with respect to the magnetic equator, the integral over a full bounce (from the southern mirror point at $-\\lambda_m$ to the northern one at $+\\lambda_m$, and back) is four times the integral from the equator ($\\lambda=0$) to one of the mirror points ($\\lambda_m$):\n$$\nJ = 4 \\int_{0}^{\\lambda_m} m v_\\parallel(\\lambda) \\, ds\n$$\nThis integral must be expressed in terms of the latitude $\\lambda$ as the integration variable. The differential arc length $ds$ is given by:\n$$\nds = L R_p \\cos \\lambda \\,\\sqrt{1 + 3 \\sin^2 \\lambda} \\, d\\lambda\n$$\nThe parallel velocity $v_\\parallel(\\lambda)$ is determined from the conservation of energy and magnetic moment. Since total energy $E$ is conserved, the particle's speed $v = \\sqrt{2E/m}$ is constant. The velocity components satisfy $v^2 = v_\\parallel^2 + v_\\perp^2$. The conservation of $\\mu$ implies $\\frac{v_\\perp(\\lambda)^2}{B(\\lambda)} = \\frac{v_\\perp(0)^2}{B_{eq}(L)}$, where $v_\\perp(0) = v \\sin \\alpha_{eq}$ is the perpendicular velocity at the equator. This yields:\n$$\nv_\\perp(\\lambda)^2 = v^2 \\sin^2 \\alpha_{eq} \\frac{B(\\lambda)}{B_{eq}(L)}\n$$\nConsequently, the parallel velocity squared is:\n$$\nv_\\parallel(\\lambda)^2 = v^2 - v_\\perp(\\lambda)^2 = v^2 \\left( 1 - \\sin^2 \\alpha_{eq} \\frac{B(\\lambda)}{B_{eq}(L)} \\right)\n$$\nTaking the square root for the velocity component directed away from the equator:\n$$\nv_\\parallel(\\lambda) = v \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}}\n$$\nSubstituting all components into the integral for $J$:\n$$\nJ = 4 \\int_{0}^{\\lambda_m} m \\left( \\sqrt{\\frac{2E}{m}} \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}} \\right) \\left( L R_p \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\right) d\\lambda\n$$\nThis expression simplifies to:\n$$\nJ = 4 \\sqrt{2mE} \\, L R_p \\int_{0}^{\\lambda_m} \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}} \\, \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\, d\\lambda\n$$\nBy inserting the formula for the ratio $B(\\lambda)/B_{eq}(L)$, we arrive at the final form of the integrand:\n$$\nJ = 4 \\sqrt{2mE} \\, L R_p \\int_{0}^{\\lambda_m} \\sqrt{1 - \\left( \\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda} \\right) \\sin^2 \\alpha_{eq}} \\, \\left( \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\right) \\, d\\lambda\n$$\nThis definite integral lacks a closed-form analytical solution and must be evaluated numerically using a suitable quadrature algorithm.\n\n**Computational Procedure**\n\nThe overall process for each test case is as follows:\n$1$. Convert the input parameters ($E$ from $\\mathrm{keV}$ to joules, $\\alpha_{eq}$ from degrees to radians) to SI units.\n$2$. Use the provided physical constants: $R_p = 6.371 \\times 10^6\\ \\mathrm{m}$, $m = m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$, and $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$.\n$3$. Numerically solve for the mirror latitude $\\lambda_m$ (in radians) using a root-finding method on the equation $f(\\lambda)=0$.\n$4$. Numerically evaluate the integral for $J$ from $\\lambda=0$ to the determined $\\lambda_m$.\n$5$. Assemble the final results, converting $\\lambda_m$ back to degrees for the output, and present them in the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize, integrate\n\ndef solve():\n    \"\"\"\n    Computes the mirror latitude and second adiabatic invariant for a proton\n    in a dipole magnetic field for a given set of test cases.\n    \"\"\"\n    # Define physical constants in SI units.\n    R_p = 6.371e6  # Planetary radius (m)\n    B_0 = 3.12e-5  # Equatorial surface field magnitude (T)\n    m_p = 1.67262192369e-27  # Proton mass (kg)\n    e = 1.602176634e-19  # Elementary charge (C)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E in keV, alpha_eq in degrees, L-shell)\n        (10.0, 60.0, 4.0),\n        (1.0, 85.0, 6.0),\n        (100.0, 30.0, 3.0),\n        (50.0, 5.0, 5.0),\n        (20.0, 75.0, 8.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_kev, alpha_eq_deg, L = case\n\n        # --- Convert inputs to SI units ---\n        E_joule = E_kev * 1000.0 * e\n        alpha_eq_rad = np.deg2rad(alpha_eq_deg)\n\n        # --- Step 1: Solve for the mirror latitude lambda_m ---\n\n        # Define the function whose root is lambda_m.\n        # f(lam) = cos^6(lam) / sqrt(1 + 3sin^2(lam)) - sin^2(alpha_eq)\n        def lambda_m_func(lam, alpha_rad):\n            sin_lam = np.sin(lam)\n            cos_lam = np.cos(lam)\n            # To avoid division by zero at lam=pi/2, although brentq should not hit it\n            if np.isclose(cos_lam, 0.0):\n                 return -np.sin(alpha_rad)**2\n            term1 = cos_lam**6 / np.sqrt(1.0 + 3.0 * sin_lam**2)\n            term2 = np.sin(alpha_rad)**2\n            return term1 - term2\n\n        # Use Brent's method to find the root in the interval [0, pi/2].\n        # The function value is > 0 at lam=0 and  0 at lam=pi/2,\n        # so a root is guaranteed.\n        try:\n            lambda_m_rad = optimize.brentq(\n                lambda_m_func, 0, np.pi / 2, args=(alpha_eq_rad,)\n            )\n        except ValueError:\n            # This should not happen for the given range of alpha_eq\n            results.append([np.nan, np.nan])\n            continue\n            \n        lambda_m_deg = np.rad2deg(lambda_m_rad)\n\n        # --- Step 2: Evaluate the longitudinal invariant J ---\n        \n        # If alpha_eq = 90 deg, particle mirrors at equator, lambda_m = 0, J = 0.\n        if np.isclose(alpha_eq_deg, 90.0):\n            results.append([0.0, 0.0])\n            continue\n\n        # J = 4 * integral_0^lambda_m (m * v_parallel) ds\n        # J = 4 * integral_0^lambda_m (m * v_parallel) * (ds/d_lambda) d_lambda\n        # v_parallel = v * sqrt(1 - (B/B_eq)*sin^2(alpha_eq))\n        # v = sqrt(2E/m)\n        # m*v_parallel = sqrt(2mE) * sqrt(1 - (B/B_eq)*sin^2(alpha_eq))\n        # J = 4 * sqrt(2mE) * integral_0^lambda_m [sqrt(1-(B/Beq)...) * (ds/dlam)] dlam\n\n        sin2_alpha_eq = np.sin(alpha_eq_rad)**2\n        def j_integrand(lam):\n            sin_lam = np.sin(lam)\n            cos_lam = np.cos(lam)\n            \n            # The term inside this sqrt approaches 0 as lam -> lambda_m.\n            # It can be numerically unstable if lam slightly exceeds lambda_m\n            # due to integrator step choices. We protect against this.\n            B_ratio = np.sqrt(1.0 + 3.0 * sin_lam**2) / (cos_lam**6)\n            inner_sqrt_term = 1.0 - B_ratio * sin2_alpha_eq\n            if inner_sqrt_term  0: inner_sqrt_term = 0.0\n            \n            sqrt_v_parallel_norm = np.sqrt(inner_sqrt_term)\n            \n            ds_dlam_term = L * R_p * cos_lam * np.sqrt(1.0 + 3.0 * sin_lam**2)\n            \n            return sqrt_v_parallel_norm * ds_dlam_term\n\n        # Numerically integrate from 0 to lambda_m_rad.\n        # quad returns (integral_value, error_estimate). We need the first element.\n        integral_val, _ = integrate.quad(j_integrand, 0, lambda_m_rad, epsabs=1e-12, epsrel=1e-12)\n        \n        # Calculate J using the full formula.\n        prefactor = 4.0 * np.sqrt(2.0 * m_p * E_joule)\n        J = prefactor * integral_val\n\n        results.append([lambda_m_deg, J])\n\n    # Format the final output string as requested.\n    output_str = '[' + ','.join([f'[{res[0]:.15g},{res[1]:.15g}]' for res in results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}