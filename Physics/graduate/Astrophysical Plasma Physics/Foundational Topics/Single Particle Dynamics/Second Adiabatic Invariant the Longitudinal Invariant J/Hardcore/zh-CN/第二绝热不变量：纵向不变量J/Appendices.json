{
    "hands_on_practices": [
        {
            "introduction": "为了从根本上理解纵向不变量 $J$，我们首先从一个理想化的模型入手。通过将磁场极小值附近的磁场近似为一个抛物线形的“谐振磁阱”，带电粒子的平行运动可以被映射为一个简单谐振子模型。这个练习将指导你推导在这种近似下 $J$ 的解析表达式，这是掌握更复杂情况下粒子囚禁物理性质的关键第一步。",
            "id": "4226793",
            "problem": "考虑一个质量为 $m$、电荷为 $q$ 的带电粒子，在没有电场的情况下，在静态非均匀磁场 $\\mathbf{B}(\\mathbf{x})$ 中运动。令 $s$ 表示沿磁力线的弧长坐标，并假设磁场在 $s=0$ 处有一个局部最小值，其大小 $B(s)$ 在粒子回旋半径的空间尺度上是光滑且缓慢变化的。假设导心近似有效，因此第一绝热不变量（磁矩）$\\mu = m v_{\\perp}^{2}/(2 B)$ 是守恒的。在最小值附近，通过二次展开来模拟场强大小 $B(s) \\approx B_{0} + \\tfrac{1}{2} \\kappa s^{2}$，其中 $B_{0} = B(0)$ 且 $\\kappa = \\left.\\frac{\\mathrm{d}^{2} B}{\\mathrm{d} s^{2}}\\right|_{s=0} > 0$ 是场强的平行曲率。\n\n从洛伦兹力定律和 $\\mu$ 的守恒出发，推导 $s=0$ 附近的有效一维平行运动动力学，并确定相应的平行能量 $E_{\\parallel}$。使用第二绝热不变量（纵向不变量）$J$ 作为作用量变量的定义\n$$\nJ \\equiv \\frac{1}{2 \\pi} \\oint p_{\\parallel} \\,\\mathrm{d} s,\n$$\n其中 $p_{\\parallel} = m v_{\\parallel}$，积分是在两个转折点之间的一个完整反弹振荡周期内进行的，求出在小振幅极限下 $J$ 的闭式解析表达式，该表达式仅用总能量 $E$、磁矩 $\\mu$、最小场强 $B_{0}$、质量 $m$ 和曲率 $\\kappa$ 表示。你的最终答案必须是单一的闭式表达式。不需要进行数值计算。",
            "solution": "该问题要求推导在磁阱中进行反弹运动的带电粒子的第二绝热不变量（或称纵向不变量）$J$ 的表达式。\n\n首先，我们验证问题陈述。\n\n**步骤1：提取已知条件**\n- 粒子质量：$m$\n- 粒子电荷：$q$\n- 环境：静态非均匀磁场 $\\mathbf{B}(\\mathbf{x})$，无电场。\n- 坐标系：$s$ 是沿磁力线的弧长坐标。\n- 磁场分布：场强大小 $B(s)$ 在 $s=0$ 处有局部最小值。\n- 近似：导心近似有效。磁场缓慢变化。\n- 守恒量（给定）：第一绝热不变量，磁矩 $\\mu = m v_{\\perp}^{2}/(2 B)$。\n- 最小值附近的场强模型：$B(s) \\approx B_{0} + \\tfrac{1}{2} \\kappa s^{2}$，其中 $B_{0} = B(0)$ 是最小场强，$\\kappa = \\left.\\frac{\\mathrm{d}^{2} B}{\\mathrm{d} s^{2}}\\right|_{s=0} > 0$ 是场强的曲率。\n- 纵向不变量的定义：$J \\equiv \\frac{1}{2 \\pi} \\oint p_{\\parallel} \\,\\mathrm{d} s$，其中 $p_{\\parallel} = m v_{\\parallel}$，积分为一个反弹周期。\n- 期望输出：用总能量 $E$、$\\mu$、$B_0$、$m$ 和 $\\kappa$ 表示的 $J$ 的闭式表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，借鉴了等离子体物理学的基本原理，即带电粒子在磁场中的导心运动和绝热不变量理论。所使用的近似（缓慢变化的场，最小值附近的二次展开）是分析磁镜位形的标准技术。该问题是适定的，提供了进行推导所需的所有必要信息（守恒定律、场模型和目标量的定义）。语言客观而精确。该问题不违反任何无效性标准。\n\n**步骤3：结论与行动**\n问题有效。我们继续进行求解。\n\n**求解推导**\n粒子的总能量是其动能，因为不存在势能场（如电场或引力场）。磁场力 $\\mathbf{F} = q(\\mathbf{v} \\times \\mathbf{B})$ 始终垂直于粒子的速度 $\\mathbf{v}$，因此不做功。所以，粒子的总动能 $E$ 是守恒的。\n$$E = \\frac{1}{2}m v^{2} = \\text{constant}$$\n我们将速度矢量分解为平行于 ($v_{\\parallel}$) 和垂直于 ($v_{\\perp}$) 局部磁力线的分量。总能量可以写为：\n$$E = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2) = \\frac{1}{2}m v_{\\parallel}^2 + \\frac{1}{2}m v_{\\perp}^2$$\n问题指出，第一绝热不变量，即磁矩 $\\mu$，是守恒的。其定义为：\n$$\\mu = \\frac{m v_{\\perp}^2}{2 B(s)} = \\text{constant}$$\n根据这个守恒定律，我们可以将垂直动能表示为粒子导心位置 $s$ 处磁场强度 $B$ 的函数：\n$$\\frac{1}{2}m v_{\\perp}^2 = \\mu B(s)$$\n将此表达式代入总能量守恒方程，我们得到粒子导心平行运动的方程：\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B(s)$$\n该方程描述了平行运动的有效一维系统，其中 $\\frac{1}{2}m v_{\\parallel}^2$ 是平行运动的动能，而 $U_{\\text{eff}}(s) = \\mu B(s)$ 充当有效势能。这个一维系统的总能量是 $E$，即粒子守恒的总能量。问题要求确定平行能量，最自然的解释是这个控制平行运动动力学的守恒量 $E$。\n\n问题给出了在 $s=0$ 处磁场强度最小值附近的二次近似：\n$$B(s) \\approx B_0 + \\frac{1}{2}\\kappa s^2$$\n其中 $B_0 = B(0)$ 且 $\\kappa > 0$。将其代入平行运动的能量方程，我们得到：\n$$E \\approx \\frac{1}{2}m v_{\\parallel}^2 + \\mu \\left(B_0 + \\frac{1}{2}\\kappa s^2\\right)$$\n我们可以重新整理这个方程，以更好地理解运动的性质。让我们将常数项 $\\mu B_0$ 移到左边：\n$$E - \\mu B_0 = \\frac{1}{2}m v_{\\parallel}^2 + \\frac{1}{2}\\mu\\kappa s^2$$\n这是简谐振子的能量守恒方程。该运动是坐标 $s$ 围绕磁阱在 $s=0$ 处的最小值进行的振荡。量 $E_{\\text{osc}} = E - \\mu B_0$ 是这个振荡的能量，表示粒子高于等效势阱最低点的能量。平行动量为 $p_{\\parallel} = m v_{\\parallel}$。用动量表示的方程是：\n$$E - \\mu B_0 = \\frac{p_{\\parallel}^2}{2m} + \\frac{1}{2}(\\mu\\kappa)s^2$$\n该系统的行为就像一个质量为 $m$ 的粒子附着在一个有效劲度系数为 $k_{\\text{eff}} = \\mu\\kappa$ 的弹簧上。\n\n第二绝热不变量 $J$ 由在一个完整反弹振荡周期内的作用量积分定义：\n$$J = \\frac{1}{2\\pi} \\oint p_{\\parallel} \\, ds$$\n积分 $\\oint p_{\\parallel} \\, ds$ 表示粒子在 $(s, p_{\\parallel})$ 相空间中轨迹所包围的面积。该轨迹的方程是一个椭圆：\n$$\\frac{s^2}{\\left(\\frac{2(E - \\mu B_0)}{\\mu\\kappa}\\right)} + \\frac{p_{\\parallel}^2}{\\left(2m(E - \\mu B_0)\\right)} = 1$$\n这是一个形式为 $\\frac{s^2}{a^2} + \\frac{p_{\\parallel}^2}{b^2} = 1$ 的椭圆，其半轴为：\n$$a = \\sqrt{\\frac{2(E - \\mu B_0)}{\\mu\\kappa}}$$\n$$b = \\sqrt{2m(E - \\mu B_0)}$$\n这个椭圆的面积是 $\\mathcal{A} = \\pi a b$。\n$$\\mathcal{A} = \\pi \\sqrt{\\frac{2(E - \\mu B_0)}{\\mu\\kappa}} \\sqrt{2m(E - \\mu B_0)}$$\n$$\\mathcal{A} = \\pi \\sqrt{\\frac{4m(E - \\mu B_0)^2}{\\mu\\kappa}}$$\n$$\\mathcal{A} = 2\\pi (E - \\mu B_0) \\sqrt{\\frac{m}{\\mu\\kappa}}$$\n现在，我们可以通过将这个面积代入其定义来求得 $J$：\n$$J = \\frac{1}{2\\pi} \\mathcal{A} = \\frac{1}{2\\pi} \\left[ 2\\pi (E - \\mu B_0) \\sqrt{\\frac{m}{\\mu\\kappa}} \\right]$$\n在小振幅（谐振）极限下，这简化为纵向不变量的最终表达式：\n$$J = (E - \\mu B_0) \\sqrt{\\frac{m}{\\mu\\kappa}}$$\n这个结果完全由所需的量表示：总能量 $E$、磁矩 $\\mu$、最小场强 $B_0$、粒子质量 $m$ 以及场曲率 $\\kappa$。",
            "answer": "$$\n\\boxed{(E - \\mu B_0) \\sqrt{\\frac{m}{\\mu\\kappa}}}\n$$"
        },
        {
            "introduction": "在哈密顿力学中，像 $J$ 这样的绝热不变量不仅仅是守恒量，它们还是所谓的“作用量”变量，蕴含着关于系统动力学周期的深刻信息。这个练习将基于前一个练习的谐振子模型，引导你证明一个基本关系：$J$ 对能量 $E$ 的导数等于粒子弹跳运动的周期（除以 $2\\pi$）。这一结论揭示了 $J$ 的核心物理意义，并将其从一个抽象的守恒量变为了一个可预测系统时间行为的强大工具。",
            "id": "4226738",
            "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子在天体物理等离子体中沿磁场线进行引导中心运动，其中电场可忽略不计，磁场的空间变化足够缓慢以保证绝热不变量成立。在磁场极小值附近（例如，类偶极场的赤道面附近），沿弧长坐标 $s$ 的磁场大小可近似为\n$$\nB(s) = B_0 \\left( 1 + \\alpha s^2 \\right),\n$$\n其中 $B_0 > 0$ 是最小场强，$\\alpha > 0$ 表征了沿场线的磁场大小的局部曲率，且 $|s|$ 足够小以至于 $s$ 的高阶项可以忽略。第一绝热不变量（磁矩）$\\mu$ 定义为\n$$\n\\mu = \\frac{m v_{\\perp}^2}{2 B},\n$$\n并假设其为常数。总能量 $E$ 守恒，可写为\n$$\nE = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s),\n$$\n其中 $v_{\\parallel}$ 是沿场线的速度分量。\n\n使用第二绝热不变量的纵向作用量变量定义，\n$$\nJ = \\frac{1}{2\\pi} \\oint p_{\\parallel}\\, ds,\n$$\n其中 $p_{\\parallel} = m v_{\\parallel}$，环路积分是对两个磁镜点之间的一次完整反弹进行的，请在给定的二次场近似下，推导 $J$ 作为 $E$、$\\mu$、$B_0$、$\\alpha$ 和 $m$ 的函数的显式表达式。根据所得的有效一维动力学，求出此近似下的反弹角频率 $\\omega_b$，并由此得到反弹周期 $T_b \\approx \\frac{2\\pi}{\\omega_b}$。最后，将您推导出的 $J$ 对 $E$ 求导，并验证关系式\n$$\n\\frac{dJ}{dE} = \\frac{T_b}{2\\pi}.\n$$\n\n将最终的反弹周期以秒为单位表示，并给出以 $m$、$\\mu$、$B_0$ 和 $\\alpha$ 表示的单个闭合形式符号表达式。无需数值取整。假设 $E > \\mu B_0$ 以便粒子在转折点之间反弹。",
            "solution": "首先验证问题，以确保其是自洽的、科学上合理的和适定的。\n\n**步骤 1：提取已知条件**\n- 粒子质量：$m$\n- 粒子电荷：$q$\n- 沿弧长 $s$ 的磁场大小：$B(s) = B_0 ( 1 + \\alpha s^2 )$，其中 $B_0 > 0$ 且 $\\alpha > 0$。\n- 第一绝热不变量：$\\mu = \\frac{m v_{\\perp}^2}{2 B}$ (常数)。\n- 守恒总能量：$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s)$。\n- 第二绝热不变量定义：$J = \\frac{1}{2\\pi} \\oint p_{\\parallel}\\, ds$，其中 $p_{\\parallel} = m v_{\\parallel}$。\n- 积分范围是一个完整的反弹周期。\n- 反弹运动的条件：$E > \\mu B_0$。\n- 需要验证的关系式：$\\frac{dJ}{dE} = \\frac{T_b}{2\\pi}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了磁镜位形中粒子捕获的标准模型，这是等离子体物理学的基石之一。在磁场极小值附近对磁场进行二次近似是分析反弹运动的一种有效且常用的技术，它会导致简谐运动。绝热不变量 $\\mu$ 和 $J$ 以及能量 $E$ 的定义都是标准的。该问题是适定的，提供了计算所需量所需的所有必要信息。语言客观、正式。不存在科学缺陷、矛盾或歧义。\n\n**结论**：问题有效。\n\n**解题推导**\n粒子平行于磁场线的运动受能量守恒定律支配。总能量 $E$ 由下式给出：\n$$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B(s)$$\n在此，$\\frac{1}{2} m v_{\\parallel}^2$ 是平行运动的动能，$U(s) = \\mu B(s)$ 充当有效势能。代入给定的 $B(s)$ 表达式：\n$$E = \\frac{1}{2} m v_{\\parallel}^2 + \\mu B_0 (1 + \\alpha s^2)$$\n平行方向的动量为 $p_{\\parallel} = m v_{\\parallel}$。我们可以将 $p_{\\parallel}$ 表示为位置 $s$ 的函数：\n$$p_{\\parallel}^2 = (m v_{\\parallel})^2 = 2m(E - \\mu B_0(1 + \\alpha s^2)) = 2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)$$\n因此，动量为：\n$$p_{\\parallel}(s) = \\pm \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)}$$\n粒子被捕获并在两个转折点（或称磁镜点）$s = \\pm s_m$ 之间反弹，在这些点上其平行速度变为零。通过设 $p_{\\parallel}(s) = 0$ 可以找到这些点：\n$$E - \\mu B_0 - \\mu B_0 \\alpha s_m^2 = 0$$\n$$s_m^2 = \\frac{E - \\mu B_0}{\\mu B_0 \\alpha}$$\n转折点位于 $s_m = \\pm \\sqrt{\\frac{E - \\mu B_0}{\\mu B_0 \\alpha}}$。条件 $E > \\mu B_0$ 确保 $s_m^2 > 0$，因此存在实数转折点。\n\n接下来，我们计算第二绝热不变量 $J$，其定义为：\n$$J = \\frac{1}{2\\pi} \\oint p_{\\parallel}\\, ds$$\n积分覆盖一个完整的反弹周期，从 $s = -s_m$ 到 $s = s_m$（此时 $p_{\\parallel} > 0$），再从 $s = s_m$ 回到 $s = -s_m$（此时 $p_{\\parallel}  0$）。这可以写成：\n$$J = \\frac{1}{2\\pi} \\left( \\int_{-s_m}^{s_m} \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)} \\, ds + \\int_{s_m}^{-s_m} -\\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)} \\, ds \\right)$$\n通过反转第二个积分的积分限，我们改变其符号，使其与第一个积分相同：\n$$J = \\frac{2}{2\\pi} \\int_{-s_m}^{s_m} \\sqrt{2m(E - \\mu B_0 - \\mu B_0 \\alpha s^2)} \\, ds = \\frac{1}{\\pi} \\int_{-s_m}^{s_m} \\sqrt{2m\\mu B_0 \\alpha \\left(\\frac{E - \\mu B_0}{\\mu B_0 \\alpha} - s^2\\right)} \\, ds$$\n令 $A^2 = s_m^2 = \\frac{E - \\mu B_0}{\\mu B_0 \\alpha}$。$J$ 的表达式变为：\n$$J = \\frac{\\sqrt{2m\\mu B_0 \\alpha}}{\\pi} \\int_{-A}^{A} \\sqrt{A^2 - s^2} \\, ds$$\n积分 $\\int_{-A}^{A} \\sqrt{A^2 - s^2} \\, ds$ 表示半径为 $A$ 的半圆的面积，即 $\\frac{1}{2}\\pi A^2$。\n$$J = \\frac{\\sqrt{2m\\mu B_0 \\alpha}}{\\pi} \\left( \\frac{\\pi A^2}{2} \\right) = \\frac{\\sqrt{2m\\mu B_0 \\alpha}}{2} A^2$$\n代入 $A^2$ 的表达式：\n$$J = \\frac{\\sqrt{2m\\mu B_0 \\alpha}}{2} \\left( \\frac{E - \\mu B_0}{\\mu B_0 \\alpha} \\right) = \\frac{\\sqrt{2m}}{2\\sqrt{\\mu B_0 \\alpha}} (E - \\mu B_0) = (E - \\mu B_0) \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\n这就是 $J$ 的显式表达式。\n\n现在，我们推导反弹频率 $\\omega_b$ 和周期 $T_b$。平行分量的运动方程由牛顿第二定律 $F_{\\parallel} = m \\ddot{s}$ 给出，其中 $F_{\\parallel}$ 是沿场线方向的力。这个力是有效势能 $U(s) = \\mu B(s)$ 的负梯度：\n$$F_{\\parallel} = -\\frac{d}{ds}U(s) = -\\frac{d}{ds} \\left( \\mu B_0 (1 + \\alpha s^2) \\right) = -2\\mu B_0 \\alpha s$$\n运动方程为：\n$$m \\ddot{s} = -2\\mu B_0 \\alpha s \\implies m \\ddot{s} + (2\\mu B_0 \\alpha) s = 0$$\n这是一个简谐振子的方程，$\\ddot{s} + \\omega_b^2 s = 0$，其角频率 $\\omega_b$ 由下式给出：\n$$\\omega_b^2 = \\frac{2\\mu B_0 \\alpha}{m} \\implies \\omega_b = \\sqrt{\\frac{2\\mu B_0 \\alpha}{m}}$$\n反弹周期 $T_b$ 与角频率的关系为 $T_b = \\frac{2\\pi}{\\omega_b}$：\n$$T_b = 2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\n\n最后，我们验证关系式 $\\frac{dJ}{dE} = \\frac{T_b}{2\\pi}$。我们将推导出的 $J$ 的表达式对 $E$ 求导，并将 $m$、$\\mu$、$B_0$ 和 $\\alpha$ 视为常数：\n$$J(E) = (E - \\mu B_0) \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\n$$\\frac{dJ}{dE} = \\frac{d}{dE} \\left( E\\sqrt{\\frac{m}{2\\mu B_0 \\alpha}} - \\mu B_0 \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}} \\right) = \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\n根据我们的反弹周期表达式，我们有：\n$$\\frac{T_b}{2\\pi} = \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}$$\n比较这两个结果，我们看到该关系式得到了验证：\n$$\\frac{dJ}{dE} = \\frac{T_b}{2\\pi}$$\n问题要求以单个闭合形式符号表达式给出最终的反弹周期。这就是我们推导出的 $T_b$ 的表达式。",
            "answer": "$$\n\\boxed{2\\pi \\sqrt{\\frac{m}{2\\mu B_0 \\alpha}}}\n$$"
        },
        {
            "introduction": "理论模型为我们提供了基础，但真实世界的等离子体物理问题往往更为复杂。这个练习将我们从理想化的谐振阱带入一个更现实的场景：偶极磁场，这是行星磁层（如地球的范艾伦辐射带）的典型模型。由于偶极磁场的形式更为复杂，解析求解 $J$ 通常是不可能的，因此我们必须借助数值计算。这个练习不仅能让你实践如何通过数值积分来解决实际的天体物理问题，还会让你接触到 $J$ 的另一种常用定义约定。",
            "id": "4226798",
            "problem": "考虑一个质量为 $m$、动能为 $E$ 的非相对论带电粒子，在一个轴对称偶极磁场中运动。该磁场变化缓慢，因此导心理论适用。请利用总动能守恒和第一绝热不变量（磁矩）守恒来确定磁镜纬度，并计算反弹运动的第二绝热不变量（纵向不变量）。\n\n假设磁场为理想偶极子。沿一条由壳参数 $L$ 参数化的给定偶极磁力线，其方程为 $r = L R_p \\cos^2 \\lambda$，其中 $r$ 是径向距离，$R_p$ 是行星半径，$\\lambda$ 是从磁赤道（赤道处 $\\lambda = 0$）测量的磁纬。沿该磁力线的磁场强度大小为\n$$\nB(\\lambda) = B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda},\n$$\n其中，在该 $L$ 壳层上的赤道磁场强度大小为 $B_{eq}(L) = B_0 L^{-3}$，$B_0$ 是赤道表面磁场强度大小。沿磁力线的弧长微分为\n$$\n\\frac{ds}{d\\lambda} = L R_p \\cos \\lambda \\,\\sqrt{1 + 3 \\sin^2 \\lambda}.\n$$\n\n粒子的赤道投掷角为 $\\alpha_{eq}$，定义为 $\\tan \\alpha_{eq} = v_\\perp(0)/v_\\parallel(0)$，其中 $v_\\perp(0)$ 和 $v_\\parallel(0)$ 是在磁赤道处速度的垂直分量和平行分量。在静磁场中的导心近似下，总动能和磁矩是守恒的：\n$$\nE = \\tfrac{1}{2} m v^2 = \\text{constant}, \\quad \\mu = \\frac{m v_\\perp^2}{2 B} = \\text{constant}.\n$$\n\n根据磁镜条件，磁镜纬度 $\\lambda_m$ 满足\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B(\\lambda_m)},\n$$\n该式在给定 $\\alpha_{eq}$ 的情况下确定了 $\\lambda_m$。\n\n用于描述反弹运动的第二绝热不变量（纵向不变量）定义为平行正则动量在两个磁镜点之间的线积分，\n$$\nJ = \\oint p_\\parallel \\, ds,\n$$\n其中，对于非相对论粒子，$p_\\parallel = m v_\\parallel$，积分路径是沿磁力线从一个磁镜点到另一个磁镜点。利用关于磁赤道的对称性，该积分可以写为从赤道到北磁镜点积分的两倍。\n\n你的任务是编写一个程序，该程序：\n- 对每个指定的测试用例，根据磁镜条件数值求解磁镜纬度 $\\lambda_m$（以度为单位）。\n- 利用 $E$ 和 $\\mu$ 的守恒，将 $v_\\parallel(\\lambda)$ 表示为 $\\alpha_{eq}$、$E$、$m$、$B(\\lambda)$ 和 $B_{eq}(L)$ 的函数，并通过沿磁力线从赤道到 $\\lambda_m$ 进行积分，然后乘以 $2$ 以计入两个半球，来数值计算纵向不变量 $J$。\n\n常数和单位：\n- 在整个计算过程中使用国际单位制（SI）。取行星半径 $R_p = 6.371 \\times 10^6\\ \\mathrm{m}$，赤道表面磁场强度大小 $B_0 = 3.12 \\times 10^{-5}\\ \\mathrm{T}$，质子质量 $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$，以及基本电荷 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n- 将粒子视为质量为 $m = m_p$ 的质子。\n- 测试套件中输入的动能 $E$ 以千电子伏特（keV）为单位，因此需使用 $E\\ [\\mathrm{J}] = E\\ [\\mathrm{keV}] \\times 10^3 \\times e$ 将 $E$ 从 $\\mathrm{keV}$ 转换为 $\\mathrm{J}$。\n- 在测试套件中以及报告磁镜纬度 $\\lambda_m$ 时使用度作为角度单位；程序内部可以使用弧度。\n- 最终的纵向不变量 $J$ 以 $\\mathrm{kg\\ m^2\\ s^{-1}}$ 为单位表示。\n\n测试套件：\n- 情况 1：$E = 10\\ \\mathrm{keV}$，$\\alpha_{eq} = 60^\\circ$，$L = 4$。\n- 情况 2：$E = 1\\ \\mathrm{keV}$，$\\alpha_{eq} = 85^\\circ$，$L = 6$。\n- 情况 3：$E = 100\\ \\mathrm{keV}$，$\\alpha_{eq} = 30^\\circ$，$L = 3$。\n- 情况 4：$E = 50\\ \\mathrm{keV}$，$\\alpha_{eq} = 5^\\circ$，$L = 5$。\n- 情况 5：$E = 20\\ \\mathrm{keV}$，$\\alpha_{eq} = 75^\\circ$，$L = 8$。\n\n你的程序应生成单行输出，其中包含结果，格式为方括号内以逗号分隔的列表，形式如下\n$$\n\\big[\\,[\\lambda_{m,1}, J_1],\\,[\\lambda_{m,2}, J_2],\\,\\dots\\,\\big],\n$$\n其中每个 $\\lambda_{m,i}$ 是以度为单位的磁镜纬度，每个 $J_i$ 是为相应测试用例计算的以 $\\mathrm{kg\\ m^2\\ s^{-1}}$ 为单位的纵向不变量。",
            "solution": "问题陈述被评估为有效。这是一个来自天体物理等离子体物理领域的、定义明确且具有科学依据的问题。问题本身是自洽的，提供了所有必要的物理原理、方程和常数，从而可以得到唯一且有意义的解。该任务要求在偶极磁场中应用导心理论和绝热不变量的标准概念，这是该学科的一个基本课题。\n\n求解过程主要分为两个阶段：首先，通过解一个超越方程来确定磁镜纬度 $\\lambda_m$；其次，通过计算一个定积分来评估第二绝热不变量 $J$。\n\n**第 1 部分：确定磁镜纬度 $\\lambda_m$**\n\n带电粒子在汇聚磁场中的运动轨迹以一个“磁镜点”为特征，在该点，其平行于磁场线的速度分量 $v_\\parallel$ 变为零，粒子被反射。这一现象的发生是由于第一绝热不变量（磁矩）$\\mu = \\frac{m v_\\perp^2}{2B}$ 和总动能 $E = \\frac{1}{2}mv^2$ 的守恒。\n\n在纬度 $\\lambda_m$ 发生磁镜反射的条件由赤道投掷角 $\\alpha_{eq}$ 与赤道处的磁场强度 $B_{eq}(L)$ 和磁镜点处的磁场强度 $B(\\lambda_m)$ 之间的关系给出：\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B(\\lambda_m)}\n$$\n问题给出了沿偶极磁力线的磁场强度大小作为磁纬 $\\lambda$ 的函数表达式：\n$$\nB(\\lambda) = B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda}\n$$\n通过将其代入磁镜条件，我们得到一个仅含 $\\lambda_m$ 和已知 $\\alpha_{eq}$ 的方程：\n$$\n\\sin^2 \\alpha_{eq} = \\frac{B_{eq}(L)}{B_{eq}(L)\\,\\frac{\\sqrt{1 + 3 \\sin^2 \\lambda_m}}{\\cos^6 \\lambda_m}} = \\frac{\\cos^6 \\lambda_m}{\\sqrt{1 + 3 \\sin^2 \\lambda_m}}\n$$\n这是一个关于 $\\lambda_m$ 的超越方程。为了便于数值求解，我们定义一个函数 $f(\\lambda)$，其根对应于 $\\lambda_m$：\n$$\nf(\\lambda) = \\frac{\\cos^6 \\lambda}{\\sqrt{1 + 3 \\sin^2 \\lambda}} - \\sin^2 \\alpha_{eq} = 0\n$$\n解 $\\lambda_m$ 位于区间 $[0, \\pi/2]$ 弧度内。像 Brent-Dekker 方法这样的数值求根算法适合于找到满足此方程的 $\\lambda_m$ 的值。\n\n**第 2 部分：评估第二绝热不变量 $J$**\n\n第二绝热不变量，或称纵向不变量 $J$，与粒子在其两个磁镜点之间的周期性“反弹”运动相关。它被定义为平行方向动量 $p_\\parallel = m v_\\parallel$ 在一个完整反弹周期内的线积分：\n$$\nJ = \\oint p_\\parallel \\, ds\n$$\n积分路径沿磁力线进行。由于偶极磁场相对于磁赤道的对称性，整个反弹周期（从 $-\\lambda_m$ 到 $+\\lambda_m$）的积分是从赤道（$\\lambda=0$）到一个磁镜点（$\\lambda_m$）积分的两倍：\n$$\nJ = 2 \\int_{0}^{\\lambda_m} m v_\\parallel(\\lambda) \\, ds\n$$\n该积分必须表示为以纬度 $\\lambda$ 为积分变量的形式。弧长微分 $ds$ 由下式给出：\n$$\nds = L R_p \\cos \\lambda \\,\\sqrt{1 + 3 \\sin^2 \\lambda} \\, d\\lambda\n$$\n平行速度 $v_\\parallel(\\lambda)$ 由能量守恒和磁矩守恒确定。由于总能量 $E$ 守恒，粒子的速率 $v = \\sqrt{2E/m}$ 是恒定的。速度分量满足 $v^2 = v_\\parallel^2 + v_\\perp^2$。$\\mu$ 的守恒意味着 $\\frac{v_\\perp(\\lambda)^2}{B(\\lambda)} = \\frac{v_\\perp(0)^2}{B_{eq}(L)}$，其中 $v_\\perp(0) = v \\sin \\alpha_{eq}$ 是在赤道处的垂直速度。这得到：\n$$\nv_\\perp(\\lambda)^2 = v^2 \\sin^2 \\alpha_{eq} \\frac{B(\\lambda)}{B_{eq}(L)}\n$$\n因此，平行速度的平方为：\n$$\nv_\\parallel(\\lambda)^2 = v^2 - v_\\perp(\\lambda)^2 = v^2 \\left( 1 - \\sin^2 \\alpha_{eq} \\frac{B(\\lambda)}{B_{eq}(L)} \\right)\n$$\n取平方根得到指向远离赤道方向的速度分量：\n$$\nv_\\parallel(\\lambda) = v \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}}\n$$\n将所有分量代入 $J$ 的积分式中：\n$$\nJ = 2 \\int_{0}^{\\lambda_m} m \\left( \\sqrt{\\frac{2E}{m}} \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}} \\right) \\left( L R_p \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\right) d\\lambda\n$$\n此表达式简化为：\n$$\nJ = 2 \\sqrt{2mE} \\, L R_p \\int_{0}^{\\lambda_m} \\sqrt{1 - \\frac{B(\\lambda)}{B_{eq}(L)} \\sin^2 \\alpha_{eq}} \\, \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\, d\\lambda\n$$\n通过代入比率 $B(\\lambda)/B_{eq}(L)$ 的公式，我们得到被积函数的最终形式：\n$$\nJ = 2 \\sqrt{2mE} \\, L R_p \\int_{0}^{\\lambda_m} \\sqrt{1 - \\left( \\frac{\\sqrt{1 + 3 \\sin^2 \\lambda}}{\\cos^6 \\lambda} \\right) \\sin^2 \\alpha_{eq}} \\, \\left( \\cos \\lambda \\sqrt{1 + 3 \\sin^2 \\lambda} \\right) \\, d\\lambda\n$$\n该定积分没有封闭形式的解析解，必须使用合适的求积算法进行数值计算。\n\n**计算步骤**\n\n每个测试用例的总体流程如下：\n$1$。 将输入参数（$E$ 从 $\\mathrm{keV}$ 转换为焦耳，$\\alpha_{eq}$ 从度转换为弧度）转换为国际单位制（SI）单位。\n$2$。 使用提供的物理常数：$R_p = 6.371 \\times 10^6\\ \\mathrm{m}$，$m = m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$，以及 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n$3$。 对方程 $f(\\lambda)=0$ 使用求根方法，数值求解磁镜纬度 $\\lambda_m$（以弧度为单位）。\n$4$。 数值计算 $J$ 的积分，积分范围从 $\\lambda=0$ 到已确定的 $\\lambda_m$。\n$5$。 汇总最终结果，将 $\\lambda_m$ 转换回度以用于输出，并按指定格式呈现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize, integrate\n\ndef solve():\n    \"\"\"\n    Computes the mirror latitude and second adiabatic invariant for a proton\n    in a dipole magnetic field for a given set of test cases.\n    \"\"\"\n    # Define physical constants in SI units.\n    R_p = 6.371e6  # Planetary radius (m)\n    B_0 = 3.12e-5  # Equatorial surface field magnitude (T)\n    m_p = 1.67262192369e-27  # Proton mass (kg)\n    e = 1.602176634e-19  # Elementary charge (C)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E in keV, alpha_eq in degrees, L-shell)\n        (10.0, 60.0, 4.0),\n        (1.0, 85.0, 6.0),\n        (100.0, 30.0, 3.0),\n        (50.0, 5.0, 5.0),\n        (20.0, 75.0, 8.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_kev, alpha_eq_deg, L = case\n\n        # --- Convert inputs to SI units ---\n        E_joule = E_kev * 1000.0 * e\n        alpha_eq_rad = np.deg2rad(alpha_eq_deg)\n\n        # --- Step 1: Solve for the mirror latitude lambda_m ---\n\n        # Define the function whose root is lambda_m.\n        # f(lam) = cos^6(lam) / sqrt(1 + 3sin^2(lam)) - sin^2(alpha_eq)\n        def lambda_m_func(lam, alpha_rad):\n            sin_lam = np.sin(lam)\n            cos_lam = np.cos(lam)\n            # To avoid division by zero at lam=pi/2, although brentq should not hit it\n            if np.isclose(cos_lam, 0.0):\n                 return -np.sin(alpha_rad)**2\n            term1 = cos_lam**6 / np.sqrt(1.0 + 3.0 * sin_lam**2)\n            term2 = np.sin(alpha_rad)**2\n            return term1 - term2\n\n        # Use Brent's method to find the root in the interval [0, pi/2].\n        # The function value is > 0 at lam=0 and  0 at lam=pi/2,\n        # so a root is guaranteed.\n        try:\n            lambda_m_rad = optimize.brentq(\n                lambda_m_func, 0, np.pi / 2, args=(alpha_eq_rad,)\n            )\n        except ValueError:\n            # This should not happen for the given range of alpha_eq\n            results.append([np.nan, np.nan])\n            continue\n            \n        lambda_m_deg = np.rad2deg(lambda_m_rad)\n\n        # --- Step 2: Evaluate the longitudinal invariant J ---\n        \n        # If alpha_eq = 90 deg, particle mirrors at equator, lambda_m = 0, J = 0.\n        if np.isclose(alpha_eq_deg, 90.0):\n            results.append([0.0, 0.0])\n            continue\n\n        # Define the integrand for the integral part of J.\n        # Integrand = sqrt(1 - (B(lam)/B_eq)*sin^2(alpha_eq)) * (ds/dlam)\n        # where ds/dlam_term = cos(lam) * sqrt(1 + 3sin^2(lam))\n        sin2_alpha_eq = np.sin(alpha_eq_rad)**2\n        def j_integrand(lam):\n            sin_lam = np.sin(lam)\n            cos_lam = np.cos(lam)\n            \n            # The term inside this sqrt approaches 0 as lam -> lambda_m.\n            # It can be numerically unstable if lam slightly exceeds lambda_m\n            # due to integrator step choices. We protect against this.\n            B_ratio = np.sqrt(1.0 + 3.0 * sin_lam**2) / (cos_lam**6)\n            inner_sqrt_term = 1.0 - B_ratio * sin2_alpha_eq\n            if inner_sqrt_term  0: inner_sqrt_term = 0.0\n            \n            sqrt_v_parallel = np.sqrt(inner_sqrt_term)\n            \n            ds_dlam_term = cos_lam * np.sqrt(1.0 + 3.0 * sin_lam**2)\n            \n            return sqrt_v_parallel * ds_dlam_term\n\n        # Numerically integrate from 0 to lambda_m_rad.\n        # quad returns (integral_value, error_estimate). We need the first element.\n        integral_val, _ = integrate.quad(j_integrand, 0, lambda_m_rad, epsabs=1e-12, epsrel=1e-12)\n        \n        # Calculate J using the full formula.\n        prefactor = 2.0 * np.sqrt(2.0 * m_p * E_joule) * L * R_p\n        J = prefactor * integral_val\n\n        results.append([lambda_m_deg, J])\n\n    # Format the final output string as requested.\n    output_str = '[' + ','.join([f'[{res[0]:.15g},{res[1]:.15g}]' for res in results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}