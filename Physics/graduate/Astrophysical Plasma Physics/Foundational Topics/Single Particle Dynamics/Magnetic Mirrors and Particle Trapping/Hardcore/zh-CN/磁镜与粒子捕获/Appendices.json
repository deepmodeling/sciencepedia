{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在建立对磁镜中粒子运动的基本直观认识。通过将磁场最小值附近的区域近似为一个抛物线势阱，我们将推导出粒子弹跳运动的基本属性。这种方法揭示了在小振幅极限下，沿着磁力线的运动可以被简化为简谐振动，从而使我们能够解析地计算弹跳周期和第二绝热不变量。",
            "id": "4219845",
            "problem": "一个质量为 $m$、总速率为 $v$ 的非相对论带电粒子，在磁场强度最小值 $s=0$ 附近，沿着一条磁力线进行小振幅的往返运动，其中 $s$ 是沿磁力线的弧长。在最小值附近，磁场强度大小由模型 $B(s)=B_{0}\\left(1+\\lambda s^{2}\\right)$ 描述，其中 $B_{0}>0$ 和 $\\lambda>0$ 为常数。假设在缓变磁场中为导心运动，磁矩 $\\mu$ 守恒，且总动能守恒。设在最小值处的投掷角为 $\\alpha_{0}$，其定义为 $v_{\\perp}(0)=v\\sin\\alpha_{0}$ 和 $v_{\\parallel}(0)=v\\cos\\alpha_{0}$，其中 $v_{\\perp}$ 和 $v_{\\parallel}$ 分别是垂直于磁场和平行于磁场的速度分量，在 $s=0$ 处取值。\n\n请仅使用静磁场中单个粒子运动的基本守恒定律以及关于磁场强度最小值的小振幅近似，推导以下物理量的闭式表达式：\n- 往返周期 $\\tau_{b}$，以及\n- 第二绝热不变量（此处定义为未归一化的围道积分）$J=\\oint p_{\\parallel}\\,ds$，其中 $p_{\\parallel}=m v_{\\parallel}$ 是在没有静电势的静磁场中运动的平行正则动量。\n\n你的推导必须从第一性原理出发，并应明确说明所使用的任何近似。将 $\\tau_{b}$ 以秒为单位表示，将 $J$ 以千克·米²/秒为单位表示，两者均表示为含 $m$、$v$、$\\alpha_{0}$、$B_{0}$ 和 $\\lambda$ 的解析表达式。取 $\\alpha_{0}$ 的单位为弧度。不要进行数值计算。将你的最终答案表示为单个行向量 $\\left(\\tau_{b},\\,J\\right)$。\n\n最后，在你的推理中，评论在小振幅极限下 $\\tau_{b}$ 和 $J$ 如何随 $\\lambda$ 缩放，但你的最终答案必须只包含所要求的表达式。",
            "solution": "该问题是有效的，因为它在科学上基于等离子体物理学（导心理论）的原理，问题提法良好，信息充分，可得到唯一解，并且其表述是客观的。我们可以开始推导。\n\n非相对论带电粒子的运动受静磁场中两个基本守恒定律的支配：\n1. 总动能 $E$ 守恒。给定总速率 $v$，能量为 $E = \\frac{1}{2}mv^2$。速率由平行于磁力线的分量 ($v_{\\parallel}$) 和垂直于磁力线的分量 ($v_{\\perp}$) 组成，因此 $v^2 = v_{\\parallel}^2(s) + v_{\\perp}^2(s) = \\text{常数}$。\n2. 对于缓变磁场，第一绝热不变量，或称磁矩 $\\mu$，是守恒的。其定义为 $\\mu = \\frac{m v_{\\perp}^2(s)}{2B(s)} = \\text{常数}$。\n\n我们可以在磁场最小值 $s=0$ 处计算常数 $\\mu$，在该点 $B(0) = B_0$，$v_{\\perp}(0) = v\\sin\\alpha_0$ 且 $v_{\\parallel}(0) = v\\cos\\alpha_0$。\n$$\n\\mu = \\frac{m v_{\\perp}^2(0)}{2B(0)} = \\frac{m (v\\sin\\alpha_0)^2}{2B_0} = \\frac{mv^2\\sin^2\\alpha_0}{2B_0}\n$$\n$\\mu$ 的这个值在粒子的整个往返运动中保持不变。\n\n利用 $\\mu$ 守恒，我们可以将任意位置 $s$ 处的垂直速率表示为 $v_{\\perp}^2(s) = \\frac{2\\mu B(s)}{m}$。代入给定的磁场 $B(s) = B_0(1+\\lambda s^2)$ 和 $\\mu$ 的表达式：\n$$\nv_{\\perp}^2(s) = \\frac{2}{m} \\left( \\frac{mv^2\\sin^2\\alpha_0}{2B_0} \\right) B_0(1+\\lambda s^2) = v^2\\sin^2\\alpha_0(1+\\lambda s^2)\n$$\n现在，利用能量守恒，我们可以求出平行速率 $v_{\\parallel}(s)$:\n$$\nv_{\\parallel}^2(s) = v^2 - v_{\\perp}^2(s) = v^2 - v^2\\sin^2\\alpha_0(1+\\lambda s^2)\n$$\n$$\nv_{\\parallel}^2(s) = v^2(1 - \\sin^2\\alpha_0 - \\lambda s^2\\sin^2\\alpha_0) = v^2(\\cos^2\\alpha_0 - \\lambda s^2\\sin^2\\alpha_0)\n$$\n这个方程描述了粒子的平行运动。粒子被捕获并在两个转折点 $s = \\pm s_m$ 之间往返运动，在转折点处 $v_{\\parallel}(\\pm s_m) = 0$。\n$$\nv^2(\\cos^2\\alpha_0 - \\lambda s_m^2\\sin^2\\alpha_0) = 0 \\implies s_m^2 = \\frac{\\cos^2\\alpha_0}{\\lambda \\sin^2\\alpha_0} = \\frac{\\cot^2\\alpha_0}{\\lambda}\n$$\n转折点位于 $s_m = \\frac{|\\cot\\alpha_0|}{\\sqrt{\\lambda}}$。为了有非平凡的往返运动，我们假设 $\\alpha_0 \\in (0, \\pi/2)$。\n\n为了求出往返周期 $\\tau_b$，我们可以分析平行运动方程。作用在导心上的平行力是 $F_{\\parallel} = -\\mu \\frac{\\partial B}{\\partial s}$。根据 $B(s) = B_0(1+\\lambda s^2)$，我们有 $\\frac{\\partial B}{\\partial s} = 2B_0\\lambda s$。\n运动方程为 $m \\frac{d v_{\\parallel}}{dt} = F_{\\parallel}$。\n$$\nm \\frac{d^2s}{dt^2} = m \\frac{d v_{\\parallel}}{dt} = m v_{\\parallel} \\frac{d v_{\\parallel}}{ds} = \\frac{m}{2} \\frac{d(v_{\\parallel}^2)}{ds}\n$$\n使用我们得到的 $v_{\\parallel}^2(s)$ 的表达式：\n$$\n\\frac{d(v_{\\parallel}^2)}{ds} = \\frac{d}{ds} \\left( v^2\\cos^2\\alpha_0 - v^2\\lambda s^2\\sin^2\\alpha_0 \\right) = -2v^2\\lambda s \\sin^2\\alpha_0\n$$\n将此代入运动方程：\n$$\nm \\frac{d^2s}{dt^2} = \\frac{m}{2} (-2v^2\\lambda s \\sin^2\\alpha_0) = -(mv^2\\lambda\\sin^2\\alpha_0)s\n$$\n这是简谐振子的方程，$\\frac{d^2s}{dt^2} + \\omega_b^2 s = 0$，其角频率 $\\omega_b$ 由下式给出：\n$$\n\\omega_b^2 = \\frac{mv^2\\lambda\\sin^2\\alpha_0}{m} = v^2\\lambda\\sin^2\\alpha_0\n$$\n$$\n\\omega_b = v\\sqrt{\\lambda}|\\sin\\alpha_0|\n$$\n对于投掷角 $\\alpha_0 \\in [0, \\pi]$，$\\sin\\alpha_0 \\ge 0$，因此 $\\omega_b = v\\sqrt{\\lambda}\\sin\\alpha_0$。往返周期 $\\tau_b$ 是该振荡的周期：\n$$\n\\tau_b = \\frac{2\\pi}{\\omega_b} = \\frac{2\\pi}{v\\sqrt{\\lambda}\\sin\\alpha_0}\n$$\n对于所提供的抛物线型磁场模型，这个结果是精确的。\n\n接下来，我们推导第二绝热不变量 $J$，其定义为 $J = \\oint p_{\\parallel}\\,ds$，其中 $p_{\\parallel} = mv_{\\parallel}$。该积分是在一个完整的往返周期内进行的。\n粒子以正的 $v_{\\parallel}$ 从 $s=-s_m$ 运动到 $s=+s_m$，然后以负的 $v_{\\parallel}$ 从 $s=+s_m$ 运动到 $s=-s_m$。该积分是 $(s, p_{\\parallel})$ 相空间中轨迹所包围的面积。\n$$\nJ = \\int_{-s_m}^{s_m} m|v_{\\parallel}(s)| \\,ds + \\int_{s_m}^{-s_m} m(-|v_{\\parallel}(s)|) \\,ds = 2\\int_{-s_m}^{s_m} m|v_{\\parallel}(s)| \\,ds = 4\\int_{0}^{s_m} m v_{\\parallel}(s) \\,ds\n$$\n代入 $v_{\\parallel}(s)$ 的表达式：\n$$\nJ = 4m \\int_{0}^{s_m} v\\sqrt{\\cos^2\\alpha_0 - \\lambda s^2\\sin^2\\alpha_0} \\,ds = 4m v \\cos\\alpha_0 \\int_{0}^{s_m} \\sqrt{1 - \\frac{\\lambda\\sin^2\\alpha_0}{\\cos^2\\alpha_0}s^2} \\,ds\n$$\n我们进行换元 $u = s \\frac{\\sqrt{\\lambda}\\sin\\alpha_0}{\\cos\\alpha_0} = s\\sqrt{\\lambda}\\tan\\alpha_0$。那么 $ds = \\frac{\\cos\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0}du$。\n积分上限变为 $u(s_m) = s_m \\sqrt{\\lambda}\\tan\\alpha_0 = \\frac{\\cot\\alpha_0}{\\sqrt{\\lambda}} \\sqrt{\\lambda}\\tan\\alpha_0 = 1$。\n$$\nJ = 4mv\\cos\\alpha_0 \\int_{0}^{1} \\sqrt{1-u^2} \\left( \\frac{\\cos\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0} \\right) du = \\frac{4mv\\cos^2\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0} \\int_{0}^{1} \\sqrt{1-u^2} \\,du\n$$\n积分 $\\int_0^1 \\sqrt{1-u^2}du$ 表示单位半径四分之一圆的面积，即 $\\frac{\\pi}{4}$。\n$$\nJ = \\frac{4mv\\cos^2\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0} \\left( \\frac{\\pi}{4} \\right) = \\frac{\\pi m v \\cos^2\\alpha_0}{\\sqrt{\\lambda} \\sin\\alpha_0}\n$$\n\n最后，我们评论一下随 $\\lambda$ 的标度关系。从推导出的表达式可以看出，对于任何固定的初始投掷角 $\\alpha_0$（其中 $\\sin\\alpha_0 \\neq 0$），往返周期和第二绝热不变量都随磁场曲率参数 $\\lambda$ 变化，其标度关系如下：\n$$\n\\tau_b \\propto \\frac{1}{\\sqrt{\\lambda}} \\quad \\text{和} \\quad J \\propto \\frac{1}{\\sqrt{\\lambda}}\n$$\n较大的 $\\lambda$ 值对应于一个“更陡峭”的磁镜，这会导致更强的约束力、更短的往返路径，从而导致更短的往返周期。第二不变量也类似地缩放。\n\n所推导量的单位符合要求：\n$\\tau_b$ 的单位是 $\\frac{1}{(\\text{m}/\\text{s})\\cdot(\\text{m}^{-1})} = \\text{s}$。\n$J$ 的单位是 $\\frac{\\text{kg}\\cdot(\\text{m}/\\text{s})}{\\text{m}^{-1}} = \\text{kg}\\cdot\\text{m}^2/\\text{s}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2\\pi}{v \\sin\\alpha_{0} \\sqrt{\\lambda}}  \\frac{\\pi m v \\cos^2\\alpha_{0}}{\\sin\\alpha_{0} \\sqrt{\\lambda}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基本的弹跳运动之后，我们转向一个更关键的问题：是什么决定了粒子被捕获还是逃逸？本练习通过引入损失锥的概念来解决这个问题，并计算在给定能量下逃逸粒子的比例。为了更贴近真实的等离子体环境，我们还引入了一个平行于磁场的静电势，并研究它如何不对称地影响离子和电子的约束，这是理解磁化等离子体中粒子输运的关键一步。",
            "id": "4219809",
            "problem": "考虑一个无碰撞的磁化天体物理等离子体，被限制在一个对称磁镜中。该磁镜在中平面的磁场强度最小，为 $B_{\\min}$，在两个磁镜喉处的磁场强度最大且相同，为 $B_{\\max}$。定义磁镜比 $R = B_{\\max}/B_{\\min} > 1$。假设系统处于稳定状态，随时间的变化可以忽略不计，并且沿着每条磁力线的静电势变化微弱，使得两侧磁镜喉处的电势 $\\Phi_{\\max}$ 与中平面电势 $\\Phi_{\\min}$ 之差为一个常数 $\\Delta \\Phi = \\Phi_{\\max} - \\Phi_{\\min}$。角度以弧度为单位。\n\n在 $B_{\\min}$ 处，每种粒子（离子和电子）的速度分布是双各向同性的：对于中平面上任意固定的动能 $\\mathcal{E}$，投掷角 $\\alpha$ 的分布在速度空间的单位球面上是各向同性的。在静磁极限下，等离子体遵循导心绝热不变量：第一绝热不变量（磁矩）守恒和总能量 $m v^{2}/2 + q \\Phi$ 守恒，其中 $m$ 是粒子质量，$v$ 是其速率，$q$ 是其电荷。\n\n一个以投掷角 $\\alpha$ 和中平面动能 $\\mathcal{E}$ 从 $B_{\\min}$ 处开始运动的粒子，如果它在到达任一磁镜喉之前没有被反射，则会损失；其边界是在 $B_{\\min}$ 处的损失锥，半角为 $\\alpha_{\\mathrm{L}}(\\mathcal{E})$。假设对于两种粒子，能量范围满足 $0  \\frac{\\mathcal{E} - q \\Delta \\Phi}{\\mathcal{E} R}  1$，从而保证损失锥是良定义且非简并的。\n\n在这些条件下，推导在 $B_{\\min}$ 处，速度方向位于双侧损失锥内的粒子所占的比例。该比例是动能 $\\mathcal{E}$ 的函数，需要分别针对电荷为 $q_{i} = Z e$ 的离子（其中 $Z$ 是离子电荷态，$e$ 是元电荷）和电荷为 $q_{e} = -e$ 的电子进行推导。请用 $\\mathcal{E}$、$R$、$\\Delta \\Phi$、$Z$ 和 $e$ 表示你的最终答案，形式为一对封闭解析表达式。无需进行数值计算。按 $\\left(f_{i}(\\mathcal{E}),\\, f_{e}(\\mathcal{E})\\right)$ 的顺序给出这对表达式，其中 $f_{s}(\\mathcal{E})$ 表示粒子种类 $s$ 的双侧损失锥比例。如果中间步骤出现角度，必须以弧度为单位。最终表达式必须是无量纲的。",
            "solution": "问题要求计算在一个包含平行静电势差的对称磁镜中，粒子速度方向位于双侧损失锥内的比例。我们将通过首先推导损失锥半角 $\\alpha_{\\mathrm{L}}$ 的一般表达式，然后计算相应的立体角，来分别确定离子和电子的这一比例。\n\n根据给定假设，一个质量为 $m$、电荷为 $q$ 的粒子遵循两个守恒定律：总能量 $E_{\\text{tot}}$ 守恒和第一绝热不变量（磁矩）$\\mu$ 守恒。\n\n1. 总能量守恒：\n粒子的总能量是其动能 $\\frac{1}{2}mv^2$ 和势能 $q\\Phi$ 的和。这个量沿着粒子的导心轨迹是守恒的。我们用下标 'min' 表示中平面的物理量，用 'max' 表示磁镜喉处的物理量。\n$$ E_{\\text{tot}} = \\frac{1}{2}m v_{\\min}^2 + q \\Phi_{\\min} = \\frac{1}{2}m v_{\\max}^2 + q \\Phi_{\\max} $$\n问题中定义中平面处的动能为 $\\mathcal{E} = \\frac{1}{2}m v_{\\min}^2$。势差为 $\\Delta\\Phi = \\Phi_{\\max} - \\Phi_{\\min}$。将这些代入能量守恒方程得到：\n$$ \\mathcal{E} + q \\Phi_{\\min} = \\frac{1}{2}m v_{\\max}^2 + q (\\Phi_{\\min} + \\Delta\\Phi) $$\n$$ \\mathcal{E} = \\frac{1}{2}m v_{\\max}^2 + q \\Delta\\Phi $$\n由此，我们得到粒子在磁镜喉处的动能 $\\mathcal{E}_{\\max}$：\n$$ \\mathcal{E}_{\\max} = \\frac{1}{2}m v_{\\max}^2 = \\mathcal{E} - q\\Delta\\Phi $$\n为了使粒子能够到达磁镜喉，其动能必须为非负值，即 $\\mathcal{E}_{\\max} \\ge 0$，这意味着 $\\mathcal{E} \\ge q\\Delta\\Phi$。\n\n2. 磁矩守恒：\n磁矩 $\\mu = \\frac{m v_{\\perp}^2}{2B}$ 也是守恒的，其中 $v_{\\perp}$ 是垂直于磁场 $\\mathbf{B}$ 的速度分量。\n$$ \\mu = \\frac{m v_{\\perp, \\min}^2}{2 B_{\\min}} = \\frac{m v_{\\perp, \\max}^2}{2 B_{\\max}} $$\n在中平面处，垂直速度通过 $v_{\\perp, \\min} = v_{\\min} \\sin\\alpha$ 与总速率 $v_{\\min}$ 和投掷角 $\\alpha$ 相关。动能为 $\\mathcal{E} = \\frac{1}{2}m v_{\\min}^2$。我们可以用中平面的物理量来表示 $\\mu$：\n$$ \\mu = \\frac{m (v_{\\min} \\sin\\alpha)^2}{2 B_{\\min}} = \\frac{(\\frac{1}{2}m v_{\\min}^2) \\sin^2\\alpha}{B_{\\min}} = \\frac{\\mathcal{E} \\sin^2\\alpha}{B_{\\min}} $$\n\n3. 损失锥条件：\n如果一个粒子在到达磁镜喉之前被反射，它就是被捕获的。反射发生在平行速度 $v_{\\parallel}$ 变为零的点。在该点，粒子的动能完全是垂直分量，即 $v^2 = v_{\\perp}^2$。如果粒子到达磁镜喉时 $v_{\\parallel, \\max} > 0$，它就会损失。损失锥的边界由临界捕获的粒子定义，即它们恰好在磁镜喉处反射。对于这些粒子，$v_{\\parallel, \\max} = 0$。\n在磁镜喉处，动能为 $\\mathcal{E}_{\\max} = \\frac{1}{2} m v_{\\max}^2 = \\frac{1}{2}m(v_{\\parallel, \\max}^2 + v_{\\perp, \\max}^2)$。\n对于 $v_{\\parallel, \\max} = 0$ 的临界情况，我们有 $\\mathcal{E}_{\\max} = \\frac{1}{2}m v_{\\perp, \\max}^2$。\n根据磁矩守恒，我们有 $\\frac{1}{2}m v_{\\perp, \\max}^2 = \\mu B_{\\max}$。\n因此，对于处于损失锥边界上的粒子：\n$$ \\mathcal{E}_{\\max} = \\mu B_{\\max} $$\n现在我们将用中平面物理量表示的 $\\mathcal{E}_{\\max}$ 和 $\\mu$ 的表达式代入。这个临界粒子的投掷角 $\\alpha$ 就是损失锥半角 $\\alpha_{\\mathrm{L}}(\\mathcal{E})$。\n$$ \\mathcal{E} - q\\Delta\\Phi = \\left(\\frac{\\mathcal{E} \\sin^2\\alpha_{\\mathrm{L}}}{B_{\\min}}\\right) B_{\\max} $$\n使用磁镜比 $R = B_{\\max}/B_{\\min}$，上式变为：\n$$ \\mathcal{E} - q\\Delta\\Phi = \\mathcal{E} R \\sin^2\\alpha_{\\mathrm{L}} $$\n求解 $\\sin^2\\alpha_{\\mathrm{L}}$ 得到损失锥边界的条件：\n$$ \\sin^2\\alpha_{\\mathrm{L}} = \\frac{\\mathcal{E} - q\\Delta\\Phi}{\\mathcal{E} R} $$\n问题陈述中说明了 $0  \\frac{\\mathcal{E} - q \\Delta\\Phi}{\\mathcal{E} R}  1$，这确保了 $0  \\sin^2\\alpha_{\\mathrm{L}}  1$，因此 $\\alpha_{\\mathrm{L}}$ 是一个在 $(0, \\pi/2)$ 范围内的实的、非简并的角度。\n\n4. 损失锥内的方向比例：\n问题陈述中说明了对于固定的能量 $\\mathcal{E}$，速度分布是各向同性的。这意味着粒子速度矢量指向某一立体角的概率与该立体角的大小成正比。因此，损失锥中的粒子比例是损失锥的立体角与球体总立体角 $4\\pi$ 的比值。\n损失锥是双侧的。一侧对应于向一个磁镜喉运动的粒子，其投掷角为 $0 \\le \\alpha  \\alpha_{\\mathrm{L}}$。另一侧对应于向相反磁镜喉运动的粒子，其投掷角为 $\\pi - \\alpha_{\\mathrm{L}}  \\alpha \\le \\pi$。\n半角为 $\\theta$ 的锥体的立体角 $\\Omega$ 通过对立体角元 $d\\Omega = \\sin\\alpha \\, d\\alpha \\, d\\phi$ 在锥体的角范围内积分得到：\n$$ \\Omega(\\theta) = \\int_0^{2\\pi} d\\phi \\int_0^{\\theta} \\sin\\alpha \\, d\\alpha = 2\\pi [-\\cos\\alpha]_0^{\\theta} = 2\\pi(1 - \\cos\\theta) $$\n双侧损失锥的总立体角 $\\Omega_{\\mathrm{L}}$ 是前向锥（半角为 $\\alpha_{\\mathrm{L}}$）和后向锥（有效半角也为 $\\alpha_{\\mathrm{L}}$）的立体角之和：\n$$ \\Omega_{\\mathrm{L}} = \\Omega(\\alpha_{\\mathrm{L}}) + \\Omega(\\alpha_{\\mathrm{L}}) = 2 \\times 2\\pi(1 - \\cos\\alpha_{\\mathrm{L}}) = 4\\pi(1 - \\cos\\alpha_{\\mathrm{L}}) $$\n方向比例 $f(\\mathcal{E})$ 是这个总立体角除以 $4\\pi$：\n$$ f(\\mathcal{E}) = \\frac{\\Omega_{\\mathrm{L}}}{4\\pi} = 1 - \\cos\\alpha_{\\mathrm{L}} $$\n由于 $\\alpha_{\\mathrm{L}} \\in (0, \\pi/2)$，我们可以写出 $\\cos\\alpha_{\\mathrm{L}} = \\sqrt{1 - \\sin^2\\alpha_{\\mathrm{L}}}$。\n代入我们关于 $\\sin^2\\alpha_{\\mathrm{L}}$ 的表达式：\n$$ f(\\mathcal{E}) = 1 - \\sqrt{1 - \\frac{\\mathcal{E} - q\\Delta\\Phi}{\\mathcal{E} R}} $$\n\n5. 离子和电子的表达式：\n我们现在将这个通用公式应用于这两种粒子。\n对于离子（种类 $i$），电荷为 $q_i = Ze$：\n$$ f_i(\\mathcal{E}) = 1 - \\sqrt{1 - \\frac{\\mathcal{E} - Ze\\Delta\\Phi}{\\mathcal{E} R}} $$\n对于电子（种类 $e$），电荷为 $q_e = -e$：\n$$ f_e(\\mathcal{E}) = 1 - \\sqrt{1 - \\frac{\\mathcal{E} - (-e)\\Delta\\Phi}{\\mathcal{E} R}} = 1 - \\sqrt{1 - \\frac{\\mathcal{E} + e\\Delta\\Phi}{\\mathcal{E} R}} $$\n这些分别是离子和电子在双侧损失锥内的方向比例的最终表达式。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1 - \\sqrt{1 - \\frac{\\mathcal{E} - Ze\\Delta\\Phi}{\\mathcal{E} R}}  1 - \\sqrt{1 - \\frac{\\mathcal{E} + e\\Delta\\Phi}{\\mathcal{E} R}} \\end{pmatrix} } $$"
        },
        {
            "introduction": "理论分析为了简化问题，常常将平行弹跳和垂直漂移分开处理。这个综合性练习旨在通过数值模拟将这些运动分量结合起来，从而弥合理论与实际粒子轨道之间的差距。您将编写一个程序来计算引导中心在三维磁瓶中的完整轨迹，同时考虑磁镜力和梯度漂移，最终能够直观地判断粒子在各种初始条件下的约束状态。",
            "id": "4219795",
            "problem": "单个带电粒子在一个静态的三维磁瓶中运动，其磁场沿笛卡尔$z$轴方向，大小在横向和轴向上都有变化。磁场由向量$\\mathbf{B}(x,y,z) = \\hat{\\mathbf{z}}\\, B(x,y,z)$给出，其大小为\n$$\nB(x,y,z) = B_0 \\, \\underbrace{\\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right)}_{\\text{横向因子 } B_t(x,y)} \\, \\underbrace{\\left(1 + \\alpha z^2\\right)}_{\\text{轴向因子 } B_z(z)} ,\n$$\n其中$B_0$是一个恒定的参考磁场（单位为特斯拉），$\\varepsilon$是一个无量纲的横向梯度参数，$L$是一个横向尺度（单位为米），$\\alpha$是一个轴向曲率参数（单位为米$^{-2}$）。可进入的磁瓶区域限制在满足$|z| \\le Z_{\\max}$的位置，超出此范围的粒子被认为已经逃逸。\n\n假设导心近似适用，电场为零，且磁矩$\\mu$是一个绝热不变量。运动被分解为沿$z$轴的平行动力学和在横向$(x,y)$平面内的漂移动力学。平行动力学源于洛伦兹力和磁矩守恒，而横向运动由磁场梯度漂移控制。具体来说：\n- 从洛伦兹力定律$m \\, d\\mathbf{v}/dt = q\\, \\mathbf{v} \\times \\mathbf{B}$和磁矩的定义$\\mu = m v_\\perp^2/(2B)$出发。\n- 在静态磁场中，利用$\\mu$和总动能守恒来获得沿$z$轴的平行运动方程。\n- 使用磁场梯度漂移的标准导心表达式来获得横向漂移速度场。\n\n你必须实现一个算法，该算法能够：\n1. 使用磁场梯度漂移计算在$(x,y)$平面内的漂移轨道。\n2. 在与磁矩和总能量守恒一致的磁镜力作用下，演化沿$z$轴的平行运动。\n3. 将沿$z$轴的平行速度变号的转折点检测为磁镜点。\n4. 在模拟时间内，评估粒子是否保持在磁瓶内的磁镜点之间，且满足$|z| \\le Z_{\\max}$。如果一个粒子表现出至少一次磁镜反射（即检测到$v_\\parallel$中的一个转折点）并且在模拟期间从未越过$|z| > Z_{\\max}$，则认为该粒子被约束。否则，认为它未被约束。\n\n所有角度都必须以弧度指定和解释。所有物理量必须以国际单位制（SI）单位给出和处理：米、秒、千克、库仑和特斯拉。\n\n你的程序必须数值积分控制导心运动的常微分方程（ODE），无需任何外部输入。使用固定时间步长和四阶显式龙格－库塔积分法，以获得稳定和准确的结果。对于转折点检测，使用平行速度的符号变化，并设置一个小的容差，以避免因数值噪声引起的假阳性。\n\n实现以下参数值的测试套件，每个测试案例为一个元组\n$$\n(\\text{物种}, \\, q, \\, m, \\, v_0, \\, \\theta_0, \\, x_0, \\, y_0, \\, z_0, \\, B_0, \\, \\varepsilon, \\, L, \\, \\alpha, \\, Z_{\\max}, \\, T, \\, \\Delta t),\n$$\n其解释为：物种标签（便于人类阅读的字符串）、电荷$q$（单位为库仑）、质量$m$（单位为千克）、初始速率$v_0$（单位为米/秒）、在$z=0$处的初始投掷角$\\theta_0$（单位为弧度）、初始位置$(x_0,y_0,z_0)$（单位为米）、磁场参数$(B_0,\\varepsilon,L,\\alpha)$、轴向边界$Z_{\\max}$（单位为米）、总积分时间$T$（单位为秒）和固定时间步长$\\Delta t$（单位为秒）。对于每个测试案例，根据$v_0$和$\\theta_0$在$z=0$处初始化平行和垂直速度。\n\n使用这些科学上合理的测试案例：\n- 案例1（质子，被捕获）：$(\\text{\"proton\"}, \\, 1.602176634 \\times 10^{-19}, \\, 1.67262192369 \\times 10^{-27}, \\, 1.5\\times 10^{5}, \\, 1.2, \\, 2.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n- 案例2（质子，逃逸）：$(\\text{\"proton\"}, \\, 1.602176634 \\times 10^{-19}, \\, 1.67262192369 \\times 10^{-27}, \\, 1.5\\times 10^{5}, \\, 0.25, \\, 1.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n- 案例3（电子，反向漂移且被捕获）：$(\\text{\"electron\"}, \\, -1.602176634 \\times 10^{-19}, \\, 9.1093837015 \\times 10^{-31}, \\, 2.0\\times 10^{5}, \\, 1.0, \\, -1.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n- 案例4（质子，损失锥边界）：$(\\text{\"proton\"}, \\, 1.602176634 \\times 10^{-19}, \\, 1.67262192369 \\times 10^{-27}, \\, 1.5\\times 10^{5}, \\, 0.4636476090008061, \\, 5.0\\times 10^{3}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$，其中投掷角等于$\\arcsin\\sqrt{1/(1+\\alpha Z_{\\max}^2)}$，这是轴向磁镜比的理论损失锥边界。\n- 案例5（氧离子 $\\text{O}^+$, 被捕获且漂移更强）：$(\\text{\"oxygen\"}, \\, 1.602176634 \\times 10^{-19}, \\, 2.656762 \\times 10^{-26}, \\, 8.0\\times 10^{4}, \\, 1.3, \\, 3.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.50, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n\n你的程序应生成一行输出，其中包含五个案例的结果，形式为一个用方括号括起来的逗号分隔列表。每个元素必须是一个布尔值，表示相应案例的约束情况，并按所列顺序排列。例如，输出必须类似于$[\\text{True},\\text{False},\\text{True},\\text{True},\\text{True}]$，其中每个条目为$\\text{True}$或$\\text{False}$。",
            "solution": "所提出的问题是计算等离子体物理学中一个明确定义的练习，具体涉及带电粒子在静态磁瓶中的导心运动。该问题在科学上基于绝热不变性和导心漂移的原理，这些是磁层物理和聚变等离子体物理的基石。所给的磁场模型虽然是一种理想化（因为对于简化的形式$\\mathbf{B} = \\hat{\\mathbf{z}}B(x,y,z)$，有$\\nabla \\cdot \\mathbf{B} \\neq 0$），但它是一个标准的教学工具，用于研究磁镜和梯度漂移的主要动力学，而无需处理完全自洽场的复杂性。所有参数都已提供，初值问题是适定的，约束标准也是明确的。因此，该问题被认为是有效的，可以构建一个解决方案。\n\n该解决方案需要数值积分粒子导心的运动方程。导心位置由其坐标$(x,y,z)$和其平行于磁场的速度$v_\\parallel$来描述。系统的总状态可以用向量$\\mathbf{Y}(t) = [x(t), y(t), z(t), v_\\parallel(t)]^T$表示。我们必须推导一个一阶常微分方程组（ODE），$\\frac{d\\mathbf{Y}}{dt} = f(\\mathbf{Y})$，然后对其进行数值求解。\n\n首先，我们确定守恒量。在没有电场的静态磁场中，粒子的总动能$E$是守恒的。\n$$ E = \\frac{1}{2}m(v_\\parallel^2 + v_\\perp^2) = \\text{const} $$\n其中$m$是粒子质量，$v_\\parallel$是平行于$\\mathbf{B}$的速度分量，$v_\\perp$是垂直于$\\mathbf{B}$的速度分量。\n\n导心近似假设磁矩$\\mu$是一个绝热不变量。\n$$ \\mu = \\frac{m v_\\perp^2}{2B} = \\text{const} $$\n其中$B = |\\mathbf{B}|$是磁场的大小。\n\n这两个守恒量由初始条件决定。给定初始总速率$v_0$和在初始位置$(x_0, y_0, z_0)$处的投掷角$\\theta_0$，我们有：\n$v_{\\parallel,0} = v_0 \\cos(\\theta_0)$\n$v_{\\perp,0} = v_0 \\sin(\\theta_0)$\n初始磁场大小为$B_{init} = B(x_0, y_0, z_0)$。因此，守恒的能量和磁矩为：\n$$ E = \\frac{1}{2}mv_0^2 $$\n$$ \\mu = \\frac{m v_{\\perp,0}^2}{2 B_{init}} = \\frac{m (v_0 \\sin\\theta_0)^2}{2 B(x_0, y_0, z_0)} $$\n根据这些守恒定律，我们可以表示空间中任意点的平行速度：\n$$ E = \\frac{1}{2}mv_\\parallel^2 + \\mu B(x,y,z) \\implies v_\\parallel(x,y,z) = \\pm \\sqrt{\\frac{2}{m}(E - \\mu B(x,y,z))} $$\n如果$E - \\mu B$在某点变为负值，粒子就会被捕获，这是不可能的。这意味着粒子的运动被限制在$E - \\mu B(x,y,z) \\ge 0$的区域内。$E - \\mu B = 0$的点是磁镜点，在这些点上$v_\\parallel = 0$，粒子的平行运动发生反转。\n\n现在我们推导$\\mathbf{Y}$各分量的显式ODE。\n\n1.  **平行运动（$z$和$v_\\parallel$动力学）：**\n    平行位置的时间演化由下式简单给出\n    $$ \\frac{dz}{dt} = v_\\parallel $$\n    平行加速度由磁镜力$F_\\parallel = -\\mu \\nabla_\\parallel B$驱动。在我们的案例中，磁力线被假定为平行于$z$轴，所以$\\nabla_\\parallel \\approx \\frac{\\partial}{\\partial z}$。\n    $$ m \\frac{dv_\\parallel}{dt} = F_\\parallel = -\\mu \\frac{\\partial B}{\\partial z} $$\n    给定的磁场大小为$B(x,y,z) = B_0 \\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right) \\left(1 + \\alpha z^2\\right)$。其关于$z$的偏导数为：\n    $$ \\frac{\\partial B}{\\partial z} = B_0 \\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right) (2\\alpha z) $$\n    因此，平行加速度为：\n    $$ \\frac{dv_\\parallel}{dt} = -\\frac{\\mu}{m} \\left[ B_0 \\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right) (2\\alpha z) \\right] $$\n\n2.  **横向运动（$x$和$y$动力学）：**\n    导心的横向运动由漂移速度决定。问题指定使用磁场梯度漂移$\\mathbf{v}_{\\nabla B}$。\n    $$ \\mathbf{v}_d = \\frac{dx}{dt}\\hat{\\mathbf{x}} + \\frac{dy}{dt}\\hat{\\mathbf{y}} = \\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q} \\frac{\\mathbf{B} \\times \\nabla B}{B^2} $$\n    其中$q$是粒子的电荷。使用近似$\\mathbf{B} \\approx B(x,y,z)\\hat{\\mathbf{z}}$，叉积变为：\n    $$ \\mathbf{B} \\times \\nabla B \\approx B\\hat{\\mathbf{z}} \\times \\left( \\frac{\\partial B}{\\partial x}\\hat{\\mathbf{x}} + \\frac{\\partial B}{\\partial y}\\hat{\\mathbf{y}} \\right) = B \\left( \\frac{\\partial B}{\\partial x}\\hat{\\mathbf{y}} - \\frac{\\partial B}{\\partial y}\\hat{\\mathbf{x}} \\right) $$\n    漂移速度分量为：\n    $$ \\frac{dx}{dt} = -\\frac{\\mu}{q B} \\frac{\\partial B}{\\partial y} \\quad \\text{和} \\quad \\frac{dy}{dt} = \\frac{\\mu}{q B} \\frac{\\partial B}{\\partial x} $$\n    所需的偏导数为：\n    $$ \\frac{\\partial B}{\\partial x} = B_0 \\left(\\frac{2\\varepsilon x}{L^2}\\right)(1+\\alpha z^2) \\quad \\text{和} \\quad \\frac{\\partial B}{\\partial y} = B_0 \\left(\\frac{2\\varepsilon y}{L^2}\\right)(1+\\alpha z^2) $$\n    将这些代入漂移方程：\n    $$ \\frac{dx}{dt} = -\\frac{\\mu}{q} \\frac{1}{B_0 (1 + \\varepsilon\\frac{x^2+y^2}{L^2})(1+\\alpha z^2)} \\left[ B_0 \\left(\\frac{2\\varepsilon y}{L^2}\\right)(1+\\alpha z^2) \\right] = -\\frac{2\\mu\\varepsilon}{qL^2} \\frac{y}{1 + \\varepsilon\\frac{x^2+y^2}{L^2}} $$\n    $$ \\frac{dy}{dt} = \\frac{\\mu}{q} \\frac{1}{B_0 (1 + \\varepsilon\\frac{x^2+y^2}{L^2})(1+\\alpha z^2)} \\left[ B_0 \\left(\\frac{2\\varepsilon x}{L^2}\\right)(1+\\alpha z^2) \\right] = \\frac{2\\mu\\varepsilon}{qL^2} \\frac{x}{1 + \\varepsilon\\frac{x^2+y^2}{L^2}} $$\n    注意，对$z$的依赖性方便地消去了。\n\n完整的ODE系统是：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix} x \\\\ y \\\\ z \\\\ v_\\parallel \\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{2\\mu\\varepsilon}{qL^2} \\frac{y}{1 + \\varepsilon(x^2+y^2)/L^2} \\\\\n\\frac{2\\mu\\varepsilon}{qL^2} \\frac{x}{1 + \\varepsilon(x^2+y^2)/L^2} \\\\\nv_\\parallel \\\\\n-\\frac{2\\mu\\alpha B_0}{m} \\left(1 + \\varepsilon\\frac{x^2+y^2}{L^2}\\right) z\n\\end{pmatrix}\n$$\n该系统使用四阶龙格－库塔（RK4）方法以固定时间步长$\\Delta t$求解。对于在时间$t_n$的状态向量$\\mathbf{Y}_n$，在$t_{n+1} = t_n + \\Delta t$的下一个状态$\\mathbf{Y}_{n+1}$计算如下：\n$$ \\mathbf{k}_1 = f(\\mathbf{Y}_n) $$\n$$ \\mathbf{k}_2 = f(\\mathbf{Y}_n + \\frac{\\Delta t}{2}\\mathbf{k}_1) $$\n$$ \\mathbf{k}_3 = f(\\mathbf{Y}_n + \\frac{\\Delta t}{2}\\mathbf{k}_2) $$\n$$ \\mathbf{k}_4 = f(\\mathbf{Y}_n + \\Delta t\\mathbf{k}_3) $$\n$$ \\mathbf{Y}_{n+1} = \\mathbf{Y}_n + \\frac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4) $$\n模拟从$t=0$进行到$T$。在每一步中，我们检查两个条件：\n1.  **逃逸条件：** 如果$|z(t)| > Z_{\\max}$，粒子已经逃逸。该案例的模拟终止，粒子被标记为未约束。\n2.  **反射条件：** 我们监控$v_\\parallel$的符号。如果$v_\\parallel(t_{n+1})$的符号与$v_\\parallel(t_n)$不同，则发生了一次磁镜反射。设置一个标志来记录此事件。\n\n如果一个粒子在模拟时间$T$结束时，经历了至少一次反射并且从未突破$|z| \\le Z_{\\max}$边界，则认为它是被约束的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the guiding-center motion problem for a set of test cases.\n    \"\"\"\n    # Test cases as provided in the problem description. Each tuple contains:\n    # (species, q, m, v0, theta0, x0, y0, z0, B0, eps, L, alpha, Z_max, T, dt)\n    test_cases = [\n        # Case 1 (proton, trapped)\n        (\"proton\", 1.602176634e-19, 1.67262192369e-27, 1.5e5, 1.2, 2.0e4, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 2 (proton, escaping)\n        (\"proton\", 1.602176634e-19, 1.67262192369e-27, 1.5e5, 0.25, 1.0e4, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 3 (electron, trapped with reversed drift)\n        (\"electron\", -1.602176634e-19, 9.1093837015e-31, 2.0e5, 1.0, -1.0e4, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 4 (proton, loss-cone boundary)\n        (\"proton\", 1.602176634e-19, 1.67262192369e-27, 1.5e5, 0.4636476090008061, 5.0e3, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 5 (oxygen ion O+, trapped with stronger drift)\n        (\"oxygen\", 1.602176634e-19, 2.656762e-26, 8.0e4, 1.3, 3.0e4, 0.0, 0.0, 2.0e-5, 0.50, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        _, q, m, v0, theta0, x0, y0, z0, B0, eps, L, alpha, Z_max, T, dt = case\n\n        # --- Initialization ---\n        # Magnetic field magnitude at the initial position\n        B_init = B0 * (1 + eps * (x0**2 + y0**2) / L**2) * (1 + alpha * z0**2)\n\n        # Initial parallel and perpendicular velocities\n        v_par0 = v0 * np.cos(theta0)\n        v_perp0 = v0 * np.sin(theta0)\n        \n        # Conserved quantities: magnetic moment mu\n        # Energy E = 0.5 * m * v0**2 is implicitly conserved by the EOMs\n        mu = (m * v_perp0**2) / (2 * B_init)\n\n        # State vector: Y = [x, y, z, v_parallel]\n        Y = np.array([x0, y0, z0, v_par0], dtype=float)\n\n        # Simulation control flags\n        has_reflected = False\n        is_confined = True\n\n        # Pre-calculate constants for the ODE function\n        C1 = (2 * mu * eps) / (q * L**2)\n        C2 = (2 * mu * alpha * B0) / m\n\n        def derivatives(state):\n            x, y, z, v_par = state\n            \n            # Transverse drift components (dx/dt, dy/dt)\n            transverse_denominator = 1 + eps * (x**2 + y**2) / L**2\n            dx_dt = -C1 * y / transverse_denominator\n            dy_dt = C1 * x / transverse_denominator\n            \n            # Parallel motion components (dz/dt, dv_par/dt)\n            dz_dt = v_par\n            dv_par_dt = -C2 * (1 + eps * (x**2 + y**2) / L**2) * z\n            \n            return np.array([dx_dt, dy_dt, dz_dt, dv_par_dt])\n\n        num_steps = int(T / dt)\n        \n        v_par_previous = v_par0\n        for _ in range(num_steps):\n            # --- RK4 Integration Step ---\n            k1 = derivatives(Y)\n            k2 = derivatives(Y + 0.5 * dt * k1)\n            k3 = derivatives(Y + 0.5 * dt * k2)\n            k4 = derivatives(Y + dt * k3)\n            Y += (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n            \n            z_current = Y[2]\n            v_par_current = Y[3]\n\n            # --- Confinement and Reflection Checks ---\n            # Check for escape\n            if abs(z_current) > Z_max:\n                is_confined = False\n                break\n            \n            # Check for reflection (turning point in z-motion)\n            if not has_reflected:\n                # A sign change indicates a reflection.\n                # A small tolerance is implicitly handled by the sign check being robust\n                # against v_par being exactly zero.\n                if np.sign(v_par_current) != np.sign(v_par_previous) and v_par_previous != 0:\n                    has_reflected = True\n            \n            v_par_previous = v_par_current\n\n        # Final verdict for the case\n        # Confined means it stayed within Z_max AND reflected at least once\n        results.append(is_confined and has_reflected)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}