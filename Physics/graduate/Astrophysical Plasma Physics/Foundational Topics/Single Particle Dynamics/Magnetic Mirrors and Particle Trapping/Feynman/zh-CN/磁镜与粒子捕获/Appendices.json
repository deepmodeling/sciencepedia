{
    "hands_on_practices": [
        {
            "introduction": "要理解粒子俘获的本质，我们首先需要深入分析单次反弹的动力学过程。本练习将磁场最小值附近的磁场建模为一个抛物线势阱，这是一种在许多物理系统中都很有用的近似。通过这一近似，我们可以证明粒子的平行运动是简谐运动，从而推导出反弹周期和第二绝热不变量等基本物理量，为理解被俘获粒子的振荡特性奠定清晰的解析基础 。",
            "id": "4219845",
            "problem": "一个质量为 $m$、总速率为 $v$ 的非相对论带电粒子，在场强最小值 $s=0$ 附近沿一条磁感线进行小振幅的往返运动，其中 $s$ 是沿磁感线的弧长。在该最小值附近，磁场大小由模型 $B(s)=B_{0}\\left(1+\\lambda s^{2}\\right)$ 描述，其中 $B_{0}>0$ 和 $\\lambda>0$ 是常数。假设为导心运动，在缓慢变化的磁场中磁矩 $\\mu$ 守恒，且总动能守恒。设在最小值处的投掷角为 $\\alpha_{0}$，定义为 $v_{\\perp}(0)=v\\sin\\alpha_{0}$ 和 $v_{\\parallel}(0)=v\\cos\\alpha_{0}$，其中 $v_{\\perp}$ 和 $v_{\\parallel}$ 分别是在 $s=0$ 处测得的垂直于和平行于磁场的速率。\n\n仅使用单个粒子在静磁场中运动的基本守恒定律以及关于场强最小值的小振幅近似，推导以下物理量的闭合形式表达式：\n- 往返周期 $\\tau_{b}$ 和\n- 第二绝热不变量（此处定义为未归一化的环路积分）$J=\\oint p_{\\parallel}\\,ds$，其中 $p_{\\parallel}=m v_{\\parallel}$ 是在没有静电势的静磁场中运动的平行正则动量。\n\n你的推导必须从第一性原理出发，并应明确说明所引用的任何近似。将 $\\tau_{b}$ 以秒为单位表示，将 $J$ 以千克·米²/秒为单位表示，两者都表示为关于 $m$、$v$、$\\alpha_{0}$、$B_{0}$ 和 $\\lambda$ 的解析表达式。取 $\\alpha_{0}$ 的单位为弧度。不要进行数值计算。将你的最终答案以单行向量 $\\left(\\tau_{b},\\,J\\right)$ 的形式给出。\n\n最后，在你的推理中，评论在小振幅极限下 $\\tau_{b}$ 和 $J$ 如何随 $\\lambda$ 缩放，但你的最终答案必须只包含所要求的表达式。",
            "solution": "该问题是有效的，因为它在科学上基于等离子体物理学（导心理论）的原理，提法良好，有足够的信息得到唯一解，且其表述是客观的。我们可以开始推导。\n\n非相对论带电粒子的运动受静磁场中两条基本守恒定律的支配：\n1. 总动能 $E$ 守恒。给定总速率 $v$，能量为 $E = \\frac{1}{2}mv^2$。速率由平行于 ($v_{\\parallel}$) 和垂直于 ($v_{\\perp}$) 磁感线的分量组成，所以 $v^2 = v_{\\parallel}^2(s) + v_{\\perp}^2(s) = \\text{常数}$。\n2. 对于缓慢变化的磁场，第一绝热不变量，即磁矩 $\\mu$，是守恒的。它定义为 $\\mu = \\frac{m v_{\\perp}^2(s)}{2B(s)} = \\text{常数}$。\n\n我们可以在磁场最小值 $s=0$ 处计算常数 $\\mu$，在此处 $B(0) = B_0$，$v_{\\perp}(0) = v\\sin\\alpha_0$，$v_{\\parallel}(0) = v\\cos\\alpha_0$。\n$$\n\\mu = \\frac{m v_{\\perp}^2(0)}{2B(0)} = \\frac{m (v\\sin\\alpha_0)^2}{2B_0} = \\frac{mv^2\\sin^2\\alpha_0}{2B_0}\n$$\n在粒子的整个往返运动过程中，这个 $\\mu$ 值是恒定的。\n\n使用 $\\mu$ 守恒，我们可以将任意位置 $s$ 处的垂直速率表示为 $v_{\\perp}^2(s) = \\frac{2\\mu B(s)}{m}$。代入给定的磁场 $B(s) = B_0(1+\\lambda s^2)$ 和 $\\mu$ 的表达式：\n$$\nv_{\\perp}^2(s) = \\frac{2}{m} \\left( \\frac{mv^2\\sin^2\\alpha_0}{2B_0} \\right) B_0(1+\\lambda s^2) = v^2\\sin^2\\alpha_0(1+\\lambda s^2)\n$$\n现在，利用能量守恒，我们可以求出平行速率 $v_{\\parallel}(s)$：\n$$\nv_{\\parallel}^2(s) = v^2 - v_{\\perp}^2(s) = v^2 - v^2\\sin^2\\alpha_0(1+\\lambda s^2)\n$$\n$$\nv_{\\parallel}^2(s) = v^2(1 - \\sin^2\\alpha_0 - \\lambda s^2\\sin^2\\alpha_0) = v^2(\\cos^2\\alpha_0 - \\lambda s^2\\sin^2\\alpha_0)\n$$\n这个方程描述了粒子的平行运动。粒子被捕获并在两个转折点 $s = \\pm s_m$ 之间往返运动，在转折点处 $v_{\\parallel}(\\pm s_m) = 0$。\n$$\nv^2(\\cos^2\\alpha_0 - \\lambda s_m^2\\sin^2\\alpha_0) = 0 \\implies s_m^2 = \\frac{\\cos^2\\alpha_0}{\\lambda \\sin^2\\alpha_0} = \\frac{\\cot^2\\alpha_0}{\\lambda}\n$$\n转折点位于 $s_m = \\frac{|\\cot\\alpha_0|}{\\sqrt{\\lambda}}$。我们假设对于非平凡的往返运动，$\\alpha_0 \\in (0, \\pi/2)$。\n\n为了求出往返周期 $\\tau_b$，我们可以分析平行运动方程。导心上的平行力是 $F_{\\parallel} = -\\mu \\frac{\\partial B}{\\partial s}$。对于 $B(s) = B_0(1+\\lambda s^2)$，我们有 $\\frac{\\partial B}{\\partial s} = 2B_0\\lambda s$。\n运动方程为 $m \\frac{d v_{\\parallel}}{dt} = F_{\\parallel}$。\n$$\nm \\frac{d^2s}{dt^2} = m \\frac{d v_{\\parallel}}{dt} = m v_{\\parallel} \\frac{d v_{\\parallel}}{ds} = \\frac{m}{2} \\frac{d(v_{\\parallel}^2)}{ds}\n$$\n使用我们关于 $v_{\\parallel}^2(s)$ 的表达式：\n$$\n\\frac{d(v_{\\parallel}^2)}{ds} = \\frac{d}{ds} \\left( v^2\\cos^2\\alpha_0 - v^2\\lambda s^2\\sin^2\\alpha_0 \\right) = -2v^2\\lambda s \\sin^2\\alpha_0\n$$\n将此代入运动方程中：\n$$\nm \\frac{d^2s}{dt^2} = \\frac{m}{2} (-2v^2\\lambda s \\sin^2\\alpha_0) = -(mv^2\\lambda\\sin^2\\alpha_0)s\n$$\n这是简谐振子的方程，$\\frac{d^2s}{dt^2} + \\omega_b^2 s = 0$，其角频率 $\\omega_b$ 由下式给出：\n$$\n\\omega_b^2 = \\frac{mv^2\\lambda\\sin^2\\alpha_0}{m} = v^2\\lambda\\sin^2\\alpha_0\n$$\n$$\n\\omega_b = v\\sqrt{\\lambda}|\\sin\\alpha_0|\n$$\n对于投掷角 $\\alpha_0 \\in [0, \\pi]$，$\\sin\\alpha_0 \\ge 0$，所以 $\\omega_b = v\\sqrt{\\lambda}\\sin\\alpha_0$。往返周期 $\\tau_b$ 是该振荡的周期：\n$$\n\\tau_b = \\frac{2\\pi}{\\omega_b} = \\frac{2\\pi}{v\\sqrt{\\lambda}\\sin\\alpha_0}\n$$\n对于所提供的抛物线形磁场模型，这个结果是精确的。\n\n接下来，我们推导第二绝热不变量 $J$，其定义为 $J = \\oint p_{\\parallel}\\,ds$，其中 $p_{\\parallel} = mv_{\\parallel}$。积分是在一个完整的往返周期内进行的。\n粒子以正的 $v_{\\parallel}$ 从 $s=-s_m$ 运动到 $s=+s_m$，并以负的 $v_{\\parallel}$ 从 $s=+s_m$ 运动到 $s=-s_m$。该积分是轨迹在 $(s, p_{\\parallel})$ 相空间中包围的面积。\n$$\nJ = \\int_{-s_m}^{s_m} m|v_{\\parallel}(s)| \\,ds + \\int_{s_m}^{-s_m} m(-|v_{\\parallel}(s)|) \\,ds = 2\\int_{-s_m}^{s_m} m|v_{\\parallel}(s)| \\,ds = 4\\int_{0}^{s_m} m v_{\\parallel}(s) \\,ds\n$$\n代入 $v_{\\parallel}(s)$ 的表达式：\n$$\nJ = 4m \\int_{0}^{s_m} v\\sqrt{\\cos^2\\alpha_0 - \\lambda s^2\\sin^2\\alpha_0} \\,ds = 4m v \\cos\\alpha_0 \\int_{0}^{s_m} \\sqrt{1 - \\frac{\\lambda\\sin^2\\alpha_0}{\\cos^2\\alpha_0}s^2} \\,ds\n$$\n让我们进行换元 $u = s \\frac{\\sqrt{\\lambda}\\sin\\alpha_0}{\\cos\\alpha_0} = s\\sqrt{\\lambda}\\tan\\alpha_0$。那么 $ds = \\frac{\\cos\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0}du$。\n积分上限变为 $u(s_m) = s_m \\sqrt{\\lambda}\\tan\\alpha_0 = \\frac{\\cot\\alpha_0}{\\sqrt{\\lambda}} \\sqrt{\\lambda}\\tan\\alpha_0 = 1$。\n$$\nJ = 4mv\\cos\\alpha_0 \\int_{0}^{1} \\sqrt{1-u^2} \\left( \\frac{\\cos\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0} \\right) du = \\frac{4mv\\cos^2\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0} \\int_{0}^{1} \\sqrt{1-u^2} \\,du\n$$\n积分 $\\int_0^1 \\sqrt{1-u^2}du$ 代表单位半径四分之一圆的面积，即 $\\frac{\\pi}{4}$。\n$$\nJ = \\frac{4mv\\cos^2\\alpha_0}{\\sqrt{\\lambda}\\sin\\alpha_0} \\left( \\frac{\\pi}{4} \\right) = \\frac{\\pi m v \\cos^2\\alpha_0}{\\sqrt{\\lambda} \\sin\\alpha_0}\n$$\n\n最后，我们评论一下随 $\\lambda$ 的缩放关系。从推导出的表达式中，我们可以看到，对于任何固定的初始投掷角 $\\alpha_0$（其中 $\\sin\\alpha_0 \\neq 0$），往返周期和第二绝热不变量都随磁场曲率参数 $\\lambda$ 缩放如下：\n$$\n\\tau_b \\propto \\frac{1}{\\sqrt{\\lambda}} \\quad \\text{和} \\quad J \\propto \\frac{1}{\\sqrt{\\lambda}}\n$$\n较大的 $\\lambda$ 值对应于一个“更陡峭”的磁镜，这会导致更强的约束力、更短的往返路径，从而导致更短的往返周期。第二不变量也类似地缩放。\n\n推导出的物理量的单位符合要求：\n$\\tau_b$ 的单位是 $\\frac{1}{(\\text{m}/\\text{s})\\cdot(\\text{m}^{-1})} = \\text{s}$。\n$J$ 的单位是 $\\frac{\\text{kg}\\cdot(\\text{m}/\\text{s})}{\\text{m}^{-1}} = \\text{kg}\\cdot\\text{m}^2/\\text{s}$。",
            "answer": "$$\n\\boxed{\n\\left( \\frac{2\\pi}{v \\sin\\alpha_{0} \\sqrt{\\lambda}}, \\frac{\\pi m v \\cos^2\\alpha_{0}}{\\sin\\alpha_{0} \\sqrt{\\lambda}} \\right)\n}\n$$"
        },
        {
            "introduction": "现实中的天体物理磁陷阱，例如行星磁层或太阳日冕环中的磁陷阱，通常并非完美对称。本练习将从单个粒子的动力学转向更贴近实际的非对称磁瓶中粒子群的统计行为 。你将推导粒子在两端具有不同最大磁场强度的磁镜中被俘获的条件，并依此计算被俘获粒子的总份额，从而揭示磁场几何构型如何决定其约束效率。",
            "id": "4219789",
            "problem": "一个质量为 $m$、电荷为 $q$ 的无碰撞、磁化的带电粒子，在一个静态磁瓶中沿单条磁场线运动。该磁瓶的场强从中间平面的最小值 $B_{\\min}$ 平滑地变化到两端（分别为 1 端和 2 端）的两个不等的最大值 $B_{\\rm max,1}$ 和 $B_{\\rm max,2}$，且 $B_{\\rm max,1} \\neq B_{\\rm max,2}$。假设其运动可由导心理论很好地描述，并且第一绝热不变量（磁矩）和总动能守恒。在中间平面，粒子的速率大小固定为 $v$，其速度方向在所有立体角上呈各向同性分布。\n\n仅从总动能守恒和第一绝热不变量守恒出发，完成以下任务：\n\n- 推导中间平面投掷角 $\\alpha_0$ 的逃逸（损失锥）条件，该条件决定粒子是会流向 1 端还是 2 端而不会发生磁镜反射。你的条件必须用 $B_{\\min}$ 和相应端的最大场强表示。\n- 利用这些条件和中间平面速度方向的各向同性，计算对应于捕获轨道（即在到达任一端之前发生磁镜反射的轨道）的方向所占的总比例。用两个磁镜比 $R_1 = B_{\\rm max,1}/B_{\\min}$ 和 $R_2 = B_{\\rm max,2}/B_{\\min}$ 表示你最终的捕获比例。\n\n最终答案仅需提供捕获比例关于 $R_1$ 和 $R_2$ 的闭式解析表达式。无需单位，也无需数值四舍五入。",
            "solution": "用户要求我验证并解决一个关于粒子在非对称磁镜中运动的问题。\n\n### 第一步：提取已知条件\n- 一个质量为 $m$、电荷为 $q$ 的无碰撞、磁化的带电粒子。\n- 粒子在一个静态磁瓶中沿单条磁场线运动。\n- 磁场强度 $B$ 平滑变化。\n- $B=B_{\\min}$ 在中间平面（最小值）。\n- $B=B_{\\rm max,1}$ 在一端（最大值，1 端）。\n- $B=B_{\\rm max,2}$ 在另一端（最大值，2 端）。\n- 给定 $B_{\\rm max,1} \\neq B_{\\rm max,2}$。\n- 运动由导心理论描述。\n- 总动能 $E$ 守恒。\n- 第一绝热不变量（磁矩）$\\mu$ 守恒。\n- 在中间平面，粒子的速率大小固定为 $v$。\n- 在中间平面，速度方向是各向同性分布的。\n- 中间平面的投掷角记为 $\\alpha_0$。\n- 磁镜比定义为 $R_1 = B_{\\rm max,1}/B_{\\min}$ 和 $R_2 = B_{\\rm max,2}/B_{\\min}$。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是等离子体物理学中的一个标准基础课题。磁镜、绝热不变量（$\\mu$）、能量守恒、导心近似和损失锥等概念都是该领域公认的支柱。它们对于理解行星磁层、太阳日冕环和实验室聚变装置中的粒子捕获至关重要。该设置在物理上是现实的。\n2.  **适定性**：该问题是适定的。它提供了所有必要的物理原理（守恒定律）、初始条件（中间平面的各向同性速度分布）和边界条件（磁瓶两端的最大场强）。目标是推导特定量（逃逸条件和捕获比例），而所提供的信息足以得出一个唯一且有意义的解。\n3.  **客观性**：该问题以清晰、精确、无歧义的数学和物理术语陈述。没有主观或基于观点的元素。\n4.  **其他缺陷**：该问题并非不完整、矛盾、不现实、不适定或微不足道。这是一个需要严格应用第一性原理的典型问题。非对称性（$R_1 \\neq R_2$）使其成为对更简单的对称情况的非平凡推广。\n\n### 第三步：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n带电粒子的运动受两个守恒定律支配。第一个是总动能 $E$ 守恒：\n$$E = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2) = \\text{常数}$$\n其中 $v_{\\parallel}$ 和 $v_{\\perp}$ 分别是粒子速度平行和垂直于磁场线的分量。\n\n第二个是第一绝热不变量，即磁矩 $\\mu$ 守恒：\n$$\\mu = \\frac{m v_{\\perp}^2}{2 B} = \\text{常数}$$\n其中 $B$ 是磁场的大小。\n\n在中间平面，磁场达到其最小值 $B = B_{\\min}$。粒子的速率为 $v$，投掷角为 $\\alpha_0$。中间平面的速度分量为：\n$$v_{\\parallel,0} = v \\cos(\\alpha_0)$$\n$$v_{\\perp,0} = v \\sin(\\alpha_0)$$\n动能为 $E = \\frac{1}{2}mv^2$。在整个运动过程中守恒的磁矩由其在中间平面的值确定：\n$$\\mu = \\frac{m v_{\\perp,0}^2}{2 B_{\\min}} = \\frac{m (v \\sin(\\alpha_0))^2}{2 B_{\\min}}$$\n在场线上磁场为 $B(s)$ 的任意点，可以从 $\\mu$ 守恒求出垂直速度分量 $v_{\\perp}(s)$：\n$$\\frac{m v_{\\perp}(s)^2}{2 B(s)} = \\frac{m v^2 \\sin^2(\\alpha_0)}{2 B_{\\min}}$$\n$$v_{\\perp}(s)^2 = v^2 \\sin^2(\\alpha_0) \\frac{B(s)}{B_{\\min}}$$\n利用能量守恒，我们可以求出平行速度分量 $v_{\\parallel}(s)$：\n$$v_{\\parallel}(s)^2 = v^2 - v_{\\perp}(s)^2 = v^2 - v^2 \\sin^2(\\alpha_0) \\frac{B(s)}{B_{\\min}} = v^2 \\left(1 - \\frac{B(s)}{B_{\\min}} \\sin^2(\\alpha_0)\\right)$$\n当粒子的平行运动反向时，它会被磁镜反射，这发生在 $v_{\\parallel}(s) = 0$ 的点。设这发生在场强为 $B_{\\text{mirror}}$ 的地方。条件是：\n$$1 - \\frac{B_{\\text{mirror}}}{B_{\\min}} \\sin^2(\\alpha_0) = 0$$\n这就得到了将中间平面投掷角 $\\alpha_0$ 与转折点场强 $B_{\\text{mirror}}$ 联系起来的基本磁镜条件：\n$$\\sin^2(\\alpha_0) = \\frac{B_{\\min}}{B_{\\text{mirror}}}$$\n\n**推导逃逸（损失锥）条件**\n如果粒子的磁镜反射点位于磁瓶的某一端之外，它将从该端逃逸。换言之，反射粒子所需的磁场强度 $B_{\\text{mirror}}$ 大于该端的最大场强 $B_{\\max}$。\n\n要使粒子从 1 端逃逸，它必须在到达 $B = B_{\\rm max,1}$ 的点或之前不发生磁镜反射。因此，逃逸的条件是 $B_{\\text{mirror}} > B_{\\rm max,1}$。使用磁镜条件：\n$$\\frac{B_{\\min}}{\\sin^2(\\alpha_0)} > B_{\\rm max,1}$$\n$$\\sin^2(\\alpha_0)  \\frac{B_{\\min}}{B_{\\rm max,1}}$$\n这是 1 端的逃逸条件。所有满足此条件且初始朝 1 端运动的粒子都将丢失。从 $0$ 到 $\\pi$ 的投掷角范围覆盖了所有可能方向。投掷角为 $0 \\le \\alpha_0  \\pi/2$ 的粒子具有速度分量 $v_{\\parallel,0} > 0$，初始朝一侧（假设为 1 端）运动，而投掷角为 $\\pi/2  \\alpha_0 \\le \\pi$（$v_{\\parallel,0}  0$）的粒子则朝 2 端运动。\n\n1 端的逃逸条件是：\n$$\\sin^2(\\alpha_0)  \\frac{1}{R_1}, \\quad \\text{其中 } R_1 = \\frac{B_{\\rm max,1}}{B_{\\min}}$$\n这定义了 1 端的损失锥。\n\n类似地，要使粒子从 2 端逃逸，它必须满足：\n$$\\sin^2(\\alpha_0)  \\frac{B_{\\min}}{B_{\\rm max,2}}$$\n2 端的逃逸条件是：\n$$\\sin^2(\\alpha_0)  \\frac{1}{R_2}, \\quad \\text{其中 } R_2 = \\frac{B_{\\rm max,2}}{B_{\\min}}$$\n这定义了 2 端的损失锥。\n\n总结来说，为了让粒子逃逸，其在中间平面的投掷角 $\\alpha_0$ 必须足够小（接近 $0$ 或 $\\pi$）。如果它朝向 $k \\in \\{1, 2\\}$ 端运动，当 $\\sin^2(\\alpha_0)  1/R_k$ 时，它将逃逸。\n\n**计算捕获比例**\n问题指出，粒子在中间平面的速度方向是各向同性分布的。在球坐标 $(v, \\alpha_0, \\phi)$ 中，其中 $\\alpha_0$ 是投掷角（极角），$\\phi$ 是方位角，各向同性分布意味着在立体角 $d\\Omega$ 中找到速度矢量的概率是均匀的。微分立体角为 $d\\Omega = \\sin(\\alpha_0) d\\alpha_0 d\\phi$。投掷角 $\\alpha_0 \\in [0, \\pi]$ 的概率分布函数与 $\\sin(\\alpha_0)$ 成正比。将此分布在整个球面上归一化，得到概率密度函数 $p(\\alpha_0)$：\n$$p(\\alpha_0) d\\alpha_0 = \\frac{2\\pi \\sin(\\alpha_0) d\\alpha_0}{\\int_0^{\\pi} 2\\pi \\sin(\\alpha') d\\alpha'} = \\frac{\\sin(\\alpha_0) d\\alpha_0}{[-\\cos(\\alpha')]_0^{\\pi}} = \\frac{1}{2}\\sin(\\alpha_0) d\\alpha_0$$\n如果一个粒子在到达任一端之前发生磁镜反射，则它被捕获。这意味着它必须同时不满足两个逃逸条件。粒子必须满足 $\\sin^2(\\alpha_0) \\ge 1/R_1$ 以从 1 端被反射，且满足 $\\sin^2(\\alpha_0) \\ge 1/R_2$ 以从 2 端被反射。\n\n让我们为每一端定义临界损失锥角 $\\alpha_{L1}$ 和 $\\alpha_{L2}$，其中 $\\alpha_{Lk} \\in [0, \\pi/2]$：\n$$\\sin(\\alpha_{L1}) = \\sqrt{\\frac{1}{R_1}} = \\frac{1}{\\sqrt{R_1}}$$\n$$\\sin(\\alpha_{L2}) = \\sqrt{\\frac{1}{R_2}} = \\frac{1}{\\sqrt{R_2}}$$\n如果粒子处于前向损失锥中，即 $0 \\le \\alpha_0  \\alpha_{L1}$，它将逃逸到 1 端。\n如果粒子处于后向损失锥中，它将逃逸到 2 端。由于 $\\sin(\\pi - \\alpha_0) = \\sin(\\alpha_0)$，这对应于 $\\pi - \\alpha_{L2}  \\alpha_0 \\le \\pi$。\n\n如果一个粒子的投掷角 $\\alpha_0$ 在两个损失锥之外，它就被捕获。因此，被捕获粒子的投掷角范围是：\n$$\\alpha_{L1} \\le \\alpha_0 \\le \\pi - \\alpha_{L2}$$\n被捕获粒子的比例 $F_{\\text{trap}}$ 是概率密度函数在这个捕获范围内的积分：\n$$F_{\\text{trap}} = \\int_{\\alpha_{L1}}^{\\pi - \\alpha_{L2}} \\frac{1}{2} \\sin(\\alpha_0) d\\alpha_0$$\n计算积分为：\n$$F_{\\text{trap}} = \\frac{1}{2} [-\\cos(\\alpha_0)]_{\\alpha_{L1}}^{\\pi - \\alpha_{L2}} = \\frac{1}{2} [-\\cos(\\pi - \\alpha_{L2}) - (-\\cos(\\alpha_{L1}))]$$\n使用恒等式 $\\cos(\\pi - x) = -\\cos(x)$：\n$$F_{\\text{trap}} = \\frac{1}{2} [\\cos(\\alpha_{L2}) + \\cos(\\alpha_{L1})]$$\n我们现在用磁镜比 $R_1$ 和 $R_2$ 来表示 $\\cos(\\alpha_{L1})$ 和 $\\cos(\\alpha_{L2})$。由于 $\\alpha_{L1}$ 和 $\\alpha_{L2}$ 在第一象限，它们的余弦值为正：\n$$\\cos(\\alpha_{L1}) = \\sqrt{1 - \\sin^2(\\alpha_{L1})} = \\sqrt{1 - \\frac{1}{R_1}}$$\n$$\\cos(\\alpha_{L2}) = \\sqrt{1 - \\sin^2(\\alpha_{L2})} = \\sqrt{1 - \\frac{1}{R_2}}$$\n将这些代入 $F_{\\text{trap}}$ 的表达式中：\n$$F_{\\text{trap}} = \\frac{1}{2} \\left(\\sqrt{1 - \\frac{1}{R_1}} + \\sqrt{1 - \\frac{1}{R_2}}\\right)$$\n这就是非对称磁镜中被捕获粒子比例的最终表达式。",
            "answer": "$$\\boxed{\\frac{1}{2}\\left(\\sqrt{1 - \\frac{1}{R_1}} + \\sqrt{1 - \\frac{1}{R_2}}\\right)}$$"
        },
        {
            "introduction": "粒子在磁瓶中的运动不仅包括沿单一磁力线的反弹，还涉及垂直于磁力线的缓慢漂移。这项计算实践要求你建立一个数值模型，该模型同时整合了平行反弹运动和横向梯度漂移 。通过模拟完整的导心轨道，你将能直接检验粒子约束的理论条件，并以可视化的方式理解被俘获粒子在更真实的磁场构型中的复杂三维轨迹。",
            "id": "4219795",
            "problem": "一个带电粒子在静态三维磁瓶中运动，其磁场沿笛卡尔坐标系的 $z$ 轴方向，大小在横向和轴向均发生变化。磁场由向量 $\\mathbf{B}(x,y,z) = \\hat{\\mathbf{z}}\\, B(x,y,z)$ 给出，其大小为\n$$\nB(x,y,z) = B_0 \\, \\underbrace{\\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right)}_{\\text{横向因子 } B_t(x,y)} \\, \\underbrace{\\left(1 + \\alpha z^2\\right)}_{\\text{轴向因子 } B_z(z)} ,\n$$\n其中 $B_0$ 是一个恒定的参考磁场（单位：特斯拉），$\\varepsilon$ 是一个无量纲的横向梯度参数，$L$ 是一个横向尺度（单位：米），$\\alpha$ 是一个轴向曲率参数（单位：米$^{-2}$）。可及的磁瓶区域仅限于满足 $|z| \\le Z_{\\max}$ 的位置，超出此范围的粒子被视为已经逃逸。\n\n假设导心近似适用，电场为零，且磁矩 $\\mu$ 是一个绝热不变量。运动被分解为沿 $z$ 轴的平行动力学和在横向 $(x,y)$ 平面内的漂移动力学。平行动力学源于洛伦兹力和磁矩守恒，而横向运动由磁场梯度漂移控制。具体而言：\n- 从洛伦兹力定律 $m \\, d\\mathbf{v}/dt = q\\, \\mathbf{v} \\times \\mathbf{B}$ 和磁矩的定义 $\\mu = m v_\\perp^2/(2B)$ 出发。\n- 在静态磁场中，利用 $\\mu$ 和总动能的守恒来获得沿 $z$ 轴的平行运动方程。\n- 使用磁场梯度漂移的标准导心表达式来获得横向漂移速度场。\n\n你必须实现一个算法，该算法能够：\n1. 使用磁场梯度漂移计算在 $(x,y)$ 平面内的漂移轨道。\n2. 在与磁矩和总能量守恒一致的磁镜力作用下，演化沿 $z$ 轴的平行运动。\n3. 将沿 $z$ 轴的平行速度变号的转折点检测为磁镜点。\n4. 评估在模拟时间内，粒子是否保持在磁瓶内的磁镜点之间，并满足 $|z| \\le Z_{\\max}$。如果在模拟期间，粒子表现出至少一次磁镜反射（即检测到 $v_\\parallel$ 中的一个转折点），并且从未越过 $|z|  Z_{\\max}$，则认为该粒子被约束。否则，认为其未被约束。\n\n所有角度必须以弧度为单位指定和解释。所有物理量必须以国际标准（SI）单位给出和处理：米、秒、千克、库仑和特斯拉。\n\n你的程序必须数值积分控制导心运动的常微分方程（ODE），无需任何外部输入。使用固定时间步长和四阶显式龙格－库塔（Runge–Kutta）积分法，以获得稳定和准确的结果。对于转折点检测，使用平行速度的符号变化，并设置一个小的容差，以避免由数值噪声引起的假阳性。\n\n实现以下参数值的测试套件，每个测试用例为一个元组\n$$\n(\\text{粒子种类}, \\, q, \\, m, \\, v_0, \\, \\theta_0, \\, x_0, \\, y_0, \\, z_0, \\, B_0, \\, \\varepsilon, \\, L, \\, \\alpha, \\, Z_{\\max}, \\, T, \\, \\Delta t),\n$$\n其解释为：粒子种类标签（供人阅读的字符串）、电荷 $q$（单位：库仑）、质量 $m$（单位：千克）、初始速率 $v_0$（单位：米/秒）、在 $z=0$ 处的初始投掷角 $\\theta_0$（单位：弧度）、初始位置 $(x_0,y_0,z_0)$（单位：米）、磁场参数 $(B_0,\\varepsilon,L,\\alpha)$、轴向边界 $Z_{\\max}$（单位：米）、总积分时间 $T$（单位：秒）和固定时间步长 $\\Delta t$（单位：秒）。对于每个测试用例，根据 $v_0$ 和 $\\theta_0$ 在 $z=0$ 处初始化平行和垂直速度。\n\n使用这些具有科学合理性的测试用例：\n- 用例 1（质子，捕获）：$(\\text{\"proton\"}, \\, 1.602176634 \\times 10^{-19}, \\, 1.67262192369 \\times 10^{-27}, \\, 1.5\\times 10^{5}, \\, 1.2, \\, 2.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n- 用例 2（质子，逃逸）：$(\\text{\"proton\"}, \\, 1.602176634 \\times 10^{-19}, \\, 1.67262192369 \\times 10^{-27}, \\, 1.5\\times 10^{5}, \\, 0.25, \\, 1.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n- 用例 3（电子，反向漂移捕获）：$(\\text{\"electron\"}, \\, -1.602176634 \\times 10^{-19}, \\, 9.1093837015 \\times 10^{-31}, \\, 2.0\\times 10^{5}, \\, 1.0, \\, -1.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n- 用例 4（质子，损失锥边界）：$(\\text{\"proton\"}, \\, 1.602176634 \\times 10^{-19}, \\, 1.67262192369 \\times 10^{-27}, \\, 1.5\\times 10^{5}, \\, 0.4636476090008061, \\, 5.0\\times 10^{3}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.30, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$，其中投掷角等于 $\\arcsin\\sqrt{1/(1+\\alpha Z_{\\max}^2)}$，即轴向磁镜比的理论损失锥边界。\n- 用例 5（氧离子 $\\text{O}^+$, 强漂移捕获）：$(\\text{\"oxygen\"}, \\, 1.602176634 \\times 10^{-19}, \\, 2.656762 \\times 10^{-26}, \\, 8.0\\times 10^{4}, \\, 1.3, \\, 3.0\\times 10^{4}, \\, 0.0, \\, 0.0, \\, 2.0\\times 10^{-5}, \\, 0.50, \\, 1.0\\times 10^{5}, \\, 1.0\\times 10^{-12}, \\, 2.0\\times 10^{6}, \\, 120.0, \\, 0.02)$。\n\n你的程序应该生成单行输出，其中包含五个测试用例的结果，形式为方括号括起来的逗号分隔列表。每个元素必须是对应案例的布尔值，指示其是否被约束，并按所列顺序排列。例如，输出必须看起来像 $[\\text{True},\\text{False},\\text{True},\\text{True},\\text{True}]$，其中每个条目为 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "所提出的问题是计算等离子体物理学中一个明确定义的练习，具体涉及带电粒子在静态磁瓶中的导心运动。该问题在科学上基于绝热不变量和导心漂移的原理，这些是磁层和聚变等离子体物理学的基石。该磁场模型，虽然对于简化的形式 $\\mathbf{B} = \\hat{\\mathbf{z}}B(x,y,z)$ 来说是一个理想化模型（因为 $\\nabla \\cdot \\mathbf{B} \\neq 0$），但它是一种标准的教学工具，用于研究磁镜和梯度漂移的主要动力学，而无需处理完全自洽场的复杂性。所有参数均已提供，初值问题是适定的，约束标准也是明确的。因此，该问题被认为是有效的，可以构建一个解决方案。\n\n该解决方案需要数值积分粒子导心的运动方程。导心位置由其坐标 $(x,y,z)$ 和其平行于磁场的速度 $v_\\parallel$ 描述。系统的总状态可以用向量 $\\mathbf{Y}(t) = [x(t), y(t), z(t), v_\\parallel(t)]^T$ 来表示。我们必须推导出一个一阶常微分方程（ODE）系统 $\\frac{d\\mathbf{Y}}{dt} = f(\\mathbf{Y})$，然后对其进行数值求解。\n\n首先，我们确定守恒量。在没有电场的静态磁场中，粒子的总动能 $E$ 是守恒的。\n$$ E = \\frac{1}{2}m(v_\\parallel^2 + v_\\perp^2) = \\text{const} $$\n其中 $m$ 是粒子质量，$v_\\parallel$ 是平行于 $\\mathbf{B}$ 的速度分量，$v_\\perp$ 是垂直于 $\\mathbf{B}$ 的速度分量。\n\n导心近似假设磁矩 $\\mu$ 是一个绝热不变量。\n$$ \\mu = \\frac{m v_\\perp^2}{2B} = \\text{const} $$\n其中 $B = |\\mathbf{B}|$ 是磁场的大小。\n\n这两个守恒量由初始条件决定。给定初始总速率 $v_0$ 和在初始位置 $(x_0, y_0, z_0)$ 的投掷角 $\\theta_0$，我们有：\n$v_{\\parallel,0} = v_0 \\cos(\\theta_0)$\n$v_{\\perp,0} = v_0 \\sin(\\theta_0)$\n初始磁场大小为 $B_{init} = B(x_0, y_0, z_0)$。因此，守恒的能量和磁矩为：\n$$ E = \\frac{1}{2}mv_0^2 $$\n$$ \\mu = \\frac{m v_{\\perp,0}^2}{2 B_{init}} = \\frac{m (v_0 \\sin\\theta_0)^2}{2 B(x_0, y_0, z_0)} $$\n根据这些守恒定律，我们可以表示出空间中任意一点的平行速度：\n$$ E = \\frac{1}{2}mv_\\parallel^2 + \\mu B(x,y,z) \\implies v_\\parallel(x,y,z) = \\pm \\sqrt{\\frac{2}{m}(E - \\mu B(x,y,z))} $$\n如果 $E - \\mu B$ 在某一点变为负值，粒子就会被捕获，这是不可能的。这意味着粒子的运动被限制在 $E - \\mu B(x,y,z) \\ge 0$ 的区域。$E - \\mu B = 0$ 的点是磁镜点，在这些点上 $v_\\parallel = 0$，粒子的平行运动方向反转。\n\n现在我们推导 $\\mathbf{Y}$ 各分量的显式常微分方程。\n\n1.  **平行运动（$z$ 和 $v_\\parallel$ 动力学）：**\n    平行位置的时间演化简单地由下式给出：\n    $$ \\frac{dz}{dt} = v_\\parallel $$\n    平行加速度由磁镜力 $F_\\parallel = -\\mu \\nabla_\\parallel B$ 驱动。在我们的例子中，假设磁力线平行于 $z$ 轴，所以 $\\nabla_\\parallel \\approx \\frac{\\partial}{\\partial z}$。\n    $$ m \\frac{dv_\\parallel}{dt} = F_\\parallel = -\\mu \\frac{\\partial B}{\\partial z} $$\n    给定的磁场大小为 $B(x,y,z) = B_0 \\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right) \\left(1 + \\alpha z^2\\right)$。其关于 $z$ 的偏导数为：\n    $$ \\frac{\\partial B}{\\partial z} = B_0 \\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right) (2\\alpha z) $$\n    因此，平行加速度为：\n    $$ \\frac{dv_\\parallel}{dt} = -\\frac{\\mu}{m} \\left[ B_0 \\left(1 + \\varepsilon \\frac{x^2 + y^2}{L^2}\\right) (2\\alpha z) \\right] $$\n\n2.  **横向运动（$x$ 和 $y$ 动力学）：**\n    导心的横向运动由漂移速度控制。问题指定使用磁场梯度漂移 $\\mathbf{v}_{\\nabla B}$。\n    $$ \\mathbf{v}_d = \\frac{dx}{dt}\\hat{\\mathbf{x}} + \\frac{dy}{dt}\\hat{\\mathbf{y}} = \\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q} \\frac{\\mathbf{B} \\times \\nabla B}{B^2} $$\n    其中 $q$ 是粒子的电荷。使用近似 $\\mathbf{B} \\approx B(x,y,z)\\hat{\\mathbf{z}}$，叉积变为：\n    $$ \\mathbf{B} \\times \\nabla B \\approx B\\hat{\\mathbf{z}} \\times \\left( \\frac{\\partial B}{\\partial x}\\hat{\\mathbf{x}} + \\frac{\\partial B}{\\partial y}\\hat{\\mathbf{y}} \\right) = B \\left( \\frac{\\partial B}{\\partial x}\\hat{\\mathbf{y}} - \\frac{\\partial B}{\\partial y}\\hat{\\mathbf{x}} \\right) $$\n    漂移速度分量为：\n    $$ \\frac{dx}{dt} = -\\frac{\\mu}{q B} \\frac{\\partial B}{\\partial y} \\quad \\text{和} \\quad \\frac{dy}{dt} = \\frac{\\mu}{q B} \\frac{\\partial B}{\\partial x} $$\n    所需的偏导数为：\n    $$ \\frac{\\partial B}{\\partial x} = B_0 \\left(\\frac{2\\varepsilon x}{L^2}\\right)(1+\\alpha z^2) \\quad \\text{和} \\quad \\frac{\\partial B}{\\partial y} = B_0 \\left(\\frac{2\\varepsilon y}{L^2}\\right)(1+\\alpha z^2) $$\n    将这些代入漂移方程：\n    $$ \\frac{dx}{dt} = -\\frac{\\mu}{q} \\frac{1}{B_0 (1 + \\varepsilon\\frac{x^2+y^2}{L^2})(1+\\alpha z^2)} \\left[ B_0 \\left(\\frac{2\\varepsilon y}{L^2}\\right)(1+\\alpha z^2) \\right] = -\\frac{2\\mu\\varepsilon}{qL^2} \\frac{y}{1 + \\varepsilon\\frac{x^2+y^2}{L^2}} $$\n    $$ \\frac{dy}{dt} = \\frac{\\mu}{q} \\frac{1}{B_0 (1 + \\varepsilon\\frac{x^2+y^2}{L^2})(1+\\alpha z^2)} \\left[ B_0 \\left(\\frac{2\\varepsilon x}{L^2}\\right)(1+\\alpha z^2) \\right] = \\frac{2\\mu\\varepsilon}{qL^2} \\frac{x}{1 + \\varepsilon\\frac{x^2+y^2}{L^2}} $$\n    请注意，$z$ 的依赖关系很方便地消掉了。\n\n完整的常微分方程组为：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix} x \\\\ y \\\\ z \\\\ v_\\parallel \\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{2\\mu\\varepsilon}{qL^2} \\frac{y}{1 + \\varepsilon(x^2+y^2)/L^2} \\\\\n\\frac{2\\mu\\varepsilon}{qL^2} \\frac{x}{1 + \\varepsilon(x^2+y^2)/L^2} \\\\\nv_\\parallel \\\\\n-\\frac{2\\mu\\alpha B_0}{m} \\left(1 + \\varepsilon\\frac{x^2+y^2}{L^2}\\right) z\n\\end{pmatrix}\n$$\n该系统使用四阶龙格－库塔（RK4）方法和固定时间步长 $\\Delta t$ 进行求解。对于时间 $t_n$ 的状态向量 $\\mathbf{Y}_n$，在 $t_{n+1} = t_n + \\Delta t$ 的下一个状态 $\\mathbf{Y}_{n+1}$ 计算如下：\n$$ \\mathbf{k}_1 = f(\\mathbf{Y}_n) $$\n$$ \\mathbf{k}_2 = f(\\mathbf{Y}_n + \\frac{\\Delta t}{2}\\mathbf{k}_1) $$\n$$ \\mathbf{k}_3 = f(\\mathbf{Y}_n + \\frac{\\Delta t}{2}\\mathbf{k}_2) $$\n$$ \\mathbf{k}_4 = f(\\mathbf{Y}_n + \\Delta t\\mathbf{k}_3) $$\n$$ \\mathbf{Y}_{n+1} = \\mathbf{Y}_n + \\frac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4) $$\n模拟从 $t=0$ 进行到 $T$。在每一步，我们检查两个条件：\n1.  **逃逸条件：** 如果 $|z(t)|  Z_{\\max}$，粒子已经逃逸。该案例的模拟终止，粒子被标记为未约束。\n2.  **反射条件：** 我们监视 $v_\\parallel$ 的符号。如果 $v_\\parallel(t_{n+1})$ 与 $v_\\parallel(t_n)$ 的符号不同，则发生了磁镜反射。设置一个标志来记录此事件。\n\n如果在模拟时间 $T$ 结束时，一个粒子经历了至少一次反射并且从未越过 $|z| \\le Z_{\\max}$ 的边界，则认为该粒子被约束。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the guiding-center motion problem for a set of test cases.\n    \"\"\"\n    # Test cases as provided in the problem description. Each tuple contains:\n    # (species, q, m, v0, theta0, x0, y0, z0, B0, eps, L, alpha, Z_max, T, dt)\n    test_cases = [\n        # Case 1 (proton, trapped)\n        (\"proton\", 1.602176634e-19, 1.67262192369e-27, 1.5e5, 1.2, 2.0e4, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 2 (proton, escaping)\n        (\"proton\", 1.602176634e-19, 1.67262192369e-27, 1.5e5, 0.25, 1.0e4, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 3 (electron, trapped with reversed drift)\n        (\"electron\", -1.602176634e-19, 9.1093837015e-31, 2.0e5, 1.0, -1.0e4, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 4 (proton, loss-cone boundary)\n        (\"proton\", 1.602176634e-19, 1.67262192369e-27, 1.5e5, 0.4636476090008061, 5.0e3, 0.0, 0.0, 2.0e-5, 0.30, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02),\n        # Case 5 (oxygen ion O+, trapped with stronger drift)\n        (\"oxygen\", 1.602176634e-19, 2.656762e-26, 8.0e4, 1.3, 3.0e4, 0.0, 0.0, 2.0e-5, 0.50, 1.0e5, 1.0e-12, 2.0e6, 120.0, 0.02)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        _, q, m, v0, theta0, x0, y0, z0, B0, eps, L, alpha, Z_max, T, dt = case\n\n        # --- Initialization ---\n        # Magnetic field magnitude at the initial position\n        B_init = B0 * (1 + eps * (x0**2 + y0**2) / L**2) * (1 + alpha * z0**2)\n\n        # Initial parallel and perpendicular velocities\n        v_par0 = v0 * np.cos(theta0)\n        v_perp0 = v0 * np.sin(theta0)\n        \n        # Conserved quantities: magnetic moment mu\n        # Energy E = 0.5 * m * v0**2 is implicitly conserved by the EOMs\n        mu = (m * v_perp0**2) / (2 * B_init)\n\n        # State vector: Y = [x, y, z, v_parallel]\n        Y = np.array([x0, y0, z0, v_par0], dtype=float)\n\n        # Simulation control flags\n        has_reflected = False\n        is_confined = True\n\n        # Pre-calculate constants for the ODE function\n        C1 = (2 * mu * eps) / (q * L**2)\n        C2 = (2 * mu * alpha * B0) / m\n\n        def derivatives(state):\n            x, y, z, v_par = state\n            \n            # Transverse drift components (dx/dt, dy/dt)\n            transverse_denominator = 1 + eps * (x**2 + y**2) / L**2\n            dx_dt = -C1 * y / transverse_denominator\n            dy_dt = C1 * x / transverse_denominator\n            \n            # Parallel motion components (dz/dt, dv_par/dt)\n            dz_dt = v_par\n            dv_par_dt = -C2 * (1 + eps * (x**2 + y**2) / L**2) * z\n            \n            return np.array([dx_dt, dy_dt, dz_dt, dv_par_dt])\n\n        num_steps = int(T / dt)\n        \n        v_par_previous = v_par0\n        for _ in range(num_steps):\n            # --- RK4 Integration Step ---\n            k1 = derivatives(Y)\n            k2 = derivatives(Y + 0.5 * dt * k1)\n            k3 = derivatives(Y + 0.5 * dt * k2)\n            k4 = derivatives(Y + dt * k3)\n            Y += (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n            \n            z_current = Y[2]\n            v_par_current = Y[3]\n\n            # --- Confinement and Reflection Checks ---\n            # Check for escape\n            if abs(z_current)  Z_max:\n                is_confined = False\n                break\n            \n            # Check for reflection (turning point in z-motion)\n            if not has_reflected:\n                # A sign change indicates a reflection.\n                # A small tolerance is implicitly handled by the sign check being robust\n                # against v_par being exactly zero.\n                if np.sign(v_par_current) != np.sign(v_par_previous) and v_par_previous != 0:\n                    has_reflected = True\n            \n            v_par_previous = v_par_current\n\n        # Final verdict for the case\n        # Confined means it stayed within Z_max AND reflected at least once\n        results.append(is_confined and has_reflected)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}