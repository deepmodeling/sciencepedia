{
    "hands_on_practices": [
        {
            "introduction": "The presence of a magnetic field fundamentally alters how energy is transported through a plasma, making it a highly anisotropic process. This exercise explores the origin of this anisotropy from first principles, using a simple yet powerful random-walk model for electron motion. By considering the different physical constraints on particle movement parallel and perpendicular to the magnetic field, you will derive the classic scaling for the ratio of thermal conductivities, $\\kappa_{\\parallel}/\\kappa_{\\perp}$, and gain a deep intuition for why heat flows preferentially along field lines .",
            "id": "4210634",
            "problem": "Consider a weakly collisional, magnetized astrophysical plasma composed of electrons and ions with a uniform magnetic field $\\boldsymbol{B}$ and a slowly varying electron temperature $T_{e}(\\boldsymbol{x})$. Electrons undergo pitch-angle scattering with a characteristic collision time $\\tau$, have thermal speed $v_{\\mathrm{th}} = \\sqrt{2 k_{B} T_{e} / m_{e}}$, electron cyclotron frequency $\\omega_{ce} = e B / m_{e}$, mean free path $\\lambda = v_{\\mathrm{th}} \\tau$, and Larmor radius $\\rho = v_{\\mathrm{th}} / \\omega_{ce}$. Assume the magnetization is strong, so that $\\rho \\ll \\lambda$.\n\nStarting from kinetic-theory fundamentals and first principles, use the following base:\n- Heat transport arises from particle energy diffusion, such that the heat flux can be written as $q \\sim - \\kappa \\boldsymbol{\\nabla} T_{e}$ with thermal conductivity $\\kappa$ proportional to the product of a specific heat per particle and an appropriate diffusion coefficient.\n- For a random-walk process, a diffusion coefficient in any direction is $D \\sim \\ell^{2}/\\tau$, where $\\ell$ is the typical step size of the walk over the correlation time $\\tau$.\n- The relevant step sizes for electron motion are set by the mean free path along the magnetic field and by the Larmor radius across the magnetic field.\n\nDerive, in the limit $\\rho \\ll \\lambda$, the ratio of the parallel to perpendicular electron heat flux, $q_{\\parallel}/q_{\\perp}$, expressed in terms of $\\lambda$ and $\\rho$, and determine its scaling with $\\left(\\lambda/\\rho\\right)^{2}$. Your final answer must be a single closed-form analytic expression. Do not use any pre-tabulated anisotropic transport formulas or results; build your derivation from the above base and clearly justify the identification of step sizes and correlation times in both directions.",
            "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in the principles of astrophysical plasma physics, well-posed, and objective. It presents a standard, solvable problem in anisotropic transport theory without any internal contradictions, missing information, or factual errors. We may therefore proceed with the derivation.\n\nThe objective is to derive the ratio of the parallel to perpendicular electron heat flux, $q_{\\parallel}/q_{\\perp}$, in a strongly magnetized, weakly collisional plasma. The derivation will be constructed from the fundamental principles provided in the problem statement.\n\nThe electron heat flux $\\boldsymbol{q}$ is driven by the electron temperature gradient $\\boldsymbol{\\nabla} T_{e}$. In an anisotropic medium with a uniform magnetic field $\\boldsymbol{B}$, this relationship is described by a thermal conductivity tensor $\\boldsymbol{\\kappa}$:\n$$\n\\boldsymbol{q} = - \\boldsymbol{\\kappa} \\cdot \\boldsymbol{\\nabla} T_{e}\n$$\nWe define the direction parallel to the magnetic field with the unit vector $\\boldsymbol{b} = \\boldsymbol{B}/B$. The component of the heat flux parallel to $\\boldsymbol{B}$ is given by:\n$$\nq_{\\parallel} = \\boldsymbol{q} \\cdot \\boldsymbol{b} = - \\kappa_{\\parallel} (\\boldsymbol{\\nabla} T_{e} \\cdot \\boldsymbol{b}) = - \\kappa_{\\parallel} \\nabla_{\\parallel} T_{e}\n$$\nThe component of the heat flux perpendicular to $\\boldsymbol{B}$ is:\n$$\n\\boldsymbol{q}_{\\perp} = \\boldsymbol{q} - q_{\\parallel} \\boldsymbol{b} = - \\kappa_{\\perp} \\boldsymbol{\\nabla}_{\\perp} T_{e}\n$$\nThe magnitude of the perpendicular heat flux is therefore $q_{\\perp} = \\kappa_{\\perp} |\\boldsymbol{\\nabla}_{\\perp} T_{e}|$.\n\nThe ratio of the magnitudes of the heat fluxes is:\n$$\n\\frac{|q_{\\parallel}|}{|\\boldsymbol{q}_{\\perp}|} = \\frac{\\kappa_{\\parallel} |\\nabla_{\\parallel} T_{e}|}{\\kappa_{\\perp} |\\boldsymbol{\\nabla}_{\\perp} T_{e}|}\n$$\nThis ratio depends on the structure of the temperature gradient. To isolate the intrinsic anisotropy of the transport process itself, we evaluate this ratio under the condition where the characteristic scale-lengths of the temperature variation are comparable in both directions, i.e., $|\\nabla_{\\parallel} T_{e}| \\approx |\\boldsymbol{\\nabla}_{\\perp} T_{e}|$. In this case, the ratio of the heat fluxes is approximately equal to the ratio of the thermal conductivities:\n$$\n\\frac{|q_{\\parallel}|}{|\\boldsymbol{q}_{\\perp}|} \\approx \\frac{\\kappa_{\\parallel}}{\\kappa_{\\perp}}\n$$\nOur task reduces to finding the ratio of the parallel and perpendicular thermal conductivities, $\\kappa_{\\parallel}/\\kappa_{\\perp}$.\n\nAccording to the problem's specified base, the thermal conductivity $\\kappa$ is proportional to the product of a specific heat per particle (of order the Boltzmann constant $k_B$) and an appropriate diffusion coefficient $D$. Assuming the proportionality factor is an isotropic scalar, the ratio of conductivities is equal to the ratio of diffusion coefficients:\n$$\n\\frac{\\kappa_{\\parallel}}{\\kappa_{\\perp}} \\propto \\frac{D_{\\parallel}}{D_{\\perp}}\n$$\nWe can assume the proportionality constants cancel to yield an equality for the ratio.\n\nThe diffusion coefficient $D$ is described by a random-walk process, where $D \\sim \\ell^{2}/\\tau_{\\text{corr}}$, with $\\ell$ being the characteristic step size and $\\tau_{\\text{corr}}$ being the correlation time of the walk. We apply this model to electron motion parallel and perpendicular to the magnetic field.\n\nFirst, we consider transport parallel to $\\boldsymbol{B}$. The magnetic field does not constrain electron motion along the field lines. The motion is effectively a $1$-dimensional random walk, where an electron travels freely until it is scattered by a collision.\nThe characteristic step size $\\ell_{\\parallel}$ for this process is the mean free path $\\lambda$, which is the average distance traveled between collisions.\nThe correlation time $\\tau_{\\text{corr}, \\parallel}$ is the average time between scattering events, which is the collision time $\\tau$.\nThe parallel diffusion coefficient is therefore:\n$$\nD_{\\parallel} \\sim \\frac{\\ell_{\\parallel}^{2}}{\\tau_{\\text{corr}, \\parallel}} = \\frac{\\lambda^{2}}{\\tau}\n$$\n\nNext, we consider transport perpendicular to $\\boldsymbol{B}$. In a strong magnetic field (where $\\rho \\ll \\lambda$, or equivalently, $\\omega_{ce} \\tau \\gg 1$), an electron's motion is dominated by rapid gyration around a magnetic field line. A collision causes an abrupt change in the electron's velocity, which in turn causes the center of its gyration (the guiding center) to jump to a new position on a different field line. Perpendicular transport is thus a $2$-dimensional random walk of these guiding centers.\nThe characteristic step size $\\ell_{\\perp}$ of this random walk is the size of the gyro-orbit, which is of the order of the Larmor radius $\\rho$.\nThe correlation time $\\tau_{\\text{corr}, \\perp}$ is the time between these random jumps, which is again the collision time $\\tau$, since collisions are the causal event.\nThe perpendicular diffusion coefficient is therefore:\n$$\nD_{\\perp} \\sim \\frac{\\ell_{\\perp}^{2}}{\\tau_{\\text{corr}, \\perp}} = \\frac{\\rho^{2}}{\\tau}\n$$\n\nNow we can compute the ratio of the conductivities by taking the ratio of the diffusion coefficients. The symbol `~` in the problem base indicates a scaling relation, where numerical factors of order unity are omitted. Proceeding under this interpretation, we find:\n$$\n\\frac{\\kappa_{\\parallel}}{\\kappa_{\\perp}} = \\frac{D_{\\parallel}}{D_{\\perp}} \\sim \\frac{\\lambda^{2}/\\tau}{\\rho^{2}/\\tau} = \\frac{\\lambda^{2}}{\\rho^{2}} = \\left(\\frac{\\lambda}{\\rho}\\right)^{2}\n$$\nThus, the ratio of the parallel to perpendicular electron heat flux, under the assumption of comparable gradient scale lengths, is given by $(\\lambda/\\rho)^{2}$.\n\nThe problem also asks to determine the scaling of this ratio with $(\\lambda/\\rho)^{2}$. Since the derived ratio is exactly $(\\lambda/\\rho)^{2}$, it scales linearly with this quantity. The expression itself is the final answer. The provided definitions are $\\lambda = v_{\\mathrm{th}} \\tau$ and $\\rho = v_{\\mathrm{th}} / \\omega_{ce}$, which gives the well-known result that the ratio scales as $(\\omega_{ce} \\tau)^2$. The problem, however, requests the answer in terms of $\\lambda$ and $\\rho$.",
            "answer": "$$\n\\boxed{\\left(\\frac{\\lambda}{\\rho}\\right)^{2}}\n$$"
        },
        {
            "introduction": "Just as with thermal conduction, the transport of momentum in a magnetized plasma is also strongly anisotropic. This practice problem shifts our focus to viscosity, exploring how the viscous stress tensor selectively resists certain velocity shears based on their orientation relative to the magnetic field. By analyzing a specific case of shear flow, you will discover a profound consequence of this anisotropy and see why the familiar isotropic Navier-Stokes model is insufficient for describing many astrophysical flows .",
            "id": "4210617",
            "problem": "Consider a collisional, strongly magnetized astrophysical plasma that is well described by magnetohydrodynamics (MHD) in the subsonic regime. The magnetic field is uniform, $\\boldsymbol{B} = B\\,\\hat{\\boldsymbol{x}}$, and the flow is a steady, incompressible shear aligned with $\\boldsymbol{B}$: $\\boldsymbol{u}(\\boldsymbol{x}) = u(y)\\,\\hat{\\boldsymbol{x}}$, with constant shear rate $g \\equiv \\partial_{y} u(y)$. Assume the density is uniform and constant, and neglect any bulk viscosity. Let $\\boldsymbol{S}$ denote the symmetric rate-of-strain tensor, defined by $S_{ij} = \\tfrac{1}{2}\\left(\\partial_{i} u_{j} + \\partial_{j} u_{i}\\right)$, and let the viscous heating rate per unit volume be $Q_{\\mathrm{visc}} = \\boldsymbol{\\Pi}:\\nabla \\boldsymbol{u}$, where $\\boldsymbol{\\Pi}$ is the viscous stress tensor and $:$ denotes the double tensor contraction.\n\nIn the isotropic reference case (Newtonian fluid), the dynamic viscosity is $\\mu$. In the anisotropic plasma case (strongly magnetized and collisional, with ion parallel viscosity dominant), the parallel viscosity coefficient is $\\eta_{\\parallel}$ and cross-field (perpendicular) and gyroviscous contributions are negligible.\n\nUsing fundamental definitions of viscous stress in these two cases, compute the viscous heating rates $Q_{\\mathrm{visc}}^{\\mathrm{aniso}}$ and $Q_{\\mathrm{visc}}^{\\mathrm{iso}}$ for the specified shear, and then give the ratio\n$$\nR \\equiv \\frac{Q_{\\mathrm{visc}}^{\\mathrm{aniso}}}{Q_{\\mathrm{visc}}^{\\mathrm{iso}}}.\n$$\nProvide your final answer as a single, closed-form expression for $R$. No rounding is required. The ratio $R$ is dimensionless; report it without units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **System**: A collisional, strongly magnetized astrophysical plasma in the subsonic regime, described by magnetohydrodynamics (MHD).\n- **Magnetic Field**: Uniform, $\\boldsymbol{B} = B\\,\\hat{\\boldsymbol{x}}$. The corresponding unit vector is $\\boldsymbol{b} = \\hat{\\boldsymbol{x}}$.\n- **Velocity Field**: Steady, incompressible shear flow, $\\boldsymbol{u}(\\boldsymbol{x}) = u(y)\\,\\hat{\\boldsymbol{x}}$.\n- **Shear Rate**: Constant, $g \\equiv \\partial_{y} u(y)$.\n- **Density**: Uniform and constant.\n- **Viscosity Models**:\n  - **Isotropic**: Dynamic viscosity $\\mu$. Bulk viscosity is neglected.\n  - **Anisotropic**: Parallel viscosity coefficient $\\eta_{\\parallel}$ is dominant. Cross-field (perpendicular) and gyroviscous contributions are negligible.\n- **Definitions**:\n  - **Rate-of-strain tensor**: $S_{ij} = \\tfrac{1}{2}\\left(\\partial_{i} u_{j} + \\partial_{j} u_{i}\\right)$.\n  - **Viscous heating rate**: $Q_{\\mathrm{visc}} = \\boldsymbol{\\Pi}:\\nabla \\boldsymbol{u}$.\n- **Objective**: Compute the ratio $R \\equiv \\frac{Q_{\\mathrm{visc}}^{\\mathrm{aniso}}}{Q_{\\mathrm{visc}}^{\\mathrm{iso}}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established theory of plasma physics, specifically the Braginskii model for transport coefficients in a magnetized plasma. The setup, while idealized, is a standard theoretical case used to study anisotropic effects. All terms are well-defined, and the problem provides a complete set of assumptions (e.g., neglecting perpendicular viscosity) needed to arrive at a unique solution. The problem is free of contradictions, ambiguities, and factual errors.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be formulated based on the provided definitions and principles.\n\n### Solution Formulation\nThe solution requires calculating the viscous heating rate for both the isotropic and anisotropic cases and then finding their ratio. The calculation proceeds by first determining the velocity gradient and rate-of-strain tensors for the given flow.\n\nThe velocity field is given in Cartesian coordinates as $\\boldsymbol{u} = (u_x, u_y, u_z) = (u(y), 0, 0)$. The velocity gradient tensor, with components $(\\nabla\\boldsymbol{u})_{ij} = \\partial_i u_j$, is found by taking the derivatives. The only non-zero component is $\\partial_y u_x = \\partial_2 u_1 = \\partial_y u(y) = g$. Thus, the velocity gradient tensor is:\n$$\n\\nabla\\boldsymbol{u} = \\begin{pmatrix} 0  0  0 \\\\ g  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nThe rate-of-strain tensor $\\boldsymbol{S}$ has components $S_{ij} = \\frac{1}{2}(\\partial_i u_j + \\partial_j u_i)$. Its non-zero components are:\n$$\nS_{12} = S_{21} = \\frac{1}{2}(\\partial_1 u_2 + \\partial_2 u_1) = \\frac{1}{2}(0 + g) = \\frac{g}{2}\n$$\nAll diagonal components are zero, e.g., $S_{11} = \\partial_1 u_1 = \\partial_x u(y) = 0$. The tensor $\\boldsymbol{S}$ is:\n$$\n\\boldsymbol{S} = \\begin{pmatrix} 0  \\frac{g}{2}  0 \\\\ \\frac{g}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nNote that the flow is incompressible, as $\\nabla \\cdot \\boldsymbol{u} = \\partial_x u_x + \\partial_y u_y + \\partial_z u_z = 0$.\n\n**1. Isotropic Case**\nFor an incompressible Newtonian fluid with no bulk viscosity, the viscous stress tensor $\\boldsymbol{\\Pi}^{\\mathrm{iso}}$ is related to the rate-of-strain tensor by $\\boldsymbol{\\Pi}^{\\mathrm{iso}} = 2\\mu\\boldsymbol{S}$.\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{iso}} = 2\\mu \\begin{pmatrix} 0  \\frac{g}{2}  0 \\\\ \\frac{g}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\mu \\begin{pmatrix} 0  g  0 \\\\ g  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nThe viscous heating rate is $Q_{\\mathrm{visc}}^{\\mathrm{iso}} = \\boldsymbol{\\Pi}^{\\mathrm{iso}}:\\nabla \\boldsymbol{u} = \\sum_{i,j} \\Pi_{ij}^{\\mathrm{iso}} (\\partial_i u_j)$. The summation has only one non-zero term, corresponding to $i=2, j=1$:\n$$\nQ_{\\mathrm{visc}}^{\\mathrm{iso}} = \\Pi_{21}^{\\mathrm{iso}} (\\partial_2 u_1) = (\\mu g)(g) = \\mu g^2\n$$\nThis is the standard viscous dissipation rate for a simple shear flow. We assume $g \\neq 0$ and $\\mu \\neq 0$.\n\n**2. Anisotropic Case**\nIn a strongly magnetized plasma, viscosity is highly anisotropic. The problem specifies that the only relevant component is the parallel viscosity, described by the coefficient $\\eta_{\\parallel}$. The corresponding viscous stress tensor (the parallel component of the Braginskii tensor) is given by:\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{aniso}} = -3\\eta_{\\parallel}(\\boldsymbol{b}\\boldsymbol{b} - \\frac{1}{3}\\boldsymbol{I})(\\boldsymbol{b}\\boldsymbol{b}:\\boldsymbol{S})\n$$\nwhere $\\boldsymbol{b}$ is the unit vector along the magnetic field, $\\boldsymbol{I}$ is the identity tensor, and $\\boldsymbol{b}\\boldsymbol{b}$ is the dyadic product.\nThe magnetic field is $\\boldsymbol{B} = B\\,\\hat{\\boldsymbol{x}}$, so $\\boldsymbol{b} = \\hat{\\boldsymbol{x}} = (1, 0, 0)$. The tensor $\\boldsymbol{b}\\boldsymbol{b}$ is:\n$$\n\\boldsymbol{b}\\boldsymbol{b} = \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nThe crucial term is the scalar quantity $\\boldsymbol{b}\\boldsymbol{b}:\\boldsymbol{S}$, which projects the rate-of-strain tensor along the magnetic field direction.\n$$\n\\boldsymbol{b}\\boldsymbol{b}:\\boldsymbol{S} = \\sum_{i,j} (b_i b_j) S_{ij} = (b_1 b_1) S_{11} = (1 \\cdot 1) S_{11} = S_{11}\n$$\nPhysically, $S_{11} = \\partial_x u_x$ represents the rate of compression or expansion of fluid elements along the magnetic field direction ($\\hat{\\boldsymbol{x}}$). For the given flow $\\boldsymbol{u} = u(y)\\,\\hat{\\boldsymbol{x}}$, we have $u_x = u(y)$, so $\\partial_x u_x = 0$.\nTherefore, $S_{11} = 0$.\n\nSince $\\boldsymbol{b}\\boldsymbol{b}:\\boldsymbol{S} = 0$, the entire anisotropic stress tensor is zero:\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{aniso}} = -3\\eta_{\\parallel}(\\boldsymbol{b}\\boldsymbol{b} - \\frac{1}{3}\\boldsymbol{I})(0) = \\boldsymbol{0}\n$$\nThe viscous heating rate in the anisotropic case is consequently zero:\n$$\nQ_{\\mathrm{visc}}^{\\mathrm{aniso}} = \\boldsymbol{\\Pi}^{\\mathrm{aniso}}:\\nabla \\boldsymbol{u} = \\boldsymbol{0}:\\nabla \\boldsymbol{u} = 0\n$$\nThis result occurs because the parallel viscosity only resists shear or compression along the magnetic field lines. The specified flow, $\\boldsymbol{u} = u(y)\\hat{\\boldsymbol{x}}$, represents layers of fluid sliding past each other, where the sliding is along the direction of $\\boldsymbol{B}$, but the gradient of the flow is perpendicular to $\\boldsymbol{B}$. This type of shear does not engage the parallel viscous mechanism. The perpendicular viscosity components, which would resist this shear, are explicitly neglected as per the problem statement.\n\n**3. The Ratio R**\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{Q_{\\mathrm{visc}}^{\\mathrm{aniso}}}{Q_{\\mathrm{visc}}^{\\mathrm{iso}}} = \\frac{0}{\\mu g^2}\n$$\nAssuming a non-trivial shear ($g \\neq 0$) and a viscous fluid ($\\mu \\neq 0$), the denominator is non-zero.\n$$\nR = 0\n$$",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Understanding the physics of anisotropic transport is only the first step; modeling it accurately presents a significant computational challenge. This hands-on numerical exercise delves into the practical difficulties of simulating heat flow when the conductivity parallel to the magnetic field is orders of magnitude larger than the perpendicular conductivity. By implementing and comparing several common numerical schemes, you will directly investigate the sources of error and appreciate the importance of using methods that correctly capture the heat flux's strong alignment with the magnetic field .",
            "id": "4210679",
            "problem": "Consider a two-dimensional magnetized plasma in the magnetohydrodynamics (MHD) regime with anisotropic thermal conduction. The heat flux is modeled by a constitutive relation that respects gyrotropy with respect to the magnetic field direction. Let the magnetic field direction be represented by the unit vector $\\mathbf{b} = (\\cos\\theta, \\sin\\theta)$ lying in the plane, where $\\theta$ is the rotation angle with respect to the $x$-axis. The anisotropic thermal conductivity tensor is defined by the widely accepted form\n$$\n\\mathbf{K} = \\kappa_{\\perp}\\,\\mathbf{I} + \\left(\\kappa_{\\parallel} - \\kappa_{\\perp}\\right)\\,\\mathbf{b}\\,\\mathbf{b}^{\\mathsf{T}},\n$$\nwhere $\\kappa_{\\parallel}$ and $\\kappa_{\\perp}$ are the thermal conductivities parallel and perpendicular to the magnetic field, respectively, and $\\mathbf{I}$ is the identity tensor. The heat flux is then\n$$\n\\mathbf{q} = -\\mathbf{K}\\,\\nabla T.\n$$\nThe domain is rectangular with sizes $L_x$ and $L_y$, and the temperature field is prescribed analytically to produce gradients with mixed orientations:\n$$\nT(x,y) = A\\,\\sin(k_x x) + B\\,\\cos(k_y y) + C\\,\\sin(k_{dx} x + k_{dy} y),\n$$\nwith constants $A$, $B$, $C$, $k_x$, $k_y$, $k_{dx}$, $k_{dy}$. The exact spatial derivatives $\\partial_x T$ and $\\partial_y T$ are available analytically from this prescription.\n\nYour task is to implement, for each provided test case, the computation of the heat flux orientation error in radians for three distinct numerical approaches to approximating $\\mathbf{q}$:\n\n- Approach $\\mathrm{FT{-}CD}$: Use central differences to approximate $\\nabla T$ on the interior grid points and then apply the full anisotropic tensor $\\mathbf{K}$ (including off-diagonal terms) to obtain $\\mathbf{q}$.\n- Approach $\\mathrm{DG{-}CD}$: Use central differences for $\\nabla T$, but approximate the conduction tensor by discarding off-diagonal terms (i.e., a diagonal-only approximation in the grid basis). Specifically, use\n$$\n\\mathbf{K}_{\\mathrm{diag}} = \\mathrm{diag}\\left(\\kappa_{\\perp} + (\\kappa_{\\parallel}-\\kappa_{\\perp})\\,b_x^2,\\ \\kappa_{\\perp} + (\\kappa_{\\parallel}-\\kappa_{\\perp})\\,b_y^2\\right),\n$$\nwhere $b_x = \\cos\\theta$ and $b_y = \\sin\\theta$, and compute $\\mathbf{q}$ using $\\mathbf{K}_{\\mathrm{diag}}$.\n- Approach $\\mathrm{FT{-}UD}$: Use first-order upwind differences to approximate $\\nabla T$ on the interior grid points, where the upwinding direction for $\\partial_x T$ is set by the sign of $b_x$ and for $\\partial_y T$ by the sign of $b_y$, and then apply the full anisotropic tensor $\\mathbf{K}$ to obtain $\\mathbf{q}$.\n\nFor each approach, define the orientation angle field\n$$\n\\phi(x,y) = \\mathrm{atan2}\\left(q_y(x,y), q_x(x,y)\\right),\n$$\nwhere $q_x$ and $q_y$ are the components of $\\mathbf{q}$, and quantify the error by the root-mean-square (RMS) of the angle difference between the numerical $\\phi_{\\mathrm{num}}$ and the exact $\\phi_{\\mathrm{true}}$ computed from the analytic gradient and the full tensor. Use the minimal periodic difference $\\Delta\\phi = (\\phi_{\\mathrm{num}} - \\phi_{\\mathrm{true}})$ wrapped into the interval $[-\\pi,\\pi]$. Exclude grid points where the magnitude of the exact heat flux $\\|\\mathbf{q}_{\\mathrm{true}}\\|$ is below a small tolerance (to avoid orientation undefined at zero flux). Report the RMS orientation error in radians.\n\nFundamental base for the derivation and implementation:\n- Energy conservation for a static conduction test (no sources or flow) implies the heat flux follows a constitutive law.\n- For magnetized plasmas, strong anisotropy gives the tensor form $\\mathbf{K}$ stated above.\n- Standard finite difference schemes (central difference and first-order upwind difference) provide discrete approximations to spatial derivatives.\n\nUse the following domain and temperature parameters for all test cases:\n- $L_x = 1\\,\\mathrm{m}$, $L_y = 1\\,\\mathrm{m}$,\n- $A = 1$, $B = 0.8$, $C = 0.6$,\n- $k_x = 2\\pi/L_x$, $k_y = 3\\pi/L_y$, $k_{dx} = \\pi/L_x$, $k_{dy} = 2\\pi/L_y$.\n\nThe anisotropy ratio is defined as $r = \\kappa_{\\parallel}/\\kappa_{\\perp}$. Use $\\kappa_{\\parallel} = 1\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ and $\\kappa_{\\perp} = \\kappa_{\\parallel}/r$ in each test case. Angles must be in radians. The grid is uniform with $N_x$ points in $x$ and $N_y$ points in $y$. Compute discrete derivatives only on the interior points to avoid boundary artifacts.\n\nTest suite:\n- Test case $1$: $\\theta = \\pi/6$, $r = 100$, $N_x = 129$, $N_y = 127$.\n- Test case $2$: $\\theta = \\pi/4$, $r = 10$, $N_x = 65$, $N_y = 63$.\n- Test case $3$: $\\theta = \\pi/2$, $r = 50$, $N_x = 33$, $N_y = 65$.\n\nFor each test case, compute three RMS orientation errors:\n- $E_{\\mathrm{FT{-}CD}}$,\n- $E_{\\mathrm{DG{-}CD}}$,\n- $E_{\\mathrm{FT{-}UD}}$.\nAll three must be expressed in radians.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\left[E_{\\mathrm{FT{-}CD}}^{(1)}, E_{\\mathrm{DG{-}CD}}^{(1)}, E_{\\mathrm{FT{-}UD}}^{(1)}, E_{\\mathrm{FT{-}CD}}^{(2)}, E_{\\mathrm{DG{-}CD}}^{(2)}, E_{\\mathrm{FT{-}UD}}^{(2)}, E_{\\mathrm{FT{-}CD}}^{(3)}, E_{\\mathrm{DG{-}CD}}^{(3)}, E_{\\mathrm{FT{-}UD}}^{(3)}\\right],\n$$\nwhere superscripts indicate the test case number. Each entry is a float in radians. Angles must be expressed in radians, and the line must contain only the bracketed list with no additional text.",
            "solution": "The problem requires a critical evaluation of three distinct numerical schemes for computing the anisotropic heat flux in a magnetized plasma. The evaluation is based on the accuracy of the heat flux orientation angle relative to an exact analytical solution. The core of the problem lies in the interplay between the physical model of anisotropy and the numerical errors introduced by different finite difference approximations and model simplifications.\n\n### Analytical Formulation\n\nThe physical system is defined on a two-dimensional rectangular domain of size $L_x \\times L_y$. The temperature field $T(x,y)$ is given by the analytical expression:\n$$\nT(x,y) = A\\,\\sin(k_x x) + B\\,\\cos(k_y y) + C\\,\\sin(k_{dx} x + k_{dy} y)\n$$\nThe exact temperature gradient, $\\nabla T = (\\partial_x T, \\partial_y T)^{\\mathsf{T}}$, can be derived by direct differentiation:\n$$\n\\partial_x T(x,y) = A k_x \\cos(k_x x) + C k_{dx} \\cos(k_{dx} x + k_{dy} y)\n$$\n$$\n\\partial_y T(x,y) = -B k_y \\sin(k_y y) + C k_{dy} \\cos(k_{dx} x + k_{dy} y)\n$$\nThe magnetic field is uniform and its direction is given by the unit vector $\\mathbf{b} = (b_x, b_y)^{\\mathsf{T}} = (\\cos\\theta, \\sin\\theta)^{\\mathsf{T}}$.\n\nThe heat conduction is anisotropic, described by the thermal conductivity tensor $\\mathbf{K}$:\n$$\n\\mathbf{K} = \\kappa_{\\perp}\\,\\mathbf{I} + \\left(\\kappa_{\\parallel} - \\kappa_{\\perp}\\right)\\,\\mathbf{b}\\,\\mathbf{b}^{\\mathsf{T}}\n$$\nwhere $\\kappa_{\\parallel}$ and $\\kappa_{\\perp}$ are the conductivities parallel and perpendicular to the magnetic field, and $\\mathbf{I}$ is the $2 \\times 2$ identity matrix. The tensor-vector product $\\mathbf{b}\\,\\mathbf{b}^{\\mathsf{T}}$ is an outer product, resulting in a matrix. The components of $\\mathbf{K}$ are:\n$$\n\\mathbf{K} = \\begin{pmatrix}\n\\kappa_{\\perp} + (\\kappa_{\\parallel} - \\kappa_{\\perp}) b_x^2  (\\kappa_{\\parallel} - \\kappa_{\\perp}) b_x b_y \\\\\n(\\kappa_{\\parallel} - \\kappa_{\\perp}) b_x b_y  \\kappa_{\\perp} + (\\kappa_{\\parallel} - \\kappa_{\\perp}) b_y^2\n\\end{pmatrix} = \\begin{pmatrix} K_{xx}  K_{xy} \\\\ K_{yx}  K_{yy} \\end{pmatrix}\n$$\nThe heat flux $\\mathbf{q} = (q_x, q_y)^{\\mathsf{T}}$ is governed by the anisotropic Fourier's law:\n$$\n\\mathbf{q} = -\\mathbf{K} \\nabla T\n$$\nUsing the analytical gradient $\\nabla T$, we obtain the true heat flux $\\mathbf{q}_{\\mathrm{true}}$:\n$$\nq_{x, \\mathrm{true}} = -\\left( K_{xx} \\partial_x T + K_{xy} \\partial_y T \\right)\n$$\n$$\nq_{y, \\mathrm{true}} = -\\left( K_{yx} \\partial_x T + K_{yy} \\partial_y T \\right)\n$$\nThe true orientation angle field is then $\\phi_{\\mathrm{true}}(x,y) = \\mathrm{atan2}(q_{y, \\mathrm{true}}, q_{x, \\mathrm{true}})$.\n\n### Numerical Discretization and Schemes\n\nWe discretize the domain using a uniform grid with $N_x$ points in the $x$-direction and $N_y$ points in the $y$-direction. The grid spacings are $\\Delta x = L_x / (N_x-1)$ and $\\Delta y = L_y / (N_y-1)$. The temperature $T(x,y)$ is evaluated at each grid point $(x_i, y_j)$ to form a discrete field $T_{i,j}$. The numerical errors are evaluated on the interior grid points, from $i=1$ to $N_x-2$ and $j=1$ to $N_y-2$.\n\n**Approach 1: Full-Tensor, Central-Difference (FT-CD)**\nThis approach uses a second-order accurate central difference scheme to approximate the gradient components on the interior grid:\n$$\n(\\partial_x T)_{i,j} \\approx \\frac{T_{i+1,j} - T_{i-1,j}}{2\\Delta x}\n$$\n$$\n(\\partial_y T)_{i,j} \\approx \\frac{T_{i,j+1} - T_{i,j-1}}{2\\Delta y}\n$$\nThe numerical heat flux $\\mathbf{q}_{\\mathrm{FT-CD}}$ is then computed using the full tensor $\\mathbf{K}$ applied to this approximated gradient. This approach is subject only to the discretization error of the central difference scheme.\n\n**Approach 2: Diagonal-Tensor, Central-Difference (DG-CD)**\nThis approach uses the same central difference approximation for $\\nabla T$ but employs a simplified, diagonal-only conductivity tensor:\n$$\n\\mathbf{K}_{\\mathrm{diag}} = \\begin{pmatrix} K_{xx}  0 \\\\ 0  K_{yy} \\end{pmatrix}\n$$\nThe heat flux is computed as $\\mathbf{q}_{\\mathrm{DG-CD}} = -\\mathbf{K}_{\\mathrm{diag}} (\\nabla T)_{\\mathrm{CD}}$. This method introduces a modeling error by neglecting the off-diagonal terms $K_{xy}$, which couple the gradient in one direction to the flux in the orthogonal direction. This approximation is often made for simplicity but is physically incorrect for magnetic fields not aligned with the grid axes.\n\n**Approach 3: Full-Tensor, Upwind-Difference (FT-UD)**\nThis approach uses the full tensor $\\mathbf{K}$ but approximates the gradient with a first-order accurate upwind scheme. The \"upwind\" direction for each partial derivative is prescribed to be determined by the sign of the corresponding component of the magnetic field vector $\\mathbf{b} = (b_x, b_y)^{\\mathsf{T}}$. Adopting the convention that for a non-negative component ($b_x \\ge 0$), a backward difference is used, and for a negative component ($b_x  0$), a forward difference is used:\nFor $\\partial_x T$:\n$$\n(\\partial_x T)_{i,j} \\approx \\begin{cases} \\frac{T_{i,j} - T_{i-1,j}}{\\Delta x}  \\text{if } b_x \\ge 0 \\\\ \\frac{T_{i+1,j} - T_{i,j}}{\\Delta x}  \\text{if } b_x  0 \\end{cases}\n$$\nFor $\\partial_y T$:\n$$\n(\\partial_y T)_{i,j} \\approx \\begin{cases} \\frac{T_{i,j} - T_{i,j-1}}{\\Delta y}  \\text{if } b_y \\ge 0 \\\\ \\frac{T_{i,j+1} - T_{i,j}}{\\Delta y}  \\text{if } b_y  0 \\end{cases}\n$$\nThe heat flux is then $\\mathbf{q}_{\\mathrm{FT-UD}} = -\\mathbf{K} (\\nabla T)_{\\mathrm{UD}}$. This scheme introduces a first-order discretization error, which is typically larger than the second-order error of the central difference scheme.\n\n### Error Quantification\n\nFor each numerical approach, we compute the numerical orientation angle $\\phi_{\\mathrm{num}} = \\mathrm{atan2}(q_{y, \\mathrm{num}}, q_{x, \\mathrm{num}})$ on the interior grid points. The error is quantified as the root-mean-square (RMS) of the periodic angle difference, $\\Delta\\phi = \\phi_{\\mathrm{num}} - \\phi_{\\mathrm{true}}$. The difference is wrapped into the range $[-\\pi, \\pi]$ to correctly handle the $2\\pi$ periodicity of angles:\n$$\n\\Delta\\phi_{\\mathrm{wrapped}} = \\mathrm{atan2}(\\sin(\\Delta\\phi), \\cos(\\Delta\\phi))\n$$\nTo avoid numerical issues where the heat flux is near zero (and its orientation is ill-defined), we exclude points where the magnitude of the true heat flux, $\\|\\mathbf{q}_{\\mathrm{true}}\\| = \\sqrt{q_{x, \\mathrm{true}}^2 + q_{y, \\mathrm{true}}^2}$, is below a small tolerance. A standard numerical tolerance of $\\tau = 10^{-12}$ is chosen for this purpose.\n\nLet $S$ be the set of valid interior grid points where $\\|\\mathbf{q}_{\\mathrm{true}}(x_i, y_j)\\| \\ge \\tau$, and let $N_S$ be the number of such points. The RMS orientation error $E$ is calculated as:\n$$\nE = \\sqrt{\\frac{1}{N_S} \\sum_{(i,j) \\in S} \\left( \\Delta\\phi_{\\mathrm{wrapped}}(x_i, y_j) \\right)^2}\n$$\nThis procedure is repeated for each of the three numerical approaches and for each test case specified. The resulting errors, $E_{\\mathrm{FT-CD}}$, $E_{\\mathrm{DG-CD}}$, and $E_{\\mathrm{FT-UD}}$, provide a quantitative comparison of their performance.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMS orientation error for three numerical schemes for\n    anisotropic heat conduction in a 2D magnetized plasma.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (theta, r, N_x, N_y)\n        (np.pi/6, 100., 129, 127),\n        (np.pi/4, 10., 65, 63),\n        (np.pi/2, 50., 33, 65),\n    ]\n\n    # Common domain and temperature parameters\n    Lx, Ly = 1.0, 1.0\n    A, B, C = 1.0, 0.8, 0.6\n    kx, ky = 2 * np.pi / Lx, 3 * np.pi / Ly\n    kdx, kdy = np.pi / Lx, 2 * np.pi / Ly\n    kappa_par = 1.0\n    flux_mag_tolerance = 1e-12\n\n    results = []\n    \n    for case in test_cases:\n        theta, r, Nx, Ny = case\n        \n        # --- 1. Setup Grid and Parameters ---\n        kappa_perp = kappa_par / r\n        \n        x = np.linspace(0, Lx, Nx)\n        y = np.linspace(0, Ly, Ny)\n        dx = Lx / (Nx - 1)\n        dy = Ly / (Ny - 1)\n        xx, yy = np.meshgrid(x, y)\n\n        # --- 2. Analytical Solution ---\n        # Temperature field\n        T_grid = A * np.sin(kx * xx) + B * np.cos(ky * yy) + C * np.sin(kdx * xx + kdy * yy)\n\n        # Analytical gradient\n        grad_T_x_exact = A * kx * np.cos(kx * xx) + C * kdx * np.cos(kdx * xx + kdy * yy)\n        grad_T_y_exact = -B * ky * np.sin(ky * yy) + C * kdy * np.cos(kdx * xx + kdy * yy)\n\n        # Conductivity tensor components\n        b_x, b_y = np.cos(theta), np.sin(theta)\n        Kxx = kappa_perp + (kappa_par - kappa_perp) * b_x**2\n        Kyy = kappa_perp + (kappa_par - kappa_perp) * b_y**2\n        Kxy = (kappa_par - kappa_perp) * b_x * b_y\n\n        # True heat flux\n        q_x_true = -(Kxx * grad_T_x_exact + Kxy * grad_T_y_exact)\n        q_y_true = -(Kxy * grad_T_x_exact + Kyy * grad_T_y_exact)\n        \n        # evaluation on interior points\n        q_x_true_int = q_x_true[1:-1, 1:-1]\n        q_y_true_int = q_y_true[1:-1, 1:-1]\n\n        # True orientation angle and magnitude mask\n        phi_true = np.arctan2(q_y_true_int, q_x_true_int)\n        mag_true = np.sqrt(q_x_true_int**2 + q_y_true_int**2)\n        valid_mask = mag_true = flux_mag_tolerance\n        \n        case_results = []\n        \n        # --- 3. Numerical Scheme Evaluation ---\n        # Function to compute RMS error\n        def compute_rms_error(q_x_num, q_y_num):\n            phi_num = np.arctan2(q_y_num, q_x_num)\n            delta_phi = phi_num - phi_true\n            delta_phi_wrapped = np.arctan2(np.sin(delta_phi), np.cos(delta_phi))\n            \n            # Apply mask to select valid points\n            delta_phi_valid = delta_phi_wrapped[valid_mask]\n            \n            # RMS of the angle difference\n            rms_error = np.sqrt(np.mean(delta_phi_valid**2))\n            return rms_error\n        \n        # --- Approach FT-CD (Full-Tensor, Central-Difference) ---\n        grad_T_x_cd = (T_grid[1:-1, 2:] - T_grid[1:-1, :-2]) / (2 * dx)\n        grad_T_y_cd = (T_grid[2:, 1:-1] - T_grid[:-2, 1:-1]) / (2 * dy)\n        \n        q_x_ft_cd = -(Kxx * grad_T_x_cd + Kxy * grad_T_y_cd)\n        q_y_ft_cd = -(Kxy * grad_T_x_cd + Kyy * grad_T_y_cd)\n        \n        error_ft_cd = compute_rms_error(q_x_ft_cd, q_y_ft_cd)\n        case_results.append(error_ft_cd)\n        \n        # --- Approach DG-CD (Diagonal-Tensor, Central-Difference) ---\n        # Gradient is the same (grad_T_x_cd, grad_T_y_cd)\n        \n        q_x_dg_cd = -(Kxx * grad_T_x_cd)\n        q_y_dg_cd = -(Kyy * grad_T_y_cd)\n        \n        error_dg_cd = compute_rms_error(q_x_dg_cd, q_y_dg_cd)\n        case_results.append(error_dg_cd)\n        \n        # --- Approach FT-UD (Full-Tensor, Upwind-Difference) ---\n        T_interior = T_grid[1:-1, 1:-1]\n        if b_x = 0:\n            grad_T_x_ud = (T_interior - T_grid[1:-1, :-2]) / dx\n        else:\n            grad_T_x_ud = (T_grid[1:-1, 2:] - T_interior) / dx\n        \n        if b_y = 0:\n            grad_T_y_ud = (T_interior - T_grid[:-2, 1:-1]) / dy\n        else:\n            grad_T_y_ud = (T_grid[2:, 1:-1] - T_interior) / dy\n            \n        q_x_ft_ud = -(Kxx * grad_T_x_ud + Kxy * grad_T_y_ud)\n        q_y_ft_ud = -(Kxy * grad_T_x_ud + Kyy * grad_T_y_ud)\n        \n        error_ft_ud = compute_rms_error(q_x_ft_ud, q_y_ft_ud)\n        case_results.append(error_ft_ud)\n        \n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.8e}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}