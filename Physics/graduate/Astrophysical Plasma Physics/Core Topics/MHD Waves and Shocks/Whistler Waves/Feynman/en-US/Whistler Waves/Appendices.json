{
    "hands_on_practices": [
        {
            "introduction": "Understanding any wave begins with its dispersion relation, which connects its frequency to its wavenumber. This first exercise guides you through a foundational derivation of the whistler mode dispersion relation, starting from the fundamental laws of plasma physics—Maxwell's equations and the electron momentum equation. By working through this derivation for the simplified case of parallel propagation in a cold, uniform plasma, you will uncover the characteristic quadratic relationship $\\omega \\propto k_{\\parallel}^2$ that governs low-frequency whistlers and explore the direct consequence for their phase and group velocities . This practice solidifies the core physics of how these waves are sustained by the gyromotion of electrons in a magnetized plasma.",
            "id": "4235750",
            "problem": "Consider a cold, collisionless, quasi-neutral electron–ion plasma with uniform background magnetic field $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$ and electron number density $n_{e}$. Assume ion motion is negligible in the frequency range of interest, and consider small-amplitude, plane electromagnetic waves with angular frequency $\\omega$ and parallel wavenumber $k_{\\parallel}$ propagating strictly along $\\mathbf{B}_{0}$. Work in the regime $\\Omega_{i} \\ll \\omega \\ll \\Omega_{e}$, where $\\Omega_{i}$ and $\\Omega_{e}$ are the ion and electron cyclotron frequencies, and assume $k_{\\parallel} c / \\omega \\gg 1$ is not required; retain the full displacement current. Starting from Maxwell’s equations and the linearized electron momentum equation, derive the parallel-propagating right-hand circularly polarized whistler-mode dispersion in the low-frequency limit where it becomes quadratic in $k_{\\parallel}$. From this quadratic dispersion, obtain the phase velocity $v_{\\phi} = \\omega/k_{\\parallel}$ and group velocity $v_{g} = \\partial \\omega / \\partial k_{\\parallel}$, and then evaluate the ratio $v_{g}/v_{\\phi}$.\n\nUse the following physically realistic parameters, representative of the heliospheric plasma near $1\\,\\mathrm{AU}$: $B_{0} = 5.0 \\times 10^{-9}\\,\\mathrm{T}$ and $n_{e} = 5.0 \\times 10^{6}\\,\\mathrm{m}^{-3}$. Define the electron cyclotron frequency $\\Omega_{e} \\equiv e B_{0}/m_{e}$ and the electron plasma frequency $\\omega_{pe} \\equiv \\sqrt{n_{e} e^{2}/(m_{e} \\epsilon_{0})}$, where $e$ is the elementary charge, $m_{e}$ is the electron mass, and $\\epsilon_{0}$ is the vacuum permittivity. Express the final ratio $v_{g}/v_{\\phi}$ as a dimensionless number. No rounding is required.",
            "solution": "The goal is to derive the whistler-mode dispersion from first principles for parallel propagation, obtain its quadratic $k_{\\parallel}$ limit, and then compute phase and group velocities and their ratio.\n\nWe consider a cold electron fluid (ions taken as immobile) with uniform background magnetic field $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$. Small-amplitude wave fields and electron velocity perturbations are taken to vary as $\\exp\\!\\left(i k_{\\parallel} z - i \\omega t\\right)$.\n\nThe relevant fundamental laws are:\n- Maxwell–Faraday law: $\\nabla \\times \\mathbf{E} = - \\partial \\mathbf{B}/\\partial t$.\n- Maxwell–Ampere law: $\\nabla \\times \\mathbf{B} = \\mu_{0} \\epsilon_{0} \\partial \\mathbf{E}/\\partial t + \\mu_{0} \\mathbf{J}$.\n- Linearized electron momentum equation (cold, collisionless): $m_{e}\\,\\partial \\delta \\mathbf{v}_{e}/\\partial t = - e\\left(\\delta \\mathbf{E} + \\delta \\mathbf{v}_{e} \\times \\mathbf{B}_{0}\\right)$.\n- Current density from electron motion: $\\mathbf{J} = - e n_{e}\\,\\delta \\mathbf{v}_{e}$.\n\nWe take parallel propagation with transverse fields and right-hand circular polarization, so $\\delta \\mathbf{E}_{\\perp}$ has components satisfying $\\delta E_{y} = i\\,\\delta E_{x}$. Solving the electron momentum equation for $\\delta \\mathbf{v}_{e}$ in terms of $\\delta \\mathbf{E}_{\\perp}$ yields the familiar cyclotron response. Write the momentum equation in Fourier space (with $\\exp\\!\\left(i k_{\\parallel} z - i \\omega t\\right)$ convention):\n\n$$\n- i \\omega m_{e}\\,\\delta \\mathbf{v}_{e} = - e\\left(\\delta \\mathbf{E} + \\delta \\mathbf{v}_{e} \\times \\mathbf{B}_{0}\\right).\n$$\n\nFor $\\mathbf{B}_{0} = B_{0} \\hat{\\mathbf{z}}$, the transverse components obey\n\n$$\n\\begin{pmatrix}\n- i \\omega & \\Omega_{e} \\\\\n- \\Omega_{e} & - i \\omega\n\\end{pmatrix}\n\\begin{pmatrix}\n\\delta v_{x} \\\\\n\\delta v_{y}\n\\end{pmatrix}\n= - \\frac{e}{m_{e}}\n\\begin{pmatrix}\n\\delta E_{x} \\\\\n\\delta E_{y}\n\\end{pmatrix},\n\\quad\n\\Omega_{e} \\equiv \\frac{e B_{0}}{m_{e}}.\n$$\n\nThe determinant is $\\Omega_{e}^{2} - \\omega^{2}$, and the solution has\n\n$$\n\\delta v_{x} = - \\frac{e}{m_{e}} \\frac{- i \\omega\\,\\delta E_{x} - \\Omega_{e}\\,\\delta E_{y}}{\\Omega_{e}^{2} - \\omega^{2}},\n\\qquad\n\\delta v_{y} = - \\frac{e}{m_{e}} \\frac{+\\Omega_{e}\\,\\delta E_{x} - i \\omega\\,\\delta E_{y}}{\\Omega_{e}^{2} - \\omega^{2}}.\n$$\n\nImposing right-hand circular polarization $\\delta E_{y} = i\\,\\delta E_{x}$ yields\n\n$$\n\\delta v_{x} = + \\frac{e}{m_{e}}\\,\\frac{i\\left(\\omega + \\Omega_{e}\\right)}{\\Omega_{e}^{2} - \\omega^{2}}\\,\\delta E_{x},\n\\qquad\n\\delta v_{y} = i\\,\\delta v_{x}.\n$$\n\nThus the current–field relation for the $x$-component is\n\n$$\n\\frac{J_{x}}{\\delta E_{x}} = - e n_{e}\\,\\frac{\\delta v_{x}}{\\delta E_{x}} = - i\\,\\frac{e^{2} n_{e}}{m_{e}}\\,\\frac{\\omega + \\Omega_{e}}{\\Omega_{e}^{2} - \\omega^{2}}.\n$$\n\n\nNow use Maxwell’s equations to connect $\\mathbf{J}$ and $\\delta \\mathbf{E}$. In Fourier space, Faraday’s law gives $\\mathbf{B} = \\frac{1}{\\omega}\\,\\mathbf{k} \\times \\mathbf{E}$ for transverse waves. Ampere’s law becomes\n\n$$\ni\\,\\mathbf{k} \\times \\mathbf{B} = - i\\,\\mu_{0} \\epsilon_{0} \\omega\\,\\mathbf{E} + \\mu_{0}\\,\\mathbf{J}.\n$$\n\nSubstituting $\\mathbf{B}$ and simplifying using $\\mathbf{k} \\cdot \\mathbf{E} = 0$ for transverse waves yields the wave equation\n\n$$\n\\left(c^{2} k_{\\parallel}^{2} - \\omega^{2}\\right)\\,\\mathbf{E} = i\\,\\frac{\\omega}{\\epsilon_{0}}\\,\\mathbf{J}.\n$$\n\nEquating the $x$-components and dividing by $\\omega^{2}$ gives\n\n$$\n\\left(\\frac{c^{2} k_{\\parallel}^{2}}{\\omega^{2}} - 1\\right) = i\\,\\frac{1}{\\epsilon_{0}\\,\\omega}\\,\\frac{J_{x}}{\\delta E_{x}}.\n$$\n\nIntroduce the refractive index $n^{2} \\equiv c^{2} k_{\\parallel}^{2}/\\omega^{2}$. Using the current–field ratio above and the electron plasma frequency $\\omega_{pe}^{2} \\equiv \\frac{n_{e} e^{2}}{m_{e} \\epsilon_{0}}$, we find\n\n$$\nn^{2} - 1 = i\\,\\frac{1}{\\epsilon_{0}\\,\\omega}\\left[- i\\,\\frac{e^{2} n_{e}}{m_{e}}\\,\\frac{\\omega + \\Omega_{e}}{\\Omega_{e}^{2} - \\omega^{2}}\\right]\n= \\frac{\\omega_{pe}^{2}}{\\omega}\\,\\frac{\\omega + \\Omega_{e}}{\\Omega_{e}^{2} - \\omega^{2}}.\n$$\n\nUsing $\\Omega_{e}^{2} - \\omega^{2} = \\left(\\Omega_{e} - \\omega\\right)\\left(\\Omega_{e} + \\omega\\right)$, we cancel the $\\left(\\Omega_{e} + \\omega\\right)$ factor to obtain the parallel right-hand mode (whistler/R-mode) dispersion:\n\n$$\nn^{2} = 1 + \\frac{\\omega_{pe}^{2}}{\\omega\\left(\\Omega_{e} - \\omega\\right)}.\n$$\n\nIn the low-frequency whistler limit $\\omega \\ll \\Omega_{e}$, this reduces to\n\n$$\nn^{2} \\simeq \\frac{\\omega_{pe}^{2}}{\\omega\\,\\Omega_{e}},\n$$\n\nwhich implies\n\n$$\n\\frac{c^{2} k_{\\parallel}^{2}}{\\omega^{2}} \\simeq \\frac{\\omega_{pe}^{2}}{\\omega\\,\\Omega_{e}}\n\\quad \\Rightarrow \\quad\n\\omega \\simeq \\frac{\\Omega_{e} c^{2}}{\\omega_{pe}^{2}}\\,k_{\\parallel}^{2}.\n$$\n\nThis is the quadratic whistler dispersion, $\\omega = \\alpha\\,k_{\\parallel}^{2}$, with\n\n$$\n\\alpha \\equiv \\frac{\\Omega_{e} c^{2}}{\\omega_{pe}^{2}}.\n$$\n\n\nFrom $\\omega(k_{\\parallel}) = \\alpha\\,k_{\\parallel}^{2}$, the phase velocity and group velocity are\n\n$$\nv_{\\phi} \\equiv \\frac{\\omega}{k_{\\parallel}} = \\alpha\\,k_{\\parallel},\n\\qquad\nv_{g} \\equiv \\frac{\\partial \\omega}{\\partial k_{\\parallel}} = 2\\,\\alpha\\,k_{\\parallel}.\n$$\n\nTherefore, the ratio of group velocity to phase velocity is\n\n$$\n\\frac{v_{g}}{v_{\\phi}} = \\frac{2\\,\\alpha\\,k_{\\parallel}}{\\alpha\\,k_{\\parallel}} = 2.\n$$\n\n\nThis ratio is independent of the plasma parameters $B_{0}$ and $n_{e}$ for the quadratic dispersion. Using the given $B_{0} = 5.0 \\times 10^{-9}\\,\\mathrm{T}$ and $n_{e} = 5.0 \\times 10^{6}\\,\\mathrm{m}^{-3}$ to define $\\Omega_{e}$ and $\\omega_{pe}$ confirms the quadratic form and the parameter independence of the ratio in this asymptotic regime. Hence the requested dimensionless ratio is exactly $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "Astrophysical plasmas are rarely uniform; they are structured by density gradients that form ducts and cavities. To understand how whistler waves propagate through these complex environments, we can employ the powerful technique of Hamiltonian ray tracing. This exercise uses the dispersion relation derived previously as the Hamiltonian to trace the path of a wave packet . By deriving and applying the ray equations, you will see how the wave's wavenumber, $k_{\\parallel}$, dynamically adjusts to local changes in plasma density, a fundamental mechanism behind the guiding of whistler waves along magnetic field lines in the magnetosphere.",
            "id": "4235810",
            "problem": "Consider a cold, magnetized electron plasma with a uniform background magnetic field $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ and a spatially varying electron number density $n_e(\\mathbf{r})$. Ions are assumed to be stationary and contribute only to neutrality. In the low-frequency whistler regime where $\\omega \\ll \\Omega_e$ and under the cold plasma approximation, the local dispersion relation for the whistler branch is\n$$\n\\omega(\\mathbf{r},\\mathbf{k}) = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(\\mathbf{r})}\\, k_\\parallel^2,\n$$\nwhere $\\Omega_e = \\frac{e B_0}{m_e}$ is the electron cyclotron frequency, $\\omega_{pe}(\\mathbf{r}) = \\sqrt{\\frac{n_e(\\mathbf{r}) e^2}{\\varepsilon_0 m_e}}$ is the electron plasma frequency, $c$ is the speed of light in vacuum, $e$ is the elementary charge, $m_e$ is the electron mass, and $k_\\parallel = \\mathbf{k} \\cdot \\hat{\\mathbf{z}}$ is the component of the wavevector parallel to $\\mathbf{B}_0$.\n\nUsing Hamiltonian ray tracing with Hamiltonian $H(\\mathbf{r},\\mathbf{k}) = \\omega(\\mathbf{r},\\mathbf{k})$, the rays obey\n$$\n\\dot{\\mathbf{r}} = \\nabla_{\\mathbf{k}} \\omega(\\mathbf{r},\\mathbf{k}), \\quad \\dot{\\mathbf{k}} = -\\nabla_{\\mathbf{r}} \\omega(\\mathbf{r},\\mathbf{k}),\n$$\nwhere the overdot denotes a time derivative. Restrict attention to one-dimensional inhomogeneity along the magnetic field, that is, take $n_e(\\mathbf{r}) = n_e(z)$ and assume $\\mathbf{k} = k_\\parallel \\hat{\\mathbf{z}}$. Starting from the above fundamental laws and definitions, perform the following:\n\n1. Write explicitly the one-dimensional ray equations for $z(t)$ and $k_\\parallel(t)$ implied by the given Hamiltonian. Do not skip steps in moving from the general Hamiltonian form to the explicit one-dimensional system.\n\n2. Using the physical constraint that the medium is stationary in time, explain whether $\\omega$ is constant along the ray and use that to outline qualitatively how $k_\\parallel$ evolves as a function of position along a field-aligned density duct $n_e(z)$.\n\n3. Implement a program that integrates the derived one-dimensional Hamiltonian ray equations for the following test suite of cases. In each case, use the given parameters, initialize at $z(0) = 0$ with $k_\\parallel(0)$ chosen to satisfy the dispersion relation at $z=0$ for a prescribed constant angular frequency $\\omega$, and integrate forward in time until the ray reaches a specified position $z = z_{\\mathrm{end}}$. Report the final parallel wavenumber $k_\\parallel(z_{\\mathrm{end}})$ in units of $\\mathrm{m}^{-1}$.\n\n   Use the following constants (in SI units): $e = 1.602176634\\times 10^{-19}$, $m_e = 9.1093837015\\times 10^{-31}$, $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$, $c = 2.99792458\\times 10^{8}$. For all cases, take $B_0 = 200 \\times 10^{-9}$ and $\\omega = 2000$.\n\n   Define the density profile by $n_e(z) = n_0 \\left(1 + \\beta z\\right)$ and ensure $n_e(z) > 0$ on the interval $[0, z_{\\mathrm{end}}]$. The cases are:\n\n   - Case A (uniform medium): $n_0 = 2.0\\times 10^{6}$, $\\beta = 0.0$, $z_{\\mathrm{end}} = 5.0\\times 10^{5}$.\n   - Case B (increasing density duct): $n_0 = 2.0\\times 10^{6}$, $\\beta = 1.0\\times 10^{-6}$, $z_{\\mathrm{end}} = 1.0\\times 10^{6}$.\n   - Case C (decreasing density duct): $n_0 = 2.0\\times 10^{6}$, $\\beta = -5.0\\times 10^{-7}$, $z_{\\mathrm{end}} = 1.0\\times 10^{6}$.\n\n   Express the final values of $k_\\parallel(z_{\\mathrm{end}})$ in $\\mathrm{m}^{-1}$ as floating-point numbers.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC]\"), where each entry is the final $k_\\parallel(z_{\\mathrm{end}})$ for Cases A, B, and C, respectively, in units of $\\mathrm{m}^{-1}$.",
            "solution": "### 1. Derivation of the One-Dimensional Ray Equations\n\nThe system is described by the Hamiltonian $H(\\mathbf{r}, \\mathbf{k}) = \\omega(\\mathbf{r}, \\mathbf{k})$, where $\\omega$ is the local whistler wave dispersion relation. For the specified one-dimensional case with inhomogeneity only along the $\\hat{\\mathbf{z}}$ direction, $n_e(\\mathbf{r}) = n_e(z)$, and for a wave propagating purely parallel to the magnetic field, $\\mathbf{k} = k_\\parallel \\hat{\\mathbf{z}}$, the position vector reduces to $\\mathbf{r} = z\\hat{\\mathbf{z}}$ and the wavevector to $\\mathbf{k} = k_\\parallel\\hat{\\mathbf{z}}$.\n\nThe Hamiltonian becomes a function of the scalar phase space coordinates $(z, k_\\parallel)$:\n$$\nH(z, k_\\parallel) = \\omega(z, k_\\parallel) = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} k_\\parallel^2\n$$\nwhere $\\Omega_e = \\frac{e B_0}{m_e}$ is a constant, and the electron plasma frequency squared, $\\omega_{pe}^2(z) = \\frac{n_e(z) e^2}{\\varepsilon_0 m_e}$, depends on position $z$ through the electron density $n_e(z)$.\n\nThe one-dimensional Hamiltonian ray equations are:\n$$\n\\dot{z} = \\frac{dz}{dt} = \\frac{\\partial H}{\\partial k_\\parallel}\n$$\n$$\n\\dot{k_\\parallel} = \\frac{dk_\\parallel}{dt} = -\\frac{\\partial H}{\\partial z}\n$$\n\nWe calculate the required partial derivatives:\n\nFirst, the derivative with respect to $k_\\parallel$:\n$$\n\\frac{\\partial H}{\\partial k_\\parallel} = \\frac{\\partial}{\\partial k_\\parallel} \\left( \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} k_\\parallel^2 \\right) = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} (2 k_\\parallel)\n$$\nThis gives the equation for the ray's position, which is the group velocity component along $\\hat{\\mathbf{z}}$:\n$$\n\\dot{z} = \\frac{2 \\Omega_e c^2 k_\\parallel}{\\omega_{pe}^2(z)}\n$$\n\nSecond, the derivative with respect to $z$:\n$$\n\\frac{\\partial H}{\\partial z} = \\frac{\\partial}{\\partial z} \\left( \\frac{\\Omega_e c^2 k_\\parallel^2}{\\omega_{pe}^2(z)} \\right) = \\Omega_e c^2 k_\\parallel^2 \\frac{\\partial}{\\partial z} \\left( \\frac{1}{\\omega_{pe}^2(z)} \\right)\n$$\nUsing the chain rule, $\\frac{\\partial}{\\partial z} \\left( \\frac{1}{u} \\right) = -\\frac{1}{u^2} \\frac{du}{dz}$, with $u = \\omega_{pe}^2(z)$:\n$$\n\\frac{\\partial H}{\\partial z} = \\Omega_e c^2 k_\\parallel^2 \\left( -\\frac{1}{(\\omega_{pe}^2(z))^2} \\frac{d(\\omega_{pe}^2(z))}{dz} \\right)\n$$\nSince $\\omega_{pe}^2(z) = \\frac{n_e(z) e^2}{\\varepsilon_0 m_e}$, its derivative is $\\frac{d(\\omega_{pe}^2(z))}{dz} = \\frac{e^2}{\\varepsilon_0 m_e} \\frac{dn_e}{dz}$. We can express this in terms of $\\omega_{pe}^2(z)$ itself: $\\frac{d(\\omega_{pe}^2(z))}{dz} = \\frac{\\omega_{pe}^2(z)}{n_e(z)} \\frac{dn_e}{dz}$.\nSubstituting this back:\n$$\n\\frac{\\partial H}{\\partial z} = -\\frac{\\Omega_e c^2 k_\\parallel^2}{(\\omega_{pe}^2(z))^2} \\left( \\frac{\\omega_{pe}^2(z)}{n_e(z)} \\frac{dn_e}{dz} \\right) = - \\left( \\frac{\\Omega_e c^2 k_\\parallel^2}{\\omega_{pe}^2(z)} \\right) \\frac{1}{n_e(z)}\\frac{dn_e}{dz}\n$$\nRecognizing the term in parentheses as the Hamiltonian $H=\\omega$ itself:\n$$\n\\frac{\\partial H}{\\partial z} = -\\omega \\frac{1}{n_e(z)}\\frac{dn_e}{dz}\n$$\nThis gives the equation for the ray's wavenumber:\n$$\n\\dot{k_\\parallel} = - \\left( -\\omega \\frac{1}{n_e(z)}\\frac{dn_e}{dz} \\right) = \\omega \\frac{1}{n_e(z)}\\frac{dn_e}{dz}\n$$\nThe explicit one-dimensional ray equations are:\n$$\n\\frac{dz}{dt} = \\frac{2 \\Omega_e c^2 k_\\parallel(t)}{\\omega_{pe}^2(z(t))}\n$$\n$$\n\\frac{dk_\\parallel}{dt} = \\omega(z(t), k_\\parallel(t)) \\frac{1}{n_e(z(t))} \\frac{dn_e}{dz}\n$$\n\n### 2. Conservation of Frequency and Qualitative Behavior of $k_\\parallel$\n\nThe Hamiltonian $H(\\mathbf{r}, \\mathbf{k})$ does not have any explicit dependence on time $t$, i.e., $\\frac{\\partial H}{\\partial t} = 0$. This is a direct consequence of the physical assumption that the medium is stationary (the density profile $n_e(z)$ and magnetic field $B_0$ are constant in time). For such a system, the total time derivative of the Hamiltonian along a ray trajectory is zero:\n$$\n\\frac{d H}{dt} = \\frac{\\partial H}{\\partial t} + \\sum_i \\left( \\frac{\\partial H}{\\partial r_i} \\dot{r}_i + \\frac{\\partial H}{\\partial k_i} \\dot{k}_i \\right) = 0 + \\nabla_{\\mathbf{r}} H \\cdot \\dot{\\mathbf{r}} + \\nabla_{\\mathbf{k}} H \\cdot \\dot{\\mathbf{k}}\n$$\nSubstituting Hamilton's equations $\\dot{\\mathbf{r}} = \\nabla_{\\mathbf{k}}H$ and $\\dot{\\mathbf{k}} = -\\nabla_{\\mathbf{r}}H$:\n$$\n\\frac{d H}{dt} = \\nabla_{\\mathbf{r}} H \\cdot (\\nabla_{\\mathbf{k}}H) + \\nabla_{\\mathbf{k}} H \\cdot (-\\nabla_{\\mathbf{r}}H) = 0\n$$\nSince $H = \\omega$, this implies that the wave frequency $\\omega$ is conserved along the ray path.\n\nWith $\\omega$ being a constant, we can analyze the dispersion relation to understand the evolution of $k_\\parallel$ as a function of position $z$:\n$$\n\\omega = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} k_\\parallel^2(z) = \\text{constant}\n$$\nSubstituting $\\omega_{pe}^2(z) = \\frac{n_e(z) e^2}{\\varepsilon_0 m_e}$:\n$$\n\\omega = \\frac{\\Omega_e c^2 \\varepsilon_0 m_e}{e^2 n_e(z)} k_\\parallel^2(z)\n$$\nRearranging for $k_\\parallel^2(z)$, we find:\n$$\nk_\\parallel^2(z) = \\omega \\left( \\frac{e^2}{\\Omega_e c^2 \\varepsilon_0 m_e} \\right) n_e(z)\n$$\nSince the terms $\\omega$, $e$, $\\Omega_e$, $c$, $\\varepsilon_0$, and $m_e$ are all constant, we have the direct proportionality:\n$$\nk_\\parallel^2(z) \\propto n_e(z) \\implies k_\\parallel(z) \\propto \\sqrt{n_e(z)}\n$$\n(assuming $k_\\parallel > 0$).\n\nTherefore, as a whistler wave ray propagates along a field-aligned density duct $n_e(z)$:\n- If the ray moves into a region of **increasing density**, $n_e(z)$ increases, and consequently the parallel wavenumber $k_\\parallel$ must **increase**.\n- If the ray moves into a region of **decreasing density**, $n_e(z)$ decreases, and consequently the parallel wavenumber $k_\\parallel$ must **decrease**.\n\n### 3. Calculation of Final Wavenumber\n\nThe conservation of $\\omega$ provides a direct analytical method to calculate the final wavenumber $k_\\parallel(z_{\\mathrm{end}})$, bypassing the need for a numerical integration of the ray equations over time. The wavenumber at any position $z$ is determined solely by the constant frequency $\\omega$ and the local density $n_e(z)$.\nThe relationship is given by:\n$$\nk_\\parallel(z) = \\sqrt{\\omega \\frac{\\omega_{pe}^2(z)}{\\Omega_e c^2}} = \\sqrt{\\omega \\frac{n_e(z) e^2}{\\Omega_e c^2 \\varepsilon_0 m_e}}\n$$\nWe can simplify the constant of proportionality by substituting $\\Omega_e = \\frac{e B_0}{m_e}$:\n$$\nk_\\parallel(z) = \\sqrt{\\omega \\frac{n_e(z) e^2}{(e B_0/m_e) c^2 \\varepsilon_0 m_e}} = \\sqrt{\\frac{\\omega e}{B_0 c^2 \\varepsilon_0} n_e(z)}\n$$\nThe value of $k_\\parallel(z_{\\mathrm{end}})$ is therefore found by evaluating this expression at $z=z_{\\mathrm{end}}$ using the given density profile $n_e(z) = n_0(1+\\beta z)$.\n\n**Constants:**\n- $e = 1.602176634\\times 10^{-19}$ C\n- $m_e = 9.1093837015\\times 10^{-31}$ kg\n- $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$ F/m\n- $c = 2.99792458\\times 10^{8}$ m/s\n- $B_0 = 200 \\times 10^{-9}$ T\n- $\\omega = 2000$ rad/s\n\n**Calculations for each case:**\n\n**Case A:**\n- $n_0 = 2.0\\times 10^{6}$ m$^{-3}$\n- $\\beta = 0.0$ m$^{-1}$\n- $z_{\\mathrm{end}} = 5.0\\times 10^{5}$ m\n- $n_e(z_{\\mathrm{end}}) = n_0(1 + 0) = 2.0\\times 10^{6}$ m$^{-3}$\n- $k_{\\parallel, A} = \\sqrt{\\frac{2000 \\times 1.602...\\times 10^{-19}}{200\\times 10^{-9} \\times (2.997...\\times 10^{8})^2 \\times 8.854...\\times 10^{-12}} \\times 2.0\\times 10^{6}} \\approx 6.34508 \\times 10^{-5}$ m$^{-1}$\n\n**Case B:**\n- $n_0 = 2.0\\times 10^{6}$ m$^{-3}$\n- $\\beta = 1.0\\times 10^{-6}$ m$^{-1}$\n- $z_{\\mathrm{end}} = 1.0\\times 10^{6}$ m\n- $n_e(z_{\\mathrm{end}}) = (2.0\\times 10^{6})(1 + 1.0\\times 10^{-6} \\times 1.0\\times 10^{6}) = 2.0\\times 10^{6} \\times 2 = 4.0\\times 10^{6}$ m$^{-3}$\n- Since $n_e(z_{\\mathrm{end}})$ is twice that of Case A's initial density and $k_\\parallel \\propto \\sqrt{n_e}$, $k_{\\parallel, B} = k_{\\parallel, A}(n_0=2\\text{e}6) \\times \\sqrt{2} \\approx 8.97327 \\times 10^{-5}$ m$^{-1}$.\n\n**Case C:**\n- $n_0 = 2.0\\times 10^{6}$ m$^{-3}$\n- $\\beta = -5.0\\times 10^{-7}$ m$^{-1}$\n- $z_{\\mathrm{end}} = 1.0\\times 10^{6}$ m\n- $n_e(z_{\\mathrm{end}}) = (2.0\\times 10^{6})(1 - 5.0\\times 10^{-7} \\times 1.0\\times 10^{6}) = 2.0\\times 10^{6} \\times 0.5 = 1.0\\times 10^{6}$ m$^{-3}$\n- Since $n_e(z_{\\mathrm{end}})$ is half that of Case A's initial density, $k_{\\parallel, C} = k_{\\parallel, A}(n_0=2\\text{e}6) / \\sqrt{2} \\approx 4.48664 \\times 10^{-5}$ m$^{-1}$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the final parallel wavenumber for whistler waves in a 1D inhomogeneous plasma.\n    \"\"\"\n\n    # Define physical constants in SI units.\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n    M_E = 9.1093837015e-31       # Electron mass (kg)\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    C_LIGHT = 2.99792458e8       # Speed of light in vacuum (m/s)\n\n    # Define problem parameters valid for all cases.\n    B0 = 200.0e-9  # Background magnetic field strength (T)\n    OMEGA = 2000.0    # Wave angular frequency (rad/s)\n\n    # Define the test cases.\n    # Each case is a tuple: (n0, beta, z_end)\n    # n0: initial electron number density (m^-3)\n    # beta: density gradient parameter (m^-1)\n    # z_end: final position (m)\n    test_cases = [\n        (2.0e6, 0.0, 5.0e5),      # Case A\n        (2.0e6, 1.0e-6, 1.0e6),   # Case B\n        (2.0e6, -5.0e-7, 1.0e6),  # Case C\n    ]\n\n    results = []\n    \n    # As derived in the solution, the frequency omega is constant along the ray path.\n    # This leads to an analytical expression for k_parallel(z) that depends only\n    # on the local density n_e(z), not on the path taken.\n    # The formula is: k_parallel^2 = omega * (n_e * e^2) / (Omega_e * c^2 * epsilon_0 * m_e)\n    # Substituting Omega_e = (e * B0) / m_e, this simplifies to:\n    # k_parallel^2 = omega * e * n_e / (B0 * c^2 * epsilon_0)\n    \n    # Pre-calculate the constant part of the expression for k_parallel^2.\n    const_factor = (OMEGA * E_CHARGE) / (B0 * C_LIGHT**2 * EPSILON_0)\n\n    for case in test_cases:\n        n0, beta, z_end = case\n\n        # Calculate the electron number density at the final position.\n        n_e_end = n0 * (1.0 + beta * z_end)\n        \n        # Calculate the final parallel wavenumber using the analytical formula.\n        # We take the positive root, assuming forward propagation.\n        k_parallel_end = np.sqrt(const_factor * n_e_end)\n        \n        results.append(k_parallel_end)\n\n    # Print the results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While fluid models provide a good description of wave propagation, a complete picture requires considering the kinetic interactions between waves and individual plasma particles. This practice moves beyond the cold plasma approximation to explore Landau damping, a process where waves exchange energy with resonant electrons. You will calculate the damping rate for a whistler wave interacting with a non-Maxwellian electron population, which is more representative of observed distributions in space plasmas . This exercise demonstrates a crucial concept: the stability of a wave—whether it damps away or grows in amplitude—is determined by the slope of the particle distribution function at the wave's phase velocity.",
            "id": "372928",
            "problem": "Whistler-mode waves are right-hand polarized electromagnetic waves that can propagate in magnetized plasmas, playing a crucial role in the dynamics of the Earth's radiation belts. Consider a whistler-mode wave with frequency $\\omega$ and wave vector $\\mathbf{k}$ propagating parallel to a uniform background magnetic field, $\\mathbf{B}_0 = B_0 \\mathbf{\\hat{z}}$. While these waves are primarily transverse, a kinetic treatment reveals a small parallel electric field component, which can lead to Landau damping or growth through resonant interaction with electrons.\n\nThe Landau damping rate, $\\gamma$, is given by the expression:\n$$\n\\gamma = \\mathcal{K}(\\omega, k) \\left. \\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} \\right|_{v_\\| = v_{ph}}\n$$\nwhere $v_{ph} = \\omega/k$ is the wave's parallel phase velocity, and the coefficient $\\mathcal{K}(\\omega, k)$ is given by:\n$$\n\\mathcal{K}(\\omega, k) = \\frac{\\pi \\omega_{pe}^2 \\omega^3}{2 k^4 c^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})}\n$$\nHere, $\\omega_{pe}$ is the electron plasma frequency, $\\Omega_{ce}$ is the electron cyclotron frequency, and $c$ is the speed of light.\n\nIn a particular region of the magnetosphere, observations suggest that the parallel electron velocity distribution function, $f_e(v_\\|)$, is not a simple Maxwellian. Instead, it is well-approximated by a symmetric kappa distribution with a depleted core, described by the following function:\n$$\nf_e(v_\\|) = A \\left[ \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+1)} - \\delta \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\nIn this expression, $A$ is the normalization constant, $v_{th}$ is the characteristic electron thermal speed, $\\kappa$ is the spectral index (a real number greater than $3/2$), $\\delta$ is a dimensionless parameter controlling the depth of the core depletion ($0 \\le \\delta \\le 1$), and $w$ is a dimensionless parameter controlling the width of the depletion.\n\nDerive the analytical expression for the whistler-mode Landau damping rate, $\\gamma$, for this plasma. The final answer should be expressed in terms of $\\omega, k, \\omega_{pe}, \\Omega_{ce}, c, A, \\kappa, v_{th}, \\delta,$ and $w$.",
            "solution": "The goal is to derive the Landau damping rate $\\gamma$ for a whistler wave interacting with electrons described by a specific velocity distribution function $f_e(v_\\|)$.\n\nThe given formula for the damping rate is:\n$$\n\\gamma = \\mathcal{K}(\\omega, k) \\left. \\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} \\right|_{v_\\| = v_{ph}}\n$$\nwhere $v_{ph} = \\omega/k$ and $\\mathcal{K}(\\omega, k) = \\frac{\\pi \\omega_{pe}^2 \\omega^3}{2 k^4 c^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})}$.\n\nThe electron distribution function is:\n$$\nf_e(v_\\|) = A \\left[ \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+1)} - \\delta \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**Step 1: Differentiate the distribution function $f_e(v_\\|)$ with respect to $v_\\|$.**\n\nWe apply the chain rule to each term inside the brackets.\nFor the kappa-distribution term:\n$$\n\\frac{\\partial}{\\partial v_\\|} \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+1)} = -(\\kappa+1) \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} \\cdot \\frac{\\partial}{\\partial v_\\|} \\left(\\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)\n$$\n$$\n= -(\\kappa+1) \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} \\cdot \\left(\\frac{2v_\\|}{\\kappa v_{th}^2}\\right)\n$$\n\nFor the depleted-core (Gaussian) term:\n$$\n\\frac{\\partial}{\\partial v_\\|} \\left[-\\delta \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right)\\right] = -\\delta \\cdot \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\cdot \\frac{\\partial}{\\partial v_\\|} \\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right)\n$$\n$$\n= -\\delta \\cdot \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\cdot \\left(-\\frac{2v_\\|}{w^2 v_{th}^2}\\right) = \\frac{2\\delta v_\\|}{w^2 v_{th}^2} \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right)\n$$\n\nCombining these results, the full derivative is:\n$$\n\\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} = A \\left[ -(\\kappa+1) \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} \\left(\\frac{2v_\\|}{\\kappa v_{th}^2}\\right) + \\frac{2\\delta v_\\|}{w^2 v_{th}^2} \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\nWe can factor out common terms:\n$$\n\\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} = -2A \\frac{v_\\|}{v_{th}^2} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**Step 2: Evaluate the derivative at the resonant phase velocity $v_\\| = v_{ph} = \\omega/k$.**\n\nWe substitute $v_\\| = v_{ph}$ into the expression for the derivative:\n$$\n\\left. \\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} \\right|_{v_\\| = v_{ph}} = -2A \\frac{v_{ph}}{v_{th}^2} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_{ph}^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_{ph}^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**Step 3: Substitute the evaluated derivative into the formula for $\\gamma$.**\n\n$$\n\\gamma = \\mathcal{K}(\\omega, k) \\cdot \\left( -2A \\frac{v_{ph}}{v_{th}^2} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_{ph}^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_{ph}^2}{w^2 v_{th}^2}\\right) \\right] \\right)\n$$\nNow, substitute the full expression for $\\mathcal{K}(\\omega, k)$:\n$$\n\\gamma = \\left( \\frac{\\pi \\omega_{pe}^2 \\omega^3}{2 k^4 c^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\right) \\cdot \\left( -2A \\frac{v_{ph}}{v_{th}^2} \\left[ \\dots \\right] \\right)\n$$\nThe factor of 2 cancels out.\n$$\n\\gamma = - \\frac{\\pi A \\omega_{pe}^2 \\omega^3 v_{ph}}{k^4 c^2 v_{th}^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_{ph}^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_{ph}^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**Step 4: Final simplification.**\n\nUsing $v_{ph} = \\omega/k$, we can simplify the prefactor:\n$$\n\\frac{\\omega^3 v_{ph}}{k^4} = \\frac{\\omega^3 (\\omega/k)}{k^4} = \\frac{\\omega^4}{k^5}\n$$\nSo the expression for $\\gamma$ becomes:\n$$\n\\gamma = - \\frac{\\pi A \\omega_{pe}^2 \\omega^4}{k^5 c^2 v_{th}^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{\\omega^2}{k^2 \\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{\\omega^2}{k^2 w^2 v_{th}^2}\\right) \\right]\n$$\nThis is the final expression for the Landau damping rate.",
            "answer": "$$\n\\boxed{- \\frac{\\pi A \\omega_{pe}^2 \\omega^4}{k^5 c^2 v_{th}^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{\\omega^2}{k^2 \\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{\\omega^2}{k^2 w^2 v_{th}^2}\\right) \\right]}\n$$"
        }
    ]
}