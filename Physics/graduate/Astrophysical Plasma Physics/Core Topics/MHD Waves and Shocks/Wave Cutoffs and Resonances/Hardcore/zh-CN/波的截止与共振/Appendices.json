{
    "hands_on_practices": [
        {
            "introduction": "该练习回归到磁化等离子体中波传播的基础知识。通过从双流体方程推导色散关系，我们可以直接观察到等离子体对电磁场的集体响应如何导致不同的传播模式及其相关的截止频率。这项练习  加强了对等离子体参数与波行为之间基本联系的理解，是掌握截止概念的第一步。",
            "id": "4064461",
            "problem": "考虑一个均匀、冷、磁化、准中性的电子-离子等离子体，其平衡数密度为 $n_0$，背景磁场为 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，且没有平衡流。将电子和单电荷离子都视为冷流体，并忽略碰撞。沿着背景磁场发射一个角频率为 $\\omega$、波矢为 $\\mathbf{k} = k \\hat{\\mathbf{z}}$ 的平面电磁波，使该波为圆偏振波。从线性化的冷双流体运动方程和 Maxwell 方程组出发，推导平行传播的色散关系，对于右旋圆偏振为 $n^2(\\omega) = R(\\omega)$，对于左旋圆偏振为 $n^2(\\omega) = L(\\omega)$，其中 $n \\equiv c k / \\omega$ 是折射率，$R(\\omega)$ 和 $L(\\omega)$ 分别是右旋和左旋响应函数。使用带符号的回旋频率 $\\tilde{\\Omega}_s \\equiv q_s B_0 / m_s$（对于组分 $s$，电子电荷 $q_e = -e$，离子电荷 $q_i = +e$）和等离子体频率 $\\omega_{ps}^2 \\equiv n_0 q_s^2 / (\\varepsilon_0 m_s)$，施加波的截止条件 $R(\\omega) = 0$ 和 $L(\\omega) = 0$，并求解相应的截止角频率 $\\omega_R$ 和 $\\omega_L$。\n\n假设为单电离电子-离子等离子体，并在电子-离子质量比 $m_e / m_i \\ll 1$ 的领头阶下进行计算，明确说明你为简化通用双组分表达式所使用的近似。用电子等离子体频率 $\\omega_{pe}$ 和电子回旋频率的幅值 $\\Omega_e \\equiv |q_e| B_0 / m_e$ 来表示得到的领头阶解析公式 $\\omega_R$ 和 $\\omega_L$。然后，对于给定的数值 $\\omega_{pe} = 6.0 \\times 10^{10}$ rad/s 和 $\\Omega_e = 1.5 \\times 10^{11}$ rad/s，计算这两个截止角频率的数值，并将其作为最终答案。\n\n将每个数值截止频率四舍五入到四位有效数字。最终的角频率以 rad/s 为单位表示。",
            "solution": "该问题要求推导在特定近似下，冷、均匀、磁化的电子-离子等离子体的平行传播色散关系，并随后求解截止频率。\n\n我们从流体组分 $s$（其中 $s$ 可以是电子 $e$ 或离子 $i$）在线性化的冷等离子体中的运动方程开始，背景磁场为 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。碰撞和平衡流被忽略。该方程为：\n$$\nm_s \\frac{\\partial \\mathbf{v}_{1s}}{\\partial t} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{1s} \\times \\mathbf{B}_0)\n$$\n这里，$m_s$ 是质量，$q_s$ 是电荷，$\\mathbf{v}_{1s}$ 是扰动流体速度，$\\mathbf{E}_1$ 是波电场。\n\n我们假设一个形式为 $\\exp(i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t))$ 的平面波解。对于平行传播，波矢为 $\\mathbf{k} = k \\hat{\\mathbf{z}}$。时间和空间导数变为 $\\frac{\\partial}{\\partial t} \\to -i\\omega$ 和 $\\nabla \\to i\\mathbf{k}$。运动方程变换为：\n$$\n-i\\omega m_s \\mathbf{v}_{1s} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{1s} \\times B_0 \\hat{\\mathbf{z}})\n$$\n为简化矢量代数，我们引入圆偏振分量。任何垂直于 $\\hat{\\mathbf{z}}$ 的矢量 $\\mathbf{A}$ 都可以用基矢量 $\\hat{\\mathbf{e}}_{\\pm} = \\hat{\\mathbf{x}} \\pm i\\hat{\\mathbf{y}}$ 写出。其分量为 $A_{\\pm} = A_x \\pm iA_y$。在此基底下，叉积被简化为：$(\\mathbf{v}_{1s} \\times B_0 \\hat{\\mathbf{z}})_{\\pm} = \\mp i B_0 v_{s\\pm}$。\n\n运动方程的垂直分量变为：\n$$\n-i\\omega m_s v_{s\\pm} = q_s E_{\\pm} \\mp i q_s B_0 v_{s\\pm}\n$$\n重新整理以求解 $v_{s\\pm}$：\n$$\nv_{s\\pm}(-i\\omega m_s \\pm i q_s B_0) = q_s E_{\\pm}\n$$\n$$\nv_{s\\pm} = \\frac{q_s E_{\\pm}}{-i(\\omega m_s \\mp q_s B_0)} = \\frac{i q_s E_{\\pm}}{m_s(\\omega \\mp q_s B_0 / m_s)}\n$$\n使用带符号的回旋频率 $\\tilde{\\Omega}_s \\equiv q_s B_0 / m_s$，我们有：\n$$\nv_{s\\pm} = \\frac{i q_s E_{\\pm}}{m_s(\\omega \\mp \\tilde{\\Omega}_s)}\n$$\n扰动电流密度为 $\\mathbf{J}_1 = \\sum_s n_0 q_s \\mathbf{v}_{1s}$。其圆偏振分量为：\n$$\nJ_{\\pm} = \\sum_s n_0 q_s v_{s\\pm} = \\sum_s n_0 q_s \\left( \\frac{i q_s E_{\\pm}}{m_s(\\omega \\mp \\tilde{\\Omega}_s)} \\right) = i E_{\\pm} \\sum_s \\frac{n_0 q_s^2}{m_s(\\omega \\mp \\tilde{\\Omega}_s)}\n$$\n引入等离子体频率的平方，$\\omega_{ps}^2 \\equiv n_0 q_s^2 / (\\varepsilon_0 m_s)$:\n$$\nJ_{\\pm} = i \\varepsilon_0 E_{\\pm} \\sum_s \\frac{\\omega_{ps}^2}{\\omega \\mp \\tilde{\\Omega}_s}\n$$\n接下来，我们使用 Maxwell 波动方程：$\\nabla \\times (\\nabla \\times \\mathbf{E}_1) = \\frac{\\omega^2}{c^2} \\mathbf{E}_1 + i \\omega \\mu_0 \\mathbf{J}_1$。\n当 $\\nabla = i k \\hat{\\mathbf{z}}$ 时，电场的横向分量方程为：\n$$\n-k^2 \\mathbf{E}_{1\\perp} = \\frac{\\omega^2}{c^2} \\mathbf{E}_{1\\perp} + i \\omega \\mu_0 \\mathbf{J}_{1\\perp}\n$$\n使用圆偏振分量并代入 $J_{\\pm}$：\n$$\n-k^2 E_{\\pm} = \\frac{\\omega^2}{c^2} E_{\\pm} + i \\omega \\mu_0 \\left( i \\varepsilon_0 E_{\\pm} \\sum_s \\frac{\\omega_{ps}^2}{\\omega \\mp \\tilde{\\Omega}_s} \\right)\n$$\n使用 $\\mu_0 \\varepsilon_0 = 1/c^2$：\n$$\n-k^2 E_{\\pm} = \\frac{\\omega^2}{c^2} E_{\\pm} - \\frac{\\omega}{c^2} E_{\\pm} \\sum_s \\frac{\\omega_{ps}^2}{\\omega \\mp \\tilde{\\Omega}_s}\n$$\n两边除以 $E_{\\pm}$（假设为非平凡波）并重新整理：\n$$\nk^2 = -\\frac{\\omega^2}{c^2} + \\frac{\\omega}{c^2} \\sum_s \\frac{\\omega_{ps}^2}{\\omega \\mp \\tilde{\\Omega}_s}\n$$\n两边乘以 $c^2/\\omega^2$ 并使用折射率定义 $n \\equiv ck/\\omega$：\n$$\nn^2 = 1 - \\frac{1}{\\omega} \\sum_s \\frac{\\omega_{ps}^2}{\\omega \\mp \\tilde{\\Omega}_s} = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega(\\omega \\mp \\tilde{\\Omega}_s)}\n$$\n分量 $E_{-} = E_x - iE_y$ 对应于右旋圆偏振（RCP）波，其旋转方向与离子相同。其色散关系使用通用公式 $\\mp$ 中的下符号，对应于分母项 $\\omega + \\tilde{\\Omega}_s$。这是 $n^2(\\omega) = R(\\omega)$。\n分量 $E_{+} = E_x + iE_y$ 对应于左旋圆偏振（LCP）波，其旋转方向与电子相同。其色散关系使用通用公式 $\\mp$ 中的上符号，对应于分母项 $\\omega - \\tilde{\\Omega}_s$。这是 $n^2(\\omega) = L(\\omega)$。\n\n对于单电离电子-离子等离子体，我们有 $q_e = -e$ 和 $q_i = +e$。带符号的回旋频率为 $\\tilde{\\Omega}_e = -e B_0/m_e = -\\Omega_e$ 和 $\\tilde{\\Omega}_i = +e B_0/m_i = \\Omega_i$，其中 $\\Omega_e \\equiv e B_0/m_e > 0$ 和 $\\Omega_i \\equiv e B_0/m_i > 0$。\n\n色散关系为：\n对于 R 波（RCP）：\n$$\nR(\\omega) = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + \\tilde{\\Omega}_e)} - \\frac{\\omega_{pi}^2}{\\omega(\\omega + \\tilde{\\Omega}_i)} = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega - \\Omega_e)} - \\frac{\\omega_{pi}^2}{\\omega(\\omega + \\Omega_i)}\n$$\n对于 L 波（LCP）：\n$$\nL(\\omega) = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega - \\tilde{\\Omega}_e)} - \\frac{\\omega_{pi}^2}{\\omega(\\omega - \\tilde{\\Omega}_i)} = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + \\Omega_e)} - \\frac{\\omega_{pi}^2}{\\omega(\\omega - \\Omega_i)}\n$$\n当折射率为零（$n=0$）时，发生波的截止。\n\n对于 R 波截止，我们设 $R(\\omega_R) = 0$：\n$$\n1 = \\frac{\\omega_{pe}^2}{\\omega_R(\\omega_R - \\Omega_e)} + \\frac{\\omega_{pi}^2}{\\omega_R(\\omega_R + \\Omega_i)}\n$$\n对于 L 波截止，我们设 $L(\\omega_L) = 0$：\n$$\n1 = \\frac{\\omega_{pe}^2}{\\omega_L(\\omega_L + \\Omega_e)} + \\frac{\\omega_{pi}^2}{\\omega_L(\\omega_L - \\Omega_i)}\n$$\n这些通常是关于 $\\omega$ 的三次方程。问题要求在 $m_e/m_i \\ll 1$ 的极限下求解。在此极限下，离子质量相对于电子质量实际上是无穷大（$m_i \\to \\infty$）。这意味着 $\\Omega_i = \\Omega_e (m_e/m_i) \\to 0$ 且 $\\omega_{pi}^2 = \\omega_{pe}^2 (m_e/m_i) \\to 0$。这个近似忽略了在高频下离子对动力学的贡献。\n\n将此近似应用于 R 波截止方程：\n$$\n1 \\approx \\frac{\\omega_{pe}^2}{\\omega_R(\\omega_R - \\Omega_e)}\n$$\n$$\n\\omega_R(\\omega_R - \\Omega_e) = \\omega_{pe}^2\n$$\n$$\n\\omega_R^2 - \\Omega_e \\omega_R - \\omega_{pe}^2 = 0\n$$\n这是一个关于 $\\omega_R$ 的二次方程。使用二次方程求根公式：\n$$\n\\omega_R = \\frac{\\Omega_e \\pm \\sqrt{(-\\Omega_e)^2 - 4(1)(-\\omega_{pe}^2)}}{2} = \\frac{\\Omega_e \\pm \\sqrt{\\Omega_e^2 + 4\\omega_{pe}^2}}{2}\n$$\n由于角频率 $\\omega_R$ 必须为正，我们取正根：\n$$\n\\omega_R = \\frac{1}{2} \\left( \\Omega_e + \\sqrt{\\Omega_e^2 + 4\\omega_{pe}^2} \\right)\n$$\n将相同的近似应用于 L 波截止方程：\n$$\n1 \\approx \\frac{\\omega_{pe}^2}{\\omega_L(\\omega_L + \\Omega_e)}\n$$\n$$\n\\omega_L(\\omega_L + \\Omega_e) = \\omega_{pe}^2\n$$\n$$\n\\omega_L^2 + \\Omega_e \\omega_L - \\omega_{pe}^2 = 0\n$$\n求解关于 $\\omega_L$ 的二次方程：\n$$\n\\omega_L = \\frac{-\\Omega_e \\pm \\sqrt{\\Omega_e^2 - 4(1)(-\\omega_{pe}^2)}}{2} = \\frac{-\\Omega_e \\pm \\sqrt{\\Omega_e^2 + 4\\omega_{pe}^2}}{2}\n$$\n同样，由于角频率 $\\omega_L$ 必须为正，我们取正根：\n$$\n\\omega_L = \\frac{1}{2} \\left( -\\Omega_e + \\sqrt{\\Omega_e^2 + 4\\omega_{pe}^2} \\right)\n$$\n现在我们使用给定的数据计算数值：$\\omega_{pe} = 6.0 \\times 10^{10}$ rad/s 和 $\\Omega_e = 1.5 \\times 10^{11}$ rad/s。\n\n首先，计算平方根下的公共项：\n$$\n\\Omega_e^2 = (1.5 \\times 10^{11})^2 = 2.25 \\times 10^{22} \\text{ (rad/s)}^2\n$$\n$$\n4\\omega_{pe}^2 = 4 \\times (6.0 \\times 10^{10})^2 = 4 \\times 3.6 \\times 10^{21} = 1.44 \\times 10^{22} \\text{ (rad/s)}^2\n$$\n$$\n\\Omega_e^2 + 4\\omega_{pe}^2 = (2.25 + 1.44) \\times 10^{22} = 3.69 \\times 10^{22} \\text{ (rad/s)}^2\n$$\n$$\n\\sqrt{\\Omega_e^2 + 4\\omega_{pe}^2} = \\sqrt{3.69 \\times 10^{22}} = \\sqrt{3.69} \\times 10^{11} \\approx 1.92093727 \\times 10^{11} \\text{ rad/s}\n$$\n现在，将此值代入 $\\omega_R$ 和 $\\omega_L$ 的表达式。\n\n对于 R 波截止频率 $\\omega_R$：\n$$\n\\omega_R = \\frac{1}{2} \\left( 1.5 \\times 10^{11} + 1.92093727 \\times 10^{11} \\right) \\text{ rad/s}\n$$\n$$\n\\omega_R = \\frac{1}{2} \\left( 3.42093727 \\times 10^{11} \\right) \\text{ rad/s} = 1.7104686 \\times 10^{11} \\text{ rad/s}\n$$\n四舍五入到四位有效数字，我们得到 $\\omega_R = 1.710 \\times 10^{11}$ rad/s。\n\n对于 L 波截止频率 $\\omega_L$：\n$$\n\\omega_L = \\frac{1}{2} \\left( -1.5 \\times 10^{11} + 1.92093727 \\times 10^{11} \\right) \\text{ rad/s}\n$$\n$$\n\\omega_L = \\frac{1}{2} \\left( 0.42093727 \\times 10^{11} \\right) \\text{ rad/s} = 0.2104686 \\times 10^{11} \\text{ rad/s} = 2.104686 \\times 10^{10} \\text{ rad/s}\n$$\n四舍五入到四位有效数字，我们得到 $\\omega_L = 2.105 \\times 10^{10}$ rad/s。\n\n最终结果是 R 波和 L 波截止频率的数值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.710 \\times 10^{11} & 2.105 \\times 10^{10} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在实际的天体物理和聚变等离子体中，均匀性是特例而非普遍情况。本练习探讨了当一个寻常波（O-mode）进入其频率低于局部等离子体频率的区域时，这种不均匀性所带来的后果。通过使用艾里函数求解截止点附近的波动方程，该练习  为波的反射提供了具体的解析理解，而反射是波可及性和遥感应用中的一个关键现象。",
            "id": "4064421",
            "problem": "一束固定角频率 $\\omega$ 的寻常电磁波（O模）从真空垂直入射到一个磁约束聚变等离子体的边缘，其电子密度 $n_{e}(x)$ 随位置坐标 $x$ 单调增加。该等离子体被建模为离子不动、忽略电子碰撞和热修正的冷电子流体。背景磁场被认为是均匀的，并与波电场方向一致，因此寻常模仅通过标量介电响应与电子密度相互作用。冷等离子体寻常模的介电常数可以用 Stix 参数 $P(x)$ 来表示，其定义为 $P(x) = 1 - \\omega_{pe}^{2}(x)/\\omega^{2}$，其中 $\\omega_{pe}(x) = \\sqrt{n_{e}(x) e^{2}/(\\epsilon_{0} m_{e})}$ 是局域电子等离子体频率，$e$ 是基本电荷，$\\epsilon_{0}$ 是真空介电常数，$m_{e}$ 是电子质量。$P=0$ 层是 $P(x)$ 穿过零点的局域截止层。\n\n从色散介质中的麦克斯韦方程组和冷电子流体模型出发，推导控制垂直于界面的一维传播的横向电场振幅 $E(x)$ 的标量常微分方程。然后，对于导致平滑非均匀性的单调密度斜坡，建立远离截止层的 $E(x)$ 的 Wentzel–Kramers–Brillouin (WKB) 解。将注意力集中在截止点 $x=0$ 的一个邻域，其中 $P(x)$ 可以线性化为 $P(x) \\approx -\\alpha x$（$\\alpha>0$ 为常数），并使用一致近似来一致地处理转折点区域。施加物理边界条件：入射波来自 $x<0$ 且在 $x>0$ 区域没有增长解。\n\n在所述假设下，评估这种线性 $P(x)$ 分布的反射率，反射率定义为复反射系数的模平方。将最终的反射率表示为一个无单位的纯数。无需四舍五入。",
            "solution": "该问题要求计算寻常电磁波入射到截止层附近具有线性密度分布的冷等离子体上的反射率。\n\n首先，我们从麦克斯韦方程组推导控制波动方程。对于角频率为 $\\omega$ 的时谐波，场可以写为 $\\vec{E}(\\vec{r}, t) = \\vec{E}(\\vec{r}) e^{-i\\omega t}$ 和 $\\vec{B}(\\vec{r}, t) = \\vec{B}(\\vec{r}) e^{-i\\omega t}$。在色散介质中的麦克斯韦旋度方程为：\n$$ \\nabla \\times \\vec{E} = i\\omega \\vec{B} $$\n$$ \\nabla \\times \\vec{B} = -i\\omega \\mu_0 \\epsilon_0 \\epsilon_r \\vec{E} $$\n其中 $\\epsilon_r$ 是相对介电常数。对于所描述的寻常模（O模），波电场平行于背景磁场，等离子体响应是标量的。我们已知 $\\epsilon_r(x) = P(x)$，其中 $P(x) = 1 - \\omega_{pe}^2(x)/\\omega^2$ 是 Stix 参数。传播方向为 $x$ 方向，因此我们假设 $\\vec{E} = E(x)\\hat{z}$。\n\n对第一个方程取旋度，并代入第二个方程，得到波动方程：\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = i\\omega (\\nabla \\times \\vec{B}) = i\\omega (-i\\omega \\mu_0 \\epsilon_0 P(x) \\vec{E}) = \\frac{\\omega^2}{c^2} P(x) \\vec{E} $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E}$ 并注意到对于 $\\vec{E} = E(x)\\hat{z}$，我们有 $\\nabla \\cdot \\vec{E} = 0$。波动方程简化为：\n$$ -\\nabla^2 \\vec{E} = \\frac{\\omega^2}{c^2} P(x) \\vec{E} $$\n对于一维传播，这变成一个关于电场振幅 $E(x)$ 的标量常微分方程：\n$$ \\frac{d^2 E}{dx^2} + \\frac{\\omega^2}{c^2} P(x) E(x) = 0 $$\n这就是所要求的微分方程。\n\n问题指明，在截止层 $x=0$ 附近，等离子体分布可以线性化为 $P(x) \\approx -\\alpha x$，其中 $\\alpha>0$ 是一个常数。将此代入波动方程得到：\n$$ \\frac{d^2 E}{dx^2} - \\frac{\\omega^2 \\alpha}{c^2} x E(x) = 0 $$\n这个方程是艾里方程的一种形式。为了将其转换为标准形式 $y''(z) - z y(z) = 0$，我们引入一个无量纲变量 $z$：\n$$ z = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{1/3} x $$\n导数变换如下：\n$$ \\frac{d}{dx} = \\frac{dz}{dx}\\frac{d}{dz} = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{1/3} \\frac{d}{dz} $$\n$$ \\frac{d^2}{dx^2} = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2}{dz^2} $$\n将这些代入波动方程得到：\n$$ \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2 E}{dz^2} - \\frac{\\omega^2 \\alpha}{c^2} \\left(\\frac{c^2}{\\omega^2 \\alpha}\\right)^{1/3} z E(z) = 0 $$\n$$ \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2 E}{dz^2} - \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} z E(z) = 0 $$\n简化后得到艾里方程：\n$$ \\frac{d^2 E}{dz^2} - z E(z) = 0 $$\n该方程的通解是第一类和第二类艾里函数 $\\mathrm{Ai}(z)$ 和 $\\mathrm{Bi}(z)$ 的线性组合：\n$$ E(z) = c_1 \\mathrm{Ai}(z) + c_2 \\mathrm{Bi}(z) $$\n现在我们必须应用边界条件。对于 $x>0$，我们处于 $P(x)<0$ 的渐消区。这对应于 $z>0$。当 $z \\to +\\infty$ 时，艾里函数的渐近行为是：\n$$ \\mathrm{Ai}(z) \\sim \\frac{1}{2\\sqrt{\\pi} z^{1/4}} \\exp\\left(-\\frac{2}{3} z^{3/2}\\right) \\quad (\\text{衰减解}) $$\n$$ \\mathrm{Bi}(z) \\sim \\frac{1}{\\sqrt{\\pi} z^{1/4}} \\exp\\left(+\\frac{2}{3} z^{3/2}\\right) \\quad (\\text{增长解}) $$\n物理边界条件规定，在 $x>0$ 处不应有增长解。这要求增长的 Bi 函数的系数为零，即 $c_2 = 0$。因此，解与第一类艾里函数成正比：\n$$ E(z) = c_1 \\mathrm{Ai}(z) $$\n为了求得反射率，我们必须分析传播区域 $x<0$ 中的解，这对应于 $z<0$。当 $z \\to -\\infty$ 时，$\\mathrm{Ai}(z)$ 的渐近行为是：\n$$ \\mathrm{Ai}(z) \\sim \\frac{1}{\\sqrt{\\pi} (-z)^{1/4}} \\sin\\left(\\frac{2}{3}(-z)^{3/2} + \\frac{\\pi}{4}\\right) $$\n我们用复指数表示正弦函数，以分离入射波和反射波：\n$$ \\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i} $$\n令 $\\phi(z) = \\frac{2}{3}(-z)^{3/2}$。$z<0$ 的解为：\n$$ E(z) \\propto \\frac{1}{(-z)^{1/4}} \\frac{1}{2i} \\left[ \\exp\\left(i\\left(\\phi(z) + \\frac{\\pi}{4}\\right)\\right) - \\exp\\left(-i\\left(\\phi(z) + \\frac{\\pi}{4}\\right)\\right) \\right] $$\n$$ E(z) \\propto \\frac{1}{(-z)^{1/4}} \\left[ \\frac{e^{i\\pi/4}}{2i} e^{i\\phi(z)} - \\frac{e^{-i\\pi/4}}{2i} e^{-i\\phi(z)} \\right] $$\n我们识别入射波和反射波分量。沿 $+x$ 方向传播的波（入射波）具有 $\\exp(i\\int k dx)$ 形式的相位依赖关系。对于 $x<0$，局域波数为 $k(x) = \\frac{\\omega}{c}\\sqrt{P(x)} = \\frac{\\omega}{c}\\sqrt{-\\alpha x}$。相位积分 $\\int_x^0 k(x')dx'$ 是 $\\phi(z)$。因此，朝 $x=0$ 传播的波（入射波）的相位为 $\\exp(-i\\phi(z))$，而远离 $x=0$ 传播的波（反射波）的相位为 $\\exp(i\\phi(z))$。\n\n从 $E(z)$ 的渐近形式中，我们识别出复振幅：\n- 反射波的振幅（含 $e^{i\\phi(z)}$ 的项）为 $A_{refl} \\propto \\frac{e^{i\\pi/4}}{2i}$。\n- 入射波的振幅（含 $e^{-i\\phi(z)}$ 的项）为 $A_{inc} \\propto -\\frac{e^{-i\\pi/4}}{2i}$。\n\n复反射系数 $R$ 是反射振幅与入射振幅之比：\n$$ R = \\frac{A_{refl}}{A_{inc}} = \\frac{e^{i\\pi/4}/(2i)}{-e^{-i\\pi/4}/(2i)} = -\\frac{e^{i\\pi/4}}{e^{-i\\pi/4}} = -e^{i\\pi/2} $$\n因为 $e^{i\\pi/2} = i$，所以复反射系数为 $R = -i$。\n\n反射率 $\\mathcal{R}$ 定义为复反射系数的模平方：\n$$ \\mathcal{R} = |R|^2 = |-i|^2 = 1 $$\n这个结果意味着全反射。这在物理上是符合预期的，因为该模型是无损的（没有碰撞或其他耗散机制），并且波入射到传播被禁止的截止区域（$P(x)<0$），阻止了任何能量传输到 $x \\to \\infty$。因此，所有入射能量都必须被反射。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "虽然解析解在建立物理直觉方面非常强大，但分析复杂现实环境中的波传播通常需要计算工具。这项练习模拟了非寻常波（X-mode）在密度和磁场变化的等离子体中的传播过程。通过将截止和共振的解析条件转化为数值算法，这项练习  培养了计算等离子体物理方面的实用技能，并展示了如何确定波的可及性——这是设计等离子体加热和诊断系统中的一个核心问题。",
            "id": "4064462",
            "problem": "要求您编写一个完整的、可运行的程序。对于从等离子体边界到核心的一维径向路径，该程序需要判断在冷磁化等离子体中传播的非寻常电磁波（即所谓的X模）首先遇到以下哪个事件：右手截止（R-截止）、左手截止（L-截止）或上混杂共振（UHR）。假设波的传播方向严格垂直于局部磁场。该判断必须纯粹基于第一性原理，使用冷等离子体介电响应进行。任务是，在给定电子密度和磁场的解析剖面以及指定的波频率的条件下，确定色散关系的这些特征中，哪一个首先出现在从边界到核心路径上的最小归一化半径处。\n\n从以下经过充分检验的、适用于冷电子-离子等离子体和垂直波传播的基本关系式出发：\n- 电子等离子体频率定义为 $ \\omega_{pe}(r) = \\sqrt{ \\dfrac{n_{e}(r) e^{2}}{\\varepsilon_{0} m_{e}} } $，其中 $ n_{e}(r) $ 是电子数密度，$ e $ 是元电荷，$ \\varepsilon_{0} $ 是真空介电常数，$ m_{e} $ 是电子质量。\n- 电子回旋频率为 $ \\omega_{ce}(r) = \\dfrac{e B(r)}{m_{e}} $，其中 $ B(r) $ 是磁场强度。\n- 定义无量纲参数 $ X(r) = \\dfrac{\\omega_{pe}^{2}(r)}{\\omega^{2}} $ 和 $ Y(r) = \\dfrac{\\omega_{ce}(r)}{\\omega} $，其中 $ \\omega = 2 \\pi f $ 是给定频率 $ f $ 下的波角频率。\n- 冷等离子体 Stix 参数为 $ R(r) = 1 - \\dfrac{X(r)}{1 + Y(r)} $、$ L(r) = 1 - \\dfrac{X(r)}{1 - Y(r)} $ 和 $ S(r) = 1 - \\dfrac{X(r)}{1 - Y^{2}(r)} $。\n- 对于垂直传播，X模的色散关系可以写为 $ n^{2}(r) = \\dfrac{R(r) L(r)}{S(r)} $，其中 $ n^{2}(r) $ 是折射率的平方。当 $ n^{2}(r) = 0 $ 时（即 $ R(r) = 0 $ 或 $ L(r) = 0 $），达到截止；当 $ n^{2}(r) \\to \\infty $ 时（即 $ S(r) = 0 $），发生共振。\n\n根据这些定义，事件条件可重新表述为：寻找最小的归一化半径 $ \\rho \\in [0, 1] $，使其满足以下等式之一：\n- R-截止条件：$ X(\\rho) = 1 + Y(\\rho) $。\n- L-截止条件：$ X(\\rho) = 1 - Y(\\rho) $，其物理有效域为 $ 1 - Y(\\rho) > 0 $。\n- 上混杂共振条件：$ X(\\rho) = 1 - Y^{2}(\\rho) $，其物理有效域为 $ 1 - Y^{2}(\\rho) > 0 $。\n\n您必须实现一个数值程序，该程序从等离子体边界 $ \\rho = 0 $ 扫描到核心 $ \\rho = 1 $，并确定首先发生哪个事件（如果有的话）。如果在 $ \\rho \\in [0, 1] $ 上未找到任何事件，则返回代表“无”的代码。\n\n使用以下建模假设和定义：\n- 径向坐标是归一化半径 $ \\rho \\in [0, 1] $。\n- 密度和磁场剖面是解析的，定义如下\n  - $ n_{e}(\\rho) = n_{\\text{edge}} + \\left( n_{\\text{core}} - n_{\\text{edge}} \\right) \\rho^{p} $，\n  - $ B(\\rho) = B_{\\text{edge}} + \\left( B_{\\text{core}} - B_{\\text{edge}} \\right) \\rho^{q} $，\n  其中 $ n_{\\text{edge}} $、$ n_{\\text{core}} $、$ B_{\\text{edge}} $、$ B_{\\text{core}} $、$ p $ 和 $ q $ 是每个测试用例的给定参数。\n- 使用真空介电常数 $ \\varepsilon_{0} $（单位：法拉/米）、电子质量 $ m_{e} $（单位：千克）、元电荷 $ e $（单位：库仑）、磁场 $ B $（单位：特斯拉）、频率 $ f $（单位：赫兹）和密度 $ n_{e} $（单位：每立方米）。所有计算都必须在国际单位制（SI）中进行。\n\n您的程序必须：\n- 对于每个测试用例，计算 $ \\omega = 2 \\pi f $，然后在从 $ \\rho = 0 $ 到 $ \\rho = 1 $ 的路径上计算 $ X(\\rho) $ 和 $ Y(\\rho) $。\n- 确定满足其中一个事件条件且符合其有效域的最小 $ \\rho $。\n- 为每个测试用例返回一个整数代码，指示遇到的第一个事件：\n  - $ 1 $：如果第一个事件是R-截止，\n  - $ 2 $：如果第一个事件是L-截止，\n  - $ 3 $：如果第一个事件是上混杂共振，\n  - $ 0 $：如果在 $ \\rho \\in [0, 1] $ 上未找到任何事件。\n\n您必须在一个足够精细的网格上实现一个数值稳健的区间套定程序，以在以下函数中找到第一个根：\n- $ \\varphi_{R}(\\rho) = X(\\rho) - \\left( 1 + Y(\\rho) \\right) $，\n- $ \\varphi_{L}(\\rho) = X(\\rho) - \\left( 1 - Y(\\rho) \\right) $，在 $ 1 - Y(\\rho) > 0 $ 时有效，\n- $ \\varphi_{UH}(\\rho) = X(\\rho) - \\left( 1 - Y^{2}(\\rho) \\right) $，在 $ 1 - Y^{2}(\\rho) > 0 $ 时有效。\n对于每个具有有效域的 $ \\varphi(\\rho) $，您只能考虑其有效域内的根。对于每个函数，确定符号首次改变或首次出现零点的最小 $ \\rho $，并通过在套定区间上使用二分法或线性插值来精确化根的位置。然后在找到的所有事件中，选择具有最小 $ \\rho $ 的那一个。\n\n测试套件：\n- 案例 $ 1 $（在典型的电子回旋共振加热机制中，预计首先出现L-截止）：\n  - $ f = 110 \\times 10^{9} \\, \\text{Hz} $，\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $，$ n_{\\text{core}} = 1.0 \\times 10^{20} \\, \\text{m}^{-3} $，\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $，$ B_{\\text{core}} = 2.4 \\, \\text{T} $，\n  - $ p = 2 $，$ q = 1 $。\n- 案例 $ 2 $（对于相对于回旋频率的低频波，预计首先出现R-截止）：\n  - $ f = 20 \\times 10^{9} \\, \\text{Hz} $，\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $，$ n_{\\text{core}} = 5.0 \\times 10^{19} \\, \\text{m}^{-3} $，\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $，$ B_{\\text{core}} = 2.4 \\, \\text{T} $，\n  - $ p = 2 $，$ q = 1 $。\n- 案例 $ 3 $（一个在区间内没有事件的边界情况）：\n  - $ f = 170 \\times 10^{9} \\, \\text{Hz} $，\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $，$ n_{\\text{core}} = 3.0 \\times 10^{19} \\, \\text{m}^{-3} $，\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $，$ B_{\\text{core}} = 2.4 \\, \\text{T} $，\n  - $ p = 2 $，$ q = 1 $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，结果按三个测试用例的顺序排列，例如 $ [r_{1}, r_{2}, r_{3}] $。每个 $ r_{i} $ 必须是上文定义的 $ 0 $、$ 1 $、$ 2 $ 或 $ 3 $ 之一。不应打印任何附加文本。",
            "solution": "该问题要求确定在冷磁化等离子体中垂直于磁场传播的非寻常（X模）电磁波所遇到的第一个波-粒子相互作用事件——截止或共振。该等离子体的特征由电子密度 $n_e(\\rho)$ 和磁场强度 $B(\\rho)$ 的一维径向剖面描述，其中 $\\rho \\in [0, 1]$ 是从边界到核心的归一化半径。\n\n首先，我们使用所提供的物理原理将问题形式化。冷等离子体相对于波的状态由两个无量纲参数描述：\n- $X(\\rho) = \\dfrac{\\omega_{pe}^2(\\rho)}{\\omega^2}$，它比较了局部电子等离子体频率 $\\omega_{pe}$ 与恒定的波频率 $\\omega$。\n- $Y(\\rho) = \\dfrac{\\omega_{ce}(\\rho)}{\\omega}$，它比较了局部电子回旋频率 $\\omega_{ce}$ 与波频率 $\\omega$。\n\n电子等离子体频率 $\\omega_{pe}(\\rho)$ 取决于电子密度 $n_e(\\rho)$，关系为 $\\omega_{pe}^2(\\rho) = \\frac{n_e(\\rho) e^2}{\\varepsilon_0 m_e}$。电子回旋频率 $\\omega_{ce}(\\rho)$ 取决于磁场 $B(\\rho)$，关系为 $\\omega_{ce}(\\rho) = \\frac{e B(\\rho)}{m_e}$。给定的解析剖面为：\n$$\nn_{e}(\\rho) = n_{\\text{edge}} + \\left( n_{\\text{core}} - n_{\\text{edge}} \\right) \\rho^{p}\n$$\n$$\nB(\\rho) = B_{\\text{edge}} + \\left( B_{\\text{core}} - B_{\\text{edge}} \\right) \\rho^{q}\n$$\n其中 $n_{\\text{edge}}$、$n_{\\text{core}}$、$B_{\\text{edge}}$、$B_{\\text{core}}$、$p$ 和 $q$ 是指定的参数。对于给定频率 $f$，波的角频率为 $\\omega = 2\\pi f$。所有计算均使用国际单位制（SI），并采用元电荷 $e$、电子质量 $m_e$ 和真空介电常数 $\\varepsilon_0$ 的基本常数。\n\n垂直于磁场传播的X模的色散关系由 $n^2(\\rho) = \\frac{R(\\rho)L(\\rho)}{S(\\rho)}$ 给出，其中 $R$、$L$ 和 $S$ 是 Stix 参数。\n- 当折射率 $n \\to 0$ 时发生**截止**，这意味着 $R(\\rho)=0$ 或 $L(\\rho)=0$。\n- 当 $n \\to \\infty$ 时发生**共振**，这意味着 $S(\\rho)=0$。\n\n这些条件可以用 $X(\\rho)$ 和 $Y(\\rho)$ 明确定义：\n1.  **右手（R）截止（$R=0$）：** $X(\\rho) = 1 + Y(\\rho)$。我们定义函数 $\\varphi_R(\\rho) = X(\\rho) - (1 + Y(\\rho))$，并寻找其在 $\\rho \\in [0, 1]$ 中的最小根。\n2.  **左手（L）截止（$L=0$）：** $X(\\rho) = 1 - Y(\\rho)$。我们定义 $\\varphi_L(\\rho) = X(\\rho) - (1 - Y(\\rho))$。此条件仅在右侧为正时，即 $1 - Y(\\rho) > 0$ 时，才具有物理有效性。仅在此有效域内寻找根。\n3.  **上混杂共振（UHR，$S=0$）：** $X(\\rho) = 1 - Y^2(\\rho)$。我们定义 $\\varphi_{UH}(\\rho) = X(\\rho) - (1 - Y^2(\\rho))$。此条件仅在 $1 - Y^2(\\rho) > 0$ 时有效。仅在此有效域内寻找根。\n\n任务是找到满足这三个方程中任意一个且在其各自有效域内的最小 $\\rho \\in [0, 1]$。\n\n算法步骤如下：\n1.  对于每个测试用例，使用物理和剖面参数构建函数 $X(\\rho)$ 和 $Y(\\rho)$。基于这些函数，定义三个事件函数 $\\varphi_R(\\rho)$、$\\varphi_L(\\rho)$ 和 $\\varphi_{UH}(\\rho)$，以及 $\\varphi_L$ 和 $\\varphi_{UH}$ 的有效性条件。\n2.  实现一个数值求根程序，以找到每个函数 $\\varphi(\\rho)$ 在区间 $[0, 1]$ 上的最小根。此过程封装在一个名为 `find_smallest_root` 的函数中，其操作方式是首先将区间 $\\rho \\in [0, 1]$ 离散化为一个精细网格（例如，1000个子区间）。\n3.  从 $\\rho=0$到 $\\rho=1$ 扫描网格。对于每个子区间 $[\\rho_i, \\rho_{i+1}]$，我们首先检查该区间是否在函数的有效域内。如果是，则计算函数在端点处的值。符号变化，即 $\\varphi(\\rho_i) \\cdot \\varphi(\\rho_{i+1}) \\le 0$，表明根被套定在该子区间内。\n4.  一旦找到第一个这样的套定区间，就调用一个更精确的数值求解器。我们使用 Brent 方法，如 `scipy.optimize.brentq` 中所实现的，它是一种稳健而高效的算法，结合了二分法、割线法和反二次插值，以高精度在套定区间内找到根。\n5.  此程序被独立应用于为三个事件中的每一个找到最小的有效根：$\\rho_R$、$\\rho_L$ 和 $\\rho_{UH}$。如果某个特定事件函数在 $[0, 1]$ 中没有有效根，则其结果被视为无穷大。\n6.  比较已识别的根：$\\rho_{first} = \\min(\\rho_R, \\rho_L, \\rho_{UH})$。对应于 $\\rho_{first}$ 的事件是波首先遇到的事件。记录此事件的整数代码（R-截止为 $1$，L-截止为 $2$，UHR为 $3$）。\n7.  如果在区间 $[0, 1]$ 内未找到任何三个事件的有效根，则结果为“无”，由代码 $0$ 表示。\n\n该方法通过系统地数值求解控制方程，并遵守所有指定的约束和物理有效域，为确定第一个波相互作用事件提供了一种稳健且物理上正确的方法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes which event (R-cutoff, L-cutoff, or UHR) an X-mode wave \n    encounters first along a radial path in a plasma.\n    \"\"\"\n    \n    # Fundamental physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kilograms\n    EPSILON_0 = 8.8541878128e-12   # Vacuum permittivity in F/m\n\n    # Pre-calculated combinations of constants for efficiency\n    E2_OVER_EPS0_ME = E_CHARGE**2 / (EPSILON_0 * M_ELECTRON)\n    E_OVER_ME = E_CHARGE / M_ELECTRON\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        # Case 1: Expecting L-cutoff (2)\n        {'f': 110e9, 'n_edge': 1.0e18, 'n_core': 1.0e20, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n        # Case 2: Expecting R-cutoff (1)\n        {'f': 20e9, 'n_edge': 1.0e18, 'n_core': 5.0e19, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n        # Case 3: Expecting no event (0)\n        {'f': 170e9, 'n_edge': 1.0e18, 'n_core': 3.0e19, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n    ]\n\n    def find_smallest_root(func, validity_func, rho_min=0.0, rho_max=1.0, grid_points=1001):\n        \"\"\"\n        Finds the smallest root of a function `func` on [rho_min, rho_max]\n        where `validity_func` returns True.\n        \n        Args:\n            func: The function for which to find a root.\n            validity_func: A function that returns True if func is physically valid at a given rho.\n            rho_min, rho_max: The search interval.\n            grid_points: The number of points to use for the initial grid scan.\n\n        Returns:\n            The smallest root found, or None if no root is found.\n        \"\"\"\n        rhos = np.linspace(rho_min, rho_max, grid_points)\n        \n        # Check the very first point separately\n        if validity_func(rhos[0]) and np.isclose(func(rhos[0]), 0):\n            return rhos[0]\n        \n        val_prev = None\n        if validity_func(rhos[0]):\n            val_prev = func(rhos[0])\n            \n        for i in range(1, len(rhos)):\n            rho_prev, rho_curr = rhos[i-1], rhos[i]\n            \n            is_valid_curr = validity_func(rho_curr)\n            \n            # If the interval start is not valid, reset and continue\n            if val_prev is None:\n                if is_valid_curr:\n                    val_prev = func(rho_curr)\n                continue\n\n            # If the interval end is not valid, reset and continue\n            if not is_valid_curr:\n                val_prev = None\n                continue\n            \n            val_curr = func(rho_curr)\n\n            # A sign change indicates a bracketed root\n            if val_prev * val_curr <= 0:\n                try:\n                    root = brentq(func, rho_prev, rho_curr)\n                    return root\n                except ValueError:\n                    # This can happen if one of the endpoints is exactly zero,\n                    # or if signs are not opposite due to floating point issues.\n                    if np.isclose(val_prev, 0): return rho_prev\n                    if np.isclose(val_curr, 0): return rho_curr\n                    # otherwise, it might be a grazing contact, continue search\n            \n            val_prev = val_curr\n            \n        return None\n\n    results = []\n    for params in test_cases:\n        omega = 2 * np.pi * params['f']\n\n        # Define profile and dimensionless parameter functions for the current case\n        def n_e(rho): return params['n_edge'] + (params['n_core'] - params['n_edge']) * rho**params['p']\n        def B(rho): return params['B_edge'] + (params['B_core'] - params['B_edge']) * rho**params['q']\n        def X(rho): return (n_e(rho) * E2_OVER_EPS0_ME) / omega**2\n        def Y(rho): return (B(rho) * E_OVER_ME) / omega\n\n        # Define the three event functions phi(rho) = 0\n        def phi_R(rho): return X(rho) - (1 + Y(rho))\n        def phi_L(rho): return X(rho) - (1 - Y(rho))\n        def phi_UH(rho): return X(rho) - (1 - Y(rho)**2)\n\n        # Define validity functions for L-cutoff and UHR\n        def valid_L(rho): return 1 - Y(rho) > 0\n        def valid_UH(rho): return 1 - Y(rho)**2 > 0\n        def valid_always(rho): return True\n\n        # Find the smallest root for each event type\n        root_R = find_smallest_root(phi_R, valid_always)\n        root_L = find_smallest_root(phi_L, valid_L)\n        root_UH = find_smallest_root(phi_UH, valid_UH)\n\n        # Collect all found valid roots with their corresponding event codes\n        found_events = []\n        if root_R is not None: found_events.append((root_R, 1))  # 1: R-cutoff\n        if root_L is not None: found_events.append((root_L, 2))  # 2: L-cutoff\n        if root_UH is not None: found_events.append((root_UH, 3)) # 3: UHR\n\n        # Determine the first event\n        if not found_events:\n            results.append(0)  # 0: No event found\n        else:\n            # The first event is the one with the minimum rho\n            first_event = min(found_events, key=lambda item: item[0])\n            results.append(first_event[1])\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}