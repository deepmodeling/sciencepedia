{
    "hands_on_practices": [
        {
            "introduction": "磁通量管是太阳和天体物理等离子体中的基本结构单元。本练习  将引导你从第一性原理出发，计算一个均匀扭曲的磁通量管的相对磁螺度，这是一个典型的范例。掌握这项计算对于理解螺度如何量化磁场的扭曲和结构至关重要。",
            "id": "4219611",
            "problem": "考虑一个半径为 $a$、长度为 $L$ 的直的、轴对称的圆柱形磁通管，它嵌入在一个理想导电介质中，因此磁通量被限制在管内。在柱坐标系 $(r,\\phi,z)$ 中，磁场是无散的，并具有恒定的轴向分量 $B_{z}=B_{0}$ 和一个角向分量 $B_{\\phi}(r)$，使得场线呈现均匀的扭曲：场线的角向角以恒定的速率 $q$ 随单位轴向距离增加，即对于所有半径 $0\\le r\\le a$，都有 $d\\phi/dz=q$。在管的整个长度 $L$ 上，总匝数为 $N$，因此 $2\\pi N$ 是从 $z=0$ 到 $z=L$ 累积的净角向角。通过管横截面的轴向磁通量为 $\\Phi=\\pi a^{2} B_{0}$。假设理想磁流体动力学（MHD）成立，并假设管在 $z=0$ 和 $z=L$ 的两端是平面的理想导电边界。\n\n开放磁体积通常表现出规范依赖的绝对磁螺度 $H=\\int_{V} \\mathbf{A}\\cdot\\mathbf{B}\\,dV$，其中 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$。在这种情况下，计算由 Finn–Antonsen 定义的规范不变的相对磁螺度 $H_{R}$，其定义为\n$$\nH_{R}=\\int_{V}\\left(\\mathbf{A}+\\mathbf{A}_{p}\\right)\\cdot\\left(\\mathbf{B}-\\mathbf{B}_{p}\\right)\\,dV,\n$$\n其中 $\\mathbf{B}_{p}$ 是在相同圆柱体积内的参考势场，它与管的所有边界上 $\\mathbf{B}$ 的法向分量相匹配，而 $\\mathbf{A}_{p}$ 是 $\\mathbf{B}_{p}$ 的任意矢量势。将管内的实际场取为 $\\mathbf{B}=B_{0}\\,\\hat{\\mathbf{z}}+B_{\\phi}(r)\\,\\hat{\\boldsymbol{\\phi}}$，其中 $B_{\\phi}(r)$ 由均匀扭曲条件确定，并选择轴对称的库仑规范矢量势 $\\mathbf{A}(r)=A_{\\phi}(r)\\,\\hat{\\boldsymbol{\\phi}}+A_{z}(r)\\,\\hat{\\mathbf{z}}$ 和 $\\mathbf{A}_{p}(r)=A_{p,\\phi}(r)\\,\\hat{\\boldsymbol{\\phi}}$，它们分别生成 $\\mathbf{B}$ 和 $\\mathbf{B}_{p}$。\n\n使用上述定义和场线扭曲条件，从第一性原理推导 $H_{R}$，并将最终结果表示为以 $\\Phi$ 和 $N$ 为变量的闭式解析表达式。以国际单位制中的韦伯平方为单位报告螺度。无需四舍五入。",
            "solution": "该问题经过验证，是有效的。这是一个在理想磁流体动力学中的良定问题，基于已建立的科学原理，并使用了精确、客观的语言。所有必要信息均已提供。\n\n求解过程首先确定磁场及其对应的矢量势，然后通过指定的积分定义计算相对磁螺度。\n\n1.  **确定磁场 $\\mathbf{B}$**\n\n磁场在柱坐标 $(r, \\phi, z)$ 中给出为 $\\mathbf{B} = B_{\\phi}(r)\\,\\hat{\\boldsymbol{\\phi}} + B_{z}\\,\\hat{\\mathbf{z}}$。轴向分量是恒定的，$B_z = B_0$。角向分量 $B_{\\phi}(r)$ 由均匀扭曲条件确定。磁场线的轨迹由微分方程 $\\frac{dr}{B_r} = \\frac{r\\,d\\phi}{B_{\\phi}} = \\frac{dz}{B_z}$ 描述。由于 $B_r = 0$，场线被限制在半径为常数 $r$ 的圆柱面上。场线的角向角随轴向距离的变化率为 $\\frac{d\\phi}{dz} = \\frac{B_{\\phi}(r)}{r B_z}$。问题指出，对于所有半径 $r \\le a$，此速率为常数 $q$。\n$$\n\\frac{d\\phi}{dz} = q = \\frac{B_{\\phi}(r)}{r B_0}\n$$\n这意味着角向场分量是半径的线性函数：\n$$\nB_{\\phi}(r) = q r B_0\n$$\n在长度 $L$ 上的总匝数为 $N$。总角向角变化为 $\\Delta\\phi = \\int_0^L \\frac{d\\phi}{dz} dz = qL$。这对应于 $N$ 个整圈，所以 $\\Delta\\phi = 2\\pi N$。因此，我们有以下关系：\n$$\nqL = 2\\pi N\n$$\n完整的磁场矢量是：\n$$\n\\mathbf{B} = q r B_0 \\,\\hat{\\boldsymbol{\\phi}} + B_0 \\,\\hat{\\mathbf{z}}\n$$\n\n2.  **确定参考场 $\\mathbf{B}_p$**\n\n参考场 $\\mathbf{B}_p$ 是一个势场，意味着 $\\nabla \\times \\mathbf{B}_p = 0$，并且它与圆柱体边界上 $\\mathbf{B}$ 的法向分量相匹配。边界有三个部分：$r=a$ 处的圆柱壁（法向 $\\hat{\\mathbf{r}}$）、$z=0$ 处的端盖（法向 $-\\hat{\\mathbf{z}}$）和 $z=L$ 处的端盖（法向 $\\hat{\\mathbf{z}}$）。\n-   在 $r=a$ 的壁上：$\\mathbf{B}_p \\cdot \\hat{\\mathbf{r}} = \\mathbf{B} \\cdot \\hat{\\mathbf{r}} = 0$。所以，$B_{p,r}|_{r=a} = 0$。\n-   在 $z=0$ 的端盖上：$\\mathbf{B}_p \\cdot (-\\hat{\\mathbf{z}}) = \\mathbf{B} \\cdot (-\\hat{\\mathbf{z}})$，这意味着 $B_{p,z}|_{z=0} = B_z|_{z=0} = B_0$。\n-   在 $z=L$ 的端盖上：$\\mathbf{B}_p \\cdot \\hat{\\mathbf{z}} = \\mathbf{B} \\cdot \\hat{\\mathbf{z}}$，这意味着 $B_{p,z}|_{z=L} = B_z|_{z=L} = B_0$。\n由于 $\\mathbf{B}_p$ 是一个势场，它可以写成一个标量势的梯度，$\\mathbf{B}_p = \\nabla \\psi$。条件 $\\nabla \\cdot \\mathbf{B}_p = 0$ 要求 $\\psi$ 满足拉普拉斯方程，$\\nabla^2 \\psi = 0$。满足这些约束的最简单场是一个均匀的轴向场，$\\mathbf{B}_p = B_0 \\hat{\\mathbf{z}}$。这个场是无旋、无散的，并且满足所有法向边界条件。\n\n3.  **确定矢量势 $\\mathbf{A}$**\n\n我们被要求找到一个形式为 $\\mathbf{A}(r) = A_{\\phi}(r)\\,\\hat{\\boldsymbol{\\phi}} + A_{z}(r)\\,\\hat{\\mathbf{z}}$ 的轴对称库仑规范矢量势。磁场通过 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 恢复。在柱坐标中，对于这种形式的势，旋度为：\n$$\n\\nabla \\times \\mathbf{A} = -\\frac{dA_z}{dr}\\,\\hat{\\boldsymbol{\\phi}} + \\frac{1}{r}\\frac{d(rA_{\\phi})}{dr}\\,\\hat{\\mathbf{z}}\n$$\n将此与 $\\mathbf{B} = B_{\\phi}(r)\\,\\hat{\\boldsymbol{\\phi}} + B_z\\,\\hat{\\mathbf{z}}$ 比较，我们得到两个常微分方程：\n$$\nB_{\\phi} = q r B_0 = -\\frac{dA_z}{dr} \\quad \\implies \\quad A_z(r) = \\int -qrB_0\\,dr = -\\frac{1}{2}qr^2B_0 + C_1\n$$\n$$\nB_z = B_0 = \\frac{1}{r}\\frac{d(rA_{\\phi})}{dr} \\quad \\implies \\quad d(rA_{\\phi}) = rB_0\\,dr \\quad \\implies \\quad rA_{\\phi}(r) = \\frac{1}{2}r^2B_0 + C_2\n$$\n设置积分常数 $C_1=0$ 和 $C_2=0$ 以确保在 $r=0$ 处的正则性并固定规范，我们得到：\n$$\nA_z(r) = -\\frac{1}{2}q r^2 B_0 \\quad \\text{和} \\quad A_{\\phi}(r) = \\frac{1}{2}r B_0\n$$\n所以，实际场的矢量势是：\n$$\n\\mathbf{A}(r) = \\frac{1}{2}r B_0\\,\\hat{\\boldsymbol{\\phi}} - \\frac{1}{2}q r^2 B_0\\,\\hat{\\mathbf{z}}\n$$\n\n4.  **确定矢量势 $\\mathbf{A}_p$**\n\n类似地，对于参考场 $\\mathbf{B}_p = B_0 \\hat{\\mathbf{z}}$，我们寻求一个势 $\\mathbf{A}_p(r) = A_{p,\\phi}(r)\\,\\hat{\\boldsymbol{\\phi}}$。\n$$\n\\mathbf{B}_p = \\nabla \\times \\mathbf{A}_p = \\frac{1}{r}\\frac{d(rA_{p,\\phi})}{dr}\\,\\hat{\\mathbf{z}}\n$$\n这给出了与上面 $A_\\phi$ 相同的 $A_{p,\\phi}$ 方程：\n$$\nB_0 = \\frac{1}{r}\\frac{d(rA_{p,\\phi})}{dr} \\quad \\implies \\quad A_{p,\\phi}(r) = \\frac{1}{2}r B_0\n$$\n参考场的矢量势是：\n$$\n\\mathbf{A}_p(r) = \\frac{1}{2}r B_0\\,\\hat{\\boldsymbol{\\phi}}\n$$\n\n5.  **计算相对螺度 $H_R$**\n\n相对磁螺度由 Finn-Antonsen 公式定义：\n$$\nH_R = \\int_V (\\mathbf{A} + \\mathbf{A}_p) \\cdot (\\mathbf{B} - \\mathbf{B}_p) \\, dV\n$$\n首先，我们求出被积函数中的各项：\n$$\n\\mathbf{B} - \\mathbf{B}_p = (q r B_0 \\,\\hat{\\boldsymbol{\\phi}} + B_0 \\,\\hat{\\mathbf{z}}) - (B_0 \\,\\hat{\\mathbf{z}}) = q r B_0 \\,\\hat{\\boldsymbol{\\phi}}\n$$\n$$\n\\mathbf{A} + \\mathbf{A}_p = \\left(\\frac{1}{2}r B_0\\,\\hat{\\boldsymbol{\\phi}} - \\frac{1}{2}q r^2 B_0\\,\\hat{\\mathbf{z}}\\right) + \\left(\\frac{1}{2}r B_0\\,\\hat{\\boldsymbol{\\phi}}\\right) = r B_0\\,\\hat{\\boldsymbol{\\phi}} - \\frac{1}{2}q r^2 B_0\\,\\hat{\\mathbf{z}}\n$$\n点积是：\n$$\n(\\mathbf{A} + \\mathbf{A}_p) \\cdot (\\mathbf{B} - \\mathbf{B}_p) = \\left(r B_0\\,\\hat{\\boldsymbol{\\phi}} - \\frac{1}{2}q r^2 B_0\\,\\hat{\\mathbf{z}}\\right) \\cdot (q r B_0 \\,\\hat{\\boldsymbol{\\phi}}) = (r B_0)(q r B_0) = q r^2 B_0^2\n$$\n现在，我们在圆柱体积 $V$ 上对这个量进行积分。体积元是 $dV = r\\,dr\\,d\\phi\\,dz$。积分限为 $r \\in [0, a]$，$\\phi \\in [0, 2\\pi]$ 和 $z \\in [0, L]$。\n$$\nH_R = \\int_0^L \\int_0^{2\\pi} \\int_0^a (q r^2 B_0^2) \\, r \\, dr \\, d\\phi \\, dz\n$$\n被积函数与 $\\phi$ 和 $z$ 无关，所以这些积分是平凡的：\n$$\nH_R = q B_0^2 \\left(\\int_0^L dz\\right) \\left(\\int_0^{2\\pi} d\\phi\\right) \\left(\\int_0^a r^3 dr\\right)\n$$\n$$\nH_R = q B_0^2 (L) (2\\pi) \\left[\\frac{r^4}{4}\\right]_0^a = q B_0^2 L (2\\pi) \\frac{a^4}{4} = \\frac{\\pi}{2} q L B_0^2 a^4\n$$\n\n6.  **以 $\\Phi$ 和 $N$ 表示的最终表达式**\n\n最后一步是用总轴向通量 $\\Phi=\\pi a^{2} B_{0}$ 和总匝数 $N$ 来表示 $H_R$。我们使用关系式 $qL = 2\\pi N$。\n将 $qL = 2\\pi N$ 代入 $H_R$ 的表达式中：\n$$\nH_R = \\frac{\\pi}{2} (2\\pi N) B_0^2 a^4 = \\pi^2 N B_0^2 a^4\n$$\n为了引入 $\\Phi$，我们可以将表达式重新排列为：\n$$\nH_R = N (\\pi^2 a^4 B_0^2) = N (\\pi a^2 B_0)^2\n$$\n由于 $\\Phi = \\pi a^2 B_0$，我们得到最终结果：\n$$\nH_R = N \\Phi^2\n$$\n该表达式的单位是（无量纲）$\\times$（韦伯）$^2$，这与磁螺度所要求的单位一致。",
            "answer": "$$\n\\boxed{N\\Phi^{2}}\n$$"
        },
        {
            "introduction": "在高导电等离子体中，磁螺度近似守恒，它约束着系统的演化。本练习  探讨了 Beltrami 场（线性无力场），这种场代表了在给定螺度下磁能最小的状态。通过推导螺度与能量的比值，我们将理解螺度如何限制能量耗散并决定等离子体的最终弛豫状态。",
            "id": "4219573",
            "problem": "在理想磁流体动力学 (MHD) 框架下，考虑一个边长为 $L$ 的三重周期性立方体区域中的导电、不可压缩天体物理等离子体（因此体积为 $V=L^{3}$）。设磁场 $\\mathbf{B}(\\mathbf{x})$ 是一个贝尔特拉米（线性无力）场，满足 $\\nabla\\times \\mathbf{B}=\\alpha\\,\\mathbf{B}$（其中 $\\alpha\\neq 0$ 为常数）以及 $\\nabla\\cdot \\mathbf{B}=0$。设 $\\mathbf{A}(\\mathbf{x})$ 为一个矢量势，使得 $\\nabla\\times \\mathbf{A}=\\mathbf{B}$，并选择一个满足 $\\nabla\\cdot \\mathbf{A}=0$ 的规范。在此周期性区域中，磁螺度 $H=\\int_{V}\\mathbf{A}\\cdot\\mathbf{B}\\,dV$ 是规范不变的。磁能为 $E=\\int_{V}\\frac{\\mathbf{B}^{2}}{2\\mu_{0}}\\,dV$，其中 $\\mu_{0}$ 是真空磁导率。\n\n仅从这些定义和给定条件出发，推导出比值 $H/E$ 关于 $\\alpha$ 和 $\\mu_{0}$ 的显式表达式。证明该比值与 $\\mathbf{B}$ 的振幅和区域大小 $L$ 无关。然后，验证你的结果与磁螺度的标准谱形式可实现性条件的一致性，即对于任意傅里叶波数大小 $k$，螺度谱 $H(k)$ 和能量谱 $E(k)$ 满足 $|H(k)|\\leq \\frac{2\\mu_{0}}{k}\\,E(k)$。假设周期性区域中的贝尔特拉米场仅存在于单一波数 $k=|\\alpha|$ 处。\n\n将最终答案表示为 $H/E$ 关于 $\\alpha$ 和 $\\mu_{0}$ 的单一闭式解析表达式。无需进行数值计算。",
            "solution": "问题要求我们求出周期性区域中贝尔特拉米磁场的磁螺度 $H$ 与磁能 $E$ 之比，并根据一个谱不等式来验证此结果。\n\n磁螺度 $H$ 和磁能 $E$ 的定义如下：\n$$H = \\int_{V} \\mathbf{A} \\cdot \\mathbf{B} \\,dV$$\n$$E = \\int_{V} \\frac{\\mathbf{B}^{2}}{2\\mu_{0}} \\,dV$$\n其中 $\\mathbf{B}$ 是磁场，$\\mathbf{A}$ 是其矢量势（$\\nabla \\times \\mathbf{A} = \\mathbf{B}$），$V$ 是区域的体积，$\\mu_{0}$ 是真空磁导率。\n\n题目给定磁场为贝尔特拉米场，它满足线性无力方程：\n$$\\nabla \\times \\mathbf{B} = \\alpha \\mathbf{B}$$\n其中 $\\alpha$ 是一个非零常数。由于 $\\alpha \\neq 0$，我们可以用 $\\mathbf{B}$ 自身的旋度来表示它：\n$$\\mathbf{B} = \\frac{1}{\\alpha} (\\nabla \\times \\mathbf{B})$$\n\n我们可以将这个 $\\mathbf{B}$ 的表达式代入磁螺度 $H$ 的定义中：\n$$H = \\int_{V} \\mathbf{A} \\cdot \\left(\\frac{1}{\\alpha} (\\nabla \\times \\mathbf{B})\\right) \\,dV = \\frac{1}{\\alpha} \\int_{V} \\mathbf{A} \\cdot (\\nabla \\times \\mathbf{B}) \\,dV$$\n\n为了继续推导，我们使用矢量微积分中关于叉积散度的恒等式：\n$$\\nabla \\cdot (\\mathbf{F} \\times \\mathbf{G}) = \\mathbf{G} \\cdot (\\nabla \\times \\mathbf{F}) - \\mathbf{F} \\cdot (\\nabla \\times \\mathbf{G})$$\n令 $\\mathbf{F} = \\mathbf{A}$ 和 $\\mathbf{G} = \\mathbf{B}$。该恒等式变为：\n$$\\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B}) = \\mathbf{B} \\cdot (\\nabla \\times \\mathbf{A}) - \\mathbf{A} \\cdot (\\nabla \\times \\mathbf{B})$$\n对 $H$ 的积分中的项进行整理：\n$$\\mathbf{A} \\cdot (\\nabla \\times \\mathbf{B}) = \\mathbf{B} \\cdot (\\nabla \\times \\mathbf{A}) - \\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B})$$\n\n现在，将此式代回 $H$ 的表达式中：\n$$H = \\frac{1}{\\alpha} \\int_{V} \\left[ \\mathbf{B} \\cdot (\\nabla \\times \\mathbf{A}) - \\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B}) \\right] \\,dV$$\n\n我们使用矢量势的定义 $\\nabla \\times \\mathbf{A} = \\mathbf{B}$。被积函数的第一项变为 $\\mathbf{B} \\cdot \\mathbf{B} = B^2$。\n$$H = \\frac{1}{\\alpha} \\int_{V} \\left[ B^2 - \\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B}) \\right] \\,dV$$\n我们可以将积分分成两部分：\n$$H = \\frac{1}{\\alpha} \\left( \\int_{V} B^2 \\,dV - \\int_{V} \\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B}) \\,dV \\right)$$\n\n第二个积分可以使用散度定理来计算，该定理将一个散度的体积分与一个沿边界 $\\partial V$ 的面积分联系起来：\n$$\\int_{V} \\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B}) \\,dV = \\oint_{\\partial V} (\\mathbf{A} \\times \\mathbf{B}) \\cdot d\\mathbf{S}$$\n问题指出等离子体位于一个三重周期性立方体区域中。对于该区域上任何周期性的矢量场，其在边界 $\\partial V$ 上的面积分为零，因为立方体相对面上的贡献会相互抵消。因此，\n$$\\oint_{\\partial V} (\\mathbf{A} \\times \\mathbf{B}) \\cdot d\\mathbf{S} = 0$$\n\n这将 $H$ 的表达式简化为：\n$$H = \\frac{1}{\\alpha} \\int_{V} B^2 \\,dV$$\n\n现在我们将其与磁能 $E$ 联系起来。$E$ 的定义是：\n$$E = \\frac{1}{2\\mu_{0}} \\int_{V} B^2 \\,dV$$\n根据这个定义，我们可以将 $B^2$ 的积分表示为：\n$$\\int_{V} B^2 \\,dV = 2\\mu_{0}E$$\n\n将此式代入我们简化的 $H$ 表达式中：\n$$H = \\frac{1}{\\alpha} (2\\mu_{0}E)$$\n\n最后，我们可以通过两边同除以 $E$ 来求得比值 $H/E$：\n$$\\frac{H}{E} = \\frac{2\\mu_{0}}{\\alpha}$$\n\n这个 $H/E$ 的比值表达式仅依赖于物理常数 $\\mu_{0}$ 和贝尔特拉米参数 $\\alpha$。它与磁场 $\\mathbf{B}$ 的振幅无关，因为任何作用于 $\\mathbf{B}$ 的缩放因子都会使 $H$ 和 $E$ 按该因子的平方进行缩放，从而在比值中被抵消。它也与区域大小 $L$ 无关，因为体积 $V = L^{3}$ 是 $H$ 和 $E$ 中都存在的积分的一部分，并通过关系式 $\\int_V B^2 dV = 2\\mu_0 E$ 而抵消。\n\n问题的第二部分要求根据磁螺度的谱可实现性条件来验证此结果，该条件指出对于任意给定的波数 $k$，螺度谱和能量谱必须满足：\n$$|H(k)| \\leq \\frac{2\\mu_{0}}{k} E(k)$$\n问题明确指出，对于周期性区域中的贝尔特拉米场，磁场仅存在于大小为 $k = |\\alpha|$ 的波数上。这意味着对于 $k \\neq |\\alpha|$，$H(k)$ 和 $E(k)$ 均为零。因此，我们必须检查该不等式在 $k = |\\alpha|$ 时是否成立。对于总量 $H$ 和 $E$（它们分别是各自谱在所有 $k$ 上的积分），这意味着以下关系：\n$$|H| \\leq \\frac{2\\mu_{0}}{|\\alpha|} E$$\n这可以重写为：\n$$\\left|\\frac{H}{E}\\right| \\leq \\frac{2\\mu_{0}}{|\\alpha|}$$\n从我们的推导中，我们发现贝尔特拉米场的比值为 $\\frac{H}{E} = \\frac{2\\mu_{0}}{\\alpha}$。取其绝对值可得：\n$$\\left|\\frac{H}{E}\\right| = \\left|\\frac{2\\mu_{0}}{\\alpha}\\right| = \\frac{2\\mu_{0}}{|\\alpha|}$$\n将此结果代入我们必须检查的不等式中：\n$$\\frac{2\\mu_{0}}{|\\alpha|} \\leq \\frac{2\\mu_{0}}{|\\alpha|}$$\n这个不等式是成立的，实际上是饱和的（即，等号成立）。这证实了我们推导出的 $H/E$ 表达式与通用可实现性条件是一致的。贝尔特拉米场代表了在给定磁能和特征长度尺度 $1/|\\alpha|$ 下磁螺度达到最大值的状态。",
            "answer": "$$\n\\boxed{\\frac{2\\mu_{0}}{\\alpha}}\n$$"
        },
        {
            "introduction": "现在，我们将从静态结构转向动态过程。本练习  使用一个简化但功能强大的双磁环模型，来模拟在电阻和磁重联作用下螺度的演化。通过编写代码，你将能直接观察到螺度因电阻而缓慢衰减，以及在重联事件中它如何从互螺度（环环相扣）快速转移为自螺度（自身扭曲），这揭示了等离子体自组织的一个关键原则。",
            "id": "4219520",
            "problem": "考虑嵌入在一个封闭的、理想导电边界区域内的两个细的、不重叠的圆形磁通量管（环）。等离子体遵循电阻磁流体力学（MHD）方程，其中磁流体力学（MHD）将缓慢移动的导电流体与磁场耦合起来。假设速度场恒为零，电阻率在空间上是均匀的。\n\n基本依据：\n- 具有均匀电阻率和零速度的磁流体力学感应方程由以下扩散形式给出\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\eta \\nabla^2 \\mathbf{B},\n$$\n其中 $\\eta$ 是电阻率，单位为 $\\mathrm{m^2/s}$，$\\mathbf{B}$ 是磁场，单位为 $\\mathrm{Tesla}$。\n- 磁螺度定义为\n$$\nH(t) = \\int_V \\mathbf{A} \\cdot \\mathbf{B} \\, dV,\n$$\n其中 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$，$V$ 是体积。在一个孤立区域（无边界通量）中，磁螺度根据以下公式演化\n$$\n\\frac{dH}{dt} = - 2 \\eta \\int_V \\mathbf{J} \\cdot \\mathbf{B} \\, dV,\n$$\n其中 $\\mathbf{J} = \\nabla \\times \\mathbf{B}$。\n- 在双管的细磁通量管近似中，螺度可以分解为\n$$\nH(t) = C_1(t)\\,\\Phi_1(t)^2 + C_2(t)\\,\\Phi_2(t)^2 + 2\\,L_k(t)\\,\\Phi_1(t)\\,\\Phi_2(t),\n$$\n其中 $\\Phi_i(t)$ 是管的磁通量，单位为 $\\mathrm{Weber}$；$C_i(t)$ 是无量纲的自螺度系数，用于编码内部的扭曲/缠绕；$L_k(t)$ 是两管之间的 Gauss 环绕数（对于不相交的管是整数）。对于本问题，将这些管视为由波数 $k_1$ 和 $k_2$（单位为 $\\mathrm{m^{-1}}$）表征的单模结构，这意味着磁通量遵循由扩散引起的衰减定律：\n$$\n\\frac{d\\Phi_i}{dt} = -\\eta k_i^2 \\Phi_i \\quad \\Rightarrow \\quad \\Phi_i(t) = \\Phi_{i0}\\,e^{-\\eta k_i^2 t},\n$$\n其中 $\\Phi_{i0} = \\Phi_i(0)$。\n\n重联时的拓扑转移规则：\n- 假设在时间 $t_{\\mathrm{rec}}$ 发生一次重联事件，在此事件中，磁通量管在拓扑上解开，使 $L_k$ 瞬时地从 $L_k^{-}$ 变为 $L_k^{+}$（对于本问题，是从 $1$ 变为 $0$）。假设在持续时间可忽略的极限下（即，当 $dt \\to 0$ 时，瞬时电阻损耗为零），磁螺度在该事件中是连续的。那么 $H$ 的连续性要求\n$$\nC_1^{+} \\,\\Phi_1(t_{\\mathrm{rec}})^2 + C_2^{+} \\,\\Phi_2(t_{\\mathrm{rec}})^2 = C_1^{-} \\,\\Phi_1(t_{\\mathrm{rec}})^2 + C_2^{-} \\,\\Phi_2(t_{\\mathrm{rec}})^2 + 2 L_k^{-} \\,\\Phi_1(t_{\\mathrm{rec}})\\,\\Phi_2(t_{\\mathrm{rec}}),\n$$\n其中 $L_k^{+}=0$。用一个分数 $s \\in [0,1]$ 来参数化互螺度到自螺度的重新分配，使得\n$$\nC_1^{+} = C_1^{-} + s \\cdot \\frac{2 L_k^{-} \\,\\Phi_2(t_{\\mathrm{rec}})}{\\Phi_1(t_{\\mathrm{rec}})}, \\quad\nC_2^{+} = C_2^{-} + (1-s) \\cdot \\frac{2 L_k^{-} \\,\\Phi_1(t_{\\mathrm{rec}})}{\\Phi_2(t_{\\mathrm{rec}})}.\n$$\n\n验证目标：\n1. 使用上述定义，证明当 $L_k$ 和 $C_i$ 为常数时，螺度满足指数衰减定律\n$$\nH(t) = C_1 \\,\\Phi_{10}^2\\,e^{-2\\eta k_1^2 t} + C_2 \\,\\Phi_{20}^2\\,e^{-2\\eta k_2^2 t} + 2 L_k \\,\\Phi_{10}\\,\\Phi_{20}\\,e^{-\\eta (k_1^2+k_2^2) t}.\n$$\n根据感应方程和螺度定义，数值验证 $dH/dt$ 的有限差分近似在小的相对容差内等于 $-2\\eta\\,Q(t)$，其中\n$$\nQ(t) = C_1 k_1^2 \\Phi_1(t)^2 + C_2 k_2^2 \\Phi_2(t)^2 + L_k \\,(k_1^2 + k_2^2)\\,\\Phi_1(t)\\,\\Phi_2(t),\n$$\n2. 在 $t_{\\mathrm{rec}}$ 时，实现上述拓扑转移规则，并验证 $H(t)$ 在 $t_{\\mathrm{rec}}$ 两侧在数值精度上是连续的。\n\n程序要求：\n- 实现一个单一、完整、可运行的程序，该程序能为指定的参数和时间计算 $\\Phi_i(t)$、$H(t)$ 和 $Q(t)$，并通过报告相对误差来执行上述验证。\n- 物理单位：$\\eta$ 使用 $\\mathrm{m^2/s}$， $k_i$ 使用 $\\mathrm{m^{-1}}$，时间使用 $\\mathrm{s}$，通量使用 $\\mathrm{Weber}$，螺度使用 $\\mathrm{Weber^2}$。最终报告的误差是无量纲浮点数。\n- 角度单位：本问题不使用角度单位。\n- 程序必须将所有测试用例的结果聚合到单行输出中，该输出包含一个逗号分隔的 Python 浮点数列表，四舍五入到六位小数。\n\n测试套件：\n使用以下参数集来检验不同方面：\n\n- 案例1（带重联和非对称分配的一般电阻性演化）：\n    - $\\eta = 10^{-3}\\,\\mathrm{m^2/s}$，$\\Phi_{10} = 0.20\\,\\mathrm{Weber}$，$\\Phi_{20} = 0.15\\,\\mathrm{Weber}$，\n      $k_1 = 12\\,\\mathrm{m^{-1}}$，$k_2 = 8\\,\\mathrm{m^{-1}}$，\n      $C_1^{-} = 1.5$，$C_2^{-} = 0.5$，$L_k^{-} = 1$，\n      $t_{\\mathrm{rec}} = 100\\,\\mathrm{s}$，$s = 0.6$，在时间 $t \\in \\{50, 100, 150, 300\\}\\,\\mathrm{s}$ 进行评估。\n    - 报告以下各项中的最大值：在每个评估时间点（不包括 $t_{\\mathrm{rec}}$）有限差分 $dH/dt$ 与 $-2\\eta Q(t)$ 之间的相对误差，以及在 $t_{\\mathrm{rec}}$ 处 $H$ 的绝对跳变。\n- 案例2（理想极限 $\\eta = 0$ 且有重联）：\n    - $\\eta = 0\\,\\mathrm{m^2/s}$，$\\Phi_{10} = 0.30\\,\\mathrm{Weber}$，$\\Phi_{20} = 0.10\\,\\mathrm{Weber}$，\n      $k_1 = 5\\,\\mathrm{m^{-1}}$，$k_2 = 7\\,\\mathrm{m^{-1}}$，\n      $C_1^{-} = 0.7$，$C_2^{-} = 1.2$，$L_k^{-} = 1$，\n      $t_{\\mathrm{rec}} = 50\\,\\mathrm{s}$，$s = 0.5$，在时间 $t \\in \\{10, 50, 100\\}\\,\\mathrm{s}$ 进行评估。\n    - 报告在评估时间内 $H(t)$ 与其初始值的最大绝对偏差，以及在 $t_{\\mathrm{rec}}$ 处 $H$ 的绝对跳变。\n- 案例3（无重联的电阻性演化）：\n    - $\\eta = 10^{-3}\\,\\mathrm{m^2/s}$，$\\Phi_{10} = 0.25\\,\\mathrm{Weber}$，$\\Phi_{20} = 0.25\\,\\mathrm{Weber}$，\n      $k_1 = 10\\,\\mathrm{m^{-1}}$，$k_2 = 10\\,\\mathrm{m^{-1}}$，\n      $C_1 = 1.0$，$C_2 = 1.0$，$L_k = 1$，\n      无重联事件；在时间 $t \\in \\{100, 300\\}\\,\\mathrm{s}$ 进行评估。\n    - 报告在评估时间点有限差分 $dH/dt$ 与 $-2\\eta Q(t)$ 之间的最大相对误差。\n- 案例4（重联时的极端分配）：\n    - $\\eta = 5 \\times 10^{-4}\\,\\mathrm{m^2/s}$，$\\Phi_{10} = 0.18\\,\\mathrm{Weber}$，$\\Phi_{20} = 0.22\\,\\mathrm{Weber}$，\n      $k_1 = 9\\,\\mathrm{m^{-1}}$，$k_2 = 11\\,\\mathrm{m^{-1}}$，\n      $C_1^{-} = 0.9$，$C_2^{-} = 0.4$，$L_k^{-} = 1$，\n      $t_{\\mathrm{rec}} = 120\\,\\mathrm{s}$，$s = 1.0$，在时间 $t \\in \\{120, 240\\}\\,\\mathrm{s}$ 进行评估。\n    - 报告在 $t_{\\mathrm{rec}}$ 处 $H$ 的绝对跳变和在 $t=240\\,\\mathrm{s}$ 时有限差分 $dH/dt$ 与 $-2\\eta Q(t)$ 之间的相对误差；返回这些值中的最大值。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的浮点数列表形式的结果，四舍五入到六位小数，并用方括号括起来（例如，\"[0.000001,0.000002,0.000003,0.000004]\"）。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、良定且客观的。它为两个电阻性磁通量管系统中的磁螺度演化提供了一个一致且可形式化的模型，包括重联事件期间螺度转移的规则。所有必要的参数和验证目标都已明确定义。\n\n### 解析验证\n\n该问题要求在所提供的细磁通量管模型内验证两个关键关系。\n\n**1. 螺度衰减定律**\n\n磁螺度 $H(t)$ 由自螺度和互螺度项的总和给出：\n$$\nH(t) = C_1(t)\\,\\Phi_1(t)^2 + C_2(t)\\,\\Phi_2(t)^2 + 2\\,L_k(t)\\,\\Phi_1(t)\\,\\Phi_2(t)\n$$\n假设每个管 $i \\in \\{1, 2\\}$ 的磁通量 $\\Phi_i(t)$ 按如下方式进行电阻性衰减：\n$$\n\\Phi_i(t) = \\Phi_{i0}\\,e^{-\\eta k_i^2 t}\n$$\n其中 $\\Phi_{i0}$ 是 $t=0$ 时的初始通量，$\\eta$ 是磁阻率，而 $k_i$ 是管的特征波数。\n\n在自螺度系数 $C_i$ 和环绕数 $L_k$ 恒定的时间间隔内，我们可以将 $\\Phi_i(t)$ 的表达式代入 $H(t)$ 的方程中：\n$$\nH(t) = C_1 \\left(\\Phi_{10}\\,e^{-\\eta k_1^2 t}\\right)^2 + C_2 \\left(\\Phi_{20}\\,e^{-\\eta k_2^2 t}\\right)^2 + 2 L_k \\left(\\Phi_{10}\\,e^{-\\eta k_1^2 t}\\right)\\left(\\Phi_{20}\\,e^{-\\eta k_2^2 t}\\right)\n$$\n通过应用指数法则，我们得到指定的螺度衰减定律：\n$$\nH(t) = C_1 \\,\\Phi_{10}^2\\,e^{-2\\eta k_1^2 t} + C_2 \\,\\Phi_{20}^2\\,e^{-2\\eta k_2^2 t} + 2 L_k \\,\\Phi_{10}\\,\\Phi_{20}\\,e^{-\\eta (k_1^2+k_2^2) t}\n$$\n这证实了第一个解析陈述。\n\n**2. 螺度耗散率**\n\n磁螺度的变化率 $\\frac{dH}{dt}$ 可以通过对 $H(t)$ 的表达式关于时间 $t$ 求导得出，假设 $C_i$ 和 $L_k$ 是常数：\n$$\n\\frac{dH}{dt} = C_1 \\frac{d}{dt}(\\Phi_1^2) + C_2 \\frac{d}{dt}(\\Phi_2^2) + 2 L_k \\frac{d}{dt}(\\Phi_1 \\Phi_2)\n$$\n使用链式法则和给定的通量衰减定律 $\\frac{d\\Phi_i}{dt} = -\\eta k_i^2 \\Phi_i(t)$：\n$$\n\\frac{dH}{dt} = 2C_1\\Phi_1 \\frac{d\\Phi_1}{dt} + 2C_2\\Phi_2 \\frac{d\\Phi_2}{dt} + 2 L_k (\\frac{d\\Phi_1}{dt}\\Phi_2 + \\Phi_1\\frac{d\\Phi_2}{dt})\n$$\n$$\n\\frac{dH}{dt} = 2C_1\\Phi_1(-\\eta k_1^2 \\Phi_1) + 2C_2\\Phi_2(-\\eta k_2^2 \\Phi_2) + 2 L_k ((-\\eta k_1^2 \\Phi_1)\\Phi_2 + \\Phi_1(-\\eta k_2^2 \\Phi_2))\n$$\n提出公因子 $-2\\eta$：\n$$\n\\frac{dH}{dt} = -2\\eta \\left[ C_1 k_1^2 \\Phi_1^2 + C_2 k_2^2 \\Phi_2^2 + L_k (k_1^2 \\Phi_1\\Phi_2 + k_2^2 \\Phi_1\\Phi_2) \\right]\n$$\n$$\n\\frac{dH}{dt} = -2\\eta \\left[ C_1 k_1^2 \\Phi_1(t)^2 + C_2 k_2^2 \\Phi_2(t)^2 + L_k (k_1^2 + k_2^2)\\,\\Phi_1(t)\\,\\Phi_2(t) \\right]\n$$\n此表达式等价于 $\\frac{dH}{dt} = -2\\eta Q(t)$，其中 $Q(t)$ 是问题中定义的量。这验证了模型动力学的一致性。\n\n### 计算实现\n\n通过开发一个 Python 程序来解决该问题，该程序实现物理模型并为一套测试用例执行指定的数值验证。\n\n**1. 系统状态与演化：**\n双管系统的状态由参数 $\\{\\eta, \\Phi_{10}, \\Phi_{20}, k_1, k_2, C_1^{-}, C_2^{-}, L_k^{-}\\}$ 和重联参数 $\\{t_{\\mathrm{rec}}, s\\}$ 定义。程序计算任意时刻 $t$ 的状态。\n- 通量 $\\Phi_1(t)$ 和 $\\Phi_2(t)$ 使用其指数衰减定律计算。\n- 系数 $(C_1, C_2, L_k)$被视为分段常数。对于给定的时间 $t$，如果 $t  t_{\\mathrm{rec}}$，程序选择重联前系数 $(C_1^{-}, C_2^{-}, L_k^{-})$；如果 $t \\ge t_{\\mathrm{rec}}$，则选择重联后系数 $(C_1^{+}, C_2^{+}, L_k^{+})$。\n\n**2. 重联逻辑：**\n对于涉及重联的情况，重联后系数 $(C_1^{+}, C_2^{+})$ 基于螺度守恒原理计算。\n- 在 $t=t_{\\mathrm{rec}}$ 时，计算通量 $\\Phi_1(t_{\\mathrm{rec}})$ 和 $\\Phi_2(t_{\\mathrm{rec}})$。\n- 重联后的环绕数为 $L_k^{+} = 0$。\n- 然后使用提供的转移规则找到更新后的自螺度系数：\n  $$\n  C_1^{+} = C_1^{-} + s \\cdot \\frac{2 L_k^{-} \\,\\Phi_2(t_{\\mathrm{rec}})}{\\Phi_1(t_{\\mathrm{rec}})}, \\quad\n  C_2^{+} = C_2^{-} + (1-s) \\cdot \\frac{2 L_k^{-} \\,\\Phi_1(t_{\\mathrm{rec}})}{\\Phi_2(t_{\\mathrm{rec}})}\n  $$\n\n**3. 数值验证程序：**\n- **衰减率误差**：时间导数 $\\frac{dH}{dt}$ 使用具有小步长 $\\delta t = 10^{-6} \\, s$ 的二阶中心有限差分格式进行数值近似。在指定时间计算此数值导数与理论速率 $-2\\eta Q(t)$ 之间的相对误差，不包括 $t=t_{\\mathrm{rec}}$ 以避免不连续性。\n- **重联跳变**：螺度的跳变计算为绝对差 $|H(t_{\\mathrm{rec}}^{+}) - H(t_{\\mathrm{rec}}^{-})|$。$H(t_{\\mathrm{rec}}^{+})$ 使用 $(C_1^{+}, C_2^{+}, L_k^{+})$ 计算，而 $H(t_{\\mathrm{rec}}^{-})$ 使用 $(C_1^{-}, C_2^{-}, L_k^{-})$ 计算，通量均在 $t_{\\mathrm{rec}}$ 处取值。\n- **理想MHD守恒**：对于 $\\eta=0$ 的情况，磁通量和总螺度是守恒的。验证涉及计算 $H(t)$ 与其初始值 $H(0)$ 的绝对偏差。\n\n**4. 测试用例执行：**\n主函数遍历四个指定的测试用例。对于每个用例，它使用给定的参数初始化模型，在指定的评估时间执行所需的计算，并按问题规定确定最大误差或偏差。这些最终值被收集并以所需格式打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the magnetic helicity evolution problem for a set of test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"eta\": 1e-3, \"phi10\": 0.20, \"phi20\": 0.15,\n            \"k1\": 12.0, \"k2\": 8.0,\n            \"C1_minus\": 1.5, \"C2_minus\": 0.5, \"Lk_minus\": 1,\n            \"t_rec\": 100.0, \"s\": 0.6,\n            \"eval_times\": [50.0, 100.0, 150.0, 300.0]\n        },\n        # Case 2\n        {\n            \"eta\": 0.0, \"phi10\": 0.30, \"phi20\": 0.10,\n            \"k1\": 5.0, \"k2\": 7.0,\n            \"C1_minus\": 0.7, \"C2_minus\": 1.2, \"Lk_minus\": 1,\n            \"t_rec\": 50.0, \"s\": 0.5,\n            \"eval_times\": [10.0, 50.0, 100.0]\n        },\n        # Case 3\n        {\n            \"eta\": 1e-3, \"phi10\": 0.25, \"phi20\": 0.25,\n            \"k1\": 10.0, \"k2\": 10.0,\n            \"C1_minus\": 1.0, \"C2_minus\": 1.0, \"Lk_minus\": 1,\n            \"t_rec\": None, \"s\": None,\n            \"eval_times\": [100.0, 300.0]\n        },\n        # Case 4\n        {\n            \"eta\": 5e-4, \"phi10\": 0.18, \"phi20\": 0.22,\n            \"k1\": 9.0, \"k2\": 11.0,\n            \"C1_minus\": 0.9, \"C2_minus\": 0.4, \"Lk_minus\": 1,\n            \"t_rec\": 120.0, \"s\": 1.0,\n            \"eval_times\": [120.0, 240.0]\n        }\n    ]\n\n    results = []\n\n    class HelicitySystem:\n        \"\"\"Models the two-flux-tube system.\"\"\"\n        def __init__(self, params):\n            self.eta = params[\"eta\"]\n            self.phi10 = params[\"phi10\"]\n            self.phi20 = params[\"phi20\"]\n            self.k1_sq = params[\"k1\"]**2\n            self.k2_sq = params[\"k2\"]**2\n            \n            self.C1_minus = params[\"C1_minus\"]\n            self.C2_minus = params[\"C2_minus\"]\n            self.Lk_minus = params[\"Lk_minus\"]\n            \n            self.t_rec = params[\"t_rec\"]\n            self.s = params[\"s\"]\n            self.has_rec = self.t_rec is not None\n\n            if self.has_rec:\n                self._compute_post_rec_params()\n            else:\n                self.C1_plus = self.C1_minus\n                self.C2_plus = self.C2_minus\n                self.Lk_plus = self.Lk_minus\n\n        def _compute_post_rec_params(self):\n            phi1_rec = self.get_phi(1, self.t_rec)\n            phi2_rec = self.get_phi(2, self.t_rec)\n\n            self.Lk_plus = 0\n            if phi1_rec == 0 or phi2_rec == 0:\n                self.C1_plus = self.C1_minus\n                self.C2_plus = self.C2_minus\n                return\n\n            term1 = self.s * (2 * self.Lk_minus * phi2_rec) / phi1_rec\n            term2 = (1 - self.s) * (2 * self.Lk_minus * phi1_rec) / phi2_rec\n            self.C1_plus = self.C1_minus + term1\n            self.C2_plus = self.C2_minus + term2\n\n        def get_phi(self, i, t):\n            if self.eta == 0:\n                return self.phi10 if i == 1 else self.phi20\n            k_sq = self.k1_sq if i == 1 else self.k2_sq\n            phi0 = self.phi10 if i == 1 else self.phi20\n            return phi0 * np.exp(-self.eta * k_sq * t)\n\n        def get_coeffs(self, t):\n            if self.has_rec and t >= self.t_rec:\n                return self.C1_plus, self.C2_plus, self.Lk_plus\n            return self.C1_minus, self.C2_minus, self.Lk_minus\n        \n        def H(self, t, coeffs=None):\n            if coeffs is None:\n                coeffs = self.get_coeffs(t)\n            C1, C2, Lk = coeffs\n            phi1 = self.get_phi(1, t)\n            phi2 = self.get_phi(2, t)\n            return C1 * phi1**2 + C2 * phi2**2 + 2 * Lk * phi1 * phi2\n\n        def Q(self, t, coeffs=None):\n            if coeffs is None:\n                coeffs = self.get_coeffs(t)\n            C1, C2, Lk = coeffs\n            phi1 = self.get_phi(1, t)\n            phi2 = self.get_phi(2, t)\n            return (C1 * self.k1_sq * phi1**2 +\n                    C2 * self.k2_sq * phi2**2 +\n                    Lk * (self.k1_sq + self.k2_sq) * phi1 * phi2)\n\n    for i, case_params in enumerate(test_cases):\n        system = HelicitySystem(case_params)\n        errors = []\n        dt = 1e-6\n\n        # Case-specific logic\n        if i == 0: # Case 1\n            for t in case_params[\"eval_times\"]:\n                if t == system.t_rec:\n                    H_minus = system.H(t, coeffs=(system.C1_minus, system.C2_minus, system.Lk_minus))\n                    H_plus = system.H(t, coeffs=(system.C1_plus, system.C2_plus, system.Lk_plus))\n                    errors.append(abs(H_plus - H_minus))\n                else:\n                    dHdt_fd = (system.H(t + dt) - system.H(t - dt)) / (2 * dt)\n                    dHdt_exact = -2 * system.eta * system.Q(t)\n                    if dHdt_exact != 0:\n                        errors.append(abs((dHdt_fd - dHdt_exact) / dHdt_exact))\n        \n        elif i == 1: # Case 2\n            H0 = system.H(0)\n            for t in case_params[\"eval_times\"]:\n                if t == system.t_rec:\n                    H_minus = system.H(t, coeffs=(system.C1_minus, system.C2_minus, system.Lk_minus))\n                    H_plus = system.H(t, coeffs=(system.C1_plus, system.C2_plus, system.Lk_plus))\n                    errors.append(abs(H_plus - H_minus))\n                else:\n                    errors.append(abs(system.H(t) - H0))\n\n        elif i == 2: # Case 3\n            for t in case_params[\"eval_times\"]:\n                dHdt_fd = (system.H(t + dt) - system.H(t - dt)) / (2 * dt)\n                dHdt_exact = -2 * system.eta * system.Q(t)\n                if dHdt_exact != 0:\n                    errors.append(abs((dHdt_fd - dHdt_exact) / dHdt_exact))\n        \n        elif i == 3: # Case 4\n            for t in case_params[\"eval_times\"]:\n                if t == system.t_rec:\n                    H_minus = system.H(t, coeffs=(system.C1_minus, system.C2_minus, system.Lk_minus))\n                    H_plus = system.H(t, coeffs=(system.C1_plus, system.C2_plus, system.Lk_plus))\n                    errors.append(abs(H_plus - H_minus))\n                else:\n                    dHdt_fd = (system.H(t + dt) - system.H(t - dt)) / (2 * dt)\n                    dHdt_exact = -2 * system.eta * system.Q(t)\n                    if dHdt_exact != 0:\n                        errors.append(abs((dHdt_fd - dHdt_exact) / dHdt_exact))\n\n        results.append(max(errors) if errors else 0.0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}