{
    "hands_on_practices": [
        {
            "introduction": "The Sweet-Parker model provides the foundational framework for understanding resistive magnetic reconnection. This exercise solidifies the core concepts by tasking you to derive and calculate the key parameters of a reconnection layer, such as the inflow speed $v_{\\mathrm{in}}$ and the current sheet thickness $\\delta$, from first principles . By applying these scaling laws to a set of astrophysical parameters, you will develop an intuition for the physical scales involved and see firsthand why the model's predicted slow reconnection rate presents a major puzzle in many contexts.",
            "id": "4220366",
            "problem": "In the resistive magnetohydrodynamics (MHD) description of magnetic reconnection in a steady, two-dimensional, symmetric current sheet of half-length $L$ and half-thickness $\\delta$, consider a uniform upstream magnetic field of magnitude $B$ reversing across the sheet, a uniform upstream mass density $\\rho$, and a uniform magnetic diffusivity $\\eta$ (with units $\\mathrm{m^2/s}$). Adopt the Sweet–Parker paradigm for a steady reconnection layer in an incompressible plasma, and use the Alfvénic outflow assumption.\n\nStarting from the resistive induction equation and mass conservation, and using an Alfvénic characteristic speed where appropriate, derive expressions for the Lundquist number $S$, the Alfvén speed $v_{A}$, the inflow speed $v_{\\mathrm{in}}$, and the current-sheet half-thickness $\\delta$ in terms of $L$, $B$, $\\rho$, the vacuum magnetic permeability $\\mu_{0}$, and $\\eta$. Then evaluate these quantities for\n$L=10^{7}\\ \\mathrm{m}$, $B=10^{-2}\\ \\mathrm{T}$, $\\rho=10^{-10}\\ \\mathrm{kg/m^{3}}$, $\\eta=1\\ \\mathrm{m^{2}/s}$, and $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$.\n\nInstructions:\n- Express the Lundquist number $S$ as dimensionless, the speeds $v_{A}$ and $v_{\\mathrm{in}}$ in $\\mathrm{m/s}$, and the thickness $\\delta$ in $\\mathrm{m}$.\n- Round your answers to three significant figures.\n- Your final reported result must be ordered as $\\left(S,\\ v_{A},\\ v_{\\mathrm{in}},\\ \\delta\\right)$.",
            "solution": "The solution involves two parts: first, deriving the Sweet-Parker scaling relations from fundamental principles, and second, applying these relations to the given numerical values.\n\n**1. Derivation of Sweet-Parker Scaling Relations**\n\nWe begin with two key conservation laws for a steady-state, incompressible plasma in the reconnection layer of half-length $L$ and half-thickness $\\delta$.\n*   **Mass Conservation:** The mass flux entering the layer must equal the mass flux exiting it. Plasma enters with speed $v_{\\mathrm{in}}$ over an area $2L \\times 1$ (for unit depth) and exits with speed $v_{\\mathrm{out}}$ over an area $2\\delta \\times 1$. This gives:\n    $$ \\rho v_{\\mathrm{in}} (2L) = \\rho v_{\\mathrm{out}} (2\\delta) \\implies v_{\\mathrm{in}} L = v_{\\mathrm{out}} \\delta $$\n*   **Induction Equation (Steady State):** In steady state, the advection of the magnetic field into the layer is balanced by its resistive diffusion within the layer. From the induction equation $\\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) \\approx -\\eta \\nabla^2 \\mathbf{B}$, an order-of-magnitude analysis gives:\n    $$ \\frac{v_{\\mathrm{in}} B}{\\delta} \\approx \\frac{\\eta B}{\\delta^2} \\implies v_{\\mathrm{in}} \\approx \\frac{\\eta}{\\delta} $$\n*   **Alfvénic Outflow:** It is assumed that the magnetic energy converted in the layer accelerates the plasma to the local Alfvén speed, so $v_{\\mathrm{out}} \\approx v_A$. The Alfvén speed is defined as:\n    $$ v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} $$\nBy substituting $v_{\\mathrm{out}} = v_A$ into the mass conservation equation, we get $v_{\\mathrm{in}} L = v_A \\delta$. We now have a system of two equations for the two unknowns $v_{\\mathrm{in}}$ and $\\delta$:\n1.  $v_{\\mathrm{in}} L = v_A \\delta$\n2.  $v_{\\mathrm{in}} \\delta = \\eta$\n\nSolving for $\\delta$ by substituting $v_{\\mathrm{in}}$ from (2) into (1): $(\\eta/\\delta)L = v_A \\delta \\implies \\delta^2 = \\eta L / v_A$.\nWe introduce the dimensionless Lundquist number $S = \\frac{L v_A}{\\eta}$. Rearranging, we get $\\eta = \\frac{L v_A}{S}$.\nSubstituting this into the expression for $\\delta^2$:\n$$ \\delta^2 = \\frac{1}{S} \\frac{L v_A}{v_A} L = \\frac{L^2}{S} \\implies \\delta = L S^{-1/2} $$\nNow solving for $v_{\\mathrm{in}}$:\n$$ v_{\\mathrm{in}} = \\frac{\\eta}{\\delta} = \\frac{L v_A / S}{L S^{-1/2}} \\implies v_{\\mathrm{in}} = v_A S^{-1/2} $$\n\n**2. Numerical Evaluation**\n\nGiven parameters: $L=10^{7}\\ \\mathrm{m}$, $B=10^{-2}\\ \\mathrm{T}$, $\\rho=10^{-10}\\ \\mathrm{kg/m^{3}}$, $\\eta=1\\ \\mathrm{m^{2}/s}$, $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$.\n\n*   **Alfvén Speed ($v_A$):**\n    $$ v_A = \\frac{10^{-2}\\ \\mathrm{T}}{\\sqrt{(4\\pi \\times 10^{-7}\\ \\mathrm{H/m}) \\times (10^{-10}\\ \\mathrm{kg/m^{3}})}} = \\frac{10^{-2}}{\\sqrt{4\\pi \\times 10^{-17}}} \\approx 8.9206 \\times 10^5 \\ \\mathrm{m/s} \\approx 8.92 \\times 10^5 \\ \\mathrm{m/s} $$\n*   **Lundquist Number ($S$):**\n    $$ S = \\frac{L v_A}{\\eta} = \\frac{(10^7\\ \\mathrm{m}) \\times (8.9206 \\times 10^5\\ \\mathrm{m/s})}{1\\ \\mathrm{m^2/s}} \\approx 8.9206 \\times 10^{12} \\approx 8.92 \\times 10^{12} $$\n*   **Inflow Speed ($v_{\\mathrm{in}}$):**\n    $$ v_{\\mathrm{in}} = v_A S^{-1/2} = (8.9206 \\times 10^5\\ \\mathrm{m/s}) \\times (8.9206 \\times 10^{12})^{-1/2} \\approx 0.2987 \\ \\mathrm{m/s} \\approx 0.299 \\ \\mathrm{m/s} $$\n*   **Sheet Half-Thickness ($\\delta$):**\n    $$ \\delta = L S^{-1/2} = (10^7\\ \\mathrm{m}) \\times (8.9206 \\times 10^{12})^{-1/2} \\approx 3.348 \\ \\mathrm{m} \\approx 3.35 \\ \\mathrm{m} $$\n\nThe final ordered result $(S,\\ v_{A},\\ v_{\\mathrm{in}},\\ \\delta)$ is $(8.92 \\times 10^{12}, 8.92 \\times 10^{5}, 0.299, 3.35)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8.92 \\times 10^{12} & 8.92 \\times 10^{5} & 0.299 & 3.35\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the Sweet-Parker model provides a steady-state solution, real-world current sheets in high Lundquist number ($S$) plasmas are often dynamically unstable. This practice explores the transition to fast reconnection via the plasmoid instability, which occurs when $S$ exceeds a critical threshold $S_c$ . Calculating whether a given system is unstable and determining the sheet's characteristics at the onset of this instability are crucial skills for understanding modern, bursty reconnection models.",
            "id": "4220345",
            "problem": "A resistive magnetohydrodynamic current sheet of characteristic half-length $L$ forms in a coronal-like astrophysical plasma with magnetic field magnitude $B$, mass density $\\rho$, and uniform magnetic diffusivity $\\eta$. The resistive magnetohydrodynamic (MHD) induction equation is of the form $\\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) + \\eta \\nabla^{2} \\mathbf{B}$, with the vacuum permeability denoted by $\\mu_{0}$. The Alfvén speed is defined by $V_{A} = B/\\sqrt{\\mu_{0}\\rho}$. The dimensionless Lundquist number $S$ characterizes the ratio of magnetic advection to diffusion over the scale $L$. A Sweet–Parker current sheet becomes linearly unstable to the plasmoid instability once $S$ exceeds a critical value $S_{c}$, and the onset thickness $\\delta_{\\mathrm{onset}}$ is the Sweet–Parker thickness evaluated at $S = S_{c}$.\n\nUsing only these standard definitions and physical laws, determine whether the Sweet–Parker sheet is linearly unstable to plasmoid formation for the parameters\n$\\eta = 3\\,\\mathrm{m^{2}\\,s^{-1}}$, $L = 5.0 \\times 10^{7}\\,\\mathrm{m}$, $B = 3.0 \\times 10^{-2}\\,\\mathrm{T}$, $\\rho = 3.0 \\times 10^{-12}\\,\\mathrm{kg\\,m^{-3}}$, and $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$,\nassuming a critical Lundquist number $S_{c} = 1.0 \\times 10^{4}$ appropriate to order-unity magnetic Prandtl number. Adopt the convention that instability is indicated by $I=1$ if $S > S_{c}$ and $I=0$ otherwise. Then, compute the expected onset thickness $\\delta_{\\mathrm{onset}}$.\n\nRound $\\delta_{\\mathrm{onset}}$ to three significant figures. Express $\\delta_{\\mathrm{onset}}$ in meters. Provide your final answer as a row matrix $\\begin{pmatrix} I & \\delta_{\\mathrm{onset}} \\end{pmatrix}$.",
            "solution": "This problem requires us to determine if a Sweet-Parker current sheet is unstable to plasmoid formation and to calculate the sheet's characteristic thickness at the onset of this instability.\n\n**1. Determination of Instability ($I$)**\n\nThe instability occurs if the system's Lundquist number $S$ exceeds the critical value $S_c$. We must first calculate $S$.\n\n*   **Definition of Alfvén Speed ($V_A$):**\n    $$ V_{A} = \\frac{B}{\\sqrt{\\mu_{0}\\rho}} $$\n*   **Definition of Lundquist Number ($S$):**\n    $$ S = \\frac{L V_{A}}{\\eta} $$\n\nFirst, we calculate the Alfvén speed with the given parameters: $B = 3.0 \\times 10^{-2}\\,\\mathrm{T}$, $\\rho = 3.0 \\times 10^{-12}\\,\\mathrm{kg\\,m^{-3}}$, and $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$.\n$$ V_{A} = \\frac{3.0 \\times 10^{-2}}{\\sqrt{(4\\pi \\times 10^{-7}) \\times (3.0 \\times 10^{-12})}} = \\frac{3.0 \\times 10^{-2}}{\\sqrt{12\\pi \\times 10^{-19}}} \\approx 1.545 \\times 10^{7} \\, \\mathrm{m/s} $$\nNext, we calculate the Lundquist number using the calculated $V_A$ and the given values for $L = 5.0 \\times 10^{7}\\,\\mathrm{m}$ and $\\eta = 3\\,\\mathrm{m^{2}\\,s^{-1}}$:\n$$ S = \\frac{(5.0 \\times 10^{7}\\,\\mathrm{m}) \\times (1.545 \\times 10^{7}\\,\\mathrm{m/s})}{3\\,\\mathrm{m^{2}\\,s^{-1}}} \\approx 2.575 \\times 10^{14} $$\nWe compare $S$ with the critical value $S_{c} = 1.0 \\times 10^{4}$.\nSince $S \\approx 2.58 \\times 10^{14} > S_c = 1.0 \\times 10^4$, the sheet is unstable.\nTherefore, the instability indicator is $I=1$.\n\n**2. Calculation of Onset Thickness ($\\delta_{\\mathrm{onset}}$)**\n\nThe onset thickness $\\delta_{\\mathrm{onset}}$ is defined as the Sweet-Parker thickness evaluated at the critical Lundquist number, $S = S_c$. The Sweet-Parker thickness scales as:\n$$ \\delta_{\\mathrm{SP}} = L S^{-1/2} $$\nTherefore, the onset thickness is:\n$$ \\delta_{\\mathrm{onset}} = L S_c^{-1/2} $$\nSubstituting the given values $L = 5.0 \\times 10^{7}\\,\\mathrm{m}$ and $S_c = 1.0 \\times 10^4$:\n$$ \\delta_{\\mathrm{onset}} = (5.0 \\times 10^{7}\\,\\mathrm{m}) \\times (1.0 \\times 10^4)^{-1/2} = \\frac{5.0 \\times 10^{7}}{100} \\, \\mathrm{m} = 5.0 \\times 10^5 \\, \\mathrm{m} $$\nRounding to three significant figures gives $5.00 \\times 10^5 \\, \\mathrm{m}$.\n\n**3. Final Result**\n\nCombining the results, the final answer as a row matrix $\\begin{pmatrix} I & \\delta_{\\mathrm{onset}} \\end{pmatrix}$ is:\n$$ \\begin{pmatrix} 1 & 5.00 \\times 10^{5} \\end{pmatrix} $$",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 & 5.00 \\times 10^{5} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Beyond the fluid-level description of magnetohydrodynamics, magnetic reconnection is fundamentally a process of powerful particle acceleration. This computational exercise moves beyond the MHD paradigm to explore the kinetic physics of individual charged particles within a model reconnection region . By simulating particle trajectories and analyzing their energy gain, you will gain hands-on insight into the distinct mechanisms, such as direct acceleration and Fermi-like processes, that power high-energy phenomena from solar flares to gamma-ray bursts.",
            "id": "4220376",
            "problem": "Consider a non-relativistic, collisionless test-particle moving in a simplified two-dimensional magnetic reconnection configuration representative of astrophysical plasmas. The particle dynamics are governed by the Lorentz force starting from first principles. The model fields are steady in time and vary in space according to a canonical current-sheet form with a uniform guide field and a uniform reconnection electric field. The inflow of the ambient plasma generates a motional electric field through the usual cross-field relation. Your task is to implement a program that integrates the particle trajectory and computes the kinetic energy gain and the dominant acceleration mechanism for each of several parameter sets.\n\nFundamental base:\n- Start from the Lorentz force law, $m \\, d\\mathbf{v}/dt = q \\left( \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\right)$, and $d\\mathbf{r}/dt = \\mathbf{v}$, where $m$ is mass, $q$ is charge, $\\mathbf{v}$ is velocity, $\\mathbf{r}$ is position, $\\mathbf{E}$ is electric field, and $\\mathbf{B}$ is magnetic field.\n- The instantaneous rate of change of kinetic energy is $dW/dt = q \\, \\mathbf{E} \\cdot \\mathbf{v}$, with $W$ the kinetic energy.\n- The simplified reconnection magnetic field is $\\mathbf{B}(\\mathbf{r}) = B_0 \\tanh(y/L) \\, \\hat{\\mathbf{x}} + B_g \\, \\hat{\\mathbf{z}}$, where $B_0$ is the reconnecting field amplitude, $L$ is the current-sheet half-thickness, $y$ is the coordinate across the sheet, and $B_g$ is the uniform guide field.\n- The reconnection electric field is uniform and along $\\hat{\\mathbf{z}}$: $\\mathbf{E}_{\\mathrm{rec}} = E_0 \\, \\hat{\\mathbf{z}}$, with $E_0$ constant.\n- The background plasma inflow is $\\mathbf{V}_{\\mathrm{in}} = - V_{\\mathrm{in}} \\, \\hat{\\mathbf{y}}$. The motional electric field is defined by $\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = - \\mathbf{V}_{\\mathrm{in}} \\times \\mathbf{B}(\\mathbf{r})$. The total electric field is $\\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}) = \\mathbf{E}_{\\mathrm{rec}} + \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r})$.\n\nDefinitions and assumptions:\n- The particle is non-relativistic: $|\\mathbf{v}| \\ll c$, with $c$ the speed of light.\n- The fields are steady in time and vary only in space as given above.\n- The particle equations are integrated using an energy-conserving Boris algorithm suitable for Charged Particle Motion (CPM).\n- Magnetohydrodynamics (MHD) is not solved; this is a test-particle calculation in prescribed fields.\n\nMechanism identification:\n- Decompose the work done on the particle into two scalar contributions integrated over time: $\\Delta W_{\\mathrm{rec}} = \\int q \\, \\mathbf{E}_{\\mathrm{rec}} \\cdot \\mathbf{v} \\, dt$ and $\\Delta W_{\\mathrm{m}} = \\int q \\, \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}(t)) \\cdot \\mathbf{v} \\, dt$. The total kinetic energy change is $\\Delta W = W_{\\mathrm{final}} - W_{\\mathrm{initial}}$.\n- Define the dominant acceleration mechanism by comparing absolute contributions: if $|\\Delta W_{\\mathrm{rec}}| \\ge |\\Delta W_{\\mathrm{m}}|$, label as $0$ (direct reconnection electric field acceleration); otherwise label as $1$ (first-order Fermi-like acceleration via motional electric field).\n\nNumerical integration requirement:\n- Use the Boris pusher with time step $dt$ and total integration time $T$ for each case.\n- At each step, evaluate $\\mathbf{B}(\\mathbf{r})$, $\\mathbf{E}_{\\mathrm{rec}}$, and $\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r})$ at the current position.\n\nUnits and outputs:\n- All quantities are in International System of Units (SI) unless stated otherwise. Energies must be expressed in Joules ($\\mathrm{J}$).\n- Your program must output for each test case a list containing the kinetic energy gain and the mechanism label: $[\\Delta W, \\mathrm{label}]$, where $\\Delta W$ is a float in $\\mathrm{J}$ and $\\mathrm{label}$ is an integer.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\![\\Delta W_1,\\mathrm{label}_1],[\\Delta W_2,\\mathrm{label}_2],\\dots]\\!$). The brackets and commas must appear exactly once as described, with no additional text. Energies must be printed in $\\mathrm{J}$, as floats.\n\nTest suite:\nFor each case, provide $(q,m,B_0,B_g,L,E_0,V_{\\mathrm{in}},\\mathbf{r}_0,\\mathbf{v}_0,dt,T)$.\n\n- Case $1$ (electron, direct reconnection electric field dominant expected): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 9.109 \\times 10^{-31} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 0.0 \\, \\mathrm{T}$, $L = 1.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 1.0 \\times 10^{-3} \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 0.0 \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 100.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-9} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-6} \\, \\mathrm{s}$.\n- Case $2$ (electron, motional field dominant expected): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 9.109 \\times 10^{-31} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 5.0 \\times 10^{-5} \\, \\mathrm{T}$, $L = 1.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 0.0 \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 2.0 \\times 10^{3} \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 100.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-9} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-6} \\, \\mathrm{s}$.\n- Case $3$ (proton, mixed fields): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 1.673 \\times 10^{-27} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $L = 2.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 5.0 \\times 10^{-4} \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 3.0 \\times 10^{3} \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 200.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 50.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-7} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-5} \\, \\mathrm{s}$.\n- Case $4$ (electron, boundary condition far from neutral line): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 9.109 \\times 10^{-31} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 2.0 \\times 10^{-4} \\, \\mathrm{T}$, $L = 1.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 1.0 \\times 10^{-3} \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 5.0 \\times 10^{2} \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 1000.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (10.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-9} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-6} \\, \\mathrm{s}$.\n\nAlgorithmic objectives:\n- Implement the Boris pusher consistent with the above fields.\n- For each case, compute $\\Delta W$ in $\\mathrm{J}$ and the mechanism label as defined.\n- Aggregate the outputs in a single line as specified.",
            "solution": "The task is to simulate the trajectory of a non-relativistic test particle in a prescribed electromagnetic field configuration modeling magnetic reconnection and to analyze the particle's energy gain. The solution involves numerically integrating the equations of motion and calculating the work done by different components of the electric field.\n\nThe fundamental equation governing the particle's motion is the Lorentz force law:\n$$\nm \\frac{d\\mathbf{v}}{dt} = q \\left( \\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}) + \\mathbf{v} \\times \\mathbf{B}(\\mathbf{r}) \\right)\n$$\nwhere $m$ is the particle mass, $q$ is its charge, $\\mathbf{v}$ is its velocity, and $\\mathbf{r}$ is its position. The position is updated according to:\n$$\n\\frac{d\\mathbf{r}}{dt} = \\mathbf{v}\n$$\n\nThe electromagnetic fields are defined as follows. The magnetic field, $\\mathbf{B}$, consists of a reversing component in the $\\hat{\\mathbf{x}}$ direction and a uniform guide field in the $\\hat{\\mathbf{z}}$ direction:\n$$\n\\mathbf{B}(\\mathbf{r}) = B_0 \\tanh(y/L) \\, \\hat{\\mathbf{x}} + B_g \\, \\hat{\\mathbf{z}}\n$$\nHere, $B_0$ is the reconnecting field strength, $L$ is the half-thickness of the current sheet, $y$ is the coordinate across the sheet, and $B_g$ is the guide field strength.\n\nThe total electric field, $\\mathbf{E}_{\\mathrm{tot}}$, is the sum of a uniform reconnection electric field, $\\mathbf{E}_{\\mathrm{rec}}$, and a motional electric field, $\\mathbf{E}_{\\mathrm{m}}$, generated by plasma inflow.\nThe reconnection electric field is given by:\n$$\n\\mathbf{E}_{\\mathrm{rec}} = E_0 \\, \\hat{\\mathbf{z}}\n$$\nwhere $E_0$ is a constant. The motional field is induced by plasma flowing with velocity $\\mathbf{V}_{\\mathrm{in}} = -V_{\\mathrm{in}} \\hat{\\mathbf{y}}$ across the magnetic field:\n$$\n\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = - \\mathbf{V}_{\\mathrm{in}} \\times \\mathbf{B}(\\mathbf{r}) = -(-V_{\\mathrm{in}} \\hat{\\mathbf{y}}) \\times \\left(B_0 \\tanh(y/L) \\hat{\\mathbf{x}} + B_g \\hat{\\mathbf{z}}\\right)\n$$\nEvaluating the cross product yields:\n$$\n\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = V_{\\mathrm{in}} B_g \\hat{\\mathbf{x}} - V_{\\mathrm{in}} B_0 \\tanh(y/L) \\hat{\\mathbf{z}}\n$$\nThe total electric field is therefore:\n$$\n\\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}) = \\mathbf{E}_{\\mathrm{rec}} + \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = (V_{\\mathrm{in}} B_g) \\hat{\\mathbf{x}} + \\left(E_0 - V_{\\mathrm{in}} B_0 \\tanh(y/L)\\right) \\hat{\\mathbf{z}}\n$$\n\nThe kinetic energy of the particle is $W = \\frac{1}{2} m |\\mathbf{v}|^2$. The rate of change of kinetic energy is given by the power delivered by the electric field:\n$$\n\\frac{dW}{dt} = q \\mathbf{E}_{\\mathrm{tot}} \\cdot \\mathbf{v}\n$$\nThe total change in kinetic energy, $\\Delta W$, over the integration time $T$ is the integral of this power. We decompose this change into contributions from the reconnection field, $\\Delta W_{\\mathrm{rec}}$, and the motional field, $\\Delta W_{\\mathrm{m}}$:\n$$\n\\Delta W_{\\mathrm{rec}} = \\int_0^T q \\, \\mathbf{E}_{\\mathrm{rec}} \\cdot \\mathbf{v}(t) \\, dt\n$$\n$$\n\\Delta W_{\\mathrm{m}} = \\int_0^T q \\, \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}(t)) \\cdot \\mathbf{v}(t) \\, dt\n$$\nThe dominant acceleration mechanism is determined by comparing the absolute magnitudes $|\\Delta W_{\\mathrm{rec}}|$ and $|\\Delta W_{\\mathrm{m}}|$. If $|\\Delta W_{\\mathrm{rec}}| \\ge |\\Delta W_{\\mathrm{m}}|$, the mechanism is labeled $0$; otherwise, it is labeled $1$.\n\nThe equations of motion are integrated numerically using the Boris algorithm, a second-order accurate and symplectic integrator well-suited for charged particle dynamics. The algorithm staggers velocity and position in time, with position $\\mathbf{r}^n$ evaluated at integer time steps $t_n = n \\, dt$ and velocity $\\mathbf{v}^{n-1/2}$ at half steps $t_{n-1/2} = (n-1/2) \\, dt$.\n\nThe integration procedure for a single time step from $t_n$ to $t_{n+1}$ is:\n1.  **Initial velocity adjustment**: Given initial conditions $\\mathbf{r}^0$ and $\\mathbf{v}^0$ at $t=0$, the velocity is first \"kicked back\" by half a time step to obtain $\\mathbf{v}^{-1/2}$, which is required to start the leapfrog integration:\n    $$\n    \\mathbf{v}^{-1/2} = \\mathbf{v}^0 - \\frac{1}{2} dt \\frac{q}{m} \\left( \\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}^0) + \\mathbf{v}^0 \\times \\mathbf{B}(\\mathbf{r}^0) \\right)\n    $$\n2.  **Main loop**: For each step $n=0, 1, \\dots, N-1$ where $N = T/dt$:\n    a. The electric and magnetic fields, $\\mathbf{E}_{\\mathrm{tot}}^n$ and $\\mathbf{B}^n$, are evaluated at the current position $\\mathbf{r}^n$.\n    b. A velocity $\\mathbf{v}^-$ is calculated by applying the first half of the electric acceleration to $\\mathbf{v}^{n-1/2}$:\n       $$\n       \\mathbf{v}^- = \\mathbf{v}^{n-1/2} + \\frac{q \\mathbf{E}_{\\mathrm{tot}}^n}{m} \\frac{dt}{2}\n       $$\n    c. The magnetic field rotation is applied to $\\mathbf{v}^-$. This involves defining intermediate vectors $\\mathbf{t} = \\frac{q \\mathbf{B}^n}{m} \\frac{dt}{2}$ and $\\mathbf{s} = \\frac{2\\mathbf{t}}{1 + |\\mathbf{t}|^2}$:\n       $$\n       \\mathbf{v}' = \\mathbf{v}^- + \\mathbf{v}^- \\times \\mathbf{t}\n       $$\n       $$\n       \\mathbf{v}^+ = \\mathbf{v}^- + \\mathbf{v}' \\times \\mathbf{s}\n       $$\n    d. The second half of the electric acceleration is applied to obtain the velocity at the next half step, $\\mathbf{v}^{n+1/2}$:\n       $$\n       \\mathbf{v}^{n+1/2} = \\mathbf{v}^+ + \\frac{q \\mathbf{E}_{\\mathrm{tot}}^n}{m} \\frac{dt}{2}\n       $$\n    e. The new position $\\mathbf{r}^{n+1}$ is calculated:\n       $$\n       \\mathbf{r}^{n+1} = \\mathbf{r}^n + \\mathbf{v}^{n+1/2} dt\n       $$\n    f. The work done during the interval $[t_n, t_{n+1}]$ by each electric field component is approximated and accumulated. The velocity $\\mathbf{v}^{n+1/2}$ is the average velocity over the interval, suitable for a midpoint rule quadrature:\n       $$\n       \\delta W_{\\mathrm{rec}}^n = q \\left( \\mathbf{E}_{\\mathrm{rec}} \\cdot \\mathbf{v}^{n+1/2} \\right) dt\n       $$\n       $$\n       \\delta W_{\\mathrm{m}}^n = q \\left( \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}^n) \\cdot \\mathbf{v}^{n+1/2} \\right) dt\n       $$\n       $\\Delta W_{\\mathrm{rec}}$ and $\\Delta W_{\\mathrm{m}}$ are updated by adding these increments.\n\n3.  **Finalization**: After $N$ steps, the final velocity at time $T$, $\\mathbf{v}^N$, is computed by a final half-step acceleration from $\\mathbf{v}^{N-1/2}$:\n    $$\n    \\mathbf{v}^N = \\mathbf{v}^{N-1/2} + \\frac{q \\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}^N)}{m} \\frac{dt}{2}\n    $$\n    The total kinetic energy gain is $\\Delta W = W_{\\mathrm{final}} - W_{\\mathrm{initial}} = \\frac{1}{2}m|\\mathbf{v}^N|^2 - \\frac{1}{2}m|\\mathbf{v}^0|^2$. This value of $\\Delta W$ serves as a check for the numerical integration, as it should equal $\\Delta W_{\\mathrm{rec}} + \\Delta W_{\\mathrm{m}}$.\n\nThis procedure is implemented for each test case to compute the required values $[\\Delta W, \\mathrm{label}]$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the test-particle motion problem for several magnetic reconnection scenarios.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: electron, direct reconnection electric field dominant expected\n        {\n            'q': 1.602e-19, 'm': 9.109e-31, 'B0': 1.0e-4, 'Bg': 0.0, 'L': 1.0e3,\n            'E0': 1.0e-3, 'Vin': 0.0, 'r0': (0.0, 0.0, 0.0), 'v0': (0.0, 0.0, 100.0),\n            'dt': 1.0e-9, 'T': 5.0e-6\n        },\n        # Case 2: electron, motional field dominant expected\n        {\n            'q': 1.602e-19, 'm': 9.109e-31, 'B0': 1.0e-4, 'Bg': 5.0e-5, 'L': 1.0e3,\n            'E0': 0.0, 'Vin': 2.0e3, 'r0': (0.0, 100.0, 0.0), 'v0': (0.0, 0.0, 0.0),\n            'dt': 1.0e-9, 'T': 5.0e-6\n        },\n        # Case 3: proton, mixed fields\n        {\n            'q': 1.602e-19, 'm': 1.673e-27, 'B0': 1.0e-4, 'Bg': 1.0e-4, 'L': 2.0e3,\n            'E0': 5.0e-4, 'Vin': 3.0e3, 'r0': (0.0, 200.0, 0.0), 'v0': (0.0, 0.0, 50.0),\n            'dt': 1.0e-7, 'T': 5.0e-5\n        },\n        # Case 4: electron, boundary condition far from neutral line\n        {\n            'q': 1.602e-19, 'm': 9.109e-31, 'B0': 1.0e-4, 'Bg': 2.0e-4, 'L': 1.0e3,\n            'E0': 1.0e-3, 'Vin': 5.0e2, 'r0': (0.0, 1000.0, 0.0), 'v0': (10.0, 0.0, 0.0),\n            'dt': 1.0e-9, 'T': 5.0e-6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format output as a list of lists with no spaces\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef run_simulation(q, m, B0, Bg, L, E0, Vin, r0, v0, dt, T):\n    \"\"\"\n    Integrates particle trajectory using Boris pusher and calculates energy gain.\n    \"\"\"\n    r = np.array(r0, dtype=float)\n    v = np.array(v0, dtype=float)\n    \n    num_steps = int(round(T / dt))\n\n    w_initial = 0.5 * m * np.dot(v, v)\n    dw_rec_total = 0.0\n    dw_m_total = 0.0\n\n    # Field calculation function\n    def get_fields(pos):\n        y = pos[1]\n        tanh_yL = np.tanh(y / L)\n        \n        B = np.array([B0 * tanh_yL, 0.0, Bg])\n        \n        E_rec = np.array([0.0, 0.0, E0])\n        \n        E_m = np.array([Vin * Bg, 0.0, -Vin * B0 * tanh_yL])\n        \n        E_tot = E_rec + E_m\n        \n        return B, E_rec, E_m, E_tot\n\n    # Initial half-step kick-back for velocity to start the leapfrog\n    B_init, _, _, E_init = get_fields(r)\n    a_init = (q / m) * (E_init + np.cross(v, B_init))\n    v = v - 0.5 * dt * a_init\n\n    # Main integration loop\n    for _ in range(num_steps):\n        B, E_rec, E_m, E_tot = get_fields(r)\n\n        # Boris algorithm\n        # 1. Electric field half-acceleration\n        v_minus = v + (q * E_tot / m) * (dt / 2.0)\n\n        # 2. Magnetic field rotation\n        t = (q * B / m) * (dt / 2.0)\n        t_mag_sq = np.dot(t, t)\n        s = 2.0 * t / (1.0 + t_mag_sq) if (1.0 + t_mag_sq) != 1.0 else 2.0 * t\n        \n        v_prime = v_minus + np.cross(v_minus, t)\n        v_plus = v_minus + np.cross(v_prime, s)\n\n        # 3. Second electric field half-acceleration\n        v_plus_half = v_plus + (q * E_tot / m) * (dt / 2.0)\n\n        # Accumulate work done by E-field components\n        dw_rec = q * np.dot(E_rec, v_plus_half) * dt\n        dw_m = q * np.dot(E_m, v_plus_half) * dt\n        dw_rec_total += dw_rec\n        dw_m_total += dw_m\n\n        # Update velocity and position for next step\n        v = v_plus_half\n        r = r + v * dt\n\n    # Final half-step to get velocity at the final integer time step\n    _, _, _, E_final = get_fields(r)\n    v_final = v + (q * E_final / m) * (dt / 2.0)\n\n    w_final = 0.5 * m * np.dot(v_final, v_final)\n    delta_w = w_final - w_initial\n\n    # Determine dominant mechanism\n    if abs(dw_rec_total) >= abs(dw_m_total):\n        label = 0\n    else:\n        label = 1\n\n    return [delta_w, label]\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}