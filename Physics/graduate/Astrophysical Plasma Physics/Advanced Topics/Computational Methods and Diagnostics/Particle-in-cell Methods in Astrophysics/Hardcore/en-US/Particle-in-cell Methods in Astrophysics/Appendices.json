{
    "hands_on_practices": [
        {
            "introduction": "The heart of the Particle-In-Cell method is the interplay between discrete particles and a continuous grid. A crucial step is charge deposition, where the charge of individual \"macro-particles\" is distributed onto the surrounding grid nodes. This exercise guides you through deriving the weighting functions for the common Cloud-In-Cell (CIC) scheme, providing a foundational understanding of how particle properties are mapped to the grid fields. ",
            "id": "4222896",
            "problem": "Consider a one-dimensional, electrostatic Particle-In-Cell (PIC) simulation of an astrophysical pair plasma on a uniform grid with cell centers at positions $x_i = i\\,\\Delta x$, where $\\Delta x$ is the grid spacing and $i$ is an integer. A particle of charge $q$ is located strictly between two adjacent cell centers at $x_i$ (left) and $x_{i+1}$ (right). Let the particle’s local coordinate, measured from the left cell center, be $x \\in [0, \\Delta x]$, so that its absolute position is $x_p = x_i + x$ and the distance to the right center is $\\Delta x - x$.\n\nIn a Cloud-In-Cell (CIC) deposition scheme, the charge assignment to grid points is determined by the convolution of the Nearest-Grid-Point (NGP) shape function with itself. The NGP shape function $S_0(x)$ is defined as $S_0(x) = 1$ for $|x| \\le \\Delta x/2$ and $S_0(x) = 0$ otherwise. The CIC shape function $S_1(x)$ is defined as the convolution $S_1 = S_0 * S_0$, properly normalized so that $S_1(x)$ has compact support of width $2\\,\\Delta x$ and is consistent with charge conservation in deposition to the grid.\n\nStarting from these definitions and the requirement of local charge conservation under deposition (i.e., the sum of weights to the left and right centers equals $1$ for a particle located between them), derive the Cloud-In-Cell weights $w_L$ and $w_R$ assigned to the left and right cell centers, respectively, as functions of the local coordinate $x$ and the grid spacing $\\Delta x$. Then write the deposited charges $Q_L$ and $Q_R$ at the left and right centers, respectively, in terms of $q$, $x$, and $\\Delta x$.\n\nExpress your final answer as a single row matrix containing the four quantities $\\{w_L, w_R, Q_L, Q_R\\}$ in closed form. No numerical evaluation is required.",
            "solution": "The problem statement will be validated first against the established criteria.\n\n### Step 1: Extract Givens\n- **System**: A one-dimensional, electrostatic Particle-In-Cell (PIC) simulation of an astrophysical pair plasma.\n- **Grid**: A uniform grid with cell centers at positions $x_i = i\\,\\Delta x$, where $\\Delta x$ is the grid spacing and $i$ is an integer.\n- **Particle**: A single particle of charge $q$.\n- **Particle Position**: The particle is located at an absolute position $x_p = x_i + x$, where $x_i$ is the position of the left cell center, $x_{i+1}$ is the position of the right cell center, and $x$ is the local coordinate measured from the left cell center, with $x \\in [0, \\Delta x]$.\n- **Nearest-Grid-Point (NGP) Shape Function**: $S_0(x)$ is defined as $S_0(x) = 1$ for $|x| \\le \\Delta x/2$ and $S_0(x) = 0$ otherwise.\n- **Cloud-In-Cell (CIC) Shape Function**: $S_1(x)$ is defined as the convolution $S_1 = S_0 * S_0$, normalized appropriately.\n- **Constraint**: Local charge conservation requires that the sum of weights assigned to the left and right cell centers is unity: $w_L + w_R = 1$.\n- **Objective**: Derive the CIC weights $w_L$ and $w_R$ for the left and right cell centers, and the corresponding deposited charges $Q_L$ and $Q_R$, as functions of $q$, $x$, and $\\Delta x$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the Cloud-In-Cell (CIC) or first-order charge deposition scheme, which is a fundamental and standard technique in computational plasma physics and astrophysics, particularly in PIC simulations. The definition of the CIC shape function as the convolution of two NGP (zeroth-order) shape functions is standard textbook material. The problem is firmly grounded in established principles of computational physics.\n- **Well-Posed**: The problem is clearly stated, with all necessary definitions and constraints provided. The definitions of the shape functions and the conservation constraint lead to a unique and meaningful solution for the weights and deposited charges.\n- **Objective**: The problem is stated in precise, formal, and unbiased scientific language.\n- **Other Flaws**: The problem is not scientifically unsound, incomplete, contradictory, or ill-posed. It is a standard derivation problem in the specified field.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe Cloud-In-Cell (CIC) scheme, also known as the first-order scheme ($p=1$), uses a shape function $S_1(y)$ which can be derived from the convolution of the Nearest-Grid-Point (NGP) or zeroth-order shape function, $S_0(y)$, with itself. The NGP shape function is a rectangular or \"top-hat\" function centered at the origin:\n$$\nS_0(y) = \n\\begin{cases} \n1  \\text{if } |y| \\le \\frac{\\Delta x}{2} \\\\\n0  \\text{if } |y|  \\frac{\\Delta x}{2}\n\\end{cases}\n$$\nThe convolution to obtain the unnormalized CIC shape function, which we denote $S_{1,u}(y)$, is given by:\n$$\nS_{1,u}(y) = (S_0 * S_0)(y) = \\int_{-\\infty}^{\\infty} S_0(z) S_0(y-z) dz\n$$\nThe integrand is non-zero only when both $S_0(z)$ and $S_0(y-z)$ are non-zero. This requires $|z| \\le \\frac{\\Delta x}{2}$ and $|y-z| \\le \\frac{\\Delta x}{2}$. The second condition is equivalent to $y - \\frac{\\Delta x}{2} \\le z \\le y + \\frac{\\Delta x}{2}$. Therefore, the integral is non-zero only for $z$ in the intersection of the intervals $[-\\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$ and $[y - \\frac{\\Delta x}{2}, y + \\frac{\\Delta x}{2}]$. The integral's value is the length of this intersection region.\n\nWe analyze the overlap for different ranges of $y$:\n1.  For $|y| \\ge \\Delta x$, there is no overlap between the two intervals. Thus, $S_{1,u}(y) = 0$.\n2.  For $0 \\le y  \\Delta x$, the intersection interval for $z$ is $[y - \\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$. The length of this interval is $\\frac{\\Delta x}{2} - (y - \\frac{\\Delta x}{2}) = \\Delta x - y$. So, $S_{1,u}(y) = \\Delta x - y$.\n3.  For $-\\Delta x  y  0$, the intersection interval for $z$ is $[-\\frac{\\Delta x}{2}, y + \\frac{\\Delta x}{2}]$. The length of this interval is $(y + \\frac{\\Delta x}{2}) - (-\\frac{\\Delta x}{2}) = y + \\Delta x$. So, $S_{1,u}(y) = y + \\Delta x$.\n\nCombining these results, we can write the unnormalized CIC shape function as a single expression:\n$$\nS_{1,u}(y) = \n\\begin{cases} \n\\Delta x - |y|  \\text{if } |y| \\le \\Delta x \\\\\n0  \\text{if } |y|  \\Delta x\n\\end{cases}\n$$\nThis is a triangular function with support over $[- \\Delta x, \\Delta x]$, a base of width $2\\Delta x$, and a peak value of $\\Delta x$ at $y=0$.\n\nFor charge-conserving deposition schemes, the shape function must satisfy the partition of unity property, meaning the sum of its values at a particle's position, evaluated relative to all interacting grid points, must equal $1$. A particle at position $x_p = x_i + x$ with $x \\in [0, \\Delta x]$ interacts only with grid points $x_i$ and $x_{i+1}$. The sum of the unnormalized shape functions is:\n$$\nS_{1,u}(x_p - x_i) + S_{1,u}(x_p - x_{i+1}) = S_{1,u}(x) + S_{1,u}(x - \\Delta x)\n$$\nUsing our derived expression for $S_{1,u}(y)$:\n- Since $x \\in [0, \\Delta x]$, we have $S_{1,u}(x) = \\Delta x - x$.\n- Since $x - \\Delta x \\in [-\\Delta x, 0]$, we have $S_{1,u}(x - \\Delta x) = (x - \\Delta x) + \\Delta x = x$.\nThe sum is $(\\Delta x - x) + x = \\Delta x$. To satisfy the partition of unity, we must normalize the shape function by dividing by this sum, $\\Delta x$. The normalized CIC shape function, let's call it $W(y)$, is:\n$$\nW(y) = \\frac{S_{1,u}(y)}{\\Delta x} = \n\\begin{cases} \n1 - \\frac{|y|}{\\Delta x}  \\text{if } |y| \\le \\Delta x \\\\\n0  \\text{if } |y|  \\Delta x\n\\end{cases}\n$$\nThe weights $w_L$ and $w_R$ are the values of this normalized shape function evaluated at the particle's position relative to the left and right grid centers, respectively.\n\nThe particle is at an absolute position $x_p = x_i + x$, where $x \\in [0, \\Delta x]$ is the local coordinate relative to the left grid center $x_i$.\nThe weight assigned to the left grid center $x_i$ is $w_L$:\n$$\nw_L = W(x_p - x_i) = W(x)\n$$\nSince $x \\ge 0$, $|x| = x$. Therefore,\n$$\nw_L = 1 - \\frac{x}{\\Delta x}\n$$\nThe weight assigned to the right grid center $x_{i+1} = x_i + \\Delta x$ is $w_R$:\n$$\nw_R = W(x_p - x_{i+1}) = W(x - \\Delta x)\n$$\nSince $x \\in [0, \\Delta x]$, the argument $y = x - \\Delta x$ is in the range $[-\\Delta x, 0]$. Thus, $|y| = |x - \\Delta x| = -(x - \\Delta x) = \\Delta x - x$. Therefore,\n$$\nw_R = 1 - \\frac{|x-\\Delta x|}{\\Delta x} = 1 - \\frac{\\Delta x - x}{\\Delta x} = 1 - \\left(1 - \\frac{x}{\\Delta x}\\right) = \\frac{x}{\\Delta x}\n$$\nWe can verify the charge conservation constraint: $w_L + w_R = (1 - \\frac{x}{\\Delta x}) + \\frac{x}{\\Delta x} = 1$. This is consistent.\n\nThe deposited charges $Q_L$ and $Q_R$ at the left and right cell centers are the particle's charge $q$ multiplied by the respective weights:\nThe charge deposited at the left center $x_i$ is:\n$$\nQ_L = q \\cdot w_L = q \\left(1 - \\frac{x}{\\Delta x}\\right)\n$$\nThe charge deposited at the right center $x_{i+1}$ is:\n$$\nQ_R = q \\cdot w_R = q \\frac{x}{\\Delta x}\n$$\nThe final answer requires these four quantities—$w_L$, $w_R$, $Q_L$, $Q_R$—in a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 - \\frac{x}{\\Delta x}  \\frac{x}{\\Delta x}  q \\left(1 - \\frac{x}{\\Delta x}\\right)  q \\frac{x}{\\Delta x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A successful simulation must be designed to resolve the essential physical processes of the system under study. This involves a careful choice of grid spacing and time step based on the characteristic length and time scales of the plasma. This practice connects fundamental plasma physics to simulation design by having you derive the ion cyclotron frequency, $\\omega_{ci}$, and inertial length, $d_i$, which govern ion dynamics in magnetized shocks. ",
            "id": "4222899",
            "problem": "A Particle-In-Cell (PIC) simulation of a collisionless, magnetized interstellar shock must resolve ion-scale dynamics to capture gyro-motion and Hall-mediated dispersion. Consider a uniform upstream plasma composed of singly ionized hydrogen ions with charge magnitude $e$ and mass $m_i$. The upstream magnetic field is $B_0$, and the ion number density is $n$. To choose a grid spacing and a timestep that resolve ion-scale physics, you must first determine the characteristic ion cyclotron frequency and the ion inertial length from first principles.\n\nStarting only from the Newton–Lorentz equation, Maxwell’s equations, and the definition of number density, perform the following:\n\n1. Derive the expression for the ion cyclotron angular frequency $\\,\\omega_{ci}\\,$ for nonrelativistic ions gyrating in a uniform magnetic field $\\,B_0\\,$ with no electric field. State clearly any assumptions needed to reduce the equations to a uniform circular motion with a well-defined angular frequency.\n\n2. Derive the expression for the cold-ion plasma angular frequency $\\,\\omega_{pi}\\,$ for small-amplitude longitudinal oscillations in a quasi-neutral plasma with a fixed, neutralizing electron background. Use the ion equation of motion and Gauss’s law to obtain a closed equation for the ion displacement, and identify $\\,\\omega_{pi}\\,$. Then, using Maxwell’s equations, show how the electromagnetic skin depth associated with ion inertia yields a characteristic length scale $\\,d_i\\,$ and express it in terms of $\\,\\omega_{pi}\\,$ and $\\,c\\,$.\n\n3. Using your derived expressions, evaluate numerically $\\,\\omega_{ci}\\,$ and $\\,d_i\\,$ for the following upstream parameters representative of the diffuse interstellar medium:\n- $B_0 = 5\\,\\mu\\text{G}$,\n- $n = 1\\,\\text{cm}^{-3}$,\n- $m_i = m_p$ (proton mass).\n\nUse the constants $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$, $m_p = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$, $c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$, and $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$. Convert $\\,\\mu\\text{G}\\,$ to tesla and $\\,\\text{cm}^{-3}\\,$ to $\\,\\text{m}^{-3}\\,$ before computing. Express $\\,\\omega_{ci}\\,$ in $\\text{rad}\\,\\text{s}^{-1}$ and $\\,d_i\\,$ in $\\text{km}$. Round your answers to three significant figures.\n\nProvide your final answer as a single row vector $\\big[\\omega_{ci},\\, d_i\\big]$.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All necessary information is provided, and the requested tasks are standard derivations and calculations in plasma physics. I will proceed with the solution.\n\nThe solution is divided into three parts as requested by the problem statement.\n\n### Part 1: Derivation of the Ion Cyclotron Angular Frequency ($\\omega_{ci}$)\n\nWe begin with the Newton–Lorentz equation for a single ion of charge $q$ and mass $m_i$ moving with velocity $\\vec{v}$ in electric field $\\vec{E}$ and magnetic field $\\vec{B}$:\n$$\nm_i \\frac{d\\vec{v}}{dt} = q(\\vec{E} + \\vec{v} \\times \\vec{B})\n$$\nThe problem considers a singly ionized hydrogen ion, so its charge is $q = +e$. It specifies a uniform magnetic field $\\vec{B} = \\vec{B}_0$ and no electric field, $\\vec{E} = 0$. The equation of motion simplifies to:\n$$\nm_i \\frac{d\\vec{v}}{dt} = e(\\vec{v} \\times \\vec{B}_0)\n$$\nLet us align the coordinate system such that the magnetic field is along the $z$-axis, i.e., $\\vec{B}_0 = B_0 \\hat{k}$. The velocity vector is $\\vec{v} = v_x \\hat{i} + v_y \\hat{j} + v_z \\hat{k}$. The cross product is:\n$$\n\\vec{v} \\times \\vec{B}_0 = (v_x \\hat{i} + v_y \\hat{j} + v_z \\hat{k}) \\times (B_0 \\hat{k}) = v_x B_0 (\\hat{i} \\times \\hat{k}) + v_y B_0 (\\hat{j} \\times \\hat{k}) = -v_x B_0 \\hat{j} + v_y B_0 \\hat{i}\n$$\nWriting the equation of motion in components:\n\\begin{align*}\nm_i \\frac{dv_x}{dt} = e v_y B_0 \\quad (1) \\\\\nm_i \\frac{dv_y}{dt} = -e v_x B_0 \\quad (2) \\\\\nm_i \\frac{dv_z}{dt} = 0 \\quad (3)\n\\end{align*}\nEquation $(3)$ implies that $v_z$ is constant. The motion parallel to the magnetic field is unaffected.\n\nTo solve the coupled equations for the perpendicular motion, we differentiate equation $(1)$ with respect to time:\n$$\nm_i \\frac{d^2v_x}{dt^2} = e B_0 \\frac{dv_y}{dt}\n$$\nSubstituting $\\frac{dv_y}{dt}$ from equation $(2)$:\n$$\nm_i \\frac{d^2v_x}{dt^2} = e B_0 \\left(-\\frac{e v_x B_0}{m_i}\\right) = -\\frac{e^2 B_0^2}{m_i} v_x\n$$\nRearranging this equation gives the standard form of a simple harmonic oscillator:\n$$\n\\frac{d^2v_x}{dt^2} + \\left(\\frac{e B_0}{m_i}\\right)^2 v_x = 0\n$$\nThe angular frequency of this oscillation is identified as the ion cyclotron angular frequency, $\\omega_{ci}$:\n$$\n\\omega_{ci} = \\frac{e B_0}{m_i}\n$$\nThe problem specifies the charge magnitude $e$, but for a positively charged ion, we use $+e$.\n\nThe assumptions required for this derivation, particularly to obtain uniform circular motion, are:\n1.  The magnetic field $\\vec{B}_0$ is uniform in space and constant in time.\n2.  There are no other forces, such as electric fields or collisions, acting on the ion.\n3.  The ion's motion is non-relativistic ($|\\vec{v}| \\ll c$), so its mass $m_i$ is treated as constant.\n4.  For the trajectory to be a circle (uniform circular motion) rather than a helix, the initial velocity component parallel to the magnetic field must be zero, i.e., $v_z(t=0) = 0$.\n\n### Part 2: Derivation of the Ion Plasma Angular Frequency ($\\omega_{pi}$) and Inertial Length ($d_i$)\n\nFirst, we derive the expression for $\\omega_{pi}$. We consider small-amplitude longitudinal oscillations in a one-dimensional plasma. The background electrons are assumed to be fixed, providing a uniform neutralizing charge density.\nIn equilibrium, the ion density is $n_{i0} = n$ and the electron density is $n_{e0} = n$. Let the ions at an equilibrium position $x_0$ be displaced by a small amount $\\xi(x_0, t)$. The linearized equation of motion for an ion is:\n$$\nm_i \\frac{\\partial^2 \\xi}{\\partial t^2} = e E\n$$\nwhere $E$ is the self-consistent electric field produced by the charge separation.\n\nThe ion number density is perturbed to $n_i = n_{i0} + n_{i1}$. The linearized ion continuity equation is:\n$$\n\\frac{\\partial n_{i1}}{\\partial t} + n_{i0} \\frac{\\partial v_i}{\\partial x} = 0\n$$\nWith $v_i = \\frac{\\partial \\xi}{\\partial t}$ and $n_{i0}=n$, we have $\\frac{\\partial n_{i1}}{\\partial t} = -n \\frac{\\partial^2 \\xi}{\\partial x \\partial t}$. Integrating with respect to time yields the perturbation in ion density:\n$$\nn_{i1} = -n \\frac{\\partial \\xi}{\\partial x}\n$$\nThe local net charge density is $\\rho = e(n_i - n_e) = e((n+n_{i1}) - n) = e n_{i1}$. Using the expression for $n_{i1}$:\n$$\n\\rho = -ne \\frac{\\partial \\xi}{\\partial x}\n$$\nGauss's law in one dimension is $\\frac{\\partial E}{\\partial x} = \\frac{\\rho}{\\varepsilon_0}$. Substituting $\\rho$:\n$$\n\\frac{\\partial E}{\\partial x} = -\\frac{ne}{\\varepsilon_0} \\frac{\\partial \\xi}{\\partial x}\n$$\nIntegrating with respect to $x$ (and assuming $E=0$ when $\\xi=0$) gives the electric field:\n$$\nE = -\\frac{ne}{\\varepsilon_0} \\xi\n$$\nSubstituting this electric field back into the ion equation of motion:\n$$\nm_i \\frac{\\partial^2 \\xi}{\\partial t^2} = e \\left(-\\frac{ne}{\\varepsilon_0} \\xi\\right) = -\\frac{ne^2}{\\varepsilon_0} \\xi\n$$\nThis can be written as:\n$$\n\\frac{\\partial^2 \\xi}{\\partial t^2} + \\frac{ne^2}{m_i \\varepsilon_0} \\xi = 0\n$$\nThis is the equation for simple harmonic motion. The square of the angular frequency is the coefficient of the $\\xi$ term. This defines the ion plasma angular frequency, $\\omega_{pi}$:\n$$\n\\omega_{pi}^2 = \\frac{ne^2}{m_i \\varepsilon_0} \\implies \\omega_{pi} = \\sqrt{\\frac{ne^2}{m_i \\varepsilon_0}}\n$$\n\nNext, we derive the ion inertial length $d_i$. This length scale arises from considering the screening of electromagnetic fields by the inertia of the charge carriers. From Maxwell's equations, the general wave equation in a medium with current density $\\vec{J}$ is:\n$$\n\\nabla \\times (\\nabla \\times \\vec{E}) = -\\mu_0 \\frac{\\partial \\vec{J}}{\\partial t} - \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\nUsing the vector identity $\\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E}$ and considering a transverse wave where $\\nabla \\cdot \\vec{E} = 0$, this simplifies to:\n$$\n\\nabla^2 \\vec{E} = \\mu_0 \\frac{\\partial \\vec{J}}{\\partial t} + \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\nThe current is due to the ion motion, $\\vec{J} = \\vec{J}_i = n e \\vec{v}_i$. The linearized ion momentum equation is $m_i \\frac{\\partial \\vec{v}_i}{\\partial t} = e \\vec{E}$. The rate of change of current density is:\n$$\n\\frac{\\partial \\vec{J}_i}{\\partial t} = n e \\frac{\\partial \\vec{v}_i}{\\partial t} = \\frac{ne^2}{m_i} \\vec{E} = \\varepsilon_0 \\omega_{pi}^2 \\vec{E}\n$$\nSubstituting this into the wave equation gives:\n$$\n\\nabla^2 \\vec{E} = \\mu_0 (\\varepsilon_0 \\omega_{pi}^2 \\vec{E}) + \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\nUsing the relation $c^2=1/(\\mu_0 \\varepsilon_0)$, this becomes:\n$$\n\\nabla^2 \\vec{E} - \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2} = \\frac{\\omega_{pi}^2}{c^2} \\vec{E}\n$$\nThe skin depth is the characteristic length scale for the penetration of a static or very low-frequency field into the plasma. In the limit $\\frac{\\partial}{\\partial t} \\to 0$, the equation becomes:\n$$\n\\nabla^2 \\vec{E} = \\frac{\\omega_{pi}^2}{c^2} \\vec{E}\n$$\nFor a one-dimensional problem, $\\frac{d^2 E}{dx^2} = \\frac{1}{(c/\\omega_{pi})^2} E$. The solution has the form $E(x) = E_0 \\exp(-x / \\lambda)$, where the decay length (skin depth) is $\\lambda = c/\\omega_{pi}$. This characteristic length scale is defined as the ion inertial length, $d_i$.\n$$\nd_i = \\frac{c}{\\omega_{pi}}\n$$\n\n### Part 3: Numerical Evaluation\n\nWe are given the following parameters and constants:\n- $B_0 = 5\\,\\mu\\text{G} = 5 \\times 10^{-6}\\,\\text{G} \\times (10^{-4}\\,\\text{T}/\\text{G}) = 5 \\times 10^{-10}\\,\\text{T}$\n- $n = 1\\,\\text{cm}^{-3} = 1\\,\\text{cm}^{-3} \\times (100\\,\\text{cm}/\\text{m})^3 = 10^6\\,\\text{m}^{-3}$\n- $m_i = m_p = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$\n- $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n- $c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$\n\nFirst, we calculate the ion cyclotron frequency $\\omega_{ci}$:\n$$\n\\omega_{ci} = \\frac{e B_0}{m_p} = \\frac{(1.602176634 \\times 10^{-19}\\,\\text{C}) (5 \\times 10^{-10}\\,\\text{T})}{1.67262192369 \\times 10^{-27}\\,\\text{kg}}\n$$\n$$\n\\omega_{ci} \\approx 0.047895\\,\\text{rad}\\,\\text{s}^{-1}\n$$\nRounding to three significant figures, we get $\\omega_{ci} = 0.0479\\,\\text{rad}\\,\\text{s}^{-1}$.\n\nNext, we calculate the ion inertial length $d_i$. We first need the ion plasma frequency $\\omega_{pi}$:\n$$\n\\omega_{pi}^2 = \\frac{n e^2}{m_p \\varepsilon_0} = \\frac{(10^6\\,\\text{m}^{-3}) (1.602176634 \\times 10^{-19}\\,\\text{C})^2}{(1.67262192369 \\times 10^{-27}\\,\\text{kg}) (8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1})}\n$$\n$$\n\\omega_{pi}^2 \\approx \\frac{2.56697 \\times 10^{-32}}{1.48074 \\times 10^{-38}} \\approx 1.73359 \\times 10^{6}\\,(\\text{rad}\\,\\text{s}^{-1})^2\n$$\n$$\n\\omega_{pi} = \\sqrt{1.73359 \\times 10^{6}} \\approx 1316.66\\,\\text{rad}\\,\\text{s}^{-1}\n$$\nNow we can compute the ion inertial length $d_i$:\n$$\nd_i = \\frac{c}{\\omega_{pi}} = \\frac{2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}}{1316.66\\,\\text{rad}\\,\\text{s}^{-1}} \\approx 227702\\,\\text{m}\n$$\nConverting to kilometers:\n$$\nd_i \\approx 227.702\\,\\text{km}\n$$\nRounding to three significant figures, we get $d_i = 228\\,\\text{km}$.\n\nThe final requested quantities are $\\omega_{ci} = 0.0479\\,\\text{rad}\\,\\text{s}^{-1}$ and $d_i = 228\\,\\text{km}$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0479  228 \\end{pmatrix} } $$"
        },
        {
            "introduction": "PIC simulations are inherently statistical, as they track a finite number of macro-particles to represent a much larger physical population. This discretization introduces statistical noise, which can obscure the physical signals you aim to study. This problem explores the relationship between the number of particles per cell, $N_p$, and the level of numerical noise, allowing you to estimate the computational resources required to achieve a desired level of accuracy. ",
            "id": "4222907",
            "problem": "Consider a one-dimensional, electrostatic, collisionless, uniform plasma with mean charge density $\\rho_{0}$ resolved by a Particle-In-Cell (PIC) method. The spatial grid has uniform spacing $\\Delta x$, and each cell initially contains $N_{p}$ identical macro-particles, each carrying charge $q_{p}$ chosen so that the mean charge per cell equals $\\rho_{0} \\Delta x$. The PIC charge deposition uses the first-order B-spline (cloud-in-cell) shape function, which assigns to any grid node the linearly weighted fraction of a particle’s charge based on its position within the adjacent cells. Assume the instantaneous positions of the macro-particles within each cell are independent and uniformly distributed over the cell.\n\nFocus on a single grid node that sits at the interface between two adjacent cells. The total charge assigned to this node at a given time step is the sum of contributions from the $2 N_{p}$ particles in the two adjacent cells, each contribution computed by the cloud-in-cell rule from the particle’s position. Using the central limit theorem and the independence of particle positions, derive the fractional root-mean-square error (standard deviation divided by mean) of the node’s deposited charge due to particle noise and, by enforcing that this fractional error does not exceed a prescribed target $\\epsilon$, obtain an exact analytic expression for the minimum number of particles per cell $N_{p}$ required.\n\nExpress your final answer as a single closed-form expression in terms of $\\epsilon$. No numerical approximation is required. If any physical units arise in intermediate steps, ensure they cancel so that the final expression is dimensionless. Do not introduce any shortcut formulas not derived from first principles of PIC deposition, probability for independent uniform samples, and the central limit theorem.",
            "solution": "The problem requires the derivation of the minimum number of particles per cell, $N_p$, needed to keep the fractional root-mean-square (RMS) error of the charge deposited on a grid node below a certain threshold $\\epsilon$. The derivation must be based on first principles of the Particle-In-Cell (PIC) method, specifically the cloud-in-cell (CIC) charge deposition scheme, and statistical analysis using the central limit theorem context.\n\nLet the one-dimensional grid have nodes at positions $x_j = j \\Delta x$, where $j$ is an integer and $\\Delta x$ is the uniform grid spacing. We focus on a single grid node, which we can place at the origin $x_j=0$ without loss of generality. This node is at the interface between two adjacent cells: Cell L covering the interval $[-\\Delta x, 0]$ and Cell R covering $[0, \\Delta x]$. Each cell contains $N_p$ macro-particles. Thus, a total of $2N_p$ particles from these two cells can contribute charge to the node at $x_j=0$.\n\nThe charge deposition uses the first-order B-spline, or cloud-in-cell (CIC), shape function $S(u)$. For a particle at position $x_p$ and a grid node at $x_j$, the fraction of the particle's charge assigned to the node is given by $S(x_p - x_j)$. The function $S(u)$ is a triangular function defined as:\n$$\nS(u) =\n\\begin{cases}\n    1 - \\frac{|u|}{\\Delta x}  \\text{if } |u| \\leq \\Delta x \\\\\n    0  \\text{if } |u|  \\Delta x\n\\end{cases}\n$$\nThe charge deposited at node $x_j$ by a single particle $k$ with charge $q_p$ at position $x_k$ is $Q_k = q_p S(x_k - x_j)$.\n\nThe problem states that the instantaneous particle positions are independent and uniformly distributed within their respective cells. Let's analyze the charge contribution from a single particle to the node at $x_j=0$.\n\nConsider a particle in Cell R, with position $x$ being a random variable uniformly distributed in $[0, \\Delta x]$. The probability density function is $p(x) = 1/\\Delta x$ for $x \\in [0, \\Delta x]$. The charge this particle contributes to the node at $x_j=0$ is a random variable $Q_{part}$:\n$$\nQ_{part}(x) = q_p S(x - 0) = q_p S(x) = q_p \\left(1 - \\frac{x}{\\Delta x}\\right)\n$$\nWe calculate the mean (expected value) $E[Q_{part}]$ of this contribution:\n$$\n\\mu_{part} = E[Q_{part}] = \\int_{0}^{\\Delta x} Q_{part}(x) p(x) dx = \\int_{0}^{\\Delta x} q_p \\left(1 - \\frac{x}{\\Delta x}\\right) \\frac{1}{\\Delta x} dx\n$$\n$$\n\\mu_{part} = \\frac{q_p}{\\Delta x} \\left[ x - \\frac{x^2}{2\\Delta x} \\right]_{0}^{\\Delta x} = \\frac{q_p}{\\Delta x} \\left( \\Delta x - \\frac{(\\Delta x)^2}{2\\Delta x} \\right) = \\frac{q_p}{2}\n$$\nNext, we calculate the variance $\\text{Var}(Q_{part}) = E[Q_{part}^2] - (E[Q_{part}])^2$. First, we find the mean of the square of the contribution:\n$$\nE[Q_{part}^2] = \\int_{0}^{\\Delta x} [Q_{part}(x)]^2 p(x) dx = \\int_{0}^{\\Delta x} q_p^2 \\left(1 - \\frac{x}{\\Delta x}\\right)^2 \\frac{1}{\\Delta x} dx\n$$\n$$\nE[Q_{part}^2] = \\frac{q_p^2}{\\Delta x} \\int_{0}^{\\Delta x} \\left(1 - \\frac{2x}{\\Delta x} + \\frac{x^2}{(\\Delta x)^2}\\right) dx = \\frac{q_p^2}{\\Delta x} \\left[ x - \\frac{x^2}{\\Delta x} + \\frac{x^3}{3(\\Delta x)^2} \\right]_{0}^{\\Delta x}\n$$\n$$\nE[Q_{part}^2] = \\frac{q_p^2}{\\Delta x} \\left( \\Delta x - \\Delta x + \\frac{\\Delta x}{3} \\right) = \\frac{q_p^2}{3}\n$$\nThe variance for a single particle's contribution is therefore:\n$$\n\\sigma_{part}^2 = \\text{Var}(Q_{part}) = E[Q_{part}^2] - \\mu_{part}^2 = \\frac{q_p^2}{3} - \\left(\\frac{q_p}{2}\\right)^2 = q_p^2 \\left(\\frac{1}{3} - \\frac{1}{4}\\right) = \\frac{q_p^2}{12}\n$$\nA particle in Cell L has a position $x$ uniformly distributed in $[-\\Delta x, 0]$. Its contribution to the node at $x_j=0$ is $Q_{part}(x) = q_p S(x) = q_p(1 - |x|/\\Delta x) = q_p(1 + x/\\Delta x)$. By symmetry, the calculation for the mean and variance yields the same results: $\\mu_{part} = q_p/2$ and $\\sigma_{part}^2 = q_p^2/12$.\n\nThe total charge on the node, $Q_{node}$, is the sum of the contributions from the $2N_p$ independent particles in the two adjacent cells. The central limit theorem concerns the distribution of such a sum. A key foundation of the theorem is how the mean and variance of the sum relate to the properties of the individual random variables.\nThe mean of the sum is the sum of the means:\n$$\n\\mu_{node} = E[Q_{node}] = \\sum_{k=1}^{2N_p} E[Q_{part, k}] = 2N_p \\cdot \\mu_{part} = 2N_p \\left(\\frac{q_p}{2}\\right) = N_p q_p\n$$\nSince the particle positions are independent, the variance of the sum is the sum of the variances:\n$$\n\\sigma_{node}^2 = \\text{Var}(Q_{node}) = \\sum_{k=1}^{2N_p} \\text{Var}(Q_{part, k}) = 2N_p \\cdot \\sigma_{part}^2 = 2N_p \\left(\\frac{q_p^2}{12}\\right) = \\frac{N_p q_p^2}{6}\n$$\nThe standard deviation of the charge on the node is the square root of the variance:\n$$\n\\sigma_{node} = \\sqrt{\\frac{N_p q_p^2}{6}} = q_p \\sqrt{\\frac{N_p}{6}}\n$$\nThe problem defines the fractional root-mean-square error as the ratio of the standard deviation to the mean, $\\sigma_{node}/\\mu_{node}$:\n$$\n\\frac{\\sigma_{node}}{\\mu_{node}} = \\frac{q_p \\sqrt{\\frac{N_p}{6}}}{N_p q_p} = \\frac{1}{\\sqrt{N_p}\\sqrt{6}} = \\frac{1}{\\sqrt{6N_p}}\n$$\nThis fractional error is due to the discrete particle noise. We are given the condition that this error must not exceed a prescribed target value $\\epsilon$:\n$$\n\\frac{1}{\\sqrt{6N_p}} \\le \\epsilon\n$$\nTo find the minimum number of particles per cell, $N_p$, that satisfies this condition, we solve for $N_p$. Squaring both sides of the inequality (which is permissible as both sides are positive) gives:\n$$\n\\frac{1}{6N_p} \\le \\epsilon^2\n$$\nRearranging the terms to solve for $N_p$:\n$$\n1 \\le 6N_p \\epsilon^2\n$$\n$$\nN_p \\ge \\frac{1}{6\\epsilon^2}\n$$\nThe minimum number of particles per cell required is obtained at the limit of this inequality.",
            "answer": "$$\\boxed{\\frac{1}{6\\epsilon^2}}$$"
        }
    ]
}