{
    "hands_on_practices": [
        {
            "introduction": "Gyrokinetic theory is a powerful tool, but its validity rests on a clear separation of scales. This exercise will guide you through a fundamental check by calculating the ion gyrofrequency and gyroradius for a hypothetical astrophysical plasma. By comparing the gyroradius $\\rho_i$ to the characteristic perpendicular scale length of fluctuations $1/k_\\perp$, you will assess whether the core assumption of the gyrokinetic model holds in this specific scenario .",
            "id": "4216719",
            "problem": "Consider the Intracluster Medium (ICM) in a galaxy cluster modeled as a weakly collisional, magnetized hydrogen plasma. Assume a uniform magnetic field magnitude $B = 1 \\times 10^{-6}\\,\\mathrm{G}$ and number density $n = 1 \\times 10^{-3}\\,\\mathrm{cm}^{-3}$. Let the ions be protons with isotropic temperature $T_i = 5\\,\\mathrm{keV}$. Work in Gaussian centimeter–gram–second (cgs) units. Using first principles starting from the Lorentz force and the Maxwell–Boltzmann distribution, derive the ion gyrofrequency $\\Omega_i$ and the ion thermal Larmor radius $\\rho_i$, and evaluate the finite Larmor radius parameter $k_{\\perp}\\rho_i$ for a characteristic perpendicular wavenumber $k_{\\perp} = 1 \\times 10^{-6}\\,\\mathrm{cm}^{-1}$. Then, assess the validity of Gyrokinetic (GK) theory under the ordering based solely on the finite Larmor radius parameter, by adopting the criterion $k_{\\perp}\\rho_i \\leq 1$ as the threshold for validity.\n\nYou may use the following constants:\n- Elementary charge (Gaussian cgs): $e = 4.803204712 \\times 10^{-10}\\,\\mathrm{statC}$.\n- Proton mass: $m_p = 1.672621923 \\times 10^{-24}\\,\\mathrm{g}$.\n- Speed of light: $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}$.\n- Boltzmann constant: $k_B = 1.380649 \\times 10^{-16}\\,\\mathrm{erg/K}$.\n- Electronvolt conversion: $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$.\n\nInstructions:\n- Derive $\\Omega_i$ from the Lorentz force and $\\rho_i$ from the thermal speed of a Maxwellian ion distribution.\n- Compute the ordered quadruple $(\\Omega_i, \\rho_i, k_{\\perp}\\rho_i, V)$, where $V = 1$ if $k_{\\perp}\\rho_i \\leq 1$ and $V = 0$ otherwise.\n- Express $\\Omega_i$ in $\\mathrm{s}^{-1}$, $\\rho_i$ in $\\mathrm{cm}$, and $k_{\\perp}\\rho_i$ and $V$ as dimensionless quantities.\n- Round each entry of the quadruple to three significant figures.\n- Provide your final numerical answer as a single row matrix in the order $(\\Omega_i, \\rho_i, k_{\\perp}\\rho_i, V)$.",
            "solution": "The problem requires the calculation of the ion gyrofrequency $\\Omega_i$, the ion thermal Larmor radius $\\rho_i$, the finite Larmor radius parameter $k_{\\perp}\\rho_i$, and a validity flag $V$.\n\n**1. Ion Gyrofrequency ($\\Omega_i$)**\n\nThe motion of a charged particle in a magnetic field is governed by the Lorentz force. In Gaussian cgs units, for an ion (proton) with charge $e$ and mass $m_p$, this force is:\n$$\n\\vec{F} = \\frac{e}{c} (\\vec{v} \\times \\vec{B})\n$$\nThe angular frequency of this gyromotion, known as the gyrofrequency $\\Omega_i$, is independent of velocity and given by:\n$$\n\\Omega_i = \\frac{e B}{m_p c}\n$$\nSubstituting the given values:\n$e = 4.803204712 \\times 10^{-10}\\,\\mathrm{statC}$\n$B = 1 \\times 10^{-6}\\,\\mathrm{G}$\n$m_p = 1.672621923 \\times 10^{-24}\\,\\mathrm{g}$\n$c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}$\n$$\n\\Omega_i = \\frac{(4.8032 \\times 10^{-10}) (1 \\times 10^{-6})}{(1.6726 \\times 10^{-24}) (2.9979 \\times 10^{10})} = \\frac{4.8032 \\times 10^{-16}}{5.0143 \\times 10^{-14}} \\approx 0.009579\\,\\mathrm{s}^{-1}\n$$\n\n**2. Ion Thermal Larmor Radius ($\\rho_i$)**\n\nThe Larmor radius is defined as $\\rho_i = v_{th, \\perp} / \\Omega_i$, where $v_{th, \\perp}$ is the ion thermal speed perpendicular to the magnetic field. For an isotropic temperature $T_i$, the average perpendicular kinetic energy is $\\langle \\frac{1}{2} m_p v_{\\perp}^2 \\rangle = k_B T_i$. The root-mean-square perpendicular speed, $v_{th, \\perp} = \\sqrt{\\langle v_{\\perp}^2 \\rangle}$, is thus:\n$$\nv_{th, \\perp} = \\sqrt{\\frac{2 k_B T_i}{m_p}}\n$$\nThe problem gives the ion temperature in energy units, $T_i = 5\\,\\mathrm{keV}$. We convert this to ergs:\n$$\nT_{i, \\mathrm{erg}} = (5 \\times 10^3\\,\\mathrm{eV}) \\times (1.602176634 \\times 10^{-12}\\,\\mathrm{erg/eV}) = 8.01088 \\times 10^{-9}\\,\\mathrm{erg}\n$$\nNow we compute the thermal speed:\n$$\nv_{th, \\perp} = \\sqrt{\\frac{2 \\times (8.01088 \\times 10^{-9}\\,\\mathrm{erg})}{1.67262 \\times 10^{-24}\\,\\mathrm{g}}} \\approx \\sqrt{9.5788 \\times 10^{15}\\,\\mathrm{cm}^2/\\mathrm{s}^2} \\approx 9.7871 \\times 10^7\\,\\mathrm{cm/s}\n$$\nThe thermal Larmor radius $\\rho_i$ is then:\n$$\n\\rho_i = \\frac{v_{th, \\perp}}{\\Omega_i} = \\frac{9.7871 \\times 10^7\\,\\mathrm{cm/s}}{0.009579\\,\\mathrm{s}^{-1}} \\approx 1.0217 \\times 10^{10}\\,\\mathrm{cm}\n$$\n\n**3. Finite Larmor Radius Parameter ($k_{\\perp}\\rho_i$)**\n\nThis parameter compares the fluctuation scale ($1/k_{\\perp}$) to the ion gyroradius $\\rho_i$.\nGiven $k_{\\perp} = 1 \\times 10^{-6}\\,\\mathrm{cm}^{-1}$:\n$$\nk_{\\perp}\\rho_i = (1 \\times 10^{-6}\\,\\mathrm{cm}^{-1}) \\times (1.0217 \\times 10^{10}\\,\\mathrm{cm}) \\approx 1.0217 \\times 10^4\n$$\n\n**4. Gyrokinetic Validity Assessment ($V$)**\n\nThe criterion for gyrokinetic validity is $k_{\\perp}\\rho_i \\leq 1$. Our calculated value is approximately $1.02 \\times 10^4$, which is much greater than $1$. Therefore, the condition is not satisfied, and the gyrokinetic model is not valid for these parameters. The validity flag $V$ is therefore $0$.\n\n### Summary of Results\nThe calculated values, rounded to three significant figures, are:\n-   $\\Omega_i \\approx 9.58 \\times 10^{-3}\\,\\mathrm{s}^{-1}$\n-   $\\rho_i \\approx 1.02 \\times 10^{10}\\,\\mathrm{cm}$\n-   $k_{\\perp}\\rho_i \\approx 1.02 \\times 10^4$\n-   $V = 0$\n\nThe final answer is the ordered quadruple of these values.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9.58 \\times 10^{-3} & 1.02 \\times 10^{10} & 1.02 \\times 10^{4} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Running a stable numerical simulation requires careful consideration of its time step, which is limited by the fastest physical processes being modeled. This problem focuses on deriving the Courant–Friedrichs–Lewy (CFL) stability constraints for an explicit gyrokinetic simulation . You will calculate the time step limits imposed by both the rapid parallel streaming of electrons and the perpendicular $\\mathbf{E} \\times \\mathbf{B}$ advection, learning how to identify and manage the most restrictive numerical bottlenecks.",
            "id": "4216743",
            "problem": "Consider an explicit time integration of the electrostatic gyrokinetic equation for a hot, magnetized astrophysical plasma representative of an accretion disk corona. Focus on the advection processes that constrain the time step: parallel streaming along the magnetic field and perpendicular advection by the electric field cross magnetic field drift. Let the computational grid be uniform with spacing $\\Delta z$ along the magnetic field and spacing $\\Delta x$ in one perpendicular direction. The maximum stable time step must satisfy a Courant–Friedrichs–Lewy (CFL) condition based on the requirement that advected information does not traverse more than a fraction of a grid cell in one time step.\n\nUse the following physically consistent data:\n- Magnetic field magnitude $B = 0.01\\,\\mathrm{T}$.\n- Electron temperature $T_e = 1.0\\times 10^7\\,\\mathrm{K}$.\n- Electrostatic potential amplitude $\\phi = 150\\,\\mathrm{V}$.\n- Dominant perpendicular fluctuation wavenumber $k_\\perp = 20\\,\\mathrm{m^{-1}}$.\n- Parallel grid spacing $\\Delta z = 20\\,\\mathrm{m}$.\n- Perpendicular grid spacing $\\Delta x = 0.05\\,\\mathrm{m}$.\n- Courant safety factor $C_{\\mathrm{CFL}} = 0.5$.\n\nStart from the advection of a scalar $f$ satisfying $f_t + v\\,f_x = 0$ in one dimension and its generalization to the gyrokinetic parallel streaming term $v_\\parallel\\,\\partial f/\\partial z$ and the perpendicular electric field cross magnetic field drift advection $\\mathbf{v}_E\\cdot\\nabla_\\perp f$. Derive the CFL constraint on the explicit time step $\\Delta t$ for both processes using first principles. Estimate the electron parallel streaming speed using the thermal speed $v_{\\mathrm{th},e}$ of a Maxwellian electron population and estimate the perpendicular drift speed $v_E$ from the electric field amplitude implied by the potential fluctuation. In the International System of Units (SI), use $v_E = |\\mathbf{E}|/B$ for the magnitude of the electric field cross magnetic field drift. For the electric field amplitude, use $|\\mathbf{E}| \\simeq |\\nabla_\\perp \\phi| \\simeq k_\\perp \\phi$. Neglect relativistic corrections.\n\nCompute the maximum allowable explicit time step $\\Delta t_{\\max}$ (in seconds) that simultaneously satisfies the CFL constraints from both parallel streaming and electric field cross magnetic field drift advection. Round your answer to three significant figures and express it in seconds.",
            "solution": "The Courant–Friedrichs–Lewy (CFL) condition is a necessary condition for the stability of explicit time-integration schemes for solving partial differential equations involving advection. For a one-dimensional advection equation of the form $\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = 0$, where $v$ is the advection speed, the CFL condition for a simple explicit finite-difference scheme states that the numerical domain of dependence must contain the physical domain of dependence. This translates to the constraint that information must not propagate more than one grid cell in a single time step. For a scheme with a Courant safety factor $C_{\\mathrm{CFL}}$, this is expressed as:\n$$|v| \\frac{\\Delta t}{\\Delta x} \\le C_{\\mathrm{CFL}}$$\nThis gives the maximum stable time step $\\Delta t$ for a given speed $|v|$ and grid spacing $\\Delta x$:\n$$\\Delta t \\le C_{\\mathrm{CFL}} \\frac{\\Delta x}{|v|}$$\n\nThe problem requires us to consider two advection processes that constrain the time step $\\Delta t$: parallel streaming and perpendicular $\\mathbf{E} \\times \\mathbf{B}$ drift. The overall maximum allowable time step $\\Delta t_{\\max}$ must satisfy the CFL condition for both processes simultaneously.\n\nThe physical constants required for this calculation are the Boltzmann constant, $k_B \\approx 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$, and the electron mass, $m_e \\approx 9.109384 \\times 10^{-31}\\,\\mathrm{kg}$.\n\nFirst, we analyze the constraint from parallel streaming. The advection term in the gyrokinetic equation is $v_\\parallel \\frac{\\partial f}{\\partial z}$. The characteristic speed is the parallel particle velocity $v_\\parallel$, and the relevant grid spacing is the parallel one, $\\Delta z$. The most restrictive constraint comes from the fastest particles. The problem instructs us to use the electron thermal speed, $v_{\\mathrm{th},e}$, as the characteristic maximum speed. The 1D thermal speed for a Maxwellian distribution is given by:\n$$v_{\\mathrm{th},e} = \\sqrt{\\frac{k_B T_e}{m_e}}$$\nUsing the given electron temperature $T_e = 1.0 \\times 10^7\\,\\mathrm{K}$:\n$$v_{\\mathrm{th},e} = \\sqrt{\\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (1.0 \\times 10^7\\,\\mathrm{K})}{9.109384 \\times 10^{-31}\\,\\mathrm{kg}}} \\approx 1.231 \\times 10^7\\,\\mathrm{m/s}$$\nThe CFL constraint for parallel streaming, $\\Delta t_\\parallel$, is therefore:\n$$\\Delta t_\\parallel \\le C_{\\mathrm{CFL}} \\frac{\\Delta z}{v_{\\mathrm{th},e}}$$\nUsing the given values $C_{\\mathrm{CFL}} = 0.5$ and $\\Delta z = 20\\,\\mathrm{m}$:\n$$\\Delta t_\\parallel \\le 0.5 \\times \\frac{20\\,\\mathrm{m}}{1.231 \\times 10^7\\,\\mathrm{m/s}} \\approx 8.123 \\times 10^{-7}\\,\\mathrm{s}$$\n\nSecond, we analyze the constraint from the perpendicular $\\mathbf{E} \\times \\mathbf{B}$ drift. The advection term is $\\mathbf{v}_E \\cdot \\nabla_\\perp f$. The characteristic speed is the magnitude of the drift velocity, $v_E = |\\mathbf{v}_E|$, and the relevant grid spacing is the perpendicular one, $\\Delta x$. The problem provides the formula for the drift speed:\n$$v_E = \\frac{|\\mathbf{E}|}{B}$$\nAnd an approximation for the electric field magnitude based on the electrostatic potential fluctuation $\\phi$ and the dominant perpendicular wavenumber $k_\\perp$:\n$$|\\mathbf{E}| \\simeq |\\nabla_\\perp \\phi| \\simeq k_\\perp \\phi$$\nCombining these gives the expression for the drift speed:\n$$v_E \\simeq \\frac{k_\\perp \\phi}{B}$$\nUsing the given values $B = 0.01\\,\\mathrm{T}$, $\\phi = 150\\,\\mathrm{V}$, and $k_\\perp = 20\\,\\mathrm{m^{-1}}$:\n$$v_E \\simeq \\frac{(20\\,\\mathrm{m^{-1}}) \\times (150\\,\\mathrm{V})}{0.01\\,\\mathrm{T}} = \\frac{3000}{0.01}\\,\\mathrm{m/s} = 3.0 \\times 10^5\\,\\mathrm{m/s}$$\nThe CFL constraint for perpendicular advection, $\\Delta t_\\perp$, is:\n$$\\Delta t_\\perp \\le C_{\\mathrm{CFL}} \\frac{\\Delta x}{v_E}$$\nUsing the given values $C_{\\mathrm{CFL}} = 0.5$ and $\\Delta x = 0.05\\,\\mathrm{m}$:\n$$\\Delta t_\\perp \\le 0.5 \\times \\frac{0.05\\,\\mathrm{m}}{3.0 \\times 10^5\\,\\mathrm{m/s}} = \\frac{0.025}{3.0 \\times 10^5}\\,\\mathrm{s} \\approx 8.333 \\times 10^{-8}\\,\\mathrm{s}$$\n\nFinally, for the explicit time integration to be stable, the time step $\\Delta t$ must satisfy both constraints simultaneously. Thus, the maximum allowable time step $\\Delta t_{\\max}$ is the minimum of the individual limits:\n$$\\Delta t_{\\max} = \\min(\\Delta t_\\parallel, \\Delta t_\\perp)$$\nComparing the calculated values:\n$$\\Delta t_{\\max} = \\min(8.123 \\times 10^{-7}\\,\\mathrm{s}, 8.333 \\times 10^{-8}\\,\\mathrm{s}) = 8.333 \\times 10^{-8}\\,\\mathrm{s}$$\nIn this case, the perpendicular $\\mathbf{E} \\times \\mathbf{B}$ advection imposes the more stringent constraint on the time step.\n\nRounding the result to three significant figures gives $8.33 \\times 10^{-8}\\,\\mathrm{s}$.",
            "answer": "$$\\boxed{8.33 \\times 10^{-8}}$$"
        },
        {
            "introduction": "A defining feature of the gyrokinetic Particle-in-Cell (PIC) method is the way it represents particles not as points, but as rings of charge corresponding to their gyro-orbits. This exercise explores the practical implementation of this concept by having you derive the charge-assignment weights for a gyro-ring onto a computational grid . This process of gyro-averaging is central to filtering out the fast gyromotion and is a key distinction from standard PIC techniques.",
            "id": "263902",
            "problem": "In Particle-In-Cell (PIC) simulations based on the gyrokinetic model, the rapid gyration of charged particles around magnetic field lines means their charge is effectively distributed over a circular \"gyro-ring\". When coupling these particles to a simulation grid, this spatial distribution is accounted for by assigning the particle's charge to nearby grid nodes. The fraction of charge assigned to a particular node is determined by a weight calculated from a gyro-averaged particle shape function.\n\nConsider a two-dimensional Cartesian grid with uniform spacing $\\Delta$ in both the $x$ and $y$ directions. A gyrokinetic particle's guiding-center (gyrocenter) is located precisely at a grid node, which we set as the origin $(0,0)$ of our coordinate system. The particle's gyroradius is $\\rho$, and it is given that $\\rho < \\Delta$, ensuring the entire gyro-ring is contained within the support of the shape function of the central and immediately adjacent nodes.\n\nThe charge assignment is performed using the bilinear (or Cloud-in-Cell, CIC) interpolation scheme. For a point charge located at position $(x,y)$ relative to the grid node at the origin, the CIC shape function $S(x,y)$ gives the weight assigned to the origin node. It is defined as:\n$$\nS(x, y) = \\begin{cases} \\left(1 - \\frac{|x|}{\\Delta}\\right)\\left(1 - \\frac{|y|}{\\Delta}\\right) & \\text{if } |x| < \\Delta \\text{ and } |y| < \\Delta \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nFor the gyrokinetic particle, the total weight assigned to the origin node, $W_{00}$, is the value of this shape function averaged over the entire gyro-ring. A point on the gyro-ring can be parameterized by the gyro-angle $\\phi \\in [0, 2\\pi]$ as $(x,y) = (\\rho\\cos\\phi, \\rho\\sin\\phi)$.\n\nDerive the analytical expression for the weight $W_{00}$ assigned to the grid node at the origin $(0,0)$.",
            "solution": "We seek the gyro-averaged weight \n$$W_{00}=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}S(\\rho\\cos\\phi,\\rho\\sin\\phi)\\,d\\phi$$\nwith \n$$S(x,y)=\\Bigl(1-\\frac{|x|}{\\Delta}\\Bigr)\\Bigl(1-\\frac{|y|}{\\Delta}\\Bigr)\\,,\\quad |x|,|y|<\\Delta.$$\n\nExpand the integrand with $a=\\rho/\\Delta$:\n$$S=1-a|\\cos\\phi|-a|\\sin\\phi|+a^2|\\cos\\phi\\,\\sin\\phi|.$$\nHence\n$$W_{00}=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\Bigl[1-a|\\cos\\phi|-a|\\sin\\phi|+a^2|\\cos\\phi\\sin\\phi|\\Bigr]d\\phi.$$\n\nCompute each integral:\n$$\\int_{0}^{2\\pi}1\\,d\\phi=2\\pi,$$\n$$\\int_{0}^{2\\pi}|\\cos\\phi|\\,d\\phi=4,$$\n$$\\int_{0}^{2\\pi}|\\sin\\phi|\\,d\\phi=4,$$\n$$\\int_{0}^{2\\pi}|\\cos\\phi\\,\\sin\\phi|\\,d\\phi\n=\\tfrac12\\int_{0}^{2\\pi}|\\sin2\\phi|\\,d\\phi\n=\\tfrac14\\int_{0}^{4\\pi}|\\sin u|\\,du\n=2.$$\n\nSubstitute back:\n$$W_{00}\n=\\frac{1}{2\\pi}\\Bigl[2\\pi-4a-4a+2a^2\\Bigr]\n=1-\\frac{4a}{\\pi}+\\frac{a^2}{\\pi}\n=1-\\frac{4\\rho}{\\pi\\Delta}+\\frac{\\rho^2}{\\pi\\Delta^2}.$$",
            "answer": "$$\\boxed{1-\\frac{4\\rho}{\\pi\\Delta}+\\frac{\\rho^2}{\\pi\\Delta^2}}$$"
        }
    ]
}