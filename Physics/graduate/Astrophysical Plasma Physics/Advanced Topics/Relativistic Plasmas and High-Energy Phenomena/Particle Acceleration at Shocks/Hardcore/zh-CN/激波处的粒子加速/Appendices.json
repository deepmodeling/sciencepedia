{
    "hands_on_practices": [
        {
            "introduction": "在研究粒子如何在激波处被加速之前，我们必须首先理解激波本身。这项练习将带您回顾流体动力学的基石：质量、动量和能量守恒定律，这些定律决定了等离子体穿过激波前后的物理性质。通过从第一性原理推导Rankine-Hugoniot关系，您将为后续所有激波加速理论奠定坚实的物理基础。",
            "id": "4222705",
            "problem": "一个稳态、平面平行、非辐射的无碰撞激波传播到一个弱磁化的天体物理等离子体中，在该等离子体中，磁场对于跳跃条件而言在动力学上是可忽略的。将该等离子体视为绝热指数为 $\\gamma$ 的单组分单原子理想气体，并假设上游状态（区域 $1$）是均匀的，在激波参考系中其质量密度为 $\\rho_{1}$，压强为 $P_{1}$，整体流速为 $u_{1}$。下游状态（区域 $2$）的密度为 $\\rho_{2}$，压强为 $P_{2}$，流速为 $u_{2}$。定义上游声速马赫数为 $M_{1} \\equiv u_{1}/c_{s1}$，其中 $c_{s1}^{2} = \\gamma P_{1}/\\rho_{1}$；压缩比为 $r \\equiv \\rho_{2}/\\rho_{1}$；温度比为 $T_{2}/T_{1}$，其中 $P = n k_{B} T$，$n$ 为数密度。\n\n仅从跨越激波的质量、动量和能量守恒以及理想气体状态方程出发，推导压缩比 $r$ 和温度比 $T_{2}/T_{1}$ 作为 $\\gamma$ 和 $M_{1}$ 的函数表达式。然后，对于 $\\gamma = 5/3$ 和 $M_{1} = 20$ 的非辐射激波，计算这些表达式的值。\n\n将 $r$ 和 $T_{2}/T_{1}$ 表示为无量纲数，并将您的答案四舍五入到六位有效数字。",
            "solution": "本问题要求从流体动力学的基本守恒定律出发，推导稳态平面平行激波的压缩比 $r$ 和温度比 $T_2/T_1$，然后对给定的特定参数计算这些量的值。等离子体被视为理想单原子气体。推导从朗金-雨贡纽跳跃条件开始，这些条件表达了跨越激波阵面的质量、动量和能量守恒。\n\n设上游状态由下标 $1$ 表示，下游状态由下标 $2$ 表示。在激波的静止参考系中，守恒定律为：\n1. 质量通量守恒：\n$$ \\rho_1 u_1 = \\rho_2 u_2 $$\n2. 动量通量守恒：\n$$ P_1 + \\rho_1 u_1^2 = P_2 + \\rho_2 u_2^2 $$\n3. 能量通量守恒：\n$$ \\frac{1}{2} u_1^2 + h_1 = \\frac{1}{2} u_2^2 + h_2 $$\n其中 $\\rho$ 是质量密度，$u$ 是流体速度，$P$ 是压强，$h$ 是比焓。对于绝热指数为 $\\gamma$ 的理想气体，比焓由 $h = \\frac{\\gamma}{\\gamma-1}\\frac{P}{\\rho}$ 给出。\n\n问题将压缩比定义为 $r \\equiv \\rho_2 / \\rho_1$。从质量守恒方程，我们可以用上游速度 $u_1$ 和压缩比 $r$ 来表示下游速度 $u_2$：\n$$ u_2 = \\frac{\\rho_1}{\\rho_2} u_1 = \\frac{u_1}{r} $$\n\n接下来，我们重新整理动量守恒方程以求解压强差：\n$$ P_2 - P_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2 $$\n代入 $u_2 = u_1/r$ 和 $\\rho_2 = r\\rho_1$：\n$$ P_2 - P_1 = \\rho_1 u_1^2 - (r\\rho_1)\\left(\\frac{u_1}{r}\\right)^2 = \\rho_1 u_1^2 - \\frac{\\rho_1 u_1^2}{r} = \\rho_1 u_1^2 \\left(1 - \\frac{1}{r}\\right) $$\n为了用上游马赫数 $M_1 \\equiv u_1 / c_{s1}$（其中 $c_{s1}^2 = \\gamma P_1 / \\rho_1$）来表示，我们将方程两边除以 $P_1$：\n$$ \\frac{P_2}{P_1} - 1 = \\frac{\\rho_1 u_1^2}{P_1} \\left(1 - \\frac{1}{r}\\right) $$\n使用 $c_{s1}^2$，我们可以写出 $\\rho_1/P_1 = \\gamma/c_{s1}^2$。因此，$\\frac{\\rho_1 u_1^2}{P_1} = \\frac{\\gamma u_1^2}{c_{s1}^2} = \\gamma M_1^2$。\n这给出了压强比的关系式：\n$$ \\frac{P_2}{P_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{1}{r}\\right) \\quad (*)$$\n\n现在我们使用能量守恒方程。代入比焓的表达式：\n$$ \\frac{1}{2} u_1^2 + \\frac{\\gamma}{\\gamma-1}\\frac{P_1}{\\rho_1} = \\frac{1}{2} u_2^2 + \\frac{\\gamma}{\\gamma-1}\\frac{P_2}{\\rho_2} $$\n代入 $u_2 = u_1/r$ 和 $\\rho_2 = r\\rho_1$：\n$$ \\frac{1}{2} u_1^2 + \\frac{\\gamma}{\\gamma-1}\\frac{P_1}{\\rho_1} = \\frac{1}{2} \\frac{u_1^2}{r^2} + \\frac{\\gamma}{\\gamma-1}\\frac{P_2}{r\\rho_1} $$\n为简化起见，我们将整个方程乘以 $2\\rho_1$：\n$$ \\rho_1 u_1^2 + \\frac{2\\gamma}{\\gamma-1}P_1 = \\frac{\\rho_1 u_1^2}{r^2} + \\frac{2\\gamma}{(\\gamma-1)r}P_2 $$\n两边除以 $P_1$ 并代入 $\\rho_1 u_1^2 / P_1 = \\gamma M_1^2$：\n$$ \\gamma M_1^2 + \\frac{2\\gamma}{\\gamma-1} = \\frac{\\gamma M_1^2}{r^2} + \\frac{2\\gamma}{(\\gamma-1)r} \\frac{P_2}{P_1} $$\n两边除以 $\\gamma$：\n$$ M_1^2 + \\frac{2}{\\gamma-1} = \\frac{M_1^2}{r^2} + \\frac{2}{r(\\gamma-1)} \\frac{P_2}{P_1} \\quad (**) $$\n\n现在我们得到一个包含两个未知数 $r$ 和 $P_2/P_1$ 的方程组，由 $(*)$ 和 $(**)$ 组成。我们通过将 $(*)$ 中的 $P_2/P_1$ 表达式代入 $(**)$ 来求解 $r$：\n$$ M_1^2 + \\frac{2}{\\gamma-1} = \\frac{M_1^2}{r^2} + \\frac{2}{r(\\gamma-1)} \\left[ 1 + \\gamma M_1^2 \\left(1 - \\frac{1}{r}\\right) \\right] $$\n$$ M_1^2 + \\frac{2}{\\gamma-1} = \\frac{M_1^2}{r^2} + \\frac{2}{r(\\gamma-1)} + \\frac{2\\gamma M_1^2}{r(\\gamma-1)} - \\frac{2\\gamma M_1^2}{r^2(\\gamma-1)} $$\n将整个方程乘以 $r^2(\\gamma-1)$ 以消去分母：\n$$ r^2(\\gamma-1)M_1^2 + 2r^2 = (\\gamma-1)M_1^2 + 2r + 2\\gamma r M_1^2 - 2\\gamma M_1^2 $$\n将其整理成 $Ar^2 + Br + C = 0$ 形式的二次方程：\n$$ r^2 [(\\gamma-1)M_1^2 + 2] - r[2 + 2\\gamma M_1^2] + [2\\gamma M_1^2 - (\\gamma-1)M_1^2] = 0 $$\n$$ r^2 [(\\gamma-1)M_1^2 + 2] - 2r(1 + \\gamma M_1^2) + (\\gamma+1)M_1^2 = 0 $$\n这个关于 $r$ 的二次方程有两个解。一个是平凡的“无激波”解，$r=1$（即 $\\rho_2 = \\rho_1$）。我们可以通过代入来验证这一点：\n对于 $r=1$：$[(\\gamma-1)M_1^2 + 2] - [2 + 2\\gamma M_1^2] + (\\gamma+1)M_1^2 = (\\gamma-1-2\\gamma+\\gamma+1)M_1^2 + (2-2) = 0$。\n由于 $r=1$ 是一个根，我们可以利用二次方程 $Ax^2+Bx+C=0$ 的根 $x_1, x_2$ 满足根的乘积为 $x_1 x_2 = C/A$ 这一性质，来找到另一个对应于物理激波解的根。\n这里，$1 \\cdot r = C/A$，所以物理压缩比为：\n$$ r = \\frac{(\\gamma+1)M_1^2}{2 + (\\gamma-1)M_1^2} $$\n\n接下来，我们推导温度比 $T_2/T_1$。对于理想气体，状态方程为 $P=nk_BT$，其中 $n$ 是数密度。由于 $n = \\rho/m$（其中 $m$ 是平均粒子质量），$P = (\\rho/m)k_B T$。因此，$T$ 与 $P/\\rho$ 成正比。温度比为：\n$$ \\frac{T_2}{T_1} = \\frac{P_2/\\rho_2}{P_1/\\rho_1} = \\frac{P_2}{P_1} \\frac{\\rho_1}{\\rho_2} = \\frac{1}{r}\\frac{P_2}{P_1} $$\n我们使用方程 $(*)$ 中的 $P_2/P_1$ 表达式和我们推导出的 $r$ 的公式：\n$$ 1 - \\frac{1}{r} = 1 - \\frac{2 + (\\gamma-1)M_1^2}{(\\gamma+1)M_1^2} = \\frac{(\\gamma+1)M_1^2 - 2 - (\\gamma-1)M_1^2}{(\\gamma+1)M_1^2} = \\frac{2M_1^2 - 2}{(\\gamma+1)M_1^2} $$\n将此代入压强比的表达式中：\n$$ \\frac{P_2}{P_1} = 1 + \\gamma M_1^2 \\left( \\frac{2(M_1^2 - 1)}{(\\gamma+1)M_1^2} \\right) = 1 + \\frac{2\\gamma(M_1^2 - 1)}{\\gamma+1} = \\frac{\\gamma+1 + 2\\gamma M_1^2 - 2\\gamma}{\\gamma+1} = \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} $$\n最后，我们求出温度比：\n$$ \\frac{T_2}{T_1} = \\frac{1}{r} \\frac{P_2}{P_1} = \\left( \\frac{2 + (\\gamma-1)M_1^2}{(\\gamma+1)M_1^2} \\right) \\left( \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} \\right) $$\n\n现在，我们对单原子气体（$\\gamma = 5/3$）和上游马赫数 $M_1=20$ 的情况计算这些表达式的值。\n首先，我们找出常数的值：\n$\\gamma = 5/3$\n$M_1 = 20 \\implies M_1^2 = 400$\n$\\gamma+1 = 5/3 + 1 = 8/3$\n$\\gamma-1 = 5/3 - 1 = 2/3$\n\n计算压缩比 $r$：\n$$ r = \\frac{(\\frac{8}{3})(400)}{2 + (\\frac{2}{3})(400)} = \\frac{3200/3}{2 + 800/3} = \\frac{3200/3}{(6+800)/3} = \\frac{3200}{806} = \\frac{1600}{403} \\approx 3.9702233... $$\n四舍五入到六位有效数字，$r = 3.97022$。\n\n计算温度比 $T_2/T_1$。我们首先求出压强比 $P_2/P_1$：\n$$ \\frac{P_2}{P_1} = \\frac{2(\\frac{5}{3})(400) - (\\frac{2}{3})}{8/3} = \\frac{4000/3 - 2/3}{8/3} = \\frac{3998/3}{8/3} = \\frac{3998}{8} = \\frac{1999}{4} = 499.75 $$\n然后，我们求出温度比：\n$$ \\frac{T_2}{T_1} = \\frac{P_2/P_1}{r} = \\frac{1999/4}{1600/403} = \\frac{1999 \\times 403}{4 \\times 1600} = \\frac{805597}{6400} = 125.87453125 $$\n四舍五入到六位有效数字，$T_2/T_1 = 125.875$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3.97022  125.875 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "天体物理学中的一个核心问题是：“在给定的加速器中，宇宙线可以达到的最大能量是多少？”这项练习将扩散激波加速理论应用于一个真实的超新星遗迹场景。您将计算受限于加速器年龄和其物理尺寸（即Hillas极限）的最大质子能量，从而将抽象的理论与可观测的物理约束联系起来。",
            "id": "4222646",
            "problem": "一个年轻的超新星遗迹 (SNR) 在磁化等离子体中驱动一个准平行无碰撞激波，其上游流速为 $u_1$，上游磁场强度为 $B$。考虑在 Bohm 极限下通过扩散激波加速机制对质子进行加速。假设这是一个压缩比为 $r=4$ 的强激波，上下游均为各向同性散射且具有相等的标量扩散系数，并将质子视为超相对论粒子，其速度 $v \\approx c$，能量 $E \\approx p c$，其中 $p$ 是动量。在厘米-克-秒 (cgs) 高斯单位制下进行计算，并采用 $e=4.803204712\\times 10^{-10}\\,\\mathrm{statC}$ 和 $c=2.99792458\\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$。加速器有限的年龄通过条件 $t_{\\mathrm{acc}}(E) \\le t$ 提供了一个上限，而约束条件通过 $r_g(E) \\le R$ 提供了 Hillas 极限，其中 $R$ 是加速器的特征尺寸。Bohm 扩散系数定义为 $\\,\\kappa_{\\mathrm{B}}=(1/3)\\,r_g\\,v\\,$，相对论性回旋半径定义为 $\\,r_g= p c/(Z e B)\\,$，其中 $Z$ 为电荷数。\n\n从这些基本原理和标准扩散激波加速框架出发，推导在 Bohm 极限下，质子 ($Z=1$) 受年龄限制的最大能量 $E_{\\mathrm{age}}$ 作为 $t$、$u_1$ 和 $B$ 的函数，并利用 $R\\simeq u_1 t$ 确定 Hillas 约束极限 $E_{\\mathrm{H}}$。对于给定的 SNR 参数 $t=1000\\,\\mathrm{yr}$、$u_1=5000\\,\\mathrm{km\\,s^{-1}}$ 和 $B=100\\,\\mu\\mathrm{G}$，计算这两个极限值。将有效最大能量取为两个极限中的较小者，$E_{\\max}=\\min(E_{\\mathrm{age}},E_{\\mathrm{H}})$。将最终能量以 $\\mathrm{eV}$ 为单位表示，并将答案四舍五入至三位有效数字。",
            "solution": "此问题的目标是为在超新星遗迹（SNR）激波处加速的质子推导并计算两个最大能量极限：受年龄限制的能量 $E_{\\mathrm{age}}$ 和受Hillas判据约束的能量 $E_{\\mathrm{H}}$。有效最大能量是这两者中的较小者。\n\n**1. 受年龄限制的最大能量 ($E_{\\mathrm{age}}$) 的推导**\n\n受年龄限制的最大能量由条件 $t_{\\mathrm{acc}}(E_{\\mathrm{age}}) = t$ 决定，其中 $t$ 是SNR的年龄。标准扩散激波加速（DSA）理论给出的特征加速时间为：\n$$\nt_{\\mathrm{acc}}(E) = \\frac{3}{u_1 - u_2} \\left( \\frac{\\kappa_1}{u_1} + \\frac{\\kappa_2}{u_2} \\right)\n$$\n其中 $u_1$ 和 $u_2$ 是上、下游流速，$\\kappa_1$ 和 $\\kappa_2$ 是相应的扩散系数。\n对于压缩比为 $r = u_1/u_2 = 4$ 的强激波，我们有 $u_2 = u_1/4$，因此速度差为 $u_1 - u_2 = \\frac{3}{4}u_1$。\n问题假设扩散系数相等，$\\kappa_1 = \\kappa_2 = \\kappa$。代入 $t_{\\mathrm{acc}}$ 的表达式得：\n$$\nt_{\\mathrm{acc}}(E) = \\frac{3}{\\frac{3}{4}u_1} \\left( \\frac{\\kappa}{u_1} + \\frac{\\kappa}{u_1/4} \\right) = \\frac{4}{u_1} \\left( \\frac{\\kappa}{u_1} + \\frac{4\\kappa}{u_1} \\right) = \\frac{4}{u_1} \\left( \\frac{5\\kappa}{u_1} \\right) = \\frac{20\\kappa}{u_1^2}\n$$\n在Bohm极限下，扩散系数为 $\\kappa = \\kappa_{\\mathrm{B}} = \\frac{1}{3}r_g v$。对于超相对论质子（$Z=1, v \\approx c, E \\approx pc$），其回旋半径（在高斯cgs单位制中）为 $r_g = \\frac{pc}{eB} = \\frac{E}{eB}$。因此，\n$$\n\\kappa(E) = \\frac{1}{3} \\left(\\frac{E}{eB}\\right) c = \\frac{Ec}{3eB}\n$$\n将此能量依赖的扩散系数代入加速时间表达式：\n$$\nt_{\\mathrm{acc}}(E) = \\frac{20}{u_1^2} \\left(\\frac{Ec}{3eB}\\right) = \\frac{20Ec}{3u_1^2eB}\n$$\n从 $t_{\\mathrm{acc}}(E_{\\mathrm{age}}) = t$ 解出 $E_{\\mathrm{age}}$：\n$$\nE_{\\mathrm{age}} = \\frac{3}{20} \\frac{u_1^2 e B t}{c}\n$$\n\n**2. Hillas约束极限 ($E_{\\mathrm{H}}$) 的推导**\n\nHillas极限要求粒子的回旋半径 $r_g$ 不能超过加速器的尺寸 $R$。最大能量对应于 $r_g(E_{\\mathrm{H}}) = R$。\n使用给定的关系 $R \\simeq u_1 t$ 和回旋半径 $r_g = E/(eB)$，Hillas条件变为：\n$$\n\\frac{E_{\\mathrm{H}}}{eB} = u_1 t\n$$\n解出 $E_{\\mathrm{H}}$：\n$$\nE_{\\mathrm{H}} = e B u_1 t\n$$\n\n**3. 最大能量 ($E_{\\max}$) 的确定与计算**\n\n有效最大能量是 $E_{\\max} = \\min(E_{\\mathrm{age}}, E_{\\mathrm{H}})$。它们的比率为：\n$$\n\\frac{E_{\\mathrm{age}}}{E_{\\mathrm{H}}} = \\frac{\\frac{3}{20} \\frac{u_1^2 e B t}{c}}{e B u_1 t} = \\frac{3}{20} \\frac{u_1}{c}\n$$\n由于 $u_1 \\ll c$，显然 $E_{\\mathrm{age}} \\ll E_{\\mathrm{H}}$。因此，最大能量受年龄限制，$E_{\\max} = E_{\\mathrm{age}}$。\n\n我们现在使用 cgs 单位制中的给定参数来计算 $E_{\\max} = E_{\\mathrm{age}}$。\n首先，我们将参数转换为 cgs 单位制：\n- $t = 1000\\,\\mathrm{yr} = 1000 \\times 365.25 \\times 24 \\times 3600\\,\\mathrm{s} = 3.15576 \\times 10^{10}\\,\\mathrm{s}$。\n- $u_1 = 5000\\,\\mathrm{km\\,s^{-1}} = 5000 \\times 10^5\\,\\mathrm{cm\\,s^{-1}} = 5 \\times 10^8\\,\\mathrm{cm\\,s^{-1}}$。\n- $B = 100\\,\\mu\\mathrm{G} = 100 \\times 10^{-6}\\,\\mathrm{G} = 10^{-4}\\,\\mathrm{G}$。\n常数为：\n- $e = 4.803204712 \\times 10^{-10}\\,\\mathrm{statC}$。\n- $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$。\n\n我们以尔格 (erg) 为单位计算 $E_{\\max}$：\n$$\nE_{\\max} = E_{\\mathrm{age}} = \\frac{3}{20} \\frac{u_1^2 e B t}{c}\n$$\n$$\nE_{\\max} = \\frac{3}{20} \\frac{(5 \\times 10^8\\,\\mathrm{cm\\,s^{-1}})^2 (4.8032 \\times 10^{-10}\\,\\mathrm{statC}) (10^{-4}\\,\\mathrm{G}) (3.15576 \\times 10^{10}\\,\\mathrm{s})}{2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}}\n$$\n$$\nE_{\\max} = \\frac{0.15 \\times (25 \\times 10^{16}) \\times (4.8032 \\times 10^{-10}) \\times (10^{-4}) \\times (3.15576 \\times 10^{10})}{2.99792458 \\times 10^{10}}\\,\\mathrm{erg}\n$$\n$$\nE_{\\max} \\approx 1.8948 \\times 10^3\\,\\mathrm{erg}\n$$\n最后，我们将能量从尔格 (erg) 转换为电子伏特 ($\\mathrm{eV}$)。转换因子是 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$。\n$$\nE_{\\max}(\\mathrm{eV}) = \\frac{1.8948 \\times 10^3\\,\\mathrm{erg}}{1.602176634 \\times 10^{-12}\\,\\mathrm{erg/eV}} \\approx 1.1826 \\times 10^{15}\\,\\mathrm{eV}\n$$\n问题要求将答案四舍五入至三位有效数字。\n$$\nE_{\\max} \\approx 1.18 \\times 10^{15}\\,\\mathrm{eV}\n$$",
            "answer": "$$\n\\boxed{1.18 \\times 10^{15}}\n$$"
        },
        {
            "introduction": "最简单的“测试粒子”理论预测了一个纯粹的幂律能谱。然而，当加速过程非常高效时，被加速的粒子本身会反作用于激波结构，使其发生改变。这项练习将引导您探索一个描述这种非线性反馈的简化模型，其中有效压缩比变得依赖于粒子能量，最终产生弯曲的“凹形”能谱——这是在一些天体物理源中观测到的重要特征。",
            "id": "4222680",
            "problem": "考虑一个一维、非相对论性的无碰撞激波，在激波参考系中，其上游流速为 $u_1$，下游流速为 $u_2$。假设在每个局域流体参考系中，通过各向同性的投掷角散射进行弥散激波加速，因此粒子分布近似各向同性。利用粒子数守恒和每次穿越激波循环的平均能量增益，推导相空间分布 $f(p) \\propto p^{-q}$ 的稳态各向同性部分的动量空间谱指数 $q(r)$，将其表示为压缩比 $r \\equiv u_1/u_2$ 的函数，且不假设 $r$ 的任何特定数值。\n\n为了模拟由加速粒子引起的非线性激波修正，我们让更高动量的粒子经历一个更大的有效压缩比，因为它们的扩散长度随动量增加而增加。这可以表示为一个从动量 $p$到有效压缩比的单调映射\n$$\nr_{\\mathrm{eff}}(p) \\equiv r_{\\mathrm{sub}} + \\bigl(r_{\\mathrm{tot}} - r_{\\mathrm{sub}}\\bigr)\\,W(p),\n$$\n其中 $r_{\\mathrm{sub}}$ 是子激波压缩比，$r_{\\mathrm{tot}}$ 是包括宇宙线前驱在内的整个激波的总压缩比，$W(p)$ 是一个递增的采样权重，满足 $W(0)=0$ 和 $\\lim_{p\\to\\infty} W(p)=1$。基于随动量增长的扩散长度，我们采用以下具有物理动机的显式选择：\n$$\nW(p) \\equiv 1 - \\exp\\!\\left[-\\left(\\frac{p}{p_c}\\right)^{\\alpha}\\right],\n$$\n其中 $p_c$ 设定了动量上的过渡标度，在该标度上粒子开始显著地感受到前驱，而 $\\alpha0$ 控制过渡的陡峭程度。所有动量都是无量纲的，以一个固定的参考动量为单位进行测量，因此不需要物理单位。\n\n你的任务是：\n- 从第一性原理出发，将每个循环的平均相对动量增益和逃逸概率与稳态幂律联系起来，从而推导 $q(r)$。\n- 使用推导出的 $q(r)$，定义 $q(p) \\equiv q\\!\\bigl(r_{\\mathrm{eff}}(p)\\bigr)$，并对下面的每个参数集，计算在两个诊断动量 $p_{\\mathrm{low}} \\equiv 10^{-3} p_c$ 和 $p_{\\mathrm{high}} \\equiv 10^{3} p_c$ 处的 $q(p)$。\n- 对每个参数集，返回列表 $[q_{\\mathrm{low}}, q_{\\mathrm{high}}, \\Delta]$，其中 $q_{\\mathrm{low}} \\equiv q(p_{\\mathrm{low}})$，$q_{\\mathrm{high}} \\equiv q(p_{\\mathrm{high}})$，且 $\\Delta \\equiv q_{\\mathrm{low}} - q_{\\mathrm{high}}$。一个在高动量区变平的凹谱对应于 $\\Delta  0$。\n- 将报告的每个浮点数值四舍五入到小数点后六位。\n\n测试套件参数集：\n- 情况 A (一个典型的非线性激波): $(r_{\\mathrm{sub}}, r_{\\mathrm{tot}}, p_c, \\alpha) = (3.5, 6.0, 1.0, 1.0)$。\n- 情况 B (无非线性修正；边界情况): $(r_{\\mathrm{sub}}, r_{\\mathrm{tot}}, p_c, \\alpha) = (4.0, 4.0, 1.0, 1.0)$。\n- 情况 C (更强的总压缩和更陡峭的过渡): $(r_{\\mathrm{sub}}, r_{\\mathrm{tot}}, p_c, \\alpha) = (3.2, 7.0, 1.0, 2.0)$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献其自己的三元素列表，例如：$[[q_{\\mathrm{low},A}, q_{\\mathrm{high},A}, \\Delta_A],[q_{\\mathrm{low},B}, q_{\\mathrm{high},B}, \\Delta_B],[q_{\\mathrm{low},C}, q_{\\mathrm{high},C}, \\Delta_C]]$。不应打印任何额外文本。",
            "solution": "问题陈述已经过评估并被确定为有效。它在科学上基于已建立的弥散激波加速理论，是适定的、客观的，并包含了推导出唯一解所需的所有必要信息。\n\n解答过程分三部分。首先，我们推导动量谱指数 $q$ 作为激波压缩比 $r$ 的函数的通用公式。其次，我们将此公式应用于所提供的非线性激波模型，其中有效压缩比依赖于动量。第三，我们为给定的测试用例计算所需的数值。\n\n**第1部分：谱指数 $q(r)$ 的推导**\n\n我们考虑一群与一维、非相对论性激波相互作用的高能粒子。假设粒子在上游（区域1）和下游（区域2）的局域流体参考系中都进行各向同性散射。在激波静止系中，流速分别为 $u_1$ 和 $u_2$。我们旨在寻找稳态、各向同性的相空间分布函数 $f(p) \\propto p^{-q}$ 的谱指数 $q$。\n\n稳态幂律谱源于每次穿越激波循环的平均能量（或动量）增益与粒子从加速过程中损失的概率之间的平衡。\n\n设一个粒子动量为 $p$，速率为 $v$，我们假设 $v \\gg u_1, u_2$。这对于形成幂律尾的粒子通常是成立的。一个完整的加速循环包括粒子从上游穿越到下游，然后又从下游返回上游。\n\n1.  **每个循环的平均相对动量增益**：对于一个速率为 $v$ 并经历各向同性散射的粒子，每个循环的平均相对动量增益 $\\langle \\Delta p / p \\rangle$ 是弥散激波加速（DSA）理论的一个标准结果。它由下式给出\n    $$\n    \\left\\langle \\frac{\\Delta p}{p} \\right\\rangle = \\frac{4}{3} \\frac{u_1 - u_2}{v}\n    $$\n    这种增益是由于粒子等效于与跨越激波的汇聚散射中心发生对头碰撞。\n\n2.  **每个循环的逃逸概率**：粒子被下游流体平流带离激波。向下游平流的粒子通量与 $n_2 u_2$ 成正比，其中 $n_2$ 是粒子数密度。对于各向同性分布，从下游返回激波的粒子通量与 $n_2 v / 4$ 成正比。从下游每次与激波相遇的逃逸概率 $P_{esc, d}$ 是平流输运通量与随机通量之比，即 $P_{esc, d} \\propto u_2 / v$。一个完整的循环涉及一次从下游到上游的穿越。因此，每个循环的逃逸概率 $P_{esc}$ 为\n    $$\n    P_{\\mathrm{esc}} = \\frac{4 u_2}{v}\n    $$\n\n3.  **幂律谱的形成**：让我们考虑一组以动量 $p_0$ 注入的 $N_0$ 个粒子。经过一个循环后，剩余的粒子数为 $N_1 = N_0(1 - P_{\\mathrm{esc}})$，它们的平均动量为 $p_1 = p_0(1 + \\langle \\Delta p / p \\rangle)$。经过 $k$ 个循环后，我们有：\n    $$\n    N(k) = N_0(1 - P_{\\mathrm{esc}})^k\n    $$\n    $$\n    p(k) \\approx p_0 \\left(1 + \\left\\langle \\frac{\\Delta p}{p} \\right\\rangle \\right)^k\n    $$\n    对两个方程取自然对数，并假设 $P_{\\mathrm{esc}} \\ll 1$ 和 $\\langle \\Delta p / p \\rangle \\ll 1$：\n    $$\n    \\ln\\left(\\frac{N(k)}{N_0}\\right) = k \\ln(1 - P_{\\mathrm{esc}}) \\approx -k P_{\\mathrm{esc}}\n    $$\n    $$\n    \\ln\\left(\\frac{p(k)}{p_0}\\right) = k \\ln\\left(1 + \\left\\langle \\frac{\\Delta p}{p} \\right\\rangle\\right) \\approx k \\left\\langle \\frac{\\Delta p}{p} \\right\\rangle\n    $$\n    从第二个方程，我们发现达到动量 $p$ 所需的循环次数 $k$ 为 $k \\approx \\ln(p/p_0) / \\langle \\Delta p / p \\rangle$。将此代入第一个方程：\n    $$\n    \\ln\\left(\\frac{N}{N_0}\\right) \\approx - \\frac{P_{\\mathrm{esc}}}{\\langle \\Delta p / p \\rangle} \\ln\\left(\\frac{p}{p_0}\\right)\n    $$\n    这给出了积分谱：$N(p)$，即动量大于 $p$ 的粒子数，为\n    $$\n    N(p) \\propto p^{-\\gamma} \\quad \\text{where} \\quad \\gamma = \\frac{P_{\\mathrm{esc}}}{\\langle \\Delta p / p \\rangle}\n    $$\n    微分粒子数谱 $N(p)$ 是单位动量的粒子数，有 $N(p) = -dN(p)/dp \\propto p^{-(\\gamma+1)}$。相空间分布函数 $f(p)$ 通过 $N(p)dp = 4\\pi p^2 f(p) dp$ 与 $N(p)$ 相关。因此，$f(p) \\propto p^{-2}N(p) \\propto p^{-(\\gamma+3)}$。\n    问题通过 $f(p) \\propto p^{-q}$ 定义谱指数 $q$。因此，我们有：\n    $$\n    q = \\gamma + 3 = 3 + \\frac{P_{\\mathrm{esc}}}{\\langle \\Delta p / p \\rangle}\n    $$\n    代入 $P_{\\mathrm{esc}}$ 和 $\\langle \\Delta p / p \\rangle$ 的表达式：\n    $$\n    q = 3 + \\frac{4 u_2 / v}{\\frac{4}{3}(u_1 - u_2) / v} = 3 + \\frac{3 u_2}{u_1 - u_2} = 3\\left(1 + \\frac{u_2}{u_1 - u_2}\\right) = 3\\left(\\frac{u_1 - u_2 + u_2}{u_1 - u_2}\\right) = \\frac{3u_1}{u_1-u_2}\n    $$\n    最后，用压缩比 $r \\equiv u_1/u_2$ 表示 $q$：\n    $$\n    q(r) = \\frac{3 u_1}{u_1 - u_1/r} = \\frac{3}{1 - 1/r} = \\frac{3r}{r-1}\n    $$\n    这就是谱指数与激波压缩比之间的所求关系。对于典型的强激波值 $r=4$，这给出 $q = 3(4)/(4-1) = 4$。\n\n**第2部分：应用于非线性激波模型**\n\n问题引入了一个非线性激波修正模型，其中有效压缩比 $r_{\\mathrm{eff}}$ 依赖于粒子动量 $p$。这反映了这样一个事实：能量越高的粒子具有越大的扩散长度，能够感受到激波的完整速度过渡，包括平滑的前驱；而低能粒子只经历陡峭的子激波。\n\n通过在推导出的公式中用 $r_{\\mathrm{eff}}(p)$ 替换 $r$，谱指数就成为动量的函数 $q(p)$：\n$$\nq(p) \\equiv q(r_{\\mathrm{eff}}(p)) = \\frac{3 r_{\\mathrm{eff}}(p)}{r_{\\mathrm{eff}}(p) - 1}\n$$\n有效压缩比由下式给出：\n$$\nr_{\\mathrm{eff}}(p) = r_{\\mathrm{sub}} + (r_{\\mathrm{tot}} - r_{\\mathrm{sub}})W(p)\n$$\n其中权重函数为：\n$$\nW(p) = 1 - \\exp\\left[-\\left(\\frac{p}{p_c}\\right)^{\\alpha}\\right]\n$$\n在这里，$r_{\\mathrm{sub}}$ 是低动量粒子感受到的子激波压缩比，$r_{\\mathrm{tot}}$ 是高动量粒子感受到的整个激波结构的总压缩比。函数 $W(p)$ 从 $p \\ll p_c$ 时的 $W(p) \\approx 0$ 平滑过渡到 $p \\gg p_c$ 时的 $W(p) \\approx 1$。因此，随着 $p$ 的增加，$r_{\\mathrm{eff}}(p)$ 从 $r_{\\mathrm{sub}}$ 过渡到 $r_{\\mathrm{tot}}$。这导致谱指数 $q(p)$ 随动量变化，从而形成一个弯曲（凹）谱。\n\n**第3部分：数值计算**\n\n我们的任务是计算 $p_{\\mathrm{low}} = 10^{-3}p_c$ 和 $p_{\\mathrm{high}} = 10^{3}p_c$ 时的 $q_{\\mathrm{low}} \\equiv q(p_{\\mathrm{low}})$、$q_{\\mathrm{high}} \\equiv q(p_{\\mathrm{high}})$ 和 $\\Delta \\equiv q_{\\mathrm{low}} - q_{\\mathrm{high}}$。这需要计算在 $p/p_c = 10^{-3}$ 和 $p/p_c = 10^{3}$ 处的 $r_{\\mathrm{eff}}(p)$。\n\n**情况A：** $(r_{\\mathrm{sub}}, r_{\\mathrm{tot}}, p_c, \\alpha) = (3.5, 6.0, 1.0, 1.0)$\n- 在 $p_{\\mathrm{low}}/p_c = 10^{-3}$ 处：\n  $W(p_{\\mathrm{low}}) = 1 - \\exp[-(10^{-3})^1] = 1 - e^{-0.001}$\n  $r_{\\mathrm{eff}}(p_{\\mathrm{low}}) = 3.5 + (6.0 - 3.5)(1 - e^{-0.001}) = 3.5 + 2.5(1 - e^{-0.001}) \\approx 3.50249875$\n  $q_{\\mathrm{low}} = \\frac{3 \\times 3.50249875}{3.50249875 - 1} \\approx 4.198803$\n- 在 $p_{\\mathrm{high}}/p_c = 10^{3}$ 处：\n  $W(p_{\\mathrm{high}}) = 1 - \\exp[-(10^{3})^1] = 1 - e^{-1000} \\approx 1$\n  $r_{\\mathrm{eff}}(p_{\\mathrm{high}}) \\approx 3.5 + 2.5(1) = 6.0$\n  $q_{\\mathrm{high}} = \\frac{3 \\times 6.0}{6.0 - 1} = \\frac{18}{5} = 3.6$\n- $\\Delta = 4.198803 - 3.600000 = 0.598803$。\n- 结果 A: $[4.198803, 3.600000, 0.598803]$\n\n**情况B：** $(r_{\\mathrm{sub}}, r_{\\mathrm{tot}}, p_c, \\alpha) = (4.0, 4.0, 1.0, 1.0)$\n- 在这里，$r_{\\mathrm{sub}} = r_{\\mathrm{tot}} = 4.0$。项 $(r_{\\mathrm{tot}} - r_{\\mathrm{sub}}) = 0$。\n- $r_{\\mathrm{eff}}(p) = 4.0 + (0)W(p) = 4.0$ 对所有 $p$ 成立。这代表一个标准的线性激波，没有非线性修正。\n- $q_{\\mathrm{low}} = \\frac{3 \\times 4.0}{4.0 - 1} = 4.0$\n- $q_{\\mathrm{high}} = \\frac{3 \\times 4.0}{4.0 - 1} = 4.0$\n- $\\Delta = 4.0 - 4.0 = 0.0$\n- 结果 B: $[4.000000, 4.000000, 0.000000]$\n\n**情况C：** $(r_{\\mathrm{sub}}, r_{\\mathrm{tot}}, p_c, \\alpha) = (3.2, 7.0, 1.0, 2.0)$\n- 在 $p_{\\mathrm{low}}/p_c = 10^{-3}$ 处：\n  $W(p_{\\mathrm{low}}) = 1 - \\exp[-(10^{-3})^2] = 1 - e^{-10^{-6}}$\n  $r_{\\mathrm{eff}}(p_{\\mathrm{low}}) = 3.2 + (7.0 - 3.2)(1 - e^{-10^{-6}}) = 3.2 + 3.8(1 - e^{-10^{-6}}) \\approx 3.2000038$\n  $q_{\\mathrm{low}} = \\frac{3 \\times 3.2000038}{3.2000038 - 1} \\approx 4.363631$\n- 在 $p_{\\mathrm{high}}/p_c = 10^{3}$ 处：\n  $W(p_{\\mathrm{high}}) = 1 - \\exp[-(10^{3})^2] = 1 - e^{-10^{6}} \\approx 1$\n  $r_{\\mathrm{eff}}(p_{\\mathrm{high}}) \\approx 3.2 + 3.8(1) = 7.0$\n  $q_{\\mathrm{high}} = \\frac{3 \\times 7.0}{7.0 - 1} = \\frac{21}{6} = 3.5$\n- $\\Delta = 4.363631 - 3.500000 = 0.863631$\n- 结果 C: $[4.363631, 3.500000, 0.863631]$\n\n在情况A和C中，$\\Delta$ 的正值表示一个凹谱，其中谱指数 $q(p)$ 随着动量 $p$ 的增加而减小，导致能谱在低 $p$ 处更陡（$f(p)$ 下降更快），在高 $p$ 处更平。这是非线性修正激波中高效粒子加速的特征信号。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes momentum-dependent spectral indices for a nonlinear shock model.\n\n    This function calculates the spectral index q(p) at low and high momenta\n    for several test cases of a diffusive shock acceleration model with nonlinear\n    modifications. The model uses a momentum-dependent effective compression\n    ratio.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (r_sub, r_tot, p_c, alpha)\n    test_cases = [\n        (3.5, 6.0, 1.0, 1.0),  # Case A\n        (4.0, 4.0, 1.0, 1.0),  # Case B\n        (3.2, 7.0, 1.0, 2.0),  # Case C\n    ]\n\n    # Diagnostic momentum ratios\n    p_over_pc_low = 1e-3\n    p_over_pc_high = 1e3\n    \n    # Store results for all cases\n    all_results = []\n\n    def calculate_q(p_over_pc, r_sub, r_tot, alpha):\n        \"\"\"\n        Calculates the spectral index q for a given set of parameters.\n\n        Args:\n            p_over_pc (float): The momentum ratio p/p_c.\n            r_sub (float): The subshock compression ratio.\n            r_tot (float): The total compression ratio.\n            alpha (float): The transition sharpness parameter.\n\n        Returns:\n            float: The spectral index q.\n        \"\"\"\n        # Calculate the weighting function W(p)\n        W_p = 1.0 - np.exp(-(p_over_pc**alpha))\n        \n        # Calculate the effective compression ratio r_eff(p)\n        r_eff = r_sub + (r_tot - r_sub) * W_p\n        \n        # Check for r_eff == 1, which leads to division by zero.\n        # Given the problem constraints (r_sub > 1), this should not happen.\n        if r_eff == 1.0:\n            return np.inf\n            \n        # Calculate the spectral index q(r_eff)\n        q_val = (3.0 * r_eff) / (r_eff - 1.0)\n        \n        return q_val\n\n    for case in test_cases:\n        r_sub, r_tot, p_c, alpha = case\n\n        # Calculate q at low momentum\n        q_low = calculate_q(p_over_pc_low, r_sub, r_tot, alpha)\n\n        # Calculate q at high momentum\n        q_high = calculate_q(p_over_pc_high, r_sub, r_tot, alpha)\n\n        # Calculate the difference delta\n        delta = q_low - q_high\n        \n        # Round the results to six decimal places\n        q_low_rounded = round(q_low, 6)\n        q_high_rounded = round(q_high, 6)\n        delta_rounded = round(delta, 6)\n        \n        # Store the triplet of results for the current case\n        all_results.append([q_low_rounded, q_high_rounded, delta_rounded])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list is '[item1, item2, ...]' which matches\n    # the format needed for each sub-list.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}