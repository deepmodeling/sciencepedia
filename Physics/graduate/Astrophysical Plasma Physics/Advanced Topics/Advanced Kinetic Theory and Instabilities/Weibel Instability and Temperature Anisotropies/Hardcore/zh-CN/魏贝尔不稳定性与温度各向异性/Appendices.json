{
    "hands_on_practices": [
        {
            "introduction": "分析任何不稳定性的第一步都是计算其线性增长率。这项练习  提供了一个基础性的实践，要求你从一个经典的场景——具有双麦克斯韦温度各向异性的无磁化、无碰撞等离子体——的色散关系中，推导出韦伯不稳定性的最大增长率。掌握这一计算对于预测在给定的等离子体环境中不稳定性将以多快的速度发展至关重要。",
            "id": "232898",
            "problem": "考虑一个由电子和静止离子组成的无碰撞、无磁化的等离子体。电子由一个各向异性双麦克斯韦速度分布函数描述，其形式如下：\n$$f_{e0}(\\mathbf{v}) = \\frac{n_0}{(2\\pi)^{3/2} v_{tx}^2 v_{tz}} \\exp\\left( -\\frac{v_x^2 + v_y^2}{2v_{tx}^2} - \\frac{v_z^2}{2v_{tz}^2} \\right)$$\n其中 $n_0$ 是平衡电子密度，$v_{tj} = \\sqrt{T_j/m_e}$ 是 $j$ 方向的热速度，$T_j$ 是温度，$m_e$ 是电子质量。我们定义温度各向异性为 $A = T_z/T_x > 1$。\n\n一列电磁波沿 $\\hat{\\mathbf{x}}$ 方向传播，因此其波矢为 $\\mathbf{k} = k\\hat{\\mathbf{x}}$。该波的电场沿 $\\hat{\\mathbf{z}}$ 方向极化，$\\mathbf{E} = E_z \\hat{\\mathbf{z}}$。该波的线性色散关系由下式给出：\n$$ \\omega^2 - k^2c^2 + \\omega_{pe}^2 \\left( A - 1 + A \\frac{\\omega}{\\sqrt{2} k v_{tx}} Z\\left(\\frac{\\omega}{\\sqrt{2} k v_{tx}}\\right) \\right) = 0 $$\n此处，$\\omega$ 是波频率，$c$ 是光速，$\\omega_{pe}$ 是电子等离子体频率，$Z(\\zeta)$ 是等离子体色散函数。\n\n我们感兴趣的是纯增长的Weibel不稳定性，对于这种不稳定性，频率是纯虚数，$\\omega = i\\gamma$，其中 $\\gamma$ 是实值增长率。在弱不稳定性极限下（即，在不稳定性阈值附近的小增长率情况下），关于 $\\gamma$ 的代数方程中与 $\\gamma^2$ 成正比的项可以被忽略。\n\n使用此近似，推导该不稳定性的最大可能增长率 $\\gamma_{max}$ 的表达式。最终答案应以 $\\omega_{pe}$、$A$、$c$ 和 $v_{tx}$ 表示。",
            "solution": "我们从给定的色散关系出发，代入纯增长模式 $\\omega=i\\gamma$（$\\gamma \\in \\mathbb{R}$）。在弱不稳定性极限下，$\\zeta = i\\gamma/(\\sqrt{2}kv_{tx})$ 很小，我们可以使用近似 $Z(\\zeta) \\approx i\\sqrt{\\pi}$。将此代入色散关系得到：\n$$ -\\gamma^2-k^2c^2+\\omega_{pe}^2\\left(A-1+A\\frac{i\\gamma}{\\sqrt{2}kv_{tx}}(i\\sqrt{\\pi})\\right)=0 $$\n$$ \\implies -\\gamma^2-k^2c^2+\\omega_{pe}^2(A-1) - \\frac{A\\omega_{pe}^2\\sqrt{\\pi}}{\\sqrt{2}kv_{tx}}\\gamma=0 $$\n根据题意忽略 $\\gamma^2$ 项，并求解 $\\gamma(k)$：\n$$ \\gamma(k) = \\frac{\\sqrt{2}kv_{tx}}{A\\sqrt{\\pi}\\omega_{pe}^2} \\left( \\omega_{pe}^2(A-1) - k^2c^2 \\right) = \\frac{\\sqrt{2}kv_{tx}}{A\\sqrt{\\pi}} \\left( (A-1) - \\frac{k^2c^2}{\\omega_{pe}^2} \\right) $$\n为求 $γ_{\\max}$，我们令 $\\partial γ/\\partial k=0$：\n$$ \\frac{d}{dk}\\left[k\\left((A-1)-\\alpha k^2\\right)\\right] = A-1 - 3\\alpha k^2=0, \\quad \\text{其中 } \\alpha = \\frac{c^2}{\\omega_{pe}^2} $$\n这给出最大增长率对应的波数：\n$$ k_{\\max}^2=\\frac{A-1}{3\\alpha}=\\frac{\\omega_{pe}^2(A-1)}{3c^2} $$\n将 $k_{\\max}$ 代回 $γ(k)$：\n$$ \\gamma_{\\max} = \\gamma(k_{\\max}) = \\frac{\\sqrt{2}v_{tx}}{A\\sqrt{\\pi}}k_{\\max}\\left((A-1) - \\alpha k_{\\max}^2\\right) $$\n$$ = \\frac{\\sqrt{2}v_{tx}}{A\\sqrt{\\pi}}\\frac{\\omega_{pe}}{c}\\sqrt{\\frac{A-1}{3}}\\left((A-1) - \\frac{A-1}{3}\\right) = \\frac{\\sqrt{2}v_{tx}}{A\\sqrt{\\pi}}\\frac{\\omega_{pe}}{c}\\sqrt{\\frac{A-1}{3}}\\frac{2(A-1)}{3} $$\n$$ =\\frac{2\\sqrt2}{3A\\sqrt{3\\pi}}\\;\\frac{\\omega_{pe}\\,v_{tx}}{c}\\;(A-1)^{3/2} $$",
            "answer": "$$\\boxed{\\frac{2\\sqrt2}{3A\\sqrt{3\\pi}}\\;\\frac{\\omega_{pe}\\,v_{tx}}{c}\\;(A-1)^{3/2}}$$"
        },
        {
            "introduction": "线性理论只描述了初期的指数增长，但什么会最终阻止不稳定性呢？这项实践  深入探讨了准线性机制，在这一阶段，增长的磁场开始散射粒子，从而减小了驱动不稳定性的温度各向异性。通过一个简化但物理上合理的模型，你将估算从各向异性自由能转换成磁能的比例，从而深入了解不稳定性的饱和过程及其产生磁场的效率。",
            "id": "4235565",
            "problem": "考虑一个代表簇内介质的无碰撞、均匀、非相对论的电子-质子等离子体斑，其初始磁化较弱，以至于电磁涨落由电子温度各向异性驱动的韦伯不稳定性主导。设电子分布为双麦克斯韦分布，其垂直和平行温度分别用 $T_{\\perp}$ 和 $T_{\\parallel}$ 表示，并定义无量纲各向异性参数 $A \\equiv T_{\\perp}/T_{\\parallel} - 1$。假设初始时 $A>0$ 且 $A \\ll 1$。关注固定波数 $k$ 下的主导不稳定横向模。\n\n随着韦伯不稳定性的增长，磁能密度 $W_{B} \\equiv B^{2}/(2\\mu_{0})$ 以消耗各向异性为代价而增加，且由自生磁涨落引起的投掷角散射将 $A$ 减小到所选模式的一个临界稳定值 $A_{c}>0$。在线性阶段，磁涨落振幅呈指数增长，因此磁能密度满足 $\\mathrm{d}W_{B}/\\mathrm{d}t = 2\\,\\gamma(A)\\,W_{B}$，其中 $\\gamma(A)$ 是在当前各向异性下计算的瞬时线性增长率。对于固定的 $k$，在临界稳定点附近，增长率随与阈值的距离线性变化，因此可以将 $\\gamma(A)$ 建模为 $\\gamma(A) = \\gamma_{0}\\,(A - A_{c})$，其中 $\\gamma_{0}>0$ 是一个取决于 $k$ 和等离子体参数但与 $A$ 无关的常数。在准线性区域，弛豫各向异性的投掷角散射率与涨落能量和与阈值的距离均成正比，因此可以将各向异性的演化建模为 $\\mathrm{d}A/\\mathrm{d}t = -\\Lambda\\,(A - A_{c})\\,W_{B}$，其中 $\\Lambda>0$ 是一个常数。\n\n从 $A(0)=A_{0}$ 和 $W_{B}(0)\\approx 0$ 出发，并假设上述准线性闭合关系在整个弛豫过程中直到 $A$ 达到 $A_{c}$ 时都有效，推导出一个封闭形式的表达式，表示当 $A$ 达到 $A_{c}$ 时，初始各向异性自由能中转化为磁能的分数 $f$。为了本次计算的目的，将“初始各向异性自由能”操作性地定义为：在相同的闭合关系下，如果各向异性完全弛豫到 $A=0$，所产生的磁能。\n\n用 $A_{0}$ 和 $A_{c}$ 表示您的最终答案，形式为一个简化的解析表达式。不需要进行数值计算，最终表达式中不应包含单位。",
            "solution": "我们从线性不稳定性能力增长和准线性弛豫的假设开始。磁能密度 $W_{B}$ 随场振幅的平方增长，对于一个瞬时增长率为 $\\gamma(A)$ 的模式，这意味着\n$$\n\\frac{\\mathrm{d}W_{B}}{\\mathrm{d}t} = 2\\,\\gamma(A)\\,W_{B}.\n$$\n在固定波数 $k$ 的阈值附近，增长率线性地依赖于与临界稳定点的距离，因此我们取\n$$\n\\gamma(A) = \\gamma_{0}\\,(A - A_{c}),\n$$\n其中 $\\gamma_{0}>0$ 和 $A_{c}>0$ 是所选模式和等离子体参数的常数。准线性投掷角散射使各向异性减小的量与涨落能量和与阈值的距离均成正比，我们将其表示为\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = -\\Lambda\\,(A - A_{c})\\,W_{B},\n$$\n其中 $\\Lambda>0$ 是一个常数。这些是标准的近阈值闭合关系，与增长和弛豫在临界稳定点都消失的观点相符。\n\n我们可以通过构建比值 $\\mathrm{d}A/\\mathrm{d}W_{B}$ 来消除显式的时间依赖：\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}W_{B}} = \\frac{\\frac{\\mathrm{d}A}{\\mathrm{d}t}}{\\frac{\\mathrm{d}W_{B}}{\\mathrm{d}t}} = \\frac{-\\Lambda\\,(A - A_{c})\\,W_{B}}{2\\,\\gamma_{0}\\,(A - A_{c})\\,W_{B}} = -\\frac{\\Lambda}{2\\,\\gamma_{0}}.\n$$\n值得注意的是，对 $(A - A_{c})$ 和 $W_{B}$ 的依赖性相互抵消，从而得到 $A$ 和 $W_{B}$ 之间的一个常数关系。从初始状态 $(A_{0},W_{B}=0)$ 积分到一般状态 $(A,W_{B})$，得到\n$$\n\\int_{A_{0}}^{A} \\mathrm{d}A' = -\\frac{\\Lambda}{2\\,\\gamma_{0}} \\int_{0}^{W_{B}} \\mathrm{d}W_{B}',\n$$\n所以\n$$\nA - A_{0} = -\\frac{\\Lambda}{2\\,\\gamma_{0}} W_{B}.\n$$\n将 $W_{B}$ 解为 $A$ 的函数，\n$$\nW_{B}(A) = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - A).\n$$\n\n在各向异性达到临界稳定性的时刻，即 $A = A_{c}$ 时，饱和磁能密度因此为\n$$\nW_{B,\\mathrm{sat}} = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - A_{c}).\n$$\n根据问题陈述中的操作性定义，“初始各向异性自由能”是在相同的闭合关系下，如果各向异性完全弛豫到 $A=0$ 时将产生的磁能，即\n$$\nW_{B,\\mathrm{max}} = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - 0) = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,A_{0}.\n$$\n因此，当达到临界稳定性时，初始各向异性自由能中转化为磁能的分数 $f$ 是\n$$\nf \\equiv \\frac{W_{B,\\mathrm{sat}}}{W_{B,\\mathrm{max}}} = \\frac{\\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - A_{c})}{\\frac{2\\,\\gamma_{0}}{\\Lambda}\\,A_{0}} = 1 - \\frac{A_{c}}{A_{0}}.\n$$\n\n这个表达式是无量纲的，并且独立于闭合系数 $\\gamma_{0}$ 和 $\\Lambda$，这反映了一个事实：在所假设的近阈值准线性动力学下，该分数仅由系统被驱动到临界稳定性的程度相对于完全各向同性化的程度决定。该推导依赖于两个经过充分检验的基础：线性不稳定性中模式振幅的指数增长，以及当系统接近临界稳定性时减弱的准线性投掷角散射。",
            "answer": "$$\\boxed{1 - \\frac{A_{c}}{A_{0}}}$$"
        },
        {
            "introduction": "将理论模型与观测或模拟数据联系起来是天体物理学中的一项关键技能。这项练习  让你扮演一名计算科学家的角色，通过分析等离子体压力和磁场的时间序列合成数据来检验理论。你将开发一种方法来测量各向异性弛豫的速率，并将其与磁能的增长相关联，从而有效地验证前一个练习  中探讨的磁场介导的弛豫物理模型。",
            "id": "4235574",
            "problem": "考虑一个在弗拉索夫-麦克斯韦系统下演化的无碰撞、均匀的天体物理等离子体。令 $f(\\mathbf{x},\\mathbf{v},t)$ 表示单粒子分布函数，压力张量定义为 $f$ 的二阶速度矩，即 $P_{ij}(t) = m \\int v_i v_j f(\\mathbf{v},t)\\, d^3 v$，该计算在一个梯度可忽略的空间域上进行。假设一个模拟提供了压力张量的对角分量 $P_{xx}(t)$、$P_{yy}(t)$、$P_{zz}(t)$ 和磁场分量 $B_x(t)$、$B_y(t)$、$B_z(t)$ 的时间序列，这些数据是以均匀的时间间隔采样的。假设各向异性是相对于 $z$ 方向定义的，平行压力为 $P_{\\parallel}(t) = P_{zz}(t)$，垂直压力为 $P_{\\perp}(t) = \\left(P_{xx}(t) + P_{yy}(t)\\right)/2$。定义各向异性参数 $R(t) = P_{\\perp}(t)/P_{\\parallel}(t) - 1$。令磁能密度为 $U_B(t) = \\left(B_x^2(t) + B_y^2(t) + B_z^2(t)\\right)/(2 \\mu_0)$，其中 $\\mu_0$ 是国际单位制（SI）中的真空磁导率，其值为 $\\mu_0 = 4 \\pi \\times 10^{-7} \\, \\mathrm{N/A^2}$。令瞬时磁能增长率为 $\\gamma_B(t) = \\left(1/U_B(t)\\right) \\, dU_B/dt$。\n\n您需要提出、实现并应用一种有原则的方法，通过跟踪压力张量并将其与磁能增长相关联，来测量各向异性弛豫率。您的方法必须从第一性原理出发，并且只使用经过充分检验的定义（不允许在没有推导的情况下假设使用任何快捷公式）。您的程序必须：\n\n- 从提供的 $P_{ij}(t)$ 时间序列构建 $R(t)$。\n- 使用与离散采样一致的有限差分法，从离散数据中估计 $dR/dt$ 和 $dU_B/dt$。\n- 从 $U_B(t)$ 及其时间导数构建 $\\gamma_B(t)$。\n- 通过估计一个无量纲比例系数 $k$ 来量化各向异性弛豫与磁能增长之间的关系，该系数基于一个不含截距项的回归模型，捕捉了弛豫率如何随 $\\gamma_B(t)$ 变化的规律。然后，在所提供的时间窗口内，根据所提出的磁介导弛豫模型，计算以 $\\mathrm{s}^{-1}$ 为单位的平均弛豫率 $\\overline{\\nu}$。\n\n使用以下合成案例的测试套件，每个案例都由显式参数定义以生成时间序列。在所有案例中，时间单位必须为 $\\mathrm{s}$，压力单位为 $\\mathrm{Pa}$，磁场单位为 $\\mathrm{T}$，真空磁导率单位为 $\\mathrm{N/A^2}$。令 $t_n = n \\Delta t$，其中 $n = 0, 1, \\dots, N-1$。\n\n- 测试案例 1（理想路径，恒定指数磁增长）：$N = 101$，$\\Delta t = 0.05$， $B_0 = 10^{-9}$，$s = 1.0$，$k_{\\mathrm{true}} = 0.3$，$R_0 = 0.5$，$P_0 = 10^{-9}$。磁场大小遵循 $|\\mathbf{B}(t)| = B_0 \\exp(s t)$，且 $\\mathbf{B}(t) = (|\\mathbf{B}(t)|, 0, 0)$。此选择所隐含的磁能增长率在时间上是恒定的。各向异性 $R(t)$ 被选择为一个衰减函数，与区间内的磁介导弛豫一致。压力由 $P_{zz}(t) = P_0$ 和 $P_{xx}(t) = P_{yy}(t) = P_0 \\left(1 + R(t)\\right)$ 构建。\n\n- 测试案例 2（边界情况，无磁增长）：$N = 101$，$\\Delta t = 0.05$，$B_0 = 10^{-9}$，$\\mathbf{B}(t) = (B_0, 0, 0)$，$R_0 = 0.5$，$P_0 = 10^{-9}$。各向异性 $R(t)$ 是一个随时间衰减的函数，且与磁能增长无关。压力按上述方式构建。\n\n- 测试案例 3（边缘情况，有磁增长但各向异性恒定）：$N = 101$，$\\Delta t = 0.05$，$B_0 = 10^{-9}$，$s = 0.8$，$R_0 = 0.3$，$P_0 = 10^{-9}$。磁场大小遵循 $|\\mathbf{B}(t)| = B_0 \\exp(s t)$，且 $\\mathbf{B}(t) = (|\\mathbf{B}(t)|, 0, 0)$。各向异性 $R(t)$ 在时间上是恒定的。压力按上述方式构建。\n\n- 测试案例 4（可变磁增长）：$N = 101$，$\\Delta t = 0.05$，$B_0 = 10^{-9}$，$a = 0.4$，$k_{\\mathrm{true}} = 0.5$，$R_0 = 0.4$，$P_0 = 10^{-9}$。磁场大小遵循 $|\\mathbf{B}(t)| = B_0 (1 + a t)$，且 $\\mathbf{B}(t) = (|\\mathbf{B}(t)|, 0, 0)$。各向异性 $R(t)$ 是一个由累积磁能增长决定的衰减函数，其方式与磁介导弛豫一致。压力按上述方式构建。\n\n实现要求：\n\n- 使用适用于均匀采样数据的有限差分法来估计 $dR/dt$ 和 $dU_B/dt$。\n- 通过处理 $U_B(t)$ 极小的点来确保数值鲁棒性，以避免在计算 $\\gamma_B(t)$ 时出现除以零的错误。\n- 通过一个不含截距项的最小二乘拟合来估计无量纲比例系数 $k$，该拟合关联了 $R(t)$ 的变化率与 $R(t)$ 和磁能增长信息的乘积。然后，在采样区间内，根据所提出的磁介导弛豫模型，计算以 $\\mathrm{s}^{-1}$ 为单位的时间平均值 $\\overline{\\nu}$。\n\n最终输出规范：\n\n- 对于每个测试案例，您的程序必须输出一个包含两个浮点数的列表：$[k_{\\mathrm{est}}, \\overline{\\nu}]$，其中 $k_{\\mathrm{est}}$ 是无量纲的，$\\overline{\\nu}$ 必须以 $\\mathrm{s}^{-1}$ 为单位表示为十进制数。\n- 您的程序应生成单行输出，其中包含所有测试案例的结果，格式为用方括号括起来的逗号分隔列表，例如 $[[k_1, \\nu_1],[k_2, \\nu_2],[k_3, \\nu_3],[k_4, \\nu_4]]$。\n\n所有数学构造必须在国际单位制（SI）下进行解释，本问题不需要角度。输出必须是数值浮点数；不要包含任何百分号。您的算法和程序必须具有足够的通用性，能够处理任何与上述定义一致的 $P_{ij}(t)$ 和 $\\mathbf{B}(t)$ 的均匀采样输入时间序列，同时必须使用此处提供的测试套件来生成最终的单行输出。",
            "solution": "该问题要求开发并实现一种方法，用于量化无碰撞等离子体中压力各向异性弛豫与磁能增长之间的关系。分析将在压力张量和磁场分量的合成时间序列数据上进行。\n\n首先，从提供的数据中定义主要的物理量。压力各向异性参数 $R(t)$ 是相对于 $z$ 方向定义的，\n$$R(t) = \\frac{P_{\\perp}(t)}{P_{\\parallel}(t)} - 1$$\n其中 $P_{\\parallel}(t) = P_{zz}(t)$ 是平行压力，$P_{\\perp}(t) = \\frac{1}{2}(P_{xx}(t) + P_{yy}(t))$ 是垂直压力。\n\n磁能密度由下式给出\n$$U_B(t) = \\frac{B_x^2(t) + B_y^2(t) + B_z^2(t)}{2 \\mu_0}$$\n其中 $\\mu_0 = 4\\pi \\times 10^{-7} \\, \\mathrm{N/A^2}$ 是真空磁导率。\n\n磁能的瞬时增长率定义为 $U_B(t)$ 的对数时间导数：\n$$\\gamma_B(t) = \\frac{1}{U_B(t)} \\frac{dU_B(t)}{dt}$$\n\n问题的核心是建立一个量化模型，将以 $\\frac{dR}{dt}$ 为特征的各向异性弛豫与以 $\\gamma_B(t)$ 为特征的磁场增长联系起来。在许多等离子体系统中，由压力各向异性驱动的不稳定性（例如韦伯不稳定性）将粒子分布中的自由能转换成磁场能量。这个过程反过来又减少了各向异性，起到弛豫机制的作用。对于这个反馈回路，一个合理的、基于第一性原理的模型是，各向异性的变化率与各向异性的大小本身（不稳定性的“燃料”）以及磁场的增长率（不稳定性的“效应”）成正比。我们可以将此关系形式化为：\n$$\\frac{dR(t)}{dt} = -k \\cdot R(t) \\cdot \\gamma_B(t)$$\n此处，$k$ 是一个无量纲正常数，量化了由磁场增长介导的各向异性弛豫的效率。负号确保了当磁场增长时（$\\gamma_B(t) > 0$），正的各向异性（$R(t) > 0$）会随时间衰减（$\\frac{dR}{dt}  0$）。\n\n任务是从离散时间序列数据中估计这个系数 $k$。给定在离散时间点 $t_n = n \\Delta t$ 的时间序列 $R_n = R(t_n)$ 和 $\\gamma_{B,n} = \\gamma_B(t_n)$，我们必须首先从采样数据中估计时间导数。我们使用有限差分近似。对于一个离散函数 $g_n$，其导数可以使用中心差分格式来估计，该格式具有二阶精度：\n$$\\left(\\frac{dg}{dt}\\right)_n \\approx \\frac{g_{n+1} - g_{n-1}}{2 \\Delta t}$$\n此方法适用于时间序列的所有内部点。`numpy.gradient` 函数提供了一个方便的实现，它对内部点使用中心差分，对边界点使用精度较低的单边差分，生成一个与输入长度相同的导数数组。我们将用它来计算 $\\frac{dR}{dt}$ 和 $\\frac{dU_B}{dt}$。\n\n该模型方程可以为每个离散时间点写为 $y_n = k x_n$，其中因变量是 $y_n = \\left(\\frac{dR}{dt}\\right)_n$，自变量是 $x_n = -R_n \\gamma_{B,n}$。问题指定了一个不含截距项的回归。为了找到 $k$ 的最优值，我们使用最小二乘法，该方法最小化残差平方和 $S(k) = \\sum_n (y_n - k x_n)^2$。将 $S$ 对 $k$ 的导数设为零，得到估计量：\n$$k_{\\mathrm{est}} = \\frac{\\sum_n x_n y_n}{\\sum_n x_n^2} = \\frac{\\sum_n \\left(-R_n \\gamma_{B,n}\\right) \\left(\\frac{dR}{dt}\\right)_n}{\\sum_n \\left(-R_n \\gamma_{B,n}\\right)^2}$$\n求和是在所有量都有明确定义的时间索引上进行的。具体来说，我们必须排除 $U_B(t)$ 为零或接近零的点，以避免在计算 $\\gamma_B(t)$ 时出现除以零的错误。\n\n一旦确定了 $k_{\\mathrm{est}}$，我们被要求找到以 $\\mathrm{s}^{-1}$ 为单位的平均弛豫率 $\\overline{\\nu}$。在我们的模型中，瞬时弛豫率为 $\\nu(t) = k_{\\mathrm{est}} \\gamma_B(t)$。因此，在有效时间区间内的平均速率是该量的时间平均值：\n$$\\overline{\\nu} = k_{\\mathrm{est}} \\cdot \\overline{\\gamma_B} = k_{\\mathrm{est}} \\left( \\frac{1}{M} \\sum_{n \\in \\text{valid}} \\gamma_{B,n} \\right)$$\n其中 $M$ 是回归中使用的有效数据点的数量。\n\n合成测试案例是基于与所测试物理过程一致的 $|\\mathbf{B}(t)|$ 和 $R(t)$ 的特定解析形式构建的。\n- **案例 1**：指数磁增长， $|\\mathbf{B}(t)| = B_0 e^{st}$，意味着一个恒定的 $\\gamma_B(t) = 2s$。各向异性 $R(t)$ 被设计为根据模型衰减，得到 $R(t) = R_0 \\exp(-2sk_{\\mathrm{true}}t)$。分析应能恢复出 $k_{\\mathrm{est}} \\approx k_{\\mathrm{true}}$。\n- **案例 2**：恒定磁场，意味着 $\\gamma_B(t) = 0$。回归中的自变量 $x_n = -R_n \\gamma_{B,n}$ 恒等于零。分母 $\\sum x_n^2$ 为零，意味着无法建立相关性。在这种情况下，$k_{\\mathrm{est}}$ 必须定义为 $0$。\n- **案例 3**：指数磁增长但各向异性恒定，$R(t) = R_0$。这意味着 $\\frac{dR}{dt} = 0$。回归中的因变量 $y_n = (\\frac{dR}{dt})_n$ 恒等于零。分子 $\\sum x_n y_n$ 为零，得出 $k_{\\mathrm{est}} = 0$。\n- **案例 4**：代数磁增长，$|\\mathbf{B}(t)| = B_0(1+at)$，意味着一个时变的 $\\gamma_B(t) = \\frac{2a}{1+at}$。各向异性被设定为与模型一致地衰减：$R(t) = R_0 (1+at)^{-2k_{\\mathrm{true}}}$。分析应能再次恢复出 $k_{\\mathrm{est}} \\approx k_{\\mathrm{true}}$。\n\n这种从第一性原理建模到鲁棒数值实现的综合方法，能够准确确定每个测试案例所需的参数 $k_{\\mathrm{est}}$ 和 $\\overline{\\nu}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and print the results.\n    \"\"\"\n    \n    # Define the constant for vacuum permeability in SI units\n    MU0 = 4 * np.pi * 1e-7\n\n    def process_case(N, dt, B_t_func, R_t_func, P0):\n        \"\"\"\n        Processes a single test case to find k_est and nu_bar.\n\n        Args:\n            N (int): Number of time steps.\n            dt (float): Time step size in seconds.\n            B_t_func (callable): Function that returns magnetic field magnitude |B(t)|.\n            R_t_func (callable): Function that returns anisotropy parameter R(t).\n            P0 (float): Base pressure in Pascals.\n\n        Returns:\n            list: A list containing the estimated k [dimensionless] and nu_bar [s^-1].\n        \"\"\"\n        # Generate time array\n        t = np.arange(N) * dt\n\n        # Generate magnetic field components. As specified, B is along x-axis.\n        B_mag = B_t_func(t)\n        Bx = B_mag\n        By = np.zeros_like(t)\n        Bz = np.zeros_like(t)\n\n        # Calculate magnetic energy density and its time derivative\n        UB = (Bx**2 + By**2 + Bz**2) / (2 * MU0)\n        dUB_dt = np.gradient(UB, dt)\n\n        # To avoid division by zero or large errors, define a mask for valid UB\n        # points. A small number epsilon is used as a threshold.\n        epsilon = 1e-30\n        valid_mask = UB > epsilon\n        \n        # Calculate magnetic energy growth rate gamma_B only for valid points\n        gamma_B = np.zeros_like(t)\n        gamma_B[valid_mask] = dUB_dt[valid_mask] / UB[valid_mask]\n\n        # Generate anisotropy parameter R(t) and its time derivative\n        R = R_t_func(t)\n        dR_dt = np.gradient(R, dt)\n\n        # The pressure components can be constructed but are not directly needed\n        # since R(t) is generated directly.\n        # P_zz = np.full_like(t, P0)\n        # P_xx = P_yy = P0 * (1 + R)\n\n        # Perform regression to find the dimensionless coefficient k.\n        # The model is: dR/dt = -k * R * gamma_B\n        # This is a linear regression y = k*x with no intercept, where:\n        # y = dR/dt\n        # x = -R * gamma_B\n        y_valid = dR_dt[valid_mask]\n        x_valid = -R[valid_mask] * gamma_B[valid_mask]\n\n        sum_x_squared = np.sum(x_valid**2)\n        \n        # If the denominator is close to zero, no meaningful k can be found.\n        if sum_x_squared  epsilon:\n            k_est = 0.0\n        else:\n            sum_xy = np.sum(x_valid * y_valid)\n            k_est = sum_xy / sum_x_squared\n\n        # Calculate the average relaxation rate nu_bar.\n        # The instantaneous rate is nu(t) = k * gamma_B(t).\n        # We average this over the valid time points.\n        gamma_B_valid = gamma_B[valid_mask]\n        if len(gamma_B_valid) > 0:\n            mean_gamma_B = np.mean(gamma_B_valid)\n            nu_bar = k_est * mean_gamma_B\n        else:\n            nu_bar = 0.0\n\n        return [k_est, nu_bar]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path): Exponential magnetic growth\n        {'name': 'case1', 'params': {'N': 101, 'dt': 0.05, 'B0': 1e-9, 's': 1.0, 'k_true': 0.3, 'R0': 0.5, 'P0': 1e-9}},\n        # Case 2 (boundary): No magnetic growth\n        {'name': 'case2', 'params': {'N': 101, 'dt': 0.05, 'B0': 1e-9, 'R0': 0.5, 'P0': 1e-9}},\n        # Case 3 (edge): Constant anisotropy with magnetic growth\n        {'name': 'case3', 'params': {'N': 101, 'dt': 0.05, 'B0': 1e-9, 's': 0.8, 'R0': 0.3, 'P0': 1e-9}},\n        # Case 4 (variable growth): Algebraic magnetic growth\n        {'name': 'case4', 'params': {'N': 101, 'dt': 0.05, 'B0': 1e-9, 'a': 0.4, 'k_true': 0.5, 'R0': 0.4, 'P0': 1e-9}},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p = case['params']\n        N, dt, P0 = p['N'], p['dt'], p['P0']\n        \n        if case['name'] == 'case1':\n            B_t_func = lambda t: p['B0'] * np.exp(p['s'] * t)\n            # R(t) derived from dR/dt = -k R gamma_B, where gamma_B = 2s\n            R_t_func = lambda t: p['R0'] * np.exp(-2 * p['s'] * p['k_true'] * t)\n        \n        elif case['name'] == 'case2':\n            B_t_func = lambda t: np.full_like(t, p['B0'])\n            # R(t) decays independently of B; any simple decay works for the test.\n            # Using alpha = 1.0 for R(t) = R0 * exp(-alpha * t)\n            R_t_func = lambda t: p['R0'] * np.exp(-1.0 * t)\n            \n        elif case['name'] == 'case3':\n            B_t_func = lambda t: p['B0'] * np.exp(p['s'] * t)\n            # R(t) is constant\n            R_t_func = lambda t: np.full_like(t, p['R0'])\n            \n        elif case['name'] == 'case4':\n            B_t_func = lambda t: p['B0'] * (1 + p['a'] * t)\n            # R(t) derived from dR/dt = -k R gamma_B, where gamma_B = 2a/(1+at)\n            R_t_func = lambda t: p['R0'] * (1 + p['a'] * t)**(-2 * p['k_true'])\n\n        result = process_case(N, dt, B_t_func, R_t_func, P0)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[[{results[0][0]},{results[0][1]}],[{results[1][0]},{results[1][1]}],[{results[2][0]},{results[2][1]}],[{results[3][0]},{results[3][1]}]]\")\n\nsolve()\n```"
        }
    ]
}