{
    "hands_on_practices": [
        {
            "introduction": "在深入研究准线性扩散的数学求解之前，我们必须首先理解其物理内涵。福克-普朗克方程描述了粒子在速度空间中的概率性漂移和扩散，而其解的具体形式强烈依赖于我们施加的边界条件。这个练习  旨在阐明速度空间通量的概念，并指导你如何根据物理原则——例如粒子数守恒或粒子逃逸——来设定合理的边界条件。",
            "id": "4225198",
            "problem": "考虑一个空间均匀、各向同性的天体物理等离子体，其中共振的波-粒子相互作用在速度空间中产生准线性扩散。设各向同性分布函数为 $f(v,t)$，其中 $v$ 是粒子速率，$t$ 是时间。在准线性理论的随机相位、弱湍流极限下，$f$ 的各向同性速度空间演化可以用以下形式的 Fokker–Planck 方程来模拟：\n$$\n\\frac{\\partial f}{\\partial t} \\;=\\; \\frac{1}{v^{2}}\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right],\n$$\n其中 $D(v)>0$ 是一个由湍流波谱决定的光滑扩散系数。定义有界速率域 $v\\in[0,v_{\\mathrm{esc}}]$ 内的总粒子数为\n$$\nN(t)\\;=\\;\\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,f(v,t)\\,dv,\n$$\n并假设在 $0",
            "solution": "各向同性粒子分布函数 $f(v,t)$ 的演化由 Fokker-Planck 方程控制：\n$$\n\\frac{\\partial f}{\\partial t} \\;=\\; \\frac{1}{v^{2}}\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]\n$$\n其中 $v$ 是粒子速率，$t$ 是时间，$D(v)$ 是扩散系数。域为 $v \\in [0, v_{\\mathrm{esc}}]$。\n\n该域内的总粒子数 $N(t)$ 由下式给出：\n$$\nN(t)\\;=\\;\\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,f(v,t)\\,dv\n$$\n为了找到与物理约束一致的边界条件，我们必须首先将 $N(t)$ 的变化率与控制方程联系起来。我们将 $N(t)$ 对时间求导：\n$$\n\\frac{dN}{dt} = \\frac{d}{dt} \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,f(v,t)\\,dv\n$$\n由于积分限是常数，时间导数可以移到积分内部：\n$$\n\\frac{dN}{dt} = \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,\\frac{\\partial f}{\\partial t}\\,dv\n$$\n将 $\\frac{\\partial f}{\\partial t}$ 的 Fokker–Planck 方程代入：\n$$\n\\frac{dN}{dt} = \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,\\left(\\frac{1}{v^{2}}\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]\\right)\\,dv\n$$\n$v^2$ 项相互抵消，剩下：\n$$\n\\frac{dN}{dt} = \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]\\,dv\n$$\n使用微积分基本定理计算全导数的积分：\n$$\n\\frac{dN}{dt} = 4\\pi\\,\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]_{v=0}^{v=v_{\\mathrm{esc}}} = 4\\pi \\left( \\left. v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}} - \\lim_{v\\to 0} \\left[ v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right] \\right)\n$$\n这个方程代表了整体的粒子数平衡。\n\n速度空间中的粒子通量 $\\Phi(v,t)$ 是粒子穿过半径为 $v$ 的球面的速率。它与扩散流 $J_v = -D(v) \\frac{\\partial f}{\\partial v}$ 的关系定义为 $\\Phi(v,t) = 4\\pi v^2 J_v$。所以，\n$$\n\\Phi(v,t) = -4\\pi\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\n$$\n用这个通量表示，粒子数的变化率是：\n$$\n\\frac{dN}{dt} = - \\left( \\Phi(v_{\\mathrm{esc}},t) - \\Phi(0,t) \\right)\n$$\n其中 $\\Phi(0,t) = \\lim_{v\\to 0} \\Phi(v,t)$。这个方程表明，粒子数的变化是在 $v=0$ 处流入该域的通量减去在 $v=v_{\\mathrm{esc}}$ 处流出该域的通量。\n\n现在，我们应用问题中给出的物理条件。\n\n1.  **在 $v=0$ 处的正则性和各向同性（原点无源或汇）：** 速度空间的原点 $v=0$ 不是一个特殊的粒子源或汇。这意味着原点处的粒子通量必须为零：$\\Phi(0,t) = 0$。在数学上：\n    $$\n    \\lim_{v\\to 0} \\left( -4\\pi\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right) = 0\n    $$\n    对于在原点处各向同性且正则（光滑）的分布函数，其在 $v$ 中的泰勒级数展开只能包含偶次幂，即 $f(v,t) = a_0(t) + a_2(t)v^2 + O(v^4)$。这意味着关于 $v$ 的导数在原点处为零：\n    $$\n    \\left.\\frac{\\partial f}{\\partial v}\\right|_{v=0} = 0\n    $$\n    这个条件足以保证原点处的通量为零，因为 $D(v)$ 是光滑的，因此在 $v=0$ 处是有限的。\n\n2.  **在 $v=v_{\\mathrm{esc}}$ 处的指定逃逸通量：** 问题指出，在边界 $v=v_{\\mathrm{esc}}$ 处存在一个恒定的向外粒子通量 $\\Phi_{\\mathrm{esc}} > 0$。这意味着此边界处的通量必须等于 $\\Phi_{\\mathrm{esc}}$：\n    $$\n    \\Phi(v_{\\mathrm{esc}},t) = \\Phi_{\\mathrm{esc}}\n    $$\n    代入通量的定义，我们得到在 $v=v_{\\mathrm{esc}}$ 处的边界条件：\n    $$\n    -\\,4\\pi\\,v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}} = \\Phi_{\\mathrm{esc}}\n    $$\n\n3.  **与 $dN/dt = -\\Phi_{\\mathrm{esc}}$ 的一致性：** 让我们检查我们推导出的边界条件是否与整体粒子平衡一致。在 $dN/dt$ 的方程中使用我们的边界条件 $\\Phi(0,t)=0$ 和 $\\Phi(v_{\\mathrm{esc}},t)=\\Phi_{\\mathrm{esc}}$：\n    $$\n    \\frac{dN}{dt} = - (\\Phi_{\\mathrm{esc}} - 0) = -\\Phi_{\\mathrm{esc}}\n    $$\n    这与问题中给出的条件完全匹配。\n\n所以，两个物理上一致的边界条件是：\n- 在 $v=0$ 处：$\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}=0$\n- 在 $v=v_{\\mathrm{esc}}$ 处：$-\\,4\\pi\\,v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}} = \\Phi_{\\mathrm{esc}}$\n\n现在我们评估给定的选项。\n\n**A. Dirichlet 条件 $f(0,t)=0$ 和 $f(v_{\\mathrm{esc}},t)=0$。**\n条件 $f(v_{\\mathrm{esc}},t)=0$ 是一个吸收边界条件。它不直接强制一个恒定的通量 $\\Phi_{\\mathrm{esc}}$。通量将取决于边界处的梯度 $\\partial f / \\partial v$，而这个梯度是由解本身决定的，不保证是恒定的。条件 $f(0,t)=0$ 不是正则性所要求的，并且如果 $\\partial f/\\partial v|_{v=0} > 0$，它可能意味着在原点有一个源，这与无源条件相矛盾。**不正确**。\n\n**B. 通过 $\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}=0$ 保证原点的正则性，以及在逃逸边界处的通量边界条件，**\n$$\n-\\,4\\pi\\,v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;\\Phi_{\\mathrm{esc}}.\n$$\n在 $v=0$ 处的条件正确地代表了原点的正则性和无通量要求。在 $v=v_{\\mathrm{esc}}$ 处的条件是粒子通量等于指定的常数 $\\Phi_{\\mathrm{esc}}$ 的数学陈述。这些正是从第一性原理推导出的条件。**正确**。\n\n**C. 两端均为无通量（反射）条件，**\n$$\n\\lim_{v\\to 0}\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\;=\\;0,\\qquad v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;0.\n$$\n在 $v=0$ 处的条件是一个有效的无通量条件。然而，在 $v=v_{\\mathrm{esc}}$ 处的条件意味着逃逸边界处的通量为零，即 $\\Phi(v_{\\mathrm{esc}},t)=0$。这是一个反射边界，它会使域内的粒子数守恒 ($dN/dt = 0$)。这与问题陈述中粒子以通量 $\\Phi_{\\mathrm{esc}}>0$ 逃逸且 $dN/dt = -\\Phi_{\\mathrm{esc}}$ 的情况相矛盾。**不正确**。\n\n**D. 在逃逸边界处的辐射型边界条件，**\n$$\n-\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;\\alpha\\,f(v_{\\mathrm{esc}},t),\\quad \\alpha>0,\n$$\n**并且在原点处有有限但非零的斜率，$\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}\\neq 0$。**\n在原点处的非零斜率 $\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=0}\\neq 0$ 违反了各向同性分布的正则性条件，意味着在 $v=0$ 处有一个尖点。这通常会导致在原点有一个源或汇，而这是被禁止的。在 $v=v_{\\mathrm{esc}}$ 处的辐射型条件意味着通量为 $\\Phi(v_{\\mathrm{esc}},t) = 4\\pi v_{\\mathrm{esc}}^2 \\alpha f(v_{\\mathrm{esc}},t)$。为了使这个通量成为一个常数 $\\Phi_{\\mathrm{esc}}$，$f(v_{\\mathrm{esc}},t)$ 将必须是常数，而这对于一个随时间演化的系统来说通常是不成立的。这个条件并不强制一个恒定的逃逸通量。**不正确**。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "准线性扩散的一个核心作用是驱动等离子体趋向热力学平衡。在许多天体物理环境中，如太阳风，粒子分布函数呈现出温度各向异性。这个练习  将引导你通过解析计算，从动理学方程出发，推导温度各向异性在纯粹的投掷角散射作用下的弛豫速率，从而深刻理解波-粒相互作用如何消除等离子体中的自由能。",
            "id": "4225161",
            "problem": "一个空间均匀的磁化质子等离子体，具有均匀背景磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$，其中弥漫着一系列小振幅、随机相位、沿磁场方向传播的离子回旋波和阿尔芬波。在准线性 (QL) 极限下，假设波-粒子相互作用在速度大小 $v$ 不变的情况下产生投掷角扩散，且能量扩散可忽略不计，因此质子分布函数 $f(v,\\mu,t)$ 的速度空间动理学方程可简化为关于投掷角余弦 $\\mu \\equiv v_{\\parallel}/v$ 的一维福克-普朗克形式，\n$$\n\\frac{\\partial f}{\\partial t} \\;=\\; D_{0}\\,\\frac{\\partial}{\\partial \\mu}\\!\\left[\\left(1-\\mu^{2}\\right)\\,\\frac{\\partial f}{\\partial \\mu}\\right],\n$$\n其中 $D_{0}$ 是由波谱和共振条件决定的正常数。$t=0$ 时的初始分布是一个各向异性的麦克斯韦分布（双麦克斯韦分布），\n$$\nf_{0}(v_{\\perp},v_{\\parallel}) \\;=\\; n\\,\\left(\\frac{m}{2\\pi k_{B}}\\right)^{\\!3/2}\\,\\frac{1}{T_{\\perp 0}\\,\\sqrt{T_{\\parallel 0}}}\\,\\exp\\!\\left[-\\,\\frac{m v_{\\perp}^{2}}{2 k_{B} T_{\\perp 0}} \\,-\\, \\frac{m v_{\\parallel}^{2}}{2 k_{B} T_{\\parallel 0}}\\right],\n$$\n其中 $n$ 是数密度，$m$ 是质子质量，$k_{B}$ 是 Boltzmann 常数。通过压力张量矩定义平行和垂直温度，\n$$\nP_{\\parallel}(t) \\;=\\; m \\int v_{\\parallel}^{2}\\, f \\, d^{3}v, \\quad P_{\\perp}(t) \\;=\\; \\frac{m}{2} \\int v_{\\perp}^{2}\\, f \\, d^{3}v, \\quad T_{\\parallel}(t) \\;=\\; \\frac{P_{\\parallel}(t)}{n k_{B}}, \\quad T_{\\perp}(t) \\;=\\; \\frac{P_{\\perp}(t)}{n k_{B}}.\n$$\n假设初始各向异性很弱，其特征为\n$$\nA_{0} \\;\\equiv\\; \\frac{T_{\\perp 0}}{T_{\\parallel 0}} \\,-\\, 1 \\quad \\text{且} \\quad |A_{0}| \\ll 1,\n$$\n并根据上面给出的准线性投掷角扩散算符，在 $A_{0}$ 的主导阶下处理其演化。从动理学方程和给定定义出发，且不使用任何关于各向异性弛豫的简化公式，推导温度各向异性比\n$$\nA(t) \\;\\equiv\\; \\frac{T_{\\perp}(t)}{T_{\\parallel}(t)} \\,-\\, 1\n$$\n在 $t=0$ 时的初始变化率。\n\n你的最终答案必须是 $\\left.\\frac{dA}{dt}\\right|_{t=0}$ 关于 $D_{0}$ 和 $A_{0}$ 的单一闭式解析表达式。用 $\\text{s}^{-1}$ 表示你的最终答案。不需要进行数值计算或四舍五入。",
            "solution": "目标是求解温度各向异性在初始时刻的变化率 $\\left.\\frac{dA}{dt}\\right|_{t=0}$，并取初始各向异性 $A_0$ 的主导阶。温度各向异性定义为 $A(t) = \\frac{T_{\\perp}(t)}{T_{\\parallel}(t)} - 1$。对时间求导，我们得到\n$$\n\\frac{dA}{dt} = \\frac{d}{dt}\\left(\\frac{T_{\\perp}}{T_{\\parallel}}\\right) = \\frac{1}{T_{\\parallel}}\\frac{dT_{\\perp}}{dt} - \\frac{T_{\\perp}}{T_{\\parallel}^2}\\frac{dT_{\\parallel}}{dt}.\n$$\n我们需要确定平行和垂直温度 $T_{\\parallel}$ 和 $T_{\\perp}$ 的时间导数。它们由压力张量矩定义：$T_{\\parallel} = P_{\\parallel}/(n k_B)$ 和 $T_{\\perp} = P_{\\perp}/(n k_B)$。因此，我们必须首先计算压力分量的时间演化。\n\n平行压力 $P_{\\parallel}$ 的变化率由下式给出\n$$\n\\frac{dP_{\\parallel}}{dt} = \\frac{d}{dt} \\left( m \\int v_{\\parallel}^2 f \\, d^3v \\right) = m \\int v_{\\parallel}^2 \\frac{\\partial f}{\\partial t} \\, d^3v.\n$$\n代入给定的动理学方程，\n$$\n\\frac{dP_{\\parallel}}{dt} = m \\int v_{\\parallel}^2 \\left( D_0 \\frac{\\partial}{\\partial \\mu} \\left[ (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} \\right] \\right) d^3v.\n$$\n我们在球形速度坐标 $(v, \\mu, \\phi)$ 下进行计算，其中 $v$ 是速率，$\\mu = v_{\\parallel}/v$ 是投掷角余弦，$\\phi$ 是回旋相位角。速度空间体积元是 $d^3v = 2\\pi v^2 dv d\\mu$。此外，$v_{\\parallel}^2 = v^2\\mu^2$。\n$$\n\\frac{dP_{\\parallel}}{dt} = 2\\pi m D_0 \\int_0^\\infty v^4 dv \\int_{-1}^{1} \\mu^2 \\frac{\\partial}{\\partial \\mu} \\left[ (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} \\right] d\\mu.\n$$\n我们使用两次分部积分来计算内部关于 $\\mu$ 的积分。对于第一次积分，令 $u = \\mu^2$ 和 $dv' = \\frac{\\partial}{\\partial \\mu} [ (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} ] d\\mu$。这得到 $du = 2\\mu d\\mu$ 和 $v' = (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu}$。\n$$\n\\int_{-1}^{1} u \\, dv' = \\left[ u v' \\right]_{-1}^{1} - \\int_{-1}^{1} v' \\, du = \\left[ \\mu^2 (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} \\right]_{-1}^{1} - \\int_{-1}^{1} (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} (2\\mu) d\\mu.\n$$\n由于在 $\\mu = \\pm 1$ 时 $(1-\\mu^2)=0$，边界项为零。我们剩下 $-2 \\int_{-1}^{1} \\mu(1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} d\\mu$。对于第二次分部积分，令 $u = \\mu(1-\\mu^2)$ 和 $dv' = \\frac{\\partial f}{\\partial \\mu} d\\mu$。这得到 $du = (1-3\\mu^2)d\\mu$ 和 $v' = f$。\n$$\n-2 \\int_{-1}^{1} u \\, dv' = -2 \\left( \\left[ u v' \\right]_{-1}^{1} - \\int_{-1}^{1} v' \\, du \\right) = -2 \\left( \\left[ \\mu(1-\\mu^2)f \\right]_{-1}^{1} - \\int_{-1}^{1} f(1-3\\mu^2)d\\mu \\right).\n$$\n边界项再次为零。关于 $\\mu$ 的积分变为 $2 \\int_{-1}^{1} f(1-3\\mu^2)d\\mu$。将其代回：\n$$\n\\frac{dP_{\\parallel}}{dt} = 2\\pi m D_0 \\int_0^\\infty v^4 dv \\left( 2 \\int_{-1}^{1} f(1-3\\mu^2)d\\mu \\right) = 2D_0 \\int m v^2(1-3\\mu^2) f \\, d^3v.\n$$\n使用 $v^2_ \\perp = v^2 (1-\\mu^2)$ 和 $v^2_{\\parallel} = v^2\\mu^2$，将被积函数用 $v_{\\parallel}$ 和 $v_{\\perp}$ 表示，我们有 $v^2(1-3\\mu^2) = v^2 - 3v^2\\mu^2 = (v_{\\perp}^2+v_{\\parallel}^2) - 3v_{\\parallel}^2 = v_{\\perp}^2 - 2v_{\\parallel}^2$。\n$$\n\\frac{dP_{\\parallel}}{dt} = 2D_0 \\int m(v_{\\perp}^2 - 2v_{\\parallel}^2) f \\, d^3v = 2D_0 \\left( m\\int v_{\\perp}^2 f \\, d^3v - 2 m\\int v_{\\parallel}^2 f \\, d^3v \\right).\n$$\n使用定义 $P_{\\parallel} = m \\int v_{\\parallel}^2 f \\, d^3v$ 和 $P_{\\perp} = \\frac{m}{2} \\int v_{\\perp}^2 f \\, d^3v$，我们发现\n$$\n\\frac{dP_{\\parallel}}{dt} = 2D_0 (2P_{\\perp} - 2P_{\\parallel}) = 4D_0(P_{\\perp} - P_{\\parallel}).\n$$\n接下来，我们计算垂直压力 $P_{\\perp}$ 的变化率：\n$$\n\\frac{dP_{\\perp}}{dt} = \\frac{d}{dt} \\left( \\frac{m}{2} \\int v_{\\perp}^2 f \\, d^3v \\right) = \\frac{m}{2} \\int v_{\\perp}^2 \\frac{\\partial f}{\\partial t} \\, d^3v.\n$$\n代入动理学方程和 $v_{\\perp}^2 = v^2(1-\\mu^2)$：\n$$\n\\frac{dP_{\\perp}}{dt} = \\frac{m}{2} \\int v^2(1-\\mu^2) \\left( D_0 \\frac{\\partial}{\\partial \\mu} \\left[ (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} \\right] \\right) 2\\pi v^2 dv d\\mu = \\pi m D_0 \\int_0^\\infty v^4 dv \\int_{-1}^{1} (1-\\mu^2) \\frac{\\partial}{\\partial \\mu} \\left[ (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} \\right] d\\mu.\n$$\n这个关于 $\\mu$ 的积分可以与之前的计算联系起来。在推导 $dP_{\\parallel}/dt$ 时出现了积分 $-2 \\int \\mu(1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} d\\mu$。当前的积分是该积分的 $-1/2$ 倍，带有一个额外的因子 $(1-\\mu^2)$ 和一个符号翻转。让我们进行分部积分。令 $u = 1-\\mu^2$ 和 $dv' = \\frac{\\partial}{\\partial \\mu} [ (1-\\mu^2) \\frac{\\partial f}{\\partial \\mu} ] d\\mu$。\n$$\n\\int_{-1}^{1} u \\, dv' = \\left[ (1-\\mu^2)^2 \\frac{\\partial f}{\\partial \\mu} \\right]_{-1}^{1} - \\int_{-1}^{1} (1-\\mu^2)\\frac{\\partial f_p}{\\partial \\mu}(-2\\mu)d\\mu = 2\\int_{-1}^{1} \\mu(1-\\mu^2)\\frac{\\partial f}{\\partial \\mu}d\\mu.\n$$\n这恰好是 $dP_{\\parallel}/dt$ 第一次分部积分后表达式的负值。因此，其结果是该计算第二部分结果的负值：\n$$\n2\\int_{-1}^{1} \\mu(1-\\mu^2)\\frac{\\partial f}{\\partial \\mu}d\\mu = \\int_{-1}^{1} f(6\\mu^2 - 2)d\\mu.\n$$\n将其代回：\n$$\n\\frac{dP_{\\perp}}{dt} = \\pi m D_0 \\int_0^\\infty v^4 dv \\int_{-1}^{1} f(6\\mu^2-2)d\\mu = D_0 \\int \\frac{m}{2} v^2(6\\mu^2-2) f \\, d^3v.\n$$\n被积函数是 $\\frac{m}{2}(6v^2\\mu^2 - 2v^2) = \\frac{m}{2}(6v_{\\parallel}^2 - 2(v_{\\perp}^2+v_{\\parallel}^2)) = m(2v_{\\parallel}^2 - v_{\\perp}^2)$。\n$$\n\\frac{dP_{\\perp}}{dt} = D_0 \\int m(2v_{\\parallel}^2 - v_{\\perp}^2)f \\, d^3v = D_0 (2P_{\\parallel} - 2P_{\\perp}) = -2D_0(P_{\\perp} - P_{\\parallel}).\n$$\n作为检验，总动能密度是 $\\mathcal{E} = P_{\\perp} + \\frac{1}{2}P_{\\parallel}$。其时间导数是 $\\frac{d\\mathcal{E}}{dt} = \\frac{dP_{\\perp}}{dt} + \\frac{1}{2}\\frac{dP_{\\parallel}}{dt} = -2D_0(P_{\\perp} - P_{\\parallel}) + \\frac{1}{2}(4D_0(P_{\\perp} - P_{\\parallel})) = 0$。这证实了能量守恒，正如纯投掷角扩散所预期的那样。\n\n现在，我们求温度的演化：\n$$\n\\frac{dT_{\\parallel}}{dt} = \\frac{1}{nk_B}\\frac{dP_{\\parallel}}{dt} = \\frac{4D_0(P_{\\perp} - P_{\\parallel})}{nk_B} = 4D_0(T_{\\perp} - T_{\\parallel}).\n$$\n$$\n\\frac{dT_{\\perp}}{dt} = \\frac{1}{nk_B}\\frac{dP_{\\perp}}{dt} = \\frac{-2D_0(P_{\\perp} - P_{\\parallel})}{nk_B} = -2D_0(T_{\\perp} - T_{\\parallel}).\n$$\n我们现在可以计算在 $t=0$ 时的 $\\frac{dA}{dt}$：\n$$\n\\left.\\frac{dA}{dt}\\right|_{t=0} = \\frac{1}{T_{\\parallel 0}}\\left.\\frac{dT_{\\perp}}{dt}\\right|_{t=0} - \\frac{T_{\\perp 0}}{T_{\\parallel 0}^2}\\left.\\frac{dT_{\\parallel}}{dt}\\right|_{t=0}.\n$$\n代入在 $t=0$ 时求得的导数：\n$$\n\\left.\\frac{dA}{dt}\\right|_{t=0} = \\frac{1}{T_{\\parallel 0}}[-2D_0(T_{\\perp 0} - T_{\\parallel 0})] - \\frac{T_{\\perp 0}}{T_{\\parallel 0}^2}[4D_0(T_{\\perp 0} - T_{\\parallel 0})].\n$$\n现在，我们使用初始各向异性的定义，$A_0 = \\frac{T_{\\perp 0}}{T_{\\parallel 0}} - 1$。这意味着 $T_{\\perp 0} - T_{\\parallel 0} = A_0 T_{\\parallel 0}$ 以及 $\\frac{T_{\\perp 0}}{T_{\\parallel 0}} = 1 + A_0$。\n$$\n\\left.\\frac{dA}{dt}\\right|_{t=0} = \\frac{1}{T_{\\parallel 0}}[-2D_0 A_0 T_{\\parallel 0}] - \\frac{1+A_0}{T_{\\parallel 0}}[4D_0 A_0 T_{\\parallel 0}] = -2D_0 A_0 - (1+A_0)4D_0 A_0.\n$$\n$$\n\\left.\\frac{dA}{dt}\\right|_{t=0} = -2D_0 A_0 - 4D_0 A_0 - 4D_0 A_0^2 = -6D_0 A_0 - 4D_0 A_0^2.\n$$\n问题要求结果取 $A_0$ 的主导阶。由于 $|A_0| \\ll 1$，与 $A_0^2$ 成正比的项与与 $A_0$ 成正比的项相比可以忽略不计。\n因此，在主导阶上，各向异性的初始变化率为\n$$\n\\left.\\frac{dA}{dt}\\right|_{t=0} = -6 D_0 A_0.\n$$\n扩散系数 $D_0$ 的单位是时间的倒数（$s^{-1}$），而 $A_0$ 是无量纲的。结果的单位正确地为 $s^{-1}$。",
            "answer": "$$\n\\boxed{-6 D_0 A_0}\n$$"
        },
        {
            "introduction": "解析解虽然深刻，但仅限于少数理想化情况。为了研究更普适的、具有任意扩散系数和初始条件的准线性扩散问题，我们必须依赖数值方法。这个实践练习  将指导你构建一个一维速度空间扩散的有限体积数值求解器，这不仅能加深你对扩散方程结构和守恒律的理解，也为你提供了研究更复杂动理学过程的实用工具。",
            "id": "4225149",
            "problem": "考虑一个空间均匀、弱湍动、无碰撞的天体物理等离子体，其中共振波-粒子相互作用导致一维速度空间中的准线性扩散。根据准线性理论（QLT），回旋平均、投掷角积分的分布函数的演化由速度空间中的一个Fokker-Planck型扩散方程建模。设分布函数用 $f(v,t)$ 表示，其中 $v$ 是用热速度归一化的一维速度坐标，$t$ 是用特征散射时间归一化的时间，因此所有量都是无量纲的。控制方程为\n$$\n\\frac{\\partial f(v,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial v} \\left[ D(v) \\,\\frac{\\partial f(v,t)}{\\partial v} \\right]\n$$\n在区域端点 $v_{\\min}$ 和 $v_{\\max}$ 处具有零扩散通量边界条件，\n$$\n\\left. -\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right|_{v=v_{\\min}} \\;=\\; 0, \\qquad \\left. -\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right|_{v=v_{\\max}} \\;=\\; 0.\n$$\n您必须在一个均匀网格上设计并实现一个在 $v$ 方向上的守恒有限体积离散化，并使用显式格式对解进行时间推进。有限体积更新必须由与连续通量 $F \\equiv -\\,D(v)\\,\\partial f/\\partial v$ 一致的界面通量 $F_{i+\\frac{1}{2}}$ 构建。设网格在区间 $[v_{\\min},v_{\\max}]$ 上有 $N$ 个点，均匀间距为 $\\Delta v$，并用 $f_i^n \\approx f(v_i,t^n)$ 表示网格中心值。界面扩散系数 $D_{i+\\frac{1}{2}}$ 必须使用相邻网格中心值的算术平均值计算，而界面扩散通量必须使用梯度的中心差分计算。边界条件必须通过在区域边界处施加零通量来强制执行。全离散有限体积更新需要具有以下形式\n$$\nf_i^{n+1} \\;=\\; f_i^{n} \\;-\\; \\frac{\\Delta t}{\\Delta v} \\,\\Big( F_{i+\\frac{1}{2}}^{n} \\;-\\; F_{i-\\frac{1}{2}}^{n} \\Big),\n$$\n其中\n$$\nF_{i+\\frac{1}{2}}^{n} \\;=\\; -\\,D_{i+\\frac{1}{2}} \\,\\frac{f_{i+1}^{n} - f_{i}^{n}}{\\Delta v}, \\qquad D_{i+\\frac{1}{2}} \\;=\\; \\frac{D_i + D_{i+1}}{2}.\n$$\n为确保显式扩散的数值稳定性和正定性，时间步长必须满足一个基于 $D(v)$ 在整个区域上最大值的充分条件，\n$$\n\\Delta t \\;\\le\\; \\frac{\\Delta v^2}{2 \\,\\max_{v \\in [v_{\\min},v_{\\max}]} D(v)}.\n$$\n您的程序必须实现此格式并运行以下测试套件，每个测试由一组参数描述。所有量都是无量纲的，因此不需要物理单位。\n\n测试套件：\n- 测试用例 $1$ (恒定扩散下的质量守恒):\n  - 区域端点: $v_{\\min} = -\\,4$, $v_{\\max} = 4$.\n  - 网格: $N = 201$ 个均匀分布的点，因此 $\\Delta v = (v_{\\max} - v_{\\min})/(N-1)$。\n  - 初始条件: $f_0(v) = \\exp(-\\,v^2)$.\n  - 扩散系数: $D(v) = D_0$ 其中 $D_0 = 0.1$.\n  - 时间步长: $\\Delta t = 0.5 \\,\\Delta v^2 / D_0$.\n  - 时间步数: $n_{\\text{steps}} = 250$.\n  - 边界条件: 在 $v_{\\min}$ 和 $v_{\\max}$ 处为零通量。\n  - 此测试的输出: 演化后的相对质量偏差，\n    $$\n    R_1 \\;=\\; \\frac{M_{\\text{final}} - M_{\\text{initial}}}{M_{\\text{initial}}},\n    \\quad \\text{其中} \\quad\n    M = \\sum_{i=0}^{N-1} f_i \\,\\Delta v.\n    $$\n- 测试用例 $2$ (速度相关扩散下的零通量边界执行):\n  - 区域端点: $v_{\\min} = -\\,4$, $v_{\\max} = 4$.\n  - 网格: $N = 201$ 个均匀分布的点。\n  - 初始条件: $f_0(v) = \\exp\\!\\big(-\\,(v-1)^2\\big)$.\n  - 扩散系数: $D(v) = \\dfrac{D_0}{1+v^2}$ 其中 $D_0 = 0.2$.\n  - 时间步长: $\\Delta t = 0.45 \\,\\Delta v^2 / \\max_v D(v)$.\n  - 时间步数: $n_{\\text{steps}} = 1$.\n  - 边界条件: 在 $v_{\\min}$ 和 $v_{\\max}$ 处为零通量。\n  - 此测试的输出: 在所执行的步骤中，格式计算出的两个区域边界处的边界通量的平均绝对值，\n    $$\n    R_2 \\;=\\; \\frac{1}{2}\\,\\Big( \\big|F_{-\\frac{1}{2}}\\big| \\;+\\; \\big|F_{N-\\frac{1}{2}}\\big| \\Big),\n    $$\n    其中 $F_{-\\frac{1}{2}}$ 和 $F_{N-\\frac{1}{2}}$ 分别表示左边界和右边界通量。在完美执行下，它们应为 $0$，而在数值上，它们应非常接近 $0$。\n- 测试用例 $3$ (强非均匀扩散下的正定性):\n  - 区域端点: $v_{\\min} = -\\,4$, $v_{\\max} = 4$.\n  - 网格: $N = 201$ 个均匀分布的点。\n  - 初始条件: 方帽分布 $f_0(v) = 1$ 对于 $\\lvert v \\rvert \\le 1$ 且 $f_0(v) = 0$ 对于其他情况。\n  - 扩散系数: $D(v) = D_0\\,v^2$ 其中 $D_0 = 0.05$.\n  - 时间步长: $\\Delta t = 0.9 \\,\\Delta v^2 \\big/ \\big(2 \\,\\max_v D(v)\\big)$.\n  - 时间步数: $n_{\\text{steps}} = 300$.\n  - 边界条件: 在 $v_{\\min}$ 和 $v_{\\max}$ 处为零通量。\n  - 此测试的输出: 一个布尔值 $R_3$，指示演化后是否对所有网格点都满足 $f_i^{n} \\ge 0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序为 $[R_1, R_2, R_3]$。例如，输出应类似于 $[r_1,r_2,r_3]$，其中 $r_1$ 和 $r_2$ 是浮点数，$r_3$ 是布尔值。",
            "solution": "分布函数 $f(v,t)$ 的控制偏微分方程 (PDE) 是：\n$$\n\\frac{\\partial f(v,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial v} \\left[ D(v) \\,\\frac{\\partial f(v,t)}{\\partial v} \\right]\n$$\n该方程定义在一维速度域 $v \\in [v_{\\min}, v_{\\max}]$ 上。边界条件为零通量（Neumann）类型，意味着没有粒子逃离该区域：\n$$\nF(v) \\equiv -\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\bigg|_{v=v_{\\min}, v_{\\max}} \\;=\\; 0\n$$\n为数值求解此方程，我们将实现指定的有限体积法。\n\n**1. 离散化**\n\n连续速度域 $[v_{\\min}, v_{\\max}]$ 被离散为 $N$ 个点 $v_i$，均匀间距为 $\\Delta v$。这些点被视为 $N$ 个控制体积（或网格单元）的中心。网格点由下式给出：\n$$\nv_i \\;=\\; v_{\\min} \\,+\\, i\\,\\Delta v, \\qquad \\text{对于 } i = 0, 1, \\dots, N-1\n$$\n其中网格间距为 $\\Delta v = (v_{\\max} - v_{\\min}) / (N-1)$。与点 $v_i$ 关联的网格单元 $C_i$ 是区间 $[v_i - \\Delta v/2, v_i + \\Delta v/2]$。离散值 $f_i^n$ 表示在时间 $t^n = n\\,\\Delta t$ 时，网格单元 $C_i$ 中分布函数的网格平均值。\n\n有限体积法通过在控制体积 $C_i$ 上对PDE进行积分得出：\n$$\n\\int_{v_i - \\Delta v/2}^{v_i + \\Delta v/2} \\frac{\\partial f}{\\partial t} \\, dv \\;=\\; \\int_{v_i - \\Delta v/2}^{v_i + \\Delta v/2} \\frac{\\partial}{\\partial v} \\left[ D(v) \\frac{\\partial f}{\\partial v} \\right] \\, dv\n$$\n对时间导数进行近似并对右侧应用微积分基本定理，得到：\n$$\n\\Delta v \\frac{f_i^{n+1} - f_i^n}{\\Delta t} \\;\\approx\\; \\left[ -D \\frac{\\partial f}{\\partial v} \\right]_{v_i + \\Delta v/2} - \\left[ -D \\frac{\\partial f}{\\partial v} \\right]_{v_i - \\Delta v/2}\n$$\n右侧的项是网格单元界面处的扩散通量 $F$。设 $F_{i+1/2}^n$ 表示位于 $v = v_i + \\Delta v/2$ 处，网格单元 $i$ 和 $i+1$ 之间界面上的通量。方程变为：\n$$\n\\frac{f_i^{n+1} - f_i^n}{\\Delta t} \\;=\\; \\frac{F_{i+1/2}^n - F_{i-1/2}^n}{\\Delta v}\n$$\n整理后得到问题中指定的显式时间更新公式：\n$$\nf_i^{n+1} \\;=\\; f_i^n \\,-\\, \\frac{\\Delta t}{\\Delta v} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right)\n$$\n此更新规则适用于内部网格单元，即对于 $i = 1, \\dots, N-2$。对于边界网格单元 $i=0$ 和 $i=N-1$ 需要特殊处理。\n\n**2. 通量计算与边界条件**\n\n问题指定了如何近似界面处的通量。通量 $F_{i+1/2}^n$ 使用梯度的中心差分和扩散系数的算术平均值来计算：\n$$\nF_{i+1/2}^n \\;=\\; -D_{i+1/2} \\frac{f_{i+1}^n - f_i^n}{\\Delta v}, \\quad \\text{其中} \\quad D_{i+1/2} = \\frac{D(v_i) + D(v_{i+1})}{2} = \\frac{D_i + D_{i+1}}{2}\n$$\n该公式适用于 $i = 0, \\dots, N-2$ 的内部界面。\n\n零通量边界条件施加在整个数值域的边缘，即 $v_0 - \\Delta v/2$ 和 $v_{N-1} + \\Delta v/2$ 处。这些位置对应于通量 $F_{-1/2}$ 和 $F_{N-1/2}$。该条件通过在所有时间步 $n$ 中将这些边界通量设置为零来强制执行：\n$$\nF_{-1/2}^n \\;=\\; 0, \\qquad F_{N-1/2}^n \\;=\\; 0\n$$\n使用这些边界通量，第一个和最后一个网格单元的更新规则变为：\n- 对于 $i=0$: $f_0^{n+1} = f_0^n - \\frac{\\Delta t}{\\Delta v} \\left( F_{1/2}^n - F_{-1/2}^n \\right) = f_0^n - \\frac{\\Delta t}{\\Delta v} F_{1/2}^n$\n- 对于 $i=N-1$: $f_{N-1}^{n+1} = f_{N-1}^n - \\frac{\\Delta t}{\\Delta v} \\left( F_{N-1/2}^n - F_{N-3/2}^n \\right) = f_{N-1}^n + \\frac{\\Delta t}{\\Delta v} F_{N-3/2}^n$\n\n**3. 时间步长与稳定性**\n\n显式格式是条件稳定的。问题提供了一个稳定性和正定性的充分条件：\n$$\n\\Delta t \\;\\le\\; \\frac{\\Delta v^2}{2 \\max_{v \\in [v_{\\min},v_{\\max}]} D(v)}\n$$\n每个测试用例都指定了一个符合此标准的时间步长 $\\Delta t$。\n\n**4. 测试用例的实现**\n\n该数值格式在一个执行时间步长循环的Python函数中实现。然后用指定的参数为三个测试用例分别调用此函数。\n\n- **测试用例1 (质量守恒):** 总质量定义为 $M = \\int f(v,t) dv$，数值上近似为总和 $M \\approx \\sum_{i=0}^{N-1} f_i \\Delta v$。一个守恒的数值格式应在机器精度范围内保持该量不变。在 $n_{\\text{steps}} = 250$ 步后计算相对质量偏差 $R_1 = (M_{\\text{final}} - M_{\\text{initial}}) / M_{\\text{initial}}$。\n\n- **测试用例2 (边界通量执行):** 该格式通过直接设置 $F_{-1/2}$ 和 $F_{N-1/2}$ 为 $0$ 来施加边界上的零通量。输出 $R_2$ 是这些施加通量的平均绝对值：$R_2 = \\frac{1}{2}(\\lvert F_{-1/2} \\rvert + \\lvert F_{N-1/2} \\rvert)$。根据设计，该值恰好为 $0$。\n\n- **测试用例3 (正定性):** 分布函数 $f(v,t)$ 是一个概率密度，必须保持非负。所选的时间步长遵守稳定性条件，该条件也足以确保正定性。模拟运行 $n_{\\text{steps}} = 300$ 步，并检查最终的分布 $f_i^{n_{\\text{steps}}}$ 在所有网格点上是否为非负。如果所有 $f_i \\ge 0$，则布尔结果 $R_3$ 将为 `True`。在检查中使用了小的浮点容差，以考虑潜在的舍入误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(v_min, v_max, N, f0_func, D_func, dt, n_steps):\n    \"\"\"\n    Solves the 1D quasilinear diffusion equation using a finite-volume scheme.\n\n    Args:\n        v_min (float): Minimum velocity in the domain.\n        v_max (float): Maximum velocity in the domain.\n        N (int): Number of grid points.\n        f0_func (callable): Function to compute the initial distribution f(v).\n        D_func (callable): Function to compute the diffusion coefficient D(v).\n        dt (float): Time step.\n        n_steps (int): Number of time steps to perform.\n\n    Returns:\n        tuple[np.ndarray, np.ndarray]: A tuple containing the initial and final\n                                       distribution functions.\n    \"\"\"\n    # 1. Grid setup\n    v = np.linspace(v_min, v_max, N)\n    dv = v[1] - v[0]\n\n    # 2. Initialization\n    f = f0_func(v)\n    f_initial = f.copy()\n    D_v = D_func(v)\n\n    # 3. Time evolution loop\n    for _ in range(n_steps):\n        # Calculate diffusion coefficients at cell interfaces (D_{i+1/2})\n        D_interface = (D_v[:-1] + D_v[1:]) / 2.0\n        \n        # Calculate diffusive fluxes at internal interfaces (F_{i+1/2} for i=0..N-2)\n        F_internal = -D_interface * (f[1:] - f[:-1]) / dv\n        \n        # Assemble the full flux array, including boundary fluxes\n        # F represents [F_{-1/2}, F_{1/2}, ..., F_{N-3/2}, F_{N-1/2}]\n        F = np.zeros(N + 1)\n        F[1:-1] = F_internal\n        \n        # Impose zero-flux boundary conditions\n        F[0] = 0.0\n        F[-1] = 0.0\n        \n        # Calculate the divergence of the flux at cell centers\n        # flux_diff[i] = F_{i+1/2} - F_{i-1/2}\n        flux_diff = F[1:] - F[:-1]\n        \n        # Update the distribution function using an explicit time step\n        f = f - (dt / dv) * flux_diff\n\n    return f_initial, f\n\ndef solve():\n    \"\"\"\n    Runs the full test suite and prints the final results.\n    \"\"\"\n    results = []\n\n    # Test Case 1: Mass conservation\n    v_min1, v_max1 = -4.0, 4.0\n    N1 = 201\n    dv1 = (v_max1 - v_min1) / (N1 - 1)\n    f0_func1 = lambda v: np.exp(-v**2)\n    D0_1 = 0.1\n    D_func1 = lambda v: np.full_like(v, D0_1)\n    dt1 = 0.5 * dv1**2 / D0_1\n    n_steps1 = 250\n\n    f_initial1, f_final1 = run_simulation(\n        v_min1, v_max1, N1, f0_func1, D_func1, dt1, n_steps1\n    )\n    M_initial1 = np.sum(f_initial1) * dv1\n    M_final1 = np.sum(f_final1) * dv1\n    R1 = (M_final1 - M_initial1) / M_initial1\n    results.append(R1)\n\n    # Test Case 2: Zero-flux boundary enforcement\n    # The scheme imposes F_{-1/2} = 0 and F_{N-1/2} = 0 by definition.\n    # The output is the mean absolute value of these fluxes.\n    F_left_boundary = 0.0\n    F_right_boundary = 0.0\n    R2 = 0.5 * (np.abs(F_left_boundary) + np.abs(F_right_boundary))\n    results.append(R2)\n\n    # Test Case 3: Positivity\n    v_min3, v_max3 = -4.0, 4.0\n    N3 = 201\n    v3 = np.linspace(v_min3, v_max3, N3)\n    dv3 = v3[1] - v3[0]\n    f0_func3 = lambda v: np.where(np.abs(v) = 1, 1.0, 0.0)\n    D0_3 = 0.05\n    D_func3 = lambda v: D0_3 * v**2\n    D_v3 = D_func3(v3)\n    max_D3 = np.max(D_v3)\n    dt3 = 0.9 * dv3**2 / (2 * max_D3)\n    n_steps3 = 300\n\n    _, f_final3 = run_simulation(\n        v_min3, v_max3, N3, f0_func3, D_func3, dt3, n_steps3\n    )\n    # Check if all values are non-negative, allowing for small floating-point errors\n    R3 = bool(np.all(f_final3 >= -1e-15))\n    results.append(R3)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{results[0]},{results[1]},{results[2]}]\")\n\nsolve()\n```"
        }
    ]
}