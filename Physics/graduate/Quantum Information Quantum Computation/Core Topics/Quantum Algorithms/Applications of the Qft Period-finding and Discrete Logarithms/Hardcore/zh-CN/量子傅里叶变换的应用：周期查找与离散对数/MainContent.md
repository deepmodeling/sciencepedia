## 引言
[量子傅里叶变换](@entry_id:139146)（QFT）是[量子计算](@entry_id:142712)中最强大的工具之一，它为解决一些经典计算机难以处理的问题提供了指数级的加速。其核心能力在于高效地揭示隐藏在数据中的周期性，这一特性是破解现代密码学和解决数论中某些难题的关键。然而，从QFT的抽象数学定义到解决实际问题的具体算法，其间存在着理论与实践的鸿沟。本文旨在弥合这一差距，系统性地展示QFT如何成为[周期查找](@entry_id:141657)和求解[离散对数问题](@entry_id:144538)的基石。

本文将引导读者踏上一段从原理到应用的探索之旅。在“原理与机制”一章中，我们将深入剖析QFT如何作为“周期性探测器”工作，并阐明Shor算法和[离散对数](@entry_id:266196)算法背后的量子力学与经典后处理步骤。接着，在“应用与交叉学科联系”一章中，我们将视野扩展到[密码分析](@entry_id:196791)、[代数几何](@entry_id:156300)、数论乃至物理学等多个领域，展示这些核心算法如何被推广和应用于解决更广泛的科学问题。最后，通过“动手实践”部分的精选练习，读者将有机会亲手计算和分析算法的关键环节，从而巩固理论知识并获得解决实际问题的能力。

## 原理与机制

[量子傅里叶变换](@entry_id:139146)（Quantum Fourier Transform, QFT）是众多量子算法的核心组成部分，其强大之处在于能够高效地揭示数据中的周期性结构。在本章中，我们将深入探讨 QFT 在[周期查找](@entry_id:141657)和求解[离散对数问题](@entry_id:144538)中的应用。我们将从基本原理出发，系统地阐明这些算法的内在机制，并展示如何将量子测量结果转化为经典问题的解决方案。

### [量子傅里叶变换](@entry_id:139146)：一种周期性探测器

[量子傅里叶变换](@entry_id:139146)是其经典对应——离散傅里叶变换（DFT）的[量子模拟](@entry_id:145469)。在一个 $N=2^n$ 维的希尔伯特空间中，QFT 对计算[基矢](@entry_id:199546) $|j\rangle$ 的作用定义为：

$$
\text{QFT}|j\rangle = \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} \exp\left(\frac{2\pi i j k}{N}\right) |k\rangle
$$

从这一定义可以看出，QFT 将一个计算[基矢](@entry_id:199546)态变换为所有计算[基矢](@entry_id:199546)态的均匀叠加，但每个[基矢](@entry_id:199546) $|k\rangle$ 都带有一个依赖于原始状态 $j$ 和自身索引 $k$ 的[复数相位](@entry_id:173474)。这个相位关系是揭示周期性的关键。

考虑一个具有周期性结构的[量子态](@entry_id:146142)。假设我们有一个 4-[量子比特](@entry_id:137928)系统（$n=4$, $N=16$），其状态是一个周期为 $r=4$ 的态的均匀叠加：

$$
|\psi\rangle = \frac{1}{2}(|0\rangle + |4\rangle + |8\rangle + |12\rangle)
$$

这个态在计算基上的分量仅在索引是周期 $r=4$ 的倍数时才非零。当我们对这个态应用 QFT 时，根据[线性叠加原理](@entry_id:196987)，输出态 $|\phi\rangle = \text{QFT}|\psi\rangle$ 中[基矢](@entry_id:199546) $|k\rangle$ 的振幅 $\beta_k$ 为：

$$
\beta_k = \frac{1}{4} \cdot \frac{1}{2} \sum_{j \in \{0,4,8,12\}} \exp\left(\frac{2\pi i j k}{16}\right) = \frac{1}{8} \left(1 + \exp\left(\frac{i\pi k}{2}\right) + \exp(i\pi k) + \exp\left(\frac{i3\pi k}{2}\right)\right)
$$

现在我们来考察特定输出 $k$ 的振幅。例如，当 $k=4$ 时，所有指数项都为 $1$，振幅 $\beta_4 = \frac{1}{8}(1+1+1+1) = \frac{1}{2}$，这是一个[相长干涉](@entry_id:276464)的例子。然而，对于其他值，可能会发生[相消干涉](@entry_id:170966)。例如，当 $k=2$ 时，我们得到：

$$
\beta_2 = \frac{1}{8} \left(1 + \exp(i\pi) + \exp(i2\pi) + \exp(i3\pi)\right) = \frac{1}{8}(1 - 1 + 1 - 1) = 0
$$

通过计算可以发现，只有当 $k$ 是 $N/r = 16/4 = 4$ 的整数倍时（即 $k \in \{0, 4, 8, 12\}$），振幅 $\beta_k$ 才非零。这意味着，一个在计算基下周期为 $r$ 的输入态，经过 QFT 后，会转变为一个在[傅里叶基](@entry_id:201167)下周期为 $N/r$ 的态。通过测量 QFT 的输出并找到非零振幅的 $k$ 值，我们就能推断出 $N/r$，进而得到未知的周期 $r$。这就是 QFT 用于[周期查找](@entry_id:141657)的最基本原理。

### 从理想到现实：测量结果的[概率分布](@entry_id:146404)

在实际的[量子算法](@entry_id:147346)（如 Shor 算法）中，我们准备的初态并非总是理想的周期态。这通常是因为周期 $r$ 未必能整除寄存器的总状态数 $N$。因此，初态通常是形式为 $| \psi \rangle = \frac{1}{\sqrt{M}} \sum_{j=0}^{M-1} |jr\rangle$ 的叠加态，其中 $M$ 是叠加的项数，通常约等于 $N/r$。

对这样的态应用 QFT 后，测量结果的[概率分布](@entry_id:146404)不再是仅在 $N/r$ 的倍数上取值的尖峰，而是在这些值的周围形成一系列锐利的峰。测量到某个结果 $y$ 的概率 $P(y)$ 可以被精确计算，其表达式为：

$$
P(y) = \frac{1}{MN} \frac{\sin^2(\pi Mry/N)}{\sin^2(\pi ry/N)}
$$

这个[分布](@entry_id:182848)的峰值位于使分母 $\sin^2(\pi ry/N)$ 趋近于零的位置，即当 $ry/N$ 接近整数时。换言之，$y/N$ 接近分数 $j/r$（其中 $j$ 为整数）。这证实了即使在非理想情况下，测量结果 $y$ 仍然高度集中在 $N/r$ 的整数倍附近。

例如，在一个 $n=10$ [量子比特](@entry_id:137928)的系统中（$N=1024$），若要寻找一个周期为 $r=7$ 的函数，理论上测量结果的峰值会出现在 $1024/7 \approx 146.2857$ 的整数倍附近。我们可以计算出测量到最接近这个值的整数 $y=146$ 的概率，虽然这个概率不为 $1$，但它依然是所有可能结果中概率最高的之一。这表明，通过一次测量，我们有很高的机会得到一个足够接近 $j(N/r)$ 的值，从而为推断 $r$ 提供有力线索。

### 经典后处理：用[连分数算法](@entry_id:146381)揭示周期

[量子计算](@entry_id:142712)机的输出是一个测量结果 $k$，它只是一个整数。为了提取出我们真正关心的周期 $r$，还需要一个高效的经典后处理步骤。核心原理是，我们得到的测量值 $k$ 满足关系：

$$
\left| \frac{k}{N} - \frac{j}{r} \right| \le \frac{1}{2N}
$$

其中 $j$ 是某个未知的整数。这个不等式意味着分数 $k/N$ 是 $j/r$ 的一个非常好的近似。**[连分数算法](@entry_id:146381)（continued fraction algorithm）** 是一个强大的数学工具，可以从一个实数（这里是 $k/N$）中找出其最佳的有理数逼近。通过计算 $k/N$ 的[连分数展开](@entry_id:636208)，并求出其渐近分数 (convergents)，我们就能得到一系列候选的 $j/r$。这些渐近分数的分子和分母为我们提供了关于 $j$ 和 $r$ 的猜测。

例如，假设在一个 $n=10$（$N=1024$）的[周期查找](@entry_id:141657)实验中，我们测量得到 $k=341$。我们计算 $k/N = 341/1024$ 的[连分数展开](@entry_id:636208)。这个过程会产生一系列渐近分数，如 $0/1$, $1/3$, $341/1024$ 等。在这些分数中，分母不大的 $1/3$ 是一个非常好的近似。我们可以验证 $|341/1024 - 1/3| = 1/3072$，这满足小于 $1/2048$ 的条件。因此，我们有理由相信周期 $r$ 很可能就是 $3$。

在某些情况下，单次测量可能不足以唯一确定 $r$。不同的测量结果 $k_1, k_2$ 可能通过[连分数算法](@entry_id:146381)指向不同的候选周期 $r_1, r_2$。此时，我们可以综合利用所有信息。一个合理的方法是，检验哪个候选周期能更好地“解释”所有的测量结果。例如，我们可以对每个候选周期 $r'$, 计算每个测量值 $k_i$ 与其最近的理论值 $j_i(N/r')$ 之间的误差，然[后选择](@entry_id:154665)总误差最小的那个 $r'$ 作为最可能的周期。

### 应用一：Shor 分解算法

Shor 的大数分解算法是[周期查找](@entry_id:141657)最著名的应用。其基本思想是将分解整数 $N$ 的问题转化为寻找一个函数周期的问题。具体步骤如下：
1. 随机选择一个与 $N$ [互质](@entry_id:143119)的整数 $a$。
2. 定义函数 $f(x) = a^x \pmod N$。
3. 使用量子[周期查找算法](@entry_id:145770)找到这个函数的周期 $r$，即满足 $a^r \equiv 1 \pmod N$ 的最小正整数 $r$（也称为 $a$ 模 $N$ 的阶）。

#### 量子核心：求阶

这个过程的核心就是我们已经讨论过的量子[周期查找](@entry_id:141657)。通过制备叠加态、进行[模幂运算](@entry_id:146739)和执行量子傅里叶逆变换，我们可以从测量结果中通过[连分数算法](@entry_id:146381)推断出阶 $r$。例如，为了计算一个元素（如 $g=11$）在群 $(\mathbb{Z}/35\mathbb{Z})^\times$ 中的阶，我们可以通过计算 $11^1, 11^2, 11^3, \dots \pmod{35}$ 来找到周期。使用中国剩余定理可以简化计算，最终发现阶为 $r=3$。Shor 算法的量子部分正是为了高效地找到这个 $r$。

#### 经典步骤与成功条件

一旦[量子计算](@entry_id:142712)机返回了阶 $r$，接下来的步骤是纯经典的。如果 $r$ 是偶数，我们可以计算 $y = a^{r/2}$。由于 $a^r = (a^{r/2})^2 \equiv 1 \pmod N$，我们有 $(y-1)(y+1) \equiv 0 \pmod N$。这意味着 $N$ 整除 $(y-1)(y+1)$。

只要 $y \not\equiv \pm 1 \pmod N$，那么 $\text{gcd}(y-1, N)$ 和 $\text{gcd}(y+1, N)$ 就有很大概率是 $N$ 的非平凡因子。因此，Shor 算法的成功依赖于两个经典条件：
1. 阶 $r$ 必须是偶数。
2. 如果 $r$ 是偶数，必须有 $a^{r/2} \not\equiv -1 \pmod N$。

如果其中任一条件不满足，算法的这一轮尝试就失败了，需要重新选择一个随机数 $a$ 再试一次。例如，在分解 $N=65$ 时，若选择 $a=2$，其阶 $r=12$ 是偶数，但我们发现 $2^{12/2} = 2^6 \equiv 64 \equiv -1 \pmod{65}$。这种情况就导致了经典后处理的失败。

算法的成功概率不仅与量子部分有关，也与数论性质紧密相连。一次成功的测量（即能够通过[连分数算法](@entry_id:146381)恢复出 $r$）通常要求测量结果 $k$ 对应的分数 $j/r$ 满足 $\text{gcd}(j,r)=1$。在理想情况下，满足此条件的 $j$ 有 $\varphi(r)$ 个（$\varphi$ 是[欧拉函数](@entry_id:634684)），因此单次测量的成功概率约为 $\varphi(r)/r$。而经典步骤失败的概率则依赖于 $N$ 的素因子结构。例如，对于 $N=pq$ 形式的数，经典步骤失败（即 $r$ 为奇数或 $a^{r/2} \equiv -1 \pmod N$）的概率可以被精确计算，其值不小于 $1/2^{k}$，其中 $k$ 是 $N$ 的不同素因子的数量。对于 $N=299=13 \times 23$，一个随机选择的 $a$ 导致 $a^{r/2} \equiv -1 \pmod{299}$ 的概率是 $1/8$。

### 应用二：[离散对数问题](@entry_id:144538)

求解[离散对数问题](@entry_id:144538) (DLP) 是 QFT 的另一项重要应用。该问题旨在给定素数 $p$、生成元 $g$ 和元素 $h$，找到整数 $x$ 使得 $g^x \equiv h \pmod p$。

#### 重构为隐藏[子群](@entry_id:146164)问题

解决 DLP 的量子算法巧妙地将其重新表述为一个[周期查找问题](@entry_id:147640)，但这次是在二维[晶格](@entry_id:196752)上。算法的核心是定义一个二维函数：
$f(a,b) = g^a h^b \pmod p$。
由于 $h \equiv g^x$，该函数可以写为 $f(a,b) = g^{a+xb} \pmod p$。这个函数的“周期”是一组向量 $(a,b)$，它们使得 $f(a,b)$ 的值保持不变。例如，使 $f(a,b)=1$ 的向量集合构成一个加法[子群](@entry_id:146164)（或称为一个格），其元素满足 $a+xb \equiv 0 \pmod r$，其中 $r$ 是 $g$ 的阶。

算法首先在两个寄存器中制备均匀叠加态 $\frac{1}{r} \sum_{a=0}^{r-1} \sum_{b=0}^{r-1} |a\rangle|b\rangle$。然后通过[量子计算](@entry_id:142712)将 $f(a,b)$ 的值计算到第三个寄存器。测量第三个寄存器会使前两个寄存器坍缩到一个与隐藏[子群](@entry_id:146164)相关的特定[陪集](@entry_id:147145) (coset) 的均匀叠加态上。

#### 从傅里叶测量中提取对数

对前两个寄存器执行二维 QFT 后，我们会发现测量结果 $(k_1, k_2)$ 不再是随机的。QFT 将一个陪集的叠加态映射到其对偶[子群](@entry_id:146164) (dual subgroup) 的叠加态上。这意味着，只有满足特定线性关系的 $(k_1, k_2)$ 才有非零的测量概率。这个线性关系直接与未知的[离散对数](@entry_id:266196) $x$ 相关。

具体来说，测量结果 $(k_1, k_2)$ 会以高概率满足一个形如 $k_2 \equiv c k_1 \pmod r$ 的[线性同余](@entry_id:150485)方程，其中系数 $c$ 就包含了关于 $x$ 的信息。例如，对于函数 $f(a,b)=g^{\alpha a}h^{\beta b}$，测量结果会满足 $x\beta k_1 - \alpha k_2 \equiv 0 \pmod r$。通过多次运行算法，获得几组不同的 $(k_1, k_2)$ 和对应的线性方程，我们就可以通过经典方法（如求解线性方程组）解出未知的 $x$。

从更几何的视角来看，测量第三个寄存器后，输入寄存器的状态是某个格的[陪集](@entry_id:147145) $L+\vec{s}$ 上的均匀叠加。QFT 将这个态变换为[对偶格](@entry_id:150046) $L^\perp$ 上的叠加态。这意味着测量结果 $\vec{k}=(k_1,k_2)$ 必定属于[对偶格](@entry_id:150046) $L^\perp$。此外，每个傅里叶峰 $\vec{k}$ 的相位都携带了关于[陪集](@entry_id:147145)偏移向量 $\vec{s}$ 的信息，其相位因子为 $\exp\left(-\frac{2\pi i}{N}\vec{k}\cdot\vec{s}\right)$。因此，QFT 不仅揭示了隐藏的子[群结构](@entry_id:146855)，还通过[相位编码](@entry_id:753388)了[陪集](@entry_id:147145)的信息。

### 统一框架：隐藏[子群](@entry_id:146164)与隐藏位移问题

[周期查找](@entry_id:141657)和[离散对数问题](@entry_id:144538)都可以被归纳到一个更广泛的框架下，即**隐藏[子群](@entry_id:146164)问题（Hidden Subgroup Problem, HSP）**。给定一个群 $G$ 和一个函数 $f: G \to X$，如果 $f$ 在一个未知[子群](@entry_id:146164) $H$ 的[陪集](@entry_id:147145)上取常数值，并且在不同[陪集](@entry_id:147145)上取值不同，那么找出 $H$ 的任务就是 HSP。

#### Simon 问题：$\mathbb{Z}_2^n$ 上的一个案例

Simon 算法是 HSP 的一个典型例子，它处理的是阿贝尔群 $G=(\mathbb{Z}_2^n, \oplus)$ 的情况。函数 $f$ 满足 $f(x)=f(y)$ 当且仅当 $y=x \oplus s$，其中 $s$ 是一个隐藏的非零位串。这里的隐藏[子群](@entry_id:146164)是 $H=\{0^n, s\}$。Simon 算法通过 QFT 的变体——逐比特的哈达玛变换，得到一个测量结果 $y$。该算法的一个关键结论是，测量结果 $y$ 必须与隐藏位串 $s$ “正交”，即它们的比特[内积](@entry_id:158127)为零：$s \cdot y = \sum_i s_i y_i \equiv 0 \pmod 2$。如果计算发现 $s \cdot y=1$，则测量到 $y$ 的概率为零。通过多次测量得到不同的 $y_i$，我们可以建立一个关于 $s$ 的线性方程组，并最终解出 $s$。

#### 隐藏陪集问题：在傅里叶相位中编码信息

当[子群](@entry_id:146164) $H$ 已知，但我们的目标是识别出函数在其上取常数的那个特定的[陪集](@entry_id:147145) $s+H$ 时，问题就变成了**隐藏[陪集](@entry_id:147145)问题（Hidden Coset Problem）** 或**隐藏位移问题（Hidden Shift Problem）**。在这种情况下，QFT 的作用尤为精妙。如前所述，对[陪集](@entry_id:147145) $s+H$ 上的叠加态进行 QFT，其输出态仍然只在对偶[子群](@entry_id:146164) $H^\perp$ 的元素上有非零振幅。然而，这些傅里叶峰的[相对相位](@entry_id:148120)直接编码了位移 $s$ 的信息。

例如，在群 $\mathbb{Z}_N$ 中，对于由 $r$ 生成的[子群](@entry_id:146164) $H=\langle r \rangle$，陪集 $s+H$ 的 QFT 结果中，两个傅里叶峰 $y_c=c \cdot (N/r)$ 和 $y_{c'}=c' \cdot (N/r)$ 的振幅[相对相位](@entry_id:148120)为 $\Delta\phi = \frac{2\pi s (c-c')}{r}$。通过测量这些[相对相位](@entry_id:148120)，就可以提取出关于 $s$ 的信息。对于更复杂的函数，例如在隐藏位移问题中，函数 $f_0(x)$ 的具体性质会影响最终测量结果的[概率分布](@entry_id:146404)，但其核心机制——通过 QFT 揭示位移信息——保持不变。

#### 推广：扭曲周期性与[非阿贝尔群](@entry_id:141904)

HSP 框架还可以进一步推广。例如，我们可以考虑具有“扭曲”周期性的函数，其满足 $f(x+r) = e^{i\theta}f(x)$，即在每个周期重复时会附加一个相位因子 $\theta$。对与此函数对应的[量子态](@entry_id:146142)进行 QFT，会发现傅里叶谱的峰值位置会发生偏移，偏移量与扭曲角 $\theta$ 成正比。具体来说，测量到 $k$ 的[概率分布](@entry_id:146404)的分母中会出现一项 $\sin^2(\frac{\theta}{2} + \frac{\pi k}{m})$，这清晰地显示了峰值位置的移动。

将 HSP 推广到非阿贝尔群是量子算法研究的一个前沿领域。在这种情况下，QFT 被推广为基于群的[不可约表示](@entry_id:263310)（irreducible representations, irreps）的变换。算法的最后一步是在表示的基上进行测量。测量得到某个特定不可约表示 $\rho$ 的概率取决于该表示的性质以及隐藏[子群](@entry_id:146164) $H$。例如，对于任意群 $G$ 和[子群](@entry_id:146164) $H$，测量得到其[平凡表示](@entry_id:141357)的概率总是等于 $|H|/|G|$。对于其他非平凡的表示，概率的计算则更为复杂，通常涉及到[表示的特征标](@entry_id:198072)（characters）。尽管非阿贝尔 HSP 的通用高效解法尚未找到，但这一框架为解决如[图同构](@entry_id:143072)等重要问题提供了可能的途径。