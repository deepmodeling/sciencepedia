{
    "hands_on_practices": [
        {
            "introduction": "The first step in accurately modeling the complex interplay between plasma turbulence and magnetohydrodynamic (MHD) instabilities is choosing the appropriate set of governing equations. This exercise guides you through a fundamental scaling analysis based on the generalized Ohm's law to determine the plasma regimes where simple resistive MHD is sufficient versus those where more complex two-fluid physics, represented by the Hall term, is essential. Mastering this type of analysis is a critical skill for any theorist or simulator, as it justifies the physical basis and computational cost of the models used to study fusion plasmas.",
            "id": "4192410",
            "problem": "A reduced two-fluid magnetohydrodynamics (MHD) description of tearing mode–turbulence coupling in a tokamak core can be constructed from the generalized Ohm’s law and Maxwell’s equations. Consider the parallel component of the induction equation for the magnetic flux function $\\,\\psi\\,$ in the presence of both resistive and Hall physics, derived from the generalized Ohm’s law\n$${\\boldsymbol E} + {\\boldsymbol v} \\times {\\boldsymbol B} = \\eta_{\\mathrm{elec}}\\,{\\boldsymbol J} + \\frac{1}{n e}\\,{\\boldsymbol J} \\times {\\boldsymbol B} - \\frac{1}{n e}\\,\\nabla p_{e} + \\frac{m_{e}}{n e^{2}}\\,\\frac{\\partial {\\boldsymbol J}}{\\partial t} \\, ,$$\ntogether with Faraday’s law and Ampère’s law. In reduced MHD ordering about a strong guide field, and assuming uniform density $\\,n\\,$ and negligible electron pressure-gradient and electron-inertia contributions to $\\,E_{\\parallel}\\,$ at the scales of interest, the parallel induction equation contains two leading terms of interest:\n- a resistive diffusion term $\\,\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi\\,$ with magnetic diffusivity $\\,\\eta_{m} \\equiv \\eta_{\\mathrm{elec}}/\\mu_{0}\\,$, and\n- a Hall term $\\,d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi\\,$, where $\\,d_{i}^{2} \\equiv m_{i}/(\\mu_{0}\\,n\\,e^{2})\\,$ is the squared ion skin depth.\n\nAssume a single characteristic perpendicular scale $\\,k_{\\perp}\\,$ and a single characteristic frequency $\\,\\omega\\,$ for the coupled tearing–turbulence dynamics such that $\\,\\nabla_{\\perp}^{2}\\sim -k_{\\perp}^{2}\\,$ and $\\,\\partial_{t} \\sim \\omega\\,$ acting on $\\,\\psi\\,$. Using only the definitions above, derive an expression for the dimensionless ratio $\\,\\mathcal{R}\\,$ of the Hall term magnitude to the resistive term magnitude,\n$$\\mathcal{R} \\equiv \\frac{|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi|}{|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi|} \\, ,$$\nexpressed solely in terms of $\\,\\omega\\,$, $\\,\\eta_{m}\\,$, and $\\,d_{i}\\,$.\n\nThen evaluate $\\,\\mathcal{R}\\,$ for typical tokamak core parameters representative of deuterium plasma:\n- ion mass $\\,m_{i} = 2\\,m_{p}\\,$ with proton mass $\\,m_{p} = 1.673 \\times 10^{-27}\\,\\mathrm{kg}\\,$,\n- electron charge $\\,e = 1.602 \\times 10^{-19}\\,\\mathrm{C}\\,$,\n- vacuum permeability $\\,\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H\\,m^{-1}}\\,$,\n- density $\\,n = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}\\,$,\n- electron temperature $\\,T_{e} = 6.0 \\times 10^{3}\\,\\mathrm{eV}\\,$,\n- Coulomb logarithm $\\,\\ln\\Lambda = 17\\,$,\n- effective charge $\\,Z_{\\mathrm{eff}} = 1\\,$,\n- characteristic frequency $\\,\\omega = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}\\,$.\n\nUse the Spitzer resistivity in the form\n$$\\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9}\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_{e}^{3/2}} \\ \\mathrm{\\Omega\\,m} \\quad \\text{with } T_{e}\\text{ in eV} \\, ,$$\nand take $\\,\\eta_{m} = \\eta_{\\mathrm{elec}}/\\mu_{0}\\,$. Compute the numerical value of $\\,\\mathcal{R}\\,$ for the given parameters. Express your final answer as a pure number with no units, and round your answer to three significant figures.",
            "solution": "The problem will be validated by first extracting the given information and then checking its scientific consistency and completeness.\n\n### Step 1: Extract Givens\n- **Generalized Ohm's Law:** ${\\boldsymbol E} + {\\boldsymbol v} \\times {\\boldsymbol B} = \\eta_{\\mathrm{elec}}\\,{\\boldsymbol J} + \\frac{1}{n e}\\,{\\boldsymbol J} \\times {\\boldsymbol B} - \\frac{1}{n e}\\,\\nabla p_{e} + \\frac{m_{e}}{n e^{2}}\\,\\frac{\\partial {\\boldsymbol J}}{\\partial t}$.\n- **Context:** Reduced two-fluid MHD description of tearing mode–turbulence coupling in a tokamak core.\n- **Assumptions:** Uniform density $\\,n\\,$, negligible electron pressure-gradient and electron-inertia effects on the parallel electric field $\\,E_{\\parallel}$.\n- **Terms of Interest:**\n    - Resistive diffusion term: $\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi$\n    - Hall term: $d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi$\n- **Definitions:**\n    - Magnetic diffusivity: $\\eta_{m} \\equiv \\eta_{\\mathrm{elec}}/\\mu_{0}$\n    - Squared ion skin depth: $d_{i}^{2} \\equiv m_{i}/(\\mu_{0}\\,n\\,e^{2})$\n    - Dimensionless ratio: $\\mathcal{R} \\equiv \\frac{|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi|}{|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi|}$\n- **Scaling Relations:** $\\nabla_{\\perp}^{2}\\sim -k_{\\perp}^{2}$ and $\\partial_{t} \\sim \\omega$ when acting on $\\psi$.\n- **Plasma Parameters:**\n    - Ion mass: $m_{i} = 2\\,m_{p}$\n    - Proton mass: $m_{p} = 1.673 \\times 10^{-27}\\,\\mathrm{kg}$\n    - Electron charge: $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n    - Vacuum permeability: $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H\\,m^{-1}}$\n    - Density: $n = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n    - Electron temperature: $T_{e} = 6.0 \\times 10^{3}\\,\\mathrm{eV}$\n    - Coulomb logarithm: $\\ln\\Lambda = 17$\n    - Effective charge: $Z_{\\mathrm{eff}} = 1$\n    - Characteristic frequency: $\\omega = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$\n- **Spitzer Resistivity Formula:** $\\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9}\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_{e}^{3/2}} \\ \\mathrm{\\Omega\\,m}$ (with $T_{e}$ in eV).\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded:** The problem is based on a standard reduced model in plasma physics (two-fluid MHD), utilizing well-established concepts like generalized Ohm's law, Spitzer resistivity, and ion skin depth. All assumptions and simplifications are explicitly stated and are standard in the context of tokamak plasma turbulence.\n- **Well-Posed:** The problem provides all necessary definitions, constants, and scaling relations to derive a unique symbolic expression and then compute a specific numerical value. The tasks are clearly defined.\n- **Objective:** The problem is stated in precise, objective language, using standard terminology from plasma physics. It is free from subjective claims.\n- **Completeness and Consistency:** All required data is provided. The definitions and parameters are consistent with each other and with standard physical values.\n- **Realism:** The parameters provided are typical for the core of a modern tokamak, making the calculation physically relevant.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist. It is a standard, well-posed physics problem.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe first task is to derive an expression for the dimensionless ratio $\\mathcal{R}$ in terms of $\\omega$, $\\eta_{m}$, and $d_{i}$. The definition of $\\mathcal{R}$ is given as:\n$$ \\mathcal{R} \\equiv \\frac{|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi|}{|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi|} $$\nWe are instructed to use the scaling relations $\\nabla_{\\perp}^{2} \\sim -k_{\\perp}^{2}$ and $\\partial_{t} \\sim \\omega$ for the characteristic perpendicular scale $k_{\\perp}$ and frequency $\\omega$ of the dynamics. Applying these scalings to the operators acting on the magnetic flux function $\\psi$:\n- The magnitude of the Hall term is estimated as: $|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi| \\sim |d_{i}^{2}\\,(-k_{\\perp}^{2})\\,(\\omega\\psi)| = d_{i}^{2}\\,k_{\\perp}^{2}\\,|\\omega|\\,|\\psi|$.\n- The magnitude of the resistive term is estimated as: $|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi| \\sim |\\eta_{m}\\,(-k_{\\perp}^{2})\\,\\psi| = \\eta_{m}\\,k_{\\perp}^{2}\\,|\\psi|$.\n\nWe assume that the characteristic frequency $\\omega$ is a positive quantity, so $|\\omega| = \\omega$. The ratio $\\mathcal{R}$ is then:\n$$ \\mathcal{R} = \\frac{d_{i}^{2}\\,k_{\\perp}^{2}\\,\\omega\\,|\\psi|}{\\eta_{m}\\,k_{\\perp}^{2}\\,|\\psi|} $$\nThe terms $k_{\\perp}^{2}$ and $|\\psi|$ cancel, yielding the symbolic expression for $\\mathcal{R}$:\n$$ \\mathcal{R} = \\frac{\\omega\\,d_{i}^{2}}{\\eta_{m}} $$\nThis expression is in terms of $\\omega$, $\\eta_m$, and $d_i^2$ (or $d_i$).\n\nThe second task is to evaluate $\\mathcal{R}$ numerically. For this calculation, it is convenient to substitute the definitions of $d_{i}^{2}$ and $\\eta_{m}$:\n$$ d_{i}^{2} = \\frac{m_{i}}{\\mu_{0}\\,n\\,e^{2}} $$\n$$ \\eta_{m} = \\frac{\\eta_{\\mathrm{elec}}}{\\mu_{0}} $$\nSubstituting these into the expression for $\\mathcal{R}$:\n$$ \\mathcal{R} = \\frac{\\omega \\left( \\frac{m_{i}}{\\mu_{0}\\,n\\,e^{2}} \\right)}{\\left( \\frac{\\eta_{\\mathrm{elec}}}{\\mu_{0}} \\right)} = \\frac{\\omega\\,m_{i}\\,\\mu_{0}}{\\mu_{0}\\,n\\,e^{2}\\,\\eta_{\\mathrm{elec}}} $$\nThe vacuum permeability $\\mu_{0}$ cancels, which simplifies the calculation:\n$$ \\mathcal{R} = \\frac{\\omega\\,m_{i}}{n\\,e^{2}\\,\\eta_{\\mathrm{elec}}} $$\nNext, we calculate the Spitzer resistivity $\\eta_{\\mathrm{elec}}$ using the provided formula and parameters. The electron temperature is given in eV, as required by the formula.\n$$ \\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9}\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_{e}^{3/2}} $$\nGiven values are $Z_{\\mathrm{eff}}=1$, $\\ln\\Lambda=17$, and $T_{e} = 6.0 \\times 10^{3}\\,\\mathrm{eV}$.\n$$ T_{e}^{3/2} = (6.0 \\times 10^{3})^{3/2} = (6000)^{1.5} \\approx 464758.15 $$\n$$ \\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9} \\times \\frac{1 \\times 17}{(6.0 \\times 10^{3})^{3/2}} = \\frac{2.805 \\times 10^{-8}}{464758.15} \\approx 6.0353 \\times 10^{-14}\\,\\mathrm{\\Omega\\,m} $$\nNow we assemble the values for the final calculation of $\\mathcal{R}$:\n- $\\omega = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$\n- $m_{i} = 2\\,m_{p} = 2 \\times (1.673 \\times 10^{-27}\\,\\mathrm{kg}) = 3.346 \\times 10^{-27}\\,\\mathrm{kg}$\n- $n = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n- $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$, so $e^{2} = (1.602 \\times 10^{-19})^{2} \\approx 2.5664 \\times 10^{-38}\\,\\mathrm{C^{2}}$\n- $\\eta_{\\mathrm{elec}} \\approx 6.0353 \\times 10^{-14}\\,\\mathrm{\\Omega\\,m}$\n\nSubstitute these values into the simplified expression for $\\mathcal{R}$:\n$$ \\mathcal{R} = \\frac{(2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}) \\times (3.346 \\times 10^{-27}\\,\\mathrm{kg})}{(8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}) \\times (1.602 \\times 10^{-19}\\,\\mathrm{C})^{2} \\times (6.0353 \\times 10^{-14}\\,\\mathrm{\\Omega\\,m})} $$\n$$ \\mathcal{R} \\approx \\frac{6.692 \\times 10^{-22}}{(8.0 \\times 10^{19}) \\times (2.5664 \\times 10^{-38}) \\times (6.0353 \\times 10^{-14})} $$\n$$ \\mathcal{R} \\approx \\frac{6.692 \\times 10^{-22}}{1.23916 \\times 10^{-31}} \\approx 5.4004 \\times 10^{9} $$\nThe result indicates that for the given parameters, the Hall term is many orders of magnitude larger than the resistive term. This is physically consistent with the high temperatures and dynamic nature of core tokamak plasmas, where two-fluid effects often dominate over classical resistivity.\n\nRounding the result to three significant figures gives $5.40 \\times 10^{9}$.",
            "answer": "$$\\boxed{5.40 \\times 10^{9}}$$"
        },
        {
            "introduction": "Once the fundamental physics of a system is established, we can explore how to manipulate it for practical purposes, such as controlling instabilities. This problem focuses on one of the most important mechanisms for stabilizing turbulence and MHD modes in a tokamak: sheared plasma flow. You will perform a concrete calculation to connect a given radial electric field profile, which generates a sheared $\\vec{E} \\times \\vec{B}$ flow, to the suppression of a tearing mode, a common and potentially disruptive MHD instability. This practice provides quantitative insight into a key strategy for maintaining stable plasma confinement.",
            "id": "4192441",
            "problem": "A cylindrical tokamak plasma of minor radius $a$ has a rational surface at radius $r_s$ where the safety factor is rational. Consider a steady toroidal magnetic field $B(r) \\approx B_0$ and a monotonically increasing radial electric field profile $E_r(r) = E_a \\left(\\frac{r}{a}\\right)^p$, where $E_a$ is the value of $E_r$ at $r=a$ and $p>0$ is a known integer. The cross-field drift velocity associated with the electric field and magnetic field is the Electric-field times Magnetic-field ($\\mathrm{E}\\times\\mathrm{B}$) drift, whose magnitude is given by $V_{E}(r) = \\frac{E_r(r)}{B_0}$. The localized shear of this flow about the rational surface is frequently characterized by the radial gradient of $V_E(r)$ evaluated at $r=r_s$. In some magnetohydrodynamic contexts, a related quantity is the dimensionally consistent shear rate, defined by $\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$ with units of $\\mathrm{s}^{-1}$, and an alternative convention uses the operator $r\\,\\partial_r$ to form $\\gamma_E(r) = r\\,\\partial_r\\left(\\frac{E_r}{B_0}\\right)$ with units of velocity, which can be normalized by $r$ at the surface to yield a rate.\n\nStarting from fundamental electrodynamics and single-fluid Magnetohydrodynamics (MHD), use the definition of the $\\mathrm{E}\\times\\mathrm{B}$ drift and the given $E_r(r)$ and $B(r)$ profiles to derive the expression for the local $\\mathrm{E}\\times\\mathrm{B}$ shear rate at the rational surface in the rate form $\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$ and in the convention used in the thumbnail $\\gamma_E(r_s) = r_s\\,\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\big|_{r_s}$. Then, compare this shear to the linear tearing mode growth rate and determine the minimum edge electric field $E_a$ required to suppress island growth by shear, under the criterion\n$$\\left|\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} \\ge \\gamma_{\\mathrm{TM}},$$\nwhere $\\gamma_{\\mathrm{TM}}$ is the linear tearing mode growth rate. Assume the following scientifically plausible parameters:\n- $p=2$,\n- $B_0 = 3.0\\,\\mathrm{T}$,\n- $a = 0.80\\,\\mathrm{m}$,\n- $r_s = 0.50\\,\\mathrm{m}$,\n- $\\gamma_{\\mathrm{TM}} = 2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}$.\n\nRound your final numerical answer for $E_a$ to four significant figures. Express the final electric field in $\\mathrm{kV/m}$. No other quantities need to be reported. Angles do not appear in this problem and need no unit specification. The comparison should be made using the rate form $\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$, and you may also report $\\gamma_E(r_s)$ in your derivation for completeness, but only the minimum $E_a$ is required as the final answer.",
            "solution": "The problem as stated is first subjected to a rigorous validation process.\n\n### Step 1: Extraction of Givens\n\nVerbatim extraction of all data, variables, and conditions from the problem statement yields the following:\n- A cylindrical tokamak plasma of minor radius $a$.\n- A rational surface at radius $r_s$.\n- A steady toroidal magnetic field $B(r) \\approx B_0$.\n- A monotonically increasing radial electric field profile $E_r(r) = E_a \\left(\\frac{r}{a}\\right)^p$.\n- $E_a$ is the value of $E_r$ at $r=a$.\n- $p>0$ is a known integer.\n- The $\\mathrm{E}\\times\\mathrm{B}$ drift velocity magnitude is $V_{E}(r) = \\frac{E_r(r)}{B_0}$.\n- A shear rate definition: $\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$.\n- An alternative shear convention: $\\gamma_E(r) = r\\,\\partial_r\\left(\\frac{E_r}{B_0}\\right)$.\n- The criterion for shear suppression of tearing mode growth: $\\left|\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} \\ge \\gamma_{\\mathrm{TM}}$.\n- $\\gamma_{\\mathrm{TM}}$ is the linear tearing mode growth rate.\n- Specific parameter values:\n    - $p = 2$\n    - $B_0 = 3.0\\,\\mathrm{T}$\n    - $a = 0.80\\,\\mathrm{m}$\n    - $r_s = 0.50\\,\\mathrm{m}$\n    - $\\gamma_{\\mathrm{TM}} = 2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}$\n- The final answer for $E_a$ must be rounded to four significant figures and expressed in $\\mathrm{kV/m}$.\n\n### Step 2: Validation Using Extracted Givens\n\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded:** The problem is set within the standard theoretical framework of magnetohydrodynamics (MHD) as applied to fusion plasmas in a tokamak. The concepts of $\\mathrm{E}\\times\\mathrm{B}$ drift, sheared flows, rational surfaces, tearing modes, and the suppression of instabilities by flow shear are fundamental and well-established in this field. The given functional forms for the electric and magnetic fields are common, valid simplifications for analytical modeling. The numerical parameters are physically realistic for a modern tokamak.\n- **Well-Posed:** The problem is self-contained and clearly structured. It provides a specific physical model, a set of governing equations, a clear objective (calculate the minimum required $E_a$), a precise suppression criterion, and all necessary numerical constants. A unique and stable solution can be derived.\n- **Objective:** The language is formal, precise, and devoid of subjective or ambiguous terminology.\n- **Flaw Analysis:**\n    1.  **Scientific or Factual Unsoundness:** None. The physics is standard.\n    2.  **Non-Formalizable or Irrelevant:** The problem is formalizable and directly relevant to the topic of interaction between turbulence and MHD instabilities.\n    3.  **Incomplete or Contradictory Setup:** All required information is present and consistent.\n    4.  **Unrealistic or Infeasible:** The physical parameters are plausible.\n    5.  **Ill-Posed or Poorly Structured:** A unique solution exists.\n    6.  **Pseudo-Profound, Trivial, or Tautological:** The problem requires a straightforward but non-trivial application of calculus to a physical model, which is a standard exercise in the field.\n    7.  **Outside Scientific Verifiability:** The model and its solution are entirely verifiable within the principles of physics and mathematics.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. The solution process will now proceed.\n\nThe objective is to determine the minimum value of the edge electric field, $E_a$, required to satisfy the tearing mode suppression criterion.\n\nFirst, we define the quantity whose radial gradient we need to compute, which is the radial profile of the $\\mathrm{E}\\times\\mathrm{B}$ drift velocity, $V_E(r)$. The problem states its magnitude is given by:\n$$V_{E}(r) = \\frac{E_r(r)}{B_0}$$\nThe problem provides the radial electric field profile $E_r(r) = E_a \\left(\\frac{r}{a}\\right)^p$ and approximates the magnetic field as a constant $B_0$. Substituting these into the expression for $V_E(r)$ gives:\n$$V_{E}(r) = \\frac{1}{B_0} \\left( E_a \\left(\\frac{r}{a}\\right)^p \\right) = \\frac{E_a}{B_0 a^p} r^p$$\nThe shear suppression criterion is given in terms of the radial gradient of this velocity, which we denote as the shear rate $\\omega'_E(r)$:\n$$\\omega'_E(r) = \\partial_r V_E(r) = \\partial_r\\left(\\frac{E_r(r)}{B_0}\\right)$$\nWe compute this derivative:\n$$\\omega'_E(r) = \\partial_r\\left(\\frac{E_a}{B_0 a^p} r^p\\right)$$\nSince $E_a$, $B_0$, $a$, and $p$ are constants with respect to the radial coordinate $r$, we can pull them out of the derivative:\n$$\\omega'_E(r) = \\frac{E_a}{B_0 a^p} \\partial_r(r^p) = \\frac{E_a}{B_0 a^p} (p r^{p-1})$$\nThe criterion must be evaluated at the rational surface, $r = r_s$:\n$$\\left.\\omega'_E\\right|_{r_s} = \\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} = \\frac{p E_a r_s^{p-1}}{B_0 a^p}$$\nFor completeness, we can also write the alternative shear definition $\\gamma_E(r_s)$:\n$$\\gamma_E(r_s) = r_s \\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} = r_s \\left( \\frac{p E_a r_s^{p-1}}{B_0 a^p} \\right) = \\frac{p E_a r_s^p}{B_0 a^p}$$\nThis quantity has units of velocity, consistent with the problem description.\n\nThe suppression criterion is given as:\n$$\\left|\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} \\ge \\gamma_{\\mathrm{TM}}$$\nSubstituting our derived expression for the shear rate:\n$$\\left|\\frac{p E_a r_s^{p-1}}{B_0 a^p}\\right| \\ge \\gamma_{\\mathrm{TM}}$$\nThe problem states $E_r(r)$ is a monotonically increasing profile with $p>0$, which implies $E_a$ has the same sign as $E_r$. We can assume $E_a > 0$. All other parameters ($p$, $r_s$, $B_0$, $a$) are positive physical quantities. Therefore, the term inside the absolute value is positive, and the absolute value signs can be removed.\n$$\\frac{p E_a r_s^{p-1}}{B_0 a^p} \\ge \\gamma_{\\mathrm{TM}}$$\nWe are seeking the minimum value of $E_a$ that satisfies this condition. This minimum, $E_{a,\\text{min}}$, occurs at the equality:\n$$\\frac{p E_{a,\\text{min}} r_s^{p-1}}{B_0 a^p} = \\gamma_{\\mathrm{TM}}$$\nWe now solve for $E_{a,\\text{min}}$ algebraically:\n$$E_{a,\\text{min}} = \\frac{\\gamma_{\\mathrm{TM}} B_0 a^p}{p r_s^{p-1}}$$\nNow, we substitute the provided numerical values:\n- $p = 2$\n- $B_0 = 3.0\\,\\mathrm{T}$\n- $a = 0.80\\,\\mathrm{m}$\n- $r_s = 0.50\\,\\mathrm{m}$\n- $\\gamma_{\\mathrm{TM}} = 2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}$\n\n$$E_{a,\\text{min}} = \\frac{(2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}) (3.0\\,\\mathrm{T}) (0.80\\,\\mathrm{m})^{2}}{2 \\cdot (0.50\\,\\mathrm{m})^{2-1}}$$\n$$E_{a,\\text{min}} = \\frac{(2.00 \\times 10^{4}) (3.0) (0.64)}{2 \\cdot (0.50)}\\, \\frac{\\mathrm{s}^{-1} \\cdot \\mathrm{T} \\cdot \\mathrm{m}^2}{\\mathrm{m}}$$\nThe units are $\\mathrm{T \\cdot m \\cdot s^{-1}}$, which is equivalent to $\\mathrm{V/m}$.\n$$E_{a,\\text{min}} = \\frac{(2.00 \\times 10^{4}) \\cdot (3.0) \\cdot (0.64)}{1.0}\\,\\mathrm{V/m}$$\n$$E_{a,\\text{min}} = (6.00 \\times 10^{4}) \\cdot (0.64)\\,\\mathrm{V/m}$$\n$$E_{a,\\text{min}} = 3.84 \\times 10^{4}\\,\\mathrm{V/m}$$\nThe problem requires the answer to be expressed in units of kilovolts per meter ($\\mathrm{kV/m}$).\n$$E_{a,\\text{min}} = 38.4\\,\\mathrm{kV/m}$$\nFinally, the problem requires rounding the final answer to four significant figures.\n$$E_{a,\\text{min}} = 38.40\\,\\mathrm{kV/m}$$\nThe numerical value to be reported is $38.40$.",
            "answer": "$$\n\\boxed{38.40}\n$$"
        },
        {
            "introduction": "Theoretical models and control strategies must ultimately be validated against data, whether from simulations or experiments. This hands-on exercise moves from analytical calculation to computational data analysis, tackling the crucial question of causality. You will implement and apply modern statistical methods, including lagged cross-correlation and the information-theoretic concept of Transfer Entropy, to determine the direction of influence between two coupled processes. By analyzing synthetic time series where the underlying causal link is known, you will gain practical experience with the powerful diagnostic tools required to uncover the drivers of complex dynamics in turbulent systems.",
            "id": "4192403",
            "problem": "Consider two discrete-time series representing the interaction between turbulence and a magnetohydrodynamic (MHD) instability in a fusion plasma: the zonal flow amplitude $Z(t)$ and the MHD mode amplitude $M(t)$, sampled at uniform time step $\\Delta t$ in seconds. Assume a physically plausible linear autoregressive coupling during a finite event window, consistent with energy exchange between turbulence and MHD modes: $Z(t+1)$ depends on $Z(t)$ and $M(t)$, and $M(t+1)$ depends on $M(t)$ and $Z(t)$, with additive stochastic forcing. Suppression of one by the other is represented by a negative coupling coefficient from the driver to the target. The task is to determine, during the event window only, whether zonal flows suppress the MHD mode, or whether zonal flows are suppressed by the MHD mode, or whether neither direction is supported by the data. Your analysis must use both lagged cross-correlation and Transfer Entropy (TE), grounded in their probabilistic definitions: lagged cross-correlation between $Z(t)$ and $M(t+\\ell)$ for integer lags $\\ell$, and TE as the directed information flow from one process to the other using empirical conditional probabilities constructed from the time-series. You must not assume any formula beyond core definitions from probability and correlation.\n\nYou are provided a test suite of $5$ synthetic scenarios. In each scenario, construct the time series by evolving the following autoregressive system for $t = 0,1,\\dots,N-2$, with coupling active only inside the event window $t \\in [t_{\\mathrm{start}}, t_{\\mathrm{end}}-1]$ and inactive outside:\n$$\nZ(t+1) = \\alpha\\, Z(t) + d_{\\mathrm{eff}}(t)\\, M(t) + \\eta_Z(t),\n$$\n$$\nM(t+1) = \\beta\\, M(t) + b_{\\mathrm{eff}}(t)\\, Z(t) + \\eta_M(t),\n$$\nwhere $b_{\\mathrm{eff}}(t) = b$ and $d_{\\mathrm{eff}}(t) = d$ inside the event window, and $b_{\\mathrm{eff}}(t) = 0$, $d_{\\mathrm{eff}}(t) = 0$ outside. The stochastic terms $\\eta_Z(t)$ and $\\eta_M(t)$ are independent Gaussian random variables with zero mean and standard deviations $\\sigma_Z$ and $\\sigma_M$, respectively. Initialize $Z(0)$ and $M(0)$ by independent Gaussian draws with the same standard deviations. Use a reproducible pseudorandom generator seeded per scenario.\n\nFor each scenario, perform the following steps strictly within the event window segment of the data only:\n- Standardize the segment of $Z$ and $M$ to zero mean and unit variance before analysis.\n- Compute the empirical lagged cross-correlation between $Z(t)$ and $M(t+\\ell)$ for integer lags $\\ell \\in \\{-L,-L+1,\\dots,L\\}$, for a given maximum lag $L$, and identify the most negative correlation value and its lag $\\ell_{\\min}$.\n- Estimate the Transfer Entropy (TE) $T_{Z\\to M}$ and $T_{M\\to Z}$ using empirical conditional probabilities derived from discretizing the standardized time series into $B$ equiprobable bins via quantiles. Apply nonzero smoothing to avoid division by zero in probability estimates.\n- Decide the direction of suppression using both metrics: suppression requires anticorrelation and a consistent direction of information flow. Specifically, if the most negative correlation is below a specified threshold and occurs at a positive lag, and if $T_{Z\\to M} - T_{M\\to Z}$ exceeds a specified TE threshold, then infer that zonal flows suppress the MHD mode. If the most negative correlation occurs at a negative lag with magnitude below threshold and $T_{M\\to Z} - T_{Z\\to M}$ exceeds the TE threshold, infer that zonal flows are suppressed by the MHD mode. Otherwise, declare no direction. Report the inference as an integer: $+1$ for \"zonal flows suppress MHD\", $-1$ for \"zonal flows are suppressed by MHD\", $0$ for \"no direction\".\n- All time, when referenced, must be in seconds. Although the final outputs are unitless integers, ensure any intermediate quantities referencing time use seconds. Angles are not used. Do not use percentages.\n\nUse the following parameter sets (test suite), with the event window defined as $t_{\\mathrm{start}} = \\lfloor N/4 \\rfloor$ and $t_{\\mathrm{end}} = \\lfloor 3N/4 \\rfloor$ in each scenario, maximum lag $L = 20$, number of bins $B = 4$, smoothing parameter $\\alpha_{\\mathrm{smooth}} = 1$, cross-correlation threshold $\\rho_{\\mathrm{thr}} = 0.1$, and TE threshold $\\theta_{\\mathrm{TE}} = 0.01$:\n\n- Scenario $1$ (expected zonal flow suppression of MHD): $N = 4096$, $\\Delta t = 10^{-4}\\ \\mathrm{s}$, $\\alpha = 0.9$, $\\beta = 0.8$, $b = -0.6$, $d = 0.0$, $\\sigma_Z = 0.3$, $\\sigma_M = 0.3$, random seed $= 1$.\n- Scenario $2$ (expected MHD suppression of zonal flows): $N = 4096$, $\\Delta t = 10^{-4}\\ \\mathrm{s}$, $\\alpha = 0.85$, $\\beta = 0.9$, $b = 0.0$, $d = -0.5$, $\\sigma_Z = 0.3$, $\\sigma_M = 0.3$, random seed $= 2$.\n- Scenario $3$ (no coupling): $N = 4096$, $\\Delta t = 10^{-4}\\ \\mathrm{s}$, $\\alpha = 0.95$, $\\beta = 0.95$, $b = 0.0$, $d = 0.0$, $\\sigma_Z = 0.4$, $\\sigma_M = 0.4$, random seed $= 3$.\n- Scenario $4$ (mutual suppression, ambiguous): $N = 4096$, $\\Delta t = 10^{-4}\\ \\mathrm{s}$, $\\alpha = 0.9$, $\\beta = 0.9$, $b = -0.3$, $d = -0.3$, $\\sigma_Z = 0.3$, $\\sigma_M = 0.3$, random seed $= 4$.\n- Scenario $5$ (short event, zonal flow suppression of MHD with low noise): $N = 128$, $\\Delta t = 10^{-4}\\ \\mathrm{s}$, $\\alpha = 0.9$, $\\beta = 0.8$, $b = -0.6$, $d = 0.0$, $\\sigma_Z = 0.1$, $\\sigma_M = 0.1$, random seed $= 5$.\n\nYour program must implement the above and produce a single line of output containing the integer results for the $5$ scenarios as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4,r_5]$). The output values must be integers and the order must follow the scenarios $1$ through $5$.",
            "solution": "The problem requires an analysis of discrete-time series data, representing the interaction between zonal flow amplitude, $Z(t)$, and a magnetohydrodynamic (MHD) mode amplitude, $M(t)$, in a fusion plasma. The objective is to determine the direction of suppressive causality—whether zonal flows suppress the MHD mode ($Z \\to M$) or vice versa ($M \\to Z$)—by synthesizing two distinct statistical measures: lagged cross-correlation and Transfer Entropy.\n\nFirst, we formulate the problem by defining the data-generating process. The time series $Z(t)$ and $M(t)$ are generated using a first-order vector autoregressive (VAR(1)) model. The evolution of the system is described by the following coupled equations, sampled at a uniform time step $\\Delta t$:\n$$\nZ(t+1) = \\alpha\\, Z(t) + d_{\\mathrm{eff}}(t)\\, M(t) + \\eta_Z(t)\n$$\n$$\nM(t+1) = \\beta\\, M(t) + b_{\\mathrm{eff}}(t)\\, Z(t) + \\eta_M(t)\n$$\nHere, $\\alpha$ and $\\beta$ are autoregressive coefficients representing the memory of each process. The terms $\\eta_Z(t)$ and $\\eta_M(t)$ are independent and identically distributed stochastic forcing terms, drawn from a Gaussian distribution with zero mean and standard deviations $\\sigma_Z$ and $\\sigma_M$, respectively. The coupling is active only within a specified event window, $t \\in [t_{\\mathrm{start}}, t_{\\mathrm{end}}-1]$, where the effective coupling coefficients are $b_{\\mathrm{eff}}(t) = b$ and $d_{\\mathrm{eff}}(t) = d$. Outside this window, $b_{\\mathrm{eff}}(t) = 0$ and $d_{\\mathrm{eff}}(t) = 0$, meaning the two processes evolve independently. A negative coupling coefficient, e.g., $b < 0$, signifies that $Z(t)$ suppresses $M(t+1)$. The analysis is to be performed exclusively on the data segment within this event window.\n\nThe analysis methodology proceeds in three stages.\nFirst, the segments of the time series $Z(t)$ and $M(t)$ corresponding to the event window, $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$, are extracted. To ensure a fair comparison and remove scale effects, these segments are standardized to have a mean of $0$ and a standard deviation of $1$.\n\nSecond, we compute the empirical lagged cross-correlation, $\\rho(\\ell)$, between the standardized series. This is defined as the Pearson correlation coefficient between $Z(t)$ and $M(t+\\ell)$ for a range of integer time lags $\\ell \\in \\{-L, \\dots, L\\}$. A negative correlation indicates an anti-phase relationship, consistent with suppression. The sign of the lag $\\ell_{\\min}$ at which the most negative correlation occurs provides an initial indication of causal direction. A positive lag, $\\ell_{\\min} > 0$, suggests that changes in $Z$ precede changes in $M$ (an influence of $Z$ on $M$), while a negative lag, $\\ell_{\\min} < 0$, suggests the opposite.\n\nThird, we employ Transfer Entropy (TE) to quantify the directed flow of information between the two series. TE from a process $X$ to a process $Y$, denoted $T_{X \\to Y}$, measures the reduction in uncertainty in predicting the future of $Y$ given its own past, once the past of $X$ is also known. Assuming a first-order Markov process, consistent with our VAR(1) model, the TE is defined as:\n$$\nT_{X \\to Y} = \\sum p(y_{t+1}, y_t, x_t) \\log_2 \\frac{p(y_{t+1}|y_t, x_t)}{p(y_{t+1}|y_t)}\n$$\nTo estimate TE from the finite time series, we follow a non-parametric approach. The standardized continuous-valued series are discretized into a set of $B=4$ equiprobable bins, determined by their sample quantiles. The various joint and conditional probabilities in the TE formula are then estimated from the empirical frequencies of the discrete states. To mitigate the issue of undersampling in the state space, which could lead to zero probabilities and undefined logarithms, we apply Laplace smoothing by adding a smoothing parameter $\\alpha_{\\mathrm{smooth}}=1$ to all frequency counts. We compute TE in both directions: $T_{Z \\to M}$ and $T_{M \\to Z}$.\n\nFinally, a decision rule integrates these two metrics to yield a conclusive inference. The direction of suppression is determined as follows:\n-   **Zonal flows suppress MHD ($+1$)**: This is inferred if the most negative cross-correlation is significant (i.e., less than a threshold $\\rho_{\\mathrm{thr}} = 0.1$), its corresponding lag is positive ($\\ell_{\\min} > 0$), and the net transfer entropy from $Z$ to $M$ is significant ($T_{Z \\to M} - T_{M \\to Z} > \\theta_{\\mathrm{TE}}$, where $\\theta_{\\mathrm{TE}} = 0.01$).\n-   **Zonal flows are suppressed by MHD ($-1$)**: This is inferred if the most negative cross-correlation is significant ($\\rho(\\ell_{\\min}) < -\\rho_{\\mathrm{thr}}$), its lag is negative ($\\ell_{\\min} < 0$), and the net transfer entropy from $M$ to $Z$ is significant ($T_{M \\to Z} - T_{Z \\to M} > \\theta_{\\mathrm{TE}}$).\n-   **No direction ($0$)**: If neither of the above sets of conditions is met, no dominant direction of suppression is concluded.\n\nThis comprehensive procedure is systematically applied to a test suite of $5$ scenarios, each with distinct parameters, to generate the final output.",
            "answer": "```python\nimport numpy as np\n\ndef generate_time_series(N, alpha, beta, b, d, sigma_Z, sigma_M, seed):\n    \"\"\"\n    Generates Z(t) and M(t) time series based on the VAR(1) model.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    Z = np.zeros(N)\n    M = np.zeros(N)\n\n    # Initial conditions\n    Z[0] = rng.normal(0, sigma_Z)\n    M[0] = rng.normal(0, sigma_M)\n\n    t_start = N // 4\n    t_end = 3 * N // 4\n\n    noise_Z = rng.normal(0, sigma_Z, N - 1)\n    noise_M = rng.normal(0, sigma_M, N - 1)\n\n    for t in range(N - 1):\n        b_eff = d_eff = 0\n        if t_start <= t < t_end:\n            b_eff = b\n            d_eff = d\n        \n        Z[t+1] = alpha * Z[t] + d_eff * M[t] + noise_Z[t]\n        M[t+1] = beta * M[t] + b_eff * Z[t] + noise_M[t]\n        \n    return Z, M\n\ndef standardize(series):\n    \"\"\"\n    Standardizes a time series to zero mean and unit variance.\n    \"\"\"\n    mean = np.mean(series)\n    std = np.std(series)\n    if std < 1e-9: # Avoid division by zero for constant series\n        return series - mean\n    return (series - mean) / std\n\ndef lagged_cross_correlation(z, m, max_lag):\n    \"\"\"\n    Computes lagged cross-correlation between z(t) and m(t+l).\n    \"\"\"\n    N_win = len(z)\n    lags = np.arange(-max_lag, max_lag + 1)\n    corrs = np.zeros(len(lags))\n\n    for i, l in enumerate(lags):\n        if l >= 0:\n            x = z[0 : N_win - l]\n            y = m[l : N_win]\n        else: # l < 0\n            ll = -l\n            x = z[ll : N_win]\n            y = m[0 : N_win - ll]\n        \n        if len(x) < 2:\n            corrs[i] = 0\n            continue\n            \n        corrs[i] = np.corrcoef(x, y)[0, 1]\n\n    min_corr_val = np.min(corrs)\n    min_corr_lag = lags[np.argmin(corrs)]\n    \n    return min_corr_val, min_corr_lag\n\ndef calculate_te(source, target, n_bins, alpha_smooth):\n    \"\"\"\n    Estimates the Transfer Entropy from a source series to a target series.\n    \"\"\"\n    # 1. Discretize into equiprobable bins using quantiles\n    source_edges = np.quantile(source, np.linspace(0, 1, n_bins + 1))\n    target_edges = np.quantile(target, np.linspace(0, 1, n_bins + 1))\n    \n    source_binned = np.digitize(source, source_edges[1:-1])\n    target_binned = np.digitize(target, target_edges[1:-1])\n\n    # 2. Form state vectors\n    y_tp1 = target_binned[1:]\n    y_t = target_binned[:-1]\n    x_t = source_binned[:-1]\n    n_samples = len(x_t)\n\n    # 3. Compute count matrices (histograms)\n    counts_3d = np.zeros((n_bins, n_bins, n_bins))\n    for i in range(n_samples):\n        counts_3d[y_tp1[i], y_t[i], x_t[i]] += 1\n\n    counts_2d_yt_xt = np.sum(counts_3d, axis=0)\n    counts_2d_ytp1_yt = np.sum(counts_3d, axis=2)\n    counts_1d_yt = np.sum(counts_2d_yt_xt, axis=1)\n\n    # 4. Calculate TE using the formula: T = sum(p(y_t+1,y_t,x_t) * log2(p(y_t+1|y_t,x_t)/p(y_t+1|y_t)))\n    te = 0.0\n    total_count_3d = n_samples + (n_bins**3) * alpha_smooth\n\n    for i in range(n_bins):  # y_t+1\n        for j in range(n_bins):  # y_t\n            # Denominator term of log\n            denom_count_sum = counts_1d_yt[j] + n_bins * alpha_smooth\n            if denom_count_sum == 0: continue\n            p_cond_2 = (counts_2d_ytp1_yt[i, j] + alpha_smooth) / denom_count_sum\n            if p_cond_2 == 0: continue\n\n            for k in range(n_bins): # x_t\n                # Joint probability for summation\n                p_joint_3d = (counts_3d[i, j, k] + alpha_smooth) / total_count_3d\n                if p_joint_3d == 0: continue\n\n                # Numerator term of log\n                num_count_sum = counts_2d_yt_xt[j, k] + n_bins * alpha_smooth\n                if num_count_sum == 0: continue\n                p_cond_1 = (counts_3d[i, j, k] + alpha_smooth) / num_count_sum\n                if p_cond_1 == 0: continue\n                \n                log_term = np.log2(p_cond_1 / p_cond_2)\n                te += p_joint_3d * log_term\n    return te\n\ndef analyze_scenario(params):\n    \"\"\"\n    Runs the full analysis for a single scenario.\n    \"\"\"\n    # Unpack parameters\n    N, dt, alpha_p, beta_p, b, d, sigma_Z, sigma_M, seed = params\n    L = 20\n    B = 4\n    alpha_smooth = 1.0\n    rho_thr = 0.1\n    theta_TE = 0.01\n\n    # Generate time series\n    Z, M = generate_time_series(N, alpha_p, beta_p, b, d, sigma_Z, sigma_M, seed)\n\n    # Extract event window and standardize\n    t_start = N // 4\n    t_end = 3 * N // 4\n    Z_win = Z[t_start:t_end]\n    M_win = M[t_start:t_end]\n    \n    if len(Z_win) < L*2: # Not enough data for analysis\n        return 0\n\n    z_std = standardize(Z_win)\n    m_std = standardize(M_win)\n\n    # Lagged cross-correlation\n    min_corr, lag_min = lagged_cross_correlation(z_std, m_std, L)\n\n    # Transfer Entropy\n    T_ZM = calculate_te(z_std, m_std, B, alpha_smooth)\n    T_MZ = calculate_te(m_std, z_std, B, alpha_smooth)\n\n    # Decision logic\n    result = 0\n    if min_corr < -rho_thr:\n        if lag_min > 0 and (T_ZM - T_MZ) > theta_TE:\n            result = 1\n        elif lag_min < 0 and (T_MZ - T_ZM) > theta_TE:\n            result = -1\n    \n    return result\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # N, dt, alpha, beta, b, d, sigma_Z, sigma_M, seed\n        (4096, 1e-4, 0.9, 0.8, -0.6, 0.0, 0.3, 0.3, 1),\n        (4096, 1e-4, 0.85, 0.9, 0.0, -0.5, 0.3, 0.3, 2),\n        (4096, 1e-4, 0.95, 0.95, 0.0, 0.0, 0.4, 0.4, 3),\n        (4096, 1e-4, 0.9, 0.9, -0.3, -0.3, 0.3, 0.3, 4),\n        (128, 1e-4, 0.9, 0.8, -0.6, 0.0, 0.1, 0.1, 5),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_scenario(case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}