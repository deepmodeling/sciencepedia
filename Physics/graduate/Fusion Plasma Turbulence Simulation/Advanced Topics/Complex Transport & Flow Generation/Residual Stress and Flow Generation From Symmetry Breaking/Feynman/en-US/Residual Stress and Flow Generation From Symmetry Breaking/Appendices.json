{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a rigorous, first-principles demonstration of how turbulence gives rise to momentum transport. By working through the Fourier-space integrals for a prescribed symmetric turbulence spectrum , you will prove why the residual stress $\\Pi^{\\mathrm{res}}$ must be zero, while also deriving an estimate for the turbulent momentum diffusivity $\\chi_{\\phi}$ that arises from the same turbulent fluctuations. This practice solidifies the foundational link between symmetry, non-diffusive transport, and diffusive transport in plasma turbulence.",
            "id": "4198944",
            "problem": "Consider an electrostatic, drift-wave dominated turbulence in a local straight-field-line flux-tube model with a uniform magnetic field $\\boldsymbol{B}$ of magnitude $B$ directed along the parallel coordinate $\\parallel$. Let the perpendicular plane be spanned by the radial coordinate $r$ and the poloidal coordinate $\\theta$. The fluctuating electrostatic potential is decomposed in Fourier modes as $\\tilde{\\phi}(\\boldsymbol{x},t)=\\sum_{\\boldsymbol{k}}\\phi_{\\boldsymbol{k}}(t)\\exp(i\\boldsymbol{k}\\cdot\\boldsymbol{x})$, where $\\boldsymbol{k}\\equiv(k_{r},k_{\\theta},k_{\\parallel})$. The fluctuating electric cross magnetic field (E$\\times$B) drift velocity is given by $\\tilde{\\boldsymbol{v}}_{E}=(c/B)\\,\\hat{\\boldsymbol{b}}\\times\\nabla\\tilde{\\phi}$, with $\\hat{\\boldsymbol{b}}$ the unit vector along $\\boldsymbol{B}$ and $c$ the speed of light. In Fourier space this implies $v_{E,r}(\\boldsymbol{k})=(c/B)\\,k_{\\theta}\\,\\phi_{\\boldsymbol{k}}$ and $v_{E,\\theta}(\\boldsymbol{k})=-(c/B)\\,k_{r}\\,\\phi_{\\boldsymbol{k}}$. Assume the turbulence spectrum of the potential is prescribed and factorizes as\n$$\n|\\phi_{\\boldsymbol{k}}|^{2}=\\Phi_{0}^{2}\\,\\exp\\!\\left(-\\frac{k_{r}^{2}+k_{\\theta}^{2}}{k_{0}^{2}}\\right)\\,\\exp\\!\\left(-\\frac{k_{\\parallel}^{2}}{k_{\\parallel 0}^{2}}\\right),\n$$\nwith $\\Phi_{0}$, $k_{0}$, and $k_{\\parallel 0}$ real positive constants. This spectrum is isotropic in the poloidal plane and symmetric in $k_{\\parallel}$.\n\nDefine the toroidal momentum flux (Reynolds stress contribution to the toroidal channel) as the correlation $\\Pi_{\\phi}\\equiv m_{i}n_{0}R\\,\\langle\\tilde{v}_{r}\\,\\tilde{v}_{\\phi}\\rangle$, where $m_{i}$ is the ion mass, $n_{0}$ the equilibrium density, $R$ the major radius, and angled brackets denote an ensemble average. Decompose this flux as $\\Pi_{\\phi}=-\\chi_{\\phi}\\,\\partial U/\\partial r+\\Pi^{\\mathrm{res}}$, where $U(r)$ is the mean toroidal flow, $\\chi_{\\phi}$ is the turbulent momentum diffusivity, and $\\Pi^{\\mathrm{res}}$ is the residual stress, defined as the part of the flux that persists when $\\partial U/\\partial r=0$.\n\nStarting from the definitions above and basic symmetry considerations of the gyrokinetic linear response for the parallel velocity fluctuation, use the assumed spectrum to:\n\n1. Demonstrate quantitatively, by writing an explicit $k$-space integral for the quasilinear residual stress, why $\\Pi^{\\mathrm{res}}=0$ in the absence of any $k_{\\parallel}$ asymmetry.\n\n2. Under the eddy-viscosity (mixing-length) approximation with a $k$-independent correlation time $\\tau_{0}$ (constant in $k$-space), estimate the turbulent momentum diffusivity $\\chi_{\\phi}$ from the same spectrum by evaluating the appropriate $k$-space integral. Express your final $\\chi_{\\phi}$ in $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$. You may treat the isotropy in the poloidal plane rigorously by angular averaging.\n\nYour final answer must be a single, closed-form analytic expression for the pair $(\\Pi^{\\mathrm{res}},\\chi_{\\phi})$ written as a row matrix. No numerical evaluation is required, and no rounding is needed.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard theoretical problem in the field of fusion plasma turbulence. A crucial step in formalizing the problem is the interpretation of the \"toroidal velocity fluctuation\" $\\tilde{v}_{\\phi}$ in the definition of the momentum flux $\\Pi_{\\phi}\\equiv m_{i}n_{0}R\\,\\langle\\tilde{v}_{r}\\,\\tilde{v}_{\\phi}\\rangle$. The problem context, particularly the mention of \"residual stress,\" \"$k_{\\parallel}$ asymmetry,\" and the \"gyrokinetic linear response for the parallel velocity fluctuation,\" strongly implies that $\\tilde{v}_{\\phi}$ represents the parallel velocity fluctuation, $\\tilde{v}_{\\parallel}$. In a simple flux-tube geometry, the parallel direction is the primary component of the toroidal direction. The alternative, interpreting $\\tilde{v}_{\\phi}$ as the poloidal E$\\times$B drift component $\\tilde{v}_{\\theta}$, would lead to an identically zero Reynolds stress $\\langle \\tilde{v}_{r}\\tilde{v}_{\\theta} \\rangle$ due to the symmetry of the given spectrum, rendering the second part of the problem ill-posed. Therefore, we proceed with the physically meaningful interpretation $\\tilde{v}_{\\phi} \\equiv \\tilde{v}_{\\parallel}$.\n\n### Part 1: Residual Stress $\\Pi^{\\mathrm{res}}$\n\nThe residual stress is the component of the momentum flux that exists in the absence of a mean flow gradient, defined as $\\Pi^{\\mathrm{res}} = m_{i}n_{0}R\\,\\langle\\tilde{v}_{r}\\,\\tilde{v}_{\\parallel}\\rangle$. To evaluate this, we use the quasilinear expression for the flux, which involves integrating over the Fourier spectrum of the turbulence. A standard result from kinetic theory for drift-wave turbulence shows that the momentum flux is generated by a specific cross-phase between velocity components, leading to an expression of the form:\n$$\n\\langle\\tilde{v}_{r}\\,\\tilde{v}_{\\parallel}\\rangle \\propto \\int \\frac{d^3k}{(2\\pi)^3} k_\\theta k_\\parallel \\text{Im}[\\chi(\\boldsymbol{k})] |\\phi_{\\boldsymbol{k}}|^2\n$$\nHere, $\\text{Im}[\\chi(\\boldsymbol{k})]$ is the imaginary (dissipative) part of the plasma susceptibility, and $|\\phi_{\\boldsymbol{k}}|^2$ is the turbulence spectrum. To generate a net flux, the integrand must be asymmetric with respect to $k_\\parallel \\to -k_\\parallel$. Let's examine the symmetry of each term in the integrand, $F(\\boldsymbol{k}) = k_\\theta k_\\parallel \\text{Im}[\\chi(\\boldsymbol{k})] |\\phi_{\\boldsymbol{k}}|^2$:\n\n1.  **Turbulence Spectrum $|\\phi_{\\boldsymbol{k}}|^2$:** The given spectrum, $|\\phi_{\\boldsymbol{k}}|^{2}=\\Phi_{0}^{2}\\,\\exp\\!\\left(-\\frac{k_{r}^{2}+k_{\\theta}^{2}}{k_{0}^{2}}\\right)\\,\\exp\\!\\left(-\\frac{k_{\\parallel}^{2}}{k_{\\parallel 0}^{2}}\\right)$, is explicitly an even function of $k_\\parallel$, since it depends on $k_\\parallel^2$.\n2.  **Plasma Susceptibility $\\text{Im}[\\chi(\\boldsymbol{k})]$:** In the absence of any background symmetry-breaking mechanism (like mean flow, flow shear, or asymmetric geometry), the plasma's linear response must be symmetric. Physical dissipation mechanisms, such as wave-particle resonances, are symmetric with respect to the direction of wave propagation along the magnetic field. Therefore, $\\text{Im}[\\chi(\\boldsymbol{k})]$ must be an even function of $k_\\parallel$.\n3.  **Wavenumber Product $k_\\theta k_\\parallel$:** This term contains a single factor of $k_\\parallel$, making it an odd function with respect to the transformation $k_\\parallel \\to -k_\\parallel$.\n\nCombining these properties, the full integrand $F(\\boldsymbol{k})$ is a product of two even functions ($|\\phi_{\\boldsymbol{k}}|^2$ and $\\text{Im}[\\chi(\\boldsymbol{k})]$) and one odd function ($k_\\parallel$). The result is an odd function of $k_\\parallel$:\n$$\nF(k_r, k_\\theta, -k_\\parallel) = -F(k_r, k_\\theta, k_\\parallel)\n$$\nThe residual stress is calculated by integrating $F(\\boldsymbol{k})$ over all $\\boldsymbol{k}$-space. The integral over $k_\\parallel$ is performed over a symmetric domain, from $-\\infty$ to $+\\infty$. The integral of an odd function over a symmetric interval is identically zero:\n$$\n\\Pi^{\\mathrm{res}} \\propto \\int_{-\\infty}^{\\infty} dk_\\parallel \\, F(k_r, k_\\theta, k_\\parallel) = 0\n$$\nThus, for a plasma with a symmetric background and a symmetric turbulence spectrum, the residual stress must be zero. A net stress can only be generated if a symmetry-breaking mechanism makes the integrand asymmetric in $k_\\parallel$.\n\n### Part 2: Turbulent Momentum Diffusivity $\\chi_{\\phi}$\n\nThe problem asks for an estimate of the turbulent momentum diffusivity $\\chi_{\\phi}$ under the eddy-viscosity (or mixing-length) approximation, assuming a constant correlation time $\\tau_0$. In this framework, the diffusivity is proportional to the variance of the turbulent velocity multiplied by the correlation time. The relevant velocity for radial transport is the radial velocity fluctuation $\\tilde{v}_r$.\n$$\n\\chi_{\\phi} \\approx \\tau_0 \\langle \\tilde{v}_{r}^2 \\rangle\n$$\nWe calculate the mean-square radial velocity by integrating its spectral density over all wavenumbers:\n$$\n\\langle \\tilde{v}_{r}^2 \\rangle = \\int \\frac{d^3k}{(2\\pi)^3} |\\tilde{v}_{r}(\\boldsymbol{k})|^2\n$$\nUsing the given Fourier-space expression $\\tilde{v}_{r}(\\boldsymbol{k})=(c/B)\\,k_{\\theta}\\,\\phi_{\\boldsymbol{k}}$, we get:\n$$\n|\\tilde{v}_{r}(\\boldsymbol{k})|^2 = \\left(\\frac{c}{B}\\right)^2 k_{\\theta}^2 |\\phi_{\\boldsymbol{k}}|^2\n$$\nSubstituting the provided spectrum for $|\\phi_{\\boldsymbol{k}}|^2$:\n$$\n\\chi_{\\phi} = \\tau_0 \\int \\frac{d^3k}{(2\\pi)^3} \\left(\\frac{c}{B}\\right)^2 k_{\\theta}^2 \\Phi_{0}^{2}\\,\\exp\\!\\left(-\\frac{k_{r}^{2}+k_{\\theta}^{2}}{k_{0}^{2}}\\right)\\,\\exp\\!\\left(-\\frac{k_{\\parallel}^{2}}{k_{\\parallel 0}^{2}}\\right)\n$$\nWe can separate the integral into three parts corresponding to $k_r$, $k_\\theta$, and $k_\\parallel$:\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 \\Phi_0^2}{(2\\pi)^3} \\left(\\frac{c}{B}\\right)^2 \\left[ \\int_{-\\infty}^{\\infty} dk_r \\exp\\!\\left(-\\frac{k_r^2}{k_0^2}\\right) \\right] \\left[ \\int_{-\\infty}^{\\infty} dk_\\theta k_\\theta^2 \\exp\\!\\left(-\\frac{k_\\theta^2}{k_0^2}\\right) \\right] \\left[ \\int_{-\\infty}^{\\infty} dk_\\parallel \\exp\\!\\left(-\\frac{k_\\parallel^2}{k_{\\parallel 0}^2}\\right) \\right]\n$$\nThese are standard Gaussian integrals of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$ and $\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) dx = \\frac{1}{2a}\\sqrt{\\pi/a}$.\n\n1.  The $k_r$ integral: with $a=1/k_0^2$, we have $\\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{k_r^2}{k_0^2}\\right) dk_r = \\sqrt{\\pi k_0^2} = k_0\\sqrt{\\pi}$.\n2.  The $k_\\theta$ integral: with $a=1/k_0^2$, we have $\\int_{-\\infty}^{\\infty} k_\\theta^2 \\exp\\!\\left(-\\frac{k_\\theta^2}{k_0^2}\\right) dk_\\theta = \\frac{1}{2(1/k_0^2)}\\sqrt{\\pi k_0^2} = \\frac{k_0^2}{2} k_0\\sqrt{\\pi} = \\frac{k_0^3\\sqrt{\\pi}}{2}$.\n3.  The $k_\\parallel$ integral: with $a=1/k_{\\parallel 0}^2$, we have $\\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{k_\\parallel^2}{k_{\\parallel 0}^2}\\right) dk_\\parallel = \\sqrt{\\pi k_{\\parallel 0}^2} = k_{\\parallel 0}\\sqrt{\\pi}$.\n\nCombining these results:\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 \\Phi_0^2}{(2\\pi)^3} \\left(\\frac{c}{B}\\right)^2 (k_0\\sqrt{\\pi}) \\left(\\frac{k_0^3\\sqrt{\\pi}}{2}\\right) (k_{\\parallel 0}\\sqrt{\\pi})\n$$\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 \\Phi_0^2}{8\\pi^3} \\left(\\frac{c}{B}\\right)^2 \\frac{k_0^4 k_{\\parallel 0} \\pi^{3/2}}{2}\n$$\nSimplifying the numerical factors:\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 c^2 \\Phi_0^2 k_0^4 k_{\\parallel 0}}{16 B^2 \\pi^{3/2}}\n$$\nThis expression provides the turbulent momentum diffusivity in terms of the given spectral parameters and the correlation time, and it has the correct physical dimensions of $\\mathrm{m}^2 \\mathrm{s}^{-1}$.\n\nThe final answer is the pair $(\\Pi^{\\mathrm{res}}, \\chi_{\\phi})$.\n$$\n\\Pi^{\\mathrm{res}} = 0\n$$\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 c^2 \\Phi_0^2 k_0^4 k_{\\parallel 0}}{16 B^2 \\pi^{3/2}}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\tau_0 c^2 \\Phi_0^2 k_0^4 k_{\\parallel 0}}{16 B^2 \\pi^{\\frac{3}{2}}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Symmetry breaking is the key to generating residual stress, a concept that can be clearly demonstrated by constructing synthetic turbulent fields where a specific symmetry is broken by a controllable parameter. This coding practice makes the abstract principle of parity and symmetry breaking tangible. By numerically computing the momentum flux for both symmetric and asymmetric fields , you will directly observe how a non-zero residual stress emerges and how its sign and magnitude are tied to the nature of the symmetry breaking.",
            "id": "4198950",
            "problem": "Consider a simplified, flux-tube representation of a magnetized plasma with up-down symmetry and zero mean parallel flow. Let the poloidal angle be denoted by $\\theta$, defined over a periodic domain $\\theta \\in [-\\pi,\\pi)$, and time be denoted by $t$, defined over a finite interval with uniform sampling. In normalized units where the number density is $n = 1$ and the ion mass is $m_i = 1$, the toroidal (or parallel) momentum flux is defined by the spatio-temporal average\n$$\n\\Pi = \\left\\langle v_r(\\theta,t)\\,v_{\\parallel}(\\theta,t) \\right\\rangle_{\\theta,t},\n$$\nwhere $v_r(\\theta,t)$ is the radial Electric Cross Magnetic (E$\\times$B) drift velocity fluctuation and $v_{\\parallel}(\\theta,t)$ is the parallel velocity fluctuation. The residual stress, $\\Pi^{\\mathrm{res}}$, is the component of $\\Pi$ that exists in the absence of mean flow and mean gradient drive and, under the assumptions specified here (zero mean parallel flow, symmetric boundary conditions, and no imposed mean gradients), reduces to\n$$\n\\Pi^{\\mathrm{res}} = \\left\\langle v_r(\\theta,t)\\,v_{\\parallel}(\\theta,t) \\right\\rangle_{\\theta,t}.\n$$\n\nUp-down symmetry implies a definite parity of fluctuations with respect to $\\theta \\to -\\theta$ in the absence of symmetry breaking. In particular, if $v_r(\\theta,t)$ is even in $\\theta$ and $v_{\\parallel}(\\theta,t)$ is odd in $\\theta$ (or vice versa), then the product $v_r(\\theta,t)\\,v_{\\parallel}(\\theta,t)$ is odd in $\\theta$, and its flux-surface average vanishes. To study residual stress generation from symmetry breaking in a controlled way, consider synthetic fluctuating fields defined as\n$$\nv_r(\\theta,t) = A\\cos(k\\,\\theta)\\cos(\\omega\\,t) + \\epsilon\\,A\\sin(k\\,\\theta)\\cos(\\omega\\,t),\n$$\n$$\nv_{\\parallel}(\\theta,t) = B\\sin(k\\,\\theta)\\cos(\\omega\\,t),\n$$\nwhere $A$, $B$ are real amplitudes, $k$ is an integer mode number, $\\omega$ is a real angular frequency, and $\\epsilon$ is a small real parameter that explicitly breaks the up-down symmetry by adding an odd-in-$\\theta$ component to $v_r(\\theta,t)$.\n\nFor $\\epsilon = 0$, the fields satisfy up-down symmetry with $v_r(\\theta,t)$ even in $\\theta$ and $v_{\\parallel}(\\theta,t)$ odd in $\\theta$, and hence $\\Pi^{\\mathrm{res}} = 0$ ideally. For $\\epsilon \\neq 0$, the odd component of $v_r(\\theta,t)$ correlates with the odd component of $v_{\\parallel}(\\theta,t)$ to produce a non-zero even-in-$\\theta$ contribution to the average, yielding a finite $\\Pi^{\\mathrm{res}}$ whose sign is controlled by the sign of $\\epsilon$ and whose magnitude scales linearly with $\\epsilon$ for sufficiently small $|\\epsilon|$.\n\nYour task is to write a complete, runnable program that:\n- Constructs the discrete grids in $\\theta$ and $t$ with symmetric, periodic boundary conditions in $\\theta$ (do not include the endpoint $\\theta = \\pi$), uses angles measured in radians, and evaluates the fields $v_r(\\theta,t)$ and $v_{\\parallel}(\\theta,t)$ according to the definitions above.\n- Computes the residual stress as the mean\n$$\n\\Pi^{\\mathrm{res}} = \\frac{1}{N_\\theta N_t}\\sum_{j=0}^{N_\\theta-1}\\sum_{n=0}^{N_t-1} v_r(\\theta_j,t_n)\\,v_{\\parallel}(\\theta_j,t_n),\n$$\nwhere $N_\\theta$ is the number of poloidal grid points and $N_t$ is the number of time samples.\n- Determines, for each test case, the numerical value of $\\Pi^{\\mathrm{res}}$, verifies that it vanishes within numerical precision when $\\epsilon = 0$, and checks that its sign matches $\\mathrm{sign}(\\epsilon)$ when $\\epsilon \\neq 0$. Additionally, for $\\epsilon \\neq 0$, compute the expected magnitude based on parity and averaging arguments. For the synthetic fields above, under uniform sampling in $\\theta$ and $t$, the expected leading-order magnitude of $\\Pi^{\\mathrm{res}}$ is\n$$\n\\Pi^{\\mathrm{res}}_{\\mathrm{expected}} = \\frac{A\\,B\\,\\epsilon}{4},\n$$\nbecause $\\langle \\sin^2(k\\,\\theta) \\rangle_\\theta = \\frac{1}{2}$ and $\\langle \\cos^2(\\omega\\,t) \\rangle_t = \\frac{1}{2}$ for uniform sampling. Your program should verify that the computed magnitude is consistent with this expected value within a specified tolerance.\n\nUse the following test suite parameters to exercise different facets of the computation:\n\n- Test case $1$ (perfect symmetry, expected zero): $A = 1.0$, $B = 0.75$, $k = 3$, $\\omega = 2.0$, $\\epsilon = 0.0$, $N_\\theta = 1024$, $N_t = 1024$.\n- Test case $2$ (weak positive symmetry breaking): $A = 1.0$, $B = 0.75$, $k = 3$, $\\omega = 2.0$, $\\epsilon = +1.0\\times 10^{-1}$, $N_\\theta = 1024$, $N_t = 1024$.\n- Test case $3$ (weak negative symmetry breaking): $A = 1.0$, $B = 0.75$, $k = 3$, $\\omega = 2.0$, $\\epsilon = -1.0\\times 10^{-1}$, $N_\\theta = 1024$, $N_t = 1024$.\n\nAll quantities are in dimensionless, normalized units, and angles are in radians. For the zero-verification in test case $1$, use a numerical tolerance of $\\tau_0 = 1.0\\times 10^{-12}$ on the absolute value of $\\Pi^{\\mathrm{res}}$. For the magnitude consistency checks in test cases $2$ and $3$, use a relative tolerance of $\\tau_{\\mathrm{rel}} = 1.0\\times 10^{-6}$ when comparing $\\Pi^{\\mathrm{res}}$ with $\\Pi^{\\mathrm{res}}_{\\mathrm{expected}}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order:\n    $[\\Pi^{\\mathrm{res}}_1, \\mathrm{zero\\_ok}_1, \\Pi^{\\mathrm{res}}_2, \\mathrm{sign\\_ok}_2, \\mathrm{mag\\_ok}_2, \\Pi^{\\mathrm{res}}_3, \\mathrm{sign\\_ok}_3, \\mathrm{mag\\_ok}_3]$,\n  where $\\Pi^{\\mathrm{res}}_i$ are floats, and $\\mathrm{zero\\_ok}_1$, $\\mathrm{sign\\_ok}_2$, $\\mathrm{mag\\_ok}_2$, $\\mathrm{sign\\_ok}_3$, $\\mathrm{mag\\_ok}_3$ are booleans. For example, an admissible output format is $[0.0,True,0.01875,True,True,-0.01875,True,True]$.",
            "solution": "The problem requires the numerical computation and validation of residual stress, $\\Pi^{\\mathrm{res}}$, generated by synthetic turbulent fluctuations in a simplified model of a magnetized plasma. The core physical principle being investigated is the generation of a net momentum flux from the breaking of spatial symmetry.\n\nThe solution is implemented by following a sequence of steps derived from the problem's physical and mathematical definitions.\n\nFirst, we establish the discrete spatio-temporal domain for the calculation. The poloidal angle, $\\theta$, is defined over a periodic domain $[-\\pi,\\pi)$. This is discretized into $N_\\theta$ points using `numpy.linspace(-numpy.pi, numpy.pi, N_theta, endpoint=False)`, which creates a uniform grid that correctly implements the periodic boundary condition by excluding the endpoint. Time, $t$, is discretized over a finite interval with $N_t$ uniform samples. To ensure that the numerical average of time-periodic functions like $\\cos^2(\\omega t)$ accurately approximates the analytical value of $1/2$, the time interval is chosen to span an integer number of oscillation periods. The period is $T = 2\\pi/\\omega$. We select a total simulation duration of $M=10$ periods, so the time grid is $t_n \\in [0, 10 \\cdot 2\\pi/\\omega)$ sampled uniformly. With the given parameters $k=3, \\omega=2.0$ and $N_\\theta=N_t=1024$, this grid construction ensures that the discrete Fourier sums used to evaluate the averages of trigonometric functions yield results that are, to machine precision, identical to their continuous integral counterparts. For example, $\\frac{1}{N_\\theta}\\sum_{j=0}^{N_\\theta-1} \\sin^2(k\\theta_j) = 1/2$ and $\\frac{1}{N_\\theta}\\sum_{j=0}^{N_\\theta-1} \\sin(2k\\theta_j) = 0$ exactly, provided $2k$ is not a multiple of $N_\\theta$.\n\nSecond, using this grid, the fluctuating fields $v_r(\\theta, t)$ and $v_\\parallel(\\theta, t)$ are evaluated according to their definitions:\n$$\nv_r(\\theta,t) = A\\cos(k\\,\\theta)\\cos(\\omega\\,t) + \\epsilon\\,A\\sin(k\\,\\theta)\\cos(\\omega\\,t)\n$$\n$$\nv_{\\parallel}(\\theta,t) = B\\sin(k\\,\\theta)\\cos(\\omega\\,t)\n$$\nThese are constructed as $N_\\theta \\times N_t$ two-dimensional arrays. The parameter $\\epsilon$ controls the symmetry breaking: for $\\epsilon=0$, $v_r$ is purely even in $\\theta$ while $v_\\parallel$ is odd. For $\\epsilon \\neq 0$, $v_r$ acquires an odd component, breaking the overall symmetry of the system.\n\nThird, the residual stress $\\Pi^{\\mathrm{res}}$ is computed as the spatio-temporal average of the momentum flux, $v_r v_\\parallel$:\n$$\n\\Pi^{\\mathrm{res}} = \\frac{1}{N_\\theta N_t}\\sum_{j=0}^{N_\\theta-1}\\sum_{n=0}^{N_t-1} v_r(\\theta_j,t_n)\\,v_{\\parallel}(\\theta_j,t_n)\n$$\nNumerically, this corresponds to taking the element-wise product of the $v_r$ and $v_\\parallel$ arrays and then computing the mean of the resulting array. The product is:\n$$\nv_r v_\\parallel = \\left(A\\cos(k\\theta)\\cos(\\omega t) + \\epsilon A\\sin(k\\theta)\\cos(\\omega t)\\right) \\left(B\\sin(k\\theta)\\cos(\\omega t)\\right)\n$$\n$$\n= A B \\cos(k\\theta)\\sin(k\\theta)\\cos^2(\\omega t) + \\epsilon A B \\sin^2(k\\theta)\\cos^2(\\omega t)\n$$\nThe first term, $A B (\\frac{1}{2}\\sin(2k\\theta))\\cos^2(\\omega t)$, is odd in $\\theta$, and its spatial average over the symmetric domain $[-\\pi, \\pi)$ is zero. The second term is even in $\\theta$ and has a non-zero average.\n\nFourth, applying the averaging operator $\\langle \\cdot \\rangle_{\\theta,t}$ and using the identities $\\langle\\sin(2k\\theta)\\rangle_\\theta = 0$, $\\langle\\sin^2(k\\theta)\\rangle_\\theta = 1/2$, and $\\langle\\cos^2(\\omega t)\\rangle_t = 1/2$, the expected analytical result is:\n$$\n\\Pi^{\\mathrm{res}} = \\langle \\epsilon A B \\sin^2(k\\theta)\\cos^2(\\omega t) \\rangle_{\\theta,t} = \\epsilon A B \\langle\\sin^2(k\\theta)\\rangle_\\theta \\langle\\cos^2(\\omega t)\\rangle_t = \\frac{A B \\epsilon}{4}\n$$\n\nFinally, for each test case provided, the program computes $\\Pi^{\\mathrm{res}}$ and performs the required verifications:\n- For Test Case $1$ ($\\epsilon=0$), the expected residual stress is $0$. The program verifies that the absolute value of the computed $\\Pi^{\\mathrm{res}}_1$ is less than the specified tolerance $\\tau_0 = 1.0 \\times 10^{-12}$.\n- For Test Cases $2$ and $3$ ($\\epsilon \\neq 0$), the program verifies two conditions. First, it confirms that the sign of the computed $\\Pi^{\\mathrm{res}}$ matches the sign of $\\epsilon$. Second, it computes the expected theoretical value $\\Pi^{\\mathrm{res}}_{\\mathrm{expected}} = A B \\epsilon / 4$ and verifies that the relative error, $|\\Pi^{\\mathrm{res}} - \\Pi^{\\mathrm{res}}_{\\mathrm{expected}}| / |\\Pi^{\\mathrm{res}}_{\\mathrm{expected}}|$, is within the specified tolerance $\\tau_{\\mathrm{rel}} = 1.0 \\times 10^{-6}$.\n\nThe results from all test cases are compiled into a single list and formatted as specified for the final output. This procedure rigorously tests the numerical implementation against the analytical model of symmetry-breaking-induced residual stress.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes residual stress for given synthetic plasma fluctuation data\n    and verifies the results against theoretical expectations.\n    \"\"\"\n    \n    test_cases = [\n        # (A, B, k, omega, epsilon, N_theta, N_t)\n        (1.0, 0.75, 3, 2.0, 0.0, 1024, 1024),\n        (1.0, 0.75, 3, 2.0, 1.0e-1, 1024, 1024),\n        (1.0, 0.75, 3, 2.0, -1.0e-1, 1024, 1024),\n    ]\n\n    tolerances = {\n        'zero_abs': 1.0e-12,\n        'mag_rel': 1.0e-6,\n    }\n\n    results = []\n\n    for i, case in enumerate(test_cases):\n        A, B, k, omega, epsilon, N_theta, N_t = case\n        \n        # 1. Construct the discrete grids in theta and t.\n        # theta grid over a periodic domain [-pi, pi)\n        theta_grid = np.linspace(-np.pi, np.pi, N_theta, endpoint=False)\n        \n        # time grid over an interval of 10 periods to ensure accurate averaging\n        period = 2.0 * np.pi / omega\n        t_max = 10 * period\n        t_grid = np.linspace(0, t_max, N_t, endpoint=False)\n        \n        # Reshape for broadcasting\n        theta = theta_grid[:, np.newaxis]\n        t = t_grid[np.newaxis, :]\n        \n        # 2. Evaluate the fields vr(theta, t) and v_parallel(theta, t).\n        cos_kt = np.cos(k * theta)\n        sin_kt = np.sin(k * theta)\n        cos_wt = np.cos(omega * t)\n        \n        # Radial E x B drift velocity fluctuation\n        v_r = A * cos_kt * cos_wt + epsilon * A * sin_kt * cos_wt\n        \n        # Parallel velocity fluctuation\n        v_parallel = B * sin_kt * cos_wt\n        \n        # 3. Compute the residual stress.\n        momentum_flux = v_r * v_parallel\n        pi_res = np.mean(momentum_flux)\n        \n        # 4. Perform verifications based on the test case.\n        if i == 0:  # Test case 1: epsilon = 0\n            # Expected result is zero.\n            zero_ok = np.abs(pi_res)  tolerances['zero_abs']\n            results.extend([pi_res, zero_ok])\n        else:  # Test cases 2 and 3: epsilon != 0\n            # Check sign\n            sign_ok = np.sign(pi_res) == np.sign(epsilon)\n            \n            # Check magnitude\n            pi_res_expected = (A * B * epsilon) / 4.0\n            \n            # Relative error check, guarding against division by zero\n            # though not expected for these cases.\n            if pi_res_expected != 0:\n                relative_error = np.abs(pi_res - pi_res_expected) / np.abs(pi_res_expected)\n                mag_ok = relative_error  tolerances['mag_rel']\n            else: # Should not be reached in test cases 2  3\n                mag_ok = np.abs(pi_res)  tolerances['zero_abs']\n\n            results.extend([pi_res, sign_ok, mag_ok])\n\n    # 5. Format and print the final output.\n    # Convert booleans to Python's True/False for correct string representation\n    formatted_results = []\n    for item in results:\n        if isinstance(item, np.bool_):\n            formatted_results.append(str(bool(item)))\n        elif isinstance(item, float):\n            # The example output uses standard float representation\n            formatted_results.append(str(item))\n        else:\n            formatted_results.append(str(item))\n            \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Residual stress acts as an internal source of momentum, driving the plasma to rotate even in the absence of any external torque. This \"intrinsic rotation\" is determined by the balance between the residual stress drive and momentum transport processes like diffusion and convection. This exercise connects the microscopic physics of turbulent stress to the macroscopic, observable plasma rotation profile . By solving the steady-state momentum balance equation, you will derive how a given residual stress profile shapes the resulting intrinsic rotation, a critical phenomenon in modern fusion devices.",
            "id": "4198986",
            "problem": "Consider an axisymmetric, large-aspect-ratio toroidal plasma whose minor radius is $a$ and major radius is $R_0$, with constant mass density $n_0 m_i$ and constant geometric factor $R_0$. Let the mean toroidal angular velocity be $\\Omega(r)$, where $r \\in [0,a]$ is the radial coordinate. The steady-state toroidal angular momentum conservation law in cylindrical coordinates states that the divergence of the total radial flux of toroidal angular momentum equals the external torque density $S_{\\varphi}(r)$. Assume zero external torque in the core, i.e., $S_{\\varphi}(r)=0$ for $0 \\le r \\le a$. The total radial flux of toroidal angular momentum is modeled by the sum of three contributions: (i) a diffusive flux proportional to the radial gradient of $\\Omega(r)$, (ii) a convective pinch flux proportional to $\\Omega(r)$, and (iii) a residual stress $\\Pi^{\\mathrm{res}}(r)$ arising from symmetry breaking in the turbulence. All transport coefficients are spatially constant.\n\nDefine the effective moment-of-inertia density $I \\equiv n_0 m_i R_0^2$, the momentum diffusivity $\\chi_{\\varphi}  0$, and the momentum pinch velocity $V_p$ (constant). Let the prescribed residual stress profile be\n$$\n\\Pi^{\\mathrm{res}}(r) = \\Pi_0 \\exp\\!\\left(-\\frac{r}{L}\\right),\n$$\nwhere $\\Pi_0$ and $L0$ are given constants. Impose the core regularity condition that $\\Omega(r)$ remains finite as $r \\to 0$, and impose an edge boundary condition representing strong damping at the plasma boundary: $\\Omega(a)=0$. Assume parameters satisfy $V_p + \\chi_{\\varphi}/L \\neq 0$.\n\nStarting only from the steady-state conservation of toroidal angular momentum and the above constitutive structure for the flux, derive and solve the resulting boundary value problem to obtain the closed-form analytic expression for the rotation profile $\\Omega(r)$ in terms of $I$, $\\chi_{\\varphi}$, $V_p$, $\\Pi_0$, $L$, $a$, and $r$. Then, based on the structure of the differential equation and the boundary conditions, discuss whether the solution is unique under the stated assumptions.\n\nExpress the final $\\Omega(r)$ as a single closed-form analytic expression. No rounding is required, and you should not include physical units in the final expression.",
            "solution": "The problem is deemed valid as it is scientifically grounded in plasma transport theory, mathematically well-posed, objective, and contains a complete and consistent set of givens, definitions, and boundary conditions.\n\nThe starting point is the steady-state toroidal angular momentum conservation law in an axisymmetric cylindrical system. With no external torque density, $S_{\\varphi}(r) = 0$, the law is expressed as the divergence of the radial flux of toroidal angular momentum being zero:\n$$\n\\frac{1}{r} \\frac{d}{dr} (r \\Pi_{r\\varphi}) = 0\n$$\nwhere $\\Pi_{r\\varphi}$ is the radial flux density of toroidal angular momentum. Integrating this equation with respect to $r$ yields $r \\Pi_{r\\varphi} = C_1$, where $C_1$ is a constant of integration.\n\nThe problem imposes a core regularity condition, stating that the angular velocity $\\Omega(r)$ must remain finite as $r \\to 0$. Let us examine the implications of this condition. The flux $\\Pi_{r\\varphi}$ is composed of terms that are expected to be finite at the origin. Specifically, for a physically regular solution, the radial gradient of the angular velocity must vanish at the axis of symmetry, $\\frac{d\\Omega}{dr}|_{r=0} = 0$. The residual stress $\\Pi^{\\mathrm{res}}(r)$ approaches a finite value $\\Pi_0$ as $r \\to 0$. Therefore, the total flux $\\Pi_{r\\varphi}$ is finite at $r=0$.\nFrom the relation $\\Pi_{r\\varphi} = C_1/r$, for $\\Pi_{r\\varphi}$ to be finite at $r=0$, the constant $C_1$ must be zero. This simplifies the conservation law to a zero-flux condition for $r > 0$:\n$$\n\\Pi_{r\\varphi}(r) = 0\n$$\nThe problem specifies the constitutive relation for the flux $\\Pi_{r\\varphi}$ as the sum of diffusive, convective, and residual stress components. Using the defined parameters $I$, $\\chi_{\\varphi}$, and $V_p$:\n$$\n\\Pi_{r\\varphi} = -I \\chi_{\\varphi} \\frac{d\\Omega}{dr} + I V_p \\Omega(r) + \\Pi^{\\mathrm{res}}(r)\n$$\nSubstituting the given profile for the residual stress, $\\Pi^{\\mathrm{res}}(r) = \\Pi_0 \\exp(-r/L)$, and applying the zero-flux condition, we obtain a first-order, linear, inhomogeneous ordinary differential equation (ODE) for $\\Omega(r)$:\n$$\n-I \\chi_{\\varphi} \\frac{d\\Omega}{dr} + I V_p \\Omega(r) + \\Pi_0 \\exp\\left(-\\frac{r}{L}\\right) = 0\n$$\nWe can write this in the standard form $\\frac{dy}{dx} + P(x)y = Q(x)$:\n$$\n\\frac{d\\Omega}{dr} - \\frac{V_p}{\\chi_{\\varphi}} \\Omega(r) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-\\frac{r}{L}\\right)\n$$\nTo solve this ODE, we use the method of integrating factors. The integrating factor $\\mu(r)$ is:\n$$\n\\mu(r) = \\exp\\left( \\int -\\frac{V_p}{\\chi_{\\varphi}} dr \\right) = \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right)\n$$\nMultiplying the ODE by $\\mu(r)$ transforms the left side into the derivative of a product:\n$$\n\\frac{d}{dr} \\left( \\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) \\right) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-\\frac{r}{L}\\right) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right)\n$$\n$$\n\\frac{d}{dr} \\left( \\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) \\right) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-r\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right)\n$$\nIntegrating both sides with respect to $r$ from an arbitrary point to $r$:\n$$\n\\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) = \\int \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-r\\left(\\frac{\\chi_{\\varphi} + L V_p}{L \\chi_{\\varphi}}\\right)\\right) dr + C\n$$\nwhere $C$ is the constant of integration. Performing the integration, and using the given condition $V_p + \\chi_{\\varphi}/L \\neq 0$, we find:\n$$\n\\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\left( -\\frac{L \\chi_{\\varphi}}{\\chi_{\\varphi} + L V_p} \\right) \\exp\\left(-r\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right) + C\n$$\n$$\n\\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) = -\\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{r}{L} - \\frac{V_p r}{\\chi_{\\varphi}}\\right) + C\n$$\nSolving for $\\Omega(r)$ gives the general solution:\n$$\n\\Omega(r) = C \\exp\\left(\\frac{V_p r}{\\chi_{\\varphi}}\\right) - \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{r}{L}\\right)\n$$\nThe constant $C$ is determined by the edge boundary condition $\\Omega(a)=0$:\n$$\n0 = C \\exp\\left(\\frac{V_p a}{\\chi_{\\varphi}}\\right) - \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{a}{L}\\right)\n$$\nSolving for $C$:\n$$\nC = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{a}{L}\\right) \\exp\\left(-\\frac{V_p a}{\\chi_{\\varphi}}\\right) = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-a\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right)\n$$\nSubstituting this expression for $C$ back into the general solution for $\\Omega(r)$:\n$$\n\\Omega(r) = \\left( \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-a\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right) \\right) \\exp\\left(\\frac{V_p r}{\\chi_{\\varphi}}\\right) - \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{r}{L}\\right)\n$$\nFactoring out the common terms and combining the exponents yields the final expression for the rotation profile:\n$$\n\\Omega(r) = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\left[ \\exp\\left(-a\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right) + \\frac{V_p r}{\\chi_{\\varphi}}\\right) - \\exp\\left(-\\frac{r}{L}\\right) \\right]\n$$\nThis can be written more compactly as:\n$$\n\\Omega(r) = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\left[ \\exp\\left(-\\frac{a}{L} - \\frac{V_p(a-r)}{\\chi_{\\varphi}}\\right) - \\exp\\left(-\\frac{r}{L}\\right) \\right]\n$$\nRegarding uniqueness, the problem is fundamentally a second-order boundary value problem described by the equation $\\frac{d}{dr}(r \\Pi_{r\\varphi}) = 0$, with $\\Pi_{r\\varphi}$ containing a derivative of $\\Omega$. Such a problem requires two boundary conditions for a unique solution. The problem provides two distinct physical constraints: (1) core regularity ($\\Omega(r)$ is finite as $r \\to 0$) and (2) an edge boundary condition ($\\Omega(a)=0$). The regularity condition at $r=0$ forces the integration constant from the initial integration of the momentum conservation law to be zero, simplifying the problem to a first-order ODE, $\\Pi_{r\\varphi}=0$. The existence and uniqueness theorem for first-order linear ODEs guarantees that with one boundary condition, $\\Omega(a)=0$, the solution for $\\Omega(r)$ on the interval $[0, a]$ is unique, provided the coefficients are well-behaved, which they are. Thus, the derived solution is the unique solution under the given assumptions.",
            "answer": "$$\n\\boxed{\\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\left[ \\exp\\left(-\\frac{a}{L} - \\frac{V_p(a-r)}{\\chi_{\\varphi}}\\right) - \\exp\\left(-\\frac{r}{L}\\right) \\right]}\n$$"
        }
    ]
}