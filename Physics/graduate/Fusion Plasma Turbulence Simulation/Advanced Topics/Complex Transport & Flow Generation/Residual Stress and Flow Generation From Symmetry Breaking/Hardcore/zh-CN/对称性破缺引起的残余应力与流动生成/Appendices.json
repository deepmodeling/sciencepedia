{
    "hands_on_practices": [
        {
            "introduction": "理解残余应力的理论基石在于弄清楚它在何种情况下*不会*产生。本练习将通过严格的计算，展示一个完全对称的湍流谱为何无法产生残余应力。同时，本练习也会将残余应力与动量通量的扩散分量联系起来，揭示扩散和残余分量如何源于同一个潜在的湍流场。",
            "id": "4198944",
            "problem": "考虑一个在局部直场线通量管模型中的静电漂移波主导的湍流，该模型中存在一个大小为 $B$ 的均匀磁场 $\\boldsymbol{B}$，其方向沿着平行坐标 $\\parallel$。设垂直平面由径向坐标 $r$ 和极向坐标 $\\theta$ 张成。涨落的静电势被分解为傅里叶模，形式为 $\\tilde{\\phi}(\\boldsymbol{x},t)=\\sum_{\\boldsymbol{k}}\\phi_{\\boldsymbol{k}}(t)\\exp(i\\boldsymbol{k}\\cdot\\boldsymbol{x})$，其中 $\\boldsymbol{k}\\equiv(k_{r},k_{\\theta},k_{\\parallel})$。涨落的电场叉磁场（E$\\times$B）漂移速度由 $\\tilde{\\boldsymbol{v}}_{E}=(c/B)\\,\\hat{\\boldsymbol{b}}\\times\\nabla\\tilde{\\phi}$ 给出，其中 $\\hat{\\boldsymbol{b}}$ 是沿 $\\boldsymbol{B}$ 方向的单位矢量，$c$ 是光速。在傅里叶空间中，这意味着 $v_{E,r}(\\boldsymbol{k})=(c/B)\\,k_{\\theta}\\,\\phi_{\\boldsymbol{k}}$ 和 $v_{E,\\theta}(\\boldsymbol{k})=-(c/B)\\,k_{r}\\,\\phi_{\\boldsymbol{k}}$。假设电势的湍流谱是预先给定的，并可分解为如下形式：\n$$\n|\\phi_{\\boldsymbol{k}}|^{2}=\\Phi_{0}^{2}\\,\\exp\\!\\left(-\\frac{k_{r}^{2}+k_{\\theta}^{2}}{k_{0}^{2}}\\right)\\,\\exp\\!\\left(-\\frac{k_{\\parallel}^{2}}{k_{\\parallel 0}^{2}}\\right),\n$$\n其中 $\\Phi_{0}$、$k_{0}$ 和 $k_{\\parallel 0}$ 是实正常数。该谱在极向平面上是各向同性的，并且关于 $k_{\\parallel}$ 是对称的。\n\n将环向动量通量（雷诺应力对环向通道的贡献）定义为相关 $\\Pi_{\\phi}\\equiv m_{i}n_{0}R\\,\\langle\\tilde{v}_{r}\\,\\tilde{v}_{\\phi}\\rangle$，其中 $m_{i}$ 是离子质量，$n_{0}$ 是平衡密度，$R$ 是大半径，尖括号表示系综平均。将此通量分解为 $\\Pi_{\\phi}=-\\chi_{\\phi}\\,\\partial U/\\partial r+\\Pi^{\\mathrm{res}}$，其中 $U(r)$ 是平均环向流，$\\chi_{\\phi}$ 是湍流动量扩散系数，而 $\\Pi^{\\mathrm{res}}$ 是残余应力，定义为当 $\\partial U/\\partial r=0$ 时仍然存在的那部分通量。\n\n从以上定义和回旋动理学线性响应关于平行速度涨落的基本对称性考虑出发，使用假设的谱：\n\n1.  通过写出准线性残余应力的显式$k$空间积分，定量地证明，在没有任何$k_{\\parallel}$不对称性的情况下，为什么 $\\Pi^{\\mathrm{res}}=0$。\n\n2.  在涡粘（混合长度）近似下，假设相关时间 $\\tau_{0}$ 与 $k$ 无关（在$k$空间中为常数），通过计算相应的$k$空间积分，从相同的谱中估算湍流动量扩散系数 $\\chi_{\\phi}$。将你的最终 $\\chi_{\\phi}$ 以 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ 为单位表示。你可以通过角度平均来严格处理极向平面上的各向同性。\n\n你的最终答案必须是关于该对 $(\\Pi^{\\mathrm{res}},\\chi_{\\phi})$ 的一个单一的、闭合形式的解析表达式，写成一个行矩阵。不需要进行数值计算，也不需要四舍五入。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。这是聚变等离子体湍流领域的标准理论问题。形式化该问题的关键一步是解释动量通量定义 $\\Pi_{\\phi}\\equiv m_{i}n_{0}R\\,\\langle\\tilde{v}_{r}\\,\\tilde{v}_{\\phi}\\rangle$ 中的“环向速度涨落”$\\tilde{v}_{\\phi}$。问题的上下文，特别是提到“残余应力”、“$k_{\\parallel}$不对称性”和“回旋动理学线性响应关于平行速度涨落”，强烈暗示 $\\tilde{v}_{\\phi}$ 代表平行速度涨落 $\\tilde{v}_{\\parallel}$。在简单的通量管几何中，平行方向是环向的主要分量。另一种选择，将 $\\tilde{v}_{\\phi}$ 解释为极向E$\\times$B漂移分量 $\\tilde{v}_{\\theta}$，由于给定谱的对称性，将导致雷诺应力 $\\langle \\tilde{v}_{r}\\tilde{v}_{\\theta} \\rangle$ 恒为零，从而使问题的第二部分不适定。因此，我们采用具有物理意义的解释 $\\tilde{v}_{\\phi} \\equiv \\tilde{v}_{\\parallel}$。\n\n### 第1部分：残余应力 $\\Pi^{\\mathrm{res}}$\n\n残余应力是在平均流梯度不存在时（即 $\\partial U/\\partial r=0$）的动量通量分量，由径向速度涨落和环向（平行）速度涨落的关联给出：\n$$\n\\Pi^{\\mathrm{res}} = m_{i}n_{0}R\\,\\langle\\tilde{v}_{r}\\,\\tilde{v}_{\\parallel}\\rangle\n$$\n在准线性理论中，该通量是在傅里叶空间中对所有波矢 $\\boldsymbol{k}$ 的积分。其来源是涨落场之间的交叉相位。准线性平行方向动量通量的标准表达式涉及被积函数 $F(\\boldsymbol{k}) \\propto k_\\theta k_\\parallel \\text{Im}(\\chi_{\\boldsymbol{k}}) |\\phi_{\\boldsymbol{k}}|^2$，其中 $\\text{Im}(\\chi_{\\boldsymbol{k}})$ 是等离子体磁化率的虚部（与耗散有关），$|\\phi_{\\boldsymbol{k}}|^2$ 是势函数的湍流谱。\n$$\n\\Pi^{\\mathrm{res}} \\propto \\int \\frac{d^3k}{(2\\pi)^3} F(\\boldsymbol{k})\n$$\n要使积分结果非零，被积函数必须包含关于 $k_\\parallel$ 的不对称部分。让我们来分析 $F(\\boldsymbol{k})$ 的对称性。\n\n1.  **湍流谱的对称性**: 问题中给定的谱 $|\\phi_{\\boldsymbol{k}}|^{2}$ 是 $k_{\\parallel}$ 的偶函数，即 $|\\phi_{\\boldsymbol{k}}(k_r, k_\\theta, -k_\\parallel)|^2 = |\\phi_{\\boldsymbol{k}}(k_r, k_\\theta, k_\\parallel)|^2$。\n2.  **响应函数的对称性**: 在一个没有内建对称性破缺（如平均流剪切、几何非对称性等）的系统中，物理过程对平行方向没有偏好。因此，线性响应函数（特别是其耗散部分 $\\text{Im}[\\chi(\\boldsymbol{k})]$）也必须是 $k_{\\parallel}$ 的偶函数，即 $\\text{Im}[\\chi(k_r, k_\\theta, -k_\\parallel)] = \\text{Im}[\\chi(k_r, k_\\theta, k_\\parallel)]$。\n\n现在，我们来分析整个被积函数 $F(\\boldsymbol{k})$ 在变换 $k_{\\parallel} \\to -k_{\\parallel}$ 下的对称性：\n$$\nF(k_r, k_\\theta, -k_\\parallel) \\propto k_\\theta (-k_\\parallel) \\text{Im}[\\chi(k_r, k_\\theta, k_\\parallel)] |\\phi_{\\boldsymbol{k}}(k_r, k_\\theta, k_\\parallel)|^2 = - F(k_r, k_\\theta, k_\\parallel)\n$$\n被积函数是 $k_{\\parallel}$ 的一个奇函数。由于积分区间（从 $-\\infty$ 到 $+\\infty$）关于 $k_{\\parallel}=0$ 是对称的，一个奇函数在其上的积分恒为零。\n$$\n\\Pi^{\\mathrm{res}} \\propto \\int dk_r \\int dk_\\theta \\int_{-\\infty}^{\\infty} dk_\\parallel \\, F(k_r, k_\\theta, k_\\parallel) = 0\n$$\n因此，在一个具有对称谱和对称响应的系统中，残余应力必须为零。\n\n### 第2部分：湍流动量扩散系数 $\\chi_{\\phi}$\n\n问题要求在涡粘（或混合长度）近似下，并假设相关时间 $\\tau_0$ 为常数的情况下，估算湍流动量扩散系数 $\\chi_{\\phi}$。在这个框架下，扩散系数与湍流速度的方差乘以相关时间成正比。与径向输运相关的速度是径向速度涨落 $\\tilde{v}_r$。\n$$\n\\chi_{\\phi} \\approx \\tau_0 \\langle \\tilde{v}_{r}^2 \\rangle\n$$\n我们通过对其谱密度在所有波数上积分来计算均方径向速度：\n$$\n\\langle \\tilde{v}_{r}^2 \\rangle = \\int \\frac{d^3k}{(2\\pi)^3} |\\tilde{v}_{r}(\\boldsymbol{k})|^2\n$$\n使用给定的傅里叶空间表达式 $\\tilde{v}_{r}(\\boldsymbol{k})=(c/B)\\,k_{\\theta}\\,\\phi_{\\boldsymbol{k}}$，我们得到：\n$$\n|\\tilde{v}_{r}(\\boldsymbol{k})|^2 = \\left(\\frac{c}{B}\\right)^2 k_{\\theta}^2 |\\phi_{\\boldsymbol{k}}|^2\n$$\n代入给定的 $|\\phi_{\\boldsymbol{k}}|^2$ 谱：\n$$\n\\chi_{\\phi} = \\tau_0 \\int \\frac{d^3k}{(2\\pi)^3} \\left(\\frac{c}{B}\\right)^2 k_{\\theta}^2 \\Phi_{0}^{2}\\,\\exp\\!\\left(-\\frac{k_{r}^{2}+k_{\\theta}^{2}}{k_{0}^{2}}\\right)\\,\\exp\\!\\left(-\\frac{k_{\\parallel}^{2}}{k_{\\parallel 0}^{2}}\\right)\n$$\n我们可以将积分分成对应于 $k_r$、$k_\\theta$ 和 $k_\\parallel$ 的三个部分：\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 \\Phi_0^2}{(2\\pi)^3} \\left(\\frac{c}{B}\\right)^2 \\left[ \\int_{-\\infty}^{\\infty} dk_r \\exp\\!\\left(-\\frac{k_r^2}{k_0^2}\\right) \\right] \\left[ \\int_{-\\infty}^{\\infty} dk_\\theta k_\\theta^2 \\exp\\!\\left(-\\frac{k_\\theta^2}{k_0^2}\\right) \\right] \\left[ \\int_{-\\infty}^{\\infty} dk_\\parallel \\exp\\!\\left(-\\frac{k_\\parallel^2}{k_{\\parallel 0}^2}\\right) \\right]\n$$\n这些是标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$ 和 $\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) dx = \\frac{1}{2a}\\sqrt{\\pi/a}$。\n\n1.  $k_r$ 积分：令 $a=1/k_0^2$，我们有 $\\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{k_r^2}{k_0^2}\\right) dk_r = \\sqrt{\\pi k_0^2} = k_0\\sqrt{\\pi}$。\n2.  $k_\\theta$ 积分：令 $a=1/k_0^2$，我们有 $\\int_{-\\infty}^{\\infty} k_\\theta^2 \\exp\\!\\left(-\\frac{k_\\theta^2}{k_0^2}\\right) dk_\\theta = \\frac{1}{2(1/k_0^2)}\\sqrt{\\pi k_0^2} = \\frac{k_0^2}{2} k_0\\sqrt{\\pi} = \\frac{k_0^3\\sqrt{\\pi}}{2}$。\n3.  $k_\\parallel$ 积分：令 $a=1/k_{\\parallel 0}^2$，我们有 $\\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{k_\\parallel^2}{k_{\\parallel 0}^2}\\right) dk_\\parallel = \\sqrt{\\pi k_{\\parallel 0}^2} = k_{\\parallel 0}\\sqrt{\\pi}$。\n\n结合这些结果：\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 \\Phi_0^2}{(2\\pi)^3} \\left(\\frac{c}{B}\\right)^2 (k_0\\sqrt{\\pi}) \\left(\\frac{k_0^3\\sqrt{\\pi}}{2}\\right) (k_{\\parallel 0}\\sqrt{\\pi})\n$$\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 \\Phi_0^2}{8\\pi^3} \\left(\\frac{c}{B}\\right)^2 \\frac{k_0^4 k_{\\parallel 0} \\pi^{3/2}}{2}\n$$\n简化数值因子：\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 c^2 \\Phi_0^2 k_0^4 k_{\\parallel 0}}{16 B^2 \\pi^{3/2}}\n$$\n该表达式用给定的谱参数和相关时间表示了湍流动量扩散系数，并且它具有正确的物理量纲 $\\mathrm{m}^2 \\mathrm{s}^{-1}$。\n\n最终答案是这对 $(\\Pi^{\\mathrm{res}}, \\chi_{\\phi})$。\n$$\n\\Pi^{\\mathrm{res}} = 0\n$$\n$$\n\\chi_{\\phi} = \\frac{\\tau_0 c^2 \\Phi_0^2 k_0^4 k_{\\parallel 0}}{16 B^2 \\pi^{3/2}}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{\\tau_0 c^2 \\Phi_0^2 k_0^4 k_{\\parallel 0}}{16 B^2 \\pi^{3/2}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从抽象的理论过渡到具体的实例，是加深理解的关键。本练习将引导你编写一个简短的程序来构建合成的湍流场。通过控制一个明确破坏系统对称性的小参数，你将直接观察到非零残余应力的出现，从而在数学形式和可测量的结果之间建立起清晰直观的联系。",
            "id": "4198950",
            "problem": "考虑一个具有上下对称性和零平均平行流的磁化等离子体的简化磁通管模型。令角向角用 $\\theta$ 表示，其定义在一个周期性区间 $\\theta \\in [-\\pi,\\pi)$ 上；时间用 $t$ 表示，其定义在一个均匀采样的有限区间内。在归一化单位下，数密度 $n = 1$ 且离子质量 $m_i = 1$，环向（或平行）动量通量由时空平均定义为\n$$\n\\Pi = \\left\\langle v_r(\\theta,t)\\,v_{\\parallel}(\\theta,t) \\right\\rangle_{\\theta,t},\n$$\n其中 $v_r(\\theta,t)$ 是径向电场叉磁场（E$\\times$B）漂移速度涨落，$v_{\\parallel}(\\theta,t)$ 是平行速度涨落。残余应力 $\\Pi^{\\mathrm{res}}$ 是在没有平均流和平均梯度驱动的情况下存在的 $\\Pi$ 的分量，并且在本文指定的假设（零平均平行流、对称边界条件和无施加的平均梯度）下，可简化为\n$$\n\\Pi^{\\mathrm{res}} = \\left\\langle v_r(\\theta,t)\\,v_{\\parallel}(\\theta,t) \\right\\rangle_{\\theta,t}.\n$$\n\n在没有对称性破缺的情况下，上下对称性意味着涨落对于 $\\theta \\to -\\theta$ 变换具有确定的宇称。特别地，如果 $v_r(\\theta,t)$ 是 $\\theta$ 的偶函数，而 $v_{\\parallel}(\\theta,t)$ 是 $\\theta$ 的奇函数（反之亦然），那么乘积 $v_r(\\theta,t)\\,v_{\\parallel}(\\theta,t)$ 是 $\\theta$ 的奇函数，其磁面平均值为零。为了以可控的方式研究由对称性破缺产生的残余应力，我们考虑如下定义的人工构造的涨落场\n$$\nv_r(\\theta,t) = A\\cos(k\\,\\theta)\\cos(\\omega\\,t) + \\epsilon\\,A\\sin(k\\,\\theta)\\cos(\\omega\\,t),\n$$\n$$\nv_{\\parallel}(\\theta,t) = B\\sin(k\\,\\theta)\\cos(\\omega\\,t),\n$$\n其中 $A$、$B$ 是实数振幅，$k$ 是整数模数，$\\omega$ 是实数角频率，$\\epsilon$ 是一个小的实数参数，它通过向 $v_r(\\theta,t)$ 添加一个关于 $\\theta$ 的奇函数分量来显式地打破上下对称性。\n\n对于 $\\epsilon = 0$，场满足上下对称性，$v_r(\\theta,t)$ 是 $\\theta$ 的偶函数，$v_{\\parallel}(\\theta,t)$ 是 $\\theta$ 的奇函数，因此理想情况下 $\\Pi^{\\mathrm{res}} = 0$。对于 $\\epsilon \\neq 0$，$v_r(\\theta,t)$ 的奇函数分量与 $v_{\\parallel}(\\theta,t)$ 的奇函数分量相关联，从而对平均值产生一个非零的关于 $\\theta$ 的偶函数贡献，得到一个有限的 $\\Pi^{\\mathrm{res}}$。其符号由 $\\epsilon$ 的符号控制，其大小在 $|\\epsilon|$ 足够小时与 $\\epsilon$ 线性相关。\n\n您的任务是编写一个完整、可运行的程序，该程序能够：\n- 构建 $\\theta$ 和 $t$ 的离散网格，其中 $\\theta$ 具有对称的周期性边界条件（不包括端点 $\\theta = \\pi$），使用以弧度为单位的角度，并根据上述定义计算场 $v_r(\\theta,t)$ 和 $v_{\\parallel}(\\theta,t)$。\n- 将残余应力计算为平均值\n$$\n\\Pi^{\\mathrm{res}} = \\frac{1}{N_\\theta N_t}\\sum_{j=0}^{N_\\theta-1}\\sum_{n=0}^{N_t-1} v_r(\\theta_j,t_n)\\,v_{\\parallel}(\\theta_j,t_n),\n$$\n其中 $N_\\theta$ 是角向网格点数，$N_t$ 是时间样本数。\n- 对每个测试用例，确定 $\\Pi^{\\mathrm{res}}$ 的数值，验证当 $\\epsilon = 0$ 时其在数值精度范围内为零，并检查当 $\\epsilon \\neq 0$ 时其符号是否与 $\\mathrm{sign}(\\epsilon)$ 匹配。此外，对于 $\\epsilon \\neq 0$ 的情况，根据宇称和平均论证计算预期量级。对于上述人工构造的场，在 $\\theta$ 和 $t$ 上均匀采样的情况下，$\\Pi^{\\mathrm{res}}$ 的预期主导阶量级为\n$$\n\\Pi^{\\mathrm{res}}_{\\mathrm{expected}} = \\frac{A\\,B\\,\\epsilon}{4},\n$$\n因为对于均匀采样，$\\langle \\sin^2(k\\,\\theta) \\rangle_\\theta = \\frac{1}{2}$ 且 $\\langle \\cos^2(\\omega\\,t) \\rangle_t = \\frac{1}{2}$。您的程序应验证计算出的量级在指定容差内与该期望值一致。\n\n使用以下测试套件参数来检验计算的不同方面：\n\n- 测试用例 1（完美对称性，期望为零）：$A = 1.0$，$B = 0.75$，$k = 3$，$\\omega = 2.0$，$\\epsilon = 0.0$，$N_\\theta = 1024$，$N_t = 1024$。\n- 测试用例 2（弱正对称性破缺）：$A = 1.0$，$B = 0.75$，$k = 3$，$\\omega = 2.0$，$\\epsilon = +1.0\\times 10^{-1}$，$N_\\theta = 1024$，$N_t = 1024$。\n- 测试用例 3（弱负对称性破缺）：$A = 1.0$，$B = 0.75$，$k = 3$，$\\omega = 2.0$，$\\epsilon = -1.0\\times 10^{-1}$，$N_\\theta = 1024$，$N_t = 1024$。\n\n所有量均为无量纲的归一化单位，角度以弧度为单位。对于测试用例 1 中的零值验证，对 $\\Pi^{\\mathrm{res}}$ 的绝对值使用数值容差 $\\tau_0 = 1.0\\times 10^{-12}$。对于测试用例 2 和 3 中的量级一致性检查，当比较 $\\Pi^{\\mathrm{res}}$ 与 $\\Pi^{\\mathrm{res}}_{\\mathrm{expected}}$ 时，使用相对容差 $\\tau_{\\mathrm{rel}} = 1.0\\times 10^{-6}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含：\n    $[\\Pi^{\\mathrm{res}}_1, \\mathrm{zero\\_ok}_1, \\Pi^{\\mathrm{res}}_2, \\mathrm{sign\\_ok}_2, \\mathrm{mag\\_ok}_2, \\Pi^{\\mathrm{res}}_3, \\mathrm{sign\\_ok}_3, \\mathrm{mag\\_ok}_3]$，\n  其中 $\\Pi^{\\mathrm{res}}_i$ 是浮点数，$\\mathrm{zero\\_ok}_1$、$\\mathrm{sign\\_ok}_2$、$\\mathrm{mag\\_ok}_2$、$\\mathrm{sign\\_ok}_3$、$\\mathrm{mag\\_ok}_3$ 是布尔值。例如，一个可接受的输出格式是 [0.0,True,0.01875,True,True,-0.01875,True,True]。",
            "solution": "该问题要求在一个简化的磁化等离子体模型中，对由人工构造的湍流涨落产生的残余应力 $\\Pi^{\\mathrm{res}}$ 进行数值计算和验证。所研究的核心物理原理是空间对称性破缺如何产生净动量通量。\n\n解决方案是通过遵循从问题的物理和数学定义中导出的一系列步骤来实现的。\n\n首先，我们为计算建立离散的时空域。角向角 $\\theta$ 定义在一个周期性区间 $[-\\pi,\\pi)$ 上。使用 `numpy.linspace(-numpy.pi, numpy.pi, N_theta, endpoint=False)` 将其离散化为 $N_\\theta$ 个点，这会创建一个均匀网格，通过排除端点来正确实现周期性边界条件。时间 $t$ 在一个有限区间上用 $N_t$ 个均匀样本进行离散化。为确保像 $\\cos^2(\\omega t)$ 这样的时间周期函数的数值平均能精确地逼近其解析值 $1/2$，时间区间的选择应跨越整数个振荡周期。周期为 $T = 2\\pi/\\omega$。我们选择总模拟时长为 $M=10$ 个周期，因此时间网格为在 $[0, 10 \\cdot 2\\pi/\\omega)$ 上均匀采样的 $t_n$。给定参数 $k=3, \\omega=2.0$ 和 $N_\\theta=N_t=1024$，这种网格构造确保了用于评估三角函数平均值的离散傅里叶和所产生的结果，在机器精度范围内，与其连续积分的对应值相同。例如，只要 $2k$ 不是 $N_\\theta$ 的倍数，$\\frac{1}{N_\\theta}\\sum_{j=0}^{N_\\theta-1} \\sin^2(k\\theta_j) = 1/2$ 和 $\\frac{1}{N_\\theta}\\sum_{j=0}^{N_\\theta-1} \\sin(2k\\theta_j) = 0$ 就精确成立。\n\n其次，利用这个网格，根据其定义评估涨落场 $v_r(\\theta, t)$ 和 $v_\\parallel(\\theta, t)$：\n$$\nv_r(\\theta,t) = A\\cos(k\\,\\theta)\\cos(\\omega\\,t) + \\epsilon\\,A\\sin(k\\,\\theta)\\cos(\\omega\\,t)\n$$\n$$\nv_{\\parallel}(\\theta,t) = B\\sin(k\\,\\theta)\\cos(\\omega\\,t)\n$$\n它们被构建为 $N_\\theta \\times N_t$ 的二维数组。参数 $\\epsilon$ 控制对称性破缺：对于 $\\epsilon=0$，$v_r$ 是纯粹关于 $\\theta$ 的偶函数，而 $v_\\parallel$ 是奇函数。对于 $\\epsilon \\neq 0$，$v_r$ 获得一个奇函数分量，从而打破了系统的整体对称性。\n\n第三，残余应力 $\\Pi^{\\mathrm{res}}$ 被计算为动量通量 $v_r v_\\parallel$ 的时空平均值：\n$$\n\\Pi^{\\mathrm{res}} = \\frac{1}{N_\\theta N_t}\\sum_{j=0}^{N_\\theta-1}\\sum_{n=0}^{N_t-1} v_r(\\theta_j,t_n)\\,v_{\\parallel}(\\theta_j,t_n)\n$$\n在数值上，这对应于对 $v_r$ 和 $v_\\parallel$ 数组进行逐元素相乘，然后计算结果数组的平均值。乘积为：\n$$\nv_r v_\\parallel = \\left(A\\cos(k\\theta)\\cos(\\omega t) + \\epsilon A\\sin(k\\theta)\\cos(\\omega t)\\right) \\left(B\\sin(k\\theta)\\cos(\\omega t)\\right)\n$$\n$$\n= A B \\cos(k\\theta)\\sin(k\\theta)\\cos^2(\\omega t) + \\epsilon A B \\sin^2(k\\theta)\\cos^2(\\omega t)\n$$\n第一项 $A B (\\frac{1}{2}\\sin(2k\\theta))\\cos^2(\\omega t)$ 是 $\\theta$ 的奇函数，其在对称区间 $[-\\pi, \\pi)$ 上的空间平均为零。第二项是 $\\theta$ 的偶函数，且具有非零的平均值。\n\n第四，应用平均算子 $\\langle \\cdot \\rangle_{\\theta,t}$ 并使用恒等式 $\\langle\\sin(2k\\theta)\\rangle_\\theta = 0$，$\\langle\\sin^2(k\\theta)\\rangle_\\theta = 1/2$ 和 $\\langle\\cos^2(\\omega t)\\rangle_t = 1/2$，预期的解析结果是：\n$$\n\\Pi^{\\mathrm{res}} = \\langle \\epsilon A B \\sin^2(k\\theta)\\cos^2(\\omega t) \\rangle_{\\theta,t} = \\epsilon A B \\langle\\sin^2(k\\theta)\\rangle_\\theta \\langle\\cos^2(\\omega t)\\rangle_t = \\frac{A B \\epsilon}{4}\n$$\n\n最后，对于提供的每个测试用例，程序计算 $\\Pi^{\\mathrm{res}}$ 并执行所需验证：\n- 对于测试用例 1（$\\epsilon=0$），预期的残余应力为 $0$。程序验证计算出的 $\\Pi^{\\mathrm{res}}_1$ 的绝对值小于指定的容差 $\\tau_0 = 1.0 \\times 10^{-12}$。\n- 对于测试用例 2 和 3（$\\epsilon \\neq 0$），程序验证两个条件。首先，它确认计算出的 $\\Pi^{\\mathrm{res}}$ 的符号与 $\\epsilon$ 的符号匹配。其次，它计算预期的理论值 $\\Pi^{\\mathrm{res}}_{\\mathrm{expected}} = A B \\epsilon / 4$，并验证相对误差 $|\\Pi^{\\mathrm{res}} - \\Pi^{\\mathrm{res}}_{\\mathrm{expected}}| / |\\Pi^{\\mathrm{res}}_{\\mathrm{expected}}|$ 在指定的容差 $\\tau_{\\mathrm{rel}} = 1.0 \\times 10^{-6}$ 之内。\n\n所有测试用例的结果被汇编到一个列表中，并按照最终输出的规定格式进行格式化。这个过程严格地测试了数值实现与对称性破缺诱导残余应力的解析模型的一致性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes residual stress for given synthetic plasma fluctuation data\n    and verifies the results against theoretical expectations.\n    \"\"\"\n    \n    test_cases = [\n        # (A, B, k, omega, epsilon, N_theta, N_t)\n        (1.0, 0.75, 3, 2.0, 0.0, 1024, 1024),\n        (1.0, 0.75, 3, 2.0, 1.0e-1, 1024, 1024),\n        (1.0, 0.75, 3, 2.0, -1.0e-1, 1024, 1024),\n    ]\n\n    tolerances = {\n        'zero_abs': 1.0e-12,\n        'mag_rel': 1.0e-6,\n    }\n\n    results = []\n\n    for i, case in enumerate(test_cases):\n        A, B, k, omega, epsilon, N_theta, N_t = case\n        \n        # 1. Construct the discrete grids in theta and t.\n        # theta grid over a periodic domain [-pi, pi)\n        theta_grid = np.linspace(-np.pi, np.pi, N_theta, endpoint=False)\n        \n        # time grid over an interval of 10 periods to ensure accurate averaging\n        period = 2.0 * np.pi / omega\n        t_max = 10 * period\n        t_grid = np.linspace(0, t_max, N_t, endpoint=False)\n        \n        # Reshape for broadcasting\n        theta = theta_grid[:, np.newaxis]\n        t = t_grid[np.newaxis, :]\n        \n        # 2. Evaluate the fields vr(theta, t) and v_parallel(theta, t).\n        cos_kt = np.cos(k * theta)\n        sin_kt = np.sin(k * theta)\n        cos_wt = np.cos(omega * t)\n        \n        # Radial E x B drift velocity fluctuation\n        v_r = A * cos_kt * cos_wt + epsilon * A * sin_kt * cos_wt\n        \n        # Parallel velocity fluctuation\n        v_parallel = B * sin_kt * cos_wt\n        \n        # 3. Compute the residual stress.\n        momentum_flux = v_r * v_parallel\n        pi_res = np.mean(momentum_flux)\n        \n        # 4. Perform verifications based on the test case.\n        if i == 0:  # Test case 1: epsilon = 0\n            # Expected result is zero.\n            zero_ok = np.abs(pi_res)  tolerances['zero_abs']\n            results.extend([pi_res, zero_ok])\n        else:  # Test cases 2 and 3: epsilon != 0\n            # Check sign\n            sign_ok = np.sign(pi_res) == np.sign(epsilon)\n            \n            # Check magnitude\n            pi_res_expected = (A * B * epsilon) / 4.0\n            \n            # Relative error check, guarding against division by zero\n            # though not expected for these cases.\n            if pi_res_expected != 0:\n                relative_error = np.abs(pi_res - pi_res_expected) / np.abs(pi_res_expected)\n                mag_ok = relative_error  tolerances['mag_rel']\n            else: # Should not be reached in test cases 2  3\n                mag_ok = np.abs(pi_res)  tolerances['zero_abs']\n\n            results.extend([pi_res, sign_ok, mag_ok])\n\n    # 5. Format and print the final output.\n    # Convert booleans to Python's True/False for correct string representation\n    formatted_results = []\n    for item in results:\n        if isinstance(item, np.bool_):\n            formatted_results.append(str(bool(item)))\n        elif isinstance(item, float):\n            # The example output uses standard float representation\n            formatted_results.append(str(item))\n        else:\n            formatted_results.append(str(item))\n            \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们将微观的湍流应力与宏观的等离子体行为联系起来。本练习将一个给定的残余应力剖面——即湍流的产物——作为动量平衡方程中的一个源项。通过求解该方程，你将揭示残余应力如何在没有任何外部动量源的情况下，驱动形成一个真实可观测的等离子体内禀旋转剖面。",
            "id": "4198986",
            "problem": "考虑一个轴对称、大环径比的环形等离子体，其小半径为 $a$，大半径为 $R_0$，具有恒定的质量密度 $n_0 m_i$ 和恒定的几何因子 $R_0$。设平均环向角速度为 $\\Omega(r)$，其中 $r \\in [0,a]$ 是径向坐标。在柱坐标系中，稳态环向角动量守恒定律指出，环向角动量的总径向通量的散度等于外部力矩密度 $S_{\\varphi}(r)$。假设芯部没有外部力矩，即对于 $0 \\le r \\le a$，有 $S_{\\varphi}(r)=0$。环向角动量的总径向通量被建模为三个部分的和：(i) 与 $\\Omega(r)$ 的径向梯度成正比的扩散通量，(ii) 与 $\\Omega(r)$ 成正比的对流箍缩通量，以及 (iii) 由湍流中的对称性破缺产生的残余应力 $\\Pi^{\\mathrm{res}}(r)$。所有输运系数在空间上都是常数。\n\n定义有效转动惯量密度 $I \\equiv n_0 m_i R_0^2$、动量扩散率 $\\chi_{\\varphi}  0$ 和动量箍缩速度 $V_p$（常数）。设给定的残余应力分布为\n$$\n\\Pi^{\\mathrm{res}}(r) = \\Pi_0 \\exp\\!\\left(-\\frac{r}{L}\\right),\n$$\n其中 $\\Pi_0$ 和 $L0$ 是给定的常数。施加芯部正则性条件，即当 $r \\to 0$ 时 $\\Omega(r)$ 保持有限；并施加一个表示等离子体边界处强阻尼的边缘边界条件：$\\Omega(a)=0$。假设参数满足 $V_p + \\chi_{\\varphi}/L \\neq 0$。\n\n仅从稳态环向角动量守恒和上述通量的本构结构出发，推导并求解得到的边值问题，以获得旋转剖面 $\\Omega(r)$ 关于 $I$、$\\chi_{\\varphi}$、$V_p$、$\\Pi_0$、$L$、$a$ 和 $r$ 的闭式解析表达式。然后，根据微分方程的结构和边界条件，讨论在所述假设下解是否唯一。\n\n将最终的 $\\Omega(r)$ 表示为单个闭式解析表达式。不需要四舍五入，并且最终表达式中不应包含物理单位。",
            "solution": "该问题被认为是有效的，因为它在科学上基于等离子体输运理论，在数学上是适定的、客观的，并包含一套完整且一致的给定条件、定义和边界条件。\n\n出发点是轴对称柱坐标系中的稳态环向角动量守恒定律。在没有外部力矩密度的情况下，$S_{\\varphi}(r) = 0$，该定律表示为环向角动量的径向通量的散度为零：\n$$\n\\frac{1}{r} \\frac{d}{dr} (r \\Pi_{r\\varphi}) = 0\n$$\n其中 $\\Pi_{r\\varphi}$ 是环向角动量的径向通量密度。对该方程关于 $r$ 积分，得到 $r \\Pi_{r\\varphi} = C_1$，其中 $C_1$ 是一个积分常数。\n\n问题施加了一个芯部正则性条件，即角速度 $\\Omega(r)$ 在 $r \\to 0$ 时必须保持有限。让我们研究一下这个条件的含义。通量 $\\Pi_{r\\varphi}$ 由预期在原点处为有限的项组成。具体来说，对于一个物理上正则的解，角速度的径向梯度必须在对称轴上为零，即 $\\frac{d\\Omega}{dr}|_{r=0} = 0$。当 $r \\to 0$ 时，残余应力 $\\Pi^{\\mathrm{res}}(r)$ 趋近于一个有限值 $\\Pi_0$。因此，总通量 $\\Pi_{r\\varphi}$ 在 $r=0$ 处是有限的。\n从关系式 $\\Pi_{r\\varphi} = C_1/r$ 可知，为了使 $\\Pi_{r\\varphi}$ 在 $r=0$ 处保持有限，常数 $C_1$ 必须为零。这将守恒定律简化为对于 $r  0$ 的零通量条件：\n$$\n\\Pi_{r\\varphi}(r) = 0\n$$\n问题指定了通量 $\\Pi_{r\\varphi}$ 的本构关系，即扩散、对流和残余应力分量的总和。使用定义的参数 $I$、$\\chi_{\\varphi}$ 和 $V_p$：\n$$\n\\Pi_{r\\varphi} = -I \\chi_{\\varphi} \\frac{d\\Omega}{dr} + I V_p \\Omega(r) + \\Pi^{\\mathrm{res}}(r)\n$$\n代入给定的残余应力剖面 $\\Pi^{\\mathrm{res}}(r) = \\Pi_0 \\exp(-r/L)$，并应用零通量条件，我们得到一个关于 $\\Omega(r)$ 的一阶线性非齐次常微分方程 (ODE)：\n$$\n-I \\chi_{\\varphi} \\frac{d\\Omega}{dr} + I V_p \\Omega(r) + \\Pi_0 \\exp\\left(-\\frac{r}{L}\\right) = 0\n$$\n我们可以将其写成标准形式 $\\frac{dy}{dx} + P(x)y = Q(x)$：\n$$\n\\frac{d\\Omega}{dr} - \\frac{V_p}{\\chi_{\\varphi}} \\Omega(r) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-\\frac{r}{L}\\right)\n$$\n为了求解这个常微分方程，我们使用积分因子法。积分因子 $\\mu(r)$ 是：\n$$\n\\mu(r) = \\exp\\left( \\int -\\frac{V_p}{\\chi_{\\varphi}} dr \\right) = \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right)\n$$\n将常微分方程乘以 $\\mu(r)$，左边就变成了一个乘积的导数：\n$$\n\\frac{d}{dr} \\left( \\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) \\right) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-\\frac{r}{L}\\right) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right)\n$$\n$$\n\\frac{d}{dr} \\left( \\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) \\right) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-r\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right)\n$$\n将两边对 $r$ 积分：\n$$\n\\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) = \\int \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\exp\\left(-r\\left(\\frac{\\chi_{\\varphi} + L V_p}{L \\chi_{\\varphi}}\\right)\\right) dr + C\n$$\n其中 $C$ 是积分常数。执行积分，并使用给定条件 $V_p + \\chi_{\\varphi}/L \\neq 0$，我们发现：\n$$\n\\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) = \\frac{\\Pi_0}{I \\chi_{\\varphi}} \\left( -\\frac{L \\chi_{\\varphi}}{\\chi_{\\varphi} + L V_p} \\right) \\exp\\left(-r\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right) + C\n$$\n$$\n\\Omega(r) \\exp\\left(-\\frac{V_p r}{\\chi_{\\varphi}}\\right) = -\\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{r}{L} - \\frac{V_p r}{\\chi_{\\varphi}}\\right) + C\n$$\n求解 $\\Omega(r)$ 得到通解：\n$$\n\\Omega(r) = C \\exp\\left(\\frac{V_p r}{\\chi_{\\varphi}}\\right) - \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{r}{L}\\right)\n$$\n常数 $C$ 由边缘边界条件 $\\Omega(a)=0$ 确定：\n$$\n0 = C \\exp\\left(\\frac{V_p a}{\\chi_{\\varphi}}\\right) - \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{a}{L}\\right)\n$$\n求解 $C$：\n$$\nC = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{a}{L}\\right) \\exp\\left(-\\frac{V_p a}{\\chi_{\\varphi}}\\right) = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-a\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right)\n$$\n将 $C$ 的这个表达式代回到 $\\Omega(r)$ 的通解中：\n$$\n\\Omega(r) = \\left( \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-a\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right)\\right) \\right) \\exp\\left(\\frac{V_p r}{\\chi_{\\varphi}}\\right) - \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\exp\\left(-\\frac{r}{L}\\right)\n$$\n提出公因子并合并指数，得到旋转剖面的最终表达式：\n$$\n\\Omega(r) = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\left[ \\exp\\left(-a\\left(\\frac{1}{L} + \\frac{V_p}{\\chi_{\\varphi}}\\right) + \\frac{V_p r}{\\chi_{\\varphi}}\\right) - \\exp\\left(-\\frac{r}{L}\\right) \\right]\n$$\n这可以更紧凑地写成：\n$$\n\\Omega(r) = \\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\left[ \\exp\\left(-\\frac{a}{L} - \\frac{V_p(a-r)}{\\chi_{\\varphi}}\\right) - \\exp\\left(-\\frac{r}{L}\\right) \\right]\n$$\n关于唯一性，该问题本质上是一个由方程 $\\frac{d}{dr}(r \\Pi_{r\\varphi}) = 0$ 描述的二阶边值问题，其中 $\\Pi_{r\\varphi}$ 包含 $\\Omega$ 的导数。这样的问题需要两个边界条件才能有唯一解。问题提供了两个不同的物理约束：(1) 芯部正则性（当 $r \\to 0$ 时 $\\Omega(r)$ 是有限的）和 (2) 边缘边界条件 ($\\Omega(a)=0$）。在 $r=0$ 处的正则性条件迫使动量守恒定律初始积分产生的积分常数为零，从而将问题简化为一个一阶常微分方程，$\\Pi_{r\\varphi}=0$。一阶线性常微分方程的存在唯一性定理保证，在给定一个边界条件 $\\Omega(a)=0$ 的情况下，只要系数是良态的（如此处所示），区间 $[0, a]$ 上 $\\Omega(r)$ 的解就是唯一的。因此，在给定假设下，导出的解是唯一解。",
            "answer": "$$\n\\boxed{\\frac{\\Pi_0 L}{I (\\chi_{\\varphi} + L V_p)} \\left[ \\exp\\left(-\\frac{a}{L} - \\frac{V_p(a-r)}{\\chi_{\\varphi}}\\right) - \\exp\\left(-\\frac{r}{L}\\right) \\right]}\n$$"
        }
    ]
}