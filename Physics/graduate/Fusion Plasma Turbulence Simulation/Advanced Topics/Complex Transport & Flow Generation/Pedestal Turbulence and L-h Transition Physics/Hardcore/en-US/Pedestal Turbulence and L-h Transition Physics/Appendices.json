{
    "hands_on_practices": [
        {
            "introduction": "The formation of a transport barrier, or pedestal, in H-mode is characterized by steep pressure gradients. A critical question in fusion research is what determines the width and height of this pedestal. This exercise  explores a foundational concept in pedestal physics: the idea that the pressure gradient is limited by the onset of instabilities, such as the Kinetic Ballooning Mode (KBM). By assuming the pedestal exists in a state of marginal stability, you will derive a scaling law for the pedestal width, providing a direct link between local plasma stability and global profile structure.",
            "id": "4198083",
            "problem": "Consider a high-confinement edge (H-mode) pedestal in a toroidal device whose pedestal pressure profile is regulated by the kinetic ballooning mode (KBM). Let the local KBM stability boundary be characterized by a $\\beta$-dependent limit on the normalized pressure gradient of the form\n$$\n\\frac{R}{L_p} \\leq C \\sqrt{\\beta},\n$$\nwhere $R$ is the major radius, $L_p \\equiv \\left| \\frac{p}{\\mathrm{d}p/\\mathrm{d}r} \\right|$ is the local pressure scale length, $C$ is an order-unity constant set by geometry and kinetic effects, and $\\beta \\equiv \\frac{2 \\mu_0 p}{B^2}$ is the local plasma beta defined using the toroidal magnetic field magnitude $B$. Assume the following physically motivated conditions: \n$1$) the pedestal region of interest spans from the pedestal top at $r=r_0$ with pressure $p_{\\mathrm{ped}}$ to the separatrix at $r=r_0+\\Delta_p$ with pressure $p_{\\mathrm{sep}}  p_{\\mathrm{ped}}$; \n$2$) across this region the pressure gradient saturates the KBM boundary everywhere (i.e., marginal stability is maintained locally); \n$3$) the magnetic field magnitude $B$ is approximately constant across the pedestal so that $\\beta$ is proportional to $p$.\n\nStarting only from the given boundary, the definition of $L_p$, and the definition of $\\beta$, and taking the outward minor-radial coordinate $r$ to increase from $r_0$ to $r_0+\\Delta_p$, derive a closed-form expression for the pedestal width $\\Delta_p$ in terms of $R$, $C$, $\\beta_{\\mathrm{ped}} \\equiv \\frac{2 \\mu_0 p_{\\mathrm{ped}}}{B^2}$, and $\\beta_{\\mathrm{sep}} \\equiv \\frac{2 \\mu_0 p_{\\mathrm{sep}}}{B^2}$. Your final answer must be a single analytic expression for $\\Delta_p$. State no approximations beyond those listed above. Do not insert numerical values. Express only the final symbolic expression.",
            "solution": "The problem requires the derivation of an expression for the pedestal width, $\\Delta_p$, based on a simplified model where the pressure gradient is everywhere at the marginal stability boundary for the kinetic ballooning mode (KBM).\n\nThe analysis begins with the given KBM stability boundary. According to condition ($2$), the pedestal pressure gradient saturates this boundary, which translates the inequality into a strict equality:\n$$\n\\frac{R}{L_p} = C \\sqrt{\\beta}\n$$\nHere, $R$ is the major radius, $C$ is a constant, $\\beta$ is the local plasma beta, and $L_p$ is the pressure scale length.\n\nThe pressure scale length, $L_p$, is defined as:\n$$\nL_p \\equiv \\left| \\frac{p}{\\mathrm{d}p/\\mathrm{d}r} \\right|\n$$\nThe problem specifies that the minor radius $r$ increases from the pedestal top at $r=r_0$ to the separatrix at $r=r_0+\\Delta_p$. The corresponding pressures are $p_{\\mathrm{ped}}$ and $p_{\\mathrm{sep}}$, with the condition $p_{\\mathrm{ped}}  p_{\\mathrm{sep}}$. This implies that the pressure $p$ is a decreasing function of the radius $r$ across the pedestal. Consequently, the derivative $\\mathrm{d}p/\\mathrm{d}r$ is negative. Since pressure $p$ is intrinsically positive, the absolute value in the definition of $L_p$ can be resolved as:\n$$\nL_p = -\\frac{p}{\\mathrm{d}p/\\mathrm{d}r}\n$$\n\nSubstituting this expression for $L_p$ into the marginal stability equation yields:\n$$\n\\frac{R}{-p/(\\mathrm{d}p/\\mathrm{d}r)} = C \\sqrt{\\beta}\n$$\n$$\n-R \\frac{\\mathrm{d}p/\\mathrm{d}r}{p} = C \\sqrt{\\beta}\n$$\nThis can be rewritten as a first-order ordinary differential equation:\n$$\n-R \\frac{1}{p} \\frac{\\mathrm{d}p}{\\mathrm{d}r} = C \\sqrt{\\beta}\n$$\n\nThe next step is to express this equation entirely in terms of $\\beta$ and $r$. The local plasma beta is defined as $\\beta \\equiv \\frac{2 \\mu_0 p}{B^2}$. According to condition ($3$), the magnetic field strength $B$ is constant across the pedestal. Therefore, $\\beta$ is directly proportional to the pressure $p$. We can write $\\beta = k p$, where $k = \\frac{2 \\mu_0}{B^2}$ is a constant. Differentiating this relationship gives $\\mathrm{d}\\beta = k \\, \\mathrm{d}p$. We can now find an expression for the term $\\frac{1}{p}\\frac{\\mathrm{d}p}{\\mathrm{d}r}$:\n$$\n\\frac{1}{p} \\frac{\\mathrm{d}p}{\\mathrm{d}r} = \\frac{k}{k p} \\frac{\\mathrm{d}p}{\\mathrm{d}r} = \\frac{1}{\\beta} \\frac{k \\, \\mathrm{d}p}{\\mathrm{d}r} = \\frac{1}{\\beta} \\frac{\\mathrm{d}\\beta}{\\mathrm{d}r}\n$$\nSubstituting this back into the differential equation gives:\n$$\n-R \\frac{1}{\\beta} \\frac{\\mathrm{d}\\beta}{\\mathrm{d}r} = C \\sqrt{\\beta}\n$$\nRearranging this equation isolates the variables $\\beta$ and $r$:\n$$\n\\frac{\\mathrm{d}\\beta}{\\beta \\sqrt{\\beta}} = -\\frac{C}{R} \\mathrm{d}r\n$$\n$$\n\\beta^{-3/2} \\mathrm{d}\\beta = -\\frac{C}{R} \\mathrm{d}r\n$$\nTo find the pedestal width $\\Delta_p$, we integrate this equation across the pedestal region. The radial coordinate $r$ ranges from $r_0$ to $r_0 + \\Delta_p$. The corresponding values of $\\beta$ range from $\\beta_{\\mathrm{ped}}$ at $r=r_0$ to $\\beta_{\\mathrm{sep}}$ at $r=r_0 + \\Delta_p$. The definite integral is thus:\n$$\n\\int_{\\beta_{\\mathrm{ped}}}^{\\beta_{\\mathrm{sep}}} \\beta^{-3/2} \\mathrm{d}\\beta = \\int_{r_0}^{r_0 + \\Delta_p} -\\frac{C}{R} \\mathrm{d}r\n$$\nWe evaluate the left-hand side integral:\n$$\n\\int \\beta^{-3/2} \\mathrm{d}\\beta = \\frac{\\beta^{-1/2}}{-1/2} + \\text{const} = -2\\beta^{-1/2} + \\text{const}\n$$\n$$\n\\int_{\\beta_{\\mathrm{ped}}}^{\\beta_{\\mathrm{sep}}} \\beta^{-3/2} \\mathrm{d}\\beta = \\left[ -2\\beta^{-1/2} \\right]_{\\beta_{\\mathrm{ped}}}^{\\beta_{\\mathrm{sep}}} = -2(\\beta_{\\mathrm{sep}}^{-1/2} - \\beta_{\\mathrm{ped}}^{-1/2}) = 2(\\beta_{\\mathrm{ped}}^{-1/2} - \\beta_{\\mathrm{sep}}^{-1/2})\n$$\nNext, we evaluate the right-hand side integral:\n$$\n\\int_{r_0}^{r_0 + \\Delta_p} -\\frac{C}{R} \\mathrm{d}r = -\\frac{C}{R} \\left[ r \\right]_{r_0}^{r_0 + \\Delta_p} = -\\frac{C}{R} ((r_0+\\Delta_p) - r_0) = -\\frac{C}{R} \\Delta_p\n$$\nEquating the results of the two integrations gives:\n$$\n2(\\beta_{\\mathrm{ped}}^{-1/2} - \\beta_{\\mathrm{sep}}^{-1/2}) = -\\frac{C}{R} \\Delta_p\n$$\nFinally, we solve for the pedestal width $\\Delta_p$:\n$$\n\\Delta_p = -\\frac{2R}{C} (\\beta_{\\mathrm{ped}}^{-1/2} - \\beta_{\\mathrm{sep}}^{-1/2})\n$$\n$$\n\\Delta_p = \\frac{2R}{C} (\\beta_{\\mathrm{sep}}^{-1/2} - \\beta_{\\mathrm{ped}}^{-1/2})\n$$\nThis expression can be written more explicitly as:\n$$\n\\Delta_p = \\frac{2R}{C} \\left( \\frac{1}{\\sqrt{\\beta_{\\mathrm{sep}}}} - \\frac{1}{\\sqrt{\\beta_{\\mathrm{ped}}}} \\right)\n$$\nSince $p_{\\mathrm{ped}}  p_{\\mathrm{sep}}$, it follows that $\\beta_{\\mathrm{ped}}  \\beta_{\\mathrm{sep}}  0$. This implies $\\sqrt{\\beta_{\\mathrm{ped}}}  \\sqrt{\\beta_{\\mathrm{sep}}}$, and therefore $\\frac{1}{\\sqrt{\\beta_{\\mathrm{ped}}}}  \\frac{1}{\\sqrt{\\beta_{\\mathrm{sep}}}}$. The term in the parentheses is positive, and since $R$ and $C$ are positive constants, the pedestal width $\\Delta_p$ is correctly found to be a positive quantity.",
            "answer": "$$\\boxed{\\frac{2R}{C} \\left( \\frac{1}{\\sqrt{\\beta_{\\mathrm{sep}}}} - \\frac{1}{\\sqrt{\\beta_{\\mathrm{ped}}}} \\right)}$$"
        },
        {
            "introduction": "The suppression of turbulence at the L-H transition is primarily driven by the shearing of turbulent eddies by strong $E \\times B$ flows, which depend on the radial electric field, $E_r$. This practice  investigates a key neoclassical mechanism responsible for generating this crucial electric field at the plasma edge: ion orbit loss. You will calculate how the geometry of magnetically-confined ion orbits near the separatrix leads to a preferential loss of ions, leaving behind a net current and altering the radial force balance to create a strong $E_r$ well.",
            "id": "4198005",
            "problem": "Consider a large-aspect-ratio, circular-cross-section tokamak plasma in the edge pedestal region during the low-to-high confinement (L-H) transition. Assume axisymmetry and a single-null lower X-point configuration so that grad-$B$ and curvature drifts preferentially route ions with parallel velocity $v_{\\parallel}0$ toward the loss region near the separatrix on the outboard side. The magnetic field has dominant toroidal component $B_{\\phi}\\approx B_{0}$ and poloidal field $B_{\\theta}\\approx B_{0} r/(q R)$, where $q$ is the safety factor, $R$ is the major radius, and $r$ is the local minor radius in the pedestal.\n\nStarting from the Lorentz force and the guiding-center approximation, use conservation of the magnetic moment and large-aspect-ratio geometry to estimate the banana half-width $\\Delta_{b}$ of deeply trapped ion orbits in terms of the ion Larmor radius $\\rho_{i}$, the safety factor $q$, and the inverse aspect ratio $\\varepsilon=r/R$. From that estimate, derive a local orbit-loss condition for ions, expressed as a threshold on the perpendicular speed $v_{\\perp}$, by requiring that $\\Delta_{b}$ exceed a given radial distance $d$ to the separatrix. Then, assuming that only ions with $v_{\\parallel}0$ and $v_{\\perp}$ above the threshold are promptly lost, compute the resulting net parallel current density in the confined plasma that modifies the radial force balance. The unperturbed ion distribution is isotropic Maxwellian,\n$$\nf_{0}(v_{\\parallel},v_{\\perp})=n_{i}\\left(\\frac{m_{i}}{2\\pi k_{B} T_{i}}\\right)^{3/2}\\exp\\!\\left[-\\frac{m_{i}(v_{\\parallel}^{2}+v_{\\perp}^{2})}{2 k_{B} T_{i}}\\right],\n$$\nwith ion density $n_{i}$, ion temperature $T_{i}$, ion mass $m_{i}$, and charge state $Z$. Treat the loss as an instantaneous truncation of $f_{0}$ in the half-space $\\{v_{\\parallel}0,\\, v_{\\perp}\\ge v_{c}\\}$, where $v_{c}$ is the derived threshold, and compute the net parallel current density $j_{\\parallel}$ left in the plasma, defined by the velocity moment of the remaining distribution.\n\nUse the following parameters representative of a pedestal near the L-H transition:\n- $B_{0}=2.0\\,\\mathrm{T}$,\n- $q=4.0$,\n- $R=1.7\\,\\mathrm{m}$,\n- $r=0.55\\,\\mathrm{m}$,\n- $d=0.01\\,\\mathrm{m}$,\n- $Z=1$,\n- $m_{i}=3.344\\times 10^{-27}\\,\\mathrm{kg}$ (deuterium),\n- $n_{i}=2.0\\times 10^{19}\\,\\mathrm{m}^{-3}$,\n- $T_{i}=1.0\\,\\mathrm{keV}$.\n\nTake $k_{B}$ to be the Boltzmann constant. Express the final current density in $\\mathrm{A}\\,\\mathrm{m}^{-2}$ and round your answer to three significant figures.",
            "solution": "The problem requires a three-part solution: first, finding the banana half-width; second, establishing an orbit-loss condition; and third, calculating the resulting parallel current density.\n\n**Part 1: Banana Half-Width, $\\Delta_{b}$**\nIn the large-aspect-ratio tokamak approximation, the radial width of a trapped particle's orbit (the \"banana\" orbit) can be derived from the conservation of the toroidal canonical momentum. A standard result from this derivation is that the banana half-width, $\\Delta_{b}$, for a deeply trapped ion is related to its Larmor radius, $\\rho_{i}$, the safety factor, $q$, and the inverse aspect ratio, $\\varepsilon=r/R$. The expression is:\n$$\n\\Delta_{b} \\approx \\frac{q}{\\sqrt{\\varepsilon}} \\rho_{i}\n$$\nThe ion Larmor radius is defined with respect to the main magnetic field $B_0$ and the ion's perpendicular velocity $v_{\\perp}$:\n$$\n\\rho_{i} = \\frac{m_{i}v_{\\perp}}{Z e B_{0}}\n$$\nwhere $Z$ is the ion charge state number and $e$ is the elementary charge.\n\n**Part 2: Orbit-Loss Condition**\nAn ion located at a radial distance $d$ inside the separatrix will be lost if its orbit extends beyond the separatrix. We approximate this condition by requiring the banana half-width to be greater than this distance:\n$$\n\\Delta_{b}  d\n$$\nSubstituting the expressions for $\\Delta_{b}$ and $\\rho_{i}$:\n$$\n\\frac{q}{\\sqrt{\\varepsilon}} \\left(\\frac{m_{i}v_{\\perp}}{Z e B_{0}}\\right)  d\n$$\nThis inequality defines a minimum perpendicular velocity for an ion to be lost. We define this threshold velocity as $v_{c}$:\n$$\nv_{\\perp}  \\frac{d \\sqrt{\\varepsilon} Z e B_{0}}{q m_{i}} \\equiv v_{c}\n$$\nSo, the orbit-loss condition is $v_{\\perp}  v_{c}$ where\n$$\nv_{c} = \\frac{d \\sqrt{\\varepsilon} Z e B_{0}}{q m_{i}}\n$$\n\n**Part 3: Net Parallel Current Density, $j_{\\parallel}$**\nThe initial ion distribution function $f_{0}$ is isotropic and even in $v_{\\parallel}$, so it carries no net parallel current. The loss of ions from a specific region of velocity space creates an asymmetry, resulting in a net current. The problem states that ions with $v_{\\parallel}  0$ and $v_{\\perp} \\ge v_{c}$ are lost.\nThe net parallel current density $j_{\\parallel}$ is the first velocity moment of the remaining distribution function $f_{rem}$:\n$$\nj_{\\parallel} = \\int (Ze v_{\\parallel}) f_{rem}(\\mathbf{v}) d^3\\mathbf{v}\n$$\nSince the integral of $v_{\\parallel} f_{0}$ over all velocity space is zero, the remaining current is the negative of the current carried by the lost particles:\n$$\nj_{\\parallel} = - \\int_{\\text{loss region}} (Ze v_{\\parallel}) f_{0}(\\mathbf{v}) d^3\\mathbf{v}\n$$\nThe integral is over the loss region in velocity space, defined by $\\{v_{\\parallel}  0, v_{\\perp} \\ge v_{c}\\}$. In cylindrical velocity coordinates $(v_{\\perp}, \\phi_{v}, v_{\\parallel})$, the volume element is $d^3\\mathbf{v} = 2\\pi v_{\\perp} dv_{\\perp} dv_{\\parallel}$.\n$$\nj_{\\parallel} = - Ze \\int_{-\\infty}^{0} dv_{\\parallel} \\int_{v_{c}}^{\\infty} dv_{\\perp} \\, (v_{\\parallel} f_{0}(v_{\\parallel}, v_{\\perp}) 2\\pi v_{\\perp})\n$$\nWe define the ion thermal velocity $v_{th,i} = \\sqrt{2k_{B}T_{i}/m_{i}}$. The Maxwellian distribution becomes:\n$$\nf_{0}(v_{\\parallel}, v_{\\perp}) = \\frac{n_{i}}{\\pi^{3/2} v_{th,i}^{3}} \\exp\\left(-\\frac{v_{\\parallel}^{2}+v_{\\perp}^{2}}{v_{th,i}^{2}}\\right)\n$$\nSubstituting this into the integral for $j_{\\parallel}$:\n$$\nj_{\\parallel} = - Ze (2\\pi) \\frac{n_{i}}{\\pi^{3/2} v_{th,i}^{3}} \\left( \\int_{-\\infty}^{0} v_{\\parallel} e^{-v_{\\parallel}^{2}/v_{th,i}^{2}} dv_{\\parallel} \\right) \\left( \\int_{v_{c}}^{\\infty} v_{\\perp} e^{-v_{\\perp}^{2}/v_{th,i}^{2}} dv_{\\perp} \\right)\n$$\nWe evaluate the two integrals:\nThe parallel velocity integral is:\n$$\n\\int_{-\\infty}^{0} v_{\\parallel} e^{-v_{\\parallel}^{2}/v_{th,i}^{2}} dv_{\\parallel} = \\left[ -\\frac{v_{th,i}^{2}}{2} e^{-v_{\\parallel}^{2}/v_{th,i}^{2}} \\right]_{-\\infty}^{0} = -\\frac{v_{th,i}^{2}}{2} (1 - 0) = -\\frac{v_{th,i}^{2}}{2}\n$$\nThe perpendicular velocity integral is:\n$$\n\\int_{v_{c}}^{\\infty} v_{\\perp} e^{-v_{\\perp}^{2}/v_{th,i}^{2}} dv_{\\perp} = \\left[ -\\frac{v_{th,i}^{2}}{2} e^{-v_{\\perp}^{2}/v_{th,i}^{2}} \\right]_{v_{c}}^{\\infty} = -\\frac{v_{th,i}^{2}}{2} (0 - e^{-v_{c}^{2}/v_{th,i}^{2}}) = \\frac{v_{th,i}^{2}}{2} e^{-v_{c}^{2}/v_{th,i}^{2}}\n$$\nSubstituting these results back into the expression for $j_{\\parallel}$:\n$$\nj_{\\parallel} = - Ze \\frac{2 n_{i}}{\\sqrt{\\pi} v_{th,i}^{3}} \\left( -\\frac{v_{th,i}^{2}}{2} \\right) \\left( \\frac{v_{th,i}^{2}}{2} e^{-v_{c}^{2}/v_{th,i}^{2}} \\right) = \\frac{Ze n_{i} v_{th,i}}{2\\sqrt{\\pi}} \\exp\\left(-\\frac{v_{c}^{2}}{v_{th,i}^{2}}\\right)\n$$\n\n**Numerical Calculation**\nFirst, we compute the necessary parameters:\n- Inverse aspect ratio: $\\varepsilon = r/R = 0.55\\,\\mathrm{m} / 1.7\\,\\mathrm{m} \\approx 0.323529$\n- Ion temperature in Joules: $k_{B}T_{i} = 1.0\\,\\mathrm{keV} = 1.0 \\times 10^{3} \\times 1.6021766 \\times 10^{-19}\\,\\mathrm{J} = 1.6021766 \\times 10^{-16}\\,\\mathrm{J}$\n- Ion thermal velocity: $v_{th,i} = \\sqrt{\\frac{2 k_{B} T_{i}}{m_{i}}} = \\sqrt{\\frac{2 \\times 1.6021766 \\times 10^{-16}\\,\\mathrm{J}}{3.344 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx 3.0955 \\times 10^{5}\\,\\mathrm{m/s}$\n- Critical perpendicular velocity:\n$$\nv_{c} = \\frac{d \\sqrt{\\varepsilon} Z e B_{0}}{q m_{i}} = \\frac{(0.01\\,\\mathrm{m}) \\sqrt{0.323529} (1) (1.6021766 \\times 10^{-19}\\,\\mathrm{C}) (2.0\\,\\mathrm{T})}{(4.0) (3.344 \\times 10^{-27}\\,\\mathrm{kg})} \\approx 1.3625 \\times 10^{5}\\,\\mathrm{m/s}\n$$\n- The argument of the exponential:\n$$\n\\frac{v_{c}^{2}}{v_{th,i}^{2}} = \\left(\\frac{1.3625 \\times 10^{5}\\,\\mathrm{m/s}}{3.0955 \\times 10^{5}\\,\\mathrm{m/s}}\\right)^{2} \\approx (0.44015)^{2} \\approx 0.19373\n$$\n- Finally, the current density:\n$$\nj_{\\parallel} = \\frac{(1)(1.6021766 \\times 10^{-19}\\,\\mathrm{C})(2.0 \\times 10^{19}\\,\\mathrm{m}^{-3})(3.0955 \\times 10^{5}\\,\\mathrm{m/s})}{2\\sqrt{\\pi}} \\exp(-0.19373)\n$$\n$$\nj_{\\parallel} \\approx \\frac{9.920 \\times 10^{5}\\,\\mathrm{A/m^2}}{3.5449} \\times 0.82389 \\approx (2.7984 \\times 10^{5}\\,\\mathrm{A/m^2}) \\times 0.82389 \\approx 2.3056 \\times 10^{5}\\,\\mathrm{A/m^2}\n$$\nRounding to three significant figures, we get $2.31 \\times 10^{5}\\,\\mathrm{A/m^2}$.",
            "answer": "$$\\boxed{2.31 \\times 10^5}$$"
        },
        {
            "introduction": "Having explored how pedestal structure is determined and how suppressive electric fields are generated, we now turn to the dynamic interplay between turbulence and shear. The L-H transition is not always a simple switch but can involve complex dynamics, including oscillations. This computational exercise  asks you to simulate a reduced \"predator-prey\" model, where turbulence amplitude competes with a time-dependent $E \\times B$ shearing rate. By solving this model numerically, you will gain insight into the conditions required for robust turbulence suppression and the transient phenomena that characterize the transition boundary.",
            "id": "4198067",
            "problem": "You are asked to formalize and simulate a transient, reduced turbulence amplitude model at the tokamak edge pedestal to assess whether intermittent bursts can overcome suppression by time-dependent $\\gamma_{E}(t)$ associated with radial $\\mathbf{E}\\times\\mathbf{B}$ shear. Your program must implement a one-field ordinary differential equation (ODE) for a dimensionless turbulence amplitude $A(t)\\ge 0$ whose dynamics are driven by a competition between a linear drift-wave growth rate, shear decorrelation, nonlinear self-damping, and intermittent burst-like sources. The purpose is to evaluate the robustness of suppression, in the sense of whether $A(t)$ can exceed a specified threshold for a required minimum contiguous time. All quantities are dimensionless (normalized units), so no physical units are required.\n\nModel specification to implement:\n- The model variable is the dimensionless turbulence amplitude $A(t)$.\n- The evolution equation is\n$$\n\\frac{dA}{dt} = \\Big(\\gamma_{L} - \\gamma_{E}(t)\\Big) A - \\mu A^{3} + F_{\\text{burst}}(t),\n$$\nwith initial condition $A(0)=A_{0}$ and $A(t)\\ge 0$ enforced at all times.\n- The time-dependent shear rate is\n$$\n\\gamma_{E}(t) = \\gamma_{E0} + \\Delta_{E}\\,\\sin\\!\\Big(\\frac{2\\pi t}{T_{E}}\\Big).\n$$\n- The intermittent burst source is a sum of Gaussian pulses,\n$$\nF_{\\text{burst}}(t) = \\sum_{i=1}^{N_{b}} B_{i}\\,\\exp\\!\\left(-\\frac{(t-t_{i})^{2}}{2\\sigma_{i}^{2}}\\right),\n$$\nwhere $N_{b}$ is the number of bursts, $B_{i}$ is the amplitude of burst $i$, $t_{i}$ its center time, and $\\sigma_{i}$ its width.\n- The crossing criterion is defined by a threshold amplitude $A_{\\text{thr}}$ and a minimum contiguous hold time $\\tau_{\\text{hold}}$. Define that a case “overcomes the shear barrier” if and only if there exists a time interval of duration at least $\\tau_{\\text{hold}}$ over which $A(t)\\ge A_{\\text{thr}}$ for all $t$ within that interval.\n\nNumerical requirements:\n- Integrate the ODE using the classical fourth-order Runge–Kutta (Runge–Kutta (RK4)) method with fixed time step $dt$ on the interval $t\\in[0,t_{\\text{end}}]$.\n- After each time step, enforce $A(t)\\leftarrow \\max(A(t),0)$.\n- Detect barrier overcoming by tracking the longest contiguous time during which $A(t)\\ge A_{\\text{thr}}$, using the discrete time grid with step $dt$. Report “true” if any contiguous interval of length at least $\\tau_{\\text{hold}}$ is found, otherwise “false”.\n\nTest suite:\nFor each case below, use the listed parameters in the model above. All numbers are dimensionless and must be implemented exactly as given.\n\n- Case $1$ (strong shear, moderate bursts):\n  - $\\gamma_{L}=0.4$, $\\gamma_{E0}=0.6$, $\\Delta_{E}=0.1$, $T_{E}=20$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - Bursts: $N_{b}=2$ with $(B_{1},t_{1},\\sigma_{1})=(0.3,30,0.5)$ and $(B_{2},t_{2},\\sigma_{2})=(0.3,60,0.5)$\n\n- Case $2$ (moderate shear, one strong burst):\n  - $\\gamma_{L}=0.4$, $\\gamma_{E0}=0.35$, $\\Delta_{E}=0.1$, $T_{E}=25$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - Bursts: $N_{b}=1$ with $(B_{1},t_{1},\\sigma_{1})=(1.0,30,1.0)$\n\n- Case $3$ (large shear excursions, small bursts):\n  - $\\gamma_{L}=0.4$, $\\gamma_{E0}=0.5$, $\\Delta_{E}=0.25$, $T_{E}=30$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - Bursts: $N_{b}=2$ with $(B_{1},t_{1},\\sigma_{1})=(0.4,10,0.7)$ and $(B_{2},t_{2},\\sigma_{2})=(0.4,20,0.7)$\n\n- Case $4$ (near balance, multiple modest bursts):\n  - $\\gamma_{L}=0.45$, $\\gamma_{E0}=0.43$, $\\Delta_{E}=0.05$, $T_{E}=40$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - Bursts: $N_{b}=3$ with $(B_{1},t_{1},\\sigma_{1})=(0.35,15,1.2)$, $(B_{2},t_{2},\\sigma_{2})=(0.35,25,1.2)$, $(B_{3},t_{3},\\sigma_{3})=(0.35,35,1.2)$\n\n- Case $5$ (no drive, no bursts):\n  - $\\gamma_{L}=0.0$, $\\gamma_{E0}=0.2$, $\\Delta_{E}=0.0$, $T_{E}=50$\n  - $\\mu=1.0$, $A_{0}=0.0$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - Bursts: $N_{b}=0$ (empty list)\n\nOutput format:\n- For each case in the order listed above, compute a boolean indicating whether the shear barrier is overcome (as defined).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[{\\rm true},{\\rm false},\\dots]$ but using the language’s boolean literals). For example: $[{\\rm True},{\\rm False},{\\rm True},{\\rm False},{\\rm False}]$.",
            "solution": "The problem has been validated and is determined to be a well-posed, scientifically grounded computational physics task. It presents a simplified but physically motivated model of turbulence dynamics relevant to magnetic confinement fusion, specifically the L-H transition at the tokamak edge. All parameters, equations, and numerical requirements are clearly specified, forming a self-contained and solvable problem.\n\nThe core of the problem is to solve an initial value problem for a first-order ordinary differential equation (ODE) that models the evolution of a dimensionless turbulence amplitude, $A(t)$. The model is a phenomenological one, capturing the essential competition between several physical mechanisms:\n\n$1$.  **Linear Growth/Damping**: The term $(\\gamma_{L} - \\gamma_{E}(t))A$ represents the net linear effect on the turbulence amplitude. $\\gamma_{L}$ is a constant linear growth rate, arising from plasma instabilities like drift waves. $\\gamma_{E}(t)$ is a time-varying suppression rate, representing the decorrelation of turbulent eddies by sheared $\\mathbf{E}\\times\\mathbf{B}$ flows, which are known to oscillate in time (zonal flows).\n$2$.  **Nonlinear Saturation**: The term $-\\mu A^{3}$ is a cubic self-damping term. This represents the process by which the turbulence nonlinearly transfers energy to damped modes or otherwise limits its own growth, leading to a saturated state.\n$3$.  **External Forcing**: The term $F_{\\text{burst}}(t)$ represents intermittent, burst-like events that drive the turbulence, such as magnetohydrodynamic (MHD) events (e.g., edge-localized modes or ELMs) injecting energy into the turbulent fluctuations.\n\nThe complete evolution equation is:\n$$\n\\frac{dA}{dt} = f(t, A) = \\Big(\\gamma_{L} - \\gamma_{E}(t)\\Big) A - \\mu A^{3} + F_{\\text{burst}}(t)\n$$\nwith the initial condition $A(0) = A_{0}$. Since $A(t)$ represents an amplitude, it must be non-negative, a constraint that is enforced numerically by setting $A(t) \\leftarrow \\max(0, A(t))$ after each time step.\n\nThe time-dependent shear rate $\\gamma_E(t)$ and burst source $F_{\\text{burst}}(t)$ are given by:\n$$\n\\gamma_{E}(t) = \\gamma_{E0} + \\Delta_{E}\\,\\sin\\!\\Big(\\frac{2\\pi t}{T_{E}}\\Big)\n$$\n$$\nF_{\\text{burst}}(t) = \\sum_{i=1}^{N_{b}} B_{i}\\,\\exp\\!\\left(-\\frac{(t-t_{i})^{2}}{2\\sigma_{i}^{2}}\\right)\n$$\n\nTo solve this ODE numerically, the problem specifies the use of the classical fourth-order Runge-Kutta (RK4) method. This is a robust and widely-used explicit method for solving initial value problems. For an ODE of the form $\\frac{dy}{dt} = f(t, y)$, the RK4 algorithm advances the solution from time $t_n$ to $t_{n+1} = t_n + dt$ as follows:\n$$\ny_{n+1} = y_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\nwhere the intermediate slopes are calculated as:\n$$\n\\begin{align*}\nk_1 = dt \\cdot f(t_n, y_n) \\\\\nk_2 = dt \\cdot f(t_n + \\frac{dt}{2}, y_n + \\frac{k_1}{2}) \\\\\nk_3 = dt \\cdot f(t_n + \\frac{dt}{2}, y_n + \\frac{k_2}{2}) \\\\\nk_4 = dt \\cdot f(t_n + dt, y_n + k_3)\n\\end{align*}\n$$\nIn our specific problem, the variable $y$ corresponds to the amplitude $A$.\n\nThe overall solution procedure for each test case is as follows:\n$1$.  Discretize the time interval $[0, t_{\\text{end}}]$ into a grid of points $t_n = n \\cdot dt$, where $n$ is an integer from $0$ to $N_{\\text{steps}} = \\lfloor t_{\\text{end}} / dt \\rfloor$.\n$2$.  Initialize the solution array with $A_0 = A(0)$.\n$3$.  Iterate from $n=0$ to $N_{\\text{steps}}-1$, applying the RK4 update step to compute $A_{n+1}$ from $A_n$.\n$4$.  After each computation of $A_{n+1}$, enforce the non-negativity constraint: $A_{n+1} \\leftarrow \\max(0, A_{n+1})$.\n$5$.  Store the computed values of $A_n$ for all time steps.\n$6$.  After the integration is complete, analyze the resulting time series $A_n$. Iterate through the series to find the length of the longest contiguous sequence of time points for which $A_n \\ge A_{\\text{thr}}$. Let this number of points be $N_{\\text{contiguous, max}}$.\n$7$.  The duration of this longest interval is calculated as $T_{\\text{contiguous, max}} = N_{\\text{contiguous, max}} \\times dt$.\n$8$.  The condition for overcoming the shear barrier is met if and only if $T_{\\text{contiguous, max}} \\ge \\tau_{\\text{hold}}$. The result for the case is a boolean value (`True` or `False`).\n\nThis procedure is implemented for each of the five test cases provided, yielding a definitive boolean result for each.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (strong shear, moderate bursts)\n        {\n            \"gamma_L\": 0.4, \"gamma_E0\": 0.6, \"Delta_E\": 0.1, \"T_E\": 20.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(0.3, 30.0, 0.5), (0.3, 60.0, 0.5)]\n        },\n        # Case 2 (moderate shear, one strong burst)\n        {\n            \"gamma_L\": 0.4, \"gamma_E0\": 0.35, \"Delta_E\": 0.1, \"T_E\": 25.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(1.0, 30.0, 1.0)]\n        },\n        # Case 3 (large shear excursions, small bursts)\n        {\n            \"gamma_L\": 0.4, \"gamma_E0\": 0.5, \"Delta_E\": 0.25, \"T_E\": 30.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(0.4, 10.0, 0.7), (0.4, 20.0, 0.7)]\n        },\n        # Case 4 (near balance, multiple modest bursts)\n        {\n            \"gamma_L\": 0.45, \"gamma_E0\": 0.43, \"Delta_E\": 0.05, \"T_E\": 40.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(0.35, 15.0, 1.2), (0.35, 25.0, 1.2), (0.35, 35.0, 1.2)]\n        },\n        # Case 5 (no drive, no bursts)\n        {\n            \"gamma_L\": 0.0, \"gamma_E0\": 0.2, \"Delta_E\": 0.0, \"T_E\": 50.0,\n            \"mu\": 1.0, \"A0\": 0.0,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": []\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\ndef run_simulation(params):\n    \"\"\"\n    Solves the ODE for a single case and checks the barrier overcoming criterion.\n    \n    Args:\n        params (dict): A dictionary containing all parameters for the simulation.\n    \n    Returns:\n        bool: True if the barrier is overcome, False otherwise.\n    \"\"\"\n    # Extract parameters from the dictionary for clarity\n    gamma_L = params[\"gamma_L\"]\n    mu = params[\"mu\"]\n    A0 = params[\"A0\"]\n    A_thr = params[\"A_thr\"]\n    tau_hold = params[\"tau_hold\"]\n    t_end = params[\"t_end\"]\n    dt = params[\"dt\"]\n    burst_params = params[\"bursts\"]\n    \n    # Define time-dependent functions using parameters\n    def gamma_E(t):\n        return params[\"gamma_E0\"] + params[\"Delta_E\"] * np.sin(2 * np.pi * t / params[\"T_E\"])\n\n    def F_burst(t):\n        force = 0.0\n        for B, t_i, sigma in burst_params:\n            force += B * np.exp(-((t - t_i)**2) / (2 * sigma**2))\n        return force\n\n    # Define the right-hand side of the ODE, dA/dt = f(t, A)\n    def f(t, A):\n        return (gamma_L - gamma_E(t)) * A - mu * A**3 + F_burst(t)\n\n    # Set up time grid and solution array\n    num_steps = int(t_end / dt)\n    t_values = np.linspace(0, t_end, num_steps + 1)\n    A_values = np.zeros(num_steps + 1)\n    A_values[0] = A0\n\n    # Perform RK4 integration\n    for i in range(num_steps):\n        t_n = t_values[i]\n        A_n = A_values[i]\n\n        k1 = dt * f(t_n, A_n)\n        k2 = dt * f(t_n + 0.5 * dt, A_n + 0.5 * k1)\n        k3 = dt * f(t_n + 0.5 * dt, A_n + 0.5 * k2)\n        k4 = dt * f(t_n + dt, A_n + k3)\n        \n        A_next = A_n + (1.0/6.0) * (k1 + 2*k2 + 2*k3 + k4)\n        \n        # Enforce non-negativity constraint\n        A_values[i+1] = max(0.0, A_next)\n\n    # Check the barrier overcoming criterion\n    max_contiguous_time = 0\n    current_contiguous_time = 0\n    for A_val in A_values:\n        if A_val = A_thr:\n            current_contiguous_time += dt\n        else:\n            max_contiguous_time = max(max_contiguous_time, current_contiguous_time)\n            current_contiguous_time = 0\n    \n    # Final check after the loop to account for a final contiguous block\n    max_contiguous_time = max(max_contiguous_time, current_contiguous_time)\n    \n    # Use a small tolerance for floating point comparison\n    return max_contiguous_time = (tau_hold - dt/2)\n\nsolve()\n```"
        }
    ]
}