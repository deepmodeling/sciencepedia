{
    "hands_on_practices": [
        {
            "introduction": "在物理学中，对称性原理扮演着守门人的角色，深刻地决定了哪些过程可以发生。在湍流输运中，一个核心的对称性论证解释了为什么本征旋转需要特定的条件才能产生。这个练习将通过一个理想化的思想实验，直观地展示在完美的上下对称磁约束位形中，径向动量通量为何必须为零。通过这个计算，你将亲手验证对称性破缺是产生非零剩余应力的根本前提。",
            "id": "4209334",
            "problem": "考虑一个具有圆形、上下对称磁几何的托卡马克中静电湍流的局域磁通管描述。设主导不稳定性为离子温度梯度（ITG）模。在准线性水平上，环向离子动量的径向通量定义为径向速度涨落和环向速度涨落的准线性（QL）关联，\n$$\n\\Pi_{r\\phi}^{\\mathrm{QL}} \\equiv m_i n_0 \\left\\langle \\tilde{v}_r \\, \\tilde{u}_\\phi \\right\\rangle,\n$$\n其中 $m_i$ 是离子质量，$n_0$ 是平衡离子密度，$\\tilde{v}_r$ 是径向速度涨落，$\\tilde{u}_\\phi$ 是环向速度涨落。在单个$k_y$傅里叶分量表象下进行计算，其复振幅 $\\hat{\\phi}(\\theta)$ 和 $\\hat{u}_\\phi(\\theta)$ 依赖于磁力线极向角 $\\theta$。径向速度涨落由 $\\mathbf{E}\\times\\mathbf{B}$ 漂移给出，\n$$\n\\tilde{v}_r = \\frac{c}{B} \\frac{\\partial \\tilde{\\phi}}{\\partial y},\n$$\n其中 $\\tilde{\\phi}(\\mathbf{x},t) = \\Re\\left\\{\\hat{\\phi}(\\theta)\\exp\\left[i k_y y - i \\omega t\\right]\\right\\}$，$c$ 是光速，$B$ 是磁场强度，$k_y$ 是副法向波数，$\\omega$ 是复模频率。对于单个模式，两个实涨落场乘积的时间平均满足\n$$\n\\left\\langle \\tilde{v}_r \\, \\tilde{u}_\\phi \\right\\rangle = \\frac{1}{2}\\Re\\left\\{\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta)\\right\\},\n$$\n其中 $\\hat{v}_r(\\theta) = \\frac{c}{B} i k_y \\hat{\\phi}(\\theta)$。\n\n假设一个气球模宇称的ITG本征函数结构，其中静电势为偶函数，环向速度响应为奇函数，且与电势有$\\pi/2$的相移：\n$$\n\\hat{\\phi}(\\theta) = \\phi_0 \\exp\\!\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right),\n\\qquad\n\\hat{u}_\\phi(\\theta) = i\\,U_0\\,\\theta \\exp\\!\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right),\n$$\n其中 $\\phi_0>0$，$U_0>0$ 和 $\\theta_0>0$ 是实常数，$i$ 是虚数单位。将磁面平均视为局域准线性关联在 $\\theta \\in (-\\infty,\\infty)$ 上的积分，与之成正比，即\n$$\n\\Pi_{r\\phi}^{\\mathrm{QL}} \\propto \\int_{-\\infty}^{\\infty} \\Re\\left\\{\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta)\\right\\}\\,d\\theta,\n$$\n系数为一个总的正的常数前因子。\n\n仅使用上述定义和本征函数，计算由气球模结构的宇称和漂移波交叉相位所决定的 $\\Pi_{r\\phi}^{\\mathrm{QL}}$ 的符号。以数值形式报告其符号，正为$+1$，负为$-1$，零为$0$。然后，用文字说明必须打破哪种对称性才能获得非零结果。你最终报告的符号必须是一个无单位的实数。",
            "solution": "问题要求计算准线性环向动量通量 $\\Pi_{r\\phi}^{\\mathrm{QL}}$ 的符号，并指明在给定理论框架内，必须打破何种对称性才能产生非零通量。\n\n磁面平均的动量通量被给出为与极向角 $\\theta$ 上的一个积分成正比：\n$$\n\\Pi_{r\\phi}^{\\mathrm{QL}} \\propto \\int_{-\\infty}^{\\infty} \\Re\\left\\{\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta)\\right\\}\\,d\\theta\n$$\n其中比例常数为正。因此，$\\Pi_{r\\phi}^{\\mathrm{QL}}$ 的符号由该积分的符号确定。\n\n我们已知径向速度涨落 $\\hat{v}_r(\\theta)$ 和环向速度涨落 $\\hat{u}_\\phi(\\theta)$ 的复振幅。径向速度通过以下关系式与静电势 $\\hat{\\phi}(\\theta)$ 相关：\n$$\n\\hat{v}_r(\\theta) = \\frac{c}{B} i k_y \\hat{\\phi}(\\theta)\n$$\n问题指明了静电势和环向速度的本征函数结构为：\n$$\n\\hat{\\phi}(\\theta) = \\phi_0 \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right)\n$$\n$$\n\\hat{u}_\\phi(\\theta) = i\\,U_0\\,\\theta \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right)\n$$\n其中 $\\phi_0$、$U_0$ 和 $\\theta_0$ 是正实常数。\n\n首先，我们将 $\\hat{\\phi}(\\theta)$ 的表达式代入 $\\hat{v}_r(\\theta)$ 的表达式中：\n$$\n\\hat{v}_r(\\theta) = \\frac{c i k_y \\phi_0}{B} \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right)\n$$\n接下来，我们求 $\\hat{u}_\\phi(\\theta)$ 的复共轭：\n$$\n\\hat{u}_\\phi^*(\\theta) = \\left( i\\,U_0\\,\\theta \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right) \\right)^*\n$$\n由于 $U_0$、$\\theta$ 和 $\\theta_0$ 都是实数，复共轭只作用于虚数单位 $i$，其中 $i^* = -i$。\n$$\n\\hat{u}_\\phi^*(\\theta) = -i\\,U_0\\,\\theta \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right)\n$$\n现在我们可以构建出现在被积函数中的乘积 $\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta)$：\n$$\n\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta) = \\left( \\frac{c i k_y \\phi_0}{B} \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right) \\right) \\left( -i\\,U_0\\,\\theta \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2}\\right) \\right)\n$$\n$$\n= (-i^2) \\left( \\frac{c k_y \\phi_0 U_0}{B} \\right) \\theta \\exp\\left(-\\frac{\\theta^2}{\\theta_0^2} - \\frac{\\theta^2}{\\theta_0^2}\\right)\n$$\n使用恒等式 $i^2 = -1$，我们得到：\n$$\n\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta) = \\frac{c k_y \\phi_0 U_0}{B} \\theta \\exp\\left(-\\frac{2\\theta^2}{\\theta_0^2}\\right)\n$$\n量 $c$、$k_y$、$\\phi_0$、$U_0$ 和 $B$ 都是实数。因此，乘积 $\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta)$ 是一个关于 $\\theta$ 的纯实函数。被积函数是这个乘积的实部，也就是该函数本身：\n$$\n\\Re\\left\\{\\hat{v}_r(\\theta)\\,\\hat{u}_\\phi^*(\\theta)\\right\\} = \\frac{c k_y \\phi_0 U_0}{B} \\theta \\exp\\left(-\\frac{2\\theta^2}{\\theta_0^2}\\right)\n$$\n设此被积函数为 $f(\\theta)$。总通量与 $f(\\theta)$ 在 $-\\infty$ 到 $\\infty$ 上的积分成正比。\n我们现在考察被积函数关于 $\\theta$ 的宇称。令 $C = \\frac{c k_y \\phi_0 U_0}{B}$ 为常数前因子。\n$$\nf(\\theta) = C \\cdot \\theta \\exp\\left(-\\frac{2\\theta^2}{\\theta_0^2}\\right)\n$$\n我们在 $-\\theta$ 处计算该函数的值：\n$$\nf(-\\theta) = C \\cdot (-\\theta) \\exp\\left(-\\frac{2(-\\theta)^2}{\\theta_0^2}\\right) = -C \\cdot \\theta \\exp\\left(-\\frac{2\\theta^2}{\\theta_0^2}\\right) = -f(\\theta)\n$$\n被积函数 $f(\\theta)$ 是 $\\theta$ 的奇函数。任何奇函数在对称区间 $(-\\infty, \\infty)$ 上的积分恒为零。\n$$\n\\int_{-\\infty}^{\\infty} f(\\theta)\\, d\\theta = \\int_{-\\infty}^{\\infty} C \\cdot \\theta \\exp\\left(-\\frac{2\\theta^2}{\\theta_0^2}\\right) \\, d\\theta = 0\n$$\n由于 $\\Pi_{r\\phi}^{\\mathrm{QL}}$ 与此积分成正比，我们得出结论 $\\Pi_{r\\phi}^{\\mathrm{QL}} = 0$。\n因此，表示通量符号的数值为 $0$。\n\n对于问题的第二部分，我们必须确定导致这个零结果的对称性。计算表明，积分为零是因为被积函数是极向角 $\\theta$ 的奇函数。这个宇称性质源于所假设的本征函数的宇称。\n电势 $\\hat{\\phi}(\\theta)$ 是 $\\theta$ 的偶函数：$\\hat{\\phi}(-\\theta) = \\hat{\\phi}(\\theta)$。\n由于 $\\hat{v}_r(\\theta) \\propto i\\hat{\\phi}(\\theta)$，$\\hat{v}_r(\\theta)$ 也是 $\\theta$ 的偶函数。\n环向速度微扰 $\\hat{u}_\\phi(\\theta)$ 被构造成 $\\theta$ 的奇函数：$\\hat{u}_\\phi(-\\theta) = -\\hat{u}_\\phi(\\theta)$。因此，其复共轭 $\\hat{u}_\\phi^*(\\theta)$ 也是奇函数。\n被积函数实际上是一个偶函数 ($\\hat{v}_r$) 和一个奇函数 ($\\hat{u}_\\phi^*$) 的乘积，结果是一个整体的奇函数。线性本征函数这种确定的宇称结构（偶电势，奇环向速度）是所假设的上下对称磁几何的直接结果，其中中平面 $\\theta=0$ 是一个对称面。\n要获得非零的动量通量结果，积分必须非零。这要求被积函数具有一个非零的偶分量。这只有在本征函数本身不具有确定的、相反的宇称时才会发生。当物理系统的内在对称性被打破时，就会出现这种“混合宇称”或“倾斜”的结构。因此，为了获得非零的动量通量，必须打破磁几何相对于外侧中平面（$\\theta = 0$）的**上下对称性**。在实际的等离子体情况中，这种对称性可以通过磁面位形（例如非圆形等离子体中的三角形变或Shafranov位移）或背景剪切流（例如$\\mathbf{E}\\times\\mathbf{B}$速度剪切）来打破。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "一旦我们理解了对称性破缺的必要性，下一步就是量化其产生的效应。这个练习将引导你从一个简化的离子温度梯度（ITG）湍流模型出发，推导径向动量通量与离子热通量之比。这个练习让你能够亲手建立等离子体参数（如磁剪切）与动量和热量输运效率之间的直接联系，从而深入理解决定本征旋转驱动的关键物理机制。",
            "id": "4209305",
            "problem": "一个具有离子温度梯度（ITG）湍流的大环径比托卡马克等离子体，在球涨表示下，通过使用绝热电子和单一傅里叶模式的静电模型进行建模。考虑一个模式，其静电势涨落为 $\\tilde{\\phi}(\\mathbf{r},t)=\\Phi \\exp(i k_{y} y + i k_{\\parallel} z - i \\omega t)$，其中 $k_{y}$ 是副法向波数，$k_{\\parallel}$ 是平行波数，$\\omega=\\omega_{r}+i\\gamma$ 是复频率。安全因子为 $q$，磁剪切为 $\\hat{s}$，大半径为 $R$。假设如下：\n\n- 绝热电子响应和准中性，因此离子密度涨落满足 $\\tilde{n}/n_{0} = (e/T_{e}) \\tilde{\\phi}$。\n- 与该模式相关的径向 $\\mathbf{E}\\times\\mathbf{B}$ 速度为 $\\tilde{v}_{E}^{r} = - (c/B) \\, i k_{y} \\tilde{\\phi}$，其中 $c$ 是光速，$B$ 是磁场强度。\n- 每个模式的准线性离子热通量为 $Q_{i}(k) = - n_{0} \\, k_{y} \\, (c/B) \\, \\operatorname{Im}\\!\\left(\\tilde{T}_{i} \\tilde{\\phi}^{\\ast}\\right)$，其中 $\\tilde{T}_{i}$ 是离子温度涨落。\n- 每个模式的准线性径向-环向动量通量为 $\\Pi_{r\\phi}^{\\mathrm{QL}}(k) = - n_{0} \\, m_{i} \\, k_{y} \\, (c/B) \\, R \\, \\operatorname{Im}\\!\\left(\\tilde{u}_{\\parallel} \\tilde{\\phi}^{\\ast}\\right)$，其中 $\\tilde{u}_{\\parallel}$ 是平行离子流涨落，$m_{i}$ 是离子质量。\n\n为联系平行动力学和ITG驱动，取线性化的平行力动量响应由平行电场主导：\n$$\n- i \\omega \\, \\tilde{u}_{\\parallel} \\approx - \\frac{e}{m_{i}} \\, i k_{\\parallel} \\, \\tilde{\\phi} \\quad \\Rightarrow \\quad \\tilde{u}_{\\parallel} = \\frac{e}{m_{i}} \\, \\frac{k_{\\parallel}}{\\omega} \\, \\tilde{\\phi},\n$$\n并通过具有ITG和曲率驱动的线性化漂移-流体平衡来模拟离子温度响应：\n$$\n- i \\omega \\, \\tilde{T}_{i} \\approx i \\left(\\omega_{\\ast i}^{T} - \\omega_{d i}\\right) \\, e \\, \\tilde{\\phi} \\quad \\Rightarrow \\quad \\tilde{T}_{i} = \\frac{\\omega_{\\ast i}^{T} - \\omega_{d i}}{\\omega} \\, e \\, \\tilde{\\phi}.\n$$\n此处 $\\omega_{\\ast i}^{T} \\equiv \\eta_{i} \\, \\omega_{\\ast i}$ 是离子温度梯度抗磁频率，其中 $\\eta_{i} \\equiv L_{n}/L_{T}$，$L_{n}$ 是密度梯度标长，$L_{T}$ 是温度梯度标长；$\\omega_{\\ast i} \\equiv (k_{y} T_{i} / e B) \\, (1/L_{n})$ 是离子抗磁频率；$\\omega_{d i} \\equiv 2 k_{y} T_{i} / (e B R)$ 是在外侧中平面上的离子曲率漂移频率。在球涨表示中，对于一个定域在外侧中平面附近的模式，使用标准标度关系 $k_{\\parallel} \\approx \\hat{s} \\, k_{y} / (q R)$。\n\n从这些定义和近似出发，推导类普朗特准线性比\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}}\n$$\n的闭式解析表达式，该表达式应使用参数 $(\\hat{s}, q, R, B, T_{i}, L_{n}, L_{T})$ 表示，然后对以下参数集进行数值计算：\n- $R/L_{T} = 6$,\n- $R/L_{n} = 2$,\n- $\\hat{s} = 0.6$,\n- $q = 2$,\n- $R = 3\\,\\mathrm{m}$,\n- $B = 3\\,\\mathrm{T}$,\n- $T_{i} = 8\\,\\mathrm{keV}$.\n\n以 $\\mathrm{s}/\\mathrm{m}$ 为单位表示您对 $\\Pi_{r\\phi}^{\\mathrm{QL}}/Q_{i}$ 的最终数值答案，并四舍五入到四位有效数字。最后，基于您推导的表达式，定性解释在保持所有其他参数不变的情况下，$\\Pi_{r\\phi}^{\\mathrm{QL}}/Q_{i}$ 如何随磁剪切 $\\hat{s}$ 变化。",
            "solution": "题目陈述经过验证。\n\n### 第1步：提取已知条件\n- **等离子体模型**：大环径比托卡马克，静电ITG湍流，绝热电子，球涨表示中的单一傅里叶模式。\n- **静电势涨落**：$\\tilde{\\phi}(\\mathbf{r},t)=\\Phi \\exp(i k_{y} y + i k_{\\parallel} z - i \\omega t)$。\n- **模式参数**：$k_{y}$ (副法向波数)，$k_{\\parallel}$ (平行波数)，$\\omega=\\omega_{r}+i\\gamma$ (复频率)。\n- **装置/剖面参数**：$q$ (安全因子)，$\\hat{s}$ (磁剪切)，$R$ (大半径)，$B$ (磁场强度)，$m_i$ (离子质量)。\n- **密度响应**：绝热电子响应和准中性意味着 $\\tilde{n}/n_{0} = (e/T_{e}) \\tilde{\\phi}$。\n- **径向速度涨落**：$\\tilde{v}_{E}^{r} = - (c/B) \\, i k_{y} \\tilde{\\phi}$。\n- **准线性离子热通量**：$Q_{i}(k) = - n_{0} \\, k_{y} \\, (c/B) \\, \\operatorname{Im}\\!\\left(\\tilde{T}_{i} \\tilde{\\phi}^{\\ast}\\right)$。\n- **准线性动量通量**：$\\Pi_{r\\phi}^{\\mathrm{QL}}(k) = - n_{0} \\, m_{i} \\, k_{y} \\, (c/B) \\, R \\, \\operatorname{Im}\\!\\left(\\tilde{u}_{\\parallel} \\tilde{\\phi}^{\\ast}\\right)$。\n- **平行离子流响应**：$\\tilde{u}_{\\parallel} = \\frac{e}{m_{i}} \\, \\frac{k_{\\parallel}}{\\omega} \\, \\tilde{\\phi}$。\n- **离子温度响应**：$\\tilde{T}_{i} = \\frac{\\omega_{\\ast i}^{T} - \\omega_{d i}}{\\omega} \\, e \\, \\tilde{\\phi}$。\n- **频率定义**：\n    - $\\omega_{\\ast i}^{T} \\equiv \\eta_{i} \\, \\omega_{\\ast i}$\n    - $\\eta_{i} \\equiv L_{n}/L_{T}$\n    - $\\omega_{\\ast i} \\equiv (k_{y} T_{i} / e B) \\, (1/L_{n})$\n    - $\\omega_{d i} \\equiv 2 k_{y} T_{i} / (e B R)$\n- **球涨近似**：$k_{\\parallel} \\approx \\hat{s} \\, k_{y} / (q R)$。\n- **数值参数**：$R/L_{T} = 6$, $R/L_{n} = 2$, $\\hat{s} = 0.6$, $q = 2$, $R = 3\\,\\mathrm{m}$, $B = 3\\,\\mathrm{T}$, $T_{i} = 8\\,\\mathrm{keV}$。\n- **要求输出**：\n    1.  比值 $\\Pi_{r\\phi}^{\\mathrm{QL}}/Q_{i}$ 的闭式解析表达式。\n    2.  该比值的数值计算结果，单位为 $\\mathrm{s}/\\mathrm{m}$，四舍五入到四位有效数字。\n    3.  关于对磁剪切 $\\hat{s}$ 依赖性的定性解释。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题设定在聚变等离子体湍流理论的标准框架内。所涉及的概念（ITG、球涨表示、准线性通量、抗磁漂移）以及代表简化流体模型的给定方程都是该领域的标准内容。\n- **提法恰当**：该问题提供了推导所要求比值所需的所有必要定义和方程。数值对于托卡马克等离子体而言在物理上是合理的。任务定义明确。\n- **客观性**：该问题使用等离子体物理学中精确、标准的术语进行陈述。\n- **量纲一致性**：对比值 $\\Pi_{r\\phi}^{\\mathrm{QL}}/Q_{i}$ 的量纲分析表明其单位为时间/长度 ($\\mathrm{s}/\\mathrm{m}$)。\n    - 动量通量（应力）$\\Pi_{r\\phi}^{\\mathrm{QL}}$ 的单位是 $\\text{力}/\\text{面积}$，或 $\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$。\n    - 热通量 $Q_i$ 的单位是 $\\text{能量}/(\\text{面积} \\cdot \\text{时间})$，或 $\\text{kg} \\cdot \\text{s}^{-3}$。\n    - 这些量的比值单位为 $(\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}) / (\\text{kg} \\cdot \\text{s}^{-3}) = \\text{s}/\\text{m}$。\n    - 这与题目陈述中要求的单位相符。\n\n### 第3步：结论与行动\n该问题在科学上合理，提法恰当，内部一致，并需要基于等离子体物理学基本原理进行不平凡的推导和计算。因此，它被认为是**有效的**。\n\n### 解答\n第一步是推导准线性动量通量与准线性离子热通量之比的解析表达式。该比值由给定的定义构成：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = \\frac{- n_{0} \\, m_{i} \\, k_{y} \\, (c/B) \\, R \\, \\operatorname{Im}\\!\\left(\\tilde{u}_{\\parallel} \\tilde{\\phi}^{\\ast}\\right)}{- n_{0} \\, k_{y} \\, (c/B) \\, \\operatorname{Im}\\!\\left(\\tilde{T}_{i} \\tilde{\\phi}^{\\ast}\\right)}\n$$\n公共前置因子 $-n_{0} k_{y} (c/B)$ 被消去，得到：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = m_i R \\frac{\\operatorname{Im}\\!\\left(\\tilde{u}_{\\parallel} \\tilde{\\phi}^{\\ast}\\right)}{\\operatorname{Im}\\!\\left(\\tilde{T}_{i} \\tilde{\\phi}^{\\ast}\\right)}\n$$\n接下来，我们代入给定的平行离子流涨落 $\\tilde{u}_{\\parallel}$ 和离子温度涨落 $\\tilde{T}_{i}$ 的线性化响应：\n$$\n\\tilde{u}_{\\parallel} = \\frac{e}{m_{i}} \\frac{k_{\\parallel}}{\\omega} \\tilde{\\phi}\n$$\n$$\n\\tilde{T}_{i} = \\frac{\\omega_{\\ast i}^{T} - \\omega_{d i}}{\\omega} e \\tilde{\\phi}\n$$\n虚部算子内的项变为：\n$$\n\\tilde{u}_{\\parallel} \\tilde{\\phi}^{\\ast} = \\left(\\frac{e}{m_{i}} \\frac{k_{\\parallel}}{\\omega} \\tilde{\\phi}\\right) \\tilde{\\phi}^{\\ast} = \\frac{e k_{\\parallel}}{m_{i}} \\frac{1}{\\omega} |\\tilde{\\phi}|^2\n$$\n$$\n\\tilde{T}_{i} \\tilde{\\phi}^{\\ast} = \\left(\\frac{\\omega_{\\ast i}^{T} - \\omega_{d i}}{\\omega} e \\tilde{\\phi}\\right) \\tilde{\\phi}^{\\ast} = e (\\omega_{\\ast i}^{T} - \\omega_{d i}) \\frac{1}{\\omega} |\\tilde{\\phi}|^2\n$$\n设复频率为 $\\omega = \\omega_r + i\\gamma$。$1/\\omega$ 的虚部为：\n$$\n\\operatorname{Im}\\left(\\frac{1}{\\omega}\\right) = \\operatorname{Im}\\left(\\frac{1}{\\omega_r + i\\gamma}\\right) = \\operatorname{Im}\\left(\\frac{\\omega_r - i\\gamma}{\\omega_r^2 + \\gamma^2}\\right) = -\\frac{\\gamma}{\\omega_r^2 + \\gamma^2} = -\\frac{\\gamma}{|\\omega|^2}\n$$\n对于不稳定的模式，增长率 $\\gamma > 0$。参数 $k_\\parallel$、$\\omega_{\\ast i}^{T}$ 和 $\\omega_{d i}$ 是实数。因此，我们发现：\n$$\n\\operatorname{Im}\\!\\left(\\tilde{u}_{\\parallel} \\tilde{\\phi}^{\\ast}\\right) = \\frac{e k_{\\parallel}}{m_{i}} |\\tilde{\\phi}|^2 \\left(-\\frac{\\gamma}{|\\omega|^2}\\right) = -\\frac{e k_{\\parallel} \\gamma}{m_i |\\omega|^2} |\\tilde{\\phi}|^2\n$$\n$$\n\\operatorname{Im}\\!\\left(\\tilde{T}_{i} \\tilde{\\phi}^{\\ast}\\right) = e (\\omega_{\\ast i}^{T} - \\omega_{d i}) |\\tilde{\\phi}|^2 \\left(-\\frac{\\gamma}{|\\omega|^2}\\right) = -\\frac{e (\\omega_{\\ast i}^{T} - \\omega_{d i}) \\gamma}{|\\omega|^2} |\\tilde{\\phi}|^2\n$$\n将这些代回比值的表达式中，包含 $\\gamma$、 $|\\omega|^2$、 $e$ 和 $|\\tilde{\\phi}|^2$ 的项被消去（假设 $\\gamma \\neq 0$）：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = m_i R \\frac{-\\frac{e k_{\\parallel} \\gamma}{m_i |\\omega|^2} |\\tilde{\\phi}|^2}{-\\frac{e (\\omega_{\\ast i}^{T} - \\omega_{d i}) \\gamma}{|\\omega|^2} |\\tilde{\\phi}|^2} = m_i R \\frac{k_{\\parallel}/m_i}{\\omega_{\\ast i}^{T} - \\omega_{d i}} = R \\frac{k_{\\parallel}}{\\omega_{\\ast i}^{T} - \\omega_{d i}}\n$$\n现在，我们代入 $k_{\\parallel}$、$\\omega_{\\ast i}^{T}$ 和 $\\omega_{d i}$ 的定义。\n使用球涨近似 $k_{\\parallel} \\approx \\hat{s} k_y / (qR)$。\n频率 $\\omega_{\\ast i}^{T}$ 由 $\\omega_{\\ast i}^{T} = \\eta_i \\omega_{\\ast i} = (L_n/L_T) \\cdot (k_y T_i / eB L_n) = k_y T_i / (eB L_T)$ 给出。\n频率 $\\omega_{di}$ 是 $\\omega_{di} = 2 k_y T_i / (eBR)$。\n将这些代入比值中：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = R \\frac{\\hat{s} k_y / (qR)}{\\frac{k_y T_i}{eB L_T} - \\frac{2 k_y T_i}{eBR}}\n$$\n副法向波数 $k_y$ 和分子中的大半径 $R$ 项被消去：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = \\frac{\\hat{s}/q}{\\frac{T_i}{eB} \\left(\\frac{1}{L_T} - \\frac{2}{R}\\right)}\n$$\n在分母中提出公因子 $R$ 以使用给定的无量纲参数，得到最终的解析表达式：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = \\frac{\\hat{s}}{q} \\frac{eB}{ \\frac{T_i}{R} \\left(\\frac{R}{L_T} - 2\\right)} = \\frac{\\hat{s}}{q \\left(\\frac{R}{L_T} - 2\\right)} \\frac{eBR}{T_i}\n$$\n\n接下来，我们使用给定的参数对此表达式进行数值计算：$R/L_{T} = 6$，$\\hat{s} = 0.6$， $q = 2$，$R = 3\\,\\mathrm{m}$，$B = 3\\,\\mathrm{T}$，以及 $T_{i} = 8\\,\\mathrm{keV}$。\n首先，将离子温度转换为国际单位制单位（焦耳）：\n$T_i = 8\\,\\mathrm{keV} = 8 \\times 10^3 \\, \\mathrm{eV} = 8 \\times 10^3 \\times (1.6021766 \\times 10^{-19} \\, \\mathrm{J}) = 1.281741 \\times 10^{-15} \\, \\mathrm{J}$。\n基本电荷为 $e = 1.6021766 \\times 10^{-19} \\, \\mathrm{C}$。\n注意到项 $e/T_i$ 可以被简化：\n$$\n\\frac{e}{T_i} = \\frac{e}{T_{i, \\mathrm{eV}} \\cdot e} = \\frac{1}{T_{i, \\mathrm{eV}}}\n$$\n其中 $T_{i, \\mathrm{eV}} = 8000 \\, \\mathrm{eV}$ 是以电子伏特为单位的温度，所得 $1/T_{i, \\text{eV}}$ 的单位是 $1/\\text{J}$。这种简化很方便。\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = \\frac{0.6}{2 \\left(6 - 2\\right)} \\frac{(1.6021766 \\times 10^{-19} \\, \\mathrm{C})(3 \\, \\mathrm{T})(3 \\, \\mathrm{m})}{1.281741 \\times 10^{-15} \\, \\mathrm{J}}\n$$\n使用简化 $e/T_i = 1/T_{i, \\text{eV}}$：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = \\frac{0.6}{2 \\left(6 - 2\\right)} \\frac{BR}{T_{i, \\mathrm{eV}}} = \\frac{0.6}{8} \\frac{(3 \\, \\mathrm{T})(3 \\, \\mathrm{m})}{8000 \\, \\mathrm{eV}}\n$$\n这个量的单位是 T·m/eV。为了得到国际单位制单位，我们需要使用焦耳作为能量单位。或者转换单位：$1\\,\\mathrm{eV}=1.602... \\times 10^{-19}\\,\\mathrm{J}$。所以使用 $T_i$（以焦耳为单位）进行计算是正确的途径。\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = \\frac{0.6}{2 (4)} \\frac{B R}{T_{i, \\text{[J]}}/e} = \\frac{0.6}{8} \\frac{BR}{T_{i, \\text{[eV]}}} = 0.075 \\times \\frac{3 \\times 3}{8000} \\, \\frac{\\mathrm{T} \\cdot \\mathrm{m}}{\\mathrm{eV}}\n$$\nT·m/eV的单位是：$\\frac{\\text{T} \\cdot \\mathrm{m}}{\\mathrm{J}/e} = \\frac{e \\cdot \\text{T} \\cdot \\mathrm{m}}{\\mathrm{J}} = \\frac{\\mathrm{C} \\cdot \\mathrm{T} \\cdot \\mathrm{m}}{\\mathrm{J}} = \\mathrm{s}/\\mathrm{m}$，如前所述。\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = 0.075 \\times \\frac{9}{8000} = 0.075 \\times 0.001125 = 0.000084375 \\, \\mathrm{s}/\\mathrm{m}\n$$\n用科学记数法表示，这是 $8.4375 \\times 10^{-5} \\, \\mathrm{s}/\\mathrm{m}$。\n四舍五入到四位有效数字，结果是 $8.438 \\times 10^{-5} \\, \\mathrm{s}/\\mathrm{m}$。\n\n最后，我们考察该比值对磁剪切 $\\hat{s}$ 的定性依赖关系。推导出的表达式为：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} = \\left[ \\frac{1}{q \\left(\\frac{R}{L_T} - 2\\right)} \\frac{eBR}{T_i} \\right] \\hat{s}\n$$\n假设所有其他参数（$q, R/L_T, B, R, T_i$）保持不变，方括号中的项是一个正常数。因此，动量通量与热通量之比与磁剪切成正比：\n$$\n\\frac{\\Pi_{r\\phi}^{\\mathrm{QL}}}{Q_{i}} \\propto \\hat{s}\n$$\n在物理上，这种线性依赖关系的产生是因为动量通量由平行离子流涨落 $\\tilde{u}_{\\parallel}$ 直接驱动。在所使用的球涨形式中，模式的有效平行波数与剪切成正比，即 $k_{\\parallel} \\propto \\hat{s}$。较大的剪切会增强模式结构的平行分量，对于给定的静电势涨落 $\\tilde{\\phi}$，这会导致更强的平行速度响应 $\\tilde{u}_{\\parallel}$。在此模型中，离子热通量与 $\\hat{s}$ 无关，因为其驱动项 $(\\omega_{\\ast i}^{T} - \\omega_{d i})$ 不依赖于 $\\hat{s}$。因此，增加磁剪切 $\\hat{s}$ 会相对于热输运选择性地增强湍流驱动的动量输运，导致它们的比值线性增加。这种效应是托卡马克中内禀转动产生的一个关键机制。",
            "answer": "$$\\boxed{8.438 \\times 10^{-5}}$$"
        },
        {
            "introduction": "前面的练习分别揭示了对称性原理和局域微观不稳定性的作用。最后的这个综合性练习旨在将这些基本原理整合到一个更真实的全局模型中。你将构建一个描述剩余应力径向分布的唯象模型，该模型包含了多种对称性破缺机制，如剖面剪切和几何不对稱性。通过这个实践，你将学会如何从基本的等离子体剖面出发，预测驱动本征旋转的剩余应力分布，从而将局域理论与宏观观测联系起来。",
            "id": "4209325",
            "problem": "您需要实现一个自包含的程序，该程序为一组具有科学上合理的剖面的磁约束聚变等离子体中的全局平衡计算剩余环向动量通量（表示为 $\\Pi_{r\\phi}^{\\mathrm{res}}(r)$）的径向趋势，并识别出局域对称性被强烈破坏的径向位置。该程序必须基于第一性原理以及在磁化等离子体中湍流动态输运和内禀旋转研究中经过充分检验的闭合关系。主题领域是聚变等离子体湍流模拟，特别是湍流动态输运和内禀旋转，教育水平为高年级研究生。\n\n该问题必须针对具有圆形截面的大环径比托卡马克平衡进行求解，其中环向角动量密度根据守恒定律演化。从环向角动量的基本守恒开始，其示意性地表示为\n$$\\frac{\\partial L_{\\phi}}{\\partial t} + \\frac{1}{V'}\\frac{\\partial}{\\partial r}\\left(V' \\Pi_{r\\phi}\\right) = \\mathcal{T}_{\\phi},$$\n其中 $L_{\\phi}$ 是环向角动量密度，$V'$ 是微分体积因子，$\\Pi_{r\\phi}$ 是环向动量的径向通量，$\\mathcal{T}_{\\phi}$ 是环向力矩密度。在没有外部施加的力矩且平均流很小的情况下，剩余应力 $\\Pi_{r\\phi}^{\\mathrm{res}}$（$\\Pi_{r\\phi}$ 中不与平均流或其梯度成正比的分量）驱动内禀旋转。来自漂移波回旋动理学湍流的对称性论证表明，平行波数（$k_{\\parallel}$）中完美的局域反射对称性会禁止产生有限的剩余应力。只有当对称性被全局效应破坏时，有限的剩余应力才会出现，这些效应包括平衡剖面的径向变化（剖面剪切）、有限轨道宽度和曲率，以及磁场或几何上的上下不对称性。\n\n为了构建一个科学上合理且可检验的简化模型，您应使用对称性约束和量纲分析为 $\\Pi_{r\\phi}^{\\mathrm{res}}$ 推导一个闭合关系。考虑如下分解\n$$\\Pi_{r\\phi} = \\Pi_{r\\phi}^{\\mathrm{diff}} + \\Pi_{r\\phi}^{\\mathrm{conv}} + \\Pi_{r\\phi}^{\\mathrm{res}},$$\n其中 $\\Pi_{r\\phi}^{\\mathrm{diff}}$ 和 $\\Pi_{r\\phi}^{\\mathrm{conv}}$ 分别是依赖于平均环向流及其梯度的扩散和对流部分，而 $\\Pi_{r\\phi}^{\\mathrm{res}}$ 在领头阶上与平均流无关。受标准回旋动理学对称性论证和准线性闭合关系的启发，将剩余应力建模为\n$$\\Pi_{r\\phi}^{\\mathrm{res}}(r) = n_i(r)\\, m_i\\, c_s(r)^2\\, \\rho_*^2(r)\\, \\mathcal{B}(r),$$\n其中 $n_i(r)$ 是离子数密度，$m_i$ 是离子质量，$c_s(r)$ 是离子声速，$\\rho_*(r)$ 是归一化离子声拉莫尔半径。无量纲项 $\\mathcal{B}(r)$ 编码了对称性破缺，并由以下附加贡献构成：\n$$\\mathcal{B}(r) = C_{\\mathrm{ps}}\\, R_0\\, \\frac{\\partial}{\\partial r}\\ln I(r) \\;+\\; C_{\\mathrm{ud}}\\, A_{\\mathrm{ud}}(r) \\;+\\; C_{\\mathrm{curv}}\\, R_0\\, \\frac{\\partial}{\\partial r}\\ln p_i(r),$$\n其中 $C_{\\mathrm{ps}}$、$C_{\\mathrm{ud}}$、$C_{\\mathrm{curv}}$ 是量级为1的无量纲系数，$R_0$ 是大半径，$I(r)$ 是湍流强度剖面，$A_{\\mathrm{ud}}(r)$ 是上下不对称性度量，$p_i(r)$ 是离子压力剖面。上述形式源于以下事实：剖面剪切（$\\partial_r \\ln I$）和曲率驱动的有限轨道宽度（$\\partial_r \\ln p_i$），以及显式的几何不对称性（$A_{\\mathrm{ud}}$），都会破坏局域的 $k_{\\parallel}$ 反射对称性，从而产生一个与回旋玻姆预因子 $n_i m_i c_s^2 \\rho_*^2$ 和无量纲的对称性破缺度量成标度关系的有限 $\\Pi_{r\\phi}^{\\mathrm{res}}$。\n\n使用标准定义：离子声速为\n$$c_s(r) = \\sqrt{\\frac{e\\, T_e(r)}{m_i}},$$\n其中 $e$ 是基本电荷，$T_e(r)$ 是电子温度，对于本问题，您应将其取为与离子温度 $T_i(r)$ 相等，这与没有强电子-离子温度分离的核心区等离子体的情况一致。离子回旋频率为\n$$\\Omega_i(r) = \\frac{e\\, B_0}{m_i},$$\n其中 $B_0$ 是环向磁场强度，对于大环径比平衡取为常数，离子声拉莫尔半径为\n$$\\rho_s(r) = \\frac{c_s(r)}{\\Omega_i}, \\quad \\rho_*(r) = \\frac{\\rho_s(r)}{R_0}.$$\n在国际单位制中，离子压力为 $p_i(r) = n_i(r)\\, e\\, T_i(r)$。\n\n您必须在小半径 $r \\in [0,a]$ 上使用以下参数化表示来实现物理上真实且光滑的平衡剖面，其中 $x = r/a$：\n- 离子密度剖面：\n$$n_i(r) = n_0\\, \\left(1 - x^2\\right)^{\\alpha_n},$$\n- 离子温度剖面（单位：电子伏特）：\n$$T_i(r) = T_0\\, \\left(1 - x^2\\right)^{\\alpha_T},$$\n- 湍流强度剖面：\n$$I(r) = I_0\\, \\left(1 + \\beta\\, x\\right)\\, \\exp\\left(-\\gamma\\, x^2\\right),$$\n- 上下不对称性度量：\n$$A_{\\mathrm{ud}}(r) = A_0\\, \\exp\\left(-\\frac{(x - x_0)^2}{2\\, \\sigma^2}\\right),$$\n其中 $n_0$、$T_0$、$I_0$、$\\alpha_n$、$\\alpha_T$、$\\beta$、$\\gamma$、$A_0$、$x_0$ 和 $\\sigma$ 是测试套件中提供的常数，且 $x_0$ 和 $\\sigma$ 固定为 $x_0 = 0.7$ 和 $\\sigma = 0.1$。推导并实现所需对数径向导数的解析表达式：\n$$\\frac{\\partial}{\\partial r} \\ln I(r) = \\frac{1}{a}\\left(\\frac{\\beta}{1 + \\beta\\, x} - 2\\, \\gamma\\, x\\right),$$\n$$\\frac{\\partial}{\\partial r} \\ln p_i(r) = \\frac{\\partial}{\\partial r} \\left(\\ln n_i(r) + \\ln T_i(r)\\right) = -\\frac{2\\, x}{a\\, \\left(1 - x^2\\right)} \\left(\\alpha_n + \\alpha_T\\right).$$\n\n您应使用以下常数和假设：\n- 离子种类为氘，质量为 $m_i = 3.344 \\times 10^{-27}\\, \\mathrm{kg}$。\n- 基本电荷为 $e = 1.602 \\times 10^{-19}\\, \\mathrm{C}$。\n- 为了计算 $\\Omega_i$，磁场 $B_0$ 在 $r$ 方向上为常数。\n- 系数固定为 $C_{\\mathrm{ps}} = 0.5$，$C_{\\mathrm{ud}} = 0.3$，$C_{\\mathrm{curv}} = 0.2$。\n- 对称性破缺阈值由无量纲项的绝对值定义：$\\left|\\mathcal{B}(r)\\right| \\ge S_{\\mathrm{thr}}$，其中 $S_{\\mathrm{thr}} = 0.35$。\n\n您的程序必须对每个测试用例，在指定的采样半径 $r/a \\in \\{0.1, 0.3, 0.5, 0.7, 0.9\\}$ 处计算 $\\Pi_{r\\phi}^{\\mathrm{res}}(r)$，以帕斯卡 (N/m$^2$) 为单位表示结果，并根据上述阈值判据确定每个半径处指示局域对称性是否被强烈破坏的布尔标志。所有角度量（如果有）都不是必需的，应避免使用。所有输出必须在国际单位制中保持单位一致。\n\n实现以下平衡的测试套件，涵盖一系列物理相关的区域和边界情况。每个案例由一个参数元组 $(R_0, a, B_0, n_0, T_0, \\alpha_n, \\alpha_T, I_0, \\beta, \\gamma, A_0)$ 定义，其中 $R_0$ 单位为米， $a$ 单位为米， $B_0$ 单位为特斯拉， $n_0$ 单位为 $\\mathrm{m}^{-3}$， $T_0$ 单位为电子伏特， $I_0$ 无量纲：\n- 案例1（基准中型托卡马克，中等梯度和弱不对称性）：$(1.7, 0.6, 2.1, 5.0 \\times 10^{19}, 1500, 0.8, 1.2, 1.0, 0.5, 2.0, 0.05)$。\n- 案例2（边缘对称的湍流强度，不对称性可忽略）：$(1.7, 0.6, 2.1, 5.0 \\times 10^{19}, 1500, 0.8, 1.2, 1.0, 0.0, 1.0, 0.0)$。\n- 案例3（强的上下不对称性和靠近边缘的陡峭强度梯度）：$(1.7, 0.6, 2.1, 5.0 \\times 10^{19}, 1500, 0.8, 1.2, 1.0, 1.2, 3.0, 0.2)$。\n- 案例4（近乎平坦的核心区剖面和可忽略的对称性破缺）：$(1.7, 0.6, 2.1, 5.0 \\times 10^{19}, 1500, 0.1, 0.1, 1.0, 0.0, 0.0, 0.0)$。\n\n您的算法必须：\n- 对每个采样半径和测试用例，计算 $n_i(r)$、$T_i(r)$、$p_i(r)$、$c_s(r)$、$\\rho_s(r)$ 和 $\\rho_*(r)$。\n- 使用提供的解析导数计算 $\\mathcal{B}(r)$。\n- 以 Pa 为单位计算 $\\Pi_{r\\phi}^{\\mathrm{res}}(r)$。\n- 通过条件 $\\left|\\mathcal{B}(r)\\right| \\ge 0.35$ 确定每个半径处的布尔对称性破缺标志。\n\n您的程序必须生成单行输出，格式如下：\n- 一个包含各测试用例结果的列表，其中每个测试用例的结果是一个包含两个列表的列表：\n    - 第一个内部列表是在指定半径处的 $\\Pi_{r\\phi}^{\\mathrm{res}}(r)$ 值，以 Pa 表示并四舍五入到六位小数。\n    - 第二个内部列表是相应的布尔标志（使用编程语言的原生布尔类型），指示在相同半径处是否存在强烈的局域对称性破缺。\n例如，输出必须是以下形式\n$$\\left[\\left[\\left[\\pi_1,\\pi_2,\\ldots\\right],\\left[b_1,b_2,\\ldots\\right]\\right],\\ldots\\right],$$\n其中的确切数值由您的代码针对上述测试套件计算得出。\n\n您的程序必须是一个完整、可运行的程序，精确地按照指定格式生成单行输出，且不接受任何外部输入。执行环境是 Python，您只能使用标准库和指定的科学库。所有计算量必须使用国际单位制 (SI) 单位，并且最终的剩余应力值 $\\Pi_{r\\phi}^{\\mathrm{res}}$ 必须以 Pa 报告并四舍五入到六位小数。",
            "solution": "用户要求编写一个程序，用于计算托卡马克等离子体中剩余环向动量通量 $\\Pi_{r\\phi}^{\\mathrm{res}}(r)$ 的径向剖面，并识别强局域对称性破缺的区域。该问题在科学上是合理的、良定的，并且所有必需的物理模型、参数和常数都已提供。解决方案遵循第一性原理，实现指定的模型。\n\n### 1. 物理模型构建\n\n问题的核心是评估一个用于剩余应力的简化模型，该应力是动量通量中不与平均流或其梯度直接成正比的分量。该应力源于平行于磁场方向（$k_{\\parallel} \\to -k_{\\parallel}$）的局域反射对称性的破缺。提供的剩余应力模型为：\n$$\n\\Pi_{r\\phi}^{\\mathrm{res}}(r) = n_i(r)\\, m_i\\, c_s(r)^2\\, \\rho_*^2(r)\\, \\mathcal{B}(r)\n$$\n该表达式代表了标准的回旋玻姆标度律。项 $n_i m_i c_s^2 \\rho_*^2$ 是湍流输运通量的一个特征量级，与离子压力 $p_i$ 和归一化回旋半径 $\\rho_*$ 的平方成正比。所有对称性破缺的物理学都封装在无量纲项 $\\mathcal{B}(r)$ 中。\n\n对称性破缺项 $\\mathcal{B}(r)$ 被建模为三种不同物理机制的总和：\n$$\n\\mathcal{B}(r) = C_{\\mathrm{ps}}\\, R_0\\, \\frac{\\partial}{\\partial r}\\ln I(r) \\;+\\; C_{\\mathrm{ud}}\\, A_{\\mathrm{ud}}(r) \\;+\\; C_{\\mathrm{curv}}\\, R_0\\, \\frac{\\partial}{\\partial r}\\ln p_i(r)\n$$\n1.  **剖面剪切（$C_{\\mathrm{ps}}$项）**：湍流强度的径向变化 $\\frac{\\partial}{\\partial r}\\ln I(r)$，破坏了潜在微观不稳定性（例如，气球模）的局域对称性。这是一个公认的产生剩余应力的机制。该项通过与大半径 $R_0$ 相乘来进行无量纲化。\n2.  **上下不对称性（$C_{\\mathrm{ud}}$项）**：由无量纲度量 $A_{\\mathrm{ud}}(r)$ 量化的显式几何或磁场上下不对称性，直接破坏系统的反射对称性，导致有限的剩余应力。\n3.  **曲率和有限轨道宽度（$C_{\\mathrm{curv}}$项）**：此处由 $\\frac{\\partial}{\\partial r}\\ln p_i(r)$ 表示的离子压力梯度的径向变化，是与平均 $E \\times B$ 流和新经典流中的径向剪切相关效应的代理，这些效应也会破坏对称性。该项与 $R_0$ 成标度关系，反映了其与全局环向几何的联系。\n\n当这个组合的无量纲项的绝对值超过给定阈值时，对称性被认为是“强烈破缺”：$\\left|\\mathcal{B}(r)\\right| \\ge S_{\\mathrm{thr}}$，其中 $S_{\\mathrm{thr}} = 0.35$。\n\n### 2. 算法实现\n\n该程序旨在为给定的一组平衡和径向位置系统地评估这些方程。对于每个测试用例，算法按以下步骤进行：\n\n1.  **初始化**：定义基本物理常数（$m_i$，$e$）和模型系数（$C_{\\mathrm{ps}}$，$C_{\\mathrm{ud}}$，$C_{\\mathrm{curv}}$）。从测试套件中解包特定平衡的参数（$R_0, a, B_0, n_0, T_0, \\alpha_n, \\alpha_T$ 等）。评估在指定的归一化半径数组 $x = r/a \\in \\{0.1, 0.3, 0.5, 0.7, 0.9\\}$上执行。\n\n2.  **局域等离子体参数计算**：对于每个径向点 $x$，程序使用提供的参数化表示计算基本的等离子体剖面量：\n    -   离子密度：$n_i(x) = n_0\\, \\left(1 - x^2\\right)^{\\alpha_n}$\n    -   离子温度：$T_i(x) = T_0\\, \\left(1 - x^2\\right)^{\\alpha_T}$（单位为 eV）\n\n3.  **导出量计算**：从基础剖面和全局参数计算几个关键的导出量。所有计算均以国际单位制（SI）进行。以电子伏特（eV）给出的温度 $T_i(x)$ 通过乘以基本电荷 $e$ 转换为焦耳。\n    -   离子声速：$c_s(x) = \\sqrt{e\\, T_i(x) / m_i}$\n    -   离子回旋频率：$\\Omega_i = \\frac{e B_0}{m_i}$（对给定案例为常数）\n    -   离子声拉莫尔半径：$\\rho_s(x) = c_s(x) / \\Omega_i$\n    -   归一化拉莫尔半径：$\\rho_*(x) = \\rho_s(x) / R_0$\n\n4.  **对称性破缺项 $\\mathcal{B}(x)$ 的评估**：使用提供的对数导数的解析表达式计算 $\\mathcal{B}(x)$ 的三个分量：\n    -   剖面剪切项需要计算 $\\frac{\\partial}{\\partial r} \\ln I(r) = \\frac{1}{a}\\left(\\frac{\\beta}{1 + \\beta\\, x} - 2\\, \\gamma\\, x\\right)$。\n    -   上下不对称性项需要计算 $A_{\\mathrm{ud}}(x) = A_0\\, \\exp\\left(-\\frac{(x - x_0)^2}{2\\, \\sigma^2}\\right)$。\n    -   曲率/压力梯度项需要计算 $\\frac{\\partial}{\\partial r} \\ln p_i(r) = -\\frac{2\\, x}{a\\, \\left(1 - x^2\\right)} \\left(\\alpha_n + \\alpha_T\\right)$。\n    然后将这些项与其各自的系数（$C_{\\mathrm{ps}}, C_{\\mathrm{ud}}, C_{\\mathrm{curv}}$）和尺度因子（$R_0$）组合，得到总的 $\\mathcal{B}(x)$。\n\n5.  **剩余应力计算**：计算剩余应力 $\\Pi_{r\\phi}^{\\mathrm{res}}(x)$。为提高计算效率和清晰度，预因子用离子压力 $p_i(x) = n_i(x) e T_i(x)$ [Pa] 表示：\n    $$\n    \\Pi_{r\\phi}^{\\mathrm{res}}(x) = \\left(n_i(x) e T_i(x)\\right) \\rho_*^2(x) \\mathcal{B}(x) = p_i(x) \\rho_*^2(x) \\mathcal{B}(x)\n    $$\n    结果以帕斯卡（N/m$^2$）为单位获得，并按要求四舍五入到六位小数。\n\n6.  **对称性破缺标志**：在每个径向点，评估条件 $\\left|\\mathcal{B}(x)\\right| \\ge S_{\\mathrm{thr}}$ 以产生一个布尔标志，指示局域对称性是否被强烈破坏。\n\n7.  **输出格式化**：收集每个测试用例的结果，包括一个 $\\Pi_{r\\phi}^{\\mathrm{res}}$ 值的列表和一个布尔标志的列表。最终输出是一个嵌套列表结构的单行字符串表示，精确地按照问题陈述中指定的格式进行格式化，不含任何多余的字符或空格。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the residual toroidal momentum flux and symmetry breaking flag\n    for a set of tokamak equilibria based on a gyrokinetic-motivated model.\n    \"\"\"\n    # Define physical and model constants\n    M_I = 3.344e-27      # Deuterium mass in kg\n    E_CHARGE = 1.602e-19 # Elementary charge in C\n    C_PS = 0.5           # Profile shearing coefficient\n    C_UD = 0.3           # Up-down asymmetry coefficient\n    C_CURV = 0.2         # Curvature/pressure gradient coefficient\n    X0 = 0.7             # Position of peak asymmetry\n    SIGMA = 0.1          # Width of asymmetry profile\n    S_THR = 0.35         # Symmetry breaking threshold\n\n    # Define the normalized sample radii r/a\n    sample_x = np.array([0.1, 0.3, 0.5, 0.7, 0.9])\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (R0, a, B0, n0, T0, alpha_n, alpha_T, I0, beta, gamma, A0)\n    test_cases = [\n        (1.7, 0.6, 2.1, 5.0e19, 1500, 0.8, 1.2, 1.0, 0.5, 2.0, 0.05),\n        (1.7, 0.6, 2.1, 5.0e19, 1500, 0.8, 1.2, 1.0, 0.0, 1.0, 0.0),\n        (1.7, 0.6, 2.1, 5.0e19, 1500, 0.8, 1.2, 1.0, 1.2, 3.0, 0.2),\n        (1.7, 0.6, 2.1, 5.0e19, 1500, 0.1, 0.1, 1.0, 0.0, 0.0, 0.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        R0, a, B0, n0, T0, alpha_n, alpha_T, I0, beta, gamma, A0 = case\n\n        # Vectorized calculations over the sample_x array\n        x = sample_x\n        \n        # Pre-calculate factors to avoid division-by-zero, although not an issue\n        # for the given sample points.\n        one_minus_x2 = 1 - x**2\n\n        # Calculate primary profiles\n        n_i = n0 * (one_minus_x2)**alpha_n\n        T_i_eV = T0 * (one_minus_x2)**alpha_T\n\n        # Calculate derived physical quantities in SI units\n        T_i_J = T_i_eV * E_CHARGE\n        c_s = np.sqrt(T_i_J / M_I)\n        omega_i = (E_CHARGE * B0) / M_I\n        rho_s = c_s / omega_i\n        rho_star = rho_s / R0\n\n        # Evaluate the dimensionless symmetry-breaking term B(r)\n        # 1. Profile shearing of turbulence intensity\n        dlnI_dr = (1 / a) * (beta / (1 + beta * x) - 2 * gamma * x)\n        term_ps = C_PS * R0 * dlnI_dr\n\n        # 2. Up-down asymmetry\n        A_ud = A0 * np.exp(-(x - X0)**2 / (2 * SIGMA**2))\n        term_ud = C_UD * A_ud\n\n        # 3. Curvature effect via pressure gradient\n        dlnP_dr = (-2 * x / (a * one_minus_x2)) * (alpha_n + alpha_T)\n        term_curv = C_CURV * R0 * dlnP_dr\n\n        B_val = term_ps + term_ud + term_curv\n\n        # Calculate the residual stress Pi_res in Pascals\n        # Note: n_i * M_I * c_s**2 = n_i * T_i_J = p_i (pressure in Pa)\n        p_i = n_i * T_i_J\n        pi_res = p_i * rho_star**2 * B_val\n\n        # Determine the symmetry breaking flag\n        is_broken = np.abs(B_val) >= S_THR\n\n        # Store results for this case, rounding Pi_res and casting bool type\n        pi_res_values = [round(val, 6) for val in pi_res]\n        sym_break_flags = [bool(val) for val in is_broken]\n        \n        all_results.append([pi_res_values, sym_break_flags])\n\n    # Manually construct the output string to match the specified format\n    # exactly, without extraneous spaces introduced by standard list printing.\n    outer_list_str = []\n    for case_result in all_results:\n        pi_str = '[' + ','.join(map(str, case_result[0])) + ']'\n        flag_str = '[' + ','.join(map(str, case_result[1])).lower() + ']'\n        case_str = f'[{pi_str},{flag_str}]'\n        outer_list_str.append(case_str)\n    \n    final_output_str = f\"[{','.join(outer_list_str)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}