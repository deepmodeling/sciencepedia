{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational practice in calculating turbulent transport. Starting from the spectral representations of density and magnetic field fluctuations, you will compute the magnetic flutter-induced particle flux using quasilinear theory . This calculation highlights the critical role of the cross-phase between the fluctuating fields in determining the direction and magnitude of the transport.",
            "id": "4195053",
            "problem": "In a straight-field-line flux-tube model with a strong, uniform guide magnetic field of magnitude $B_0$ aligned with the coordinate $z$, the radial magnetic flutter velocity of species $s$ is modeled as $v_{r,\\mathrm{fl}} = v_{\\parallel s}\\,\\delta b_r$, where $v_{\\parallel s}$ is a constant characteristic parallel speed of species $s$ and $\\delta b_r \\doteq \\delta B_r/B_0$ is the dimensionless radial magnetic perturbation. The magnetic-flutter particle flux of species $s$ is defined as the statistical average $\\Gamma^{\\mathrm{fl}}_s \\doteq \\langle \\delta n_s\\, v_{r,\\mathrm{fl}} \\rangle$, where $\\delta n_s$ is the fluctuating density of species $s$. Assume statistically stationary and homogeneous turbulence in the perpendicular $(x,y)$ plane, and use the Fourier representation\n$$\nf(\\mathbf{x}) \\;=\\; \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,\\tilde{f}(\\mathbf{k})\\,\\exp\\!\\big(i\\,\\mathbf{k}\\cdot\\mathbf{x}\\big),\n$$\nwith the associated cross-power spectral density $C_{fg}(\\mathbf{k})$ defined by $\\langle \\tilde{f}(\\mathbf{k})\\,\\tilde{g}(\\mathbf{k}')^{*}\\rangle \\;=\\; (2\\pi)^2 \\delta(\\mathbf{k}-\\mathbf{k}')\\,C_{fg}(\\mathbf{k})$ so that $\\langle f\\,g\\rangle \\;=\\; \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{fg}(\\mathbf{k})$. Here $^{*}$ denotes complex conjugation.\n\nSuppose the complex spectra of the density fluctuation and the normalized radial magnetic fluctuation are such that their cross-power spectral density is generated by the product of their magnitudes and a wavenumber-independent cross-phase. Concretely, let the complex Fourier amplitudes be\n$$\n\\tilde{n}_s(\\mathbf{k}) \\;=\\; \\mathcal{N}_0\\,\\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2}\\Big)\\,\\exp\\!\\big(i\\,\\phi_n\\big),\\qquad\n\\widetilde{\\delta b}_r(\\mathbf{k}) \\;=\\; \\mathcal{B}_0\\,\\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2}\\Big)\\,\\exp\\!\\big(i\\,\\phi_b\\big),\n$$\nwith constants $\\mathcal{N}_00$, $\\mathcal{B}_00$, and $\\sigma0$. Treat $v_{\\parallel s}$ as a constant parameter. You may assume the ensemble average acts only on phases so that $C_{n b}(\\mathbf{k}) = \\langle \\tilde{n}_s(\\mathbf{k})\\,\\widetilde{\\delta b}_r(\\mathbf{k})^{*}\\rangle = \\mathcal{N}_0 \\mathcal{B}_0 \\exp\\!\\big(-|\\mathbf{k}|^2/\\sigma^2\\big)\\exp\\!\\big(i(\\phi_n-\\phi_b)\\big)$.\n\nStarting from the definitions above and without invoking any additional formulae, compute the quasilinear magnetic flutter particle flux $\\Gamma^{\\mathrm{fl}}_s$ in closed form as a function of the given parameters. Also, identify the phase relations between $\\phi_n$ and $\\phi_b$ that maximize and minimize $\\Gamma^{\\mathrm{fl}}_s$ for fixed $\\mathcal{N}_0$, $\\mathcal{B}_0$, $\\sigma$, and $v_{\\parallel s}$. Report the phase angles in radians. Express the flux $\\Gamma^{\\mathrm{fl}}_s$ as a single analytic expression; if evaluated numerically, it should be expressed in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$. Do not include units in your final boxed answer.",
            "solution": "The user wants me to solve a problem. As per the instructions, I will first validate the problem statement.\n\n### Step 1: Extract Givens\n- **Model**: Straight-field-line flux-tube.\n- **Guide magnetic field**: Magnitude $B_0$, aligned with the $z$ coordinate.\n- **Radial magnetic flutter velocity**: $v_{r,\\mathrm{fl}} = v_{\\parallel s}\\,\\delta b_r$.\n- **Characteristic parallel speed**: $v_{\\parallel s}$ is a constant for species $s$.\n- **Normalized radial magnetic perturbation**: $\\delta b_r \\doteq \\delta B_r/B_0$.\n- **Magnetic-flutter particle flux**: $\\Gamma^{\\mathrm{fl}}_s \\doteq \\langle \\delta n_s\\, v_{r,\\mathrm{fl}} \\rangle$.\n- **Density fluctuation**: $\\delta n_s$.\n- **Turbulence properties**: Statistically stationary and homogeneous in the perpendicular $(x,y)$ plane.\n- **Fourier representation**: $f(\\mathbf{x}) = \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,\\tilde{f}(\\mathbf{k})\\,\\exp(i\\,\\mathbf{k}\\cdot\\mathbf{x})$.\n- **Cross-power spectral density definition**: $\\langle \\tilde{f}(\\mathbf{k})\\,\\tilde{g}(\\mathbf{k}')^{*}\\rangle = (2\\pi)^2 \\delta(\\mathbf{k}-\\mathbf{k}')\\,C_{fg}(\\mathbf{k})$.\n- **Flux-spectrum relation**: $\\langle f\\,g\\rangle = \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{fg}(\\mathbf{k})$.\n- **Fourier amplitude of density fluctuation**: $\\tilde{n}_s(\\mathbf{k}) = \\mathcal{N}_0\\,\\exp(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2})\\,\\exp(i\\,\\phi_n)$.\n- **Fourier amplitude of magnetic fluctuation**: $\\widetilde{\\delta b}_r(\\mathbf{k}) = \\mathcal{B}_0\\,\\exp(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2})\\,\\exp(i\\,\\phi_b)$.\n- **Constants**: $\\mathcal{N}_00$, $\\mathcal{B}_00$, $\\sigma0$.\n- **Assumed cross-power spectral density**: $C_{n b}(\\mathbf{k}) = \\langle \\tilde{n}_s(\\mathbf{k})\\,\\widetilde{\\delta b}_r(\\mathbf{k})^{*}\\rangle = \\mathcal{N}_0 \\mathcal{B}_0 \\exp(-|\\mathbf{k}|^2/\\sigma^2)\\exp(i(\\phi_n-\\phi_b))$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes a canonical quasilinear calculation of particle transport due to magnetic fluctuations in a magnetized plasma. All concepts, definitions, and the mathematical framework (Fourier analysis, statistical averaging) are standard in the field of plasma physics and turbulence theory. The Gaussian shapes for the spectra are a common, simplifying assumption. The problem is scientifically sound.\n2.  **Well-Posed**: The problem provides all necessary definitions, functional forms, and parameters to compute the required quantity. The integral for the flux is well-defined and convergent. The goals are stated clearly. The problem is well-posed.\n3.  **Objective**: The problem is formulated in precise, objective, mathematical language, free of subjective or ambiguous statements.\n4.  **Completeness and Consistency**: The problem is self-contained. The provided formula for the cross-power spectral density $C_{nb}(\\mathbf{k})$ is consistent with the given forms of the Fourier amplitudes $\\tilde{n}_s(\\mathbf{k})$ and $\\widetilde{\\delta b}_r(\\mathbf{k})$ under the specified averaging procedure. While physical quantities like density are real, which imposes constraints on their Fourier transforms ($\\tilde{f}(\\mathbf{k}) = \\tilde{f}^*(-\\mathbf{k})$), the common practice in such quasilinear calculations is to work with complex representations and take the real part of the final result for the flux. This interpretation resolves any apparent inconsistency and is standard in the field.\n5.  **Realism**: The model is an idealization (e.g., straight field lines, constant parallel velocity, fixed phases), but such idealizations are standard in theoretical plasma physics for deriving fundamental transport estimates. The problem is not unrealistic within its theoretical context.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, well-posed problem in theoretical plasma physics. I will now proceed with the solution.\n\nThe magnetic flutter particle flux for species $s$ is defined as the statistical average of the product of the density fluctuation $\\delta n_s$ and the radial flutter velocity $v_{r,\\mathrm{fl}}$.\n$$\n\\Gamma^{\\mathrm{fl}}_s \\doteq \\langle \\delta n_s\\, v_{r,\\mathrm{fl}} \\rangle\n$$\nThe radial flutter velocity is given by $v_{r,\\mathrm{fl}} = v_{\\parallel s}\\,\\delta b_r$, where $v_{\\parallel s}$ is a constant. Substituting this into the flux definition, we obtain:\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\langle \\delta n_s\\, (v_{\\parallel s}\\,\\delta b_r) \\rangle = v_{\\parallel s} \\langle \\delta n_s\\, \\delta b_r \\rangle\n$$\nThe problem provides a relationship between the spatial average of the product of two fluctuating fields, $f$ and $g$, and their cross-power spectral density, $C_{fg}(\\mathbf{k})$.\n$$\n\\langle f\\,g\\rangle = \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{fg}(\\mathbf{k})\n$$\nApplying this formula to our expression for the flux, we have $f=\\delta n_s$ and $g=\\delta b_r$. The corresponding cross-power spectral density is $C_{nb}(\\mathbf{k})$. Thus, the flux is given by:\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s} \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{nb}(\\mathbf{k})\n$$\nThe problem specifies the cross-power spectral density as:\n$$\nC_{n b}(\\mathbf{k}) = \\mathcal{N}_0 \\mathcal{B}_0 \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big)\\exp\\!\\big(i(\\phi_n-\\phi_b)\\big)\n$$\nThe physical particle flux, being a measurable quantity, must be a real number. The expression for $C_{nb}(\\mathbf{k})$ is complex. In quasilinear theory, when correlations are computed using complex wave representations, the physical result for a quadratic quantity like flux is obtained by taking the real part. Therefore, we compute:\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\text{Re} \\left( v_{\\parallel s} \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{nb}(\\mathbf{k}) \\right)\n$$\nLet's substitute the expression for $C_{nb}(\\mathbf{k})$ and evaluate the integral. Let $\\Delta\\phi = \\phi_n - \\phi_b$.\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s}\\, \\text{Re} \\left[ \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2} \\mathcal{N}_0 \\mathcal{B}_0 \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big)\\exp(i\\Delta\\phi) \\right]\n$$\nThe terms that do not depend on $\\mathbf{k}$ can be moved outside the integral:\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s}\\, \\frac{\\mathcal{N}_0 \\mathcal{B}_0}{(2\\pi)^2} \\text{Re} \\left[ \\exp(i\\Delta\\phi) \\int d^2\\mathbf{k} \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big) \\right]\n$$\nThe integral is a standard two-dimensional Gaussian integral. We can solve it by switching to polar coordinates in $\\mathbf{k}$-space, where $\\mathbf{k}=(k\\cos\\theta, k\\sin\\theta)$, $|\\mathbf{k}|=k$, and the area element is $d^2\\mathbf{k} = k\\,dk\\,d\\theta$.\n$$\n\\int d^2\\mathbf{k} \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big) = \\int_0^{2\\pi} d\\theta \\int_0^\\infty dk\\, k\\, \\exp\\!\\Big(-\\frac{k^2}{\\sigma^2}\\Big)\n$$\nThe integral over $\\theta$ gives a factor of $2\\pi$. For the radial integral, we use the substitution $u=k^2/\\sigma^2$, which implies $du = (2k/\\sigma^2)dk$, or $k\\,dk = (\\sigma^2/2)du$.\n$$\n\\int_0^\\infty dk\\, k\\, \\exp\\!\\Big(-\\frac{k^2}{\\sigma^2}\\Big) = \\int_0^\\infty \\frac{\\sigma^2}{2} du\\, \\exp(-u) = \\frac{\\sigma^2}{2} [-\\exp(-u)]_0^\\infty = \\frac{\\sigma^2}{2} (0 - (-1)) = \\frac{\\sigma^2}{2}\n$$\nSo, the total value of the 2D integral is:\n$$\n\\int d^2\\mathbf{k} \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big) = 2\\pi \\times \\frac{\\sigma^2}{2} = \\pi\\sigma^2\n$$\nSubstituting this result back into the expression for the flux:\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s}\\, \\frac{\\mathcal{N}_0 \\mathcal{B}_0}{(2\\pi)^2} \\text{Re} \\left[ \\exp(i\\Delta\\phi) (\\pi\\sigma^2) \\right] = v_{\\parallel s}\\, \\frac{\\mathcal{N}_0 \\mathcal{B}_0 \\pi\\sigma^2}{4\\pi^2} \\text{Re} [\\exp(i\\Delta\\phi)]\n$$\nSimplifying the expression and using Euler's formula, $\\exp(i\\Delta\\phi) = \\cos(\\Delta\\phi) + i\\sin(\\Delta\\phi)$:\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\frac{v_{\\parallel s} \\mathcal{N}_0 \\mathcal{B}_0 \\sigma^2}{4\\pi} \\text{Re}[\\cos(\\Delta\\phi) + i\\sin(\\Delta\\phi)]\n$$\nThe real part is simply $\\cos(\\Delta\\phi)$. The final closed-form expression for the flux is:\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\frac{v_{\\parallel s} \\mathcal{N}_0 \\mathcal{B}_0 \\sigma^2}{4\\pi} \\cos(\\phi_n - \\phi_b)\n$$\nNext, we must identify the phase relations that maximize and minimize this flux. The parameters $v_{\\parallel s}$, $\\mathcal{N}_0$, $\\mathcal{B}_0$, and $\\sigma$ are all positive constants. Therefore, the flux is maximized or minimized based on the value of the term $\\cos(\\phi_n - \\phi_b)$.\n\nThe flux $\\Gamma^{\\mathrm{fl}}_s$ is maximized when $\\cos(\\phi_n - \\phi_b)$ is maximum. The maximum value of the cosine function is $1$. This occurs when the phase difference is an even multiple of $\\pi$:\n$$\n\\phi_n - \\phi_b = 2m\\pi, \\quad \\text{for any integer } m\n$$\nThis corresponds to the density and magnetic fluctuations being in-phase. The simplest case is a phase difference of $0$ radians.\n\nThe flux $\\Gamma^{\\mathrm{fl}}_s$ is minimized when $\\cos(\\phi_n - \\phi_b)$ is minimum. The minimum value of the cosine function is $-1$. This occurs when the phase difference is an odd multiple of $\\pi$:\n$$\n\\phi_n - \\phi_b = (2m+1)\\pi, \\quad \\text{for any integer } m\n$$\nThis corresponds to the density and magnetic fluctuations being out-of-phase. The simplest case is a phase difference of $\\pi$ radians. The minimum flux is negative, indicating an inward particle flux (a pinch). If the question is about the magnitude of the flux, the minimum magnitude is zero, which occurs when $\\cos(\\phi_n - \\phi_b)=0$, i.e., $\\phi_n - \\phi_b = (m+1/2)\\pi$. However, minimizing the algebraic value of the flux is the standard interpretation.",
            "answer": "$$\n\\boxed{\\pmatrix{ \\frac{v_{\\parallel s} \\mathcal{N}_0 \\mathcal{B}_0 \\sigma^2}{4\\pi} \\cos(\\phi_n - \\phi_b)  0  \\pi }}\n$$"
        },
        {
            "introduction": "To build physical intuition beyond formal calculations, this problem employs a simplified random-walk model for particle transport in a stochastic magnetic field . By deriving the thermal and momentum diffusivities, you will calculate the flutter-driven Prandtl number, revealing why magnetic flutter is inherently more efficient at transporting electron heat than ion momentum. This exercise demonstrates the power of simple physical models in uncovering key scaling relationships.",
            "id": "4195005",
            "problem": "Consider a large-aspect-ratio tokamak core plasma with magnetic field $\\mathbf{B} = B_{0}\\,\\mathbf{b} + \\delta \\mathbf{B}_{\\perp}$, where $|\\delta \\mathbf{B}_{\\perp}| \\ll B_{0}$ and $\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$. Assume magnetic field lines are stochastic with a parallel correlation length $L_{c}$, and that particles stream freely along $\\mathbf{b}$ on timescales shorter than the field-line decorrelation time. Take a simple, first-principles random-walk model in which the guiding-center displacement across flux surfaces arises from following the perturbed field lines over successive parallel correlation lengths.\n\nStarting from the guiding-center equation of motion along the magnetic field and the definition of a random-walk cross-field diffusivity, derive a parametric expression for the flutter-driven electron thermal diffusivity $\\chi_{e}^{\\mathrm{fl}}$ and for the flutter-driven ion momentum diffusivity (effective viscosity) $\\nu_{i}^{\\mathrm{fl}}$ in terms of the parallel streaming speed, $L_{c}$, and the amplitude ratio $|\\delta \\mathbf{B}_{\\perp}|/B_{0}$. Then, using these expressions, compute the effective Prandtl number $Pr^{\\mathrm{fl}}$, defined as the ratio of the flutter-driven momentum diffusivity to the flutter-driven thermal diffusivity. Assume that the electrons carry the thermal transport and the ions carry the momentum transport in this mechanism, with species thermal speeds $v_{t s} = \\sqrt{2 T_{s} / m_{s}}$, where $s \\in \\{e,i\\}$ denotes species, $T_{s}$ is the species temperature, and $m_{s}$ is the species mass.\n\nUse the following parameters to obtain a numerical value: the electron mass is $m_{e} = 9.11 \\times 10^{-31}\\,\\mathrm{kg}$, the proton mass is $m_{p} = 1.67 \\times 10^{-27}\\,\\mathrm{kg}$, the ion species is deuterium with $m_{i} = 2 m_{p}$, and the temperatures satisfy $T_{e} = T_{i}$. You may take $B_{0} = 3\\,\\mathrm{T}$, $|\\delta \\mathbf{B}_{\\perp}|/B_{0} = 1.0 \\times 10^{-3}$, and $L_{c} = 2.0\\,\\mathrm{m}$ for physical context, but note that your final expression for $Pr^{\\mathrm{fl}}$ should reveal any parameter cancellation that occurs.\n\nRound your final numerical answer for $Pr^{\\mathrm{fl}}$ to three significant figures. Express the answer as a pure number (dimensionless). In your derivation, briefly interpret the physical implications of the magnitude of $Pr^{\\mathrmfl}}$ in terms of the relative efficiency of flutter-driven transport of heat versus momentum.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of plasma physics and transport theory, specifically the Rechester-Rosenbluth model for stochastic magnetic field transport. The problem is well-posed, objective, and contains all necessary information for a unique solution without any internal contradictions or reliance on implausible assumptions.\n\nWe begin by deriving a general expression for the cross-field diffusivity based on a random-walk model. The diffusivity $D$ can be modeled as $D \\approx (\\Delta r)^2 / \\Delta t$, where $\\Delta r$ is the characteristic radial step size and $\\Delta t$ is the characteristic time for that step.\n\nIn the model of magnetic flutter transport, a particle's guiding-center follows a stochastic magnetic field line. The radial displacement is due to the perturbed field component, $\\delta \\mathbf{B}_{\\perp}$. The trajectory of a field line is described by $d\\mathbf{x} = \\mathbf{b} \\, ds$, where $ds$ is the element of arc length along the field line. In a cylindrical approximation, the radial component is $dr = b_r \\, ds$, where $b_r = \\delta B_r / |\\mathbf{B}| \\approx \\delta B_r / B_0$. Over a parallel correlation length $L_c$, the field line diffuses radially. The characteristic radial step size $\\Delta r$ taken by a particle following the field line for a distance $L_c$ is:\n$$ \\Delta r \\approx \\left| \\frac{\\delta \\mathbf{B}_{\\perp}}{B_0} \\right| L_c $$\nThe notation $|\\delta \\mathbf{B}_{\\perp}|/B_0$ represents the magnitude of the normalized radial magnetic field fluctuation.\n\nThe time $\\Delta t$ required for a particle of species $s$ to traverse this parallel correlation length $L_c$ is determined by its characteristic parallel streaming speed, $v_{\\parallel, s}$.\n$$ \\Delta t = \\frac{L_c}{v_{\\parallel, s}} $$\nSubstituting these expressions for $\\Delta r$ and $\\Delta t$ into the random-walk diffusivity formula gives a species-dependent diffusivity $D_s$:\n$$ D_s \\approx \\frac{(\\Delta r)^2}{\\Delta t} = \\frac{\\left( \\left| \\frac{\\delta \\mathbf{B}_{\\perp}}{B_0} \\right| L_c \\right)^2}{L_c / v_{\\parallel, s}} = v_{\\parallel, s} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 $$\n\nNow, we apply this general formula to the specific transport channels mentioned.\n\nFirst, we find the electron thermal diffusivity, $\\chi_{e}^{\\mathrm{fl}}$. The problem states that electrons carry the thermal transport. The characteristic parallel speed for thermal electrons is their thermal speed, $v_{te}$. Using the given definition $v_{ts} = \\sqrt{2T_s/m_s}$, we have $v_{\\parallel, e} \\approx v_{te} = \\sqrt{2T_e/m_e}$.\nSubstituting this into the general diffusivity expression:\n$$ \\chi_{e}^{\\mathrm{fl}} \\approx v_{te} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 = \\sqrt{\\frac{2T_e}{m_e}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 $$\n\nSecond, we find the ion momentum diffusivity (effective viscosity), $\\nu_{i}^{\\mathrm{fl}}$. The problem states that ions carry the momentum transport. The characteristic parallel speed for ions is their thermal speed, $v_{ti} = \\sqrt{2T_i/m_i}$.\nSubstituting this into the general diffusivity expression:\n$$ \\nu_{i}^{\\mathrm{fl}} \\approx v_{ti} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 = \\sqrt{\\frac{2T_i}{m_i}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 $$\n\nThe problem asks for the effective Prandtl number, $Pr^{\\mathrm{fl}}$, defined as the ratio of these two diffusivities:\n$$ Pr^{\\mathrm{fl}} = \\frac{\\nu_{i}^{\\mathrm{fl}}}{\\chi_{e}^{\\mathrm{fl}}} $$\nSubstituting the derived expressions:\n$$ Pr^{\\mathrm{fl}} = \\frac{\\sqrt{\\frac{2T_i}{m_i}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2}{\\sqrt{\\frac{2T_e}{m_e}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2} $$\nThe terms $L_c$ and $(|\\delta \\mathbf{B}_{\\perp}|/B_0)^2$ cancel, demonstrating that the Prandtl number in this model depends only on the properties of the particle species carrying the transport.\n$$ Pr^{\\mathrm{fl}} = \\frac{\\sqrt{2T_i/m_i}}{\\sqrt{2T_e/m_e}} = \\sqrt{\\frac{T_i}{T_e} \\frac{m_e}{m_i}} $$\nThis is the parametric expression for the flutter-driven Prandtl number.\n\nTo compute the numerical value, we use the given parameters: $T_e = T_i$, electron mass $m_e = 9.11 \\times 10^{-31}\\,\\mathrm{kg}$, and ion mass $m_i$ for deuterium, which is twice the proton mass $m_p = 1.67 \\times 10^{-27}\\,\\mathrm{kg}$.\nSince $T_e = T_i$, the temperature ratio $T_i/T_e = 1$. The expression simplifies to:\n$$ Pr^{\\mathrm{fl}} = \\sqrt{\\frac{m_e}{m_i}} $$\nThe ion mass is $m_i = 2 m_p = 2 \\times (1.67 \\times 10^{-27}\\,\\mathrm{kg}) = 3.34 \\times 10^{-27}\\,\\mathrm{kg}$.\nSubstituting the numerical values for the masses:\n$$ Pr^{\\mathrm{fl}} = \\sqrt{\\frac{9.11 \\times 10^{-31}\\,\\mathrm{kg}}{3.34 \\times 10^{-27}\\,\\mathrm{kg}}} = \\sqrt{\\frac{9.11}{3.34} \\times 10^{-4}} \\approx \\sqrt{2.7275 \\times 10^{-4}} $$\n$$ Pr^{\\mathrm{fl}} \\approx 1.6515 \\times 10^{-2} \\approx 0.016515 $$\nRounding to three significant figures, we get $0.0165$.\n\nThe physical implication of the result $Pr^{\\mathrm{fl}} \\approx 0.0165 \\ll 1$ is that magnetic flutter is a far more efficient mechanism for transporting electron heat than for transporting ion momentum. The transport rate is directly proportional to the parallel streaming speed of the species carrying the respective quantity (heat by electrons, momentum by ions). Since electrons are much lighter than ions, their thermal speed is significantly higher for the same temperature ($v_{te} \\gg v_{ti}$). Consequently, electron heat is transported radially much faster than ion momentum, leading to a very small Prandtl number. This is a characteristic feature of transport driven by parallel electron dynamics in stochastic magnetic fields.",
            "answer": "$$\n\\boxed{0.0165}\n$$"
        },
        {
            "introduction": "Bridging the gap between analytic theory and computational practice is a crucial skill in modern plasma physics. This hands-on coding exercise guides you through reconstructing a divergence-free magnetic field from its parallel vector potential, a standard technique in turbulence simulations . By implementing this on a discrete grid, you will verify a key numerical property and compute a physically relevant diagnostic.",
            "id": "4195006",
            "problem": "You are given a grid-resolved scalar field representing the parallel component of a perturbed vector potential, denoted by $\\delta A_{\\parallel}(x,y,z)$, defined on a uniform, periodic, Cartesian grid in the slab geometry with coordinates $(x,y,z)$. The background magnetic-field unit vector is taken to be constant and aligned with the $z$ axis, $\\mathbf{b}_0 = \\hat{\\mathbf{z}}$, and the constant background magnetic-field magnitude is $B_0$. The goal is to reconstruct a solenoidal perturbed magnetic field $\\delta \\mathbf{B}$ from $\\delta A_{\\parallel}$ via a vector-potential curl and to compute the radial component of the perturbed field-line unit-vector fluctuation, $\\delta b_r$, under the slab identification of the radial direction with $x$. All quantities are nondimensional.\n\nUse the following fundamental base:\n- Maxwellâ€™s equation requires $\\nabla \\cdot \\mathbf{B} = 0$ for any magnetic field $\\mathbf{B}$.\n- Any magnetic field can be expressed as the curl of a vector potential: $\\mathbf{B} = \\nabla \\times \\mathbf{A}$.\n- In reduced descriptions appropriate for strong guide fields, the perturbed magnetic field can be reconstructed from the parallel component of the vector potential as $\\delta \\mathbf{B} = \\nabla \\times \\left(\\delta A_{\\parallel}\\,\\mathbf{b}_0\\right)$.\n- The perturbed field-line unit-vector fluctuation is $\\delta \\mathbf{b} \\approx \\delta \\mathbf{B}_{\\perp}/B_0$ for small perturbations, so the radial component is $\\delta b_r = \\delta B_x / B_0$ in slab geometry where $r \\equiv x$.\n\nYou must implement a discrete, numerically solenoidal reconstruction using centered finite differences with periodic boundary conditions so that $\\nabla \\cdot \\delta \\mathbf{B} = 0$ is enforced to numerical precision at the discrete level. To do this, define the discrete centered finite-difference derivative operator along each coordinate with grid spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$:\n- $D_x f_{i,j,k} = \\left(f_{i+1,j,k} - f_{i-1,j,k}\\right) / \\left(2\\,\\Delta x\\right)$ with periodic wrap in index $i$,\n- $D_y f_{i,j,k} = \\left(f_{i,j+1,k} - f_{i,j-1,k}\\right) / \\left(2\\,\\Delta y\\right)$ with periodic wrap in index $j$,\n- $D_z f_{i,j,k} = \\left(f_{i,j,k+1} - f_{i,j,k-1}\\right) / \\left(2\\,\\Delta z\\right)$ with periodic wrap in index $k$.\n\nWith $\\mathbf{b}_0 = \\hat{\\mathbf{z}}$, reconstruct the discrete perturbed magnetic-field components from $\\delta A_{\\parallel}$ by the discrete curl of $\\delta A_{\\parallel}\\,\\hat{\\mathbf{z}}$:\n- $\\delta B_x = D_y \\delta A_{\\parallel}$,\n- $\\delta B_y = -\\,D_x \\delta A_{\\parallel}$,\n- $\\delta B_z = 0$.\n\nNext, compute the discrete divergence using the same centered operators:\n- $\\nabla \\cdot \\delta \\mathbf{B} = D_x \\delta B_x + D_y \\delta B_y + D_z \\delta B_z$.\n\nFinally, compute the perturbation of the radial component of the field-line unit vector,\n- $\\delta b_r = \\delta B_x / B_0$.\n\nYour program must implement the above using the following test suite of four cases. The computational domain is periodic in all directions with lengths $L_x = 2\\pi$, $L_y = 2\\pi$, and $L_z = 2\\pi$, discretized on a uniform grid. Use integer grid sizes $N_x$, $N_y$, and $N_z$ as specified below, and define grid spacings $\\Delta x = L_x/N_x$, $\\Delta y = L_y/N_y$, and $\\Delta z = L_z/N_z$. For all cases use $N_x = 64$, $N_y = 64$, and $N_z = 1$.\n\nFor each case, compute two scalar diagnostics:\n- the maximum absolute value of the discrete divergence, $\\max_{i,j,k}\\left|\\nabla \\cdot \\delta \\mathbf{B}\\right|$, and\n- the root-mean-square value of $\\delta b_r$, i.e., $\\sqrt{\\langle \\delta b_r^2 \\rangle}$, where the angle brackets denote the volume average over the grid.\n\nTest cases:\n- Case $1$: Constant field. Let $\\delta A_{\\parallel}(x,y,z) = c$ with $c = 1.234$ and $B_0 = 1.0$.\n- Case $2$: Single Fourier mode. Let $\\delta A_{\\parallel}(x,y,z) = a \\cos\\left(m x\\right)\\,\\sin\\left(n y\\right)$ with $a = 0.2$, $m = 3$, $n = 5$, and $B_0 = 2.0$.\n- Case $3$: High-wavenumber mode near the resolution limit. Let $\\delta A_{\\parallel}(x,y,z) = a \\cos\\left(m x\\right)\\,\\cos\\left(n y\\right)$ with $a = 0.01$, $m = 31$, $n = 30$, and $B_0 = 1.3$.\n- Case $4$: Random field with a fixed seed. Let $\\delta A_{\\parallel}(x,y,z)$ be independent identically distributed samples from a uniform distribution on $\\left[-\\tfrac{1}{2}, \\tfrac{1}{2}\\right]$ scaled by $a = 0.1$, using a fixed random-number generator seed of $7$, and $B_0 = 0.8$.\n\nYour program must:\n- construct the grid and fields as described,\n- compute $\\delta \\mathbf{B}$, the discrete divergence, and $\\delta b_r$ using the centered periodic finite differences above,\n- return, for each case, the two diagnostics in the order specified.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n- $\\left[\\mathrm{div}^{(1)}_{\\max}, \\mathrm{rms}^{(1)}_{\\delta b_r}, \\mathrm{div}^{(2)}_{\\max}, \\mathrm{rms}^{(2)}_{\\delta b_r}, \\mathrm{div}^{(3)}_{\\max}, \\mathrm{rms}^{(3)}_{\\delta b_r}, \\mathrm{div}^{(4)}_{\\max}, \\mathrm{rms}^{(4)}_{\\delta b_r}\\right]$,\nwhere $\\mathrm{div}^{(i)}_{\\max}$ denotes the maximum absolute divergence in case $i$, and $\\mathrm{rms}^{(i)}_{\\delta b_r}$ denotes the root-mean-square of $\\delta b_r$ in case $i$. Each entry must be a floating-point number. No physical units are required; all quantities are nondimensional. Angles used in trigonometric functions are in radians. Percentages are not used anywhere; all scalar outputs are dimensionless floats.",
            "solution": "The user has provided a problem that requires the numerical implementation of a standard procedure in plasma physics simulation: the reconstruction of a perturbed magnetic field from its parallel vector potential and the subsequent calculation of related diagnostic quantities.\n\n### Problem Validation\n\nFirst, a critical validation of the problem statement is performed as per the specified protocol.\n\n**Step 1: Extraction of Givens**\n- **Input Field:** A scalar field $\\delta A_{\\parallel}(x,y,z)$ on a uniform, periodic, Cartesian grid.\n- **Geometry  Coordinates:** Slab geometry with coordinates $(x,y,z)$.\n- **Background Field:** Constant background magnetic field $\\mathbf{b}_0 = \\hat{\\mathbf{z}}$ with magnitude $B_0$.\n- **Objective:** Reconstruct the perturbed magnetic field $\\delta \\mathbf{B}$ and compute the radial component of the perturbed field-line unit vector, $\\delta b_r$.\n- **Slab Mapping:** Radial coordinate $r$ is identified with $x$.\n- **Governing Relations:**\n    - $\\delta \\mathbf{B} = \\nabla \\times \\left(\\delta A_{\\parallel}\\,\\mathbf{b}_0\\right) = (\\partial_y \\delta A_{\\parallel}) \\hat{\\mathbf{x}} - (\\partial_x \\delta A_{\\parallel}) \\hat{\\mathbf{y}}$.\n    - $\\nabla \\cdot \\delta \\mathbf{B} = 0$ (analytically).\n    - $\\delta b_r = \\delta B_x / B_0$.\n- **Numerical Scheme:** Centered finite differences on a periodic grid.\n    - $D_c f_{i} = (f_{i+1} - f_{i-1}) / (2\\Delta c)$ for $c \\in \\{x,y,z\\}$.\n    - Discrete fields: $\\delta B_x = D_y \\delta A_{\\parallel}$, $\\delta B_y = -D_x \\delta A_{\\parallel}$, $\\delta B_z = 0$.\n    - Discrete divergence: $\\nabla \\cdot \\delta \\mathbf{B} = D_x \\delta B_x + D_y \\delta B_y + D_z \\delta B_z$.\n- **Domain  Grid:** $L_x=2\\pi$, $L_y=2\\pi$, $L_z=2\\pi$; $N_x=64$, $N_y=64$, $N_z=1$. Grid spacings $\\Delta c = L_c/N_c$.\n- **Diagnostics:**\n    - $\\max_{i,j,k}\\left|\\nabla \\cdot \\delta \\mathbf{B}\\right|$.\n    - $\\sqrt{\\langle \\delta b_r^2 \\rangle}$ (Root-Mean-Square).\n- **Test Cases:**\n    - Case $1$: $\\delta A_{\\parallel} = 1.234$, $B_0 = 1.0$.\n    - Case $2$: $\\delta A_{\\parallel} = 0.2 \\cos(3x)\\sin(5y)$, $B_0 = 2.0$.\n    - Case $3$: $\\delta A_{\\parallel} = 0.01 \\cos(31x)\\cos(30y)$, $B_0 = 1.3$.\n    - Case $4$: $\\delta A_{\\parallel} = 0.1 \\times \\mathcal{U}[-0.5, 0.5]$ (random, seed=$7$), $B_0 = 0.8$.\n\n**Step 2: Validation of Givens**\n- **Scientific Grounding:** The problem is based on a standard reduced model used in plasma physics for describing magnetic perturbations in a strong guide field. The relations $\\delta \\mathbf{B} = \\nabla \\times (\\delta A_\\parallel \\mathbf{b}_0)$ and $\\delta b_r = \\delta B_x / B_0$ are fundamental to the theory of magnetic flutter and electromagnetic turbulence. The premise is scientifically sound.\n- **Well-Posedness:** The problem is well-posed. The numerical procedure is deterministic and involves standard, stable numerical methods (centered differences). For each specified input case, a unique, computable solution exists.\n- **Objectivity:** The problem is stated in precise mathematical and computational terms, free of ambiguity or subjectivity.\n- **Completeness:** All necessary parameters, equations, boundary conditions (periodicity), and numerical methods are explicitly defined.\n- **Consistency:** The definitions are internally consistent. The use of $N_z=1$ correctly reduces the $3$D formalism to an effectively $2$D problem ($\\partial/\\partial z \\to 0$), which is a common setup in simulations. The core scientific point, testing the \"numerically solenoidal\" property of the scheme, is a valid and important concept in computational magnetohydrodynamics.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is **valid**.\n- **Action:** Proceed with providing a complete solution.\n\n### Solution\n\nThe objective is to compute two diagnostic quantities for four different forms of a perturbed parallel vector potential, $\\delta A_{\\parallel}$. This requires implementing a specific numerical algorithm on a $2$D periodic grid, as the grid size in the $z$-direction is $N_z=1$.\n\n**Theoretical and Numerical Framework**\n\nThe perturbed magnetic field, $\\delta \\mathbf{B}$, is derived from the parallel vector potential $\\delta A_{\\parallel}$ in a reduced model valid for a strong guide magnetic field $\\mathbf{B}_0 = B_0 \\mathbf{b}_0$. With the guide field aligned with the $z$-axis, $\\mathbf{b}_0 = \\hat{\\mathbf{z}}$, the vector potential is $\\mathbf{A} = \\delta A_{\\parallel} \\hat{\\mathbf{z}}$. The perturbed magnetic field is given by its curl:\n$$\n\\delta \\mathbf{B} = \\nabla \\times \\mathbf{A} = \\nabla \\times (\\delta A_{\\parallel} \\hat{\\mathbf{z}}) = \\left| \\begin{array}{ccc} \\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\ \\partial_x  \\partial_y  \\partial_z \\\\ 0  0  \\delta A_{\\parallel} \\end{array} \\right| = \\frac{\\partial (\\delta A_{\\parallel})}{\\partial y} \\hat{\\mathbf{x}} - \\frac{\\partial (\\delta A_{\\parallel})}{\\partial x} \\hat{\\mathbf{y}}\n$$\nThe components are $\\delta B_x = \\partial_y \\delta A_{\\parallel}$, $\\delta B_y = - \\partial_x \\delta A_{\\parallel}$, and $\\delta B_z = 0$. A key property of any field derived from a curl is that its divergence is zero: $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$. For our specific form:\n$$\n\\nabla \\cdot \\delta \\mathbf{B} = \\frac{\\partial (\\delta B_x)}{\\partial x} + \\frac{\\partial (\\delta B_y)}{\\partial y} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial (\\delta A_{\\parallel})}{\\partial y} \\right) - \\frac{\\partial}{\\partial y} \\left( \\frac{\\partial (\\delta A_{\\parallel})}{\\partial x} \\right) = \\frac{\\partial^2 (\\delta A_{\\parallel})}{\\partial x \\partial y} - \\frac{\\partial^2 (\\delta A_{\\parallel})}{\\partial y \\partial x} = 0\n$$\nThis is zero by the equality of mixed partial derivatives (Clairaut's theorem), assuming $\\delta A_{\\parallel}$ is sufficiently smooth.\n\n**Discretization**\n\nWe discretize this system on a uniform Cartesian grid $(x_i, y_j)$ with $i \\in \\{0, ..., N_x-1\\}$ and $j \\in \\{0, ..., N_y-1\\}$. The domain is periodic with lengths $L_x=2\\pi$ and $L_y=2\\pi$. The grid spacings are $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$.\n\nThe partial derivatives are approximated by second-order centered finite-difference operators, $D_x$ and $D_y$, with periodic boundary conditions:\n$$\n(D_x f)_{i,j} = \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x} \\quad , \\quad (D_y f)_{i,j} = \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y}\n$$\nThe indices are evaluated modulo their respective grid sizes ($i+1 \\pmod{N_x}$, etc.). The discrete magnetic field components are:\n$$\n(\\delta B_x)_{i,j} = (D_y \\delta A_{\\parallel})_{i,j} \\quad , \\quad (\\delta B_y)_{i,j} = -(D_x \\delta A_{\\parallel})_{i,j}\n$$\nThe discrete divergence is then computed using the same operators:\n$$\n(\\nabla \\cdot \\delta\\mathbf{B})_{i,j} = (D_x \\delta B_x)_{i,j} + (D_y \\delta B_y)_{i,j} = (D_x D_y \\delta A_{\\parallel})_{i,j} - (D_y D_x \\delta A_{\\parallel})_{i,j}\n$$\nA crucial property of these discrete operators on a periodic grid is that they commute: $D_x D_y = D_y D_x$. This can be seen by writing out the stencil for the combined operator $(D_x D_y f)_{i,j}$, which expands to terms like $f_{i+1,j+1}$, $f_{i-1,j+1}$, etc., symmetrically. Consequently, the discrete divergence is guaranteed to be zero to machine precision:\n$$\n(D_x D_y - D_y D_x) \\delta A_{\\parallel} = 0\n$$\nThis property makes the scheme \"numerically solenoidal\" or \"divergence-free by construction,\" which is a highly desirable feature in numerical simulations of magnetic fields. One of the diagnostics, $\\max|\\nabla \\cdot \\delta\\mathbf{B}|$, directly tests this property. We expect it to be a very small number, on the order of floating-point round-off error.\n\n**Diagnostic Calculation**\n\n1.  **Maximum Absolute Divergence:** This is computed by taking the maximum absolute value of the computed $(\\nabla \\cdot \\delta\\mathbf{B})_{i,j}$ array over all grid points $(i,j)$.\n    $$\n    \\mathrm{div}_{\\max} = \\max_{i,j} |(\\nabla \\cdot \\delta\\mathbf{B})_{i,j}|\n    $$\n2.  **RMS of $\\delta b_r$:** The radial component of the field-line unit vector fluctuation is given by $\\delta b_r = \\delta B_x / B_0$. Its root-mean-square (RMS) value is calculated by averaging its square over the entire grid (volume) and taking the square root. For a discrete field $g_{i,j}$ on an $N_x \\times N_y$ grid, the volume average is $\\langle g \\rangle = \\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} g_{i,j}$.\n    $$\n    \\mathrm{rms}_{\\delta b_r} = \\sqrt{\\langle (\\delta b_r)^2 \\rangle} = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i,j} \\left( \\frac{(\\delta B_x)_{i,j}}{B_0} \\right)^2}\n    $$\n\n**Implementation Plan**\n\nA Python function will be implemented to handle the calculation for each test case.\n1.  Define grid parameters: $L_x=2\\pi, L_y=2\\pi, N_x=64, N_y=64$.\n2.  Construct the coordinate arrays $x$ and $y$ and a $2$D meshgrid.\n3.  For each case, construct the $2$D array for $\\delta A_{\\parallel}(x,y)$.\n4.  Implement the centered difference operators $D_x$ and $D_y$ using `numpy.roll` for efficient periodic shifting.\n5.  Compute the arrays for $\\delta B_x = D_y \\delta A_{\\parallel}$ and $\\delta B_y = -D_x \\delta A_{\\parallel}$.\n6.  Compute the divergence array $\\nabla \\cdot \\delta \\mathbf{B} = D_x \\delta B_x + D_y \\delta B_y$.\n7.  Calculate $\\mathrm{div}_{\\max}$ from the divergence array.\n8.  Calculate the $\\delta b_r$ array and then its RMS value, $\\mathrm{rms}_{\\delta b_r}$.\n9.  Store both diagnostics for each case and format the final output as a single comma-separated string.\nFor Case $4$, a random number generator with a fixed seed of $7$ is used to ensure reproducibility.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It orchestrates the calculation of diagnostics for each case and prints the final result.\n    \"\"\"\n\n    # Global parameters for all cases\n    Nx, Ny, Nz = 64, 64, 1\n    Lx, Ly, Lz = 2 * np.pi, 2 * np.pi, 2 * np.pi\n    \n    # Define the 4 test cases as specified in the problem statement\n    test_cases = [\n        {'id': 1, 'type': 'constant', 'params': {'c': 1.234, 'B0': 1.0}},\n        {'id': 2, 'type': 'single_mode', 'params': {'a': 0.2, 'm': 3, 'n': 5, 'B0': 2.0}},\n        {'id': 3, 'type': 'high_k_mode', 'params': {'a': 0.01, 'm': 31, 'n': 30, 'B0': 1.3}},\n        {'id': 4, 'type': 'random', 'params': {'a': 0.1, 'seed': 7, 'B0': 0.8}},\n    ]\n\n    results = []\n    for case in test_cases:\n        diagnostics = compute_diagnostics(case, Nx, Ny, Lx, Ly)\n        results.extend(diagnostics)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_diagnostics(case, Nx, Ny, Lx, Ly):\n    \"\"\"\n    Computes the required diagnostics for a single test case.\n\n    Args:\n        case (dict): A dictionary containing the parameters for the test case.\n        Nx, Ny (int): Grid dimensions.\n        Lx, Ly (float): Domain sizes.\n\n    Returns:\n        tuple: A tuple containing (max_abs_div, rms_delta_br).\n    \"\"\"\n\n    # 1. Construct grid and delta_A_parallel field\n    dx, dy = Lx / Nx, Ly / Ny\n    \n    # Create coordinate arrays. endpoint=False is crucial for periodic domains.\n    x = np.linspace(0, Lx, Nx, endpoint=False)\n    y = np.linspace(0, Ly, Ny, endpoint=False)\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    params = case['params']\n    if case['type'] == 'constant':\n        delta_A_parallel = np.full((Nx, Ny), params['c'])\n    elif case['type'] == 'single_mode':\n        a, m, n = params['a'], params['m'], params['n']\n        delta_A_parallel = a * np.cos(m * xx) * np.sin(n * yy)\n    elif case['type'] == 'high_k_mode':\n        a, m, n = params['a'], params['m'], params['n']\n        delta_A_parallel = a * np.cos(m * xx) * np.cos(n * yy)\n    elif case['type'] == 'random':\n        rng = np.random.default_rng(params['seed'])\n        # Samples from U[-0.5, 0.5] scaled by 'a'\n        delta_A_parallel = params['a'] * (rng.random((Nx, Ny)) - 0.5)\n    \n    B0 = params['B0']\n\n    # 2. Implement centered finite difference operators using np.roll for periodicity\n    def d_dx(f):\n        return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * dx)\n\n    def d_dy(f):\n        return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * dy)\n\n    # 3. Compute perturbed magnetic field components\n    delta_Bx = d_dy(delta_A_parallel)\n    delta_By = -d_dx(delta_A_parallel)\n\n    # 4. Compute discrete divergence\n    # This should be zero to machine precision, which we will verify.\n    div_B = d_dx(delta_Bx) + d_dy(delta_By)\n\n    # 5. Compute diagnostics\n    # Diagnostic 1: Maximum absolute value of the discrete divergence\n    max_abs_div = np.max(np.abs(div_B))\n\n    # Diagnostic 2: Root-mean-square of delta_br\n    delta_br = delta_Bx / B0\n    rms_delta_br = np.sqrt(np.mean(delta_br**2))\n    \n    return (max_abs_div, rms_delta_br)\n\nsolve()\n```"
        }
    ]
}