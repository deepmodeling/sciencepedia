{
    "hands_on_practices": [
        {
            "introduction": "This first practice confronts a central question: why are local, flux-tube models sometimes insufficient? We will explore this by using a simplified reaction-diffusion model that captures the essence of radially coupled turbulence. By solving this model, you will quantify the error made by a local approximation and uncover a powerful analogy between plasma turbulence spreading and the quantum harmonic oscillator, revealing how nonlocal effects modify the system's fundamental growth rate.",
            "id": "4203670",
            "problem": "In global fusion plasma turbulence simulations, the turbulence intensity $I(r,t)$ can vary across the minor radius $r$ and is coupled radially through cross-field mixing. Consider a reduced one-dimensional reaction-diffusion model for the global intensity dynamics in a tokamak-like device near a reference radius $r_0$, given by\n$$\n\\frac{\\partial I(r,t)}{\\partial t} \\;=\\; D\\,\\frac{\\partial^2 I(r,t)}{\\partial r^2} \\;+\\; \\gamma(r)\\,I(r,t),\n$$\nwhere $D$ is a constant effective radial diffusivity and $\\gamma(r)$ is the local linear growth rate. Assume a peaked growth-rate profile\n$$\n\\gamma(r) \\;=\\; \\gamma_0 \\;-\\; \\alpha\\,(r-r_0)^2,\n$$\nwith $\\gamma_0 > 0$ and $\\alpha > 0$, and that the region of interest is sufficiently far from boundaries to neglect boundary effects (i.e., the radial domain can be treated as the entire real line around $r_0$). The local flux-tube approximation ignores radial coupling and uses the local value $r=r_0$ to predict an exponential growth $\\sim \\exp(\\gamma_0 t)$.\n\nStarting from the reaction-diffusion model above and first principles of linear stability and spectral analysis, derive the principal exponential growth rate of the global model and quantify the absolute error incurred by replacing the global model with the local flux-tube approximation at $r_0$. Define the error as the difference between the local predicted growth rate and the principal global growth rate. Then, for the parameters $D = 5.0 \\times 10^{-1}$ $\\text{m}^2\\,\\text{s}^{-1}$ and $\\alpha = 1.0 \\times 10^{10}$ $\\text{s}^{-1}\\,\\text{m}^{-2}$, compute the numerical value of this error.\n\nRound your final numerical answer to four significant figures and express it in $\\text{s}^{-1}$. The final answer must be a single real-valued number.",
            "solution": "The problem asks for the principal exponential growth rate of the global model and the error compared to the local flux-tube approximation. We start with the governing reaction-diffusion equation:\n$$\n\\frac{\\partial I(r,t)}{\\partial t} = D\\,\\frac{\\partial^2 I(r,t)}{\\partial r^2} + \\gamma(r)\\,I(r,t)\n$$\nwith the growth rate profile $\\gamma(r) = \\gamma_0 - \\alpha(r-r_0)^2$.\n\nTo find the exponential growth rates, we use the method of separation of variables, positing a solution of the form $I(r,t) = \\psi(r) e^{\\Gamma t}$, where $\\Gamma$ is the constant growth rate. Substituting this into the PDE yields:\n$$\n\\Gamma \\psi(r) e^{\\Gamma t} = D e^{\\Gamma t} \\frac{d^2 \\psi(r)}{dr^2} + \\left(\\gamma_0 - \\alpha(r-r_0)^2\\right) \\psi(r) e^{\\Gamma t}\n$$\nDividing by $e^{\\Gamma t}$ and rearranging gives an ordinary differential equation for the spatial part $\\psi(r)$. Let's define a shifted coordinate $x = r - r_0$:\n$$\n\\Gamma \\psi(x) = D \\frac{d^2 \\psi(x)}{dx^2} + \\left(\\gamma_0 - \\alpha x^2\\right) \\psi(x)\n$$\n$$\n-D \\frac{d^2 \\psi(x)}{dx^2} + \\alpha x^2 \\psi(x) = (\\gamma_0 - \\Gamma) \\psi(x)\n$$\nThis equation has the exact form of the time-independent SchrÃ¶dinger equation for a one-dimensional quantum harmonic oscillator (QHO):\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2 \\psi(x)}{dx^2} + \\frac{1}{2} k x^2 \\psi(x) = E \\psi(x)\n$$\nBy comparing the two equations term-by-term, we can map the parameters of our plasma turbulence model to the QHO parameters:\n- Kinetic term: $\\frac{\\hbar^2}{2m} \\equiv D$\n- Potential term: $\\frac{1}{2} k \\equiv \\alpha \\implies k = 2\\alpha$\n- Energy eigenvalue: $E \\equiv \\gamma_0 - \\Gamma$\n\nThe energy levels of the QHO are quantized and given by the well-known formula:\n$$\nE_n = \\left(n + \\frac{1}{2}\\right) \\hbar \\omega, \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\nwhere $\\omega = \\sqrt{k/m}$ is the oscillator's angular frequency. We can find the product $\\hbar\\omega$ using our mapped parameters:\n$$\n(\\hbar\\omega)^2 = \\hbar^2 \\omega^2 = \\hbar^2 \\frac{k}{m} = \\left(\\frac{\\hbar^2}{2m}\\right) (2k) = D \\cdot (2 \\cdot 2\\alpha) = 4D\\alpha\n$$\nTaking the square root gives $\\hbar\\omega = 2\\sqrt{D\\alpha}$. The spectrum of energy eigenvalues is therefore:\n$$\nE_n = \\left(n + \\frac{1}{2}\\right) (2\\sqrt{D\\alpha}) = (2n+1)\\sqrt{D\\alpha}\n$$\nSince $E_n = \\gamma_0 - \\Gamma_n$, the spectrum of possible global growth rates is:\n$$\n\\Gamma_n = \\gamma_0 - E_n = \\gamma_0 - (2n+1)\\sqrt{D\\alpha}\n$$\nThe principal (i.e., most unstable) global growth rate, $\\Gamma_{\\text{global}}$, corresponds to the ground state of the system ($n=0$), which yields the highest growth rate $\\Gamma_0$.\n$$\n\\Gamma_{\\text{global}} = \\Gamma_0 = \\gamma_0 - \\sqrt{D\\alpha}\n$$\nThe local flux-tube approximation ignores radial coupling and considers only the peak of the growth rate profile at $r=r_0$. The predicted growth rate is thus the local maximum:\n$$\n\\Gamma_{\\text{local}} = \\gamma(r_0) = \\gamma_0\n$$\nThe absolute error incurred by the local approximation is the difference between the local and principal global growth rates:\n$$\n\\text{Error} = \\Gamma_{\\text{local}} - \\Gamma_{\\text{global}} = \\gamma_0 - \\left(\\gamma_0 - \\sqrt{D\\alpha}\\right) = \\sqrt{D\\alpha}\n$$\nThis error represents the stabilization of the global mode due to the energetic cost of spreading into regions of lower local growth rate (damping).\n\nNow, we substitute the given numerical values: $D = 5.0 \\times 10^{-1} \\, \\text{m}^2\\,\\text{s}^{-1}$ and $\\alpha = 1.0 \\times 10^{10} \\, \\text{s}^{-1}\\,\\text{m}^{-2}$.\n$$\n\\text{Error} = \\sqrt{(5.0 \\times 10^{-1}) \\cdot (1.0 \\times 10^{10})} \\, \\text{s}^{-1}\n$$\n$$\n\\text{Error} = \\sqrt{5.0 \\times 10^{9}} \\, \\text{s}^{-1} = \\sqrt{50 \\times 10^{8}} \\, \\text{s}^{-1} = \\sqrt{50} \\times 10^4 \\, \\text{s}^{-1}\n$$\n$$\n\\text{Error} \\approx 7.0710678... \\times 10^4 \\, \\text{s}^{-1}\n$$\nRounding to four significant figures, the error is $7.071 \\times 10^4 \\, \\text{s}^{-1}$.",
            "answer": "$$\n\\boxed{7.071 \\times 10^{4}}\n$$"
        },
        {
            "introduction": "Having established the importance of nonlocal coupling, we now investigate how the finite size of the global domain itself shapes physical phenomena. This exercise uses a model of transport avalanches to explore how their propagation is limited by the system's boundaries. You will derive scaling laws for avalanche statistics, revealing how the competition between intrinsic damping and boundary termination dictates the observed transport characteristics in simulations of different machine sizes.",
            "id": "4203665",
            "problem": "Consider a one-dimensional global simulation domain representing the radial coordinate of a toroidal fusion device, denoted by $x \\in [0,L]$, where $L$ is the device size. Let the perturbed energy density $e(x,t)$ obey a local conservation law (continuity equation)\n$$\\partial_t e(x,t) + \\partial_x \\Gamma(x,t) = S(x,t) - \\Lambda(x,t),$$\nwhere $\\Gamma$ is the radial energy flux, $S$ is a source term, and $\\Lambda$ is a sink term. An avalanche event is defined as a localized outward-propagating flux excursion of the form\n$$\\phi(x,t) = a(t) f(x - x(t)),$$\nwhere $x(t) = x_0 + v t$ is the avalanche front position, $x_0 \\in [0,L]$ is the launch point, $v > 0$ is the outward propagation speed, $a(t)$ is the amplitude, and $f(\\cdot)$ is a fixed shape function normalized such that $\\int_{-\\infty}^{\\infty} f(\\xi)\\, d\\xi = 1$. Assume linear damping of the amplitude due to collisional and decorrelation processes,\n$$\\frac{d a(t)}{dt} = -\\gamma a(t), \\quad a(0) = a_0,$$\nwith $\\gamma \\ge 0$ the damping rate and $a_0 > 0$ the initial amplitude. Define a termination threshold by $a(T) = \\varepsilon a_0$ with $0 < \\varepsilon < 1$, which implies a damping-limited duration\n$$T_d = \\frac{1}{\\gamma}\\ln\\left(\\frac{1}{\\varepsilon}\\right) \\quad \\text{for } \\gamma > 0,$$\nand $T_d = +\\infty$ for $\\gamma = 0$. Consider two physically distinct boundary conditions at $x=L$:\n- Absorbing boundary: the avalanche terminates when the front reaches $x=L$, so the boundary-limited duration is $T_b = \\frac{L - x_0}{v}$ and the actual duration is $T = \\min(T_b, T_d)$.\n- Reflecting boundary: the avalanche is not terminated by the boundary, so the duration is purely damping-limited, $T = T_d$.\n\nDefine the avalanche size as the space-time integral of the flux excursion,\n$$S = \\int_0^{T} \\int_0^{L} \\phi(x,t) \\, dx \\, dt.$$\nUsing the normalization of $f(\\cdot)$ and the damping law for $a(t)$, one has\n$$S = \\int_0^T a(t)\\, dt = \\begin{cases}\n\\frac{a_0}{\\gamma}\\left(1 - e^{-\\gamma T}\\right), & \\gamma > 0,\\\\\na_0 T, & \\gamma = 0.\n\\end{cases}$$\nAssume the launch position $x_0$ is uniformly distributed on $[0,L]$. Denote $D = L - x_0$, so $D \\sim \\mathrm{Uniform}(0,L)$ and $T_b = \\frac{D}{v}$. Your task is to derive, from the stated physical and mathematical assumptions, closed-form expressions for:\n- The expected avalanche size $\\mathbb{E}[S]$ under absorbing and reflecting boundary conditions as functions of $L$, $v$, $\\gamma$, $\\varepsilon$, and $a_0$.\n- The upper cutoff $S_{\\max}$ of the avalanche size under absorbing and reflecting boundary conditions, defined by the largest possible $S$ over $x_0 \\in [0,L]$.\n\nThen, implement these expressions in a program to quantify how finite device size and boundary conditions limit avalanche scales and to propose scaling laws versus machine size $L$. In particular, identify the asymptotic scaling of $\\mathbb{E}[S]$ and $S_{\\max}$ in the regimes $L \\ll v T_d$ and $L \\gg v T_d$ for absorbing boundaries, and compare them to reflecting boundaries. Interpret $a_0$ as a flux amplitude in $\\text{W}\\,\\text{m}^{-2}$, so $S$ has units of $\\text{J}\\,\\text{m}^{-2}$. All numerical answers must be given as real numbers (floating point values). Angles do not appear in this problem. If $\\gamma = 0$, treat $T_d = +\\infty$ consistently.\n\nTest Suite:\nUse the following set of parameter values to test your formulas and code. For each case, compute and report both $\\mathbb{E}[S]$ and $S_{\\max}$, expressed in $\\text{J}\\,\\text{m}^{-2}$.\n- Case $1$: Absorbing boundary, $L = 1\\,\\text{m}$, $v = 100\\,\\text{m}\\,\\text{s}^{-1}$, $\\gamma = 50\\,\\text{s}^{-1}$, $\\varepsilon = 0.01$, $a_0 = 1\\,\\text{W}\\,\\text{m}^{-2}$.\n- Case $2$: Absorbing boundary, $L = 100\\,\\text{m}$, $v = 100\\,\\text{m}\\,\\text{s}^{-1}$, $\\gamma = 50\\,\\text{s}^{-1}$, $\\varepsilon = 0.01$, $a_0 = 1\\,\\text{W}\\,\\text{m}^{-2}$.\n- Case $3$: Reflecting boundary, $L = 1\\,\\text{m}$, $v = 100\\,\\text{m}\\,\\text{s}^{-1}$, $\\gamma = 50\\,\\text{s}^{-1}$, $\\varepsilon = 0.01$, $a_0 = 1\\,\\text{W}\\,\\text{m}^{-2}$.\n- Case $4$: Absorbing boundary, $L = 10\\,\\text{m}$, $v = 200\\,\\text{m}\\,\\text{s}^{-1}$, $\\gamma = 0\\,\\text{s}^{-1}$, $\\varepsilon = 0.01$ (unused for $\\gamma=0$), $a_0 = 2\\,\\text{W}\\,\\text{m}^{-2}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[\\mathbb{E}[S]_1, S_{\\max,1}, \\mathbb{E}[S]_2, S_{\\max,2}, \\mathbb{E}[S]_3, S_{\\max,3}, \\mathbb{E}[S]_4, S_{\\max,4}]$, where the subscript denotes the case number. All outputs are real numbers in $\\text{J}\\,\\text{m}^{-2}$.",
            "solution": "The problem statement has been meticulously reviewed and is determined to be valid. It is scientifically grounded in a simplified but standard model of plasma transport, mathematically well-posed, objective, and internally consistent. All required parameters and distributions are provided, enabling a unique and meaningful solution. We may therefore proceed with the derivation and implementation.\n\nThe primary task is to derive closed-form expressions for the expected avalanche size $\\mathbb{E}[S]$ and the maximum possible avalanche size $S_{\\max}$ under two different boundary conditions: reflecting and absorbing. The avalanche size $S$ is given by the time integral of the decaying amplitude $a(t)$:\n$$S(T) = \\int_0^T a_0 e^{-\\gamma t} \\, dt$$\nwhere $T$ is the avalanche duration. This integration yields two forms depending on the damping rate $\\gamma$:\n$$S(T) = \\begin{cases} \\frac{a_0}{\\gamma}\\left(1 - e^{-\\gamma T}\\right), & \\text{for } \\gamma > 0 \\\\ a_0 T, & \\text{for } \\gamma = 0 \\end{cases}$$\nThe duration $T$ is determined by the interplay between intrinsic damping and boundary interaction.\n\nThe damping-limited duration $T_d$ is the time it takes for the amplitude to decay to a fraction $\\varepsilon$ of its initial value, $a(T_d) = \\varepsilon a_0$. For $\\gamma>0$, this gives $a_0 e^{-\\gamma T_d} = \\varepsilon a_0$, which solves to $T_d = \\frac{1}{\\gamma}\\ln\\left(\\frac{1}{\\varepsilon}\\right)$. For $\\gamma=0$, the amplitude never decays, so $T_d = \\infty$.\n\nThe boundary-limited duration $T_b$ is the time for the avalanche front, starting at $x_0$, to reach the boundary at $x=L$. Given a constant velocity $v$, this is $T_b = \\frac{L-x_0}{v}$. The launch position $x_0$ is a random variable uniformly distributed on $[0,L]$. It is convenient to work with the propagation distance $D = L-x_0$, which is consequently also uniformly distributed on $[0,L]$, i.e., $D \\sim \\mathrm{Uniform}(0,L)$, with probability density function $p(D) = 1/L$ for $D \\in [0,L]$. Thus, $T_b = D/v$ is a random variable.\n\nWe now analyze the two boundary conditions separately.\n\n**1. Reflecting Boundary Conditions**\n\nUnder this condition, the avalanche is not terminated by the boundary at $x=L$. Its duration is purely limited by damping.\nThe duration is constant for all avalanches, regardless of their launch point $x_0$:\n$$T = T_d$$\nConsequently, the avalanche size $S$ is also a constant, independent of $x_0$.\n\n- **Case $\\gamma > 0$**:\nThe duration is $T = T_d = \\frac{1}{\\gamma}\\ln(1/\\varepsilon)$. The size is:\n$$S = \\frac{a_0}{\\gamma}\\left(1 - e^{-\\gamma T_d}\\right) = \\frac{a_0}{\\gamma}\\left(1 - e^{-\\gamma \\frac{1}{\\gamma}\\ln(1/\\varepsilon)}\\right) = \\frac{a_0}{\\gamma}\\left(1 - e^{-\\ln(1/\\varepsilon)}\\right) = \\frac{a_0}{\\gamma}\\left(1 - \\varepsilon\\right)$$\nSince $S$ is a constant, its expected value and maximum value are identical:\n$$\\mathbb{E}[S]_{\\text{reflect}} = S_{\\max, \\text{reflect}} = \\frac{a_0(1-\\varepsilon)}{\\gamma}$$\n\n- **Case $\\gamma = 0$**:\nThe duration is $T = T_d = \\infty$. The size is:\n$$S = a_0 T = \\infty$$\nAn undamped avalanche in a system that does not terminate it will have infinite size. Both the expected and maximum sizes are infinite.\n\n**2. Absorbing Boundary Conditions**\n\nUnder this condition, an avalanche terminates either by damping or by reaching the boundary at $x=L$, whichever occurs first. The duration $T$ is therefore a random variable dependent on $x_0$:\n$$T(x_0) = \\min(T_b, T_d) = \\min\\left(\\frac{L-x_0}{v}, T_d\\right)$$\nIn terms of the random variable $D=L-x_0$, the duration is $T(D) = \\min(D/v, T_d)$.\n\n**2.1. Maximum Avalanche Size $S_{\\max}$**\n\nThe size function $S(T)$ is monotonically increasing with duration $T$. Therefore, $S_{\\max}$ corresponds to the maximum possible duration, $T_{\\max}$. The duration $T(D) = \\min(D/v, T_d)$ is maximized when $D$ is maximized. The maximum value of $D$ is $L$ (when $x_0=0$).\n$$T_{\\max} = \\min\\left(\\frac{L}{v}, T_d\\right)$$\n- **Case $\\gamma > 0$**:\n$$S_{\\max, \\text{absorb}} = S(T_{\\max}) = \\frac{a_0}{\\gamma}\\left(1 - e^{-\\gamma \\min(L/v, T_d)}\\right)$$\n- **Case $\\gamma = 0$**:\nHere $T_d=\\infty$, so $T_{\\max} = \\min(L/v, \\infty) = L/v$.\n$$S_{\\max, \\text{absorb}} = a_0 T_{\\max} = \\frac{a_0 L}{v}$$\n\n**2.2. Expected Avalanche Size $\\mathbb{E}[S]$**\n\nThe expected size is the average of $S(T(D))$ over the distribution of $D$:\n$$\\mathbb{E}[S]_{\\text{absorb}} = \\int_0^L S(T(D)) p(D) \\, dD = \\frac{1}{L}\\int_0^L S\\left(\\min\\left(\\frac{D}{v}, T_d\\right)\\right) \\, dD$$\n\n- **Case $\\gamma = 0$**:\nHere $T_d = \\infty$, so $T(D) = D/v$. The size is $S(D) = a_0 (D/v)$.\n$$\\mathbb{E}[S] = \\frac{1}{L}\\int_0^L \\frac{a_0 D}{v} \\, dD = \\frac{a_0}{vL} \\left[ \\frac{D^2}{2} \\right]_0^L = \\frac{a_0}{vL} \\frac{L^2}{2} = \\frac{a_0 L}{2v}$$\nThis is simply half of the maximum size, as expected for a linear function of a uniformly distributed variable.\n\n- **Case $\\gamma > 0$**:\nLet $L_d = v T_d$ be the characteristic distance an avalanche travels before damping terminates it. The evaluation of the integral for $\\mathbb{E}[S]$ depends on the comparison between the system size $L$ and this characteristic distance $L_d$.\nThe integral is:\n$$\\mathbb{E}[S] = \\frac{1}{L}\\int_0^L \\frac{a_0}{\\gamma}\\left(1 - e^{-\\gamma \\min(D/v, T_d)}\\right) \\, dD$$\n\n**Regime I: $L \\le L_d$ (Small device)**\nFor any $D \\in [0,L]$, we have $D \\le L \\le L_d$, which implies $D/v \\le T_d$. Thus, $\\min(D/v, T_d) = D/v$ throughout the integration domain.\n$$\\mathbb{E}[S] = \\frac{a_0}{\\gamma L}\\int_0^L \\left(1 - e^{-\\gamma D/v}\\right) \\, dD$$\n$$\\mathbb{E}[S] = \\frac{a_0}{\\gamma L} \\left[ D - \\left(-\\frac{v}{\\gamma}\\right) e^{-\\gamma D/v} \\right]_0^L = \\frac{a_0}{\\gamma L} \\left[ \\left(L + \\frac{v}{\\gamma}e^{-\\gamma L/v}\\right) - \\left(0 + \\frac{v}{\\gamma}e^0\\right) \\right]$$\n$$\\mathbb{E}[S] = \\frac{a_0}{\\gamma L} \\left[ L - \\frac{v}{\\gamma}\\left(1 - e^{-\\gamma L/v}\\right) \\right] = \\frac{a_0}{\\gamma} \\left[ 1 - \\frac{v}{\\gamma L}\\left(1 - e^{-\\gamma L/v}\\right) \\right]$$\n\n**Regime II: $L > L_d$ (Large device)**\nThe integral must be split at $D = L_d$.\nFor $D \\in [0, L_d]$, $\\min(D/v, T_d) = D/v$.\nFor $D \\in (L_d, L]$, $\\min(D/v, T_d) = T_d$.\n$$\\mathbb{E}[S] = \\frac{1}{L} \\left[ \\int_0^{L_d} S(D/v) \\, dD + \\int_{L_d}^L S(T_d) \\, dD \\right]$$\nThe first integral is the same as in Regime I, with $L$ replaced by $L_d$:\n$$\\int_0^{L_d} S(D/v) \\, dD = \\frac{a_0}{\\gamma} \\left[ L_d - \\frac{v}{\\gamma}\\left(1 - e^{-\\gamma L_d/v}\\right) \\right] = \\frac{a_0}{\\gamma} \\left[ vT_d - \\frac{v}{\\gamma}\\left(1 - e^{-\\gamma T_d}\\right) \\right]$$\nThe second integral is of a constant $S(T_d) = \\frac{a_0}{\\gamma}(1 - \\varepsilon)$:\n$$\\int_{L_d}^L S(T_d) \\, dD = S(T_d) \\cdot (L - L_d) = \\frac{a_0}{\\gamma}(1-\\varepsilon)(L - vT_d)$$\nSumming these parts and dividing by $L$:\n$$\\mathbb{E}[S] = \\frac{a_0}{\\gamma L} \\left[ vT_d - \\frac{v}{\\gamma}(1 - \\varepsilon) + (L - vT_d)(1 - \\varepsilon) \\right]$$\n$$\\mathbb{E}[S] = \\frac{a_0}{\\gamma L} \\left[ vT_d - \\frac{v}{\\gamma}(1-\\varepsilon) + L(1-\\varepsilon) - vT_d(1-\\varepsilon) \\right]$$\n$$\\mathbb{E}[S] = \\frac{a_0}{\\gamma L} \\left[ L(1-\\varepsilon) + vT_d\\varepsilon - \\frac{v}{\\gamma}(1-\\varepsilon) \\right]$$\n\n**Asymptotic Scaling Analysis (Absorbing Boundaries, $\\gamma>0$)**\n\n- **$L \\ll vT_d$ (Small machine limit):** Most avalanches hit the boundary. Using the Regime I formula, a Taylor expansion for small argument $x = \\gamma L/v \\ll 1$ gives $\\mathbb{E}[S] \\approx \\frac{a_0 L}{2v}$ and $S_{\\max} \\approx \\frac{a_0 L}{v}$. The scaling is linear with $L$, and the result approaches the undamped ($\\gamma=0$) case, as damping has little time to act.\n- **$L \\gg vT_d$ (Large machine limit):** Most avalanches terminate by damping. Using the Regime II formula, as $L \\to \\infty$, the terms divided by $L$ vanish, and $\\mathbb{E}[S] \\to \\frac{a_0(1-\\varepsilon)}{\\gamma}$. Also, $S_{\\max}$ saturates at $\\frac{a_0(1-\\varepsilon)}{\\gamma}$. Both quantities become independent of $L$ and converge to the reflecting boundary result, as the boundary becomes irrelevant for most events.\n\nThe following program implements these derived closed-form expressions to calculate the required values for the test suite.",
            "answer": "[0.00426213,0.007869387,0.0195726,0.0198,0.0198,0.0198,0.05,0.1]"
        },
        {
            "introduction": "Our final practice addresses a crucial aspect of numerical fidelity in global simulations: the treatment of boundaries. Simulations often employ buffer regions with artificial damping to absorb outgoing waves, but this can spuriously drain energy from the system. In this exercise, you will implement such a buffer, quantify its impact on global energy conservation, and design a correction scheme to restore the proper energy balance, a vital skill for ensuring the physical validity of computational models.",
            "id": "4203684",
            "problem": "Consider a global one-dimensional minor-radius domain in a magnetized plasma, represented by the interval $r \\in [0,a]$, where $a$ is the minor radius of the plasma. The dynamics of the turbulent energy density per unit radius $e(r,t)$ is modeled by a conservation law consistent with Magnetohydrodynamics (MHD), namely\n$$\n\\frac{\\partial e}{\\partial t} + \\frac{\\partial F}{\\partial r} = S(r,t) - \\nu e(r,t) - \\alpha(r) e(r,t),\n$$\nwhere $F(r,t)$ is the radial energy flux density, $S(r,t)$ is a volumetric energy source density, $\\nu$ is a physical dissipation coefficient, and $\\alpha(r)$ is an artificial damping coefficient. The artificial damping is applied only in a thin buffer region near the outer radius to absorb outgoing fluctuations and minimize reflections. Specifically, the buffer region is $r \\in [a-\\Delta,a]$, where $\\Delta$ is the buffer width, and $\\alpha(r)$ is nonzero only in this region.\n\nAssume zero-flux boundary conditions consistent with no net energy flow across the radial boundaries at the times of interest, meaning $F(0,t) = 0$ and $F(a,t) = 0$. Under these conditions, the global energy is $E(t) = \\int_0^a e(r,t)\\,dr$ and the global energy rate of change is\n$$\n\\frac{dE}{dt} = \\int_0^a S(r,t)\\,dr - \\nu \\int_0^a e(r,t)\\,dr - \\int_0^a \\alpha(r) e(r,t)\\,dr.\n$$\nYou are to compute the effect of the artificial damping on the global energy conservation and then design a correction that removes the spurious global dissipation while preserving local damping within the buffer region.\n\nFor computational concreteness, consider a quasi-steady snapshot where $e(r)$ and $S(r)$ are time-independent profiles defined as\n$$\ne(r) = e_0 \\left(1 + \\frac{1}{2} \\cos\\left(\\frac{2\\pi r}{a}\\right)\\right), \\quad S(r) = S_0 \\left(1 + 0.2 \\sin\\left(\\frac{2\\pi r}{a}\\right)\\right),\n$$\nwith $e_0$ in $\\text{J/m}$ and $S_0$ in $\\text{W/m}$. Let the artificial damping coefficient be specified by\n$$\n\\alpha(r) = \n\\begin{cases}\n\\alpha_0 \\, \\sin^2\\left(\\frac{\\pi}{2}\\,\\frac{r-(a-\\Delta)}{\\Delta}\\right), & r \\in [a-\\Delta,a], \\ \\Delta > 0, \\\\\n0, & r \\in [0,a-\\Delta) \\text{ or } \\Delta=0,\n\\end{cases}\n$$\nwhere $\\alpha_0$ is in $\\text{s}^{-1}$. This choice ensures a smooth ramp-up of damping from zero at $r=a-\\Delta$ to a maximum at $r=a$.\n\nTasks:\n1. Using the above definitions and assuming $F(0)=F(a)=0$, compute three quantities for each parameter set:\n   - The physical global energy rate without any artificial damping,\n     $$\n     \\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}} = \\int_0^a S(r)\\,dr - \\nu \\int_0^a e(r)\\,dr.\n     $$\n   - The global energy rate with the buffer damping included,\n     $$\n     \\left.\\frac{dE}{dt}\\right|_{\\mathrm{buffer}} = \\int_0^a S(r)\\,dr - \\nu \\int_0^a e(r)\\,dr - \\int_0^a \\alpha(r) e(r)\\,dr.\n     $$\n   - A corrected global energy rate that eliminates the spurious global dissipation introduced by the buffer while retaining local damping within the buffer. Design a correction source density $C(r)$ that achieves global energy conservation in the sense that the corrected rate equals the physical rate in the presence of damping. Implement your designed $C(r)$ and compute\n     $$\n     \\left.\\frac{dE}{dt}\\right|_{\\mathrm{corr}} = \\int_0^a \\left(S(r) + C(r)\\right)\\,dr - \\nu \\int_0^a e(r)\\,dr - \\int_0^a \\alpha(r) e(r)\\,dr.\n     $$\n   Express all global energy rates in $\\text{J/s}$.\n\n2. Discretize the domain using $N$ uniformly spaced grid points and evaluate all integrals using a numerically stable quadrature appropriate for uniformly spaced samples.\n\n3. Use the following test suite of parameter values to ensure coverage of different scenarios (list entries are $(a,\\Delta,\\alpha_0,\\nu,e_0,S_0)$):\n   - Case A (happy path, mild buffer): ($a=1.0\\,\\text{m}$, $\\Delta=0.1\\,\\text{m}$, $\\alpha_0=10\\,\\text{s}^{-1}$, $\\nu=1.0\\,\\text{s}^{-1}$, $e_0=1.0\\,\\text{J/m}$, $S_0=0.5\\,\\text{W/m}$).\n   - Case B (stronger buffer, narrower width): ($a=1.5\\,\\text{m}$, $\\Delta=0.05\\,\\text{m}$, $\\alpha_0=50\\,\\text{s}^{-1}$, $\\nu=0.5\\,\\text{s}^{-1}$, $e_0=2.0\\,\\text{J/m}$, $S_0=0.8\\,\\text{W/m}$).\n   - Case C (no buffer damping): ($a=1.0\\,\\text{m}$, $\\Delta=0.1\\,\\text{m}$, $\\alpha_0=0\\,\\text{s}^{-1}$, $\\nu=1.0\\,\\text{s}^{-1}$, $e_0=1.0\\,\\text{J/m}$, $S_0=0.5\\,\\text{W/m}$).\n   - Case D (zero-width buffer edge case): ($a=1.0\\,\\text{m}$, $\\Delta=0.0\\,\\text{m}$, $\\alpha_0=100\\,\\text{s}^{-1}$, $\\nu=1.0\\,\\text{s}^{-1}$, $e_0=1.0\\,\\text{J/m}$, $S_0=0.5\\,\\text{W/m}$).\n\n4. Your discretization must use $N=2001$ grid points. When constructing $e(r)$ and $S(r)$, ensure that all evaluations are consistent with the parameter set for each case.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results of the test suite as a comma-separated list enclosed in square brackets.\n- Each element of the list must itself be a list of three floating-point numbers $[\\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}}, \\left.\\frac{dE}{dt}\\right|_{\\mathrm{buffer}}, \\left.\\frac{dE}{dt}\\right|_{\\mathrm{corr}}]$ in $\\text{J/s}$ for the corresponding case.\n- For example, the final output format should look like $[ [x_1,y_1,z_1], [x_2,y_2,z_2], [x_3,y_3,z_3], [x_4,y_4,z_4] ]$, where each $x_i$, $y_i$, $z_i$ is a float.\n\nAnswer all global energy rates in $\\text{J/s}$.",
            "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Domain**: The one-dimensional radial domain is $r \\in [0,a]$.\n- **Governing Equation**: The turbulent energy density $e(r,t)$ evolves according to the conservation law $\\frac{\\partial e}{\\partial t} + \\frac{\\partial F}{\\partial r} = S(r,t) - \\nu e(r,t) - \\alpha(r) e(r,t)$.\n- **Boundary Conditions**: Zero-flux boundary conditions are assumed: $F(0,t) = 0$ and $F(a,t) = 0$.\n- **Global Energy Rate**: The rate of change of total energy $E(t) = \\int_0^a e(r,t)\\,dr$ is given by $\\frac{dE}{dt} = \\int_0^a S(r,t)\\,dr - \\nu \\int_0^a e(r,t)\\,dr - \\int_0^a \\alpha(r) e(r,t)\\,dr$.\n- **Profiles**: The problem considers time-independent profiles for energy density $e(r)$ and source $S(r)$:\n  - $e(r) = e_0 \\left(1 + \\frac{1}{2} \\cos\\left(\\frac{2\\pi r}{a}\\right)\\right)$\n  - $S(r) = S_0 \\left(1 + 0.2 \\sin\\left(\\frac{2\\pi r}{a}\\right)\\right)$\n- **Artificial Damping Profile**: The damping coefficient $\\alpha(r)$ is defined as:\n  $$\n  \\alpha(r) = \n  \\begin{cases}\n  \\alpha_0 \\, \\sin^2\\left(\\frac{\\pi}{2}\\,\\frac{r-(a-\\Delta)}{\\Delta}\\right), & r \\in [a-\\Delta,a], \\ \\Delta > 0, \\\\\n  0, & r \\in [0,a-\\Delta) \\text{ or } \\Delta=0.\n  \\end{cases}\n  $$\n- **Quantities to Compute**:\n  1. Physical global energy rate: $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}} = \\int_0^a S(r)\\,dr - \\nu \\int_0^a e(r)\\,dr$.\n  2. Buffered global energy rate: $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{buffer}} = \\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}} - \\int_0^a \\alpha(r) e(r)\\,dr$.\n  3. Corrected global energy rate: $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{corr}} = \\int_0^a \\left(S(r) + C(r)\\right)\\,dr - \\nu \\int_0^a e(r)\\,dr - \\int_0^a \\alpha(r) e(r)\\,dr$, where $C(r)$ is a correction source designed to restore global energy conservation.\n- **Numerical Parameters**: The domain is to be discretized with $N=2001$ uniformly spaced grid points.\n- **Test Cases**: A list of four parameter sets $(a, \\Delta, \\alpha_0, \\nu, e_0, S_0)$ is provided for testing.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem describes a simplified 1D model for energy transport in a plasma, a common technique in computational plasma physics for studying turbulence. The use of a buffer region with an artificial damping term to absorb outgoing waves and prevent unphysical boundary reflections is a standard and valid numerical method. The chosen functional forms are physically plausible. The problem is scientifically sound.\n- **Well-Posed**: All necessary parameters, functions, and boundary conditions are explicitly defined. The tasks are clearly stated and lead to a unique set of computable results. The requirement to design a correction term $C(r)$ is a part of the problem, not a sign of incompleteness.\n- **Objective**: The problem is formulated in precise, objective, mathematical language, free from any subjective or biased statements.\n- **Consistency and Feasibility**: The provided parameters and functional forms are consistent and do not present any mathematical contradictions or physical impossibilities. The edge cases for $\\Delta=0$ and $\\alpha_0=0$ are well-defined and lead to physically sensible limits (no damping).\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-posed, scientifically grounded problem in computational physics that requires designing a standard conservation correction and implementing its numerical evaluation. The solution process may proceed.\n\n### Solution Derivation and Implementation Strategy\n\nThe core of the problem is to compute three variations of the global energy rate of change, $\\frac{dE}{dt}$, and to design a correction source, $C(r)$, that perfectly counteracts the global energy sink introduced by the artificial damping term $\\alpha(r)$.\n\n**1. Designing the Correction Source $C(r)$**\n\nThe goal is for the corrected energy rate to equal the physical energy rate:\n$$ \\left.\\frac{dE}{dt}\\right|_{\\mathrm{corr}} = \\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}} $$\nSubstituting the integral definitions:\n$$ \\int_0^a \\left(S(r) + C(r)\\right)\\,dr - \\nu \\int_0^a e(r)\\,dr - \\int_0^a \\alpha(r) e(r)\\,dr = \\int_0^a S(r)\\,dr - \\nu \\int_0^a e(r)\\,dr $$\nThe terms $\\int_0^a S(r)\\,dr$ and $-\\nu \\int_0^a e(r)\\,dr$ cancel from both sides, yielding the constraint on $C(r)$:\n$$ \\int_0^a C(r)\\,dr - \\int_0^a \\alpha(r) e(r)\\,dr = 0 $$\nThis simplifies to the fundamental requirement for the correction source: its spatial integral must exactly balance the total energy dissipated by the artificial damping. Let $D_{\\mathrm{art}}$ be this total artificial dissipation rate:\n$$ D_{\\mathrm{art}} = \\int_0^a \\alpha(r) e(r)\\,dr $$\nThe constraint is then $\\int_0^a C(r)\\,dr = D_{\\mathrm{art}}$.\n\nThe problem asks for a design of $C(r)$ that preserves local damping. This means the term $-\\alpha(r)e(r)$ should remain in the local energy equation, and the correction $C(r)$ is added to the source term. There are multiple ways to define a function $C(r)$ that satisfies the integral constraint. A simple, robust, and physically motivated choice is to re-inject the dissipated energy uniformly back into the plasma. This corresponds to a spatially constant correction source, $C(r)=C_0$.\n\nTo find $C_0$, we integrate over the domain:\n$$ \\int_0^a C_0 \\, dr = C_0 \\int_0^a dr = C_0 a $$\nSetting this equal to $D_{\\mathrm{art}}$ gives:\n$$ C_0 a = D_{\\mathrm{art}} \\implies C_0 = \\frac{D_{\\mathrm{art}}}{a} = \\frac{1}{a} \\int_0^a \\alpha(r') e(r') \\, dr' $$\nThis design for $C(r)$ is computationally simple and common in numerical simulations for maintaining global conservation laws. By construction, when this correction is applied, the corrected global energy rate will be numerically identical to the physical rate.\n\n**2. Numerical Implementation**\n\nThe problem will be solved numerically as the integral involving $\\alpha(r)$ is not straightforward to evaluate analytically.\n\n- **Discretization**: The radial domain $r \\in [0,a]$ is discretized into $N=2001$ uniformly spaced points, $r_i$, for $i = 0, 1, \\dots, N-1$.\n- **Quadrature**: All integrals of the form $\\int_0^a f(r)\\,dr$ will be numerically evaluated using the trapezoidal rule. For a function $f$ sampled at uniform points $r_i$ with spacing $\\delta r$, the integral is approximated by $\\sum_{i=0}^{N-2} \\frac{f(r_i)+f(r_{i+1})}{2} \\delta r$. This method is numerically stable and highly accurate for a large number of points like $N=2001$. The `numpy.trapz` function provides a canonical implementation.\n- **Procedure**: For each test case, the following steps are performed:\n    1. Define the spatial grid `r` over $[0, a]$.\n    2. Evaluate the functions $e(r)$, $S(r)$, and $\\alpha(r)$ on this grid, yielding arrays `e_r`, `s_r`, and `alpha_r`. Care is taken to correctly implement the piecewise definition of $\\alpha(r)$, especially for the edge cases $\\Delta=0$ and $\\alpha_0=0$.\n    3. Compute the required spatial integrals using the trapezoidal rule:\n        - $\\mathcal{I}_S = \\int_0^a S(r)\\,dr$\n        - $\\mathcal{I}_e = \\int_0^a e(r)\\,dr$\n        - $D_{\\mathrm{art}} = \\int_0^a \\alpha(r)e(r)\\,dr$\n    4. Analytically, it can be shown that $\\mathcal{I}_S = S_0 a$ and $\\mathcal{I}_e = e_0 a$. The numerical quadrature will yield results extremely close to these exact values.\n    5. Calculate the three global energy rates:\n        - $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}} = \\mathcal{I}_S - \\nu \\mathcal{I}_e$\n        - $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{buffer}} = \\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}} - D_{\\mathrm{art}}$\n        - To compute $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{corr}}$, first the correction source $C(r) = D_{\\mathrm{art}}/a$ is defined on the grid. Then the integral of the corrected source, $\\int_0^a (S(r)+C(r))\\,dr$, is computed. Finally, $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{corr}}$ is calculated using its full definition. As per the design, this will yield a value numerically indistinguishable from $\\left.\\frac{dE}{dt}\\right|_{\\mathrm{phys}}$.\n\nThis procedure is implemented for each of the four test cases provided. The final output is formatted as a list of lists, as specified.",
            "answer": "[[-0.5,-0.575083163351336,-0.5],[-0.3,-0.7410884617150117,-0.3],[-0.5,-0.5,-0.5],[-0.5,-0.5,-0.5]]"
        }
    ]
}