{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in computational plasma physics is translating physical measurements into the dimensionless units used by simulation codes. This practice guides you through the fundamental process of normalization, which is essential for comparing simulation results with experimental data . By calculating characteristic scales like the ion-acoustic speed ($c_s$) and the ion sound Larmor radius ($\\rho_{s}$), you will learn to express physical quantities such as blob velocity and size in the natural language of the plasma's micro-scale dynamics.",
            "id": "4200177",
            "problem": "A localized pressure perturbation (“blob”) in the Scrape-Off Layer (SOL) of a tokamak propagates radially with a measured cross-field center-of-mass speed $V_{\\perp}$. You are asked to convert given physical parameters to normalized units typically used in edge filament simulations. Assume singly ionized deuterium ions. Starting from the definition of the ion-acoustic speed in the isothermal-electron, cold-ion limit and the nonrelativistic ion cyclotron frequency in a uniform magnetic field, derive the normalized blob speed $\\hat{V}_{\\perp}=V_{\\perp}/c_{s}$ and the normalized blob size $\\hat{\\delta}=\\delta/\\rho_{s}$, where $\\rho_{s}$ is the ion sound Larmor radius. Use the data:\n- Electron temperature $T_{e}=60\\,\\mathrm{eV}$,\n- Magnetic field magnitude $B=2.2\\,\\mathrm{T}$,\n- Ion species: deuterium with charge state $Z=1$ and ion mass $m_{i}=2m_{p}$,\n- Proton mass $m_{p}=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$,\n- Elementary charge $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$,\n- Blob cross-field speed $V_{\\perp}=1.8\\times 10^{3}\\,\\mathrm{m/s}$,\n- Blob cross-field size $\\delta=1.5\\times 10^{-2}\\,\\mathrm{m}$.\n\nExpress your final answer as the ordered pair $\\left(\\hat{V}_{\\perp},\\hat{\\delta}\\right)$, rounded to four significant figures. Because the requested quantities are normalized, no physical units should be reported for the final pair.",
            "solution": "The problem statement will first be validated by extracting the given information and evaluating its scientific soundness, consistency, and completeness.\n\n### Step 1: Extract Givens\nThe physical parameters and conditions provided are:\n- Electron temperature: $T_{e}=60\\,\\mathrm{eV}$\n- Magnetic field magnitude: $B=2.2\\,\\mathrm{T}$\n- Ion species: deuterium with charge state $Z=1$ and ion mass $m_{i}=2m_{p}$\n- Proton mass: $m_{p}=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$\n- Elementary charge: $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n- Blob cross-field speed: $V_{\\perp}=1.8\\times 10^{3}\\,\\mathrm{m/s}$\n- Blob cross-field size: $\\delta=1.5\\times 10^{-2}\\,\\mathrm{m}$\n- Definitions:\n    - Ion-acoustic speed $c_s$ is in the isothermal-electron, cold-ion limit.\n    - Nonrelativistic ion cyclotron frequency $\\Omega_{ci}$ is in a uniform magnetic field.\n    - Normalized blob speed: $\\hat{V}_{\\perp}=V_{\\perp}/c_{s}$\n    - Normalized blob size: $\\hat{\\delta}=\\delta/\\rho_{s}$, where $\\rho_s$ is the ion sound Larmor radius.\n- Required Output: The ordered pair $\\left(\\hat{V}_{\\perp},\\hat{\\delta}\\right)$, with values rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against established criteria.\n- **Scientifically Grounded**: The problem is set in the context of plasma turbulence in the Scrape-Off Layer (SOL) of a tokamak, a well-established field of research in fusion energy science. The physical quantities, such as ion-acoustic speed ($c_s$), ion cyclotron frequency ($\\Omega_{ci}$), and the ion sound Larmor radius ($\\rho_s$), are fundamental concepts in plasma physics. The specified values for temperature, magnetic field, and particle properties are physically realistic for typical SOL plasmas. The normalization scheme using $c_s$ and $\\rho_s$ is standard practice in computational plasma physics (e.g., in gyrokinetic and fluid turbulence codes).\n- **Well-Posed**: The problem provides all necessary data and definitions to compute the requested normalized quantities, $\\hat{V}_{\\perp}$ and $\\hat{\\delta}$. The path to the solution is unambiguous and relies on standard physical formulas. The request for a specific output format (an ordered pair rounded to four significant figures) ensures a unique and well-defined answer.\n- **Objective**: The problem is stated using precise, objective scientific language. It is free of ambiguity, subjective claims, or opinion. The convention of stating electron temperature in electron-volts ($\\mathrm{eV}$) is standard in plasma physics, where it is understood as a unit of energy ($k_B T_e$).\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. Therefore, the problem is deemed **valid**. The solution will now be derived.\n\nThe task is to calculate the normalized blob speed $\\hat{V}_{\\perp} = V_{\\perp}/c_{s}$ and the normalized blob size $\\hat{\\delta} = \\delta/\\rho_{s}$. This requires first determining the values of the ion-acoustic speed $c_s$ and the ion sound Larmor radius $\\rho_s$.\n\nThe ion-acoustic speed, $c_s$, in the limit of isothermal electrons ($T_e=\\text{constant}$) and cold ions ($T_i \\approx 0$), is defined as:\n$$c_s = \\sqrt{\\frac{k_B T_e}{m_i}}$$\nwhere $k_B$ is the Boltzmann constant, $T_e$ is the electron temperature in Kelvin, and $m_i$ is the ion mass. The electron temperature is given in units of electron-volts ($\\mathrm{eV}$), which represents the energy $k_B T_e$. Let $T_{e,\\mathrm{eV}}$ be the numerical value of the temperature in $\\mathrm{eV}$. The energy in SI units (Joules) is $e T_{e,\\mathrm{eV}}$, where $e$ is the elementary charge. The formula for $c_s$ becomes:\n$$c_s = \\sqrt{\\frac{e T_{e,\\mathrm{eV}}}{m_i}}$$\nThe ion is deuterium ($D^+$), so its mass is $m_i=2m_p$, where $m_p$ is the proton mass. Substituting the given values:\n$$c_s = \\sqrt{\\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (60)}{2 \\times (1.67262192369 \\times 10^{-27}\\,\\mathrm{kg})}}$$\n$$c_s = \\sqrt{\\frac{9.613059804 \\times 10^{-18}}{3.34524384738 \\times 10^{-27}}} \\,\\mathrm{m/s} \\approx 53606.65\\,\\mathrm{m/s}$$\n\nThe ion sound Larmor radius, $\\rho_s$, is defined as the gyroradius of an ion moving at the ion-acoustic speed:\n$$\\rho_s = \\frac{c_s}{\\Omega_{ci}}$$\nwhere $\\Omega_{ci}$ is the ion cyclotron frequency. The nonrelativistic ion cyclotron frequency is given by:\n$$\\Omega_{ci} = \\frac{|q_i|B}{m_i}$$\nFor a singly ionized ($Z=1$) deuterium ion, the charge is $q_i=e$ and the mass is $m_i=2m_p$. Thus:\n$$\\Omega_{ci} = \\frac{eB}{2m_p}$$\nSubstituting the given values:\n$$\\Omega_{ci} = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (2.2\\,\\mathrm{T})}{2 \\times (1.67262192369 \\times 10^{-27}\\,\\mathrm{kg})}$$\n$$\\Omega_{ci} = \\frac{3.5247885948 \\times 10^{-19}}{3.34524384738 \\times 10^{-27}}\\,\\mathrm{s}^{-1} \\approx 1.053671 \\times 10^8\\,\\mathrm{s}^{-1}$$\nNow, we can calculate $\\rho_s$:\n$$\\rho_s = \\frac{c_s}{\\Omega_{ci}} \\approx \\frac{53606.65\\,\\mathrm{m/s}}{1.053671 \\times 10^8\\,\\mathrm{s}^{-1}} \\approx 5.08779 \\times 10^{-4}\\,\\mathrm{m}$$\n\nWith $c_s$ and $\\rho_s$ calculated, we can find the normalized quantities.\n\nThe normalized blob speed $\\hat{V}_{\\perp}$ is:\n$$\\hat{V}_{\\perp} = \\frac{V_{\\perp}}{c_s} \\approx \\frac{1.8\\times 10^{3}\\,\\mathrm{m/s}}{53606.65\\,\\mathrm{m/s}} \\approx 0.0335787$$\n\nThe normalized blob size $\\hat{\\delta}$ is:\n$$\\hat{\\delta} = \\frac{\\delta}{\\rho_s} \\approx \\frac{1.5\\times 10^{-2}\\,\\mathrm{m}}{5.08779 \\times 10^{-4}\\,\\mathrm{m}} \\approx 29.4821$$\n\nFinally, we round the results to four significant figures as requested:\n$$\\hat{V}_{\\perp} \\approx 0.03358$$\n$$\\hat{\\delta} \\approx 29.48$$\n\nThe final answer is the ordered pair $(\\hat{V}_{\\perp}, \\hat{\\delta})$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.03358 & 29.48 \\end{pmatrix}}$$"
        },
        {
            "introduction": "At the heart of any fluid simulation lies the numerical implementation of the governing partial differential equations. This exercise provides direct, hands-on experience in building the computational core of a 2D drift-fluid model for plasma blobs . You will discretize the vorticity evolution equation, implementing key physical processes such as nonlinear advection via the Poisson bracket $\\{\\phi, \\Omega\\}$, the curvature-driven interchange instability, and dissipation, which together determine the blob's dynamics.",
            "id": "4200180",
            "problem": "You are tasked with implementing a two-dimensional discrete computation of the interchange-driven vorticity dynamics for a cold-ion, isothermal-electron blob in a slab geometry. The goal is to compute the time derivative of the vorticity field, denoted by $\\partial_t \\Omega$, on a uniform periodic Cartesian grid using a simplified, yet scientifically consistent, model.\n\nThe physical and mathematical setting is as follows.\n\n- Geometry and normalization: Assume a slab plasma aligned with a uniform magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$ and use electrostatic, drift-reduced, two-dimensional dynamics in the plane perpendicular to $\\mathbf{B}$. All quantities are normalized to Bohm units, that is, lengths to the ion-sound gyroradius $\\rho_s$, time to the inverse ion cyclotron frequency, and potentials to thermal energy $T_e/e$. Therefore, all fields are dimensionless.\n\n- Fields: The simulation fields are the density $n(x,y)$, the electrostatic potential $\\phi(x,y)$, and the vorticity $\\Omega(x,y)$. The vorticity is defined by the polarization closure $\\Omega = \\nabla_\\perp^2 \\phi$, where $\\nabla_\\perp^2 = \\partial_x^2 + \\partial_y^2$ is the perpendicular Laplacian.\n\n- Electron thermodynamics: Electrons are isothermal, and the pressure is $p(x,y) = n(x,y)$ in normalized units.\n\n- Dynamics: The perpendicular fluid velocity is the cross-field (Electric field cross Magnetic field) drift $\\mathbf{v}_E = \\hat{\\mathbf{z}} \\times \\nabla \\phi$. The interchange curvature drive enters through a curvature operator acting on pressure, modeled as $\\mathcal{K}(p) = \\kappa \\,\\partial_y p$, where $\\kappa$ is a constant curvature parameter. A linear viscous damping term $-\\nu \\Omega$ models dissipative sinks.\n\n- Objective: Starting from these foundations, derive the expression for $\\partial_t \\Omega$ in terms of the fields $n$ and $\\phi$, their spatial derivatives, the curvature operator acting on $p$, and damping. Then implement a discrete computation of $\\partial_t \\Omega$ on a uniform periodic grid using second-order centered finite differences for spatial derivatives.\n\n- Discrete operators and boundary conditions:\n  1. Use a rectangular domain of size $L_x \\times L_y$ discretized by $N_x \\times N_y$ points with uniform spacings $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$.\n  2. Implement periodic boundary conditions in both directions for all discrete spatial derivatives.\n  3. Compute gradients using second-order centered differences with periodic wrapping. For a field $f$, define $\\partial_x f$ and $\\partial_y f$ accordingly.\n  4. Compute the perpendicular Laplacian $\\nabla_\\perp^2 f$ using second-order centered differences with periodic wrapping.\n  5. Compute the Poisson bracket (nonlinear advection) $\\{\\phi, \\Omega\\} = \\partial_x \\phi \\, \\partial_y \\Omega - \\partial_y \\phi \\, \\partial_x \\Omega$ using the discrete gradients above.\n\n- Required final quantity: For each test case described below, compute the discrete field $\\partial_t \\Omega(x,y)$ at the initial time and report its domain-wide root mean square (RMS) magnitude, defined as\n  $$\\mathrm{RMS}(\\partial_t \\Omega) = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} \\left( \\partial_t \\Omega_{i,j} \\right)^2 }.$$\n\n- Units for the answer: All quantities are dimensionless. Report each RMS as a floating-point number.\n\n- Test suite and parameter specification:\n  Implement the computation for the following four test cases. For each case, construct the fields $n(x,y)$ and $\\phi(x,y)$ on the grid and compute $\\partial_t \\Omega$ and its RMS as specified.\n\n  Common grid parameters for all cases:\n  - Domain sizes: $L_x = 40$, $L_y = 40$.\n  - Grid resolution: $N_x = 64$, $N_y = 64$.\n\n  Case $1$ (general blob with curvature and weak damping):\n  - Curvature parameter: $\\kappa = 0.02$.\n  - Damping parameter: $\\nu = 0.005$.\n  - Blob parameters: $A = 1.0$, $\\sigma = 5.0$, $x_0 = L_x/2$, $y_0 = L_y/2$.\n  - Fields: $\\phi(x,y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{\\sigma^2}\\right)$, and $n(x,y) = \\phi(x,y)$.\n\n  Case $2$ (uniform zero fields):\n  - Curvature parameter: $\\kappa = 0.02$.\n  - Damping parameter: $\\nu = 0.005$.\n  - Fields: $\\phi(x,y) = 0$ and $n(x,y) = 0$ everywhere.\n\n  Case $3$ (curvature-only drive with sinusoidal density, no potential):\n  - Curvature parameter: $\\kappa = 0.05$.\n  - Damping parameter: $\\nu = 0.0$.\n  - Fields: $\\phi(x,y) = 0$ everywhere, and $n(x,y) = 1.0 + \\sin\\left(\\frac{2\\pi y}{L_y}\\right)$.\n\n  Case $4$ (general blob with strong damping):\n  - Curvature parameter: $\\kappa = 0.02$.\n  - Damping parameter: $\\nu = 0.5$.\n  - Blob parameters: $A = 1.0$, $\\sigma = 5.0$, $x_0 = L_x/2$, $y_0 = L_y/2$.\n  - Fields: $\\phi(x,y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{\\sigma^2}\\right)$, and $n(x,y) = \\phi(x,y)$.\n\n- Final output format: Your program should produce a single line of output containing the four RMS values as a comma-separated list enclosed in square brackets (for example, $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$). Each RMS value must be a floating-point number.\n\nThe problem requires you to begin from the physical and mathematical foundations listed above, derive the discrete expression for $\\partial_t \\Omega$ that accounts for the nonlinear advection by $\\mathbf{v}_E$, the curvature drive $\\mathcal{K}(p)$, and the damping term, and then implement it numerically for the specified test suite. The use of dimensionless units must be maintained throughout, and periodic boundary conditions must be applied in both directions when computing spatial derivatives. The final output must adhere strictly to the specified single-line format, with the results in order for cases $1$ through $4$.",
            "solution": "The problem statement has been validated and is determined to be scientifically grounded, well-posed, and complete. We can therefore proceed with the derivation and solution.\n\nThe objective is to compute the time derivative of the vorticity field, $\\partial_t \\Omega$, for a simplified model of interchange-driven plasma turbulence. The model is defined in a two-dimensional slab geometry perpendicular to a uniform magnetic field $\\mathbf{B}$. All quantities are dimensionless, expressed in Bohm-normalized units.\n\nThe governing equation for the evolution of vorticity, $\\Omega$, in this system is derived from the material derivative, which describes how the vorticity at a point changes in time due to advection, curvature-driven interchange instability, and dissipation.\n\nThe fluid velocity is the $\\mathbf{E} \\times \\mathbf{B}$ drift, given in normalized units by $\\mathbf{v}_E = \\hat{\\mathbf{z}} \\times \\nabla \\phi$. With $\\nabla \\phi = (\\partial_x \\phi)\\hat{\\mathbf{x}} + (\\partial_y \\phi)\\hat{\\mathbf{y}}$, the velocity components are $v_x = -\\partial_y \\phi$ and $v_y = \\partial_x \\phi$. The advection of vorticity by this flow is given by the advective derivative:\n$$\n(\\mathbf{v}_E \\cdot \\nabla) \\Omega = v_x \\frac{\\partial \\Omega}{\\partial x} + v_y \\frac{\\partial \\Omega}{\\partial y} = (-\\partial_y \\phi)(\\partial_x \\Omega) + (\\partial_x \\phi)(\\partial_y \\Omega) = \\partial_x \\phi \\partial_y \\Omega - \\partial_y \\phi \\partial_x \\Omega\n$$\nThis is identical to the definition of the Poisson bracket provided in the problem: $\\{\\phi, \\Omega\\} = \\partial_x \\phi \\partial_y \\Omega - \\partial_y \\phi \\partial_x \\Omega$. Thus, the advection term is simply $\\{\\phi, \\Omega\\}$.\n\nThe vorticity evolution equation balances the material derivative against the source and sink terms. The material derivative is $\\frac{d\\Omega}{dt} = \\frac{\\partial \\Omega}{\\partial t} + (\\mathbf{v}_E \\cdot \\nabla) \\Omega$. The specified source term is the curvature drive $\\mathcal{K}(p) = \\kappa \\, \\partial_y n$, and the sink term is the linear damping $-\\nu \\Omega$. The full equation is:\n$$\n\\frac{\\partial \\Omega}{\\partial t} + (\\mathbf{v}_E \\cdot \\nabla) \\Omega = \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\nSubstituting the expression for the advection term:\n$$\n\\frac{\\partial \\Omega}{\\partial t} + \\{\\phi, \\Omega\\} = \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\nSolving for the local time derivative $\\partial_t \\Omega$ yields the final continuous equation to be implemented:\n$$\n\\partial_t \\Omega = -\\{\\phi, \\Omega\\} + \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\nThe vorticity $\\Omega$ itself is not an independent field but is defined via the polarization closure relation $\\Omega = \\nabla_\\perp^2 \\phi$.\n\nNext, we discretize this equation on a uniform Cartesian grid of size $L_x \\times L_y$ with $N_x \\times N_y$ points. The grid spacings are $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$. A field $f(x,y)$ is represented by its values $f_{i,j}$ at grid points $(x_i, y_j) = (i\\Delta x, j\\Delta y)$ for $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$.\n\nWe use second-order centered finite differences for all spatial derivatives, implementing periodic boundary conditions. For a field $f_{i,j}$:\nThe partial derivative with respect to $x$ is:\n$$\n(\\partial_x f)_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x}\n$$\nThe partial derivative with respect to $y$ is:\n$$\n(\\partial_y f)_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y}\n$$\nThe perpendicular Laplacian $\\nabla_\\perp^2 = \\partial_x^2 + \\partial_y^2$ is:\n$$\n(\\nabla_\\perp^2 f)_{i,j} \\approx \\frac{f_{i+1,j} - 2f_{i,j} + f_{i-1,j}}{(\\Delta x)^2} + \\frac{f_{i,j+1} - 2f_{i,j} + f_{i-1,j}}{(\\Delta y)^2}\n$$\nPeriodicity is enforced by wrapping indices, e.g., $f_{N_x,j} = f_{0,j}$ and $f_{-1,j} = f_{N_x-1,j}$.\n\nThe computational algorithm proceeds as follows:\n$1$. For each test case, define the parameters and construct the discrete initial fields $\\phi_{i,j}$ and $n_{i,j}$ on the $N_x \\times N_y$ grid.\n$2$. Compute the discrete vorticity field $\\Omega_{i,j}$ using the finite-difference Laplacian operator: $\\Omega_{i,j} = (\\nabla_\\perp^2 \\phi)_{i,j}$.\n$3$. Compute the necessary first-order spatial derivatives using the finite-difference gradient operators: $(\\partial_x\\phi)_{i,j}$, $(\\partial_y\\phi)_{i,j}$, $(\\partial_x\\Omega)_{i,j}$, $(\\partial_y\\Omega)_{i,j}$, and $(\\partial_y n)_{i,j}$.\n$4$. Assemble the discrete time derivative of vorticity, $(\\partial_t \\Omega)_{i,j}$, for each grid point $(i,j)$:\n$$\n(\\partial_t \\Omega)_{i,j} = -\\left( (\\partial_x \\phi)_{i,j} (\\partial_y \\Omega)_{i,j} - (\\partial_y \\phi)_{i,j} (\\partial_x \\Omega)_{i,j} \\right) + \\kappa (\\partial_y n)_{i,j} - \\nu \\Omega_{i,j}\n$$\n$5$. Calculate the root mean square (RMS) magnitude of the resulting $(\\partial_t \\Omega)_{i,j}$ field over the entire domain:\n$$\n\\mathrm{RMS}(\\partial_t \\Omega) = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} \\left( (\\partial_t \\Omega)_{i,j} \\right)^2 }\n$$\nThis procedure is applied to each of the four specified test cases to obtain the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMS of the time derivative of vorticity for four test cases\n    based on a simplified model of plasma interchange turbulence.\n    \"\"\"\n\n    # Common grid parameters for all cases\n    Lx, Ly = 40.0, 40.0\n    Nx, Ny = 64, 64\n    dx, dy = Lx / Nx, Ly / Ny\n\n    # Test suite and parameter specification\n    test_cases = [\n        # Case 1: General blob with curvature and weak damping\n        {'kappa': 0.02, 'nu': 0.005, 'case_type': 'gaussian_blob', 'A': 1.0, 'sigma': 5.0},\n        # Case 2: Uniform zero fields\n        {'kappa': 0.02, 'nu': 0.005, 'case_type': 'zero_fields'},\n        # Case 3: Curvature-only drive with sinusoidal density\n        {'kappa': 0.05, 'nu': 0.0, 'case_type': 'sinusoidal_density'},\n        # Case 4: General blob with strong damping\n        {'kappa': 0.02, 'nu': 0.5, 'case_type': 'gaussian_blob', 'A': 1.0, 'sigma': 5.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        # 1. Set up grid\n        x = np.linspace(0, Lx, Nx, endpoint=False)\n        y = np.linspace(0, Ly, Ny, endpoint=False)\n        X, Y = np.meshgrid(x, y, indexing='ij')\n\n        # 2. Define finite difference operators with periodic boundaries\n        def grad_x(f):\n            return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * dx)\n\n        def grad_y(f):\n            return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * dy)\n\n        def laplacian(f):\n            d2f_dx2 = (np.roll(f, -1, axis=0) - 2 * f + np.roll(f, 1, axis=0)) / (dx**2)\n            d2f_dy2 = (np.roll(f, -1, axis=1) - 2 * f + np.roll(f, 1, axis=1)) / (dy**2)\n            return d2f_dx2 + d2f_dy2\n\n        # 3. Construct initial fields n(x,y) and phi(x,y)\n        phi = np.zeros((Nx, Ny))\n        n = np.zeros((Nx, Ny))\n        case_type = params['case_type']\n\n        if case_type == 'gaussian_blob':\n            A = params['A']\n            sigma = params['sigma']\n            x0, y0 = Lx / 2, Ly / 2\n            blob = A * np.exp(-((X - x0)**2 + (Y - y0)**2) / sigma**2)\n            phi = blob\n            n = blob\n        elif case_type == 'zero_fields':\n            # Fields are already initialized to zero\n            pass\n        elif case_type == 'sinusoidal_density':\n            phi = np.zeros((Nx, Ny))\n            n = 1.0 + np.sin(2 * np.pi * Y / Ly)\n\n        # 4. Compute d(Omega)/dt\n        kappa = params['kappa']\n        nu = params['nu']\n\n        # Compute vorticity Omega = laplacian(phi)\n        Omega = laplacian(phi)\n\n        # Compute terms for the Poisson bracket {phi, Omega}\n        dphi_dx = grad_x(phi)\n        dphi_dy = grad_y(phi)\n        dOmega_dx = grad_x(Omega)\n        dOmega_dy = grad_y(Omega)\n        poisson_bracket = dphi_dx * dOmega_dy - dphi_dy * dOmega_dx\n\n        # Compute curvature drive term\n        dn_dy = grad_y(n)\n        curvature_term = kappa * dn_dy\n\n        # Compute damping term\n        damping_term = -nu * Omega\n\n        # Assemble the time derivative of vorticity with corrected advection sign\n        dOmega_dt = -poisson_bracket + curvature_term + damping_term\n\n        # 5. Calculate the domain-wide RMS magnitude\n        rms_val = np.sqrt(np.mean(dOmega_dt**2))\n        results.append(rms_val)\n\n    # Final print statement in the exact required format.\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Writing a simulation code is incomplete without rigorously verifying its correctness. This practice focuses on the Method of Manufactured Solutions (MMS), a powerful and standard technique for confirming that a numerical solver achieves its designed order of accuracy . This conceptual challenge will deepen your understanding of how to design and interpret verification tests for complex, nonlinear PDEs, a critical skill for developing reliable scientific software.",
            "id": "4200189",
            "problem": "Consider an electrostatic drift-fluid model of edge plasma blob dynamics in a slab geometry, where the vorticity field is defined by $ \\omega = \\nabla_\\perp^2 \\phi $ under the Boussinesq approximation. The vorticity equation can be written as a partial differential equation (PDE)\n$$\n\\partial_t \\omega + \\mathbf{v}_{E} \\cdot \\nabla \\omega = \\mathcal{C}(n, \\phi) + \\nu \\nabla_\\perp^2 \\omega - \\sigma \\,\\omega + S(x,y,t),\n$$\nwhere $ \\mathbf{v}_E = - \\frac{c}{B_0} \\nabla \\phi \\times \\hat{\\mathbf{z}} $ is the electric field cross magnetic field (E×B) drift, $ \\mathcal{C}(n, \\phi) $ represents curvature-driven interchange terms coupling density $ n $ and potential $ \\phi $, $ \\nu $ is a perpendicular viscosity, $ \\sigma $ is an effective linear sheath damping coefficient, and $ S(x,y,t) $ is a volumetric source term. The numerical code to be verified uses $ p $-th order accurate central finite difference (FD) stencils in space and a $ q $-th order explicit Runge–Kutta (RK) time integrator.\n\nThe Method of Manufactured Solutions (MMS) is to be used to verify both spatial and temporal convergence of this vorticity solver, including the presence of nonlinear advection $ \\mathbf{v}_E \\cdot \\nabla \\omega $, curvature, dissipation, and sheath damping. Error norms such as the $ L^2 $ norm,\n$$\n\\| e \\|_2 = \\left( \\frac{1}{A} \\int_\\Omega | \\omega_{\\text{num}} - \\omega_{\\text{exact}} |^2 \\, dA \\right)^{1/2},\n$$\nand the $ L^\\infty $ norm,\n$$\n\\| e \\|_\\infty = \\max_{\\mathbf{x} \\in \\Omega} | \\omega_{\\text{num}}(\\mathbf{x},t) - \\omega_{\\text{exact}}(\\mathbf{x},t) |,\n$$\nare computed over the domain $ \\Omega $ with area $ A $.\n\nWhich of the following statements correctly describe how to apply the Method of Manufactured Solutions (MMS) to this blob vorticity PDE and how to use it to verify spatial and temporal convergence rates?\n\nA. Choose smooth, nontrivial manufactured fields $ \\phi_M(x,y,t) $ and $ n_M(x,y,t) $ that excite every term in the PDE, form $ \\omega_M = \\nabla_\\perp^2 \\phi_M $, and compute the exact source $ S_M(x,y,t) $ by substituting $ \\omega_M $, $ \\phi_M $, and $ n_M $ into the continuous PDE operators (including $ \\mathbf{v}_E(\\phi_M) \\cdot \\nabla \\omega_M $, $ \\mathcal{C}(n_M,\\phi_M) $, $ \\nu \\nabla_\\perp^2 \\omega_M $, and $ \\sigma \\omega_M $). Impose boundary conditions consistent with the manufactured solution, then perform grid and time-step refinement studies: for spatial order, make $ \\Delta t $ sufficiently small to render temporal error negligible; for temporal order, make $ \\Delta x $ and $ \\Delta y $ sufficiently small to render spatial error negligible. The observed orders in $ L^2 $ and $ L^\\infty $ norms should match $ p $ and $ q $ when isolated.\n\nB. To ensure a vanishing residual, compute the source by applying the same discrete FD and RK operators used by the solver to the manufactured fields on the grid (rather than continuous differential operators), so that the numerical solution matches $ \\omega_M $ to machine precision for any $ \\Delta x $, $ \\Delta y $, and $ \\Delta t $ and thus confirms convergence.\n\nC. To measure spatial order $ p $, keep $ \\Delta t $ fixed at a large value so that temporal error dominates; the slope of $ \\log \\| e \\| $ versus $ \\log \\Delta x $ will still reveal $ p $ because the temporal error is a constant offset.\n\nD. When sheath boundary conditions are present, MMS forcing should be added only in the interior; one can retain the solver’s default homogeneous Neumann boundaries because smooth manufactured solutions ensure boundary effects do not influence convergence rates.\n\nE. In anisotropic meshes where $ \\Delta x \\neq \\Delta y $, either refine both spatial directions together and tie $ \\Delta t $ to the refinement to balance error contributions (for example, choose $ \\Delta t \\propto h^{p/q} $ with $ h = \\max\\{\\Delta x, \\Delta y\\} $), or perform separate studies holding two of the three resolutions asymptotically small. Otherwise, mixed-error contamination can mask the true spatial and temporal orders.\n\nF. The manufactured solution should be constructed so that the nonlinear advection $ \\mathbf{v}_E \\cdot \\nabla \\omega $, curvature interchange $ \\mathcal{C}(n,\\phi) $, viscous diffusion $ \\nu \\nabla_\\perp^2 \\omega $, and sheath damping $ \\sigma \\omega $ are all active; if any term is identically zero under the manufactured fields, the MMS study cannot verify the discretization of that term and may yield overly optimistic convergence claims.\n\nSelect all that apply.",
            "solution": "The Method of Manufactured Solutions (MMS) is a rigorous procedure for verifying the order of accuracy of a numerical solver for a partial differential equation (PDE). The fundamental principle is to choose an analytical solution, the \"manufactured solution,\" and insert it into the continuous PDE. Since this chosen function is not, in general, a true solution to the original PDE (e.g., with a zero source term), its insertion will produce a residual. This residual is then defined as the source term for a modified PDE. By design, the manufactured solution is the exact analytical solution to this modified PDE. The numerical code is then used to solve this modified problem, and the error between the numerical solution and the known manufactured solution is measured. By systematically refining the discretization parameters (grid spacing and time step), one can measure the rate at which this error decreases, which should correspond to the theoretical order of accuracy of the numerical schemes employed.\n\nThe given PDE is the vorticity equation:\n$$\n\\partial_t \\omega + \\mathbf{v}_{E} \\cdot \\nabla \\omega = \\mathcal{C}(n, \\phi) + \\nu \\nabla_\\perp^2 \\omega - \\sigma \\,\\omega + S(x,y,t)\n$$\nHere, the solution variables are coupled, primarily through the vorticity definition $ \\omega = \\nabla_\\perp^2 \\phi $ and the advection/curvature terms. For MMS, we must manufacture solutions for the fundamental fields, say $ n_M(x,y,t) $ and $ \\phi_M(x,y,t) $. From these, we can derive all other necessary quantities:\n-   Manufactured potential: $ \\phi_M(x,y,t) $\n-   Manufactured density: $ n_M(x,y,t) $\n-   Manufactured vorticity: $ \\omega_M = \\nabla_\\perp^2 \\phi_M $\n-   Manufactured velocity: $ \\mathbf{v}_{E,M} = - \\frac{c}{B_0} \\nabla \\phi_M \\times \\hat{\\mathbf{z}} $\n\nThe manufactured source term $ S_M(x,y,t) $ is then calculated by substituting these manufactured fields into the PDE:\n$$\nS_M = \\partial_t \\omega_M + \\mathbf{v}_{E,M} \\cdot \\nabla \\omega_M - \\mathcal{C}(n_M, \\phi_M) - \\nu \\nabla_\\perp^2 \\omega_M + \\sigma \\omega_M\n$$\nThe numerical code then solves the PDE with this source term $ S_M $. The numerical solution $ \\omega_{\\text{num}} $ is compared against the exact solution $ \\omega_M $. The error $ e = \\omega_{\\text{num}} - \\omega_M $ is expected to scale as $ \\|e\\| \\approx C_{sp} h^p + C_t (\\Delta t)^q $, where $ h $ is a measure of spatial grid size (like $ \\max\\{\\Delta x, \\Delta y\\} $), for a scheme that is $ p $-th order in space and $ q $-th order in time.\n\nNow, we evaluate each option based on these principles.\n\n**A. Choose smooth, nontrivial manufactured fields $ \\phi_M(x,y,t) $ and $ n_M(x,y,t) $ that excite every term in the PDE, form $ \\omega_M = \\nabla_\\perp^2 \\phi_M $, and compute the exact source $ S_M(x,y,t) $ by substituting $ \\omega_M $, $ \\phi_M $, and $ n_M $ into the continuous PDE operators (including $ \\mathbf{v}_E(\\phi_M) \\cdot \\nabla \\omega_M $, $ \\mathcal{C}(n_M,\\phi_M) $, $ \\nu \\nabla_\\perp^2 \\omega_M $, and $ \\sigma \\omega_M $). Impose boundary conditions consistent with the manufactured solution, then perform grid and time-step refinement studies: for spatial order, make $ \\Delta t $ sufficiently small to render temporal error negligible; for temporal order, make $ \\Delta x $ and $ \\Delta y $ sufficiently small to render spatial error negligible. The observed orders in $ L^2 $ and $ L^\\infty $ norms should match $ p $ and $ q $ when isolated.**\n\nThis statement provides a complete and correct summary of the MMS procedure. It correctly specifies:\n1.  The choice of smooth, nontrivial manufactured solutions that exercise all terms of the PDE.\n2.  The calculation of the source term by substituting the manufactured solution into the *continuous* operators.\n3.  The necessity of imposing boundary conditions consistent with the manufactured solution.\n4.  The correct methodology for isolating spatial and temporal errors in convergence studies by making the other error sources subdominant.\n5.  The expected outcome: the measured convergence rates should match the theoretical orders of the numerical methods.\n\nVerdict: **Correct**.\n\n**B. To ensure a vanishing residual, compute the source by applying the same discrete FD and RK operators used by the solver to the manufactured fields on the grid (rather than continuous differential operators), so that the numerical solution matches $ \\omega_M $ to machine precision for any $ \\Delta x $, $ \\Delta y $, and $ \\Delta t $ and thus confirms convergence.**\n\nThis statement describes a different, much weaker, verification test, sometimes called a \"zero-error\" or \"discrete-residual\" test. If the source term is calculated using the discrete operators ($ \\hat{L}_h $) applied to the manufactured solution ($ S_M^{\\text{discrete}} = \\hat{L}_h(\\omega_M) $), then the numerical solver is tasked with solving $ \\hat{L}_h(\\omega_{\\text{num}}) = S_M^{\\text{discrete}} $. By construction, $ \\omega_{\\text{num}} = \\omega_M $ is the exact solution to this discrete system, resulting in an error that is zero to machine precision, irrespective of $ \\Delta x $, $ \\Delta y $, or $ \\Delta t $. This test verifies that the source term is implemented correctly, but it does *not* test the accuracy of the discrete operators relative to their continuous counterparts. It cannot measure convergence rates. The core of MMS is to measure the truncation error, which is the difference between the continuous and discrete operators acting on the exact solution; this procedure nullifies the truncation error by definition.\n\nVerdict: **Incorrect**.\n\n**C. To measure spatial order $ p $, keep $ \\Delta t $ fixed at a large value so that temporal error dominates; the slope of $ \\log \\| e \\| $ versus $ \\log \\Delta x $ will still reveal $ p $ because the temporal error is a constant offset.**\n\nThis statement misinterprets how different error sources combine. The total error behaves approximately as $ \\|e\\| \\approx C_{sp}h^p + C_t(\\Delta t)^q $. If $ \\Delta t $ is fixed and large, the term $ C_t(\\Delta t)^q $ will be a large, constant value. As the spatial grid is refined ($ h \\to 0 $), the spatial error term $ C_{sp}h^p $ will decrease and become much smaller than the dominant, constant temporal error. Thus, the total error $ \\|e\\| $ will approach a constant floor, $ \\|e\\| \\to C_t(\\Delta t)^q $. On a log-log plot of $ \\|e\\| $ versus $ h $, the curve will become flat, showing a slope of $ 0 $, which completely masks the spatial order $ p $. To measure $ p $, the temporal error must be negligible, which requires making $ \\Delta t $ sufficiently small.\n\nVerdict: **Incorrect**.\n\n**D. When sheath boundary conditions are present, MMS forcing should be added only in the interior; one can retain the solver’s default homogeneous Neumann boundaries because smooth manufactured solutions ensure boundary effects do not influence convergence rates.**\n\nThis is incorrect. For the manufactured function $ \\omega_M $ to be the true solution of the numerical problem, the boundary conditions (BCs) imposed in the simulation must be derived from $ \\omega_M $. For example, if the solver uses Dirichlet BCs, one must impose $ \\omega|_{\\partial\\Omega} = \\omega_M|_{\\partial\\Omega} $. If it uses Neumann BCs, one must impose $ \\nabla \\omega \\cdot \\mathbf{\\hat{n}}|_{\\partial\\Omega} = \\nabla \\omega_M \\cdot \\mathbf{\\hat{n}}|_{\\partial\\Omega} $. Using arbitrary BCs, such as homogeneous Neumann ($ \\nabla \\omega \\cdot \\mathbf{\\hat{n}} = 0 $), introduces an inconsistency unless the manufactured solution happens to satisfy this condition. This inconsistency creates a boundary error that can contaminate the solution throughout the domain and corrupt the convergence study, often preventing the method from achieving its design order of accuracy. The smoothness of $ \\omega_M $ does not eliminate this requirement.\n\nVerdict: **Incorrect**.\n\n**E. In anisotropic meshes where $ \\Delta x \\neq \\Delta y $, either refine both spatial directions together and tie $ \\Delta t $ to the refinement to balance error contributions (for example, choose $ \\Delta t \\propto h^{p/q} $ with $ h = \\max\\{\\Delta x, \\Delta y\\} $), or perform separate studies holding two of the three resolutions asymptotically small. Otherwise, mixed-error contamination can mask the true spatial and temporal orders.**\n\nThis statement correctly identifies the problem of error contamination from multiple discretization parameters ($ \\Delta x $, $ \\Delta y $, $ \\Delta t $) and presents valid strategies to mitigate it. The total error is a sum of contributions from each dimension: $ \\|e\\| \\approx C_x(\\Delta x)^p + C_y(\\Delta y)^p + C_t(\\Delta t)^q $.\n1.  **Coordinated Refinement:** By setting $ \\Delta x \\propto h $, $ \\Delta y \\propto h $, and $ \\Delta t \\propto h^{p/q} $, all error terms are made to scale like $ h^p $. The observed convergence rate will then be $ p $, confirming the spatial accuracy, provided the time-stepping choice was appropriate. This is a common and efficient approach.\n2.  **Isolation:** Alternatively, one can measure convergence in one direction at a time by making the grid/time step in the other directions so small that their error contributions are negligible. For instance, to measure convergence in $ x $, fix $ \\Delta y $ and $ \\Delta t $ to very small values and refine only $ \\Delta x $.\nThe warning that mixed-error contamination can obscure the true convergence orders is accurate and justifies these careful procedures.\n\nVerdict: **Correct**.\n\n**F. The manufactured solution should be constructed so that the nonlinear advection $ \\mathbf{v}_E \\cdot \\nabla \\omega $, curvature interchange $ \\mathcal{C}(n,\\phi) $, viscous diffusion $ \\nu \\nabla_\\perp^2 \\omega $, and sheath damping $ \\sigma \\omega $ are all active; if any term is identically zero under the manufactured fields, the MMS study cannot verify the discretization of that term and may yield overly optimistic convergence claims.**\n\nThis statement highlights a critical aspect of designing a useful MMS test. The purpose of the test is to verify the correct implementation of the *entire* numerical algorithm. If the manufactured solution causes a term in the PDE to be identically zero (e.g., choosing a constant $ \\phi_M $ would make $ \\mathbf{v}_E = \\mathbf{0} $ and the advection term disappear), then the part of the code that discretizes that term is never executed or tested. A bug in that part of the code would go undetected. The test would still show the expected convergence rate for the simplified PDE, leading to a false sense of confidence in the code's correctness. Therefore, a good manufactured solution must be sufficiently general to exercise all terms in the equation.\n\nVerdict: **Correct**.",
            "answer": "$$\\boxed{AEF}$$"
        }
    ]
}