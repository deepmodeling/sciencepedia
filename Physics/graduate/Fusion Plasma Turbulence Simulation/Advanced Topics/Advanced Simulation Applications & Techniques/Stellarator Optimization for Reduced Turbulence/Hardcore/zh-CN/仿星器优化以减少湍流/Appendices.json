{
    "hands_on_practices": [
        {
            "introduction": "要理解仿星器中的湍流，我们首先必须掌握带电粒子和波如何沿着复杂的磁力线运动。这个练习将指导您在一个简化的环形几何中，构建一个基础性的物理算子——平行流算子。通过这项实践，您将亲手建立起磁场结构（以旋转变换 $ \\iota $ 为代表）与关键动理学效应之间的联系，这是量化几何对湍流影响的重要的第一步。",
            "id": "4201414",
            "problem": "要求您在一种大环径比的环形几何中实现场线跟踪坐标变换，并对于给定的旋转变换剖面 $\\iota(\\psi)$，计算沿选定磁场线作用于标量场上的平行流项 $v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla$。首要动机是量化一个可用于仿星器优化以减弱湍流的流强度度量。程序必须是一个完整的、可运行的 Python 脚本，为一系列测试用例执行以下任务。\n\n基本基础和定义：考虑一个静磁场 $\\mathbf{B}$，满足 $\\nabla\\cdot\\mathbf{B}=0$，且场线沿单位矢量 $\\mathbf{b}=\\mathbf{B}/|\\mathbf{B}|$ 分布。在一个大半径为 $R_0$、小半径为 $r\\in[0,a]$ 的圆形截面环中，定义柱坐标角 $(\\theta,\\phi)$，其中 $\\theta$ 是角向角，$\\phi$ 是环向角。位置映射为 $R(\\theta)=R_0+r\\cos\\theta$ 和 $Z(\\theta)=r\\sin\\theta$，其中 $R(\\theta)$ 用作方位尺度因子。在正交坐标系 $(r,\\theta,\\phi)$ 中，其尺度因子为 $h_r=1$、$h_\\theta=r$ 和 $h_\\phi=R(\\theta)$，作用于标量 $f(r,\\theta,\\phi)$ 的梯度算子为\n$$\n\\nabla f=\\frac{\\partial f}{\\partial r}\\,\\mathbf{e}_r+\\frac{1}{r}\\frac{\\partial f}{\\partial \\theta}\\,\\mathbf{e}_\\theta+\\frac{1}{R(\\theta)}\\frac{\\partial f}{\\partial \\phi}\\,\\mathbf{e}_\\phi.\n$$\n假设一个占主导地位的环向磁场 $B_\\phi(\\theta)=B_0\\,\\frac{R_0}{R(\\theta)}$ 和一个角向磁场 $B_\\theta(\\theta)$，选择后者以通过场线关系实现期望的旋转变换 $\\iota(\\psi)$\n$$\n\\frac{d\\theta}{d\\phi}=\\frac{\\mathbf{B}\\cdot\\nabla\\theta}{\\mathbf{B}\\cdot\\nabla\\phi}=\\iota(\\psi)=\\frac{B_\\theta(\\theta)\\,R(\\theta)}{B_\\phi(\\theta)\\,r},\n$$\n这得到 $B_\\theta(\\theta)=\\iota(\\psi)\\,B_\\phi(\\theta)\\,\\frac{r}{R(\\theta)}$。视 $r$ 沿场线为常数（无径向漂移），因此 $\\psi$ 仅依赖于 $r$。使用一个无量纲磁通标签\n$$\n\\psi=\\left(\\frac{r}{a}\\right)^2.\n$$\n通过以下方式定义场线跟踪坐标变换 $(\\psi,\\theta,\\phi)\\mapsto(\\psi,\\alpha,\\phi)$\n$$\n\\alpha=\\theta-\\iota(\\psi)\\,\\phi,\n$$\n因此，在固定的 $\\psi$ 下，一条磁场线是一条由 $\\phi$ 参数化的常数 $\\alpha$ 曲线。\n\n平行流算子：我们感兴趣的算子是作用于无量纲标量场 $g(\\psi,\\theta,\\phi)$ 的 $v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla$。沿着一个具有固定 $\\psi$ 和常数 $\\alpha$ 的磁场线，用 $(\\theta(\\phi),\\phi)$ 和局域磁场来表示该算子。\n\n标量场设定：使用一个无量纲标量场\n$$\ng(\\psi,\\theta,\\phi)=\\sin\\!\\big(m_1\\,\\theta+n_1\\,\\phi\\big)+c_2\\,\\cos\\!\\big(p_2\\,\\theta-q_2\\,\\phi\\big),\n$$\n其中 $m_1,n_1,p_2,q_2$ 为整数，$c_2$ 为实数振幅。角度必须以弧度为单位。\n\n任务要求：\n- 实现坐标变换 $\\alpha=\\theta-\\iota(\\psi)\\,\\phi$ 并用 $\\alpha=\\text{常数}$ 和 $\\psi=\\text{常数}$ 来表示一条场线。\n- 对于给定的 $\\iota(\\psi)$，沿场线计算 $\\phi\\in[0,2\\pi)$ 范围内的 $\\theta(\\phi)=\\alpha+\\iota(\\psi)\\,\\phi$。\n- 计算 $R(\\theta)$、$B_\\phi(\\theta)=B_0\\,\\frac{R_0}{R(\\theta)}$、$B_\\theta(\\theta)=\\iota(\\psi)\\,B_\\phi(\\theta)\\,\\frac{r}{R(\\theta)}$ 以及 $|\\mathbf{B}(\\theta)|=\\sqrt{B_\\phi(\\theta)^2+B_\\theta(\\theta)^2}$。\n- 沿场线计算平行流项 $v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla g$，并返回一个流强度度量，该度量定义为一个环向行程内的均方根值，\n$$\nS_{\\mathrm{RMS}}=\\left(\\frac{1}{2\\pi}\\int_0^{2\\pi}\\big[v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla g\\big]^2\\,d\\phi\\right)^{1/2}.\n$$\n- 最终答案以 $\\mathrm{s}^{-1}$ 为单位表示，并四舍五入到六位小数。\n\n旋转变换剖面：使用一个多项式剖面\n$$\n\\iota(\\psi)=\\iota_0+s_1\\,\\psi+s_2\\,\\psi^2,\n$$\n其中 $\\iota_0$、$s_1$ 和 $s_2$ 是实数参数。\n\n测试套件与覆盖范围：您的程序必须对以下四个测试用例计算 $S_{\\mathrm{RMS}}$，涵盖一般情况、近轴行为、高旋转变换和强几何变化。所有角度均以弧度为单位。所有长度均以米为单位。磁场以特斯拉为单位。平行速度以米/秒为单位。如上所定义，磁通标签 $\\psi$ 是无量纲的。标量场 $g$ 的参数是无量纲的。\n\n- 测试用例 $1$ (一般情况):\n    - $R_0=3.0$, $a=0.3$, $r=0.15$, $B_0=3.0$, $v_{\\parallel}=1.0\\times 10^5$, $\\alpha=0.2$,\n    - $\\iota_0=0.4$, $s_1=0.3$, $s_2=0.0$,\n    - $m_1=2$, $n_1=1$, $c_2=0.35$, $p_2=3$, $q_2=2$.\n\n- 测试用例 $2$ (近轴极限):\n    - $R_0=3.0$, $a=0.3$, $r=1.0\\times 10^{-6}$, $B_0=3.0$, $v_{\\parallel}=1.0\\times 10^5$, $\\alpha=0.0$,\n    - $\\iota_0=0.8$, $s_1=0.0$, $s_2=0.0$,\n    - $m_1=1$, $n_1=3$, $c_2=0.20$, $p_2=4$, $q_2=1$.\n\n- 测试用例 $3$ (带有剪切和曲率的高旋转变换):\n    - $R_0=1.5$, $a=0.5$, $r=0.25$, $B_0=2.5$, $v_{\\parallel}=2.0\\times 10^5$, $\\alpha=1.0$,\n    - $\\iota_0=1.0$, $s_1=-0.5$, $s_2=0.2$,\n    - $m_1=3$, $n_1=2$, $c_2=0.40$, $p_2=1$, $q_2=3$.\n\n- 测试用例 $4$ (强几何变化，低旋转变换基线):\n    - $R_0=4.0$, $a=0.8$, $r=0.4$, $B_0=5.0$, $v_{\\parallel}=0.5\\times 10^5$, $\\alpha=2.0$,\n    - $\\iota_0=0.2$, $s_1=0.6$, $s_2=-0.1$,\n    - $m_1=5$, $n_1=0$, $c_2=0.0$, $p_2=0$, $q_2=0$.\n\n数值积分与输出：\n- 使用在 $\\phi\\in[0,2\\pi)$ 范围内的 $N=4096$ 个点的均匀离散化来近似 $\\phi$ 上的积分。\n- 您的程序应产生单行输出，其中包含一个由逗号分隔的四个浮点数列表，每个数都四舍五入到六位小数，以 $\\mathrm{s}^{-1}$ 为单位，并用方括号括起来（例如，“[$x_1,x_2,x_3,x_4$]”）。",
            "solution": "该问题已经过验证，并被确定为等离子体物理领域内一个适定的、有科学依据的计算任务。我们将提供完整的解决方案。目标是在简化的环形磁几何中，计算沿磁场线作用于标量场的流强度度量 $S_{\\mathrm{RMS}}$。这需要推导平行流算子，然后实现一个数值程序来评估其均方根（RMS）值。\n\n首先，我们确定平行流算子 $v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla$ 的解析形式。在指定的正交坐标系 $(r,\\theta,\\phi)$ 中，其尺度因子为 $h_r=1$、$h_\\theta=r$ 和 $h_\\phi=R(\\theta)=R_0+r\\cos\\theta$，标量场 $f(r,\\theta,\\phi)$ 的梯度由下式给出：\n$$\n\\nabla f = \\frac{\\partial f}{\\partial r}\\,\\mathbf{e}_r + \\frac{1}{r}\\frac{\\partial f}{\\partial \\theta}\\,\\mathbf{e}_\\theta + \\frac{1}{R(\\theta)}\\frac{\\partial f}{\\partial \\phi}\\,\\mathbf{e}_\\phi\n$$\n问题定义了一个静磁场 $\\mathbf{B}$，并假设场线位于恒定半径 $r$ 的曲面上。这意味着磁场的径向分量 $B_r$ 为零。因此，磁场可以写为：\n$$\n\\mathbf{B} = B_\\theta(\\theta)\\,\\mathbf{e}_\\theta + B_\\phi(\\theta)\\,\\mathbf{e}_\\phi\n$$\n沿磁场的单位矢量为 $\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$。算子 $\\mathbf{B}\\cdot\\nabla$ 作用于标量场 $g(r, \\theta, \\phi)$ 的结果是：\n$$\n\\mathbf{B}\\cdot\\nabla g = \\left( B_\\theta\\,\\mathbf{e}_\\theta + B_\\phi\\,\\mathbf{e}_\\phi \\right) \\cdot \\left( \\frac{\\partial g}{\\partial r}\\,\\mathbf{e}_r + \\frac{1}{r}\\frac{\\partial g}{\\partial \\theta}\\,\\mathbf{e}_\\theta + \\frac{1}{R(\\theta)}\\frac{\\partial g}{\\partial \\phi}\\,\\mathbf{e}_\\phi \\right)\n$$\n由于基矢量的正交性以及 $B_r=0$，上式简化为：\n$$\n\\mathbf{B}\\cdot\\nabla g = \\frac{B_\\theta(\\theta)}{r}\\frac{\\partial g}{\\partial \\theta} + \\frac{B_\\phi(\\theta)}{R(\\theta)}\\frac{\\partial g}{\\partial \\phi}\n$$\n偏导数是相对于坐标 $(\\psi, \\theta, \\phi)$（或等效地 $(r, \\theta, \\phi)$，因为 $\\psi$ 仅是 $r$ 的函数）求的，同时保持其他坐标不变。因此，平行梯度算子 $\\mathbf{b}\\cdot\\nabla g$ 是：\n$$\n\\mathbf{b}\\cdot\\nabla g = \\frac{\\mathbf{B}\\cdot\\nabla g}{|\\mathbf{B}|} = \\frac{1}{|\\mathbf{B}(\\theta)|} \\left( \\frac{B_\\theta(\\theta)}{r}\\frac{\\partial g}{\\partial \\theta} + \\frac{B_\\phi(\\theta)}{R(\\theta)}\\frac{\\partial g}{\\partial \\phi} \\right)\n$$\n其中 $|\\mathbf{B}(\\theta)| = \\sqrt{B_\\phi(\\theta)^2 + B_\\theta(\\theta)^2}$。\n\n角向磁场 $B_\\theta(\\theta)$ 通过旋转变换 $\\iota(\\psi)$ 定义为 $B_\\theta(\\theta)=\\iota(\\psi)\\,B_\\phi(\\theta)\\,\\frac{r}{R(\\theta)}$。将此代入 $\\mathbf{b}\\cdot\\nabla g$ 的表达式中：\n$$\n\\mathbf{b}\\cdot\\nabla g = \\frac{1}{|\\mathbf{B}(\\theta)|} \\left( \\frac{1}{r} \\left(\\iota(\\psi)\\,B_\\phi(\\theta)\\,\\frac{r}{R(\\theta)}\\right) \\frac{\\partial g}{\\partial \\theta} + \\frac{B_\\phi(\\theta)}{R(\\theta)}\\frac{\\partial g}{\\partial \\phi} \\right)\n$$\n因子 $r$ 被消去，得到一个更方便的形式：\n$$\n\\mathbf{b}\\cdot\\nabla g = \\frac{B_\\phi(\\theta)}{R(\\theta)\\,|\\mathbf{B}(\\theta)|} \\left( \\iota(\\psi)\\frac{\\partial g}{\\partial \\theta} + \\frac{\\partial g}{\\partial \\phi} \\right)\n$$\n该表达式是沿着一条特定的磁场线计算的。一条磁场线由一个恒定的磁通标签 $\\psi$（因此 $r$ 也为常数）和一个恒定的场线标签 $\\alpha = \\theta - \\iota(\\psi)\\phi$ 定义。角向角 $\\theta$ 随环向角 $\\phi$ 的变化关系为 $\\theta(\\phi) = \\alpha + \\iota(\\psi)\\phi$。\n\n指定的标量场为 $g(\\psi,\\theta,\\phi)=\\sin(m_1\\,\\theta+n_1\\,\\phi)+c_2\\,\\cos(p_2\\,\\theta-q_2\\,\\phi)$。其偏导数为：\n$$\n\\frac{\\partial g}{\\partial \\theta} = m_1 \\cos(m_1\\theta + n_1\\phi) - p_2 c_2 \\sin(p_2\\theta - q_2\\phi)\n$$\n$$\n\\frac{\\partial g}{\\partial \\phi} = n_1 \\cos(m_1\\theta + n_1\\phi) + q_2 c_2 \\sin(p_2\\theta - q_2\\phi)\n$$\n\n最终的度量是流强度 $S_{\\mathrm{RMS}}$，定义为一个环向行程（$\\phi \\in [0,2\\pi)$）内平行流项的均方根值：\n$$\nS_{\\mathrm{RMS}}=\\left(\\frac{1}{2\\pi}\\int_0^{2\\pi}\\big[v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla g\\big]^2\\,d\\phi\\right)^{1/2}\n$$\n该积分使用 $\\phi$ 上的 $N=4096$ 个点的离散和进行数值近似。令 $\\phi_j = j \\frac{2\\pi}{N}$，其中 $j = 0, 1, \\dots, N-1$。积分可近似为：\n$$\n\\int_0^{2\\pi} f(\\phi) \\, d\\phi \\approx \\sum_{j=0}^{N-1} f(\\phi_j) \\Delta\\phi = \\frac{2\\pi}{N} \\sum_{j=0}^{N-1} f(\\phi_j)\n$$\n因此，RMS 度量变为：\n$$\nS_{\\mathrm{RMS}} \\approx \\left(\\frac{1}{2\\pi} \\frac{2\\pi}{N} \\sum_{j=0}^{N-1} \\left[v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla g\\right]^2_{\\phi=\\phi_j} \\right)^{1/2} = \\left(\\frac{1}{N} \\sum_{j=0}^{N-1} \\left[v_{\\parallel}\\,\\mathbf{b}\\cdot\\nabla g(\\phi_j)\\right]^2 \\right)^{1/2}\n$$\n\n每个测试用例的计算流程如下：\n1. 解包物理和几何参数：$R_0, a, r, B_0, v_{\\parallel}, \\alpha$，旋转变换参数 $\\iota_0, s_1, s_2$，以及标量场参数 $m_1, n_1, c_2, p_2, q_2$。\n2. 计算场线的不变值：\n    -   $\\psi = (r/a)^2$。\n    -   $\\iota(\\psi) = \\iota_0 + s_1\\psi + s_2\\psi^2$。\n3. 为环向角创建 $N=4096$ 个点的离散网格：$\\phi_j$，其中 $j=0, \\dots, N-1$。\n4. 对于网格上的每个点 $\\phi_j$：\n    a. 计算场线上的角向角：$\\theta_j = \\alpha + \\iota(\\psi)\\phi_j$。\n    b. 计算大半径位置：$R(\\theta_j) = R_0 + r \\cos(\\theta_j)$。\n    c. 计算磁场分量：$B_{\\phi,j} = B_0 \\frac{R_0}{R(\\theta_j)}$ 和 $B_{\\theta,j} = \\iota(\\psi) B_{\\phi,j} \\frac{r}{R(\\theta_j)}$。\n    d. 计算磁场大小：$|\\mathbf{B}_j| = \\sqrt{B_{\\phi,j}^2 + B_{\\theta,j}^2}$。\n    e. 在 $(\\theta_j, \\phi_j)$ 处计算偏导数 $\\partial g/\\partial\\theta$ 和 $\\partial g/\\partial\\phi$。\n    f. 组合平行梯度：$(\\mathbf{b}\\cdot\\nabla g)_j = \\frac{B_{\\phi,j}}{R(\\theta_j)|\\mathbf{B}_j|} \\left( \\iota(\\psi) \\left(\\frac{\\partial g}{\\partial \\theta}\\right)_j + \\left(\\frac{\\partial g}{\\partial \\phi}\\right)_j \\right)$。\n    g. 计算流项的平方：$T_j = \\left(v_{\\parallel}(\\mathbf{b}\\cdot\\nabla g)_j\\right)^2$。\n5. 计算平方项的均值：$\\bar{T} = \\frac{1}{N} \\sum_{j=0}^{N-1} T_j$。\n6. 最终度量是该均值的平方根：$S_{\\mathrm{RMS}} = \\sqrt{\\bar{T}}$。\n7. 结果随后四舍五入到六位小数，单位为 $\\mathrm{s}^{-1}$。\n\n此流程将为四个指定的测试用例中的每一个实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the calculation for all test cases.\n    \"\"\"\n    \n    # Test cases as provided in the problem statement.\n    test_cases = [\n        # Test case 1 (general case)\n        {'R0': 3.0, 'a': 0.3, 'r': 0.15, 'B0': 3.0, 'v_par': 1.0e5, 'alpha': 0.2,\n         'iota0': 0.4, 's1': 0.3, 's2': 0.0,\n         'm1': 2, 'n1': 1, 'c2': 0.35, 'p2': 3, 'q2': 2},\n        # Test case 2 (near-axis limit)\n        {'R0': 3.0, 'a': 0.3, 'r': 1.0e-6, 'B0': 3.0, 'v_par': 1.0e5, 'alpha': 0.0,\n         'iota0': 0.8, 's1': 0.0, 's2': 0.0,\n         'm1': 1, 'n1': 3, 'c2': 0.20, 'p2': 4, 'q2': 1},\n        # Test case 3 (high transform with shear and curvature)\n        {'R0': 1.5, 'a': 0.5, 'r': 0.25, 'B0': 2.5, 'v_par': 2.0e5, 'alpha': 1.0,\n         'iota0': 1.0, 's1': -0.5, 's2': 0.2,\n         'm1': 3, 'n1': 2, 'c2': 0.40, 'p2': 1, 'q2': 3},\n        # Test case 4 (strong geometry variation, low transform baseline)\n        {'R0': 4.0, 'a': 0.8, 'r': 0.4, 'B0': 5.0, 'v_par': 0.5e5, 'alpha': 2.0,\n         'iota0': 0.2, 's1': 0.6, 's2': -0.1,\n         'm1': 5, 'n1': 0, 'c2': 0.0, 'p2': 0, 'q2': 0},\n    ]\n\n    results = []\n    for params in test_cases:\n        s_rms = calculate_streaming_metric(**params)\n        results.append(s_rms)\n\n    # Format the final output string exactly as required.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_streaming_metric(R0, a, r, B0, v_par, alpha, iota0, s1, s2, m1, n1, c2, p2, q2):\n    \"\"\"\n    Calculates the streaming strength metric S_RMS for a single test case.\n    \"\"\"\n    # Number of points for numerical integration\n    N = 4096\n\n    # Calculate constant parameters for the field line\n    psi = (r / a)**2\n    iota = iota0 + s1 * psi + s2 * psi**2\n\n    # Create the grid for the toroidal angle phi\n    phi = np.linspace(0, 2 * np.pi, N, endpoint=False)\n\n    # Calculate poloidal angle theta along the field line\n    theta = alpha + iota * phi\n\n    # Calculate geometric and magnetic field quantities along the field line\n    R_theta = R0 + r * np.cos(theta)\n    B_phi = B0 * R0 / R_theta\n    B_theta = iota * B_phi * r / R_theta\n    B_mag = np.sqrt(B_phi**2 + B_theta**2)\n\n    # Define arguments for the trigonometric functions in g\n    arg1 = m1 * theta + n1 * phi\n    arg2 = p2 * theta - q2 * phi\n\n    # Calculate partial derivatives of the scalar field g\n    # g = sin(arg1) + c2 * cos(arg2)\n    dg_dtheta = m1 * np.cos(arg1) - p2 * c2 * np.sin(arg2)\n    dg_dphi = n1 * np.cos(arg1) + q2 * c2 * np.sin(arg2)\n\n    # Calculate the parallel gradient of g\n    # b_dot_grad_g = (B_phi / (R_theta * B_mag)) * (iota * dg_dtheta + dg_dphi)\n    iota_dg_dtheta_plus_dg_dphi = iota * dg_dtheta + dg_dphi\n    b_dot_grad_g = (B_phi / (R_theta * B_mag)) * iota_dg_dtheta_plus_dg_dphi\n\n    # Calculate the full streaming term\n    streaming_term = v_par * b_dot_grad_g\n\n    # Calculate the RMS value\n    s_rms_squared = np.mean(streaming_term**2)\n    s_rms = np.sqrt(s_rms_squared)\n    \n    return s_rms\n\nsolve()\n```"
        },
        {
            "introduction": "在仿星器优化中，由于完整的湍流模拟计算成本极高，无法直接用于庞大的优化循环。因此，科学家们开发了更简单、基于物理原理的“湍流代理模型”（turbulence proxies）来进行快速评估。这个练习让您亲身体验这一过程中的关键步骤：通过将不同代理模型的预测结果与一个更底层的（尽管仍是简化的）湍流增长率模型进行比较，来验证这些代理模型的预测能力。",
            "id": "4201384",
            "problem": "给定两种仿星器位型的模型磁平衡，请您评估湍流代理及其在匹配剖面下对离子温度梯度（ITG）模的简化线性回旋动理学增长率的预测能力。目标是通过计算代理谱与模型增长率谱在一系列垂直波数上的相关系数，来形式化一个可复现的评估。此计算必须以一个完整、可运行的程序实现。\n\n科学背景是线性局域回旋动理学（GK）模型，其中主导的ITG驱动由离子温度梯度、曲率漂移、磁剪切和捕获粒子分数控制。简化模型必须从漂移波湍流和导心运动的第一性原理出发，然后构建不依赖于列表化公式的、量纲一致的简化形式。您将定义并使用两个反映几何驱动和谱形成的湍流代理，以及一个作为波数函数的简化线性ITG增长率模型。然后，您将计算皮尔逊相关系数，以量化代理相对于增长率的预测能力。\n\n定义以下元素并一致地使用它们：\n\n- 垂直波数谱由一个 $k_y$ 值的数组表示，其中 $k_y \\rho_i$ 是无量纲的，并理解为已通过离子拉莫尔半径归一化。您将把 $k_y$ 视为无量綱。所有角度（如果有）均应以弧度为单位，但不需要输入角度。\n- 两种平衡，标记为平衡 $A$ 和平衡 $B$，由几何参数指定：坏曲率度量 $\\kappa$、局域磁剪切 $\\hat{s}$ 和有效捕获粒子分数 $f_t$。所有 $\\kappa$、$\\hat{s}$ 和 $f_t$ 均为无量纲。\n- 匹配的热力学剖面由无量纲梯度 $R/L_{Ti}$ 和 $R/L_n$ 指定，其中 $R$ 是一个大半径标长，$L_{Ti}$ 是离子温度梯度标长，$L_n$ 是密度梯度标长。定义无量纲比率 $\\eta_i$ 为 $\\eta_i = (R/L_{Ti})/(R/L_n)$。\n\n基于第一性原理标度，构建以下简化形式：\n\n1. 曲率驱动因子 $G$ 为 $G = \\kappa/(1+\\hat{s}^2)$，反映了磁剪切的抑制作用。\n2. 在波数 $k_y$ 处的简化线性ITG增长率（通过离子回旋频率归一化，因此无量纲）为\n$$\n\\gamma(k_y) = A\\,k_y \\left(\\eta_i - \\eta_{\\mathrm{crit}}\\right) - D\\,k_y^2,\n$$\n其中 $A = a_0\\,G$，$\\eta_{\\mathrm{crit}} = c_0 + c_1 f_t + c_2 G$，以及 $D = d_0(1+|\\hat{s}|)$，其中 $a_0$、$c_0$、$c_1$、$c_2$ 和 $d_0$ 是正的无量纲常数。此形式包含了与 $k_y$ 成正比的曲率驱动失稳和随 $k_y^2$ 变化的剪切增强阻尼。\n\n3. 定义两个包含几何驱动和谱形成的湍流代理：\n   - 代理 $P_1(k_y)$:\n   $$\n   P_1(k_y) = C_1\\,k_y\\,\\frac{R}{L_{Ti}}\\,\\frac{\\kappa f_t}{1+\\hat{s}^2}\\,\\exp\\left(-\\beta\\,k_y^2\\right),\n   $$\n   其中 $C_1>0$ 和 $\\beta>0$。\n   - 代理 $P_2(k_y)$:\n   $$\n   P_2(k_y) = C_2\\,k_y\\,\\frac{R}{L_{Ti}}\\,\\frac{\\sqrt{\\kappa}\\,f_t}{1+|\\hat{s}|}\\,\\frac{1}{1+k_y^2},\n   $$\n   其中 $C_2>0$。\n\n对于每种平衡，您必须在指定的 $k_y$ 网格上为匹配的剖面计算数组 $\\{P_1(k_y)\\}$、$\\{P_2(k_y)\\}$ 和 $\\{\\gamma(k_y)\\}$。然后计算皮尔逊相关系数\n$$\nr_{1} = \\mathrm{corr}\\left(P_1(k_y),\\gamma(k_y)\\right), \\quad r_{2} = \\mathrm{corr}\\left(P_2(k_y),\\gamma(k_y)\\right),\n$$\n其中 $\\mathrm{corr}$ 表示在 $k_y$ 数组上的皮尔逊相关系数。如果任一输入向量的标准差为零，则将相关系数定义为 $0.0$。\n\n所有计算中使用的常数：\n- $a_0 = 0.7$，$c_0 = 1.0$，$c_1 = 1.5$，$c_2 = 0.8$，$d_0 = 0.3 + 0.2 f_t$（注意 $d_0$ 依赖于 $f_t$），$C_1 = 1.0$，$C_2 = 1.0$ 和 $\\beta = 0.4$。所有常数均为无量纲。\n\n测试套件：\n- 案例 1（一般情景）：\n  - $k_y$ 网格：$[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]$\n  - 剖面：$R/L_{Ti} = 7.0$，$R/L_n = 2.0$\n  - 平衡 $A$：$\\kappa = 0.6$，$\\hat{s} = 0.7$，$f_t = 0.3$\n  - 平衡 $B$：$\\kappa = 0.35$，$\\hat{s} = 0.9$，$f_t = 0.25$\n- 案例 2（弱梯度，近稳定边界）：\n  - $k_y$ 网格：$[0.1,0.175,0.25,0.325,0.4,0.475,0.55,0.625,0.7,0.775,0.85,0.925]$\n  - 剖面：$R/L_{Ti} = 3.0$，$R/L_n = 2.5$\n  - 平衡 $A$：$\\kappa = 0.5$，$\\hat{s} = 0.4$，$f_t = 0.28$\n  - 平衡 $B$：$\\kappa = 0.45$，$\\hat{s} = 0.85$，$f_t = 0.22$\n- 案例 3（低剪切几何）：\n  - $k_y$ 网格：$[0.08,0.15,0.22,0.29,0.36,0.43,0.5,0.57,0.64,0.71,0.78,0.85,0.92,0.99,1.06]$\n  - 剖面：$R/L_{Ti} = 6.5$，$R/L_n = 1.8$\n  - 平衡 $A$：$\\kappa = 0.7$，$\\hat{s} = 0.0$，$f_t = 0.33$\n  - 平衡 $B$：$\\kappa = 0.5$，$\\hat{s} = 0.6$，$f_t = 0.27$\n\n最终输出规范：\n- 对于每个案例，计算四个浮点数：$[r_{1}^{A}, r_{2}^{A}, r_{1}^{B}, r_{2}^{B}]$，其中 $r_{1}^{A}$ 是平衡 $A$ 中 $P_1$ 和 $\\gamma$ 之间的相关性，$r_{2}^{A}$ 是平衡 $A$ 中 $P_2$ 和 $\\gamma$ 之间的相关性，平衡 $B$ 的情况类似。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按案例排序，每个案例内按序列 $[r_{1}^{A}, r_{2}^{A}, r_{1}^{B}, r_{2}^{B}]$ 排列。例如，三个案例的输出格式为 $[r_{1}^{A,1}, r_{2}^{A,1}, r_{1}^{B,1}, r_{2}^{B,1}, r_{1}^{A,2}, r_{2}^{A,2}, r_{1}^{B,2}, r_{2}^{B,2}, r_{1}^{A,3}, r_{2}^{A,3}, r_{1}^{B,3}, r_{2}^{B,3}]$。\n\n所有结果都是无量纲浮点数。输出中不需要物理单位。程序必须自包含且无需外部输入即可执行，并且必须严格遵守指定的输出格式。",
            "solution": "用户提供的问题经过了严格验证，被确定为是合理的。这是一个适定的、有科学依据的计算问题，根植于等离子体物理学领域，特别是仿星器中由离子温度梯度（ITG）驱动的湍流研究。该问题是自包含的，所有必要的参数、常数和数学模型都已明确定义。目标是实现这些模型，计算导出量，并通过计算皮尔逊相关系数来评估两个湍流代理相对于简化回旋动理学增长率模型的预测能力。所提供的模型虽然简化，但基于已确立的漂移波湍流和导心运动的第一性原理，确保了科学有效性。该问题没有歧义、逻辑矛盾和事实错误。\n\n解决方案首先将所提供的物理模型进行算法上的形式化。对于每个指定的测试案例，我们考虑两种不同的磁平衡，A和B。它们由无量纲的几何参数来表征：坏曲率度量 $\\kappa$、局域磁剪切 $\\hat{s}$ 和有效捕获粒子分数 $f_t$。背景等离子体状态由匹配的热力学剖面定义，特别是归一化的离子温度梯度 $R/L_{Ti}$ 和密度梯度 $R/L_n$。由此，我们定义参数 $\\eta_i = (R/L_{Ti})/(R/L_n)$，这是ITG湍流的一个关键驱动因素。\n\n分析的核心涉及三个在无量纲垂直波数 $k_y$ 网格上计算的光谱量。\n\n首先，简化的线性ITG增长率 $\\gamma(k_y)$ 被建模为：\n$$\n\\gamma(k_y) = A\\,k_y \\left(\\eta_i - \\eta_{\\mathrm{crit}}\\right) - D\\,k_y^2\n$$\n该形式捕捉了ITG模的基本物理特性。第一项表示线性驱动，与 $k_y$ 和偏离稳定性阈值 $\\eta_{\\mathrm{crit}}$ 的程度成正比。驱动强度 $A$ 受几何形状通过因子 $G = \\kappa/(1+\\hat{s}^2)$ 调制，使得 $A = a_0\\,G$，其中 $a_0 = 0.7$ 是一个常数。这反映了坏曲率如何驱动不稳定性，而强磁剪切则使其稳定。稳定性阈值本身 $\\eta_{\\mathrm{crit}}$ 依赖于几何形状和捕获粒子：$\\eta_{\\mathrm{crit}} = c_0 + c_1 f_t + c_2 G$，其中常数 $c_0 = 1.0$，$c_1 = 1.5$ 和 $c_2 = 0.8$。第二项 $-D\\,k_y^2$ 表示在短波长（高 $k_y$）处的扩散阻尼机制，其中阻尼系数 $D$ 因磁剪切而增强，$D = d_0(1+|\\hat{s}|)$，且 $d_0=0.3 + 0.2 f_t$。\n\n其次，我们评估两个湍流代理 $P_1(k_y)$ 和 $P_2(k_y)$，它们旨在捕捉湍流驱动的显著特征，而无需解出完整的色散关系。\n代理 $P_1(k_y)$ 由下式给出：\n$$\nP_1(k_y) = C_1\\,k_y\\,\\frac{R}{L_{Ti}}\\,\\frac{\\kappa f_t}{1+\\hat{s}^2}\\,\\exp\\left(-\\beta\\,k_y^2\\right)\n$$\n代理 $P_2(k_y)$ 由下式给出：\n$$\nP_2(k_y) = C_2\\,k_y\\,\\frac{R}{L_{Ti}}\\,\\frac{\\sqrt{\\kappa}\\,f_t}{1+|\\hat{s}|}\\,\\frac{1}{1+k_y^2}\n$$\n两个代理在低波数时都包含对 $k_y$ 的线性依赖，与主要热力学驱动 $R/L_{Ti}$ 成正比，并依赖于几何参数 $\\kappa$、$f_t$ 和 $\\hat{s}$。它们在对这些参数的函数依赖性以及在高 $k_y$ 处的光谱衰减方面有所不同，分别使用了高斯和洛伦兹形状。常数为 $C_1=1.0$，$C_2=1.0$ 和 $\\beta=0.4$。\n\n对于每个测试案例和每个平衡（A和B），我们在指定的 $k_y$ 网格上计算表示 $\\gamma(k_y)$、$P_1(k_y)$ 和 $P_2(k_y)$ 谱的数组。随后，我们通过计算它们的皮尔逊相关系数 $r_1 = \\mathrm{corr}(P_1, \\gamma)$ 和 $r_2 = \\mathrm{corr}(P_2, \\gamma)$ 来量化代理与增长率谱之间的线性关系。两个变量 $X$ 和 $Y$ 之间的皮尔逊相关系数定义为协方差除以它们标准差的乘积。根据问题的规定，如果任一数组的标准差为零（即数组为常数），则指定相关性为 $0.0$。此过程通过计算实现，遍历每个案例及其相关的平衡，为三个案例中的每一个生成一个最终的、有序的四个相关系数值列表 ($r_1^A, r_2^A, r_1^B, r_2^B$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import pearsonr\n\ndef solve():\n    \"\"\"\n    Solves the stellarator turbulence proxy validation problem.\n    \"\"\"\n\n    # Define the constants provided in the problem statement.\n    CONSTANTS = {\n        'a0': 0.7,\n        'c0': 1.0,\n        'c1': 1.5,\n        'c2': 0.8,\n        'C1': 1.0,\n        'C2': 1.0,\n        'beta': 0.4\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"ky_grid\": np.array([0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]),\n            \"profiles\": {\"R_LTi\": 7.0, \"R_Ln\": 2.0},\n            \"equilibria\": {\n                \"A\": {\"kappa\": 0.6, \"s_hat\": 0.7, \"f_t\": 0.3},\n                \"B\": {\"kappa\": 0.35, \"s_hat\": 0.9, \"f_t\": 0.25},\n            },\n        },\n        {\n            \"ky_grid\": np.array([0.1, 0.175, 0.25, 0.325, 0.4, 0.475, 0.55, 0.625, 0.7, 0.775, 0.85, 0.925]),\n            \"profiles\": {\"R_LTi\": 3.0, \"R_Ln\": 2.5},\n            \"equilibria\": {\n                \"A\": {\"kappa\": 0.5, \"s_hat\": 0.4, \"f_t\": 0.28},\n                \"B\": {\"kappa\": 0.45, \"s_hat\": 0.85, \"f_t\": 0.22},\n            },\n        },\n        {\n            \"ky_grid\": np.array([0.08, 0.15, 0.22, 0.29, 0.36, 0.43, 0.5, 0.57, 0.64, 0.71, 0.78, 0.85, 0.92, 0.99, 1.06]),\n            \"profiles\": {\"R_LTi\": 6.5, \"R_Ln\": 1.8},\n            \"equilibria\": {\n                \"A\": {\"kappa\": 0.7, \"s_hat\": 0.0, \"f_t\": 0.33},\n                \"B\": {\"kappa\": 0.5, \"s_hat\": 0.6, \"f_t\": 0.27},\n            },\n        },\n    ]\n\n    def custom_pearson_corr(x, y):\n        \"\"\"\n        Calculates the Pearson correlation coefficient. Returns 0.0 if the\n        standard deviation of either input is zero, as required by the problem.\n        \"\"\"\n        if np.std(x) == 0.0 or np.std(y) == 0.0:\n            return 0.0\n        # pearsonr returns (correlation, p-value)\n        r, _ = pearsonr(x, y)\n        return r\n\n    all_results = []\n    for case in test_cases:\n        ky_grid = case[\"ky_grid\"]\n        R_LTi = case[\"profiles\"][\"R_LTi\"]\n        R_Ln = case[\"profiles\"][\"R_Ln\"]\n        \n        # Calculate eta_i for the current case\n        eta_i = R_LTi / R_Ln if R_Ln != 0 else np.inf\n\n        for eq_label in [\"A\", \"B\"]:\n            eq_params = case[\"equilibria\"][eq_label]\n            kappa = eq_params[\"kappa\"]\n            s_hat = eq_params[\"s_hat\"]\n            f_t = eq_params[\"f_t\"]\n\n            # Calculate derived parameters\n            G = kappa / (1 + s_hat**2)\n            \n            # Growth rate parameters\n            A = CONSTANTS['a0'] * G\n            eta_crit = CONSTANTS['c0'] + CONSTANTS['c1'] * f_t + CONSTANTS['c2'] * G\n            d0 = 0.3 + 0.2 * f_t\n            D = d0 * (1 + abs(s_hat))\n\n            # Calculate gamma(k_y) spectrum\n            gamma_ky = A * ky_grid * (eta_i - eta_crit) - D * ky_grid**2\n\n            # Calculate Proxy 1 spectrum\n            P1_ky = (CONSTANTS['C1'] * ky_grid * R_LTi * (kappa * f_t / (1 + s_hat**2)) \n                     * np.exp(-CONSTANTS['beta'] * ky_grid**2))\n\n            # Calculate Proxy 2 spectrum\n            P2_ky = (CONSTANTS['C2'] * ky_grid * R_LTi * (np.sqrt(kappa) * f_t / (1 + abs(s_hat)))\n                     * (1 / (1 + ky_grid**2)))\n\n            # Compute correlation coefficients\n            r1 = custom_pearson_corr(P1_ky, gamma_ky)\n            r2 = custom_pearson_corr(P2_ky, gamma_ky)\n\n            all_results.extend([r1, r2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实的仿星器设计是一个多目标优化问题，需要在等离子体性能与工程可行性（如线圈复杂度）之间做出权衡。这个练习模拟了这一核心设计挑战，它要求您使用湍流和线圈复杂度的代理模型来识别“帕累托前沿”（Pareto front）。帕累托前沿代表了一组在相互冲突的目标之间取得最佳折衷的“最优”设计解，是现代仿星器优化研究中的一个核心概念。",
            "id": "4201430",
            "problem": "给定一组候选仿星器磁平衡，由无量纲参数描述。目标是为每个候选位形计算两个目标值，这两个值分别定量地反映湍流输运的代理指标和线圈工程复杂度的代理指标，然后为同时最小化这两个目标构建帕累托前沿。帕累托前沿应包含这样的位形：没有任何其他位形能够同时实现更低的湍流代理指标和更低的线圈复杂度代理指标（其中至少有一项是严格更优的）。最终答案必须是单行输出，包含一个用方括号括起来的、按升序排列的、逗号分隔的帕累托最优位形索引列表。\n\n从以下适用于聚变等离子体湍流和线圈复杂度的基本依据出发：\n\n- 根据回旋动理学理论，离子温度梯度驱动会产生一种线性不稳定性，其特征是增长率与离子抗磁频率和不利（坏）曲率的度量成比例。磁剪切效应具有稳定作用。根据这些特性，使用一个无量纲的线性增长率代理指标，定义为\n$$\\gamma_{\\mathrm{lin}} = C_{\\mathrm{gb}} \\left(\\frac{a}{L_T}\\right) f_{\\mathrm{curv}}(\\kappa_c,q),$$\n其中 $C_{\\mathrm{gb}}$ 是一个正常数，$\\frac{a}{L_T}$ 是归一化温度梯度，$\\kappa_c$ 是一个无量纲的坏曲率幅度，$q$ 是安全因子，$f_{\\mathrm{curv}}$ 是一个无量纲函数，它随 $\\kappa_c$ 的增加而增加，随 $q$ 的增加而减少。对于本问题，取\n$$f_{\\mathrm{curv}}(\\kappa_c,q) = \\frac{\\kappa_c}{1+q^2}.$$\n定义一个无量纲的剪切稳定代理指标为\n$$\\gamma_{\\mathrm{shear}} = C_{\\mathrm{sh}} \\left| \\hat{s} \\right|,$$\n其中 $C_{\\mathrm{sh}}$ 是一个正常数，$\\hat{s}$ 是局部磁剪切。那么，有效不稳定性水平的代理指标为\n$$\\gamma_{\\mathrm{eff}} = \\max\\left(0,\\ \\gamma_{\\mathrm{lin}} - \\gamma_{\\mathrm{shear}}\\right).$$\n定义湍流目标为\n$$J_{\\mathrm{turb}} = \\gamma_{\\mathrm{eff}}.$$\n\n- 对于线圈工程复杂度，使用一个受弯曲和扭转能量惩罚以及线圈长度启发的代理指标。设 $c_{\\mathrm{amp}}$ 为无量纲曲率幅度，$t_{\\mathrm{amp}}$ 为无量纲挠率幅度，$L_{\\mathrm{norm}}$ 为无量纲归一化长度。定义\n$$J_{\\mathrm{coil}} = \\alpha\\, c_{\\mathrm{amp}}^2 + \\beta\\, t_{\\mathrm{amp}}^2 + \\lambda\\, L_{\\mathrm{norm}},$$\n其中 $\\alpha$、$\\beta$ 和 $\\lambda$ 是正常数权重。\n\n给定以下常数：\n- $C_{\\mathrm{gb}} = 0.35$,\n- $C_{\\mathrm{sh}} = 0.8$,\n- $\\alpha = 1.0$,\n- $\\beta = 0.6$,\n- $\\lambda = 0.2$,\n\n以及以下包含 $7$ 个候选位形的列表，每个位形由元组指定\n$$(\\kappa_c,\\ \\hat{s},\\ a/L_T,\\ q,\\ c_{\\mathrm{amp}},\\ t_{\\mathrm{amp}},\\ L_{\\mathrm{norm}}),$$\n计算每个位形的 $J_{\\mathrm{turb}}$ 和 $J_{\\mathrm{coil}}$，然后找出在双目标最小化 $(J_{\\mathrm{turb}}, J_{\\mathrm{coil}})$ 问题中位于帕累托前沿上的位形索引。位形使用从零开始的索引。\n\n候选位形如下：\n- 索引 $0$：$(0.8,\\ 0.6,\\ 3.0,\\ 1.2,\\ 0.35,\\ 0.4,\\ 1.0)$。\n- 索引 $1$：$(1.4,\\ 0.2,\\ 4.0,\\ 1.0,\\ 0.8,\\ 0.9,\\ 1.4)$。\n- 索引 $2$：$(0.5,\\ 0.3,\\ 2.0,\\ 1.5,\\ 0.2,\\ 0.25,\\ 0.9)$。\n- 索引 $3$：$(1.0,\\ 0.4,\\ 3.5,\\ 1.3,\\ 0.5,\\ 0.45,\\ 1.1)$。\n- 索引 $4$：$(1.0,\\ 0.4,\\ 3.5,\\ 1.3,\\ 0.5,\\ 0.45,\\ 1.1)$。\n- 索引 $5$：$(0.9,\\ 0.1,\\ 1.8,\\ 0.9,\\ 0.15,\\ 0.15,\\ 0.7)$。\n- 索引 $6$：$(1.2,\\ 0.532,\\ 3.0,\\ 1.4,\\ 0.4,\\ 0.5,\\ 1.2)$。\n\n您的程序必须：\n- 使用上述公式为每个候选位形计算 $J_{\\mathrm{turb}}$ 和 $J_{\\mathrm{coil}}$。\n- 根据以下规则构建帕累托前沿：当且仅当 $J_{\\mathrm{turb}}(j) \\le J_{\\mathrm{turb}}(i)$ 且 $J_{\\mathrm{coil}}(j) \\le J_{\\mathrm{coil}}(i)$，并且这两个不等式中至少有一个是严格不等式时，位形 $i$ 被位形 $j$ 支配。未被任何其他位形支配的位形即为帕累托最优位形。\n- 生成单行输出，其中包含帕累托最优位形的已排序索引，以逗号分隔列表的形式并用方括号括起来（例如 $[0,2,5]$）。不允许有其他输出。\n\n本问题中的所有量都是无量纲的，因此不需要物理单位。上述测试套件涵盖了一般情况、当 $\\gamma_{\\mathrm{lin}} = \\gamma_{\\mathrm{shear}}$ 时 $J_{\\mathrm{turb}}$ 过渡到零的边界情况，以及一个包含重复位形以测试支配关系中平局处理的边缘情况。",
            "solution": "经评估，用户提供的问题是有效的。它在科学上基于与仿星器优化相关的等离子体湍流和磁体线圈复杂度的简化但有物理动机的模型。该问题在数学上是适定的，提供了计算唯一解所需的所有数据、常数和明确的定义。语言客观，要求明确。因此，下面提供一个合理的解决方案。\n\n核心任务是为一组仿星器位形执行双目标优化。需要最小化的两个目标分别是湍流输运的代理指标 $J_{\\mathrm{turb}}$ 和线圈复杂度的代理指标 $J_{\\mathrm{coil}}$。解决方案包括为每个候选位形计算这两个目标值，然后识别非支配集，即帕累托前沿。\n\n首先，我们根据所提供的物理模型和参数来定义目标函数。给定的常数为 $C_{\\mathrm{gb}} = 0.35$，$C_{\\mathrm{sh}} = 0.8$，$\\alpha = 1.0$，$\\beta = 0.6$ 和 $\\lambda = 0.2$。\n\n湍流目标 $J_{\\mathrm{turb}}$ 源于离子温度梯度（ITG）不稳定性驱动与磁剪切稳定作用之间的平衡。线性增长率代理指标 $\\gamma_{\\mathrm{lin}}$ 由下式给出：\n$$ \\gamma_{\\mathrm{lin}} = C_{\\mathrm{gb}} \\left(\\frac{a}{L_T}\\right) f_{\\mathrm{curv}}(\\kappa_c,q) $$\n其中曲率函数为：\n$$ f_{\\mathrm{curv}}(\\kappa_c,q) = \\frac{\\kappa_c}{1+q^2} $$\n剪切稳定代理指标 $\\gamma_{\\mathrm{shear}}$ 为：\n$$ \\gamma_{\\mathrm{shear}} = C_{\\mathrm{sh}} \\left| \\hat{s} \\right| $$\n作为湍流目标的有效不稳定性水平是这两者之差，并以零为下限：\n$$ J_{\\mathrm{turb}} = \\gamma_{\\mathrm{eff}} = \\max\\left(0,\\ \\gamma_{\\mathrm{lin}} - \\gamma_{\\mathrm{shear}}\\right) $$\n\n线圈复杂度目标 $J_{\\mathrm{coil}}$ 是线圈弯曲能量、扭转能量和长度代理指标的加权和：\n$$ J_{\\mathrm{coil}} = \\alpha\\, c_{\\mathrm{amp}}^2 + \\beta\\, t_{\\mathrm{amp}}^2 + \\lambda\\, L_{\\mathrm{norm}} $$\n\n对于 7 个候选位形中的每一个，由元组 $(\\kappa_c,\\ \\hat{s},\\ a/L_T,\\ q,\\ c_{\\mathrm{amp}},\\ t_{\\mathrm{amp}},\\ L_{\\mathrm{norm}})$ 指定，我们计算目标向量 $(J_{\\mathrm{turb}}, J_{\\mathrm{coil}})$。\n\n位形 $0$：$(\\kappa_c, \\hat{s}, a/L_T, q, c_{\\mathrm{amp}}, t_{\\mathrm{amp}}, L_{\\mathrm{norm}}) = (0.8, 0.6, 3.0, 1.2, 0.35, 0.4, 1.0)$\n$f_{\\mathrm{curv}} = \\frac{0.8}{1+1.2^2} \\approx 0.3279$。$\\gamma_{\\mathrm{lin}} = 0.35 \\times 3.0 \\times 0.3279 \\approx 0.3443$。$\\gamma_{\\mathrm{shear}} = 0.8 \\times |0.6| = 0.48$。\n$J_{\\mathrm{turb}} = \\max(0, 0.3443 - 0.48) = 0$。\n$J_{\\mathrm{coil}} = 1.0(0.35^2) + 0.6(0.4^2) + 0.2(1.0) = 0.1225 + 0.096 + 0.2 = 0.4185$。\n目标向量：$(0.0, 0.4185)$。\n\n位形 $1$：$(1.4, 0.2, 4.0, 1.0, 0.8, 0.9, 1.4)$\n$f_{\\mathrm{curv}} = \\frac{1.4}{1+1.0^2} = 0.7$。$\\gamma_{\\mathrm{lin}} = 0.35 \\times 4.0 \\times 0.7 = 0.98$。$\\gamma_{\\mathrm{shear}} = 0.8 \\times |0.2| = 0.16$。\n$J_{\\mathrm{turb}} = \\max(0, 0.98 - 0.16) = 0.82$。\n$J_{\\mathrm{coil}} = 1.0(0.8^2) + 0.6(0.9^2) + 0.2(1.4) = 0.64 + 0.486 + 0.28 = 1.406$。\n目标向量：$(0.82, 1.406)$。\n\n位形 $2$：$(0.5, 0.3, 2.0, 1.5, 0.2, 0.25, 0.9)$\n$f_{\\mathrm{curv}} = \\frac{0.5}{1+1.5^2} \\approx 0.1538$。$\\gamma_{\\mathrm{lin}} = 0.35 \\times 2.0 \\times 0.1538 \\approx 0.1077$。$\\gamma_{\\mathrm{shear}} = 0.8 \\times |0.3| = 0.24$。\n$J_{\\mathrm{turb}} = \\max(0, 0.1077 - 0.24) = 0$。\n$J_{\\mathrm{coil}} = 1.0(0.2^2) + 0.6(0.25^2) + 0.2(0.9) = 0.04 + 0.0375 + 0.18 = 0.2575$。\n目标向量：$(0.0, 0.2575)$。\n\n位形 $3$：$(1.0, 0.4, 3.5, 1.3, 0.5, 0.45, 1.1)$\n$f_{\\mathrm{curv}} = \\frac{1.0}{1+1.3^2} \\approx 0.3717$。$\\gamma_{\\mathrm{lin}} = 0.35 \\times 3.5 \\times 0.3717 \\approx 0.4554$。$\\gamma_{\\mathrm{shear}} = 0.8 \\times |0.4| = 0.32$。\n$J_{\\mathrm{turb}} = \\max(0, 0.4554 - 0.32) \\approx 0.1354$。\n$J_{\\mathrm{coil}} = 1.0(0.5^2) + 0.6(0.45^2) + 0.2(1.1) = 0.25 + 0.1215 + 0.22 = 0.5915$。\n目标向量：$(\\approx 0.1354, 0.5915)$。\n\n位形 $4$：$(1.0, 0.4, 3.5, 1.3, 0.5, 0.45, 1.1)$\n这与位形 $3$ 相同。\n目标向量：$(\\approx 0.1354, 0.5915)$。\n\n位形 $5$：$(0.9, 0.1, 1.8, 0.9, 0.15, 0.15, 0.7)$\n$f_{\\mathrm{curv}} = \\frac{0.9}{1+0.9^2} \\approx 0.4972$。$\\gamma_{\\mathrm{lin}} = 0.35 \\times 1.8 \\times 0.4972 \\approx 0.3132$。$\\gamma_{\\mathrm{shear}} = 0.8 \\times |0.1| = 0.08$。\n$J_{\\mathrm{turb}} = \\max(0, 0.3132 - 0.08) \\approx 0.2332$。\n$J_{\\mathrm{coil}} = 1.0(0.15^2) + 0.6(0.15^2) + 0.2(0.7) = 0.0225 + 0.0135 + 0.14 = 0.176$。\n目标向量：$(\\approx 0.2332, 0.176)$。\n\n位形 $6$：$(1.2, 0.532, 3.0, 1.4, 0.4, 0.5, 1.2)$\n$f_{\\mathrm{curv}} = \\frac{1.2}{1+1.4^2} \\approx 0.4054$。$\\gamma_{\\mathrm{lin}} = 0.35 \\times 3.0 \\times 0.4054 \\approx 0.42567$。$\\gamma_{\\mathrm{shear}} = 0.8 \\times |0.532| = 0.4256$。\n$J_{\\mathrm{turb}} = \\max(0, 0.42567 - 0.4256) \\approx 0.0000757$。\n$J_{\\mathrm{coil}} = 1.0(0.4^2) + 0.6(0.5^2) + 0.2(1.2) = 0.16 + 0.15 + 0.24 = 0.55$。\n目标向量：$(\\approx 0.0000757, 0.55)$。\n\n计算出的目标向量 $(J_{\\mathrm{turb}}, J_{\\mathrm{coil}})$ 如下：\n- 索引 $0$：$(0.0, 0.4185)$\n- 索引 $1$：$(0.82, 1.406)$\n- 索引 $2$：$(0.0, 0.2575)$\n- 索引 $3$：$(\\approx 0.1354, 0.5915)$\n- 索引 $4$：$(\\approx 0.1354, 0.5915)$\n- 索引 $5$：$(\\approx 0.2332, 0.176)$\n- 索引 $6$：$(\\approx 0.0000757, 0.55)$\n\n接下来，我们识别帕累托前沿。如果 $J_{\\mathrm{turb}}(j) \\le J_{\\mathrm{turb}}(i)$ 且 $J_{\\mathrm{coil}}(j) \\le J_{\\mathrm{coil}}(i)$，并且至少有一个不等式是严格的，那么位形 $i$ 就被位形 $j$ 支配。不被任何其他位形支配的位形构成了帕累托前沿。\n\n- 位形 $1$ ($ (0.82, 1.406) $) 被所有其他位形支配，因为它们在两个目标上的值都更小。\n- 位形 $0$ ($ (0.0, 0.4185) $) 被位形 $2$ ($ (0.0, 0.2575) $) 支配，因为 $J_{\\mathrm{turb}}(2) = J_{\\mathrm{turb}}(0)$ 且 $J_{\\mathrm{coil}}(2)  J_{\\mathrm{coil}}(0)$。\n- 位形 $3$ 和 $4$ ($ (\\approx 0.1354, 0.5915) $) 被位形 $6$ ($ (\\approx 0.0000757, 0.55) $) 支配，因为 $J_{\\mathrm{turb}}(6)  J_{\\mathrm{turb}}(3,4)$ 且 $J_{\\mathrm{coil}}(6)  J_{\\mathrm{coil}}(3,4)$。请注意，相同的位形不会相互支配，因为支配关系要求至少一个严格不等式。\n\n剩下的位形是 $2$、$5$ 和 $6$。我们检查它们之间的相互支配关系：\n- 比较 $2$ ($ (0.0, 0.2575) $) 和 $5$ ($ (\\approx 0.2332, 0.176) $)：位形 $2$ 的 $J_{\\mathrm{turb}}$ 较低，但位形 $5$ 的 $J_{\\mathrm{coil}}$ 较低。两者互不支配。\n- 比较 $2$ ($ (0.0, 0.2575) $) 和 $6$ ($ (\\approx 0.0000757, 0.55) $)：位形 $2$ 的 $J_{\\mathrm{turb}}$ 较低，但 $J_{\\mathrm{coil}}$ 较高。两者互不支配。\n- 比较 $5$ ($ (\\approx 0.2332, 0.176) $) 和 $6$ ($ (\\approx 0.0000757, 0.55) $)：位形 $6$ 的 $J_{\\mathrm{turb}}$ 较低，但位形 $5$ 的 $J_{\\mathrm{coil}}$ 较低。两者互不支配。\n\n因此，索引为 $2$、$5$ 和 $6$ 的位形不被任何其他位形支配。它们构成了帕累托前沿。这些索引按升序排列为 $2, 5, 6$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes J_turb and J_coil for each candidate configuration, then identifies \n    and returns the indices of the Pareto-optimal configurations.\n    \"\"\"\n    \n    # Define the constants from the problem statement.\n    C_gb = 0.35\n    C_sh = 0.8\n    alpha = 1.0\n    beta = 0.6\n    lambda_ = 0.2\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (kappa_c, s_hat, a_over_LT, q, c_amp, t_amp, L_norm)\n    test_cases = [\n        (0.8, 0.6, 3.0, 1.2, 0.35, 0.4, 1.0),\n        (1.4, 0.2, 4.0, 1.0, 0.8, 0.9, 1.4),\n        (0.5, 0.3, 2.0, 1.5, 0.2, 0.25, 0.9),\n        (1.0, 0.4, 3.5, 1.3, 0.5, 0.45, 1.1),\n        (1.0, 0.4, 3.5, 1.3, 0.5, 0.45, 1.1),\n        (0.9, 0.1, 1.8, 0.9, 0.15, 0.15, 0.7),\n        (1.2, 0.532, 3.0, 1.4, 0.4, 0.5, 1.2),\n    ]\n\n    def calculate_objectives(config):\n        \"\"\"\n        Calculates J_turb and J_coil for a single configuration.\n        \"\"\"\n        kappa_c, s_hat, a_over_LT, q, c_amp, t_amp, L_norm = config\n        \n        # Calculate J_turb\n        f_curv = kappa_c / (1.0 + q**2)\n        gamma_lin = C_gb * a_over_LT * f_curv\n        gamma_shear = C_sh * abs(s_hat)\n        j_turb = max(0.0, gamma_lin - gamma_shear)\n        \n        # Calculate J_coil\n        j_coil = alpha * c_amp**2 + beta * t_amp**2 + lambda_ * L_norm\n        \n        return j_turb, j_coil\n\n    n_configs = len(test_cases)\n    objectives = [calculate_objectives(case) for case in test_cases]\n    \n    pareto_indices = []\n    for i in range(n_configs):\n        is_dominated = False\n        for j in range(n_configs):\n            if i == j:\n                continue\n            \n            i_turb, i_coil = objectives[i]\n            j_turb, j_coil = objectives[j]\n            \n            # Check if configuration j dominates configuration i\n            # This requires j to be better or equal on all objectives...\n            if j_turb = i_turb and j_coil = i_coil:\n                # ...and strictly better on at least one objective.\n                if j_turb  i_turb or j_coil  i_coil:\n                    is_dominated = True\n                    break # Found a dominator, no need to check further for i\n        \n        if not is_dominated:\n            pareto_indices.append(i)\n            \n    pareto_indices.sort()\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, pareto_indices))}]\")\n\nsolve()\n```"
        }
    ]
}