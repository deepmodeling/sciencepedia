{
    "hands_on_practices": [
        {
            "introduction": "在托卡马克不均匀的磁场中，部分粒子会被“捕获”并在强磁场区域之间进行周期性的“反弹”运动。本练习将通过推导捕获电子的反弹频率 $\\omega_b$，来深入探究这些粒子的基本动力学。理解这一特征频率至关重要，因为它与等离子体波的共振是驱动捕获电子模 (TEM) 湍流的基本机制 。",
            "id": "4182964",
            "problem": "考虑一个具有圆形磁通面的大环径比托卡马克，其大半径为 $R$，小半径为 $r$，反环径比为 $\\epsilon \\equiv r/R \\ll 1$。在给定磁通面上，沿磁力线的磁场强度可近似为 $B(\\theta) = B_{0}\\left(1 - \\epsilon \\cos\\theta\\right)$，其中 $\\theta$ 是极向角，$B_{0}$ 是参考磁场强度。令 $q$ 表示安全因子。一个质量为 $m_{e}$、电荷为 $-e$ 的导心电子被深捕获，其螺距角接近 $90^{\\circ}$，平行于磁场的运动在 $\\theta \\approx 0$ 的外侧中平面附近进行小幅度振荡。假设磁矩 $\\mu \\equiv m_{e} v_{\\perp}^{2}/\\left(2 B\\right)$ 是绝热不变量，并使用磁镜力来描述平行动力学。沿磁力线的坐标为 $s$，对于大环径比圆形托卡马克，可以取 $ds \\approx q R\\, d\\theta$。\n\n从导心平行运动方程 $m_{e}\\, dv_{\\parallel}/dt = - \\mu\\, \\partial B/\\partial s$ 和给定的磁场几何出发，推导深捕获电子的小幅度弹跳频率 $\\omega_{b}$。用由 $v_{Te}^{2} \\equiv T_{e}/\\left(2 m_{e}\\right)$ 定义的特征电子速度 $v_{Te}$ 消去磁矩 $\\mu$（其中 $T_{e}$ 是电子温度），并假设对于 $\\theta \\approx 0$ 附近的深捕获电子有 $v_{\\perp}^{2} \\approx v^{2}$。然后，使用第一性原理推断，将得到的 $\\omega_{b}$ 与以整数弹跳谐波表示的无碰撞捕获电子模 (TEM) 共振条件联系起来。简要说明该弹跳共振条件如何在特征频率的层面上区分 TEM 主导的湍流与离子温度梯度 (ITG) 和电子温度梯度 (ETG) 机制。你最终报告的答案必须是 $\\omega_{b}$ 关于 $v_{Te}$、$\\epsilon$、$q$ 和 $R$ 的单个闭合形式解析表达式。",
            "solution": "该问题提法恰当且有科学依据，是磁约束聚变理论中的一个标准推导。所有必要的信息和近似都已提供。\n\n我们从电子平行速度 $v_{\\parallel}$ 的导心运动方程开始，该方程由磁镜力决定：\n$$m_{e}\\, \\frac{dv_{\\parallel}}{dt} = - \\mu\\, \\frac{\\partial B}{\\partial s}$$\n其中 $m_e$ 是电子质量，$\\mu$ 是守恒磁矩，$B$ 是磁场强度，$s$ 是沿磁力线的坐标。\n\n问题指明了大环径比圆形托卡马克的磁场几何：\n$$B(\\theta) = B_{0}\\left(1 - \\epsilon \\cos\\theta\\right)$$\n以及极向角 $\\theta$ 和磁力线坐标 $s$ 之间的关系：\n$$ds \\approx q R\\, d\\theta$$\n其中 $\\epsilon = r/R$ 是反环径比，$q$ 是安全因子，$R$ 是大半径。\n\n我们需要用极向角 $\\theta$ 来表示力项 $-\\mu \\frac{\\partial B}{\\partial s}$。使用链式法则：\n$$\\frac{\\partial B}{\\partial s} = \\frac{\\partial B}{\\partial \\theta} \\frac{d\\theta}{ds}$$\n首先，我们将 $B(\\theta)$ 对 $\\theta$ 求导：\n$$\\frac{\\partial B}{\\partial \\theta} = \\frac{d}{d\\theta} \\left[ B_{0}\\left(1 - \\epsilon \\cos\\theta\\right) \\right] = B_{0} \\epsilon \\sin\\theta$$\n根据弧长关系，我们有 $\\frac{d\\theta}{ds} \\approx \\frac{1}{qR}$。将这些代入 $\\frac{\\partial B}{\\partial s}$ 的表达式中：\n$$\\frac{\\partial B}{\\partial s} \\approx \\left(B_{0} \\epsilon \\sin\\theta\\right) \\left(\\frac{1}{qR}\\right) = \\frac{B_{0} \\epsilon \\sin\\theta}{qR}$$\n问题考虑的是一个深捕获电子，其平行运动是在外侧中平面 $\\theta \\approx 0$ 附近的小幅度振荡。对于小角度，我们可以使用近似 $\\sin\\theta \\approx \\theta$。\n$$\\frac{\\partial B}{\\partial s} \\approx \\frac{B_{0} \\epsilon \\theta}{qR}$$\n运动方程变为：\n$$m_{e}\\, \\frac{dv_{\\parallel}}{dt} \\approx - \\mu \\frac{B_{0} \\epsilon \\theta}{qR}$$\n为了得到关于 $\\theta$ 的微分方程，我们将 $v_{\\parallel}$ 与 $\\theta$ 联系起来。平行速度是沿磁力线位置的变化率，$v_{\\parallel} = \\frac{ds}{dt}$。使用 $s \\approx qR\\theta$，我们得到：\n$$v_{\\parallel} = \\frac{d}{dt}(qR\\theta) = qR \\frac{d\\theta}{dt}$$\n再对时间求一次导数，得到平行加速度：\n$$\\frac{dv_{\\parallel}}{dt} = qR \\frac{d^{2}\\theta}{dt^{2}}$$\n将此代入运动方程：\n$$m_{e} \\left(qR \\frac{d^{2}\\theta}{dt^{2}}\\right) = - \\mu \\frac{B_{0} \\epsilon \\theta}{qR}$$\n整理此方程可得：\n$$\\frac{d^{2}\\theta}{dt^{2}} = - \\left( \\frac{\\mu B_{0} \\epsilon}{m_{e} q^{2} R^{2}} \\right) \\theta$$\n这是简谐运动的标准方程 $\\frac{d^{2}x}{dt^{2}} = -\\omega^{2}x$。通过比较，弹跳频率 $\\omega_b$ 的平方是：\n$$\\omega_{b}^{2} = \\frac{\\mu B_{0} \\epsilon}{m_{e} q^{2} R^{2}}$$\n因此，弹跳频率为：\n$$\\omega_{b} = \\frac{1}{qR} \\sqrt{\\frac{\\mu B_{0} \\epsilon}{m_{e}}}$$\n接下来，我们必须用特征速度 $v_{Te}$ 消去磁矩 $\\mu$。问题给出的定义是 $v_{Te}^{2} \\equiv T_{e}/\\left(2 m_{e}\\right)$，其中 $T_e$ 是电子温度。我们将电子的特征动能与温度联系起来，即 $E_{kin} \\sim T_e$。对于深捕获粒子，垂直速度 $v_{\\perp}$ 远大于平行速度 $v_{\\parallel}$，因此总速度 $v$ 近似等于 $v_{\\perp}$。问题要求使用假设 $v_{\\perp}^{2} \\approx v^{2}$。\n特征动能为 $\\frac{1}{2}m_e v^2 \\sim T_e$。使用给定的 $v_{Te}$ 定义，我们有 $T_e = 2m_e v_{Te}^2$。\n因此 $\\frac{1}{2}m_e v^2 \\sim 2m_e v_{Te}^2$，这意味着 $v^2 \\sim 4v_{Te}^2$。\n由于 $v_{\\perp}^2 \\approx v^2$，我们得到垂直速度平方的特征值：$v_{\\perp}^2 \\approx 4v_{Te}^2$。\n磁矩定义为 $\\mu = \\frac{m_e v_{\\perp}^2}{2B}$。对于围绕 $\\theta=0$ 的小幅振荡，磁场为 $B \\approx B_0(1-\\epsilon) \\approx B_0$。因此，我们可以将 $\\mu$ 表示为：\n$$\\mu \\approx \\frac{m_e (4v_{Te}^2)}{2B_0} = \\frac{2m_e v_{Te}^2}{B_0}$$\n将这个 $\\mu$ 的表达式代入 $\\omega_b^2$ 的方程中：\n$$\\omega_{b}^{2} = \\frac{1}{m_{e} q^{2} R^{2}} \\left( \\frac{2m_e v_{Te}^2}{B_0} \\right) B_{0} \\epsilon = \\frac{2v_{Te}^{2}\\epsilon}{q^{2}R^{2}}$$\n取平方根，得到深捕获电子的小幅度弹跳频率的最终表达式：\n$$\\omega_{b} = \\frac{\\sqrt{2\\epsilon} v_{Te}}{qR}$$\n现在，我们将其与捕获电子模 (TEM) 共振联系起来。频率为 $\\omega$ 的波与捕获粒子发生共振相互作用的一般条件是，波频率与粒子在波框架中周期性运动的谐波相匹配。该条件由下式给出：\n$$\\omega - \\omega_{de} = p \\omega_{b}$$\n其中 $\\omega_{de}$ 是电子的弹跳平均环向进动漂移频率，$\\omega_b$ 是其弹跳频率，$p$ 是一个整数（弹跳谐波）。占主导地位、最不稳定的 TEM 通常是频率为 $\\omega \\sim \\omega_{*e}$（电子抗磁频率）的低频漂移波，与进动发生共振。这对应于 $p=0$ 的谐波，即 $\\omega \\approx \\omega_{de}$。为了使这些模存在，捕获电子的弹跳运动必须比波频率快，即 $\\omega_{b} \\gg \\omega \\approx \\omega_{de}$。\n\n最后，我们根据特征频率来区分 TEM 机制与 ITG 和 ETG 机制。\n- **TEM (捕获电子模):** 这种模的存在从根本上与捕获电子的动力学相关。其不稳定性由上述共振条件驱动，涉及电子弹跳频率 $\\omega_{b}$ 和进动频率 $\\omega_{de}$。该模存在于离子回旋半径尺度（$k_\\perp \\rho_s \\sim 1$），频率为 $\\omega \\sim \\omega_{*e} \\approx \\omega_{de}$。\n- **ITG (离子温度梯度) 模:** 这也是一种离子尺度的不稳定性（$k_\\perp \\rho_s \\sim 1$），但由离子温度梯度驱动。其特征频率由离子动力学决定，$\\omega \\sim \\omega_{*i}$（离子抗磁频率）。其物理过程由离子共振（例如，与离子渡越频率的共振）主导，而电子弹跳频率 $\\omega_b$ 并不是该不稳定机制的核心参数。通常假设电子具有简单的绝热响应。\n- **ETG (电子温度梯度) 模:** 这是一种电子尺度的不稳定性（$k_\\perp \\rho_e \\sim 1$），是 ITG 的电子尺度类似物。其特征频率远高于 ITG 或 TEM，通常为 $\\omega \\sim v_{Te}/L_{Te}$。在这个高频区域，$\\omega \\gg \\omega_{b}$。电子没有足够的时间在一个波周期内完成一个弹跳轨道。因此，捕获粒子弹跳共振的概念不适用。离子基本静止，提供一个中性化背景。\n\n总之，TEM 机制的独特性在于它是由与捕获电子的共振相互作用定义的，其中电子弹跳频率 $\\omega_b$ 设定了一个比模频率快得多的特征时间尺度，而这个条件不适用于 ITG 或 ETG 湍流的基本驱动机制。",
            "answer": "$$ \\boxed{\\frac{\\sqrt{2\\epsilon} v_{Te}}{qR}} $$"
        },
        {
            "introduction": "等离子体湍流会引起密度、温度和电磁场的涨落，但这些微观涨落是如何导致宏观输运的呢？本练习将演示湍流输运由涨落量之间的统计相关性产生的基本机制。通过计算时间平均的粒子通量 $\\Gamma_e$，您将看到输运的大小和方向是如何由涨落的振幅以及它们之间的相位关系决定的 。",
            "id": "4182966",
            "problem": "在托卡马克芯部的局域平板模型中，考虑由捕获电子模 (TEM) 主导的静电、单$\\mathbf{k}$湍流。设 $\\mathbf{x} = (x,y,z)$ 表示局域直角坐标，其中 $x$ 是径向坐标，$y$ 是副法向 (极向) 坐标，$z$ 沿平均磁场方向。假设存在均匀磁场 $\\mathbf{B} = B \\,\\hat{\\mathbf{z}}$，其大小 $B = 2.5\\,\\mathrm{T}$，以及一个波矢为 $\\mathbf{k} = k_{y}\\,\\hat{\\mathbf{y}}$ (其中 $k_{y} = 200\\,\\mathrm{m}^{-1}$) 的单一静电涨落模。涨落的静电势和电子密度分别为\n$$\n\\tilde{\\phi}(\\mathbf{x},t) = \\Re\\left\\{ \\Phi \\exp\\!\\left[i(\\mathbf{k}\\cdot\\mathbf{x} - \\omega t)\\right]\\right\\},\\quad\n\\tilde{n}_{e}(\\mathbf{x},t) = \\Re\\left\\{ N \\exp\\!\\left[i(\\mathbf{k}\\cdot\\mathbf{x} - \\omega t)\\right]\\right\\},\n$$\n其中 $N$ 和 $\\Phi$ 是复振幅，其模分别为 $|N| = 2.5\\times 10^{17}\\,\\mathrm{m}^{-3}$ 和 $|\\Phi| = 20\\,\\mathrm{V}$。密度与电势之间的交叉相位定义为 $\\Delta \\equiv \\arg(N) - \\arg(\\Phi)$，并且对于这个由TEM主导的状态，测量值为 $\\Delta = -30^\\circ$ (度)。静电近似成立，粒子的 $E\\times B$ 漂移由基本表达式 $\\mathbf{v}_{E} = \\mathbf{E}\\times\\mathbf{B}/B^{2}$ 给出，其中 $\\mathbf{E} = -\\nabla \\tilde{\\phi}$。\n\n从这些定义出发，且不引入任何额外的模型封闭，推导对于单个模式的时间平均径向电子粒子通量\n$$\n\\Gamma_{e} \\equiv \\langle \\tilde{n}_{e}\\,\\tilde{v}_{E,x}\\rangle\n$$\n的闭合形式表达式，该表达式用 $|N|$、 $|\\Phi|$、 $k_{y}$、 $B$ 和交叉相位 $\\Delta$ 表示。然后，使用给定的参数对 $\\Gamma_{e}$ 进行数值计算。在您的推导中，请明确说明交叉相位 $\\Delta$ 如何决定 $\\Gamma_{e}$ 的符号 (向内或向外)。\n\n使用符号约定，即正的 $\\Gamma_{e}$ 对应于径向向外输运。将 $\\Gamma_{e}$ 的最终数值以 $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 为单位表示，并将您的答案四舍五入到三位有效数字。给定角度 $\\Delta$ 的单位是度。",
            "solution": "### 径向粒子通量的推导\n\n时间平均的径向电子粒子通量 $\\Gamma_{e}$ 定义为涨落的电子密度 $\\tilde{n}_{e}$ 与涨落的 $E \\times B$ 漂移速度的径向分量 $\\tilde{v}_{E,x}$ 之间的相关。\n$$\n\\Gamma_{e} = \\langle \\tilde{n}_{e}\\,\\tilde{v}_{E,x}\\rangle\n$$\n尖括号 $\\langle \\cdot \\rangle$ 表示在一个振荡周期内的时间平均。对于两个实值涨落量 $\\tilde{A}(\\mathbf{x}, t) = \\Re\\{\\hat{A}(\\mathbf{x}, t)\\}$ 和 $\\tilde{B}(\\mathbf{x}, t) = \\Re\\{\\hat{B}(\\mathbf{x}, t)\\}$，其中 $\\hat{A}$ 和 $\\hat{B}$ 是它们以相同频率振荡的复数表示，它们的乘积的时间平均由以下公式给出：\n$$\n\\langle \\tilde{A} \\tilde{B} \\rangle = \\frac{1}{2} \\Re\\{ \\hat{A}^* \\hat{B} \\} = \\frac{1}{2} \\Re\\{ \\hat{A} \\hat{B}^* \\}\n$$\n其中 `*` 表示复共轭。我们将使用这个恒等式进行计算。\n\n首先，我们确定 $E \\times B$ 漂移速度的径向分量 $\\tilde{v}_{E,x}$ 的表达式。涨落电场 $\\mathbf{E}$ 是涨落电势 $\\tilde{\\phi}$ 的负梯度：\n$$\n\\mathbf{E} = -\\nabla\\tilde{\\phi} = -\\nabla \\Re\\left\\{ \\Phi \\exp\\!\\left[i(k_y y - \\omega t)\\right]\\right\\}\n$$\n使用场的复数表示更为方便。设 $\\hat{\\phi}(\\mathbf{x}, t) = \\Phi \\exp[i(k_y y - \\omega t)]$。复电场为：\n$$\n\\hat{\\mathbf{E}} = -\\nabla \\hat{\\phi} = -\\frac{\\partial}{\\partial y}\\left(\\Phi \\exp[i(k_y y - \\omega t)]\\right)\\hat{\\mathbf{y}} = -ik_y \\Phi \\exp[i(k_y y - \\omega t)]\\,\\hat{\\mathbf{y}} = -ik_y \\hat{\\phi}\\,\\hat{\\mathbf{y}}\n$$\n接下来，我们计算复 $E \\times B$ 漂移速度 $\\hat{\\mathbf{v}}_{E}$：\n$$\n\\hat{\\mathbf{v}}_{E} = \\frac{\\hat{\\mathbf{E}} \\times \\mathbf{B}}{B^2} = \\frac{(-ik_y \\hat{\\phi}\\,\\hat{\\mathbf{y}}) \\times (B\\,\\hat{\\mathbf{z}})}{B^2}\n$$\n使用矢量恒等式 $\\hat{\\mathbf{y}} \\times \\hat{\\mathbf{z}} = \\hat{\\mathbf{x}}$，我们得到：\n$$\n\\hat{\\mathbf{v}}_{E} = \\frac{-ik_y B \\hat{\\phi}}{B^2}\\,\\hat{\\mathbf{x}} = -\\frac{ik_y \\hat{\\phi}}{B}\\,\\hat{\\mathbf{x}}\n$$\n因此，该速度的复径向分量为：\n$$\n\\hat{v}_{E,x} = -\\frac{ik_y}{B} \\hat{\\phi}\n$$\n现在我们可以使用时间平均公式计算通量 $\\Gamma_{e}$。我们有复密度涨落 $\\hat{n}_e = N \\exp[i(k_y y - \\omega t)]$。\n$$\n\\Gamma_{e} = \\langle \\tilde{n}_{e} \\tilde{v}_{E,x} \\rangle = \\frac{1}{2} \\Re\\left\\{ \\hat{n}_{e}^* \\hat{v}_{E,x} \\right\\}\n$$\n代入 $\\hat{n}_{e}$ 和 $\\hat{v}_{E,x}$ 的表达式：\n$$\n\\Gamma_{e} = \\frac{1}{2} \\Re\\left\\{ \\left(N \\exp[i(k_y y - \\omega t)]\\right)^* \\left(-\\frac{ik_y}{B} \\Phi \\exp[i(k_y y - \\omega t)]\\right) \\right\\}\n$$\n含时指数项相互抵消：\n$$\n\\Gamma_{e} = \\frac{1}{2} \\Re\\left\\{ -\\frac{ik_y}{B} N^* \\Phi \\right\\}\n$$\n为计算此表达式，我们将复振幅 $N$ 和 $\\Phi$ 用极坐标形式表示：\n$N = |N| \\exp(i\\alpha_N)$ 和 $\\Phi = |\\Phi| \\exp(i\\alpha_\\Phi)$，其中 $\\alpha_N = \\arg(N)$ 和 $\\alpha_\\Phi = \\arg(\\Phi)$。\n乘积 $N^* \\Phi$ 变为：\n$$\nN^* \\Phi = \\left(|N| \\exp(-i\\alpha_N)\\right) \\left(|\\Phi| \\exp(i\\alpha_\\Phi)\\right) = |N||\\Phi| \\exp(i(\\alpha_\\Phi - \\alpha_N))\n$$\n根据定义，交叉相位为 $\\Delta = \\alpha_N - \\alpha_\\Phi$。因此，$\\alpha_\\Phi - \\alpha_N = -\\Delta$。\n$$\nN^* \\Phi = |N||\\Phi| \\exp(-i\\Delta)\n$$\n将此代回 $\\Gamma_{e}$ 的表达式中：\n$$\n\\Gamma_{e} = \\frac{1}{2} \\Re\\left\\{ -\\frac{ik_y}{B} |N||\\Phi| \\exp(-i\\Delta) \\right\\}\n$$\n使用欧拉公式 $\\exp(-i\\Delta) = \\cos(\\Delta) - i\\sin(\\Delta)$：\n$$\n\\Gamma_{e} = \\frac{1}{2} \\Re\\left\\{ -\\frac{ik_y|N||\\Phi|}{B} \\left(\\cos(\\Delta) - i\\sin(\\Delta)\\right) \\right\\}\n$$\n$$\n\\Gamma_{e} = \\frac{1}{2} \\Re\\left\\{ \\frac{k_y|N||\\Phi|}{B} \\left(-i\\cos(\\Delta) + i^2\\sin(\\Delta)\\right) \\right\\} = \\frac{1}{2} \\Re\\left\\{ \\frac{k_y|N||\\Phi|}{B} \\left(-\\sin(\\Delta) - i\\cos(\\Delta)\\right) \\right\\}\n$$\n取表达式的实部，得到粒子通量的最终闭合形式表达式：\n$$\n\\Gamma_{e} = -\\frac{k_y |N| |\\Phi|}{2B} \\sin(\\Delta)\n$$\n该表达式表明，湍流粒子通量与涨落振幅、波数以及密度与电势涨落之间的交叉相位角正弦值成正比，与磁场强度成反比。\n\n$\\Gamma_{e}$ 的符号由 $-\\sin(\\Delta)$ 的符号决定，因为 $k_y$、 $|N|$、 $|\\Phi|$ 和 $B$ 均为正值。\n-   如果 $0^\\circ  \\Delta  180^\\circ$，则 $\\sin(\\Delta) > 0$，所以 $\\Gamma_{e}  0$ (向内通量)。\n-   如果 $-180^\\circ  \\Delta  0^\\circ$，则 $\\sin(\\Delta)  0$，所以 $\\Gamma_{e} > 0$ (向外通量)。\n问题指明这是一个TEM主导的状态，其输运预计是向外的。给定的交叉相位是 $\\Delta = -30^\\circ$，位于区间 $(-180^\\circ, 0^\\circ)$ 内。因此，我们预期一个正的（向外）通量，这与捕获电子模的物理特性一致。\n\n### 数值计算\n我们现在将给定的数值代入推导出的表达式中。\n-   $k_{y} = 200\\,\\mathrm{m}^{-1}$\n-   $|N| = 2.5\\times 10^{17}\\,\\mathrm{m}^{-3}$\n-   $|\\Phi| = 20\\,\\mathrm{V}$\n-   $B = 2.5\\,\\mathrm{T}$\n-   $\\Delta = -30^\\circ$\n\n首先，我们计算 $\\sin(\\Delta)$：\n$$\n\\sin(-30^\\circ) = -0.5\n$$\n现在，我们计算 $\\Gamma_{e}$：\n$$\n\\Gamma_{e} = -\\frac{(200\\,\\mathrm{m}^{-1}) (2.5\\times 10^{17}\\,\\mathrm{m}^{-3}) (20\\,\\mathrm{V})}{2(2.5\\,\\mathrm{T})} \\sin(-30^\\circ)\n$$\n$$\n\\Gamma_{e} = -\\frac{200 \\times (2.5 \\times 10^{17}) \\times 20}{5.0} \\times (-0.5)\n$$\n两个负号相互抵消：\n$$\n\\Gamma_{e} = \\frac{200 \\times 2.5 \\times 10^{17} \\times 20 \\times 0.5}{5.0} \\, \\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\n$$\n\\Gamma_{e} = \\frac{5000 \\times 10^{17}}{5.0} \\, \\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\n$$\n\\Gamma_{e} = 1000 \\times 10^{17} \\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} = 1.0 \\times 10^{20} \\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\n四舍五入到三位有效数字，结果是 $1.00 \\times 10^{20} \\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\n\\boxed{1.00 \\times 10^{20}}\n$$"
        },
        {
            "introduction": "聚变实验中观察到的一个关键特征是湍流输运可能是“刚性”的，这意味着一旦驱动温度或密度梯度超过某个临界阈值，输运就会急剧增加。这个动手编程练习采用了一个简化但物理上深刻的模型来量化不同湍流状态下的这种刚性。通过这个实践，您将探究为何离子温度梯度 (ITG) 驱动的输运通常是刚性的，这一特性对预测和控制聚变等离子体性能具有深远影响 。",
            "id": "4182974",
            "problem": "考虑通过计算离子热通量相对于不稳定性阈值附近的归一化离子温度梯度的斜率，来定量评估离子尺度湍流中的输运刚度这一目标。重点关注离子温度梯度 (ITG) 模、捕获电子模 (TEM) 和电子温度梯度 (ETG) 模主导的湍流模区，使用一个适用于聚变等离子体湍流模拟的、简化的、有科学依据的准线性闭合模型。\n\n假设以下基本前提：\n1. 离子热通量 $Q_i$ 遵循一个扩散闭合关系 $Q_i = - n_i \\chi_i \\partial T_i / \\partial r$，其中 $n_i$ 是离子密度，$T_i$ 是离子温度，$r$ 是小半径，$\\chi_i$ 是有效离子热扩散系数。\n2. 有效扩散系数的混合长度估计给出 $\\chi_i \\sim \\gamma / k_\\perp^2$，其中 $\\gamma$ 是线性不稳定性增长率，$k_\\perp$ 是一个特征垂直波数。\n3. 在临界稳定性阈值附近，增长率近似为 $\\gamma \\propto \\max(0, x - x_c)$，其中 $x = R/L_{T_i}$ 是归一化离子温度梯度，$R$ 是一个特征大半径标度，$L_{T_i}^{-1} = |\\partial \\ln T_i / \\partial r|$，而 $x_c$ 是不稳定性发生的临界梯度。这捕捉了接近阈值时驱动的线性趋势。\n4. 剪切电场叉磁场 ($E \\times B$) 漂移可以抑制湍流输运。通过一个因子 $S = 1 / (1 + (\\gamma_E / \\gamma)^m)$ 来对此抑制效应建模，其中 $\\gamma_E$ 是 $E \\times B$ 剪切率，$m$ 是一个量级为1的指数。在没有流动剪切的情况下，取 $\\gamma_E = 0$，因此 $S = 1$。\n5. 在回旋-玻姆归一化单位下进行计算，其中归一化离子热通量定义为 $\\hat{Q}_i = Q_i / Q_{\\text{gB}}$，其中 $Q_{\\text{gB}} = n_i T_i c_s \\rho_s^2 / R$，$c_s$ 是声速，$\\rho_s$ 是离子声拉莫尔半径。在这种归一化中，比例常数可以被归并为一个无量纲振幅参数 $A$。\n\n在这些假设下，实现一个程序，该程序能够：\n- 使用上述闭合关系，为ITG构建一个依赖于模区的归一化离子热通量函数 $\\hat{Q}_i(x)$，参数为 $(A, x_c, \\gamma_0, m, \\gamma_E)$。对于TEM，认识到离子热通量对离子温度梯度的响应较弱，因此引入一个耦合因子 $\\zeta \\ll 1$ 乘以梯度驱动。对于ETG，假设离子热通量对 $x$ 变化的响应在主导阶上可以忽略。\n- 通过在 $x_0 = x_c + \\epsilon$ 处使用模板 $(\\hat{Q}_i(x_0 + \\epsilon/2) - \\hat{Q}_i(x_0 - \\epsilon/2)) / \\epsilon$ 计算中心有限差分，来计算阈值附近的数值导数 $d\\hat{Q}_i/dx$，其中 $\\epsilon$ 是一个小步长。\n- 使用 $\\epsilon = 10^{-2}$，即 $\\epsilon = 0.01$，确保 $x_0 - \\epsilon/2  x_c$ 以避免跨越阈值的不连续点。\n\n在你的解决方案中解释，为什么ITG湍流在许多参数体系中表现出刚性输运，将阈值附近较大的斜率 $d\\hat{Q}_i/dx$ 与背景梯度 $x$ 和超出阈值的部分 $(x - x_c)$ 的乘性耦合以及在低 $E \\times B$ 剪切下相对较弱的饱和机制联系起来，并将其与TEM和ETG的情况进行对比。\n\n物理和数值单位：\n- 所有输出均以回旋-玻姆归一化单位表示，为无量纲梯度 $x = R/L_{T_i}$ 每单位变化对应的无量纲浮点数。\n- 不涉及角度。\n\n测试套件：\n为以下五个参数集评估 $d\\hat{Q}_i/dx$，每个都在阈值附近，并使用相同的 $\\epsilon$：\n1. ITG主导无剪切情况：在 $x_0 = x_c + \\epsilon$ 处，参数为 $(A = 2.0, x_c = 3.5, \\gamma_0 = 0.2, m = 1, \\gamma_E = 0.0)$，$\\epsilon = 0.01$。\n2. ITG主导有剪切情况：在 $x_0 = x_c + \\epsilon$ 处，参数为 $(A = 2.0, x_c = 3.5, \\gamma_0 = 0.2, m = 1, \\gamma_E = 0.02)$，$\\epsilon = 0.01$。\n3. TEM主导情况（离子热通量与 $x$ 的耦合较弱）：在 $x_0 = x_c + \\epsilon$ 处，参数为 $(A = 0.3, x_c = 5.0, \\gamma_0 = 0.1, m = 1, \\gamma_E = 0.0, \\zeta = 0.1)$，$\\epsilon = 0.01$。\n4. ETG主导情况（离子热通量对 $x$ 的敏感度可忽略）：在 $x_0 = x_c + \\epsilon$ 处，参数为 $(A = 0.0, x_c = 2.5)$，$\\epsilon = 0.01$。\n5. ITG主导情况（振幅较小）：在 $x_0 = x_c + \\epsilon$ 处，参数为 $(A = 0.5, x_c = 3.5, \\gamma_0 = 0.2, m = 1, \\gamma_E = 0.0)$，$\\epsilon = 0.01$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是测试套件中对应测试用例计算出的导数 $d\\hat{Q}_i/dx$。",
            "solution": "### 1. 准线性离子热通量模型的构建\n\n该问题要求构建一个关于归一化离子热通量 $\\hat{Q}_i$ 作为归一化离子温度梯度 $x = R/L_{T_i}$ 的函数模型。我们从提供的基本假设开始。\n\n1.  离子热通量 $Q_i$ 遵循扩散定律：$Q_i = - n_i \\chi_i \\frac{\\partial T_i}{\\partial r}$。使用定义 $L_{T_i}^{-1} = - \\frac{1}{T_i} \\frac{\\partial T_i}{\\partial r}$ (假设 $\\frac{\\partial T_i}{\\partial r}  0$) 和 $x = R/L_{T_i}$，热通量变为：$Q_i = n_i \\chi_i \\frac{T_i x}{R}$。\n\n2.  有效扩散系数 $\\chi_i$ 由混合长度估计给出，$\\chi_i \\sim \\gamma / k_\\perp^2$，其中 $\\gamma$ 是主导不稳定性的线性增长率。在临界稳定性阈值 $x_c$ 附近，增长率被建模为与超出的梯度成正比：$\\gamma(x) = \\gamma_0 \\max(0, x - x_c)$。\n\n3.  $E \\times B$ 剪切抑制效应通过一个因子 $S$ 被引入：$S(x) = \\frac{1}{1 + (\\gamma_E / \\gamma(x))^m}$。有效扩散系数为 $\\chi_{i, \\text{eff}} = \\chi_i \\cdot S(x)$。\n\n4.  使用回旋-玻姆热通量 $Q_{\\text{gB}} = n_i T_i c_s \\rho_s^2 / R$ 进行归一化，并将所有比例常数归入一个单一的无量纲振幅参数 $A$ 中。代入 $\\gamma(x)$ 的模型，我们得到了当 $x > x_c$ 时归一化离子热通量的一般表达式：\n    $$\\hat{Q}_i(x) = A \\cdot x \\cdot (x - x_c) \\cdot \\frac{1}{1 + \\left( \\frac{\\gamma_E}{\\gamma_0 (x - x_c)} \\right)^m}$$\n    对于 $x \\le x_c$，$\\hat{Q}_i(x) = 0$。\n\n### 2. 特定模区的模型与输运刚度\n\n输运“刚度”指的是这样一个性质：当驱动梯度（这里是 $x$）的微小增加超过一个临界阈值时，会导致湍流热通量（这里是 $\\hat{Q}_i$）的急剧增大。刚度由导数 $d\\hat{Q}_i/dx$ 来定量测量。\n\n*   **ITG主导模区**：上面推导的一般模型直接适用。在没有 $E \\times B$ 剪切（$\\gamma_E=0$）的情况下，模型简化为 $\\hat{Q}_i^{\\text{ITG}}(x) = A \\cdot x \\cdot (x - x_c)$。通量对梯度驱动的这种近似二次方依赖关系是刚性输运的根源。一旦梯度超过 $x_c$，通量会迅速增加，从而有效地将温度剖面梯度“钉扎”在临界值 $x_c$ 附近。\n\n*   **TEM主导模区**：捕获电子模 (TEM) 主要由电子梯度驱动，与离子温度梯度的耦合比ITG模弱。问题通过引入一个耦合因子 $\\zeta \\ll 1$ 来对此建模，该因子缩放了由离子温度梯度产生的有效增长率。模型变为：\n    $$\\hat{Q}_i^{\\text{TEM}}(x) = A \\cdot x \\cdot \\zeta(x - x_c) \\cdot \\frac{1}{1 + \\left( \\frac{\\gamma_E}{\\gamma_0 \\zeta (x - x_c)} \\right)^m}$$\n    因此，刚度被这个因子 $\\zeta$ 减小，导致了刚度较低，或者说更具“弹性”的离子温度剖面。\n\n*   **ETG主导模区**：电子温度梯度 (ETG) 模存在于非常小的空间尺度，在驱动离子尺度输运方面效率很低。因此，它们对离子热通量 $\\hat{Q}_i$ 的贡献被认为是可忽略的。这通过设置振幅 $A=0$ 来建模，从而得到 $\\hat{Q}_i^{\\text{ETG}}(x) = 0$，因此刚度为零。\n\n### 3. $E \\times B$ 剪切效应\n\n在存在有限剪切流（$\\gamma_E > 0$）的情况下，抑制因子 $S(x)$ 小于1。对于刚超过阈值的梯度（$x \\to x_c^+$），增长率 $\\gamma(x)$ 非常小，这使得比值 $\\gamma_E/\\gamma$ 很大，导致强抑制。这种行为降低了通量及其斜率 $d\\hat{Q}_i/dx$，尤其是在阈值附近，从而降低了输运刚度。\n\n### 4. 数值计算\n\n任务是使用在 $x_0 = x_c + \\epsilon$ 处计算的中心有限差分格式来计算导数 $d\\hat{Q}_i/dx$，其中 $\\epsilon = 10^{-2}$。\n$$\\frac{d\\hat{Q}_i}{dx} \\bigg|_{x_0} \\approx \\frac{\\hat{Q}_i(x_0 + \\epsilon/2) - \\hat{Q}_i(x_0 - \\epsilon/2)}{\\epsilon}$$\n下面的Python代码实现了这个计算。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the transport stiffness d(Q_i)/d(x) for different turbulence regimes\n    near the instability threshold.\n    \"\"\"\n\n    def get_q_hat(x, A, xc, gamma_0, m, gamma_E, zeta):\n        \"\"\"\n        Calculates the normalized ion heat flux for a given set of parameters.\n        \"\"\"\n        if x = xc:\n            return 0.0\n\n        drive = x - xc\n        effective_drive = zeta * drive\n        flux_no_suppression = A * x * effective_drive\n\n        if gamma_E == 0.0:\n            return flux_no_suppression\n\n        gamma = gamma_0 * effective_drive\n        \n        if gamma == 0.0:\n            return 0.0\n            \n        suppression_factor = 1.0 / (1.0 + (gamma_E / gamma)**m)\n\n        return flux_no_suppression * suppression_factor\n\n    test_cases = [\n        (2.0, 3.5, 0.2, 1.0, 0.0, 1.0),\n        (2.0, 3.5, 0.2, 1.0, 0.02, 1.0),\n        (0.3, 5.0, 0.1, 1.0, 0.0, 0.1),\n        (0.0, 2.5, 1.0, 1.0, 0.0, 1.0),\n        (0.5, 3.5, 0.2, 1.0, 0.0, 1.0),\n    ]\n\n    epsilon = 0.01\n    results = []\n\n    for params in test_cases:\n        A, xc, gamma_0, m, gamma_E, zeta = params\n        \n        x0 = xc + epsilon\n        x_minus = x0 - epsilon / 2.0\n        x_plus = x0 + epsilon / 2.0\n        \n        q_minus = get_q_hat(x_minus, A, xc, gamma_0, m, gamma_E, zeta)\n        q_plus = get_q_hat(x_plus, A, xc, gamma_0, m, gamma_E, zeta)\n\n        stiffness = (q_plus - q_minus) / epsilon\n        results.append(stiffness)\n\n    formatted_results = [f\"{res:.10f}\".rstrip('0').rstrip('.') for res in results]\n    return f\"[{','.join(formatted_results)}]\"\n\n# This is for internal verification; the function returns the required string.\n# print(solve())\n```",
            "answer": "[7.04,1.2085392977,0.1506,0,1.76]"
        }
    ]
}