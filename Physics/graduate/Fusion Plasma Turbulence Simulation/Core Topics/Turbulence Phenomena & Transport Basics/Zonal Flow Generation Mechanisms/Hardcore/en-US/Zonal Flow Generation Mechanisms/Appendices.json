{
    "hands_on_practices": [
        {
            "introduction": "At the heart of zonal flow theory is the concept that large-scale, organized flows can be spontaneously generated from the chaotic motion of smaller-scale turbulent eddies. This counter-intuitive process is elegantly captured by the Reynolds stress, which quantifies the net transport of momentum by the turbulent fluctuations. This exercise provides a foundational, hands-on derivation of the mean-flow evolution equation, allowing you to see precisely how the divergence of the Reynolds stress acts as a source that drives zonal flows against viscous damping . By solving for a steady-state flow profile, you will solidify your understanding of this crucial drive-dissipation balance that governs the amplitude of zonal flows.",
            "id": "4209597",
            "problem": "Consider electrostatic, two-dimensional (2D) turbulence in a slab geometry with a uniform magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$. The $\\mathbf{E} \\times \\mathbf{B}$ velocity is $\\mathbf{v} = \\frac{c}{B} \\hat{\\mathbf{z}} \\times \\nabla \\phi$, where $\\phi(x,y,t)$ is the electrostatic potential, $c$ is the speed of light, and $B$ is the magnetic field magnitude. Zonal flows are defined as flux-surface averages of the poloidal component of $\\mathbf{v}$, i.e., $U(x,t) \\equiv \\langle v_{y} \\rangle_{y}$, where $\\langle \\cdot \\rangle_{y}$ denotes an average over the poloidal coordinate $y$.\n\nStarting from momentum conservation for an incompressible ion fluid and Reynolds averaging (decompose $\\mathbf{v} = \\mathbf{U} + \\mathbf{v}'$ with $\\mathbf{U} = U(x,t)\\hat{\\mathbf{y}}$ and $\\langle \\mathbf{v}' \\rangle_{y} = \\mathbf{0}$), include collisional viscosity modeled as a kinematic viscosity $\\nu_{c}$ acting on the mean flow. Use these ingredients to derive the mean-flow evolution equation that contains the divergence of the Reynolds stress $R(x,t) \\equiv \\langle v_{x} v_{y} \\rangle_{y}$ as a drive and viscous diffusion of $U(x,t)$ as a dissipation. Then, under the assumption of a time-independent, prescribed Reynolds stress profile\n$$\nR(x) = R_{0} \\sin(k x),\n$$\nwith $R_{0} > 0$ and $k > 0$ constants, compute the steady-state zonal flow amplitude, defined as\n$$\nU_{\\mathrm{amp}} \\equiv \\max_{x} |U(x)|,\n$$\nsubject to periodic boundary conditions in $x$ with period $2\\pi/k$ and the constraint $\\langle U \\rangle_{x} = 0$. Express your final answer as a closed-form analytical expression in terms of $R_{0}$, $\\nu_{c}$, and $k$ only.\n\nAlthough you will provide an analytical expression, the amplitude represents a velocity and would be expressed in meters per second if evaluated numerically. Do not substitute numerical values and do not round; provide only the analytic expression for $U_{\\mathrm{amp}}$.",
            "solution": "The first step is to derive the evolution equation for the mean poloidal flow, or zonal flow, $U(x,t) \\equiv \\langle v_{y} \\rangle_{y}$. We start from the momentum conservation equation for an incompressible fluid in two dimensions ($x$, $y$). The equation for the $y$-component of velocity, $v_y$, can be written in conservative form using the incompressibility condition $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} = 0$:\n$$\n\\frac{\\partial v_y}{\\partial t} + \\frac{\\partial}{\\partial x}(v_x v_y) + \\frac{\\partial}{\\partial y}(v_y^2) = \\mathcal{F}_y\n$$\nwhere $\\mathcal{F}_y$ is the $y$-component of the force-per-unit-mass acting on the fluid. The problem specifies that this force is due to collisional viscosity acting on the mean flow, $U(x,t)$. The mean flow is defined as $\\mathbf{U}(x,t) = U(x,t)\\hat{\\mathbf{y}}$. The viscous force is thus $\\nu_c \\nabla^2 \\mathbf{U} = \\nu_c \\nabla^2 (U(x,t)\\hat{\\mathbf{y}})$. Since $U$ depends only on $x$, this simplifies to $\\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\hat{\\mathbf{y}}$. Therefore, the force component is $\\mathcal{F}_y = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$.\n\nWe now apply Reynolds averaging by taking the average, denoted by $\\langle \\cdot \\rangle_y$, of the momentum equation over the poloidal coordinate $y$.\n$$\n\\left\\langle \\frac{\\partial v_y}{\\partial t} \\right\\rangle_y + \\left\\langle \\frac{\\partial}{\\partial x}(v_x v_y) \\right\\rangle_y + \\left\\langle \\frac{\\partial}{\\partial y}(v_y^2) \\right\\rangle_y = \\left\\langle \\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\right\\rangle_y\n$$\nWe analyze each term. The first term becomes $\\frac{\\partial}{\\partial t}\\langle v_y \\rangle_y = \\frac{\\partial U}{\\partial t}$ by definition of $U(x,t)$. The second term becomes $\\frac{\\partial}{\\partial x}\\langle v_x v_y \\rangle_y = \\frac{\\partial R}{\\partial x}$ by definition of the Reynolds stress $R(x,t)$. The third term, assuming periodic boundary conditions in the $y$ direction (as implied by the term \"poloidal coordinate\"), vanishes: $\\langle \\frac{\\partial}{\\partial y}(v_y^2) \\rangle_y = \\frac{1}{L_y} \\int_0^{L_y} \\frac{\\partial}{\\partial y}(v_y^2) dy = \\frac{1}{L_y}[v_y^2]_{0}^{L_y} = 0$. The term on the right-hand side is already a function of $x$ and $t$ only, so the average does not change it: $\\langle \\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\rangle_y = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$.\nCombining these terms, we obtain the mean-flow evolution equation:\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial R}{\\partial x} = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}\n$$\nThis can be written as $\\frac{\\partial U}{\\partial t} = -\\frac{\\partial R}{\\partial x} + \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$, which shows that the zonal flow is driven by the divergence of the Reynolds stress (specifically, the force is $-\\frac{\\partial R}{\\partial x}$) and damped by viscous diffusion.\n\nThe second part of the problem requires finding the steady-state solution. In steady state, $\\frac{\\partial U}{\\partial t} = 0$. We are given the time-independent Reynolds stress profile $R(x) = R_{0} \\sin(k x)$. The evolution equation becomes an ordinary differential equation (ODE) for $U(x)$:\n$$\n-\\frac{d R}{d x} + \\nu_c \\frac{d^2 U}{d x^2} = 0\n$$\nSubstituting the expression for $R(x)$:\n$$\n\\nu_c \\frac{d^2 U}{d x^2} = \\frac{d}{dx} \\left(R_{0} \\sin(k x)\\right) = k R_{0} \\cos(k x)\n$$\nWe integrate this ODE twice with respect to $x$. The first integration yields:\n$$\n\\nu_c \\frac{dU}{dx} = \\int k R_{0} \\cos(k x) \\, dx = R_{0} \\sin(k x) + C_1\n$$\nwhere $C_1$ is the first integration constant. Integrating again:\n$$\n\\nu_c U(x) = \\int \\left(R_{0} \\sin(k x) + C_1\\right) \\, dx = -\\frac{R_{0}}{k} \\cos(k x) + C_1 x + C_2\n$$\nwhere $C_2$ is the second integration constant. The solution for $U(x)$ is:\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_1}{\\nu_c} x + \\frac{C_2}{\\nu_c}\n$$\nWe now apply the boundary conditions and constraints to determine $C_1$ and $C_2$. The solution must be periodic in $x$ with period $2\\pi/k$. The term $\\frac{C_1}{\\nu_c} x$ is secular and breaks periodicity unless $C_1=0$. Therefore, the periodicity condition $U(x) = U(x+2\\pi/k)$ implies $C_1=0$. The solution simplifies to:\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_2}{\\nu_c}\n$$\nNext, we apply the constraint of zero mean flow, $\\langle U \\rangle_x = 0$, where the average is over one period in $x$:\n$$\n\\langle U \\rangle_x = \\frac{k}{2\\pi} \\int_{0}^{2\\pi/k} \\left( -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_2}{\\nu_c} \\right) dx = 0\n$$\nThe integral of $\\cos(k x)$ over a full period is zero. The integral of the constant term is $\\frac{C_2}{\\nu_c} \\times \\frac{2\\pi}{k}$. Thus, the average is:\n$$\n\\frac{k}{2\\pi} \\left( 0 + \\frac{C_2}{\\nu_c} \\frac{2\\pi}{k} \\right) = \\frac{C_2}{\\nu_c}\n$$\nThe constraint $\\langle U \\rangle_x = 0$ forces $\\frac{C_2}{\\nu_c} = 0$, which means $C_2=0$.\nThe unique steady-state solution for the zonal flow profile is therefore:\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x)\n$$\nThe problem asks for the zonal flow amplitude, defined as $U_{\\mathrm{amp}} \\equiv \\max_{x} |U(x)|$.\n$$\nU_{\\mathrm{amp}} = \\max_{x} \\left| -\\frac{R_{0}}{k \\nu_c} \\cos(k x) \\right|\n$$\nGiven that $R_{0} > 0$, $k > 0$, and the kinematic viscosity $\\nu_c$ is a positive physical constant, we have:\n$$\nU_{\\mathrm{amp}} = \\frac{R_{0}}{k \\nu_c} \\max_{x} | \\cos(k x) |\n$$\nThe maximum value of $|\\cos(k x)|$ is $1$. Thus, the steady-state zonal flow amplitude is:\n$$\nU_{\\mathrm{amp}} = \\frac{R_{0}}{k \\nu_c}\n$$\nThis expression depends only on the given parameters $R_{0}$, $\\nu_c$, and $k$.",
            "answer": "$$\n\\boxed{\\frac{R_{0}}{k \\nu_{c}}}\n$$"
        },
        {
            "introduction": "After establishing the physical mechanism for their generation, a key task in analyzing simulation or experimental data is to quantify the strength of zonal flows. This is most naturally done in the spectral domain, where the spatially organized nature of zonal flows gives them a distinct signature as structures with zero poloidal wavenumber ($k_y=0$). This practice will guide you through the definition and calculation of the zonal flow energy fraction, $\\mathcal{R}$, from a model two-dimensional energy spectrum . Working through this calculation will build your intuition for what it means for a turbulent state to be \"zonal flow dominated\" and equip you with a standard diagnostic tool in turbulence research.",
            "id": "4209523",
            "problem": "Consider electrostatic turbulence in a magnetized plasma whose dominant flow is the electric field cross magnetic field (E×B) drift. In a statistically homogeneous state on a two-dimensional (2D) periodic domain, let the kinetic energy per unit mass of the fluctuating E×B velocity field be represented by a nonnegative spectral density $E(k_{x},k_{y})$, where $k_{x}$ and $k_{y}$ are the radial and poloidal wavenumbers, respectively. Zonal flows are defined as the axisymmetric ($m=0$) poloidal component of the flow, corresponding spectrally to the $k_{y}=0$ modes. The zonal-flow energy spectrum is, by definition, the slice $E_{\\mathrm{ZF}}(k_{x})=E(k_{x},0)$, and the total zonal-flow energy is obtained by integrating $E_{\\mathrm{ZF}}$ over $k_{x}$, while the total turbulent energy is obtained by integrating $E$ over both $k_{x}$ and $k_{y}$. Based on these definitions, a natural diagnostic for zonal-flow dominance is the ratio\n$$\n\\mathcal{R}\\equiv \\frac{\\int_{-\\infty}^{\\infty}E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x}}{\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}}.\n$$\nStart from the definition of spectral energy and Parseval’s theorem for the E×B flow to justify the use of $k_{y}=0$ as the zonal-flow sector and the above ratio as a fraction of total energy in zonal flows. Then, assume a composite and anisotropic but separable model spectrum with a narrow ridge around $k_{y}=0$ to represent coherent zonal flows superposed on a broader drift-wave background,\n$$\nE(k_{x},k_{y})=Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big),\n$$\nwhere $Z_{0}$, $A_{b}$, $k_{z}$, $k_{bx}$, $k_{by}$, and $\\varepsilon$ are strictly positive constants, with $\\varepsilon$ small to encode the spectral concentration of zonal flows near $k_{y}=0$. Using only fundamental spectral definitions and standard Gaussian integral facts, compute the exact closed-form expression of the ratio $\\mathcal{R}$ in terms of the parameters. Then, formulate a quantitative zonal-flow dominance criterion in terms of a user-specified threshold $\\eta\\in(0,1)$ applied to $\\mathcal{R}$. Your final reported result must be the exact analytic expression for $\\mathcal{R}$; no numerical evaluation is required and no units are to be included in the final result.",
            "solution": "First, we justify the definitions provided in the problem statement. The context is a two-dimensional (2D) model of electrostatic turbulence in a magnetized plasma. The dominant flow is the $\\mathbf{E}\\times\\mathbf{B}$ drift, given by $\\mathbf{v}_{E} = (\\mathbf{E} \\times \\mathbf{B}) / B^2$. In a slab geometry with a strong, uniform magnetic field $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$, the electric field $\\mathbf{E}$ is derived from an electrostatic potential $\\phi(x, y, t)$, such that $\\mathbf{E} = -\\nabla\\phi$. The velocity field components are $v_x = -(1/B_0)\\partial_y\\phi$ and $v_y = (1/B_0)\\partial_x\\phi$. The kinetic energy per unit mass is $\\frac{1}{2}|\\mathbf{v}_E|^2 = \\frac{1}{2B_0^2}|\\nabla\\phi|^2$.\n\nThe total turbulent kinetic energy in a spatial domain is found by integrating this quantity over the area. By Parseval's theorem, this real-space integral can be transformed into an integral or sum over Fourier space. For a periodic domain, the potential can be expressed as a Fourier series $\\phi(\\mathbf{x}) = \\sum_{\\mathbf{k}} \\hat{\\phi}_{\\mathbf{k}} \\exp(i\\mathbf{k}\\cdot\\mathbf{x})$, where $\\mathbf{k}=(k_x, k_y)$. Parseval's theorem states that $\\int |\\nabla\\phi|^2 d\\mathbf{x} \\propto \\sum_{\\mathbf{k}} |\\nabla\\phi|_{\\mathbf{k}}^2 = \\sum_{\\mathbf{k}} |i\\mathbf{k} \\hat{\\phi}_{\\mathbf{k}}|^2 = \\sum_{\\mathbf{k}} (k_x^2+k_y^2)|\\hat{\\phi}_{\\mathbf{k}}|^2$. In the continuous limit for an infinite domain, the total energy is given by $\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}$, where $E(k_x, k_y)$ is the energy spectral density. $E(k_x, k_y)$ is proportional to $(k_x^2+k_y^2)|\\hat{\\phi}(k_x, k_y)|^2$ and represents the energy contribution from modes with wavenumber $(k_x, k_y)$.\n\nZonal flows are defined as being axisymmetric, which in this slab geometry corresponds to flows that are uniform in the poloidal ($y$) direction. A function $f(x, y)$ that is independent of $y$ has a Fourier transform with respect to $y$ that is non-zero only at $k_y=0$. For the flow fields to be $y$-independent, the potential $\\phi$ must be structured such that its Fourier components $\\hat{\\phi}(k_x, k_y)$ are zero for all $k_y \\neq 0$. These are the $k_y=0$ modes. Physically, if $\\phi=\\phi(x)$, then $v_x = 0$ and $v_y = (1/B_0)d\\phi/dx$, which describes a radially-sheared poloidal flow, the canonical form of a zonal flow. The energy contained in these modes is therefore concentrated on the $k_y=0$ axis of the spectral plane. Consequently, the zonal-flow energy spectrum is correctly defined as the slice $E_{\\mathrm{ZF}}(k_{x})=E(k_{x},0)$. The total energy in zonal flows is the integral of this slice over all radial wavenumbers, $\\mathcal{E}_{\\mathrm{ZF}} = \\int_{-\\infty}^{\\infty}E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x}$. The ratio $\\mathcal{R} \\equiv \\mathcal{E}_{\\mathrm{ZF}}/\\mathcal{E}_{\\text{total}}$ thus represents the fraction of the total turbulent kinetic energy that resides in the zonal flow structures.\n\nNext, we compute the ratio $\\mathcal{R}$ for the given model spectrum:\n$$\nE(k_{x},k_{y})=Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\n$$\nThe numerator of $\\mathcal{R}$ is the total zonal-flow energy, $\\mathcal{E}_{\\mathrm{ZF}}$. We first determine the zonal-flow spectrum, $E_{\\mathrm{ZF}}(k_x)$, by setting $k_y=0$ in the full spectrum:\n$$\nE_{\\mathrm{ZF}}(k_{x}) = E(k_{x},0) = Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\exp(0)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\exp(0)\n$$\n$$\nE_{\\mathrm{ZF}}(k_{x}) = Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\n$$\nNow we integrate over $k_x$ from $-\\infty$ to $\\infty$. We use the standard Gaussian integral formula $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$.\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = \\int_{-\\infty}^{\\infty} E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x} = \\int_{-\\infty}^{\\infty} \\left[ Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big) \\right] \\mathrm{d}k_{x}\n$$\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = Z_{0}\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{1}{k_{z}^{2}}k_{x}^{2}\\Big)\\,\\mathrm{d}k_{x} + A_{b}\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{1}{k_{bx}^{2}}k_{x}^{2}\\Big)\\,\\mathrm{d}k_{x}\n$$\nApplying the formula, we get:\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = Z_{0}\\sqrt{\\pi k_{z}^{2}} + A_{b}\\sqrt{\\pi k_{bx}^{2}} = Z_{0}k_{z}\\sqrt{\\pi} + A_{b}k_{bx}\\sqrt{\\pi} = \\sqrt{\\pi}(Z_{0}k_{z} + A_{b}k_{bx})\n$$\nThe denominator of $\\mathcal{R}$ is the total turbulent energy, $\\mathcal{E}_{\\text{total}}$, obtained by integrating $E(k_x, k_y)$ over both $k_x$ and $k_y$.\n$$\n\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\n$$\nSince the given spectrum is a sum of two separable terms, the integral is:\n$$\n\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y} + \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\n$$\nEach double integral can be split into a product of two single integrals:\n$$\n\\mathcal{E}_{\\text{total}} = Z_{0}\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\mathrm{d}k_{x}\\right)\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)\\mathrm{d}k_{y}\\right) + A_{b}\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\mathrm{d}k_{x}\\right)\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\\mathrm{d}k_{y}\\right)\n$$\nApplying the Gaussian integral formula to each part:\n$$\n\\mathcal{E}_{\\text{total}} = Z_{0}(k_{z}\\sqrt{\\pi})(\\varepsilon\\sqrt{\\pi}) + A_{b}(k_{bx}\\sqrt{\\pi})(k_{by}\\sqrt{\\pi})\n$$\n$$\n\\mathcal{E}_{\\text{total}} = \\pi Z_{0}k_{z}\\varepsilon + \\pi A_{b}k_{bx}k_{by} = \\pi(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})\n$$\nFinally, we compute the ratio $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{\\mathcal{E}_{\\mathrm{ZF}}}{\\mathcal{E}_{\\text{total}}} = \\frac{\\sqrt{\\pi}(Z_{0}k_{z} + A_{b}k_{bx})}{\\pi(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}\n$$\nSimplifying the expression by cancelling $\\sqrt{\\pi}$:\n$$\n\\mathcal{R} = \\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}\n$$\nThis is the final exact analytic expression for the ratio $\\mathcal{R}$.\n\nFinally, a quantitative zonal-flow dominance criterion can be formulated using a user-specified threshold $\\eta \\in (0,1)$. Since $\\mathcal{R}$ represents the fraction of energy in zonal flows, a state of zonal-flow dominance can be declared if this fraction exceeds the threshold $\\eta$. The criterion is thus expressed as the inequality:\n$$\n\\mathcal{R} > \\eta\n$$\nor, substituting the derived expression for $\\mathcal{R}$:\n$$\n\\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})} > \\eta\n$$\nThis inequality provides a condition on the spectral parameters ($Z_{0}, A_{b}, k_{z}, k_{bx}, k_{by}, \\varepsilon$) for the system to be considered in a zonal-flow dominated state.",
            "answer": "$$\n\\boxed{\\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}}\n$$"
        },
        {
            "introduction": "The study of plasma turbulence relies heavily on numerical simulations, where theoretical models are put to the test. Pseudo-spectral methods are particularly powerful for this task, but their implementation involves numerical subtleties that can interact with the physics being simulated. In this hands-on coding problem, you will explore how a standard numerical procedure—spectral de-aliasing via the $2/3$ rule—affects the triad interactions responsible for generating zonal flows . This practice offers a critical lesson for any computational physicist on the importance of ensuring that numerical algorithms faithfully capture the intended physical mechanisms and do not introduce unintended artifacts.",
            "id": "4209554",
            "problem": "Consider a two-dimensional periodic domain discretized on a uniform grid with $N_x$ points in the $x$ direction and $N_y$ points in the $y$ direction. Let $k_x$ and $k_y$ denote the discrete wavenumber indices along $x$ and $y$, respectively, taking integer values in the principal range $-N_x/2 \\le k_x \\le N_x/2-1$ and $-N_y/2 \\le k_y \\le N_y/2-1$. A zonal flow mode is defined as any spectral component with $k_y = 0$. In pseudo-spectral methods, quadratic nonlinearities correspond to triad interactions that enforce $\\mathbf{k}_3 = \\mathbf{k}_1 + \\mathbf{k}_2$ in the continuum, where each $k_i$ is a two-dimensional integer vector. On a discrete grid, the convolution is computed via multiplication in physical space and transformation back to spectral space. Due to discrete sampling, the true sum $k_{\\mathrm{true}} = k_1 + k_2$ aliases to an index $k_{\\mathrm{alias}} = k_{\\mathrm{true}} - s_x N_x \\,\\hat{\\mathbf{x}} - s_y N_y \\,\\hat{\\mathbf{y}}$, where $s_x$ and $s_y$ are integers chosen so that each component of $k_{\\mathrm{alias}}$ lies within the principal range. Aliasing can produce spurious energy in low wavenumbers, including in the $k_y = 0$ band.\n\nA common spectral de-aliasing strategy for quadratic nonlinearities is the $2/3$ rule, which truncates the spectrum so that only wavenumbers with $|k_x| \\le \\lfloor N_x/3 \\rfloor$ and $|k_y| \\le \\lfloor N_y/3 \\rfloor$ are retained before computing products in physical space. Any alias generated by summing two retained wavevectors then maps outside the retained set. In turbulence simulations of magnetized plasmas, triads that generate $k_y = 0$ modes are responsible for zonal flow generation. Overly aggressive or incorrect de-aliasing could suppress legitimate $k_y = 0$ generation, while lack of de-aliasing could contaminate $k_y = 0$ with spurious alias energy.\n\nStarting from the convolution theorem and the definition of aliasing on a discrete periodic grid, derive principled criteria under which the $2/3$ rule preserves legitimate triad interactions that produce $k_y = 0$ and eliminates spurious alias contributions to $k_y = 0$. Then implement a program that constructs two plane-wave fields with prescribed wavevectors, multiplies them in physical space, transforms to spectral space, and measures the fraction of total spectral energy that lies in the zonal band $k_y = 0$. Define the zonal energy fraction as\n$$\n\\mathcal{Z} = \n\\begin{cases}\n\\frac{\\sum_{k_x} \\lvert \\hat{f}(k_x, 0)\\rvert^2}{\\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2}, & \\text{if } \\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2 > 0, \\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwhere $\\hat{f}(k_x, k_y)$ is the discrete Fourier transform of the product field. When de-aliasing is enabled, enforce the $2/3$ truncation by setting any input plane wave to zero if $|k_x| > \\lfloor N_x/3 \\rfloor$ or $|k_y| > \\lfloor N_y/3 \\rfloor$ prior to multiplication.\n\nYour program must compute $\\mathcal{Z}$ for the following test suite. For each case, the pair $(k_1, k_2)$ denotes the input wavevectors, and the de-alias flag indicates whether the $2/3$ rule is applied to inputs:\n\n- Case $1$: $N_x = 64$, $N_y = 64$, $k_1 = (10, 7)$, $k_2 = (-10, -7)$, de-alias flag $=$ $\\mathrm{False}$.\n- Case $2$: $N_x = 64$, $N_y = 64$, $k_1 = (10, 7)$, $k_2 = (-10, -7)$, de-alias flag $=$ $\\mathrm{True}$.\n- Case $3$: $N_x = 64$, $N_y = 64$, $k_1 = (22, 20)$, $k_2 = (22, -20)$, de-alias flag $=$ $\\mathrm{False}$.\n- Case $4$: $N_x = 64$, $N_y = 64$, $k_1 = (22, 20)$, $k_2 = (22, -20)$, de-alias flag $=$ $\\mathrm{True}$.\n- Case $5$: $N_x = 48$, $N_y = 96$, $k_1 = (16, 30)$, $k_2 = (-16, -30)$, de-alias flag $=$ $\\mathrm{True}$.\n- Case $6$: $N_x = 48$, $N_y = 96$, $k_1 = (20, 34)$, $k_2 = (-20, -34)$, de-alias flag $=$ $\\mathrm{True}$.\n\nAll quantities in this problem are dimensionless; there are no physical units. Your program should produce a single line of output containing the six zonal energy fractions $\\mathcal{Z}$ for the above cases as a comma-separated list enclosed in square brackets, in the order listed (for example, $[\\mathcal{Z}_1,\\mathcal{Z}_2,\\mathcal{Z}_3,\\mathcal{Z}_4,\\mathcal{Z}_5,\\mathcal{Z}_6]$).",
            "solution": "### Theoretical Derivation of Criteria\n\nLet us consider two scalar fields, $f_1(\\mathbf{x})$ and $f_2(\\mathbf{x})$, on a two-dimensional periodic domain $\\mathbf{x} = (x, y)$ discretized on a uniform grid of size $N_x \\times N_y$. Their product is $f(\\mathbf{x}) = f_1(\\mathbf{x}) f_2(\\mathbf{x})$. According to the convolution theorem for the Discrete Fourier Transform (DFT), the spectrum of the product field, $\\hat{f}(\\mathbf{k})$, is the circular convolution of the individual spectra, $\\hat{f}_1(\\mathbf{k})$ and $\\hat{f}_2(\\mathbf{k})$:\n$$\n\\hat{f}(\\mathbf{k}) = \\sum_{\\mathbf{k}'} \\hat{f}_1(\\mathbf{k}') \\hat{f}_2(\\mathbf{k} - \\mathbf{k}')\n$$\nwhere the wavevector indices $\\mathbf{k} = (k_x, k_y)$ are integers in the principal ranges $-N_x/2 \\le k_x \\le N_x/2-1$ and $-N_y/2 \\le k_y \\le N_y/2-1$. The sum and difference of wavevectors are implicitly performed modulo $(N_x, N_y)$.\n\nIn this problem, the input fields are single plane waves, meaning their spectra are Kronecker delta functions. Let $f_1(\\mathbf{x})$ correspond to wavevector $\\mathbf{k}_1$ and $f_2(\\mathbf{x})$ to $\\mathbf{k}_2$. Their spectra are $\\hat{f}_1(\\mathbf{k}) \\propto \\delta(\\mathbf{k} - \\mathbf{k}_1)$ and $\\hat{f}_2(\\mathbf{k}) \\propto \\delta(\\mathbf{k} - \\mathbf{k}_2)$. The product in physical space, $f_1(\\mathbf{x}) f_2(\\mathbf{x})$, is a new plane wave with wavevector $\\mathbf{k}_{\\text{true}} = \\mathbf{k}_1 + \\mathbf{k}_2$. On the discrete grid, this resulting wavevector is aliased into the principal range. The aliased wavevector $\\mathbf{k}_{\\text{alias}}$ is given by:\n$$\n\\mathbf{k}_{\\text{alias}} = \\mathbf{k}_{\\text{true}} - s_x N_x \\hat{\\mathbf{x}} - s_y N_y \\hat{\\mathbf{y}}\n$$\nwhere integers $s_x$ and $s_y$ are chosen such that the components of $\\mathbf{k}_{\\text{alias}}$ fall within the principal range. The spectrum of the product field will have a single non-zero component at $\\mathbf{k}_{\\text{alias}}$.\n\nA zonal flow mode is defined by the condition $k_y = 0$.\n- **Legitimate zonal flow generation** occurs when the true sum of wavevectors results in a mode with a zero $y$-component, i.e., $k_{1y} + k_{2y} = 0$.\n- **Spurious (aliased) zonal flow generation** occurs when $k_{1y} + k_{2y} \\neq 0$, but aliasing maps the resulting mode to one with a zero $y$-component. This happens if $k_{1y} + k_{2y} = s_y N_y$ for some non-zero integer $s_y$.\n\nThe $2/3$ de-aliasing rule truncates the spectrum, retaining only modes with $|k_x| \\le K_x = \\lfloor N_x/3 \\rfloor$ and $|k_y| \\le K_y = \\lfloor N_y/3 \\rfloor$.\n\n**Criterion 1: Preservation of Legitimate Zonal Flow Generation**\nA legitimate zonal flow generating interaction, where $k_{1y} + k_{2y} = 0$, is correctly calculated and preserved by the $2/3$ rule if and only if the input wavevectors $\\mathbf{k}_1$ and $\\mathbf{k}_2$ are themselves retained by the rule. This requires:\n$$\n|k_{1x}| \\le \\lfloor N_x/3 \\rfloor \\quad \\text{and} \\quad |k_{1y}| \\le \\lfloor N_y/3 \\rfloor\n$$\n$$\n|k_{2x}| \\le \\lfloor N_x/3 \\rfloor \\quad \\text{and} \\quad |k_{2y}| \\le \\lfloor N_y/3 \\rfloor\n$$\nIf either input wavevector lies outside this retained region, the implementation of the de-aliasing scheme sets the corresponding field to zero, thereby suppressing the interaction entirely.\n\n**Criterion 2: Elimination of Spurious Zonal Flow Generation**\nThe $2/3$ rule guarantees the elimination of all spurious contributions to the $k_y=0$ band that arise from quadratic interactions between any two retained modes. This can be proven as follows:\n1.  Let $\\mathbf{k}_1$ and $\\mathbf{k}_2$ be two wavevectors within the retained region. By definition of the $2/3$ rule, this implies $|k_{1y}| \\le K_y = \\lfloor N_y/3 \\rfloor$ and $|k_{2y}| \\le K_y = \\lfloor N_y/3 \\rfloor$.\n2.  The $y$-component of the true sum of these wavevectors is $k_{\\text{true},y} = k_{1y} + k_{2y}$.\n3.  Using the triangle inequality, we can bound the magnitude of this sum: $|k_{\\text{true},y}| = |k_{1y} + k_{2y}| \\le |k_{1y}| + |k_{2y}| \\le K_y + K_y = 2K_y$.\n4.  Since $K_y = \\lfloor N_y/3 \\rfloor \\le N_y/3$, we have $|k_{\\text{true},y}| \\le 2(N_y/3)$. For any $N_y \\ge 1$, it holds that $2N_y/3  N_y$.\n5.  A spurious zonal contribution would require $k_{\\text{true},y}$ to be a non-zero integer multiple of $N_y$, i.e., $k_{\\text{true},y} = s_y N_y$ for $s_y \\in \\{\\pm 1, \\pm 2, \\dots\\}$.\n6.  However, from step $4$, we have $|k_{\\text{true},y}|  N_y$. This makes it impossible for $k_{\\text{true},y}$ to equal any non-zero integer multiple of $N_y$.\n7.  Therefore, the only way for the aliased $y$-wavenumber, $k_{\\text{alias},y}$, to be $0$ is if the true sum, $k_{\\text{true},y}$, is itself $0$. This is the condition for legitimate, not spurious, zonal flow generation.\nThis proves that the $2/3$ rule is effective at eliminating spurious energy aliasing into the zonal flow band from interactions within the retained part of the spectrum.\n\n### Algorithmic Design and Test Case Analysis\n\nThe program will implement the following steps for each test case:\n1.  Receive grid dimensions ($N_x, N_y$), input wavevectors ($\\mathbf{k}_1, \\mathbf{k}_2$), and the de-aliasing flag.\n2.  If de-aliasing is enabled, check if $\\mathbf{k}_1$ and $\\mathbf{k}_2$ satisfy the $2/3$ rule. If a wavevector is outside the limits ($|k_x| > \\lfloor N_x/3 \\rfloor$ or $|k_y| > \\lfloor N_y/3 \\rfloor$), its corresponding field will be treated as zero.\n3.  Construct the two input fields in physical space. A field for wavevector $\\mathbf{k}=(k_x, k_y)$ is $f(\\mathbf{x}) = \\exp(i(k_x x + k_y y))$ on a grid where $x \\in [0, 2\\pi)$ and $y \\in [0, 2\\pi)$. If an input is truncated by de-aliasing, its field is an array of zeros.\n4.  Multiply the two physical-space fields to obtain the product field, $f(\\mathbf{x})$.\n5.  Compute the 2D DFT of $f(\\mathbf{x})$ to get $\\hat{f}(\\mathbf{k})$, and shift the result to center the zero-frequency component.\n6.  Calculate the total spectral energy, $E_{\\text{total}} = \\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2$.\n7.  Calculate the zonal energy, $E_{\\text{zonal}} = \\sum_{k_x} \\lvert \\hat{f}(k_x, 0)\\rvert^2$. The $k_y=0$ modes correspond to the central row of the shifted 2D spectrum array.\n8.  Compute the zonal energy fraction $\\mathcal{Z} = E_{\\text{zonal}} / E_{\\text{total}}$, handling the case where $E_{\\text{total}} = 0$ by setting $\\mathcal{Z} = 0$.\n\n**Analysis of Test Cases:**\n- **Cases 1  2:** ($N_x=64, N_y=64, \\mathbf{k}_1=(10, 7), \\mathbf{k}_2=(-10, -7)$). This is a legitimate zonal interaction as $\\mathbf{k}_1+\\mathbf{k}_2 = (0,0)$. The $2/3$ limits are $K_x=K_y=\\lfloor 64/3 \\rfloor=21$. Both $\\mathbf{k}_1$ and $\\mathbf{k}_2$ are well within these limits. Therefore, the interaction is preserved with and without de-aliasing. The resulting field is a constant, whose entire spectral energy is at $\\mathbf{k}=(0,0)$. For both cases, $\\mathcal{Z}$ will be 1.0.\n- **Cases 3  4:** ($N_x=64, N_y=64, \\mathbf{k}_1=(22, 20), \\mathbf{k}_2=(22, -20)$). This is a legitimate zonal interaction, with $\\mathbf{k}_{\\text{true}} = (44,0)$. On the discrete grid, this aliases to $\\mathbf{k}_{\\text{alias}} = (44-64, 0) = (-20, 0)$, which is a zonal mode.\n    - Case 3 (de-alias=False): The interaction proceeds, producing spectral energy only at $\\mathbf{k}=(-20, 0)$. Thus, $\\mathcal{Z}$ will be 1.0.\n    - Case 4 (de-alias=True): The $2/3$ limit is $K_x=21$. Both input modes have $|k_x|=22 > 21$, so they are truncated. The product field is zero, total energy is zero, and $\\mathcal{Z}$ will be 0. This demonstrates the suppression of a legitimate interaction involving high-wavenumber modes.\n- **Case 5:** ($N_x=48, N_y=96, \\mathbf{k}_1=(16, 30), \\mathbf{k}_2=(-16, -30)$, de-alias=True). Legitimate interaction with $\\mathbf{k}_1+\\mathbf{k}_2=(0,0)$. The limits are $K_x=\\lfloor 48/3 \\rfloor = 16$ and $K_y=\\lfloor 96/3 \\rfloor = 32$. Both input modes satisfy the conditions ($|16|\\le16$, $|30|\\le32$). The interaction is preserved. We expect $\\mathcal{Z}=1.0$.\n- **Case 6:** ($N_x=48, N_y=96, \\mathbf{k}_1=(20, 34), \\mathbf{k}_2=(-20, -34)$, de-alias=True). Legitimate interaction with $\\mathbf{k}_1+\\mathbf{k}_2=(0,0)$. The limits are $K_x=16$, $K_y=32$. The input modes violate the limits, since $|20|>16$ and $|34|>32$. Both input fields are truncated to zero. The resulting product is zero, so $\\mathcal{Z}=0$.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_zonal_fraction(Nx, Ny, k1, k2, dealias):\n    \"\"\"\n    Computes the zonal energy fraction for the product of two plane waves.\n\n    Args:\n        Nx (int): Number of grid points in the x direction.\n        Ny (int): Number of grid points in the y direction.\n        k1 (tuple): Wavevector (kx, ky) for the first plane wave.\n        k2 (tuple): Wavevector (kx, ky) for the second plane wave.\n        dealias (bool): If True, apply the 2/3 de-aliasing rule to inputs.\n\n    Returns:\n        float: The zonal energy fraction Z.\n    \"\"\"\n    amp1 = 1.0\n    amp2 = 1.0\n\n    if dealias:\n        Kx = Nx // 3\n        Ky = Ny // 3\n        if abs(k1[0]) > Kx or abs(k1[1]) > Ky:\n            amp1 = 0.0\n        if abs(k2[0]) > Kx or abs(k2[1]) > Ky:\n            amp2 = 0.0\n\n    # If either amplitude is zero, the product is zero, so Z=0.\n    if amp1 == 0.0 or amp2 == 0.0:\n        return 0.0\n\n    # Create coordinate grid. Using endpoint=False for periodic domain.\n    x = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    y = np.linspace(0, 2 * np.pi, Ny, endpoint=False)\n    xx, yy = np.meshgrid(x, y)\n    \n    # Construct the two plane wave fields in physical space.\n    field1 = np.exp(1j * (k1[0] * xx + k1[1] * yy))\n    field2 = np.exp(1j * (k2[0] * xx + k2[1] * yy))\n    \n    # Compute the product in physical space.\n    product_field = field1 * field2\n\n    # Transform to spectral space via 2D FFT.\n    # The result is shifted so that the k=(0,0) component is at the center.\n    spectrum = np.fft.fftshift(np.fft.fft2(product_field))\n\n    # Calculate total spectral energy (proportional to sum of squares of amplitudes).\n    # Using np.abs()**2 gives the squared magnitude |z|^2.\n    total_energy = np.sum(np.abs(spectrum)**2)\n\n    if total_energy == 0.0:\n        return 0.0\n\n    # The zonal modes (ky=0) correspond to the central row in the shifted spectrum.\n    # For an even Ny, the ky=0 wave number is at index Ny // 2.\n    zonal_row_index = Ny // 2\n    zonal_energy = np.sum(np.abs(spectrum[zonal_row_index, :])**2)\n\n    # Compute and return the zonal energy fraction.\n    zonal_fraction = zonal_energy / total_energy\n    \n    # Using np.round to avoid potential minor floating point inaccuracies like 0.999...\n    return np.round(zonal_fraction, decimals=9)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, Ny, k1, k2, de-alias_flag)\n        (64, 64, (10, 7), (-10, -7), False),\n        (64, 64, (10, 7), (-10, -7), True),\n        (64, 64, (22, 20), (22, -20), False),\n        (64, 64, (22, 20), (22, -20), True),\n        (48, 96, (16, 30), (-16, -30), True),\n        (48, 96, (20, 34), (-20, -34), True),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny, k1, k2, dealias = case\n        z_fraction = calculate_zonal_fraction(Nx, Ny, k1, k2, dealias)\n        results.append(z_fraction)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```",
            "answer": "[1.0,1.0,1.0,0.0,1.0,0.0]"
        }
    ]
}