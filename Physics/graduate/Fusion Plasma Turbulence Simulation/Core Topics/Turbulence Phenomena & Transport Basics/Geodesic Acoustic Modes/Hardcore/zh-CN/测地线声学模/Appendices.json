{
    "hands_on_practices": [
        {
            "introduction": "测地声模（GAMs）的物理起源深植于托卡马克环形几何的曲率特性。本练习将引导你从第一性原理出发，推导测地曲率项，正是这一项在磁场线上的变化驱动了电荷分离，并最终产生了恢复力，形成了测地声模。通过这个基本推导，你将对GAM的驱动机制建立起坚实的几何直觉。",
            "id": "4190155",
            "problem": "考虑一个具有圆形同心磁通量面的轴对称托卡马克。设磁面坐标为 $(r,\\theta,\\phi)$，其中 $r$ 是小半径，$\\theta$ 是极向角（从外侧中平面量起），$\\phi$ 是环向角。在每个磁通量面上，柱坐标 $(R,\\phi,Z)$ 通过 $R(r,\\theta) = R_{0} + r \\cos\\theta$ 和 $Z(r,\\theta) = r \\sin\\theta$ 与 $(r,\\theta)$ 相关联，其中 $R_{0}$ 是磁轴的大半径。磁通量面上的线元为\n$$\nds^{2} = dr^{2} + r^{2} d\\theta^{2} + R^{2}(r,\\theta) d\\phi^{2}.\n$$\n假设磁场是轴对称的，并且以环向为主，带有一个小的极向分量，因此沿磁场的单位矢量可以写为\n$$\n\\hat{b} = \\frac{B_{\\phi}}{B}\\,\\hat{e}_{\\phi} + \\frac{B_{\\theta}}{B}\\,\\hat{e}_{\\theta},\n$$\n其中 $B = |\\mathbf{B}|$，$B_{\\phi} \\gg B_{\\theta}$，$\\hat{e}_{\\phi}$、$\\hat{e}_{\\theta}$ 分别是沿环向和极向的单位矢量。磁力线的曲率由几何恒等式定义\n$$\n\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}.\n$$\n在与测地声模 (GAMs) 相关的极向动量平衡中，测地曲率是 $\\boldsymbol{\\kappa}$ 在磁面内的分量投影到极向方向上的部分，即\n$$\n\\kappa_{g}(\\theta) = \\boldsymbol{\\kappa}\\cdot\\hat{e}_{\\theta}.\n$$\n仅从给定的度规和这些几何定义出发，并在大环径比极限 $B_{\\phi}/B \\approx 1$ 下，推导测地曲率 $\\kappa_{g}(\\theta)$ 作为 $r$、$\\theta$ 和 $R_{0}$ 函数的解析表达式。请以 $\\kappa_{g}(\\theta)$ 的单个闭式表达式形式给出最终答案。不要进行任何数值计算。最终表达式中不需要单位。",
            "solution": "该问题要求推导在具有圆形同心磁通量面的轴对称托卡马克中，测地曲率 $\\kappa_g(\\theta)$ 的表达式。测地曲率定义为磁力线曲率矢量 $\\boldsymbol{\\kappa}$ 的极向分量。推导将从曲率矢量 $\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}$ 的基本定义开始，利用所给的环坐标系和大环径比近似。\n\n首先，我们确定指定坐标系 $(r, \\theta, \\phi)$ 的性质。线元为 $ds^{2} = dr^{2} + r^{2} d\\theta^{2} + R^{2}(r,\\theta) d\\phi^{2}$，其中 $R(r,\\theta) = R_{0} + r \\cos\\theta$。这是一个正交坐标系。标度因子为 $h_r = 1$、$h_\\theta = r$ 和 $h_\\phi = R(r,\\theta)$。标准正交基矢表示为 $\\hat{e}_r$、$\\hat{e}_\\theta$ 和 $\\hat{e}_\\phi$。\n\n在此正交坐标系中，梯度算符 $\\nabla$ 由下式给出：\n$$\n\\nabla = \\frac{\\hat{e}_r}{h_r}\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{h_\\theta}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{h_\\phi}\\frac{\\partial}{\\partial \\phi} = \\hat{e}_r\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\n$$\n\n沿磁场的单位矢量 $\\hat{b}$ 为 $\\hat{b} = \\frac{B_{\\phi}}{B}\\,\\hat{e}_{\\phi} + \\frac{B_{\\theta}}{B}\\,\\hat{e}_{\\theta}$。为方便起见，令 $b_\\phi = \\frac{B_\\phi}{B}$ 和 $b_\\theta = \\frac{B_\\theta}{B}$，则 $\\hat{b} = b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta$。注意，根据单位矢量的定义，我们有恒等式 $b_\\phi^2 + b_\\theta^2 = 1$。算符 $(\\hat{b}\\cdot\\nabla)$ 是沿磁力线的方向导数：\n$$\n\\hat{b}\\cdot\\nabla = (b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta) \\cdot \\left(\\hat{e}_r\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\\right) = \\frac{b_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{b_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\n$$\n这里，我们利用了基矢量的正交性，即 $\\hat{e}_i \\cdot \\hat{e}_j = \\delta_{ij}$。\n\n为了计算曲率 $\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}$，我们必须计算方向导数作用于矢量 $\\hat{b}$ 的结果。这需要基矢量的偏导数。对于所定义的环坐标系，这些导数为：\n$$\n\\begin{array}{lll}\n\\frac{\\partial \\hat{e}_r}{\\partial \\theta} = \\hat{e}_\\theta, & \\frac{\\partial \\hat{e}_\\theta}{\\partial \\theta} = -\\hat{e}_r, & \\frac{\\partial \\hat{e}_\\phi}{\\partial \\theta} = 0 \\\\\n\\frac{\\partial \\hat{e}_r}{\\partial \\phi} = \\hat{e}_\\phi \\cos\\theta, & \\frac{\\partial \\hat{e}_\\theta}{\\partial \\phi} = -\\hat{e}_\\phi \\sin\\theta, & \\frac{\\partial \\hat{e}_\\phi}{\\partial \\phi} = -\\hat{e}_r \\cos\\theta + \\hat{e}_\\theta \\sin\\theta\n\\end{array}\n$$\n由于系统是轴对称的，磁场的标量分量 $B_\\phi$ 和 $B_\\theta$ 以及它们的比值 $b_\\phi$ 和 $b_\\theta$ 都与环向角 $\\phi$ 无关。因此，$\\frac{\\partial b_\\phi}{\\partial \\phi} = 0$ 和 $\\frac{\\partial b_\\theta}{\\partial \\phi} = 0$。\n\n现在我们计算 $\\boldsymbol{\\kappa}$：\n$$\n\\boldsymbol{\\kappa} = \\left(\\frac{b_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{b_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\\right) (b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta)\n$$\n展开微分项：\n$$\n\\boldsymbol{\\kappa} = \\frac{b_\\theta}{r} \\left( \\frac{\\partial b_\\phi}{\\partial \\theta} \\hat{e}_\\phi + b_\\phi \\frac{\\partial \\hat{e}_\\phi}{\\partial \\theta} + \\frac{\\partial b_\\theta}{\\partial \\theta} \\hat{e}_\\theta + b_\\theta \\frac{\\partial \\hat{e}_\\theta}{\\partial \\theta} \\right) + \\frac{b_\\phi}{R} \\left( \\frac{\\partial b_\\phi}{\\partial \\phi} \\hat{e}_\\phi + b_\\phi \\frac{\\partial \\hat{e}_\\phi}{\\partial \\phi} + \\frac{\\partial b_\\theta}{\\partial \\phi} \\hat{e}_\\theta + b_\\theta \\frac{\\partial \\hat{e}_\\theta}{\\partial \\phi} \\right)\n$$\n代入基矢量的导数和轴对称条件：\n$$\n\\boldsymbol{\\kappa} = \\frac{b_\\theta}{r} \\left( \\frac{\\partial b_\\phi}{\\partial \\theta} \\hat{e}_\\phi + b_\\phi (0) + \\frac{\\partial b_\\theta}{\\partial \\theta} \\hat{e}_\\theta + b_\\theta (-\\hat{e}_r) \\right) + \\frac{b_\\phi}{R} \\left( (0) \\hat{e}_\\phi + b_\\phi (-\\hat{e}_r \\cos\\theta + \\hat{e}_\\theta \\sin\\theta) + (0) \\hat{e}_\\theta + b_\\theta (-\\hat{e}_\\phi \\sin\\theta) \\right)\n$$\n合并每个基矢量的项：\n$$\n\\boldsymbol{\\kappa} = \\left(-\\frac{b_\\theta^2}{r} - \\frac{b_\\phi^2 \\cos\\theta}{R}\\right) \\hat{e}_r + \\left(\\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta} + \\frac{b_\\phi^2 \\sin\\theta}{R}\\right) \\hat{e}_\\theta + \\left(\\frac{b_\\theta}{r}\\frac{\\partial b_\\phi}{\\partial \\theta} - \\frac{b_\\phi b_\\theta \\sin\\theta}{R}\\right) \\hat{e}_\\phi\n$$\n测地曲率是 $\\boldsymbol{\\kappa}$ 在极向方向的分量，$\\kappa_g(\\theta) = \\boldsymbol{\\kappa} \\cdot \\hat{e}_\\theta$。将 $\\boldsymbol{\\kappa}$ 的表达式投影到 $\\hat{e}_\\theta$ 上，得到 $\\kappa_g(\\theta)$ 的精确表达式：\n$$\n\\kappa_g(\\theta) = \\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta} + \\frac{b_\\phi^2 \\sin\\theta}{R}\n$$\n问题指定我们应在大环径比极限 $B_\\phi/B \\approx 1$ 下进行计算。这对应于 $b_\\phi \\to 1$ 的极限。根据恒等式 $b_\\phi^2 + b_\\theta^2 = 1$，当 $b_\\phi \\to 1$ 时，必然有 $b_\\theta \\to 0$。第一项 $\\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta}$ 包含小量 $b_\\theta$ 及其导数的乘积，因此在此极限下趋于零。第二项 $\\frac{b_\\phi^2 \\sin\\theta}{R}$ 在 $b_\\phi \\to 1$ 时趋近于 $\\frac{\\sin\\theta}{R}$。\n\n因此，在指定极限下，测地曲率为：\n$$\n\\kappa_g(\\theta) \\approx \\frac{\\sin\\theta}{R}\n$$\n最后，代入大半径坐标的给定表达式 $R = R_0 + r \\cos\\theta$：\n$$\n\\kappa_g(\\theta) = \\frac{\\sin\\theta}{R_0 + r \\cos\\theta}\n$$\n这就是在指定条件下推导出的、作为 $r$、$\\theta$ 和 $R_0$ 函数的测地曲率的解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\sin\\theta}{R_{0} + r \\cos\\theta}}\n$$"
        },
        {
            "introduction": "在理解了测地曲率的基本概念后，下一个关键步骤是探究磁面形状如何影响GAM的特性。本练习建立在一个简化的流体模型之上，研究了等离子体形状参数（特别是三角形变）如何改变GAM的频率。完成此计算将揭示磁约束位形与等离子体集体模态之间的深刻联系，这是聚变研究中的一个核心课题。",
            "id": "4190085",
            "problem": "考虑一个大环径比的托卡马克，其大半径为 $R_{0}$，小半径为 $r$，具有小三角形变 $\\delta$ 和可忽略的拉长率。假设一个静电测地声模 (GAM)，定义为纬向流和势的轴对称 ($m=0$, $n=0$) 振荡，通过测地曲率与一个极向变化的 $m=1$ 压力边带耦合。使用简化的类Miller位形对平衡进行建模，其中测地曲率在 $\\delta$ 的一阶近似下为\n$$\n\\kappa_{g}(\\theta) \\equiv \\frac{1}{R_{0}}\\left[\\cos\\theta + \\delta \\cos(2\\theta)\\right],\n$$\n其中 $\\theta$ 是几何极向角。\n\n采用漂移简化流体描述，其中离子为等温的（温度为 $T_{i}$），电子为绝热的（对于非纬向分量为玻尔兹曼响应）。极向 $\\boldsymbol{E}\\times\\boldsymbol{B}$ 流取为 $\\boldsymbol{v}_{E} = \\hat{\\theta}\\,U_{\\theta}(t)$，其中 $U_{\\theta}(t) = (c/B_{0})\\,\\partial_{r}\\phi_{0}(t)$，且在大环径比序下，$B_{0}$ 在领头阶上为常数。使用离子连续性方程和测地曲率引起的可压缩性，将 $m=1$ 压力边带 $p_{1}(\\theta, t)$ 与 $U_{\\theta}(t)$ 联系起来：\n$$\n\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0,\\quad \\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\,\\kappa_{g}(\\theta)\\,U_{\\theta}(t),\\quad p_{1}(\\theta,t) = T_{i}\\,n_{1}(\\theta,t),\n$$\n其中 $n_{0}$ 是平衡密度。使用将边带耦合回纬向流的曲率力密度来闭合该系统，\n$$\nf_{r}(\\theta,t) = -\\,p_{1}(\\theta,t)\\,\\kappa_{g}(\\theta),\n$$\n并取极向平均以获得纬向流的演化：\n$$\nm_{i}\\,n_{0}\\,\\partial_{t}U_{\\theta}(t) = -\\,\\langle f_{r}(\\theta,t)\\rangle_{\\theta},\n$$\n其中 $m_{i}$ 是离子质量，$\\langle\\cdot\\rangle_{\\theta}$ 表示对 $\\theta$ 的 $2\\pi$ 极向平均。\n\n仅使用这些基本方程，并保留 $\\delta$ 的最低非平凡阶项，推导：\n\n1. 由三角形变 $\\delta$ 引起的压力边带 $p_{1}(\\theta,t)$ 极向变化的领头阶修正。\n\n2. 相对于无形变圆形极限 $\\omega_{G0}$（由 $\\delta=0$ 的相同模型定义），由三角形变引起的 GAM 频率 $\\omega_{G}(\\delta)$ 的第一个非零频移。\n\n将最终的 GAM 频率表示为以 $\\omega_{G0}$ 和 $\\delta$ 为变量的闭合形式解析表达式。同时，将 $p_{1}(\\theta,t)$ 的极向变化表示为闭合形式，即用一个含时振幅 $P_{0}(t)$ 乘以一个关于 $\\theta$ 和 $\\delta$ 的显式函数。你的最终答案必须是单个解析表达式或由解析表达式组成的单行矩阵。如果你提供两个表达式，请使用 $\\mathrm{pmatrix}$ 环境将它们合并为单行矩阵。不需要进行数值计算。",
            "solution": "### 第 1 步：提取已知条件\n- **几何与位形**：大环径比托卡马克，大半径 $R_{0}$，小半径 $r$，小三角形变 $\\delta$，可忽略的拉长率。\n- **所关心的模式**：静电测地声模 (GAM)，轴对称 ($m=0$, $n=0$)。\n- **测地曲率模型**：$\\kappa_{g}(\\theta) \\equiv \\frac{1}{R_{0}}\\left[\\cos\\theta + \\delta \\cos(2\\theta)\\right]$，其中 $\\theta$ 是极向角。\n- **等离子体模型**：漂移简化流体描述，等温离子（温度 $T_{i}$，质量 $m_{i}$），绝热电子（对非纬向分量的玻尔兹曼响应）。\n- **流的定义**：极向 $\\boldsymbol{E}\\times\\boldsymbol{B}$ 流 $\\boldsymbol{v}_{E} = \\hat{\\theta}\\,U_{\\theta}(t)$，速度为 $U_{\\theta}(t) = (c/B_{0})\\,\\partial_{r}\\phi_{0}(t)$。$B_{0}$ 是领头阶常数磁场。\n- **控制方程**：\n    1. 离子连续性：$\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0$，其中 $n_0$ 是平衡密度，$n_1$ 是密度微扰。\n    2. 可压缩性关系：$\\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\,\\kappa_{g}(\\theta)\\,U_{\\theta}(t)$。\n    3. 状态方程：$p_{1}(\\theta,t) = T_{i}\\,n_{1}(\\theta,t)$，其中 $p_1$ 是压力边带。\n    4. 曲率力密度：$f_{r}(\\theta,t) = -\\,p_{1}(\\theta,t)\\,\\kappa_{g}(\\theta)$。\n    5. 纬向流演化：$m_{i}\\,n_{0}\\,\\partial_{t}U_{\\theta}(t) = -\\,\\langle f_{r}(\\theta,t)\\rangle_{\\theta}$。\n- **平均算符**：$\\langle\\cdot\\rangle_{\\theta}$ 是对 $\\theta$ 从 $0$ 到 $2\\pi$ 的极向平均。\n- **目标**：\n    1. 推导由 $\\delta$ 引起的压力边带 $p_{1}(\\theta,t)$ 极向变化的领头阶修正。\n    2. 推导相对于圆形情况 $\\omega_{G0}$（其中 $\\delta=0$），由三角形变引起的 GAM 频率 $\\omega_{G}(\\delta)$ 的第一个非零频移。\n- **要求的输出格式**：$p_{1}(\\theta,t)$（用一个通用振幅 $P_0(t)$ 表示）和 $\\omega_{G}(\\delta)$（用 $\\omega_{G0}$ 和 $\\delta$ 表示）的闭合形式解析表达式。\n\n### 求解推导\n推导过程通过依次应用所给方程来构建一个描述 GAM 振荡的闭合系统。\n\n**1. 压力边带 $p_{1}(\\theta,t)$ 的推导**\n\n我们从离子连续性方程和给定的可压缩性关系开始：\n$$\n\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0\n$$\n代入 $\\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\kappa_{g}(\\theta)U_{\\theta}(t)$，我们得到：\n$$\n\\partial_{t}n_{1} = n_{0}\\kappa_{g}(\\theta)U_{\\theta}(t)\n$$\n使用等温离子状态方程 $p_{1}(\\theta,t) = T_{i}n_{1}(\\theta,t)$，我们可以写出压力边带的时间演化：\n$$\n\\partial_{t}p_{1}(\\theta,t) = T_{i}\\partial_{t}n_{1} = n_{0}T_{i}\\kappa_{g}(\\theta)U_{\\theta}(t)\n$$\n对于振荡模式，压力微扰 $p_{1}$ 必须与流速 $U_{\\theta}(t)$ 的时间积分相关。如果我们假设谐波时间依赖性，其中 $U_{\\theta}(t)$ 正比于 $\\sin(\\omega_{G}t)$，那么 $p_{1}(\\theta,t)$ 将正比于 $\\cos(\\omega_{G}t)$。\n对方程进行时间积分，我们发现 $p_{1}$ 的极向结构与测地曲率 $\\kappa_{g}(\\theta)$ 成正比：\n$$\np_{1}(\\theta,t) \\propto \\kappa_{g}(\\theta) \\int^t U_{\\theta}(t') dt'\n$$\n代入给定的 $\\kappa_{g}(\\theta) = \\frac{1}{R_{0}}\\left[\\cos\\theta + \\delta \\cos(2\\theta)\\right]$ 表达式，$p_{1}$ 的极向依赖性由 $(\\cos\\theta + \\delta \\cos(2\\theta))$ 给出。我们可以通过定义一个含时振幅 $P_{0}(t)$ 来吸收所有其他因子，从而以所要求的格式表示此结果：\n$$\np_{1}(\\theta,t) = P_{0}(t) \\left( \\cos\\theta + \\delta\\cos(2\\theta) \\right)\n$$\n这个表达式直接解决了第一个目标。在圆形托卡马克（$\\delta=0$）中，领头阶压力变化具有 $\\cos\\theta$ 的依赖性。由三角形变 $\\delta$ 引起的领头阶修正是增加了与 $\\delta\\cos(2\\theta)$ 成比例的项。\n\n**2. GAM 频率 $\\omega_{G}(\\delta)$ 的推导**\n\n接下来，我们使用纬向流演化方程来求解 GAM 频率。纬向流速度 $U_{\\theta}(t)$ 的演化是由极向平均的曲率力驱动的：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = -\\langle f_{r}(\\theta,t)\\rangle_{\\theta}\n$$\n力密度为 $f_{r}(\\theta,t) = -p_{1}(\\theta,t)\\kappa_{g}(\\theta)$，因此方程变为：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = \\langle p_{1}(\\theta,t)\\kappa_{g}(\\theta) \\rangle_{\\theta}\n$$\n我们代入关系式 $\\partial_t p_1 = n_0 T_i \\kappa_g(\\theta) U_\\theta(t)$，它可以写成积分形式 $p_{1}(\\theta,t) = n_{0}T_{i}\\kappa_{g}(\\theta) \\int^{t} U_{\\theta}(t') dt'$（假设振荡从零开始）。将其代入纬向流方程得到：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = \\left\\langle \\left( n_{0}T_{i}\\kappa_{g}(\\theta) \\int^{t} U_{\\theta}(t') dt' \\right) \\kappa_{g}(\\theta) \\right\\rangle_{\\theta}\n$$\n项 $n_{0}$、$T_{i}$ 和时间积分不依赖于极向角 $\\theta$，因此可以移到平均算符之外：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = n_{0}T_{i} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} \\int^{t} U_{\\theta}(t') dt'\n$$\n除以 $m_{i}n_{0}$ 得到：\n$$\n\\partial_{t}U_{\\theta}(t) = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} \\int^{t} U_{\\theta}(t') dt'\n$$\n为了得到一个标准的微分方程，我们对等式两边关于时间 $t$ 求导：\n$$\n\\partial_{t}^{2}U_{\\theta}(t) = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} U_{\\theta}(t)\n$$\n这可以重新排列成简谐振子方程的标准形式 $\\partial_{t}^{2}U_{\\theta}(t) + \\omega_{G}^{2} U_{\\theta}(t) = 0$，其中 GAM 频率的平方被确定为：\n$$\n\\omega_{G}^{2} = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta}\n$$\n现在我们必须计算 $\\kappa_g^2(\\theta)$ 的极向平均值。\n$$\n\\kappa_{g}^{2}(\\theta) = \\frac{1}{R_{0}^{2}} \\left( \\cos\\theta + \\delta \\cos(2\\theta) \\right)^{2} = \\frac{1}{R_{0}^{2}} \\left( \\cos^{2}\\theta + 2\\delta \\cos\\theta \\cos(2\\theta) + \\delta^{2}\\cos^{2}(2\\theta) \\right)\n$$\n极向平均 $\\langle F(\\theta) \\rangle_{\\theta}$ 是 $\\frac{1}{2\\pi}\\int_{0}^{2\\pi} F(\\theta) d\\theta$。我们使用标准积分：对于整数 $k \\neq 0$，$\\langle\\cos^{2}(k\\theta)\\rangle_{\\theta} = \\frac{1}{2}$；对于整数 $A \\neq B$，$\\langle\\cos(A\\theta)\\cos(B\\theta)\\rangle_{\\theta} = 0$。\n$$\n\\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} = \\frac{1}{R_{0}^{2}} \\left( \\langle \\cos^{2}\\theta \\rangle_{\\theta} + 2\\delta \\langle \\cos\\theta \\cos(2\\theta) \\rangle_{\\theta} + \\delta^{2} \\langle \\cos^{2}(2\\theta) \\rangle_{\\theta} \\right)\n$$\n$$\n\\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} = \\frac{1}{R_{0}^{2}} \\left( \\frac{1}{2} + 2\\delta(0) + \\delta^{2}\\frac{1}{2} \\right) = \\frac{1}{2R_{0}^{2}} (1 + \\delta^{2})\n$$\n关于 $\\delta$ 的线性项消失了。因此，由三角形变引起的第一个非零修正是 $\\delta^{2}$ 阶的。\n\n将此结果代回 $\\omega_{G}^{2}$ 的表达式中：\n$$\n\\omega_{G}^{2}(\\delta) = \\frac{T_{i}}{m_{i}} \\frac{1}{2R_{0}^{2}} (1 + \\delta^{2})\n$$\n通过设置 $\\delta=0$ 可得到无形变圆形极限下的 GAM 频率 $\\omega_{G0}$：\n$$\n\\omega_{G0}^{2} = \\omega_{G}^{2}(\\delta=0) = \\frac{T_{i}}{2m_{i}R_{0}^{2}}\n$$\n因此，我们可以用 $\\omega_{G0}$ 来表示包含三角形变的频率 $\\omega_{G}(\\delta)$：\n$$\n\\omega_{G}^{2}(\\delta) = \\omega_{G0}^{2} (1 + \\delta^{2})\n$$\n取平方根得到 GAM 频率的最终表达式：\n$$\n\\omega_{G}(\\delta) = \\omega_{G0} \\sqrt{1 + \\delta^{2}}\n$$\n该表达式表明，对于小 $\\delta$，频率漂移 $\\Delta\\omega_{G} = \\omega_{G}(\\delta) - \\omega_{G0} \\approx \\frac{1}{2}\\omega_{G0}\\delta^{2}$，证明了第一个由三角形变引起的非零频移是 $\\delta$ 的二阶。\n\n要求的两个结果是压力的极向变化和修正后的 GAM 频率。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nP_{0}(t)\\left(\\cos\\theta + \\delta\\cos(2\\theta)\\right), & \\omega_{G0}\\sqrt{1 + \\delta^{2}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论模型最终需要与实验或模拟数据进行检验。这项计算实践旨在弥合理论与数据分析之间的鸿沟，它要求你构建一个包含阻尼、湍流涨落和噪声的真实感合成GAM信号。随后，你将应用先进的信号处理技术来从这个复杂的时间序列中精确提取模的频率和阻尼率，从而掌握分析真实诊断信号的关键技能。",
            "id": "3984919",
            "problem": "您的任务是实现一个完全独立的程序，该程序构造一个表示与湍流耦合的阻尼测地声学模 (GAM) 振荡的人工时间序列，然后在指定的容差范围内数值恢复给定的振荡频率和阻尼率。背景设定为高阶研究生水平的计算聚变科学与工程。\n\n首先从单模振荡的基于物理原理的表示开始。在存在耗散和与湍流雷诺应力一致的小的随机驱动的情况下，与该模相关的一个标量可观测量（记为 $x(t)$）可以被建模为一个带有乘性振幅调制和加性测量噪声的指数阻尼振荡。待合成的人工解为：\n$$\nx(t) = A_0 \\exp(-\\gamma\\, t)\\,\\exp\\big(\\epsilon\\,E(t)\\big)\\,\\cos\\big(\\omega\\, t + \\phi\\big) + \\sigma\\,\\xi(t),\n$$\n其中 $A_0$ 是一个正振幅，$\\gamma$ 是一个单位为 $\\mathrm{s}^{-1}$ 的正阻尼率，$\\omega$ 是一个单位为 $\\mathrm{rad/s}$ 的角频率，$\\phi$ 是一个单位为 $\\mathrm{rad}$ 的恒定相位，$\\epsilon$ 是与湍流的非负耦合强度，$E(t)$ 是一个零均值 Ornstein–Uhlenbeck (OU) 过程，用于模拟由湍流雷诺应力引起的波动包络，而 $\\xi(t)$ 是一个代表测量和未解析动力学的零均值高斯白噪声。OU 过程 $E(t)$ 在 Itô 意义下由下式控制：\n$$\n\\mathrm{d}E = -\\frac{1}{\\tau_c}E\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\tau_c}}\\,\\mathrm{d}W_t,\n$$\n其中相关时间为 $\\tau_c$ (单位为 $\\mathrm{s}$)，维纳增量为 $\\mathrm{d}W_t$。这样的选择确保 $E(t)$ 是一个方差为1的平稳过程。\n\n您的程序必须：\n\n- 对每个测试用例，使用均匀的时间网格（采样频率为 $f_s$ (Hz)，持续时间为 $T$ (s)）和固定的随机种子（以确保可复现性）来构造 $x(t)$。\n- 使用一种基于信号分析原理、与所模拟的物理过程相容且具有科学依据的数值方案，从 $x(t)$ 中估计角频率 $\\omega$ 和阻尼率 $\\gamma$。作为指导，采用基于傅里叶功率谱密度的方法来定位主导的振荡频带，通过希尔伯特变换构造解析信号以提取瞬时相位和包络，并对包络的对数进行回归以估计阻尼率。\n- 将估计的参数与给定值进行比较，并确定频率和阻尼率是否都在每个测试用例提供的指定绝对容差范围内被恢复。\n\n物理单位和要求：\n\n- 频率以 $\\mathrm{rad/s}$ 为单位表示，阻尼率以 $\\mathrm{s}^{-1}$ 为单位表示。\n- 角度必须以弧度处理。\n\n该数值方案必须在存在乘性包络涨落和加性噪声的情况下保持鲁棒性。估计决策必须基于基本原理：由阻尼振子模型描述的守恒和耗散，以及用于振荡分量提取的谱/解析信号方法。\n\n测试套件：\n\n对于每个测试用例，都提供一个参数元组 $(\\omega,\\gamma,A_0,\\epsilon,\\tau_c,\\sigma,f_s,T,\\phi,\\omega_{\\text{tol}},\\gamma_{\\text{tol}},\\text{seed})$。您的程序必须精确地使用这些值，并且当且仅当同时满足以下两个条件时，输出一个布尔值 `True` 表示成功：\n$$\n|\\widehat{\\omega} - \\omega| \\le \\omega_{\\text{tol}} \\quad \\text{and} \\quad |\\widehat{\\gamma} - \\gamma| \\le \\gamma_{\\text{tol}},\n$$\n其中 $\\widehat{\\omega}$ 和 $\\widehat{\\gamma}$ 是估计值。\n\n使用以下四个科学上合理的测试用例，所有量均使用指定单位：\n\n1. 案例1（中等阻尼，中等湍流，高信噪比）：\n   - $\\omega = 2\\pi \\cdot 12{,}000$\n   - $\\gamma = 1200$\n   - $A_0 = 1.25$\n   - $\\epsilon = 0.2$\n   - $\\tau_c = 5\\times 10^{-4}$\n   - $\\sigma = 0.02$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.012$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 300$\n   - $\\gamma_{\\text{tol}} = 200$\n   - $\\text{seed} = 0$\n\n2. 案例2（较强阻尼，较强湍流，中等噪声）：\n   - $\\omega = 2\\pi \\cdot 18{,}000$\n   - $\\gamma = 3000$\n   - $A_0 = 0.8$\n   - $\\epsilon = 0.4$\n   - $\\tau_c = 3\\times 10^{-4}$\n   - $\\sigma = 0.04$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.010$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 400$\n   - $\\gamma_{\\text{tol}} = 500$\n   - $\\text{seed} = 1$\n\n3. 案例3（低阻尼，较短记录，较高噪声）：\n   - $\\omega = 2\\pi \\cdot 9{,}000$\n   - $\\gamma = 600$\n   - $A_0 = 1.0$\n   - $\\epsilon = 0.3$\n   - $\\tau_c = 4\\times 10^{-4}$\n   - $\\sigma = 0.05$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.006$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 500$\n   - $\\gamma_{\\text{tol}} = 250$\n   - $\\text{seed} = 2$\n\n4. 案例4（较高频率，高阻尼，无湍流，中等噪声）：\n   - $\\omega = 2\\pi \\cdot 25{,}000$\n   - $\\gamma = 4500$\n   - $A_0 = 1.1$\n   - $\\epsilon = 0.0$\n   - $\\tau_c = 3\\times 10^{-4}$\n   - $\\sigma = 0.03$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.008$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 400$\n   - $\\gamma_{\\text{tol}} = 600$\n   - $\\text{seed} = 3$\n\n最终输出格式：\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例对应一个布尔值，指示如上定义的成功与否。例如：`[True,False,True,True]`。",
            "solution": "该解决方案的实现方式是，首先根据所提供的随机微分模型合成时间序列，然后应用一种有原则的信号分析程序来估计感兴趣的参数，即角频率 $\\omega$ 和阻尼率 $\\gamma$。\n\n### 信号合成\n\n对于每个测试用例，我们生成一个离散时间序列 $x(t_i)$。\n\n1.  **时间网格**：构造一个从 $t=0$ 到 $t=T$ 的均匀时间向量 $t$，时间步长为 $\\Delta t = 1/f_s$。总点数为 $N = \\lfloor T \\cdot f_s \\rfloor + 1$。\n\n2.  **Ornstein-Uhlenbeck (OU) 过程**：用于乘性噪声的随机过程 $E(t)$ 由以下随机微分方程 (SDE) 控制：\n    $$\n    \\mathrm{d}E = -\\frac{1}{\\tau_c}E\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\tau_c}}\\,\\mathrm{d}W_t\n    $$\n    我们通过使用 Euler-Maruyama 格式对此 SDE 进行积分来生成离散实现 $E_i = E(t_i)$。鉴于在所有测试用例中时间步长 $\\Delta t$ 远小于相关时间 $\\tau_c$，该格式是合适的。更新规则为：\n    $$\n    E_{i+1} = E_i \\left(1 - \\frac{\\Delta t}{\\tau_c}\\right) + \\sqrt{\\frac{2\\Delta t}{\\tau_c}} Z_i\n    $$\n    其中 $Z_i$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的独立随机变量。通过从其平稳分布（即 $\\mathcal{N}(0, 1)$，以满足单位方差的要求）中抽取 $E_0$ 来初始化该过程。\n\n3.  **加性噪声**：加性白噪声分量 $\\xi(t)$ 实现为从 $\\mathcal{N}(0, 1)$ 中抽取的随机数离散序列 $\\xi_i$。\n\n4.  **完整信号**：最终的时间序列 $x(t_i)$ 使用指定模型组装而成：\n    $$\n    x(t_i) = A_0 \\exp(-\\gamma\\, t_i)\\,\\exp\\big(\\epsilon\\,E_i\\big)\\,\\cos\\big(\\omega\\, t_i + \\phi\\big) + \\sigma\\,\\xi_i\n    $$\n    每个案例都使用固定的随机种子以确保可复现性。\n\n### 参数估计\n\n估计 $\\widehat{\\omega}$ 和 $\\widehat{\\gamma}$ 需要将振荡分量与噪声分离并分析其属性。根据问题陈述的指导，我们采用一个多阶段过程。\n\n1.  **带通滤波**：原始信号 $x(t)$ 是期望的阻尼振荡和宽带加性噪声的复合体。为了分离出 GAM 信号，使用带通滤波器是必不可少的。\n    -   滤波器的中心频率通过在原始信号 $x(t)$ 的功率谱密度 (PSD) 中定位峰值来确定。PSD 使用快速傅里叶变换 (FFT) 计算。最大功率对应的频率提供了该模频率的初步估计值 $f_{peak}$。\n    -   设计一个以 $f_{peak}$ 为中心的 5 阶巴特沃斯滤波器。带宽选择为 $6$ kHz，这个宽度足以捕获该模的谱宽（因阻尼和湍流调制而展宽），同时能抑制大部分带外噪声。\n    -   使用前向-后向传递（`sosfiltfilt`）来应用该滤波器，以确保零相位失真。这一点至关重要，因为任何相位失真都会破坏后续对 $\\omega$ 和 $\\gamma$ 的估计。设滤波后的信号为 $x_{filt}(t)$。\n\n2.  **解析信号构造**：对滤波后的信号 $x_{filt}(t)$ 应用希尔伯特变换以构造解析信号 $z(t)$：\n    $$\n    z(t) = x_{filt}(t) + i\\mathcal{H}\\{x_{filt}(t)\\} = A(t)e^{i\\psi(t)}\n    $$\n    这种表示方法有效地将信号分离为其瞬时包络 $A(t) = |z(t)|$ 和瞬时相位 $\\psi(t) = \\arg(z(t))$。\n\n3.  **为实现鲁棒拟合而进行数据截断**：在几个测试用例中，阻尼很强，导致信号包络在时间记录 $T$ 结束之前就衰减到加性噪声基底 $\\sigma$ 以下。对信号的噪声主导尾部进行回归会严重偏离估计值。因此，我们仅对信号包络 $A(t)$ 显著的部分进行拟合。我们定义一个有效数据区域，其中 $A(t) > 3\\sigma$。这种阈值处理确保估计是基于信号中具有高信噪比的部分。\n\n4.  **频率估计 ($\\widehat{\\omega}$)**：对于一个理想的滤波后振荡，瞬时相位随时间线性演化：$\\psi(t) \\approx \\omega t + \\text{const}$。因此，角频率 $\\omega$ 是相位的变化率。通过在有效数据区域内对解卷绕相位 $\\psi(t)$ 与时间 $t$ 进行线性回归，可以获得一个鲁棒的估计值 $\\widehat{\\omega}$。该拟合的斜率即为 $\\widehat{\\omega}$。这种方法通常比依赖于短时、含噪信号的 FFT 峰值位置更准确。\n\n5.  **阻尼率估计 ($\\widehat{\\gamma}$)**：包含湍流涨落的信号包络模型近似为 $A(t) \\approx A_0 \\exp(-\\gamma t) \\exp(\\epsilon E(t))$。取自然对数可以使非弹性阻尼项线性化：\n    $$\n    \\ln A(t) \\approx \\ln A_0 - \\gamma t + \\epsilon E(t)\n    $$\n    这是 $\\ln A(t)$ 和 $t$ 之间的一个线性关系，附加了一个零均值随机项 $\\epsilon E(t)$。对 $\\ln A(t)$ 与 $t$ 进行线性回归（在有效数据区域内）将得到一个斜率，该斜率是 $-\\gamma$ 的鲁棒估计。因此，我们设 $\\widehat{\\gamma} = -(\\text{斜率})$。\n\n最后，对于每个测试用例，将估计值 $\\widehat{\\omega}$ 和 $\\widehat{\\gamma}$ 与真实值 $\\omega$ 和 $\\gamma$ 进行比较，使用提供的绝对容差 $\\omega_{tol}$ 和 $\\gamma_{tol}$ 来确定成功与否 (True/False)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef analyze_signal(params):\n    \"\"\"\n    Synthesizes a GAM time series and estimates its frequency and damping rate.\n    \n    Args:\n        params (tuple): A tuple containing all model and analysis parameters.\n\n    Returns:\n        bool: True if both frequency and damping are recovered within tolerance, False otherwise.\n    \"\"\"\n    omega, gamma, A0, epsilon, tau_c, sigma, fs, T, phi, omega_tol, gamma_tol, seed = params\n\n    # 1. Signal Synthesis\n    rng = np.random.default_rng(seed)\n    \n    # Time base\n    dt = 1.0 / fs\n    num_points = int(T * fs) + 1\n    t = np.linspace(0.0, T, num_points, endpoint=True)\n\n    # Ornstein-Uhlenbeck process E(t) via Euler-Maruyama\n    E = np.zeros(num_points)\n    E[0] = rng.normal()  # Start from stationary distribution N(0,1)\n    # Pre-calculate constants for the loop\n    exp_factor = 1.0 - dt / tau_c\n    noise_factor = np.sqrt(2.0 * dt / tau_c)\n    for i in range(num_points - 1):\n        E[i+1] = exp_factor * E[i] + noise_factor * rng.normal()\n\n    # Additive white noise xi(t)\n    xi = rng.normal(size=num_points)\n\n    # Full manufactured signal x(t)\n    envelope = A0 * np.exp(-gamma * t) * np.exp(epsilon * E)\n    oscillation = np.cos(omega * t + phi)\n    x = envelope * oscillation + sigma * xi\n\n    # 2. Parameter Estimation\n    \n    # Coarse frequency estimate from PSD peak\n    # Use rfft for real-valued signal\n    n_fft = len(x)\n    yf = np.fft.rfft(x)\n    xf = np.fft.rfftfreq(n_fft, d=dt)\n    \n    # Find peak in power spectrum (ignoring DC component)\n    power = np.abs(yf[1:])**2\n    peak_idx = np.argmax(power) + 1 # +1 to account for slicing\n    f_peak = xf[peak_idx]\n\n    # Band-pass filter around the peak frequency\n    # Filter is designed to isolate the GAM mode from broadband noise\n    filter_order = 5\n    filter_bw = 6000.0  # Hz, a reasonable choice for these cases\n    f_low = max(1.0, f_peak - filter_bw / 2.0)\n    f_high = f_peak + filter_bw / 2.0\n    \n    nyquist = 0.5 * fs\n    # Wn is normalized to Nyquist frequency\n    wn = [f_low / nyquist, f_high / nyquist]\n    \n    sos = signal.butter(filter_order, wn, btype='bandpass', output='sos')\n    x_filt = signal.sosfiltfilt(sos, x)\n\n    # Analytic signal via Hilbert transform\n    z = signal.hilbert(x_filt)\n    envelope_hat = np.abs(z)\n    phase_hat = np.unwrap(np.angle(z))\n\n    # Perform fits only on the signal part with high SNR\n    # This avoids bias from the noise-dominated tail\n    valid_indices = np.where(envelope_hat > 3.0 * sigma)[0]\n    \n    # Check if we have enough points for a meaningful fit\n    if len(valid_indices)  20:\n        return False\n\n    t_valid = t[valid_indices]\n\n    # Estimate omega from phase slope\n    phase_valid = phase_hat[valid_indices]\n    omega_slope, _ = np.polyfit(t_valid, phase_valid, 1)\n    omega_hat = omega_slope\n\n    # Estimate gamma from envelope log-slope\n    log_envelope_valid = np.log(envelope_hat[valid_indices])\n    gamma_slope, _ = np.polyfit(t_valid, log_envelope_valid, 1)\n    gamma_hat = -gamma_slope\n\n    # 3. Validation\n    omega_err = np.abs(omega_hat - omega)\n    gamma_err = np.abs(gamma_hat - gamma)\n    \n    success = (omega_err = omega_tol) and (gamma_err = gamma_tol)\n    \n    return success\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # omega, gamma, A0, epsilon, tau_c, sigma, fs, T, phi, omega_tol, gamma_tol, seed\n    test_cases = [\n        (2 * np.pi * 12000, 1200, 1.25, 0.2, 5e-4, 0.02, 5.0e5, 0.012, 0.37, 2 * np.pi * 300, 200, 0),\n        (2 * np.pi * 18000, 3000, 0.8, 0.4, 3e-4, 0.04, 5.0e5, 0.010, 0.37, 2 * np.pi * 400, 500, 1),\n        (2 * np.pi * 9000, 600, 1.0, 0.3, 4e-4, 0.05, 5.0e5, 0.006, 0.37, 2 * np.pi * 500, 250, 2),\n        (2 * np.pi * 25000, 4500, 1.1, 0.0, 3e-4, 0.03, 5.0e5, 0.008, 0.37, 2 * np.pi * 400, 600, 3)\n    ]\n    \n    results = []\n    for case in test_cases:\n        result = analyze_signal(case)\n        results.append(result)\n\n    # Format output as specified: [True,False,True,True]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}