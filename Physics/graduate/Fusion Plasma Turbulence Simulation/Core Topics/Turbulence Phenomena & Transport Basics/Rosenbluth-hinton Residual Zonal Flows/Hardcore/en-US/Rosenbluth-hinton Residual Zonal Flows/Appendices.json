{
    "hands_on_practices": [
        {
            "introduction": "Understanding the Rosenbluth-Hinton (RH) residual begins with its derivation from fundamental kinetic principles. This first exercise guides you through the process of obtaining the classic formula for the collisionless residual zonal flow level. By treating the plasma as a dielectric medium with a frequency-dependent capacitance, you will explore how the initial classical polarization response relaxes to a final state governed by neoclassical polarization, providing a clear physical picture of the distinct roles played by trapped and passing ions in shielding the zonal potential .",
            "id": "3966389",
            "problem": "Consider an electrostatic, collisionless, axisymmetric tokamak in the large-aspect-ratio limit with inverse aspect ratio $\\epsilon \\ll 1$, safety factor $q$, and magnetic shear $s \\equiv (r/q)(dq/dr)$. Focus on the long-wavelength zonal perturbations of the electric potential $\\phi(r,t)$ that are poloidally and toroidally symmetric (i.e., $m=n=0$), with initial amplitude $\\phi(r,0) = \\phi_{0}(r)$ and radial wavenumber $k_{r}$ satisfying $k_{r}\\rho_{i} \\ll 1$, where $\\rho_{i}$ is the ion Larmor radius. Assume single-ion species with Maxwellian distribution, adiabatic electrons, and neglect finite plasma beta, collisions, and sources/sinks.\n\nUsing the linear gyrokinetic framework and the conservation properties of collisionless dynamics, derive the residual zonal flow level $R_{\\text{RH}}$ (the Rosenbluth–Hinton residual), defined as\n$$\nR_{\\text{RH}} \\equiv \\frac{\\phi(r,t \\to \\infty)}{\\phi_{0}(r)} \\, ,\n$$\nin terms of the parameters $q$, $\\epsilon$, and $s$ in the stated ordering. Your derivation should start from a valid fundamental base appropriate to computational fusion science and engineering, namely: the linear gyrokinetic equation for electrostatic perturbations, quasi-neutrality, and the identification of the geodesic acoustic mode (GAM) channel as the mediator of the transient response. Clearly state the long-wavelength ordering assumptions and show how the neoclassical polarization associated with trapped and passing ions determines the final flow level.\n\nExpress your final answer as a single closed-form analytic expression for $R_{\\text{RH}}$ in terms of $q$, $\\epsilon$, and $s$. No numerical evaluation is required, and no units are needed because $R_{\\text{RH}}$ is dimensionless. If any of the given parameters do not enter the residual in this limit, demonstrate and justify this outcome explicitly in your derivation. The final answer must be a single expression; do not present it as an inequality or an equation to be solved.",
            "solution": "The problem asks for the derivation of the Rosenbluth–Hinton residual zonal flow level, $R_{\\text{RH}} \\equiv \\phi(t \\to \\infty)/\\phi_0$, in a collisionless, electrostatic, large-aspect-ratio tokamak. The derivation will be performed within the linear gyrokinetic framework, assuming quasi-neutrality.\n\nThe fundamental principle governing the evolution of the zonal flow potential from its initial value $\\phi_0(r)$ to its final, steady-state value $\\phi(r, t \\to \\infty) \\equiv \\phi_\\infty(r)$ is the conservation of the total charge associated with the zonal flow mode in an isolated system. This can be conceptualized by treating the plasma as a dielectric medium with a frequency-dependent capacitance. An initial charge separation is created to support the initial potential $\\phi_0$. This charge is then held by the plasma, and as the system relaxes to its final state, the potential adjusts according to the change in the plasma's effective capacitance.\n\nLet $Q_{ZF}$ be the charge per unit volume associated with the zonal flow mode. This charge is related to the potential $\\phi$ through an effective capacitance $C$ of the plasma, $Q_{ZF} = C \\phi$. As the system is assumed to be isolated (no sources or sinks), $Q_{ZF}$ is conserved over time. Therefore, we have:\n$$ C(t=0^+) \\phi(t=0^+) = C(t \\to \\infty) \\phi(t \\to \\infty) $$\nThe initial potential is given as $\\phi_0$. The residual level is then the ratio of the initial to the final capacitance:\n$$ R_{\\text{RH}} = \\frac{\\phi_\\infty}{\\phi_0} = \\frac{C(t=0^+)}{C(t \\to \\infty)} $$\nThe problem thus reduces to determining the plasma's effective capacitance in the high-frequency limit ($t \\to 0^+$), which corresponds to the initial response, and in the zero-frequency limit ($t \\to \\infty$), which corresponds to the final relaxed state. The capacitance is determined by the plasma's polarization properties.\n\nThe total effective capacitance of the system is the sum of the classical and neoclassical contributions: $C(t) = C_{cl} + C_{neo}(t)$. The neoclassical contribution is time-dependent (or frequency-dependent) because it involves particle motion over orbital timescales.\n\n**1. High-Frequency Capacitance ($t \\to 0^+$)**\nIn the immediate aftermath of the potential being established ($t \\to 0^+$), the timescale is too short for particles to drift significantly or move along the magnetic field lines. The response is dominated by the rapid gyromotion of ions. This gives rise to the classical polarization current and charge density. The effective capacitance in this limit is purely the classical capacitance, $C(t=0^+) = C_{cl}$.\nThe classical ion polarization density $\\delta\\rho_{cl}$ for a perturbation with radial wavenumber $k_r$ is given by:\n$$ \\delta\\rho_{cl} = \\frac{n_0 m_i}{B^2} k_r^2 \\phi = \\frac{n_0 Z^2 e^2}{T_i} k_r^2 \\rho_{ti}^2 \\phi $$\nwhere $n_0$ is the ion density, $m_i$ the ion mass, $T_i$ the ion temperature, $B$ the magnetic field strength, $Ze$ the ion charge, and $\\rho_{ti} = \\sqrt{T_i/m_i}/\\Omega_{ci}$ is the thermal ion Larmor radius with $\\Omega_{ci} = ZeB/m_i$. The classical capacitance is the coefficient relating charge and potential:\n$$ C_{cl} \\propto \\frac{n_0 Z^2 e^2}{T_i} k_r^2 \\rho_{ti}^2 $$\n\n**2. Low-Frequency Capacitance ($t \\to \\infty$)**\nAs time progresses towards infinity ($t \\to \\infty$), the system relaxes to a new steady state. On these long timescales, particles have time to drift and transit or bounce along field lines. This leads to an additional, much larger polarization known as neoclassical polarization. The final capacitance is the sum of the classical and the fully developed neoclassical capacitance: $C(t \\to \\infty) = C_{cl} + C_{neo}$.\nNeoclassical polarization in the collisionless limit arises from the distinct orbital dynamics of trapped and passing ions in the toroidal magnetic geometry. Due to the conservation of canonical toroidal angular momentum, $P_\\zeta$, the flux-surface-averaged density of passing ions cannot change in response to a purely radial electric field. Consequently, passing ions do not contribute to the shielding of the zonal potential in the long-time limit.\nTrapped ions, however, are not constrained in the same way. Their banana-shaped orbits can undergo a radial drift in the presence of the zonal potential, leading to a significant charge separation. This effect constitutes the neoclassical polarization.\n\nWe can estimate the magnitude of the neoclassical capacitance relative to the classical one with a scaling argument. The polarization capacitance is proportional to the density of the polarizing particles and the square of their characteristic radial displacement or orbit size.\n- Classical capacitance is due to all ions (fraction $1$) with a characteristic radial scale of the Larmor radius $\\rho_i$: $C_{cl} \\propto n_0 \\rho_i^2$.\n- Neoclassical capacitance is due only to trapped ions. The fraction of trapped ions, $f_t$, in a large-aspect-ratio tokamak ($\\epsilon = r/R_0 \\ll 1$) is $f_t \\approx \\sqrt{2\\epsilon}$. The characteristic radial size of their orbits is the banana width, $\\Delta r_b$. For a deeply trapped particle, $\\Delta r_b \\approx \\frac{v_\\parallel}{\\Omega_{cp}} \\approx \\frac{q v_\\perp}{\\sqrt{\\epsilon}\\Omega_{ci}} \\approx \\frac{q \\rho_i}{\\sqrt{\\epsilon}}$, where $\\Omega_{cp} = ZeB_p/m_i$ is the poloidal gyrofrequency and $q \\approx rB_t/RB_p$.\nThus, the neoclassical capacitance scales as:\n$$ C_{neo} \\propto n_0 f_t (\\Delta r_b)^2 \\approx n_0 \\sqrt{\\epsilon} \\left( \\frac{q \\rho_i}{\\sqrt{\\epsilon}} \\right)^2 = n_0 \\sqrt{\\epsilon} \\frac{q^2 \\rho_i^2}{\\epsilon} = n_0 \\frac{q^2 \\rho_i^2}{\\sqrt{\\epsilon}} $$\nThe ratio of the neoclassical to classical capacitance is therefore:\n$$ \\frac{C_{neo}}{C_{cl}} \\propto \\frac{n_0 q^2 \\rho_i^2 / \\sqrt{\\epsilon}}{n_0 \\rho_i^2} = \\frac{q^2}{\\sqrt{\\epsilon}} $$\nA full kinetic calculation over the ion distribution function is required to find the precise numerical coefficient. This calculation yields:\n$$ \\frac{C_{neo}}{C_{cl}} = c_0 \\frac{q^2}{\\sqrt{\\epsilon}} $$\nwhere the numerical constant $c_0 \\approx 1.63$. We will use the commonly cited value $c_0 = 1.6$ for this derivation.\n\n**3. Final Residual Level**\nThe residual zonal flow level is now found by substituting the expressions for the capacitance into the conservation relation:\n$$ R_{\\text{RH}} = \\frac{C_{cl}}{C_{cl} + C_{neo}} = \\frac{1}{1 + C_{neo}/C_{cl}} $$\n$$ R_{\\text{RH}} = \\frac{1}{1 + 1.6 \\frac{q^2}{\\sqrt{\\epsilon}}} $$\n\n**4. Dependence on Magnetic Shear ($s$)**\nThe problem asks for the dependence on $q$, $\\epsilon$, and $s$. In the standard large-aspect-ratio, circular flux surface model, the leading-order expression for the collisionless neoclassical polarization does not depend on the magnetic shear $s$. The shear primarily affects the parallel connection length and can modify orbit topology, but its effect on the banana width and the trapped particle fraction is of higher order in $\\epsilon$. Therefore, in the limit considered, the Rosenbluth-Hinton residual is independent of $s$.\n\nThe final expression is thus a function of $q$ and $\\epsilon$ only.",
            "answer": "$$\\boxed{\\frac{1}{1 + 1.6 \\frac{q^2}{\\sqrt{\\epsilon}}}}$$"
        },
        {
            "introduction": "Having established the physics behind the RH residual, we now turn to its crucial role in regulating plasma turbulence. This practice involves constructing a predator-prey model to describe the dynamic interplay between drift-wave turbulence (the 'prey') and zonal flows (the 'predator'). By incorporating the RH residual as a key parameter that determines the efficiency of zonal flow generation, this exercise demonstrates how this microscopic kinetic effect influences the macroscopic, steady-state turbulence level and associated transport .",
            "id": "4199444",
            "problem": "Consider electrostatic drift-wave turbulence interacting with axisymmetric zonal flows in a large-aspect-ratio tokamak. Treat the dynamics in a collisionless, radially local annulus where flux surfaces are nested and magnetic shear is weak. Work with normalized, dimensionless variables: let $Z(t)$ denote the zonal-flow amplitude (proportional to the $E \\times B$ shearing rate, normalized to a characteristic linear growth rate), and let $I(t)$ denote the turbulence intensity (normalized free energy density). Assume that the interaction is captured by energy-transfer arguments and mean-field closures that do not rely on geometry-specific shortcut formulas.\n\nAs a fundamental base, use the following widely accepted facts:\n- Zonal flows are driven by the divergence of the Reynolds stress (RS) of the turbulence, transferring free energy from the fluctuations into the mean flow. Denote the RS drive by a coefficient $\\alpha0$ such that the instantaneous drive scales linearly with $I$.\n- Turbulence is quenched by $E \\times B$ shear with a suppression term that scales bilinearly in the zonal-flow amplitude and turbulence intensity, with coefficient $\\eta0$.\n- Turbulence has an effective nonlinear self-damping (cascade) that scales like $I^{2}$ with coefficient $\\beta0$, and a net linear drive $\\gamma0$ from the background gradients.\n- Zonal flows experience geodesic curvature coupling to compressible motions known as the geodesic acoustic mode (GAM), which in the collisionless limit produces a transient relaxation. Due to the Rosenbluth–Hinton residual effect (Rosenbluth–Hinton (RH) residual), a finite fraction of the zonal flow persists after the GAM transient. Model this by introducing a residual response factor $\\mathcal{R}\\in(0,1)$ that multiplies the effective RS-to-zonal-flow transfer. The remaining fraction of the transient response is accounted for by a net relaxation term proportional to $Z$ with coefficient $\\mu0$, representing the time-asymptotic decay channel of the non-residual part.\n\nStarting from these bases, derive a minimal predator–prey dynamical system for $Z(t)$ and $I(t)$ that is consistent with energy conservation between turbulence and mean flows in the quasilinear limit. Then, determine the positive steady state $(Z^{\\ast},I^{\\ast})$ by setting time derivatives to zero and solving algebraically. You must express your final answer as the closed-form analytic expression for $Z^{\\ast}$ in terms of the parameters $\\alpha, \\beta, \\eta, \\gamma, \\mu, \\mathcal{R}$ only.\n\nAll variables are dimensionless by construction; do not include any units in your final expression. Provide no numerical evaluation. The final answer must be a single closed-form expression for $Z^{\\ast}$.",
            "solution": "The user has provided a problem statement that requires validation before a solution can be attempted.\n\n### Step 1: Extract Givens\n- **Variables**:\n    - $Z(t)$: Zonal-flow amplitude, normalized.\n    - $I(t)$: Turbulence intensity (normalized free energy density).\n- **Parameters**:\n    - $\\alpha0$: Coefficient for Reynolds stress (RS) drive of zonal flows.\n    - $\\eta0$: Coefficient for turbulence quenching by $E \\times B$ shear.\n    - $\\beta0$: Coefficient for nonlinear self-damping of turbulence.\n    - $\\gamma0$: Coefficient for net linear drive of turbulence.\n    - $\\mathcal{R}\\in(0,1)$: Rosenbluth–Hinton residual response factor.\n    - $\\mu0$: Relaxation coefficient for the non-residual part of the zonal flow.\n- **Physical Interactions**:\n    1.  The drive for zonal flow $Z$ from turbulence intensity $I$ scales as $\\alpha I$.\n    2.  The quenching of turbulence $I$ by zonal flow $Z$ is a bilinear term, scaling as $\\eta Z I$.\n    3.  Turbulence has a nonlinear self-damping term scaling as $I^{2}$ with coefficient $\\beta$.\n    4.  Turbulence has a linear drive term scaling as $I$ with coefficient $\\gamma$.\n    5.  The residual factor $\\mathcal{R}$ multiplies the effective RS-to-zonal-flow transfer.\n    6.  Zonal flows have a net relaxation term proportional to $Z$ with coefficient $\\mu$.\n- **Task**:\n    1.  Derive a minimal predator–prey dynamical system for $Z(t)$ and $I(t)$.\n    2.  Determine the positive steady state $(Z^{\\ast}, I^{\\ast})$.\n    3.  Provide the closed-form analytic expression for $Z^{\\ast}$ in terms of the given parameters.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes the construction of a simplified coupled ordinary differential equation model for zonal flow-turbulence interaction in a tokamak plasma. This is a standard topic in fusion plasma physics, often modeled with predator-prey type equations.\n\n- **Scientifically Grounded**: The premises are based on well-established concepts in plasma turbulence theory: Reynolds stress driving zonal flows, shear suppression of turbulence, linear instabilities driven by plasma gradients, nonlinear saturation, and the Rosenbluth-Hinton residual zonal flow. The formulation of the model based on these effects is a standard and scientifically accepted approach for obtaining a qualitative and semi-quantitative understanding of the system's dynamics.\n- **Well-Posed**: The problem asks for the derivation of a system of equations from a clear set of physical interaction rules and then to find its fixed points. The rules provided are sufficient to uniquely define a two-variable ODE system. The algebraic system for the fixed points is well-defined and, as will be shown, admits a unique positive solution.\n- **Objective**: The language is precise and technical, using standard terminology from the field of plasma physics. There are no subjective or opinion-based statements.\n- **Completeness and Consistency**: The problem provides all necessary parameters and defines the relationships between the variables required to construct the model. There are no apparent contradictions in the definitions. The condition $\\mathcal{R} \\in (0,1)$ and the positivity of all other parameters are physically and mathematically consistent.\n\nThe problem does not violate any of the invalidity criteria. It is a scientifically sound, well-posed, and objective problem in theoretical plasma physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Solution Derivation\nBased on the provided physical interactions, we construct a system of two coupled ordinary differential equations for the turbulence intensity $I(t)$ and the zonal flow amplitude $Z(t)$.\n\nFirst, we formulate the equation for the rate of change of turbulence intensity, $\\frac{dI}{dt}$. The sources and sinks for $I$ are:\n- A linear drive from background gradients, contributing a term $+\\gamma I$.\n- Quenching by the shearing from the zonal flow, a bilinear interaction, contributing a term $-\\eta Z I$.\n- A nonlinear self-damping term, representing energy cascade, contributing a term $-\\beta I^{2}$.\n\nCombining these terms, the dynamical equation for $I(t)$ is:\n$$\n\\frac{dI}{dt} = \\gamma I - \\eta Z I - \\beta I^{2}\n$$\n\nNext, we formulate the equation for the rate of change of the zonal flow amplitude, $\\frac{dZ}{dt}$. The sources and sinks for $Z$ are:\n- A drive from the turbulence Reynolds stress, which is proportional to the turbulence intensity $I$, with a coefficient $\\alpha$.\n- This drive is for the total zonal flow response. The problem specifies that the long-lived, residual flow component is a fraction $\\mathcal{R}$ of this. Thus, the effective drive for the persistent zonal flow $Z$ is $+\\mathcal{R} \\alpha I$.\n- A relaxation (damping) term for the non-residual part of the flow response, which is modeled as a linear damping of the existing flow amplitude $Z$ with a coefficient $\\mu$. This contributes a term $-\\mu Z$.\n\nCombining these terms, the dynamical equation for $Z(t)$ is:\n$$\n\\frac{dZ}{dt} = \\mathcal{R} \\alpha I - \\mu Z\n$$\n\nThe complete predator-prey system is:\n$$\n\\begin{cases}\n\\frac{dI}{dt} = I (\\gamma - \\eta Z - \\beta I) \\\\\n\\frac{dZ}{dt} = \\mathcal{R} \\alpha I - \\mu Z\n\\end{cases}\n$$\n\nTo find the steady state $(Z^{\\ast}, I^{\\ast})$, we set the time derivatives to zero:\n$$\n\\frac{dI}{dt} = 0 \\quad \\text{and} \\quad \\frac{dZ}{dt} = 0\n$$\n\nThe system of algebraic equations for the steady state is:\n$$\n\\begin{cases}\nI^{\\ast} (\\gamma - \\eta Z^{\\ast} - \\beta I^{\\ast}) = 0  (1) \\\\\n\\mathcal{R} \\alpha I^{\\ast} - \\mu Z^{\\ast} = 0  (2)\n\\end{cases}\n$$\n\nFrom equation $(1)$, there are two possibilities. The first is $I^{\\ast} = 0$, which from equation $(2)$ implies $\\mu Z^{\\ast} = 0$, so $Z^{\\ast}=0$. This gives the trivial steady state $(Z^{\\ast}, I^{\\ast}) = (0, 0)$, representing a state with no turbulence and no zonal flows.\n\nThe problem asks for the *positive* steady state, which corresponds to a sustained turbulent state. For this, we must have $I^{\\ast} > 0$. This requires the second factor in equation $(1)$ to be zero:\n$$\n\\gamma - \\eta Z^{\\ast} - \\beta I^{\\ast} = 0 \\quad \\implies \\quad \\eta Z^{\\ast} + \\beta I^{\\ast} = \\gamma \\quad (3)\n$$\n\nNow we have a system of two linear equations for $I^{\\ast}$ and $Z^{\\ast}$, which are equations $(2)$ and $(3)$:\n$$\n\\begin{cases}\n\\eta Z^{\\ast} + \\beta I^{\\ast} = \\gamma \\\\\n-\\mu Z^{\\ast} + \\mathcal{R} \\alpha I^{\\ast} = 0\n\\end{cases}\n$$\n\nFrom the second equation, we can express $I^{\\ast}$ in terms of $Z^{\\ast}$:\n$$\nI^{\\ast} = \\frac{\\mu}{\\mathcal{R} \\alpha} Z^{\\ast}\n$$\nNote that since $\\mu, \\mathcal{R}, \\alpha$ are all positive, $I^{\\ast}$ will be positive if and only if $Z^{\\ast}$ is positive.\n\nNow, we substitute this expression for $I^{\\ast}$ into the first equation:\n$$\n\\eta Z^{\\ast} + \\beta \\left( \\frac{\\mu}{\\mathcal{R} \\alpha} Z^{\\ast} \\right) = \\gamma\n$$\n\nWe can factor out $Z^{\\ast}$:\n$$\nZ^{\\ast} \\left( \\eta + \\frac{\\beta \\mu}{\\mathcal{R} \\alpha} \\right) = \\gamma\n$$\n\nTo isolate $Z^{\\ast}$, we first combine the terms in the parenthesis over a common denominator:\n$$\nZ^{\\ast} \\left( \\frac{\\eta \\mathcal{R} \\alpha + \\beta \\mu}{\\mathcal{R} \\alpha} \\right) = \\gamma\n$$\n\nFinally, solving for $Z^{\\ast}$ yields:\n$$\nZ^{\\ast} = \\gamma \\left( \\frac{\\mathcal{R} \\alpha}{\\eta \\mathcal{R} \\alpha + \\beta \\mu} \\right)\n$$\n$$\nZ^{\\ast} = \\frac{\\gamma \\mathcal{R} \\alpha}{\\eta \\mathcal{R} \\alpha + \\beta \\mu}\n$$\n\nAll parameters $\\gamma, \\mathcal{R}, \\alpha, \\eta, \\beta, \\mu$ are given as positive. Therefore, the numerator $\\gamma \\mathcal{R} \\alpha$ is positive, and the denominator $\\eta \\mathcal{R} \\alpha + \\beta \\mu$ is also positive. This guarantees that $Z^{\\ast} > 0$, confirming the existence of the positive steady state.",
            "answer": "$$\n\\boxed{\\frac{\\gamma \\mathcal{R} \\alpha}{\\eta \\mathcal{R} \\alpha + \\beta \\mu}}\n$$"
        },
        {
            "introduction": "The final step in mastering the RH residual is to connect analytical theory with computational practice. This hands-on exercise challenges you to write a program that numerically calculates the RH residual by evaluating the underlying velocity-space integrals that define the neoclassical response. This practice not only reinforces the theoretical concepts of parallel compressibility and geodesic curvature but also introduces the essential computational skill of verifying numerical convergence with respect to grid resolution, bridging the gap between theoretical formulas and their implementation in simulations .",
            "id": "3985269",
            "problem": "You are to implement a complete, runnable program that computes the residual level of axisymmetric zonal flow after linear collisionless relaxation in a large-aspect-ratio tokamak, known as the Rosenbluth-Hinton residual, by emulating a linearized initial-value approach in velocity space. The computational task targets Geodesic Acoustic Modes (GAM) in the geodesic-curvature-driven zonal flow relaxation problem with adiabatic electrons. The acronym definitions are: Geodesic Acoustic Mode (GAM) and Rosenbluth-Hinton (RH).\n\nThe computational base must follow from first principles of the linearized drift-kinetic description for ions, quasineutrality with adiabatic electrons, and energy-momentum conservation. The ions are assumed to have a Maxwellian background with thermal speed $v_{\\mathrm{th}}$ defined by $v_{\\mathrm{th}} = \\sqrt{2 T_i / m_i}$ under normalized units with Boltzmann constant equal to $1$. The magnetic geometry is approximated by a circular, large-aspect-ratio tokamak with safety factor $q$, retaining the dominant geodesic curvature coupling. The radial wavenumber is assumed long-wavelength so that finite Larmor radius effects are negligible. The goal is to extract the long-time residual response of the zonal potential from the linearized initial-value system without time-stepping, by projecting onto the zero-frequency component implied by invariants of the linear operator.\n\nStarting from fundamental laws and core definitions:\n- Conservation of particles and momentum from the linearized drift-kinetic equation for ions in the presence of a zonal electric field $E_r(t)$, together with quasineutrality and adiabatic electron response.\n- The ion distribution function perturbation $g$ obeys phase mixing along field lines in the collisionless limit, while the zonal potential $\\varphi(t)$ evolves under polarization and parallel compressibility driven by geodesic curvature.\n- The asymptotic residual $\\mathcal{R} \\equiv \\varphi(\\infty)/\\varphi(0)$ arises from the projection onto the zero-frequency subspace of the linearized operator, and can be written purely as a velocity-space integral over a pitch-dependent geodesic weight that captures parallel compressibility.\n\nIn the large-aspect-ratio limit with circular flux surfaces, the leading-order geodesic curvature dependence of the parallel compressibility can be represented by a pitch-dependent weight $w(\\xi)$, where $\\xi \\equiv v_\\parallel / v$ is the pitch cosine. For this pedagogical exercise, the problem employs a simplified model that captures the characteristic $q^2$ dependence of the shielding but, for simplicity, omits the dependence on the inverse aspect ratio $\\epsilon$, which is present in the full theory. For a symmetric distribution of pitch, use $\\xi \\in [-1,1]$ and the geodesic weight model $w(\\xi) = 1 - \\xi^2/2$ to represent the dominant passing and trapped contributions to compressibility. The ion distribution is Maxwellian in $v_\\parallel$ with\n$$\nf_M(v_\\parallel) = \\frac{1}{\\sqrt{\\pi} v_{\\mathrm{th}}} \\exp\\left(-\\frac{v_\\parallel^2}{v_{\\mathrm{th}}^2}\\right),\n$$\nand the velocity-space measure factorizes into parallel and pitch parts in this simplified model. The long-time residual $\\mathcal{R}$ then reduces to an expression of the form\n$$\n\\mathcal{R} = \\frac{1}{1 + q^2 \\mathcal{I}},\n$$\nwhere $\\mathcal{I}$ is a velocity-space integral computable by numerical quadrature over the chosen $v_\\parallel$ grid and pitch resolution:\n$$\n\\mathcal{I} \\equiv \\left(\\int_{-\\infty}^{\\infty} f_M(v_\\parallel) \\, \\mathrm{d} v_\\parallel\\right) \\left(\\int_{-1}^{1} w(\\xi) \\, \\mathrm{d} \\xi\\right).\n$$\nIn practice, you will approximate the integral over $v_\\parallel$ on a symmetric interval $[-L,L]$ using $L = \\alpha v_{\\mathrm{th}}$ with a finite cutoff factor $\\alpha$, evaluating the integral numerically with a specified number of grid points $N_{v_\\parallel}$. The pitch-angle integral over $\\xi \\in [-1,1]$ is likewise evaluated numerically using a specified number of pitch grid points $N_\\xi$.\n\nImplement a program that, for each test case, constructs the $v_\\parallel$ and $\\xi$ grids, performs the numerical quadratures to estimate $\\mathcal{I}$, and then computes the residual $\\mathcal{R}$. This emulates extracting the Rosenbluth-Hinton residual from a linearized initial-value system via its zero-frequency invariant, and allows you to verify convergence with respect to the $v_\\parallel$ grid and the pitch resolution.\n\nUse normalized units with Boltzmann constant equal to $1$ throughout. No physical units appear in the final outputs; all outputs are dimensionless floats.\n\nTest Suite:\n- Case 1 (happy path): $q = 1.5$, $N_{v_\\parallel} = 32$, $N_\\xi = 32$.\n- Case 2 (refined grid): $q = 1.5$, $N_{v_\\parallel} = 128$, $N_\\xi = 128$.\n- Case 3 (coarse grid, edge): $q = 1.5$, $N_{v_\\parallel} = 8$, $N_\\xi = 8$.\n- Case 4 (boundary condition): $q = 0.0$, $N_{v_\\parallel} = 32$, $N_\\xi = 32$.\n- Case 5 (larger $q$): $q = 2.5$, $N_{v_\\parallel} = 64$, $N_\\xi = 64$.\n- Case 6 (very large $q$, edge): $q = 5.0$, $N_{v_\\parallel} = 64$, $N_\\xi = 64$.\n\nFixed parameters used internally in the program to define the Maxwellian are $T_i = 1.0$ and $m_i = 1.0$, with the integration cutoff chosen as $L = \\alpha v_{\\mathrm{th}}$ with $\\alpha = 4.0$. These choices are consistent with normalized units and ensure the parallel integral is close to unity while allowing convergence testing as the number of grid points is varied.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5,result6]\"), where each result is the float value of $\\mathcal{R}$ for the corresponding test case in the order listed above.",
            "solution": "The user problem has been validated and is deemed valid. It is a well-posed, scientifically grounded computational problem from the field of plasma physics.\n\nThe objective is to compute the Rosenbluth-Hinton (RH) residual level of zonal flow, denoted by $\\mathcal{R}$, for several parameter sets. This residual quantifies the long-time, collisionless shielding of an initial zonal potential in a tokamak plasma. The computation is based on a linearized drift-kinetic model in a large-aspect-ratio, circular tokamak geometry.\n\nThe RH residual $\\mathcal{R}$ is defined as the ratio of the asymptotic zonal potential $\\varphi(\\infty)$ to the initial potential $\\varphi(0)$. Based on the provided physical model involving geodesic curvature-driven relaxation with adiabatic electrons, its value is given by the formula:\n$$\n\\mathcal{R} = \\frac{1}{1 + q^2 \\mathcal{I}}\n$$\nHere, $q$ is the safety factor, which characterizes the magnetic field helicity. The term $\\mathcal{I}$ represents the velocity-space-averaged polarizability, which stems from the parallel compressibility of the ion guiding-center motion. Within the specified simplified model, this integral is factorized into two separate one-dimensional integrals:\n$$\n\\mathcal{I} \\equiv \\left(\\int_{-\\infty}^{\\infty} f_M(v_\\parallel) \\, \\mathrm{d} v_\\parallel\\right) \\left(\\int_{-1}^{1} w(\\xi) \\, \\mathrm{d} \\xi\\right)\n$$\nThe functions in these integrals are defined as follows:\n$1$. The ion distribution function $f_M(v_\\parallel)$ is a one-dimensional Maxwellian distribution for the velocity component parallel to the magnetic field, given by:\n$$\nf_M(v_\\parallel) = \\frac{1}{\\sqrt{\\pi} v_{\\mathrm{th}}} \\exp\\left(-\\frac{v_\\parallel^2}{v_{\\mathrm{th}}^2}\\right)\n$$\nwhere $v_{\\mathrm{th}} = \\sqrt{2 T_i / m_i}$ is the ion thermal speed, with $T_i$ being the ion temperature and $m_i$ the ion mass. The problem specifies normalized units where the Boltzmann constant is $1$.\n\n$2$. The geodesic weight function $w(\\xi)$ models the effect of geodesic curvature on particle motion as a function of the pitch-angle cosine $\\xi \\equiv v_\\parallel / v$, where $v$ is the total particle speed. The simplified model to be used is:\n$$\nw(\\xi) = 1 - \\frac{\\xi^2}{2}\n$$\nfor $\\xi \\in [-1, 1]$.\n\nThe computational task is to evaluate $\\mathcal{R}$ by approximating the integrals for $\\mathcal{I}$ using numerical quadrature. The algorithmic procedure is as follows:\n\nFirst, we establish the fixed physical and numerical parameters. The ion temperature is $T_i = 1.0$ and mass is $m_i = 1.0$. This allows for the calculation of the ion thermal speed $v_{\\mathrm{th}} = \\sqrt{2 \\cdot 1.0 / 1.0} = \\sqrt{2}$. The integral over $v_\\parallel$ is computationally performed over a finite symmetric interval $[-L, L]$, where the cutoff $L$ is determined by the factor $\\alpha = 4.0$, such that $L = \\alpha v_{\\mathrm{th}} = 4.0\\sqrt{2}$. This range covers four standard deviations of the equivalent normal distribution, ensuring the integral is a very close approximation to its value over $(-\\infty, \\infty)$.\n\nFor each test case, defined by a tuple $(q, N_{v_\\parallel}, N_\\xi)$, we perform the following steps:\n\n1.  **Construct Numerical Grids**:\n    - A uniform grid for parallel velocity $v_\\parallel$ is created over the interval $[-L, L]$ with $N_{v_\\parallel}$ points.\n    - A uniform grid for the pitch-angle cosine $\\xi$ is created over the interval $[-1, 1]$ with $N_\\xi$ points.\n\n2.  **Evaluate Integrands**:\n    - The function $f_M(v_\\parallel)$ is evaluated at each point on the $v_\\parallel$ grid.\n    - The function $w(\\xi)$ is evaluated at each point on the $\\xi$ grid.\n\n3.  **Perform Numerical Quadrature**:\n    - The integral $I_{v_\\parallel} = \\int_{-L}^{L} f_M(v_\\parallel) \\, \\mathrm{d}v_\\parallel$ is computed using the trapezoidal rule on the discrete values.\n    - The integral $I_{\\xi} = \\int_{-1}^{1} w(\\xi) \\, \\mathrm{d}\\xi$ is likewise computed using the trapezoidal rule.\n\n4.  **Calculate $\\mathcal{I}$**: The total polarizability integral is the product of the two numerical results: $\\mathcal{I} = I_{v_\\parallel} \\times I_{\\xi}$.\n\n5.  **Calculate the Residual $\\mathcal{R}$**: The final value for the RH residual is computed using the main formula with the given safety factor $q$ and the numerically determined $\\mathcal{I}$: $\\mathcal{R} = 1 / (1 + q^2 \\mathcal{I})$.\n\nThis procedure is repeated for each test case provided in the problem statement, and the resulting values of $\\mathcal{R}$ are collected. For the specific case where $q = 0.0$, the formula simplifies to $\\mathcal{R} = 1 / (1 + 0) = 1.0$ irrespective of the value of $\\mathcal{I}$, which is physically correct as it corresponds to a cylindrical geometry with no geodesic curvature. The numerical implementation will reflect this exact result.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Rosenbluth-Hinton residual for geodesic acoustic modes\n    based on a simplified linearized initial-value problem.\n    \"\"\"\n\n    # Define the fixed physical and numerical parameters as specified.\n    # Ion temperature in normalized units.\n    T_i = 1.0\n    # Ion mass in normalized units.\n    m_i = 1.0\n    # Integration cutoff factor for the parallel velocity integral.\n    alpha = 4.0\n\n    # Calculate derived constants.\n    # Ion thermal speed, v_th = sqrt(2*T_i/m_i).\n    v_th = np.sqrt(2 * T_i / m_i)\n    # Integration limit for parallel velocity, L = alpha * v_th.\n    L = alpha * v_th\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (q, N_v_parallel, N_xi)\n    test_cases = [\n        (1.5, 32, 32),    # Case 1 (happy path)\n        (1.5, 128, 128),  # Case 2 (refined grid)\n        (1.5, 8, 8),      # Case 3 (coarse grid, edge)\n        (0.0, 32, 32),    # Case 4 (boundary condition)\n        (2.5, 64, 64),    # Case 5 (larger q)\n        (5.0, 64, 64),    # Case 6 (very large q, edge)\n    ]\n\n    results = []\n    for case in test_cases:\n        q, N_v_parallel, N_xi = case\n\n        # Handle the special case q=0.0 analytically.\n        if q == 0.0:\n            R_residual = 1.0\n            results.append(R_residual)\n            continue\n\n        # 1. Compute the parallel velocity integral: I_v_parallel.\n        # Create the grid for v_parallel.\n        v_parallel_grid = np.linspace(-L, L, N_v_parallel)\n        # Define the 1D Maxwellian distribution function f_M(v_parallel).\n        f_M = (1 / (np.sqrt(np.pi) * v_th)) * np.exp(-(v_parallel_grid**2) / v_th**2)\n        # Perform numerical integration using the trapezoidal rule.\n        I_v_parallel = np.trapz(f_M, v_parallel_grid)\n\n        # 2. Compute the pitch-angle integral: I_xi.\n        # Create the grid for xi.\n        xi_grid = np.linspace(-1.0, 1.0, N_xi)\n        # Define the geodesic weight function w(xi).\n        w_xi = 1 - xi_grid**2 / 2.0\n        # Perform numerical integration using the trapezoidal rule.\n        I_xi = np.trapz(w_xi, xi_grid)\n\n        # 3. Calculate the total velocity-space integral I.\n        I_total = I_v_parallel * I_xi\n\n        # 4. Compute the Rosenbluth-Hinton residual R.\n        R_residual = 1.0 / (1.0 + q**2 * I_total)\n        \n        results.append(R_residual)\n\n    # Final print statement in the exact required format.\n    # Using a general format specifier to maintain precision.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}