{
    "hands_on_practices": [
        {
            "introduction": "To build robust simulations, we must first master the underlying physics in simplified contexts. This exercise provides a foundational test case by asking you to derive the exact analytical solution for a one-dimensional kinetic system with a constant source and a linear sink . Solving this problem reinforces your understanding of the steady-state balance that sources and sinks create and provides a vital benchmark for verifying the accuracy of more complex numerical codes.",
            "id": "4196643",
            "problem": "Consider a one-dimensional slab model for a full-distribution-function (full-$f$) kinetic simulation of a magnetized fusion plasma along a rectilinear coordinate $x \\in [0,L]$ aligned with the magnetic field. The full distribution function $f(x)$ represents the phase-space density of guiding centers with a fixed parallel speed $v>0$ (monoenergetic approximation) streaming along $+x$. In steady state, the evolution of $f(x)$ is governed by the balance of parallel free streaming, a spatially uniform particle source, and a linear sink that models losses to material boundaries or effective collisional absorption. Starting from the kinetic advection-source-sink balance\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = S(x) - \\Sigma(f,x),\n$$\nassume steady state $\\partial f/\\partial t=0$, a constant source $S(x)=S_0$ with $S_0 \\ge 0$, and a linear sink $\\Sigma(f,x) = \\alpha f$ with $\\alpha>0$ (e.g., a Bhatnagar–Gross–Krook (BGK) type relaxation to zero). The domain has an inflow boundary condition at $x=0$ appropriate for right-moving characteristics,\n$$\nf(0) = f_{\\mathrm{in}},\n$$\nwith $f_{\\mathrm{in}} \\ge 0$ given, and a free outflow at $x=L$ (no additional boundary constraint is imposed at $x=L$ for $v>0$).\n\nDerive the analytic steady-state solution $f(x)$ from first principles using the above fundamental kinetic balance and appropriate boundary placement for characteristics. Then verify that your solution satisfies the inflow boundary condition at $x=0$ and is physically admissible (bounded and nonnegative for $S_0 \\ge 0$, $\\alpha>0$, $f_{\\mathrm{in}} \\ge 0$). Express your final answer as a single closed-form analytic expression for $f(x)$. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The time-dependent kinetic equation is $\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = S(x) - \\Sigma(f,x)$.\n- **Domain:** The spatial domain is a one-dimensional slab, $x \\in [0,L]$.\n- **Particle Velocity:** Particles are monoenergetic with a fixed parallel speed $v > 0$, streaming in the positive $x$ direction.\n- **Steady State:** The system is in steady state, so $\\frac{\\partial f}{\\partial t} = 0$.\n- **Source Term:** The particle source is spatially uniform, $S(x) = S_0$, with $S_0 \\ge 0$.\n- **Sink Term:** The particle sink is linear, $\\Sigma(f,x) = \\alpha f$, with $\\alpha > 0$.\n- **Inflow Boundary Condition:** The distribution function at the inflow boundary $x=0$ is specified as $f(0) = f_{\\mathrm{in}}$, with $f_{\\mathrm{in}} \\ge 0$.\n- **Outflow Condition:** A free outflow condition is assumed at $x=L$, which for particles with $v>0$ means no constraint is imposed at this boundary.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria for validity.\n\n- **Scientific Groundedness:** The problem is based on the one-dimensional, steady-state kinetic transport equation. This is a fundamental equation in transport theory and plasma physics. The source term ($S_0$) and sink term ($\\alpha f$) are standard, simplified models (e.g., a BGK-type collision operator relaxing to a zero background) used to represent particle sources and losses. The model is physically and mathematically sound.\n- **Well-Posedness:** In steady state, the governing partial differential equation reduces to a first-order ordinary differential equation in the spatial coordinate $x$. A first-order ODE requires a single boundary condition to yield a unique solution. The problem provides exactly one boundary condition, $f(0) = f_{\\mathrm{in}}$. Since the characteristics of the equation $v \\frac{df}{dx} = \\dots$ propagate in the direction of increasing $x$ (because $v>0$), the boundary condition must be specified at the inflow boundary, $x=0$. The problem correctly does this. Therefore, the problem is well-posed.\n- **Objectivity:** The problem is stated in precise mathematical and physical terms, free of ambiguity or subjective language.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and objective. It is free from contradictions, missing information, and other flaws. Therefore, the problem is deemed **valid**. A solution will now be derived.\n\nThe starting point is the provided kinetic equation:\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = S(x) - \\Sigma(f,x)\n$$\nApplying the steady-state condition, $\\frac{\\partial f}{\\partial t} = 0$, and substituting the given forms for the source, $S(x) = S_0$, and sink, $\\Sigma(f,x) = \\alpha f$, we obtain the steady-state equation for the distribution function $f(x)$:\n$$\nv \\frac{df}{dx} = S_0 - \\alpha f\n$$\nThis is a first-order linear ordinary differential equation. To solve it, we rearrange it into the standard form $\\frac{dy}{dx} + P(x)y = Q(x)$:\n$$\nv \\frac{df}{dx} + \\alpha f = S_0\n$$\nDividing by the constant speed $v$ (since $v>0$), we get:\n$$\n\\frac{df}{dx} + \\frac{\\alpha}{v} f = \\frac{S_0}{v}\n$$\nThis equation can be solved using the method of integrating factors. The integrating factor, $I(x)$, is given by:\n$$\nI(x) = \\exp\\left(\\int \\frac{\\alpha}{v} dx\\right) = \\exp\\left(\\frac{\\alpha x}{v}\\right)\n$$\nMultiplying the differential equation by the integrating factor $I(x)$ yields:\n$$\n\\exp\\left(\\frac{\\alpha x}{v}\\right) \\frac{df}{dx} + \\frac{\\alpha}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right) f = \\frac{S_0}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right)\n$$\nThe left-hand side is the derivative of the product $f(x)I(x)$ by the product rule:\n$$\n\\frac{d}{dx}\\left[f(x) \\exp\\left(\\frac{\\alpha x}{v}\\right)\\right] = \\frac{S_0}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right)\n$$\nWe integrate both sides with respect to $x$ to find the general solution:\n$$\n\\int \\frac{d}{dx}\\left[f(x) \\exp\\left(\\frac{\\alpha x}{v}\\right)\\right] dx = \\int \\frac{S_0}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right) dx\n$$\n$$\nf(x) \\exp\\left(\\frac{\\alpha x}{v}\\right) = \\frac{S_0}{v} \\left(\\frac{v}{\\alpha}\\right) \\exp\\left(\\frac{\\alpha x}{v}\\right) + C\n$$\nwhere $C$ is the constant of integration. Simplifying this expression gives:\n$$\nf(x) \\exp\\left(\\frac{\\alpha x}{v}\\right) = \\frac{S_0}{\\alpha} \\exp\\left(\\frac{\\alpha x}{v}\\right) + C\n$$\nTo obtain $f(x)$, we multiply by $\\exp\\left(-\\frac{\\alpha x}{v}\\right)$:\n$$\nf(x) = \\frac{S_0}{\\alpha} + C \\exp\\left(-\\frac{\\alpha x}{v}\\right)\n$$\nThis is the general solution to the ODE. The constant $C$ is determined by the inflow boundary condition $f(0) = f_{\\mathrm{in}}$. We evaluate the general solution at $x=0$:\n$$\nf(0) = \\frac{S_0}{\\alpha} + C \\exp(0) = \\frac{S_0}{\\alpha} + C\n$$\nSetting this equal to the given boundary value $f_{\\mathrm{in}}$:\n$$\nf_{\\mathrm{in}} = \\frac{S_0}{\\alpha} + C\n$$\nSolving for $C$:\n$$\nC = f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\n$$\nSubstituting this expression for $C$ back into the general solution gives the unique, particular solution for $f(x)$:\n$$\nf(x) = \\frac{S_0}{\\alpha} + \\left(f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\\right) \\exp\\left(-\\frac{\\alpha x}{v}\\right)\n$$\nThis is the final analytic solution.\n\nFinally, we verify that the solution is physically admissible.\nFirst, we check the boundary condition at $x=0$:\n$$\nf(0) = \\frac{S_0}{\\alpha} + \\left(f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\\right) \\exp(0) = \\frac{S_0}{\\alpha} + f_{\\mathrm{in}} - \\frac{S_0}{\\alpha} = f_{\\mathrm{in}}\n$$\nThe inflow boundary condition is satisfied.\n\nSecond, we check for non-negativity, $f(x) \\ge 0$, for all $x \\in [0, L]$, given the constraints $S_0 \\ge 0$, $f_{\\mathrm{in}} \\ge 0$, $\\alpha > 0$, and $v > 0$. We can rewrite the solution as:\n$$\nf(x) = \\frac{S_0}{\\alpha} \\left(1 - \\exp\\left(-\\frac{\\alpha x}{v}\\right)\\right) + f_{\\mathrm{in}} \\exp\\left(-\\frac{\\alpha x}{v}\\right)\n$$\nFor $x \\ge 0$, we have $\\frac{\\alpha x}{v} \\ge 0$. Therefore, $0 < \\exp\\left(-\\frac{\\alpha x}{v}\\right) \\le 1$.\nThe term $\\left(1 - \\exp\\left(-\\frac{\\alpha x}{v}\\right)\\right)$ is thus bounded between $0$ (at $x=0$) and $1$ (as $x \\to \\infty$), so it is always non-negative.\nSince $S_0 \\ge 0$ and $\\alpha > 0$, the first term $\\frac{S_0}{\\alpha} \\left(1 - \\exp\\left(-\\frac{\\alpha x}{v}\\right)\\right)$ is non-negative.\nSince $f_{\\mathrm{in}} \\ge 0$ and $\\exp\\left(-\\frac{\\alpha x}{v}\\right) > 0$, the second term $f_{\\mathrm{in}} \\exp\\left(-\\frac{\\alpha x}{v}\\right)$ is also non-negative.\nThe sum of two non-negative terms is non-negative, so $f(x) \\ge 0$ for all $x \\ge 0$. The solution is physically admissible and bounded on the domain $[0,L]$.\nThe solution represents a balance: the distribution function starts at $f_{\\mathrm{in}}$ and evolves over the length scale $v/\\alpha$ towards an equilibrium value $S_0/\\alpha$, which is the value that would balance the source and sink locally ($S_0 - \\alpha f = 0$).",
            "answer": "$$\n\\boxed{\\frac{S_0}{\\alpha} + \\left(f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\\right) \\exp\\left(-\\frac{\\alpha x}{v}\\right)}\n$$"
        },
        {
            "introduction": "Numerical schemes must not only be accurate but also respect fundamental physical constraints, such as the non-negativity of a distribution function. This practice challenges you to design and implement a positivity-preserving limiter for a discretized source and sink update . Developing this essential numerical tool is a crucial hands-on step toward creating stable and physically meaningful simulations, preventing the emergence of unphysical negative particle densities.",
            "id": "4196640",
            "problem": "You are modeling the single-step update due to sources and linear sinks in a full distribution function (full-f) simulation of a fusion plasma. Consider a single phase-space point with nonnegative distribution value $f^n \\ge 0$ at discrete time index $n$. Over a time step of size $\\Delta t$, the effect of a source term $S$ (which can be positive or negative) and a linear sink with coefficient $\\alpha \\ge 0$ is modeled by the explicit forward-Euler update\n$$\nf^{n+1} \\;=\\; f^n \\;+\\; \\Delta t\\,\\big(S \\;-\\; \\alpha f^n\\big)\n\\;=\\; \\big(1 - \\alpha \\Delta t\\big)\\,f^n \\;+\\; \\Delta t\\,S.\n$$\nAll quantities are dimensionless. In the context of operator splitting, you will implement a local, pointwise positivity-preserving limiter that modifies only the source amplitude before it is applied, such that $f^{n+1} \\ge 0$ whenever $f^n \\ge 0$. The limiter must be designed using first principles and must not rely on nonphysical adjustments to $f^n$ or $\\alpha$. Assume that the linear sink Courant number satisfies $0 \\le \\alpha \\Delta t \\le 1$.\n\nYour tasks are:\n1) From first principles, derive a sufficient condition (expressed as a bound on the effective source amplitude) that guarantees $f^{n+1} \\ge 0$ given $f^n \\ge 0$ and $0 \\le \\alpha \\Delta t \\le 1$. Your derivation must start from the explicit forward-Euler formula above and must not assume any unenforced constraint on $S$ beyond what you design as a limiter. Explain why this condition is mathematically sufficient to ensure $f^{n+1} \\ge 0$.\n2) Design a local limiter that enforces your derived condition by modifying only the source amplitude $S$ before updating $f$. The limiter must act pointwise, must not increase $S$ if $S$ already satisfies the bound, and must minimally modify $S$ in the sense of the smallest change necessary to satisfy the condition. Prove that your limiter satisfies the condition from part 1) for any $f^n \\ge 0$ and $0 \\le \\alpha \\Delta t \\le 1$.\n3) Implement a program that:\n   - Defines a function that takes $(f^n,\\alpha,\\Delta t,S)$ and returns the updated value $f^{n+1}$ using your limiter.\n   - Applies this function to a test suite of parameter sets and produces a single-line output containing the list of resulting $f^{n+1}$ values, each rounded to six decimal places.\n\nUse the following test suite, which exercises a representative \"happy path\" case, boundary cases, and significant edge cases. All quantities are dimensionless and satisfy $0 \\le \\alpha \\Delta t \\le 1$:\n- Test A: $f^n = 1.0$, $\\alpha = 0.3$, $\\Delta t = 1.0$, $S = -0.5$.\n- Test B: $f^n = 0.2$, $\\alpha = 0.2$, $\\Delta t = 1.0$, $S = -0.16$.\n- Test C: $f^n = 0.1$, $\\alpha = 0.4$, $\\Delta t = 1.0$, $S = -0.3$.\n- Test D: $f^n = 5.0$, $\\alpha = 1.0$, $\\Delta t = 1.0$, $S = -1.0$.\n- Test E: $f^n = 0.0$, $\\alpha = 0.6$, $\\Delta t = 1.0$, $S = -10.0$.\n- Test F: $f^n = 0.7$, $\\alpha = 0.5$, $\\Delta t = 0.5$, $S = 0.4$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[x,y,z]\"), with each $f^{n+1}$ rounded to six decimal places.",
            "solution": "The problem requires the derivation, design, and implementation of a positivity-preserving limiter for a forward-Euler update of a distribution function, $f$. The update models the effect of a source, $S$, and a linear sink, $\\alpha$, over a time step, $\\Delta t$.\n\nThe governing equation for the update is:\n$$f^{n+1} = f^n + \\Delta t (S - \\alpha f^n) = (1 - \\alpha \\Delta t) f^n + \\Delta t S$$\nThe following conditions are given: the initial distribution function value is non-negative, $f^n \\ge 0$; the sink coefficient is non-negative, $\\alpha \\ge 0$; and the linear sink Courant number satisfies $0 \\le \\alpha \\Delta t \\le 1$. The task is to ensure the updated value is also non-negative, $f^{n+1} \\ge 0$, by modifying only the source amplitude $S$. We will assume a non-zero time step, $\\Delta t > 0$, as a zero time step implies no evolution.\n\nFirst, we derive a sufficient condition on $S$ that guarantees $f^{n+1} \\ge 0$. The requirement is:\n$$f^{n+1} \\ge 0$$\nSubstituting the update formula, we get:\n$$(1 - \\alpha \\Delta t) f^n + \\Delta t S \\ge 0$$\nLet's analyze the first term, $(1 - \\alpha \\Delta t) f^n$. The problem statement provides two crucial constraints: $f^n \\ge 0$ and $0 \\le \\alpha \\Delta t \\le 1$. The second constraint implies that the factor $(1 - \\alpha \\Delta t)$ is bounded between $0$ and $1$:\n$$0 \\le \\alpha \\Delta t \\le 1 \\implies -1 \\le -\\alpha \\Delta t \\le 0 \\implies 0 \\le 1 - \\alpha \\Delta t \\le 1$$\nSince both $(1 - \\alpha \\Delta t)$ and $f^n$ are non-negative, their product is also non-negative:\n$$(1 - \\alpha \\Delta t) f^n \\ge 0$$\nTo satisfy the inequality for $f^{n+1}$, we can now establish a bound on the source term $S$. We rearrange the inequality:\n$$\\Delta t S \\ge - (1 - \\alpha \\Delta t) f^n$$\nSince we assume $\\Delta t > 0$, we can divide by $\\Delta t$ without altering the direction of the inequality, yielding the sufficient condition on $S$:\n$$S \\ge - \\frac{(1 - \\alpha \\Delta t) f^n}{\\Delta t}$$\nIf the source amplitude $S$ respects this lower bound, then $f^{n+1}$ is guaranteed to be non-negative. This follows directly by reversing the steps of this derivation.\n\nSecond, we design a limiter that enforces this condition. The limiter must modify the source term $S$ to a new value, $S_{\\text{lim}}$, that always satisfies the derived bound. We define the minimum allowed source amplitude as $S_{\\text{min}}$:\n$$S_{\\text{min}} = - \\frac{(1 - \\alpha \\Delta t) f^n}{\\Delta t}$$\nThe required condition is thus $S \\ge S_{\\text{min}}$. The limiter must not change $S$ if it already satisfies this condition, and must minimally adjust $S$ if it does not. The unique mathematical operation that achieves this is the maximum function. We define the limited source as:\n$$S_{\\text{lim}} = \\max(S, S_{\\text{min}})$$\nThis limiter correctly satisfies the design requirements. If $S \\ge S_{\\text{min}}$, then $S_{\\text{lim}} = S$, and the source is not modified. If $S < S_{\\text{min}}$, then $S_{\\text{lim}} = S_{\\text{min}}$, which is the smallest possible modification to $S$ to satisfy the positivity condition. With this limited source, the update equation becomes:\n$$f^{n+1} = (1 - \\alpha \\Delta t) f^n + \\Delta t S_{\\text{lim}}$$\nBy the definition of our limiter, we have $S_{\\text{lim}} \\ge S_{\\text{min}}$ for any value of $S$. Substituting this into the update formula guarantees that the condition for non-negativity is met, and thus $f^{n+1} \\ge 0$.\n\nThird, we outline the algorithm for implementation. A function will take $(f^n, \\alpha, \\Delta t, S)$ as input. Assuming $\\Delta t > 0$, the function will:\n$1$. Calculate the minimum source value, $S_{\\text{min}} = - \\frac{(1 - \\alpha \\Delta t) f^n}{\\Delta t}$.\n$2$. Compute the limited source, $S_{\\text{lim}} = \\max(S, S_{\\text{min}})$.\n$3$. Calculate the new distribution function value, $f^{n+1} = (1 - \\alpha \\Delta t)f^n + \\Delta t S_{\\text{lim}}$.\n$4$. Return $f^{n+1}$.\nThis procedure is applied to each of the test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of applying a positivity-preserving limiter to a\n    forward-Euler update of a distribution function.\n    \"\"\"\n    # Test cases from the problem statement.\n    # Each tuple is (f^n, alpha, Delta_t, S)\n    test_cases = [\n        (1.0, 0.3, 1.0, -0.5),   # Test A\n        (0.2, 0.2, 1.0, -0.16),  # Test B\n        (0.1, 0.4, 1.0, -0.3),   # Test C\n        (5.0, 1.0, 1.0, -1.0),   # Test D\n        (0.0, 0.6, 1.0, -10.0),  # Test E\n        (0.7, 0.5, 0.5, 0.4),    # Test F\n    ]\n\n    def update_with_limiter(f_n: float, alpha: float, dt: float, S: float) -> float:\n        \"\"\"\n        Calculates the updated distribution function f^{n+1} using the\n        derived positivity-preserving limiter for the source term.\n        \n        Args:\n            f_n: Distribution function value at time n.\n            alpha: Linear sink coefficient.\n            dt: Time step size.\n            S: Source amplitude.\n            \n        Returns:\n            The updated distribution value f^{n+1}, guaranteed to be non-negative.\n        \"\"\"\n        if dt == 0.0:\n            # If time step is zero, no change occurs.\n            return f_n\n\n        alpha_dt = alpha * dt\n        \n        # Calculate the minimum allowed source term to ensure positivity.\n        # S_min = - (1 - alpha*dt) * f_n / dt\n        s_min = - (1.0 - alpha_dt) * f_n / dt\n        \n        # Apply the limiter: take the maximum of the original source and the minimum allowed value.\n        s_lim = np.maximum(S, s_min)\n        \n        # Calculate f^{n+1} using the limited source term.\n        # f^{n+1} = (1 - alpha*dt) * f_n + dt * S_lim\n        f_next = (1.0 - alpha_dt) * f_n + dt * s_lim\n        \n        return f_next\n\n    results = []\n    for case in test_cases:\n        f_n, alpha, dt, S = case\n        f_next = update_with_limiter(f_n, alpha, dt, S)\n        results.append(f_next)\n\n    # Format the results to six decimal places as specified.\n    formatted_results = [f'{r:.6f}' for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While local properties like positivity are critical, the global fidelity of a simulation hinges on its ability to conserve physical quantities like particle number. This problem guides you through the design of a conservative finite-volume scheme where source deposition is handled with mathematical rigor to guarantee that the total number of particles added matches the prescribed rate . This exercise demonstrates how to construct a numerical framework that upholds a fundamental conservation law, ensuring the long-term accuracy of the simulation.",
            "id": "4196662",
            "problem": "Consider a one-dimensional slab plasma of length $L$ and unit cross-sectional area $A=1\\,\\mathrm{m}^2$. In a full-distribution-function (full-f) approach, let $f(x,t)$ denote the particle number density with units $\\mathrm{m}^{-3}$. The evolution of $f$ in the presence of advection, volumetric sources, and linear sinks is governed by the conservation law\n$$\n\\frac{\\partial f}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u f\\right) = S(x) - \\nu f,\n$$\nwhere $u$ is the constant advection speed (units $\\mathrm{m/s}$), $S(x)$ is a prescribed volumetric source rate density (units $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$), and $\\nu$ is a linear sink rate (units $\\mathrm{s}^{-1}$).\n\nDiscretize the spatial domain $[0,L]$ into $N$ uniform finite-volume cells of width $\\Delta x = L/N$. Let the $i$-th cell be $C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ with $x_{i-\\frac{1}{2}} = i\\,\\Delta x$ and $x_{i+\\frac{1}{2}} = (i+1)\\,\\Delta x$, and define the cell-averaged density $f_i^n = \\frac{1}{\\Delta x} \\int_{C_i} f(x,t^n)\\,dx$ at time $t^n$. The finite-volume discrete update over one explicit time step of size $\\Delta t$ is obtained by integrating the conservation law over a control volume $C_i$ and applying the divergence theorem to the flux term. The face fluxes should be upwinded according to the sign of $u$, and the source deposition must guarantee conservation in the sense that the cell-integrated source equals the prescribed volumetric rate integrated over the cell:\n$$\n\\int_{C_i} S(x)\\,dx = \\bar{S}_i\\,\\Delta x,\n$$\nwhere $\\bar{S}_i$ is the discrete cell-averaged source used in the update. The linear sink is treated explicitly.\n\nYour tasks are:\n- Starting from the conservation law, derive the explicit, conservative finite-volume update for $f_i^{n+1}$ in terms of the upwind numerical fluxes at cell faces, the cell-averaged source $\\bar{S}_i$, and the sink $\\nu$.\n- Design a source deposition scheme that, for a prescribed analytic $S(x)$, computes $\\bar{S}_i$ exactly as the cell average $\\bar{S}_i = \\frac{1}{\\Delta x}\\int_{C_i} S(x)\\,dx$. In particular, take $S(x)$ to be a sum of Gaussian profiles\n$$\nS(x) = \\sum_{k=1}^{K} A_k \\exp\\!\\left(-\\frac{(x-\\mu_k)^2}{2\\sigma_k^2}\\right),\n$$\nwith amplitudes $A_k$ (units $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$), centers $\\mu_k$ (units $\\mathrm{m}$), and widths $\\sigma_k$ (units $\\mathrm{m}$). Use analytic integration of the Gaussian over each cell to guarantee that $\\sum_i \\bar{S}_i\\,\\Delta x = \\int_0^L S(x)\\,dx$.\n- Assume periodic boundary conditions for the advection flux.\n\nImplement a single-step update from $t^n$ to $t^{n+1}$ using the derived discrete scheme. For each test case, compute the following two diagnostics:\n1. The absolute conservation error of the discrete source deposition,\n$$\nE_S = \\left| \\sum_{i=0}^{N-1} \\bar{S}_i\\,\\Delta x - \\int_0^L S(x)\\,dx \\right|,\n$$\nexpressed in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n2. The absolute global conservation error of the one-step finite-volume update (with periodic advection flux),\n$$\nE_{\\text{cons}} = \\left| \\frac{\\sum_{i=0}^{N-1} \\left( f_i^{n+1} - f_i^{n} \\right)\\,\\Delta x}{\\Delta t} - \\left( \\sum_{i=0}^{N-1} \\bar{S}_i\\,\\Delta x - \\sum_{i=0}^{N-1} \\nu\\, f_i^{n}\\,\\Delta x \\right) \\right|,\n$$\nexpressed in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nUse the upwind numerical fluxes for the advection term:\n- If $u > 0$, then the flux through face $x_{i+\\frac{1}{2}}$ is $F_{i+\\frac{1}{2}}^n = u\\, f_i^n$.\n- If $u < 0$, then the flux through face $x_{i+\\frac{1}{2}}^n$ is $F_{i+\\frac{1}{2}}^n = u\\, f_{i+1}^n$.\nPeriodic boundary conditions imply that $f_{N}^n \\equiv f_0^n$ and $f_{-1}^n \\equiv f_{N-1}^n$ when evaluating face fluxes.\n\nAnalytic integration of each Gaussian over an interval $[a,b]$ is given by\n$$\n\\int_a^b A\\,\\exp\\!\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)\\,dx\n=\nA\\,\\sqrt{\\frac{\\pi}{2}}\\,\\sigma \\left[\n\\operatorname{erf}\\!\\left(\\frac{b-\\mu}{\\sqrt{2}\\,\\sigma}\\right)\n-\n\\operatorname{erf}\\!\\left(\\frac{a-\\mu}{\\sqrt{2}\\,\\sigma}\\right)\n\\right],\n$$\nwhere $\\operatorname{erf}$ is the error function.\n\nInitial condition for all test cases: $f_i^{n} = f_0$ constant for all cells.\n\nTest suite specification:\n- Test case $1$ (happy path):\n    - $L = 1.0\\,\\mathrm{m}$, $N = 64$, $\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$, $u = 100.0\\,\\mathrm{m/s}$, $\\nu = 10.0\\,\\mathrm{s}^{-1}$, $f_0 = 2.0\\times 10^{5}\\,\\mathrm{m}^{-3}$,\n    - Sources: $K=2$ with $(A_1,\\mu_1,\\sigma_1) = (1.0\\times 10^{6}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1},\\,0.3\\,\\mathrm{m},\\,0.05\\,\\mathrm{m})$, $(A_2,\\mu_2,\\sigma_2) = (2.0\\times 10^{6}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1},\\,0.7\\,\\mathrm{m},\\,0.08\\,\\mathrm{m})$.\n- Test case $2$ (boundary-centered sources, negative advection):\n    - $L = 1.0\\,\\mathrm{m}$, $N = 64$, $\\Delta t = 2.0\\times 10^{-3}\\,\\mathrm{s}$, $u = -50.0\\,\\mathrm{m/s}$, $\\nu = 0.0\\,\\mathrm{s}^{-1}$, $f_0 = 2.0\\times 10^{5}\\,\\mathrm{m}^{-3}$,\n    - Sources: $K=2$ with $(A_1,\\mu_1,\\sigma_1) = (5.0\\times 10^{5}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1},\\,0.02\\,\\mathrm{m},\\,0.03\\,\\mathrm{m})$, $(A_2,\\mu_2,\\sigma_2) = (1.0\\times 10^{6}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1},\\,0.98\\,\\mathrm{m},\\,0.03\\,\\mathrm{m})$.\n- Test case $3$ (narrow source, zero advection, strong sink):\n    - $L = 1.0\\,\\mathrm{m}$, $N = 128$, $\\Delta t = 5.0\\times 10^{-4}\\,\\mathrm{s}$, $u = 0.0\\,\\mathrm{m/s}$, $\\nu = 20.0\\,\\mathrm{s}^{-1}$, $f_0 = 2.0\\times 10^{5}\\,\\mathrm{m}^{-3}$,\n    - Sources: $K=1$ with $(A_1,\\mu_1,\\sigma_1) = (1.0\\times 10^{9}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1},\\,0.5\\,\\mathrm{m},\\,1.0\\times 10^{-4}\\,\\mathrm{m})$.\n\nYour program must:\n- Compute $\\bar{S}_i$ via exact Gaussian integration over each cell.\n- Perform one explicit upwind finite-volume update from $t^n$ to $t^{n+1}$.\n- Compute and return $E_S$ and $E_{\\text{cons}}$ for each test case, expressed in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, with one inner list per test case in the order given above, where each inner list is $[E_S,E_{\\text{cons}}]$. For example, the format must be like $[[e_{1,1},e_{1,2}],[e_{2,1},e_{2,2}],[e_{3,1},e_{3,2}]]$ (with actual numeric values in place of symbols).",
            "solution": "The user has requested the derivation and implementation of a conservative finite-volume scheme for a one-dimensional advection-reaction-source equation. The problem is scientifically sound, well-posed, and provides all necessary information for a unique solution.\n\n### Step 1: Derivation of the Finite-Volume Update Scheme\n\nThe governing partial differential equation is the conservation law:\n$$\n\\frac{\\partial f}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u f\\right) = S(x) - \\nu f\n$$\nHere, $f(x,t)$ is the particle number density, $u$ is a constant advection speed, $S(x)$ is a volumetric source rate, and $\\nu$ is a linear sink rate.\n\nWe discretize the spatial domain $[0, L]$ into $N$ finite-volume cells, $C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ for $i=0, 1, \\dots, N-1$. The problem defines the cell boundaries as $x_{i-\\frac{1}{2}} = i\\,\\Delta x$ and $x_{i+\\frac{1}{2}} = (i+1)\\,\\Delta x$, where $\\Delta x = L/N$.\n\nTo derive the discrete update rule, we integrate the PDE over a generic cell $C_i$:\n$$\n\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\frac{\\partial f}{\\partial t} \\,dx + \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\frac{\\partial}{\\partial x}(u f) \\,dx = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} S(x) \\,dx - \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\nu f \\,dx\n$$\n\nWe evaluate each term. The cell-averaged density is defined as $f_i(t) = \\frac{1}{\\Delta x} \\int_{C_i} f(x,t)\\,dx$.\n1.  **Time Derivative Term**: Assuming the order of integration can be swapped:\n    $$\n    \\int_{C_i} \\frac{\\partial f}{\\partial t} \\,dx = \\frac{d}{dt} \\int_{C_i} f(x,t) \\,dx = \\frac{d}{dt} (f_i(t)\\,\\Delta x) = \\Delta x \\frac{df_i}{dt}\n    $$\n2.  **Advection (Flux) Term**: Using the fundamental theorem of calculus (divergence theorem in 1D):\n    $$\n    \\int_{C_i} \\frac{\\partial}{\\partial x}(u f) \\,dx = [u f]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} = (uf)\\big|_{x_{i+\\frac{1}{2}}} - (uf)\\big|_{x_{i-\\frac{1}{2}}}\n    $$\n    We define the numerical flux at the cell faces as $F_{i+\\frac{1}{2}}$ and $F_{i-\\frac{1}{2}}$. The term becomes $F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}$.\n3.  **Source Term**: The problem requires this to be the exact cell-integrated source, which we denote $\\bar{S}_i \\Delta x$:\n    $$\n    \\int_{C_i} S(x) \\,dx = \\bar{S}_i \\Delta x, \\quad \\text{where} \\quad \\bar{S}_i = \\frac{1}{\\Delta x} \\int_{C_i} S(x) \\,dx\n    $$\n4.  **Sink Term**: We approximate the integral using the cell-averaged density:\n    $$\n    \\int_{C_i} \\nu f \\,dx \\approx \\nu \\left( \\int_{C_i} f \\,dx \\right) = \\nu f_i \\Delta x\n    $$\n\nCombining these terms gives the semi-discrete ordinary differential equation for each cell average $f_i$:\n$$\n\\Delta x \\frac{df_i}{dt} = - \\left( F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} \\right) + \\bar{S}_i \\Delta x - \\nu f_i \\Delta x\n$$\nDividing by $\\Delta x$:\n$$\n\\frac{df_i}{dt} = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} + \\bar{S}_i - \\nu f_i\n$$\nWe apply an explicit (forward Euler) time-stepping scheme with step size $\\Delta t$. Let $f_i^n$ be the approximation of $f_i(t^n)$. The time derivative is approximated as $\\frac{df_i}{dt} \\approx \\frac{f_i^{n+1} - f_i^n}{\\Delta t}$. The terms on the right-hand side are evaluated at time $t^n$.\n$$\n\\frac{f_i^{n+1} - f_i^n}{\\Delta t} = -\\frac{F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n}{\\Delta x} + \\bar{S}_i - \\nu f_i^n\n$$\nRearranging for $f_i^{n+1}$, we obtain the final fully discrete update rule:\n$$\nf_i^{n+1} = f_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n \\right) + \\Delta t \\bar{S}_i - \\Delta t \\nu f_i^n\n$$\nThis can be regrouped as:\n$$\nf_i^{n+1} = f_i^n(1 - \\nu \\Delta t) - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n \\right) + \\Delta t \\bar{S}_i\n$$\n\n### Step 2: Upwind Flux and Periodic Boundary Conditions\n\nThe numerical flux $F_{i+\\frac{1}{2}}^n$ at the interface between cell $C_i$ and $C_{i+1}$ is determined by the upwind scheme, which depends on the sign of the advection speed $u$:\n-   If $u > 0$, information propagates from left to right. The flux depends on the state in the upwind cell, $C_i$:\n    $$F_{i+\\frac{1}{2}}^n = u f_i^n$$\n-   If $u < 0$, information propagates from right to left. The flux depends on the state in the upwind cell, $C_{i+1}$:\n    $$F_{i+\\frac{1}{2}}^n = u f_{i+1}^n$$\n-   If $u = 0$, the flux is zero: $F_{i+\\frac{1}{2}}^n = 0$.\n\nPeriodic boundary conditions require that $f_N^n \\equiv f_0^n$ and $f_{-1}^n \\equiv f_{N-1}^n$. These conditions are used when evaluating fluxes at the domain boundaries, i.e., for $F_{-1/2}^n$ (left of cell $0$) and $F_{N-1/2}^n$ (left of cell $N-1$, used to compute flux at right of cell $N-1$).\n\n### Step 3: Source Deposition Scheme\n\nThe source term $S(x)$ is a sum of $K$ Gaussian functions:\n$$\nS(x) = \\sum_{k=1}^{K} A_k \\exp\\!\\left(-\\frac{(x-\\mu_k)^2}{2\\sigma_k^2}\\right)\n$$\nThe cell-averaged source $\\bar{S}_i$ is computed by analytically integrating $S(x)$ over the cell $C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$:\n$$\n\\bar{S}_i = \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} S(x)\\,dx = \\frac{1}{\\Delta x} \\sum_{k=1}^{K} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} A_k \\exp\\!\\left(-\\frac{(x-\\mu_k)^2}{2\\sigma_k^2}\\right)\\,dx\n$$\nUsing the provided formula for the integral of a Gaussian, each term in the sum is:\n$$\n\\int_{a}^{b} A_k e^{-\\frac{(x-\\mu_k)^2}{2\\sigma_k^2}}\\,dx = A_k \\sigma_k \\sqrt{\\frac{\\pi}{2}} \\left[ \\operatorname{erf}\\left(\\frac{b-\\mu_k}{\\sqrt{2}\\sigma_k}\\right) - \\operatorname{erf}\\left(\\frac{a-\\mu_k}{\\sqrt{2}\\sigma_k}\\right) \\right]\n$$\nwith $a = x_{i-\\frac{1}{2}}$ and $b = x_{i+\\frac{1}{2}}$. This method ensures that the total discrete source strength, $\\sum_{i=0}^{N-1} \\bar{S}_i \\Delta x$, is exactly equal to the total analytical source strength, $\\int_0^L S(x)\\,dx$, up to floating-point precision.\n\n### Step 4: Calculation of Diagnostics\n\nThe solution requires computing two error metrics after one time step.\n\n1.  **Source Conservation Error, $E_S$**: This metric quantifies the difference between the sum of the locally integrated discrete sources and the globally integrated analytical source.\n    $$\n    E_S = \\left| \\sum_{i=0}^{N-1} \\bar{S}_i \\Delta x - \\int_0^L S(x)\\,dx \\right|\n    $$\n    where $\\int_0^L S(x)\\,dx$ is calculated by applying the same analytic integration formula for each Gaussian over the full domain $[0, L]$. Due to the conservative nature of our source deposition, this error is expected to be near machine precision.\n\n2.  **Global Conservation Error, $E_{\\text{cons}}$**: This metric verifies that the discrete update globally conserves particle number according to the sources and sinks.\n    $$\n    E_{\\text{cons}} = \\left| \\frac{\\sum_{i=0}^{N-1} \\left( f_i^{n+1} - f_i^{n} \\right)\\,\\Delta x}{\\Delta t} - \\left( \\sum_{i=0}^{N-1} \\bar{S}_i\\,\\Delta x - \\sum_{i=0}^{N-1} \\nu\\, f_i^{n}\\,\\Delta x \\right) \\right|\n    $$\n    To analyze this, we sum the discrete update rule over all cells $i=0, \\dots, N-1$:\n    $$\n    \\sum_{i=0}^{N-1} \\frac{f_i^{n+1} - f_i^n}{\\Delta t} \\Delta x = - \\sum_{i=0}^{N-1} (F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n) + \\sum_{i=0}^{N-1} \\bar{S}_i \\Delta x - \\sum_{i=0}^{N-1} \\nu f_i^n \\Delta x\n    $$\n    The flux sum is a telescoping sum: $\\sum_{i=0}^{N-1} (F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n) = F_{N-\\frac{1}{2}}^n - F_{-\\frac{1}{2}}^n$. Due to periodic boundary conditions ($f_{-1} \\equiv f_{N-1}$ and $f_N \\equiv f_0$), the flux out of the last cell equals the flux into the first cell (i.e., $F_{N-\\frac{1}{2}}^n = F_{-\\frac{1}{2}}^n$ if we use consistent indexing, or more simply, the net flux across the periodic boundary is zero). For instance, if $u > 0$, the flux difference is $u f_{N-1}^n - u f_{-1}^n = u f_{N-1}^n - u f_{N-1}^n = 0$. If $u < 0$, it is $u f_N^n - u f_0^n = u f_0^n - u f_0^n = 0$. Thus, the total contribution from the advection term is zero. The global conservation law simplifies to:\n    $$\n    \\frac{\\sum \\Delta x (f_i^{n+1} - f_i^n)}{\\Delta t} = \\sum \\bar{S}_i \\Delta x - \\sum \\nu f_i^n \\Delta x\n    $$\n    Therefore, $E_{\\text{cons}}$ should be zero up to floating-point representation errors, confirming the conservative property of the overall numerical scheme.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (happy path)\n        {\n            \"L\": 1.0, \"N\": 64, \"dt\": 1.0e-3, \"u\": 100.0, \"nu\": 10.0,\n            \"f0\": 2.0e5,\n            \"sources\": [\n                {\"A\": 1.0e6, \"mu\": 0.3, \"sigma\": 0.05},\n                {\"A\": 2.0e6, \"mu\": 0.7, \"sigma\": 0.08},\n            ]\n        },\n        # Test case 2 (boundary-centered sources, negative advection)\n        {\n            \"L\": 1.0, \"N\": 64, \"dt\": 2.0e-3, \"u\": -50.0, \"nu\": 0.0,\n            \"f0\": 2.0e5,\n            \"sources\": [\n                {\"A\": 5.0e5, \"mu\": 0.02, \"sigma\": 0.03},\n                {\"A\": 1.0e6, \"mu\": 0.98, \"sigma\": 0.03},\n            ]\n        },\n        # Test case 3 (narrow source, zero advection, strong sink)\n        {\n            \"L\": 1.0, \"N\": 128, \"dt\": 5.0e-4, \"u\": 0.0, \"nu\": 20.0,\n            \"f0\": 2.0e5,\n            \"sources\": [\n                {\"A\": 1.0e9, \"mu\": 0.5, \"sigma\": 1.0e-4},\n            ]\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation_step(**params)\n        results.append(result)\n\n    # Format the final output string exactly as required.\n    output_str = \"[\" + \",\".join([f\"[{e_s},{e_cons}]\" for e_s, e_cons in results]) + \"]\"\n    print(output_str)\n\ndef run_simulation_step(L, N, dt, u, nu, f0, sources):\n    \"\"\"\n    Performs a single time step of the finite-volume simulation and computes diagnostics.\n    \n    Args:\n        L (float): Length of the domain.\n        N (int): Number of cells.\n        dt (float): Time step size.\n        u (float): Advection speed.\n        nu (float): Sink rate.\n        f0 (float): Initial density.\n        sources (list): List of dicts, each specifying a Gaussian source.\n\n    Returns:\n        tuple: A tuple containing (E_S, E_cons).\n    \"\"\"\n    dx = L / N\n    \n    # Cell face coordinates. x_faces[i] is the left boundary of cell i.\n    x_faces = np.linspace(0.0, L, N + 1)\n    \n    # Initial condition: f^n\n    f_n = np.full(N, f0, dtype=np.float64)\n\n    # --- Step 1: Compute cell-averaged source S_bar ---\n    \n    s_bar = np.zeros(N, dtype=np.float64)\n    sqrt2 = np.sqrt(2.0)\n    sqrt_pi_over_2 = np.sqrt(np.pi / 2.0)\n\n    # Helper function for Gaussian integral\n    def gaussian_integral(a, b, A, mu, sigma):\n        # Integral of A * exp(-(x-mu)^2 / (2*sigma^2)) from a to b\n        # Avoid division by zero if sigma is extremely small\n        if sigma <= 0:\n            return 0.0\n        z_a = (a - mu) / (sqrt2 * sigma)\n        z_b = (b - mu) / (sqrt2 * sigma)\n        integral = A * sigma * sqrt_pi_over_2 * (erf(z_b) - erf(z_a))\n        return integral\n\n    # Calculate cell-averaged source by integrating over each cell\n    for k in range(N):\n        a, b = x_faces[k], x_faces[k+1]\n        cell_integral = 0.0\n        for src in sources:\n            cell_integral += gaussian_integral(a, b, src[\"A\"], src[\"mu\"], src[\"sigma\"])\n        s_bar[k] = cell_integral / dx\n\n    # --- Step 2: Perform one finite-volume update step ---\n\n    # Compute flux difference term using upwinding and periodic BCs\n    flux_diff = np.zeros(N, dtype=np.float64)\n    if u > 0:\n        # F_{i+1/2} = u*f_i, F_{i-1/2} = u*f_{i-1}\n        # Difference = u * (f_i - f_{i-1})\n        f_im1 = np.roll(f_n, 1)  # f_{i-1} for each i, with periodicity\n        flux_diff = u * (f_n - f_im1)\n    elif u < 0:\n        # F_{i+1/2} = u*f_{i+1}, F_{i-1/2} = u*f_i\n        # Difference = u * (f_{i+1} - f_i)\n        f_ip1 = np.roll(f_n, -1) # f_{i+1} for each i, with periodicity\n        flux_diff = u * (f_ip1 - f_n)\n    # If u == 0, flux_diff remains zero, which is correct.\n    \n    # Full discrete update equation for f^{n+1}\n    f_np1 = f_n * (1.0 - nu * dt) - (dt / dx) * flux_diff + dt * s_bar\n\n    # --- Step 3: Compute diagnostics ---\n\n    # 1. Source conservation error E_S\n    total_discrete_source = np.sum(s_bar * dx)\n    total_analytic_source = 0.0\n    for src in sources:\n        total_analytic_source += gaussian_integral(0.0, L, src[\"A\"], src[\"mu\"], src[\"sigma\"])\n    \n    e_s = np.abs(total_discrete_source - total_analytic_source)\n\n    # 2. Global conservation error E_cons\n    # LHS: Time rate of change of total particle number\n    change_in_total_f = np.sum((f_np1 - f_n) * dx)\n    lhs = change_in_total_f / dt\n\n    # RHS: Total source rate minus total sink rate\n    total_source_rate = np.sum(s_bar * dx)\n    total_sink_rate = np.sum(nu * f_n * dx)\n    rhs = total_source_rate - total_sink_rate\n    \n    e_cons = np.abs(lhs - rhs)\n\n    return e_s, e_cons\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}