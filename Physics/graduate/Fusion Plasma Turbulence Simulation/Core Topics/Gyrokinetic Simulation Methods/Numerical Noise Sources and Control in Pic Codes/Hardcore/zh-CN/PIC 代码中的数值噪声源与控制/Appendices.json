{
    "hands_on_practices": [
        {
            "introduction": "在粒子模拟（PIC）中，一个核心挑战是确保物理信号不被数值霰弹噪声所淹没。这个练习提供了一个具体的方法，用于确定每个单元所需的最少粒子数 $N_p$，以针对一个特定的物理模式（例如漂移波）达到期望的信噪比 。通过完成这个练习，你将学会如何将抽象的噪声理论与模拟设计中的关键实践决策联系起来。",
            "id": "4197543",
            "problem": "考虑一个用于研究漂移波湍流的静电粒子云网格（PIC）模拟，模拟对象为均匀、单次电离的磁化板状等离子体。电子由宏粒子表示；离子提供一个均匀固定的中性化背景。区域是双周期的，长度为 $L_x = L_y = 0.512\\,\\text{m}$，用 $N_x = N_y = 512$ 个单元进行离散化，因此均匀网格间距为 $\\Delta x = \\Delta y = 0.001\\,\\text{m}$。场求解器采用谱方法，并且在算子中包含了静态线性化绝热电子响应来推进电势，因此对于每个傅里叶模式 $\\boldsymbol{k}$，电势由总电荷密度得到\n$$\n\\phi_{\\boldsymbol{k}} = \\frac{\\rho_{\\boldsymbol{k}}}{\\varepsilon_0 \\left(k^{2} + k_D^{2}\\right)},\n$$\n其中 $k = |\\boldsymbol{k}|$，$\\varepsilon_0$ 是真空介电常数，$k_D \\equiv \\lambda_D^{-1}$ 是德拜长度的倒数，$\\lambda_D = \\sqrt{\\varepsilon_0 k_B T_e/(n_0 e^{2})}$，$k_B$ 是玻尔兹曼常数，$T_e$ 是电子温度，$n_0$ 是电子数密度，$e$ 是元电荷。电子使用一阶云中粒子（CIC）形状函数进行电荷分配，其对应的粒子形状傅里叶因子为 $S_{\\boldsymbol{k}} = \\prod_{i\\in\\{x,y\\}} \\mathrm{sinc}^{2}(k_i \\Delta_i/2)$，其中 $\\mathrm{sinc}(x) \\equiv \\sin(x)/x$，$\\Delta_i$ 是方向 $i$ 上的网格间距。\n\n假设在波矢 $\\boldsymbol{k} = k_y \\hat{\\boldsymbol{y}}$（其中 $k_y = 1.5 \\times 10^{3}\\,\\text{m}^{-1}$ 且 $k_x = 0$）处有一个单一的漂移波模式。给定在相同 $\\boldsymbol{k}$ 处的密度扰动振幅 $\\delta n/n_0 = 2.0 \\times 10^{-3}$，漂移波电势振幅由绝热电子关系 $n_{1}/n_{0} = (e \\phi/T_e)$ 确定。等离子体参数为 $n_0 = 1.0 \\times 10^{19}\\,\\text{m}^{-3}$ 和 $T_e = 100\\,\\text{eV}$。\n\n假设电子宏粒子位置是随机、不相关的（非静启动），并忽略除CIC粒子形状函数之外的任何显式数字滤波。设 $N_p$ 表示每个单元内的电子宏粒子数，在整个区域内是均匀的；那么电子宏粒子的总数为 $M = N_p N_x N_y$。噪声驱动的电势涨落谱 $\\langle |\\phi_{\\boldsymbol{k}}|^{2} \\rangle$ 源于对电子分布的有限 $M$ 采样。计算最小的 $N_p$，使得期望的噪声驱动电势振幅平方满足\n$$\n\\langle |\\phi_{\\boldsymbol{k}}|^{2} \\rangle \\leq f \\, |\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}|^{2}\n$$\n在指定的 $\\boldsymbol{k}$ 处，其中 $f = 1.0 \\times 10^{-2}$ 是指定的分数，而 $|\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}|$ 是漂移波模式的振幅。使用傅里叶归一化 $ \\rho_{\\boldsymbol{k}} \\equiv \\frac{1}{V}\\int_{V} \\rho(\\boldsymbol{x}) \\exp(-i \\boldsymbol{k}\\cdot \\boldsymbol{x}) \\, d^{3}x$，其中 $V = L_x L_y$，并使用在给定 $\\boldsymbol{k}$ 处的 CIC 形状因子。将 $N_p$ 表示为无量纲的计数。报告满足要求的最小整数 $N_p$（即，对计算出的实值阈值进行向上取整）。",
            "solution": "### 步骤 1：问题有效性审查\n问题陈述在科学上是合理的，提供了所有必要的参数和明确的目标，因此是有效的。我们将进行分步求解。\n\n### 步骤 2：推导与求解\n问题要求我们找到每个单元的最小粒子数 $N_p$，使得在特定波矢 $\\boldsymbol{k}$ 处，数值噪声电势是物理信号电势的一个小分数 $f$。条件是：\n$$\n\\langle |\\phi_{\\boldsymbol{k}}|^{2} \\rangle \\leq f \\, |\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}|^{2}\n$$\n我们将分别计算信号项 $|\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}|^2$ 和噪声项 $\\langle |\\phi_{\\boldsymbol{k}}|^{2} \\rangle$。\n\n**1. 漂移波信号电势振幅, $|\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}|$}\n\n问题指明，漂移波电势振幅由绝热电子响应确定，即 $n_{1}/n_{0} = e \\phi / T_e$。在傅里叶空间中，此关系对相应模式的振幅成立：\n$$\n\\frac{|n_{1,\\boldsymbol{k}}|}{n_0} = \\frac{e |\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}|}{k_B T_e}\n$$\n问题给出的分数密度扰动振幅为 $\\delta n/n_0 = 2.0 \\times 10^{-3}$，这对应于 $|n_{1,\\boldsymbol{k}}|/n_0$。电子温度为 $T_e = 100\\,\\text{eV}$，这意味着 $k_B T_e / e = 100\\,\\text{V}$。\n重新整理得到电势振幅：\n$$\n|\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}| = \\frac{k_B T_e}{e} \\left( \\frac{\\delta n}{n_0} \\right) = (100\\,\\text{V}) \\times (2.0 \\times 10^{-3}) = 0.2\\,\\text{V}\n$$\n因此，信号振幅的平方为：\n$$\n|\\phi_{\\boldsymbol{k}}^{\\mathrm{DW}}|^2 = (0.2\\,\\text{V})^2 = 0.04\\,\\text{V}^2\n$$\n\n**2. 噪声驱动的电势涨落振幅, $\\langle |\\phi_{\\boldsymbol{k}}|^{2} \\rangle$**\n\n噪声源于用有限数量 $M$ 的宏粒子对电子分布的离散表示。电势的期望涨落平方为：\n$$\n\\langle |\\phi_{\\boldsymbol{k}}|^{2} \\rangle = \\frac{\\langle |\\rho_{\\boldsymbol{k}}|^{2} \\rangle}{\\left[ \\varepsilon_0 (k^2 + k_D^2) \\right]^2}\n$$\n对于不相关的粒子，电荷密度涨落谱为 $\\langle |\\rho_{\\boldsymbol{k}}|^2 \\rangle = |S_{\\boldsymbol{k}}|^2 \\frac{e^2 n_0^2}{M}$，其中 $S_{\\boldsymbol{k}}$ 是粒子形状函数的傅里叶变换，$M=N_p N_x N_y$ 是宏粒子的总数。\n因此，\n$$\n\\langle |\\phi_{\\boldsymbol{k}}|^{2} \\rangle = \\frac{|S_{\\boldsymbol{k}}|^2 e^2 n_0^2}{N_p N_x N_y \\left[ \\varepsilon_0 (k^2 + k_D^2) \\right]^2}\n$$\n\n**3. 组合不等式并求解 $N_p$**\n\n将信号和噪声的表达式代入条件中：\n$$\n\\frac{|S_{\\boldsymbol{k}}|^2 e^2 n_0^2}{N_p N_x N_y \\left[ \\varepsilon_0 (k^2 + k_D^2) \\right]^2} \\leq f \\left( \\frac{k_B T_e}{e} \\frac{\\delta n}{n_0} \\right)^2\n$$\n求解 $N_p$：\n$$\nN_p \\geq \\frac{1}{f N_x N_y} \\frac{|S_{\\boldsymbol{k}}|^2 e^2 n_0^2}{\\left[ \\varepsilon_0 (k^2 + k_D^2) \\right]^2} \\left( \\frac{e}{k_B T_e} \\frac{n_0}{\\delta n} \\right)^2\n$$\n使用德拜波矢的定义 $k_D^2 = n_0 e^2 / (\\varepsilon_0 k_B T_e)$ 来简化表达式，我们得到：\n$$\nN_p \\geq \\frac{1}{f N_x N_y \\left(\\frac{\\delta n}{n_0}\\right)^2} |S_{\\boldsymbol{k}}|^2 \\left( \\frac{k_D^2}{k^2 + k_D^2} \\right)^2\n$$\n\n**4. 数值计算**\n\n我们现在计算各项的数值。\n*   **网格与问题参数**: $N_x = 512$, $N_y = 512$, $f = 1.0 \\times 10^{-2}$, $\\delta n/n_0 = 2.0 \\times 10^{-3}$。\n*   **组合因子**: 首先计算表达式中的主要分母:\n    $$\n    f N_x N_y \\left(\\frac{\\delta n}{n_0}\\right)^2 = (1.0 \\times 10^{-2}) \\times (512 \\times 512) \\times (2.0 \\times 10^{-3})^2\n    $$\n    $$\n    = (1.0 \\times 10^{-2}) \\times (262144) \\times (4.0 \\times 10^{-6}) = 10.48576\n    $$\n*   **波矢**: $\\boldsymbol{k} = (0, 1.5 \\times 10^3)\\,\\text{m}^{-1}$。所以 $k^2 = (1.5 \\times 10^3)^2 = 2.25 \\times 10^6\\,\\text{m}^{-2}$。\n*   **德拜波矢的平方**: $k_D^2 = \\frac{n_0 e^2}{\\varepsilon_0 k_B T_e} = \\frac{n_0 e}{\\varepsilon_0 (k_B T_e/e)}$。\n    $$\n    k_D^2 = \\frac{(1.0 \\times 10^{19}\\,\\text{m}^{-3})(1.602 \\times 10^{-19}\\,\\text{C})}{(8.854 \\times 10^{-12}\\,\\text{F/m})(100\\,\\text{V})} \\approx 1.809 \\times 10^{11}\\,\\text{m}^{-2}\n    $$\n*   **CIC 形状因子**: $S_{\\boldsymbol{k}} = \\mathrm{sinc}^2(k_x \\Delta x/2) \\mathrm{sinc}^2(k_y \\Delta y/2)$。当 $k_x=0$ 和 $\\Delta y = 0.001\\,\\text{m}$ 时：\n    $$\n    \\frac{k_y \\Delta y}{2} = \\frac{(1.5 \\times 10^3\\,\\text{m}^{-1})(0.001\\,\\text{m})}{2} = 0.75\\,\\text{rad}\n    $$\n    在我们的不等式中，项 $|S_{\\boldsymbol{k}}|^2$ 是：\n    $$\n    |S_{\\boldsymbol{k}}|^2 = \\left[ \\mathrm{sinc}^2(0.75) \\right]^2 = \\left(\\frac{\\sin(0.75)}{0.75}\\right)^4 \\approx \\left(\\frac{0.681639}{0.75}\\right)^4 \\approx (0.908852)^4 \\approx 0.68231\n    $$\n*   **综合计算**:\n    $$\n    N_p \\geq \\frac{1}{10.48576} \\times (0.68231) \\times \\left( \\frac{1.809 \\times 10^{11}}{2.25 \\times 10^6 + 1.809 \\times 10^{11}} \\right)^2\n    $$\n    括号中的项非常接近1：\n    $$\n    \\left( \\frac{1.809 \\times 10^{11}}{1.8090225 \\times 10^{11}} \\right)^2 \\approx (0.99998756)^2 \\approx 0.9999751\n    $$\n    因此：\n    $$\n    N_p \\geq (0.095367) \\times (0.68231) \\times (0.9999751) \\approx 0.0650697\n    $$\n问题要求满足条件的最小整数 $N_p$。由于计算出的阈值小于1，这意味着即使每个单元只有一个粒子，噪声水平也已经满足要求。\n$$\nN_p = \\lceil 0.0650697 \\rceil = 1\n$$",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "即使使用了足够多的粒子，高波数的噪声仍然可能污染模拟数据。一个常见的补救措施是应用数字滤波器。这个实践深入探讨了广泛使用的二项式滤波器的机理，要求你推导其传递函数 。这个分析将精确地揭示滤波器如何选择性地抑制高频噪声，同时保留我们旨在研究的长波长物理结构。",
            "id": "4197556",
            "problem": "考虑一个用于聚变等离子体湍流的粒子模拟（Particle-In-Cell, PIC）中的一维、均匀、周期性网格。该网格有 $N$ 个点，间距为 $\\Delta x$，区域长度为 $L = N \\Delta x$。令 $f_i$ 表示在位置 $x_i = i \\Delta x$ 上的一个网格场（例如电荷密度），其中 $i \\in \\{0, 1, \\dots, N-1\\}$。来自有限数量宏观粒子的数值散粒噪声通常会污染 $f_i$ 的高波数分量。一个标准的控制策略是对 $f_i$ 应用二项式平滑滤波器。\n\n定义 $m$ 次中心二项式滤波器（$m$ 为偶数且 $m \\geq 2$）为离散卷积\n$$\ng_i \\equiv \\sum_{p=-m/2}^{m/2} w_p \\, f_{i+p}, \\quad \\text{其中} \\quad w_p = 2^{-m} \\binom{m}{p + m/2},\n$$\n其中 $f_{i+p}$ 的索引是周期性的。滤波器权重 $\\{w_p\\}$ 是归一化的二项式系数，对称中心化以使滤波器具有零相移。\n\n利用周期性网格上的离散傅里叶表示，以及傅里叶模式是线性移不变运算的本征函数这一事实，推导该二项式滤波器的传递函数 $H(k)$。对于单个波数为 $k = 2\\pi n / L$（$n$ 为整数）的傅里叶模式 $f_i = \\exp(i k x_i)$，传递函数由 $g_i = H(k) f_i$ 定义。你的推导必须从离散卷积和傅里叶模式的既定定义和基本性质出发，并且必须是自洽且科学上一致的。\n\n请用一个关于 $k$、$\\Delta x$ 和 $m$ 的单一闭式解析表达式来表示你的最终答案。然后，在你的推导过程中，通过分析 $H(k)$ 在 $k = 0$ 附近和奈奎斯特波数 $k_{\\mathrm{N}} = \\pi / \\Delta x$ 处的行为，解释所得到的 $H(k)$ 如何在衰减高波数噪声的同时保留 $k \\approx 0$ 的内容。\n\n仅提供 $H(k)$ 的最终表达式。无需数值取整。",
            "solution": "该问题陈述具有科学依据、自成体系且提法得当。它描述了一种在有效的物理背景（粒子模拟）中使用的标准数值技术（二项式平滑），并要求进行标准的数学分析（推导传递函数）。所有定义都清晰且可形式化。因此，该问题被认为是**有效的**，并将提供解答。\n\n目标是为指定的 $m$ 次中心二项式滤波器推导传递函数 $H(k)$。该滤波器根据离散卷积将网格函数 $f_i$ 转换为平滑函数 $g_i$：\n$$\ng_i = \\sum_{p=-m/2}^{m/2} w_p \\, f_{i+p}\n$$\n其中权重由 $w_p = 2^{-m} \\binom{m}{p + m/2}$ 给出。\n\n传递函数 $H(k)$ 被定义为滤波器算子作用于单个离散傅里叶模式 $f_i = \\exp(i k x_i)$ 时的本征值，其中 $x_i = i \\Delta x$。其关系由 $g_i = H(k) f_i$ 给出。\n\n我们首先将滤波器应用于这种特定形式的 $f_i$。函数在移位的网格点 $i+p$ 处的值为：\n$$\nf_{i+p} = \\exp(i k x_{i+p}) = \\exp(i k (i+p) \\Delta x) = \\exp(i k i \\Delta x) \\exp(i k p \\Delta x)\n$$\n注意到 $f_i = \\exp(i k i \\Delta x)$，我们可以写出：\n$$\nf_{i+p} = f_i \\exp(i k p \\Delta x)\n$$\n将此代入 $g_i$ 的定义中：\n$$\ng_i = \\sum_{p=-m/2}^{m/2} w_p \\left( f_i \\exp(i k p \\Delta x) \\right)\n$$\n由于 $f_i$ 相对于求和索引 $p$ 是常数，我们可以将其从求和中提出：\n$$\ng_i = f_i \\left( \\sum_{p=-m/2}^{m/2} w_p \\exp(i k p \\Delta x) \\right)\n$$\n通过将其与定义 $g_i = H(k) f_i$ 进行比较，我们可以确定传递函数 $H(k)$ 就是括号中的项：\n$$\nH(k) = \\sum_{p=-m/2}^{m/2} w_p \\exp(i k p \\Delta x)\n$$\n现在，我们代入权重 $w_p$ 的显式形式：\n$$\nH(k) = \\sum_{p=-m/2}^{m/2} 2^{-m} \\binom{m}{p + m/2} \\exp(i k p \\Delta x)\n$$\n为了简化这个求和，我们引入一个新的索引 $j = p + m/2$。由于 $m$ 是偶数，所以 $m/2$ 是整数。当 $p$ 的范围从 $-m/2$ 到 $m/2$ 时，新索引 $j$ 的范围从 $0$ 到 $m$。索引之间的关系是 $p = j - m/2$。将此代入 $H(k)$ 的表达式中：\n$$\nH(k) = 2^{-m} \\sum_{j=0}^{m} \\binom{m}{j} \\exp\\left(i k (j - m/2) \\Delta x\\right)\n$$\n我们可以分离指数项：\n$$\nH(k) = 2^{-m} \\sum_{j=0}^{m} \\binom{m}{j} \\exp(i k j \\Delta x) \\exp(-i k m \\Delta x / 2)\n$$\n项 $\\exp(-i k m \\Delta x / 2)$ 不依赖于求和索引 $j$，可以被提出：\n$$\nH(k) = 2^{-m} \\exp(-i k m \\Delta x / 2) \\sum_{j=0}^{m} \\binom{m}{j} (\\exp(i k \\Delta x))^j\n$$\n现在的求和是二项式定理的形式，$\\sum_{j=0}^{m} \\binom{m}{j} z^j = (1+z)^m$，其中 $z = \\exp(i k \\Delta x)$。应用该定理得到：\n$$\nH(k) = 2^{-m} \\exp(-i k m \\Delta x / 2) (1 + \\exp(i k \\Delta x))^m\n$$\n为了得到最终的闭式表达式，我们简化项 $(1 + \\exp(i k \\Delta x))$。通过提出因子 $\\exp(i k \\Delta x / 2)$，我们得到：\n$$\n1 + \\exp(i k \\Delta x) = \\exp(i k \\Delta x / 2) \\left( \\exp(-i k \\Delta x / 2) + \\exp(i k \\Delta x / 2) \\right)\n$$\n使用欧拉恒等式 $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$，括号中的项等于 $2\\cos(k \\Delta x / 2)$。因此：\n$$\n1 + \\exp(i k \\Delta x) = 2 \\cos(k \\Delta x / 2) \\exp(i k \\Delta x / 2)\n$$\n将此代回 $H(k)$ 的表达式中：\n$$\nH(k) = 2^{-m} \\exp(-i k m \\Delta x / 2) \\left( 2 \\cos(k \\Delta x / 2) \\exp(i k \\Delta x / 2) \\right)^m\n$$\n将指数 $m$ 分配进去：\n$$\nH(k) = 2^{-m} \\exp(-i k m \\Delta x / 2) \\cdot 2^m \\cos^m(k \\Delta x / 2) \\exp(i k m \\Delta x / 2)\n$$\n$2^{-m}$ 和 $2^m$ 项相互抵消。复指数项也相互抵消：$\\exp(-i k m \\Delta x / 2) \\exp(i k m \\Delta x / 2) = \\exp(0) = 1$。这种抵消证实了滤波器具有零相移，正如其对称构造所预期的那样。\n我们得到最终的实值传递函数：\n$$\nH(k) = \\cos^m\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n接下来，我们分析这个传递函数的行为。\n\n对于低波数（$k \\approx 0$），这对应于长波长的物理结构，其参数 $k \\Delta x / 2$ 很小。余弦函数在 $0$ 附近的泰勒展开为 $\\cos(\\theta) \\approx 1 - \\theta^2/2$（对于小 $\\theta$）。因此：\n$$\nH(k) \\approx \\left(1 - \\frac{1}{2}\\left(\\frac{k \\Delta x}{2}\\right)^2\\right)^m = \\left(1 - \\frac{k^2 \\Delta x^2}{8}\\right)^m\n$$\n对于第二项的较小值，我们可以使用二项式近似 $(1-\\epsilon)^m \\approx 1 - m\\epsilon$：\n$$\nH(k) \\approx 1 - m \\frac{k^2 \\Delta x^2}{8}\n$$\n在 $k=0$ 时， $H(0) = \\cos^m(0) = 1^m = 1$。这表明滤波器正确地保留了场的平均值（直流分量），并且对于长波模式具有接近于1的响应，从而保留了数据的大尺度特征。该滤波器在 $k=0$ 处是“最大平坦”的。\n\n对于高波数，我们考虑奈奎斯特波数 $k_{\\mathrm{N}} = \\pi / \\Delta x$，它代表了网格上可分辨的最高频率。在此波数下，余弦函数的参数为：\n$$\n\\frac{k_{\\mathrm{N}} \\Delta x}{2} = \\frac{(\\pi / \\Delta x) \\Delta x}{2} = \\frac{\\pi}{2}\n$$\n在奈奎斯特频率下，传递函数的值为：\n$$\nH(k_{\\mathrm{N}}) = \\cos^m\\left(\\frac{\\pi}{2}\\right) = 0^m = 0\n$$\n（因为问题陈述 $m \\geq 2$，所以此式成立）。这个结果表明，二项式滤波器强烈衰减高波数分量，并完全消除奈奎斯特模式。这正是旨在消除高频数值噪声的滤波器所期望的特性，这种噪声在网格尺度上最为显著。$m$ 的值越大，从 $k=0$ 处的 $H(k)=1$ 到 $k=k_{\\mathrm{N}}$ 处的 $H(k)=0$ 的滚降就越快，从而提供更强的平滑效果。",
            "answer": "$$\n\\boxed{\\cos^{m}\\left(\\frac{k \\Delta x}{2}\\right)}\n$$"
        },
        {
            "introduction": "对于那些关注已知平衡态周围小扰动的模拟，标准的“全-$f$”方法可能因噪声过大而效率低下。$\\delta f$ 方法通过只追踪与背景分布的偏差，提供了一种强大的替代方案。在这个练习中，你将通过比较 $\\delta f$ 方法与“全-$f$”方法的方差，从数学上证明 $\\delta f$ 方法的降噪优势 ，从而突显出一种设计低噪声模拟的先进策略。",
            "id": "4197515",
            "problem": "考虑一个长度为 $L$、满足周期性边界条件的静电、无碰撞的一维周期性等离子体。令 $k = 2\\pi m / L$（其中 $m \\neq 0$ 为整数）表示一个非零傅里叶模式。电势傅里叶系数 $\\Phi_k$ 与电荷密度傅里叶系数 $\\rho_k$ 通过泊松方程相关联，在傅里叶空间中，对于 $k \\neq 0$，该方程表示为 $\\Phi_k = \\rho_k / (\\varepsilon_0 k^2)$，其中 $\\varepsilon_0$ 是真空介电常数。在网格粒子（PIC）方法中，宏粒子电荷使用形函数 $S(x)$ 分配到网格上，其在波数 $k$ 处的傅里叶变换记为 $\\tilde{S}(k)$。假设有 $N$ 个宏粒子独立地对均匀背景分布函数 $f_0(x) = 1/L$ 进行采样，因此粒子位置 $\\{x_i\\}_{i=1}^N$ 是在 $[0,L]$ 上独立同分布的均匀随机变量。\n\n定义波数 $k$ 处的电荷密度傅里叶模式估计量如下：\n\n- 全f (Full-$f$) 方法：每个宏粒子携带相同的物理电荷 $q_m$，傅里叶模式估计量为 $\\rho_k^{(f)} = q_m \\tilde{S}(k) \\sum_{i=1}^{N} \\exp(-\\mathrm{i} k x_i)$。\n\n- δf (Delta-$f$) 方法：宏粒子位置从 $f_0(x)$ 中抽取，但每个宏粒子还额外携带一个独立的随机权重 $w_i$，满足 $\\mathbb{E}[w_i] = 0$，$\\mathrm{Var}(w_i) = \\sigma_w^2$，且 $\\{w_i\\}$ 与 $\\{x_i\\}$ 相互独立。傅里叶模式估计量为 $\\rho_k^{(\\delta)} = q_m \\tilde{S}(k) \\sum_{i=1}^{N} w_i \\exp(-\\mathrm{i} k x_i)$。\n\n假设所有随机变量均如指定的那样相互独立，并使用复值随机变量的方差定义 $\\mathrm{Var}(Z) = \\mathbb{E}[|Z - \\mathbb{E}[Z]|^2] = \\mathbb{E}[|Z|^2] - |\\mathbb{E}[Z]|^2$。从这些定义和泊松方程出发，推导 $\\mathrm{Var}(\\Phi_k^{(f)})$ 和 $\\mathrm{Var}(\\Phi_k^{(\\delta)})$ 关于 $N$、$q_m$、\\,$|\\tilde{S}(k)|$、$\\varepsilon_0$ 和 $k$ 的一般表达式。然后，计算比率\n$$\nR \\equiv \\frac{\\mathrm{Var}(\\Phi_k^{(f)})}{\\mathrm{Var}(\\Phi_k^{(\\delta)})}.\n$$\n将 $R$ 的最终答案表示为一个封闭形式的解析表达式。不需要进行数值计算或四舍五入，最终表达式中不应包含单位。",
            "solution": "该问题在计算等离子体物理领域内是适定的且具有科学依据，具体涉及对网格粒子（PIC）模拟中数值噪声的分析。所有必要的量都已定义，且前提条件一致并足以推导出解。因此，有必要进行全面分析。\n\n电势傅里叶系数 $\\Phi_k$ 与电荷密度傅里叶系数 $\\rho_k$ 之间的关系由傅里叶空间中的泊松方程给出：\n$$\n\\Phi_k = \\frac{\\rho_k}{\\varepsilon_0 k^2}\n$$\n对于非零波数 $k$。由于对于给定模式，$\\varepsilon_0$ 和 $k$ 是常数，因此势估计量的方差与电荷密度估计量的方差成正比：\n$$\n\\mathrm{Var}(\\Phi_k) = \\mathrm{Var}\\left(\\frac{\\rho_k}{\\varepsilon_0 k^2}\\right) = \\frac{1}{(\\varepsilon_0 k^2)^2} \\mathrm{Var}(\\rho_k) = \\frac{1}{\\varepsilon_0^2 k^4} \\mathrm{Var}(\\rho_k)\n$$\n我们现在将分别计算全f (full-$f$) 和δf (delta-$f$) 估计量的方差。\n\n首先，我们必须计算一个将在两种情况下都用到的关键期望值。设 $x$ 是在区间 $[0, L]$ 上均匀分布的随机变量。复指数项 $\\exp(-\\mathrm{i} k x)$ 的期望为：\n$$\n\\mathbb{E}[\\exp(-\\mathrm{i} k x)] = \\int_0^L \\exp(-\\mathrm{i} k x) f_0(x) \\,dx = \\int_0^L \\exp(-\\mathrm{i} k x) \\frac{1}{L} \\,dx\n$$\n计算该积分得到：\n$$\n\\mathbb{E}[\\exp(-\\mathrm{i} k x)] = \\frac{1}{L} \\left[ \\frac{\\exp(-\\mathrm{i} k x)}{-\\mathrm{i} k} \\right]_0^L = \\frac{1}{-\\mathrm{i} k L} (\\exp(-\\mathrm{i} k L) - \\exp(0)) = \\frac{\\mathrm{i}}{kL} (\\exp(-\\mathrm{i} k L) - 1)\n$$\n问题陈述 $k = 2\\pi m / L$，其中 $m$ 为某个非零整数。将此代入指数项：\n$$\n\\exp(-\\mathrm{i} k L) = \\exp\\left(-\\mathrm{i} \\frac{2\\pi m}{L} L\\right) = \\exp(-\\mathrm{i} 2\\pi m) = \\cos(2\\pi m) - \\mathrm{i}\\sin(2\\pi m) = 1\n$$\n因此，对于 $k \\neq 0$：\n$$\n\\mathbb{E}[\\exp(-\\mathrm{i} k x)] = \\frac{\\mathrm{i}}{kL} (1 - 1) = 0\n$$\n\n现在我们分析全f方法。\n电荷密度估计量为 $\\rho_k^{(f)} = q_m \\tilde{S}(k) \\sum_{i=1}^{N} \\exp(-\\mathrm{i} k x_i)$。\n该估计量的期望为：\n$$\n\\mathbb{E}[\\rho_k^{(f)}] = \\mathbb{E}\\left[q_m \\tilde{S}(k) \\sum_{i=1}^{N} \\exp(-\\mathrm{i} k x_i)\\right] = q_m \\tilde{S}(k) \\sum_{i=1}^{N} \\mathbb{E}[\\exp(-\\mathrm{i} k x_i)]\n$$\n由于粒子位置 $\\{x_i\\}$ 是独立同分布（i.i.d.）的均匀随机变量，对每个 $i$，$\\mathbb{E}[\\exp(-\\mathrm{i} k x_i)] = 0$。因此，\n$$\n\\mathbb{E}[\\rho_k^{(f)}] = q_m \\tilde{S}(k) \\sum_{i=1}^{N} 0 = 0\n$$\n方差由 $\\mathrm{Var}(\\rho_k^{(f)}) = \\mathbb{E}[|\\rho_k^{(f)}|^2] - |\\mathbb{E}[\\rho_k^{(f)}]|^2$ 给出。由于均值为零，这简化为 $\\mathrm{Var}(\\rho_k^{(f)}) = \\mathbb{E}[|\\rho_k^{(f)}|^2]$。\n$$\n\\mathbb{E}[|\\rho_k^{(f)}|^2] = \\mathbb{E}\\left[ \\left| q_m \\tilde{S}(k) \\sum_{i=1}^{N} \\exp(-\\mathrm{i} k x_i) \\right|^2 \\right] = |q_m \\tilde{S}(k)|^2 \\mathbb{E}\\left[ \\left| \\sum_{i=1}^{N} \\exp(-\\mathrm{i} k x_i) \\right|^2 \\right]\n$$\n令 $Z_i = \\exp(-\\mathrm{i} k x_i)$。我们需要计算 $\\mathbb{E}\\left[ |\\sum_{i=1}^N Z_i|^2 \\right]$。\n$$\n\\mathbb{E}\\left[ \\left(\\sum_{i=1}^N Z_i\\right) \\left(\\sum_{j=1}^N Z_j^*\\right) \\right] = \\mathbb{E}\\left[ \\sum_{i=1}^N \\sum_{j=1}^N Z_i Z_j^* \\right] = \\sum_{i=1}^N \\sum_{j=1}^N \\mathbb{E}[Z_i Z_j^*]\n$$\n我们将和分为两种情况：$i = j$ 和 $i \\neq j$。\n对于 $i = j$：\n$$\n\\mathbb{E}[Z_i Z_i^*] = \\mathbb{E}[|Z_i|^2] = \\mathbb{E}[|\\exp(-\\mathrm{i} k x_i)|^2] = \\mathbb{E}[1] = 1\n$$\n共有 $N$ 个这样的项。\n对于 $i \\neq j$：\n由于 $x_i$ 和 $x_j$ 独立，所以 $Z_i$ 和 $Z_j$ 也独立。\n$$\n\\mathbb{E}[Z_i Z_j^*] = \\mathbb{E}[Z_i] \\mathbb{E}[Z_j^*] = \\mathbb{E}[\\exp(-\\mathrm{i} k x_i)] \\mathbb{E}[\\exp(\\mathrm{i} k x_j)]\n$$\n如前所示，$\\mathbb{E}[\\exp(-\\mathrm{i} k x)] = 0$。通过共轭，$\\mathbb{E}[\\exp(\\mathrm{i} k x)] = (\\mathbb{E}[\\exp(-\\mathrm{i} k x)])^* = 0^* = 0$。\n因此，对于 $i \\neq j$，$\\mathbb{E}[Z_i Z_j^*] = 0 \\cdot 0 = 0$。\n综合这些结果：\n$$\n\\mathbb{E}\\left[ \\left| \\sum_{i=1}^{N} Z_i \\right|^2 \\right] = \\sum_{i=1}^N \\mathbb{E}[|Z_i|^2] + \\sum_{i \\neq j} \\mathbb{E}[Z_i Z_j^*] = N \\cdot 1 + N(N-1) \\cdot 0 = N\n$$\n因此，全f电荷密度的方差为：\n$$\n\\mathrm{Var}(\\rho_k^{(f)}) = q_m^2 |\\tilde{S}(k)|^2 N\n$$\n而势的方差为：\n$$\n\\mathrm{Var}(\\Phi_k^{(f)}) = \\frac{N q_m^2 |\\tilde{S}(k)|^2}{\\varepsilon_0^2 k^4}\n$$\n\n接下来，我们分析δf方法。\n电荷密度估计量为 $\\rho_k^{(\\delta)} = q_m \\tilde{S}(k) \\sum_{i=1}^{N} w_i \\exp(-\\mathrm{i} k x_i)$。\n该估计量的期望为：\n$$\n\\mathbb{E}[\\rho_k^{(\\delta)}] = \\mathbb{E}\\left[q_m \\tilde{S}(k) \\sum_{i=1}^{N} w_i \\exp(-\\mathrm{i} k x_i)\\right] = q_m \\tilde{S}(k) \\sum_{i=1}^{N} \\mathbb{E}[w_i \\exp(-\\mathrm{i} k x_i)]\n$$\n由于权重 $\\{w_i\\}$ 和位置 $\\{x_i\\}$ 是独立的，我们可以分离期望：\n$$\n\\mathbb{E}[w_i \\exp(-\\mathrm{i} k x_i)] = \\mathbb{E}[w_i] \\mathbb{E}[\\exp(-\\mathrm{i} k x_i)]\n$$\n给定 $\\mathbb{E}[w_i] = 0$，并且我们已经证明 $\\mathbb{E}[\\exp(-\\mathrm{i} k x_i)] = 0$。因此，$\\mathbb{E}[w_i \\exp(-\\mathrm{i} k x_i)] = 0 \\cdot 0 = 0$。\n该估计量的期望为：\n$$\n\\mathbb{E}[\\rho_k^{(\\delta)}] = q_m \\tilde{S}(k) \\sum_{i=1}^{N} 0 = 0\n$$\n与之前一样，方差为 $\\mathrm{Var}(\\rho_k^{(\\delta)}) = \\mathbb{E}[|\\rho_k^{(\\delta)}|^2]$。\n$$\n\\mathbb{E}[|\\rho_k^{(\\delta)}|^2] = |q_m \\tilde{S}(k)|^2 \\mathbb{E}\\left[ \\left| \\sum_{i=1}^{N} w_i \\exp(-\\mathrm{i} k x_i) \\right|^2 \\right]\n$$\n令 $Y_i = w_i \\exp(-\\mathrm{i} k x_i)$。我们计算 $\\mathbb{E}\\left[ |\\sum_{i=1}^N Y_i|^2 \\right]$。\n$$\n\\mathbb{E}\\left[ |\\sum_{i=1}^N Y_i|^2 \\right] = \\sum_{i=1}^N \\sum_{j=1}^N \\mathbb{E}[Y_i Y_j^*]\n$$\n对于 $i = j$：\n$$\n\\mathbb{E}[Y_i Y_i^*] = \\mathbb{E}[|Y_i|^2] = \\mathbb{E}[|w_i \\exp(-\\mathrm{i} k x_i)|^2] = \\mathbb{E}[|w_i|^2 |\\exp(-\\mathrm{i} k x_i)|^2]\n$$\n因为 $w_i$ 是实值随机变量，所以 $|w_i|^2 = w_i^2$。并且 $|\\exp(-\\mathrm{i} k x_i)|^2 = 1$。\n$$\n\\mathbb{E}[|Y_i|^2] = \\mathbb{E}[w_i^2]\n$$\n根据方差的定义，$\\mathrm{Var}(w_i) = \\mathbb{E}[w_i^2] - (\\mathbb{E}[w_i])^2$。我们已知 $\\mathrm{Var}(w_i) = \\sigma_w^2$ 和 $\\mathbb{E}[w_i] = 0$。所以，$\\sigma_w^2 = \\mathbb{E}[w_i^2] - 0^2$，这意味着 $\\mathbb{E}[w_i^2] = \\sigma_w^2$。\n因此，$\\mathbb{E}[|Y_i|^2] = \\sigma_w^2$。共有 $N$ 个这样的项。\n对于 $i \\neq j$：\n随机变量 $\\{w_i, x_i\\}$ 与 $\\{w_j, x_j\\}$ 相互独立。因此 $Y_i$ 和 $Y_j$ 也独立。\n$$\n\\mathbb{E}[Y_i Y_j^*] = \\mathbb{E}[Y_i] \\mathbb{E}[Y_j^*]\n$$\n我们已经证明了 $\\mathbb{E}[Y_i] = \\mathbb{E}[w_i] \\mathbb{E}[\\exp(-\\mathrm{i} k x_i)] = 0$。\n所以，对于 $i \\neq j$，$\\mathbb{E}[Y_i Y_j^*] = 0 \\cdot 0 = 0$。\n综合这些结果：\n$$\n\\mathbb{E}\\left[ \\left| \\sum_{i=1}^{N} Y_i \\right|^2 \\right] = \\sum_{i=1}^N \\mathbb{E}[|Y_i|^2] + \\sum_{i \\neq j} \\mathbb{E}[Y_i Y_j^*] = N \\sigma_w^2 + N(N-1) \\cdot 0 = N \\sigma_w^2\n$$\n因此，δf电荷密度的方差为：\n$$\n\\mathrm{Var}(\\rho_k^{(\\delta)}) = q_m^2 |\\tilde{S}(k)|^2 N \\sigma_w^2\n$$\n而势的方差为：\n$$\n\\mathrm{Var}(\\Phi_k^{(\\delta)}) = \\frac{N q_m^2 |\\tilde{S}(k)|^2 \\sigma_w^2}{\\varepsilon_0^2 k^4}\n$$\n\n最后，我们计算比率 $R$：\n$$\nR \\equiv \\frac{\\mathrm{Var}(\\Phi_k^{(f)})}{\\mathrm{Var}(\\Phi_k^{(\\delta)})} = \\frac{\\frac{N q_m^2 |\\tilde{S}(k)|^2}{\\varepsilon_0^2 k^4}}{\\frac{N q_m^2 |\\tilde{S}(k)|^2 \\sigma_w^2}{\\varepsilon_0^2 k^4}}\n$$\n所有公因子都消掉了，留下一个非常简洁的结果：\n$$\nR = \\frac{1}{\\sigma_w^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{\\sigma_w^2}}\n$$"
        }
    ]
}