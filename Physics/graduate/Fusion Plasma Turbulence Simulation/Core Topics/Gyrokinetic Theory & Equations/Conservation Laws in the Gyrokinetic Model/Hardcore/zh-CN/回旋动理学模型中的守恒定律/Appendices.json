{
    "hands_on_practices": [
        {
            "introduction": "回旋动理学框架的构建基础是对带电粒子围绕磁力线的快速回旋运动进行简化。本练习旨在探讨这一思想的基石：磁矩 $\\mu$ 的绝热不变性。通过直接计算哈密顿量与磁矩的泊松括号，您将验证在回旋运动的时间尺度上，$\\mu$ 是守恒的，这使我们能够对这种快速运动进行平均，从而简化动力学方程 。",
            "id": "4184652",
            "problem": "考虑一个单一粒子种类，其电荷为 $q$，质量为 $m$，在均匀、不随时间变化的磁场 $\\boldsymbol{B} = B\\,\\hat{\\boldsymbol{z}}$ 中运动，并受到一个与聚变等离子体湍流中的标准回旋动理学（GK）排序一致的弱慢变静电势 $\\varphi(\\boldsymbol{r},t)$ 的作用。GK排序假设存在小参数 $\\epsilon_{\\rho} = \\rho/L \\ll 1$ 和 $\\epsilon_{\\omega} = \\omega/\\Omega \\ll 1$，其中 $\\rho$ 是拉莫尔半径， $L$ 是宏观平衡尺度， $\\omega$ 是特征涨落频率， $\\Omega = q B/m$ 是回旋频率。在此设定下，粒子动力学是哈密顿的，具有正则相空间坐标 $(\\boldsymbol{r},\\boldsymbol{p})$ 和哈密顿量\n$$\nH(\\boldsymbol{r},\\boldsymbol{p},t) = \\frac{1}{2m}\\left|\\boldsymbol{p} - q\\,\\boldsymbol{A}(\\boldsymbol{r})\\right|^{2} + q\\,\\varphi(\\boldsymbol{r},t),\n$$\n其中 $\\boldsymbol{A}(\\boldsymbol{r})$ 是一个产生均匀磁场 $\\boldsymbol{B} = \\nabla \\times \\boldsymbol{A}$ 的静态磁矢势（为明确起见，可采用对称规范 $\\boldsymbol{A}(\\boldsymbol{r}) = \\tfrac{1}{2}\\boldsymbol{B}\\times \\boldsymbol{r}$）。定义磁矩\n$$\n\\mu(\\boldsymbol{r},\\boldsymbol{p}) = \\frac{\\left|\\boldsymbol{\\pi}_{\\perp}\\right|^{2}}{2 m B}, \\quad \\text{with} \\quad \\boldsymbol{\\pi} \\equiv \\boldsymbol{p} - q\\,\\boldsymbol{A}(\\boldsymbol{r}), \\quad \\boldsymbol{\\pi}_{\\perp} \\equiv \\boldsymbol{\\pi} - (\\boldsymbol{\\pi}\\cdot \\hat{\\boldsymbol{b}})\\hat{\\boldsymbol{b}}, \\quad \\hat{\\boldsymbol{b}} \\equiv \\frac{\\boldsymbol{B}}{B}.\n$$\n使用正则泊松括号\n$$\n\\{F,G\\} \\equiv \\sum_{i=1}^{3}\\left(\\frac{\\partial F}{\\partial r_{i}}\\frac{\\partial G}{\\partial p_{i}} - \\frac{\\partial F}{\\partial p_{i}}\\frac{\\partial G}{\\partial r_{i}}\\right),\n$$\n在GK排序下，计算泊松括号 $\\{H,\\mu\\}$ 的领头阶表达式，用在粒子位置处评估的垂直速度 $\\boldsymbol{v}_{\\perp} \\equiv \\boldsymbol{\\pi}_{\\perp}/m$ 和垂直电场 $\\boldsymbol{E}_{\\perp} \\equiv -\\nabla_{\\perp}\\varphi$ 来表示。然后，在一个回旋周期内进行回旋角平均，\n$$\n\\langle f \\rangle \\equiv \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(\\theta)\\, d\\theta,\n$$\n在固定的导心位置（在领头阶，将 $\\boldsymbol{E}_{\\perp}$ 视为在拉莫尔轨道上是恒定的），并确定在均匀磁场中回旋角平均值 $\\langle \\{H,\\mu\\} \\rangle$。将最终答案表示为单个值。无需四舍五入。",
            "solution": "用户要求我计算哈密顿量与磁矩的领头阶、回旋角平均的泊松括号，即 $\\langle \\{H,\\mu\\} \\rangle$。\n\n**问题验证**\n\n**第一步：提取已知条件**\n-   系统：电荷为 $q$、质量为 $m$ 的单一粒子种类。\n-   场：均匀、不随时间变化的磁场 $\\boldsymbol{B} = B\\,\\hat{\\boldsymbol{z}}$，以及一个弱慢变静电势 $\\varphi(\\boldsymbol{r},t)$。\n-   回旋动理学（GK）排序：$\\epsilon_{\\rho} = \\rho/L \\ll 1$ 和 $\\epsilon_{\\omega} = \\omega/\\Omega \\ll 1$，其中 $\\rho$ 是拉莫尔半径， $L$ 是宏观尺度长度， $\\omega$ 是特征涨落频率， $\\Omega = q B/m$ 是回旋频率。\n-   哈密顿量：$H(\\boldsymbol{r},\\boldsymbol{p},t) = \\frac{1}{2m}\\left|\\boldsymbol{p} - q\\,\\boldsymbol{A}(\\boldsymbol{r})\\right|^{2} + q\\,\\varphi(\\boldsymbol{r},t)$。\n-   磁矢势：$\\boldsymbol{A}(\\boldsymbol{r})$，满足 $\\boldsymbol{B} = \\nabla \\times \\boldsymbol{A}$。建议使用对称规范 $\\boldsymbol{A}(\\boldsymbol{r}) = \\tfrac{1}{2}\\boldsymbol{B}\\times \\boldsymbol{r}$。\n-   磁矩：$\\mu(\\boldsymbol{r},\\boldsymbol{p}) = \\frac{\\left|\\boldsymbol{\\pi}_{\\perp}\\right|^{2}}{2 m B}$，其中 $\\boldsymbol{\\pi} \\equiv \\boldsymbol{p} - q\\,\\boldsymbol{A}(\\boldsymbol{r})$，$\\boldsymbol{\\pi}_{\\perp} \\equiv \\boldsymbol{\\pi} - (\\boldsymbol{\\pi}\\cdot \\hat{\\boldsymbol{b}})\\hat{\\boldsymbol{b}}$，且 $\\hat{\\boldsymbol{b}} \\equiv \\boldsymbol{B}/B$。\n-   泊松括号：$\\{F,G\\} \\equiv \\sum_{i=1}^{3}\\left(\\frac{\\partial F}{\\partial r_{i}}\\frac{\\partial G}{\\partial p_{i}} - \\frac{\\partial F}{\\partial p_{i}}\\frac{\\partial G}{\\partial r_{i}}\\right)$。\n-   回旋角平均：$\\langle f \\rangle \\equiv \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(\\theta)\\, d\\theta$。\n-   任务：在 $\\boldsymbol{E}_{\\perp} \\equiv -\\nabla_{\\perp}\\varphi$ 在拉莫尔轨道上为常数的假设下，计算 $\\langle \\{H,\\mu\\} \\rangle$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在科学上基于哈密顿力学和等离子体物理，特别是在回旋动理学理论的标准框架内。该问题是适定的、客观的且自洽的，为得到唯一解提供了所有必要的定义和约束。哈密顿量、磁矩和泊松括号的定义都是标准的。回旋动理学排序及相关的简化（将电场视为在轨道上是均匀的）是该领域的核心假设。该问题涉及磁矩守恒，这是等离子体物理中的一个基本概念。所有方面都符合验证标准。\n\n**第三步：结论与行动**\n问题有效。将提供解答。\n\n**解答推导**\n\n目标是计算 $\\langle \\{H,\\mu\\} \\rangle$。我们首先计算泊松括号 $\\{H,\\mu\\}$。\n哈密顿量由 $H = \\frac{1}{2m}|\\boldsymbol{\\pi}|^2 + q\\varphi(\\boldsymbol{r}, t)$ 给出。我们可以将动能分解为平行和垂直于磁场的部分。\n力学动量为 $\\boldsymbol{\\pi} = \\boldsymbol{\\pi}_{\\parallel} + \\boldsymbol{\\pi}_{\\perp}$，其中 $\\boldsymbol{\\pi}_{\\parallel} = (\\boldsymbol{\\pi} \\cdot \\hat{\\boldsymbol{b}})\\hat{\\boldsymbol{b}}$。这得出 $|\\boldsymbol{\\pi}|^2 = |\\boldsymbol{\\pi}_{\\perp}|^2 + |\\boldsymbol{\\pi}_{\\parallel}|^2$。\n使用磁矩的定义，$\\mu = \\frac{|\\boldsymbol{\\pi}_\\perp|^2}{2mB}$，我们有 $|\\boldsymbol{\\pi}_\\perp|^2 = 2mB\\mu$。\n哈密顿量可以改写为：\n$$\nH = \\frac{|\\boldsymbol{\\pi}_\\perp|^2 + |\\boldsymbol{\\pi}_\\parallel|^2}{2m} + q\\varphi = \\frac{2mB\\mu}{2m} + \\frac{|\\boldsymbol{\\pi}_\\parallel|^2}{2m} + q\\varphi = \\frac{B}{m}\\mu + \\frac{|\\boldsymbol{\\pi}_\\parallel|^2}{2m} + q\\varphi\n$$\n对于均匀磁场 $\\boldsymbol{B} = B\\hat{\\boldsymbol{z}}$，我们有 $\\hat{\\boldsymbol{b}}=\\hat{\\boldsymbol{z}}$。平行方向动量为 $\\pi_\\parallel = \\boldsymbol{\\pi}\\cdot\\hat{\\boldsymbol{z}} = (\\boldsymbol{p} - q\\boldsymbol{A})\\cdot\\hat{\\boldsymbol{z}} = p_z - qA_z$。在对称规范 $\\boldsymbol{A} = \\frac{1}{2}\\boldsymbol{B}\\times\\boldsymbol{r} = \\frac{1}{2} B(\\hat{\\boldsymbol{z}}\\times(x\\hat{\\boldsymbol{x}}+y\\hat{\\boldsymbol{y}}+z\\hat{\\boldsymbol{z}})) = \\frac{B}{2}(-y\\hat{\\boldsymbol{x}}+x\\hat{\\boldsymbol{y}})$ 下，我们看到 $A_z=0$。因此，$\\pi_\\parallel = p_z$，且 $|\\boldsymbol{\\pi}_\\parallel|^2 = p_z^2$。\n哈密顿量变为：\n$$\nH = \\frac{B}{m}\\mu + \\frac{p_z^2}{2m} + q\\varphi(\\boldsymbol{r}, t)\n$$\n现在我们利用其线性性质来计算泊松括号 $\\{H,\\mu\\}$：\n$$\n\\{H, \\mu\\} = \\left\\{\\frac{B}{m}\\mu + \\frac{p_z^2}{2m} + q\\varphi, \\mu\\right\\} = \\frac{B}{m}\\{\\mu, \\mu\\} + \\frac{1}{2m}\\{p_z^2, \\mu\\} + q\\{\\varphi, \\mu\\}\n$$\n第一项消失，因为任何函数与自身的泊松括号为零：$\\{\\mu, \\mu\\}=0$。\n\n对于第二项 $\\{p_z^2, \\mu\\}$，我们使用泊松括号的定义：\n$$\n\\{p_z^2, \\mu\\} = \\sum_{i=1}^3 \\left( \\frac{\\partial (p_z^2)}{\\partial r_i} \\frac{\\partial \\mu}{\\partial p_i} - \\frac{\\partial (p_z^2)}{\\partial p_i} \\frac{\\partial \\mu}{\\partial r_i} \\right)\n$$\n函数 $p_z^2$ 不依赖于位置坐标 $r_i$，所以 $\\frac{\\partial (p_z^2)}{\\partial r_i} = 0$。导数 $\\frac{\\partial (p_z^2)}{\\partial p_i}$ 仅当 $i=z$ 时非零，其值为 $2p_z$。因此：\n$$\n\\{p_z^2, \\mu\\} = - \\frac{\\partial (p_z^2)}{\\partial p_z} \\frac{\\partial \\mu}{\\partial z} = -2p_z \\frac{\\partial \\mu}{\\partial z}\n$$\n磁矩 $\\mu = \\frac{1}{2mB}|\\boldsymbol{\\pi}_\\perp|^2$ 通过 $\\boldsymbol{\\pi}_\\perp = (\\boldsymbol{p}-q\\boldsymbol{A})_\\perp$ 依赖于 $\\boldsymbol{p}_\\perp$ 和 $\\boldsymbol{r}_\\perp$。由于对于均匀场 $\\boldsymbol{B} = B\\hat{\\boldsymbol{z}}$，$\\boldsymbol{A}$ 不依赖于 $z$，因此 $\\mu$ 与坐标 $z$ 无关。所以，$\\frac{\\partial \\mu}{\\partial z} = 0$。这使得第二项 $\\{p_z^2, \\mu\\} = 0$。\n\n我们只剩下第三项：\n$$\n\\{H, \\mu\\} = q\\{\\varphi, \\mu\\}\n$$\n我们显式地计算这个括号。势 $\\varphi$ 仅是 $\\boldsymbol{r}$ 的函数（在给定的时间 $t$），因此它不依赖于动量 $\\boldsymbol{p}$。\n$$\n\\{\\varphi, \\mu\\} = \\sum_{i=1}^3 \\left( \\frac{\\partial \\varphi}{\\partial r_i} \\frac{\\partial \\mu}{\\partial p_i} - \\frac{\\partial \\varphi}{\\partial p_i} \\frac{\\partial \\mu}{\\partial r_i} \\right) = \\sum_{i=1}^3 \\frac{\\partial \\varphi}{\\partial r_i} \\frac{\\partial \\mu}{\\partial p_i}\n$$\n因为 $\\frac{\\partial \\varphi}{\\partial p_i} = 0$。\n$\\mu$ 对动量分量的导数是：\n$$\n\\frac{\\partial \\mu}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left( \\frac{|\\boldsymbol{\\pi}_\\perp|^2}{2mB} \\right) = \\frac{1}{mB} \\boldsymbol{\\pi}_\\perp \\cdot \\frac{\\partial \\boldsymbol{\\pi}_\\perp}{\\partial p_i}\n$$\n由于 $\\boldsymbol{\\pi} = \\boldsymbol{p} - q\\boldsymbol{A}$，我们有 $\\frac{\\partial \\pi_j}{\\partial p_i} = \\delta_{ij}$。对于垂直分量，垂直投影不会改变这一点。因此，对于 $i \\in \\{x,y\\}$，有 $\\frac{\\partial \\boldsymbol{\\pi}_\\perp}{\\partial p_i} = \\hat{\\boldsymbol{e}}_i$。对于 $i=z$，有 $\\frac{\\partial \\boldsymbol{\\pi}_\\perp}{\\partial p_z} = \\boldsymbol{0}$。所以，对于 $i=x,y$，有 $\\frac{\\partial \\mu}{\\partial p_i} = \\frac{\\pi_{\\perp, i}}{mB}$，而对于 $i=z$ 则为 0。\n这得出：\n$$\n\\{\\varphi, \\mu\\} = \\frac{\\partial \\varphi}{\\partial x}\\frac{\\pi_x}{mB} + \\frac{\\partial \\varphi}{\\partial y}\\frac{\\pi_y}{mB} = \\frac{1}{mB} (\\nabla_\\perp \\varphi) \\cdot \\boldsymbol{\\pi}_\\perp\n$$\n其中 $\\boldsymbol{\\pi}_\\perp = \\pi_x\\hat{\\boldsymbol{x}} + \\pi_y\\hat{\\boldsymbol{y}}$ 且 $\\nabla_\\perp\\varphi = \\frac{\\partial \\varphi}{\\partial x}\\hat{\\boldsymbol{x}} + \\frac{\\partial \\varphi}{\\partial y}\\hat{\\boldsymbol{y}}$。\n将其代回，我们得到泊松括号的领头阶表达式：\n$$\n\\{H, \\mu\\} = \\frac{q}{mB} (\\nabla_\\perp \\varphi) \\cdot \\boldsymbol{\\pi}_\\perp\n$$\n使用定义 $\\boldsymbol{v}_\\perp = \\boldsymbol{\\pi}_\\perp/m$ 和 $\\boldsymbol{E}_\\perp = -\\nabla_\\perp \\varphi$，这可以写成：\n$$\n\\{H, \\mu\\} = -\\frac{q}{B} \\boldsymbol{E}_{\\perp} \\cdot \\boldsymbol{v}_{\\perp}\n$$\n问题要求计算回旋角平均值 $\\langle \\{H, \\mu\\} \\rangle$。\n$$\n\\langle \\{H, \\mu\\} \\rangle = \\left\\langle -\\frac{q}{B} \\boldsymbol{E}_{\\perp} \\cdot \\boldsymbol{v}_{\\perp} \\right\\rangle\n$$\n问题说明要将 $\\boldsymbol{E}_{\\perp}$ 视为在拉莫尔轨道上是恒定的。这是 GK 排序 $\\rho/L \\ll 1$ 中的领头阶近似，其中电场在比回旋运动半径 $\\rho$ 大得多的尺度 $L$ 上变化。因此，我们可以将 $\\boldsymbol{E}_{\\perp}$（在导心位置处评估）和常数提到平均算符之外：\n$$\n\\langle \\{H, \\mu\\} \\rangle = -\\frac{q}{B} \\boldsymbol{E}_{\\perp} \\cdot \\langle \\boldsymbol{v}_{\\perp} \\rangle\n$$\n垂直速度矢量 $\\langle \\boldsymbol{v}_{\\perp} \\rangle$ 的回旋角平均是在一个完整的回旋运动中对速度矢量的平均。粒子的垂直速度矢量在速度空间中描绘一个圆。在一个完整的圆形路径上的矢量平均为零。我们可以通过用回旋角 $\\theta \\in [0, 2\\pi]$ 参数化速度来正式地证明这一点：\n$\\boldsymbol{v}_\\perp(\\theta) = v_\\perp(\\cos\\theta \\, \\hat{\\boldsymbol{e}}_1 + \\sin\\theta \\, \\hat{\\boldsymbol{e}}_2)$，其中 $v_\\perp=|\\boldsymbol{v}_\\perp|$ 是恒定的回旋速率，$\\{\\hat{\\boldsymbol{e}}_1, \\hat{\\boldsymbol{e}}_2\\}$ 是垂直于 $\\boldsymbol{B}$ 的平面的一个标准正交基。\n$$\n\\langle \\boldsymbol{v}_{\\perp} \\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} v_\\perp(\\cos\\theta \\, \\hat{\\boldsymbol{e}}_1 + \\sin\\theta \\, \\hat{\\boldsymbol{e}}_2) \\, d\\theta = \\frac{v_\\perp}{2\\pi} \\left( \\hat{\\boldsymbol{e}}_1 \\int_0^{2\\pi}\\cos\\theta \\, d\\theta + \\hat{\\boldsymbol{e}}_2 \\int_0^{2\\pi}\\sin\\theta \\, d\\theta \\right)\n$$\n由于 $\\int_0^{2\\pi}\\cos\\theta \\, d\\theta = [\\sin\\theta]_0^{2\\pi} = 0$ 且 $\\int_0^{2\\pi}\\sin\\theta \\, d\\theta = [-\\cos\\theta]_0^{2\\pi} = 0$，我们发现：\n$$\n\\langle \\boldsymbol{v}_{\\perp} \\rangle = \\boldsymbol{0}\n$$\n将此结果代回 $\\langle \\{H, \\mu\\} \\rangle$ 的表达式中：\n$$\n\\langle \\{H, \\mu\\} \\rangle = -\\frac{q}{B} \\boldsymbol{E}_{\\perp} \\cdot \\boldsymbol{0} = 0\n$$\n这个结果表明，在回旋动理学展开的领头阶，回旋角平均的磁矩是守恒的，这是绝热不变量的定义。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "从单个粒子过渡到整个等离子体系统，无碰撞回旋动理学模型会守恒一个被称为自由能 $W$ 的量。这个实践将我们的重点从解析推导转向计算验证，这是现代等离子体物理学中的一项关键技能。通过实现一个简单的数值模拟，您将证实一个设计良好的谱方法能够在机器精度内保持 $W$ 守恒，从而建立对用于研究湍流的数值工具的信心 。",
            "id": "4184696",
            "problem": "考虑一个由 $s$ 索引的粒子种类集合，在回旋动理学 (GK) 模型中的无碰撞、静电、均匀平板几何。令 $g_s(\\mathbf{k},t)$ 表示谱空间中分布函数的非绝热部分，其中 $\\mathbf{k}$ 是波矢，$t$ 是时间。在没有源、汇、碰撞和场耦合的情况下，一个简单平板模式的线性化动力学可以表示为\n$$\n\\partial_t g_s(\\mathbf{k},t) = i\\,\\Omega_s(\\mathbf{k})\\,g_s(\\mathbf{k},t),\n$$\n其中 $\\Omega_s(\\mathbf{k})$ 是一个实值频率，它编码了依赖于粒子种类的线性相位演化。该算子是反厄米的，因此是保范的。\n\n在此简化设定中，将回旋动理学自由能（也称为 GK 不变量或二次不变量）定义为\n$$\nW(t) = \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2}\\,\\left|g_s(\\mathbf{k},t)\\right|^2,\n$$\n其中 $\\alpha_s>0$ 是依赖于粒子种类的归一化权重，其吸收了速度空间积分和适用于该归一化的任何平衡标度。对于上述动力学，$W(t)$ 在连续模型中必须精确守恒，并且在一个将每个模式乘以一个模为一的相位因子的谱时间推进中，在舍入误差范围内守恒。\n\n从无碰撞静电 GK 演化是哈密顿的，以及均匀平板的线性算子是反厄米的（幺正时间演化）这一基本前提​​出发，推导为何 $W(t)$ 是守恒的，并使用谱时间推进实现数值验证。您的程序必须：\n- 对于每个粒子种类 $s$ 和离散波矢集合 $\\mathbf{k}$，将 $g_s(\\mathbf{k},0)$ 初始化为复振幅。\n- 使用精确谱更新来推进解\n$$\ng_s(\\mathbf{k},t+\\Delta t) \\leftarrow e^{i\\,\\Omega_s(\\mathbf{k})\\,\\Delta t}\\,g_s(\\mathbf{k},t),\n$$\n对于给定的时间步长 $\\Delta t$ 和步数 $N$。\n- 在每一步计算 $W(t)$，并返回在整个积分过程中与初始值 $W(0)$ 的最大绝对偏差，即：\n$$\n\\max_{0\\le n\\le N} \\left| W(n\\,\\Delta t) - W(0) \\right|.\n$$\n\n全程使用无量纲归一化单位。所有输出都是不带物理单位的纯数。\n\n您的程序应运行以下测试套件。对于每种情况，输出必须是表示上述定义的最大绝对偏差的浮点数。\n\n- 情况1（通用多粒子种类，多模式）：\n    - 粒子种类数：$S=2$\n    - 权重：$\\alpha_1=1.0$, $\\alpha_2=0.7$\n    - 频率：$\\Omega_1(k)=0.5\\,k$, $\\Omega_2(k)=1.0\\,k$\n    - 模式：$k$ 在 $[-3.2,3.2]$ 上均匀分布，共 $N_k=64$ 个\n    - 时间步长：$\\Delta t=10^{-3}$\n    - 步数：$N=5000$\n    - 初始条件：$g_s(k,0)$ 从零均值、单位方差的复高斯分布中抽取，缩放因子为 $0.1$，使用确定性伪随机数生成器种子 $42$。\n\n- 情况2（边界情况，零场）：\n    - 粒子种类数：$S=1$\n    - 权重：$\\alpha_1=1.0$\n    - 频率：$\\Omega_1(k)=0.75\\,k$\n    - 模式：$k$ 在 $[-1.55,1.55]$ 上均匀分布，共 $N_k=32$ 个\n    - 时间步长：$\\Delta t=2\\times 10^{-3}$\n    - 步数：$N=1000$\n    - 初始条件：对于所有 $k$，$g_1(k,0)=0$。\n\n- 情况3（边缘情况，单个快速振荡模式）：\n    - 粒子种类数：$S=1$\n    - 权重：$\\alpha_1=2.0$\n    - 频率：$\\Omega_1(k)=10^{6}\\,k$\n    - 模式：单个模式 $k=1$\n    - 时间步长：$\\Delta t=10^{-6}$\n    - 步数：$N=100000$\n    - 初始条件：$g_1(k,0)=1+i$。\n\n- 情况4（多粒子种类，中等数量模式，小时间步长）：\n    - 粒子种类数：$S=3$\n    - 权重：$\\alpha_1=1.0$, $\\alpha_2=0.5$, $\\alpha_3=1.3$\n    - 频率：$\\Omega_1(k)=0.2\\,k$, $\\Omega_2(k)=0.9\\,k$, $\\Omega_3(k)=1.5\\,k$\n    - 模式：$k$ 在 $[-2.35,2.35]$ 上均匀分布，共 $N_k=48$ 个\n    - 时间步长：$\\Delta t=10^{-4}$\n    - 步数：$N=20000$\n    - 初始条件：$g_s(k,0)$ 从零均值、单位方差的复高斯分布中抽取，缩放因子为 $0.05$，使用确定性伪随机数生成器种子 $7$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4]”）。这四个浮点数必须按顺序是情况1到情况4的最大绝对偏差。所有值都是无量纲的。不应打印任何其他文本。",
            "solution": "用户提供的问题经评估为有效。它以等离子体物理（特别是回旋动理学模型）的原理为科学基础，在数学上是自洽的，并提供了一个良定的、客观的挑战。问题陈述是完整的，为获得唯一解提供了所有必要的数据和条件。它要求对一个守恒律进行理论推导并进行数值验证，这是计算科学中一个标准且有意义的任务。\n\n推导和实施计划如下。首先，我们将从控制演化方程推导出回旋动理学自由能 $W(t)$ 的守恒性。其次，我们将证明所提出的数值时间推进方案在理想算术中也精确地守恒该量。最后，我们将实施一个数值模拟，以计算由于浮点运算而导致该守恒律对指定测试用例产生的最大偏差。\n\n**$W(t)$ 守恒的理论推导**\n\n问题将回旋动理学自由能定义为：\n$$\nW(t) = \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2}\\,\\left|g_s(\\mathbf{k},t)\\right|^2\n$$\n其中 $g_s(\\mathbf{k},t)$ 是一个复值函数，$\\alpha_s > 0$ 是实的正常量。我们可以将模的平方写为 $|g_s|^2 = g_s g_s^*$，其中 $g_s^*$ 是 $g_s$ 的复共轭。\n$$\nW(t) = \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2}\\, g_s(\\mathbf{k},t) g_s^*(\\mathbf{k},t)\n$$\n为了证明 $W(t)$ 是一个守恒量，我们必须证明其时间导数为零，即 $\\frac{dW}{dt} = 0$。我们计算 $W(t)$ 对时间 $t$ 的导数：\n$$\n\\frac{dW}{dt} = \\frac{d}{dt} \\left( \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2}\\, g_s g_s^* \\right)\n$$\n由于求和与常数都与时间无关，我们可以将导数移到内部：\n$$\n\\frac{dW}{dt} = \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2}\\, \\frac{d}{dt} \\left( g_s g_s^* \\right)\n$$\n使用求导的乘法法则，我们有：\n$$\n\\frac{d}{dt} \\left( g_s g_s^* \\right) = \\left( \\frac{\\partial g_s}{\\partial t} \\right) g_s^* + g_s \\left( \\frac{\\partial g_s^*}{\\partial t} \\right)\n$$\n问题陈述了线性化动力学由下式给出：\n$$\n\\frac{\\partial g_s(\\mathbf{k},t)}{\\partial t} = i\\,\\Omega_s(\\mathbf{k})\\,g_s(\\mathbf{k},t)\n$$\n其中 $\\Omega_s(\\mathbf{k})$ 是一个实值频率。复共轭 $g_s^*$ 的时间导数可以通过对整个方程取共轭得到：\n$$\n\\frac{\\partial g_s^*}{\\partial t} = \\left( i\\,\\Omega_s\\,g_s \\right)^* = -i\\,\\Omega_s^*\\,g_s^*\n$$\n由于 $\\Omega_s$ 是实数，因此 $\\Omega_s^* = \\Omega_s$。所以：\n$$\n\\frac{\\partial g_s^*}{\\partial t} = -i\\,\\Omega_s\\,g_s^*\n$$\n现在，我们将这些表达式代回到 $|g_s|^2$ 的导数中：\n$$\n\\frac{d}{dt} |g_s|^2 = (i\\,\\Omega_s\\,g_s) g_s^* + g_s (-i\\,\\Omega_s\\,g_s^*) = i\\,\\Omega_s\\,g_s g_s^* - i\\,\\Omega_s\\,g_s g_s^* = i\\,\\Omega_s |g_s|^2 - i\\,\\Omega_s |g_s|^2 = 0\n$$\n由于对于每个粒子种类 $s$ 和波矢 $\\mathbf{k}$， $|g_s(\\mathbf{k}, t)|^2$ 的时间导数都为零，因此总能量 $W(t)$ 的时间导数也为零：\n$$\n\\frac{dW}{dt} = \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2} \\cdot 0 = 0\n$$\n这证实了 $W(t)$ 是连续系统的一个运动不变量。\n\n**数值方案中的守恒性**\n\n指定的数值更新规则是一个精确的谱时间推进：\n$$\ng_s(\\mathbf{k},t+\\Delta t) = e^{i\\,\\Omega_s(\\mathbf{k})\\,\\Delta t}\\,g_s(\\mathbf{k},t)\n$$\n让我们考察一个时间步长后 $g_s$ 的模的平方：\n$$\n|g_s(\\mathbf{k},t+\\Delta t)|^2 = \\left| e^{i\\,\\Omega_s(\\mathbf{k})\\,\\Delta t}\\,g_s(\\mathbf{k},t) \\right|^2\n$$\n对于复数 $a$ 和 $b$，使用性质 $|ab|^2 = |a|^2 |b|^2$：\n$$\n|g_s(\\mathbf{k},t+\\Delta t)|^2 = \\left| e^{i\\,\\Omega_s(\\mathbf{k})\\,\\Delta t} \\right|^2 \\left| g_s(\\mathbf{k},t) \\right|^2\n$$\n项 $e^{i\\,\\Omega_s(\\mathbf{k})\\,\\Delta t}$ 是一个复相位因子。由于 $\\Omega_s$ 和 $\\Delta t$ 都是实数，令 $\\theta = \\Omega_s(\\mathbf{k})\\,\\Delta t$。$e^{i\\theta}$ 的模由下式给出：\n$$\n|e^{i\\theta}| = |\\cos(\\theta) + i\\sin(\\theta)| = \\sqrt{\\cos^2(\\theta) + \\sin^2(\\theta)} = \\sqrt{1} = 1\n$$\n因此，$|e^{i\\,\\Omega_s(\\mathbf{k})\\,\\Delta t}|^2 = 1^2 = 1$。将其代回，我们发现：\n$$\n|g_s(\\mathbf{k},t+\\Delta t)|^2 = 1 \\cdot |g_s(\\mathbf{k},t)|^2 = |g_s(\\mathbf{k},t)|^2\n$$\n这表明在数值积分的每一步中，每个谱分量 $g_s(\\mathbf{k})$ 的大小都是守恒的。因此，总能量 $W(t)$ 也被此方案所守恒：\n$$\nW(t+\\Delta t) = \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2}\\,\\left|g_s(\\mathbf{k},t+\\Delta t)\\right|^2 = \\sum_{s} \\alpha_s \\sum_{\\mathbf{k}} \\frac{1}{2}\\,\\left|g_s(\\mathbf{k},t)\\right|^2 = W(t)\n$$\n在理想算术中，偏差 $W(n\\Delta t) - W(0)$ 将精确为零。数值实现将计算由有限精度浮点运算引起的微小但非零的偏差。\n\n**实施策略**\n\n对于每个测试用例，数值求解将包括以下步骤：\n1.  初始化波矢 $\\mathbf{k}$ 的计算网格（表示为一维数组 $k$）。\n2.  根据指定的初始条件，为所有粒子种类 $s$ 和波矢 $k$ 初始化复振幅 $g_s(k,0)$。\n3.  计算初始自由能 $W(0)$。\n4.  为所有 $s$ 和 $k$ 预计算复相位因子 $e^{i\\,\\Omega_s(k)\\,\\Delta t}$。这些因子在整个模拟过程中是恒定的。\n5.  迭代 $N$ 个时间步。在每一步中：\n    a. 更新振幅：$g_s(k, t+\\Delta t) = e^{i\\,\\Omega_s(k)\\,\\Delta t} g_s(k, t)$。\n    b. 计算当前能量 $W(t+\\Delta t)$。\n    c. 计算绝对偏差 $|W(t+\\Delta t) - W(0)|$ 并更新迄今为止发现的最大偏差。\n6.  返回在整个模拟过程中观察到的最大绝对偏差。\n\n所有计算将使用 `numpy` 进行高效的数组操作，并使用 `numpy.complex128` 进行高精度复数计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(s_count, alphas, omega_funcs, k_array, dt, N, ic_params):\n    \"\"\"\n    Runs a single gyrokinetic simulation case and returns the max energy deviation.\n    \"\"\"\n    nk = len(k_array)\n    g = np.zeros((s_count, nk), dtype=np.complex128)\n\n    # 1. Set up initial conditions g_s(k, 0)\n    ic_type = ic_params.get('type')\n    if ic_type == 'gaussian':\n        seed = ic_params['seed']\n        scale = ic_params['scale']\n        rng = np.random.default_rng(seed)\n        # Generate complex random numbers where real and imaginary parts\n        # are drawn from a standard normal distribution.\n        real_part = rng.normal(loc=0.0, scale=1.0, size=(s_count, nk))\n        imag_part = rng.normal(loc=0.0, scale=1.0, size=(s_count, nk))\n        g = (real_part + 1j * imag_part) * scale\n    elif ic_type == 'zero':\n        # g is already initialized to zeros\n        pass\n    elif ic_type == 'fixed':\n        # Ensure value is broadcastable to the shape of g\n        g[:, :] = np.array(ic_params['value'], dtype=np.complex128)\n\n    # 2. Reshape alphas for broadcasting\n    alphas_b = np.array(alphas, dtype=np.float64).reshape(s_count, 1)\n\n    # 3. Calculate initial energy W(0)\n    # W(t) = sum_s alpha_s sum_k 0.5 * |g_s(k, t)|^2\n    g_abs_sq_0 = np.abs(g)**2\n    w0 = 0.5 * np.sum(alphas_b * g_abs_sq_0)\n    \n    if w0 == 0.0:\n        # If initial energy is zero, it should remain zero.\n        # Any numerical artifact would be on the order of machine epsilon,\n        # but for this specific update rule, it should be exactly zero.\n        return 0.0\n\n    # 4. Pre-compute update factors\n    update_factors = np.zeros((s_count, nk), dtype=np.complex128)\n    for s in range(s_count):\n        omega_s_k = omega_funcs[s](k_array)\n        update_factors[s, :] = np.exp(1j * omega_s_k * dt)\n\n    # 5. Time evolution loop\n    max_deviation = 0.0\n    for _ in range(N):\n        # Update g(k, t) for all s and k\n        g = update_factors * g\n\n        # Calculate current energy W(t)\n        g_abs_sq_n = np.abs(g)**2\n        wn = 0.5 * np.sum(alphas_b * g_abs_sq_n)\n        \n        # Calculate deviation and update maximum\n        deviation = np.abs(wn - w0)\n        if deviation > max_deviation:\n            max_deviation = deviation\n\n    return max_deviation\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the gyrokinetic conservation problem.\n    \"\"\"\n    test_cases = [\n        {  # Case 1\n            \"s_count\": 2, \"alphas\": [1.0, 0.7],\n            \"omega_funcs\": [lambda k: 0.5 * k, lambda k: 1.0 * k],\n            \"k_array\": np.linspace(-3.2, 3.2, 64, dtype=np.float64),\n            \"dt\": 1e-3, \"N\": 5000,\n            \"ic_params\": {\"type\": \"gaussian\", \"seed\": 42, \"scale\": 0.1}\n        },\n        {  # Case 2\n            \"s_count\": 1, \"alphas\": [1.0],\n            \"omega_funcs\": [lambda k: 0.75 * k],\n            \"k_array\": np.linspace(-1.55, 1.55, 32, dtype=np.float64),\n            \"dt\": 2e-3, \"N\": 1000,\n            \"ic_params\": {\"type\": \"zero\"}\n        },\n        {  # Case 3\n            \"s_count\": 1, \"alphas\": [2.0],\n            \"omega_funcs\": [lambda k: 1e6 * k],\n            \"k_array\": np.array([1.0], dtype=np.float64),\n            \"dt\": 1e-6, \"N\": 100000,\n            \"ic_params\": {\"type\": \"fixed\", \"value\": 1.0 + 1.0j}\n        },\n        {  # Case 4\n            \"s_count\": 3, \"alphas\": [1.0, 0.5, 1.3],\n            \"omega_funcs\": [\n                lambda k: 0.2 * k,\n                lambda k: 0.9 * k,\n                lambda k: 1.5 * k\n            ],\n            \"k_array\": np.linspace(-2.35, 2.35, 48, dtype=np.float64),\n            \"dt\": 1e-4, \"N\": 20000,\n            \"ic_params\": {\"type\": \"gaussian\", \"seed\": 7, \"scale\": 0.05}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(\n            s_count=case[\"s_count\"],\n            alphas=case[\"alphas\"],\n            omega_funcs=case[\"omega_funcs\"],\n            k_array=case[\"k_array\"],\n            dt=case[\"dt\"],\n            N=case[\"N\"],\n            ic_params=case[\"ic_params\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.17e}' for r in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "守恒律不仅仅是数学上的约束，它们从根本上支配着湍流系统的动力学。本问题探讨了拥有多个不变量所带来的最深远的影响之一：双级串。利用量纲分析，您将确定自由能 $W$ 和静电能 $E_{\\phi}$ 如何在波数空间的不同尺度上流动，从而揭示回旋动理学湍流中能量输运的内在机制 。",
            "id": "4184686",
            "problem": "考虑在强匀磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 中，具有绝热电子的离子的静电、无碰撞、板块回旋动理学（GK）湍流。离子回旋动理学分布函数为 $g(\\mathbf{R}, v_{\\parallel}, \\mu, t)$，静电势为 $\\phi(\\mathbf{r}, t)$。非线性项是回旋中心坐标 $\\mathbf{R}$ 中的 $\\mathbf{E} \\times \\mathbf{B}$ 平流，它在垂直于 $\\mathbf{B}_0$ 的平面内是二维且不可压缩的。在傅里叶空间中，垂直波数为 $\\mathbf{k}_{\\perp}$，其大小为 $k \\equiv |\\mathbf{k}_{\\perp}|$。假设湍流是均匀的，并在单一垂直波数 $k_0$ 处有窄带注入，并考虑惯性区 $k \\in (k_{\\min}, k_{\\max})$，在该区域内线性项、源和耗散均可忽略不计。\n\n回旋动理学非线性平流守恒二次总自由能，\n$$\nW \\equiv \\int d^3\\mathbf{R} \\int dv_{\\parallel} \\, d\\mu \\, \\frac{|g|^{2}}{2} \\;+\\; \\sum_{\\mathbf{k}} \\left[ \\frac{n_0 T_i}{2} \\left(1 - \\Gamma_0(b_{\\mathbf{k}})\\right) |\\phi_{\\mathbf{k}}|^{2} \\;+\\; \\frac{n_0 e^{2}}{2 T_e} |\\phi_{\\mathbf{k}}|^{2} \\right],\n$$\n其中 $n_0$ 是背景密度，$T_i$ 和 $T_e$ 分别是离子和电子的温度，$e$ 是元电荷，$b_{\\mathbf{k}} \\equiv k^{2} \\rho_i^{2}/2$，$\\rho_i$ 是离子回旋半径，$\\Gamma_0(b) \\equiv I_0(b) \\exp(-b)$，$I_0$ 是第一类修正Bessel函数。在长波极限 $k \\rho_i \\ll 1$下，使用 $1 - \\Gamma_0(b_{\\mathbf{k}}) \\approx b_{\\mathbf{k}}$，因此离子极化对 $W$ 的贡献与 $k^{2} |\\phi_{\\mathbf{k}}|^{2}$ 成标度关系。与绝热电子响应相关的静电能，\n$$\nE_{\\phi} \\equiv \\sum_{\\mathbf{k}} \\frac{n_0 e^{2}}{2 T_e} |\\phi_{\\mathbf{k}}|^{2},\n$$\n也是非线性平流的一个二次不变量。\n\n设在尺度 $k$ 上的非线性输运时间通过对 $\\mathbf{E} \\times \\mathbf{B}$ 非线性的量纲分析估算为\n$$\n\\tau_{k} \\sim \\frac{1}{k u_{E,k}}, \\qquad u_{E,k} \\sim \\frac{c}{B_0} k |\\phi_{k}|,\n$$\n因此 $\\tau_{k} \\sim \\frac{B_0}{c} \\frac{1}{k^{2} |\\phi_{k}|}$，其中 $c$ 是光速。惯性区由级串不变量的常数通量定义。\n\n采用以下通量符号约定：一个二次不变量 $X$ 穿过截断波数 $k_c$ 的谱通量 $\\Pi_{X}(k_c)$，如果净输运指向 $k > k_c$ 的模式，则为正；如果指向 $k < k_c$ 的模式，则为负。\n\n仅使用以下条件：\n- 垂直平面内非线性 $\\mathbf{E} \\times \\mathbf{B}$ 平流的不可压缩二维结构；\n- 二次不变量 $W$ 和 $E_{\\phi}$ 及其在长波极限下的 $k$ 标度关系；\n- 非线性时间 $\\tau_k$ 的量纲分析；\n\n确定在惯性区内，对于满足 $k_c > k_0$ 的截断波数 $k_c$，谱通量 $\\Pi_{W}(k_c)$ 的符号。如果通量指向 $k > k_c$（正向级串），则最终答案表示为 $+1$；如果通量指向 $k < k_c$（反向级串），则表示为 $-1$。最终答案中不允许包含中间论证或定性描述。无需单位。",
            "solution": "在继续之前，对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- **系统：** 具有绝热电子的离子的静电、无碰撞、板块回旋动理学（GK）湍流。\n- **磁场：** $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，强匀磁场。\n- **关键变量：** 离子回旋动理学分布函数 $g(\\mathbf{R}, v_{\\parallel}, \\mu, t)$，静电势 $\\phi(\\mathbf{r}, t)$。\n- **非线性：** 回旋中心坐标 $\\mathbf{R}$ 中的 $\\mathbf{E} \\times \\mathbf{B}$ 平流，在垂直于 $\\mathbf{B}_0$ 的平面内是二维且不可压缩的。\n- **湍流条件：** 在单一垂直波数 $k_0$ 处有窄带注入的均匀湍流。\n- **惯性区：** $k \\in (k_{\\min}, k_{\\max})$，其中 $k \\equiv |\\mathbf{k}_{\\perp}|$，且线性项、源和耗散可忽略不计。\n- **第一个二次不变量（总自由能）：**\n$$W \\equiv \\int d^3\\mathbf{R} \\int dv_{\\parallel} \\, d\\mu \\, \\frac{|g|^{2}}{2} \\;+\\; \\sum_{\\mathbf{k}} \\left[ \\frac{n_0 T_i}{2} \\left(1 - \\Gamma_0(b_{\\mathbf{k}})\\right) |\\phi_{\\mathbf{k}}|^{2} \\;+\\; \\frac{n_0 e^{2}}{2 T_e} |\\phi_{\\mathbf{k}}|^{2} \\right]$$\n- **第二个二次不变量（静电能）：**\n$$E_{\\phi} \\equiv \\sum_{\\mathbf{k}} \\frac{n_0 e^{2}}{2 T_e} |\\phi_{\\mathbf{k}}|^{2}$$\n- **定义：** $n_0$（背景密度），$T_i, T_e$（温度），$e$（元电荷），$b_{\\mathbf{k}} \\equiv k^{2} \\rho_i^{2}/2$，$\\rho_i$（离子回旋半径），$\\Gamma_0(b) \\equiv I_0(b) \\exp(-b)$。\n- **近似：** 在长波极限 $k \\rho_i \\ll 1$ 下，$1 - \\Gamma_0(b_{\\mathbf{k}}) \\approx b_{\\mathbf{k}}$。\n- **非线性时间：** $\\tau_{k} \\sim \\frac{B_0}{c} \\frac{1}{k^{2} |\\phi_{k}|}$。\n- **通量约定：** 对于向 $k > k_c$ 的净输运（正向级串），$\\Pi_{X}(k_c) > 0$；对于向 $k < k_c$ 的净输运（反向级串），$\\Pi_{X}(k_c) < 0$。\n- **问题：** 确定当 $k_c > k_0$ 时 $\\Pi_{W}(k_c)$ 的符号，用 $+1$ 或 $-1$ 表示。\n- **约束：** 仅使用二维不可压缩平流、两个不变量及其标度关系，以及 $\\tau_k$ 的量纲分析。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了等离子体湍流理论中一个基于回旋动理学模型的标准、适定的问题。关于系统、主导的非线性动力学（$\\mathbf{E} \\times \\mathbf{B}$ 平流）以及守恒量的描述与该主题的既有文献一致。在类二维湍流中，由多个守恒量导致的双级串概念是统计流体动力学和等离子体物理学中的一个基本原理。该问题提供了所有必要信息（两个不同的二次不变量及其标度关系），并且没有内部矛盾、歧义或事实错误。推理过程的约束条件已明确说明。因此，该问题被视为**有效**。\n\n**步骤 3：进行求解**\n该问题描述了一个由不可压缩的二维平流非线性驱动的湍流系统。当这类系统守恒多个二次量时，其一个关键特征是双级串现象。每个守恒量的谱通量方向由其与波数 $k$ 的相对标度关系决定。\n\n我们已知非线性动力学的两个二次不变量：总自由能 $W$ 和静电能 $E_{\\phi}$。我们定义它们的谱密度 $\\mathcal{E}_W(k)$ 和 $\\mathcal{E}_{E_{\\phi}}(k)$，它们表示波数 $k$ 附近壳层中的模式对总不变量的贡献。\n\n静电能由下式给出：\n$$E_{\\phi} = \\sum_{\\mathbf{k}} \\frac{n_0 e^{2}}{2 T_e} |\\phi_{\\mathbf{k}}|^{2}$$\n假设在垂直平面内是各向同性的，我们可以将其谱密度写为 $k=|\\mathbf{k}_\\perp|$ 的函数。对每个模式 $\\mathbf{k}$ 求和的项与 $|\\phi_{\\mathbf{k}}|^2$ 成标度关系。因此，$E_{\\phi}$ 的谱密度为：\n$$\\mathcal{E}_{E_{\\phi}}(k) \\propto |\\phi_{k}|^{2}$$\n\n总自由能为：\n$$W = \\int d^3\\mathbf{R} \\int dv_{\\parallel} \\, d\\mu \\, \\frac{|g|^{2}}{2} \\;+\\; \\sum_{\\mathbf{k}} \\left[ \\frac{n_0 T_i}{2} \\left(1 - \\Gamma_0(b_{\\mathbf{k}})\\right) |\\phi_{\\mathbf{k}}|^{2} \\;+\\; \\frac{n_0 e^{2}}{2 T_e} |\\phi_{\\mathbf{k}}|^{2} \\right]$$\n其谱密度 $\\mathcal{E}_W(k)$ 是其三个组成部分谱密度的总和：离子熵（来自 $g$）、离子极化能和电子静电能。\n\n我们在长波极限（$k \\rho_i \\ll 1$）下分析每个部分的 $k$ 标度关系：\n1.  **离子熵：** 涉及回旋动理学分布函数的项 $\\int d^3\\mathbf{R} \\int d\\mathbf{v} \\dots |g|^2/2$ 可以写成傅里叶模式的和 $\\sum_{\\mathbf{k}} \\mathcal{E}_{g}(k)$。在回旋动理学模型的长波静电极限下，非绝热分布函数 $g_k$ 在主导阶上与势 $\\phi_k$ 成正比。因此，其谱密度标度为 $\\mathcal{E}_{g}(k) \\propto |\\phi_k|^2$。\n\n2.  **离子极化能：** 对于此项，我们使用给定的近似 $1 - \\Gamma_0(b_{\\mathbf{k}}) \\approx b_{\\mathbf{k}} = k^2\\rho_i^2/2$。因此，该项的谱密度为：\n$$\\mathcal{E}_{\\text{pol}}(k) \\propto k^2 |\\phi_k|^2$$\n\n3.  **电子静电能：** 这正是 $E_{\\phi}$ 的谱密度，其标度关系为 $\\mathcal{E}_{e}(k) \\propto |\\phi_k|^2$。\n\n结合这些分量，总自由能 $W$ 的谱密度为：\n$$\\mathcal{E}_W(k) = \\mathcal{E}_{g}(k) + \\mathcal{E}_{\\text{pol}}(k) + \\mathcal{E}_{e}(k)$$\n$$\\mathcal{E}_W(k) \\propto C_g |\\phi_k|^2 + C_{\\text{pol}} k^2 |\\phi_k|^2 + C_e |\\phi_k|^2$$\n其中 $C_g$、$C_{\\text{pol}}$ 和 $C_e$ 是从物理参数导出的正常数。这可以写成：\n$$\\mathcal{E}_W(k) \\propto (A + B k^2) |\\phi_k|^2$$\n其中 $A = C_g + C_e > 0$ 且 $B = C_{\\text{pol}} > 0$。\n\n现在我们应用双级串理论。每个不变量的级串方向由其在波数空间中的相对集中度决定。我们考察两个不变量 $W$ 和 $E_{\\phi}$ 的谱密度之比：\n$$\\frac{\\mathcal{E}_W(k)}{\\mathcal{E}_{E_{\\phi}}(k)} \\propto \\frac{(A + B k^2) |\\phi_k|^2}{|\\phi_k|^2} = A + B k^2$$\n该比值是 $k$ 的单调递增函数。这意味着与不变量 $E_{\\phi}$ 相比，不变量 $W$ 在高波数（小空间尺度）处权重更大。\n\n在由单一尺度 $k_0$ 处的强迫驱动的双级串中，在高 $k$ 处权重更大的不变量（此处为 $W$）经历向 $k > k_0$ 的正向级串。在低 $k$ 处权重更大的不变量（此处为 $E_{\\phi}$）经历向 $k < k_0$ 的反向级串。\n\n问题要求给出当截断波数 $k_c > k_0$ 时谱通量 $\\Pi_W(k_c)$ 的符号。由于 $W$ 经历正向级串，存在从低于 $k_c$ 的波数向高于 $k_c$ 的波数的净输运。根据问题的符号约定，这种指向 $k > k_c$ 模式的通量为正。因此，$\\Pi_W(k_c) > 0$。\n\n问题要求答案以 $+1$ 表示正向级串（正通量），以 $-1$ 表示反向级串（负通量）。$W$ 的通量为正。",
            "answer": "$$\n\\boxed{+1}\n$$"
        }
    ]
}