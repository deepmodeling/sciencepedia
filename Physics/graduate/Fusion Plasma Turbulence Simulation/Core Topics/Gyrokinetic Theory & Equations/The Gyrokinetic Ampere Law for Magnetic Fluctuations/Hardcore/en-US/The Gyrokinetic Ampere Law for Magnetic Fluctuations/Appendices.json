{
    "hands_on_practices": [
        {
            "introduction": "Our study of magnetic fluctuations in gyrokinetics begins with a crucial simplification of the full Ampere-Maxwell law. This first practice provides a rigorous foundation for this approximation by guiding you through a scaling analysis to compare the displacement current with the plasma's conduction current. By completing this exercise , you will derive the precise condition under which the displacement current can be safely neglected, a cornerstone of the gyrokinetic model for low-frequency electromagnetic turbulence.",
            "id": "4203838",
            "problem": "Consider a homogeneous, magnetized, quasi-neutral, collisionless plasma with singly charged ions and electrons in the gyrokinetic (GK) regime, characterized by low-frequency, anisotropic fluctuations with $|\\omega| \\ll \\Omega_{i}$, $k_{\\parallel} \\ll k_{\\perp}$, and small-amplitude electromagnetic perturbations $\\delta \\mathbf{E}$ and $\\delta \\mathbf{B}$. Start from the full Ampere–Maxwell law,\n$$\n\\nabla \\times \\delta \\mathbf{B} = \\mu_{0} \\delta \\mathbf{j} + \\mu_{0} \\epsilon_{0} \\frac{\\partial \\delta \\mathbf{E}}{\\partial t},\n$$\nand consider the ratio of the displacement current density to the conduction current density,\n$$\n\\mathcal{R} \\equiv \\frac{\\left|\\epsilon_{0} \\, \\partial_{t} \\delta \\mathbf{E}\\right|}{\\left|\\delta \\mathbf{j}\\right|}.\n$$\nAssume the conduction current is dominated by the electron response on the fluctuation timescale, with electron dynamics governed by Newton’s second law (neglecting collisions and pressure gradients at leading order) and the ions providing quasi-neutrality. You may use the definition of the electron plasma frequency $\\omega_{pe} \\equiv \\sqrt{n_{0} e^{2}/(\\epsilon_{0} m_{e})}$, where $n_{0}$ is the equilibrium electron density, $e$ is the elementary charge, and $m_{e}$ is the electron mass.\n\nDerive a closed-form leading-order expression for $\\mathcal{R}$ in terms of the ratio $\\omega/\\omega_{pe}$. Then, using your expression, identify the asymptotic condition on $\\omega/\\omega_{pe}$ under which the displacement current is negligible in the GK Ampere’s law for magnetic fluctuations. Express your final answer as the analytic expression for $\\mathcal{R}$ in terms of $\\omega/\\omega_{pe}$. No numerical evaluation is required. Do not include inequalities in the final answer.",
            "solution": "We begin from the Ampere–Maxwell law for the fluctuating fields,\n$$\n\\nabla \\times \\delta \\mathbf{B} = \\mu_{0} \\delta \\mathbf{j} + \\mu_{0} \\epsilon_{0} \\frac{\\partial \\delta \\mathbf{E}}{\\partial t}.\n$$\nTo assess when the displacement current can be neglected relative to the conduction current, we form the dimensionless ratio\n$$\n\\mathcal{R} \\equiv \\frac{\\left|\\epsilon_{0} \\, \\partial_{t} \\delta \\mathbf{E}\\right|}{\\left|\\delta \\mathbf{j}\\right|}.\n$$\nUnder gyrokinetic ordering, fluctuations are low-frequency and the conduction current is dominated by electrons on the fluctuation timescale. We model the electron response using Newton’s second law for the bulk electron fluid, linearized and neglecting collisions and pressure gradients at leading order,\n$$\nm_{e} n_{0} \\frac{\\partial \\delta \\mathbf{v}_{e}}{\\partial t} = - n_{0} e \\, \\delta \\mathbf{E}.\n$$\nAssuming a harmonic time dependence $\\propto \\exp(- i \\omega t)$, we have $\\partial_{t} \\to - i \\omega$, so\n$$\n- i \\omega \\, m_{e} n_{0} \\, \\delta \\mathbf{v}_{e} = - n_{0} e \\, \\delta \\mathbf{E}\n\\quad \\Rightarrow \\quad\n\\delta \\mathbf{v}_{e} = \\frac{e}{i \\, m_{e} \\, \\omega} \\, \\delta \\mathbf{E}.\n$$\nThe electron conduction current is $\\delta \\mathbf{j} = - n_{0} e \\, \\delta \\mathbf{v}_{e}$, giving\n$$\n\\delta \\mathbf{j} = - n_{0} e \\left( \\frac{e}{i \\, m_{e} \\, \\omega} \\, \\delta \\mathbf{E} \\right) = \\frac{i \\, n_{0} e^{2}}{m_{e} \\, \\omega} \\, \\delta \\mathbf{E}.\n$$\nTaking magnitudes,\n$$\n|\\delta \\mathbf{j}| = \\frac{n_{0} e^{2}}{m_{e} \\, |\\omega|} \\, |\\delta \\mathbf{E}|.\n$$\nThe magnitude of the displacement current density is\n$$\n\\left| \\epsilon_{0} \\, \\partial_{t} \\delta \\mathbf{E} \\right| = \\epsilon_{0} \\, |\\omega| \\, |\\delta \\mathbf{E}|.\n$$\nTherefore,\n$$\n\\mathcal{R} = \\frac{\\epsilon_{0} \\, |\\omega| \\, |\\delta \\mathbf{E}|}{\\left(n_{0} e^{2}/(m_{e} \\, |\\omega|)\\right) \\, |\\delta \\mathbf{E}|}\n= \\frac{\\epsilon_{0} \\, m_{e} \\, \\omega^{2}}{n_{0} e^{2}}.\n$$\nUsing the definition of the electron plasma frequency,\n$$\n\\omega_{pe}^{2} \\equiv \\frac{n_{0} e^{2}}{\\epsilon_{0} m_{e}},\n$$\nwe obtain\n$$\n\\mathcal{R} = \\frac{\\omega^{2}}{\\omega_{pe}^{2}}.\n$$\nHence, the displacement current is negligible when $\\mathcal{R} \\ll 1$, i.e., when $|\\omega|/\\omega_{pe} \\ll 1$, which is consistent with the gyrokinetic low-frequency ordering in fusion plasmas. The requested final analytic expression for $\\mathcal{R}$ is thus\n$$\n\\mathcal{R} = \\left( \\frac{\\omega}{\\omega_{pe}} \\right)^{2}.\n$$",
            "answer": "$$\\boxed{\\left(\\frac{\\omega}{\\omega_{pe}}\\right)^{2}}$$"
        },
        {
            "introduction": "Once we establish the simplified Ampere's law, our focus turns to the parallel vector potential, $A_{\\parallel}$, which describes the magnetic fluctuations. To build physical intuition, this exercise  asks you to connect this mathematical potential to a tangible physical quantity: the energy stored in the perturbed magnetic field. You will calculate this \"field-line bending\" energy, revealing how it depends on the perpendicular gradients of $A_{\\parallel}$ and providing a deeper understanding of what these magnetic perturbations represent.",
            "id": "4203839",
            "problem": "Consider a uniform, straight background magnetic field $\\boldsymbol{B}_0 = B_0 \\hat{\\boldsymbol{z}}$ in a periodic slab domain with perpendicular extents $L_x$ and $L_y$ and parallel extent $L_z$. In the low-frequency, magnetohydrodynamic (MHD) shear-Alfvén regime relevant for Gyrokinetic (GK) electromagnetic fluctuations, compressional magnetic fluctuations are negligible and the perturbed magnetic field is dominated by field-line bending associated with a parallel component of the vector potential $A_{\\parallel}(x,y)$, where the total magnetic perturbation is represented by $\\delta \\boldsymbol{A} = A_{\\parallel}(x,y) \\hat{\\boldsymbol{z}}$. Assume periodic boundary conditions such that the domain contains an integer number of perpendicular wavelengths.\n\nStarting from the definition of the magnetic field $\\boldsymbol{B} = \\nabla \\times \\boldsymbol{A}$ and the magnetostatic magnetic energy density $u_B = |\\delta \\boldsymbol{B}|^2/(2 \\mu_0)$, where $\\mu_0$ is the vacuum permeability, derive the total magnetic energy stored in the bent field lines for the single-mode perturbation\n$$\nA_{\\parallel}(x,y) = A_0 \\cos(k_x x)\\cos(k_y y),\n$$\nwith constants $A_0$, $k_x$, and $k_y$. Show explicitly how the perpendicular derivatives enter and compute the volume-integrated bending energy. Express the final energy in Joules in terms of $A_0$, $k_x$, $k_y$, $L_x$, $L_y$, $L_z$, and $\\mu_0$. Your final answer must be a single closed-form analytical expression. Do not perform any numerical substitutions.",
            "solution": "The objective is to compute the total magnetic energy associated with a single-mode magnetic perturbation in a uniform background magnetic field. The magnetic energy is stored in the perturbed field, $\\delta \\boldsymbol{B}$.\n\nThe total magnetic field is $\\boldsymbol{B} = \\boldsymbol{B}_0 + \\delta \\boldsymbol{B}$, where $\\boldsymbol{B}_0 = B_0 \\hat{\\boldsymbol{z}}$ is the uniform background field. The perturbation is described by a vector potential $\\delta \\boldsymbol{A} = A_{\\parallel}(x,y) \\hat{\\boldsymbol{z}}$. The perturbed magnetic field $\\delta \\boldsymbol{B}$ is derived from the curl of the perturbed vector potential $\\delta \\boldsymbol{A}$:\n$$\n\\delta \\boldsymbol{B} = \\nabla \\times \\delta \\boldsymbol{A}\n$$\nIn Cartesian coordinates, the curl operator applied to $\\delta \\boldsymbol{A} = A_{\\parallel}(x,y) \\hat{\\boldsymbol{z}}$ is:\n$$\n\\delta \\boldsymbol{B} = \\left( \\frac{\\partial A_z}{\\partial y} - \\frac{\\partial A_y}{\\partial z} \\right) \\hat{\\boldsymbol{x}} + \\left( \\frac{\\partial A_x}{\\partial z} - \\frac{\\partial A_z}{\\partial x} \\right) \\hat{\\boldsymbol{y}} + \\left( \\frac{\\partial A_y}{\\partial x} - \\frac{\\partial A_x}{\\partial y} \\right) \\hat{\\boldsymbol{z}}\n$$\nSubstituting $A_x = 0$, $A_y = 0$, and $A_z = A_{\\parallel}(x,y)$, which is independent of $z$, we obtain:\n$$\n\\delta \\boldsymbol{B} = \\frac{\\partial A_{\\parallel}}{\\partial y} \\hat{\\boldsymbol{x}} - \\frac{\\partial A_{\\parallel}}{\\partial x} \\hat{\\boldsymbol{y}}\n$$\nThis expression explicitly shows that the perturbed magnetic field is purely perpendicular to the background field $\\boldsymbol{B}_0$ and is determined by the perpendicular spatial derivatives of the parallel component of the vector potential. This represents the \"bending\" of the magnetic field lines.\n\nThe problem provides the specific form for the parallel vector potential:\n$$\nA_{\\parallel}(x,y) = A_0 \\cos(k_x x)\\cos(k_y y)\n$$\nWe compute the required partial derivatives:\n$$\n\\frac{\\partial A_{\\parallel}}{\\partial x} = \\frac{\\partial}{\\partial x} [A_0 \\cos(k_x x)\\cos(k_y y)] = -A_0 k_x \\sin(k_x x)\\cos(k_y y)\n$$\n$$\n\\frac{\\partial A_{\\parallel}}{\\partial y} = \\frac{\\partial}{\\partial y} [A_0 \\cos(k_x x)\\cos(k_y y)] = -A_0 k_y \\cos(k_x x)\\sin(k_y y)\n$$\nSubstituting these expressions into the formula for $\\delta \\boldsymbol{B}$:\n$$\n\\delta \\boldsymbol{B} = (-A_0 k_y \\cos(k_x x)\\sin(k_y y)) \\hat{\\boldsymbol{x}} - (-A_0 k_x \\sin(k_x x)\\cos(k_y y)) \\hat{\\boldsymbol{y}}\n$$\n$$\n\\delta \\boldsymbol{B} = -A_0 k_y \\cos(k_x x)\\sin(k_y y) \\hat{\\boldsymbol{x}} + A_0 k_x \\sin(k_x x)\\cos(k_y y) \\hat{\\boldsymbol{y}}\n$$\nThe magnetic energy density of the perturbation is given by $u_B = \\frac{|\\delta \\boldsymbol{B}|^2}{2 \\mu_0}$. First, we find the squared magnitude of $\\delta \\boldsymbol{B}$:\n$$\n|\\delta \\boldsymbol{B}|^2 = (\\delta B_x)^2 + (\\delta B_y)^2 = (-A_0 k_y \\cos(k_x x)\\sin(k_y y))^2 + (A_0 k_x \\sin(k_x x)\\cos(k_y y))^2\n$$\n$$\n|\\delta \\boldsymbol{B}|^2 = A_0^2 k_y^2 \\cos^2(k_x x)\\sin^2(k_y y) + A_0^2 k_x^2 \\sin^2(k_x x)\\cos^2(k_y y)\n$$\nThe energy density is therefore:\n$$\nu_B(x,y) = \\frac{A_0^2}{2 \\mu_0} \\left[ k_y^2 \\cos^2(k_x x)\\sin^2(k_y y) + k_x^2 \\sin^2(k_x x)\\cos^2(k_y y) \\right]\n$$\nThe total magnetic energy, $W_B$, stored in the volume is the integral of the energy density over the domain $V = [0, L_x] \\times [0, L_y] \\times [0, L_z]$.\n$$\nW_B = \\iiint_V u_B(x,y) \\,dV = \\int_0^{L_z} \\int_0^{L_y} \\int_0^{L_x} u_B(x,y) \\,dx\\,dy\\,dz\n$$\nSince $u_B$ is independent of $z$, the integration over $z$ is trivial:\n$$\n\\int_0^{L_z} dz = L_z\n$$\nThus, the total energy is:\n$$\nW_B = \\frac{A_0^2 L_z}{2 \\mu_0} \\int_0^{L_y} \\int_0^{L_x} \\left[ k_y^2 \\cos^2(k_x x)\\sin^2(k_y y) + k_x^2 \\sin^2(k_x x)\\cos^2(k_y y) \\right] \\,dx\\,dy\n$$\nWe can separate the double integral into two terms:\n$$\nW_B = \\frac{A_0^2 L_z}{2 \\mu_0} \\left[ k_y^2 \\left(\\int_0^{L_x} \\cos^2(k_x x) \\,dx\\right) \\left(\\int_0^{L_y} \\sin^2(k_y y) \\,dy\\right) + k_x^2 \\left(\\int_0^{L_x} \\sin^2(k_x x) \\,dx\\right) \\left(\\int_0^{L_y} \\cos^2(k_y y) \\,dy\\right) \\right]\n$$\nTo evaluate these integrals, we use the fact that the domain contains an integer number of perpendicular wavelengths. This implies periodic boundary conditions, such that $k_x = \\frac{2\\pi n_x}{L_x}$ and $k_y = \\frac{2\\pi n_y}{L_y}$ for non-zero integers $n_x$ and $n_y$. For such cases, the average value of $\\sin^2$ and $\\cos^2$ over the interval is $1/2$. The definite integrals are:\n$$\n\\int_0^{L} \\sin^2(kx) \\,dx = \\int_0^{L} \\frac{1-\\cos(2kx)}{2} \\,dx = \\left[ \\frac{x}{2} - \\frac{\\sin(2kx)}{4k} \\right]_0^{L} = \\frac{L}{2} - \\frac{\\sin(2kL)}{4k}\n$$\n$$\n\\int_0^{L} \\cos^2(kx) \\,dx = \\int_0^{L} \\frac{1+\\cos(2kx)}{2} \\,dx = \\left[ \\frac{x}{2} + \\frac{\\sin(2kx)}{4k} \\right]_0^{L} = \\frac{L}{2} + \\frac{\\sin(2kL)}{4k}\n$$\nWith $k_x L_x = 2\\pi n_x$, we have $\\sin(2k_x L_x) = \\sin(4\\pi n_x) = 0$. Similarly, $\\sin(2k_y L_y) = \\sin(4\\pi n_y) = 0$.\nThe integrals simplify to:\n$$\n\\int_0^{L_x} \\cos^2(k_x x) \\,dx = \\frac{L_x}{2} \\quad ; \\quad \\int_0^{L_x} \\sin^2(k_x x) \\,dx = \\frac{L_x}{2}\n$$\n$$\n\\int_0^{L_y} \\sin^2(k_y y) \\,dy = \\frac{L_y}{2} \\quad ; \\quad \\int_0^{L_y} \\cos^2(k_y y) \\,dy = \\frac{L_y}{2}\n$$\nSubstituting these results back into the expression for $W_B$:\n$$\nW_B = \\frac{A_0^2 L_z}{2 \\mu_0} \\left[ k_y^2 \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) + k_x^2 \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) \\right]\n$$\n$$\nW_B = \\frac{A_0^2 L_z}{2 \\mu_0} \\left[ k_y^2 \\frac{L_x L_y}{4} + k_x^2 \\frac{L_x L_y}{4} \\right]\n$$\nFactoring out the common terms:\n$$\nW_B = \\frac{A_0^2 L_x L_y L_z}{8 \\mu_0} (k_x^2 + k_y^2)\n$$\nThis is the final expression for the total magnetic energy stored in the perturbed magnetic field for the given single-mode perturbation. The energy is proportional to the square of the perturbation amplitude $A_0$, the volume of the domain $L_x L_y L_z$, and the square of the perpendicular wavenumber magnitude $k_\\perp^2 = k_x^2 + k_y^2$. The dependence on $k_x^2 + k_y^2$ explicitly shows how the stored energy increases with the spatial gradients (i.e., the \"bending\") of the field lines.",
            "answer": "$$\n\\boxed{\\frac{A_0^2 L_x L_y L_z (k_x^2 + k_y^2)}{8 \\mu_0}}\n$$"
        },
        {
            "introduction": "The Gyrokinetic Ampere's law is a dynamic equation that governs the evolution of the magnetic field in response to plasma currents. This final practice brings together the physics of Ampere's law and electron dynamics to derive the governing wave equation for $A_{\\parallel}$—the Kinetic Alfvén Wave equation. Moving from theory to computation, the exercise  then challenges you to analyze the numerical stability and accuracy of common time-stepping schemes used to solve this equation in advanced plasma simulations.",
            "id": "4197695",
            "problem": "Consider a linear electromagnetic fluctuation in a magnetized plasma under the gyrokinetic ordering, where the low-frequency, anisotropic dynamics lead to a coupling between the parallel component of the vector potential $A_{\\parallel}$ and the parallel current $j_{\\parallel}$. Assume quasi-neutrality with $n_i = n_e$, a uniform guide magnetic field of magnitude $B_0$, and a straight field-line geometry so that parallel and perpendicular wavenumbers $k_{\\parallel}$ and $k_{\\perp}$ are well-defined. Work in the collisionless, isothermal-electron limit and neglect the displacement current, consistent with the low-frequency gyrokinetic ordering.\n\nStarting from the following fundamental base:\n- Maxwell–Ampère law without displacement current, and the definition of the Alfvén speed $v_A$,\n- Electron parallel momentum balance, and the definition of the ion sound Larmor radius $\\rho_s$,\n- Fourier representation in space, and a single-mode ansatz in time,\n\nderive a linear wave equation for $A_{\\parallel}(t)$ in Fourier space that is consistent with the kinetic Alfvén wave (KAW) regime. Show that the dynamics of a single mode can be written in the form of a harmonic oscillator, and identify the corresponding angular frequency $\\omega$ in terms of $k_{\\parallel}$, $k_{\\perp}$, $B_0$, $n_i$, $m_i$, and $T_e$ via physically justified intermediate quantities. Use the following physical definitions:\n- Alfvén speed $v_A = B_0 / \\sqrt{\\mu_0 n_i m_i}$,\n- Ion sound Larmor radius $\\rho_s = c_s / \\Omega_i$, where $c_s = \\sqrt{T_e/m_i}$ and $\\Omega_i = e B_0 / m_i$,\n- Elementary charge $e$ and vacuum permeability $\\mu_0$.\n\nNext, analyze the time discretization of this linear oscillator for updating $A_{\\parallel}$:\n- For an explicit second-order central-difference scheme applied directly to the second-order ordinary differential equation, derive the linear stability constraint on the time step $\\Delta t$ in terms of the angular frequency $\\omega$. Characterize the boundary of stability in terms of the dimensionless parameter $\\mu = \\omega \\Delta t$.\n- For an implicit Crank–Nicolson scheme applied to the first-order complex-amplitude representation $a(t)$ satisfying $\\partial_t a = \\mathrm{i}\\,\\omega\\,a$ (where the physical $A_{\\parallel}$ corresponds to the real part of $a$), establish that the method is linearly stable for any $\\Delta t$ by analyzing its amplification factor. Then, quantify an accuracy-based time-step constraint by requiring that the per-step phase defect (in radians) be bounded by a specified tolerance $\\epsilon$; the phase defect is the difference between the exact phase increment and the numerical phase increment per step.\n\nImplement a program that, for each parameter set in the test suite described below, computes:\n- The explicit stability-limited maximum time step $\\Delta t_{\\text{exp}}$,\n- The implicit Crank–Nicolson accuracy-limited maximum time step $\\Delta t_{\\text{imp}}$ for a given phase-error tolerance $\\epsilon$ (in radians per step).\n\nYour program must adhere to the following modeling and unit conventions:\n- Treat $k_{\\perp} \\rho_s$ (a dimensionless parameter) as given; internally compute $k_{\\perp} = (k_{\\perp}\\rho_s)/\\rho_s$ to validate dimensional consistency, but use $k_{\\perp} \\rho_s$ directly in the dispersion since it is dimensionless.\n- Use $v_A$, $\\rho_s$, and the given $k_{\\parallel}$ and $k_{\\perp} \\rho_s$ to determine $\\omega$ for the linear KAW-like mode derived from first principles.\n- Express all time steps in seconds, as floating-point numbers.\n- The angle unit for $\\epsilon$ is radians.\n\nTest suite:\nProvide results for the following scientifically plausible parameter sets, covering typical, small-$k_{\\parallel}$, varied-$B_0$ and density, strongly kinetic, and long-wavelength limits. In each case, $m_i$ corresponds to deuterium, $m_i = 3.343 \\times 10^{-27}\\,\\mathrm{kg}$; $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$; $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n- Case $1$: $B_0 = 3\\,\\mathrm{T}$, $n_e = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_e = 100\\,\\mathrm{eV}$, $k_{\\parallel} = 100\\,\\mathrm{m}^{-1}$, $k_{\\perp}\\rho_s = 10$, $\\epsilon = 0.1$.\n- Case $2$: $B_0 = 3\\,\\mathrm{T}$, $n_e = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_e = 100\\,\\mathrm{eV}$, $k_{\\parallel} = 10^{-3}\\,\\mathrm{m}^{-1}$, $k_{\\perp}\\rho_s = 20$, $\\epsilon = 0.01$.\n- Case $3$: $B_0 = 1\\,\\mathrm{T}$, $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_e = 60\\,\\mathrm{eV}$, $k_{\\parallel} = 50\\,\\mathrm{m}^{-1}$, $k_{\\perp}\\rho_s = 5$, $\\epsilon = 0.05$.\n- Case $4$: $B_0 = 3\\,\\mathrm{T}$, $n_e = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_e = 100\\,\\mathrm{eV}$, $k_{\\parallel} = 500\\,\\mathrm{m}^{-1}$, $k_{\\perp}\\rho_s = 50$, $\\epsilon = 0.2$.\n- Case $5$: $B_0 = 2\\,\\mathrm{T}$, $n_e = 2.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_e = 200\\,\\mathrm{eV}$, $k_{\\parallel} = 200\\,\\mathrm{m}^{-1}$, $k_{\\perp}\\rho_s = 0.1$, $\\epsilon = 0.1$.\n\nFinal output format:\nYour program should produce a single line of output containing a comma-separated list of pairs, one pair per test case, where each pair is $[\\Delta t_{\\text{exp}}, \\Delta t_{\\text{imp}}]$ in seconds. For example, an output with $N$ cases must look exactly like $[[a_1,b_1],[a_2,b_2],\\dots,[a_N,b_N]]$ with floating-point numbers in seconds.",
            "solution": "### Derivation of the Kinetic Alfvén Wave Equation\n\nWe will derive the dispersion relation by establishing two independent relationships between the scalar potential $\\phi$ and the parallel vector potential $A_{\\parallel}$, and then demanding consistency. We work in Fourier space, where for a single mode, spatial derivatives $\\nabla$ become $\\mathrm{i}\\mathbf{k}$ and time derivatives $\\partial/\\partial t$ become $-\\mathrm{i}\\omega$.\n\n**Relation 1: From Ampère's Law and Current Continuity**\nThe parallel component of Ampère's law, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{j}$, in the absence of a displacement current, is $\\mu_0 j_{\\parallel} = (\\nabla \\times \\mathbf{B})_{\\parallel}$. The magnetic field perturbation is $\\mathbf{B}_1 = \\nabla \\times \\mathbf{A}$. For a fluctuation with $A_{\\perp}=0$, we have $\\mathbf{A} = A_{\\parallel} \\hat{b}$, where $\\hat{b}$ is the unit vector along the uniform guide field $\\mathbf{B}_0$.\nIn Fourier space, this becomes $\\mathbf{B}_{1,k} = \\mathrm{i}\\mathbf{k} \\times (A_{\\parallel,k} \\hat{b}) = \\mathrm{i}A_{\\parallel,k}(\\mathbf{k}_{\\perp} \\times \\hat{b})$.\nThen $\\mathrm{i}\\mathbf{k} \\times \\mathbf{B}_{1,k} = \\mathrm{i}\\mathbf{k} \\times (\\mathrm{i}A_{\\parallel,k}(\\mathbf{k}_{\\perp} \\times \\hat{b})) = -A_{\\parallel,k} \\mathbf{k} \\times (\\mathbf{k}_{\\perp} \\times \\hat{b})$.\nUsing the vector triple product, $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$, we get:\n$\\mu_0 \\mathbf{j}_k = -A_{\\parallel,k} [\\mathbf{k}_{\\perp}(\\mathbf{k}\\cdot\\hat{b}) - \\hat{b}(\\mathbf{k}\\cdot\\mathbf{k}_{\\perp})] = -A_{\\parallel,k} [k_{\\parallel}\\mathbf{k}_{\\perp} - k_{\\perp}^2 \\hat{b}]$.\nThe parallel component is $\\mu_0 j_{\\parallel,k} = k_{\\perp}^2 A_{\\parallel,k}$. Thus,\n$$j_{\\parallel,k} = \\frac{k_{\\perp}^2}{\\mu_0} A_{\\parallel,k} \\quad (1)$$\nNext, we use the charge continuity equation, $\\nabla \\cdot \\mathbf{j} = 0$, which in Fourier space is $\\mathbf{k} \\cdot \\mathbf{j}_k = 0$, or $k_{\\parallel}j_{\\parallel,k} + \\mathbf{k}_{\\perp} \\cdot \\mathbf{j}_{\\perp,k} = 0$. The perpendicular current $\\mathbf{j}_{\\perp}$ is dominated by the ion polarization current, $\\mathbf{j}_{\\perp} \\approx \\mathbf{j}_{\\perp,i}$.\n$\\mathbf{j}_{\\perp,i} = \\frac{n_i m_i}{B_0^2}\\frac{d\\mathbf{E}_{\\perp}}{dt}$. In Fourier space, with $\\mathbf{E}_{\\perp,k} = -\\mathrm{i}\\mathbf{k}_{\\perp}\\phi_k$:\n$\\mathbf{j}_{\\perp,i,k} = \\frac{n_i m_i}{B_0^2} (-\\mathrm{i}\\omega) (-\\mathrm{i}\\mathbf{k}_{\\perp}\\phi_k) = -\\frac{n_i m_i \\omega}{B_0^2} \\mathbf{k}_{\\perp}\\phi_k$.\nSubstituting this into the continuity equation:\n$k_{\\parallel}j_{\\parallel,k} + \\mathbf{k}_{\\perp} \\cdot \\left(-\\frac{n_i m_i \\omega}{B_0^2} \\mathbf{k}_{\\perp}\\phi_k\\right) = 0 \\implies k_{\\parallel}j_{\\parallel,k} = \\frac{n_i m_i \\omega k_{\\perp}^2}{B_0^2} \\phi_k$.\nCombining this with Eq. (1) to eliminate $j_{\\parallel,k}$:\n$k_{\\parallel} \\left(\\frac{k_{\\perp}^2}{\\mu_0} A_{\\parallel,k}\\right) = \\frac{n_i m_i \\omega k_{\\perp}^2}{B_0^2} \\phi_k$.\nThis simplifies to $\\phi_k = \\frac{k_{\\parallel} B_0^2}{\\mu_0 n_i m_i \\omega} A_{\\parallel,k}$. Using the definition $v_A^2 = B_0^2/(\\mu_0 n_i m_i)$, we get our first relation:\n$$\\phi_k = \\frac{k_{\\parallel}v_A^2}{\\omega} A_{\\parallel,k} \\quad (2)$$\n\n**Relation 2: From Quasineutrality and Electron-Ion Responses**\nWe invoke quasineutrality, $n_{e,k} = n_{i,k}$.\nThe ion density perturbation is due to the polarization drift. From the ion continuity equation, $e n_{i,k} = \\frac{\\mathbf{k}_{\\perp} \\cdot \\mathbf{j}_{\\perp,i,k}}{\\omega}$. Using the expression for $\\mathbf{j}_{\\perp,i,k}$ from above:\n$e n_{i,k} = \\frac{1}{\\omega} \\mathbf{k}_{\\perp} \\cdot \\left(-\\frac{n_i m_i \\omega}{B_0^2} \\mathbf{k}_{\\perp}\\phi_k\\right) = -\\frac{n_i m_i k_{\\perp}^2}{B_0^2} \\phi_k$.\nUsing the definitions $\\Omega_i = eB_0/m_i$ and $c_s = \\sqrt{T_e/m_i}$, we can write $\\rho_s^2 = c_s^2/\\Omega_i^2 = (T_e/m_i)/(eB_0/m_i)^2 = T_e m_i/(eB_0)^2$. Thus:\n$n_{i,k} = -\\frac{n_i m_i k_{\\perp}^2}{e B_0^2} \\phi_k = -n_i \\frac{k_{\\perp}^2 T_e m_i}{T_e e^2 B_0^2} \\phi_k = -n_i k_{\\perp}^2 \\rho_s^2 \\frac{e\\phi_k}{T_e}$.\nFor electrons in the collisionless, isothermal limit, their parallel motion is fast. Neglecting electron inertia ($m_e \\to 0$), the parallel electron momentum equation reduces to balancing the electric field and pressure gradient forces: $eE_{\\parallel,k} + \\frac{1}{n_e} (\\mathrm{i}k_{\\parallel} p_{e,k}) = 0$. Using $E_{\\parallel,k} = -\\mathrm{i}k_{\\parallel}\\phi_k+\\mathrm{i}\\omega A_{\\parallel,k}$ and $p_{e,k} = n_{e,k}T_e$:\n$e(-\\mathrm{i}k_{\\parallel}\\phi_k+\\mathrm{i}\\omega A_{\\parallel,k}) + \\frac{T_e}{n_e}(\\mathrm{i}k_{\\parallel}n_{e,k}) = 0$.\nThis yields the electron density response: $n_{e,k} = \\frac{n_e e}{T_e}(\\phi_k - \\frac{\\omega}{k_{\\parallel}} A_{\\parallel,k})$.\nApplying quasineutrality $n_{e,k} = n_{i,k}$:\n$\\frac{n_e e}{T_e}(\\phi_k - \\frac{\\omega}{k_{\\parallel}} A_{\\parallel,k}) = -n_i k_{\\perp}^2 \\rho_s^2 \\frac{e\\phi_k}{T_e}$.\nSince $n_e=n_i$, we can simplify: $\\phi_k - \\frac{\\omega}{k_{\\parallel}} A_{\\parallel,k} = -k_{\\perp}^2 \\rho_s^2 \\phi_k$.\nSolving for $\\phi_k$ gives our second relation:\n$$\\phi_k = \\frac{\\omega}{k_{\\parallel}(1+k_{\\perp}^2\\rho_s^2)} A_{\\parallel,k} \\quad (3)$$\n\n**Dispersion Relation and Oscillator Equation**\nEquating the expressions for $\\phi_k$ from Eq. (2) and Eq. (3):\n$\\frac{k_{\\parallel}v_A^2}{\\omega} = \\frac{\\omega}{k_{\\parallel}(1+k_{\\perp}^2\\rho_s^2)}$.\nThis gives the dispersion relation for the Kinetic Alfvén Wave:\n$$\\omega^2 = k_{\\parallel}^2 v_A^2 (1 + k_{\\perp}^2\\rho_s^2)$$\nThe problem asks for an equation for $A_{\\parallel}(t)$ in Fourier space. A single Fourier mode $A_{\\parallel,k}(t)$ oscillates in time. Transforming from frequency domain back to time domain, $-\\mathrm{i}\\omega \\to \\partial_t$, so $(-\\mathrm{i}\\omega)^2 \\to \\partial_{tt}$. Thus, $\\omega^2 \\to -\\partial_{tt}$. The dispersion relation becomes a differential equation:\n$$-\\frac{d^2 A_{\\parallel,k}}{dt^2} = \\omega^2 A_{\\parallel,k} \\implies \\frac{d^2 A_{\\parallel,k}}{dt^2} + \\omega^2 A_{\\parallel,k} = 0$$\nThis is the equation for a simple harmonic oscillator with angular frequency $\\omega = |k_{\\parallel}| v_A \\sqrt{1 + (k_{\\perp}\\rho_s)^2}$.\n\n### Analysis of Numerical Time-Stepping Schemes\n\n**Explicit Second-Order Central-Difference Scheme**\nThe oscillator equation $\\ddot{A} + \\omega^2 A = 0$ is discretized as:\n$$\\frac{A^{n+1} - 2A^n + A^{n-1}}{(\\Delta t)^2} + \\omega^2 A^n = 0$$\nwhere $A^n = A(n\\Delta t)$. Rearranging gives the update rule:\n$$A^{n+1} = (2 - \\omega^2 (\\Delta t)^2)A^n - A^{n-1}$$\nTo analyze stability, we seek a solution of the form $A^n = G^n$, where $G$ is the amplification factor. Substituting this into the recurrence relation gives a characteristic equation for $G$:\n$G^2 - (2 - \\omega^2 (\\Delta t)^2)G + 1 = 0$.\nLet $\\mu = \\omega \\Delta t$. The equation is $G^2 - (2-\\mu^2)G + 1 = 0$.\nThe roots are $G_{\\pm} = \\frac{(2-\\mu^2) \\pm \\sqrt{(2-\\mu^2)^2 - 4}}{2}$.\nFor stability, the magnitude of the roots must be less than or equal to $1$, i.e., $|G| \\le 1$. This occurs when the roots are complex conjugates on the unit circle, which requires the discriminant to be non-positive:\n$(2-\\mu^2)^2 - 4 \\le 0 \\implies (2-\\mu^2)^2 \\le 4$.\nTaking the square root, we have $|2-\\mu^2| \\le 2$, which is equivalent to $-2 \\le 2-\\mu^2 \\le 2$.\nThe right-hand inequality, $2-\\mu^2 \\le 2$, implies $-\\mu^2 \\le 0$, which is always true for real $\\mu$.\nThe left-hand inequality, $-2 \\le 2-\\mu^2$, implies $\\mu^2 \\le 4$, or $|\\mu| \\le 2$.\nThe stability boundary is $\\mu=2$. Therefore, the linear stability constraint on the time step is $\\omega \\Delta t \\le 2$, and the maximum stable time step is:\n$$\\Delta t_{\\text{exp}} = \\frac{2}{\\omega}$$\n\n**Implicit Crank–Nicolson Scheme**\nWe consider the first-order complex amplitude equation $\\partial_t a = \\mathrm{i}\\omega a$, where $A(t) = \\text{Re}(a(t))$. Applying the Crank–Nicolson scheme:\n$$\\frac{a^{n+1} - a^n}{\\Delta t} = \\mathrm{i}\\omega \\frac{a^{n+1} + a^n}{2}$$\nThe amplification factor $G = a^{n+1}/a^n$ is found by rearranging:\n$a^{n+1}(1 - \\mathrm{i}\\omega\\Delta t/2) = a^n(1 + \\mathrm{i}\\omega\\Delta t/2) \\implies G = \\frac{1 + \\mathrm{i}\\omega\\Delta t/2}{1 - \\mathrm{i}\\omega\\Delta t/2}$.\nThe magnitude of $G$ is:\n$$|G| = \\left| \\frac{1 + \\mathrm{i}\\omega\\Delta t/2}{1 - \\mathrm{i}\\omega\\Delta t/2} \\right| = \\frac{|1 + \\mathrm{i}\\omega\\Delta t/2|}{|1 - \\mathrm{i}\\omega\\Delta t/2|} = \\frac{\\sqrt{1 + (\\omega\\Delta t/2)^2}}{\\sqrt{1 + (-\\omega\\Delta t/2)^2}} = 1$$\nSince $|G|=1$ for any real $\\Delta t$, the Crank–Nicolson scheme is unconditionally linearly stable.\n\nThe accuracy constraint is based on the phase defect. The exact solution evolves as $a(t+\\Delta t) = a(t) e^{\\mathrm{i}\\omega\\Delta t}$, so the exact phase increment is $\\Delta\\Phi_{\\text{exact}} = \\omega\\Delta t$. The numerical phase increment $\\Delta\\Phi_{\\text{num}}$ is the argument of $G$.\nLet $\\mu = \\omega\\Delta t$. Then $\\Delta\\Phi_{\\text{num}} = \\arg(G) = \\arg\\left(\\frac{1 + \\mathrm{i}\\mu/2}{1 - \\mathrm{i}\\mu/2}\\right) = 2\\arctan(\\mu/2)$.\nThe phase defect is $\\delta\\Phi = |\\Delta\\Phi_{\\text{exact}} - \\Delta\\Phi_{\\text{num}}| = |\\mu - 2\\arctan(\\mu/2)|$.\nFor small argument $x$, $\\arctan(x) \\approx x - x^3/3$.\n$\\Delta\\Phi_{\\text{num}} \\approx 2\\left(\\frac{\\mu}{2} - \\frac{(\\mu/2)^3}{3}\\right) = \\mu - \\frac{\\mu^3}{12}$.\n$\\delta\\Phi \\approx |\\mu - (\\mu - \\mu^3/12)| = \\frac{\\mu^3}{12}$ for small $\\mu$.\nThe accuracy constraint is $\\delta\\Phi \\le \\epsilon$, which gives $(\\omega\\Delta t)^3/12 \\le \\epsilon$.\nThe accuracy-limited maximum time step is:\n$$\\Delta t_{\\text{imp}} = \\frac{(12\\epsilon)^{1/3}}{\\omega}$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used from scipy\n\ndef solve():\n    \"\"\"\n    Calculates stability- and accuracy-limited time steps for the Kinetic Alfvén Wave\n    oscillator equation using explicit and implicit numerical schemes.\n    \"\"\"\n    \n    # Define physical constants\n    M_I = 3.343e-27  # Mass of Deuterium in kg\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    MU_0 = 4 * np.pi * 1e-7  # Vacuum permeability in H/m\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (B0, ne, Te_eV, k_parallel, k_perp_rho_s, epsilon)\n    test_cases = [\n        # Case 1: Typical\n        (3.0, 1.0e19, 100.0, 100.0, 10.0, 0.1),\n        # Case 2: small-k_parallel\n        (3.0, 1.0e19, 100.0, 1.0e-3, 20.0, 0.01),\n        # Case 3: varied-B0 and density\n        (1.0, 5.0e19, 60.0, 50.0, 5.0, 0.05),\n        # Case 4: strongly kinetic\n        (3.0, 1.0e19, 100.0, 500.0, 50.0, 0.2),\n        # Case 5: long-wavelength\n        (2.0, 2.0e19, 200.0, 200.0, 0.1, 0.1),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        B0, ne, Te_eV, k_parallel, k_perp_rho_s, epsilon = case\n        \n        # The problem assumes quasi-neutrality, n_i = n_e\n        ni = ne\n\n        # Convert electron temperature from eV to Joules\n        Te_J = Te_eV * E_CHARGE\n        \n        # Calculate intermediate physical quantities\n        # Alfvén speed\n        v_A = B0 / np.sqrt(MU_0 * ni * M_I)\n        \n        # Calculate the KAW angular frequency\n        # omega = |k_parallel| * v_A * sqrt(1 + (k_perp * rho_s)^2)\n        # The term k_perp_rho_s is given directly.\n        omega = np.abs(k_parallel) * v_A * np.sqrt(1 + k_perp_rho_s**2)\n        \n        # Calculate the maximum time step for the explicit central-difference scheme\n        # Stability constraint: omega * dt <= 2\n        dt_exp = 2.0 / omega\n        \n        # Calculate the maximum time step for the implicit Crank-Nicolson scheme\n        # Accuracy constraint: (omega * dt)^3 / 12 <= epsilon\n        # dt <= (12 * epsilon)^(1/3) / omega\n        dt_imp = (12 * epsilon)**(1/3) / omega\n        \n        results.append([dt_exp, dt_imp])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, e.g., [[a1,b1],[a2,b2],...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}