{
    "hands_on_practices": [
        {
            "introduction": "在等离子体湍流等对流主导的模拟中，数值色散是影响模拟保真度的关键因素。高阶差分格式能够以更少的网格点更精确地捕捉小尺度结构，但设计和理解其性质至关重要。本练习将指导你推导一个六阶中心差分格式，并通过计算其修正波数来量化其色散误差，这是评估和选择数值格式的核心技能 。",
            "id": "4201165",
            "problem": "在回旋动理学（GK）聚变等离子体湍流的局域通量管模型中，考虑一个一维切片中的径向平流项，其坐标为 $x$，并定义了一个无源标量场 $f(x)$，该场定义在一个间距为 $h$ 的均匀周期性网格上。连续算子是空间一阶导数 $\\partial_{x} f$。您将构造一个达到六阶相容性的中心有限差分格式，然后通过傅里叶符号分析其色散关系。\n\n从 $f(x)$ 在网格点 $x_{i}$ 附近的泰勒级数展开式，以及一阶导数在该展开式中作为 $f'(x_{i})$ 的系数的定义出发，施加必要的矩条件，使得对于一个使用六个邻点 $x_{i\\pm 1}$、$x_{i\\pm 2}$ 和 $x_{i\\pm 3}$ 并且具有反对称权重的中心差分格式，其截断误差为 $\\mathcal{O}(h^{6})$。推导满足这些条件的差分格式的唯一系数\n$$\nD f_{i} \\equiv \\frac{1}{h} \\sum_{m=-3}^{3} \\alpha_{m} f_{i+m}, \\quad \\alpha_{0} = 0, \\quad \\alpha_{-m} = -\\alpha_{m},\n$$\n\n然后，假设周期性边界条件，通过将离散算子 $D$ 应用于傅里叶模 $f_{j} = \\exp(\\mathrm{i} k x_{j})$（其中 $x_{j} = j h$）来分析该算子，并定义无量纲波数 $\\theta \\equiv k h \\in [0,\\pi]$。计算与离散算子 $D$ 相关的无量纲修正波数 $k^{*} h$，并将其表示为 $\\theta$ 的闭式解析函数。\n\n请提供 $k^{*} h$ 关于 $\\theta$ 的解析表达式作为最终答案。不需要进行数值计算或四舍五入，最终表达式中也不应包含单位。",
            "solution": "用户希望找到一个六阶中心有限差分格式的无量纲修正波数。\n\n### 第1步：问题验证\n\n**1.1. 提取已知条件**\n-   **模型**：回旋动理学（GK）聚变等离子体湍流的局域通量管模型。\n-   **背景**：径向平流项，一维切片，坐标 $x$。\n-   **场**：无源标量场 $f(x)$。\n-   **网格**：均匀、周期性，间距为 $h$。\n-   **连续算子**：$\\partial_{x} f$。\n-   **离散算子形式**：$D f_{i} \\equiv \\frac{1}{h} \\sum_{m=-3}^{3} \\alpha_{m} f_{i+m}$。\n-   **差分格式约束**：中心格式，使用邻点 $x_{i\\pm 1}$、$x_{i\\pm 2}$、$x_{i\\pm 3}$。\n-   **权重约束**：$\\alpha_{0} = 0$ 和反对称性 $\\alpha_{-m} = -\\alpha_{m}$。\n-   **精度要求**：截断误差为 $\\mathcal{O}(h^{6})$。\n-   **分析任务**：计算无量纲修正波数 $k^{*} h$。\n-   **测试函数**：傅里叶模 $f_{j} = \\exp(\\mathrm{i} k x_{j})$，其中 $x_{j} = j h$。\n-   **无量纲波数**：$\\theta \\equiv k h \\in [0,\\pi]$。\n\n**1.2. 使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于数值分析这一成熟领域，特别是求解偏微分方程的有限差分方法的构造与分析。这些方法是计算物理学（包括聚变等离子体湍流模拟）中的标准工具。该问题在科学上和数学上都是合理的。\n-   **适定性**：该问题是适定的。对有限差分格式（宽度、反对称性和精度阶数）的约束导出了一个关于差分系数的唯一可解的线性方程组。后续修正波数的推导是一个标准的傅里叶分析过程，具有唯一的结果。\n-   **客观性**：语言精确、技术性强，没有任何主观性或歧义。\n\n**1.3. 结论与行动**\n问题有效。这是一个计算科学中的标准可解问题。可以进行求解过程。\n\n### 第2步：推导差分系数\n\n目标是构造一个离散算子 $D$，用以近似连续的一阶导数算子 $\\partial_x$。离散算子给定为：\n$$\nD f_{i} = \\frac{1}{h} \\sum_{m=-3}^{3} \\alpha_{m} f_{i+m}\n$$\n根据约束条件 $\\alpha_{0} = 0$ 和 $\\alpha_{-m} = -\\alpha_{m}$，求和可以简化为：\n$$\nD f_{i} = \\frac{1}{h} \\sum_{m=1}^{3} (\\alpha_{m} f_{i+m} + \\alpha_{-m} f_{i-m}) = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_{m} (f_{i+m} - f_{i-m})\n$$\n为了确定系数 $\\alpha_m$，我们将 $f_{i+m} = f(x_i + mh)$ 和 $f_{i-m} = f(x_i - mh)$ 在点 $x_i$ 附近进行泰勒级数展开：\n$$\nf(x_i \\pm mh) = \\sum_{n=0}^{\\infty} \\frac{(\\pm mh)^n}{n!} \\frac{d^n f}{dx^n}\\bigg|_{x_i}\n$$\n差分项为：\n$$\nf_{i+m} - f_{i-m} = \\sum_{n=0}^{\\infty} \\frac{(mh)^n - (-mh)^n}{n!} f^{(n)}(x_i)\n$$\n当 $n$ 为偶数时，各项相消。当 $n$ 为奇数（$n=2k+1$）时，我们有 $(mh)^{2k+1} - (-mh)^{2k+1} = 2(mh)^{2k+1}$。\n$$\nf_{i+m} - f_{i-m} = \\sum_{k=0}^{\\infty} \\frac{2(mh)^{2k+1}}{(2k+1)!} f^{(2k+1)}(x_i) = 2mh f'(x_i) + \\frac{2(mh)^3}{3!}f'''(x_i) + \\frac{2(mh)^5}{5!}f^{(5)}(x_i) + \\dots\n$$\n将此结果代回到 $D f_i$ 的表达式中：\n$$\nD f_i = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_m \\left( 2mh f'(x_i) + \\frac{2m^3h^3}{6}f'''(x_i) + \\frac{2m^5h^5}{120}f^{(5)}(x_i) + \\frac{2m^7h^7}{5040}f^{(7)}(x_i) + \\mathcal{O}(h^9) \\right)\n$$\n我们按 $f$ 的导数阶数对各项进行分组：\n$$\nD f_i = f'(x_i) \\left[ 2 \\sum_{m=1}^{3} m \\alpha_m \\right] + f'''(x_i) \\left[ \\frac{h^2}{3} \\sum_{m=1}^{3} m^3 \\alpha_m \\right] + f^{(5)}(x_i) \\left[ \\frac{h^4}{60} \\sum_{m=1}^{3} m^5 \\alpha_m \\right] + f^{(7)}(x_i) \\left[ \\frac{h^6}{2520} \\sum_{m=1}^{3} m^7 \\alpha_m \\right] + \\dots\n$$\n为了使 $D f_i$ 以 $\\mathcal{O}(h^6)$ 的截断误差近似 $f'(x_i)$，我们必须施加以下条件：\n1.  $f'(x_i)$ 的系数必须为 1：$2 \\sum_{m=1}^{3} m \\alpha_m = 1$。\n2.  $f'''(x_i)$ 的系数必须为 0：$\\sum_{m=1}^{3} m^3 \\alpha_m = 0$。\n3.  $f^{(5)}(x_i)$ 的系数必须为 0：$\\sum_{m=1}^{3} m^5 \\alpha_m = 0$。\n\n这给了我们一个关于三个未知系数 $\\alpha_1$、$\\alpha_2$ 和 $\\alpha_3$ 的三元线性方程组：\n$$\n\\begin{cases}\n\\alpha_1 + 2\\alpha_2 + 3\\alpha_3 = \\frac{1}{2} \\\\\n\\alpha_1 + 8\\alpha_2 + 27\\alpha_3 = 0 \\\\\n\\alpha_1 + 32\\alpha_2 + 243\\alpha_3 = 0\n\\end{cases}\n$$\n将第二个方程减去第一个方程，第三个方程减去第二个方程，我们得到：\n$$\n\\begin{cases}\n6\\alpha_2 + 24\\alpha_3 = -\\frac{1}{2} \\\\\n24\\alpha_2 + 216\\alpha_3 = 0\n\\end{cases}\n$$\n从这两个新方程中的第二个方程，$24(\\alpha_2 + 9\\alpha_3) = 0$，可以推出 $\\alpha_2 = -9\\alpha_3$。将此代入第一个新方程：\n$$\n6(-9\\alpha_3) + 24\\alpha_3 = -\\frac{1}{2} \\implies -54\\alpha_3 + 24\\alpha_3 = -\\frac{1}{2} \\implies -30\\alpha_3 = -\\frac{1}{2} \\implies \\alpha_3 = \\frac{1}{60}\n$$\n现在我们可以求出 $\\alpha_2$ 和 $\\alpha_1$：\n$$\n\\alpha_2 = -9\\alpha_3 = -9\\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}\n$$\n$$\n\\alpha_1 = \\frac{1}{2} - 2\\alpha_2 - 3\\alpha_3 = \\frac{1}{2} - 2\\left(-\\frac{3}{20}\\right) - 3\\left(\\frac{1}{60}\\right) = \\frac{1}{2} + \\frac{6}{20} - \\frac{3}{60} = \\frac{30}{60} + \\frac{18}{60} - \\frac{3}{60} = \\frac{45}{60} = \\frac{3}{4}\n$$\n系数为 $\\alpha_1 = \\frac{3}{4}$、$\\alpha_2 = -\\frac{3}{20}$ 和 $\\alpha_3 = \\frac{1}{60}$。\n\n### 第3步：推导修正波数\n\n连续导数算子作用于傅里叶模 $f(x) = \\exp(\\mathrm{i} k x)$ 产生 $\\partial_x f(x) = \\mathrm{i} k \\exp(\\mathrm{i} k x) = \\mathrm{i} k f(x)$。其特征值为 $\\mathrm{i} k$。\n\n修正波数 $k^*$ 的定义是，离散算子 $D$ 作用于网格函数 $f_j = \\exp(\\mathrm{i} k x_j) = \\exp(\\mathrm{i} k j h)$ 时，其效果模仿连续算子：$D f_j = \\mathrm{i} k^* f_j$。\n我们来计算 $D$ 对 $f_j$ 的作用：\n$$\nD f_j = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_m (f_{j+m} - f_{j-m})\n$$\n代入 $f_{j\\pm m} = \\exp(\\mathrm{i} k(j\\pm m)h) = \\exp(\\mathrm{i} k j h) \\exp(\\pm \\mathrm{i} k m h) = f_j \\exp(\\pm \\mathrm{i} k m h)$：\n$$\nD f_j = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_m (f_j \\exp(\\mathrm{i} k m h) - f_j \\exp(-\\mathrm{i} k m h))\n$$\n$$\nD f_j = \\frac{f_j}{h} \\sum_{m=1}^{3} \\alpha_m (\\exp(\\mathrm{i} k m h) - \\exp(-\\mathrm{i} k m h))\n$$\n使用欧拉公式 $\\exp(\\mathrm{i} z) - \\exp(-\\mathrm{i} z) = 2\\mathrm{i}\\sin(z)$，我们得到：\n$$\nD f_j = \\frac{f_j}{h} \\sum_{m=1}^{3} \\alpha_m (2\\mathrm{i} \\sin(k m h)) = f_j \\left( \\frac{2\\mathrm{i}}{h} \\sum_{m=1}^{3} \\alpha_m \\sin(k m h) \\right)\n$$\n将此结果与定义 $D f_j = \\mathrm{i} k^* f_j$ 进行比较，我们确定修正波数 $k^*$：\n$$\n\\mathrm{i} k^* = \\frac{2\\mathrm{i}}{h} \\sum_{m=1}^{3} \\alpha_m \\sin(k m h) \\implies k^* = \\frac{2}{h} \\sum_{m=1}^{3} \\alpha_m \\sin(k m h)\n$$\n问题要求的是无量纲修正波数 $k^* h$。两边乘以 $h$：\n$$\nk^* h = 2 \\sum_{m=1}^{3} \\alpha_m \\sin(k m h)\n$$\n引入无量纲波数 $\\theta = k h$，表达式变为：\n$$\nk^* h = 2 \\sum_{m=1}^{3} \\alpha_m \\sin(m \\theta) = 2(\\alpha_1 \\sin(\\theta) + \\alpha_2 \\sin(2\\theta) + \\alpha_3 \\sin(3\\theta))\n$$\n最后，我们代入推导出的系数值 $\\alpha_1 = \\frac{3}{4}$、$\\alpha_2 = -\\frac{3}{20}$ 和 $\\alpha_3 = \\frac{1}{60}$：\n$$\nk^* h = 2 \\left( \\frac{3}{4} \\sin(\\theta) - \\frac{3}{20} \\sin(2\\theta) + \\frac{1}{60} \\sin(3\\theta) \\right)\n$$\n$$\nk^* h = \\frac{3}{2} \\sin(\\theta) - \\frac{3}{10} \\sin(2\\theta) + \\frac{1}{30} \\sin(3\\theta)\n$$\n这就是无量纲修正波数关于无量纲波数 $\\theta$ 的最终解析表达式。",
            "answer": "$$\n\\boxed{\\frac{3}{2} \\sin(\\theta) - \\frac{3}{10} \\sin(2\\theta) + \\frac{1}{30} \\sin(3\\theta)}\n$$"
        },
        {
            "introduction": "理论推导常基于理想的周期性边界，但实际的物理模型往往涉及有界的非周期性区域。因此，如何准确地施加边界条件是数值模拟中的一个核心实践问题。本练习将以聚变等离子体模型中常见的诺伊曼（Neumann）边界条件为例，展示如何通过虚单元（ghost-cell）法在保持格式精度的前提下处理边界 。",
            "id": "4201210",
            "problem": "在用于聚变等离子体湍流的局域磁通管模型中，考虑径向坐标 $x$ 上的一个标量场 $f(x)$。该标量场代表磁轴附近一个径向平滑变化的量（例如，静电势或压力矩），并因物理对称性而在轴上施加了齐次诺伊曼边界条件 $\\partial_{x} f|_{x=0} = 0$。对于空间离散化，采用一个间距为 $\\Delta x$ 的均匀一维网格，其节点为 $x_{i} = i\\,\\Delta x$（其中 $i = 0, 1, \\dots, N$），并在 $i = -1$ 处设置一个位于 $x_{-1} = -\\Delta x$ 的虚节点，用于在边界处闭合中心差分格式。设 $f_{i}$ 表示近似 $f(x_{i})$ 的网格函数。\n\n您需要使用边界处导数的二阶中心差分近似来施加 $x=0$ 处的诺伊曼边界条件，这在离散层面上将 $f_{-1}$ 和 $f_{1}$ 耦合起来。请构建一个虚单元值 $f_{-1}$，其以网格量的闭合形式解析表达式表示，并且在中心差分下能为边界导数提供二阶精度。从导数的定义以及 $f(x)$ 在 $x=0$ 处的泰勒展开出发，通过推导边界导数的截断误差阶来证明您构建的一致性，明确显示在 $x=0$ 处中心差分算子的意义下，其误差阶为 $\\mathcal{O}(\\Delta x^{2})$。\n\n请以用网格函数值表示的虚单元值 $f_{-1}$ 的显式解析表达式作为您的最终答案。无需四舍五入。最终答案中不要包含单位。",
            "solution": "该问题要求确定一个在边界 $x=0$ 处、满足齐次诺伊曼条件 $\\partial_{x} f|_{x=0} = 0$ 的标量场 $f(x)$ 的虚单元值 $f_{-1}$。该构建必须与二阶中心差分格式一致。完成此构建后，需要对所得边界导数数值近似的二阶精度进行形式化证明。\n\n首先，我们构建虚单元值 $f_{-1}$ 的表达式。问题指定在边界节点 $x_{0} = 0$ 处对导数使用二阶中心差分近似。在网格点 $x_i$ 处，一阶导数 $\\frac{d}{dx}$ 的标准二阶中心差分算子使用相邻点 $x_{i-1}$ 和 $x_{i+1}$ 处的值。在边界点 $x_0 = 0$ 处，该算子由下式给出：\n$$\n\\left. \\frac{\\partial f}{\\partial x} \\right|_{x=0} \\approx \\frac{f(x_{1}) - f(x_{-1})}{x_1 - x_{-1}}\n$$\n使用指定的网格记法 $x_i = i\\,\\Delta x$，我们有 $x_1 = \\Delta x$ 和 $x_{-1} = -\\Delta x$。因此，使用网格函数值 $f_i$ 对 $x_0$ 处的导数进行的离散近似为：\n$$\n\\left. \\frac{\\partial f}{\\partial x} \\right|_{x_0} \\approx \\frac{f_{1} - f_{-1}}{2\\Delta x}\n$$\n物理边界条件是齐次诺伊曼条件 $\\partial_{x} f|_{x=0} = 0$。为离散地施加此条件，我们将导数的有限差分近似设为零：\n$$\n\\frac{f_{1} - f_{-1}}{2\\Delta x} = 0\n$$\n对该代数方程求解虚单元值 $f_{-1}$，得到所需的表达式：\n$$\nf_{1} - f_{-1} = 0 \\implies f_{-1} = f_{1}\n$$\n这就建立了设置虚单元值的规则：它等于第一个内部网格点 $x_1$ 处的网格函数值。\n\n接下来，我们必须通过推导边界导数近似的截断误差并证明其阶为 $\\mathcal{O}(\\Delta x^{2})$ 来展示该方法的一致性。在 $x_0 = 0$ 处有限差分算子的截断误差 $T_0$ 定义为，作用于精确、平滑函数 $f(x)$ 的算子与精确导数 $\\left. \\frac{df}{dx} \\right|_{x=0}$ 之间的差值：\n$$\nT_0 = \\frac{f(x_1) - f(x_{-1})}{2\\Delta x} - f'(0)\n$$\n其中 $f'(0)$ 表示 $\\left. \\frac{df}{dx} \\right|_{x=0}$。为分析此误差，我们采用函数 $f(x)$ 在点 $x=0$ 附近的泰勒级数展开。由于假设函数是平滑的，其各阶导数都存在。$f(x_1) = f(\\Delta x)$ 和 $f(x_{-1}) = f(-\\Delta x)$ 的展开式为：\n$$\nf(\\Delta x) = f(0) + \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{2}}{2!} f''(0) + \\frac{(\\Delta x)^{3}}{3!} f'''(0) + \\frac{(\\Delta x)^{4}}{4!} f^{(4)}(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\n$$\nf(-\\Delta x) = f(0) - \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{2}}{2!} f''(0) - \\frac{(\\Delta x)^{3}}{3!} f'''(0) + \\frac{(\\Delta x)^{4}}{4!} f^{(4)}(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\n我们通过从第一个级数中减去第二个级数来计算差值 $f(\\Delta x) - f(-\\Delta x)$。偶次幂项相互抵消：\n$$\nf(\\Delta x) - f(-\\Delta x) = \\left( \\Delta x \\, f'(0) - (-\\Delta x \\, f'(0)) \\right) + \\left( \\frac{(\\Delta x)^{3}}{6} f'''(0) - (-\\frac{(\\Delta x)^{3}}{6} f'''(0)) \\right) + \\mathcal{O}((\\Delta x)^{5})\n$$\n$$\nf(\\Delta x) - f(-\\Delta x) = 2 \\Delta x \\, f'(0) + \\frac{2(\\Delta x)^{3}}{6} f'''(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\n$$\nf(\\Delta x) - f(-\\Delta x) = 2 \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{3}}{3} f'''(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\n现在，将此结果代回截断误差 $T_0$ 的表达式中：\n$$\nT_0 = \\frac{2 \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{3}}{3} f'''(0) + \\mathcal{O}((\\Delta x)^{5})}{2\\Delta x} - f'(0)\n$$\n除以 $2\\Delta x$ 得到：\n$$\nT_0 = \\left( f'(0) + \\frac{(\\Delta x)^{2}}{6} f'''(0) + \\mathcal{O}((\\Delta x)^{4}) \\right) - f'(0)\n$$\n$f'(0)$ 项相互抵消，留下截断误差的最终表达式：\n$$\nT_0 = \\frac{(\\Delta x)^{2}}{6} f'''(0) + \\mathcal{O}((\\Delta x)^{4})\n$$\n假设 $f'''(0)$ 非零，则截断误差中的首项与 $(\\Delta x)^{2}$ 成正比。因此，截断误差的阶为 $\\mathcal{O}((\\Delta x)^{2})$。这证明了在边界处使用的中心差分算子是二阶精确的。构造 $f_{-1} = f_1$ 强制使离散导数为零，由于给定了物理条件 $f'(0)=0$，该值与算子的真实值 $\\frac{f(\\Delta x)-f(-\\Delta x)}{2\\Delta x}$ 相差一个量级为 $\\mathcal{O}((\\Delta x)^2)$。因此，诺伊曼边界条件的实现与该格式的二阶精度是一致的。",
            "answer": "$$\n\\boxed{f_{1}}\n$$"
        },
        {
            "introduction": "编写复杂的科学计算程序时，我们如何确保代码的正确性？人造解方法（Method of Manufactured Solutions, MMS）为代码验证提供了一个严谨而强大的框架。本练习将引导你为一个类回旋动理学方程设计一个人造解，并反向推导出相应的源项，从而构造一个具有精确解析解的离散问题 。通过这种方式，你可以精确地检验代码实现是否正确，以及其是否达到了设计的收敛阶。",
            "id": "4201204",
            "problem": "在聚变等离子体湍流模拟中，一种常见的验证策略是人工解方法（MMS），即指定一个光滑解，并推导出一个源项，使得数值格式在离散层面上精确可解。考虑一个在矩形周期性区域（坐标为 $x \\in [0,L_x)$ 和 $y \\in [0,L_y)$）上的稳态、二维、类回旋动理学对流-扩散模型，单位为无量纲。标量场 $g(x,y)$ 的方程为\n$$\nv_x \\,\\frac{\\partial g}{\\partial x} \\;+\\; v_y \\,\\frac{\\partial g}{\\partial y} \\;-\\; D \\left(\\frac{\\partial^2 g}{\\partial x^2} + \\frac{\\partial^2 g}{\\partial y^2}\\right) \\;=\\; S(x,y),\n$$\n其中 $v_x$ 和 $v_y$ 是恒定的对流速度（例如，代表电场叉乘磁场 $\\left(\\mathbf{E} \\times \\mathbf{B}\\right)$ 漂移的分量），$D>0$ 是一个恒定的跨场扩散系数。\n\n在一个均匀网格上对方程进行离散化，该网格在 $x$ 方向有 $N_x$ 个点，在 $y$ 方向有 $N_y$ 个点，网格间距分别为 $h_x = L_x/N_x$ 和 $h_y = L_y/N_y$。网格点记为 $x_i = i\\,h_x$ 和 $y_j = j\\,h_y$，其中整数索引 $i \\in \\{0,1,\\dots,N_x-1\\}$ 和 $j \\in \\{0,1,\\dots,N_y-1\\}$，并采用周期性边界条件。使用二阶中心有限差分来计算一阶导数，使用拉普拉斯算子的标准五点模板，即\n$$\n\\left(D_x g\\right)_{i,j} \\;=\\; \\frac{g_{i+1,j} - g_{i-1,j}}{2 h_x}, \n\\qquad\n\\left(D_y g\\right)_{i,j} \\;=\\; \\frac{g_{i,j+1} - g_{i,j-1}}{2 h_y},\n$$\n$$\n\\left(\\Delta_h g\\right)_{i,j} \\;=\\; \\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} \\;+\\; \\frac{g_{i,j+1} - 2 g_{i,j} + g_{i,j-1}}{h_y^2},\n$$\n其中索引采用周期性环绕。离散稳态算子则为\n$$\n\\left(\\mathcal{L}_h g\\right)_{i,j} \\;=\\; v_x \\left(D_x g\\right)_{i,j} \\;+\\; v_y \\left(D_y g\\right)_{i,j} \\;-\\; D \\left(\\Delta_h g\\right)_{i,j}.\n$$\n\n选择一个与周期性兼容的人工解，\n$$\ng(x,y) \\;=\\; \\cos\\!\\left(k_x x\\right)\\,\\cos\\!\\left(k_y y\\right),\n$$\n其中 $k_x = \\frac{2\\pi m}{L_x}$ 和 $k_y = \\frac{2\\pi n}{L_y}$，m 和 n 为固定整数。将网格点上的离散源定义为 $S_{i,j} \\equiv \\left(\\mathcal{L}_h g\\right)_{i,j}$，其中 $g_{i,j} = g(x_i,y_j)$。\n\n推导 $S_{i,j}$ 的一个闭式解析表达式，该表达式用 $v_x$, $v_y$, $D$, $h_x$, $h_y$, $k_x$, $k_y$, $x_i$ 和 $y_j$ 表示，并使得离散格式对于所选的 $g(x,y)$ 精确可解。将最终的 $S_{i,j}$ 表示为单个解析表达式。不需要进行数值计算或四舍五入，并且所有量都是无量纲的，因此答案中不应包含物理单位。",
            "solution": "该问题已经过验证，被认为是具有科学依据、适定且客观的。这是验证数值代码的人工解方法（MMS）中的一个标准练习，基于数值分析和偏微分方程的基本原理。所有必要信息均已提供，定义一致且无歧义。我们可以开始推导。\n\n目标是为离散源项 $S_{i,j}$ 推导一个闭式解析表达式，使得给定的离散格式对于人工解 $g(x,y)$ 是精确可解的。源项是通过将离散算子 $\\mathcal{L}_h$ 应用于在网格上求值的人工解 $g_{i,j} = g(x_i, y_j)$ 来定义的。\n离散算子由下式给出：\n$$\n\\left(\\mathcal{L}_h g\\right)_{i,j} \\;=\\; v_x \\left(D_x g\\right)_{i,j} \\;+\\; v_y \\left(D_y g\\right)_{i,j} \\;-\\; D \\left(\\Delta_h g\\right)_{i,j}\n$$\n人工解为：\n$$\ng(x,y) \\;=\\; \\cos(k_x x)\\,\\cos(k_y y)\n$$\n在网格点 $(x_i, y_j)$ 上求值，我们得到：\n$$\ng_{i,j} = g(x_i, y_j) = \\cos(k_x x_i)\\,\\cos(k_y y_j)\n$$\n我们将分别计算 $(\\mathcal{L}_h g)_{i,j}$ 的每一项。\n\n首先，我们计算 $x$ 方向的对流项 $v_x(D_x g)_{i,j}$。离散算子 $D_x$ 为：\n$$\n(D_x g)_{i,j} = \\frac{g_{i+1,j} - g_{i-1,j}}{2 h_x}\n$$\n我们需在相邻点上对 $g$ 进行求值：\n$$\ng_{i+1,j} = g(x_{i+1}, y_j) = g(x_i+h_x, y_j) = \\cos(k_x(x_i+h_x))\\cos(k_y y_j)\n$$\n$$\ng_{i-1,j} = g(x_{i-1}, y_j) = g(x_i-h_x, y_j) = \\cos(k_x(x_i-h_x))\\cos(k_y y_j)\n$$\n将这些代入 $(D_x g)_{i,j}$ 的表达式中：\n$$\n(D_x g)_{i,j} = \\frac{\\cos(k_x(x_i+h_x))\\cos(k_y y_j) - \\cos(k_x(x_i-h_x))\\cos(k_y y_j)}{2h_x}\n$$\n提出公因式 $\\cos(k_y y_j)$：\n$$\n(D_x g)_{i,j} = \\frac{\\cos(k_x x_i + k_x h_x) - \\cos(k_x x_i - k_x h_x)}{2h_x} \\cos(k_y y_j)\n$$\n我们使用三角恒等式 $\\cos(A+B) - \\cos(A-B) = -2\\sin A \\sin B$。令 $A = k_x x_i$ 和 $B = k_x h_x$，我们得到：\n$$\n(D_x g)_{i,j} = \\frac{-2\\sin(k_x x_i)\\sin(k_x h_x)}{2h_x} \\cos(k_y y_j) = -\\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j)\n$$\n\n其次，我们计算 $y$ 方向的对流项 $v_y(D_y g)_{i,j}$。根据对称性，计算过程是类似的。算子为：\n$$\n(D_y g)_{i,j} = \\frac{g_{i,j+1} - g_{i,j-1}}{2 h_y}\n$$\n相邻点上的值为：\n$$\ng_{i,j+1} = \\cos(k_x x_i)\\cos(k_y(y_j+h_y))\n$$\n$$\ng_{i,j-1} = \\cos(k_x x_i)\\cos(k_y(y_j-h_y))\n$$\n代入并使用相同的恒等式 $\\cos(A+B) - \\cos(A-B) = -2\\sin A \\sin B$，令 $A = k_y y_j$ 和 $B = k_y h_y$：\n$$\n(D_y g)_{i,j} = \\cos(k_x x_i) \\frac{\\cos(k_y y_j+k_y h_y) - \\cos(k_y y_j-k_y h_y)}{2h_y} = \\cos(k_x x_i) \\frac{-2\\sin(k_y y_j)\\sin(k_y h_y)}{2h_y}\n$$\n$$\n(D_y g)_{i,j} = -\\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j)\n$$\n\n第三，我们计算扩散项 $-D(\\Delta_h g)_{i,j}$。离散拉普拉斯算子为：\n$$\n(\\Delta_h g)_{i,j} = \\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} + \\frac{g_{i,j+1} - 2 g_{i,j} + g_{i,j-1}}{h_y^2}\n$$\n让我们分析拉普拉斯算子的第一部分（$x$方向的二阶导数）：\n$$\n\\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} = \\frac{(g_{i+1,j} + g_{i-1,j}) - 2 g_{i,j}}{h_x^2}\n$$\n我们使用三角恒等式 $\\cos(A+B) + \\cos(A-B) = 2\\cos A \\cos B$。令 $A = k_x x_i$ 和 $B = k_x h_x$：\n$$\ng_{i+1,j} + g_{i-1,j} = \\cos(k_x(x_i+h_x))\\cos(k_y y_j) + \\cos(k_x(x_i-h_x))\\cos(k_y y_j) = 2\\cos(k_x x_i)\\cos(k_x h_x)\\cos(k_y y_j)\n$$\n将此代入离散二阶导数的分子中：\n$$\ng_{i+1,j} - 2g_{i,j} + g_{i-1,j} = 2\\cos(k_x x_i)\\cos(k_x h_x)\\cos(k_y y_j) - 2\\cos(k_x x_i)\\cos(k_y y_j)\n$$\n$$\n= 2(\\cos(k_x h_x) - 1)\\cos(k_x x_i)\\cos(k_y y_j)\n$$\n因此，离散拉普拉斯算子的 $x$ 分量为：\n$$\n\\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} = \\frac{2(\\cos(k_x h_x) - 1)}{h_x^2} \\cos(k_x x_i)\\cos(k_y y_j)\n$$\n根据对称性，$y$ 分量为：\n$$\n\\frac{g_{i,j+1} - 2 g_{i,j} + g_{i,j-1}}{h_y^2} = \\frac{2(\\cos(k_y h_y) - 1)}{h_y^2} \\cos(k_x x_i)\\cos(k_y y_j)\n$$\n将这两个分量相加，得到作用于 $g_{i,j}$ 的离散拉普拉斯算子：\n$$\n(\\Delta_h g)_{i,j} = \\left( \\frac{2(\\cos(k_x h_x) - 1)}{h_x^2} + \\frac{2(\\cos(k_y h_y) - 1)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j)\n$$\n\n最后，我们通过组合计算出的三个部分来组装源项 $S_{i,j} = (\\mathcal{L}_h g)_{i,j}$：\n$$\nS_{i,j} = v_x \\left( -\\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j) \\right) + v_y \\left( -\\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j) \\right) - D \\left[ \\left( \\frac{2(\\cos(k_x h_x) - 1)}{h_x^2} + \\frac{2(\\cos(k_y h_y) - 1)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j) \\right]\n$$\n为清晰起见，重新整理各项并合并常数，得到最终表达式：\n$$\nS_{i,j} = -v_x \\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j) - v_y \\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j) + 2D \\left( \\frac{1 - \\cos(k_x h_x)}{h_x^2} + \\frac{1 - \\cos(k_y h_y)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j)\n$$\n这就是所要求的源项 $S_{i,j}$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{-v_x \\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j) - v_y \\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j) + 2D \\left( \\frac{1 - \\cos(k_x h_x)}{h_x^2} + \\frac{1 - \\cos(k_y h_y)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j)}\n$$"
        }
    ]
}