{
    "hands_on_practices": [
        {
            "introduction": "湍流的动力学行为从根本上受守恒律的制约。在编写任何代码之前，理解你希望模拟的连续模型的理想不变量至关重要。本练习旨在通过推导和比较二维湍流的两个基石模型——用于不可压缩流体的二维Navier-Stokes方程和用于等离子体中漂移波湍流的Charney-Hasegawa-Mima (CHM)方程——的守恒能量和涡通量，来锻炼你的分析能力。通过为特定的初始能谱计算这些量，你将具体理解像CHM模型中有限拉莫尔半径效应这样的基础物理，是如何在这些基本不变量中体现出来的。",
            "id": "4192154",
            "problem": "在与聚变装置相关的磁化等离子体板模型中，漂移波湍流通常由Charney–Hasegawa–Mima (CHM)方程建模，并与二维不可压缩Navier–Stokes (NS)涡量方程进行比较。考虑$x$–$y$平面上一个边长为$L$的正方形周期性区域，坐标为$\\boldsymbol{x}=(x,y)$，具有周期性边界条件。设静电势为$\\phi(\\boldsymbol{x},t)$，流函数为$\\psi(\\boldsymbol{x},t)$。定义空间傅里叶级数为\n$\\phi(\\boldsymbol{x})=\\sum_{\\boldsymbol{k}}\\phi_{\\boldsymbol{k}}\\exp(i\\boldsymbol{k}\\cdot\\boldsymbol{x})$和$\\psi(\\boldsymbol{x})=\\sum_{\\boldsymbol{k}}\\psi_{\\boldsymbol{k}}\\exp(i\\boldsymbol{k}\\cdot\\boldsymbol{x})$，其中$\\phi_{\\boldsymbol{k}}=\\frac{1}{L^{2}}\\int_{[0,L]^2}\\phi(\\boldsymbol{x})\\exp(-i\\boldsymbol{k}\\cdot\\boldsymbol{x})\\,\\mathrm{d}^{2}x$（$\\psi_{\\boldsymbol{k}}$也类似），离散波矢量为$\\boldsymbol{k}=\\frac{2\\pi}{L}(m,n)$，其中$m,n$为整数。此归一化意味着帕塞瓦尔恒等式$\\int_{[0,L]^2}|\\phi|^{2}\\,\\mathrm{d}^{2}x=L^{2}\\sum_{\\boldsymbol{k}}|\\phi_{\\boldsymbol{k}}|^{2}$。\n\n二维不可压缩涡量方程为$\\partial_{t}\\omega+\\{\\psi,\\omega\\}=0$，其中$\\omega=\\nabla^{2}\\psi$且$\\{a,b\\}=\\partial_{x}a\\,\\partial_{y}b-\\partial_{y}a\\,\\partial_{x}b$。CHM方程为$\\partial_{t}q+\\{\\phi,q\\}=0$，其中$q=\\nabla^{2}\\phi-\\phi/\\rho_{s}^{2}$是广义位涡，$\\rho_{s}$是离子声拉莫尔半径。对于这两个模型，周期性边界意味着由场构造的二次不变量是守恒的。\n\n仅从这些定义和流的不可压缩性出发，完成以下任务。\n\n- 使用不可压缩流的动能密度和涡量的定义，推导表示NS模型总能量和总拟能的二次不变量，并用$\\psi_{\\boldsymbol{k}}$以谱形式写出它们。\n- 使用CHM位涡$q$和极化（有限拉莫尔半径）能，推导表示CHM模型总广义能量和总位拟能的二次不变量，并用$\\phi_{\\boldsymbol{k}}$和$\\rho_{s}$以谱形式写出它们。\n- 考虑一个在$t=0$时的初值问题，其中初始场被选择为重合的，$\\psi(\\boldsymbol{x},0)=\\phi(\\boldsymbol{x},0)$，并且它们的谱是各向同性的，且支撑在波数空间的一个有限环带上：对于$k=|\\boldsymbol{k}|$在$[k_{1},k_{2}]$（其中$0  k_1  k_2$）且每模式谱为 $|\\phi_{\\boldsymbol{k}}(0)|^2 = Ck^{-p}$ 的情况，计算并报告CHM模型的无量纲比率 $R=\\rho_{s}^{2}\\,Z_{\\mathrm{CHM}}(0)/E_{\\mathrm{CHM}}(0)$。",
            "solution": "我们从每个模型的第一性原理出发，然后转到傅里叶表示，最后对给定的初始谱分布计算所要求的比率。\n\n对于二维不可压缩Navier–Stokes (NS)模型，速度为$\\boldsymbol{u}=\\hat{\\boldsymbol{z}}\\times\\nabla\\psi$，这意味着$|\\boldsymbol{u}|^{2}=|\\nabla\\psi|^{2}$。因此，动能为\n$$\nE_{\\mathrm{NS}}=\\frac{1}{2}\\int_{[0,L]^2}|\\nabla\\psi|^{2}\\,\\mathrm{d}^{2}x.\n$$\n标量涡量为$\\omega=\\nabla^{2}\\psi$。拟能定义为均方涡量，\n$$\nZ_{\\mathrm{NS}}=\\frac{1}{2}\\int_{[0,L]^2}\\omega^{2}\\,\\mathrm{d}^{2}x=\\frac{1}{2}\\int_{[0,L]^2}(\\nabla^{2}\\psi)^{2}\\,\\mathrm{d}^{2}x.\n$$\n这些不变量是通过将涡量方程$\\partial_{t}\\omega+\\{\\psi,\\omega\\}=0$乘以$\\psi$和$\\omega$，在周期性区域上积分，并利用泊松括号的反对称性和不可压缩性来消除通量项得到的：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\int |\\nabla\\psi|^{2}\\,\\mathrm{d}^{2}x\\right)=0,\\qquad \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\int \\omega^{2}\\,\\mathrm{d}^{2}x\\right)=0.\n$$\n转到具有所述归一化的谱形式，我们使用$\\int |\\nabla\\psi|^{2}\\,\\mathrm{d}^{2}x=L^{2}\\sum_{\\boldsymbol{k}}k^{2}|\\psi_{\\boldsymbol{k}}|^{2}$和$\\int (\\nabla^{2}\\psi)^{2}\\,\\mathrm{d}^{2}x=L^{2}\\sum_{\\boldsymbol{k}}k^{4}|\\psi_{\\boldsymbol{k}}|^{2}$。因此\n$$\nE_{\\mathrm{NS}}=\\frac{L^{2}}{2}\\sum_{\\boldsymbol{k}}k^{2}|\\psi_{\\boldsymbol{k}}|^{2},\\qquad Z_{\\mathrm{NS}}=\\frac{L^{2}}{2}\\sum_{\\boldsymbol{k}}k^{4}|\\psi_{\\boldsymbol{k}}|^{2}.\n$$\n\n对于Charney–Hasegawa–Mima (CHM)模型，广义位涡为$q=\\nabla^{2}\\phi-\\phi/\\rho_{s}^{2}$。CHM方程$\\partial_{t}q+\\{\\phi,q\\}=0$意味着两个二次不变量。第一个是广义能量，由电场叉磁场（E叉B）漂移的动能贡献和极化（有限拉莫尔半径）能组成：\n$$\nE_{\\mathrm{CHM}}=\\frac{1}{2}\\int_{[0,L]^2}\\left(|\\nabla\\phi|^{2}+\\frac{\\phi^{2}}{\\rho_{s}^{2}}\\right)\\,\\mathrm{d}^{2}x.\n$$\n第二个是位拟能，\n$$\nZ_{\\mathrm{CHM}}=\\frac{1}{2}\\int_{[0,L]^2}q^{2}\\,\\mathrm{d}^{2}x=\\frac{1}{2}\\int_{[0,L]^2}\\left(\\nabla^{2}\\phi-\\frac{\\phi}{\\rho_{s}^{2}}\\right)^{2}\\,\\mathrm{d}^{2}x.\n$$\n这些是通过将$\\partial_{t}q+\\{\\phi,q\\}=0$乘以$\\phi$以得到$\\partial_{t}\\left(\\frac{1}{2}(|\\nabla\\phi|^{2}+\\phi^{2}/\\rho_{s}^{2})\\right)+\\nabla\\cdot(\\cdots)=0$和乘以$q$以得到$\\partial_{t}(q^{2}/2)+\\nabla\\cdot(\\cdots)=0$，然后在周期性区域上积分以去掉散度项得到的。\n\n在谱形式中，使用$\\int |\\nabla\\phi|^{2}\\,\\mathrm{d}^{2}x=L^{2}\\sum_{\\boldsymbol{k}}k^{2}|\\phi_{\\boldsymbol{k}}|^{2}$和$\\int \\phi^{2}\\,\\mathrm{d}^{2}x=L^{2}\\sum_{\\boldsymbol{k}}|\\phi_{\\boldsymbol{k}}|^{2}$，以及$q_{\\boldsymbol{k}}=-(k^{2}+1/\\rho_{s}^{2})\\phi_{\\boldsymbol{k}}$（对于二次量，负号无关紧要），我们得到\n$$\nE_{\\mathrm{CHM}}=\\frac{L^{2}}{2}\\sum_{\\boldsymbol{k}}\\left(k^{2}+\\frac{1}{\\rho_{s}^{2}}\\right)|\\phi_{\\boldsymbol{k}}|^{2},\\qquad Z_{\\mathrm{CHM}}=\\frac{L^{2}}{2}\\sum_{\\boldsymbol{k}}\\left(k^{2}+\\frac{1}{\\rho_{s}^{2}}\\right)^{2}|\\phi_{\\boldsymbol{k}}|^{2}.\n$$\n\n我们现在施加初始条件$\\psi(\\boldsymbol{x},0)=\\phi(\\boldsymbol{x},0)$以及支撑在环带$k\\in[k_{1},k_{2}]$上的各向同性每模式谱，即\n$$\n|\\phi_{\\boldsymbol{k}}(0)|^{2}=C\\,k^{-p}\\quad \\text{for}\\ \\ k\\in[k_{1},k_{2}],\\qquad |\\phi_{\\boldsymbol{k}}(0)|^{2}=0\\ \\ \\text{otherwise},\n$$\n其中$C0$且$p\\neq 2,4,6$。在大区域极限下，我们使用与我们的傅里叶归一化相关的模式计数测度将求和替换为积分：\n$$\n\\sum_{\\boldsymbol{k}}g(k)\\ \\to\\ \\frac{L^{2}}{(2\\pi)^{2}}\\int_{\\mathbb{R}^{2}}g(|\\boldsymbol{k}|)\\,\\mathrm{d}^{2}k\\ =\\ \\frac{L^{2}}{2\\pi}\\int_{0}^{\\infty}k\\,g(k)\\,\\mathrm{d}k.\n$$\n因此，初始CHM不变量成为球壳积分，\n$$\nE_{\\mathrm{CHM}}(0)=\\frac{L^{2}}{2}\\cdot \\frac{L^{2}}{2\\pi}\\int_{k_{1}}^{k_{2}}k\\left(k^{2}+\\frac{1}{\\rho_{s}^{2}}\\right)C\\,k^{-p}\\,\\mathrm{d}k,\\qquad\nZ_{\\mathrm{CHM}}(0)=\\frac{L^{2}}{2}\\cdot \\frac{L^{2}}{2\\pi}\\int_{k_{1}}^{k_{2}}k\\left(k^{2}+\\frac{1}{\\rho_{s}^{2}}\\right)^{2}C\\,k^{-p}\\,\\mathrm{d}k.\n$$\n公共常数在该比率中被抵消。为简洁起见，定义$\\alpha:=\\rho_{s}^{-2}$，这两个积分简化为\n$$\nI_{1}:=\\int_{k_{1}}^{k_{2}}k^{1-p}\\left(k^{2}+\\alpha\\right)\\,\\mathrm{d}k\n=\\int_{k_{1}}^{k_{2}}\\left(k^{3-p}+\\alpha\\,k^{1-p}\\right)\\,\\mathrm{d}k\n=\\left[\\frac{k^{4-p}}{4-p}+\\alpha\\,\\frac{k^{2-p}}{2-p}\\right]_{k_{1}}^{k_{2}},\n$$\n$$\nI_{2}:=\\int_{k_{1}}^{k_{2}}k^{1-p}\\left(k^{2}+\\alpha\\right)^{2}\\,\\mathrm{d}k\n=\\int_{k_{1}}^{k_{2}}\\left(k^{5-p}+2\\alpha\\,k^{3-p}+\\alpha^{2}k^{1-p}\\right)\\,\\mathrm{d}k\n=\\left[\\frac{k^{6-p}}{6-p}+2\\alpha\\,\\frac{k^{4-p}}{4-p}+\\alpha^{2}\\,\\frac{k^{2-p}}{2-p}\\right]_{k_{1}}^{k_{2}},\n$$\n其中限制条件$p\\neq 2,4,6$确保了原函数是良定义的。因此，\n$$\n\\frac{Z_{\\mathrm{CHM}}(0)}{E_{\\mathrm{CHM}}(0)}=\\frac{I_{2}}{I_{1}}.\n$$\n所求的无量纲比率为$R=\\rho_{s}^{2}\\,I_{2}/I_{1}$。代入$\\alpha=\\rho_{s}^{-2}$并明确写出定积分可得\n$$\nR=\\frac{\\rho_{s}^{2}\\left(\\dfrac{k_{2}^{6-p}-k_{1}^{6-p}}{6-p}\\right)+2\\left(\\dfrac{k_{2}^{4-p}-k_{1}^{4-p}}{4-p}\\right)+\\rho_{s}^{-2}\\left(\\dfrac{k_{2}^{2-p}-k_{1}^{2-p}}{2-p}\\right)}{\\left(\\dfrac{k_{2}^{4-p}-k_{1}^{4-p}}{4-p}\\right)+\\rho_{s}^{-2}\\left(\\dfrac{k_{2}^{2-p}-k_{1}^{2-p}}{2-p}\\right)}.\n$$\n这是一个用$k_{1}$、$k_{2}$、$p$和$\\rho_{s}$表示的闭式解析表达式，并且与$C$、$L$以及谱的整体归一化无关。\n\n为完整起见，对于相同的初始条件$\\psi(\\boldsymbol{x},0)=\\phi(\\boldsymbol{x},0)$，NS的初始不变量为\n$$\nE_{\\mathrm{NS}}(0)\\propto \\int_{k_{1}}^{k_{2}}k^{1-p}\\,k^{2}\\,\\mathrm{d}k=\\left[\\frac{k^{4-p}}{4-p}\\right]_{k_{1}}^{k_{2}},\\qquad\nZ_{\\mathrm{NS}}(0)\\propto \\int_{k_{1}}^{k_{2}}k^{1-p}\\,k^{4}\\,\\mathrm{d}k=\\left[\\frac{k^{6-p}}{6-p}\\right]_{k_{1}}^{k_{2}},\n$$\n这突显了由于CHM中与$1/\\rho_{s}^{2}$成正比的极化项，NS和CHM二次不变量之间的结构差异。然而，只要求报告CHM比率$R$。",
            "answer": "$$\\boxed{\\frac{\\rho_{s}^{2}\\left(\\dfrac{k_{2}^{6-p}-k_{1}^{6-p}}{6-p}\\right)+2\\left(\\dfrac{k_{2}^{4-p}-k_{1}^{4-p}}{4-p}\\right)+\\rho_{s}^{-2}\\left(\\dfrac{k_{2}^{2-p}-k_{1}^{2-p}}{2-p}\\right)}{\\left(\\dfrac{k_{2}^{4-p}-k_{1}^{4-p}}{4-p}\\right)+\\rho_{s}^{-2}\\left(\\dfrac{k_{2}^{2-p}-k_{1}^{2-p}}{2-p}\\right)}}$$"
        },
        {
            "introduction": "将一个物理问题转化为模拟，需要用代码所使用的归一化单位来表达它。本练习将指导你完成这一基本过程，从一个物理定义的初始能谱开始。你将学习如何归一化能谱，使其与代码的特征长度和速度标度相一致，这是正确设置湍流涨落初始幅度的关键一步。此外，该练习通过证明作为数值稳定性基石的Courant-Friedrichs-Lewy (CFL)条件在此归一化下保持不变，从而加强了物理标度与数值约束之间的联系。",
            "id": "4192207",
            "problem": "考虑一个二维静电湍流初值问题，其电场叉磁场漂移速度场的单位质量动能由一维各向同性垂直能量谱确定。设波数 $k \\ge 0$ 的有量纲初始谱规定为\n$$\nE(k) = A\\, k^{3} \\exp\\!\\left[-\\left(\\frac{k}{k_{p}}\\right)^{2}\\right],\n$$\n其中 $A$ 是一个由总能量约束决定的常数，$k_{p}$ 是一个特征注入波数。物理上可测量的约束条件是\n$$\n\\int_{0}^{\\infty} E(k)\\, \\mathrm{d}k \\;=\\; \\frac{1}{2}\\, U_{\\mathrm{rms}}^{2},\n$$\n其中 $U_{\\mathrm{rms}}$ 是电场叉磁场漂移速度场的均方根漂移速率。\n\n引入基于特征长度 $L_{0}$ 和特征速度 $V_{0}$ 的归一化变量，\n$$\nx \\;=\\; L_{0}\\, \\bar{x}, \\qquad t \\;=\\; \\frac{L_{0}}{V_{0}}\\, \\bar{t}, \\qquad k \\;=\\; \\frac{\\bar{k}}{L_{0}}, \\qquad v \\;=\\; V_{0}\\, \\bar{v}.\n$$\n通过以下要求定义无量纲谱 $\\bar{E}(\\bar{k})$\n$$\n\\int_{0}^{\\infty} \\bar{E}(\\bar{k})\\, \\mathrm{d}\\bar{k} \\;=\\; \\frac{1}{2}\\, \\overline{U}_{\\mathrm{rms}}^{2}, \\qquad \\text{其中} \\quad \\overline{U}_{\\mathrm{rms}} \\;=\\; \\frac{U_{\\mathrm{rms}}}{V_{0}}.\n$$\n\n任务1：根据能量约束确定常数 $A$，然后推导出归一化谱 $\\bar{E}(\\bar{k})$ 关于无量纲参数的显式闭合表达式\n$$\n\\mu \\;\\equiv\\; \\frac{U_{\\mathrm{rms}}}{V_{0}}, \\qquad \\kappa \\;\\equiv\\; L_{0}\\, k_{p}.\n$$\n你最终的 $\\bar{E}(\\bar{k})$ 表达式必须被简化为仅依赖于 $\\mu$、$\\kappa$ 和 $\\bar{k}$。\n\n任务2：对于一个受 Courant–Friedrichs–Lewy (CFL) 约束的显式时间推进格式，其时间步长为 $\\Delta t$，网格间距为 $\\Delta x$，最大特征速度为 $a$，则有量纲的库朗数是\n$$\n\\nu \\;=\\; \\frac{a\\, \\Delta t}{\\Delta x}.\n$$\n在上述归一化下，确定归一化的库朗数 $\\bar{\\nu}$ 并给出比值 $\\bar{\\nu}/\\nu$ 的值。\n\n答案规格：将你的最终答案以一个行矩阵的形式给出，该矩阵包含 $\\bar{E}(\\bar{k})$ 的解析表达式和 $\\bar{\\nu}/\\nu$ 的值。不包括单位。无需四舍五入。",
            "solution": "该问题被验证为自洽的、有科学依据的、且是适定的。所要求的推导基于流体和等离子体动力学中量纲分析、归一化和能谱理论的标准原理。所有必要信息均已提供。\n\n解答分为问题陈述中指定的两个任务。\n\n任务1：确定归一化能谱 $\\bar{E}(\\bar{k})$。\n\n首先，必须根据总能量约束确定有量纲能谱 $E(k)$ 中的常数 $A$。该约束由下式给出：\n$$\n\\int_{0}^{\\infty} E(k)\\, \\mathrm{d}k = \\frac{1}{2}\\, U_{\\mathrm{rms}}^{2}\n$$\n代入给定的谱形式 $E(k) = A\\, k^{3} \\exp\\left[-\\left(\\frac{k}{k_{p}}\\right)^{2}\\right]$，我们有：\n$$\nA \\int_{0}^{\\infty} k^{3} \\exp\\left[-\\left(\\frac{k}{k_{p}}\\right)^{2}\\right]\\, \\mathrm{d}k = \\frac{1}{2}\\, U_{\\mathrm{rms}}^{2}\n$$\n为计算该积分，我们进行变量替换。令 $u = \\left(\\frac{k}{k_{p}}\\right)^{2}$。这意味着 $k = k_{p} \\sqrt{u}$，因此微分元为 $\\mathrm{d}k = k_{p} \\frac{1}{2\\sqrt{u}} \\mathrm{d}u$。积分上下限仍为从 $0$ 到 $\\infty$。将这些代入积分中：\n$$\n\\int_{0}^{\\infty} (k_{p}\\sqrt{u})^{3} \\exp(-u) \\left(k_{p} \\frac{1}{2\\sqrt{u}}\\right)\\, \\mathrm{d}u = \\int_{0}^{\\infty} k_{p}^{3} u^{\\frac{3}{2}} \\exp(-u) \\frac{k_{p}}{2} u^{-\\frac{1}{2}}\\, \\mathrm{d}u\n$$\n$$\n= \\frac{k_{p}^{4}}{2} \\int_{0}^{\\infty} u^{1} \\exp(-u)\\, \\mathrm{d}u\n$$\n所得积分是伽马函数的定义，$\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} \\exp(-t)\\, \\mathrm{d}t$。在我们的例子中，$z-1=1$，所以 $z=2$。\n$$\n\\int_{0}^{\\infty} u \\exp(-u)\\, \\mathrm{d}u = \\Gamma(2) = 1! = 1\n$$\n因此，该积分的值为 $\\frac{k_{p}^{4}}{2}$。将此结果代回能量约束方程：\n$$\nA \\left(\\frac{k_{p}^{4}}{2}\\right) = \\frac{1}{2} U_{\\mathrm{rms}}^{2}\n$$\n求解 $A$，我们得到：\n$$\nA = \\frac{U_{\\mathrm{rms}}^{2}}{k_{p}^{4}}\n$$\n接下来，我们需要找到有量纲谱 $E(k)$ 和无量纲谱 $\\bar{E}(\\bar{k})$ 之间的关系。总能量通过以下方式关联：\n$$\n\\frac{1}{2} U_{\\mathrm{rms}}^{2} = \\int_{0}^{\\infty} E(k)\\, \\mathrm{d}k\n$$\n$$\n\\frac{1}{2} \\overline{U}_{\\mathrm{rms}}^{2} = \\int_{0}^{\\infty} \\bar{E}(\\bar{k})\\, \\mathrm{d}\\bar{k}\n$$\n使用给定的归一化关系 $U_{\\mathrm{rms}} = V_{0} \\overline{U}_{\\mathrm{rms}}$ 和 $k = \\bar{k}/L_{0}$（这意味着 $\\mathrm{d}k = \\mathrm{d}\\bar{k}/L_{0}$），我们可以将两个能量的积分表达式联系起来。\n$$\n\\int_{0}^{\\infty} E(k)\\, \\mathrm{d}k = \\frac{1}{2} (V_{0}\\overline{U}_{\\mathrm{rms}})^{2} = V_{0}^{2} \\left(\\frac{1}{2}\\overline{U}_{\\mathrm{rms}}^{2}\\right) = V_{0}^{2} \\int_{0}^{\\infty} \\bar{E}(\\bar{k})\\, \\mathrm{d}\\bar{k}\n$$\n现在，对等式左侧进行变量替换：\n$$\n\\int_{0}^{\\infty} E\\left(\\frac{\\bar{k}}{L_{0}}\\right) \\frac{\\mathrm{d}\\bar{k}}{L_{0}} = V_{0}^{2} \\int_{0}^{\\infty} \\bar{E}(\\bar{k})\\, \\mathrm{d}\\bar{k}\n$$\n由于此等式必须对任意谱成立，因此被积函数必须相等：\n$$\n\\frac{1}{L_{0}} E\\left(\\frac{\\bar{k}}{L_{0}}\\right) = V_{0}^{2} \\bar{E}(\\bar{k})\n$$\n这给出了谱的变换规则：\n$$\n\\bar{E}(\\bar{k}) = \\frac{1}{L_{0}V_{0}^{2}} E\\left(\\frac{\\bar{k}}{L_{0}}\\right)\n$$\n现在我们代入 $E(k)$ 的表达式，其中 $k=\\bar{k}/L_{0}$，以及推导出的 $A$ 的值：\n$$\n\\bar{E}(\\bar{k}) = \\frac{1}{L_{0}V_{0}^{2}} \\left(A \\left(\\frac{\\bar{k}}{L_{0}}\\right)^{3} \\exp\\left[-\\left(\\frac{\\bar{k}/L_{0}}{k_{p}}\\right)^{2}\\right]\\right)\n$$\n$$\n\\bar{E}(\\bar{k}) = \\frac{A}{L_{0}^{4}V_{0}^{2}} \\bar{k}^{3} \\exp\\left[-\\left(\\frac{\\bar{k}}{L_{0}k_{p}}\\right)^{2}\\right]\n$$\n代入 $A = U_{\\mathrm{rms}}^{2}/k_{p}^{4}$：\n$$\n\\bar{E}(\\bar{k}) = \\frac{U_{\\mathrm{rms}}^{2}/k_{p}^{4}}{L_{0}^{4}V_{0}^{2}} \\bar{k}^{3} \\exp\\left[-\\left(\\frac{\\bar{k}}{L_{0}k_{p}}\\right)^{2}\\right] = \\left(\\frac{U_{\\mathrm{rms}}}{V_{0}}\\right)^{2} \\frac{1}{(L_{0}k_{p})^{4}} \\bar{k}^{3} \\exp\\left[-\\left(\\frac{\\bar{k}}{L_{0}k_{p}}\\right)^{2}\\right]\n$$\n最后，我们使用无量纲参数的定义 $\\mu = U_{\\mathrm{rms}}/V_{0}$ 和 $\\kappa = L_{0}k_{p}$：\n$$\n\\bar{E}(\\bar{k}) = \\mu^{2} \\frac{1}{\\kappa^{4}} \\bar{k}^{3} \\exp\\left[-\\left(\\frac{\\bar{k}}{\\kappa}\\right)^{2}\\right]\n$$\n这就是所求的归一化谱的闭合形式表达式。\n\n任务2：确定归一化的库朗数 $\\bar{\\nu}$ 和比值 $\\bar{\\nu}/\\nu$。\n\n有量纲的库朗数由下式给出：\n$$\n\\nu = \\frac{a \\Delta t}{\\Delta x}\n$$\n其中 $a$ 是特征速度，$\\Delta t$ 是时间步长，$\\Delta x$ 是网格间距。\n归一化的库朗数 $\\bar{\\nu}$ 是根据相应的归一化量 $\\bar{a}$、$\\Delta\\bar{t}$ 和 $\\Delta\\bar{x}$ 定义的：\n$$\n\\bar{\\nu} = \\frac{\\bar{a} \\Delta \\bar{t}}{\\Delta \\bar{x}}\n$$\n为了找到 $\\nu$ 和 $\\bar{\\nu}$ 之间的关系，我们使用提供的缩放关系将有量纲的量表示为归一化的量：\n-   $a = V_{0} \\bar{a}$（因为 $a$ 是一个速度，所以它的缩放方式与 $V_{0}$ 相同）\n-   $\\Delta t = \\frac{L_{0}}{V_{0}} \\Delta \\bar{t}$（由 $t = \\frac{L_{0}}{V_{0}} \\bar{t}$ 得出）\n-   $\\Delta x = L_{0} \\Delta \\bar{x}$（由 $x = L_{0} \\bar{x}$ 得出）\n\n现在，将这些代入 $\\nu$ 的表达式中：\n$$\n\\nu = \\frac{(V_{0} \\bar{a}) \\left(\\frac{L_{0}}{V_{0}} \\Delta \\bar{t}\\right)}{L_{0} \\Delta \\bar{x}}\n$$\n有量纲的缩放因子 $L_{0}$ 和 $V_{0}$ 被消掉了：\n$$\n\\nu = \\frac{V_{0} L_{0} \\bar{a} \\Delta \\bar{t}}{V_{0} L_{0} \\Delta \\bar{x}} = \\frac{\\bar{a} \\Delta \\bar{t}}{\\Delta \\bar{x}}\n$$\n根据定义，右侧是归一化的库朗数 $\\bar{\\nu}$。因此，我们有：\n$$\n\\nu = \\bar{\\nu}\n$$\n这个结果表明，库朗数在这种归一化方案下是不变量。因此，比值 $\\bar{\\nu}/\\nu$ 为：\n$$\n\\frac{\\bar{\\nu}}{\\nu} = 1\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\mu^{2}}{\\kappa^{4}} \\bar{k}^{3} \\exp\\left(-\\frac{\\bar{k}^{2}}{\\kappa^{2}}\\right)  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在电磁模拟中，满足像库仑规范条件（$\\nabla \\cdot \\mathbf{A} = 0$）这样的物理约束，不僅是為了物理上的精确性，也是保证数值稳定性的关键要求。本编码练习直面这一挑战，模拟了一个初始矢量势包含“规范污染”的场景，这种污染会激发非物理的高频振荡。你将在傅里叶空间中实现一种投影方法来“清洗”初始数据以强制执行规范条件，并量化这一操作对数值格式所允许的最大稳定时间步长的显著改善。此练习展示了一种确保电磁等离子体模拟中初值问题适定性和稳定性的强大技术。",
            "id": "4192185",
            "problem": "考虑一个与聚变等离子体湍流模拟相关的简化电磁初值问题，该问题定义在一个周期性方形域上，其中一个谱方法求解器用于推进矢量势的傅里叶系数。电磁场由标量势 $ \\phi(\\mathbf{x}, t) $ 和矢量势 $ \\mathbf{A}(\\mathbf{x}, t) $ 表示，其中磁场 $ \\mathbf{B} = \\nabla \\times \\mathbf{A} $，电场 $ \\mathbf{E} = -\\partial_t \\mathbf{A} - \\nabla \\phi $。对于任何足够光滑的规范函数 $ \\chi(\\mathbf{x}, t) $，规范自由度通过变换 $ \\mathbf{A} \\rightarrow \\mathbf{A} + \\nabla \\chi $ 和 $ \\phi \\rightarrow \\phi - \\partial_t \\chi $ 来表示。库仑规范强制要求 $ \\nabla \\cdot \\mathbf{A} = 0 $。在谱方法求解器中，库仑规范条件转化为对每个傅里叶模式 $ \\mathbf{k} $ 的傅里叶空间约束 $ \\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}} = 0 $。\n\n在库仑规范和归一化单位下的线性化麦克斯韦动力学中，矢量势的横向动力学遵循波动方程 $ \\partial_t^2 \\mathbf{A} - \\nabla^2 \\mathbf{A} = 0 $，在傅里叶空间中，只要满足 $ \\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}} = 0 $，该方程对每个模式简化为 $ \\partial_t^2 \\mathbf{A}_{\\mathbf{k}} + |\\mathbf{k}|^2 \\mathbf{A}_{\\mathbf{k}} = 0 $。许多计算方案会增加一个显式的罚项来抑制对规范约束的违反，这导致纵向分量产生一个刚性贡献，其模型为 $ \\partial_t^2 \\mathbf{A}_{\\parallel, \\mathbf{k}} + \\left(|\\mathbf{k}|^2 + p\\right) \\mathbf{A}_{\\parallel, \\mathbf{k}} = 0 $，其中 $ p \\ge 0 $ 是一个用户选择的罚参数，$ \\mathbf{A}_{\\parallel, \\mathbf{k}} $ 表示 $ \\mathbf{A}_{\\mathbf{k}} $ 平行于 $ \\mathbf{k} $ 的分量。\n\n您必须为 $ t = 0 $ 时具有给定受控规范污染的势构建初值问题，然后使用傅里叶空间中的投影来强制执行规范约束。具体来说：\n\n- 设傅里叶模式集为一个有限列表 $ \\mathcal{K} \\subset \\mathbb{Z}^2 \\setminus \\{\\mathbf{0}\\} $，其中包含二维波矢 $ \\mathbf{k} = (k_x, k_y) $。\n- 对于每个 $ \\mathbf{k} \\in \\mathcal{K} $，定义单位矢量 $ \\hat{\\mathbf{k}} = \\mathbf{k} / |\\mathbf{k}| $ 和横向单位矢量 $ \\hat{\\mathbf{e}}_{\\perp, \\mathbf{k}} = \\frac{1}{|\\mathbf{k}|}(-k_y, k_x) $，使得 $ \\hat{\\mathbf{e}}_{\\perp, \\mathbf{k}} \\cdot \\hat{\\mathbf{k}} = 0 $。\n- 构造 $ t = 0 $ 时的初始矢量势傅里叶系数为 $ \\mathbf{A}_{\\mathbf{k}}(0) = a_{\\mathbf{k}} \\left( \\hat{\\mathbf{e}}_{\\perp, \\mathbf{k}} + g \\, \\hat{\\mathbf{k}} \\right) $，其中 $ a_{\\mathbf{k}} = |\\mathbf{k}|^{-s} $，谱指数 $ s \\ge 0 $，非负的规范污染幅度 $ g \\ge 0 $ 控制纵向内容相对于横向内容的比例。设 $ \\phi_{\\mathbf{k}}(0) $ 为任意值，在 $ t = 0 $ 时仅使用矢量势进行规范投影。\n\n部分 A：根据规范变换和亥姆霍兹分解，推导在 $ t = 0 $ 时强制执行库仑规范同时保持 $ t=0 $ 时物理电场不变的傅里叶空间投影。最后给出投影后矢量势 $ \\mathbf{A}'_{\\mathbf{k}}(0) $ 关于 $ \\mathbf{A}_{\\mathbf{k}}(0) $ 和 $ \\mathbf{k} $ 的显式公式。\n\n部分 B：将振子方程 $ \\partial_t^2 y + \\omega^2 y = 0 $ 的二阶中心差分时间格式逐模式应用，分析显式时间步进格式的线性稳定性。证明稳定性要求对每个振子都满足 $ \\Delta t \\, \\omega \\le 2 $，并由此推导出耦合系统的最大稳定时间步长 $ \\Delta t_{\\max} = 2 / \\max_{\\mathbf{k}} \\omega_{\\mathbf{k}} $。在存在规范污染和罚项 $ p $ 的情况下，纵向分量的频率为 $ \\omega_{\\parallel, \\mathbf{k}} = \\sqrt{|\\mathbf{k}|^2 + p} $；在纯横向情况下，$ \\omega_{\\perp, \\mathbf{k}} = |\\mathbf{k}| $。通过计算当 $ g  0 $ 和 $ p  0 $ 时的 $ \\Delta t_{\\max}^{\\text{pre}} $，以及在投影强制执行 $ \\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0) = 0 $ 从而消除纵向分量后的 $ \\Delta t_{\\max}^{\\text{post}} $，来量化初始规范选择的影响。\n\n部分 C：定义以下关于初始规范选择及其修正的度量：\n- 规范违背分数 $ \\delta = \\frac{\\sum_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0)|^2}{\\sum_{\\mathbf{k} \\in \\mathcal{K}} \\|\\mathbf{A}_{\\mathbf{k}}(0)\\|^2} $。\n- 投影移除的能量分数 $ r = \\frac{\\sum_{\\mathbf{k} \\in \\mathcal{K}} \\left( \\|\\mathbf{A}_{\\mathbf{k}}(0)\\|^2 - \\|\\mathbf{A}'_{\\mathbf{k}}(0)\\|^2 \\right)}{\\sum_{\\mathbf{k} \\in \\mathcal{K}} \\|\\mathbf{A}_{\\mathbf{k}}(0)\\|^2} $。\n- 投影前的最大稳定时间步长 $ \\Delta t_{\\max}^{\\text{pre}} = \\frac{2}{\\max_{\\mathbf{k} \\in \\mathcal{K}} \\omega_{\\text{pre}, \\mathbf{k}}} $，其中如果 $ g > 0 $，则 $ \\omega_{\\text{pre}, \\mathbf{k}} = \\max\\{ |\\mathbf{k}|, \\sqrt{|\\mathbf{k}|^2 + p} \\} $，如果 $ g = 0 $，则 $ \\omega_{\\text{pre}, \\mathbf{k}} = |\\mathbf{k}| $。\n- 投影后的最大稳定时间步长 $ \\Delta t_{\\max}^{\\text{post}} = \\frac{2}{\\max_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k}| } $。\n- 改进因子 $ f = \\Delta t_{\\max}^{\\text{post}} / \\Delta t_{\\max}^{\\text{pre}} $。\n\n您的程序必须在傅里叶空间中实现 $ t = 0 $ 时的投影，并为下面指定的每个测试案例计算 $ \\delta $、$ r $、$ \\Delta t_{\\max}^{\\text{pre}} $、$ \\Delta t_{\\max}^{\\text{post}} $ 和 $ f $。所有量都是无量纲的。您的实现不得使用外部输入，并且必须使用测试套件中提供的参数。\n\n测试套件：\n- 案例 1（正常路径）：$ \\mathcal{K} = \\{ (1, 0), (0, 1), (1, 1), (2, 1), (2, 2) \\} $，$ g = 0.2 $，$ s = 1 $，$ p = 10 $。\n- 案例 2（边界条件，零污染）：$ \\mathcal{K} = \\{ (1, 0), (0, 1), (1, 1), (2, 1), (2, 2) \\} $，$ g = 0 $，$ s = 1 $，$ p = 10 $。\n- 案例 3（边缘情况，无罚项）：$ \\mathcal{K} = \\{ (1, 0), (0, 1), (1, 1), (2, 1), (2, 2) \\} $，$ g = 0.2 $，$ s = 1 $，$ p = 0 $。\n- 案例 4（边缘情况，高波数和强罚项）：$ \\mathcal{K} = \\{ (1, 0), (0, 1), (1, 1), (2, 1), (2, 2), (4, 4), (8, 8) \\} $，$ g = 0.5 $，$ s = 0 $，$ p = 50 $。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含案例的结果，格式为方括号括起来的逗号分隔列表，每个案例结果本身是一个包含 5 个浮点数的列表，顺序为 $ [\\delta, r, \\Delta t_{\\max}^{\\text{pre}}, \\Delta t_{\\max}^{\\text{post}}, f] $。例如，整体输出应类似于 $ [[\\cdots],[\\cdots],[\\cdots],[\\cdots]] $。",
            "solution": "该问题要求构建并分析一个周期域中简化电磁系统的初值问题，重点关注库仑规范的强制执行及其对数值稳定性的影响。我们将首先验证问题陈述，然后提供一个完整的、有理有据的解决方案。\n\n该问题被确定为有效。它在科学上基于麦克斯韦方程组、规范理论和偏微分方程数值分析的原理。其设定是自洽的、数学上适定的，并且没有矛盾或含糊之处。所有术语都得到了明确定义，要求的任务可以严格地形式化。我们接下来进行求解。\n\n解决方案分为三个部分，与问题陈述中概述的任务相对应。\n\n部分 A：$ t=0 $ 时规范投影的推导\n\n指导此推导的基本原理是规范不变性。物理电场 $ \\mathbf{E} $ 和磁场 $ \\mathbf{B} $ 在势 $ \\mathbf{A} $ 和 $ \\phi $ 的规范变换下是不变的：\n$$ \\mathbf{A} \\rightarrow \\mathbf{A}' = \\mathbf{A} + \\nabla\\chi $$\n$$ \\phi \\rightarrow \\phi' = \\phi - \\partial_t\\chi $$\n对于任何足够光滑的规范函数 $ \\chi(\\mathbf{x}, t) $。初始电场 $ \\mathbf{E}(0) = -\\partial_t\\mathbf{A}(0) - \\nabla\\phi(0) $ 在任何此类变换下都自动保持不变，因为 $ \\mathbf{E}'(0) = -(\\partial_t\\mathbf{A}(0) + \\nabla\\partial_t\\chi(0)) - (\\nabla\\phi(0) - \\nabla\\partial_t\\chi(0)) = \\mathbf{E}(0) $。\n\n我们的目标是找到一个规范函数 $ \\chi(\\mathbf{x}, 0) $，使得新的矢量势 $ \\mathbf{A}'(\\mathbf{x}, 0) $ 满足库仑规范条件 $ \\nabla \\cdot \\mathbf{A}'(0) = 0 $。该变换在傅里叶空间中进行，其中梯度算子 $ \\nabla $ 变为乘以 $ i\\mathbf{k} $，散度算子 $ \\nabla \\cdot $ 变为乘以 $ i\\mathbf{k} \\cdot $。\n\n在 $ t=0 $ 时，矢量势傅里叶系数的规范变换为：\n$$ \\mathbf{A}'_{\\mathbf{k}}(0) = \\mathbf{A}_{\\mathbf{k}}(0) + i\\mathbf{k}\\chi_{\\mathbf{k}}(0) $$\n傅里叶空间中的库仑规范条件是 $ \\mathbf{k} \\cdot \\mathbf{A}'_{\\mathbf{k}}(0) = 0 $。我们通过将变换方程与 $ \\mathbf{k} $ 进行点积来强制执行此条件：\n$$ \\mathbf{k} \\cdot \\mathbf{A}'_{\\mathbf{k}}(0) = \\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0) + i\\mathbf{k} \\cdot \\mathbf{k}\\chi_{\\mathbf{k}}(0) $$\n将左侧设为 $ 0 $ 并使用 $ \\mathbf{k} \\cdot \\mathbf{k} = |\\mathbf{k}|^2 $，我们可以求解所需的规范函数的傅里叶系数 $ \\chi_{\\mathbf{k}}(0) $：\n$$ 0 = \\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0) + i|\\mathbf{k}|^2\\chi_{\\mathbf{k}}(0) $$\n$$ \\chi_{\\mathbf{k}}(0) = \\frac{i}{|\\mathbf{k}|^2} (\\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0)) $$\n这个表达式对于所有 $ \\mathbf{k} \\in \\mathcal{K} $ 都是良定义的，因为问题陈述指定了 $ \\mathcal{K} \\subset \\mathbb{Z}^2 \\setminus \\{\\mathbf{0}\\} $，确保了 $ |\\mathbf{k}|^2 \\neq 0 $。\n\n我们将这个 $ \\chi_{\\mathbf{k}}(0) $ 代回到 $ \\mathbf{A}'_{\\mathbf{k}}(0) $ 的变换方程中：\n$$ \\mathbf{A}'_{\\mathbf{k}}(0) = \\mathbf{A}_{\\mathbf{k}}(0) + i\\mathbf{k} \\left( \\frac{i}{|\\mathbf{k}|^2} (\\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0)) \\right) $$\n$$ \\mathbf{A}'_{\\mathbf{k}}(0) = \\mathbf{A}_{\\mathbf{k}}(0) - \\frac{\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0))}{|\\mathbf{k}|^2} $$\n这是投影后矢量势的显式公式。此操作是亥姆霍兹分解的一种体现，它将一个矢量场分解为其螺线（横向）和无旋（纵向）部分。算子 $ \\mathcal{P}_{\\parallel, \\mathbf{k}}(\\mathbf{V}) = \\frac{\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{V})}{|\\mathbf{k}|^2} $ 将一个矢量 $ \\mathbf{V} $ 投影到其纵向分量（平行于 $ \\mathbf{k} $）上，而 $ \\mathcal{P}_{\\perp, \\mathbf{k}}(\\mathbf{V}) = \\mathbf{V} - \\mathcal{P}_{\\parallel, \\mathbf{k}}(\\mathbf{V}) $ 将其投影到其横向分量上。因此，$ \\mathbf{A}'_{\\mathbf{k}}(0) $ 是初始 $ \\mathbf{A}_{\\mathbf{k}}(0) $ 的纯横向部分。\n\n部分 B：稳定性分析和最大时间步长\n\n问题指出，系统动力学由一组解耦的振子建模，每个傅里叶模式的每个分量对应一个振子。对于一个振子 $ \\partial_t^2 y + \\omega^2 y = 0 $，显式二阶中心差分时间步进格式的稳定性由条件 $ \\Delta t \\cdot \\omega \\le 2 $ 给出。对于一个振子系统，时间步长 $ \\Delta t $ 必须足够小，以稳定系统中存在的最高频率 $ \\omega_{\\max} $。这导致约束 $ \\Delta t_{\\max} = 2 / \\omega_{\\max} $。\n\n我们分析规范投影前后的系统。\n\n投影前（$ \\Delta t_{\\max}^{\\text{pre}} $）：\n如果 $ g0 $，初始状态 $ \\mathbf{A}_{\\mathbf{k}}(0) = a_{\\mathbf{k}} (\\hat{\\mathbf{e}}_{\\perp, \\mathbf{k}} + g \\hat{\\mathbf{k}}) $ 同时包含横向和纵向分量。横向部分以频率 $ \\omega_{\\perp, \\mathbf{k}} = |\\mathbf{k}| $ 演化，而纵向部分以带罚项的频率 $ \\omega_{\\parallel, \\mathbf{k}} = \\sqrt{|\\mathbf{k}|^2 + p} $ 演化。\n对于给定的模式 $ \\mathbf{k} $，激发的最高频率为 $ \\omega_{\\text{pre}, \\mathbf{k}} = \\max(\\omega_{\\perp, \\mathbf{k}}, \\omega_{\\parallel, \\mathbf{k}}) = \\max(|\\mathbf{k}|, \\sqrt{|\\mathbf{k}|^2 + p}) $。由于 $ p \\ge 0 $，我们有 $ \\sqrt{|\\mathbf{k}|^2 + p} \\ge |\\mathbf{k}| $，因此 $ \\omega_{\\text{pre}, \\mathbf{k}} = \\sqrt{|\\mathbf{k}|^2 + p} $。\n这仅在存在纵向分量时有效，即当 $ g  0 $ 时。如果 $ g = 0 $，初始状态是纯横向的，只有横向频率 $ \\omega_{\\perp, \\mathbf{k}} = |\\mathbf{k}| $ 被激发。\n整个系统的最大频率是 $ \\omega_{\\max}^{\\text{pre}} = \\max_{\\mathbf{k} \\in \\mathcal{K}} \\omega_{\\text{pre}, \\mathbf{k}} $。\n- 如果 $ g  0 $：$ \\omega_{\\max}^{\\text{pre}} = \\max_{\\mathbf{k} \\in \\mathcal{K}} \\sqrt{|\\mathbf{k}|^2 + p} = \\sqrt{(\\max_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k}|)^2 + p} $，因为 $ \\sqrt{x+p} $ 是 $ x=|\\mathbf{k}|^2 $ 的单调函数。\n- 如果 $ g = 0 $：$ \\omega_{\\max}^{\\text{pre}} = \\max_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k}| $。\n最大稳定时间步长为 $ \\Delta t_{\\max}^{\\text{pre}} = 2 / \\omega_{\\max}^{\\text{pre}} $。\n\n投影后（$ \\Delta t_{\\max}^{\\text{post}} $）：\n投影消除了所有 $ \\mathbf{k} $ 的 $ \\mathbf{A}_{\\mathbf{k}}(0) $ 的纵向分量。随后的动力学只演化纯横向的势 $ \\mathbf{A}'_{\\mathbf{k}}(0) $。系统中存在的唯一频率是横向频率 $ \\omega_{\\perp, \\mathbf{k}} = |\\mathbf{k}| $。\n投影后系统的最大频率是 $ \\omega_{\\max}^{\\text{post}} = \\max_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k}| $。\n因此，最大稳定时间步长为 $ \\Delta t_{\\max}^{\\text{post}} = 2 / \\omega_{\\max}^{\\text{post}} = 2 / (\\max_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k}|) $。\n\n部分 C：度量计算\n我们现在形式化所需度量的计算。设 $ k_{\\max} = \\max_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k}| $。\n初始势为 $ \\mathbf{A}_{\\mathbf{k}}(0) = a_{\\mathbf{k}} (\\hat{\\mathbf{e}}_{\\perp, \\mathbf{k}} + g \\hat{\\mathbf{k}}) $，其中 $ a_{\\mathbf{k}} = |\\mathbf{k}|^{-s} $。\n\n1.  规范违背分数, $ \\delta $:\n$$ \\delta = \\frac{\\sum_{\\mathbf{k} \\in \\mathcal{K}} |\\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0)|^2}{\\sum_{\\mathbf{k} \\in \\mathcal{K}} \\|\\mathbf{A}_{\\mathbf{k}}(0)\\|^2} $$\n求和中的项为 $ \\mathbf{k} \\cdot \\mathbf{A}_{\\mathbf{k}}(0) = a_{\\mathbf{k}} g (\\mathbf{k} \\cdot \\hat{\\mathbf{k}}) = g a_{\\mathbf{k}} |\\mathbf{k}| $ 和 $ \\|\\mathbf{A}_{\\mathbf{k}}(0)\\|^2 = a_{\\mathbf{k}}^2(1+g^2) $，这是因为 $ \\hat{\\mathbf{e}}_{\\perp, \\mathbf{k}} $ 和 $ \\hat{\\mathbf{k}} $ 是正交的。\n因此，我们计算：\n$$ \\delta = \\frac{g^2 \\sum_{\\mathbf{k} \\in \\mathcal{K}} a_{\\mathbf{k}}^2 |\\mathbf{k}|^2}{(1+g^2) \\sum_{\\mathbf{k} \\in \\mathcal{K}} a_{\\mathbf{k}}^2} $$\n\n2.  移除的能量分数, $ r $:\n$$ r = \\frac{\\sum_{\\mathbf{k} \\in \\mathcal{K}} \\left( \\|\\mathbf{A}_{\\mathbf{k}}(0)\\|^2 - \\|\\mathbf{A}'_{\\mathbf{k}}(0)\\|^2 \\right)}{\\sum_{\\mathbf{k} \\in \\mathcal{K}} \\|\\mathbf{A}_{\\mathbf{k}}(0)\\|^2} $$\n投影后的势为 $ \\mathbf{A}'_{\\mathbf{k}}(0) = a_{\\mathbf{k}} \\hat{\\mathbf{e}}_{\\perp, \\mathbf{k}} $，所以 $ \\|\\mathbf{A}'_{\\mathbf{k}}(0)\\|^2 = a_{\\mathbf{k}}^2 $。\n分子是 $ \\sum (a_{\\mathbf{k}}^2(1+g^2) - a_{\\mathbf{k}}^2) = \\sum g^2 a_{\\mathbf{k}}^2 = g^2 \\sum a_{\\mathbf{k}}^2 $。\n分母是 $ \\sum a_{\\mathbf{k}}^2(1+g^2) = (1+g^2) \\sum a_{\\mathbf{k}}^2 $。\n该比率简化为：\n$$ r = \\frac{g^2}{1+g^2} $$\n\n3.  最大稳定时间步长：\n如部分 B 所推导：\n$$ \\Delta t_{\\max}^{\\text{pre}} = \\begin{cases} 2 / \\sqrt{k_{\\max}^2 + p}  \\text{若 } g  0 \\\\ 2 / k_{\\max}  \\text{若 } g = 0 \\end{cases} $$\n$$ \\Delta t_{\\max}^{\\text{post}} = \\frac{2}{k_{\\max}} $$\n\n4.  改进因子, $ f $:\n因子 $ f $ 量化了投影对时间步长约束的好处。\n$$ f = \\frac{\\Delta t_{\\max}^{\\text{post}}}{\\Delta t_{\\max}^{\\text{pre}}} = \\begin{cases} (2/k_{\\max}) / (2/\\sqrt{k_{\\max}^2+p}) = \\sqrt{1 + p/k_{\\max}^2}  \\text{若 } g  0 \\\\ (2/k_{\\max}) / (2/k_{\\max}) = 1  \\text{若 } g = 0 \\end{cases} $$\n\n对每个测试案例实施这些公式，以产生最终的数值结果。",
            "answer": "[[0.06018590130985223, 0.038461538461538464, 0.4714045207910317, 0.7071067811865475, 1.5], [0.0, 0.0, 0.7071067811865475, 0.7071067811865475, 1.0], [0.06018590130985223, 0.038461538461538464, 0.7071067811865475, 0.7071067811865475, 1.0], [0.10714285714285714, 0.2, 0.14907119849998599, 0.1767766952966369, 1.185854122573215]]"
        }
    ]
}