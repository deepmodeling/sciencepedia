{
    "hands_on_practices": [
        {
            "introduction": "这项练习将让我们亲眼目睹列纳德-伯恩斯坦算符的实际作用。通过求解一个初值问题，我们可以解析地追踪算符如何将一个非平衡的粒子分布函数驱动至麦克斯韦平衡态 。这项实践揭示了算符中摩擦（使平均速度弛豫）和扩散（使温度弛豫）的独特作用。",
            "id": "4204967",
            "problem": "考虑一个用于聚变等离子体湍流模拟的空间均匀的单物种动理学方程，其中的碰撞效应由 Lenard–Bernstein (LB) 碰撞算符表示。分布函数 $f(v,t)$ 根据一维 Fokker–Planck 方程演化\n$$\n\\partial_t f(v,t) \\;=\\; C[f](v,t) \\;=\\; \\nu\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right),\n$$\n其中 $\\nu>0$ 是（常数）碰撞频率，$u$ 是恒定的流（漂移）速度，$v_t>0$ 是恒定的热速度。Lenard–Bernstein (LB) 算符在简化模型的湍流模拟中被广泛使用，以一种与向麦克斯韦分布弛豫一致的方式来捕捉速度空间中的摩擦和扩散。\n\n假设在 $t=0$ 时的初始数据是高斯分布，其数密度为 $n_0>0$，均值为 $m_0\\in\\mathbb{R}$，方差为 $s_0^2>0$：\n$$\nf(v,0) \\;=\\; \\frac{n_0}{\\sqrt{2\\pi}\\,s_0}\\,\\exp\\!\\left(-\\frac{(v-m_0)^2}{2\\,s_0^2}\\right).\n$$\n\n仅从上述控制方程和 Fokker–Planck 算符的基本性质（在无穷远处适当衰减下的质量守恒以及分部积分的有效性）出发，完成以下任务：\n\n1. 证明总数密度 $n(t)=\\int_{-\\infty}^{\\infty} f(v,t)\\,dv$ 不随时间变化（即守恒）。\n2. 推导控制均值 $m(t)=\\frac{1}{n_0}\\int_{-\\infty}^{\\infty} v\\,f(v,t)\\,dv$ 和方差 $\\sigma^2(t)=\\frac{1}{n_0}\\int_{-\\infty}^{\\infty} (v-m(t))^2\\,f(v,t)\\,dv$ 时间演化的封闭常微分方程。\n3. 求解这些常微分方程，得到 $m(t)$ 和 $\\sigma^2(t)$ 作为时间的显式函数。\n4. 利用 LB 算符的结构，论证高斯性是保持的，并写出具有随时间变化的均值和方差的高斯形式的显式解 $f(v,t)$。\n\n用标准数学符号将你的最终答案表示为对 $\\big(m(t),\\,\\sigma^2(t)\\big)$ 的单个解析表达式。不需要进行数值计算或四舍五入，最终答案中也不应包含物理单位。",
            "solution": "问题描述了在一维情况下，分布函数 $f(v,t)$ 根据 Lenard-Bernstein (LB) 碰撞算符的演化，这是一种特定形式的 Fokker-Planck 方程。该问题具有科学依据，提法恰当，并且为获得唯一解提供了所有必要信息。初始条件是高斯分布，控制方程是一个线性偏微分方程，其系数最多是速度变量 $v$ 的线性函数。这种结构是 Ornstein-Uhlenbeck 过程的特征，可以应用标准的分析方法。因此，该问题是有效的，我们着手求解。\n\n控制方程为：\n$$\n\\partial_t f(v,t) = \\nu\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right)\n$$\n我们需要完成四项任务，我们将按顺序进行。\n\n1. 总数密度 $n(t)$ 的守恒。\n\n总数密度定义为分布函数的零阶矩：\n$$\nn(t) = \\int_{-\\infty}^{\\infty} f(v,t)\\,dv\n$$\n为了找到其时间演化，我们对时间 $t$ 求导：\n$$\n\\frac{dn(t)}{dt} = \\frac{d}{dt}\\int_{-\\infty}^{\\infty} f(v,t)\\,dv = \\int_{-\\infty}^{\\infty} \\partial_t f(v,t)\\,dv\n$$\n代入 $\\partial_t f(v,t)$ 的控制方程：\n$$\n\\frac{dn(t)}{dt} = \\int_{-\\infty}^{\\infty} \\nu\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right) dv\n$$\n该积分是关于积分变量 $v$ 的全导数。根据微积分基本定理：\n$$\n\\frac{dn(t)}{dt} = \\nu \\left[ (v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t) \\right]_{v=-\\infty}^{v=+\\infty}\n$$\n问题陈述假设 $f(v,t)$ 在 $v \\to \\pm\\infty$ 时有适当的衰减。由于初始条件是高斯分布，$f$ 及其所有导数将比 $v$ 的任何多项式增长得更快地衰减到零。因此，边界项为零：\n$$\n\\lim_{v\\to\\pm\\infty} \\left( (v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t) \\right) = 0\n$$\n这导致：\n$$\n\\frac{dn(t)}{dt} = 0\n$$\n这证实了总数密度 $n(t)$ 随时间守恒。其值是恒定的，等于其初始值 $n_0 = \\int_{-\\infty}^{\\infty} f(v,0)\\,dv$。因此，对于所有 $t \\geq 0$，$n(t)=n_0$。\n\n2. 推导均值 $m(t)$ 和方差 $\\sigma^2(t)$ 的常微分方程。\n\n平均速度定义为归一化的一阶矩：\n$$\nm(t) = \\frac{1}{n_0}\\int_{-\\infty}^{\\infty} v\\,f(v,t)\\,dv\n$$\n对时间求导：\n$$\n\\frac{dm(t)}{dt} = \\frac{1}{n_0}\\int_{-\\infty}^{\\infty} v\\,\\partial_t f(v,t)\\,dv = \\frac{\\nu}{n_0} \\int_{-\\infty}^{\\infty} v\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right) dv\n$$\n我们应用分部积分法，$\\int w\\,d\\phi = [w\\phi] - \\int \\phi\\,dw$。令 $w=v$ 且 $d\\phi = \\partial_v(\\dots)dv$。\n$$\n\\frac{dm(t)}{dt} = \\frac{\\nu}{n_0} \\left( \\left[ v \\left( (v-u)f + v_t^2 \\partial_v f \\right) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} 1 \\cdot \\left( (v-u)f + v_t^2 \\partial_v f \\right) dv \\right)\n$$\n由于 $f(v,t)$ 的快速衰减，边界项消失。\n$$\n\\frac{dm(t)}{dt} = -\\frac{\\nu}{n_0} \\int_{-\\infty}^{\\infty} \\left( (v-u)f + v_t^2 \\partial_v f \\right) dv = -\\frac{\\nu}{n_0} \\left( \\int_{-\\infty}^{\\infty} (v-u)f\\,dv + v_t^2 \\int_{-\\infty}^{\\infty} \\partial_v f\\,dv \\right)\n$$\n第二个积分为 $[f]_{-\\infty}^{\\infty} = 0$。第一个积分为：\n$$\n\\int_{-\\infty}^{\\infty} (v-u)f\\,dv = \\int_{-\\infty}^{\\infty} vf\\,dv - u\\int_{-\\infty}^{\\infty} f\\,dv = n_0 m(t) - u n_0 = n_0 (m(t)-u)\n$$\n将其代回，我们得到均值的常微分方程：\n$$\n\\frac{dm(t)}{dt} = -\\frac{\\nu}{n_0} \\left( n_0 (m(t)-u) \\right) = -\\nu(m(t)-u) \\quad \\implies \\quad \\frac{dm(t)}{dt} = \\nu(u - m(t))\n$$\n接下来，我们考虑方差 $\\sigma^2(t)$。计算二阶原点矩 $M_2(t) = \\int_{-\\infty}^{\\infty} v^2 f(v,t)\\,dv$ 的演化在计算上更简单。\n$$\n\\frac{dM_2(t)}{dt} = \\int_{-\\infty}^{\\infty} v^2\\,\\partial_t f\\,dv = \\nu \\int_{-\\infty}^{\\infty} v^2\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right) dv\n$$\n使用 $w=v^2$（因此 $dw=2v\\,dv$）进行分部积分：\n$$\n\\frac{dM_2(t)}{dt} = \\nu \\left( \\left[ v^2(\\dots) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} 2v \\left( (v-u)f + v_t^2 \\partial_v f \\right) dv \\right)\n$$\n边界项为零。\n$$\n\\frac{dM_2(t)}{dt} = -2\\nu \\left( \\int_{-\\infty}^{\\infty} (v^2-uv)f\\,dv + v_t^2 \\int_{-\\infty}^{\\infty} v\\,\\partial_v f\\,dv \\right)\n$$\n第一个积分是 $\\int v^2 f\\,dv - u\\int v f\\,dv = M_2(t) - u n_0 m(t)$。对于第二个积分，我们再次使用分部积分法：\n$$\n\\int_{-\\infty}^{\\infty} v\\,\\partial_v f\\,dv = [vf]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} f\\,dv = 0 - n_0 = -n_0\n$$\n代入这些结果：\n$$\n\\frac{dM_2(t)}{dt} = -2\\nu \\left( M_2(t) - u n_0 m(t) + v_t^2 (-n_0) \\right) = -2\\nu M_2(t) + 2\\nu u n_0 m(t) + 2\\nu n_0 v_t^2\n$$\n方差为 $\\sigma^2(t) = \\frac{M_2(t)}{n_0} - m(t)^2$。其时间导数为 $\\frac{d\\sigma^2}{dt} = \\frac{1}{n_0}\\frac{dM_2}{dt} - 2m(t)\\frac{dm}{dt}$。\n$$\n\\frac{d\\sigma^2(t)}{dt} = \\frac{1}{n_0} \\left( -2\\nu M_2(t) + 2\\nu u n_0 m(t) + 2\\nu n_0 v_t^2 \\right) - 2m(t) \\left( \\nu(u-m(t)) \\right)\n$$\n$$\n\\frac{d\\sigma^2(t)}{dt} = -2\\nu \\frac{M_2(t)}{n_0} + 2\\nu u m(t) + 2\\nu v_t^2 - 2\\nu u m(t) + 2\\nu m(t)^2\n$$\n包含 $u m(t)$ 的项相互抵消。\n$$\n\\frac{d\\sigma^2(t)}{dt} = -2\\nu \\left( \\frac{M_2(t)}{n_0} - m(t)^2 \\right) + 2\\nu v_t^2\n$$\n将括号中的项识别为方差 $\\sigma^2(t)$，我们得到第二个常微分方程：\n$$\n\\frac{d\\sigma^2(t)}{dt} = -2\\nu \\sigma^2(t) + 2\\nu v_t^2 \\quad \\implies \\quad \\frac{d\\sigma^2(t)}{dt} = 2\\nu(v_t^2 - \\sigma^2(t))\n$$\n\n3. 常微分方程的求解。\n\n首先，我们求解 $m(t)$：\n$$\n\\frac{dm}{dt} = -\\nu(m - u)\n$$\n这是一个一阶线性常微分方程。令 $y(t) = m(t) - u$。方程变为 $\\frac{dy}{dt} = -\\nu y$，其解为 $y(t) = y(0)\\exp(-\\nu t)$。在 $t=0$ 时，我们有 $y(0) = m(0) - u = m_0 - u$。因此，$m(t) - u = (m_0 - u)\\exp(-\\nu t)$。\n均值的解为：\n$$\nm(t) = u + (m_0 - u)\\exp(-\\nu t)\n$$\n接下来，我们求解 $\\sigma^2(t)$。令 $S(t) = \\sigma^2(t)$。常微分方程为：\n$$\n\\frac{dS}{dt} = -2\\nu(S - v_t^2)\n$$\n这个常微分方程具有相同的形式。令 $z(t) = S(t) - v_t^2$。方程为 $\\frac{dz}{dt} = -2\\nu z$，其解为 $z(t) = z(0)\\exp(-2\\nu t)$。在 $t=0$ 时，$z(0) = S(0) - v_t^2 = s_0^2 - v_t^2$。因此，$S(t) - v_t^2 = (s_0^2 - v_t^2)\\exp(-2\\nu t)$。\n方差的解为：\n$$\n\\sigma^2(t) = v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t)\n$$\n\n4. 高斯性与 $f(v,t)$ 的显式解。\n\n控制方程是一个线性的 Fokker-Planck 方程，其中漂移系数是 $v$ 的线性函数，扩散系数是常数。这类方程的一个基本性质是它们保持分布函数的高斯形式。由于初始条件 $f(v,0)$ 是高斯分布，因此对于所有 $t > 0$，解 $f(v,t)$ 也必须是高斯分布。一个高斯分布完全由其数密度、均值和方差所表征。我们已经找到了这三个量的演化。因此，在任意时刻 $t$ 的分布函数为：\n$$\nf(v,t) = \\frac{n(t)}{\\sqrt{2\\pi\\sigma^2(t)}} \\exp\\left(-\\frac{(v-m(t))^2}{2\\sigma^2(t)}\\right)\n$$\n代入 $n(t)=n_0$，$m(t)$ 和 $\\sigma^2(t)$ 的表达式，得到完整的解：\n$$\nf(v,t) = \\frac{n_0}{\\sqrt{2\\pi \\left( v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t) \\right)}} \\exp\\left(-\\frac{\\left(v - \\left(u + (m_0 - u)\\exp(-\\nu t)\\right)\\right)^2}{2\\left( v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t) \\right)}\\right)\n$$\n问题要求将对 $(m(t), \\sigma^2(t))$ 作为最终答案。\n\n最终答案：均值 $m(t)$ 和方差 $\\sigma^2(t)$ 的时间显式函数对为 $m(t) = u + (m_0 - u)\\exp(-\\nu t)$ 和 $\\sigma^2(t) = v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t)$。\n当 $t \\to \\infty$ 时，均值 $m(t)$ 弛豫到漂移速度 $u$，方差 $\\sigma^2(t)$ 弛豫到热速度的平方 $v_t^2$。这对应于系统趋向于一个以 $v=u$ 为中心、热速度为 $v_t$ 的稳态麦克斯韦分布。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nu + (m_0 - u)\\exp(-\\nu t),  v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "这项练习旨在更深入地探究列纳德-伯恩斯坦算符的数学结构。寻找其本征函数和本征值，就好比寻找系统的固有“振动模式”。这项实践将证明这些模式是由埃尔米特多项式描述的 ，这一结果对于基于谱展开的高级分析和高效数值方法至关重要。",
            "id": "4204958",
            "problem": "考虑一维 Lenard–Bernstein 碰撞算符，它将小角度库仑碰撞建模为一个线性 Fokker–Planck 算符。对于质量为 $m$、温度为 $T$ 的粒子种类，其热速度定义为 $v_t = \\sqrt{T/m}$，碰撞频率为常数 $\\nu$，作用于速度空间函数 $f(v)$ 的算符为\n$$\nC_L[f](v) = \\nu \\,\\frac{\\partial}{\\partial v}\\left( v\\, f(v) + v_t^{2}\\,\\frac{\\partial f(v)}{\\partial v} \\right).\n$$\n该算符的稳态平衡是一维麦克斯韦分布\n$$\nM(v) = \\frac{1}{\\sqrt{2\\pi}\\,v_t}\\,\\exp\\!\\left(-\\frac{v^{2}}{2 v_t^{2}}\\right),\n$$\n在 $|v|\\to\\infty$ 时有适当衰减的条件下，它满足 $C_L[M]=0$。在等离子体湍流闭合和简化模型中，速度矩通常被投影到厄米基上。采用无量纲化速度 $x = v/v_t$ 并考虑以下本征问题\n$$\nC_L[\\phi_n](v) = \\lambda_n\\,\\phi_n(v),\n$$\n其中函数 $\\phi_n(v)$ 在 $|v|\\to\\infty$ 时衰减得足够快。\n\n从第一性原理出发——即上述 Fokker–Planck 散度形式和麦克斯韦平衡——证明 $C_L$ 的本征函数可以写成一个麦克斯韦分布乘以一个关于 $x$ 的多项式的形式，并且施加关于权重 $M^{-1}(v)$ 的平方可积性条件会选出概率论学家的厄米多项式 $H_n(x)$，这些多项式关于高斯权重 $\\exp(-x^{2}/2)$ 是正交的。推导出对所有非负整数 $n$ 满足该本征问题的相应本征值 $\\lambda_n$。\n\n你的最终答案必须是用 $n$ 和 $\\nu$ 表示的 $\\lambda_n$ 的闭式表达式。最终答案中不需要数值计算或四舍五入，也无需单位。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **Lenard-Bernstein 碰撞算符**：$C_L[f](v) = \\nu \\,\\frac{\\partial}{\\partial v}\\left( v\\, f(v) + v_t^{2}\\,\\frac{\\partial f(v)}{\\partial v} \\right)$\n- **粒子质量**：$m$\n- **粒子温度**：$T$\n- **热速度**：$v_t = \\sqrt{T/m}$\n- **碰撞频率**：$\\nu$ (恒定)\n- **稳态平衡 (一维麦克斯韦分布)**：$M(v) = \\frac{1}{\\sqrt{2\\pi}\\,v_t}\\,\\exp\\!\\left(-\\frac{v^{2}}{2 v_t^{2}}\\right)$\n- **平衡性质**：$C_L[M]=0$\n- **无量纲化速度**：$x = v/v_t$\n- **本征问题**：$C_L[\\phi_n](v) = \\lambda_n\\,\\phi_n(v)$\n- **边界条件**：$\\phi_n(v)$ 在 $|v|\\to\\infty$ 时足够快地衰减。\n- **要求结论**：证明本征函数的形式为 (关于 $x$ 的多项式) $\\times$ (麦克斯韦分布)，在特定的平方可积条件下，多项式为厄米多项式 $H_n(x)$，并求出相应的本征值 $\\lambda_n$。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学或事实不成立**：该问题在科学上是成立的。Lenard-Bernstein 算符是等离子体物理中一个公认的用于碰撞的线性 Fokker-Planck 模型。麦克斯韦分布是此类系统的正确热平衡态。在动理学理论中，使用厄米多项式分析高斯分布周围的扰动是一种标准且数学上严谨的技术。\n2.  **不可形式化或不相关**：该问题是一个与指定主题直接相关的形式化数理物理问题。\n3.  **设置不完整或矛盾**：该问题是自洽的。提供了所有必要的定义。快速检查可以确认给定条件的一致性：对于 $f(v) = M(v)$，算符括号中的项为 $vM(v) + v_t^2 \\frac{\\partial M}{\\partial v} = vM(v) + v_t^2 \\left(-\\frac{v}{v_t^2}M(v)\\right) = 0$，因此 $C_L[M]=0$ 是正确的。\n4.  **不切实际或不可行**：该问题是一个带有符号参数的理论问题。它不包含不切实际的数据。\n5.  **不适定或结构不良**：该问题是一个关于二阶微分算符的适定的 Sturm-Liouville 型本征值问题。在给定的边界条件（快速衰减）下，预计会得到一个离散的本征值谱。\n6.  **伪深刻、琐碎或同义反复**：该问题需要一个非平凡的推导，涉及变量替换、代入以及与一个已知的特殊函数族进行辨识。这是数理物理学中一个标准但有实质内容的练习。\n7.  **超出科学可验证性范围**：结果在数学上是可推导和可验证的。\n\n### 第3步：结论与行动\n问题有效。下面是完整的、有理有据的解答。\n\n我们的任务是求解一维 Lenard-Bernstein 算符的本征问题，\n$$\nC_L[\\phi_n](v) = \\lambda_n\\,\\phi_n(v),\n$$\n其中算符由下式给出\n$$\nC_L[f](v) = \\nu \\,\\frac{\\partial}{\\partial v}\\left( v\\, f(v) + v_t^{2}\\,\\frac{\\partial f(v)}{\\partial v} \\right).\n$$\n第一步是使用无量纲化变量 $x = v/v_t$ 对速度进行无量纲化。这意味着 $v = x v_t$，且根据链式法则，导数变换为：\n$$\n\\frac{\\partial}{\\partial v} = \\frac{\\partial x}{\\partial v} \\frac{\\partial}{\\partial x} = \\frac{1}{v_t} \\frac{\\partial}{\\partial x}.\n$$\n将这些代入算符表达式，我们得到一个作用于 $x$ 的函数的算符 $\\tilde{C}_L$：\n$$\n\\tilde{C}_L[f](x) = \\nu \\left(\\frac{1}{v_t}\\frac{\\partial}{\\partial x}\\right)\\left( (x v_t)\\, f(x) + v_t^{2}\\,\\left(\\frac{1}{v_t}\\frac{\\partial f(x)}{\\partial x}\\right) \\right)\n$$\n$$\n\\tilde{C}_L[f](x) = \\frac{\\nu}{v_t} \\frac{\\partial}{\\partial x}\\left( x v_t\\, f(x) + v_t\\,\\frac{\\partial f(x)}{\\partial x} \\right).\n$$\n从内层括号中提出常数 $v_t$，得到用 $x$ 表示的算符：\n$$\n\\tilde{C}_L[f](x) = \\nu \\,\\frac{\\partial}{\\partial x}\\left( x\\, f(x) + \\frac{\\partial f(x)}{\\partial x} \\right).\n$$\n稳态平衡是麦克斯韦分布 $M(v)$，用 $x$ 表示时，它与高斯权重函数 $w(x) = \\exp(-x^2/2)$ 成正比。Fokker-Planck 算符的结构表明，可以寻找形如 $\\phi_n(x) = g_n(x) w(x)$ 的本征函数，其中 $g_n(x)$ 是某个待定函数。我们将此拟设代入本征问题 $\\tilde{C}_L[\\phi_n] = \\lambda_n \\phi_n$。\n\n首先，我们计算算符中导数内的项：\n$$\nx \\phi_n(x) + \\frac{\\partial \\phi_n(x)}{\\partial x} = x g_n(x) w(x) + \\frac{\\partial}{\\partial x} (g_n(x) w(x)).\n$$\n使用乘法法则以及 $w'(x) = -x w(x)$ 这一事实：\n$$\n\\frac{\\partial}{\\partial x} (g_n(x) w(x)) = g_n'(x) w(x) + g_n(x) w'(x) = g_n'(x) w(x) - x g_n(x) w(x).\n$$\n将此代回，我们发现一个方便的抵消：\n$$\nx g_n(x) w(x) + \\left( g_n'(x) w(x) - x g_n(x) w(x) \\right) = g_n'(x) w(x).\n$$\n现在，作用于 $\\phi_n$ 的完整算符变为：\n$$\n\\tilde{C}_L[\\phi_n](x) = \\nu \\frac{\\partial}{\\partial x} \\left( g_n'(x) w(x) \\right).\n$$\n再次应用乘法法则：\n$$\n\\tilde{C}_L[\\phi_n](x) = \\nu \\left( g_n''(x) w(x) + g_n'(x) w'(x) \\right) = \\nu \\left( g_n''(x) w(x) - x g_n'(x) w(x) \\right).\n$$\n$$\n\\tilde{C}_L[\\phi_n](x) = \\nu w(x) \\left( g_n''(x) - x g_n'(x) \\right).\n$$\n本征问题 $\\tilde{C}_L[\\phi_n] = \\lambda_n \\phi_n$ 现在可以写为：\n$$\n\\nu w(x) \\left( g_n''(x) - x g_n'(x) \\right) = \\lambda_n g_n(x) w(x).\n$$\n由于 $w(x) = \\exp(-x^2/2)$ 永远不为零，我们可以用它除以两边，得到关于 $g_n(x)$ 的微分方程：\n$$\n\\nu \\left( g_n''(x) - x g_n'(x) \\right) = \\lambda_n g_n(x),\n$$\n或\n$$\ng_n''(x) - x g_n'(x) - \\frac{\\lambda_n}{\\nu} g_n(x) = 0.\n$$\n问题要求本征函数 $\\phi_n$ 快速衰减，这意味着函数 $g_n(x)$ 的增长速度不能超过多项式，否则 $w(x)$ 的高斯衰减将被抵消。因此，我们寻求 $g_n(x)$ 的多项式解。\n这个微分方程是厄米微分方程的一种形式。概率论学家的厄米多项式 $H_n(x)$ 定义为以下方程的多项式解：\n$$\nH_n''(x) - x H_n'(x) + n H_n(x) = 0.\n$$\n将我们关于 $g_n(x)$ 的方程与标准的厄米方程进行比较，我们看到它们的形式是相同的。为了使我们的方程有一个 $n$ 次多项式解，$g_n(x)$ 项的系数必须是一个非负整数，具体来说是 $-n$。\n因此，我们必须有以下对应关系：\n$$\n-\\frac{\\lambda_n}{\\nu} = n, \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\n根据这个条件，我们可以确定本征值 $\\lambda_n$：\n$$\n\\lambda_n = -n \\nu.\n$$\n相应的解 $g_n(x)$ 是概率论学家的厄米多项式 $H_n(x)$。因此，Lenard-Bernstein 算符的本征函数是\n$$\n\\phi_n(v) \\propto H_n(v/v_t) \\exp\\left(-\\frac{v^2}{2v_t^2}\\right).\n$$\n“关于权重 $M^{-1}(v)$ 的平方可积性”为这些本征函数建立了希尔伯特空间。这个空间中的内积是 $\\langle f, g \\rangle = \\int_{-\\infty}^{\\infty} f^*(v) g(v) M(v)^{-1} dv$。在这个空间中本征函数 $\\phi_n$ 的正交性，即当 $n \\neq m$ 时 $\\langle \\phi_n, \\phi_m \\rangle = 0$，直接转化为厄米多项式关于高斯权重的正交性：\n$$\n\\int_{-\\infty}^{\\infty} (H_n(x)w(x))^* (H_m(x)w(x)) (w(x)^{-1}) dx \\propto \\int_{-\\infty}^{\\infty} H_n(x) H_m(x) w(x) dx = 0 \\quad \\text{for } n \\neq m.\n$$\n这证实了厄米多项式是正确的多项式基。多项式解的要求（以确保具有物理意义的、非发散的行为）使本征值得以量子化。\n\n因此，每个非负整数 $n$ 的本征值由推导出的关系式给出。\n对于 $n=0$，$\\lambda_0 = 0$，本征函数为 $\\phi_0 \\propto H_0(x) w(x) \\propto M(v)$，即稳态麦克斯韦平衡。\n对于 $n0$，本征值为负，$\\lambda_n  0$，对应于向平衡态弛豫的衰减模式。",
            "answer": "$$\n\\boxed{-n\\nu}\n$$"
        },
        {
            "introduction": "这项练习是连接连续理论与计算实践的桥梁，对聚变模拟至关重要。计算机处理的是离散数据，本练习将指导你构建一个遵守粒子数守恒这一基本物理定律的有限体积格式。这个动手编码任务展示了如何将算符的散度形式正确地转化为稳健的数值算法 。",
            "id": "4205021",
            "problem": "考虑速度空间中单一种类的Lenard–Bernstein碰撞算子，其散度形式定义为 $C[f]=\\nu\\,\\nabla_{\\mathbf{v}}\\cdot\\left((\\mathbf{v}-u)\\,f+v_t^2\\,\\nabla_{\\mathbf{v}} f\\right)$，其中 $f$ 是速度分布函数，$\\nu$ 是碰撞频率，$u$ 是给定的漂移速度，$v_t$ 是热速度。在聚变等离子体湍流模拟的背景下，需要在一个截断的速度域上寻求一种守恒的离散化方法。在本问题中，重点关注一维速度坐标 $v\\in[v_{\\min},v_{\\max}]$，将 $\\nabla_{\\mathbf{v}}$ 理解为 $\\partial/\\partial v$，并设计一种有限体积离散化方法，通过使用面通量和在截断域边界处的零通量边界条件，来精确守恒粒子数。\n\n出发点：仅使用算子是速度空间中通量的散度这一定义、有限体积法是面通量之间平衡的定义，以及离散散度在所有控制体积上的和会伸缩为边界通量的观察。不要假设任何预先给定的离散化公式。推导面通量必须是什么，如何在一个通用网格上从单元中心值一致地近似它，以及必须如何在 $v_{\\min}$ 和 $v_{\\max}$ 处施加零通量边界条件以使总粒子数守恒。\n\n任务：\n- 从第一性原理出发，为算子 $C[f]=\\nu\\,\\partial_v\\left((v-u)\\,f+v_t^2\\,\\partial_v f\\right)$ 在 $[v_{\\min},v_{\\max}]$ 的一个划分为 $N$ 个单元的通用非均匀分区上推导一个有限体积格式。该分区的面为 $\\{v_{i-1/2}\\}_{i=1}^{N+1}$，中心为 $\\{v_i\\}_{i=1}^N$，其中 $v_i$ 是 $[v_{i-1/2},v_{i+1/2}]$ 的中点。您的推导必须展示（不使用快捷公式）每个内表面上的通量是如何通过对 $f$ 和 $\\partial_v f$ 的一致局部近似产生的，以及每个单元中的离散散度是如何通过两个面通量之差除以单元宽度构建的。论证为什么离散散度在所有单元上的全局总和等于边界通量之差。\n- 在截断的速度域上，在 $v=v_{\\min}$ 和 $v=v_{\\max}$ 处施加零通量边界条件，并证明该格式精确守恒总粒子数，即 $C[f]$ 在 $[v_{\\min},v_{\\max}]$ 上的有限体积积分为零。\n- 在一个程序中实现所得的格式。对于下述每个测试用例，该程序构建速度网格的面和中心，在单元中心定义一个光滑的分布函数 $f(v)$，计算每个单元中的离散碰撞算子值，并通过对单元贡献求和来评估算子在整个域上的积分。为了数值稳健性，也直接计算边界通量之差，并验证它与求和积分完全相同。每个测试用例最终报告的量必须是积分碰撞源 $\\int_{v_{\\min}}^{v_{\\max}} C[f](v)\\,dv$，以 $\\mathrm{s}^{-1}$ 为单位的浮点数表示。\n- 使用从一维正态分布构建的分布函数 $f(v)$，其均值为 $u_f$，标准差为 $v_{t,f}$，并在截断域上进行归一化，使得离散积分 $\\sum_i f_i\\,\\Delta v_i$ 等于 $1$，其中 $\\Delta v_i=v_{i+1/2}-v_{i-1/2}$，$f_i=f(v_i)$。这种归一化确保了总粒子数是无量纲的，并且在截断域上等于 $1$。\n\n测试套件和使用的参数：\n- 案例1（均匀网格，中等漂移和热速度）：$v_{\\min}=-4.0\\times 10^5\\,\\mathrm{m/s}$，$v_{\\max}=4.0\\times 10^5\\,\\mathrm{m/s}$，$N=200$，$\\nu=2.0\\times 10^4\\,\\mathrm{s}^{-1}$，$u=5.0\\times 10^4\\,\\mathrm{m/s}$，$v_t=1.5\\times 10^5\\,\\mathrm{m/s}$，$u_f=7.0\\times 10^4\\,\\mathrm{m/s}$，$v_{t,f}=1.2\\times 10^5\\,\\mathrm{m/s}$。\n- 案例2（在 $v=0$ 附近集中的拉伸网格）：$v_{\\min}=-6.0\\times 10^5\\,\\mathrm{m/s}$，$v_{\\max}=6.0\\times 10^5\\,\\mathrm{m/s}$，$N=300$，拉伸参数 $\\alpha=2.5$ 且对称映射，$\\nu=1.0\\times 10^5\\,\\mathrm{s}^{-1}$，$u=0\\,\\mathrm{m/s}$，$v_t=2.0\\times 10^5\\,\\mathrm{m/s}$，$u_f=0\\,\\mathrm{m/s}$，$v_{t,f}=1.8\\times 10^5\\,\\mathrm{m/s}$。\n- 案例3（小热速度，摩擦主导）：$v_{\\min}=-2.0\\times 10^4\\,\\mathrm{m/s}$，$v_{\\max}=2.0\\times 10^4\\,\\mathrm{m/s}$，$N=400$，$\\nu=5.0\\times 10^5\\,\\mathrm{s}^{-1}$，$u=1.0\\times 10^4\\,\\mathrm{m/s}$，$v_t=1.0\\times 10^3\\,\\mathrm{m/s}$，$u_f=-5.0\\times 10^3\\,\\mathrm{m/s}$，$v_{t,f}=1.1\\times 10^3\\,\\mathrm{m/s}$。\n- 案例4（拉伸网格上的大漂移）：$v_{\\min}=-1.0\\times 10^6\\,\\mathrm{m/s}$，$v_{\\max}=1.0\\times 10^6\\,\\mathrm{m/s}$，$N=250$，拉伸参数 $\\alpha=3.0$，$\\nu=3.0\\times 10^3\\,\\mathrm{s}^{-1}$，$u=3.0\\times 10^5\\,\\mathrm{m/s}$，$v_t=2.5\\times 10^5\\,\\mathrm{m/s}$，$u_f=1.0\\times 10^5\\,\\mathrm{m/s}$，$v_{t,f}=2.5\\times 10^5\\,\\mathrm{m/s}$。\n- 案例5（非常强的碰撞）：$v_{\\min}=-8.0\\times 10^5\\,\\mathrm{m/s}$，$v_{\\max}=8.0\\times 10^5\\,\\mathrm{m/s}$，$N=150$，$\\nu=1.0\\times 10^7\\,\\mathrm{s}^{-1}$，$u=-2.0\\times 10^5\\,\\mathrm{m/s}$，$v_t=3.0\\times 10^5\\,\\mathrm{m/s}$，$u_f=0\\,\\mathrm{m/s}$，$v_{t,f}=2.0\\times 10^5\\,\\mathrm{m/s}$。\n\n角度单位不相关。物理单位已在上面明确指定，积分碰撞源必须以 $\\mathrm{s}^{-1}$ 为单位的浮点数表示。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_k$ 是通过您的离散化计算出的第 $k$ 个案例的积分碰撞源 $\\int_{v_{\\min}}^{v_{\\max}} C[f](v)\\,dv$，单位为 $\\mathrm{s}^{-1}$。",
            "solution": "该问题要求推导并实现一维Lenard-Bernstein碰撞算子的守恒有限体积离散化，证明其守恒性质，并将其应用于几个测试用例。\n\n### 有限体积格式的推导\n\n一维Lenard-Bernstein碰撞算子以散度形式给出：\n$$\nC[f] = \\nu \\frac{\\partial}{\\partial v} \\left( (v-u)f + v_t^2 \\frac{\\partial f}{\\partial v} \\right)\n$$\n让我们定义速度空间通量 $J(v)$ 为：\n$$\nJ(v) = (v-u)f(v) + v_t^2 \\frac{\\partial f}{\\partial v}\n$$\n碰撞算子可以紧凑地写为 $C[f] = \\nu \\frac{\\partial J}{\\partial v}$。\n\n我们的目标是在一维域 $v \\in [v_{\\min}, v_{\\max}]$ 上离散化该算子。该域被划分为 $N$ 个连续的单元，或称有限体积。对于 $i \\in \\{1, 2, \\dots, N\\}$，第 $i$ 个单元是区间 $V_i = [v_{i-1/2}, v_{i+1/2}]$。这些单元的边界是面，位于位置 $\\{v_{i-1/2}\\}_{i=1}^{N+1}$ 处，其中 $v_{1/2} = v_{\\min}$ 且 $v_{N+1/2} = v_{\\max}$。单元 $i$ 的宽度为 $\\Delta v_i = v_{i+1/2} - v_{i-1/2}$。分布函数 $f(v)$ 由其单元中心值 $f_i = f(v_i)$ 表示，其中 $v_i$ 是单元 $V_i$ 的中心。根据规定，我们取 $v_i = (v_{i-1/2} + v_{i+1/2})/2$。\n\n有限体积法基于在每个单元上对控制方程进行积分。将碰撞算子在单元 $V_i$ 上积分得到：\n$$\n\\int_{v_{i-1/2}}^{v_{i+1/2}} C[f](v) \\, dv = \\int_{v_{i-1/2}}^{v_{i+1/2}} \\nu \\frac{\\partial J}{\\partial v} \\, dv\n$$\n根据微积分基本定理，散度（在一维中为导数）的积分等于在区间边界上求值的通量之差：\n$$\n\\int_{v_{i-1/2}}^{v_{i+1/2}} C[f](v) \\, dv = \\nu \\left[ J(v_{i+1/2}) - J(v_{i-1/2}) \\right]\n$$\n在单元 $i$ 中离散化算子的值，记为 $(C[f])_i$，是单元平均值，通过将积分除以单元体积（宽度）得到：\n$$\n(C[f])_i = \\frac{1}{\\Delta v_i} \\int_{v_{i-1/2}}^{v_{i+1/2}} C[f](v) \\, dv = \\frac{\\nu}{\\Delta v_i} \\left( J_{i+1/2} - J_{i-1/2} \\right)\n$$\n这里，$J_{i+1/2}$ 和 $J_{i-1/2}$ 分别是通量 $J(v)$ 在单元面 $v_{i+1/2}$ 和 $v_{i-1/2}$ 处的数值近似。\n\n为构建一个一致的格式，我们必须使用已知的单元中心值 $f_i$ 和 $f_{i+1}$ 来定义内表面 $v_{i+1/2}$（单元 $i$ 和单元 $i+1$ 之间的界面）上的数值通量 $J_{i+1/2}$。通量为 $J(v) = (v-u)f(v) + v_t^2 \\frac{\\partial f}{\\partial v}$。我们在面 $v_{i+1/2}$ 处近似各项：\n1.  速度 $v$ 精确为 $v_{i+1/2}$。\n2.  分布函数 $f(v_{i+1/2})$ 通过相邻单元值的二阶精确线性插值（简单平均）来近似：\n    $$\n    f(v_{i+1/2}) \\approx \\frac{f_i + f_{i+1}}{2}\n    $$\n3.  面上的导数 $\\frac{\\partial f}{\\partial v}$ 使用相邻单元中心值，通过二阶精确的中心有限差分来近似：\n    $$\n    \\left. \\frac{\\partial f}{\\partial v} \\right|_{v_{i+1/2}} \\approx \\frac{f_{i+1} - f_i}{v_{i+1} - v_i}\n    $$\n    此公式对通用的非均匀网格有效。\n\n将这些近似代入通量的定义，我们得到面 $v_{i+1/2}$ 上的数值通量（对于 $i=1, \\dots, N-1$）：\n$$\nJ_{i+1/2} = (v_{i+1/2} - u) \\left( \\frac{f_i + f_{i+1}}{2} \\right) + v_t^2 \\left( \\frac{f_{i+1} - f_i}{v_{i+1} - v_i} \\right)\n$$\n此表达式定义了所有内表面上的通量。\n\n### 粒子数守恒的证明\n\n域中总粒子数由分布函数的积分给出，即 $\\int_{v_{\\min}}^{v_{\\max}} f(v) \\, dv$。由于碰撞导致的总粒子数变化率是碰撞算子在整个域上的积分：\n$$\n\\frac{d}{dt} \\left( \\int_{v_{\\min}}^{v_{\\max}} f \\, dv \\right) = \\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv\n$$\n在我们的离散框架中，该积分通过对单元积分贡献求和来近似：\n$$\n\\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv \\approx \\sum_{i=1}^N (C[f])_i \\Delta v_i\n$$\n代入 $(C[f])_i$ 的表达式：\n$$\n\\sum_{i=1}^N (C[f])_i \\Delta v_i = \\sum_{i=1}^N \\frac{\\nu}{\\Delta v_i} \\left( J_{i+1/2} - J_{i-1/2} \\right) \\Delta v_i = \\nu \\sum_{i=1}^N \\left( J_{i+1/2} - J_{i-1/2} \\right)\n$$\n这是一个伸缩求和：\n$$\n\\sum_{i=1}^N \\left( J_{i+1/2} - J_{i-1/2} \\right) = (J_{3/2} - J_{1/2}) + (J_{5/2} - J_{3/2}) + \\dots + (J_{N+1/2} - J_{N-1/2})\n$$\n所有内部通量项都相互抵消，只剩下域边界上的通量：\n$$\n\\sum_{i=1}^N \\left( J_{i+1/2} - J_{i-1/2} \\right) = J_{N+1/2} - J_{1/2}\n$$\n因此，总的积分碰撞源为：\n$$\n\\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv \\approx \\nu (J_{N+1/2} - J_{1/2})\n$$\n问题要求在 $v = v_{\\min}$ 和 $v = v_{\\max}$ 处施加零通量边界条件。这对应于面 $v_{1/2}$ 和 $v_{N+1/2}$。因此，我们施加：\n$$\nJ_{1/2} = 0 \\quad \\text{and} \\quad J_{N+1/2} = 0\n$$\n使用这些边界条件，总粒子数的变化率变为：\n$$\n\\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv \\approx \\nu (0 - 0) = 0\n$$\n这证明了带有零通量边界条件的有限体积格式在离散层面上是完全守恒的。代数和恒为零。实现将计算此和，任何非零结果都将是由于浮点表示和算术误差造成的，这些误差预计可以忽略不计（在机器精度量级上）。\n\n### 实现计划\n\n对于每个测试用例，实现将遵循以下步骤：\n1.  定义网格面 $\\{v_{i-1/2}\\}$ 和中心 $\\{v_i\\}$。对于拉伸网格，将使用从 $[-1, 1]$ 上的均匀网格到 $[v_{\\min}, v_{\\max}]$ 的对称 `tanh` 映射。\n2.  定义单元宽度 $\\Delta v_i = v_{i+1/2} - v_{i-1/2}$。\n3.  使用给定的参数 $u_f$ 和 $v_{t,f}$ 在单元中心 $v_i$ 处评估一个未归一化的高斯分布。\n4.  归一化离散分布 $f_i$，使得 $\\sum_{i=1}^N f_i \\Delta v_i = 1$。\n5.  使用推导出的公式计算所有 $N-1$ 个内表面上的数值通量 $J_{i+1/2}$。边界通量 $J_{1/2}$ 和 $J_{N+1/2}$ 设置为 $0$。\n6.  为每个单元 $i=1, \\dots, N$ 计算离散算子 $(C[f])_i$。\n7.  通过对单元贡献求和来计算总积分源：$\\sum_{i=1}^N (C[f])_i \\Delta v_i$。\n8.  此求和的结果将是该测试用例报告的值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Lenard-Bernstein collision operator problem for a suite of test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: uniform grid, moderate drift and thermal speed\n        {'vmin': -4.0e5, 'vmax': 4.0e5, 'N': 200, 'nu': 2.0e4, 'u': 5.0e4, 'vt': 1.5e5, 'uf': 7.0e4, 'vtf': 1.2e5, 'stretch_alpha': None},\n        # Case 2: stretched grid concentrated near v=0\n        {'vmin': -6.0e5, 'vmax': 6.0e5, 'N': 300, 'nu': 1.0e5, 'u': 0.0, 'vt': 2.0e5, 'uf': 0.0, 'vtf': 1.8e5, 'stretch_alpha': 2.5},\n        # Case 3: small thermal speed, friction-dominated\n        {'vmin': -2.0e4, 'vmax': 2.0e4, 'N': 400, 'nu': 5.0e5, 'u': 1.0e4, 'vt': 1.0e3, 'uf': -5.0e3, 'vtf': 1.1e3, 'stretch_alpha': None},\n        # Case 4: large drift on stretched grid\n        {'vmin': -1.0e6, 'vmax': 1.0e6, 'N': 250, 'nu': 3.0e3, 'u': 3.0e5, 'vt': 2.5e5, 'uf': 1.0e5, 'vtf': 2.5e5, 'stretch_alpha': 3.0},\n        # Case 5: very strong collisions\n        {'vmin': -8.0e5, 'vmax': 8.0e5, 'N': 150, 'nu': 1.0e7, 'u': -2.0e5, 'vt': 3.0e5, 'uf': 0.0, 'vtf': 2.0e5, 'stretch_alpha': None},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters\n        vmin, vmax, N, nu, u, vt = case['vmin'], case['vmax'], case['N'], case['nu'], case['u'], case['vt']\n        uf, vtf, alpha = case['uf'], case['vtf'], case['stretch_alpha']\n        \n        # 1. Grid Generation\n        if alpha is None:\n            # Uniform grid\n            v_faces = np.linspace(vmin, vmax, N + 1)\n        else:\n            # Stretched grid using a symmetric tanh mapping\n            v_mid = (vmax + vmin) / 2.0\n            v_half_range = (vmax - vmin) / 2.0\n            xsi_faces = np.linspace(-1.0, 1.0, N + 1)\n            v_faces = v_mid + v_half_range * np.tanh(alpha * xsi_faces) / np.tanh(alpha)\n            \n        v_centers = (v_faces[:-1] + v_faces[1:]) / 2.0\n        delta_v = v_faces[1:] - v_faces[:-1]\n        \n        # 2. Define Distribution Function f\n        # Unnormalized Gaussian PDF\n        f_unnormalized = (1.0 / (vtf * np.sqrt(2.0 * np.pi))) * np.exp(-0.5 * ((v_centers - uf) / vtf)**2)\n        \n        # Normalize f such that the discrete integral is 1\n        total_number_unnormalized = np.sum(f_unnormalized * delta_v)\n        f_i = f_unnormalized / total_number_unnormalized\n        \n        # 3. Compute Numerical Fluxes\n        J_faces = np.zeros(N + 1) # Automatically sets boundary fluxes J_1/2 and J_N+1/2 to 0\n        \n        # Interior faces (indices 1 to N-1, corresponding to vector indices i=0 to N-2)\n        # These faces are between cells i and i+1\n        f_avg_at_face = (f_i[:-1] + f_i[1:]) / 2.0\n        df_dv_at_face = (f_i[1:] - f_i[:-1]) / (v_centers[1:] - v_centers[:-1])\n        \n        v_at_interior_faces = v_faces[1:-1]\n        \n        advective_flux = (v_at_interior_faces - u) * f_avg_at_face\n        diffusive_flux = (vt**2) * df_dv_at_face\n        \n        J_faces[1:-1] = advective_flux + diffusive_flux\n        \n        # 4. Compute Discrete Collision Operator\n        C_f = (nu / delta_v) * (J_faces[1:] - J_faces[:-1])\n        \n        # 5. Evaluate the Integral of the Operator\n        # This is the sum over all cells of (C_f_i * delta_v_i)\n        # Due to the telescoping sum property, this is equivalent to nu * (J_faces[-1] - J_faces[0])\n        # We calculate the sum explicitly as requested.\n        integrated_source = np.sum(C_f * delta_v)\n        \n        results.append(integrated_source)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}