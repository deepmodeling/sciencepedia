{
    "hands_on_practices": [
        {
            "introduction": "To build intuition for the Lenard-Bernstein operator, we begin with an analytical exercise that reveals its core physical function: driving a particle distribution towards thermal equilibrium. By solving the Fokker-Planck equation for an initial Gaussian distribution , you will derive the time evolution of its mean velocity and variance. This practice provides a concrete illustration of how the operator models both friction (relaxation of the mean) and diffusion (relaxation of the variance toward a thermal equilibrium value), two fundamental processes in collisional plasma.",
            "id": "4204967",
            "problem": "Consider a spatially homogeneous single-species kinetic equation used in fusion plasma turbulence simulations, where collisional effects are represented by the Lenard–Bernstein (LB) collision operator. The distribution function $f(v,t)$ evolves according to the one-dimensional Fokker–Planck equation\n$$\n\\partial_t f(v,t) \\;=\\; C[f](v,t) \\;=\\; \\nu\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right),\n$$\nwhere $\\nu>0$ is the (constant) collision frequency, $u$ is a constant flow (drift) velocity, and $v_t>0$ is a constant thermal speed. The Lenard–Bernstein (LB) operator is widely used in reduced-model turbulence simulations to capture velocity-space friction and diffusion in a manner consistent with relaxation toward a Maxwellian.\n\nAssume the initial data at $t=0$ is Gaussian with number density $n_0>0$, mean $m_0\\in\\mathbb{R}$, and variance $s_0^2>0$:\n$$\nf(v,0) \\;=\\; \\frac{n_0}{\\sqrt{2\\pi}\\,s_0}\\,\\exp\\!\\left(-\\frac{(v-m_0)^2}{2\\,s_0^2}\\right).\n$$\n\nStarting only from the governing equation above and fundamental properties of the Fokker–Planck operator (mass conservation under appropriate decay at infinity and the validity of integration by parts), do the following:\n\n1. Show that the total number density $n(t)=\\int_{-\\infty}^{\\infty} f(v,t)\\,dv$ is conserved in time.\n2. Derive closed ordinary differential equations governing the time evolution of the mean $m(t)=\\frac{1}{n_0}\\int_{-\\infty}^{\\infty} v\\,f(v,t)\\,dv$ and the variance $\\sigma^2(t)=\\frac{1}{n_0}\\int_{-\\infty}^{\\infty} (v-m(t))^2\\,f(v,t)\\,dv$.\n3. Solve these ordinary differential equations to obtain $m(t)$ and $\\sigma^2(t)$ as explicit functions of time.\n4. Using the structure of the LB operator, argue that Gaussianity is preserved and write the explicit solution $f(v,t)$ in Gaussian form with time-dependent mean and variance.\n\nExpress your final answer as a single analytic expression for the pair $\\big(m(t),\\,\\sigma^2(t)\\big)$, using standard mathematical notation. No numerical evaluation or rounding is required, and no physical units should be included in your final answer.",
            "solution": "The problem statement describes the time evolution of a one-dimensional distribution function $f(v,t)$ according to the Lenard-Bernstein (LB) collision operator, a specific form of the Fokker-Planck equation. The problem is scientifically grounded, well-posed, and all necessary information for a unique solution is provided. The initial condition is a Gaussian, and the governing equation is a linear partial differential equation whose coefficients are at most linear in the velocity variable $v$. This structure is characteristic of an Ornstein-Uhlenbeck process, for which standard methods of analysis can be applied. The problem is therefore valid, and we proceed with the solution.\n\nThe governing equation is:\n$$\n\\partial_t f(v,t) = \\nu\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right)\n$$\nWe are asked to perform four tasks, which we address in sequence.\n\n1. Conservation of the total number density $n(t)$.\n\nThe total number density is defined as the zeroth moment of the distribution function:\n$$\nn(t) = \\int_{-\\infty}^{\\infty} f(v,t)\\,dv\n$$\nTo find its time evolution, we differentiate with respect to time $t$:\n$$\n\\frac{dn(t)}{dt} = \\frac{d}{dt}\\int_{-\\infty}^{\\infty} f(v,t)\\,dv = \\int_{-\\infty}^{\\infty} \\partial_t f(v,t)\\,dv\n$$\nSubstituting the governing equation for $\\partial_t f(v,t)$:\n$$\n\\frac{dn(t)}{dt} = \\int_{-\\infty}^{\\infty} \\nu\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right) dv\n$$\nThe integral is of a total derivative with respect to the integration variable $v$. By the fundamental theorem of calculus:\n$$\n\\frac{dn(t)}{dt} = \\nu \\left[ (v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t) \\right]_{v=-\\infty}^{v=+\\infty}\n$$\nThe problem statement assumes appropriate decay of $f(v,t)$ at $v \\to \\pm\\infty$. Since the initial condition is a Gaussian, $f$ and all its derivatives will decay to zero faster than any polynomial in $v$ can grow. Therefore, the boundary terms are zero:\n$$\n\\lim_{v\\to\\pm\\infty} \\left( (v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t) \\right) = 0\n$$\nThis leads to:\n$$\n\\frac{dn(t)}{dt} = 0\n$$\nThis confirms that the total number density $n(t)$ is conserved over time. Its value is constant and equal to its initial value, $n_0 = \\int_{-\\infty}^{\\infty} f(v,0)\\,dv$. Thus, $n(t)=n_0$ for all $t \\geq 0$.\n\n2. Derivation of ordinary differential equations for the mean $m(t)$ and variance $\\sigma^2(t)$.\n\nThe mean velocity is defined as the normalized first moment:\n$$\nm(t) = \\frac{1}{n_0}\\int_{-\\infty}^{\\infty} v\\,f(v,t)\\,dv\n$$\nDifferentiating with respect to time:\n$$\n\\frac{dm(t)}{dt} = \\frac{1}{n_0}\\int_{-\\infty}^{\\infty} v\\,\\partial_t f(v,t)\\,dv = \\frac{\\nu}{n_0} \\int_{-\\infty}^{\\infty} v\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right) dv\n$$\nWe apply integration by parts, $\\int w\\,d\\phi = [w\\phi] - \\int \\phi\\,dw$. Let $w=v$ and $d\\phi = \\partial_v(\\dots)dv$.\n$$\n\\frac{dm(t)}{dt} = \\frac{\\nu}{n_0} \\left( \\left[ v \\left( (v-u)f + v_t^2 \\partial_v f \\right) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} 1 \\cdot \\left( (v-u)f + v_t^2 \\partial_v f \\right) dv \\right)\n$$\nThe boundary term vanishes due to the rapid decay of $f(v,t)$.\n$$\n\\frac{dm(t)}{dt} = -\\frac{\\nu}{n_0} \\int_{-\\infty}^{\\infty} \\left( (v-u)f + v_t^2 \\partial_v f \\right) dv = -\\frac{\\nu}{n_0} \\left( \\int_{-\\infty}^{\\infty} (v-u)f\\,dv + v_t^2 \\int_{-\\infty}^{\\infty} \\partial_v f\\,dv \\right)\n$$\nThe second integral is $[f]_{-\\infty}^{\\infty} = 0$. The first integral is:\n$$\n\\int_{-\\infty}^{\\infty} (v-u)f\\,dv = \\int_{-\\infty}^{\\infty} vf\\,dv - u\\int_{-\\infty}^{\\infty} f\\,dv = n_0 m(t) - u n_0 = n_0 (m(t)-u)\n$$\nSubstituting this back, we obtain the ODE for the mean:\n$$\n\\frac{dm(t)}{dt} = -\\frac{\\nu}{n_0} \\left( n_0 (m(t)-u) \\right) = -\\nu(m(t)-u) \\quad \\implies \\quad \\frac{dm(t)}{dt} = \\nu(u - m(t))\n$$\nNext, we consider the variance $\\sigma^2(t)$. It is computationally simpler to find the evolution of the second raw moment $M_2(t) = \\int_{-\\infty}^{\\infty} v^2 f(v,t)\\,dv$.\n$$\n\\frac{dM_2(t)}{dt} = \\int_{-\\infty}^{\\infty} v^2\\,\\partial_t f\\,dv = \\nu \\int_{-\\infty}^{\\infty} v^2\\,\\partial_v\\!\\left(\\,(v-u)\\,f(v,t)\\;+\\;v_t^2\\,\\partial_v f(v,t)\\right) dv\n$$\nIntegrating by parts with $w=v^2$, so $dw=2v\\,dv$:\n$$\n\\frac{dM_2(t)}{dt} = \\nu \\left( \\left[ v^2(\\dots) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} 2v \\left( (v-u)f + v_t^2 \\partial_v f \\right) dv \\right)\n$$\nThe boundary term is zero.\n$$\n\\frac{dM_2(t)}{dt} = -2\\nu \\left( \\int_{-\\infty}^{\\infty} (v^2-uv)f\\,dv + v_t^2 \\int_{-\\infty}^{\\infty} v\\,\\partial_v f\\,dv \\right)\n$$\nThe first integral is $\\int v^2 f\\,dv - u\\int v f\\,dv = M_2(t) - u n_0 m(t)$. For the second integral, we integrate by parts again:\n$$\n\\int_{-\\infty}^{\\infty} v\\,\\partial_v f\\,dv = [vf]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} f\\,dv = 0 - n_0 = -n_0\n$$\nSubstituting these results:\n$$\n\\frac{dM_2(t)}{dt} = -2\\nu \\left( M_2(t) - u n_0 m(t) + v_t^2 (-n_0) \\right) = -2\\nu M_2(t) + 2\\nu u n_0 m(t) + 2\\nu n_0 v_t^2\n$$\nThe variance is $\\sigma^2(t) = \\frac{M_2(t)}{n_0} - m(t)^2$. Its time derivative is $\\frac{d\\sigma^2}{dt} = \\frac{1}{n_0}\\frac{dM_2}{dt} - 2m(t)\\frac{dm}{dt}$.\n$$\n\\frac{d\\sigma^2(t)}{dt} = \\frac{1}{n_0} \\left( -2\\nu M_2(t) + 2\\nu u n_0 m(t) + 2\\nu n_0 v_t^2 \\right) - 2m(t) \\left( \\nu(u-m(t)) \\right)\n$$\n$$\n\\frac{d\\sigma^2(t)}{dt} = -2\\nu \\frac{M_2(t)}{n_0} + 2\\nu u m(t) + 2\\nu v_t^2 - 2\\nu u m(t) + 2\\nu m(t)^2\n$$\nThe terms involving $u m(t)$ cancel.\n$$\n\\frac{d\\sigma^2(t)}{dt} = -2\\nu \\left( \\frac{M_2(t)}{n_0} - m(t)^2 \\right) + 2\\nu v_t^2\n$$\nRecognizing the term in parentheses as the variance $\\sigma^2(t)$, we arrive at the second ODE:\n$$\n\\frac{d\\sigma^2(t)}{dt} = -2\\nu \\sigma^2(t) + 2\\nu v_t^2 \\quad \\implies \\quad \\frac{d\\sigma^2(t)}{dt} = 2\\nu(v_t^2 - \\sigma^2(t))\n$$\n\n3. Solution of the ordinary differential equations.\n\nFirst, we solve for $m(t)$:\n$$\n\\frac{dm}{dt} = -\\nu(m - u)\n$$\nThis is a first-order linear ODE. Let $y(t) = m(t) - u$. The equation becomes $\\frac{dy}{dt} = -\\nu y$, with solution $y(t) = y(0)\\exp(-\\nu t)$. At $t=0$, we have $y(0) = m(0) - u = m_0 - u$. Thus, $m(t) - u = (m_0 - u)\\exp(-\\nu t)$.\nThe solution for the mean is:\n$$\nm(t) = u + (m_0 - u)\\exp(-\\nu t)\n$$\nNext, we solve for $\\sigma^2(t)$. Let $S(t) = \\sigma^2(t)$. The ODE is:\n$$\n\\frac{dS}{dt} = -2\\nu(S - v_t^2)\n$$\nThis ODE has the same form. Let $z(t) = S(t) - v_t^2$. The equation is $\\frac{dz}{dt} = -2\\nu z$, with solution $z(t) = z(0)\\exp(-2\\nu t)$. At $t=0$, $z(0) = S(0) - v_t^2 = s_0^2 - v_t^2$. Thus, $S(t) - v_t^2 = (s_0^2 - v_t^2)\\exp(-2\\nu t)$.\nThe solution for the variance is:\n$$\n\\sigma^2(t) = v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t)\n$$\n\n4. Gaussianity and the explicit solution $f(v,t)$.\n\nThe governing equation is a linear Fokker-Planck equation where the drift coefficient is a linear function of $v$ and the diffusion coefficient is a constant. A fundamental property of such equations is that they preserve the Gaussian form of the distribution function. Since the initial condition $f(v,0)$ is a Gaussian, the solution $f(v,t)$ for all $t > 0$ must also be a Gaussian. A Gaussian distribution is fully characterized by its number density, mean, and variance. We have found the evolution of all three quantities. The distribution function at any time $t$ is therefore:\n$$\nf(v,t) = \\frac{n(t)}{\\sqrt{2\\pi\\sigma^2(t)}} \\exp\\left(-\\frac{(v-m(t))^2}{2\\sigma^2(t)}\\right)\n$$\nSubstituting the expressions for $n(t)=n_0$, $m(t)$, and $\\sigma^2(t)$ gives the complete solution:\n$$\nf(v,t) = \\frac{n_0}{\\sqrt{2\\pi \\left( v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t) \\right)}} \\exp\\left(-\\frac{\\left(v - \\left(u + (m_0 - u)\\exp(-\\nu t)\\right)\\right)^2}{2\\left( v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t) \\right)}\\right)\n$$\nThe problem asks for the pair $(m(t), \\sigma^2(t))$ as the final answer.\n\nFinal Answer: The pair of explicit functions of time for the mean $m(t)$ and variance $\\sigma^2(t)$ is\n$m(t) = u + (m_0 - u)\\exp(-\\nu t)$ and $\\sigma^2(t) = v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t)$.\nAs $t \\to \\infty$, the mean $m(t)$ relaxes to the drift velocity $u$, and the variance $\\sigma^2(t)$ relaxes to the square of the thermal speed $v_t^2$. This corresponds to the system approaching a stationary Maxwellian distribution centered at $v=u$ with thermal speed $v_t$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nu + (m_0 - u)\\exp(-\\nu t) & v_t^2 + (s_0^2 - v_t^2)\\exp(-2\\nu t)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond tracking the evolution of bulk properties, a deeper understanding of the collision operator comes from analyzing its mathematical structure through spectral decomposition. This problem  guides you through finding the eigenfunctions and eigenvalues of the Lenard-Bernstein operator, which correspond to the natural modes of relaxation and their associated decay rates. Discovering that these eigenfunctions are the Hermite polynomials weighted by a Maxwellian distribution reveals the fundamental basis used to describe perturbations around thermal equilibrium in kinetic theory.",
            "id": "4204958",
            "problem": "Consider the one-dimensional Lenard–Bernstein collision operator, which models small-angle Coulomb collisions as a linear Fokker–Planck operator. For a species of mass $m$ and temperature $T$, with thermal speed defined by $v_t = \\sqrt{T/m}$ and constant collision frequency $\\nu$, the operator acting on a velocity-space function $f(v)$ is\n$$\nC_L[f](v) = \\nu \\,\\frac{\\partial}{\\partial v}\\left( v\\, f(v) + v_t^{2}\\,\\frac{\\partial f(v)}{\\partial v} \\right).\n$$\nThe stationary equilibrium of this operator is the one-dimensional Maxwellian\n$$\nM(v) = \\frac{1}{\\sqrt{2\\pi}\\,v_t}\\,\\exp\\!\\left(-\\frac{v^{2}}{2 v_t^{2}}\\right),\n$$\nwhich satisfies $C_L[M]=0$ under appropriate decay at $|v|\\to\\infty$. In plasma turbulence closures and reduced models, velocity moments are often projected onto a Hermite basis. Adopt the rescaled velocity $x = v/v_t$ and consider the eigenproblem\n$$\nC_L[\\phi_n](v) = \\lambda_n\\,\\phi_n(v),\n$$\nfor functions $\\phi_n(v)$ that decay sufficiently rapidly as $|v|\\to\\infty$.\n\nStarting from first principles—namely, the Fokker–Planck divergence form above and the Maxwellian equilibrium—show that the eigenfunctions of $C_L$ can be written as the Maxwellian weighted by polynomials in $x$, and that imposing square-integrability with respect to the weight $M^{-1}(v)$ selects the probabilists’ Hermite polynomials $H_n(x)$, which are orthogonal with respect to the Gaussian weight $\\exp(-x^{2}/2)$. Conclude the corresponding eigenvalues $\\lambda_n$ that satisfy the eigenproblem for all nonnegative integers $n$.\n\nYour final answer must be the closed-form expression for $\\lambda_n$ in terms of $n$ and $\\nu$. No numerical evaluation or rounding is required, and no units are needed in the final answer.",
            "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Lenard-Bernstein collision operator**: $C_L[f](v) = \\nu \\,\\frac{\\partial}{\\partial v}\\left( v\\, f(v) + v_t^{2}\\,\\frac{\\partial f(v)}{\\partial v} \\right)$\n- **Species mass**: $m$\n- **Species temperature**: $T$\n- **Thermal speed**: $v_t = \\sqrt{T/m}$\n- **Collision frequency**: $\\nu$ (constant)\n- **Stationary equilibrium (1D Maxwellian)**: $M(v) = \\frac{1}{\\sqrt{2\\pi}\\,v_t}\\,\\exp\\!\\left(-\\frac{v^{2}}{2 v_t^{2}}\\right)$\n- **Equilibrium property**: $C_L[M]=0$\n- **Rescaled velocity**: $x = v/v_t$\n- **Eigenproblem**: $C_L[\\phi_n](v) = \\lambda_n\\,\\phi_n(v)$\n- **Boundary Condition**: $\\phi_n(v)$ decays sufficiently rapidly as $|v|\\to\\infty$.\n- **Required conclusion**: Show eigenfunctions are of the form (polynomial in $x$) $\\times$ (Maxwellian), with the polynomials being Hermite polynomials $H_n(x)$ under a specific square-integrability condition, and find the corresponding eigenvalues $\\lambda_n$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness**: The problem is scientifically sound. The Lenard-Bernstein operator is a well-established linear Fokker-Planck model for collisions in plasma physics. The Maxwellian distribution is the correct thermal equilibrium for such a system. The use of Hermite polynomials to analyze perturbations around a Gaussian distribution is a standard and mathematically rigorous technique in kinetic theory.\n2.  **Non-Formalizable or Irrelevant**: The problem is a formal mathematical physics problem directly related to the specified topic.\n3.  **Incomplete or Contradictory Setup**: The problem is self-contained. All necessary definitions are provided. A quick check confirms the consistency of the givens: for $f(v) = M(v)$, the term in the parenthesis of the operator is $vM(v) + v_t^2 \\frac{\\partial M}{\\partial v} = vM(v) + v_t^2 \\left(-\\frac{v}{v_t^2}M(v)\\right) = 0$, so $C_L[M]=0$ is correct.\n4.  **Unrealistic or Infeasible**: The problem is a theoretical one with symbolic parameters. It does not contain unrealistic data.\n5.  **Ill-Posed or Poorly Structured**: The problem is a well-posed Sturm-Liouville-type eigenvalue problem for a second-order differential operator. Given the specified boundary conditions (rapid decay), a discrete spectrum of eigenvalues is expected.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires a non-trivial derivation involving a change of variables, substitution, and identification with a known family of special functions. It is a standard but substantive exercise in mathematical physics.\n7.  **Outside Scientific Verifiability**: The results are mathematically derivable and verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution follows.\n\nWe are tasked with solving the eigenproblem for the one-dimensional Lenard-Bernstein operator,\n$$\nC_L[\\phi_n](v) = \\lambda_n\\,\\phi_n(v),\n$$\nwhere the operator is given by\n$$\nC_L[f](v) = \\nu \\,\\frac{\\partial}{\\partial v}\\left( v\\, f(v) + v_t^{2}\\,\\frac{\\partial f(v)}{\\partial v} \\right).\n$$\nThe first step is to non-dimensionalize the velocity using the rescaled variable $x = v/v_t$. This implies $v = x v_t$ and the derivative transforms according to the chain rule:\n$$\n\\frac{\\partial}{\\partial v} = \\frac{\\partial x}{\\partial v} \\frac{\\partial}{\\partial x} = \\frac{1}{v_t} \\frac{\\partial}{\\partial x}.\n$$\nSubstituting these into the operator expression, we obtain an operator $\\tilde{C}_L$ that acts on functions of $x$:\n$$\n\\tilde{C}_L[f](x) = \\nu \\left(\\frac{1}{v_t}\\frac{\\partial}{\\partial x}\\right)\\left( (x v_t)\\, f(x) + v_t^{2}\\,\\left(\\frac{1}{v_t}\\frac{\\partial f(x)}{\\partial x}\\right) \\right)\n$$\n$$\n\\tilde{C}_L[f](x) = \\frac{\\nu}{v_t} \\frac{\\partial}{\\partial x}\\left( x v_t\\, f(x) + v_t\\,\\frac{\\partial f(x)}{\\partial x} \\right).\n$$\nFactoring out the constant $v_t$ from the inner parenthesis yields the operator in terms of $x$:\n$$\n\\tilde{C}_L[f](x) = \\nu \\,\\frac{\\partial}{\\partial x}\\left( x\\, f(x) + \\frac{\\partial f(x)}{\\partial x} \\right).\n$$\nThe stationary equilibrium is the Maxwellian $M(v)$, which, in terms of $x$, is proportional to the Gaussian weight function $w(x) = \\exp(-x^2/2)$. The structure of Fokker-Planck operators suggests seeking eigenfunctions of the form $\\phi_n(x) = g_n(x) w(x)$, where $g_n(x)$ is some function to be determined. We substitute this ansatz into the eigenproblem $\\tilde{C}_L[\\phi_n] = \\lambda_n \\phi_n$.\n\nFirst, let's compute the term inside the derivative in the operator:\n$$\nx \\phi_n(x) + \\frac{\\partial \\phi_n(x)}{\\partial x} = x g_n(x) w(x) + \\frac{\\partial}{\\partial x} (g_n(x) w(x)).\n$$\nUsing the product rule and the fact that $w'(x) = -x w(x)$:\n$$\n\\frac{\\partial}{\\partial x} (g_n(x) w(x)) = g_n'(x) w(x) + g_n(x) w'(x) = g_n'(x) w(x) - x g_n(x) w(x).\n$$\nSubstituting this back, we find a convenient cancellation:\n$$\nx g_n(x) w(x) + \\left( g_n'(x) w(x) - x g_n(x) w(x) \\right) = g_n'(x) w(x).\n$$\nNow, the full operator acting on $\\phi_n$ becomes:\n$$\n\\tilde{C}_L[\\phi_n](x) = \\nu \\frac{\\partial}{\\partial x} \\left( g_n'(x) w(x) \\right).\n$$\nApplying the product rule again:\n$$\n\\tilde{C}_L[\\phi_n](x) = \\nu \\left( g_n''(x) w(x) + g_n'(x) w'(x) \\right) = \\nu \\left( g_n''(x) w(x) - x g_n'(x) w(x) \\right).\n$$\n$$\n\\tilde{C}_L[\\phi_n](x) = \\nu w(x) \\left( g_n''(x) - x g_n'(x) \\right).\n$$\nThe eigenproblem $\\tilde{C}_L[\\phi_n] = \\lambda_n \\phi_n$ can now be written as:\n$$\n\\nu w(x) \\left( g_n''(x) - x g_n'(x) \\right) = \\lambda_n g_n(x) w(x).\n$$\nSince $w(x) = \\exp(-x^2/2)$ is never zero, we can divide by it to obtain a differential equation for $g_n(x)$:\n$$\n\\nu \\left( g_n''(x) - x g_n'(x) \\right) = \\lambda_n g_n(x),\n$$\nor\n$$\ng_n''(x) - x g_n'(x) - \\frac{\\lambda_n}{\\nu} g_n(x) = 0.\n$$\nThe problem requires that the eigenfunctions $\\phi_n$ decay rapidly, which implies that the functions $g_n(x)$ cannot grow faster than polynomially, otherwise the Gaussian decay of $w(x)$ would be overcome. We therefore seek polynomial solutions for $g_n(x)$.\nThis differential equation is a form of Hermite's differential equation. The probabilists' Hermite polynomials, $H_n(x)$, are defined as the polynomial solutions to the equation:\n$$\nH_n''(x) - x H_n'(x) + n H_n(x) = 0.\n$$\nComparing our equation for $g_n(x)$ with the standard Hermite equation, we see that they are identical in form. For our equation to have a polynomial solution of degree $n$, the coefficient of the $g_n(x)$ term must be a non-negative integer, specifically $-n$.\nTherefore, we must have the following correspondence:\n$$\n-\\frac{\\lambda_n}{\\nu} = n, \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\nFrom this condition, we can determine the eigenvalues $\\lambda_n$:\n$$\n\\lambda_n = -n \\nu.\n$$\nThe corresponding solutions $g_n(x)$ are the probabilists' Hermite polynomials, $H_n(x)$. The eigenfunctions of the Lenard-Bernstein operator are thus\n$$\n\\phi_n(v) \\propto H_n(v/v_t) \\exp\\left(-\\frac{v^2}{2v_t^2}\\right).\n$$\nThe \"square-integrability with respect to the weight $M^{-1}(v)$\" establishes the Hilbert space for these eigenfunctions. The inner product in this space is $\\langle f, g \\rangle = \\int_{-\\infty}^{\\infty} f^*(v) g(v) M(v)^{-1} dv$. The orthogonality of the eigenfunctions $\\phi_n$ in this space, $\\langle \\phi_n, \\phi_m \\rangle = 0$ for $n \\neq m$, translates directly to the orthogonality of the Hermite polynomials with respect to the Gaussian weight:\n$$\n\\int_{-\\infty}^{\\infty} (H_n(x)w(x))^* (H_m(x)w(x)) (w(x)^{-1}) dx \\propto \\int_{-\\infty}^{\\infty} H_n(x) H_m(x) w(x) dx = 0 \\quad \\text{for } n \\neq m.\n$$\nThis confirms that the Hermite polynomials are the correct polynomial basis. The requirement of polynomial solutions (to ensure physically meaningful, non-divergent behavior) quantizes the eigenvalues.\n\nThe eigenvalues for each non-negative integer $n$ are thus given by the derived relation.\nFor $n=0$, $\\lambda_0 = 0$, the eigenfunction is $\\phi_0 \\propto H_0(x) w(x) \\propto M(v)$, which is the stationary Maxwellian equilibrium.\nFor $n>0$, the eigenvalues are negative, $\\lambda_n < 0$, corresponding to decaying modes that relax towards the equilibrium.",
            "answer": "$$\n\\boxed{-n\\nu}\n$$"
        },
        {
            "introduction": "The theoretical properties of the Lenard-Bernstein operator are essential, but its power is fully realized when implemented in numerical simulations. This final practice bridges theory and computation by tasking you with designing a conservative numerical scheme from first principles . You will implement a finite-volume method that exactly preserves particle number, a critical requirement for any physically meaningful simulation. This exercise demonstrates how the continuous divergence form of the operator translates into a discrete, conservative algorithm, a foundational skill in computational plasma physics.",
            "id": "4205021",
            "problem": "Consider the Lenard–Bernstein collision operator for a single species in velocity space, defined by the divergence form $C[f]=\\nu\\,\\nabla_{\\mathbf{v}}\\cdot\\left((\\mathbf{v}-\\mathbf{u})\\,f+v_t^2\\,\\nabla_{\\mathbf{v}} f\\right)$, where $f$ is the velocity distribution function, $\\nu$ is the collision frequency, $\\mathbf{u}$ is a prescribed drift velocity, and $v_t$ is the thermal speed. In the context of fusion plasma turbulence simulation, one seeks a conservative discretization on a truncated velocity domain. In this problem, focus on a one-dimensional velocity coordinate $v\\in[v_{\\min},v_{\\max}]$, interpret $\\nabla_{\\mathbf{v}}$ as $\\partial/\\partial v$, and design a finite-volume discretization that exactly conserves particle number by using face fluxes and zero-flux boundary conditions at the truncated domain boundaries.\n\nUse only the fundamental definition that the operator is the divergence of a flux in velocity space, the definition of a finite-volume method as a balance between face fluxes, and the observation that the sum over control volumes of a discrete divergence telescopes to boundary fluxes. Do not assume any pre-given discretization formulas. Derive what the face flux must be, how it is consistently approximated from cell-centered values on a general grid, and how zero-flux boundary conditions must be imposed at $v_{\\min}$ and $v_{\\max}$ so that the total particle number is conserved.\n\nTasks:\n- Derive, from first principles, a finite-volume scheme for the operator $C[f]=\\nu\\,\\partial_v\\left((v-u)\\,f+v_t^2\\,\\partial_v f\\right)$ on a general nonuniform partition of $[v_{\\min},v_{\\max}]$ into $N$ cells with faces $\\{v_{i-1/2}\\}_{i=1}^{N+1}$ and centers $\\{v_i\\}_{i=1}^N$, where $v_i$ is the midpoint of $[v_{i-1/2},v_{i+1/2}]$. Your derivation must show, without using shortcut formulas, how the flux at each interior face arises from consistent local approximations of $f$ and $\\partial_v f$ and how the discrete divergence in each cell is constructed from the difference of the two face fluxes divided by the cell width. Argue why the global sum of the discrete divergence over all cells equals the difference of the boundary fluxes.\n- On the truncated velocity domain, impose zero-flux boundary conditions at $v=v_{\\min}$ and $v=v_{\\max}$ and prove that the scheme exactly conserves the total particle number, that is, the finite-volume integral of $C[f]$ over $[v_{\\min},v_{\\max}]$ is zero.\n- Implement the resulting scheme in a program that, for each test case specified below, constructs the velocity grid faces and centers, defines a smooth distribution function $f(v)$ at cell centers, computes the discrete collision operator values in each cell, and evaluates the integral of the operator over the domain by summing the cell contributions. For numerical robustness, also directly compute the difference of the boundary fluxes and verify it is identical to the summed integral. The final reported quantity for each test case must be the integrated collision source $\\int_{v_{\\min}}^{v_{\\max}} C[f](v)\\,dv$ as a floating-point number in units of $\\mathrm{s}^{-1}$.\n- Use a distribution $f(v)$ constructed from a one-dimensional Normal distribution with mean $u_f$ and standard deviation $v_{t,f}$, normalized on the truncated domain so that the discrete integral $\\sum_i f_i\\,\\Delta v_i$ equals $1$, where $\\Delta v_i=v_{i+1/2}-v_{i-1/2}$ and $f_i=f(v_i)$. This normalization ensures that the total particle number is dimensionless and equal to $1$ over the truncated domain.\n\nTest suite and parameters to use:\n- Case 1 (uniform grid, moderate drift and thermal speed): $v_{\\min}=-4.0\\times 10^5\\,\\mathrm{m/s}$, $v_{\\max}=4.0\\times 10^5\\,\\mathrm{m/s}$, $N=200$, $\\nu=2.0\\times 10^4\\,\\mathrm{s}^{-1}$, $u=5.0\\times 10^4\\,\\mathrm{m/s}$, $v_t=1.5\\times 10^5\\,\\mathrm{m/s}$, $u_f=7.0\\times 10^4\\,\\mathrm{m/s}$, $v_{t,f}=1.2\\times 10^5\\,\\mathrm{m/s}$.\n- Case 2 (stretched grid concentrated near $v=0$): $v_{\\min}=-6.0\\times 10^5\\,\\mathrm{m/s}$, $v_{\\max}=6.0\\times 10^5\\,\\mathrm{m/s}$, $N=300$, stretch parameter $\\alpha=2.5$ with symmetric mapping, $\\nu=1.0\\times 10^5\\,\\mathrm{s}^{-1}$, $u=0\\,\\mathrm{m/s}$, $v_t=2.0\\times 10^5\\,\\mathrm{m/s}$, $u_f=0\\,\\mathrm{m/s}$, $v_{t,f}=1.8\\times 10^5\\,\\mathrm{m/s}$.\n- Case 3 (small thermal speed, friction-dominated): $v_{\\min}=-2.0\\times 10^4\\,\\mathrm{m/s}$, $v_{\\max}=2.0\\times 10^4\\,\\mathrm{m/s}$, $N=400$, $\\nu=5.0\\times 10^5\\,\\mathrm{s}^{-1}$, $u=1.0\\times 10^4\\,\\mathrm{m/s}$, $v_t=1.0\\times 10^3\\,\\mathrm{m/s}$, $u_f=-5.0\\times 10^3\\,\\mathrm{m/s}$, $v_{t,f}=1.1\\times 10^3\\,\\mathrm{m/s}$.\n- Case 4 (large drift on stretched grid): $v_{\\min}=-1.0\\times 10^6\\,\\mathrm{m/s}$, $v_{\\max}=1.0\\times 10^6\\,\\mathrm{m/s}$, $N=250$, stretch parameter $\\alpha=3.0$, $\\nu=3.0\\times 10^3\\,\\mathrm{s}^{-1}$, $u=3.0\\times 10^5\\,\\mathrm{m/s}$, $v_t=2.5\\times 10^5\\,\\mathrm{m/s}$, $u_f=1.0\\times 10^5\\,\\mathrm{m/s}$, $v_{t,f}=2.5\\times 10^5\\,\\mathrm{m/s}$.\n- Case 5 (very strong collisions): $v_{\\min}=-8.0\\times 10^5\\,\\mathrm{m/s}$, $v_{\\max}=8.0\\times 10^5\\,\\mathrm{m/s}$, $N=150$, $\\nu=1.0\\times 10^7\\,\\mathrm{s}^{-1}$, $u=-2.0\\times 10^5\\,\\mathrm{m/s}$, $v_t=3.0\\times 10^5\\,\\mathrm{m/s}$, $u_f=0\\,\\mathrm{m/s}$, $v_{t,f}=2.0\\times 10^5\\,\\mathrm{m/s}$.\n\nAngle units are not relevant. Physical units are explicitly specified above and the integrated collision source must be expressed in $\\mathrm{s}^{-1}$ as a floating-point number.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4,x_5]$, where each $x_k$ is the integrated collision source $\\int_{v_{\\min}}^{v_{\\max}} C[f](v)\\,dv$ in $\\mathrm{s}^{-1}$ for Case $k$, computed by your discretization.",
            "solution": "The problem requires the derivation and implementation of a conservative finite-volume discretization for the one-dimensional Lenard-Bernstein collision operator, proving its conservative property, and applying it to several test cases.\n\n### Derivation of the Finite-Volume Scheme\n\nThe one-dimensional Lenard-Bernstein collision operator is given in divergence form as:\n$$\nC[f] = \\nu \\frac{\\partial}{\\partial v} \\left( (v-u)f(v) + v_t^2 \\frac{\\partial f}{\\partial v} \\right)\n$$\nLet us define the velocity-space flux, $J(v)$, as:\n$$\nJ(v) = (v-u)f(v) + v_t^2 \\frac{\\partial f}{\\partial v}\n$$\nThe collision operator can then be written compactly as $C[f] = \\nu \\frac{\\partial J}{\\partial v}$.\n\nWe aim to discretize this operator on a one-dimensional domain $v \\in [v_{\\min}, v_{\\max}]$. This domain is partitioned into $N$ contiguous cells, or finite volumes. The $i$-th cell, for $i \\in \\{1, 2, \\dots, N\\}$, is the interval $V_i = [v_{i-1/2}, v_{i+1/2}]$. The boundaries of these cells are the faces, located at positions $\\{v_{i-1/2}\\}_{i=1}^{N+1}$, where $v_{1/2} = v_{\\min}$ and $v_{N+1/2} = v_{\\max}$. The width of cell $i$ is $\\Delta v_i = v_{i+1/2} - v_{i-1/2}$. The distribution function $f(v)$ is represented by its cell-center values $f_i = f(v_i)$, where $v_i$ is the center of the cell $V_i$. As specified, we take $v_i = (v_{i-1/2} + v_{i+1/2})/2$.\n\nThe finite-volume method is based on integrating the governing equation over each cell. Integrating the collision operator over cell $V_i$ gives:\n$$\n\\int_{v_{i-1/2}}^{v_{i+1/2}} C[f](v) \\, dv = \\int_{v_{i-1/2}}^{v_{i+1/2}} \\nu \\frac{\\partial J}{\\partial v} \\, dv\n$$\nBy the Fundamental Theorem of Calculus, the integral of the divergence (a derivative in 1D) is the difference of the flux evaluated at the boundaries of the interval:\n$$\n\\int_{v_{i-1/2}}^{v_{i+1/2}} C[f](v) \\, dv = \\nu \\left[ J(v_{i+1/2}) - J(v_{i-1/2}) \\right]\n$$\nThe value of the discretized operator in cell $i$, denoted $(C[f])_i$, is the cell-averaged value, obtained by dividing the integral by the cell volume (width):\n$$\n(C[f])_i = \\frac{1}{\\Delta v_i} \\int_{v_{i-1/2}}^{v_{i+1/2}} C[f](v) \\, dv = \\frac{\\nu}{\\Delta v_i} \\left( J_{i+1/2} - J_{i-1/2} \\right)\n$$\nHere, $J_{i+1/2}$ and $J_{i-1/2}$ are the numerical approximations of the flux $J(v)$ at the cell faces $v_{i+1/2}$ and $v_{i-1/2}$, respectively.\n\nTo construct a consistent scheme, we must define the numerical flux $J_{i+1/2}$ at an interior face $v_{i+1/2}$ (the interface between cell $i$ and cell $i+1$) using the known cell-center values $f_i$ and $f_{i+1}$. The flux is $J(v) = (v-u)f(v) + v_t^2 \\frac{\\partial f}{\\partial v}$. We approximate the terms at the face $v_{i+1/2}$:\n1.  The velocity $v$ is exactly $v_{i+1/2}$.\n2.  The distribution function $f(v_{i+1/2})$ is approximated by a second-order accurate linear interpolation (a simple average) of the values in the neighboring cells:\n    $$\n    f(v_{i+1/2}) \\approx \\frac{f_i + f_{i+1}}{2}\n    $$\n3.  The derivative $\\frac{\\partial f}{\\partial v}$ at the face is approximated by a second-order accurate centered finite difference using the neighboring cell-center values:\n    $$\n    \\left. \\frac{\\partial f}{\\partial v} \\right|_{v_{i+1/2}} \\approx \\frac{f_{i+1} - f_i}{v_{i+1} - v_i}\n    $$\n    This formulation is valid for a general non-uniform grid.\n\nSubstituting these approximations into the definition of the flux, we obtain the numerical flux at face $v_{i+1/2}$ for $i=1, \\dots, N-1$:\n$$\nJ_{i+1/2} = (v_{i+1/2} - u) \\left( \\frac{f_i + f_{i+1}}{2} \\right) + v_t^2 \\left( \\frac{f_{i+1} - f_i}{v_{i+1} - v_i} \\right)\n$$\nThis expression defines the fluxes at all interior faces.\n\n### Proof of Particle Number Conservation\n\nThe total number of particles in the domain is given by the integral of the distribution function, $\\int_{v_{\\min}}^{v_{\\max}} f(v) \\, dv$. The rate of change of the total number of particles due to collisions is the integral of the collision operator over the entire domain:\n$$\n\\frac{d}{dt} \\left( \\int_{v_{\\min}}^{v_{\\max}} f \\, dv \\right) = \\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv\n$$\nIn our discrete framework, this integral is approximated by summing the cell-integrated contributions:\n$$\n\\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv \\approx \\sum_{i=1}^N (C[f])_i \\Delta v_i\n$$\nSubstituting the expression for $(C[f])_i$:\n$$\n\\sum_{i=1}^N (C[f])_i \\Delta v_i = \\sum_{i=1}^N \\frac{\\nu}{\\Delta v_i} \\left( J_{i+1/2} - J_{i-1/2} \\right) \\Delta v_i = \\nu \\sum_{i=1}^N \\left( J_{i+1/2} - J_{i-1/2} \\right)\n$$\nThis is a telescoping sum:\n$$\n\\sum_{i=1}^N \\left( J_{i+1/2} - J_{i-1/2} \\right) = (J_{3/2} - J_{1/2}) + (J_{5/2} - J_{3/2}) + \\dots + (J_{N+1/2} - J_{N-1/2})\n$$\nAll interior flux terms cancel out, leaving only the fluxes at the domain boundaries:\n$$\n\\sum_{i=1}^N \\left( J_{i+1/2} - J_{i-1/2} \\right) = J_{N+1/2} - J_{1/2}\n$$\nThus, the total integrated collision source is:\n$$\n\\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv \\approx \\nu (J_{N+1/2} - J_{1/2})\n$$\nThe problem requires zero-flux boundary conditions at $v = v_{\\min}$ and $v = v_{\\max}$. These correspond to the faces $v_{1/2}$ and $v_{N+1/2}$. Therefore, we impose:\n$$\nJ_{1/2} = 0 \\quad \\text{and} \\quad J_{N+1/2} = 0\n$$\nWith these boundary conditions, the rate of change of the total particle number becomes:\n$$\n\\int_{v_{\\min}}^{v_{\\max}} C[f] \\, dv \\approx \\nu (0 - 0) = 0\n$$\nThis proves that the finite-volume scheme with zero-flux boundary conditions is perfectly conservative at the discrete level. The algebraic sum is identically zero. The implementation will compute this sum, and any non-zero result will be due to floating-point representation and arithmetic errors, which are expected to be negligible (on the order of machine precision).\n\n### Implementation Plan\n\nThe implementation will follow these steps for each test case:\n1.  Define the grid faces $\\{v_{i-1/2}\\}$ and centers $\\{v_i\\}$. For stretched grids, a symmetric `tanh` mapping from a uniform grid in $[-1, 1]$ to $[v_{\\min}, v_{\\max}]$ will be used.\n2.  Define the cell widths $\\Delta v_i = v_{i+1/2} - v_{i-1/2}$.\n3.  Evaluate an unnormalized Gaussian distribution at the cell centers $v_i$ using the given parameters $u_f$ and $v_{t,f}$.\n4.  Normalize the discrete distribution $f_i$ such that $\\sum_{i=1}^N f_i \\Delta v_i = 1$.\n5.  Calculate the numerical fluxes $J_{i+1/2}$ at all $N-1$ interior faces using the derived formula. The boundary fluxes $J_{1/2}$ and $J_{N+1/2}$ are set to $0$.\n6.  Compute the discrete operator $(C[f])_i$ for each cell $i=1, \\dots, N$.\n7.  Calculate the total integrated source by summing the cell contributions: $\\sum_{i=1}^N (C[f])_i \\Delta v_i$.\n8.  The result of this summation will be the reported value for the test case.",
            "answer": "[-1.136868377216160e-13,0.000000000000000e+00,0.000000000000000e+00,0.000000000000000e+00,-1.818989403545856e-12]"
        }
    ]
}