{
    "hands_on_practices": [
        {
            "introduction": "对换位和气球模不稳定性的分析始于一个核心问题：是什么在驱动这些不稳定性？答案在于等离子体压力梯度与磁场曲率之间的相互作用。为了定量地研究这种驱动效应，物理学家们在 $s-\\alpha$ 模型中引入了归一化压力梯度参数 $\\alpha$。这个实践练习旨在将抽象的参数 $\\alpha$ 与可测量的物理量联系起来。通过使用托卡马克装置中的典型参数计算其数值，您将对不稳定性驱动的量级有一个具体的认识，并能定性地评估等离子体在著名的 $s-\\alpha$ 稳定性图中的位置 。",
            "id": "4192698",
            "problem": "考虑一个大环径比、圆形磁通面的托卡马克平衡，其中环向磁场在感兴趣的区域内径向近似恒定。您正在使用标准的剪切-alpha（$s$–$\\alpha$）框架分析理想磁流体动力学（MHD）气球模不稳定性，其中归一化压力梯度参数 $\\alpha$ 概括了由不利曲率引起的交换驱动。该等离子体的磁剪切 $s=0.8$，安全因子 $q=2.5$，大半径 $R_0=3$ m，环向磁场强度 $B=3$ T，径向压力梯度 $\\frac{dp}{dr}=-5\\times 10^{4}$ Pa/m。假设真空磁导率 $\\mu_0=4\\pi\\times 10^{-7}$ N/A$^2$，并在计算等离子体 beta 值的导数时忽略 $B$ 的任何径向变化。\n\n从理想 MHD 和 $s$–$\\alpha$ 模型适用的基本定义和经过充分检验的关系式出发，推导出一个用 $\\mu_0$、$R_0$、$q$、$B$ 和 $\\frac{dp}{dr}$ 表示的归一化压力梯度参数 $\\alpha$ 的表达式，然后计算其在给定参数下的值。将 $\\alpha$ 表示为一个无量纲量，并以精确解析表达式的形式给出最终结果（不进行四舍五入）。\n\n最后，根据计算出的 $\\alpha$ 和给定的磁剪切 $s$，定性评估该等离子体是否可能位于 $s$–$\\alpha$ 稳定性图中正剪切的第一气球模不稳定性边界之上，并解释您的理由。您的定性评估必须只出现在推导过程中；最终答案必须只包含 $\\alpha$ 的精确值，不含任何文字。",
            "solution": "该问题被验证为科学上可靠、定义明確、客观且自洽。所有提供的参数以及其理论基础，即理想磁流体动力学（MHD）气球模不稳定性的 $s$–$\\alpha$ 模型，都是聚变等离子体物理领域的标准内容。提供的数值对于托卡马克是物理上现实的。因此，该问题被认为是有效的，并将提供解答。\n\n主要任务是推导和计算归一化压力梯度参数 $\\alpha$ 的值。这个参数是 $s$–$\\alpha$ 模型中用于描述托卡马克中气球模不稳定性的核心组成部分。它量化了在磁场曲率不利区域中由等离子体压力梯度引起的不稳定性驱动。\n\n$\\alpha$ 的标准定义是根据等离子体 beta 值 $\\beta$ 的径向导数来构建的。等离子体 beta 值是等离子体压力与磁压力之比：\n$$ \\beta = \\frac{p}{p_{mag}} = \\frac{p}{B^2 / (2\\mu_0)} = \\frac{2\\mu_0 p}{B^2} $$\n其中 $p$ 是等离子体压力，$B$ 是磁场强度，$\\mu_0$ 是真空磁导率。\n\n气球模的驱动与压力梯度成正比。在 $s$–$\\alpha$ 形式中，这通过 beta 值的径向导数（记为 $\\beta'$）来表示。\n$$ \\beta' = \\frac{d\\beta}{dr} $$\n其中 $r$ 是小半径坐标。使用 $\\beta$ 的定义并应用微分的乘法法則，得到：\n$$ \\beta' = \\frac{d}{dr} \\left( \\frac{2\\mu_0 p}{B^2} \\right) = \\frac{2\\mu_0}{B^2} \\frac{dp}{dr} - \\frac{4\\mu_0 p}{B^3} \\frac{dB}{dr} $$\n问题陈述指明，在计算 beta 值的导数时，我们应忽略磁场 $B$ 的任何径向变化。这将 $\\frac{dB}{dr}=0$ 代入，从而极大地简化了 $\\beta'$ 的表达式：\n$$ \\beta' = \\frac{2\\mu_0}{B^2} \\frac{dp}{dr} $$\n归一化压力梯度参数 $\\alpha$ 在大环径比、圆形磁通面的极限下定义为：\n$$ \\alpha = -R_0 q^2 \\beta' $$\n此处，$R_0$ 是托卡马克的大半径，$q$ 是安全因子。负号是约定俗成的；由于约束的等离子体具有负的压力梯度（$\\frac{dp}{dr}  0$），$\\alpha$ 的值为正，表示不稳定性驱动的大小。\n\n将 $\\beta'$ 的表达式代入 $\\alpha$ 的定义中，我们得到所需的、用基本给定参数表示的 $\\alpha$ 表达式：\n$$ \\alpha = -R_0 q^2 \\left( \\frac{2\\mu_0}{B^2} \\frac{dp}{dr} \\right) = - \\frac{2 \\mu_0 R_0 q^2}{B^2} \\frac{dp}{dr} $$\n这个表达式是无量纲的，符合归一化参数的要求。\n\n现在，我们使用给定的数据计算 $\\alpha$ 的值：\n- 磁剪切，$s = 0.8$\n- 安全因子，$q = 2.5$\n- 大半径，$R_0 = 3$ m\n- 环向磁场强度，$B = 3$ T\n- 径向压力梯度，$\\frac{dp}{dr} = -5 \\times 10^{4}$ Pa/m\n- 真空磁导率，$\\mu_0 = 4\\pi \\times 10^{-7}$ N/A$^2$\n\n将这些值代入推导出的 $\\alpha$ 公式中：\n$$ \\alpha = - \\frac{2 (4\\pi \\times 10^{-7}) (3) (2.5)^2}{(3)^2} (-5 \\times 10^4) $$\n两个负号相消。我们来简化表达式：\n$$ \\alpha = \\frac{2 \\cdot (4\\pi \\times 10^{-7}) \\cdot 3 \\cdot (6.25)}{9} \\cdot (5 \\times 10^4) $$\n$$ \\alpha = \\frac{2 \\cdot 4\\pi \\cdot 3 \\cdot 6.25 \\cdot 5 \\cdot 10^{-7} \\cdot 10^4}{9} $$\n$$ \\alpha = \\frac{8\\pi \\cdot 3 \\cdot 6.25 \\cdot 5 \\cdot 10^{-3}}{9} $$\n分子中的因子 3 与分母中的一个因子 3 相消：\n$$ \\alpha = \\frac{8\\pi \\cdot 6.25 \\cdot 5 \\cdot 10^{-3}}{3} $$\n接下来，我们计算乘积 $8 \\times 6.25 \\times 5$:\n$$ 8 \\times 6.25 = 8 \\times \\frac{25}{4} = 2 \\times 25 = 50 $$\n$$ 50 \\times 5 = 250 $$\n所以表达式变为：\n$$ \\alpha = \\frac{250\\pi \\times 10^{-3}}{3} = \\frac{0.25\\pi}{3} $$\n将其写为一个简单分数：\n$$ \\alpha = \\frac{\\pi/4}{3} = \\frac{\\pi}{12} $$\n这是归一化压力梯度参数 $\\alpha$ 的精确解析值。\n\n最后，我们对气球模不稳定性进行定性评估。$s$–$\\alpha$ 稳定性图描绘了理想气球模的稳定区和不稳定区，它们是磁剪切 $s$ 和压力梯度参数 $\\alpha$ 的函数。对于正剪切（$s > 0$），存在一个低 $\\alpha$ 值的第一稳定区，一个中等 $\\alpha$ 值的不稳定区，以及可能存在于极大 $\\alpha$ 值的第二稳定区。第一稳定区和不稳定区之间的边界，被称为第一稳定性边界，是一条曲线 $\\alpha_c(s)$，它从原点 $(s=0, \\alpha=0)$ 开始并随 $s$ 增大而增加。对于中等剪切（$s \\approx 0.5 - 1.5$），关于此边界的一个常用经验法则是，当 $\\alpha$ 与 $s$ 量级相当时，会发生不稳定性。一个更精确的解析近似是，对于 $s \\lesssim 1.5$，$\\alpha_c(s) \\approx 0.6s$。\n给定的参数是 $s = 0.8$，计算出的值为 $\\alpha = \\frac{\\pi}{12} \\approx \\frac{3.14159}{12} \\approx 0.262$。\n让我们将我们计算的 $\\alpha$ 与在 $s=0.8$ 处的近似稳定性边界进行比较：\n$$ \\alpha_c(s=0.8) \\approx 0.6 \\times 0.8 = 0.48 $$\n由于我们计算的值 $\\alpha \\approx 0.262$ 远小于估计的临界值 $\\alpha_c \\approx 0.48$，等离子体的工作点 $(s, \\alpha) = (0.8, \\pi/12)$ 位于第一稳定区之内。由压力梯度引起的去稳定驱动不足以克服由磁力线弯曲产生的稳定效应，后者由磁剪切来量化。因此，定性评估认为该等离子体对于理想 MHD 气球模是稳定的。",
            "answer": "$$ \\boxed{\\frac{\\pi}{12}} $$"
        },
        {
            "introduction": "在将气球模的驱动力参数化为 $\\alpha$ 之后，下一步是理解它如何与稳定效应（如磁剪切 $s$）相抗衡。这种竞争关系被优美地封装在沿磁力线的一维气球模本征值方程中，其形式类似于量子力学中的薛定谔方程。通过对这个方程进行近似求解，您将揭示决定稳定性的 $s$ 和 $\\alpha$ 之间的基本关系。这个推导练习是气球模理论的基石，它将带您深入了解 $s-\\alpha$ 稳定性图的数学核心 。",
            "id": "4192728",
            "problem": "考虑一个大环径比、圆截面的托卡马克，在无穷大环向模数（气球模）极限下使用理想磁流体动力学（MHD）能量原理。沿单条磁力线，引入扩展极向角 $\\theta$ 和法向位移 $\\xi(\\theta)$ 的气球模表示，并将局域气球模本征值问题写成如下形式\n$$\n-\\,\\frac{d^{2}\\xi}{d\\theta^{2}} \\;+\\; \\Big[s^{2}\\,\\theta^{2}\\;-\\;\\alpha\\,\\cos\\theta\\Big]\\,\\xi \\;=\\; \\Lambda\\,\\xi,\n$$\n其中，$s$ 是磁剪切，$\\alpha$ 是归一化压力梯度参数（曲率驱动），$\\Lambda$ 是无量纲本征值，其符号决定稳定性。假设一个在等离子体外侧具有强气球模特性的模式，因此该模式局域在 $\\theta=0$ 附近，并对 $\\cos\\theta$ 在 $\\theta=0$ 附近取领头阶近似。使用一致的局域近似以及对相关类薛定谔算符最低本征值的变分估计，导出最低本征值 $\\Lambda(s,\\alpha)$ 关于 $s$ 和 $\\alpha$ 的领头阶闭式解析表达式。将最终答案表示为单个解析表达式。不需要进行数值近似或四舍五入，最终表达式中也不应包含任何单位。",
            "solution": "### 问题验证的逐步思考过程\n\n**第一步：提取已知条件**\n*   **系统：** 大环径比、圆截面托卡马克。\n*   **框架：** 理想磁流体动力学（MHD）能量原理，在无穷大环向模数（气球模）极限下。\n*   **坐标：** 扩展极向角 $\\theta$。\n*   **变量：** 法向位移 $\\xi(\\theta)$ 的气球模表示。\n*   **方程：** 局域气球模本征值问题：$-\\frac{d^{2}\\xi}{d\\theta^{2}} + \\Big[s^{2}\\,\\theta^{2} - \\alpha\\,\\cos\\theta\\Big]\\,\\xi = \\Lambda\\,\\xi$。\n*   **参数：**\n    *   $s$：磁剪切。\n    *   $\\alpha$：归一化压力梯度参数（曲率驱动）。\n    *   $\\Lambda$：无量纲本征值。\n*   **假设/条件：** 该模式在等离子体外侧具有强气球模特性，局域在 $\\theta=0$ 附近。\n*   **方法论：**\n    *   对 $\\cos\\theta$ 在 $\\theta=0$ 附近取领头阶近似。\n    *   使用一致的局域近似。\n    *   对最低本征值使用变分估计。\n*   **要求输出：** 最低本征值 $\\Lambda(s, \\alpha)$ 的领头阶闭式解析表达式。\n\n**第二步：使用提取的已知条件进行验证**\n*   **科学依据：** 该问题描述了强气球模极限下的标准理想MHD气球模方程。这是聚变等离子体稳定性理论中的一个典型问题。该方程是一个类薛定谔方程，参数 $s$ 和 $\\alpha$ 是托卡马克物理学中明确定义的物理量。整个框架与已建立的理论完全一致。这是有科学依据的。\n*   **适定性：** 该问题要求求解一个Sturm-Liouville型算符的最低本征值。势能项在近似后将是一个二次项加一个常数。这种结构通常会得到一个定义明确、唯一的最低本征值。该问题是适定的。\n*   **客观性：** 语言技术性强、精确，没有主观论断。问题陈述客观。\n*   **完整性：** 问题提供了控制方程、相关参数、关键假设（强气球模、在 $\\theta=0$ 处局域化），以及所需方法（泰勒近似、变分估计）。这些信息足以进行求解。问题是自洽的。\n*   **现实性/可行性：** 所要求的近似是文献中分析此问题的标准方法。参数是符号性的，因此不存在数值上的量纲或物理不一致问题。在理论模型内，该设置是现实的。\n*   **结构：** 问题结构清晰，要求进行具体推导。它不是不适定或含糊不清的。\n*   **琐碎性/伪深刻性：** 这是等离子体理论中一个标准但非平凡的计算。它需要应用近似、微分方程和变分方法的知识。它既不伪深刻也不琐碎。\n*   **可验证性：** 推导过程是一个可以检查其正确性的数学过程。结果可以与该领域的既有结果进行比较。\n\n**第三步：结论与行动**\n该问题是**有效的**。它是理论等离子体物理学中一个标准的、适定的问题。我将着手解决它。\n\n### 求解的逐步思考过程\n\n1.  **从控制方程开始：**\n    $$\n    -\\,\\frac{d^{2}\\xi}{d\\theta^{2}} \\;+\\; V(\\theta)\\,\\xi \\;=\\; \\Lambda\\,\\xi\n    $$\n    其中势为 $V(\\theta) = s^{2}\\,\\theta^{2}\\;-\\;\\alpha\\,\\cos\\theta$。\n\n2.  **应用强气球模近似：**\n    该模式局域在 $\\theta=0$ 附近。这为在小 $\\theta$ 下近似势 $V(\\theta)$ 提供了依据。$\\cos\\theta$ 在 $\\theta=0$ 附近的泰勒级数是：\n    $$\n    \\cos\\theta = 1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\n    $$\n    问题要求*领头阶*近似。这意味着我们应该在势中保留到 $\\mathcal{O}(\\theta^2)$ 的项。\n    $$\n    \\cos\\theta \\approx 1 - \\frac{\\theta^2}{2}\n    $$\n    将此代入势 $V(\\theta)$：\n    $$\n    V(\\theta) \\approx s^{2}\\,\\theta^{2} - \\alpha \\left(1 - \\frac{\\theta^2}{2}\\right) = s^2\\,\\theta^2 - \\alpha + \\frac{\\alpha}{2}\\theta^2 = \\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha\n    $$\n\n3.  **重写近似的本征值问题：**\n    将近似的势代回原方程：\n    $$\n    -\\,\\frac{d^{2}\\xi}{d\\theta^{2}} \\;+\\; \\left[\\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha\\right]\\xi \\;=\\; \\Lambda\\,\\xi\n    $$\n    这是一个带有谐振子势和一个常数位移的类薛定谔方程。\n\n4.  **按要求使用变分法：**\n    问题要求对最低本征值 $\\Lambda_0$ 进行变分估计。根据瑞利-里兹原理，基态本征值是哈密顿量期望值的最小值。需要最小化的泛函是：\n    $$\n    \\Lambda[\\xi] = \\frac{\\langle \\xi | H | \\xi \\rangle}{\\langle \\xi | \\xi \\rangle} = \\frac{\\int_{-\\infty}^{\\infty} \\xi^{*} \\left( -\\frac{d^{2}}{d\\theta^{2}} + V_{approx}(\\theta) \\right) \\xi \\, d\\theta}{\\int_{-\\infty}^{\\infty} |\\xi|^2 \\, d\\theta}\n    $$\n    其中积分区域扩展到 $(-\\infty, \\infty)$，因为模式是强局域化的。\n    近似问题的哈密顿算符是 $H = -\\frac{d^2}{d\\theta^2} + \\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha$。\n    势是谐振子势，所以精确的基态本征函数是高斯函数。我们选择一个高斯变分试探函数，对于这个近似的哈密顿量，它保证能给出精确的最低本征值。设试探函数为：\n    $$\n    \\xi_t(\\theta) = \\exp\\left(-\\frac{a \\theta^2}{2}\\right)\n    $$\n    其中 $a  0$ 是一个变分参数，代表模式宽度的平方的倒数。\n\n5.  **计算变分泛函中的各项。**\n    首先，归一化积分（分母）：\n    $$\n    \\langle \\xi_t | \\xi_t \\rangle = \\int_{-\\infty}^{\\infty} \\exp(-a\\theta^2) \\, d\\theta = \\sqrt{\\frac{\\pi}{a}}\n    $$\n    接下来是分子 $\\langle \\xi_t | H | \\xi_t \\rangle$。我们可以将其分为动能和势能两部分。\n    动能项：\n    $$\n    T = \\int_{-\\infty}^{\\infty} \\xi_t^* \\left(-\\frac{d^2}{d\\theta^2}\\right) \\xi_t \\, d\\theta\n    $$\n    通过分部积分，这变成：\n    $$\n    T = \\int_{-\\infty}^{\\infty} \\left| \\frac{d\\xi_t}{d\\theta} \\right|^2 \\, d\\theta\n    $$\n    其导数为 $\\frac{d\\xi_t}{d\\theta} = -a\\theta \\exp(-\\frac{a \\theta^2}{2})$。所以，\n    $$\n    T = \\int_{-\\infty}^{\\infty} a^2 \\theta^2 \\exp(-a\\theta^2) \\, d\\theta\n    $$\n    使用标准积分 $\\int_{-\\infty}^{\\infty} x^2 e^{-bx^2} dx = \\frac{1}{2b}\\sqrt{\\frac{\\pi}{b}}$，我们得到：\n    $$\n    T = a^2 \\left( \\frac{1}{2a} \\sqrt{\\frac{\\pi}{a}} \\right) = \\frac{a}{2} \\sqrt{\\frac{\\pi}{a}}\n    $$\n    势能项：\n    $$\n    U = \\int_{-\\infty}^{\\infty} |\\xi_t|^2 V_{approx}(\\theta) \\, d\\theta = \\int_{-\\infty}^{\\infty} \\exp(-a\\theta^2) \\left[ \\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha \\right] \\, d\\theta\n    $$\n    $$\n    U = \\left(s^2 + \\frac{\\alpha}{2}\\right) \\int_{-\\infty}^{\\infty} \\theta^2 \\exp(-a\\theta^2) \\, d\\theta - \\alpha \\int_{-\\infty}^{\\infty} \\exp(-a\\theta^2) \\, d\\theta\n    $$\n    使用前面引用的积分：\n    $$\n    U = \\left(s^2 + \\frac{\\alpha}{2}\\right) \\left( \\frac{1}{2a} \\sqrt{\\frac{\\pi}{a}} \\right) - \\alpha \\sqrt{\\frac{\\pi}{a}}\n    $$\n    本征值的变分估计是 $\\Lambda_E(a)$：\n    $$\n    \\Lambda_E(a) = \\frac{T+U}{\\langle \\xi_t | \\xi_t \\rangle} = \\frac{\\frac{a}{2} \\sqrt{\\frac{\\pi}{a}} + \\frac{1}{2a}(s^2 + \\frac{\\alpha}{2}) \\sqrt{\\frac{\\pi}{a}} - \\alpha \\sqrt{\\frac{\\pi}{a}}}{\\sqrt{\\frac{\\pi}{a}}}\n    $$\n    $$\n    \\Lambda_E(a) = \\frac{a}{2} + \\frac{1}{2a}\\left(s^2 + \\frac{\\alpha}{2}\\right) - \\alpha\n    $$\n\n6.  **最小化变分泛函。**\n    为了找到最低本征值的最佳估计，我们必须使 $\\Lambda_E(a)$ 相对于变分参数 $a$ 最小化。我们计算其导数并令其为零：\n    $$\n    \\frac{d\\Lambda_E}{da} = \\frac{1}{2} - \\frac{1}{2a^2}\\left(s^2 + \\frac{\\alpha}{2}\\right) = 0\n    $$\n    求解 $a$：\n    $$\n    \\frac{1}{2} = \\frac{1}{2a^2}\\left(s^2 + \\frac{\\alpha}{2}\\right) \\implies a^2 = s^2 + \\frac{\\alpha}{2}\n    $$\n    参数 $a$ 的最优值，我们记为 $a_{opt}$，是：\n    $$\n    a_{opt} = \\sqrt{s^2 + \\frac{\\alpha}{2}}\n    $$\n    为了使束缚态存在，势必须是束缚势，这要求 $s^2 + \\frac{\\alpha}{2} > 0$。我们假设此条件成立。\n\n7.  **计算最低本征值。**\n    最低本征值 $\\Lambda_0$ 是 $\\Lambda_E(a)$ 在 $a = a_{opt}$ 处的值。\n    $$\n    \\Lambda_0 = \\Lambda_E(a_{opt}) = \\frac{a_{opt}}{2} + \\frac{1}{2a_{opt}}\\left(s^2 + \\frac{\\alpha}{2}\\right) - \\alpha\n    $$\n    将 $s^2 + \\frac{\\alpha}{2} = a_{opt}^2$ 代入表达式：\n    $$\n    \\Lambda_0 = \\frac{a_{opt}}{2} + \\frac{a_{opt}^2}{2a_{opt}} - \\alpha = \\frac{a_{opt}}{2} + \\frac{a_{opt}}{2} - \\alpha = a_{opt} - \\alpha\n    $$\n    最后，代入 $a_{opt}$ 的表达式：\n    $$\n    \\Lambda_0(s, \\alpha) = \\sqrt{s^2 + \\frac{\\alpha}{2}} - \\alpha\n    $$\n该表达式表示在强气球模近似下，气球模方程最低本征值的领头阶解析结果。$\\Lambda_0$ 的符号决定稳定性：$\\Lambda_0  0$ 意味着不稳定性。稳定性边界由 $\\Lambda_0 = 0$ 给出，这导致条件 $\\sqrt{s^2 + \\frac{\\alpha}{2}} = \\alpha$，或 $s^2 + \\frac{\\alpha}{2} = \\alpha^2$，该式可以重新整理以形成著名的理想气球模的 $s$-$\\alpha$ 稳定图。",
            "answer": "$$\n\\boxed{\\sqrt{s^{2} + \\frac{\\alpha}{2}} - \\alpha}\n$$"
        },
        {
            "introduction": "虽然解析模型为我们提供了深刻的物理洞察，但对真实等离子体的稳定性分析通常离不开强大的数值工具。谱方法是一种通过将解表示为一组基函数的和来求解微分方程的高精度技术。这个计算实践将指导您为前一个练习中分析过的气球模方程实现一个数值求解器。通过将您的数值结果与精确解进行比较，您不仅能锻炼实际的编程技能，还能更深入地理解解析理论与计算物理之间的相互作用 。",
            "id": "4192684",
            "problem": "你的任务是使用 Hermite 函数实现一种谱方法，以求解理想磁流体动力学（MHD）气球模本征值方程的一个简化抛物近似，并测试计算出的基态本征值随基底大小变化的收敛性。推导必须从理想 MHD 能量原理和局域 $s$-$\\alpha$ 模型开始，该模型描述了磁剪切与压力梯度驱动的曲率之间的竞争关系。在向外的中平面附近（极向角 $\\theta = 0$，以弧度为单位），沿磁力线的局域气球模本征值问题，在抛物近似下，可以写成在无穷域 $\\theta \\in \\mathbb{R}$ 上的一个一维 Sturm–Liouville 算子，且在无穷远处衰减：\n$$\n\\mathcal{L} \\phi(\\theta) \\equiv -\\frac{d^2 \\phi}{d \\theta^2} + \\left( \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 - \\alpha \\right) \\phi(\\theta) = \\lambda \\, \\phi(\\theta),\n$$\n其中 $s$ 是磁剪切（无量纲），$\\alpha$ 是归一化压力梯度参数（无量纲），$\\phi(\\theta)$ 是气球模本征函数包络，$\\lambda$ 是本征值（无量纲）。边界条件是当 $|\\theta| \\to \\infty$ 时 $\\phi(\\theta) \\to 0$。\n\n你必须用 $\\mathbb{R}$ 上的标准正交 Hermite 函数基 $\\{\\varphi_n(\\theta)\\}_{n=0}^{N-1}$ 中的谱展开来离散化 $\\mathcal{L}$，其中\n$$\n\\varphi_n(\\theta) = \\frac{1}{\\sqrt{2^n n! \\sqrt{\\pi}}} \\, e^{-\\theta^2/2} H_n(\\theta),\n$$\n且 $H_n(\\theta)$ 是物理学家 Hermite 多项式。使用标准的 $L^2(\\mathbb{R})$ 内积。在此大小为 $N$ 的基中构建 $\\mathcal{L}$ 的截断矩阵表示，并计算其最低本征值 $\\lambda_0^{(N)}$。然后，通过增加 $N$ 并将 $\\lambda_0^{(N)}$ 与抛物模型的精确基态本征值（该值可从第一性原理和算子重标度推导得出，将在你的解法中推导）进行比较，来测试收敛性。报告每个 $N$ 对应的绝对误差 $|\\lambda_0^{(N)} - \\lambda_0|$。\n\n角度必须以弧度为单位。所有输出均为无量纲。将所有报告的误差四舍五入到 $10$ 位小数。\n\n实现一个完整的、可运行的程序，该程序：\n- 对于给定的 $(s,\\alpha)$ 和基底大小 $N$，使用 Hermite 函数构建 $\\mathcal{L}$ 的谱矩阵。\n- 对每个 $N$ 数值计算最低本征值。\n- 计算并返回相对于抛物模型精确基态本征值的绝对误差。\n- 将一系列参数集和基底大小的测试套件结果汇总为指定的输出格式。\n\n测试套件规范：\n- 使用以下参数集 $(s,\\alpha)$，每个参数集都在基底大小 $N \\in \\{4,8,16,32\\}$ 下进行测试：\n    1. $(s,\\alpha) = (1.0,\\,0.5)$：一个通用的“理想路径”情况。\n    2. $(s,\\alpha) = (0.5,\\,2.5)$：一个基态本征值为负的情况。\n    3. $(s,\\alpha) = (2.8,\\,0.4)$：一个有效曲率较大的情况。\n    4. $(s,\\alpha) = (0.1,\\,0.1)$：一个近临界曲率的情况。\n    5. $(s,\\alpha) = (0.9,\\,0.38)$：一个有效振荡器频率与单位 Hermite 基标度相匹配的边界情况。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，每个内部列表对应一个参数集，并包含 $N=4,8,16,32$ 的四个绝对误差（四舍五入到 10 位小数），不含空格，例如：\n$$\n[\\,[e_{1,4},e_{1,8},e_{1,16},e_{1,32}],\\,[e_{2,4},e_{2,8},e_{2,16},e_{2,32}],\\,[e_{3,4},e_{3,8},e_{3,16},e_{3,32}],\\,[e_{4,4},e_{4,8},e_{4,16},e_{4,32}],\\,[e_{5,4},e_{5,8},e_{5,16},e_{5,32}]\\,]\n$$\n其中每个 $e_{i,N}$ 是一个浮点数，表示第 $i$ 个参数集在基底大小为 $N$ 时的绝对误差。",
            "solution": "该问题要求解一个一维 Sturm–Liouville 本征值问题，这是理想磁流体动力学（MHD）气球模方程的抛物近似。该方程在无穷域 $\\theta \\in \\mathbb{R}$ 上给出为：\n$$\n\\mathcal{L} \\phi(\\theta) \\equiv -\\frac{d^2 \\phi}{d \\theta^2} + \\left( \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 - \\alpha \\right) \\phi(\\theta) = \\lambda \\, \\phi(\\theta)\n$$\n边界条件为当 $|\\theta| \\to \\infty$ 时 $\\phi(\\theta) \\to 0$。这里，$s$ 是磁剪切，$\\alpha$ 是归一化压力梯度参数，$\\phi$ 是本征函数，$\\lambda$ 是本征值。我们需要使用带有 Hermite 函数的谱方法对该问题进行数值求解，并将数值计算的基态本征值与精确的解析解进行比较。\n\n首先，我们推导精确的基态本征值 $\\lambda_0$。给定方程可以重新整理为：\n$$\n\\left[ -\\frac{d^2}{d \\theta^2} + \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 \\right] \\phi(\\theta) = (\\lambda + \\alpha) \\phi(\\theta)\n$$\n这是量子谐振子（QHO）的 Schrödinger 方程的一种形式。对于质量为 $m$、角频率为 $\\omega$ 的粒子（设 $\\hbar = 1$），标准的 QHO 本征值方程是 $\\left(-\\frac{1}{2m}\\frac{d^2}{dx^2} + \\frac{1}{2}m\\omega^2 x^2\\right)\\psi = E \\psi$，其本征值为 $E_\\nu = (\\nu + 1/2)\\omega$，其中 $\\nu = 0, 1, 2, \\dots$。我们的方程形式为 $\\left(-\\frac{d^2}{d\\theta^2} + K \\theta^2\\right)\\phi = E' \\phi$，其中 $K = s^2 + \\frac{\\alpha}{2}$ 且 $E' = \\lambda + \\alpha$。该算子对应于一个 $m=1/2$ 且 $\\omega = \\sqrt{2K}$ 的 QHO。算子 $-\\frac{d^2}{d\\theta^2} + K\\theta^2$ 的本征值为 $(2\\nu+1)\\sqrt{K}$。因此，我们必须有：\n$$\n\\lambda_\\nu + \\alpha = (2\\nu+1)\\sqrt{s^2 + \\frac{\\alpha}{2}}\n$$\n因此，算子 $\\mathcal{L}$ 的本征值 $\\lambda_\\nu$ 为：\n$$\n\\lambda_\\nu = (2\\nu+1)\\sqrt{s^2 + \\frac{\\alpha}{2}} - \\alpha\n$$\n基态对应于 $\\nu=0$，从而得出精确的基态本征值：\n$$\n\\lambda_0 = \\sqrt{s^2 + \\frac{\\alpha}{2}} - \\alpha\n$$\n这个解析结果将作为我们数值解的基准。\n\n接下来，我们构建谱方法。我们将未知本征函数 $\\phi(\\theta)$ 在一个截断的标准正交 Hermite 函数基 $\\{\\varphi_n(\\theta)\\}_{n=0}^{N-1}$ 中展开：\n$$ \\phi(\\theta) \\approx \\sum_{n=0}^{N-1} c_n \\varphi_n(\\theta) $$\n其中 $\\varphi_n(\\theta) = \\frac{1}{\\sqrt{2^n n! \\sqrt{\\pi}}} e^{-\\theta^2/2} H_n(\\theta)$。将此展开式代入本征值方程，并取内积 $\\langle \\varphi_m, \\cdot \\rangle = \\int_{-\\infty}^\\infty \\varphi_m(\\theta) (\\cdot) d\\theta$，得到一个矩阵本征值问题 $L \\mathbf{c} = \\lambda \\mathbf{c}$，其中 $\\mathbf{c} = [c_0, c_1, \\dots, c_{N-1}]^T$，而 $L$ 是一个 $N \\times N$ 矩阵，其元素为 $L_{mn} = \\langle \\varphi_m, \\mathcal{L} \\varphi_n \\rangle$。\n矩阵元素为：\n$$\nL_{mn} = \\int_{-\\infty}^{\\infty} \\varphi_m(\\theta) \\left[ -\\frac{d^2}{d \\theta^2} + \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 - \\alpha \\right] \\varphi_n(\\theta) \\, d\\theta\n$$\n我们可以在 Hermite 基中计算算子 $-\\frac{d^2}{d\\theta^2}$ 和 $\\theta^2$ 的矩阵元素。这些基函数是标准 QHO 哈密顿量 $H_{QHO} = -\\frac{1}{2}\\frac{d^2}{d\\theta^2} + \\frac{1}{2}\\theta^2$ 的本征函数，满足 $H_{QHO} \\varphi_n = (n+1/2)\\varphi_n$。这意味着 $\\left(-\\frac{d^2}{d\\theta^2} + \\theta^2\\right)\\varphi_n = (2n+1)\\varphi_n$。利用此恒等式和标准正交关系 $\\langle \\varphi_m, \\varphi_n \\rangle = \\delta_{mn}$，我们可以求出各算子的矩阵元素。一个更直接的方法是使用升降算子 $a$ 和 $a^\\dag$，定义为 $\\theta = \\frac{1}{\\sqrt{2}}(a+a^\\dag)$ 和 $\\frac{d}{d\\theta} = \\frac{1}{\\sqrt{2}}(a^\\dag-a)$。它们对基态的作用是 $a\\varphi_n = \\sqrt{n}\\varphi_{n-1}$ 和 $a^\\dag\\varphi_n = \\sqrt{n+1}\\varphi_{n+1}$。\n$\\theta^2$ 的矩阵元素可求得为：\n$$\n\\langle \\varphi_m, \\theta^2 \\varphi_n \\rangle = \\frac{1}{2} \\left[ (2n+1)\\delta_{mn} + \\sqrt{n(n-1)}\\delta_{m,n-2} + \\sqrt{(n+1)(n+2)}\\delta_{m,n+2} \\right]\n$$\n对于动能算子：\n$$\n\\left\\langle \\varphi_m, -\\frac{d^2}{d\\theta^2} \\varphi_n \\right\\rangle = \\frac{1}{2} \\left[ (2n+1)\\delta_{mn} - \\sqrt{n(n-1)}\\delta_{m,n-2} - \\sqrt{(n+1)(n+2)}\\delta_{m,n+2} \\right]\n$$\n将这些组合起来形成 $L_{mn}$，其中 $K = s^2 + \\alpha/2$：\n$$\nL_{mn} = \\left\\langle \\varphi_m, -\\frac{d^2}{d\\theta^2} \\varphi_n \\right\\rangle + K \\langle \\varphi_m, \\theta^2 \\varphi_n \\rangle - \\alpha \\langle \\varphi_m, \\varphi_n \\rangle\n$$\n代入表达式并化简，得到对称矩阵 $L$ 的非零元素：\n$$\nL_{nn} = \\frac{1+K}{2}(2n+1) - \\alpha\n$$\n$$\nL_{n,n+2} = L_{n+2,n} = \\frac{K-1}{2}\\sqrt{(n+1)(n+2)}\n$$\n算子 $\\mathcal{L}$ 保持宇称，因此它不会耦合不同宇称的基函数（即偶数 $n$ 与奇数 $n$）。这导致矩阵 $L$ 成为块对角矩阵，一个块对应偶数索引，另一个块对应奇数索引。基态本征函数具有偶宇称，因此其本征值将是偶数索引子矩阵的最低本征值。在数值上，我们可以构建完整的 $N \\times N$ 矩阵并找到其最低本征值 $\\lambda_0^{(N)}$。\n\n数值计算步骤如下：\n1. 对于每个参数集 $(s, \\alpha)$ 和基底大小 $N$，计算 $K = s^2 + \\alpha/2$。\n2. 使用 $L_{nn}$ 和 $L_{n,n+2}$ 的公式构建 $N \\times N$ 对称矩阵 $L$。\n3. 使用针对对称矩阵的标准数值库函数计算 $L$ 的所有实本征值。\n4. 这些本征值中的最小值即为基态本征值的数值近似值 $\\lambda_0^{(N)}$。\n5. 计算精确本征值 $\\lambda_0 = \\sqrt{K} - \\alpha$。\n6. 绝对误差计算为 $|\\lambda_0^{(N)} - \\lambda_0|$。\n对于 $K=1$ 的特殊情况，非对角项消失，使 $L$ 成为一个对角矩阵。基函数 $\\varphi_n$ 是 $\\mathcal{L}$ 的精确本征函数，本征值就是对角元素 $L_{nn}$。在这种情况下，数值结果是精确的，误差在机器精度范围内为零。这在情况 5 中进行了测试。对于其他情况，预期会收敛，即随着基底大小 $N$ 的增加，误差会减小。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_spectral_matrix(s, alpha, N):\n    \"\"\"\n    Builds the spectral matrix for the ballooning eigenvalue problem.\n\n    Args:\n        s (float): Magnetic shear parameter.\n        alpha (float): Normalized pressure gradient parameter.\n        N (int): Basis size (number of Hermite functions).\n\n    Returns:\n        numpy.ndarray: The N x N spectral matrix L.\n    \"\"\"\n    L = np.zeros((N, N))\n    \n    # K is the coefficient of the quadratic potential term\n    K = s**2 + alpha / 2.0\n    \n    # Diagonal elements L_nn\n    # L_nn = 0.5 * (1 + K) * (2n + 1) - alpha\n    n_vals = np.arange(N)\n    diagonal_vals = 0.5 * (1 + K) * (2 * n_vals + 1) - alpha\n    np.fill_diagonal(L, diagonal_vals)\n\n    # Off-diagonal elements L_{n, n+2} and L_{n+2, n}\n    # L_{n,n+2} = 0.5 * (K - 1) * sqrt((n+1)(n+2))\n    if N  2:\n        off_diag_coeff = 0.5 * (K - 1)\n        if off_diag_coeff != 0: # Avoid unnecessary computation if K=1\n            for n in range(N - 2):\n                val = off_diag_coeff * np.sqrt((n + 1.0) * (n + 2.0))\n                L[n, n + 2] = val\n                L[n + 2, n] = val\n            \n    return L\n\ndef solve():\n    \"\"\"\n    Executes the main logic to solve the problem for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_params = [\n        (1.0, 0.5),   # 1. general case\n        (0.5, 2.5),   # 2. negative eigenvalue case\n        (2.8, 0.4),   # 3. large effective curvature\n        (0.1, 0.1),   # 4. near-marginal curvature\n        (0.9, 0.38),  # 5. s^2+alpha/2 = 1 case\n    ]\n    basis_sizes = [4, 8, 16, 32]\n\n    all_results = []\n    \n    for s, alpha in test_params:\n        case_errors = []\n        \n        # Calculate the exact ground-state eigenvalue\n        lambda_exact = np.sqrt(s**2 + alpha / 2.0) - alpha\n        \n        for N in basis_sizes:\n            # Build the spectral matrix L\n            L = build_spectral_matrix(s, alpha, N)\n            \n            # Compute eigenvalues of the symmetric matrix L.\n            # eigvalsh is efficient for real symmetric matrices.\n            eigenvalues = np.linalg.eigvalsh(L)\n            \n            # The lowest eigenvalue is the numerical ground-state eigenvalue.\n            lambda_numeric = np.min(eigenvalues)\n            \n            # Calculate and store the absolute error, rounded to 10 decimal places.\n            error = np.abs(lambda_numeric - lambda_exact)\n            case_errors.append(round(error, 10))\n            \n        all_results.append(case_errors)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, with no spaces.\n    # str() of a list of lists gives almost the right format, just with spaces.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}