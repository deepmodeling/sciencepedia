{
    "hands_on_practices": [
        {
            "introduction": "The primary source of free energy for the Trapped Electron Mode (TEM) instability is the spatial gradient in the plasma's density and temperature profiles. This exercise provides a concrete link between a physical scenario—modifying the density profile through fueling—and the fundamental parameter that quantifies this drive: the electron diamagnetic frequency, $\\omega_{*e}$. By calculating $\\omega_{*e}$ under different density gradient conditions, you will develop a quantitative understanding of how profile shaping directly impacts the strength of the TEM instability drive. ",
            "id": "4207235",
            "problem": "Consider a large-aspect-ratio tokamak with magnetic field magnitude $B$, minor radius $a$, and an electron population with radially uniform electron temperature $T_e$ (i.e., $dT_e/dr \\approx 0$). Assume the magnetic field is approximately straight and uniform locally (valid in the ballooning representation for microinstabilities), and the density gradient is the dominant source of free energy for the Trapped Electron Mode (TEM) instability. Let the binormal wavenumber be $k_y$ (perpendicular to the magnetic field and aligned with the electron diamagnetic drift direction). The electron density gradient scale length $L_n$ is defined by $L_n \\equiv -\\left(d\\ln n_e/dr\\right)^{-1}$, so that a larger $a/L_n$ indicates stronger density peaking.\n\nFrom first principles, use the guiding-center drift and pressure balance to relate the electron diamagnetic drift frequency $\\omega_{*e}$ to the density gradient, and then compute and interpret how $\\omega_{*e}$ changes under two fueling scenarios:\n- Scenario F (flattening via core fueling): $a/L_n = 0.5$,\n- Scenario P (density peaking): $a/L_n = 2.0$.\n\nAll other parameters are held fixed with $B = 3\\,\\mathrm{T}$, $a = 0.6\\,\\mathrm{m}$, $T_e = 2.5\\,\\mathrm{keV}$, and $k_y = 40\\,\\mathrm{m}^{-1}$. Treat the density-gradient contribution to the diamagnetic drift frequency and neglect temperature-gradient effects. You may assume $p_e \\simeq n_e T_e$ and the local coordinate system with $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$ and $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$, so that $\\mathbf{B} \\times \\nabla p_e$ points along $\\hat{\\mathbf{y}}$.\n\nBased on a derivation from these assumptions and definitions, choose the option that correctly gives both the numerical values of $\\omega_{*e}$ for Scenario F and Scenario P and the physical prediction for how the TEM drive responds to going from Scenario F to Scenario P.\n\nA. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx -1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$; the increased magnitude in Scenario P strengthens the TEM drive (more electron-diamagnetic propagation and greater free-energy injection).\n\nB. $\\omega_{*e}(F) \\approx +2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx +1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$; the sign reversal to positive implies weakened TEM drive in Scenario P because the mode no longer propagates in the electron-diamagnetic direction.\n\nC. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{2}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx -1.11 \\times 10^{3}\\,\\mathrm{s}^{-1}$; density peaking reduces the TEM drive because the lower frequencies lessen resonance with trapped electrons.\n\nD. $\\omega_{*e}(F) \\approx -1.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx -6.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$; fueling mainly modifies the ion diamagnetic frequency $\\omega_{*i}$, so the TEM drive is insensitive to the change from Scenario F to Scenario P.",
            "solution": "The user has requested a critical validation of the problem statement, followed by a first-principles derivation of the solution and an evaluation of the provided options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem statement provides the following information:\n-   **System**: A large-aspect-ratio tokamak.\n-   **Magnetic Field**: Magnitude $B$, locally approximated as straight and uniform, $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$.\n-   **Geometry**: Minor radius $a$.\n-   **Electron Population**:\n    -   Radially uniform electron temperature $T_e$, implying $dT_e/dr \\approx 0$.\n    -   Electron density $n_e$.\n    -   Electron pressure $p_e \\simeq n_e T_e$.\n    -   Pressure gradient $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$.\n-   **Instability**: Trapped Electron Mode (TEM), with the density gradient as the dominant source of free energy.\n-   **Definitions**:\n    -   Density gradient scale length: $L_n \\equiv -\\left(d\\ln n_e/dr\\right)^{-1}$.\n    -   Binormal wavenumber: $k_y$, perpendicular to $\\mathbf{B}$ and aligned with the electron diamagnetic drift direction.\n    -   Coordinate system implication: $\\mathbf{B} \\times \\nabla p_e$ points along $\\hat{\\mathbf{y}}$.\n-   **Scenarios**:\n    -   Scenario F (flattening): $a/L_n = 0.5$.\n    -   Scenario P (peaking): $a/L_n = 2.0$.\n-   **Numerical Values**:\n    -   $B = 3\\,\\mathrm{T}$.\n    -   $a = 0.6\\,\\mathrm{m}$.\n    -   $T_e = 2.5\\,\\mathrm{keV}$.\n    -   $k_y = 40\\,\\mathrm{m}^{-1}$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the established criteria:\n\n-   **Scientifically Grounded**: The problem is based on fundamental concepts of plasma physics, specifically the theory of drift-wave instabilities like the Trapped Electron Mode (TEM) in tokamak plasmas. The local slab approximation and the definitions of diamagnetic frequency and gradient scale length are standard in the field. The setup is scientifically sound.\n-   **Well-Posed**: The problem provides all necessary parameters and definitions to derive a unique numerical answer for the electron diamagnetic frequency $\\omega_{*e}$ under the specified conditions.\n-   **Objective**: The problem is stated using precise, quantitative language.\n-   **Potential Ambiguity Analysis**: There is a potential for confusion regarding the sign of the wavenumber $k_y$. Let us analyze this rigorously.\n    1.  The local coordinate system is defined by $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$ and $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$. For a typical tokamak profile with pressure decreasing outwards, $\\frac{dp_e}{dr}  0$, so we can write $\\nabla p_e = (\\frac{dp_e}{dr})\\hat{\\mathbf{x}}$.\n    2.  The vector $\\mathbf{B} \\times \\nabla p_e$ is calculated as $B\\hat{\\mathbf{z}} \\times (\\frac{dp_e}{dr})\\hat{\\mathbf{x}} = B\\frac{dp_e}{dr}(\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = B\\frac{dp_e}{dr}\\hat{\\mathbf{y}}$. Since $\\frac{dp_e}{dr}  0$, this vector points in the $-\\hat{\\mathbf{y}}$ direction.\n    3.  The problem states that \"$\\mathbf{B} \\times \\nabla p_e$ points along $\\hat{\\mathbf{y}}$\". This implies that the local coordinate system is set up such that $dp_e/dr  0$, or that the $\\hat{\\mathbf{x}}$ axis points inwards. This is a non-standard choice but is mathematically consistent. We will proceed with the explicit problem statement: $\\mathbf{B} \\times \\nabla p_e$ is in the $+\\hat{\\mathbf{y}}$ direction.\n    4.  The electron diamagnetic drift velocity is $\\mathbf{v}_{*e} = \\frac{\\mathbf{B} \\times \\nabla p_e}{q_e n_e B^2}$. With the electron charge $q_e = -e$, we have $\\mathbf{v}_{*e} = -\\frac{\\mathbf{B} \\times \\nabla p_e}{e n_e B^2}$.\n    5.  Since $\\mathbf{B} \\times \\nabla p_e$ is in the $+\\hat{\\mathbf{y}}$ direction, the electron diamagnetic drift velocity $\\mathbf{v}_{*e}$ is in the $-\\hat{\\mathbf{y}}$ direction. This is the \"electron diamagnetic drift direction\".\n    6.  The problem states that the binormal wavenumber $k_y$ is \"aligned with the electron diamagnetic drift direction\". This means the wavevector $\\mathbf{k}_{\\perp}$ points in the $-\\hat{\\mathbf{y}}$ direction.\n    7.  The symbol $k_y$ denotes the component of the wavevector in the $\\hat{\\mathbf{y}}$ direction. Therefore, $k_y$ must be negative. The given value $k_y = 40\\,\\mathrm{m}^{-1}$ must be interpreted as the magnitude of the wavenumber, $|k_y|$. Thus, for our calculation, we must use $k_y = -40\\,\\mathrm{m}^{-1}$.\n\nThis careful reading resolves the potential contradiction. The problem is not flawed but requires meticulous application of the provided definitions.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid, self-consistent, and well-posed, provided the definitions are interpreted with sufficient rigor. We may proceed to the solution.\n\n### Derivation of the Solution\n\nThe electron diamagnetic drift frequency, $\\omega_{*e}$, is a fundamental quantity characterizing drift waves. It is derived from the electron diamagnetic drift. The general expression for the diamagnetic frequency for a species $\\alpha$ is:\n$$ \\omega_{*\\alpha} = \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{*\\alpha} $$\nwhere $\\mathbf{k}_{\\perp}$ is the wavevector perpendicular to the magnetic field and $\\mathbf{v}_{*\\alpha}$ is the diamagnetic drift velocity for species $\\alpha$. In the specified coordinate system, $\\mathbf{k}_{\\perp} = k_y \\hat{\\mathbf{y}}$.\n\nThe electron diamagnetic drift velocity $\\mathbf{v}_{*e}$ is given by:\n$$ \\mathbf{v}_{*e} = \\frac{\\mathbf{B} \\times \\nabla p_e}{q_e n_e B^2} = -\\frac{\\mathbf{B} \\times \\nabla p_e}{e n_e B^2} $$\nThe problem states that $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$ and $\\mathbf{B} \\parallel \\hat{\\mathbf{z}}$. Let $\\nabla p_e = \\frac{dp_e}{dr}\\hat{\\mathbf{x}}$.\n$$ \\mathbf{B} \\times \\nabla p_e = (B\\hat{\\mathbf{z}}) \\times \\left(\\frac{dp_e}{dr}\\hat{\\mathbf{x}}\\right) = B\\frac{dp_e}{dr}\\hat{\\mathbf{y}} $$\nThus, the drift velocity is:\n$$ \\mathbf{v}_{*e} = -\\frac{B(dp_e/dr)\\hat{\\mathbf{y}}}{e n_e B^2} = -\\frac{1}{e n_e B}\\frac{dp_e}{dr}\\hat{\\mathbf{y}} $$\nThe problem states $T_e$ is uniform, so $\\nabla p_e = \\nabla(n_e T_e) = T_e \\nabla n_e$. Also, $\\nabla n_e = \\frac{dn_e}{dr}\\hat{\\mathbf{x}}$.\nThe density gradient scale length is defined as $L_n \\equiv -(d\\ln n_e/dr)^{-1} = -n_e/(dn_e/dr)$. This implies $\\frac{dn_e}{dr} = -\\frac{n_e}{L_n}$.\nSubstituting these into the expression for the pressure gradient:\n$$ \\frac{dp_e}{dr} = T_e \\frac{dn_e}{dr} = -\\frac{n_e T_e}{L_n} $$\nThe electron diamagnetic drift velocity becomes:\n$$ \\mathbf{v}_{*e} = -\\frac{1}{e n_e B} \\left(-\\frac{n_e T_e}{L_n}\\right) \\hat{\\mathbf{y}} = \\frac{T_e}{e B L_n} \\hat{\\mathbf{y}} $$\nThe diamagnetic frequency is then:\n$$ \\omega_{*e} = \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{*e} = (k_y \\hat{\\mathbf{y}}) \\cdot \\left(\\frac{T_e}{e B L_n} \\hat{\\mathbf{y}}\\right) = \\frac{k_y T_e}{e B L_n} $$\nAs determined in the validation step, the problem statement requires $k_y = -40\\,\\mathrm{m}^{-1}$. The parameter $L_n$ can be expressed in terms of the given quantities as $L_n = a / (a/L_n)$. Substituting this into the formula for $\\omega_{*e}$:\n$$ \\omega_{*e} = \\frac{k_y T_e}{e B a} \\left(\\frac{a}{L_n}\\right) $$\nNow, we can compute the numerical values.\nThe parameters are:\n-   $k_y = -40\\,\\mathrm{m}^{-1}$\n-   $T_e = 2.5\\,\\mathrm{keV} = 2.5 \\times 10^3\\,\\mathrm{eV} \\times (1.602177 \\times 10^{-19}\\,\\mathrm{J/eV}) \\approx 4.0054 \\times 10^{-16}\\,\\mathrm{J}$\n-   $e = 1.602177 \\times 10^{-19}\\,\\mathrm{C}$\n-   $B = 3\\,\\mathrm{T}$\n-   $a = 0.6\\,\\mathrm{m}$\n\nAlternatively, we can express the temperature in electron-volts and use the fact that $T_e[\\mathrm{J}]/e = T_e[\\mathrm{V}]$. So, $T_e/e = 2500\\,\\mathrm{V}$.\nLet's calculate the prefactor term $\\frac{k_y T_e}{e B a}$:\n$$ \\frac{k_y (T_e/e)}{B a} = \\frac{(-40\\,\\mathrm{m}^{-1}) \\times (2500\\,\\mathrm{V})}{(3\\,\\mathrm{T}) \\times (0.6\\,\\mathrm{m})} = \\frac{-100000\\,\\mathrm{V/m}}{1.8\\,\\mathrm{T \\cdot m}} \\approx -55555.5\\,\\mathrm{s}^{-1} = -5.556 \\times 10^4\\,\\mathrm{s}^{-1} $$\n\nNow, we compute $\\omega_{*e}$ for each scenario:\n-   **Scenario F (flattening): $a/L_n = 0.5$**\n    $$ \\omega_{*e}(F) = (-5.556 \\times 10^4\\,\\mathrm{s}^{-1}) \\times 0.5 = -2.778 \\times 10^4\\,\\mathrm{s}^{-1} $$\n-   **Scenario P (peaking): $a/L_n = 2.0$**\n    $$ \\omega_{*e}(P) = (-5.556 \\times 10^4\\,\\mathrm{s}^{-1}) \\times 2.0 = -11.112 \\times 10^4\\,\\mathrm{s}^{-1} = -1.111 \\times 10^5\\,\\mathrm{s}^{-1} $$\n\nThe physical interpretation is that a larger value of $a/L_n$ corresponds to a steeper, more \"peaked\" density profile. This steeper gradient represents a larger source of free energy for gradient-driven instabilities like the TEM. Therefore, moving from Scenario F to Scenario P, which involves increasing $a/L_n$ fourfold, should significantly strengthen the TEM drive. This is reflected in the fourfold increase in the magnitude of $\\omega_{*e}$.\n\n### Option-by-Option Analysis\n\n**A. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx -1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$; the increased magnitude in Scenario P strengthens the TEM drive (more electron-diamagnetic propagation and greater free-energy injection).**\n-   **Numerical Values**: The calculated values $\\omega_{*e}(F) \\approx -2.78 \\times 10^4\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx -1.11 \\times 10^5\\,\\mathrm{s}^{-1}$ are in excellent agreement with our derivation.\n-   **Physical Interpretation**: The interpretation is correct. The transition from F to P involves an increase in the density gradient ($a/L_n$), which increases the free energy available to the TEM. This is reflected in the increased magnitude of $\\omega_{*e}$ and leads to a stronger instability drive. The phrasing \"more electron-diamagnetic propagation\" correctly associates a higher frequency magnitude with a faster mode propagation.\n-   **Verdict**: **Correct**.\n\n**B. $\\omega_{*e}(F) \\approx +2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx +1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$; the sign reversal to positive implies weakened TEM drive in Scenario P because the mode no longer propagates in the electron-diamagnetic direction.**\n-   **Numerical Values**: The signs are positive, which contradicts our rigorous derivation based on the problem's explicit definitions, which leads to $k_y  0$ and thus $\\omega_{*e}  0$.\n-   **Physical Interpretation**: The reasoning is fundamentally flawed. There is no \"sign reversal\"; both values share the same sign. An increase in the magnitude of $\\omega_{*e}$ signifies a *stronger* drive, not a weaker one. Finally, the sign of the frequency determines the direction of propagation; a TEM, by definition, propagates in the electron diamagnetic direction. A non-zero frequency (positive or negative, depending on convention) is a necessary condition for the mode, not a reason for its drive to be weakened.\n-   **Verdict**: **Incorrect**.\n\n**C. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{2}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx -1.11 \\times 10^{3}\\,\\mathrm{s}^{-1}$; density peaking reduces the TEM drive because the lower frequencies lessen resonance with trapped electrons.**\n-   **Numerical Values**: The values are incorrect by two orders of magnitude ($10^2$).\n-   **Physical Interpretation**: The interpretation is incorrect. Density peaking (stronger gradient) *strengthens* the TEM drive, it does not reduce it.\n-   **Verdict**: **Incorrect**.\n\n**D. $\\omega_{*e}(F) \\approx -1.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$ and $\\omega_{*e}(P) \\approx -6.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$; fueling mainly modifies the ion diamagnetic frequency $\\omega_{*i}$, so the TEM drive is insensitive to the change from Scenario F to Scenario P.**\n-   **Numerical Values**: The values are numerically incorrect. Our calculation is robust.\n-   **Physical Interpretation**: The reasoning is incorrect. The Trapped Electron Mode (TEM) is fundamentally linked to the electron diamagnetic drift and the electron pressure gradient. Its drive is therefore highly sensitive to changes in the density gradient, which directly impacts $\\omega_{*e}$. The claim of insensitivity is contrary to the nature of the instability.\n-   **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The growth of an instability is determined not just by the strength of its drive, but by the competition between that drive and various stabilizing or \"shielding\" mechanisms. This practice moves beyond the simple drive to explore this critical balance, focusing on how the ratio of electron to ion temperature, $\\tau = T_{e}/T_{i}$, influences the overall stability of the TEM. Using a simplified but physically insightful model, you will investigate how changing $\\tau$ alters the ion polarization response, a key shielding effect, and consequently modifies the instability growth rate. ",
            "id": "4207273",
            "problem": "Consider a local, electrostatic, collisionless linear analysis of the Trapped Electron Mode (TEM) in a tokamak core plasma. Treat ions gyrokinetically with finite Larmor radius polarization and electrons as a mixture of adiabatic passing electrons and non-adiabatic trapped electrons. Assume a single-harmonic perturbation with perpendicular wavenumber $k_{\\perp}$ and binormal wavenumber $k_{y}$, with $k_{\\perp} \\simeq k_{y}$. The following fundamental definitions and facts apply:\n- Quasi-neutrality requires $\\sum_{s} q_{s} \\delta n_{s} = 0$.\n- The passing-electron density response is adiabatic, $\\delta n_{e,\\mathrm{pass}}/n_{0} = (1 - f_{t}) \\, (e \\phi/T_{e})$, where $f_{t}$ is the trapped-electron fraction and $\\phi$ is the electrostatic potential.\n- The ion gyrokinetic polarization density response is $\\delta n_{i}/n_{0} = (e \\phi/T_{i}) \\, \\left[1 - \\Gamma_{0}(b_{i})\\right]$, where $b_{i} \\equiv k_{\\perp}^{2} \\rho_{i}^{2}$, $\\rho_{i} \\equiv \\sqrt{T_{i} m_{i}}/(e B)$ is the ion Larmor radius, $m_{i}$ is the ion mass, $B$ is the magnetic field strength, $e$ is the elementary charge, and $\\Gamma_{0}(b)$ is the gyroaverage with the small-$b$ expansion $\\Gamma_{0}(b) \\simeq 1 - b$ for $b \\ll 1$.\n- The trapped-electron non-adiabatic drive arises from the electron temperature gradient and diamagnetic drift, with diamagnetic frequency $\\omega_{\\ast e} \\equiv - k_{y} T_{e}/(e B L_{n})$ and electron temperature gradient parameter $\\eta_{e} \\equiv L_{n}/L_{T_{e}}$, where $L_{n} \\equiv - \\left(d \\ln n_{0}/dx\\right)^{-1}$ and $L_{T_{e}} \\equiv - \\left(d \\ln T_{e}/dx\\right)^{-1}$. In a fluid closure that captures the linear TEM drive, the trapped-electron contribution to the net drive scales as $f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}$.\nNormalize densities to $e \\phi/T_{e}$ so that the ion polarization enters multiplied by the electron-ion temperature ratio $\\tau \\equiv T_{e}/T_{i}$. Under these assumptions, the linear growth rate $\\gamma$ scales as the ratio of the trapped-electron drive to the total shielding (passing-electron adiabatic response plus ion polarization):\n$$\n\\gamma(\\tau) \\propto \\frac{f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}}{1 + \\tau \\left[1 - \\Gamma_{0}(b_{i})\\right]} \\, ,\n$$\nwith $\\omega_{\\ast e} \\propto T_{e}$, so that $\\gamma(\\tau)$ has the form\n$$\n\\gamma(\\tau) = C \\, \\frac{\\tau}{1 + \\tau \\, b_{i}} \\, ,\n$$\nfor some constant $C$ that is independent of $\\tau$ but may depend on $k_{y}$, $L_{n}$, $f_{t}$, $\\eta_{e}$, $T_{i}$, and equilibrium parameters.\n\nYour task:\n1. Starting from the above foundational definitions and quasi-neutrality, derive the scaling $\\gamma(\\tau) = C \\, \\tau/(1 + \\tau \\, b_{i})$ using the small-$b_{i}$ approximation $\\Gamma_{0}(b_{i}) \\simeq 1 - b_{i}$ and the proportionality $\\omega_{\\ast e} \\propto T_{e}$.\n2. Using the derived $\\gamma(\\tau)$, compute the multiplicative change in the growth rate when the electron-ion temperature ratio is doubled from $\\tau = 1$ to $\\tau = 2$, namely the ratio\n$$\nR \\equiv \\frac{\\gamma(2)}{\\gamma(1)} = \\frac{2 \\left(1 + b_{i}\\right)}{1 + 2 b_{i}} \\, .\n$$\nEvaluate $R$ for the following parameters:\n- Magnetic field $B = 2.0 \\, \\mathrm{T}$.\n- Ion temperature $T_{i} = 1.602 \\times 10^{-16} \\, \\mathrm{J}$ (corresponding to $1.0 \\, \\mathrm{keV}$).\n- Deuterium ion mass $m_{i} = 3.345 \\times 10^{-27} \\, \\mathrm{kg}$.\n- Elementary charge $e = 1.602 \\times 10^{-19} \\, \\mathrm{C}$.\n- Perpendicular wavenumber $k_{\\perp} = 100 \\, \\mathrm{m}^{-1}$.\nUse $b_{i} \\equiv k_{\\perp}^{2} \\rho_{i}^{2}$ with $\\rho_{i} \\equiv \\sqrt{T_{i} m_{i}}/(e B)$ and assume $k_{\\perp} \\simeq k_{y}$. Provide the final dimensionless ratio $R$ as a pure number with no units, and round your answer to three significant figures.",
            "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded in the principles of plasma physics, specifically the linear stability theory of microinstabilities in magnetically confined fusion plasmas. The problem is well-posed, with all necessary data and definitions provided for a unique solution. The parameters are physically realistic, and the approximations cited (e.g., small Larmor radius) are justified by these parameters. The tasks are clear, non-contradictory, and require direct application of the provided theoretical framework.\n\nThe solution proceeds in two main parts as requested: first, the derivation of the growth rate scaling, and second, the calculation of the ratio $R$.\n\n### Part 1: Derivation of the Growth Rate Scaling\n\nWe are given the scaling relation for the linear growth rate $\\gamma$ of the Trapped Electron Mode (TEM) as a function of the electron-ion temperature ratio $\\tau \\equiv T_{e}/T_{i}$:\n$$\n\\gamma(\\tau) \\propto \\frac{f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}}{1 + \\tau \\left[1 - \\Gamma_{0}(b_{i})\\right]}\n$$\nThis relation models the growth rate as proportional to the ratio of the instability drive (numerator) to the stabilizing shielding effects (denominator). We are tasked with showing that this leads to the form $\\gamma(\\tau) = C \\, \\frac{\\tau}{1 + \\tau \\, b_{i}}$ by applying the given approximations.\n\nLet's analyze the numerator and the denominator separately to determine their dependence on $\\tau$.\n\n**Numerator Analysis:**\nThe numerator, representing the drive, is $f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}$. The parameters $f_{t}$ (trapped electron fraction) and $\\eta_e$ (ratio of density and temperature gradient lengths) are treated as constants with respect to $\\tau$. The electron diamagnetic frequency $\\omega_{\\ast e}$ is defined as $\\omega_{\\ast e} \\equiv - k_{y} T_{e}/(e B L_{n})$.\nThe problem states that we are analyzing the effect of varying $T_e$ while other equilibrium parameters like $T_i$, $B$, $L_n$, and $k_y$ are held constant. The temperature ratio is $\\tau = T_e/T_i$, which implies $T_e = \\tau T_i$.\nGiven the proportionality $\\omega_{\\ast e} \\propto T_e$, we can therefore write:\n$$\n\\omega_{\\ast e} \\propto \\tau\n$$\nConsequently, the entire numerator scales linearly with $\\tau$:\n$$\n\\text{Numerator} \\propto f_{t} \\, \\eta_{e} \\, \\tau \\propto \\tau\n$$\n\n**Denominator Analysis:**\nThe denominator, representing the shielding, is $1 + \\tau \\left[1 - \\Gamma_{0}(b_{i})\\right]$.\nWe are instructed to use the small-argument expansion for the ion gyroaverage function $\\Gamma_{0}(b_i)$ for $b_i \\ll 1$:\n$$\n\\Gamma_{0}(b_i) \\simeq 1 - b_i\n$$\nHere, $b_i = k_{\\perp}^2 \\rho_i^2 = k_{\\perp}^2 \\frac{T_i m_i}{(eB)^2}$ is independent of $T_e$ and thus independent of $\\tau$.\nSubstituting this approximation into the denominator:\n$$\n\\text{Denominator} \\simeq 1 + \\tau \\left[1 - (1 - b_i)\\right] = 1 + \\tau \\left[b_i\\right] = 1 + \\tau b_i\n$$\n\n**Combining the results:**\nBy combining the scaling of the numerator and the denominator, we find the scaling of the growth rate $\\gamma(\\tau)$:\n$$\n\\gamma(\\tau) \\propto \\frac{\\tau}{1 + \\tau b_i}\n$$\nThis proportionality can be expressed as an equality by introducing a constant $C$ that is independent of $\\tau$ but incorporates all other parameters ($f_t, \\eta_e, k_y, L_n, B, T_i, m_i$, etc.):\n$$\n\\gamma(\\tau) = C \\frac{\\tau}{1 + \\tau b_i}\n$$\nThis completes the derivation requested in the first part of the problem.\n\n### Part 2: Calculation of the Ratio R\n\nThe second task is to compute the multiplicative change in the growth rate, $R$, when $\\tau$ is doubled from $\\tau=1$ to $\\tau=2$.\nThe ratio $R$ is defined as:\n$$\nR \\equiv \\frac{\\gamma(2)}{\\gamma(1)}\n$$\nUsing the derived expression for $\\gamma(\\tau)$:\n$$\n\\gamma(2) = C \\frac{2}{1 + 2 b_i}\n$$\n$$\n\\gamma(1) = C \\frac{1}{1 + (1) b_i} = C \\frac{1}{1 + b_i}\n$$\nThe ratio $R$ is therefore:\n$$\nR = \\frac{\\gamma(2)}{\\gamma(1)} = \\frac{C \\frac{2}{1 + 2 b_i}}{C \\frac{1}{1 + b_i}} = \\frac{2}{1 + 2 b_i} \\cdot (1 + b_i) = \\frac{2(1 + b_i)}{1 + 2 b_i}\n$$\nThis matches the expression provided in the problem statement, which confirms the consistency of our derivation.\n\nTo evaluate $R$ numerically, we must first calculate the dimensionless parameter $b_i$.\n$$\nb_i = k_{\\perp}^2 \\rho_i^2\n$$\nwhere the ion Larmor radius squared, $\\rho_i^2$, is given by:\n$$\n\\rho_i^2 = \\frac{T_i m_i}{(eB)^2}\n$$\nThe given parameters are all in SI units:\n- Magnetic field $B = 2.0 \\, \\mathrm{T}$\n- Ion temperature $T_{i} = 1.602 \\times 10^{-16} \\, \\mathrm{J}$\n- Deuterium ion mass $m_{i} = 3.345 \\times 10^{-27} \\, \\mathrm{kg}$\n- Elementary charge $e = 1.602 \\times 10^{-19} \\, \\mathrm{C}$\n- Perpendicular wavenumber $k_{\\perp} = 100 \\, \\mathrm{m}^{-1}$\n\nFirst, we calculate $\\rho_i^2$:\n$$\n\\rho_i^2 = \\frac{(1.602 \\times 10^{-16} \\, \\mathrm{J})(3.345 \\times 10^{-27} \\, \\mathrm{kg})}{((1.602 \\times 10^{-19} \\, \\mathrm{C})(2.0 \\, \\mathrm{T}))^2} = \\frac{5.35869 \\times 10^{-43} \\, \\mathrm{kg} \\cdot \\mathrm{J}}{(3.204 \\times 10^{-19} \\, \\mathrm{C} \\cdot \\mathrm{T})^2}\n$$\n$$\n\\rho_i^2 = \\frac{5.35869 \\times 10^{-43}}{1.0265616 \\times 10^{-37}} \\, \\mathrm{m}^2 \\approx 5.220138 \\times 10^{-6} \\, \\mathrm{m}^2\n$$\nNext, we calculate $b_i$:\n$$\nb_i = k_{\\perp}^2 \\rho_i^2 = (100 \\, \\mathrm{m}^{-1})^2 (5.220138 \\times 10^{-6} \\, \\mathrm{m}^2) = (10^4 \\, \\mathrm{m}^{-2})(5.220138 \\times 10^{-6} \\, \\mathrm{m}^2)\n$$\n$$\nb_i \\approx 0.05220138\n$$\nThis value is dimensionless, and $b_i \\ll 1$, which validates the use of the small-argument approximation for $\\Gamma_0$.\n\nFinally, we substitute the value of $b_i$ into the expression for $R$:\n$$\nR = \\frac{2(1 + 0.05220138)}{1 + 2(0.05220138)} = \\frac{2(1.05220138)}{1 + 0.10440276} = \\frac{2.10440276}{1.10440276}\n$$\n$$\nR \\approx 1.905493\n$$\nRounding the result to three significant figures, we get $1.91$.\nThis means that doubling the electron-to-ion temperature ratio from $1$ to $2$ results in an approximately $91\\%$ increase in the TEM growth rate for the given parameters.",
            "answer": "$$\\boxed{1.91}$$"
        },
        {
            "introduction": "Moving from analytical theory to computational practice reveals new challenges, particularly in how we initialize simulations and interpret their results. In theory, an instability evolves as a pure, single-frequency eigenmode, but simulations often start from random noise which excites a mixture of modes. This numerical exercise will guide you through simulating a simplified TEM system to highlight the practical difference between an ideal eigenmode-aligned initialization and a random noise initialization, demonstrating how the latter can complicate the accurate measurement of the leading growth rate. ",
            "id": "4207290",
            "problem": "You are modeling the early linear phase of the trapped electron mode (TEM) instability in a local, spectral, collisionless electrostatic gyrokinetic setting. In such a setting, after bounce-averaging over trapped electrons and projecting onto a finite set of basis functions, the linearized dynamics of a given binormal wavenumber can be represented as a finite-dimensional homogeneous linear ordinary differential equation of the form $\\mathrm{d}\\mathbf{x}/\\mathrm{d}t = \\mathbf{A}\\,\\mathbf{x}$, where $\\mathbf{x}\\in\\mathbb{C}^N$ is the state vector of perturbation amplitudes and $\\mathbf{A}\\in\\mathbb{C}^{N\\times N}$ is a constant complex matrix encoding drift, curvature, and trapped electron dynamics near a chosen equilibrium. If $\\mathbf{A}$ has a discrete spectrum with right eigenpairs $\\{(\\lambda_j,\\mathbf{v}_j)\\}$, then an eigenmode-aligned initialization $\\mathbf{x}(0)=\\mathbf{v}_j$ evolves as $\\mathbf{x}(t)=\\mathrm{e}^{\\lambda_j t}\\mathbf{v}_j$, so the growth rate is the real part $\\Re(\\lambda_j)$. In contrast, a random noise initialization $\\mathbf{x}(0)=\\sum_j c_j \\mathbf{v}_j$ excites multiple modes and can bias growth-rate estimates on finite time windows, especially for non-normal $\\mathbf{A}$ or when growth rates are closely spaced.\n\nYour task is to write a program that, for each provided linear operator, constructs an eigenmode-aligned perturbation and a random-noise perturbation, simulates their linear evolution exactly via spectral propagation, estimates the growth rate by fitting the logarithm of the perturbation amplitude versus time, and reports the absolute error of each estimate relative to the true leading growth rate. All times are normalized to the ion gyrofrequency so that time is measured in units of $1/\\Omega_i$ and growth rates in units of $\\Omega_i$. You must express the final numerical answers in units of $\\Omega_i$ as plain decimal numbers.\n\nFundamental base to use: the linearization principle and superposition for linear systems, the definition of eigenvalues/eigenvectors of a linear operator, and the exact solution of a homogeneous linear system with constant coefficients via spectral decomposition.\n\nFor each test case $(i=1,2,3)$, the operator $\\mathbf{A}^{(i)}$ is defined as $\\mathbf{A}^{(i)} = \\mathbf{S}^{(i)} \\mathbf{\\Lambda}^{(i)} \\left(\\mathbf{S}^{(i)}\\right)^{-1}$, where $\\mathbf{\\Lambda}^{(i)}$ is diagonal with entries $\\lambda^{(i)}_1,\\lambda^{(i)}_2,\\lambda^{(i)}_3,\\lambda^{(i)}_4$, and $\\mathbf{S}^{(i)}$ is an invertible real matrix. The matrices and eigenvalues are:\n\nTest case $i=1$:\n- $\\lambda^{(1)}_1 = 0.12 + \\mathrm{i}\\,0.7$, $\\lambda^{(1)}_2 = 0.05 + \\mathrm{i}\\,0.4$, $\\lambda^{(1)}_3 = -0.02 + \\mathrm{i}\\,0.2$, $\\lambda^{(1)}_4 = -0.08 + \\mathrm{i}\\,0.1$.\n- $\\mathbf{S}^{(1)} = \\begin{pmatrix}\n1.0  0.2  -0.1  0.0 \\\\\n0.1  1.0  0.3  -0.2 \\\\\n0.0  -0.1  1.0  0.1 \\\\\n0.2  0.0  -0.2  1.0\n\\end{pmatrix}$.\n- Time window: fit over $t\\in[t^{(1)}_{\\min},t^{(1)}_{\\max}]$ with $t^{(1)}_{\\min}=10.0$ and $t^{(1)}_{\\max}=40.0$.\n\nTest case $i=2$:\n- $\\lambda^{(2)}_1 = 0.10 + \\mathrm{i}\\,0.9$, $\\lambda^{(2)}_2 = 0.095 + \\mathrm{i}\\,0.85$, $\\lambda^{(2)}_3 = 0.0 + \\mathrm{i}\\,0.3$, $\\lambda^{(2)}_4 = -0.06 + \\mathrm{i}\\,0.15$.\n- $\\mathbf{S}^{(2)} = \\begin{pmatrix}\n1.0  -0.3  0.1  0.0 \\\\\n0.2  0.9  -0.2  0.1 \\\\\n0.0  0.1  0.95  -0.3 \\\\\n-0.1  0.0  0.25  1.1\n\\end{pmatrix}$.\n- Time window: fit over $t\\in[t^{(2)}_{\\min},t^{(2)}_{\\max}]$ with $t^{(2)}_{\\min}=5.0$ and $t^{(2)}_{\\max}=35.0$.\n\nTest case $i=3$:\n- $\\lambda^{(3)}_1 = 0.08 + \\mathrm{i}\\,0.6$, $\\lambda^{(3)}_2 = 0.06 + \\mathrm{i}\\,0.65$, $\\lambda^{(3)}_3 = 0.02 + \\mathrm{i}\\,0.2$, $\\lambda^{(3)}_4 = -0.05 + \\mathrm{i}\\,0.05$.\n- $\\mathbf{S}^{(3)} = \\begin{pmatrix}\n1.0  1.5  -1.2  0.3 \\\\\n0.0  1.0  1.4  -0.8 \\\\\n0.0  0.0  1.0  0.9 \\\\\n0.0  0.0  0.0  1.0\n\\end{pmatrix}$.\n- Time window: fit over $t\\in[t^{(3)}_{\\min},t^{(3)}_{\\max}]$ with $t^{(3)}_{\\min}=5.0$ and $t^{(3)}_{\\max}=20.0$.\n\nFor each test case $i$:\n\n1. Construct $\\mathbf{A}^{(i)}$ from $\\mathbf{S}^{(i)}$ and $\\mathbf{\\Lambda}^{(i)}$.\n2. Compute the true leading growth rate $\\gamma^{(i)}_{\\text{true}}=\\max_j \\Re(\\lambda^{(i)}_j)$ in $\\Omega_i$.\n3. Find the right eigenvector $\\mathbf{v}^{(i)}_{\\max}$ of $\\mathbf{A}^{(i)}$ associated with $\\gamma^{(i)}_{\\text{true}}$ and normalize it to unit $2$-norm. This defines the eigenmode-aligned initialization $\\mathbf{x}^{(i)}_{\\text{eig}}(0)=\\mathbf{v}^{(i)}_{\\max}$.\n4. Construct a random complex initialization $\\mathbf{x}^{(i)}_{\\text{rnd}}(0)$ by drawing each component’s real and imaginary parts independently from a standard normal distribution with a fixed seed unique to each test ($s^{(1)}=7$, $s^{(2)}=11$, $s^{(3)}=13$), and then normalizing to unit $2$-norm.\n5. Evolve each initialization $\\mathbf{x}(0)$ exactly via the spectral solution $\\mathbf{x}(t)=\\mathbf{S}^{(i)} \\exp(\\mathbf{\\Lambda}^{(i)} t) \\left(\\mathbf{S}^{(i)}\\right)^{-1} \\mathbf{x}(0)$, sampled at $N=601$ equally spaced times on $[t^{(i)}_{\\min},t^{(i)}_{\\max}]$.\n6. For each trajectory, compute the amplitude $a(t)=\\|\\mathbf{x}(t)\\|_2$, and estimate the growth rate $\\widehat{\\gamma}$ by a least-squares linear fit to $\\ln a(t)$ versus $t$ over the sampling window. Report both $\\widehat{\\gamma}^{(i)}_{\\text{eig}}$ and $\\widehat{\\gamma}^{(i)}_{\\text{rnd}}$.\n7. For each initialization type, compute the absolute error relative to the true leading growth rate: $E^{(i)}_{\\text{eig}}=\\left|\\widehat{\\gamma}^{(i)}_{\\text{eig}}-\\gamma^{(i)}_{\\text{true}}\\right|$ and $E^{(i)}_{\\text{rnd}}=\\left|\\widehat{\\gamma}^{(i)}_{\\text{rnd}}-\\gamma^{(i)}_{\\text{true}}\\right|$. These errors must be expressed in units of $\\Omega_i$ as plain decimal numbers.\n\nTest suite and required output:\n- Use the three test cases above with the specified matrices, eigenvalues, time windows, sample count $N=601$, and seeds $s^{(1)}=7$, $s^{(2)}=11$, $s^{(3)}=13$.\n- Your program should produce a single line of output containing the six errors as a comma-separated list enclosed in square brackets, ordered as $[E^{(1)}_{\\text{eig}},E^{(1)}_{\\text{rnd}},E^{(2)}_{\\text{eig}},E^{(2)}_{\\text{rnd}},E^{(3)}_{\\text{eig}},E^{(3)}_{\\text{rnd}}]$, with each entry a decimal number in $\\Omega_i$.",
            "solution": "The problem requires an analysis of growth rate estimation for a linearized model of plasma instability, specifically the trapped electron mode (TEM), described by the homogeneous linear ordinary differential equation $\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}t} = \\mathbf{A}\\,\\mathbf{x}$. Here, $\\mathbf{x}(t) \\in \\mathbb{C}^N$ is the state vector of perturbation amplitudes and $\\mathbf{A} \\in \\mathbb{C}^{N \\times N}$ is a constant matrix representing the system's dynamics. We are asked to compare the accuracy of growth rate estimates derived from two different initial conditions: one perfectly aligned with the fastest-growing eigenmode, and another representing random noise.\n\nThe fundamental principle for solving this system is rooted in the spectral theory of linear operators. Since the matrix $\\mathbf{A}$ is assumed to be diagonalizable, it can be decomposed as $\\mathbf{A} = \\mathbf{S} \\mathbf{\\Lambda} \\mathbf{S}^{-1}$, where $\\mathbf{\\Lambda}$ is a diagonal matrix containing the eigenvalues $\\lambda_j$ of $\\mathbf{A}$, and the columns of $\\mathbf{S}$ are the corresponding right eigenvectors $\\mathbf{v}_j$. The solution to the initial value problem $\\mathbf{x}(0) = \\mathbf{x}_0$ is given by $\\mathbf{x}(t) = \\exp(t\\mathbf{A})\\mathbf{x}_0$. Using the spectral decomposition, the matrix exponential can be computed as $\\exp(t\\mathbf{A}) = \\mathbf{S} \\exp(t\\mathbf{\\Lambda}) \\mathbf{S}^{-1}$, where $\\exp(t\\mathbf{\\Lambda})$ is a diagonal matrix with entries $\\mathrm{e}^{\\lambda_j t}$. This leads to the exact analytical solution provided in the problem:\n$$\n\\mathbf{x}(t) = \\mathbf{S} \\exp(t\\mathbf{\\Lambda}) \\mathbf{S}^{-1} \\mathbf{x}_0\n$$\nAn alternative, computationally efficient way to express this is by projecting the initial condition onto the eigenbasis. Let $\\mathbf{c} = \\mathbf{S}^{-1} \\mathbf{x}_0$ be the vector of coefficients of $\\mathbf{x}_0$ in the basis of eigenvectors. Then the evolution is given by $\\mathbf{x}(t) = \\mathbf{S} (\\exp(t\\mathbf{\\Lambda}) \\mathbf{c})$, which simplifies the computation for multiple time points.\n\nThe growth rate of an individual eigenmode is the real part of its eigenvalue, $\\gamma_j = \\Re(\\lambda_j)$. If the system is initialized with a single eigenmode, $\\mathbf{x}(0) = \\mathbf{v}_j$, the state evolves as $\\mathbf{x}(t) = \\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j$. The amplitude of the perturbation, defined by the $2$-norm, evolves as $a(t) = \\|\\mathbf{x}(t)\\|_2 = \\|\\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j\\|_2 = |\\mathrm{e}^{\\lambda_j t}| \\|\\mathbf{v}_j\\|_2 = \\mathrm{e}^{\\Re(\\lambda_j) t} \\|\\mathbf{v}_j\\|_2$. Taking the natural logarithm yields:\n$$\n\\ln a(t) = \\Re(\\lambda_j) t + \\ln(\\|\\mathbf{v}_j\\|_2)\n$$\nThis is a linear function of time $t$ with a slope equal to the exact growth rate $\\gamma_j$. Therefore, a linear fit to $\\ln a(t)$ versus $t$ for an eigenmode-aligned initial condition should yield the true growth rate with high precision.\n\nIn contrast, a random initial condition $\\mathbf{x}_0$ is a superposition of multiple eigenmodes, $\\mathbf{x}_0 = \\sum_j c_j \\mathbf{v}_j$. The time evolution is then $\\mathbf{x}(t) = \\sum_j c_j \\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j$. The amplitude $a(t) = \\|\\sum_j c_j \\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j\\|_2$ no longer has a simple exponential form. While asymptotically for large $t$, the term corresponding to the largest growth rate $\\gamma_{\\text{true}} = \\max_j \\Re(\\lambda_j)$ will dominate, the behavior at finite times is complex. Interference between modes can lead to transient growth or decay, especially if the matrix $\\mathbf{A}$ is non-normal (i.e., its eigenvectors are not orthogonal) or if multiple eigenvalues have nearly identical real parts. This complex transient behavior biases the linear fit of $\\ln a(t)$, leading to an estimated growth rate $\\widehat{\\gamma}$ that deviates from $\\gamma_{\\text{true}}$.\n\nThe algorithm to quantify this effect for the three given test cases is as follows:\n\nFor each test case $i \\in \\{1, 2, 3\\}$:\n1.  **Define Inputs**: The matrices $\\mathbf{S}^{(i)}$, the diagonal eigenvalue matrix $\\mathbf{\\Lambda}^{(i)}$, the time interval $[t^{(i)}_{\\min}, t^{(i)}_{\\max}]$, and the random seed $s^{(i)}$ are specified.\n2.  **Determine True Growth Rate**: The true leading growth rate is identified as $\\gamma^{(i)}_{\\text{true}} = \\max_j \\Re(\\lambda^{(i)}_j)$. The index of this eigenvalue is located.\n3.  **Prepare Initial Conditions**:\n    -   **Eigenmode-aligned**: The eigenvector $\\mathbf{v}^{(i)}_{\\max}$ corresponding to $\\gamma^{(i)}_{\\text{true}}$ is extracted from the appropriate column of $\\mathbf{S}^{(i)}$. The initial condition is set to the $2$-normalized vector: $\\mathbf{x}^{(i)}_{\\text{eig}}(0) = \\mathbf{v}^{(i)}_{\\max} \\left/ \\|\\mathbf{v}^{(i)}_{\\max}\\|_2\\right.$.\n    -   **Random**: A random complex vector $\\mathbf{z}$ of dimension $4$ is generated using the specified seed $s^{(i)}$, with its real and imaginary parts drawn from a standard normal distribution $\\mathcal{N}(0, 1)$. This vector is then $2$-normalized to create the initial condition $\\mathbf{x}^{(i)}_{\\text{rnd}}(0) = \\mathbf{z} \\left/ \\|\\mathbf{z}\\|_2\\right.$.\n4.  **Simulate System Evolution**: A set of $N=601$ equally spaced time points $\\{t_k\\}$ is generated within the interval $[t^{(i)}_{\\min}, t^{(i)}_{\\max}]$. For each initial condition, $\\mathbf{x}^{(i)}_{\\text{eig}}(0)$ and $\\mathbf{x}^{(i)}_{\\text{rnd}}(0)$, the state vector $\\mathbf{x}(t_k)$ is computed for each $t_k$ using the exact spectral solution $\\mathbf{x}(t) = \\mathbf{S} \\exp(t\\mathbf{\\Lambda})\\mathbf{S}^{-1} \\mathbf{x}_0$.\n5.  **Estimate Growth Rate**: For each of the two trajectories, the amplitude $a(t_k) = \\|\\mathbf{x}(t_k)\\|_2$ is calculated at each time point. A linear least-squares fit is performed on the data points $(t_k, \\ln a(t_k))$. The slope of the resulting line is the estimated growth rate, yielding $\\widehat{\\gamma}^{(i)}_{\\text{eig}}$ and $\\widehat{\\gamma}^{(i)}_{\\text{rnd}}$.\n6.  **Calculate Error**: The absolute errors are computed by comparing the estimated growth rates to the true leading growth rate: $E^{(i)}_{\\text{eig}} = \\left|\\widehat{\\gamma}^{(i)}_{\\text{eig}} - \\gamma^{(i)}_{\\text{true}}\\right|$ and $E^{(i)}_{\\text{rnd}} = \\left|\\widehat{\\gamma}^{(i)}_{\\text{rnd}} - \\gamma^{(i)}_{\\text{true}}\\right|$.\n\nThis procedure is systematically applied to the three test cases, and the six resulting error values are consolidated into a final list.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating TEM growth rates for different initial conditions.\n    \"\"\"\n    \n    # Define test cases as per the problem statement.\n    test_cases = [\n        {\n            \"lambdas\": np.array([0.12 + 0.7j, 0.05 + 0.4j, -0.02 + 0.2j, -0.08 + 0.1j]),\n            \"S\": np.array([\n                [1.0, 0.2, -0.1, 0.0],\n                [0.1, 1.0, 0.3, -0.2],\n                [0.0, -0.1, 1.0, 0.1],\n                [0.2, 0.0, -0.2, 1.0]\n            ]),\n            \"t_min\": 10.0,\n            \"t_max\": 40.0,\n            \"seed\": 7\n        },\n        {\n            \"lambdas\": np.array([0.10 + 0.9j, 0.095 + 0.85j, 0.0 + 0.3j, -0.06 + 0.15j]),\n            \"S\": np.array([\n                [1.0, -0.3, 0.1, 0.0],\n                [0.2, 0.9, -0.2, 0.1],\n                [0.0, 0.1, 0.95, -0.3],\n                [-0.1, 0.0, 0.25, 1.1]\n            ]),\n            \"t_min\": 5.0,\n            \"t_max\": 35.0,\n            \"seed\": 11\n        },\n        {\n            \"lambdas\": np.array([0.08 + 0.6j, 0.06 + 0.65j, 0.02 + 0.2j, -0.05 + 0.05j]),\n            \"S\": np.array([\n                [1.0, 1.5, -1.2, 0.3],\n                [0.0, 1.0, 1.4, -0.8],\n                [0.0, 0.0, 1.0, 0.9],\n                [0.0, 0.0, 0.0, 1.0]\n            ]),\n            \"t_min\": 5.0,\n            \"t_max\": 20.0,\n            \"seed\": 13\n        }\n    ]\n\n    all_errors = []\n    N_SAMPLES = 601\n\n    for case in test_cases:\n        lambdas = case[\"lambdas\"]\n        S = case[\"S\"]\n        t_min, t_max = case[\"t_min\"], case[\"t_max\"]\n        seed = case[\"seed\"]\n\n        S_inv = np.linalg.inv(S)\n        \n        # Step 2: Compute true leading growth rate\n        gamma_true = np.max(np.real(lambdas))\n        idx_max = np.argmax(np.real(lambdas))\n\n        # Step 3: Construct initial conditions\n        # Eigenmode-aligned initialization\n        v_max = S[:, idx_max]\n        x0_eig = v_max / np.linalg.norm(v_max)\n\n        # Random-noise initialization\n        rng = np.random.default_rng(seed)\n        dim = S.shape[0]\n        z = rng.standard_normal(dim) + 1j * rng.standard_normal(dim)\n        x0_rnd = z / np.linalg.norm(z)\n\n        # Time vector for simulation\n        t_vec = np.linspace(t_min, t_max, N_SAMPLES)\n        \n        def evolve_and_estimate_growth_rate(x0):\n            \"\"\"\n            Evolves an initial condition and estimates the growth rate from the trajectory.\n            \"\"\"\n            # Project initial condition onto the eigenbasis\n            c = S_inv @ x0\n            \n            amplitudes = np.zeros(len(t_vec))\n            \n            for i, t in enumerate(t_vec):\n                # Evolve coefficients in the eigenbasis\n                ct = np.exp(lambdas * t) * c\n                # Transform back to the standard basis\n                xt = S @ ct\n                # Compute amplitude\n                amplitudes[i] = np.linalg.norm(xt)\n            \n            # Step 6: Estimate growth rate via linear fit\n            log_amplitudes = np.log(amplitudes)\n            # slope is the estimated growth rate\n            slope, _, _, _, _ = linregress(t_vec, log_amplitudes)\n            \n            return slope\n\n        # Estimate growth rates for both initial conditions\n        gamma_hat_eig = evolve_and_estimate_growth_rate(x0_eig)\n        gamma_hat_rnd = evolve_and_estimate_growth_rate(x0_rnd)\n\n        # Step 7: Compute absolute errors\n        E_eig = np.abs(gamma_hat_eig - gamma_true)\n        E_rnd = np.abs(gamma_hat_rnd - gamma_true)\n\n        all_errors.extend([E_eig, E_rnd])\n\n    # Format output as plain decimal numbers\n    formatted_errors = [f\"{err:.16f}\".rstrip('0').rstrip('.') for err in all_errors]\n    print(f\"[{','.join(formatted_errors)}]\")\n\nsolve()\n```"
        }
    ]
}