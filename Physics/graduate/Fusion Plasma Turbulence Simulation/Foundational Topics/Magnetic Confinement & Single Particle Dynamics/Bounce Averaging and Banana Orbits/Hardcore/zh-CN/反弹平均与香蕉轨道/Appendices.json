{
    "hands_on_practices": [
        {
            "introduction": "在托卡马克中，由于磁场强度的环向不均匀性，一部分粒子会被“捕获”在磁场较弱的区域，无法完成完整的极向旋转。这些“捕获粒子”的轨道（香蕉轨道）与“通行粒子”的轨道截然不同，对等离子体的输运和稳定性有至关重要的影响。本练习将指导你从第一性原理出发，通过能量和磁矩守恒定律，推导出在大环径比近似下捕获粒子的份额，这是理解和模拟捕获粒子效应的基础。",
            "id": "4182238",
            "problem": "在一个具有圆形同心磁通量面的大环径比（LAR）托卡马克中，环向磁场的大小主要因大半径的变化而沿磁力线变化。使用经过充分检验的近似，即环向磁场与 $R$ 成反比（$B \\propto 1/R$），设小半径为 $r$（其中 $r \\ll R_{0}$）的给定磁通量面上的磁场为\n$$\nB(\\theta) \\approx \\frac{B_{0}}{1 + \\epsilon \\cos\\theta},\n$$\n其中 $R_{0}$ 是大半径，$\\epsilon \\doteq r/R_{0} \\ll 1$ 是反环径比，$\\theta$ 是极向角（以弧度为单位），$B_{0}$ 是一个常数，其选择使得 $B(\\theta=0)=B_{0}/(1+\\epsilon)$ 为外侧中平面的磁场。考虑一个质量为 $m$、电荷为 $q$ 的无碰撞导心粒子，其动力学由总动能 $E = \\tfrac{1}{2} m v^{2}$ 和磁矩 $\\mu = m v_{\\perp}^{2}/(2 B)$ 的守恒决定，其中 $v$ 是速率，$v_{\\perp}$ 是垂直于磁场的速度分量。将外侧中平面（$\\theta = 0$ 处）的螺距角余弦定义为 $\\xi \\doteq v_{\\parallel}/v$，其中 $v_{\\parallel}$ 是此处的平行速度。\n\n如果一个粒子的平行速度 $v_{\\parallel}$ 在完成一个完整的极向穿行之前的某个极向角处消失，则称该粒子为捕获粒子，否则称为通行粒子。在回旋动理学湍流模拟中，弹跳平均使用磁通量面上捕获粒子的比例 $f_{t}$ 作为一个关键的权重。\n\n假设外侧中平面上的速度分布是各向同性的麦克斯韦分布，\n$$\nf_{M}(\\mathbf{v}) = n \\left(\\frac{m}{2 \\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2 T}\\right),\n$$\n密度为 $n$，温度为 $T$，且分布在速度空间中是各向同性的，计算给定磁通量面上捕获粒子的比例 $f_{t}$（精确到 $\\epsilon$ 的领头阶）。你的推导应从 $E$ 和 $\\mu$ 的守恒以及给定的 $B(\\theta)$ 开始，得到用 $\\xi$ 表示的捕获区域条件，然后对麦克斯韦速度分布进行适当的平均。将你的最终答案表示为关于 $\\epsilon$ 的单个闭式解析表达式，该表达式精确到 $\\epsilon$ 的领头阶且不含单位。不要提供不等式或方程作为最终答案。",
            "solution": "题目要求计算在大环径比托卡马克中，给定磁通量面上捕捕获粒子的比例，精确到反环径比 $\\epsilon$ 的领头阶。我们已知磁场模型、带电粒子的运动常数以及外侧中平面上的速度分布函数。\n\n首先，我们建立粒子被捕获的条件。粒子的运动由动能 $E$ 和磁矩 $\\mu$ 的守恒决定。\n动能为 $E = \\frac{1}{2}mv^2$，其中 $m$ 是粒子质量，$v$ 是其速率。由于 $E$ 守恒，对于给定的粒子，速率 $v$ 是恒定的。\n磁矩为 $\\mu = \\frac{mv_{\\perp}^2}{2B}$，其中 $v_{\\perp}$ 是垂直于磁场 $\\mathbf{B}$ 的速度分量，$B=|\\mathbf{B}|$。由于 $\\mu$ 也守恒，比值 $v_{\\perp}^2/B$ 沿着粒子的轨迹是恒定的。\n\n总速率的平方为 $v^2 = v_{\\parallel}^2 + v_{\\perp}^2$，其中 $v_{\\parallel}$ 是平行于 $\\mathbf{B}$ 的速度分量。我们可以将沿磁力线上任意点的 $v_{\\parallel}^2$ 表示为当地磁场 $B(\\theta)$ 的函数：\n$v_{\\parallel}^2(\\theta) = v^2 - v_{\\perp}^2(\\theta)$。\n利用 $\\mu$ 的守恒，我们有 $v_{\\perp}^2(\\theta) = \\frac{2B(\\theta)\\mu}{m}$。因此，\n$$v_{\\parallel}^2(\\theta) = v^2 - \\frac{2B(\\theta)\\mu}{m}。$$\n为了计算 $\\mu$，我们使用外侧中平面的初始条件，此处极向角为 $\\theta=0$。在此位置，磁场为 $B(0)$。螺距角余弦定义为 $\\xi \\doteq v_{\\parallel,0}/v$，其中 $v_{\\parallel,0}$ 是在 $\\theta=0$ 处的平行速度。\n在 $\\theta=0$ 处的垂直速度由 $v_{\\perp,0}^2 = v^2 - v_{\\parallel,0}^2 = v^2 - \\xi^2 v^2 = v^2(1-\\xi^2)$ 给出。\n现在，磁矩可以用这些中平面上的量来表示：\n$$\\mu = \\frac{m v_{\\perp,0}^2}{2B(0)} = \\frac{m v^2 (1-\\xi^2)}{2B(0)}。$$\n将此 $\\mu$ 的表达式代回到 $v_{\\parallel}^2(\\theta)$ 的方程中，我们得到：\n$$v_{\\parallel}^2(\\theta) = v^2 - \\frac{2B(\\theta)}{m} \\left( \\frac{m v^2 (1-\\xi^2)}{2B(0)} \\right) = v^2 \\left( 1 - \\frac{B(\\theta)}{B(0)}(1-\\xi^2) \\right)。$$\n如果一个粒子的平行速度 $v_{\\parallel}$ 在某个称为“弹跳点”的极向角 $\\theta_b$ 处变为零，则该粒子被定义为捕获粒子。在此点，粒子反转其平行运动方向。一个粒子要被捕获，它必须在完成一个完整的极向穿行之前，即在到达磁场最大值点之前，有一个弹跳点。给定的磁场是 $B(\\theta) = \\frac{B_0}{1 + \\epsilon \\cos\\theta}$。该磁场在外侧中平面（$\\theta=0$）处达到最小值，为 $B_{min} = B(0) = \\frac{B_0}{1+\\epsilon}$，在内侧中平面（$\\theta=\\pi$）处达到最大值，为 $B_{max} = B(\\pi) = \\frac{B_0}{1-\\epsilon}$。\n\n如果一个粒子的平行方向动能在任何地方，包括在磁场最大值点，都保持非负，则该粒子可以通行。相反，如果一个粒子的平行方向动能在磁场最大值点会变为负值（这在物理上是不可能的，意味着它必须在该点之前就已经反射），则该粒子被捕获。因此，捕获条件是 $v_{\\parallel}^2(\\pi)  0$：\n$$v^2 \\left( 1 - \\frac{B(\\pi)}{B(0)}(1-\\xi^2) \\right)  0。$$\n由于 $v^2 > 0$，这可以简化为：\n$$1  \\frac{B_{max}}{B_{min}}(1-\\xi^2) \\implies 1-\\xi^2 > \\frac{B_{min}}{B_{max}} \\implies \\xi^2  1 - \\frac{B_{min}}{B_{max}}。$$\n现在，我们计算比值 $\\frac{B_{min}}{B_{max}}$：\n$$\\frac{B_{min}}{B_{max}} = \\frac{B_0/(1+\\epsilon)}{B_0/(1-\\epsilon)} = \\frac{1-\\epsilon}{1+\\epsilon}。$$\n对螺距角余弦 $\\xi$ 的捕获条件是：\n$$\\xi^2  1 - \\frac{1-\\epsilon}{1+\\epsilon} = \\frac{(1+\\epsilon) - (1-\\epsilon)}{1+\\epsilon} = \\frac{2\\epsilon}{1+\\epsilon}。$$\n对于大环径比极限 $\\epsilon \\ll 1$，我们可以将此表达式展开到领头阶：\n$$\\frac{2\\epsilon}{1+\\epsilon} = 2\\epsilon(1+\\epsilon)^{-1} \\approx 2\\epsilon(1-\\epsilon) \\approx 2\\epsilon。$$\n因此，精确到 $\\epsilon$ 的领头阶，粒子被捕获的条件是 $|\\xi|  \\sqrt{2\\epsilon}$。\n\n接下来，我们计算捕获粒子的比例 $f_t$。这是捕获粒子的数密度与总数密度的比值。鉴于外侧中平面上的速度分布 $f_M(\\mathbf{v})$ 是各向同性的（仅取决于速率 $v=|\\mathbf{v}|$），速度空间中某一区域的粒子比例就是该区域的立体角与总立体角（$4\\pi$ 球面度）的比值。\n$$f_t = \\frac{\\int_{\\text{trapped}} f_M(\\mathbf{v}) d^3v}{\\int_{\\text{all}} f_M(\\mathbf{v}) d^3v}$$\n在速度空间的球坐标系 $(v, \\alpha, \\phi)$ 中，其中 $\\alpha$ 是相对于 $\\mathbf{B}$ 的角度，使得 $\\xi = \\cos(\\alpha)$，速度空间体积元为 $d^3v = v^2 dv \\sin\\alpha d\\alpha d\\phi = v^2 dv |d\\xi| d\\phi$。积分可以分离：\n$$f_t = \\frac{\\int_0^{\\infty} f_M(v) v^2 dv \\int_{\\text{trapped}} d\\Omega}{\\int_0^{\\infty} f_M(v) v^2 dv \\int_{\\text{all}} d\\Omega} = \\frac{\\Omega_{\\text{trapped}}}{\\Omega_{\\text{total}}}。$$\n总立体角为 $\\Omega_{\\text{total}} = \\int_0^{2\\pi} d\\phi \\int_{-1}^{1} d\\xi = 2\\pi \\cdot 2 = 4\\pi$。\n对应于捕获粒子区域 $|\\xi|  \\sqrt{2\\epsilon}$ 的立体角是：\n$$\\Omega_{\\text{trapped}} = \\int_0^{2\\pi} d\\phi \\int_{-\\sqrt{2\\epsilon}}^{\\sqrt{2\\epsilon}} d\\xi = 2\\pi \\left( \\sqrt{2\\epsilon} - (-\\sqrt{2\\epsilon}) \\right) = 2\\pi(2\\sqrt{2\\epsilon}) = 4\\pi\\sqrt{2\\epsilon}。$$\n捕获粒子的比例是这些立体角的比值：\n$$f_t = \\frac{\\Omega_{\\text{trapped}}}{\\Omega_{\\text{total}}} = \\frac{4\\pi\\sqrt{2\\epsilon}}{4\\pi} = \\sqrt{2\\epsilon}。$$\n这个结果已经是关于 $\\epsilon$ 的领头阶表达式。一种更严谨的方法是计算精确的比例 $f_t = \\sqrt{\\frac{2\\epsilon}{1+\\epsilon}}$，然后对 $\\epsilon \\ll 1$ 进行展开，这会得到相同的领头阶项：\n$$f_t = \\sqrt{2\\epsilon}(1+\\epsilon)^{-1/2} = \\sqrt{2\\epsilon} \\left(1 - \\frac{1}{2}\\epsilon + O(\\epsilon^2)\\right) = \\sqrt{2\\epsilon} - \\frac{1}{\\sqrt{2}}\\epsilon^{3/2} + \\dots$$\n领头项是 $\\sqrt{2\\epsilon}$。",
            "answer": "$$\\boxed{\\sqrt{2\\epsilon}}$$"
        },
        {
            "introduction": "捕获粒子的运动非常复杂，它在磁镜点之间快速“弹跳”，同时缓慢地进动。为了简化其动力学描述，我们引入“弹跳平均”技术，将物理量沿其快速弹跳轨道进行平均，从而得到一个描述其慢速进动行为的有效模型。本练习将让你在一个简化的“深度捕获”极限下，亲手计算一个关键物理量（极向角的余弦）的弹跳平均值，从而直观地掌握这一核心分析工具的运作机制。",
            "id": "4182226",
            "problem": "在一个大环径比、圆截面、同心轴托卡马克中，给定磁通面上沿磁力线的磁场强度大小可以被逆环径比的一阶近似模型表示为 $B(\\theta) = B_{0} \\left(1 - \\epsilon \\cos\\theta\\right)$，其中 $B_{0}$ 是轴上磁场，$\\theta$ 是极向角，而 $\\epsilon \\equiv r/R_{0} \\ll 1$ 是逆环径比。考虑一个质量为 $m$、速度为 $v$ 的单导心粒子，其总能量 $\\mathcal{E} = m v^{2}/2$ 和磁矩 $\\mu = m v_{\\perp}^{2}/(2 B)$ 守恒。定义螺距参数 $\\lambda \\equiv \\mu B_{0}/\\mathcal{E}$，使得平行速度满足 $v_{\\parallel}^{2}(\\theta) = v^{2}\\left[1 - \\lambda \\, B(\\theta)/B_{0}\\right]$。对于一个捕获粒子，存在转折点 $\\pm \\theta_{t}$，在这些点上 $v_{\\parallel}(\\pm \\theta_{t}) = 0$。函数 $A(\\theta)$ 的弹跳平均定义为\n$$\n\\langle A \\rangle_{b} \\equiv \\frac{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{A(\\theta)}{|v_{\\parallel}(\\theta)|} \\,\\frac{d\\ell}{d\\theta}\\, d\\theta}{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1}{|v_{\\parallel}(\\theta)|} \\,\\frac{d\\ell}{d\\theta}\\, d\\theta},\n$$\n其中 $d\\ell$ 是沿磁力线的弧长。对于深捕获粒子，在 $\\epsilon$ 的主导阶下进行计算，这意味着 $|\\theta_{t}| \\ll 1$ 且磁阱底部失谐量 $1 - \\lambda\\left(1 - \\epsilon\\right)$ 与 $\\epsilon$ 相比是渐进地小的。从 $\\mathcal{E}$ 和 $\\mu$ 的守恒出发，并仅保留在 $\\theta = 0$ 附近数学上必要的主导阶几何效应，推导 $A(\\theta) = \\cos\\theta$ 的弹跳平均值，并将最终结果表示为关于 $\\lambda$ 和 $\\epsilon$ 的闭合形式解析表达式。不需要进行数值近似。将您关于 $\\langle \\cos\\theta \\rangle_{b}$ 的最终答案以无单位的单一解析表达式形式给出。角度以弧度为单位。",
            "solution": "问题要求计算在托卡马克模型磁场中，对于一个深捕获粒子，函数 $A(\\theta) = \\cos\\theta$ 的弹跳平均值。弹跳平均的定义如下：\n$$\n\\langle A \\rangle_{b} \\equiv \\frac{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{A(\\theta)}{|v_{\\parallel}(\\theta)|} \\,\\frac{d\\ell}{d\\theta}\\, d\\theta}{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1}{|v_{\\parallel}(\\theta)|} \\,\\frac{d\\ell}{d\\theta}\\, d\\theta}\n$$\n其中 $\\pm \\theta_{t}$ 是捕获粒子轨道的转折点。\n\n首先，我们建立平行速度 $v_{\\parallel}$ 的表达式。给定守恒的能量 $\\mathcal{E} = m v^{2}/2$、守恒的磁矩 $\\mu = m v_{\\perp}^{2}/(2 B)$ 以及螺距参数 $\\lambda = \\mu B_{0}/\\mathcal{E}$，平行速度的平方由下式给出：\n$$\nv_{\\parallel}^{2}(\\theta) = v^{2}\\left[1 - \\lambda \\frac{B(\\theta)}{B_{0}}\\right]\n$$\n代入给定的磁场模型 $B(\\theta) = B_{0} (1 - \\epsilon \\cos\\theta)$，我们得到：\n$$\nv_{\\parallel}^{2}(\\theta) = v^{2}(1 - \\lambda + \\lambda\\epsilon \\cos\\theta)\n$$\n问题指定该分析是针对深捕获粒子，其转折角很小，即 $|\\theta_{t}| \\ll 1$。这允许我们对磁阱底部 $\\theta=0$ 附近的极向角 $\\theta$ 使用小角度近似。我们将 $\\cos\\theta$ 展开到二阶：\n$$\n\\cos\\theta \\approx 1 - \\frac{\\theta^2}{2}\n$$\n将此代入 $v_{\\parallel}^{2}(\\theta)$ 的表达式中：\n$$\nv_{\\parallel}^{2}(\\theta) \\approx v^{2}\\left[1 - \\lambda + \\lambda\\epsilon \\left(1 - \\frac{\\theta^2}{2}\\right)\\right] = v^{2}\\left[1 - \\lambda(1-\\epsilon) - \\frac{\\lambda\\epsilon}{2}\\theta^2\\right]\n$$\n转折点 $\\pm \\theta_{t}$ 由条件 $v_{\\parallel}(\\pm \\theta_{t}) = 0$ 定义。使用近似表达式：\n$$\n0 = 1 - \\lambda(1-\\epsilon) - \\frac{\\lambda\\epsilon}{2}\\theta_t^2\n$$\n解出 $\\theta_t^2$：\n$$\n\\theta_t^2 = \\frac{2(1 - \\lambda(1-\\epsilon))}{\\lambda\\epsilon} = \\frac{2(1 - \\lambda + \\lambda\\epsilon)}{\\lambda\\epsilon}\n$$\n问题陈述指出，对于深捕获粒子，量 $1 - \\lambda(1-\\epsilon)$ 与 $\\epsilon$ 相比很小，这与条件 $|\\theta_t| \\ll 1$ 一致。\n\n现在我们可以用 $\\theta_t^2$ 来表示 $v_{\\parallel}^{2}(\\theta)$：\n$$\nv_{\\parallel}^{2}(\\theta) \\approx v^{2}\\left[\\frac{\\lambda\\epsilon}{2}\\theta_t^2 - \\frac{\\lambda\\epsilon}{2}\\theta^2\\right] = v^{2}\\frac{\\lambda\\epsilon}{2}(\\theta_t^2 - \\theta^2)\n$$\n因此，平行速度的大小为：\n$$\n|v_{\\parallel}(\\theta)| \\approx v\\sqrt{\\frac{\\lambda\\epsilon}{2}}\\sqrt{\\theta_t^2 - \\theta^2}\n$$\n对于 $|\\theta| \\leq |\\theta_t|$。\n\n接下来，我们考虑沿磁力线的弧长元 $d\\ell$。对于大环径比的圆形托卡马克， $d\\ell/d\\theta \\approx q R_{0}$，其中 $q$ 是安全因子， $R_{0}$ 是大半径。在主导阶下，此项为常数。由于 $d\\ell/d\\theta$ 同时出现在弹跳平均公式的分子和分母中，它被消掉了。 $|v_{\\parallel}(\\theta)|$ 中的常数前置因子 $v\\sqrt{\\lambda\\epsilon/2}$ 也被消掉了。\n\n因此，$A(\\theta) = \\cos\\theta$ 的弹跳平均值为：\n$$\n\\langle \\cos\\theta \\rangle_{b} = \\frac{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{\\cos\\theta}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta}{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta}\n$$\n我们必须在分子中对 $\\cos\\theta$ 使用相同的小角度近似：\n$$\n\\langle \\cos\\theta \\rangle_{b} \\approx \\frac{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1 - \\theta^2/2}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta}{\\displaystyle \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta}\n$$\n让我们计算分母积分 $D$：\n$$\nD = \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta = \\left[ \\arcsin\\left(\\frac{\\theta}{\\theta_t}\\right) \\right]_{-\\theta_{t}}^{\\theta_{t}} = \\arcsin(1) - \\arcsin(-1) = \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) = \\pi\n$$\n现在，我们计算分子积分 $N$：\n$$\nN = \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1 - \\theta^2/2}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta = \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{1}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta - \\frac{1}{2} \\int_{-\\theta_{t}}^{\\theta_{t}} \\frac{\\theta^2}{\\sqrt{\\theta_t^2 - \\theta^2}} \\, d\\theta\n$$\n第一项就是 $D = \\pi$。第二个积分，我们称之为 $I_2$，可以通过三角代换 $\\theta = \\theta_t \\sin\\phi$ 求解，这意味着 $d\\theta = \\theta_t \\cos\\phi \\, d\\phi$。$\\phi$ 的积分限从 $-\\pi/2$ 到 $\\pi/2$。\n$$\nI_2 = \\int_{-\\pi/2}^{\\pi/2} \\frac{(\\theta_t \\sin\\phi)^2}{\\sqrt{\\theta_t^2 - \\theta_t^2 \\sin^2\\phi}} (\\theta_t \\cos\\phi \\, d\\phi) = \\int_{-\\pi/2}^{\\pi/2} \\frac{\\theta_t^2 \\sin^2\\phi}{\\theta_t \\cos\\phi} (\\theta_t \\cos\\phi \\, d\\phi)\n$$\n$$\nI_2 = \\theta_t^2 \\int_{-\\pi/2}^{\\pi/2} \\sin^2\\phi \\, d\\phi = \\theta_t^2 \\int_{-\\pi/2}^{\\pi/2} \\frac{1 - \\cos(2\\phi)}{2} \\, d\\phi\n$$\n$$\nI_2 = \\frac{\\theta_t^2}{2} \\left[ \\phi - \\frac{\\sin(2\\phi)}{2} \\right]_{-\\pi/2}^{\\pi/2} = \\frac{\\theta_t^2}{2} \\left[ \\left(\\frac{\\pi}{2} - 0\\right) - \\left(-\\frac{\\pi}{2} - 0\\right) \\right] = \\frac{\\theta_t^2 \\pi}{2}\n$$\n将此结果代回到 $N$ 的表达式中：\n$$\nN = \\pi - \\frac{1}{2}I_2 = \\pi - \\frac{1}{2}\\left(\\frac{\\theta_t^2 \\pi}{2}\\right) = \\pi\\left(1 - \\frac{\\theta_t^2}{4}\\right)\n$$\n弹跳平均是分子与分母的比值：\n$$\n\\langle \\cos\\theta \\rangle_{b} = \\frac{N}{D} = \\frac{\\pi\\left(1 - \\frac{\\theta_t^2}{4}\\right)}{\\pi} = 1 - \\frac{\\theta_t^2}{4}\n$$\n最后，我们将 $\\theta_t^2$ 的表达式用 $\\lambda$ 和 $\\epsilon$ 代入：\n$$\n\\langle \\cos\\theta \\rangle_{b} = 1 - \\frac{1}{4} \\left( \\frac{2(1 - \\lambda + \\lambda\\epsilon)}{\\lambda\\epsilon} \\right) = 1 - \\frac{1 - \\lambda + \\lambda\\epsilon}{2\\lambda\\epsilon}\n$$\n这个表达式可以通过通分来简化：\n$$\n\\langle \\cos\\theta \\rangle_{b} = \\frac{2\\lambda\\epsilon}{2\\lambda\\epsilon} - \\frac{1 - \\lambda + \\lambda\\epsilon}{2\\lambda\\epsilon} = \\frac{2\\lambda\\epsilon - 1 + \\lambda - \\lambda\\epsilon}{2\\lambda\\epsilon} = \\frac{\\lambda\\epsilon + \\lambda - 1}{2\\lambda\\epsilon}\n$$\n这是对于深捕获粒子，在相关小量的主导阶下，$\\cos\\theta$ 的弹跳平均值的最终闭合形式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\lambda\\epsilon + \\lambda - 1}{2\\lambda\\epsilon}}$$"
        },
        {
            "introduction": "虽然深度捕获等极限情况下的解析近似为我们提供了宝贵的物理直觉，但在实际的聚变等离子体模拟中，我们需要对所有捕获粒子进行精确计算。本练习旨在连接理论分析与计算实践，要求你推导适用于任意捕获粒子的弹跳周期和弹跳平均的精确解析表达式（以椭圆积分表示），并编写一个数值程序来验证这些解析结果。掌握这种数值验证方法是计算等离子体物理研究中不可或缺的一项关键技能。",
            "id": "4182194",
            "problem": "给定一个大环径比、圆截面、同心的托卡马克平衡，其具有小反环径比 $\\epsilon = r / R_0$、安全因子 $q$ 和大半径 $R_0$。考虑速度为 $v$ 的单一种类粒子在极向角坐标 $\\theta$（角度单位：弧度）中的导心运动。在大环径比近似下，磁场大小为 $B(\\theta) = B_0 \\left(1 - \\epsilon \\cos\\theta\\right)$，其中 $B_0$ 是参考磁场。定义螺距参数 $\\lambda$ 为 $\\lambda = \\mu B_0 / \\mathcal{E}$，其中 $\\mu$ 是磁矩，$\\mathcal{E}$ 是总能量，因此平行速度为 $v_{\\parallel}(\\theta) = v \\sqrt{1 - \\lambda \\, B(\\theta)/B_0} = v \\sqrt{1 - \\lambda \\left(1 - \\epsilon \\cos\\theta\\right)}$。当 $\\lambda$ 满足 $1/(1+\\epsilon) \\le \\lambda \\le 1/(1-\\epsilon)$ 时，发生捕获运动，反弹点 $\\pm \\theta_b$ 由 $v_{\\parallel}(\\pm \\theta_b) = 0$ 确定。\n\n仅从这些基本原理（磁矩、能量守恒以及大环径比场变化）出发，执行以下操作：\n\n1. 推导一个数学上明确的程序，用于数值计算反弹周期 $\\tau_b(\\lambda)$（定义为从 $-\\theta_b$ 运动到 $+\\theta_b$ 再返回到 $-\\theta_b$ 的时间）和反弹平均 $\\langle \\cos\\theta \\rangle_b$（定义为在一个反弹周期内 $\\cos\\theta$ 的时间平均值）。使用以下定义\n   $$\\tau_b(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{d\\ell}{v_{\\parallel}(\\theta)}, \\quad \\langle \\cos\\theta \\rangle_b = \\frac{1}{\\tau_b(\\lambda)} \\, 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{\\cos\\theta \\, d\\ell}{v_{\\parallel}(\\theta)},$$\n   其中 $d\\ell$ 是沿磁力线的微分长度元。在大环径比、圆截面极限下，通过一个恒定的度规因子将 $d\\ell$ 和 $d\\theta$ 联系起来，并仅用 $\\theta$ 表示这两个积分。\n\n2. 独立地，从第一性原理和适当的变量替换出发，推导 $\\tau_b(\\lambda)$ 和 $\\langle \\cos\\theta \\rangle_b$ 的大环径比解析表达式，用完全椭圆积分表示。\n\n3. 实现一个程序，对于给定的参数集，计算数值解和解析解，并报告其相对差异以进行验证。\n\n需要使用的物理和数值细节：\n- 几何形状和参数：$R_0 = 1.8 \\, \\mathrm{m}$，$q = 1.7$（无量纲），$\\epsilon = 0.25$（无量纲），以及粒子速度 $v = 1.0 \\times 10^6 \\, \\mathrm{m/s}$。\n- $\\theta$ 的角度单位：弧度。\n- 捕获螺距参数范围为 $1/(1+\\epsilon) \\le \\lambda \\le 1/(1-\\epsilon)$。使用以下五个 $\\lambda$ 值的测试套件来测试不同的区域：\n  - 理想情况的中度捕获：$\\lambda = 0.90$。\n  - 中度捕获：$\\lambda = 1.05$。\n  - 更深度捕获：$\\lambda = 1.20$。\n  - 靠近下边界（深度捕获）但有限：$\\lambda = \\frac{1}{1+\\epsilon} + 10^{-3}$。\n  - 靠近上边界（临界捕獲）但有限：$\\lambda = \\frac{1}{1-\\epsilon} - 10^{-3}$。\n- 计算反弹周期 $\\tau_b(\\lambda)$（单位：秒）和无量纲量 $\\langle \\cos\\theta \\rangle_b$。\n- 对于数值积分，需要稳健地处理反弹点处端点的可积奇点，并确保高精度。\n\n验收标准和要求的输出：\n- 对于每个测试用例，计算反弹周期的相对差异，\n  $$\\delta_{\\tau} = \\left|\\tau_b^{\\mathrm{num}} - \\tau_b^{\\mathrm{ana}}\\right| \\Big/ \\left|\\tau_b^{\\mathrm{ana}}\\right|,$$\n  以及反弹平均的相对差异，\n  $$\\delta_{\\mathrm{avg}} = \\left|\\langle \\cos\\theta \\rangle_b^{\\mathrm{num}} - \\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}}\\right| \\Big/ \\max\\left(10^{-16}, \\left|\\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}}\\right|\\right)。$$\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表内容为结果，按测试用例和度量指标排序。具体来说，按以下顺序为每个测试用例列出相对差异\n  $$\\left[\\delta_{\\tau}^{(1)}, \\delta_{\\mathrm{avg}}^{(1)}, \\delta_{\\tau}^{(2)}, \\delta_{\\mathrm{avg}}^{(2)}, \\ldots, \\delta_{\\tau}^{(5)}, \\delta_{\\mathrm{avg}}^{(5)}\\right]。$$\n所有数值必须以国际单位制（SI）单位计算，其中 $\\tau_b$以秒表示。不允许使用百分比；请将相对差异报告为十进制浮点数。",
            "solution": "用户提供了一个来自等离子体物理学领域的适定问题，具体涉及托卡马克中的新经典输运理论。任务是为一个简化托卡马克模型中的捕获粒子推导并比较其反弹周期和极向角余弦的反弹平均的数值表达式和解析表达式。\n\n该问题的验证如下：\n- **科学依据**：该问题基于大环径比托卡马克中导心运动的标准教科书级模型。磁场、平行速度、捕获条件、反弹周期和反弹平均的定义在等离子体物理学中是经典的。所有方面在科学上都是合理的。\n- **适定性**：所有必需的参数（$R_0$、$q$、$\\epsilon$、$v$）和一个定义明确的螺距参数 $\\lambda$ 测试用例集均已提供。该问题要求推导沿磁力线微分长度 $d\\ell$ 与极向角微分 $d\\theta$ 之间的关系，这是此分析中的一个标准步骤。该问题是自洽的，其结构可得到唯一且有意义的解。被积函数具有可积奇点，这是该问题的一个已知特征，可以通过标准的数值方法处理。\n- **客观性**：该问题以精确、客观和技术性的语言陈述，没有模糊之处或主观论断。\n\n该问题被认为是有效的。解决方案首先推导适用于数值计算的积分形式，然后推导以完全椭圆积分表示的解析表达式，最后实现一个程序来计算两者并进行比较。\n\n### 第1部分：数值计算的推导\n\n给定反弹周期 $\\tau_b$ 和用于计算反弹平均 $\\langle \\cos\\theta \\rangle_b$ 的辅助积分 $I_c$ 的定义：\n$$\n\\tau_b(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{d\\ell}{v_{\\parallel}(\\theta)}\n$$\n$$\nI_c(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{\\cos\\theta \\, d\\ell}{v_{\\parallel}(\\theta)}\n$$\n$$\n\\langle \\cos\\theta \\rangle_b = \\frac{I_c(\\lambda)}{\\tau_b(\\lambda)}\n$$\n\n平行速度由 $v_{\\parallel}(\\theta) = v \\sqrt{1 - \\lambda \\left(1 - \\epsilon \\cos\\theta\\right)}$ 给出。反弹点 $\\pm \\theta_b$ 是平行速度为零的极向角，$v_{\\parallel}(\\pm \\theta_b) = 0$。此条件导致：\n$$\n1 - \\lambda \\left(1 - \\epsilon \\cos\\theta_b\\right) = 0 \\implies 1 - \\lambda + \\lambda\\epsilon\\cos\\theta_b = 0\n$$\n求解 $\\cos\\theta_b$ 即可得到反弹点的位置：\n$$\n\\cos\\theta_b = \\frac{\\lambda - 1}{\\lambda\\epsilon}\n$$\n因此反弹角为 $\\theta_b = \\arccos\\left(\\frac{\\lambda-1}{\\lambda\\epsilon}\\right)$。积分限为从 $-\\theta_b$ 到 $\\theta_b$。\n\n沿磁力线的微分长度元 $d\\ell$ 与极向角微分 $d\\theta$ 在大环径比、圆截面托卡马克中通过 $d\\ell \\approx qR_0 d\\theta$ 相关联。这里，$q$ 是安全因子，$R_0$ 是大半径。此关系源于考虑螺旋磁力线的螺距。\n\n将 $d\\ell$ 和 $v_{\\parallel}(\\theta)$ 代入积分，并注意到被积函数是 $\\theta$ 的偶函数，我们可以将积分范围从 $[-\\theta_b, \\theta_b]$ 简化为 $[0, \\theta_b]$ 并再乘以一个因子2：\n$$\n\\tau_b(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{qR_0 d\\theta}{v \\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}} = \\frac{4qR_0}{v} \\int_{0}^{\\theta_b} \\frac{d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\n$$\n类似地，对于反弹平均的分子：\n$$\nI_c(\\lambda) = \\frac{4qR_0}{v} \\int_{0}^{\\theta_b} \\frac{\\cos\\theta \\, d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\n$$\n反弹平均则为 $\\langle \\cos\\theta \\rangle_b = I_c(\\lambda) / \\tau_b(\\lambda)$。这些形式适用于数值求积。注意，在积分上限 $\\theta = \\theta_b$ 处，分母趋于零，产生一个可积奇点，必须由数值程序处理。\n\n### 第2部分：解析表达式的推导\n\n为了找到解析解，我们将积分变换为完全椭圆积分的标准形式。首先，我们使用半角恒等式重写平方根下的项：\n$$\n\\cos\\theta = 1 - 2\\sin^2(\\theta/2)\n$$\n$$\n\\cos\\theta_b = 1 - 2\\sin^2(\\theta_b/2)\n$$\n表达式 $\\cos\\theta - \\cos\\theta_b$ 变为 $2(\\sin^2(\\theta_b/2) - \\sin^2(\\theta/2))$。\n根式中的项为：\n$$\n1 - \\lambda + \\lambda\\epsilon\\cos\\theta = \\lambda\\epsilon\\left(\\frac{1-\\lambda}{\\lambda\\epsilon} + \\cos\\theta\\right) = \\lambda\\epsilon(\\cos\\theta - \\cos\\theta_b) = 2\\lambda\\epsilon\\left(\\sin^2(\\frac{\\theta_b}{2}) - \\sin^2(\\frac{\\theta}{2})\\right)\n$$\n让我们定义一个参数 $m$（在文献中通常表示为 $k^2$）为 $m = \\sin^2(\\theta_b/2)$。使用正弦的半角公式：\n$$\nm = \\sin^2(\\frac{\\theta_b}{2}) = \\frac{1 - \\cos\\theta_b}{2} = \\frac{1 - \\frac{\\lambda-1}{\\lambda\\epsilon}}{2} = \\frac{\\lambda\\epsilon - \\lambda + 1}{2\\lambda\\epsilon}\n$$\n根式现在是 $\\sqrt{2\\lambda\\epsilon(m - \\sin^2(\\theta/2))}$。积分变为：\n$$\n\\tau_b(\\lambda) = \\frac{4qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\theta_b} \\frac{d\\theta}{\\sqrt{m - \\sin^2(\\theta/2)}}\n$$\n$$\nI_c(\\lambda) = \\frac{4qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\theta_b} \\frac{\\cos\\theta \\, d\\theta}{\\sqrt{m - \\sin^2(\\theta/2)}}\n$$\n我们引入变量替换：$\\sin(\\theta/2) = \\sqrt{m} \\sin\\psi$。\n微分是 $\\frac{1}{2}\\cos(\\theta/2)d\\theta = \\sqrt{m}\\cos\\psi d\\psi$，这给出 $d\\theta = \\frac{2\\sqrt{m}\\cos\\psi d\\psi}{\\cos(\\theta/2)} = \\frac{2\\sqrt{m}\\cos\\psi d\\psi}{\\sqrt{1 - m\\sin^2\\psi}}$。\n$\\psi$ 的积分限是从 $0$ 到 $\\pi/2$。被积函数中平方根内的项变为 $\\sqrt{m - m\\sin^2\\psi} = \\sqrt{m}\\cos\\psi$。\n\n代入 $\\tau_b(\\lambda)$ 的积分中：\n$$\n\\tau_b(\\lambda) = \\frac{4qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\pi/2} \\frac{1}{\\sqrt{m}\\cos\\psi} \\frac{2\\sqrt{m}\\cos\\psi d\\psi}{\\sqrt{1 - m\\sin^2\\psi}} = \\frac{8qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\pi/2} \\frac{d\\psi}{\\sqrt{1 - m\\sin^2\\psi}}\n$$\n该积分是第一类完全椭圆积分 $K(m)$ 的定义。\n$$\n\\tau_b^{\\mathrm{ana}}(\\lambda) = \\frac{8qR_0}{v\\sqrt{2\\lambda\\epsilon}} K(m) = \\frac{4\\sqrt{2}qR_0}{v\\sqrt{\\lambda\\epsilon}} K(m)\n$$\n对于反弹平均，我们用 $\\psi$ 表示 $\\cos\\theta$：$\\cos\\theta = 1 - 2\\sin^2(\\theta/2) = 1 - 2m\\sin^2\\psi$。\n$$\nI_c(\\lambda) = \\frac{8qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\pi/2} \\frac{1 - 2m\\sin^2\\psi}{\\sqrt{1 - m\\sin^2\\psi}} d\\psi\n$$\n这个积分可以分解为：$\\int \\frac{d\\psi}{\\sqrt{...}} - 2m \\int \\frac{\\sin^2\\psi}{\\sqrt{...}} d\\psi$。第一部分是 $K(m)$。第二部分与第二类完全椭圆积分 $E(m) = \\int_{0}^{\\pi/2} \\sqrt{1-m\\sin^2\\psi} d\\psi$ 相关。\n根据关系式 $K(m) - E(m) = m\\int_{0}^{\\pi/2} \\frac{\\sin^2\\psi}{\\sqrt{1 - m\\sin^2\\psi}} d\\psi$，$I_c$ 的积分计算结果为 $K(m) - 2(K(m) - E(m)) = 2E(m) - K(m)$。\n$$\nI_c(\\lambda) = \\frac{4\\sqrt{2}qR_0}{v\\sqrt{\\lambda\\epsilon}} \\left( 2E(m) - K(m) \\right)\n$$\n反弹平均是 $I_c$ 与 $\\tau_b$ 的比值：\n$$\n\\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}} = \\frac{I_c(\\lambda)}{\\tau_b(\\lambda)} = \\frac{2E(m) - K(m)}{K(m)} = \\frac{2E(m)}{K(m)} - 1\n$$\n\n### 公式摘要\n- **参数**：$R_0=1.8\\,\\mathrm{m}$，$q=1.7$，$\\epsilon=0.25$，$v=1.0 \\times 10^6\\,\\mathrm{m/s}$。\n- **数值计算**：\n    - $\\theta_b = \\arccos\\left(\\frac{\\lambda-1}{\\lambda\\epsilon}\\right)$\n    - $\\tau_b^{\\mathrm{num}} = \\frac{4qR_0}{v} \\int_{0}^{\\theta_b} (1 - \\lambda + \\lambda\\epsilon\\cos\\theta)^{-1/2} d\\theta$\n    - $\\langle \\cos\\theta \\rangle_b^{\\mathrm{num}} = \\left(\\int_{0}^{\\theta_b} \\frac{\\cos\\theta \\, d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\\right) \\Big/ \\left(\\int_{0}^{\\theta_b} \\frac{d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\\right)$\n- **解析计算**：\n    - $m = \\frac{1-\\lambda+\\lambda\\epsilon}{2\\lambda\\epsilon}$\n    - $\\tau_b^{\\mathrm{ana}} = \\frac{4\\sqrt{2}qR_0}{v\\sqrt{\\lambda\\epsilon}} K(m)$\n    - $\\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}} = \\frac{2E(m)}{K(m)} - 1$\n这里 $K(m)$ 和 $E(m)$ 分别是第一类和第二类完全椭圆积分，可在 SciPy 中获得。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import special\n\ndef solve():\n    \"\"\"\n    Implements the solution to calculate and compare numerical and analytical\n    expressions for bounce period and bounce-averaged quantities for trapped\n    particles in a tokamak.\n    \"\"\"\n    # Define physical and geometrical constants from the problem statement.\n    R0 = 1.8  # Major radius in meters\n    q_factor = 1.7   # Safety factor (dimensionless)\n    eps = 0.25 # Inverse aspect ratio (dimensionless)\n    v = 1.0e6 # Particle speed in m/s\n    \n    # Define the suite of test cases for the pitch parameter lambda.\n    # The trapped particle domain is [1/(1+eps), 1/(1-eps)].\n    lambda_min = 1.0 / (1.0 - eps)  # Model B(th)=B0(1-eps*cos(th)) -> Bmin at th=0, Bmax at th=pi\n    lambda_max = 1.0 / (1.0 + eps)  # This is the range for passing particles.\n    \n    # The problem asks for the *trapped* range.\n    # v_par^2 = v^2 * (1 - lam*(1-eps*cos(th)))\n    # Reflection point exists if 1-lam(1-eps)  0 => lam > 1/(1-eps)\n    # AND particle does not pass th=pi, i.e. v_par^2(pi)  0\n    # 1 - lam(1+eps)  0 => lam > 1/(1+eps)\n    # The problem states trapping occurs for 1/(1+eps) = lam = 1/(1-eps).\n    # This is for B(th) = B0*(1+eps*cos(th)). Let's use the problem's field.\n    # B(th) = B0(1-eps*cos(th)). Bmin = B0(1-eps) at th=0. Bmax = B0(1+eps) at th=pi.\n    # Passing condition: E > mu*Bmax => E > (E*lam/B0) * B0(1+eps) => 1 > lam(1+eps) => lam  1/(1+eps)\n    # Trapping condition: lam > 1/(1+eps).\n    # And must be able to exist at Bmin: E > mu*Bmin => 1 > lam(1-eps) => lam  1/(1-eps)\n    # So the trapped range is 1/(1+eps)  lam  1/(1-eps).\n    lam_trap_min = 1.0 / (1.0 + eps)\n    lam_trap_max = 1.0 / (1.0 - eps)\n\n    test_cases = [\n        0.90,\n        1.05,\n        1.20,\n        lam_trap_min + 1e-3,\n        lam_trap_max - 1e-3\n    ]\n    \n    results = []\n\n    for lam in test_cases:\n        # --- Numerical Calculation ---\n        \n        cos_theta_b = (lam - 1.0) / (lam * eps)\n        cos_theta_b_clipped = np.clip(cos_theta_b, -1.0, 1.0)\n        theta_b = np.arccos(cos_theta_b_clipped)\n        \n        def integrand_tau(theta, lam_val, eps_val):\n            return 1.0 / np.sqrt(1.0 - lam_val + lam_val * eps_val * np.cos(theta))\n\n        def integrand_cos_avg(theta, lam_val, eps_val):\n            return np.cos(theta) * integrand_tau(theta, lam_val, eps_val)\n\n        tau_integral_val, _ = integrate.quad(\n            integrand_tau, 0, theta_b, args=(lam, eps), points=[theta_b]\n        )\n        cos_integral_val, _ = integrate.quad(\n            integrand_cos_avg, 0, theta_b, args=(lam, eps), points=[theta_b]\n        )\n        \n        tau_b_num = 4.0 * q_factor * R0 / v * tau_integral_val\n        if abs(tau_integral_val) > 1e-12:\n            cos_avg_num = cos_integral_val / tau_integral_val\n        else: # Avoid division by zero for non-trapped cases (though not expected here)\n            cos_avg_num = 0\n\n        # --- Analytical Calculation ---\n\n        m = (1.0 - lam + lam * eps) / (2.0 * lam * eps)\n        m_clipped = np.clip(m, 0.0, 1.0)\n        \n        K_m = special.ellipk(m_clipped)\n        E_m = special.ellipe(m_clipped)\n        \n        tau_b_ana = (4.0 * np.sqrt(2.0) * q_factor * R0) / (v * np.sqrt(lam * eps)) * K_m\n        if abs(K_m) > 1e-12:\n            cos_avg_ana = (2.0 * E_m / K_m) - 1.0\n        else: # Avoid division by zero\n            cos_avg_ana = 0\n\n        # --- Comparison ---\n        \n        delta_tau = np.abs(tau_b_num - tau_b_ana) / np.abs(tau_b_ana)\n        delta_avg = np.abs(cos_avg_num - cos_avg_ana) / np.maximum(1e-16, np.abs(cos_avg_ana))\n\n        results.extend([delta_tau, delta_avg])\n\n    output_str = \"[\" + \", \".join(f\"{res:.8e}\" for res in results) + \"]\"\n    return output_str\n\nprint(solve())\n```"
        }
    ]
}