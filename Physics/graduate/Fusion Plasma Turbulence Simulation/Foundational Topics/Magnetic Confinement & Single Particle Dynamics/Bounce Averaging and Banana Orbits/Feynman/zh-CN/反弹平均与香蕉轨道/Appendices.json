{
    "hands_on_practices": [
        {
            "introduction": "在托卡马克等离子体中，由于磁镜效应，并非所有粒子都能完成完整的环向和极向运动。相当一部分粒子被“捕获”，在磁场较弱的区域来回反弹，形成所谓的“香蕉轨道”。这个练习将引导你通过计算捕获粒子占总粒子数的比例 $f_t$，来量化这一重要粒子群体的规模，这是理解新经典输运和捕获粒子不稳定性等现象的关键第一步。",
            "id": "4182238",
            "problem": "在一个具有圆形同心磁通面的大环径比（LAR）托卡马克中，环向磁场的大小主要因大半径的变化而沿着磁力线变化。使用经过充分检验的近似，即环向磁场与 $B \\propto 1/R$ 成比例，设小半径为 $r$（其中 $r \\ll R_{0}$）的给定磁通面上的磁场为\n$$\nB(\\theta) \\approx \\frac{B_{0}}{1 + \\epsilon \\cos\\theta},\n$$\n其中 $R_{0}$ 是大半径，$\\epsilon \\doteq r/R_{0} \\ll 1$ 是反环径比，$\\theta$ 是极向角（以弧度为单位），$B_{0}$ 是一个常数，其选择使得 $B(\\theta=0)=B_{0}/(1+\\epsilon)$ 为外侧中平面场。考虑一个质量为 $m$、电荷为 $q$ 的无碰撞导心粒子，其动力学由总动能 $E = \\tfrac{1}{2} m v^{2}$ 和磁矩 $\\mu = m v_{\\perp}^{2}/(2 B)$ 的守恒决定，其中 $v$ 是速率，$v_{\\perp}$ 是垂直于磁场的速度分量。将外侧中平面（$\\theta = 0$ 处）的螺距角余弦定义为 $\\xi \\doteq v_{\\parallel}/v$，其中 $v_{\\parallel}$ 是此处的平行速度。\n\n如果一个粒子的平行速度 $v_{\\parallel}$ 在完成一次完整的极向渡越之前的某个极向角处变为零，则该粒子被称为捕获粒子，否则称为通行粒子。在回旋动理学湍流模型中，弹跳平均使用磁通面上的捕获粒子份额 $f_{t}$ 作为一个关键权重。\n\n假设外侧中平面的速度分布是各向同性的麦克斯韦分布，\n$$\nf_{M}(\\mathbf{v}) = n \\left(\\frac{m}{2 \\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2 T}\\right),\n$$\n其中密度为 $n$，温度为 $T$，且分布在速度空间中是各向同性的，计算给定磁通面上捕获粒子份额 $f_{t}$ 关于 $\\epsilon$ 的领头阶。你的推导应从 $E$ 和 $\\mu$ 的守恒以及给定的 $B(\\theta)$ 出发，得到以 $\\xi$ 表示的捕获区域条件，然后对麦克斯韦速度分布进行适当的平均。将你的最终答案表示为一个关于 $\\epsilon$ 的、精确到 $\\epsilon$ 领头阶且不含单位的单一闭合形式解析表达式。不要提供不等式或方程作为最终答案。",
            "solution": "问题要求计算在大环径比托卡马克中，给定磁通面上的捕获粒子份额，结果要求到反环径比 $\\epsilon$ 的领头阶。我们已知磁场模型、带电粒子的运动不变量以及外侧中平面上的速度分布函数。\n\n首先，我们建立粒子被捕获的条件。粒子的运动由动能 $E$ 和磁矩 $\\mu$ 的守恒决定。\n动能为 $E = \\frac{1}{2}mv^2$，其中 $m$ 是粒子质量，$v$ 是其速率。由于 $E$ 守恒，对于给定的粒子，其速率 $v$ 是恒定的。\n磁矩为 $\\mu = \\frac{mv_{\\perp}^2}{2B}$，其中 $v_{\\perp}$ 是垂直于磁场 $\\mathbf{B}$ 的速度分量，$B=|\\mathbf{B}|$。由于 $\\mu$ 也守恒，比值 $v_{\\perp}^2/B$ 沿着粒子轨迹是恒定的。\n\n总速率的平方为 $v^2 = v_{\\parallel}^2 + v_{\\perp}^2$，其中 $v_{\\parallel}$ 是平行于 $\\mathbf{B}$ 的速度分量。我们可以将磁力线上任意点的 $v_{\\parallel}^2$ 表示为当地磁场 $B(\\theta)$ 的函数：\n$v_{\\parallel}^2(\\theta) = v^2 - v_{\\perp}^2(\\theta)$。\n利用 $\\mu$ 的守恒，我们有 $v_{\\perp}^2(\\theta) = \\frac{2B(\\theta)\\mu}{m}$。因此，\n$$v_{\\parallel}^2(\\theta) = v^2 - \\frac{2B(\\theta)\\mu}{m}.$$\n为了计算 $\\mu$，我们使用外侧中平面（极向角 $\\theta=0$ 处）的初始条件。在此位置，磁场为 $B(0)$。螺距角余弦定义为 $\\xi \\doteq v_{\\parallel,0}/v$，其中 $v_{\\parallel,0}$ 是 $\\theta=0$ 处的平行速度。\n在 $\\theta=0$ 处的垂直速度由 $v_{\\perp,0}^2 = v^2 - v_{\\parallel,0}^2 = v^2 - \\xi^2 v^2 = v^2(1-\\xi^2)$ 给出。\n磁矩现在可以用这些中平面上的量来表示：\n$$\\mu = \\frac{m v_{\\perp,0}^2}{2B(0)} = \\frac{m v^2 (1-\\xi^2)}{2B(0)}.$$\n将这个 $\\mu$ 的表达式代回到 $v_{\\parallel}^2(\\theta)$ 的方程中，我们得到：\n$$v_{\\parallel}^2(\\theta) = v^2 \\left( 1 - \\frac{B(\\theta)}{B(0)}(1-\\xi^2) \\right).$$\n如果一个粒子的平行速度 $v_{\\parallel}$ 在某个称为“弹跳点”的极向角 $\\theta_b$ 处变为零，则该粒子被定义为捕获粒子。在这一点，粒子反转其平行的运动方向。一个粒子要被捕获，它必须在完成一次完整的极向渡越之前，即在到达磁场最大值点之前，有一个弹跳点。\n给定的磁场为 $B(\\theta) = \\frac{B_0}{1 + \\epsilon \\cos\\theta}$。该场在外侧中平面（$\\theta=0$）处为最小值，$B_{min} = B(0) = \\frac{B_0}{1+\\epsilon}$，在内侧中平面（$\\theta=\\pi$）处为最大值，$B_{max} = B(\\pi) = \\frac{B_0}{1-\\epsilon}$。\n\n如果一个粒子的平行动能在任何地方（包括磁场最大值点）都保持非负，它就是通行粒子。相反，如果一个粒子的平行动能在磁场最大值点会变为负值（这在物理上是不可能的，意味着它必须在该点之前反射），它就是捕获粒子。因此，捕获条件是 $v_{\\parallel}^2(\\pi)  0$：\n$$v^2 \\left( 1 - \\frac{B(\\pi)}{B(0)}(1-\\xi^2) \\right)  0.$$\n由于 $v^2 > 0$，这可以简化为：\n$$1  \\frac{B_{max}}{B_{min}}(1-\\xi^2) \\implies 1-\\xi^2 > \\frac{B_{min}}{B_{max}} \\implies \\xi^2  1 - \\frac{B_{min}}{B_{max}}.$$\n现在，我们计算比值 $\\frac{B_{min}}{B_{max}}$：\n$$\\frac{B_{min}}{B_{max}} = \\frac{B_0/(1+\\epsilon)}{B_0/(1-\\epsilon)} = \\frac{1-\\epsilon}{1+\\epsilon}.$$\n关于螺距角余弦 $\\xi$ 的捕获条件是：\n$$\\xi^2  1 - \\frac{1-\\epsilon}{1+\\epsilon} = \\frac{(1+\\epsilon) - (1-\\epsilon)}{1+\\epsilon} = \\frac{2\\epsilon}{1+\\epsilon}.$$\n对于大环径比极限情况，即 $\\epsilon \\ll 1$，我们可以将此表达式展开到领头阶：\n$$\\frac{2\\epsilon}{1+\\epsilon} = 2\\epsilon(1+\\epsilon)^{-1} \\approx 2\\epsilon(1-\\epsilon) \\approx 2\\epsilon.$$\n因此，对于 $\\epsilon$ 的领头阶，粒子被捕获的条件是 $|\\xi|  \\sqrt{2\\epsilon}$。\n\n接下来，我们计算捕获粒子的份额 $f_t$。这是捕获粒子的数密度与总数密度的比值。鉴于外侧中平面的速度分布 $f_M(\\mathbf{v})$ 是各向同性的（仅取决于速率 $v=|\\mathbf{v}|$)，在速度空间某一区域内的粒子份额就是该区域的立体角与总立体角（$4\\pi$ 球面度）的比值。\n$$f_t = \\frac{\\int_{\\text{trapped}} f_M(\\mathbf{v}) d^3v}{\\int_{\\text{all}} f_M(\\mathbf{v}) d^3v}$$\n在速度空间的球坐标系 $(v, \\alpha, \\phi)$ 中，其中 $\\alpha$ 是相对于 $\\mathbf{B}$ 的角度，使得 $\\xi = \\cos(\\alpha)$，速度空间体积元为 $d^3v = v^2 dv \\sin\\alpha d\\alpha d\\phi = v^2 dv |d\\xi| d\\phi$。积分可以分离：\n$$f_t = \\frac{\\int_0^{\\infty} f_M(v) v^2 dv \\int_{\\text{trapped}} d\\Omega}{\\int_0^{\\infty} f_M(v) v^2 dv \\int_{\\text{all}} d\\Omega} = \\frac{\\Omega_{\\text{trapped}}}{\\Omega_{\\text{total}}}.$$\n总立体角为 $\\Omega_{\\text{total}} = \\int_0^{2\\pi} d\\phi \\int_{-1}^{1} d\\xi = 2\\pi \\cdot 2 = 4\\pi$。\n对应于捕获粒子区域 $|\\xi|  \\sqrt{2\\epsilon}$ 的立体角是：\n$$\\Omega_{\\text{trapped}} = \\int_0^{2\\pi} d\\phi \\int_{-\\sqrt{2\\epsilon}}^{\\sqrt{2\\epsilon}} d\\xi = 2\\pi \\left( \\sqrt{2\\epsilon} - (-\\sqrt{2\\epsilon}) \\right) = 2\\pi(2\\sqrt{2\\epsilon}) = 4\\pi\\sqrt{2\\epsilon}.$$\n捕获粒子的份额是这些立体角的比值：\n$$f_t = \\frac{\\Omega_{\\text{trapped}}}{\\Omega_{\\text{total}}} = \\frac{4\\pi\\sqrt{2\\epsilon}}{4\\pi} = \\sqrt{2\\epsilon}.$$\n这个结果已经是关于 $\\epsilon$ 的领头阶表达式。一个更严谨的方法是计算精确份额 $f_t = \\sqrt{\\frac{2\\epsilon}{1+\\epsilon}}$，然后对 $\\epsilon \\ll 1$ 进行展开，会得到相同的领头阶项：\n$$f_t = \\sqrt{2\\epsilon}(1+\\epsilon)^{-1/2} = \\sqrt{2\\epsilon} \\left(1 - \\frac{1}{2}\\epsilon + O(\\epsilon^2)\\right) = \\sqrt{2\\epsilon} - \\frac{1}{\\sqrt{2}}\\epsilon^{3/2} + \\dots$$\n领头项是 $\\sqrt{2\\epsilon}$。",
            "answer": "$$\\boxed{\\sqrt{2\\epsilon}}$$"
        },
        {
            "introduction": "为了简化捕获粒子在香蕉轨道上的复杂动力学，我们常常采用“弹跳平均”技术，即将物理量在一个完整的弹跳周期内进行平均。这个练习提供了一个全面的实践机会，你将推导弹跳周期 $\\tau_b$ 和弹跳平均量 $\\langle \\cos\\theta \\rangle_b$ 的精确解析解（以椭圆积分表示），并编写程序进行数值计算。通过将数值结果与解析解进行比较，你可以验证计算的准确性，这是计算物理学中确保模拟工具可靠性的核心技能。",
            "id": "4182194",
            "problem": "假设一个大环径比、圆形、同心的托卡马克平衡，其小反环径比为 $\\epsilon = r / R_0$，安全因子为 $q$，大半径为 $R_0$。考虑速率为 $v$ 的单一种类粒子在极向角坐标 $\\theta$（角度单位：弧度）中的导心运动。在大环径比近似下，磁场强度为 $B(\\theta) = B_0 \\left(1 - \\epsilon \\cos\\theta\\right)$，其中 $B_0$ 是参考磁场。定义螺距参数 $\\lambda$ 为 $\\lambda = \\mu B_0 / \\mathcal{E}$，其中 $\\mu$ 是磁矩，$\\mathcal{E}$ 是总能量，因此平行速度为 $v_{\\parallel}(\\theta) = v \\sqrt{1 - \\lambda \\, B(\\theta)/B_0} = v \\sqrt{1 - \\lambda \\left(1 - \\epsilon \\cos\\theta\\right)}$。当 $\\lambda$ 满足 $1/(1+\\epsilon) \\le \\lambda \\le 1/(1-\\epsilon)$ 时，会发生捕获运动，反弹点 $\\pm \\theta_b$ 由 $v_{\\parallel}(\\pm \\theta_b) = 0$ 确定。\n\n仅从这些基本原理（磁矩、能量守恒以及大环径比磁场变化）出发，执行以下操作：\n\n1. 推导一个数学上明确的程序，用于数值计算反弹周期 $\\tau_b(\\lambda)$（定义为从 $-\\theta_b$ 到 $+\\theta_b$ 再回到 $-\\theta_b$ 的时间）和反弹平均 $\\langle \\cos\\theta \\rangle_b$（定义为在一个反弹周期内 $\\cos\\theta$ 的时间平均值）。使用以下定义：\n   $$\\tau_b(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{d\\ell}{v_{\\parallel}(\\theta)}, \\quad \\langle \\cos\\theta \\rangle_b = \\frac{1}{\\tau_b(\\lambda)} \\, 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{\\cos\\theta \\, d\\ell}{v_{\\parallel}(\\theta)},$$\n   其中 $d\\ell$ 是沿磁力线的微分长度元。在大环径比、圆形极限下，通过一个常数度规因子将 $d\\ell$ 和 $d\\theta$ 联系起来，并将两个积分都只用 $\\theta$ 表示。\n\n2. 独立地，从第一性原理和适当的变量替换出发，推导 $\\tau_b(\\lambda)$ 和 $\\langle \\cos\\theta \\rangle_b$ 的大环径比解析表达式，用完全椭圆积分表示。\n\n3. 实现一个程序，对于一组给定的参数，该程序计算数值和解析值，并报告其相对差异以进行验证。\n\n需要使用的物理和数值细节：\n- 几何与参数：$R_0 = 1.8 \\, \\mathrm{m}$，$q = 1.7$（无量纲），$\\epsilon = 0.25$（无量纲），粒子速率 $v = 1.0 \\times 10^6 \\, \\mathrm{m/s}$。\n- $\\theta$ 的角度单位：弧度。\n- 捕获螺距参数范围为 $1/(1+\\epsilon) \\le \\lambda \\le 1/(1-\\epsilon)$。使用以下五个 $\\lambda$ 值的测试套件来测试不同区域：\n  - 典型中间捕获：$\\lambda = 0.90$。\n  - 中度捕获：$\\lambda = 1.05$。\n  - 强捕获：$\\lambda = 1.20$。\n  - 接近下边界（深度捕获）但有限：$\\lambda = \\frac{1}{1+\\epsilon} + 10^{-3}$。\n  - 接近上边界（边缘捕获）但有限：$\\lambda = \\frac{1}{1-\\epsilon} - 10^{-3}$。\n- 计算反弹周期 $\\tau_b(\\lambda)$（单位为秒）和无量纲量 $\\langle \\cos\\theta \\rangle_b$。\n- 对于数值积分，请稳健地处理反弹点处的端点可积奇点，并确保高精度。\n\n验收标准和要求输出：\n- 对于每个测试用例，计算反弹周期的相对差异，\n  $$\\delta_{\\tau} = \\left|\\tau_b^{\\mathrm{num}} - \\tau_b^{\\mathrm{ana}}\\right| \\Big/ \\left|\\tau_b^{\\mathrm{ana}}\\right|,$$\n  以及反弹平均的相对差异，\n  $$\\delta_{\\mathrm{avg}} = \\left|\\langle \\cos\\theta \\rangle_b^{\\mathrm{num}} - \\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}}\\right| \\Big/ \\max\\left(10^{-16}, \\left|\\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}}\\right|\\right).$$\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，并按测试用例和指标排序。具体而言，按以下顺序为每个测试用例列出相对差异：\n  $$\\left[\\delta_{\\tau}^{(1)}, \\delta_{\\mathrm{avg}}^{(1)}, \\delta_{\\tau}^{(2)}, \\delta_{\\mathrm{avg}}^{(2)}, \\ldots, \\delta_{\\tau}^{(5)}, \\delta_{\\mathrm{avg}}^{(5)}\\right].$$\n所有数值必须以国际单位制（SI）单位计算，其中 $\\tau_b$ 以秒表示。不允许使用百分比；将相对差异报告为十进制浮点数。",
            "solution": "用户提供了一个来自等离子体物理学领域的适定问题，具体涉及托卡马克中的新经典输运理论。任务是推导并比较简化托卡马克模型中捕获粒子的反弹周期和极向角余弦的反弹平均值的数值和解析表达式。\n\n该问题的验证如下：\n- **科学依据**：该问题基于大环径比托卡马克中导心运动的标准教科书级别模型。磁场、平行速度、捕获条件、反弹周期和反弹平均的定义在等离子体物理学中是规范的。所有方面在科学上都是合理的。\n- **适定性**：所有必需的参数（$R_0$, $q$, $\\epsilon$, $v$）以及螺距参数 $\\lambda$ 的一组明确定义的测试用例都已提供。问题要求推导磁力线微分长度 $d\\ell$ 和极向角微分 $d\\theta$ 之间的关系，这是该分析中的一个标准步骤。该问题是自洽的，其结构允许一个唯一且有意义的解。被积函数具有可积奇点，这是该问题的一个已知特征，可以通过标准数值方法处理。\n- **客观性**：问题以精确、客观和技术性的语言陈述，没有歧义或主观陈述。\n\n该问题被认为是有效的。解决方案首先推导适合数值计算的积分形式，然后推导以完全椭圆积分表示的解析表达式，最后实现一个程序来计算两者并进行比较。\n\n### 第1部分：为数值计算进行的推导\n\n我们给出了反弹周期 $\\tau_b$ 和用于反弹平均 $\\langle \\cos\\theta \\rangle_b$ 的辅助积分 $I_c$ 的定义：\n$$\n\\tau_b(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{d\\ell}{v_{\\parallel}(\\theta)}\n$$\n$$\nI_c(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{\\cos\\theta \\, d\\ell}{v_{\\parallel}(\\theta)}\n$$\n$$\n\\langle \\cos\\theta \\rangle_b = \\frac{I_c(\\lambda)}{\\tau_b(\\lambda)}\n$$\n\n平行速度由 $v_{\\parallel}(\\theta) = v \\sqrt{1 - \\lambda \\left(1 - \\epsilon \\cos\\theta\\right)}$ 给出。反弹点 $\\pm \\theta_b$ 是平行速度为零的极向角，$v_{\\parallel}(\\pm \\theta_b) = 0$。此条件导致：\n$$\n1 - \\lambda \\left(1 - \\epsilon \\cos\\theta_b\\right) = 0 \\implies 1 - \\lambda + \\lambda\\epsilon\\cos\\theta_b = 0\n$$\n求解 $\\cos\\theta_b$ 得到反弹点的位置：\n$$\n\\cos\\theta_b = \\frac{\\lambda - 1}{\\lambda\\epsilon}\n$$\n因此，反弹角为 $\\theta_b = \\arccos\\left(\\frac{\\lambda-1}{\\lambda\\epsilon}\\right)$。积分限为从 $-\\theta_b$ 到 $\\theta_b$。\n\n在大环径比、圆形托卡马克中，沿磁力线的微分长度元 $d\\ell$ 与极向角微分 $d\\theta$ 通过 $d\\ell \\approx qR_0 d\\theta$ 相关联。这里，$q$ 是安全因子，$R_0$ 是大半径。此关系源于考虑螺旋磁力线的螺距。\n\n将 $d\\ell$ 和 $v_{\\parallel}(\\theta)$ 代入积分，并注意到被积函数是 $\\theta$ 的偶函数，我们可以将积分范围从 $[-\\theta_b, \\theta_b]$ 简化为 $[0, \\theta_b]$ 并乘以另一个因子 $2$：\n$$\n\\tau_b(\\lambda) = 2 \\int_{-\\theta_b}^{\\theta_b} \\frac{qR_0 d\\theta}{v \\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}} = \\frac{4qR_0}{v} \\int_{0}^{\\theta_b} \\frac{d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\n$$\n类似地，对于反弹平均的分子：\n$$\nI_c(\\lambda) = \\frac{4qR_0}{v} \\int_{0}^{\\theta_b} \\frac{\\cos\\theta \\, d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\n$$\n然后，反弹平均为 $\\langle \\cos\\theta \\rangle_b = I_c(\\lambda) / \\tau_b(\\lambda)$。这些形式适合数值求积。请注意，分母在积分上限 $\\theta = \\theta_b$ 处变为零，产生一个可积奇点，必须由数值例程处理。\n\n### 第2部分：解析表达式的推导\n\n为了找到解析解，我们将积分转换为完全椭圆积分的标准形式。首先，我们使用半角恒等式重写平方根下的项：\n$$\n\\cos\\theta = 1 - 2\\sin^2(\\theta/2)\n$$\n$$\n\\cos\\theta_b = 1 - 2\\sin^2(\\theta_b/2)\n$$\n表达式 $\\cos\\theta - \\cos\\theta_b$ 变为 $2(\\sin^2(\\theta_b/2) - \\sin^2(\\theta/2))$。\n根式中的项为：\n$$\n1 - \\lambda + \\lambda\\epsilon\\cos\\theta = \\lambda\\epsilon\\left(\\frac{1-\\lambda}{\\lambda\\epsilon} + \\cos\\theta\\right) = \\lambda\\epsilon(\\cos\\theta - \\cos\\theta_b) = 2\\lambda\\epsilon\\left(\\sin^2(\\frac{\\theta_b}{2}) - \\sin^2(\\frac{\\theta}{2})\\right)\n$$\n我们定义一个参数 $m$（在文献中通常表示为 $k^2$）为 $m = \\sin^2(\\theta_b/2)$。使用正弦的半角公式：\n$$\nm = \\sin^2(\\frac{\\theta_b}{2}) = \\frac{1 - \\cos\\theta_b}{2} = \\frac{1 - \\frac{\\lambda-1}{\\lambda\\epsilon}}{2} = \\frac{\\lambda\\epsilon - \\lambda + 1}{2\\lambda\\epsilon}\n$$\n根式现在是 $\\sqrt{2\\lambda\\epsilon(m - \\sin^2(\\theta/2))}$。积分变为：\n$$\n\\tau_b(\\lambda) = \\frac{4qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\theta_b} \\frac{d\\theta}{\\sqrt{m - \\sin^2(\\theta/2)}}\n$$\n$$\nI_c(\\lambda) = \\frac{4qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\theta_b} \\frac{\\cos\\theta \\, d\\theta}{\\sqrt{m - \\sin^2(\\theta/2)}}\n$$\n我们引入变量替换：$\\sin(\\theta/2) = \\sqrt{m} \\sin\\psi$。\n微分是 $\\frac{1}{2}\\cos(\\theta/2)d\\theta = \\sqrt{m}\\cos\\psi d\\psi$，这给出 $d\\theta = \\frac{2\\sqrt{m}\\cos\\psi d\\psi}{\\cos(\\theta/2)} = \\frac{2\\sqrt{m}\\cos\\psi d\\psi}{\\sqrt{1 - m\\sin^2\\psi}}$。\n$\\psi$ 的积分限为从 $0$ 到 $\\pi/2$。被积函数中的平方根项变为 $\\sqrt{m - m\\sin^2\\psi} = \\sqrt{m}\\cos\\psi$。\n\n代入 $\\tau_b(\\lambda)$ 的积分中：\n$$\n\\tau_b(\\lambda) = \\frac{4qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\pi/2} \\frac{1}{\\sqrt{m}\\cos\\psi} \\frac{2\\sqrt{m}\\cos\\psi d\\psi}{\\sqrt{1 - m\\sin^2\\psi}} = \\frac{8qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\pi/2} \\frac{d\\psi}{\\sqrt{1 - m\\sin^2\\psi}}\n$$\n该积分是第一类完全椭圆积分 $K(m)$ 的定义。\n$$\n\\tau_b^{\\mathrm{ana}}(\\lambda) = \\frac{8qR_0}{v\\sqrt{2\\lambda\\epsilon}} K(m) = \\frac{4\\sqrt{2}qR_0}{v\\sqrt{\\lambda\\epsilon}} K(m)\n$$\n对于反弹平均，我们用 $\\psi$ 表示 $\\cos\\theta$：$\\cos\\theta = 1 - 2\\sin^2(\\theta/2) = 1 - 2m\\sin^2\\psi$。\n$$\nI_c(\\lambda) = \\frac{8qR_0}{v\\sqrt{2\\lambda\\epsilon}} \\int_{0}^{\\pi/2} \\frac{1 - 2m\\sin^2\\psi}{\\sqrt{1 - m\\sin^2\\psi}} d\\psi\n$$\n该积分可以分解为：$\\int \\frac{d\\psi}{\\sqrt{...}} - 2m \\int \\frac{\\sin^2\\psi}{\\sqrt{...}} d\\psi$。第一部分是 $K(m)$。第二部分与第二类完全椭圆积分 $E(m) = \\int_{0}^{\\pi/2} \\sqrt{1-m\\sin^2\\psi} d\\psi$ 相关。\n从关系式 $K(m) - E(m) = m\\int_{0}^{\\pi/2} \\frac{\\sin^2\\psi}{\\sqrt{1 - m\\sin^2\\psi}} d\\psi$， $I_c$ 的积分计算为 $K(m) - 2(K(m) - E(m)) = 2E(m) - K(m)$。\n$$\nI_c(\\lambda) = \\frac{4\\sqrt{2}qR_0}{v\\sqrt{\\lambda\\epsilon}} \\left( 2E(m) - K(m) \\right)\n$$\n反弹平均是 $I_c$ 与 $\\tau_b$ 的比值：\n$$\n\\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}} = \\frac{I_c(\\lambda)}{\\tau_b(\\lambda)} = \\frac{2E(m) - K(m)}{K(m)} = \\frac{2E(m)}{K(m)} - 1\n$$\n\n### 公式总结\n- **参数**：$R_0=1.8\\,\\mathrm{m}$，$q=1.7$，$\\epsilon=0.25$，$v=1.0 \\times 10^6\\,\\mathrm{m/s}$。\n- **数值计算**：\n    - $\\theta_b = \\arccos\\left(\\frac{\\lambda-1}{\\lambda\\epsilon}\\right)$\n    - $\\tau_b^{\\mathrm{num}} = \\frac{4qR_0}{v} \\int_{0}^{\\theta_b} (1 - \\lambda + \\lambda\\epsilon\\cos\\theta)^{-1/2} d\\theta$\n    - $\\langle \\cos\\theta \\rangle_b^{\\mathrm{num}} = \\left(\\int_{0}^{\\theta_b} \\frac{\\cos\\theta \\, d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\\right) \\Big/ \\left(\\int_{0}^{\\theta_b} \\frac{d\\theta}{\\sqrt{1 - \\lambda + \\lambda\\epsilon\\cos\\theta}}\\right)$\n- **解析计算**：\n    - $m = \\frac{1-\\lambda+\\lambda\\epsilon}{2\\lambda\\epsilon}$\n    - $\\tau_b^{\\mathrm{ana}} = \\frac{4\\sqrt{2}qR_0}{v\\sqrt{\\lambda\\epsilon}} K(m)$\n    - $\\langle \\cos\\theta \\rangle_b^{\\mathrm{ana}} = \\frac{2E(m)}{K(m)} - 1$\n此处 $K(m)$ 和 $E(m)$ 分别是第一类和第二类完全椭圆积分，可在 SciPy 中获得。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import special\n\ndef solve():\n    \"\"\"\n    Implements the solution to calculate and compare numerical and analytical\n    expressions for bounce period and bounce-averaged quantities for trapped\n    particles in a tokamak.\n    \"\"\"\n    # Define physical and geometrical constants from the problem statement.\n    R0 = 1.8  # Major radius in meters\n    q = 1.7   # Safety factor (dimensionless)\n    eps = 0.25 # Inverse aspect ratio (dimensionless)\n    v = 1.0e6 # Particle speed in m/s\n    \n    # Define the suite of test cases for the pitch parameter lambda.\n    # The trapped particle domain is [1/(1+eps), 1/(1-eps)].\n    lambda_min = 1.0 / (1.0 + eps)\n    lambda_max = 1.0 / (1.0 - eps)\n\n    test_cases = [\n        0.90,\n        1.05,\n        1.20,\n        lambda_min + 1e-3,\n        lambda_max - 1e-3\n    ]\n    \n    results = []\n\n    for lam in test_cases:\n        # --- Numerical Calculation ---\n        cos_theta_b = (lam - 1.0) / (lam * eps)\n        cos_theta_b_clipped = np.clip(cos_theta_b, -1.0, 1.0)\n        theta_b = np.arccos(cos_theta_b_clipped)\n        \n        def integrand_tau(theta, lam_val, eps_val):\n            return 1.0 / np.sqrt(1.0 - lam_val + lam_val * eps_val * np.cos(theta))\n\n        def integrand_cos_avg(theta, lam_val, eps_val):\n            return np.cos(theta) / np.sqrt(1.0 - lam_val + lam_val * eps_val * np.cos(theta))\n\n        tau_integral_val, _ = integrate.quad(\n            integrand_tau, 0, theta_b, args=(lam, eps), points=[theta_b], epsabs=1e-12, epsrel=1e-12\n        )\n        cos_integral_val, _ = integrate.quad(\n            integrand_cos_avg, 0, theta_b, args=(lam, eps), points=[theta_b], epsabs=1e-12, epsrel=1e-12\n        )\n        \n        tau_b_num = (4.0 * q * R0 / v) * tau_integral_val\n        if np.isclose(tau_integral_val, 0):\n            cos_avg_num = 0.0\n        else:\n            cos_avg_num = cos_integral_val / tau_integral_val\n\n        # --- Analytical Calculation ---\n        m = (1.0 - lam + lam * eps) / (2.0 * lam * eps)\n        \n        if 0 = m = 1:\n            K_m = special.ellipk(m)\n            E_m = special.ellipe(m)\n        else:\n            K_m, E_m = np.nan, np.nan\n        \n        tau_b_ana = (4.0 * np.sqrt(2.0) * q * R0) / (v * np.sqrt(lam * eps)) * K_m\n        \n        if np.isclose(K_m, 0) or np.isnan(K_m):\n            cos_avg_ana = np.nan\n        else:\n            cos_avg_ana = (2.0 * E_m / K_m) - 1.0\n\n        # --- Comparison ---\n        if np.isnan(tau_b_ana) or np.isclose(tau_b_ana, 0):\n            delta_tau = np.nan\n        else:\n            delta_tau = np.abs(tau_b_num - tau_b_ana) / np.abs(tau_b_ana)\n        \n        if np.isnan(cos_avg_ana):\n            delta_avg = np.nan\n        else:\n            delta_avg = np.abs(cos_avg_num - cos_avg_ana) / np.max([1e-16, np.abs(cos_avg_ana)])\n\n        results.extend([delta_tau, delta_avg])\n\n    output_str = \"[\" + \", \".join([f\"{res:.8e}\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "弹跳平均方法的最终效用体现在简化描述粒子分布函数演化的漂移动力学方程（DKE）上。这个问题将向你展示，如何运用弹跳平均将复杂的DKE转化为一个更易于处理的关于捕获粒子分布函数的常微分方程。通过求解这个包含源项和碰撞算符的模型方程，你将深入理解微观粒子轨道和碰撞过程如何共同决定等离子体的宏观输运特性。",
            "id": "4182192",
            "problem": "考虑一个具有同心圆形磁通量面的大环径比托卡马克，其中磁通量面上的磁场大小为 $B(\\theta) = B_0 \\left( 1 + \\epsilon \\cos \\theta \\right)$，且 $0  \\epsilon \\ll 1$。对于一个速率恒为 $v$ 的粒子，引入螺距角参数 $\\lambda = v_{\\perp}^{2}/(v^{2} B)$，并关注 $\\lambda$ 中的捕获粒子区域，该区域由 $\\lambda \\in [\\lambda_c, \\lambda_{\\max}]$ 给出，其中 $\\lambda_c = 1/B_{\\max}$ 和 $\\lambda_{\\max} = 1/B_{\\min}$，且 $B_{\\min} = B_0 (1 - \\epsilon)$ 和 $B_{\\max} = B_0 (1 + \\epsilon)$。令 $\\langle h \\rangle_b(\\lambda)$ 表示稳态下捕获粒子的微扰分布函数的弹跳平均非绝热部分。\n\n从漂移动力学方程（DKE）出发，在捕获区域内对香蕉轨道进行弹跳平均，通过一个在 $\\lambda$ 中带有弹跳阱因子的简单自伴扩散算符来模拟螺距角散射效应，并包含一个线性退相关汇。具体来说，假设稳态弹跳平均方程具有以下形式\n$$\n0 \\;=\\; S_0 \\, (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) \\;-\\; \\gamma \\, \\langle h \\rangle_b(\\lambda) \\;-\\; \\nu \\, \\frac{\\partial}{\\partial \\lambda} \\!\\left[ (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) \\, \\frac{\\partial}{\\partial \\lambda} \\langle h \\rangle_b(\\lambda) \\right],\n$$\n对于 $\\lambda \\in [\\lambda_c, \\lambda_{\\max}]$，其中 $S_0$ 是一个恒定的源振幅，$\\gamma  0$ 是一个线性汇率，$\\nu  0$ 是一个螺距角散射率。在弹跳点施加物理上一致的无通量边界条件，\n$$\n(\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) \\, \\frac{\\partial}{\\partial \\lambda} \\langle h \\rangle_b(\\lambda) \\;=\\; 0 \\quad \\text{在} \\quad \\lambda = \\lambda_c \\;\\text{和}\\; \\lambda = \\lambda_{\\max}.\n$$\n假设 $\\gamma \\neq 6 \\nu$。从第一性原理推导稳态捕获分布 $\\langle h \\rangle_b(\\lambda)$ 作为 $\\lambda$ 的函数的显式闭合形式表达式，该表达式仅用参数 $\\lambda_c$、$\\lambda_{\\max}$、$S_0$、$\\gamma$ 和 $\\nu$ 表示。给出 $\\langle h \\rangle_b(\\lambda)$ 的最终解析表达式。\n\n你的最终答案必须是单一闭合形式的解析表达式。不需要进行数值计算。",
            "solution": "用户提供了一个来自聚变等离子体湍流模拟领域的问题，具体涉及捕获粒子的弹跳平均动理学理论。\n\n### 步骤1：提取已知条件\n-   螺距角参数 $\\lambda$ 的定义域是捕获粒子区域 $\\lambda \\in [\\lambda_c, \\lambda_{\\max}]$。\n-   稳态弹跳平均漂移动力学方程给出如下：\n    $$\n    0 \\;=\\; S_0 \\, (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) \\;-\\; \\gamma \\, \\langle h \\rangle_b(\\lambda) \\;-\\; \\nu \\, \\frac{\\partial}{\\partial \\lambda} \\!\\left[ (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) \\, \\frac{\\partial}{\\partial \\lambda} \\langle h \\rangle_b(\\lambda) \\right]\n    $$\n-   参数为：恒定源振幅 $S_0$，线性汇率 $\\gamma  0$，以及螺距角散射率 $\\nu  0$。\n-   边界条件为无通量类型：\n    $$\n    (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) \\, \\frac{\\partial}{\\partial \\lambda} \\langle h \\rangle_b(\\lambda) \\;=\\; 0 \\quad \\text{在} \\quad \\lambda = \\lambda_c \\;\\text{和}\\; \\lambda = \\lambda_{\\max}\n    $$\n-   给定一个约束条件：$\\gamma \\neq 6 \\nu$。\n-   目标是找到 $\\langle h \\rangle_b(\\lambda)$ 的显式闭合形式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题描述了一个用于托卡马克等离子体中捕获粒子微扰分布函数的简化但标准的模型。该方程是一个带有模型碰撞算符（螺距角散射）和源/汇项的弹跳平均漂移动力学方程，这是等离子体输运理论中的一种常用方法。该模型在科学上是合理的，并且与指定的主题相关。\n2.  **适定性：** 该问题是关于 $\\langle h \\rangle_b(\\lambda)$ 在有限区间 $[\\lambda_c, \\lambda_{\\max}]$ 上的一个二阶线性常微分方程（ODE）。它提供了两个边界条件。要求单一显式解意味着唯一性。如下所示，在一个合理的物理假设下（由问题的结构所暗示），即系统在有源和耗散存在时具有唯一的稳态，该问题是适定的。\n3.  **客观性：** 该问题以精确的数学和物理语言陈述，没有歧义或主观论断。\n4.  **完整性和一致性：** 提供了所有必要的参数和条件。约束条件 $\\gamma \\neq 6\\nu$ 对于避免会使解复杂化的共振至关重要，这表明问题结构良好。整个设置是自洽的。\n\n### 结论\n该问题是有效的。这是一个来自理论等离子体物理的定义明确的边值问题。\n\n### 步骤3：解的推导\n控制方程是关于 $\\langle h \\rangle_b(\\lambda)$ 的一个二阶、线性、非齐次常微分方程。我们记 $H(\\lambda) = \\langle h \\rangle_b(\\lambda)$。该方程可以重新排列为：\n$$\n\\nu \\, \\frac{d}{d \\lambda} \\!\\left[ (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) \\, \\frac{d H}{d \\lambda} \\right] + \\gamma H(\\lambda) = S_0 \\, (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda)\n$$\n为简化方程，我们引入一个归一化变量 $x$，将区间 $[\\lambda_c, \\lambda_{\\max}]$ 映射到 $[-1, 1]$。令：\n$$\n\\lambda = \\frac{\\lambda_{\\max} + \\lambda_c}{2} + \\frac{\\lambda_{\\max} - \\lambda_c}{2} x\n$$\n这意味着 $x = \\frac{2\\lambda - (\\lambda_{\\max} + \\lambda_c)}{\\lambda_{\\max} - \\lambda_c}$。在这个变量替换下，我们有：\n$$\n\\frac{d}{d\\lambda} = \\frac{dx}{d\\lambda} \\frac{d}{dx} = \\frac{2}{\\lambda_{\\max} - \\lambda_c} \\frac{d}{dx}\n$$\n二次项变为：\n$$\n(\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) = \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 (1 - x^2)\n$$\n将这些代入ODE，我们得到关于 $H(x)$ 的方程：\n$$\n\\nu \\, \\frac{2}{\\lambda_{\\max} - \\lambda_c} \\frac{d}{dx} \\!\\left[ \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 (1 - x^2) \\, \\frac{2}{\\lambda_{\\max} - \\lambda_c} \\frac{dH}{dx} \\right] + \\gamma H(x) = S_0 \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 (1 - x^2)\n$$\n简化导数项：\n$$\n\\nu \\frac{d}{dx} \\left[ (1 - x^2) \\frac{dH}{dx} \\right] + \\gamma H(x) = S_0 \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 (1 - x^2)\n$$\n这是一个非齐次勒让德方程。左侧的算符是勒让德算符。此算符在区间 $[-1, 1]$ 上正则的特征函数是勒让德多项式 $P_n(x)$，满足：\n$$\n\\frac{d}{dx} \\left[ (1 - x^2) \\frac{d P_n}{dx} \\right] + n(n+1) P_n(x) = 0\n$$\n通解是齐次解 $H_h(x)$ 和特解 $H_p(x)$ 的和。一个物理上有意义的分布函数必须是有限的，因此我们要求解在 $x=\\pm 1$ 处是正则的。齐次方程 $\\nu \\frac{d}{dx} [(1-x^2) \\frac{dH_h}{dx}] + \\gamma H_h = 0$ 仅当 $\\gamma/\\nu = n(n+1)$（对于某个非负整数 $n$）时才有正则解（勒让德多项式）。问题要求唯一解，这意味着不应存在非平凡的齐次解。如果 $\\gamma/\\nu$ 不是一个特征值，情况就是如此。我们假设情况如此，这是由源驱动的唯一稳态的一个标准物理要求。因此，我们设 $H_h(x) = 0$，只需求解特解 $H_p(x)$。\n\n为了找到特解，我们将右侧的源项用勒让德多项式展开。我们注意到 $1-x^2$ 可以用 $P_0(x)=1$ 和 $P_2(x) = \\frac{1}{2}(3x^2-1)$ 来表示：\n$$\n1-x^2 = P_0(x) - \\left(\\frac{2}{3}P_2(x) + \\frac{1}{3}P_0(x)\\right) = \\frac{2}{3}P_0(x) - \\frac{2}{3}P_2(x)\n$$\n我们寻找形式为 $H_p(x) = c_0 P_0(x) + c_2 P_2(x)$ 的特解。将其代入ODE：\n$$\n\\nu \\left( c_0 \\frac{d}{dx}\\left[(1-x^2)\\frac{dP_0}{dx}\\right] + c_2 \\frac{d}{dx}\\left[(1-x^2)\\frac{dP_2}{dx}\\right] \\right) + \\gamma (c_0 P_0 + c_2 P_2) \\\\\n= S_0 \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 \\left(\\frac{2}{3}P_0 - \\frac{2}{3}P_2\\right)\n$$\n使用勒让德特征值性质 $\\frac{d}{dx}[(1-x^2)\\frac{dP_n}{dx}] = -n(n+1)P_n(x)$：\n$$\n\\nu \\left( -0(1) c_0 P_0 - 2(3) c_2 P_2 \\right) + \\gamma (c_0 P_0 + c_2 P_2) = \\frac{2S_0}{3} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 (P_0 - P_2)\n$$\n$$\n(\\gamma c_0) P_0(x) + (\\gamma - 6\\nu) c_2 P_2(x) = \\frac{2S_0}{3} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 P_0(x) - \\frac{2S_0}{3} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 P_2(x)\n$$\n通过令正交的勒让德多项式的系数相等，我们求出常数 $c_0$ 和 $c_2$。\n对于 $P_0(x)$：\n$$ \\gamma c_0 = \\frac{2S_0}{3} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 \\implies c_0 = \\frac{2S_0}{3\\gamma} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 $$\n对于 $P_2(x)$：\n$$ (\\gamma - 6\\nu) c_2 = -\\frac{2S_0}{3} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 \\implies c_2 = -\\frac{2S_0}{3(\\gamma - 6\\nu)} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 $$\n由于给定的条件 $\\gamma \\neq 6\\nu$，系数 $c_2$ 是良定义的。\n\n解为 $H(x) = H_p(x) = c_0 P_0(x) + c_2 P_2(x)$。代入 $c_0$ 和 $c_2$ 的表达式，以及 $P_0(x)=1$，$P_2(x) = \\frac{3}{2}x^2 - \\frac{1}{2}$：\n$$\nH(x) = \\frac{2S_0}{3} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 \\left[ \\frac{1}{\\gamma} - \\frac{1}{\\gamma - 6\\nu} \\left(\\frac{3}{2}x^2 - \\frac{1}{2}\\right) \\right]\n$$\n这个表达式可以简化为：\n$$\nH(x) = \\frac{S_0}{3} \\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2 \\left[ \\frac{2}{\\gamma} - \\frac{3x^2 - 1}{\\gamma - 6\\nu} \\right] \\\\\n= \\frac{S_0 (\\lambda_{\\max} - \\lambda_c)^2}{12\\gamma(\\gamma - 6\\nu)} \\left[ 2(\\gamma - 6\\nu) - \\gamma(3x^2 - 1) \\right] \\\\\n= \\frac{S_0 (\\lambda_{\\max} - \\lambda_c)^2}{12\\gamma(\\gamma - 6\\nu)} \\left[ 3\\gamma - 12\\nu - 3\\gamma x^2 \\right] \\\\\n= \\frac{S_0 (\\lambda_{\\max} - \\lambda_c)^2}{4\\gamma(\\gamma - 6\\nu)} \\left[ \\gamma(1 - x^2) - 4\\nu \\right]\n$$\n最后，我们变换回原始变量 $\\lambda$。我们使用前面推导的关系式：\n$$\n1 - x^2 = \\frac{(\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda)}{\\left(\\frac{\\lambda_{\\max} - \\lambda_c}{2}\\right)^2} = \\frac{4(\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda)}{(\\lambda_{\\max} - \\lambda_c)^2}\n$$\n将此代入 $H(x)$ 的表达式中：\n$$\n\\langle h \\rangle_b(\\lambda) = \\frac{S_0 (\\lambda_{\\max} - \\lambda_c)^2}{4\\gamma(\\gamma - 6\\nu)} \\left[ \\gamma \\frac{4(\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda)}{(\\lambda_{\\max} - \\lambda_c)^2} - 4\\nu \\right] \\\\\n= \\frac{S_0}{\\gamma(\\gamma - 6\\nu)} \\left[ \\gamma (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) - \\nu (\\lambda_{\\max} - \\lambda_c)^2 \\right]\n$$\n这就是稳态捕获粒子分布函数的最终闭合形式表达式。所施加的无通量边界条件被自动满足，因为这个解是关于 $\\lambda$ 的一个二次多项式，所以它的导数是线性的并且处处有限。因此，项 $(\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda)\\frac{d H}{d\\lambda}$ 在 $\\lambda=\\lambda_c$ 和 $\\lambda=\\lambda_{\\max}$ 处为零。",
            "answer": "$$\n\\boxed{\\frac{S_0}{\\gamma(\\gamma - 6\\nu)} \\left[ \\gamma (\\lambda - \\lambda_c)(\\lambda_{\\max} - \\lambda) - \\nu (\\lambda_{\\max} - \\lambda_c)^2 \\right]}\n$$"
        }
    ]
}