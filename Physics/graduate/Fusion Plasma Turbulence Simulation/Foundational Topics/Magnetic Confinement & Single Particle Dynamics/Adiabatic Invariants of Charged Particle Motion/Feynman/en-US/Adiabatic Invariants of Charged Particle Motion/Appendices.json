{
    "hands_on_practices": [
        {
            "introduction": "The conservation of the magnetic moment, $\\mu$, in a spatially varying magnetic field gives rise to a powerful concept: the mirror force. This force is responsible for reflecting charged particles from regions of strong magnetic field, forming the basis for magnetic trapping in both fusion devices and planetary magnetospheres. This practice provides a first-principles derivation of this force, asking you to connect the conservation of $\\mu$ and total kinetic energy to the change in a particle's parallel velocity as it moves along a magnetic field gradient . By working through this foundational problem, you will solidify your understanding of how the first adiabatic invariant governs particle motion and leads directly to confinement.",
            "id": "4180217",
            "problem": "A single charged particle of mass $m$ and charge $q$ moves in a static, linearly varying magnetic field $ \\mathbf{B}(z) = B_0 \\left(1 + \\alpha z \\right) \\hat{\\mathbf{z}} $, where $B_0 > 0$, $\\alpha$ is a constant with dimensions of inverse length, and $z$ is the coordinate along the magnetic field. There is no electric field, and non-magnetic forces are negligible. At $z=0$, the particle has perpendicular speed $v_{\\perp 0}$ and parallel speed $v_{\\parallel 0}$ relative to the local magnetic field direction. Assume the guiding-center approximation applies and the first adiabatic invariant (the magnetic moment) is conserved, under the ordering $\\alpha \\rho_L \\ll 1$, where the Larmor radius is $\\rho_L = v_{\\perp}/\\Omega$ and the gyrofrequency is $\\Omega = q B/m$. \n\nStarting from the Lorentz force law and the conservation of total kinetic energy in a static magnetic field, use the conservation of the first adiabatic invariant to derive, to leading order in the small parameter $\\alpha z$, the changes in the perpendicular and parallel speeds, $\\Delta v_{\\perp}(z) = v_{\\perp}(z) - v_{\\perp 0}$ and $\\Delta v_{\\parallel}(z) = v_{\\parallel}(z) - v_{\\parallel 0}$. Under the same ordering and assumptions, determine the parallel mirror force $F_{\\parallel}(z)$ exerted on the guiding center due to the magnetic field inhomogeneity. Express your final expressions in terms of the symbols $m$, $q$, $B_0$, $\\alpha$, $z$, $v_{\\perp 0}$, and $v_{\\parallel 0}$. Interpret the mirror force in International System of Units (SI) newtons, but do not attach units in the final boxed answer. Provide closed-form symbolic expressions valid to first order in $\\alpha z$. No numerical rounding is required.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- **Particle:** mass $m$, charge $q$.\n- **Magnetic Field:** $\\mathbf{B}(z) = B_0 \\left(1 + \\alpha z \\right) \\hat{\\mathbf{z}}$, where $B_0 > 0$ and $\\alpha$ is a constant.\n- **Electric Field:** $\\mathbf{E} = 0$.\n- **Other Forces:** Negligible.\n- **Initial Conditions (at $z=0$):** Perpendicular speed $v_{\\perp 0}$, parallel speed $v_{\\parallel 0}$.\n- **Assumptions:**\n    - Guiding-center approximation is valid.\n    - The first adiabatic invariant (magnetic moment, $\\mu$) is conserved.\n    - The ordering parameter $\\alpha \\rho_L \\ll 1$ holds, where $\\rho_L = v_{\\perp}/\\Omega$ and $\\Omega = q B/m$.\n- **Task:**\n    1. Derive the change in perpendicular speed, $\\Delta v_{\\perp}(z) = v_{\\perp}(z) - v_{\\perp 0}$, to leading order in $\\alpha z$.\n    2. Derive the change in parallel speed, $\\Delta v_{\\parallel}(z) = v_{\\parallel}(z) - v_{\\parallel 0}$, to leading order in $\\alpha z$.\n    3. Determine the parallel mirror force $F_{\\parallel}(z)$ under the same ordering.\n    4. Express results in terms of $m$, $q$, $B_0$, $\\alpha$, $z$, $v_{\\perp 0}$, and $v_{\\parallel 0}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem deals with the motion of a charged particle in an inhomogeneous magnetic field, a fundamental topic in plasma physics and electromagnetism. The concept of adiabatic invariants, specifically the magnetic moment, and the resulting mirror force are well-established and core to understanding phenomena like magnetic confinement in fusion devices and particle trapping in planetary magnetospheres. The linear approximation of the magnetic field, $B(z) = B_0(1 + \\alpha z)$, is a standard and valid approach for studying local dynamics. The problem is based on sound physical principles.\n- **Well-Posed:** The problem provides all necessary initial conditions ($v_{\\perp 0}$, $v_{\\parallel 0}$), the form of the magnetic field, and the governing conservation laws (conservation of energy and the first adiabatic invariant). This information is sufficient to uniquely determine the specified quantities ($\\Delta v_{\\perp}(z)$, $\\Delta v_{\\parallel}(z)$, $F_{\\parallel}(z)$) to the required order of approximation.\n- **Objective:** The problem is stated in precise, quantitative language, free of ambiguity, subjectivity, or opinion.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and complete. It is therefore deemed **valid**. The solution will now be derived.\n\nThe motion of the charged particle is governed by two fundamental conservation laws.\n\n**1. Conservation of Kinetic Energy:**\nThe Lorentz force, $\\mathbf{F} = q(\\mathbf{v} \\times \\mathbf{B})$, is always perpendicular to the particle's velocity $\\mathbf{v}$. Consequently, it does no work on the particle. Since the electric field is zero and other forces are negligible, the total kinetic energy $K$ of the particle is conserved.\nThe total kinetic energy is the sum of the kinetic energy associated with motion perpendicular to the magnetic field ($K_{\\perp}$) and parallel to it ($K_{\\parallel}$):\n$$K = K_{\\perp} + K_{\\parallel} = \\frac{1}{2}m v_{\\perp}^2 + \\frac{1}{2}m v_{\\parallel}^2$$\nConservation of energy implies:\n$$ \\frac{1}{2}m (v_{\\perp}(z)^2 + v_{\\parallel}(z)^2) = \\frac{1}{2}m (v_{\\perp 0}^2 + v_{\\parallel 0}^2) $$\n$$ v_{\\perp}(z)^2 + v_{\\parallel}(z)^2 = v_{\\perp 0}^2 + v_{\\parallel 0}^2 = \\text{constant} $$\n\n**2. Conservation of the First Adiabatic Invariant (Magnetic Moment):**\nThe problem states that the first adiabatic invariant, the magnetic moment $\\mu$, is conserved. The magnetic moment is defined as the ratio of the perpendicular kinetic energy to the magnitude of the magnetic field:\n$$ \\mu = \\frac{K_{\\perp}}{B} = \\frac{\\frac{1}{2} m v_{\\perp}^2}{B} $$\nConservation of $\\mu$ means:\n$$ \\frac{v_{\\perp}(z)^2}{B(z)} = \\frac{v_{\\perp 0}^2}{B_0} = \\text{constant} $$\nwhere $B(z) = |\\mathbf{B}(z)| = B_0(1 + \\alpha z)$ and $B(0) = B_0$.\n\nWe can now use these two principles to find the desired quantities.\n\n**Derivation of $\\Delta v_{\\perp}(z)$:**\nFrom the conservation of the magnetic moment, we have:\n$$ v_{\\perp}(z)^2 = v_{\\perp 0}^2 \\frac{B(z)}{B_0} = v_{\\perp 0}^2 \\frac{B_0(1 + \\alpha z)}{B_0} = v_{\\perp 0}^2 (1 + \\alpha z) $$\nTo find $v_{\\perp}(z)$, we take the square root:\n$$ v_{\\perp}(z) = v_{\\perp 0} \\sqrt{1 + \\alpha z} $$\nThe problem requires the result to leading order in the small parameter $\\alpha z$. We use the binomial approximation $\\sqrt{1+x} \\approx 1 + \\frac{1}{2}x$ for small $x$.\n$$ v_{\\perp}(z) \\approx v_{\\perp 0} \\left(1 + \\frac{1}{2} \\alpha z\\right) $$\nThe change in perpendicular speed, $\\Delta v_{\\perp}(z)$, is then:\n$$ \\Delta v_{\\perp}(z) = v_{\\perp}(z) - v_{\\perp 0} \\approx v_{\\perp 0} \\left(1 + \\frac{1}{2} \\alpha z\\right) - v_{\\perp 0} = \\frac{1}{2} v_{\\perp 0} \\alpha z $$\n\n**Derivation of $\\Delta v_{\\parallel}(z)$:**\nFrom the conservation of energy, we can express $v_{\\parallel}(z)^2$:\n$$ v_{\\parallel}(z)^2 = (v_{\\perp 0}^2 + v_{\\parallel 0}^2) - v_{\\perp}(z)^2 $$\nSubstituting the expression for $v_{\\perp}(z)^2$ from the conservation of $\\mu$:\n$$ v_{\\parallel}(z)^2 = (v_{\\perp 0}^2 + v_{\\parallel 0}^2) - v_{\\perp 0}^2 (1 + \\alpha z) = v_{\\parallel 0}^2 - v_{\\perp 0}^2 \\alpha z $$\nTo find $v_{\\parallel}(z)$, we take the square root:\n$$ v_{\\parallel}(z) = \\sqrt{v_{\\parallel 0}^2 - v_{\\perp 0}^2 \\alpha z} = v_{\\parallel 0} \\sqrt{1 - \\frac{v_{\\perp 0}^2}{v_{\\parallel 0}^2} \\alpha z} $$\nAgain, we use the binomial approximation $\\sqrt{1-x} \\approx 1 - \\frac{1}{2}x$ for small $x = \\frac{v_{\\perp 0}^2}{v_{\\parallel 0}^2} \\alpha z$:\n$$ v_{\\parallel}(z) \\approx v_{\\parallel 0} \\left(1 - \\frac{1}{2} \\frac{v_{\\perp 0}^2}{v_{\\parallel 0}^2} \\alpha z\\right) = v_{\\parallel 0} - \\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z $$\nThe change in parallel speed, $\\Delta v_{\\parallel}(z)$, is:\n$$ \\Delta v_{\\parallel}(z) = v_{\\parallel}(z) - v_{\\parallel 0} \\approx \\left(v_{\\parallel 0} - \\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z\\right) - v_{\\parallel 0} = -\\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z $$\n\n**Derivation of the Parallel Mirror Force $F_{\\parallel}(z)$:**\nThe parallel force on the guiding center, known as the mirror force, arises from the magnetic field gradient. It is given by the negative gradient of the perpendicular kinetic energy, which acts as a potential for the parallel motion.\n$$ F_{\\parallel} = -\\nabla_{\\parallel} (\\mu B) $$\nSince the field varies only in the $z$-direction, this simplifies to:\n$$ F_{\\parallel}(z) = -\\mu \\frac{d B}{dz} $$\nThe magnetic moment $\\mu$ is constant and can be evaluated at $z=0$:\n$$ \\mu = \\frac{\\frac{1}{2} m v_{\\perp 0}^2}{B_0} $$\nThe gradient of the magnetic field is:\n$$ \\frac{d B}{dz} = \\frac{d}{dz} \\left[ B_0 (1 + \\alpha z) \\right] = B_0 \\alpha $$\nSubstituting these into the expression for the force:\n$$ F_{\\parallel}(z) = - \\left( \\frac{\\frac{1}{2} m v_{\\perp 0}^2}{B_0} \\right) (B_0 \\alpha) = -\\frac{1}{2} m v_{\\perp 0}^2 \\alpha $$\nThis result is independent of $z$ because the magnetic field gradient is constant. This expression is exact under the assumption that $\\mu$ is conserved. It doesn't rely on the small $\\alpha z$ approximation itself, but it is derived under the same physical assumptions. If $\\alpha > 0$, the force is directed in the $-\\hat{\\mathbf{z}}$ direction, pushing the particle away from the stronger field region, hence the term \"mirror force\".\n\nThe three requested quantities are:\n1. $\\Delta v_{\\perp}(z) = \\frac{1}{2} v_{\\perp 0} \\alpha z$\n2. $\\Delta v_{\\parallel}(z) = -\\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z$\n3. $F_{\\parallel}(z) = -\\frac{1}{2} m v_{\\perp 0}^2 \\alpha$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} v_{\\perp 0} \\alpha z & -\\frac{v_{\\perp 0}^{2}}{2 v_{\\parallel 0}} \\alpha z & -\\frac{1}{2} m v_{\\perp 0}^{2} \\alpha\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the concept of static magnetic mirrors, this exercise explores the dynamics of a trapped particle when the confining magnetic field itself varies slowly in time. To solve this, you must simultaneously apply the conservation of both the first adiabatic invariant, $\\mu$, and the second adiabatic invariant, $J$. This hypothetical scenario is designed to illustrate how particles gain energy from a time-dependent \"moving\" mirror . Successfully deriving the evolution of the particle's perpendicular and parallel speeds will provide you with direct insight into the mechanisms of betatron acceleration (related to the conservation of $\\mu$) and Fermi acceleration (related to the conservation of $J$), which are fundamental processes for plasma heating.",
            "id": "4180181",
            "problem": "A single charged particle of mass $m$ and charge $q$ moves in a magnetic mirror field that is slowly ramped in time. The magnetic field magnitude along the field line is modeled as\n$$\nB(s,t) = B_{0}\\,(1+\\alpha t)\\,\\Big(1+\\frac{s^{2}}{L^{2}}\\Big),\n$$\nwhere $s$ is the arc-length coordinate along the field line with $s=0$ at the magnetic minimum, $B_{0}>0$ is the initial field strength scale at $t=0$, $\\alpha$ is a small parameter with dimensions of $\\mathrm{s}^{-1}$ controlling the ramp rate, and $L$ is a positive constant characterizing the mirror geometry. Assume the temporal variation is slow compared to both the cyclotron period and the bounce period so that the first and second adiabatic invariants are conserved to leading order.\n\nAt time $t=0$, the particle passes through the field minimum $s=0$ with perpendicular and parallel speeds $v_{\\perp 0}$ and $v_{\\parallel 0}$, respectively. The magnetic moment (first adiabatic invariant) is defined as\n$$\n\\mu = \\frac{m\\,v_{\\perp}^{2}}{2\\,B},\n$$\nand the bounce action (second adiabatic invariant) is defined as\n$$\nJ = \\oint v_{\\parallel}\\,ds,\n$$\nwhere the line integral is taken over one complete bounce between mirror points.\n\nUsing only the above definitions, conservation of $\\mu$ and $J$ under slow ramping, and basic kinematics, derive closed-form expressions for the perpendicular and parallel speeds at the field minimum, $v_{\\perp}(t)$ and $v_{\\parallel}(t)$, as functions of time $t$ and parameters $m$, $B_{0}$, $\\alpha$, $L$, $v_{\\perp 0}$, and $v_{\\parallel 0}$. Then, from first principles, explain how the mirror points and pitch angle at $s=0$ evolve with $t$ under the same assumptions.\n\nProvide your final answer as analytic expressions for $v_{\\perp}(t)$ and $v_{\\parallel}(t)$ at $s=0$ in terms of the given parameters. No numerical evaluation or rounding is required, and no units need be reported in the final expressions. State any intermediate physical quantities you introduce and justify each step in your derivation by referencing the definitions and conservation laws above.",
            "solution": "The problem is well-posed and scientifically grounded in the principles of plasma physics, specifically the adiabatic theory of charged particle motion. I will proceed with a solution based on the provided definitions and conservation laws.\n\nThe problem asks for the perpendicular and parallel speeds, $v_{\\perp}(t)$ and $v_{\\parallel}(t)$, at the magnetic minimum ($s=0$) as functions of time $t$. The solution relies on the conservation of the first and second adiabatic invariants, $\\mu$ and $J$.\n\nThe magnetic field is given by\n$$\nB(s,t) = B_{0}\\,(1+\\alpha t)\\,\\Big(1+\\frac{s^{2}}{L^{2}}\\Big)\n$$\nAt the midplane, $s=0$, the magnetic field is\n$$\nB(0,t) = B_{0}\\,(1+\\alpha t)\n$$\nAt the initial time $t=0$, the midplane field is $B(0,0) = B_0$.\n\n**Step 1: Conservation of the First Adiabatic Invariant ($\\mu$)**\n\nThe magnetic moment, $\\mu$, is defined as\n$$\n\\mu = \\frac{m\\,v_{\\perp}^{2}}{2\\,B}\n$$\nThe problem states that $\\mu$ is conserved under the slow temporal variation of the magnetic field. We can evaluate $\\mu$ at the initial time $t=0$ at the midplane $s=0$, where the particle has perpendicular speed $v_{\\perp 0}$ and the magnetic field is $B(0,0)=B_0$.\n$$\n\\mu = \\frac{m\\,v_{\\perp 0}^{2}}{2\\,B_0}\n$$\nThis value of $\\mu$ is constant for all time. At any later time $t$, the particle's perpendicular speed at the midplane is $v_{\\perp}(t)$, and the magnetic field is $B(0,t) = B_0(1+\\alpha t)$. The conservation of $\\mu$ implies:\n$$\n\\frac{m\\,v_{\\perp}(t)^{2}}{2\\,B(0,t)} = \\frac{m\\,v_{\\perp 0}^{2}}{2\\,B_0}\n$$\nSubstituting the expression for $B(0,t)$:\n$$\n\\frac{m\\,v_{\\perp}(t)^{2}}{2\\,B_{0}\\,(1+\\alpha t)} = \\frac{m\\,v_{\\perp 0}^{2}}{2\\,B_0}\n$$\nSolving for $v_{\\perp}(t)^{2}$:\n$$\nv_{\\perp}(t)^{2} = v_{\\perp 0}^{2}\\,(1+\\alpha t)\n$$\nTherefore, the perpendicular speed at the midplane as a function of time is:\n$$\nv_{\\perp}(t) = v_{\\perp 0}\\,\\sqrt{1+\\alpha t} = v_{\\perp 0}\\,(1+\\alpha t)^{1/2}\n$$\n\n**Step 2: Conservation of the Second Adiabatic Invariant ($J$)**\n\nThe bounce action, $J$, is defined as the integral of the parallel velocity over one complete bounce cycle:\n$$\nJ = \\oint v_{\\parallel}\\,ds\n$$\nTo evaluate this integral, we first need an expression for $v_{\\parallel}$ as a function of arc length $s$ at a given time $t$. The particle's total kinetic energy at a given instant $t$, denoted $E(t)$, does not depend on the position $s$ along the bounce path. It is given by:\n$$\nE(t) = \\frac{1}{2}m\\,v_{\\perp}(s,t)^{2} + \\frac{1}{2}m\\,v_{\\parallel}(s,t)^{2}\n$$\nUsing the definition of $\\mu$, we can write $\\frac{1}{2}m\\,v_{\\perp}(s,t)^{2} = \\mu B(s,t)$. Thus:\n$$\nE(t) = \\mu B(s,t) + \\frac{1}{2}m\\,v_{\\parallel}(s,t)^{2}\n$$\nFrom this, we can express $v_{\\parallel}(s,t)^{2}$:\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2}{m}\\,[E(t) - \\mu B(s,t)]\n$$\nThe particle is reflected at the mirror points, $s = \\pm s_m(t)$, where $v_{\\parallel}(\\pm s_m, t) = 0$. This condition implies $E(t) = \\mu B(s_m, t)$. We can use this to express $v_{\\parallel}(s,t)$ in terms of quantities at the mirror points:\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2\\mu}{m}\\,[B(s_m,t) - B(s,t)]\n$$\nSubstituting the given magnetic field model, $B(s,t) = B(0,t)\\,(1+s^2/L^2)$:\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2\\mu}{m}\\,\\left[ B(0,t)\\Big(1+\\frac{s_m(t)^2}{L^2}\\Big) - B(0,t)\\Big(1+\\frac{s^2}{L^2}\\Big) \\right]\n$$\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2\\mu B(0,t)}{m L^2}\\,(s_m(t)^2 - s^2)\n$$\nThe integral for $J$ is over a closed loop from $-s_m$ to $s_m$ and back. By symmetry, this is twice the integral from $-s_m$ to $s_m$:\n$$\nJ = 2 \\int_{-s_m(t)}^{s_m(t)} v_{\\parallel}(s,t)\\,ds = 4 \\int_{0}^{s_m(t)} v_{\\parallel}(s,t)\\,ds\n$$\n$$\nJ = 4 \\int_{0}^{s_m(t)} \\sqrt{\\frac{2\\mu B(0,t)}{m L^2}\\,(s_m(t)^2 - s^2)}\\,ds = 4\\sqrt{\\frac{2\\mu B(0,t)}{m L^2}} \\int_{0}^{s_m(t)} \\sqrt{s_m(t)^2 - s^2}\\,ds\n$$\nThe integral $\\int_{0}^{s_m} \\sqrt{s_m^2 - s^2}\\,ds$ represents the area of a quarter-circle of radius $s_m$, which is $\\frac{\\pi s_m^2}{4}$. Thus:\n$$\nJ = 4\\sqrt{\\frac{2\\mu B(0,t)}{m L^2}} \\left( \\frac{\\pi s_m(t)^2}{4} \\right) = \\pi s_m(t)^2 \\sqrt{\\frac{2\\mu B(0,t)}{m L^2}}\n$$\nWe can relate this to the midplane velocities. At $s=0$, the parallel velocity is $v_{\\parallel}(t)$, so:\n$$\nv_{\\parallel}(t)^2 = v_{\\parallel}(0,t)^2 = \\frac{2\\mu B(0,t)}{m L^2}\\,s_m(t)^2\n$$\nFrom this, we find $s_m(t) = v_{\\parallel}(t) / \\sqrt{\\frac{2\\mu B(0,t)}{m L^2}}$. Also, note that $\\sqrt{\\frac{2\\mu B(0,t)}{m}} = v_{\\perp}(t)$. So, the term in the square root is $v_{\\perp}(t)/L$. This gives $s_m(t) = L \\frac{v_{\\parallel}(t)}{v_{\\perp}(t)}$.\nLet's substitute this back into the expression for $J$:\n$$\nJ = \\pi \\left( L \\frac{v_{\\parallel}(t)}{v_{\\perp}(t)} \\right)^2 \\left( \\frac{v_{\\perp}(t)}{L} \\right) = \\pi L^2 \\frac{v_{\\parallel}(t)^2}{v_{\\perp}(t)^2} \\frac{v_{\\perp}(t)}{L} = \\pi L \\frac{v_{\\parallel}(t)^2}{v_{\\perp}(t)}\n$$\nThis provides a simple relation between $J$ and the midplane velocities. Since $J$ is conserved, its value is constant. We evaluate it at $t=0$ using the initial speeds $v_{\\parallel 0}$ and $v_{\\perp 0}$:\n$$\nJ = \\pi L \\frac{v_{\\parallel 0}^2}{v_{\\perp 0}}\n$$\nEquating the expressions for $J$ at time $t$ and time $t=0$:\n$$\n\\pi L \\frac{v_{\\parallel}(t)^2}{v_{\\perp}(t)} = \\pi L \\frac{v_{\\parallel 0}^2}{v_{\\perp 0}}\n$$\n$$\n\\frac{v_{\\parallel}(t)^2}{v_{\\perp}(t)} = \\frac{v_{\\parallel 0}^2}{v_{\\perp 0}}\n$$\nSolving for $v_{\\parallel}(t)^2$:\n$$\nv_{\\parallel}(t)^2 = v_{\\parallel 0}^2 \\frac{v_{\\perp}(t)}{v_{\\perp 0}}\n$$\nWe substitute the result from Step 1, $v_{\\perp}(t) = v_{\\perp 0}\\,(1+\\alpha t)^{1/2}$:\n$$\nv_{\\parallel}(t)^2 = v_{\\parallel 0}^2 \\frac{v_{\\perp 0}\\,(1+\\alpha t)^{1/2}}{v_{\\perp 0}} = v_{\\parallel 0}^2\\,(1+\\alpha t)^{1/2}\n$$\nTherefore, the parallel speed at the midplane as a function of time is:\n$$\nv_{\\parallel}(t) = v_{\\parallel 0}\\,(1+\\alpha t)^{1/4}\n$$\n\n**Step 3: Evolution of Mirror Points and Pitch Angle**\n\nThe problem also asks for an explanation of how the mirror points and pitch angle at $s=0$ evolve.\n\n**Mirror Points:** The location of the mirror points, $s_m(t)$, is given by the relation we derived:\n$$\ns_m(t) = L \\frac{v_{\\parallel}(t)}{v_{\\perp}(t)}\n$$\nSubstituting our results for $v_{\\perp}(t)$ and $v_{\\parallel}(t)$:\n$$\ns_m(t) = L \\frac{v_{\\parallel 0}\\,(1+\\alpha t)^{1/4}}{v_{\\perp 0}\\,(1+\\alpha t)^{1/2}} = L \\frac{v_{\\parallel 0}}{v_{\\perp 0}} (1+\\alpha t)^{-1/4}\n$$\nSince $s_m(0) = L \\frac{v_{\\parallel 0}}{v_{\\perp 0}}$, we have $s_m(t) = s_m(0)\\,(1+\\alpha t)^{-1/4}$. Assuming $\\alpha > 0$ (ramping up the field), the term $(1+\\alpha t)^{-1/4}$ decreases with time. This means $|s_m(t)|$ decreases, and the particle's bounce motion becomes confined to a smaller region around the magnetic minimum. This is a form of Fermi acceleration, where the particle gains parallel energy from bouncing off \"approaching\" magnetic mirrors.\n\n**Pitch Angle:** The pitch angle $\\theta(t)$ at the midplane $s=0$ is defined by $\\tan\\theta(t) = v_{\\perp}(t)/v_{\\parallel}(t)$. Its evolution is:\n$$\n\\tan\\theta(t) = \\frac{v_{\\perp 0}\\,(1+\\alpha t)^{1/2}}{v_{\\parallel 0}\\,(1+\\alpha t)^{1/4}} = \\frac{v_{\\perp 0}}{v_{\\parallel 0}} (1+\\alpha t)^{1/4}\n$$\nSince $\\tan\\theta(0) = v_{\\perp 0}/v_{\\parallel 0}$, we have $\\tan\\theta(t) = \\tan\\theta(0)\\,(1+\\alpha t)^{1/4}$. For $\\alpha > 0$, $\\tan\\theta(t)$ increases with time, meaning the pitch angle at the midplane increases. The particle's velocity vector becomes more strongly aligned perpendicular to the magnetic field. This is related to betatron acceleration: the increase in perpendicular kinetic energy, $E_{\\perp}(t) = \\frac{1}{2}m v_{\\perp}(t)^2 \\propto (1+\\alpha t)$, is faster than the increase in parallel kinetic energy, $E_{\\parallel}(t) = \\frac{1}{2}m v_{\\parallel}(t)^2 \\propto (1+\\alpha t)^{1/2}$, causing the particle to be \"flattened\" onto the plane perpendicular to $\\vec{B}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} v_{\\perp 0} (1+\\alpha t)^{1/2} & v_{\\parallel 0} (1+\\alpha t)^{1/4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The term \"adiabatic\" is crucial; these invariants are conserved only when the magnetic field changes slowly compared to the characteristic periods of the particle's motion. This final practice transitions from analytical theory to hands-on computational physics, challenging you to verify this principle numerically for the second invariant, $J_\\parallel$. You will implement a simulation of a particle bouncing in a magnetic well that oscillates in time . By comparing scenarios with slow and fast field modulations, you will directly observe how an adiabatic invariant holds true under appropriate conditions and is violated when the changes become too rapid, bridging the gap between theoretical conservation laws and their practical limits in dynamic systems.",
            "id": "4180180",
            "problem": "Consider a charged particle of mass $m$ and charge $q$ moving in a nonuniform magnetic field while the electric field parallel to the magnetic field is zero. The persistent slow variation of the magnetic field magnitude produces bounce motion for particles that are trapped in local magnetic wells. Under the guiding-center approximation derived from the Lorentz force law, the parallel dynamics along the field-line arc length coordinate $l$ can be represented by a one-dimensional equation of motion with the mirror force. The fundamental base is the Lorentz force law and the guiding-center approximation, which leads to the evolution equations $dl/dt = v_\\parallel$ and $m\\,dv_\\parallel/dt = -\\mu\\,\\partial B/\\partial l$, where $\\mu$ is the magnetic moment and $B(l,t)$ is the magnetic field strength along the field line. The canonical bounce action diagnostic is defined as the bounce integral of the parallel canonical momentum over the spatial path between mirror points. Your task is to implement, test, and evaluate the time invariance of this diagnostic from first principles.\n\nYou must write a complete and runnable program that:\n- Simulates guiding-center parallel motion using the one-dimensional equation $m\\,dv_\\parallel/dt = -\\mu\\,\\partial B/\\partial l$, with $dl/dt = v_\\parallel$ and $E_\\parallel = 0$, for a set of specified parameters.\n- Uses a magnetic field model $B(l,t) = B_0\\left(1+\\alpha\\,(l/L)^2\\right)\\left(1+\\varepsilon\\,\\sin(\\omega\\,t)\\right)$, where $B_0$ is the base magnetic field, $\\alpha$ controls the curvature of the magnetic well, $L$ is a characteristic length scale, $\\varepsilon$ is the dimensionless amplitude of slow temporal modulation, and $\\omega$ is the angular frequency of the modulation.\n- Computes the bounce action diagnostic $J_\\parallel(t)$ defined by $J_\\parallel(t)=\\int_{l_1(t)}^{l_2(t)} p_\\parallel\\,dl$, where $p_\\parallel = m\\,v_\\parallel$ and $l_1(t),l_2(t)$ are the instantaneous mirror points determined by zero crossings of $v_\\parallel(t)$.\n- Implements accurate mirror point detection by interpolation across velocity sign changes to estimate the crossing time and position at which $v_\\parallel=0$. The interpolation must be used to place $p_\\parallel=0$ at the mirror points and to delimit each half-bounce segment.\n- Evaluates the time invariance by computing, over all resolved half-bounce segments in the simulated time window, the dimensionless relative variation of the bounce action defined by $\\Delta_J=\\left(\\max(J_\\parallel)-\\min(J_\\parallel)\\right)/\\langle J_\\parallel\\rangle$, where $\\langle J_\\parallel\\rangle$ is the arithmetic mean of $J_\\parallel$ across segments. If fewer than two half-bounce segments are detected, return a not-a-number float for that case.\n- Uses the International System of Units (SI): $l$ in meters, $t$ in seconds, $v_\\parallel$ in meters per second, $m$ in kilograms, $B$ in tesla, $\\mu$ in joules per tesla, and $J_\\parallel$ in kilogram meter squared per second. The final reported output for each test case must be the dimensionless quantity $\\Delta_J$ expressed as a decimal number.\n\nNumerical requirements:\n- Use a fixed-step explicit method to integrate the ordinary differential equations; a fourth-order Rungeâ€“Kutta scheme is acceptable.\n- Detect all $v_\\parallel$ sign changes robustly and use linear interpolation to refine mirror point locations.\n- Compute the bounce action integral for each half-bounce by numerical quadrature over the simulated path using the trapezoidal rule applied to $p_\\parallel$ as a function of $l$ along the path between successive mirror points.\n\nTest suite:\nSimulate the following parameter sets. Each parameter set is a tuple $(m,\\mu,B_0,\\alpha,L,l_0,v_0,\\varepsilon,\\omega,t_{\\mathrm{end}},\\Delta t)$, with all quantities in SI units:\n- Case $1$ (static, deeply trapped): $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,8.0\\times 10^{4},\\,0.0,\\,0.0,\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-6})$.\n- Case $2$ (static, near separatrix): $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,1.95\\times 10^{5},\\,0.0,\\,0.0,\\,2.0\\times 10^{-2},\\,1.0\\times 10^{-6})$.\n- Case $3$ (slow temporal modulation): $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,1.0\\times 10^{5},\\,1.0\\times 10^{-2},\\,1.0\\times 10^{3},\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-6})$.\n- Case $4$ (strong modulation at bounce scale): $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,1.0\\times 10^{5},\\,2.0\\times 10^{-1},\\,2.0\\times 10^{5},\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-6})$.\n- Case $5$ (very small amplitude, static): $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,2.0\\times 10^{4},\\,0.0,\\,0.0,\\,5.0\\times 10^{-3},\\,1.0\\times 10^{-6})$.\n\nAnswer specification:\n- For each test case, compute the dimensionless relative variation $\\Delta_J$ across all resolved half-bounce segments in the simulated time window.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite cases, for example, $[\\Delta J_1,\\Delta J_2,\\Delta J_3,\\Delta J_4,\\Delta J_5]$.",
            "solution": "The problem requires a numerical investigation of the second adiabatic invariant, known as the longitudinal or bounce invariant $J_\\parallel$, for a charged particle undergoing bounce motion in a magnetic mirror. The validity of this invariant rests on the principle that if the parameters of an oscillating system change slowly compared to the oscillation period, then the action integral over one period is approximately constant. Here, we will test this principle by simulating the particle's motion and calculating the variation of $J_\\parallel$ under different conditions, particularly when the magnetic field itself varies in time.\n\nThe governing equations for the parallel guiding-center motion are provided as:\n$$\n\\frac{dl}{dt} = v_\\parallel\n$$\n$$\nm\\frac{dv_\\parallel}{dt} = F_\\parallel = -\\mu \\frac{\\partial B}{\\partial l}\n$$\nwhere $l$ is the coordinate along the magnetic field line, $v_\\parallel$ is the velocity parallel to the field line, $m$ is the particle mass, and $\\mu$ is its magnetic moment, which is assumed to be a constant (the first adiabatic invariant). The force $F_\\parallel$ arises from the spatial gradient of the magnetic field, known as the mirror force. The electric field parallel to $\\vec{B}$ is specified to be zero ($E_\\parallel = 0$).\n\nThis system constitutes a set of two coupled first-order ordinary differential equations (ODEs). We can represent the state of the system by a vector $\\mathbf{y}(t) = [l(t), v_\\parallel(t)]^T$. The evolution of the system is then described by $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$, where:\n$$\n\\mathbf{f}(t, \\mathbf{y}) = \\begin{pmatrix} v_\\parallel \\\\ -\\frac{\\mu}{m} \\frac{\\partial B}{\\partial l} \\end{pmatrix}\n$$\n\nThe magnetic field model is given as a parabolic well with sinusoidal time modulation:\n$$\nB(l,t) = B_0\\left(1+\\alpha\\left(\\frac{l}{L}\\right)^2\\right)\\left(1+\\varepsilon\\sin(\\omega t)\\right)\n$$\nTo calculate the mirror force, we must find the partial derivative of $B$ with respect to $l$:\n$$\n\\frac{\\partial B}{\\partial l} = B_0\\left(\\frac{2\\alpha l}{L^2}\\right)\\left(1+\\varepsilon\\sin(\\omega t)\\right)\n$$\nThis expression is then substituted into the equation of motion for $v_\\parallel$.\n\nTo solve this system numerically, we employ the fourth-order Runge-Kutta (RK4) method, a robust and widely used explicit scheme for integrating ODEs. Given a time step $\\Delta t$, the state vector $\\mathbf{y}_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$ is found from the state $\\mathbf{y}_n$ at time $t_n$ as follows:\n$$\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(t_n, \\mathbf{y}_n)\n$$\n$$\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}\\left(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_1}{2}\\right)\n$$\n$$\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}\\left(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_2}{2}\\right)\n$$\n$$\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(t_n + \\Delta t, \\mathbf{y}_n + \\mathbf{k}_3)\n$$\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nWe apply this scheme step-by-step from the initial conditions $(l_0, v_0)$ at $t=0$ up to the final simulation time $t_{\\mathrm{end}}$, storing the trajectory $(t_i, l_i, v_{\\parallel, i})$ at each step.\n\nThe core of the analysis is the bounce action diagnostic, $J_\\parallel$, defined as the integral of the parallel momentum $p_\\parallel = m v_\\parallel$ along the spatial path between two consecutive mirror points, $l_1$ and $l_2$. This corresponds to a half-bounce of the particle.\n$$\nJ_\\parallel = \\int_{l_1}^{l_2} p_\\parallel \\, dl\n$$\nMirror points are the locations where the particle's parallel motion reverses, i.e., where $v_\\parallel = 0$. In our discrete simulation, we detect a mirror point crossing when the sign of $v_\\parallel$ changes between two consecutive time steps, i.e., $v_{\\parallel, i-1} \\cdot v_{\\parallel, i} \\le 0$. To accurately locate the mirror point, we use linear interpolation. If a crossing occurs between times $t_{i-1}$ and $t_i$, the time of the crossing $t_{\\text{mirror}}$ is estimated as:\n$$\nt_{\\text{mirror}} = t_{i-1} - v_{\\parallel, i-1} \\frac{t_i - t_{i-1}}{v_{\\parallel, i} - v_{\\parallel, i-1}}\n$$\nThe corresponding position $l_{\\text{mirror}}$ is found by linearly interpolating the position $l(t)$ at $t_{\\text{mirror}}$:\n$$\nl_{\\text{mirror}} = l_{i-1} + (t_{\\text{mirror}} - t_{i-1}) \\frac{l_i - l_{i-1}}{t_i - t_{i-1}}\n$$\n\nAfter the simulation, we identify all such mirror points to partition the trajectory into a series of complete half-bounce segments. For each segment, from a starting mirror point $M_1 = (t_{\\text{m1}}, l_{\\text{m1}})$ to an ending mirror point $M_2 = (t_{\\text{m2}}, l_{\\text{m2}})$, we construct the integration path. This path consists of the sequence of discrete points $(l_i, p_{\\parallel,i})$ from the simulation that lie between $M_1$ and $M_2$, augmented with the interpolated mirror points at the start and end, where momentum is zero: $(l_{\\text{m1}}, 0)$ and $(l_{\\text{m2}}, 0)$.\n\nThe integral for $J_\\parallel$ is then computed numerically using the trapezoidal rule, as specified. For a path defined by points $(l_j, p_{\\parallel, j})$, the integral is:\n$$\nJ_\\parallel \\approx \\sum_{j} \\frac{p_{\\parallel, j} + p_{\\parallel, j+1}}{2} (l_{j+1} - l_j)\n$$\nThe absolute value of the result is taken, as action is a positive definite quantity.\n\nFinally, to quantify the time invariance of the bounce action, we collect the values of $J_\\parallel$ computed for all resolved half-bounce segments. We then calculate the dimensionless relative variation $\\Delta_J$:\n$$\n\\Delta_J = \\frac{\\max(J_\\parallel) - \\min(J_\\parallel)}{\\langle J_\\parallel \\rangle}\n$$\nwhere $\\langle J_\\parallel \\rangle$ is the arithmetic mean of all measured $J_\\parallel$ values. If fewer than two segments are resolved, this metric is undefined, and we report a not-a-number (NaN) value. This procedure is repeated for each of the provided test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        # (m, mu, B0, alpha, L, l0, v0, epsilon, omega, t_end, dt)\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 8.0e4, 0.0, 0.0, 1.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 1.95e5, 0.0, 0.0, 2.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 1.0e5, 1.0e-2, 1.0e3, 1.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 1.0e5, 2.0e-1, 2.0e5, 1.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 2.0e4, 0.0, 0.0, 5.0e-3, 1.0e-6),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation_and_analyze(params)\n        results.append(result)\n\n    # Format output as specified\n    result_str = ','.join([f\"{r:.16e}\" if not np.isnan(r) else \"nan\" for r in results])\n    print(f\"[{result_str}]\")\n\n\ndef run_simulation_and_analyze(params):\n    \"\"\"\n    Runs the guiding-center simulation for one set of parameters and computes Delta_J.\n    \"\"\"\n    m, mu, B0, alpha, L, l0, v0_initial, eps, omega, t_end, dt = params\n\n    # --- Define physics functions ---\n    def B_field(l, t):\n        spatial_part = B0 * (1 + alpha * (l / L)**2)\n        temporal_part = 1 + eps * np.sin(omega * t)\n        return spatial_part * temporal_part\n\n    def force_over_m(l, t):\n        # F/m = -mu/m * dB/dl\n        dB_dl = B0 * (2 * alpha * l / L**2) * (1 + eps * np.sin(omega * t))\n        return -mu / m * dB_dl\n\n    def derivatives(t, y):\n        l, v_parallel = y\n        dl_dt = v_parallel\n        dv_parallel_dt = force_over_m(l, t)\n        return np.array([dl_dt, dv_parallel_dt])\n\n    # --- Numerical Integration (RK4) ---\n    n_steps = int(t_end / dt)\n    t_hist = np.linspace(0, t_end, n_steps + 1)\n    l_hist = np.zeros(n_steps + 1)\n    v_hist = np.zeros(n_steps + 1)\n\n    l_hist[0] = l0\n    v_hist[0] = v0_initial\n\n    for i in range(n_steps):\n        t_n = t_hist[i]\n        y_n = np.array([l_hist[i], v_hist[i]])\n\n        k1 = dt * derivatives(t_n, y_n)\n        k2 = dt * derivatives(t_n + dt/2, y_n + k1/2)\n        k3 = dt * derivatives(t_n + dt/2, y_n + k2/2)\n        k4 = dt * derivatives(t_n + dt, y_n + k3)\n        \n        y_np1 = y_n + (k1 + 2*k2 + 2*k3 + k4) / 6\n        \n        l_hist[i+1] = y_np1[0]\n        v_hist[i+1] = y_np1[1]\n\n    # --- Analysis: Mirror Point Detection and J_parallel Calculation ---\n    mirror_points = []\n    for i in range(1, n_steps + 1):\n        if v_hist[i-1] * v_hist[i] <= 0 and v_hist[i-1] != v_hist[i]:\n            v1, v2 = v_hist[i-1], v_hist[i]\n            t1, t2 = t_hist[i-1], t_hist[i]\n            l1, l2 = l_hist[i-1], l_hist[i]\n            \n            # Linear interpolation to find the zero crossing\n            frac = -v1 / (v2 - v1)\n            t_mirror = t1 + frac * (t2 - t1)\n            l_mirror = l1 + frac * (l2 - l1)\n\n            mirror_points.append({'t': t_mirror, 'l': l_mirror, 'idx_after': i})\n    \n    J_values = []\n    if len(mirror_points) < 2:\n        return np.nan\n\n    for j in range(len(mirror_points) - 1):\n        start_mirror = mirror_points[j]\n        end_mirror = mirror_points[j+1]\n\n        # Get the trajectory points for this full half-bounce segment\n        idx_start_slice = start_mirror['idx_after']\n        idx_end_slice = end_mirror['idx_after'] # slice up to, but not including, the next crossing step\n        \n        l_segment_full_steps = l_hist[idx_start_slice:idx_end_slice]\n        p_segment_full_steps = m * v_hist[idx_start_slice:idx_end_slice]\n\n        # Construct the complete path for integration including interpolated endpoints\n        # Path: [start_mirror, full_steps..., end_mirror]\n        l_path = np.concatenate(([start_mirror['l']], l_segment_full_steps, [end_mirror['l']]))\n        p_path = np.concatenate(([0.0], p_segment_full_steps, [0.0]))\n        \n        # Compute J_parallel using the trapezoidal rule\n        # The integral is guaranteed to be over a monotonic `l` path for a half-bounce\n        J = np.trapz(p_path, l_path)\n        J_values.append(np.abs(J))\n\n    if len(J_values) < 2:\n        return np.nan\n\n    J_values = np.array(J_values)\n    max_J = np.max(J_values)\n    min_J = np.min(J_values)\n    mean_J = np.mean(J_values)\n\n    if mean_J == 0:\n        return np.nan\n\n    delta_J = (max_J - min_J) / mean_J\n    return delta_J\n\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}