{
    "hands_on_practices": [
        {
            "introduction": "这项基础练习旨在帮助你理解“磁镜力”的起源。通过在一个简单的、仅在空间上变化的磁场中应用第一绝热不变量 $\\mu$ 和能量守恒定律，我们可以直接推导出将带电粒子推离强磁场区域的作用力，这是磁镜装置约束等离子体的基本物理原理。这项练习将巩固你对 $\\mu$ 守恒最直接物理后果的理解 。",
            "id": "4180217",
            "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子在一个静态、线性变化的磁场 $ \\mathbf{B}(z) = B_0 \\left(1 + \\alpha z \\right) \\hat{\\mathbf{z}} $ 中运动，其中 $B_0 > 0$，$\\alpha$ 是一个量纲为长度倒数的常数，$z$ 是沿磁场方向的坐标。电场为零，非磁力可忽略不计。在 $z=0$ 处，粒子相对于局部磁场方向的垂直速度为 $v_{\\perp 0}$，平行速度为 $v_{\\parallel 0}$。假设导心近似适用，且在 $\\alpha \\rho_L \\ll 1$ 的量级下，第一绝热不变量（磁矩）守恒，其中拉莫尔半径为 $\\rho_L = v_{\\perp}/\\Omega$，回旋频率为 $\\Omega = |q| B/m$。\n\n从洛伦兹力定律和静态磁场中总动能守恒出发，利用第一绝热不变量守恒，推导在小参数 $\\alpha z$ 的主导阶下，垂直速度和平行速度的变化量 $\\Delta v_{\\perp}(z) = v_{\\perp}(z) - v_{\\perp 0}$ 和 $\\Delta v_{\\parallel}(z) = v_{\\parallel}(z) - v_{\\parallel 0}$。在相同的量级和假设下，确定由于磁场不均匀性施加在导心上的平行磁镜力 $F_{\\parallel}(z)$。用符号 $m$、$q$、$B_0$、$\\alpha$、$z$、$v_{\\perp 0}$ 和 $v_{\\parallel 0}$ 表示你的最终表达式。以国际单位制（SI）牛顿来解释磁镜力，但不要在最终的方框答案中附加单位。提供在 $\\alpha z$ 的一阶下有效的封闭形式符号表达式。无需进行数值四舍五入。",
            "solution": "该问题需经过验证。\n\n### 步骤1：提取已知条件\n- **粒子：** 质量 $m$，电荷 $q$。\n- **磁场：** $\\mathbf{B}(z) = B_0 \\left(1 + \\alpha z \\right) \\hat{\\mathbf{z}}$，其中 $B_0 > 0$ 且 $\\alpha$ 为常数。\n- **电场：** $\\mathbf{E} = 0$。\n- **其他力：** 可忽略。\n- **初始条件 (在 $z=0$ 处)：** 垂直速度 $v_{\\perp 0}$，平行速度 $v_{\\parallel 0}$。\n- **假设：**\n    - 导心近似适用。\n    - 第一绝热不变量（磁矩, $\\mu$）守恒。\n    - 量级参数 $\\alpha \\rho_L \\ll 1$ 成立，其中 $\\rho_L = v_{\\perp}/\\Omega$ 且 $\\Omega = |q| B/m$。\n- **任务：**\n    1. 推导在 $\\alpha z$ 的主导阶下垂直速度的变化量 $\\Delta v_{\\perp}(z) = v_{\\perp}(z) - v_{\\perp 0}$。\n    2. 推导在 $\\alpha z$ 的主导阶下平行速度的变化量 $\\Delta v_{\\parallel}(z) = v_{\\parallel}(z) - v_{\\parallel 0}$。\n    3. 在相同的量级下确定平行磁镜力 $F_{\\parallel}(z)$。\n    4. 用 $m$、$q$、$B_0$、$\\alpha$、$z$、$v_{\\perp 0}$ 和 $v_{\\parallel 0}$ 表示结果。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题涉及带电粒子在非均匀磁场中的运动，这是等离子体物理和电磁学中的一个基本课题。绝热不变量的概念，特别是磁矩，以及由此产生的磁镜力是公认的，并且是理解聚变装置中的磁约束和行星磁层中粒子捕获等现象的核心。磁场的线性近似 $B(z) = B_0(1 + \\alpha z)$ 是研究局部动力学的标准有效方法。该问题基于可靠的物理原理。\n- **适定性：** 该问题提供了所有必要的初始条件（$v_{\\perp 0}$，$v_{\\parallel 0}$）、磁场形式以及控制性的守恒定律（能量守恒和第一绝热不变量守恒）。这些信息足以在要求的近似阶数下唯一地确定指定的量（$\\Delta v_{\\perp}(z)$、$\\Delta v_{\\parallel}(z)$、$F_{\\parallel}(z)$）。\n- **客观性：** 该问题以精确、定量的语言陈述，没有歧义、主观性或观点。\n\n### 步骤3：结论与行动\n该问题科学上合理、适定、客观且完整。因此，判定为**有效**。现在将推导解答过程。\n\n带电粒子的运动受两个基本守恒定律支配。\n\n**1. 动能守恒：**\n洛伦兹力 $\\mathbf{F} = q(\\mathbf{v} \\times \\mathbf{B})$ 始终垂直于粒子的速度 $\\mathbf{v}$。因此，它不对粒子做功。由于电场为零且其他力可忽略不计，粒子的总动能 $K$ 是守恒的。\n总动能是与垂直于磁场的运动相关的动能 ($K_{\\perp}$) 和与平行于磁场的运动相关的动能 ($K_{\\parallel}$) 的总和：\n$$K = K_{\\perp} + K_{\\parallel} = \\frac{1}{2}m v_{\\perp}^2 + \\frac{1}{2}m v_{\\parallel}^2$$\n能量守恒意味着：\n$$ \\frac{1}{2}m (v_{\\perp}(z)^2 + v_{\\parallel}(z)^2) = \\frac{1}{2}m (v_{\\perp 0}^2 + v_{\\parallel 0}^2) $$\n$$ v_{\\perp}(z)^2 + v_{\\parallel}(z)^2 = v_{\\perp 0}^2 + v_{\\parallel 0}^2 = \\text{constant} $$\n\n**2. 第一绝热不变量（磁矩）守恒：**\n问题陈述第一绝热不变量，即磁矩 $\\mu$，是守恒的。磁矩定义为垂直动能与磁场大小之比：\n$$ \\mu = \\frac{K_{\\perp}}{B} = \\frac{\\frac{1}{2} m v_{\\perp}^2}{B} $$\n$\\mu$ 守恒意味着：\n$$ \\frac{v_{\\perp}(z)^2}{B(z)} = \\frac{v_{\\perp 0}^2}{B_0} = \\text{constant} $$\n其中 $B(z) = |\\mathbf{B}(z)| = B_0(1 + \\alpha z)$ 且 $B(0) = B_0$。\n\n我们现在可以利用这两个原理来求得所需量。\n\n**$\\Delta v_{\\perp}(z)$ 的推导：**\n根据磁矩守恒，我们有：\n$$ v_{\\perp}(z)^2 = v_{\\perp 0}^2 \\frac{B(z)}{B_0} = v_{\\perp 0}^2 \\frac{B_0(1 + \\alpha z)}{B_0} = v_{\\perp 0}^2 (1 + \\alpha z) $$\n为求得 $v_{\\perp}(z)$，我们取平方根：\n$$ v_{\\perp}(z) = v_{\\perp 0} \\sqrt{1 + \\alpha z} $$\n问题要求结果在小参数 $\\alpha z$ 的主导阶下。对于小的 $x$，我们使用二项式近似 $\\sqrt{1+x} \\approx 1 + \\frac{1}{2}x$。\n$$ v_{\\perp}(z) \\approx v_{\\perp 0} \\left(1 + \\frac{1}{2} \\alpha z\\right) $$\n那么，垂直速度的变化量 $\\Delta v_{\\perp}(z)$ 为：\n$$ \\Delta v_{\\perp}(z) = v_{\\perp}(z) - v_{\\perp 0} \\approx v_{\\perp 0} \\left(1 + \\frac{1}{2} \\alpha z\\right) - v_{\\perp 0} = \\frac{1}{2} v_{\\perp 0} \\alpha z $$\n\n**$\\Delta v_{\\parallel}(z)$ 的推导：**\n根据能量守恒，我们可以表示 $v_{\\parallel}(z)^2$：\n$$ v_{\\parallel}(z)^2 = (v_{\\perp 0}^2 + v_{\\parallel 0}^2) - v_{\\perp}(z)^2 $$\n代入由 $\\mu$ 守恒得到的 $v_{\\perp}(z)^2$ 的表达式：\n$$ v_{\\parallel}(z)^2 = (v_{\\perp 0}^2 + v_{\\parallel 0}^2) - v_{\\perp 0}^2 (1 + \\alpha z) = v_{\\parallel 0}^2 - v_{\\perp 0}^2 \\alpha z $$\n为求得 $v_{\\parallel}(z)$，我们取平方根：\n$$ v_{\\parallel}(z) = \\sqrt{v_{\\parallel 0}^2 - v_{\\perp 0}^2 \\alpha z} = v_{\\parallel 0} \\sqrt{1 - \\frac{v_{\\perp 0}^2}{v_{\\parallel 0}^2} \\alpha z} $$\n同样，对于小的 $x = \\frac{v_{\\perp 0}^2}{v_{\\parallel 0}^2} \\alpha z$，我们使用二项式近似 $\\sqrt{1-x} \\approx 1 - \\frac{1}{2}x$：\n$$ v_{\\parallel}(z) \\approx v_{\\parallel 0} \\left(1 - \\frac{1}{2} \\frac{v_{\\perp 0}^2}{v_{\\parallel 0}^2} \\alpha z\\right) = v_{\\parallel 0} - \\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z $$\n平行速度的变化量 $\\Delta v_{\\parallel}(z)$ 为：\n$$ \\Delta v_{\\parallel}(z) = v_{\\parallel}(z) - v_{\\parallel 0} \\approx \\left(v_{\\parallel 0} - \\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z\\right) - v_{\\parallel 0} = -\\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z $$\n\n**平行磁镜力 $F_{\\parallel}(z)$ 的推导：**\n作用在导心上的平行力，即磁镜力，源于磁场梯度。它由垂直动能的负梯度给出，该动能充当平行运动的势能。\n$$ F_{\\parallel} = -\\nabla_{\\parallel} (\\mu B) $$\n由于磁场仅在 $z$ 方向变化，这可以简化为：\n$$ F_{\\parallel}(z) = -\\mu \\frac{d B}{dz} $$\n磁矩 $\\mu$ 是恒定的，可以在 $z=0$ 处求值：\n$$ \\mu = \\frac{\\frac{1}{2} m v_{\\perp 0}^2}{B_0} $$\n磁场的梯度是：\n$$ \\frac{d B}{dz} = \\frac{d}{dz} \\left[ B_0 (1 + \\alpha z) \\right] = B_0 \\alpha $$\n将这些代入力学的表达式中：\n$$ F_{\\parallel}(z) = - \\left( \\frac{\\frac{1}{2} m v_{\\perp 0}^2}{B_0} \\right) (B_0 \\alpha) = -\\frac{1}{2} m v_{\\perp 0}^2 \\alpha $$\n这个结果与 $z$ 无关，因为磁场梯度是恒定的。在 $\\mu$ 守恒的假设下，这个表达式是精确的。它本身不依赖于小的 $\\alpha z$ 近似，但它是在相同的物理假设下推导出来的。如果 $\\alpha > 0$，力指向 $-\\hat{\\mathbf{z}}$ 方向，将粒子推离更强的磁场区域，因此得名“磁镜力”。\n\n所要求的三个量是：\n1. $\\Delta v_{\\perp}(z) = \\frac{1}{2} v_{\\perp 0} \\alpha z$\n2. $\\Delta v_{\\parallel}(z) = -\\frac{v_{\\perp 0}^2}{2 v_{\\parallel 0}} \\alpha z$\n3. $F_{\\parallel}(z) = -\\frac{1}{2} m v_{\\perp 0}^2 \\alpha$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} v_{\\perp 0} \\alpha z,  -\\frac{v_{\\perp 0}^{2}}{2 v_{\\parallel 0}} \\alpha z,  -\\frac{1}{2} m v_{\\perp 0}^{2} \\alpha\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "这项练习在前一题的基础上，探讨了一个更动态的情景：磁场不仅在空间上变化，还随时间缓慢增强。通过同时应用第一和第二绝热不变量（$\\mu$ 和 $J$）的守恒，我们可以预测一个被俘获粒子的能量将如何演变。这个练习揭示了等离子体中两种基本的粒子加速机制：由磁场缓慢增强引起的回旋加速（垂直能量增加）和由“运动磁镜”引起的费米加速（平行能量增加）。",
            "id": "4180181",
            "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子在一个随时间缓慢增强的磁镜场中运动。沿磁力线的磁场强度大小可模型化为\n$$\nB(s,t) = B_{0}\\,(1+\\alpha t)\\,\\Big(1+\\frac{s^{2}}{L^{2}}\\Big),\n$$\n其中 $s$ 是沿磁力线的弧长坐标，在磁场极小值处 $s=0$；$B_{0}0$ 是 $t=0$ 时的初始场强标度；$\\alpha$ 是一个量纲为 $\\mathrm{s}^{-1}$ 的小参数，用于控制增强速率；$L$ 是一个表征磁镜几何形状的正常数。假设时间变化相对于回旋周期和弹跳周期都很慢，因此第一和第二绝热不变量在主导阶上是守恒的。\n\n在时间 $t=0$ 时，粒子以垂直速度 $v_{\\perp 0}$ 和平行速度 $v_{\\parallel 0}$ 穿过磁场极小值点 $s=0$。磁矩（第一绝热不变量）定义为\n$$\n\\mu = \\frac{m\\,v_{\\perp}^{2}}{2\\,B},\n$$\n弹跳作用量（第二绝热不变量）定义为\n$$\nJ = \\oint v_{\\parallel}\\,ds,\n$$\n其中线积分是在磁镜点之间的一次完整弹跳过程中进行的。\n\n仅使用上述定义、缓慢增强条件下 $\\mu$ 和 $J$ 的守恒以及基本运动学，推导在磁场极小值处的垂直速度 $v_{\\perp}(t)$ 和平行速度 $v_{\\parallel}(t)$ 的闭式表达式，使其表示为时间 $t$ 和参数 $m$、$B_{0}$、$\\alpha$、$L$、$v_{\\perp 0}$ 及 $v_{\\parallel 0}$ 的函数。然后，在相同假设下，从第一性原理出发，解释磁镜点和在 $s=0$ 处的螺距角如何随时间 $t$ 演化。\n\n以 $v_{\\perp}(t)$ 和 $v_{\\parallel}(t)$ 在 $s=0$ 处的解析表达式（用给定参数表示）作为最终答案。无需进行数值计算或四舍五入，最终表达式中也无需报告单位。说明你引入的任何中间物理量，并通过引用上述定义和守恒定律来证明你推导过程中的每一步。",
            "solution": "该问题是适定的，并且科学上基于等离子体物理学原理，特别是带电粒子运动的绝热理论。我将根据所提供的定义和守恒定律进行求解。\n\n问题要求解在磁场极小值点（$s=0$）处的垂直速度 $v_{\\perp}(t)$ 和平行速度 $v_{\\parallel}(t)$ 作为时间 $t$ 的函数。求解过程依赖于第一和第二绝热不变量 $\\mu$ 和 $J$ 的守恒。\n\n磁场由下式给出\n$$\nB(s,t) = B_{0}\\,(1+\\alpha t)\\,\\Big(1+\\frac{s^{2}}{L^{2}}\\Big)\n$$\n在中平面 $s=0$ 处，磁场为\n$$\nB(0,t) = B_{0}\\,(1+\\alpha t)\n$$\n在初始时刻 $t=0$，中平面磁场为 $B(0,0) = B_0$。\n\n**步骤1：第一绝热不变量（$\\mu$）守恒**\n\n磁矩 $\\mu$ 定义为\n$$\n\\mu = \\frac{m\\,v_{\\perp}^{2}}{2\\,B}\n$$\n问题陈述，在磁场的缓慢时间变化下，$\\mu$ 是守恒的。我们可以在初始时刻 $t=0$、中平面 $s=0$ 处计算 $\\mu$ 的值，此时粒子的垂直速度为 $v_{\\perp 0}$，磁场为 $B(0,0)=B_0$。\n$$\n\\mu = \\frac{m\\,v_{\\perp 0}^{2}}{2\\,B_0}\n$$\n$\\mu$ 的这个值在所有时间内都是恒定的。在之后的任意时刻 $t$，粒子在中平面的垂直速度为 $v_{\\perp}(t)$，磁场为 $B(0,t) = B_0(1+\\alpha t)$。$\\mu$ 的守恒意味着：\n$$\n\\frac{m\\,v_{\\perp}(t)^{2}}{2\\,B(0,t)} = \\frac{m\\,v_{\\perp 0}^{2}}{2\\,B_0}\n$$\n代入 $B(0,t)$ 的表达式：\n$$\n\\frac{m\\,v_{\\perp}(t)^{2}}{2\\,B_{0}\\,(1+\\alpha t)} = \\frac{m\\,v_{\\perp 0}^{2}}{2\\,B_0}\n$$\n解出 $v_{\\perp}(t)^{2}$：\n$$\nv_{\\perp}(t)^{2} = v_{\\perp 0}^{2}\\,(1+\\alpha t)\n$$\n因此，中平面处的垂直速度作为时间的函数为：\n$$\nv_{\\perp}(t) = v_{\\perp 0}\\,\\sqrt{1+\\alpha t} = v_{\\perp 0}\\,(1+\\alpha t)^{1/2}\n$$\n\n**步骤2：第二绝热不变量（$J$）守恒**\n\n弹跳作用量 $J$ 定义为在一个完整弹跳周期内对平行速度的积分：\n$$\nJ = \\oint v_{\\parallel}\\,ds\n$$\n为了计算这个积分，我们首先需要一个在给定时间 $t$ 下，$v_{\\parallel}$ 作为弧长 $s$ 的函数表达式。在给定瞬间 $t$，粒子的总动能记为 $E(t)$，它不依赖于弹跳路径上的位置 $s$。其表达式为：\n$$\nE(t) = \\frac{1}{2}m\\,v_{\\perp}(s,t)^{2} + \\frac{1}{2}m\\,v_{\\parallel}(s,t)^{2}\n$$\n使用 $\\mu$ 的定义，我们可以写出 $\\frac{1}{2}m\\,v_{\\perp}(s,t)^{2} = \\mu B(s,t)$。因此：\n$$\nE(t) = \\mu B(s,t) + \\frac{1}{2}m\\,v_{\\parallel}(s,t)^{2}\n$$\n由此，我们可以表示出 $v_{\\parallel}(s,t)^{2}$：\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2}{m}\\,[E(t) - \\mu B(s,t)]\n$$\n粒子在磁镜点 $s = \\pm s_m(t)$ 处被反射，在这些点上 $v_{\\parallel}(\\pm s_m, t) = 0$。这个条件意味着 $E(t) = \\mu B(s_m, t)$。我们可以用这个关系式来表示 $v_{\\parallel}(s,t)$，使其用磁镜点处的物理量表示：\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2\\mu}{m}\\,[B(s_m,t) - B(s,t)]\n$$\n代入给定的磁场模型 $B(s,t) = B(0,t)\\,(1+s^2/L^2)$：\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2\\mu}{m}\\,\\left[ B(0,t)\\Big(1+\\frac{s_m(t)^2}{L^2}\\Big) - B(0,t)\\Big(1+\\frac{s^2}{L^2}\\Big) \\right]\n$$\n$$\nv_{\\parallel}(s,t)^{2} = \\frac{2\\mu B(0,t)}{m L^2}\\,(s_m(t)^2 - s^2)\n$$\n$J$ 的积分是在从 $-s_m$ 到 $s_m$ 再返回的闭合回路上进行的。根据对称性，这等于从 $-s_m$ 到 $s_m$ 积分的两倍：\n$$\nJ = 2 \\int_{-s_m(t)}^{s_m(t)} v_{\\parallel}(s,t)\\,ds = 4 \\int_{0}^{s_m(t)} v_{\\parallel}(s,t)\\,ds\n$$\n$$\nJ = 4 \\int_{0}^{s_m(t)} \\sqrt{\\frac{2\\mu B(0,t)}{m L^2}\\,(s_m(t)^2 - s^2)}\\,ds = 4\\sqrt{\\frac{2\\mu B(0,t)}{m L^2}} \\int_{0}^{s_m(t)} \\sqrt{s_m(t)^2 - s^2}\\,ds\n$$\n积分 $\\int_{0}^{s_m} \\sqrt{s_m^2 - s^2}\\,ds$ 代表半径为 $s_m$ 的四分之一圆的面积，即 $\\frac{\\pi s_m^2}{4}$。因此：\n$$\nJ = 4\\sqrt{\\frac{2\\mu B(0,t)}{m L^2}} \\left( \\frac{\\pi s_m(t)^2}{4} \\right) = \\pi s_m(t)^2 \\sqrt{\\frac{2\\mu B(0,t)}{m L^2}}\n$$\n我们可以将其与中平面速度联系起来。在 $s=0$ 处，平行速度为 $v_{\\parallel}(t)$，所以：\n$$\nv_{\\parallel}(t)^2 = v_{\\parallel}(0,t)^2 = \\frac{2\\mu B(0,t)}{m L^2}\\,s_m(t)^2\n$$\n由此，我们可以得到 $s_m(t)^2 = \\frac{m L^2 v_\\parallel(t)^2}{2\\mu B(0,t)}$。代入 $J$ 的表达式：\n$$\nJ = \\pi \\frac{m L^2 v_\\parallel(t)^2}{2\\mu B(0,t)} \\sqrt{\\frac{2\\mu B(0,t)}{m L^2}} = \\pi L v_\\parallel(t)^2 \\sqrt{\\frac{m}{2\\mu B(0,t)}}\n$$\n利用 $\\mu$ 的守恒，我们可以将 $\\sqrt{\\frac{m}{2\\mu B(0,t)}}$ 替换为 $\\frac{1}{v_{\\perp}(t)}$。\n$$\nJ = \\pi L \\frac{v_{\\parallel}(t)^2}{v_{\\perp}(t)}\n$$\n这提供了一个 $J$ 与中平面速度之间的简单关系。由于 $J$ 是守恒的，它的值是恒定的。我们用初始速度 $v_{\\parallel 0}$ 和 $v_{\\perp 0}$ 来计算它在 $t=0$ 时的值：\n$$\nJ = \\pi L \\frac{v_{\\parallel 0}^2}{v_{\\perp 0}}\n$$\n令时间 $t$ 和时间 $t=0$ 时的 $J$ 表达式相等：\n$$\n\\pi L \\frac{v_{\\parallel}(t)^2}{v_{\\perp}(t)} = \\pi L \\frac{v_{\\parallel 0}^2}{v_{\\perp 0}}\n$$\n$$\n\\frac{v_{\\parallel}(t)^2}{v_{\\perp}(t)} = \\frac{v_{\\parallel 0}^2}{v_{\\perp 0}}\n$$\n解出 $v_{\\parallel}(t)^2$：\n$$\nv_{\\parallel}(t)^2 = v_{\\parallel 0}^2 \\frac{v_{\\perp}(t)}{v_{\\perp 0}}\n$$\n我们代入步骤1的结果，$v_{\\perp}(t) = v_{\\perp 0}\\,(1+\\alpha t)^{1/2}$：\n$$\nv_{\\parallel}(t)^2 = v_{\\parallel 0}^2 \\frac{v_{\\perp 0}\\,(1+\\alpha t)^{1/2}}{v_{\\perp 0}} = v_{\\parallel 0}^2\\,(1+\\alpha t)^{1/2}\n$$\n因此，中平面处的平行速度作为时间的函数为：\n$$\nv_{\\parallel}(t) = v_{\\parallel 0}\\,(1+\\alpha t)^{1/4}\n$$\n\n**步骤3：磁镜点和螺距角的演化**\n\n问题还要求解释磁镜点和在 $s=0$ 处的螺距角如何演化。\n\n**磁镜点：** 磁镜点的位置 $s_m(t)$ 由我们推导出的关系式给出：\n$$\ns_m(t) = L \\frac{v_{\\parallel}(t)}{v_{\\perp}(t)}\n$$\n代入我们得到的 $v_{\\perp}(t)$ 和 $v_{\\parallel}(t)$ 的结果：\n$$\ns_m(t) = L \\frac{v_{\\parallel 0}\\,(1+\\alpha t)^{1/4}}{v_{\\perp 0}\\,(1+\\alpha t)^{1/2}} = L \\frac{v_{\\parallel 0}}{v_{\\perp 0}} (1+\\alpha t)^{-1/4}\n$$\n由于 $s_m(0) = L \\frac{v_{\\parallel 0}}{v_{\\perp 0}}$，我们有 $s_m(t) = s_m(0)\\,(1+\\alpha t)^{-1/4}$。假设 $\\alpha  0$（磁场增强），项 $(1+\\alpha t)^{-1/4}$ 随时间减小。这意味着 $|s_m(t)|$ 减小，粒子的弹跳运动被限制在磁场极小值周围一个更小的区域内。这是一种费米加速，粒子通过从“靠近”的磁镜反弹获得平行能量。\n\n**螺距角：** 在中平面 $s=0$ 处的螺距角 $\\theta(t)$ 由 $\\tan\\theta(t) = v_{\\perp}(t)/v_{\\parallel}(t)$ 定义。其演化过程为：\n$$\n\\tan\\theta(t) = \\frac{v_{\\perp 0}\\,(1+\\alpha t)^{1/2}}{v_{\\parallel 0}\\,(1+\\alpha t)^{1/4}} = \\frac{v_{\\perp 0}}{v_{\\parallel 0}} (1+\\alpha t)^{1/4}\n$$\n由于 $\\tan\\theta(0) = v_{\\perp 0}/v_{\\parallel 0}$，我们有 $\\tan\\theta(t) = \\tan\\theta(0)\\,(1+\\alpha t)^{1/4}$。对于 $\\alpha  0$，$\\tan\\theta(t)$ 随时间增加，意味着中平面处的螺距角增加。粒子的速度矢量变得更倾向于与磁场垂直。这与电子感应加速（贝塔特朗加速）有关：垂直动能的增加，$E_{\\perp}(t) = \\frac{1}{2}m v_{\\perp}(t)^2 \\propto (1+\\alpha t)$，比平行动能的增加，$E_{\\parallel}(t) = \\frac{1}{2}m v_{\\parallel}(t)^2 \\propto (1+\\alpha t)^{1/2}$，要快，导致粒子被“压扁”到垂直于 $\\vec{B}$ 的平面上。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} v_{\\perp}(t) = v_{\\perp 0} (1+\\alpha t)^{1/2},  v_{\\parallel}(t) = v_{\\parallel 0} (1+\\alpha t)^{1/4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "这项练习是连接理论与计算实践的桥梁，旨在将抽象的守恒定律转化为可量化的数值诊断。通过编写程序模拟带电粒子在磁阱中的反弹运动，你将亲手实现第二绝热不变量 $J_\\parallel$ 的计算，并验证其守恒性。更重要的是，通过调整磁场变化的时间尺度，你将能够直观地探索“绝热”条件的边界，理解当外部变化不再“缓慢”时，不变量是如何被破坏的 。",
            "id": "4180180",
            "problem": "考虑一个质量为 $m$、电荷为 $q$ 的带电粒子，在平行于磁场的电场为零的情况下，于非均匀磁场中运动。磁场强度的持续缓慢变化，会使囚禁在局部磁阱中的粒子产生弹跳运动。在源自洛伦兹力定律的导心近似下，沿场线弧长坐标 $l$ 的平行动力学可以用一个包含磁镜力的一维运动方程来表示。其基本依据是洛伦兹力定律和导心近似，这导出了演化方程 $dl/dt = v_\\parallel$ 和 $m\\,dv_\\parallel/dt = -\\mu\\,\\partial B/\\partial l$，其中 $\\mu$ 是磁矩，$B(l,t)$ 是沿场线的磁场强度。正则弹跳作用量诊断定义为平行正则动量在镜像点之间的空间路径上的弹跳积分。您的任务是从第一性原理出发，实现、测试并评估该诊断量的时间不变性。\n\n您必须编写一个完整且可运行的程序，该程序能够：\n- 对于一组指定参数，使用一维方程 $m\\,dv_\\parallel/dt = -\\mu\\,\\partial B/\\partial l$（其中 $dl/dt = v_\\parallel$ 且 $E_\\parallel = 0$）来模拟导心平行运动。\n- 使用磁场模型 $B(l,t) = B_0\\left(1+\\alpha\\,(l/L)^2\\right)\\left(1+\\varepsilon\\,\\sin(\\omega\\,t)\\right)$，其中 $B_0$ 是基础磁场，$\\alpha$ 控制磁阱的曲率，$L$ 是特征长度尺度，$\\varepsilon$ 是缓慢时间调制的无量纲振幅，$\\omega$ 是调制的角频率。\n- 计算弹跳作用量诊断 $J_\\parallel(t)$，其定义为 $J_\\parallel(t)=\\int_{l_1(t)}^{l_2(t)} p_\\parallel\\,dl$，其中 $p_\\parallel = m\\,v_\\parallel$，而 $l_1(t), l_2(t)$ 是由 $v_\\parallel(t)$ 的过零点确定的瞬时镜像点。\n- 通过对速度符号变化进行插值，实现精确的镜像点检测，以估计 $v_\\parallel=0$ 时的过零时间和位置。必须使用插值法在镜像点处设置 $p_\\parallel=0$，并界定每个半弹跳段。\n- 通过计算在模拟时间窗口内所有已解析的半弹跳段上的弹跳作用量，评估其时间不变性。这个评估通过无量纲相对变化 $\\Delta_J=\\left(\\max(J_\\parallel)-\\min(J_\\parallel)\\right)/\\langle J_\\parallel\\rangle$ 来定义，其中 $\\langle J_\\parallel\\rangle$ 是所有段上 $J_\\parallel$ 的算术平均值。如果检测到的半弹跳段少于两个，则该情况返回一个非数值浮点数。\n- 使用国际单位制（SI）：$l$ 的单位是米，$t$ 是秒，$v_\\parallel$ 是米/秒，$m$ 是千克，$B$ 是特斯拉，$\\mu$ 是焦耳/特斯拉，$J_\\parallel$ 是千克·米²/秒。每个测试用例最终报告的输出必须是无量纲量 $\\Delta_J$，表示为十进制数。\n\n数值要求：\n- 使用定步长显式方法对常微分方程进行积分；可接受四阶龙格-库塔（Runge–Kutta）格式。\n- 稳健地检测所有 $v_\\parallel$ 的符号变化，并使用线性插值来精确化镜像点的位置。\n- 对每个半弹跳，使用梯形法则，将 $p_\\parallel$ 作为 $l$ 的函数，在连续镜像点之间的模拟路径上进行数值积分，以计算弹跳作用量积分。\n\n测试套件：\n模拟以下参数集。每个参数集是一个元组 $(m,\\mu,B_0,\\alpha,L,l_0,v_0,\\varepsilon,\\omega,t_{\\mathrm{end}},\\Delta t)$，所有量均采用国际单位制（SI）：\n- 情况1（静态，深度囚禁）： $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,8.0\\times 10^{4},\\,0.0,\\,0.0,\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-6})$。\n- 情况2（静态，近分界线）： $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,1.95\\times 10^{5},\\,0.0,\\,0.0,\\,2.0\\times 10^{-2},\\,1.0\\times 10^{-6})$。\n- 情况3（缓慢时间调制）： $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,1.0\\times 10^{5},\\,1.0\\times 10^{-2},\\,1.0\\times 10^{3},\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-6})$。\n- 情况4（弹跳尺度上的强调制）： $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,1.0\\times 10^{5},\\,2.0\\times 10^{-1},\\,2.0\\times 10^{5},\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-6})$。\n- 情况5（极小振幅，静态）： $(2.0\\times 10^{-27},\\,3.5\\times 10^{-18},\\,3.0,\\,4.0,\\,1.0,\\,0.0,\\,2.0\\times 10^{4},\\,0.0,\\,0.0,\\,5.0\\times 10^{-3},\\,1.0\\times 10^{-6})$。\n\n答案规范：\n- 对每个测试用例，计算在模拟时间窗口内所有已解析的半弹跳段上的无量纲相对变化 $\\Delta_J$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[\\Delta J_1,\\Delta J_2,\\Delta J_3,\\Delta J_4,\\Delta J_5]$。",
            "solution": "该问题要求对一个在磁镜中进行弹跳运动的带电粒子的第二绝热不变量（称为纵向不变量或弹跳不变量 $J_\\parallel$）进行数值研究。该不变量的有效性基于一个原理：如果一个振荡系统的参数相对于振荡周期变化缓慢，那么在一个周期内的作用量积分近似为常数。在这里，我们将通过模拟粒子的运动并计算 $J_\\parallel$ 在不同条件下的变化来检验这一原理，特别是当磁场本身随时间变化时。\n\n平行导心运动的控制方程如下：\n$$\n\\frac{dl}{dt} = v_\\parallel\n$$\n$$\nm\\frac{dv_\\parallel}{dt} = F_\\parallel = -\\mu \\frac{\\partial B}{\\partial l}\n$$\n其中 $l$ 是沿磁场线的坐标，$v_\\parallel$ 是平行于场线的速度，$m$ 是粒子质量，$\\mu$ 是其磁矩，它被假定为一个常数（第一绝热不变量）。力 $F_\\parallel$ 源于磁场的空间梯度，被称为磁镜力。平行于 $\\vec{B}$ 的电场被指定为零 ($E_\\parallel = 0$)。\n\n该系统构成了一组两个耦合的一阶常微分方程（ODEs）。我们可以用一个向量 $\\mathbf{y}(t) = [l(t), v_\\parallel(t)]^T$ 来表示系统的状态。系统的演化则由 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$ 描述，其中：\n$$\n\\mathbf{f}(t, \\mathbf{y}) = \\begin{pmatrix} v_\\parallel \\\\ -\\frac{\\mu}{m} \\frac{\\partial B}{\\partial l} \\end{pmatrix}\n$$\n\n磁场模型被设定为一个带有正弦时间调制的抛物线阱：\n$$\nB(l,t) = B_0\\left(1+\\alpha\\left(\\frac{l}{L}\\right)^2\\right)\\left(1+\\varepsilon\\sin(\\omega t)\\right)\n$$\n为了计算磁镜力，我们必须求出 $B$ 相对于 $l$ 的偏导数：\n$$\n\\frac{\\partial B}{\\partial l} = B_0\\left(\\frac{2\\alpha l}{L^2}\\right)\\left(1+\\varepsilon\\sin(\\omega t)\\right)\n$$\n然后将此表达式代入 $v_\\parallel$ 的运动方程中。\n\n为了对该系统进行数值求解，我们采用四阶龙格-库塔（RK4）方法，这是一种用于积分常微分方程的稳健且广泛使用的显式格式。给定一个时间步长 $\\Delta t$，在时间 $t_{n+1} = t_n + \\Delta t$ 的状态向量 $\\mathbf{y}_{n+1}$ 可以通过在时间 $t_n$ 的状态 $\\mathbf{y}_n$ 按如下方式求得：\n$$\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(t_n, \\mathbf{y}_n)\n$$\n$$\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}\\left(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_1}{2}\\right)\n$$\n$$\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}\\left(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_2}{2}\\right)\n$$\n$$\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(t_n + \\Delta t, \\mathbf{y}_n + \\mathbf{k}_3)\n$$\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n我们从 $t=0$ 时的初始条件 $(l_0, v_0)$ 开始，逐步应用此格式，直到最终模拟时间 $t_{\\mathrm{end}}$，并在每一步存储轨迹 $(t_i, l_i, v_{\\parallel, i})$。\n\n分析的核心是弹跳作用量诊断 $J_\\parallel$，它定义为平行动量 $p_\\parallel = m v_\\parallel$ 沿两个连续镜像点 $l_1$ 和 $l_2$ 之间空间路径的积分。这对应于粒子的半个弹跳周期。\n$$\nJ_\\parallel = \\int_{l_1}^{l_2} p_\\parallel \\, dl\n$$\n镜像点是粒子平行运动反向的位置，即 $v_\\parallel = 0$ 的地方。在我们的离散模拟中，当 $v_\\parallel$ 的符号在两个连续时间步之间发生变化时，即 $v_{\\parallel, i-1} \\cdot v_{\\parallel, i} \\le 0$ 时，我们检测到一个镜像点穿越。为了精确定位镜像点，我们使用线性插值。如果穿越发生在时间 $t_{i-1}$ 和 $t_i$ 之间，穿越时间 $t_{\\text{mirror}}$ 可估计为：\n$$\nt_{\\text{mirror}} = t_{i-1} - v_{\\parallel, i-1} \\frac{t_i - t_{i-1}}{v_{\\parallel, i} - v_{\\parallel, i-1}}\n$$\n相应的位置 $l_{\\text{mirror}}$ 通过在 $t_{\\text{mirror}}$ 处对位置 $l(t)$ 进行线性插值得到：\n$$\nl_{\\text{mirror}} = l_{i-1} + (t_{\\text{mirror}} - t_{i-1}) \\frac{l_i - l_{i-1}}{t_i - t_{i-1}}\n$$\n\n模拟结束后，我们识别所有这些镜像点，将轨迹分割成一系列完整的半弹跳段。对于每个从起始镜像点 $M_1 = (t_{\\text{m1}}, l_{\\text{m1}})$ 到结束镜像点 $M_2 = (t_{\\text{m2}}, l_{\\text{m2}})$ 的段，我们构造积分路径。该路径由模拟中位于 $M_1$ 和 $M_2$ 之间的离散点序列 $(l_i, p_{\\parallel,i})$ 组成，并在起点和终点增补上动量为零的插值镜像点：$(l_{\\text{m1}}, 0)$ 和 $(l_{\\text{m2}}, 0)$。\n\n然后，按照规定，使用梯形法则对 $J_\\parallel$ 的积分进行数值计算。对于由点 $(l_j, p_{\\parallel, j})$ 定义的路径，积分为：\n$$\nJ_\\parallel \\approx \\sum_{j} \\frac{p_{\\parallel, j} + p_{\\parallel, j+1}}{2} (l_{j+1} - l_j)\n$$\n取结果的绝对值，因为作用量是一个正定量。\n\n最后，为了量化弹跳作用量的时间不变性，我们收集为所有已解析的半弹跳段计算出的 $J_\\parallel$ 值。然后我们计算无量纲相对变化 $\\Delta_J$：\n$$\n\\Delta_J = \\frac{\\max(J_\\parallel) - \\min(J_\\parallel)}{\\langle J_\\parallel \\rangle}\n$$\n其中 $\\langle J_\\parallel \\rangle$ 是所有测量的 $J_\\parallel$ 值的算术平均值。如果解析出的段少于两个，该度量未定义，我们报告一个非数值（NaN）值。对每个提供的测试用例重复此过程。\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        # (m, mu, B0, alpha, L, l0, v0, epsilon, omega, t_end, dt)\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 8.0e4, 0.0, 0.0, 1.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 1.95e5, 0.0, 0.0, 2.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 1.0e5, 1.0e-2, 1.0e3, 1.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 1.0e5, 2.0e-1, 2.0e5, 1.0e-2, 1.0e-6),\n        (2.0e-27, 3.5e-18, 3.0, 4.0, 1.0, 0.0, 2.0e4, 0.0, 0.0, 5.0e-3, 1.0e-6),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation_and_analyze(params)\n        results.append(result)\n\n    # Format output as specified\n    result_str = ','.join([f\"{r:.16e}\" if not np.isnan(r) else \"nan\" for r in results])\n    print(f\"[{result_str}]\")\n\n\ndef run_simulation_and_analyze(params):\n    \"\"\"\n    Runs the guiding-center simulation for one set of parameters and computes Delta_J.\n    \"\"\"\n    m, mu, B0, alpha, L, l0, v0_initial, eps, omega, t_end, dt = params\n\n    def force_over_m(l, t):\n        dB_dl = B0 * (2 * alpha * l / L**2) * (1 + eps * np.sin(omega * t))\n        return -mu / m * dB_dl\n\n    def derivatives(t, y):\n        l, v_parallel = y\n        dl_dt = v_parallel\n        dv_parallel_dt = force_over_m(l, t)\n        return np.array([dl_dt, dv_parallel_dt])\n\n    n_steps = int(t_end / dt)\n    t_hist = np.linspace(0, t_end, n_steps + 1)\n    l_hist = np.zeros(n_steps + 1)\n    v_hist = np.zeros(n_steps + 1)\n\n    l_hist[0] = l0\n    v_hist[0] = v0_initial\n\n    for i in range(n_steps):\n        t_n = t_hist[i]\n        y_n = np.array([l_hist[i], v_hist[i]])\n\n        k1 = dt * derivatives(t_n, y_n)\n        k2 = dt * derivatives(t_n + dt/2, y_n + k1/2)\n        k3 = dt * derivatives(t_n + dt/2, y_n + k2/2)\n        k4 = dt * derivatives(t_n + dt, y_n + k3)\n        \n        y_np1 = y_n + (k1 + 2*k2 + 2*k3 + k4) / 6\n        \n        l_hist[i+1] = y_np1[0]\n        v_hist[i+1] = y_np1[1]\n\n    mirror_points = []\n    for i in range(1, n_steps + 1):\n        if v_hist[i-1] * v_hist[i] = 0 and v_hist[i-1] != v_hist[i]:\n            v1, v2 = v_hist[i-1], v_hist[i]\n            t1, t2 = t_hist[i-1], t_hist[i]\n            l1, l2 = l_hist[i-1], l_hist[i]\n            \n            frac = -v1 / (v2 - v1) if (v2-v1) != 0 else 0.5\n            t_mirror = t1 + frac * (t2 - t1)\n            l_mirror = l1 + frac * (l2 - l1)\n\n            mirror_points.append({'t': t_mirror, 'l': l_mirror, 'idx_after': i})\n    \n    J_values = []\n    if len(mirror_points)  2:\n        return np.nan\n\n    for j in range(len(mirror_points) - 1):\n        start_mirror = mirror_points[j]\n        end_mirror = mirror_points[j+1]\n\n        idx_start_slice = start_mirror['idx_after']\n        idx_end_slice = end_mirror['idx_after']\n        \n        l_segment_full_steps = l_hist[idx_start_slice:idx_end_slice]\n        p_segment_full_steps = m * v_hist[idx_start_slice:idx_end_slice]\n\n        l_path = np.concatenate(([start_mirror['l']], l_segment_full_steps, [end_mirror['l']]))\n        p_path = np.concatenate(([0.0], p_segment_full_steps, [0.0]))\n        \n        J = np.trapz(p_path, l_path)\n        J_values.append(np.abs(J))\n\n    if len(J_values)  2:\n        return np.nan\n\n    J_values = np.array(J_values)\n    max_J = np.max(J_values)\n    min_J = np.min(J_values)\n    mean_J = np.mean(J_values)\n\n    if mean_J == 0:\n        return np.nan\n\n    delta_J = (max_J - min_J) / mean_J\n    return delta_J\n```",
            "answer": "[1.0091370600863810e-04,2.0138549999083320e-04,1.6391459492476570e-02,1.1593881373574972e+00,2.5228416041639524e-05]"
        }
    ]
}