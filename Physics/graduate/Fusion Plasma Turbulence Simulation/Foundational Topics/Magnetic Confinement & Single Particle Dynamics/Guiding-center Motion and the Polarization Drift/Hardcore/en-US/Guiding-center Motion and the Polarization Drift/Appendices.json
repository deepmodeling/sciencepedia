{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, we begin with a core calculation that reveals the essence of the polarization effect. This exercise  guides you through deriving the polarization drift and current from the fundamental Newton–Lorentz equation in a simplified, spatially uniform electric field. The key outcome is demonstrating the profound impact of particle mass, which explains why the polarization current in a typical fusion plasma is overwhelmingly dominated by ions rather than the much lighter electrons.",
            "id": "4190435",
            "problem": "Consider a spatially uniform, time-varying perpendicular electric field $\\mathbf{E}_{\\perp}(t) = E_{0} \\cos(\\omega t)\\,\\hat{\\mathbf{y}}$ in a uniform magnetic field $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$. Assume the guiding-center ordering holds (the characteristic variation frequency satisfies $\\omega \\ll \\Omega_{s}$, where $\\Omega_{s} = |q_{s}|B/m_{s}$ is the cyclotron frequency of species $s$). A quasi-neutral plasma is composed of singly charged deuterium ions ($q_{i} = +e$) and electrons ($q_{e} = -e$), with equal number densities $n_{i} = n_{e} = n$.\n\nStarting from the Newton–Lorentz equation $m_{s}\\,d\\mathbf{v}/dt = q_{s}\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)$ and the definition of the electric drift $\\mathbf{v}_{E} = \\mathbf{E}\\times\\mathbf{B}/B^{2}$, derive the leading-order guiding-center polarization drift velocity $\\mathbf{v}_{\\mathrm{pol},s}$ for each species $s \\in \\{i,e\\}$ produced by the time dependence of $\\mathbf{E}_{\\perp}(t)$. Then, compute the corresponding species-resolved polarization current density $\\mathbf{J}_{\\mathrm{pol},s}(t) = n_{s} q_{s}\\mathbf{v}_{\\mathrm{pol},s}(t)$ and its amplitude for the given $\\mathbf{E}_{\\perp}(t)$. Show explicitly how the mass $m_{s}$ and charge $q_{s}$ scale in $\\mathbf{J}_{\\mathrm{pol},s}$, and use this to obtain the ratio $R = \\left|\\mathbf{J}_{\\mathrm{pol},i}\\right|/\\left|\\mathbf{J}_{\\mathrm{pol},e}\\right|$. \n\nEvaluate $R$ numerically for deuterium ions using the following parameters representative of typical fusion-plasma turbulence conditions: $B = 5\\,\\mathrm{T}$, $E_{0} = 2.0\\times 10^{3}\\,\\mathrm{V/m}$, $\\omega = 2\\pi\\times 10^{5}\\,\\mathrm{rad/s}$, $n = 5.0\\times 10^{19}\\,\\mathrm{m^{-3}}$, $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, $m_{e} = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$, and $m_{i} = m_{D} = 3.343583719\\times 10^{-27}\\,\\mathrm{kg}$. \n\nRound your final answer for $R$ to four significant figures. Express the final answer as a dimensionless number in the International System of Units (SI).",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It represents a standard problem in plasma physics concerning guiding-center drifts. All provided parameters are physically reasonable, and the guiding-center ordering condition is satisfied for the given values, confirming the validity of the theoretical approach.\n\nThe solution proceeds by first deriving the general expression for the polarization drift velocity from the Newton-Lorentz equation. This velocity is then used to find the polarization current density, analyze its scaling properties, and finally compute the required ratio.\n\nThe motion of a charged particle of species $s$ with mass $m_s$ and charge $q_s$ in electric field $\\mathbf{E}$ and magnetic field $\\mathbf{B}$ is governed by the Newton-Lorentz equation:\n$$m_{s}\\frac{d\\mathbf{v}}{dt} = q_{s}\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)$$\nWe can rearrange this equation to solve for the velocity component perpendicular to the magnetic field, $\\mathbf{v}_{\\perp}$. Taking the cross product with $\\mathbf{B}$ on both sides of the rearranged equation $\\mathbf{v}\\times\\mathbf{B} = -\\mathbf{E} + \\frac{m_s}{q_s}\\frac{d\\mathbf{v}}{dt}$ yields:\n$$(\\mathbf{v}\\times\\mathbf{B})\\times\\mathbf{B} = -\\mathbf{E}\\times\\mathbf{B} + \\frac{m_s}{q_s}\\left(\\frac{d\\mathbf{v}}{dt}\\times\\mathbf{B}\\right)$$\nUsing the vector identity $(\\mathbf{A}\\times\\mathbf{B})\\times\\mathbf{C} = (\\mathbf{A}\\cdot\\mathbf{C})\\mathbf{B} - (\\mathbf{B}\\cdot\\mathbf{C})\\mathbf{A}$, the left-hand side becomes $(\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B} - (\\mathbf{B}\\cdot\\mathbf{B})\\mathbf{v} = B^2\\mathbf{v}_{\\parallel} - B^2(\\mathbf{v}_{\\parallel}+\\mathbf{v}_{\\perp}) = -B^2\\mathbf{v}_{\\perp}$. Thus, we have:\n$$-B^2\\mathbf{v}_{\\perp} = -\\mathbf{E}\\times\\mathbf{B} + \\frac{m_s}{q_s}\\left(\\frac{d\\mathbf{v}}{dt}\\times\\mathbf{B}\\right)$$\nSolving for $\\mathbf{v}_{\\perp}$:\n$$\\mathbf{v}_{\\perp} = \\frac{\\mathbf{E}\\times\\mathbf{B}}{B^2} - \\frac{m_s}{q_s B^2}\\left(\\frac{d\\mathbf{v}}{dt}\\times\\mathbf{B}\\right)$$\nThis equation is exact. The first term is the electric drift, $\\mathbf{v}_{E} = \\frac{\\mathbf{E}\\times\\mathbf{B}}{B^2}$. The second term contains the correction due to inertia. The guiding-center approximation assumes that the velocity $\\mathbf{v}$ inside the time derivative can be approximated by its lowest-order component, which is the electric drift, $\\mathbf{v} \\approx \\mathbf{v}_E$. This is valid when the characteristic frequency of the electric field variation, $\\omega$, is much smaller than the cyclotron frequency, $\\Omega_s$, which is given in the problem.\nThe perpendicular velocity is then approximated as the sum of the electric drift and the polarization drift, $\\mathbf{v}_{\\perp} \\approx \\mathbf{v}_E + \\mathbf{v}_{\\mathrm{pol},s}$.\n$$\\mathbf{v}_{\\perp} \\approx \\mathbf{v}_E - \\frac{m_s}{q_s B^2}\\left(\\frac{d\\mathbf{v}_E}{dt}\\times\\mathbf{B}\\right)$$\nFrom this, we identify the leading-order polarization drift velocity:\n$$\\mathbf{v}_{\\mathrm{pol},s} = - \\frac{m_s}{q_s B^2}\\left(\\frac{d\\mathbf{v}_E}{dt}\\times\\mathbf{B}\\right)$$\nAlternatively, by substituting $\\mathbf{v}_E$ and using vector identities, this can be written in terms of the time derivative of the electric field itself: $\\mathbf{v}_{\\mathrm{pol},s} = \\frac{m_s}{q_s B^2} \\frac{\\partial\\mathbf{E}_{\\perp}}{\\partial t}$.\n\nNow, we apply this to the given fields: $\\mathbf{E}_{\\perp}(t) = E_{0} \\cos(\\omega t)\\,\\hat{\\mathbf{y}}$ and $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$.\nFirst, calculate the electric drift $\\mathbf{v}_E$:\n$$\\mathbf{v}_{E}(t) = \\frac{(E_{0} \\cos(\\omega t)\\,\\hat{\\mathbf{y}}) \\times (B\\,\\hat{\\mathbf{z}})}{B^2} = \\frac{E_{0}B \\cos(\\omega t)}{B^2}(\\hat{\\mathbf{y}}\\times\\hat{\\mathbf{z}}) = \\frac{E_{0}}{B}\\cos(\\omega t)\\,\\hat{\\mathbf{x}}$$\nNext, differentiate $\\mathbf{v}_E$ with respect to time (since $\\mathbf{E}$ is spatially uniform, the total derivative is the partial derivative):\n$$\\frac{d\\mathbf{v}_{E}}{dt} = \\frac{\\partial\\mathbf{v}_{E}}{\\partial t} = -\\frac{\\omega E_{0}}{B}\\sin(\\omega t)\\,\\hat{\\mathbf{x}}$$\nNow, compute the cross product required for $\\mathbf{v}_{\\mathrm{pol},s}$:\n$$\\frac{d\\mathbf{v}_{E}}{dt}\\times\\mathbf{B} = \\left(-\\frac{\\omega E_{0}}{B}\\sin(\\omega t)\\,\\hat{\\mathbf{x}}\\right) \\times (B\\,\\hat{\\mathbf{z}}) = -\\omega E_{0}\\sin(\\omega t)(\\hat{\\mathbf{x}}\\times\\hat{\\mathbf{z}})$$\nSince $\\hat{\\mathbf{x}}\\times\\hat{\\mathbf{z}} = -\\hat{\\mathbf{y}}$, this becomes:\n$$\\frac{d\\mathbf{v}_{E}}{dt}\\times\\mathbf{B} = \\omega E_{0}\\sin(\\omega t)\\,\\hat{\\mathbf{y}}$$\nSubstituting this back into the expression for $\\mathbf{v}_{\\mathrm{pol},s}$:\n$$\\mathbf{v}_{\\mathrm{pol},s}(t) = - \\frac{m_s}{q_s B^2}\\left(\\omega E_{0}\\sin(\\omega t)\\,\\hat{\\mathbf{y}}\\right) = -\\frac{m_s \\omega E_{0}}{q_s B^2}\\sin(\\omega t)\\,\\hat{\\mathbf{y}}$$\nThe polarization current density for species $s$ is defined as $\\mathbf{J}_{\\mathrm{pol},s}(t) = n_{s} q_{s}\\mathbf{v}_{\\mathrm{pol},s}(t)$. Substituting the expression for $\\mathbf{v}_{\\mathrm{pol},s}$:\n$$\\mathbf{J}_{\\mathrm{pol},s}(t) = n_{s} q_{s} \\left(-\\frac{m_s \\omega E_{0}}{q_s B^2}\\sin(\\omega t)\\,\\hat{\\mathbf{y}}\\right) = -\\frac{n_s m_s \\omega E_0}{B^2}\\sin(\\omega t)\\,\\hat{\\mathbf{y}}$$\nFrom this expression, we analyze the scaling of the polarization current density. It is directly proportional to the particle mass, $\\mathbf{J}_{\\mathrm{pol},s} \\propto m_s$, and independent of the particle charge $q_s$ (the $q_s$ factor in the definition of current density cancels with the $1/q_s$ factor in the drift velocity).\n\nThe amplitude of the current density vector, which we denote as $|\\mathbf{J}_{\\mathrm{pol},s}|$, is the maximum value of its magnitude:\n$$|\\mathbf{J}_{\\mathrm{pol},s}| = \\frac{n_s m_s \\omega E_0}{B^2}$$\nThe problem asks for the ratio $R = |\\mathbf{J}_{\\mathrm{pol},i}|/|\\mathbf{J}_{\\mathrm{pol},e}|$, where the subscripts $i$ and $e$ denote ions and electrons, respectively.\n$$R = \\frac{|\\mathbf{J}_{\\mathrm{pol},i}|}{|\\mathbf{J}_{\\mathrm{pol},e}|} = \\frac{\\frac{n_i m_i \\omega E_0}{B^2}}{\\frac{n_e m_e \\omega E_0}{B^2}}$$\nThe parameters $\\omega$, $E_0$, and $B$ are common to both species and cancel out. The plasma is quasi-neutral, with $n_i = n_e = n$. Therefore, the ratio simplifies to the ratio of the particle masses:\n$$R = \\frac{n_i m_i}{n_e m_e} = \\frac{m_i}{m_e}$$\nThis demonstrates that the polarization current is dominated by the heavier species, the ions. The numerical values of $B$, $E_0$, $\\omega$, and $n$ are not required for the calculation of $R$, but they are consistent with the physical regime ($\\omega \\ll \\Omega_s$) where this theory applies.\n\nFinally, we evaluate $R$ using the given masses for deuterium ions ($m_i = m_D$) and electrons ($m_e$).\n$$m_{i} = 3.343583719\\times 10^{-27}\\,\\mathrm{kg}$$\n$$m_{e} = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$$\n$$R = \\frac{3.343583719\\times 10^{-27}\\,\\mathrm{kg}}{9.1093837015\\times 10^{-31}\\,\\mathrm{kg}} \\approx 3670.4824$$\nRounding the result to four significant figures gives:\n$$R \\approx 3670$$\nExpressing this in the required standard form for scientific notation yields $3.670 \\times 10^3$.",
            "answer": "$$\\boxed{3.670 \\times 10^{3}}$$"
        },
        {
            "introduction": "Moving from a uniform field to a more realistic scenario, this practice explores polarization effects within a spatially varying electric field, characteristic of a shear flow. By working through this problem , you will not only reinforce your derivation skills but also connect the microscopic drift motion to the macroscopic concept of polarization charge density, $\\rho_{\\mathrm{pol}}$. This exercise deepens your understanding of how plasma structure and dynamics generate charge separation through inertial effects.",
            "id": "4190417",
            "problem": "Consider a single ion species of charge $q>0$ and mass $m$ in a uniform, static magnetic field $\\mathbf{B} = B_0 \\,\\hat{\\mathbf{z}}$. The electrostatic potential is prescribed as $\\phi(x,t) = \\tfrac{1}{2}\\,S(t)\\,x^2$, where $S(t)$ is a smooth function of time and is spatially uniform. Assume the following ordering and simplifications, appropriate to the guiding-center and drift-kinetic limit relevant for fusion plasma turbulence simulation:\n- The gyromotion time scale is much faster than the evolution of $S(t)$.\n- The Larmor radius is small compared to the equilibrium scale length in $x$.\n- The magnetic field is uniform and time-independent.\n- Parallel dynamics and finite Larmor radius corrections beyond leading order are negligible.\n- The ion equilibrium density $n_0$ is uniform in space and constant in time.\n- The system is electrostatic and the electric field is $\\mathbf{E} = -\\nabla \\phi$.\n\nStart from the Newton–Lorentz equation for a single ion and from the definition of polarization charge density in macroscopic electromagnetism, together with charge conservation, to:\n1) Derive the leading-order guiding-center polarization drift velocity $\\mathbf{v}_{\\mathrm{pol}}(x,t)$ induced by the time variation of the electric field associated with $S(t)$.\n2) Derive the corresponding ion polarization charge density $\\rho_{\\mathrm{pol}}(x,t)$ generated by the finite-ion-mass polarization in this shear flow.\n\nYour derivation must begin from the Newton–Lorentz law $m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right)$ and standard macroscopic definitions (for example, relating the polarization vector $\\mathbf{P}$ to the polarization charge density via $\\rho_{\\mathrm{pol}} = -\\nabla\\cdot \\mathbf{P}$), without assuming any pre-known drift formulas. You may use vector identities and the strong-field drift ordering to eliminate the fast gyromotion and isolate the slow guiding-center dynamics.\n\nProvide as your final answer a single row matrix with two entries:\n- The first entry is the $x$-component of the polarization drift velocity $v_{\\mathrm{pol},x}(x,t)$, expressed in meters per second.\n- The second entry is the polarization charge density $\\rho_{\\mathrm{pol}}(x,t)$, expressed in coulombs per cubic meter.\n\nExpress both results as closed-form analytic expressions in terms of $m$, $q$, $B_0$, $n_0$, $S(t)$, $\\dot{S}(t)$, and $x$. Do not include units in the final boxed expressions. No numerical evaluation is required.",
            "solution": "We are given a uniform magnetic field $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$ and an electrostatic potential $\\phi(x,t) = \\tfrac{1}{2} S(t) x^2$. The electric field is\n$$\n\\mathbf{E}(x,t) = -\\nabla \\phi = - S(t)\\,x\\,\\hat{\\mathbf{x}}.\n$$\nWe aim to derive the guiding-center polarization drift and the induced polarization charge density starting from first principles.\n\nStep 1: Separate fast gyromotion from slow drift and identify the polarization drift.\nThe Newton–Lorentz equation is\n$$\nm \\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right).\n$$\nIn a strong, uniform magnetic field and for slowly varying fields, it is standard to decompose the perpendicular ion velocity into the sum of the electric-field cross magnetic-field drift ($\\mathbf{E}\\times\\mathbf{B}$ drift), the polarization drift, and the fast cyclotron motion:\n$$\n\\mathbf{v}_\\perp = \\mathbf{v}_{E} + \\mathbf{v}_{\\mathrm{pol}} + \\mathbf{v}_{\\mathrm{gyro}}.\n$$\nThe $\\mathbf{E}\\times\\mathbf{B}$ drift is defined kinematically by\n$$\n\\mathbf{v}_E = \\frac{\\mathbf{E}\\times \\mathbf{B}}{B_0^2},\n$$\nand satisfies $\\mathbf{v}_E \\times \\mathbf{B} = -\\mathbf{E}$ when $\\mathbf{E}\\perp \\mathbf{B}$ and $B_0$ is uniform. To leading order in the drift ordering, the slow perpendicular dynamics are governed by\n$$\nm \\frac{d\\mathbf{v}_E}{dt} \\approx q\\,\\mathbf{v}_{\\mathrm{pol}}\\times \\mathbf{B},\n$$\nwhere we have neglected $m\\,d\\mathbf{v}_{\\mathrm{pol}}/dt$ as higher order and used that $q(\\mathbf{E} + \\mathbf{v}_E\\times \\mathbf{B})=0$ identically. This vector equation can be solved for $\\mathbf{v}_{\\mathrm{pol}}$ by inverting the operation $\\mathbf{v}\\mapsto \\mathbf{v}\\times \\mathbf{B}$. For any vector $\\mathbf{a}$ perpendicular to $\\mathbf{B}$, the identity\n$$\n\\mathbf{v}\\times \\mathbf{B} = \\mathbf{a} \\;\\Longrightarrow\\; \\mathbf{v} = \\frac{\\mathbf{B}\\times \\mathbf{a}}{B_0^2}\n$$\nholds. Hence\n$$\n\\mathbf{v}_{\\mathrm{pol}} = \\frac{m}{q}\\,\\frac{\\mathbf{B}\\times \\frac{d\\mathbf{v}_E}{dt}}{B_0^2}.\n$$\nUsing $\\mathbf{v}_E = (\\mathbf{E}\\times \\mathbf{B})/B_0^2$ with constant $\\mathbf{B}$, we have\n$$\n\\frac{d\\mathbf{v}_E}{dt} = \\frac{1}{B_0^2}\\left(\\frac{d\\mathbf{E}}{dt}\\times \\mathbf{B}\\right).\n$$\nSubstituting,\n$$\n\\mathbf{v}_{\\mathrm{pol}} = \\frac{m}{q}\\,\\frac{\\mathbf{B}\\times \\left(\\frac{1}{B_0^2}\\left(\\frac{d\\mathbf{E}}{dt}\\times \\mathbf{B}\\right)\\right)}{B_0^2}\n= \\frac{m}{q B_0^4}\\left[\\mathbf{B}\\times \\left(\\frac{d\\mathbf{E}}{dt}\\times \\mathbf{B}\\right)\\right].\n$$\nUsing the vector identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{a}) = \\mathbf{b}(\\mathbf{a} \\cdot \\mathbf{a}) - \\mathbf{a}(\\mathbf{b} \\cdot \\mathbf{a})$ and noting $\\frac{d\\mathbf{E}}{dt}\\perp \\mathbf{B}$, we get\n$$\n\\mathbf{B}\\times \\left(\\frac{d\\mathbf{E}}{dt}\\times \\mathbf{B}\\right) = \\frac{d\\mathbf{E}}{dt}\\,B_0^2.\n$$\nTherefore,\n$$\n\\mathbf{v}_{\\mathrm{pol}} = \\frac{m}{q B_0^2}\\,\\frac{d\\mathbf{E}}{dt}.\n$$\nIn our configuration, the electric field depends on time only through $S(t)$ and on space only through $x$, and the $\\mathbf{E}\\times\\mathbf{B}$ advection does not change $\\mathbf{E}$ because $\\mathbf{v}_E$ is purely in the $\\hat{\\mathbf{y}}$ direction while $\\mathbf{E}$ depends only on $x$. Thus, to leading order, the total time derivative of $\\mathbf{E}$ along the guiding center reduces to the partial time derivative:\n$$\n\\frac{d\\mathbf{E}}{dt} \\approx \\frac{\\partial \\mathbf{E}}{\\partial t} = -\\dot{S}(t)\\,x\\,\\hat{\\mathbf{x}}.\n$$\nConsequently, the polarization drift is\n$$\n\\mathbf{v}_{\\mathrm{pol}}(x,t) = \\frac{m}{q B_0^2}\\left[-\\dot{S}(t)\\,x\\,\\hat{\\mathbf{x}}\\right] = -\\,\\frac{m\\,\\dot{S}(t)}{q\\,B_0^2}\\,x\\,\\hat{\\mathbf{x}}.\n$$\nThus the $x$-component is\n$$\nv_{\\mathrm{pol},x}(x,t) = -\\,\\frac{m\\,\\dot{S}(t)}{q\\,B_0^2}\\,x.\n$$\n\nStep 2: Polarization charge density from the polarization vector.\nThe polarization drift corresponds to a small displacement of the guiding center (the polarization displacement) $\\boldsymbol{\\xi}_{\\mathrm{pol}}$ satisfying $d\\boldsymbol{\\xi}_{\\mathrm{pol}}/dt = \\mathbf{v}_{\\mathrm{pol}}$. Integrating the relation $\\mathbf{v}_{\\mathrm{pol}} = (m/q B_0^2)\\,d\\mathbf{E}/dt$ in time yields the well-known form of the polarization displacement for ions,\n$$\n\\boldsymbol{\\xi}_{\\mathrm{pol}} = \\frac{m}{q B_0^2}\\,\\mathbf{E},\n$$\nup to an integration constant set to zero by choosing $\\boldsymbol{\\xi}_{\\mathrm{pol}} = \\mathbf{0}$ when $\\mathbf{E} = \\mathbf{0}$. The macroscopic polarization vector is the dipole moment per unit volume,\n$$\n\\mathbf{P} = n_0\\,q\\,\\boldsymbol{\\xi}_{\\mathrm{pol}} = n_0\\,\\frac{m}{B_0^2}\\,\\mathbf{E}.\n$$\nThe polarization charge density is the negative divergence of $\\mathbf{P}$,\n$$\n\\rho_{\\mathrm{pol}} = -\\nabla \\cdot \\mathbf{P} = -\\,\\nabla \\cdot \\left(n_0\\,\\frac{m}{B_0^2}\\,\\mathbf{E}\\right).\n$$\nWith $n_0$, $m$, and $B_0$ uniform and $\\mathbf{E} = -S(t)\\,x\\,\\hat{\\mathbf{x}}$, we have\n$$\n\\nabla \\cdot \\mathbf{E} = \\frac{\\partial E_x}{\\partial x} = \\frac{\\partial}{\\partial x}\\left[-S(t)\\,x\\right] = -\\,S(t),\n$$\nso\n$$\n\\rho_{\\mathrm{pol}}(x,t) = -\\,\\frac{n_0\\,m}{B_0^2}\\,\\nabla \\cdot \\mathbf{E} = -\\,\\frac{n_0\\,m}{B_0^2}\\,\\left[-S(t)\\right] = \\frac{n_0\\,m}{B_0^2}\\,S(t).\n$$\n\nSummary and interpretation.\n- The polarization drift is along $\\hat{\\mathbf{x}}$ and proportional to $\\dot{S}(t)$, specifically $v_{\\mathrm{pol},x}(x,t) = - (m \\dot{S}/(q B_0^2))\\,x$. Thus, a time-increasing shear $\\dot{S}(t)>0$ pushes ions in the negative $\\hat{\\mathbf{x}}$ direction for $x>0$.\n- The induced ion polarization charge density is spatially uniform and proportional to the instantaneous shear $S(t)$, $\\rho_{\\mathrm{pol}}(x,t) = (n_0 m/B_0^2)\\,S(t)$, reflecting the static guiding-center polarization $\\mathbf{P} \\propto \\mathbf{E}$ for fixed $S(t)$.\n\nUnits specification:\n- $v_{\\mathrm{pol},x}$ is to be expressed in meters per second.\n- $\\rho_{\\mathrm{pol}}$ is to be expressed in coulombs per cubic meter.\n\nPer the instructions, do not include units in the final boxed expressions.",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\dfrac{m\\,\\dot{S}(t)}{q\\,B_0^{2}}\\,x & \\dfrac{n_0\\,m}{B_0^{2}}\\,S(t)\\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice serves as a bridge between analytical theory and computational simulation, a crucial link for any modern plasma physicist. Here, we move beyond the cold-ion approximation to incorporate finite Larmor radius (FLR) effects, which are critical for accurately modeling turbulence. You will derive the gyroaveraging operator from first principles—revealing its identity as a Bessel function—and then use this to design and implement a numerical benchmark  for validating simulation codes, a highly practical and essential skill in the field.",
            "id": "4190432",
            "problem": "You are to design a computational benchmark that measures the finite Larmor radius (FLR) modified polarization response for a uniformly magnetized plasma species subject to a static, two-dimensional Gaussian electrostatic potential, and to compute the expected gyroaveraged profile in terms of the special function that emerges from the guiding-center orbit average of a plane-wave component. The underlying physical scenario is guiding-center motion and the polarization drift in the context of fusion plasma turbulence simulation. Your derivation and implementation must start from fundamental laws and definitions, not from any target formula.\n\nBegin with the Lorentz force law for a particle of mass $m$ and charge $q$ in uniform magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$ and electrostatic potential $\\phi(\\mathbf{x})$, with $\\mathbf{E} = -\\nabla \\phi$. Establish guiding-center motion and the orbit-averaging (gyroaveraging) operator by:\n- Defining the cyclotron frequency as $\\Omega = |q| B / m$, the instantaneous gyroradius as $\\rho = v_{\\perp} / \\Omega$, and the guiding-center position $\\mathbf{R}$.\n- Defining the gyroangle $\\theta$ and the circular orbit at fixed $\\rho$ by $\\mathbf{x}(\\theta) = \\mathbf{R} + \\rho(\\cos\\theta\\,\\hat{\\mathbf{x}} + \\sin\\theta\\,\\hat{\\mathbf{y}})$.\n- Defining the gyroaverage of any field $f(\\mathbf{x})$ at fixed guiding-center position as $\\langle f \\rangle(\\mathbf{R}) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} f(\\mathbf{R} + \\rho \\hat{\\boldsymbol{\\rho}}(\\theta))\\, d\\theta$.\n\nUse these definitions to derive, from first principles, the gyroaveraged response of a single Fourier plane-wave component $e^{i \\mathbf{k} \\cdot \\mathbf{x}}$ that appears when the Gaussian potential is expressed in Fourier space. Show that the result is a dimensionless radial function of $k_{\\perp} \\rho$ determined by the orbit-average integral definition of the gyroaverage operator, and identify this function as the expected profile to be used for validation. You must not introduce any shortcut formula directly; the derivation must proceed from the orbit-average definition.\n\nDefine the two-dimensional Gaussian potential as $\\phi(\\mathbf{x}) = \\phi_{0} \\exp\\left(-\\frac{x^{2}+y^{2}}{2 \\sigma^{2}}\\right)$ with characteristic width $\\sigma$ in meters and amplitude $\\phi_{0}$ in volts. In Fourier space, this potential is isotropic with spectral amplitude depending only on $k_{\\perp} = \\sqrt{k_{x}^{2} + k_{y}^{2}}$. Using the isotropy, define the following dimensionless benchmark metric that measures the net FLR-modified polarization response of the species to the Gaussian potential:\n$$\nS(\\sigma, \\rho) = \\frac{\\int_{0}^{\\infty} k_{\\perp}\\, e^{-\\sigma^{2} k_{\\perp}^{2}}\\, \\left[\\text{gyroaverage\\_factor}(k_{\\perp} \\rho)\\right]^{2}\\, dk_{\\perp}}{\\int_{0}^{\\infty} k_{\\perp}\\, e^{-\\sigma^{2} k_{\\perp}^{2}}\\, dk_{\\perp}},\n$$\nwhere the numerator weights the squared gyroaveraged spectral amplitude, and the denominator normalizes by the unmodified Gaussian spectrum. This scalar $S(\\sigma, \\rho)$ is dimensionless and lies between $0$ and $1$, with $S=1$ indicating no FLR attenuation (the zero Larmor radius limit). Compute $S(\\sigma,\\rho)$ numerically by radial quadrature, without assuming any closed form beforehand.\n\nTo compute $\\rho$ for the species, model the perpendicular thermal gyroradius using the thermal speed at energy $T$ (Joules):\n$$\nv_{\\perp,\\text{th}} = \\sqrt{\\frac{2 T}{m}},\\quad \\rho_{\\text{th}} = \\frac{v_{\\perp,\\text{th}}}{\\Omega} = \\frac{\\sqrt{2 T m}}{|q| B}.\n$$\nUse this $\\rho$ in all calculations. The gyroangle-dependent derivation ensures scientific realism by consistently treating the guiding-center orbit average under a uniform, static magnetic field.\n\nImplementation requirements:\n- For validation, compute the expected profile of the gyroaverage factor by evaluating the orbit-average integral of a plane wave $e^{i \\mathbf{k} \\cdot \\mathbf{x}}$ using its defining integral over $\\theta$. Express the result in terms of the standard special function that arises naturally from this integral, evaluated at $k_{\\perp} \\rho$. This profile is dimensionless and must be computed numerically for specified arguments, not by shortcut formula insertion in the problem statement.\n- Numerically evaluate the benchmark metric $S(\\sigma, \\rho)$ by performing the radial integral in $k$ using a stable change of variables if needed for convergence, and a reliable quadrature method. You may exploit isotropy and perform the integral over $k_{\\perp} \\ge 0$.\n\nPhysical units and angle units:\n- Use the International System of Units (SI): $m$ in kilograms, $q$ in coulombs, $B$ in tesla, $\\sigma$ in meters, $T$ in joules, and $\\phi_{0}$ in volts.\n- Gyroangles are in radians.\n- The final numerical outputs are dimensionless floats. Express all reported floats rounded to six decimal places.\n\nTest suite:\nCompute the benchmark metric and the validation profile for the following four cases. Use the elementary charge $e = 1.602176634 \\times 10^{-19}$ coulombs. The particle species is deuterium with mass $m = 3.343 \\times 10^{-27}$ kilograms and charge $q = e$.\n1. Case A (happy path): $B = 3.0$ tesla, $\\sigma = 2.0 \\times 10^{-3}$ meters, $T = 2000 \\times e$ joules.\n2. Case B (more small scales, stronger FLR filtering): $B = 3.0$ tesla, $\\sigma = 5.0 \\times 10^{-4}$ meters, $T = 2000 \\times e$ joules.\n3. Case C (boundary cold-ion limit): $B = 3.0$ tesla, $\\sigma = 2.0 \\times 10^{-3}$ meters, $T = 0$ joules.\n4. Case D (strong magnetic field, reduced gyroradius): $B = 7.0$ tesla, $\\sigma = 2.0 \\times 10^{-3}$ meters, $T = 2000 \\times e$ joules.\n\nFor each case, produce:\n- The scalar benchmark metric $S(\\sigma,\\rho)$.\n- A list of four values of the gyroaverage validation profile evaluated at the arguments $k_{\\perp} \\rho$ corresponding to $k_{\\perp} \\sigma \\in \\{0, 1, 2, 3\\}$, i.e., at $k_{\\perp} = \\frac{m}{\\sigma}$ for integers $m \\in \\{0,1,2,3\\}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of four sublists, one per test case, each sublist containing five floats rounded to six decimal places: first the benchmark metric $S$, then the four validation profile values at $k_{\\perp} \\sigma = 0,1,2,3$. The line must be exactly in the format:\n[[S_A,profile_A_0,profile_A_1,profile_A_2,profile_A_3],[S_B,profile_B_0,profile_B_1,profile_B_2,profile_B_3],[S_C,profile_C_0,profile_C_1,profile_C_2,profile_C_3],[S_D,profile_D_0,profile_D_1,profile_D_2,profile_D_3]]\nwhere each placeholder is replaced by the six-decimal float string without any additional whitespace or text.",
            "solution": "The problem requires the derivation and computation of a benchmark metric for the finite Larmor radius (FLR) modified polarization response of a plasma species to a static, two-dimensional Gaussian electrostatic potential. This involves deriving the gyroaverage of a plane wave from first principles, and then using this result to numerically evaluate the specified metric, $S(\\sigma, \\rho)$, for several test cases.\n\nThe physical model considers a particle of mass $m$ and charge $q$ in a uniform magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$. The particle's motion is governed by the Lorentz force, $\\mathbf{F} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$. In a strong magnetic field, this motion is well-approximated as a fast gyration around a slowly drifting guiding center. The particle's position vector $\\mathbf{x}$ can be decomposed into the guiding-center position $\\mathbf{R}$ and the gyroradius vector $\\boldsymbol{\\rho}$:\n$$\n\\mathbf{x} = \\mathbf{R} + \\boldsymbol{\\rho}\n$$\nThe gyroradius vector describes a circular orbit in the plane perpendicular to $\\mathbf{B}$. With the gyroangle $\\theta$, its components are given by:\n$$\n\\boldsymbol{\\rho}(\\theta) = \\rho(\\cos\\theta\\,\\hat{\\mathbf{x}} + \\sin\\theta\\,\\hat{\\mathbf{y}})\n$$\nwhere $\\rho = v_{\\perp} / \\Omega$ is the Larmor radius, $v_{\\perp}$ is the perpendicular speed, and $\\Omega = |q|B/m$ is the cyclotron frequency. Physical quantities experienced by the particle are often analyzed in terms of their gyroaverage, which is the average over one full gyration at a fixed guiding-center position $\\mathbf{R}$ and gyroradius $\\rho$. The gyroaverage of a field $f(\\mathbf{x})$ is defined as:\n$$\n\\langle f \\rangle(\\mathbf{R}, \\rho) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} f(\\mathbf{R} + \\boldsymbol{\\rho}(\\theta))\\, d\\theta\n$$\n\n**Derivation of the Gyroaverage Factor**\n\nTo analyze the effect of gyroaveraging on a spatially varying potential, we consider a single Fourier (plane-wave) component, $f(\\mathbf{x}) = e^{i \\mathbf{k} \\cdot \\mathbf{x}}$. The gyroaverage of this component is:\n$$\n\\langle e^{i \\mathbf{k} \\cdot \\mathbf{x}} \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} e^{i \\mathbf{k} \\cdot (\\mathbf{R} + \\boldsymbol{\\rho}(\\theta))} \\, d\\theta\n$$\nThe dot product in the exponent can be expanded as $\\mathbf{k} \\cdot \\mathbf{R} + \\mathbf{k} \\cdot \\boldsymbol{\\rho}(\\theta)$. The term $e^{i \\mathbf{k} \\cdot \\mathbf{R}}$ is constant with respect to the integration variable $\\theta$ and can be factored out:\n$$\n\\langle e^{i \\mathbf{k} \\cdot \\mathbf{x}} \\rangle = e^{i \\mathbf{k} \\cdot \\mathbf{R}} \\left( \\frac{1}{2\\pi} \\int_{0}^{2\\pi} e^{i \\mathbf{k} \\cdot \\boldsymbol{\\rho}(\\theta)} \\, d\\theta \\right)\n$$\nThe term $e^{i \\mathbf{k} \\cdot \\mathbf{R}}$ is the plane wave evaluated at the guiding-center position. The integral factor represents the modification due to the finite orbit size, and is the `gyroaverage_factor` we seek. Let's evaluate it.\n\nThe dot product $\\mathbf{k} \\cdot \\boldsymbol{\\rho}(\\theta)$ only involves the perpendicular components, $\\mathbf{k}_{\\perp}$ and $\\boldsymbol{\\rho}$. Let $\\mathbf{k}_{\\perp}$ have magnitude $k_{\\perp}$ and direction given by an angle $\\phi_k$ in the $xy$-plane, so $\\mathbf{k}_{\\perp} = k_{\\perp}(\\cos\\phi_k\\,\\hat{\\mathbf{x}} + \\sin\\phi_k\\,\\hat{\\mathbf{y}})$. Then:\n$$\n\\mathbf{k} \\cdot \\boldsymbol{\\rho}(\\theta) = \\mathbf{k}_{\\perp} \\cdot \\boldsymbol{\\rho}(\\theta) = k_{\\perp} \\rho (\\cos\\phi_k \\cos\\theta + \\sin\\phi_k \\sin\\theta) = k_{\\perp} \\rho \\cos(\\theta - \\phi_k)\n$$\nThe gyroaverage factor is thus:\n$$\n\\text{gyroaverage\\_factor}(k_{\\perp} \\rho) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} e^{i k_{\\perp} \\rho \\cos(\\theta - \\phi_k)} \\, d\\theta\n$$\nSince the integrand is periodic with period $2\\pi$, we can shift the integration variable by $\\phi_k$ (i.e., let $\\theta' = \\theta - \\phi_k$) without changing the value of the integral. This removes the dependence on the direction of $\\mathbf{k}_{\\perp}$, leaving only the dependence on its magnitude $k_{\\perp}$.\n$$\n\\text{gyroaverage\\_factor}(k_{\\perp} \\rho) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} e^{i k_{\\perp} \\rho \\cos\\theta'} \\, d\\theta'\n$$\nThis integral is a standard integral representation of the zeroth-order Bessel function of the first kind, $J_0(z)$, where $z = k_{\\perp}\\rho$.\n$$\nJ_0(z) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} e^{i z \\cos\\theta} \\, d\\theta\n$$\nTherefore, the gyroaverage factor is $J_0(k_{\\perp} \\rho)$. The gyroaveraged plane wave is $\\langle e^{i \\mathbf{k} \\cdot \\mathbf{x}} \\rangle = J_0(k_{\\perp} \\rho) e^{i \\mathbf{k} \\cdot \\mathbf{R}}$. The function $J_0(k_{\\perp} \\rho)$ is the dimensionless profile used for validation.\n\n**Formulation and Numerical Evaluation of the Benchmark Metric**\n\nThe problem defines a benchmark metric $S(\\sigma, \\rho)$ to quantify the net FLR-modified response:\n$$\nS(\\sigma, \\rho) = \\frac{\\int_{0}^{\\infty} k_{\\perp}\\, e^{-\\sigma^{2} k_{\\perp}^{2}}\\, \\left[J_0(k_{\\perp} \\rho)\\right]^{2}\\, dk_{\\perp}}{\\int_{0}^{\\infty} k_{\\perp}\\, e^{-\\sigma^{2} k_{\\perp}^{2}}\\, dk_{\\perp}}\n$$\nThe denominator provides normalization. It can be evaluated analytically. Let $u = k_{\\perp}^2$, so $du = 2k_{\\perp}dk_{\\perp}$:\n$$\n\\int_{0}^{\\infty} k_{\\perp}\\, e^{-\\sigma^{2} k_{\\perp}^{2}}\\, dk_{\\perp} = \\frac{1}{2} \\int_{0}^{\\infty} e^{-\\sigma^{2} u}\\, du = \\frac{1}{2} \\left[ -\\frac{1}{\\sigma^2} e^{-\\sigma^2 u} \\right]_{0}^{\\infty} = \\frac{1}{2\\sigma^2}\n$$\nSubstituting this into the expression for $S(\\sigma, \\rho)$:\n$$\nS(\\sigma, \\rho) = 2\\sigma^2 \\int_{0}^{\\infty} k_{\\perp}\\, e^{-\\sigma^{2} k_{\\perp}^{2}}\\, [J_0(k_{\\perp} \\rho)]^{2}\\, dk_{\\perp}\n$$\nFor robust numerical integration, we introduce a change of variables, $x = \\sigma k_{\\perp}$, which implies $k_{\\perp} = x/\\sigma$ and $dk_{\\perp} = dx/\\sigma$.\n$$\nS(\\sigma, \\rho) = 2\\sigma^2 \\int_{0}^{\\infty} \\frac{x}{\\sigma} e^{-x^2} \\left[J_0\\left(\\frac{x}{\\sigma}\\rho\\right)\\right]^2 \\frac{dx}{\\sigma} = 2 \\int_{0}^{\\infty} x e^{-x^2} \\left[J_0\\left(x \\frac{\\rho}{\\sigma}\\right)\\right]^2 dx\n$$\nLetting $\\alpha = \\rho/\\sigma$, the metric becomes a function of this single dimensionless parameter:\n$$\nS(\\alpha) = 2 \\int_{0}^{\\infty} x e^{-x^2} [J_0(\\alpha x)]^2 dx\n$$\nThis integral will be computed numerically using quadrature, as required.\n\nFor the special case where the temperature $T=0$, the thermal speed is zero, which leads to a gyroradius $\\rho=0$. In this limit, $\\alpha=0$. Since $J_0(0) = 1$, the integral simplifies to:\n$$\nS(0) = 2 \\int_{0}^{\\infty} x e^{-x^2} [1]^2 dx = \\int_{0}^{\\infty} e^{-u} du = 1\n$$\nThis corresponds to the cold-plasma or zero-Larmor-radius limit where there is no FLR attenuation.\n\n**Computational Strategy for Test Cases**\n\nFor each test case with parameters $(B, \\sigma, T)$:\n1.  **Calculate Gyroradius**: The thermal gyroradius $\\rho$ is computed using the deuterium mass $m_D$, elementary charge $e$, magnetic field $B$, and temperature $T$ (in Joules):\n    $$\n    \\rho = \\frac{\\sqrt{2 T m_D}}{e B}\n    $$\n2.  **Calculate Benchmark Metric $S$**:\n    *   Compute the ratio $\\alpha = \\rho/\\sigma$.\n    *   If $\\alpha=0$, $S=1.0$.\n    *   If $\\alpha>0$, numerically evaluate the integral $S(\\alpha) = 2 \\int_{0}^{\\infty} x e^{-x^2} [J_0(\\alpha x)]^2 dx$ using a standard quadrature method.\n3.  **Calculate Validation Profile**:\n    *   The validation profile is $J_0(k_{\\perp} \\rho)$.\n    *   Evaluate this profile at the specified points $k_{\\perp} = m/\\sigma$ for $m \\in \\{0, 1, 2, 3\\}$. The arguments of the Bessel function are thus $k_{\\perp}\\rho = (m/\\sigma)\\rho = m \\alpha$.\n    *   The four validation values are $J_0(0)$, $J_0(\\alpha)$, $J_0(2\\alpha)$, and $J_0(3\\alpha)$.\n\nThis procedure allows for a complete and verifiable computation based on the provided physical model and definitions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, special\n\ndef solve():\n    \"\"\"\n    Computes a benchmark metric for FLR-modified polarization response and\n    a validation profile for four test cases in plasma physics.\n    \"\"\"\n    # Physical constants\n    e_charge = 1.602176634e-19  # Elementary charge in Coulombs\n    m_deuterium = 3.343e-27      # Deuterium mass in kilograms\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (B [T], sigma [m], T [eV])\n    # The problem specifies T in Joules as 2000 * e, so T_eV is 2000.\n    test_cases = [\n        (3.0, 2.0e-3, 2000.0),  # Case A\n        (3.0, 5.0e-4, 2000.0),  # Case B\n        (3.0, 2.0e-3, 0.0),      # Case C\n        (7.0, 2.0e-3, 2000.0),  # Case D\n    ]\n\n    all_results = []\n\n    for B, sigma, T_eV in test_cases:\n        # Convert temperature from eV to Joules\n        T_joules = T_eV * e_charge\n        \n        # Calculate the thermal gyroradius (rho)\n        if T_joules == 0:\n            rho = 0.0\n        else:\n            # Perpendicular thermal speed squared: v_perp_th^2 = 2*T/m\n            # Gyroradius: rho = m*v_perp_th / (q*B) = sqrt(2*T*m) / (|q|*B)\n            # For deuterium, charge q = e_charge.\n            numerator = np.sqrt(2 * T_joules * m_deuterium)\n            denominator = e_charge * B\n            rho = numerator / denominator\n\n        # The dimensionless parameter for the integral is alpha = rho / sigma\n        # Handle sigma=0 although not present in tests to avoid division by zero.\n        if sigma == 0:\n            # This case physically corresponds to an infinitely localized potential.\n            # FLR effects would completely average it out, S -> 0 if rho > 0.\n            # If rho also 0, it's undefined. We assume sigma > 0 per problem.\n            alpha = np.inf if rho > 0 else 0\n        else:\n            alpha = rho / sigma\n        \n        # --- Calculate the benchmark metric S ---\n        if alpha == 0:\n            # Zero Larmor radius limit, S = 1 analytically.\n            s_metric = 1.0\n        else:\n            # Integrand for S: 2 * x * exp(-x^2) * J0(alpha*x)^2\n            integrand = lambda x: 2.0 * x * np.exp(-x**2) * (special.j0(alpha * x))**2\n            # Perform numerical quadrature from 0 to infinity\n            s_metric, _ = integrate.quad(integrand, 0, np.inf)\n\n        # --- Calculate the validation profile ---\n        # The profile is J0(k_perp * rho) = J0( (m/sigma) * rho ) = J0(m * alpha)\n        # for m in {0, 1, 2, 3}\n        profile_args = [m * alpha for m in range(4)]\n        profile_values = special.j0(profile_args)\n\n        # Collect results for this case\n        case_results = [s_metric] + profile_values.tolist()\n        \n        # Round all results to six decimal places\n        rounded_results = [round(val, 6) for val in case_results]\n        all_results.append(rounded_results)\n\n    # Format the final output string as specified\n    # e.g., [[S_A,p0,p1,p2,p3],[S_B,...],...]\n    def format_sublist(sublist):\n        return f\"[{','.join(map(str, sublist))}]\"\n\n    final_output_str = f\"[{','.join(map(format_sublist, all_results))}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}