{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践是量子热力学中的一个典型问题：一个双能级系统与热库的相互作用。通过从第一性原理出发，构建描述系统演化的 Gorini-Kossakowski-Sudarshan-Lindblad (GKSL) 方程，你将亲手推导出跃迁算符及其对应的速率。这项练习的核心是展示热库的 Kubo-Martin-Schwinger (KMS) 条件如何直接转化为系统跃迁速率所满足的量子细致平衡条件 ()，从而为你理解开放系统如何趋向热平衡奠定坚实的数学基础。",
            "id": "3778100",
            "problem": "考虑一个双能级量子系统，其哈密顿量为 $H=\\frac{\\omega_{0}}{2}\\sigma_{z}$，与一个逆温度为 $\\beta$ 的玻色子热环境弱相互作用。相互作用哈密顿量为 $H_{\\mathrm{I}}=\\lambda\\,\\sigma_{x}\\otimes B$，其中 $\\lambda$ 是一个小的耦合常数，$\\sigma_{x}=\\sigma_{+}+\\sigma_{-}$ 是用阶梯算符 $\\sigma_{\\pm}$ 表示的系统耦合算符，$B$ 是一个由谐振子模式组成的线性热库算符。假设玻恩-马尔可夫近似和久期近似适用，并且环境初始时处于关于其自由哈密顿量的、逆温度为 $\\beta$ 的吉布斯态。那么系统的约化动力学就是一个由 Gorini-Kossakowski-Sudarshan-Lindblad (GKSL) 生成元生成的量子动力学半群，其耗散率由环境的平衡关联函数通过 Kubo-Martin-Schwinger (KMS) 条件确定。\n\n从 $H$ 的玻尔频率和本征算符的定义出发，并从平衡热库关联函数及其傅里叶变换出发，通过确定跃迁算符及其相关的跃迁速率，为该系统构造 GKSL 生成元。然后，对于一个谱密度为 $J(\\omega)$ 且玻色-爱因斯坦占据数为 $n_{\\mathrm{B}}(\\omega)=\\frac{1}{\\exp(\\beta \\omega)-1}$ 的玻色子环境，用 $J(\\omega_{0})$ 和 $\\beta$ 表示向上和向下的跃迁速率，并验证量子细致平衡条件 $G(-\\omega_{0})=\\exp(-\\beta \\omega_{0})\\,G(\\omega_{0})$。\n\n你的最终答案必须是仅用 $J(\\omega_{0})$ 和 $\\beta$ 写出的 $G(\\omega_{0})$ 和 $G(-\\omega_{0})$ 的闭式表达式对，不进行数值代入，不需要四舍五入，最终答案中不包含物理单位。",
            "solution": "该问题是有效的，因为它代表了开放量子系统理论中的一个标准的、适定的问题，特别是自旋-玻色子模型的林德布拉德主方程的推导。所有提供的信息都是有科学依据的、自洽的，并且足以推导出一个唯一的解。\n\n所讨论的系统是一个双能级量子系统（一个量子比特），其自由动力学由哈密顿量 $H=\\frac{\\omega_{0}}{2}\\sigma_{z}$ 控制。该哈密顿量的本征态是激发态 $|e\\rangle$ 和基态 $|g\\rangle$，分别对应于泡利算符 $\\sigma_z$ 的本征值 $+1$ 和 $-1$。因此，能量本征值为 $E_e = +\\frac{\\omega_0}{2}$ 和 $E_g = -\\frac{\\omega_0}{2}$。这些能级之间的能量差定义了系统的特征玻尔频率，$\\Delta E = E_e - E_g = \\omega_0$。要发生跃迁，系统必须吸收或放出等于 $\\omega_0$ 的能量。\n\n系统通过相互作用哈密顿量 $H_{\\mathrm{I}}=\\lambda\\,\\sigma_{x}\\otimes B$ 与热环境相互作用。此相互作用的系统部分是 $\\sigma_x$。为了在久期近似下分析耗散动力学，我们必须将系统算符 $\\sigma_x$ 分解为自由哈密顿量伴随作用的本征算符，即对于某个玻尔频率 $\\omega$ 满足 $[H, A] = -\\omega A$ 的算符 $A$。算符 $\\sigma_x$ 可以用阶梯算符 $\\sigma_+ = |e\\rangle\\langle g|$ 和 $\\sigma_- = |g\\rangle\\langle e|$ 表示为 $\\sigma_x = \\sigma_+ + \\sigma_-$。\n我们来求与这些阶梯算符相关的玻尔频率。\n对于 $\\sigma_-$，我们有：\n$$[H, \\sigma_-] = \\left[\\frac{\\omega_0}{2}\\sigma_z, |g\\rangle\\langle e|\\right] = \\frac{\\omega_0}{2} (\\sigma_z |g\\rangle\\langle e| - |g\\rangle\\langle e| \\sigma_z) = \\frac{\\omega_0}{2}(-1 \\cdot |g\\rangle\\langle e| - |g\\rangle\\langle e| \\cdot 1) = -\\omega_0 |g\\rangle\\langle e| = -\\omega_0 \\sigma_-$$\n这意味着 $\\sigma_-$ 是一个玻尔频率为 $\\omega = \\omega_0$ 的本征算符。该算符引起从 $|e\\rangle$ 到 $|g\\rangle$ 的向下跃迁，对应于系统失去能量 $\\omega_0$。\n\n对于 $\\sigma_+$，我们有：\n$$[H, \\sigma_+] = \\left[\\frac{\\omega_0}{2}\\sigma_z, |e\\rangle\\langle g|\\right] = \\frac{\\omega_0}{2} (\\sigma_z |e\\rangle\\langle g| - |e\\rangle\\langle g| \\sigma_z) = \\frac{\\omega_0}{2}(1 \\cdot |e\\rangle\\langle g| - |e\\rangle\\langle g| \\cdot (-1)) = \\omega_0 |e\\rangle\\langle g| = \\omega_0 \\sigma_+$$\n这意味着 $\\sigma_+$ 是一个玻尔频率为 $\\omega = -\\omega_0$ 的本征算符。该算符引起从 $|g\\rangle$ 到 $|e\\rangle$ 的向上跃迁，对应于系统获得能量 $\\omega_0$。\n\n在玻恩、马尔可夫和久期近似下，系统约化密度矩阵 $\\rho_S$ 的动力学由 Gorini-Kossakowski-Sudarshan-Lindblad (GKSL) 主方程描述。对于该系统，它采取以下形式：\n$$\\frac{d\\rho_S}{dt} = -i[H, \\rho_S] + \\mathcal{D}(\\rho_S)$$\n耗散部分，或称林德布拉德算符（Lindbladian） $\\mathcal{D}(\\rho_S)$，是每个跃迁过程贡献的总和：\n$$\\mathcal{D}(\\rho_S) = G(\\omega_0) \\left( \\sigma_- \\rho_S \\sigma_+ - \\frac{1}{2}\\{\\sigma_+ \\sigma_-, \\rho_S\\} \\right) + G(-\\omega_0) \\left( \\sigma_+ \\rho_S \\sigma_- - \\frac{1}{2}\\{\\sigma_- \\sigma_+, \\rho_S\\} \\right)$$\n在这里，算符 $\\sigma_-$ 和 $\\sigma_+$ 是跃迁算符。速率 $G(\\omega_0)$ 对应于向下跃迁（衰变率），而 $G(-\\omega_0)$ 对应于向上跃迁（激发率）。这些速率由热库关联函数的傅里叶变换在相应玻尔频率处的值确定：\n$$G(\\omega) = \\lambda^2 \\int_{-\\infty}^{\\infty} d\\tau \\, e^{i\\omega\\tau} \\langle B(\\tau) B(0) \\rangle_{\\beta}$$\n其中 $B(\\tau) = e^{iH_B \\tau} B e^{-iH_B \\tau}$ 是相对于热库哈密顿量 $H_B$ 的相互作用绘景中的热库算符，而期望值 $\\langle \\cdot \\rangle_{\\beta}$ 是对热库的热吉布斯态 $\\rho_B = \\exp(-\\beta H_B) / \\mathrm{Tr}[\\exp(-\\beta H_B)]$ 取的。\n\n问题指出，环境是一个玻色子热库，其特征在于谱密度 $J(\\omega)$ 和玻色-爱因斯坦分布 $n_{\\mathrm{B}}(\\omega)=\\frac{1}{\\exp(\\beta \\omega)-1}$。谱密度 $J(\\omega)$ 通常定义在 $\\omega > 0$ 的情况下，并包含了耦合强度 $\\lambda^2$ 和频率为 $\\omega$ 的热库模式密度。速率 $G(\\omega_0)$ 和 $G(-\\omega_0)$ 可以通过涨落-耗散定理用 $J(\\omega_0)$ 和 $n_{\\mathrm{B}}(\\omega_0)$ 来表示。\n\n向下速率 $G(\\omega_0)$ 对应于系统向热库失去能量 $\\omega_0$（发射）。这个过程可以是自发的，也可以是由热库中已有的热激发所激发的。因此，该速率与 $J(\\omega_0)$ 和因子 $(n_{\\mathrm{B}}(\\omega_0) + 1)$ 成正比：\n$$G(\\omega_0) = J(\\omega_0) (n_{\\mathrm{B}}(\\omega_0) + 1)$$\n\n向上速率 $G(-\\omega_0)$ 对应于系统从热库获得能量 $\\omega_0$（吸收）。这个过程只有在热库有热激发来提供能量时才能发生。因此，该速率与 $J(\\omega_0)$ 和热玻色子数 $n_{\\mathrm{B}}(\\omega_0)$ 成正比：\n$$G(-\\omega_0) = J(\\omega_0) n_{\\mathrm{B}}(\\omega_0)$$\n\n现在我们通过代入 $n_{\\mathrm{B}}(\\omega_0)$ 的定义，将这些速率仅用 $J(\\omega_0)$ 和 $\\beta$ 来表示：\n$$G(\\omega_0) = J(\\omega_0) \\left( \\frac{1}{\\exp(\\beta \\omega_0) - 1} + 1 \\right) = J(\\omega_0) \\left( \\frac{1 + \\exp(\\beta \\omega_0) - 1}{\\exp(\\beta \\omega_0) - 1} \\right) = J(\\omega_0) \\frac{\\exp(\\beta \\omega_0)}{\\exp(\\beta \\omega_0) - 1}$$\n$$G(-\\omega_0) = J(\\omega_0) \\frac{1}{\\exp(\\beta \\omega_0) - 1}$$\n这些就是跃迁速率的最终表达式。\n\n最后，我们必须验证量子细致平衡条件，$G(-\\omega_{0})=\\exp(-\\beta \\omega_{0})\\,G(\\omega_{0})$。这个条件确保了在没有外部驱动的情况下，系统最终会热化到与热库相同温度的吉布斯态。让我们将我们推导出的表达式代入条件的右侧：\n$$\\exp(-\\beta \\omega_0) G(\\omega_0) = \\exp(-\\beta \\omega_0) \\left( J(\\omega_0) \\frac{\\exp(\\beta \\omega_0)}{\\exp(\\beta \\omega_0) - 1} \\right)$$\n$$= J(\\omega_0) \\frac{\\exp(-\\beta \\omega_0) \\exp(\\beta \\omega_0)}{\\exp(\\beta \\omega_0) - 1} = J(\\omega_0) \\frac{1}{\\exp(\\beta \\omega_0) - 1}$$\n这个结果恰好是我们对 $G(-\\omega_0)$ 的表达式。因此，条件 $G(-\\omega_{0})=\\exp(-\\beta \\omega_{0})\\,G(\\omega_{0})$ 得到验证。\n\n最终答案要求给出 $G(\\omega_0)$ 和 $G(-\\omega_0)$ 的闭式表达式。\n$G(\\omega_0)$ 是向下（发射）跃迁速率。\n$G(-\\omega_0)$ 是向上（吸收）跃迁速率。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nJ(\\omega_0) \\frac{\\exp(\\beta \\omega_0)}{\\exp(\\beta \\omega_0) - 1} & J(\\omega_0) \\frac{1}{\\exp(\\beta \\omega_0) - 1}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了双能级系统的基础之后，我们将把注意力转向另一个基石模型：量子谐振子。这个练习旨在将细致平衡的概念从有限维系统推广到无限维系统。你将为与热库耦合的谐振子构建一个热化生成元，并证明其稳态正是由玻色-爱因斯坦分布描述的热基普斯态 ()。通过这个计算，你将深化对细致平衡如何确保系统宏观性质（如平均粒子数）与环境温度相符的理解。",
            "id": "3778137",
            "problem": "考虑一个单一的玻色子模式，其哈密顿量为 $H=\\omega\\,a^{\\dagger}a$，粒子数算符为 $N=a^{\\dagger}a$。该模式通过相互作用 $H_{\\mathrm{I}}=\\epsilon\\,x\\otimes B$（其中 $x=a+a^{\\dagger}$，$B$ 为热库算符）与一个逆温度为 $\\beta$ 的宽带玻色子热库弱耦合。在 Born–Markov–secular 极限下，并在关于 $H+H_{\\mathrm{B}}$（其中 $H_{\\mathrm{B}}$ 是热库哈密顿量）的相互作用绘景中进行计算。假设热库处于逆温度为 $\\beta$ 的热（吉布斯）态，因此其稳态关联函数 $C_{B}(t)=\\langle B(t)B(0)\\rangle_{\\beta}$ 的傅里叶变换 $S_{B}(\\omega)=\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\,\\exp(i\\omega t)\\,C_{B}(t)$ 满足 Kubo–Martin–Schwinger (KMS) 条件 $S_{B}(-\\omega)=\\exp(-\\beta\\omega)S_{B}(\\omega)$。令 $\\gamma(\\omega)=\\epsilon^{2}S_{B}(\\omega)$ 表示在弱耦合生成元中与玻尔频率 $\\omega$ 相关联的速率。\n\n仅使用这些前提和简谐振子本征算符的标准性质，完成以下任务：\n\n1.  推导约化动力学的 Gorini–Kossakowski–Sudarshan–Lindblad (GKSL) 生成元，证明唯一的跃迁算符是 $a$ 和 $a^{\\dagger}$，其速率分别为 $\\gamma(\\omega)$ 和 $\\gamma(-\\omega)$。\n2.  使用 Kubo–Martin–Schwinger 条件来展示量子细致平衡，方法是将这两个速率用一个共同的前因子 $\\Gamma(\\omega)$ 和 Bose–Einstein 占据因子 $n(\\omega)=1/(\\exp(\\beta\\omega)-1)$ 来表示，即表示为与 $n(\\omega)$ 和 $n(\\omega)+1$ 成比例的形式。\n3.  明确证明吉布斯态 $\\rho_{\\beta}=\\exp(-\\beta H)/Z$ 在所推导的生成元作用下是稳恒的。\n4.  从稳恒解中，确定稳态期望值 $\\langle a^{\\dagger}a\\rangle_{\\mathrm{ss}}$，作为 $\\beta$ 和 $\\omega$ 的闭合形式函数。\n\n取普朗克常数和玻尔兹曼常数为1。最终答案请提供 $\\langle a^{\\dagger}a\\rangle_{\\mathrm{ss}}$ 仅以 $\\beta$ 和 $\\omega$ 表示的单一闭合形式表达式。无需进行数值计算。",
            "solution": "问题陈述经评估有效。它在科学上基于开放量子系统的标准理论，特别是对与热库耦合的量子简谐振子的 Born-Markov-secular 处理。该问题设定良好、客观，并包含了进行严格推导所需的所有必要信息。它代表了量子光学和热力学中的一个标准形式问题。\n\n解答过程按顺序处理四个要求的部分。根据问题陈述，我们取 $\\hbar=1$ 和 $k_B=1$。\n\n1. Gorini–Kossakowski–Sudarshan–Lindblad (GKSL) 生成元的推导。\n\n总哈密顿量为 $H_{\\mathrm{tot}} = H + H_{\\mathrm{B}} + H_{\\mathrm{I}}$，其中 $H=\\omega\\,a^{\\dagger}a$ 是系统哈密顿量，$H_{\\mathrm{B}}$ 是热库哈密顿量，$H_{\\mathrm{I}}=\\epsilon\\,x\\otimes B$ 是相互作用哈密顿量，其中 $x=a+a^{\\dagger}$。我们在相对于 $H_0 = H+H_B$ 的相互作用绘景中进行计算。此绘景中的相互作用哈密顿量为 $H_{\\mathrm{I}}(t) = \\exp(iH_0 t) H_{\\mathrm{I}} \\exp(-iH_0 t) = \\epsilon\\,x(t)\\otimes B(t)$，其中 $x(t) = \\exp(iHt)x\\exp(-iHt)$ 且 $B(t)=\\exp(iH_{\\mathrm{B}}t)B\\exp(-iH_{\\mathrm{B}}t)$。\n\n系统算符 $x(t)$ 可以使用阶梯算符的时间演化进行分解：\n$a(t) = \\exp(i\\omega a^{\\dagger}at)a\\exp(-i\\omega a^{\\dagger}at) = a\\exp(-i\\omega t)$\n$a^{\\dagger}(t) = \\exp(i\\omega a^{\\dagger}at)a^{\\dagger}\\exp(-i\\omega a^{\\dagger}at) = a^{\\dagger}\\exp(i\\omega t)$\n因此，$x(t) = a\\exp(-i\\omega t) + a^{\\dagger}\\exp(i\\omega t)$。\n\n相互作用哈密顿量 $H_{\\mathrm{I}}(t)$ 包含的系统算符是系统哈密顿量伴随作用的本征算符，即 $[H, A_{\\nu}] = -\\nu A_{\\nu}$。对于 $A=a$，我们有 $[H, a] = [\\omega a^{\\dagger}a, a] = -\\omega a$，因此关联的频率是 $\\omega$。对于 $A=a^{\\dagger}$，我们有 $[H, a^{\\dagger}] = [\\omega a^{\\dagger}a, a^{\\dagger}] = +\\omega a^{\\dagger}$，因此关联的频率是 $-\\omega$。\n\n在 Born-Markov 和 secular 近似下，薛定谔绘景中约化系统密度算符 $\\rho$ 的主方程由 GKSL 形式给出：\n$$ \\frac{d\\rho}{dt} = \\mathcal{L}(\\rho) = \\sum_{\\nu} \\gamma(\\nu) \\left( A_{\\nu} \\rho A_{\\nu}^{\\dagger} - \\frac{1}{2} \\{A_{\\nu}^{\\dagger}A_{\\nu}, \\rho\\} \\right) $$\n其中求和遍及系统唯一的玻尔频率 $\\nu$，$A_{\\nu}$ 是从相互作用算符分解得到的相应系统本征算符，$\\gamma(\\nu)$ 是关联的速率。\n\n在我们的情况中，系统算符是 $x=a+a^{\\dagger}$。本征算符是 $A_{\\omega}=a$ 和 $A_{-\\omega}=a^{\\dagger}$。速率 $\\gamma(\\nu)$ 由热库关联函数的傅里叶变换决定，$S_B(\\nu) = \\int_{-\\infty}^{\\infty} e^{i\\nu t} \\langle B(t)B(0) \\rangle_{\\beta} dt$。具体来说，速率由 $\\gamma(\\nu) = \\epsilon^2 S_B(\\nu)$ 给出。\n\n因此，我们有两个跃迁过程：\n- 一个与算符 $A_{\\omega}=a$ 相关联，频率为 $\\omega$。速率为 $\\gamma(\\omega) = \\epsilon^2 S_B(\\omega)$。这对应于从振子中湮灭一个能量为 $\\omega$ 的量子。\n- 一个与算符 $A_{-\\omega}=a^{\\dagger}$ 相关联，频率为 $-\\omega$。速率为 $\\gamma(-\\omega) = \\epsilon^2 S_B(-\\omega)$。这对应于在振子中产生一个能量为 $\\omega$ 的量子。\n\n因此，GKSL 生成元为：\n$$ \\mathcal{L}(\\rho) = \\gamma(\\omega) \\left( a \\rho a^{\\dagger} - \\frac{1}{2} \\{a^{\\dagger}a, \\rho\\} \\right) + \\gamma(-\\omega) \\left( a^{\\dagger} \\rho a - \\frac{1}{2} \\{a a^{\\dagger}, \\rho\\} \\right) $$\n这表明唯一的跃迁算符是 $a$ 和 $a^{\\dagger}$，其速率分别为 $\\gamma(\\omega)$ 和 $\\gamma(-\\omega)$。\n\n2. 量子细致平衡的证明。\n\n问题给出了热库关联函数的 Kubo-Martin-Schwinger (KMS) 条件：$S_B(-\\omega) = \\exp(-\\beta\\omega)S_B(\\omega)$。\n使用第1部分中速率的定义，我们可以将它们关联起来：\n$$ \\gamma(-\\omega) = \\epsilon^2 S_B(-\\omega) = \\epsilon^2 \\exp(-\\beta\\omega) S_B(\\omega) = \\exp(-\\beta\\omega) \\gamma(\\omega) $$\n这个关系式 $\\gamma(-\\omega) = \\exp(-\\beta\\omega) \\gamma(\\omega)$ 就是量子细致平衡条件。它将激发速率（从热库吸收能量）与衰变速率（向热库释放能量）联系起来。\n\n接下来，我们将这些速率用 Bose-Einstein 占据因子 $n(\\omega) = \\frac{1}{\\exp(\\beta\\omega)-1}$ 来表示。\n我们考虑比率：\n$$ \\frac{n(\\omega)}{n(\\omega)+1} = \\frac{\\frac{1}{\\exp(\\beta\\omega)-1}}{\\frac{1}{\\exp(\\beta\\omega)-1}+1} = \\frac{\\frac{1}{\\exp(\\beta\\omega)-1}}{\\frac{\\exp(\\beta\\omega)}{\\exp(\\beta\\omega)-1}} = \\frac{1}{\\exp(\\beta\\omega)} = \\exp(-\\beta\\omega) $$\n将此与细致平衡条件进行比较，我们看到 $\\frac{\\gamma(-\\omega)}{\\gamma(\\omega)} = \\frac{n(\\omega)}{n(\\omega)+1}$。\n这使我们能够用单个函数 $\\Gamma(\\omega)$ 对这两个速率进行参数化，如下所示：\n令衰变速率为 $\\gamma(\\omega) = \\Gamma(\\omega)(n(\\omega)+1)$。\n那么激发速率为 $\\gamma(-\\omega) = \\gamma(\\omega) \\exp(-\\beta\\omega) = \\Gamma(\\omega)(n(\\omega)+1) \\exp(-\\beta\\omega)$。\n由于 $(n(\\omega)+1)\\exp(-\\beta\\omega) = (\\frac{\\exp(\\beta\\omega)}{\\exp(\\beta\\omega)-1})\\exp(-\\beta\\omega) = \\frac{1}{\\exp(\\beta\\omega)-1} = n(\\omega)$，我们有：\n$$ \\gamma(\\omega) = \\Gamma(\\omega)(n(\\omega)+1) \\quad (\\text{衰变速率，与 } a \\text{ 相关}) $$\n$$ \\gamma(-\\omega) = \\Gamma(\\omega)n(\\omega) \\quad (\\text{激发速率，与 } a^{\\dagger} \\text{ 相关}) $$\n这种分解在物理上是直观的：激发速率与热库模式的热占据数 $n(\\omega)$ 成正比，而衰变速率有一个自发项（'$+1$'）和一个与 $n(\\omega)$ 成正比的受激项。\n\n3. 吉布斯态的稳恒性。\n\n简谐振子的吉布斯态是 $\\rho_{\\beta} = \\frac{\\exp(-\\beta H)}{Z} = \\frac{\\exp(-\\beta\\omega a^{\\dagger}a)}{Z}$，其中 $Z=\\mathrm{Tr}[\\exp(-\\beta\\omega a^{\\dagger}a)]$。这个态在粒子数表象 $|n\\rangle$ 中是对角的。如果初态是对角的，由 GKSL 生成元描述的动力学不会产生相干性。因此，要证明稳恒性，只需证明布居数 $P_n = \\langle n|\\rho|n\\rangle$ 是稳恒的。\n\n布居数的时间演化由泡利主方程给出，该方程可从 GKSL 方程推导：\n$$ \\dot{P}_n = \\sum_{m} (W_{n \\leftarrow m}P_m - W_{m \\leftarrow n}P_n) $$\n从态 $|m\\rangle$ 到 $|n\\rangle$ 的跃迁速率由所有跃迁算符的贡献之和给出。\n算符 $a$ 引起从 $|m\\rangle$ 到 $|m-1\\rangle$ 的跃迁。速率正比于 $|\\langle m-1|a|m\\rangle|^2 = m$。因此，从 $|m\\rangle$ 到 $|m-1\\rangle$ 的总跃迁速率是 $\\gamma(\\omega)m P_m$。\n算符 $a^{\\dagger}$ 引起从 $|m\\rangle$ 到 $|m+1\\rangle$ 的跃迁。速率正比于 $|\\langle m+1|a^{\\dagger}|m\\rangle|^2 = m+1$。因此，从 $|m\\rangle$ 到 $|m+1\\rangle$ 的总跃迁速率是 $\\gamma(-\\omega)(m+1) P_m$。\n\n对于稳恒态，对所有 $n$ 都有 $\\dot{P}_n=0$。如果任意两个相邻能级之间的流是平衡的（布居数的细致平衡），则此条件成立。让我们考虑能级 $|n\\rangle$ 和 $|n+1\\rangle$ 之间的流：\n$$ \\text{Flux}(n+1 \\rightarrow n) = \\text{Flux}(n \\rightarrow n+1) $$\n$$ \\gamma(\\omega) |\\langle n|a|n+1\\rangle|^2 P_{n+1} = \\gamma(-\\omega) |\\langle n+1|a^{\\dagger}|n\\rangle|^2 P_n $$\n$$ \\gamma(\\omega) (n+1) P_{n+1} = \\gamma(-\\omega) (n+1) P_n $$\n对于 $n+1 \\ge 1$，我们可以除以 $n+1$：\n$$ \\gamma(\\omega) P_{n+1} = \\gamma(-\\omega) P_n $$\n这给出了稳态下布居数的比率：\n$$ \\frac{P_{n+1}^{\\mathrm{ss}}}{P_n^{\\mathrm{ss}}} = \\frac{\\gamma(-\\omega)}{\\gamma(\\omega)} = \\exp(-\\beta\\omega) $$\n这个递推关系意味着 $P_n^{\\mathrm{ss}} = P_0^{\\mathrm{ss}} (\\exp(-\\beta\\omega))^n = P_0^{\\mathrm{ss}} \\exp(-n\\beta\\omega)$。\n这正是吉布斯态 $\\rho_{\\beta}$ 的布居数形式，其中 $P_n = \\frac{\\exp(-\\beta\\omega n)}{Z}$。由于吉布斯态的布居数满足细致平衡条件，它们是稳恒的。由于 $\\rho_{\\beta}$ 是对角的，完整的密度矩阵是稳恒的，即 $\\mathcal{L}(\\rho_{\\beta}) = 0$。\n\n4. 稳态期望值 $\\langle a^{\\dagger}a\\rangle_{\\mathrm{ss}}$。\n\n稳态是吉布斯态 $\\rho_{\\mathrm{ss}}=\\rho_{\\beta}$。粒子数算符 $N=a^{\\dagger}a$ 的期望值为：\n$$ \\langle a^{\\dagger}a\\rangle_{\\mathrm{ss}} = \\mathrm{Tr}(\\rho_{\\beta} a^{\\dagger}a) = \\sum_{n=0}^{\\infty} n P_n^{\\mathrm{ss}} $$\n首先，我们从 $\\sum_{n=0}^{\\infty} P_n^{\\mathrm{ss}} = 1$ 中求出归一化常数 $P_0^{\\mathrm{ss}}$。\n$$ 1 = \\sum_{n=0}^{\\infty} P_0^{\\mathrm{ss}} \\exp(-n\\beta\\omega) = P_0^{\\mathrm{ss}} \\sum_{n=0}^{\\infty} (\\exp(-\\beta\\omega))^n $$\n这是一个公比为 $r = \\exp(-\\beta\\omega) < 1$ 的几何级数。其和为 $\\frac{1}{1-r}$。\n$$ 1 = P_0^{\\mathrm{ss}} \\frac{1}{1-\\exp(-\\beta\\omega)} \\implies P_0^{\\mathrm{ss}} = 1-\\exp(-\\beta\\omega) $$\n因此，稳态分布为 $P_n^{\\mathrm{ss}} = (1-\\exp(-\\beta\\omega))\\exp(-n\\beta\\omega)$。\n现在，我们计算期望值：\n$$ \\langle a^{\\dagger}a\\rangle_{\\mathrm{ss}} = \\sum_{n=0}^{\\infty} n (1-\\exp(-\\beta\\omega))\\exp(-n\\beta\\omega) = (1-\\exp(-\\beta\\omega)) \\sum_{n=0}^{\\infty} n (\\exp(-\\beta\\omega))^n $$\n为了计算这个和，令 $x=\\exp(-\\beta\\omega)$。我们使用恒等式 $\\sum_{n=0}^{\\infty} nx^n = x \\frac{d}{dx} \\sum_{n=0}^{\\infty} x^n$。\n$$ \\sum_{n=0}^{\\infty} nx^n = x \\frac{d}{dx} \\left( \\frac{1}{1-x} \\right) = x \\frac{1}{(1-x)^2} = \\frac{x}{(1-x)^2} $$\n代回 $x=\\exp(-\\beta\\omega)$：\n$$ \\sum_{n=0}^{\\infty} n (\\exp(-\\beta\\omega))^n = \\frac{\\exp(-\\beta\\omega)}{(1-\\exp(-\\beta\\omega))^2} $$\n最后，我们计算期望值：\n$$ \\langle a^{\\dagger}a\\rangle_{\\mathrm{ss}} = (1-\\exp(-\\beta\\omega)) \\frac{\\exp(-\\beta\\omega)}{(1-\\exp(-\\beta\\omega))^2} = \\frac{\\exp(-\\beta\\omega)}{1-\\exp(-\\beta\\omega)} $$\n分子和分母同乘以 $\\exp(\\beta\\omega)$：\n$$ \\langle a^{\\dagger}a\\rangle_{\\mathrm{ss}} = \\frac{\\exp(-\\beta\\omega)\\exp(\\beta\\omega)}{(1-\\exp(-\\beta\\omega))\\exp(\\beta\\omega)} = \\frac{1}{\\exp(\\beta\\omega)-1} $$\n这就是 Bose-Einstein 分布，它给出了在逆温度为 $\\beta$ 的热平衡状态下玻色子模式的平均占据数。",
            "answer": "$$\n\\boxed{\\frac{1}{\\exp(\\beta\\omega)-1}}\n$$"
        },
        {
            "introduction": "前面的练习侧重于系统如何达到热平衡稳态，而本节的最后一个实践将探讨细致平衡在一个深刻的非平衡物理情境中的作用。我们将通过一个数值模拟任务来检验克鲁克斯涨落定理 (Crooks fluctuation theorem)，该定理揭示了在一个非平衡过程中做功的概率分布所具有的普适对称性。通过编写代码来模拟一个淬火协议下的双能级系统 ()，你将亲眼见证，正是动力学演化过程中满足的细致平衡条件，保证了宏观功涨落定理的成立，从而将抽象的数学条件与可测量的物理后果联系起来。",
            "id": "3778125",
            "problem": "考虑一个量子二能级系统，它经历一次从初始哈密顿量 $H_0$（能量本征值为 $(E_0, E_1)$，本征基为 $\\{\\lvert \\psi_0 \\rangle, \\lvert \\psi_1 \\rangle\\}$）到末态哈密顿量 $H_1$（能量本征值为 $(E_0', E_1')$，本征基为 $\\{\\lvert \\phi_0 \\rangle, \\lvert \\phi_1 \\rangle\\}$）的突然淬火。系统初始制备于逆温度为 $\\beta$ 的吉布斯态，功通过两点测量 (TPM) 方案定义：在开始时（相对于 $H_0$）和结束时（相对于 $H_1$）对能量进行投影测量。\n\n本征基通过一个角度为 $\\theta$ 的实数旋转相关联，因此\n$$\n\\lvert \\phi_0 \\rangle = \\cos\\theta \\,\\lvert \\psi_0 \\rangle + \\sin\\theta \\,\\lvert \\psi_1 \\rangle, \\quad \n\\lvert \\phi_1 \\rangle = -\\sin\\theta \\,\\lvert \\psi_0 \\rangle + \\cos\\theta \\,\\lvert \\psi_1 \\rangle,\n$$\n因此重叠概率为\n$$\nC_{j|i} = \\left|\\langle \\phi_j \\mid \\psi_i \\rangle\\right|^2 =\n\\begin{cases}\n\\cos^2\\theta  & \\text{若 } (j,i) \\in \\{(0,0),(1,1)\\}, \\\\\n\\sin^2\\theta  & \\text{若 } (j,i) \\in \\{(1,0),(0,1)\\}.\n\\end{cases}\n$$\n\n在初始和末态能量测量之间，系统与热浴弱耦合，并在一个满足量子细致平衡 (QDB) 条件的时齐生成元下演化。在二能级能量基中，这简化为一个速率遵循细致平衡的经典双态马尔可夫生成元。对于任意能量为 $(E_a, E_b)$ 的哈密顿量 $H$，定义一个基础速率参数 $g > 0$，并设置向上和向下的跃迁速率\n$$\nw_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}, \\quad w_{b \\to a} = g,\n$$\n这确保了相对于吉布斯稳态分布的细致平衡。相应的 $2\\times 2$ 速率矩阵 $\\mathcal{R}$ 通过 $\\frac{d}{dt} p = \\mathcal{R}\\, p$ 作用在列概率向量 $p$ 上，其形式为\n$$\n\\mathcal{R} =\n\\begin{pmatrix}\n- w_{a \\to b} & w_{b \\to a} \\\\\nw_{a \\to b} & - w_{b \\to a}\n\\end{pmatrix},\n$$\n在时间段 $\\tau$ 内的跃迁矩阵由矩阵指数给出\n$$\nM(\\tau) = e^{\\mathcal{R}\\, \\tau}.\n$$\n\n按如下方式定义正向过程：根据热概率 $p_i = e^{-\\beta E_i}/Z_0$（其中 $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$）抽取 $i \\in \\{0,1\\}$；对系统进行到 $H_1$ 的突然淬火；在 $H_1$ 基中，给定 $i$ 的淬火后状态在 $k \\in \\{0,1\\}$ 上的分布为 $C_{k|i}$；在 $H_1$ 生成元下演化时间 $\\tau$，跃迁矩阵为 $M_1(\\tau)$；最后测量 $H_1$ 的能量，得到 $j \\in \\{0,1\\}$。相应的联合概率为\n$$\nP_F(i \\to j) = p_i \\sum_{k} C_{k|i}\\, [M_1(\\tau)]_{j k}.\n$$\n类似地，逆向过程从 $H_1$ 的热态开始，其概率为 $p_j' = e^{-\\beta E_j'}/Z_1$（其中 $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$）；测量 $H_1$ 的能量得到 $j$；淬火回到 $H_0$；在 $H_0$ 基中，淬火后状态的分布为 $D_{i|j} = \\left|\\langle \\psi_i \\mid \\phi_j \\rangle\\right|^2 = C_{j|i}$；在 $H_0$ 生成元下演化时间 $\\tau$，跃迁矩阵为 $M_0(\\tau)$；最后测量 $H_0$ 的能量，得到 $i$。相应的联合概率是\n$$\nP_R(j \\to i) = p_j' \\sum_{k} D_{k|j}\\, [M_0(\\tau)]_{i k}.\n$$\n\n正向功特征函数定义为\n$$\n\\chi_F(u) = \\sum_{i,j} P_F(i \\to j)\\, e^{i u (E_j' - E_i)},\n$$\n逆向功特征函数定义为\n$$\n\\chi_R(v) = \\sum_{j,i} P_R(j \\to i)\\, e^{i v (E_i - E_j')}.\n$$\n令自由能差为 $\\Delta F = F_1 - F_0$，其中 $F_\\nu = -\\beta^{-1} \\ln Z_\\nu$，因此 $e^{-\\beta \\Delta F} = Z_1/Z_0$。\n\n任务：\n- 为上述二能级系统实现 $\\chi_F(u)$ 和 $\\chi_R(v)$ 的计算。\n- 使用统一的绝对容差，在一组指定的 $u$ 实数值上，数值验证 Crooks 对称性\n$$\n\\chi_F(u) \\approx e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta),\n$$\n\n你的程序必须：\n- 对于每个测试用例，使用上述定义计算特征函数。\n- 对于每个测试用例，在所测试的 $u$ 值集合 $\\mathcal{U}$ 上，评估最大绝对偏差\n$$\n\\max_{u \\in \\mathcal{U}} \\left| \\chi_F(u) - e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta) \\right|\n$$\n并返回一个布尔值，指示该偏差是否在容差范围内。\n\n测试套件：\n- 使用以下四组参数集，所有量均为无量纲：\n    1. 正常路径：$(E_0, E_1) = (0.0, 1.0)$，$(E_0', E_1') = (0.0, 1.3)$，$\\beta = 1.5$，$\\theta = 0.37$，$\\tau = 1.0$，$g = 0.8$。\n    2. 无动力学（边界情况）：能量和 $\\theta$ 与 1 中相同，$\\beta = 1.5$，$\\tau = 0.0$，$g = 0.8$。\n    3. 无旋转（边界情况）：$(E_0, E_1) = (0.0, 1.0)$，$(E_0', E_1') = (0.0, 1.2)$，$\\beta = 1.5$，$\\theta = 0.0$，$\\tau = 2.0$，$g = 0.7$。\n    4. 长弛豫时间（边缘情况）：$(E_0, E_1) = (0.0, 1.0)$，$(E_0', E_1') = (0.0, 1.1)$，$\\beta = 2.0$，$\\theta = 0.25$，$\\tau = 50.0$，$g = 0.4$。\n- 使用 $u$ 值集合 $\\mathcal{U} = \\{-2.0, -0.5, 0.0, 0.5, 2.0\\}$。\n- 使用绝对容差 $\\varepsilon = 10^{-10}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用逗号分隔并用方括号括起来的结果，例如，“[true,false,true,true]”。每个条目都是一个布尔值，指示相应的测试用例是否通过了 Crooks 对称性检查，顺序与上面列出的顺序相同。",
            "solution": "该问题要求对一个量子二能级系统，数值验证一个随机热力学对称关系，具体来说是 Crooks 涨落定理的一种形式。该系统经历一个包含热化步骤的淬火协议。解决方案涉及计算正向和逆向功特征函数 $\\chi_F(u)$ 和 $\\chi_R(v)$，并检查它们之间的关系。\n\n对于给定的一组参数——初始能量 $(E_0, E_1)$、末态能量 $(E_0', E_1')$、逆温度 $\\beta$、旋转角 $\\theta$、演化时间 $\\tau$ 和基础速率 $g$——其验证过程结构如下：\n\n1.  **计算平衡性质和自由能：**\n    首先，我们分别计算初始和末态哈密顿量 $H_0$ 和 $H_1$ 的配分函数。\n    初始配分函数为 $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$。\n    末态配分函数为 $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$。\n    $H_0$ 能级的初始吉布斯态概率为 $p_i = e^{-\\beta E_i} / Z_0$，其中 $i \\in \\{0, 1\\}$。\n    类似地，$H_1$ 能级的吉布斯概率为 $p_j' = e^{-\\beta E_j'} / Z_1$，其中 $j \\in \\{0, 1\\}$。\n    自由能差为 $\\Delta F = F_1 - F_0 = -\\beta^{-1}(\\ln Z_1 - \\ln Z_0)$。出现在 Crooks 关系式中的项是 $e^{-\\beta \\Delta F} = Z_1/Z_0$。\n\n2.  **构建速率和跃迁矩阵：**\n    系统在与热浴弱耦合下的演化，是在相应哈密顿量的能量本征基中，由一个经典主方程建模。\n    对于一个能量为 $(E_a, E_b)$ 的通用哈密顿量，跃迁速率由 $w_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}$ 和 $w_{b \\to a} = g$ 给出。我们假设 $E_b > E_a$。\n    相应的速率矩阵 $\\mathcal{R}$ 是：\n    $$\n    \\mathcal{R} =\n    \\begin{pmatrix}\n    -w_{a \\to b} & w_{b \\to a} \\\\\n    w_{a \\to b} & -w_{b \\to a}\n    \\end{pmatrix}\n    $$\n    在时间段 $\\tau$ 内的跃迁概率矩阵由矩阵指数 $M(\\tau) = e^{\\mathcal{R}\\tau}$ 给出。这个计算对初始哈密顿量 $H_0$（使用能量 $(E_0, E_1)$）和末态哈密顿量 $H_1$（使用能量 $(E_0', E_1')$）都进行，从而得到矩阵 $M_0(\\tau)$ 和 $M_1(\\tau)$。矩阵指数可以使用诸如 `scipy.linalg.expm` 的例程进行数值计算。\n\n3.  **确定重叠和联合概率：**\n    从 $H_0$ 到 $H_1$（反之亦然）的突然淬火导致了能量本征基之间的失配，它们通过一个旋转角 $\\theta$ 相关联。由于这种基底变化引起的跃迁概率矩阵 $C_{j|i} = |\\langle\\phi_j|\\psi_i\\rangle|^2$ 是：\n    $$\n    C = \\begin{pmatrix} C_{0|0} & C_{0|1} \\\\ C_{1|0} & C_{1|1} \\end{pmatrix} = \\begin{pmatrix} \\cos^2\\theta & \\sin^2\\theta \\\\ \\sin^2\\theta & \\cos^2\\theta \\end{pmatrix}\n    $$\n    逆向淬火概率由 $D_{k|j} = |\\langle\\psi_k|\\phi_j\\rangle|^2 = C_{j|k}$ 给出，因此矩阵 $D$ 是 $C$ 的转置。\n\n    正向过程的联合概率 $P_F(i \\to j)$（初始测量到 $E_i$，最终测量到 $E_j'$）通过对所有中间路径求和来计算：\n    $$\n    P_F(i \\to j) = p_i \\sum_{k=0,1} C_{k|i} [M_1(\\tau)]_{jk}\n    $$\n    类似地，逆向过程的联合概率 $P_R(j \\to i)$ 是：\n    $$\n    P_R(j \\to i) = p_j' \\sum_{k=0,1} D_{k|j} [M_0(\\tau)]_{ik} = p_j' \\sum_{k=0,1} C_{j|k} [M_0(\\tau)]_{ik}\n    $$\n    每个过程的这四个概率（例如，$P_F(0\\to0), P_F(0\\to1), P_F(1\\to0), P_F(1\\to1)$）都会被计算出来。\n\n4.  **计算特征函数：**\n    使用联合概率，我们为测试集 $\\mathcal{U}$ 中的每个 $u$ 值计算正向和逆向功特征函数。\n    正向特征函数是：\n    $$\n    \\chi_F(u) = \\sum_{i,j \\in \\{0,1\\}} P_F(i \\to j) e^{i u (E_j' - E_i)}\n    $$\n    逆向特征函数在复数宗量 $v = -u + i\\beta$ 处求值：\n    $$\n    \\chi_R(-u + i\\beta) = \\sum_{j,i \\in \\{0,1\\}} P_R(j \\to i) e^{i(-u+i\\beta) (E_i - E_j')}\n    $$\n\n5.  **验证对称关系：**\n    对于每个 $u \\in \\mathcal{U}$，我们计算 Crooks 对称关系的左手边 (LHS) $\\chi_F(u)$ 和右手边 (RHS) $e^{-\\beta \\Delta F} \\chi_R(-u + i\\beta)$。计算它们的绝对差 $|LHS - RHS|$。\n    找到在所有 $u \\in \\mathcal{U}$ 上的这些差异的最大值：\n    $$\n    \\text{discrepancy} = \\max_{u \\in \\mathcal{U}} |\\chi_F(u) - e^{-\\beta\\Delta F} \\chi_R(-u + i\\beta)|\n    $$\n    最后，将此最大偏差与给定的容差 $\\varepsilon = 10^{-10}$ 进行比较。如果偏差小于 $\\varepsilon$，则该测试用例的验证通过。对所有提供的四个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the problem by verifying the Crooks symmetry relation for four test cases.\n    \"\"\"\n\n    test_cases = [\n        # 1. Happy path\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 1.0, 'g': 0.8},\n        # 2. No dynamics (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 0.0, 'g': 0.8},\n        # 3. No rotation (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.2), 'beta': 1.5, 'theta': 0.0, 'tau': 2.0, 'g': 0.7},\n        # 4. Long relaxation (edge)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.1), 'beta': 2.0, 'theta': 0.25, 'tau': 50.0, 'g': 0.4},\n    ]\n\n    u_values = [-2.0, -0.5, 0.0, 0.5, 2.0]\n    tolerance = 1e-10\n\n    results = []\n    for params in test_cases:\n        discrepancy = verify_crooks_for_case(params, u_values)\n        results.append(discrepancy  tolerance)\n\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\ndef verify_crooks_for_case(params, u_values):\n    \"\"\"\n    Computes the maximum discrepancy for a single test case.\n    \"\"\"\n    E = np.array(params['E'])\n    E_p = np.array(params['E_p'])\n    beta = params['beta']\n    theta = params['theta']\n    tau = params['tau']\n    g = params['g']\n\n    # 1. Equilibrium properties and free energy\n    Z0 = np.sum(np.exp(-beta * E))\n    Z1 = np.sum(np.exp(-beta * E_p))\n    p = np.exp(-beta * E) / Z0\n    p_p = np.exp(-beta * E_p) / Z1\n    exp_neg_beta_delta_F = Z1 / Z0\n    \n    # 2. Rate and transition matrices\n    def get_transition_matrix(energies, beta_val, g_val, tau_val):\n        E_a, E_b = energies[0], energies[1]\n        # Assuming E_b > E_a, which holds for all test cases.\n        w_ab = g_val * np.exp(-beta_val * (E_b - E_a))\n        w_ba = g_val\n        R = np.array([[-w_ab, w_ba], [w_ab, -w_ba]])\n        return expm(R * tau_val)\n\n    M0 = get_transition_matrix(E, beta, g, tau)\n    M1 = get_transition_matrix(E_p, beta, g, tau)\n\n    # 3. Overlap and joint probabilities\n    cos2_theta = np.cos(theta)**2\n    sin2_theta = np.sin(theta)**2\n    C = np.array([[cos2_theta, sin2_theta],\n                  [sin2_theta, cos2_theta]])\n\n    # PF[j, i] corresponds to P_F(i -> j)\n    PF = np.zeros((2, 2))\n    for i in range(2):\n        for j in range(2):\n            # Sum over intermediate states k\n            prob_sum = np.dot(M1[j, :], C[:, i])\n            PF[j, i] = p[i] * prob_sum\n    \n    # PR[i, j] corresponds to P_R(j -> i)\n    PR = np.zeros((2, 2))\n    for j in range(2):\n        for i in range(2):\n            # Sum over intermediate states k\n            # D_kj = C_jk\n            prob_sum = np.dot(M0[i, :], C[j, :])\n            PR[i, j] = p_p[j] * prob_sum\n\n    # 4  5. Compute characteristic functions and verify symmetry\n    max_discrepancy = 0.0\n    for u in u_values:\n        # Forward characteristic function\n        chi_F = 0.0j\n        for i in range(2):\n            for j in range(2):\n                work = E_p[j] - E[i]\n                chi_F += PF[j, i] * np.exp(1j * u * work)\n        \n        # Reverse characteristic function\n        v = -u + 1j * beta\n        chi_R_v = 0.0j\n        for j in range(2):\n            for i in range(2):\n                rev_work = E[i] - E_p[j]\n                chi_R_v += PR[i, j] * np.exp(1j * v * rev_work)\n        \n        lhs = chi_F\n        rhs = exp_neg_beta_delta_F * chi_R_v\n        \n        discrepancy = np.abs(lhs - rhs)\n        if discrepancy > max_discrepancy:\n            max_discrepancy = discrepancy\n\n    return max_discrepancy\n\nsolve()\n```"
        }
    ]
}