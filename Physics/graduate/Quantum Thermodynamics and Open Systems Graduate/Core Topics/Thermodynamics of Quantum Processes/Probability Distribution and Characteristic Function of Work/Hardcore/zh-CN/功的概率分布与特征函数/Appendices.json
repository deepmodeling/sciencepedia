{
    "hands_on_practices": [
        {
            "introduction": "在深入研究量子功之前，我们首先通过一个经典的随机热力学例子来建立基础。这个练习将探讨一个被匀速拖拽的谐振子，其动态由 Langevin 方程描述，这是一个模拟与热浴相互作用的强大模型。通过计算功的特征函数，你将实践如何处理非平衡过程中由热涨落引起的功的分布。",
            "id": "1116713",
            "problem": "一个过阻尼粒子被限制在一个一维谐振势 $V(x, t) = \\frac{1}{2}k(x - x_0(t))^2$ 中，其中 $k$ 是弹簧常数。该粒子浸没在绝对温度恒为 $T$ 的热流体中，该流体可以被建模为一个热浴。与流体的相互作用产生一个摩擦系数为 $\\gamma$ 的摩擦力以及一个随机热力。粒子位置 $x(t)$ 的动力学由朗之万方程描述：\n$$ \\gamma \\frac{dx}{dt} = -\\frac{\\partial V(x,t)}{\\partial x} + \\xi(t) $$\n其中 $\\xi(t)$ 是一个高斯白噪声项，其均值为零，$\\langle \\xi(t) \\rangle = 0$，其关联由涨落耗散定理给出：$\\langle \\xi(t)\\xi(t') \\rangle = 2\\gamma k_B T \\delta(t-t')$，其中 $k_B$ 是玻尔兹曼常数。\n\n初始时，在 $t=0$ 时，谐振势阱的中心位于 $x_0(0)=0$，并且粒子与热浴处于热平衡状态。对于 $t>0$，势阱中心以恒定速度 $v$ 移动，使得 $x_0(t) = vt$。这个过程持续一段有限的时间间隔，时长为 $\\tau$。\n\n移动势阱的外部作用力对粒子所做的功 $W$ 由所施加功率的积分给出：\n$$ W = \\int_0^\\tau \\frac{\\partial V(x(t), t)}{\\partial t} dt $$\n\n你的任务是计算功的概率分布的特征函数 $\\Phi_W(u) = \\langle e^{iuW} \\rangle$，其中 $u$ 是一个实变量，尖括号 $\\langle \\cdot \\rangle$ 表示对所有可能的噪声实现和初始条件的平均。\n\n请用给定的物理参数 $k, \\gamma, v, \\tau, T, k_B$ 和变量 $u$ 来表示你的最终答案。\n\n**求：**特征函数 $\\Phi_W(u)$。",
            "solution": "1. 动力学：令 $y=x-vt$。朗之万方程变为\n$$\\gamma\\dot{y}=-ky-\\gamma v+\\xi(t).$$\n稳态解：$y_p=-\\gamma v/k$。通解为\n$$y(t)=y_p+[y(0)-y_p]e^{-k t/\\gamma}+\\frac{1}{\\gamma}\\int_0^t e^{-k(t-s)/\\gamma}\\xi(s)ds.$$\n2. 功：\n$$W=\\int_0^\\tau\\frac{\\partial V}{\\partial t}dt=-kv\\int_0^\\tau y(t)\\,dt.$$\n计算\n$$\\int_0^\\tau y(t)\\,dt\n=y_p\\tau+[y(0)-y_p]\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\n+ \\int_0^\\tau dt\\int_0^t\\frac{e^{-k(t-s)/\\gamma}}{\\gamma}\\,\\xi(s)ds.$$\n因此\n$$W=\\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}(1-e^{-k\\tau/\\gamma})\n-\\gamma v(1-e^{-k\\tau/\\gamma})y(0)-kv\\int_0^\\tau dt\\int_0^t\\frac{e^{-k(t-s)/\\gamma}}{\\gamma}\\xi(s)ds.$$\n3. 高斯性 $\\Rightarrow \\Phi_W(u)=\\exp(iu\\langle W\\rangle-u^2\\mathrm{Var}(W)/2)$。根据平衡条件 $\\langle y(0)\\rangle=0$，$\\mathrm{Var}(y(0))=k_B T/k$，以及噪声相关器，我们得到\n$$\\langle W \\rangle = \\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}(1-e^{-k\\tau/\\gamma}),$$  \n$$\\mathrm{Var}(W) = 2\\gamma v^2k_B T\\left[\\tau-\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\right].$$  \n4. 因此\n$$\\Phi_W(u)\n=\\exp\\Bigl[iu\\bigl(\\gamma v^2\\tau-\\tfrac{\\gamma^2v^2}{k}(1-e^{-k\\tau/\\gamma})\\bigr)\n -u^2\\,\\gamma v^2k_B T\\bigl(\\tau-\\tfrac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\bigr)\\Bigr].$$",
            "answer": "$$\\boxed{\\exp\\!\\Bigl[iu\\Bigl(\\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)\\;-\\;u^2\\,\\gamma v^2k_B T\\Bigl(\\tau-\\frac{\\gamma}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)\\Bigr]}$$"
        },
        {
            "introduction": "现在我们将注意力转向孤立的量子系统，并引入量子功的标准操作定义：两点测量（TPM）方案。在这个练习中，你将把 TPM 方案应用于 Landau-Zener 模型，这是时间相关量子力学的一个基石。通过计算功的特征函数，你将直接看到非绝热量子跃迁如何体现在功的统计分布中。",
            "id": "452914",
            "problem": "考虑一个在泡利矩阵 $\\{\\sigma_x, \\sigma_y, \\sigma_z\\}$ 基底下描述的两能级量子系统，其含时哈密顿量为：\n$$\nH(t) = -\\frac{1}{2} (v t \\sigma_z + \\Delta \\sigma_x)\n$$\n其中 $\\Delta$ 是恒定的最小能隙，$v$ 是能量偏置的扫描速率。该系统在此哈密顿量的驱动下演化一段有限的时间，从初始时刻 $t_i = -T$ 到末时刻 $t_f = +T$。我们设 $\\hbar=1$ 且玻尔兹曼常数 $k_B=1$。\n\n初始时刻 $t_i=-T$ 时，系统与一个恒定逆温度为 $\\beta$ 的热浴处于热平衡状态。随后从 $t=-T$ 到 $t=+T$ 的演化是幺正的，并且与热浴隔离。\n\n在此过程中，外界对系统做功 $W$。功的值由一个两点能量测量方案确定：\n1.  在 $t=-T$ 时，测量系统的能量。\n2.  系统进行幺正演化直到 $t=+T$。\n3.  在 $t=+T$ 时，再次测量系统的能量。\n所做的功是第二次和第一次能量测量结果之差。\n\n你的任务是计算功分布的特征函数，其定义为期望值 $G(u) = \\langle e^{iuW} \\rangle$，其中 $u$ 是一个实变量。\n\n在计算中，你可以假设扫描持续时间足够长，以至于 $vT \\gg \\Delta$。这允许使用标准的朗道-齐纳公式来计算系统瞬时绝热本征态之间的非绝热跃迁概率，该概率由 $P_{LZ} = \\exp(-\\pi \\Delta^2 / v)$ 给出。\n\n请用给定的参数 $\\Delta$、$v$、$T$、$\\beta$ 和 $u$ 将你的最终答案表示为单个闭式解析表达式。",
            "solution": "1. 定义 $E_T=\\frac{1}{2}\\sqrt{(vT)^2+\\Delta^2}$, $P_{LZ}=e^{-\\pi\\Delta^2/v}$。\n2. 初始能量 $E_n(-T)=nE_T$, $n=\\pm 1$。$p_n=e^{-\\beta nE_T}/(2\\cosh(\\beta E_T))$。\n3. 末态能量 $E_m(+T)=mE_T$, $m=\\pm 1$。$P_{m|n}=(1-P_{LZ})\\delta_{mn}+P_{LZ}(1-\\delta_{mn})$。\n4. 功 $W_{m,n}=(m-n)E_T$。\n5. 特征函数：\n$$\nG(u)=\\sum_{n,m=\\pm1}p_nP_{m|n}e^{iu(m-n)E_T}.\n$$\n6. 分离 $m=n$ 和 $m=-n$ 的情况：\n$$\nG(u)=\\sum_{n}p_n(1-P_{LZ})+\\sum_{n}p_nP_{LZ}e^{-2iunE_T}\n=(1-P_{LZ})+P_{LZ}\\sum_{n=\\pm1}p_n e^{-2iunE_T}.\n$$\n7. 代入 $p_n$：\n$$\n\\sum_{n}p_ne^{-2iunE_T}\n=\\frac{e^{-\\beta E_T}e^{-2iuE_T}+e^{\\beta E_T}e^{2iuE_T}}{2\\cosh(\\beta E_T)}\n=\\frac{\\cosh\\bigl((\\beta+2iu)E_T\\bigr)}{\\cosh(\\beta E_T)}.\n$$\n8. 因此\n$$\nG(u)=(1-P_{LZ})+P_{LZ}\\frac{\\cosh\\bigl((\\beta+2iu)E_T\\bigr)}{\\cosh(\\beta E_T)}.\n$$\n9. 替换 $E_T$ 和 $P_{LZ}$ 得到最终的闭式形式。",
            "answer": "$$\\boxed{\nG(u)=1-e^{-\\frac{\\pi\\Delta^2}{v}}\n+e^{-\\frac{\\pi\\Delta^2}{v}}\\,\n\\frac{\\cosh\\!\\Bigl(\\bigl(\\beta+2i u\\bigr)\\tfrac{\\sqrt{(vT)^2+\\Delta^2}}{2}\\Bigr)}\n{\\cosh\\!\\Bigl(\\beta\\,\\tfrac{\\sqrt{(vT)^2+\\Delta^2}}{2}\\Bigr)}\n}$$"
        },
        {
            "introduction": "这项高级练习将我们之前的概念整合到一个更现实的场景中：开放量子系统。真实系统很少是完全孤立的，这个问题模拟了一个在两次能量测量之间与热浴交换能量的系统。你的任务是数值验证 Crooks 涨落定理，这是非平衡统计物理学的一个核心成果，从而将理论计算与基本的物理对称性和计算实践联系起来。",
            "id": "3778125",
            "problem": "考虑一个量子双能级系统，它经历一次从初始哈密顿量 $H_0$（其能量本征值为 $(E_0, E_1)$，本征基为 $\\{\\lvert \\psi_0 \\rangle, \\lvert \\psi_1 \\rangle\\}$）到最终哈密顿量 $H_1$（其能量本征值为 $(E_0', E_1')$，本征基为 $\\{\\lvert \\phi_0 \\rangle, \\lvert \\phi_1 \\rangle\\}$）的突发淬火。该系统初始处于逆温度为 $\\beta$ 的吉布斯态，功通过两点测量（TPM）方案定义：能量在开始时（相对于 $H_0$）和结束时（相对于 $H_1$）进行投影测量。\n\n本征基通过一个角度为 $\\theta$ 的实数旋转相关联，因此\n$$\n\\lvert \\phi_0 \\rangle = \\cos\\theta \\,\\lvert \\psi_0 \\rangle + \\sin\\theta \\,\\lvert \\psi_1 \\rangle, \\quad \n\\lvert \\phi_1 \\rangle = -\\sin\\theta \\,\\lvert \\psi_0 \\rangle + \\cos\\theta \\,\\lvert \\psi_1 \\rangle,\n$$\n因此交叠概率为\n$$\nC_{j|i} = \\left|\\langle \\phi_j \\mid \\psi_i \\rangle\\right|^2 =\n\\begin{cases}\n\\cos^2\\theta  &\\text{若 } (j,i) \\in \\{(0,0),(1,1)\\}, \\\\\n\\sin^2\\theta  &\\text{若 } (j,i) \\in \\{(1,0),(0,1)\\}.\n\\end{cases}\n$$\n\n在初始和最终能量测量之间，系统与热浴弱耦合，并在满足量子细致平衡（QDB）条件的时齐生成元下演化。在双能级能量基中，这简化为一个经典的二态马尔可夫生成元，其速率遵循细致平衡。对于任意具有能量 $(E_a, E_b)$ 的哈密顿量 $H$，定义一个基础速率参数 $g > 0$，并设置向上和向下跃迁速率\n$$\nw_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}, \\quad w_{b \\to a} = g,\n$$\n这确保了相对于吉布斯稳态分布的细致平衡。相应的 $2\\times 2$ 速率矩阵 $\\mathcal{R}$ 通过 $\\frac{d}{dt} p = \\mathcal{R}\\, p$ 作用于列概率向量 $p$，其形式为\n$$\n\\mathcal{R} =\n\\begin{pmatrix}\n- w_{a \\to b} & w_{b \\to a} \\\\\nw_{a \\to b} & -w_{b \\to a}\n\\end{pmatrix},\n$$\n在持续时间 $\\tau$ 内的跃迁矩阵由矩阵指数给出\n$$\nM(\\tau) = e^{\\mathcal{R}\\, \\tau}.\n$$\n\n将正向过程定义如下：根据热概率 $p_i = e^{-\\beta E_i}/Z_0$（其中 $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$）抽取 $i \\in \\{0,1\\}$；对系统执行到 $H_1$ 的突发淬火；在 $H_1$ 基中，给定 $i$ 的淬火后状态在 $k \\in \\{0,1\\}$ 上以 $C_{k|i}$ 分布；在 $H_1$ 生成元下演化时间 $\\tau$，跃迁矩阵为 $M_1(\\tau)$；最后测量 $H_1$ 的能量，得到 $j \\in \\{0,1\\}$。相应的联合概率为\n$$\nP_F(i \\to j) = p_i \\sum_{k} C_{k|i}\\, [M_1(\\tau)]_{j k}.\n$$\n类似地，逆向过程从 $H_1$ 的热态开始，其概率为 $p_j' = e^{-\\beta E_j'}/Z_1$（其中 $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$）；测量 $H_1$ 的能量得到 $j$；淬火回 $H_0$；在 $H_0$ 基中，淬火后状态以 $D_{i|j} = \\left|\\langle \\psi_i \\mid \\phi_j \\rangle\\right|^2 = C_{j|i}$ 分布；在 $H_0$ 生成元下演化时间 $\\tau$，跃迁矩阵为 $M_0(\\tau)$；最后测量 $H_0$ 的能量，得到 $i$。相应的联合概率为\n$$\nP_R(j \\to i) = p_j' \\sum_{k} D_{k|j}\\, [M_0(\\tau)]_{i k}.\n$$\n\n正向功特征函数定义为\n$$\n\\chi_F(u) = \\sum_{i,j} P_F(i \\to j)\\, e^{i u (E_j' - E_i)},\n$$\n逆向功特征函数定义为\n$$\n\\chi_R(v) = \\sum_{j,i} P_R(j \\to i)\\, e^{i v (E_i - E_j')}.\n$$\n令自由能差为 $\\Delta F = F_1 - F_0$，其中 $F_\\nu = -\\beta^{-1} \\ln Z_\\nu$，因此 $e^{-\\beta \\Delta F} = Z_1/Z_0$。\n\n任务：\n- 为上述双能级系统实现 $\\chi_F(u)$ 和 $\\chi_R(v)$ 的计算。\n- 数值验证 Crooks 对称性\n$$\n\\chi_F(u) \\approx e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta),\n$$\n在指定的 $u$ 实数值集合上，使用统一的绝对容差。\n\n您的程序必须：\n- 对每个测试用例，使用上述定义计算特征函数。\n- 对每个测试用例，评估最大绝对偏差\n$$\n\\max_{u \\in \\mathcal{U}} \\left| \\chi_F(u) - e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta) \\right|\n$$\n在测试的 $u$ 值集合 $\\mathcal{U}$ 上，并返回一个布尔值，指示该偏差是否在容差范围内。\n\n测试套件：\n- 使用以下四个参数集，所有量均为无量纲：\n    1. 正常路径：$(E_0, E_1) = (0.0, 1.0)$，$(E_0', E_1') = (0.0, 1.3)$，$\\beta = 1.5$，$\\theta = 0.37$，$\\tau = 1.0$，$g = 0.8$。\n    2. 无动力学（边界情况）：能量和 $\\theta$ 与 1 中相同，$\\beta = 1.5$，$\\tau = 0.0$，$g = 0.8$。\n    3. 无旋转（边界情况）：$(E_0, E_1) = (0.0, 1.0)$，$(E_0', E_1') = (0.0, 1.2)$，$\\beta = 1.5$，$\\theta = 0.0$，$\\tau = 2.0$，$g = 0.7$。\n    4. 长弛豫时间（边缘情况）：$(E_0, E_1) = (0.0, 1.0)$，$(E_0', E_1') = (0.0, 1.1)$，$\\beta = 2.0$，$\\theta = 0.25$，$\\tau = 50.0$，$g = 0.4$。\n- 使用 $u$ 值集合 $\\mathcal{U} = \\{-2.0, -0.5, 0.0, 0.5, 2.0\\}$。\n- 使用绝对容差 $\\varepsilon = 10^{-10}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如，“[true,false,true,true]”。每个条目都是一个布尔值，表示相应的测试用例是否通过了 Crooks 对称性检查，顺序与上面列出的一致。",
            "solution": "该问题要求对一个量子双能级系统，数值验证一个随机热力学对称关系，具体来说是 Crooks 涨落定理的一种形式。该系统经历一个包含热化步骤的淬火协议。解决方案涉及计算正向和逆向功特征函数 $\\chi_F(u)$ 和 $\\chi_R(v)$，并检验它们之间的关系。\n\n对于给定的一组参数——初始能量 $(E_0, E_1)$、最终能量 $(E_0', E_1')$、逆温度 $\\beta$、旋转角 $\\theta$、演化时间 $\\tau$ 和基础速率 $g$——其验证过程结构如下：\n\n1.  **计算平衡性质和自由能：**\n    首先，我们分别计算初始和最终哈密顿量 $H_0$ 和 $H_1$ 的配分函数。\n    初始配分函数为 $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$。\n    最终配分函数为 $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$。\n    $H_0$ 能级的初始吉布斯态概率为 $p_i = e^{-\\beta E_i} / Z_0$，其中 $i \\in \\{0, 1\\}$。\n    类似地，$H_1$ 能级的吉布斯概率为 $p_j' = e^{-\\beta E_j'} / Z_1$，其中 $j \\in \\{0, 1\\}$。\n    自由能差为 $\\Delta F = F_1 - F_0 = -\\beta^{-1}(\\ln Z_1 - \\ln Z_0)$。出现在 Crooks 关系式中的项是 $e^{-\\beta \\Delta F} = Z_1/Z_0$。\n\n2.  **构建速率矩阵和跃迁矩阵：**\n    系统在与热浴弱耦合下的演化，是在相应哈密顿量的能量本征基中通过经典主方程建模的。\n    对于具有能量 $(E_a, E_b)$ 的通用哈密顿量，跃迁速率由 $w_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}$ 和 $w_{b \\to a} = g$ 给出。我们假设 $E_b > E_a$。\n    相应的速率矩阵 $\\mathcal{R}$ 是：\n    $$\n    \\mathcal{R} =\n    \\begin{pmatrix}\n    -w_{a \\to b} & w_{b \\to a} \\\\\n    w_{a \\to b} & -w_{b \\to a}\n    \\end{pmatrix}\n    $$\n    在持续时间 $\\tau$ 内的跃迁概率矩阵由矩阵指数 $M(\\tau) = e^{\\mathcal{R}\\tau}$ 给出。此计算对初始哈密顿量 $H_0$（使用能量 $(E_0, E_1)$）和最终哈密顿量 $H_1$（使用能量 $(E_0', E_1')$）都进行，从而得到矩阵 $M_0(\\tau)$ 和 $M_1(\\tau)$。矩阵指数可以使用诸如 `scipy.linalg.expm` 的例程进行数值计算。\n\n3.  **确定交叠概率和联合概率：**\n    从 $H_0$ 到 $H_1$（反之亦然）的突发淬火导致了能量本征基之间的不匹配，它们通过一个旋转角 $\\theta$ 相关联。由于这种基矢变换引起的跃迁概率矩阵 $C_{j|i} = |\\langle\\phi_j|\\psi_i\\rangle|^2$ 是：\n    $$\n    C = \\begin{pmatrix} C_{0|0} & C_{0|1} \\\\ C_{1|0} & C_{1|1} \\end{pmatrix} = \\begin{pmatrix} \\cos^2\\theta & \\sin^2\\theta \\\\ \\sin^2\\theta & \\cos^2\\theta \\end{pmatrix}\n    $$\n    逆向淬火概率由 $D_{k|j} = |\\langle\\psi_k|\\phi_j\\rangle|^2 = C_{j|k}$ 给出，因此矩阵 $D$ 是 $C$ 的转置。\n\n    正向过程（初始测量到 $E_i$，最终测量到 $E_j'$）的联合概率 $P_F(i \\to j)$ 是通过对所有中间路径求和计算的：\n    $$\n    P_F(i \\to j) = p_i \\sum_{k=0,1} C_{k|i} [M_1(\\tau)]_{jk}\n    $$\n    类似地，逆向过程的联合概率 $P_R(j \\to i)$ 是：\n    $$\n    P_R(j \\to i) = p_j' \\sum_{k=0,1} D_{k|j} [M_0(\\tau)]_{ik} = p_j' \\sum_{k=0,1} C_{j|k} [M_0(\\tau)]_{ik}\n    $$\n    计算每个过程的这四个概率（例如，$P_F(0\\to0), P_F(0\\to1), P_F(1\\to0), P_F(1\\to1)$）。\n\n4.  **计算特征函数：**\n    使用联合概率，我们为测试集 $\\mathcal{U}$ 中的每个 $u$ 值计算正向和逆向功特征函数。\n    正向特征函数是：\n    $$\n    \\chi_F(u) = \\sum_{i,j \\in \\{0,1\\}} P_F(i \\to j) e^{i u (E_j' - E_i)}\n    $$\n    逆向特征函数在复自变量 $v = -u + i\\beta$ 处求值：\n    $$\n    \\chi_R(-u + i\\beta) = \\sum_{j,i \\in \\{0,1\\}} P_R(j \\to i) e^{i(-u+i\\beta) (E_i - E_j')}\n    $$\n\n5.  **验证对称关系：**\n    对于每个 $u \\in \\mathcal{U}$，我们计算 Crooks 对称关系的左侧（LHS）$\\chi_F(u)$ 和右侧（RHS）$e^{-\\beta \\Delta F} \\chi_R(-u + i\\beta)$。计算它们的绝对差 $|LHS - RHS|$。\n    找出在所有 $u \\in \\mathcal{U}$ 上的这些差值的最大值：\n    $$\n    \\text{discrepancy} = \\max_{u \\in \\mathcal{U}} |\\chi_F(u) - e^{-\\beta\\Delta F} \\chi_R(-u + i\\beta)|\n    $$\n    最后，将此最大偏差与给定的容差 $\\varepsilon = 10^{-10}$ 进行比较。如果偏差小于 $\\varepsilon$，则该测试用例的验证通过。对所有提供的四个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the problem by verifying the Crooks symmetry relation for four test cases.\n    \"\"\"\n\n    test_cases = [\n        # 1. Happy path\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 1.0, 'g': 0.8},\n        # 2. No dynamics (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 0.0, 'g': 0.8},\n        # 3. No rotation (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.2), 'beta': 1.5, 'theta': 0.0, 'tau': 2.0, 'g': 0.7},\n        # 4. Long relaxation (edge)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.1), 'beta': 2.0, 'theta': 0.25, 'tau': 50.0, 'g': 0.4},\n    ]\n\n    u_values = [-2.0, -0.5, 0.0, 0.5, 2.0]\n    tolerance = 1e-10\n\n    results = []\n    for params in test_cases:\n        discrepancy = verify_crooks_for_case(params, u_values)\n        results.append(discrepancy  tolerance)\n\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\ndef verify_crooks_for_case(params, u_values):\n    \"\"\"\n    Computes the maximum discrepancy for a single test case.\n    \"\"\"\n    E = np.array(params['E'])\n    E_p = np.array(params['E_p'])\n    beta = params['beta']\n    theta = params['theta']\n    tau = params['tau']\n    g = params['g']\n\n    # 1. Equilibrium properties and free energy\n    Z0 = np.sum(np.exp(-beta * E))\n    Z1 = np.sum(np.exp(-beta * E_p))\n    p = np.exp(-beta * E) / Z0\n    p_p = np.exp(-beta * E_p) / Z1\n    exp_neg_beta_delta_F = Z1 / Z0\n    \n    # 2. Rate and transition matrices\n    def get_transition_matrix(energies, beta_val, g_val, tau_val):\n        E_a, E_b = energies[0], energies[1]\n        # Assuming E_b > E_a, which holds for all test cases.\n        w_ab = g_val * np.exp(-beta_val * (E_b - E_a))\n        w_ba = g_val\n        R = np.array([[-w_ab, w_ba], [w_ab, -w_ba]])\n        return expm(R * tau_val)\n\n    M0 = get_transition_matrix(E, beta, g, tau)\n    M1 = get_transition_matrix(E_p, beta, g, tau)\n\n    # 3. Overlap and joint probabilities\n    cos2_theta = np.cos(theta)**2\n    sin2_theta = np.sin(theta)**2\n    C = np.array([[cos2_theta, sin2_theta],\n                  [sin2_theta, cos2_theta]])\n\n    # PF[j, i] corresponds to P_F(i -> j)\n    PF = np.zeros((2, 2))\n    for i in range(2):\n        for j in range(2):\n            # Sum over intermediate states k\n            prob_sum = np.dot(M1[j, :], C[:, i])\n            PF[j, i] = p[i] * prob_sum\n    \n    # PR[i, j] corresponds to P_R(j -> i)\n    PR = np.zeros((2, 2))\n    for j in range(2):\n        for i in range(2):\n            # Sum over intermediate states k\n            # D_kj = C_jk\n            prob_sum = np.dot(M0[i, :], C[j, :])\n            PR[i, j] = p_p[j] * prob_sum\n\n    # 4  5. Compute characteristic functions and verify symmetry\n    max_discrepancy = 0.0\n    for u in u_values:\n        # Forward characteristic function\n        chi_F = 0.0j\n        for i in range(2):\n            for j in range(2):\n                work = E_p[j] - E[i]\n                chi_F += PF[j, i] * np.exp(1j * u * work)\n        \n        # Reverse characteristic function\n        v = -u + 1j * beta\n        chi_R_v = 0.0j\n        for j in range(2):\n            for i in range(2):\n                rev_work = E[i] - E_p[j]\n                chi_R_v += PR[i, j] * np.exp(1j * v * rev_work)\n        \n        lhs = chi_F\n        rhs = exp_neg_beta_delta_F * chi_R_v\n        \n        discrepancy = np.abs(lhs - rhs)\n        if discrepancy > max_discrepancy:\n            max_discrepancy = discrepancy\n\n    return max_discrepancy\n\nsolve()\n```"
        }
    ]
}