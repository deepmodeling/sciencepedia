{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the complexities of quantum work, it is highly instructive to first master the concepts in a classical stochastic framework. This exercise provides a foundational case study: an overdamped particle in a harmonic trap that is being dragged through a thermal fluid. By solving the corresponding Langevin equation for the particle's motion, you will practice calculating the characteristic function of the work distribution. This will allow you to see how the statistical properties of work, such as its average and variance, emerge directly from the interplay between external driving, dissipative forces, and thermal fluctuations. ",
            "id": "1116713",
            "problem": "An overdamped particle is confined in one dimension by a harmonic potential $V(x, t) = \\frac{1}{2}k(x - x_0(t))^2$, where $k$ is the spring constant. The particle is immersed in a thermal fluid at a constant absolute temperature $T$, which can be modeled as a heat bath. The interaction with the fluid results in a frictional force with coefficient $\\gamma$ and a stochastic thermal force. The dynamics of the particle's position $x(t)$ is described by the Langevin equation:\n$$ \\gamma \\frac{dx}{dt} = -\\frac{\\partial V(x,t)}{\\partial x} + \\xi(t) $$\nwhere $\\xi(t)$ is a Gaussian white noise term with zero mean, $\\langle \\xi(t) \\rangle = 0$, and correlation given by the fluctuation-dissipation theorem: $\\langle \\xi(t)\\xi(t') \\rangle = 2\\gamma k_B T \\delta(t-t')$, where $k_B$ is the Boltzmann constant.\n\nInitially, at $t=0$, the harmonic trap is centered at $x_0(0)=0$ and the particle is in thermal equilibrium with the heat bath. For $t>0$, the center of the trap is moved at a constant velocity $v$, such that $x_0(t) = vt$. This process continues for a finite time interval of duration $\\tau$.\n\nThe work $W$ performed on the particle by the external agent that moves the trap is given by the integral of the power exerted:\n$$ W = \\int_0^\\tau \\frac{\\partial V(x(t), t)}{\\partial t} dt $$\n\nYour task is to calculate the characteristic function of the work probability distribution, $\\Phi_W(u) = \\langle e^{iuW} \\rangle$, where $u$ is a real variable and the angle brackets $\\langle \\cdot \\rangle$ denote an average over all possible noise realizations and initial conditions.\n\nExpress your final answer in terms of the given physical parameters: $k, \\gamma, v, \\tau, T, k_B$, and the variable $u$.\n\n**Find:** The characteristic function $\\Phi_W(u)$.",
            "solution": "1.  **Dynamics:** Set $y=x-vt$. The Langevin equation becomes:\n    $$\\gamma\\dot y=-ky-\\gamma v+\\xi(t).$$\n    The steady-state particular solution is $y_p=-\\gamma v/k$. The general solution is:\n    $$y(t)=y_p+[y(0)-y_p]e^{-kt/\\gamma}+\\frac{1}{\\gamma}\\int_0^t e^{-k(t-s)/\\gamma}\\xi(s)ds.$$\n\n2.  **Work Calculation:** The work is given by:\n    $$W=\\int_0^\\tau\\frac{\\partial V}{\\partial t}dt=-kv\\int_0^\\tau y(t)\\,dt.$$\n    Integrating the expression for $y(t)$:\n    $$\\int_0^\\tau y(t)\\,dt = y_p\\tau+[y(0)-y_p]\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma}) + \\int_0^\\tau dt\\int_0^t\\frac{e^{-k(t-s)/\\gamma}}{\\gamma}\\,\\xi(s)ds.$$\n    Thus, the work is:\n    $$W=\\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}(1-e^{-k\\tau/\\gamma}) -\\gamma v(1-e^{-k\\tau/\\gamma})y(0)-kv\\int_0^\\tau dt\\int_0^t\\frac{e^{-k(t-s)/\\gamma}}{\\gamma}\\xi(s)ds.$$\n\n3.  **Characteristic Function:** Since $W$ is a linear functional of the Gaussian noise $\\xi(t)$, its distribution is Gaussian. The characteristic function is thus given by $\\Phi_W(u) = \\exp(iu\\langle W\\rangle - u^2\\mathrm{Var}(W)/2)$. From the initial equilibrium condition, $\\langle y(0) \\rangle = 0$ and $\\mathrm{Var}(y(0)) = k_B T/k$. Using these and the noise correlator, we find the mean and variance of the work:\n    $$\\langle W \\rangle = \\gamma v^2\\tau - \\frac{\\gamma^2v^2}{k}(1-e^{-k\\tau/\\gamma})$$\n    $$\\mathrm{Var}(W) = 2\\gamma v^2 k_B T \\left[\\tau - \\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\right]$$\n\n4.  **Final Result:** Combining the mean and variance gives the characteristic function:\n    $$\\Phi_W(u) = \\exp\\Bigl[iu\\Bigl(\\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}(1-e^{-k\\tau/\\gamma})\\Bigr) - u^2\\,\\gamma v^2 k_B T\\Bigl(\\tau-\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\Bigr)\\Bigr].$$",
            "answer": "$$\\boxed{\\exp\\!\\Bigl[iu\\Bigl(\\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)\\;-\\;u^2\\,\\gamma v^2k_B T\\Bigl(\\tau-\\frac{\\gamma}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)\\Bigr]}$$"
        },
        {
            "introduction": "We now transition to the quantum realm, where the definition of work relies on the two-point measurement (TPM) protocol. This practice problem applies the TPM scheme to one of the most canonical examples of a driven quantum system: a two-level system undergoing a Landau-Zener sweep. Here, the work performed is intrinsically linked to the probability of non-adiabatic transitions between the system's energy eigenstates. Calculating the work characteristic function will provide direct insight into how quantum dynamics and the probabilistic nature of measurement fundamentally shape thermodynamic work in the quantum world. ",
            "id": "452914",
            "problem": "Consider a two-level quantum system described in the basis of Pauli matrices $\\{\\sigma_x, \\sigma_y, \\sigma_z\\}$ by the time-dependent Hamiltonian:\n$$\nH(t) = -\\frac{1}{2} (v t \\sigma_z + \\Delta \\sigma_x)\n$$\nwhere $\\Delta$ is the constant minimum energy gap and $v$ is the sweep rate of the energy bias. The system is driven by this Hamiltonian for a finite duration, from an initial time $t_i = -T$ to a final time $t_f = +T$. We set $\\hbar=1$ and the Boltzmann constant $k_B=1$.\n\nInitially, at time $t_i=-T$, the system is in thermal equilibrium with a heat bath at a constant inverse temperature $\\beta$. The subsequent evolution from $t=-T$ to $t=+T$ is unitary and isolated from the bath.\n\nWork, $W$, is performed on the system during this process. The value of work is determined by a two-point energy measurement protocol:\n1.  At $t=-T$, the energy of the system is measured.\n2.  The system evolves unitarily until $t=+T$.\n3.  At $t=+T$, the energy of the system is measured again.\nThe work done is the difference between the second and first energy measurement outcomes.\n\nYour task is to calculate the characteristic function of the work distribution, defined as the expectation value $G(u) = \\langle e^{iuW} \\rangle$, where $u$ is a real variable.\n\nFor your calculation, you may assume that the sweep duration is long enough such that $vT \\gg \\Delta$. This allows the use of the standard Landau-Zener formula for the non-adiabatic transition probability between the instantaneous adiabatic eigenstates of the system, which is given by $P_{LZ} = \\exp(-\\pi \\Delta^2 / v)$.\n\nExpress your final answer as a single, closed-form analytic expression in terms of the given parameters $\\Delta$, $v$, $T$, $\\beta$, and $u$.",
            "solution": "1.  Define $E_T = \\frac{1}{2}\\sqrt{(vT)^2+\\Delta^2}$ and $P_{LZ}=e^{-\\pi\\Delta^2/v}$.\n2.  Initial energies are $E_n(-T)=nE_T$, for $n=\\pm 1$. Initial probabilities are $p_n=e^{-\\beta nE_T}/(2\\cosh(\\beta E_T))$.\n3.  Final energies are $E_m(+T)=mE_T$, for $m=\\pm 1$. Transition probabilities are $P_{m|n}=(1-P_{LZ})\\delta_{mn}+P_{LZ}(1-\\delta_{mn})$.\n4.  Work values are $W_{m,n}=(m-n)E_T$.\n5.  The characteristic function is given by the definition:\n    $$G(u)=\\sum_{n,m=\\pm1}p_nP_{m|n}e^{iu(m-n)E_T}.$$\n6.  Separating the sums for $m=n$ (work is 0) and $m=-n$:\n    $$G(u)=\\sum_{n}p_n(1-P_{LZ})+\\sum_{n}p_nP_{LZ}e^{-2iunE_T} = (1-P_{LZ})+P_{LZ}\\sum_{n=\\pm1}p_n e^{-2iunE_T}.$$\n7.  Substituting the expression for $p_n$ and simplifying the sum:\n    $$\\sum_{n}p_ne^{-2iunE_T} = \\frac{e^{-\\beta E_T}e^{-2iuE_T}+e^{\\beta E_T}e^{2iuE_T}}{2\\cosh(\\beta E_T)} = \\frac{\\cosh\\bigl((\\beta+2iu)E_T\\bigr)}{\\cosh(\\beta E_T)}.$$\n8.  Thus, the characteristic function is:\n    $$G(u)=(1-P_{LZ})+P_{LZ}\\frac{\\cosh\\bigl((\\beta+2iu)E_T\\bigr)}{\\cosh(\\beta E_T)}.$$\n9.  Replacing $E_T$ and $P_{LZ}$ gives the final closed form.",
            "answer": "$$\\boxed{\nG(u)=1-e^{-\\frac{\\pi\\Delta^2}{v}}\n+e^{-\\frac{\\pi\\Delta^2}{v}}\\,\n\\frac{\\cosh\\!\\Bigl(\\bigl(\\beta+2i u\\bigr)\\tfrac{\\sqrt{(vT)^2+\\Delta^2}}{2}\\Bigr)}\n{\\cosh\\!\\Bigl(\\beta\\,\\tfrac{\\sqrt{(vT)^2+\\Delta^2}}{2}\\Bigr)}\n}$$"
        },
        {
            "introduction": "This final practice advances our analysis to include open quantum systems and the verification of a fundamental fluctuation theorem. You will model a process involving a sudden quench of a system's Hamiltonian, followed by a period of thermal relaxation governed by a master equation that respects the quantum detailed balance condition. Your task is not merely to calculate a work distribution, but to implement a numerical test of the Crooks fluctuation theorem, which establishes a profound symmetry between forward and reverse processes. This computational exercise solidifies the connection between microscopic reversibility and macroscopic thermodynamic laws, a cornerstone of modern statistical physics. ",
            "id": "3778125",
            "problem": "Consider a quantum two-level system undergoing a sudden quench from an initial Hamiltonian $H_0$ with energy eigenvalues ($E_0$, $E_1$) and eigenbasis {$\\lvert \\psi_0 \\rangle$, $\\lvert \\psi_1 \\rangle$} to a final Hamiltonian $H_1$ with energy eigenvalues ($E_0'$, $E_1'$) and eigenbasis {$\\lvert \\phi_0 \\rangle$, $\\lvert \\phi_1 \\rangle$}. The system is initially prepared in the Gibbs state at inverse temperature $\\beta$, and work is defined via the Two-Point Measurement (TPM) scheme: the energy is projectively measured at the beginning (with respect to $H_0$) and at the end (with respect to $H_1$).\n\nThe eigenbases are related by a real rotation by an angle $\\theta$, so that\n$$\n\\lvert \\phi_0 \\rangle = \\cos\\theta \\,\\lvert \\psi_0 \\rangle + \\sin\\theta \\,\\lvert \\psi_1 \\rangle, \\quad \n\\lvert \\phi_1 \\rangle = -\\sin\\theta \\,\\lvert \\psi_0 \\rangle + \\cos\\theta \\,\\lvert \\psi_1 \\rangle,\n$$\nand therefore the overlap probabilities are\n$$\nC_{j|i} = \\left|\\langle \\phi_j \\mid \\psi_i \\rangle\\right|^2 =\n\\begin{cases}\n\\cos^2\\theta & \\text{if } (j,i) \\in \\{(0,0),(1,1)\\}, \\\\\n\\sin^2\\theta & \\text{if } (j,i) \\in \\{(1,0),(0,1)\\}.\n\\end{cases}\n$$\n\nBetween the initial and final energy measurements, the system is weakly coupled to a thermal bath and evolves under a time-homogeneous generator that satisfies the Quantum Detailed Balance (QDB) condition. In the two-level energy basis this reduces to a classical two-state Markov generator with rates that obey detailed balance. For any Hamiltonian $H$ with energies ($E_a$, $E_b$), define a base rate parameter $g > 0$ and set upward and downward transition rates\n$$\nw_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}, \\quad w_{b \\to a} = g,\n$$\nwhich ensure detailed balance with respect to the Gibbs stationary distribution. The corresponding $2\\times 2$ rate matrix $\\mathcal{R}$ acting on the column probability vector $p$ via $\\frac{d}{dt} p = \\mathcal{R}\\, p$ is\n$$\n\\mathcal{R} =\n\\begin{pmatrix}\n- w_{a \\to b} & w_{b \\to a} \\\\\nw_{a \\to b} & - w_{b \\to a}\n\\end{pmatrix},\n$$\nand the transition matrix over a duration $\\tau$ is given by the matrix exponential\n$$\nM(\\tau) = e^{\\mathcal{R}\\, \\tau}.\n$$\n\nDefine the forward process as follows: draw $i \\in \\{0,1\\}$ according to the thermal probabilities $p_i = e^{-\\beta E_i}/Z_0$, where $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$; perform the sudden quench to $H_1$; in the $H_1$ basis, the post-quench state given $i$ is distributed as $C_{k|i}$ over $k \\in \\{0,1\\}$; propagate under the $H_1$ generator for time $\\tau$, with transition matrix $M_1(\\tau)$; finally measure the energy of $H_1$, obtaining $j \\in \\{0,1\\}$. The corresponding joint probability is\n$$\nP_F(i \\to j) = p_i \\sum_{k} C_{k|i}\\, [M_1(\\tau)]_{j k}.\n$$\nSimilarly, the reverse process starts in the thermal state of $H_1$ with $p_j' = e^{-\\beta E_j'}/Z_1$, where $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$; measure the energy of $H_1$ obtaining $j$; quench back to $H_0$; in the $H_0$ basis, the post-quench state is distributed as $D_{i|j} = \\left|\\langle \\psi_i \\mid \\phi_j \\rangle\\right|^2 = C_{j|i}$; propagate under the $H_0$ generator for time $\\tau$, with transition matrix $M_0(\\tau)$; finally measure the energy of $H_0$, obtaining $i$. The corresponding joint probability is\n$$\nP_R(j \\to i) = p_j' \\sum_{k} D_{k|j}\\, [M_0(\\tau)]_{i k}.\n$$\n\nThe forward work characteristic function is defined by\n$$\n\\chi_F(u) = \\sum_{i,j} P_F(i \\to j)\\, e^{i u (E_j' - E_i)},\n$$\nand the reverse work characteristic function is defined by\n$$\n\\chi_R(v) = \\sum_{j,i} P_R(j \\to i)\\, e^{i v (E_i - E_j')}.\n$$\nLet the free energy difference be $\\Delta F = F_1 - F_0$, with $F_\\nu = -\\beta^{-1} \\ln Z_\\nu$ so that $e^{-\\beta \\Delta F} = Z_1/Z_0$.\n\nTask:\n- Implement the computation of $\\chi_F(u)$ and $\\chi_R(v)$ for a two-level system as described above.\n- Numerically verify the Crooks symmetry\n$$\n\\chi_F(u) \\approx e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta),\n$$\nover a specified set of real values of $u$, using a uniform absolute tolerance.\n\nYour program must:\n- Use the above definitions to compute the characteristic functions for each test case.\n- For each test case, evaluate the maximum absolute discrepancy\n$$\n\\max_{u \\in \\mathcal{U}} \\left| \\chi_F(u) - e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta) \\right|\n$$\nover the set $\\mathcal{U}$ of tested $u$ values, and return a boolean indicating whether the discrepancy is within the tolerance.\n\nTest suite:\n- Use the following four parameter sets, with all quantities dimensionless:\n    1. Happy path: ($E_0$, $E_1$) = (0.0, 1.0), ($E_0'$, $E_1'$) = (0.0, 1.3), $\\beta = 1.5$, $\\theta = 0.37$, $\\tau = 1.0$, $g = 0.8$.\n    2. No dynamics (boundary): same energies and $\\theta$ as in $1$, $\\beta = 1.5$, $\\tau = 0.0$, $g = 0.8$.\n    3. No rotation (boundary): ($E_0$, $E_1$) = (0.0, 1.0), ($E_0'$, $E_1'$) = (0.0, 1.2), $\\beta = 1.5$, $\\theta = 0.0$, $\\tau = 2.0$, $g = 0.7$.\n    4. Long relaxation (edge): ($E_0$, $E_1$) = (0.0, 1.0), ($E_0'$, $E_1'$) = (0.0, 1.1), $\\beta = 2.0$, $\\theta = 0.25$, $\\tau = 50.0$, $g = 0.4$.\n- Use the set of $u$ values $\\mathcal{U} = \\{-2.0, -0.5, 0.0, 0.5, 2.0\\}$.\n- Use an absolute tolerance $\\varepsilon = 10^{-10}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[true,false,true,true]\". Each entry is a boolean indicating whether the Crooks symmetry check passed for the corresponding test case, in the order listed above.",
            "solution": "The problem requires the numerical verification of a stochastic thermodynamic symmetry relation, specifically a form of the Crooks fluctuation theorem, for a quantum two-level system. The system undergoes a quench protocol involving thermalization steps. The solution involves computing the forward and reverse work characteristic functions, $\\chi_F(u)$ and $\\chi_R(v)$, and checking their relationship.\n\nThe verification process for a given set of parameters—initial energies ($E_0, E_1$), final energies ($E_0', E_1'$), inverse temperature $\\beta$, rotation angle $\\theta$, evolution time $\\tau$, and base rate $g$—is structured as follows:\n\n1.  **Calculate Equilibrium Properties and Free Energy:**\n    First, we compute the partition functions for the initial and final Hamiltonians, $H_0$ and $H_1$, respectively.\n    The initial partition function is $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$.\n    The final partition function is $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$.\n    The initial Gibbs state probabilities for the energy levels of $H_0$ are $p_i = e^{-\\beta E_i} / Z_0$ for $i \\in \\{0, 1\\}$.\n    Similarly, the Gibbs probabilities for the energy levels of $H_1$ are $p_j' = e^{-\\beta E_j'} / Z_1$ for $j \\in \\{0, 1\\}$.\n    The free energy difference is $\\Delta F = F_1 - F_0 = -\\beta^{-1}(\\ln Z_1 - \\ln Z_0)$. The term appearing in the Crooks relation is $e^{-\\beta \\Delta F} = Z_1/Z_0$.\n\n2.  **Construct Rate and Transition Matrices:**\n    The system's evolution under weak coupling to a thermal bath is modeled by a classical master equation in the energy eigenbasis of the respective Hamiltonian.\n    For a generic Hamiltonian with energies ($E_a, E_b$), the transition rates are given by $w_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}$ and $w_{b \\to a} = g$. We assume $E_b > E_a$.\n    The corresponding rate matrix $\\mathcal{R}$ is:\n    $$\n    \\mathcal{R} =\n    \\begin{pmatrix}\n    -w_{a \\to b} & w_{b \\to a} \\\\\n    w_{a \\to b} & -w_{b \\to a}\n    \\end{pmatrix}\n    $$\n    The transition probability matrix over a duration $\\tau$ is given by the matrix exponential $M(\\tau) = e^{\\mathcal{R}\\tau}$. This calculation is performed for both the initial Hamiltonian $H_0$ (using energies ($E_0, E_1$)) and the final Hamiltonian $H_1$ (using energies ($E_0', E_1'$)), yielding matrices $M_0(\\tau)$ and $M_1(\\tau)$. The matrix exponential can be computed numerically using routines such as `scipy.linalg.expm`.\n\n3.  **Determine Overlap and Joint Probabilities:**\n    The sudden quench from $H_0$ to $H_1$ (and vice versa) causes a mismatch between the energy eigenbases, related by a rotation angle $\\theta$. The matrix of transition probabilities due to this basis change, $C_{j|i} = |\\langle\\phi_j|\\psi_i\\rangle|^2$, is:\n    $$\n    C = \\begin{pmatrix} C_{0|0} & C_{0|1} \\\\ C_{1|0} & C_{1|1} \\end{pmatrix} = \\begin{pmatrix} \\cos^2\\theta & \\sin^2\\theta \\\\ \\sin^2\\theta & \\cos^2\\theta \\end{pmatrix}\n    $$\n    The reverse quench probabilities are given by $D_{k|j} = |\\langle\\psi_k|\\phi_j\\rangle|^2 = C_{j|k}$, so the matrix $D$ is the transpose of $C$.\n\n    The joint probability $P_F(i \\to j)$ for the forward process (measuring $E_i$ initially and $E_j'$ finally) is calculated by summing over all intermediate pathways:\n    $$\n    P_F(i \\to j) = p_i \\sum_{k=0,1} C_{k|i} [M_1(\\tau)]_{jk}\n    $$\n    Similarly, the joint probability $P_R(j \\to i)$ for the reverse process is:\n    $$\n    P_R(j \\to i) = p_j' \\sum_{k=0,1} D_{k|j} [M_0(\\tau)]_{ik} = p_j' \\sum_{k=0,1} C_{j|k} [M_0(\\tau)]_{ik}\n    $$\n    These four probabilities for each process (e.g., $P_F(0\\to0), P_F(0\\to1), P_F(1\\to0), P_F(1\\to1)$) are computed.\n\n4.  **Compute Characteristic Functions:**\n    Using the joint probabilities, we compute the forward and reverse work characteristic functions for each value of $u$ in the test set $\\mathcal{U}$.\n    The forward characteristic function is:\n    $$\n    \\chi_F(u) = \\sum_{i,j \\in \\{0,1\\}} P_F(i \\to j) e^{i u (E_j' - E_i)}\n    $$\n    The reverse characteristic function is evaluated at the complex argument $v = -u + i\\beta$:\n    $$\n    \\chi_R(-u + i\\beta) = \\sum_{j,i \\in \\{0,1\\}} P_R(j \\to i) e^{i(-u+i\\beta) (E_i - E_j')}\n    $$\n\n5.  **Verify the Symmetry Relation:**\n    For each $u \\in \\mathcal{U}$, we compute the left-hand side (LHS), $\\chi_F(u)$, and the right-hand side (RHS), $e^{-\\beta \\Delta F} \\chi_R(-u + i\\beta)$, of the Crooks symmetry relation. The absolute difference $|LHS - RHS|$ is calculated.\n    The maximum of these differences across all $u \\in \\mathcal{U}$ is found:\n    $$\n    \\text{discrepancy} = \\max_{u \\in \\mathcal{U}} |\\chi_F(u) - e^{-\\beta\\Delta F} \\chi_R(-u + i\\beta)|\n    $$\n    Finally, this maximum discrepancy is compared against the given tolerance $\\varepsilon = 10^{-10}$. If the discrepancy is less than $\\varepsilon$, the verification passes for that test case. This procedure is repeated for all four test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the problem by verifying the Crooks symmetry relation for four test cases.\n    \"\"\"\n\n    test_cases = [\n        # 1. Happy path\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 1.0, 'g': 0.8},\n        # 2. No dynamics (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 0.0, 'g': 0.8},\n        # 3. No rotation (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.2), 'beta': 1.5, 'theta': 0.0, 'tau': 2.0, 'g': 0.7},\n        # 4. Long relaxation (edge)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.1), 'beta': 2.0, 'theta': 0.25, 'tau': 50.0, 'g': 0.4},\n    ]\n\n    u_values = [-2.0, -0.5, 0.0, 0.5, 2.0]\n    tolerance = 1e-10\n\n    results = []\n    for params in test_cases:\n        discrepancy = verify_crooks_for_case(params, u_values)\n        results.append(discrepancy  tolerance)\n\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\ndef verify_crooks_for_case(params, u_values):\n    \"\"\"\n    Computes the maximum discrepancy for a single test case.\n    \"\"\"\n    E = np.array(params['E'])\n    E_p = np.array(params['E_p'])\n    beta = params['beta']\n    theta = params['theta']\n    tau = params['tau']\n    g = params['g']\n\n    # 1. Equilibrium properties and free energy\n    Z0 = np.sum(np.exp(-beta * E))\n    Z1 = np.sum(np.exp(-beta * E_p))\n    p = np.exp(-beta * E) / Z0\n    p_p = np.exp(-beta * E_p) / Z1\n    exp_neg_beta_delta_F = Z1 / Z0\n    \n    # 2. Rate and transition matrices\n    def get_transition_matrix(energies, beta_val, g_val, tau_val):\n        E_a, E_b = energies[0], energies[1]\n        # Assuming E_b > E_a, which holds for all test cases.\n        w_ab = g_val * np.exp(-beta_val * (E_b - E_a))\n        w_ba = g_val\n        R = np.array([[-w_ab, w_ba], [w_ab, -w_ba]])\n        return expm(R * tau_val)\n\n    M0 = get_transition_matrix(E, beta, g, tau)\n    M1 = get_transition_matrix(E_p, beta, g, tau)\n\n    # 3. Overlap and joint probabilities\n    cos2_theta = np.cos(theta)**2\n    sin2_theta = np.sin(theta)**2\n    C = np.array([[cos2_theta, sin2_theta],\n                  [sin2_theta, cos2_theta]])\n\n    # PF[j, i] corresponds to P_F(i -> j)\n    PF = np.zeros((2, 2))\n    for i in range(2):\n        for j in range(2):\n            # Sum over intermediate states k\n            prob_sum = np.dot(M1[j, :], C[:, i])\n            PF[j, i] = p[i] * prob_sum\n    \n    # PR[i, j] corresponds to P_R(j -> i)\n    PR = np.zeros((2, 2))\n    for j in range(2):\n        for i in range(2):\n            # Sum over intermediate states k\n            # D_kj = C_jk\n            prob_sum = np.dot(M0[i, :], C[j, :])\n            PR[i, j] = p_p[j] * prob_sum\n\n    # 4  5. Compute characteristic functions and verify symmetry\n    max_discrepancy = 0.0\n    for u in u_values:\n        # Forward characteristic function\n        chi_F = 0.0j\n        for i in range(2):\n            for j in range(2):\n                work = E_p[j] - E[i]\n                chi_F += PF[j, i] * np.exp(1j * u * work)\n        \n        # Reverse characteristic function\n        v = -u + 1j * beta\n        chi_R_v = 0.0j\n        for j in range(2):\n            for i in range(2):\n                rev_work = E[i] - E_p[j]\n                chi_R_v += PR[i, j] * np.exp(1j * v * rev_work)\n        \n        lhs = chi_F\n        rhs = exp_neg_beta_delta_F * chi_R_v\n        \n        discrepancy = np.abs(lhs - rhs)\n        if discrepancy > max_discrepancy:\n            max_discrepancy = discrepancy\n\n    return max_discrepancy\n\nsolve()\n```"
        }
    ]
}