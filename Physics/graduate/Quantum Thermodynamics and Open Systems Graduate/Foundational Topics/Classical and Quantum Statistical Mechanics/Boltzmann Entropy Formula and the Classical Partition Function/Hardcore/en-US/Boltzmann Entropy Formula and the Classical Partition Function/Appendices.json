{
    "hands_on_practices": [
        {
            "introduction": "The classical partition function is the cornerstone of canonical statistical mechanics, acting as a mathematical bridge between the microscopic details of a system and its macroscopic thermodynamic properties. This first practice provides a foundational exercise in wielding this powerful tool. By analyzing a system of independent harmonic oscillators, you will execute the complete workflow: constructing the partition function from the Hamiltonian, performing the phase-space integration, and systematically deriving all key thermodynamic quantities such as free energy, internal energy, entropy, and heat capacity . Mastering this process for an ideal, separable system builds the essential skills needed for tackling more complex scenarios.",
            "id": "3764716",
            "problem": "Consider an open classical system consisting of $N$ independent, one-dimensional harmonic oscillators of equal mass $m$ and angular frequency $\\omega$, each weakly coupled to a large thermal reservoir at absolute temperature $T$ so that the system is in canonical equilibrium. The system Hamiltonian is\n$$\nH(\\{q_i,p_i\\})=\\sum_{i=1}^{N}\\left[\\frac{p_i^{2}}{2m}+\\frac{1}{2}m\\omega^{2}q_i^{2}\\right],\n$$\nwith canonical coordinates $\\{q_i\\}$ and momenta $\\{p_i\\}$. Use the canonical ensemble with inverse temperature $\\beta=1/(k_{B}T)$, where $k_{B}$ is the Boltzmann constant (k_B), and the classical Liouville phase-space measure coarse-grained by the Planck constant (h) per one-dimensional degree-pair to render the partition function dimensionless. Starting from first principles—namely, the canonical probability density $\\rho(\\{q_i,p_i\\})\\propto\\exp(-\\beta H)$ and the definition of the classical canonical partition function as the properly normalized phase-space integral—derive:\n- the total canonical partition function $Z_{N}(T)$ for the $N$ independent oscillators,\n- the Helmholtz free energy $F(T)$,\n- the internal energy $U(T)$,\n- the entropy $S(T)$ obtained via Boltzmann’s framework for equilibrium (equivalently the Gibbs entropy for the canonical state), and\n- the heat capacity at fixed $\\omega$, $C(T)$.\n\nYour derivation should explicitly carry out the phase-space integrals and demonstrate how separability across oscillators is used. Express all final results in closed form in terms of $N$, $m$, $\\omega$, $h$, $k_{B}$, and $T$. Provide your final answer as a single row matrix listing $\\big(Z_{N}(T),\\,F(T),\\,U(T),\\,S(T),\\,C(T)\\big)$. No numerical evaluation is required, and no rounding is needed. Do not include units in the final boxed answer.",
            "solution": "The problem is well-posed and scientifically sound, representing a standard exercise in classical statistical mechanics. We shall proceed with the derivation as requested.\n\nThe system consists of $N$ independent, one-dimensional classical harmonic oscillators. The total Hamiltonian of the system is the sum of the individual Hamiltonians:\n$$H(\\{q_i,p_i\\}) = \\sum_{i=1}^{N} H_i(q_i, p_i) = \\sum_{i=1}^{N}\\left[\\frac{p_i^{2}}{2m}+\\frac{1}{2}m\\omega^{2}q_i^{2}\\right]$$\nwhere $m$ is the mass, $\\omega$ is the angular frequency, and $\\{q_i, p_i\\}$ are the canonical position and momentum coordinates for the $i$-th oscillator. The system is in thermal equilibrium with a reservoir at temperature $T$, described by the canonical ensemble. The inverse temperature is $\\beta = 1/(k_{B}T)$.\n\n**1. The Canonical Partition Function $Z_N(T)$**\n\nThe canonical partition function $Z_N$ for a classical system of $N$ distinguishable degrees of freedom (here, distinguishable oscillators) is given by the integral over the entire $2N$-dimensional phase space, normalized by $h^N$:\n$$Z_N = \\frac{1}{h^N} \\int \\dots \\int \\exp(-\\beta H(\\{q_i, p_i\\})) \\prod_{i=1}^N dq_i dp_i$$\nSince the Hamiltonian is a sum of independent terms, $H = \\sum_{i=1}^N H_i$, the Boltzmann factor $\\exp(-\\beta H)$ becomes a product of individual Boltzmann factors:\n$$Z_N = \\frac{1}{h^N} \\int \\dots \\int \\prod_{i=1}^N \\exp(-\\beta H_i(q_i, p_i)) \\, dq_i dp_i$$\nThe multidimensional integral can be separated into a product of $N$ identical one-particle integrals:\n$$Z_N = \\prod_{i=1}^N \\left[ \\frac{1}{h} \\iint \\exp\\left(-\\beta \\left[\\frac{p_i^2}{2m} + \\frac{1}{2}m\\omega^2q_i^2\\right]\\right) dq_i dp_i \\right]$$\nLet $Z_1$ be the partition function for a single oscillator. Since all oscillators are identical, $Z_N = (Z_1)^N$. We now compute $Z_1$:\n$$Z_1 = \\frac{1}{h} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta\\frac{p^2}{2m}\\right) \\exp\\left(-\\beta\\frac{m\\omega^2q^2}{2}\\right) dp \\, dq$$\nThis integral is a product of two Gaussian integrals:\n$$Z_1 = \\frac{1}{h} \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta}{2m}p^2\\right) dp \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2}{2}q^2\\right) dq \\right)$$\nUsing the standard Gaussian integral formula $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$, we evaluate each integral:\nThe momentum integral gives:\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta}{2m}p^2\\right) dp = \\sqrt{\\frac{\\pi}{\\beta/(2m)}} = \\sqrt{\\frac{2\\pi m}{\\beta}}$$\nThe position integral gives:\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2}{2}q^2\\right) dq = \\sqrt{\\frac{\\pi}{(\\beta m\\omega^2)/2}} = \\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}}$$\nMultiplying these results yields $Z_1$:\n$$Z_1 = \\frac{1}{h} \\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}} = \\frac{1}{h} \\sqrt{\\frac{4\\pi^2 m}{m\\beta^2\\omega^2}} = \\frac{2\\pi}{h\\beta\\omega}$$\nSubstituting $\\beta = 1/(k_B T)$:\n$$Z_1 = \\frac{2\\pi k_B T}{h\\omega}$$\nThe total partition function for $N$ oscillators is therefore:\n$$Z_N(T) = (Z_1)^N = \\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N$$\n\n**2. The Helmholtz Free Energy $F(T)$**\n\nThe Helmholtz free energy $F$ is related to the canonical partition function by the fundamental relation $F = -k_B T \\ln Z_N$.\n$$F(T) = -k_B T \\ln\\left[\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N\\right]$$\nUsing the property of logarithms $\\ln(x^a) = a\\ln(x)$, we get:\n$$F(T) = -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)$$\n\n**3. The Internal Energy $U(T)$**\n\nThe average internal energy $U$ can be calculated from the partition function as $U = -\\frac{\\partial}{\\partial\\beta} \\ln Z_N$.\nFirst, we express $\\ln Z_N$ in terms of $\\beta$:\n$$\\ln Z_N = \\ln\\left[\\left(\\frac{2\\pi}{h\\omega\\beta}\\right)^N\\right] = N \\ln\\left(\\frac{2\\pi}{h\\omega\\beta}\\right) = N(\\ln(2\\pi) - \\ln(h\\omega) - \\ln\\beta)$$\nNow, we differentiate with respect to $\\beta$:\n$$\\frac{\\partial}{\\partial\\beta} \\ln Z_N = \\frac{\\partial}{\\partial\\beta} [N(\\text{const} - \\ln\\beta)] = -N \\frac{1}{\\beta}$$\nThus, the internal energy is:\n$$U = - \\left(-\\frac{N}{\\beta}\\right) = \\frac{N}{\\beta}$$\nSubstituting $\\beta = 1/(k_B T)$:\n$$U(T) = N k_B T$$\nThis result is consistent with the classical equipartition theorem, where each of the $2N$ quadratic degrees of freedom ($p_i^2$ and $q_i^2$) contributes $\\frac{1}{2}k_B T$ to the total energy.\n\n**4. The Entropy $S(T)$**\n\nThe entropy $S$ can be derived from the thermodynamic relation $F = U - TS$, which gives $S = (U-F)/T$.\nUsing our expressions for $U(T)$ and $F(T)$:\n$$S(T) = \\frac{1}{T} \\left[ N k_B T - \\left(-N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right) \\right]$$\n$$S(T) = \\frac{1}{T} \\left[ N k_B T + N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right) \\right]$$\nSimplifying by factoring out $N k_B T$:\n$$S(T) = N k_B \\left[1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right]$$\nAlternatively, we could use $S = -(\\partial F/\\partial T)_{N, \\omega}$, which yields the same result.\n\n**5. The Heat Capacity $C(T)$**\n\nThe heat capacity at constant external parameters (here, fixed $\\omega$) is defined as $C = (\\partial U / \\partial T)_{N, \\omega}$.\nUsing our result for the internal energy $U(T) = N k_B T$:\n$$C(T) = \\frac{\\partial}{\\partial T} (N k_B T)$$\nSince $N$ and $k_B$ are constants, the derivative is:\n$$C(T) = N k_B$$\nThis is the classical Dulong-Petit law for this system, indicating that the heat capacity is independent of temperature.\n\n**Summary of Results:**\nThe derived quantities are:\n- $Z_{N}(T) = \\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N$\n- $F(T) = -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)$\n- $U(T) = N k_B T$\n- $S(T) = N k_B \\left[1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right]$\n- $C(T) = N k_B$\nThese will be presented in a single row matrix as the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N & -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right) & N k_B T & N k_B \\left(1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right) & N k_B\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The classical phase-space integral is a remarkably effective approximation, but it is crucial to understand its origins in the more fundamental framework of quantum mechanics. This exercise explores the correspondence principle by directly comparing the classical partition function with its exact quantum counterpart for a particle in a box. By using an asymptotic approximation, you will see precisely how the continuous classical integral emerges from the discrete quantum sum in the high-temperature limit, where the thermal de Broglie wavelength becomes small compared to the system size . This practice illuminates the physical meaning of the phase-space cell volume $h^{3N}$ and quantifies the first quantum corrections to classical behavior.",
            "id": "3764710",
            "problem": "A single, nonrelativistic particle of mass $m$ is confined in a three-dimensional cubic box of side length $L$ with impenetrable walls (Dirichlet boundary conditions). The particle is weakly coupled to a large thermal reservoir at absolute temperature $T$, justifying the use of the canonical ensemble. Let $\\beta = 1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant, and let $h$ denote the Planck constant and $\\hbar = h/(2\\pi)$ denote the reduced Planck constant. The thermal de Broglie wavelength is defined as $\\lambda_{T} = h / \\sqrt{2\\pi m k_{B} T}$.\n\nStarting from first principles of equilibrium statistical mechanics for quantum and classical systems, and without invoking any shortcut formulas, do the following:\n\n1. Formulate the exact quantum canonical partition function $Z_{\\mathrm{q}}$ for this particle as a sum over all single-particle energy eigenstates for the cubic box.\n2. Formulate the classical canonical partition function $Z_{\\mathrm{cl}}$ for the same particle using the phase-space integral with the appropriate elementary cell volume.\n3. Using a principled asymptotic method applicable when many quantum levels lie within the thermally accessible range, derive the leading-order relation between $Z_{\\mathrm{q}}$ and $Z_{\\mathrm{cl}}$ in the limit where the box is large compared to the thermal wavelength. Express your final result as a closed-form analytic expression for the ratio $Z_{\\mathrm{q}}/Z_{\\mathrm{cl}}$ including the first nontrivial correction term, in terms of $L$ and $\\lambda_{T}$ only.\n\nYour final answer must be the single expression for $Z_{\\mathrm{q}}/Z_{\\mathrm{cl}}$ requested in part 3. No numerical evaluation is required.",
            "solution": "The problem statement has been validated and is deemed a well-posed, scientifically sound problem in statistical mechanics. We proceed with a detailed solution derived from first principles.\n\nThe analysis is structured into three parts as requested: formulation of the quantum partition function ($Z_{\\mathrm{q}}$), formulation of the classical partition function ($Z_{\\mathrm{cl}}$), and the derivation of their asymptotic relationship.\n\n**Part 1: Quantum Canonical Partition Function ($Z_{\\mathrm{q}}$)**\n\nFor a single, nonrelativistic particle of mass $m$ in a three-dimensional cubic box of side length $L$ with impenetrable walls, the time-independent Schrödinger equation with Dirichlet boundary conditions ($\\psi=0$ on the walls) yields quantized energy eigenstates. The energy eigenvalues are given by:\n$$\nE_{n_x, n_y, n_z} = \\frac{\\hbar^2}{2m} \\left( \\frac{\\pi^2 n_x^2}{L^2} + \\frac{\\pi^2 n_y^2}{L^2} + \\frac{\\pi^2 n_z^2}{L^2} \\right) = \\frac{\\pi^2 \\hbar^2}{2mL^2} (n_x^2 + n_y^2 + n_z^2)\n$$\nwhere $n_x$, $n_y$, and $n_z$ are positive integers, i.e., $n_i \\in \\{1, 2, 3, \\dots\\}$.\n\nThe system is in thermal equilibrium with a reservoir at temperature $T$, so we use the canonical ensemble. The quantum canonical partition function $Z_{\\mathrm{q}}$ is the sum of Boltzmann factors over all possible single-particle quantum states:\n$$\nZ_{\\mathrm{q}} = \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\exp(-\\beta E_{n_x, n_y, n_z})\n$$\nwhere $\\beta = 1/(k_B T)$. Substituting the energy eigenvalues:\n$$\nZ_{\\mathrm{q}} = \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\exp\\left( -\\frac{\\beta \\pi^2 \\hbar^2}{2mL^2} (n_x^2 + n_y^2 + n_z^2) \\right)\n$$\nSince the exponential of a sum is the product of exponentials, the triple sum can be factorized into the product of three identical, independent sums, one for each spatial dimension:\n$$\nZ_{\\mathrm{q}} = \\left[ \\sum_{n=1}^{\\infty} \\exp\\left( -\\frac{\\beta \\pi^2 \\hbar^2}{2mL^2} n^2 \\right) \\right]^3\n$$\nThis expression is the exact formulation of the quantum partition function for the system.\n\n**Part 2: Classical Canonical Partition Function ($Z_{\\mathrm{cl}}$)**\n\nIn classical statistical mechanics, the partition function for a single particle is given by the integral over all accessible phase space, divided by the volume of a single elementary cell, $h^3$. The Hamiltonian for a free particle is purely kinetic: $H(\\mathbf{r}, \\mathbf{p}) = |\\mathbf{p}|^2 / (2m)$.\n$$\nZ_{\\mathrm{cl}} = \\frac{1}{h^3} \\int d^3\\mathbf{r} \\int d^3\\mathbf{p} \\, \\exp(-\\beta H(\\mathbf{r}, \\mathbf{p}))\n$$\nThe integral over the spatial coordinates $\\mathbf{r}$ is restricted to the volume of the box, $V = L^3$:\n$$\n\\int d^3\\mathbf{r} = L^3\n$$\nThe integral over the momentum coordinates $\\mathbf{p}$ is over all possible momenta from $-\\infty$ to $\\infty$. This integral can also be factorized:\n$$\n\\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta}{2m}(p_x^2 + p_y^2 + p_z^2)\\right) = \\left[ \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right]^3\n$$\nThe inner integral is a standard Gaussian integral, $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$. With $a = \\beta/(2m)$, we have:\n$$\n\\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) = \\sqrt{\\frac{2m\\pi}{\\beta}} = \\sqrt{2\\pi m k_B T}\n$$\nCombining these results, the classical partition function is:\n$$\nZ_{\\mathrm{cl}} = \\frac{L^3}{h^3} \\left( \\sqrt{2\\pi m k_B T} \\right)^3 = \\frac{L^3}{h^3} (2\\pi m k_B T)^{3/2}\n$$\nUsing the given definition of the thermal de Broglie wavelength, $\\lambda_T = h / \\sqrt{2\\pi m k_B T}$, we can express $Z_{\\mathrm{cl}}$ as:\n$$\nZ_{\\mathrm{cl}} = L^3 \\left( \\frac{\\sqrt{2\\pi m k_B T}}{h} \\right)^3 = L^3 \\left( \\frac{1}{\\lambda_T} \\right)^3 = \\left(\\frac{L}{\\lambda_T}\\right)^3\n$$\n\n**Part 3: Asymptotic Relation between $Z_{\\mathrm{q}}$ and $Z_{\\mathrm{cl}}$**\n\nWe wish to find the relation between $Z_{\\mathrm{q}}$ and $Z_{\\mathrm{cl}}$ in the limit where the box size $L$ is large compared to the thermal wavelength $\\lambda_T$. This corresponds to the high-temperature or large-volume limit where classical behavior is expected to emerge.\n\nLet's analyze the 1D quantum sum from Part 1:\n$$\nS = \\sum_{n=1}^{\\infty} \\exp(-\\alpha n^2), \\quad \\text{where} \\quad \\alpha = \\frac{\\beta \\pi^2 \\hbar^2}{2mL^2}\n$$\nso that $Z_{\\mathrm{q}} = S^3$. We express $\\alpha$ in terms of $L$ and $\\lambda_T$. Using $\\hbar = h/(2\\pi)$ and $\\beta=1/(k_B T)$:\n$$\n\\alpha = \\frac{1}{k_B T} \\frac{\\pi^2}{2mL^2} \\left(\\frac{h}{2\\pi}\\right)^2 = \\frac{h^2}{8mL^2 k_B T} = \\frac{\\pi}{4} \\frac{2\\pi m k_B T}{h^2} \\frac{h^2}{(2\\pi m k_B T) L^2} = \\frac{\\pi}{4} \\frac{h^2}{2\\pi m k_B T} \\frac{1}{L^2} = \\frac{\\pi}{4}\\left(\\frac{\\lambda_T}{L}\\right)^2\n$$\nThe limit $L \\gg \\lambda_T$ implies that $\\alpha$ is a very small positive parameter, $\\alpha \\ll 1$. In this limit, the sum $S$ can be approximated. A principled method for this is the Poisson summation formula, which for a function $f(x)$ states $\\sum_{n=-\\infty}^{\\infty} f(n) = \\sum_{k=-\\infty}^{\\infty} \\hat{f}(k)$, where $\\hat{f}(k)$ is the Fourier transform of $f(x)$.\n\nLet $f(x) = \\exp(-\\alpha x^2)$. The sum we need is related to $\\sum_{n=-\\infty}^{\\infty} f(n) = f(0) + 2 \\sum_{n=1}^{\\infty} f(n) = 1 + 2S$. The Fourier transform is:\n$$\n\\hat{f}(k) = \\int_{-\\infty}^{\\infty} e^{-\\alpha x^2} e^{-2\\pi i k x} dx = \\sqrt{\\frac{\\pi}{\\alpha}} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right)\n$$\nApplying the Poisson summation formula:\n$$\n1 + 2S = \\sum_{k=-\\infty}^{\\infty} \\sqrt{\\frac{\\pi}{\\alpha}} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right) = \\sqrt{\\frac{\\pi}{\\alpha}} \\left(1 + 2\\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right) \\right)\n$$\nSolving for $S$:\n$$\nS = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} - \\frac{1}{2} + \\sqrt{\\frac{\\pi}{\\alpha}} \\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right)\n$$\nIn the limit $\\alpha \\to 0$, the argument of the exponential in the sum, $-\\pi^2/\\alpha$, becomes very large and negative. The sum is dominated by the $k=1$ term and is of order $\\exp(-\\pi^2/\\alpha)$, which is exponentially small and can be neglected for an asymptotic expansion in powers of $\\sqrt{\\alpha} \\sim \\lambda_T/L$. Therefore, the asymptotic approximation for $S$ is:\n$$\nS \\approx \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} - \\frac{1}{2}\n$$\nNow we substitute the expression for $\\alpha$:\n$$\n\\sqrt{\\frac{\\pi}{\\alpha}} = \\sqrt{\\pi \\cdot \\frac{4L^2}{\\pi\\lambda_T^2}} = \\frac{2L}{\\lambda_T}\n$$\nThis gives the 1D sum approximation:\n$$\nS \\approx \\frac{1}{2}\\left(\\frac{2L}{\\lambda_T}\\right) - \\frac{1}{2} = \\frac{L}{\\lambda_T} - \\frac{1}{2}\n$$\nThe 3D quantum partition function is $Z_{\\mathrm{q}} = S^3$:\n$$\nZ_{\\mathrm{q}} \\approx \\left(\\frac{L}{\\lambda_T} - \\frac{1}{2}\\right)^3\n$$\nWe expand this expression and keep terms up to the first correction in the small parameter $\\lambda_T/L$:\n$$\nZ_{\\mathrm{q}} \\approx \\left(\\frac{L}{\\lambda_T}\\right)^3 - 3\\left(\\frac{L}{\\lambda_T}\\right)^2\\left(\\frac{1}{2}\\right) + 3\\left(\\frac{L}{\\lambda_T}\\right)\\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)^3\n$$\nThe leading term is $(L/\\lambda_T)^3$, which is exactly $Z_{\\mathrm{cl}}$. The first nontrivial correction term is the next term in the expansion:\n$$\nZ_{\\mathrm{q}} \\approx \\left(\\frac{L}{\\lambda_T}\\right)^3 - \\frac{3}{2}\\left(\\frac{L}{\\lambda_T}\\right)^2 = Z_{\\mathrm{cl}} - \\frac{3}{2}\\frac{L^2}{\\lambda_T^2}\n$$\nFinally, we compute the ratio $Z_{\\mathrm{q}}/Z_{\\mathrm{cl}}$:\n$$\n\\frac{Z_{\\mathrm{q}}}{Z_{\\mathrm{cl}}} \\approx \\frac{ (L/\\lambda_T)^3 - \\frac{3}{2}(L/\\lambda_T)^2 }{ (L/\\lambda_T)^3 } = 1 - \\frac{3}{2}\\frac{(L/\\lambda_T)^2}{(L/\\lambda_T)^3} = 1 - \\frac{3}{2}\\frac{\\lambda_T}{L}\n$$\nThe correction term represents the quantum effects due to the finite size of the box and the wave nature of the particle, which are ignored in the purely classical treatment.",
            "answer": "$$\n\\boxed{1 - \\frac{3}{2}\\frac{\\lambda_{T}}{L}}\n$$"
        },
        {
            "introduction": "Moving from idealized models to the real world requires accounting for intermolecular interactions. This final practice applies the principles of the configurational integral, derived from the partition function, to a tangible problem: predicting the behavior of a real gas. You will develop a numerical approach to calculate the second virial coefficient, $B_2$, for a gas whose particles interact via the realistic Lennard-Jones potential . This computational exercise demonstrates how the abstract formalism of statistical mechanics provides concrete, quantitative predictions about the deviations of real gases from ideality, connecting microscopic potentials to macroscopic equations of state.",
            "id": "3764714",
            "problem": "You are tasked with designing and implementing a numerical program, based on first principles, to compute the configurational contribution that determines the second virial coefficient for a classical gas with a pairwise Lennard–Jones interaction and to infer the sign of the second virial coefficient at specified dimensionless temperatures. Start from the canonical ensemble for a classical system in thermal contact with a large reservoir, where the relevant description is the canonical partition function. Use the established construction of the configurational integral and its role in the virial expansion to arrive at a computable one-dimensional integral suitable for numerical quadrature.\n\nThe system consists of identical point particles in three spatial dimensions interacting via a spherically symmetric pairwise Lennard–Jones potential with parameters $\\epsilon$ and $\\sigma$, where the potential energy between two particles separated by distance $r$ is $u(r) = 4 \\epsilon \\left[ \\left( \\dfrac{\\sigma}{r} \\right)^{12} - \\left( \\dfrac{\\sigma}{r} \\right)^{6} \\right]$. Work in reduced, dimensionless units based on $\\epsilon$ and $\\sigma$: define the reduced temperature $T^\\star = \\dfrac{k_B T}{\\epsilon}$, and the reduced distance $x = \\dfrac{r}{\\sigma}$. Express the second virial coefficient in units of $\\sigma^3$ as a dimensionless number $\\dfrac{B_2}{\\sigma^3}$. All physical quantities you compute must be presented in these reduced units.\n\nYour derivation and program must adhere to the following fundamentals:\n- Begin with the canonical partition function for $N$ classical particles, separating kinetic and configurational contributions by integrating out the momenta.\n- Use the definition and properties of the configurational integral and the systematic virial expansion of the pressure in powers of number density to connect the second virial coefficient to an integral over the pair interaction potential.\n- Specialize to a spherically symmetric pair potential and reduce the configurational integral to a single radial integral over the reduced variable $x$ suitable for numerical evaluation. Ensure the integral is absolutely convergent and numerically stable by appropriate treatment of the behavior at $x \\to 0$ and $x \\to \\infty$.\n\nProgram specification:\n- Implement a robust numerical quadrature that evaluates the required improper integral on $x \\in [0, \\infty)$ for the Lennard–Jones $12$–$6$ potential to obtain $\\dfrac{B_2}{\\sigma^3}$ at a given $T^\\star$.\n- Infer the sign of $B_2$ from the computed value at each $T^\\star$; report whether $B_2$ is positive (repulsion-dominated behavior) or non-positive (attraction-dominated or neutral behavior).\n- For numerical output, round each $\\dfrac{B_2}{\\sigma^3}$ value to eight decimal places.\n\nPhysical and numerical units:\n- You must express the second virial coefficient in units of $\\sigma^3$, as a dimensionless quantity $\\dfrac{B_2}{\\sigma^3}$.\n- Temperatures are specified in the reduced unit $T^\\star = \\dfrac{k_B T}{\\epsilon}$, which is dimensionless.\n\nTest suite:\nEvaluate your implementation for the following reduced temperatures $T^\\star$:\n1. $T^\\star = 0.5$ (low temperature, attraction-dominated regime).\n2. $T^\\star = 2.0$ (intermediate temperature).\n3. $T^\\star = 3.42$ (near the Boyle temperature where the second virial coefficient is close to zero for the Lennard–Jones $12$–$6$ potential).\n4. $T^\\star = 4.0$ (above the Boyle temperature).\n5. $T^\\star = 10.0$ (high temperature, repulsion-dominated regime).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The output must be a list of two lists:\n    - The first inner list contains the five computed values of $\\dfrac{B_2}{\\sigma^3}$, each rounded to eight decimal places.\n    - The second inner list contains five boolean values indicating the sign of $B_2$ for the corresponding test cases, using the language’s native boolean literals for true and false.\n- For example, the output format should look like: \"[[b2_case1,b2_case2,b2_case3,b2_case4,b2_case5],[sign1,sign2,sign3,sign4,sign5]]\" where each \"b2_case\" is a float and each \"sign\" is a boolean.\n\nYour program must be self-contained and must not require any external input.",
            "solution": "The problem requires the calculation of the second virial coefficient, $B_2$, for a classical gas whose particles interact via a Lennard-Jones potential. This will be accomplished by starting from the canonical partition function, deriving the expression for $B_2$ in terms of the pair-interaction potential, transforming the expression into dimensionless units suitable for numerical computation, and then evaluating the resulting integral for a given set of dimensionless temperatures.\n\nThe starting point is the canonical partition function, $Z_N$, for a system of $N$ identical, indistinguishable classical particles in a volume $V$ at temperature $T$. It is given by\n$$\nZ_N = \\frac{1}{N! h^{3N}} \\int \\cdots \\int e^{-\\beta H(\\mathbf{q}^N, \\mathbf{p}^N)} d\\mathbf{q}^N d\\mathbf{p}^N\n$$\nwhere $\\beta = (k_B T)^{-1}$ with $k_B$ being the Boltzmann constant, and $h$ is Planck's constant. The Hamiltonian $H(\\mathbf{q}^N, \\mathbf{p}^N)$ is the sum of the kinetic energy $K(\\mathbf{p}^N)$ and the potential energy $U(\\mathbf{q}^N)$:\n$$\nH(\\mathbf{q}^N, \\mathbf{p}^N) = \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m} + U(\\mathbf{q}^N)\n$$\nThe integral over momenta can be performed independently of the positions, yielding:\n$$\n\\int e^{-\\beta K(\\mathbf{p}^N)} d\\mathbf{p}^N = \\left( \\int e^{-\\beta(p_x^2+p_y^2+p_z^2)/(2m)} dp_x dp_y dp_z \\right)^N = \\left( \\frac{2\\pi m}{\\beta} \\right)^{3N/2}\n$$\nThis allows the partition function to be written as:\n$$\nZ_N = \\frac{1}{N! \\Lambda^{3N}} Q_N\n$$\nwhere $\\Lambda = h / \\sqrt{2\\pi m k_B T}$ is the thermal de Broglie wavelength, and $Q_N$ is the configurational integral:\n$$\nQ_N = \\int_V \\cdots \\int_V e^{-\\beta U(\\mathbf{q}^N)} d\\mathbf{q}^1 \\cdots d\\mathbf{q}^N\n$$\nFor a system with pairwise additive interactions, the potential energy is $U(\\mathbf{q}^N) = \\sum_{1 \\le i < j \\le N} u(r_{ij})$, where $u(r_{ij})$ is the potential between particles $i$ and $j$ separated by a distance $r_{ij} = |\\mathbf{q}_i - \\mathbf{q}_j|$.\n\nThe equation of state can be expressed using the virial expansion, which relates the pressure $P$ to a power series in the number density $\\rho = N/V$:\n$$\n\\frac{P}{\\rho k_B T} = 1 + B_2(T) \\rho + B_3(T) \\rho^2 + \\mathcal{O}(\\rho^3)\n$$\nThe second virial coefficient, $B_2(T)$, accounts for the first-order deviation from ideal gas behavior due to pairwise interactions. Statistical mechanics provides a direct link between $B_2(T)$ and the pair potential $u(r)$:\n$$\nB_2(T) = -\\frac{1}{2} \\int (e^{-\\beta u(\\mathbf{r})} - 1) d\\mathbf{r}\n$$\nThe term $e^{-\\beta u(\\mathbf{r})} - 1$ is known as the Mayer $f$-function. For a spherically symmetric potential, $u(\\mathbf{r}) = u(r)$, we can express the volume element $d\\mathbf{r}$ in spherical coordinates as $4\\pi r^2 dr$. The integral becomes one-dimensional:\n$$\nB_2(T) = -2\\pi \\int_0^\\infty (e^{-\\beta u(r)} - 1) r^2 dr\n$$\nThe Lennard-Jones $12$–$6$ potential is given by:\n$$\nu(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]\n$$\nwhere $\\epsilon$ is the depth of the potential well and $\\sigma$ is the finite distance at which the inter-particle potential is zero. To facilitate computation, we transform to dimensionless variables. Let $x = r/\\sigma$ be the reduced distance and $T^\\star = k_B T / \\epsilon$ be the reduced temperature. The exponent $\\beta u(r)$ becomes:\n$$\n\\beta u(r) = \\frac{1}{k_B T} u(r) = \\frac{\\epsilon}{k_B T} \\frac{u(r)}{\\epsilon} = \\frac{1}{T^\\star} \\cdot 4 \\left[ \\left( \\frac{1}{x} \\right)^{12} - \\left( \\frac{1}{x} \\right)^{6} \\right] = \\frac{4}{T^\\star} (x^{-12} - x^{-6})\n$$\nSubstituting $r = x\\sigma$ and $dr = \\sigma dx$ into the integral for $B_2(T)$, we get:\n$$\nB_2(T) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right) (x\\sigma)^2 (\\sigma dx)\n$$\n$$\nB_2(T) = -2\\pi \\sigma^3 \\int_0^\\infty \\left( \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right) x^2 dx\n$$\nThe problem asks for the second virial coefficient in units of $\\sigma^3$, which is the dimensionless quantity $B_2^\\star = B_2(T)/\\sigma^3$:\n$$\nB_2^\\star(T^\\star) = -2\\pi \\int_0^\\infty \\left\\{ \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right\\} x^2 dx\n$$\nThis is the final expression to be numerically evaluated. The definite integral is improper, extending over the interval $[0, \\infty)$. The integrand is well-behaved at both limits. As $x \\to 0$, $u(x) \\to \\infty$, so $\\exp[-\\beta u(x)] \\to 0$, and the integrand behaves as $-x^2$, which is integrable. As $x \\to \\infty$, $u(x) \\to 0$, so $\\exp[-\\beta u(x)] - 1 \\approx -\\beta u(x) \\propto x^{-6}$. The integrand then behaves as $x^{-6} \\cdot x^2 = x^{-4}$, which ensures convergence of the integral at infinity. A numerical quadrature routine designed for improper integrals can robustly compute its value. The sign of $B_2^\\star$ is then determined from the result. A positive value indicates repulsion dominance, while a non-positive value signifies attraction dominance or, at the Boyle temperature, a balance between the two effects.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless second virial coefficient for a Lennard-Jones gas\n    at specified reduced temperatures.\n    \"\"\"\n    \n    # Define the test cases for reduced temperature T* = k_B * T / epsilon.\n    test_cases = [0.5, 2.0, 3.42, 4.0, 10.0]\n\n    b2_results = []\n    sign_results = []\n\n    def integrand(x, t_star):\n        \"\"\"\n        Calculates the integrand for the B2* integral.\n        The integrand is (exp[-u*(x)/t_star] - 1) * x^2,\n        where u*(x) = 4 * (x**-12 - x**-6) is the reduced LJ potential.\n        \n        Args:\n            x (float): The reduced distance r/sigma.\n            t_star (float): The reduced temperature k_B*T/epsilon.\n\n        Returns:\n            float: The value of the integrand.\n        \"\"\"\n        # The limit of the integrand as x -> 0 is 0.\n        # Guard against ZeroDivisionError for x=0.\n        if x == 0.0:\n            return 0.0\n\n        # Calculate the reduced potential energy term in the exponent.\n        # This term can be large for small x, but exp(-large_positive) is 0.\n        potential_term = 4.0 * (x**-12 - x**-6)\n        beta_u = potential_term / t_star\n        \n        # The minimum of the potential is at x = 2^(1/6), where u* = -1.\n        # The maximum value of -beta_u is 4/t_star. For the given test cases,\n        # max value is 4/0.5 = 8. np.exp(8) is well within float64 range.\n        # No overflow is expected.\n        return (np.exp(-beta_u) - 1.0) * x**2\n\n    for t_star_val in test_cases:\n        # Perform numerical quadrature of the integrand from 0 to infinity.\n        # The `args` tuple passes the reduced temperature to the integrand.\n        integral_val, _ = integrate.quad(integrand, 0, np.inf, args=(t_star_val,))\n\n        # Calculate the reduced second virial coefficient B2* = B2 / sigma^3.\n        # B2* = -2 * pi * integral\n        b2_star = -2.0 * np.pi * integral_val\n        \n        # Round the result to eight decimal places as required.\n        b2_rounded = round(b2_star, 8)\n        \n        # Infer the sign: True for positive, False for non-positive.\n        is_positive = b2_rounded > 0.0\n        \n        b2_results.append(b2_rounded)\n        sign_results.append(is_positive)\n\n    # Format the final output string precisely as specified:\n    # \"[[b2_case1,...,b2_case5],[sign1,...,sign5]]\"\n    # where booleans are lowercase 'true' or 'false'.\n    b2_str_list = [f\"{val:.8f}\" for val in b2_results]\n    sign_str_list = [str(val).lower() for val in sign_results]\n    \n    final_output = f\"[[{','.join(b2_str_list)}],[{','.join(sign_str_list)}]]\"\n    \n    # The final print statement must produce only the required output string.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}