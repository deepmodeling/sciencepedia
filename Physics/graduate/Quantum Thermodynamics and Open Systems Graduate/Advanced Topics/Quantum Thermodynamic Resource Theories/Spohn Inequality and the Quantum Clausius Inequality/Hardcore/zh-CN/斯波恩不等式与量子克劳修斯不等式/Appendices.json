{
    "hands_on_practices": [
        {
            "introduction": "为了掌握抽象的原理，最好从一个具体的、可解的例子开始。本练习聚焦于纯退相干过程，这是一个没有能量交换的典型退相干模型。通过直接求解其主方程，你将亲手计算冯·诺伊曼熵随时间的增长率，并将其与幺正通道下的斯普恩不等式联系起来，从而对熵产生获得一个直观而具体的理解。",
            "id": "3784697",
            "problem": "考虑一个单量子比特在时齐 Gorini-Kossakowski-Sudarshan-Lindblad (GKSL) 主方程下演化，该方程由纯退相干生成，其 Lindblad 算符为 $L=\\sqrt{\\Gamma}\\,\\sigma_{z}$，其中 $\\Gamma0$ 且 $\\sigma_{z}$ 是泡利 z 矩阵。初始状态为一个通用的量子比特密度矩阵\n$$\n\\rho_{0}=\\begin{pmatrix}\np  c_{0} \\\\\nc_{0}^{\\ast}  1-p\n\\end{pmatrix},\n$$\n其中 $p\\in[0,1]$ 且 $|c_{0}|\\leq \\sqrt{p(1-p)}$。假设没有哈密顿贡献。从 GKSL 生成元的定义以及冯·诺依曼熵 $S(\\rho)=-\\operatorname{Tr}[\\rho \\ln \\rho]$ 和量子相对熵 $D(\\rho\\Vert\\pi)=\\operatorname{Tr}[\\rho(\\ln \\rho-\\ln \\pi)]$ 的基本性质出发。判断该生成元是否是保单位的，并找出一个与该性质一致的忠实稳态 $\\pi$。然后，通过在矩阵元层面求解主方程，确定密度矩阵的时间依赖性，并计算由非对角元衰减引起的熵产生率 $\\dot{S}(\\rho_{t})$。使用自然对数，将最终的熵率表示为 $p$、$|c_{0}|$、$\\Gamma$ 和 $t$ 的单个闭式解析表达式，并根据 Spohn 不等式和该保单位、无热流动力学的量子克劳修斯不等式来解释结果。\n\n使用自然对数，并以奈特每单位时间为单位表示最终的熵率。无需四舍五入。",
            "solution": "一个马尔可夫开放量子系统的密度矩阵 $\\rho_{t}$ 的演化，其 Gorini-Kossakowski-Sudarshan-Lindblad (GKSL) 形式由下式给出\n$$\n\\frac{d\\rho_{t}}{dt}=\\mathcal{L}(\\rho_{t}),\\qquad \\mathcal{L}(\\rho)=L\\rho L^{\\dagger}-\\frac{1}{2}\\{L^{\\dagger}L,\\rho\\},\n$$\n其中 $\\{A,B\\}=AB+BA$ 表示反对易子。对于纯退相干，其 $L=\\sqrt{\\Gamma}\\,\\sigma_{z}$ 且无哈密顿项，我们有\n$$\nL^{\\dagger}L=\\Gamma\\,\\sigma_{z}^{2}=\\Gamma\\,I,\n$$\n因此生成元为\n$$\n\\mathcal{L}(\\rho)=\\Gamma\\,\\sigma_{z}\\rho\\,\\sigma_{z}-\\frac{\\Gamma}{2}\\{I,\\rho\\}=\\Gamma\\big(\\sigma_{z}\\rho\\,\\sigma_{z}-\\rho\\big).\n$$\n\n首先，我们检查保单位性。如果一个量子动力学映射保持单位算符不变，则它是保单位的。对于该生成元，\n$$\n\\mathcal{L}(I)=\\Gamma\\big(\\sigma_{z}I\\,\\sigma_{z}-I\\big)=\\Gamma\\big(I-I\\big)=0,\n$$\n因此 $I$ 是生成元的一个不动点，该动力学是保单位的。与保单位性一致的一个忠实稳态是该量子比特的最大混合态 $\\pi=\\frac{I}{2}$。确实，$\\mathcal{L}(\\pi)=0$ 且 $\\pi$ 是严格正定的。\n\n接下来，我们在计算基中逐分量求解主方程，在该基中 $\\sigma_{z}=\\operatorname{diag}(1,-1)$ 且\n$$\n\\rho_{t}=\\begin{pmatrix}\n\\rho_{00}(t)  \\rho_{01}(t) \\\\\n\\rho_{10}(t)  \\rho_{11}(t)\n\\end{pmatrix}.\n$$\n用 $\\sigma_{z}$ 进行共轭变换会使非对角元的符号反转，而对角元保持不变：\n$$\n\\sigma_{z}\\rho_{t}\\sigma_{z}=\\begin{pmatrix}\n\\rho_{00}(t)  -\\rho_{01}(t) \\\\\n-\\rho_{10}(t)  \\rho_{11}(t)\n\\end{pmatrix}.\n$$\n因此，\n$$\n\\frac{d\\rho_{t}}{dt}=\\Gamma\\Bigg(\\begin{pmatrix}\n\\rho_{00}(t)  -\\rho_{01}(t) \\\\\n-\\rho_{10}(t)  \\rho_{11}(t)\n\\end{pmatrix}-\\begin{pmatrix}\n\\rho_{00}(t)  \\rho_{01}(t) \\\\\n\\rho_{10}(t)  \\rho_{11}(t)\n\\end{pmatrix}\\Bigg)=\\Gamma\\begin{pmatrix}\n0  -2\\rho_{01}(t) \\\\\n-2\\rho_{10}(t)  0\n\\end{pmatrix}.\n$$\n所以，\n$$\n\\frac{d}{dt}\\rho_{00}(t)=0,\\quad \\frac{d}{dt}\\rho_{11}(t)=0,\\quad \\frac{d}{dt}\\rho_{01}(t)=-2\\Gamma\\,\\rho_{01}(t),\\quad \\frac{d}{dt}\\rho_{10}(t)=-2\\Gamma\\,\\rho_{10}(t).\n$$\n根据初始条件 $\\rho_{0}=\\begin{pmatrix} p  c_{0} \\\\ c_{0}^{\\ast}  1-p \\end{pmatrix}$，解为\n$$\n\\rho_{00}(t)=p,\\quad \\rho_{11}(t)=1-p,\\quad \\rho_{01}(t)=c_{0}\\,\\exp(-2\\Gamma t),\\quad \\rho_{10}(t)=c_{0}^{\\ast}\\,\\exp(-2\\Gamma t).\n$$\n\n现在我们计算冯·诺依曼熵率 $\\dot{S}(\\rho_{t})$。冯·诺依曼熵为 $S(\\rho)=-\\operatorname{Tr}[\\rho\\ln\\rho]$。计算该率的一个便捷途径是使用谱分解。设 $\\lambda_{\\pm}(t)$ 表示 $\\rho_{t}$ 的本征值。对于一个对角元为 $p$ 和 $1-p$，非对角元为 $c(t)=c_{0}\\exp(-2\\Gamma t)$ 的 $2\\times 2$ 厄米矩阵，其本征值为\n$$\n\\lambda_{\\pm}(t)=\\frac{1}{2}\\left(1\\pm \\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}\\right).\n$$\n定义\n$$\nD(t)=(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t).\n$$\n那么\n$$\n\\lambda_{\\pm}(t)=\\frac{1}{2}\\left(1\\pm \\sqrt{D(t)}\\right).\n$$\n对 $D(t)$ 求导得到\n$$\n\\frac{d}{dt}D(t)=4|c_{0}|^{2}\\frac{d}{dt}\\exp(-4\\Gamma t)=-16\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t).\n$$\n根据链式法则，\n$$\n\\dot{\\lambda}_{\\pm}(t)=\\pm \\frac{1}{2}\\cdot \\frac{1}{2\\sqrt{D(t)}}\\,\\dot{D}(t)=\\pm \\frac{\\dot{D}(t)}{4\\sqrt{D(t)}}=\\mp \\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}.\n$$\n\n熵率可以写为\n$$\n\\dot{S}(\\rho_{t})=-\\sum_{k=\\pm}\\dot{\\lambda}_{k}(t)\\,\\ln\\lambda_{k}(t),\n$$\n因为 $\\sum_{k}\\dot{\\lambda}_{k}(t)=\\frac{d}{dt}\\operatorname{Tr}[\\rho_{t}]=0$ 消除了对 $-\\lambda\\ln\\lambda$ 求导时产生的 $-\\sum_{k}\\dot{\\lambda}_{k}(t)$ 贡献。代入 $\\dot{\\lambda}_{\\pm}(t)$ 的表达式，得到\n$$\n\\dot{S}(\\rho_{t})=-\\left(-\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\ln\\lambda_{+}(t)+\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\ln\\lambda_{-}(t)\\right)\n=\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\Big(\\ln\\lambda_{+}(t)-\\ln\\lambda_{-}(t)\\Big).\n$$\n这可以简化为\n$$\n\\dot{S}(\\rho_{t})=\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\,\\ln\\left(\\frac{\\lambda_{+}(t)}{\\lambda_{-}(t)}\\right).\n$$\n使用 $\\lambda_{\\pm}(t)=\\frac{1}{2}(1\\pm \\sqrt{D(t)})$ 得到\n$$\n\\frac{\\lambda_{+}(t)}{\\lambda_{-}(t)}=\\frac{1+\\sqrt{D(t)}}{1-\\sqrt{D(t)}},\n$$\n因此闭式解为\n$$\n\\dot{S}(\\rho_{t})=\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\,\n\\ln\\left(\\frac{1+\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}{1-\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\right).\n$$\n\n根据 Spohn 不等式和量子克劳修斯不等式进行解释：对于具有稳态 $\\pi$ 的 GKSL 生成元，Spohn 不等式表明 $-\\frac{d}{dt}D(\\rho_{t}\\Vert \\pi)\\geq 0$。对于一个保单位的量子比特生成元，其 $\\pi=\\frac{I}{2}$，$\\ln\\pi=-\\ln 2\\,I$，且 $\\operatorname{Tr}[\\dot{\\rho}_{t}\\ln\\pi]=0$，因此 $-\\frac{d}{dt}D(\\rho_{t}\\Vert \\pi)=\\dot{S}(\\rho_{t})\\geq 0$。上面导出的显式表达式确实是非负的，因为 $\\lambda_{+}(t)\\geq \\lambda_{-}(t)$ 意味着 $\\ln(\\lambda_{+}/\\lambda_{-})\\geq 0$，且前置因子是非负的。在物理上，纯退相干是一个无热流过程（没有能量交换），对于保单位动力学，量子克劳修斯不等式简化为熵的单调增加；所得到的 $\\dot{S}(\\rho_{t})$ 以奈特每单位时间为单位量化了这一速率。",
            "answer": "$$\\boxed{\\frac{4\\,\\Gamma\\,|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\,\\ln\\!\\left(\\frac{1+\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}{1-\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\right)}$$"
        },
        {
            "introduction": "上一个练习中的纯退相干过程是一个“保单”动力学过程，其冯·诺伊曼熵是单调不减的。本练习将这一概念推广，要求你推导出一个动力学演化是保单过程的一般性条件。通过对比保单与非保单系统，你将深入理解为何开放系统的熵并非总是增加，这澄清了量子热力学中一个常见的混淆点。",
            "id": "3784762",
            "problem": "考虑一个两能级量子系统（量子比特），其哈密顿量为 $H = \\frac{\\omega}{2}\\,\\sigma_z$（其中 $\\sigma_z$ 是泡利 z 矩阵），该系统在由 Gorini–Kossakowski–Sudarshan–Lindblad (GKSL) 生成元 $\\mathcal{L}$ 产生的时间均匀马尔可夫动力学下演化。其耗散部分由以下跳跃算符指定\n$$\nL_1 = \\sqrt{\\gamma}\\,\\sigma_- = \\sqrt{\\gamma}\\,|0\\rangle\\langle 1|,\\quad\nL_2 = \\sqrt{\\kappa}\\,\\sigma_+ = \\sqrt{\\kappa}\\,|1\\rangle\\langle 0|,\\quad\nL_3 = \\sqrt{\\lambda}\\,\\sigma_z,\n$$\n速率为 $\\gamma,\\kappa,\\lambda\\ge 0$。生成元的作用形式为 $\\dot{\\rho}_t = \\mathcal{L}(\\rho_t)$，具有标准的 GKSL 结构。如果一个量子动力学半群满足 $\\mathcal{L}(I)=0$（其中 $I$ 是单位算符），则称其为保单的 (unital)。利用适用于开放量子系统的基本定义和定律，判断由上述 $L_k$ 定义的半群是否是保单的，并结合 Spohn 不等式和量子克劳修斯不等式，推断其对熵产生和冯·诺依曼熵 $S(\\rho_t)=-\\operatorname{Tr}[\\rho_t\\log\\rho_t]$ 的影响。\n\n下列哪个陈述是正确的？\n\nA. 该半群是保单的当且仅当 $\\gamma=\\kappa$。在这种情况下，对于稳态 $\\sigma=I/2$，Spohn 不等式意味着对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\ge 0$，因此冯·诺依曼熵是单调不减的；如果 $\\gamma\\neq\\kappa$，该半群不是保单的，$S(\\rho_t)$ 可以减小，尽管相对于真实稳态 $\\sigma$ 定义的熵产生率 $-\\frac{d}{dt}D(\\rho_t\\|\\sigma)$ 保持非负。\n\nB. 对于所有的 $\\gamma,\\kappa,\\lambda$，该半群都是保单的，因为 $[H,I]=0$；相应地，Spohn 不等式意味着对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\le 0$。\n\nC. 除非 $\\lambda=0$，否则该半群是非保单的。在保单的情况下（即当 $\\lambda=0$ 时），退相干导致对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\le 0$。\n\nD. 该半群是保单的仅当 $\\gamma=\\kappa=0$；当其为保单的时，冯·诺依曼熵 $S(\\rho_t)$ 随时间守恒，且熵产生恒为零。",
            "solution": "一个量子动力学半群被称为是保单的 (unital)，如果其生成元 $\\mathcal{L}$ 满足 $\\mathcal{L}(I) = 0$，其中 $I$ 是单位算符。对于一个完整的 GKSL 生成元 $\\mathcal{L}(\\rho) = -i[H, \\rho] + \\mathcal{D}(\\rho)$，其中 $\\mathcal{D}(\\rho) = \\sum_k (L_k \\rho L_k^\\dagger - \\frac{1}{2}\\{L_k^\\dagger L_k, \\rho\\})$ 是耗散部分，保单性条件简化为 $\\mathcal{D}(I) = 0$，因为 $[H, I] = 0$。\n\n计算耗散部分在单位算符上的作用：\n$$\n\\mathcal{D}(I) = \\sum_k \\left( L_k I L_k^\\dagger - \\frac{1}{2}\\{L_k^\\dagger L_k, I\\} \\right) = \\sum_k (L_k L_k^\\dagger - L_k^\\dagger L_k) = \\sum_k [L_k, L_k^\\dagger]\n$$\n因此，该半群是保单的当且仅当 $\\sum_k [L_k, L_k^\\dagger] = 0$。\n\n现在我们为给定的跳跃算符计算对易子：\n1.  $L_1 = \\sqrt{\\gamma}\\,|0\\rangle\\langle 1|$: $[L_1, L_1^\\dagger] = \\gamma [|0\\rangle\\langle 1|, |1\\rangle\\langle 0|] = \\gamma (|0\\rangle\\langle 0| - |1\\rangle\\langle 1|) = \\gamma \\sigma_z$\n2.  $L_2 = \\sqrt{\\kappa}\\,|1\\rangle\\langle 0|$: $[L_2, L_2^\\dagger] = \\kappa [|1\\rangle\\langle 0|, |0\\rangle\\langle 1|] = \\kappa (|1\\rangle\\langle 1| - |0\\rangle\\langle 0|) = -\\kappa \\sigma_z$\n3.  $L_3 = \\sqrt{\\lambda}\\,\\sigma_z$: $[L_3, L_3^\\dagger] = \\lambda [\\sigma_z, \\sigma_z] = 0$\n\n将它们相加，保单性条件变为：\n$$\n\\sum_k [L_k, L_k^\\dagger] = \\gamma \\sigma_z - \\kappa \\sigma_z + 0 = (\\gamma - \\kappa)\\sigma_z = 0\n$$\n由于 $\\sigma_z \\neq 0$，这要求 $\\gamma = \\kappa$。这个条件与 $\\lambda$ 和 $\\omega$ 无关。\n\n接下来，我们分析对熵产生的影响：\n- **当 $\\gamma = \\kappa$ (保单情况)**: 动力学是保单的，最大混合态 $\\sigma = I/2$ 是一个稳态 ($\\mathcal{L}(I/2) = 0$)。Spohn 不等式指出，相对熵 $D(\\rho_t \\| \\sigma)$ 随时间不增。对于稳态 $\\sigma=I/2$，相对熵为 $D(\\rho_t \\| I/2) = \\log(2) - S(\\rho_t)$。因此，$\\frac{d}{dt} D(\\rho_t \\| I/2) = -\\frac{d}{dt}S(\\rho_t) \\le 0$，这意味着冯·诺依曼熵是单调不减的：$\\frac{d}{dt}S(\\rho_t) \\ge 0$。\n\n- **当 $\\gamma \\neq \\kappa$ (非保单情况)**: 动力学不是保单的。存在一个唯一的稳态 $\\sigma_{\\text{ss}}$，它通常不是最大混合态。Spohn 不等式 $-\\frac{d}{dt}D(\\rho_t \\| \\sigma_{\\text{ss}}) \\ge 0$ 仍然成立，但这不再直接意味着冯·诺依曼熵的单调性。事实上，如果系统从最大混合态 $\\rho_0 = I/2$ 开始演化，其熵 $S(\\rho_0) = \\log(2)$ 是最大的，它必然会减小以趋向于熵较低的稳态 $S(\\sigma_{\\text{ss}})  \\log(2)$。因此，在这种情况下，$S(\\rho_t)$ 可以减小。\n\n基于此分析，选项 A 是唯一正确的陈述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了基础理论之后，我们将从简单的解析模型转向更真实、更复杂的驱动系统场景。本练习旨在搭建理论与计算之间的桥梁，要求你对一个具有时变哈密顿量的系统进行数值模拟。你将应用绝热和非绝热熵产生这些前沿概念，来分析非平衡驱动过程中的热力学，这对于理解现代量子热力学至关重要。",
            "id": "3784778",
            "problem": "考虑一个双能级量子系统（量子比特），其哈密顿量为 $H_t = \\frac{\\omega(t)}{2}\\sigma_z$，该系统弱耦合到一组由 $\\alpha$ 标记的独立热库，每个热库的逆温度为 $\\beta_\\alpha$。系统的约化态 $\\rho_t$ 在 Gorini–Kossakowski–Lindblad–Sudarshan (GKLS) 生成元的作用下演化，该生成元是各热库特定生成元的总和，并且是马尔可夫的。假设局域细致平衡对每个热库 $\\alpha$ 均成立，因此激发率 $\\gamma_{\\alpha}^{+}(t)$ 和弛豫率 $\\gamma_{\\alpha}^{-}(t)$ 在所有时间 $t$ 均满足 $\\gamma_{\\alpha}^{-}(t)/\\gamma_{\\alpha}^{+}(t) = e^{\\beta_\\alpha \\omega(t)}$。一个满足局域细致平衡的具体参数化是 $\\gamma_{\\alpha}^{+}(t) = k_\\alpha e^{-\\beta_\\alpha \\omega(t)/2}$ 和 $\\gamma_{\\alpha}^{-}(t) = k_\\alpha e^{+\\beta_\\alpha \\omega(t)/2}$，其中 $k_\\alpha0$。\n\n设能量本征态的布居数在所有时间都是对角的，其中 $n(t)$ 是激发态的布居数。布居数动力学由 GKLS 生成元引起的经典速率方程给出：\n$$\n\\frac{dn(t)}{dt} = \\sum_{\\alpha} \\left[ \\gamma_{\\alpha}^{+}(t) \\left(1 - n(t)\\right) - \\gamma_{\\alpha}^{-}(t) n(t) \\right].\n$$\n定义瞬时稳态 $\\pi_t$ 为满足完整生成元瞬时平稳性条件的时间依赖状态，其激发态布居数为\n$$\nn_{\\mathrm{ss}}(t) = \\frac{\\sum_{\\alpha} \\gamma_{\\alpha}^{+}(t)}{\\sum_{\\alpha} \\gamma_{\\alpha}^{+}(t) + \\sum_{\\alpha} \\gamma_{\\alpha}^{-}(t)}.\n$$\n定义流入热库 $\\alpha$ 的热流为\n$$\nJ_\\alpha(t) = - \\operatorname{Tr}\\left[ H_t \\,\\mathcal{L}_{\\alpha,t}(\\rho_t) \\right] = -\\omega(t)\\left[ \\gamma_\\alpha^{+}(t)\\left(1-n(t)\\right) - \\gamma_\\alpha^{-}(t) n(t) \\right],\n$$\n以及流入热库 $\\alpha$ 的管家热流为\n$$\nJ_\\alpha^{\\mathrm{hk}}(t) = - \\operatorname{Tr}\\left[ H_t \\,\\mathcal{L}_{\\alpha,t}(\\pi_t) \\right] = -\\omega(t)\\left[ \\gamma_\\alpha^{+}(t)\\left(1-n_{\\mathrm{ss}}(t)\\right) - \\gamma_\\alpha^{-}(t) n_{\\mathrm{ss}}(t) \\right].\n$$\n设两个激发态布居数分别为 $n$ 和 $m$ 的对角态之间的量子相对熵为\n$$\nD\\left(\\rho\\|\\pi\\right) = n \\ln\\left(\\frac{n}{m}\\right) + \\left(1-n\\right) \\ln\\left(\\frac{1-n}{1-m}\\right).\n$$\n从 GKLS 动力学的 Spohn 不等式和上述定义出发，可以将瞬时熵产生率分解为非绝热和绝热部分，量子克劳修斯不等式断言总熵产生率的非负性。你的任务是：\n- 推导非绝热熵产生率 $\\sigma_{\\mathrm{na}}(t)$（用量子相对熵 $D\\left(\\rho_t\\|\\pi_t\\right)$ 的时间导数表示）和绝热熵产生率 $\\sigma_{\\mathrm{ad}}(t)$（用逆温度 $\\beta_\\alpha$ 和管家热流 $J_\\alpha^{\\mathrm{hk}}(t)$ 表示）的表达式，使得总熵产生率 $\\sigma_{\\mathrm{tot}}(t) = \\sigma_{\\mathrm{na}}(t) + \\sigma_{\\mathrm{ad}}(t)$ 在所有时间都非负。\n- 实现一个数值求解器，模拟上述速率方程下的布居数动力学 $n(t)$，并使用时间导数的有限差分沿均匀时间网格计算 $\\sigma_{\\mathrm{na}}(t)$ 和 $\\sigma_{\\mathrm{ad}}(t)$。使用自然单位制，其中玻尔兹曼常数和普朗克常数均设为 $1$，因此所有量都是无量纲的。\n\n测试组：\n- 情况 A（单热库，驱动频率）：一个热库，$\\beta_1 = 1.5$，耦合 $k_1 = 0.5$，初始激发态布居数 $n(0) = 0.1$，总时间 $T = 2.0$，时间步长 $\\Delta t = 10^{-3}$，且对于 $t\\in[0,T]$，$\\omega(t) = 1.0 + 0.5\\,(t/T)$。\n- 情况 B（双热库，无驱动，初始稳态）：两个热库，$\\beta_1 = 0.5$，$\\beta_2 = 2.0$，耦合 $k_1 = 0.4$，$k_2 = 0.6$，初始 $n(0) = n_{\\mathrm{ss}}(0)$（根据给定参数计算），$T = 1.0$，$\\Delta t = 10^{-3}$，且 $\\omega(t) = 1.0$ 为常数。\n- 情况 C（双热库，正弦驱动）：两个热库，$\\beta_1 = 0.5$，$\\beta_2 = 2.0$，耦合 $k_1 = 0.4$，$k_2 = 0.6$，初始 $n(0) = 0.0$，$T = 1.0$，$\\Delta t = 10^{-3}$，且 $\\omega(t) = 1.0 + 0.2 \\sin\\left(2\\pi t/T\\right)$。\n\n算法要求：\n- 对 $n(t)$ 使用显式欧拉积分。\n- 计算 $n_{\\mathrm{ss}}(t)$、$D\\left(\\rho_t\\|\\pi_t\\right)$，通过 $D$ 的有限差分计算 $\\sigma_{\\mathrm{na}}(t)$，以及从 $J_\\alpha^{\\mathrm{hk}}(t)$ 和 $\\beta_\\alpha$ 计算 $\\sigma_{\\mathrm{ad}}(t)$。\n- 使用非负性容差 $\\varepsilon = 10^{-9}$：如果一个值 $x \\ge -\\varepsilon$，则视其为非负。\n\n输出规格：\n- 对每种情况，通过检查是否所有采样时间的 $\\sigma_{\\mathrm{tot}}(t) \\ge 0$（在容差 $\\varepsilon$ 内）来评估量子克劳修斯不等式是否成立。\n- 此外，对于情况 A（单热库），评估在整个时间网格上 $\\sigma_{\\mathrm{ad}}(t)$ 是否在容差范围内恒等于零。\n- 你的程序应生成一行输出，其中包含四个布尔结果，以逗号分隔的列表形式并用方括号括起来，顺序为 $[\\text{CaseA\\_total\\_nonneg}, \\text{CaseB\\_total\\_nonneg}, \\text{CaseC\\_total\\_nonneg}, \\text{CaseA\\_adiabatic\\_zero}]$。",
            "solution": "该问题要求对一个驱动开放量子系统的熵产生进行理论分解和数值验证。\n\n### 理论框架\n\n问题的核心是将总熵产生率分解为非绝热（non-adiabatic）和绝热（adiabatic）或管家（housekeeping）两个部分。\n\n1.  **绝热熵产生率 $\\sigma_{\\mathrm{ad}}(t)$**: 该项代表维持系统处于瞬时稳态 $\\pi_t$ 所需的熵产生。它与管家热流 $J_\\alpha^{\\mathrm{hk}}(t)$（即系统处于稳态 $\\pi_t$ 时与各热库交换的热流）相关。根据问题定义和标准理论，其表达式为：\n    $$\n    \\sigma_{\\mathrm{ad}}(t) \\equiv \\sum_{\\alpha} \\beta_\\alpha J_\\alpha^{\\mathrm{hk}}(t)\n    $$\n    其中 $J_\\alpha^{\\mathrm{hk}}(t) = - \\omega(t)\\left[ \\gamma_\\alpha^{+}(t)(1-n_{\\mathrm{ss}}(t)) - \\gamma_\\alpha^{-}(t) n_{\\mathrm{ss}}(t) \\right]$。可以证明 $\\sigma_{\\mathrm{ad}}(t) \\ge 0$。特别地，对于单热库系统，瞬时稳态 $\\pi_t$ 是热平衡态，此时 $\\mathcal{L}_{\\alpha,t}(\\pi_t) = 0$，因此 $J_\\alpha^{\\mathrm{hk}}(t) = 0$，从而 $\\sigma_{\\mathrm{ad}}(t) = 0$。\n\n2.  **非绝热熵产生率 $\\sigma_{\\mathrm{na}}(t)$**: 该项量化了系统状态 $\\rho_t$ 偏离瞬时稳态 $\\pi_t$ 导致的熵产生，通常称为“弛豫”贡献。它被定义为系统状态与瞬时稳态之间相对熵的时间变化率的负值：\n    $$\n    \\sigma_{\\mathrm{na}}(t) \\equiv -\\frac{d}{dt}D\\left(\\rho_t\\|\\pi_t\\right)\n    $$\n    这一项不保证为非负，因为当驱动足够快时，系统状态可能暂时更接近于移动的稳态，导致 $D$ 减小而 $\\sigma_{\\mathrm{na}}$ 为负。\n\n3.  **总熵产生率 $\\sigma_{\\mathrm{tot}}(t)$**: 问题中定义的总熵产生率为这两项之和：\n    $$\n    \\sigma_{\\mathrm{tot}}(t) = \\sigma_{\\mathrm{na}}(t) + \\sigma_{\\mathrm{ad}}(t) = -\\frac{d}{dt}D\\left(\\rho_t\\|\\pi_t\\right) + \\sum_{\\alpha} \\beta_\\alpha J_\\alpha^{\\mathrm{hk}}(t)\n    $$\n    一个重要的理论结果（此处作为量子克劳修斯不等式进行检验）是，尽管 $\\sigma_{\\mathrm{na}}(t)$ 可以为负，但总和 $\\sigma_{\\mathrm{tot}}(t)$ 始终是非负的。\n\n### 数值实现方案\n\n我们将遵循问题中给出的算法要求来实现一个 Python 求解器。\n\n1.  **初始化**: 为每个测试用例设置参数，包括 $\\beta_\\alpha$, $k_\\alpha$, $n(0)$, $T$, $\\Delta t$ 和 $\\omega(t)$ 函数。\n2.  **时间演化**: 使用一个循环和显式欧拉方法在时间网格上积分速率方程，得到布居数轨迹 $n(t)$。在每一步中：\n    a.  计算时变的 $\\omega(t_i)$ 和相应的速率 $\\gamma_\\alpha^\\pm(t_i)$。\n    b.  计算瞬时稳态布居数 $n_{\\mathrm{ss}}(t_i)$。\n    c.  应用欧拉步骤更新 $n(t_{i+1}) = n(t_i) + \\Delta t \\cdot \\dot{n}(t_i)$。\n3.  **后处理**: 演化完成后，计算所需的熵产生率：\n    a.  计算整个轨迹的相对熵 $D(\\rho_t\\|\\pi_t)$。\n    b.  使用前向有限差分法计算其导数，得到 $\\sigma_{\\mathrm{na}}(t) = -(D(t_{i+1}) - D(t_i))/\\Delta t$。\n    c.  计算管家热流 $J_\\alpha^{\\mathrm{hk}}(t)$ 并求和得到 $\\sigma_{\\mathrm{ad}}(t)$。\n    d.  将两者相加得到 $\\sigma_{\\mathrm{tot}}(t)$。\n4.  **验证**: 对每个测试用例：\n    a.  检查是否所有计算出的 $\\sigma_{\\mathrm{tot}}(t)$ 值都满足 $\\sigma_{\\mathrm{tot}}(t) \\ge -\\varepsilon$。\n    b.  对于情况 A，额外检查是否所有 $|\\sigma_{\\mathrm{ad}}(t)| \\le \\varepsilon$。\n5.  **输出**: 将四个布尔结果格式化为指定的字符串并打印。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the simulation and result reporting\n    for the three test cases specified in the problem statement.\n    \"\"\"\n\n    # Define a small number to handle logarithms of zero.\n    LOG_EPS = 1e-15\n\n    # Define the tolerance for non-negativity and zero checks.\n    NON_NEG_TOLERANCE = 1e-9\n\n    def xlogy_safe(x, y):\n        \"\"\"\n        Computes x * log(y) safely, returning 0 if x is 0.\n        This is to handle populations n=0 or n=1.\n        \"\"\"\n        if x == 0:\n            return 0\n        # Add a small epsilon to the argument of log to avoid -inf for y=0\n        return x * np.log(y + LOG_EPS)\n\n    def run_case(params):\n        \"\"\"\n        Runs a single simulation case.\n\n        Args:\n            params (dict): A dictionary containing all parameters for the case.\n\n        Returns:\n            tuple: A tuple containing:\n                - (np.ndarray): Array of total entropy production rates sigma_tot.\n                - (np.ndarray): Array of adiabatic entropy production rates sigma_ad.\n        \"\"\"\n        betas = np.array(params['betas'])\n        ks = np.array(params['ks'])\n        n0 = params['n0']\n        T = params['T']\n        dt = params['dt']\n        omega_func = params['omega_func']\n\n        num_steps = int(T / dt)\n        times = np.linspace(0, T, num_steps + 1)\n        \n        # Arrays to store trajectories\n        n_t = np.zeros(num_steps + 1)\n        n_ss_t = np.zeros(num_steps + 1)\n        \n        # Calculate n_ss(0) to determine n(0) for Case B\n        omega_0 = omega_func(0, T)\n        if n0 == 'n_ss_0':\n            gamma_plus_0 = ks * np.exp(-betas * omega_0 / 2)\n            gamma_minus_0 = ks * np.exp(betas * omega_0 / 2)\n            G_plus_0 = np.sum(gamma_plus_0)\n            G_minus_0 = np.sum(gamma_minus_0)\n            n_t[0] = G_plus_0 / (G_plus_0 + G_minus_0)\n        else:\n            n_t[0] = n0\n            \n        # Time evolution using explicit Euler method\n        for i in range(num_steps):\n            t_i = times[i]\n            n_i = n_t[i]\n            \n            omega_i = omega_func(t_i, T)\n            \n            gamma_plus_i = ks * np.exp(-betas * omega_i / 2)\n            gamma_minus_i = ks * np.exp(betas * omega_i / 2)\n\n            G_plus_i = np.sum(gamma_plus_i)\n            G_minus_i = np.sum(gamma_minus_i)\n            \n            # Instantaneous stationary state population\n            if G_plus_i + G_minus_i == 0:\n                 n_ss_t[i] = 0.5 # Avoid division by zero, though unlikely with k>0\n            else:\n                 n_ss_t[i] = G_plus_i / (G_plus_i + G_minus_i)\n            \n            # Euler step\n            dn_dt = G_plus_i * (1 - n_i) - G_minus_i * n_i\n            n_t[i+1] = n_i + dt * dn_dt\n            \n            # Make sure population stays in [0, 1]\n            n_t[i+1] = np.clip(n_t[i+1], 0, 1)\n\n        # Calculate n_ss at the final time point for D calculation\n        omega_T = omega_func(T, T)\n        gamma_plus_T = ks * np.exp(-betas * omega_T / 2)\n        gamma_minus_T = ks * np.exp(betas * omega_T / 2)\n        G_plus_T = np.sum(gamma_plus_T)\n        G_minus_T = np.sum(gamma_minus_T)\n        if G_plus_T + G_minus_T == 0:\n            n_ss_t[-1] = 0.5\n        else:\n            n_ss_t[-1] = G_plus_T / (G_plus_T + G_minus_T)\n\n        # Calculate relative entropy D(t)\n        D_t = np.array([\n            xlogy_safe(n_t[i], n_t[i] / (n_ss_t[i] + LOG_EPS)) + \n            xlogy_safe(1 - n_t[i], (1 - n_t[i]) / (1 - n_ss_t[i] + LOG_EPS))\n            for i in range(num_steps + 1)\n        ])\n        \n        # Calculate sigma_na, sigma_ad, and sigma_tot\n        # These are computed over the interval [0, T-dt]\n        sigma_na = -(D_t[1:] - D_t[:-1]) / dt\n        \n        sigma_ad = np.zeros(num_steps)\n        for i in range(num_steps):\n            t_i = times[i]\n            omega_i = omega_func(t_i, T)\n            n_ss_i = n_ss_t[i]\n            \n            gamma_plus_i = ks * np.exp(-betas * omega_i / 2)\n            gamma_minus_i = ks * np.exp(betas * omega_i / 2)\n            \n            J_hk_alpha = -omega_i * (gamma_plus_i * (1 - n_ss_i) - gamma_minus_i * n_ss_i)\n            sigma_ad[i] = np.sum(betas * J_hk_alpha)\n            \n        sigma_tot = sigma_na + sigma_ad\n        \n        return sigma_tot, sigma_ad\n\n    # --- Test Case Definitions ---\n    \n    # Case A: Single reservoir, driven frequency\n    case_A_params = {\n        'betas': [1.5], 'ks': [0.5], 'n0': 0.1, 'T': 2.0, 'dt': 1e-3,\n        'omega_func': lambda t, T: 1.0 + 0.5 * (t / T)\n    }\n\n    # Case B: Two reservoirs, no driving, stationary initial state\n    case_B_params = {\n        'betas': [0.5, 2.0], 'ks': [0.4, 0.6], 'n0': 'n_ss_0', 'T': 1.0, 'dt': 1e-3,\n        'omega_func': lambda t, T: 1.0\n    }\n\n    # Case C: Two reservoirs, sinusoidal driving\n    case_C_params = {\n        'betas': [0.5, 2.0], 'ks': [0.4, 0.6], 'n0': 0.0, 'T': 1.0, 'dt': 1e-3,\n        'omega_func': lambda t, T: 1.0 + 0.2 * np.sin(2 * np.pi * t / T)\n    }\n\n    # --- Run Simulations and Check Conditions ---\n    results = []\n\n    # Run Case A\n    sigma_tot_A, sigma_ad_A = run_case(case_A_params)\n    results.append(np.all(sigma_tot_A >= -NON_NEG_TOLERANCE))\n\n    # Run Case B\n    sigma_tot_B, _ = run_case(case_B_params)\n    results.append(np.all(sigma_tot_B >= -NON_NEG_TOLERANCE))\n    \n    # Run Case C\n    sigma_tot_C, _ = run_case(case_C_params)\n    results.append(np.all(sigma_tot_C >= -NON_NEG_TOLERANCE))\n    \n    # Adiabatic check for Case A\n    results.append(np.all(np.abs(sigma_ad_A) = NON_NEG_TOLERANCE))\n    \n    # Final print statement\n    print(f\"[{','.join(map(lambda b: str(b).lower(), results))}]\")\n\nsolve()\n```"
        }
    ]
}