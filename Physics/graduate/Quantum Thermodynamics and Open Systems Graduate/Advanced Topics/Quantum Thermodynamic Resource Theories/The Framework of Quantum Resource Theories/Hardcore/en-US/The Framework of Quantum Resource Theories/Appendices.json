{
    "hands_on_practices": [
        {
            "introduction": "At the heart of any resource theory lies a clear definition of what is \"free\" and what is \"resourceful.\" In quantum thermodynamics, the free operations are thermal operations, and the ultimate free state is the Gibbs thermal state. This exercise explores a foundational principle: thermal operations cannot generate resources from a system already in thermal equilibrium. By verifying that a specific map which alters the Gibbs state cannot be a thermal operation, you will gain a concrete understanding of why the Gibbs state serves as the bedrock of this resource theory .",
            "id": "3788027",
            "problem": "Consider a three-level quantum system (the \"system\") with Hamiltonian $H_{S}=\\mathrm{diag}(0,\\epsilon,2\\epsilon)$ coupled to an ideal heat bath (the \"bath\") at inverse temperature $\\beta$ satisfying $\\beta\\epsilon=1$. The bath is described by a Hamiltonian $H_{B}$ and prepared initially in its Gibbs state at the same inverse temperature $\\beta$. The Gibbs state of any system with Hamiltonian $H$ at inverse temperature $\\beta$ is defined as $\\gamma=\\exp(-\\beta H)/Z$, where $Z=\\mathrm{Tr}[\\exp(-\\beta H)]$ is the partition function. A thermal operation (TO) is any quantum channel that can be implemented by coupling the system to the bath initially in the Gibbs state and evolving under a global unitary $U$ that conserves total energy, meaning $[U,H_{S}+H_{B}]=0$, followed by tracing out the bath.\n\nDefine a system-only map $\\Phi$ that permutes the two excited energy levels of the system, sending the projector onto the $\\epsilon$-eigenspace to the projector onto the $2\\epsilon$-eigenspace and vice versa, while leaving the ground state invariant. Starting from the fundamental definitions above, derive the Gibbs state $\\gamma$ of the system and compute the trace distance $D(\\rho,\\sigma)=\\frac{1}{2}\\|\\rho-\\sigma\\|_{1}$, where $\\|\\cdot\\|_{1}$ denotes the trace norm. Use the energy conservation property encoded by $[U,H_{S}+H_{B}]=0$ to argue whether $\\Phi$ can be a thermal operation. Your final reported quantity must be the exact, closed-form value of $D(\\Phi(\\gamma),\\gamma)$, with no rounding. No units are required in the final answer.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and objective.\n\n### Step 1: Extract Givens\n- System: A $3$-level quantum system.\n- System Hamiltonian: $H_{S}=\\mathrm{diag}(0,\\epsilon,2\\epsilon)$.\n- Bath: An ideal heat bath at inverse temperature $\\beta$.\n- Condition: $\\beta\\epsilon=1$.\n- Bath Hamiltonian: $H_{B}$.\n- Initial Bath State: Gibbs state $\\gamma_B$ at inverse temperature $\\beta$.\n- Gibbs State Definition: $\\gamma=\\exp(-\\beta H)/Z$, where $Z=\\mathrm{Tr}[\\exp(-\\beta H)]$.\n- Thermal Operation (TO) Definition: A quantum channel implemented by:\n    1. Coupling the system to the bath (initially in its Gibbs state).\n    2. Evolving the combined system under a global unitary $U$ that conserves total energy, i.e., $[U,H_{S}+H_{B}]=0$.\n    3. Tracing out the bath.\n- System-only map $\\Phi$: Permutes the two excited energy levels, sending the projector onto the $\\epsilon$-eigenspace to the projector onto the $2\\epsilon$-eigenspace and vice-versa, while leaving the ground state invariant.\n- Trace Distance Definition: $D(\\rho,\\sigma)=\\frac{1}{2}\\|\\rho-\\sigma\\|_{1}$, where $\\|\\cdot\\|_{1}$ is the trace norm.\n- Required tasks:\n    1. Derive the system's Gibbs state $\\gamma$.\n    2. Compute $D(\\Phi(\\gamma),\\gamma)$.\n    3. Argue whether $\\Phi$ can be a thermal operation based on the energy conservation property.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined within the standard framework of quantum thermodynamics and the resource theory of athermality. All definitions, such as the Gibbs state and thermal operations, are standard and correct. The Hamiltonians and conditions are physically and mathematically consistent. The tasks are specific and follow logically from the provided definitions. There are no scientific or logical contradictions, no missing information, and no subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe solution proceeds in three parts as requested: deriving the system's Gibbs state $\\gamma$, computing the trace distance $D(\\Phi(\\gamma),\\gamma)$, and analyzing if $\\Phi$ can be a thermal operation.\n\nFirst, we derive the Gibbs state $\\gamma$ of the system. The system Hamiltonian is given in the energy eigenbasis $\\{|0\\rangle, |1\\rangle, |2\\rangle\\}$ as the diagonal matrix $H_{S}=\\mathrm{diag}(E_0, E_1, E_2)$ with eigenvalues $E_0=0$, $E_1=\\epsilon$, and $E_2=2\\epsilon$.\nThe Gibbs state is defined as $\\gamma = \\frac{1}{Z_S}\\exp(-\\beta H_S)$, where $Z_S$ is the partition function.\nWe compute the matrix exponential:\n$$\n\\exp(-\\beta H_S) = \\mathrm{diag}(\\exp(-\\beta E_0), \\exp(-\\beta E_1), \\exp(-\\beta E_2)) = \\mathrm{diag}(\\exp(0), \\exp(-\\beta\\epsilon), \\exp(-2\\beta\\epsilon))\n$$\nUsing the given condition $\\beta\\epsilon=1$, this becomes:\n$$\n\\exp(-\\beta H_S) = \\mathrm{diag}(1, \\exp(-1), \\exp(-2))\n$$\nThe partition function $Z_S$ is the trace of this matrix:\n$$\nZ_S = \\mathrm{Tr}[\\exp(-\\beta H_S)] = 1 + \\exp(-1) + \\exp(-2)\n$$\nTherefore, the Gibbs state of the system is the density matrix:\n$$\n\\gamma = \\frac{1}{1 + e^{-1} + e^{-2}}\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & e^{-1} & 0 \\\\\n0 & 0 & e^{-2}\n\\end{pmatrix}\n$$\nIn terms of projectors onto the energy eigenstates, $\\gamma = p_0|0\\rangle\\langle0| + p_1|1\\rangle\\langle1| + p_2|2\\rangle\\langle2|$, where $p_0 = \\frac{1}{Z_S}$, $p_1 = \\frac{e^{-1}}{Z_S}$, and $p_2 = \\frac{e^{-2}}{Z_S}$.\n\nNext, we compute $D(\\Phi(\\gamma),\\gamma)$. The map $\\Phi$ is defined to permute the excited energy levels, meaning it swaps the corresponding projectors $|1\\rangle\\langle1|$ and $|2\\rangle\\langle2|$, while leaving the ground state projector $|0\\rangle\\langle0|$ unchanged. The action of $\\Phi$ on the Gibbs state $\\gamma$ is:\n$$\n\\Phi(\\gamma) = \\Phi(p_0|0\\rangle\\langle0| + p_1|1\\rangle\\langle1| + p_2|2\\rangle\\langle2|) = p_0\\Phi(|0\\rangle\\langle0|) + p_1\\Phi(|1\\rangle\\langle1|) + p_2\\Phi(|2\\rangle\\langle2|)\n$$\n$$\n\\Phi(\\gamma) = p_0|0\\rangle\\langle0| + p_1|2\\rangle\\langle2| + p_2|1\\rangle\\langle1|\n$$\nThis corresponds to swapping the populations of the first and second excited states. The resulting density matrix is:\n$$\n\\Phi(\\gamma) = \\frac{1}{1 + e^{-1} + e^{-2}}\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & e^{-2} & 0 \\\\\n0 & 0 & e^{-1}\n\\end{pmatrix}\n$$\nNow, we find the difference between $\\Phi(\\gamma)$ and $\\gamma$:\n$$\n\\Phi(\\gamma) - \\gamma = \\frac{1}{Z_S}\n\\left(\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & e^{-2} & 0 \\\\\n0 & 0 & e^{-1}\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & e^{-1} & 0 \\\\\n0 & 0 & e^{-2}\n\\end{pmatrix}\n\\right)\n= \\frac{1}{Z_S}\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & e^{-2} - e^{-1} & 0 \\\\\n0 & 0 & e^{-1} - e^{-2}\n\\end{pmatrix}\n$$\nThe trace distance is $D(\\Phi(\\gamma),\\gamma) = \\frac{1}{2}\\|\\Phi(\\gamma)-\\gamma\\|_{1}$. The trace norm $\\|\\cdot\\|_1$ of a Hermitian matrix is the sum of the absolute values of its eigenvalues. The eigenvalues of $\\Phi(\\gamma) - \\gamma$ are its diagonal entries: $0$, $\\frac{e^{-2}-e^{-1}}{Z_S}$, and $\\frac{e^{-1}-e^{-2}}{Z_S}$.\n$$\n\\|\\Phi(\\gamma)-\\gamma\\|_{1} = \\left|0\\right| + \\frac{|e^{-2} - e^{-1}|}{Z_S} + \\frac{|e^{-1} - e^{-2}|}{Z_S}\n$$\nSince $e>1$, we have $e^{-1} > e^{-2}$, so $e^{-1}-e^{-2} > 0$. The trace norm is:\n$$\n\\|\\Phi(\\gamma)-\\gamma\\|_{1} = \\frac{e^{-1} - e^{-2}}{Z_S} + \\frac{e^{-1} - e^{-2}}{Z_S} = \\frac{2(e^{-1} - e^{-2})}{Z_S}\n$$\nThe trace distance is therefore:\n$$\nD(\\Phi(\\gamma),\\gamma) = \\frac{1}{2} \\frac{2(e^{-1} - e^{-2})}{Z_S} = \\frac{e^{-1} - e^{-2}}{1 + e^{-1} + e^{-2}}\n$$\nTo obtain a cleaner expression, we multiply the numerator and denominator by $e^2$:\n$$\nD(\\Phi(\\gamma),\\gamma) = \\frac{e^2(e^{-1} - e^{-2})}{e^2(1 + e^{-1} + e^{-2})} = \\frac{e - 1}{e^2 + e + 1}\n$$\n\nFinally, we argue whether $\\Phi$ can be a thermal operation. According to the definition, a thermal operation $\\mathcal{E}$ on a system $S$ is of the form $\\mathcal{E}(\\rho_S) = \\mathrm{Tr}_B[U(\\rho_S \\otimes \\gamma_B)U^\\dagger]$, where $\\gamma_B = \\exp(-\\beta H_B)/Z_B$ is the Gibbs state of the bath and the unitary $U$ conserves total energy, $[U, H_S + H_B] = 0$.\n\nA fundamental property of thermal operations is that they must leave the system's own Gibbs state invariant. To show this, consider the action of a thermal operation $\\mathcal{E}$ on the system's Gibbs state $\\gamma = \\exp(-\\beta H_S)/Z_S$. The initial state of the joint system is $\\gamma \\otimes \\gamma_B$. This state can be written as:\n$$\n\\gamma \\otimes \\gamma_B = \\frac{\\exp(-\\beta H_S)}{Z_S} \\otimes \\frac{\\exp(-\\beta H_B)}{Z_B} = \\frac{\\exp(-\\beta(H_S+H_B))}{Z_S Z_B}\n$$\nThis is the Gibbs state for the total system $S+B$. The energy conservation condition $[U, H_S + H_B] = 0$ implies that $U$ commutes with any function of the total Hamiltonian, including the total Gibbs state. Thus, $[U, \\gamma \\otimes \\gamma_B] = 0$.\nThe evolution of the total state is trivial:\n$$\nU(\\gamma \\otimes \\gamma_B)U^\\dagger = U U^\\dagger (\\gamma \\otimes \\gamma_B) = \\gamma \\otimes \\gamma_B\n$$\nTracing out the bath to find the final state of the system yields:\n$$\n\\mathcal{E}(\\gamma) = \\mathrm{Tr}_B[\\gamma \\otimes \\gamma_B] = \\gamma \\cdot \\mathrm{Tr}_B[\\gamma_B] = \\gamma\n$$\nThis proves that the Gibbs state $\\gamma$ must be a fixed point for any thermal operation $\\mathcal{E}$; i.e., $\\mathcal{E}(\\gamma) = \\gamma$.\n\nIn our case, the map is $\\Phi$. We have already calculated $\\gamma$ and $\\Phi(\\gamma)$. We see that $\\Phi(\\gamma) = \\gamma$ if and only if the populations are equal, i.e., $p_1 = p_2$. The populations are $p_1 = e^{-1}/Z_S$ and $p_2 = e^{-2}/Z_S$. Since $e^{-1} \\neq e^{-2}$, we have $p_1 \\neq p_2$, and thus $\\Phi(\\gamma) \\neq \\gamma$.\nThe fact that we calculated a non-zero trace distance, $D(\\Phi(\\gamma),\\gamma) = \\frac{e-1}{e^2+e+1} > 0$, is the quantitative confirmation that $\\Phi(\\gamma) \\neq \\gamma$.\nSince $\\Phi$ does not preserve the Gibbs state, it violates a necessary condition for all thermal operations. Therefore, $\\Phi$ cannot be a thermal operation.",
            "answer": "$$\n\\boxed{\\frac{e - 1}{e^{2} + e + 1}}\n$$"
        },
        {
            "introduction": "Once we understand the fundamental constraints on free operations, we can ask a more powerful question: under what exact conditions can one quantum state be transformed into another via thermal operations? For states diagonal in the energy basis, this question is answered definitively by the thermo-majorization criterion. This practice guides you through the application of this essential tool, using graphical Lorenz curves to develop a geometric intuition for the state-transition rules that govern the quantum thermodynamics of a single qubit .",
            "id": "3788003",
            "problem": "Consider the quantum resource theory of thermodynamics for a single qubit with Hamiltonian $H=\\epsilon |1\\rangle\\langle 1|$, where the ground state $|0\\rangle$ has energy $0$ and the excited state $|1\\rangle$ has energy $\\epsilon>0$. The qubit is coupled to a thermal bath at inverse temperature $\\beta>0$. Thermal operations are defined as Completely Positive Trace-Preserving (CPTP) maps that can be implemented by an energy-preserving unitary acting on the system and bath, where the bath is initially in its Gibbs state.\n\nLet the initial qubit state be $\\rho_1=0.4\\,|1\\rangle\\langle 1|+0.6\\,|0\\rangle\\langle 0|$ and the target state be $\\rho_2=0.3\\,|1\\rangle\\langle 1|+0.7\\,|0\\rangle\\langle 0|$. Using the thermo-majorization criterion for diagonal states in the energy eigenbasis, determine exactly for which values of $\\beta$ and $\\epsilon$ the transition $\\rho_1 \\to \\rho_2$ is achievable by thermal operations. Construct the thermo-majorization Lorenz curves for the two states and derive the necessary and sufficient condition on $\\beta$ and $\\epsilon$ for the transition to be possible.\n\nAnswer specification:\n- Express your final answer as a single closed-form analytic expression that evaluates to $1$ if the transition is achievable and to $0$ otherwise.\n- No rounding is required.\n- Do not include any physical units in the final answer.",
            "solution": "The problem statement is a valid exercise in the quantum resource theory of thermodynamics. It is scientifically grounded, well-posed, and objective. We can proceed with the solution.\n\nThe problem asks for the condition on the inverse temperature $\\beta > 0$ and energy gap $\\epsilon > 0$ for which the state transition $\\rho_1 \\to \\rho_2$ is possible for a single qubit under thermal operations. The qubit Hamiltonian is $H = \\epsilon |1\\rangle\\langle 1|$, with energy eigenvalues $E_0=0$ for state $|0\\rangle$ and $E_1=\\epsilon$ for state $|1\\rangle$.\n\nThe initial and final states are given as:\n$$ \\rho_1 = 0.6 |0\\rangle\\langle 0| + 0.4 |1\\rangle\\langle 1| $$\n$$ \\rho_2 = 0.7 |0\\rangle\\langle 0| + 0.3 |1\\rangle\\langle 1| $$\nThese states are diagonal in the energy eigenbasis. The vector of populations for $\\rho_1$ is $\\vec{p} = (p_0, p_1) = (0.6, 0.4)$, and for $\\rho_2$ is $\\vec{q} = (q_0, q_1) = (0.7, 0.3)$.\n\nThe thermal bath is at inverse temperature $\\beta$. The corresponding Gibbs state is $\\gamma = \\frac{1}{Z} e^{-\\beta H}$, where $Z = \\text{Tr}(e^{-\\beta H})$ is the partition function.\n$$ Z = \\exp(-\\beta E_0) + \\exp(-\\beta E_1) = \\exp(0) + \\exp(-\\beta\\epsilon) = 1 + \\exp(-\\beta\\epsilon) $$\nThe populations of the Gibbs state are:\n$$ g_0 = \\frac{\\exp(-\\beta E_0)}{Z} = \\frac{1}{1 + \\exp(-\\beta\\epsilon)} $$\n$$ g_1 = \\frac{\\exp(-\\beta E_1)}{Z} = \\frac{\\exp(-\\beta\\epsilon)}{1 + \\exp(-\\beta\\epsilon)} $$\n\nFor states diagonal in the energy basis, the transition $\\rho_1 \\to \\rho_2$ is possible under thermal operations if and only if $\\rho_1$ thermo-majorizes $\\rho_2$. This condition is best visualized using thermo-majorization Lorenz curves. The Lorenz curve for a state $\\rho$ with populations $\\vec{p}$ is constructed as follows:\n1. Calculate the ratios $c_i = p_i / g_i$ for each energy level $i$.\n2. Find the permutation $\\pi$ that sorts these ratios in descending order: $c_{\\pi(1)} \\ge c_{\\pi(2)} \\ge \\dots$.\n3. The Lorenz curve is a piecewise linear function connecting the points $(\\sum_{j=1}^k g_{\\pi(j)}, \\sum_{j=1}^k p_{\\pi(j)})$ for $k=0, 1, \\dots, d$, where $d$ is the dimension of the system (here, $d=2$). For $k=0$, the point is $(0,0)$. For $k=d$, the point is $(1,1)$.\n\nThe transition $\\rho_1 \\to \\rho_2$ is possible if and only if the Lorenz curve of $\\rho_1$ lies everywhere above or on the Lorenz curve of $\\rho_2$.\n\nLet's compute the ratios $c_i$ for $\\rho_1$ and $\\rho_2$. Let $x = \\exp(\\beta\\epsilon)$. Since $\\beta>0, \\epsilon>0$, we have $x>1$.\nFor $\\rho_1$:\n$c_0^{(1)} = p_0 / g_0 = 0.6(1 + \\exp(-\\beta\\epsilon)) = 0.6(1+1/x)$\n$c_1^{(1)} = p_1 / g_1 = 0.4 / \\exp(-\\beta\\epsilon) \\cdot (1 + \\exp(-\\beta\\epsilon)) = 0.4x(1+1/x) = 0.4(x+1)$\nThe ordering depends on the comparison of $c_0^{(1)}$ and $c_1^{(1)}$.\n$c_1^{(1)} > c_0^{(1)} \\iff 0.4(x+1) > 0.6(1+1/x) \\iff 0.4x - 0.6/x - 0.2 > 0 \\iff 2x^2 - x - 3 > 0$.\nThe roots of $2x^2 - x - 3 = 0$ are $x = \\frac{1 \\pm \\sqrt{1-4(2)(-3)}}{4} = \\frac{1 \\pm 5}{4}$, which gives $x=1.5$ and $x=-1$. Since $x>1$, the inequality holds for $x > 1.5$.\nSo, for $\\rho_1$, the permutation is $\\pi = (1,0)$ if $x > 1.5$ and $\\pi = (0,1)$ if $1 < x < 1.5$.\n\nFor $\\rho_2$:\n$c_0^{(2)} = q_0 / g_0 = 0.7(1 + 1/x)$\n$c_1^{(2)} = q_1 / g_1 = 0.3(x+1)$\nThe ordering depends on the comparison of $c_0^{(2)}$ and $c_1^{(2)}$.\n$c_1^{(2)} > c_0^{(2)} \\iff 0.3(x+1) > 0.7(1+1/x) \\iff 0.3x - 0.7/x - 0.4 > 0 \\iff 3x^2 - 4x - 7 > 0$.\nThe roots of $3x^2-4x-7=0$ are $x = \\frac{4 \\pm \\sqrt{16-4(3)(-7)}}{6} = \\frac{4 \\pm 10}{6}$, which gives $x=7/3$ and $x=-1$. Since $x>1$, the inequality holds for $x > 7/3$.\nSo, for $\\rho_2$, the permutation is $\\sigma=(1,0)$ if $x > 7/3$ and $\\sigma=(0,1)$ if $1<x<7/3$.\n\nWe analyze the thermo-majorization condition in three regimes for $x = \\exp(\\beta\\epsilon)$:\n\nCase 1: $1 < x < 1.5$.\nIn this regime, $c_0^{(1)} > c_1^{(1)}$ and $c_0^{(2)} > c_1^{(2)}$. So, $\\pi=\\sigma=(0,1)$.\nThe Lorenz curve for $\\rho_1$ is connects $(0,0)$, $(g_0, p_0)$, and $(1,1)$.\nThe Lorenz curve for $\\rho_2$ is connects $(0,0)$, $(g_0, q_0)$, and $(1,1)$.\nSince the \"knee\" points have the same x-coordinate $g_0$, the condition that the curve for $\\rho_1$ is above that for $\\rho_2$ simplifies to $p_0 \\ge q_0$.\n$0.6 \\ge 0.7$ is false. The transition is not possible.\n\nCase 2: $x > 7/3$.\nIn this regime, $c_1^{(1)} > c_0^{(1)}$ and $c_1^{(2)} > c_0^{(2)}$. So, $\\pi=\\sigma=(1,0)$.\nThe Lorenz curve for $\\rho_1$ connects $(0,0)$, $(g_1, p_1)$, and $(1,1)$.\nThe Lorenz curve for $\\rho_2$ connects $(0,0)$, $(g_1, q_1)$, and $(1,1)$.\nThe condition is $p_1 \\ge q_1$.\n$0.4 \\ge 0.3$ is true. The transition is possible.\n\nCase 3: $1.5 \\le x \\le 7/3$.\nIn this regime, $c_1^{(1)} \\ge c_0^{(1)}$ and $c_0^{(2)} \\ge c_1^{(2)}$. So, $\\pi=(1,0)$ and $\\sigma=(0,1)$.\nThe Lorenz curve for $\\rho_1$, denoted $L_1(s)$, connects $(0,0)$, $(g_1, p_1)$, and $(1,1)$.\nThe Lorenz curve for $\\rho_2$, denoted $L_2(s)$, connects $(0,0)$, $(g_0, q_0)$, and $(1,1)$.\nThe condition is $L_1(s) \\ge L_2(s)$ for all $s \\in [0,1]$. Since both are convex functions from $(0,0)$ to $(1,1)$, this is equivalent to checking the condition at the knee points.\n1. The knee of $L_1$ must be above or on $L_2$: $L_2(g_1) \\le p_1$. The point $s=g_1$ is on the first segment of $L_2$ because $g_1 < g_0$ for $x>1$. The equation for this segment is $L_2(s)=(q_0/g_0)s$.\n$ (q_0/g_0)g_1 \\le p_1 \\implies q_0 (g_1/g_0) \\le p_1 \\implies q_0 \\exp(-\\beta\\epsilon) \\le p_1$.\n$ 0.7/x \\le 0.4 \\implies x \\ge 0.7/0.4 = 1.75$.\nSo we need $\\exp(\\beta\\epsilon) \\ge 1.75$.\n\n2. The knee of $L_2$ must be below or on $L_1$: $L_1(g_0) \\ge q_0$. The point $s=g_0$ is on the second segment of $L_1$ because $g_0 > g_1$. The equation for this segment passing through $(g_1, p_1)$ and $(1,1)$ is $y-p_1 = \\frac{1-p_1}{1-g_1}(s-g_1) = \\frac{p_0}{g_0}(s-g_1)$.\nAt $s=g_0$, $L_1(g_0) = p_1 + \\frac{p_0}{g_0}(g_0-g_1) = p_1 + p_0(1-g_1/g_0) = p_1 + p_0(1-\\exp(-\\beta\\epsilon))$.\nThe condition is $p_1 + p_0(1-\\exp(-\\beta\\epsilon)) \\ge q_0$.\n$0.4 + 0.6(1-1/x) \\ge 0.7 \\implies 1 - 0.6/x \\ge 0.7 \\implies 0.3 \\ge 0.6/x \\implies x \\ge 0.6/0.3=2$.\nSo we need $\\exp(\\beta\\epsilon) \\ge 2$.\n\nBoth conditions must hold. The stronger condition is $\\exp(\\beta\\epsilon) \\ge 2$. The interval for this case is $1.5 \\le x \\le 7/3$. Thus, the transition is possible if $2 \\le \\exp(\\beta\\epsilon) \\le 7/3$.\n\nCombining all cases:\n- $1 < \\exp(\\beta\\epsilon) < 2$: Not possible.\n- $2 \\le \\exp(\\beta\\epsilon) \\le 7/3$: Possible.\n- $\\exp(\\beta\\epsilon) > 7/3$: Possible.\n\nThe necessary and sufficient condition for the transition $\\rho_1 \\to \\rho_2$ to be achievable by thermal operations is $\\exp(\\beta\\epsilon) \\ge 2$, which is equivalent to $\\beta\\epsilon \\ge \\ln(2)$.\n\nThe problem asks for a single expression that evaluates to $1$ if this condition holds and $0$ otherwise. This is the definition of the Heaviside step function $\\Theta(z)$, where we define $\\Theta(z)=1$ for $z \\ge 0$ and $\\Theta(z)=0$ for $z < 0$.\nThe expression is therefore $\\Theta(\\beta\\epsilon - \\ln(2))$.",
            "answer": "$$ \\boxed{\\Theta(\\beta\\epsilon - \\ln(2))} $$"
        },
        {
            "introduction": "Knowing whether a state is resourceful is useful, but often we need to know *how much* resource it contains. Resource monotones are functions designed to quantify this value. This final exercise introduces the robustness of athermality, a key resource monotone that measures a state's resilience to being mixed into a free thermal state. You will translate its abstract definition into a practical optimization problem known as a semidefinite program (SDP), bridging the gap between theoretical frameworks and computational practice .",
            "id": "3788020",
            "problem": "Consider a two-level quantum system (qubit) with Hamiltonian $H=\\epsilon \\lvert 1 \\rangle \\langle 1 \\rvert + 0 \\cdot \\lvert 0 \\rangle \\langle 0 \\rvert$, coupled to a thermal bath at inverse temperature $\\beta$. The Gibbs state is $\\gamma = e^{-\\beta H} / Z$ with $Z = \\mathrm{Tr}(e^{-\\beta H})$. In the resource theory of athermality, the robustness of athermality of a state $\\rho$ is defined as the optimal $s \\ge 0$ such that there exists a state $\\sigma$ satisfying $((\\rho + s \\sigma) / (1+s)) = \\gamma$. This is equivalent to the operator inequality $\\rho \\le (1+s)\\gamma$ and defines a semidefinite program (SDP) with the scalar variable $t = 1+s$.\n\nYou must:\n- Derive from first principles how the robustness of athermality $R(\\rho)$ can be computed as the solution to an SDP, starting from the generalized robustness definition and the Gibbs state construction.\n- Specialize to qubits diagonal in the energy eigenbasis, and explicitly solve for the case $\\rho = 0.7 \\lvert 1 \\rangle \\langle 1 \\rvert + 0.3 \\lvert 0 \\rangle \\langle 0 \\rvert$ at $\\beta \\epsilon = 1$.\n- Implement a program that computes $R(\\rho)$ for given test cases, using the general operator-norm expression for the minimal $t$ that satisfies $\\rho \\le t \\gamma$, namely $t = \\lVert \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\rVert_{\\infty}$, and then $R(\\rho) = t - 1$.\n\nDefinitions and constraints:\n- The Gibbs state for the qubit at inverse temperature $\\beta$ is $\\gamma = \\mathrm{diag}(p_0, p_1)$ in the energy eigenbasis, with $p_1 = \\frac{e^{-\\beta \\epsilon}}{1 + e^{-\\beta \\epsilon}}$ and $p_0 = \\frac{1}{1 + e^{-\\beta \\epsilon}}$.\n- The generalized robustness of athermality $R(\\rho)$ is defined as $R(\\rho) = \\min \\{ s \\ge 0 \\mid \\exists \\sigma \\, \\text{such that} \\, (\\rho + s \\sigma)/(1+s) = \\gamma \\}$, equivalently $R(\\rho) = \\min \\{ t - 1 \\mid t \\ge 1, \\, t \\gamma - \\rho \\succeq 0 \\}$, where $\\succeq 0$ denotes positive semidefiniteness.\n- For diagonal $\\rho$ commuting with $\\gamma$, the SDP reduces to scalar inequalities on the diagonal entries.\n\nYour program must compute $R(\\rho)$ for the following test suite (all qubits, expressed in the energy basis):\n- Test 1 (happy path): $\\rho = \\mathrm{diag}(0.3, 0.7)$ with $\\beta \\epsilon = 1$.\n- Test 2 (boundary case): $\\rho = \\gamma$ at $\\beta \\epsilon = 1$.\n- Test 3 (edge case, pure ground state): $\\rho = \\mathrm{diag}(1.0, 0.0)$ with $\\beta \\epsilon = 1$.\n- Test 4 (edge case, pure excited state): $\\rho = \\mathrm{diag}(0.0, 1.0)$ with $\\beta \\epsilon = 1$.\n- Test 5 (coherent state): $\\rho = \\begin{pmatrix} 0.3 & 0.2 \\\\ 0.2 & 0.7 \\end{pmatrix}$ with $\\beta \\epsilon = 1$.\n\nAll quantities are dimensionless. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\"), where each result is the computed $R(\\rho)$ rounded to six decimal places (as decimals).",
            "solution": "The problem asks for a derivation of the semidefinite programming (SDP) formulation for the robustness of athermality $R(\\rho)$, an explicit calculation for a specific case, and a program to compute $R(\\rho)$ for several test cases using a provided operator-norm formula.\n\n### Part 1: Derivation of the SDP Formulation\n\nThe generalized robustness of athermality, $R(\\rho)$, is defined as the minimum $s \\ge 0$ for which there exists a quantum state $\\sigma$ such that the mixture of $\\rho$ with $\\sigma$ results in the Gibbs thermal state $\\gamma$. Mathematically, this is expressed as:\n$$\nR(\\rho) = \\min \\left\\{ s \\ge 0 \\mid \\exists \\sigma \\text{ s.t. } \\frac{\\rho + s \\sigma}{1+s} = \\gamma \\right\\}\n$$\nHere, $\\sigma$ must be a valid density matrix, which imposes two conditions: $\\sigma$ is positive semidefinite ($\\sigma \\succeq 0$) and its trace is unity ($\\mathrm{Tr}(\\sigma) = 1$).\n\nWe start by rearranging the state equality:\n$$\n\\rho + s \\sigma = (1+s) \\gamma\n$$\nIsolating the term with $\\sigma$, we get:\n$$\ns \\sigma = (1+s) \\gamma - \\rho\n$$\nThe problem is to find an $s \\ge 0$ that allows for the existence of such a $\\sigma$.\n\nFirst, consider the trivial case where $s=0$. The equation becomes $\\rho = \\gamma$. If the state $\\rho$ is already the Gibbs state, then its athermality is zero, so $R(\\gamma) = 0$. This is consistent with finding $s=0$.\n\nFor $s > 0$, we can write:\n$$\n\\sigma = \\frac{(1+s)\\gamma - \\rho}{s}\n$$\nThe primary constraint on $\\sigma$ is positive semidefiniteness, $\\sigma \\succeq 0$. Since $s$ is a positive scalar, this is equivalent to the operator inequality:\n$$\n(1+s)\\gamma - \\rho \\succeq 0\n$$\nLet us now check the trace condition, $\\mathrm{Tr}(\\sigma)=1$. Taking the trace of both sides of the rearranged equation:\n$$\n\\mathrm{Tr}(s \\sigma) = \\mathrm{Tr}((1+s) \\gamma - \\rho)\n$$\nUsing the linearity of the trace operator:\n$$\ns \\, \\mathrm{Tr}(\\sigma) = (1+s) \\, \\mathrm{Tr}(\\gamma) - \\mathrm{Tr}(\\rho)\n$$\nSince $\\rho$ and $\\gamma$ are valid density matrices, their traces are both $1$:\n$$\ns \\, \\mathrm{Tr}(\\sigma) = (1+s) \\cdot 1 - 1 = 1+s-1 = s\n$$\nFor $s > 0$, we can divide by $s$ to find $\\mathrm{Tr}(\\sigma) = 1$. This means the trace condition is automatically satisfied as long as a positive semidefinite operator $\\sigma$ can be found. Therefore, the only non-trivial constraint is the positive semidefiniteness of $(1+s)\\gamma - \\rho$.\n\nTo formulate this as a standard optimization problem, we introduce a new variable $t = 1+s$. Since $s \\ge 0$, we have $t \\ge 1$. The inequality becomes:\n$$\nt \\gamma - \\rho \\succeq 0\n$$\nWe seek to minimize $s$, which is equivalent to minimizing $t$. The objective function is $s = t-1$. This leads to the SDP formulation:\n$$\nR(\\rho) = \\min \\{ t-1 \\mid t \\ge 1, \\, t\\gamma - \\rho \\succeq 0 \\}\n$$\nThis is a standard SDP because the objective function $t-1$ is linear in the variable $t$, and the constraint $t\\gamma - \\rho \\succeq 0$ is a linear matrix inequality (LMI).\n\n### Part 2: Explicit Solution for a Specific Case\n\nWe are asked to solve for the state $\\rho = 0.7 \\lvert 1 \\rangle \\langle 1 \\rvert + 0.3 \\lvert 0 \\rangle \\langle 0 \\rvert$ with $\\beta \\epsilon = 1$. In the energy eigenbasis $\\{\\lvert 0 \\rangle, \\lvert 1 \\rangle\\}$, this state is represented by the diagonal matrix:\n$$\n\\rho = \\begin{pmatrix} 0.3 & 0 \\\\ 0 & 0.7 \\end{pmatrix}\n$$\nThe Hamiltonian is $H = \\mathrm{diag}(0, \\epsilon)$. The Gibbs state $\\gamma$ is given by $\\gamma = e^{-\\beta H}/Z$, where $Z = \\mathrm{Tr}(e^{-\\beta H})$.\n$$\nZ = e^{-\\beta \\cdot 0} + e^{-\\beta \\epsilon} = 1 + e^{-\\beta \\epsilon}\n$$\nThe components of $\\gamma = \\mathrm{diag}(p_0, p_1)$ are:\n$$\np_0 = \\frac{1}{Z} = \\frac{1}{1+e^{-\\beta \\epsilon}} \\quad \\text{and} \\quad p_1 = \\frac{e^{-\\beta \\epsilon}}{Z} = \\frac{e^{-\\beta \\epsilon}}{1+e^{-\\beta \\epsilon}}\n$$\nFor $\\beta \\epsilon = 1$:\n$$\np_0 = \\frac{1}{1+e^{-1}} \\approx \\frac{1}{1+0.367879} \\approx 0.731059\n$$\n$$\np_1 = \\frac{e^{-1}}{1+e^{-1}} \\approx \\frac{0.367879}{1+0.367879} \\approx 0.268941\n$$\nThe LMI is $t\\gamma - \\rho \\succeq 0$. Since both $\\rho$ and $\\gamma$ are diagonal, the matrix $t\\gamma-\\rho$ is also diagonal:\n$$\nt\\gamma - \\rho = \\begin{pmatrix} t p_0 - 0.3 & 0 \\\\ 0 & t p_1 - 0.7 \\end{pmatrix}\n$$\nFor this matrix to be positive semidefinite, its diagonal entries (which are its eigenvalues) must be non-negative. This yields two scalar inequalities:\n$$\nt p_0 - 0.3 \\ge 0 \\implies t \\ge \\frac{0.3}{p_0}\n$$\n$$\nt p_1 - 0.7 \\ge 0 \\implies t \\ge \\frac{0.7}{p_1}\n$$\nThe minimal $t$ must satisfy both conditions simultaneously. Therefore, $t$ must be the maximum of the two lower bounds:\n$$\nt = \\max\\left(\\frac{0.3}{p_0}, \\frac{0.7}{p_1}\\right)\n$$\nPlugging in the numerical values:\n$$\nt = \\max\\left(\\frac{0.3}{0.731059}, \\frac{0.7}{0.268941}\\right) \\approx \\max(0.410358, 2.602863) = 2.602863\n$$\nThe robustness of athermality is then $R(\\rho) = t-1$:\n$$\nR(\\rho) \\approx 2.602863 - 1 = 1.602863\n$$\n\n### Part 3: Program Implementation Strategy\n\nThe problem provides the general formula for the minimal $t$ that satisfies the LMI: $t = \\lVert \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\rVert_{\\infty}$, where $\\lVert \\cdot \\rVert_{\\infty}$ is the operator norm (largest singular value, or for a positive semidefinite matrix, the largest eigenvalue).\n\nLet's briefly justify this formula. The Gibbs state $\\gamma$ is diagonal with strictly positive eigenvalues $p_0, p_1 > 0$, so its inverse square root $\\gamma^{-1/2} = \\mathrm{diag}(1/\\sqrt{p_0}, 1/\\sqrt{p_1})$ is well-defined. The LMI $t\\gamma - \\rho \\succeq 0$ can be transformed by congruence with $\\gamma^{-1/2}$ without changing its definiteness:\n$$\n\\gamma^{-1/2} (t\\gamma - \\rho) \\gamma^{-1/2} \\succeq 0\n$$\n$$\nt \\, \\gamma^{-1/2} \\gamma \\gamma^{-1/2} - \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\succeq 0\n$$\n$$\nt I - \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\succeq 0\n$$\nwhere $I$ is the identity matrix. This is equivalent to stating that $t$ must be greater than or equal to all eigenvalues of the Hermitian matrix $A = \\gamma^{-1/2} \\rho \\gamma^{-1/2}$. The smallest such $t$ is therefore the largest eigenvalue of $A$, which is its operator norm $\\lVert A \\rVert_{\\infty}$.\n\nThe program will implement this logic for each test case:\n1.  Given $\\beta \\epsilon$, compute $p_0$ and $p_1$.\n2.  Construct the matrix $\\gamma$ and its inverse square root $\\gamma^{-1/2}$.\n3.  Construct the test case matrix $\\rho$. For test case 2, $\\rho = \\gamma$.\n4.  Compute the matrix $A = \\gamma^{-1/2} \\rho \\gamma^{-1/2}$.\n5.  Find the eigenvalues of the Hermitian matrix $A$ using `numpy.linalg.eigvalsh`.\n6.  The value of $t$ is the maximum eigenvalue.\n7.  The result is $R(\\rho) = t-1$.\n8.  The results for all test cases are collected, formatted to six decimal places, and printed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the robustness of athermality R(rho) for a series of test cases\n    involving a two-level quantum system.\n    \"\"\"\n    \n    # Test cases are tuples of (rho_matrix, beta_epsilon)\n    # A None value for rho_matrix signifies that rho should be set to the Gibbs state.\n    test_cases = [\n        # Test 1: Happy path\n        (np.array([[0.3, 0.0], [0.0, 0.7]], dtype=float), 1.0),\n        # Test 2: Boundary case (rho = gamma)\n        (None, 1.0),\n        # Test 3: Edge case (pure ground state)\n        (np.array([[1.0, 0.0], [0.0, 0.0]], dtype=float), 1.0),\n        # Test 4: Edge case (pure excited state)\n        (np.array([[0.0, 0.0], [0.0, 1.0]], dtype=float), 1.0),\n        # Test 5: Coherent state\n        (np.array([[0.3, 0.2], [0.2, 0.7]], dtype=float), 1.0),\n    ]\n\n    results = []\n    for rho_in, beta_epsilon in test_cases:\n        # Step 1: Calculate the Gibbs state gamma for the given beta_epsilon\n        exp_val = np.exp(-beta_epsilon)\n        partition_function = 1.0 + exp_val\n        p0 = 1.0 / partition_function\n        p1 = exp_val / partition_function\n        \n        gamma = np.diag([p0, p1])\n\n        # Step 2: Set the state rho for the current test case\n        if rho_in is None:\n            # Special case for Test 2 where rho is the Gibbs state\n            rho = gamma\n        else:\n            rho = rho_in\n\n        # Step 3: Compute the minimal t using the operator norm formula\n        # t = ||gamma^(-1/2) * rho * gamma^(-1/2)||_inf\n        \n        # Calculate gamma^(-1/2)\n        # The eigenvalues p0 and p1 are strictly positive for any finite beta_epsilon\n        gamma_inv_sqrt = np.diag([1.0 / np.sqrt(p0), 1.0 / np.sqrt(p1)])\n        \n        # Calculate the matrix A = gamma^(-1/2) * rho * gamma^(-1/2)\n        A = gamma_inv_sqrt @ rho @ gamma_inv_sqrt\n        \n        # The operator norm of a Hermitian matrix is its largest absolute eigenvalue.\n        # Since rho is positive semidefinite, A is also positive semidefinite,\n        # so its eigenvalues are non-negative. Thus, the norm is the max eigenvalue.\n        # np.linalg.eigvalsh is efficient for Hermitian matrices.\n        eigenvalues = np.linalg.eigvalsh(A)\n        t = np.max(eigenvalues)\n        \n        # Step 4: Calculate the robustness of athermality R(rho) = t - 1\n        robustness = t - 1\n        results.append(robustness)\n\n    # Format the results to six decimal places and print in the required format\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}