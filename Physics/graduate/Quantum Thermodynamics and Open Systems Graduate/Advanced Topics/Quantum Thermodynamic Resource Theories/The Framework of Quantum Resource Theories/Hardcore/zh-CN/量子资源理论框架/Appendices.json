{
    "hands_on_practices": [
        {
            "introduction": "在任何资源理论中，首要任务是区分“自由”态和“资源”态。资源检验子是一种实验上可行的工具，用于识别一个量子态是否含有特定资源。本练习将指导您为量子相干性资源理论构建一个检验子，通过构建一个能够“感知”到量子叠加存在的特定可观测量，来加深对资源探测的理解。",
            "id": "3788049",
            "problem": "考虑单量子比特的量子相干性资源理论，其参考标准正交基为固定的 $\\{|0\\rangle,|1\\rangle\\}$。自由态集合由在该基中对角的所有密度算符组成，而典型的自由操作是完全退相干映射 $\\Delta$，定义为 $\\Delta(\\rho)=\\sum_{i=0}^{1}|i\\rangle\\langle i|\\rho|i\\rangle\\langle i|$，它会移除计算基中的所有非对角项。\n\n相干性的资源见证是一个厄米算符 $W$，它满足以下两个性质：(i) 对于所有自由（对角）态 $\\rho$，有 $\\mathrm{Tr}[W\\rho]\\ge 0$；(ii) 至少存在一个资源（相干）态 $\\sigma$，使得 $\\mathrm{Tr}[W\\sigma]  0$。\n\n仅从这些定义和退相干映射的结构出发，推导一个通用的量子比特厄米算符 $W$ 的矩阵元所需满足的约束条件，以确保对于所有量子比特密度算符 $\\rho$ 都有 $\\mathrm{Tr}[W\\Delta(\\rho)]\\ge 0$。利用这些约束条件，显式地构造一个非平凡的厄米算符 $W$，它能够检测相干性，即它在某个相干纯态上的值为严格负数。将你最终的 $W$ 显式地表示为计算基下的一个 $2\\times 2$ 矩阵。不需要进行数值取整。",
            "solution": "此问题要求推导一个厄米算符 $W$ 作为相干性见证所需满足的约束条件，并为单量子比特系统显式构造这样一个见证。\n\n一个单量子比特的通用厄米算符在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 下可以写作：\n$$\nW = \\begin{pmatrix} w_{00}  w_{01} \\\\ w_{10}  w_{11} \\end{pmatrix}\n$$\n其中 $w_{00}, w_{11} \\in \\mathbb{R}$ 且 $w_{10} = w_{01}^*$，这是由厄米性条件 $W = W^\\dagger$ 决定的。\n\n问题指出，见证 $W$ 必须对任意量子比特密度算符 $\\rho$ 满足 $\\mathrm{Tr}[W\\Delta(\\rho)] \\ge 0$。我们首先分析退相干映射 $\\Delta$ 的作用。对于一个通用的密度算符 $\\rho$：\n$$\n\\rho = \\begin{pmatrix} \\rho_{00}  \\rho_{01} \\\\ \\rho_{10}  \\rho_{11} \\end{pmatrix}\n$$\n退相干映射 $\\Delta$ 定义为 $\\Delta(\\rho) = \\sum_{i=0}^{1}|i\\rangle\\langle i|\\rho|i\\rangle\\langle i|$。可以计算如下：\n$$\n\\Delta(\\rho) = |0\\rangle\\langle 0| \\rho |0\\rangle\\langle 0| + |1\\rangle\\langle 1| \\rho |1\\rangle\\langle 1| = \\rho_{00}|0\\rangle\\langle 0| + \\rho_{11}|1\\rangle\\langle 1|\n$$\n其矩阵形式为：\n$$\n\\Delta(\\rho) = \\begin{pmatrix} \\rho_{00}  0 \\\\ 0  \\rho_{11} \\end{pmatrix}\n$$\n现在，我们来评估迹条件：\n$$\n\\mathrm{Tr}[W\\Delta(\\rho)] = \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00}  w_{01} \\\\ w_{10}  w_{11} \\end{pmatrix} \\begin{pmatrix} \\rho_{00}  0 \\\\ 0  \\rho_{11} \\end{pmatrix} \\right] = \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00}\\rho_{00}  w_{01}\\rho_{11} \\\\ w_{10}\\rho_{00}  w_{11}\\rho_{11} \\end{pmatrix} \\right]\n$$\n$$\n\\mathrm{Tr}[W\\Delta(\\rho)] = w_{00}\\rho_{00} + w_{11}\\rho_{11}\n$$\n这个不等式 $w_{00}\\rho_{00} + w_{11}\\rho_{11} \\ge 0$ 必须对任何有效密度矩阵 $\\rho$ 的对角元成立。密度矩阵的对角元满足 $\\rho_{00} \\ge 0$，$\\rho_{11} \\ge 0$ 和 $\\mathrm{Tr}(\\rho) = \\rho_{00}+\\rho_{11} = 1$。\n\n令 $\\rho_{00} = p$，这意味着 $\\rho_{11} = 1-p$，其中 $p \\in [0, 1]$。该条件变为 $w_{00}p + w_{11}(1-p) \\ge 0$ 对所有 $p \\in [0, 1]$ 成立。这是一个关于 $p$ 的线性函数。要使其在该区间上为非负，它必须在区间的两个端点上为非负。\n- 当 $p=1$ 时（对应于态 $\\rho=|0\\rangle\\langle 0|$），我们必须有 $w_{00}(1) + w_{11}(0) \\ge 0$，这意味着 $w_{00} \\ge 0$。\n- 当 $p=0$ 时（对应于态 $\\rho=|1\\rangle\\langle 1|$），我们必须有 $w_{00}(0) + w_{11}(1) \\ge 0_，这意味着 $w_{11} \\ge 0$。\n\n因此，相干性见证的第一个性质施加了约束，即 $W$ 的对角元必须为非负：\n$$\nw_{00} \\ge 0 \\quad \\text{and} \\quad w_{11} \\ge 0\n$$\n非对角元 $w_{01}$ 和 $w_{10}$ 不受此性质的约束。\n\n接下来，我们必须使用第二个性质来构造一个非平凡的见证。一个非平凡的见证是指它不是一个半正定算符，这意味着它必须至少有一个负本征值。\n\n我们选择一个最大相干纯态，例如 $|\\psi\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。其对应的密度矩阵为 $\\sigma = |\\psi\\rangle\\langle\\psi|$：\n$$\n\\sigma = \\frac{1}{2} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n现在我们计算 $\\mathrm{Tr}[W\\sigma]$：\n$$\n\\mathrm{Tr}[W\\sigma] = \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00}  w_{01} \\\\ w_{10}  w_{11} \\end{pmatrix} \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} \\right] = \\frac{1}{2} \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00}+w_{01}  w_{00}+w_{01} \\\\ w_{10}+w_{11}  w_{10}+w_{11} \\end{pmatrix} \\right]\n$$\n$$\n\\mathrm{Tr}[W\\sigma] = \\frac{1}{2}(w_{00}+w_{01} + w_{10}+w_{11})\n$$\n由于 $w_{10} = w_{01}^*$，我们有 $w_{01} + w_{10} = w_{01} + w_{01}^* = 2\\mathrm{Re}(w_{01})$。因此，条件是：\n$$\n\\frac{1}{2}(w_{00} + w_{11} + 2\\mathrm{Re}(w_{01}))  0 \\implies w_{00} + w_{11} + 2\\mathrm{Re}(w_{01})  0\n$$\n为了构造一个见证 $W$，我们需要为其矩阵元选择满足所有约束条件的值：\n1. $W$ 是厄米算符 ($w_{10}=w_{01}^*$)。\n2. $w_{00} \\ge 0, w_{11} \\ge 0$。\n3. $w_{00} + w_{11} + 2\\mathrm{Re}(w_{01})  0$。\n\n我们来做一个简单的选择。为了满足第三个不等式，$\\mathrm{Re}(w_{01})$ 必须为负且其绝对值足够大。我们选择 $w_{01}$ 为一个负实数，例如，$w_{01} = -1$。\n由于 $w_{01}$ 是实数，所以 $w_{10} = w_{01} = -1$。因此 $\\mathrm{Re}(w_{01}) = -1$。\n不等式变为 $w_{00} + w_{11} - 2  0$，即 $w_{00} + w_{11}  2$。\n我们可以用多种选择来满足这个条件以及 $w_{00} \\ge 0, w_{11} \\ge 0$。一个特别简单的选择是 $w_{00} = 0$ 和 $w_{11} = 0$。这得到 $0+0  2$，成立。\n\n这组选择导出了以下的见证算符：\n$$\nW = \\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix}\n$$\n这是泡利X矩阵的负值，$W = -\\sigma_x$。\n\n我们来验证这个算符 $W$：\n- 它是厄米的，因为它是一个实对称矩阵。\n- 它的对角元是 $w_{00}=0$ 和 $w_{11}=0$，它们是非负的。这确保了对任何态 $\\rho$，都有 $\\mathrm{Tr}[W\\Delta(\\rho)] = 0 \\ge 0$。\n- 对于相干态 $\\sigma = \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$，我们有：\n  $$\n  \\mathrm{Tr}[W\\sigma] = \\mathrm{Tr}\\left[ \\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix} \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} \\right] = \\frac{1}{2} \\mathrm{Tr}\\left[ \\begin{pmatrix} -1  -1 \\\\ -1  -1 \\end{pmatrix} \\right] = \\frac{1}{2}(-1-1) = -1\n  $$\n由于 $\\mathrm{Tr}[W\\sigma] = -1  0$，该算符成功地检测出态 $\\sigma$ 中的相干性。这个 $W$ 的本征值为 $\\pm 1$，负本征值证实了它是一个非平凡的见证。因此，这是一个有效的构造。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一旦我们识别出资源，下一个问题就是我们能用它做什么。在资源理论的框架下，自由操作决定了允许的状态转换。本练习将引导您应用热力学资源理论中的一个核心工具——热主序化判据，来精确判断在热操作下，一个量子比特能否从一个非平衡态转变为另一个。",
            "id": "3788003",
            "problem": "考虑单个量子比特的热力学量子资源理论，其哈密顿量为 $H=\\epsilon |1\\rangle\\langle 1|$，其中基态 $|0\\rangle$ 的能量为 $0$，激发态 $|1\\rangle$ 的能量为 $\\epsilon0$。该量子比特与一个逆温度为 $\\beta0$ 的热浴耦合。热操作被定义为完全正定保迹 (CPTP) 映射，它可以通过作用于系统和热浴的保能幺正变换来实现，其中热浴初始处于其吉布斯态。\n\n设初始量子比特态为 $\\rho_1=0.4\\,|1\\rangle\\langle 1|+0.6\\,|0\\rangle\\langle 0|$，目标态为 $\\rho_2=0.3\\,|1\\rangle\\langle 1|+0.7\\,|0\\rangle\\langle 0|$。使用能量本征基中对角态的热主序化判据，精确确定对于哪些 $\\beta$ 和 $\\epsilon$ 的值，跃迁 $\\rho_1 \\to \\rho_2$ 可以通过热操作实现。构造这两个态的热主序化洛伦兹曲线，并推导使该跃迁成为可能的关于 $\\beta$ 和 $\\epsilon$ 的充要条件。\n\n答案规格：\n- 将最终答案表示为一个单一的闭式解析表达式，如果跃迁可实现，则该表达式的值为 $1$，否则为 $0$。\n- 无需四舍五入。\n- 最终答案中不要包含任何物理单位。",
            "solution": "该问题要求找到使得在热操作下态的跃迁 $\\rho_1 \\to \\rho_2$ 成为可能的逆温度 $\\beta > 0$ 和能隙 $\\epsilon > 0$ 所满足的条件。系统的哈密顿量为 $H = \\epsilon |1\\rangle\\langle 1|$，能量本征值为 $E_0=0$ 和 $E_1=\\epsilon$。\n\n给定的初态和末态在能量本征基中是对角的，其布居数向量分别为：\n$\\vec{p} = (p_0, p_1) = (0.6, 0.4)$\n$\\vec{q} = (q_0, q_1) = (0.7, 0.3)$\n\n对于在能量本征基中对角的态，从 $\\vec{p}$ 到 $\\vec{q}$ 的跃迁可以通过热操作实现的充要条件是，存在一个吉布斯保持（Gibbs-preserving）的随机矩阵 $M$ 使得 $\\vec{q} = M\\vec{p}$。对于一个量子比特，该随机矩阵 $M$ 可以写为：\n$$\nM = \\begin{pmatrix} 1-a  b \\\\ a  1-b \\end{pmatrix}\n$$\n其中 $a,b \\in [0,1]$。吉布斯保持条件 $M\\vec{g} = \\vec{g}$ 意味着 $a g_0 = b g_1$，其中 $\\vec{g}=(g_0, g_1)$ 是吉布斯态的布居数向量。吉布斯分布为 $g_0 = \\frac{1}{1+e^{-\\beta\\epsilon}}$ 和 $g_1 = \\frac{e^{-\\beta\\epsilon}}{1+e^{-\\beta\\epsilon}}$。\n令 $x = e^{\\beta\\epsilon}$。由于 $\\beta>0, \\epsilon>0$，我们有 $x > 1$。吉布斯保持条件变为 $b = a (g_0/g_1) = a e^{\\beta\\epsilon} = ax$。\n\n矩阵 $M$ 的元素必须是概率，因此我们需要找到一个 $a$ 满足以下约束：\n1. $a \\ge 0$\n2. $b = ax \\ge 0$ (当 $a \\ge 0, x > 1$ 时自动满足)\n3. $a \\le 1$\n4. $b = ax \\le 1 \\implies a \\le 1/x$\n综合起来，我们需要找到一个 $a$ 满足 $0 \\le a \\le 1/x$。\n\n现在我们应用跃迁条件 $\\vec{q} = M\\vec{p}$ 的第一个分量：\n$$ q_0 = (1-a)p_0 + b p_1 = (1-a)p_0 + (ax)p_1 $$\n代入数值：\n$$ 0.7 = (1-a)0.6 + (ax)0.4 $$\n$$ 0.7 = 0.6 - 0.6a + 0.4ax $$\n$$ 0.1 = a(0.4x - 0.6) $$\n如果 $0.4x - 0.6 = 0$ (即 $x=1.5$)，则方程变为 $0.1=0$，无解。因此 $x \\ne 1.5$。我们可以解出 $a$：\n$$ a = \\frac{0.1}{0.4x - 0.6} $$\n现在我们将此表达式代入约束条件 $0 \\le a \\le 1/x$ 中。\n\n1.  **$a \\ge 0$**: 由于分子 $0.1 > 0$，这要求分母也为正，即 $0.4x - 0.6 > 0 \\implies 0.4x > 0.6 \\implies x > 1.5$。\n2.  **$a \\le 1/x$**:\n    $$ \\frac{0.1}{0.4x - 0.6} \\le \\frac{1}{x} $$\n    由于我们已经确定 $x > 1.5$，分母为正，我们可以交叉相乘而不改变不等号方向：\n    $$ 0.1x \\le 0.4x - 0.6 $$\n    $$ 0.6 \\le 0.3x $$\n    $$ x \\ge \\frac{0.6}{0.3} \\implies x \\ge 2 $$\n\n为了使跃迁成为可能，必须同时满足 $x > 1.5$ 和 $x \\ge 2$。因此，充要条件是 $x \\ge 2$。\n将 $x = e^{\\beta\\epsilon}$ 代回，我们得到最终条件：\n$$ e^{\\beta\\epsilon} \\ge 2 \\implies \\beta\\epsilon \\ge \\ln(2) $$\n该跃迁是可能的当且仅当 $\\beta\\epsilon \\ge \\ln(2)$。使用Heaviside阶跃函数 $\\Theta(z)$（当 $z \\ge 0$ 时为1，否则为0），该条件可以表示为 $\\Theta(\\beta\\epsilon - \\ln(2)) = 1$。",
            "answer": "$$ \\boxed{\\Theta(\\beta\\epsilon - \\ln(2))} $$"
        },
        {
            "introduction": "并非所有资源态都是平等的；有些态比其他态含有更多的资源。为了量化这种差异，我们使用资源单调函数。本练习将介绍“非热鲁棒性”这一资源度量，它衡量了一个态偏离热平衡的程度，并展示了如何将其计算过程构建为一个半正定规划问题。",
            "id": "3788020",
            "problem": "考虑一个两能级量子系统（量子比特），其哈密顿量为 $H=\\epsilon \\lvert 1 \\rangle \\langle 1 \\rvert + 0 \\cdot \\lvert 0 \\rangle \\langle 0 \\rvert$，该系统与一个逆温度为 $\\beta$ 的热浴耦合。吉布斯态为 $\\gamma = e^{-\\beta H} / Z$，其中 $Z = \\mathrm{Tr}(e^{-\\beta H})$。在量子资源理论的框架下，一个态 $\\rho$ 相对于与吉布斯态混合的非热鲁棒性（robustness of athermality）被定义为相对于吉布斯态自由集的广义鲁棒性。具体来说，广义鲁棒性是最优的 $s \\ge 0$，使得存在一个态 $\\sigma$ 满足 $((\\rho + s \\sigma) / (1+s)) = \\gamma$。这等价于算符不等式 $\\rho \\le (1+s)\\gamma$，并定义了一个以标量 $t = 1+s$ 为变量的半定规划（SDP; Semidefinite Programming）问题。此推导的基础包括吉布斯态的定义、资源理论中自由态的凸结构，以及算符序 $A \\le B$ 意味着 $B-A$ 是半正定的。\n\n你必须：\n- 从第一性原理出发，推导如何从广义鲁棒性的定义和吉布斯态的构造开始，将非热鲁棒性 $R(\\rho)$ 作为 SDP 的解来计算。\n- 将问题特殊化到在能量本征基中对角化的量子比特，并显式求解 $\\rho = 0.7 \\lvert 1 \\rangle \\langle 1 \\rvert + 0.3 \\lvert 0 \\rangle \\langle 0 \\rvert$ 在 $\\beta \\epsilon = 1$ 时的情形。\n- 实现一个程序，使用满足 $\\rho \\le t \\gamma$ 的最小 $t$ 的通用算符范数表达式，即 $t = \\lVert \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\rVert_{\\infty}$，然后计算 $R(\\rho) = t - 1$，从而计算给定测试用例的 $R(\\rho)$。\n- 仅使用标准数学定义，避免任何假定目标公式的领域特定捷径。\n\n定义和约束：\n- 在能量本征基中，逆温度为 $\\beta$ 的量子比特的吉布斯态为 $\\gamma = \\mathrm{diag}(p_0, p_1)$，其中 $p_1 = \\frac{e^{-\\beta \\epsilon}}{1 + e^{-\\beta \\epsilon}}$ 且 $p_0 = \\frac{1}{1 + e^{-\\beta \\epsilon}}$。\n- 广义非热鲁棒性 $R(\\rho)$ 定义为 $R(\\rho) = \\min \\{ s \\ge 0 \\mid \\exists \\sigma \\, \\text{such that} \\, (\\rho + s \\sigma)/(1+s) = \\gamma \\}$，等价于 $R(\\rho) = \\min \\{ t - 1 \\mid t \\ge 1, \\, t \\gamma - \\rho \\succeq 0 \\}$，其中 $\\succeq 0$ 表示半正定。\n- 对于与 $\\gamma$ 对易的对角矩阵 $\\rho$，SDP 简化为关于对角元素的标量不等式。\n\n你的程序必须为以下测试套件计算 $R(\\rho)$（所有量子比特均在能量基中表示）：\n- 测试 1 (正常情况): $\\rho = \\mathrm{diag}(0.3, 0.7)$，$\\beta \\epsilon = 1$。\n- 测试 2 (边界情况): $\\rho = \\gamma$，$\\beta \\epsilon = 1$。\n- 测试 3 (边缘情况，纯基态): $\\rho = \\mathrm{diag}(1.0, 0.0)$，$\\beta \\epsilon = 1$。\n- 测试 4 (边缘情况，纯激发态): $\\rho = \\mathrm{diag}(0.0, 1.0)$，$\\beta \\epsilon = 1$。\n- 测试 5 (相干态): $\\rho = \\begin{pmatrix} 0.3  0.2 \\\\ 0.2  0.7 \\end{pmatrix}$，$\\beta \\epsilon = 1$。\n\n所有量均为无量纲。你的程序必须生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,...]”），其中每个结果是计算出的 $R(\\rho)$ 值，四舍五入到六位小数（以十进制表示）。",
            "solution": "题目要求推导非热鲁棒性 $R(\\rho)$ 的半定规划（SDP）公式，对一个特定案例进行显式计算，并编写一个程序，使用提供的算符范数公式为几个测试用例计算 $R(\\rho)$。\n\n### 第一部分：SDP 公式推导\n\n广义非热鲁棒性 $R(\\rho)$ 定义为：存在一个量子态 $\\sigma$，使得 $\\rho$ 与 $\\sigma$ 的混合产生吉布斯热态 $\\gamma$ 的最小非负数 $s$。用数学语言表示为：\n$$\nR(\\rho) = \\min \\left\\{ s \\ge 0 \\mid \\exists \\sigma \\text{ s.t. } \\frac{\\rho + s \\sigma}{1+s} = \\gamma \\right\\}\n$$\n在这里，$\\sigma$ 必须是一个有效的密度矩阵，这带来了两个条件：$\\sigma$ 是半正定的（$\\sigma \\succeq 0$）且其迹为 1（$\\mathrm{Tr}(\\sigma) = 1$）。\n\n我们首先对状态等式进行变形：\n$$\n\\rho + s \\sigma = (1+s) \\gamma\n$$\n分离出含 $\\sigma$ 的项，我们得到：\n$$\ns \\sigma = (1+s) \\gamma - \\rho\n$$\n问题在于找到一个 $s \\ge 0$，使得这样的 $\\sigma$ 存在。\n\n首先，考虑 $s=0$ 的平凡情况。方程变为 $\\rho = \\gamma$。如果态 $\\rho$ 本身就是吉布斯态，那么它的非热性为零，即 $R(\\gamma) = 0$。这与找到 $s=0$ 的结果是一致的。\n\n对于 $s > 0$，我们可以写出：\n$$\n\\sigma = \\frac{(1+s)\\gamma - \\rho}{s}\n$$\n对 $\\sigma$ 的主要约束是半正定性，即 $\\sigma \\succeq 0$。由于 $s$ 是一个正标量，这等价于算符不等式：\n$$\n(1+s)\\gamma - \\rho \\succeq 0\n$$\n现在我们来检查迹条件 $\\mathrm{Tr}(\\sigma)=1$。对变形后的方程两边取迹：\n$$\n\\mathrm{Tr}(s \\sigma) = \\mathrm{Tr}((1+s) \\gamma - \\rho)\n$$\n利用迹算符的线性性质：\n$$\ns \\, \\mathrm{Tr}(\\sigma) = (1+s) \\, \\mathrm{Tr}(\\gamma) - \\mathrm{Tr}(\\rho)\n$$\n由于 $\\rho$ 和 $\\gamma$ 都是有效的密度矩阵，它们的迹都为 1：\n$$\ns \\, \\mathrm{Tr}(\\sigma) = (1+s) \\cdot 1 - 1 = 1+s-1 = s\n$$\n对于 $s > 0$，我们可以两边除以 $s$ 得到 $\\mathrm{Tr}(\\sigma) = 1$。这意味着只要能找到一个半正定算符 $\\sigma$，迹条件就自动满足。因此，唯一非平凡的约束是 $(1+s)\\gamma - \\rho$ 的半正定性。\n\n为了将其表述为一个标准优化问题，我们引入新变量 $t = 1+s$。由于 $s \\ge 0$，我们有 $t \\ge 1$。不等式变为：\n$$\nt \\gamma - \\rho \\succeq 0\n$$\n我们寻求最小化 $s$，这等价于最小化 $t$。目标函数是 $s = t-1$。这导出了 SDP 公式：\n$$\nR(\\rho) = \\min \\{ t-1 \\mid t \\ge 1, \\, t\\gamma - \\rho \\succeq 0 \\}\n$$\n这是一个标准的 SDP，因为目标函数 $t-1$ 是变量 $t$ 的线性函数，而约束 $t\\gamma - \\rho \\succeq 0$ 是一个线性矩阵不等式（LMI）。\n\n### 第二部分：特定案例的显式解\n\n题目要求我们求解在 $\\beta \\epsilon = 1$ 时，态为 $\\rho = 0.7 \\lvert 1 \\rangle \\langle 1 \\rvert + 0.3 \\lvert 0 \\rangle \\langle 0 \\rvert$ 的情况。在能量本征基 $\\{\\lvert 0 \\rangle, \\lvert 1 \\rangle\\}$ 中，该态由对角矩阵表示：\n$$\n\\rho = \\begin{pmatrix} 0.3  0 \\\\ 0  0.7 \\end{pmatrix}\n$$\n哈密顿量为 $H = \\mathrm{diag}(0, \\epsilon)$。吉布斯态 $\\gamma$ 由 $\\gamma = e^{-\\beta H}/Z$ 给出，其中 $Z = \\mathrm{Tr}(e^{-\\beta H})$。\n$$\nZ = e^{-\\beta \\cdot 0} + e^{-\\beta \\epsilon} = 1 + e^{-\\beta \\epsilon}\n$$\n$\\gamma = \\mathrm{diag}(p_0, p_1)$ 的分量为：\n$$\np_0 = \\frac{1}{Z} = \\frac{1}{1+e^{-\\beta \\epsilon}} \\quad \\text{和} \\quad p_1 = \\frac{e^{-\\beta \\epsilon}}{Z} = \\frac{e^{-\\beta \\epsilon}}{1+e^{-\\beta \\epsilon}}\n$$\n对于 $\\beta \\epsilon = 1$：\n$$\np_0 = \\frac{1}{1+e^{-1}} \\approx \\frac{1}{1+0.367879} \\approx 0.731059\n$$\n$$\np_1 = \\frac{e^{-1}}{1+e^{-1}} \\approx \\frac{0.367879}{1+0.367879} \\approx 0.268941\n$$\nLMI 为 $t\\gamma - \\rho \\succeq 0$。由于 $\\rho$ 和 $\\gamma$ 都是对角矩阵，矩阵 $t\\gamma-\\rho$ 也是对角的：\n$$\nt\\gamma - \\rho = \\begin{pmatrix} t p_0 - 0.3  0 \\\\ 0  t p_1 - 0.7 \\end{pmatrix}\n$$\n为使该矩阵是半正定的，其对角元素（即其特征值）必须为非负。这产生了两个标量不等式：\n$$\nt p_0 - 0.3 \\ge 0 \\implies t \\ge \\frac{0.3}{p_0}\n$$\n$$\nt p_1 - 0.7 \\ge 0 \\implies t \\ge \\frac{0.7}{p_1}\n$$\n最小的 $t$ 必须同时满足这两个条件。因此，$t$ 必须是两个下界中的最大值：\n$$\nt = \\max\\left(\\frac{0.3}{p_0}, \\frac{0.7}{p_1}\\right)\n$$\n代入数值：\n$$\nt = \\max\\left(\\frac{0.3}{0.731059}, \\frac{0.7}{0.268941}\\right) \\approx \\max(0.410358, 2.602863) = 2.602863\n$$\n于是，非热鲁棒性为 $R(\\rho) = t-1$：\n$$\nR(\\rho) \\approx 2.602863 - 1 = 1.602863\n$$\n\n### 第三部分：程序实现策略\n\n问题提供了满足 LMI 的最小 $t$ 的通用公式：$t = \\lVert \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\rVert_{\\infty}$，其中 $\\lVert \\cdot \\rVert_{\\infty}$ 是算符范数（最大奇异值，或者对于半正定矩阵，是最大特征值）。\n\n让我们简要证明这个公式。吉布斯态 $\\gamma$ 是对角的，且具有严格为正的特征值 $p_0, p_1  0$，因此其逆平方根 $\\gamma^{-1/2} = \\mathrm{diag}(1/\\sqrt{p_0}, 1/\\sqrt{p_1})$ 是良定义的。LMI $t\\gamma - \\rho \\succeq 0$ 可以通过与 $\\gamma^{-1/2}$ 的合同变换来转换，而不改变其定性：\n$$\n\\gamma^{-1/2} (t\\gamma - \\rho) \\gamma^{-1/2} \\succeq 0\n$$\n$$\nt \\, \\gamma^{-1/2} \\gamma \\gamma^{-1/2} - \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\succeq 0\n$$\n$$\nt I - \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\succeq 0\n$$\n其中 $I$ 是单位矩阵。这等价于说，$t$ 必须大于或等于厄米矩阵 $A = \\gamma^{-1/2} \\rho \\gamma^{-1/2}$ 的所有特征值。因此，满足条件的最小 $t$ 是 $A$ 的最大特征值，也就是其算符范数 $\\lVert A \\rVert_{\\infty}$。\n\n程序将为每个测试用例实现此逻辑：\n1.  给定 $\\beta \\epsilon$，计算 $p_0$ 和 $p_1$。\n2.  构建矩阵 $\\gamma$ 及其逆平方根 $\\gamma^{-1/2}$。\n3.  构建测试用例矩阵 $\\rho$。对于测试用例 2，$\\rho = \\gamma$。\n4.  计算矩阵 $A = \\gamma^{-1/2} \\rho \\gamma^{-1/2}$。\n5.  使用 `numpy.linalg.eigvalsh` 找到厄米矩阵 $A$ 的特征值。\n6.  $t$ 的值是最大特征值。\n7.  结果是 $R(\\rho) = t-1$。\n8.  收集所有测试用例的结果，格式化为六位小数并打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the robustness of athermality R(rho) for a series of test cases\n    involving a two-level quantum system.\n    \"\"\"\n    \n    # Test cases are tuples of (rho_matrix, beta_epsilon)\n    # A None value for rho_matrix signifies that rho should be set to the Gibbs state.\n    test_cases = [\n        # Test 1: Happy path\n        (np.array([[0.3, 0.0], [0.0, 0.7]], dtype=float), 1.0),\n        # Test 2: Boundary case (rho = gamma)\n        (None, 1.0),\n        # Test 3: Edge case (pure ground state)\n        (np.array([[1.0, 0.0], [0.0, 0.0]], dtype=float), 1.0),\n        # Test 4: Edge case (pure excited state)\n        (np.array([[0.0, 0.0], [0.0, 1.0]], dtype=float), 1.0),\n        # Test 5: Coherent state\n        (np.array([[0.3, 0.2], [0.2, 0.7]], dtype=float), 1.0),\n    ]\n\n    results = []\n    for rho_in, beta_epsilon in test_cases:\n        # Step 1: Calculate the Gibbs state gamma for the given beta_epsilon\n        exp_val = np.exp(-beta_epsilon)\n        partition_function = 1.0 + exp_val\n        p0 = 1.0 / partition_function\n        p1 = exp_val / partition_function\n        \n        gamma = np.diag([p0, p1])\n\n        # Step 2: Set the state rho for the current test case\n        if rho_in is None:\n            # Special case for Test 2 where rho is the Gibbs state\n            rho = gamma\n        else:\n            rho = rho_in\n\n        # Step 3: Compute the minimal t using the operator norm formula\n        # t = ||gamma^(-1/2) * rho * gamma^(-1/2)||_inf\n        \n        # Calculate gamma^(-1/2)\n        # The eigenvalues p0 and p1 are strictly positive for any finite beta_epsilon\n        gamma_inv_sqrt = np.diag([1.0 / np.sqrt(p0), 1.0 / np.sqrt(p1)])\n        \n        # Calculate the matrix A = gamma^(-1/2) * rho * gamma^(-1/2)\n        A = gamma_inv_sqrt @ rho @ gamma_inv_sqrt\n        \n        # The operator norm of a Hermitian matrix is its largest absolute eigenvalue.\n        # Since rho is positive semidefinite, A is also positive semidefinite,\n        # so its eigenvalues are non-negative. Thus, the norm is the max eigenvalue.\n        # np.linalg.eigvalsh is efficient for Hermitian matrices.\n        eigenvalues = np.linalg.eigvalsh(A)\n        t = np.max(eigenvalues)\n        \n        # Step 4: Calculate the robustness of athermality R(rho) = t - 1\n        robustness = t - 1\n        results.append(robustness)\n\n    # Format the results to six decimal places and print in the required format\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}