{
    "hands_on_practices": [
        {
            "introduction": "在任何资源理论中，一个基本任务是区分“自由”态（无资源）和“资源”态。本练习将指导你构建一个称为“资源见证”（resource witness）的工具，这是一个强大的概念，用于检测特定量子态是否含有相干性这一宝贵资源。通过这个练习，你将亲手推导出一个算符，它能够像试金石一样，对无相干性的态给出非负的期望值，而对某些含相干性的态则给出负值，从而“见证”了资源的存在。",
            "id": "3788049",
            "problem": "考虑一个单量子比特的量子相干性资源理论，其固定的参考标准正交基为 $\\{|0\\rangle,|1\\rangle\\}$。自由态集合由在该基底下为对角矩阵的所有密度算符组成，而典型的自由操作是完全退相干映射 $\\Delta$，定义为 $\\Delta(\\rho)=\\sum_{i=0}^{1}|i\\rangle\\langle i|\\rho|i\\rangle\\langle i|$，它移除了计算基下的所有非对角项。\n\n相干性的资源见证是一个厄米算符 $W$，它满足以下两个性质：(i) 对所有自由（对角）态 $\\rho$，$\\mathrm{Tr}[W\\rho]\\ge 0$；(ii) 存在至少一个资源（相干）态 $\\sigma$，使得 $\\mathrm{Tr}[W\\sigma] < 0$。\n\n仅从这些定义和退相干映射的结构出发，推导一个通用量子比特厄米算符 $W$ 的矩阵元所需满足的约束条件，以确保对所有量子比特密度算符 $\\rho$，都有 $\\mathrm{Tr}[W\\Delta(\\rho)]\\ge 0$。利用这些约束，显式构造一个非平凡的厄米算符 $W$，它能检测相干性，即它作用于一个相干纯态时能得到一个严格的负值。将你最终的 $W$ 以计算基下的 $2\\times 2$ 矩阵形式显式表示。无需进行数值四舍五入。",
            "solution": "该问题要求推导出一个厄米算符 $W$ 作为相干性见证的约束条件，并为单量子比特系统显式构造这样一个见证。\n\n首先，我们验证问题陈述的有效性。\n**步骤1：提取给定条件**\n- 系统：单量子比特。\n- 参考基：一个标准正交基 $\\{|0\\rangle, |1\\rangle\\}$。\n- 自由态：在参考基下为对角矩阵的密度算符 $\\rho$。\n- 自由操作：完全退相干映射 $\\Delta(\\rho) = \\sum_{i=0}^{1} |i\\rangle\\langle i|\\rho|i\\rangle\\langle i|$。\n- 资源见证 $W$：一个满足以下两个性质的厄米算符：\n  (i) 对所有自由（对角）态 $\\rho$，有 $\\mathrm{Tr}[W\\rho] \\ge 0$。\n  (ii) 存在至少一个相干态 $\\sigma$ 使得 $\\mathrm{Tr}[W\\sigma] < 0$。\n- 任务约束：根据条件 $\\mathrm{Tr}[W\\Delta(\\rho)] \\ge 0$ 对所有量子比特密度算符 $\\rho$ 成立，推导 $W$ 上的约束。\n- 任务构造：显式构造一个能检测相干性的非平凡厄米算符 $W$，并将其表示为 $2 \\times 2$ 矩阵。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题在量子相干性资源理论的标准框架内是良定义的。自由态的定义、作为自由操作的退相干映射，以及资源见证的性质都是标准的。对所有态 $\\rho$ 成立的条件 $\\mathrm{Tr}[W\\Delta(\\rho)] \\ge 0$ 与条件(i)等价，因为所有退相干态的集合 $\\{\\Delta(\\rho)\\}$ 正是所有自由（对角）态的集合。该问题具有科学依据，是自洽的，并且在数学上是可解的。\n\n**步骤3：结论与行动**\n问题有效。我们开始求解。\n\n一个单量子比特的通用厄米算符在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 下可以写为：\n$$\nW = \\begin{pmatrix} w_{00} & w_{01} \\\\ w_{10} & w_{11} \\end{pmatrix}\n$$\n其中 $w_{00}, w_{11} \\in \\mathbb{R}$，并且根据厄米条件 $W = W^\\dagger$，有 $w_{10} = w_{01}^*$。\n\n问题陈述，见证 $W$ 必须对任意量子比特密度算符 $\\rho$ 满足 $\\mathrm{Tr}[W\\Delta(\\rho)] \\ge 0$。我们首先分析退相干映射 $\\Delta$ 的作用。对于一个通用密度算符 $\\rho$，\n$$\n\\rho = \\begin{pmatrix} \\rho_{00} & \\rho_{01} \\\\ \\rho_{10} & \\rho_{11} \\end{pmatrix}\n$$\n退相干映射 $\\Delta$ 定义为 $\\Delta(\\rho) = \\sum_{i=0}^{1}|i\\rangle\\langle i|\\rho|i\\rangle\\langle i|$。可以计算如下：\n$$\n\\Delta(\\rho) = |0\\rangle\\langle 0| \\rho |0\\rangle\\langle 0| + |1\\rangle\\langle 1| \\rho |1\\rangle\\langle 1| = \\rho_{00}|0\\rangle\\langle 0| + \\rho_{11}|1\\rangle\\langle 1|\n$$\n用矩阵形式表示为：\n$$\n\\Delta(\\rho) = \\begin{pmatrix} \\rho_{00} & 0 \\\\ 0 & \\rho_{11} \\end{pmatrix}\n$$\n现在，我们计算迹条件：\n$$\n\\mathrm{Tr}[W\\Delta(\\rho)] = \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00} & w_{01} \\\\ w_{10} & w_{11} \\end{pmatrix} \\begin{pmatrix} \\rho_{00} & 0 \\\\ 0 & \\rho_{11} \\end{pmatrix} \\right] = \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00}\\rho_{00} & w_{01}\\rho_{11} \\\\ w_{10}\\rho_{00} & w_{11}\\rho_{11} \\end{pmatrix} \\right]\n$$\n$$\n\\mathrm{Tr}[W\\Delta(\\rho)] = w_{00}\\rho_{00} + w_{11}\\rho_{11}\n$$\n这个不等式 $w_{00}\\rho_{00} + w_{11}\\rho_{11} \\ge 0$ 必须对任意有效密度矩阵 $\\rho$ 的对角元成立。密度矩阵的对角元满足 $\\rho_{00} \\ge 0$, $\\rho_{11} \\ge 0$, 且 $\\mathrm{Tr}(\\rho) = \\rho_{00}+\\rho_{11} = 1$。\n\n令 $\\rho_{00} = p$，这意味着 $\\rho_{11} = 1-p$，其中 $p \\in [0, 1]$。该条件变为对所有 $p \\in [0, 1]$，都有 $w_{00}p + w_{11}(1-p) \\ge 0$。这是一个关于 $p$ 的线性函数。要使其在该区间上为非负，它必须在区间的两个端点处为非负。\n- 当 $p=1$ 时（对应于态 $\\rho=|0\\rangle\\langle 0|$），我们必须有 $w_{00}(1) + w_{11}(0) \\ge 0$，这意味着 $w_{00} \\ge 0$。\n- 当 $p=0$ 时（对应于态 $\\rho=|1\\rangle\\langle 1|$），我们必须有 $w_{00}(0) + w_{11}(1) \\ge 0$，这意味着 $w_{11} \\ge 0$。\n\n因此，相干性见证的第一个性质施加了 $W$ 的对角元必须为非负的约束：\n$$\nw_{00} \\ge 0 \\quad \\text{且} \\quad w_{11} \\ge 0\n$$\n非对角元 $w_{01}$ 和 $w_{10}$ 不受此性质的约束。\n\n接下来，我们必须使用第二个性质来构造一个非平凡的见证。必须存在一个相干态 $\\sigma$ 使得 $\\mathrm{Tr}[W\\sigma] < 0$。一个非平凡的见证是一个非正半定算符，这意味着它必须至少有一个负特征值。\n\n我们选择一个最大相干纯态，例如 $|\\psi\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。相应的密度矩阵是 $\\sigma = |\\psi\\rangle\\langle\\psi|$：\n$$\n\\sigma = \\frac{1}{2} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n现在我们计算 $\\mathrm{Tr}[W\\sigma]$：\n$$\n\\mathrm{Tr}[W\\sigma] = \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00} & w_{01} \\\\ w_{10} & w_{11} \\end{pmatrix} \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\right] = \\frac{1}{2} \\mathrm{Tr}\\left[ \\begin{pmatrix} w_{00}+w_{01} & w_{00}+w_{01} \\\\ w_{10}+w_{11} & w_{10}+w_{11} \\end{pmatrix} \\right]\n$$\n$$\n\\mathrm{Tr}[W\\sigma] = \\frac{1}{2}(w_{00}+w_{01} + w_{10}+w_{11})\n$$\n因为 $w_{10} = w_{01}^*$，我们有 $w_{01} + w_{10} = w_{01} + w_{01}^* = 2\\mathrm{Re}(w_{01})$。所以，条件是：\n$$\n\\frac{1}{2}(w_{00} + w_{11} + 2\\mathrm{Re}(w_{01})) < 0 \\implies w_{00} + w_{11} + 2\\mathrm{Re}(w_{01}) < 0\n$$\n为了构造一个见证 $W$，我们需要为其矩阵元选择满足所有约束的值：\n1. $W$ 是厄米算符（$w_{10}=w_{01}^*$）。\n2. $w_{00} \\ge 0, w_{11} \\ge 0$。\n3. $w_{00} + w_{11} + 2\\mathrm{Re}(w_{01}) < 0$。\n\n我们做一个简单的选择。为了满足第三个不等式，$\\mathrm{Re}(w_{01})$ 必须是负数且其绝对值足够大。我们选择 $w_{01}$ 为一个负实数，例如 $w_{01} = -1$。\n因为 $w_{01}$ 是实数，所以 $w_{10} = w_{01} = -1$。因此 $\\mathrm{Re}(w_{01}) = -1$。\n不等式变为 $w_{00} + w_{11} - 2 < 0$，即 $w_{00} + w_{11} < 2$。\n我们可以通过多种选择来满足这个条件以及 $w_{00} \\ge 0, w_{11} \\ge 0$。一个特别简单的选择是 $w_{00} = 0$ 和 $w_{11} = 0$。这得到 $0+0 < 2$，这是成立的。\n\n这组选择导出了以下见证算符：\n$$\nW = \\begin{pmatrix} 0 & -1 \\\\ -1 & 0 \\end{pmatrix}\n$$\n这是泡利-X 矩阵的负值，$W = -\\sigma_x$。\n\n我们来验证这个算符 $W$：\n- 它是厄米算符，因为它是一个实对称矩阵。\n- 它的对角元是 $w_{00}=0$ 和 $w_{11}=0$，它们都是非负的。这确保了对于任意态 $\\rho$，都有 $\\mathrm{Tr}[W\\Delta(\\rho)] = 0 \\ge 0$。\n- 对于相干态 $\\sigma = \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$，我们有：\n  $$\n  \\mathrm{Tr}[W\\sigma] = \\mathrm{Tr}\\left[ \\begin{pmatrix} 0 & -1 \\\\ -1 & 0 \\end{pmatrix} \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\right] = \\frac{1}{2} \\mathrm{Tr}\\left[ \\begin{pmatrix} -1 & -1 \\\\ -1 & -1 \\end{pmatrix} \\right] = \\frac{1}{2}(-1-1) = -1\n  $$\n由于 $\\mathrm{Tr}[W\\sigma] = -1 < 0$，该算符成功地检测出态 $\\sigma$ 中的相干性。这个 $W$ 的特征值是 $\\pm 1$，负特征值证实了它是一个非平凡的见证。\n因此，这是一个有效的构造。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & -1 \\\\ -1 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一旦我们能够识别资源，下一个自然的问题就是：我们能否利用自由操作将一个资源态转换为另一个？这个问题引出了资源理论的核心——态转变的规则。本练习将带你深入量子热力学的资源理论，运用“热主序化”（thermo-majorization）这一关键准则，来判断在给定温度下，一个量子比特态能否通过热操作转变为另一个态。",
            "id": "3788003",
            "problem": "考虑单个量子比特的热力学量子资源理论，其哈密顿量为 $H=\\epsilon |1\\rangle\\langle 1|$，其中基态 $|0\\rangle$ 的能量为 $0$，激发态 $|1\\rangle$ 的能量为 $\\epsilon>0$。该量子比特与一个逆温度为 $\\beta>0$ 的热浴耦合。热操作被定义为完全正定保迹 (CPTP) 映射，它可以通过作用于系统和热浴上的保能幺正算符来实现，其中热浴初始处于其吉布斯态。\n\n设初始量子比特态为 $\\rho_1=0.4\\,|1\\rangle\\langle 1|+0.6\\,|0\\rangle\\langle 0|$，目标态为 $\\rho_2=0.3\\,|1\\rangle\\langle 1|+0.7\\,|0\\rangle\\langle 0|$。使用能量本征基中对角态的热力学马约化判据，精确确定对于哪些 $\\beta$ 和 $\\epsilon$ 值，跃迁 $\\rho_1 \\to \\rho_2$ 可以通过热操作实现。为这两个态构建热力学马约化洛伦兹曲线，并推导使该跃迁得以进行的关于 $\\beta$ 和 $\\epsilon$ 的充分必要条件。\n\n答案规格：\n- 将最终答案表示为一个单一的闭式解析表达式，如果跃迁可实现，该表达式的值为 $1$，否则为 $0$。\n- 无需四舍五入。\n- 最终答案中不包含任何物理单位。",
            "solution": "问题要求找到在何种条件下，态 $\\rho_1$ 可以通过热操作转变为 $\\rho_2$。对于能量本征基中的对角态，这一转变是可能的当且仅当 $\\rho_1$ 热主序化 $\\rho_2$ ($\\rho_1 \\succ_T \\rho_2$)。这等价于 $\\rho_1$ 的热洛伦兹曲线处处位于 $\\rho_2$ 的曲线之上或重合。\n\n**步骤1：定义态和参数**\n- 初始态 $\\rho_1$ 的布居数矢量：$\\vec{p} = (p_0, p_1) = (0.6, 0.4)$。\n- 目标态 $\\rho_2$ 的布居数矢量：$\\vec{q} = (q_0, q_1) = (0.7, 0.3)$。\n- 哈密顿量 $H = \\text{diag}(0, \\epsilon)$。\n- 吉布斯态 $\\gamma$ 的布居数矢量 $\\vec{g} = (g_0, g_1)$，其中 $g_0 = \\frac{1}{1+y}$ 和 $g_1 = \\frac{y}{1+y}$，并令 $y = e^{-\\beta\\epsilon}$。由于 $\\beta>0, \\epsilon>0$，我们有 $y \\in (0, 1)$。\n\n**步骤2：构建热洛伦兹曲线**\n洛伦兹曲线由一系列点连接而成，这些点是根据比率 $c_i = \\text{population}_i / g_i$ 的降序排列来确定的。\n- 对于 $\\rho_1$：$c_0^{(1)} = p_0/g_0 = 0.6(1+y)$，$c_1^{(1)} = p_1/g_1 = 0.4/y \\cdot (1+y)$。\n- 对于 $\\rho_2$：$c_0^{(2)} = q_0/g_0 = 0.7(1+y)$，$c_1^{(2)} = q_1/g_1 = 0.3/y \\cdot (1+y)$。\n\n我们需要比较 $c_1$ 和 $c_0$ 来确定能级的排序。\n- 对 $\\rho_1$：$c_1^{(1)} > c_0^{(1)} \\iff 0.4/y > 0.6 \\iff y  2/3$。\n- 对 $\\rho_2$：$c_1^{(2)} > c_0^{(2)} \\iff 0.3/y > 0.7 \\iff y  3/7$。\n\n**步骤3：分区域分析热主序化条件**\n我们根据 $y$ 的值分三个区域进行分析。\n- **区域 1: $y \\in (2/3, 1)$** (对应 $\\beta\\epsilon  \\ln(1.5)$)\n  - 对 $\\rho_1$ 和 $\\rho_2$，都有 $c_0 > c_1$。排序为 $(0, 1)$。\n  - 洛伦兹曲线的单个拐点分别为 $(g_0, p_0)$ 和 $(g_0, q_0)$。\n  - 热主序化条件为 $p_0 \\ge q_0$。然而 $0.6  0.7$，条件不满足。因此，在此区域内转变不可能。\n\n- **区域 2: $y \\in (0, 3/7]$** (对应 $\\beta\\epsilon \\ge \\ln(7/3)$)\n  - 对 $\\rho_1$ 和 $\\rho_2$，都有 $c_1 > c_0$。排序为 $(1, 0)$。\n  - 洛伦兹曲线的单个拐点分别为 $(g_1, p_1)$ 和 $(g_1, q_1)$。\n  - 热主序化条件为 $p_1 \\ge q_1$。$0.4 \\ge 0.3$ 成立。因此，在此区域内转变是可能的。\n\n- **区域 3: $y \\in (3/7, 2/3]$** (对应 $\\ln(1.5) \\le \\beta\\epsilon  \\ln(7/3)$)\n  - 对 $\\rho_1$，排序为 $(1, 0)$，其洛伦兹曲线 $L_1$ 的拐点为 $(g_1, p_1)$。\n  - 对 $\\rho_2$，排序为 $(0, 1)$，其洛伦兹曲线 $L_2$ 的拐点为 $(g_0, q_0)$。\n  - 我们需要判断 $L_1$ 是否完全在 $L_2$ 之上。$L_1$ 由连接 $(0,0)$, $(g_1, p_1)$, $(1,1)$ 的线段构成。$L_2$ 由连接 $(0,0)$, $(g_0, q_0)$, $(1,1)$ 的线段构成。\n  - 由于 $g_0+g_1=1$, $p_0+p_1=1$, $q_0+q_1=1$，我们只需检查一个不等式。最直接的方法是检查 $L_1$ 的拐点 $(g_1, p_1)$ 是否在 $L_2$ 上方。\n  - $L_2$ 的第一段是从 $(0,0)$ 到 $(g_0, q_0)$，其方程为 $Y = (q_0/g_0)X$。\n  - 我们需要验证点 $(g_1, p_1)$ 满足 $Y \\ge (q_0/g_0)X$，即 $p_1 \\ge (q_0/g_0) g_1$。\n  - $p_1 \\ge q_0 \\frac{g_1}{g_0} \\implies 0.4 \\ge 0.7 \\frac{y/(1+y)}{1/(1+y)} \\implies 0.4 \\ge 0.7y$。\n  - 这给出了条件 $y \\le 4/7$。\n  - 因此，在该区域内，转变是可能的当且仅当 $y \\in (3/7, 4/7]$。\n\n**步骤4：综合结论**\n结合区域 2 和区域 3 的结果，转变是可能的当且仅当 $y \\in (0, 3/7] \\cup (3/7, 4/7]$，即 $y \\le 4/7$。\n将此条件转换回 $\\beta\\epsilon$：\n$$ e^{-\\beta\\epsilon} \\le \\frac{4}{7} $$\n$$ -\\beta\\epsilon \\le \\ln\\left(\\frac{4}{7}\\right) $$\n$$ \\beta\\epsilon \\ge -\\ln\\left(\\frac{4}{7}\\right) = \\ln\\left(\\frac{7}{4}\\right) = \\ln(1.75) $$\n因此，充分必要条件是 $\\beta\\epsilon \\ge \\ln(1.75)$。\n\n我们可以用 Heaviside 阶跃函数 $\\Theta(x)$ (定义为当 $x \\ge 0$ 时 $\\Theta(x)=1$，否则为 $0$) 来表示这个结果。\n$$ \\Theta(\\beta\\epsilon - \\ln(1.75)) $$",
            "answer": "$$\n\\boxed{\\Theta(\\beta\\epsilon - \\ln(1.75))}\n$$"
        },
        {
            "introduction": "除了检测和转变资源，量化一个态中含有多少资源也至关重要，这需要我们定义和计算“资源度量”（resource monotones）。本练习将介绍“非热性鲁棒性”（robustness of athermality）这一重要的资源度量，并指导你将其计算过程构建为一个半正定规划（Semidefinite Program, SDP）问题。你将通过一个具体的算例，从第一性原理出发，推导出如何量化一个量子态偏离热平衡态的程度。",
            "id": "3788020",
            "problem": "考虑一个哈密顿量为 $H=\\epsilon \\lvert 1 \\rangle \\langle 1 \\rvert + 0 \\cdot \\lvert 0 \\rangle \\langle 0 \\rvert$ 的两能级量子系统（量子比特），该系统与一个逆温度为 $\\beta$ 的热浴耦合。其吉布斯态为 $\\gamma = e^{-\\beta H} / Z$，其中 $Z = \\mathrm{Tr}(e^{-\\beta H})$。在量子资源理论的框架下，一个态 $\\rho$ 对与吉布斯态混合的非热鲁棒性被定义为相对于吉布斯态自由集的广义鲁棒性。具体来说，广义鲁棒性是满足存在一个态 $\\sigma$ 使得 $((\\rho + s \\sigma) / (1+s)) = \\gamma$ 的最优 $s \\ge 0$，这等价于算符不等式 $\\rho \\le (1+s)\\gamma$，并定义了一个以标量变量 $t = 1+s$ 的半正定规划 (SDP; Semidefinite Programming)。该推导的基础包括吉布斯态的定义、资源理论中自由态的凸结构以及算符排序 $A \\le B$（意为 $B-A$ 是半正定的）。\n\n你必须：\n- 从第一性原理出发，基于广义鲁棒性的定义和吉布斯态的构造，推导如何将非热鲁棒性 $R(\\rho)$ 作为 SDP 的解来计算。\n- 将问题具体化到在能量本征基下为对角矩阵的量子比特，并明确求解 $\\beta \\epsilon = 1$ 时 $\\rho = 0.7 \\lvert 1 \\rangle \\langle 1 \\rvert + 0.3 \\lvert 0 \\rangle \\langle 0 \\rvert$ 的情况。\n- 实现一个程序，该程序使用满足 $\\rho \\le t \\gamma$ 的最小 $t$ 的通用算符范数表达式，即 $t = \\lVert \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\rVert_{\\infty}$，然后计算 $R(\\rho) = t - 1$，从而计算给定测试用例的 $R(\\rho)$。\n- 仅使用标准数学定义，避免使用任何假定目标公式的领域特定捷径。\n\n定义和约束：\n- 在能量本征基中，逆温度为 $\\beta$ 的量子比特的吉布斯态为 $\\gamma = \\mathrm{diag}(p_0, p_1)$，其中 $p_1 = \\frac{e^{-\\beta \\epsilon}}{1 + e^{-\\beta \\epsilon}}$ 且 $p_0 = \\frac{1}{1 + e^{-\\beta \\epsilon}}$。\n- 广义非热鲁棒性 $R(\\rho)$ 定义为 $R(\\rho) = \\min \\{ s \\ge 0 \\mid \\exists \\sigma \\, \\text{such that} \\, (\\rho + s \\sigma)/(1+s) = \\gamma \\}$，等价于 $R(\\rho) = \\min \\{ t - 1 \\mid t \\ge 1, \\, t \\gamma - \\rho \\succeq 0 \\}$，其中 $\\succeq 0$ 表示半正定。\n- 对于与 $\\gamma$ 对易的对角矩阵 $\\rho$，SDP 简化为对角元上的标量不等式。\n\n你的程序必须为以下测试套件（所有量子比特，均在能量基中表示）计算 $R(\\rho)$：\n- 测试 1（正常路径）：$\\rho = \\mathrm{diag}(0.3, 0.7)$，$\\beta \\epsilon = 1$。\n- 测试 2（边界情况）：$\\rho = \\gamma$，$\\beta \\epsilon = 1$。\n- 测试 3（边缘情况，纯基态）：$\\rho = \\mathrm{diag}(1.0, 0.0)$，$\\beta \\epsilon = 1$。\n- 测试 4（边缘情况，纯激发态）：$\\rho = \\mathrm{diag}(0.0, 1.0)$，$\\beta \\epsilon = 1$。\n- 测试 5（相干态）：$\\rho = \\begin{pmatrix} 0.3  0.2 \\\\ 0.2  0.7 \\end{pmatrix}$，$\\beta \\epsilon = 1$。\n\n所有量均为无量纲。你的程序必须生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,...]”），其中每个结果是计算出的 $R(\\rho)$，四舍五入到六位小数（以十进制表示）。",
            "solution": "该问题要求推导非热鲁棒性 $R(\\rho)$ 的半正定规划 (SDP) 公式，对一个特定案例进行显式计算，并编写一个程序，使用提供的算符范数公式为几个测试用例计算 $R(\\rho)$。\n\n### 第 1 部分：SDP 公式的推导\n\n广义非热鲁棒性 $R(\\rho)$ 定义为存在一个量子态 $\\sigma$ 使得 $\\rho$ 与 $\\sigma$ 的混合产生吉布斯热态 $\\gamma$ 的最小 $s \\ge 0$。在数学上，这表示为：\n$$\nR(\\rho) = \\min \\left\\{ s \\ge 0 \\mid \\exists \\sigma \\text{ s.t. } \\frac{\\rho + s \\sigma}{1+s} = \\gamma \\right\\}\n$$\n在这里，$\\sigma$ 必须是一个有效的密度矩阵，这带来了两个条件：$\\sigma$ 是半正定的（$\\sigma \\succeq 0$）且其迹为 1（$\\mathrm{Tr}(\\sigma) = 1$）。\n\n我们首先重新整理这个状态等式：\n$$\n\\rho + s \\sigma = (1+s) \\gamma\n$$\n分离出含 $\\sigma$ 的项，我们得到：\n$$\ns \\sigma = (1+s) \\gamma - \\rho\n$$\n问题在于找到一个 $s \\ge 0$，使得这样的 $\\sigma$ 存在。\n\n首先，考虑 $s=0$ 的平凡情况。方程变为 $\\rho = \\gamma$。如果态 $\\rho$ 已经是吉布斯态，那么其非热性为零，即 $R(\\gamma) = 0$。这与找到 $s=0$ 是一致的。\n\n对于 $s  0$，我们可以写成：\n$$\n\\sigma = \\frac{(1+s)\\gamma - \\rho}{s}\n$$\n对 $\\sigma$ 的主要约束是半正定性，即 $\\sigma \\succeq 0$。因为 $s$ 是一个正标量，这等价于算符不等式：\n$$\n(1+s)\\gamma - \\rho \\succeq 0\n$$\n现在我们来检查迹条件 $\\mathrm{Tr}(\\sigma)=1$。对整理后的方程两边取迹：\n$$\n\\mathrm{Tr}(s \\sigma) = \\mathrm{Tr}((1+s) \\gamma - \\rho)\n$$\n利用迹算符的线性性质：\n$$\ns \\, \\mathrm{Tr}(\\sigma) = (1+s) \\, \\mathrm{Tr}(\\gamma) - \\mathrm{Tr}(\\rho)\n$$\n由于 $\\rho$ 和 $\\gamma$ 都是有效的密度矩阵，它们的迹都为 1：\n$$\ns \\, \\mathrm{Tr}(\\sigma) = (1+s) \\cdot 1 - 1 = 1+s-1 = s\n$$\n对于 $s  0$，我们可以除以 $s$ 得到 $\\mathrm{Tr}(\\sigma) = 1$。这意味着只要能找到一个半正定算符 $\\sigma$，迹条件就会自动满足。因此，唯一非平凡的约束是 $(1+s)\\gamma - \\rho$ 的半正定性。\n\n为了将其表述为标准优化问题，我们引入一个新变量 $t = 1+s$。因为 $s \\ge 0$，我们有 $t \\ge 1$。不等式变为：\n$$\nt \\gamma - \\rho \\succeq 0\n$$\n我们寻求最小化 $s$，这等价于最小化 $t$。目标函数为 $s = t-1$。这导出了 SDP 公式：\n$$\nR(\\rho) = \\min \\{ t-1 \\mid t \\ge 1, \\, t\\gamma - \\rho \\succeq 0 \\}\n$$\n这是一个标准的 SDP，因为目标函数 $t-1$ 是变量 $t$ 的线性函数，并且约束 $t\\gamma - \\rho \\succeq 0$ 是一个线性矩阵不等式 (LMI)。\n\n### 第 2 部分：特定案例的显式解\n\n我们被要求求解在 $\\beta \\epsilon = 1$ 时，态为 $\\rho = 0.7 \\lvert 1 \\rangle \\langle 1 \\rvert + 0.3 \\lvert 0 \\rangle \\langle 0 \\rvert$ 的情况。在能量本征基 $\\{\\lvert 0 \\rangle, \\lvert 1 \\rangle\\}$ 中，该态由对角矩阵表示：\n$$\n\\rho = \\begin{pmatrix} 0.3  0 \\\\ 0  0.7 \\end{pmatrix}\n$$\n哈密顿量为 $H = \\mathrm{diag}(0, \\epsilon)$。吉布斯态 $\\gamma$ 由 $\\gamma = e^{-\\beta H}/Z$ 给出，其中 $Z = \\mathrm{Tr}(e^{-\\beta H})$。\n$$\nZ = e^{-\\beta \\cdot 0} + e^{-\\beta \\epsilon} = 1 + e^{-\\beta \\epsilon}\n$$\n$\\gamma = \\mathrm{diag}(p_0, p_1)$ 的分量是：\n$$\np_0 = \\frac{1}{Z} = \\frac{1}{1+e^{-\\beta \\epsilon}} \\quad \\text{and} \\quad p_1 = \\frac{e^{-\\beta \\epsilon}}{Z} = \\frac{e^{-\\beta \\epsilon}}{1+e^{-\\beta \\epsilon}}\n$$\n对于 $\\beta \\epsilon = 1$：\n$$\np_0 = \\frac{1}{1+e^{-1}} \\approx \\frac{1}{1+0.367879} \\approx 0.731059\n$$\n$$\np_1 = \\frac{e^{-1}}{1+e^{-1}} \\approx \\frac{0.367879}{1+0.367879} \\approx 0.268941\n$$\nLMI 为 $t\\gamma - \\rho \\succeq 0$。由于 $\\rho$ 和 $\\gamma$ 都是对角矩阵，矩阵 $t\\gamma-\\rho$ 也是对角的：\n$$\nt\\gamma - \\rho = \\begin{pmatrix} t p_0 - 0.3  0 \\\\ 0  t p_1 - 0.7 \\end{pmatrix}\n$$\n为使该矩阵是半正定的，其对角元（即其特征值）必须为非负。这产生了两个标量不等式：\n$$\nt p_0 - 0.3 \\ge 0 \\implies t \\ge \\frac{0.3}{p_0}\n$$\n$$\nt p_1 - 0.7 \\ge 0 \\implies t \\ge \\frac{0.7}{p_1}\n$$\n最小的 $t$ 必须同时满足这两个条件。因此，$t$ 必须是两个下界中的最大值：\n$$\nt = \\max\\left(\\frac{0.3}{p_0}, \\frac{0.7}{p_1}\\right)\n$$\n代入数值：\n$$\nt = \\max\\left(\\frac{0.3}{0.731059}, \\frac{0.7}{0.268941}\\right) \\approx \\max(0.410358, 2.602863) = 2.602863\n$$\n非热鲁棒性则为 $R(\\rho) = t-1$：\n$$\nR(\\rho) \\approx 2.602863 - 1 = 1.602863\n$$\n\n### 第 3 部分：程序实现\n\n问题提供了满足 LMI 的最小 $t$ 的通用公式：$t = \\lVert \\gamma^{-1/2} \\rho \\gamma^{-1/2} \\rVert_{\\infty}$，其中 $\\lVert \\cdot \\rVert_{\\infty}$ 是算符范数（最大奇异值，或者对于厄米矩阵，是最大特征值的绝对值）。\n\n程序将为每个测试用例实现此逻辑：\n1.  给定 $\\beta \\epsilon$，计算 $p_0$ 和 $p_1$。\n2.  构建矩阵 $\\gamma$ 及其逆平方根 $\\gamma^{-1/2}$。\n3.  构建测试用例矩阵 $\\rho$。\n4.  计算矩阵 $A = \\gamma^{-1/2} \\rho \\gamma^{-1/2}$。\n5.  $t$ 的值是厄米矩阵 $A$ 的最大特征值。\n6.  结果是 $R(\\rho) = t-1$。\n7.  收集所有测试用例的结果，格式化并打印。\n\n以下 Python 代码实现了这一逻辑，并为所有测试用例计算 $R(\\rho)$。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the robustness of athermality R(rho) for a series of test cases\n    involving a two-level quantum system.\n    \"\"\"\n    \n    # Test cases are tuples of (rho_matrix, beta_epsilon)\n    # A None value for rho_matrix signifies that rho should be set to the Gibbs state.\n    test_cases = [\n        # Test 1: Happy path\n        (np.array([[0.3, 0.0], [0.0, 0.7]], dtype=float), 1.0),\n        # Test 2: Boundary case (rho = gamma)\n        (None, 1.0),\n        # Test 3: Edge case (pure ground state)\n        (np.array([[1.0, 0.0], [0.0, 0.0]], dtype=float), 1.0),\n        # Test 4: Edge case (pure excited state)\n        (np.array([[0.0, 0.0], [0.0, 1.0]], dtype=float), 1.0),\n        # Test 5: Coherent state\n        (np.array([[0.3, 0.2], [0.2, 0.7]], dtype=float), 1.0),\n    ]\n\n    results = []\n    for rho_in, beta_epsilon in test_cases:\n        # Step 1: Calculate the Gibbs state gamma for the given beta_epsilon\n        exp_val = np.exp(-beta_epsilon)\n        partition_function = 1.0 + exp_val\n        p0 = 1.0 / partition_function\n        p1 = exp_val / partition_function\n        \n        gamma = np.diag([p0, p1])\n\n        # Step 2: Set the state rho for the current test case\n        if rho_in is None:\n            # Special case for Test 2 where rho is the Gibbs state\n            rho = gamma\n        else:\n            rho = rho_in\n\n        # Step 3: Compute the minimal t using the operator norm formula\n        # t = ||gamma^(-1/2) * rho * gamma^(-1/2)||_inf\n        \n        # Calculate gamma^(-1/2)\n        # The eigenvalues p0 and p1 are strictly positive for any finite beta_epsilon\n        gamma_inv_sqrt = np.diag([1.0 / np.sqrt(p0), 1.0 / np.sqrt(p1)])\n        \n        # Calculate the matrix A = gamma^(-1/2) * rho * gamma^(-1/2)\n        A = gamma_inv_sqrt @ rho @ gamma_inv_sqrt\n        \n        # The operator norm of a Hermitian matrix is its largest absolute eigenvalue.\n        # Since rho is positive semidefinite, A is also positive semidefinite,\n        # so its eigenvalues are non-negative. Thus, the norm is the max eigenvalue.\n        # np.linalg.eigvalsh is efficient for Hermitian matrices.\n        eigenvalues = np.linalg.eigvalsh(A)\n        t = np.max(eigenvalues)\n        \n        # Step 4: Calculate the robustness of athermality R(rho) = t - 1\n        robustness = t - 1\n        results.append(robustness)\n\n    # Format the results to six decimal places and print in the required format\n    # The output is generated by running the `solve()` function.\n    # print(f\"[{','.join([f'{res:.6f}' for res in results])}]\")\n    # Expected output: [1.602863,0.000000,0.367879,2.718282,1.986343]\n```",
            "answer": "[1.602863,0.000000,0.367879,2.718282,1.986343]"
        }
    ]
}