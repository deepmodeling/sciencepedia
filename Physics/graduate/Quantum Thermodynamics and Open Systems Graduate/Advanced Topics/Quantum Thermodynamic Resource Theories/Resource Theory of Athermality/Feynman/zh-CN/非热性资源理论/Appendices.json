{
    "hands_on_practices": [
        {
            "introduction": "在非热性的资源理论中，遍历能量（ergotropy）是一个核心概念，它量化了仅通过幺正操作（即不与热库相互作用）可以从一个量子态中提取的最大功。这个练习旨在通过一个具体的计算来巩固您对遍历能量的理解。您将处理一个初始粒子数处于非吉布斯序的量子三能级系统，并计算其遍历能量，从而亲身体验非被动态（具有粒子数反转的态）如何作为一种资源，通过重新排列粒子数到被动的、能量更低的构型来产生功 。",
            "id": "3783476",
            "problem": "考虑一个三能级量子系统（量子三比特），其哈密顿量为 $H$，具有非简并且严格递增的能量本征值 $\\epsilon_{1}  \\epsilon_{2}  \\epsilon_{3}$。设该系统初始处于一个在能量本征基下对角的态 $\\rho$，其布居数分别为 $p_{1}$、$p_{2}$、$p_{3}$。假设这些布居数不满足吉布斯序 (Gibbs order)，即它们不随能量单调非递增。在非热性资源理论 (resource theory of athermality) 中，ergotropy $\\mathcal{W}(\\rho)$ 定义为通过幺正操作可提取的最大功，\n$$\n\\mathcal{W}(\\rho) = \\max_{U}\\,\\mathrm{Tr}\\!\\left[H\\left(\\rho - U\\rho U^{\\dagger}\\right)\\right],\n$$\n其中 $U$ 遍历量子三比特希尔伯特空间上的所有幺正算符。从被动性 (passivity) 和幺正变换的谱不变性 (spectral invariance) 的定义出发，通过确定 $\\rho$ 的被动重排 (passive rearrangement)，推导出 $\\mathcal{W}(\\rho)$ 关于 $\\rho$ 的谱和 $H$ 的能量本征值的表达式。然后，对以下具体实例计算 $\\mathcal{W}(\\rho)$ 的值：\n$$\n\\epsilon_{1} = 0\\,\\text{J},\\quad \\epsilon_{2} = 3.0 \\times 10^{-21}\\,\\text{J},\\quad \\epsilon_{3} = 5.0 \\times 10^{-21}\\,\\text{J},\n$$\n以及\n$$\np_{1} = 0.20,\\quad p_{2} = 0.30,\\quad p_{3} = 0.50.\n$$\n最终答案以焦耳为单位表示。您的最终答案必须是一个实数。由于输入是精确小数，因此不需要四舍五入指令。",
            "solution": "首先验证问题，以确保其科学上可靠、良构且客观。\n\n### 步骤1：提取已知条件\n- 系统：一个三能级量子系统（量子三比特）。\n- 哈密顿量：$H$，具有非简并且严格递增的能量本征值 $\\epsilon_{1}  \\epsilon_{2}  \\epsilon_{3}$。\n- 初始态：$\\rho$，在能量本征基下是对角的，布居数为 $p_{1}$、$p_{2}$、$p_{3}$。\n- 条件：布居数不处于吉布斯序。\n- Ergotropy的定义：$\\mathcal{W}(\\rho) = \\max_{U}\\,\\mathrm{Tr}\\!\\left[H\\left(\\rho - U\\rho U^{\\dagger}\\right)\\right]$，其中 $U$ 是任意幺正算符。\n- 任务1：通过确定 $\\rho$ 的被动重排，推导 $\\mathcal{W}(\\rho)$ 的表达式。\n- 任务2：对以下具体数值计算 $\\mathcal{W}(\\rho)$：\n  - $\\epsilon_{1} = 0\\,\\text{J}$\n  - $\\epsilon_{2} = 3.0 \\times 10^{-21}\\,\\text{J}$\n  - $\\epsilon_{3} = 5.0 \\times 10^{-21}\\,\\text{J}$\n  - $p_{1} = 0.20$\n  - $p_{2} = 0.30$\n  - $p_{3} = 0.50$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学上可靠：** 该问题基于量子热力学的既定原理，特别是非热资源理论。Ergotropy、被动态、幺正演化、哈密顿量和密度矩阵等概念是该领域的标准内容。\n- **良构的：** 该问题提供了推导通用公式并计算具体数值所需的所有必要定义和数据。该最大化问题是良定义的，并且有唯一解。\n- **客观的：** 该问题以精确、正式的语言陈述，没有主观或模糊的术语。\n- **缺陷清单：**\n  1. **科学/事实不健全：** 无。前提在物理上和数学上都是健全的。对于能级 $\\epsilon_{1}  \\epsilon_{2}  \\epsilon_{3}$，给定的布居数分布 $p_{1}, p_{2}, p_{3}$ 正确地表示了一个具有布居数反转的态，该态“不处于吉布斯序”，因而是活性的（非被动的）。布居数之和为 $0.20 + 0.30 + 0.50 = 1.0$，符合密度矩阵的要求。\n  2. **不可形式化/不相关：** 无。该问题是量子热力学中的一个形式化练习。\n  3. **不完整/矛盾的设置：** 无。所有必要信息均已提供且内部一致。\n  4. **不现实/不可行：** 无。给定的能量和布居数值对于量子系统在物理上是合理的。\n  5. **病态/结构不良：** 无。问题结构清晰，可以导出一个唯一的答案。\n  6. **伪深刻/琐碎/同义反复：** 无。该问题需要对量子态和算符的定义及性质进行非平凡的应用。\n  7. **超出科学可验证性范围：** 无。该问题完全在数学物理领域内。\n\n### 步骤3：结论和行动\n问题有效。将提供完整解答。\n\n### 解答推导\nErgotropy $\\mathcal{W}(\\rho)$ 是通过幺正操作可以从量子态 $\\rho$ 中提取的最大功。其定义为：\n$$\n\\mathcal{W}(\\rho) = \\max_{U}\\,\\mathrm{Tr}\\!\\left[H\\left(\\rho - U\\rho U^{\\dagger}\\right)\\right]\n$$\n利用迹的线性性质，我们可以将此表达式重写为：\n$$\n\\mathcal{W}(\\rho) = \\mathrm{Tr}(H\\rho) - \\min_{U}\\,\\mathrm{Tr}(H U\\rho U^{\\dagger})\n$$\n第一项 $\\mathrm{Tr}(H\\rho)$ 代表系统的初始平均能量。由于态 $\\rho$ 在能量本征基 $\\{|E_i\\rangle\\}$ 下是对角的，布居数为 $p_i$，我们有 $\\rho = \\sum_{i=1}^{3} p_i |E_i\\rangle\\langle E_i|$，哈密顿量为 $H = \\sum_{i=1}^{3} \\epsilon_i |E_i\\rangle\\langle E_i|$。初始能量为：\n$$\nE_{\\text{initial}} = \\mathrm{Tr}(H\\rho) = \\sum_{i=1}^{3} \\epsilon_i p_i\n$$\n第二项 $\\min_{U}\\,\\mathrm{Tr}(H U\\rho U^{\\dagger})$ 代表系统从态 $\\rho$ 出发，在幺正演化下所能达到的最小可能平均能量。令 $\\rho' = U\\rho U^{\\dagger}$。问题指出幺正变换是谱不变的，这意味着 $\\rho'$ 的本征值与 $\\rho$ 的本征值相同。由于 $\\rho$ 给定为对角形式，其对角元为 $p_1, p_2, p_3$，这些就是它的本征值（即 $\\rho$ 的谱）。\n\n我们需要找到与 $\\rho$ 具有相同本征值的态 $\\rho'$，使得平均能量 $\\mathrm{Tr}(H\\rho')$ 最小。根据重排不等式（特别是 von Neumann 迹不等式），对于两个厄米矩阵 $A$ 和 $B$，当它们的本征值以相反顺序配对时，迹 $\\mathrm{Tr}(AB)$ 达到最小值。在我们的情况下，我们希望最小化 $\\mathrm{Tr}(H\\rho')$。$H$ 的本征值为 $\\{\\epsilon_i\\}$，其顺序为 $\\epsilon_1  \\epsilon_2  \\epsilon_3$。设 $\\rho$ 的本征值（即布居数 $\\{p_i\\}$）按非递增顺序排序为：$p^{\\downarrow}_1 \\ge p^{\\downarrow}_2 \\ge p^{\\downarrow}_3$。\n\n当最大的布居数 ($p^{\\downarrow}_1$) 与最小的能级 ($\\epsilon_1$) 相关联，第二大的布居数 ($p^{\\downarrow}_2$) 与第二小的能级 ($\\epsilon_2$) 相关联，以此类推时，能量达到最小值。达到这个最小能量的态被称为与 $\\rho$ 相关联的被动态 $\\rho_{\\text{pass}}$。它在能量本征基下的形式是：\n$$\n\\rho_{\\text{pass}} = \\sum_{i=1}^{3} p^{\\downarrow}_i |E_i\\rangle\\langle E_i|\n$$\n因此，最小能量为：\n$$\nE_{\\text{final,min}} = \\mathrm{Tr}(H\\rho_{\\text{pass}}) = \\sum_{i=1}^{3} \\epsilon_i p^{\\downarrow}_i\n$$\n这个态是被动的，因为无法再从中提取功；它的布居数已经处于吉布斯序（随能量非递增），因此没有幺正操作可以降低其平均能量。将 $\\rho$ 变换为 $\\rho_{\\text{pass}}$ 的幺正操作 $U$ 是对能量本征态的一个置换，它将布居数 $p_i$ 重新排序为已排序的序列 $p^{\\downarrow}_i$。\n\n综合这些结果，ergotropy 是初始能量与相应被动态能量之差：\n$$\n\\mathcal{W}(\\rho) = \\mathrm{Tr}(H\\rho) - \\mathrm{Tr}(H\\rho_{\\text{pass}}) = \\left(\\sum_{i=1}^{3} \\epsilon_i p_i\\right) - \\left(\\sum_{i=1}^{3} \\epsilon_i p^{\\downarrow}_i\\right)\n$$\n这就是用 $\\rho$ 的谱（布居数集合 $\\{p_i\\}$）和能量本征值 $\\{\\epsilon_i\\}$ 表示的 ergotropy 的通用表达式。\n\n### 具体实例的计算\n我们有以下给定值：\n- 能量： $\\epsilon_1 = 0\\,\\text{J}$，$\\epsilon_2 = 3.0 \\times 10^{-21}\\,\\text{J}$，$\\epsilon_3 = 5.0 \\times 10^{-21}\\,\\text{J}$。\n- 初始布居数： $p_1 = 0.20$，$p_2 = 0.30$，$p_3 = 0.50$。\n\n首先，我们计算初始平均能量 $E_{\\text{initial}} = \\mathrm{Tr}(H\\rho)$：\n$$\nE_{\\text{initial}} = \\epsilon_1 p_1 + \\epsilon_2 p_2 + \\epsilon_3 p_3\n$$\n$$\nE_{\\text{initial}} = (0 \\times 0.20) + (3.0 \\times 10^{-21} \\times 0.30) + (5.0 \\times 10^{-21} \\times 0.50)\n$$\n$$\nE_{\\text{initial}} = 0 + 0.9 \\times 10^{-21} + 2.5 \\times 10^{-21} = 3.4 \\times 10^{-21}\\,\\text{J}\n$$\n接下来，我们确定布居数的被动排列。初始布居数为 $\\{p_1, p_2, p_3\\} = \\{0.20, 0.30, 0.50\\}$。将其按非递增顺序排序，得到被动态的布居数：\n$$\np^{\\downarrow}_1 = 0.50, \\quad p^{\\downarrow}_2 = 0.30, \\quad p^{\\downarrow}_3 = 0.20\n$$\n现在，我们计算被动态的能量 $E_{\\text{final,min}} = \\mathrm{Tr}(H\\rho_{\\text{pass}})$：\n$$\nE_{\\text{final,min}} = \\epsilon_1 p^{\\downarrow}_1 + \\epsilon_2 p^{\\downarrow}_2 + \\epsilon_3 p^{\\downarrow}_3\n$$\n$$\nE_{\\text{final,min}} = (0 \\times 0.50) + (3.0 \\times 10^{-21} \\times 0.30) + (5.0 \\times 10^{-21} \\times 0.20)\n$$\n$$\nE_{\\text{final,min}} = 0 + 0.9 \\times 10^{-21} + 1.0 \\times 10^{-21} = 1.9 \\times 10^{-21}\\,\\text{J}\n$$\n最后，ergotropy $\\mathcal{W}(\\rho)$ 是这两个能量之差：\n$$\n\\mathcal{W}(\\rho) = E_{\\text{initial}} - E_{\\text{final,min}} = (3.4 \\times 10^{-21}) - (1.9 \\times 10^{-21})\n$$\n$$\n\\mathcal{W}(\\rho) = 1.5 \\times 10^{-21}\\,\\text{J}\n$$",
            "answer": "$$\\boxed{1.5 \\times 10^{-21}}$$"
        },
        {
            "introduction": "虽然宏观热力学告诉我们，状态转换的方向是由自由能的减少决定的，但在量子领域，这一规则变得更为复杂。在热操作下，一个态到另一个态的转换受到一系列“第二定律”的制约，而不仅仅是标准自由能的减少。这个练习通过一个精心设计的思想实验，揭示了这一微妙之处：您将分析两个量子比特态，证明尽管标准自由能（与 $D_1$ 相对熵相关）降低了，但由于最大自由能（与 $D_\\infty$ 相对熵相关）的增加，从一个态到另一个态的转换实际上是被禁止的 。",
            "id": "3783486",
            "problem": "考虑一个双能级量子系统（量子比特），其哈密顿量为 $H = \\epsilon \\, |1\\rangle\\langle 1|$，逆温度为 $\\beta$。因此，吉布斯态为 $\\tau = \\frac{1}{Z} \\operatorname{diag}(1, \\exp(-\\beta \\epsilon))$，其中配分函数为 $Z = 1 + \\exp(-\\beta \\epsilon)$。为具体起见，取 $\\exp(-\\beta \\epsilon) = \\frac{1}{3}$，因此 $Z = \\frac{4}{3}$ 且 $\\tau = \\operatorname{diag}\\!\\left(\\frac{3}{4}, \\frac{1}{4}\\right)$。在热操作下的非热资源理论中，基于Rényi散度的广义自由能 $F_{\\alpha}(\\rho)$ 是单调量。对于能量本征基中的对角态，这些自由能可以通过经典Rényi散度 $D_{\\alpha}(\\mathbf{p} \\,\\|\\, \\mathbf{q})$ 来表征。特别地，标准非平衡自由能对应于Kullback–Leibler散度（相对熵）$D_{1}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\sum_{i} p_{i} \\ln\\!\\left(\\frac{p_{i}}{q_{i}}\\right)$，而最大自由能对应于最大相对散度 $D_{\\infty}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\ln\\!\\left(\\max_{i} \\frac{p_{i}}{q_{i}}\\right)$。由于 $F_{\\alpha}(\\rho)$ 与 $k_{B} T D_{\\alpha}(\\rho \\,\\|\\, \\tau)$ 仅相差一个与 $\\rho$ 无关的加法常数，比较 $F_{\\alpha}$ 等价于比较 $D_{\\alpha}$。\n\n你的任务是构造并分析一对对角量子比特态 $\\rho$ 和 $\\sigma$，它们在标准自由能减小的情况下，仍表现出状态转换的阻碍。具体来说，考虑对角态\n$$\n\\rho = \\operatorname{diag}\\!\\left(\\frac{4}{5}, \\frac{1}{5}\\right), \\qquad \\sigma = \\operatorname{diag}\\!\\left(\\frac{71}{100}, \\frac{29}{100}\\right),\n$$\n其中吉布斯态固定为 $\\tau = \\operatorname{diag}\\!\\left(\\frac{3}{4}, \\frac{1}{4}\\right)$。\n\n从上述吉布斯态和Rényi散度的基本定义出发，完成以下任务：\n\n1. 证明 $D_{1}(\\rho \\,\\|\\, \\tau) \\ge D_{1}(\\sigma \\,\\|\\, \\tau)$，从而确立 $F_{1}(\\rho) \\ge F_{1}(\\sigma)$，这与假设的转换 $\\rho \\to \\sigma$ 过程中标准自由能的减少是一致的。\n2. 证明 $D_{\\infty}(\\rho \\,\\|\\, \\tau)  D_{\\infty}(\\sigma \\,\\|\\, \\tau)$，从而确立 $F_{\\infty}(\\rho)  F_{\\infty}(\\sigma)$，这标志着由于最大自由能的增加，在热操作下该转换存在阻碍。\n3. 计算\n$$\n\\Delta \\equiv D_{\\infty}(\\sigma \\,\\|\\, \\tau) - D_{\\infty}(\\rho \\,\\|\\, \\tau).\n$$\n的精确闭式解值。\n\n将 $\\Delta$ 的最终结果表示为单个解析表达式。无需四舍五入，$\\Delta$ 也没有物理单位。",
            "solution": "首先将验证问题陈述，以确保其科学上成立、自洽且问题设定良好。\n\n### 步骤 1：提取已知条件\n- 系统：一个双能级量子系统（量子比特）。\n- 哈密顿量：$H = \\epsilon \\, |1\\rangle\\langle 1|$。\n- 逆温度：$\\beta$。\n- 吉布斯态：$\\tau = \\frac{1}{Z} \\operatorname{diag}(1, \\exp(-\\beta \\epsilon))$，其中 $Z = 1 + \\exp(-\\beta \\epsilon)$。\n- 吉布斯态的具体参数：$\\exp(-\\beta \\epsilon) = \\frac{1}{3}$。\n- 最终的吉布斯态：$\\tau = \\operatorname{diag}\\!\\left(\\frac{3}{4}, \\frac{1}{4}\\right)$。\n- 用于分析的状态：$\\rho = \\operatorname{diag}\\!\\left(\\frac{4}{5}, \\frac{1}{5}\\right)$ 和 $\\sigma = \\operatorname{diag}\\!\\left(\\frac{71}{100}, \\frac{29}{100}\\right)$。\n- 对于概率向量为 $\\mathbf{p}$ 和 $\\mathbf{q}$ 的对角态的定义：\n  - Kullback–Leibler散度：$D_{1}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\sum_{i} p_{i} \\ln\\!\\left(\\frac{p_{i}}{q_{i}}\\right)$。\n  - 最大相对散度：$D_{\\infty}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\ln\\!\\left(\\max_{i} \\frac{p_{i}}{q_{i}}\\right)$。\n- 任务：\n  1. 证明 $D_{1}(\\rho \\,\\|\\, \\tau) \\ge D_{1}(\\sigma \\,\\|\\, \\tau)$。\n  2. 证明 $D_{\\infty}(\\rho \\,\\|\\, \\tau)  D_{\\infty}(\\sigma \\,\\|\\, \\tau)$。\n  3. 计算 $\\Delta \\equiv D_{\\infty}(\\sigma \\,\\|\\, \\tau) - D_{\\infty}(\\rho \\,\\|\\, \\tau)$ 的精确值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题源于量子热力学领域，具体来说是非热资源理论。所有定义，如吉布斯态、Rényi散度及其与自由能的联系，都是标准的且陈述正确。状态 $\\rho$、$\\sigma$ 和 $\\tau$ 是有效的密度矩阵，因为它们的对角元非负且和为1。所提出的问题是精确的、数学性的，并导向一个唯一的、可验证的解。该问题是自洽的，为计算提供了所有必要信息。不同自由能单调量（$F_1$ 和 $F_\\infty$）对状态转换给出相互矛盾的条件，这种情况是该资源理论中一个已知且重要的特征，它说明了标准自由能的简单减少并不是在热操作下状态转变的充分条件。该问题没有科学或逻辑上的缺陷。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n***\n\n该问题要求对两个量子态 $\\rho$ 和 $\\sigma$ 相对于一个热平衡态 $\\tau$ 进行比较分析，使用两种不同的Rényi散度 $D_1$ 和 $D_\\infty$。由于这些状态在能量本征基中是对角的，问题简化为经典概率分布的比较。\n\n与密度矩阵的对角元相对应的概率分布为：\n- 对于 $\\rho$：$\\mathbf{p}_{\\rho} = \\left(\\frac{4}{5}, \\frac{1}{5}\\right) = (0.8, 0.2)$。\n- 对于 $\\sigma$：$\\mathbf{p}_{\\sigma} = \\left(\\frac{71}{100}, \\frac{29}{100}\\right) = (0.71, 0.29)$。\n- 对于吉布斯态 $\\tau$：$\\mathbf{q}_{\\tau} = \\left(\\frac{3}{4}, \\frac{1}{4}\\right) = (0.75, 0.25)$。\n\n### 1. $D_{1}(\\rho \\,\\|\\, \\tau)$ 和 $D_{1}(\\sigma \\,\\|\\, \\tau)$ 的比较\n\nKullback–Leibler散度由 $D_{1}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\sum_{i} p_{i} \\ln\\!\\left(\\frac{p_{i}}{q_{i}}\\right)$ 给出。\n\n对于状态 $\\rho$ 相对于 $\\tau$：\n$$\nD_{1}(\\rho \\,\\|\\, \\tau) = p_{\\rho,0} \\ln\\left(\\frac{p_{\\rho,0}}{q_{\\tau,0}}\\right) + p_{\\rho,1} \\ln\\left(\\frac{p_{\\rho,1}}{q_{\\tau,1}}\\right)\n= \\frac{4}{5} \\ln\\left(\\frac{4/5}{3/4}\\right) + \\frac{1}{5} \\ln\\left(\\frac{1/5}{1/4}\\right)\n= \\frac{4}{5} \\ln\\left(\\frac{16}{15}\\right) + \\frac{1}{5} \\ln\\left(\\frac{4}{5}\\right).\n$$\n\n对于状态 $\\sigma$ 相对于 $\\tau$：\n$$\nD_{1}(\\sigma \\,\\|\\, \\tau) = p_{\\sigma,0} \\ln\\left(\\frac{p_{\\sigma,0}}{q_{\\tau,0}}\\right) + p_{\\sigma,1} \\ln\\left(\\frac{p_{\\sigma,1}}{q_{\\tau,1}}\\right)\n= \\frac{71}{100} \\ln\\left(\\frac{71/100}{3/4}\\right) + \\frac{29}{100} \\ln\\left(\\frac{29/100}{1/4}\\right)\n= \\frac{71}{100} \\ln\\left(\\frac{284}{300}\\right) + \\frac{29}{100} \\ln\\left(\\frac{116}{100}\\right)\n= \\frac{71}{100} \\ln\\left(\\frac{71}{75}\\right) + \\frac{29}{100} \\ln\\left(\\frac{29}{25}\\right).\n$$\n\n要证明 $D_{1}(\\rho \\,\\|\\, \\tau) \\ge D_{1}(\\sigma \\,\\|\\, \\tau)$，对这些对数表达式进行直接的解析比较是高度复杂的。然而，我们可以分析相对熵函数的行为。相对熵 $D_1(\\mathbf{p} \\| \\mathbf{q})$ 是 $\\mathbf{p}$ 的一个凸函数，其唯一的最小值0在 $\\mathbf{p}=\\mathbf{q}$ 处取得。对于这个双能级系统，分布由基态概率来表征：$p_{\\rho,0} = 0.8$，$p_{\\sigma,0} = 0.71$，以及 $q_{\\tau,0} = 0.75$。\n这些概率与热平衡概率的距离为：\n$|p_{\\rho,0} - q_{\\tau,0}| = |0.8 - 0.75| = 0.05$。\n$|p_{\\sigma,0} - q_{\\tau,0}| = |0.71 - 0.75| = 0.04$。\n由于 $p_{\\rho,0}$ 比 $p_{\\sigma,0}$ 离最小值 $q_{\\tau,0}$ 更远，预期 $D_{1}(\\rho \\,\\|\\, \\tau) > D_{1}(\\sigma \\,\\|\\, \\tau)$。为了证实这一点，我们进行数值计算：\n$$\nD_{1}(\\rho \\,\\|\\, \\tau) = \\frac{4}{5} \\ln\\left(\\frac{16}{15}\\right) + \\frac{1}{5} \\ln\\left(\\frac{4}{5}\\right) \\approx 0.8 \\times (0.0645385) + 0.2 \\times (-0.2231435) \\approx 0.0516308 - 0.0446287 = 0.0070021.\n$$\n$$\nD_{1}(\\sigma \\,\\|\\, \\tau) = \\frac{71}{100} \\ln\\left(\\frac{71}{75}\\right) + \\frac{29}{100} \\ln\\left(\\frac{29}{25}\\right) \\approx 0.71 \\times (-0.0548120) + 0.29 \\times (0.1484200) \\approx -0.0389165 + 0.0430418 = 0.0041253.\n$$\n由于 $0.0070021 > 0.0041253$，我们证明了 $D_{1}(\\rho \\,\\|\\, \\tau) > D_{1}(\\sigma \\,\\|\\, \\tau)$，这意味着 $F_1(\\rho) > F_1(\\sigma)$。\n\n### 2. $D_{\\infty}(\\rho \\,\\|\\, \\tau)$ 和 $D_{\\infty}(\\sigma \\,\\|\\, \\tau)$ 的比较\n\n最大相对散度由 $D_{\\infty}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\ln\\!\\left(\\max_{i} \\frac{p_{i}}{q_{i}}\\right)$ 给出。\n\n对于状态 $\\rho$ 相对于 $\\tau$，我们计算比率 $\\frac{p_{\\rho,i}}{q_{\\tau,i}}$：\n$$\n\\frac{p_{\\rho,0}}{q_{\\tau,0}} = \\frac{4/5}{3/4} = \\frac{16}{15}, \\qquad \\frac{p_{\\rho,1}}{q_{\\tau,1}} = \\frac{1/5}{1/4} = \\frac{4}{5}.\n$$\n最大比率为 $\\max\\left(\\frac{16}{15}, \\frac{4}{5}\\right) = \\max\\left(\\frac{16}{15}, \\frac{12}{15}\\right) = \\frac{16}{15}$。\n因此，$D_{\\infty}(\\rho \\,\\|\\, \\tau) = \\ln\\left(\\frac{16}{15}\\right)$。\n\n对于状态 $\\sigma$ 相对于 $\\tau$，我们计算比率 $\\frac{p_{\\sigma,i}}{q_{\\tau,i}}$：\n$$\n\\frac{p_{\\sigma,0}}{q_{\\tau,0}} = \\frac{71/100}{3/4} = \\frac{71 \\times 4}{100 \\times 3} = \\frac{284}{300} = \\frac{71}{75}.\n$$\n$$\n\\frac{p_{\\sigma,1}}{q_{\\tau,1}} = \\frac{29/100}{1/4} = \\frac{29 \\times 4}{100} = \\frac{116}{100} = \\frac{29}{25}.\n$$\n最大比率为 $\\max\\left(\\frac{71}{75}, \\frac{29}{25}\\right) = \\max\\left(\\frac{71}{75}, \\frac{3 \\times 29}{3 \\times 25}\\right) = \\max\\left(\\frac{71}{75}, \\frac{87}{75}\\right) = \\frac{87}{75} = \\frac{29}{25}$。\n因此，$D_{\\infty}(\\sigma \\,\\|\\, \\tau) = \\ln\\left(\\frac{29}{25}\\right)$。\n\n要证明 $D_{\\infty}(\\rho \\,\\|\\, \\tau)  D_{\\infty}(\\sigma \\,\\|\\, \\tau)$，我们比较它们的自变量，因为当 $x>0$ 时，$\\ln(x)$ 是一个严格递增的函数：\n我们比较 $\\frac{16}{15}$ 和 $\\frac{29}{25}$。\n我们找一个公分母，即 $75$：\n$$\n\\frac{16}{15} = \\frac{16 \\times 5}{15 \\times 5} = \\frac{80}{75}.\n$$\n$$\n\\frac{29}{25} = \\frac{29 \\times 3}{25 \\times 3} = \\frac{87}{75}.\n$$\n由于 $\\frac{80}{75}  \\frac{87}{75}$，因此 $\\frac{16}{15}  \\frac{29}{25}$。\n因此，$\\ln\\left(\\frac{16}{15}\\right)  \\ln\\left(\\frac{29}{25}\\right)$，这证明了 $D_{\\infty}(\\rho \\,\\|\\, \\tau)  D_{\\infty}(\\sigma \\,\\|\\, \\tau)$。这意味着 $F_\\infty(\\rho)  F_\\infty(\\sigma)$，这是在热操作下转换 $\\rho \\to \\sigma$ 的一个阻碍。\n\n### 3. $\\Delta$ 的计算\n\n我们被要求计算 $\\Delta = D_{\\infty}(\\sigma \\,\\|\\, \\tau) - D_{\\infty}(\\rho \\,\\|\\, \\tau)$ 的精确闭式解值。\n使用上一节的结果：\n$$\n\\Delta = \\ln\\left(\\frac{29}{25}\\right) - \\ln\\left(\\frac{16}{15}\\right).\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\n\\Delta = \\ln\\left(\\frac{29/25}{16/15}\\right) = \\ln\\left(\\frac{29}{25} \\times \\frac{15}{16}\\right).\n$$\n化简分数：\n$$\n\\Delta = \\ln\\left(\\frac{29 \\times (3 \\times 5)}{(5 \\times 5) \\times 16}\\right) = \\ln\\left(\\frac{29 \\times 3}{5 \\times 16}\\right) = \\ln\\left(\\frac{87}{80}\\right).\n$$\n这就是 $\\Delta$ 的精确闭式解值。",
            "answer": "$$\n\\boxed{\\ln\\left(\\frac{87}{80}\\right)}\n$$"
        },
        {
            "introduction": "将抽象理论与可验证的物理定律联系起来是理论物理学的基石。这个实践练习将引导您进入计算量子物理学的世界，通过对一个被驱动的量子比特系统进行数值模拟，来验证现代非平衡统计力学中的两个基石——Jarzynski 等式和 Crooks 涨落定理。您将从第一性原理出发，构建正向和逆向过程中的功分布，并亲眼见证非平衡功的涨落如何与平衡态的自由能差异精确地联系在一起 。这个练习不仅能加深您对功、热和自由能的理解，还能锻炼您将理论模型转化为可执行代码的宝贵技能。",
            "id": "3783444",
            "problem": "考虑一个单量子比特，在两点测量（TPM）方案中受到两个哈密顿量之间的幺正驱动，其中TPM代表两点测量。协议开始时的初始状态是初始哈密顿量在逆温度 $\\beta$ 下的吉布斯热态。该设置是无热性资源理论中的一个典型模型，其中吉布斯态是自由态，幺正驱动产生可通过非平衡功涨落来量化的无热性。\n\n使用以下物理上一致的模型：\n\n- 泡利矩阵为 $\\,\\sigma_x = \\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix}\\,$, $\\,\\sigma_y = \\begin{pmatrix}0  -i \\\\ i  0\\end{pmatrix}\\,$, 和 $\\,\\sigma_z = \\begin{pmatrix}1  0 \\\\ 0  -1\\end{pmatrix}\\,$.\n- 初始哈密顿量为 $\\,H_i = \\frac{\\Delta_i}{2}\\,\\sigma_z\\,$, 间隙参数 $\\,\\Delta_i  0\\,$.\n- 最终哈密顿量为 $\\,H_f = \\frac{\\Delta_f}{2}\\big(\\cos\\varphi\\,\\sigma_z + \\sin\\varphi\\,\\sigma_x\\big)\\,$, 间隙参数 $\\,\\Delta_f  0\\,$ 且布洛赫角 $\\,\\varphi \\in \\mathbb{R}\\,$.\n- 实现驱动协议的幺正算符是绕 $y$ 轴的旋转 $\\,U(\\theta) = e^{-i\\,\\theta\\,\\sigma_y/2} = \\cos\\!\\big(\\frac{\\theta}{2}\\big)\\,\\mathbb{I} - i\\,\\sin\\!\\big(\\frac{\\theta}{2}\\big)\\,\\sigma_y\\,$, 旋转角 $\\,\\theta \\in \\mathbb{R}\\,$.\n\n在TPM协议下：\n- 开始时，对 $\\,H_i\\,$ 进行投影测量。测量结果 $\\,E_n^i\\,$ 使状态塌缩到相应的本征矢量 $\\,\\lvert n^i\\rangle\\,$，并以由 $\\,\\beta\\,$ 和 $\\,H_i\\,$ 决定的吉布斯概率发生。\n- 用 $\\,U(\\theta)\\,$ 演化状态。\n- 对 $\\,H_f\\,$ 进行投影测量，得到结果 $\\,E_m^f\\,$, 对应于本征矢量 $\\,\\lvert m^f\\rangle\\,$.\n- 正向功值为 $\\,W = E_m^f - E_n^i\\,$. 正向功分布支撑在这些差值的离散集合上。\n- 反向协议从 $\\,H_f\\,$ 的吉布斯态开始，测量 $\\,H_f\\,$, 通过 $\\,U(\\theta)^\\dagger\\,$ 演化，测量 $\\,H_i\\,$, 并指定反向功 $\\,W_\\mathrm{rev} = E_n^i - E_m^f = -W\\,$. 反向功分布支撑在正向差值的负值集合上。\n\n根据上述基本定义（吉布斯态、投影测量与塌缩、玻恩定则、幺正演化），实现正向和反向功分布，并数值评估与TPM相关的非平衡涨落关系。具体来说，对于每个测试用例：\n- 构建正向和反向功值的分布，并计算正向分布上 $\\,e^{-\\beta W}\\,$ 的系综平均值。\n- 根据在逆温度 $\\,\\beta\\,$ 下 $\\,H_i\\,$ 和 $\\,H_f\\,$ 的配分函数 $\\,Z_i\\,$ 和 $\\,Z_f\\,$，计算平衡自由能差 $\\,\\Delta F\\,$.\n- 对于 Crooks 型比率测试，对每个支撑的功值 $\\,W\\,$, 评估功为 $\\,W\\,$ 的正向概率与功为 $\\,{-W}\\,$ 的反向概率之比，并与TPM涨落关系所蕴含的平衡预测进行比较。汇总该测试用例中所有支撑的正向功值的最大绝对偏差。\n- 对于 Jarzynski 型指数平均测试，计算 $\\,e^{-\\beta W}\\,$ 的正向系综平均值与TPM涨落关系所蕴含的平衡预测之间的绝对偏差。\n\n对于每个测试用例，你的程序必须返回一个列表 $[d_J, d_C, J_\\mathrm{ok}, C_\\mathrm{ok}]$，其中包含：\n- $d_J$：Jarzynski 型测试中的绝对偏差，为浮点数。\n- $d_C$：Crooks 型比率测试中的最大绝对偏差，为浮点数。\n- $J_\\mathrm{ok}$：一个布尔值，如果 $d_J \\leq 10^{-10}$ 则为真，否则为假。\n- $C_\\mathrm{ok}$：一个布尔值，如果 $d_C \\leq 10^{-10}$ 则为真，否则为假。\n\n不需要进行物理单位转换，因为所有输出都是无量纲的偏差和布尔值。\n\n用于覆盖一般行为和边缘条件的测试套件参数集：\n1. $\\beta = 0.7$, $\\Delta_i = 1.0$, $\\Delta_f = 1.3$, $\\varphi = 0.4$, $\\theta = 0.6$.\n2. $\\beta = 5.0$, $\\Delta_i = 1.5$, $\\Delta_f = 0.8$, $\\varphi = 1.0$, $\\theta = \\frac{\\pi}{2}$.\n3. $\\beta = 0.05$, $\\Delta_i = 1.0$, $\\Delta_f = 2.0$, $\\varphi = 0.2$, $\\theta = 0.3$.\n4. $\\beta = 1.2$, $\\Delta_i = 1.0$, $\\Delta_f = 1.0$, $\\varphi = 0.0$, $\\theta = 0.0$.\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果按测试套件的相同顺序列为一个四元素子列表。例如，输出格式必须类似于“[[result_case1],[result_case2],[result_case3],[result_case4]]”，布尔值应直接打印为“True”或“False”。",
            "solution": "该问题要求在两点测量（TPM）框架内对一个受驱动的两能级量子系统（一个量子比特）进行彻底分析，以验证 Jarzynski 和 Crooks 涨落关系。解决方案的步骤是：首先确定初始和最终哈密顿量的本征系统，然后计算正向和反向协议的功分布，最后计算与涨落关系的指定偏差。\n\n步骤 1：哈密顿量的本征系统\n\n初始哈密顿量由 $H_i = \\frac{\\Delta_i}{2}\\,\\sigma_z$ 给出。其矩阵形式为：\n$$\nH_i = \\frac{\\Delta_i}{2} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n本征值为 $E_{e,i} = +\\frac{\\Delta_i}{2}$ 和 $E_{g,i} = -\\frac{\\Delta_i}{2}$。相应的本征矢量是标准计算基态：\n$$\n\\lvert e^i \\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\quad , \\quad \\lvert g^i \\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\n最终哈密顿量为 $H_f = \\frac{\\Delta_f}{2}\\big(\\cos\\varphi\\,\\sigma_z + \\sin\\varphi\\,\\sigma_x\\big)$。其矩阵形式为：\n$$\nH_f = \\frac{\\Delta_f}{2} \\begin{pmatrix} \\cos\\varphi  \\sin\\varphi \\\\ \\sin\\varphi  -\\cos\\varphi \\end{pmatrix}\n$$\n此哈密顿量与一个从 $z$ 轴向 $x$ 轴旋转角度 $\\varphi$ 的泡利矢量成正比。其本征值与此旋转无关，由 $E_{e,f} = +\\frac{\\Delta_f}{2}$ 和 $E_{g,f} = -\\frac{\\Delta_f}{2}$ 给出。通过求解本征值方程可以找到相应的本征矢量。它们是：\n$$\n\\lvert e^f \\rangle = \\begin{pmatrix} \\cos(\\varphi/2) \\\\ \\sin(\\varphi/2) \\end{pmatrix} \\quad , \\quad \\lvert g^f \\rangle = \\begin{pmatrix} -\\sin(\\varphi/2) \\\\ \\cos(\\varphi/2) \\end{pmatrix}\n$$\n\n步骤 2：配分函数和自由能差\n\n一个具有哈密顿量 $H$ 的系统在逆温度 $\\beta$ 下的配分函数是 $Z = \\text{Tr}(e^{-\\beta H}) = \\sum_k e^{-\\beta E_k}$。\n对于初始系统：\n$$\nZ_i = e^{-\\beta E_{g,i}} + e^{-\\beta E_{e,i}} = e^{\\beta \\Delta_i / 2} + e^{-\\beta \\Delta_i / 2} = 2 \\cosh\\left(\\frac{\\beta \\Delta_i}{2}\\right)\n$$\n对于最终系统：\n$$\nZ_f = e^{-\\beta E_{g,f}} + e^{-\\beta E_{e,f}} = e^{\\beta \\Delta_f / 2} + e^{-\\beta \\Delta_f / 2} = 2 \\cosh\\left(\\frac{\\beta \\Delta_f}{2}\\right)\n$$\n平衡自由能差为 $\\Delta F = F_f - F_i = -\\frac{1}{\\beta} \\ln(Z_f) - (-\\frac{1}{\\beta} \\ln(Z_i)) = -\\frac{1}{\\beta} \\ln\\left(\\frac{Z_f}{Z_i}\\right)$。\n\n步骤 3：幺正演化和跃迁概率\n\n幺正演化是绕 $y$ 轴的旋转，$U(\\theta) = e^{-i\\,\\theta\\,\\sigma_y/2}$，其矩阵表示为：\n$$\nU(\\theta) = \\cos(\\theta/2)\\,\\mathbb{I} - i\\,\\sin(\\theta/2)\\,\\sigma_y = \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix}\n$$\nTPM协议的核心是在幺正演化 $U(\\theta)$ 之后，从一个初始能量本征态 $\\lvert n^i \\rangle$ 跃迁到一个最终能量本征态 $\\lvert m^f \\rangle$ 的概率。这由玻恩定则给出：$p(m|n) = |\\langle m^f | U(\\theta) | n^i \\rangle|^2$。\n让我们计算四个跃迁振幅：\n- $\\langle g^f | U(\\theta) | g^i \\rangle = \\begin{pmatrix} -\\sin(\\varphi/2)  \\cos(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\cos(\\varphi/2)\\cos(\\theta/2) + \\sin(\\varphi/2)\\sin(\\theta/2) = \\cos\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $\\langle e^f | U(\\theta) | g^i \\rangle = \\begin{pmatrix} \\cos(\\varphi/2)  \\sin(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\sin(\\varphi/2)\\cos(\\theta/2) - \\cos(\\varphi/2)\\sin(\\theta/2) = \\sin\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $\\langle g^f | U(\\theta) | e^i \\rangle = \\begin{pmatrix} -\\sin(\\varphi/2)  \\cos(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\cos(\\varphi/2)\\sin(\\theta/2) - \\sin(\\varphi/2)\\cos(\\theta/2) = -\\sin\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $\\langle e^f | U(\\theta) | e^i \\rangle = \\begin{pmatrix} \\cos(\\varphi/2)  \\sin(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\cos(\\varphi/2)\\cos(\\theta/2) + \\sin(\\varphi/2)\\sin(\\theta/2) = \\cos\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n\n跃迁概率是这些振幅的平方：\n- $p(g \\to g) = |\\langle g^f | U | g^i \\rangle|^2 = \\cos^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $p(g \\to e) = |\\langle e^f | U | g^i \\rangle|^2 = \\sin^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $p(e \\to g) = |\\langle g^f | U | e^i \\rangle|^2 = \\sin^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $p(e \\to e) = |\\langle e^f | U | e^i \\rangle|^2 = \\cos^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n\n步骤 4：正向和反向功分布\n\n在正向协议中，系统最初处于 $H_i$ 的吉布斯态。测量到状态为 $\\lvert n^i \\rangle$（能量为 $E_n^i$）的概率是 $p_n^i = e^{-\\beta E_n^i} / Z_i$。功输出 $W = E_m^f - E_n^i$ 的总概率是 $P_{fwd}(W) = \\sum_{n,m:E_m^f-E_n^i=W} p(m|n) p_n^i$。四种可能的功值及其概率是：\n- $W_{g \\to g} = E_{g,f} - E_{g,i} = \\frac{\\Delta_i - \\Delta_f}{2}$，概率为 $p(g \\to g) \\cdot (e^{\\beta \\Delta_i/2}/Z_i)$\n- $W_{g \\to e} = E_{e,f} - E_{g,i} = \\frac{\\Delta_i + \\Delta_f}{2}$，概率为 $p(g \\to e) \\cdot (e^{\\beta \\Delta_i/2}/Z_i)$\n- $W_{e \\to g} = E_{g,f} - E_{e,i} = -\\frac{\\Delta_i + \\Delta_f}{2}$，概率为 $p(e \\to g) \\cdot (e^{-\\beta \\Delta_i/2}/Z_i)$\n- $W_{e \\to e} = E_{e,f} - E_{e,i} = \\frac{\\Delta_f - \\Delta_i}{2}$，概率为 $p(e \\to e) \\cdot (e^{-\\beta \\Delta_i/2}/Z_i)$\n\n在反向协议中，系统从 $H_f$ 的吉布斯态开始，在 $U(\\theta)^\\dagger$ 下演化，并在 $H_i$ 的基下进行测量。反向功为 $W_{\\mathrm{rev}} = E_n^i - E_m^f = -W$。在 $U(\\theta)^\\dagger$ 下从 $\\lvert m^f \\rangle$ 跃迁到 $\\lvert n^i \\rangle$ 的概率是 $p(n|m)_{\\mathrm{rev}} = |\\langle n^i | U^\\dagger | m^f \\rangle|^2 = |\\langle m^f | U | n^i \\rangle|^2 = p(m|n)$。反向功分布为 $P_{\\mathrm{rev}}(W_{\\mathrm{rev}}) = \\sum_{n,m:E_n^i-E_m^f=W_{\\mathrm{rev}}} p(n|m)_{\\mathrm{rev}} \\cdot (e^{-\\beta E_m^f}/Z_f)$。\n\n步骤 5：非平衡涨落关系测试\n\nJarzynski 等式表述为 $\\langle e^{-\\beta W} \\rangle_{fwd} = e^{-\\beta \\Delta F}$。左侧通过对正向功分布进行平均来计算：\n$$\n\\langle e^{-\\beta W} \\rangle_{fwd} = \\sum_W P_{fwd}(W) e^{-\\beta W}\n$$\n右侧为 $e^{-\\beta \\Delta F} = e^{\\ln(Z_f/Z_i)} = Z_f/Z_i$。Jarzynski 偏差为 $d_J = \\left| \\langle e^{-\\beta W} \\rangle_{fwd} - Z_f/Z_i \\right|$。\n\nCrooks 涨落定理关联了正向和反向的功-概率分布：\n$$\n\\frac{P_{fwd}(W)}{P_{rev}(-W)} = e^{\\beta(W - \\Delta F)}\n$$\n对于分布支撑集中的任何功值 $W$，此关系是精确的。Crooks 偏差 $d_C$ 是在所有可能的正向功值上与此等式的最大绝对偏差。对于 $P_{fwd}$ 支撑集中的每个 $W_k$，我们计算偏差 $\\left| \\frac{P_{fwd}(W_k)}{P_{rev}(-W_k)} - e^{\\beta(W_k - \\Delta F)} \\right|$，$d_C$ 是这些值的最大值。由于这些关系是精确的，除了数值浮点精度误差外，$d_J$ 和 $d_C$ 都应为零。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum work fluctuation problem for a driven qubit.\n    \"\"\"\n\n    test_cases = [\n        {'beta': 0.7, 'delta_i': 1.0, 'delta_f': 1.3, 'phi': 0.4, 'theta': 0.6},\n        {'beta': 5.0, 'delta_i': 1.5, 'delta_f': 0.8, 'phi': 1.0, 'theta': np.pi / 2},\n        {'beta': 0.05, 'delta_i': 1.0, 'delta_f': 2.0, 'phi': 0.2, 'theta': 0.3},\n        {'beta': 1.2, 'delta_i': 1.0, 'delta_f': 1.0, 'phi': 0.0, 'theta': 0.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(calculate_fluctuation_relations(**params))\n\n    # Format the final output string\n    # e.g., [[0.0, 0.0, True, True],[...]]\n    formatted_results = []\n    for res in results:\n        # Format: [d_J, d_C, J_ok, C_ok]\n        d_J_str = f\"{res[0]:.16e}\"\n        d_C_str = f\"{res[1]:.16e}\" \n        J_ok_str = str(res[2])\n        C_ok_str = str(res[3])\n        formatted_results.append(f\"[{d_J_str},{d_C_str},{J_ok_str},{C_ok_str}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_fluctuation_relations(beta, delta_i, delta_f, phi, theta):\n    \"\"\"\n    Calculates the deviations for Jarzynski and Crooks relations for a single test case.\n\n    Args:\n        beta (float): Inverse temperature.\n        delta_i (float): Gap of the initial Hamiltonian.\n        delta_f (float): Gap of the final Hamiltonian.\n        phi (float): Bloch-angle for the final Hamiltonian.\n        theta (float): Rotation angle for the unitary driving.\n\n    Returns:\n        list: A list [d_J, d_C, J_ok, C_ok] containing the results.\n    \"\"\"\n    # Step 1: Eigensystems\n    # Energies are denoted as Ei_g, Ei_e for ground and excited states of H_i\n    Ei_g, Ei_e = -delta_i / 2.0, delta_i / 2.0\n    Ef_g, Ef_e = -delta_f / 2.0, delta_f / 2.0\n\n    # Step 2: Partition functions and free energy\n    Zi = 2.0 * np.cosh(beta * delta_i / 2.0)\n    Zf = 2.0 * np.cosh(beta * delta_f / 2.0)\n    \n    if beta == 0:\n        delta_F = 0\n    else:\n        delta_F = -1.0/beta * np.log(Zf / Zi)\n\n    # Step 3: Transition probabilities\n    angle_diff_half = (phi - theta) / 2.0\n    \n    p_g2g = np.cos(angle_diff_half)**2\n    p_g2e = np.sin(angle_diff_half)**2\n    p_e2g = p_g2e\n    p_e2e = p_g2g\n    \n    # Step 4: Work distributions\n    p_gi = np.exp(-beta * Ei_g) / Zi\n    p_ei = np.exp(-beta * Ei_e) / Zi\n    \n    p_gf = np.exp(-beta * Ef_g) / Zf\n    p_ef = np.exp(-beta * Ef_e) / Zf\n    \n    fwd_work_dist = {}\n    transitions = [\n        (Ei_g, Ef_g, p_gi, p_g2g),\n        (Ei_g, Ef_e, p_gi, p_g2e),\n        (Ei_e, Ef_g, p_ei,p_e2g),\n        (Ei_e, Ef_e, p_ei, p_e2e),\n    ]\n    for E_start, E_end, p_initial, p_trans in transitions:\n        W = E_end - E_start\n        prob = p_trans * p_initial\n        fwd_work_dist[W] = fwd_work_dist.get(W, 0) + prob\n\n    rev_work_dist = {}\n    rev_transitions = [\n        (Ef_g, Ei_g, p_gf, p_g2g),\n        (Ef_g, Ei_e, p_gf, p_e2g),\n        (Ef_e, Ei_g, p_ef, p_g2e),\n        (Ef_e, Ei_e, p_ef, p_e2e),\n    ]\n    for E_start, E_end, p_initial, p_trans in rev_transitions:\n        W_rev = E_end - E_start\n        prob = p_trans * p_initial\n        rev_work_dist[W_rev] = rev_work_dist.get(W_rev, 0) + prob\n        \n    # Step 5: Fluctuation relation tests\n    \n    # Jarzynski test\n    jarzynski_avg = sum(p * np.exp(-beta * W) for W, p in fwd_work_dist.items())\n    jarzynski_pred = Zf / Zi\n    d_J = float(np.abs(jarzynski_avg - jarzynski_pred))\n    \n    # Crooks test\n    crooks_devs = []\n    \n    for W, P_fwd in fwd_work_dist.items():\n        if P_fwd > 1e-15:\n            P_rev_at_minus_W = rev_work_dist.get(-W, 0.0)\n            \n            if P_rev_at_minus_W > 1e-15:\n                ratio = P_fwd / P_rev_at_minus_W\n                prediction = np.exp(beta * (W - delta_F))\n                crooks_devs.append(np.abs(ratio - prediction))\n            else:\n                  crooks_devs.append(0.0)\n\n    d_C = float(max(crooks_devs)) if crooks_devs else 0.0\n\n    # Verdicts\n    tol = 1e-10\n    J_ok = d_J = tol\n    C_ok = d_C = tol\n    \n    return [d_J, d_C, J_ok, C_ok]\n\n\nif __name__ == '__main__':\n    solve()\n\n```",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum work fluctuation problem for a driven qubit.\n    \"\"\"\n\n    test_cases = [\n        {'beta': 0.7, 'delta_i': 1.0, 'delta_f': 1.3, 'phi': 0.4, 'theta': 0.6},\n        {'beta': 5.0, 'delta_i': 1.5, 'delta_f': 0.8, 'phi': 1.0, 'theta': np.pi / 2},\n        {'beta': 0.05, 'delta_i': 1.0, 'delta_f': 2.0, 'phi': 0.2, 'theta': 0.3},\n        {'beta': 1.2, 'delta_i': 1.0, 'delta_f': 1.0, 'phi': 0.0, 'theta': 0.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(calculate_fluctuation_relations(**params))\n\n    # Format the final output string\n    # e.g., [[0.0, 0.0, True, True],[...]]\n    formatted_results = []\n    for res in results:\n        # Format: [d_J, d_C, J_ok, C_ok]\n        d_J_str = f\"{res[0]:.16e}\"\n        d_C_str = f\"{res[1]:.16e}\" \n        J_ok_str = str(res[2])\n        C_ok_str = str(res[3])\n        formatted_results.append(f\"[{d_J_str},{d_C_str},{J_ok_str},{C_ok_str}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_fluctuation_relations(beta, delta_i, delta_f, phi, theta):\n    \"\"\"\n    Calculates the deviations for Jarzynski and Crooks relations for a single test case.\n\n    Args:\n        beta (float): Inverse temperature.\n        delta_i (float): Gap of the initial Hamiltonian.\n        delta_f (float): Gap of the final Hamiltonian.\n        phi (float): Bloch-angle for the final Hamiltonian.\n        theta (float): Rotation angle for the unitary driving.\n\n    Returns:\n        list: A list [d_J, d_C, J_ok, C_ok] containing the results.\n    \"\"\"\n    # Step 1: Eigensystems\n    # Energies are denoted as Ei_g, Ei_e for ground and excited states of H_i\n    Ei_g, Ei_e = -delta_i / 2.0, delta_i / 2.0\n    Ef_g, Ef_e = -delta_f / 2.0, delta_f / 2.0\n\n    # Step 2: Partition functions and free energy\n    Zi = 2.0 * np.cosh(beta * delta_i / 2.0)\n    Zf = 2.0 * np.cosh(beta * delta_f / 2.0)\n    \n    if beta == 0:\n        delta_F = 0\n    else:\n        delta_F = -1.0/beta * np.log(Zf / Zi)\n\n    # Step 3: Transition probabilities\n    angle_diff_half = (phi - theta) / 2.0\n    \n    p_g2g = np.cos(angle_diff_half)**2\n    p_g2e = np.sin(angle_diff_half)**2\n    p_e2g = p_g2e\n    p_e2e = p_g2g\n    \n    # Step 4: Work distributions\n    p_gi = np.exp(-beta * Ei_g) / Zi\n    p_ei = np.exp(-beta * Ei_e) / Zi\n    \n    p_gf = np.exp(-beta * Ef_g) / Zf\n    p_ef = np.exp(-beta * Ef_e) / Zf\n    \n    fwd_work_dist = {}\n    transitions = [\n        (Ei_g, Ef_g, p_gi, p_g2g),\n        (Ei_g, Ef_e, p_gi, p_g2e),\n        (Ei_e, Ef_g, p_ei,p_e2g),\n        (Ei_e, Ef_e, p_ei, p_e2e),\n    ]\n    for E_start, E_end, p_initial, p_trans in transitions:\n        W = E_end - E_start\n        prob = p_trans * p_initial\n        fwd_work_dist[W] = fwd_work_dist.get(W, 0) + prob\n\n    rev_work_dist = {}\n    rev_transitions = [\n        (Ef_g, Ei_g, p_gf, p_g2g),\n        (Ef_g, Ei_e, p_gf, p_e2g),\n        (Ef_e, Ei_g, p_ef, p_g2e),\n        (Ef_e, Ei_e, p_ef, p_e2e),\n    ]\n    for E_start, E_end, p_initial, p_trans in rev_transitions:\n        W_rev = E_end - E_start\n        prob = p_trans * p_initial\n        rev_work_dist[W_rev] = rev_work_dist.get(W_rev, 0) + prob\n        \n    # Step 5: Fluctuation relation tests\n    \n    # Jarzynski test\n    jarzynski_avg = sum(p * np.exp(-beta * W) for W, p in fwd_work_dist.items())\n    jarzynski_pred = Zf / Zi\n    d_J = float(np.abs(jarzynski_avg - jarzynski_pred))\n    \n    # Crooks test\n    crooks_devs = []\n    \n    for W, P_fwd in fwd_work_dist.items():\n        if P_fwd > 1e-15:\n            P_rev_at_minus_W = rev_work_dist.get(-W, 0.0)\n            \n            if P_rev_at_minus_W > 1e-15:\n                ratio = P_fwd / P_rev_at_minus_W\n                prediction = np.exp(beta * (W - delta_F))\n                crooks_devs.append(np.abs(ratio - prediction))\n            else:\n                  crooks_devs.append(0.0)\n\n    d_C = float(max(crooks_devs)) if crooks_devs else 0.0\n\n    # Verdicts\n    tol = 1e-10\n    J_ok = d_J = tol\n    C_ok = d_C = tol\n    \n    return [d_J, d_C, J_ok, C_ok]\n\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}