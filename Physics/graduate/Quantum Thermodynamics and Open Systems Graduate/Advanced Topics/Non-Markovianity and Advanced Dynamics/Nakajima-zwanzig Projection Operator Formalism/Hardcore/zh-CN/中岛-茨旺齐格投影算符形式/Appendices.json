{
    "hands_on_practices": [
        {
            "introduction": "Nakajima-Zwanzig (NZ) 方程的核心是记忆核，它由浴的关联函数决定。本练习将引导你分解动力学的引擎——刘维尔超算符，并为一个普遍存在的自旋-玻色子模型计算一个关键的零温浴关联函数。掌握这项基本计算是在实践中应用 NZ 形式主义的第一步 。",
            "id": "3773540",
            "problem": "考虑一个由系统 $S$ 和浴 $B$ 组成的二分量子系统，其总哈密顿量为 $H = H_{S} + H_{B} + H_{SB}$，单位制为 $\\hbar = 1$。定义刘维尔（对易子）超算符 $L$ 通过其对任意算符 $A$ 的作用为 $LA = [H, A]$，并类似地定义 $L_{S} A = [H_{S}, A]$，$L_{B} A = [H_{B}, A]$ 以及 $L_{SB} A = [H_{SB}, A]$。\n\n第1部分：从刘维尔算符和对易子的基本定义出发，用 $L_{S}$、$L_{B}$ 和 $L_{SB}$ 表示 $L$，并以适用于对 $L_{SB}$ 进行微扰展开的方式分析对易关系 $[L_{S}, L_{B}]$ 和 $[L_{S} + L_{B}, L_{SB}]$。明确地将 $[L_{X}, L_{Y}]$ 与对易子 $[H_{X}, H_{Y}]$ 联系起来，并从第一性原理出发证明你的推导过程。\n\n第2部分：将问题具体化到一个具体的、科学上真实存在的模型，其中 $S$ 是一个二能级系统，其哈密顿量为 $H_{S} = \\frac{\\omega}{2}\\,\\sigma_{z}$，浴是一个玻色子连续谱，其哈密顿量为 $H_{B} = \\sum_{k} \\omega_{k}\\, b_{k}^{\\dagger} b_{k}$，相互作用为自旋-玻色子类型 $H_{SB} = \\sigma_{x} \\otimes B$，其中 $B = \\sum_{k} g_{k} \\left(b_{k} + b_{k}^{\\dagger}\\right)$。计算算符 $[H_{S} + H_{B}, H_{SB}]$，并由此确定超算符 $[L_{S} + L_{B}, L_{SB}]$。\n\n第3部分：在 Nakajima-Zwanzig 投影算符方法 (NZ) 的框架内，考虑作用于密度算符 $\\rho$ 的投影算符 $P$，其作用为 $P \\rho = \\operatorname{Tr}_{B}(\\rho) \\otimes \\rho_{B}^{\\mathrm{eq}}$，其中浴处于热平衡态 $\\rho_{B}^{\\mathrm{eq}} = \\exp(-\\beta H_{B})/Z_{B}$，且 $Q = I - P$。在适用于弱耦合的标准二阶玻恩近似中，进入 NZ 方程的记忆核涉及浴关联函数 $C(t) = \\operatorname{Tr}_{B}\\big(\\rho_{B}^{\\mathrm{eq}}\\, B(t)\\, B\\big)$，其中 $B(t) = \\exp(i H_{B} t)\\, B\\, \\exp(-i H_{B} t)$。使用连续谱极限和由 $J(\\omega) = \\sum_{k} |g_{k}|^{2}\\, \\delta(\\omega - \\omega_{k})$ 定义的谱密度，证明在零温下，关联函数简化为 $C(t) = \\int_{0}^{\\infty} \\mathrm{d}\\omega\\, J(\\omega)\\, \\exp(-i \\omega t)$。\n\n假设谱密度为具有指数截断的欧姆谱密度，$J(\\omega) = 2 \\alpha\\, \\omega\\, \\exp(-\\omega/\\omega_{c})$，其中耦合强度 $\\alpha > 0$，截断频率 $\\omega_{c} > 0$。计算零温下 $C(t)$ 的闭合形式解析表达式。你的最终答案必须是仅用 $\\alpha$、$\\omega_{c}$ 和 $t$ 表示的单一解析表达式。在最终的方框答案中不要包含任何单位。如果你引入任何额外的常数，请保持它们为符号形式；不要代入数值。最终的方框答案必须仅为所要求的 $C(t)$ 表达式。",
            "solution": "该问题是适定的，有科学依据，并包含足够的信息以获得唯一解。我们按顺序处理每个部分。\n\n第1部分：刘维尔超算符的一般性质。\n\n总刘维尔算符 $L$ 对任意算符 $A$ 的作用为 $L A = [H, A]$。给定总哈密顿量 $H = H_{S} + H_{B} + H_{SB}$，在 $\\hbar = 1$ 的单位制下，我们可以利用对易子的线性性质展开此表达式：\n$$L A = [H, A] = [H_{S} + H_{B} + H_{SB}, A] = [H_{S}, A] + [H_{B}, A] + [H_{SB}, A]$$\n根据所给定义，$L_{S} A = [H_{S}, A]$，$L_{B} A = [H_{B}, A]$，以及 $L_{SB} A = [H_{SB}, A]$。将这些代入 $L A$ 的展开式得到：\n$$L A = L_{S} A + L_{B} A + L_{SB} A$$\n由于该关系对任意算符 $A$ 均成立，我们可以写出超算符恒等式：\n$$L = L_{S} + L_{B} + L_{SB}$$\n\n接下来，我们分析这些超算符之间的对易关系。两个超算符 $L_X$ 和 $L_Y$ 的对易子由其对任意算符 $A$ 的作用定义：$[L_X, L_Y]A = L_X(L_Y A) - L_Y(L_X A)$。\n\n首先，考虑 $[L_{S}, L_{B}]$。我们有：\n$$[L_{S}, L_{B}]A = L_{S}(L_{B} A) - L_{B}(L_{S} A) = [H_{S}, [H_{B}, A]] - [H_{B}, [H_{S}, A]]$$\n我们使用对易子的雅可比恒等式：$[X, [Y, Z]] + [Y, [Z, X]] + [Z, [X, Y]] = 0$。重新整理得到 $[X, [Y, Z]] - [Y, [X, Z]] = [[X, Y], Z]$。\n令 $X=H_{S}$，$Y=H_{B}$，$Z=A$，我们得到：\n$$[H_{S}, [H_{B}, A]] - [H_{B}, [H_{S}, A]] = [[H_{S}, H_{B}], A]$$\n哈密顿量 $H_{S}$ 是作用于系统希尔伯特空间 $\\mathcal{H}_S$ 的算符，$H_{B}$ 是作用于浴希尔伯特空间 $\\mathcal{H}_B$ 的算符。由于它们作用在分离、独立的希尔伯特空间上，它们相互对易：$[H_{S}, H_{B}] = 0$。\n因此，$[[H_{S}, H_{B}], A] = [0, A] = 0$。由于这对任意 $A$ 都成立，该超算符对易子为零：\n$$[L_{S}, L_{B}] = 0$$\n\n现在，考虑 $[L_{S} + L_{B}, L_{SB}]$。令 $L_0 = L_S + L_B$，它是与无相互作用哈密顿量 $H_0 = H_S + H_B$ 相关联的刘维尔算符。我们分析对易子 $[L_0, L_{SB}]$：\n$$[L_0, L_{SB}]A = L_0(L_{SB} A) - L_{SB}(L_0 A) = [H_0, [H_{SB}, A]] - [H_{SB}, [H_0, A]]$$\n再次应用雅可比恒等式，令 $X=H_0$，$Y=H_{SB}$，$Z=A$：\n$$[H_0, [H_{SB}, A]] - [H_{SB}, [H_0, A]] = [[H_0, H_{SB}], A]$$\n这表明超算符对易子 $[L_0, L_{SB}]$ 对 $A$ 的作用等价于 $A$ 与哈密顿量对易子 $[H_0, H_{SB}]$ 的对易。这是发展基于相互作用绘景的微扰理论的一个关键观察。它将超算符 $[L_S + L_B, L_{SB}]$ 确定为对应于哈密顿量对易子 $[H_S + H_B, H_{SB}]$ 的刘维尔超算符。\n\n第2部分：具体到自旋-玻色子模型。\n\n给定具体的哈密顿量：\n$H_{S} = \\frac{\\omega}{2}\\,\\sigma_{z}$，$H_{B} = \\sum_{k} \\omega_{k}\\, b_{k}^{\\dagger} b_{k}$，以及 $H_{SB} = \\sigma_{x} \\otimes B$，其中 $B = \\sum_{k} g_{k} (b_{k} + b_{k}^{\\dagger})$。我们计算对易子 $[H_{S} + H_{B}, H_{SB}]$。为清晰起见，我们在整个张量积空间上写出算符：$H_S \\otimes I_B$, $I_S \\otimes H_B$。\n$$[H_{S} + H_{B}, H_{SB}] = [H_{S} \\otimes I_B + I_S \\otimes H_B, \\sigma_{x} \\otimes B]$$\n$$= [H_{S} \\otimes I_B, \\sigma_{x} \\otimes B] + [I_S \\otimes H_B, \\sigma_{x} \\otimes B]$$\n通过直接展开，我们发现：\n$[H_{S} \\otimes I_B, \\sigma_{x} \\otimes B] = [H_{S}, \\sigma_{x}] \\otimes B$ 以及 $[I_S \\otimes H_B, \\sigma_{x} \\otimes B] = \\sigma_{x} \\otimes [H_{B}, B]$。\n\n第一项是：\n$$[H_{S}, \\sigma_{x}] = \\left[\\frac{\\omega}{2}\\,\\sigma_{z}, \\sigma_{x}\\right] = \\frac{\\omega}{2}\\,[\\sigma_{z}, \\sigma_{x}] = \\frac{\\omega}{2}\\,(2i\\sigma_{y}) = i\\omega\\sigma_{y}$$\n第二项涉及对易子：\n$$[H_{B}, B] = \\left[\\sum_{j} \\omega_{j}\\, b_{j}^{\\dagger} b_{j}, \\sum_{k} g_{k} \\left(b_{k} + b_{k}^{\\dagger}\\right)\\right] = \\sum_{j,k} \\omega_j g_k \\left[ b_{j}^{\\dagger} b_{j}, b_{k} + b_{k}^{\\dagger} \\right]$$\n使用正则对易关系 $[b_k, b_j^\\dagger] = \\delta_{kj}$ 和 $[b_k, b_j] = [b_k^\\dagger, b_j^\\dagger] = 0$，我们发现 $[b_{j}^{\\dagger} b_{j}, b_{k}] = -\\delta_{jk} b_j$ 和 $[b_{j}^{\\dagger} b_{j}, b_{k}^{\\dagger}] = \\delta_{jk} b_j^\\dagger$。\n所以，对易子变为：\n$$[H_{B}, B] = \\sum_{j,k} \\omega_j g_k \\left( \\delta_{jk}(-b_j) + \\delta_{jk}(b_j^\\dagger) \\right) = \\sum_{k} \\omega_k g_k (b_k^\\dagger - b_k)$$\n合并各项，我们得到：\n$$[H_{S} + H_{B}, H_{SB}] = (i\\omega\\sigma_{y}) \\otimes B + \\sigma_x \\otimes \\left( \\sum_{k} \\omega_k g_k (b_k^\\dagger - b_k) \\right)$$\n$$= i\\omega\\sigma_{y} \\otimes \\sum_{k} g_{k} (b_{k} + b_{k}^{\\dagger}) + \\sigma_x \\otimes \\sum_{k} \\omega_k g_k (b_k^\\dagger - b_k)$$\n根据第1部分，超算符 $[L_{S} + L_{B}, L_{SB}]$ 被确定为与该哈密顿量对易子相关联的刘维尔算符，即，它对算符 $A$ 的作用是 $[[H_{S} + H_{B}, H_{SB}], A]$。\n\n第3部分：浴关联函数的计算。\n\n浴关联函数定义为 $C(t) = \\operatorname{Tr}_{B}\\big(\\rho_{B}^{\\mathrm{eq}}\\, B(t)\\, B\\big)$，其中 $B(t) = \\exp(i H_{B} t)\\, B\\, \\exp(-i H_{B} t)$。\n首先，我们求浴算符 $B = \\sum_k g_k (b_k + b_k^\\dagger)$ 的时间演化。在 $H_B = \\sum_k \\omega_k b_k^\\dagger b_k$ 下，产生和湮灭算符的演化是标准的：\n$b_k(t) = \\exp(i H_{B} t)\\, b_k\\, \\exp(-i H_{B} t) = b_k \\exp(-i\\omega_k t)$\n$b_k^\\dagger(t) = \\exp(i H_{B} t)\\, b_k^\\dagger\\, \\exp(-i H_{B} t) = b_k^\\dagger \\exp(i\\omega_k t)$\n因此，$B(t) = \\sum_k g_k (b_k \\exp(-i\\omega_k t) + b_k^\\dagger \\exp(i\\omega_k t))$。\n\n将此代入 $C(t)$ 的定义中：\n$$C(t) = \\operatorname{Tr}_{B}\\left[\\rho_{B}^{\\mathrm{eq}} \\left(\\sum_k g_k (b_k e^{-i\\omega_k t} + b_k^\\dagger e^{i\\omega_k t})\\right) \\left(\\sum_j g_j (b_j + b_j^\\dagger)\\right) \\right]$$\n迹是关于浴的自由度求的。由于热平衡态 $\\rho_B^{\\mathrm{eq}}$ 在每个模式的福克基矢下是对角的，且不同模式是独立的，来自不同模式（$k \\neq j$）的算符乘积的期望值为零。此外，诸如 $\\langle b_k b_j \\rangle = \\operatorname{Tr}_B(\\rho_B^{\\mathrm{eq}} b_k b_j)$ 和 $\\langle b_k^\\dagger b_j^\\dagger \\rangle$ 的项也为零。我们只剩下 $k=j$ 的项：\n$$C(t) = \\sum_k |g_k|^2 \\left( \\langle b_k b_k^\\dagger \\rangle e^{-i\\omega_k t} + \\langle b_k^\\dagger b_k \\rangle e^{i\\omega_k t} \\right)$$\n热期望值由玻色-爱因斯坦分布给出：$\\langle b_k^\\dagger b_k \\rangle = n_B(\\omega_k) = (\\exp(\\beta \\omega_k) - 1)^{-1}$，并利用对易关系，$\\langle b_k b_k^\\dagger \\rangle = \\langle b_k^\\dagger b_k + 1 \\rangle = n_B(\\omega_k) + 1$。这里 $\\beta = 1/(k_B T)$。\n$$C(t) = \\sum_k |g_k|^2 \\left( (n_B(\\omega_k)+1) e^{-i\\omega_k t} + n_B(\\omega_k) e^{i\\omega_k t} \\right)$$\n在零温（$T=0$）下，我们有 $\\beta \\to \\infty$。对于任何 $\\omega_k > 0$，$\\exp(\\beta \\omega_k) \\to \\infty$，所以平均占据数 $n_B(\\omega_k) \\to 0$。关联函数简化为：\n$$C(t) = \\sum_k |g_k|^2 \\left( (0+1) e^{-i\\omega_k t} + 0 \\cdot e^{i\\omega_k t} \\right) = \\sum_k |g_k|^2 e^{-i\\omega_k t}$$\n在连续谱极限下，对模式 $k$ 的求和被替换为对频率 $\\omega$ 的积分，引入谱密度 $J(\\omega) = \\sum_{k} |g_{k}|^{2}\\, \\delta(\\omega - \\omega_{k})$。\n$$C(t) = \\int_0^\\infty d\\omega \\left( \\sum_k |g_k|^2 \\delta(\\omega - \\omega_k) \\right) e^{-i\\omega t} = \\int_{0}^{\\infty} d\\omega\\, J(\\omega)\\, \\exp(-i \\omega t)$$\n这就证明了所要求的关系。\n\n最后，我们计算对于给定的具有指数截断的欧姆谱密度 $J(\\omega) = 2 \\alpha\\, \\omega\\, \\exp(-\\omega/\\omega_{c})$ 的 $C(t)$。\n$$C(t) = \\int_0^{\\infty} d\\omega\\, \\left( 2 \\alpha\\, \\omega\\, \\exp(-\\omega/\\omega_{c}) \\right) \\exp(-i \\omega t)$$\n$$C(t) = 2\\alpha \\int_0^{\\infty} d\\omega\\, \\omega\\, \\exp\\left(-\\omega\\left(\\frac{1}{\\omega_c} + it\\right)\\right)$$\n这是一个形式为 $\\int_0^\\infty x \\exp(-ax) dx = 1/a^2$（对于 $\\mathrm{Re}(a) > 0$）的标准积分。这里，我们定义 $a = \\frac{1}{\\omega_c} + it$。实部是 $1/\\omega_c > 0$，因此积分收敛。\n计算得到：\n$$C(t) = 2\\alpha \\left( \\frac{1}{\\left(\\frac{1}{\\omega_c} + it\\right)^2} \\right)$$\n我们可以简化这个表达式：\n$$C(t) = 2\\alpha \\left( \\frac{1}{\\left(\\frac{1 + i\\omega_c t}{\\omega_c}\\right)^2} \\right) = 2\\alpha \\left( \\frac{\\omega_c^2}{(1 + i\\omega_c t)^2} \\right)$$\n这是零温浴关联函数的最终闭合形式解析表达式。",
            "answer": "$$\\boxed{\\frac{2\\alpha \\omega_c^2}{(1+i\\omega_c t)^2}}$$"
        },
        {
            "introduction": "超越简单的浴模型，我们将探索 NZ 形式主义在描述非马尔可夫记忆效应方面的真正威力。本练习使用一个具有结构化谱密度的浴，在系统中引发持续振荡，这是一种清晰的非马尔可夫特征 。求解由此产生的积分-微分方程，将为你提供关于系统-环境记忆如何编码在动力学中的深刻见解。",
            "id": "3773510",
            "problem": "考虑一个具有基态 $|g\\rangle$ 和激发态 $|e\\rangle$ 的二能级量子系统（“系统”），其系统哈密顿量为 $H_{S} = \\frac{\\omega_{0}}{2} \\sigma_{z}$，其中 $\\sigma_{z}$ 是泡利 $z$ 矩阵，$\\omega_{0} > 0$ 是跃迁频率。在旋转波近似（RWA）下，该系统与一个玻色子库（“环境”）线性耦合。该库的哈密顿量为 $H_{R} = \\sum_{k} \\omega_{k} b_{k}^{\\dagger} b_{k}$，相互作用哈密顿量为 $H_{I} = \\sigma_{+} \\otimes B + \\sigma_{-} \\otimes B^{\\dagger}$，其中 $B = \\sum_{k} g_{k} b_{k}$，$b_{k}$ 是玻色子湮灭算符，$\\sigma_{+} = |e\\rangle\\langle g|$ 且 $\\sigma_{-} = |g\\rangle\\langle e|$。设初始联合态为 $\\rho_{SR}(0) = |e\\rangle\\langle e| \\otimes |0\\rangle\\langle 0|$，其中 $|0\\rangle$ 是库的真空态。\n\n使用 Nakajima–Zwanzig (NZ) 投影算符方法，其中投影算符为 $P \\rho_{SR} = \\operatorname{Tr}_{R}(\\rho_{SR}) \\otimes |0\\rangle\\langle 0|$，可以得到一个用于描述约化系统动力学的非马尔可夫时间卷积方程，该方程由一个通过库关联函数表示的记忆核驱动。在单激发子空间（对于给定的初始条件，在旋转波近似下该子空间是动力学封闭的）中进行研究，并将激发态振幅记为 $a(t) = \\langle e| \\rho_{S}(t) |e\\rangle^{1/2}$，其定义使得激发态布居数为 $p_{e}(t) = |a(t)|^{2}$，且 $a(0) = 1$。\n\n构建一个结构化库，其谱密度在关于系统跃迁频率对称的两个频率处有尖锐峰值：\n$$\nJ(\\omega) = \\alpha \\left[ \\delta\\!\\left(\\omega - (\\omega_{0} + \\Delta)\\right) + \\delta\\!\\left(\\omega - (\\omega_{0} - \\Delta)\\right) \\right],\n$$\n其中参数 $\\alpha > 0$ 且 $\\Delta > 0$。从刘维尔-冯·诺依曼方程 $\\dot{\\rho}_{SR}(t) = -\\mathrm{i} [H_{S} + H_{R} + H_{I}, \\rho_{SR}(t)]$、NZ 投影算符 $P$ 以及库在真空态中的关联函数的定义出发，推导 $a(t)$ 的精确时间非局域方程，该方程应为一个由 $J(\\omega)$ 决定的记忆核的卷积形式，然后在给定初始条件下精确求解此方程，得到 $a(t)$ 的闭合形式解。\n\n你的最终答案必须是 $a(t)$ 的单个闭合形式解析表达式，该表达式明确显示了对于非零的 $\\alpha$ 和 $\\Delta$，存在持续振荡且不存在稳态。不需要进行数值计算，也不需要包含单位。",
            "solution": "首先对问题进行验证，以确保其在科学上是合理的、良定的和客观的。\n\n**步骤 1：提取的已知条件**\n- 系统：二能级量子系统，态为 $|g\\rangle$ 和 $|e\\rangle$。\n- 系统哈密顿量：$H_{S} = \\frac{\\omega_{0}}{2} \\sigma_{z}$，其中 $\\omega_{0} > 0$。\n- 库哈密顿量：$H_{R} = \\sum_{k} \\omega_{k} b_{k}^{\\dagger} b_{k}$。\n- 相互作用哈密顿量 (RWA)：$H_{I} = \\sigma_{+} \\otimes B + \\sigma_{-} \\otimes B^{\\dagger}$，其中 $B = \\sum_{k} g_{k} b_{k}$。\n- 总哈密顿量：$H = H_{S} + H_{R} + H_{I}$。\n- 初始态：$\\rho_{SR}(0) = |e\\rangle\\langle e| \\otimes |0\\rangle\\langle 0|$。\n- 投影算符：$P \\rho_{SR} = \\operatorname{Tr}_{R}(\\rho_{SR}) \\otimes |0\\rangle\\langle 0|$。\n- 激发态振幅：$a(t)$ 通过布居数 $p_{e}(t) = \\langle e| \\rho_{S}(t) |e\\rangle = |a(t)|^{2}$ 定义，且 $a(0) = 1$。\n- 谱密度：$J(\\omega) = \\alpha \\left[ \\delta(\\omega - (\\omega_{0} + \\Delta)) + \\delta(\\omega - (\\omega_{0} - \\Delta)) \\right]$，其中 $\\alpha > 0$ 且 $\\Delta > 0$。\n- 控制方程：$\\dot{\\rho}_{SR}(t) = -\\mathrm{i} [H, \\rho_{SR}(t)]$。\n\n**步骤 2：验证**\n该问题是量子光学和开放量子系统理论中的一个标准模型，描述了一个与结构化玻色子库耦合的量子比特。使用 Nakajima-Zwanzig 方法是适当的。所指定的哈密顿量、初始态和投影算符都是良定且一致的。谱密度虽然是一个理想化模型，但它是一个有效的理论构造，用于研究非马尔可夫动力学和记忆效应。该问题是自洽的，有科学依据，且是良定的。$\\hbar$ 的省略意味着使用了自然单位制（$\\hbar=1$），这是该领域的标准约定。\n\n**步骤 3：结论**\n问题有效。\n\n我们在假设自然单位制（$\\hbar=1$）下进行求解。初始态 $\\rho_{SR}(0) = |e, 0\\rangle\\langle e, 0|$ 在总系统（在量子比特中）中有一个单激发。由于旋转波近似，哈密顿量使总激发数守恒。因此，动力学被限制在由态 $\\{|e, 0\\rangle, \\{|g, 1_k\\rangle\\}_{k}\\}$ 张成的单激发子空间中，其中 $|e, 0\\rangle$ 表示系统处于激发态且库处于真空态，$|g, 1_k\\rangle$ 表示系统处于基态且库的第 $k$ 个模式中有一个激发。\n\n这个问题可以通过推导并求解该子空间内态矢量的薛定谔方程来解决。对于这个特定模型，该方法等价于 Nakajima-Zwanzig 方法的形式化应用，因为 NZ 记忆核的二阶展开是精确的。我们将时间 $t$ 时刻的态矢量写在关于 $H_0 = H_S + H_R$ 的相互作用绘景中：\n$$\n|\\psi(t)\\rangle_I = a(t) |e, 0\\rangle + \\sum_k c_k(t) |g, 1_k\\rangle\n$$\n初始条件 $|\\psi(0)\\rangle = |e, 0\\rangle$ 意味着 $a(0)=1$ 且对所有 $k$ 都有 $c_k(0)=0$。振幅 $a(t)$ 通过 $p_e(t) = |a(t)|^2$ 与约化系统态直接相关。\n\n相互作用绘景中的薛定谔方程为 $i \\frac{d}{dt} |\\psi(t)\\rangle_I = H_I(t) |\\psi(t)\\rangle_I$。此绘景中的相互作用哈密顿量为：\n$$\nH_I(t) = e^{i(H_S+H_R)t} H_I e^{-i(H_S+H_R)t} = \\sigma_+ e^{i\\omega_0 t} \\otimes B(t) + \\sigma_- e^{-i\\omega_0 t} \\otimes B^\\dagger(t)\n$$\n其中 $B(t) = \\sum_k g_k b_k e^{-i\\omega_k t}$ 且 $B^\\dagger(t) = \\sum_k g_k^* b_k^\\dagger e^{i\\omega_k t}$。\n将 $|\\psi(t)\\rangle_I$ 代入薛定谔方程，得到一组关于振幅的耦合微分方程：\n$$\ni \\left( \\dot{a}(t) |e, 0\\rangle + \\sum_k \\dot{c}_k(t) |g, 1_k\\rangle \\right) = H_I(t) \\left( a(t) |e, 0\\rangle + \\sum_j c_j(t) |g, 1_j\\rangle \\right)\n$$\n将 $H_I(t)$ 应用于基矢，得到：\n$$\nH_I(t) |e, 0\\rangle = \\sum_k g_k e^{-i(\\omega_k - \\omega_0)t} |g, 1_k\\rangle\n$$\n$$\nH_I(t) |g, 1_j\\rangle = g_j^* e^{i(\\omega_j - \\omega_0)t} |e, 0\\rangle\n$$\n将薛定谔方程投影到 $|e, 0\\rangle$ 和 $|g, 1_k\\rangle$ 上，得到：\n$$\n(1) \\quad i\\dot{a}(t) = \\sum_k g_k^* c_k(t) e^{i(\\omega_k - \\omega_0)t}\n$$\n$$\n(2) \\quad i\\dot{c}_k(t) = g_k a(t) e^{-i(\\omega_k - \\omega_0)t}\n$$\n对 $c_k(0)=0$ 的方程(2)从 0 到 $t$ 积分：\n$$\nc_k(t) = -i g_k \\int_0^t d\\tau \\, a(\\tau) e^{-i(\\omega_k - \\omega_0)\\tau}\n$$\n将此 $c_k(t)$ 的表达式代入方程(1)：\n$$\ni\\dot{a}(t) = \\sum_k g_k^* \\left( -i g_k \\int_0^t d\\tau \\, a(\\tau) e^{-i(\\omega_k - \\omega_0)\\tau} \\right) e^{i(\\omega_k - \\omega_0)t}\n$$\n$$\n\\dot{a}(t) = - \\sum_k |g_k|^2 \\int_0^t d\\tau \\, a(\\tau) e^{i(\\omega_k - \\omega_0)(t-\\tau)}\n$$\n这就是 $a(t)$ 的精确时间非局域方程。记忆核为 $K(t-\\tau) = \\sum_k |g_k|^2 e^{i(\\omega_k - \\omega_0)(t-\\tau)}$。\n\n我们现在对库模式取连续极限，用关于谱密度 $J(\\omega) = \\sum_k |g_k|^2 \\delta(\\omega - \\omega_k)$ 的积分代替求和。记忆核变为：\n$$\nK(t-\\tau) = \\int_0^\\infty d\\omega \\, J(\\omega) e^{i(\\omega - \\omega_0)(t-\\tau)}\n$$\n使用给定的谱密度 $J(\\omega) = \\alpha [ \\delta(\\omega - (\\omega_{0} + \\Delta)) + \\delta(\\omega - (\\omega_{0} - \\Delta)) ]$，我们计算该核。我们假设 $\\omega_0 > \\Delta > 0$ 以确保两个频率均为正。\n$$\nK(t-\\tau) = \\int_0^\\infty d\\omega \\, \\alpha \\left[ \\delta(\\omega - (\\omega_{0} + \\Delta)) + \\delta(\\omega - (\\omega_{0} - \\Delta)) \\right] e^{i(\\omega - \\omega_0)(t-\\tau)}\n$$\n$$\nK(t-\\tau) = \\alpha \\left[ e^{i((\\omega_0+\\Delta) - \\omega_0)(t-\\tau)} + e^{i((\\omega_0-\\Delta) - \\omega_0)(t-\\tau)} \\right]\n$$\n$$\nK(t-\\tau) = \\alpha \\left[ e^{i\\Delta(t-\\tau)} + e^{-i\\Delta(t-\\tau)} \\right] = 2\\alpha \\cos(\\Delta(t-\\tau))\n$$\n$a(t)$ 的积分-微分方程是：\n$$\n\\dot{a}(t) = - \\int_0^t d\\tau \\, 2\\alpha \\cos(\\Delta(t-\\tau)) a(\\tau)\n$$\n这是一个卷积型 Volterra 方程。我们使用拉普拉斯变换（记为 $\\mathcal{L}$）来求解。令 $A(s) = \\mathcal{L}\\{a(t)\\}$。\n$$\n\\mathcal{L}\\{\\dot{a}(t)\\} = sA(s) - a(0) = sA(s) - 1\n$$\n$$\n\\mathcal{L}\\left\\{ -2\\alpha \\int_0^t \\cos(\\Delta(t-\\tau)) a(\\tau) d\\tau \\right\\} = -2\\alpha \\, \\mathcal{L}\\{\\cos(\\Delta t)\\} \\, \\mathcal{L}\\{a(t)\\} = -2\\alpha \\frac{s}{s^2+\\Delta^2} A(s)\n$$\n变换后的方程是：\n$$\nsA(s) - 1 = -2\\alpha \\frac{s}{s^2+\\Delta^2} A(s)\n$$\n求解 $A(s)$：\n$$\nA(s) \\left( s + \\frac{2\\alpha s}{s^2+\\Delta^2} \\right) = 1 \\implies A(s) \\left( \\frac{s(s^2+\\Delta^2) + 2\\alpha s}{s^2+\\Delta^2} \\right) = 1\n$$\n$$\nA(s) = \\frac{s^2+\\Delta^2}{s(s^2+\\Delta^2+2\\alpha)}\n$$\n为了求拉普拉斯逆变换，我们使用部分分式展开。令 $\\Omega^2 = \\Delta^2 + 2\\alpha$。由于 $\\alpha>0$，$\\Omega$ 是实数。\n$$\nA(s) = \\frac{s^2+\\Delta^2}{s(s^2+\\Omega^2)} = \\frac{C_1}{s} + \\frac{C_2 s + C_3}{s^2+\\Omega^2}\n$$\n比较 $s^2+\\Delta^2 = C_1(s^2+\\Omega^2) + s(C_2 s + C_3)$ 的系数，可得 $C_3=0$，$C_1 = \\frac{\\Delta^2}{\\Omega^2}$，以及 $C_2 = 1-C_1 = \\frac{\\Omega^2-\\Delta^2}{\\Omega^2} = \\frac{2\\alpha}{\\Omega^2}$。\n$$\nA(s) = \\frac{\\Delta^2}{\\Omega^2} \\frac{1}{s} + \\frac{2\\alpha}{\\Omega^2} \\frac{s}{s^2+\\Omega^2}\n$$\n逐项进行拉普拉斯逆变换：\n$$\na(t) = \\mathcal{L}^{-1}\\{A(s)\\} = \\frac{\\Delta^2}{\\Omega^2} \\mathcal{L}^{-1}\\left\\{\\frac{1}{s}\\right\\} + \\frac{2\\alpha}{\\Omega^2} \\mathcal{L}^{-1}\\left\\{\\frac{s}{s^2+\\Omega^2}\\right\\}\n$$\n$$\na(t) = \\frac{\\Delta^2}{\\Omega^2} \\cdot 1 + \\frac{2\\alpha}{\\Omega^2} \\cos(\\Omega t)\n$$\n代回 $\\Omega^2 = \\Delta^2 + 2\\alpha$：\n$$\na(t) = \\frac{\\Delta^2}{\\Delta^2+2\\alpha} + \\frac{2\\alpha}{\\Delta^2+2\\alpha} \\cos\\left(\\sqrt{\\Delta^2+2\\alpha} \\, t\\right)\n$$\n这就是激发态振幅 $a(t)$ 的精确闭合形式解。该表达式表明 $a(t)$ 以频率 $\\Omega = \\sqrt{\\Delta^2+2\\alpha}$ 进行持续振荡，并且不会衰减到某个稳态值，这是由结构化库引起的非马尔可夫动力学的一个特征。",
            "answer": "$$\n\\boxed{\\frac{\\Delta^{2}}{\\Delta^{2} + 2\\alpha} + \\frac{2\\alpha}{\\Delta^{2} + 2\\alpha} \\cos\\left(\\sqrt{\\Delta^{2} + 2\\alpha} \\, t\\right)}\n$$"
        },
        {
            "introduction": "解析解在现实世界中是罕见的，因此计算方法至关重要。本练习将理论与计算实践相结合，通过将时间非局域的 NZ 方程转化为等效的局域常微分方程组并实施数值求解器，你将能够直接比较不同近似（如记忆截断）与精确基准的差异 。这有助于你获得模拟开放量子系统的实用技能，并理解其中的挑战与权衡。",
            "id": "3773553",
            "problem": "考虑在无偏置极限下的自spin-玻色子模型，其哈密顿量为 $H = \\frac{\\Delta}{2}\\sigma_x + \\sigma_z \\otimes B + H_{\\mathrm{bath}}$，其中 $\\sigma_x$ 和 $\\sigma_z$ 是两能级系统的泡利矩阵，$B$ 是热库算符，$H_{\\mathrm{bath}}$ 是环境哈密顿量。在 Nakajima-Zwanzig (NZ) 投影算符方法下，一个相关系统变量的约化动力学可以通过一个含时卷积的广义主方程 (GME) 来表示。将相关变量定义为布居数差 $z(t) = \\langle \\sigma_z \\rangle_t$。在弱耦合和高温 Drude-Lorentz 热库条件下，热库关联函数呈指数衰减。这启发我们采用指数记忆核近似 $K(\\tau) = \\kappa e^{-\\gamma \\tau}$，其中 $\\kappa > 0$ 和 $\\gamma > 0$ 分别表示有效耦合强度和热库衰减率。在此近似下，$z(t)$ 的 NZ-GME 具有以下形式：\n$$\n\\dot{z}(t) = -\\int_0^t K(t-s) z(s) \\, ds = -\\int_0^t \\kappa e^{-\\gamma (t-s)} z(s)\\, ds\n$$\n从总密度算符的刘维尔-冯·诺依曼方程和 NZ 方法中投影算符的定义出发，在建模层面上论证在指数衰减热库关联近似下 $z(t)$ 的上述记忆核结构的合理性。然后，从该卷积方程出发，引入一个由下式定义的辅助变量 $y(t)$：\n$$\ny(t) = \\int_0^t e^{-\\gamma (t-s)} z(s)\\, ds\n$$\n并推导与未截断卷积方程等价的关于 $(z(t), y(t))$ 的封闭线性常微分方程组。明确指出与 $z(0)=1$（沿 $\\sigma_z$ 方向完全极化）和可因子分解的初始态相一致的初始条件。\n\n设计一个计算基准，以在固定的终止时间 $t_f$ 量化约化动力学中的两种不同误差来源：\n1. 核截断误差：将记忆积分截断至时长为 $\\tau_c$ 的有限窗口，使得只包含来自 $s \\in [t-\\tau_c, t]$ 的贡献。实现一个步长为 $dt$ 的数值时间步进算法，在此截断记忆下演化 $z(t)$。将得到的近似值记为 $z_{\\mathrm{trunc}}(t_f)$。\n2. 数值离散化误差：保留完整记忆（无截断），但使用相同的时间步进算法和步长 $dt$ 计算动力学。将得到的近似值记为 $z_{\\mathrm{disc}}(t_f)$。\n\n对于未截断的核，使用一种有原理依据的方法（如对角化或拉普拉斯变换）从通过辅助变量 $y(t)$ 获得的线性常微分方程组推导出精确解 $z_{\\mathrm{exact}}(t)$，并将其用作误差量化的基准真相。定义并计算绝对误差\n$$\nE_T = \\left| z_{\\mathrm{trunc}}(t_f) - z_{\\mathrm{exact}}(t_f) \\right|, \\quad\nE_D = \\left| z_{\\mathrm{disc}}(t_f) - z_{\\mathrm{exact}}(t_f) \\right|.\n$$\n\n为具有指数核的离散卷积实现以下时间步进方案。在均匀网格 $t_n = n\\,dt$ 上，令 $z_n \\approx z(t_n)$ 并定义离散辅助和\n$$\ny_n = \\sum_{m=m_{\\min}(n)}^{n} e^{-\\gamma (t_n - t_m)} z_m\\, dt,\n$$\n其中，对于完整记忆情况，$m_{\\min}(n)=0$；对于截断记忆情况，$m_{\\min}(n)=\\max(0, n - M + 1)$，其中 $M=\\lceil \\tau_c/dt \\rceil$。使用显式欧拉更新\n$$\nz_{n+1} = z_n - dt \\cdot \\kappa \\, y_n,\n$$\n并递归地更新 $y_n$。对于完整记忆，递归式为 $y_{n+1} = e^{-\\gamma dt} y_n + z_{n+1}\\, dt$。对于截断记忆，引入边界移除项，使得\n$$\ny_{n+1} = e^{-\\gamma dt} y_n + z_{n+1}\\, dt - \\Theta(n+1-M)\\, e^{-\\gamma \\tau_c} z_{n+1-M}\\, dt,\n$$\n其中 $\\Theta(\\cdot)$ 是指示函数，当其参数为非负时等于 1，否则等于 0。\n\n所有量均为无量纲；无需物理单位。\n\n测试套件。使用以下三组参数集在指定的终止时间评估误差：\n- 情况 A（通用，中等记忆）：$(\\kappa=0.5,\\ \\gamma=2.0,\\ t_f=5.0,\\ dt=0.05,\\ \\tau_c=1.0)$。\n- 情况 B（长记忆，严重截断）：$(\\kappa=0.02,\\ \\gamma=0.4,\\ t_f=8.0,\\ dt=0.05,\\ \\tau_c=0.5)$。\n- 情况 C（短记忆，轻微截断）：$(\\kappa=1.0,\\ \\gamma=3.0,\\ t_f=2.0,\\ dt=0.05,\\ \\tau_c=0.3)$。\n\n程序要求：\n- 使用从通过辅助变量 $y(t)$ 获得的线性常微分方程组推导出的未截断精确解，计算 $z_{\\mathrm{exact}}(t_f)$。\n- 对于每种情况，使用上面提供的截断记忆算法以及给定的 $dt$ 和 $\\tau_c$ 来计算 $z_{\\mathrm{trunc}}(t_f)$。\n- 对于每种情况，使用上面提供的完整记忆算法以及给定的 $dt$ 且无截断来计算 $z_{\\mathrm{disc}}(t_f)$。\n- 对于每种情况，以浮点数形式输出数对 $[E_T, E_D]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三种情况的结果，格式为逗号分隔的列表的列表，用方括号括起来，并按 A、B、C 的顺序排列。例如，形如\n$[[e_{T,A},e_{D,A}],[e_{T,B},e_{D,B}],[e_{T,C},e_{D,C}]]$ 的输出，\n其中每个 $e_{\\cdot,\\cdot}$ 是一个浮点数。不应打印任何额外文本。",
            "solution": "此问题须经验证。\n\n### 步骤 1：提取已知信息\n- **模型：** 自旋-玻色子模型，无偏置极限。\n- **哈密顿量：** $H = \\frac{\\Delta}{2}\\sigma_x + \\sigma_z \\otimes B + H_{\\mathrm{bath}}$。\n- **相关变量：** 布居数差 $z(t) = \\langle \\sigma_z \\rangle_t$。\n- **近似：** 弱耦合，高温 Drude-Lorentz 热库。\n- **记忆核：** 指数形式 $K(\\tau) = \\kappa e^{-\\gamma \\tau}$，其中 $\\kappa > 0$ 且 $\\gamma > 0$。\n- **积分-微分方程 (NZ-GME)：** $\\dot{z}(t) = -\\int_0^t K(t-s) z(s) \\, ds = -\\int_0^t \\kappa e^{-\\gamma (t-s)} z(s)\\, ds$。\n- **辅助变量：** $y(t) = \\int_0^t e^{-\\gamma (t-s)} z(s)\\, ds$。\n- **初始条件：** $z(0)=1$，对应于完全极化态。总初始态是可因子分解的。\n- **任务 1：** 在建模层面上论证记忆核结构的合理性。\n- **任务 2：** 推导关于 $(z(t), y(t))$ 的封闭线性常微分方程组并说明初始条件。\n- **任务 3：** 推导未截断系统的精确解 $z_{\\mathrm{exact}}(t)$。\n- **任务 4（基准设计）：**\n    - **核截断误差 ($E_T$)：** 记忆积分被截断至窗口 $\\tau_c$。近似值为 $z_{\\mathrm{trunc}}(t_f)$。\n    - **数值离散化误差 ($E_D$)：** 保留完整记忆积分。近似值为 $z_{\\mathrm{disc}}(t_f)$。\n- **误差定义：** $E_T = \\left| z_{\\mathrm{trunc}}(t_f) - z_{\\mathrm{exact}}(t_f) \\right|$，$E_D = \\left| z_{\\mathrm{disc}}(t_f) - z_{\\mathrm{exact}}(t_f) \\right|$。\n- **数值方案：**\n    - **网格：** $t_n = n\\,dt$。\n    - **$z_n$ 的更新：** $z_{n+1} = z_n - dt \\cdot \\kappa \\, y_n$ (显式欧拉法)。\n    - **完整记忆 $y_n$ 的更新：** $y_{n+1} = e^{-\\gamma dt} y_n + z_{n+1}\\, dt$。\n    - **截断记忆 $y_n$ 的更新：** $y_{n+1} = e^{-\\gamma dt} y_n + z_{n+1}\\, dt - \\Theta(n+1-M)\\, e^{-\\gamma \\tau_c} z_{n+1-M}\\, dt$，其中 $M=\\lceil \\tau_c/dt \\rceil$ 且 $\\Theta(\\cdot)$ 是指示函数。\n- **测试套件（情况 A, B, C）：**\n    - 情况 A: $(\\kappa=0.5,\\ \\gamma=2.0,\\ t_f=5.0,\\ dt=0.05,\\ \\tau_c=1.0)$。\n    - 情况 B: $(\\kappa=0.02,\\ \\gamma=0.4,\\ t_f=8.0,\\ dt=0.05,\\ \\tau_c=0.5)$。\n    - 情况 C: $(\\kappa=1.0,\\ \\gamma=3.0,\\ t_f=2.0,\\ dt=0.05,\\ \\tau_c=0.3)$。\n- **输出：** A、B、C 三种情况下 $[E_T, E_D]$ 对的列表。\n\n### 步骤 2：使用提取的已知信息进行验证\n- **科学依据：** 该问题牢固地植根于开放量子系统的标准理论，特别是自旋-玻色子模型和 Nakajima-Zwanzig 投影算符方法。指数记忆核是一个常见且有物理动机的近似（例如，对于高温极限下的 Drude-Lorentz 热库）。从具有指数核的积分-微分方程推导常微分方程组是一种标准的数学技术。该问题在科学上是合理的。\n- **适定性：** 该问题提供了一个具有指定初始条件 $z(0)=1$ 的初值问题。参数已定义，任务是推导和计算解，这些在数学上都是明确定义的过程。预期存在唯一且稳定的解。\n- **客观性：** 问题以精确、技术性的语言陈述，没有任何主观性或歧义。\n- **完整性与一致性：** 提供了所有必要的方程、参数、初始条件和数值算法。任务被明确指定。整个设置是内部一致且自洽的。\n\n### 步骤 3：判定与操作\n问题有效。将提供完整解答。\n\n### 解答\n该问题需要多部分分析，涉及理论推导和数值实现。我们系统地处理每个部分。\n\n**第一部分：记忆核结构的合理性论证**\n推导开放量子系统动力学的出发点是针对总系统加环境密度算符 $\\rho_{\\mathrm{tot}}(t)$ 的刘维尔-冯·诺依曼方程：$\\dot{\\rho}_{\\mathrm{tot}}(t) = -i[H, \\rho_{\\mathrm{tot}}(t)] \\equiv \\mathcal{L}\\rho_{\\mathrm{tot}}(t)$，其中 $\\mathcal{L}$ 是刘维尔超算符。Nakajima-Zwanzig 方法将动力学投影到一个“相关”子空间上，通常是系统的约化密度算符 $\\rho_S(t) = \\mathrm{Tr}_{\\mathrm{bath}}[\\rho_{\\mathrm{tot}}(t)]$。\n\n在标准假设下，如可因子分解的初始态 $\\rho_{\\mathrm{tot}}(0) = \\rho_S(0) \\otimes \\rho_B^{\\mathrm{eq}}$（其中 $\\rho_B^{\\mathrm{eq}}$ 是热库平衡态）和 $\\mathcal{P}\\mathcal{L}\\mathcal{P}=0$，NZ 投影算符技术为密度算符的相关部分 $\\mathcal{P}\\rho_{\\mathrm{tot}}(t) = \\rho_S(t) \\otimes \\rho_B^{\\mathrm{eq}}$ 导出一个广义主方程 (GME)：\n$$\n\\frac{d}{dt}\\rho_S(t) = \\int_0^t d\\tau \\, \\mathcal{K}(\\tau) \\rho_S(t-\\tau)\n$$\n其中记忆核超算符 $\\mathcal{K}(\\tau)$ 由 $\\mathcal{K}(\\tau) = -\\mathrm{Tr}_{\\mathrm{bath}}[\\mathcal{L}_I e^{\\mathcal{L}_0\\tau} \\mathcal{L}_I \\rho_B^{\\mathrm{eq}}]$ 给出，其中 $\\mathcal{L}_I$ 是相互作用哈密顿量 $H_I = \\sigma_z \\otimes B$ 的刘维尔算符，$\\mathcal{L}_0$ 是非相互作用部分 $H_0 = H_S + H_{\\mathrm{bath}}$ 的刘维尔算符。在弱耦合下有效的二阶玻恩近似已用于简化此结构。\n\n该核涉及热库关联函数，对于给定的相互作用 $H_I$，该函数为 $C(\\tau) = \\mathrm{Tr}_{\\mathrm{bath}}[B(\\tau) B(0) \\rho_B^{\\mathrm{eq}}] = \\langle B(\\tau) B(0) \\rangle_{\\mathrm{bath}}$，其中 $B(\\tau) = e^{iH_{\\mathrm{bath}}\\tau} B e^{-iH_{\\mathrm{bath}}\\tau}$。可观测量 $z(t) = \\mathrm{Tr}_S[\\sigma_z \\rho_S(t)]$ 的动力学将由一个方程控制，其核与此热库关联函数成正比。\n\n问题指出，对于高温条件下的 Drude-Lorentz 谱密度，热库关联函数可以近似为指数和。在最简单的情况下，单个指数衰减占主导地位，$C(\\tau) \\propto e^{-\\gamma \\tau}$。这直接启发我们为 $z(t)$ 的动力学唯象地选择指数记忆核 $K(\\tau) = \\kappa e^{-\\gamma \\tau}$，其中 $\\kappa$ 取决于耦合强度和温度，$\\gamma$ 是热库的特征记忆衰减时间。\n\n**第二部分：等价 ODE 系统的推导**\n给定积分-微分方程：\n$$\n\\dot{z}(t) = -\\kappa \\int_0^t e^{-\\gamma (t-s)} z(s)\\, ds\n$$\n定义一个辅助变量为：\n$$\ny(t) = \\int_0^t e^{-\\gamma (t-s)} z(s)\\, ds\n$$\n通过将 $y(t)$ 的定义代入 $\\dot{z}(t)$ 的方程，我们立即得到第一个 ODE：\n$$\n\\dot{z}(t) = -\\kappa y(t)\n$$\n为了找到 $y(t)$ 的 ODE，我们使用莱布尼茨积分法则对其定义关于 $t$ 求导：\n$$\n\\dot{y}(t) = \\frac{d}{dt} \\int_0^t e^{-\\gamma (t-s)} z(s)\\, ds = e^{-\\gamma (t-t)} z(t) + \\int_0^t \\frac{\\partial}{\\partial t}\\left(e^{-\\gamma (t-s)}\\right) z(s)\\, ds\n$$\n$$\n\\dot{y}(t) = z(t) - \\gamma \\int_0^t e^{-\\gamma (t-s)} z(s)\\, ds\n$$\n认识到积分就是 $y(t)$，我们得到第二个 ODE：\n$$\n\\dot{y}(t) = z(t) - \\gamma y(t)\n$$\n等价的一阶线性常微分方程组是：\n$$\n\\frac{d}{dt} \\begin{pmatrix} z(t) \\\\ y(t) \\end{pmatrix} = \\begin{pmatrix} 0 & -\\kappa \\\\ 1 & -\\gamma \\end{pmatrix} \\begin{pmatrix} z(t) \\\\ y(t) \\end{pmatrix}\n$$\n$z(t)$ 的初始条件给定为 $z(0) = 1$。$y(t)$ 的初始条件从其定义中找到：\n$$\ny(0) = \\int_0^0 e^{-\\gamma (0-s)} z(s)\\, ds = 0\n$$\n因此，初始状态向量是 $(z(0), y(0))^T = (1, 0)^T$。\n\n**第三部分：ODE 系统的精确解**\n我们通过求解系数矩阵 $A = \\begin{pmatrix} 0 & -\\kappa \\\\ 1 & -\\gamma \\end{pmatrix}$ 的特征值来解此系统。特征方程为 $\\det(A - \\lambda I) = 0$：\n$$\n(-\\lambda)(-\\gamma - \\lambda) - (-\\kappa)(1) = \\lambda^2 + \\gamma\\lambda + \\kappa = 0\n$$\n特征值是这个二次方程的根：\n$$\n\\lambda_{1,2} = \\frac{-\\gamma \\pm \\sqrt{\\gamma^2 - 4\\kappa}}{2}\n$$\n$z(t)$ 的通解取决于判别式 $\\Delta' = \\gamma^2 - 4\\kappa$ 的符号。\n\n1.  **过阻尼情况 ($\\Delta' > 0$)：** 特征值 $\\lambda_1, \\lambda_2$ 是实数且不相等。通解为 $z(t) = c_1 e^{\\lambda_1 t} + c_2 e^{\\lambda_2 t}$。应用初始条件 $z(0)=1$ 和 $y(0) = -\\frac{1}{\\kappa}\\dot{z}(0) = 0$ 得到 $c_1+c_2=1$ 和 $c_1\\lambda_1+c_2\\lambda_2=0$。解出系数得 $c_1 = -\\frac{\\lambda_2}{\\lambda_1 - \\lambda_2}$ 和 $c_2 = \\frac{\\lambda_1}{\\lambda_1 - \\lambda_2}$。解为：\n    $$\n    z(t) = \\frac{1}{\\lambda_1 - \\lambda_2} \\left( \\lambda_1 e^{\\lambda_2 t} - \\lambda_2 e^{\\lambda_1 t} \\right)\n    $$\n\n2.  **临界阻尼情况 ($\\Delta' = 0$)：** 有一个重复的特征值 $\\lambda = -\\gamma/2$。通解为 $z(t) = (c_1 + c_2 t)e^{\\lambda t}$。应用初始条件 $z(0)=1$ 和 $\\dot{z}(0)=0$ 得到 $c_1=1$ 和 $c_2 = -\\lambda = \\gamma/2$。解为：\n    $$\n    z(t) = \\left(1 + \\frac{\\gamma}{2} t\\right) e^{-\\gamma t/2}\n    $$\n\n3.  **欠阻尼情况 ($\\Delta' < 0$)：** 特征值是复共轭的，$\\lambda_{1,2} = -\\frac{\\gamma}{2} \\pm i\\omega$，其中 $\\omega = \\frac{\\sqrt{4\\kappa - \\gamma^2}}{2}$。解是一个阻尼正弦波：\n    $$\n    z(t) = e^{-\\gamma t/2} \\left( c_1 \\cos(\\omega t) + c_2 \\sin(\\omega t) \\right)\n    $$\n    应用初始条件 $z(0)=1$ 得到 $c_1=1$。从 $\\dot{z}(0)=0$ 我们发现 $-\\frac{\\gamma}{2}c_1 + \\omega c_2 = 0$，所以 $c_2 = \\frac{\\gamma}{2\\omega}$。解为：\n    $$\n    z(t) = e^{-\\gamma t/2} \\left( \\cos(\\omega t) + \\frac{\\gamma}{2\\omega} \\sin(\\omega t) \\right)\n    $$\n\n这三个公式为任何有效的参数集 $\\kappa$ 和 $\\gamma$ 提供了精确解 $z_{\\mathrm{exact}}(t)$。\n\n**第四部分：数值实现设计**\n将实现一个 Python 程序来执行所需的计算。该程序将包含一个主函数 `solve()`，该函数迭代遍历测试用例。一个辅助函数 `compute_errors(\\kappa, \\gamma, t_f, dt, \\tau_c)` 将处理单个测试用例的逻辑。\n\n1.  **精确解计算：** 在 `compute_errors` 内部，我们首先计算判别式 $\\Delta' = \\gamma^2 - 4\\kappa$。根据其符号，使用第三部分相应的解析公式来计算 $z_{\\mathrm{exact}}(t_f)$。\n\n2.  **数值演化：**\n    - 时间步数是 $N = \\mathrm{round}(t_f / dt)$。\n    - 我们为大小为 $N+1$ 的 $z$ 和 $y$ 初始化 NumPy 数组。\n    - **完整记忆 ($z_{\\mathrm{disc}}$)：**\n        - 初始化 $z_{\\mathrm{disc}}[0] = 1.0$，$y_{\\mathrm{disc}}[0] = 0.0$。\n        - 一个从 $n=0$ 到 $N-1$ 的 `for` 循环实现递归关系：\n          $z_{\\mathrm{disc}}[n+1] = z_{\\mathrm{disc}}[n] - dt \\cdot \\kappa \\cdot y_{\\mathrm{disc}}[n]$\n          $y_{\\mathrm{disc}}[n+1] = e^{-\\gamma dt} y_{\\mathrm{disc}}[n] + z_{\\mathrm{disc}}[n+1] \\cdot dt$\n        - 最终值为 $z_{\\mathrm{disc}}[N]$。\n    - **截断记忆 ($z_{\\mathrm{trunc}}$)：**\n        - 计算 $M = \\lceil \\tau_c / dt \\rceil$。\n        - 初始化 $z_{\\mathrm{trunc}}[0] = 1.0$，$y_{\\mathrm{trunc}}[0] = 0.0$。\n        - 一个从 $n=0$ 到 $N-1$ 的 `for` 循环实现截断递归：\n          $z_{\\mathrm{trunc}}[n+1] = z_{\\mathrm{trunc}}[n] - dt \\cdot \\kappa \\cdot y_{\\mathrm{trunc}}[n]$\n          $y_{\\mathrm{trunc}}[n+1] = e^{-\\gamma dt} y_{\\mathrm{trunc}}[n] + z_{\\mathrm{trunc}}[n+1] \\cdot dt$\n          如果 $n+1 \\ge M$，则减去一个校正项：\n          $y_{\\mathrm{trunc}}[n+1] -= e^{-\\gamma \\tau_c} z_{\\mathrm{trunc}}[n+1-M] \\cdot dt$\n        - 最终值为 $z_{\\mathrm{trunc}}[N]$。\n\n3.  **误差计算：** 计算绝对误差 $E_T = |z_{\\mathrm{trunc}}[N] - z_{\\mathrm{exact}}(t_f)|$ 和 $E_D = |z_{\\mathrm{disc}}[N] - z_{\\mathrm{exact}}(t_f)|$。返回数对 $[E_T, E_D]$。\n\n主函数 `solve` 将收集所有测试用例的这些数对，并以指定格式打印它们。实现将使用 `numpy` 进行高效的数组操作和数学函数计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_errors(kappa, gamma, t_f, dt, tau_c):\n    \"\"\"\n    Computes kernel truncation error (E_T) and numerical discretization error (E_D)\n    for the given parameters.\n    \"\"\"\n    # Part 1: Calculate the exact solution at t_f\n    discriminant = gamma**2 - 4 * kappa\n    \n    # Add a small tolerance for floating point comparison to zero\n    if abs(discriminant)  1e-15:  # Critically damped\n        lam = -gamma / 2.0\n        z_exact = (1.0 + (-lam) * t_f) * np.exp(lam * t_f)\n    elif discriminant > 0:  # Overdamped\n        sqrt_disc = np.sqrt(discriminant)\n        l1 = (-gamma + sqrt_disc) / 2.0\n        l2 = (-gamma - sqrt_disc) / 2.0\n        z_exact = (l1 * np.exp(l2 * t_f) - l2 * np.exp(l1 * t_f)) / (l1 - l2)\n    else:  # Underdamped\n        omega = np.sqrt(-discriminant) / 2.0\n        z_exact = np.exp(-gamma * t_f / 2.0) * (np.cos(omega * t_f) + (gamma / (2.0 * omega)) * np.sin(omega * t_f))\n\n    # Part 2: Numerical simulations\n    N = int(round(t_f / dt))\n\n    # 2a: Full memory (for discretization error)\n    z_disc = np.zeros(N + 1)\n    y_disc = np.zeros(N + 1)\n    z_disc[0] = 1.0\n    y_disc[0] = 0.0\n    \n    exp_gamma_dt = np.exp(-gamma * dt)\n\n    for n in range(N):\n        z_disc[n + 1] = z_disc[n] - dt * kappa * y_disc[n]\n        y_disc[n + 1] = exp_gamma_dt * y_disc[n] + z_disc[n + 1] * dt\n    \n    z_disc_tf = z_disc[N]\n\n    # 2b: Truncated memory (for truncation error)\n    z_trunc = np.zeros(N + 1)\n    y_trunc = np.zeros(N + 1)\n    z_trunc[0] = 1.0\n    y_trunc[0] = 0.0\n\n    M = int(np.ceil(tau_c / dt))\n    exp_gamma_tau_c = np.exp(-gamma * tau_c)\n\n    for n in range(N):\n        z_trunc[n + 1] = z_trunc[n] - dt * kappa * y_trunc[n]\n        y_trunc[n + 1] = exp_gamma_dt * y_trunc[n] + z_trunc[n + 1] * dt\n        \n        # Apply truncation correction term\n        if (n + 1) >= M:\n            # The removal term Theta(n+1-M) is active\n            removal_term = exp_gamma_tau_c * z_trunc[n + 1 - M] * dt\n            y_trunc[n + 1] -= removal_term\n            \n    z_trunc_tf = z_trunc[N]\n\n    # Part 3: Calculate errors\n    E_T = abs(z_trunc_tf - z_exact)\n    E_D = abs(z_disc_tf - z_exact)\n    \n    return [E_T, E_D]\n\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    # Test suite: (kappa, gamma, t_f, dt, tau_c)\n    test_cases = [\n        # Case A (general, moderate memory)\n        (0.5, 2.0, 5.0, 0.05, 1.0),\n        # Case B (long memory, severe truncation)\n        (0.02, 0.4, 8.0, 0.05, 0.5),\n        # Case C (short memory, mild truncation)\n        (1.0, 3.0, 2.0, 0.05, 0.3),\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa, gamma, t_f, dt, tau_c = case\n        errors = compute_errors(kappa, gamma, t_f, dt, tau_c)\n        results.append(errors)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is the desired format.\n    print(f\"[[{results[0][0]},{results[0][1]}],[{results[1][0]},{results[1][1]}],[{results[2][0]},{results[2][1]}]\")\n\nsolve()\n```"
        }
    ]
}