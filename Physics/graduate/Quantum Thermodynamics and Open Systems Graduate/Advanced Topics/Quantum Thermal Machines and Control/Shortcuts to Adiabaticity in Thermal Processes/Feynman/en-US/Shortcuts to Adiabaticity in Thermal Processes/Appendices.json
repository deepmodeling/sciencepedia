{
    "hands_on_practices": [
        {
            "introduction": "To guide a quantum system through a process in finite time without generating unwanted excitations, we need a robust theoretical framework. The concept of a dynamical invariant, an operator whose expectation values are constant for any solution of the Schrödinger equation, provides exactly this. This first exercise  lays the groundwork by asking you to construct the celebrated Lewis-Riesenfeld invariant for the time-dependent harmonic oscillator, a cornerstone of many inverse-engineering approaches to Shortcuts to Adiabaticity.",
            "id": "3784037",
            "problem": "A single-mode quantum working medium in a finite-time isothermal or isentropic stroke of a quantum heat engine can be modeled as a time-dependent harmonic oscillator with Hamiltonian $H(t)=\\frac{\\hat{p}^{2}}{2m}+\\frac{1}{2} m \\omega(t)^{2} \\hat{x}^{2}$, where $m$ is the mass, $\\hat{x}$ and $\\hat{p}$ are the position and momentum operators, and $\\omega(t)$ is a prescribed positive, smooth frequency protocol that implements a shortcut to adiabaticity. An operator $\\hat{I}(t)$ is called a dynamical invariant if it satisfies the Liouville–von Neumann invariance condition $\\frac{d \\hat{I}}{dt}=\\frac{\\partial \\hat{I}}{\\partial t}+\\frac{i}{\\hbar}[\\hat{H}(t),\\hat{I}(t)]=0$. Starting only from the canonical commutation relation $[\\hat{x},\\hat{p}]=i\\hbar$ and the Heisenberg equations of motion generated by $\\hat{H}(t)$, construct a quadratic invariant based on a time-dependent scaling of coordinates by a strictly positive, twice-differentiable function $b(t)$ and a constant frequency scale $\\omega_{0}>0$, such that the invariant reduces to that of a stationary harmonic oscillator of frequency $\\omega_{0}$ in appropriately scaled variables. Then, by enforcing the invariance condition, derive the differential equation that $b(t)$ must satisfy. Explicitly state any intermediate canonical transformations you use, and ensure your derivation is self-contained and logically consistent from first principles.\n\nExpress your final answer as a single closed-form analytical expression for the invariant operator $\\hat{I}(t)$ in terms of $\\hat{x}$, $\\hat{p}$, $m$, $b(t)$, $\\dot{b}(t)$, and $\\omega_{0}$. Do not include units in the final answer.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. It presents a standard but rigorous exercise in quantum dynamics, specifically the derivation of the Lewis-Riesenfeld invariant for a time-dependent harmonic oscillator. There are no contradictions, ambiguities, or factual errors. We may therefore proceed with the solution.\n\nOur objective is to construct a quadratic dynamical invariant $\\hat{I}(t)$ for a time-dependent harmonic oscillator with Hamiltonian $\\hat{H}(t)=\\frac{\\hat{p}^{2}}{2m}+\\frac{1}{2} m \\omega(t)^{2} \\hat{x}^{2}$. The invariant must satisfy the Liouville–von Neumann equation:\n$$\n\\frac{d \\hat{I}}{dt} = \\frac{\\partial \\hat{I}}{\\partial t}+\\frac{i}{\\hbar}[\\hat{H}(t),\\hat{I}(t)] = 0\n$$\nThe problem specifies that this invariant should reduce to the form of a stationary harmonic oscillator Hamiltonian with a constant frequency $\\omega_0$ under a time-dependent scaling transformation defined by a function $b(t)$.\n\nFirst, we define this time-dependent canonical transformation. Let the scaled position operator be $\\hat{X}(t)$:\n$$\n\\hat{X}(t) = \\frac{\\hat{x}}{b(t)}\n$$\nWe must find a corresponding scaled momentum operator $\\hat{P}(t)$ such that the canonical commutation relation $[\\hat{X}(t), \\hat{P}(t)] = i\\hbar$ is preserved. This ensures the transformation is canonical. A suitable form for such a transformation, which can be derived from a generating function, is:\n$$\n\\hat{P}(t) = b(t)\\hat{p} - m\\dot{b}(t)\\hat{x}\n$$\nwhere $\\dot{b}(t)$ is the time derivative of $b(t)$. We verify that this choice preserves the canonical commutation relation. Note that $b(t)$ and $\\dot{b}(t)$ are c-numbers and commute with all operators.\n$$\n[\\hat{X}(t), \\hat{P}(t)] = \\left[ \\frac{\\hat{x}}{b(t)}, b(t)\\hat{p} - m\\dot{b}(t)\\hat{x} \\right] \\\\\n= \\frac{1}{b(t)} [\\hat{x}, b(t)\\hat{p} - m\\dot{b}(t)\\hat{x}] \\\\\n= \\frac{1}{b(t)} \\left( b(t)[\\hat{x}, \\hat{p}] - m\\dot{b}(t)[\\hat{x}, \\hat{x}] \\right)\n$$\nUsing the fundamental commutation relation $[\\hat{x}, \\hat{p}] = i\\hbar$ and $[\\hat{x}, \\hat{x}] = 0$, we get:\n$$\n[\\hat{X}(t), \\hat{P}(t)] = \\frac{1}{b(t)} \\left( b(t)(i\\hbar) - 0 \\right) = i\\hbar\n$$\nThe transformation is indeed canonical.\n\nFollowing the problem's directive, we construct the invariant $\\hat{I}(t)$ to have the form of the Hamiltonian for a simple harmonic oscillator of mass $m$ and constant frequency $\\omega_0$ in terms of the scaled operators $\\hat{X}(t)$ and $\\hat{P}(t)$:\n$$\n\\hat{I}(t) = \\frac{\\hat{P}(t)^2}{2m} + \\frac{1}{2}m\\omega_0^2 \\hat{X}(t)^2\n$$\nTo proceed with the invariance condition, we express $\\hat{I}(t)$ in terms of the original operators $\\hat{x}$ and $\\hat{p}$:\n$$\n\\hat{I}(t) = \\frac{1}{2m} \\left( b(t)\\hat{p} - m\\dot{b}(t)\\hat{x} \\right)^2 + \\frac{1}{2}m\\omega_0^2 \\left( \\frac{\\hat{x}}{b(t)} \\right)^2 \\\\\n\\hat{I}(t) = \\frac{1}{2m} \\left( b(t)^2 \\hat{p}^2 - m\\dot{b}(t)b(t)(\\hat{x}\\hat{p} + \\hat{p}\\hat{x}) + m^2\\dot{b}(t)^2 \\hat{x}^2 \\right) + \\frac{m\\omega_0^2}{2b(t)^2} \\hat{x}^2\n$$\nThis simplifies to:\n$$\n\\hat{I}(t) = \\frac{b(t)^2}{2m} \\hat{p}^2 - \\frac{\\dot{b}(t)b(t)}{2} (\\hat{x}\\hat{p} + \\hat{p}\\hat{x}) + \\left( \\frac{m\\dot{b}(t)^2}{2} + \\frac{m\\omega_0^2}{2b(t)^2} \\right) \\hat{x}^2\n$$\nThis is the candidate for the quadratic invariant. To derive the condition on $b(t)$, we must enforce the invariance condition $\\frac{d\\hat{I}}{dt}=0$. We will compute the two terms, $\\frac{\\partial \\hat{I}}{\\partial t}$ and $\\frac{i}{\\hbar}[\\hat{H}, \\hat{I}]$, separately.\n\nFirst, the partial time derivative of $\\hat{I}(t)$ is:\n$$\n\\frac{\\partial \\hat{I}}{\\partial t} = \\frac{b\\dot{b}}{m}\\hat{p}^2 - \\frac{1}{2}(\\ddot{b}b + \\dot{b}^2)(\\hat{x}\\hat{p} + \\hat{p}\\hat{x}) + \\left( m\\dot{b}\\ddot{b} - \\frac{m\\omega_0^2\\dot{b}}{b^3} \\right)\\hat{x}^2\n$$\n\nSecond, we compute the commutator $[\\hat{H}(t), \\hat{I}(t)]$. We use the following basic commutator identities, which follow from $[\\hat{x}, \\hat{p}] = i\\hbar$:\n$[\\hat{p}^2, \\hat{x}] = -2i\\hbar\\hat{p}$, $[\\hat{x}^2, \\hat{p}] = 2i\\hbar\\hat{x}$, $[\\hat{p}^2, \\hat{x}^2] = -2i\\hbar(\\hat{x}\\hat{p} + \\hat{p}\\hat{x})$, $[\\hat{x}^2, \\hat{x}\\hat{p}+\\hat{p}\\hat{x}] = 4i\\hbar\\hat{x}^2$, $[\\hat{p}^2, \\hat{x}\\hat{p}+\\hat{p}\\hat{x}] = -4i\\hbar\\hat{p}^2$.\n\nLet's compute the commutator term by term.\n$\\hat{H}(t) = \\frac{\\hat{p}^2}{2m} + \\frac{1}{2}m\\omega(t)^2\\hat{x}^2$\n$\\hat{I}(t) = \\frac{b^2}{2m} \\hat{p}^2 - \\frac{b\\dot{b}}{2}(\\hat{x}\\hat{p} + \\hat{p}\\hat{x}) + \\frac{m}{2} \\left(\\dot{b}^2+\\frac{\\omega_0^2}{b^2}\\right) \\hat{x}^2$\nThe non-zero commutators are:\n$$\n\\left[ \\frac{\\hat{p}^2}{2m}, -\\frac{b\\dot{b}}{2}(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) \\right] = -\\frac{b\\dot{b}}{4m}[\\hat{p}^2, \\hat{x}\\hat{p}+\\hat{p}\\hat{x}] = -\\frac{b\\dot{b}}{4m}(-4i\\hbar\\hat{p}^2) = \\frac{i\\hbar b\\dot{b}}{m}\\hat{p}^2\n$$\n$$\n\\left[ \\frac{\\hat{p}^2}{2m}, \\frac{m}{2} \\left(\\dot{b}^2+\\frac{\\omega_0^2}{b^2}\\right) \\hat{x}^2 \\right] = \\frac{1}{4} \\left(\\dot{b}^2+\\frac{\\omega_0^2}{b^2}\\right) [\\hat{p}^2, \\hat{x}^2] = \\frac{1}{4} \\left(\\dot{b}^2+\\frac{\\omega_0^2}{b^2}\\right) (-2i\\hbar(\\hat{x}\\hat{p}+\\hat{p}\\hat{x})) = -\\frac{i\\hbar}{2} \\left(\\dot{b}^2+\\frac{\\omega_0^2}{b^2}\\right)(\\hat{x}\\hat{p}+\\hat{p}\\hat{x})\n$$\n$$\n\\left[ \\frac{1}{2}m\\omega^2\\hat{x}^2, \\frac{b^2}{2m}\\hat{p}^2 \\right] = \\frac{\\omega^2 b^2}{4}[\\hat{x}^2, \\hat{p}^2] = \\frac{\\omega^2 b^2}{4}(2i\\hbar(\\hat{x}\\hat{p}+\\hat{p}\\hat{x})) = \\frac{i\\hbar\\omega^2 b^2}{2}(\\hat{x}\\hat{p}+\\hat{p}\\hat{x})\n$$\n$$\n\\left[ \\frac{1}{2}m\\omega^2\\hat{x}^2, -\\frac{b\\dot{b}}{2}(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) \\right] = -\\frac{m\\omega^2 b\\dot{b}}{4}[\\hat{x}^2, \\hat{x}\\hat{p}+\\hat{p}\\hat{x}] = -\\frac{m\\omega^2 b\\dot{b}}{4}(4i\\hbar\\hat{x}^2) = -i\\hbar m\\omega^2 b\\dot{b} \\hat{x}^2\n$$\nSumming these terms, we get $[\\hat{H}(t), \\hat{I}(t)]$:\n$$\n[\\hat{H}, \\hat{I}] = \\frac{i\\hbar b\\dot{b}}{m}\\hat{p}^2 + \\left(-\\frac{i\\hbar}{2}(\\dot{b}^2+\\frac{\\omega_0^2}{b^2}) + \\frac{i\\hbar\\omega^2 b^2}{2}\\right)(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) -i\\hbar m\\omega^2 b\\dot{b} \\hat{x}^2\n$$\nThen, $\\frac{i}{\\hbar}[\\hat{H}(t), \\hat{I}(t)]$ is:\n$$\n\\frac{i}{\\hbar}[\\hat{H}, \\hat{I}] = -\\frac{b\\dot{b}}{m}\\hat{p}^2 + \\left(\\frac{1}{2}(\\dot{b}^2+\\frac{\\omega_0^2}{b^2}) - \\frac{\\omega^2 b^2}{2}\\right)(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) + m\\omega^2 b\\dot{b} \\hat{x}^2\n$$\nNow we enforce the invariance condition by summing the partial derivative and the commutator term, and setting the result to zero. We group terms by the operators $\\hat{p}^2$, $(\\hat{x}\\hat{p}+\\hat{p}\\hat{x})$, and $\\hat{x}^2$.\n$$\n\\left( \\frac{b\\dot{b}}{m} - \\frac{b\\dot{b}}{m} \\right)\\hat{p}^2 + \\left( -\\frac{\\ddot{b}b+\\dot{b}^2}{2} + \\frac{\\dot{b}^2+\\frac{\\omega_0^2}{b^2}}{2} - \\frac{\\omega^2b^2}{2} \\right)(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) + \\left( m\\dot{b}\\ddot{b} - \\frac{m\\omega_0^2\\dot{b}}{b^3} + m\\omega^2b\\dot{b} \\right)\\hat{x}^2 = 0\n$$\nSince the operators $\\hat{p}^2$, $\\hat{x}^2$, and $(\\hat{x}\\hat{p}+\\hat{p}\\hat{x})$ are linearly independent, their coefficients must vanish independently.\n\nCoefficient of $\\hat{p}^2$:\nThe coefficient is $0$, so this condition is automatically satisfied. This confirms the consistency of the kinetic part of our invariant construction.\n\nCoefficient of $(\\hat{x}\\hat{p}+\\hat{p}\\hat{x})$:\n$$\n-\\frac{\\ddot{b}b+\\dot{b}^2}{2} + \\frac{\\dot{b}^2}{2} + \\frac{\\omega_0^2}{2b^2} - \\frac{\\omega^2b^2}{2} = 0 \\\\\n-\\frac{\\ddot{b}b}{2} + \\frac{\\omega_0^2}{2b^2} - \\frac{\\omega^2b^2}{2} = 0\n$$\nMultiplying by $-\\frac{2}{b}$ (since $b>0$) gives:\n$$\n\\ddot{b} - \\frac{\\omega_0^2}{b^3} + \\omega^2b = 0 \\implies \\ddot{b}(t) + \\omega(t)^2 b(t) = \\frac{\\omega_0^2}{b(t)^3}\n$$\n\nCoefficient of $\\hat{x}^2$:\n$$\nm\\dot{b}\\ddot{b} - \\frac{m\\omega_0^2\\dot{b}}{b^3} + m\\omega^2b\\dot{b} = 0\n$$\nAssuming $\\dot{b}(t) \\neq 0$ for a non-trivial evolution, we can divide by $m\\dot{b}$:\n$$\n\\ddot{b} - \\frac{\\omega_0^2}{b^3} + \\omega^2b = 0 \\implies \\ddot{b}(t) + \\omega(t)^2 b(t) = \\frac{\\omega_0^2}{b(t)^3}\n$$\nBoth conditions yield the same differential equation for $b(t)$, known as the Ermakov equation. This demonstrates the internal consistency of the derivation. The proposed operator $\\hat{I}(t)$ is a dynamical invariant if and only if the scaling factor $b(t)$ is a solution to this nonlinear ordinary differential equation.\n\nThe problem requires the final expression for the invariant operator $\\hat{I}(t)$. This was constructed from the scaled variables and then expressed using the original operators. The expression is:\n$$\n\\hat{I}(t) = \\frac{1}{2m} (b(t)\\hat{p} - m\\dot{b}(t)\\hat{x})^2 + \\frac{m\\omega_0^2}{2b(t)^2}\\hat{x}^2\n$$\nThis is the required closed-form analytical expression for the invariant in terms of the specified quantities.",
            "answer": "$$\n\\boxed{\\frac{1}{2m} \\left( b(t)\\hat{p} - m\\dot{b}(t)\\hat{x} \\right)^2 + \\frac{m\\omega_{0}^{2}}{2b(t)^{2}}\\hat{x}^2}\n$$"
        },
        {
            "introduction": "Having established a method for dynamically guiding a quantum system, we now turn to its thermodynamic implications. The ultimate goal of a thermal shortcut is often to perform a process both quickly and efficiently. This practice  connects the dynamics of an ideal STA protocol directly to its thermodynamic signature, revealing that such a process is perfectly reversible. By calculating fundamental thermodynamic quantities, you will demonstrate that the system's entropy change is entirely due to heat exchange with the reservoir, confirming the profound efficiency of these advanced control techniques.",
            "id": "3784061",
            "problem": "Consider a quantum harmonic oscillator of mass $m$ with a time-dependent angular frequency $\\omega(t)$ in contact with a weak, Markovian thermal reservoir at fixed inverse temperature $\\beta = 1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant and $T$ is the temperature. A Shortcuts to Adiabaticity (STA) protocol is implemented via reservoir engineering so that, for all times $t \\in [0,\\tau]$, the system’s density operator is the instantaneous Gibbs state $\\rho(t) = \\exp(-\\beta H_{0}(t))/Z(t)$ of the bare Hamiltonian $H_{0}(t)$, where $H_{0}(t) = p^{2}/(2m) + \\tfrac{1}{2} m \\omega(t)^{2} x^{2}$ and $Z(t) = \\operatorname{Tr}[\\exp(-\\beta H_{0}(t))]$. The frequency is varied according to a $C^{2}$-smooth quintic protocol\n$$\n\\omega(t) = \\omega_{i} + \\big(\\omega_{f} - \\omega_{i}\\big)\\left[10 s^{3} - 15 s^{4} + 6 s^{5}\\right], \\quad s \\equiv \\frac{t}{\\tau},\n$$\nso that $\\omega(0) = \\omega_{i}$, $\\omega(\\tau) = \\omega_{f}$, and $\\dot{\\omega}(0) = \\dot{\\omega}(\\tau) = 0$. Assume the Gorini–Kossakowski–Sudarshan–Lindblad (GKSL) generator of the open-system dynamics satisfies instantaneous detailed balance at inverse temperature $\\beta$, guaranteeing $\\rho(t)$ remains Gibbs with respect to $H_{0}(t)$ at all times.\n\nUsing only fundamental definitions from quantum thermodynamics, namely the von Neumann entropy $S(t) = -\\operatorname{Tr}[\\rho(t) \\ln \\rho(t)]$, the partition function $Z(t) = \\operatorname{Tr}[\\exp(-\\beta H_{0}(t))]$, the first law $d\\langle H_{0}\\rangle = \\delta Q + \\delta W$, and the identifications $\\dot{W}(t) = \\operatorname{Tr}[\\rho(t)\\,\\dot{H}_{0}(t)]$ and $\\dot{Q}(t) = \\operatorname{Tr}[H_{0}(t)\\,\\dot{\\rho}(t)]$, perform the following:\n\n1. Derive explicit expressions for the instantaneous internal energy $U(t) = \\langle H_{0}(t)\\rangle$ and the entropy $S(t)$ of the Gibbs state in terms of $\\beta$, $\\hbar$, and $\\omega(t)$.\n2. Compute the instantaneous work rate $\\dot{W}(t)$ generated by the parametric change $\\omega(t)$ and the instantaneous heat rate $\\dot{Q}(t)$ using the first law and the Gibbs property.\n3. Define the residual\n$$\nR(t) \\equiv \\frac{dS(t)}{dt} - \\beta\\,\\dot{Q}(t),\n$$\nand simplify $R(t)$ to a closed-form analytic expression along the full protocol.\n\nYour final answer must be the simplified analytic expression for $R(t)$. No numerical rounding is required. If your answer involves constants, keep them symbolic (e.g., $k_{B}$, $\\hbar$, $\\beta$). Do not include units in your final boxed answer.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. We proceed with the derivation. The solution is structured in three parts as requested by the problem statement.\n\nThe analysis hinges on the properties of the instantaneous Gibbs state $\\rho(t) = \\exp(-\\beta H_{0}(t))/Z(t)$ for the quantum harmonic oscillator, whose Hamiltonian is $H_{0}(t) = p^{2}/(2m) + \\frac{1}{2} m \\omega(t)^{2} x^{2}$. The energy eigenvalues are $E_n(t) = \\hbar \\omega(t) (n + 1/2)$ for $n \\in \\{0, 1, 2, ...\\}$.\n\n**1. Derivation of Internal Energy $U(t)$ and Entropy $S(t)$**\n\nFirst, we compute the partition function $Z(t)$.\n$$\nZ(t) = \\operatorname{Tr}[\\exp(-\\beta H_{0}(t))] = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_n(t)) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\beta \\hbar \\omega(t) \\left(n + \\frac{1}{2}\\right)\\right)\n$$\nThis is a geometric series:\n$$\nZ(t) = \\exp\\left(-\\frac{\\beta \\hbar \\omega(t)}{2}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp(-\\beta \\hbar \\omega(t))\\right]^n = \\frac{\\exp(-\\frac{\\beta \\hbar \\omega(t)}{2})}{1 - \\exp(-\\beta \\hbar \\omega(t))}\n$$\nThis expression can be simplified using hyperbolic functions:\n$$\nZ(t) = \\frac{1}{\\exp(\\frac{\\beta \\hbar \\omega(t)}{2}) - \\exp(-\\frac{\\beta \\hbar \\omega(t)}{2})} = \\frac{1}{2 \\sinh\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)}\n$$\nThe instantaneous internal energy $U(t) = \\langle H_{0}(t)\\rangle$ is derived from the partition function:\n$$\nU(t) = -\\frac{\\partial}{\\partial \\beta} \\ln Z(t) = -\\frac{\\partial}{\\partial \\beta} \\left[-\\ln\\left(2 \\sinh\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\\right)\\right]\n$$\n$$\nU(t) = \\frac{1}{2 \\sinh\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)} \\cdot \\left[2 \\cosh\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\\right] \\cdot \\left(\\frac{\\hbar \\omega(t)}{2}\\right) = \\frac{\\hbar \\omega(t)}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\n$$\nThe von Neumann entropy is given by $S(t) = -\\operatorname{Tr}[\\rho(t) \\ln \\rho(t)]$. For a Gibbs state, $\\ln \\rho(t) = -\\beta H_0(t) - \\ln Z(t)$, which leads to:\n$$\nS(t) = -\\operatorname{Tr}[\\rho(t)(-\\beta H_0(t) - \\ln Z(t)\\cdot\\mathbb{1})] = \\beta \\operatorname{Tr}[\\rho(t)H_0(t)] + \\ln Z(t)\\operatorname{Tr}[\\rho(t)]\n$$\nSince $\\operatorname{Tr}[\\rho(t)]=1$ and $\\operatorname{Tr}[\\rho(t)H_0(t)] = U(t)$, we obtain the standard thermodynamic relation:\n$$\nS(t) = \\beta U(t) + \\ln Z(t)\n$$\nSubstituting the expressions for $U(t)$ and $Z(t)$:\n$$\nS(t) = \\frac{\\beta \\hbar \\omega(t)}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right) - \\ln\\left[2 \\sinh\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\\right]\n$$\n\n**2. Computation of Work Rate $\\dot{W}(t)$ and Heat Rate $\\dot{Q}(t)$**\n\nThe work rate is defined as $\\dot{W}(t) = \\operatorname{Tr}[\\rho(t)\\,\\dot{H}_{0}(t)]$. The time derivative of the Hamiltonian is:\n$$\n\\dot{H}_{0}(t) = \\frac{\\partial H_{0}(t)}{\\partial \\omega(t)} \\dot{\\omega}(t) = \\left(m \\omega(t) x^{2}\\right) \\dot{\\omega}(t)\n$$\nThus, the work rate is:\n$$\n\\dot{W}(t) = \\operatorname{Tr}[\\rho(t) (m \\omega(t) \\dot{\\omega}(t) x^{2})] = m \\omega(t) \\dot{\\omega}(t) \\langle x^{2} \\rangle_{t}\n$$\nFor a harmonic oscillator in a thermal state, the quantum virial theorem states that the average kinetic energy equals the average potential energy: $\\langle T \\rangle_{t} = \\langle V \\rangle_{t}$. Therefore, the internal energy $U(t) = \\langle T \\rangle_{t} + \\langle V \\rangle_{t} = 2 \\langle V \\rangle_{t}$.\n$$\nU(t) = 2 \\left\\langle \\frac{1}{2} m \\omega(t)^{2} x^{2} \\right\\rangle_{t} = m \\omega(t)^{2} \\langle x^{2} \\rangle_{t}\n$$\nFrom this, we find the expectation value of $x^{2}$: $\\langle x^{2} \\rangle_{t} = \\frac{U(t)}{m \\omega(t)^{2}}$.\nSubstituting this into the expression for the work rate:\n$$\n\\dot{W}(t) = m \\omega(t) \\dot{\\omega}(t) \\left(\\frac{U(t)}{m \\omega(t)^{2}}\\right) = \\frac{\\dot{\\omega}(t)}{\\omega(t)} U(t)\n$$\nUsing the first law, $\\dot{Q}(t) = \\dot{U}(t) - \\dot{W}(t)$. We first compute $\\dot{U}(t)$ using the chain rule, $\\dot{U}(t) = \\frac{dU}{d\\omega} \\dot{\\omega}(t)$:\n$$\n\\frac{dU}{d\\omega} = \\frac{d}{d\\omega}\\left[\\frac{\\hbar \\omega}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right)\\right] = \\frac{\\hbar}{2}\\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right) + \\frac{\\hbar \\omega}{2} \\left[-\\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega}{2}\\right) \\cdot \\frac{\\beta \\hbar}{2}\\right]\n$$\n$$\n\\dot{U}(t) = \\dot{\\omega}(t) \\left[ \\frac{\\hbar}{2}\\coth\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right) - \\frac{\\beta \\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right) \\right]\n$$\nNow, we find $\\dot{Q}(t)$:\n$$\n\\dot{Q}(t) = \\dot{U}(t) - \\frac{\\dot{\\omega}(t)}{\\omega(t)} U(t) = \\dot{U}(t) - \\frac{\\dot{\\omega}(t)}{\\omega(t)} \\left[\\frac{\\hbar \\omega(t)}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\\right]\n$$\n$$\n\\dot{Q}(t) = \\dot{\\omega}(t) \\left[ \\frac{\\hbar}{2}\\coth\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right) - \\frac{\\beta \\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right) \\right] - \\dot{\\omega}(t) \\frac{\\hbar}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\n$$\nThe first and last terms cancel, leaving:\n$$\n\\dot{Q}(t) = - \\dot{\\omega}(t) \\frac{\\beta \\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\n$$\n\n**3. Simplification of the Residual $R(t)$**\n\nThe residual is defined as $R(t) = \\frac{dS(t)}{dt} - \\beta\\,\\dot{Q}(t)$. We need to compute the rate of change of entropy, $\\dot{S}(t) = \\frac{dS}{dt}$. Using the chain rule $\\dot{S}(t) = \\frac{dS}{d\\omega} \\dot{\\omega}(t)$ and the relation $S = \\beta U + \\ln Z$:\n$$\n\\frac{dS}{d\\omega} = \\beta \\frac{dU}{d\\omega} + \\frac{d(\\ln Z)}{d\\omega}\n$$\nWe have already computed $\\frac{dU}{d\\omega}$. We now compute $\\frac{d(\\ln Z)}{d\\omega}$:\n$$\n\\frac{d(\\ln Z)}{d\\omega} = \\frac{d}{d\\omega}\\left[-\\ln\\left(2\\sinh\\left(\\frac{\\beta \\hbar \\omega}{2}\\right)\\right)\\right] = -\\frac{1}{2\\sinh(\\cdot)} \\cdot 2\\cosh(\\cdot) \\cdot \\frac{\\beta \\hbar}{2} = -\\frac{\\beta \\hbar}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right)\n$$\nSubstituting the expressions for $\\frac{dU}{d\\omega}$ and $\\frac{d(\\ln Z)}{d\\omega}$ into $\\frac{dS}{d\\omega}$:\n$$\n\\frac{dS}{d\\omega} = \\beta\\left[\\frac{\\hbar}{2}\\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right) - \\frac{\\beta \\hbar^{2} \\omega}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega}{2}\\right)\\right] - \\frac{\\beta \\hbar}{2} \\coth\\left(\\frac{\\beta \\hbar \\omega}{2}\\right)\n$$\nThe terms involving $\\coth$ cancel out:\n$$\n\\frac{dS}{d\\omega} = - \\beta^{2} \\frac{\\hbar^{2} \\omega}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega}{2}\\right)\n$$\nTherefore, the rate of change of entropy is:\n$$\n\\dot{S}(t) = \\frac{dS}{d\\omega}\\dot{\\omega}(t) = - \\dot{\\omega}(t) \\beta^{2} \\frac{\\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\n$$\nFinally, we compute $R(t)$:\n$$\nR(t) = \\dot{S}(t) - \\beta \\dot{Q}(t)\n$$\n$$\nR(t) = \\left[- \\dot{\\omega}(t) \\beta^{2} \\frac{\\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\\right] - \\beta \\left[- \\dot{\\omega}(t) \\frac{\\beta \\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\\right]\n$$\n$$\nR(t) = - \\dot{\\omega}(t) \\beta^{2} \\frac{\\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right) + \\dot{\\omega}(t) \\beta^{2} \\frac{\\hbar^{2} \\omega(t)}{4} \\operatorname{csch}^{2}\\left(\\frac{\\beta \\hbar \\omega(t)}{2}\\right)\n$$\n$$\nR(t) = 0\n$$\nThe residual $R(t)$ is identically zero for all times $t \\in [0, \\tau]$ along the protocol. This signifies that the entropy rate of change of the system is exactly accounted for by the heat flow from the reservoir, i.e., $\\frac{dS}{dt} = \\beta \\dot{Q}$. This is the condition for a thermodynamically reversible process, meaning there is zero entropy production. The specific form of the control function $\\omega(t)$ is not required to reach this conclusion, as long as the system remains in the instantaneous Gibbs state.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "The principles of STA extend beyond single-particle systems to the complex realm of many-body physics, but this transition introduces significant challenges in scalability and implementability. This final practice  tackles this frontier by applying STA concepts to a quantum harmonic chain, a canonical model for interacting systems. You will computationally compare an exact, global shortcut with a more practical, approximate local protocol, providing quantitative insight into the trade-offs between performance and feasibility in realistic many-body settings.",
            "id": "3784093",
            "problem": "Consider a one-dimensional translationally invariant quantum harmonic chain with periodic boundary conditions and length $L$, described in dimensionless natural units where the reduced Planck constant $\\hbar = 1$ and the mass $m = 1$. The canonical position and momentum operators at site $j$ are $q_j$ and $p_j$, respectively. The system Hamiltonian at a given time is\n$$\nH(t) = \\frac{1}{2} \\sum_{j=0}^{L-1} \\left[ p_j^2 + \\omega(t)^2 q_j^2 + \\kappa(t) \\left(q_{j+1} - q_j\\right)^2 \\right],\n$$\nwith periodic boundary conditions $q_L \\equiv q_0$. The chain is initially prepared at inverse temperature $\\beta$ in a Gibbs state of $H(0)$, and the parameters $(\\omega(t), \\kappa(t))$ are swept from $(\\omega(0), \\kappa(0))$ to $(\\omega(T), \\kappa(T)) = (\\omega_f, \\kappa_f)$.\n\nTwo distinct driving protocols are to be compared:\n\n1. Global exact shortcut to adiabaticity (STA): This protocol implements the exact counterdiabatic driving that keeps the system in the instantaneous Gibbs state of $H(t)$ at fixed inverse temperature $\\beta$ along the entire process. The terminal state at $t=T$ is the Gibbs state of $H(T)$ at inverse temperature $\\beta$.\n\n2. Local truncated shortcut to adiabaticity (STA): This protocol uses a truncated local counterdiabatic generator that is site-wise and mode-independent. For the purpose of this problem, model the terminal state produced by the local truncated protocol as a Gaussian quasi-Gibbs state that is equal to the Gibbs state of a fictitious onsite-only Hamiltonian with mode-independent renormalized frequency\n$$\n\\tilde{\\Omega}_f = \\sqrt{\\omega_f^2 + 2 \\kappa_f}.\n$$\nThis approximation reflects the effect of truncation to onsite terms by replacing the coupling with its onsite mean-field contribution, thereby ignoring the mode dependence induced by spatial coupling. The terminal state’s covariances should be computed using $\\tilde{\\Omega}_f$ for all modes, while the energy density and correlations must be evaluated with respect to the true final Hamiltonian $H(T)$.\n\nStarting from the canonical definition of the Gibbs state for a quadratic bosonic system, derive the quantities needed to compute:\n- The energy density $\\varepsilon = \\langle H(T) \\rangle / L$ at the end of the sweep.\n- The equal-time real-space thermal position correlations $C_r = \\langle q_j q_{j+r} \\rangle$ for $r=1$ and $r=2$.\n\nPerform this computation for both protocols defined above. Use the discrete Fourier transform appropriate for a periodic chain to express the Hamiltonian in normal modes with wave numbers $k_m = \\frac{2\\pi m}{L}$, for $m = 0, 1, \\dots, L-1$ (angles must be in radians). You must treat the global exact protocol as producing the covariances of the true final dispersion and the local truncated protocol as producing covariances based on the mode-independent $\\tilde{\\Omega}_f$, while in both cases the energy density and correlations are evaluated with the true final Hamiltonian.\n\nYour program must implement the above and produce numerical values as floats. Use the following test suite of parameter values to assess performance:\n\n- Test case 1 (general case): $L = 8$, $\\beta = 1.0$, $\\omega(0) = 1.0$, $\\kappa(0) = 0.2$, $\\omega_f = 1.5$, $\\kappa_f = 0.4$.\n- Test case 2 (decoupled boundary): $L = 8$, $\\beta = 0.5$, $\\omega(0) = 1.0$, $\\kappa(0) = 0.0$, $\\omega_f = 1.2$, $\\kappa_f = 0.0$.\n- Test case 3 (strong coupling, low temperature): $L = 12$, $\\beta = 2.0$, $\\omega(0) = 0.8$, $\\kappa(0) = 0.6$, $\\omega_f = 0.6$, $\\kappa_f = 1.0$.\n- Test case 4 (strong coupling, high temperature classical regime): $L = 10$, $\\beta = 0.05$, $\\omega(0) = 1.0$, $\\kappa(0) = 0.5$, $\\omega_f = 0.5$, $\\kappa_f = 0.8$.\n\nFor each test case, compute and output a list of six floats in the following order:\n1. $\\varepsilon_{\\mathrm{global}}$,\n2. $\\varepsilon_{\\mathrm{local}}$,\n3. $C_{1,\\mathrm{global}}$,\n4. $C_{1,\\mathrm{local}}$,\n5. $C_{2,\\mathrm{global}}$,\n6. $C_{2,\\mathrm{local}}$.\n\nYour program should produce a single line of output containing the results for all four provided test cases as a comma-separated list of these six-element lists, enclosed in square brackets, and in radians for all angles. For example, the format must be exactly\n$$\n\\text{[}[e_1^{(g)}, e_1^{(l)}, C_{1,1}^{(g)}, C_{1,1}^{(l)}, C_{2,1}^{(g)}, C_{2,1}^{(l)}],[e_2^{(g)}, \\dots ],[e_3^{(g)}, \\dots ],[e_4^{(g)}, \\dots ]\\text{]}.\n$$\nAll outputs are dimensionless and must be expressed in the specified natural units with angles in radians.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of quantum statistical mechanics and quantum control, specifically concerning quadratic bosonic systems and shortcuts to adiabaticity. The problem statement is well-posed, objective, and provides a complete and consistent set of definitions and parameters required for a unique solution. The model for the local truncated protocol, while an approximation, is explicitly defined, making the problem formally solvable.\n\nThe solution proceeds in four main steps:\n1.  Diagonalization of the Hamiltonian by Fourier transform.\n2.  Statement of thermal expectation values for quantum harmonic modes.\n3.  Derivation of general expressions for the required observables (energy density and correlations).\n4.  Application of these general expressions to the two specified protocols.\n\n### 1. Diagonalization of the Hamiltonian\nThe Hamiltonian of the one-dimensional harmonic chain is given by:\n$$\nH(t) = \\frac{1}{2} \\sum_{j=0}^{L-1} \\left[ p_j^2 + \\omega(t)^2 q_j^2 + \\kappa(t) \\left(q_{j+1} - q_j\\right)^2 \\right]\n$$\nGiven the translational invariance and periodic boundary conditions ($q_L \\equiv q_0$), we introduce the discrete Fourier transform for the position and momentum operators:\n$$\nq_j = \\frac{1}{\\sqrt{L}} \\sum_{m=0}^{L-1} \\hat{q}_m e^{i k_m j} \\quad , \\quad p_j = \\frac{1}{\\sqrt{L}} \\sum_{m=0}^{L-1} \\hat{p}_m e^{i k_m j}\n$$\nwhere the wave numbers are $k_m = \\frac{2\\pi m}{L}$ for $m \\in \\{0, 1, \\dots, L-1\\}$. The operators in momentum space, $\\hat{q}_m$ and $\\hat{p}_m$, satisfy the canonical commutation relations transformed to this basis. Substituting these into the Hamiltonian and using the orthogonality relation $\\sum_{j=0}^{L-1} e^{i (k_m - k_n) j} = L \\delta_{m,n}$, the different terms become:\n- Kinetic energy: $\\frac{1}{2} \\sum_j p_j^2 = \\frac{1}{2} \\sum_m \\hat{p}_m \\hat{p}_{-m}$.\n- Onsite potential energy: $\\frac{1}{2} \\sum_j \\omega(t)^2 q_j^2 = \\frac{1}{2} \\omega(t)^2 \\sum_m \\hat{q}_m \\hat{q}_{-m}$.\n- Coupling potential energy: The term $(q_{j+1} - q_j)$ transforms to $(e^{i k_m} - 1)\\hat{q}_m$. The energy term becomes:\n$$\n\\frac{1}{2} \\kappa(t) \\sum_j (q_{j+1} - q_j)^2 = \\frac{1}{2} \\kappa(t) \\sum_m |e^{i k_m} - 1|^2 \\hat{q}_m \\hat{q}_{-m}\n$$\nThe factor $|e^{i k_m} - 1|^2 = (e^{i k_m} - 1)(e^{-i k_m} - 1) = 2 - 2\\cos(k_m) = 4\\sin^2(k_m/2)$.\nCombining all terms, the Hamiltonian separates into a sum over independent modes:\n$$\nH(t) = \\sum_{m=0}^{L-1} \\left[ \\frac{1}{2} \\hat{p}_m \\hat{p}_{-m} + \\frac{1}{2} \\left( \\omega(t)^2 + 4\\kappa(t)\\sin^2(k_m/2) \\right) \\hat{q}_m \\hat{q}_{-m} \\right]\n$$\nThis is a collection of decoupled harmonic oscillators, where the frequency of each mode $m$ is given by the dispersion relation:\n$$\n\\Omega_m(t) = \\sqrt{\\omega(t)^2 + 4\\kappa(t)\\sin^2(k_m/2)}\n$$\nThe Hamiltonian can be written as $H(t) = \\sum_{m=0}^{L-1} H_m(t)$, where $H_m(t) = \\frac{1}{2} \\left( \\hat{p}_m \\hat{p}_{-m} + \\Omega_m(t)^2 \\hat{q}_m \\hat{q}_{-m} \\right)$.\n\n### 2. Thermal Expectation Values\nFor a single quantum harmonic mode with frequency $\\Omega_m$ in thermal equilibrium at inverse temperature $\\beta$, the energy expectation value is:\n$$\n\\langle H_m \\rangle = \\frac{\\Omega_m}{2} \\coth\\left(\\frac{\\beta \\Omega_m}{2}\\right)\n$$\nwhere we use units with $\\hbar=1$. By the virial theorem for harmonic oscillators, the kinetic and potential energy contributions are equal: $\\langle \\frac{1}{2} \\hat{p}_m \\hat{p}_{-m} \\rangle = \\langle \\frac{1}{2} \\Omega_m^2 \\hat{q}_m \\hat{q}_{-m} \\rangle = \\frac{1}{2}\\langle H_m \\rangle$. This yields the momentum-space covariances:\n$$\n\\langle \\hat{q}_m \\hat{q}_{-m} \\rangle = \\frac{1}{2\\Omega_m} \\coth\\left(\\frac{\\beta \\Omega_m}{2}\\right) \\quad , \\quad \\langle \\hat{p}_m \\hat{p}_{-m} \\rangle = \\frac{\\Omega_m}{2} \\coth\\left(\\frac{\\beta \\Omega_m}{2}\\right)\n$$\n\n### 3. General Expressions for Observables\nThe observables are computed with respect to the final state of the system at time $t=T$. The final Hamiltonian $H(T)$ has mode frequencies $\\Omega_{m,f} = \\sqrt{\\omega_f^2 + 4\\kappa_f \\sin^2(k_m/2)}$.\n\n#### Energy Density $\\varepsilon = \\langle H(T) \\rangle / L$\nThe expectation value of the final Hamiltonian is:\n$$\n\\langle H(T) \\rangle = \\left\\langle \\sum_{m=0}^{L-1} \\frac{1}{2} \\left( \\hat{p}_m \\hat{p}_{-m} + \\Omega_{m,f}^2 \\hat{q}_m \\hat{q}_{-m} \\right) \\right\\rangle = \\frac{1}{2} \\sum_{m=0}^{L-1} \\left( \\langle\\hat{p}_m \\hat{p}_{-m}\\rangle + \\Omega_{m,f}^2 \\langle\\hat{q}_m \\hat{q}_{-m}\\rangle \\right)\n$$\nThe covariances $\\langle \\cdot \\rangle$ are determined by the particular protocol used. The energy density is $\\varepsilon = \\langle H(T) \\rangle / L$.\n\n#### Real-Space Correlations $C_r = \\langle q_j q_{j+r} \\rangle$\nThe correlation function is computed by substituting the Fourier expansions:\n$$\nC_r = \\langle q_j q_{j+r} \\rangle = \\frac{1}{L} \\sum_{m,n=0}^{L-1} \\langle \\hat{q}_m \\hat{q}_n \\rangle e^{i k_m j} e^{i k_n (j+r)}\n$$\nSince the modes are independent in the diagonal basis, $\\langle \\hat{q}_m \\hat{q}_n \\rangle = \\delta_{n,-m} \\langle \\hat{q}_m \\hat{q}_{-m} \\rangle$.\n$$\nC_r = \\frac{1}{L} \\sum_{m=0}^{L-1} \\langle \\hat{q}_m \\hat{q}_{-m} \\rangle e^{-i k_m r} = \\frac{1}{L} \\sum_{m=0}^{L-1} \\langle \\hat{q}_m \\hat{q}_{-m} \\rangle \\cos(k_m r)\n$$\nThe sine term vanishes because $\\langle \\hat{q}_m \\hat{q}_{-m} \\rangle$ is an even function of $k_m$.\n\n### 4. Application to Each Protocol\n\n#### Protocol 1: Global Exact STA\nThe final state is the true Gibbs state of $H(T)$. Thus, the covariances are the equilibrium ones corresponding to the final mode frequencies $\\Omega_{m,f}$.\n$$\n\\langle \\hat{q}_m \\hat{q}_{-m} \\rangle_{\\mathrm{global}} = \\frac{1}{2\\Omega_{m,f}} \\coth\\left(\\frac{\\beta \\Omega_{m,f}}{2}\\right) \\quad , \\quad \\langle \\hat{p}_m \\hat{p}_{-m} \\rangle_{\\mathrm{global}} = \\frac{\\Omega_{m,f}}{2} \\coth\\left(\\frac{\\beta \\Omega_{m,f}}{2}\\right)\n$$\n- **Energy Density $\\varepsilon_{\\mathrm{global}}$**:\n  The system is in thermal equilibrium with its own Hamiltonian, so the energy is simply the thermal energy.\n  $$\n  \\varepsilon_{\\mathrm{global}} = \\frac{1}{L} \\sum_{m=0}^{L-1} \\frac{\\Omega_{m,f}}{2} \\coth\\left(\\frac{\\beta \\Omega_{m,f}}{2}\\right)\n  $$\n- **Correlations $C_{r, \\mathrm{global}}$**:\n  $$\n  C_{r, \\mathrm{global}} = \\frac{1}{L} \\sum_{m=0}^{L-1} \\left[ \\frac{1}{2\\Omega_{m,f}} \\coth\\left(\\frac{\\beta \\Omega_{m,f}}{2}\\right) \\right] \\cos(k_m r)\n  $$\n\n#### Protocol 2: Local Truncated STA\nThe final state is approximated by a quasi-Gibbs state whose covariances are determined by a single, mode-independent frequency $\\tilde{\\Omega}_f = \\sqrt{\\omega_f^2 + 2\\kappa_f}$.\n$$\n\\langle \\hat{q}_m \\hat{q}_{-m} \\rangle_{\\mathrm{local}} = \\frac{1}{2\\tilde{\\Omega}_f} \\coth\\left(\\frac{\\beta \\tilde{\\Omega}_f}{2}\\right) \\quad , \\quad \\langle \\hat{p}_m \\hat{p}_{-m} \\rangle_{\\mathrm{local}} = \\frac{\\tilde{\\Omega}_f}{2} \\coth\\left(\\frac{\\beta \\tilde{\\Omega}_f}{2}\\right)\n$$\nNote that these covariances are constant for all modes $m$.\n\n- **Energy Density $\\varepsilon_{\\mathrm{local}}$**:\n  The energy must be evaluated with respect to the true Hamiltonian $H(T)$, using the local state's covariances.\n  $$\n  \\varepsilon_{\\mathrm{local}} = \\frac{1}{L} \\sum_{m=0}^{L-1} \\frac{1}{2} \\left[ \\langle\\hat{p}_m \\hat{p}_{-m}\\rangle_{\\mathrm{local}} + \\Omega_{m,f}^2 \\langle\\hat{q}_m \\hat{q}_{-m}\\rangle_{\\mathrm{local}} \\right]\n  $$\n  $$\n  \\varepsilon_{\\mathrm{local}} = \\frac{1}{2L} \\sum_{m=0}^{L-1} \\left[ \\frac{\\tilde{\\Omega}_f}{2} \\coth\\left(\\frac{\\beta \\tilde{\\Omega}_f}{2}\\right) + \\Omega_{m,f}^2 \\frac{1}{2\\tilde{\\Omega}_f} \\coth\\left(\\frac{\\beta \\tilde{\\Omega}_f}{2}\\right) \\right]\n  $$\n  $$\n  \\varepsilon_{\\mathrm{local}} = \\frac{1}{4L} \\coth\\left(\\frac{\\beta \\tilde{\\Omega}_f}{2}\\right) \\sum_{m=0}^{L-1} \\left( \\tilde{\\Omega}_f + \\frac{\\Omega_{m,f}^2}{\\tilde{\\Omega}_f} \\right)\n  $$\n  Using the identity $\\sum_{m=0}^{L-1} \\sin^2(k_m/2) = L/2$, we find $\\sum_{m=0}^{L-1} \\Omega_{m,f}^2 = \\sum_m(\\omega_f^2 + 4\\kappa_f \\sin^2(k_m/2)) = L\\omega_f^2 + 2L\\kappa_f = L(\\omega_f^2 + 2\\kappa_f) = L\\tilde{\\Omega}_f^2$. The sum becomes $\\sum_m (\\tilde{\\Omega}_f + \\Omega_{m,f}^2/\\tilde{\\Omega}_f) = L\\tilde{\\Omega}_f + (L\\tilde{\\Omega}_f^2)/\\tilde{\\Omega}_f = 2L\\tilde{\\Omega}_f$.\n  This gives a remarkably simple result:\n  $$\n  \\varepsilon_{\\mathrm{local}} = \\frac{1}{4L} \\coth\\left(\\frac{\\beta \\tilde{\\Omega}_f}{2}\\right) (2L\\tilde{\\Omega}_f) = \\frac{\\tilde{\\Omega}_f}{2} \\coth\\left(\\frac{\\beta \\tilde{\\Omega}_f}{2}\\right)\n  $$\n- **Correlations $C_{r, \\mathrm{local}}$**:\n  The position covariance $\\langle \\hat{q}_m \\hat{q}_{-m} \\rangle_{\\mathrm{local}}$ is a constant. Let's call it $c_q$.\n  $$\n  C_{r, \\mathrm{local}} = \\frac{1}{L} \\sum_{m=0}^{L-1} c_q \\cos(k_m r) = \\frac{c_q}{L} \\sum_{m=0}^{L-1} \\cos\\left(\\frac{2\\pi m r}{L}\\right)\n  $$\n  The sum $\\sum_{m=0}^{L-1} \\cos(2\\pi m r / L)$ is equal to $L$ if $r$ is a multiple of $L$, and $0$ otherwise. Since we are interested in $r=1$ and $r=2$ (and $L \\ge 8$), this sum is zero.\n  $$\n  C_{1, \\mathrm{local}} = 0 \\quad , \\quad C_{2, \\mathrm{local}} = 0\n  $$\nThis vanishing of off-site correlations is a direct consequence of the mode-independent (and thus site-decoupled) nature of the local STA approximation.",
            "answer": "```python\nimport numpy as np\n# No other libraries outside the standard library or specified versions are permitted.\n\ndef solve():\n    \"\"\"\n    Solves the quantum harmonic chain problem for the given test cases.\n    \"\"\"\n\n    # Test cases from the problem statement. omega_0 and kappa_0 are not used in the final\n    # state calculation but are kept for completeness.\n    # Format: (L, beta, omega_0, kappa_0, omega_f, kappa_f)\n    test_cases = [\n        (8, 1.0, 1.0, 0.2, 1.5, 0.4),\n        (8, 0.5, 1.0, 0.0, 1.2, 0.0),\n        (12, 2.0, 0.8, 0.6, 0.6, 1.0),\n        (10, 0.05, 1.0, 0.5, 0.5, 0.8),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        L, beta, _, _, omega_f, kappa_f = case\n        results = calculate_quantities(L, beta, omega_f, kappa_f)\n        all_results.append(results)\n\n    # Format the final output string exactly as required.\n    # e.g., [[val1,val2,...],[val1,val2,...],...]\n    output_str = f\"[{','.join([f'[{\",\".join(map(str, r))}]' for r in all_results])}]\"\n    print(output_str)\n\ndef coth(x):\n    \"\"\"Numerically stable hyperbolic cotangent.\"\"\"\n    # For very small x, coth(x) -> 1/x\n    # For very large x, coth(x) sign(x) * 1\n    # np.tanh is stable for a wide range of inputs including 0.\n    # For x=0, np.tanh(x)=0, so this would give inf, which is correct.\n    # The problem setup ensures the argument is always positive.\n    return 1 / np.tanh(x)\n\ndef calculate_quantities(L, beta, omega_f, kappa_f):\n    \"\"\"\n    Computes the six required quantities for a single test case.\n    \n    Args:\n        L (int): Length of the chain.\n        beta (float): Inverse temperature.\n        omega_f (float): Final onsite frequency.\n        kappa_f (float): Final coupling constant.\n        \n    Returns:\n        list[float]: A list of 6 floats: [eps_global, eps_local, \n                      C1_global, C1_local, C2_global, C2_local].\n    \"\"\"\n    \n    # --- Common parameters ---\n    m = np.arange(L)\n    k_m = 2 * np.pi * m / L\n    omega_f_sq = omega_f**2\n\n    # --- Global Exact STA Protocol ---\n    \n    # Final mode frequencies for the true Hamiltonian H(T)\n    # Omega_mf = sqrt(omega_f^2 + 4*kappa_f*sin^2(k_m/2))\n    sin_km_half_sq = np.sin(k_m / 2)**2\n    Omega_mf = np.sqrt(omega_f_sq + 4 * kappa_f * sin_km_half_sq)\n    \n    # Argument for the coth function. Omega_mf is guaranteed to be positive\n    # by the problem parameters, so no division by zero in the main terms.\n    x_global = beta * Omega_mf / 2\n    \n    # We must handle the case where x_global can be zero, although not in test cases.\n    # If a mode frequency is zero, x_global is zero, and coth(x) -> inf.\n    # The term x * coth(x) -> 1.\n    # Let's compute the two terms separately for numerical stability.\n\n    # 1. Global energy density\n    # eps_global = (1/L) * sum_m (Omega_mf/2) * coth(beta*Omega_mf/2)\n    # This is equivalent to np.mean( (Omega_mf/2) * coth(...) )\n    \n    # Using the property z*coth(z) = z / tanh(z), which is more stable than z*(exp(2z)+1)/(exp(2z)-1)\n    # For z -> 0, z/tanh(z) -> 1\n    term1 = x_global / np.tanh(x_global)\n    # Replace NaN from 0/0 (if x_global is 0) with the limit 1.0\n    term1[np.isnan(term1)] = 1.0\n    eps_global = np.mean(term1 / beta) # since term1 = (beta*Omega_mf/2)*coth, we divide by beta\n                                      # to get (Omega_mf/2)*coth\n    \n    # 2. Global correlations\n    # C_r_global = (1/L) * sum_m [ 1/(2*Omega_mf) * coth(...) ] * cos(k_m*r)\n    # The term inside the sum is coth(x)/(2*Omega_mf) = coth(x)/(4*x/beta) = beta/(4x) * coth(x)\n    term2 = coth(x_global) / (2 * Omega_mf)\n    # If Omega_mf is 0, term2 is Inf. Problem parameters avoid this.\n    \n    C1_global = np.mean(term2 * np.cos(k_m))\n    C2_global = np.mean(term2 * np.cos(2 * k_m))\n    \n    \n    # --- Local Truncated STA Protocol ---\n    \n    # 1. Local energy density\n    # Fictitious mode-independent frequency: Omega_tilde_f = sqrt(omega_f^2 + 2*kappa_f)\n    Omega_tilde_f = np.sqrt(omega_f_sq + 2 * kappa_f)\n    \n    # eps_local = (Omega_tilde_f/2) * coth(beta*Omega_tilde_f/2)\n    x_local = beta * Omega_tilde_f / 2\n    if x_local == 0:\n        # Classical equipartition limit, E = 1/beta\n        eps_local = 1.0 / beta\n    else:\n        eps_local = (Omega_tilde_f / 2) * coth(x_local)\n\n    # 2. Local correlations\n    # As derived, the off-site correlations for the local protocol are zero due to the\n    # mode-independent approximation of the state's covariances.\n    C1_local = 0.0\n    C2_local = 0.0\n\n    return [\n        eps_global, \n        eps_local, \n        C1_global, \n        C1_local, \n        C2_global, \n        C2_local\n    ]\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}