{
    "hands_on_practices": [
        {
            "introduction": "紧束缚模型从原子或分子的局域轨道出发，是理解晶体中电子能带如何形成的一种直观而强大的方法。本练习  将指导您推导一个二维矩形晶格的能量色散关系，通过这个过程，您将亲身体会到微观的电子跃迁参数是如何决定宏观的能带宽度等关键物理量的。",
            "id": "4265197",
            "problem": "考虑一个二维晶体半导体单层，其具有矩形布拉菲晶格，这与各向异性新兴材料（例如，褶皱的V族元素层）相关。原胞晶格矢量为 $\\mathbf{a}_x = a_x \\hat{\\mathbf{x}}$ 和 $\\mathbf{a}_y = a_y \\hat{\\mathbf{y}}$。假设每个晶格点上有一个局域轨道，每个单胞有一个格点，并且晶体势是周期性的，因此单电子态满足布洛赫定理。在紧束缚近似下，只保留在位和最近邻相互作用：在位能为 $\\varepsilon_0$；位移为 $\\pm \\mathbf{a}_x$ 的格点之间的最近邻跃迁积分为 $t_x$；位移为 $\\pm \\mathbf{a}_y$ 的格点之间的最近邻跃迁积分为 $t_y$。忽略次近邻耦合、自旋和自旋轨道效应。\n\n从具有周期性势的不含时薛定谔方程和布洛赫态的定义出发，在局域轨道基下构建紧束缚哈密顿量，并推导整个第一布里渊区 (BZ) 内的能量色散关系 $E(\\mathbf{k})$，它是晶体动量 $\\mathbf{k} = k_x \\hat{\\mathbf{x}} + k_y \\hat{\\mathbf{y}}$ 的函数。然后将此单能带的带宽 $W$ 定义为 $W = \\max_{\\mathbf{k}\\in \\mathrm{BZ}} E(\\mathbf{k}) - \\min_{\\mathbf{k}\\in \\mathrm{BZ}} E(\\mathbf{k})$，并用 $t_x$ 和 $t_y$ 表示 $W$。\n\n以单行矩阵的形式给出由推导出的色散关系 $E(\\mathbf{k})$ 和带宽 $W$ 组成的答案对。不需要进行数值计算或四舍五入；请给出闭合形式的解析表达式。",
            "solution": "该问题陈述已经过验证，被认为是科学上合理的、提法恰当的和客观的。它提出了一个固态物理中的标准练习，可以使用紧束缚模型和布洛赫定理来解决。\n\n我们首先在紧束缚近似下构建单电子哈密顿量。基态是以每个晶格点 $\\mathbf{R} = n_x \\mathbf{a}_x + n_y \\mathbf{a}_y$ 为中心的局域原子轨道 $|\\mathbf{R}\\rangle$，其中 $n_x$ 和 $n_y$ 是整数，原胞晶格矢量为 $\\mathbf{a}_x = a_x \\hat{\\mathbf{x}}$ 和 $\\mathbf{a}_y = a_y \\hat{\\mathbf{y}}$。我们假设这些轨道构成一个标准正交集，即 $\\langle \\mathbf{R} | \\mathbf{R}' \\rangle = \\delta_{\\mathbf{R}, \\mathbf{R}'}$。\n\n根据布洛赫定理，周期性哈密顿量的本征态可以写成布洛赫波。对于每个单胞只有一个轨道的系统，具有晶体动量 $\\mathbf{k}$ 的布洛赫态 $|\\psi_\\mathbf{k}\\rangle$ 是原子轨道的线性组合：\n$$\n|\\psi_\\mathbf{k}\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}} \\exp(i\\mathbf{k} \\cdot \\mathbf{R}) |\\mathbf{R}\\rangle\n$$\n其中 $N$ 是晶体中晶格点的总数。这些态是哈密顿量 $H$ 的本征态，满足 $H|\\psi_\\mathbf{k}\\rangle = E(\\mathbf{k})|\\psi_\\mathbf{k}\\rangle$，其中 $E(\\mathbf{k})$ 是能量色散关系。\n\n为了求出本征值 $E(\\mathbf{k})$，我们可以计算哈密顿量在布洛赫态下的期望值：\n$$\nE(\\mathbf{k}) = \\langle \\psi_\\mathbf{k} | H | \\psi_\\mathbf{k} \\rangle\n$$\n代入 $|\\psi_\\mathbf{k}\\rangle$ 的表达式：\n$$\nE(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}, \\mathbf{R}'} \\exp(i\\mathbf{k} \\cdot (\\mathbf{R}' - \\mathbf{R})) \\langle \\mathbf{R} | H | \\mathbf{R}' \\rangle\n$$\n由于晶格的平移对称性，矩阵元 $\\langle \\mathbf{R} | H | \\mathbf{R}' \\rangle$ 仅依赖于位移矢量 $\\mathbf{R}' - \\mathbf{R}$。我们设 $\\mathbf{R} = \\mathbf{0}$，并对所有晶格矢量 $\\mathbf{R}'$ 求和（我们可以将其重新标记为 $\\mathbf{R}$）：\n$$\nE(\\mathbf{k}) = \\sum_{\\mathbf{R}} \\exp(i\\mathbf{k} \\cdot \\mathbf{R}) \\langle \\mathbf{0} | H | \\mathbf{R} \\rangle\n$$\n问题指明了哈密顿量的非零矩阵元：\n1.  在位能：$\\langle \\mathbf{R} | H | \\mathbf{R} \\rangle = \\varepsilon_0$。\n2.  最近邻跃迁：根据固态物理学的标准惯例，由正参数 $t$ 表示的跃迁积分对应于哈密顿量矩阵元 $-t$。我们采用这个惯例。问题指明，对于相隔 $\\pm\\mathbf{a}_x$ 的邻居，跃迁积分为 $t_x$，对于相隔 $\\pm\\mathbf{a}_y$ 的邻居，跃迁积分为 $t_y$。因此：\n    - $\\langle \\mathbf{R} | H | \\mathbf{R} \\pm \\mathbf{a}_x \\rangle = -t_x$\n    - $\\langle \\mathbf{R} | H | \\mathbf{R} \\pm \\mathbf{a}_y \\rangle = -t_y$\n3.  所有其他离位矩阵元均为零，因为忽略了次近邻耦合。\n\n现在我们可以计算 $E(\\mathbf{k})$ 的和。该和是针对所有晶格矢量 $\\mathbf{R}$ 的。我们考虑非零项：\n-   $\\mathbf{R} = \\mathbf{0}$ 的项：$\\exp(i\\mathbf{k} \\cdot \\mathbf{0}) \\langle \\mathbf{0} | H | \\mathbf{0} \\rangle = 1 \\cdot \\varepsilon_0 = \\varepsilon_0$。\n-   沿 $\\hat{\\mathbf{x}}$ 方向的最近邻项，$\\mathbf{R} = \\pm\\mathbf{a}_x$：\n    $$\n    \\exp(i\\mathbf{k} \\cdot \\mathbf{a}_x) \\langle \\mathbf{0} | H | \\mathbf{a}_x \\rangle + \\exp(i\\mathbf{k} \\cdot (-\\mathbf{a}_x)) \\langle \\mathbf{0} | H | -\\mathbf{a}_x \\rangle \\\\\n    = \\exp(ik_x a_x)(-t_x) + \\exp(-ik_x a_x)(-t_x) \\\\\n    = -t_x (\\exp(ik_x a_x) + \\exp(-ik_x a_x)) \\\\\n    = -2t_x \\cos(k_x a_x)\n    $$\n-   沿 $\\hat{\\mathbf{y}}$ 方向的最近邻项，$\\mathbf{R} = \\pm\\mathbf{a}_y$：\n    $$\n    \\exp(i\\mathbf{k} \\cdot \\mathbf{a}_y) \\langle \\mathbf{0} | H | \\mathbf{a}_y \\rangle + \\exp(i\\mathbf{k} \\cdot (-\\mathbf{a}_y)) \\langle \\mathbf{0} | H | -\\mathbf{a}_y \\rangle \\\\\n    = \\exp(ik_y a_y)(-t_y) + \\exp(-ik_y a_y)(-t_y) \\\\\n    = -t_y (\\exp(ik_y a_y) + \\exp(-ik_y a_y)) \\\\\n    = -2t_y \\cos(k_y a_y)\n    $$\n将这些贡献相加，得到能量色散关系：\n$$\nE(\\mathbf{k}) = \\varepsilon_0 - 2t_x \\cos(k_x a_x) - 2t_y \\cos(k_y a_y)\n$$\n这是解的第一部分。\n\n接下来，我们必须求出带宽 $W$，定义为 $W = \\max_{\\mathbf{k}\\in \\mathrm{BZ}} E(\\mathbf{k}) - \\min_{\\mathbf{k}\\in \\mathrm{BZ}} E(\\mathbf{k})$。矩形晶格的第一布里渊区 (BZ) 由范围 $-\\frac{\\pi}{a_x} \\le k_x \\le \\frac{\\pi}{a_x}$ 和 $-\\frac{\\pi}{a_y} \\le k_y \\le \\frac{\\pi}{a_y}$ 定义。在此范围内，余弦函数的自变量 $k_x a_x$ 和 $k_y a_y$ 跨越区间 $[-\\pi, \\pi]$。因此，$\\cos(k_x a_x)$ 和 $\\cos(k_y a_y)$ 在 $[-1, 1]$ 的整个范围内独立变化。\n\n为了找到 $E(\\mathbf{k})$ 的极值，我们需要找到函数 $f(k_x, k_y) = -2t_x \\cos(k_x a_x) - 2t_y \\cos(k_y a_y)$ 的极值。\n问题没有指明跃迁参数 $t_x$ 和 $t_y$ 的符号。我们按它们可以是任何实数的一般情况进行处理。\n项 $-2t_x \\cos(k_x a_x)$ 的最大值为 $2|t_x|$，它在 $\\cos(k_x a_x) = -\\mathrm{sgn}(t_x)$ 时出现。\n项 $-2t_y \\cos(k_y a_y)$ 的最大值为 $2|t_y|$，它在 $\\cos(k_y a_y) = -\\mathrm{sgn}(t_y)$ 时出现。\n由于 $\\cos(k_x a_x)$ 和 $\\cos(k_y a_y)$ 可以独立变化，它们的和的最大值是它们各自最大值的和。\n因此，最大能量为：\n$$\nE_{\\max} = \\max_{\\mathbf{k}\\in \\mathrm{BZ}} E(\\mathbf{k}) = \\varepsilon_0 + 2|t_x| + 2|t_y|\n$$\n类似地，项 $-2t_x \\cos(k_x a_x)$ 的最小值为 $-2|t_x|$，在 $\\cos(k_x a_x) = \\mathrm{sgn}(t_x)$ 时出现。\n项 $-2t_y \\cos(k_y a_y)$ 的最小值为 $-2|t_y|$，在 $\\cos(k_y a_y) = \\mathrm{sgn}(t_y)$ 时出现。\n最小能量为：\n$$\nE_{\\min} = \\min_{\\mathbf{k}\\in \\mathrm{BZ}} E(\\mathbf{k}) = \\varepsilon_0 - 2|t_x| - 2|t_y|\n$$\n带宽 $W$ 是这些极值之间的差：\n$$\nW = E_{\\max} - E_{\\min} = (\\varepsilon_0 + 2|t_x| + 2|t_y|) - (\\varepsilon_0 - 2|t_x| - 2|t_y|)\n$$\n$$\nW = 4|t_x| + 4|t_y| = 4(|t_x| + |t_y|)\n$$\n这个一般表达式无论 $t_x$ 和 $t_y$ 的符号如何都有效。通常，对于简单的类s轨道，$t_x$ 和 $t_y$ 被取为正能量标度，在这种情况下，结果简化为 $W = 4(t_x + t_y)$。然而，在没有这个明确约束的情况下，包含绝对值的形式是最严谨的结果。\n\n最终答案是推导出的能量色散关系 $E(\\mathbf{k})$ 和带宽 $W$。",
            "answer": "$$\n\\boxed{\\pmatrix{ \\varepsilon_0 - 2t_x \\cos(k_x a_x) - 2t_y \\cos(k_y a_y)  4(|t_x| + |t_y|) }}\n$$"
        },
        {
            "introduction": "与紧束缚模型相对，近自由电子模型从完全自由的电子（平面波）出发，将晶格的周期性势场视为一个微扰。本练习  将运用微扰理论来揭示一个基本而重要的现象：一个微弱的周期性势场如何在布里渊区边界处打开能隙，这是理解半导体和绝缘体带隙起源的关键一步。",
            "id": "4265203",
            "problem": "单原子晶体中的电子受到由晶格引起的弱周期性势场。考虑一个质量为 $m$ 的电子在具有晶格周期性的周期势 $V(\\mathbf{r})$ 中的定态薛定谔方程，其中晶体势由其傅里叶分量 $V_{\\mathbf{G}}$ 表示为 $V(\\mathbf{r})=\\sum_{\\mathbf{G}} V_{\\mathbf{G}} \\exp(i \\mathbf{G}\\cdot \\mathbf{r})$。假设在倒易晶格矢量 $\\mathbf{G}$ 处存在一个主要的傅里叶分量，并将 $V_{\\mathbf{G}}$ 视为对自由电子哈密顿量的微小扰动。从自由电子色散关系 $E_{0}(\\mathbf{k})=\\frac{\\hbar^{2} |\\mathbf{k}|^{2}}{2m}$ 出发，在满足 $E_{0}(\\mathbf{k})=E_{0}(\\mathbf{k}-\\mathbf{G})$ 的布里渊区（BZ）边界点上，使用布洛赫定理和一级简并微扰理论，推导在能带边界打开的能隙大小作为 $V_{\\mathbf{G}}$ 函数的解析表达式。将最终答案表示为封闭形式的符号表达式。不要在最终答案中提供中间方程。",
            "solution": "该问题要求使用一级简并微扰理论，推导在弱周期势中电子在布里渊区边界处的能隙。\n\n出发点是晶体中质量为 $m$ 的电子的定态薛定谔方程：\n$$H\\psi(\\mathbf{r}) = E\\psi(\\mathbf{r})$$\n哈密顿量 $H$ 由自由电子动能项 $H_0$ 和周期势 $V(\\mathbf{r})$ 组成：\n$$H = H_0 + V(\\mathbf{r}) = -\\frac{\\hbar^2}{2m}\\nabla^2 + V(\\mathbf{r})$$\n未受扰动的哈密顿量为 $H_0 = -\\frac{\\hbar^2}{2m}\\nabla^2$。其归一化本征函数是平面波 $\\psi_{\\mathbf{k}}^{(0)}(\\mathbf{r})$，由下式给出：\n$$\\psi_{\\mathbf{k}}^{(0)}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\mathcal{V}}} \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$$\n其中 $\\mathcal{V}$ 是晶体的体积。相应的本征值是自由电子能量：\n$$E_0(\\mathbf{k}) = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m}$$\n周期势 $V(\\mathbf{r})$ 被视为一种微扰。它可以展开为关于倒易晶格矢量 $\\mathbf{G}$ 的傅里叶级数：\n$$V(\\mathbf{r})=\\sum_{\\mathbf{G}} V_{\\mathbf{G}} \\exp(i \\mathbf{G}\\cdot \\mathbf{r})$$\n对于实势场 $V(\\mathbf{r})$，傅里叶系数必须满足条件 $V_{-\\mathbf{G}} = V_{\\mathbf{G}}^*$。\n\n我们关心的是布里渊区边界处的行为。如果点 $\\mathbf{k}$ 满足布拉格条件，即对应于自由电子能量的简并条件，那么它就位于布里渊区边界上：\n$$E_0(\\mathbf{k}) = E_0(\\mathbf{k}-\\mathbf{G})$$\n对于某个非零倒易晶格矢量 $\\mathbf{G}$。这意味着未受扰动的态 $\\psi_{\\mathbf{k}}^{(0)}(\\mathbf{r})$ 和 $\\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)}(\\mathbf{r})$ 是简并的。为了找到微扰对这些简并态的影响，我们应用一级简并微扰理论。\n\n我们将微扰后的波函数 $\\psi(\\mathbf{r})$ 求解为两个简并基态的线性组合：\n$$\\psi(\\mathbf{r}) = c_{1}\\psi_{\\mathbf{k}}^{(0)}(\\mathbf{r}) + c_{2}\\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)}(\\mathbf{r})$$\n将此代入完整的薛定谔方程 $H\\psi = E\\psi$，并投影到基态 $\\psi_{\\mathbf{k}}^{(0)}$ 和 $\\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)}$ 上，得到久期方程：\n$$\n\\begin{vmatrix}\nH_{11} - E  H_{12} \\\\\nH_{21}  H_{22} - E\n\\end{vmatrix}\n\\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = 0\n$$\n其中矩阵元为 $H_{ij} = \\langle \\psi_i^{(0)} | H | \\psi_j^{(0)} \\rangle$。令 $|\\psi_1^{(0)}\\rangle = \\psi_{\\mathbf{k}}^{(0)}$ 和 $|\\psi_2^{(0)}\\rangle = \\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)}$。\n\n让我们计算矩阵元：\n对角元为：\n$$H_{11} = \\langle \\psi_{\\mathbf{k}}^{(0)} | H_0 + V | \\psi_{\\mathbf{k}}^{(0)} \\rangle = E_0(\\mathbf{k}) + \\langle \\psi_{\\mathbf{k}}^{(0)} | V | \\psi_{\\mathbf{k}}^{(0)} \\rangle$$\n势能项由下式给出：\n$$\\langle \\psi_{\\mathbf{k}}^{(0)} | V | \\psi_{\\mathbf{k}}^{(0)} \\rangle = \\frac{1}{\\mathcal{V}}\\int \\exp(-i\\mathbf{k}\\cdot\\mathbf{r}) \\sum_{\\mathbf{G'}} V_{\\mathbf{G'}} \\exp(i\\mathbf{G'}\\cdot\\mathbf{r}) \\exp(i\\mathbf{k}\\cdot\\mathbf{r}) d^3\\mathbf{r} = \\sum_{\\mathbf{G'}} V_{\\mathbf{G'}} \\left(\\frac{1}{\\mathcal{V}}\\int \\exp(i\\mathbf{G'}\\cdot\\mathbf{r}) d^3\\mathbf{r}\\right)$$\n该积分仅在 $\\mathbf{G'}=0$ 时非零，因此该项为 $V_0$，即平均势。我们可以通过选择合适的能量参考点将 $V_0$ 设为0。因此，$H_{11} = E_0(\\mathbf{k})$。\n类似地，$H_{22} = E_0(\\mathbf{k}-\\mathbf{G})$。在能带边界处，$E_0(\\mathbf{k}) = E_0(\\mathbf{k}-\\mathbf{G})$，所以 $H_{11} = H_{22} = E_0(\\mathbf{k})$。\n\n非对角元为：\n$$H_{12} = \\langle \\psi_{\\mathbf{k}}^{(0)} | H_0 + V | \\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)} \\rangle$$\n由于 $\\psi_{\\mathbf{k}}^{(0)}$ 和 $\\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)}$ 是 $H_0$ 的正交本征态，$\\langle \\psi_{\\mathbf{k}}^{(0)} | H_0 | \\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)} \\rangle=0$。矩阵元变为：\n$$H_{12} = \\langle \\psi_{\\mathbf{k}}^{(0)} | V | \\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)} \\rangle = \\frac{1}{\\mathcal{V}}\\int \\exp(-i\\mathbf{k}\\cdot\\mathbf{r}) \\left( \\sum_{\\mathbf{G'}} V_{\\mathbf{G'}} \\exp(i\\mathbf{G'}\\cdot\\mathbf{r}) \\right) \\exp(i(\\mathbf{k}-\\mathbf{G})\\cdot\\mathbf{r}) d^3\\mathbf{r}$$\n$$H_{12} = \\sum_{\\mathbf{G'}} V_{\\mathbf{G'}} \\left( \\frac{1}{\\mathcal{V}}\\int \\exp(i(\\mathbf{G'}-\\mathbf{G})\\cdot\\mathbf{r}) d^3\\mathbf{r} \\right)$$\n仅当指数的宗量为零时，即 $\\mathbf{G'} = \\mathbf{G}$ 时，积分才非零。问题陈述中要求考虑单个主导的傅里叶分量 $V_{\\mathbf{G}}$，因此这是唯一耦合这两个态的分量。这给出：\n$$H_{12} = V_{\\mathbf{G}}$$\n类似地，我们可以计算 $H_{21}$：\n$$H_{21} = \\langle \\psi_{\\mathbf{k}-\\mathbf{G}}^{(0)} | V | \\psi_{\\mathbf{k}}^{(0)} \\rangle = V_{-\\mathbf{G}}$$\n如前所述，对于实势场，$V_{-\\mathbf{G}} = V_{\\mathbf{G}}^*$。\n\n久期行列式现在变为：\n$$\n\\begin{vmatrix}\nE_0(\\mathbf{k}) - E  V_{\\mathbf{G}} \\\\\nV_{\\mathbf{G}}^*  E_0(\\mathbf{k}) - E\n\\end{vmatrix} = 0\n$$\n展开行列式得到能量本征值 $E$ 的特征方程：\n$$(E_0(\\mathbf{k}) - E)^2 - V_{\\mathbf{G}}V_{\\mathbf{G}}^* = 0$$\n$$(E_0(\\mathbf{k}) - E)^2 = |V_{\\mathbf{G}}|^2$$\n对两边取平方根，得到：\n$$E_0(\\mathbf{k}) - E = \\pm |V_{\\mathbf{G}}|$$\n求解 $E$，我们得到在能带边界的两个新的能量本征值：\n$$E_{\\pm} = E_0(\\mathbf{k}) \\pm |V_{\\mathbf{G}}|$$\n微扰解除了简并，将单个能级 $E_0(\\mathbf{k})$ 分裂成两个能级 $E_+$ 和 $E_-$。\n能隙的大小 $E_g$ 是这两个能级之差：\n$$E_g = E_+ - E_- = (E_0(\\mathbf{k}) + |V_{\\mathbf{G}}|) - (E_0(\\mathbf{k}) - |V_{\\mathbf{G}}|)$$\n$$E_g = 2|V_{\\mathbf{G}}|$$\n这个结果表明，在布里渊区边界处打开的能隙大小是周期势相应傅里叶分量大小的两倍。",
            "answer": "$$\\boxed{2|V_{\\mathbf{G}}|}$$"
        },
        {
            "introduction": "理论的最终检验和应用往往离不开计算。本练习  将理论付诸实践，要求您编写一个程序，使用平面波展开法来计算一维晶体的能带结构。通过这个计算实践，您将深入理解能带理论是如何转化为可预测材料电子性质的强大计算工具的。",
            "id": "3731471",
            "problem": "考虑一个被约束在一维（1D）空间中、在满足 $V(x+a)=V(x)$（对于所有 $x$）的静态周期性势场中运动的电子，其中 $a$ 是晶格常数。该电子遵循不含时薛定谔方程 $-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$，其中 $\\hbar$ 是约化普朗克常数，$m$ 是电子质量，$\\psi(x)$ 是波函数，$E$ 是能量。根据周期性，解是布洛赫波的形式 $\\psi_k(x)=e^{ikx}u_k(x)$，且满足 $u_k(x+a)=u_k(x)$，其中 $k$ 是晶体波矢量。周期性势场 $V(x)$ 可进行傅里叶展开。在本问题中，通过余弦傅里叶级数定义势场 $V(x) = \\sum_{p=1}^{P} 2V_p \\cos(p G_1 x)$，其中 $G_1=2\\pi/a$ 是第一倒易晶格矢量，$V_p$ 是傅里叶振幅。周期部分 $u_k(x)$ 可以用由倒易晶格矢量索引的平面波展开：$u_k(x) = \\sum_{m=-M}^{M} c_{m}(k) e^{i m G_1 x}$，其中 $M$ 是一个定义有限平面波基组大小的非负整数，$c_m(k)$ 是复系数。使用此基组，并仅从这些基本定律和定义出发，推导确定能量 $E(k)$ 和系数 $c_m(k)$ 的有限维线性代数本征值问题，并对其进行数值实现。\n\n编写一个完整、可运行的程序，该程序：\n- 对于给定的 $k$，在由索引集 $m\\in\\{-M,\\ldots,M\\}$ 定义的截断基中构建平面波哈密顿矩阵。\n- 使用势场的余弦级数定义，使得唯一的非零傅里叶分量出现在对应于 $\\pm p G_1$ 的差值处，振幅为 $V_p$。\n- 对角化得到的厄米矩阵，以获得作为 $k$ 函数的能量本征值。\n\n对于每个指定的测试用例，您的程序必须返回以下内容：\n1. 第一布里渊区边界（定义为 $k=\\pi/a$）处的带隙值。具体来说，输出此 $k$ 值处第二和第一能量本征值之差，单位为 $\\hbar^2/(ma^2)$。\n2. 在 $k=\\pi/(4a)$ 处，能量最低的三个本征值列表，单位为 $\\hbar^2/(ma^2)$。\n3. 一个布尔值，指示在 $k=\\pi/(4a)$ 处，能谱在反演 $k\\mapsto -k$ 下是否对称。通过检查 $k=\\pi/(4a)$ 和 $k=-\\pi/(4a)$ 处最低的三个能量本征值是否相等（在数值容差范围内）来评估。\n\n所有能量必须以归一化能量单位 $\\hbar^2/(ma^2)$ 表示，所有浮点结果必须四舍五入到六位小数。适用时，角度隐含在平面波因子中，并以弧度处理。\n\n实现以下测试套件，涵盖一般情况、零势场边界情况、多谐波情况以及最小基组边缘情况：\n- 测试用例1（一般近自由情况）：$a=1$, $M=3$, $V_1=0.2$，所有其他 $V_p=0$。\n- 测试用例2（无周期性势场的边界情况）：$a=1$, $M=3$, 所有 $V_p=0$。\n- 测试用例3（多谐波情况）：$a=1$, $M=5$, $V_1=0.15$, $V_2=0.05$，所有更高阶的 $V_p=0$。\n- 测试用例4（最小耦合空间的边缘情况）：$a=1$, $M=1$, $V_1=0.3$，所有更高阶的 $V_p=0$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。对于每个测试用例，输出一个形式为 [区域边界处的带隙, [e1,e2,e3], 对称性布尔值] 的列表，其中带隙和能量是四舍五入到六位小数的浮点数，对称性指示符是布尔值。因此，总输出必须是包含四个此类列表的列表，每个测试用例一个，打印为单行，例如：[[gap1,[e11,e12,e13],sym1],[gap2,[e21,e22,e23],sym2],[gap3,[e31,e32,e33],sym3],[gap4,[e41,e42,e43],sym4]].",
            "solution": "用户希望我解决一个固态物理问题，具体涉及布洛赫定理和一维周期性势场的平面波展开法。\n\n我的计划如下：\n1.  **验证问题陈述。** 我需要根据我的内部验证标准仔细检查它。\n    *   **步骤1：提取已知条件：** 我将列出问题中提供的所有方程、定义和参数。\n    *   **步骤2：验证：** 我将检查该问题是否具有科学依据、是否适定、客观和完整。这似乎是一个标准的固态物理教科书问题，所以它应该是有效的。其物理基础是薛定谔方程和布洛赫定理。势场被定义为傅里叶级数，波函数在平面波基中展开。这导出了一个标准的矩阵本征值问题，这是一个成熟的方法（中心方程）。问题似乎是适定且自洽的。测试用例提供了所有必要的数值。\n    *   **步骤3：结论：** 基于验证，我预计问题是有效的，并将继续进行求解。\n\n2.  **推导解法。** 如果问题有效，我将推导薛定谔方程的矩阵形式。\n    *   从不含时薛定谔方程开始：\n        $$-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi_k(x)}{dx^2} + V(x)\\psi_k(x) = E(k)\\psi_k(x)$$\n    *   代入布洛赫形式 $\\psi_k(x) = e^{ikx}u_k(x)$ 和 $u_k(x) = \\sum_{m=-M}^{M} c_m(k) e^{i m G_1 x}$ 的平面波展开式。\n    *   这得到 $\\psi_k(x) = \\sum_{m=-M}^{M} c_m(k) e^{i(k+mG_1)x}$。\n    *   将此展开式代入薛定谔方程。\n    *   势场由 $V(x) = \\sum_{p=1}^{P} 2V_p \\cos(p G_1 x) = \\sum_{p=1}^{P} V_p (e^{ipG_1x} + e^{-ipG_1x})$ 给出。\n    *   薛定谔方程变为：\n        $$\\left(-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + \\sum_{p=1}^{P} V_p (e^{ipG_1x} + e^{-ipG_1x})\\right) \\left(\\sum_{m=-M}^{M} c_m e^{i(k+mG_1)x}\\right) = E \\left(\\sum_{m=-M}^{M} c_m e^{i(k+mG_1)x}\\right)$$\n    *   让我们应用算符。动能项：\n        $$\\frac{d^2}{dx^2} \\left(e^{i(k+mG_1)x}\\right) = -(k+mG_1)^2 e^{i(k+mG_1)x}$$\n        所以动能部分是：\n        $$\\sum_{m=-M}^{M} \\frac{\\hbar^2(k+mG_1)^2}{2m} c_m e^{i(k+mG_1)x}$$\n    *   势能项：\n        $$V(x)\\psi_k(x) = \\left(\\sum_{p=1}^{P} V_p (e^{ipG_1x} + e^{-ipG_1x})\\right) \\left(\\sum_{m=-M}^{M} c_m e^{i(k+mG_1)x}\\right)$$\n        $$= \\sum_{m=-M}^{M} \\sum_{p=1}^{P} V_p c_m \\left(e^{i(k+(m+p)G_1)x} + e^{i(k+(m-p)G_1)x}\\right)$$\n    *   将所有项合并：\n        $$\\sum_{m=-M}^{M} \\frac{\\hbar^2(k+mG_1)^2}{2m} c_m e^{i(k+mG_1)x} + \\sum_{m=-M}^{M} \\sum_{p=1}^{P} V_p c_m \\left(e^{i(k+(m+p)G_1)x} + e^{i(k+(m-p)G_1)x}\\right) = E \\sum_{m=-M}^{M} c_m e^{i(k+mG_1)x}$$\n    *   该方程必须对所有 $x$ 成立。为了得到系数 $c_m$ 的矩阵方程，我们投影到基矢量 $e^{i(k+nG_1)x}$ 上。这通过乘以 $e^{-i(k+nG_1)x}$ 并在一个晶格周期（从 $0$ 到 $a$）上积分来完成。\n    *   正交关系为 $\\int_{0}^{a} e^{i(m-n)G_1 x} dx = a \\delta_{mn}$。\n    *   让我们投影到对应于索引 $n$ 的基函数上。\n    *   动能项投影：\n        $$\\int_0^a e^{-i(k+nG_1)x} \\left(\\sum_{m} \\frac{\\hbar^2(k+mG_1)^2}{2m} c_m e^{i(k+mG_1)x}\\right) dx = \\frac{\\hbar^2(k+nG_1)^2}{2m} c_n a$$\n    *   势能项投影。这是棘手的部分。\n        $$ \\int_0^a e^{-i(k+nG_1)x} \\left( \\sum_{m} \\sum_{p} V_p c_m (e^{i(k+(m+p)G_1)x} + e^{i(k+(m-p)G_1)x}) \\right) dx $$\n        $$ = \\sum_{m} \\sum_{p} V_p c_m \\int_0^a \\left( e^{i(m+p-n)G_1x} + e^{i(m-p-n)G_1x} \\right) dx $$\n        仅当指数为零时，积分才不为零。\n        因此对于第一项：$m+p-n = 0 \\implies m = n-p$。\n        对于第二项：$m-p-n = 0 \\implies m = n+p$。\n        这得到：\n        $$ a \\sum_{p=1}^{P} V_p (c_{n-p} + c_{n+p})$$\n        注意，对 $m$ 的求和消失了，因为对于给定的 $n$ 和 $p$，只有一个 $m$ 值有贡献。\n    *   右侧投影：\n        $$\\int_0^a e^{-i(k+nG_1)x} \\left(E \\sum_m c_m e^{i(k+mG_1)x}\\right) dx = E c_n a$$\n    *   将所有部分放在一起并除以 $a$：\n        $$\\frac{\\hbar^2(k+nG_1)^2}{2m} c_n + \\sum_{p=1}^{P} V_p (c_{n+p} + c_{n-p}) = E c_n$$\n    *   重新排列以获得矩阵本征值形式 $H\\mathbf{c} = E\\mathbf{c}$：\n        $$\\left(\\frac{\\hbar^2(k+nG_1)^2}{2m} - E\\right) c_n + \\sum_{p=1}^{P} V_p (c_{n+p} + c_{n-p}) = 0$$\n        这就是“中心方程”。索引 $n$ 和 $m$（对于列）的范围是从 $-M$ 到 $M$。矩阵的大小是 $(2M+1) \\times (2M+1)$。\n    *   矩阵元 $H_{nm}$ 为：\n        设列由 $m$ 索引，行由 $n$ 索引。方程为 $\\sum_m H_{nm} c_m = E c_n$。\n        我的方程形式为 $A_n c_n + \\sum_{m \\neq n} B_{nm} c_m = E c_n$。\n        所以 $H_{nn} c_n + \\sum_{m \\neq n} H_{nm} c_m = E c_n$。\n        对角元是：\n        $$H_{nn} = \\frac{\\hbar^2(k+nG_1)^2}{2m}$$\n        非对角元是：\n        项 $\\sum_{p=1}^{P} V_p (c_{n+p} + c_{n-p})$ 对非对角元有贡献。\n        该项可以重写为 $\\sum_{m} U_{nm} c_m$，其中 $U_{nm}$ 是势矩阵元。\n        看 $V_p c_{n-p}$ 这一项。这意味着 $m = n-p$，所以 $n-m=p$。\n        再看 $V_p c_{n+p}$ 这一项。这意味着 $m = n+p$，所以 $m-n=p$。\n        因此，如果对于某个 $p \\in \\{1..P\\}$ 有 $|n-m|=p$，$H_{nm}$ 才非零。\n        如果 $m = n-p$，系数是 $V_p$。所以 $H_{n, n-p} = V_p$。\n        如果 $m = n+p$，系数是 $V_p$。所以 $H_{n, n+p} = V_p$。\n        所以，矩阵是：\n        $$H_{nm} = \\begin{cases} \\frac{\\hbar^2(k+nG_1)^2}{2m}  \\text{if } n=m \\\\ V_p  \\text{if } |n-m|=p \\text{ for some } p \\in \\{1..P\\} \\\\ 0  \\text{otherwise} \\end{cases}$$\n        这是对于 V(x) 的一般傅里叶展开。问题陈述 $V(x) = \\sum_{p=1}^{P} 2V_p \\cos(p G_1 x)$。我使用 $V(x) = \\sum_{p=1}^{P} V_p (e^{ipG_1x} + e^{-ipG_1x})$ 的推导对于这种形式是正确的。\n        由于 $V_p$ 是实数，且 $H_{nm} = V_{|n-m|}$ 和 $H_{mn} = V_{|m-n|}$，所以 $H_{nm} = H_{mn}$，因此矩阵是厄米矩阵。\n\n3.  **数值实现。**\n    *   问题要求能量以 $\\hbar^2/(ma^2)$ 为单位。我们定义一个自然能量单位 $E_0 = \\frac{\\hbar^2}{2m} (\\frac{2\\pi}{a})^2 = \\frac{2\\pi^2\\hbar^2}{ma^2}$。问题使用了另一个单位，$E_{unit} = \\frac{\\hbar^2}{ma^2}$。所以 $E_0 = 2\\pi^2 E_{unit}$。\n    *   让我们从一开始就使用归一化的量。令 $\\tilde{E} = E / E_{unit} = E / (\\hbar^2/(ma^2))$。令 $\\tilde{k} = ka$。令 $\\tilde{V}_p = V_p / E_{unit}$。问题给出的 $V_p$ 是无量纲数，这意味着它们已经是用 $E_{unit}$ 单位表示的了。\n    *   因此，以 $E_{unit}$ 为单位的矩阵元是：\n        $$H_{nm}[\\text{in units of } \\hbar^2/(ma^2)] = \\begin{cases} \\frac{1}{2}(\\tilde{k}+2\\pi n)^2  \\text{if } n=m \\\\ V_p  \\text{if } p=|n-m| \\text{ and } V_p \\text{ is a given potential coefficient} \\\\ 0  \\text{otherwise} \\end{cases}$$\n        其中 $\\tilde{k}=ka$ 且 $n,m \\in \\{-M, \\ldots, M\\}$。这是一个 $(2M+1) \\times (2M+1)$ 的厄米矩阵。该矩阵的本征值对应于所需单位下的电子能带 $E(k)$。\n\n4.  **处理测试用例。**\n    *   我需要实现一个函数来构建这个矩阵并找到它的本征值。\n    *   **输入参数：** $k$，$a$，$M$，以及一个包含 $V_p$ 值的字典或列表。\n    *   **矩阵构建：**\n        - 矩阵的大小是 $(2M+1) \\times (2M+1)$。\n        - 索引 $n, m$ 的范围是从 $-M$ 到 $M$。在 Python 中，这对应于数组索引 $0$ 到 $2M$。我们将索引 $i$ 映射到量子数 $n = i-M$。\n        - 创建一个大小为 `(2*M+1, 2*M+1)` 的零矩阵 `H`。\n        - 循环 `i` 从 `0` 到 `2*M` (对于行，对应 $n=i-M$)。\n        - 循环 `j` 从 `0` 到 `2*M` (对于列，对应 $m=j-M$)。\n        - 令 $n = i-M$ 和 $m = j-M$。\n        - **对角元素：** 如果 $i == j$ (即 $n == m$)，设置 `H[i, i] = 0.5 * (k*a + 2*np.pi*n)**2`。\n        - **非对角元素：**\n            - 如果 $i \\neq j$，计算 $p = |n-m|$。\n            - 如果 $p$ 是 $V_p$ 字典中的一个键（例如，$V_p$ 非零），设置 `H[i, j] = V_p`。\n    *   **对角化：** 使用 `scipy.linalg.eigh` 或 `numpy.linalg.eigh` 来找到厄米矩阵 `H` 的本征值。这比 `eig` 更好，因为它专用于厄米矩阵并保证实数本征值。\n    *   如推导所示，本征值的单位将是 $\\hbar^2/(ma^2)$。\n\n4.  **处理测试用例。**\n    *   对于每个测试用例（`a`, `M`, `V_p` 值）：\n        1.  **$k=\\pi/a$ 处的带隙。**\n            - 设置 $k = \\pi/a$。归一化波矢量为 $\\tilde{k} = ka = \\pi$。\n            - 构建此 $\\tilde{k}$ 的哈密顿矩阵。\n            - 找到其本征值。\n            - 按升序对本征值排序。\n            - 带隙是 $E_2 - E_1$。我们称之为 `eigvals[1] - eigvals[0]`。\n\n        2.  **$k=\\pi/(4a)$ 处的最低三个本征值。**\n            - 设置 $k = \\pi/(4a)$。归一化波矢量为 $\\tilde{k} = ka = \\pi/4$。\n            - 构建此 $\\tilde{k}$ 的哈密顿矩阵。\n            - 找到其本征值。\n            - 对它们进行排序。\n            - 取前三个：`eigvals[0]`, `eigvals[1]`, `eigvals[2]`。\n\n        3.  **对称性检查。**\n            哈密顿量对 $k$ 的依赖是通过对角项 $\\frac{1}{2}(ka + 2\\pi n)^2$。用 $-k$ 替换 $k$ 得到 $\\frac{1}{2}(-ka + 2\\pi n)^2 = \\frac{1}{2}(ka - 2\\pi n)^2$。这与对应于索引 $-n$ 的动能项相同。矩阵的势能部分与 $k$ 无关。这意味着 $k$ 的本征值集合与 $-k$ 的本征值集合相同，即 $E(k) = E(-k)$。这种对称性对于任何没有磁场的晶体势都成立，因为它是时间反演对称性的结果。因此，对于所有测试用例，只要数值实现正确且比较容差合适，此检查的布尔值必须为 `True`。\n\n    *   **组装输出：** 对于每种情况，创建一个列表 `[gap, [e1, e2, e3], symmetry_bool]`。将这些列表收集到一个主列表中，并按照指定格式打印，确保浮点数格式化为六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It orchestrates the calculation for each case and formats the final output.\n    \"\"\"\n\n    def construct_hamiltonian(k, a, M, V_dict):\n        \"\"\"\n        Constructs the Hamiltonian matrix for a given k, a, M, and potential.\n\n        Args:\n            k (float): The crystal wavevector.\n            a (float): The lattice constant.\n            M (int): The basis set truncation index.\n            V_dict (dict): A dictionary of potential Fourier coefficients {p: V_p}.\n\n        Returns:\n            numpy.ndarray: The Hamiltonian matrix.\n        \"\"\"\n        k_norm = k * a  # Normalized wavevector\n        dim = 2 * M + 1\n        H = np.zeros((dim, dim), dtype=np.float64)\n\n        for i in range(dim):\n            n = i - M\n            for j in range(dim):\n                m = j - M\n\n                if n == m:\n                    # Diagonal elements: kinetic energy\n                    # T_n = (hbar^2 / (2*m)) * (k + n * G1)^2\n                    # In units of hbar^2 / (m * a^2), this is 0.5 * (k*a + n * 2*pi)^2\n                    kinetic_energy = 0.5 * (k_norm + 2.0 * np.pi * n)**2\n                    H[i, j] = kinetic_energy\n                else:\n                    # Off-diagonal elements: potential energy\n                    p = abs(n - m)\n                    if p in V_dict:\n                        H[i, j] = V_dict[p]\n        return H\n\n    def calculate_results_for_case(a, M, V_dict):\n        \"\"\"\n        Calculates the required physical quantities for a single test case.\n\n        Args:\n            a (float): The lattice constant.\n            M (int): The basis set truncation index.\n            V_dict (dict): A dictionary of potential Fourier coefficients.\n\n        Returns:\n            list: A list containing [gap, [e1, e2, e3], symmetry_bool].\n        \"\"\"\n        # 1. Band-gap at the first Brillouin zone boundary (k = pi/a)\n        k_zb = np.pi / a\n        H_zb = construct_hamiltonian(k_zb, a, M, V_dict)\n        eigvals_zb = eigh(H_zb, eigvals_only=True)\n        gap = eigvals_zb[1] - eigvals_zb[0]\n\n        # 2. Three lowest eigenvalues at k = pi/(4a)\n        k_q = np.pi / (4.0 * a)\n        H_q = construct_hamiltonian(k_q, a, M, V_dict)\n        eigvals_q = eigh(H_q, eigvals_only=True)\n        three_lowest_energies_q = eigvals_q[:3]\n\n        # 3. Symmetry check at k = pi/(4a)\n        k_mq = -np.pi / (4.0 * a)\n        H_mq = construct_hamiltonian(k_mq, a, M, V_dict)\n        eigvals_mq = eigh(H_mq, eigvals_only=True)\n        three_lowest_energies_mq = eigvals_mq[:3]\n        \n        # The energy spectrum E(k) must be symmetric, E(k) = E(-k), due to time-reversal symmetry.\n        # We verify this numerically.\n        is_symmetric = np.allclose(three_lowest_energies_q, three_lowest_energies_mq, rtol=1e-9, atol=1e-9)\n\n        return [gap, three_lowest_energies_q.tolist(), is_symmetric]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1 (general nearly-free case)\n        {'a': 1.0, 'M': 3, 'V_dict': {1: 0.2}},\n        # Test Case 2 (boundary case with no periodic potential)\n        {'a': 1.0, 'M': 3, 'V_dict': {}},\n        # Test Case 3 (multi-harmonic case)\n        {'a': 1.0, 'M': 5, 'V_dict': {1: 0.15, 2: 0.05}},\n        # Test Case 4 (edge case with minimal coupling space)\n        {'a': 1.0, 'M': 1, 'V_dict': {1: 0.3}},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = calculate_results_for_case(**case)\n        all_results.append(result)\n\n    # Format the final output string exactly as required.\n    # Results are formatted to six decimal places, and lists are formatted without spaces.\n    results_str_list = []\n    for res in all_results:\n        gap_val, energy_list, sym_bool = res\n        gap_str = f\"{gap_val:.6f}\"\n        energies_str = f\"[{','.join([f'{e:.6f}' for e in energy_list])}]\"\n        sym_str = 'true' if sym_bool else 'false'\n        case_str = f\"[{gap_str},{energies_str},{sym_str}]\"\n        results_str_list.append(case_str)\n        \n    final_output = f\"[[{','.join(results_str_list)}]]\"\n    final_output = final_output.replace('[[[', '[[')\n    final_output = final_output.replace(']]]', ']]')\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}