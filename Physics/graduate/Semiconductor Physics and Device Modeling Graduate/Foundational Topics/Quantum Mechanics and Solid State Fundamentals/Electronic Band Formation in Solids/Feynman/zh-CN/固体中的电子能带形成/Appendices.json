{
    "hands_on_practices": [
        {
            "introduction": "这个练习是近自由电子模型的一个经典应用。它旨在阐明周期性势如何混合布里渊区边界处的简并自由电子态，从而导致能带隙的形成。通过这个动手计算，学生将巩固对电子布拉格反射及其对能带结构影响的理解，这是固态物理学中的一个基本概念。",
            "id": "3741782",
            "problem": "考虑一个一维电子，其受一个晶格周期为 $a$ 的弱、实、空间周期性势的作用，因此倒格矢的大小为 $G = \\frac{2\\pi}{a}$。单电子哈密顿量为\n$$\n\\hat{H} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + V(x),\n$$\n其中 $V(x)$ 的周期为 $a$。假设势为\n$$\nV(x) = A\\cos\\!\\big(G x + \\phi_{1}\\big) + B\\cos\\!\\big(G x - \\phi_{2}\\big) + C\\cos\\!\\big(2G x + \\psi\\big),\n$$\n其中 $A$、$B$ 和 $C$ 是实振幅，$\\phi_{1}$、$\\phi_{2}$ 和 $\\psi$ 是实相位。在近自由电子近似的框架下处理该电子，你需要分析当波矢 $k$ 趋近于 $G/2$ 时，由于波矢为 $k$ 和 $k-G$ 的平面波态之间的布拉格散射，在第一布里渊区（BZ）边界处能隙的形成。\n\n从单电子薛定谔方程出发，利用布洛赫定理和平面波展开，推导描述在区域边界处近简并基 $\\{e^{ikx}, e^{i(k-G)x}\\}$ 之间耦合的最小二能态久期方程。确定介导此耦合的 $V(x)$ 的傅里叶系数，并说明它如何决定在 $k=G/2$ 处的能带边缘分裂。然后，对于具体参数值\n$$\nA = 0.180\\,\\mathrm{eV},\\quad B = 0.120\\,\\mathrm{eV},\\quad C = 0.050\\,\\mathrm{eV},\\quad \\phi_{1} = 0.30,\\quad \\phi_{2} = 0.60,\\quad \\psi = 1.20,\n$$\n(所有角度均以弧度为单位)，计算在第一布里渊区边界处打开的能隙的大小。以电子伏特（eV）为单位表示最终数值结果，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求在近自由电子近似下，计算一维弱周期势中电子在第一布里渊区（BZ）边界处的能隙。\n\n单电子薛定谔方程由下式给出\n$$ \\hat{H}\\psi(x) = E\\psi(x) $$\n其中哈密顿量为 $\\hat{H} = \\hat{H}_0 + V(x)$，$\\hat{H}_0 = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$ 是自由电子哈密顿量，$V(x)$ 是周期势。\n\n根据布洛赫定理，周期势中电子的波函数可以写成一个平面波 $e^{ikx}$ 与一个具有晶格相同周期性的函数 $u_k(x)$（即 $u_k(x+a)=u_k(x)$）的乘积。我们可以将波函数的周期部分 $u_k(x)$ 和势 $V(x)$ 都按倒格矢 $K_n = nG = n(2\\pi/a)$ 展开为傅里叶级数：\n$$ \\psi_k(x) = \\sum_{K} C_{k-K} e^{i(k-K)x} $$\n$$ V(x) = \\sum_{K} V_K e^{iKx} $$\n将这些展开式代入薛定谔方程，得到：\n$$ \\left( -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + \\sum_{K'} V_{K'} e^{iK'x} \\right) \\left( \\sum_{K} C_{k-K} e^{i(k-K)x} \\right) = E \\sum_{K} C_{k-K} e^{i(k-K)x} $$\n动能算符作用于平面波上，得到其能量本征值：\n$$ -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} e^{i(k-K)x} = \\frac{\\hbar^2(k-K)^2}{2m} e^{i(k-K)x} = E_{k-K}^0 e^{i(k-K)x} $$\n其中 $E_{q}^0 = \\frac{\\hbar^{2}q^2}{2m}$ 是自由电子能量。方程变为：\n$$ \\sum_{K} E_{k-K}^0 C_{k-K} e^{i(k-K)x} + \\sum_{K'} \\sum_{K} V_{K'} C_{k-K} e^{i(k-K+K')x} = E \\sum_{K} C_{k-K} e^{i(k-K)x} $$\n为了找到特定系数（比如 $C_{k-K''}$）的方程，我们匹配具有相同平面波因子 $e^{i(k-K'')x}$ 的项。在势能项中，这要求 $k-K+K' = k-K''$，即 $K' = K-K''$。这导出了中心方程：\n$$ (E_{k-K''}^0 - E)C_{k-K''} + \\sum_{K} V_{K-K''}C_{k-K} = 0 $$\n这是一个无限耦合的线性方程组。\n\n在近自由电子模型中，势 $V(x)$ 很弱，因此我们可以使用微扰理论。当两个或多个自由电子态近简并时，会出现显著效应。这种情况发生在布里渊区边界。对于第一布里渊区边界，相关波矢为 $k = G/2$。在这一点，波矢为 $k$ 的自由电子态与波矢为 $k-G = G/2 - G = -G/2$ 的态是简并的，因为 $E_{G/2}^0 = E_{-G/2}^0$。\n\n对于 $k \\approx G/2$，态 $|k\\rangle$（由 $e^{ikx}$ 表示）和态 $|k-G\\rangle$（由 $e^{i(k-G)x}$ 表示）是近简并的。我们可以将该无限系统截断为一个只涉及系数 $C_k$ 和 $C_{k-G}$ 的二能态模型。\n两个相关的中心方程（设 $K''=0$ 和 $K''=G$）是：\n$$ (E_k^0 - E)C_k + V_0 C_k + V_{-G} C_{k-G} + \\dots = 0 $$\n$$ (E_{k-G}^0 - E)C_{k-G} + V_G C_k + V_0 C_{k-G} + \\dots = 0 $$\n这里，$V_0$ 是平均势，它导致能量的均匀平移，可以被吸收到 $E$ 中。忽略高阶项和 $V_0$，我们得到最小的二能态久期方程：\n$$\n\\begin{pmatrix}\nE_k^0 - E & V_{-G} \\\\\nV_G & E_{k-G}^0 - E\n\\end{pmatrix}\n\\begin{pmatrix}\nC_k \\\\\nC_{k-G}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n为得到非平庸解，该矩阵的行列式必须为零。\n\n下一步是求势 $V(x)$ 的傅里叶系数。势为：\n$$ V(x) = A\\cos(Gx + \\phi_{1}) + B\\cos(Gx - \\phi_{2}) + C\\cos(2Gx + \\psi) $$\n使用欧拉公式 $\\cos\\theta = \\frac{1}{2}(e^{i\\theta} + e^{-i\\theta})$，我们可以将 $V(x)$ 写成傅里叶级数：\n$$ V(x) = \\frac{A}{2}\\left( e^{i(Gx+\\phi_1)} + e^{-i(Gx+\\phi_1)} \\right) + \\frac{B}{2}\\left( e^{i(Gx-\\phi_2)} + e^{-i(Gx-\\phi_2)} \\right) + \\frac{C}{2}\\left( e^{i(2Gx+\\psi)} + e^{-i(2Gx+\\psi)} \\right) $$\n$$ V(x) = \\left( \\frac{A}{2}e^{i\\phi_1} + \\frac{B}{2}e^{-i\\phi_2} \\right)e^{iGx} + \\left( \\frac{A}{2}e^{-i\\phi_1} + \\frac{B}{2}e^{i\\phi_2} \\right)e^{-iGx} + \\left( \\frac{C}{2}e^{i\\psi} \\right)e^{i2Gx} + \\left( \\frac{C}{2}e^{-i\\psi} \\right)e^{-i2Gx} $$\n将此与一般傅里叶级数 $V(x) = \\sum_K V_K e^{iKx}$ 比较，我们确定了介导态 $|k\\rangle$ 和 $|k-G\\rangle$ 之间耦合的系数。它们是 $V_G$ 和 $V_{-G}$。\n$$ V_G = \\frac{A}{2}e^{i\\phi_1} + \\frac{B}{2}e^{-i\\phi_2} $$\n$$ V_{-G} = \\frac{A}{2}e^{-i\\phi_1} + \\frac{B}{2}e^{i\\phi_2} $$\n对于实势 $V(x)$，必须有 $V_{-G} = V_G^*$，我们的表达式满足这个条件，因为 $A$、$B$、$\\phi_{1}$ 和 $\\phi_{2}$ 都是实数。振幅为 $C$ 的势分量对应于 $V_{2G}$ 和 $V_{-2G}$，它们会耦合态 $k$ 和 $k-2G$。这与第二布里渊区边界（$k=G$）的能隙相关，但与第一布里渊区边界无关。\n\n在第一布里渊区边界 $k=G/2$ 处，未微扰的能量是简并的：$E_{G/2}^0 = E_{-G/2}^0 = E_{ZB}^0$。久期行列式变为：\n$$ \\det\\begin{pmatrix} E_{ZB}^0 - E & V_{-G} \\\\ V_G & E_{ZB}^0 - E \\end{pmatrix} = (E_{ZB}^0 - E)^2 - V_G V_{-G} = 0 $$\n因为 $V_{-G}=V_G^*$，这可以简化为 $(E_{ZB}^0 - E)^2 = |V_G|^2$。\n能量 $E$ 的解为：\n$$ E = E_{ZB}^0 \\pm |V_G| $$\n简并被解除，在区域边界处打开一个能隙。能隙 $\\Delta E_g$ 是两个新能级之间的差值：\n$$ \\Delta E_g = (E_{ZB}^0 + |V_G|) - (E_{ZB}^0 - |V_G|) = 2|V_G| $$\n这表明傅里叶系数 $V_G$ 决定了能级分裂，能隙的大小是 $V_G$ 大小的 2 倍。\n\n为了计算能隙，我们必须求出 $|V_G|$。\n$$ V_G = \\frac{1}{2}\\left( A(\\cos\\phi_1 + i\\sin\\phi_1) + B(\\cos\\phi_2 - i\\sin\\phi_2) \\right) $$\n$$ V_G = \\frac{1}{2}\\left( (A\\cos\\phi_1 + B\\cos\\phi_2) + i(A\\sin\\phi_1 - B\\sin\\phi_2) \\right) $$\n大小的平方为 $|V_G|^2 = (\\text{Re}(V_G))^2 + (\\text{Im}(V_G))^2$：\n$$ |V_G|^2 = \\frac{1}{4}\\left( (A\\cos\\phi_1 + B\\cos\\phi_2)^2 + (A\\sin\\phi_1 - B\\sin\\phi_2)^2 \\right) $$\n$$ |V_G|^2 = \\frac{1}{4}\\left( A^2\\cos^2\\phi_1 + B^2\\cos^2\\phi_2 + 2AB\\cos\\phi_1\\cos\\phi_2 + A^2\\sin^2\\phi_1 + B^2\\sin^2\\phi_2 - 2AB\\sin\\phi_1\\sin\\phi_2 \\right) $$\n$$ |V_G|^2 = \\frac{1}{4}\\left( A^2(\\cos^2\\phi_1+\\sin^2\\phi_1) + B^2(\\cos^2\\phi_2+\\sin^2\\phi_2) + 2AB(\\cos\\phi_1\\cos\\phi_2 - \\sin\\phi_1\\sin\\phi_2) \\right) $$\n使用三角恒等式，上式可简化为：\n$$ |V_G|^2 = \\frac{1}{4}\\left( A^2 + B^2 + 2AB\\cos(\\phi_1 + \\phi_2) \\right) $$\n因此能隙为：\n$$ \\Delta E_g = 2|V_G| = \\sqrt{A^2 + B^2 + 2AB\\cos(\\phi_1 + \\phi_2)} $$\n现在我们代入给定的数值：\n$A = 0.180\\,\\mathrm{eV}$，$B = 0.120\\,\\mathrm{eV}$，$\\phi_1 = 0.30\\,\\mathrm{rad}$，以及 $\\phi_2 = 0.60\\,\\mathrm{rad}$。\n\n$A^2 = (0.180)^2 = 0.0324$\n$B^2 = (0.120)^2 = 0.0144$\n$2AB = 2(0.180)(0.120) = 0.0432$\n$\\phi_1 + \\phi_2 = 0.30 + 0.60 = 0.90\\,\\mathrm{rad}$\n$\\cos(\\phi_1 + \\phi_2) = \\cos(0.90) \\approx 0.62161$\n\n现在，我们计算能隙的平方：\n$$ \\Delta E_g^2 = 0.0324 + 0.0144 + 0.0432 \\times \\cos(0.90) $$\n$$ \\Delta E_g^2 = 0.0468 + 0.0432 \\times 0.621610017... $$\n$$ \\Delta E_g^2 = 0.0468 + 0.026855552... $$\n$$ \\Delta E_g^2 = 0.073655552... $$\n取平方根以求得能隙：\n$$ \\Delta E_g = \\sqrt{0.073655552...} \\approx 0.27139556... \\,\\mathrm{eV} $$\n四舍五入到四位有效数字，能隙的大小为 $0.2714\\,\\mathrm{eV}$。",
            "answer": "$$\\boxed{0.2714}$$"
        },
        {
            "introduction": "在掌握了分析方法后，我们将从理想化的双能态模型转向更真实、更普适的方法。这个练习要求编写一个程序，使用平面波基组求解周期性势中的薛定谔方程，这是现代计算材料科学的核心方法之一。通过构建并对角化哈密顿量矩阵，你将获得如何从第一性原理计算能带结构的实践经验。",
            "id": "3741817",
            "problem": "考虑一个一维晶体，其晶格常数为 $a$，并具有一个满足 $V(x+a) = V(x)$ 的实周期赝势 $V(x)$。该晶体中一个质量为 $m$ 的电子遵循不含时薛定谔方程 $-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\psi(x) + V(x)\\psi(x) = E\\psi(x)$。利用布洛赫定理 $\\psi_k(x) = e^{ikx}u_k(x)$，其中 $u_k(x+a) = u_k(x)$，将 $u_k(x)$ 在倒格矢 $G = n\\frac{2\\pi}{a}$（$n$ 为整数）构成的平面波基上展开，并对称地截断至一个有限的截止值。周期性赝势可以写成傅里叶级数形式 $V(x) = \\sum_G V_G e^{iGx}$，其中 $V_G$ 是傅里叶分量，对于实赝势 $V(x)$，有 $V_{-G} = V_G^*$。\n\n您的任务是：\n- 从薛定谔方程和布洛赫定理出发，通过投影到 $e^{i(k+G)x}$ 上，在平面波基中推导出有限维的久期问题。请明确指出哈密顿矩阵元如何用 $k$、$G$ 和傅里叶分量 $V_G$ 表示。\n- 实现一个程序，对于给定的晶格常数 $a$、平面波截止值 $N_{\\text{max}}$（意味着包括所有满足 $-N_{\\text{max}} \\le n \\le N_{\\text{max}}$ 的整数 $n$ 对应的 $G = n\\frac{2\\pi}{a}$），以及在谐波 $G = m\\frac{2\\pi}{a}$ 处指定的一组有限的非零傅里叶分量 $\\{V_{m}\\}$，该程序需要构建在布里渊区（BZ）边界波矢 $k = \\frac{\\pi}{a}$ 处的哈密顿矩阵，对其进行对角化，并返回定义为该 $k$ 值下两个最低本征值之差的带隙。\n- 在您的实现中，使用电子静止质量 $m = m_e$、约化普朗克常数 $\\hbar$，并将能量单位转换为电子伏特。最终的带隙以电子伏特表示，并四舍五入到六位小数。\n- 程序必须产生单行输出，其中包含所有测试用例的带隙，格式为用方括号括起来的逗号分隔列表。\n\n物理常数必须按如下方式处理：\n- $m_e$ 以 $\\text{kg}$ 为单位，\n- $\\hbar$ 以 $\\text{J}\\cdot\\text{s}$ 为单位，\n- $1\\,\\text{eV}$ 以 $\\text{J}$ 为单位。\n\n假设赝势傅里叶分量以电子伏特为单位的实数值给出，与整数谐波 $m$ 相关联，其中 $V_{-m} = V_m$ 并且允许 $V_0$ 存在。哈密顿量的截断必须通过限制 $-N_{\\text{max}} \\le n \\le N_{\\text{max}}$ 来实现。\n\n测试套件：\n- 用例 A：$a = 5.0\\times 10^{-10}\\,\\text{m}$，$N_{\\text{max}} = 1$，$V_0 = 0.0\\,\\text{eV}$，$V_{+1} = 0.4\\,\\text{eV}$，$V_{-1} = 0.4\\,\\text{eV}$。\n- 用例 B：$a = 5.0\\times 10^{-10}\\,\\text{m}$，$N_{\\text{max}} = 1$，$V_0 = 0.0\\,\\text{eV}$，$V_{+1} = 0.05\\,\\text{eV}$，$V_{-1} = 0.05\\,\\text{eV}$。\n- 用例 C：$a = 4.0\\times 10^{-10}\\,\\text{m}$，$N_{\\text{max}} = 1$，$V_0 = 0.0\\,\\text{eV}$，$V_{+1} = 0.0\\,\\text{eV}$，$V_{-1} = 0.0\\,\\text{eV}$。\n- 用例 D：$a = 5.0\\times 10^{-10}\\,\\text{m}$，$N_{\\text{max}} = 2$，$V_0 = 0.0\\,\\text{eV}$，$V_{+1} = 0.2\\,\\text{eV}$，$V_{-1} = 0.2\\,\\text{eV}$，$V_{+2} = 0.1\\,\\text{eV}$，$V_{-2} = 0.1\\,\\text{eV}$。\n\n您的程序应产生单行输出，其中包含结果，格式为用方括号括起来的逗号分隔列表（例如，“[resultA,resultB,resultC,resultD]”），每个结果是在 $k = \\pi/a$ 处的带隙，单位为 $\\text{eV}$，并四舍五入到六位小数。不应打印任何其他文本。",
            "solution": "该问题要求确定一维晶体在第一布里渊区边界处的电子带隙。该问题具有科学依据，提法明确，并包含了获得唯一解所需的所有信息。这是固态物理学中近自由电子模型的标准应用。因此，该问题被认为是**有效的**。\n\n推导和计算过程如下。\n\n起点是在周期势 $V(x)$ 中，质量为 $m$ 的电子所遵循的一维不含时薛定谔方程：\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$$\n势函数以晶格常数 $a$ 为周期，因此 $V(x+a) = V(x)$。根据布洛赫定理，波函数解 $\\psi_k(x)$ 可以写成 $\\psi_k(x) = e^{ikx}u_k(x)$ 的形式，其中 $u_k(x)$ 具有与晶格相同的周期性，$u_k(x+a)=u_k(x)$。晶体动量 $k$ 是一个好量子数。\n\n由于 $u_k(x)$ 和 $V(x)$ 都是周期为 $a$ 的函数，它们可以根据倒格矢 $G = n\\frac{2\\pi}{a}$（$n$ 为整数）展开为傅里叶级数：\n$$u_k(x) = \\sum_{G} C_G e^{iGx}$$\n$$V(x) = \\sum_{G} V_G e^{iGx}$$\n系数 $C_G$ 依赖于 $k$，为简洁起见此处省略。将 $u_k(x)$ 的展开式代入 $\\psi_k(x)$ 的布洛赫形式，得到波函数的平面波展开式：\n$$\\psi_k(x) = e^{ikx} \\sum_{G} C_G e^{iGx} = \\sum_{G} C_G e^{i(k+G)x}$$\n\n现在，我们将 $\\psi_k(x)$ 和 $V(x)$ 的平面波展开式代入薛定谔方程：\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) + \\left(\\sum_{G''} V_{G''} e^{iG''x}\\right)\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) = E_k \\left(\\sum_{G} C_G e^{i(k+G)x}\\right)$$\n我们来计算每一项。动能项为：\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) = \\sum_{G} \\frac{\\hbar^2(k+G)^2}{2m} C_G e^{i(k+G)x}$$\n势能项为：\n$$\\left(\\sum_{G''} V_{G''} e^{iG''x}\\right)\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) = \\sum_{G, G''} V_{G''} C_G e^{i(k+G+G'')x}$$\n方程变为：\n$$\\sum_{G} \\frac{\\hbar^2(k+G)^2}{2m} C_G e^{i(k+G)x} + \\sum_{G, G''} V_{G''} C_G e^{i(k+G+G'')x} = E_k \\sum_{G} C_G e^{i(k+G)x}$$\n为了获得关于系数 $C_G$ 的一组代数方程，我们将整个方程投影到一个特定的基态上，例如，通过乘以 $e^{-i(k+G')x}$ 并在一个晶胞上（从 $x=0$ 到 $x=a$）积分：\n$$\\frac{1}{a} \\int_0^a dx\\; e^{-i(k+G')x} \\left[ \\dots \\right]$$\n这些平面波的正交关系是 $\\frac{1}{a} \\int_0^a e^{i(K-K')x} dx = \\delta_{K,K'}$。将其应用于每一项可得：\n1.  动能项：$\\frac{\\hbar^2(k+G')^2}{2m} C_{G'}$\n2.  势能项：$\\sum_G V_{G'-G} C_G$\n3.  能量项：$E_k C_{G'}$\n\n合并这些项得到中心方程：\n$$\\frac{\\hbar^2(k+G')^2}{2m} C_{G'} + \\sum_{G} V_{G'-G} C_G = E_k C_{G'}$$\n重新整理此方程，揭示出一个矩阵本征值问题：\n$$\\left( \\frac{\\hbar^2(k+G')^2}{2m} \\right) C_{G'} + \\sum_{G} V_{G'-G} C_G = E_k C_{G'}$$\n这可以写成 $\\sum_G H_{G',G} C_G = E_k C_{G'}$，即矩阵方程 $\\mathbf{H}\\mathbf{C} = E\\mathbf{C}$。哈密顿矩阵元 $H_{G',G}$ 由下式给出：\n$$H_{G',G} = \\frac{\\hbar^2(k+G)^2}{2m}\\delta_{G',G} + V_{G'-G}$$\n对角元（$G'=G$）是自由电子动能加上平均势 $V_0$，而非对角元是势的傅里叶分量 $V_{G'-G}$，它耦合了不同的平面波态。\n\n对于数值实现，无限的基函数集合必须被截断。问题指定了一个对称截断，其中倒格矢为 $G_n = n\\frac{2\\pi}{a}$，对于整数 $n$ 满足 $-N_{\\text{max}} \\le n \\le N_{\\text{max}}$。这产生一个大小为 $(2N_{\\text{max}}+1) \\times (2N_{\\text{max}}+1)$ 的有限维哈密顿矩阵。矩阵的索引，比如 $i$ 和 $j$，从 $0$ 到 $2N_{\\text{max}}$，可以映射到谐波索引 $n = i - N_{\\text{max}}$ 和 $m = j - N_{\\text{max}}$。\n\n问题要求计算布里渊区边界 $k=\\frac{\\pi}{a}$ 处的带隙。需要计算的矩阵元是：\n$$H_{ij} = \\frac{\\hbar^2}{2m}\\left(\\frac{\\pi}{a} + n_j\\frac{2\\pi}{a}\\right)^2 \\delta_{ij} + V_{n_i - n_j}$$\n其中 $n_i = i-N_{\\text{max}}$ 和 $n_j = j-N_{\\text{max}}$。势分量 $V_m$ 以电子伏特（eV）为单位给出，必须转换为焦耳，以与使用国际单位制（SI）中的 $\\hbar$ 和 $m$ 计算的动能项保持一致。\n\n计算步骤如下：\n1.  对于给定的测试用例（$a$，$N_{\\text{max}}$，$\\{V_m\\}$），定义哈密顿矩阵的维度 $D = 2N_{\\text{max}}+1$。\n2.  构建 $D \\times D$ 的哈密顿矩阵 $\\mathbf{H}$。动能项构成对角线，势分量构成非对角元（并通过 $V_0$ 构成对角元的一部分）。确保所有能量单位都为焦耳。\n3.  问题说明 $V(x)$ 是实的，并且给定的 $V_m$ 也是实的，这意味着 $V_{-m} = V_m$。这使得矩阵的势能部分 $V_{n_i - n_j}$ 是实对称的。因此，整个哈密顿矩阵是实对称的。\n4.  对角化矩阵 $\\mathbf{H}$ 以找到其本征值。对于一个实对称矩阵，这些本征值是实数，代表了在 $k=\\frac{\\pi}{a}$ 处的电子能级 $E_0, E_1, \\dots, E_{D-1}$。\n5.  将本征值按升序排序。\n6.  将本征值从焦耳转换回电子伏特（eV）。\n7.  带隙定义为两个最低本征值之差：$E_{\\text{gap}} = E_1 - E_0$。\n8.  按要求将最终的带隙值四舍五入到六位小数。\n对每个测试用例实施此步骤。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the electronic band gap problem for the provided test cases.\n    \"\"\"\n\n    # Physical constants in SI units\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J.s\n    M_E = 9.1093837015e-31   # Electron rest mass in kg\n    EV_TO_J = 1.602176634e-19 # Conversion factor from eV to Joules\n\n    # Test cases from the problem statement\n    test_cases = [\n        {'a': 5.0e-10, 'N_max': 1, 'V_comp': {0: 0.0, 1: 0.4, -1: 0.4}},\n        {'a': 5.0e-10, 'N_max': 1, 'V_comp': {0: 0.0, 1: 0.05, -1: 0.05}},\n        {'a': 4.0e-10, 'N_max': 1, 'V_comp': {0: 0.0, 1: 0.0, -1: 0.0}},\n        {'a': 5.0e-10, 'N_max': 2, 'V_comp': {0: 0.0, 1: 0.2, -1: 0.2, 2: 0.1, -2: 0.1}},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a = case['a']\n        N_max = case['N_max']\n        V_comp_ev = case['V_comp']\n        \n        # Convert potential components from eV to Joules\n        V_comp_joules = {m: val * EV_TO_J for m, val in V_comp_ev.items()}\n\n        # Wave vector at the Brillouin Zone boundary\n        k = np.pi / a\n\n        # Dimension of the Hamiltonian matrix\n        dim = 2 * N_max + 1\n        \n        # Array of integers n for G_n = n * 2*pi/a\n        n_values = np.arange(-N_max, N_max + 1)\n        \n        # Construct the Hamiltonian matrix H\n        H = np.zeros((dim, dim))\n\n        for i in range(dim):\n            for j in range(dim):\n                n_i = n_values[i]\n                n_j = n_values[j]\n\n                # Diagonal elements: kinetic energy\n                if i == j:\n                    # Wave vector k + G_n\n                    k_plus_G = k + n_j * (2 * np.pi / a)\n                    kinetic_energy = (HBAR**2 * k_plus_G**2) / (2 * M_E)\n                    H[i, j] = kinetic_energy\n                \n                # Potential energy terms (off-diagonal and diagonal)\n                harmonic_diff = n_i - n_j\n                if harmonic_diff in V_comp_joules:\n                    H[i, j] += V_comp_joules[harmonic_diff]\n\n        # Diagonalize the Hermitian matrix to find the eigenvalues (energies).\n        # eigh is efficient for Hermitian matrices and returns sorted eigenvalues.\n        eigenvalues_joules = eigh(H, eigvals_only=True)\n\n        # Convert eigenvalues from Joules to eV\n        eigenvalues_ev = eigenvalues_joules / EV_TO_J\n\n        # The band gap is the difference between the two lowest energy levels\n        band_gap = eigenvalues_ev[1] - eigenvalues_ev[0]\n        \n        results.append(band_gap)\n\n    # Format output as a comma-separated list of strings rounded to 6 decimal places\n    # enclosed in square brackets.\n    formatted_results = ','.join([f\"{res:.6f}\" for res in results])\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "这是一个更高级的练习，它超越了简单的模型，转向了更精确的$k \\cdot p$理论，这对于描述像砷化镓(GaAs)这样的真实半导体至关重要。本练习的重点是推导导带的非抛物线性，这是小带隙半导体中的一个关键效应，影响着电子输运和光学性质。这个计算演示了不同能带之间的相互作用如何修正简单的抛物线色散关系，并导致依赖于能量的有效质量。",
            "id": "3741775",
            "problem": "考虑一个直接带隙闪锌矿半导体，其导带底位于布里渊区中心（$\\Gamma$）。使用考虑了导带 $\\Gamma_{6}^{c}$ 与价带 $\\Gamma_{8}^{v}$（重空穴和轻空穴）以及 $\\Gamma_{7}^{v}$（自旋轨道分裂带）之间耦合的 $k\\cdot p$ Kane 模型。假设在 $\\Gamma$ 点附近色散是各向同性的，忽略这些价带之外的远离能带，并计算到波矢大小 $k$ 和从导带边测量的导带能量 $E$ 的领头阶。\n\n从 Kane 框架内对 $\\Gamma_{6}^{c}$ 导带的二阶微扰理论（对 $k$ 展开）出发，并通过 Kane 能量参数 $E_{p} = 2 m_{0} P^{2} / \\hbar^{2}$ 确定 Kane 动量矩阵元 $P$，推导导带有效质量 $m(E)$ 的领头阶能量依赖关系，并证明其可以写成 $m(E) = m_{0}^{*} \\left( 1 + \\alpha E \\right)$ 的形式，其中 $m_{0}$ 是自由电子质量，$m_{0}^{*}$ 是带边导带有效质量，$\\alpha$ 是非抛物性参数。\n\n然后，使用砷化镓 (GaAs) 的参数 $E_{g} = 1.42\\,\\text{eV}$，$\\Delta = 0.34\\,\\text{eV}$ 和 $E_{p} = 28.8\\,\\text{eV}$，计算 $\\alpha$ 的数值。将您的答案四舍五入到四位有效数字，并以逆电子伏特（eV$^{-1}$）为单位表示。最终答案必须是单个实数。",
            "solution": "这个问题被认为是有效的，因为它科学地基于已建立的半导体能带结构 $k\\cdot p$ 理论，问题提法得当，目标明确，数据充分，并且以客观、正式的语言表述。我们可以开始求解。\n\n该问题要求使用 Kane 模型推导直接带隙半导体中能量依赖的有效质量，并随后计算砷化镓 (GaAs) 的非抛物性参数 $\\alpha$。\n\n我们从二阶微扰理论开始，描述布里渊区中心（$\\Gamma$点, $k=0$）附近的导带能量色散 $E(k)$。能量 $E$ 从导带底开始测量，我们设定 $E_{c}(0) = 0$。未受微扰的价带顶位于 $E_{v,hh/lh}(0) = -E_{g}$（对于重空穴（hh）和轻空穴（lh）带），以及 $E_{v,so}(0) = -E_{g} - \\Delta$（对于自旋轨道分裂（so）带）。\n\n导带中具有波矢 $\\mathbf{k}$ 的一个态的能量 $E$ 由自由电子能量和一个考虑了与价带相互作用的微扰项之和给出。为了找到有效质量的能量依赖关系，微扰求和中的能量分母必须在态自身的能量 $E$ 处求值，而不是在带边能量 $E=0$ 处。这导致了以下关于 $E(k)$ 的隐式方程：\n$$ E = \\frac{\\hbar^{2} k^{2}}{2 m_{0}} + \\sum_{v} \\frac{|\\langle u_{c,0} | \\frac{\\hbar}{m_{0}} \\mathbf{k} \\cdot \\mathbf{p} | u_{v,0} \\rangle|^{2}}{E - E_{v}(0)} $$\n其中 $m_{0}$ 是自由电子质量，$|u_{c,0}\\rangle$ 是 $k=0$ 处导带的布洛赫函数的元胞周期部分，求和遍及相关的价带态 $|u_{v,0}\\rangle$。\n\n在闪锌矿晶体的 Kane 模型中，我们对 $\\mathbf{k}$ 的方向进行平均（各向同性假设），并对来自轻空穴、重空穴和自旋轨道分裂价带的贡献求和。这些矩阵元与 Kane 动量矩阵元 $P$ 相关。使用 Kane 能量参数 $E_{p} = 2 m_{0} P^{2} / \\hbar^{2}$，得到的色散关系表达式是 Kane 三带模型的标准结果：\n$$ E(k) = \\frac{\\hbar^{2} k^{2}}{2 m_{0}} + \\frac{\\hbar^{2} k^{2}}{2 m_{0}} \\frac{E_{p}}{3} \\left( \\frac{2}{E + E_{g}} + \\frac{1}{E + E_{g} + \\Delta} \\right) $$\n因子 $2$ 和 $1$ 分别来自于对 $\\Gamma_{8}^{v}$ 和 $\\Gamma_{7}^{v}$ 多重态的基矢态求和。\n\n我们可以将其重写为：\n$$ E(k) = \\frac{\\hbar^{2} k^{2}}{2 m_{0}} \\left[ 1 + \\frac{E_{p}}{3} \\left( \\frac{2}{E + E_{g}} + \\frac{1}{E + E_{g} + \\Delta} \\right) \\right] $$\n能量依赖的有效质量 $m(E)$ 由关系式 $E(k) = \\frac{\\hbar^{2} k^{2}}{2 m(E)}$ 定义。将此定义代入我们的色散关系中，得到：\n$$ \\frac{\\hbar^{2} k^{2}}{2 m(E)} = \\frac{\\hbar^{2} k^{2}}{2 m_{0}} \\left[ 1 + \\frac{E_{p}}{3} \\left( \\frac{2}{E + E_{g}} + \\frac{1}{E + E_{g} + \\Delta} \\right) \\right] $$\n由此，我们得到倒数有效质量的表达式：\n$$ \\frac{1}{m(E)} = \\frac{1}{m_{0}} \\left[ 1 + \\frac{E_{p}}{3} \\left( \\frac{2}{E + E_{g}} + \\frac{1}{E + E_{g} + \\Delta} \\right) \\right] $$\n带边有效质量 $m_{0}^{*}$ 对应于 $m(E=0)$：\n$$ \\frac{1}{m_{0}^{*}} = \\frac{1}{m_{0}} \\left[ 1 + \\frac{E_{p}}{3} \\left( \\frac{2}{E_{g}} + \\frac{1}{E_{g} + \\Delta} \\right) \\right] $$\n为了找到领头阶的能量依赖关系，我们对括号中的项针对小量 $E$ 进行泰勒展开：\n$$ \\frac{1}{E + E_{g}} = \\frac{1}{E_{g}(1 + E/E_{g})} \\approx \\frac{1}{E_{g}} \\left( 1 - \\frac{E}{E_{g}} \\right) $$\n$$ \\frac{1}{E + E_{g} + \\Delta} = \\frac{1}{(E_{g}+\\Delta)(1 + E/(E_{g}+\\Delta))} \\approx \\frac{1}{E_{g}+\\Delta} \\left( 1 - \\frac{E}{E_{g}+\\Delta} \\right) $$\n将这些近似表达式代回 $1/m(E)$ 的表达式中：\n$$ \\frac{1}{m(E)} \\approx \\frac{1}{m_{0}} \\left[ 1 + \\frac{E_{p}}{3} \\left( \\frac{2}{E_{g}}\\left(1-\\frac{E}{E_{g}}\\right) + \\frac{1}{E_{g}+\\Delta}\\left(1-\\frac{E}{E_{g}+\\Delta}\\right) \\right) \\right] $$\n$$ \\frac{1}{m(E)} \\approx \\frac{1}{m_{0}} \\left[ 1 + \\frac{E_{p}}{3}\\left(\\frac{2}{E_{g}} + \\frac{1}{E_{g}+\\Delta}\\right) \\right] - \\frac{E}{m_{0}} \\frac{E_{p}}{3}\\left(\\frac{2}{E_{g}^{2}} + \\frac{1}{(E_{g}+\\Delta)^{2}}\\right) $$\n第一项恰好是 $1/m_{0}^{*}$。因此：\n$$ \\frac{1}{m(E)} \\approx \\frac{1}{m_{0}^{*}} - \\frac{E}{m_{0}} \\frac{E_{p}}{3}\\left(\\frac{2}{E_{g}^{2}} + \\frac{1}{(E_{g}+\\Delta)^{2}}\\right) $$\n问题要求证明 $m(E)$ 可以写成 $m(E) = m_{0}^{*} (1 + \\alpha E)$。对此形式取倒数并对小量 $\\alpha E$ 展开，得到：\n$$ \\frac{1}{m(E)} = \\frac{1}{m_{0}^{*} (1 + \\alpha E)} = \\frac{1}{m_{0}^{*}} (1 + \\alpha E)^{-1} \\approx \\frac{1}{m_{0}^{*}} (1 - \\alpha E) = \\frac{1}{m_{0}^{*}} - \\frac{\\alpha E}{m_{0}^{*}} $$\n通过比较我们得到的两个关于 $1/m(E)$ 的表达式中 $E$ 的线性项系数，我们发现：\n$$ \\frac{\\alpha}{m_{0}^{*}} = \\frac{1}{m_{0}} \\frac{E_{p}}{3}\\left(\\frac{2}{E_{g}^{2}} + \\frac{1}{(E_{g}+\\Delta)^{2}}\\right) $$\n解出非抛物性参数 $\\alpha$：\n$$ \\alpha = \\frac{m_{0}^{*}}{m_{0}} \\frac{E_{p}}{3}\\left(\\frac{2}{E_{g}^{2}} + \\frac{1}{(E_{g}+\\Delta)^{2}}\\right) $$\n我们可以将 $m_{0}^{*}/m_{0}$ 表示为：\n$$ \\frac{m_{0}^{*}}{m_{0}} = \\left[ 1 + \\frac{E_{p}}{3} \\left( \\frac{2}{E_{g}} + \\frac{1}{E_{g} + \\Delta} \\right) \\right]^{-1} $$\n将此代入 $\\alpha$ 的方程，得到以基本参数表示的最终表达式：\n$$ \\alpha = \\frac{\\frac{E_{p}}{3}\\left(\\frac{2}{E_{g}^{2}} + \\frac{1}{(E_{g}+\\Delta)^{2}}\\right)}{1 + \\frac{E_{p}}{3} \\left( \\frac{2}{E_{g}} + \\frac{1}{E_{g} + \\Delta} \\right)} $$\n现在，我们使用给定的参数：$E_{g} = 1.42\\,\\text{eV}$，$\\Delta = 0.34\\,\\text{eV}$ 和 $E_{p} = 28.8\\,\\text{eV}$，计算 GaAs 的 $\\alpha$ 的数值。\n首先，我们计算分母项：\n$$ D = 1 + \\frac{28.8}{3} \\left( \\frac{2}{1.42} + \\frac{1}{1.42 + 0.34} \\right) = 1 + 9.6 \\left( \\frac{2}{1.42} + \\frac{1}{1.76} \\right) $$\n$$ D = 1 + 9.6 \\left( 1.4084507... + 0.5681818... \\right) = 1 + 9.6 \\left( 1.9766325... \\right) = 1 + 18.975672... = 19.975672... $$\n接下来，我们计算分子项（注意单位是 eV$^{-1}$）：\n$$ N = \\frac{28.8}{3} \\left( \\frac{2}{1.42^{2}} + \\frac{1}{(1.42 + 0.34)^{2}} \\right) = 9.6 \\left( \\frac{2}{2.0164} + \\frac{1}{1.76^{2}} \\right) $$\n$$ N = 9.6 \\left( \\frac{2}{2.0164} + \\frac{1}{3.0976} \\right) = 9.6 \\left( 0.9918667... + 0.3228306... \\right) = 9.6 \\left( 1.3146973... \\right) = 12.621094... \\,\\text{eV}^{-1} $$\n最后，我们计算 $\\alpha$：\n$$ \\alpha = \\frac{N}{D} = \\frac{12.621094...}{19.975672...} \\,\\text{eV}^{-1} = 0.631821... \\,\\text{eV}^{-1} $$\n四舍五入到四位有效数字，我们得到 $\\alpha \\approx 0.6318\\,\\text{eV}^{-1}$。",
            "answer": "$$\\boxed{0.6318}$$"
        }
    ]
}