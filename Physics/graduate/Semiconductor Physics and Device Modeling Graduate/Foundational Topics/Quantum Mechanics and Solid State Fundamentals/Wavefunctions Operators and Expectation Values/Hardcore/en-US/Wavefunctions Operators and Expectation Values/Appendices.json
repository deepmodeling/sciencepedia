{
    "hands_on_practices": [
        {
            "introduction": "The infinite quantum well is the canonical model for understanding quantum confinement in semiconductor heterostructures. This first exercise  guides you through the essential process of deriving the allowed energy states (eigenstates) and their corresponding energies (eigenenergies) from the time-independent Schrödinger equation. By then calculating the expectation values of energy, position, and momentum, you will practice the fundamental technique of extracting measurable physical predictions from a system's wavefunction.",
            "id": "3788149",
            "problem": "A conduction-band electron is confined along the $x$-direction in a square quantum well of width $L$ formed by a semiconductor heterostructure, with infinitely high barriers at $x=0$ and $x=L$. Within the Envelope Function Approximation (EFA) and the Effective Mass Approximation (EMA), assume a constant conduction-band effective mass $m^{\\star}$ in the well region. The time-independent Schrödinger equation for the envelope function $\\psi(x)$ is\n$$-\\frac{\\hbar^{2}}{2 m^{\\star}} \\frac{d^{2}\\psi(x)}{dx^{2}} + V(x)\\,\\psi(x) = E\\,\\psi(x),$$\nwith the potential $V(x)$ given by $V(x)=0$ for $0xL$ and $V(x)=\\infty$ otherwise. The boundary conditions are $\\psi(0)=0$ and $\\psi(L)=0$, and the normalization condition is $\\int_{0}^{L} |\\psi(x)|^{2}\\,dx = 1$.\n\nStarting from the Schrödinger equation and these boundary conditions:\n- Derive the normalized eigenfunctions $\\psi_{n}(x)$ and the corresponding eigenenergies $E_{n}$ for subband index $n \\in \\mathbb{N}$.\n- Using the operator definitions for the energy (Hamiltonian) $\\hat{H}$, position $\\hat{x}$, and momentum $\\hat{p}=-\\,i\\,\\hbar\\,\\frac{d}{dx}$, compute the expectation values $\\langle \\hat{H} \\rangle$, $\\langle x \\rangle$, and $\\langle p \\rangle$ in the stationary state $\\psi_{n}(x)$.\n- Justify any symmetry arguments used in evaluating the expectation values.\n\nExpress the final energy in Joules, the position in meters, and the momentum in kilogram meter per second. Provide your final expressions in closed form as functions of $n$, $L$, $m^{\\star}$, and $\\hbar$. No numerical evaluation is required, and no rounding is needed. Your final answer must present the three expectation values as a single row of expressions in a $1 \\times 3$ matrix.",
            "solution": "The problem is valid as it represents a standard, well-posed problem in quantum mechanics—the particle in an infinite square well—which is a cornerstone model in semiconductor physics for quantum-confined systems. All parameters are clearly defined, and the premises are scientifically sound.\n\nThe solution proceeds in two main parts: first, the derivation of the eigenfunctions and eigenenergies, and second, the calculation of the required expectation values.\n\n**Part 1: Eigenfunctions and Eigenenergies**\n\nThe time-independent Schrödinger equation for the electron's envelope function $\\psi(x)$ is given as:\n$$-\\frac{\\hbar^{2}}{2 m^{\\star}} \\frac{d^{2}\\psi(x)}{dx^{2}} + V(x)\\,\\psi(x) = E\\,\\psi(x)$$\nInside the quantum well, for $0  x  L$, the potential $V(x)=0$. The equation simplifies to:\n$$-\\frac{\\hbar^{2}}{2 m^{\\star}} \\frac{d^{2}\\psi(x)}{dx^{2}} = E\\,\\psi(x)$$\nThis can be rearranged into the form of a simple harmonic oscillator equation:\n$$\\frac{d^{2}\\psi(x)}{dx^{2}} + k^{2}\\psi(x) = 0$$\nwhere we have defined $k^{2} = \\frac{2 m^{\\star} E}{\\hbar^{2}}$. For the particle to be bound, its energy $E$ must be positive, so $k$ is a real number. The general solution to this second-order ordinary differential equation is:\n$$\\psi(x) = A\\sin(kx) + B\\cos(kx)$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\nThe boundary conditions are $\\psi(0)=0$ and $\\psi(L)=0$. Applying the first condition at $x=0$:\n$$\\psi(0) = A\\sin(0) + B\\cos(0) = A \\cdot 0 + B \\cdot 1 = B = 0$$\nThis eliminates the cosine term, leaving the solution as $\\psi(x) = A\\sin(kx)$.\n\nApplying the second boundary condition at $x=L$:\n$$\\psi(L) = A\\sin(kL) = 0$$\nFor a non-trivial solution, the constant $A$ cannot be zero. Therefore, we must have:\n$$\\sin(kL) = 0$$\nThis condition is met when the argument of the sine function is an integer multiple of $\\pi$.\n$$kL = n\\pi, \\quad \\text{where } n \\in \\mathbb{Z}$$\nThe case $n=0$ would lead to $k=0$ and $\\psi(x)=0$ everywhere, which is a trivial solution that cannot be normalized. The cases for negative integers $n$ produce the same physical states as the positive integers, since $\\sin(-z) = -\\sin(z)$ and the overall sign of the wavefunction is arbitrary and does not affect the probability density $|\\psi|^2$. Thus, we restrict $n$ to the set of positive integers, $n \\in \\mathbb{N}$ (i.e., $n=1, 2, 3, \\ldots$).\n\nThe wave number $k$ is therefore quantized:\n$$k_{n} = \\frac{n\\pi}{L}$$\nThe corresponding allowed energy levels, or eigenenergies $E_{n}$, are found by substituting $k_{n}$ back into the definition of $k^{2}$:\n$$E_{n} = \\frac{\\hbar^{2} k_{n}^{2}}{2 m^{\\star}} = \\frac{\\hbar^{2}}{2 m^{\\star}} \\left(\\frac{n\\pi}{L}\\right)^{2} = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m^{\\star}L^{2}}$$\nThe eigenfunctions are of the form $\\psi_{n}(x) = A\\sin\\left(\\frac{n\\pi x}{L}\\right)$. The constant $A$ is determined by the normalization condition $\\int_{0}^{L} |\\psi_{n}(x)|^{2}\\,dx = 1$.\n$$\\int_{0}^{L} \\left|A\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right|^{2} dx = 1$$\n$$|A|^{2} \\int_{0}^{L} \\sin^{2}\\left(\\frac{n\\pi x}{L}\\right) dx = 1$$\nUsing the trigonometric identity $\\sin^{2}(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$:\n$$|A|^{2} \\int_{0}^{L} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx = 1$$\n$$|A|^{2} \\frac{1}{2} \\left[x - \\frac{L}{2n\\pi}\\sin\\left(\\frac{2n\\pi x}{L}\\right)\\right]_{0}^{L} = 1$$\n$$|A|^{2} \\frac{1}{2} \\left[ \\left(L - \\frac{L}{2n\\pi}\\sin(2n\\pi)\\right) - (0 - 0) \\right] = 1$$\nSince $\\sin(2n\\pi)=0$ for any integer $n$:\n$$|A|^{2} \\frac{L}{2} = 1 \\implies |A|^{2} = \\frac{2}{L}$$\nChoosing $A$ to be real and positive, we get $A = \\sqrt{\\frac{2}{L}}$. The normalized eigenfunctions are:\n$$\\psi_{n}(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right) \\quad \\text{for } 0  x  L$$\nand $\\psi_{n}(x) = 0$ otherwise.\n\n**Part 2: Expectation Values in the Stationary State $\\psi_n(x)$**\n\nThe expectation value of an operator $\\hat{O}$ in a state $\\psi$ is given by $\\langle \\hat{O} \\rangle = \\int \\psi^{*} \\hat{O} \\psi \\, dx$.\n\n**1. Expectation Value of Energy, $\\langle \\hat{H} \\rangle$:**\nThe state $\\psi_{n}(x)$ is, by definition, an eigenstate of the Hamiltonian operator $\\hat{H}$ with the eigenvalue $E_{n}$. That is, $\\hat{H}\\psi_{n}(x) = E_{n}\\psi_{n}(x)$. Therefore, the expectation value of the Hamiltonian is simply the eigenvalue:\n$$\\langle \\hat{H} \\rangle = \\int_{0}^{L} \\psi_{n}^{*}(x) \\hat{H} \\psi_{n}(x) dx = \\int_{0}^{L} \\psi_{n}^{*}(x) E_{n} \\psi_{n}(x) dx = E_{n} \\int_{0}^{L} |\\psi_{n}(x)|^{2} dx$$\nDue to normalization, $\\int_{0}^{L} |\\psi_{n}(x)|^{2} dx = 1$. Thus,\n$$\\langle \\hat{H} \\rangle = E_{n} = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m^{\\star}L^{2}}$$\n\n**2. Expectation Value of Position, $\\langle x \\rangle$:**\nThe expectation value of position is $\\langle x \\rangle = \\int_{0}^{L} \\psi_{n}^{*}(x) \\, \\hat{x} \\, \\psi_{n}(x) dx$. Since $\\psi_n(x)$ is real, $\\psi_{n}^{*}(x) = \\psi_{n}(x)$.\n$$\\langle x \\rangle = \\int_{0}^{L} x \\, |\\psi_{n}(x)|^{2} dx = \\int_{0}^{L} x \\frac{2}{L} \\sin^{2}\\left(\\frac{n\\pi x}{L}\\right) dx$$\nWe can evaluate this integral directly, but a symmetry argument is more insightful and is explicitly requested. The probability density function $|\\psi_{n}(x)|^{2} = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)$ is symmetric about the center of the well, $x=L/2$.\nTo formally justify this symmetry, we must show that $|\\psi_{n}(L/2 + \\delta)|^{2} = |\\psi_{n}(L/2 - \\delta)|^{2}$ for any $\\delta$ such that $L/2 \\pm \\delta$ is in the well.\n$$|\\psi_{n}(L/2 + \\delta)|^{2} = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi}{L}(L/2 + \\delta)\\right) = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi}{2} + \\frac{n\\pi\\delta}{L}\\right)$$\n$$|\\psi_{n}(L/2 - \\delta)|^{2} = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi}{L}(L/2 - \\delta)\\right) = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi}{2} - \\frac{n\\pi\\delta}{L}\\right)$$\nUsing the identity $\\sin(\\alpha \\pm \\beta) = \\sin\\alpha\\cos\\beta \\pm \\cos\\alpha\\sin\\beta$, we see that if $n$ is odd, $\\sin(\\frac{n\\pi}{2})=\\pm 1, \\cos(\\frac{n\\pi}{2})=0$, so $\\sin^2(\\ldots)$ becomes $\\cos^2(\\frac{n\\pi\\delta}{L})$ in both cases. If $n$ is even, $\\sin(\\frac{n\\pi}{2})=0, \\cos(\\frac{n\\pi}{2})=\\pm 1$, so $\\sin^2(\\ldots)$ becomes $\\sin^2(\\frac{n\\pi\\delta}{L})$ in both cases. Thus, the probability density is always symmetric.\nThe expectation value of $x$ is the average value of position, weighted by this symmetric probability density. For any function $f(x)$ that is symmetric about the midpoint $C$ of an interval $[a, b]$, the weighted average $\\frac{\\int_a^b x f(x) dx}{\\int_a^b f(x) dx}$ is equal to $C$. Here, the interval is $[0, L]$, the midpoint is $L/2$, and the integral of the probability density in the denominator is $1$. Therefore,\n$$\\langle x \\rangle = \\frac{L}{2}$$\n\n**3. Expectation Value of Momentum, $\\langle p \\rangle$:**\nThe expectation value of momentum is $\\langle p \\rangle = \\int_{0}^{L} \\psi_{n}^{*}(x) \\hat{p} \\psi_{n}(x) dx$, with $\\hat{p} = -i\\hbar\\frac{d}{dx}$.\n$$\\langle p \\rangle = \\int_{0}^{L} \\left(\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right) \\left(-i\\hbar \\frac{d}{dx}\\right) \\left(\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right) dx$$\n$$\\langle p \\rangle = -i\\hbar \\frac{2}{L} \\int_{0}^{L} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\frac{d}{dx}\\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n$$\\langle p \\rangle = -i\\hbar \\frac{2}{L} \\left(\\frac{n\\pi}{L}\\right) \\int_{0}^{L} \\sin\\left(\\frac{n\\pi x}{L}\\right)\\cos\\left(\\frac{n\\pi x}{L}\\right) dx$$\nUsing the identity $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$:\n$$\\langle p \\rangle = -i\\hbar \\frac{n\\pi}{L^{2}} \\int_{0}^{L} \\sin\\left(\\frac{2n\\pi x}{L}\\right) dx$$\n$$\\langle p \\rangle = -i\\hbar \\frac{n\\pi}{L^{2}} \\left[-\\frac{L}{2n\\pi}\\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right]_{0}^{L}$$\n$$\\langle p \\rangle = -i\\hbar \\frac{n\\pi}{L^{2}} \\left(-\\frac{L}{2n\\pi}\\right) \\left[\\cos(2n\\pi) - \\cos(0)\\right]$$\n$$\\langle p \\rangle = \\frac{i\\hbar}{2L} [1 - 1] = 0$$\nA more general justification can be made. For any real, normalized wavefunction $\\psi(x)$ that vanishes at the boundaries of the integration interval (as is the case here, with $\\psi_n(0)=\\psi_n(L)=0$), the expectation value of momentum is always zero.\n$$\\langle p \\rangle = -i\\hbar \\int_0^L \\psi_n(x) \\frac{d\\psi_n(x)}{dx} dx$$\nThis integral is $\\frac{1}{2} \\int_0^L \\frac{d}{dx}(\\psi_n(x)^2) dx = \\frac{1}{2} [\\psi_n(x)^2]_0^L = \\frac{1}{2}(\\psi_n(L)^2 - \\psi_n(0)^2) = \\frac{1}{2}(0-0)=0$.\nPhysically, the stationary states are standing waves, formed by the superposition of right-moving and left-moving waves with equal amplitude. The electron is equally likely to be found moving in the $+x$ direction as in the $-x$ direction, so its average momentum is zero.\n\nThe three expectation values are:\n$\\langle \\hat{H} \\rangle = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m^{\\star}L^{2}}$\n$\\langle x \\rangle = \\frac{L}{2}$\n$\\langle p \\rangle = 0$\n\nThese are presented in a $1 \\times 3$ matrix as requested.",
            "answer": "$$\\boxed{\\pmatrix{ \\frac{\\hbar^{2} \\pi^{2} n^{2}}{2 m^{\\star} L^{2}}  \\frac{L}{2}  0 }}$$"
        },
        {
            "introduction": "Beyond spatial confinement, a complete description of an electron must include its intrinsic spin, which becomes particularly important in modern semiconductor devices where spin-orbit coupling effects are significant. In this practice , you will advance from scalar wavefunctions to two-component spinors and learn to work with spin operators, represented by the Pauli matrices. This exercise provides critical hands-on experience in calculating the expectation value of spin for a state influenced by a position-dependent Rashba-like interaction.",
            "id": "3788150",
            "problem": "Consider a III–V semiconductor heterostructure that forms a two-dimensional electron gas (2DEG) at an abrupt interface located at $z=0$, with the growth direction along $z$. Due to structure inversion asymmetry and the associated Rashba spin–orbit coupling, the conduction-band envelope spinor acquires a position-dependent relative phase between its components. Assume the bound-state envelope along $z$ is well approximated by the normalized function $f(z)=\\sqrt{2\\kappa}\\,\\exp(-\\kappa z)$ for $z\\ge 0$, where $\\kappa0$ is a real decay constant set by the band offset and effective mass. The total spinor wavefunction is separable and, ignoring in-plane dynamics by taking the in-plane factor normalized to unity, is given by\n$$\n\\Psi(z)=f(z)\\,\\chi(z),\\quad \\chi(z)=\\begin{pmatrix} a \\\\ b\\,\\exp(i\\beta z) \\end{pmatrix},\n$$\nwhere $a$ and $b$ are real, nonnegative constants satisfying $a^{2}+b^{2}=1$, and $\\beta0$ is a real parameter that models the position-dependent phase induced by the Rashba field. The spin operators are defined by\n$$\n\\hat{\\mathbf{S}}=\\frac{\\hbar}{2}\\,\\boldsymbol{\\sigma},\n$$\nwhere $\\boldsymbol{\\sigma}=(\\sigma_{x},\\sigma_{y},\\sigma_{z})$ are the Pauli matrices.\n\nStarting from the foundational definitions of quantum mechanical expectation values and the above spin operator, derive an expression for the spin expectation value $\\langle \\hat{\\mathbf{S}}\\rangle$ of the state $\\Psi(z)$ by explicitly evaluating the necessary integrals over $z\\ge 0$. Then, for the specific parameter values $a=\\sqrt{3}/2$, $b=1/2$, and $\\beta=2\\kappa$, compute the dimensionless spin expectation vector\n$$\n\\langle \\boldsymbol{\\sigma}\\rangle=\\left(\\langle \\sigma_{x}\\rangle,\\langle \\sigma_{y}\\rangle,\\langle \\sigma_{z}\\rangle\\right),\n$$\nand express your final answer as a single row matrix. No rounding is required. Report the dimensionless vector $\\langle \\boldsymbol{\\sigma}\\rangle$ only; do not include physical units in your final answer.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, and objective. It is a standard quantum mechanics problem within the context of semiconductor physics. All necessary information is provided, and the parameters are consistent.\n\nThe objective is to compute the dimensionless spin expectation vector $\\langle \\boldsymbol{\\sigma}\\rangle = (\\langle \\sigma_{x}\\rangle, \\langle \\sigma_{y}\\rangle, \\langle \\sigma_{z}\\rangle)$ for the given quantum state $\\Psi(z)$.\n\nThe total spinor wavefunction is given by $\\Psi(z) = f(z)\\chi(z)$, where the spatial part is $f(z)=\\sqrt{2\\kappa}\\,\\exp(-\\kappa z)$ for $z\\ge 0$ and the spinor part is $\\chi(z)=\\begin{pmatrix} a \\\\ b\\,\\exp(i\\beta z) \\end{pmatrix}$. The state is defined in the region $z \\ge 0$. The parameters $a$ and $b$ are real, nonnegative constants satisfying the normalization $a^2+b^2=1$. The spatial part $f(z)$ is also normalized over its domain:\n$$ \\int_0^\\infty |f(z)|^2 dz = \\int_0^\\infty \\left(\\sqrt{2\\kappa}\\,\\exp(-\\kappa z)\\right)^2 dz = \\int_0^\\infty 2\\kappa\\,\\exp(-2\\kappa z) dz = \\left[-\\exp(-2\\kappa z)\\right]_0^\\infty = 0 - (-1) = 1 $$\nThe total state $\\Psi(z)$ is therefore normalized, as $\\int_0^\\infty \\Psi^\\dagger(z)\\Psi(z)dz = \\int_0^\\infty |f(z)|^2 \\chi^\\dagger(z)\\chi(z) dz$. The spinor inner product is $\\chi^\\dagger(z)\\chi(z) = a^2 + |b\\,\\exp(i\\beta z)|^2 = a^2+b^2=1$. Thus, $\\int_0^\\infty \\Psi^\\dagger(z)\\Psi(z)dz = \\int_0^\\infty |f(z)|^2 dz = 1$.\n\nThe expectation value of a spin component operator $\\sigma_j$ (where $j \\in \\{x, y, z\\}$) is given by the integral:\n$$ \\langle \\sigma_j \\rangle = \\langle \\Psi | \\sigma_j | \\Psi \\rangle = \\int_0^\\infty \\Psi^\\dagger(z) \\sigma_j \\Psi(z) dz $$\nSubstituting $\\Psi(z)=f(z)\\chi(z)$ and using the fact that $f(z)$ is a real-valued scalar function, we get:\n$$ \\langle \\sigma_j \\rangle = \\int_0^\\infty |f(z)|^2 \\left( \\chi^\\dagger(z) \\sigma_j \\chi(z) \\right) dz $$\nWe now evaluate this for each component. The Pauli matrices are:\n$$ \\sigma_{x} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}, \\quad \\sigma_{y} = \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}, \\quad \\sigma_{z} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} $$\nThe spinor and its conjugate transpose are:\n$$ \\chi(z) = \\begin{pmatrix} a \\\\ b\\,\\exp(i\\beta z) \\end{pmatrix}, \\quad \\chi^\\dagger(z) = \\begin{pmatrix} a  b\\,\\exp(-i\\beta z) \\end{pmatrix} $$\n\n**Calculation of $\\langle \\sigma_x \\rangle$**\nFirst, we find the spinor matrix element:\n$$ \\chi^\\dagger(z) \\sigma_x \\chi(z) = \\begin{pmatrix} a  b\\,\\exp(-i\\beta z) \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} a \\\\ b\\,\\exp(i\\beta z) \\end{pmatrix} = \\begin{pmatrix} a  b\\,\\exp(-i\\beta z) \\end{pmatrix} \\begin{pmatrix} b\\,\\exp(i\\beta z) \\\\ a \\end{pmatrix} $$\n$$ = ab\\,\\exp(i\\beta z) + ab\\,\\exp(-i\\beta z) = 2ab \\cos(\\beta z) $$\nNow, we perform the integration over $z$:\n$$ \\langle \\sigma_x \\rangle = \\int_0^\\infty |f(z)|^2 (2ab \\cos(\\beta z)) dz = \\int_0^\\infty 2\\kappa\\,\\exp(-2\\kappa z) \\, (2ab \\cos(\\beta z)) dz = 4ab\\kappa \\int_0^\\infty \\exp(-2\\kappa z) \\cos(\\beta z) dz $$\nUsing the standard integral result $\\int_0^\\infty \\exp(-pz)\\cos(qz)dz = \\frac{p}{p^2+q^2}$, with $p=2\\kappa$ and $q=\\beta$:\n$$ \\langle \\sigma_x \\rangle = 4ab\\kappa \\left( \\frac{2\\kappa}{(2\\kappa)^2 + \\beta^2} \\right) = \\frac{8ab\\kappa^2}{4\\kappa^2 + \\beta^2} $$\n\n**Calculation of $\\langle \\sigma_y \\rangle$**\nFirst, the spinor matrix element:\n$$ \\chi^\\dagger(z) \\sigma_y \\chi(z) = \\begin{pmatrix} a  b\\,\\exp(-i\\beta z) \\end{pmatrix} \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix} \\begin{pmatrix} a \\\\ b\\,\\exp(i\\beta z) \\end{pmatrix} = \\begin{pmatrix} a  b\\,\\exp(-i\\beta z) \\end{pmatrix} \\begin{pmatrix} -ib\\,\\exp(i\\beta z) \\\\ ia \\end{pmatrix} $$\n$$ = -iab\\,\\exp(i\\beta z) + iab\\,\\exp(-i\\beta z) = iab(\\exp(-i\\beta z) - \\exp(i\\beta z)) = iab(-2i\\sin(\\beta z)) = 2ab \\sin(\\beta z) $$\nNow, the integration:\n$$ \\langle \\sigma_y \\rangle = \\int_0^\\infty |f(z)|^2 (2ab \\sin(\\beta z)) dz = 4ab\\kappa \\int_0^\\infty \\exp(-2\\kappa z) \\sin(\\beta z) dz $$\nUsing the standard integral result $\\int_0^\\infty \\exp(-pz)\\sin(qz)dz = \\frac{q}{p^2+q^2}$, with $p=2\\kappa$ and $q=\\beta$:\n$$ \\langle \\sigma_y \\rangle = 4ab\\kappa \\left( \\frac{\\beta}{(2\\kappa)^2 + \\beta^2} \\right) = \\frac{4ab\\kappa\\beta}{4\\kappa^2 + \\beta^2} $$\n\n**Calculation of $\\langle \\sigma_z \\rangle$**\nFirst, the spinor matrix element:\n$$ \\chi^\\dagger(z) \\sigma_z \\chi(z) = \\begin{pmatrix} a  b\\,\\exp(-i\\beta z) \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b\\,\\exp(i\\beta z) \\end{pmatrix} = \\begin{pmatrix} a  b\\,\\exp(-i\\beta z) \\end{pmatrix} \\begin{pmatrix} a \\\\ -b\\,\\exp(i\\beta z) \\end{pmatrix} $$\n$$ = a^2 - b^2 $$\nThe result is independent of $z$. The integration is straightforward:\n$$ \\langle \\sigma_z \\rangle = \\int_0^\\infty |f(z)|^2 (a^2 - b^2) dz = (a^2-b^2) \\int_0^\\infty |f(z)|^2 dz = (a^2-b^2) \\times 1 = a^2 - b^2 $$\n\nNow we substitute the specific parameter values given in the problem: $a=\\frac{\\sqrt{3}}{2}$, $b=\\frac{1}{2}$, and $\\beta=2\\kappa$.\nFirst, we compute the necessary products:\n$a^2 = (\\frac{\\sqrt{3}}{2})^2 = \\frac{3}{4}$\n$b^2 = (\\frac{1}{2})^2 = \\frac{1}{4}$\n$ab = \\frac{\\sqrt{3}}{2} \\times \\frac{1}{2} = \\frac{\\sqrt{3}}{4}$\n\nSubstitute these into the expressions for the expectation values.\n\nFor $\\langle \\sigma_x \\rangle$:\n$$ \\langle \\sigma_x \\rangle = \\frac{8ab\\kappa^2}{4\\kappa^2 + \\beta^2} = \\frac{8\\left(\\frac{\\sqrt{3}}{4}\\right)\\kappa^2}{4\\kappa^2 + (2\\kappa)^2} = \\frac{2\\sqrt{3}\\kappa^2}{4\\kappa^2 + 4\\kappa^2} = \\frac{2\\sqrt{3}\\kappa^2}{8\\kappa^2} = \\frac{\\sqrt{3}}{4} $$\n\nFor $\\langle \\sigma_y \\rangle$:\n$$ \\langle \\sigma_y \\rangle = \\frac{4ab\\kappa\\beta}{4\\kappa^2 + \\beta^2} = \\frac{4\\left(\\frac{\\sqrt{3}}{4}\\right)\\kappa(2\\kappa)}{4\\kappa^2 + (2\\kappa)^2} = \\frac{\\sqrt{3}\\,(2\\kappa^2)}{8\\kappa^2} = \\frac{2\\sqrt{3}\\kappa^2}{8\\kappa^2} = \\frac{\\sqrt{3}}{4} $$\n\nFor $\\langle \\sigma_z \\rangle$:\n$$ \\langle \\sigma_z \\rangle = a^2 - b^2 = \\frac{3}{4} - \\frac{1}{4} = \\frac{2}{4} = \\frac{1}{2} $$\n\nThe dimensionless spin expectation vector is $\\langle \\boldsymbol{\\sigma}\\rangle = \\left(\\frac{\\sqrt{3}}{4}, \\frac{\\sqrt{3}}{4}, \\frac{1}{2}\\right)$. The final answer is to be expressed as a row matrix.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sqrt{3}}{4}  \\frac{\\sqrt{3}}{4}  \\frac{1}{2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "While analytical models provide deep physical insight, the simulation of realistic semiconductor devices almost always requires numerical methods. This exercise  bridges the gap between continuous theory and computational practice by having you construct a matrix representation of the kinetic energy operator using the finite-difference method. You will explore how to ensure this discrete operator correctly reflects the physical properties of its continuous counterpart, such as Hermiticity and positive semidefiniteness, and analyze the conditions for numerical stability—essential concepts in computational device modeling.",
            "id": "3788152",
            "problem": "Construct a finite-difference matrix representation of the kinetic energy operator $-\\dfrac{\\hbar^2}{2 m^*} \\nabla^2$ on a $d$-dimensional uniform Cartesian grid with spacing $a$ and constant effective mass $m^*$. Begin from the time-independent kinetic Hamiltonian definition, the linearity of the Laplacian, and the discrete inner product induced by the Riemann sum on a uniform grid. Derive a consistent second-order accurate stencil that yields a sparse matrix acting on the vectorized grid samples of a wavefunction. Address both Dirichlet boundary conditions (vanishing wavefunction at the boundary) and periodic boundary conditions. Using the operator definition of Hermiticity with respect to the discrete inner product, derive conditions on the finite-difference stencil and boundary treatment that ensure the discrete kinetic operator is Hermitian and positive semidefinite.\n\nUse these principles to design an algorithm that, for a given dimension $d \\in \\{\\,1,2\\,\\}$, grid sizes $N_x$ and $N_y$ (for $d=2$) or $N_x$ (for $d=1$), uniform spacing $a$, and constant effective mass $m^*$, constructs the matrix $T = -\\dfrac{\\hbar^2}{2 m^*} L$ where $L$ is the discrete Laplacian, and computes the following diagnostics:\n- The Hermiticity defect $E_H := \\max_{i,j} \\left| T_{ij} - T_{ji}^* \\right|$ with respect to the standard Euclidean inner product on the vectorized grid. This should be numerically $0$ for exact Hermiticity up to floating-point rounding.\n- The smallest eigenvalue $\\lambda_{\\min}(T)$ in joules (J), which should be nonnegative for a positive semidefinite kinetic operator and exactly $0$ in the periodic case corresponding to the constant mode.\n- A stability time-step bound $\\Delta \\tau_{\\max}$ in seconds (s) for the explicit forward Euler scheme applied to the imaginary-time evolution equation $\\dfrac{\\partial \\psi}{\\partial \\tau} = \\dfrac{\\hbar}{2 m^*} \\nabla^2 \\psi$ on a $d$-dimensional uniform grid using the same discrete Laplacian. Derive this bound by von Neumann analysis for the worst-case discrete Fourier mode on the uniform grid and express it in closed form in terms of $a$, $d$, $\\hbar$, and $m^*$.\n\nUse the following physical constants in International System of Units (SI):\n- Reduced Planck constant $\\hbar = 1.054571817 \\times 10^{-34} \\,\\mathrm{J\\,s}$.\n- Electron rest mass $m_e = 9.1093837015 \\times 10^{-31} \\,\\mathrm{kg}$.\n\nYour program must implement the above for the test suite below, treating $m^*$ as a multiple of $m_e$, and $a$ specified in nanometers. Convert all quantities to SI units internally. For Dirichlet boundary conditions in $d=1$ and $d=2$, construct the discrete Laplacian on the interior grid of sizes $N_x$ (for $d=1$) and $N_x \\times N_y$ (for $d=2$) with the standard second-order nearest-neighbor stencil. For periodic boundary conditions, use wrap-around coupling consistently in each dimension.\n\nTest suite parameters:\n- Case $1$: $d=1$, $N_x=5$, $a=0.5\\,\\mathrm{nm}$, $m^*/m_e=0.2$, boundary condition: Dirichlet.\n- Case $2$: $d=1$, $N_x=6$, $a=0.25\\,\\mathrm{nm}$, $m^*/m_e=1.0$, boundary condition: Periodic.\n- Case $3$: $d=2$, $N_x=4$, $N_y=5$, $a=1.0\\,\\mathrm{nm}$, $m^*/m_e=0.067$, boundary condition: Dirichlet.\n- Case $4$: $d=2$, $N_x=3$, $N_y=3$, $a=0.8\\,\\mathrm{nm}$, $m^*/m_e=0.19$, boundary condition: Periodic.\n\nFor each case, your program must output a list with four entries:\n- Entry $1$: a boolean indicating whether $E_H \\le \\varepsilon$ with $\\varepsilon=10^{-12}$.\n- Entry $2$: the Hermiticity defect $E_H$ as a floating-point number (unitless).\n- Entry $3$: the smallest eigenvalue $\\lambda_{\\min}(T)$ as a floating-point number in joules (J).\n- Entry $4$: the stability bound $\\Delta \\tau_{\\max}$ as a floating-point number in seconds (s).\n\nFinal output format:\n- Your program should produce a single line of output containing all case results as a comma-separated list of per-case lists, with no spaces, enclosed in square brackets. Concretely, the output must look like $[ [b_1,E_{H,1},\\lambda_{\\min,1},\\Delta\\tau_{\\max,1}],[b_2,E_{H,2},\\lambda_{\\min,2},\\Delta\\tau_{\\max,2}],\\ldots ]$ but with no spaces at all, for example: $[[\\mathrm{True},1.0,2.0,3.0],[\\mathrm{False},4.0,5.0,6.0]]$.\n\nAll numeric answers involving physical units must be in SI units: joules (J) for energies and seconds (s) for time. Angles, if any appear, must be in radians. Percentages, if any appear, must be expressed as decimals.",
            "solution": "The problem requires the derivation and implementation of a finite-difference representation for the quantum mechanical kinetic energy operator, followed by an analysis of its properties (Hermiticity, positive semidefiniteness) and application to numerical stability.\n\n### Step 1: Theoretical Derivation and Analysis\n\n#### 1.1 Finite-Difference Discretization of the Kinetic Energy Operator\nThe time-independent kinetic energy operator in $d$ dimensions is given by $\\hat{T} = -\\dfrac{\\hbar^2}{2 m^*} \\nabla^2$, where $m^*$ is the constant effective mass and $\\nabla^2$ is the Laplacian operator, $\\nabla^2 = \\sum_{k=1}^d \\dfrac{\\partial^2}{\\partial x_k^2}$.\n\nWe discretize this operator on a uniform Cartesian grid with spacing $a$ in each dimension. The second partial derivative $\\dfrac{\\partial^2 \\psi}{\\partial x^2}$ at a grid point $x_i$ can be approximated using a second-order accurate central difference formula derived from Taylor series expansions:\n$$ \\psi(x_i+a) = \\psi(x_i) + a \\psi'(x_i) + \\frac{a^2}{2} \\psi''(x_i) + \\mathcal{O}(a^3) $$\n$$ \\psi(x_i-a) = \\psi(x_i) - a \\psi'(x_i) + \\frac{a^2}{2} \\psi''(x_i) - \\mathcal{O}(a^3) $$\nAdding these two equations and rearranging for $\\psi''(x_i)$ yields:\n$$ \\frac{\\partial^2 \\psi}{\\partial x^2}\\bigg|_{x_i} \\approx \\frac{\\psi(x_i+a) - 2\\psi(x_i) + \\psi(x_i-a)}{a^2} $$\nThis approximation has a truncation error of $\\mathcal{O}(a^2)$.\n\nFor a $d$-dimensional grid, the Laplacian acting on a wavefunction $\\psi$ at grid point $\\mathbf{r}$ is the sum of these second derivatives:\n$$ \\nabla^2\\psi(\\mathbf{r}) \\approx \\frac{1}{a^2} \\left[ \\sum_{k=1}^d \\left( \\psi(\\mathbf{r} + a\\mathbf{e}_k) + \\psi(\\mathbf{r} - a\\mathbf{e}_k) \\right) - 2d \\cdot \\psi(\\mathbf{r}) \\right] $$\nwhere $\\mathbf{e}_k$ are the standard basis vectors. This is a $(2d+1)$-point stencil.\n\nThe discrete kinetic energy operator $T$ acts on a vectorized representation of the wavefunction $\\boldsymbol{\\psi}$ (a column vector of function values at all grid points) as a matrix multiplication $T\\boldsymbol{\\psi}$. The matrix $T$ is given by $T = -\\dfrac{\\hbar^2}{2 m^*} L$, where $L$ is the matrix representation of the discrete Laplacian. For a total of $N$ grid points, $L$ is an $N \\times N$ matrix. For a point with linear index $p$, the diagonal element is $L_{pp} = -2d/a^2$. The off-diagonal element $L_{pq}$ is $1/a^2$ if point $q$ is one of the $2d$ nearest neighbors of point $p$, and $0$ otherwise (with boundary conditions modifying this for points at the edge of the grid).\n\n#### 1.2 Boundary Conditions\n- **Dirichlet Boundary Conditions**: The wavefunction is assumed to be zero on the boundaries. The grid points are the $N$ interior points. For a point adjacent to a boundary, one of its neighbors lies on the boundary, so its wavefunction value is $0$ and does not contribute to the stencil. This results in a sparse, banded matrix $L$. For $d=1$, this is a tridiagonal matrix. For $d=2$, this is a block-tridiagonal matrix.\n- **Periodic Boundary Conditions**: The grid is treated as a torus, where the end of the grid in any dimension wraps around to its beginning. For a point at an edge (e.g., $i=N_x-1$), its neighbor in the positive direction is the first point ($i=0$). This introduces non-zero elements in $L$ that connect the \"first\" and \"last\" grid points, making it a circulant (in 1D) or block-circulant (in 2D) matrix.\n\n#### 1.3 Hermiticity and Positive Semidefiniteness\nAn operator $\\hat{O}$ is Hermitian with respect to an inner product $\\langle \\cdot, \\cdot \\rangle$ if $\\langle \\phi | \\hat{O} \\psi \\rangle = \\langle \\hat{O} \\phi | \\psi \\rangle$. For a discrete grid, the inner product is a weighted sum $\\langle \\boldsymbol{\\phi} | \\boldsymbol{\\psi} \\rangle = \\sum_p \\phi_p^* \\psi_p a^d = (\\boldsymbol{\\phi} a^{d/2})^\\dagger (\\boldsymbol{\\psi} a^{d/2})$. The condition for the matrix operator $T$ to be Hermitian is $(\\boldsymbol{\\phi} a^{d/2})^\\dagger (T \\boldsymbol{\\psi} a^{d/2}) = ((T \\boldsymbol{\\phi}) a^{d/2})^\\dagger (\\boldsymbol{\\psi} a^{d/2})$, which simplifies to $\\boldsymbol{\\phi}^\\dagger T \\boldsymbol{\\psi} = \\boldsymbol{\\phi}^\\dagger T^\\dagger \\boldsymbol{\\psi}$. This must hold for all $\\boldsymbol{\\phi}, \\boldsymbol{\\psi}$, which implies $T = T^\\dagger$. Since the stencil coefficients are real, this reduces to $T$ being a symmetric matrix, $T = T^T$.\n\nThe matrix $L$ constructed from the standard central difference stencil is symmetric. For any two points $p$ and $q$, if $q$ is a neighbor of $p$, then $p$ is a neighbor of $q$. Thus $L_{pq} = L_{qp} = 1/a^2$ (or $0$ if not neighbors). This symmetry is preserved for both Dirichlet and periodic boundary conditions. Since $T$ is a scalar multiple of $L$, $T$ is also symmetric and thus Hermitian. The Hermiticity defect $E_H = \\max_{ij} |T_{ij} - T_{ji}^*|$ should be zero up to machine precision.\n\nAn operator is positive semidefinite if all its eigenvalues are non-negative. The kinetic energy must be non-negative. The eigenvalues of the 1D discrete Laplacian matrix $L_{1D}$ are known to be non-positive:\n- Dirichlet BCs (on $N$ points): $\\lambda_k = \\frac{2}{a^2} \\left[ \\cos\\left(\\frac{k\\pi}{N+1}\\right) - 1 \\right]$ for $k=1, \\dots, N$. All $\\lambda_k  0$.\n- Periodic BCs (on $N$ points): $\\lambda_k = \\frac{2}{a^2} \\left[ \\cos\\left(\\frac{2k\\pi}{N}\\right) - 1 \\right]$ for $k=0, \\dots, N-1$. All $\\lambda_k \\le 0$, with $\\lambda_0 = 0$.\n\nIn $d$ dimensions, the eigenvalues of $L$ are sums of the 1D eigenvalues, so they are also non-positive. The operator $T = - \\frac{\\hbar^2}{2m^*} L$ has eigenvalues $\\lambda_T = - \\frac{\\hbar^2}{2m^*} \\lambda_L$. Since $\\frac{\\hbar^2}{2m^*}  0$ and $\\lambda_L \\le 0$, all eigenvalues $\\lambda_T$ must be non-negative. This confirms that $T$ is positive semidefinite. The smallest eigenvalue $\\lambda_{\\min}(T)$ will be strictly positive for Dirichlet BCs and exactly zero for periodic BCs (corresponding to the uniform, zero-kinetic-energy mode).\n\n#### 1.4 Stability Analysis\nWe analyze the stability of the explicit forward Euler scheme for the imaginary-time Schrödinger equation, $\\dfrac{\\partial \\psi}{\\partial \\tau} = \\dfrac{\\hbar}{2 m^*} \\nabla^2 \\psi$.\nThe discretized form is $\\dfrac{\\boldsymbol{\\psi}^{n+1} - \\boldsymbol{\\psi}^n}{\\Delta \\tau} = \\dfrac{\\hbar}{2m^*} L \\boldsymbol{\\psi}^n$, which gives the update rule $\\boldsymbol{\\psi}^{n+1} = \\left(I + \\Delta \\tau \\dfrac{\\hbar}{2m^*} L\\right) \\boldsymbol{\\psi}^n$.\nThe matrix $G = I + \\Delta \\tau \\dfrac{\\hbar}{2m^*} L$ is the amplification matrix. For stability, the spectral radius of $G$ must not exceed $1$, i.e., $|\\lambda_G| \\le 1$ for all eigenvalues $\\lambda_G$ of $G$. The eigenvalues of $G$ are $\\lambda_G = 1 + \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L$, where $\\lambda_L$ are the eigenvalues of $L$.\nSo, the stability condition is $\\left| 1 + \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L \\right| \\le 1$ for all $\\lambda_L$.\nSince $\\lambda_L \\le 0$, this becomes $-1 \\le 1 + \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L \\le 1$. The right-hand side is always satisfied. The left-hand side gives:\n$$ -2 \\le \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L \\implies \\Delta \\tau \\le \\frac{-4m^*}{\\hbar \\lambda_L} $$\nTo ensure stability for all modes, we must satisfy this for the most restrictive case, which is the most negative eigenvalue of $L$, denoted $\\lambda_{L, \\text{min}}$.\nIn a von Neumann stability analysis, we consider plane wave solutions $\\psi_{\\mathbf{k}}(\\mathbf{r}) \\propto e^{i\\mathbf{k}\\cdot\\mathbf{r}}$ on an infinite grid. The eigenvalue of the discrete Laplacian for a mode $\\mathbf{k}$ is:\n$$ \\lambda_L(\\mathbf{k}) = \\sum_{j=1}^d \\frac{2}{a^2}(\\cos(k_j a) - 1) $$\nThe most negative eigenvalue corresponds to the highest frequency mode the grid can support, where $k_j a = \\pi$ for all $j=1, \\dots, d$.\n$$ \\lambda_{L, \\text{min}} = \\sum_{j=1}^d \\frac{2}{a^2}(\\cos(\\pi) - 1) = \\sum_{j=1}^d \\left( -\\frac{4}{a^2} \\right) = -\\frac{4d}{a^2} $$\nSubstituting this into the stability inequality gives the maximum stable timestep:\n$$ \\Delta \\tau_{\\max} = \\frac{-4m^*}{\\hbar \\left( -4d/a^2 \\right)} = \\frac{m^* a^2}{d \\hbar} $$\nThis bound depends only on the material and grid parameters, not the boundary conditions or grid size.\n\n### Step 2: Algorithm and Implementation\nThe algorithm proceeds as follows:\n1.  Initialize physical constants $\\hbar$ and $m_e$.\n2.  For each test case, convert input parameters ($a$ in nm, $m^*/m_e$) to base SI units (m, kg).\n3.  Construct the discrete Laplacian matrix $L$ based on dimension $d$ and boundary condition type.\n    - The matrix dimensions are $N \\times N$, where $N=N_x$ in 1D and $N=N_x \\times N_y$ in 2D.\n    - A mapping from 2D grid indices $(i, j)$ to a linear index $k$ (e.g., row-major $k = i \\cdot N_y + j$) is used.\n    - For each grid point $k$, set the diagonal element $L_{kk} = -2d/a^2$.\n    - For each of the $2d$ nearest neighbors $q$ of $k$, set the off-diagonal element $L_{kq} = 1/a^2$, respecting the boundary conditions (either by checking bounds for Dirichlet or using modulo arithmetic for periodic).\n4.  Calculate the kinetic energy matrix $T = -\\dfrac{\\hbar^2}{2m^*}L$.\n5.  Compute the required diagnostics:\n    a. **Hermiticity Defect ($E_H$)**: Calculate $T - T^\\dagger$. As $T$ is real, this is $T-T^T$. Find the maximum absolute value of the elements of the resulting matrix. Check if $E_H \\le 10^{-12}$.\n    b. **Smallest Eigenvalue ($\\lambda_{\\min}(T)$)**: Compute the eigenvalues of the Hermitian matrix $T$. `numpy.linalg.eigh` is suitable as it is optimized for Hermitian matrices. Find the minimum of these real eigenvalues.\n    c. **Stability Bound ($\\Delta\\tau_{\\max}$)**: Calculate using the derived formula $\\Delta\\tau_{\\max} = \\frac{m^* a^2}{d \\hbar}$.\n6.  Format the results as a list `[is_hermitian, E_H, lambda_min, delta_tau_max]` for each case.\n7.  Combine all case results into a single string formatted as specified in the problem.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs the finite-difference kinetic energy operator matrix and calculates\n    diagnostics for specified test cases.\n    \"\"\"\n    HBAR = 1.054571817e-34  # J.s\n    M_E = 9.1093837015e-31   # kg\n\n    test_cases = [\n        {'d': 1, 'Ns': (5,), 'a_nm': 0.5, 'm_star_ratio': 0.2, 'bc': 'Dirichlet'},\n        {'d': 1, 'Ns': (6,), 'a_nm': 0.25, 'm_star_ratio': 1.0, 'bc': 'Periodic'},\n        {'d': 2, 'Ns': (4, 5), 'a_nm': 1.0, 'm_star_ratio': 0.067, 'bc': 'Dirichlet'},\n        {'d': 2, 'Ns': (3, 3), 'a_nm': 0.8, 'm_star_ratio': 0.19, 'bc': 'Periodic'},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        d = case['d']\n        Ns = case['Ns']\n        a = case['a_nm'] * 1e-9  # Convert nm to m\n        m_star = case['m_star_ratio'] * M_E # Convert ratio to kg\n        bc = case['bc']\n        \n        N_tot = np.prod(Ns)\n        L = np.zeros((N_tot, N_tot), dtype=float)\n        \n        # Prefactor for the stencil\n        c = 1.0 / (a * a)\n\n        if d == 1:\n            Nx = Ns[0]\n            if bc == 'Dirichlet':\n                for i in range(Nx):\n                    L[i, i] = -2.0 * c\n                    if i > 0:\n                        L[i, i - 1] = 1.0 * c\n                    if i  Nx - 1:\n                        L[i, i + 1] = 1.0 * c\n            elif bc == 'Periodic':\n                for i in range(Nx):\n                    L[i, i] = -2.0 * c\n                    L[i, (i - 1 + Nx) % Nx] = 1.0 * c\n                    L[i, (i + 1) % Nx] = 1.0 * c\n        \n        elif d == 2:\n            Nx, Ny = Ns\n            if bc == 'Dirichlet':\n                for i in range(Nx):\n                    for j in range(Ny):\n                        k = i * Ny + j\n                        L[k, k] = -4.0 * c\n                        # x-neighbors (rows)\n                        if i > 0: L[k, (i - 1) * Ny + j] = 1.0 * c\n                        if i  Nx - 1: L[k, (i + 1) * Ny + j] = 1.0 * c\n                        # y-neighbors (cols)\n                        if j > 0: L[k, i * Ny + (j - 1)] = 1.0 * c\n                        if j  Ny - 1: L[k, i * Ny + (j + 1)] = 1.0 * c\n            elif bc == 'Periodic':\n                for i in range(Nx):\n                    for j in range(Ny):\n                        k = i * Ny + j\n                        L[k, k] = -4.0 * c\n                        # x-neighbors (rows) with wrap-around\n                        L[k, ((i - 1 + Nx) % Nx) * Ny + j] = 1.0 * c\n                        L[k, ((i + 1) % Nx) * Ny + j] = 1.0 * c\n                        # y-neighbors (cols) with wrap-around\n                        L[k, i * Ny + ((j - 1 + Ny) % Ny)] = 1.0 * c\n                        L[k, i * Ny + ((j + 1) % Ny)] = 1.0 * c\n\n        # Construct kinetic energy operator matrix T\n        T_prefactor = -HBAR**2 / (2.0 * m_star)\n        T = T_prefactor * L\n\n        # 1. Hermiticity defect\n        # For a real matrix T, T_dagger = T_transpose\n        E_H = np.max(np.abs(T - T.T))\n        is_hermitian = E_H = 1e-12\n\n        # 2. Smallest eigenvalue\n        # Use eigh for Hermitian matrices, it's faster and more stable.\n        # It returns only the eigenvalues [0] and eigenvectors [1].\n        eigenvalues = np.linalg.eigh(T)[0]\n        lambda_min = np.min(eigenvalues)\n\n        # 3. Stability time-step bound\n        delta_tau_max = (m_star * a**2) / (d * HBAR)\n\n        # Format results for this case\n        case_results = [\n            is_hermitian,\n            E_H,\n            lambda_min,\n            delta_tau_max\n        ]\n        all_results.append(case_results)\n\n    # Format final output string as per requirements\n    result_str_parts = []\n    for res in all_results:\n        # Python's str(True) is 'True', which matches the required output style\n        part = f\"[{str(res[0])},{res[1]},{res[2]},{res[3]}]\"\n        result_str_parts.append(part)\n    \n    final_output = f\"[{','.join(result_str_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}