{
    "hands_on_practices": [
        {
            "introduction": "Ionized impurity scattering is fundamentally a Coulomb interaction, but this interaction is significantly modified by the sea of mobile charge carriers in the semiconductor. This exercise guides you through the derivation of the Debye screening length, a cornerstone concept in solid-state and plasma physics. By starting from the Poisson equation and linearizing the carrier response, you will develop a first-principles understanding of how carrier density $n$ and temperature $T$ dictate the effective range of an impurity's potential, a critical parameter in the Brooks–Herring scattering model .",
            "id": "3756942",
            "problem": "A doped semiconductor at uniform temperature $T$ contains mobile charge carriers with total equilibrium density $n$ (the sum of equilibrium electron and hole densities). The material is nondegenerate so that the carriers obey Maxwell–Boltzmann statistics, and the electrostatics can be described within the linear response regime. The host lattice provides a spatially uniform dielectric environment characterized by permittivity $\\varepsilon=\\varepsilon_0 \\varepsilon_r$, where $\\varepsilon_0$ is the vacuum permittivity and $\\varepsilon_r$ is the relative dielectric constant.\n\nConsider introducing a weak, static, point-like ion of charge $Z e$ at the origin. Starting from the Poisson equation relating the electrostatic potential $\\phi(\\mathbf{r})$ to the charge density, and the Maxwell–Boltzmann dependence of the local carrier densities on the electrostatic potential, derive the linearized equation governing $\\phi(\\mathbf{r})$ by explicitly obtaining the first-order change in mobile charge density induced by $\\phi(\\mathbf{r})$. From this, identify the screening wavevector $k_D$ in the nondegenerate limit and provide the closed-form analytic expression for $k_D^2$ in terms of $e$, $n$, $\\varepsilon_0$, $\\varepsilon_r$, $k_B$, and $T$.\n\nFinally, briefly interpret how $k_D$ depends on $T$ and $n$ within the context of ionized impurity scattering, focusing on how changes in $T$ and $n$ modify the spatial range of the screened Coulomb potential and thus the qualitative strength of long-range scattering. Express your final result for $k_D^2$ as a single analytic expression. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective, representing a standard derivation in semiconductor physics.\n\nWe begin with the Poisson equation, which relates the electrostatic potential $\\phi(\\mathbf{r})$ to the total charge density $\\rho_{\\text{total}}(\\mathbf{r})$ in a medium with uniform dielectric permittivity $\\varepsilon = \\varepsilon_0 \\varepsilon_r$:\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho_{\\text{total}}(\\mathbf{r})}{\\varepsilon}\n$$\nThe total charge density is the sum of the charge density of the fixed point-like ion, $\\rho_{\\text{ion}}(\\mathbf{r})$, and the induced change in the mobile charge carrier density, $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$. The fixed ion of charge $Z e$ at the origin is represented by a Dirac delta function:\n$$\n\\rho_{\\text{ion}}(\\mathbf{r}) = Z e \\delta(\\mathbf{r})\n$$\nThe mobile charge carriers consist of electrons and holes. In the absence of the perturbing potential $\\phi(\\mathbf{r})$, the semiconductor is electrically neutral with uniform equilibrium densities of electrons, $n_0$, and holes, $p_0$. The problem states that the total equilibrium density of mobile carriers is $n = n_0 + p_0$.\n\nWhen the potential $\\phi(\\mathbf{r})$ is present, the local densities of electrons, $n(\\mathbf{r})$, and holes, $p(\\mathbf{r})$, are modulated. Since the carriers are nondegenerate, their local densities are described by Maxwell–Boltzmann statistics:\n$$\nn(\\mathbf{r}) = n_0 \\exp\\left(\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right)\n$$\n$$\np(\\mathbf{r}) = p_0 \\exp\\left(-\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right)\n$$\nwhere $-e$ is the electron charge, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. The local mobile charge density is therefore:\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) = e(p(\\mathbf{r}) - n(\\mathbf{r})) = e \\left[ p_0 \\exp\\left(-\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) - n_0 \\exp\\left(\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) \\right]\n$$\nThe problem specifies that we are in the linear response regime, which corresponds to a weak potential, i.e., $|e \\phi(\\mathbf{r})| \\ll k_B T$. This justifies a first-order Taylor expansion of the exponential functions, $\\exp(x) \\approx 1 + x$ for small $x$. Applying this linearization yields:\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) \\approx e \\left[ p_0 \\left(1 - \\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) - n_0 \\left(1 + \\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) \\right]\n$$\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) \\approx e(p_0 - n_0) - \\frac{e^2}{k_B T}(p_0 + n_0) \\phi(\\mathbf{r})\n$$\nThe first term, $e(p_0 - n_0)$, represents the background mobile charge density, which is compensated by fixed, ionized dopants to ensure overall charge neutrality of the bulk material. The change in mobile charge density, $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$, is the second term, which is induced by the potential $\\phi(\\mathbf{r})$. This is the explicit first-order change requested:\n$$\n\\delta\\rho_{\\text{mobile}}(\\mathbf{r}) = -\\frac{e^2(p_0 + n_0)}{k_B T} \\phi(\\mathbf{r})\n$$\nUsing the given definition $n = n_0 + p_0$, this becomes:\n$$\n\\delta\\rho_{\\text{mobile}}(\\mathbf{r}) = -\\frac{n e^2}{k_B T} \\phi(\\mathbf{r})\n$$\nThe total charge density to be used in the Poisson equation is $\\rho_{\\text{total}}(\\mathbf{r}) = \\rho_{\\text{ion}}(\\mathbf{r}) + \\delta\\rho_{\\text{mobile}}(\\mathbf{r})$. Substituting this and the expression for $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$ into the Poisson equation, we get:\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\left( Z e \\delta(\\mathbf{r}) - \\frac{n e^2}{k_B T} \\phi(\\mathbf{r}) \\right)\n$$\nRearranging the terms, we obtain the linearized, screened Poisson equation:\n$$\n\\nabla^2 \\phi(\\mathbf{r}) - \\frac{n e^2}{\\varepsilon k_B T} \\phi(\\mathbf{r}) = -\\frac{Z e}{\\varepsilon} \\delta(\\mathbf{r})\n$$\nThis equation is of the general form $\\nabla^2 \\phi - k_D^2 \\phi = -\\rho_{\\text{ext}}/\\varepsilon$. By direct comparison, we can identify the square of the screening wavevector, $k_D^2$, as:\n$$\nk_D^2 = \\frac{n e^2}{\\varepsilon k_B T}\n$$\nSubstituting the expression for the permittivity, $\\varepsilon = \\varepsilon_0 \\varepsilon_r$, we arrive at the final closed-form expression for $k_D^2$:\n$$\nk_D^2 = \\frac{n e^2}{\\varepsilon_0 \\varepsilon_r k_B T}\n$$\nThe quantity $k_D$ is the Debye screening wavevector, and its inverse, $\\lambda_D = 1/k_D$, is the Debye screening length. The solution to the screened Poisson equation is a Yukawa or screened Coulomb potential, $\\phi(r) \\propto (1/r) \\exp(-k_D r)$, which shows that the potential is exponentially suppressed at distances greater than $\\lambda_D$.\n\nThe dependence of $k_D$ on temperature $T$ and total mobile carrier density $n$ has a clear physical interpretation in the context of ionized impurity scattering.\n1.  **Dependence on $n$**: $k_D \\propto \\sqrt{n}$. An increase in the mobile carrier density $n$ leads to an increase in $k_D$ and therefore a decrease in the screening length $\\lambda_D$. With more mobile charges available, the screening of the impurity ion's Coulomb potential is more effective, and its influence is confined to a smaller spatial region. This makes the potential more short-ranged, weakening the effectiveness of long-range scattering.\n2.  **Dependence on $T$**: $k_D \\propto 1/\\sqrt{T}$. An increase in temperature $T$ provides the mobile carriers with greater thermal (kinetic) energy. They are less easily deflected or trapped by the impurity's potential. As a result, the screening cloud of carriers is more diffuse, and the screening is less effective. This corresponds to a decrease in $k_D$ and an increase in the screening length $\\lambda_D$. The potential becomes more long-ranged, which increases the scattering cross-section and thus enhances the strength of long-range ionized impurity scattering.",
            "answer": "$$\n\\boxed{\\frac{n e^2}{\\varepsilon_0 \\varepsilon_r k_B T}}\n$$"
        },
        {
            "introduction": "Theoretical scattering models are most powerfully applied within numerical simulations, such as the Monte Carlo method, which simulate transport by tracking the stochastic motion of individual carriers. This practice focuses on implementing the inverse transform sampling method, a cornerstone of Monte Carlo techniques. You will translate the theoretical differential cross-section for screened Coulomb scattering into a functional algorithm that can randomly generate scattering angles, providing a direct bridge from quantum mechanical theory to practical transport simulation .",
            "id": "3756952",
            "problem": "You are tasked to derive and implement an exact inversion-based sampler for the polar scattering angle in ionized impurity scattering in a Monte Carlo (MC) transport simulation. Consider a charge carrier with wavevector magnitude $k$ undergoing elastic scattering by a screened Coulomb (Yukawa) potential in the first Born approximation. The differential scattering cross section is, up to a constant prefactor, proportional to $(q^2 + q_s^2)^{-2}$, where the momentum transfer is $q = 2 k \\sin(\\theta/2)$ and $q_s$ is the screening wavevector. The azimuthal angle $\\phi$ is uniform on $[0,2\\pi)$ due to cylindrical symmetry, and the polar angle $\\theta \\in [0,\\pi]$ has a nontrivial distribution derived from the cumulative distribution over solid angle with the standard solid-angle measure $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$.\n\nStarting from fundamental definitions and well-tested facts:\n- The probability density for a scattering angle is proportional to the differential cross section times the solid-angle measure.\n- The Cumulative Distribution Function (CDF) $C(\\theta)$ for $\\theta$ is the normalized cumulative integral of this density from $0$ to $\\theta$.\n- Inverse transform sampling requires inverting $u = C(\\theta)$, where $u$ is a uniform deviate on $[0,1]$.\n\nYour tasks are:\n1) Derive the normalized Cumulative Distribution Function $C(\\theta)$ for the polar angle $\\theta$ in terms of $k$ and $q_s$, explicitly performing the integration over $\\phi$ and $\\theta$ using the given dependence $q = 2 k \\sin(\\theta/2)$. Then derive a closed-form inversion formula $\\theta(u;k,q_s)$ that maps a uniform variate $u \\in [0,1]$ to a scattering angle $\\theta \\in [0,\\pi]$.\n2) Design a numerically stable algorithm that implements this inversion formula, carefully handling boundary cases where $u$ is very close to $0$ or $1$. Your algorithm must return $\\theta$ in radians.\n3) Implement a complete program that evaluates $\\theta$ for a small test suite of parameter sets $(k,q_s)$ and specified lists of $u$ values, and prints the results in a single line.\n\nPhysical units:\n- The wavevector magnitude $k$ and the screening wavevector $q_s$ must be provided in $\\text{m}^{-1}$.\n- The scattering angle $\\theta$ must be expressed in radians.\n\nAngle unit:\n- All angles must be in radians.\n\nTest suite:\n- There are $3$ test cases. For each, compute the list of $\\theta$ values corresponding to the given $u$ values. Use exactly the following parameters and inputs:\n  - Case $1$ (moderate screening): $k = 1.0 \\times 10^9 \\ \\text{m}^{-1}$, $q_s = 5.0 \\times 10^8 \\ \\text{m}^{-1}$, and $u$ values $[0.0, 0.25, 0.5, 0.75, 1.0]$.\n  - Case $2$ (weak screening): $k = 1.0 \\times 10^{10} \\ \\text{m}^{-1}$, $q_s = 1.0 \\times 10^8 \\ \\text{m}^{-1}$, and $u$ values $[1.0 \\times 10^{-12}, 1.0 \\times 10^{-6}, 0.1, 0.9, 0.999999999999]$.\n  - Case $3$ (strong screening): $k = 1.0 \\times 10^8 \\ \\text{m}^{-1}$, $q_s = 1.0 \\times 10^{11} \\ \\text{m}^{-1}$, and $u$ values $[0.2, 0.4, 0.6, 0.8]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, enclosed in square brackets, where each inner list corresponds to one test case and contains the $\\theta$ values (in radians) for the specified $u$ values in the given order. For example, the printed line must look like:\n  - $[[\\theta_{1,1},\\theta_{1,2},\\dots],[\\theta_{2,1},\\dots],[\\theta_{3,1},\\dots]]$\n- Each $\\theta$ must be a floating-point number. Do not include units in the printed values.",
            "solution": "The problem requires the derivation and implementation of an exact inversion-based sampler for the polar scattering angle $\\theta$ of a charge carrier undergoing elastic scattering from a screened Coulomb potential. The process begins with validating the problem statement, which is found to be scientifically sound, well-posed, and complete. We can therefore proceed with the derivation and solution.\n\nThe foundation of this problem is the differential scattering cross section, which, for a screened Coulomb potential in the first Born approximation, is proportional to $(q^2 + q_s^2)^{-2}$. The probability $dP$ of a carrier scattering into a solid angle element $d\\Omega$ is proportional to the differential cross section $\\frac{d\\sigma}{d\\Omega}$:\n$$ dP \\propto \\frac{d\\sigma}{d\\Omega} d\\Omega \\propto (q^2 + q_s^2)^{-2} d\\Omega $$\nThe solid angle element in spherical coordinates is $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$, where $\\theta \\in [0, \\pi]$ is the polar angle and $\\phi \\in [0, 2\\pi)$ is the azimuthal angle. The magnitude of the momentum transfer vector for elastic scattering is given by $q = 2 k \\sin(\\theta/2)$, where $k$ is the magnitude of the carrier's wavevector.\n\nSubstituting these expressions, the probability distribution is:\n$$ dP(\\theta, \\phi) \\propto \\left( (2k \\sin(\\theta/2))^2 + q_s^2 \\right)^{-2} \\sin\\theta \\, d\\theta \\, d\\phi $$\nSince the expression does not depend on the azimuthal angle $\\phi$, we can find the probability distribution for $\\theta$ by integrating over $\\phi \\in [0, 2\\pi)$. This integration yields a factor of $2\\pi$, which is a constant and can be absorbed into the proportionality constant. Thus, the probability density function (PDF) for the polar angle $\\theta$, denoted $f(\\theta)$, is given by:\n$$ f(\\theta) \\propto \\left( 4k^2 \\sin^2(\\theta/2) + q_s^2 \\right)^{-2} \\sin\\theta $$\n\nThe next step is to derive the Cumulative Distribution Function (CDF), $C(\\theta)$, which is the normalized integral of the PDF from $0$ to $\\theta$:\n$$ C(\\theta) = \\frac{\\int_0^\\theta f(\\theta') \\, d\\theta'}{\\int_0^\\pi f(\\theta') \\, d\\theta'} = \\frac{\\int_0^\\theta \\left( 4k^2 \\sin^2(\\theta'/2) + q_s^2 \\right)^{-2} \\sin\\theta' \\, d\\theta'}{\\int_0^\\pi \\left( 4k^2 \\sin^2(\\theta'/2) + q_s^2 \\right)^{-2} \\sin\\theta' \\, d\\theta'} $$\nTo evaluate these integrals, we perform a change of variables. Let $v = \\sin^2(\\theta'/2)$. The differential is $dv = \\sin(\\theta'/2)\\cos(\\theta'/2) \\, d\\theta' = \\frac{1}{2}\\sin\\theta' \\, d\\theta'$. Thus, $\\sin\\theta' \\, d\\theta' = 2 \\, dv$. The integration limits for $\\theta'$ from $0$ to $\\theta$ correspond to $v$ from $\\sin^2(0) = 0$ to $\\sin^2(\\theta/2)$.\n\nLet $I(\\theta)$ be the un-normalized cumulative integral in the numerator:\n$$ I(\\theta) = \\int_0^{\\sin^2(\\theta/2)} \\left( 4k^2 v + q_s^2 \\right)^{-2} 2 \\, dv $$\nThis is a standard integral. Let $w = 4k^2 v + q_s^2$, so $dw = 4k^2 dv$.\n$$ I(\\theta) = 2 \\int_{v=0}^{v=\\sin^2(\\theta/2)} w^{-2} \\frac{dw}{4k^2} = \\frac{1}{2k^2} \\left[ -w^{-1} \\right]_{v=0}^{v=\\sin^2(\\theta/2)} $$\n$$ I(\\theta) = \\frac{1}{2k^2} \\left[ -\\frac{1}{4k^2 v + q_s^2} \\right]_0^{\\sin^2(\\theta/2)} = \\frac{1}{2k^2} \\left( -\\frac{1}{4k^2 \\sin^2(\\theta/2) + q_s^2} - (-\\frac{1}{q_s^2}) \\right) $$\n$$ I(\\theta) = \\frac{1}{2k^2} \\left( \\frac{1}{q_s^2} - \\frac{1}{4k^2 \\sin^2(\\theta/2) + q_s^2} \\right) $$\nSimplifying the expression in the parenthesis:\n$$ I(\\theta) = \\frac{1}{2k^2} \\left( \\frac{4k^2 \\sin^2(\\theta/2)}{q_s^2 (4k^2 \\sin^2(\\theta/2) + q_s^2)} \\right) = \\frac{2\\sin^2(\\theta/2)}{q_s^2 (4k^2 \\sin^2(\\theta/2) + q_s^2)} $$\n\nThe normalization constant is the total integral $I(\\pi)$. At $\\theta' = \\pi$, we have $\\sin^2(\\pi/2) = 1$:\n$$ I(\\pi) = \\frac{2(1)}{q_s^2 (4k^2 (1) + q_s^2)} = \\frac{2}{q_s^2(4k^2 + q_s^2)} $$\nThe CDF is the ratio $C(\\theta) = I(\\theta) / I(\\pi)$:\n$$ C(\\theta) = \\frac{\\frac{2\\sin^2(\\theta/2)}{q_s^2 (4k^2 \\sin^2(\\theta/2) + q_s^2)}}{\\frac{2}{q_s^2(4k^2 + q_s^2)}} = \\sin^2(\\theta/2) \\frac{4k^2 + q_s^2}{4k^2 \\sin^2(\\theta/2) + q_s^2} $$\nAs a check, $C(0) = 0$ and $C(\\pi) = 1 \\cdot \\frac{4k^2+q_s^2}{4k^2+q_s^2} = 1$, as required.\n\nThe final step in the derivation is to invert this function for use in inverse transform sampling. We set $u = C(\\theta)$, where $u$ is a random variate from a uniform distribution $U[0,1]$, and solve for $\\theta$. For clarity, let $S = \\sin^2(\\theta/2)$.\n$$ u = S \\frac{4k^2 + q_s^2}{4k^2 S + q_s^2} $$\n$$ u(4k^2 S + q_s^2) = S(4k^2 + q_s^2) $$\n$$ 4k^2 u S + u q_s^2 = 4k^2 S + S q_s^2 $$\n$$ u q_s^2 = S(4k^2 + q_s^2 - 4k^2 u) = S(4k^2(1-u) + q_s^2) $$\n$$ S = \\sin^2(\\theta/2) = \\frac{u q_s^2}{4k^2(1-u) + q_s^2} $$\nTo obtain a more compact and numerically favorable form, we can divide the numerator and denominator by $q_s^2$ and introduce the dimensionless parameter $\\beta = (2k/q_s)^2 = 4k^2/q_s^2$:\n$$ \\sin^2(\\theta/2) = \\frac{u}{(4k^2/q_s^2)(1-u)+1} = \\frac{u}{1+\\beta(1-u)} $$\nSince $\\theta \\in [0, \\pi]$, $\\theta/2 \\in [0, \\pi/2]$, and $\\sin(\\theta/2)$ is non-negative. We can take the square root and then the arcsin:\n$$ \\sin(\\theta/2) = \\sqrt{\\frac{u}{1+\\beta(1-u)}} $$\n$$ \\theta(u; k, q_s) = 2 \\arcsin\\left(\\sqrt{\\frac{u}{1+\\beta(1-u)}}\\right) $$\nThis is the required closed-form inversion formula.\n\nFor the algorithmic design, this formula is numerically stable. For $u \\to 0$, $\\theta \\to 0$, and for $u \\to 1$, $\\theta \\to \\pi$. For $u \\in (0,1)$, the argument of the square root is strictly between $0$ and $1$, ensuring that the $\\arcsin$ function is well-defined. The implementation will use this formula directly. Vectorized operations provided by the `numpy` library will be used to efficiently compute the angles for lists of $u$ values. Special handling for $u=0$ and $u=1$ is implemented for formal correctness, though the formula is robust at these limits.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n\n    def calculate_theta(k, qs, u_values):\n        \"\"\"\n        Calculates the polar scattering angle theta for ionized impurity scattering\n        using the derived inverse CDF formula.\n\n        Args:\n            k (float): The magnitude of the incident wavevector in m^-1.\n            qs (float): The screening wavevector in m^-1.\n            u_values (list): A list of uniform random variates in [0, 1].\n\n        Returns:\n            list: A list of calculated theta values in radians.\n        \"\"\"\n        # Convert input list to a numpy array for vectorized calculations.\n        # Use np.float64 for high precision, important for values close to 0 or 1.\n        u_values = np.array(u_values, dtype=np.float64)\n\n        if qs == 0.0:\n            # The derivation assumes a screened potential (qs > 0). The unscreened case\n            # (Rutherford scattering) has a divergent total cross section.\n            raise ValueError(\"Screening wavevector qs must be positive.\")\n\n        # Calculate the dimensionless parameter beta = (2k/qs)^2.\n        # This form is numerically stable.\n        beta = (2.0 * k / qs)**2\n\n        # The inversion formula is theta = 2 * arcsin(sqrt(u / (1 + beta * (1 - u)))).\n        # We can implement this for all u values at once.\n        # np.ones_like ensures that 1-u is calculated with high precision where u is close to 1.\n        one_minus_u = np.ones_like(u_values) - u_values\n        \n        # Denominator of the argument of the square root\n        denominator = 1.0 + beta * one_minus_u\n        \n        # The argument inside the square root\n        sqrt_arg = u_values / denominator\n\n        # While mathematically sqrt_arg should be in [0, 1], floating point\n        # arithmetic could produce values slightly outside this range.\n        # np.clip ensures the argument for np.sqrt is non-negative.\n        sqrt_arg = np.clip(sqrt_arg, 0.0, 1.0)\n\n        # Calculate theta values\n        theta_values = 2.0 * np.arcsin(np.sqrt(sqrt_arg))\n\n        return theta_values.tolist()\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\"k\": 1.0e9, \"qs\": 5.0e8, \"u\": [0.0, 0.25, 0.5, 0.75, 1.0]},\n        {\"k\": 1.0e10, \"qs\": 1.0e8, \"u\": [1.0e-12, 1.0e-6, 0.1, 0.9, 0.999999999999]},\n        {\"k\": 1.0e8, \"qs\": 1.0e11, \"u\": [0.2, 0.4, 0.6, 0.8]},\n    ]\n    \n    all_results = []\n    for case in test_cases:\n        k_val = case[\"k\"]\n        qs_val = case[\"qs\"]\n        u_vals = case[\"u\"]\n        \n        theta_results = calculate_theta(k_val, qs_val, u_vals)\n        all_results.append(theta_results)\n\n    # Format the final output string according to the specified format:\n    # [[theta_1,1,...],[theta_2,1,...],...]\n    # without extra spaces.\n    inner_lists_str = []\n    for res_list in all_results:\n        # Convert each float in the list to its string representation\n        # and join with commas.\n        inner_str = \",\".join(map(str, res_list))\n        inner_lists_str.append(f\"[{inner_str}]\")\n    \n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The ultimate test of any physical model lies in its ability to accurately describe and predict experimental observations. This comprehensive exercise challenges you to construct a full data-analysis pipeline to interpret mobility measurements by applying and comparing two competing models for ionized impurity scattering: Brooks–Herring and Conwell–Weisskopf. By implementing these models within a framework that includes uncertainty propagation and statistical model selection, you will engage in the essential work of a computational physicist: building models, confronting them with data, and making quantitative judgments about their validity .",
            "id": "3756882",
            "problem": "You are asked to implement a complete, self-contained data-analysis pipeline that fits charge-carrier mobility versus impurity concentration and temperature by incorporating ionized and neutral impurity scattering using two rival ionized-impurity scattering models: the Brooks–Herring (BH) model and the Conwell–Weisskopf (CW) model. The program must account for measurement uncertainties and geometric correction factors. The goal is to select the more plausible ionized-impurity scattering model for each dataset via a quantitative criterion and to estimate the key model parameters with uncertainty-aware fitting.\n\nThe physical scenario is electrons in a three-dimensional semiconductor with a single parabolic conduction band and non-degenerate statistics. Use the following fundamental starting points and well-tested facts as the base for your derivation and implementation; no other assumptions should be introduced unless strictly needed for computational tractability and clearly justified by the preceding fundamentals.\n\n- Boltzmann transport in the relaxation-time approximation with an isotropic, parabolic band of effective mass $m^\\ast$.\n- The definition of mobility $ \\mu $ in terms of the electrical conductivity $ \\sigma $, electron density $ n $, and electron charge $ e $ via $ \\mu = \\sigma / (n e) $.\n- Matthiessen’s rule in energy-resolved form for independent scattering channels, $ \\tau_{\\mathrm{tot}}^{-1}(E) = \\sum_{j} \\tau_{j}^{-1}(E) $, where $ \\tau_j(E) $ is the energy-dependent relaxation time for scattering mechanism $ j $.\n- For non-degenerate carriers, the equilibrium distribution is Maxwell–Boltzmann, and thermal averages use the weight $ \\exp(-E/(k_{\\mathrm{B}} T)) $, where $ k_{\\mathrm{B}} $ is Boltzmann’s constant and $ T $ is absolute temperature.\n- The screened Coulomb potential for ionized impurities modeled as a Yukawa potential with inverse screening length given by the Debye wavevector $ k_{\\mathrm{D}} $, and first Born approximation for scattering, which is the basis of the Brooks–Herring model.\n- The unscreened Coulomb potential with impact-parameter cutoffs (large-distance and small-distance) mapped to scattering-angle cutoffs via the Rutherford relation, which is the basis of the Conwell–Weisskopf model.\n- Neutral impurity scattering treated as short-range collisions of electrons from neutral centers, modeled as energy-dependent relaxation time of the form $ \\tau_{\\mathrm{n}}(E) = 1/(N_{\\mathrm{n}} \\sigma_{0} v(E)) $, where $ N_{\\mathrm{n}} $ is the neutral center density, $ \\sigma_{0} $ is an effective transport cross-section to be fit, and $ v(E) $ is the carrier speed.\n\nYour program must implement the following principle-based construction.\n\n1) Thermal-average mobility from first principles. Start from the conductivity definition in the relaxation-time approximation for an isotropic, parabolic band and derive a thermal-average formula for mobility in terms of an energy integral that depends parametrically on $ T $, $ m^\\ast $, and the energy-dependent total relaxation time $ \\tau_{\\mathrm{tot}}(E) $. The derivation must be based on $ \\sigma = e^{2} \\int v_{x}^{2} \\tau(E) \\left( - \\frac{\\partial f_{0}}{\\partial E} \\right) g(E) \\, dE $, where $ f_{0} $ is the equilibrium distribution and $ g(E) $ is the density of states, and $ v_{x}^{2} = v^{2}/3 $ by isotropy. Use the non-degenerate Maxwell–Boltzmann limit. The final computable form you implement must be an energy integral over $ \\tau_{\\mathrm{tot}}(E) $ with a known closed-form denominator, leading to a single numerical integral per data point.\n\n2) Ionized-impurity scattering, two rival models.\n- Brooks–Herring (BH): Begin from a Yukawa potential $ V(r) = \\frac{Z e^{2}}{4 \\pi \\varepsilon_{\\mathrm{s}} r} e^{-k_{\\mathrm{D}} r} $, with $ Z $ the charge state (use $ Z = 1 $), $ e $ the elementary charge, and $ \\varepsilon_{\\mathrm{s}} $ the static permittivity. In the first Born approximation in three dimensions, the differential cross section depends on the Fourier transform $ V(\\mathbf{q}) $ with momentum transfer $ q = 2 k \\sin(\\theta/2) $, where $ k $ is the electron wavevector at kinetic energy $ E $. Use the transport cross section for screened Coulomb scattering and derive a computable expression $ \\sigma_{\\mathrm{tr}}^{\\mathrm{BH}}(E; N_{\\mathrm{i}}, T) $ in terms of $ k $, $ k_{\\mathrm{D}}(N_{\\mathrm{i}}, T) $, and material constants. Then $ \\tau_{\\mathrm{ii}}^{\\mathrm{BH}}(E) = 1/(N_{\\mathrm{i}} v(E) \\sigma_{\\mathrm{tr}}^{\\mathrm{BH}}(E)) $.\n- Conwell–Weisskopf (CW): Start from Rutherford scattering for an unscreened Coulomb potential with the mapping between impact parameter and scattering angle, $ \\tan(\\theta/2) $ as a function of $ b $ and $ E $. Impose a large-distance cutoff $ b_{\\max} $ equal to the Wigner–Seitz radius of the ionized impurities and a small-distance cutoff $ b_{\\min} $ given by the maximum of the classical distance of closest approach and the reduced de Broglie wavelength. Derive a closed-form expression for the transport cross section $ \\sigma_{\\mathrm{tr}}^{\\mathrm{CW}}(E; N_{\\mathrm{i}}) $ in terms of $ b_{\\min} $, $ b_{\\max} $, and $ E $. Then $ \\tau_{\\mathrm{ii}}^{\\mathrm{CW}}(E) = 1/(N_{\\mathrm{i}} v(E) \\sigma_{\\mathrm{tr}}^{\\mathrm{CW}}(E)) $.\n\n3) Neutral impurity scattering. Use $ \\tau_{\\mathrm{n}}(E) = 1/(N_{\\mathrm{n}} \\sigma_{0} v(E)) $ where $ \\sigma_{0} $ is a constant effective transport cross-section to be estimated from data. For simplicity and identifiability, take $ N_{\\mathrm{n}} = N_{\\mathrm{d}} $, where $ N_{\\mathrm{d}} $ is the total impurity (dopant) density.\n\n4) Ionization fraction. Let the ionized impurity density be $ N_{\\mathrm{i}} = \\alpha N_{\\mathrm{d}} $ with $ \\alpha \\in (0, 1] $ to be estimated from data for each dataset. Set $ Z = 1 $. Other material constants must be treated as known.\n\n5) Matthiessen combination in energy space. Combine ionized and neutral scattering as $ \\tau_{\\mathrm{tot}}^{-1}(E) = \\tau_{\\mathrm{ii}}^{-1}(E) + \\tau_{\\mathrm{n}}^{-1}(E) $.\n\n6) Geometry correction and uncertainty propagation. For each measurement, you are given a measured apparent mobility $ \\mu_{\\mathrm{app}} $ and a geometric correction factor $ g $ with uncertainties $ \\sigma_{\\mu} $ and $ \\sigma_{g} $. The true mobility is $ \\mu_{\\mathrm{true}} = g \\, \\mu_{\\mathrm{app}} $. Treat $ \\mu_{\\mathrm{app}} $ and $ g $ as independent measurements with standard deviations $ \\sigma_{\\mu} $ and $ \\sigma_{g} $, and propagate uncertainty by first-order error propagation for a product, so that the standard deviation of $ \\mu_{\\mathrm{true}} $ is\n$$\n\\sigma_{\\mathrm{true}} = \\sqrt{ (g \\, \\sigma_{\\mu})^{2} + (\\mu_{\\mathrm{app}} \\, \\sigma_{g})^{2} }.\n$$\nAll mobilities inside the fitting engine must be handled in the same system of units.\n\n7) Weighted nonlinear least squares and model selection. For each dataset and for each model (BH and CW), estimate $ \\alpha $ and $ \\sigma_{0} $ by minimizing the weighted residuals\n$$\nr_{i} = \\frac{ \\mu_{\\mathrm{model}}(N_{\\mathrm{d},i}, T_{i} ; \\alpha, \\sigma_{0}) - \\mu_{\\mathrm{true}, i}}{ \\sigma_{\\mathrm{true}, i} }.\n$$\nUse an information criterion to select the model: compute the Akaike Information Criterion (AIC) for each fit as\n$$\n\\mathrm{AIC} = 2 k + n \\ln\\!\\left( \\frac{1}{n} \\sum_{i=1}^{n} r_{i}^{2} \\right),\n$$\nwhere $ k = 2 $ is the number of fitted parameters and $ n $ is the number of data points in the dataset. Choose the model with the lower AIC.\n\n8) Material constants and units. Use the following material constants for silicon:\n- $ m^\\ast = 0.26 \\, m_{0} $, where $ m_{0} $ is the free-electron mass.\n- $ \\varepsilon_{\\mathrm{s}} = 11.7 \\, \\varepsilon_{0} $, where $ \\varepsilon_{0} $ is the vacuum permittivity.\n- $ Z = 1 $.\n- Use $ e $, $ \\hbar $, and $ k_{\\mathrm{B}} $ at their conventional values.\nBe explicit about unit conversions. The input impurity densities below are given in $ \\mathrm{cm^{-3}} $ and measured mobilities are given in $ \\mathrm{cm^{2}/(V \\cdot s)} $. Convert to the International System of Units (SI) inside the program for all physical computations. Express the fitted neutral cross section $ \\sigma_{0} $ in $ \\mathrm{m^{2}} $ and the ionization fraction $ \\alpha $ as a dimensionless number.\n\n9) Test suite. Fit the following three datasets. In each dataset, the data consist of tuples $ (N_{\\mathrm{d}}, T, \\mu_{\\mathrm{app}}, \\sigma_{\\mu}, g, \\sigma_{g}) $ with $ N_{\\mathrm{d}} $ in $ \\mathrm{cm^{-3}} $, $ T $ in $ \\mathrm{K} $, $ \\mu_{\\mathrm{app}} $ and $ \\sigma_{\\mu} $ in $ \\mathrm{cm^{2}/(V \\cdot s)} $, and $ g $ and $ \\sigma_{g} $ dimensionless.\n- Dataset $ \\#1 $ (moderate doping, BH-friendly regime):\n  - $ (1.0 \\times 10^{15}, 200, 1080.0, 30.0, 1.02, 0.01) $\n  - $ (1.0 \\times 10^{15}, 300, 1300.0, 30.0, 0.99, 0.01) $\n  - $ (3.0 \\times 10^{15}, 300, 900.0, 25.0, 1.00, 0.01) $\n  - $ (1.0 \\times 10^{16}, 300, 500.0, 20.0, 1.01, 0.01) $\n  - $ (1.0 \\times 10^{16}, 400, 600.0, 20.0, 0.98, 0.01) $\n- Dataset $ \\#2 $ (higher doping, CW-friendly regime):\n  - $ (3.0 \\times 10^{16}, 300, 300.0, 10.0, 1.01, 0.01) $\n  - $ (5.0 \\times 10^{16}, 200, 220.0, 10.0, 1.00, 0.01) $\n  - $ (5.0 \\times 10^{16}, 300, 240.0, 10.0, 0.99, 0.01) $\n  - $ (1.0 \\times 10^{17}, 300, 180.0, 10.0, 1.02, 0.01) $\n  - $ (1.0 \\times 10^{17}, 400, 200.0, 10.0, 0.98, 0.01) $\n- Dataset $ \\#3 $ (edge cases with larger geometry uncertainty):\n  - $ (1.0 \\times 10^{15}, 300, 1200.0, 50.0, 0.95, 0.05) $\n  - $ (1.0 \\times 10^{17}, 300, 150.0, 20.0, 1.05, 0.05) $\n  - $ (1.0 \\times 10^{16}, 250, 400.0, 30.0, 1.00, 0.02) $\n  - $ (1.0 \\times 10^{16}, 350, 450.0, 30.0, 1.00, 0.02) $\n\n10) Output. For each dataset in the given order, output the selected model identifier and fitted parameters as a flat list in the pattern $ [M_{1}, \\alpha_{1}, \\sigma_{0,1}, M_{2}, \\alpha_{2}, \\sigma_{0,2}, M_{3}, \\alpha_{3}, \\sigma_{0,3}] $, where $ M_{j} = 0 $ denotes Brooks–Herring and $ M_{j} = 1 $ denotes Conwell–Weisskopf. Express $ \\alpha_{j} $ as a decimal rounded to three significant figures, and express $ \\sigma_{0,j} $ in $ \\mathrm{m^{2}} $ rounded to three significant figures. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $ [0,0.912,3.21 \\times 10^{-20},\\dots] $.\n\nAngle units: All scattering angles in any intermediate derivation must be in radians.\n\nNote: All physical computations must be performed in SI units. Ensure that $ N_{\\mathrm{d}} $ given in $ \\mathrm{cm^{-3}} $ is converted to $ \\mathrm{m^{-3}} $ and that $ \\mu $ given in $ \\mathrm{cm^{2}/(V \\cdot s)} $ is converted to $ \\mathrm{m^{2}/(V \\cdot s)} $ via the factor $ 10^{-4} $.",
            "solution": "The user's request is to develop a data-analysis pipeline to fit charge-carrier mobility data in silicon against impurity concentration and temperature. The pipeline must implement and compare two rival models for ionized impurity scattering—Brooks–Herring (BH) and Conwell–Weisskopf (CW)—along with a model for neutral impurity scattering. The analysis involves propagating experimental uncertainties, performing weighted nonlinear least-squares fitting of model parameters, and using the Akaike Information Criterion (AIC) for model selection.\n\nThe problem is determined to be **valid**. It is scientifically well-grounded in standard semiconductor transport theory, provides a complete and self-contained set of instructions, models, and data, and poses a non-trivial but feasible computational physics problem. The specified modeling assumptions, such as taking the neutral impurity density $N_{\\mathrm{n}}$ to be the total dopant density $N_{\\mathrm{d}}$, are treated as explicit directives for the model's implementation, rather than as flaws in the problem statement.\n\nThe solution is constructed following a principled, step-by-step derivation and implementation plan.\n\n### 1. Thermal-Averaged Mobility\n\nThe mobility $\\mu$ is derived from the electrical conductivity $\\sigma$ under the relaxation-time approximation for a non-degenerate electron gas in an isotropic, parabolic band. The starting point is the Boltzmann transport equation result for conductivity:\n$$\n\\sigma = e^{2} \\int_{0}^{\\infty} v_{x}^{2} \\tau(E) \\left( - \\frac{\\partial f_{0}}{\\partial E} \\right) g(E) \\, dE\n$$\nwhere $e$ is the elementary charge, $\\tau(E)$ is the energy-dependent total relaxation time, $f_0(E)$ is the Maxwell-Boltzmann distribution, and $g(E)$ is the 3D density of states. For an isotropic system, the average squared velocity component is $v_x^2 = v(E)^2/3$. Using the relations $E = m^\\ast v^2/2$, $g(E) \\propto \\sqrt{E}$, and $-\\partial f_0/\\partial E = f_0/(k_B T)$, and the definition $\\mu = \\sigma/(ne)$, we arrive at the expression for the thermally averaged mobility:\n$$\n\\mu = \\frac{\\langle E \\tau(E) \\rangle}{\\langle E \\rangle} \\frac{2e}{3m^\\ast}\n$$\nwhere the thermal average of a quantity $A(E)$ is given by $\\langle A(E) \\rangle = \\int A(E) E^{1/2} e^{-E/k_B T} dE / \\int E^{1/2} e^{-E/k_B T} dE$. The average energy for a 3D non-degenerate gas is $\\langle E \\rangle = \\frac{3}{2} k_B T$. This leads to the well-known formula for drift mobility:\n$$\n\\mu = \\frac{e}{m^\\ast} \\langle \\tau \\rangle\n$$\nwhere $\\langle \\tau \\rangle$ is the thermally averaged relaxation time given by:\n$$\n\\langle \\tau \\rangle = \\frac{\\int_0^\\infty \\tau(E) E^{3/2} e^{-E/k_B T} dE}{\\int_0^\\infty E^{3/2} e^{-E/k_B T} dE} = \\frac{2}{3(k_B T)^{5/2}\\Gamma(5/2)} \\int_0^\\infty \\tau(E) E^{3/2} e^{-E/k_B T} dE\n$$\nA more direct derivation, without first evaluating $\\langle E \\rangle$, leads to the computationally convenient form. By substituting the expressions for $v_x^2$, $g(E)$, and $f_0(E)$ and normalizing, we obtain:\n$$\n\\mu = \\frac{2e}{3m^\\ast k_B T} \\frac{\\int_{0}^{\\infty} E \\tau(E) E^{1/2} e^{-E/k_B T} dE}{\\int_{0}^{\\infty} E^{1/2} e^{-E/k_B T} dE}\n$$\nThe denominator is $\\Gamma(3/2)(k_B T)^{3/2} = (\\sqrt{\\pi}/2)(k_B T)^{3/2}$. Making the substitution $x = E/(k_B T)$ yields the final formula for numerical implementation:\n$$\n\\mu = \\frac{4e}{3m^\\ast\\sqrt{\\pi}} \\int_0^\\infty x^{3/2} \\tau_{\\mathrm{tot}}(x k_B T) e^{-x} dx\n$$\nwhere $x$ is the dimensionless energy and $\\tau_{\\mathrm{tot}}$ is the total energy-dependent relaxation time.\n\n### 2. Scattering Mechanisms and Relaxation Times\n\nThe total relaxation time $\\tau_{\\mathrm{tot}}(E)$ is calculated using Matthiessen's rule, which adds the scattering rates from independent mechanisms:\n$$\n\\tau_{\\mathrm{tot}}^{-1}(E) = \\tau_{\\mathrm{ii}}^{-1}(E) + \\tau_{\\mathrm{n}}^{-1}(E)\n$$\nwhere $\\tau_{\\mathrm{ii}}$ is the relaxation time for ionized impurity scattering and $\\tau_{\\mathrm{n}}$ is for neutral impurity scattering. The model parameters to be fitted are the ionization fraction $\\alpha$ and the neutral impurity effective cross-section $\\sigma_0$. The ionized and neutral impurity densities are given by $N_{\\mathrm{i}} = \\alpha N_{\\mathrm{d}}$ and $N_{\\mathrm{n}} = N_{\\mathrm{d}}$, respectively, where $N_{\\mathrm{d}}$ is the total dopant concentration.\n\n#### 2.1. Brooks-Herring (BH) Model\nThis model treats scattering from a screened Coulomb (Yukawa) potential within the first Born approximation. The energy-dependent relaxation time is:\n$$\n\\tau_{\\mathrm{ii}}^{\\mathrm{BH}}(E) = \\frac{16 \\sqrt{2} \\pi \\varepsilon_{\\mathrm{s}}^2 \\sqrt{m^\\ast} E^{3/2}}{N_{\\mathrm{i}} Z^2 e^4 \\left[ \\ln(1+\\gamma) - \\frac{\\gamma}{1+\\gamma} \\right]}\n$$\nwith the screening parameter $\\gamma$ given by:\n$$\n\\gamma(E, T) = \\frac{8 m^\\ast E}{\\hbar^2 k_{\\mathrm{D}}^2}, \\quad \\text{where} \\quad k_{\\mathrm{D}}^2 = \\frac{N_{\\mathrm{i}} e^2}{\\varepsilon_{\\mathrm{s}} k_{\\mathrm{B}} T}\n$$\nHere, $\\varepsilon_{\\mathrm{s}}$ is the static permittivity, $m^\\ast$ is the effective mass, and $Z=1$ is the impurity charge state.\n\n#### 2.2. Conwell-Weisskopf (CW) Model\nThis model is based on Rutherford scattering from an unscreened Coulomb potential, with a cutoff on the impact parameter corresponding to half the average distance between impurities ($b_{\\max} = (2 N_{\\mathrm{i}}^{1/3})^{-1}$). The relaxation time is:\n$$\n\\tau_{\\mathrm{ii}}^{\\mathrm{CW}}(E) = \\frac{16 \\sqrt{2} \\pi \\varepsilon_{\\mathrm{s}}^2 \\sqrt{m^\\ast} E^{3/2}}{N_{\\mathrm{i}} Z^2 e^4 \\ln\\left(1+\\beta_{\\mathrm{CW}}^2\\right)}\n$$\nwith the parameter $\\beta_{\\mathrm{CW}}$ given by:\n$$\n\\beta_{\\mathrm{CW}}(E) = \\frac{4\\pi \\varepsilon_{\\mathrm{s}} E}{N_{\\mathrm{i}}^{1/3} Z e^2}\n$$\n\n#### 2.3. Neutral Impurity Scattering\nScattering from neutral impurities is modeled as short-range collisions. The relaxation time is inversely proportional to the carrier velocity $v(E) = \\sqrt{2E/m^\\ast}$:\n$$\n\\tau_{\\mathrm{n}}(E) = \\frac{1}{N_{\\mathrm{n}} \\sigma_{0} v(E)} = \\frac{\\sqrt{m^\\ast}}{N_{\\mathrm{d}} \\sigma_{0} \\sqrt{2E}}\n$$\nwhere $\\sigma_0$ is the constant effective transport cross-section, a fit parameter. As per the problem statement, the neutral impurity density $N_{\\mathrm{n}}$ is taken to be the total dopant density $N_{\\mathrm{d}}$.\n\n### 3. Computational Strategy and Fitting\n\nThe data analysis pipeline is implemented as follows:\n1.  **Data Preprocessing**: For each data point $(N_{\\mathrm{d}}, T, \\mu_{\\mathrm{app}}, \\sigma_{\\mu}, g, \\sigma_{g})$, all quantities are converted to SI units. The true mobility $\\mu_{\\mathrm{true}} = g \\mu_{\\mathrm{app}}$ and its uncertainty $\\sigma_{\\mathrm{true}} = \\sqrt{(g \\sigma_{\\mu})^2 + (\\mu_{\\mathrm{app}} \\sigma_{g})^2}$ are calculated using first-order error propagation.\n\n2.  **Model Mobility Calculation**: A function is implemented to compute the model mobility $\\mu_{\\mathrm{model}}(N_{\\mathrm{d}}, T; \\alpha, \\sigma_0)$ for a given set of parameters. This function constructs the appropriate $\\tau_{\\mathrm{tot}}(E)$ and evaluates the mobility integral numerically using `scipy.integrate.quad`.\n\n3.  **Weighted Least-Squares Fitting**: For each dataset and each model (BH and CW), the optimal parameters $(\\alpha, \\sigma_0)$ are found by minimizing the sum of squared weighted residuals, $\\chi^2$:\n    $$\n    \\chi^2(\\alpha, \\sigma_0) = \\sum_{i=1}^{n} \\left( \\frac{\\mu_{\\mathrm{model}}(N_{\\mathrm{d},i}, T_{i}; \\alpha, \\sigma_{0}) - \\mu_{\\mathrm{true},i}}{\\sigma_{\\mathrm{true},i}} \\right)^2\n    $$\n    The minimization is performed using `scipy.optimize.minimize` with bounds $0 < \\alpha \\le 1$ and $\\sigma_0 > 0$.\n\n4.  **Model Selection**: The Akaike Information Criterion (AIC) is used to select the more plausible model. For a model with $k=2$ parameters and $n$ data points, the AIC is calculated as:\n    $$\n    \\mathrm{AIC} = 2k + n \\ln\\left(\\frac{\\chi^2_{\\min}}{n}\\right)\n    $$\n    The model (BH or CW) with the lower AIC value is selected for each dataset.\n\n5.  **Output Generation**: The final results for each dataset—the selected model identifier ($0$ for BH, $1$ for CW), the fitted ionization fraction $\\alpha$, and the neutral scattering cross-section $\\sigma_0$—are formatted to three significant figures and presented in a single list as specified. Physical constants from `scipy.constants` are used, and all calculations are performed in SI units.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import e, m_e, hbar, k, epsilon_0\nfrom scipy.integrate import quad\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main function to run the entire data-analysis pipeline for fitting mobility data.\n    \"\"\"\n\n    # --- Container for Physical Constants (SI Units) ---\n    class SiConstants:\n        def __init__(self):\n            self.m_star = 0.26 * m_e  # Effective mass\n            self.eps_s = 11.7 * epsilon_0  # Static permittivity\n            self.Z = 1.0  # Impurity charge state\n            self.e = e\n            self.hbar = hbar\n            self.k_B = k\n\n    C = SiConstants()\n\n    # --- Test Datasets ---\n    # Format: (Nd [cm^-3], T [K], mu_app [cm^2/V.s], sigma_mu [cm^2/V.s], g, sigma_g)\n    datasets = [\n        # Dataset #1\n        [\n            (1.0e15, 200, 1080.0, 30.0, 1.02, 0.01),\n            (1.0e15, 300, 1300.0, 30.0, 0.99, 0.01),\n            (3.0e15, 300, 900.0, 25.0, 1.00, 0.01),\n            (1.0e16, 300, 500.0, 20.0, 1.01, 0.01),\n            (1.0e16, 400, 600.0, 20.0, 0.98, 0.01),\n        ],\n        # Dataset #2\n        [\n            (3.0e16, 300, 300.0, 10.0, 1.01, 0.01),\n            (5.0e16, 200, 220.0, 10.0, 1.00, 0.01),\n            (5.0e16, 300, 240.0, 10.0, 0.99, 0.01),\n            (1.0e17, 300, 180.0, 10.0, 1.02, 0.01),\n            (1.0e17, 400, 200.0, 10.0, 0.98, 0.01),\n        ],\n        # Dataset #3\n        [\n            (1.0e15, 300, 1200.0, 50.0, 0.95, 0.05),\n            (1.0e17, 300, 150.0, 20.0, 1.05, 0.05),\n            (1.0e16, 250, 400.0, 30.0, 1.00, 0.02),\n            (1.0e16, 350, 450.0, 30.0, 1.00, 0.02),\n        ],\n    ]\n\n    def tau_bh(E, Ni, T, C):\n        \"\"\"Brooks-Herring relaxation time.\"\"\"\n        if E <= 0 or Ni <= 0: return np.inf\n        k_D_sq = (Ni * C.e**2) / (C.eps_s * C.k_B * T)\n        gamma = (8 * C.m_star * E) / (C.hbar**2 * k_D_sq)\n        log_term = np.log(1 + gamma) - gamma / (1 + gamma)\n        if log_term <= 0: return np.inf\n        \n        num = 16 * np.sqrt(2) * np.pi * C.eps_s**2 * np.sqrt(C.m_star) * E**1.5\n        den = Ni * C.Z**2 * C.e**4 * log_term\n        return num / den\n\n    def tau_cw(E, Ni, C):\n        \"\"\"Conwell-Weisskopf relaxation time.\"\"\"\n        if E <= 0 or Ni <= 0: return np.inf\n        beta_cw = (4 * np.pi * C.eps_s * E) / (Ni**(1/3) * C.Z * C.e**2)\n        log_term = np.log(1 + beta_cw**2)\n        if log_term <= 0: return np.inf\n\n        num = 16 * np.sqrt(2) * np.pi * C.eps_s**2 * np.sqrt(C.m_star) * E**1.5\n        den = Ni * C.Z**2 * C.e**4 * log_term\n        return num / den\n\n    def tau_neutral(E, Nd, sigma0, C):\n        \"\"\"Neutral impurity scattering relaxation time.\"\"\"\n        if E <= 0 or sigma0 <= 0: return np.inf\n        v = np.sqrt(2 * E / C.m_star)\n        return 1 / (Nd * sigma0 * v)\n\n    def calculate_model_mobility(T, Nd, alpha, sigma0, model, C):\n        \"\"\"Calculates model mobility via numerical integration.\"\"\"\n        Ni = alpha * Nd\n\n        def integrand(x):\n            E = x * C.k_B * T\n            if E <= 0: return 0.0\n            \n            if model == 'BH':\n                tau_ii_val = tau_bh(E, Ni, T, C)\n            else:  # CW\n                tau_ii_val = tau_cw(E, Ni, C)\n            \n            tau_n_val = tau_neutral(E, Nd, sigma0, C)\n            \n            tau_tot_inv = 1 / tau_ii_val + 1 / tau_n_val\n            tau_tot = 1 / tau_tot_inv if tau_tot_inv > 0 else np.inf\n            \n            return x**1.5 * tau_tot * np.exp(-x)\n\n        integral_val, _ = quad(integrand, 0, np.inf)\n        \n        prefactor = (4 * C.e) / (3 * C.m_star * np.sqrt(np.pi))\n        return prefactor * integral_val\n\n    def objective_function(params, data, model, C):\n        \"\"\"Computes chi-squared for a given set of parameters.\"\"\"\n        alpha, sigma0 = params\n        \n        # Parameter validation inside objective\n        if not (0 < alpha <= 1 and sigma0 > 0):\n            return np.inf\n\n        chi2 = 0.0\n        for (Nd_si, T, mu_true_si, sigma_true_si) in data:\n            mu_model = calculate_model_mobility(T, Nd_si, alpha, sigma0, model, C)\n            if not np.isfinite(mu_model) or mu_model <= 0:\n                return np.inf # Penalize non-physical results\n            \n            residual = (mu_model - mu_true_si) / sigma_true_si\n            chi2 += residual**2\n\n        return chi2\n\n    # --- Main Analysis Loop ---\n    final_results = []\n    for dataset in datasets:\n        # 1. Pre-process data: unit conversion and uncertainty propagation\n        processed_data = []\n        for dp in dataset:\n            Nd, T, mu_app, sigma_mu, g, sigma_g = dp\n            \n            Nd_si = Nd * 1e6  # cm^-3 to m^-3\n            mu_app_si = mu_app * 1e-4  # cm^2/Vs to m^2/Vs\n            sigma_mu_si = sigma_mu * 1e-4\n\n            mu_true_si = g * mu_app_si\n            sigma_true_si = np.sqrt((g * sigma_mu_si)**2 + (mu_app_si * sigma_g)**2)\n            processed_data.append((Nd_si, T, mu_true_si, sigma_true_si))\n        \n        n_points = len(processed_data)\n        k_params = 2\n        \n        param_bounds = ((1e-9, 1.0), (1e-30, 1e-15))\n        initial_guess = [0.9, 1e-20]\n\n        # 2. Fit BH model\n        res_bh = minimize(objective_function, initial_guess, args=(processed_data, 'BH', C),\n                          method='L-BFGS-B', bounds=param_bounds)\n        chi2_bh = res_bh.fun\n        alpha_bh, sigma0_bh = res_bh.x\n        aic_bh = 2 * k_params + n_points * np.log(chi2_bh / n_points) if chi2_bh > 0 else np.inf\n\n        # 3. Fit CW model\n        res_cw = minimize(objective_function, initial_guess, args=(processed_data, 'CW', C),\n                          method='L-BFGS-B', bounds=param_bounds)\n        chi2_cw = res_cw.fun\n        alpha_cw, sigma0_cw = res_cw.x\n        aic_cw = 2 * k_params + n_points * np.log(chi2_cw / n_points) if chi2_cw > 0 else np.inf\n        \n        # 4. Model Selection and Result Formatting\n        if aic_bh <= aic_cw:\n            model_id = 0\n            best_alpha = alpha_bh\n            best_sigma0 = sigma0_bh\n        else:\n            model_id = 1\n            best_alpha = alpha_cw\n            best_sigma0 = sigma0_cw\n            \n        final_results.extend([\n            model_id,\n            f\"{best_alpha:.3g}\",\n            f\"{best_sigma0:.3g}\" \n        ])\n\n    # 5. Final Output\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\nsolve()\n```"
        }
    ]
}