{
    "hands_on_practices": [
        {
            "introduction": "载流子与电离杂质之间的相互作用并非简单的裸库仑吸引或排斥。本练习旨在深入探讨静电屏蔽这一关键概念，即半导体中的移动载流子会重新分布，从而削弱杂质的电势。通过从第一性原理出发推导德拜屏蔽波矢，您将对载流子浓度和温度如何决定杂质影响的有效范围建立基本理解，而这正是布鲁克斯-赫林（Brooks-Herring）散射模型的核心要素。",
            "id": "3756942",
            "problem": "一个在均匀温度 $T$ 下的掺杂半导体包含可动载流子，其总平衡密度为 $n$（电子和空穴的平衡密度之和）。该材料是非简并的，因此载流子服从麦克斯韦-玻尔兹曼统计，并且可以在线性响应区内描述其静电学特性。主晶格提供了一个空间均匀的介电环境，其介电常数为 $\\varepsilon=\\varepsilon_0 \\varepsilon_r$，其中 $\\varepsilon_0$ 是真空介电常数，$\\varepsilon_r$ 是相对介电常数。\n\n考虑在原点引入一个电荷为 $Z e$ 的弱静态点状离子。从关联静电势 $\\phi(\\mathbf{r})$ 与电荷密度的泊松方程出发，并利用局域载流子密度对静电势的麦克斯韦-玻尔兹曼依赖关系，通过显式求出由 $\\phi(\\mathbf{r})$ 引起的可动电荷密度的一阶变化，来推导控制 $\\phi(\\mathbf{r})$ 的线性化方程。由此，确定非简并极限下的屏蔽波矢 $k_D$，并给出 $k_D^2$ 关于 $e$、$n$、$\\varepsilon_0$、$\\varepsilon_r$、$k_B$ 和 $T$ 的闭合形式解析表达式。\n\n最后，在电离杂质散射的背景下，简要解释 $k_D$ 如何依赖于 $T$ 和 $n$，重点关注 $T$ 和 $n$ 的变化如何改变屏蔽库仑势的空间范围，从而定性地影响长程散射的强度。将 $k_D^2$ 的最终结果表示为单个解析表达式。无需进行数值计算。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观，代表了半导体物理学中的一个标准推导。\n\n我们从泊松方程开始，它将静电势 $\\phi(\\mathbf{r})$ 与具有均匀介电常数 $\\varepsilon = \\varepsilon_0 \\varepsilon_r$ 的介质中的总电荷密度 $\\rho_{\\text{total}}(\\mathbf{r})$ 联系起来：\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho_{\\text{total}}(\\mathbf{r})}{\\varepsilon}\n$$\n总电荷密度是固定点状离子的电荷密度 $\\rho_{\\text{ion}}(\\mathbf{r})$ 与感应出的可动载流子密度的变化 $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$ 之和。位于原点的电荷为 $Z e$ 的固定离子由狄拉克δ函数表示：\n$$\n\\rho_{\\text{ion}}(\\mathbf{r}) = Z e \\delta(\\mathbf{r})\n$$\n可动载流子由电子和空穴组成。在没有微扰势 $\\phi(\\mathbf{r})$ 的情况下，半导体是电中性的，具有均匀的电子平衡密度 $n_0$ 和空穴平衡密度 $p_0$。问题指出，可动载流子的总平衡密度为 $n = n_0 + p_0$。\n\n当存在电势 $\\phi(\\mathbf{r})$ 时，电子的局域密度 $n(\\mathbf{r})$ 和空穴的局域密度 $p(\\mathbf{r})$ 会被调制。由于载流子是非简并的，它们的局域密度由麦克斯韦-玻尔兹曼统计描述：\n$$\nn(\\mathbf{r}) = n_0 \\exp\\left(\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right)\n$$\n$$\np(\\mathbf{r}) = p_0 \\exp\\left(-\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right)\n$$\n其中 $-e$ 是电子电荷，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。因此，局域可动电荷密度为：\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) = e(p(\\mathbf{r}) - n(\\mathbf{r})) = e \\left[ p_0 \\exp\\left(-\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) - n_0 \\exp\\left(\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) \\right]\n$$\n问题指明我们处于线性响应区，这对应于弱电势，即 $|e \\phi(\\mathbf{r})| \\ll k_B T$。这为对指数函数进行一阶泰勒展开提供了依据，即当 $x$ 很小时，$\\exp(x) \\approx 1 + x$。应用此线性化可得：\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) \\approx e \\left[ p_0 \\left(1 - \\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) - n_0 \\left(1 + \\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) \\right]\n$$\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) \\approx e(p_0 - n_0) - \\frac{e^2}{k_B T}(p_0 + n_0) \\phi(\\mathbf{r})\n$$\n第一项 $e(p_0 - n_0)$ 代表背景可动电荷密度，它被固定的电离掺杂剂所补偿，以确保块状材料的整体电中性。可动电荷密度的变化 $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$ 是第二项，它是由电势 $\\phi(\\mathbf{r})$ 感应产生的。这就是所要求的显式一阶变化：\n$$\n\\delta\\rho_{\\text{mobile}}(\\mathbf{r}) = -\\frac{e^2(p_0 + n_0)}{k_B T} \\phi(\\mathbf{r})\n$$\n使用给定的定义 $n = n_0 + p_0$，这变为：\n$$\n\\delta\\rho_{\\text{mobile}}(\\mathbf{r}) = -\\frac{n e^2}{k_B T} \\phi(\\mathbf{r})\n$$\n在泊松方程中使用的总电荷密度为 $\\rho_{\\text{total}}(\\mathbf{r}) = \\rho_{\\text{ion}}(\\mathbf{r}) + \\delta\\rho_{\\text{mobile}}(\\mathbf{r})$。将此式以及 $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$ 的表达式代入泊松方程，我们得到：\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\left( Z e \\delta(\\mathbf{r}) - \\frac{n e^2}{k_B T} \\phi(\\mathbf{r}) \\right)\n$$\n整理各项，我们得到线性化的屏蔽泊松方程：\n$$\n\\nabla^2 \\phi(\\mathbf{r}) - \\frac{n e^2}{\\varepsilon k_B T} \\phi(\\mathbf{r}) = -\\frac{Z e}{\\varepsilon} \\delta(\\mathbf{r})\n$$\n该方程具有一般形式 $\\nabla^2 \\phi - k_D^2 \\phi = -\\rho_{\\text{ext}}/\\varepsilon$。通过直接比较，我们可以确定屏蔽波矢的平方 $k_D^2$ 为：\n$$\nk_D^2 = \\frac{n e^2}{\\varepsilon k_B T}\n$$\n代入介电常数的表达式 $\\varepsilon = \\varepsilon_0 \\varepsilon_r$，我们得到 $k_D^2$ 的最终闭合形式表达式：\n$$\nk_D^2 = \\frac{n e^2}{\\varepsilon_0 \\varepsilon_r k_B T}\n$$\n量 $k_D$ 是德拜屏蔽波矢，其倒数 $\\lambda_D = 1/k_D$ 是德拜屏蔽长度。屏蔽泊松方程的解是汤川势或屏蔽库仑势，$\\phi(r) \\propto (1/r) \\exp(-k_D r)$，这表明电势在距离大于 $\\lambda_D$ 时呈指数衰减。\n\n$k_D$ 对温度 $T$ 和总可动载流子密度 $n$ 的依赖关系在电离杂质散射的背景下有明确的物理解释。\n1.  **对 $n$ 的依赖性**：$k_D \\propto \\sqrt{n}$。可动载流子密度 $n$ 的增加导致 $k_D$ 增加，从而使屏蔽长度 $\\lambda_D$ 减小。当有更多的可动电荷可用时，对杂质离子的库仑势的屏蔽就更有效，其影响被限制在一个更小的空间区域内。这使得电势的程更短，削弱了长程散射的有效性。\n2.  **对 $T$ 的依赖性**：$k_D \\propto 1/\\sqrt{T}$。温度 $T$ 的升高为可动载流子提供了更大的热能（动能）。它们更不容易被杂质的电势偏转或俘获。结果，载流子形成的屏蔽云更加弥散，屏蔽效果较差。这对应于 $k_D$ 的减小和屏蔽长度 $\\lambda_D$ 的增加。虽然电势的作用范围变得更长，但散射的强度最终取决于载流子动能与势能的相对大小。在更高温度下，载流子的平均动能 ($ \\sim k_B T $) 显著增加，使得它们在飞越库仑势阱时受到的偏转更小。这个动能增加的效应远比屏蔽减弱的效应更为显著，因此总的散射效应是减弱的，表现为电离杂质散射限制的迁移率随温度升高而增加。",
            "answer": "$$\n\\boxed{\\frac{n e^2}{\\varepsilon_0 \\varepsilon_r k_B T}}\n$$"
        },
        {
            "introduction": "与长程的电离杂质散射不同，中性杂质充当的是短程散射中心。本练习将探讨经典的厄金索（Erginsoy）模型，该模型成功解释了在极低温下半导体中经常观测到的迁移率不随温度变化的现象。通过解决这个问题，您将学习如何将微观的散射截面与宏观的迁移率联系起来，并了解如何利用实验数据来量化这些中性散射体的浓度。",
            "id": "3756910",
            "problem": "一个非简并的 n 型砷化镓 (GaAs) 外延层表现出低温漂移迁移率平台。材料参数为电子有效质量 $m^{\\ast} = 0.067\\,m_{e}$ 和静态介电常数 $\\varepsilon_{s} = 12.9$。施主和残余受主浓度分别为 $N_{D} = 3.0 \\times 10^{16}\\,\\mathrm{cm}^{-3}$ 和 $N_{A} = 5.0 \\times 10^{15}\\,\\mathrm{cm}^{-3}$。在 $T = 5\\,\\mathrm{K}$ 到 $T = 20\\,\\mathrm{K}$ 之间，测得的总漂移迁移率 $\\mu_{\\mathrm{tot}}(T)$ 基本恒定在 $\\mu_{\\mathrm{plateau}} = 1.10 \\times 10^{4}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$。独立的器件和建模估算表明，在 $T = 5\\,\\mathrm{K}$ 时，电离杂质限制的迁移率和声学声子限制的迁移率分别为 $\\mu_{\\mathrm{ion}}(5\\,\\mathrm{K}) = 4.0 \\times 10^{5}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$ 和 $\\mu_{\\mathrm{ph}}(5\\,\\mathrm{K}) = 2.0 \\times 10^{7}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$。\n\n从玻尔兹曼输运框架和马西森定则出发，并引用由 Erginsoy 阐述的中性杂质散射的物理图像（不使用任何预先给定的目标公式），完成以下任务：\n\n1. 推导中性杂质输运截面的定性速度依赖关系，该关系导致了非简并半导体中中性杂质限制迁移率 $\\mu_{N}(T)$ 的温度行为。清晰地将散射率对电子速率 $v$ 的依赖关系与 $\\mu_{N}(T)$ 的温度依赖关系联系起来。\n\n2. 提出一个程序，利用马西森定则和 Erginsoy 中性散射图像，从观测到的低温迁移率平台来量化中性杂质浓度 $N_{N}$。您的方案应指明当 $\\mu_{\\mathrm{ion}}$ 和 $\\mu_{\\mathrm{ph}}$ 已知或可以界定时，如何从测量的 $\\mu_{\\mathrm{tot}}(T)$ 中分离出中性散射的贡献。\n\n3. 使用您的推导和方案，计算 Erginsoy 模型对此 GaAs 样品预测的比率\n$$\nR \\equiv \\frac{\\mu_{N}(5\\,\\mathrm{K})}{\\mu_{N}(20\\,\\mathrm{K})}\n$$\n将 $R$ 表示为一个无量纲的数。无需四舍五入。",
            "solution": "该问题要求基于 Erginsoy 模型，对一个非简并 n 型 GaAs 样品中的中性杂质散射进行三部分分析。\n\n第 1 部分：中性杂质截面速度依赖关系的推导。\n\n分析始于电导率的玻尔兹曼输运理论，漂移迁移率 $\\mu$ 由此定义。对于电荷为 $-e$、有效质量为 $m^*$ 的载流子（本例中为电子）系综，迁移率与平均动量弛豫时间 $\\langle \\tau_m \\rangle$ 的关系为\n$$\n\\mu = \\frac{e \\langle \\tau_m \\rangle}{m^*}\n$$\n在非简并半导体中，载流子遵循麦克斯韦-玻尔兹曼分布。平均动量弛豫时间是通过对能量依赖的弛豫时间 $\\tau_m(E)$ 在此分布上进行平均来计算的。该平均值的标准公式是：\n$$\n\\langle \\tau_m \\rangle = \\frac{\\int_{0}^{\\infty} \\tau_m(E) E^{3/2} \\exp(-E/k_B T) dE}{\\int_{0}^{\\infty} E^{3/2} \\exp(-E/k_B T) dE}\n$$\n其中 $E$ 是电子动能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。$E^{3/2}$ 项来源于三维态密度 $g(E) \\propto E^{1/2}$ 与一个因子 $E$ 的乘积，该因子根据态对输运的贡献进行加权。\n\n迁移率 $\\mu(T)$ 的温度依赖性由 $\\langle \\tau_m \\rangle$ 的温度依赖性决定。让我们通过为弛豫时间代入一个普遍的幂律依赖关系 $\\tau_m(E) = \\tau_0 E^p$ 来分析该积分，其中 $p$ 是表征散射机制的常数。\n分子变为：\n$$\n\\int_{0}^{\\infty} (\\tau_0 E^p) E^{3/2} \\exp(-E/k_B T) dE = \\tau_0 \\int_{0}^{\\infty} E^{p+3/2} \\exp(-E/k_B T) dE\n$$\n使用换元 $x = E/k_B T$，因此 $E = x k_B T$ 和 $dE = k_B T dx$，积分变为：\n$$\n\\tau_0 (k_B T)^{p+3/2+1} \\int_{0}^{\\infty} x^{p+3/2} \\exp(-x) dx = \\tau_0 (k_B T)^{p+5/2} \\Gamma(p+5/2)\n$$\n其中 $\\Gamma(z)$ 是伽马函数。\n分母是 $p=0$ 的情况（因为 $\\tau_m(E)$ 被 1 替换）：\n$$\n(k_B T)^{5/2} \\Gamma(5/2)\n$$\n因此，平均弛豫时间的温度依赖性为：\n$$\n\\langle \\tau_m \\rangle \\propto \\frac{(k_B T)^{p+5/2}}{(k_B T)^{5/2}} = (k_B T)^p\n$$\n因此，迁移率的温度依赖性为 $\\mu \\propto T^p$。\n\nErginsoy 的中性杂质散射模型用于解释实验观察，即在极低温度下，迁移率变得与温度无关。为了使中性杂质限制的迁移率 $\\mu_N(T)$ 与温度无关，我们必须有 $\\mu_N \\propto T^0$。这意味着中性杂质散射的指数 $p$ 必须为 $p=0$。\n\n如果 $p=0$，那么 $\\tau_N(E) = \\tau_0 E^0 = \\text{常数}$。这意味着中性杂质散射的动量弛豫时间 $\\tau_N$ 必须与电子的能量无关。\n\n现在，我们将这个结果与散射截面 $\\sigma_N$ 联系起来。散射率，即弛豫时间的倒数，由以下公式给出：\n$$\n\\frac{1}{\\tau_N(v)} = N_N v \\sigma_N(v)\n$$\n其中 $N_N$ 是中性杂质的浓度，$v$ 是电子速率。\n由于我们要求 $\\tau_N$ 为常数（与能量无关，因此与速率无关），其倒数，即散射率，也必须为常数。\n$$\nN_N v \\sigma_N(v) = \\text{常数}\n$$\n鉴于 $N_N$ 是一个恒定的浓度，这个条件直接暗示了截面的一个特定的速度依赖关系：\n$$\n\\sigma_N(v) \\propto \\frac{1}{v}\n$$\n这就是中性杂质输运截面的定性速度依赖关系，它导致了 Erginsoy 模型所特有的与温度无关的迁移率。散射率与电子速率 ($v$) 的无关性确保了弛豫时间 $\\tau_N$ 是恒定的，这反过来又使得迁移率 $\\mu_N$ 与温度 $T$ 无关。\n\n第 2 部分：量化中性杂质浓度 $N_N$ 的程序。\n\n所提出的程序利用了马西森定则和 Erginsoy 模型的理论结果。\n\n1.  **应用马西森定则**：总迁移率 $\\mu_{\\mathrm{tot}}$ 受几种独立的散射机制限制。马西森定则指出，总迁移率的倒数是每种机制限制的迁移率倒数之和。对于给定的问题，相关的机制是电离杂质散射、声学声子散射和中性杂质散射。\n    $$\n    \\frac{1}{\\mu_{\\mathrm{tot}}(T)} = \\frac{1}{\\mu_{\\mathrm{ion}}(T)} + \\frac{1}{\\mu_{\\mathrm{ph}}(T)} + \\frac{1}{\\mu_{N}(T)}\n    $$\n\n2.  **分离中性杂质迁移率**：重新排列方程，求解由中性杂质限制的迁移率 $\\mu_N(T)$。\n    $$\n    \\frac{1}{\\mu_{N}(T)} = \\frac{1}{\\mu_{\\mathrm{tot}}(T)} - \\frac{1}{\\mu_{\\mathrm{ion}}(T)} - \\frac{1}{\\mu_{\\mathrm{ph}}(T)}\n    $$\n    这允许在其他贡献已知的情况下，从测量的总迁移率中提取中性杂质的贡献。\n\n3.  **在特定温度下计算 $\\mu_N$**：在平台区域内选择一个温度，例如 $T=5\\,\\mathrm{K}$，此时所有必要数据都可用。将测量的总迁移率 $\\mu_{\\mathrm{tot}}(5\\,\\mathrm{K}) = \\mu_{\\mathrm{plateau}} = 1.10 \\times 10^{4}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$ 以及给定的 $\\mu_{\\mathrm{ion}}(5\\,\\mathrm{K})$ 和 $\\mu_{\\mathrm{ph}}(5\\,\\mathrm{K})$ 的值代入第 2 步中重新排列的方程，以计算 $\\mu_N(5\\,\\mathrm{K})$ 的数值。\n\n4.  **应用 Erginsoy 公式**：Erginsoy 模型为与温度无关的中性杂质迁移率提供了一个理论表达式：\n    $$\n    \\mu_N = \\frac{e}{20 a_B^* \\hbar N_N}\n    $$\n    其中 $e$ 是元电荷，$\\hbar$ 是约化普朗克常数，$N_N$ 是中性杂质浓度，$a_B^*$ 是半导体中的有效玻尔半径。\n\n5.  **计算有效玻尔半径**：材料中的有效玻尔半径由以下公式给出：\n    $$\n    a_B^* = a_0 \\frac{\\varepsilon_s m_e}{m^*}\n    $$\n    其中 $a_0$ 是真空中的玻尔半径 ($a_0 = \\frac{4\\pi\\varepsilon_0\\hbar^2}{m_e e^2} \\approx 0.529 \\times 10^{-8}\\,\\mathrm{cm}$)，$\\varepsilon_s$ 是半导体的静态介电常数，$m_e$ 是自由电子质量，$m^*$ 是电子有效质量。对于给定的 GaAs 样品，$\\varepsilon_s = 12.9$ 且 $m^* = 0.067\\,m_e$。\n\n6.  **求解 $N_N$**：重新排列 Erginsoy 公式以求解中性杂质浓度 $N_N$：\n    $$\n    N_N = \\frac{e}{20 a_B^* \\hbar \\mu_N}\n    $$\n    由于 Erginsoy 模型预测 $\\mu_N$ 是常数，因此在第 3 步中计算的值可用于此方程。通过代入物理常数（$e, \\hbar$）的值、第 5 步中计算的 $a_B^*$ 和第 3 步中计算的 $\\mu_N$，可以量化未知的浓度 $N_N$。\n\n第 3 部分：计算比率 $R \\equiv \\frac{\\mu_{N}(5\\,\\mathrm{K})}{\\mu_{N}(20\\,\\mathrm{K})}$。\n\n问题要求计算由 Erginsoy 模型预测的，在两个不同温度 $T = 5\\,\\mathrm{K}$ 和 $T = 20\\,\\mathrm{K}$ 下的中性杂质限制迁移率之比。\n\n正如在第 1 部分中所确立的，当在玻尔兹曼输运框架内形式化时，Erginsoy 模型的理论基础是中性杂质散射时间 $\\tau_N$ 与电子能量无关。这导致平均散射时间 $\\langle \\tau_N \\rangle$ 与温度无关。\n\n由于迁移率与平均散射时间成正比，$\\mu_N = \\frac{e \\langle \\tau_N \\rangle}{m^*}$，并且 $e$ 和 $m^*$ 是常数，因此中性杂质限制的迁移率 $\\mu_N$ 被预测为与温度无关。\n$$\n\\mu_N(T) = \\text{常数}\n$$\n这个理论预测在模型的有效范围内对任何两个温度都成立。因此，在 $T = 5\\,\\mathrm{K}$ 时的迁移率等于在 $T = 20\\,\\mathrm{K}$ 时的迁移率：\n$$\n\\mu_N(5\\,\\mathrm{K}) = \\mu_N(20\\,\\mathrm{K})\n$$\n因此，所需的比率 $R$ 为：\n$$\nR = \\frac{\\mu_{N}(5\\,\\mathrm{K})}{\\mu_{N}(20\\,\\mathrm{K})} = 1\n$$\n问题陈述中提供的大量数值数据旨在建立一个物理上现实的背景，在该背景下 Erginsoy 模型是相关的（即，一个中性杂质散射是主导的、与温度无关的机制的低温区），但对于这个特定的计算来说，具体的数值是不需要的，因为它完全依赖于模型本身预测的理论温度依赖性。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "为精确预测器件行为，我们常使用复杂的蒙特卡洛模拟来追踪单个电子在半导体内部的运动轨迹。这项动手练习将把屏蔽库仑散射的理论框架  转化为一个实用的计算工具。您将推导并实现一个算法来随机抽样散射角，这是模拟电离杂质对载流子输运影响所需的核心组件。",
            "id": "3756952",
            "problem": "您的任务是在蒙特卡洛（MC）输运模拟中，为电离杂质散射中的极向散射角推导并实现一个精确的基于反演的采样器。考虑一个波矢大小为 $k$ 的载流子，在第一玻恩近似下，被一个屏蔽库仑（汤川）势进行弹性散射。微分散射截面，在一个常数预因子内，与 $(q^2 + q_s^2)^{-2}$ 成正比，其中动量转移为 $q = 2 k \\sin(\\theta/2)$，$q_s$ 是屏蔽波矢。由于柱对称性，方位角 $\\phi$ 在 $[0,2\\pi)$ 上均匀分布，而极角 $\\theta \\in [0,\\pi]$ 具有一个非平凡分布，该分布由标准立体角测度 $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$ 在立体角上的累积分布导出。\n\n从基本定义和经过充分检验的事实出发：\n- 散射角的概率密度与微分截面乘以立体角测度成正比。\n- $\\theta$ 的累积分布函数（CDF）$C(\\theta)$ 是此密度从 $0$ 到 $\\theta$ 的归一化累积积分。\n- 逆变换采样需要对 $u = C(\\theta)$ 进行反演，其中 $u$ 是 $[0,1]$ 上的一个均匀分布随机数。\n\n您的任务是：\n1) 推导极角 $\\theta$ 的归一化累积分布函数 $C(\\theta)$，用 $k$ 和 $q_s$ 表示，并利用给定的关系 $q = 2 k \\sin(\\theta/2)$ 显式地执行对 $\\phi$ 和 $\\theta$ 的积分。然后，推导一个闭式反演公式 $\\theta(u;k,q_s)$，该公式将一个均匀分布的随机变量 $u \\in [0,1]$ 映射到一个散射角 $\\theta \\in [0,\\pi]$。\n2) 设计一个实现此反演公式的数值稳定算法，仔细处理 $u$ 非常接近 $0$ 或 $1$ 的边界情况。您的算法必须以弧度为单位返回 $\\theta$。\n3) 实现一个完整的程序，该程序为一小组参数集 $(k,q_s)$ 和指定的 $u$ 值列表计算 $\\theta$，并将结果打印在单行中。\n\n物理单位：\n- 波矢大小 $k$ 和屏蔽波矢 $q_s$ 必须以 $\\text{m}^{-1}$ 为单位提供。\n- 散射角 $\\theta$ 必须以弧度表示。\n\n角度单位：\n- 所有角度必须以弧度为单位。\n\n测试套件：\n- 共有 $3$ 个测试用例。对每个用例，计算与给定的 $u$ 值相对应的 $\\theta$ 值列表。请严格使用以下参数和输入：\n  - 用例 1（中等屏蔽）：$k = 1.0 \\times 10^9 \\ \\text{m}^{-1}$，$q_s = 5.0 \\times 10^8 \\ \\text{m}^{-1}$，以及 $u$ 值 $[0.0, 0.25, 0.5, 0.75, 1.0]$。\n  - 用例 2（弱屏蔽）：$k = 1.0 \\times 10^{10} \\ \\text{m}^{-1}$，$q_s = 1.0 \\times 10^8 \\ \\text{m}^{-1}$，以及 $u$ 值 $[1.0 \\times 10^{-12}, 1.0 \\times 10^{-6}, 0.1, 0.9, 0.999999999999]$。\n  - 用例 3（强屏蔽）：$k = 1.0 \\times 10^8 \\ \\text{m}^{-1}$，$q_s = 1.0 \\times 10^{11} \\ \\text{m}^{-1}$，以及 $u$ 值 $[0.2, 0.4, 0.6, 0.8]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，并用方括号括起来。每个内部列表对应一个测试用例，并按给定顺序包含指定 $u$ 值的 $\\theta$ 值（以弧度为单位）。例如，打印的行必须如下所示：\n  - $[[\\theta_{1,1},\\theta_{1,2},\\dots],[\\theta_{2,1},\\dots],[\\theta_{3,1},\\dots]]$\n- 每个 $\\theta$ 必须是浮点数。打印的值中不要包含单位。",
            "solution": "该问题要求推导并实现一个精确的基于反演的采样器，用于计算载流子在屏蔽库仑势下弹性散射的极向散射角 $\\theta$。整个过程始于验证问题陈述，我们发现该陈述在科学上是合理的、适定的且完整的。因此，我们可以继续进行推导和求解。\n\n该问题的基础是微分散射截面。对于第一玻恩近似下的屏蔽库仑势，该截面与 $(q^2 + q_s^2)^{-2}$ 成正比。载流子散射到立体角元 $d\\Omega$ 内的概率 $dP$ 与微分截面 $\\frac{d\\sigma}{d\\Omega}$ 成正比：\n$$ dP \\propto \\frac{d\\sigma}{d\\Omega} d\\Omega \\propto (q^2 + q_s^2)^{-2} d\\Omega $$\n在球坐标系中，立体角元为 $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$，其中 $\\theta \\in [0, \\pi]$ 是极角，$\\phi \\in [0, 2\\pi)$ 是方位角。弹性散射的动量转移矢量大小由 $q = 2 k \\sin(\\theta/2)$ 给出，其中 $k$ 是载流子波矢的大小。\n\n代入这些表达式，概率分布为：\n$$ dP(\\theta, \\phi) \\propto \\left( (2k \\sin(\\theta/2))^2 + q_s^2 \\right)^{-2} \\sin\\theta \\, d\\theta \\, d\\phi $$\n由于该表达式不依赖于方位角 $\\phi$，我们可以通过对 $\\phi \\in [0, 2\\pi)$ 进行积分来找到 $\\theta$ 的概率分布。此积分产生一个因子 $2\\pi$，它是一个常数，可以被吸收到比例常数中。因此，极角 $\\theta$ 的概率密度函数（PDF），记为 $f(\\theta)$，由下式给出：\n$$ f(\\theta) \\propto \\left( 4k^2 \\sin^2(\\theta/2) + q_s^2 \\right)^{-2} \\sin\\theta $$\n\n下一步是推导累积分布函数（CDF）$C(\\theta)$，即 PDF 从 $0$ 到 $\\theta$ 的归一化积分：\n$$ C(\\theta) = \\frac{\\int_0^\\theta f(\\theta') \\, d\\theta'}{\\int_0^\\pi f(\\theta') \\, d\\theta'} = \\frac{\\int_0^\\theta \\left( 4k^2 \\sin^2(\\theta'/2) + q_s^2 \\right)^{-2} \\sin\\theta' \\, d\\theta'}{\\int_0^\\pi \\left( 4k^2 \\sin^2(\\theta'/2) + q_s^2 \\right)^{-2} \\sin\\theta' \\, d\\theta'} $$\n为了计算这些积分，我们进行变量替换。令 $v = \\sin^2(\\theta'/2)$。其微分为 $dv = \\sin(\\theta'/2)\\cos(\\theta'/2) \\, d\\theta' = \\frac{1}{2}\\sin\\theta' \\, d\\theta'$。因此，$\\sin\\theta' \\, d\\theta' = 2 \\, dv$。当 $\\theta'$ 从 $0$ 变到 $\\theta$ 时，对应的 $v$ 的积分限为从 $\\sin^2(0) = 0$ 到 $\\sin^2(\\theta/2)$。\n\n令 $I(\\theta)$ 为分子中的未归一化累积积分：\n$$ I(\\theta) = \\int_0^{\\sin^2(\\theta/2)} \\left( 4k^2 v + q_s^2 \\right)^{-2} 2 \\, dv $$\n这是一个标准积分。令 $w = 4k^2 v + q_s^2$，则 $dw = 4k^2 dv$。\n$$ I(\\theta) = 2 \\int_{v=0}^{v=\\sin^2(\\theta/2)} w^{-2} \\frac{dw}{4k^2} = \\frac{1}{2k^2} \\left[ -w^{-1} \\right]_{v=0}^{v=\\sin^2(\\theta/2)} $$\n$$ I(\\theta) = \\frac{1}{2k^2} \\left[ -\\frac{1}{4k^2 v + q_s^2} \\right]_0^{\\sin^2(\\theta/2)} = \\frac{1}{2k^2} \\left( -\\frac{1}{4k^2 \\sin^2(\\theta/2) + q_s^2} - (-\\frac{1}{q_s^2}) \\right) $$\n$$ I(\\theta) = \\frac{1}{2k^2} \\left( \\frac{1}{q_s^2} - \\frac{1}{4k^2 \\sin^2(\\theta/2) + q_s^2} \\right) $$\n化简括号中的表达式：\n$$ I(\\theta) = \\frac{1}{2k^2} \\left( \\frac{4k^2 \\sin^2(\\theta/2)}{q_s^2 (4k^2 \\sin^2(\\theta/2) + q_s^2)} \\right) = \\frac{2\\sin^2(\\theta/2)}{q_s^2 (4k^2 \\sin^2(\\theta/2) + q_s^2)} $$\n\n归一化常数是总积分 $I(\\pi)$。当 $\\theta' = \\pi$ 时，我们有 $\\sin^2(\\pi/2) = 1$：\n$$ I(\\pi) = \\frac{2(1)}{q_s^2 (4k^2 (1) + q_s^2)} = \\frac{2}{q_s^2(4k^2 + q_s^2)} $$\nCDF 是比值 $C(\\theta) = I(\\theta) / I(\\pi)$：\n$$ C(\\theta) = \\frac{\\frac{2\\sin^2(\\theta/2)}{q_s^2 (4k^2 \\sin^2(\\theta/2) + q_s^2)}}{\\frac{2}{q_s^2(4k^2 + q_s^2)}} = \\sin^2(\\theta/2) \\frac{4k^2 + q_s^2}{4k^2 \\sin^2(\\theta/2) + q_s^2} $$\n作为检验，$C(0) = 0$ 且 $C(\\pi) = 1 \\cdot \\frac{4k^2+q_s^2}{4k^2+q_s^2} = 1$，符合要求。\n\n推导的最后一步是反演此函数，以用于逆变换采样。我们设 $u = C(\\theta)$，其中 $u$ 是来自均匀分布 $U[0,1]$ 的一个随机变量，然后求解 $\\theta$。为清晰起见，令 $S = \\sin^2(\\theta/2)$。\n$$ u = S \\frac{4k^2 + q_s^2}{4k^2 S + q_s^2} $$\n$$ u(4k^2 S + q_s^2) = S(4k^2 + q_s^2) $$\n$$ 4k^2 u S + u q_s^2 = 4k^2 S + S q_s^2 $$\n$$ u q_s^2 = S(4k^2 + q_s^2 - 4k^2 u) = S(4k^2(1-u) + q_s^2) $$\n$$ S = \\sin^2(\\theta/2) = \\frac{u q_s^2}{4k^2(1-u) + q_s^2} $$\n为了得到一个更紧凑且在数值上更有利的型式，我们可以将分子和分母同除以 $q_s^2$，并引入无量纲参数 $\\beta = (2k/q_s)^2 = 4k^2/q_s^2$：\n$$ \\sin^2(\\theta/2) = \\frac{u}{(4k^2/q_s^2)(1-u)+1} = \\frac{u}{1+\\beta(1-u)} $$\n由于 $\\theta \\in [0, \\pi]$，所以 $\\theta/2 \\in [0, \\pi/2]$，且 $\\sin(\\theta/2)$ 是非负的。我们可以取平方根，然后取反正弦：\n$$ \\sin(\\theta/2) = \\sqrt{\\frac{u}{1+\\beta(1-u)}} $$\n$$ \\theta(u; k, q_s) = 2 \\arcsin\\left(\\sqrt{\\frac{u}{1+\\beta(1-u)}}\\right) $$\n这就是所要求的闭式反演公式。\n\n对于算法设计而言，此公式是数值稳定的。当 $u \\to 0$ 时，$\\theta \\to 0$；当 $u \\to 1$ 时，$\\theta \\to \\pi$。对于 $u \\in (0,1)$，平方根的参数严格介于 $0$ 和 $1$ 之间，确保了 $\\arcsin$ 函数有良好定义。实现将直接使用此公式。将使用 `numpy` 库提供的矢量化操作来高效地计算 $u$ 值列表对应的角度。为了形式上的正确性，我们对 $u=0$ 和 $u=1$ 进行了特殊处理，尽管该公式在这些极限处是鲁棒的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n\n    def calculate_theta(k, qs, u_values):\n        \"\"\"\n        Calculates the polar scattering angle theta for ionized impurity scattering\n        using the derived inverse CDF formula.\n\n        Args:\n            k (float): The magnitude of the incident wavevector in m^-1.\n            qs (float): The screening wavevector in m^-1.\n            u_values (list): A list of uniform random variates in [0, 1].\n\n        Returns:\n            list: A list of calculated theta values in radians.\n        \"\"\"\n        # Convert input list to a numpy array for vectorized calculations.\n        # Use np.float64 for high precision, important for values close to 0 or 1.\n        u_values = np.array(u_values, dtype=np.float64)\n\n        if qs == 0.0:\n            # The derivation assumes a screened potential (qs > 0). The unscreened case\n            # (Rutherford scattering) has a divergent total cross section.\n            raise ValueError(\"Screening wavevector qs must be positive.\")\n\n        # Calculate the dimensionless parameter beta = (2k/qs)^2.\n        # This form is numerically stable.\n        beta = (2.0 * k / qs)**2\n\n        # The inversion formula is theta = 2 * arcsin(sqrt(u / (1 + beta * (1 - u)))).\n        # We can implement this for all u values at once.\n        # np.ones_like ensures that 1-u is calculated with high precision where u is close to 1.\n        one_minus_u = np.ones_like(u_values) - u_values\n        \n        # Denominator of the argument of the square root\n        denominator = 1.0 + beta * one_minus_u\n        \n        # The argument inside the square root\n        sqrt_arg = u_values / denominator\n\n        # While mathematically sqrt_arg should be in [0, 1], floating point\n        # arithmetic could produce values slightly outside this range.\n        # np.clip ensures the argument for np.sqrt is non-negative.\n        sqrt_arg = np.clip(sqrt_arg, 0.0, 1.0)\n\n        # Calculate theta values\n        theta_values = 2.0 * np.arcsin(np.sqrt(sqrt_arg))\n\n        return theta_values.tolist()\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\"k\": 1.0e9, \"qs\": 5.0e8, \"u\": [0.0, 0.25, 0.5, 0.75, 1.0]},\n        {\"k\": 1.0e10, \"qs\": 1.0e8, \"u\": [1.0e-12, 1.0e-6, 0.1, 0.9, 0.999999999999]},\n        {\"k\": 1.0e8, \"qs\": 1.0e11, \"u\": [0.2, 0.4, 0.6, 0.8]},\n    ]\n    \n    all_results = []\n    for case in test_cases:\n        k_val = case[\"k\"]\n        qs_val = case[\"qs\"]\n        u_vals = case[\"u\"]\n        \n        theta_results = calculate_theta(k_val, qs_val, u_vals)\n        all_results.append(theta_results)\n\n    # Format the final output string according to the specified format:\n    # [[theta_1,1,...],[theta_2,1,...],...]\n    # without extra spaces.\n    inner_lists_str = []\n    for res_list in all_results:\n        # Convert each float in the list to its string representation\n        # and join with commas.\n        inner_str = \",\".join(map(str, res_list))\n        inner_lists_str.append(f\"[{inner_str}]\")\n    \n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}