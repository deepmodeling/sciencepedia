{
    "hands_on_practices": [
        {
            "introduction": "在全耦合牛顿法中，核心任务是精确构建雅可比矩阵，这要求计算系统内所有残差项对所有未知变量的偏导数。半导体器件中的复合-产生（R-G）率是载流子浓度的高度非线性函数，而载流子浓度又通过玻尔兹曼关系依赖于静电势。本练习  将指导您推导这一关键的雅可比矩阵项，即 R-G 率对静电势的导数，从而加深您对不同物理模型间耦合关系的理解，并锻炼您的解析计算能力。",
            "id": "3761654",
            "problem": "考虑一个由漂移-扩散模型以及耦合的泊松方程和载流子连续性方程描述的非简并半导体。在针对全耦合系统的牛顿-拉夫逊迭代中，需要计算包含净复合-产生率对静电势的偏导数的雅可比矩阵元。假设在温度为 $T$ 的类硅材料中有一个空间点，其热电压为 $V_T = k_B T / q$。电子浓度 $n$ 和空穴浓度 $p$ 通过玻尔兹曼关系与静电势 $\\psi$ 以及电子和空穴的准费米势 $\\varphi_n$ 和 $\\varphi_p$ 相关联\n$$\nn(\\psi) = n_i \\exp\\!\\left(\\frac{\\varphi_n - \\psi}{V_T}\\right), \\qquad\np(\\psi) = n_i \\exp\\!\\left(\\frac{\\psi - \\varphi_p}{V_T}\\right),\n$$\n其中 $n_i$ 是本征载流子浓度，在要计算的导数中，$\\varphi_n$ 和 $\\varphi_p$ 被视为相对于 $\\psi$ 是固定的。总的净复合-产生率由以下三种机制之和给出：\n$$\nR_{\\text{tot}}(n,p) = R_{\\text{SRH}}(n,p) + R_{\\text{rad}}(n,p) + R_{\\text{Aug}}(n,p),\n$$\n其中\n$$\nR_{\\text{SRH}}(n,p) = \\frac{n p - n_i^2}{\\tau_p (n + n_1) + \\tau_n (p + p_1)},\n$$\n$$\nR_{\\text{rad}}(n,p) = B \\left(n p - n_i^2\\right),\n$$\n$$\nR_{\\text{Aug}}(n,p) = \\left(C_n n + C_p p\\right)\\left(n p - n_i^2\\right).\n$$\n这里，$\\tau_n$ 和 $\\tau_p$ 分别是电子和空穴的 Shockley–Read–Hall 寿命，$B$ 是辐射复合系数，$C_n$ 和 $C_p$ 分别是电子和空穴的俄歇复合系数。量 $n_1$ 和 $p_1$ 是与能量为 $E_t$ 的单一主要陷阱相关的 Shockley–Read–Hall 参考浓度，定义为\n$$\nn_1 = n_i \\exp\\!\\left(\\frac{E_t - E_i}{k_B T}\\right), \\qquad p_1 = n_i \\exp\\!\\left(-\\frac{E_t - E_i}{k_B T}\\right),\n$$\n其中 $E_i$ 是本征费米能级。假设在工作点，$n_i$、$n_1$、$p_1$、$\\tau_n$、$\\tau_p$、$B$、$C_n$、$C_p$、$\\varphi_n$ 和 $\\varphi_p$ 相对于 $\\psi$ 都是常数。\n\n从基本的载流子统计和上述函数定义出发，推导在 $\\varphi_n$ 和 $\\varphi_p$ 固定的情况下，偏导数 $\\partial R_{\\text{tot}}/\\partial \\psi$ 的闭式解析表达式。将你的最终答案表示为包含 $n$、$p$、$n_i$、$n_1$、$p_1$、$\\tau_n$、$\\tau_p$、$B$、$C_n$、$C_p$ 和 $V_T$ 的单个符号表达式。不需要进行数值计算。",
            "solution": "耦合的泊松方程和载流子连续性方程的牛顿-拉夫逊线性化需要包含净复合-产生率对静电势 $\\psi$ 的导数的雅可比矩阵元。$R_{\\text{tot}}$ 对 $\\psi$ 的依赖性是通过载流子浓度 $n(\\psi)$ 和 $p(\\psi)$ 来介导的，而在这一步中取 $\\partial/\\partial \\psi$ 时，准费米势 $\\varphi_n$ 和 $\\varphi_p$ 保持不变。\n\n我们从非简并载流子浓度的玻尔兹曼关系开始，\n$$\nn(\\psi) = n_i \\exp\\!\\left(\\frac{\\varphi_n - \\psi}{V_T}\\right), \\qquad\np(\\psi) = n_i \\exp\\!\\left(\\frac{\\psi - \\varphi_p}{V_T}\\right),\n$$\n其中 $V_T = k_B T / q$ 是热电压。将这些表达式对 $\\psi$ 求导，同时将 $\\varphi_n$ 和 $\\varphi_p$ 视为常数，可得\n$$\n\\frac{\\partial n}{\\partial \\psi} = -\\frac{1}{V_T} n, \\qquad \\frac{\\partial p}{\\partial \\psi} = \\frac{1}{V_T} p.\n$$\n定义净超额乘积\n$$\nS(n,p) = n p - n_i^2,\n$$\n和 Shockley–Read–Hall 分母\n$$\nD(n,p) = \\tau_p (n + n_1) + \\tau_n (p + p_1).\n$$\n利用这些定义，我们将三种机制写为\n$$\nR_{\\text{SRH}} = \\frac{S}{D}, \\qquad R_{\\text{rad}} = B S, \\qquad R_{\\text{Aug}} = (C_n n + C_p p) S.\n$$\n我们首先注意到在当前求导条件下有一个关键特性：当 $\\varphi_n$ 和 $\\varphi_p$ 保持固定时，乘积 $n p$ 与 $\\psi$ 无关。这可以从以下推导得出\n$$\nn p = n_i^2 \\exp\\!\\left(\\frac{\\varphi_n - \\psi}{V_T}\\right) \\exp\\!\\left(\\frac{\\psi - \\varphi_p}{V_T}\\right)\n= n_i^2 \\exp\\!\\left(\\frac{\\varphi_n - \\varphi_p}{V_T}\\right),\n$$\n所以\n$$\n\\frac{\\partial}{\\partial \\psi} (n p) = 0 \\quad \\Rightarrow \\quad \\frac{\\partial S}{\\partial \\psi} = 0.\n$$\n接下来，我们计算 $D(n,p)$ 对 $\\psi$ 的导数：\n$$\n\\frac{\\partial D}{\\partial \\psi} = \\tau_p \\frac{\\partial n}{\\partial \\psi} + \\tau_n \\frac{\\partial p}{\\partial \\psi}\n= \\tau_p \\left(-\\frac{n}{V_T}\\right) + \\tau_n \\left(\\frac{p}{V_T}\\right)\n= \\frac{-\\tau_p n + \\tau_n p}{V_T}.\n$$\n有了这些准备工作，我们对每种复合机制分别对 $\\psi$ 求导：\n\n$1.$ Shockley–Read–Hall 项：\n$$\n\\frac{\\partial R_{\\text{SRH}}}{\\partial \\psi}\n= \\frac{\\partial}{\\partial \\psi}\\left(\\frac{S}{D}\\right)\n= \\frac{(\\partial S/\\partial \\psi) D - S (\\partial D/\\partial \\psi)}{D^2}\n= - \\frac{S}{D^2} \\frac{\\partial D}{\\partial \\psi}\n= -\\frac{S}{D^2} \\cdot \\frac{-\\tau_p n + \\tau_n p}{V_T}\n= \\frac{S}{V_T} \\cdot \\frac{\\tau_p n - \\tau_n p}{D^2}.\n$$\n\n$2.$ 辐射项：\n$$\n\\frac{\\partial R_{\\text{rad}}}{\\partial \\psi}\n= B \\frac{\\partial S}{\\partial \\psi} = 0.\n$$\n\n$3.$ 俄歇项：\n$$\n\\frac{\\partial R_{\\text{Aug}}}{\\partial \\psi}\n= \\frac{\\partial}{\\partial \\psi}\\left[(C_n n + C_p p) S\\right]\n= \\left(C_n \\frac{\\partial n}{\\partial \\psi} + C_p \\frac{\\partial p}{\\partial \\psi}\\right) S + (C_n n + C_p p) \\frac{\\partial S}{\\partial \\psi}.\n$$\n由于 $\\partial S/\\partial \\psi = 0$，第二项消失，剩下\n$$\n\\frac{\\partial R_{\\text{Aug}}}{\\partial \\psi}\n= \\left(C_n \\left(-\\frac{n}{V_T}\\right) + C_p \\left(\\frac{p}{V_T}\\right)\\right) S\n= \\frac{S}{V_T} \\left(-C_n n + C_p p\\right).\n$$\n\n将这三部分的贡献相加，我们得到总导数\n$$\n\\frac{\\partial R_{\\text{tot}}}{\\partial \\psi}\n= \\frac{\\partial R_{\\text{SRH}}}{\\partial \\psi}\n+ \\frac{\\partial R_{\\text{rad}}}{\\partial \\psi}\n+ \\frac{\\partial R_{\\text{Aug}}}{\\partial \\psi}\n= \\frac{S}{V_T} \\left[ \\frac{\\tau_p n - \\tau_n p}{D^2} + \\left(-C_n n + C_p p\\right) \\right].\n$$\n最后，代回 $S = n p - n_i^2$ 和 $D = \\tau_p (n + n_1) + \\tau_n (p + p_1)$，用给定符号表示的闭式表达式为\n$$\n\\frac{\\partial R_{\\text{tot}}}{\\partial \\psi}\n= \\frac{n p - n_i^2}{V_T} \\left[ \\frac{\\tau_p n - \\tau_n p}{\\left(\\tau_p (n + n_1) + \\tau_n (p + p_1)\\right)^{2}} - C_n n + C_p p \\right].\n$$\n这就是在 $\\varphi_n$ 和 $\\varphi_p$ 固定时，关于静电势的雅可比矩阵元所求的解析表达式。",
            "answer": "$$\\boxed{\\frac{n p - n_i^2}{V_T} \\left[ \\frac{\\tau_p n - \\tau_n p}{\\left(\\tau_p (n + n_1) + \\tau_n (p + p_1)\\right)^{2}} - C_n n + C_p p \\right]}$$"
        },
        {
            "introduction": "从连续模型的解析导数到离散系统的矩阵构建，是实现数值模拟的关键一步。Scharfetter-Gummel (SG) 离散格式因其出色的数值稳定性，已成为现代器件模拟的基石。本练习  将带您深入 SG 格式的内部，计算电子连续性方程残差对电子准费米势的偏导数，这是一个关键的雅可比对角块元素。通过这个过程，您将把抽象的微分概念与求解过程中具体的稀疏矩阵联系起来。",
            "id": "3761662",
            "problem": "考虑在稳态条件下，一根具有均匀横截面的一维半导体棒中的等温电子输运。耦合的漂移-扩散和泊松系统在间距为 $\\Delta x$ 的均匀网格上进行离散化，节点索引为 $i \\in \\{1,2,\\dots,N\\}$。每个节点上的未知量是静电势 $\\phi_{i}$ 和电子准费米势 $\\varphi_{n,i}$，单位均为伏特。假设采用非简并的麦克斯韦-玻尔兹曼统计，因此电子密度满足\n$$\nn_{i} = n_{\\mathrm{ref}} \\exp\\!\\left(\\frac{\\varphi_{n,i} - \\phi_{i}}{V_{T}}\\right),\n$$\n其中 $n_{\\mathrm{ref}}$ 是一个与位置无关的参考密度，$V_{T} = k_{B} T / q$ 是热电压，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是温度，$q$ 是元电荷。\n\n电子电流密度由经典的漂移-扩散通量建模，其电场依赖的迁移率 $\\mu_{n}(E)$ 由下式给出\n$$\n\\mu_{n}(E) = \\frac{\\mu_{0}}{1 + \\frac{|E|}{E_{\\mathrm{sat}}}},\n$$\n其中 $\\mu_{0}$ 是低场迁移率，$E_{\\mathrm{sat}}$ 是特征饱和电场。假设爱因斯坦关系逐点成立，$D_{n} = V_{T} \\mu_{n}$。设边电场为 $E_{i+\\frac{1}{2}} = -(\\phi_{i+1}-\\phi_{i})/\\Delta x$，并定义边扩散系数 $D_{n,i+\\frac{1}{2}} = V_{T}\\,\\mu_{n}(|E_{i+\\frac{1}{2}}|)$，该系数仅取决于 $\\phi_{i}$ 和 $\\phi_{i+1}$。\n\n使用 Scharfetter–Gummel (SG) 格式对 $i+\\frac{1}{2}$ 界面处的电子电流密度进行离散化：\n$$\nJ_{n,i+\\frac{1}{2}} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ n_{i+1}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - n_{i}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right],\n$$\n其中 $\\psi_{i+\\frac{1}{2}} = \\frac{\\phi_{i+1}-\\phi_{i}}{V_{T}}$ 且当 $\\xi \\neq 0$ 时 $B(\\xi) = \\xi/(\\exp(\\xi)-1)$，并有 $B(0)=1$。在节点 $i$ 处的稳态离散电子连续性残差（忽略产生-复合）为\n$$\nR_{n,i} = J_{n,i+\\frac{1}{2}} - J_{n,i-\\frac{1}{2}}.\n$$\n\n在针对耦合非线性系统的牛顿-拉夫逊迭代中，构建雅可比矩阵项，该项对应于节点 $i$ 处的电子连续性残差对节点 $i$ 处的电子准费米势的偏导数，即\n$$\nJ_{ii}^{(n,\\varphi_{n})} \\equiv \\frac{\\partial R_{n,i}}{\\partial \\varphi_{n,i}},\n$$\n在标准的牛顿近似下，对于此偏导数，所有其他节点未知量 $\\{\\phi_{j}\\}_{j}$ 和 $\\{\\varphi_{n,j}\\}_{j \\neq i}$ 均在其当前迭代值上保持固定。特别地，将 $D_{n,i\\pm \\frac{1}{2}}$ 和 $B(\\pm \\psi_{i\\pm \\frac{1}{2}})$ 视为关于 $\\varphi_{n,i}$ 的常数。\n\n推导并给出一个关于 $q$、$\\Delta x$、 $V_{T}$、 $n_{i}$、 $D_{n,i\\pm \\frac{1}{2}}$ 以及在 $\\pm \\psi_{i\\pm \\frac{1}{2}}$ 处求值的伯努利函数的 $J_{ii}^{(n,\\varphi_{n})}$ 的单一闭式解析表达式。您的最终答案必须是单一的解析表达式。在最终的方框答案中不要包含单位。",
            "solution": "我们的目标是计算雅可比矩阵项 $J_{ii}^{(n,\\varphi_{n})}$，它被定义为节点 $i$ 处的离散电子连续性残差 $R_{n,i}$ 对同一节点处的电子准费米势 $\\varphi_{n,i}$ 的偏导数。\n$$\nJ_{ii}^{(n,\\varphi_{n})} \\equiv \\frac{\\partial R_{n,i}}{\\partial \\varphi_{n,i}}\n$$\n问题指明，在本次计算中，所有其他节点未知量——即对于所有 $j$ 的 $\\{\\phi_{j}\\}_{j}$ 和 $\\{\\varphi_{n,j}\\}_{j \\neq i}$——都应保持恒定。\n\n首先，我们写出残差 $R_{n,i}$ 的表达式。它被定义为围绕节点 $i$ 的界面上电子电流密度的差值：\n$$\nR_{n,i} = J_{n,i+\\frac{1}{2}} - J_{n,i-\\frac{1}{2}}\n$$\n电流密度由 Scharfetter–Gummel (SG) 格式给出。代入 $J_{n,i+\\frac{1}{2}}$ 和 $J_{n,i-\\frac{1}{2}}$ 的表达式：\n$$\nR_{n,i} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ n_{i+1}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - n_{i}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right] - \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ n_{i}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - n_{i-1}\\,B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right]\n$$\n现在，我们对 $R_{n,i}$ 求关于 $\\varphi_{n,i}$ 的偏导数：\n$$\n\\frac{\\partial R_{n,i}}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}} \\left( J_{n,i+\\frac{1}{2}} - J_{n,i-\\frac{1}{2}} \\right) = \\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} - \\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}}\n$$\n我们需要确定 $R_{n,i}$ 表达式中哪些项依赖于 $\\varphi_{n,i}$。根据问题陈述：\n-   静电势 $\\phi_j$ 保持恒定。这意味着归一化电势差 $\\psi_{i\\pm\\frac{1}{2}} = (\\phi_{i\\pm 1}-\\phi_i)/V_T$ 是恒定的。\n-   因此，伯努利函数 $B(\\pm\\psi_{i\\pm\\frac{1}{2}})$ 是恒定的。\n-   电场 $E_{i\\pm\\frac{1}{2}} = -(\\phi_{i\\pm 1}-\\phi_i)/\\Delta x$ 也是恒定的。\n-   因此，对于此偏导数，仅依赖于 $|E_{i\\pm\\frac{1}{2}}|$ 的扩散系数 $D_{n,i\\pm\\frac{1}{2}}$ 被视为常数。\n-   对于 $j \\neq i$，电子准费米势 $\\varphi_{n,j}$ 保持恒定。\n\n唯一依赖于 $\\varphi_{n,i}$ 的项是电子密度 $n_j = n_{\\mathrm{ref}} \\exp((\\varphi_{n,j} - \\phi_j)/V_T)$。具体来说，只有 $n_i$ 是 $\\varphi_{n,i}$ 的函数。密度 $n_{i+1}$ 和 $n_{i-1}$ 分别依赖于 $\\varphi_{n,i+1}$ 和 $\\varphi_{n,i-1}$，而这两者都保持恒定。\n\n我们来求 $n_i$ 对 $\\varphi_{n,i}$ 的导数：\n$$\nn_i = n_{\\mathrm{ref}} \\exp\\left(\\frac{\\varphi_{n,i} - \\phi_i}{V_T}\\right)\n$$\n$$\n\\frac{\\partial n_i}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}} \\left[ n_{\\mathrm{ref}} \\exp\\left(\\frac{\\varphi_{n,i} - \\phi_i}{V_T}\\right) \\right] = n_{\\mathrm{ref}} \\exp\\left(\\frac{\\varphi_{n,i} - \\phi_i}{V_T}\\right) \\cdot \\frac{1}{V_T} = \\frac{n_i}{V_T}\n$$\n相邻密度的导数为零：\n$$\n\\frac{\\partial n_{i+1}}{\\partial \\varphi_{n,i}} = 0 \\quad \\text{和} \\quad \\frac{\\partial n_{i-1}}{\\partial \\varphi_{n,i}} = 0\n$$\n现在我们可以计算电流分量的导数。\n\n对于 $J_{n,i+\\frac{1}{2}}$：\n$$\n\\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}}\\left\\{ \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ n_{i+1}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - n_{i}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right] \\right\\}\n$$\n将 $D_{n,i+\\frac{1}{2}}$、$B(\\psi_{i+\\frac{1}{2}})$ 和 $B(-\\psi_{i+\\frac{1}{2}})$ 视为常数，并使用链式法则：\n$$\n\\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ \\frac{\\partial n_{i+1}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - \\frac{\\partial n_{i}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right]\n$$\n代入密度的导数：\n$$\n\\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ 0 \\cdot B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - \\frac{n_i}{V_T}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right] = - \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x} \\frac{n_i}{V_T} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\n$$\n\n对于 $J_{n,i-\\frac{1}{2}}$：\n$$\n\\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}}\\left\\{ \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ n_{i}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - n_{i-1}\\,B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right] \\right\\}\n$$\n同样，将 $D_{n,i-\\frac{1}{2}}$ 和伯努利函数视为常数：\n$$\n\\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ \\frac{\\partial n_{i}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - \\frac{\\partial n_{i-1}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right]\n$$\n代入密度的导数：\n$$\n\\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ \\frac{n_i}{V_T}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - 0 \\cdot B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right] = \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x} \\frac{n_i}{V_T} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right)\n$$\n最后，我们组合出雅可比矩阵项 $J_{ii}^{(n,\\varphi_{n})}$：\n$$\nJ_{ii}^{(n,\\varphi_{n})} = \\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} - \\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}}\n$$\n$$\nJ_{ii}^{(n,\\varphi_{n})} = \\left(-\\frac{q\\,n_i}{V_T \\Delta x} D_{n,i+\\frac{1}{2}} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right) - \\left(\\frac{q\\,n_i}{V_T \\Delta x} D_{n,i-\\frac{1}{2}} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right)\\right)\n$$\n提出公因式 $-\\frac{q\\,n_i}{V_T \\Delta x}$ 得到最终表达式：\n$$\nJ_{ii}^{(n,\\varphi_{n})} = - \\frac{q\\,n_i}{V_T \\Delta x} \\left[ D_{n,i+\\frac{1}{2}} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right) + D_{n,i-\\frac{1}{2}} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) \\right]\n$$\n这就是所要求的雅可比矩阵元素的闭式解析表达式。",
            "answer": "$$\n\\boxed{- \\frac{q\\,n_i}{V_T \\Delta x} \\left[ D_{n,i+\\frac{1}{2}} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right) + D_{n,i-\\frac{1}{2}} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) \\right]}\n$$"
        },
        {
            "introduction": "理论上完美的牛顿-拉夫逊迭代在面对半导体方程的强非线性和大规模耦合时，往往会因数值不稳定而失败。因此，为迭代过程增加“安全措施”以确保其全局收敛性和稳健性至关重要。本练习  聚焦于两个常见的数值病态问题：载流子浓度出现负值和残差下降不足。您将通过推导和应用阻尼因子 $\\alpha$ 的约束条件，学习如何将一个脆弱的算法改造为能够可靠求解实际问题的稳健求解器。",
            "id": "3761661",
            "problem": "考虑一个由耦合漂移扩散方程（包括泊松方程以及电子和空穴连续性方程）建模的一维硅二极管。设未知向量为 $\\mathbf{y} = (\\psi, n, p)$，其中 $\\psi$ 是静电势，$n$ 是电子密度，$p$ 是空穴密度。该非线性系统可简写为 $\\mathbf{F}(\\mathbf{y}) = \\mathbf{0}$，其中 $\\mathbf{F}$ 是由偏微分方程 (PDE) 和边界条件构建的残差。你正在使用带阻尼的牛顿-拉夫逊 (NR) 方法求解 $\\mathbf{F}(\\mathbf{y}) = \\mathbf{0}$，即 $\\mathbf{y}_{k+1} = \\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k}$，其中 $\\Delta \\mathbf{y}_{k}$ 解线性化系统 $\\mathbf{J}_{k} \\Delta \\mathbf{y}_{k} = -\\mathbf{F}(\\mathbf{y}_{k})$，且 $\\mathbf{J}_{k} = \\partial \\mathbf{F} / \\partial \\mathbf{y} \\big|_{\\mathbf{y}_k}$。\n\n常见的两种数值病态问题是 (i) 载流子密度的正性违背和 (ii) 因残差范数下降不足而导致的全局收敛性缺乏。为增强鲁棒性，同时施加以下保障措施：\n- 正性保障：对于所有空间节点 $i$，要求 $n_{k+1,i} = n_{k,i} + \\alpha \\,\\Delta n_{k,i} \\geq 0$ 和 $p_{k+1,i} = p_{k,i} + \\alpha \\,\\Delta p_{k,i} \\geq 0$。\n- 充分下降保障：假设雅可比矩阵 $\\mathbf{J}(\\mathbf{y})$ 在 $\\mathbf{y}_{k}$ 附近是利普希茨连续的，常数为 $L$，并要求 Armijo 型下降 $\\|\\mathbf{F}(\\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k})\\| \\leq (1 - c \\,\\alpha)\\,\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$ 对某个选定的常数 $c \\in (0,1)$ 成立。\n\n在当前第 $k$ 次迭代，三个代表性节点上载流子密度的牛顿步分量计算如下：\n- $n_{k} = \\big(1.2 \\times 10^{16},\\, 8.0 \\times 10^{15},\\, 2.0 \\times 10^{14}\\big)$，$\\Delta n_{k} = \\big(-2.0 \\times 10^{16},\\, -1.0 \\times 10^{16},\\, 3.0 \\times 10^{15}\\big)$，\n- $p_{k} = \\big(3.0 \\times 10^{10},\\, 2.0 \\times 10^{10},\\, 1.0 \\times 10^{10}\\big)$，$\\Delta p_{k} = \\big(-1.0 \\times 10^{11},\\, 5.0 \\times 10^{9},\\, -2.0 \\times 10^{10}\\big)$。\n\n在 $\\mathbf{y}_{k}$ 处的复合残差范数和步长范数分别为\n$\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = 1.5 \\times 10^{4}$ 和 $\\|\\Delta \\mathbf{y}_{k}\\|^{2} = 9.0 \\times 10^{4}$，雅可比矩阵的利普希茨常数为 $L = 2.0 \\times 10^{3}$。在充分下降条件中使用 $c = 0.2$。全文使用欧几里得范数 $\\|\\cdot\\|$。\n\n严格从牛顿-拉夫逊更新和雅可比矩阵利普希茨连续性的定义出发，推导阻尼因子 $\\alpha$ 的一个显式上界，该上界能同时保证正性和充分下降。然后，使用所给数据，计算 $\\alpha$ 的最大允许值。\n\n将最终的 $\\alpha$ 表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "目标是找到最大的阻尼因子 $\\alpha  0$，使其能同时满足牛顿-拉夫逊更新 $\\mathbf{y}_{k+1} = \\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k}$ 的两个保障措施。\n\n**1. 正性保障**\n\n该保障措施要求更新后的载流子密度，即电子密度 $n$ 和空穴密度 $p$，在所有空间节点 $i$ 上保持非负。\n密度的更新方程为：\n$$n_{k+1,i} = n_{k,i} + \\alpha \\,\\Delta n_{k,i}$$\n$$p_{k+1,i} = p_{k,i} + \\alpha \\,\\Delta p_{k,i}$$\n正性约束为 $n_{k+1,i} \\geq 0$ 和 $p_{k+1,i} \\geq 0$。\n\n对于电子密度，约束为 $n_{k,i} + \\alpha \\,\\Delta n_{k,i} \\geq 0$。\n- 如果 $\\Delta n_{k,i} \\geq 0$，由于 $n_{k,i} \\geq 0$ 且我们寻求 $\\alpha  0$，此不等式恒成立。\n- 如果 $\\Delta n_{k,i}  0$，我们必须有 $\\alpha \\,\\Delta n_{k,i} \\geq -n_{k,i}$。由于 $\\Delta n_{k,i}$ 是负数，两边同除以它会使不等号反向：\n$$\\alpha \\leq \\frac{-n_{k,i}}{\\Delta n_{k,i}}$$\n这为每个电子密度更新值为负的节点提供了 $\\alpha$ 的一个上界。同样的逻辑也适用于空穴密度 $p$。\n\n为确保所有节点和两种载流子类型的正性，$\\alpha$ 必须小于或等于所有此类上界的最小值。\n$$\\alpha_{\\text{pos}} \\leq \\min \\left( \\min_{i | \\Delta n_{k,i}  0} \\left\\{ \\frac{-n_{k,i}}{\\Delta n_{k,i}} \\right\\}, \\min_{j | \\Delta p_{k,j}  0} \\left\\{ \\frac{-p_{k,j}}{\\Delta p_{k,j}} \\right\\} \\right)$$\n\n使用所给数据：\n对于电子密度 $n$：\n- 节点 1：$n_{k,1} = 1.2 \\times 10^{16}$，$\\Delta n_{k,1} = -2.0 \\times 10^{16}$。更新值为负。上界：$\\alpha \\leq \\frac{-1.2 \\times 10^{16}}{-2.0 \\times 10^{16}} = 0.6$。\n- 节点 2：$n_{k,2} = 8.0 \\times 10^{15}$，$\\Delta n_{k,2} = -1.0 \\times 10^{16}$。更新值为负。上界：$\\alpha \\leq \\frac{-8.0 \\times 10^{15}}{-1.0 \\times 10^{16}} = 0.8$。\n- 节点 3：$n_{k,3} = 2.0 \\times 10^{14}$，$\\Delta n_{k,3} = 3.0 \\times 10^{15}$。更新值为正，因此不施加上界。\n\n对于空穴密度 $p$：\n- 节点 1：$p_{k,1} = 3.0 \\times 10^{10}$，$\\Delta p_{k,1} = -1.0 \\times 10^{11}$。更新值为负。上界：$\\alpha \\leq \\frac{-3.0 \\times 10^{10}}{-1.0 \\times 10^{11}} = 0.3$。\n- 节点 2：$p_{k,2} = 2.0 \\times 10^{10}$，$\\Delta p_{k,2} = 5.0 \\times 10^{9}$。更新值为正，因此不施加上界。\n- 节点 3：$p_{k,3} = 1.0 \\times 10^{10}$，$\\Delta p_{k,3} = -2.0 \\times 10^{10}$。更新值为负。上界：$\\alpha \\leq \\frac{-1.0 \\times 10^{10}}{-2.0 \\times 10^{10}} = 0.5$。\n\n从正性约束导出的所有上界的集合是 $\\{0.6, 0.8, 0.3, 0.5\\}$。最严格（最小）的界是：\n$$\\alpha_{\\text{pos,max}} = \\min(0.6, 0.8, 0.3, 0.5) = 0.3$$\n\n**2. 充分下降保障 (Armijo 型条件)**\n\n该保障措施要求残差的范数在每一步都充分下降，具体由 Armijo 型条件给出：\n$$\\|\\mathbf{F}(\\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k})\\| \\leq (1 - c \\,\\alpha)\\,\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\n对某个常数 $c \\in (0,1)$ 成立。\n\n为推导保证此条件的 $\\alpha$ 的上界，我们从向量函数的微积分基本定理出发。令 $\\mathbf{s} = \\alpha \\Delta\\mathbf{y}_k$。则\n$$\\mathbf{F}(\\mathbf{y}_{k} + \\mathbf{s}) - \\mathbf{F}(\\mathbf{y}_{k}) = \\int_0^1 \\mathbf{J}(\\mathbf{y}_k + t\\mathbf{s}) \\mathbf{s} \\, dt$$\n其中 $\\mathbf{J}$ 是雅可比矩阵 $\\partial\\mathbf{F}/\\partial\\mathbf{y}$。代入 $\\mathbf{s}$ 并整理得：\n$$\\mathbf{F}(\\mathbf{y}_{k} + \\alpha \\Delta\\mathbf{y}_k) = \\mathbf{F}(\\mathbf{y}_{k}) + \\alpha \\int_0^1 \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) \\Delta\\mathbf{y}_k \\, dt$$\n我们可以在表达式中加上并减去项 $\\alpha \\mathbf{J}(\\mathbf{y}_k) \\Delta\\mathbf{y}_k = \\alpha \\mathbf{J}_k \\Delta\\mathbf{y}_k$：\n$$\\mathbf{F}(\\mathbf{y}_{k+1}) = \\mathbf{F}(\\mathbf{y}_{k}) + \\alpha \\mathbf{J}_k \\Delta\\mathbf{y}_k + \\alpha \\int_0^1 \\left[ \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\right] \\Delta\\mathbf{y}_k \\, dt$$\n根据牛顿步的定义，$\\mathbf{J}_k \\Delta\\mathbf{y}_k = -\\mathbf{F}(\\mathbf{y}_k)$。将此代入，我们得到：\n$$\\mathbf{F}(\\mathbf{y}_{k+1}) = \\mathbf{F}(\\mathbf{y}_{k}) - \\alpha\\mathbf{F}(\\mathbf{y}_{k}) + \\mathbf{R}_k = (1-\\alpha)\\mathbf{F}(\\mathbf{y}_{k}) + \\mathbf{R}_k$$\n其中余项为 $\\mathbf{R}_k = \\alpha \\int_0^1 \\left[ \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\right] \\Delta\\mathbf{y}_k \\, dt$。\n\n取范数并使用三角不等式：\n$$\\|\\mathbf{F}(\\mathbf{y}_{k+1})\\| \\leq \\|(1-\\alpha)\\mathbf{F}(\\mathbf{y}_{k})\\| + \\|\\mathbf{R}_k\\| = (1-\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| + \\|\\mathbf{R}_k\\|$$\n现在我们对余项的范数 $\\|\\mathbf{R}_k\\|$ 进行放缩：\n$$\\|\\mathbf{R}_k\\| \\leq \\alpha \\int_0^1 \\| \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\| \\|\\Delta\\mathbf{y}_k\\| \\, dt$$\n使用雅可比矩阵的利普希茨连续性 $\\|\\mathbf{J}(\\mathbf{y}) - \\mathbf{J}(\\mathbf{z})\\| \\leq L\\|\\mathbf{y}-\\mathbf{z}\\|$，其中 $\\mathbf{y} = \\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k$ 且 $\\mathbf{z}=\\mathbf{y}_k$：\n$$\\|\\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\| \\leq L \\|t\\alpha\\Delta\\mathbf{y}_k\\| = L t \\alpha \\|\\Delta\\mathbf{y}_k\\|$$\n将此代入 $\\|\\mathbf{R}_k\\|$ 的积分中：\n$$\\|\\mathbf{R}_k\\| \\leq \\alpha \\int_0^1 (L t \\alpha \\|\\Delta\\mathbf{y}_k\\|) \\|\\Delta\\mathbf{y}_k\\| \\, dt = L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2 \\int_0^1 t \\, dt$$\n由于 $\\int_0^1 t \\, dt = \\frac{1}{2}$，我们得到界：\n$$\\|\\mathbf{R}_k\\| \\leq \\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2$$\n我们关于 $\\|\\mathbf{F}(\\mathbf{y}_{k+1})\\|$ 的不等式变为：\n$$\\|\\mathbf{F}(\\mathbf{y}_{k+1})\\| \\leq (1-\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| + \\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2$$\n为满足 Armijo 条件，我们要求此上界小于或等于 $(1-c\\alpha)\\|\\mathbf{F}(\\mathbf{y}_k)\\|$：\n$$(1-\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| + \\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2 \\leq (1-c\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\n整理各项：\n$$\\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2 \\leq (1-c\\alpha - (1-\\alpha))\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = (\\alpha-c\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = \\alpha(1-c)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\n假设 $\\alpha  0$，我们可以两边同除以 $\\alpha$：\n$$\\frac{1}{2} L \\alpha \\|\\Delta\\mathbf{y}_k\\|^2 \\leq (1-c)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\n解出 $\\alpha$ 即可得到由充分下降条件给出的上界：\n$$\\alpha_{\\text{Armijo}} \\leq \\frac{2(1-c)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|}{L\\|\\Delta\\mathbf{y}_k\\|^2}$$\n\n使用所给的数值：$\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = 1.5 \\times 10^{4}$，$\\|\\Delta \\mathbf{y}_{k}\\|^{2} = 9.0 \\times 10^{4}$，$L = 2.0 \\times 10^{3}$，以及 $c = 0.2$。\n$$\\alpha_{\\text{Armijo,max}} = \\frac{2(1-0.2)(1.5 \\times 10^{4})}{(2.0 \\times 10^{3})(9.0 \\times 10^{4})} = \\frac{2(0.8)(1.5 \\times 10^{4})}{1.8 \\times 10^{8}} = \\frac{2.4 \\times 10^{4}}{1.8 \\times 10^{8}}$$\n$$\\alpha_{\\text{Armijo,max}} = \\frac{2.4}{1.8} \\times 10^{-4} = \\frac{4}{3} \\times 10^{-4} \\approx 1.3333 \\times 10^{-4}$$\n\n**3. 最终允许的阻尼因子**\n\n最大允许阻尼因子 $\\alpha$ 必须同时满足两个保障措施。因此，它必须是两个推导出的上界中的最小值：\n$$\\alpha_{\\text{max}} = \\min(\\alpha_{\\text{pos,max}}, \\alpha_{\\text{Armijo,max}})$$\n$$\\alpha_{\\text{max}} = \\min(0.3, 1.3333 \\times 10^{-4}) = 1.3333 \\times 10^{-4}$$\n将结果四舍五入到四位有效数字得到 $0.0001333$。",
            "answer": "$$\\boxed{0.0001333}$$"
        }
    ]
}