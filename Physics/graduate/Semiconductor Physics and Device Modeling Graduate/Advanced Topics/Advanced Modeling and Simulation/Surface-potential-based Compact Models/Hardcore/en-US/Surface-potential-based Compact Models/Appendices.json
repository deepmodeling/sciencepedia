{
    "hands_on_practices": [
        {
            "introduction": "Surface-potential models are powerful, but their accuracy depends on physical parameters extracted from real devices. This practice guides you through a foundational procedure in semiconductor characterization: separating the interface-trap capacitance ($C_{it}$) from the depletion capacitance ($C_{d}$) using experimental Capacitance-Voltage (C-V) data. By numerically inverting the surface potential from high-frequency C-V measurements, you will learn how this central variable connects theoretical models to tangible experimental results .",
            "id": "3776285",
            "problem": "You are tasked with designing and implementing a parameter extraction procedure to separate the interface-trap capacitance per unit area, denoted by $C_{it}$, from the depletion capacitance per unit area, denoted by $C_{d}$, using Capacitance–Voltage (C–V) data and a surface-potential-based inversion across bias and measurement frequency. Your program must use only the provided data and specified physical relations. The final outputs must be expressed in $\\mathrm{F/m^2}$.\n\nFundamental base:\n- For a Metal–Oxide–Semiconductor (MOS) capacitor on a uniformly doped $p$-type semiconductor, the one-dimensional Poisson equation and depletion approximation yield the depletion charge per unit area,\n$$Q_{d}(\\psi_{s}) = \\sqrt{2 q \\varepsilon_{s} N_{A} \\psi_{s}},$$\nwhere $q$ is the elementary charge, $\\varepsilon_{s}$ is the semiconductor permittivity, $N_{A}$ is the acceptor concentration, and $\\psi_{s}$ is the surface potential measured with respect to the bulk.\n- The small-signal depletion capacitance per unit area follows by differentiation,\n$$C_{d}(\\psi_{s}) = \\frac{d Q_{d}}{d \\psi_{s}} = \\frac{\\sqrt{2 q \\varepsilon_{s} N_{A}}}{2 \\sqrt{\\psi_{s}}}.$$\n- The measured gate capacitance per unit area under a given frequency is the series combination of the oxide capacitance per unit area, $C_{ox}$, and the effective semiconductor-side capacitance per unit area. Under high-frequency conditions (traps do not respond), the effective semiconductor-side capacitance equals $C_{d}(\\psi_{s})$, while under low-frequency conditions (traps respond), it equals $C_{d}(\\psi_{s}) + C_{it}(\\psi_{s})$. Denoting the measured capacitance per unit area as $C_{m}$,\n$$\\frac{1}{C_{m,\\text{HF}}} = \\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s})}, \\qquad \\frac{1}{C_{m,\\text{LF}}} = \\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s}) + C_{it}(\\psi_{s})}.$$\n- The gate bias–surface potential relation under high-frequency (negligible trap charge) is\n$$V_{g} = V_{fb} + \\psi_{s} + \\frac{Q_{d}(\\psi_{s})}{C_{ox}},$$\nwhere $V_{fb}$ is the flatband voltage. This relation is used to ensure scientific consistency across bias, but your extraction must pivot on inverting the surface potential from the measured high-frequency series capacitance.\n\nYour tasks:\n1. For each bias point, invert the surface potential $\\,\\psi_{s}\\,$ by solving the nonlinear equation\n$$\\left(\\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s})}\\right)^{-1} - C_{m,\\text{HF}} = 0,$$\nfor $\\,\\psi_{s} \\ge 0\\,$ (depletion/inversion regime).\n2. Using the inverted $\\,\\psi_{s}\\,$, compute $\\,C_{d}(\\psi_{s})\\,$ via the depletion formula above.\n3. From the low-frequency measurement, compute the effective parallel capacitance\n$$C_{\\parallel,\\text{LF}} = \\left(\\frac{1}{C_{m,\\text{LF}}} - \\frac{1}{C_{ox}}\\right)^{-1},$$\nand extract the interface-trap capacitance per unit area at that bias by\n$$C_{it}(\\psi_{s}) = C_{\\parallel,\\text{LF}} - C_{d}(\\psi_{s}).$$\n4. Repeat for all provided bias points and all cases in the test suite.\n\nUse constants:\n- Elementary charge $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$,\n- Vacuum permittivity $\\varepsilon_{0} = 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}$,\n- Silicon permittivity $\\varepsilon_{s} = 11.7 \\varepsilon_{0}$,\n- Oxide permittivity $\\varepsilon_{ox} = 3.9 \\varepsilon_{0}$,\n- Temperature $T = 300\\ \\mathrm{K}$ (thermodynamic contributions are not directly needed in this problem),\n- Oxide thickness $t_{ox} = 3.0 \\times 10^{-9}\\ \\mathrm{m}$, so $C_{ox} = \\varepsilon_{ox}/t_{ox}$,\n- Acceptor concentration $N_{A} = 1.0 \\times 10^{23}\\ \\mathrm{m^{-3}}$,\n- Flatband voltage $V_{fb} = -0.2\\ \\mathrm{V}$.\n\nTest suite:\nFor each case, you are given three gate biases $V_{g}$ with corresponding measured high-frequency and low-frequency capacitances per unit area. All capacitances are in $\\mathrm{F/m^2}$ and voltages in $\\mathrm{V}$.\n\n- Case 1 (moderate traps):\n    - Biases $[V_{g1}, V_{g2}, V_{g3}] = [-0.11454,\\ 0.18678,\\ 0.74190]$,\n    - Measured high-frequency $C_{m,\\text{HF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$,\n    - Measured low-frequency $C_{m,\\text{LF}}$ values: $[0.003526,\\ 0.002164,\\ 0.001718]$.\n- Case 2 (no traps, edge case):\n    - Biases $[V_{g1}, V_{g2}, V_{g3}] = [-0.11454,\\ 0.18678,\\ 0.74190]$,\n    - Measured high-frequency $C_{m,\\text{HF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$,\n    - Measured low-frequency $C_{m,\\text{LF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$.\n- Case 3 (stronger traps):\n    - Biases $[V_{g1}, V_{g2}, V_{g3}] = [-0.11454,\\ 0.18678,\\ 0.74190]$,\n    - Measured high-frequency $C_{m,\\text{HF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$,\n    - Measured low-frequency $C_{m,\\text{LF}}$ values: $[0.004385,\\ 0.003322,\\ 0.002979]$.\n\nRequired output:\n- Compute $C_{it}$ at each bias for each case, express each value in $\\mathrm{F/m^2}$, and round each to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated Python-style nested list, with three inner lists corresponding to the three cases and three elements in each inner list (e.g., $[[c_{11},c_{12},c_{13}],[c_{21},c_{22},c_{23}],[c_{31},c_{32},c_{33}]]]$)$\\,$. No extra text should be printed.\n\nImplementation constraints:\n- You must implement the surface-potential inversion numerically for each bias point using the high-frequency series capacitance equation and the depletion capacitance formula.\n- All outputs must be in $\\mathrm{F/m^2}$.",
            "solution": "The problem has been validated and is deemed valid. It is scientifically grounded in the principles of MOS capacitor physics, specifically the high-frequency/low-frequency C-V method for characterizing interface traps. The problem is well-posed, providing all necessary physical constants, governing equations, and data sets for a unique solution to be determined. The instructions are clear, objective, and lead to a deterministic algorithmic procedure.\n\nThe goal is to extract the interface-trap capacitance per unit area, $C_{it}(\\psi_s)$, for a MOS capacitor at several gate bias points. This is achieved by leveraging the frequency-dependent response of interface traps to a small AC signal. At high frequencies, traps cannot respond, and the measured capacitance is a series combination of the oxide capacitance, $C_{ox}$, and the semiconductor depletion capacitance, $C_d$. At low frequencies, traps can follow the AC signal, adding their capacitance, $C_{it}$, in parallel with $C_d$.\n\nThe procedure commences by defining the physical constants and derived parameters.\nThe elementary charge is $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$.\nThe vacuum permittivity is $\\varepsilon_{0} = 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}$.\nThe relative permittivity of silicon is $\\kappa_s = 11.7$, so $\\varepsilon_{s} = \\kappa_s \\varepsilon_0$.\nThe relative permittivity of silicon dioxide is $\\kappa_{ox} = 3.9$, so $\\varepsilon_{ox} = \\kappa_{ox} \\varepsilon_0$.\nThe oxide thickness is $t_{ox} = 3.0 \\times 10^{-9}\\ \\mathrm{m}$.\nThe acceptor doping concentration is $N_{A} = 1.0 \\times 10^{23}\\ \\mathrm{m^{-3}}$.\n\nFrom these, we calculate the oxide capacitance per unit area:\n$$\nC_{ox} = \\frac{\\varepsilon_{ox}}{t_{ox}} = \\frac{3.9 \\times 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}}{3.0 \\times 10^{-9}\\ \\mathrm{m}} \\approx 0.01151\\ \\mathrm{F/m^2}\n$$\n\nThe core of the extraction method involves the following sequence of calculations for each bias point:\n\nStep 1: Inversion of Surface Potential, $\\psi_s$.\nThe surface potential, $\\psi_s$, is the key independent variable that determines the state of the semiconductor surface. It is not directly measured but must be inferred from the high-frequency capacitance, $C_{m,\\text{HF}}$. The relationship is given by the series capacitance formula:\n$$\nC_{m,\\text{HF}} = \\left(\\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s})}\\right)^{-1}\n$$\nThe depletion capacitance, $C_d(\\psi_s)$, within the depletion approximation, is given by:\n$$\nC_{d}(\\psi_{s}) = \\frac{\\sqrt{2 q \\varepsilon_{s} N_{A}}}{2 \\sqrt{\\psi_{s}}} = \\frac{\\gamma_d}{2 \\sqrt{\\psi_{s}}}\n$$\nwhere we define the constant body-effect parameter $\\gamma_d = \\sqrt{2 q \\varepsilon_{s} N_{A}}$. Combining these equations, we obtain a nonlinear equation for $\\psi_s$:\n$$\nf(\\psi_s) = \\left(\\frac{1}{C_{ox}} + \\frac{2\\sqrt{\\psi_s}}{\\gamma_d}\\right)^{-1} - C_{m,\\text{HF}} = 0\n$$\nSince the problem requires a numerical solution, we will implement a root-finding algorithm (e.g., Brent's method) to solve for $\\psi_s$ for each given $C_{m,\\text{HF}}$ value. The search for $\\psi_s$ is restricted to $\\psi_s > 0$, corresponding to depletion and inversion.\n\nStep 2: Calculation of Depletion Capacitance, $C_d(\\psi_s)$.\nOnce $\\psi_s$ is determined numerically from Step 1, the corresponding depletion capacitance can be calculated directly using its definition:\n$$\nC_{d}(\\psi_{s}) = \\frac{\\gamma_d}{2 \\sqrt{\\psi_s}}\n$$\nAlternatively, one can rearrange the high-frequency capacitance formula to find $C_d$ algebraically, which serves as a consistency check for the found $\\psi_s$:\n$$\nC_d = \\left(\\frac{1}{C_{m,\\text{HF}}} - \\frac{1}{C_{ox}}\\right)^{-1}\n$$\nThe numerical implementation will use the value of $C_d$ derived from the inverted $\\psi_s$ to maintain procedural correctness as per the problem structure.\n\nStep 3: Extraction of Interface-Trap Capacitance, $C_{it}(\\psi_s)$.\nThe low-frequency measured capacitance, $C_{m,\\text{LF}}$, includes the contribution from interface traps. The total semiconductor-side capacitance is $C_{d}(\\psi_s) + C_{it}(\\psi_s)$.\n$$\n\\frac{1}{C_{m,\\text{LF}}} = \\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s}) + C_{it}(\\psi_{s})}\n$$\nFirst, we find the total parallel capacitance on the semiconductor side, which we denote as $C_{\\parallel,\\text{LF}}$:\n$$\nC_{\\parallel,\\text{LF}} = C_{d}(\\psi_{s}) + C_{it}(\\psi_{s}) = \\left(\\frac{1}{C_{m,\\text{LF}}} - \\frac{1}{C_{ox}}\\right)^{-1}\n$$\nFinally, by subtracting the known depletion capacitance $C_d(\\psi_s)$ (calculated in Step 2) from $C_{\\parallel,\\text{LF}}$, we extract the interface-trap capacitance:\n$$\nC_{it}(\\psi_{s}) = C_{\\parallel,\\text{LF}} - C_{d}(\\psi_{s})\n$$\nThis procedure is iterated over all bias points for each test case provided. The final value for $C_{it}$ is rounded to six decimal places as required.\nFor the edge case where no traps are present, $C_{m,\\text{HF}} = C_{m,\\text{LF}}$. This will result in $C_{\\parallel,\\text{LF}} = C_d(\\psi_s)$, yielding $C_{it}(\\psi_s) = 0$, as expected.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the interface-trap capacitance based on C-V data.\n    \"\"\"\n    # Physical Constants\n    Q = 1.602176634e-19  # Elementary charge in C\n    EPS_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    \n    # Material Properties\n    KAPPA_S = 11.7  # Relative permittivity of Silicon\n    KAPPA_OX = 3.9  # Relative permittivity of SiO2\n    T_OX = 3.0e-9  # Oxide thickness in m\n    N_A = 1.0e23   # Acceptor concentration in m^-3\n    \n    # Derived Constants\n    EPS_S = KAPPA_S * EPS_0\n    EPS_OX = KAPPA_OX * EPS_0\n    C_OX = EPS_OX / T_OX\n    \n    # Parameter group for C_d and Q_d calculations\n    GAMMA_D_SQ = 2 * Q * EPS_S * N_A\n    GAMMA_D = np.sqrt(GAMMA_D_SQ)\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1 (moderate traps)\n        {\n            \"biases\": [-0.11454, 0.18678, 0.74190],\n            \"cm_hf\": [0.003014, 0.0014572, 0.0009372],\n            \"cm_lf\": [0.003526, 0.002164, 0.001718]\n        },\n        # Case 2 (no traps, edge case)\n        {\n            \"biases\": [-0.11454, 0.18678, 0.74190],\n            \"cm_hf\": [0.003014, 0.0014572, 0.0009372],\n            \"cm_lf\": [0.003014, 0.0014572, 0.0009372]\n        },\n        # Case 3 (stronger traps)\n        {\n            \"biases\": [-0.11454, 0.18678, 0.74190],\n            \"cm_hf\": [0.003014, 0.0014572, 0.0009372],\n            \"cm_lf\": [0.004385, 0.003322, 0.002979]\n        }\n    ]\n    \n    overall_results = []\n\n    for case in test_cases:\n        case_results = []\n        for i in range(len(case[\"biases\"])):\n            cm_hf = case[\"cm_hf\"][i]\n            cm_lf = case[\"cm_lf\"][i]\n\n            # Step 1: Invert surface potential psi_s\n            # We need to solve f(psi_s) = 0 where\n            # f(psi_s) = (1/C_ox + 1/C_d(psi_s))^-1 - cm_hf = 0\n            # and C_d(psi_s) = gamma_d / (2 * sqrt(psi_s))\n            def get_cm_hf(psi_s):\n                if psi_s = 0:\n                    return C_OX # Avoid division by zero, return max capacitance\n                cd = GAMMA_D / (2 * np.sqrt(psi_s))\n                return (1/C_OX + 1/cd)**-1\n\n            def f_psi_s(psi_s):\n                return get_cm_hf(psi_s) - cm_hf\n            \n            # Use a numerical solver to find psi_s\n            # Lower bound is a small positive number to avoid singularity at psi_s=0\n            # Upper bound is a sufficiently large potential\n            try:\n                psi_s = brentq(f_psi_s, 1e-9, 5.0)\n            except ValueError:\n                # Handle cases where cm_hf is close to or greater than C_ox,\n                # which implies psi_s is very small or zero.\n                psi_s = 0.0\n\n            # Step 2: Compute C_d(psi_s)\n            if psi_s = 0:\n                # This case is not expected with the given data but handle for robustness\n                # In theory C_d -> infinity as psi_s -> 0, but the total capacitance is limited by C_ox\n                # We can calculate C_d via the algebraic relation\n                cd_val = (1/cm_hf - 1/C_OX)**-1\n            else:\n                cd_val = GAMMA_D / (2 * np.sqrt(psi_s))\n            \n            # Step 3: Compute C_it(psi_s)\n            # C_parallel_lf = (1/cm_lf - 1/C_ox)^-1\n            c_parallel_lf = (1/cm_lf - 1/C_OX)**-1\n            \n            # C_it = C_parallel_lf - C_d\n            cit_val = c_parallel_lf - cd_val\n            \n            # Ensure C_it is not negative due to numerical noise\n            if cit_val  0:\n                cit_val = 0.0\n\n            case_results.append(round(cit_val, 6))\n        \n        overall_results.append(case_results)\n\n    # Format the final output string as a Python-style nested list\n    print(f\"[{','.join(map(str, overall_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A robust compact model must provide a single, continuous, and smooth description of the transistor's behavior across all operating regions, from subthreshold to strong inversion. This exercise delves into the mathematical heart of this challenge, asking you to compare two common smoothing functions used to blend region-specific charge expressions. By analyzing their higher-order derivatives, you will gain insight into how these functions ensure the continuity required for accurate simulation of transcapacitance and circuit non-linearity .",
            "id": "3776269",
            "problem": "A central task in surface-potential-based compact models for the Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) is the smooth blending of regime-specific charge expressions to ensure differentiability required by transcapacitance and noise calculations. Consider a normalized gate-bias variable defined by $x$, with $x=0$ representing the transition point between depletion and inversion. Two physically plausible regime-specific charge expressions near $x=0$ are given by $Q_{\\mathrm{inv}}(x)=\\gamma x^{2}$ for inversion and $Q_{\\mathrm{dep}}(x)=\\beta x$ for depletion, where $\\gamma0$ and $\\beta0$ are constants.\n\nTo blend these expressions, define the blended total charge $Q(x)$ using a smoothing function $s(x)$ as\n$$\nQ(x)=s(x)\\,Q_{\\mathrm{inv}}(x)+\\bigl(1-s(x)\\bigr)\\,Q_{\\mathrm{dep}}(x).\n$$\nTwo candidate smoothing functions are\n$$\ns_{t}(x)=\\frac{1}{2}\\left(1+\\tanh\\!\\left(\\frac{x}{\\lambda}\\right)\\right),\\qquad s_{\\ell}(x)=\\frac{1}{1+\\exp\\!\\left(-\\frac{x}{\\alpha}\\right)},\n$$\nwith positive parameters $\\lambda$ and $\\alpha$ controlling the softness of the transition. Let $Q_{t}(x)$ and $Q_{\\ell}(x)$ denote the blended charge constructed with $s_{t}(x)$ and $s_{\\ell}(x)$, respectively.\n\nImpose a fairness constraint that the first derivatives of the smoothing functions at the transition point are equal, i.e.,\n$$\ns_{t}'(0)=s_{\\ell}'(0).\n$$\nStarting from the definitions of the hyperbolic tangent and the logistic function and using only standard differentiation rules, derive the expression for the third derivative of the blended charge at $x=0$ for each smoothing choice, and compute the difference\n$$\n\\Delta = Q_{t}^{(3)}(0)-Q_{\\ell}^{(3)}(0).\n$$\nProvide your final answer as a single real number, dimensionless. No rounding is required, and no units should be used in the final answer.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard problem in semiconductor compact modeling and contains all necessary information for a unique solution.\n\nThe blended total charge $Q(x)$ is defined as:\n$$\nQ(x) = s(x)\\,Q_{\\mathrm{inv}}(x) + \\bigl(1-s(x)\\bigr)\\,Q_{\\mathrm{dep}}(x)\n$$\nSubstituting the given expressions $Q_{\\mathrm{inv}}(x)=\\gamma x^{2}$ and $Q_{\\mathrm{dep}}(x)=\\beta x$:\n$$\nQ(x) = s(x)(\\gamma x^2) + (1-s(x))(\\beta x) = s(x)(\\gamma x^2 - \\beta x) + \\beta x\n$$\nWe need to compute the third derivative of $Q(x)$ at $x=0$, which we denote as $Q^{(3)}(0)$. We will use the product rule for differentiation repeatedly.\n\nThe first derivative of $Q(x)$ is:\n$$\nQ'(x) = \\frac{d}{dx} \\left[ s(x)(\\gamma x^2 - \\beta x) + \\beta x \\right] = s'(x)(\\gamma x^2 - \\beta x) + s(x)(2\\gamma x - \\beta) + \\beta\n$$\n\nThe second derivative of $Q(x)$ is:\n$$\nQ''(x) = \\frac{d}{dx} \\left[ s'(x)(\\gamma x^2 - \\beta x) + s(x)(2\\gamma x - \\beta) + \\beta \\right]\n$$\n$$\nQ''(x) = \\left[ s''(x)(\\gamma x^2 - \\beta x) + s'(x)(2\\gamma x - \\beta) \\right] + \\left[ s'(x)(2\\gamma x - \\beta) + s(x)(2\\gamma) \\right]\n$$\n$$\nQ''(x) = s''(x)(\\gamma x^2 - \\beta x) + 2s'(x)(2\\gamma x - \\beta) + 2\\gamma s(x)\n$$\n\nThe third derivative of $Q(x)$ is:\n$$\nQ^{(3)}(x) = \\frac{d}{dx} \\left[ s''(x)(\\gamma x^2 - \\beta x) + 2s'(x)(2\\gamma x - \\beta) + 2\\gamma s(x) \\right]\n$$\n$$\nQ^{(3)}(x) = \\left[ s^{(3)}(x)(\\gamma x^2 - \\beta x) + s''(x)(2\\gamma x - \\beta) \\right] + \\left[ 2s''(x)(2\\gamma x - \\beta) + 2s'(x)(2\\gamma) \\right] + \\left[ 2\\gamma s'(x) \\right]\n$$\n$$\nQ^{(3)}(x) = s^{(3)}(x)(\\gamma x^2 - \\beta x) + 3s''(x)(2\\gamma x - \\beta) + 4\\gamma s'(x) + 2\\gamma s'(x)\n$$\n$$\nQ^{(3)}(x) = s^{(3)}(x)(\\gamma x^2 - \\beta x) + 3s''(x)(2\\gamma x - \\beta) + 6\\gamma s'(x)\n$$\nEvaluating the third derivative at $x=0$:\n$$\nQ^{(3)}(0) = s^{(3)}(0)(\\gamma (0)^2 - \\beta (0)) + 3s''(0)(2\\gamma (0) - \\beta) + 6\\gamma s'(0)\n$$\n$$\nQ^{(3)}(0) = 0 + 3s''(0)(-\\beta) + 6\\gamma s'(0) = 6\\gamma s'(0) - 3\\beta s''(0)\n$$\nThis expression is general for any smoothing function $s(x)$. Now we must evaluate it for the two specific functions, $s_t(x)$ and $s_\\ell(x)$.\n\nFirst, we analyze the hyperbolic tangent smoothing function $s_t(x)$:\n$$\ns_t(x) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x}{\\lambda}\\right)\\right)\n$$\nIts first derivative is:\n$$\ns_t'(x) = \\frac{1}{2}\\left(\\text{sech}^2\\left(\\frac{x}{\\lambda}\\right)\\right) \\cdot \\frac{1}{\\lambda} = \\frac{1}{2\\lambda}\\text{sech}^2\\left(\\frac{x}{\\lambda}\\right)\n$$\nAt $x=0$, since $\\text{sech}(0)=1$:\n$$\ns_t'(0) = \\frac{1}{2\\lambda}\n$$\nIts second derivative is:\n$$\ns_t''(x) = \\frac{1}{2\\lambda} \\cdot 2\\text{sech}\\left(\\frac{x}{\\lambda}\\right) \\cdot \\left(-\\text{sech}\\left(\\frac{x}{\\lambda}\\right)\\tanh\\left(\\frac{x}{\\lambda}\\right)\\right) \\cdot \\frac{1}{\\lambda} = -\\frac{1}{\\lambda^2}\\text{sech}^2\\left(\\frac{x}{\\lambda}\\right)\\tanh\\left(\\frac{x}{\\lambda}\\right)\n$$\nAt $x=0$, since $\\tanh(0)=0$:\n$$\ns_t''(0) = -\\frac{1}{\\lambda^2}\\text{sech}^2(0)\\tanh(0) = 0\n$$\n\nNext, we analyze the logistic smoothing function $s_\\ell(x)$:\n$$\ns_\\ell(x) = \\frac{1}{1+\\exp\\left(-\\frac{x}{\\alpha}\\right)} = \\left(1+\\exp\\left(-\\frac{x}{\\alpha}\\right)\\right)^{-1}\n$$\nIts first derivative is:\n$$\ns_\\ell'(x) = -1 \\left(1+\\exp\\left(-\\frac{x}{\\alpha}\\right)\\right)^{-2} \\cdot \\exp\\left(-\\frac{x}{\\alpha}\\right) \\cdot \\left(-\\frac{1}{\\alpha}\\right) = \\frac{1}{\\alpha} \\frac{\\exp\\left(-\\frac{x}{\\alpha}\\right)}{\\left(1+\\exp\\left(-\\frac{x}{\\alpha}\\right)\\right)^2}\n$$\nAt $x=0$, since $\\exp(0)=1$:\n$$\ns_\\ell'(0) = \\frac{1}{\\alpha} \\frac{1}{(1+1)^2} = \\frac{1}{4\\alpha}\n$$\nTo find the second derivative, it is convenient to note that $s_\\ell'(x) = \\frac{1}{\\alpha}s_\\ell(x)(1-s_\\ell(x))$. Differentiating this form:\n$$\ns_\\ell''(x) = \\frac{1}{\\alpha} \\left[ s_\\ell'(x)(1-s_\\ell(x)) + s_\\ell(x)(-s_\\ell'(x)) \\right] = \\frac{1}{\\alpha}s_\\ell'(x)(1 - 2s_\\ell(x))\n$$\nAt $x=0$, we have $s_\\ell(0) = (1+\\exp(0))^{-1} = \\frac{1}{2}$.\n$$\ns_\\ell''(0) = \\frac{1}{\\alpha}s_\\ell'(0)\\left(1 - 2s_\\ell(0)\\right) = \\frac{1}{\\alpha}\\left(\\frac{1}{4\\alpha}\\right)\\left(1 - 2\\left(\\frac{1}{2}\\right)\\right) = \\frac{1}{4\\alpha^2}(1-1) = 0\n$$\n\nNow we apply the fairness constraint $s_{t}'(0)=s_{\\ell}'(0)$:\n$$\n\\frac{1}{2\\lambda} = \\frac{1}{4\\alpha} \\implies 4\\alpha = 2\\lambda \\implies \\lambda=2\\alpha\n$$\n\nWe can now compute $Q_t^{(3)}(0)$ and $Q_\\ell^{(3)}(0)$ using the general formula $Q^{(3)}(0) = 6\\gamma s'(0) - 3\\beta s''(0)$.\n\nFor $s_t(x)$:\n$$\nQ_t^{(3)}(0) = 6\\gamma s_t'(0) - 3\\beta s_t''(0) = 6\\gamma \\left(\\frac{1}{2\\lambda}\\right) - 3\\beta(0) = \\frac{3\\gamma}{\\lambda}\n$$\n\nFor $s_\\ell(x)$:\n$$\nQ_\\ell^{(3)}(0) = 6\\gamma s_\\ell'(0) - 3\\beta s_\\ell''(0) = 6\\gamma \\left(\\frac{1}{4\\alpha}\\right) - 3\\beta(0) = \\frac{3\\gamma}{2\\alpha}\n$$\n\nFinally, we compute the difference $\\Delta = Q_{t}^{(3)}(0)-Q_{\\ell}^{(3)}(0)$.\n$$\n\\Delta = \\frac{3\\gamma}{\\lambda} - \\frac{3\\gamma}{2\\alpha}\n$$\nUsing the relationship $\\lambda=2\\alpha$ derived from the constraint:\n$$\n\\Delta = \\frac{3\\gamma}{(2\\alpha)} - \\frac{3\\gamma}{2\\alpha} = 0\n$$\nThe difference is zero. This result stems from the fact that for both symmetric smoothing functions, the second derivative at the transition point is zero, reducing $Q^{(3)}(0)$ to an expression proportional only to $s'(0)$. As the problem constrains $s'(0)$ to be equal for both functions, the resulting third derivatives of the charge, $Q_t^{(3)}(0)$ and $Q_\\ell^{(3)}(0)$, must also be equal.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "The elegance of the surface-potential framework lies in its adaptability to novel device architectures. This hands-on problem challenges you to extend the core surface-potential concept from a simple planar MOSFET to a modern tri-gate FinFET. By modeling the combined gate control and solving the charge-balance equation for this complex geometry, you will implement a complete current calculation, demonstrating how the fundamental principles are applied to predict the behavior of state-of-the-art transistors .",
            "id": "3776249",
            "problem": "A tri-gate Fin Field-Effect Transistor (FinFET) can be modeled within the surface-potential-based compact modeling framework by combining the gate control from the top and sidewall gates and solving for the surface potential distribution along the channel. Consider a long-channel, isothermal, n-channel FinFET fabricated on a uniformly doped p-type silicon body. The fin has top width $W_{\\text{fin}}$ and height $H_{\\text{fin}}$, and the top gate and sidewall gates are separated from the silicon by silicon dioxide of thicknesses $t_{\\text{ox,top}}$ and $t_{\\text{ox,side}}$, respectively. All three gates are biased at the same gate-to-source voltage $V_{\\text{GS}}$, and the drain-to-source voltage is $V_{\\text{DS}}$. The source is at $0\\,\\text{V}$ and the drain at $V_{\\text{DS}}$. The flatband voltage is $V_{\\text{FB}}$. Assume uniform electron mobility $\\mu$, negligible series resistance, and negligible velocity saturation.\n\nStarting from the following fundamental base:\n\n- Gauss's law and boundary conditions at the oxide–semiconductor interface imply that the net semiconductor charge per unit length along the channel, denoted $Q_{s}^{\\ell}(x)$, satisfies\n$$\nQ_{s}^{\\ell}(x) = -C_{\\text{ox,eff}}^{\\ell}\\,\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}(x)\\big),\n$$\nwhere $C_{\\text{ox,eff}}^{\\ell}$ is the effective oxide capacitance per unit channel length that aggregates the top and sidewall contributions, and $\\psi_{s}(x)$ is the local surface potential at position $x$ along the channel.\n- The net semiconductor charge per unit length can be decomposed as\n$$\nQ_{s}^{\\ell}(x) = W_{\\text{eff}}\\,\\big(Q_{\\text{dep}}(\\psi_{s}(x)) + Q_{\\text{inv}}(\\psi_{s}(x),V(x))\\big),\n$$\nwhere $W_{\\text{eff}} = W_{\\text{fin}} + 2H_{\\text{fin}}$ is the effective perimeter controlling inversion, $Q_{\\text{dep}}$ is the depletion charge per unit area due to holes, and $Q_{\\text{inv}}$ is the inversion electron charge per unit area at the surface. The local channel potential is $V(x)$, with $V(0)=0$ and $V(L)=V_{\\text{DS}}$, and $L$ is the channel length.\n- The depletion charge per unit area $Q_{\\text{dep}}(\\psi_{s})$ follows from the one-dimensional Poisson–Boltzmann equation in the p-type body with acceptor density $N_{A}$, Boltzmann statistics, and the potential reference set in the quasi-neutral bulk. The inversion charge per unit area $Q_{\\text{inv}}(\\psi_{s},V)$ follows from the electron density at the surface and a physically motivated centroid approximation based on the Debye length.\n- The drain current can be obtained from the drift current relation under the charge-sheet approximation:\n$$\nI_{D} = \\frac{\\mu}{L}\\int_{0}^{V_{\\text{DS}}}\\big(-Q_{\\text{inv}}^{\\ell}(V)\\big)\\,\\mathrm{d}V,\n$$\nwhere $Q_{\\text{inv}}^{\\ell}(V) = W_{\\text{eff}}\\,Q_{\\text{inv}}(\\psi_{s}(V),V)$ and $\\psi_{s}(V)$ is the surface potential at the location where the local channel potential is $V$.\n\nUse the following modeling steps, expressed in purely mathematical and logical terms:\n\n1. Compute the effective oxide capacitance per unit channel length by an effective width approach that adds the top and sidewall contributions:\n$$\nC_{\\text{ox,eff}}^{\\ell} = \\varepsilon_{\\text{ox}}\\left(\\frac{W_{\\text{fin}}}{t_{\\text{ox,top}}} + \\frac{2H_{\\text{fin}}}{t_{\\text{ox,side}}}\\right),\n$$\nwhere $\\varepsilon_{\\text{ox}}$ is the permittivity of silicon dioxide.\n2. For each local channel potential $V\\in[0,V_{\\text{DS}}]$, solve the implicit surface-potential equation\n$$\nC_{\\text{ox,eff}}^{\\ell}\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}\\big) + W_{\\text{eff}}\\big(Q_{\\text{dep}}(\\psi_{s}) + Q_{\\text{inv}}(\\psi_{s},V)\\big) = 0\n$$\nfor $\\psi_{s}$.\n3. Use a depletion charge per unit area based on the one-dimensional Poisson–Boltzmann solution in p-type silicon at temperature $T$:\n$$\nQ_{\\text{dep}}(\\psi_{s}) = -\\sqrt{2\\,\\varepsilon_{\\text{si}}\\,q\\,N_{A}\\,\\phi_{t}}\\;\\sqrt{\\psi_{s}/\\phi_{t} + e^{-\\psi_{s}/\\phi_{t}} - 1},\n$$\nfor $\\psi_{s}\\ge 0$, and set $Q_{\\text{dep}}(\\psi_{s})=0$ for $\\psi_{s}0$, where $\\varepsilon_{\\text{si}}$ is the silicon permittivity, $q$ is the elementary charge, and $\\phi_{t} = k_{B}T/q$ is the thermal voltage with $k_{B}$ the Boltzmann constant.\n4. Use an inversion charge per unit area defined from the surface electron density and the Debye length centroid approximation:\n$$\nn_{s}(\\psi_{s},V) = \\frac{n_{i}^{2}}{N_{A}}\\,e^{(\\psi_{s}-V)/\\phi_{t}},\\quad L_{D}(\\psi_{s},V) = \\sqrt{\\frac{\\varepsilon_{\\text{si}}\\,\\phi_{t}}{q\\,n_{s}(\\psi_{s},V)}},\n$$\n$$\nQ_{\\text{inv}}(\\psi_{s},V) = -q\\,n_{s}(\\psi_{s},V)\\,L_{D}(\\psi_{s},V) = -\\sqrt{\\varepsilon_{\\text{si}}\\,q\\,n_{s}(\\psi_{s},V)\\,\\phi_{t}},\n$$\nwhere $n_{i}$ is the intrinsic carrier concentration of silicon.\n5. After determining $\\psi_{s}(V)$ over $V\\in[0,V_{\\text{DS}}]$, compute the drain current by numerical quadrature of the drift current relation.\n\nConstants to use:\n- Elementary charge $q = 1.602176634\\times 10^{-19}\\,\\text{C}$.\n- Vacuum permittivity $\\varepsilon_{0} = 8.854187817\\times 10^{-12}\\,\\text{F/m}$.\n- Silicon permittivity $\\varepsilon_{\\text{si}} = 11.7\\,\\varepsilon_{0}$.\n- Silicon dioxide permittivity $\\varepsilon_{\\text{ox}} = 3.9\\,\\varepsilon_{0}$.\n- Boltzmann constant $k_{B} = 1.380649\\times 10^{-23}\\,\\text{J/K}$.\n- Temperature $T = 300\\,\\text{K}$.\n- Intrinsic concentration $n_{i} = 1.45\\times 10^{16}\\,\\text{m}^{-3}$.\n\nYour task:\n- Implement a program that carries out the above modeling steps, solves for the surface potential distribution $\\psi_{s}(V)$ along the channel by root-finding for each local potential $V$, and computes $I_{D}$ by integrating the inversion charge along the channel using the drift relation.\n- Express the final drain current $I_{D}$ in amperes (A) as floating-point numbers.\n\nTest suite (each test case is a tuple of parameters in SI units):\n- Case 1 (general operation, near linear region): $(W_{\\text{fin}}=20\\times 10^{-9},\\,H_{\\text{fin}}=40\\times 10^{-9},\\,t_{\\text{ox,top}}=1.2\\times 10^{-9},\\,t_{\\text{ox,side}}=1.2\\times 10^{-9},\\,L=50\\times 10^{-9},\\,N_{A}=5.0\\times 10^{22},\\,\\mu=0.05,\\,V_{\\text{GS}}=0.8,\\,V_{\\text{DS}}=0.05,\\,V_{\\text{FB}}=0.0)$.\n- Case 2 (saturation-like high drain bias): $(W_{\\text{fin}}=20\\times 10^{-9},\\,H_{\\text{fin}}=40\\times 10^{-9},\\,t_{\\text{ox,top}}=1.2\\times 10^{-9},\\,t_{\\text{ox,side}}=1.2\\times 10^{-9},\\,L=50\\times 10^{-9},\\,N_{A}=5.0\\times 10^{22},\\,\\mu=0.05,\\,V_{\\text{GS}}=0.8,\\,V_{\\text{DS}}=0.8,\\,V_{\\text{FB}}=0.0)$.\n- Case 3 (subthreshold gate bias): $(W_{\\text{fin}}=20\\times 10^{-9},\\,H_{\\text{fin}}=40\\times 10^{-9},\\,t_{\\text{ox,top}}=1.2\\times 10^{-9},\\,t_{\\text{ox,side}}=1.2\\times 10^{-9},\\,L=50\\times 10^{-9},\\,N_{A}=5.0\\times 10^{22},\\,\\mu=0.05,\\,V_{\\text{GS}}=0.2,\\,V_{\\text{DS}}=0.8,\\,V_{\\text{FB}}=0.0)$.\n- Case 4 (sidewall-dominant geometry, different oxides): $(W_{\\text{fin}}=8\\times 10^{-9},\\,H_{\\text{fin}}=60\\times 10^{-9},\\,t_{\\text{ox,top}}=1.5\\times 10^{-9},\\,t_{\\text{ox,side}}=0.8\\times 10^{-9},\\,L=30\\times 10^{-9},\\,N_{A}=1.0\\times 10^{23},\\,\\mu=0.03,\\,V_{\\text{GS}}=0.8,\\,V_{\\text{DS}}=0.5,\\,V_{\\text{FB}}=0.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the computed drain currents for the four test cases as a comma-separated list enclosed in square brackets, for example, \"[I1,I2,I3,I4]\". Each $I_{k}$ must be in amperes (A) as a floating-point number.",
            "solution": "The user has provided a problem statement that details a surface-potential-based compact model for a tri-gate FinFET and asks for an implementation to calculate the drain current for several test cases.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\nThe problem provides a comprehensive set of givens, including:\n- **Device structure and parameters:** FinFET geometry ($W_{\\text{fin}}$, $H_{\\text{fin}}$), oxide thicknesses ($t_{\\text{ox,top}}$, $t_{\\text{ox,side}}$), channel length ($L$).\n- **Material parameters:** Doping concentration ($N_{A}$), electron mobility ($\\mu$), intrinsic carrier concentration ($n_{i}$).\n- **Operating conditions:** Gate-to-source voltage ($V_{\\text{GS}}$), drain-to-source voltage ($V_{\\text{DS}}$), flatband voltage ($V_{\\text{FB}}$).\n- **Physical constants:** $q$, $\\varepsilon_0$, $\\varepsilon_{\\text{si}}$, $\\varepsilon_{\\text{ox}}$, $k_B$, $T$.\n- **Model equations:** A complete set of equations is provided for the effective oxide capacitance ($C_{\\text{ox,eff}}^{\\ell}$), the implicit surface potential equation, the depletion charge ($Q_{\\text{dep}}$), the inversion charge ($Q_{\\text{inv}}$), and the drain current ($I_D$) integral.\n- **Test cases:** Four distinct sets of parameters are provided to test the implementation.\n\n**Step 2: Validation of Givens**\nA critical examination of the givens leads to the following assessment:\n1.  **Scientifically Grounded:** The problem is firmly rooted in established semiconductor device physics. The use of a surface-potential-based model, the charge balance equation derived from Gauss's law, and the drift-current integral (Pao-Sah integral) are all standard concepts in MOSFET modeling. The specific expressions for depletion and inversion charge are physically motivated simplifications common in compact models (e.g., PSP, BSIM). The physical constants and parameter ranges are realistic for modern semiconductor devices.\n2.  **Well-Posed:** The core of the problem is to solve the a non-linear, implicit equation for the surface potential $\\psi_s$. An analysis of the implicit function, $F(\\psi_s) = C_{\\text{ox,eff}}^{\\ell}\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}\\big) + W_{\\text{eff}}\\big(Q_{\\text{dep}}(\\psi_{s}) + Q_{\\text{inv}}(\\psi_{s},V)\\big) = 0$, reveals that it is continuous and strictly monotonic with respect to $\\psi_s$. The function tends to $+\\infty$ as $\\psi_s \\to -\\infty$ and to $-\\infty$ as $\\psi_s \\to +\\infty$. Therefore, by the Intermediate Value Theorem, a unique root for $\\psi_s$ exists for any given set of physical parameters and local channel potential $V$. The subsequent integration to find the drain current is a standard numerical procedure on a well-behaved function.\n3.  **Objective:** The problem is stated in precise, quantitative, and unambiguous mathematical and physical terms, free from any subjective or biased language.\n4.  **Self-Contained and Consistent:** All necessary equations, parameters, and constants are provided. The modeling steps are logically ordered and internally consistent.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. It is a well-posed, scientifically sound, and self-contained task representative of a standard problem in computational nanoelectronics and compact model development. Therefore, a solution will be provided.\n\n### Solution Derivation\n\nThe solution follows the five modeling steps prescribed in the problem statement. The core of the task is to numerically compute the drain current integral:\n$$\nI_{D} = \\frac{\\mu}{L}\\int_{0}^{V_{\\text{DS}}}\\big(-Q_{\\text{inv}}^{\\ell}(V)\\big)\\,\\mathrm{d}V\n$$\nTo evaluate the integrand, $-Q_{\\text{inv}}^{\\ell}(V)$, at any given local channel potential $V \\in [0, V_{\\text{DS}}]$, we must first determine the corresponding surface potential, $\\psi_s(V)$.\n\n**1. Constants and Derived Parameters**\nFirst, we establish the physical constants and compute the thermal voltage $\\phi_t = k_B T / q$, silicon permittivity $\\varepsilon_{\\text{si}}$, and silicon dioxide permittivity $\\varepsilon_{\\text{ox}}$. For each test case, we compute the geometry-dependent parameters: the effective electrical width $W_{\\text{eff}}$ and the effective oxide capacitance per unit length $C_{\\text{ox,eff}}^{\\ell}$.\n$$\nW_{\\text{eff}} = W_{\\text{fin}} + 2H_{\\text{fin}}\n$$\n$$\nC_{\\text{ox,eff}}^{\\ell} = \\varepsilon_{\\text{ox}}\\left(\\frac{W_{\\text{fin}}}{t_{\\text{ox,top}}} + \\frac{2H_{\\text{fin}}}{t_{\\text{ox,side}}}\\right)\n$$\n\n**2. Surface Potential Calculation**\nThe surface potential $\\psi_s$ is determined by the charge balance equation, which equates the gate-controlled charge with the total semiconductor charge. This yields the implicit equation for $\\psi_s$:\n$$\nF(\\psi_s, V) = C_{\\text{ox,eff}}^{\\ell}\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}\\big) + W_{\\text{eff}}\\big(Q_{\\text{dep}}(\\psi_{s}) + Q_{\\text{inv}}(\\psi_{s},V)\\big) = 0\n$$\nThe charge components are defined as:\n- Depletion charge per unit area, for $\\psi_s \\ge 0$:\n$$\nQ_{\\text{dep}}(\\psi_{s}) = -\\sqrt{2\\,\\varepsilon_{\\text{si}}\\,q\\,N_{A}\\,\\phi_{t}}\\;\\sqrt{\\psi_{s}/\\phi_{t} + e^{-\\psi_{s}/\\phi_{t}} - 1}\n$$\n- Inversion charge per unit area:\n$$\nQ_{\\text{inv}}(\\psi_{s},V) = -\\sqrt{\\varepsilon_{\\text{si}}\\,q\\,\\phi_{t}\\,\\frac{n_{i}^{2}}{N_{A}}} \\cdot e^{(\\psi_{s}-V)/(2\\phi_{t})}\n$$\nThis implicit equation $F(\\psi_s, V)=0$ must be solved numerically for $\\psi_s$ for each value of $V$ required by the numerical integration routine. As established in the validation, $F(\\psi_s, V)$ is a monotonic function of $\\psi_s$, making it ideally suited for a robust root-finding algorithm like the Brent-Dekker method.\n\n**3. Drain Current Integration**\nWith a method to find $\\psi_s(V)$, we can define the integrand for the drain current calculation:\n$$\n\\text{Integrand}(V) = -Q_{\\text{inv}}^{\\ell}(V) = -W_{\\text{eff}}\\,Q_{\\text{inv}}(\\psi_s(V), V)\n$$\nThe procedure to evaluate this integrand at a potential $V$ is:\na. Solve $F(\\psi_s, V) = 0$ to find the root $\\psi_s(V)$.\nb. Substitute this $\\psi_s(V)$ into the expression for $Q_{\\text{inv}}(\\psi_s, V)$.\nc. Multiply by $-W_{\\text{eff}}$.\n\nThe total drain current $I_D$ is then computed by performing a numerical quadrature (integration) of this integrand function over the interval $V \\in [0, V_{\\text{DS}}]$ and multiplying by the mobility-length factor $\\mu/L$. A standard adaptive quadrature algorithm, such as the one provided by SciPy's `quad` function, is suitable for this task.\n\n**4. Implementation Strategy**\nThe overall algorithm for each test case is a nested numerical procedure:\n- An **outer routine** performs the numerical integration of the channel charge with respect to the local potential $V$ from source ($0$) to drain ($V_{\\text{DS}}$).\n- An **inner routine**, called by the outer integration routine for each point $V$, performs a root-finding search to solve the implicit equation for the surface potential $\\psi_s(V)$.\n\nThis structured approach ensures a correct and robust implementation of the specified surface-potential-based model. The final program will encapsulate this logic, iterate through the given test cases, and produce the required formatted output.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve for the drain current in a FinFET for given test cases.\n    \"\"\"\n    # Physical Constants in SI units\n    Q = 1.602176634e-19  # Elementary charge (C)\n    EPS0 = 8.854187817e-12 # Vacuum permittivity (F/m)\n    KB = 1.380649e-23     # Boltzmann constant (J/K)\n    T = 300.0             # Temperature (K)\n    \n    # Material Parameters (Silicon)\n    NI = 1.45e16          # Intrinsic carrier concentration (m^-3) at 300K\n    EPS_SI_REL = 11.7     # Relative permittivity of Silicon\n    EPS_OX_REL = 3.9      # Relative permittivity of SiO2\n    \n    EPS_SI = EPS_SI_REL * EPS0\n    EPS_OX = EPS_OX_REL * EPS0\n    \n    # Derived Constants\n    PHI_T = KB * T / Q    # Thermal voltage (V)\n\n    # Test cases from the problem statement\n    # (W_fin, H_fin, t_ox_top, t_ox_side, L, N_A, mu, V_GS, V_DS, V_FB)\n    test_cases = [\n        (20e-9, 40e-9, 1.2e-9, 1.2e-9, 50e-9, 5.0e22, 0.05, 0.8, 0.05, 0.0),\n        (20e-9, 40e-9, 1.2e-9, 1.2e-9, 50e-9, 5.0e22, 0.05, 0.8, 0.8, 0.0),\n        (20e-9, 40e-9, 1.2e-9, 1.2e-9, 50e-9, 5.0e22, 0.05, 0.2, 0.8, 0.0),\n        (8e-9, 60e-9, 1.5e-9, 0.8e-9, 30e-9, 1.0e23, 0.03, 0.8, 0.5, 0.0),\n    ]\n\n    def compute_drain_current(params):\n        \"\"\"\n        Computes the drain current for a single set of device parameters.\n        \"\"\"\n        W_fin, H_fin, t_ox_top, t_ox_side, L, N_A, mu, V_GS, V_DS, V_FB = params\n\n        # Step 1: Compute effective width and capacitance\n        W_eff = W_fin + 2 * H_fin\n        C_ox_eff_l = EPS_OX * (W_fin / t_ox_top + 2 * H_fin / t_ox_side)\n\n        # Pre-calculate constant factors for charge models to optimize\n        q_dep_factor = -np.sqrt(2 * EPS_SI * Q * N_A * PHI_T)\n        q_inv_factor = -np.sqrt(EPS_SI * Q * PHI_T * (NI**2 / N_A))\n\n        # Step 3: Define depletion charge function Q_dep(psi_s)\n        def q_dep(psi_s):\n            if psi_s  0:\n                return 0.0\n            \n            # The term under the square root is always non-negative\n            term = psi_s / PHI_T + np.exp(-psi_s / PHI_T) - 1.0\n            return q_dep_factor * np.sqrt(term)\n\n        # Step 4: Define inversion charge function Q_inv(psi_s, V)\n        def q_inv(psi_s, V):\n            return q_inv_factor * np.exp((psi_s - V) / (2 * PHI_T))\n\n        # Step 2: Define the implicit equation F(psi_s, V) = 0\n        def implicit_eq(psi_s, V):\n            lhs = C_ox_eff_l * (V_GS - V_FB - psi_s)\n            rhs = W_eff * (q_dep(psi_s) + q_inv(psi_s, V))\n            return lhs + rhs\n\n        # Step 5: Define the integrand for the drain current integral\n        def integrand(V):\n            # Inner loop: find psi_s for a given V using a root-finder\n            try:\n                # A robust search interval for psi_s that brackets the root\n                psi_s_root = brentq(\n                    lambda psi: implicit_eq(psi, V),\n                    a=-1.0, \n                    b=V_GS - V_FB + 2.0 * PHI_T + 1.0\n                )\n            except ValueError:\n                # Brentq fails if the root is not bracketed. This indicates an issue.\n                # In this well-behaved problem, this should not happen.\n                return 0.0\n            \n            # Calculate total inversion charge per unit length\n            q_inv_l = W_eff * q_inv(psi_s_root, V)\n            return -q_inv_l\n\n        # Outer loop: numerically integrate the charge along the channel\n        integral_val, _ = quad(integrand, 0, V_DS)\n\n        # Final drain current\n        I_D = (mu / L) * integral_val\n        return I_D\n\n    results = []\n    for case in test_cases:\n        I_D = compute_drain_current(case)\n        results.append(I_D)\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}