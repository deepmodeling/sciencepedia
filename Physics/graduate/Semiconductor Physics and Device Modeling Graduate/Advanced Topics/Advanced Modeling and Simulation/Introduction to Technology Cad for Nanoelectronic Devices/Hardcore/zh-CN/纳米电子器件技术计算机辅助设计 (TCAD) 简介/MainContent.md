## 引言
随着半导体技术迈入纳米尺度，器件的设计与优化面临着前所未有的挑战。物理效应日益复杂，制造成本急剧攀升，传统的“试错”式研发方法已难以为继。在此背景下，技术[计算机辅助设计](@entry_id:157566)（T[CAD](@entry_id:157566)）应运而生，它通过强大的物理仿真来预测和分析器件的电学行为，已成为连接基础物理与尖端工程、加速创新周期的核心工具。

然而，从微米到纳米的跨越带来了一个关键的知识鸿沟：经典的漂移-扩散模型虽在宏观尺度上卓有成效，却无法描述在现代晶体管中日益显著的[量子限制](@entry_id:136238)、隧穿和弹道输运等效应。如何构建一个能够涵盖从经典到量子行为的统一仿真框架，并将其应用于解决实际工程问题，是当前器件工程师和研究人员面临的核心课题。

本文旨在系统性地介绍用于纳米电子器件的T[CAD](@entry_id:157566)。我们将通过三个章节的递进式学习，为读者构建一个完整的知识体系。在“原理与机制”一章中，我们将深入探讨支撑TCAD的半经典及量子物理模型，以及将其转化为可计算问题的核心数值方法。随后的“应用与跨学科连接”一章将展示这些理论如何应用于[FinFET设计](@entry_id:1124955)、应变工程、[可靠性分析](@entry_id:192790)等前沿领域，凸显T[CAD](@entry_id:157566)作为[多物理场](@entry_id:164478)和跨学科研究平台的价值。最后，“动手实践”部分将提供具体的编程练习，帮助读者将理论知识转化为实践能力。

现在，让我们从支撑整个TCAD大厦的基石——核心物理原理与数值机制开始。

## 原理与机制

本章旨在深入阐述支撑现代纳米电子器件技术[计算机辅助设计](@entry_id:157566)（TCAD）的核心物理原理与数值机制。我们将从经典的[半经典输运](@entry_id:1131436)模型出发，系统性地探讨其数值求解方法，并逐步过渡到处理纳米尺度下量子效应所必需的更高级的理论框架。本章的[组织结构](@entry_id:146183)将引导读者从宏观的连续介质模型，深入到微观的量子力学描述，并最终接触到该领域最为前沿和普适的计算方法。

### 半经典核心：漂移-扩散模型

任何[器件仿真](@entry_id:1123622)的基础都始于对内部电场和载流子行为的精确描述。在大多数微米及亚微米尺度的半导体器件中，漂移-扩散（Drift-Diffusion, DD）模型提供了兼具物理精确性和计算可行性的黄金标准。该模型由一组耦合的[偏微分](@entry_id:194612)方程构成，即泊松方程（Poisson's equation）和载流子[连续性方程](@entry_id:195013)（carrier continuity equations）。

#### 基本方程组与符号约定

我们从基本物理定律出发，建立这套方程组。考虑一个可能包含体积内[电子-空穴对产生](@entry_id:149555)和复合的通用、非均匀半导体区域。

首先，物质中的高斯定律（Gauss's law）描述了电荷与电场之间的关系。该定律的微分形式为 $\nabla \cdot \mathbf{D} = \rho$，其中 $\mathbf{D}$ 是[电位移矢量](@entry_id:197092)，$\rho$ 是净[自由电荷](@entry_id:264392)密度。在线性各向同性介质中，$\mathbf{D} = \varepsilon \mathbf{E}$，其中 $\varepsilon$ 是介[电常数](@entry_id:272823)，$\mathbf{E}$ 是电场。根据[静电势](@entry_id:188370) $\phi$ 的定义，电场是其梯度的负值，即 $\mathbf{E} = - \nabla \phi$（这意味着电场指向电势降低的方向）。将这些关系式联立，我们得到泊松方程：
$$
\nabla \cdot (\varepsilon \mathbf{E}) = \rho \implies \nabla \cdot (-\varepsilon \nabla \phi) = \rho \implies \nabla \cdot (\varepsilon \nabla \phi) = - \rho
$$
在[掺杂半导体](@entry_id:1123927)中，净[自由电荷](@entry_id:264392)密度 $\rho$ 由四部分贡献：带正电的空穴（浓度为 $p$），带负电的电子（浓度为 $n$），电离后带正电的[施主杂质](@entry_id:1123914)（浓度为 $N_D^+$），以及电离后带负电的[受主杂质](@entry_id:157874)（浓度为 $N_A^-$）。若定义 $q$ 为基本电荷的大小（一个正数），则总[电荷密度](@entry_id:144672)为：
$$
\rho = q (p - n + N_D^+ - N_A^-)
$$
因此，泊松方程的完整形式为 $\nabla \cdot (\varepsilon \nabla \phi) = -q (p - n + N_D^+ - N_A^-)$。

其次，载流子的输运由粒子数守恒定律支配。对于任意一种粒子，其[局域守恒](@entry_id:751393)关系为 $\frac{\partial c}{\partial t} + \nabla \cdot \mathbf{F} = S$，其中 $c$ 是粒子浓度，$\mathbf{F}$ 是[粒子通量](@entry_id:753207)密度（单位面积单位时间通过的粒子数），$S$ 是单位体积的净产生率。对于电子和空穴，我们有：
$$
\frac{\partial n}{\partial t} + \nabla \cdot \mathbf{F}_n = G - R, \qquad \frac{\partial p}{\partial t} + \nabla \cdot \mathbf{F}_p = G - R
$$
其中 $G \ge 0$ 和 $R \ge 0$ 分别是[电子-空穴对](@entry_id:142506)的体积产生率和[复合率](@entry_id:203271)。注意，一次成对的产生或复合事件会同时影响一个电子和一个空穴，因此它们的净产生率相同。

为了将粒子守恒与电学测量联系起来，我们引入电流密度。根据惯例，电流方向定义为正电荷流动的方向。由于电子携带电荷 $-q$，其电流密度 $\mathbf{J}_n$ 与其粒子通量 $\mathbf{F}_n$ 方向相反。而空穴携带电荷 $+q$，其电流密度 $\mathbf{J}_p$ 与其[粒子通量](@entry_id:753207) $\mathbf{F}_p$ 方向相同：
$$
\mathbf{J}_n = -q \mathbf{F}_n, \qquad \mathbf{J}_p = +q \mathbf{F}_p
$$
将粒子[守恒方程](@entry_id:1122898)两边乘以相应的电荷，我们得到电荷的[连续性方程](@entry_id:195013)。在[稳态](@entry_id:139253)（steady-state）条件下，各项对时间的[偏导数](@entry_id:146280)为零（$\partial n / \partial t = 0$, $\partial p / \partial t = 0$），我们得到：
$$
\nabla \cdot \mathbf{J}_n = -q (\nabla \cdot \mathbf{F}_n) = -q(G-R) = q(R-G)
$$
$$
\nabla \cdot \mathbf{J}_p = +q (\nabla \cdot \mathbf{F}_p) = q(G-R)
$$
这一对方程的物理意义是清晰的：在[稳态](@entry_id:139253)下，如果一个区域内载流子净产生（$G > R$），那么必须有净电流流出该区域以维持电荷平衡。具体来说，电子电流的散度为负（$q(R-G)  0$），意味着电子电荷净流出；空穴电流的散度为正（$q(G-R)  0$），意味着空穴电荷净流出。这套符号约定和方程形式构成了T[CAD](@entry_id:157566)中半经典仿真的基石 。

为了封闭整个方程组，我们还需要描述电流密度 $\mathbf{J}_n$ 和 $\mathbf{J}_p$ 如何依赖于局域的电势和[载流子浓度](@entry_id:143028)。这由[本构关系](@entry_id:186508)（constitutive relations）给出，在漂移-[扩散模型](@entry_id:142185)中，电流由两部分组成：由电场驱动的**漂移**和由浓度梯度驱动的**扩散**。

### [数值离散化](@entry_id:752782)：从[偏微分](@entry_id:194612)方程到代数方程组

[漂移-扩散方程](@entry_id:136261)组是一组[非线性](@entry_id:637147)的耦合[偏微分](@entry_id:194612)方程，无法通过解析方法求解真实器件的复杂几何结构。因此，[数值离散化](@entry_id:752782)是TCAD的核心步骤。其目标是将连续的方程转化为可在计算机上求解的代数方程组。主要有三种方法：有限差分法（FDM）、[有限元法](@entry_id:749389)（FEM）和[有限体积法](@entry_id:141374)（FVM）。

#### [空间离散化](@entry_id:172158)方法的选择

考虑一个具有不规则几何形状和多种[材料界面](@entry_id:751731)的现代半导体器件，例如[FinFET](@entry_id:264539)。在这种复杂情况下，方法的选择至关重要。
*   **[有限差分法](@entry_id:1124968)**在结构化矩形网格上易于实现，但难以处理不规则边界和弯曲界面，容易引入阶梯状近似误差。
*   **[有限元法](@entry_id:749389)**具有出色的几何灵活性，能很好地适应复杂形状。它通过[变分原理](@entry_id:198028)（弱形式）求解，通常能获得高精度的解。然而，标准的连续Galerkin[有限元法](@entry_id:749389)在本质上保证的是全局守恒，而非单元级别的局域[电荷守恒](@entry_id:264158)。
*   **[有限体积法](@entry_id:141374)**，特别是围绕网格顶点的“[盒积](@entry_id:177480)分”（box integration）方法，在T[CAD](@entry_id:157566)中被广泛采用。该方法直接从积分形式的守恒定律出发，将求解域划分为一系列互不重叠的控制体积（control volumes）。对每个控制体积应用[散度定理](@entry_id:143110)，可以确保通过相邻控制体积界面的通量精确相等。这使得离散后的方程天然满足局域[电荷守恒](@entry_id:264158)，这对于精确计算流过器件的电流至关重要。此外，FVM能够稳健地处理材料参数（如介[电常数](@entry_id:272823) $\varepsilon$）在界面处的[不连续性](@entry_id:144108)，并自然地将[混合边界条件](@entry_id:176456)（如[绝缘边界](@entry_id:162724)的[零通量条件](@entry_id:182067)）整合为控制体表面的通量项。这些优良特性使其成为[耦合输运](@entry_id:144035)方程求解的理想选择 。

#### Scharfetter-Gummel 格式

在[有限体积法](@entry_id:141374)框架下，一个核心挑战是如何精确计算穿过控制体积交界面的载流子通量。以电子连续性方程为例，其本质是一个对流-扩散方程（电场引起的漂移项为对流项，浓度梯度引起的扩散项为扩散项）。当电场很强时（漂移占主导），简单的数值格式（如中心差分）会产生非物理的[数值振荡](@entry_id:163720)，甚至导致[载流子浓度](@entry_id:143028)为负。

为了解决这个问题，Scharfetter和Gummel在1969年提出了一种巧妙的格式。该方法假设在两个相邻网格点之间，电场和迁移率是常数，然后解析地求解一维的[稳态电流](@entry_id:276565)方程。这得到一个指数形式的通量表达式，即**Scharfetter-Gummel（SG）格式**。对于连接节点 $P$ 和 $N$ 的界面 $f$，其电子电流可以表示为：
$$
I_{n,f} = q A_f \frac{D_{n,f}}{\delta_f} \left[ \mathcal{B}(\xi_f) n_P - \mathcal{B}(-\xi_f) n_N \right]
$$
其中 $A_f$ 是界面面积，$\delta_f$ 是节点间距，$D_{n,f}$ 是界面上的[有效扩散系数](@entry_id:1124178)。关键在于引入了伯努利函数 $\mathcal{B}(\xi) = \frac{\xi}{e^{\xi} - 1}$，其[自变量](@entry_id:267118) $\xi_f = \frac{\phi_P - \phi_N}{V_T}$ 是节点间的[电势差](@entry_id:275724)相对于[热电压](@entry_id:267086) $V_T = k_B T/q$ 的无量纲量。

SG格式的优越性在于它能自动适应不同的输运机制：
*   当电势差远小于[热电压](@entry_id:267086)（$\xi_f \to 0$，扩散主导）时，$\mathcal{B}(\xi_f) \to 1$，该格式退化为稳定的[中心差分格式](@entry_id:1122205)。
*   当电势差远大于[热电压](@entry_id:267086)（$|\xi_f| \to \infty$，漂移主导）时，该格式退化为一个稳定的迎风（upwind）格式，能有效抑制[数值振荡](@entry_id:163720)。

由于其在任意电场强度下都能保持[数值稳定性](@entry_id:175146)和物理真实性（保证[载流子浓度](@entry_id:143028)为正），SG格式成为了半导体器件T[CAD](@entry_id:157566)模拟中离散化载流子连续性方程的标准方法 。

### 求[解耦](@entry_id:160890)合系统：[非线性](@entry_id:637147)迭代策略

经过离散化后，我们得到一个庞大的、耦合的[非线性](@entry_id:637147)代数方程组，其变量是网格节点上的电势 $\phi$ 和[载流子浓度](@entry_id:143028) $n, p$。求解这个系统是T[CAD](@entry_id:157566)仿真的计算核心。两种主流的策略是Gummel[解耦](@entry_id:160890)法和全耦合Newton法。

#### Gummel [解耦](@entry_id:160890)法

Gummel[解耦](@entry_id:160890)法（也称[块高斯-赛德尔法](@entry_id:746881)）是一种直观且实现相对简单的迭代方法。其基本思想是“分而治之”：将耦合的方程组[解耦](@entry_id:160890)，对每个物理量（电势、[电子浓度](@entry_id:190764)、空穴浓度）进行顺序求解，并在每一步中使用其他物理量的最新计算结果。一个典型的Gummel迭代循环如下：

1.  给定当前的[载流子浓度](@entry_id:143028) $n^{(k)}$ 和 $p^{(k)}$，求解（线性的）泊松方程，得到新的电势分布 $\phi^{(k+1)}$。
2.  使用更新后的电势 $\phi^{(k+1)}$ 和旧的空穴浓度 $p^{(k)}$，求解电子连续性方程，得到新的电子浓度 $n^{(k+1)}$。
3.  使用更新后的电势 $\phi^{(k+1)}$ 和[电子浓度](@entry_id:190764) $n^{(k+1)}$，求解空穴[连续性方程](@entry_id:195013)，得到新的空穴浓度 $p^{(k+1)}$。
4.  重复此过程，直到所有变量收敛。

Gummel法的优点在于每次只需求解一个较小的、通常是线性的（如泊松方程）或弱[非线性](@entry_id:637147)的方程组，内存需求较低，且对于初始猜测值不佳的情况通常比较稳健。然而，由于它忽略了方程之间的强耦合（即[雅可比矩阵](@entry_id:178326)的非对角块），其[收敛速度](@entry_id:636873)是线性的 。

#### 全耦合 Newton 法

全耦合Newton法（或称块Newton法）则将整个方程组 $F(U) = 0$（其中 $U = (\phi, n, p)$）视为一个单一的[非线性系统](@entry_id:168347)。在每次迭代中，它通过求解一个大型的[线性方程组](@entry_id:148943)来计算所有未知量的更新量 $\delta U_k$：
$$
J(U_k) \delta U_k = -F(U_k)
$$
其中 $J = \partial F / \partial U$ 是包含所有变量之间相互依赖关系的**全[雅可比矩阵](@entry_id:178326)**。例如，它包含了[复合率](@entry_id:203271)对电子和空穴浓度的[偏导数](@entry_id:146280) $\partial R/\partial n$ 和 $\partial R/\partial p$。

全耦合Newton法的主要优势在于，当初始猜测足够接近解时，它具有**二次收敛**速度，远快于Gummel法。此外，由于它在每次迭代中都精确地考虑了所有物理量之间的耦合，因此在方程间耦合非常强的物理场景下（例如，有强烈的雪崩产生或[Shockley-Read-Hall复合](@entry_id:263615)的器件）表现得更为稳健和高效。其缺点是需要构建和求解一个更大、更复杂的[雅可比矩阵](@entry_id:178326)，计算成本和内存需求更高。

在实际的TCAD工作流程中，这两种方法通常与**[全局化策略](@entry_id:177837)**结合使用，以提高求解的稳健性。例如，当从一个已知的解（如零偏压下的[热平衡](@entry_id:157986)态）过渡到一个新的、相差很远的解（如高偏压[工作点](@entry_id:173374)）时，直接求解可能会失败。此时，可以采用**连续法**（continuation method），即逐步地、小幅度地增加偏压，并将上一个偏压点的解作为下一个偏压点的初始猜测值。这种“电压扫描”或“[参数扫描](@entry_id:1129336)”的方法极大地扩展了[非线性求解器](@entry_id:177708)的[收敛半径](@entry_id:143138)，是现代TCAD不可或缺的一部分 。

### 进入量子力学领域：[纳米器件](@entry_id:1128399)的模拟

随着器件尺寸进入纳米尺度，一系列经典物理无法描述的量子效应变得至关重要。TCAD必须引入更高级的物理模型来捕捉这些现象。

#### 载流子统计：Fermi-Dirac 与 Maxwell-Boltzmann

第一个需要重新审视的经典近似是载流子统计。在非简并（non-degenerate）半导体中（即掺杂浓度较低或温度较高），可以假设导带底的量子态绝大多数是空的。在这种“稀疏”极限下，描述粒子能量分布的**Fermi-Dirac（FD）分布**可以简化为经典的**Maxwell-Boltzmann（MB）分布**。

FD分布函数为 $f(E) = \frac{1}{1 + \exp((E - F)/(k_B T))}$，其中 $F$ 是[费米能](@entry_id:143977)级。当能量 $E$ 远大于[费米能](@entry_id:143977)级 $F$ 时（即 $E-F \gg k_B T$），分母中的指数项远大于1，FD分布近似为 $f(E) \approx \exp(-(E - F)/(k_B T))$，这正是MB分布的形式。

在T[CAD](@entry_id:157566)中，是否可以使用计算上更简单的MB近似，取决于[费米能](@entry_id:143977)级 $F$ 相对于导带边 $E_c$ 的位置。我们可以定义一个无量纲的简约[费米能](@entry_id:143977)级 $\eta_c = (F - E_c)/(k_B T)$。通过对电子浓度积分的[级数展开](@entry_id:142878)分析可以发现，MB近似的相对误差主要由 $e^{\eta_c}$ 项决定。为了使误差低于5%，需要满足 $\eta_c \lesssim -2$，即[费米能](@entry_id:143977)级必须位于导带边下方至少 $2 k_B T$ 处 。

反之，当半导体高度掺杂或在低温下工作时，[费米能](@entry_id:143977)级会进入导带内部（$\eta_c  0$），导致导带底附近的量子态被大量占据。这种情况称为**简并**（degenerate）。一个实用的强简并判据是 $\eta_c \gtrsim 3$，此时导带边的占据概率超过95%。在这种情况下，MB近似会带来巨大误差，必须使用完整的FD统计来计算[载流子浓度](@entry_id:143028) 。

#### 弹道输运与[Landauer-Büttiker公式](@entry_id:141644)

当器件的有效沟道长度远小于载流子的平均自由程时，载流子在穿过沟道时几乎不与[晶格](@entry_id:148274)或杂质发生随机散射。这种输运模式被称为**弹道输运**（ballistic transport）。在此情形下，漂移-[扩散模型](@entry_id:142185)中基于局域散射和弛豫的核心假设失效。

描述弹道输运的理论框架是**Landauer-Büttiker**方法。该方法将器件视为一个相干的散射体，连接着两个作为理想粒子源和粒子阱的大型电极（源极和漏极）。电流的产生不被视为沟道内的漂移和扩散，而是由源漏两端[费米能](@entry_id:143977)级差驱动的、穿过器件的净[粒子流](@entry_id:753205)。

对于一个有两个电极（源S和漏D）、考虑自旋简并的器件，其[稳态电流](@entry_id:276565)由[Landauer公式](@entry_id:147869)给出：
$$
I = \frac{2q}{h} \int T(E) \big[f_S(E) - f_D(E)\big] dE
$$
其中 $h$ 是普朗克常数，$T(E)$ 是能量为 $E$ 的电子从源极成功穿透到漏极的**透射几率**（transmission probability），$f_S(E)$ 和 $f_D(E)$ 分别是源极和漏极的[Fermi-Dirac分布](@entry_id:138909)函数。这个公式优雅地将量子力学（体现在透射几率$T(E)$中）和统计力学（体现在费米函数之差中）结合在一起。它是一个非局域的模型，电流取决于整个器件的透射特性以及电极的全局状态，与漂移-扩散模型的局域性形成鲜明对比 。

在小偏压、低温极限下，如果一个导电通道是完全开放的（$T(E)=1$），[Landauer公式](@entry_id:147869)预言其电导 $G = dI/dV$ 将量子化为 $G_0 = \frac{2q^2}{h}$，即**量子化电导**，这是弹道输运的一个标志性特征 。

#### 量子限制与Schrödinger-Poisson模型

在诸如超薄体SOI、[FinFET](@entry_id:264539)和[纳米线晶体管](@entry_id:1128420)等现代器件中，载流子在一个或多个维度上被限制在纳米尺度的空间内。这种**[量子限制](@entry_id:136238)**（quantum confinement）效应使得载流子在受限方向上的能量不再是连续的，而是量子化为一系列分立的能级，形成所谓的**[子带](@entry_id:154462)**（subbands）。这不仅改变了[态密度](@entry_id:147894)，还导致了载流子[波函数](@entry_id:201714)的空间重新分布（例如，在MOSFET的反型层中，电荷峰值会离开界面），从而深刻影响器件的电容、阈值电压和输运特性。

为了精确地模拟这些效应，需要求[解耦](@entry_id:160890)合的**Schrödinger-Poisson（SP）方程组**。以一个沿 $z$ 轴方向延伸的纳米线为例，其[横截面](@entry_id:154995)为 $(x,y)$ 平面上的有界区域 $\Omega$。该模型将三维问题[解耦](@entry_id:160890)：

1.  **横向Schrödinger方程**：在 $(x,y)$ [横截面](@entry_id:154995)内，求解单电子的[定态](@entry_id:137260)Schrödinger方程。这里的势能项 $V(x,y) = E_c(x,y) - q\phi(x,y)$ 由材料的导带边和自洽计算出的静电势 $\phi(x,y)$ 共同决定。
    $$
    \Big[-\partial_x\Big(\frac{\hbar^2}{2 m_x^*}\partial_x\Big) -\partial_y\Big(\frac{\hbar^2}{2 m_y^*}\partial_y\Big) + E_c - q\phi(x,y)\Big]\psi_n(x,y) = E_n^\perp\psi_n(x,y)
    $$
    该方程的解是一系列本征能量 $E_n^\perp$（子带底能量）和对应的本征[波函数](@entry_id:201714) $\psi_n(x,y)$。对于被无限高势垒（硬墙限制）包围的纳米线，[波函数](@entry_id:201714)在边界上为零 。

2.  **电子密度计算**：每个子带 $n$ 构成一个沿 $z$ 轴自由传播的一维通道，其[能量色散关系](@entry_id:145014)为 $E(n, k_z) = E_n^\perp + \frac{\hbar^2 k_z^2}{2 m_z^*}$。通过对所有子带沿 $z$ 轴的[连续态](@entry_id:197473)进行积分，并用Fermi-Dirac统计填充，可以得到每个子带的[线密度](@entry_id:158735) $\lambda_n$。总的二维电子[面密度](@entry_id:1121098)则通过对所有子带的贡献求和得到：
    $$
    n(x,y) = \sum_n |\psi_n(x,y)|^2 \lambda_n
    $$
    其中 $\lambda_n$ 本身是一个积分表达式，依赖于 $E_n^\perp$ 和全局[费米能](@entry_id:143977)级 $\mu$ 。

3.  **二维泊松方程**：计算出的电子密度 $n(x,y)$ 作为源项，代入[横截面](@entry_id:154995)上的泊松方程，以求解静电势 $\phi(x,y)$。
    $$
    -\nabla_\perp \cdot (\varepsilon \nabla_\perp \phi(x,y)) = -q n(x,y) + q(N_D - N_A)
    $$
    方程的边界条件由器件结构决定，例如在栅电极上为给定的电压（[Dirichlet条件](@entry_id:137096)），在绝缘界面上为零法向电场（Neumann条件）。

由于电势 $\phi$ 决定了[波函数](@entry_id:201714) $\psi_n$，而[波函数](@entry_id:201714)又决定了电子密度 $n$，电子密度反过来又决定了电势，这三者构成了一个**[自洽循环](@entry_id:138158)**。求解SP方程组通常采用类似于Gummel法的迭代方案：从一个初始的电势猜测出发，求解Schrödinger方程得到能级和[波函数](@entry_id:201714)，然后计算电子密度，再用此密度求解泊松方程得到新的电势，如此循环往复。为了保证这个迭代过程的收敛，特别是在电荷响应强烈的区域，必须引入**[收敛加速](@entry_id:165787)技术**，最常用的是对电势更新进行线性混合或称为**[欠松弛](@entry_id:756302)**（under-relaxation）：
$$
\phi^{(k+1)}(x) = (1-\alpha)\,\phi^{(k)}(x) + \alpha\,\tilde{\phi}^{(k+1)}(x), \quad 0  \alpha  1
$$
其中 $\phi^{(k)}$ 是旧电势，$\tilde{\phi}^{(k+1)}$ 是由泊松方程新解出的电势，$\alpha$ 是混合因子。这种混合可以有效抑制迭代过程中的振荡，确保最终达到自洽解 。

### 高级与实用量[子模](@entry_id:148922)型

虽然Schrödinger-Poisson模型能够精确地描述[量子限制效应](@entry_id:184087)，但求解[本征值问题](@entry_id:142153)在计算上是昂贵的，尤其对于三维器件。因此，T[CAD](@entry_id:157566)领域发展了一系列替代模型，旨在以更高的效率捕捉关键的量子现象。

#### 密度梯度量子修正

**密度梯度（Density-Gradient, DG）模型**是一种在半经典漂移-扩散框架内引入[量子限制效应](@entry_id:184087)的巧妙方法。其核心思想是，[量子限制效应](@entry_id:184087)可以等效地被看作是一个额外的“[量子势](@entry_id:193380)”，它将载流子推离势能的尖锐壁垒处（如Si/SiO2界面）。DG模型通过在载流子的化学势中增加一个依赖于载流子密度梯度的修正项 $\Lambda_n$ 来模拟这个[量子势](@entry_id:193380)。

一个广泛使用的DG修正在形式上与密度的对数的拉普拉斯算子成正比：
$$
\Lambda_n = - b \frac{\hbar^2}{m_n^*} \nabla^2 (\ln n)
$$
其中 $b$ 是一个通常接近 $1/12$ 的校准系数。这个修正项被加到经典的导带边上，形成一个有效的导带边 $E_{c, \text{eff}} = E_c + \Lambda_n$。在[载流子密度](@entry_id:143028)急剧变化（$\nabla^2 (\ln n)$ 很大）的界面附近，$\Lambda_n$ 会显著抬高有效能带，从而将电荷分布的峰值推离界面，并提高载流子的基态能量，这定性地再现了SP模型的结果。

[DG方法](@entry_id:748369)的巨大优势在于它是一个**局域模型**，修正项在每个网格点上都可以直接由该点及其近邻的密度值计算得出，完全避免了求解Schrödinger方程这样的本征值问题。这使得它可以无缝地集成到现有的、高效的漂移-扩散求解器中。其代价是，DG模型是一个[近似理论](@entry_id:138536)，其参数（如系数$b$）通常需要通过与更精确的SP模型或实验数据进行对比来**校准**，以获得定量的准确性 。

#### [非平衡格林函数](@entry_id:144847)（NEGF）方法

在[量子输运](@entry_id:138932)理论的顶端，是**[非平衡格林函数](@entry_id:144847)（Non-Equilibrium Green's Function, NEGF）方法**。这是一个功能极其强大的形式体系，能够统一地处理从弹道输运到散射主导输运的各种情况，并能自然地包含量子限制、隧穿和多体效应（如[电子-声子散射](@entry_id:138098)）。

在NEGF框架中，器件的核心由一个哈密顿顿矩阵 $H$ 描述。器件与外部电极（源S和漏D）的连接被模型化为**[自能](@entry_id:145608)（self-energies）**矩阵 $\Sigma_S(E)$ 和 $\Sigma_D(E)$。这些自能是复数且依赖于能量，其虚部描述了粒子通过电极逃[逸出](@entry_id:141194)器件的速率。

系统的核心物理量是**[推迟格林函数](@entry_id:139183)（[retarded Green's function](@entry_id:139183)）** $G^R(E)$，它是[开放系统](@entry_id:147845)有效哈密顿顿的逆：
$$
G^R(E) = \left[(E+i\eta) I - H - \Sigma_S(E) - \Sigma_D(E)\right]^{-1}
$$
其中 $I$ 是单位矩阵，$\eta$ 是一个无穷小的正数。$G^R(E)$ 包含了关于器件[能谱](@entry_id:181780)和[波函数](@entry_id:201714)的所有信息。另一个重要的量是**超前[格林函数](@entry_id:147802)（advanced Green's function）** $G^A(E) = (G^R(E))^\dagger$。

与电极的[耦合强度](@entry_id:275517)由**展宽函数（broadening functions）** $\Gamma_\alpha(E)$ 量化，它与自能的虚部直接相关：
$$
\Gamma_\alpha(E) = i\left[\Sigma_\alpha(E) - \Sigma_\alpha^\dagger(E)\right]
$$
$\Gamma_\alpha(E)$ 是一个[厄米矩阵](@entry_id:155147)，代表了能量为 $E$ 的电子态与电极 $\alpha$ 之间的耦合速率。

利用这些量，两端器件的电流可以通过[Meir-Wingreen公式](@entry_id:142884)计算。在相干输运（无[非弹性散射](@entry_id:138624)）的极限下，该公式简化为我们已经见过的Landauer-Büttiker形式，但此时的透射几率 $T(E)$ 有一个具体的矩阵表达式：
$$
T(E) = \mathrm{Tr}\left[\Gamma_S(E) G^R(E) \Gamma_D(E) G^A(E)\right]
$$
最终的电流表达式为：
$$
I = \frac{2q}{h} \int \mathrm{Tr}\left[\Gamma_S(E) G^R(E) \Gamma_D(E) G^A(E)\right] \left[f_S(E) - f_D(E)\right] dE
$$
NEGF不仅为弹道输运提供了一个严格的微观基础，其完整的形式还允许通过引入额外的散射自能来处理各种[非弹性散射](@entry_id:138624)过程，使其成为模拟真正纳米尺度器件的终极工具 。