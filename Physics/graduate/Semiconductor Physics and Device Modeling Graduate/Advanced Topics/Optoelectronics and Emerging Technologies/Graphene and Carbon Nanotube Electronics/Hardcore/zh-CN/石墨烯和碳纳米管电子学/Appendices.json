{
    "hands_on_practices": [
        {
            "introduction": "在探索任何半导体材料的电子特性时，一个基本出发点是理解其本征载流子浓度。这个练习将指导你从第一性原理出发，推导石墨烯中的本征载流子浓度，并揭示其与传统半导体有何不同。通过这个计算，你将亲身体会到石墨烯独特的线性色散关系如何影响其宏观电子性质，并能定量比较热激发载流子与衬底掺杂效应的重要性。",
            "id": "3751324",
            "problem": "将化学势为零的单层石墨烯放置在二氧化硅上，二氧化硅被建模为一种衬底，它会引入一个大小为 $n_{d} = 5.0 \\times 10^{11}\\,\\mathrm{cm}^{-2}$ 的外在掺杂电荷密度。将石墨烯中的低能准粒子视为具有各向同性线性色散关系 $E = \\hbar v_{F} |k|$ 的无质量 Dirac 费米子，其中 $v_{F}$ 是费米速度，并考虑自旋和谷简并。假设系统在温度 $T$ 下处于热平衡状态，并使用费米-狄拉克统计。从二维波矢空间中的第一性原理态计数以及电子数密度由态密度和费米-狄拉克占据数定义的公式出发，推导在零化学势下的本征电子密度 $n_{i}(T)$。然后，使用 $v_{F} = 1.00 \\times 10^{6}\\,\\mathrm{m/s}$、$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$ 和 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$，在 $T = 300\\,\\mathrm{K}$ 时计算 $n_{i}$ 的值，并计算无量纲比值 $R = n_{i} / n_{d}$。将最终比值 $R$ 四舍五入到三位有效数字。$n_{i}$ 以 $\\mathrm{cm}^{-2}$ 为单位表示，但最终答案只报告比值 $R$。",
            "solution": "该问题要求推导单层石墨烯的本征电子密度 $n_i(T)$，并随后进行数值计算，以求得其与给定外在掺杂密度 $n_d$ 的比值。\n\n首先，我们进行问题验证。\n**第一步：提取已知条件**\n- 系统：二氧化硅衬底上的单层石墨烯。\n- 本征情况下的化学势：$\\mu=0$。\n- 外在掺杂电荷密度：$n_{d} = 5.0 \\times 10^{11}\\,\\mathrm{cm}^{-2}$。\n- 低能色散关系：$E = \\hbar v_{F} |k|$，其中 $|k|$ 是波矢 $\\vec{k}$ 的模。\n- 费米速度：$v_{F} = 1.00 \\times 10^{6}\\,\\mathrm{m/s}$。\n- 简并度：自旋简并 ($g_s=2$) 和谷简并 ($g_v=2$)。\n- 温度：$T = 300\\,\\mathrm{K}$。\n- 统计规律：费米-狄拉克统计。\n- 约化普朗克常数：$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了一个用于石墨烯中低能准粒子（无质量 Dirac 费米子）的标准且成熟的模型。色散关系、物理常数以及温度和掺杂密度等参数都是符合实际且表述正确的。任务提法恰当，为从第一性原理到具体数值结果提供了清晰的路径。语言客观而精确。问题是自洽的，没有矛盾。\n\n**第三步：结论与行动**\n问题有效。我们开始求解。\n\n推导从确定态密度 (DOS) $g(E)$ 开始。在面积为 $A=L_x L_y$ 的二维晶体中，允许的波矢在 k 空间中形成一个网格。k 空间中对应于单个态的面积是 $(\\frac{2\\pi}{L_x})(\\frac{2\\pi}{L_y}) = \\frac{(2\\pi)^2}{A}$。\n\n在 k 空间中，从半径 $k$ 到 $k+dk$ 的无穷薄环带内的态数 $dN$ 是环带的面积 $2\\pi k \\, dk$ 除以单位态的面积。我们还必须考虑总简并因子 $g = g_s g_v$。石墨烯的自旋简并度为 $g_s=2$，谷简并度为 $g_v=2$（在布里渊区的 $K$ 点和 $K'$ 点），因此总简并度为 $g=4$。\n\n$$dN = g \\frac{A}{(2\\pi)^2} (2\\pi k \\, dk) = 4 \\frac{A}{4\\pi^2} (2\\pi k \\, dk) = \\frac{2A}{\\pi} k \\, dk$$\n\n单位面积的态密度 $g(E)$ 定义为 $g(E) = \\frac{1}{A} \\frac{dN}{dE}$。根据导带（$E \\ge 0$）的线性色散关系，我们有 $E = \\hbar v_F k$，这意味着 $k = \\frac{E}{\\hbar v_F}$ 且 $dk = \\frac{dE}{\\hbar v_F}$。\n\n将这些代入 $dN$ 的表达式中：\n$$dN = \\frac{2A}{\\pi} \\left(\\frac{E}{\\hbar v_F}\\right) \\left(\\frac{dE}{\\hbar v_F}\\right) = \\frac{2A E}{\\pi (\\hbar v_F)^2} dE$$\n\n那么导带的态密度为：\n$$g(E) = \\frac{1}{A} \\frac{dN}{dE} = \\frac{2E}{\\pi (\\hbar v_F)^2}$$\n态密度对能量的这种线性依赖关系是石墨烯的一个标志性特征。\n\n导带中的电子密度 $n$ 是通过将态密度与费米-狄拉克占据概率 $f(E, \\mu, T)$ 的乘积从导带底（$E=0$）积分到无穷大而得到的。\n$$n(T, \\mu) = \\int_0^\\infty g(E) f(E, \\mu, T) \\, dE$$\n其中 $f(E, \\mu, T) = \\frac{1}{\\exp\\left(\\frac{E-\\mu}{k_B T}\\right) + 1}$。\n\n对于本征情况，化学势位于狄拉克点，因此 $\\mu = 0$。因此，本征电子密度 $n_i(T)$ 为：\n$$n_i(T) = n(T, \\mu=0) = \\int_0^\\infty \\frac{2E}{\\pi (\\hbar v_F)^2} \\frac{1}{\\exp\\left(\\frac{E}{k_B T}\\right) + 1} \\, dE$$\n\n为了求解这个积分，我们进行变量替换。令 $x = \\frac{E}{k_B T}$。这得到 $E = x k_B T$ 和 $dE = k_B T \\, dx$。\n$$n_i(T) = \\int_0^\\infty \\frac{2(x k_B T)}{\\pi (\\hbar v_F)^2} \\frac{1}{\\exp(x) + 1} (k_B T \\, dx)$$\n$$n_i(T) = \\frac{2(k_B T)^2}{\\pi (\\hbar v_F)^2} \\int_0^\\infty \\frac{x}{\\exp(x) + 1} \\, dx$$\n\n这个定积分是一种与黎曼 zeta 函数 $\\zeta(s)$ 相关的标准形式。该积分的值为 $\\int_0^\\infty \\frac{x}{\\exp(x)+1} dx = \\frac{\\pi^2}{12}$。\n\n将此结果代回 $n_i(T)$ 的表达式中：\n$$n_i(T) = \\frac{2(k_B T)^2}{\\pi (\\hbar v_F)^2} \\left( \\frac{\\pi^2}{12} \\right) = \\frac{\\pi}{6} \\left( \\frac{k_B T}{\\hbar v_F} \\right)^2$$\n这就是推导出的石墨烯中本征电子密度的解析表达式。\n\n接下来，我们使用给定的常数，在 $T=300\\,\\mathrm{K}$ 时对 $n_i(T)$ 进行数值计算。\n热能为：\n$$k_B T = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (300\\,\\mathrm{K}) = 4.141947 \\times 10^{-21}\\,\\mathrm{J}$$\n$\\hbar v_F$ 项为：\n$$\\hbar v_F = (1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}) \\times (1.00 \\times 10^{6}\\,\\mathrm{m/s}) = 1.054571817 \\times 10^{-28}\\,\\mathrm{J\\,m}$$\n现在我们计算括号内的无量纲比值：\n$$\\frac{k_B T}{\\hbar v_F} = \\frac{4.141947 \\times 10^{-21}\\,\\mathrm{J}}{1.054571817 \\times 10^{-28}\\,\\mathrm{J\\,m}} \\approx 3.92760 \\times 10^7\\,\\mathrm{m}^{-1}$$\n对该值求平方：\n$$\\left( \\frac{k_B T}{\\hbar v_F} \\right)^2 \\approx (3.92760 \\times 10^7\\,\\mathrm{m}^{-1})^2 \\approx 1.54260 \\times 10^{15}\\,\\mathrm{m}^{-2}$$\n现在，我们以 $\\mathrm{m}^{-2}$ 为单位计算 $n_i$：\n$$n_i(300\\,\\mathrm{K}) = \\frac{\\pi}{6} \\left( \\frac{k_B T}{\\hbar v_F} \\right)^2 \\approx \\frac{\\pi}{6} (1.54260 \\times 10^{15}\\,\\mathrm{m}^{-2}) \\approx 8.0770 \\times 10^{14}\\,\\mathrm{m}^{-2}$$\n题目以 $\\mathrm{cm}^{-2}$ 为单位给出了 $n_d$，因此我们必须将 $n_i$ 转换为相同单位。由于 $1\\,\\mathrm{m} = 100\\,\\mathrm{cm}$，所以 $1\\,\\mathrm{m}^2 = 10^4\\,\\mathrm{cm}^2$，这意味着 $1\\,\\mathrm{m}^{-2} = 10^{-4}\\,\\mathrm{cm}^{-2}$。\n$$n_i(300\\,\\mathrm{K}) \\approx (8.0770 \\times 10^{14}) \\times (10^{-4}\\,\\mathrm{cm}^{-2}) = 8.0770 \\times 10^{10}\\,\\mathrm{cm}^{-2}$$\n\n最后，我们计算无量纲比值 $R = \\frac{n_i}{n_d}$。\n$$R = \\frac{8.0770 \\times 10^{10}\\,\\mathrm{cm}^{-2}}{5.0 \\times 10^{11}\\,\\mathrm{cm}^{-2}} = \\frac{8.0770}{50} \\approx 0.16154$$\n按照要求，将结果四舍五入到三位有效数字：\n$$R \\approx 0.162$$\n这个比值表明，在室温下，由热激发产生的本征载流子浓度是特定水平外在掺杂所引入的载流子浓度的相当大一部分（约 $16\\%$）。",
            "answer": "$$\\boxed{0.162}$$"
        },
        {
            "introduction": "理解了载流子的统计分布后，下一步是研究它们的动力学行为，特别是它们如何通过势垒。这个实践将引导你直面石墨烯中最奇特也最深刻的现象之一：克莱因隧穿 (Klein tunneling)。通过直接求解狄拉克方程并与传统的薛定谔方程结果进行对比，你将发现石墨烯中相对论性载流子如何能够完美地穿透任意高度的势垒，这与我们熟知的量子隧穿现象截然不同。",
            "id": "3751283",
            "problem": "考虑一个单层石墨烯片，其低能行为由单谷、单自旋的无质量狄拉克哈密顿量 $H = v_{F}\\,\\boldsymbol{\\sigma}\\cdot\\boldsymbol{p} + V(x)$ 描述，其中 $v_{F}$ 是费米速度，$\\boldsymbol{\\sigma} = (\\sigma_{x},\\sigma_{y})$ 是作用在子晶格赝自旋上的泡利矩阵，而 $V(x)$ 是一个仅依赖于 $x$ 的静电势。一个高度为 $V_{0} > 0$、宽度为 $d > 0$ 的矩形势垒定义为：当 $x  0$ 时，$V(x) = 0$；当 $0 \\le x \\le d$ 时，$V(x) = V_{0}$；当 $x > d$ 时，$V(x) = 0$。一个能量为 $E$（满足 $0  E  V_{0}$）的电子从 $x  0$ 处以正入射（横向动量为零）的方式入射。\n\n仅使用狄拉克方程、各个区域中的平面波解，以及双分量旋量在 $x=0$ 和 $x=d$ 界面处的连续性条件，推导出在正入射情况下穿过势垒的透射概率 $T_{G}(E,V_{0},d)$。\n\n作为对比，考虑一个二维电子气中的非相对论电子，其有效质量为 $m$，遵循具有相同矩形势垒 $V(x)$ 的不含时薛定谔方程，并具有相同的入射能量 $E$（满足 $0  E  V_{0}$）和正入射条件。仅使用薛定谔方程、各个区域中的平面波解和渐逝解，以及标量波函数及其导数在 $x=0$ 和 $x=d$ 界面处的连续性条件，推导出穿过势垒的透射概率 $T_{S}(E,V_{0},d,m)$。\n\n定义比值 $R(E,V_{0},d,m) \\equiv T_{G}(E,V_{0},d)/T_{S}(E,V_{0},d,m)$。请以 $E$、$V_{0}$、$d$、$m$、$\\hbar$ 和 $v_{F}$ 的单一闭合形式解析表达式给出您的最终答案。无需进行数值计算。比值 $R$ 是无量纲的；请勿在最终答案中包含单位。",
            "solution": "用户希望我解决一个凝聚态物理中的两部分问题，具体是比较电子在石墨烯和标准二维电子气（2DEG）中穿过势垒的输运过程。\n\n**第一部分：石墨烯的透射**\n1.  **问题陈述：** 一个在单层石墨烯中的电子，由无质量狄拉克哈密顿量 $H = v_{F}\\,\\boldsymbol{\\sigma}\\cdot\\boldsymbol{p} + V(x)$ 描述，正入射到一个矩形势垒上。\n2.  **已知条件：**\n    *   哈密顿量: $H = v_{F}\\,\\boldsymbol{\\sigma}\\cdot\\boldsymbol{p} + V(x)$\n    *   $\\boldsymbol{\\sigma} = (\\sigma_{x},\\sigma_{y})$ 是泡利矩阵。\n    *   势垒: 当 $0 \\le x \\le d$ 时，$V(x) = V_{0}$，其他情况 $V(x) = 0$。\n    *   入射能量: $0  E  V_0$。\n    *   入射方式：正入射，意味着横向动量 $k_y = 0$。\n    *   目标：推导透射概率 $T_G(E, V_0, d)$。\n\n**第二部分：薛定谔情况下的透射**\n1.  **问题陈述：** 一个在二维电子气中的非相对论电子，由薛定谔方程描述，正入射到同一个势垒上。\n2.  **已知条件：**\n    *   控制方程：不含时薛定谔方程。\n    *   有效质量: $m$。\n    *   势垒：与第一部分相同。\n    *   入射能量: $0  E  V_0$。\n    *   入射方式：正入射，意味着横向动量 $k_y = 0$。\n    *   目标：推导透射概率 $T_S(E, V_0, d, m)$。\n\n**第三部分：比值**\n1.  **目标：** 求出比值 $R(E, V_0, d, m) = T_G / T_S$。\n2.  最终答案应为 $R$ 的一个单一闭合表达式，以给定参数表示。\n\n**分步验证**\n\n1.  **提取已知条件：**\n    *   石墨烯模型：哈密顿量 $H = v_{F}\\,\\boldsymbol{\\sigma}\\cdot\\boldsymbol{p} + V(x)$，单谷、单自旋、无质量狄拉克模型。\n    *   薛定谔模型：不含时薛定谔方程，有效质量 $m$。\n    *   势：当 $x  0$ 时，$V(x) = 0$；当 $0 \\le x \\le d$ 时，$V(x) = V_{0}$；当 $x > d$ 时，$V(x) = 0$。\n    *   参数：费米速度 $v_F$，势垒高度 $V_0 > 0$，势垒宽度 $d > 0$。\n    *   能量条件：$0  E  V_0$。\n    *   入射方式：正入射（横向动量为零）。\n    *   边界条件：波函数（石墨烯为旋量，薛定谔情况为标量）及其相应导数在界面处连续。\n    *   任务：推导透射概率 $T_G$ 和 $T_S$，以及它们的比值 $R = T_G/T_S$。\n\n2.  **使用提取的已知条件进行验证：**\n    *   **科学上是否成立？** 是。无质量狄拉克哈密顿量是石墨烯的标准低能有效模型。薛定谔方程是二维电子气的标准模型。在两种情况下，穿过矩形势垒的隧穿问题都是规范的教科书问题。石墨烯中的这种现象被称为克莱因隧穿（Klein tunneling）。该问题在科学上是合理的。\n    *   **问题是否适定？** 是。问题定义明确。控制方程、势和边界条件都已指定。预期存在一个唯一、稳定且有意义的透射概率解。\n    *   **是否客观？** 是。语言精确、量化，没有任何主观性。\n    *   **科学或事实上是否有误？** 否。物理原理是正确的。\n    *   **是否无法形式化或不相关？** 否。该问题是半导体物理学中的一个标准练习，可以被严格地形式化和解决。它直接关乎*石墨烯和碳纳米管电子学*。\n    *   **设置是否不完整或矛盾？** 否。所有必要信息都已提供。条件 $0  E  V_0$ 是隧穿问题的标准条件。正入射将问题简化为一维问题。\n    *   **是否不切实际或不可行？** 否。矩形势垒是一种理想化模型，但它们是物理学中理解散射现象的标准且有用的模型。\n    *   **是否不适定或结构不良？** 否。问题结构清晰，能导出一个唯一解。\n    *   **是否故作高深、琐碎或同义反复？** 否。计算过程并非无关紧要，它突显了相对论（狄拉克）和非相对论（薛定谔）量子力学之间的一个深刻差异，即克莱因佯谬。这种比较是该领域的核心概念点。\n    *   **是否超出科学可验证范围？** 否。结果可以通过数学推导和验证。\n\n3.  **结论与行动：**\n    *   **结论：** 该问题有效。\n    *   **行动：** 开始求解。\n\n**求解计划**\n\n**A部分：石墨烯透射 ($T_G$)**\n\n1.  **建立狄拉克方程：**\n    不含时狄拉克方程为 $H\\Psi = E\\Psi$。\n    $(v_F \\boldsymbol{\\sigma} \\cdot \\boldsymbol{p} + V(x)) \\Psi(x,y) = E \\Psi(x,y)$。\n    动量算符为 $\\boldsymbol{p} = -i\\hbar \\boldsymbol{\\nabla} = -i\\hbar (\\partial_x, \\partial_y)$。\n    泡利矩阵为: $\\sigma_x = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$, $\\sigma_y = \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}$。\n    所以，$H_0 = v_F (\\sigma_x p_x + \\sigma_y p_y) = -i\\hbar v_F (\\sigma_x \\partial_x + \\sigma_y \\partial_y)$。\n    波函数是一个双分量旋量 $\\Psi = \\begin{pmatrix} \\psi_A \\\\ \\psi_B \\end{pmatrix}$。\n    方程为：\n    $-i\\hbar v_F \\begin{pmatrix} 0  \\partial_x - i\\partial_y \\\\ \\partial_x + i\\partial_y  0 \\end{pmatrix} \\begin{pmatrix} \\psi_A \\\\ \\psi_B \\end{pmatrix} + V(x) \\begin{pmatrix} \\psi_A \\\\ \\psi_B \\end{pmatrix} = E \\begin{pmatrix} \\psi_A \\\\ \\psi_B \\end{pmatrix}$。\n\n2.  **应用正入射条件：**\n    正入射意味着横向动量 $k_y = 0$。波函数在 $y$ 方向是 $k_y=0$ 的平面波，因此 $\\Psi(x,y) = \\Psi(x) e^{i k_y y} = \\Psi(x)$。这意味着 $\\partial_y = 0$。\n    哈密顿量简化为 $H = v_F \\sigma_x p_x + V(x) = -i\\hbar v_F \\sigma_x \\partial_x + V(x)$。\n    方程变为：\n    $(-i\\hbar v_F \\sigma_x \\partial_x + V(x)) \\Psi(x) = E \\Psi(x)$。\n    $\\begin{pmatrix} V(x)  -i\\hbar v_F \\partial_x \\\\ -i\\hbar v_F \\partial_x  V(x) \\end{pmatrix} \\begin{pmatrix} \\psi_A(x) \\\\ \\psi_B(x) \\end{pmatrix} = E \\begin{pmatrix} \\psi_A(x) \\\\ \\psi_B(x) \\end{pmatrix}$。\n    这得到两个耦合的一阶常微分方程：\n    $V(x) \\psi_A - i\\hbar v_F \\frac{d\\psi_B}{dx} = E \\psi_A \\implies -i\\hbar v_F \\frac{d\\psi_B}{dx} = (E - V(x)) \\psi_A$\n    $V(x) \\psi_B - i\\hbar v_F \\frac{d\\psi_A}{dx} = E \\psi_B \\implies -i\\hbar v_F \\frac{d\\psi_A}{dx} = (E - V(x)) \\psi_B$\n\n3.  **在各区域求解：**\n    我们寻找形式为 $\\Psi(x) \\propto e^{ik_x x}$ 的平面波解。这意味着 $\\frac{d}{dx} \\to ik_x$。\n    方程变为：\n    $\\hbar v_F k_x \\psi_B = (E - V) \\psi_A$\n    $\\hbar v_F k_x \\psi_A = (E - V) \\psi_B$\n    将它们相除：$\\frac{\\psi_B}{\\psi_A} = \\frac{E-V}{\\hbar v_F k_x}$ 和 $\\frac{\\psi_A}{\\psi_B} = \\frac{E-V}{\\hbar v_F k_x}$。\n    将它们相乘：$1 = \\frac{(E-V)^2}{(\\hbar v_F k_x)^2} \\implies (\\hbar v_F k_x)^2 = (E-V)^2$。\n    色散关系为 $E-V = \\pm \\hbar v_F k_x$。\n    这给出了波矢 $k_x = \\frac{|E-V|}{\\hbar v_F}$。$E-V$ 的符号决定了旋量结构。\n    令 $s = \\text{sgn}(E-V)$。对于波矢为 $k_x$ 的波，其旋量结构为 $\\psi_B = \\frac{E-V}{\\hbar v_F k_x} \\psi_A = \\frac{s |E-V|}{\\hbar v_F k_x} \\psi_A = s \\frac{\\hbar v_F |k_x|}{\\hbar v_F k_x} \\psi_A = s \\cdot \\text{sgn}(k_x) \\psi_A$。\n    对于前向传播波（$k_x > 0$）的旋量是 $\\begin{pmatrix} 1 \\\\ s \\end{pmatrix}$，对于后向传播波（$k_x  0$）的旋量是 $\\begin{pmatrix} 1 \\\\ -s \\end{pmatrix}$。\n\n    *   **区域 I ($x0$):** $V=0$。$E > 0$。\n        波矢: $k = \\frac{E}{\\hbar v_{F}}$。符号 $s_{I} = \\text{sgn}(E) = +1$。\n        波函数是入射波（向右传播, $+k$）和反射波（向左传播, $-k$）的叠加。\n        $\\Psi_{I}(x) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{ikx} + r \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} e^{-ikx}$。\n\n    *   **区域 II ($0 \\le x \\le d$):** $V=V_{0}$。$0  E  V_0$。\n        波矢: $q = \\frac{|E-V_0|}{\\hbar v_F} = \\frac{V_0-E}{\\hbar v_F}$。符号 $s_{II} = \\text{sgn}(E-V_0) = -1$。\n        通解是向右传播（$+q$）和向左传播（$-q$）波的叠加。\n        $\\Psi_{II}(x) = a \\begin{pmatrix} 1 \\\\ s_{II} \\end{pmatrix} e^{iqx} + b \\begin{pmatrix} 1 \\\\ -s_{II} \\end{pmatrix} e^{-iqx} = a \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} e^{iqx} + b \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{-iqx}$。\n\n    *   **区域 III ($x>d$):** $V=0$。$E>0$。\n        波矢: $k = \\frac{E}{\\hbar v_F}$。符号 $s_{III} = +1$。\n        波函数仅包含透射波（向右传播, $+k$）。\n        $\\Psi_{III}(x) = t \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{ikx}$。\n\n4.  **应用边界条件：**\n    旋量波函数 $\\Psi(x)$ 在 $x=0$ 和 $x=d$ 处必须连续。\n\n    *   在 $x=0$ 处, $\\Psi_{I}(0) = \\Psi_{II}(0)$:\n        $$ \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + r \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = a \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} + b \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n        这给出了方程组：\n        $1+r = a+b$\n        $1-r = -a+b$\n        两式相加得 $2 = 2b$，所以 $b=1$。第一式减去第二式得 $2r = 2a$，所以 $r=a$。\n\n    *   在 $x=d$ 处, $\\Psi_{II}(d) = \\Psi_{III}(d)$:\n        $$ a \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} e^{iqd} + b \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{-iqd} = t \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{ikd} $$\n        代入 $a=r$ 和 $b=1$:\n        $$ r \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} e^{iqd} + \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{-iqd} = t \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{ikd} $$\n        这给出了方程组：\n        $r e^{iqd} + e^{-iqd} = t e^{ikd}$\n        $-r e^{iqd} + e^{-iqd} = t e^{ikd}$\n\n5.  **求解透射概率 $T_G$：**\n    将最后两个方程中对 $t e^{ikd}$ 的表达式相等，得到：\n    $r e^{iqd} + e^{-iqd} = -r e^{iqd} + e^{-iqd}$\n    $2r e^{iqd} = 0$\n    因为 $e^{iqd}$ 不为零，这意味着 $r=0$。反射系数为零意味着没有反射波。\n    当 $r=0$ 时，在 $x=d$ 处的方程变为 $e^{-iqd} = t e^{ikd}$。\n    求解透射振幅 $t$:\n    $t = e^{-ikd} e^{-iqd} = \\exp(-i(k+q)d)$。\n    透射概率 $T_G$ 是透射振幅的模平方：\n    $T_G = |t|^2 = |\\exp(-i(k+q)d)|^2 = 1$。\n    因此，对于正入射，穿过势垒的透射概率是完美的，无论势垒高度 $V_0$、宽度 $d$ 或电子能量 $E$ 为何。这种现象被称为克莱因隧穿（Klein tunneling）。\n    $$T_G(E,V_{0},d) = 1$$\n\n### 第二部分：非相对论（薛定谔）情况\n\n1.  **建立薛定谔方程：**\n    对于一个有效质量为 $m$ 的非相对论粒子，在正入射（$k_y=0$）情况下，其不含时薛定谔方程为：\n    $$-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$$\n\n2.  **各区域的解：**\n    通解的形式为 $\\psi(x) \\propto \\exp(i k_x x)$，其中 $k_x = \\sqrt{2m(E-V(x))/\\hbar^2}$。\n\n    *   **区域 I 和 III ($x0$ 和 $x>d$):** $V=0$。\n        波矢是实数: $k = \\sqrt{2mE/\\hbar^2}$。\n        波函数为：\n        $\\psi_I(x) = e^{ikx} + r_S e^{-ikx}$\n        $\\psi_{III}(x) = t_S e^{ikx}$\n\n    *   **区域 II ($0 \\le x \\le d$):** $V=V_0$。因为 $E  V_0$，平方根的参数为负。\n        波矢是虚数。令 $\\kappa = \\sqrt{2m(V_0-E)/\\hbar^2}$，其中 $\\kappa$ 是实数且为正。解是渐逝波。\n        $\\psi_{II}(x) = A e^{\\kappa x} + B e^{-\\kappa x}$\n\n3.  **边界条件与解：**\n    波函数 $\\psi(x)$ 及其一阶导数 $\\psi'(x)$ 在界面 $x=0$ 和 $x=d$ 处必须连续。应用这四个条件并求解透射振幅 $t_S$ 是一个标准的教科书问题。得到的透射概率 $T_S = |t_S|^2$ 为：\n    $$T_S = \\left[1 + \\frac{(\\kappa^2+k^2)^2}{4k^2\\kappa^2}\\sinh^2(\\kappa d)\\right]^{-1}$$\n    我们代入 $k^2$ 和 $\\kappa^2$ 的表达式：\n    $k^2 = \\frac{2mE}{\\hbar^2}$\n    $\\kappa^2 = \\frac{2m(V_0-E)}{\\hbar^2}$\n    分母中的项变为：\n    $\\frac{(\\kappa^2+k^2)^2}{4k^2\\kappa^2} = \\frac{\\left(\\frac{2m(V_0-E)}{\\hbar^2} + \\frac{2mE}{\\hbar^2}\\right)^2}{4\\left(\\frac{2mE}{\\hbar^2}\\right)\\left(\\frac{2m(V_0-E)}{\\hbar^2}\\right)} = \\frac{\\left(\\frac{2mV_0}{\\hbar^2}\\right)^2}{4\\frac{(2m)^2}{\\hbar^4}E(V_0-E)} = \\frac{V_0^2}{4E(V_0-E)}$。\n    所以，薛定谔电子的透射概率为：\n    $$T_S(E,V_0,d,m) = \\left[1 + \\frac{V_0^2}{4E(V_0-E)}\\sinh^2\\left(d\\sqrt{\\frac{2m(V_0-E)}{\\hbar^2}}\\right)\\right]^{-1}$$\n\n### 第三部分：比值 $R$\n\n问题要求计算比值 $R \\equiv T_G/T_S$。\n使用第一部分（$T_G=1$）和第二部分的结果：\n$$R(E,V_0,d,m) = \\frac{T_G}{T_S} = \\frac{1}{T_S} = 1 + \\frac{V_0^2}{4E(V_0-E)}\\sinh^2\\left(d\\sqrt{\\frac{2m(V_0-E)}{\\hbar^2}}\\right)$$\n该表达式用 $E, V_0, d, m, \\hbar$ 表示。来自石墨烯模型的参数 $v_F$ 没有出现在最终的比值中，因为在正入射情况下，$T_G$ 恰好为1，这个结果与 $v_F$ 无关。\n最终表达式可以写为：\n$$R = 1 + \\frac{V_0^2}{4E(V_0-E)}\\sinh^2\\left(\\frac{d}{\\hbar}\\sqrt{2m(V_0-E)}\\right)$$",
            "answer": "$$\n\\boxed{1 + \\frac{V_{0}^{2}}{4E(V_{0}-E)}\\sinh^{2}\\left(\\frac{d}{\\hbar}\\sqrt{2m(V_{0}-E)}\\right)}\n$$"
        },
        {
            "introduction": "理论分析为我们提供了深刻的物理洞见，但在设计和理解真实的纳米电子器件时，我们必须面对有限尺寸、复杂几何形状以及与电极耦合带来的影响。本练习将带你进入量子输运计算的前沿，使用非平衡格林函数 (NEGF) 形式，为具体的石墨烯纳米结构构建紧束缚模型并计算其透射谱。通过编写代码实现这一过程，你将掌握一个强大的工具，用于模拟和预测纳米尺度下的电子输运特性。",
            "id": "3751355",
            "problem": "考虑一个在最近邻紧束缚近似下描述的有限石墨烯纳米结构。器件区域被建模为一个有限的蜂窝状片段，包含 $N=8$ 个碳原子位置，索引标记为 $0,1,2,3,4,5,6,7$。在位点基下，器件的单粒子哈密顿量 $\\mathbf{H}$ 由以下方式定义：在位能为 $0$，成键最近邻之间的跃迁能为 $-t$，其中 $t$ 是以电子伏特 (eV) 为单位表示的最近邻跃迁能。该有限器件中的键由以下无向索引对给出：\n$$(0,1),\\ (1,2),\\ (2,3),\\ (4,5),\\ (5,6),\\ (6,7),\\ (0,4),\\ (1,5),\\ (2,6),\\ (3,7).$$\n该键列表构成了一个宽度为2、长度为4个键且带有边缘终端的扶手椅型石墨烯片段。\n\n在宽带极限下，两个金属接触（源极和漏极）连接到该器件。源极接触耦合到索引为 $0$ 和 $4$ 的器件位置，而漏极接触耦合到索引为 $3$ 和 $7$ 的器件位置。在宽带极限下，源极和漏极的推迟自能被建模为纯虚数且与能量无关，\n$$\\boldsymbol{\\Sigma}_S^R = -i\\,\\eta_S\\,\\mathbf{P}_S,\\qquad \\boldsymbol{\\Sigma}_D^R = -i\\,\\eta_D\\,\\mathbf{P}_D,$$\n其中 $\\eta_S$ 和 $\\eta_D$ 是非负实数耦合强度（单位为 eV），$\\mathbf{P}_S$ 和 $\\mathbf{P}_D$ 是投影到接触耦合器件子空间的投影矩阵（在耦合索引位置为1、其他位置为0的对角矩阵）。相应的展宽矩阵定义为\n$$\\boldsymbol{\\Gamma}_S = i\\left(\\boldsymbol{\\Sigma}_S^R - \\boldsymbol{\\Sigma}_S^A\\right),\\qquad \\boldsymbol{\\Gamma}_D = i\\left(\\boldsymbol{\\Sigma}_D^R - \\boldsymbol{\\Sigma}_D^A\\right),$$\n其中超前自能满足 $\\boldsymbol{\\Sigma}^{A} = \\left(\\boldsymbol{\\Sigma}^{R}\\right)^\\dagger$，因此在宽带极限下 $\\boldsymbol{\\Gamma}_S = 2\\,\\eta_S\\,\\mathbf{P}_S$ 且 $\\boldsymbol{\\Gamma}_D = 2\\,\\eta_D\\,\\mathbf{P}_D$。\n\n使用非平衡格林函数 (NEGF) 形式理论，开放器件在能量 $E$ 处的推迟格林函数定义为\n$$\\mathbf{G}^R(E) = \\left[(E + i\\,0^+)\\,\\mathbf{I} - \\mathbf{H} - \\boldsymbol{\\Sigma}_S^R - \\boldsymbol{\\Sigma}_D^R\\right]^{-1},$$\n超前格林函数为 $\\mathbf{G}^A(E) = \\left(\\mathbf{G}^R(E)\\right)^\\dagger$。\n\n任务是计算能量分辨透射率，\n$$T(E) = \\operatorname{Tr}\\left[\\boldsymbol{\\Gamma}_S\\,\\mathbf{G}^R(E)\\,\\boldsymbol{\\Gamma}_D\\,\\mathbf{G}^A(E)\\right],$$\n针对一组指定的物理上合理的参数。所有能量、耦合和跃迁值都必须以电子伏特 (eV) 为单位进行处理和报告。为确保数值稳定性，您必须通过在能量上加上一个微小的正虚数 $i\\,\\varepsilon$（其中 $\\varepsilon = 10^{-12}$）来实现上述的推迟规定。\n\n使用键列表和跃迁能 $-t$ 构建 $8\\times 8$ 的哈密顿矩阵 $\\mathbf{H}$；对角元为 $0$。使用给定的 $\\eta_S$ 和 $\\eta_D$ 以及指定的接触索引构建 $\\boldsymbol{\\Gamma}_S$ 和 $\\boldsymbol{\\Gamma}_D$。通过 $\\boldsymbol{\\Sigma}^R = -\\frac{i}{2}\\boldsymbol{\\Gamma}$ 从 $\\boldsymbol{\\Gamma}$ 构建 $\\boldsymbol{\\Sigma}_S^R$ 和 $\\boldsymbol{\\Sigma}_D^R$。\n\n您的程序必须为下面的每个测试用例计算 $T(E)$，并生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目都必须是一个浮点数（以与 eV 无关的无量纲透射单位表示）。\n\n测试套件（所有参数单位均为电子伏特，eV）：\n- 用例 1（通用理想路径）：$E=0.1$, $t=2.7$, $\\eta_S=0.5$, $\\eta_D=0.5$。\n- 用例 2（源极解耦边缘情况）：$E=0.1$, $t=2.7$, $\\eta_S=0.0$, $\\eta_D=0.5$。\n- 用例 3（离共振边界）：$E=5.0$, $t=2.7$, $\\eta_S=0.5$, $\\eta_D=0.5$。\n- 用例 4（强不对称性）：$E=0.05$, $t=2.7$, $\\eta_S=2.0$, $\\eta_D=0.1$。\n- 用例 5（靠近狄拉克点且接触较弱）：$E=0.0$, $t=2.7$, $\\eta_S=0.05$, $\\eta_D=0.05$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_k$ 对应第 $k$ 个用例的 $T(E)$。",
            "solution": "我们从石墨烯器件区域的紧束缚表示开始。在最近邻模型中，位点基下的器件哈密顿量 $\\mathbf{H}$ 的对角元等于 $0$（选择 $\\pi$ 轨道的在位能作为能量零点），对于成键的碳原子对，其非对角元等于 $-t$。利用所提供的键列表，我们在对应于键 $(i,j)$ 和 $(j,i)$ 的位置上放置 $-t$，其他位置为 $0$，从而构建出对称的 $8\\times 8$ 矩阵 $\\mathbf{H}$。\n\n非平衡格林函数 (NEGF) 形式理论始于推迟格林函数的预解式定义，即对于一个闭合系统，它是算符 $E + i\\,0^+ - \\hat{H}$ 的逆。对于带接触的开放系统，接触的效应通过加到哈密顿量中的推迟自能 $\\boldsymbol{\\Sigma}^R$ 来捕获，得到\n$$\\mathbf{G}^R(E) = \\left[(E + i\\,0^+)\\,\\mathbf{I} - \\mathbf{H} - \\sum_\\alpha \\boldsymbol{\\Sigma}_\\alpha^R(E)\\right]^{-1},$$\n其中和式对所有接触 $\\alpha$（此处为源极 $S$ 和漏极 $D$）求和。超前格林函数由厄米共轭得到，\n$$\\mathbf{G}^A(E) = \\left(\\mathbf{G}^R(E)\\right)^\\dagger.$$\n\n在宽带极限下，接触谱密度与能量无关，并且接触自能在耦合器件位点的子空间上是纯虚数和对角的。对于源极和漏极，我们有\n$$\\boldsymbol{\\Sigma}_S^R = -i\\,\\eta_S\\,\\mathbf{P}_S,\\qquad \\boldsymbol{\\Sigma}_D^R = -i\\,\\eta_D\\,\\mathbf{P}_D,$$\n其中 $\\eta_S$ 和 $\\eta_D$ 是指定接触-器件耦合强度的非负实数，而 $\\mathbf{P}_S$ 和 $\\mathbf{P}_D$ 是到接触耦合位点的投影算符。超前自能满足 $\\boldsymbol{\\Sigma}_\\alpha^A = \\left(\\boldsymbol{\\Sigma}_\\alpha^R\\right)^\\dagger$。因为在此模型中 $\\boldsymbol{\\Sigma}_\\alpha^R$ 是纯虚数且对角的，所以 $\\boldsymbol{\\Sigma}_\\alpha^A = +i\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha$。\n\n耦合或展宽矩阵 $\\boldsymbol{\\Gamma}_\\alpha$ 定义为\n$$\\boldsymbol{\\Gamma}_\\alpha = i\\left(\\boldsymbol{\\Sigma}_\\alpha^R - \\boldsymbol{\\Sigma}_\\alpha^A\\right) = i\\left(-i\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha - i\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha\\right) = 2\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha.$$\n等价地，这意味着\n$$\\boldsymbol{\\Sigma}_\\alpha^R = -\\frac{i}{2}\\,\\boldsymbol{\\Gamma}_\\alpha.$$\n\n根据这些定义，源极和漏极之间在能量 $E$ 处的透射率可由 Caroli 公式得出，\n$$T(E) = \\operatorname{Tr}\\left[\\boldsymbol{\\Gamma}_S\\,\\mathbf{G}^R(E)\\,\\boldsymbol{\\Gamma}_D\\,\\mathbf{G}^A(E)\\right].$$\n此表达式衡量了从源极注入的态如何在器件中传播并进入漏极，同时考虑了由接触引起的能级展宽。\n\n算法构建：\n- 使用键列表和跃迁能 $-t$ 构建维度为 $N=8$ 的哈密顿矩阵 $\\mathbf{H}$。对角元保持为 $0$。\n- 构建投影矩阵 $\\mathbf{P}_S$ 和 $\\mathbf{P}_D$，它们是对角矩阵，在分别与源极（$0$ 和 $4$）和漏极（$3$ 和 $7$）耦合的索引处条目为 $1$，其他位置为 $0$。\n- 构建 $\\boldsymbol{\\Gamma}_S = 2\\,\\eta_S\\,\\mathbf{P}_S$ 和 $\\boldsymbol{\\Gamma}_D = 2\\,\\eta_D\\,\\mathbf{P}_D$。\n- 构建 $\\boldsymbol{\\Sigma}_S^R = -\\frac{i}{2}\\,\\boldsymbol{\\Gamma}_S$ 和 $\\boldsymbol{\\Sigma}_D^R = -\\frac{i}{2}\\,\\boldsymbol{\\Gamma}_D$。\n- 构造矩阵 $\\mathbf{M}(E) = (E + i\\,\\varepsilon)\\,\\mathbf{I} - \\mathbf{H} - \\boldsymbol{\\Sigma}_S^R - \\boldsymbol{\\Sigma}_D^R,$ 其中 $\\varepsilon = 10^{-12}$，以强制施加推迟边界条件并保证数值稳定性。\n- 计算 $\\mathbf{G}^R(E) = \\mathbf{M}(E)^{-1}$ 和 $\\mathbf{G}^A(E) = \\left(\\mathbf{G}^R(E)\\right)^\\dagger$。\n- 计算 $T(E) = \\operatorname{Tr}\\left[\\boldsymbol{\\Gamma}_S\\,\\mathbf{G}^R(E)\\,\\boldsymbol{\\Gamma}_D\\,\\mathbf{G}^A(E)\\right]$ 并返回其实部，根据构造，该实部为非负值。\n\n物理单位与数值考虑：\n- 所有能量（$E$、$t$、$\\eta_S$、$\\eta_D$）均以电子伏特 (eV) 为单位。透射率 $T(E)$ 是无量纲的。\n- 无穷小量 $0^+$ 在数值上实现为 $\\varepsilon = 10^{-12}$ eV，以避免在特征值处出现奇异逆矩阵，并选择正确的推迟分支。\n\n测试覆盖范围：\n- 用例 1 使用靠近狄拉克点的中等对称耦合，探测典型的输运行为。\n- 用例 2 设置 $\\eta_S=0$，这必须得出 $T(E)=0$ 的结果，因为从源极的注入被抑制；代码验证了对零展宽的处理。\n- 用例 3 使用一个大的离共振能量，由于离共振和有限的接触展宽，这通常会产生很小的透射率。\n- 用例 4 探究了耦合中的强不对称性，突出了由较弱接触主导的瓶颈行为。\n- 用例 5 探测了弱接触下狄拉克点附近区域，测试了在小展宽下对边缘态和有限尺寸效应的敏感性。\n\n程序为每个用例计算 $T(E)$，并打印出单行格式化的、用方括号括起来的逗号分隔列表，以符合规范。",
            "answer": "```python\nimport numpy as np\n\ndef build_graphene_fragment_hamiltonian(t: float) - np.ndarray:\n    \"\"\"\n    Build the 8x8 tight-binding Hamiltonian for the specified finite graphene fragment.\n    On-site energies are 0; nearest-neighbor bonds have hopping -t.\n    Indices: 0..7 with bonds:\n    (0,1), (1,2), (2,3), (4,5), (5,6), (6,7), (0,4), (1,5), (2,6), (3,7).\n    \"\"\"\n    N = 8\n    H = np.zeros((N, N), dtype=np.complex128)\n    bonds = [(0, 1), (1, 2), (2, 3), (4, 5), (5, 6), (6, 7),\n             (0, 4), (1, 5), (2, 6), (3, 7)]\n    for i, j in bonds:\n        H[i, j] = -t\n        H[j, i] = -t\n    return H\n\ndef build_projector(indices: list, N: int) - np.ndarray:\n    \"\"\"\n    Build a diagonal projector matrix of size NxN with ones on 'indices' and zeros elsewhere.\n    \"\"\"\n    P = np.zeros((N, N), dtype=np.complex128)\n    for idx in indices:\n        P[idx, idx] = 1.0\n    return P\n\ndef compute_transmission(E: float, t: float, eta_S: float, eta_D: float) - float:\n    \"\"\"\n    Compute transmission T(E) = Tr[Gamma_S G^R Gamma_D G^A] for the given parameters.\n    E, t, eta_S, eta_D are in eV. Transmission is dimensionless.\n    \"\"\"\n    # Build device Hamiltonian\n    H = build_graphene_fragment_hamiltonian(t)\n    N = H.shape[0]\n\n    # Contact projectors: source on sites {0,4}, drain on sites {3,7}\n    P_S = build_projector([0, 4], N)\n    P_D = build_projector([3, 7], N)\n\n    # Broadening matrices in wide-band limit: Gamma = 2*eta*P\n    Gamma_S = 2.0 * eta_S * P_S\n    Gamma_D = 2.0 * eta_D * P_D\n\n    # Retarded self-energies: Sigma^R = -i/2 * Gamma\n    Sigma_S_R = -0.5j * Gamma_S\n    Sigma_D_R = -0.5j * Gamma_D\n\n    # Retarded Green's function\n    eps = 1e-12  # infinitesimal for retarded boundary condition\n    I = np.eye(N, dtype=np.complex128)\n    M = (E + 1j * eps) * I - H - Sigma_S_R - Sigma_D_R\n\n    # Invert M to get G^R\n    G_R = np.linalg.inv(M)\n    # Advanced Green's function\n    G_A = G_R.conj().T\n\n    # Transmission\n    T = np.trace(Gamma_S @ G_R @ Gamma_D @ G_A)\n    # Return the real part (imaginary part should be ~0 numerically)\n    return float(np.real(T))\n\ndef solve():\n    # Define the test cases from the problem statement (all energies in eV).\n    test_cases = [\n        # Case 1: general happy path\n        {\"E\": 0.1, \"t\": 2.7, \"eta_S\": 0.5, \"eta_D\": 0.5},\n        # Case 2: source decoupled edge case\n        {\"E\": 0.1, \"t\": 2.7, \"eta_S\": 0.0, \"eta_D\": 0.5},\n        # Case 3: off-resonant boundary\n        {\"E\": 5.0, \"t\": 2.7, \"eta_S\": 0.5, \"eta_D\": 0.5},\n        # Case 4: strong asymmetry\n        {\"E\": 0.05, \"t\": 2.7, \"eta_S\": 2.0, \"eta_D\": 0.1},\n        # Case 5: near Dirac point with weak contacts\n        {\"E\": 0.0, \"t\": 2.7, \"eta_S\": 0.05, \"eta_D\": 0.05},\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"E\"]\n        t = case[\"t\"]\n        eta_S = case[\"eta_S\"]\n        eta_D = case[\"eta_D\"]\n        result = compute_transmission(E, t, eta_S, eta_D)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}