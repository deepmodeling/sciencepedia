{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习旨在让我们对体半导体材料中观察到的基本弗兰兹-克尔迪什效应（Franz-Keldysh effect）建立起扎实的理解。通过推导和计算特征电光能量，您将深入了解主导场致吸收尾和带隙以上振荡行为的能量尺度。该练习  将线性势场中抽象的薛定谔方程与一个可触摸的物理量直接联系起来。",
            "id": "3745688",
            "problem": "考虑体相磷化铟 (InP) 在沿生长方向施加的均匀静电场 $F$ 下的情况。在基带边附近，均匀电场中的带间光吸收由电子-空穴对的有效质量相对运动薛定谔方程决定，该方程描述了具有折合质量 $m_r$ 的电子-空穴对在线性势中的运动。从相对坐标 $x$ 的一维有效质量薛定谔方程出发，\n$$\n-\\frac{\\hbar^{2}}{2 m_{r}}\\,\\frac{d^{2}\\psi(x)}{dx^{2}} - e F x\\,\\psi(x) = E\\,\\psi(x),\n$$\n其中 $E \\equiv \\hbar\\omega - E_g$ 是相对于带边 $E_g$ 测量的光子能量，推导决定 $E_g$ 以上的 Franz–Keldysh (Keldysh) 振荡间距的特征能量尺度，并用 $e$、$F$、$\\hbar$ 和 $m_r$ 表示。然后，在光子能量 $\\hbar\\omega = E_g + 100\\,\\mathrm{meV}$、$m_r = 0.07\\,m_0$ 和 $F = 200\\,\\mathrm{kV/cm}$ 的条件下，计算 InP 的这个特征间距。使用 $m_0 = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$，$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$ 和 $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$。将振荡间距视为主阶上由该特征能量尺度决定且与失谐无关。将最终数值答案四舍五入至四位有效数字，并以 $\\mathrm{meV}$ 为单位表示。",
            "solution": "问题要求计算在均匀电场 $F$ 作用下，体相磷化铟 (InP) 中 Franz-Keldysh 振荡的特征能量尺度。该能量尺度可以从问题陈述中给出的电子-空穴相对运动的一维有效质量薛定谔方程推导得出：\n$$\n-\\frac{\\hbar^{2}}{2 m_{r}}\\,\\frac{d^{2}\\psi(x)}{dx^{2}} - e F x\\,\\psi(x) = E\\,\\psi(x)\n$$\n此处，$E = \\hbar\\omega - E_g$ 是相对于带隙能量 $E_g$ 的光子能量，$m_r$ 是电子-空穴对的折合质量，$e$ 是元电荷，$\\hbar$ 是约化普朗克常数。\n\n首先，我们将薛定谔方程重写为一个更标准的形式：\n$$\n\\frac{d^{2}\\psi(x)}{dx^{2}} + \\frac{2 m_{r}}{\\hbar^{2}}(E + e F x)\\,\\psi(x) = 0\n$$\n这是一个系数线性变化的二阶线性常微分方程。它可以被转换为 Airy 微分方程，其标准形式为 $\\frac{d^2y(z)}{dz^2} - z y(z) = 0$。为此，我们通过适当的变量替换引入一个无量纲变量 $z$。我们定义一个新变量 $u = x + \\frac{E}{eF}$。方程变为：\n$$\n\\frac{d^{2}\\psi}{du^{2}} + \\frac{2 m_{r} e F}{\\hbar^{2}} u\\,\\psi(u) = 0\n$$\n现在，我们通过缩放 $u$ 来引入无量纲变量 $z$。令 $z = c u$，其中 $c$ 是一个缩放常数。那么 $u=z/c$ 且 $\\frac{d}{du} = c \\frac{d}{dz}$，这意味着 $\\frac{d^2}{du^2} = c^2 \\frac{d^2}{dz^2}$。将这些代入方程得到：\n$$\nc^2 \\frac{d^{2}\\psi}{dz^{2}} + \\frac{2 m_{r} e F}{\\hbar^{2}} \\frac{z}{c}\\,\\psi(z) = 0\n$$\n$$\n\\frac{d^{2}\\psi}{dz^{2}} + \\frac{2 m_{r} e F}{c^3 \\hbar^{2}} z\\,\\psi(z) = 0\n$$\n为了匹配标准的 Airy 方程形式（最多相差一个符号），我们可以选择 $z$ 的系数为 $\\pm 1$。让我们根据物理参数定义一个缩放因子。从方程 $\\frac{d^{2}\\psi}{du^{2}} + \\left(\\frac{2 m_{r} e F}{\\hbar^{2}}\\right) u\\,\\psi = 0$ 中，我们可以从 $u$ 的系数中确定一个特征长度尺度 $L_F$，该系数的单位必须是长度$^{-3}$。\n$$\nL_F^{-3} = \\frac{2 m_{r} e F}{\\hbar^{2}} \\implies L_F = \\left(\\frac{\\hbar^2}{2 m_r e F}\\right)^{1/3}\n$$\nFranz-Keldysh 效应的特征能量，通常表示为 $\\hbar\\theta_F$，是电荷 $e$ 在电场 $F$ 中移动特征长度 $L_F$ 所获得的势能。\n$$\n\\hbar\\theta_F = e F L_F = e F \\left(\\frac{\\hbar^2}{2 m_r e F}\\right)^{1/3}\n$$\n将 $eF$ 项移入立方根内，我们得到特征能量的最终表达式：\n$$\n\\hbar\\theta_F = \\left( (eF)^3 \\frac{\\hbar^2}{2 m_r e F} \\right)^{1/3} = \\left(\\frac{e^2 F^2 \\hbar^2}{2 m_r}\\right)^{1/3}\n$$\n这个能量 $\\hbar\\theta_F$ 决定了带隙以下 ($E  0$) 指数吸收尾的尺度，并且与带隙以上 ($E  0$) Franz-Keldysh 振荡的能量间距同量级。题目要求将此特征能量尺度作为间距。所给定的值 $E = \\hbar\\omega - E_g = 100\\,\\mathrm{meV}$ 只是确认我们处于带边以上的振荡区域，但特征能量尺度本身与 $E$ 无关。\n\n接下来，我们使用国际单位制 (SI) 下给定的数值来计算这个量：\n- 元电荷，$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- 电场，$F = 200\\,\\mathrm{kV/cm} = 200 \\times 10^3\\,\\mathrm{V} / (10^{-2}\\,\\mathrm{m}) = 2 \\times 10^7\\,\\mathrm{V/m}$\n- 约化普朗克常数，$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$\n- 折合质量，$m_r = 0.07\\,m_0 = 0.07 \\times 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg} = 6.37656859 \\times 10^{-32}\\,\\mathrm{kg}$\n\n我们计算立方根内的项，即 $(\\hbar\\theta_F)^3$：\n$$\n(\\hbar\\theta_F)^3 = \\frac{e^2 F^2 \\hbar^2}{2 m_r} = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2 (2 \\times 10^7\\,\\mathrm{V/m})^2 (1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s})^2}{2 \\times (6.37656859 \\times 10^{-32}\\,\\mathrm{kg})}\n$$\n分子：$e^2 F^2 \\hbar^2 = (2.5669700 \\times 10^{-38}) \\times (4 \\times 10^{14}) \\times (1.1121173 \\times 10^{-68}) \\approx 1.1419134 \\times 10^{-91}\\,\\mathrm{J^4 s^2 m^{-2}}$\n分母：$2 m_r = 2 \\times 6.37656859 \\times 10^{-32}\\,\\mathrm{kg} = 1.2753137 \\times 10^{-31}\\,\\mathrm{kg}$\n$$\n(\\hbar\\theta_F)^3 = \\frac{1.1419134 \\times 10^{-91}}{1.2753137 \\times 10^{-31}} \\approx 8.953994 \\times 10^{-61}\\,\\mathrm{J^3}\n$$\n现在，我们取立方根来计算以焦耳为单位的特征能量：\n$$\n\\hbar\\theta_F = (8.953994 \\times 10^{-61}\\,\\mathrm{J^3})^{1/3} \\approx 9.63850 \\times 10^{-21}\\,\\mathrm{J}\n$$\n最后，我们将此能量转换为毫电子伏特 ($\\mathrm{meV}$) 单位，并四舍五入至四位有效数字。\n$$\n1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J} \\implies 1\\,\\mathrm{meV} = 1.602176634 \\times 10^{-22}\\,\\mathrm{J}\n$$\n$$\n\\hbar\\theta_F (\\mathrm{in\\,meV}) = \\frac{9.63850 \\times 10^{-21}\\,\\mathrm{J}}{1.602176634 \\times 10^{-22}\\,\\mathrm{J/meV}} \\approx 60.15848\\,\\mathrm{meV}\n$$\n四舍五入至四位有效数字，我们得到 $60.16\\,\\mathrm{meV}$。",
            "answer": "$$\n\\boxed{60.16}\n$$"
        },
        {
            "introduction": "从体材料转向量子限制系统，场致效应的物理学发生了显著变化，从而引出了量子限制斯塔克效应（Quantum-Confined Stark Effect, QCSE）。本练习探讨了激子在外加电场下的稳定性，激子主导着量子阱的光学特性。通过估算临界电离场 ，您将对材料属性如何决定激子的稳定性形成直观理解，这是设计基于QCSE的光调制器等器件的核心概念。",
            "id": "3745684",
            "problem": "一个支持束缚电子-空穴对（激子）的窄半导体量子阱，沿其生长轴方向施加一均匀电场。假设阱宽足够小，使得电子-空穴的相对运动在平面内是有效的二维运动，并且库仑相互作用可以很好地用静态屏蔽势来描述，其介电常数为 $ \\varepsilon = \\varepsilon_{r} \\varepsilon_{0} $，电子-空穴的约化质量 $ \\mu $ 来自有效质量近似。在二维氢原子模型内处理激子，并通过将跨越特征面内尺寸的静电功与束缚能等同来估计发生电离时的电场，即 $ e F_{c} a \\sim E_{b} $，其中 $ e $ 是元电荷，$ F_{c} $ 是临界电场，$ a $ 是特征激子半径，$ E_{b} $ 是激子束缚能。\n\n仅使用以下经过充分验证的事实作为出发点：\n- 在有效质量近似中，有效玻尔半径和有效里德伯能量分别为 $ a_{B}^{*} = \\dfrac{4 \\pi \\varepsilon \\hbar^{2}}{\\mu e^{2}} $ 和 $ R^{*} = \\dfrac{\\mu e^{4}}{2 (4 \\pi \\varepsilon)^{2} \\hbar^{2}} $。\n- 对于窄量子阱中理想二维激子的基态，其束缚能和特征半径的标度关系为 $ E_{b} = 4 R^{*} $ 和 $ a = \\dfrac{a_{B}^{*}}{2} $。\n\n从这些事实和电离判据 $ e F_{c} a \\sim E_{b} $ 出发，推导出一个关于 $ F_{c} $ 的闭合形式表达式，该表达式要明确地用 $ \\mu $、$ \\varepsilon $、$ e $ 和 $ \\hbar $ 表示。你的推导应清楚地表明 $ F_{c} $ 如何随材料参数进行标度变化，从而阐明与量子限制斯塔克效应（QCSE）相关的材料依赖性。将最终电场以国际单位制（SI）的伏特/米（V/m）表示。不要代入任何数值，仅提供符号表达式。",
            "solution": "任务是推导窄量子阱中激子发生电离时的临界电场 $F_c$ 的表达式。问题为该电离过程提供了一个估算判据，该判据将电场在激子特征尺寸上所做的功与其束缚能联系起来。\n\n给定的电离判据是：\n$$e F_{c} a \\sim E_{b}$$\n其中 $e$ 是元电荷，$a$ 是特征激子半径，$E_b$ 是激子束缚能。我们将按照要求，把近似关系 `~` 当作等式来处理，以推导 $F_c$ 的闭合形式表达式。\n$$e F_{c} a = E_{b}$$\n根据此判据，临界电场 $F_c$ 可以表示为：\n$$F_c = \\frac{E_b}{e a}$$\n\n问题指出，对于理想的二维激子，其束缚能 $E_b$ 和特征半径 $a$ 由以下公式给出：\n$$E_{b} = 4 R^{*}$$\n$$a = \\frac{a_{B}^{*}}{2}$$\n此处，$R^*$ 是有效里德伯能量，$a_{B}^{*}$ 是三维系统的有效玻尔半径，其定义如下：\n$$R^{*} = \\dfrac{\\mu e^{4}}{2 (4 \\pi \\varepsilon)^{2} \\hbar^{2}}$$\n$$a_{B}^{*} = \\dfrac{4 \\pi \\varepsilon \\hbar^{2}}{\\mu e^{2}}$$\n在这些表达式中，$\\mu$ 是电子-空穴的约化质量，$\\varepsilon$ 是材料的介电常数，$\\hbar$ 是约化普朗克常数。\n\n将 $E_b$ 和 $a$ 的表达式代入 $F_c$ 的方程中：\n$$F_c = \\frac{4 R^{*}}{e \\left(\\frac{a_{B}^{*}}{2}\\right)} = \\frac{8 R^{*}}{e a_{B}^{*}}$$\n\n为了仅用基本参数（$\\mu$、$\\varepsilon$、$e$、$\\hbar$）来表示 $F_c$，我们代入 $R^*$ 和 $a_B^*$ 的定义。一个更简洁的中间步骤是先用 $a_B^*$ 来表示 $R^*$。通过观察 $R^*$ 和 $a_B^*$ 的定义，我们可以看到：\n$$R^{*} = \\frac{e^2}{8 \\pi \\varepsilon a_{B}^{*}}$$\n可以通过将 $a_B^*$ 的表达式代入右侧来验证此关系：\n$$\\frac{e^2}{8 \\pi \\varepsilon} \\left( \\frac{1}{a_{B}^{*}} \\right) = \\frac{e^2}{8 \\pi \\varepsilon} \\left( \\frac{\\mu e^2}{4 \\pi \\varepsilon \\hbar^2} \\right) = \\frac{\\mu e^4}{32 \\pi^2 \\varepsilon^2 \\hbar^2} = \\frac{\\mu e^4}{2 (16 \\pi^2 \\varepsilon^2) \\hbar^2} = \\frac{\\mu e^4}{2 (4 \\pi \\varepsilon)^2 \\hbar^2} = R^{*}$$\n该关系被证实是正确的。\n\n现在，我们将这个简化的 $R^*$ 表达式代入我们的 $F_c$ 方程中：\n$$F_c = \\frac{8}{e a_{B}^{*}} \\left( \\frac{e^2}{8 \\pi \\varepsilon a_{B}^{*}} \\right)$$\n$$F_c = \\frac{e}{\\pi \\varepsilon (a_{B}^{*})^2}$$\n这个中间结果提供了清晰的物理洞察：临界电离电场与元电荷成正比，与材料的介电常数以及有效玻尔半径的平方成反比。\n\n最后，为了获得用指定基本参数表示的表达式，我们将 $a_{B}^{*}$ 的定义代入此方程：\n$$F_c = \\frac{e}{\\pi \\varepsilon} \\left( \\frac{1}{\\frac{4 \\pi \\varepsilon \\hbar^{2}}{\\mu e^{2}}} \\right)^2$$\n$$F_c = \\frac{e}{\\pi \\varepsilon} \\left( \\frac{\\mu e^2}{4 \\pi \\varepsilon \\hbar^2} \\right)^2$$\n展开平方项：\n$$F_c = \\frac{e}{\\pi \\varepsilon} \\frac{\\mu^2 e^4}{(4 \\pi \\varepsilon)^2 \\hbar^4} = \\frac{e}{\\pi \\varepsilon} \\frac{\\mu^2 e^4}{16 \\pi^2 \\varepsilon^2 \\hbar^4}$$\n合并各项，得到临界电场 $F_c$ 的最终表达式：\n$$F_c = \\frac{\\mu^2 e^5}{16 \\pi^3 \\varepsilon^3 \\hbar^4}$$\n该表达式显示了激子电离的临界电场如何随材料参数进行标度变化。具体来说，$F_c \\propto \\mu^2$ 且 $F_c \\propto \\varepsilon^{-3}$。具有较大电子-空穴约化质量 $\\mu$ 的材料会形成更紧密束缚的激子，需要更强的电场才能电离。相反，具有较高介电常数 $\\varepsilon$ 的材料表现出更强的库仑相互作用屏蔽效应，导致激子束缚较弱，更容易被较弱的电场电离。量纲分析证实，该表达式得出的单位是电场单位（伏特/米）。",
            "answer": "$$\\boxed{\\frac{\\mu^{2} e^{5}}{16 \\pi^{3} \\varepsilon^{3} \\hbar^{4}}}$$"
        },
        {
            "introduction": "为了弥合理想化理论与实验观察之间的差距，这最后一个练习将挑战您构建弗兰兹-克尔迪什效应的计算模型。您将模拟完整的吸收光谱，其中包含了至关重要的、依赖于温度的退相干效应，这些效应会展宽并掩盖特征振荡。该练习  提供了宝贵的数值建模实践经验，这是现代半导体器件物理学的一项关键技能，并让您能够直观地看到热效应对器件性能的影响。",
            "id": "3745686",
            "problem": "要求您设计并实现一个Franz-Keldysh效应 (FKE) 的计算模型，该效应是直接带隙半导体在均匀静电场作用下产生的电吸收调制。目标是使用一个唯象退相干速率模型，计算FKE谱中振荡可见度的温度依赖性。您的程序必须从基本原理出发推导其建模方程，实现所得的数值模型，并为指定的测试套件生成定量结果。\n\n起点和假设：\n- 考虑一个具有两个抛物线形能带（导带和价带）的直接带隙半导体，其特征为电子有效质量 $m_e^\\ast$ 和空穴有效质量 $m_h^\\ast$。约化质量为 $\\mu = \\dfrac{m_e^\\ast m_h^\\ast}{m_e^\\ast + m_h^\\ast}$。\n- 假设沿一个空间方向施加均匀静电场 $F$，并在有效质量近似内，使用带间跃迁和半经典加速定理对线性光学响应进行建模。\n- 设带隙能量为 $E_g$；光子能量为 $E$（以 $\\mathrm{eV}$ 表示）。\n- 将退相干建模为一个唯象均匀展宽速率 $\\gamma(T) = \\gamma_0 + a T$，其中温度 $T$ 以 $\\mathrm{K}$ 表示，$\\gamma$ 以 $\\mathrm{s^{-1}}$ 表示。\n- 在时域中，退相干以指数因子 $\\exp(-\\gamma t)$ 的形式乘以带间极化响应；在频域（能量域）中，这对应于场修正谱与半高半宽为 $\\Gamma = \\hbar \\gamma$ 的洛伦兹函数的卷积，其中 $\\hbar$ 是约化普朗克常数。\n\n定义和任务：\n1. 从第一性原理推导出一个归一化的场修正谱响应函数 $S_0(E)$，该函数在带边以上表现出Franz-Keldysh振荡。在有效质量近似中，使用均匀场所固有的、物理上合理的Airy积分表示，并限制在一维模型中，以为 $S_0(E)$ 获得一个足以捕捉振荡行为的易处理的解析形式。用施加的电场 $F$、约化质量 $\\mu$ 和基本常数来表示特征电光能量尺度 $E_F$。在您的计算中，所有能量必须以 $\\mathrm{eV}$ 表示。\n2. 通过将 $S_0(E)$ 与洛伦兹核函数 $L(\\Delta E; \\Gamma)$进行卷积来引入退相干，其中 $\\Gamma = \\hbar \\gamma(T)$ 以 $\\mathrm{eV}$ 表示，且 $L(\\Delta E; \\Gamma) = \\dfrac{1}{\\pi}\\dfrac{\\Gamma}{\\Delta E^2 + \\Gamma^2}$。\n3. 在带边以上的一个指定能量窗口内定义并计算振荡可见度 $V$。对于一个选定的窗口 $[E_g + \\Delta E_{\\min}, E_g + \\Delta E_{\\max}]$，找出展宽谱 $S(E)$ 的第一个局域最大值 $S_{\\max}$ 和第一个随后的局域最小值 $S_{\\min}$，并计算可见度为 $V = \\dfrac{S_{\\max} - S_{\\min}}{S_{\\max} + S_{\\min}}$。如果由于强阻尼在窗口内找不到合适的 $(S_{\\max}, S_{\\min})$ 对，则定义 $V = 0.0$。\n4. 使用以下固定的物理参数（科学上真实且自洽）：\n   - 带隙：$E_g = 1.55\\,\\mathrm{eV}$。\n   - 电子有效质量：$m_e^\\ast = 0.067\\,m_0$。\n   - 空穴有效质量：$m_h^\\ast = 0.45\\,m_0$。\n   - 自由电子质量：$m_0 = 9.10938356\\times 10^{-31}\\,\\mathrm{kg}$。\n   - 元电荷：$e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n   - 约化普朗克常数：$\\hbar = 1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$ 和 $\\hbar = 6.582119569\\times 10^{-16}\\,\\mathrm{eV\\cdot s}$（使用一致的单位转换）。\n   - 退相干参数：$\\gamma_0 = 5.0\\times 10^{11}\\,\\mathrm{s^{-1}}$， $a = 2.0\\times 10^{9}\\,\\mathrm{s^{-1}\\cdot K^{-1}}$。\n   - 谱能量网格：$E \\in [E_g - 0.05\\,\\mathrm{eV}, E_g + 0.25\\,\\mathrm{eV}]$ 以步长 $\\Delta E = 1.0\\times 10^{-3}\\,\\mathrm{eV}$ 均匀采样。\n   - 可见度窗口：$\\Delta E_{\\min} = 0.01\\,\\mathrm{eV}$， $\\Delta E_{\\max} = 0.20\\,\\mathrm{eV}$。\n5. Franz-Keldysh效应 (FKE) 振荡由依赖于 $F$ 和 $\\mu$ 的电光能量尺度 $E_F$ 控制。推导 $E_F$ 并将其表示为 $F$（单位 $\\mathrm{V/m}$）和 $\\mu$（单位 $\\mathrm{kg}$）的函数，数值上以 $\\mathrm{eV}$ 为单位。\n6. 实现您的模型，为下面的测试套件计算可见度 $V$。确保在指定窗口内峰值检测的数值稳定性。如有必要，使用一个随窗口内谱中值缩放的最小峰突起阈值。明确说明并论证所使用的任何数值阈值或启发式方法。\n\n测试套件：\n- 案例1 (正常路径)：$T = 77\\,\\mathrm{K}$， $F = 2.0\\times 10^{7}\\,\\mathrm{V/m}$，以浮点数形式返回 $V$。\n- 案例2 (高温)：$T = 300\\,\\mathrm{K}$， $F = 2.0\\times 10^{7}\\,\\mathrm{V/m}$，以浮点数形式返回 $V$。\n- 案例3 (边界低退相干)：$T = 0\\,\\mathrm{K}$， $F = 2.0\\times 10^{7}\\,\\mathrm{V/m}$，以浮点数形式返回 $V$。\n- 案例4 (强场)：$T = 300\\,\\mathrm{K}$， $F = 5.0\\times 10^{7}\\,\\mathrm{V/m}$，以浮点数形式返回 $V$。\n\n最终输出规格：\n- 您的程序必须生成单行输出，包含一个以逗号分隔的Python列表，按测试套件的顺序包含四个可见度，例如 $[v_1,v_2,v_3,v_4]$。\n- 每个 $v_i$ 必须是一个浮点数。输出中不允许有任何额外的文本或行。\n- 所有能量必须以 $\\mathrm{eV}$ 处理和报告，退相干速率以 $\\mathrm{s^{-1}}$，电场以 $\\mathrm{V/m}$，温度以 $\\mathrm{K}$。可见度是无量纲的。",
            "solution": "该问题要求设计并实现一个计算模型，用于计算直接带隙半导体中Franz-Keldysh振荡的随温度变化的可见度。这需要推导物理模型，进行数值实现，并将其应用于一组特定的测试用例。\n\n### 基于原理的设计\n\n解决方案是通过一系列步骤制定的，从电场中电子-空穴对的基本量子力学出发，最终形成一个计算期望可观测量——振荡可见度——的数值算法。\n\n#### 1. 理想谱响应和电光能量\n\nFranz-Keldysh效应 (FKE) 改变了半导体在外部电场 $F$ 作用下能带边缘附近的光学吸收谱。我们从电子-空穴对相对运动的一维有效质量薛定谔方程开始，其中约化质量为 $\\mu = \\frac{m_e^\\ast m_h^\\ast}{m_e^\\ast + m_h^\\ast}$，在电场存在的情况下：\n$$ -\\frac{\\hbar^2}{2\\mu} \\frac{d^2\\psi(z)}{dz^2} - eFz \\psi(z) = E_{rel} \\psi(z) $$\n这里，$z$ 是沿电场方向的相对坐标，$e$ 是元电荷，$\\hbar$ 是约化普朗克常数，$E_{rel} = E - E_g$ 是吸收的光子能量 $E$ 相对于半导体带隙 $E_g$ 的能量。\n\n通过变量替换，该方程可以转换为Airy微分方程的标准形式，$y''(x) - xy(x) = 0$。物理上合适的有界解是第一类Airy函数 $\\mathrm{Ai}(x)$。自变量 $x$ 是一个无量纲的能量，由下式给出：\n$$ x = \\frac{E_g - E}{E_F} $$\n项 $E_F$ 是特征电光能量，它设定了FKE的能量尺度。从变量替换推导出的结果是：\n$$ E_F = \\left( \\frac{(eF\\hbar)^2}{2\\mu} \\right)^{1/3} $$\n这个关键参数决定了Franz-Keldysh振荡的周期。\n\n光吸收与场修正的联合态密度成正比。一个物理上合理的谱响应函数 $S_0(E)$ 的表达式，它与介电函数的虚部成正比，由Airy函数及其一阶导数给出：\n$$ S_0(E) = C \\left[ \\mathrm{Ai}'(x)^2 - x \\mathrm{Ai}(x)^2 \\right] $$\n其中 $C$ 是一个比例常数。对于 $E  E_g$，$x$ 为负，导致Airy函数振荡，从而在带隙以上产生特征吸收振荡。由于最终的量——可见度——是一个比率度量，因此常数 $C$ 可以不失一般性地设为1。此函数 $S_0(E)$ 代表了理想的、无阻尼的谱响应。\n\n#### 2. 退相干与谱展宽的引入\n\n在真实系统中，散射过程导致退相干，从而缩短了电子-空穴对的相干寿命。这通过一个依赖于温度的唯象退相干速率 $\\gamma(T) = \\gamma_0 + aT$ 来建模。在能量域中，这种寿命限制表现为谱展宽。展宽谱 $S(E)$ 是通过将理想谱 $S_0(E)$ 与洛伦兹函数 $L(\\Delta E; \\Gamma)$ 进行卷积得到的，该洛伦兹函数是指数时间衰减的傅里叶变换：\n$$ S(E) = (S_0 * L)(E) = \\int_{-\\infty}^{\\infty} S_0(E') L(E - E'; \\Gamma) dE' $$\n洛伦兹核函数定义为：\n$$ L(\\Delta E; \\Gamma) = \\frac{1}{\\pi} \\frac{\\Gamma}{\\Delta E^2 + \\Gamma^2} $$\n展宽的半高半宽 (HWHM) $\\Gamma$ 与退相干速率直接相关，关系为 $\\Gamma = \\hbar\\gamma(T)$，并且必须以能量单位 (eV) 表示。这种卷积平滑了 $S_0(E)$ 的尖锐特征，减小了振荡的幅度，尤其是在 $\\gamma(T)$ 和 $\\Gamma$ 都较大的高温下。\n\n#### 3. 振荡可见度与数值算法\n\n可见度 $V$ 量化了振荡的显著程度。它在一个指定的能量窗口 $[E_g + \\Delta E_{\\min}, E_g + \\Delta E_{\\max}]$ 内计算。在此窗口内，我们必须确定展宽谱 $S(E)$ 的第一个局域最大值 $S_{\\max}$ 和第一个随后的局域最小值 $S_{\\min}$。然后，可见度由迈克尔逊对比度公式给出：\n$$ V = \\frac{S_{\\max} - S_{\\min}}{S_{\\max} + S_{\\min}} $$\n如果振荡被严重阻尼，以至于无法找到一个清晰的最大-最小值对，则定义可见度为 $V=0.0$。\n\n算法实现过程如下：\n1.  **初始化**：定义所有给定的物理常数（$m_0, e, \\hbar$）、材料参数（$E_g, m_e^\\ast, m_h^\\ast$）和模型参数（$\\gamma_0, a$）。\n2.  **参数计算**：对于每个测试用例 $(T, F)$，计算派生参数：约化质量 $\\mu$、电光能量 $E_F$（单位 eV）和展宽宽度 $\\Gamma$（单位 eV）。\n3.  **网格设置**：使用指定的范围和步长 $\\Delta E$ 创建一个均匀的能量网格 $E$。\n4.  **理想谱生成**：使用 `scipy.special.airy` 函数在网格上计算理想谱 $S_0(E)$，以获得 $\\mathrm{Ai}(x)$ 和 $\\mathrm{Ai}'(x)$。\n5.  **通过卷积进行展宽**：\n    - 在具有相同步长 $\\Delta E$ 的辅助网格上离散化洛伦兹核函数 $L(\\Delta E, \\Gamma)$。\n    - 使用 `numpy.convolve` 并设置 `mode='same'` 对 $S_0(E)$ 和 $L(\\Delta E, \\Gamma)$ 进行数值卷积。结果乘以网格步长 $\\Delta E$ 以正确逼近卷积积分。\n6.  **可见度计算**：\n    - 分离出展宽谱 $S(E)$ 中落在可见度窗口内的部分。\n    - 使用 `scipy.signal.find_peaks` 来定位最大值（在 $S(E)$ 上）和最小值（在 $-S(E)$ 上）。为确保对数值噪声的鲁棒性，采用了一个突起阈值。该阈值设为窗口内信号中位数的 $1\\%$，这是一种随信号强度自适应缩放的启发式方法。\n    - 识别第一个峰和其后的第一个谷。如果这对值存在，则计算 $V$。否则，设置 $V=0.0$。\n7.  **聚合**：收集所有测试用例计算出的可见度值，并将其格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import airy\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Solves the Franz-Keldysh effect problem by modeling the spectrum\n    and calculating oscillation visibility for a given set of test cases.\n    \"\"\"\n\n    # --- Physical Constants (as specified in the problem) ---\n    M0 = 9.10938356e-31        # Free-electron mass in kg\n    E_CHARGE = 1.602176634e-19 # Elementary charge in C\n    HBAR_JS = 1.054571817e-34    # Reduced Planck constant in J*s\n    HBAR_EVS = 6.582119569e-16  # Reduced Planck constant in eV*s\n\n    # --- Material and Model Parameters ---\n    EG = 1.55                  # Bandgap in eV\n    ME_STAR_FACTOR = 0.067     # Electron effective mass factor\n    MH_STAR_FACTOR = 0.45      # Hole effective mass factor\n    GAMMA0 = 5.0e11            # Dephasing parameter gamma_0 in s^-1\n    A_DEPHASING = 2.0e9        # Dephasing parameter 'a' in s^-1*K^-1\n\n    # --- Numerical Grid and Window Parameters ---\n    E_GRID_START_OFFSET = -0.05  # eV\n    E_GRID_END_OFFSET = 0.25     # eV\n    DE_GRID_STEP = 1.0e-3        # eV\n    VISIBILITY_WINDOW_MIN = 0.01 # eV above Eg\n    VISIBILITY_WINDOW_MAX = 0.20 # eV above Eg\n\n    def calculate_visibility(T, F):\n        \"\"\"\n        Calculates the Franz-Keldysh oscillation visibility for a given\n        temperature T (in K) and electric field F (in V/m).\n        \"\"\"\n        # 1. Calculate derived physical parameters\n        me_star = ME_STAR_FACTOR * M0\n        mh_star = MH_STAR_FACTOR * M0\n        mu = (me_star * mh_star) / (me_star + mh_star)\n\n        # Electro-optic energy E_F in Joules, then converted to eV\n        ef_j = ((E_CHARGE * F * HBAR_JS)**2 / (2 * mu))**(1/3.0)\n        ef_ev = ef_j / E_CHARGE\n\n        # Broadening parameter Gamma in eV\n        gamma_t = GAMMA0 + A_DEPHASING * T\n        gamma_ev = HBAR_EVS * gamma_t\n\n        # 2. Set up the energy grid\n        e_grid = np.arange(EG + E_GRID_START_OFFSET, EG + E_GRID_END_OFFSET, DE_GRID_STEP)\n\n        # 3. Calculate the ideal Franz-Keldysh spectrum S0(E)\n        x = (EG - e_grid) / ef_ev\n        ai, aip, _, _ = airy(x)\n        s0 = aip**2 - x * ai**2\n\n        # 4. Perform convolution with a Lorentzian kernel\n        # Kernel is defined over a fixed range, wide enough for all cases.\n        kernel_range = 0.05  # eV\n        kernel_e = np.arange(-kernel_range, kernel_range + DE_GRID_STEP, DE_GRID_STEP)\n        lorentzian_kernel = (1/np.pi) * gamma_ev / (kernel_e**2 + gamma_ev**2)\n        \n        s_broad = np.convolve(s0, lorentzian_kernel, mode='same') * DE_GRID_STEP\n\n        # 5. Compute visibility V\n        e_vis_min = EG + VISIBILITY_WINDOW_MIN\n        e_vis_max = EG + VISIBILITY_WINDOW_MAX\n\n        # Get indices for the visibility window\n        vis_indices = np.where((e_grid >= e_vis_min)  (e_grid = e_vis_max))[0]\n        if len(vis_indices)  3: # Need at least 3 points to find a peak\n            return 0.0\n            \n        s_window = s_broad[vis_indices]\n\n        # Heuristic for peak prominence:\n        # The prominence is set to 1% of the median signal strength in the window.\n        # This adaptive threshold reliably identifies physically significant\n        # oscillations while filtering numerical artifacts. The median is a\n        # robust measure, making the threshold insensitive to outliers.\n        median_signal = np.median(s_window)\n        prominence_threshold = 0.01 * median_signal if median_signal > 0 else None\n        \n        # Find the first maximum and the subsequent minimum\n        max_indices, _ = find_peaks(s_window, prominence=prominence_threshold)\n        min_indices, _ = find_peaks(-s_window, prominence=prominence_threshold)\n\n        if len(max_indices) == 0:\n            return 0.0\n\n        first_max_local_idx = max_indices[0]\n        subsequent_min_indices = min_indices[min_indices > first_max_local_idx]\n\n        if len(subsequent_min_indices) == 0:\n            return 0.0\n\n        first_min_local_idx = subsequent_min_indices[0]\n\n        s_max = s_window[first_max_local_idx]\n        s_min = s_window[first_min_local_idx]\n\n        if s_max + s_min = 1e-9: # Avoid division by zero/small numbers\n            return 0.0\n            \n        visibility = (s_max - s_min) / (s_max + s_min)\n        return visibility\n\n    # --- Test Suite Execution ---\n    test_cases = [\n        (77.0, 2.0e7),   # Case 1: happy path\n        (300.0, 2.0e7),  # Case 2: high temperature\n        (0.0, 2.0e7),    # Case 3: boundary low dephasing\n        (300.0, 5.0e7)   # Case 4: strong field\n    ]\n\n    results = []\n    for T, F in test_cases:\n        visibility = calculate_visibility(T, F)\n        results.append(visibility)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.7f}' for v in results)}]\")\n\nsolve()\n```"
        }
    ]
}