{
    "hands_on_practices": [
        {
            "introduction": "We begin by exploring the cornerstone of spin-dependent transport: the Mott two-current model. This practice solidifies the understanding of how spin-up and spin-down electrons act as parallel conduction channels in a ferromagnet. By deriving the effective resistivity and spin polarization, you will quantify the fundamental material properties that give rise to magnetoresistive effects .",
            "id": "3751129",
            "problem": "A ferromagnetic metal layer used in Giant Magnetoresistance (GMR) or Tunnel Magnetoresistance (TMR) devices can be modeled by the Mott two-current picture, where spin-up and spin-down electrons conduct in parallel with distinct transport properties. Assume spin-flip scattering is negligible over the scale of interest so that the spin channels remain independent. Let the sample be subject to a uniform electric field $\\mathbf{E}$ along its length and have a uniform cross-sectional area, so that the spin-resolved current densities $J_{\\uparrow}$ and $J_{\\downarrow}$ add to give the total charge current density $J$.\n\nStarting from Ohm’s law for each spin channel, $J_{s}=\\sigma_{s} E$ with $s\\in\\{\\uparrow,\\downarrow\\}$, and the definition of resistivity as the inverse of conductivity, $\\rho_{s}=\\sigma_{s}^{-1}$, derive an expression for the effective resistivity $\\rho_{\\mathrm{eff}}$ of the ferromagnet when the two spin channels conduct in parallel. Then, starting from the definition of the spin conduction polarization as the dimensionless ratio of net spin current to total charge current,\n$$\nP=\\frac{J_{\\uparrow}-J_{\\downarrow}}{J_{\\uparrow}+J_{\\downarrow}},\n$$\nexpress $P$ in terms of the spin-channel resistivities.\n\nGiven measured spin-channel resistivities $\\rho_{\\uparrow}=20\\,\\mu\\Omega\\text{cm}$ and $\\rho_{\\downarrow}=40\\,\\mu\\Omega\\text{cm}$, compute the numerical values of $\\rho_{\\mathrm{eff}}$ and $P$. Express $\\rho_{\\mathrm{eff}}$ in $\\mu\\Omega\\text{cm}$ and $P$ as a pure number. Round both quantities to four significant figures.",
            "solution": "The problem asks for the derivation of the effective resistivity $\\rho_{\\mathrm{eff}}$ and the spin conduction polarization $P$ for a ferromagnetic metal described by the Mott two-current model, followed by a numerical calculation of these quantities.\n\nThe model posits that spin-up ($\\uparrow$) and spin-down ($\\downarrow$) electrons conduct electricity in two independent, parallel channels. Under a uniform electric field $E$, the total charge current density $J$ is the sum of the spin-resolved current densities $J_{\\uparrow}$ and $J_{\\downarrow}$:\n$$\nJ = J_{\\uparrow} + J_{\\downarrow}\n$$\nEach spin channel obeys Ohm's law, given by $J_{s} = \\sigma_{s} E$ for $s \\in \\{\\uparrow, \\downarrow\\}$, where $\\sigma_{s}$ is the conductivity of the respective channel. Since the channels are in parallel, the electric field $E$ is the same for both.\n\nFirst, we derive the effective resistivity $\\rho_{\\mathrm{eff}}$. The total current density can be expressed as:\n$$\nJ = \\sigma_{\\uparrow} E + \\sigma_{\\downarrow} E = (\\sigma_{\\uparrow} + \\sigma_{\\downarrow}) E\n$$\nBy definition, the effective conductivity $\\sigma_{\\mathrm{eff}}$ of the material relates the total current density to the electric field:\n$$\nJ = \\sigma_{\\mathrm{eff}} E\n$$\nComparing the two expressions for $J$, we identify the effective conductivity as the sum of the individual channel conductivities:\n$$\n\\sigma_{\\mathrm{eff}} = \\sigma_{\\uparrow} + \\sigma_{\\downarrow}\n$$\nResistivity $\\rho$ is the inverse of conductivity $\\sigma$, such that $\\rho = 1/\\sigma$ or $\\sigma = 1/\\rho$. Substituting this relationship into the equation for $\\sigma_{\\mathrm{eff}}$ gives:\n$$\n\\frac{1}{\\rho_{\\mathrm{eff}}} = \\frac{1}{\\rho_{\\uparrow}} + \\frac{1}{\\rho_{\\downarrow}}\n$$\nThis is the characteristic equation for resistors in parallel. To find an explicit expression for $\\rho_{\\mathrm{eff}}$, we find a common denominator for the right-hand side:\n$$\n\\frac{1}{\\rho_{\\mathrm{eff}}} = \\frac{\\rho_{\\downarrow} + \\rho_{\\uparrow}}{\\rho_{\\uparrow} \\rho_{\\downarrow}}\n$$\nInverting this equation yields the expression for the effective resistivity:\n$$\n\\rho_{\\mathrm{eff}} = \\frac{\\rho_{\\uparrow} \\rho_{\\downarrow}}{\\rho_{\\uparrow} + \\rho_{\\downarrow}}\n$$\n\nNext, we derive an expression for the spin conduction polarization $P$ in terms of the channel resistivities. The definition of $P$ is given as:\n$$\nP = \\frac{J_{\\uparrow} - J_{\\downarrow}}{J_{\\uparrow} + J_{\\downarrow}}\n$$\nWe substitute Ohm's law, expressed in terms of resistivity ($J_s = E/\\rho_s$), into this definition:\n$$\nP = \\frac{\\frac{E}{\\rho_{\\uparrow}} - \\frac{E}{\\rho_{\\downarrow}}}{\\frac{E}{\\rho_{\\uparrow}} + \\frac{E}{\\rho_{\\downarrow}}}\n$$\nThe electric field $E$ is a common factor in all terms and can be canceled:\n$$\nP = \\frac{\\frac{1}{\\rho_{\\uparrow}} - \\frac{1}{\\rho_{\\downarrow}}}{\\frac{1}{\\rho_{\\uparrow}} + \\frac{1}{\\rho_{\\downarrow}}}\n$$\nTo simplify this complex fraction, we multiply the numerator and the denominator by the product $\\rho_{\\uparrow} \\rho_{\\downarrow}$:\n$$\nP = \\frac{\\left(\\frac{1}{\\rho_{\\uparrow}} - \\frac{1}{\\rho_{\\downarrow}}\\right) \\rho_{\\uparrow} \\rho_{\\downarrow}}{\\left(\\frac{1}{\\rho_{\\uparrow}} + \\frac{1}{\\rho_{\\downarrow}}\\right) \\rho_{\\uparrow} \\rho_{\\downarrow}} = \\frac{\\rho_{\\downarrow} - \\rho_{\\uparrow}}{\\rho_{\\downarrow} + \\rho_{\\uparrow}}\n$$\n\nFinally, we compute the numerical values of $\\rho_{\\mathrm{eff}}$ and $P$ using the given spin-channel resistivities: $\\rho_{\\uparrow} = 20 \\, \\mu\\Omega\\text{cm}$ and $\\rho_{\\downarrow} = 40 \\, \\mu\\Omega\\text{cm}$.\n\nFor the effective resistivity:\n$$\n\\rho_{\\mathrm{eff}} = \\frac{(20)(40)}{20 + 40} = \\frac{800}{60} = \\frac{40}{3} \\, \\mu\\Omega\\text{cm}\n$$\nIn decimal form, $\\rho_{\\mathrm{eff}} \\approx 13.3333... \\, \\mu\\Omega\\text{cm}$. Rounding to four significant figures, we get:\n$$\n\\rho_{\\mathrm{eff}} \\approx 13.33 \\, \\mu\\Omega\\text{cm}\n$$\n\nFor the spin conduction polarization:\n$$\nP = \\frac{40 - 20}{40 + 20} = \\frac{20}{60} = \\frac{1}{3}\n$$\nIn decimal form, $P \\approx 0.333333...$. As this is a dimensionless quantity, rounding to four significant figures gives:\n$$\nP \\approx 0.3333\n$$\nThe problem asks for the numerical values of $\\rho_{\\mathrm{eff}}$ (in $\\mu\\Omega\\text{cm}$) and $P$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n13.33 & 0.3333\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the concept of spin polarization, we now analyze a complete device—a magnetic tunnel junction (MTJ). This exercise  challenges you to explore the nonlinear behavior of an MTJ under an applied voltage, a critical aspect of real-world device operation. You will derive the differential magnetoresistance, linking the performance of the device directly to the bias-dependent nature of spin polarization in coherent tunneling.",
            "id": "3751092",
            "problem": "A magnetic tunnel junction (MTJ) with CoFeB/MgO/CoFeB electrodes is characterized at low temperature. Measured current–voltage characteristics in the parallel (P) and antiparallel (AP) magnetic configurations are well fit by the following bias-symmetric forms:\n$$\nI_{\\mathrm{P}}(V) \\;=\\; \\int_{0}^{V} G_{0}\\,\\exp\\!\\big(\\beta\\,v^{2}\\big)\\,\\left[\\,1 \\;+\\; \\left(\\frac{P_{0}}{1+\\left(\\frac{v}{V_{c}}\\right)^{2}}\\right)^{2}\\right]\\,\\mathrm{d}v,\n$$\n$$\nI_{\\mathrm{AP}}(V) \\;=\\; \\int_{0}^{V} G_{0}\\,\\exp\\!\\big(\\beta\\,v^{2}\\big)\\,\\left[\\,1 \\;-\\; \\left(\\frac{P_{0}}{1+\\left(\\frac{v}{V_{c}}\\right)^{2}}\\right)^{2}\\right]\\,\\mathrm{d}v,\n$$\nwith parameters $G_{0}=1.50\\times 10^{-3}\\,\\mathrm{S}$, $\\beta=1.80\\,\\mathrm{V}^{-2}$, $P_{0}=0.65$, and $V_{c}=0.25\\,\\mathrm{V}$. The integrands encode a bias-dependent background tunneling conductance and a bias-dependent interfacial spin polarization magnitude $P(v)=P_{0}/\\left(1+(v/V_{c})^{2}\\right)$ consistent with coherent tunneling.\n\nStarting only from the two-current picture and fundamental definitions, model the differential resistance in each state as $r_{\\mathrm{P}}(V)=\\mathrm{d}V/\\mathrm{d}I_{\\mathrm{P}}(V)$ and $r_{\\mathrm{AP}}(V)=\\mathrm{d}V/\\mathrm{d}I_{\\mathrm{AP}}(V)$, and define the differential magnetoresistance ratio as\n$$\n\\mathrm{dMR}(V)\\;\\equiv\\;\\frac{r_{\\mathrm{AP}}(V)-r_{\\mathrm{P}}(V)}{r_{\\mathrm{P}}(V)}.\n$$\nDerive an analytic expression for $\\mathrm{dMR}(V)$ in terms of the spin polarization $P(V)$ alone, then evaluate it at the bias $V^{\\star}=0.30\\,\\mathrm{V}$ using the given parameters. Round your answer to four significant figures and express it as a unitless decimal.",
            "solution": "The problem provides integral expressions for the current-voltage, $I(V)$, characteristics of a magnetic tunnel junction (MTJ) in the parallel ($P$) and antiparallel ($AP$) magnetic configurations. The integrand in each case represents the differential conductance, $G(V) = \\mathrm{d}I/\\mathrm{d}V$.\n\nFirst, we identify the differential conductance for the parallel and antiparallel states, $G_{\\mathrm{P}}(V)$ and $G_{\\mathrm{AP}}(V)$, respectively. According to the fundamental theorem of calculus, if a function $I(V)$ is defined by an integral of the form $I(V) = \\int_{0}^{V} f(v)\\,\\mathrm{d}v$, then its derivative is $\\mathrm{d}I/\\mathrm{d}V = f(V)$. Applying this to the given expressions for $I_{\\mathrm{P}}(V)$ and $I_{\\mathrm{AP}}(V)$:\n$$\nG_{\\mathrm{P}}(V) = \\frac{\\mathrm{d}I_{\\mathrm{P}}(V)}{\\mathrm{d}V} = G_{0}\\,\\exp\\!\\big(\\beta\\,V^{2}\\big)\\,\\left[\\,1 \\;+\\; \\left(\\frac{P_{0}}{1+\\left(\\frac{V}{V_{c}}\\right)^{2}}\\right)^{2}\\right]\n$$\n$$\nG_{\\mathrm{AP}}(V) = \\frac{\\mathrm{d}I_{\\mathrm{AP}}(V)}{\\mathrm{d}V} = G_{0}\\,\\exp\\!\\big(\\beta\\,V^{2}\\big)\\,\\left[\\,1 \\;-\\; \\left(\\frac{P_{0}}{1+\\left(\\frac{V}{V_{c}}\\right)^{2}}\\right)^{2}\\right]\n$$\nThe problem defines the bias-dependent interfacial spin polarization magnitude as $P(V)=P_{0}/\\left(1+(V/V_{c})^{2}\\right)$. We can substitute this definition into the expressions for the differential conductances:\n$$\nG_{\\mathrm{P}}(V) = G_{0}\\,\\exp(\\beta\\,V^{2})\\,[1 + P(V)^{2}]\n$$\n$$\nG_{\\mathrm{AP}}(V) = G_{0}\\,\\exp(\\beta\\,V^{2})\\,[1 - P(V)^{2}]\n$$\nThe problem defines the differential resistances, $r_{\\mathrm{P}}(V)$ and $r_{\\mathrm{AP}}(V)$, as the reciprocal of the differential conductances:\n$$\nr_{\\mathrm{P}}(V) = \\frac{\\mathrm{d}V}{\\mathrm{d}I_{\\mathrm{P}}(V)} = \\frac{1}{G_{\\mathrm{P}}(V)} = \\frac{1}{G_{0}\\,\\exp(\\beta\\,V^{2})\\,[1 + P(V)^{2}]}\n$$\n$$\nr_{\\mathrm{AP}}(V) = \\frac{\\mathrm{d}V}{\\mathrm{d}I_{\\mathrm{AP}}(V)} = \\frac{1}{G_{\\mathrm{AP}}(V)} = \\frac{1}{G_{0}\\,\\exp(\\beta\\,V^{2})\\,[1 - P(V)^{2}]}\n$$\nThe differential magnetoresistance ratio, $\\mathrm{dMR}(V)$, is defined as:\n$$\n\\mathrm{dMR}(V) \\equiv \\frac{r_{\\mathrm{AP}}(V)-r_{\\mathrm{P}}(V)}{r_{\\mathrm{P}}(V)} = \\frac{r_{\\mathrm{AP}}(V)}{r_{\\mathrm{P}}(V)} - 1\n$$\nWe now compute the ratio of the differential resistances, $\\frac{r_{\\mathrm{AP}}(V)}{r_{\\mathrm{P}}(V)}$:\n$$\n\\frac{r_{\\mathrm{AP}}(V)}{r_{\\mathrm{P}}(V)} = \\frac{1/\\left(G_{0}\\,\\exp(\\beta\\,V^{2})\\,[1 - P(V)^{2}]\\right)}{1/\\left(G_{0}\\,\\exp(\\beta\\,V^{2})\\,[1 + P(V)^{2}]\\right)}\n$$\nThe common prefactor $G_{0}\\,\\exp(\\beta\\,V^{2})$ cancels, yielding:\n$$\n\\frac{r_{\\mathrm{AP}}(V)}{r_{\\mathrm{P}}(V)} = \\frac{1 + P(V)^{2}}{1 - P(V)^{2}}\n$$\nSubstituting this result back into the expression for $\\mathrm{dMR}(V)$:\n$$\n\\mathrm{dMR}(V) = \\frac{1 + P(V)^{2}}{1 - P(V)^{2}} - 1\n$$\nTo simplify, we find a common denominator:\n$$\n\\mathrm{dMR}(V) = \\frac{1 + P(V)^{2} - (1 - P(V)^{2})}{1 - P(V)^{2}} = \\frac{1 + P(V)^{2} - 1 + P(V)^{2}}{1 - P(V)^{2}}\n$$\nThis simplifies to the required analytic expression for $\\mathrm{dMR}(V)$ in terms of the spin polarization $P(V)$ alone:\n$$\n\\mathrm{dMR}(V) = \\frac{2P(V)^{2}}{1 - P(V)^{2}}\n$$\nThis expression is a bias-dependent form of the Jullière model for tunneling magnetoresistance.\n\nNext, we evaluate this expression at the specified bias $V^{\\star}=0.30\\,\\mathrm{V}$. The given parameters are $P_{0}=0.65$ and $V_{c}=0.25\\,\\mathrm{V}$. First, we calculate the value of the spin polarization $P(V^{\\star})$:\n$$\nP(V^{\\star}) = P(0.30) = \\frac{P_{0}}{1+\\left(\\frac{V^{\\star}}{V_{c}}\\right)^{2}} = \\frac{0.65}{1+\\left(\\frac{0.30}{0.25}\\right)^{2}}\n$$\nThe ratio of voltages is $\\frac{0.30}{0.25} = 1.2$.\n$$\nP(0.30) = \\frac{0.65}{1 + (1.2)^{2}} = \\frac{0.65}{1 + 1.44} = \\frac{0.65}{2.44}\n$$\nNow, we calculate the square of the polarization, $P(0.30)^{2}$:\n$$\nP(0.30)^{2} = \\left(\\frac{0.65}{2.44}\\right)^{2} = \\frac{0.65^{2}}{2.44^{2}} = \\frac{0.4225}{5.9536}\n$$\nFinally, we substitute this value into the expression for $\\mathrm{dMR}(V^{\\star})$:\n$$\n\\mathrm{dMR}(0.30) = \\frac{2P(0.30)^{2}}{1 - P(0.30)^{2}} = \\frac{2\\left(\\frac{0.4225}{5.9536}\\right)}{1 - \\frac{0.4225}{5.9536}}\n$$\n$$\n\\mathrm{dMR}(0.30) = \\frac{\\frac{0.8450}{5.9536}}{\\frac{5.9536 - 0.4225}{5.9536}} = \\frac{0.8450}{5.5311}\n$$\nPerforming the division:\n$$\n\\mathrm{dMR}(0.30) \\approx 0.15277454...\n$$\nRounding the result to four significant figures, as requested, we obtain $0.1528$.",
            "answer": "$$\\boxed{0.1528}$$"
        },
        {
            "introduction": "Our final practice advances into the domain of modern device simulation using the powerful Non-Equilibrium Green's Function (NEGF) formalism. This computational exercise tasks you with building a quantum transport model of a tunnel junction from a tight-binding Hamiltonian . By calculating spin-resolved transmission, you will directly connect the device's microscopic parameters to its macroscopic Tunnel Magnetoresistance (TMR), gaining insights that transcend simplified analytical models.",
            "id": "3751130",
            "problem": "Consider a one-dimensional Ferromagnet–Insulator–Ferromagnet (FM–I–FM) tunnel junction modeled by a tight-binding central region of $N$ sites with uniform on-site energy $U$ (in $\\mathrm{eV}$) and nearest-neighbor hopping amplitude $t$ (in $\\mathrm{eV}$). The central region is connected to two semi-infinite ferromagnetic leads through the first and last sites. Each lead is treated within the wide-band approximation, yielding energy-independent spin-resolved coupling matrices. The left and right lead coupling strengths are parameterized by scalars $\\Gamma_{\\mathrm{L}}$ and $\\Gamma_{\\mathrm{R}}$ (in $\\mathrm{eV}$), and their spin polarizations are $p_{\\mathrm{L}}$ and $p_{\\mathrm{R}}$ (dimensionless, between $0$ and $1$). You will analyze the Parallel (P) and Antiparallel (AP) magnetization states, compute spin-resolved transmission spectra, and determine the Tunnel Magnetoresistance (TMR).\n\nFundamental base:\n- Use the Landauer–Büttiker formalism for coherent transport and the Non-Equilibrium Green’s Function (NEGF) method. The retarded Green’s function for spin channel $s \\in \\{\\uparrow, \\downarrow\\}$ of the central region is given by\n$$\nG^{r}_{s}(E) = \\left[ (E + i\\eta)\\, I - H_{\\mathrm{C}} - \\Sigma^{s}_{\\mathrm{L}} - \\Sigma^{s}_{\\mathrm{R}} \\right]^{-1},\n$$\nwhere $H_{\\mathrm{C}}$ is the central Hamiltonian, $\\Sigma^{s}_{\\mathrm{L}}$ and $\\Sigma^{s}_{\\mathrm{R}}$ are the left and right lead self-energies for spin $s$, $I$ is the identity matrix, $E$ is energy (in $\\mathrm{eV}$), and $\\eta$ is a positive infinitesimal for numerical stability.\n- The wide-band approximation yields purely imaginary and energy-independent self-energies at the end sites: $\\Sigma^{s}_{\\mathrm{L}} = -\\dfrac{i}{2}\\Gamma^{s}_{\\mathrm{L}}\\, |1\\rangle\\langle 1|$, $\\Sigma^{s}_{\\mathrm{R}} = -\\dfrac{i}{2}\\Gamma^{s}_{\\mathrm{R}}\\, |N\\rangle\\langle N|$, where $\\Gamma^{s}_{\\mathrm{L}}$ and $\\Gamma^{s}_{\\mathrm{R}}$ are the spin-resolved coupling strengths for the left and right leads.\n- The spin-resolved transmission for spin $s$ is\n$$\nT_{s}(E) = \\operatorname{Tr}\\left[ \\Gamma^{s}_{\\mathrm{L}}\\, G^{r}_{s}(E)\\, \\Gamma^{s}_{\\mathrm{R}}\\, G^{a}_{s}(E)\\right],\n$$\nwith $G^{a}_{s}(E) = \\left(G^{r}_{s}(E)\\right)^{\\dagger}$ the advanced Green’s function. For coupling only at the first and last sites, this reduces to\n$$\nT_{s}(E) = \\Gamma^{s}_{\\mathrm{L}}\\, \\Gamma^{s}_{\\mathrm{R}}\\, \\left| G^{r}_{s}(E)_{1N} \\right|^{2}.\n$$\n\nSpin-dependent couplings for magnetization configurations:\n- For the Parallel (P) state: $\\Gamma^{\\uparrow}_{\\alpha} = \\Gamma_{\\alpha}\\,(1+p_{\\alpha})$ and $\\Gamma^{\\downarrow}_{\\alpha} = \\Gamma_{\\alpha}\\,(1-p_{\\alpha})$ for $\\alpha \\in \\{\\mathrm{L}, \\mathrm{R}\\}$.\n- For the Antiparallel (AP) state: the right lead flips its spin labeling, yielding $\\Gamma^{\\uparrow}_{\\mathrm{L}} = \\Gamma_{\\mathrm{L}}\\,(1+p_{\\mathrm{L}})$, $\\Gamma^{\\downarrow}_{\\mathrm{L}} = \\Gamma_{\\mathrm{L}}\\,(1-p_{\\mathrm{L}})$, $\\Gamma^{\\uparrow}_{\\mathrm{R}} = \\Gamma_{\\mathrm{R}}\\,(1-p_{\\mathrm{R}})$, and $\\Gamma^{\\downarrow}_{\\mathrm{R}} = \\Gamma_{\\mathrm{R}}\\,(1+p_{\\mathrm{R}})$.\n\nTasks:\n1. Construct the central tight-binding Hamiltonian $H_{\\mathrm{C}}$ of dimension $N \\times N$ with diagonal entries $U$ and off-diagonal nearest-neighbor entries $-t$.\n2. For each test case, compute spin-resolved transmission spectra $T_{\\uparrow}(E)$ and $T_{\\downarrow}(E)$ for both P and AP configurations over an energy grid from $E_{\\min}=-3\\,\\mathrm{eV}$ to $E_{\\max}=+3\\,\\mathrm{eV}$ sampled uniformly with $401$ points. Use $\\eta=10^{-9}\\,\\mathrm{eV}$.\n3. At zero temperature, the total conductance is proportional to the transmission at the Fermi energy $E_{\\mathrm{F}}$ since the derivative of the Fermi–Dirac distribution becomes a Dirac delta function. Use this to compute the total transmissions at $E_{\\mathrm{F}}$:\n$$\nT_{\\mathrm{P}}(E_{\\mathrm{F}}) = T_{\\uparrow,\\mathrm{P}}(E_{\\mathrm{F}}) + T_{\\downarrow,\\mathrm{P}}(E_{\\mathrm{F}}),\n\\quad\nT_{\\mathrm{AP}}(E_{\\mathrm{F}}) = T_{\\uparrow,\\mathrm{AP}}(E_{\\mathrm{F}}) + T_{\\downarrow,\\mathrm{AP}}(E_{\\mathrm{F}}).\n$$\n4. Define the Tunnel Magnetoresistance (TMR) ratio as the dimensionless decimal\n$$\n\\mathrm{TMR} = \\frac{T_{\\mathrm{P}}(E_{\\mathrm{F}}) - T_{\\mathrm{AP}}(E_{\\mathrm{F}})}{\\max\\left(T_{\\mathrm{AP}}(E_{\\mathrm{F}}),\\, \\varepsilon\\right)},\n$$\nwith a small regularization $\\varepsilon = 10^{-12}$ to avoid division by zero. Report $\\mathrm{TMR}$ as a decimal (no percentage sign).\n\nPhysical units:\n- Energies $E$, $U$, $t$, $\\Gamma_{\\mathrm{L}}$, $\\Gamma_{\\mathrm{R}}$, and $E_{\\mathrm{F}}$ are in $\\mathrm{eV}$.\n- Transmissions $T_{s}(E)$ and the TMR ratio are dimensionless.\n\nTest suite:\nProvide results for the following parameter sets, all at zero temperature:\n- Case 1 (general FM–I–FM): $N=3$, $t=1.0\\,\\mathrm{eV}$, $U=0.8\\,\\mathrm{eV}$, $E_{\\mathrm{F}}=0.0\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{L}}=0.6\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{R}}=0.6\\,\\mathrm{eV}$, $p_{\\mathrm{L}}=0.4$, $p_{\\mathrm{R}}=0.4$.\n- Case 2 (boundary, nonmagnetic leads): $N=3$, $t=1.0\\,\\mathrm{eV}$, $U=0.8\\,\\mathrm{eV}$, $E_{\\mathrm{F}}=0.0\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{L}}=0.6\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{R}}=0.6\\,\\mathrm{eV}$, $p_{\\mathrm{L}}=0.0$, $p_{\\mathrm{R}}=0.0$.\n- Case 3 (asymmetric couplings and polarizations): $N=5$, $t=1.0\\,\\mathrm{eV}$, $U=0.5\\,\\mathrm{eV}$, $E_{\\mathrm{F}}=0.2\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{L}}=0.2\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{R}}=1.0\\,\\mathrm{eV}$, $p_{\\mathrm{L}}=0.6$, $p_{\\mathrm{R}}=0.2$.\n- Case 4 (high barrier): $N=3$, $t=1.0\\,\\mathrm{eV}$, $U=2.5\\,\\mathrm{eV}$, $E_{\\mathrm{F}}=0.0\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{L}}=0.3\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{R}}=0.3\\,\\mathrm{eV}$, $p_{\\mathrm{L}}=0.5$, $p_{\\mathrm{R}}=0.5$.\n- Case 5 (near band edge of the central region): $N=5$, $t=1.0\\,\\mathrm{eV}$, $U=0.0\\,\\mathrm{eV}$, $E_{\\mathrm{F}}=1.95\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{L}}=0.5\\,\\mathrm{eV}$, $\\Gamma_{\\mathrm{R}}=0.5\\,\\mathrm{eV}$, $p_{\\mathrm{L}}=0.3$, $p_{\\mathrm{R}}=0.3$.\n\nYour program must:\n- Compute $T_{\\uparrow}(E)$ and $T_{\\downarrow}(E)$ for the P and AP configurations over the specified energy grid for each case.\n- Compute the corresponding $\\mathrm{TMR}$ using the zero-temperature assumption at the specified $E_{\\mathrm{F}}$.\n- Produce a single line of output containing the $\\mathrm{TMR}$ values for the five cases as a comma-separated list enclosed in square brackets, each value rounded to six decimal places (e.g., $\\left[\\mathrm{tmr}_{1},\\mathrm{tmr}_{2},\\mathrm{tmr}_{3},\\mathrm{tmr}_{4},\\mathrm{tmr}_{5}\\right]$).\n\nNo user input should be required; hard-code the test suite parameters in the program.",
            "solution": "The user has provided a problem that is scientifically grounded, well-posed, and objective. It is based on standard principles of quantum transport theory (Non-Equilibrium Green's Function formalism and Landauer–Büttiker formula) applied to a model magnetic tunnel junction. All parameters and tasks are clearly defined, and there are no contradictions or ambiguities. The problem is valid and can be solved as stated.\n\nThe solution will be developed by following the theoretical framework and computational steps outlined in the problem description.\n\n### 1. Theoretical Framework\n\nThe problem is to compute the Tunnel Magnetoresistance (TMR) of a Ferromagnet-Insulator-Ferromagnet (FM-I-FM) junction. The transport properties are described using the Non-Equilibrium Green's Function (NEGF) formalism. The central region (insulator) is modeled as a one-dimensional tight-binding chain of $N$ sites. The key physical quantity is the spin-resolved transmission function, $T_s(E)$, for spin channel $s \\in \\{\\uparrow, \\downarrow\\}$.\n\n### 2. Hamiltonian and Self-Energies\n\nFirst, we construct the Hamiltonian for the isolated central region, $H_{\\mathrm{C}}$. It is an $N \\times N$ matrix representing a tight-binding chain with uniform on-site energy $U$ and nearest-neighbor hopping amplitude $-t$.\n$$\nH_{\\mathrm{C}} =\n\\begin{pmatrix}\nU & -t & 0 & \\dots & 0 \\\\\n-t & U & -t & \\dots & 0 \\\\\n0 & -t & U & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & -t \\\\\n0 & 0 & \\dots & -t & U\n\\end{pmatrix}\n$$\n\nThe influence of the semi-infinite left (L) and right (R) leads is incorporated through self-energy matrices, $\\Sigma^s_{\\mathrm{L}}$ and $\\Sigma^s_{\\mathrm{R}}$. Within the wide-band approximation, these are purely imaginary, energy-independent, and local to the connection sites (site $1$ and site $N$).\nFor a given spin channel $s$, the self-energies are $N \\times N$ matrices that are zero everywhere except for single elements:\n$$\n\\left(\\Sigma^{s}_{\\mathrm{L}}\\right)_{11} = -\\frac{i}{2}\\Gamma^{s}_{\\mathrm{L}}\n$$\n$$\n\\left(\\Sigma^{s}_{\\mathrm{R}}\\right)_{NN} = -\\frac{i}{2}\\Gamma^{s}_{\\mathrm{R}}\n$$\nHere, $\\Gamma^{s}_{\\mathrm{L}}$ and $\\Gamma^{s}_{\\mathrm{R}}$ are the scalar spin-dependent coupling strengths.\n\n### 3. Green's Function and Transmission\n\nThe retarded Green's function for spin channel $s$ at energy $E$ is the inverse of the effective Hamiltonian of the central region including the leads:\n$$\nG^{r}_{s}(E) = \\left[ (E + i\\eta)I - H_{\\mathrm{C}} - \\Sigma^{s}_{\\mathrm{L}} - \\Sigma^{s}_{\\mathrm{R}} \\right]^{-1}\n$$\nwhere $I$ is the $N \\times N$ identity matrix and $\\eta$ is a small positive real number ($10^{-9}\\,\\mathrm{eV}$) to ensure causality and numerical stability.\n\nThe spin-resolved transmission $T_s(E)$ is given by the formula:\n$$\nT_{s}(E) = \\Gamma^{s}_{\\mathrm{L}} \\Gamma^{s}_{\\mathrm{R}} \\left| G^{r}_{s}(E)_{1N} \\right|^{2}\n$$\nwhere $G^{r}_{s}(E)_{1N}$ is the element of the Green's function matrix connecting the first site to the last site. This element represents the probability amplitude for an electron to propagate through the entire central region.\n\n### 4. Magnetization Configurations and Spin-Dependent Couplings\n\nThe problem considers two magnetic configurations: Parallel (P) and Antiparallel (AP). The spin-dependent coupling strengths $\\Gamma^s_\\alpha$ for $\\alpha \\in \\{\\mathrm{L}, \\mathrm{R}\\}$ are determined by the lead's total coupling strength $\\Gamma_\\alpha$ and its spin polarization $p_\\alpha$.\n\n**Parallel (P) Configuration:** The lead magnetizations are aligned.\n$$\n\\Gamma^{\\uparrow}_{\\alpha} = \\Gamma_{\\alpha}(1+p_{\\alpha})\n$$\n$$\n\\Gamma^{\\downarrow}_{\\alpha} = \\Gamma_{\\alpha}(1-p_{\\alpha})\n$$\nfor both $\\alpha = \\mathrm{L}$ and $\\alpha = \\mathrm{R}$.\n\n**Antiparallel (AP) Configuration:** The right lead's magnetization is flipped relative to the left. This is modeled by flipping the spin labels for the right lead's coupling.\n$$\n\\Gamma^{\\uparrow}_{\\mathrm{L}} = \\Gamma_{\\mathrm{L}}(1+p_{\\mathrm{L}}), \\quad \\Gamma^{\\downarrow}_{\\mathrm{L}} = \\Gamma_{\\mathrm{L}}(1-p_{\\mathrm{L}})\n$$\n$$\n\\Gamma^{\\uparrow}_{\\mathrm{R}} = \\Gamma_{\\mathrm{R}}(1-p_{\\mathrm{R}}), \\quad \\Gamma^{\\downarrow}_{\\mathrm{R}} = \\Gamma_{\\mathrm{R}}(1+p_{\\mathrm{R}})\n$$\n\n### 5. TMR Calculation\nAt zero temperature, the electrical conductance is proportional to the transmission evaluated at the Fermi energy, $E_{\\mathrm{F}}$. The total transmission for a given configuration (P or AP) is the sum of the transmissions from the two spin channels:\n$$\nT_{\\mathrm{P/AP}}(E_{\\mathrm{F}}) = T_{\\uparrow, \\mathrm{P/AP}}(E_{\\mathrm{F}}) + T_{\\downarrow, \\mathrm{P/AP}}(E_{\\mathrm{F}})\n$$\n\nThe Tunnel Magnetoresistance (TMR) ratio is then calculated as the normalized difference between the total transmissions in the P and AP configurations:\n$$\n\\mathrm{TMR} = \\frac{T_{\\mathrm{P}}(E_{\\mathrm{F}}) - T_{\\mathrm{AP}}(E_{\\mathrm{F}})}{\\max\\left(T_{\\mathrm{AP}}(E_{\\mathrm{F}}),\\, \\varepsilon\\right)}\n$$\nThe regularization parameter $\\varepsilon = 10^{-12}$ prevents division by zero if $T_{\\mathrm{AP}}(E_{\\mathrm{F}})$ is vanishingly small.\n\n### 6. Algorithmic Implementation\n\nFor each test case specified:\n1.  The parameters ($N, t, U, E_{\\mathrm{F}}, \\Gamma_{\\mathrm{L}}, \\Gamma_{\\mathrm{R}}, p_{\\mathrm{L}}, p_{\\mathrm{R}}$) are defined.\n2.  The central Hamiltonian $H_{\\mathrm{C}}$ is constructed.\n3.  A function is implemented to calculate the total transmission $T(E_{\\mathrm{F}})$ for a given configuration ('P' or 'AP'). This function iterates through spin up ($\\uparrow$) and spin down ($\\downarrow$):\n    a. It calculates the spin-dependent couplings $\\Gamma^s_\\mathrm{L}$ and $\\Gamma^s_\\mathrm{R}$ based on the configuration.\n    b. It constructs the self-energy matrices $\\Sigma^s_\\mathrm{L}$ and $\\Sigma^s_\\mathrm{R}$.\n    c. It forms the matrix $M_s = (E_{\\mathrm{F}} + i\\eta)I - H_{\\mathrm{C}} - \\Sigma^s_\\mathrm{L} - \\Sigma^s_\\mathrm{R}$.\n    d. It computes the inverse $G^r_s = M_s^{-1}$ using a standard linear algebra library.\n    e. It extracts the element $G^r_s(E_\\mathrm{F})_{1N}$ and calculates the spin-resolved transmission $T_s(E_\\mathrm{F})$.\n    f. The spin-resolved transmissions are summed to get the total transmission for the configuration.\n4.  This function is called for both 'P' and 'AP' configurations to obtain $T_{\\mathrm{P}}(E_{\\mathrm{F}})$ and $T_{\\mathrm{AP}}(E_{\\mathrm{F}})$.\n5.  The final TMR value is computed using the formula above.\n6.  The process is repeated for all test cases, and the results are collected and formatted as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Tunnel Magnetoresistance (TMR) for a series of\n    Ferromagnet-Insulator-Ferromagnet (FM-I-FM) junctions.\n    \"\"\"\n    # Global constants from the problem statement\n    ETA = 1e-9  # Infinitesimal for retarded Green's function\n    EPSILON = 1e-12  # Regularization parameter for TMR denominator\n\n    def calculate_total_transmission_at_ef(params, config):\n        \"\"\"\n        Calculates the total transmission (spin-up + spin-down) at the Fermi energy\n        for a given magnetic configuration ('P' or 'AP').\n        \"\"\"\n        N = params['N']\n        t = params['t']\n        U = params['U']\n        E_F = params['E_F']\n        Gamma_L_scalar = params['Gamma_L']\n        Gamma_R_scalar = params['Gamma_R']\n        p_L = params['p_L']\n        p_R = params['p_R']\n\n        # 1. Construct the central Hamiltonian H_C\n        Hc = np.diag(np.full(N, U))\n        if N > 1:\n            off_diag = np.full(N - 1, -t)\n            Hc += np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n\n        # 2. Determine spin-resolved coupling strengths based on configuration\n        Gamma_L_up = Gamma_L_scalar * (1 + p_L)\n        Gamma_L_down = Gamma_L_scalar * (1 - p_L)\n\n        if config == 'P':\n            Gamma_R_up = Gamma_R_scalar * (1 + p_R)\n            Gamma_R_down = Gamma_R_scalar * (1 - p_R)\n        elif config == 'AP':\n            # As per problem, right lead flips its spin labeling\n            Gamma_R_up = Gamma_R_scalar * (1 - p_R)\n            Gamma_R_down = Gamma_R_scalar * (1 + p_R)\n        else:\n            raise ValueError(\"Configuration must be 'P' or 'AP'\")\n\n        spin_couplings = {\n            'up':   (Gamma_L_up, Gamma_R_up),\n            'down': (Gamma_L_down, Gamma_R_down)\n        }\n\n        total_transmission = 0.0\n\n        # 3. Iterate over spin channels (up and down)\n        for spin in ['up', 'down']:\n            Gam_L_s, Gam_R_s = spin_couplings[spin]\n\n            # 4. Construct self-energy matrices\n            Sigma_L = np.zeros((N, N), dtype=complex)\n            Sigma_R = np.zeros((N, N), dtype=complex)\n            \n            Sigma_L[0, 0] = -0.5j * Gam_L_s\n            Sigma_R[N-1, N-1] = -0.5j * Gam_R_s\n\n            # 5. Form the matrix for inversion to get G^r\n            M = (E_F + 1j * ETA) * np.eye(N) - Hc - Sigma_L - Sigma_R\n            \n            # 6. Calculate the retarded Green's function matrix\n            try:\n                Gr = np.linalg.inv(M)\n            except np.linalg.LinAlgError:\n                # Should not occur with non-zero eta, but as a safeguard\n                continue\n\n            # 7. Extract the (1,N) element (0-indexed: [0, N-1])\n            Gr_1N = Gr[0, N-1]\n\n            # 8. Calculate spin-resolved transmission and add to total\n            Ts = Gam_L_s * Gam_R_s * (np.abs(Gr_1N)**2)\n            total_transmission += Ts\n            \n        return total_transmission\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general FM–I–FM\n        {'N': 3, 't': 1.0, 'U': 0.8, 'E_F': 0.0, 'Gamma_L': 0.6, 'Gamma_R': 0.6, 'p_L': 0.4, 'p_R': 0.4},\n        # Case 2: nonmagnetic leads\n        {'N': 3, 't': 1.0, 'U': 0.8, 'E_F': 0.0, 'Gamma_L': 0.6, 'Gamma_R': 0.6, 'p_L': 0.0, 'p_R': 0.0},\n        # Case 3: asymmetric couplings and polarizations\n        {'N': 5, 't': 1.0, 'U': 0.5, 'E_F': 0.2, 'Gamma_L': 0.2, 'Gamma_R': 1.0, 'p_L': 0.6, 'p_R': 0.2},\n        # Case 4: high barrier\n        {'N': 3, 't': 1.0, 'U': 2.5, 'E_F': 0.0, 'Gamma_L': 0.3, 'Gamma_R': 0.3, 'p_L': 0.5, 'p_R': 0.5},\n        # Case 5: near band edge of the central region\n        {'N': 5, 't': 1.0, 'U': 0.0, 'E_F': 1.95, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'p_L': 0.3, 'p_R': 0.3},\n    ]\n\n    results = []\n    for params in test_cases:\n        # Calculate total transmission for Parallel (P) configuration\n        T_P = calculate_total_transmission_at_ef(params, 'P')\n        \n        # Calculate total transmission for Antiparallel (AP) configuration\n        T_AP = calculate_total_transmission_at_ef(params, 'AP')\n        \n        # Calculate the TMR ratio\n        tmr = (T_P - T_AP) / max(T_AP, EPSILON)\n        results.append(tmr)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}