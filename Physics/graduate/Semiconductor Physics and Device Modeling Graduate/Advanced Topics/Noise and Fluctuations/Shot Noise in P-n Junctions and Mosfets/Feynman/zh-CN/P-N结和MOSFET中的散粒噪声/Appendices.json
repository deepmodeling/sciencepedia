{
    "hands_on_practices": [
        {
            "introduction": "在实际电路中，不同的元件会产生不同类型的噪声。这项练习提供了一个基本但至关重要的场景，要求我们比较一个简单串联电路中两种基本噪声源的贡献：由非平衡电流产生的二极管散粒噪声和由平衡热涨落产生的电阻热噪声。通过构建小信号噪声模型，这项练习可以磨练我们辨别和量化不同噪声源的能力，并确定在特定工作条件下哪种噪声占主导地位。",
            "id": "3772335",
            "problem": "一个硅$p$-$n$结二极管通过一个串联电阻由一个理想（无噪声）电压源正向偏置。要求您将二极管中载流子离散性的贡献与电阻的平衡涨落进行比较，方法是将两者都关联到同一个可测量量上：单一串联支路中的小信号电流涨落。请在以下器件和工作假设下进行分析：\n\n- 二极管为扩散主导型，在温度$T=300\\,\\mathrm{K}$时，理想因子$n=1.00$。\n- 稳态正向电流为$I=1.00\\times 10^{-3}\\,\\mathrm{A}$。\n- 串联电阻的阻值为$R_{s}=10.0\\,\\Omega$，且处于相同温度$T=300\\,\\mathrm{K}$。\n- 电源为理想电压源（零内阻且无噪声）。\n- 低频工作：忽略$1/f$噪声和产生-复合噪声；将所有噪声源视为在感兴趣的频带内为白噪声。\n- 将二极管处理为其小信号动态电阻和一个与电荷离散性相关的电流噪声源。将电阻处理为热搅动的涨落-耗散结果。\n\n从适用于半导体输运和平衡统计力学的基本原理（离散电荷流的载流子到达统计，以及电阻元件的涨落-耗散定理）出发，并利用二极管$I$-$V$关系的小信号线性化将内部噪声源与可测量的支路电流联系起来，推导出二极管的散粒噪声对串联支路电流噪声谱密度的贡献与电阻的热噪声对同一串联支路电流噪声谱密度的贡献之比$\\mathcal{R}$的表达式。然后，使用上述参数以及$q=1.602\\times 10^{-19}\\,\\mathrm{C}$和$k_{B}=1.381\\times 10^{-23}\\,\\mathrm{J/K}$对$\\mathcal{R}$进行数值计算。\n\n将最终比率表示为一个纯数（无单位）。将您的答案四舍五入到四位有效数字。",
            "solution": "本问题要求比较一个正向偏置$p$-$n$结二极管的散粒噪声贡献和一个串联电阻的热噪声贡献对电路中总电流噪声的影响。我们将对噪声源进行建模，构建一个小信号等效电路，然后计算它们各自对支路电流噪声谱密度的贡献之比。\n\n首先，我们根据基本原理定义噪声源。\n\n1.  **二极管散粒噪声：** $p$-$n$结中的电流源于离散的电荷载流子（电子和空穴）穿过耗尽区的势垒。这个流动是一个随机过程。在正向偏置下，净电流$I$是大的正向注入电流$I_f$与小的反向饱和电流$I_s$之差。$I_f$和$I_s$都源于载流子的随机到达，各自构成一个泊松过程。总均方散粒噪声电流谱密度$S_{i,d}(f)$是这两个独立流的噪声之和：\n    $$S_{i,d}(f) = 2qI_f + 2qI_s = 2q(I_f + I_s)$$\n    二极管的电流-电压关系由$I = I_f - I_s = I_s(\\exp(\\frac{qV}{nk_BT}) - 1)$给出。由此，我们可以将正向电流写为$I_f = I + I_s$。将此代入噪声表达式中得到：\n    $$S_{i,d}(f) = 2q(I + 2I_s)$$\n    对于一个正向电流为$I=1.00\\times 10^{-3}\\,\\mathrm{A}$的二极管，该电流比典型的反向饱和电流$I_s$（对于硅材料，其值通常在皮安到纳安范围内）大许多个数量级。因此，我们可以做出一个极好的近似$I \\gg I_s$，这将噪声谱密度简化为标准的Schottky公式：\n    $$S_{i,d}(f) \\approx 2qI$$\n    这是一个白噪声源，因此其谱密度在感兴趣的频率$f$范围内是独立的。\n\n2.  **电阻热噪声：** 在热平衡状态下，电阻中电荷载流子的热搅动导致其两端产生随机的电压涨落。这被称为Johnson-Nyquist噪声。涨落-耗散定理指出，对于温度为$T$的电阻$R_s$，其均方热噪声电压谱密度$S_{v,s}(f)$为：\n    $$S_{v,s}(f) = 4k_BTR_s$$\n    其中$k_B$是玻尔兹曼常数。这也是一个白噪声源。我们将此噪声建模为一个与无噪声电阻$R_s$串联的Thevenin等效电压源$v_{ns}$。\n\n接下来，我们建立电路的小信号模型。理想直流电压源的内阻为零，因此可视为交流地。该电路由串联电阻$R_s$和二极管组成。二极管由其小信号等效模型替代：其动态电阻$r_d$与其散粒噪声电流源$i_{nd}$并联，该电流源的谱密度为$S_{i,d}(f)$。\n\n二极管的动态电阻$r_d$是其动态电导$g_d = \\frac{dI}{dV}$的倒数：\n$$g_d = \\frac{d}{dV} \\left[ I_s \\left( \\exp\\left(\\frac{qV}{nk_BT}\\right) - 1 \\right) \\right] = \\frac{qI_s}{nk_BT} \\exp\\left(\\frac{qV}{nk_BT}\\right)$$\n注意到$I + I_s = I_s \\exp(\\frac{qV}{nk_BT})$，我们有：\n$$g_d = \\frac{q(I+I_s)}{nk_BT}$$\n应用同样的近似$I \\gg I_s$，我们得到：\n$$g_d \\approx \\frac{qI}{nk_BT}$$\n因此，动态电阻为：\n$$r_d = \\frac{1}{g_d} \\approx \\frac{nk_BT}{qI}$$\n用于噪声分析的小信号交流等效电路由电阻$R_s$及其串联噪声电压源$v_{ns}$组成，与二极管的动态电阻$r_d$串联。二极管的噪声由一个与$r_d$并联的电流源$i_{nd}$表示。为了便于在串联电路中分析，我们可以将二极管的Norton噪声模型（电流源$i_{nd}$与$r_d$并联）转换为其Thevenin等效模型：一个电压源$v_{nd} = i_{nd}r_d$与$r_d$串联。这个等效电压源的谱密度为：\n$$S_{v,d}(f) = S_{i,d}(f) r_d^2 = (2qI) r_d^2$$\n现在，完整的小信号噪声等效电路是一个单回路，包含两个无噪声电阻$R_s$和$r_d$，以及两个不相关的串联噪声电压源$v_{ns}$和$v_{nd}$，其谱密度分别为$S_{v,s}(f)$和$S_{v,d}(f)$。\n\n支路的总串联阻抗为$Z_{tot} = R_s + r_d$。支路电流涨落$\\delta i_{branch}$是由这两个噪声源引起的。由于它们不相关，我们可以通过将各源的贡献相加来求得总均方电流噪声谱密度$S_{i,branch}(f)$：\n$$S_{i,branch}(f) = S_{i,branch,d}(f) + S_{i,branch,s}(f)$$\n来自二极管噪声源$v_{nd}$的贡献是：\n$$S_{i,branch,d}(f) = \\frac{S_{v,d}(f)}{(R_s+r_d)^2} = \\frac{2qI r_d^2}{(R_s+r_d)^2}$$\n来自电阻噪声源$v_{ns}$的贡献是：\n$$S_{i,branch,s}(f) = \\frac{S_{v,s}(f)}{(R_s+r_d)^2} = \\frac{4k_BTR_s}{(R_s+r_d)^2}$$\n问题要求的是二极管贡献与电阻贡献之比$\\mathcal{R}$：\n$$\\mathcal{R} = \\frac{S_{i,branch,d}(f)}{S_{i,branch,s}(f)} = \\frac{\\frac{2qI r_d^2}{(R_s+r_d)^2}}{\\frac{4k_BTR_s}{(R_s+r_d)^2}}$$\n分母项$(R_s+r_d)^2$可以消去，得到：\n$$\\mathcal{R} = \\frac{2qI r_d^2}{4k_BTR_s} = \\frac{qI r_d^2}{2k_BTR_s}$$\n这是一个比率的中间表达式。为了得到用给定参数表示的结果，我们代入$r_d$的表达式：\n$$\\mathcal{R} = \\frac{qI}{2k_BTR_s} \\left( \\frac{nk_BT}{qI} \\right)^2 = \\frac{qI}{2k_BTR_s} \\frac{n^2(k_BT)^2}{(qI)^2}$$\n简化此表达式得到比率的最终符号形式：\n$$\\mathcal{R} = \\frac{n^2 k_B T}{2qI R_s}$$\n另一种富有洞察力的形式是$\\mathcal{R} = \\frac{n r_d}{2 R_s}$，这突出了噪声贡献之比与电路中动态电阻和静态电阻之比直接相关。\n\n现在，我们使用给定的数值对该表达式进行数值计算：\n- 理想因子 $n = 1.00$\n- 温度 $T = 300\\,\\mathrm{K}$\n- 直流电流 $I = 1.00\\times 10^{-3}\\,\\mathrm{A}$\n- 串联电阻 $R_s = 10.0\\,\\Omega$\n- 基本电荷 $q = 1.602\\times 10^{-19}\\,\\mathrm{C}$\n- 玻尔兹曼常数 $k_B = 1.381\\times 10^{-23}\\,\\mathrm{J/K}$\n\n将这些值代入导出的$\\mathcal{R}$表达式中：\n$$\\mathcal{R} = \\frac{(1.00)^2 \\times (1.381\\times 10^{-23}\\,\\mathrm{J/K}) \\times (300\\,\\mathrm{K})}{2 \\times (1.602\\times 10^{-19}\\,\\mathrm{C}) \\times (1.00\\times 10^{-3}\\,\\mathrm{A}) \\times (10.0\\,\\Omega)}$$\n$$\\mathcal{R} = \\frac{4.143\\times 10^{-21}\\,\\mathrm{J}}{3.204\\times 10^{-21}\\,\\mathrm{J}}$$\n$$\\mathcal{R} \\approx 1.29307116$$\n按照要求将结果四舍五入到四位有效数字，我们得到$\\mathcal{R} \\approx 1.293$。这表明，在这些特定的工作条件下，二极管的散粒噪声对总电流涨落的贡献比电阻的热噪声贡献大约高出$29.3\\%$。",
            "answer": "$$\\boxed{1.293}$$"
        },
        {
            "introduction": "在测量微弱信号时，例如反向偏置二极管的纳安级漏电流，噪声往往是主要的限制因素。本练习将散粒噪声的泊松模型应用于低电流场景，并分析了实际前置放大器电路如何处理噪声信号。这项练习将抽象的噪声理论与实际测量联系起来，促使我们思考带宽、放大器自身噪声和信噪比等在观测微弱物理效应时的关键作用。",
            "id": "3772330",
            "problem": "一个硅$p$-$n$结二极管在室温下被反向偏置，其平均漏电流为 $I_{D} = 10\\ \\text{nA}$。假设载流子渡越耗尽区是受泊松计数统计支配的独立事件，并且在感兴趣的频率范围内，产生-复合噪声和闪烁噪声可以忽略不计。该二极管连接到一个金属-氧化物-半导体场效应晶体管（MOSFET）前置放大器的输入节点，为了进行噪声传输分析，该前置放大器被建模为一个理想的无噪声电压表，用于观测一个对地并联的电阻-电容对上的节点电压。具体来说，输入节点由一个 $R_{L} = 100\\ \\text{k}\\Omega$ 的并联电阻和一个 $C_{\\text{in}} = 10\\ \\text{pF}$ 的总电容并联组成，该总电容包括二极管结电容和放大器栅极电容。MOSFET前置放大器贡献了一个与二极管并联的、输入参考的、频谱呈白色的电流噪声密度 $i_{a} = 2\\ \\text{fA}/\\sqrt{\\text{Hz}}$。忽略 $R_{L}$ 的Johnson–Nyquist热噪声和任何放大器电压噪声，因此只有二极管的散粒噪声和放大器的电流噪声驱动该节点。\n\n从反向偏置$p$-$n$结中泊松散粒噪声的第一性原理出发，通过对二极管的电流噪声功率谱密度与节点的电流-电压转换阻抗的幅度平方的乘积进行频率积分，推导一个仅由二极管散粒噪声引起的输入节点上的均方根（RMS）输出电压的表达式。然后，使用给定的数值计算此RMS电压。将您的最终数值答案四舍五入到三位有效数字，并以 $\\mu\\text{V}$ 为单位表示。\n\n此外，基于您的推导，简要指出由放大器的输入电流噪声和有限的输入电容所带来的主要测量挑战，并解释在此配置中，它们各自如何影响二极管散粒噪声的可观测性。\n\n您可能需要的物理常数：元电荷 $q$。\n\n请仅提供由二极管散粒噪声引起的RMS电压的单一数值作为您的最终答案，并按照要求的精度和单位进行四舍五入。",
            "solution": "目标是估算二极管的散粒噪声，并使其在测量网络中传播。我们从反向偏置$p$-$n$结中散粒噪声的微观起源开始。\n\n1. 散粒噪声的泊松起源和谱密度：\n在反向偏置下，穿过耗尽区的载流子（电子或空穴）是电荷为 $q$ 的离散量子。如果发射和渡越事件不相关，并且遵循平均到达率为 $\\lambda$ 的泊松点过程，那么总电流可以建模为一系列脉冲之和：\n$$\ni(t) = \\sum_{k} q\\,\\delta\\!\\left(t - t_{k}\\right),\n$$\n其中 $\\{t_{k}\\}$ 是速率为 $\\lambda$ 的随机到达时间。平均电流为 $\\langle i(t)\\rangle = q \\lambda \\equiv I$。对于泊松过程，电流涨落是白色的，直至由渡越动力学设定的频率，其双边电流噪声功率谱密度（PSD）为\n$$\nS_{i} = 2\\,q\\,I,\n$$\n这是计数统计中一个公认的结果。在泊松近似成立的感兴趣频率范围内，我们将使用此谱密度作为二极管散粒噪声的基础描述。\n\n2. 测量网络和电流-电压转换：\n二极管散粒噪声电流源驱动输入节点，该节点呈现为一个并联电阻 $R_{L}$ 与电容 $C_{\\text{in}}$ 并联。节点电压 $v(t)$ 通过并联网络的阻抗与驱动电流相关：\n$$\nZ(j\\omega) = \\frac{R_{L}}{1 + j\\omega R_{L} C_{\\text{in}}}.\n$$\n因此，电流-电压传递函数的幅度平方为\n$$\n|Z(j\\omega)|^{2} = \\frac{R_{L}^{2}}{1 + \\omega^{2} R_{L}^{2} C_{\\text{in}}^{2}}.\n$$\n\n3. 由散粒噪声引起的均方输出电压：\n令 $S_{i,\\text{shot}} = 2 q I_{D}$ 表示二极管散粒噪声电流PSD。由该噪声引起的均方节点电压，使用单边PSD约定在正频率上积分为\n$$\n\\langle v^{2}\\rangle_{\\text{shot}} = \\int_{0}^{\\infty} S_{i,\\text{shot}}\\,|Z(j 2\\pi f)|^{2}\\,df\n= \\left(2 q I_{D}\\right) \\int_{0}^{\\infty} \\frac{R_{L}^{2}}{1 + \\left(2\\pi f R_{L} C_{\\text{in}}\\right)^{2}}\\,df.\n$$\n通过换元 $x = 2\\pi f R_{L} C_{\\text{in}}$ 计算积分，因此 $df = \\frac{dx}{2\\pi R_{L} C_{\\text{in}}}$：\n$$\n\\int_{0}^{\\infty} \\frac{R_{L}^{2}}{1 + \\left(2\\pi f R_{L} C_{\\text{in}}\\right)^{2}}\\,df\n= \\frac{R_{L}^{2}}{2\\pi R_{L} C_{\\text{in}}} \\int_{0}^{\\infty} \\frac{dx}{1 + x^{2}}\n= \\frac{R_{L}}{2\\pi C_{\\text{in}}} \\cdot \\frac{\\pi}{2}\n= \\frac{R_{L}}{4\\,C_{\\text{in}}}.\n$$\n因此，\n$$\n\\langle v^{2}\\rangle_{\\text{shot}} = \\left(2 q I_{D}\\right)\\,\\frac{R_{L}}{4\\,C_{\\text{in}}}\n= \\frac{q\\,I_{D}\\,R_{L}}{2\\,C_{\\text{in}}}.\n$$\n所以，由二极管散粒噪声引起的均方根电压为\n$$\nv_{\\text{rms, shot}} = \\sqrt{\\frac{q\\,I_{D}\\,R_{L}}{2\\,C_{\\text{in}}}}.\n$$\n\n4. 数值计算：\n使用 $q = 1.602\\,176\\,634\\times 10^{-19}\\ \\text{C}$，$I_{D} = 10\\times 10^{-9}\\ \\text{A}$，$R_{L} = 100\\times 10^{3}\\ \\Omega$ 和 $C_{\\text{in}} = 10\\times 10^{-12}\\ \\text{F}$。代入闭式表达式：\n$$\nv_{\\text{rms, shot}} = \\sqrt{\\frac{\\left(1.602176634\\times 10^{-19}\\right)\\left(1.0\\times 10^{-8}\\right)\\left(1.0\\times 10^{5}\\right)}{2\\left(1.0\\times 10^{-11}\\right)}}\\ \\text{V}.\n$$\n计算平方根内的参数：\n$$\n\\frac{q\\,I_{D}\\,R_{L}}{2\\,C_{\\text{in}}}\n= \\frac{1.602176634\\times 10^{-22}}{2.0\\times 10^{-11}}\n= 8.01088317\\times 10^{-12}.\n$$\n因此，\n$$\nv_{\\text{rms, shot}} = \\sqrt{8.01088317\\times 10^{-12}}\\ \\text{V}\n\\approx 2.83035\\times 10^{-6}\\ \\text{V}.\n$$\n以微伏表示，即为\n$$\nv_{\\text{rms, shot}} \\approx 2.83035\\ \\mu\\text{V}.\n$$\n按要求四舍五入到三位有效数字：\n$$\nv_{\\text{rms, shot}} \\approx 2.83\\ \\mu\\text{V}.\n$$\n\n5. 由放大器电流噪声和输入电容引起的测量挑战：\n- 放大器电流噪声：放大器贡献了一个输入参考的白色电流噪声密度 $i_{a}$。通过同一网络传播后，其RMS输出电压为\n$$\nv_{\\text{rms, amp}} = i_{a}\\,\\sqrt{\\int_{0}^{\\infty} |Z(j2\\pi f)|^{2}\\,df} = i_{a}\\,\\sqrt{\\frac{R_{L}}{4\\,C_{\\text{in}}}}.\n$$\n输出端散粒噪声与放大器噪声的比值为\n$$\n\\frac{v_{\\text{rms, shot}}}{v_{\\text{rms, amp}}} = \\frac{\\sqrt{2 q I_{D}}}{i_{a}},\n$$\n该比值与 $R_{L}$ 和 $C_{\\text{in}}$ 无关。当 $I_{D} = 10\\ \\text{nA}$ 时，$\\sqrt{2 q I_{D}} \\approx 5.66\\times 10^{-14}\\ \\text{A}/\\sqrt{\\text{Hz}}$，因此要清晰地分辨二极管的散粒噪声，需要 $i_{a} \\ll 5.66\\times 10^{-14}\\ \\text{A}/\\sqrt{\\text{Hz}}$。对于给定的 $i_{a} = 2\\times 10^{-15}\\ \\text{A}/\\sqrt{\\text{Hz}}$，该比值约为 28，表明放大器电流噪声在此处不是主要限制因素；然而，如果 $i_{a}$ 更大（例如，在几十 $\\text{fA}/\\sqrt{\\text{Hz}}$ 的量级），它将掩盖散粒噪声。\n- 输入电容：有限的 $C_{\\text{in}}$ 设定了一个转角频率为 $f_{c} = \\left(2\\pi R_{L} C_{\\text{in}}\\right)^{-1}$ 的单极点滚降。它将有效噪声带宽减小到一个等效噪声带宽 $\\int_{0}^{\\infty} \\frac{df}{1+(2\\pi f R_{L} C_{\\text{in})}^{2}} = \\frac{1}{4 R_{L} C_{\\text{in}}}$，从而降低了积分输出噪声幅度，但也减慢了响应速度。较大的 $C_{\\text{in}}$ 会减小 $v_{\\text{rms, shot}} \\propto C_{\\text{in}}^{-1/2}$，并同样减小放大器的积分电流噪声；然而，在实际的跨阻配置中，$C_{\\text{in}}$ 也会增加放大器电压噪声的噪声增益，并可能带来稳定性约束，使得在较高电容下进行精确的散粒噪声测量更具挑战性。",
            "answer": "$$\\boxed{2.83}$$"
        },
        {
            "introduction": "随着半导体器件尺寸缩小到纳米级别，量子效应在决定其电学特性（包括噪声）方面变得至关重要。这项高级计算练习介绍了基于 Landauer-Büttiker 公式的现代方法，用于从第一性原理计算晶体管中的噪声。通过构建一个包含量子约束（子带）和能量依赖散射的数值求解器，您将掌握分析量子输运和噪声的强大框架，这对于纳米电子学的前沿研究至关重要。",
            "id": "3772328",
            "problem": "您的任务是实现一个数值求解器，用于计算金属-氧化物-半导体场效应晶体管 (MOSFET) 沟道的零频电流噪声谱密度 $S_I$（单位为 $\\mathrm{A^2/Hz}$）。该计算使用 Landauer 方法，并考虑了能量依赖的透射和子带量子化。计算必须从与有限温度下双端导体的 Landauer-Büttiker 形式论一致的第一性原理出发，对由施加偏压设定的化学势的源极和漏极 reservoirs 应用费米-狄拉克统计。该求解器必须为一个准一维沟道建模，该沟道具有多个量子化的横向子带、通过平均自由程描述捕获的能量依赖散射，以及一个能够移动子带底部的静电栅极。\n\n您必须建立在以下基础上：\n- 每个 reservoir 的费米-狄拉克分布 $f(E,\\mu,T) = \\left[1 + \\exp\\left(\\frac{E-\\mu}{k_B T}\\right)\\right]^{-1}$，其中 reservoir 的化学势为 $\\mu_S$ 和 $\\mu_D$。\n- Landauer 图像，该图像计算传播模式并考虑通过能量依赖的透射概率进行的透射和分配。\n- 有限温度下导体中热骚动的定义。\n- 普朗克常数 $h$、约化普朗克常数 $\\hbar = h/(2\\pi)$、基本电荷 $q$ 和玻尔兹曼常数 $k_B$，全部采用国际单位制 (SI)。\n- MOSFET 沟道被建模为一组独立的、底部因栅极电压而移动的一维子带，并根据 reservoir 的费米能级进行填充。\n\n需要实现的沟道和透射建模假设：\n- 沟道支持 $N$ 个量子化的横向子带，索引为 $n \\in \\{0,1,\\dots,N-1\\}$，其子带底能量为\n$$\nE_n(V_{GS}) = E_{c0} - q\\,\\alpha\\,(V_{GS} - V_T) + \\left(n+\\tfrac{1}{2}\\right)\\hbar\\omega_y,\n$$\n其中 $E_{c0}$ 是零偏压导带边参考，$\\alpha$ 是静电栅极耦合因子，$V_T$ 是阈值电压，$\\hbar\\omega_y$ 是横向量子化能量间距。\n- 子带 $n$ 的能量依赖平均自由程为\n$$\n\\lambda_n(E) = \n\\begin{cases}\n\\lambda_{0,n}\\left(\\dfrac{E - E_n}{E_{\\mathrm{ref}}}\\right)^\\beta,  E \\ge E_n \\\\[6pt]\n0,  E  E_n\n\\end{cases}\n$$\n其中 $\\lambda_{0,n}$ 是一个与子带相关的常数，$E_{\\mathrm{ref}}$ 是一个参考能量，$\\beta$ 是一个与散射的速度依赖性相关的指数。\n- 长度为 $L$ 的沟道对应的透射概率为\n$$\nT_n(E;L) = \\frac{\\lambda_n(E)}{\\lambda_n(E) + L}.\n$$\n- 源极和漏极的化学势由施加的漏源电压 $V_{DS}$ 设定为\n$$\n\\mu_S = E_F^0,\\quad \\mu_D = \\mu_S - q\\,V_{DS},\n$$\n其中 $E_F^0$ 是相对于能量零点的源极 reservoir 费米能级。\n\n您的程序必须：\n- 在 Landauer-Büttiker 框架内，推导并实现双端导体的零频电流噪声谱密度 $S_I$（单位为 $\\mathrm{A^2/Hz}$），同时考虑热骚动和量子透射引起的分区噪声。该公式必须对子带求和并对能量进行积分，使用源极和漏极的费米-狄拉克分布以及能量依赖的透射率 $T_n(E;L)$。\n- 使用在物理上足够的能量范围内进行数值稳定的能量积分方案，以捕捉所有占据态和子带的贡献。您必须根据给定参数推理并实现适当的能量限制和分辨率，确保科学真实性。\n\n要使用的常量和全局参数：\n- 温度：$T = 300\\,\\mathrm{K}$。\n- 基本电荷：$q = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n- 普朗克常数：$h = 6.62607015\\times 10^{-34}\\,\\mathrm{J{\\cdot}s}$。\n- 玻尔兹曼常数：$k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n- 约化普朗克常数：$\\hbar = h/(2\\pi)$。\n\n器件和建模参数（所有测试案例中固定）：\n- 子带数量：$N = 4$。\n- 零偏压导带参考：$E_{c0} = 0.25\\,\\mathrm{eV}$。\n- 阈值电压：$V_T = 0.4\\,\\mathrm{V}$。\n- 栅极静电耦合：$\\alpha = 0.8$。\n- 横向量子化能量：$\\hbar\\omega_y = 0.04\\,\\mathrm{eV}$。\n- 源极 reservoir 费米能级：$E_F^0 = 0.20\\,\\mathrm{eV}$。\n- 平均自由程的参考能量：$E_{\\mathrm{ref}} = 0.05\\,\\mathrm{eV}$。\n- 每个子带的平均自由程前置因子：$\\lambda_{0,0} = 5\\,\\mathrm{nm}$，$\\lambda_{0,1} = 7\\,\\mathrm{nm}$，$\\lambda_{0,2} = 9\\,\\mathrm{nm}$，$\\lambda_{0,3} = 12\\,\\mathrm{nm}$。\n- 平均自由程能量指数：$\\beta = 0.5$。\n\n测试套件：\n- 情况 1：$V_{DS} = 0.0\\,\\mathrm{V}$，$V_{GS} = 0.80\\,\\mathrm{V}$，$L = 20.0\\,\\mathrm{nm}$。\n- 情况 2：$V_{DS} = 0.05\\,\\mathrm{V}$，$V_{GS} = 0.80\\,\\mathrm{V}$，$L = 20.0\\,\\mathrm{nm}$。\n- 情况 3：$V_{DS} = 0.50\\,\\mathrm{V}$，$V_{GS} = 1.00\\,\\mathrm{V}$，$L = 5.0\\,\\mathrm{nm}$。\n- 情况 4：$V_{DS} = 0.50\\,\\mathrm{V}$，$V_{GS} = 1.00\\,\\mathrm{V}$，$L = 100.0\\,\\mathrm{nm}$。\n- 情况 5：$V_{DS} = 0.50\\,\\mathrm{V}$，$V_{GS} = 0.30\\,\\mathrm{V}$，$L = 20.0\\,\\mathrm{nm}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个值以 $\\mathrm{A^2/Hz}$ 为单位，使用小数点后六位的科学记数法表示。例如，输出格式应为\n$$\n[\\text{S1},\\text{S2},\\text{S3},\\text{S4},\\text{S5}],\n$$\n其中每个 $\\text{Si}$ 对应于为情况 $i$ 计算的 $S_I$，并以小数点后六位的科学记数法打印。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于用于量子输运的 Landauer-Büttiker 形式论，设定了一套完整且一致的参数，问题阐述清晰，并且以客观、正式的语言表达。不存在矛盾、歧义或科学上不合理的假设。因此，我将继续提供完整的解决方案。\n\n该问题要求计算准一维 MOSFET 沟道的零频电流噪声谱密度 $S_I$。解决方案基于有限温度 $T$ 下双端导体的 Landauer-Büttiker 形式论。总噪声源于两种不同的物理机制：热噪声，即使在平衡状态下由于载流子的热骚动也存在；以及分配噪声（散粒噪声的一种形式），它在非平衡条件下（$V_{DS} \\neq 0\\,\\mathrm{V}$）出现，此时散射导致电子在漏极和源极触点之间被随机分配。\n\n对于具有多个独立输运通道（子带）的双端导体，其零频电流噪声功率谱密度的一般公式为：\n$$\nS_I = \\frac{2q^2}{h} \\sum_{n=0}^{N-1} \\int_{-\\infty}^{\\infty} dE \\left( \\underbrace{T_n(E) \\left[ f_S(E)(1-f_S(E)) + f_D(E)(1-f_D(E)) \\right]}_{\\text{热噪声}} + \\underbrace{T_n(E)(1-T_n(E)) \\left[ f_S(E) - f_D(E) \\right]^2}_{\\text{分配噪声}} \\right)\n$$\n此处，$q$ 是基本电荷，$h$ 是普朗克常数，求和遍历 $N$ 个可用子带。$T_n(E)$ 是子带 $n$ 中电子的能量依赖透射概率。$f_S(E)$ 和 $f_D(E)$ 分别是源极和漏极 reservoirs 的费米-狄拉克分布：\n$$\nf_S(E) = f(E; \\mu_S, T) = \\left[1 + \\exp\\left(\\frac{E-\\mu_S}{k_B T}\\right)\\right]^{-1}\n$$\n$$\nf_D(E) = f(E; \\mu_D, T) = \\left[1 + \\exp\\left(\\frac{E-\\mu_D}{k_B T}\\right)\\right]^{-1}\n$$\n其中 $k_B$ 是玻尔兹曼常数，$\\mu_S$ 和 $\\mu_D$ 是源极和漏极的化学势。根据问题陈述，它们由以下公式给出：\n$$\n\\mu_S = E_F^0\n$$\n$$\n\\mu_D = E_F^0 - qV_{DS}\n$$\n因子 $f(E)(1-f(E))$ 与费米函数的能量导数有关，$f(1-f) = -k_B T \\frac{\\partial f}{\\partial E}$，代表了化学势周围能级的热展宽。\n\nMOSFET 沟道模型通过一个多步骤过程来规定透射率 $T_n(E)$。首先，每个子带的底部 $E_n$ 由栅源电压 $V_{GS}$ 决定：\n$$\nE_n(V_{GS}) = E_{c0} - q\\,\\alpha\\,(V_{GS} - V_T) + \\left(n+\\tfrac{1}{2}\\right)\\hbar\\omega_y\n$$\n其中 $E_{c0}$ 是参考导带边，$\\alpha$ 是栅极耦合因子，$V_T$ 是阈值电压，$\\hbar\\omega_y$ 是子带量子化能量。\n\n接着，定义了子带 $n$ 内部散射的能量依赖平均自由程 $\\lambda_n(E)$。该路径长度取决于电子在子带内的动能 $E - E_n$：\n$$\n\\lambda_n(E) = \n\\begin{cases}\n\\lambda_{0,n}\\left(\\dfrac{E - E_n}{E_{\\mathrm{ref}}}\\right)^\\beta,  \\text{for } E \\ge E_n \\\\\n0,  \\text{for } E  E_n\n\\end{cases}\n$$\n此处，$\\lambda_{0,n}$ 是一个与子带相关的前置因子，$E_{\\mathrm{ref}}$ 是一个参考能量，$\\beta$ 是一个散射指数。最后，对于长度为 $L$ 的沟道，透射概率 $T_n(E)$ 由半经典电阻相加法则给出，对于长度 $L$ 和平均自由程 $\\lambda_n$ 给出：\n$$\nT_n(E;L) = \\frac{\\lambda_n(E)}{\\lambda_n(E) + L}\n$$\n此表达式正确地在弹道极限（$L \\ll \\lambda_n \\implies T_n \\to 1$）和扩散极限（$L \\gg \\lambda_n \\implies T_n \\to \\lambda_n/L \\ll 1$）之间进行插值。\n\n为计算每个测试案例的 $S_I$，实施以下数值程序：\n1.  所有输入参数和物理常数都转换为并保持在国际单位制基本单位（焦耳、米、秒、开尔文等），以确保量纲一致性。以电子伏特 (eV) 给出的能量值通过乘以 $q$ 转换为焦耳。以纳米 (nm) 为单位的长度转换为米。\n2.  对于每个测试案例，根据给定的 $V_{DS}$ 计算化学势 $\\mu_S$ 和 $\\mu_D$。\n3.  总噪声谱密度 $S_I$ 初始化为 $0$。然后计算遍历每个子带 $n$（从 $0$到 $N-1$）。\n4.  对于每个子带，使用给定的 $V_{GS}$ 计算子带底能量 $E_n$。\n5.  计算的核心是能量 $E$ 上的数值积分。被积函数是费米-狄拉克分布和透射概率的组合函数。为了准确性和效率，使用自适应求积例程 (`scipy.integrate.quad`) 进行积分。\n6.  必须谨慎选择积分范围。被积函数仅在费米函数不为 $0$ 或 $1$ 时才显著。项 $f_S(1-f_S)$ 和 $f_D(1-f_D)$ 分别在 $\\mu_S$ 和 $\\mu_D$ 附近急剧达到峰值，特征宽度为几个 $k_B T$。项 $(f_S-f_D)^2$ 主要在 $\\mu_S$ 和 $\\mu_D$ 之间的能量窗口内非零。选择从 $\\min(\\mu_S, \\mu_D) - 15\\,k_B T$ 到 $\\max(\\mu_S, \\mu_D) + 15\\,k_B T$ 的积分范围，以确保足够大以捕捉所有显著贡献，同时保持计算效率。\n7.  计算每个子带的积分，并将其加到运行总和中。\n8.  在对所有子带的贡献求和后，将总和乘以预因子 $2q^2/h$，得到 $S_I$ 的最终值，单位为 $\\mathrm{A^2/Hz}$。\n9.  对所有五个测试案例重复此过程，收集结果并按规定格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the zero-frequency current noise spectral density S_I for a MOSFET\n    channel using the Landauer-Büttiker formalism with energy-dependent transmission.\n    \"\"\"\n    # Physical constants in SI units\n    Q_C = 1.602176634e-19  # Elementary charge in Coulombs\n    H_JS = 6.62607015e-34    # Planck constant in J*s\n    KB_JK = 1.380649e-23     # Boltzmann constant in J/K\n    T_K = 300.0              # Temperature in Kelvin\n    KBT_J = KB_JK * T_K      # Thermal energy in Joules\n\n    # Device and modeling parameters in SI units\n    N_SUBBANDS = 4\n    EC0_J = 0.25 * Q_C\n    VT_V = 0.4\n    ALPHA = 0.8\n    HBAR_OMEGA_Y_J = 0.04 * Q_C\n    EF0_J = 0.20 * Q_C\n    EREF_J = 0.05 * Q_C\n    LAMBDA0_M = np.array([5e-9, 7e-9, 9e-9, 12e-9])\n    BETA = 0.5\n\n    # Test suite from the problem statement\n    test_cases = [\n        {'V_DS': 0.0, 'V_GS': 0.80, 'L': 20.0e-9},\n        {'V_DS': 0.05, 'V_GS': 0.80, 'L': 20.0e-9},\n        {'V_DS': 0.50, 'V_GS': 1.00, 'L': 5.0e-9},\n        {'V_DS': 0.50, 'V_GS': 1.00, 'L': 100.0e-9},\n        {'V_DS': 0.50, 'V_GS': 0.30, 'L': 20.0e-9},\n    ]\n\n    results = []\n\n    def fermi_dirac(E_J, mu_J, kBT_J_val):\n        \"\"\"Fermi-Dirac distribution function.\"\"\"\n        # Handles large exponent arguments gracefully\n        arg = (E_J - mu_J) / kBT_J_val\n        if arg > 100:\n            return 0.0\n        return 1.0 / (1.0 + np.exp(arg))\n\n    def noise_integrand(E_J, n, En_J, L_m, mu_S_J, mu_D_J):\n        \"\"\"\n        Calculates the integrand for the noise spectral density at a given energy E\n        for a single subband n.\n        \"\"\"\n        # Transmission is zero below the subband bottom\n        if E_J  En_J:\n            return 0.0\n\n        # Mean free path lambda_n(E)\n        if EREF_J > 0:\n            kinetic_energy_ratio = (E_J - En_J) / EREF_J\n            # Avoid issues if E_J is extremely close to En_J leading to 0^negative\n            if kinetic_energy_ratio = 0:\n                 lambda_n_m = 0.0\n            else:\n                 lambda_n_m = LAMBDA0_M[n] * (kinetic_energy_ratio)**BETA\n        else:\n            lambda_n_m = LAMBDA0_M[n] # Fallback if E_ref is zero\n\n        # Transmission probability T_n(E)\n        if lambda_n_m + L_m > 0:\n            Tn = lambda_n_m / (lambda_n_m + L_m)\n        else:\n            Tn = 0.0\n\n        # Fermi-Dirac distributions for source and drain\n        fS = fermi_dirac(E_J, mu_S_J, KBT_J)\n        fD = fermi_dirac(E_J, mu_D_J, KBT_J)\n\n        # Thermal noise component\n        thermal_noise = Tn * (fS * (1.0 - fS) + fD * (1.0 - fD))\n\n        # Partition noise component\n        partition_noise = Tn * (1.0 - Tn) * (fS - fD)**2\n\n        return thermal_noise + partition_noise\n\n    for case in test_cases:\n        V_DS_V = case['V_DS']\n        V_GS_V = case['V_GS']\n        L_m = case['L']\n\n        # Chemical potentials for source and drain\n        mu_S_J = EF0_J\n        mu_D_J = EF0_J - Q_C * V_DS_V\n\n        total_integral = 0.0\n\n        for n in range(N_SUBBANDS):\n            # Subband bottom energy\n            En_J = EC0_J - Q_C * ALPHA * (V_GS_V - VT_V) + (n + 0.5) * HBAR_OMEGA_Y_J\n            \n            # Set integration range based on chemical potentials\n            mu_min = min(mu_S_J, mu_D_J)\n            mu_max = max(mu_S_J, mu_D_J)\n            E_min = mu_min - 15 * KBT_J\n            E_max = mu_max + 15 * KBT_J\n\n            # Numerically integrate for subband n\n            integral_val, _ = integrate.quad(\n                noise_integrand,\n                E_min,\n                E_max,\n                args=(n, En_J, L_m, mu_S_J, mu_D_J)\n            )\n            total_integral += integral_val\n        \n        # Final noise spectral density S_I\n        S_I = (2 * Q_C**2 / H_JS) * total_integral\n        results.append(S_I)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}