{
    "hands_on_practices": [
        {
            "introduction": "要理解体反型，我们必须首先掌握多栅器件的静电学原理。静电学特征长度 $\\lambda$ 是一个关键参数，它决定了栅极对沟道电势的控制效率，即屏蔽源极和漏极影响的能力。\n\n本练习  将引导您使用能量平衡方法，从第一性原理出发推导 $\\lambda$ 的表达式，从而深入理解硅层厚度（$t_{si}$）和等效氧化层厚度（EOT）等器件尺寸如何决定短沟道控制能力。",
            "id": "3787496",
            "problem": "一个对称双栅极超薄体金属-氧化物-半导体场效应晶体管 (MOSFET) 在体反型状态下的亚阈值区工作，此时反型电荷分布在整个硅体中，而不是局限在界面附近。考虑一个长沟道器件，其硅层厚度为 $t_{si}$，硅膜上方和下方有相同的栅叠层，且氧化物中或界面处没有固定电荷。假设在亚阈值状态下，硅中的移动电荷可以忽略不计，因此硅区域的静电学行为遵循拉普拉斯方程。沟道感受到的来自两个栅极的单位面积总栅叠层电容，由一个有效等效氧化层厚度 (EOT) 来建模，其定义关系为 $C_{ox,\\mathrm{eff}} = \\varepsilon_{ox} / \\mathrm{EOT}$，其中 $\\varepsilon_{ox}$ 是栅介质的介电常数，$\\varepsilon_{si}$ 是硅的介电常数。\n\n从基本静电能量密度 $u = \\frac{1}{2} \\varepsilon | \\mathbf{E} |^{2}$ 和单位面积的栅极电容能量 $u_{gate} = \\frac{1}{2} C \\, V^{2}$ 出发，并使用长沟道、小信号、亚阈值以及体反型（即静电势在硅层厚度上近似均匀）的近似，推导出一个关于静电学标度长度 $\\lambda$ 的近似闭式表达式，该长度表征了沿沟道方向的横向电势扰动的指数衰减。表达式需用 $\\varepsilon_{si}$、$\\varepsilon_{ox}$、$t_{si}$ 和 $\\mathrm{EOT}$ 来表示。然后，使用以下技术上合理的参数计算 $\\lambda$ 的值：\n- $t_{si} = 5\\,\\mathrm{nm}$，\n- $\\mathrm{EOT} = 0.8\\,\\mathrm{nm}$，\n- $\\varepsilon_{si} = 11.7 \\, \\varepsilon_{0}$，\n- $\\varepsilon_{ox} = 20 \\, \\varepsilon_{0}$，\n其中 $\\varepsilon_{0}$ 是真空介电常数。\n\n将 $\\lambda$ 的最终值以纳米为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导在亚阈值区工作的对称双栅极超薄体 (UTB) MOSFET 的静电学标度长度 $\\lambda$。推导将基于能量平衡原理，并与题目给出的体反型和可忽略移动电荷的近似相一致，这些近似使得系统的静电学特性可以用拉普拉斯方程进行分析。最后一步是计算 $\\lambda$ 的数值。\n\n该问题在物理上是适定的且内部一致，为分析提供了一个有效的框架。我们开始进行求解。\n\n标度长度 $\\lambda$ 表征了沿沟道方向的电势扰动的指数衰减，我们将其记为 $\\phi(x)$，其中 $x$ 是沿沟道的位置。关键的近似是，对于超薄硅体，该电势扰动在垂直于沟道的方向（即竖直方向）上是均匀的。这就是在此背景下“体反型”近似的本质。\n\n我们可以通过考虑储存在沟道一个微分段中的静电能量来推导 $\\phi(x)$ 的控制方程。总静电能量由两部分组成：\n1. 储存在硅膜内横向电场中的能量。\n2. 储存在竖直电场中的能量，这对应于储存在栅电容中的能量。\n\n让我们定义沟道的单位面积能量。\n横向电场为 $E_x = -\\frac{d\\phi}{dx}$。题目要求使用基本能量密度表达式 $u = \\frac{1}{2} \\varepsilon | \\mathbf{E} |^{2}$。将此密度对硅膜厚度 $t_{si}$ 进行积分，得到单位沟道面积储存的横向能量：\n$$u_{lateral} = \\int_{-t_{si}/2}^{t_{si}/2} \\frac{1}{2}\\varepsilon_{si} E_x^2 dz = \\frac{1}{2}\\varepsilon_{si} t_{si} \\left(-\\frac{d\\phi}{dx}\\right)^2 = \\frac{1}{2}\\varepsilon_{si} t_{si} \\left(\\frac{d\\phi}{dx}\\right)^2$$\n这里，我们使用了 $\\phi$（以及 $E_x$）在硅膜内部的竖直维度 $z$ 上是常数的近似。\n\n单位面积栅电容中储存的能量由公式 $u_{gate} = \\frac{1}{2} C V^2$ 给出。此处，$V$ 代表电容器两端的电势，即沟道电势扰动 $\\phi(x)$。题目已给出，来自两个对称栅极的单位面积总电容为 $C_{ox,\\mathrm{eff}}$。因此，单位沟道面积储存的竖直能量为：\n$$u_{vertical} = \\frac{1}{2} C_{ox,\\mathrm{eff}} \\phi^2$$\n\n单位沟道宽度的总静电能量 $U$ 是这些能量密度之和沿沟道长度的积分：\n$$U[\\phi] = \\int \\left( u_{lateral} + u_{vertical} \\right) dx = \\int \\left[ \\frac{1}{2}\\varepsilon_{si} t_{si} \\left(\\frac{d\\phi}{dx}\\right)^2 + \\frac{1}{2} C_{ox,\\mathrm{eff}} \\phi^2 \\right] dx$$\n\n物理上实际出现的电势分布 $\\phi(x)$ 是使这个总能量泛函 $U[\\phi]$ 最小化的那一个。这个条件可以通过使用 Euler-Lagrange 方程找到。对于一个具有拉格朗日量密度 $\\mathcal{L}(\\phi, \\phi', x)$ 的泛函，其中 $\\phi' = d\\phi/dx$，该方程为 $\\frac{\\partial \\mathcal{L}}{\\partial \\phi} - \\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\phi'}\\right) = 0$。\n在我们的例子中，拉格朗日量密度是 $\\mathcal{L} = \\frac{1}{2}\\varepsilon_{si} t_{si} (\\phi')^2 + \\frac{1}{2} C_{ox,\\mathrm{eff}} \\phi^2$。其偏导数分别为：\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\phi} = C_{ox,\\mathrm{eff}} \\phi$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\phi'} = \\varepsilon_{si} t_{si} \\phi'$$\n将这些代入 Euler-Lagrange 方程，得到 $\\phi(x)$ 的控制微分方程：\n$$C_{ox,\\mathrm{eff}} \\phi - \\frac{d}{dx}\\left(\\varepsilon_{si} t_{si} \\frac{d\\phi}{dx}\\right) = 0$$\n$$\\frac{d^2\\phi}{dx^2} - \\frac{C_{ox,\\mathrm{eff}}}{\\varepsilon_{si} t_{si}} \\phi = 0$$\n这是一个二阶线性齐次微分方程。一个代表电势扰动指数衰减的解的形式为 $\\phi(x) \\propto \\exp(-x/\\lambda)$。将此形式代入方程：\n$$\\frac{1}{\\lambda^2} \\exp(-x/\\lambda) - \\frac{C_{ox,\\mathrm{eff}}}{\\varepsilon_{si} t_{si}} \\exp(-x/\\lambda) = 0$$\n由此，我们确定了标度长度的平方的表达式：\n$$\\frac{1}{\\lambda^2} = \\frac{C_{ox,\\mathrm{eff}}}{\\varepsilon_{si} t_{si}} \\implies \\lambda^2 = \\frac{\\varepsilon_{si} t_{si}}{C_{ox,\\mathrm{eff}}}$$\n题目中给出了单位面积有效栅电容的定义为 $C_{ox,\\mathrm{eff}} = \\varepsilon_{ox} / \\mathrm{EOT}$。将其代入 $\\lambda^2$ 的表达式中：\n$$\\lambda^2 = \\frac{\\varepsilon_{si} t_{si}}{\\varepsilon_{ox} / \\mathrm{EOT}} = \\frac{\\varepsilon_{si} t_{si} \\mathrm{EOT}}{\\varepsilon_{ox}}$$\n取平方根得到静电学标度长度的最终解析表达式：\n$$\\lambda = \\sqrt{\\frac{\\varepsilon_{si} t_{si} \\mathrm{EOT}}{\\varepsilon_{ox}}}$$\n\n现在，我们使用给定的参数计算 $\\lambda$ 的数值：\n- $t_{si} = 5\\,\\mathrm{nm}$\n- $\\mathrm{EOT} = 0.8\\,\\mathrm{nm}$\n- $\\varepsilon_{si} = 11.7 \\, \\varepsilon_{0}$\n- $\\varepsilon_{ox} = 20 \\, \\varepsilon_{0}$\n\n在比值 $\\varepsilon_{si}/\\varepsilon_{ox}$ 中，真空介电常数 $\\varepsilon_0$ 会被消去。\n$$\\frac{\\varepsilon_{si}}{\\varepsilon_{ox}} = \\frac{11.7 \\, \\varepsilon_0}{20 \\, \\varepsilon_0} = \\frac{11.7}{20} = 0.585$$\n将数值代入 $\\lambda$ 的表达式中：\n$$\\lambda = \\sqrt{\\frac{\\varepsilon_{si}}{\\varepsilon_{ox}} t_{si} \\mathrm{EOT}} = \\sqrt{0.585 \\times (5\\,\\mathrm{nm}) \\times (0.8\\,\\mathrm{nm})}$$\n$$\\lambda = \\sqrt{0.585 \\times 4.0 \\, (\\mathrm{nm})^2}$$\n$$\\lambda = \\sqrt{2.34} \\,\\mathrm{nm}$$\n计算数值：\n$$\\lambda \\approx 1.52970585... \\,\\mathrm{nm}$$\n将结果四舍五入到四位有效数字，我们得到：\n$$\\lambda \\approx 1.530\\,\\mathrm{nm}$$",
            "answer": "$$\n\\boxed{1.530}\n$$"
        },
        {
            "introduction": "体反型的一个主要优势是载流子迁移率的提升。通过将反型电荷的质心移离粗糙的半导体-氧化物界面，表面粗糙度散射这一主要的散射机制得到了显著抑制。\n\n在本练习  中，您将应用一个简化但有效的模型来量化这种迁移率的增强效应，从而将电荷质心的物理位置与关键的器件性能指标直接联系起来。",
            "id": "3787468",
            "problem": "一个多栅极硅沟道表现出体反型现象，其中随着栅极静电控制变得更加三维，反型电荷质心会远离氧化物界面。考虑一个在室温下工作于低场区的对称环栅硅纳米线金属-氧化物-半导体场效应晶体管（MOSFET），其反型电荷质心从平均距离 $d_{1} = 1\\,\\mathrm{nm}$（靠近单个界面的类平面累积）移动到 $d_{2} = 3\\,\\mathrm{nm}$（体反型，质心分布在半导体横截面内）。\n\n从弛豫时间近似下的半经典玻尔兹曼输运方程出发，低场迁移率定义为 $\\mu = q \\tau / m^{\\star}$，其中 $q$ 是元电荷，$m^{\\star}$ 是电导有效质量，$\\tau$ 是输运弛豫时间。假设在所考虑的偏压范围内，总散射主要由氧化物-半导体界面的表面粗糙度散射决定，其散射率 $W_{\\mathrm{sr}}(d)$ 与反型电荷质心到界面的平均距离 $d$ 的关系为 $W_{\\mathrm{sr}}(d) \\propto d^{-2}$。忽略所有其他散射机制，因此总弛豫时间满足 $\\tau = 1/W_{\\mathrm{sr}}(d)$。\n\n仅使用这些假设和定义，推导迁移率增强因子 $\\eta \\equiv \\mu(d_{2}) / \\mu(d_{1})$ 作为 $d_{1}$ 和 $d_{2}$ 的函数，然后计算当 $d_{1} = 1\\,\\mathrm{nm}$ 和 $d_{2} = 3\\,\\mathrm{nm}$ 时的值。以无量纲数的形式报告最终的增强因子。不包括单位。无需进行精确计算之外的舍入。",
            "solution": "该问题要求推导和计算经历体反型现象的环栅硅纳米线 MOSFET 的迁移率增强因子 $\\eta$。分析始于对问题陈述的验证。该问题在半导体物理学方面有坚实的科学基础，描述了体反型现象及其通过调制表面粗糙度散射对载流子迁移率的影响。问题提法恰当，提供了得出唯一解所需的所有定义、关系和数据。语言客观，设定自洽且一致。因此，该问题是有效的，可以构建解答。\n\n迁移率增强因子 $\\eta$ 定义为质心距离为 $d_2$ 时的迁移率与质心距离为 $d_1$ 时的迁移率之比：\n$$\n\\eta \\equiv \\frac{\\mu(d_{2})}{\\mu(d_{1})}\n$$\n题目给出了弛豫时间近似下的低场迁移率的半经典表达式：\n$$\n\\mu = \\frac{q \\tau}{m^{\\star}}\n$$\n其中 $q$ 是元电荷，$m^{\\star}$ 是电导有效质量，$\\tau$ 是输运弛豫时间。我们假设 $q$ 和 $m^{\\star}$ 是不依赖于电荷质心位置的常数。将此迁移率表达式代入 $\\eta$ 的定义中，得到：\n$$\n\\eta = \\frac{\\frac{q \\tau(d_{2})}{m^{\\star}}}{\\frac{q \\tau(d_{1})}{m^{\\star}}}\n$$\n常数 $q$ 和 $m^{\\star}$ 被消去，增强因子表示为弛豫时间之比：\n$$\n\\eta = \\frac{\\tau(d_{2})}{\\tau(d_{1})}\n$$\n题目指出，总散射主要由表面粗糙度决定，因此总弛豫时间 $\\tau$ 是表面粗糙度散射率 $W_{\\mathrm{sr}}$ 的倒数。\n$$\n\\tau(d) = \\frac{1}{W_{\\mathrm{sr}}(d)}\n$$\n将此关系代入 $\\eta$ 的表达式中：\n$$\n\\eta = \\frac{\\frac{1}{W_{\\mathrm{sr}}(d_{2})}}{\\frac{1}{W_{\\mathrm{sr}}(d_{1})}} = \\frac{W_{\\mathrm{sr}}(d_{1})}{W_{\\mathrm{sr}}(d_{2})}\n$$\n这表明迁移率增强因子与散射率之比成反比。\n\n题目进一步给出了表面粗糙度散射率与反型电荷质心到界面的平均距离 $d$ 之间的比例关系：\n$$\nW_{\\mathrm{sr}}(d) \\propto d^{-2}\n$$\n通过引入比例常数 $C$，该比例关系可以写成一个方程：\n$$\nW_{\\mathrm{sr}}(d) = \\frac{C}{d^{2}}\n$$\n现在，我们将此散射率形式代入 $\\eta$ 的表达式中：\n$$\n\\eta = \\frac{\\frac{C}{d_{1}^{2}}}{\\frac{C}{d_{2}^{2}}}\n$$\n比例常数 $C$ 被消去，得到迁移率增强因子作为 $d_{1}$ 和 $d_{2}$ 函数的最终符号表达式：\n$$\n\\eta = \\frac{d_{2}^{2}}{d_{1}^{2}} = \\left(\\frac{d_{2}}{d_{1}}\\right)^{2}\n$$\n这一结果表明，由于表面粗糙度散射被抑制而带来的迁移率增强，与电荷质心到界面的距离之比的平方成正比。\n\n最后，我们使用给定的数值 $d_{1} = 1\\,\\mathrm{nm}$ 和 $d_{2} = 3\\,\\mathrm{nm}$ 来计算该表达式的值。\n$$\n\\eta = \\left(\\frac{3\\,\\mathrm{nm}}{1\\,\\mathrm{nm}}\\right)^{2} = \\left(3\\right)^{2} = 9\n$$\n迁移率增强因子是一个值为 $9$ 的无量纲数。这表明，在指定的假设下，由于电荷质心远离界面（体反型），迁移率增强了9倍。",
            "answer": "$$\\boxed{9}$$"
        },
        {
            "introduction": "体反型的理论模型通常假设器件具有理想的矩形几何形状，但在现实世界的多栅器件（如FinFET）中，其横截面形状复杂，尖锐的边角会形成不希望出现的势阱。这些“边角效应”会使载流子局域化，从而抵消体反型带来的益处，导致边角主导的导电现象。\n\n这个高级数值练习  要求您构建一个二维量子力学求解器来探究这一现象，研究如何通过几何工程——特别是边角圆化——来使电子波函数离域，从而实现真正的体反型。",
            "id": "3787470",
            "problem": "考虑一个三栅极鳍片（tri-gate fin）横截面的二维有效质量电子模型，其中硅区域是一个宽为$W$、高为$H$的矩形。位于边界$y=0$、$x=0$和$x=W$的顶栅和两个侧栅在硅内部感生出一个静电势，该电势从每个栅极表面向体硅内衰减。当栅极感应的电势在顶角处更深时，器件表现出角区主导的导电；而当电子基态波函数局域在远离角区且靠近鳍片中心的位置时，器件可表现出真体反型。本任务旨在量化角区圆角半径$r$如何改变波函数局域化，并确定对于预设测试集中的每个$r$值，是否实现了真体反型。\n\n从有效质量近似下的不含时薛定谔方程开始，\n$$\n-\\frac{\\hbar^2}{2 m^\\ast}\\nabla^2 \\psi(x,y) + V(x,y;r)\\,\\psi(x,y) = E\\,\\psi(x,y),\n$$\n该方程在硅区域$(x,y)\\in(0,W)\\times(0,H)$内成立，采用狄利克雷边界条件（Dirichlet boundary conditions）$\\psi=0$（在$x=0$、$x=W$、$y=0$和$y=H$处），这模拟了硅-氧化物界面处大的导带带阶。使用以下具有物理动机且简化的栅极感应势能模型，该模型捕捉了表面衰减和角区圆角效应：\n$$\nV(x,y;r) = -\\Phi_0 \\left[\\exp\\!\\left(-\\frac{d_r(y)}{\\lambda}\\right) + \\exp\\!\\left(-\\frac{d_r(x)}{\\lambda}\\right) + \\exp\\!\\left(-\\frac{d_r(W-x)}{\\lambda}\\right)\\right],\n$$\n其中$d_r(t) = \\sqrt{t^2 + r^2} - r$是一个距离的平滑函数，当$r0$时，它会增加角区附近的有效距离，从而减弱角区聚焦效应；$\\Phi_0$是以电子伏特表示的栅极感应势能幅值；$\\lambda$是以纳米为单位的特征衰减长度。该模型的设计使得$r=0$时，由于顶面和侧面的贡献叠加，会产生更强的角区势阱，而增加$r$会减弱角区增强效应。\n\n使用间距为$a$的均匀网格，通过五点有限差分格式来离散化拉普拉斯算子，从而对薛定谔算子进行离散化，并构建哈密顿矩阵\n$$\n\\mathbf{H}(r) = -\\frac{\\hbar^2}{2 m^\\ast}\\mathbf{L} + \\mathrm{diag}\\big(V(x_i,y_j;r)\\big),\n$$\n其中$\\mathbf{L}$是带有狄利克雷边界条件的内部网格上的离散拉普拉斯算子。计算$\\mathbf{H}(r)$的最低本征对$(E_0,\\psi_0)$，并归一化$\\psi_0$，使得$|\\psi_0|^2$在硅区域上的离散积分等于$1$。\n\n根据归一化的基态波函数定义以下概率分数：\n- 角区分数$f_{\\mathrm{corner}}(r)$是在两个顶角区域内积分的概率，每个顶角区域被定义为以$(0,0)$和$(W,0)$为中心、半径为$d_c$的圆盘，\n$$\nf_{\\mathrm{corner}}(r) = \\iint_{\\{(x,y)\\,:\\,\\min(\\sqrt{x^2+y^2},\\sqrt{(x-W)^2+y^2})\\le d_c\\}} |\\psi_0(x,y)|^2 \\, dx\\,dy.\n$$\n- 中心分数$f_{\\mathrm{central}}(r)$是在中心区域内积分的概率，该区域由距离所有三个栅极表面至少为$d_v$的点定义，\n$$\nf_{\\mathrm{central}}(r) = \\iint_{\\{(x,y)\\,:\\,\\min(x,W-x,y)\\ge d_v\\}} |\\psi_0(x,y)|^2 \\, dx\\,dy.\n$$\n\n当且仅当$f_{\\mathrm{central}}(r)\\ge 0.5$和$f_{\\mathrm{corner}}(r)\\le 0.3$两个条件都满足时，宣告实现了真体反型。\n\n使用以下参数值和单位：\n- $W = 8\\,\\text{nm}$，\n- $H = 30\\,\\text{nm}$，\n- $a = 0.5\\,\\text{nm}$，\n- $m^\\ast = 0.19\\,m_0$，其中$m_0$是电子静止质量，\n- $\\hbar$是约化普朗克常数，\n- $\\Phi_0 = 0.20\\,\\text{eV}$，\n- $\\lambda = 2.0\\,\\text{nm}$，\n- $d_c = 1.0\\,\\text{nm}$，\n- $d_v = 2.0\\,\\text{nm}$。\n\n所有能量必须以电子伏特处理，所有长度以纳米为单位，在内部根据动能项的需要转换为米。\n\n实现一个程序，对于给定测试集中的每个圆角半径$r$，构建$\\mathbf{H}(r)$，计算$(E_0,\\psi_0)$，评估$f_{\\mathrm{corner}}(r)$和$f_{\\mathrm{central}}(r)$，并输出一个布尔值，指示是否实现了真体反型。\n\n测试集：\n- $r = 0.0\\,\\text{nm}$，\n- $r = 0.5\\,\\text{nm}$，\n- $r = 1.5\\,\\text{nm}$，\n- $r = 3.0\\,\\text{nm}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\text{True},\\text{False},\\text{True},\\text{False}]$）作为结果，其中每个条目对应上述给定顺序的相应测试用例的布尔结果。",
            "solution": "该问题具有科学依据，提法明确，并为获得唯一解提供了所有必要信息。它描述了一个在有效质量近似下的标准数值量子力学问题，这是半导体器件建模的基石。该模型虽然经过简化，但抓住了三栅极鳍片结构中圆角对载流子局域化的核心物理效应。任务是针对一组给定的参数和测试用例求解该模型。\n\n求解过程遵循以下步骤：\n1.  使用有限差分法在均匀网格上离散化二维薛定谔方程，将偏微分方程转化为矩阵特征值问题。\n2.  为每个角区圆角半径$r$构建稀疏哈密顿矩阵$\\mathbf{H}(r)$。\n3.  求解特征值问题，找到基态本征对$(E_0, \\psi_0)$。\n4.  根据基态波函数计算角区和中心概率分数$f_{\\mathrm{corner}}(r)$和$f_{\\mathrm{central}}(r)$。\n5.  应用指定标准来确定是否实现了真体反型。\n\n**1. 哈密顿量离散化**\n\n不含时薛定谔方程由下式给出\n$$\n\\mathbf{H}\\psi = E\\psi,\n$$\n其中$\\mathbf{H} = -\\frac{\\hbar^2}{2 m^\\ast}\\nabla^2 + V(x,y;r)$是哈密顿算子。求解域是一个矩形$(x,y) \\in (0, W) \\times (0, H)$，边界上$\\psi=0$。\n\n我们使用间距为$a$的均匀网格来离散化此域。网格点为$(x_i, y_j) = ((i+1)a, (j+1)a)$，其中$i \\in \\{0, 1, \\dots, N_x-1\\}$且$j \\in \\{0, 1, \\dots, N_y-1\\}$。内部网格点的数量为$N_x = W/a - 1$和$N_y = H/a - 1$。总点数为$N = N_x N_y$。波函数$\\psi(x,y)$由其在这些网格点上的值的向量表示，即$\\psi_{ij} = \\psi(x_i, y_j)$。\n\n连续算子被它们在此网格上的矩阵表示所替代。\n势能算子变成一个大小为$N \\times N$的对角矩阵$\\mathbf{V}$，其对角线元素是每个网格点上的势能值：\n$$\n\\mathbf{V}_{k,k} = V(x_i, y_j; r)\n$$\n其中$k = i + j N_x$是二维网格点$(i,j)$的扁平化一维索引。势能函数为\n$$\nV(x,y;r) = -\\Phi_0 \\left[\\exp\\!\\left(-\\frac{d_r(y)}{\\lambda}\\right) + \\exp\\!\\left(-\\frac{d_r(x)}{\\lambda}\\right) + \\exp\\!\\left(-\\frac{d_r(W-x)}{\\lambda}\\right)\\right],\n$$\n其中$d_r(t) = \\sqrt{t^2 + r^2} - r$。\n\n拉普拉斯算子$\\nabla^2$使用五点有限差分格式进行近似，从而得到离散拉普拉斯矩阵$\\mathbf{L}$。对于二维网格，$\\mathbf{L}$可以使用一维拉普拉斯矩阵的克罗内克积（Kronecker products）来构造。设$\\mathbf{D}_{M}$为尺寸为$M \\times M$且比例因子为$1/a^2$的一维拉普拉斯矩阵。那么，二维拉普拉斯矩阵为$\\mathbf{L} = (\\mathbf{I}_{N_y} \\otimes \\mathbf{D}_{N_x}) + (\\mathbf{D}_{N_y} \\otimes \\mathbf{I}_{N_x})$，其中$\\mathbf{I}$是单位矩阵。\n\n因此，动能算子由矩阵$\\mathbf{T} = -\\frac{\\hbar^2}{2 m^\\ast}\\mathbf{L}$表示。为了与其他参数保持一致，可以以eV·nm²为单位计算其前置系数。使用给定值$m^\\ast = 0.19\\,m_0$，该常数为\n$$\nT_0 = \\frac{\\hbar^2}{2 m^\\ast} \\approx \\frac{(6.582 \\times 10^{-16}\\,\\text{eV}\\cdot\\text{s})^2}{2 \\times (0.19 \\times 0.511 \\times 10^6\\,\\text{eV}/c^2)} \\approx \\frac{4.33 \\times 10^{-31}\\,\\text{eV}^2\\cdot\\text{s}^2}{3.88 \\times 10^5\\,\\text{eV}/c^2} \\approx 0.03809\\,\\text{eV}\\cdot\\text{nm}^2.\n$$\n因此，总的离散哈密顿矩阵为$\\mathbf{H}(r) = \\mathbf{T} + \\mathbf{V}(r)$。由于算子仅连接相邻的网格点，该矩阵是稀疏的，这对于计算效率至关重要。\n\n**2. 基态计算**\n\n寻找基态的问题简化为寻找稀疏矩阵$\\mathbf{H}(r)$的最低特征值$E_0$所对应的本征对$(E_0, \\psi_0)$。这是一个标准的数值线性代数任务，可以使用迭代特征求解器高效求解，例如`scipy.sparse.linalg.eigs`中实现的Arnoldi方法。我们寻求具有最小模或最小实部的特征值。\n\n得到的本征向量$\\tilde{\\psi}_0$通常被归一化，使其L2范数为1，即$\\sum_k |\\tilde{\\psi}_{0,k}|^2 = 1$。问题规定，概率密度的离散积分$\\sum_{i,j} |\\psi_0(x_i, y_j)|^2 a^2$必须等于$1$。如果我们设$\\psi_0(x_i, y_j) = \\tilde{\\psi}_{0,k}/a$，这个条件就得到满足：$\\sum_k (|\\tilde{\\psi}_{0,k}|^2/a^2) a^2 = \\sum_k |\\tilde{\\psi}_{0,k}|^2 = 1$。那么，在点$(x_i, y_j)$周围面积为$a^2$的单元中找到电子的概率为$P_{ij} = |\\psi_0(x_i, y_j)|^2 a^2 = |\\tilde{\\psi}_{0,k}|^2$。因此，求解器输出的单位归一化本征向量各分量的模平方直接给出了网格上的概率分布。\n\n**3. 波函数局域化分数**\n\n知道了所有网格点的概率分布$P_{ij}$后，分数$f_{\\mathrm{corner}}$和$f_{\\mathrm{central}}$通过对落入指定区域内的网格点上的$P_{ij}$求和来计算。\n\n-   **角区分数 $f_{\\mathrm{corner}}(r)$**：我们对所有满足条件$\\min(\\sqrt{x_i^2+y_j^2}, \\sqrt{(x_i-W)^2+y_j^2}) \\le d_c$的点$(x_i, y_j)$的$P_{ij}$求和。这标识了距离左上角$(0,0)$或右上角$(W,0)$半径$d_c$范围内的点。\n\n-   **中心分数 $f_{\\mathrm{central}}(r)$**：我们对所有满足条件$\\min(x_i, W-x_i, y_j) \\ge d_v$的点$(x_i, y_j)$的$P_{ij}$求和。这标识了鳍片中心核心区域的点，这些点距离顶部和侧面栅极表面的距离至少为$d_v$。\n\n**4. 体反型判据**\n\n对于测试集中的每个圆角半径$r$值，我们评估这两个分数。如果同时满足以下两个条件，则宣告实现了真体反型：\n$$\nf_{\\mathrm{central}}(r) \\ge 0.5 \\quad \\text{and} \\quad f_{\\mathrm{corner}}(r) \\le 0.3\n$$\n此条件表明电子波函数主要局域在鳍片的中心，远离角区。算法遍历所提供的$r$值，执行这些计算，并为每个情况记录一个布尔结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags, identity, kron\nfrom scipy.sparse.linalg import eigs\n\ndef solve():\n    \"\"\"\n    Solves the 2D Schrödinger equation for a tri-gate fin cross-section\n    to determine if true volume inversion is achieved for various corner\n    rounding radii.\n    \"\"\"\n\n    # Physical constants\n    HBAR_EV_S = 6.582119569e-16  # Reduced Planck constant in eV*s\n    M0_EV_C2 = 0.51099895e6     # Electron rest mass in eV/c^2\n    C_NM_S = 2.99792458e17      # Speed of light in nm/s\n\n    # Problem parameters\n    W_nm = 8.0     # Fin width in nm\n    H_nm = 30.0    # Fin height in nm\n    a_nm = 0.5     # Grid spacing in nm\n    m_star_factor = 0.19  # Effective mass in units of m0\n    Phi0_eV = 0.20 # Potential amplitude in eV\n    lambda_nm = 2.0 # Potential decay length in nm\n    dc_nm = 1.0    # Corner region radius in nm\n    dv_nm = 2.0    # Central region distance threshold in nm\n\n    test_radii_nm = [0.0, 0.5, 1.5, 3.0]\n\n    # Derived constants and grid setup\n    m_star_ev = m_star_factor * M0_EV_C2\n    T0_eV_nm2 = (HBAR_EV_S**2 * C_NM_S**2) / (2 * m_star_ev)\n\n    Nx = int(W_nm / a_nm) - 1\n    Ny = int(H_nm / a_nm) - 1\n    N = Nx * Ny\n\n    # Grid coordinates for interior points\n    x = np.arange(1, Nx + 1) * a_nm\n    y = np.arange(1, Ny + 1) * a_nm\n    xx, yy = np.meshgrid(x, y)\n\n    # --- Construct Kinetic Energy Matrix ---\n    # 1D Laplacian matrix for a grid of size M\n    def laplacian_1d(M):\n        diagonals = [np.ones(M - 1), -2 * np.ones(M), np.ones(M - 1)]\n        offsets = [-1, 0, 1]\n        D_1d = diags(diagonals, offsets, shape=(M, M), format='csc') / (a_nm**2)\n        return D_1d\n\n    Dx = laplacian_1d(Nx)\n    Dy = laplacian_1d(Ny)\n\n    Ix = identity(Nx)\n    Iy = identity(Ny)\n\n    # 2D Laplacian using Kronecker product\n    L_2d = kron(Iy, Dx) + kron(Dy, Ix)\n    T = -T0_eV_nm2 * L_2d\n\n    results = []\n\n    for r_nm in test_radii_nm:\n        # --- Construct Potential Energy Matrix for the given r ---\n        def smoothed_dist(t, r):\n            return np.sqrt(t**2 + r**2) - r\n\n        d_r_y = smoothed_dist(yy, r_nm)\n        d_r_x = smoothed_dist(xx, r_nm)\n        d_r_W_minus_x = smoothed_dist(W_nm - xx, r_nm)\n\n        potential_grid = -Phi0_eV * (\n            np.exp(-d_r_y / lambda_nm) +\n            np.exp(-d_r_x / lambda_nm) +\n            np.exp(-d_r_W_minus_x / lambda_nm)\n        )\n        \n        V = diags(potential_grid.flatten(), format='csc')\n        H = T + V\n\n        # --- Solve for the ground state ---\n        # Find the eigenpair with the smallest magnitude eigenvalue\n        # (which will be the ground state)\n        # k=1 ensures we only get the lowest state.\n        try:\n            eigenvalues, eigenvectors = eigs(H, k=1, which='SM')\n        except Exception:\n            # Fallback for numerical stability if 'SM' fails\n            eigenvalues, eigenvectors = eigs(H, k=1, which='SR')\n\n        # The eigenvector from eigs is in a column\n        ground_state_vec = eigenvectors[:, 0]\n\n        # The squared magnitude of the unit-normalized eigenvector components\n        # represents the probability distribution on the discrete grid.\n        prob_dist = np.abs(ground_state_vec)**2\n        prob_dist_2d = prob_dist.reshape((Ny, Nx))\n\n        # --- Calculate Probability Fractions ---\n        # Corner fraction\n        dist_left_corner = np.sqrt(xx**2 + yy**2)\n        dist_right_corner = np.sqrt((xx - W_nm)**2 + yy**2)\n        min_corner_dist = np.minimum(dist_left_corner, dist_right_corner)\n        corner_mask = min_corner_dist = dc_nm\n        f_corner = np.sum(prob_dist_2d[corner_mask])\n\n        # Central fraction\n        dist_from_x0 = xx\n        dist_from_xW = W_nm - xx\n        dist_from_y0 = yy\n        min_surface_dist = np.minimum(np.minimum(dist_from_x0, dist_from_xW), dist_from_y0)\n        central_mask = min_surface_dist >= dv_nm\n        f_central = np.sum(prob_dist_2d[central_mask])\n        \n        # --- Apply Volume Inversion Criterion ---\n        is_volume_inversion = (f_central >= 0.5) and (f_corner = 0.3)\n        results.append(is_volume_inversion)\n\n    # Format and print the final output\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}