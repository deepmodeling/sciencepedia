{
    "hands_on_practices": [
        {
            "introduction": "The classic \"particle in a box\" model assumes infinitely high potential barriers, a useful but unrealistic simplification. This first exercise bridges theory and reality by asking you to analyze a quantum well with finite potential barriers, a more accurate model for semiconductor heterostructures. By deriving and numerically solving the governing transcendental equations, you will directly compute the allowed energy levels and discover how they differ from the idealized infinite-well case due to wavefunction penetration into the barriers. ",
            "id": "3767844",
            "problem": "Consider a one-dimensional (1D) finite square quantum well for an electron. The potential energy is defined as follows: the well has width $L$ centered at the origin, with $V(x) = 0$ for $|x| \\le L/2$ and $V(x) = V_0$ for $|x| > L/2$, where $V_0 > 0$. An electron with effective mass $m^*$ is confined in the well. A bound state is a stationary state whose total energy $E$ satisfies $0 < E < V_0$ and leads to an evanescent (exponentially decaying) wavefunction outside the well. Your task is to compute the number of bound states and approximate their energies by solving the transcendental equations that arise from the time-independent Schrödinger equation with appropriate boundary conditions. Then compare these bound-state energies to those of an infinite square well of the same width $L$ and the same effective mass $m^*$.\n\nFundamental base to use:\n- The time-independent Schrödinger equation in one dimension: $-\\frac{\\hbar^2}{2 m^*} \\frac{d^2 \\psi}{dx^2} + V(x) \\psi = E \\psi$.\n- Continuity of the wavefunction $\\psi$ and its derivative $d\\psi/dx$ at the well boundaries.\n- For the infinite square well of width $L$ (with infinite barriers), the energy eigenvalues are obtained by solving the Schrödinger equation with $\\psi(\\pm L/2) = 0$.\n\nYour program must:\n- Derive, implement, and solve the transcendental conditions for bound states that come from matching solutions inside and outside the well at $x = \\pm L/2$ using the above fundamental principles. Do not assume any pre-quoted final formula; instead, construct a numerical procedure that searches for intersections of the relevant functions (\"graphical solution\") by scanning intervals and bracketing sign changes to locate roots.\n- Use a dimensionless formulation that makes the numerical search well-conditioned by scaling the inside wave number and the decay constant. Trigonometric functions must be evaluated in radians.\n- For each test case, compute:\n  1. The integer number of bound states $N$.\n  2. The list of bound-state energies in electronvolts (eV), ordered from lowest to highest, rounded to six decimals.\n  3. The list of the first $N$ energy levels of the infinite square well with the same $L$ and $m^*$, in electronvolts (eV), rounded to six decimals.\n  4. The list of differences between the corresponding infinite-well and finite-well energies (each difference in eV, rounded to six decimals), ordered consistently with item $2$.\n\nPhysical constants and units:\n- Use the reduced Planck constant $\\hbar$ in joule-seconds, the free electron rest mass $m_0$ in kilograms, and the elementary charge $q$ in coulombs.\n- Use $m^* = \\mu m_0$ where $\\mu$ is a given dimensionless effective-mass ratio.\n- Convert $V_0$ from electronvolts (eV) to joules (J) for the Schrödinger equation, and convert computed energies back to electronvolts (eV) for reporting.\n- Use $L$ in meters (m) in all internal calculations.\n- Report all energies in eV, rounded to six decimals. Angles for trigonometric functions must be in radians.\n\nTest suite:\nProvide results for each of the following parameter sets $(V_0, L, \\mu)$, where $V_0$ is in eV, $L$ is in nm, and $\\mu$ multiplies $m_0$:\n- Case A: $(V_0, L, \\mu) = (0.3, 5.0, 0.067)$.\n- Case B: $(V_0, L, \\mu) = (0.02, 3.0, 0.067)$.\n- Case C: $(V_0, L, \\mu) = (0.5, 10.0, 0.067)$.\n- Case D: $(V_0, L, \\mu) = (0.2, 2.0, 0.19)$.\n- Case E: $(V_0, L, \\mu) = (0.15, 4.0, 0.10)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the five cases as a comma-separated list enclosed in square brackets, with each case formatted as a list: $[N, [E_1, E_2, \\dots], [E_1^{(\\infty)}, E_2^{(\\infty)}, \\dots], [\\Delta_1, \\Delta_2, \\dots]]$, where $\\Delta_n = E_n^{(\\infty)} - E_n$. For example: $[[N_A,[...],[...],[...]],[N_B,[...],[...],[...]],\\dots]$.\n- All energies must be in eV, rounded to six decimals, and all lists must be ordered from lowest to highest energy (where applicable). If $N = 0$, the three lists should be empty lists.\n\nNote: Ensure scientific realism by using the stated physical constants and dimensional consistency. The algorithmic search for bound-state energies must be based on the physically derived transcendental equations that enforce matching of the wavefunction and its derivative at the well boundaries. The solution must be computed numerically by locating the intersections via bracketing sign changes, reflecting a graphical solution approach.",
            "solution": "The problem presented is a standard, well-posed problem in quantum mechanics concerning the bound states of a finite one-dimensional square potential well. It is scientifically sound, contains all necessary information, and its parameters are physically realistic for semiconductor quantum wells. Therefore, the problem is valid, and we proceed to a full solution.\n\nThe solution involves deriving the characteristic transcendental equations from the time-independent Schrödinger equation and its boundary conditions, reformulating them in a dimensionless form, and then solving them numerically to find the allowed energy eigenvalues. These will be compared to the energies of an infinite potential well of the same width.\n\nThe one-dimensional time-independent Schrödinger equation for an electron with effective mass $m^*$ is:\n$$-\\frac{\\hbar^2}{2 m^*} \\frac{d^2 \\psi(x)}{dx^2} + V(x) \\psi(x) = E \\psi(x)$$\nThe potential $V(x)$ is defined as a symmetric finite square well of width $L$ and depth $V_0$:\n$$V(x) = \\begin{cases} 0 & \\text{for } |x| \\le L/2 \\quad (\\text{Region I, inside the well}) \\\\ V_0 & \\text{for } |x| > L/2 \\quad (\\text{Region II, outside the well}) \\end{cases}$$\nWe seek bound-state solutions, for which the energy $E$ of the electron is in the range $0 < E < V_0$.\n\nIn Region I ($|x| \\le L/2$), the Schrödinger equation becomes:\n$$\\frac{d^2 \\psi_I}{dx^2} = -\\frac{2m^*E}{\\hbar^2} \\psi_I = -k^2 \\psi_I$$\nwhere we define the wave number $k = \\sqrt{2m^*E/\\hbar^2}$. The general solution is $\\psi_I(x) = A \\sin(kx) + B \\cos(kx)$.\n\nIn Region II ($|x| > L/2$), the Schrödinger equation becomes:\n$$\\frac{d^2 \\psi_{II}}{dx^2} = \\frac{2m^*(V_0 - E)}{\\hbar^2} \\psi_{II} = \\alpha^2 \\psi_{II}$$\nwhere we define the decay constant $\\alpha = \\sqrt{2m^*(V_0 - E)/\\hbar^2}$. The general solution is $\\psi_{II}(x) = C e^{\\alpha x} + D e^{-\\alpha x}$. For a bound state, the wavefunction must be normalizable, which requires $\\psi(x) \\to 0$ as $|x| \\to \\infty$. This implies that for $x > L/2$, $\\psi_{II}(x) = D e^{-\\alpha x}$, and for $x < -L/2$, $\\psi_{II}(x) = C e^{\\alpha x}$.\n\nSince the potential $V(x)$ is an even function ($V(x) = V(-x)$), the stationary state wavefunctions $\\psi(x)$ can be classified as having either even or odd parity.\n\n**Even Parity Solutions**\nFor even solutions, $\\psi(x) = \\psi(-x)$.\n- In Region I, the solution must be an even function, so we take the cosine term: $\\psi_I(x) = B \\cos(kx)$.\n- In Region II, the solution must also be even, so $\\psi_{II}(x) = C_0 e^{-\\alpha|x|}$ for some constant $C_0$.\nThe boundary conditions require that $\\psi(x)$ and its derivative $d\\psi/dx$ be continuous at the well boundaries $x = \\pm L/2$. Due to symmetry, we only need to apply these conditions at $x=L/2$:\n1. Continuity of $\\psi(x)$: $B \\cos(kL/2) = C_0 e^{-\\alpha L/2}$\n2. Continuity of $d\\psi/dx$: $-kB \\sin(kL/2) = -\\alpha C_0 e^{-\\alpha L/2}$\nDividing the second equation by the first yields the transcendental equation for even states:\n$$k \\tan(kL/2) = \\alpha$$\n\n**Odd Parity Solutions**\nFor odd solutions, $\\psi(x) = -\\psi(-x)$.\n- In Region I, the solution must be an odd function: $\\psi_I(x) = A \\sin(kx)$.\n- In Region II, the solution must also be odd: $\\psi_{II}(x) = D_0 \\cdot \\text{sgn}(x) \\cdot e^{-\\alpha|x|}$.\nApplying boundary conditions at $x = L/2$:\n1. Continuity of $\\psi(x)$: $A \\sin(kL/2) = D_0 e^{-\\alpha L/2}$\n2. Continuity of $d\\psi/dx$: $kA \\cos(kL/2) = -\\alpha D_0 e^{-\\alpha L/2}$\nDividing the second equation by the first gives the transcendental equation for odd states:\n$$k \\cot(kL/2) = -\\alpha$$\n\n**Dimensionless Formulation**\nTo facilitate a numerical solution, we introduce dimensionless variables. Let $\\xi = kL/2$ and $\\eta = \\alpha L/2$. The equations become:\n- Even states: $\\xi \\tan(\\xi) = \\eta$\n- Odd states: $-\\xi \\cot(\\xi) = \\eta$\n\nWe can find a relationship between $\\xi$ and $\\eta$ that is independent of the energy $E$:\n$$\\xi^2 + \\eta^2 = (kL/2)^2 + (\\alpha L/2)^2 = \\frac{L^2}{4} \\left( \\frac{2m^*E}{\\hbar^2} + \\frac{2m^*(V_0-E)}{\\hbar^2} \\right) = \\frac{m^*L^2V_0}{2\\hbar^2}$$\nLet's define a dimensionless parameter $R^2 = \\frac{m^*L^2V_0}{2\\hbar^2}$, which characterizes the \"strength\" of the well. The constraint becomes $\\xi^2 + \\eta^2 = R^2$. Since $k$ and $\\alpha$ are positive real numbers for bound states, we have $\\xi > 0$ and $\\eta > 0$. This means solutions correspond to intersections of the transcendental curves with a circle of radius $R$ in the first quadrant of the $(\\xi, \\eta)$ plane.\n\nSubstituting $\\eta = \\sqrt{R^2 - \\xi^2}$ into the transcendental equations, we obtain equations solely in terms of $\\xi$ for $0 < \\xi < R$:\n- Even states: $\\xi \\tan(\\xi) = \\sqrt{R^2 - \\xi^2}$\n- Odd states: $-\\xi \\cot(\\xi) = \\sqrt{R^2 - \\xi^2}$\n\nThese equations must be solved numerically. We can find the roots of the functions $f_{\\text{even}}(\\xi) = \\xi \\tan(\\xi) - \\sqrt{R^2 - \\xi^2}$ and $f_{\\text{odd}}(\\xi) = -\\xi \\cot(\\xi) - \\sqrt{R^2 - \\xi^2}$.\n- Even solutions exist in intervals $(n\\pi, (n+1/2)\\pi)$ for integers $n \\ge 0$.\n- Odd solutions exist in intervals $((n+1/2)\\pi, (n+1)\\pi)$ for integers $n \\ge 0$.\nA solution exists in a given interval only if the interval lies (at least partially) within the domain $(0, R)$. The total number of bound states $N$ is the total number of roots found. Once a root $\\xi_i$ is found, the corresponding energy $E_i$ is calculated from the definition of $\\xi$:\n$$E_i = \\frac{2\\hbar^2 \\xi_i^2}{m^*L^2}$$\n\n**Infinite Square Well Comparison**\nFor an infinite square well of the same width $L$, the potential is $V(x)=0$ for $|x| \\le L/2$ and $V(x)=\\infty$ for $|x|>L/2$. The boundary conditions are $\\psi(\\pm L/2) = 0$. This quantizes the wave number as $k_n = n\\pi/L$ for positive integers $n=1, 2, 3, \\ldots$. The energy eigenvalues are:\n$$E_n^{(\\infty)} = \\frac{\\hbar^2 k_n^2}{2m^*} = \\frac{\\hbar^2 \\pi^2 n^2}{2m^*L^2}$$\nFor each test case, we will compute the first $N$ of these infinite well energies for comparison.\n\n**Numerical Implementation Strategy**\nThe program will implement the following steps for each set of parameters $(V_0, L, \\mu)$:\n1.  Convert input parameters to SI units: $V_0$ [eV] to Joules, $L$ [nm] to meters.\n2.  Calculate the effective mass $m^* = \\mu m_0$.\n3.  Compute the dimensionless well strength parameter $R = \\sqrt{m^*L^2V_0/(2\\hbar^2)}$.\n4.  Systematically search for roots of the transcendental equations for $\\xi$ in the range $(0, R)$. We will use the `scipy.optimize.brentq` method, which is efficient and robust for finding roots in a bracketed interval.\n    - For even states, search for roots of $f_{\\text{even}}(\\xi)$ in intervals $[n\\pi, (n+1/2)\\pi]$ for $n=0, 1, \\dots$ as long as $n\\pi < R$.\n    - For odd states, search for roots of $f_{\\text{odd}}(\\xi)$ in intervals $[(n+1/2)\\pi, (n+1)\\pi]$ for $n=0, 1, \\dots$ as long as $(n+1/2)\\pi < R$.\n5.  Collect all found roots $\\xi_i$, sort them in increasing order, and determine the number of bound states $N$.\n6.  Calculate the finite well energies $E_i$ from each $\\xi_i$.\n7.  Calculate the corresponding first $N$ infinite well energies $E_n^{(\\infty)}$.\n8.  Compute the differences $\\Delta_n = E_n^{(\\infty)} - E_n$.\n9.  Convert all energy values to eV and round to six decimal places as required.\n10. Format the results as specified: $[N, [E_1, \\dots], [E_1^{(\\infty)}, \\dots], [\\Delta_1, \\dots]]$.\n\nThis procedure is implemented in the following Python code.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\nfrom scipy.constants import hbar, m_e, e\n\ndef solve():\n    \"\"\"\n    Computes bound state energies for a finite quantum well, compares them to an infinite well,\n    and formats the output as specified in the problem.\n    \"\"\"\n    \n    # Physical constants\n    HBAR = hbar  # Reduced Planck constant in J·s\n    M0 = m_e     # Electron rest mass in kg\n    Q = e        # Elementary charge in C\n\n    # Test cases: (V0_eV, L_nm, mu)\n    test_cases = [\n        (0.3, 5.0, 0.067),   # Case A\n        (0.02, 3.0, 0.067),  # Case B\n        (0.5, 10.0, 0.067),  # Case C\n        (0.2, 2.0, 0.19),    # Case D\n        (0.15, 4.0, 0.10),   # Case E\n    ]\n\n    all_results = []\n    \n    for V0_ev, L_nm, mu in test_cases:\n        # Convert inputs to SI units\n        V0_j = V0_ev * Q\n        L_m = L_nm * 1e-9\n        m_star = mu * M0\n\n        # If V0 is non-positive, there are no bound states\n        if V0_j <= 0:\n            all_results.append([0, [], [], []])\n            continue\n\n        # Calculate dimensionless parameters R and R^2\n        R_sq = (m_star * (L_m**2) * V0_j) / (2 * HBAR**2)\n        R = np.sqrt(R_sq)\n\n        xi_solutions = []\n        \n        # A small epsilon to avoid singularities at interval boundaries for root finding\n        eps = 1e-12\n\n        # Transcendental functions for root finding\n        # Define a safe square root to handle potential floating point inaccuracies near R\n        def sqrt_safe(x):\n            return np.sqrt(np.maximum(0, x))\n\n        f_even = lambda xi: xi * np.tan(xi) - sqrt_safe(R_sq - xi**2)\n        f_odd = lambda xi: -xi / np.tan(xi) - sqrt_safe(R_sq - xi**2)\n        \n        # Search for even states\n        n = 0\n        while True:\n            a = n * np.pi\n            b = (n + 0.5) * np.pi\n            \n            if a >= R:\n                break\n            \n            # Adjust upper bound if it exceeds R\n            if b > R:\n                b = R\n            \n            # brentq requires f(a)*f(b) < 0. This is guaranteed by the physics\n            # if we avoid singularities and the interval exists.\n            try:\n                # Shrink interval slightly to avoid singularities at poles of tan(xi)\n                upper_bound = b if b == R else b - eps\n                if a + eps < upper_bound:\n                    xi_sol = brentq(f_even, a + eps, upper_bound)\n                    xi_solutions.append(xi_sol)\n            except (ValueError, RuntimeError):\n                # This may happen if interval is too small or f(a)f(b)>0\n                # which shouldn't occur in valid physical ranges.\n                pass\n            \n            n += 1\n\n        # Search for odd states\n        n = 0\n        while True:\n            a = (n + 0.5) * np.pi\n            b = (n + 1.0) * np.pi\n            \n            if a >= R:\n                break\n                \n            if b > R:\n                b = R\n            \n            try:\n                # Shrink interval to avoid poles of cot(xi) (which is 1/tan(xi))\n                upper_bound = b if b == R else b - eps\n                if a + eps < upper_bound:\n                    xi_sol = brentq(f_odd, a + eps, upper_bound)\n                    xi_solutions.append(xi_sol)\n            except (ValueError, RuntimeError):\n                pass\n            \n            n += 1\n            \n        xi_solutions.sort()\n        N = len(xi_solutions)\n\n        if N == 0:\n            all_results.append([0, [], [], []])\n            continue\n            \n        # Calculate finite well energies in eV\n        # E = V0 * (xi/R)^2\n        finite_energies_ev = [round(V0_ev * (xi / R)**2, 6) for xi in xi_solutions]\n\n        # Calculate infinite well energies for first N states in eV\n        # E_inf_n = (hbar^2 * pi^2 * n^2) / (2 * m* * L^2)\n        inf_well_energies_ev = []\n        for i in range(1, N + 1):\n            energy_j = (HBAR**2 * np.pi**2 * i**2) / (2 * m_star * L_m**2)\n            inf_well_energies_ev.append(round(energy_j / Q, 6))\n\n        # Calculate differences\n        diff_energies_ev = [round(inf - fin, 6) for inf, fin in zip(inf_well_energies_ev, finite_energies_ev)]\n\n        all_results.append([N, finite_energies_ev, inf_well_energies_ev, diff_energies_ev])\n    \n    # Format the final output string\n    # str() on a list creates a python-like representation including brackets.\n    # Joining these with commas and enclosing in one more pair of brackets gives the desired format.\n    result_str = f\"[{','.join(map(str, all_results))}]\"\n    print(result_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Quantum tunneling, the non-classical passage of a particle through a potential barrier, is a fundamental process in nanoelectronics. This practice challenges you to derive the transmission probability through a simple rectangular barrier using two different lenses: an exact analytical solution and the powerful Wentzel-Kramers-Brillouin (WKB) approximation. By comparing these results, you will not only master the core mechanics of tunneling calculations but also gain a critical understanding of the WKB method's accuracy and its regime of validity. ",
            "id": "3767874",
            "problem": "Consider a one-dimensional electron described by the effective mass Schrödinger equation with constant effective mass $m^{\\ast}$ in all regions. The potential profile is a rectangular barrier of height $V_{0}$ and width $L$, given by $V(x) = 0$ for $x < 0$, $V(x) = V_{0}$ for $0 \\le x \\le L$, and $V(x) = 0$ for $x > L$. An electron of energy $E$ with $0 < E < V_{0}$ impinges from the left ($x \\to -\\infty$). Assume elastic scattering and no inelastic processes.\n\nStarting from the time-independent Schrödinger equation, use continuity conditions at the interfaces and the transfer-matrix formalism to derive an exact closed-form expression for the transmission probability $T_{\\text{exact}}(E)$ through the barrier. Then, apply the Wentzel–Kramers–Brillouin (WKB) approximation to obtain the leading-order transmission probability $T_{\\text{WKB}}(E)$ in the regime defined by a high and/or wide barrier such that the evanescent decay parameter inside the barrier obeys $\\kappa L \\gg 1$, where $\\kappa \\equiv \\sqrt{2 m^{\\ast} (V_{0} - E)}/\\hbar$. Finally, determine the asymptotic ratio\n$$\nR(E) \\equiv \\frac{T_{\\text{exact}}(E)}{T_{\\text{WKB}}(E)}\n$$\nin the limit $\\kappa L \\to \\infty$, and express your final answer as a single closed-form analytic expression in terms of $E$ and $V_{0}$. No numerical evaluation is required. Express the final answer without units. No rounding is required.",
            "solution": "The user wants me to solve the problem by following these steps:\n1.  **Problem Validation**: I will first validate the problem based on the provided criteria.\n2.  **Derive Exact Transmission Probability ($T_{\\text{exact}}$)**: I will solve the time-independent Schrödinger equation for the given potential barrier, apply continuity conditions, and use the transfer-matrix formalism to find the exact expression for the transmission probability.\n3.  **Derive WKB Transmission Probability ($T_{\\text{WKB}}$)**: I will apply the WKB approximation to find the transmission probability in the specified regime.\n4.  **Calculate Asymptotic Ratio ($R(E)$)**: I will compute the ratio of the exact to the WKB transmission probability in the limit where the barrier is high and/or wide.\n\n### Step 1: Problem Validation\n\n**1.1. Extraction of Givens**\n-   **System**: A one-dimensional electron with constant effective mass $m^{\\ast}$.\n-   **Potential Profile**: $V(x) = 0$ for $x < 0$, $V(x) = V_{0}$ for $0 \\le x \\le L$, and $V(x) = 0$ for $x > L$.\n-   **Energy**: Electron energy $E$ satisfies $0 < E < V_{0}$.\n-   **Process**: Elastic scattering, electron incident from the left ($x \\to -\\infty$).\n-   **Task 1**: Derive the exact transmission probability $T_{\\text{exact}}(E)$ using continuity conditions and the transfer-matrix formalism.\n-   **Task 2**: Derive the leading-order WKB transmission probability $T_{\\text{WKB}}(E)$ in the regime $\\kappa L \\gg 1$, where $\\kappa \\equiv \\sqrt{2 m^{\\ast} (V_{0} - E)}/\\hbar$.\n-   **Task 3**: Determine the asymptotic ratio $R(E) \\equiv \\frac{T_{\\text{exact}}(E)}{T_{\\text{WKB}}(E)}$ in the limit $\\kappa L \\to \\infty$.\n-   **Final Answer Format**: A single closed-form analytic expression in terms of $E$ and $V_{0}$.\n\n**1.2. Validation against Criteria**\n-   **Scientific Grounding**: The problem is a canonical example of quantum tunneling from introductory and advanced quantum mechanics and solid-state physics. All concepts (Schrödinger equation, effective mass, potential barrier, WKB approximation, transfer matrix) are standard and scientifically sound.\n-   **Well-Posedness**: The problem is well-posed. The physical setup is clearly defined, and the quantities to be derived have unique and meaningful solutions.\n-   **Objectivity**: The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n-   **Completeness and Consistency**: The problem provides all necessary symbolic parameters ($m^{\\ast}$, $V_{0}$, $L$, $E$) and conditions to perform the derivations. There are no contradictions.\n-   **Realism and Feasibility**: The rectangular barrier is an idealized but foundational model for real physical systems like quantum wells, tunnel diodes, and scanning tunneling microscopes. The conditions are physically plausible within this model.\n\n**1.3. Verdict**\nThe problem is **valid**. It is a standard, well-posed problem in quantum mechanics that tests fundamental principles and calculational techniques. I will proceed with the solution.\n\n### Step 2: Solution Derivation\n\nThe analysis begins with the one-dimensional time-independent Schrödinger equation (TISE) for an electron with effective mass $m^{\\ast}$:\n$$-\\frac{\\hbar^2}{2m^{\\ast}}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$$\nWe solve this equation in the three specified regions.\n\n**Region I ($x < 0$): $V(x) = 0$**\nThe TISE is $\\frac{d^2\\psi_I}{dx^2} = -k^2\\psi_I$, where $k = \\sqrt{2m^{\\ast}E}/\\hbar$. The general solution is a superposition of a right-moving incident wave and a left-moving reflected wave:\n$$\\psi_I(x) = A e^{ikx} + B e^{-ikx}$$\n\n**Region II ($0 \\le x \\le L$): $V(x) = V_{0}$**\nSince $E < V_{0}$, the TISE is $\\frac{d^2\\psi_{II}}{dx^2} = \\kappa^2\\psi_{II}$, where $\\kappa = \\sqrt{2m^{\\ast}(V_0 - E)}/\\hbar$. The solution is a superposition of exponentially decaying and growing waves:\n$$\\psi_{II}(x) = C e^{\\kappa x} + D e^{-\\kappa x}$$\n\n**Region III ($x > L$): $V(x) = 0$**\nThe TISE is again $\\frac{d^2\\psi_{III}}{dx^2} = -k^2\\psi_{III}$. The solution represents the transmitted wave. Since the electron is incident from the left, there is no wave moving to the left in this region:\n$$\\psi_{III}(x) = F e^{ikx}$$\n\n**Derivation of $T_{\\text{exact}}(E)$**\n\nWe apply the continuity of the wavefunction $\\psi(x)$ and its first derivative $\\psi'(x)$ at the interfaces $x=0$ and $x=L$. This procedure is the essence of the transfer-matrix method, as it relates the wave amplitudes across the structure.\n\nAt $x=0$:\n1.  $\\psi_I(0) = \\psi_{II}(0) \\implies A + B = C + D$\n2.  $\\psi'_I(0) = \\psi'_{II}(0) \\implies ik(A - B) = \\kappa(C - D)$\n\nAt $x=L$:\n3.  $\\psi_{II}(L) = \\psi_{III}(L) \\implies C e^{\\kappa L} + D e^{-\\kappa L} = F e^{ikL}$\n4.  $\\psi'_{II}(L) = \\psi'_{III}(L) \\implies \\kappa(C e^{\\kappa L} - D e^{-\\kappa L}) = ik F e^{ikL}$\n\nOur goal is to find the transmission probability $T_{\\text{exact}} = |F/A|^2$. We solve for the amplitude $A$ in terms of $F$. First, we express $C$ and $D$ in terms of $F$ using the conditions at $x=L$:\nAdding $(3) \\times \\kappa$ and $(4)$: $2\\kappa C e^{\\kappa L} = (\\kappa+ik)F e^{ikL} \\implies C = \\frac{\\kappa+ik}{2\\kappa} e^{ikL} e^{-\\kappa L} F$.\nSubtracting $(4)$ from $(3) \\times \\kappa$: $2\\kappa D e^{-\\kappa L} = (\\kappa-ik)F e^{ikL} \\implies D = \\frac{\\kappa-ik}{2\\kappa} e^{ikL} e^{\\kappa L} F$.\n\nNext, we express $A$ in terms of $C$ and $D$ using the conditions at $x=0$:\nAdding $(1) \\times ik$ and $(2)$: $2ikA = ik(C+D) + \\kappa(C-D) = C(ik+\\kappa) + D(ik-\\kappa)$.\nSubstituting the expressions for $C$ and $D$ in terms of $F$:\n$$2ikA = \\left( \\frac{\\kappa+ik}{2\\kappa} e^{ikL} e^{-\\kappa L} F \\right) (ik+\\kappa) + \\left( \\frac{\\kappa-ik}{2\\kappa} e^{ikL} e^{\\kappa L} F \\right) (ik-\\kappa)$$\n$$2ikA = \\frac{F e^{ikL}}{2\\kappa} \\left[ (\\kappa+ik)^2 e^{-\\kappa L} - (\\kappa-ik)^2 e^{\\kappa L} \\right]$$\n$$A = \\frac{F e^{ikL}}{4ik\\kappa} \\left[ (\\kappa^2 - k^2 + 2ik\\kappa)e^{-\\kappa L} - (\\kappa^2 - k^2 - 2ik\\kappa)e^{\\kappa L} \\right]$$\n$$A = \\frac{F e^{ikL}}{4ik\\kappa} \\left[ (\\kappa^2 - k^2)(e^{-\\kappa L} - e^{\\kappa L}) + 2ik\\kappa(e^{-\\kappa L} + e^{\\kappa L}) \\right]$$\nUsing the definitions of hyperbolic functions $\\sinh(z) = \\frac{e^z-e^{-z}}{2}$ and $\\cosh(z) = \\frac{e^z+e^{-z}}{2}$:\n$$A = F e^{ikL} \\left[ \\frac{(\\kappa^2 - k^2})}{-2ik\\kappa} \\sinh(\\kappa L) + \\cosh(\\kappa L) \\right]$$\n$$A = F e^{ikL} \\left[ \\cosh(\\kappa L) + i\\frac{k^2 - \\kappa^2}{2k\\kappa} \\sinh(\\kappa L) \\right]$$\nThe transmission amplitude is $t = F/A$. The transmission probability $T_{\\text{exact}}$ is $|t|^2 = |F/A|^2$.\n$$T_{\\text{exact}}^{-1} = \\left|\\frac{A}{F}\\right|^2 = \\left|e^{ikL}\\right|^2 \\left| \\cosh(\\kappa L) + i\\frac{k^2 - \\kappa^2}{2k\\kappa} \\sinh(\\kappa L) \\right|^2$$\n$$T_{\\text{exact}}^{-1} = \\cosh^2(\\kappa L) + \\left(\\frac{k^2 - \\kappa^2}{2k\\kappa}\\right)^2 \\sinh^2(\\kappa L)$$\nUsing the identity $\\cosh^2(z) = 1 + \\sinh^2(z)$:\n$$T_{\\text{exact}}^{-1} = 1 + \\sinh^2(\\kappa L) \\left[ 1 + \\frac{(k^2 - \\kappa^2)^2}{4k^2\\kappa^2} \\right]$$\n$$T_{\\text{exact}}^{-1} = 1 + \\sinh^2(\\kappa L) \\left[ \\frac{4k^2\\kappa^2 + k^4 - 2k^2\\kappa^2 + \\kappa^4}{4k^2\\kappa^2} \\right] = 1 + \\sinh^2(\\kappa L) \\frac{(k^2 + \\kappa^2)^2}{4k^2\\kappa^2}$$\nSubstituting the definitions of $k^2$ and $\\kappa^2$:\n$k^2 + \\kappa^2 = \\frac{2m^{\\ast}E}{\\hbar^2} + \\frac{2m^{\\ast}(V_0-E)}{\\hbar^2} = \\frac{2m^{\\ast}V_0}{\\hbar^2}$\n$4k^2\\kappa^2 = 4\\left(\\frac{2m^{\\ast}E}{\\hbar^2}\\right)\\left(\\frac{2m^{\\ast}(V_0-E)}{\\hbar^2}\\right) = \\frac{16(m^{\\ast})^2E(V_0-E)}{\\hbar^4}$\nThe ratio becomes $\\frac{(k^2+\\kappa^2)^2}{4k^2\\kappa^2} = \\frac{(2m^{\\ast}V_0/\\hbar^2)^2}{16(m^{\\ast})^2E(V_0-E)/\\hbar^4} = \\frac{V_0^2}{4E(V_0-E)}$.\nThus, the exact transmission probability is:\n$$T_{\\text{exact}}(E) = \\left[1 + \\frac{V_0^2}{4E(V_0-E)} \\sinh^2(\\kappa L) \\right]^{-1}$$\n\n**Derivation of $T_{\\text{WKB}}(E)$**\n\nThe WKB approximation for the transmission probability through a classically forbidden region from $x_1$ to $x_2$ is given by:\n$$T_{\\text{WKB}}(E) \\approx \\exp\\left(-2 \\int_{x_1}^{x_2} \\sqrt{\\frac{2m^{\\ast}(V(x)-E)}{\\hbar^2}} dx\\right)$$\nFor the rectangular barrier, the classically forbidden region is $[0, L]$, so $x_1=0$ and $x_2=L$. Inside this region, $V(x) = V_0$, a constant. The integral simplifies significantly:\n$$T_{\\text{WKB}}(E) = \\exp\\left(-2 \\int_{0}^{L} \\sqrt{\\frac{2m^{\\ast}(V_0-E)}{\\hbar^2}} dx\\right)$$\nThe term inside the square root is the definition of $\\kappa$. Since $\\kappa$ is constant over the integration interval:\n$$T_{\\text{WKB}}(E) = \\exp\\left(-2 \\int_{0}^{L} \\kappa \\,dx\\right) = \\exp(-2\\kappa L)$$\nThis is the leading-order WKB result, valid for $\\kappa L \\gg 1$.\n\n**Determination of the Asymptotic Ratio $R(E)$**\n\nWe need to find the limit of the ratio $R(E) = \\frac{T_{\\text{exact}}(E)}{T_{\\text{WKB}}(E)}$ as $\\kappa L \\to \\infty$.\nFirst, we find the asymptotic form of $T_{\\text{exact}}(E)$ in this limit. For $\\kappa L \\gg 1$:\n$$\\sinh(\\kappa L) = \\frac{e^{\\kappa L} - e^{-\\kappa L}}{2} \\approx \\frac{1}{2} e^{\\kappa L}$$\nSubstituting this into the expression for $T_{\\text{exact}}(E)$:\n$$T_{\\text{exact}}(E) = \\left[1 + \\frac{V_0^2}{4E(V_0-E)} \\left(\\frac{e^{\\kappa L}}{2}\\right)^2 \\right]^{-1} = \\left[1 + \\frac{V_0^2}{16E(V_0-E)} e^{2\\kappa L} \\right]^{-1}$$\nIn the limit $\\kappa L \\to \\infty$, the term $e^{2\\kappa L} \\to \\infty$, so the $1$ in the denominator becomes negligible compared to the second term:\n$$T_{\\text{exact}}(E) \\approx \\left[\\frac{V_0^2}{16E(V_0-E)} e^{2\\kappa L} \\right]^{-1} = \\frac{16E(V_0-E)}{V_0^2} e^{-2\\kappa L}$$\nNow, we can compute the ratio $R(E)$:\n$$R(E) = \\frac{T_{\\text{exact}}(E)}{T_{\\text{WKB}}(E)} \\xrightarrow{\\kappa L \\to \\infty} \\frac{\\frac{16E(V_0-E)}{V_0^2} e^{-2\\kappa L}}{e^{-2\\kappa L}}$$\nThe exponential terms cancel, leaving the asymptotic ratio:\n$$R(E) = \\frac{16E(V_0-E)}{V_0^2}$$\nThis expression is the pre-exponential factor that distinguishes the exact calculation from the simple WKB exponential decay in the thick-barrier limit. It depends only on the energy $E$ and the barrier height $V_0$.",
            "answer": "$$\\boxed{\\frac{16E(V_{0}-E)}{V_{0}^{2}}}$$"
        },
        {
            "introduction": "The previous exercises built a foundation in confinement and tunneling; now we apply these principles to a functional device using a state-of-the-art simulation technique. This hands-on problem guides you through the implementation of the Non-Equilibrium Green's Function (NEGF) formalism to model a resonant tunneling diode. You will construct the device Hamiltonian, define the influence of external contacts via self-energies, and ultimately compute the energy-resolved transmission, which is the key to understanding the device's operation. ",
            "id": "3767820",
            "problem": "Consider a one-dimensional double-barrier heterostructure modeled within the effective-mass approximation and discretized on a uniform spatial grid. The objective is to implement a Non-Equilibrium Green's Function (NEGF) computation to obtain the energy-resolved transmission through the device. You must write a complete, runnable program that constructs the device Hamiltonian, contact self-energies, retarded Green's function, and computes the transmission using the Caroli formula. All physical quantities must be handled in a scientifically consistent manner with clearly specified units.\n\nFundamental base:\n- The single-band effective-mass Schrödinger equation is given by $-\\dfrac{\\hbar^2}{2 m^\\ast} \\dfrac{d^2 \\psi(x)}{dx^2} + U(x)\\,\\psi(x) = E\\,\\psi(x)$.\n- Using central differences with uniform spacing $a$, the discretized tight-binding (TB) Hamiltonian $H$ on a grid $\\{x_i\\}$ has diagonal elements $H_{ii} = U(x_i) + 2t$ and nearest-neighbor couplings $H_{i,i\\pm 1} = -t$, where $t = \\dfrac{\\hbar^2}{2 m^\\ast a^2}$.\n- Semi-infinite contacts are modeled as uniform TB chains with onsite energy $\\epsilon_0 = U_{\\text{lead}} + 2t$ and hopping $-t$. The retarded surface Green's function $g_s^R(E)$ satisfies the quadratic equation $t^2 (g_s^R)^2 - (E - \\epsilon_0) g_s^R + 1 = 0$. The retarded contact self-energy is $\\Sigma^R = -t^2 g_s^R$, with the root chosen such that $\\operatorname{Im}\\,\\Sigma^R \\le 0$.\n- The retarded device Green's function is $G^R(E) = \\left[(E + i\\eta) I - H - \\Sigma_S^R - \\Sigma_D^R\\right]^{-1}$, where $\\eta > 0$ is an infinitesimal broadening.\n- The level-broadening matrices are $\\Gamma_{S,D}(E) = i\\left(\\Sigma_{S,D}^R - \\Sigma_{S,D}^{R\\dagger}\\right)$.\n- The transmission at energy $E$ is $T(E) = \\operatorname{Tr}\\left[\\Gamma_S(E) G^R(E) \\Gamma_D(E) G^{R\\dagger}(E)\\right]$.\n\nDevice and modeling details:\n- Use the conduction band edge profile $U(x)$ to define a double barrier: a left barrier of height $U_{B1}$ and width $w_{B1}$, followed by a well of width $w_W$ at baseline potential $U_{\\text{lead}}$, followed by a right barrier of height $U_{B2}$ and width $w_{B2}$.\n- The spatial grid spacing is $a$.\n- The effective mass is $m^\\ast$.\n- Energies $E$, potentials $U$, and $t$ must be treated in electron volts (eV); lengths must be in nanometers (nm).\n- Physical constants: use $\\hbar$ in Joule-seconds, the electron rest mass $m_0$ in kilograms, and the elementary charge $q$ in Coulombs to convert $t$ from Joules to electron volts via division by $q$.\n\nYour program must:\n- Construct $H$ for the device region using the specified $U(x)$ and $t$.\n- Construct $\\Sigma_S^R$ and $\\Sigma_D^R$ for semi-infinite contacts using the quadratic relation for $g_s^R$ and place them on the first and last diagonal elements of the device.\n- Compute $G^R(E)$ for each test case at the specified energy with a small broadening $\\eta$.\n- Compute $T(E)$ using the Caroli formula as above.\n\nScientific requirements:\n- The transmission is a dimensionless quantity. Report it as a float.\n- All energies must be in electron volts (eV). All lengths must be in nanometers (nm).\n- Use angle-free quantities only; there is no angle unit involved.\n- Use a small, positive broadening $\\eta$ specified in electron volts (eV).\n\nTest suite:\nImplement the following five test cases. For all cases, use $m^\\ast = 0.067\\,m_0$, $a = 0.5$ nm, $U_{\\text{lead}} = 0.0$ eV, and $\\eta = 10^{-12}$ eV. For widths, convert each segment width to an integer number of grid points via nearest rounding; ensure at least one grid point per segment.\n\n1. Happy path resonance candidate:\n   - $U_{B1} = 0.3$ eV, $w_{B1} = 1.0$ nm\n   - $w_W = 5.0$ nm\n   - $U_{B2} = 0.3$ eV, $w_{B2} = 1.0$ nm\n   - $E = 0.12$ eV\n\n2. Energy below the lead band edge:\n   - $U_{B1} = 0.3$ eV, $w_{B1} = 1.0$ nm\n   - $w_W = 5.0$ nm\n   - $U_{B2} = 0.3$ eV, $w_{B2} = 1.0$ nm\n   - $E = -0.05$ eV\n\n3. Asymmetric barriers:\n   - $U_{B1} = 0.25$ eV, $w_{B1} = 1.0$ nm\n   - $w_W = 4.0$ nm\n   - $U_{B2} = 0.35$ eV, $w_{B2} = 1.0$ nm\n   - $E = 0.15$ eV\n\n4. Thicker barriers:\n   - $U_{B1} = 0.4$ eV, $w_{B1} = 2.0$ nm\n   - $w_W = 3.0$ nm\n   - $U_{B2} = 0.4$ eV, $w_{B2} = 2.0$ nm\n   - $E = 0.22$ eV\n\n5. Narrow well, thin barriers:\n   - $U_{B1} = 0.2$ eV, $w_{B1} = 0.5$ nm\n   - $w_W = 2.0$ nm\n   - $U_{B2} = 0.2$ eV, $w_{B2} = 0.5$ nm\n   - $E = 0.30$ eV\n\nFinal output specification:\n- Your program should produce a single line of output containing the transmission values for the five test cases as a comma-separated list enclosed in square brackets, with each float rounded to six decimal places. For example: \"[0.123456,0.000001,0.543210,0.111111,0.999999]\".",
            "solution": "The user-provided problem is a well-posed and scientifically sound exercise in computational condensed matter physics, specifically in the domain of quantum transport through semiconductor nanostructures. It requires the implementation of the Non-Equilibrium Green's Function (NEGF) formalism for a one-dimensional double-barrier heterostructure. The problem is self-contained, providing all necessary physical formulae, parameters, and boundary conditions. No inconsistencies or logical flaws are apparent. Therefore, a complete solution is warranted.\n\nThe procedure to calculate the energy-resolved transmission coefficient, $T(E)$, involves several sequential steps founded on the principles of quantum mechanics and solid-state physics.\n\nFirst, we define the fundamental physical constants required for the calculations, in SI units: the reduced Planck constant $\\hbar \\approx 1.05457 \\times 10^{-34}$ J·s, the electron rest mass $m_0 \\approx 9.10938 \\times 10^{-31}$ kg, and the elementary charge $q \\approx 1.60217 \\times 10^{-19}$ C.\n\nThe problem is discretized on a spatial grid with spacing $a$, which allows the continuous effective-mass Schrödinger equation to be modeled by a discrete tight-binding Hamiltonian. The key parameter in this model is the hopping energy, $t$, which quantifies the coupling between adjacent grid sites. It is derived from the kinetic energy term of the Schrödinger equation and is given by:\n$$\nt = \\frac{\\hbar^2}{2 m^\\ast a^2}\n$$\nHere, $m^\\ast$ is the electron effective mass, specified as $m^\\ast = 0.067\\,m_0$. For calculations, we use $a$ in meters and $m^\\ast$ in kilograms to obtain $t$ in Joules. This value is then converted to electron volts (eV) by dividing by the elementary charge $q$, ensuring consistency with the potential energies provided in the problem statement. For all test cases, $m^\\ast = 0.067 \\times 9.10938 \\times 10^{-31}$ kg and $a = 0.5 \\times 10^{-9}$ m.\n\nNext, we construct the potential energy profile $U(x)$ for the device region. The device consists of a left barrier of height $U_{B1}$ and width $w_{B1}$, a central quantum well of width $w_W$ at potential $U_{\\text{lead}}$, and a right barrier of height $U_{B2}$ and width $w_{B2}$. These widths are converted into an integer number of grid points, $N_{B1}$, $N_W$, and $N_{B2}$, by computing $\\max(1, \\text{round}(w/a))$. The total number of sites in the device region is $N = N_{B1} + N_W + N_{B2}$. A vector $U$ of size $N$ is created to store the potential energy $U_i$ at each site $i$.\n\nWith the potential profile and hopping energy established, the $N \\times N$ device Hamiltonian matrix, $H$, is constructed. Its elements are defined by the central difference approximation:\n$$\nH_{ij} =\n\\begin{cases}\nU_i + 2t & \\text{if } i = j \\\\\n-t & \\text{if } |i - j| = 1 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nThe diagonal elements $H_{ii}$ represent the on-site energy, while the off-diagonal elements $H_{i, i\\pm1}$ represent the nearest-neighbor hopping.\n\nThe crucial step in the NEGF formalism is to account for the semi-infinite contacts (source and drain) to which the device is connected. These contacts act as reservoirs of electrons and are modeled by contact self-energies, $\\Sigma_S^R(E)$ and $\\Sigma_D^R(E)$. For identical leads with potential $U_{\\text{lead}}$, the self-energy $\\Sigma^R(E)$ can be calculated. The problem provides the quadratic equation relating the surface Green's function $g_s^R$ and the self-energy $\\Sigma^R$:\n$$\n\\Sigma^R = -t^2 g_s^R\n$$\n$$\nt^2 (g_s^R)^2 - (E - \\epsilon_0) g_s^R + 1 = 0\n$$\nwhere $\\epsilon_0 = U_{\\text{lead}} + 2t$ is the on-site energy in the leads. Substituting the first equation into the second yields a quadratic equation for $\\Sigma^R$:\n$$\n(\\Sigma^R)^2 + (E - \\epsilon_0)\\Sigma^R + t^2 = 0\n$$\nTo ensure causality and represent outgoing flux, a small positive imaginary part $i\\eta$ is added to the energy $E$, such that we solve for $\\Sigma^R(E+i\\eta)$. Let $z = E+i\\eta - \\epsilon_0$. The equation becomes $(\\Sigma^R)^2 + z \\Sigma^R + t^2 = 0$. The two solutions are:\n$$\n\\Sigma^R_{\\pm} = \\frac{-z \\pm \\sqrt{z^2-4t^2}}{2}\n$$\nThe physical solution is the one that corresponds to a decaying wave function into the lead, satisfying the condition that the imaginary part of the self-energy is non-positive, $\\operatorname{Im}(\\Sigma^R) \\le 0$. A robust method to select the correct root is to recognize that $\\Sigma^R/t$ represents the hopping amplitude $\\lambda$ from the device into the lead. Physical solutions require $|\\lambda| \\le 1$. The quadratic equation for $\\lambda = \\Sigma^R/t$ is $\\lambda^2 + (z/t)\\lambda + 1=0$. Since the product of the two roots $\\lambda_1 \\lambda_2 = 1$, one root must have a magnitude less than or equal to $1$, while the other has a magnitude greater than or equal to $1$. We calculate both roots and choose the one with $|\\lambda| \\le 1$ to obtain the physically correct $\\Sigma^R(E) = t\\lambda$. The source and drain self-energies are then represented by $N \\times N$ matrices, $\\Sigma_S^R$ and $\\Sigma_D^R$, which are zero everywhere except for $(\\Sigma_S^R)_{0,0} = \\Sigma^R(E)$ and $(\\Sigma_D^R)_{N-1,N-1} = \\Sigma^R(E)$.\n\nThe retarded Green's function of the device coupled to the leads is then found by inverting a matrix:\n$$\nG^R(E) = \\left[ (E+i\\eta)I - H - \\Sigma_S^R(E) - \\Sigma_D^R(E) \\right]^{-1}\n$$\nwhere $I$ is the $N \\times N$ identity matrix.\n\nThe broadening matrices, $\\Gamma_S(E)$ and $\\Gamma_D(E)$, describe the rate at which electrons can enter or leave the device from the contacts. They are related to the anti-Hermitian part of the self-energies:\n$$\n\\Gamma_{S,D}(E) = i \\left( \\Sigma_{S,D}^R(E) - \\Sigma_{S,D}^{R\\dagger}(E) \\right) = -2 \\operatorname{Im}(\\Sigma_{S,D}^R(E))\n$$\nFor our scalar self-energies, the broadening matrices are also diagonal, with single non-zero elements $(\\Gamma_S)_{0,0} = \\Gamma_S(E)$ and $(\\Gamma_D)_{N-1,N-1} = \\Gamma_D(E)$.\n\nFinally, the transmission probability $T(E)$ is computed using the Caroli formula:\n$$\nT(E) = \\operatorname{Tr}\\left[\\Gamma_S(E) G^R(E) \\Gamma_D(E) G^{R\\dagger}(E)\\right]\n$$\nGiven the sparse nature of the $\\Gamma$ matrices, this trace simplifies significantly to a much more computationally efficient form involving only one element of the Green's function matrix:\n$$\nT(E) = \\Gamma_S(E) \\Gamma_D(E) |G^R_{0,N-1}(E)|^2\n$$\nwhere $G^R_{0,N-1}$ is the element of the Green's function connecting the first site (coupled to the source) to the last site (coupled to the drain). The program will execute this full sequence for each of the five test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_transmission(params):\n    \"\"\"\n    Calculates the transmission T(E) for a given double-barrier heterostructure.\n    \n    Args:\n        params (dict): A dictionary containing all parameters for the calculation.\n            - 'U_B1': Left barrier height (eV).\n            - 'w_B1': Left barrier width (nm).\n            - 'w_W': Well width (nm).\n            - 'U_B2': Right barrier height (eV).\n            - 'w_B2': Right barrier width (nm).\n            - 'E': Energy at which to calculate transmission (eV).\n            - 'm_star_factor': Effective mass as a factor of m_0.\n            - 'a': Grid spacing (nm).\n            - 'U_lead': Lead potential (eV).\n            - 'eta': Broadening factor (eV).\n\n    Returns:\n        float: The calculated transmission coefficient T(E).\n    \"\"\"\n    # Unpack parameters\n    U_B1, w_B1 = params['U_B1'], params['w_B1']\n    w_W = params['w_W']\n    U_B2, w_B2 = params['U_B2'], params['w_B2']\n    E = params['E']\n    m_star_factor = params['m_star_factor']\n    a_nm = params['a']\n    U_lead = params['U_lead']\n    eta = params['eta']\n\n    # Physical constants in SI units\n    hbar = 1.054571817e-34  # J*s\n    m0 = 9.10938356e-31     # kg\n    q = 1.602176634e-19     # C\n\n    # Model parameters in SI units for calculation of t\n    m_star = m_star_factor * m0\n    a_m = a_nm * 1e-9\n\n    # 1. Calculate the hopping parameter t\n    t_J = (hbar**2) / (2 * m_star * a_m**2)\n    t_eV = t_J / q\n\n    # 2. Construct device geometry and potential profile\n    N_B1 = max(1, int(np.rint(w_B1 / a_nm)))\n    N_W = max(1, int(np.rint(w_W / a_nm)))\n    N_B2 = max(1, int(np.rint(w_B2 / a_nm)))\n    N = N_B1 + N_W + N_B2\n\n    U_profile = np.zeros(N)\n    U_profile[0:N_B1] = U_B1\n    U_profile[N_B1:N_B1+N_W] = U_lead\n    U_profile[N_B1+N_W:N] = U_B2\n\n    # 3. Construct the device Hamiltonian H\n    H = np.zeros((N, N))\n    onsite_term = 2 * t_eV\n    for i in range(N):\n        H[i, i] = U_profile[i] + onsite_term\n    for i in range(N - 1):\n        H[i, i + 1] = -t_eV\n        H[i + 1, i] = -t_eV\n\n    # 4. Calculate the contact self-energy Sigma_R\n    E_complex = E + 1j * eta\n    epsilon_0 = U_lead + 2 * t_eV\n    z = E_complex - epsilon_0\n    \n    # Solve lambda^2 + (z/t)*lambda + 1 = 0 a robust way\n    # and choose root with |lambda| <= 1. Then Sigma_R = t * lambda.\n    arg_sqrt = np.sqrt((z/t_eV)**2 - 4 + 0j) # Add 0j to ensure complex result\n    lambda_1 = (-z/t_eV + arg_sqrt) / 2\n    lambda_2 = (-z/t_eV - arg_sqrt) / 2\n\n    if np.abs(lambda_1) <= np.abs(lambda_2):\n        lambda_phys = lambda_1\n    else:\n        lambda_phys = lambda_2\n        \n    sigma_R = t_eV * lambda_phys\n\n    Sigma_S_mat = np.zeros((N, N), dtype=np.complex128)\n    Sigma_D_mat = np.zeros((N, N), dtype=np.complex128)\n    Sigma_S_mat[0, 0] = sigma_R\n    Sigma_D_mat[N - 1, N - 1] = sigma_R\n\n    # 5. Compute the retarded Green's function G_R\n    M = (E_complex) * np.eye(N) - H - Sigma_S_mat - Sigma_D_mat\n    G_R = np.linalg.inv(M)\n\n    # 6. Compute the broadening matrices Gamma (scalar values)\n    gamma_S = -2 * np.imag(sigma_R)\n    gamma_D = -2 * np.imag(sigma_R)\n\n    # 7. Compute the transmission T(E)\n    g_R_0_N = G_R[0, N - 1]\n    T_E = gamma_S * gamma_D * np.abs(g_R_0_N)**2\n\n    return T_E\n\ndef solve():\n    # Define common parameters for all test cases\n    common_params = {\n        'm_star_factor': 0.067,\n        'a': 0.5,           # nm\n        'U_lead': 0.0,      # eV\n        'eta': 1e-12,       # eV\n    }\n\n    # Define the specific parameters for each test case\n    test_cases_params = [\n        # Case 1: Happy path resonance candidate\n        {'U_B1': 0.3, 'w_B1': 1.0, 'w_W': 5.0, 'U_B2': 0.3, 'w_B2': 1.0, 'E': 0.12},\n        # Case 2: Energy below the lead band edge\n        {'U_B1': 0.3, 'w_B1': 1.0, 'w_W': 5.0, 'U_B2': 0.3, 'w_B2': 1.0, 'E': -0.05},\n        # Case 3: Asymmetric barriers\n        {'U_B1': 0.25, 'w_B1': 1.0, 'w_W': 4.0, 'U_B2': 0.35, 'w_B2': 1.0, 'E': 0.15},\n        # Case 4: Thicker barriers\n        {'U_B1': 0.4, 'w_B1': 2.0, 'w_W': 3.0, 'U_B2': 0.4, 'w_B2': 2.0, 'E': 0.22},\n        # Case 5: Narrow well, thin barriers\n        {'U_B1': 0.2, 'w_B1': 0.5, 'w_W': 2.0, 'U_B2': 0.2, 'w_B2': 0.5, 'E': 0.30},\n    ]\n\n    results = []\n    for case_params in test_cases_params:\n        # Combine common parameters with case-specific parameters\n        full_params = {**common_params, **case_params}\n        transmission = calculate_transmission(full_params)\n        results.append(transmission)\n\n    # Format the final output string\n    output_str = f\"[{','.join(f'{res:.6f}' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}