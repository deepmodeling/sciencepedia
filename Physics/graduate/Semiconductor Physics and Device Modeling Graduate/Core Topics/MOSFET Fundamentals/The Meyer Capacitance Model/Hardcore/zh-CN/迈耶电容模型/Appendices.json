{
    "hands_on_practices": [
        {
            "introduction": "理解Meyer电容模型的关键在于掌握其分段结构。该模型通过将晶体管的工作状态划分为不同区域，并为每个区域指定不同的电容表达式。本练习将带您回到MOSFET物理的基础，从第一性原理出发，推导线性区和饱和区之间的关键边界——饱和电压 $V_{dsat}$。通过完成这个推导，您将深刻理解沟道夹断（pinch-off）这一物理现象是如何直接导致Meyer模型中著名的分段电容分配的。",
            "id": "3780303",
            "problem": "考虑一个在缓变沟道近似下工作的长沟道、准静态、强反型金属氧化物半导体场效应晶体管 (MOSFET)。设沟道从 $x=0$ (源极) 延伸到 $x=L$ (漏极)，沟道电势 $V(x)$ 是相对于源极测量的，因此 $V(0)=0$ 且 $V(L)=V_{ds}$。假设单位面积的栅氧电容 $C_{ox}$ 是均匀的，阈值电压 $V_{th}$ 是恒定的，并忽略反型层中的速度饱和和载流子扩散，以便基于电荷片的漂移-扩散描述成立。在强反型条件下，局部单位面积的反型层电荷密度可以表示为局部沟道电势的函数 $Q_{i}(x)$，而漂移电流由电场 $E_{x}(x)=-\\frac{dV}{dx}$ 和局部可动电荷决定。\n\n从这些基本原理出发，推导饱和起始点时的漏极电压的闭式表达式（即沟道漏极端反型电荷消失，即沟道在 $x=L$ 处夹断时的漏极电压）。然后，利用此起始条件，解释Meyer电容模型中的分段划分如何在线性区和饱和区之间分离栅源和栅漏沟道电容，并说明为什么栅漏沟道电容在此起始点之后被抑制。\n\n请用一个关于 $V_{gs}$ 和 $V_{th}$ 的符号表达式给出饱和漏极电压的最终结果。无需进行数值计算。",
            "solution": "该问题要求推导长沟道MOSFET在饱和起始点时的漏极电压 ($V_{dsat}$)，并解释其在Meyer模型电容划分中的作用。推导将基于所提供的第一性原理。\n\n首先，我们推导饱和漏极电压 $V_{dsat}$ 的表达式。\n问题是在强反型MOSFET的缓变沟道近似和电荷片模型的背景下提出的。根据该模型，沿沟道（从 $x=0$ 的源极到 $x=L$ 的漏极）任意一点 $x$ 的可动反型层电荷密度的大小 $|Q_i(x)|$ 由局部有效栅极电压决定。栅源电压为 $V_{gs}$，恒定阈值电压为 $V_{th}$，相对于源极的局部沟道电势为 $V(x)$。\n\n$x$ 位置处栅氧上的电压是 $V_{gs} - V(x)$。该电压中用于产生可动反型电荷的部分是超过阈值电压 $V_{th}$ 的量。因此，$x$ 位置处反型层电荷密度的大小由下式给出：\n$$|Q_i(x)| = C_{ox} [V_{gs} - V_{th} - V(x)]$$\n该表达式对于沟道处于反型状态的位置 $x$ 有效，即 $V_{gs} - V_{th} - V(x) \\ge 0$ 的位置。\n\n问题将饱和起始点定义为沟道漏极端反型电荷消失的条件。这种现象被称为“夹断”。在沟道的漏极端，位置为 $x=L$，根据定义，沟道电势为漏源电压，即 $V(L) = V_{ds}$。\n\n我们将夹断条件应用于漏极端 ($x=L$) 的电荷密度方程：\n$$|Q_i(x=L)| = 0$$\n代入漏极处的电荷密度表达式和电势可得：\n$$C_{ox} [V_{gs} - V_{th} - V(L)] = 0$$\n由于单位面积的栅氧电容 $C_{ox}$ 是一个非零的物理参数，因此方括号中的项必须为零：\n$$V_{gs} - V_{th} - V(L) = 0$$\n满足此条件的特定漏源电压被定义为饱和漏极电压 $V_{dsat}$。将 $V(L) = V_{dsat}$ 代入方程，我们得到：\n$$V_{gs} - V_{th} - V_{dsat} = 0$$\n求解 $V_{dsat}$，得到饱和起始点时漏极电压的闭式表达式：\n$$V_{dsat} = V_{gs} - V_{th}$$\n此结果在 $V_{gs} \\ge V_{th}$ 时有效；否则，沟道不处于强反型状态。\n\n接下来，我们解释这个起始条件如何决定Meyer模型中电容的分段划分。Meyer模型是一个用于描述内在栅电容（$C_{gs}$ 和 $C_{gd}$）的准静态、分段模型，它依赖于MOSFET的工作区。线性区和饱和区之间的边界恰好是 $V_{ds} = V_{dsat}$。\n\n1.  **线性区（或三极管区）（$0 \\le V_{ds}  V_{dsat}$）：**\n    在此区域，$V_{ds}  V_{gs} - V_{th}$。这意味着 $V_{gs} - V_{th} - V_{ds} > 0$。根据电荷密度表达式，漏极端的电荷 $|Q_i(L)| = C_{ox}[V_{gs} - V_{th} - V_{ds}]$ 大于零。这意味着一个连续的反型层，作为导体，连接着源极和漏极端子。\n    因为这个导电沟道跨越了从源极到漏极的整个距离，所以栅极通过沟道与两个端子都存在电容耦合。因此，栅源电容 ($C_{gs}$) 和栅漏电容 ($C_{gd}$) 都是非零的。在Meyer模型中，当 $V_{ds} > 0$ 时，电荷分布是不对称的（靠近源极处更密集），导致 $C_{gs} > C_{gd}$。\n\n2.  **饱和区 ($V_{ds} \\ge V_{dsat}$):**\n    当 $V_{ds}$ 达到 $V_{dsat}$ 时，沟道在漏极处夹断。对于漏极电压 $V_{ds} > V_{dsat}$，Meyer模型假设反型沟道的端点固定在夹断条件下。沟道中该点的电压保持在 $V_{dsat}$。多余的电压 $V_{ds} - V_{dsat}$ 降落在反型沟道末端和漏极扩散区之间形成的耗尽空间电荷区上。\n    该模型的关键后果是，漏极端子现在被这个耗尽区与反型沟道电隔离，或“屏蔽”。漏极电压的任何微小变化 $\\Delta V_d$ 都会被这个耗尽区吸收，而不会影响沟道反型部分的电荷分布。\n    电容是衡量电荷随电压变化的量 ($C = \\partial Q / \\partial V$)。由于漏极电压不再调制反型层内的电荷，因此由沟道产生的栅漏电容 $C_{gd}$ 被抑制为零。由于漏极实际上被断开，终止于沟道电荷上的栅极电场线现在都被认为源自源极。因此，在饱和区，Meyer模型规定：\n    $$C_{gd} = 0$$\n    总的栅-沟道电容随后完全归因于栅源电容，近似为 $C_{gs} = \\frac{2}{3} W L C_{ox}$，其中 $W$ 是沟道宽度。\n\n因此，Meyer模型的分段划分是沟道夹断现象的直接物理结果。电压 $V_{dsat} = V_{gs} - V_{th}$ 作为临界边界，在此处漏极和反型层之间的物理连接被切断，导致栅漏沟道电容的突变性抑制。",
            "answer": "$$\\boxed{V_{gs} - V_{th}}$$"
        },
        {
            "introduction": "在掌握了Meyer模型的基本分段结构后，下一步是批判性地审视其局限性。任何一个精确的电容模型都必须满足电荷守恒的基本物理要求，然而，正如本练习所揭示的，经典的Meyer模型在其简单实现中恰恰违反了这一原则。在这个实践中，您将为一个特定的非保守模型实现计算其电荷守恒误差度量，从而量化其理论缺陷。这项计算清晰地揭示了为何现代电路仿真需要更复杂的、保证电荷守恒的紧凑模型。",
            "id": "3780249",
            "problem": "考虑一个由准静态 Meyer 电容模型建模的金属氧化物半导体场效应晶体管 (MOSFET)。设该器件的四个终端分别为栅极 ($g$)、漏极 ($d$)、源极 ($s$) 和衬底 ($b$)。多端口电容项由终端电荷导数 $C_{ij}=\\partial Q_{i}/\\partial V_{j}$ 定义，对于一个电荷守恒、规范不变的器件，它们对每个终端 $i$ 都满足恒等式 $\\sum_{j} C_{ij}=0$。已知 Meyer 模型在某些实现下是非电荷守恒的。为了量化特定偏置点下的守恒误差，为每个终端 $i$ 定义守恒误差度量为\n$$\\Delta_{i}=\\sum_{j\\in\\{g,d,s,b\\}} C_{ij}.$$\n\n给定一个 $n$ 沟道 MOSFET，其宽度 $W=10\\,\\mu\\mathrm{m}$，长度 $L=0.18\\,\\mu\\mathrm{m}$，栅氧化层厚度 $t_{ox}=3\\,\\mathrm{nm}$，二氧化硅相对介电常数 $\\varepsilon_{ox,r}=3.9$。设真空介电常数为 $\\varepsilon_{0}=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。栅极与源极和漏极的交叠长度相等，为 $L_{ov,s}=L_{ov,d}=0.03\\,\\mu\\mathrm{m}$。考虑偏置点 $V_{GS}=1.2\\,\\mathrm{V}$、$V_{TH}=0.4\\,\\mathrm{V}$、$V_{DS}=0.8\\,\\mathrm{V}$ 和 $V_{BS}=0\\,\\mathrm{V}$，此时器件处于强反型状态且位于饱和区边缘 ($V_{DS}\\ge V_{GS}-V_{TH}$)。\n\n使用以下与强反型饱和区的经典 Meyer 模型和非守恒实现一致的、有物理动机的赋值：\n- 单位面积的栅氧化层电容为 $C_{ox}=\\varepsilon_{ox}/t_{ox}$，其中 $\\varepsilon_{ox}=\\varepsilon_{ox,r}\\,\\varepsilon_{0}$。\n- 强反型饱和区的沟道（面积）电容被划分为 $C_{gs,\\mathrm{ch}}=\\frac{2}{3}\\,C_{ox}\\,W\\,L$，$C_{gd,\\mathrm{ch}}=0$，$C_{gb,\\mathrm{ch}}=0$。\n- 交叠电容为 $C_{gs,\\mathrm{ov}}=C_{ox}\\,W\\,L_{ov,s}$ 和 $C_{gd,\\mathrm{ov}}=C_{ox}\\,W\\,L_{ov,d}$，而 $C_{gb,\\mathrm{ov}}=0$。\n- 总的栅极到其他终端的非对角电容为 $C_{gs}=C_{gs,\\mathrm{ch}}+C_{gs,\\mathrm{ov}}$、$C_{gd}=C_{gd,\\mathrm{ch}}+C_{gd,\\mathrm{ov}}$ 和 $C_{gb}=C_{gb,\\mathrm{ch}}+C_{gb,\\mathrm{ov}}$。\n- 相对于栅极的小信号交叉耦合的对称性被强加为 $C_{sg}=C_{gs}$、$C_{dg}=C_{gd}$、$C_{bg}=C_{gb}$，并且在此简化赋值中，所有其他不涉及栅极的非对角项均取为零（例如，$C_{sd}=C_{ds}=C_{sb}=C_{bs}=C_{db}=C_{bd}=0$）。\n- 在此非守恒赋值中，所有对角线项均设置为零：$C_{gg}=C_{dd}=C_{ss}=C_{bb}=0$。\n\n计算此偏置点下的守恒误差度量 $\\Delta_{g}$、$\\Delta_{d}$、$\\Delta_{s}$ 和 $\\Delta_{b}$。将每个 $\\Delta_{i}$ 以飞法 (fF) 表示，并将您的答案四舍五入到四位有效数字。您的最终答案必须以单行矩阵的形式给出，按顺序包含 $\\Delta_{g}$、$\\Delta_{d}$、$\\Delta_{s}$ 和 $\\Delta_{b}$。",
            "solution": "本题旨在量化一个非电荷守恒的Meyer模型实现中的守恒误差。我们将按照给定的规则和参数，逐步计算电容矩阵的元素，并最终求出每个终端的守恒误差度量 $\\Delta_i$。\n\n**步骤 1：计算基本参数**\n\n首先，计算单位面积的栅氧化层电容 $C_{ox}$。\n二氧化硅的介电常数 $\\varepsilon_{ox}$ 为：\n$$ \\varepsilon_{ox} = \\varepsilon_{ox,r}\\varepsilon_{0} = 3.9 \\times 8.854187817 \\times 10^{-12}\\,\\mathrm{F/m} \\approx 3.453133 \\times 10^{-11}\\,\\mathrm{F/m} $$\n栅氧化层厚度 $t_{ox}=3\\,\\mathrm{nm}=3\\times 10^{-9}\\,\\mathrm{m}$，因此：\n$$ C_{ox} = \\frac{\\varepsilon_{ox}}{t_{ox}} = \\frac{3.453133 \\times 10^{-11}\\,\\mathrm{F/m}}{3\\times 10^{-9}\\,\\mathrm{m}} \\approx 1.151044 \\times 10^{-2}\\,\\mathrm{F/m^2} $$\n\n**步骤 2：计算电容分量**\n\n使用器件尺寸 $W=10\\,\\mu\\mathrm{m}$、$L=0.18\\,\\mu\\mathrm{m}$ 和 $L_{ov,s}=L_{ov,d}=0.03\\,\\mu\\mathrm{m}$。\n\n- **沟道电容 (饱和区)**：\n  $$ C_{gs,\\mathrm{ch}} = \\frac{2}{3}C_{ox}WL = \\frac{2}{3} \\times (1.151044 \\times 10^{-2}) \\times (10 \\times 10^{-6}) \\times (0.18 \\times 10^{-6}) \\approx 1.381253 \\times 10^{-14}\\,\\mathrm{F} $$\n  根据模型定义，$C_{gd,\\mathrm{ch}}=0$ 和 $C_{gb,\\mathrm{ch}}=0$。\n\n- **交叠电容**：\n  $$ C_{gs,\\mathrm{ov}} = C_{ox}WL_{ov,s} = (1.151044 \\times 10^{-2}) \\times (10 \\times 10^{-6}) \\times (0.03 \\times 10^{-6}) \\approx 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\n  $$ C_{gd,\\mathrm{ov}} = C_{ox}WL_{ov,d} = C_{gs,\\mathrm{ov}} \\approx 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\n  $C_{gb,\\mathrm{ov}}=0$。\n\n**步骤 3：计算总的非对角栅电容**\n\n$$ C_{gs} = C_{gs,\\mathrm{ch}} + C_{gs,\\mathrm{ov}} \\approx 1.381253 \\times 10^{-14}\\,\\mathrm{F} + 3.453133 \\times 10^{-15}\\,\\mathrm{F} = 1.726566 \\times 10^{-14}\\,\\mathrm{F} $$\n$$ C_{gd} = C_{gd,\\mathrm{ch}} + C_{gd,\\mathrm{ov}} = 0 + 3.453133 \\times 10^{-15}\\,\\mathrm{F} = 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\n$$ C_{gb} = C_{gb,\\mathrm{ch}} + C_{gb,\\mathrm{ov}} = 0 $$\n\n**步骤 4：计算守恒误差度量 $\\Delta_i$**\n\n根据模型规则，对角电容 $C_{ii}=0$，交叉电容 $C_{sg}=C_{gs}, C_{dg}=C_{gd}, C_{bg}=C_{gb}$，其他所有非栅极交叉电容为0。\n$\\Delta_i = \\sum_j C_{ij}$ 是电容矩阵第 $i$ 行的和。\n\n- **栅极端 ($i=g$)**：\n  $$ \\Delta_{g} = C_{gg} + C_{gd} + C_{gs} + C_{gb} = 0 + C_{gd} + C_{gs} + 0 \\approx 3.453133 \\times 10^{-15} + 1.726566 \\times 10^{-14} \\approx 2.07188 \\times 10^{-14}\\,\\mathrm{F} $$\n  $\\Delta_g \\approx 20.7188\\,\\mathrm{fF}$。\n\n- **漏极端 ($i=d$)**：\n  $$ \\Delta_{d} = C_{dg} + C_{dd} + C_{ds} + C_{db} = C_{gd} + 0 + 0 + 0 \\approx 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\n  $\\Delta_d \\approx 3.453133\\,\\mathrm{fF}$。\n\n- **源极端 ($i=s$)**：\n  $$ \\Delta_{s} = C_{sg} + C_{sd} + C_{ss} + C_{sb} = C_{gs} + 0 + 0 + 0 \\approx 1.726566 \\times 10^{-14}\\,\\mathrm{F} $$\n  $\\Delta_s \\approx 17.26566\\,\\mathrm{fF}$。\n\n- **衬底端 ($i=b$)**：\n  $$ \\Delta_{b} = C_{bg} + C_{bd} + C_{bs} + C_{bb} = 0 + 0 + 0 + 0 = 0\\,\\mathrm{F} $$\n\n**步骤 5：格式化最终答案**\n\n将结果以飞法（fF）为单位，并四舍五入到四位有效数字：\n- $\\Delta_g \\approx 20.72\\,\\mathrm{fF}$\n- $\\Delta_d \\approx 3.453\\,\\mathrm{fF}$\n- $\\Delta_s \\approx 17.27\\,\\mathrm{fF}$\n- $\\Delta_b = 0\\,\\mathrm{fF}$\n\n最终答案以行矩阵形式给出。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 20.72  3.453  17.27  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "延续模型局限性这一主题，本实践将关注一个对电路仿真器至关重要的实际问题：模型的不连续性。Meyer模型在区域边界处的电容值突变，会严重影响仿真器的数值收敛性。在这个编程练习中，您将亲手实现一个原始的分段Meyer模型和一个经过平滑处理的改进模型。通过对比两者在边界处的行为，您将直观地理解平滑技术如何消除电容跳变，从而构建出对数值计算更友好的鲁棒模型，这正是从理论物理到实用紧凑模型开发的关键一步。",
            "id": "3780329",
            "problem": "您的任务是设计一个程序，用于分析和缓解基于 Meyer 电容模型的金属-氧化物-半导体场效应晶体管 (MOSFET) 准静态电容模型中的数值收敛问题。挑战主要集中在阈值电压附近和饱和边界附近的角点偏置，在这些地方，分段定义的电容中的突变会导致不连续性，这会降低电路模拟器中类 Newton 求解器的鲁棒性。该程序必须计算并比较非平滑（突变）模型和平滑模型（强制过渡连续）在这些角点处的电容跳变幅度。\n\n从基本原理出发：\n- 端点间的准静态小信号电容定义为端点电荷对端点电压的偏导数，即 $C_{ij} = -\\partial Q_i/\\partial V_j$，其中 $Q_i$ 是与端点 $i$ 相关的电荷，$V_j$ 是端点 $j$ 的电压。\n- 对于 Meyer 近似中的 MOS 栅电容器，单位面积氧化层电容 $C_{\\mathrm{ox}}$ 被视为栅叠层中主要的线性电介质贡献。面积因子为 $A_{\\mathrm{geom}} = W L$，其中 $W$ 是沟道宽度，$L$ 是沟道长度，因此几何氧化层电容为 $C_{\\mathrm{geom}} = C_{\\mathrm{ox}} W L$。\n- 在标准的 Meyer 划分中，栅电容根据工作区域（累积/耗尽区与反型区，以及线性区与饱和区）分配给栅-源、栅-漏和栅-衬底。突变的区域边界出现在阈值电压 $V_{\\mathrm{th}}$（强反型开始）附近和饱和边界 $V_{\\mathrm{dsat}}$ 附近，对于长沟道器件，后者约等于 $V_{\\mathrm{dsat}} \\approx V_{\\mathrm{gs}} - V_{\\mathrm{th}}$。\n\n您的任务：\n1. 实现一个使用标准区域划分的非平滑、分段 Meyer 电容模型。该模型必须在非反型区分配栅-衬底电容，并在反型区中分配栅-源和栅-漏电容，且在饱和边界处有变化。使用 $V_{\\mathrm{dsat}} = \\max(V_{\\mathrm{gs}} - V_{\\mathrm{th}}, 0)$ 以确保在反型前区域的物理真实性。\n2. 实现一个平滑的 Meyer 电容模型，该模型强制电容在 $V_{\\mathrm{th}}$ 和 $V_{\\mathrm{dsat}}$ 附近的边界上连续，而不改变远离过渡区的渐近值。该过渡必须相对于 $V_{\\mathrm{gs}}$ 和 $V_{\\mathrm{ds}}$ 都是连续可微的，并且必须在远离边界时渐近地接近非平滑模型的值。您必须选择一种物理上合理的平滑策略，该策略基于由偏置宽度 $w_{\\mathrm{th}}$（用于 $V_{\\mathrm{th}}$）和 $w_{\\mathrm{sat}}$（用于 $V_{\\mathrm{dsat}}$）定义的连续过渡函数，这两个宽度都以伏特为单位，决定了过渡的平缓程度。\n3. 通过计算感兴趣边界周围小对称偏置扰动上的跳变幅度，来量化突变的严重性（已知这会影响求解器收敛）。跳变幅度定义为相应偏置在边界上下扰动一个小量 $\\Delta V$ 时电容值的绝对差。\n\n物理单位：\n- 电压必须以伏特（$\\mathrm{V}$）为单位处理。\n- 电容必须以法拉（$\\mathrm{F}$）为单位报告。\n- 最终结果中的所有输出值必须是法拉单位的浮点数。\n\n所有测试的器件和模型参数：\n- 单位面积氧化层电容：$C_{\\mathrm{ox}} = 1.15 \\times 10^{-2}\\,\\mathrm{F/m^2}$。\n- 沟道宽度：$W = 10 \\times 10^{-6}\\,\\mathrm{m}$。\n- 沟道长度：$L = 1 \\times 10^{-6}\\,\\mathrm{m}$。\n- 阈值电压：$V_{\\mathrm{th}} = 0.6\\,\\mathrm{V}$。\n\n用于边界探测的偏置增量：\n- 在每个测试中，围绕边界使用对称增量 $\\Delta V = 1.0 \\times 10^{-4}\\,\\mathrm{V}$。\n\n为每个边界定义跳变计算：\n- 在 $V_{\\mathrm{gs}} \\approx V_{\\mathrm{th}}$ 的阈值边界附近，固定 $V_{\\mathrm{ds}}$：\n  - 在固定的 $V_{\\mathrm{ds}} = 0.05\\,\\mathrm{V}$ 条件下，计算栅-衬底电容 $C_{\\mathrm{gb}}$ 在 $V_{\\mathrm{gs}} = V_{\\mathrm{th}} - \\Delta V$ 和 $V_{\\mathrm{gs}} = V_{\\mathrm{th}} + \\Delta V$ 之间的跳变幅度。\n- 在反型区中固定 $V_{\\mathrm{gs}}$，在 $V_{\\mathrm{ds}} \\approx V_{\\mathrm{dsat}}$ 的饱和边界附近：\n  - 选择 $V_{\\mathrm{gs}} = V_{\\mathrm{th}} + 0.2\\,\\mathrm{V}$，因此 $V_{\\mathrm{dsat}} = 0.2\\,\\mathrm{V}$，并计算栅-漏电容 $C_{\\mathrm{gd}}$ 在 $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}} - \\Delta V$ 和 $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}} + \\Delta V$ 之间的跳变幅度。\n- 组合角点情况：\n  - 当同时接近两个边界时，计算 $C_{\\mathrm{gb}}$ 和 $C_{\\mathrm{gd}}$ 的跳变幅度，此时 $V_{\\mathrm{gs}}$ 和 $V_{\\mathrm{ds}}$ 在其各自的角点周围扰动：\n    - 使用 $V_{\\mathrm{gs}}^{(-)} = V_{\\mathrm{th}} - \\Delta V$ 和 $V_{\\mathrm{ds}}^{(-)} = \\max(V_{\\mathrm{dsat}}^{(-)} - \\Delta V, 0)$，其中 $V_{\\mathrm{dsat}}^{(-)} = \\max(V_{\\mathrm{gs}}^{(-)} - V_{\\mathrm{th}}, 0)$。\n    - 使用 $V_{\\mathrm{gs}}^{(+)} = V_{\\mathrm{th}} + \\Delta V$ 和 $V_{\\mathrm{ds}}^{(+)} = V_{\\mathrm{dsat}}^{(+)} + \\Delta V$，其中 $V_{\\mathrm{dsat}}^{(+)} = \\max(V_{\\mathrm{gs}}^{(+)} - V_{\\mathrm{th}}, 0)$。\n  - 报告每个模型中 $C_{\\mathrm{gb}}$ 和 $C_{\\mathrm{gd}}$ 两个跳变幅度中的最大值。\n\n测试套件：\n- 测试 1（理想平滑路径）：$w_{\\mathrm{th}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$，$w_{\\mathrm{sat}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$。\n- 测试 2（相同平滑宽度，关注 $V_{\\mathrm{dsat}}$ 边界）：$w_{\\mathrm{th}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$，$w_{\\mathrm{sat}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$。\n- 测试 3（极度尖锐过渡的边缘情况）：$w_{\\mathrm{th}} = 1.0 \\times 10^{-6}\\,\\mathrm{V}$，$w_{\\mathrm{sat}} = 1.0 \\times 10^{-6}\\,\\mathrm{V}$。\n\n对于每个测试，计算并返回以下浮点数（均以法拉为单位）：\n- 测试 1：$[J_{\\mathrm{th}}^{\\mathrm{unsm}}, J_{\\mathrm{th}}^{\\mathrm{sm}}]$，其中 $J_{\\mathrm{th}}$ 是在 $V_{\\mathrm{gs}} \\approx V_{\\mathrm{th}}$ 时 $C_{\\mathrm{gb}}$ 的跳变幅度。\n- 测试 2：$[J_{\\mathrm{sat}}^{\\mathrm{unsm}}, J_{\\mathrm{sat}}^{\\mathrm{sm}}]$，其中 $J_{\\mathrm{sat}}$ 是在 $V_{\\mathrm{ds}} \\approx V_{\\mathrm{dsat}}$ 时 $C_{\\mathrm{gd}}$ 的跳变幅度。\n- 测试 3：$[J_{\\mathrm{combo}}^{\\mathrm{unsm}}, J_{\\mathrm{combo}}^{\\mathrm{sm}}]$，其中 $J_{\\mathrm{combo}}$ 是当 $V_{\\mathrm{gs}}$ 和 $V_{\\mathrm{ds}}$ 同时接近其角点时，两个跳变幅度（$C_{\\mathrm{gb}}$ 和 $C_{\\mathrm{gd}}$）中的最大值。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序如下：\n  - $[J_{\\mathrm{th}}^{\\mathrm{unsm}}, J_{\\mathrm{th}}^{\\mathrm{sm}}, J_{\\mathrm{sat}}^{\\mathrm{unsm}}, J_{\\mathrm{sat}}^{\\mathrm{sm}}, J_{\\mathrm{combo}}^{\\mathrm{unsm}}, J_{\\mathrm{combo}}^{\\mathrm{sm}}]$。\n- 所有值必须以法拉（$\\mathrm{F}$）为单位，作为浮点数报告。",
            "solution": "该问题要求实现和比较两种金属-氧化物-半导体场效应晶体管（MOSFET）栅电容模型：一个标准的非平滑分段 Meyer 模型和一个提出的平滑变体。目标是量化在关键偏置边界处电容不连续性的减少程度，这是影响电路模拟器收敛性和鲁棒性的关键因素。\n\n首先，我们定义基本物理参数和几何氧化层电容，后者是 Meyer 模型的基础。器件参数给定如下：单位面积氧化层电容 $C_{\\mathrm{ox}} = 1.15 \\times 10^{-2}\\,\\mathrm{F/m^2}$，沟道宽度 $W = 10 \\times 10^{-6}\\,\\mathrm{m}$，以及沟道长度 $L = 1 \\times 10^{-6}\\,\\mathrm{m}$。因此，总几何氧化层电容 $C_{\\mathrm{geom}}$ 为：\n$$\nC_{\\mathrm{geom}} = C_{\\mathrm{ox}} W L = (1.15 \\times 10^{-2}\\,\\mathrm{F/m^2}) \\times (10 \\times 10^{-6}\\,\\mathrm{m}) \\times (1 \\times 10^{-6}\\,\\mathrm{m}) = 1.15 \\times 10^{-13}\\,\\mathrm{F}\n$$\n另一个关键参数是阈值电压，$V_{\\mathrm{th}} = 0.6\\,\\mathrm{V}$。\n\n**非平滑 Meyer 电容模型**\n\n非平滑模型是端点电压 $V_{\\mathrm{gs}}$（栅-源电压）和 $V_{\\mathrm{ds}}$（漏-源电压）的分段函数。它根据 MOSFET 的工作区域来定义。\n饱和漏-源电压 $V_{\\mathrm{dsat}}$ 定义为 $V_{\\mathrm{dsat}} = \\max(V_{\\mathrm{gs}} - V_{\\mathrm{th}}, 0)$。\n\n1.  **亚阈值/截止区 ($V_{\\mathrm{gs}} \\le V_{\\mathrm{th}}$)**：反型沟道未形成。栅电容完全指向体电极（衬底）。\n    $$\n    C_{\\mathrm{gb}} = C_{\\mathrm{geom}}, \\quad C_{\\mathrm{gs}} = 0, \\quad C_{\\mathrm{gd}} = 0\n    $$\n\n2.  **反型区 ($V_{\\mathrm{gs}} > V_{\\mathrm{th}}$)**：反型沟道形成，将体电极与栅极屏蔽开。栅-衬底电容变得可以忽略不计，即 $C_{\\mathrm{gb}} = 0$。总栅电容 $C_{\\mathrm{geom}}$ 在源端和漏端之间分配。该区域进一步分为：\n    a.  **线性区（或三极管区） ($V_{\\mathrm{ds}}  V_{\\mathrm{dsat}}$)**：沟道完全从源端延伸到漏端。一种常见的简化划分方法是将一半电容分配给源端，一半分配给漏端。\n        $$\n        C_{\\mathrm{gs}} = \\frac{1}{2} C_{\\mathrm{geom}}, \\quad C_{\\mathrm{gd}} = \\frac{1}{2} C_{\\mathrm{geom}}\n        $$\n    b.  **饱和区 ($V_{\\mathrm{ds}} \\ge V_{\\mathrm{dsat}}$)**：沟道在漏极附近被“夹断”。栅极对源端的影响更强。标准划分是：\n        $$\n        C_{\\mathrm{gs}} = \\frac{2}{3} C_{\\mathrm{geom}}, \\quad C_{\\mathrm{gd}} = 0\n        $$\n该模型表现出突变。例如，在 $V_{\\mathrm{gs}} = V_{\\mathrm{th}}$ 时，$C_{\\mathrm{gb}}$ 从 $C_{\\mathrm{geom}}$ 降至 $0$。在 $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}}$ 时，$C_{\\mathrm{gd}}$ 从 $\\frac{1}{2}C_{\\mathrm{geom}}$ 降至 $0$，而 $C_{\\mathrm{gs}}$ 从 $\\frac{1}{2} C_{\\mathrm{geom}}$ 跳变至 $\\frac{2}{3} C_{\\mathrm{geom}}$。\n\n**平滑 Meyer 电容模型**\n\n为了创建一个连续可微的模型，我们使用平滑过渡函数。一个合适的选择是基于双曲正切函数的函数，它在 $0$ 和 $1$ 之间提供了一个平滑、单调的过渡：\n$$\nS(x, w) = \\frac{1}{2} \\left(1 + \\tanh\\left(\\frac{x}{w}\\right)\\right)\n$$\n这里，$x$ 是控制变量（一个电压差），$w$ 是以伏特为单位的过渡宽度。\n\n我们根据关键的偏置条件定义两个平滑因子：\n1.  一个“反型因子” $f_{\\mathrm{inv}}$，用于管理从亚阈值到反型的过渡，由 $V_{\\mathrm{gs}}$相对于 $V_{\\mathrm{th}}$ 控制。设 $V_{\\mathrm{over}} = V_{\\mathrm{gs}} - V_{\\mathrm{th}}$。\n    $$\n    f_{\\mathrm{inv}} = S(V_{\\mathrm{over}}, w_{\\mathrm{th}}) = \\frac{1}{2} \\left(1 + \\tanh\\left(\\frac{V_{\\mathrm{gs}} - V_{\\mathrm{th}}}{w_{\\mathrm{th}}}\\right)\\right)\n    $$\n2.  一个“线性因子” $f_{\\mathrm{lin}}$，用于管理从线性区到饱和区的过渡，由 $V_{\\mathrm{ds}}$ 相对于 $V_{\\mathrm{over}}$ 控制。\n    $$\n    f_{\\mathrm{lin}} = S(V_{\\mathrm{over}} - V_{\\mathrm{ds}}, w_{\\mathrm{sat}}) = \\frac{1}{2} \\left(1 + \\tanh\\left(\\frac{V_{\\mathrm{gs}} - V_{\\mathrm{th}} - V_{\\mathrm{ds}}}{w_{\\mathrm{sat}}}\\right)\\right)\n    $$\n利用这些因子，我们可以通过在分段模型的渐近值之间进行平滑插值来构建平滑电容：\n-   **栅-衬底电容 ($C_{\\mathrm{gb}}$)**：在亚阈值区（$f_{\\mathrm{inv}} \\to 0$）应为 $C_{\\mathrm{geom}}$，在反型区（$f_{\\mathrm{inv}} \\to 1$）应为 $0$。\n    $$\n    C_{\\mathrm{gb}}^{\\mathrm{sm}} = (1 - f_{\\mathrm{inv}}) C_{\\mathrm{geom}}\n    $$\n-   **栅-漏电容 ($C_{\\mathrm{gd}}$)**：只应存在于反型区，在线性区（$f_{\\mathrm{lin}} \\to 1$）为 $\\frac{1}{2}C_{\\mathrm{geom}}$，在饱和区（$f_{\\mathrm{lin}} \\to 0$）为 $0$。\n    $$\n    C_{\\mathrm{gd}}^{\\mathrm{sm}} = f_{\\mathrm{inv}} \\times f_{\\mathrm{lin}} \\times \\frac{1}{2} C_{\\mathrm{geom}}\n    $$\n-   **栅-源电容 ($C_{\\mathrm{gs}}$)**：也只存在于反型区。它在线性区的 $\\frac{1}{2}C_{\\mathrm{geom}}$ 和饱和区的 $\\frac{2}{3}C_{\\mathrm{geom}}$ 之间插值。\n    $$\n    C_{\\mathrm{gs}}^{\\mathrm{sm}} = f_{\\mathrm{inv}} \\left( f_{\\mathrm{lin}} \\frac{1}{2}C_{\\mathrm{geom}} + (1 - f_{\\mathrm{lin}}) \\frac{2}{3}C_{\\mathrm{geom}} \\right) = f_{\\mathrm{inv}} C_{\\mathrm{geom}} \\left( \\frac{2}{3} - \\frac{1}{6} f_{\\mathrm{lin}} \\right)\n    $$\n该公式相对于 $V_{\\mathrm{gs}}$ 和 $V_{\\mathrm{ds}}$ 是连续可微的，因为 `tanh` 是 $C^\\infty$（无限次可微）的，并且其参数是偏置的线性函数。\n\n**跳变幅度计算**\n\n程序计算跳变幅度 $| \\Delta C | = | C(V_{\\text{bias,2}}) - C(V_{\\text{bias,1}}) |$，针对特定电容跨越由小扰动 $\\Delta V = 1.0 \\times 10^{-4}\\,\\mathrm{V}$ 定义的边界。\n\n-   **测试 1（阈值边界）**：在固定的 $V_{\\mathrm{ds}} = 0.05\\,\\mathrm{V}$ 条件下，计算 $C_{\\mathrm{gb}}$ 在 $V_{\\mathrm{gs}} = V_{\\mathrm{th}} \\mp \\Delta V$ 之间的跳变。对于非平滑模型，此跳变恰好为 $C_{\\mathrm{geom}}$。\n\n-   **测试 2（饱和边界）**：当 $V_{\\mathrm{gs}} = V_{\\mathrm{th}} + 0.2\\,\\mathrm{V} = 0.8\\,\\mathrm{V}$ 时，我们有 $V_{\\mathrm{dsat}} = 0.2\\,\\mathrm{V}$。计算 $C_{\\mathrm{gd}}$ 在 $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}} \\mp \\Delta V$ 之间的跳变。对于非平滑模型，此跳变为 $\\frac{1}{2}C_{\\mathrm{geom}}$。\n\n-   **测试 3（组合角点）**：我们检查 $V_{\\mathrm{gs}} \\approx V_{\\mathrm{th}}$ 和 $V_{\\mathrm{ds}} \\approx V_{\\mathrm{dsat}}$ 的角点。偏置点为 $V^{(-)} = (V_{\\mathrm{gs}}^{(-)}, V_{\\mathrm{ds}}^{(-)}) = (V_{\\mathrm{th}}-\\Delta V, 0)$ 和 $V^{(+)} = (V_{\\mathrm{gs}}^{(+)}, V_{\\mathrm{ds}}^{(+)}) = (V_{\\mathrm{th}}+\\Delta V, 2\\Delta V)$。我们计算 $C_{\\mathrm{gb}}$ 和 $C_{\\mathrm{gd}}$ 的跳变，并报告两者中的最大值。对于非平滑模型，该转换是从亚阈值区到饱和区，因此 $C_{\\mathrm{gb}}$ 的跳变是 $C_{\\mathrm{geom}}$，而 $C_{\\mathrm{gd}}$ 的跳变是 $0$。最大跳变是 $C_{\\mathrm{geom}}$。\n\n实现部分将根据指定的测试条件计算非平滑模型和平滑模型的这些值。预计平滑模型将显示出显著更小的跳变，从而证明其更优越的仿真数值特性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares capacitance jump magnitudes for unsmoothed and\n    smoothed Meyer MOSFET models across critical bias boundaries.\n    \"\"\"\n\n    # --- Device and Model Parameters ---\n    C_ox = 1.15e-2  # F/m^2\n    W = 10.0e-6      # m\n    L = 1.0e-6       # m\n    V_th = 0.6       # V\n    delta_V = 1.0e-4 # V\n\n    # Geometric oxide capacitance\n    C_geom = C_ox * W * L\n\n    # --- Model Implementations ---\n\n    def capacitances_unsmoothed(V_gs, V_ds):\n        \"\"\"\n        Calculates capacitances using the unsmoothed, piecewise Meyer model.\n        Returns: (C_gs, C_gd, C_gb)\n        \"\"\"\n        V_dsat = max(V_gs - V_th, 0.0)\n\n        if V_gs = V_th:\n            # Subthreshold/Cutoff region\n            C_gs, C_gd, C_gb = 0.0, 0.0, C_geom\n        else:\n            # Inversion region\n            C_gb = 0.0\n            if V_ds  V_dsat:\n                # Linear/Triode region\n                C_gs = 0.5 * C_geom\n                C_gd = 0.5 * C_geom\n            else:\n                # Saturation region\n                C_gs = (2.0 / 3.0) * C_geom\n                C_gd = 0.0\n        return C_gs, C_gd, C_gb\n\n    def capacitances_smoothed(V_gs, V_ds, w_th, w_sat):\n        \"\"\"\n        Calculates capacitances using the continuously differentiable smoothed model.\n        Returns: (C_gs, C_gd, C_gb)\n        \"\"\"\n        \n        def smooth_step(x, w):\n            # A robust implementation to avoid overflow with large x/w\n            arg = x / w\n            if arg  -100:\n                return 0.0\n            if arg > 100:\n                return 1.0\n            return 0.5 * (1.0 + np.tanh(arg))\n\n        V_over = V_gs - V_th\n\n        # Inversion factor\n        f_inv = smooth_step(V_over, w_th)\n        \n        # Linear factor\n        f_lin = smooth_step(V_over - V_ds, w_sat)\n\n        # Smoothed capacitances\n        C_gb_sm = (1.0 - f_inv) * C_geom\n        C_gd_sm = f_inv * f_lin * 0.5 * C_geom\n        C_gs_sm = f_inv * C_geom * (2.0/3.0 - (1.0/6.0) * f_lin)\n        \n        return C_gs_sm, C_gd_sm, C_gb_sm\n\n    results = []\n\n    # --- Test 1: Jump at V_th boundary ---\n    w_th_t1, w_sat_t1 = 5.0e-3, 5.0e-3\n    V_ds_fixed = 0.05\n    V_gs1 = V_th - delta_V\n    V_gs2 = V_th + delta_V\n\n    # Unsmoothed\n    _, _, C_gb1_unsm = capacitances_unsmoothed(V_gs1, V_ds_fixed)\n    _, _, C_gb2_unsm = capacitances_unsmoothed(V_gs2, V_ds_fixed)\n    J_th_unsm = abs(C_gb2_unsm - C_gb1_unsm)\n    results.append(J_th_unsm)\n\n    # Smoothed\n    _, _, C_gb1_sm = capacitances_smoothed(V_gs1, V_ds_fixed, w_th_t1, w_sat_t1)\n    _, _, C_gb2_sm = capacitances_smoothed(V_gs2, V_ds_fixed, w_th_t1, w_sat_t1)\n    J_th_sm = abs(C_gb2_sm - C_gb1_sm)\n    results.append(J_th_sm)\n\n    # --- Test 2: Jump at V_dsat boundary ---\n    w_th_t2, w_sat_t2 = 5.0e-3, 5.0e-3\n    V_gs_fixed = V_th + 0.2\n    V_dsat_fixed = V_gs_fixed - V_th\n    V_ds1 = V_dsat_fixed - delta_V\n    V_ds2 = V_dsat_fixed + delta_V\n\n    # Unsmoothed\n    _, C_gd1_unsm, _ = capacitances_unsmoothed(V_gs_fixed, V_ds1)\n    _, C_gd2_unsm, _ = capacitances_unsmoothed(V_gs_fixed, V_ds2)\n    J_sat_unsm = abs(C_gd2_unsm - C_gd1_unsm)\n    results.append(J_sat_unsm)\n\n    # Smoothed\n    _, C_gd1_sm, _ = capacitances_smoothed(V_gs_fixed, V_ds1, w_th_t2, w_sat_t2)\n    _, C_gd2_sm, _ = capacitances_smoothed(V_gs_fixed, V_ds2, w_th_t2, w_sat_t2)\n    J_sat_sm = abs(C_gd2_sm - C_gd1_sm)\n    results.append(J_sat_sm)\n\n    # --- Test 3: Jump at combined corner ---\n    w_th_t3, w_sat_t3 = 1.0e-6, 1.0e-6\n    # Bias point (-)\n    V_gs_neg = V_th - delta_V\n    V_dsat_neg = max(V_gs_neg - V_th, 0.0)\n    V_ds_neg = max(V_dsat_neg - delta_V, 0.0)\n    # Bias point (+)\n    V_gs_pos = V_th + delta_V\n    V_dsat_pos = max(V_gs_pos - V_th, 0.0)\n    V_ds_pos = V_dsat_pos + delta_V\n\n    # Unsmoothed\n    _, C_gd_neg_unsm, C_gb_neg_unsm = capacitances_unsmoothed(V_gs_neg, V_ds_neg)\n    _, C_gd_pos_unsm, C_gb_pos_unsm = capacitances_unsmoothed(V_gs_pos, V_ds_pos)\n    jump_gb_unsm = abs(C_gb_pos_unsm - C_gb_neg_unsm)\n    jump_gd_unsm = abs(C_gd_pos_unsm - C_gd_neg_unsm)\n    J_combo_unsm = max(jump_gb_unsm, jump_gd_unsm)\n    results.append(J_combo_unsm)\n\n    # Smoothed\n    _, C_gd_neg_sm, C_gb_neg_sm = capacitances_smoothed(V_gs_neg, V_ds_neg, w_th_t3, w_sat_t3)\n    _, C_gd_pos_sm, C_gb_pos_sm = capacitances_smoothed(V_gs_pos, V_ds_pos, w_th_t3, w_sat_t3)\n    jump_gb_sm = abs(C_gb_pos_sm - C_gb_neg_sm)\n    jump_gd_sm = abs(C_gd_pos_sm - C_gd_neg_sm)\n    J_combo_sm = max(jump_gb_sm, jump_gd_sm)\n    results.append(J_combo_sm)\n\n    # --- Final Output ---\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}