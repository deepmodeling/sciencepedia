{
    "hands_on_practices": [
        {
            "introduction": "The Meyer model's elegance lies in its simplicity, dividing MOSFET behavior into distinct operating regions. To truly grasp this model, we must first understand the physical event that defines its most critical boundary: channel pinch-off. This practice guides you through a foundational derivation of the saturation voltage, linking the abstract equations of the model directly to the physical behavior of charge in the transistor channel .",
            "id": "3780303",
            "problem": "Consider a long-channel, quasi-static, strong-inversion Metal–Oxide–Semiconductor Field-Effect Transistor (MOSFET) operating under the gradual channel approximation. Let the channel run from $x=0$ (source) to $x=L$ (drain), and let the channel potential be $V(x)$ measured relative to the source such that $V(0)=0$ and $V(L)=V_{ds}$. Assume a uniform gate oxide capacitance per unit area $C_{ox}$, a constant threshold voltage $V_{th}$, and neglect velocity saturation and carrier diffusion in the inversion layer so that the drift-diffusion description with a charge-sheet holds. Under strong inversion, the local inversion sheet charge density per unit area can be expressed in terms of the local channel potential as $Q_{i}(x)$, and the drift current is governed by the electric field $E_{x}(x)=-\\frac{dV}{dx}$ and the local mobile charge.\n\nStarting from these fundamentals, derive the closed-form expression for the drain voltage at the onset of saturation (the drain voltage at which the inversion charge at the drain end of the channel vanishes, i.e., the channel pinches off at $x=L$). Then, using this onset condition, explain how the piecewise partitioning in the Meyer capacitance model separates the gate-to-source and gate-to-drain channel capacitances between the linear and saturation regions, and why the gate-to-drain channel capacitance is suppressed beyond this onset.\n\nProvide your final result as a single symbolic expression for the saturation drain voltage in terms of $V_{gs}$ and $V_{th}$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the drain voltage at the onset of saturation ($V_{dsat}$) for a long-channel MOSFET and an explanation of its role in the partitioning of capacitances in the Meyer model. The derivation will be based on the provided first principles.\n\nFirst, we derive the expression for the saturation drain voltage, $V_{dsat}$.\nThe problem is set in the context of the gradual channel approximation and the charge-sheet model for a MOSFET in strong inversion. According to this model, the magnitude of the mobile inversion sheet charge density, $|Q_i(x)|$, at any point $x$ along the channel (from source at $x=0$ to drain at $x=L$) is determined by the local effective gate voltage. The gate-source voltage is $V_{gs}$, the constant threshold voltage is $V_{th}$, and the local channel potential relative to the source is $V(x)$.\n\nThe voltage across the gate oxide at position $x$ is $V_{gs} - V(x)$. The portion of this voltage that creates the mobile inversion charge is the amount that exceeds the threshold voltage, $V_{th}$. Therefore, the magnitude of the inversion sheet charge density at position $x$ is given by:\n$$|Q_i(x)| = C_{ox} [V_{gs} - V_{th} - V(x)]$$\nThis expression is valid for positions $x$ where the channel is inverted, i.e., where $V_{gs} - V_{th} - V(x) \\ge 0$.\n\nThe problem defines the onset of saturation as the condition where the inversion charge at the drain end of the channel vanishes. This phenomenon is known as \"pinch-off\". At the drain end of the channel, the position is $x=L$, and the channel potential is, by definition, the drain-to-source voltage, $V(L) = V_{ds}$.\n\nWe apply the pinch-off condition to the charge density equation at the drain end ($x=L$):\n$$|Q_i(x=L)| = 0$$\nSubstituting the expression for the charge density and the potential at the drain gives:\n$$C_{ox} [V_{gs} - V_{th} - V(L)] = 0$$\nSince the gate oxide capacitance per unit area, $C_{ox}$, is a non-zero physical parameter, the term in the brackets must be zero:\n$$V_{gs} - V_{th} - V(L) = 0$$\nThe specific drain-to-source voltage at which this condition is met is defined as the saturation drain voltage, $V_{dsat}$. By substituting $V(L) = V_{dsat}$ into the equation, we get:\n$$V_{gs} - V_{th} - V_{dsat} = 0$$\nSolving for $V_{dsat}$ gives the closed-form expression for the drain voltage at the onset of saturation:\n$$V_{dsat} = V_{gs} - V_{th}$$\nThis result is valid for $V_{gs} \\ge V_{th}$; otherwise, the channel is not in strong inversion.\n\nNext, we explain how this onset condition dictates the piecewise partitioning of capacitances in the Meyer model. The Meyer model is a quasi-static, piecewise model for the intrinsic gate capacitances ($C_{gs}$ and $C_{gd}$) that depends on the MOSFET's operating region. The boundary between the linear and saturation regions is precisely $V_{ds} = V_{dsat}$.\n\n1.  **Linear (or Triode) Region ($0 \\le V_{ds}  V_{dsat}$):**\n    In this region, $V_{ds}  V_{gs} - V_{th}$. This implies that $V_{gs} - V_{th} - V_{ds}  0$. From the charge density expression, the charge at the drain end, $|Q_i(L)| = C_{ox}[V_{gs} - V_{th} - V_{ds}]$, is greater than zero. This means a continuous inversion layer, acting as a conductor, connects the source and drain terminals.\n    Because this conductive channel spans the entire distance from source to drain, the gate is capacitively coupled to both terminals through the channel. Consequently, both the gate-to-source capacitance ($C_{gs}$) and the gate-to-drain capacitance ($C_{gd}$) are non-zero. In the Meyer model, for $V_{ds}  0$, the charge distribution is asymmetric (denser near the source), resulting in $C_{gs}  C_{gd}$.\n\n2.  **Saturation Region ($V_{ds} \\ge V_{dsat}$):**\n    When $V_{ds}$ reaches $V_{dsat}$, the channel pinches off at the drain. For drain voltages $V_{ds}  V_{dsat}$, the Meyer model assumes that the inversion channel endpoint is fixed at the pinch-off condition. The voltage at this point in the channel remains at $V_{dsat}$. The excess voltage, $V_{ds} - V_{dsat}$, is dropped across a depleted space-charge region that forms between the end of the inversion channel and the drain diffusion region.\n    The critical consequence of this model is that the drain terminal is now electrically isolated, or \"shielded,\" from the inversion channel by this depletion region. Any small variations in the drain voltage, $\\Delta V_d$, are absorbed by this depletion region and do not affect the charge distribution in the inverted portion of the channel.\n    Capacitance is a measure of how charge changes with voltage ($C = \\partial Q / \\partial V$). Since the drain voltage no longer modulates the charge within the inversion layer, the gate-to-drain capacitance arising from the channel, $C_{gd}$, is suppressed to zero. The gate's electrical field lines that terminate on the channel charge are now all considered to originate from the source, as the drain is effectively disconnected. Therefore, in the saturation region, the Meyer model prescribes:\n    $$C_{gd} = 0$$\n    The total gate-to-channel capacitance is then entirely attributed to the gate-to-source capacitance, which is approximated as $C_{gs} = \\frac{2}{3} W L C_{ox}$, where $W$ is the channel width.\n\nThe piecewise partitioning of the Meyer model is thus a direct physical consequence of the channel pinch-off phenomenon. The voltage $V_{dsat} = V_{gs} - V_{th}$ serves as the critical boundary where the physical connection between the drain and the inversion layer is severed, leading to the abrupt suppression of the gate-to-drain channel capacitance.",
            "answer": "$$\\boxed{V_{gs} - V_{th}}$$"
        },
        {
            "introduction": "While the Meyer model provides valuable intuition, its simplified structure leads to a critical inconsistency: it fails to conserve charge, a fundamental physical law. This hands-on calculation makes this theoretical flaw tangible by having you compute a specific 'conservation error metric' for a device . Understanding this limitation is essential for appreciating why more complex, charge-conservative models became necessary for accurate circuit simulation.",
            "id": "3780249",
            "problem": "Consider a Metal–Oxide–Semiconductor Field-Effect Transistor (MOSFET) modeled by the quasi-static Meyer capacitance model. Let the four device terminals be gate ($g$), drain ($d$), source ($s$), and bulk ($b$). The multiport capacitance entries are defined by the terminal charge derivatives $C_{ij}=\\partial Q_{i}/\\partial V_{j}$, and for a charge-conservative, gauge-invariant device they satisfy the identity $\\sum_{j} C_{ij}=0$ for each terminal $i$. The Meyer model is known to be non-charge-conservative under certain implementations. To quantify the conservation error at a specific bias point, define the conservation error metric for each terminal $i$ as\n$$\\Delta_{i}=\\sum_{j\\in\\{g,d,s,b\\}} C_{ij}.$$\n\nYou are given an $n$-channel MOSFET with width $W=10\\,\\mu\\mathrm{m}$, length $L=0.18\\,\\mu\\mathrm{m}$, gate-oxide thickness $t_{ox}=3\\,\\mathrm{nm}$, and silicon dioxide relative permittivity $\\varepsilon_{ox,r}=3.9$. Let the vacuum permittivity be $\\varepsilon_{0}=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$. The gate overlaps the source and drain by equal lengths $L_{ov,s}=L_{ov,d}=0.03\\,\\mu\\mathrm{m}$. Consider the bias point $V_{GS}=1.2\\,\\mathrm{V}$, $V_{TH}=0.4\\,\\mathrm{V}$, $V_{DS}=0.8\\,\\mathrm{V}$, and $V_{BS}=0\\,\\mathrm{V}$, so the device is in strong inversion and at the edge of saturation ($V_{DS}\\ge V_{GS}-V_{TH}$).\n\nUse the following physically motivated assignments consistent with the classic Meyer model in strong inversion saturation and a non-conservative implementation:\n- Gate-oxide capacitance per unit area is $C_{ox}=\\varepsilon_{ox}/t_{ox}$ with $\\varepsilon_{ox}=\\varepsilon_{ox,r}\\,\\varepsilon_{0}$.\n- Channel (area) capacitances in strong inversion saturation are partitioned as $C_{gs,\\mathrm{ch}}=\\frac{2}{3}\\,C_{ox}\\,W\\,L$, $C_{gd,\\mathrm{ch}}=0$, $C_{gb,\\mathrm{ch}}=0$.\n- Overlap capacitances are $C_{gs,\\mathrm{ov}}=C_{ox}\\,W\\,L_{ov,s}$ and $C_{gd,\\mathrm{ov}}=C_{ox}\\,W\\,L_{ov,d}$, while $C_{gb,\\mathrm{ov}}=0$.\n- Total gate-to-terminal off-diagonal capacitances are $C_{gs}=C_{gs,\\mathrm{ch}}+C_{gs,\\mathrm{ov}}$, $C_{gd}=C_{gd,\\mathrm{ch}}+C_{gd,\\mathrm{ov}}$, and $C_{gb}=C_{gb,\\mathrm{ch}}+C_{gb,\\mathrm{ov}}$.\n- Symmetry of small-signal cross-couplings with respect to the gate is imposed as $C_{sg}=C_{gs}$, $C_{dg}=C_{gd}$, $C_{bg}=C_{gb}$, and all other off-diagonal entries that do not involve the gate are taken to be zero in this simplified assignment (for example, $C_{sd}=C_{ds}=C_{sb}=C_{bs}=C_{db}=C_{bd}=0$).\n- All diagonal entries are set to zero in this non-conservative assignment: $C_{gg}=C_{dd}=C_{ss}=C_{bb}=0$.\n\nCompute the conservation error metrics $\\Delta_{g}$, $\\Delta_{d}$, $\\Delta_{s}$, and $\\Delta_{b}$ at this bias point. Express each $\\Delta_{i}$ in femtofarads (fF) and round your answers to four significant figures. Your final answer must be given as a single row matrix containing $\\Delta_{g}$, $\\Delta_{d}$, $\\Delta_{s}$, and $\\Delta_{b}$ in that order.",
            "solution": "The reasoning proceeds by first calculating the necessary constants and intermediate capacitance values based on the provided physical parameters and model definitions. Then, the full capacitance matrix is assembled according to the specified rules for this non-conservative Meyer model implementation. Finally, the conservation error for each terminal is computed by summing the elements of the corresponding row in the capacitance matrix.\n\nFirst, we calculate the gate-oxide capacitance per unit area, $C_{ox}$. The permittivity of silicon dioxide is $\\varepsilon_{ox} = \\varepsilon_{ox,r}\\varepsilon_{0}$.\nGiven $\\varepsilon_{ox,r}=3.9$ and $\\varepsilon_{0}=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$,\n$$ \\varepsilon_{ox} = 3.9 \\times 8.854187817\\times 10^{-12}\\,\\mathrm{F/m} \\approx 3.453133 \\times 10^{-11}\\,\\mathrm{F/m} $$\nWith a gate-oxide thickness of $t_{ox}=3\\,\\mathrm{nm}=3\\times 10^{-9}\\,\\mathrm{m}$,\n$$ C_{ox} = \\frac{\\varepsilon_{ox}}{t_{ox}} = \\frac{3.453133 \\times 10^{-11}\\,\\mathrm{F/m}}{3\\times 10^{-9}\\,\\mathrm{m}} \\approx 1.151044 \\times 10^{-2}\\,\\mathrm{F/m^2} $$\nNext, we calculate the capacitance components using the device dimensions $W=10\\,\\mu\\mathrm{m}=10^{-5}\\,\\mathrm{m}$, $L=0.18\\,\\mu\\mathrm{m}=1.8\\times 10^{-7}\\,\\mathrm{m}$, and $L_{ov,s}=L_{ov,d}=0.03\\,\\mu\\mathrm{m}=3\\times 10^{-8}\\,\\mathrm{m}$.\n\nThe channel capacitance $C_{gs,\\mathrm{ch}}$ in saturation is given by:\n$$ C_{gs,\\mathrm{ch}} = \\frac{2}{3}C_{ox}WL = \\frac{2}{3} \\times (1.151044 \\times 10^{-2}\\,\\mathrm{F/m^2}) \\times (10^{-5}\\,\\mathrm{m}) \\times (1.8\\times 10^{-7}\\,\\mathrm{m}) \\approx 1.381253 \\times 10^{-14}\\,\\mathrm{F} $$\nThe other channel capacitances are given as $C_{gd,\\mathrm{ch}}=0$ and $C_{gb,\\mathrm{ch}}=0$.\n\nThe overlap capacitances are:\n$$ C_{gs,\\mathrm{ov}} = C_{ox}WL_{ov,s} = (1.151044 \\times 10^{-2}\\,\\mathrm{F/m^2}) \\times (10^{-5}\\,\\mathrm{m}) \\times (3\\times 10^{-8}\\,\\mathrm{m}) \\approx 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\n$$ C_{gd,\\mathrm{ov}} = C_{ox}WL_{ov,d} = (1.151044 \\times 10^{-2}\\,\\mathrm{F/m^2}) \\times (10^{-5}\\,\\mathrm{m}) \\times (3\\times 10^{-8}\\,\\mathrm{m}) \\approx 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\nThe gate-bulk overlap capacitance $C_{gb,\\mathrm{ov}}$ is given as $0$.\n\nNow, we assemble the total gate-to-terminal capacitances:\n$$ C_{gs} = C_{gs,\\mathrm{ch}} + C_{gs,\\mathrm{ov}} \\approx 1.381253 \\times 10^{-14}\\,\\mathrm{F} + 3.453133 \\times 10^{-15}\\,\\mathrm{F} = 1.726566 \\times 10^{-14}\\,\\mathrm{F} $$\n$$ C_{gd} = C_{gd,\\mathrm{ch}} + C_{gd,\\mathrm{ov}} = 0 + 3.453133 \\times 10^{-15}\\,\\mathrm{F} = 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\n$$ C_{gb} = C_{gb,\\mathrm{ch}} + C_{gb,\\mathrm{ov}} = 0 + 0 = 0 $$\nThe problem specifies the structure of the full capacitance matrix $C_{ij}$. The diagonal entries are zero: $C_{gg}=C_{dd}=C_{ss}=C_{bb}=0$. The cross-couplings to the gate are symmetric: $C_{sg}=C_{gs}$, $C_{dg}=C_{gd}$, and $C_{bg}=C_{gb}$. All other off-diagonal entries are zero.\nThe capacitance matrix is:\n$$ C = \\begin{pmatrix} C_{gg}  C_{gd}  C_{gs}  C_{gb} \\\\ C_{dg}  C_{dd}  C_{ds}  C_{db} \\\\ C_{sg}  C_{sd}  C_{ss}  C_{sb} \\\\ C_{bg}  C_{bd}  C_{bs}  C_{bb} \\end{pmatrix} = \\begin{pmatrix} 0  C_{gd}  C_{gs}  0 \\\\ C_{gd}  0  0  0 \\\\ C_{gs}  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\nThe conservation error metric $\\Delta_i$ for each terminal is the sum of the elements in the corresponding row of this matrix.\n\nFor the gate terminal ($i=g$):\n$$ \\Delta_{g} = C_{gg} + C_{gd} + C_{gs} + C_{gb} = 0 + C_{gd} + C_{gs} + 0 = 3.453133 \\times 10^{-15}\\,\\mathrm{F} + 1.726566 \\times 10^{-14}\\,\\mathrm{F} \\approx 2.07188 \\times 10^{-14}\\,\\mathrm{F} $$\nIn femtofarads, $\\Delta_g \\approx 20.7188\\,\\mathrm{fF}$.\n\nFor the drain terminal ($i=d$):\n$$ \\Delta_{d} = C_{dg} + C_{dd} + C_{ds} + C_{db} = C_{gd} + 0 + 0 + 0 \\approx 3.453133 \\times 10^{-15}\\,\\mathrm{F} $$\nIn femtofarads, $\\Delta_d \\approx 3.453133\\,\\mathrm{fF}$.\n\nFor the source terminal ($i=s$):\n$$ \\Delta_{s} = C_{sg} + C_{sd} + C_{ss} + C_{sb} = C_{gs} + 0 + 0 + 0 \\approx 1.726566 \\times 10^{-14}\\,\\mathrm{F} $$\nIn femtofarads, $\\Delta_s \\approx 17.26566\\,\\mathrm{fF}$.\n\nFor the bulk terminal ($i=b$):\n$$ \\Delta_{b} = C_{bg} + C_{bd} + C_{bs} + C_{bb} = 0 + 0 + 0 + 0 = 0\\,\\mathrm{F} $$\nIn femtofarads, $\\Delta_b = 0\\,\\mathrm{fF}$.\n\nRounding these results to four significant figures as required:\n$\\Delta_g \\approx 20.72\\,\\mathrm{fF}$\n$\\Delta_d \\approx 3.453\\,\\mathrm{fF}$\n$\\Delta_s \\approx 17.27\\,\\mathrm{fF}$\n$\\Delta_b = 0\\,\\mathrm{fF}$\nThe value for $\\Delta_b$ is exactly zero and can be represented as $0$.\n\nThe final answer is the row matrix $[\\Delta_g, \\Delta_d, \\Delta_s, \\Delta_b]$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 20.72  3.453  17.27  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "The abrupt, piecewise boundaries that define the Meyer model are not just a theoretical concern; they pose a significant practical challenge for the numerical solvers used in circuit simulation. This final practice moves from theory to implementation, tasking you with confronting the problem of model discontinuities head-on . By implementing and comparing a standard piecewise model with a smoothed version, you will gain insight into the techniques required to create robust and reliable compact models for modern electronic design automation (EDA) tools.",
            "id": "3780329",
            "problem": "You are tasked with designing a program to analyze and mitigate numerical convergence issues in a Metal–Oxide–Semiconductor Field-Effect Transistor (MOSFET) quasi-static capacitance model based on the Meyer capacitance model. The challenge focuses on corner biases near the threshold voltage and near the saturation boundary, where abrupt transitions in piecewise-defined capacitances cause discontinuities that can degrade the robustness of Newton-like solvers in circuit simulators. The program must compute and compare jump magnitudes of capacitances across these corners for an unsmoothed (abrupt) model and for a smoothed model that enforces continuous transitions.\n\nStarting point from fundamental base:\n- The quasi-static small-signal capacitance between terminals is defined by the partial derivative of a terminal charge with respect to a terminal voltage, namely $C_{ij} = \\partial Q_i/\\partial V_j$, where $Q_i$ is the charge associated with terminal $i$ and $V_j$ is the voltage at terminal $j$.\n- For the MOS gate capacitor in the Meyer approximation, the oxide capacitance per unit area $C_{\\mathrm{ox}}$ is treated as the dominant linear dielectric contribution in the gate stack. The area factor is $A_{\\mathrm{geom}} = W L$, where $W$ is the channel width and $L$ is the channel length, so the geometric oxide capacitance is $C_{\\mathrm{geom}} = C_{\\mathrm{ox}} W L$.\n- In the canonical Meyer partition, the gate capacitance is allocated among gate-to-source, gate-to-drain, and gate-to-bulk depending on the region of operation: accumulation/depletion versus inversion, and linear versus saturation. Abrupt region boundaries occur near the threshold voltage $V_{\\mathrm{th}}$ (onset of strong inversion) and near the saturation boundary $V_{\\mathrm{dsat}}$, which for a long-channel device is approximately $V_{\\mathrm{dsat}} \\approx V_{\\mathrm{gs}} - V_{\\mathrm{th}}$.\n\nYour tasks:\n1. Implement an unsmoothed, piecewise Meyer capacitance model using the canonical region partitions. It must assign gate-to-bulk capacitance in the non-inversion regime, and allocate gate-to-source and gate-to-drain capacitances in inversion with a change at the saturation boundary. Use $V_{\\mathrm{dsat}} = \\max(V_{\\mathrm{gs}} - V_{\\mathrm{th}}, 0)$ to ensure physical realism in the pre-inversion regime.\n2. Implement a smoothed Meyer capacitance model that enforces continuity of capacitances across the boundaries near $V_{\\mathrm{th}}$ and $V_{\\mathrm{dsat}}$ without altering the asymptotic values away from the transitions. The transition must be continuously differentiable with respect to both $V_{\\mathrm{gs}}$ and $V_{\\mathrm{ds}}$, and it must asymptotically approach the unsmoothed values far from the boundaries. You must choose a physically plausible smoothing strategy based on continuous transition functions defined by bias widths $w_{\\mathrm{th}}$ (for $V_{\\mathrm{th}}$) and $w_{\\mathrm{sat}}$ (for $V_{\\mathrm{dsat}}$), both with units of volts, that determine how gradual the transitions are.\n3. Quantify the severity of abrupt changes (which are known to affect solver convergence) by computing jump magnitudes across small symmetric bias perturbations around the boundary of interest. The jump magnitude is defined as the absolute difference in the capacitance value when the corresponding bias is perturbed above and below the boundary by a small $\\Delta V$.\n\nPhysical units:\n- Voltages must be treated in volts ($\\mathrm{V}$).\n- Capacitances must be reported in farads ($\\mathrm{F}$).\n- All output values in the final result must be floats in farads.\n\nDevice and model parameters for all tests:\n- Oxide capacitance per unit area: $C_{\\mathrm{ox}} = 1.15 \\times 10^{-2}\\,\\mathrm{F/m^2}$.\n- Channel width: $W = 10 \\times 10^{-6}\\,\\mathrm{m}$.\n- Channel length: $L = 1 \\times 10^{-6}\\,\\mathrm{m}$.\n- Threshold voltage: $V_{\\mathrm{th}} = 0.6\\,\\mathrm{V}$.\n\nBias increment for boundary probing:\n- Use a symmetric increment $\\Delta V = 1.0 \\times 10^{-4}\\,\\mathrm{V}$ around the boundary in each test.\n\nDefine the jump computations for each boundary:\n- Near the threshold boundary at $V_{\\mathrm{gs}} \\approx V_{\\mathrm{th}}$ with fixed $V_{\\mathrm{ds}}$:\n  - Compute the jump magnitude in gate-to-bulk capacitance $C_{\\mathrm{gb}}$ between $V_{\\mathrm{gs}} = V_{\\mathrm{th}} - \\Delta V$ and $V_{\\mathrm{gs}} = V_{\\mathrm{th}} + \\Delta V$ at a fixed $V_{\\mathrm{ds}} = 0.05\\,\\mathrm{V}$.\n- Near the saturation boundary at $V_{\\mathrm{ds}} \\approx V_{\\mathrm{dsat}}$ for a fixed $V_{\\mathrm{gs}}$ in inversion:\n  - Choose $V_{\\mathrm{gs}} = V_{\\mathrm{th}} + 0.2\\,\\mathrm{V}$, so $V_{\\mathrm{dsat}} = 0.2\\,\\mathrm{V}$, and compute the jump magnitude in gate-to-drain capacitance $C_{\\mathrm{gd}}$ between $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}} - \\Delta V$ and $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}} + \\Delta V$.\n- Combined corner case:\n  - Compute both $C_{\\mathrm{gb}}$ and $C_{\\mathrm{gd}}$ jump magnitudes when simultaneously near both boundaries with $V_{\\mathrm{gs}}$ and $V_{\\mathrm{ds}}$ perturbed around their respective corners:\n    - Use $V_{\\mathrm{gs}}^{(-)} = V_{\\mathrm{th}} - \\Delta V$ and $V_{\\mathrm{ds}}^{(-)} = \\max(V_{\\mathrm{dsat}}^{(-)} - \\Delta V, 0)$ with $V_{\\mathrm{dsat}}^{(-)} = \\max(V_{\\mathrm{gs}}^{(-)} - V_{\\mathrm{th}}, 0)$.\n    - Use $V_{\\mathrm{gs}}^{(+)} = V_{\\mathrm{th}} + \\Delta V$ and $V_{\\mathrm{ds}}^{(+)} = V_{\\mathrm{dsat}}^{(+)} + \\Delta V$ with $V_{\\mathrm{dsat}}^{(+)} = \\max(V_{\\mathrm{gs}}^{(+)} - V_{\\mathrm{th}}, 0)$.\n  - Report the maximum of the two jump magnitudes among $C_{\\mathrm{gb}}$ and $C_{\\mathrm{gd}}$ for each model.\n\nTest suite:\n- Test 1 (happy path smoothing): $w_{\\mathrm{th}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$, $w_{\\mathrm{sat}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$.\n- Test 2 (same smoothing widths, focus on $V_{\\mathrm{dsat}}$ boundary): $w_{\\mathrm{th}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$, $w_{\\mathrm{sat}} = 5.0 \\times 10^{-3}\\,\\mathrm{V}$.\n- Test 3 (edge case with extremely sharp transitions): $w_{\\mathrm{th}} = 1.0 \\times 10^{-6}\\,\\mathrm{V}$, $w_{\\mathrm{sat}} = 1.0 \\times 10^{-6}\\,\\mathrm{V}$.\n\nFor each test, compute and return the following floats (all in farads):\n- Test 1: $[J_{\\mathrm{th}}^{\\mathrm{unsm}}, J_{\\mathrm{th}}^{\\mathrm{sm}}]$ where $J_{\\mathrm{th}}$ is the jump magnitude in $C_{\\mathrm{gb}}$ at $V_{\\mathrm{gs}} \\approx V_{\\mathrm{th}}$.\n- Test 2: $[J_{\\mathrm{sat}}^{\\mathrm{unsm}}, J_{\\mathrm{sat}}^{\\mathrm{sm}}]$ where $J_{\\mathrm{sat}}$ is the jump magnitude in $C_{\\mathrm{gd}}$ at $V_{\\mathrm{ds}} \\approx V_{\\mathrm{dsat}}$.\n- Test 3: $[J_{\\mathrm{combo}}^{\\mathrm{unsm}}, J_{\\mathrm{combo}}^{\\mathrm{sm}}]$ where $J_{\\mathrm{combo}}$ is the maximum of the two jump magnitudes ($C_{\\mathrm{gb}}$ and $C_{\\mathrm{gd}}$) when both $V_{\\mathrm{gs}}$ and $V_{\\mathrm{ds}}$ are near their corners simultaneously.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order:\n  - $[J_{\\mathrm{th}}^{\\mathrm{unsm}}, J_{\\mathrm{th}}^{\\mathrm{sm}}, J_{\\mathrm{sat}}^{\\mathrm{unsm}}, J_{\\mathrm{sat}}^{\\mathrm{sm}}, J_{\\mathrm{combo}}^{\\mathrm{unsm}}, J_{\\mathrm{combo}}^{\\mathrm{sm}}]$.\n- All values must be reported in farads ($\\mathrm{F}$) as floating-point numbers.",
            "solution": "The problem requires the implementation and comparison of two Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) gate capacitance models: a standard unsmoothed, piecewise Meyer model and a proposed smoothed variant. The goal is to quantify the reduction in capacitance discontinuities at critical bias boundaries, which is a key factor for the convergence and robustness of circuit simulators.\n\nFirst, we define the fundamental physical parameters and the geometric oxide capacitance, which is the cornerstone of the Meyer model. The device parameters are given as: oxide capacitance per unit area $C_{\\mathrm{ox}} = 1.15 \\times 10^{-2}\\,\\mathrm{F/m^2}$, channel width $W = 10 \\times 10^{-6}\\,\\mathrm{m}$, and channel length $L = 1 \\times 10^{-6}\\,\\mathrm{m}$. The total geometric oxide capacitance $C_{\\mathrm{geom}}$ is therefore:\n$$\nC_{\\mathrm{geom}} = C_{\\mathrm{ox}} W L = (1.15 \\times 10^{-2}\\,\\mathrm{F/m^2}) \\times (10 \\times 10^{-6}\\,\\mathrm{m}) \\times (1 \\times 10^{-6}\\,\\mathrm{m}) = 1.15 \\times 10^{-13}\\,\\mathrm{F}\n$$\nThe other key parameter is the threshold voltage, $V_{\\mathrm{th}} = 0.6\\,\\mathrm{V}$.\n\n**Unsmoothed Meyer Capacitance Model**\n\nThe unsmoothed model is a piecewise function of the terminal voltages $V_{\\mathrm{gs}}$ (gate-to-source) and $V_{\\mathrm{ds}}$ (drain-to-source). It is defined based on the operating region of the MOSFET.\nThe saturation drain-source voltage, $V_{\\mathrm{dsat}}$, is defined as $V_{\\mathrm{dsat}} = \\max(V_{\\mathrm{gs}} - V_{\\mathrm{th}}, 0)$.\n\n1.  **Subthreshold/Cutoff Region ($V_{\\mathrm{gs}} \\le V_{\\mathrm{th}}$)**: The inversion channel is not formed. The gate capacitance is entirely to the bulk substrate.\n    $$\n    C_{\\mathrm{gb}} = C_{\\mathrm{geom}}, \\quad C_{\\mathrm{gs}} = 0, \\quad C_{\\mathrm{gd}} = 0\n    $$\n\n2.  **Inversion Region ($V_{\\mathrm{gs}}  V_{\\mathrm{th}}$)**: The inversion channel forms, shielding the bulk from the gate. The gate-to-bulk capacitance becomes negligible, i.e., $C_{\\mathrm{gb}} = 0$. The total gate capacitance $C_{\\mathrm{geom}}$ is partitioned between the source and drain terminals. This region is further divided into:\n    a.  **Linear (or Triode) Region ($V_{\\mathrm{ds}}  V_{\\mathrm{dsat}}$)**: The channel extends fully from source to drain. A common simplified partition assigns half of the capacitance to the source and half to the drain.\n        $$\n        C_{\\mathrm{gs}} = \\frac{1}{2} C_{\\mathrm{geom}}, \\quad C_{\\mathrm{gd}} = \\frac{1}{2} C_{\\mathrm{geom}}\n        $$\n    b.  **Saturation Region ($V_{\\mathrm{ds}} \\ge V_{\\mathrm{dsat}}$)**: The channel is \"pinched off\" near the drain. The gate's influence is stronger on the source side. The canonical partition is:\n        $$\n        C_{\\mathrm{gs}} = \\frac{2}{3} C_{\\mathrm{geom}}, \\quad C_{\\mathrm{gd}} = 0\n        $$\nThis model exhibits abrupt jumps. For example, at $V_{\\mathrm{gs}} = V_{\\mathrm{th}}$, $C_{\\mathrm{gb}}$ drops from $C_{\\mathrm{geom}}$ to $0$. At $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}}$, $C_{\\mathrm{gd}}$ drops from $\\frac{1}{2}C_{\\mathrm{geom}}$ to $0$, and $C_{\\mathrm{gs}}$ jumps from $\\frac{1}{2} C_{\\mathrm{geom}}$ to $\\frac{2}{3} C_{\\mathrm{geom}}$.\n\n**Smoothed Meyer Capacitance Model**\n\nTo create a continuously differentiable model, we employ smooth transition functions. A suitable choice is a function based on the hyperbolic tangent, which provides a smooth, monotonic transition between $0$ and $1$:\n$$\nS(x, w) = \\frac{1}{2} \\left(1 + \\tanh\\left(\\frac{x}{w}\\right)\\right)\n$$\nHere, $x$ is the control variable (a voltage difference) and $w$ is the transition width in volts.\n\nWe define two smoothing factors based on the key bias conditions:\n1.  An \"inversion factor\" $f_{\\mathrm{inv}}$ to manage the transition from subthreshold to inversion, controlled by $V_{\\mathrm{gs}}$ relative to $V_{\\mathrm{th}}$. Let $V_{\\mathrm{over}} = V_{\\mathrm{gs}} - V_{\\mathrm{th}}$.\n    $$\n    f_{\\mathrm{inv}} = S(V_{\\mathrm{over}}, w_{\\mathrm{th}}) = \\frac{1}{2} \\left(1 + \\tanh\\left(\\frac{V_{\\mathrm{gs}} - V_{\\mathrm{th}}}{w_{\\mathrm{th}}}\\right)\\right)\n    $$\n2.  A \"linear factor\" $f_{\\mathrm{lin}}$ to manage the transition from the linear to saturation region, controlled by $V_{\\mathrm{ds}}$ relative to $V_{\\mathrm{over}}$.\n    $$\n    f_{\\mathrm{lin}} = S(V_{\\mathrm{over}} - V_{\\mathrm{ds}}, w_{\\mathrm{sat}}) = \\frac{1}{2} \\left(1 + \\tanh\\left(\\frac{V_{\\mathrm{gs}} - V_{\\mathrm{th}} - V_{\\mathrm{ds}}}{w_{\\mathrm{sat}}}\\right)\\right)\n    $$\nUsing these factors, we can construct the smoothed capacitances by smoothly interpolating between the asymptotic values of the piecewise model:\n-   **Gate-to-Bulk Capacitance ($C_{\\mathrm{gb}}$)**: This should be $C_{\\mathrm{geom}}$ in subthreshold ($f_{\\mathrm{inv}} \\to 0$) and $0$ in inversion ($f_{\\mathrm{inv}} \\to 1$).\n    $$\n    C_{\\mathrm{gb}}^{\\mathrm{sm}} = (1 - f_{\\mathrm{inv}}) C_{\\mathrm{geom}}\n    $$\n-   **Gate-to-Drain Capacitance ($C_{\\mathrm{gd}}$)**: This should only exist in inversion, be $\\frac{1}{2}C_{\\mathrm{geom}}$ in the linear region ($f_{\\mathrm{lin}} \\to 1$), and $0$ in saturation ($f_{\\mathrm{lin}} \\to 0$).\n    $$\n    C_{\\mathrm{gd}}^{\\mathrm{sm}} = f_{\\mathrm{inv}} \\times f_{\\mathrm{lin}} \\times \\frac{1}{2} C_{\\mathrm{geom}}\n    $$\n-   **Gate-to-Source Capacitance ($C_{\\mathrm{gs}}$)**: This also exists only in inversion. It interpolates between $\\frac{1}{2}C_{\\mathrm{geom}}$ in linear and $\\frac{2}{3}C_{\\mathrm{geom}}$ in saturation.\n    $$\n    C_{\\mathrm{gs}}^{\\mathrm{sm}} = f_{\\mathrm{inv}} \\left( f_{\\mathrm{lin}} \\frac{1}{2}C_{\\mathrm{geom}} + (1 - f_{\\mathrm{lin}}) \\frac{2}{3}C_{\\mathrm{geom}} \\right) = f_{\\mathrm{inv}} C_{\\mathrm{geom}} \\left( \\frac{2}{3} - \\frac{1}{6} f_{\\mathrm{lin}} \\right)\n    $$\nThis formulation is continuously differentiable with respect to $V_{\\mathrm{gs}}$ and $V_{\\mathrm{ds}}$ because `tanh` is $C^\\infty$ and its arguments are linear functions of the biases.\n\n**Jump Magnitude Computation**\n\nThe program calculates the jump magnitude $| \\Delta C | = | C(V_{\\text{bias,2}}) - C(V_{\\text{bias,1}}) |$ for specific capacitances across boundaries defined by a small perturbation $\\Delta V = 1.0 \\times 10^{-4}\\,\\mathrm{V}$.\n\n-   **Test 1 (Threshold Boundary)**: The jump in $C_{\\mathrm{gb}}$ is computed between $V_{\\mathrm{gs}} = V_{\\mathrm{th}} \\mp \\Delta V$ at a fixed $V_{\\mathrm{ds}} = 0.05\\,\\mathrm{V}$. For the unsmoothed model, this jump is exactly $C_{\\mathrm{geom}}$.\n\n-   **Test 2 (Saturation Boundary)**: With $V_{\\mathrm{gs}} = V_{\\mathrm{th}} + 0.2\\,\\mathrm{V} = 0.8\\,\\mathrm{V}$, we have $V_{\\mathrm{dsat}} = 0.2\\,\\mathrm{V}$. The jump in $C_{\\mathrm{gd}}$ is computed between $V_{\\mathrm{ds}} = V_{\\mathrm{dsat}} \\mp \\Delta V$. For the unsmoothed model, this jump is $\\frac{1}{2}C_{\\mathrm{geom}}$.\n\n-   **Test 3 (Combined Corner)**: We examine the corner where $V_{\\mathrm{gs}} \\approx V_{\\mathrm{th}}$ and $V_{\\mathrm{ds}} \\approx V_{\\mathrm{dsat}}$. The bias points are $V^{(-)} = (V_{\\mathrm{gs}}^{(-)}, V_{\\mathrm{ds}}^{(-)}) = (V_{\\mathrm{th}}-\\Delta V, 0)$ and $V^{(+)} = (V_{\\mathrm{gs}}^{(+)}, V_{\\mathrm{ds}}^{(+)}) = (V_{\\mathrm{th}}+\\Delta V, 2\\Delta V)$. We compute the jumps for both $C_{\\mathrm{gb}}$ and $C_{\\mathrm{gd}}$ and report the maximum of the two. For the unsmoothed model, the transition is from subthreshold to saturation, so the jump in $C_{\\mathrm{gb}}$ is $C_{\\mathrm{geom}}$ while the jump in $C_{\\mathrm{gd}}$ is $0$. The maximum jump is $C_{\\mathrm{geom}}$.\n\nThe implementation will compute these values for both the unsmoothed and smoothed models under the specified test conditions. The smoothed model is expected to show significantly smaller jumps, demonstrating its superior numerical properties for simulation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares capacitance jump magnitudes for unsmoothed and\n    smoothed Meyer MOSFET models across critical bias boundaries.\n    \"\"\"\n\n    # --- Device and Model Parameters ---\n    C_ox = 1.15e-2  # F/m^2\n    W = 10.0e-6      # m\n    L = 1.0e-6       # m\n    V_th = 0.6       # V\n    delta_V = 1.0e-4 # V\n\n    # Geometric oxide capacitance\n    C_geom = C_ox * W * L\n\n    # --- Model Implementations ---\n\n    def capacitances_unsmoothed(V_gs, V_ds):\n        \"\"\"\n        Calculates capacitances using the unsmoothed, piecewise Meyer model.\n        Returns: (C_gs, C_gd, C_gb)\n        \"\"\"\n        V_dsat = max(V_gs - V_th, 0.0)\n\n        if V_gs = V_th:\n            # Subthreshold/Cutoff region\n            C_gs, C_gd, C_gb = 0.0, 0.0, C_geom\n        else:\n            # Inversion region\n            C_gb = 0.0\n            if V_ds  V_dsat:\n                # Linear/Triode region\n                C_gs = 0.5 * C_geom\n                C_gd = 0.5 * C_geom\n            else:\n                # Saturation region\n                C_gs = (2.0 / 3.0) * C_geom\n                C_gd = 0.0\n        return C_gs, C_gd, C_gb\n\n    def capacitances_smoothed(V_gs, V_ds, w_th, w_sat):\n        \"\"\"\n        Calculates capacitances using the continuously differentiable smoothed model.\n        Returns: (C_gs, C_gd, C_gb)\n        \"\"\"\n        \n        def smooth_step(x, w):\n            # A robust implementation to avoid overflow with large x/w\n            arg = x / w\n            if arg  -100:\n                return 0.0\n            if arg  100:\n                return 1.0\n            return 0.5 * (1.0 + np.tanh(arg))\n\n        V_over = V_gs - V_th\n\n        # Inversion factor\n        f_inv = smooth_step(V_over, w_th)\n        \n        # Linear factor\n        f_lin = smooth_step(V_over - V_ds, w_sat)\n\n        # Smoothed capacitances\n        C_gb_sm = (1.0 - f_inv) * C_geom\n        C_gd_sm = f_inv * f_lin * 0.5 * C_geom\n        C_gs_sm = f_inv * C_geom * (2.0/3.0 - (1.0/6.0) * f_lin)\n        \n        return C_gs_sm, C_gd_sm, C_gb_sm\n\n    results = []\n\n    # --- Test 1: Jump at V_th boundary ---\n    w_th_t1, w_sat_t1 = 5.0e-3, 5.0e-3\n    V_ds_fixed = 0.05\n    V_gs1 = V_th - delta_V\n    V_gs2 = V_th + delta_V\n\n    # Unsmoothed\n    _, _, C_gb1_unsm = capacitances_unsmoothed(V_gs1, V_ds_fixed)\n    _, _, C_gb2_unsm = capacitances_unsmoothed(V_gs2, V_ds_fixed)\n    J_th_unsm = abs(C_gb2_unsm - C_gb1_unsm)\n    results.append(J_th_unsm)\n\n    # Smoothed\n    _, _, C_gb1_sm = capacitances_smoothed(V_gs1, V_ds_fixed, w_th_t1, w_sat_t1)\n    _, _, C_gb2_sm = capacitances_smoothed(V_gs2, V_ds_fixed, w_th_t1, w_sat_t1)\n    J_th_sm = abs(C_gb2_sm - C_gb1_sm)\n    results.append(J_th_sm)\n\n    # --- Test 2: Jump at V_dsat boundary ---\n    w_th_t2, w_sat_t2 = 5.0e-3, 5.0e-3\n    V_gs_fixed = V_th + 0.2\n    V_dsat_fixed = V_gs_fixed - V_th\n    V_ds1 = V_dsat_fixed - delta_V\n    V_ds2 = V_dsat_fixed + delta_V\n\n    # Unsmoothed\n    _, C_gd1_unsm, _ = capacitances_unsmoothed(V_gs_fixed, V_ds1)\n    _, C_gd2_unsm, _ = capacitances_unsmoothed(V_gs_fixed, V_ds2)\n    J_sat_unsm = abs(C_gd2_unsm - C_gd1_unsm)\n    results.append(J_sat_unsm)\n\n    # Smoothed\n    _, C_gd1_sm, _ = capacitances_smoothed(V_gs_fixed, V_ds1, w_th_t2, w_sat_t2)\n    _, C_gd2_sm, _ = capacitances_smoothed(V_gs_fixed, V_ds2, w_th_t2, w_sat_t2)\n    J_sat_sm = abs(C_gd2_sm - C_gd1_sm)\n    results.append(J_sat_sm)\n\n    # --- Test 3: Jump at combined corner ---\n    w_th_t3, w_sat_t3 = 1.0e-6, 1.0e-6\n    # Bias point (-)\n    V_gs_neg = V_th - delta_V\n    V_dsat_neg = max(V_gs_neg - V_th, 0.0)\n    V_ds_neg = max(V_dsat_neg - delta_V, 0.0)\n    # Bias point (+)\n    V_gs_pos = V_th + delta_V\n    V_dsat_pos = max(V_gs_pos - V_th, 0.0)\n    V_ds_pos = V_dsat_pos + delta_V\n\n    # Unsmoothed\n    _, C_gd_neg_unsm, C_gb_neg_unsm = capacitances_unsmoothed(V_gs_neg, V_ds_neg)\n    _, C_gd_pos_unsm, C_gb_pos_unsm = capacitances_unsmoothed(V_gs_pos, V_ds_pos)\n    jump_gb_unsm = abs(C_gb_pos_unsm - C_gb_neg_unsm)\n    jump_gd_unsm = abs(C_gd_pos_unsm - C_gd_neg_unsm)\n    J_combo_unsm = max(jump_gb_unsm, jump_gd_unsm)\n    results.append(J_combo_unsm)\n\n    # Smoothed\n    _, C_gd_neg_sm, C_gb_neg_sm = capacitances_smoothed(V_gs_neg, V_ds_neg, w_th_t3, w_sat_t3)\n    _, C_gd_pos_sm, C_gb_pos_sm = capacitances_smoothed(V_gs_pos, V_ds_pos, w_th_t3, w_sat_t3)\n    jump_gb_sm = abs(C_gb_pos_sm - C_gb_neg_sm)\n    jump_gd_sm = abs(C_gd_pos_sm - C_gd_neg_sm)\n    J_combo_sm = max(jump_gb_sm, jump_gd_sm)\n    results.append(J_combo_sm)\n\n    # --- Final Output ---\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}