{
    "hands_on_practices": [
        {
            "introduction": "A core skill in semiconductor device physics is linking macroscopic device characteristics to the microscopic properties of the underlying material. This practice focuses on applying first-principles transport equations to calculate and compare the diffusion capacitance in diodes made from Silicon (Si) and Gallium Arsenide (GaAs). By working through this problem, you will gain a deeper appreciation for how fundamental differences in band structure and dominant recombination mechanisms between these materials lead to significant variations in their high-frequency performance .",
            "id": "3739049",
            "problem": "A one-dimensional abrupt $p$-$n$ junction diode is fabricated in Silicon (Si) and Gallium Arsenide (GaAs), each with uniformly doped quasi-neutral regions of acceptor and donor concentrations $N_{A} = N_{D} = 1.0 \\times 10^{16} \\ \\mathrm{cm}^{-3}$. Both devices operate at temperature $T = 300 \\ \\mathrm{K}$. Assume low-level injection, negligible recombination in the depletion region, and semi-infinite quasi-neutral regions so that minority-carrier profiles decay exponentially away from the depletion edge.\n\nFor the Si diode, minority-carrier transport parameters are:\n- Electron diffusion coefficient in the $p$-side: $D_{n,\\mathrm{Si}} = 35 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$,\n- Hole diffusion coefficient in the $n$-side: $D_{p,\\mathrm{Si}} = 12 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$,\n- Electron Shockley-Read-Hall (SRH) lifetime in the $p$-side: $\\tau_{n,\\mathrm{Si}} = 10 \\ \\mu\\mathrm{s}$,\n- Hole SRH lifetime in the $n$-side: $\\tau_{p,\\mathrm{Si}} = 5 \\ \\mu\\mathrm{s}$,\n- Intrinsic carrier concentration: $n_{i,\\mathrm{Si}} = 1.0 \\times 10^{10} \\ \\mathrm{cm}^{-3}$.\n\nFor the GaAs diode, minority-carrier transport parameters are:\n- Electron diffusion coefficient in the $p$-side: $D_{n,\\mathrm{GaAs}} = 220 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$,\n- Hole diffusion coefficient in the $n$-side: $D_{p,\\mathrm{GaAs}} = 10.3 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$,\n- Radiative recombination coefficient: $B_{\\mathrm{rad}} = 1.0 \\times 10^{-10} \\ \\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$,\n- Intrinsic carrier concentration: $n_{i,\\mathrm{GaAs}} = 2.0 \\times 10^{6} \\ \\mathrm{cm}^{-3}$.\n\nUnder forward bias, both diodes are driven to the same total current density $J = 0.10 \\ \\mathrm{A}\\,\\mathrm{cm}^{-2}$. Using only first-principles transport and continuity arguments for steady-state diffusion with recombination in the quasi-neutral regions, derive the diffusion (storage) capacitance per unit area $C_{d}/A$ as the derivative of stored charge with respect to applied voltage. In GaAs, assume minority-carrier lifetimes are set by radiative recombination in low-level injection as $\\tau_{n,\\mathrm{GaAs}} = \\left(B_{\\mathrm{rad}} p_{0}\\right)^{-1}$ in the $p$-side and $\\tau_{p,\\mathrm{GaAs}} = \\left(B_{\\mathrm{rad}} n_{0}\\right)^{-1}$ in the $n$-side, with $p_{0} \\approx N_{A}$ and $n_{0} \\approx N_{D}$.\n\nCompute $C_{d}/A$ for each diode at $T = 300 \\ \\mathrm{K}$. Round your answers to three significant figures. Express $C_{d}/A$ in $\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$. In your reasoning, account for the roles of $D$, $\\tau$, $n_{i}$, and the dominant recombination mechanism in each material, but do not invoke or quote any pre-derived diode capacitance formulas.",
            "solution": "The problem requires the derivation of the diffusion capacitance per unit area, $C_d/A$, from first principles for a $p$-$n$ junction diode under forward bias, and its subsequent calculation for Silicon (Si) and Gallium Arsenide (GaAs) devices operating at the same current density. Let the capacitance per unit area be denoted as $C'_d$.\n\nThe diffusion capacitance arises from the change in stored minority-carrier charge in the quasi-neutral regions (QNRs) with respect to a change in the applied forward voltage. It is defined as $C'_d = dQ'_s/dV$, where $Q'_s$ is the total stored minority-carrier charge per unit area and $V$ is the applied voltage across the diode.\n\nWe begin with the steady-state continuity equation for minority carriers. In the $p$-side QNR, for excess electrons $\\delta n_p(x')$, where $x'$ is the distance from the depletion edge, the equation is:\n$$\nD_n \\frac{d^2(\\delta n_p)}{dx'^2} - \\frac{\\delta n_p}{\\tau_n} = 0\n$$\nHere, $D_n$ is the electron diffusion coefficient and $\\tau_n$ is the electron lifetime. The solution, subject to the boundary conditions $\\delta n_p(x' \\to \\infty) = 0$ and a finite concentration at the depletion edge $x'=0$, is an exponential decay:\n$$\n\\delta n_p(x') = \\delta n_p(0) \\exp\\left(-\\frac{x'}{L_n}\\right)\n$$\nwhere $L_n = \\sqrt{D_n \\tau_n}$ is the electron diffusion length. A similar solution holds for excess holes $\\delta p_n$ in the $n$-side QNR, with corresponding parameters $D_p$, $\\tau_p$, and $L_p = \\sqrt{D_p \\tau_p}$.\n\nThe total stored excess minority charge per unit area, $Q'_s$, is the sum of the charge from electrons in the $p$-side QNR and holes in the $n$-side QNR.\n$$\nQ'_s = \\int_{0}^{\\infty} e \\, \\delta n_p(x') \\, dx' + \\int_{0}^{\\infty} e \\, \\delta p_n(x') \\, dx'\n$$\nSubstituting the exponential profiles and integrating gives:\n$$\nQ'_s = e \\delta n_p(0) \\int_{0}^{\\infty} \\exp\\left(-\\frac{x'}{L_n}\\right) dx' + e \\delta p_n(0) \\int_{0}^{\\infty} \\exp\\left(-\\frac{x'}{L_p}\\right) dx'\n$$\n$$\nQ'_s = e L_n \\delta n_p(0) + e L_p \\delta p_n(0)\n$$\nUnder low-level injection, the excess minority concentrations at the depletion edges are given by the law of the junction:\n$$\n\\delta n_p(0) = n_{p0} \\left(\\exp\\left(\\frac{V}{V_T}\\right) - 1\\right) \\quad \\text{and} \\quad \\delta p_n(0) = p_{n0} \\left(\\exp\\left(\\frac{V}{V_T}\\right) - 1\\right)\n$$\nwhere $n_{p0} = n_i^2/N_A$ and $p_{n0} = n_i^2/N_D$ are the equilibrium minority carrier concentrations, and $V_T = k_B T / e$ is the thermal voltage. For forward bias $V \\gg V_T$, we can approximate $\\exp(V/V_T) - 1 \\approx \\exp(V/V_T)$.\n$$\nQ'_s \\approx e (L_n n_{p0} + L_p p_{n0}) \\exp\\left(\\frac{V}{V_T}\\right)\n$$\nThe diffusion capacitance per unit area is the derivative of $Q'_s$ with respect to $V$:\n$$\nC'_d = \\frac{dQ'_s}{dV} \\approx \\frac{d}{dV} \\left[ e (L_n n_{p0} + L_p p_{n0}) \\exp\\left(\\frac{V}{V_T}\\right) \\right]\n$$\n$$\nC'_d \\approx \\frac{e}{V_T} (L_n n_{p0} + L_p p_{n0}) \\exp\\left(\\frac{V}{V_T}\\right)\n$$\nThis expression can be related to the total diode current density, $J$. The total current density is the sum of the minority carrier diffusion currents at the depletion region edges:\n$$\nJ = J_n + J_p = e D_n \\left. \\frac{d(\\delta n_p)}{dx'} \\right|_{x'=0} + e D_p \\left. \\frac{d(\\delta p_n)}{dx'} \\right|_{x'=0}\n$$\nUsing the exponential profiles, this becomes:\n$$\nJ = \\frac{e D_n}{L_n} \\delta n_p(0) + \\frac{e D_p}{L_p} \\delta p_n(0)\n$$\nFor forward bias, $J \\approx e \\left(\\frac{D_n}{L_n} n_{p0} + \\frac{D_p}{L_p} p_{n0}\\right) \\exp\\left(\\frac{V}{V_T}\\right)$.\n\nA more rigorous way to express $C'_d$ is through the relationship between stored charge and current. The stored electron charge is $Q'_{s,n} = e L_n \\delta n_p(0)$ and the electron current is $J_n = (e D_n / L_n) \\delta n_p(0)$. Combining these gives $Q'_{s,n} = (L_n^2/D_n)J_n = \\tau_n J_n$. Similarly, $Q'_{s,p} = \\tau_p J_p$.\nThe total stored charge is $Q'_s = \\tau_n J_n + \\tau_p J_p$.\nThe capacitance is $C'_d = dQ'_s/dV = \\tau_n (dJ_n/dV) + \\tau_p (dJ_p/dV)$.\nSince $J_n \\propto \\exp(V/V_T)$ and $J_p \\propto \\exp(V/V_T)$, we have $dJ_n/dV \\approx J_n/V_T$ and $dJ_p/dV \\approx J_p/V_T$ for $J \\gg J_0$.\nThus, $C'_d \\approx \\frac{1}{V_T}(\\tau_n J_n + \\tau_p J_p) = \\frac{Q'_s}{V_T}$.\nTo evaluate this, we need the individual current components $J_n$ and $J_p$. Their ratio is:\n$$\n\\frac{J_n}{J_p} = \\frac{(e D_n/L_n) n_{p0} (\\exp(V/V_T)-1)}{(e D_p/L_p) p_{n0} (\\exp(V/V_T)-1)} = \\frac{(D_n/L_n) n_{p0}}{(D_p/L_p) p_{n0}}\n$$\nGiven $N_A = N_D$, we have $n_{p0} = p_{n0}$, so the ratio simplifies to:\n$$\n\\frac{J_n}{J_p} = \\frac{D_n/L_n}{D_p/L_p} = \\frac{\\sqrt{D_n/\\tau_n}}{\\sqrt{D_p/\\tau_p}}\n$$\nLet's call this ratio $\\gamma$. Then $J_n = \\gamma J_p$ and $J = J_n+J_p = (\\gamma+1)J_p$.\nThis allows expressing $J_n$ and $J_p$ in terms of the total current $J$: $J_n = J \\gamma/(\\gamma+1)$ and $J_p = J/(\\gamma+1)$.\nSubstituting these into the expression for $C'_d$:\n$$\nC'_d = \\frac{1}{V_T} \\left( \\tau_n \\frac{J \\gamma}{\\gamma+1} + \\tau_p \\frac{J}{\\gamma+1} \\right) = \\frac{J}{V_T} \\frac{\\tau_n \\gamma + \\tau_p}{\\gamma+1}\n$$\nSubstituting the expression for $\\gamma$:\n$$\nC'_d = \\frac{J}{V_T} \\frac{\\tau_n \\frac{\\sqrt{D_n/\\tau_n}}{\\sqrt{D_p/\\tau_p}} + \\tau_p}{\\frac{\\sqrt{D_n/\\tau_n}}{\\sqrt{D_p/\\tau_p}} + 1} = \\frac{J}{V_T} \\frac{\\tau_n \\sqrt{D_n/\\tau_n} + \\tau_p \\sqrt{D_p/\\tau_p}}{\\sqrt{D_n/\\tau_n} + \\sqrt{D_p/\\tau_p}}\n$$\nSince $\\tau \\sqrt{D/\\tau} = \\sqrt{\\tau^2 D/\\tau} = \\sqrt{D\\tau}$, the final derived expression is:\n$$\n\\frac{C_d}{A} = C'_d = \\frac{J}{V_T} \\left( \\frac{\\sqrt{D_n \\tau_n} + \\sqrt{D_p \\tau_p}}{\\sqrt{D_n/\\tau_n} + \\sqrt{D_p/\\tau_p}} \\right)\n$$\nThe term in parentheses is an effective lifetime, $\\tau_{eff}$. This formula accounts for the roles of $D$ and $\\tau$ as requested. The intrinsic concentration $n_i$ determines the voltage required to achieve current $J$, but it cancels out when expressing $C'_d$ as a function of $J$.\n\nThe thermal voltage at $T = 300 \\ \\mathrm{K}$ is $V_T = k_B T / e \\approx (1.3806 \\times 10^{-23} \\ \\mathrm{J/K} \\times 300 \\ \\mathrm{K}) / (1.6022 \\times 10^{-19} \\ \\mathrm{C}) \\approx 0.02585 \\ \\mathrm{V}$.\n\n**Calculation for Si Diode**\nThe parameters are: $J = 0.10 \\ \\mathrm{A}\\,\\mathrm{cm}^{-2}$, $D_{n,\\mathrm{Si}} = 35 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$, $D_{p,\\mathrm{Si}} = 12 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$, $\\tau_{n,\\mathrm{Si}} = 1.0 \\times 10^{-5} \\ \\mathrm{s}$, $\\tau_{p,\\mathrm{Si}} = 5.0 \\times 10^{-6} \\ \\mathrm{s}$. The lifetimes are governed by Shockley-Read-Hall (SRH) recombination.\nNumerator of $\\tau_{eff}$:\n$\\sqrt{D_n \\tau_n} = \\sqrt{35 \\times 1.0 \\times 10^{-5}} = \\sqrt{3.5 \\times 10^{-4}} = 1.8708 \\times 10^{-2} \\ \\mathrm{cm}$.\n$\\sqrt{D_p \\tau_p} = \\sqrt{12 \\times 5.0 \\times 10^{-6}} = \\sqrt{6.0 \\times 10^{-5}} = 7.7460 \\times 10^{-3} \\ \\mathrm{cm}$.\nNumerator sum $= 1.8708 \\times 10^{-2} + 7.7460 \\times 10^{-3} = 2.6454 \\times 10^{-2} \\ \\mathrm{cm}$.\n\nDenominator of $\\tau_{eff}$:\n$\\sqrt{D_n/\\tau_n} = \\sqrt{35 / (1.0 \\times 10^{-5})} = \\sqrt{3.5 \\times 10^6} = 1870.8 \\ \\mathrm{cm}\\,\\mathrm{s}^{-1}$.\n$\\sqrt{D_p/\\tau_p} = \\sqrt{12 / (5.0 \\times 10^{-6})} = \\sqrt{2.4 \\times 10^6} = 1549.2 \\ \\mathrm{cm}\\,\\mathrm{s}^{-1}$.\nDenominator sum $= 1870.8 + 1549.2 = 3420.0 \\ \\mathrm{cm}\\,\\mathrm{s}^{-1}$.\n\n$\\tau_{eff,\\mathrm{Si}} = (2.6454 \\times 10^{-2} \\ \\mathrm{cm}) / (3420.0 \\ \\mathrm{cm}\\,\\mathrm{s}^{-1}) = 7.735 \\times 10^{-6} \\ \\mathrm{s}$.\n\n$C'_{d,\\mathrm{Si}} = \\frac{0.10 \\ \\mathrm{A}\\,\\mathrm{cm}^{-2}}{0.02585 \\ \\mathrm{V}} \\times 7.735 \\times 10^{-6} \\ \\mathrm{s} = 2.992 \\times 10^{-5} \\ \\mathrm{F}\\,\\mathrm{cm}^{-2}$.\nIn the requested units, $C'_{d,\\mathrm{Si}} = 29.92 \\ \\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$.\nRounded to three significant figures, $C'_{d,\\mathrm{Si}} = 29.9 \\ \\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$.\n\n**Calculation for GaAs Diode**\nThe parameters are: $J = 0.10 \\ \\mathrm{A}\\,\\mathrm{cm}^{-2}$, $D_{n,\\mathrm{GaAs}} = 220 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$, $D_{p,\\mathrm{GaAs}} = 10.3 \\ \\mathrm{cm}^{2}\\,\\mathrm{s}^{-1}$. The lifetimes hinge on a different mechanism: radiative recombination.\nThe lifetimes must be calculated first:\n$\\tau_{n,\\mathrm{GaAs}} = (B_{\\mathrm{rad}} p_0)^{-1} = ( (1.0 \\times 10^{-10} \\ \\mathrm{cm}^3\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{16} \\ \\mathrm{cm}^{-3}) )^{-1} = 1.0 \\times 10^{-6} \\ \\mathrm{s}$.\n$\\tau_{p,\\mathrm{GaAs}} = (B_{\\mathrm{rad}} n_0)^{-1} = ( (1.0 \\times 10^{-10} \\ \\mathrm{cm}^3\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{16} \\ \\mathrm{cm}^{-3}) )^{-1} = 1.0 \\times 10^{-6} \\ \\mathrm{s}$.\nSince $\\tau_n = \\tau_p = \\tau = 1.0 \\times 10^{-6} \\ \\mathrm{s}$, the expression for $\\tau_{eff}$ simplifies:\n$$\n\\tau_{eff,\\mathrm{GaAs}} = \\frac{\\sqrt{\\tau}(\\sqrt{D_n} + \\sqrt{D_p})}{(1/\\sqrt{\\tau})(\\sqrt{D_n} + \\sqrt{D_p})} = \\tau = 1.0 \\times 10^{-6} \\ \\mathrm{s}\n$$\n$C'_{d,\\mathrm{GaAs}} = \\frac{0.10 \\ \\mathrm{A}\\,\\mathrm{cm}^{-2}}{0.02585 \\ \\mathrm{V}} \\times 1.0 \\times 10^{-6} \\ \\mathrm{s} = 3.868 \\times 10^{-6} \\ \\mathrm{F}\\,\\mathrm{cm}^{-2}$.\nIn the requested units, $C'_{d,\\mathrm{GaAs}} = 3.868 \\ \\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$.\nRounded to three significant figures, $C'_{d,\\mathrm{GaAs}} = 3.87 \\ \\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$.\n\nThe diffusion capacitance is directly proportional to the effective minority-carrier recombination lifetime. Si, an indirect bandgap semiconductor, is dominated by SRH recombination, leading to a longer effective lifetime ($\\approx 7.7 \\ \\mu\\mathrm{s}$) in this case. GaAs, a direct bandgap semiconductor, is dominated by efficient radiative recombination, resulting in a significantly shorter lifetime ($1.0 \\ \\mu\\mathrm{s}$). This difference in lifetime is the primary reason for the much larger diffusion capacitance in the Si diode compared to the GaAs diode under the same current injection conditions.",
            "answer": "$$\\boxed{\\begin{pmatrix} 29.9 & 3.87 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While ideal models provide essential insights, real-world devices often exhibit more complex behaviors. This exercise addresses the practical challenge of parameter extraction in non-ideal diodes where the total current includes components that do not contribute to charge storage, such as depletion-region recombination. You will derive a correction formula to extract the true minority-carrier lifetime from standard electrical measurements, a crucial skill for accurate device characterization and modeling . This practice demonstrates how to deconstruct measured data to isolate the physical process of interest.",
            "id": "3739052",
            "problem": "A long-base abrupt pn junction diode under low-level injection is driven at steady forward bias at temperature $T$. The measured total forward current is $I(V)$ and the small-signal differential conductance is $g_d(V) \\equiv dI/dV$. The small-signal diffusion (storage) capacitance is defined as $C_d(V) \\equiv dQ/dV$, where $Q(V)$ is the excess minority-carrier charge stored in the quasi-neutral regions only; do not include depletion-layer electrostatic charge in $Q$.\n\nIn the low-frequency quasi-static limit, assume that the minority-carrier dynamics are governed by the charge-control relation derived from the steady-state continuity equation, so that the stored charge associated with the diffusion component of the current satisfies $Q=\\tau_T I_{\\text{diff}}$, where $\\tau_T$ is the transit (storage) time and $I_{\\text{diff}}$ is the diffusion component of the forward current.\n\nHowever, the diode exhibits significant Shockley-Read-Hall recombination in the depletion region. Model the total forward current as a sum of two components with different ideality factors:\n$$\nI(V)=I_1(V)+I_2(V),\\quad I_1(V)=I_{s1}\\,\\exp\\!\\left(\\frac{qV}{k_B T}\\right),\\quad I_2(V)=I_{s2}\\,\\exp\\!\\left(\\frac{qV}{2k_B T}\\right),\n$$\nwith $q$ the elementary charge and $k_B$ the Boltzmann constant. The first component $I_1$ is the diffusion current, which alone contributes to $Q$; the second component $I_2$ is the depletion-region recombination current, which does not contribute to $Q$.\n\nAssume low-level injection, negligible high-level effects, and that the small-signal diffusion capacitance arises only from the diffusion component via the quasi-static relation implied by the charge-control model. Using only these foundations, do the following:\n\n1) Starting from the definitions of $C_d$ and $g_d$ and the two-component current model, derive how the naive estimator $\\tau_T^{(\\text{naive})}\\equiv C_d/g_d$ relates to the true $\\tau_T$ when depletion-region recombination is present. Quantify the fractional error in $\\tau_T^{(\\text{naive})}$ in terms of quantities that are, in principle, measurable at a given bias.\n\n2) Eliminate any unmeasurable intermediate parameters to obtain a closed-form correction for $\\tau_T$ in terms of $C_d$, $g_d$, $I$, $T$, and fundamental constants only.\n\nProvide the final result as a single closed-form analytic expression for the corrected $\\tau_T$ in seconds, expressed solely in terms of $C_d$, $g_d$, $I$, $T$, $q$, and $k_B$. No numerical evaluation is required.",
            "solution": "The objective is to derive a corrected expression for the minority-carrier transit time $\\tau_T$ in a pn junction diode where the total current is composed of both a diffusion component and a depletion-region recombination component. The corrected expression must be in terms of experimentally measurable quantities.\n\nThe problem provides a two-component model for the total forward current $I$ as a function of the applied voltage $V$:\n$$\nI(V) = I_1(V) + I_2(V)\n$$\nwhere $I_1(V)$ is the diffusion current and $I_2(V)$ is the depletion-region recombination current. Their dependencies on voltage $V$ at temperature $T$ are given by:\n$$\nI_1(V) = I_{s1} \\exp\\left(\\frac{qV}{k_B T}\\right)\n$$\n$$\nI_2(V) = I_{s2} \\exp\\left(\\frac{qV}{2k_B T}\\right)\n$$\nHere, $q$ is the elementary charge and $k_B$ is the Boltzmann constant. It is convenient to define the thermal voltage $V_T = k_B T / q$. The expressions become:\n$$\nI_1(V) = I_{s1} \\exp\\left(\\frac{V}{V_T}\\right)\n$$\n$$\nI_2(V) = I_{s2} \\exp\\left(\\frac{V}{2V_T}\\right)\n$$\n\nThe total excess minority-carrier charge stored in the quasi-neutral regions, $Q(V)$, is associated only with the diffusion component of the current, $I_1(V)$, through the charge-control relation:\n$$\nQ(V) = \\tau_T I_1(V)\n$$\nwhere $\\tau_T$ is the true transit (storage) time, which is assumed to be constant with bias in this model.\n\nThe small-signal differential conductance, $g_d$, is defined as the derivative of the total current with respect to voltage:\n$$\ng_d(V) \\equiv \\frac{dI}{dV} = \\frac{dI_1}{dV} + \\frac{dI_2}{dV}\n$$\nCalculating the derivatives:\n$$\n\\frac{dI_1}{dV} = I_{s1} \\frac{d}{dV}\\exp\\left(\\frac{V}{V_T}\\right) = \\frac{1}{V_T} I_{s1} \\exp\\left(\\frac{V}{V_T}\\right) = \\frac{I_1(V)}{V_T}\n$$\n$$\n\\frac{dI_2}{dV} = I_{s2} \\frac{d}{dV}\\exp\\left(\\frac{V}{2V_T}\\right) = \\frac{1}{2V_T} I_{s2} \\exp\\left(\\frac{V}{2V_T}\\right) = \\frac{I_2(V)}{2V_T}\n$$\nSubstituting these into the expression for $g_d$ gives:\n$$\ng_d(V) = \\frac{I_1(V)}{V_T} + \\frac{I_2(V)}{2V_T}\n$$\n\nThe small-signal diffusion capacitance, $C_d$, is defined as the derivative of the stored charge with respect to voltage:\n$$\nC_d(V) \\equiv \\frac{dQ}{dV} = \\frac{d}{dV} \\left( \\tau_T I_1(V) \\right) = \\tau_T \\frac{dI_1}{dV}\n$$\nUsing the previously derived derivative of $I_1$:\n$$\nC_d(V) = \\tau_T \\frac{I_1(V)}{V_T}\n$$\n\nWith these expressions, we first address part 1 of the problem: finding the relationship between the naive estimator $\\tau_T^{(\\text{naive})} \\equiv C_d/g_d$ and the true $\\tau_T$.\n$$\n\\tau_T^{(\\text{naive})} = \\frac{C_d(V)}{g_d(V)} = \\frac{\\tau_T \\frac{I_1(V)}{V_T}}{\\frac{I_1(V)}{V_T} + \\frac{I_2(V)}{2V_T}}\n$$\nMultiplying the numerator and denominator by $2V_T$:\n$$\n\\tau_T^{(\\text{naive})} = \\frac{2\\tau_T I_1(V)}{2I_1(V) + I_2(V)} = \\tau_T \\left( \\frac{2I_1}{2I_1 + I_2} \\right)\n$$\nThis expression relates the measured naive transit time to the true transit time via the ratio of the current components. The fractional error in using the naive estimator is:\n$$\n\\text{Fractional Error} = \\frac{\\tau_T^{(\\text{naive})} - \\tau_T}{\\tau_T} = \\left( \\frac{2I_1}{2I_1 + I_2} \\right) - 1 = \\frac{2I_1 - (2I_1 + I_2)}{2I_1 + I_2} = -\\frac{I_2}{2I_1 + I_2}\n$$\nThis result, expressed in terms of the current components $I_1$ and $I_2$, satisfies the requirements of the first part of the problem.\n\nFor the second part of the problem, we must find a closed-form expression for the true transit time $\\tau_T$ in terms of the measurable quantities $C_d$, $g_d$, $I$, and $T$ (and fundamental constants). To do this, we must eliminate the unmeasurable intermediate parameters $I_1$ and $I_2$. We have a system of two linear equations for $I_1$ and $I_2$ at a given bias voltage $V$:\n$$\n(1) \\quad I = I_1 + I_2\n$$\n$$\n(2) \\quad g_d = \\frac{I_1}{V_T} + \\frac{I_2}{2V_T}\n$$\nFrom equation (1), we can write $I_2 = I - I_1$. Substituting this into equation (2):\n$$\ng_d = \\frac{I_1}{V_T} + \\frac{I - I_1}{2V_T} = \\frac{2I_1 + (I - I_1)}{2V_T} = \\frac{I_1 + I}{2V_T}\n$$\nNow we can solve this equation for $I_1$ in terms of measurable quantities:\n$$\n2V_T g_d = I_1 + I \\implies I_1 = 2V_T g_d - I\n$$\nWe have an expression for $C_d$ that contains $I_1$ and $\\tau_T$:\n$$\nC_d = \\tau_T \\frac{I_1}{V_T}\n$$\nWe can solve this for $\\tau_T$:\n$$\n\\tau_T = \\frac{C_d V_T}{I_1}\n$$\nNow, substitute the expression we found for $I_1$:\n$$\n\\tau_T = \\frac{C_d V_T}{2V_T g_d - I}\n$$\nFinally, we substitute the definition of the thermal voltage, $V_T = k_B T / q$:\n$$\n\\tau_T = \\frac{C_d \\left( \\frac{k_B T}{q} \\right)}{2 \\left( \\frac{k_B T}{q} \\right) g_d - I}\n$$\nTo simplify the expression and remove the fraction in the denominator, we multiply the numerator and the denominator by $q$:\n$$\n\\tau_T = \\frac{q C_d \\left( \\frac{k_B T}{q} \\right)}{q \\left( 2 \\frac{k_B T}{q} g_d - I \\right)} = \\frac{C_d k_B T}{2 k_B T g_d - qI}\n$$\nThis is the final closed-form expression for the corrected transit time $\\tau_T$ in seconds, expressed solely in terms of the specified measurable quantities ($C_d$, $g_d$, $I$, $T$) and fundamental constants ($q$, $k_B$).",
            "answer": "$$\\boxed{\\frac{k_B T C_d}{2 k_B T g_d - q I}}$$"
        },
        {
            "introduction": "To bridge the gap between analytical theory and modern device engineering, this practice guides you through the process of building a simple numerical device simulator from the ground up. You will discretize the minority-carrier continuity equation using the finite-difference method to compute the charge distribution, integrate to find the total stored charge, and numerically differentiate to obtain the diffusion capacitance. This hands-on computational exercise demystifies the workings of TCAD (Technology Computer-Aided Design) tools and provides a foundational understanding of how device characteristics are predicted from fundamental physical laws .",
            "id": "3739011",
            "problem": "You are asked to design and implement a complete numerical procedure, starting from first principles, to compute the diffusion (storage) capacitance under forward bias in the neutral $n$-region of a one-dimensional Silicon $p$–$n$ junction. The minority carrier is the hole, and the device is operated in steady-state low injection. Your program must discretize the governing equations using finite differences, solve the resulting linear system to obtain the minority hole excess concentration profile, integrate the stored charge, and then numerically differentiate with respect to the applied forward bias to obtain the diffusion capacitance. All physical quantities must be computed and reported in the International System of Units (SI).\n\nThe procedure must be built from the following base and assumptions:\n\n- Use the hole continuity equation in steady state, expressed in one dimension as $\\,\\dfrac{d J_p(x)}{dx} = q \\, \\left(G(x) - R(x)\\right)\\,$, with generation $G(x)=0$ in the neutral region under forward bias.\n- Use the diffusive hole current density $\\,J_p(x) = - q \\, D_p \\, \\dfrac{d p(x)}{dx}\\,$ in the neutral $n$-region, where $D_p$ is the hole diffusion coefficient and $p(x)$ is the hole concentration.\n- Use low-injection Shockley–Read–Hall (SRH) recombination in the neutral $n$-region, such that the recombination rate can be modeled as $\\,R(x) = \\dfrac{p'(x)}{\\tau_p}\\,$, where $p'(x) \\equiv p(x) - p_{n0}$ is the excess hole concentration over the equilibrium minority hole concentration $p_{n0}$, and $\\tau_p$ is the hole lifetime.\n- In the neutral $n$-region, neglect drift due to electric field and neglect generation, so that the governing ordinary differential equation is obtained by combining the above:\n  $$\\frac{d}{dx}\\!\\left(- q \\, D_p \\, \\frac{d p(x)}{dx}\\right) = - q \\, \\frac{p'(x)}{\\tau_p} \\quad \\Rightarrow \\quad \\frac{d^2 p'(x)}{dx^2} = \\frac{p'(x)}{L_p^2},$$\n  where $L_p \\equiv \\sqrt{D_p \\, \\tau_p}$ is the hole diffusion length.\n- Impose physically consistent boundary conditions:\n  - At the edge of the depletion region ($x=0$) on the $n$-side, the total hole concentration is set by quasi-equilibrium splitting as $\\,p(0) = p_{n0}\\,\\exp\\!\\left(\\frac{q V}{k_B T}\\right)\\,$ under low injection, where $V$ is the applied forward-bias voltage, $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $q$ is the elementary charge. Therefore the boundary excess is $\\,p'(0) = p_{n0}\\left[\\exp\\!\\left(\\frac{q V}{k_B T}\\right) - 1\\right]\\,$.\n  - At the ohmic contact at $x = W_n$, assume perfect recombination to equilibrium, so $\\,p'(W_n) = 0\\,$.\n- Compute the stored minority hole charge in the $n$-region,\n  $$Q_p(V) = q \\, A \\int_{0}^{W_n} p'(x;V)\\,dx,$$\n  where $A$ is the device cross-sectional area.\n- Compute the diffusion (storage) capacitance as the small-signal derivative with respect to $V$,\n  $$C_d(V) = \\frac{d Q_p(V)}{d V},$$\n  evaluated numerically by a symmetric finite difference using a small voltage increment $\\,\\Delta V\\,,$ i.e., $\\,C_d(V) \\approx \\dfrac{Q_p(V+\\Delta V) - Q_p(V-\\Delta V)}{2\\,\\Delta V}\\,$.\n\nNumerical requirements:\n\n- Discretize the domain $[0,W_n]$ into $N$ equally spaced nodes. Use a second-order central finite-difference scheme to approximate $\\,\\dfrac{d^2 p'(x)}{dx^2}\\,$ on interior nodes. Enforce the Dirichlet boundary conditions $\\,p'(0)$ and $\\,p'(W_n)$ at the endpoints. Solve the resulting banded linear system for $p'(x)$.\n- Integrate $p'(x)$ over $x \\in [0,W_n]$ using a numerically stable quadrature (e.g., the composite trapezoid rule).\n- Use a symmetric finite difference about $V$ with step $\\,\\Delta V\\,$ to approximate $\\,C_d(V)\\,$.\n\nPhysical constants to be used in all test cases:\n\n- Elementary charge $\\,q = 1.602176634 \\times 10^{-19}\\,$ Coulomb.\n- Boltzmann constant $\\,k_B = 1.380649 \\times 10^{-23}\\,$ Joule per Kelvin.\n- Temperature $\\,T = 300\\,$ Kelvin.\n\nImplement the program to handle the following test suite (each test case is a tuple of parameters $(N_D, n_i, D_p, \\tau_p, W_n, A, V, \\Delta V)$):\n\n- Test case $1$ (general forward bias, diffusion length comparable to region): $\\,N_D = 1.0\\times 10^{22}\\,$ $\\mathrm{m}^{-3}$, $\\,n_i = 1.08\\times 10^{16}\\,$ $\\mathrm{m}^{-3}$, $\\,D_p = 2.0\\times 10^{-3}\\,$ $\\mathrm{m}^2/\\mathrm{s}$, $\\,\\tau_p = 1.0\\times 10^{-6}\\,$ $\\mathrm{s}$, $\\,W_n = 5.0\\times 10^{-5}\\,$ $\\mathrm{m}$, $\\,A = 1.0\\times 10^{-8}\\,$ $\\mathrm{m}^2$, $\\,V = 0.6\\,$ $\\mathrm{V}$, $\\,\\Delta V = 1.0\\times 10^{-3}\\,$ $\\mathrm{V}$.\n- Test case $2$ (near-zero forward bias): $\\,N_D = 1.0\\times 10^{22}\\,$ $\\mathrm{m}^{-3}$, $\\,n_i = 1.08\\times 10^{16}\\,$ $\\mathrm{m}^{-3}$, $\\,D_p = 2.0\\times 10^{-3}\\,$ $\\mathrm{m}^2/\\mathrm{s}$, $\\,\\tau_p = 1.0\\times 10^{-6}\\,$ $\\mathrm{s}$, $\\,W_n = 5.0\\times 10^{-5}\\,$ $\\mathrm{m}$, $\\,A = 1.0\\times 10^{-8}\\,$ $\\mathrm{m}^2$, $\\,V = 0.01\\,$ $\\mathrm{V}$, $\\,\\Delta V = 1.0\\times 10^{-3}\\,$ $\\mathrm{V}$.\n- Test case $3$ (short neutral region dominated by boundary condition): $\\,N_D = 1.0\\times 10^{22}\\,$ $\\mathrm{m}^{-3}$, $\\,n_i = 1.08\\times 10^{16}\\,$ $\\mathrm{m}^{-3}$, $\\,D_p = 2.0\\times 10^{-3}\\,$ $\\mathrm{m}^2/\\mathrm{s}$, $\\,\\tau_p = 1.0\\times 10^{-6}\\,$ $\\mathrm{s}$, $\\,W_n = 5.0\\times 10^{-6}\\,$ $\\mathrm{m}$, $\\,A = 1.0\\times 10^{-8}\\,$ $\\mathrm{m}^2$, $\\,V = 0.6\\,$ $\\mathrm{V}$, $\\,\\Delta V = 1.0\\times 10^{-3}\\,$ $\\mathrm{V}$.\n- Test case $4$ (higher donor density reducing minority injection level): $\\,N_D = 5.0\\times 10^{22}\\,$ $\\mathrm{m}^{-3}$, $\\,n_i = 1.08\\times 10^{16}\\,$ $\\mathrm{m}^{-3}$, $\\,D_p = 2.0\\times 10^{-3}\\,$ $\\mathrm{m}^2/\\mathrm{s}$, $\\,\\tau_p = 1.0\\times 10^{-6}\\,$ $\\mathrm{s}$, $\\,W_n = 5.0\\times 10^{-5}\\,$ $\\mathrm{m}$, $\\,A = 1.0\\times 10^{-8}\\,$ $\\mathrm{m}^2$, $\\,V = 0.6\\,$ $\\mathrm{V}$, $\\,\\Delta V = 1.0\\times 10^{-3}\\,$ $\\mathrm{V}$.\n\nFor each test case:\n\n- Compute $\\,p_{n0} = \\dfrac{n_i^2}{N_D}\\,$.\n- Compute the boundary excess $\\,p'(0) = p_{n0}\\left[\\exp\\!\\left(\\dfrac{q V}{k_B T}\\right) - 1\\right]\\,$.\n- Solve the discrete system to obtain $\\,p'(x)\\,$ over $[0,W_n]$.\n- Compute $\\,Q_p(V)\\,$ in Coulombs and $\\,C_d(V)\\,$ in Farads.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be a flat list of floating-point numbers in SI units, alternating $Q_p$ and $C_d$ for each test case, in the same order as the test suite. For example, the output format must be of the form $\\,\\left[Q_1, C_1, Q_2, C_2, Q_3, C_3, Q_4, C_4\\right]\\,$, where $Q_i$ is in Coulombs and $C_i$ is in Farads for test case $i$.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in established semiconductor physics, well-posed, objective, and internally consistent. It presents a standard problem in computational device modeling with all necessary physical parameters and a clear set of instructions for the numerical methodology. The task is to design a numerical procedure to calculate the stored minority carrier charge and diffusion capacitance in a p-n junction. This will be accomplished by following the prescribed steps: discretizing the minority carrier diffusion equation, solving the resulting linear system, and using numerical integration and differentiation.\n\nThe fundamental governing equation for the excess minority hole concentration, $p'(x)$, in the neutral $n$-region under steady-state, low-injection conditions is the one-dimensional diffusion equation:\n$$\n\\frac{d^2 p'(x)}{dx^2} - \\frac{p'(x)}{L_p^2} = 0\n$$\nwhere $L_p = \\sqrt{D_p \\tau_p}$ is the minority carrier (hole) diffusion length, with $D_p$ being the hole diffusion coefficient and $\\tau_p$ the hole lifetime. The spatial domain is $x \\in [0, W_n]$, where $x=0$ is the edge of the depletion region and $x=W_n$ is the ohmic contact.\n\nThe boundary conditions are of the Dirichlet type:\n1.  At the depletion region edge ($x=0$): The excess hole concentration is governed by the law of the junction.\n    $$\n    p'(0) = p_{n0} \\left[ \\exp\\left(\\frac{qV}{k_B T}\\right) - 1 \\right]\n    $$\n    Here, $p_{n0} = n_i^2 / N_D$ is the equilibrium minority hole concentration, $V$ is the applied forward bias, $q$ is the elementary charge, $k_B$ is the Boltzmann constant, and $T$ is the temperature.\n2.  At the ohmic contact ($x=W_n$): Perfect recombination is assumed, leading to thermal equilibrium.\n    $$\n    p'(W_n) = 0\n    $$\n\nTo solve this boundary value problem numerically, we employ the finite difference method. The domain $[0, W_n]$ is discretized into $N$ equally spaced nodes $x_i = i \\cdot \\Delta x$ for $i=0, 1, \\dots, N-1$, where the step size is $\\Delta x = W_n / (N-1)$. The value of the function at each node is denoted $p'_i = p'(x_i)$. A value of $N=501$ is chosen for the numerical implementation to ensure sufficient accuracy.\n\nThe second derivative at an interior node $x_i$ (for $i=1, \\dots, N-2$) is approximated using a second-order central difference formula:\n$$\n\\frac{d^2 p'(x)}{dx^2}\\bigg|_{x_i} \\approx \\frac{p'_{i-1} - 2p'_i + p'_{i+1}}{(\\Delta x)^2}\n$$\nSubstituting this into the governing ODE yields a system of linear algebraic equations:\n$$\n\\frac{p'_{i-1} - 2p'_i + p'_{i+1}}{(\\Delta x)^2} - \\frac{p'_i}{L_p^2} = 0\n$$\nRearranging the terms for each interior node $i$ gives:\n$$\np'_{i-1} - \\left(2 + \\frac{(\\Delta x)^2}{L_p^2}\\right) p'_i + p'_{i+1} = 0\n$$\nThis forms a system of $N-2$ linear equations for the $N-2$ unknown interior nodal values $\\{p'_1, p'_2, \\dots, p'_{N-2}\\}$. The boundary values $p'_0$ and $p'_{N-1}$ are known. The equation for the first interior node ($i=1$) is:\n$$\np'_{0} - \\left(2 + \\frac{(\\Delta x)^2}{L_p^2}\\right) p'_1 + p'_{2} = 0\n$$\nSince $p'_0$ is a known boundary value, this term is moved to the right-hand side. The equation for the last interior node ($i=N-2$) is:\n$$\np'_{N-3} - \\left(2 + \\frac{(\\Delta x)^2}{L_p^2}\\right) p'_{N-2} + p'_{N-1} = 0\n$$\nSince $p'_{N-1} = p'(W_n) = 0$, this term vanishes. The resulting system is a tridiagonal matrix equation, $\\mathbf{M} \\mathbf{p'} = \\mathbf{b}$, where $\\mathbf{p'} = [p'_1, \\dots, p'_{N-2}]^T$. The matrix $\\mathbf{M}$ has the constant value $-\\left(2 + (\\Delta x)^2/L_p^2\\right)$ on its main diagonal, and $1$ on its super- and sub-diagonals. The right-hand side vector $\\mathbf{b}$ is zero everywhere except for its first element, which is $b_1 = -p'_0$. This tridiagonal system is efficiently solved to find the excess hole concentration profile $p'(x)$.\n\nOnce the discrete profile $p'_i$ is computed for all $i=0, \\dots, N-1$, the total stored minority charge $Q_p(V)$ in the neutral $n$-region is calculated by numerically integrating $q A p'(x)$ over the domain. Using the composite trapezoid rule:\n$$\nQ_p(V) = q A \\int_{0}^{W_n} p'(x; V) dx \\approx q A \\cdot \\Delta x \\left( \\frac{p'_0 + p'_{N-1}}{2} + \\sum_{i=1}^{N-2} p'_i \\right)\n$$\nThis calculation is encapsulated in a function that takes the applied voltage $V$ as an input.\n\nFinally, the diffusion capacitance $C_d(V)$ is defined as the derivative of the stored charge with respect to voltage, $C_d(V) = dQ_p/dV$. This is approximated numerically using a second-order symmetric finite difference formula with a small voltage perturbation $\\Delta V$:\n$$\nC_d(V) \\approx \\frac{Q_p(V+\\Delta V) - Q_p(V-\\Delta V)}{2 \\Delta V}\n$$\nTo compute this, the entire procedure of calculating the stored charge $Q_p$ is executed twice: once for a voltage $V+\\Delta V$ and once for $V-\\Delta V$. The requested values are $Q_p(V)$ at the specified voltage and $C_d(V)$ around that voltage. The procedure will compute $Q_p(V)$, $Q_p(V+\\Delta V)$, and $Q_p(V-\\Delta V)$ to find the required outputs.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the calculation for all test cases and print the results.\n    \"\"\"\n\n    # Physical constants\n    Q = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23     # Boltzmann constant in J/K\n    T = 300.0            # Temperature in K\n\n    # Number of discretization points for the finite difference method\n    N_NODES = 501\n\n    # Test cases as tuples of (N_D, n_i, D_p, tau_p, W_n, A, V, dV)\n    # Units are SI: m^-3, m^-3, m^2/s, s, m, m^2, V, V\n    test_cases = [\n        # (ND,       ni,        Dp,        tau_p,      Wn,        A,          V,   dV)\n        (1.0e22, 1.08e16, 2.0e-3, 1.0e-6, 5.0e-5, 1.0e-8, 0.6, 1.0e-3),\n        (1.0e22, 1.08e16, 2.0e-3, 1.0e-6, 5.0e-5, 1.0e-8, 0.01, 1.0e-3),\n        (1.0e22, 1.08e16, 2.0e-3, 1.0e-6, 5.0e-6, 1.0e-8, 0.6, 1.0e-3),\n        (5.0e22, 1.08e16, 2.0e-3, 1.0e-6, 5.0e-5, 1.0e-8, 0.6, 1.0e-3),\n    ]\n\n    def calculate_stored_charge(params, V_applied):\n        \"\"\"\n        Calculates the stored minority charge Q_p for a given set of parameters and applied voltage.\n        \n        Args:\n            params (tuple): A tuple containing the device parameters.\n            V_applied (float): The forward bias voltage in Volts.\n\n        Returns:\n            float: The total stored minority charge Q_p in Coulombs.\n        \"\"\"\n        ND, ni, Dp, tau_p, Wn, A, _, _ = params\n        \n        # 1. Calculate intermediate physical parameters\n        Lp = np.sqrt(Dp * tau_p)\n        p_n0 = ni**2 / ND\n        V_thermal = KB * T / Q\n        \n        # 2. Boundary condition at x=0\n        p_prime_0 = p_n0 * (np.exp(V_applied / V_thermal) - 1.0)\n        \n        # 3. Discretize the domain\n        x_grid = np.linspace(0, Wn, N_NODES)\n        dx = Wn / (N_NODES - 1)\n        \n        # 4. Set up the tridiagonal linear system M*p' = b for interior nodes\n        num_interior_nodes = N_NODES - 2\n        \n        # The system is for the vector of unknowns [p'_1, p'_2, ..., p'_{N-2}]\n        # M is a tridiagonal matrix. We construct it in the banded format required by SciPy.\n        # ab is a (3, num_interior_nodes) array for a tridiagonal matrix\n        # ab[0, 1:] is the upper diagonal (1s)\n        # ab[1, :] is the main diagonal (-2 - (dx/Lp)^2)\n        # ab[2, :-1] is the lower diagonal (1s)\n        ab = np.zeros((3, num_interior_nodes))\n        \n        main_diag_val = -(2.0 + (dx**2) / (Lp**2))\n        \n        ab[0, 1:] = 1.0  # Upper diagonal\n        ab[1, :] = main_diag_val # Main diagonal\n        ab[2, :-1] = 1.0 # Lower diagonal\n        \n        # 5. Set up the right-hand side vector b\n        b = np.zeros(num_interior_nodes)\n        b[0] = -p_prime_0  # From the boundary condition at x=0\n        \n        # 6. Solve the linear system for interior nodes\n        p_prime_interior = solve_banded((1, 1), ab, b)\n        \n        # 7. Reconstruct the full profile p'(x) including boundaries\n        p_prime_profile = np.zeros(N_NODES)\n        p_prime_profile[0] = p_prime_0\n        p_prime_profile[1:-1] = p_prime_interior\n        p_prime_profile[-1] = 0.0 # Boundary condition p'(Wn) = 0\n        \n        # 8. Integrate using trapezoid rule to find total stored charge\n        stored_charge_density_integral = np.trapz(p_prime_profile, x_grid)\n        Qp = Q * A * stored_charge_density_integral\n        \n        return Qp\n\n    results = []\n    for case in test_cases:\n        _, _, _, _, _, _, V, dV = case\n        \n        # Calculate Qp at the central voltage V\n        Qp_at_V = calculate_stored_charge(case, V)\n        \n        # Calculate Qp at V + dV and V - dV for the capacitance\n        Qp_plus = calculate_stored_charge(case, V + dV)\n        Qp_minus = calculate_stored_charge(case, V - dV)\n        \n        # Calculate diffusion capacitance using a symmetric finite difference\n        Cd = (Qp_plus - Qp_minus) / (2.0 * dV)\n        \n        results.append(Qp_at_V)\n        results.append(Cd)\n\n    # Format the output string as required by the problem statement\n    output_str = f\"[{','.join(f'{r:.6e}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}