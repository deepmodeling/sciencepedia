{
    "hands_on_practices": [
        {
            "introduction": "XRD分析的基础在于将晶体的原子排布与其衍射图谱联系起来。本练习  将引导您完成金刚石立方晶格结构因子的基本计算。通过分析晶胞内原子如何引起波的干涉，您将推导出选择定则，并理解衍射峰强度变化的物理基础。",
            "id": "4312695",
            "problem": "在空间群为 $Fd\\bar{3}m$、晶格常数为 $a$ 的金刚石晶体的X射线衍射 (XRD) 中，该晶体可以表示为一个面心立方 (fcc) 布拉菲晶格，其原胞基元包含两个相同的原子，相对于常规立方晶胞的分数坐标分别为 $\\mathbf{d}_{1} = (0,0,0)$ 和 $\\mathbf{d}_{2} = \\left(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4}\\right)$。考虑使用铜 $\\mathrm{K}\\alpha$ 辐射进行粉末测量，并将原子形状因子 $f(Q)$ 视为一个仅依赖于散射矢量大小 $Q = |\\mathbf{G}|$ 的标量，其中 $\\mathbf{G}$ 是与米勒指数 $(hkl)$ 相关的倒易晶格矢量。结构因子 $F(\\mathbf{G})$ 由基本表达式定义\n$$\nF(\\mathbf{G}) = \\sum_{n} f_{n}(Q) \\exp\\!\\left(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{r}_{n}\\right),\n$$\n其中求和遍及常规晶胞内所有位置为 $\\mathbf{r}_{n} = \\mathbf{t}_{\\alpha} + \\mathbf{d}_{\\beta}$ 的原子，$\\mathbf{t}_{\\alpha}$ 为fcc布拉菲平移矢量 $\\mathbf{t}_{0} = (0,0,0)$、$\\mathbf{t}_{1} = \\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$、$\\mathbf{t}_{2} = \\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$ 和 $\\mathbf{t}_{3} = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$，$\\mathbf{d}_{\\beta} \\in \\{\\mathbf{d}_{1}, \\mathbf{d}_{2}\\}$ 如上所述。假设两个基元原子相同（例如，硅），因此 $f_{1}(Q) = f_{2}(Q) = f(Q)$，忽略热运动和消光，并忽略洛伦兹-偏振和吸收效应。\n\n(a) 从上述定义和面心立方 (fcc) 平移出发，推导金刚石基元的结构因子 $F(hkl)$ 的闭式表达式，然后将其特化到 $(111)$ 的情况，以获得用 $f(Q)$ 表示的显式复振幅。\n\n(b) 使用推导出的振幅，通过将结构因子模的平方与立方晶体中各晶面族的多重度 $m_{hkl}$ 相结合，计算粉末强度比 $I_{111}/I_{220}$。对于立方晶系多重度，使用 $m_{111} = 8$ 和 $m_{220} = 12$。为了考虑原子形状因子随 $Q$ 增大的衰减，使用以下在铜 $\\mathrm{K}\\alpha$ 辐射下硅的相应散射矢量处的经验合理值：$f_{111} = 13.6$（单位为电子）和 $f_{220} = 12.2$（单位为电子），其中 $f_{hkl}$ 表示在 $(hkl)$ 对应的 $Q$ 值处计算的 $f(Q)$。\n\n除了计算之外，请参考金刚石基元干涉和多重度，定性解释为什么在金刚石结构中 $(111)$ 衍射相对于 $(220)$ 衍射较弱。最后，提供 $I_{111}/I_{220}$ 的数值，并将答案四舍五入到 $3$ 位有效数字。将最终强度比表示为纯小数（无量纲）。",
            "solution": "问题要求推导金刚石立方晶格的结构因子，将其应用于 $(111)$ 和 $(220)$ 衍射，定性解释它们的相对强度，并计算粉末强度比 $I_{111}/I_{220}$。\n\n(a) 结构因子 $F(hkl)$ 和 $F(111)$ 的推导\n\n晶体的结构因子 $F(\\mathbf{G})$ 定义为对一个常规晶胞内所有原子的求和。原子 $n$ 的位置由 $\\mathbf{r}_{n}$ 给出。\n$$\nF(\\mathbf{G}) = \\sum_{n} f_{n}(Q) \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{r}_{n})\n$$\n对于金刚石晶格，原子是相同的，所以 $f_n(Q) = f(Q)$。原子位置 $\\mathbf{r}_n$ 被指定为 $\\mathbf{r}_{n} = \\mathbf{t}_{\\alpha} + \\mathbf{d}_{\\beta}$，其中 $\\mathbf{t}_{\\alpha}$ 是面心立方 (fcc) 晶格平移，$\\mathbf{d}_{\\beta}$ 是基元矢量位置。该求和可以分解为一个对基元矢量的求和与一个对晶格点的求和的乘积：\n$$\nF(\\mathbf{G}) = f(Q) \\sum_{\\beta} \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{d}_{\\beta}) \\sum_{\\alpha} \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{t}_{\\alpha})\n$$\n这可以写成 $F(\\mathbf{G}) = f(Q) S_{\\text{basis}} S_{\\text{lattice}}$。\n\n对于晶格常数为 $a$ 的立方晶格，与米勒指数 $(hkl)$ 对应的倒易晶格矢量为 $\\mathbf{G} = \\frac{2\\pi}{a}(h, k, l)$。位置矢量 $\\mathbf{r}$ 以常规晶胞轴的分数坐标给出，$\\mathbf{r} = a(u, v, w)$。指数项中的点积为：\n$$\n\\mathbf{G} \\cdot \\mathbf{r} = \\frac{2\\pi}{a}(h, k, l) \\cdot a(u, v, w) = 2\\pi (hu + kv + lw)\n$$\n首先，我们计算fcc平移矢量 $\\mathbf{t}_{0}=(0,0,0)$、$\\mathbf{t}_{1}=\\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$、$\\mathbf{t}_{2}=\\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$ 和 $\\mathbf{t}_{3}=\\left(\\frac{1}{2},\\frac{1}{2},0\\right)$ 的晶格和 $S_{\\text{lattice}}$。\n$$\nS_{\\text{lattice}} = \\sum_{\\alpha=0}^{3} \\exp(2\\pi i (h u_{\\alpha} + k v_{\\alpha} + l w_{\\alpha}))\n$$\n$$\nS_{\\text{lattice}} = \\exp(0) + \\exp\\left(2\\pi i \\left(k\\frac{1}{2} + l\\frac{1}{2}\\right)\\right) + \\exp\\left(2\\pi i \\left(h\\frac{1}{2} + l\\frac{1}{2}\\right)\\right) + \\exp\\left(2\\pi i \\left(h\\frac{1}{2} + k\\frac{1}{2}\\right)\\right)\n$$\n$$\nS_{\\text{lattice}} = 1 + \\exp(\\pi i (k+l)) + \\exp(\\pi i (h+l)) + \\exp(\\pi i (h+k))\n$$\n由于对整数 $n$ 有 $\\exp(\\pi i n) = (-1)^n$，所以只有当指数 $h,k,l$ 的奇偶性相同（同为偶数或同为奇数）时，这个和才非零。在这种情况下，$k+l$、$h+l$ 和 $h+k$ 均为偶数，且 $S_{\\text{lattice}} = 1+1+1+1=4$。如果奇偶性混合，则和为 $0$。这就是著名的fcc布拉菲晶格的选择定则。\n\n接下来，我们计算位于 $\\mathbf{d}_{1}=(0,0,0)$ 和 $\\mathbf{d}_{2}=\\left(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4}\\right)$ 的双原子基元的基元结构因子 $S_{\\text{basis}}$。\n$$\nS_{\\text{basis}} = \\sum_{\\beta=1}^{2} \\exp(2\\pi i (h u_{\\beta} + k v_{\\beta} + l w_{\\beta}))\n$$\n$$\nS_{\\text{basis}} = \\exp(0) + \\exp\\left(2\\pi i \\left(h\\frac{1}{4} + k\\frac{1}{4} + l\\frac{1}{4}\\right)\\right)\n$$\n$$\nS_{\\text{basis}} = 1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\n$$\n综合这些结果，金刚石立方晶格的结构因子为：\n$$\nF(hkl) = f(Q) \\left[1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\\right] \\left[1 + \\exp(\\pi i (k+l)) + \\exp(\\pi i (h+l)) + \\exp(\\pi i (h+k))\\right]\n$$\n这可以根据选择定则进行简化。对于非零衍射，$h,k,l$ 必须同为偶数或同为奇数，此时 $S_{\\text{lattice}}=4$。因此，对于允许的衍射：\n$$\nF(hkl) = 4f(Q)\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\\right]\n$$\n我们还必须考虑来自 $S_{\\text{basis}}$ 的条件。如果 $h,k,l$ 均为偶数，则 $h+k+l$ 是一个偶数。设 $h+k+l = S$。\n如果 $S=4n$（例如，对于 $(220)$，$S=4$），则 $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2} (4n)) = 1+1=2$。因此 $F_{hkl} = 8f(Q)$。\n如果 $S=4n+2$（例如，对于 $(200)$，$S=2$），则 $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2} (4n+2)) = 1+\\exp(\\pi i) = 1-1=0$。因此 $F_{hkl} = 0$。这就是金刚石滑移消光定则。\n如果 $h,k,l$ 均为奇数，则 $h+k+l$ 是一个奇数，$S=2n+1$。那么 $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2}(2n+1)) = 1 \\pm i$。所以 $|S_{\\text{basis}}|^2=2$。\n总之，金刚石立方结构所允许的衍射 $(hkl)$ 是那些 $h,k,l$ 全为奇数，或者全为偶数且其和 $h+k+l=4n$ 的衍射。\n\n对于 $(hkl)=(111)$ 的特定情况：\n指数均为奇数。$h+k+l=1+1+1=3$。fcc条件得到满足。\n$$\nF(111) = 4f_{111}\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(3)\\right)\\right] = 4f_{111}\\left[1 + \\exp\\left(\\frac{3\\pi i}{2}\\right)\\right]\n$$\n由于 $\\exp\\left(\\frac{3\\pi i}{2}\\right) = \\cos(\\frac{3\\pi}{2}) + i\\sin(\\frac{3\\pi}{2}) = 0 - i = -i$，复振幅为：\n$$\nF(111) = 4f_{111}(1-i)\n$$\n\n(b) 强度比 $I_{111}/I_{220}$ 和定性解释\n\n首先，我们求 $(220)$ 衍射的结构因子。指数均为偶数，其和为 $h+k+l = 2+2+0=4$。这是 $4n$ 的形式（$n=1$），因此该衍射是允许的。\n$$\nF(220) = 4f_{220}\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(4)\\right)\\right] = 4f_{220}[1 + \\exp(2\\pi i)]\n$$\n由于 $\\exp(2\\pi i) = 1$，振幅为：\n$$\nF(220) = 4f_{220}(1+1) = 8f_{220}\n$$\n粉末衍射峰的强度与晶面族的多重度 $m_{hkl}$ 和结构因子模的平方 $|F(hkl)|^2$ 成正比。\n$$\nI_{hkl} \\propto m_{hkl} |F(hkl)|^2\n$$\n模的平方为：\n$$\n|F(111)|^2 = |4f_{111}(1-i)|^2 = (4f_{111})^2 |1-i|^2 = 16f_{111}^2 (1^2 + (-1)^2) = 32f_{111}^2\n$$\n$$\n|F(220)|^2 = |8f_{220}|^2 = 64f_{220}^2\n$$\n强度比为：\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{m_{111} |F(111)|^2}{m_{220} |F(220)|^2} = \\frac{8 \\times 32f_{111}^2}{12 \\times 64f_{220}^2}\n$$\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{256}{768} \\frac{f_{111}^2}{f_{220}^2} = \\frac{1}{3} \\left(\\frac{f_{111}}{f_{220}}\\right)^2\n$$\n\n定性地看，$(111)$ 衍射相对于 $(220)$ 衍射较弱，主要有两个因素：基元原子的干涉和多重度，而原子形状因子的作用部分抵消了这一效应。\n1.  基元干涉：$|S_{\\text{basis}}|^2$ 项反映了基元中两个原子散射波之间的干涉。对于 $(111)$ 衍射，位于 $(0,0,0)$ 和 $(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4})$ 的原子之间的相位差为 $\\frac{\\pi}{2}(1+1+1) = \\frac{3\\pi}{2}$。振幅相加为 $1+\\exp(i3\\pi/2) = 1-i$，导致 $|S_{\\text{basis}}|^2=2$（部分相消干涉）。对于 $(220)$ 衍射，相位差为 $\\frac{\\pi}{2}(2+2+0) = 2\\pi$。振幅相加为 $1+\\exp(i2\\pi) = 2$，导致 $|S_{\\text{basis}}|^2=4$（完全相长干涉）。仅此因素就使得 $(220)$ 衍射的 $|F|^2$ 贡献是 $(111)$ 衍射的两倍。\n2.  多重度：$\\{220\\}$ 晶面族的多重度为 $m_{220}=12$，而 $\\{111\\}$ 晶面族的多重度为 $m_{111}=8$。这意味着对 $(220)$ 粉末峰有贡献的晶面数量是 $(111)$ 峰的 1.5 倍，进一步增强了其相对于 $(111)$ 峰的强度。\n3.  原子形状因子：形状因子 $f(Q)$ 随着散射矢量大小 $Q$ 的增加而减小。由于 $Q \\propto \\sqrt{h^2+k^2+l^2}$，$Q_{220} (\\propto \\sqrt{8})$ 大于 $Q_{111} (\\propto \\sqrt{3})$。因此，$f_{220}  f_{111}$。这种效应倾向于降低 $(220)$ 衍射相对于 $(111)$ 的强度，但它不足以克服基元干涉和多重度的综合效应。\n\n现在，我们使用给定的数据计算数值：$m_{111}=8$、$m_{220}=12$、$f_{111}=13.6$ 和 $f_{220}=12.2$。\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{1}{3} \\left(\\frac{13.6}{12.2}\\right)^2 \\approx \\frac{1}{3} (1.11475)^2 \\approx \\frac{1}{3} (1.24268) \\approx 0.414227\n$$\n四舍五入到 $3$ 位有效数字，强度比为 $0.414$。",
            "answer": "$$\n\\boxed{0.414}\n$$"
        },
        {
            "introduction": "真实的晶体并非静态，原子会因热能而在其平衡位置附近振动。本练习  将通过德拜-瓦勒因子深入探讨这些热振动如何影响衍射强度。通过从第一性原理推导该因子，您将对温度如何抑制布拉格衍射获得定量的理解，这是精确强度分析中的一个关键概念。",
            "id": "4312752",
            "problem": "考虑一个用于纳米电子器件的单原子晶体薄膜，在运动学（单次散射）近似下通过X射线衍射（XRD）进行分析。在温度 $T$ 下的运动学结构因子定义为\n$$\nF(T,\\mathbf{G}) \\equiv \\sum_{j} f_{j} \\left\\langle \\exp\\!\\big(i\\,\\mathbf{G}\\cdot[\\mathbf{R}_{j}+\\mathbf{u}_{j}]\\big) \\right\\rangle,\n$$\n其中 $f_{j}$ 是原子 $j$ 的原子散射因子，$\\mathbf{R}_{j}$ 是平衡晶格位置，$\\mathbf{u}_{j}$ 是热致位移，$\\mathbf{G}$ 是一个倒易晶格矢量，$\\langle \\cdot \\rangle$ 表示热系综平均。假设：\n- 位移 $\\mathbf{u}_{j}$ 是由谐振动产生的独立同分布、零均值的高斯随机矢量，其各向同性协方差对于每个笛卡尔分量 $\\alpha,\\beta \\in \\{x,y,z\\}$ 为 $\\langle u_{\\alpha} u_{\\beta} \\rangle = \\sigma^{2}\\,\\delta_{\\alpha\\beta}$。\n- 所有原子均为同一类型，具有相同的 $f_{j}=f$ 和相同的位移统计特性。\n- 对于所考虑的 $\\mathbf{G}$，在布拉格衍射条件的尺度上，不同原子位移之间的相关性可以忽略不计。\n\n从上述定义和这些假设出发，推导热运动如何通过一个形式为 $\\exp\\!\\big(-B|\\mathbf{G}|^{2}/4\\big)$ 的乘性德拜-瓦勒因子来修正结构因子 $F$，并明确地用单轴均方位移 $\\sigma^{2}$ 来表示 $B$。然后，使用您的结果确定相对衍射强度\n$$\n\\frac{I(T,\\mathbf{G})}{I_{0}(\\mathbf{G})},\n$$\n其中 $I(T,\\mathbf{G}) \\propto |F(T,\\mathbf{G})|^{2}$ 是有限温度下的强度，$I_{0}(\\mathbf{G}) \\propto |F(0,\\mathbf{G})|^{2}$ 是零温下的强度。计算当 $B = 1~\\text{\\AA}^{2}$ 和 $|\\mathbf{G}| = 5~\\text{\\AA}^{-1}$ 时此比率的值。将您的最终答案表示为一个纯数（无量纲），并将结果四舍五入到三位有效数字。如果出现角度，应以弧度表示，但最终答案不需要角度。",
            "solution": "本题要求我们首先验证其前提，若前提有效，则推导德拜-瓦勒因子的形式，并用它来计算相对X射线衍射强度。\n\n问题陈述的有效性验证如下：\n- **科学依据：** 该问题描述了晶格热振动下的X射线衍射，这是凝聚态物理中的一个核心概念。运动学结构因子、高斯位移模型和德拜-瓦勒因子都是标准且完善的理论工具。所有假设都具有物理动机，并且是该主题入门级处理的标准假设。\n- **适定性：** 问题提供了得出唯一解所需的所有定义、假设和数值。任务被明确指定。\n- **客观性：** 语言正式且无歧义。\n\n该问题被认为是有效的，因为它科学上合理、适定且客观。我们可以继续进行求解。\n\n在有限温度 $T$ 下的运动学结构因子由下式给出：\n$$\nF(T,\\mathbf{G}) = \\sum_{j} f_{j} \\left\\langle \\exp\\!\\big(i\\,\\mathbf{G}\\cdot[\\mathbf{R}_{j}+\\mathbf{u}_{j}]\\big) \\right\\rangle\n$$\n此处，$\\mathbf{R}_{j}$ 是原子 $j$ 的平衡位置，相对于热平均 $\\langle \\cdot \\rangle$ 是一个常数。对于给定的原子类型，原子散射因子 $f_{j}$ 也是常数。我们可以重写指数项，并将非随机部分移到平均符号之外：\n$$\nF(T,\\mathbf{G}) = \\sum_{j} f_{j} \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{R}_{j}) \\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}_{j}) \\right\\rangle\n$$\n问题指出所有原子都是同一类型，因此 $f_{j} = f$。它还指出原子位移 $\\mathbf{u}_{j}$ 是独立同分布的（i.i.d.）。这意味着对于所有原子 $j$，热平均 $\\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}_{j}) \\right\\rangle$ 是相同的。因此，我们可以将此项从求和中提出来：\n$$\nF(T,\\mathbf{G}) = \\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle \\sum_{j} f \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{R}_{j})\n$$\n其中 $\\mathbf{u}$ 代表任何一个代表性原子的位移。求和项 $\\sum_{j} f \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{R}_{j})$ 是刚性晶格的结构因子，对应于所有 $\\mathbf{u}_{j} = \\mathbf{0}$ 的零温情况。我们将其表示为 $F(0,\\mathbf{G})$。\n$$\nF(T,\\mathbf{G}) = F(0,\\mathbf{G}) \\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle\n$$\n乘性因子 $\\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle$ 就是德拜-瓦勒因子。为了计算它，我们使用 $\\mathbf{u}$ 是零均值高斯随机矢量的假设。项 $\\mathbf{G}\\cdot\\mathbf{u}$ 是一个标量随机变量，我们可以称之为 $X$。由于 $X$ 是高斯矢量分量的线性组合，因此 $X$ 本身也是一个高斯随机变量。\n\n$X$ 的均值是：\n$$\n\\langle X \\rangle = \\langle \\mathbf{G}\\cdot\\mathbf{u} \\rangle = \\mathbf{G} \\cdot \\langle \\mathbf{u} \\rangle = \\mathbf{G} \\cdot \\mathbf{0} = 0\n$$\n$X$ 的方差是 $\\sigma_X^2 = \\langle X^2 \\rangle - \\langle X \\rangle^2 = \\langle (\\mathbf{G}\\cdot\\mathbf{u})^2 \\rangle$。我们在笛卡尔坐标系中展开此点积：\n$$\n\\langle (\\mathbf{G}\\cdot\\mathbf{u})^2 \\rangle = \\left\\langle \\left( \\sum_{\\alpha=x,y,z} G_{\\alpha} u_{\\alpha} \\right) \\left( \\sum_{\\beta=x,y,z} G_{\\beta} u_{\\beta} \\right) \\right\\rangle = \\sum_{\\alpha,\\beta} G_{\\alpha} G_{\\beta} \\langle u_{\\alpha} u_{\\beta} \\rangle\n$$\n使用给定的各向同性协方差 $\\langle u_{\\alpha} u_{\\beta} \\rangle = \\sigma^{2}\\,\\delta_{\\alpha\\beta}$，其中 $\\sigma^2$ 是单轴均方位移：\n$$\n\\langle (\\mathbf{G}\\cdot\\mathbf{u})^2 \\rangle = \\sum_{\\alpha,\\beta} G_{\\alpha} G_{\\beta} \\sigma^{2} \\delta_{\\alpha\\beta} = \\sigma^{2} \\sum_{\\alpha} G_{\\alpha}^2 = \\sigma^{2} |\\mathbf{G}|^2\n$$\n对于一个零均值高斯随机变量 $X$，其在 $t=1$ 处的特征函数为 $\\langle \\exp(iX) \\rangle = \\exp(-\\frac{1}{2}\\langle X^2 \\rangle)$。将此应用于 $X = \\mathbf{G}\\cdot\\mathbf{u}$：\n$$\n\\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle = \\exp\\left(-\\frac{1}{2}\\langle (\\mathbf{G}\\cdot\\mathbf{u})^2 \\rangle\\right) = \\exp\\left(-\\frac{1}{2}\\sigma^2 |\\mathbf{G}|^2\\right)\n$$\n问题指定该德拜-瓦勒因子的形式为 $\\exp(-B|\\mathbf{G}|^{2}/4)$。通过将我们推导出的结果与此形式进行比较，我们可以确定参数 $B$：\n$$\n\\exp\\left(-\\frac{1}{2}\\sigma^2 |\\mathbf{G}|^2\\right) = \\exp\\left(-\\frac{B|\\mathbf{G}|^2}{4}\\right)\n$$\n令指数相等，我们得到：\n$$\n\\frac{1}{2}\\sigma^2 = \\frac{B}{4} \\implies B = 2\\sigma^2\n$$\n这就完成了问题的第一部分。\n\n接下来，我们确定相对衍射强度 $I(T,\\mathbf{G})/I_{0}(\\mathbf{G})$。强度与结构因子的模的平方成正比，即 $I \\propto |F|^2$。\n$$\nI(T,\\mathbf{G}) \\propto |F(T,\\mathbf{G})|^2 = |F(0,\\mathbf{G}) \\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle|^2 = |F(0,\\mathbf{G})|^2 |\\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle|^2\n$$\n零温强度为 $I_{0}(\\mathbf{G}) \\propto |F(0,\\mathbf{G})|^2$。假设比例常数相同，则该比率为：\n$$\n\\frac{I(T,\\mathbf{G})}{I_{0}(\\mathbf{G})} = |\\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle|^2\n$$\n代入以 $B$ 表示的德拜-瓦勒因子表达式：\n$$\n\\left\\langle \\exp(i\\,\\mathbf{G}\\cdot\\mathbf{u}) \\right\\rangle = \\exp\\left(-\\frac{B|\\mathbf{G}|^2}{4}\\right)\n$$\n由于指数是实数，该因子是一个正实数，因此其模就是其自身。\n$$\n\\frac{I(T,\\mathbf{G})}{I_{0}(\\mathbf{G})} = \\left[\\exp\\left(-\\frac{B|\\mathbf{G}|^2}{4}\\right)\\right]^2 = \\exp\\left(-2 \\cdot \\frac{B|\\mathbf{G}|^2}{4}\\right) = \\exp\\left(-\\frac{B|\\mathbf{G}|^2}{2}\\right)\n$$\n最后，我们代入给定的数值：$B = 1~\\text{\\AA}^{2}$ 和 $|\\mathbf{G}| = 5~\\text{\\AA}^{-1}$。乘积 $B|\\mathbf{G}|^2$ 是无量纲的：\n$$\nB|\\mathbf{G}|^2 = (1~\\text{\\AA}^{2}) (5~\\text{\\AA}^{-1})^2 = 1 \\cdot 25 = 25\n$$\n相对强度为：\n$$\n\\frac{I(T,\\mathbf{G})}{I_{0}(\\mathbf{G})} = \\exp\\left(-\\frac{25}{2}\\right) = \\exp(-12.5)\n$$\n计算此值：\n$$\n\\exp(-12.5) \\approx 3.72665 \\times 10^{-6}\n$$\n按要求四舍五入到三位有效数字，我们得到 $3.73 \\times 10^{-6}$。",
            "answer": "$$\\boxed{3.73 \\times 10^{-6}}$$"
        },
        {
            "introduction": "连接理论与实验需要考虑真实测量中固有的系统误差。本计算练习  介绍了科恩方法，这是一种强大的数据分析技术，通过校正仪器和样品相关的误差来高精度地修正晶格常数。通过实现此方法，您将培养从实验XRD数据中提取准确结构信息的实用技能。",
            "id": "4312758",
            "problem": "您将实现一个程序，使用科恩（Cohen）方法，根据X射线衍射（XRD）测量数据精修立方晶格参数 $a$ ，以校正样品位移和透明度等系统误差。该方法首先根据布拉格定律和立方晶系几何结构计算每个衍射峰的晶格参数 $a_{hkl}(\\theta)$，然后对 $\\Delta a$ 与科恩外推函数 $f(\\theta) = \\cos^2 \\theta / \\sin \\theta$ 进行线性回归。通过外推至 $f(\\theta) \\to 0$ 得到精修后的参数 $a_{\\text{refined}}$。所有角度均以度为单位指定，在计算时必须内部转换为弧度。最终答案必须以埃（Å）为单位表示，并四舍五入到五位小数。\n\n基本原理：\n- 一级衍射的布拉格定律：$n \\lambda = 2 d \\sin \\theta$，其中 $n=1$。\n- 立方晶系几何：$d_{hkl} = a / \\sqrt{h^2 + k^2 + l^2}$。\n\n由此，计算每个衍射峰的晶格参数如下：\n$$\na_{hkl}(\\theta) = \\frac{\\lambda \\sqrt{h^2 + k^2 + l^2}}{2 \\sin \\theta}.\n$$\n定义科恩外推函数：\n$$\nf(\\theta) = \\frac{\\cos^2 \\theta}{\\sin \\theta}.\n$$\n定义相对于初始参考值 $a_{\\mathrm{ref}}$ 的每个衍射峰的偏差：\n$$\n\\Delta a_i = a_{hkl,i} - a_{\\mathrm{ref}}.\n$$\n通过线性回归对系统误差进行建模：\n$$\n\\Delta a_i \\approx m f(\\theta_i) + b,\n$$\n并通过外推得到的截距获得精修晶格参数：\n$$\na_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b.\n$$\n\n算法要求：\n1. 对于每个测试用例，通过 $\\theta = (2\\theta) / 2$ 和度到弧度的转换，将提供的 $2\\theta$ 值（单位为度）转换为 $\\theta$（单位为弧度）。\n2. 对于每个衍射峰 $(h,k,l)$ 及其对应的 $\\theta$，使用上述公式计算 $a_{hkl}$。\n3. 对于每个衍射峰，计算其相对于给定 $a_{\\mathrm{ref}}$ 的 $\\Delta a_i$。\n4. 对于每个衍射峰，计算其 $f(\\theta_i)$。\n5. 使用最小二乘法对 $\\Delta a_i$ 与 $f(\\theta_i)$ 的关系进行线性拟合，以获得斜率 $m$ 和截距 $b$。\n6. 计算 $a_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b$。\n7. 以埃（Å）为单位报告 $a_{\\mathrm{refined}}$，四舍五入到五位小数。\n\n角度单位要求：\n- 所有输入角度均为 $2\\theta$（单位为度）；在使用三角函数前，必须将其转换为 $\\theta$（单位为弧度）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的精修晶格参数。这些参数是一个用逗号分隔的列表，并用方括号括起来，每个值都以埃（Å）为单位，并四舍五入到五位小数。例如：$[5.43100,5.65200,3.90500,5.64000]$。\n\n测试套件：\n提供并处理以下科学上合理的测试用例。请勿改动指定的参数。\n\n- 测试用例1（类硅，多个中等角度衍射峰）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 5.4300\\,\\text{\\AA}$。\n  - 衍射峰 $(h,k,l)$: $(1,1,1)$, $(2,2,0)$, $(3,1,1)$, $(4,0,0)$。\n  - 测量的 $2\\theta$（度）：$28.44$, $47.29$, $56.18$, $69.12$。\n\n- 测试用例2（类砷化镓，高角度衍射峰）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 5.6500\\,\\text{\\AA}$。\n  - 衍射峰 $(h,k,l)$: $(4,0,0)$, $(3,3,1)$, $(4,2,2)$。\n  - 测量的 $2\\theta$（度）：$66.10$, $72.89$, $75.17$。\n\n- 测试用例3（类钛酸锶，低角度衍射峰，简单立方）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 3.9000\\,\\text{\\AA}$。\n  - 衍射峰 $(h,k,l)$: $(1,0,0)$, $(1,1,0)$, $(1,1,1)$。\n  - 测量的 $2\\theta$（度）：$22.76$, $32.33$, $39.72$。\n\n- 测试用例4（类氯化钠，最少两个衍射峰）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 5.6350\\,\\text{\\AA}$。\n  - 衍射峰 $(h,k,l)$: $(2,0,0)$, $(2,2,0)$。\n  - 测量的 $2\\theta$（度）：$31.68$, $45.48$。\n\n您的程序必须实现上述方法，并以确切要求的格式生成最终输出行。不允许用户输入；所有数据都必须嵌入在程序中。",
            "solution": "所提出的问题要求实现一个计算程序，以根据X射线衍射（XRD）数据精修立方晶体的晶格参数。这将通过使用科恩（Cohen）方法来完成，这是一种用于系统误差校正的经典技术。对问题陈述的验证证实了其科学上的合理性、问题的明确性和完整性。所有提供的数据和物理常数都是合理的，并与晶体学和固态物理学的既定原理相符。因此，我们可以着手进行正式的求解。\n\n该分析的基础是两个基本原理：布拉格定律和立方晶格的几何学。\n\n首先，布拉格定律描述了由一组平行晶面衍射的X射线发生相长干涉的条件。对于一级衍射（$n=1$），其表达式为：\n$$\n\\lambda = 2 d_{hkl} \\sin\\theta\n$$\n在此，$\\lambda$ 是入射X射线的波长，$d_{hkl}$ 是由米勒指数 $(h,k,l)$ 表示的一组晶面的晶面间距，而 $\\theta$ 是入射角，即所测衍射角 $2\\theta$ 的一半。\n\n其次，对于立方晶系，晶面间距 $d_{hkl}$ 与晶格参数 $a$ 通过以下几何关系相关联：\n$$\nd_{hkl} = \\frac{a}{\\sqrt{h^2 + k^2 + l^2}}\n$$\n\n通过将 $d_{hkl}$ 的表达式代入布拉格定律并重新整理，我们可以推导出从在角度 $\\theta$ 处观察到的单个衍射峰 $(h,k,l)$ 计算出的表观晶格参数 $a_{hkl}$ 的表达式：\n$$\na_{hkl}(\\theta) = \\frac{\\lambda \\sqrt{h^2 + k^2 + l^2}}{2 \\sin\\theta}\n$$\n在理想的测量中，对于所有观察到的衍射峰，$a_{hkl}(\\theta)$ 将是一个常数。然而，在实践中，系统性的实验误差，例如样品偏离测角仪轴或X射线在平坦厚样品中的吸收，会导致计算出的 $a_{hkl}$ 随衍射角 $\\theta$ 系统性地变化。\n\n科恩方法通过对其角度依赖性进行建模，并外推至其影响最小化的条件，提供了一种校正这些误差的方法。该方法假设表观晶格参数与参考值之间的偏差 $\\Delta a_i = a_{hkl,i} - a_{\\mathrm{ref}}$ 是一个特定选择的外推函数 $f(\\theta_i)$ 的线性函数。本问题指定使用科恩函数：\n$$\nf(\\theta) = \\frac{\\cos^2\\theta}{\\sin\\theta}\n$$\n该函数是通过考虑样品位移引入的误差而导出的。因此，线性模型为：\n$$\n\\Delta a_i \\approx m f(\\theta_i) + b\n$$\n其中 $m$ 是与系统误差大小成正比的斜率，而 $b$ 是截距。截距 $b$ 表示在 $f(\\theta) \\to 0$ 的极限情况下 $\\Delta a$ 的值。该极限对应于 $\\theta \\to 90^\\circ$（$2\\theta \\to 180^\\circ$），这是一种高角度背反射几何结构，在此结构下，样品位移等系统误差的影响会消失。因此，截距 $b$ 代表了参考晶格参数所需的真实校正值。\n\n为了确定截距 $b$，我们对一组数据点 $(x_i, y_i)$ 进行线性最小二乘回归，其中 $x_i = f(\\theta_i)$ 且 $y_i = \\Delta a_i$。对于一组 $N$ 个数据点，截距 $b$ 由以下公式给出：\n$$\nb = \\bar{y} - m\\bar{x}\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是 $x_i$ 和 $y_i$ 值的平均值，而 $m$ 是回归线的斜率。\n\n一旦确定了 $b$，将此截距加到初始参考值上，即可得到精修后、经过误差校正的晶格参数 $a_{\\mathrm{refined}}$：\n$$\na_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b\n$$\n基于所提供的实验数据，这个精修值是对真实晶格参数的最佳估计。\n\n对于每个测试用例，计算算法如下：\n1.  对于每个提供的衍射角 $2\\theta_i$（单位为度），计算出相应的角度 $\\theta_i$（单位为弧度）：$\\theta_i = \\frac{\\pi}{180} \\times \\frac{2\\theta_i}{2}$。\n2.  对于每个具有米勒指数 $(h_i, k_i, l_i)$ 和角度 $\\theta_i$ 的衍射峰 $i$，计算以下量：\n    a. 表观晶格参数：$a_i = \\frac{\\lambda \\sqrt{h_i^2 + k_i^2 + l_i^2}}{2 \\sin\\theta_i}$。\n    b. 与参考值的偏差：$\\Delta a_i = a_i - a_{\\mathrm{ref}}$。\n    c. 科恩外推函数的值：$f(\\theta_i) = \\frac{\\cos^2\\theta_i}{\\sin\\theta_i}$。\n3.  组合成一组数据点 $\\{ (f(\\theta_i), \\Delta a_i) \\}$。\n4.  对此数据集进行线性最小二乘回归，以找到y轴截距 $b$。\n5.  精修晶格参数计算为 $a_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b$。\n6.  最终结果 $a_{\\mathrm{refined}}$ 按要求四舍五入到五位小数。\n\n此过程将系统地应用于问题陈述中提供的每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Refines the cubic lattice parameter 'a' from XRD measurements using the Cohen method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test Case 1 (silicon-like)\",\n            \"lambda_\": 1.5406,  # Wavelength in Angstroms\n            \"a_ref\": 5.4300,    # Initial reference lattice parameter in Angstroms\n            \"reflections\": [(1, 1, 1), (2, 2, 0), (3, 1, 1), (4, 0, 0)],\n            \"two_thetas_deg\": [28.44, 47.29, 56.18, 69.12]\n        },\n        {\n            \"name\": \"Test Case 2 (gallium arsenide-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 5.6500,\n            \"reflections\": [(4, 0, 0), (3, 3, 1), (4, 2, 2)],\n            \"two_thetas_deg\": [66.10, 72.89, 75.17]\n        },\n        {\n            \"name\": \"Test Case 3 (strontium titanate-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 3.9000,\n            \"reflections\": [(1, 0, 0), (1, 1, 0), (1, 1, 1)],\n            \"two_thetas_deg\": [22.76, 32.33, 39.72]\n        },\n        {\n            \"name\": \"Test Case 4 (sodium chloride-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 5.6350,\n            \"reflections\": [(2, 0, 0), (2, 2, 0)],\n            \"two_thetas_deg\": [31.68, 45.48]\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        lambda_ = case[\"lambda_\"]\n        a_ref = case[\"a_ref\"]\n        reflections = case[\"reflections\"]\n        two_thetas_deg = case[\"two_thetas_deg\"]\n\n        delta_a_values = []\n        cohen_f_values = []\n\n        # Process each diffraction peak\n        for i in range(len(reflections)):\n            h, k, l = reflections[i]\n            two_theta_deg = two_thetas_deg[i]\n\n            # 1. Convert 2-theta (degrees) to theta (radians)\n            theta_rad = np.deg2rad(two_theta_deg / 2.0)\n\n            # 2. Compute a_hkl\n            hkl_sq_sum = h**2 + k**2 + l**2\n            a_hkl = (lambda_ * np.sqrt(hkl_sq_sum)) / (2 * np.sin(theta_rad))\n\n            # 3. Compute delta_a\n            delta_a = a_hkl - a_ref\n            delta_a_values.append(delta_a)\n\n            # 4. Compute f(theta)\n            cohen_f = (np.cos(theta_rad)**2) / np.sin(theta_rad)\n            cohen_f_values.append(cohen_f)\n\n        # Convert lists to numpy arrays for regression\n        x_data = np.array(cohen_f_values)\n        y_data = np.array(delta_a_values)\n\n        # 5. Fit a straight line using least squares to get the intercept 'b'\n        # The linregress function returns (slope, intercept, r_value, p_value, std_err)\n        # We only need the intercept.\n        if len(x_data) > 1:\n            slope, intercept, r_value, p_value, std_err = linregress(x_data, y_data)\n        elif len(x_data) == 1:\n            # If there's only one point, regression is undefined.\n            # In this context, the best estimate is the single calculated value.\n            # a_refined = a_ref + delta_a_values[0] = a_hkl\n            # However, the problem ensures at least 2 points for regression.\n            # This is a fallback, but the intercept of a line through one point is ill-defined.\n            # Let's assume the error is entirely captured by the deviation itself.\n            # A more robust approach might be to flag this, but we follow the logic.\n            # The prompt test cases have >= 2 points.\n            intercept = delta_a_values[0] # Simplistic assumption.\n        else: # No data points\n            intercept = 0\n\n        # 6. Compute a_refined\n        a_refined = a_ref + intercept\n\n        # 7. Append the rounded result\n        results.append(f\"{a_refined:.5f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}