{
    "hands_on_practices": [
        {
            "introduction": "开尔文探针力显微镜（KPFM）的核心价值在于其能够探测材料的表面电势。本练习将引导您从半导体物理学的基本原理出发，计算由于表面态导致的能带弯曲，并将此物理现象与KPFM实验中测得的接触电势差（$V_{CPD}$）直接关联起来。通过这个实践，您将掌握定量解释半导体材料KPFM图像的基础 。",
            "id": "4283894",
            "problem": "在温度 $T = 300\\,\\text{K}$ 下，对一个施主密度为 $N_{D} = 1.00 \\times 10^{17}\\,\\text{cm}^{-3}$ 的均匀掺杂、非简并的$n$型硅表面进行了一次调幅Kelvin探针力显微镜 (KPFM) 测量。在此温度下，硅的本征载流子浓度为 $n_{i} = 1.00 \\times 10^{10}\\,\\text{cm}^{-3}$。假设掺杂剂完全电离，无带隙变窄，且除静电能带弯曲外无表面偶极子变化。\n\n定义表面电势 $\\psi_{s}$ 为正，当表面的电子能带相对于体材料向上移动 $q \\psi_{s}$ 时，等效于 $E_{i}(\\text{surface}) - E_{i}(\\text{bulk}) = q \\psi_{s}$，其中 $E_{i}$ 是本征能级，$q$ 是基本电荷的量值。假设表面态将费米能级钉扎在带隙中央，使得 $E_{F}(\\text{surface}) = E_{i}(\\text{surface})$。\n\n在 KPFM 中，接触电势差定义为\n\n$$\nV_{\\mathrm{CPD}} = \\frac{\\Phi_{\\text{sample}} - \\Phi_{\\text{tip}}}{q},\n$$\n\n其中 $\\Phi$ 表示功函数。仅考虑能带弯曲对样品功函数的贡献，并假设能带弯曲使 $\\Phi_{\\text{sample}}$ 相对于平带情况增加了 $q \\psi_{s}$。\n\n仅使用热平衡状态下非简并半导体的基本关系和上述定义，确定：\n- 由带隙中央钉扎所隐含的表面电势 $\\psi_{s}$，以及\n- 该能带弯曲对 $V_{\\mathrm{CPD}}$ 的相应贡献 $\\Delta V_{\\mathrm{CPD}}$，此贡献与探针的绝对功函数无关。\n\n使用 $k_{B} = 1.380\\,649\\times 10^{-23}\\,\\text{J/K}$ 和 $q = 1.602\\,176\\,634\\times 10^{-19}\\,\\text{C}$。将 $\\psi_{s}$ 和 $\\Delta V_{\\mathrm{CPD}}$ 均以伏特为单位表示，并将您的答案四舍五入至四位有效数字。",
            "solution": "该问题被认为是有效的，因为它在半导体物理学方面有科学依据，提法恰当，客观，并为得出唯一解提供了所有必要信息。\n\n求解过程分两部分：首先，我们确定表面电势 $\\psi_{s}$；其次，我们计算其对接触电势差的相应贡献 $\\Delta V_{\\mathrm{CPD}}$。\n\n第1部分：确定表面电势 $\\psi_{s}$\n\n表面电势 $\\psi_{s}$ 源于表面能带位置相对于体材料能带位置的差异。为求得 $\\psi_{s}$，我们必须首先确定半导体体材料中费米能级 $E_{F}$ 相对于本征能级 $E_{i}$ 的位置。\n\n对于处于热平衡状态的非简并n型半导体，其体材料中的电子浓度 $n_{0}$ 由下式给出：\n$$\nn_{0} = n_{i} \\exp\\left(\\frac{E_{F}(\\text{bulk}) - E_{i}(\\text{bulk})}{k_{B} T}\\right)\n$$\n其中 $n_{i}$ 是本征载流子浓度，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n问题陈述，施主原子完全电离，因此体电子浓度等于施主密度，即 $n_{0} = N_{D}$。将此代入上式，我们得到：\n$$\nN_{D} = n_{i} \\exp\\left(\\frac{E_{F}(\\text{bulk}) - E_{i}(\\text{bulk})}{k_{B} T}\\right)\n$$\n我们可以解出体材料中费米能级与本征能级之间的能量差：\n$$\n\\frac{N_{D}}{n_{i}} = \\exp\\left(\\frac{E_{F}(\\text{bulk}) - E_{i}(\\text{bulk})}{k_{B} T}\\right)\n$$\n$$\nE_{F}(\\text{bulk}) - E_{i}(\\text{bulk}) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\n在热平衡状态下，费米能级 $E_{F}$ 在从体材料到表面的整个样品中是恒定的。因此，$E_{F}(\\text{bulk}) = E_{F}(\\text{surface}) = E_{F}$。\n\n问题陈述，表面态将费米能级钉扎在表面的带隙中央。这意味着：\n$$\nE_{F}(\\text{surface}) = E_{i}(\\text{surface})\n$$\n或者简单地说，$E_{F} = E_{i}(\\text{surface})$。这意味着在表面，费米能级与本征能级之间的能量差为零：\n$$\nE_{F} - E_{i}(\\text{surface}) = 0\n$$\n现在我们有两个涉及 $E_{F}$ 的表达式：\n1.  $E_{F} - E_{i}(\\text{bulk}) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)$\n2.  $E_{F} - E_{i}(\\text{surface}) = 0$\n\n从第一个方程减去第二个方程，得到：\n$$\n(E_{F} - E_{i}(\\text{bulk})) - (E_{F} - E_{i}(\\text{surface})) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right) - 0\n$$\n$$\nE_{i}(\\text{surface}) - E_{i}(\\text{bulk}) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\n问题定义表面电势 $\\psi_{s}$，使得能带移动为 $q\\psi_{s}$，其中 $q$ 是基本电荷。具体而言，$q\\psi_{s} = E_{i}(\\text{surface}) - E_{i}(\\text{bulk})$。\n将此定义代入我们推导出的关系式，得到：\n$$\nq \\psi_{s} = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\n由此，我们得到表面电势的表达式：\n$$\n\\psi_{s} = \\frac{k_{B} T}{q} \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\n项 $\\frac{k_{B} T}{q}$ 是热电压 $V_{th}$。现在我们代入给定的数值：\n$N_{D} = 1.00 \\times 10^{17}\\,\\text{cm}^{-3}$\n$n_{i} = 1.00 \\times 10^{10}\\,\\text{cm}^{-3}$\n$T = 300\\,\\text{K}$\n$k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$\n$q = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n\n首先，我们计算热电压：\n$$\nV_{th} = \\frac{k_{B} T}{q} = \\frac{(1.380649 \\times 10^{-23}\\,\\text{J/K})(300\\,\\text{K})}{1.602176634 \\times 10^{-19}\\,\\text{C}} \\approx 0.025852\\,\\text{V}\n$$\n接着，我们计算对数项：\n$$\n\\ln\\left(\\frac{N_{D}}{n_{i}}\\right) = \\ln\\left(\\frac{1.00 \\times 10^{17}}{1.00 \\times 10^{10}}\\right) = \\ln(10^{7}) = 7 \\ln(10) \\approx 16.1181\n$$\n最后，我们计算 $\\psi_{s}$：\n$$\n\\psi_{s} = (0.025852\\,\\text{V}) \\times (16.1181) \\approx 0.41669\\,\\text{V}\n$$\n四舍五入到四位有效数字，表面电势为 $\\psi_{s} = 0.4167\\,\\text{V}$。正值表示能带向上弯曲，这与n型表面的耗尽情况一致。\n\n第2部分：确定贡献 $\\Delta V_{\\mathrm{CPD}}$\n\n接触电势差 $V_{\\mathrm{CPD}}$ 定义为：\n$$\nV_{\\mathrm{CPD}} = \\frac{\\Phi_{\\text{sample}} - \\Phi_{\\text{tip}}}{q}\n$$\n其中 $\\Phi_{\\text{tip}}$ 和 $\\Phi_{\\text{sample}}$ 分别是 KPFM 探针和样品的功函数。\n\n问题陈述，能带弯曲使样品功函数 $\\Phi_{\\text{sample}}$ 相对于平带情况增加了 $q\\psi_{s}$。设 $\\Phi_{\\text{sample,FB}}$ 为平带条件（$\\psi_{s}=0$）下的功函数。因此，存在能带弯曲时的功函数为：\n$$\n\\Phi_{\\text{sample}} = \\Phi_{\\text{sample,FB}} + q\\psi_{s}\n$$\n将此代入 $V_{\\mathrm{CPD}}$ 的表达式中：\n$$\nV_{\\mathrm{CPD}} = \\frac{(\\Phi_{\\text{sample,FB}} + q\\psi_{s}) - \\Phi_{\\text{tip}}}{q} = \\frac{\\Phi_{\\text{sample,FB}} - \\Phi_{\\text{tip}}}{q} + \\frac{q\\psi_{s}}{q}\n$$\n第一项 $\\frac{\\Phi_{\\text{sample,FB}} - \\Phi_{\\text{tip}}}{q}$ 代表在平带条件下测得的接触电势差，我们称之为 $V_{\\mathrm{CPD,FB}}$。因此：\n$$\nV_{\\mathrm{CPD}} = V_{\\mathrm{CPD,FB}} + \\psi_{s}\n$$\n能带弯曲对 $V_{\\mathrm{CPD}}$ 的贡献是实际 $V_{\\mathrm{CPD}}$ 与平带值 $V_{\\mathrm{CPD,FB}}$ 之间的差值。此贡献记为 $\\Delta V_{\\mathrm{CPD}}$：\n$$\n\\Delta V_{\\mathrm{CPD}} = V_{\\mathrm{CPD}} - V_{\\mathrm{CPD,FB}} = (V_{\\mathrm{CPD,FB}} + \\psi_{s}) - V_{\\mathrm{CPD,FB}} = \\psi_{s}\n$$\n这个贡献确实与探针功函数无关，符合要求。\n\n使用第1部分计算出的 $\\psi_{s}$ 值：\n$$\n\\Delta V_{\\mathrm{CPD}} = 0.4167\\,\\text{V}\n$$\n\n所求的两个量是表面电势 $\\psi_{s}$ 和能带弯曲对接触电势差的贡献 $\\Delta V_{\\mathrm{CPD}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4167  0.4167\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理想的KPFM测量能够将形貌与表面电势完全分离，但在实际操作中，伪影往往会造成信号串扰。本练习旨在剖析一种常见的测量伪影——形貌串扰，它源于单次扫描模式中机械振动与电调制的混合。通过推导其物理来源并设计一种基于相位循环的伪影抑制方案，您将能更深入地理解精确KPFM测量背后复杂的信号处理技术 。",
            "id": "4283900",
            "problem": "在一个具有空间变化功函数的新兴半导体材料上，使用导电原子力显微镜 (AFM) 探针进行单通道振幅调制开尔文探针力显微镜 (AM-KPFM) 测量。悬臂梁在其基频谐振频率 $\\,\\Omega\\,$ 下被机械驱动以进行形貌反馈，振荡振幅为 $\\,A\\,$，同时在针尖和样品之间施加电偏压 $\\,V(t) = V_{\\mathrm{dc}} + V_{\\mathrm{ac}}\\cos(\\omega t + \\phi)\\,$，其中 $\\,\\omega\\,$ 是电调制频率，$\\,\\phi\\,$ 是所施加的交流 (AC) 电压相对于锁定放大器的用户定义的参考相位。针尖-样品间距随时间变化为 $\\,z(t) = z_0 + A\\cos(\\Omega t)\\,$。针尖-样品电容能量为 $\\,U(z,t) = \\tfrac{1}{2} C(z)\\,[V(t) - V_{\\mathrm{CPD}}]^2\\,$，其中 $\\,C(z)\\,$ 是针尖-样品电容，$\\,V_{\\mathrm{CPD}}\\,$ 是接触电势差。垂直静电力为 $\\,F_z(t) = -\\partial U/\\partial z\\,$，AM-KPFM 信号是通过使用以 $\\,\\cos(\\omega t)\\,$ 为参考的锁定放大器在 $\\,\\omega\\,$ 频率下解调 $\\,F_z(t)\\,$ 获得的。\n\n从定义 $\\,U = \\tfrac{1}{2} C(z)\\,V^2\\,$ 和 $\\,F_z = -\\partial U/\\partial z = -\\tfrac{1}{2}\\,\\frac{\\partial C}{\\partial z}\\,[V(t) - V_{\\mathrm{CPD}}]^2\\,$ 出发，分析在单通道 AM-KPFM 实验中，频率为 $\\,\\Omega\\,$ 的机械形貌振荡如何能够调制 $\\,F_z\\,$ 在 $\\,\\omega\\,$ 频率的分量，从而在解调信号中引入伪影，即使当 $\\,V_{\\mathrm{dc}}\\,$ 被调节以将 $\\,\\omega\\,$ 分量置零时也是如此。通过将 $\\,\\partial C/\\partial z\\,$ 在 $\\,z_0\\,$ 附近展开到关于 $\\,A\\,$ 的一阶，来考虑 $\\,\\partial C/\\partial z\\,$ 对 $\\,z\\,$ 的依赖性的最低阶效应。\n\n然后，提出一种相位循环策略，其中交流偏压相位 $\\,\\phi\\,$ 在一组 $\\,4\\,$ 个值上循环，并将得到的锁定放大器输出进行线性组合，以抑制形貌引起的伪影，同时保留真实的接触电势相关贡献。您提出的组合必须由关于 $\\,\\phi\\,$ 的三角正交性和奇偶性（奇/偶）来证明其合理性，并且它必须产生一个相位无关的 $\\,\\omega\\,$ 分量估计量，该估计量适合用于对 $\\,V_{\\mathrm{dc}}\\,$ 进行反馈。\n\n哪个选项正确解释了单通道 AM-KPFM 中 $\\,\\omega\\,$ 频率上由形貌引起的调制机制，并提供了一个有科学依据的相位循环策略来减轻这种伪影？\n\nA. 针尖-样品间距振荡 $\\,z(t)\\,$ 在 $\\,\\Omega\\,$ 频率上调制了电容梯度 $\\,\\partial C/\\partial z\\,$，该梯度乘以与 $\\,\\omega\\,$ 相关的电压项，产生一个混合的 $\\,\\omega\\,$ 力，其包络与形貌相关。采用四步相位循环，$\\,\\phi \\in \\{0, \\tfrac{\\pi}{2}, \\pi, \\tfrac{3\\pi}{2}\\}\\,$，用于形成 $\\,S_x = S_{0} - S_{\\pi}\\,$ 和 $\\,S_y = S_{\\pi/2} - S_{3\\pi/2}\\,$，其中 $\\,S_{\\phi}\\,$ 是相位为 $\\,\\phi\\,$ 时的锁定放大器输出。在 $\\,\\phi\\,$ 上为偶函数的伪影项在这些反对称差分中被抵消，而真实的接触电势差贡献（在 $\\,\\phi\\,$ 上为奇函数）被保留。然后使用一个相位无关的估计量 $\\,S_{\\mathrm{clean}} = \\tfrac{1}{2}\\sqrt{S_x^2 + S_y^2}\\,$ 对 $\\,V_{\\mathrm{dc}}\\,$ 进行反馈，以将 $\\,\\omega\\,$ 分量置零。\n\nB. 伪影的产生是因为交流偏压振幅 $\\,V_{\\mathrm{ac}}\\,$ 太小，无法克服仪器噪声；通过增加 $\\,V_{\\mathrm{ac}}\\,$ 并使用更硬的悬臂梁来减轻伪影，使得 $\\,\\omega\\,$ 分量超过任何 $\\,\\Omega\\,$ 调制。相位循环是不必要的。\n\nC. 伪影主要归因于半导体在 $\\,\\omega\\,$ 频率下的压电响应；通过在 $\\,2\\omega\\,$ 而非 $\\,\\omega\\,$ 频率下解调来减轻伪影，从而避免压电信号。在 $\\,\\phi = 0\\,$ 和 $\\,\\phi = \\pi\\,$ 之间进行两相循环是足够的，但不需要相位组合，因为 $\\,2\\omega\\,$ 信号不受形貌引起的调制影响。\n\nD. 当 $\\,V_{\\mathrm{dc}}\\,$ 越过 $\\,V_{\\mathrm{CPD}}\\,$ 时，形貌调制会改变真实的 $\\,\\omega\\,$ 力分量的符号；为消除这一点，对直流偏压 $\\,V_{\\mathrm{dc}}\\,$ 在 $\\,\\pm V_0\\,$ 之间进行循环，并在固定的 $\\,\\phi\\,$ 下对得到的锁定放大器输出求平均。这种平均消除了对 $\\,\\partial C/\\partial z\\,$ 的任何依赖性，并产生一个用于反馈的干净估计量，而无需相位循环。",
            "solution": "基本出发点是导电针尖和样品之间的静电能，由 $\\,U(z,t) = \\tfrac{1}{2} C(z)\\,[V(t) - V_{\\mathrm{CPD}}]^2\\,$ 给出，以及由 $\\,F_z(t) = -\\partial U/\\partial z\\,$ 定义的垂直静电力。使用基本关系式 $\\,F_z(t) = -\\partial U/\\partial z = -\\tfrac{1}{2}\\,\\frac{\\partial C}{\\partial z}\\,[V(t) - V_{\\mathrm{CPD}}]^2\\,$，其中 $\\,V(t) = V_{\\mathrm{dc}} + V_{\\mathrm{ac}}\\cos(\\omega t + \\phi)\\,$ 且 $\\,z(t) = z_0 + A\\cos(\\Omega t)\\,$，我们分析在 AM-KPFM 中测量的 $\\,\\omega\\,$ 分量。\n\n定义 $\\,V_0 \\equiv V_{\\mathrm{dc}} - V_{\\mathrm{CPD}}\\,$。那么\n$$\n[V(t) - V_{\\mathrm{CPD}}]^2 = \\big(V_0 + V_{\\mathrm{ac}}\\cos(\\omega t + \\phi)\\big)^2\n= V_0^2 + 2 V_0 V_{\\mathrm{ac}} \\cos(\\omega t + \\phi) + V_{\\mathrm{ac}}^2 \\cos^2(\\omega t + \\phi).\n$$\n使用 $\\,\\cos^2(\\omega t + \\phi) = \\tfrac{1}{2}\\big(1 + \\cos(2\\omega t + 2\\phi)\\big)\\,$，得到\n$$\n[V(t) - V_{\\mathrm{CPD}}]^2 = V_0^2 + 2 V_0 V_{\\mathrm{ac}} \\cos(\\omega t + \\phi) + \\tfrac{V_{\\mathrm{ac}}^2}{2}\\big(1 + \\cos(2\\omega t + 2\\phi)\\big).\n$$\n因此，力可以写为\n$$\nF_z(t) = -\\tfrac{1}{2}\\,\\frac{\\partial C}{\\partial z}(z(t))\\left[\nV_0^2 + 2 V_0 V_{\\mathrm{ac}} \\cos(\\omega t + \\phi) + \\tfrac{V_{\\mathrm{ac}}^2}{2}\\big(1 + \\cos(2\\omega t + 2\\phi)\\big)\n\\right].\n$$\n如果针尖-样品间距固定在 $\\,z_0\\,$，则 $\\,\\omega\\,$ 分量将简化为\n$$\nF_{\\omega}(t) = -\\left.\\frac{\\partial C}{\\partial z}\\right|_{z_0}\\,V_0 V_{\\mathrm{ac}} \\cos(\\omega t + \\phi),\n$$\n这是 AM-KPFM 置零法的基础：调节 $\\,V_{\\mathrm{dc}}\\,$ 直到 $\\,V_0 = 0\\,$，使得 $\\,\\omega\\,$ 分量消失。\n\n然而，在单通道 AM-KPFM 中，形貌反馈中的 $\\,z(t) = z_0 + A\\cos(\\Omega t)\\,$。$\\,\\partial C/\\partial z\\,$ 对 $\\,z\\,$ 的依赖性导致了 $\\,\\omega\\,$ 项的振幅调制。将 $\\,\\partial C/\\partial z(z(t))\\,$ 在 $\\,z_0\\,$ 附近展开到一阶（一个由 $\\,A\\,$ 相对于 $\\,z_0\\,$ 较小而证明其合理性的泰勒展开），\n$$\n\\frac{\\partial C}{\\partial z}(z(t)) \\approx \\left.\\frac{\\partial C}{\\partial z}\\right|_{z_0} + \\left.\\frac{\\partial^2 C}{\\partial z^2}\\right|_{z_0} \\,A \\cos(\\Omega t).\n$$\n将此代入 $\\,F_z(t)\\,$ 的表达式中，并只保留名义上由电压依赖性产生的位于 $\\,\\omega\\,$ 频率的项，得到\n$$\nF_{\\omega}(t) \\approx -\\left(\\left.\\frac{\\partial C}{\\partial z}\\right|_{z_0} + \\left.\\frac{\\partial^2 C}{\\partial z^2}\\right|_{z_0} \\,A \\cos(\\Omega t)\\right) V_0 V_{\\mathrm{ac}} \\cos(\\omega t + \\phi).\n$$\n第二项表现出混频：\n$$\n-\\left.\\frac{\\partial^2 C}{\\partial z^2}\\right|_{z_0} A \\cos(\\Omega t)\\, V_0 V_{\\mathrm{ac}} \\cos(\\omega t + \\phi) \n= -\\left.\\frac{\\partial^2 C}{\\partial z^2}\\right|_{z_0} \\frac{A V_0 V_{\\mathrm{ac}}}{2} \\left[\\cos\\big((\\omega+\\Omega)t + \\phi\\big) + \\cos\\big((\\omega-\\Omega)t + \\phi\\big)\\right].\n$$\n在 $\\,\\omega\\,$ 频率下具有无限选择性的理想锁定解调会抑制这些位于 $\\,\\omega \\pm \\Omega\\,$ 的边带。然而，在实践中，有限的锁定带宽、悬臂梁传递函数变化以及形貌通道的反馈回路耦合导致振幅调制的泄漏回到解调的 $\\,\\omega\\,$ 信号中。此外，当项 $\\,-\\tfrac{1}{2}(\\partial C/\\partial z)\\tfrac{V_{\\mathrm{ac}}^2}{2} \\cos(2\\omega t + 2\\phi)\\,$ 乘以依赖于 $\\,z(t)\\,$ 的因子并经过非线性悬臂梁响应处理时，也可以在 $\\,\\omega\\,$ 频率产生一个小的带内贡献。净效应是，解调的 $\\,\\omega\\,$ 输出会产生一个与 $\\,A\\,$ 和局部曲率 $\\,\\partial^2 C/\\partial z^2\\,$（即与形貌）相关的伪影，即使当 $\\,V_0 \\approx 0\\,$ 时也是如此。\n\n一种将解调信号形式化的便捷方法是将以 $\\,\\cos(\\omega t)\\,$ 为参考的锁定放大器输出写成一个相位相关的投影：\n$$\nS(\\phi) \\propto \\left\\langle F_z(t)\\,\\cos(\\omega t)\\right\\rangle_T,\n$$\n其中 $\\,\\langle \\cdot \\rangle_T\\,$ 表示在由锁定时间常数设定的窗口 $\\,T\\,$ 上的时间平均。理想的接触电势相关项投影为 $\\,S_{\\mathrm{CPD}}(\\phi) \\propto -\\left.\\frac{\\partial C}{\\partial z}\\right|_{z_0} V_0 V_{\\mathrm{ac}} \\cos\\phi\\,$，由于 $\\,\\cos(\\phi + \\pi) = -\\cos\\phi\\,$，该项在 $\\,\\phi \\to \\phi + \\pi\\,$ 变换下是奇的。相反，由不完全抑制 $\\,\\Omega\\,$ 调制包络产生的残留伪影在 $\\,\\phi\\,$ 上近似为偶（其行为像一个缓慢变化的振幅乘数，与锁定参考选择 $\\,\\cos\\,$ 还是 $\\,\\sin\\,$ 无关），并且任何从 $\\,2\\omega\\,$ 项泄漏的贡献以 $\\,\\cos(2\\phi)\\,$ 的形式进入，在 $\\,\\phi \\to \\phi + \\pi\\,$ 变换下也是偶的。\n\n这种奇偶性结构启发了一种相位循环策略。在 $\\,\\phi_k \\in \\{0, \\tfrac{\\pi}{2}, \\pi, \\tfrac{3\\pi}{2}\\}\\,$ 采集四个锁定放大器输出 $\\,S_{\\phi_k}\\,$。构造反对称差分\n$$\nS_x \\equiv S_{0} - S_{\\pi}, \\qquad S_y \\equiv S_{\\pi/2} - S_{3\\pi/2}.\n$$\n对于理想的与 CPD 相关的项 $\\,S_{\\mathrm{CPD}}(\\phi) \\propto \\cos\\phi\\,$，如果锁定是纯同相的，可得到 $\\,S_x \\propto -2\\,\\left.\\frac{\\partial C}{\\partial z}\\right|_{z_0} V_0 V_{\\mathrm{ac}}\\,$ 且 $\\,S_y \\propto 0\\,$；更一般地，如果由于相位延迟存在正交分量，$\\,S_y\\,$ 则捕获 $\\,\\sin\\phi\\,$ 分量。关键地，任何在 $\\,\\phi\\,$ 上为偶的伪影项 $\\,S_{\\mathrm{art}}(\\phi)\\,$（与 $\\,\\phi\\,$ 无关或与 $\\,\\cos 2\\phi\\,$ 成正比）在这些差分中被抵消，因为 $\\,S_{\\mathrm{art}}(0) = S_{\\mathrm{art}}(\\pi)\\,$ 且 $\\,S_{\\mathrm{art}}(\\pi/2) = S_{\\mathrm{art}}(3\\pi/2)\\,$。一个保留与 CPD 相关的内容同时抑制在 $\\,\\phi\\,$ 上为偶的伪影的相位无关的 $\\,\\omega\\,$ 幅度估计量是\n$$\nS_{\\mathrm{clean}} \\equiv \\frac{1}{2}\\sqrt{S_x^2 + S_y^2}.\n$$\n因为 $\\,S_{\\mathrm{clean}}\\,$ 取决于在 $\\,\\phi\\,$ 上为奇的分量的幅值，它对 $\\,\\phi\\,$ 的选择以及同相与正交延迟不敏感，并且它可以用作反馈输入来调节 $\\,V_{\\mathrm{dc}}\\,$ 直到 $\\,S_{\\mathrm{clean}} = 0\\,$，即 $\\,V_{\\mathrm{dc}} = V_{\\mathrm{CPD}}\\,$，同时抑制了形貌引起的伪影。\n\n逐项分析：\n\nA. 该选项正确地指出了其机制：频率为 $\\,\\Omega\\,$ 的机械振荡调制了 $\\,\\partial C/\\partial z\\,$，后者乘以 $\\,\\cos(\\omega t + \\phi)\\,$ 项，产生一个包络与形貌相关的 $\\,\\omega\\,$ 频带信号。所提出的在 $\\,\\phi \\in \\{0, \\tfrac{\\pi}{2}, \\pi, \\tfrac{3\\pi}{2}\\}\\,$ 进行的四步相位循环以及反对称差分 $\\,S_x = S_0 - S_\\pi\\,$ 和 $\\,S_y = S_{\\pi/2} - S_{3\\pi/2}\\,$ 的构造，利用了与 CPD 相关的项的奇偶性和伪影的偶偶性来抵消后者。最终的幅值 $\\,S_{\\mathrm{clean}} = \\tfrac{1}{2}\\sqrt{S_x^2 + S_y^2}\\,$ 是相位无关的，并且适合用于反馈。这是有科学依据的，并且符合三角正交性。\n\n结论：正确。\n\nB. 该选项建议增加 $\\,V_{\\mathrm{ac}}\\,$ 和悬臂梁刚度来压倒伪影。虽然较大的 $\\,V_{\\mathrm{ac}}\\,$ 会增加 $\\,\\omega\\,$ 力，但它并不能消除 $\\,z(t)\\,$ 对 $\\,\\partial C/\\partial z\\,$ 的调制，也不能解决泄漏机制和奇偶性问题。此外，增加 $\\,V_{\\mathrm{ac}}\\,$ 可能会加剧非线性和 $\\,2\\omega\\,$ 项；刚度影响机械响应，但不影响产生伪影的电学混频。抛弃相位循环的说法是不合理的。\n\n结论：不正确。\n\nC. 该选项将伪影归因于 $\\,\\omega\\,$ 频率下的压电响应，并建议在 $\\,2\\omega\\,$ 频率下解调。通常，所讨论的主要 AM-KPFM 伪影源于通过 $\\,\\partial C/\\partial z(z(t))\\,$ 的电容混频，而非样品的体压电性。在 $\\,2\\omega\\,$ 频率下解调会将检测通道更改为由 $\\,V_{\\mathrm{ac}}^2\\,$ 项主导的通道，该通道本身对 $\\,\\partial C/\\partial z\\,$ 也有灵敏度，并且本质上不能消除形貌耦合。声称两相循环足够而无需线性组合是没有根据的，并且断言 $\\,2\\omega\\,$ 不受形貌引起的调制影响在存在依赖于 $\\,z(t)\\,$ 的电容时是错误的。\n\n结论：不正确。\n\nD. 该选项建议在固定的 $\\,\\phi\\,$ 下对直流偏压 $\\,V_{\\mathrm{dc}}\\,$ 在 $\\,\\pm V_0\\,$ 之间进行循环并对结果求平均。翻转 $\\,V_{\\mathrm{dc}}\\,$ 会改变 $\\,V_0\\,$ 和 $\\,\\omega\\,$ 项的符号，但对 $\\,S\\,$ 在 $\\,\\pm V_0\\,$ 处求平均会抑制人们试图测量的与 CPD 相关的分量；它不能选择性地抵消在 $\\,\\phi\\,$ 上为偶的伪影，并会混淆反馈。它也未能产生相位无关的估计量，且没有利用 $\\,\\phi\\,$ 中区分伪影和信号的奇偶性结构。\n\n结论：不正确。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "解析模型虽为理解KPFM提供了简洁的框架，但在面对粗糙或图形化样品等真实复杂情况时，其准确性会受到限制。本练习将指导您通过编程，从第一性原理出发，构建一个能够计算任意针尖-样品几何构型下电容导数$C'(z)$的数值估算器。通过亲手实现这一虚拟KPFM模型，您将深刻体会到在实际应用中，信号是如何形成的，以及哪些因素最终决定了测量的空间分辨率与准确性 。",
            "id": "4283915",
            "problem": "考虑开尔文探针力显微镜（KPFM），它通过测量导电探针与样品之间的静电相互作用来推断局域接触电势差。在调幅模式下，信号取决于针尖-样品电容相对于垂直间距的导数。令 $C(z)$ 表示间距为 $z$ 时的针尖-样品电容，其垂直导数为 $C'(z) = \\frac{\\partial C}{\\partial z}$。对于粗糙或图案化的样品以及非平凡的探针几何形状，那些假设表面光滑、平坦且形状简单的解析近似可能不准确。\n\n从静电学以及电容、能量和边界条件的定义出发，为放置在具有可能粗糙或图案化表面形貌以及可选介电覆盖层的样品上方的轴对称球形探针，设计一个用于计算 $C'(z)$ 的数值估计器。在该估计器中，使用球形针尖顶点的近轴近似，将局域间隙构建为横向坐标 $(x,y)$ 的函数。令局域样品形貌由标量场 $r(x,y)$ 表示，如果存在厚度为 $t$、相对介电常数为 $\\varepsilon_r$ 的介电薄膜，则通过一个等效串联间隙来计入其影响。您的估计器必须将横向域离散化为有限面积元（大小一致的矩形元），聚合局域贡献，并以 $\\mathrm{F/m}$ 为单位返回 $C'(z)$ 的带符号的值。\n\n您还必须从第一性原理出发，包含针对光滑平面样品和球形针尖顶点的基准解析计算，并在其中一个测试案例中，通过报告一个无单位浮点数形式的相对偏差，将数值估计器与此基准进行比较。在您的解决方案中，提供一个科学合理的讨论，说明解析模型在何时会失效，以及有限元策略将如何解决这些局限性，但您的程序应实现上述的有限面积离散化方法。\n\n您可以使用的基本原理包括：高斯定律、静电边界条件、电容定义 $C = Q/V$ 以及在恒定施加电势 $V$ 下的静电能量 $U = \\frac{1}{2} C V^2$。在您的解决方案中，未经推导不得假定任何专门的捷径公式。\n\n为您的程序采用以下建模假设：\n- 针尖顶点在局域上近似为半径为 $R$ 的球面；在顶点附近，由针尖曲率引起的针尖-样品间隙贡献为 $h_{\\mathrm{tip}}(x,y) \\approx \\frac{x^2 + y^2}{2R}$。\n- 对于介电薄膜，等效局域间隙为 $h_{\\mathrm{eff}}(x,y) = z + h_{\\mathrm{tip}}(x,y) - r(x,y) + \\frac{t}{\\varepsilon_r}$；如果没有薄膜，则取 $t = 0$ 和 $\\varepsilon_r = 1$。\n- 为避免非物理奇点，强制一个最小有效间隙 $h_{\\min}$，使得 $h_{\\mathrm{eff}}(x,y) \\ge h_{\\min}$ 处处成立。\n- 使用真空介电常数 $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}$。\n- 在以顶点为中心、边长为 $2L$ 的正方形上，用 $N_x \\times N_y$ 个均匀单元离散化横向域；单元上的中点积分是可接受的。\n- 最终的 $C'(z)$ 估计值必须通过聚合所有单元的局域贡献来计算，并以 $\\mathrm{F/m}$ 为单位作为带符号的值返回。\n\n测试套件：\n使用以下四个测试案例，每个案例由 $(R, z, r(x,y) \\text{ 类型与参数}, t, \\varepsilon_r, L \\text{ 缩放}, N_x, N_y, h_{\\min})$ 指定。所有长度单位必须是米，而 $C'(z)$ 必须以 $\\mathrm{F/m}$ 为单位返回。\n\n1. 光滑平面基准：\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - $r(x,y) = 0$ 处处成立\n   - $t = 0$, $\\varepsilon_r = 1$\n   - 域缩放：设置 $L = K \\sqrt{2 R z}$，其中 $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   输出数值估计值与光滑基准解析值之间的相对偏差，为一个无单位浮点数。\n\n2. 正弦粗糙度：\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - $r(x,y) = A \\sin\\left(2\\pi x/\\lambda_x\\right) \\sin\\left(2\\pi y/\\lambda_y\\right)$，其中 $A = 1 \\times 10^{-9}$，$\\lambda_x = 20 \\times 10^{-9}$，$\\lambda_y = 20 \\times 10^{-9}$\n   - $t = 0$, $\\varepsilon_r = 1$\n   - $L = K \\sqrt{2 R z}$，其中 $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   以 $\\mathrm{F/m}$ 为单位输出 $C'(z)$ 的带符号的值。\n\n3. 图案化沟槽：\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - 当 $\\lvert x \\rvert \\le w/2$ 时 $r(x,y) = -d$，否则 $r(x,y) = 0$，其中 $d = 3 \\times 10^{-9}$，$w = 20 \\times 10^{-9}$\n   - $t = 0$, $\\varepsilon_r = 1$\n   - $L = K \\sqrt{2 R z}$，其中 $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   以 $\\mathrm{F/m}$ 为单位输出 $C'(z)$ 的带符号的值。\n\n4. 带有轻微粗糙度的介电覆盖层：\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - $r(x,y) = A \\sin\\left(2\\pi x/\\lambda_x\\right) \\sin\\left(2\\pi y/\\lambda_y\\right)$，其中 $A = 0.5 \\times 10^{-9}$，$\\lambda_x = 20 \\times 10^{-9}$，$\\lambda_y = 20 \\times 10^{-9}$\n   - 介电薄膜厚度 $t = 3 \\times 10^{-9}$，相对介电常数 $\\varepsilon_r = 3.9$\n   - $L = K \\sqrt{2 R z}$，其中 $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   以 $\\mathrm{F/m}$ 为单位输出 $C'(z)$ 的带符号的值。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，并按测试案例的顺序排列结果，即 $[r_1,r_2,r_3,r_4]$，其中 $r_1$ 是案例1的无单位相对偏差，$r_2$、$r_3$、$r_4$ 是以 $\\mathrm{F/m}$ 为单位的 $C'(z)$ 的带符号的值。不应打印任何其他文本。",
            "solution": "该问题要求在开尔文探针力显微镜（KPFM）的背景下，为针尖-样品电容的垂直导数 $C'(z) = \\frac{\\partial C}{\\partial z}$ 设计一个数值估计器。这个值至关重要，因为它与调幅 AFM 模式下测量的静電力梯度直接相关。我们将首先从基本静电学原理推导出控制方程，然后基于有限面积离散化方法构建一个数值解，接着为基准情况推导一个配套的解析模型，最后讨论该模型的适用范围和局限性。\n\n储存在针尖-样品电容器中的静电能量由 $U = \\frac{1}{2} C V^2$ 给出，其中 $C$ 是电容，$V$ 是施加的电势差。作用在探针上的静电力的垂直分量是该能量相对于垂直间距 $z$ 的负梯度：\n$$F_z = -\\frac{\\partial U}{\\partial z} = -\\frac{\\partial}{\\partial z} \\left( \\frac{1}{2} C(z) V^2 \\right)$$\n假设施加的电压 $V$ 是恒定的，力变为：\n$$F_z = -\\frac{1}{2} V^2 \\frac{\\partial C(z)}{\\partial z} = -\\frac{1}{2} V^2 C'(z)$$\nKPFM信号与该力或其梯度成正比，这使得 $C'(z)$ 成为核心关注量。\n\n为了对电容 $C(z)$ 进行建模，我们采用一种常见的近似方法，将针尖-样品系统视为无穷小平​​行板电容器的连续体。样品表面上的每个面积元 $dA = dx\\,dy$ 与探针上的相应区域形成一个电容器。总电容是这些微元贡献的总和，因为它们都并联到同一个电势源上。一个微元平行板电容器的电容由 $dC = \\frac{\\varepsilon dA}{h}$ 给出，其中 $\\varepsilon$ 是介质的介电常数，$h$ 是间距。\n\n在我们的模型中，位于横向坐标 $(x,y)$ 处的针尖和样品之间的局域有效间隙 $h_{\\mathrm{eff}}(x,y)$ 考虑了几个因素：名义间距 $z$、针尖的曲率、样品的形貌以及样品上可能存在的介电薄膜。总有效间隙表示为：\n$$h_{\\mathrm{eff}}(x,y) = z + h_{\\mathrm{tip}}(x,y) - r(x,y) + \\frac{t}{\\varepsilon_r}$$\n此处，$z$ 是针尖顶点与样品基准面最高点之间的最小间距。项 $h_{\\mathrm{tip}}(x,y) \\approx \\frac{x^2+y^2}{2R}$ 代表在近轴近似下，由半径为 $R$ 的球形针尖的曲率引起的额外间隙。函数 $r(x,y)$ 描述了样品相对于参考平面的局域表面高度。项 $\\frac{t}{\\varepsilon_r}$ 考虑了厚度为 $t$、相对介电常数为 $\\varepsilon_r$ 的介电薄膜。该项源于将真空隙和介电层视为两个串联的电容器。对于一个面积元 $dA$，串联电容为 $dC = \\left( \\frac{h_{\\mathrm{vac}}}{\\varepsilon_0 dA} + \\frac{t}{\\varepsilon_r \\varepsilon_0 dA} \\right)^{-1} = \\frac{\\varepsilon_0 dA}{h_{\\mathrm{vac}} + t/\\varepsilon_r}$，其中 $h_{\\mathrm{vac}} = z + h_{\\mathrm{tip}}(x,y) - r(x,y)$。这证实了在介质为真空（介电常数为 $\\varepsilon_0$）时有效间隙的表达式。\n\n总电容是微元贡献在相互作用区域上的积分：\n$$C(z) = \\iint_A dC = \\iint_A \\frac{\\varepsilon_0}{h_{\\mathrm{eff}}(x,y)} dx\\,dy$$\n为了找到 $C'(z)$，我们对此表达式关于 $z$ 求导。由于积分域与 $z$ 无关，我们可以将导数移入积分内部：\n$$C'(z) = \\frac{\\partial}{\\partial z} \\iint_A \\frac{\\varepsilon_0}{h_{\\mathrm{eff}}(x,y)} dx\\,dy = \\iint_A \\varepsilon_0 \\frac{\\partial}{\\partial z} \\left( \\frac{1}{h_{\\mathrm{eff}}(x,y)} \\right) dx\\,dy$$\n使用链式法则，$\\frac{\\partial}{\\partial z} (h_{\\mathrm{eff}}^{-1}) = -h_{\\mathrm{eff}}^{-2} \\frac{\\partial h_{\\mathrm{eff}}}{\\partial z}$。从 $h_{\\mathrm{eff}}(x,y)$ 的定义可知，$\\frac{\\partial h_{\\mathrm{eff}}}{\\partial z} = 1$。将其代回，得到电容导数的最终积分表达式：\n$$C'(z) = -\\varepsilon_0 \\iint_A \\frac{1}{[h_{\\mathrm{eff}}(x,y)]^2} dx\\,dy$$\n此表达式是我们数值估计器的基础。预期结果为负号，因为间距减小时电容增加。\n\n对于光滑平面样品（$r(x,y)=0$）且无介电层（$t=0, \\varepsilon_r=1$）的基准情况，我们可以推导出解析解。有效间隙简化为 $h_{\\mathrm{eff}}(x,y) = z + \\frac{x^2+y^2}{2R}$。我们将 $C'(z)$ 的积分转换为极坐标 $(\\rho, \\phi)$，其中 $\\rho^2 = x^2+y^2$，$dx\\,dy = \\rho\\,d\\rho\\,d\\phi$。对于解析模型，积分域取为整个平面（$\\rho$ 从 $0$ 到 $\\infty$）。\n$$C'_{\\mathrm{analytic}}(z) = -\\varepsilon_0 \\int_0^{2\\pi} \\int_0^\\infty \\frac{1}{(z + \\frac{\\rho^2}{2R})^2} \\rho\\,d\\rho\\,d\\phi = -2\\pi\\varepsilon_0 \\int_0^\\infty \\frac{\\rho}{(z + \\frac{\\rho^2}{2R})^2} d\\rho$$\n为求解此积分，我们使用换元法，令 $u = z + \\frac{\\rho^2}{2R}$，这意味着 $du = \\frac{\\rho}{R} d\\rho$，或 $\\rho\\,d\\rho = R\\,du$。积分限从 $\\rho=0 \\to u=z$ 变为 $\\rho\\to\\infty \\to u\\to\\infty$。\n$$C'_{\\mathrm{analytic}}(z) = -2\\pi\\varepsilon_0 \\int_z^\\infty \\frac{R\\,du}{u^2} = -2\\pi\\varepsilon_0 R \\left[ -\\frac{1}{u} \\right]_z^\\infty = -2\\pi\\varepsilon_0 R \\left( 0 - \\left(-\\frac{1}{z}\\right) \\right)$$\n这就得到了在近轴近似下球体-平面模型的众所周知的解析结果：\n$$C'_{\\mathrm{analytic}}(z) = -\\frac{2\\pi\\varepsilon_0 R}{z}$$\n该结果将用于在第一个测试案例中验证我们的数值估计器。\n\n数值估计器是通过离散化 $C'(z)$ 的积分来构建的。积分域是一个边长为 $2L$、中心在 $(0,0)$ 的正方形，x 和 y 方向的范围均为 $-L$ 到 $L$。该域被划分为一个 $N_x \\times N_y$ 的矩形单元网格，每个单元的面积为 $\\Delta A = \\Delta x \\Delta y = (\\frac{2L}{N_x})(\\frac{2L}{N_y})$。积分通过使用中点法则的黎曼和来近似：\n$$C'_{\\mathrm{numerical}}(z) \\approx \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} -\\frac{\\varepsilon_0}{[h_{\\mathrm{eff}}(x_i, y_j)]^2} \\Delta A$$\n其中 $(x_i, y_j)$ 是第 $(i,j)$ 个单元中心的坐标。为防止除以零或出现非物理的小间隙，通过强制一个最小值 $h_{\\min}$ 来对计算出的有效间隙进行正则化：$h_{\\mathrm{eff}}(x_i, y_j) = \\max(h_{\\mathrm{eff, raw}}(x_i, y_j), h_{\\min})$。\n\n解析模型，如我们推导出的模型，功能强大但有显著局限性。它们仅对高度对称和理想化的几何形状是可解的。它们无法准确描述真实世界的情景，包括：\n$1$. **样品粗糙度**：任意的表面形貌破坏了径向对称性，使得 $C'(z)$ 的积分在解析上无法求解。\n$2$. **图案化的纳米结构**：纳米电子学中的样品通常具有复杂的图案，如沟槽、通孔或量子点，对于这些结构不存在简单的 $h_{\\mathrm{eff}}(x,y)$ 解析形式。\n$3$. **复杂的探针几何形状**：真实的AFM探针不是完美的球体，可能有制造缺陷、磨损或被有意塑形，这使得简单的近轴近似失效。\n\n数值方法对于克服这些局限性至关重要。此处实现的有限面积离散化方法是一种一阶方法。它能正确捕捉复杂形貌对局域间隙距离的影响。然而，它仍然依赖于每个单元的平行板假设并忽略了边缘场，即相邻单元之间的静电“串扰”。更高级的策略，如有限元法（FEM）或边界元法（BEM），将提供更高的准确性。这些方法在给定的边界条件下，在针尖-样品体积内数值求解拉普拉斯方程 $\\nabla^2V=0$。这直接计算出完整的静电势和场分布，内在地考虑了任意几何形状和边缘场效应，但代价是显著更高的计算复杂性。我们选择的方法在复杂形貌的准确性和计算可行性之间提供了良好的平衡。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the capacitance derivative C'(z) for various KPFM scenarios.\n    \"\"\"\n    \n    # Fundamental constant\n    EPSILON_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"smooth\"},\n            \"t\": 0.0, \"eps_r\": 1.0,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        },\n        {\n            \"case_id\": 2,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"sinusoidal\", \"A\": 1e-9, \"lambda_x\": 20e-9, \"lambda_y\": 20e-9},\n            \"t\": 0.0, \"eps_r\": 1.0,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        },\n        {\n            \"case_id\": 3,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"trench\", \"d\": 3e-9, \"w\": 20e-9},\n            \"t\": 0.0, \"eps_r\": 1.0,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        },\n        {\n            \"case_id\": 4,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"sinusoidal\", \"A\": 0.5e-9, \"lambda_x\": 20e-9, \"lambda_y\": 20e-9},\n            \"t\": 3e-9, \"eps_r\": 3.9,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        }\n    ]\n\n    results = []\n\n    for params in test_cases:\n        # Unpack parameters for clarity\n        R = params[\"R\"]\n        z = params[\"z\"]\n        t = params[\"t\"]\n        eps_r = params[\"eps_r\"]\n        K = params[\"K\"]\n        Nx = params[\"Nx\"]\n        Ny = params[\"Ny\"]\n        h_min = params[\"h_min\"]\n        \n        # Set up the spatial grid\n        L = K * np.sqrt(2 * R * z)\n        dx = 2 * L / Nx\n        dy = 2 * L / Ny\n        \n        # Create coordinate arrays representing the midpoints of grid cells\n        x_coords = np.linspace(-L + dx / 2, L - dx / 2, Nx)\n        y_coords = np.linspace(-L + dy / 2, L - dy / 2, Ny)\n        X, Y = np.meshgrid(x_coords, y_coords)\n        \n        # Calculate topography r(x,y)\n        topo_params = params[\"topo\"]\n        if topo_params[\"type\"] == \"smooth\":\n            r = np.zeros_like(X)\n        elif topo_params[\"type\"] == \"sinusoidal\":\n            A = topo_params[\"A\"]\n            lambda_x = topo_params[\"lambda_x\"]\n            lambda_y = topo_params[\"lambda_y\"]\n            r = A * np.sin(2 * np.pi * X / lambda_x) * np.sin(2 * np.pi * Y / lambda_y)\n        elif topo_params[\"type\"] == \"trench\":\n            d = topo_params[\"d\"]\n            w = topo_params[\"w\"]\n            r = np.where(np.abs(X) = w / 2, -d, 0)\n\n        # Calculate the effective local gap, h_eff(x,y)\n        # 1. Tip curvature contribution\n        h_tip = (X**2 + Y**2) / (2 * R)\n        # 2. Dielectric film contribution\n        h_dielectric = t / eps_r\n        # 3. Total effective gap before regularization\n        h_eff_raw = z + h_tip - r + h_dielectric\n        \n        # Apply the minimum gap regularization\n        h_eff = np.maximum(h_eff_raw, h_min)\n        \n        # Calculate C'(z) using numerical integration (summation)\n        # The integrand is -epsilon_0 / h_eff^2\n        integrand = -EPSILON_0 / h_eff**2\n        \n        # The area of each elemental rectangle\n        dA = dx * dy\n        \n        C_prime_numerical = np.sum(integrand) * dA\n        \n        # Process output based on the test case\n        if params[\"case_id\"] == 1:\n            # Baseline case: compare with analytical result\n            # C'_analytic = -2 * pi * epsilon_0 * R / z\n            C_prime_analytic = -2 * np.pi * EPSILON_0 * R / z\n            # Relative deviation is |(numerical - analytical) / analytical|\n            relative_deviation = np.abs((C_prime_numerical - C_prime_analytic) / C_prime_analytic)\n            results.append(f\"{relative_deviation:.12f}\")\n        else:\n            # Other cases: output the signed value of C'(z)\n            results.append(f\"{C_prime_numerical:.12e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}