{
    "hands_on_practices": [
        {
            "introduction": "A foundational step in analyzing any metal-semiconductor junction is to apply the Schottky-Mott rule, which provides an ideal prediction for the barrier height based on intrinsic material properties. However, experimental results frequently reveal a much weaker dependence on the metal's work function, a phenomenon known as Fermi-level pinning. This practice allows you to bridge the gap between ideal theory and experimental observation by calculating the pinning factor, a key parameter that quantifies the strength of these interface effects on the Schottky barrier height .",
            "id": "4269581",
            "problem": "A metal–semiconductor contact between titanium and crystalline silicon is formed at temperature $300\\,\\mathrm{K}$. The silicon is $n$-type and moderately doped so that space-charge layer narrowing does not induce significant image-force lowering of the barrier. The vacuum-level band alignment picture is valid in the absence of interface states, and the electron barrier height is defined as the energy difference between the semiconductor conduction-band minimum and the interface Fermi level on the silicon side. Assume the following data for silicon at $300\\,\\mathrm{K}$: electron affinity $\\,\\chi = 4.05\\,\\mathrm{eV}\\,$ and bandgap $\\,E_{g} = 1.12\\,\\mathrm{eV}\\,$. The titanium work function is $\\,\\Phi_{M} = 4.33\\,\\mathrm{eV}\\,$. A measurement of the electron Schottky barrier height for titanium on $n$-type silicon (e.g., by temperature-dependent current–voltage analysis) yields $\\,\\Phi_{Bn}^{\\mathrm{meas}} = 0.50\\,\\mathrm{eV}\\,$.\n\n1) Using only the vacuum-level band alignment picture and the provided quantities, compute the ideal electron barrier height that would be expected in the complete absence of interface states. Express this energy in $\\mathrm{eV}$.\n\n2) Now account for metal-induced gap states (MIGS). Model the interface Fermi level as a linear interpolation between the metal Fermi level and a charge neutrality level (CNL) intrinsic to the silicon surface states. Assume the charge neutrality level lies at midgap. Using this linear-pinning model, derive an expression that relates the measured electron barrier height $\\,\\Phi_{Bn}^{\\mathrm{meas}}\\,$, the metal work function $\\,\\Phi_{M}\\,$, the silicon electron affinity $\\,\\chi\\,$, and the silicon bandgap $\\,E_{g}\\,$ to the pinning factor $\\,S\\,$, defined as the sensitivity of the barrier height to the metal work function. Then, evaluate $\\,S\\,$ from the provided numerical data. Round your final $\\,S\\,$ to three significant figures. The final answer to be reported is the single numerical value of $\\,S\\,$ (dimensionless).",
            "solution": "This problem is analyzed in two parts. The first part addresses the ideal metal-semiconductor contact as described by the Schottky-Mott model. The second part introduces the effects of interface states through a linear Fermi-level pinning model.\n\nThe problem statement has been validated and is scientifically sound, well-posed, and objective. All necessary physical quantities and model assumptions are provided.\n\nPart 1: Ideal Electron Barrier Height\n\nIn the ideal case, free of interface states, the electron Schottky barrier height, $\\Phi_{Bn}^{\\mathrm{ideal}}$, is determined by the Schottky-Mott rule. This model assumes that when the metal and semiconductor are brought into contact, their vacuum levels align. The barrier for an electron to move from the metal into the semiconductor's conduction band is then the difference between the metal's work function, $\\Phi_M$, and the semiconductor's electron affinity, $\\chi$. The work function $\\Phi_M$ is the energy required to move an electron from the metal's Fermi level to the vacuum level. The electron affinity $\\chi$ is the energy released when an electron is moved from the vacuum level to the semiconductor's conduction band minimum, $E_C$.\n\nThe ideal electron barrier height is therefore given by the expression:\n$$\n\\Phi_{Bn}^{\\mathrm{ideal}} = \\Phi_M - \\chi\n$$\nUsing the provided values for titanium and silicon:\n$\\Phi_M = 4.33\\,\\mathrm{eV}$\n$\\chi = 4.05\\,\\mathrm{eV}$\n\nWe can compute the ideal barrier height:\n$$\n\\Phi_{Bn}^{\\mathrm{ideal}} = 4.33\\,\\mathrm{eV} - 4.05\\,\\mathrm{eV} = 0.28\\,\\mathrm{eV}\n$$\nThis ideal value of $0.28\\,\\mathrm{eV}$ is significantly different from the measured value of $\\Phi_{Bn}^{\\mathrm{meas}} = 0.50\\,\\mathrm{eV}$, which indicates that the simple Schottky-Mott model is insufficient and that interface effects, such as Fermi-level pinning, are present.\n\nPart 2: Pinning Factor Calculation\n\nTo account for the discrepancy, the problem introduces a model for Fermi-level pinning by metal-induced gap states (MIGS). The model states that the position of the Fermi level at the interface, $E_{F, \\text{int}}$, is a linear interpolation between the position it would have in the ideal Schottky-Mott case (determined by the metal work function) and a charge neutrality level (CNL), $E_{CNL}$, intrinsic to the semiconductor surface. This relationship is governed by the dimensionless pinning factor, $S$.\n\nLet all energy levels be referenced to the vacuum level, which is set to $0$.\nThe position of the metal's Fermi level is $E_{F,M} = -\\Phi_M$.\nThe problem states that the CNL lies at midgap. The energy of the conduction band minimum is $E_C = -\\chi$, and the energy of the valence band maximum is $E_V = -(\\chi + E_g)$. The midgap energy is therefore:\n$$\nE_{CNL} = E_V + \\frac{E_g}{2} = -(\\chi + E_g) + \\frac{E_g}{2} = -\\left(\\chi + \\frac{E_g}{2}\\right)\n$$\nThe linear interpolation for the interface Fermi level is:\n$$\nE_{F, \\text{int}} = S \\cdot E_{F,M} + (1-S) \\cdot E_{CNL}\n$$\nThis formulation correctly captures the two limits: for $S=1$ (no pinning), $E_{F, \\text{int}} = E_{F,M}$; for $S=0$ (strong pinning), $E_{F, \\text{int}} = E_{CNL}$.\n\nThe electron Schottky barrier height, $\\Phi_{Bn}$, is defined as the energy difference between the conduction band minimum at the interface, $E_C$, and the interface Fermi level, $E_{F, \\text{int}}$.\n$$\n\\Phi_{Bn} = E_C - E_{F, \\text{int}}\n$$\nSubstituting the expressions for the energy levels relative to vacuum ($E_C = -\\chi$):\n$$\n\\Phi_{Bn} = -\\chi - E_{F, \\text{int}} = -\\chi - \\left[ S \\cdot E_{F,M} + (1-S) \\cdot E_{CNL} \\right]\n$$\nNow, substitute the expressions for $E_{F,M}$ and $E_{CNL}$:\n$$\n\\Phi_{Bn} = -\\chi - \\left[ S \\cdot (-\\Phi_M) + (1-S) \\cdot \\left(-\\left(\\chi + \\frac{E_g}{2}\\right)\\right) \\right]\n$$\n$$\n\\Phi_{Bn} = -\\chi + S\\Phi_M + (1-S)\\left(\\chi + \\frac{E_g}{2}\\right)\n$$\nExpanding the last term:\n$$\n\\Phi_{Bn} = -\\chi + S\\Phi_M + \\chi + \\frac{E_g}{2} - S\\chi - S\\frac{E_g}{2}\n$$\nSimplifying the expression by grouping terms with $S$:\n$$\n\\Phi_{Bn} = S(\\Phi_M - \\chi) + (1-S)\\frac{E_g}{2}\n$$\nThis expression relates the barrier height $\\Phi_{Bn}$ to the material properties and the pinning factor $S$. The definition of $S$ as the sensitivity of the barrier to the metal work function, $S = \\frac{d\\Phi_{Bn}}{d\\Phi_M}$, is consistent with this derived formula.\n\nWe can now solve for the pinning factor $S$ using the measured barrier height, $\\Phi_{Bn}^{\\mathrm{meas}}$.\n$$\n\\Phi_{Bn}^{\\mathrm{meas}} = S(\\Phi_M - \\chi) + \\frac{E_g}{2} - S\\frac{E_g}{2}\n$$\n$$\n\\Phi_{Bn}^{\\mathrm{meas}} - \\frac{E_g}{2} = S\\left( (\\Phi_M - \\chi) - \\frac{E_g}{2} \\right)\n$$\n$$\nS = \\frac{\\Phi_{Bn}^{\\mathrm{meas}} - \\frac{E_g}{2}}{(\\Phi_M - \\chi) - \\frac{E_g}{2}}\n$$\nWe are given the following numerical values:\n$\\Phi_{Bn}^{\\mathrm{meas}} = 0.50\\,\\mathrm{eV}$\n$\\Phi_M = 4.33\\,\\mathrm{eV}$\n$\\chi = 4.05\\,\\mathrm{eV}$\n$E_g = 1.12\\,\\mathrm{eV}$\n\nFirst, calculate the intermediate terms:\n$$\n\\frac{E_g}{2} = \\frac{1.12\\,\\mathrm{eV}}{2} = 0.56\\,\\mathrm{eV}\n$$\n$$\n\\Phi_M - \\chi = 4.33\\,\\mathrm{eV} - 4.05\\,\\mathrm{eV} = 0.28\\,\\mathrm{eV}\n$$\nNow, substitute these into the expression for $S$:\n$$\nS = \\frac{0.50\\,\\mathrm{eV} - 0.56\\,\\mathrm{eV}}{0.28\\,\\mathrm{eV} - 0.56\\,\\mathrm{eV}} = \\frac{-0.06\\,\\mathrm{eV}}{-0.28\\,\\mathrm{eV}} = \\frac{6}{28} = \\frac{3}{14}\n$$\nEvaluating the fraction gives:\n$$\nS \\approx 0.2142857...\n$$\nRounding the result to three significant figures, as requested, we obtain:\n$$\nS \\approx 0.214\n$$\nThis value, being much less than $1$, confirms that the Ti/n-Si interface is subject to significant Fermi-level pinning, moving it away from the ideal Schottky-Mott behavior and towards the Bardeen limit where the barrier height is determined primarily by interface states.",
            "answer": "$$\n\\boxed{0.214}\n$$"
        },
        {
            "introduction": "As devices shrink to the nanoscale, a quantum mechanical perspective becomes essential, and the concept of resistance is best understood through electron transmission. This practice moves beyond semi-classical models to the Landauer formalism, the cornerstone of quantum transport, to determine the fundamental lower limit of contact resistance in a pristine graphene device. By treating electrons as waves and counting the available conduction channels, you will derive the quantum contact resistance from first principles and explore its dependence on the material's electronic structure .",
            "id": "4269543",
            "problem": "A monolayer graphene sheet of width $W$ is contacted by a large-area metallic reservoir. Under the metal, the graphene Fermi level is shifted by $\\Delta E_F$ relative to the Dirac point due to charge transfer and work function alignment. Assume the interface is atomically clean, momentum-conserving, and that mode injection is ballistic with unity transmission for all available propagating modes. Treat graphene’s low-energy quasiparticles by the linear Dirac dispersion $E = \\hbar v_F |k|$, where $v_F$ is the Fermi velocity, and use the Landauer formalism for conduction. Take the valley degeneracy to be $g_v = 2$, and assume the spin degeneracy is already accounted for by the Landauer prefactor. The metallic reservoir has a very large number of modes compared to graphene, so the interface conductance is limited by the number of modes available in the graphene under-contact region at the Fermi level.\n\nStarting from first principles, derive the dependence of the quantum-limited contact resistance $R_c$ on the Fermi level shift $\\Delta E_F$ under the contact. Then evaluate $R_c$ for a contact of width $W = 1.00\\,\\mu\\mathrm{m}$, Fermi velocity $v_F = 1.00 \\times 10^6\\,\\mathrm{m/s}$, and Fermi level shift $\\Delta E_F = 0.25\\,\\mathrm{eV}$. Use the elementary charge $q$ and the reduced Planck constant $\\hbar$ as needed. Express the final $R_c$ in $\\Omega$ and round your answer to three significant figures.",
            "solution": "The problem requires the derivation of the quantum-limited contact resistance $R_c$ for a graphene-metal interface and its subsequent numerical evaluation. The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- System: Monolayer graphene sheet of width $W$.\n- Contact: Large-area metallic reservoir.\n- Fermi level shift: $\\Delta E_F$ relative to the Dirac point under the contact.\n- Interface  Transport: Atomically clean, momentum-conserving, ballistic mode injection with unity transmission for all available propagating modes.\n- Graphene model: Linear Dirac dispersion $E = \\hbar v_F |k|$, where $v_F$ is the Fermi velocity.\n- Method: Landauer formalism for conduction.\n- Degeneracy: Valley degeneracy $g_v = 2$; spin degeneracy is stated to be accounted for by the Landauer prefactor.\n- Assumption: The metallic reservoir has a very large number of modes, making graphene the limiting factor.\n- Task 1: Derive the functional dependence of contact resistance $R_c$ on the Fermi level shift $\\Delta E_F$.\n- Task 2: Evaluate $R_c$ for $W = 1.00\\,\\mu\\mathrm{m}$, $v_F = 1.00 \\times 10^6\\,\\mathrm{m/s}$, and $\\Delta E_F = 0.25\\,\\mathrm{eV}$.\n- Constants to be used: elementary charge $q$ (denoted here as $e$), reduced Planck constant $\\hbar$.\n- Final answer: $R_c$ in Ohms ($\\Omega$), rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing standard models of nanoelectronics and quantum transport (Landauer formalism, Dirac dispersion for graphene, momentum quantization). It is well-posed, providing all necessary information and assumptions (ballistic transport, unity transmission, defined degeneracies) to arrive at a unique, meaningful solution for the quantum-limited resistance. The language is objective and precise. The numerical values provided are physically realistic for graphene nanodevices. The problem does not violate any of the invalidity criteria (e.g., it is not factually unsound, incomplete, or ill-posed).\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe contact resistance $R_c$ is the inverse of the contact conductance $G$, given by $R_c = 1/G$. We begin by deriving the conductance using the Landauer formalism. The Landauer formula for a multi-channel conductor is:\n$$\nG = G_0 \\sum_{i} T_i\n$$\nwhere $T_i$ is the transmission probability of the $i$-th conducting channel and $G_0$ is the quantum of conductance per channel. The problem states that spin degeneracy is accounted for in this prefactor, which sets $G_0 = 2e^2/h = e^2/(\\pi\\hbar)$, where $e$ is the elementary charge, $h$ is the Planck constant, and $\\hbar = h/(2\\pi)$ is the reduced Planck constant. The problem also specifies unity transmission for all available modes, so $T_i=1$ for every propagating mode. The summation then simplifies to counting the total number of available conducting modes, $M$.\n$$\nG = \\frac{2e^2}{h} M\n$$\nThe total number of modes $M$ is the product of the number of orbital (or transverse spatial) modes $M_{orb}$ and the valley degeneracy $g_v$. The spin degeneracy is already included in the prefactor. Given $g_v=2$, we have $M = g_v M_{orb} = 2 M_{orb}$.\n\nTo find $M_{orb}$, we consider the quantization of the electron wavevector in the graphene sheet of width $W$. Let the direction of transport be along the $x$-axis and the confined direction be along the $y$-axis. For a width $W$, we can impose hard-wall boundary conditions, which quantizes the transverse component of the wavevector, $k_y$:\n$$\nk_y = \\frac{n\\pi}{W}, \\quad \\text{where } n = 1, 2, 3, \\ldots\n$$\nThe energy dispersion relation for low-energy quasiparticles in graphene is $E = \\hbar v_F |k|$, where $|k| = \\sqrt{k_x^2 + k_y^2}$. At the Fermi level in the contact region, the energy is $E = \\Delta E_F$. Thus, the magnitude of the Fermi wavevector is $k_F = |\\Delta E_F| / (\\hbar v_F)$.\n$$\n\\left(\\frac{\\Delta E_F}{\\hbar v_F}\\right)^2 = k_x^2 + k_y^2\n$$\nA mode is a propagating mode if its longitudinal wavevector component, $k_x$, is real. This requires $k_x^2 \\ge 0$, which leads to the condition:\n$$\n\\left(\\frac{\\Delta E_F}{\\hbar v_F}\\right)^2 \\ge k_y^2\n$$\nSubstituting the quantized values for $k_y$:\n$$\n\\frac{|\\Delta E_F|}{\\hbar v_F} \\ge \\frac{n\\pi}{W}\n$$\nThe number of orbital modes, $M_{orb}$, is the total number of integer values of $n$ that satisfy this condition.\n$$\nn \\le \\frac{W |\\Delta E_F|}{\\pi \\hbar v_F}\n$$\nTherefore, $M_{orb}$ is the largest integer less than or equal to this value:\n$$\nM_{orb} = \\left\\lfloor \\frac{W |\\Delta E_F|}{\\pi \\hbar v_F} \\right\\rfloor\n$$\nFor typical device parameters, such as those given in this problem, the number of modes is large ($M_{orb} \\gg 1$). In this regime, it is an excellent approximation to neglect the floor function and treat the number of modes as a continuous quantity:\n$$\nM_{orb} \\approx \\frac{W |\\Delta E_F|}{\\pi \\hbar v_F}\n$$\nThe total number of conducting channels is $M = 2 M_{orb}$:\n$$\nM \\approx \\frac{2 W |\\Delta E_F|}{\\pi \\hbar v_F}\n$$\nNow, we substitute this into the Landauer formula for conductance:\n$$\nG = \\frac{2e^2}{h} M \\approx \\frac{2e^2}{h} \\left(\\frac{2 W |\\Delta E_F|}{\\pi \\hbar v_F}\\right) = \\frac{4 e^2 W |\\Delta E_F|}{h \\pi \\hbar v_F}\n$$\nThe contact resistance $R_c$ is the inverse of the conductance $G$:\n$$\nR_c = \\frac{1}{G} \\approx \\frac{h \\pi \\hbar v_F}{4 e^2 W |\\Delta E_F|}\n$$\nThis expression gives the dependence of $R_c$ on $\\Delta E_F$; specifically, $R_c \\propto 1/|\\Delta E_F|$. We can write this more compactly by substituting $h=2\\pi\\hbar$:\n$$\nR_c = \\frac{(2\\pi\\hbar) \\pi \\hbar v_F}{4 e^2 W |\\Delta E_F|} = \\frac{2\\pi^2 \\hbar^2 v_F}{4 e^2 W |\\Delta E_F|} = \\frac{\\pi^2 \\hbar^2 v_F}{2 e^2 W |\\Delta E_F|}\n$$\n\n### Numerical Evaluation\n\nWe are asked to evaluate $R_c$ for the given parameters:\n- $W = 1.00\\,\\mu\\mathrm{m} = 1.00 \\times 10^{-6}\\,\\mathrm{m}$\n- $v_F = 1.00 \\times 10^6\\,\\mathrm{m/s}$\n- $\\Delta E_F = 0.25\\,\\mathrm{eV}$\n\nWe use the following physical constants:\n- $\\hbar \\approx 1.05457 \\times 10^{-34}\\,\\mathrm{J \\cdot s}$\n- $e \\approx 1.60218 \\times 10^{-19}\\,\\mathrm{C}$\n\nFirst, we must convert the energy $\\Delta E_F$ to SI units (Joules):\n$$\n\\Delta E_F = 0.25\\,\\mathrm{eV} \\times (1.60218 \\times 10^{-19}\\,\\mathrm{J/eV}) \\approx 4.00545 \\times 10^{-20}\\,\\mathrm{J}\n$$\nNow, we substitute all values into the derived expression for $R_c$:\n$$\nR_c = \\frac{\\pi^2 \\hbar^2 v_F}{2 e^2 W \\Delta E_F}\n$$\n$$\nR_c \\approx \\frac{(3.14159)^2 (1.05457 \\times 10^{-34}\\,\\mathrm{J \\cdot s})^2 (1.00 \\times 10^6\\,\\mathrm{m/s})}{2 (1.60218 \\times 10^{-19}\\,\\mathrm{C})^2 (1.00 \\times 10^{-6}\\,\\mathrm{m}) (4.00545 \\times 10^{-20}\\,\\mathrm{J})}\n$$\nLet's compute the numerator and denominator separately.\nNumerator:\n$$\nN = (9.86960) \\times (1.11212 \\times 10^{-68}\\,\\mathrm{J^2 s^2}) \\times (1.00 \\times 10^6\\,\\mathrm{m/s}) \\approx 1.09748 \\times 10^{-61}\\,\\mathrm{J^2 \\cdot s \\cdot m}\n$$\nDenominator:\n$$\nD = 2 \\times (2.56698 \\times 10^{-38}\\,\\mathrm{C^2}) \\times (1.00 \\times 10^{-6}\\,\\mathrm{m}) \\times (4.00545 \\times 10^{-20}\\,\\mathrm{J}) \\approx 2.05630 \\times 10^{-63}\\,\\mathrm{C^2 \\cdot m \\cdot J}\n$$\nNow, we compute the ratio:\n$$\nR_c = \\frac{N}{D} \\approx \\frac{1.09748 \\times 10^{-61}}{2.05630 \\times 10^{-63}}\\,\\frac{\\mathrm{J^2 \\cdot s \\cdot m}}{\\mathrm{C^2 \\cdot m \\cdot J}} \\approx 53.371\\,\\frac{\\mathrm{J \\cdot s}}{\\mathrm{C^2}}\n$$\nThe unit $\\mathrm{J \\cdot s / C^2}$ is equivalent to the Ohm ($\\Omega$), since voltage $V = J/C$ and current $I = C/s$, so resistance $R=V/I = (J/C)/(C/s) = J \\cdot s / C^2$.\nThe calculated value is $R_c \\approx 53.371\\,\\Omega$. Rounding to three significant figures as required, we get:\n$$\nR_c \\approx 53.4\\,\\Omega\n$$",
            "answer": "$$\\boxed{53.4}$$"
        },
        {
            "introduction": "Pristine, perfect interfaces represent an idealized limit; real-world nanodevices are inevitably subject to atomic-scale disorder that can dominate their performance. To model these complex effects, we turn to powerful computational tools like the Non-Equilibrium Green's Function (NEGF) formalism. This hands-on simulation challenges you to implement the NEGF method to quantify how specific types of interface defects, such as vacancies and adsorbates, disrupt coherent electron transport and increase contact resistance .",
            "id": "4269579",
            "problem": "Consider a two-terminal nanodevice described by a single-orbital nearest-neighbor tight-binding Hamiltonian connected to semi-infinite leads. The device region has $N$ sites with on-site energy $\\epsilon_\\mathrm{d}$ and nearest-neighbor hopping $t_\\mathrm{d}$. The left and right semi-infinite leads have on-site energy $\\epsilon_\\ell$ and nearest-neighbor hopping $t_\\ell$, and couple to the first and last device sites via couplings $\\tau_\\mathrm{L}$ and $\\tau_\\mathrm{R}$, respectively. Assume a spinless model, zero temperature, and coherent transport. The Non-Equilibrium Green's Function (NEGF) framework defines the retarded device Green's function as $G^r(E) = \\left[E + i\\eta - H_\\mathrm{d} - \\Sigma_\\mathrm{L}^r(E) - \\Sigma_\\mathrm{R}^r(E)\\right]^{-1}$, where $\\eta$ is a positive infinitesimal, $H_\\mathrm{d}$ is the device Hamiltonian, and $\\Sigma_\\mathrm{L}^r(E)$ and $\\Sigma_\\mathrm{R}^r(E)$ are the retarded self-energies from the leads onto the device. The transmission is $T(E) = \\mathrm{Tr}\\left[\\Gamma_\\mathrm{L}(E)\\,G^r(E)\\,\\Gamma_\\mathrm{R}(E)\\,G^a(E)\\right]$, where $G^a(E) = \\left[G^r(E)\\right]^\\dagger$ and $\\Gamma_{\\alpha}(E) = i\\left[\\Sigma_{\\alpha}^r(E) - \\left(\\Sigma_{\\alpha}^r(E)\\right)^\\dagger\\right]$ for $\\alpha \\in \\{\\mathrm{L},\\mathrm{R}\\}$. For a semi-infinite one-dimensional lead, the surface Green's function $g_s^r(E)$ at the terminating site satisfies $t_\\ell^2\\,g_s^r(E)^2 - (E - \\epsilon_\\ell)\\,g_s^r(E) + 1 = 0$, and the physical branch is selected by the retarded boundary condition.\n\nInterface disorder is to be included as follows:\n- A vacancy at the interface is modeled by replacing the on-site energy of the first device site with a large repulsive potential $U_\\mathrm{vac}$ (effectively mimicking site removal in the tight-binding description).\n- An adsorbate at the interface is modeled by adding a single side-coupled orbital of on-site energy $\\epsilon_\\mathrm{a}$ connected to the first device site with coupling $v_\\mathrm{a}$.\n\nThe contact resistance at energy $E$ is defined via the Landauer formalism as $R_\\mathrm{c}(E) = \\dfrac{h}{q^2}\\dfrac{1}{T(E)}$, where $h$ is Planck's constant and $q$ is the elementary charge. The relative contact resistance due to disorder, with respect to the pristine interface, is $\\Delta R_\\mathrm{c}(E) = R_\\mathrm{c}^\\mathrm{dis}(E) - R_\\mathrm{c}^\\mathrm{pris}(E)$.\n\nYour task is to implement a complete program that:\n1. Constructs $H_\\mathrm{d}$ for each specified case, augmenting it when an adsorbate is present.\n2. Computes the lead self-energies using the physically correct retarded branch of $g_s^r(E)$.\n3. Evaluates $T(E)$ for a specified energy grid.\n4. Computes $R_\\mathrm{c}(E_\\mathrm{F})$ at a specified Fermi energy $E_\\mathrm{F}$ and returns $\\Delta R_\\mathrm{c}(E_\\mathrm{F})$ relative to the pristine case.\n\nUse the following test suite of parameter sets to ensure coverage:\n- Case $1$ (pristine): $N=5$, $\\epsilon_\\mathrm{d}=0.0\\,\\mathrm{eV}$, $t_\\mathrm{d}=1.0\\,\\mathrm{eV}$, $\\epsilon_\\ell=0.0\\,\\mathrm{eV}$, $t_\\ell=1.0\\,\\mathrm{eV}$, $\\tau_\\mathrm{L}=\\tau_\\mathrm{R}=1.0\\,\\mathrm{eV}$, no vacancy, no adsorbate, energy grid $E\\in[-0.5,0.0,0.5]\\,\\mathrm{eV}$, $E_\\mathrm{F}=0.0\\,\\mathrm{eV}$.\n- Case $2$ (vacancy at the interface): same as Case $1$ but set the on-site energy of the first device site to $U_\\mathrm{vac}=10.0\\,\\mathrm{eV}$, no adsorbate.\n- Case $3$ (adsorbate at the interface): same as Case $1$ but add an adsorbate orbital with $\\epsilon_\\mathrm{a}=0.0\\,\\mathrm{eV}$ and $v_\\mathrm{a}=0.5\\,\\mathrm{eV}$ side-coupled to the first device site, no vacancy.\n- Case $4$ (combined disorder): $N=5$, $\\epsilon_\\mathrm{d}=0.0\\,\\mathrm{eV}$, $t_\\mathrm{d}=1.0\\,\\mathrm{eV}$, $\\epsilon_\\ell=0.0\\,\\mathrm{eV}$, $t_\\ell=1.0\\,\\mathrm{eV}$, $\\tau_\\mathrm{L}=0.7\\,\\mathrm{eV}$, $\\tau_\\mathrm{R}=1.0\\,\\mathrm{eV}$, set the on-site energy of the first device site to $U_\\mathrm{vac}=5.0\\,\\mathrm{eV}$, add an adsorbate orbital with $\\epsilon_\\mathrm{a}=0.2\\,\\mathrm{eV}$ and $v_\\mathrm{a}=0.7\\,\\mathrm{eV}$, energy grid $E\\in[-0.5,0.0,0.5]\\,\\mathrm{eV}$, $E_\\mathrm{F}=0.0\\,\\mathrm{eV}$.\n\nScientific realism constraints:\n- Use a small positive $\\eta$ (e.g., $\\eta=10^{-12}\\,\\mathrm{eV}$) to ensure numerical stability without unphysical broadening.\n- Use $h=6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$ and $q=1.602176634\\times 10^{-19}\\,\\mathrm{C}$ for constants. Express resistances in $\\mathrm{\\Omega}$.\n\nFor each case $j$, compute:\n- The average transmission over the grid, $\\langle T\\rangle_j = \\frac{1}{M}\\sum_{m=1}^{M} T(E_m)$.\n- The difference in contact resistance at $E_\\mathrm{F}$ relative to pristine, $\\Delta R_{\\mathrm{c},j}(E_\\mathrm{F}) = R_{\\mathrm{c},j}(E_\\mathrm{F}) - R_{\\mathrm{c},\\mathrm{pristine}}(E_\\mathrm{F})$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing a list of four entries, one per case, where each entry is a two-element list $[\\langle T\\rangle_j,\\Delta R_{\\mathrm{c},j}(E_\\mathrm{F})]$.\n- The pristine case should report $\\Delta R_{\\mathrm{c},1}(E_\\mathrm{F})=0.0$ by definition.\n- The output must be a single line in the form $[[\\langle T\\rangle_1,\\Delta R_{\\mathrm{c},1}],[\\langle T\\rangle_2,\\Delta R_{\\mathrm{c},2}],[\\langle T\\rangle_3,\\Delta R_{\\mathrm{c},3}],[\\langle T\\rangle_4,\\Delta R_{\\mathrm{c},4}]]$ with numerical values, where resistances are in $\\mathrm{\\Omega}$.",
            "solution": "The problem requires the calculation of the relative change in contact resistance for a two-terminal nanodevice due to interface disorder, using the Non-Equilibrium Green's Function (NEGF) formalism within a tight-binding model. The solution entails a systematic, principle-based implementation of the quantum transport calculation for four distinct cases: a pristine device, a device with a vacancy, a device with a side-coupled adsorbate, and a device with combined disorder.\n\nThe core of the calculation is the Landauer formula for conductance, which at zero temperature relates the transmission probability $T(E)$ at a given energy $E$ to the electrical resistance. The contact resistance is given by $R_\\mathrm{c}(E) = R_0 / T(E)$, where $R_0 = h/q^2$ is the quantum of resistance, with $h$ being Planck's constant and $q$ the elementary charge. The transmission $T(E)$ is computed using the NEGF method.\n\nThe methodology can be broken down into the following sequential steps:\n\n**1. Modeling the Leads: Surface Green's Function and Self-Energies**\n\nThe semi-infinite leads are electrodes that inject and collect electrons. Their effect on the finite device region is encapsulated by self-energy terms, $\\Sigma_\\mathrm{L}^r(E)$ and $\\Sigma_\\mathrm{R}^r(E)$. For a one-dimensional, nearest-neighbor tight-binding lead with on-site energy $\\epsilon_\\ell$ and hopping $t_\\ell$, the self-energy is determined by the lead's surface Green's function, $g_s^r(E)$, and the coupling strength $\\tau$ between the lead and the device. The surface Green's function is found by solving the quadratic equation:\n$$t_\\ell^2 \\, (g_s^r(E))^2 - (E - \\epsilon_\\ell) \\, g_s^r(E) + 1 = 0$$\nSolving this for $g_s^r(E)$ yields two solutions. The physically correct \"retarded\" solution is chosen to ensure causality, which corresponds to outgoing wave boundary conditions. This solution has a negative imaginary part for energies inside the leads' conduction band ($|E - \\epsilon_\\ell|  2|t_\\ell|$). The correct branch is:\n$$g_s^r(E) = \\frac{(E - \\epsilon_\\ell) - \\sqrt{(E - \\epsilon_\\ell)^2 - 4t_\\ell^2}}{2t_\\ell^2}$$\nTo handle the complex square root correctly in numerical computation, this is implemented as $\\sqrt{(E - \\epsilon_\\ell)^2 - 4t_\\ell^2 + i0^+}$. The self-energy from a lead $\\alpha \\in \\{\\mathrm{L}, \\mathrm{R}\\}$ is a matrix that is zero everywhere except for the element corresponding to the device site it couples to. The left lead couples to site $1$ (index $0$) and the right lead to site $N$ (index $N-1$). Thus, the self-energy matrices are:\n$$[\\Sigma_\\mathrm{L}^r(E)]_{ij} = \\delta_{i0}\\delta_{j0} \\, \\tau_\\mathrm{L}^2 \\, g_s^r(E)$$\n$$[\\Sigma_\\mathrm{R}^r(E)]_{ij} = \\delta_{i,N-1}\\delta_{j,N-1} \\, \\tau_\\mathrm{R}^2 \\, g_s^r(E)$$\n\n**2. Constructing the Device Hamiltonian ($H_\\mathrm{d}$)**\n\nThe device region itself is described by a tight-binding Hamiltonian matrix $H_\\mathrm{d}$. For a pristine $N$-site device, this is an $N \\times N$ tridiagonal matrix:\n$$(H_\\mathrm{d})_{ij} = \\begin{cases} \\epsilon_\\mathrm{d}  \\text{if } i=j \\\\ t_\\mathrm{d}  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases}$$\nDisorder is incorporated by modifying this Hamiltonian:\n-   **Vacancy**: A vacancy at the first site is modeled by setting its on-site energy to a large repulsive value, $(H_\\mathrm{d})_{00} = U_\\mathrm{vac}$.\n-   **Adsorbate**: An adsorbate is modeled as an additional site (site $N$, index-wise) coupled to the first device site. The system's Hilbert space is expanded, and the Hamiltonian becomes an $(N+1) \\times (N+1)$ matrix. The original $N \\times N$ Hamiltonian forms the top-left block. The new elements are the adsorbate on-site energy $(H_\\mathrm{d})_{NN} = \\epsilon_\\mathrm{a}$ and its coupling to site $1$, $(H_\\mathrm{d})_{0N} = (H_\\mathrm{d})_{N0} = v_\\mathrm{a}$. The self-energy matrices must also be expanded to this new dimension, though their non-zero elements remain at the same positions, coupling to sites $0$ and $N-1$.\n\n**3. Calculating the Retarded Green's Function ($G^r(E)$)**\n\nThe retarded Green's function for the device, including the influence of the leads, is the central object in the NEGF formalism. It is the inverse of the effective Hamiltonian matrix:\n$$G^r(E) = \\left[ (E + i\\eta)I - H_\\mathrm{d} - \\Sigma_\\mathrm{L}^r(E) - \\Sigma_\\mathrm{R}^r(E) \\right]^{-1}$$\nHere, $I$ is the identity matrix of the same dimension as $H_\\mathrm{d}$, and $\\eta$ is a small positive infinitesimal that enforces retarded boundary conditions and ensures numerical stability of the matrix inversion.\n\n**4. Computing the Transmission ($T(E)$)**\n\nThe transmission probability $T(E)$ is given by the Fisher-Lee relation:\n$$T(E) = \\mathrm{Tr}\\left[\\Gamma_\\mathrm{L}(E) \\, G^r(E) \\, \\Gamma_\\mathrm{R}(E) \\, G^a(E)\\right]$$\nwhere $G^a(E) = [G^r(E)]^\\dagger$ is the advanced Green's function and $\\Gamma_\\alpha(E)$ are the broadening matrices, which describe the rate at which electrons can enter/exit the device from/to lead $\\alpha$. They are defined as:\n$$\\Gamma_{\\alpha}(E) = i\\left[\\Sigma_{\\alpha}^r(E) - \\left(\\Sigma_{\\alpha}^r(E)\\right)^\\dagger\\right] = -2\\mathrm{Im}\\left[\\Sigma_{\\alpha}^r(E)\\right]$$\nSince $\\Sigma_\\mathrm{L}^r$ and $\\Sigma_\\mathrm{R}^r$ have only one non-zero element each (at $(0,0)$ and $(N-1,N-1)$ respectively), the trace formula simplifies significantly to:\n$$T(E) = [\\Gamma_\\mathrm{L}(E)]_{00} \\, [\\Gamma_\\mathrm{R}(E)]_{N-1,N-1} \\, |[G^r(E)]_{0,N-1}|^2$$\nThis computationally efficient form is used for the calculation.\n\n**5. Final Resistance Calculation**\n\nThe procedure is executed for each case specified in the problem statement. First, the transport properties of the pristine device (Case 1) are calculated to establish a baseline. The transmission $T_1(E_\\mathrm{F})$ at the Fermi energy $E_\\mathrm{F}$ gives the pristine contact resistance $R_{\\mathrm{c},1}(E_\\mathrm{F}) = R_0 / T_1(E_\\mathrm{F})$.\nThen, for each case $j$ (including disorder), we compute its transmission spectrum $T_j(E)$, average transmission $\\langle T \\rangle_j$, and contact resistance $R_{\\mathrm{c},j}(E_\\mathrm{F})$. The relative change in contact resistance is then found by subtraction:\n$$\\Delta R_{\\mathrm{c},j}(E_\\mathrm{F}) = R_{\\mathrm{c},j}(E_\\mathrm{F}) - R_{\\mathrm{c},1}(E_\\mathrm{F})$$\nBy definition, $\\Delta R_{\\mathrm{c},1}(E_\\mathrm{F})$ is $0$. The average transmission $\\langle T \\rangle_j$ is calculated by averaging $T_j(E)$ over the specified energy grid. The final output collates $[\\langle T \\rangle_j, \\Delta R_{\\mathrm{c},j}(E_\\mathrm{F})]$ for all four cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates average transmission and change in contact resistance for a nanodevice\n    using the Non-Equilibrium Green's Function (NEGF) formalism.\n    \"\"\"\n\n    # Physical constants\n    h = 6.62607015e-34  # Planck constant in J.s\n    q = 1.602176634e-19  # Elementary charge in C\n    R0 = h / q**2        # Quantum of resistance in Ohms\n    eta = 1e-12          # Infinitesimal for Green's functions\n\n    def compute_transmissions(params):\n        \"\"\"\n        Computes the transmission T(E) over an energy grid for a given set of parameters.\n        \"\"\"\n        N = params['N']\n        eps_d = params['eps_d']\n        t_d = params['t_d']\n        eps_l = params['eps_l']\n        t_l = params['t_l']\n        tau_L = params['tau_L']\n        tau_R = params['tau_R']\n        energy_grid = params['energy_grid']\n        U_vac = params.get('U_vac')\n        eps_a = params.get('eps_a')\n        v_a = params.get('v_a')\n\n        has_adsorbate = eps_a is not None and v_a is not None\n        dim = N + 1 if has_adsorbate else N\n\n        transmissions = []\n        for E in energy_grid:\n            # 1. Lead Surface Green's Function and Self-Energies\n            # The +0j ensures the result is complex if the argument is negative\n            sqrt_term = np.sqrt((E - eps_l)**2 - 4 * t_l**2 + 0j)\n            g_s_r = ((E - eps_l) - sqrt_term) / (2 * t_l**2)\n\n            # Self-energy matrices\n            Sigma_L_r = np.zeros((dim, dim), dtype=complex)\n            Sigma_R_r = np.zeros((dim, dim), dtype=complex)\n            Sigma_L_r[0, 0] = tau_L**2 * g_s_r\n            Sigma_R_r[N - 1, N - 1] = tau_R**2 * g_s_r\n\n            # 2. Device Hamiltonian\n            H_d = np.zeros((dim, dim))\n            \n            # Pristine part\n            for i in range(N):\n                H_d[i, i] = eps_d\n                if i  N - 1:\n                    H_d[i, i + 1] = t_d\n                    H_d[i + 1, i] = t_d\n            \n            # Vacancy modification\n            if U_vac is not None:\n                H_d[0, 0] = U_vac\n\n            # Adsorbate modification\n            if has_adsorbate:\n                H_d[N, N] = eps_a\n                H_d[0, N] = v_a\n                H_d[N, 0] = v_a\n            \n            # 3. Retarded Green's Function Calculation\n            E_plus_ieta = E + 1j * eta\n            M = E_plus_ieta * np.identity(dim) - H_d - Sigma_L_r - Sigma_R_r\n            G_r = np.linalg.inv(M)\n\n            # 4. Broadening and Transmission Calculation\n            Gamma_L = 1j * (Sigma_L_r - Sigma_L_r.conj().T)\n            Gamma_R = 1j * (Sigma_R_r - Sigma_R_r.conj().T)\n\n            # Using the simplified trace formula\n            gamma_L_val = Gamma_L[0, 0].real\n            gamma_R_val = Gamma_R[N-1, N-1].real\n            \n            T_E = gamma_L_val * gamma_R_val * np.abs(G_r[0, N - 1])**2\n            transmissions.append(T_E)\n        \n        return np.array(transmissions)\n\n    # Test cases defined in the problem\n    common_params = {\n        'N': 5, 'eps_d': 0.0, 't_d': 1.0, 'eps_l': 0.0,\n        't_l': 1.0, 'tau_L': 1.0, 'tau_R': 1.0,\n        'energy_grid': np.array([-0.5, 0.0, 0.5]), 'E_F': 0.0\n    }\n\n    test_cases = [\n        # Case 1: Pristine\n        {**common_params},\n        # Case 2: Vacancy\n        {**common_params, 'U_vac': 10.0},\n        # Case 3: Adsorbate\n        {**common_params, 'eps_a': 0.0, 'v_a': 0.5},\n        # Case 4: Combined\n        {\n            'N': 5, 'eps_d': 0.0, 't_d': 1.0, 'eps_l': 0.0,\n            't_l': 1.0, 'tau_L': 0.7, 'tau_R': 1.0, 'U_vac': 5.0,\n            'eps_a': 0.2, 'v_a': 0.7,\n            'energy_grid': np.array([-0.5, 0.0, 0.5]), 'E_F': 0.0\n        }\n    ]\n\n    all_results = []\n    \n    # Calculate pristine case first to get reference resistance\n    pristine_params = test_cases[0]\n    pristine_transmissions = compute_transmissions(pristine_params)\n    pristine_avg_T = np.mean(pristine_transmissions)\n    \n    # Find index for E_F in the grid\n    ef_index = np.where(pristine_params['energy_grid'] == pristine_params['E_F'])[0][0]\n    \n    pristine_T_at_EF = pristine_transmissions[ef_index]\n    # Handle T=0 case to avoid division by zero, though unlikely with finite eta\n    if pristine_T_at_EF == 0:\n        R_c_pristine = np.inf\n    else:\n        R_c_pristine = R0 / pristine_T_at_EF\n\n    # Case 1 result\n    all_results.append([pristine_avg_T, 0.0])\n\n    # Calculate results for the remaining cases\n    for i in range(1, len(test_cases)):\n        case_params = test_cases[i]\n        transmissions = compute_transmissions(case_params)\n        avg_T = np.mean(transmissions)\n        \n        ef_index = np.where(case_params['energy_grid'] == case_params['E_F'])[0][0]\n        T_at_EF = transmissions[ef_index]\n        \n        if T_at_EF == 0:\n            R_c_disordered = np.inf\n        else:\n            R_c_disordered = R0 / T_at_EF\n            \n        delta_Rc = R_c_disordered - R_c_pristine\n        all_results.append([avg_T, delta_Rc])\n\n    # Convert results to a string in the specified list-of-lists format\n    result_str = \"[\" + \",\".join([f\"[{avg_T},{delta_R}]\" for avg_T, delta_R in all_results]) + \"]\"\n    print(result_str)\n\nsolve()\n\n```"
        }
    ]
}