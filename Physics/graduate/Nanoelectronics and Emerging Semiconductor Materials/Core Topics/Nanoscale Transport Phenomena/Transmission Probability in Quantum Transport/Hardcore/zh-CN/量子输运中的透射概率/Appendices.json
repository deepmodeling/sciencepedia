{
    "hands_on_practices": [
        {
            "introduction": "矩形势垒问题是量子隧穿领域的“氢原子”模型，是理解更复杂系统中透射现象的基石。通过精确求解该问题，我们能够练习在边界处匹配波函数及其导数的基本技能，从而推导出透射概率。此练习  不仅巩固了量子输运的基础解析能力，还通过与WKB近似的对比，深刻揭示了近似方法的局限性，特别是当势能发生急剧变化时，简单的指数衰减形式之外的预因子是如何产生的。",
            "id": "4310446",
            "problem": "一个有效质量为 $m^{\\ast}$ 的电子在纳米级一维异质结构中遇到了一个矩形势垒 $U(x)$，其定义为：当 $0  x  a$ 时为 $U_0$，其他情况下为 0。在一个能量为 $E$（其中 $0  E  U_0$）的电子入射到势垒上时，计算**精确透射概率** $T_{\\mathrm{exact}}$。然后，考虑厚势垒极限（$\\kappa a \\gg 1$），推导 $T_{\\mathrm{exact}}$ 的渐近表达式。最后，将您的结果与标准 Wentzel–Kramers–Brillouin (WKB) 近似 $T_{\\mathrm{WKB}} = e^{-2\\kappa a}$ 进行比较，并以 $R = \\frac{T_{\\mathrm{exact, asymptotic}}}{T_{\\mathrm{WKB}}}$ 的形式给出比值 $R$。",
            "solution": "问题陈述经过严格验证，确认有效。这是一个来自量子力学领域的适定、有科学依据且客观的问题，具体涉及通过矩形势垒的量子隧穿，这是纳米电子学中的一个基础课题。所有必要的参数和条件都已提供，不存在内部矛盾或事实错误。因此，我们可以进行推导。\n\n该问题要求推导电子隧穿矩形势垒的精确透射概率 $T_{\\mathrm{exact}}$、其在厚势垒极限下的渐近形式，以及此形式与标准 Wentzel–Kramers–Brillouin (WKB) 近似的比值 $R$。\n\n一维不含时薛定谔方程 (TISE) 如下：\n$$-\\frac{\\hbar^{2}}{2 m^{\\ast}} \\frac{d^{2}\\psi(x)}{d x^{2}} + U(x) \\psi(x) = E \\psi(x)$$\n势 $U(x)$ 定义为：当 $0  x  a$ 时为 $U_0$，在其他地方为零。我们求解一个能量为 $E$（其中 $0  E  U_0$）的入射粒子的 TISE。\n\n该空间分为三个区域：\n-   区域 I ($x  0$)：$U=0$。解的形式为 $\\psi_{\\mathrm{I}}(x) = e^{ikx} + r e^{-ikx}$，其中 $k = \\sqrt{2m^{\\ast}E}/\\hbar$。\n-   区域 II ($0  x  a$)：$U=U_0$。解的形式为 $\\psi_{\\mathrm{II}}(x) = A e^{\\kappa x} + B e^{-\\kappa x}$，其中 $\\kappa = \\sqrt{2m^{\\ast}(U_0-E)}/\\hbar$。\n-   区域 III ($x  a$)：$U=0$。解的形式为 $\\psi_{\\mathrm{III}}(x) = t e^{ikx}$。\n\n通过在 $x=0$ 和 $x=a$ 处应用波函数 $\\psi$ 及其导数 $m^{\\ast-1} d\\psi/dx$ 的连续性，我们可以求解透射振幅 $t$。求解这个代数方程组，得到：\n$$t = \\frac{4ik\\kappa e^{-ika}}{(k-i\\kappa)^2 e^{\\kappa a} - (k+i\\kappa)^2 e^{-\\kappa a}}$$\n透射概率 $T_{\\mathrm{exact}} = |t|^2$。通过代数运算，这可以表示为：\n$$T_{\\mathrm{exact}} = \\frac{1}{1 + \\frac{(k^2+\\kappa^2)^2}{4k^2\\kappa^2}\\sinh^2(\\kappa a)} = \\left( 1 + \\frac{U_0^2 \\sinh^2(\\kappa a)}{4E(U_0 - E)} \\right)^{-1}$$\n这个表达式是精确的。\n\n现在，我们考虑厚势垒极限，即 $\\kappa a \\gg 1$。在这种情况下，$\\sinh(\\kappa a) = \\frac{e^{\\kappa a} - e^{-\\kappa a}}{2} \\approx \\frac{1}{2} e^{\\kappa a}$。代入上式：\n$$T_{\\mathrm{exact}} \\approx \\left( 1 + \\frac{U_0^2}{4E(U_0 - E)} \\frac{e^{2\\kappa a}}{4} \\right)^{-1}$$\n因为 $e^{2\\kappa a}$ 项非常大，我们可以忽略 1，得到：\n$$T_{\\mathrm{exact, asymptotic}} \\approx \\frac{16E(U_0 - E)}{U_0^2} e^{-2\\kappa a}$$\n用 $k$ 和 $\\kappa$ 替换能量项：\n$$E = \\frac{\\hbar^2 k^2}{2m^{\\ast}}, \\quad U_0 - E = \\frac{\\hbar^2 \\kappa^2}{2m^{\\ast}}, \\quad U_0 = \\frac{\\hbar^2(k^2+\\kappa^2)}{2m^{\\ast}}$$\n代入预因子中：\n$$\\frac{16 \\left( \\frac{\\hbar^2 k^2}{2m^{\\ast}} \\right) \\left( \\frac{\\hbar^2 \\kappa^2}{2m^{\\ast}} \\right)}{\\left( \\frac{\\hbar^2(k^2+\\kappa^2)}{2m^{\\ast}} \\right)^2} = \\frac{16 \\frac{\\hbar^4 k^2 \\kappa^2}{4(m^{\\ast})^2}}{\\frac{\\hbar^4(k^2+\\kappa^2)^2}{4(m^{\\ast})^2}} = \\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2}$$\n因此，渐近透射概率为：\n$$T_{\\mathrm{exact, asymptotic}} = \\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2} e^{-2\\kappa a}$$\n标准 WKB 近似给出 $T_{\\mathrm{WKB}} = e^{-2\\kappa a}$。比值 $R$ 为：\n$$R = \\frac{T_{\\mathrm{exact, asymptotic}}}{T_{\\mathrm{WKB}}} = \\frac{\\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2} e^{-2\\kappa a}}{e^{-2\\kappa a}} = \\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2}$$",
            "answer": "$$\n\\boxed{\\frac{16k^{2}\\kappa^{2}}{(k^{2}+\\kappa^{2})^{2}}}\n$$"
        },
        {
            "introduction": "现实世界中的器件势垒轮廓很少是简单的矩形，因此必须掌握数值方法来处理任意形状的势垒。本练习从解析解过渡到数值计算，要求您为高斯型势垒开发一个传输矩阵方法（TMM）的计算程序。您需要将连续变化的势垒离散化为一系列分段常数势垒，并从第一性原理出发，推导并组合界面矩阵和传播矩阵，最终构建一个完整的数值求解器 。这个实践练习不仅能让您从零开始构建一个计算工具，还能让您掌握TMM的核心逻辑和检验数值收敛性的重要性，这些都是计算物理学家的必备技能。",
            "id": "4310459",
            "problem": "考虑一维稳态量子输运，其中一个电子穿过一个局域势垒，该过程由不含时薛定谔方程描述\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x),$$\n其中，$x$ 是位置，$m$ 是电子质量，$\\hbar$ 是约化普朗克常数，$V(x)$ 是势能分布，$E$ 是总能量，$\\psi(x)$ 是波函数。在本问题中，使用无量纲单位制，令 $\\hbar^2/(2m) = 1$，因此薛定谔方程简化为\n$$-\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)。$$\n势垒是高斯型的：\n$$V(x) = V_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right),$$\n其中势垒高度为 $V_0$，宽度参数为 $\\sigma$。假设当 $|x|\\to\\infty$ 时，$V(x)\\to 0$，并且渐近区域（$x\\ll -\\sigma$ 和 $x\\gg \\sigma$）是自由的（$V=0$）。透射概率 $T(E)$ 是入射通量中透射到右侧渐近区域的部分。\n\n您的任务是，基于高斯势垒的分段常数离散化，使用传输矩阵法，从第一性原理出发，构建 $T(E)$ 的收敛数值近似。从以下基本原理出发：不含时薛定谔方程、在任何势能为常数的区域内通解是反向传播平面波的叠加、以及在每个界面处 $\\psi(x)$ 及其空间导数 $d\\psi/dx$ 的连续性。不要引入或假设任何预先推导出的势垒透射公式。您需要：\n- 选择一个包含势垒且 $V(x)$ 不可忽略的有限计算区间 $[-L, L]$，其中 $L$ 与 $\\sigma$ 成正比。解释并证明选择 $L$ 的合理性，以确保 $V(\\pm L)$ 相对于 $V_0$ 可以忽略不计。\n- 将 $[-L, L]$ 离散化为 $N$ 个宽度为 $\\Delta x$ 的均匀切片，并用切片 $j$ 的中点值 $V_j = V(x_j)$ 来近似该切片内的 $V(x)$，其中 $x_j$ 是切片 $j$ 的中点。\n- 在每个切片中，写出局域通解，并通过 $k_j^2 = E - V_j$ 定义局域波数 $k_j$，并理解对于经典禁区（$E  V_j$），$k_j$ 可以是复数。\n- 根据在每个切片界面处 $\\psi$ 和 $d\\psi/dx$ 的连续性，推导出一个 $2\\times 2$ 的界面传输映射，该映射将界面右侧的右行波和左行波振幅与界面左侧的相应振幅联系起来。同时，推导出一个 $2\\times 2$ 的传播映射，用于在波数为 $k_j$ 的情况下穿过一个宽度为 $\\Delta x$ 的切片。\n- 按正确的从左到右的顺序组合这些映射，得到一个总的 $2\\times 2$ 传输矩阵 $\\mathbf{M}$，该矩阵将左渐近区的振幅矢量映射到右渐近区的振幅矢量。\n- 施加物理散射条件，即从左侧入射一个单位振幅的右行波，并且在右渐近区没有左行波，然后求解透射振幅。\n- 使用左右自由区域的相应渐近波数 $k_\\mathrm{L}$ 和 $k_\\mathrm{R}$，将透射振幅转换为透射概率 $T(E)$。\n- 实现一个关于 $N$ 的自适应加密策略，即不断将 $N$ 加倍，直到连续两次加密计算出的 $T(E)$ 之间的绝对变化小于预设的容差 $\\varepsilon$，或者直到达到最大值 $N_\\text{max}$。按照上述规定，使用均匀切片方案和中点规则计算 $V_j$。\n\n对以下参数组的测试套件进行 $T(E)$ 的数值评估，每个参数组由 $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max})$ 指定，其中 $L = (\\text{L-factor})\\cdot \\sigma$，$N$ 从 $N_0$ 开始并不断加倍，直到收敛到容差 $\\varepsilon$ 或达到 $N_\\text{max}$：\n- 测试用例 1：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 0.15, 6.0, 50, 10^{-6}, 8192)$。\n- 测试用例 2：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 1.5, 6.0, 50, 10^{-6}, 8192)$。\n- 测试用例 3：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 7.5, 6.0, 50, 10^{-8}, 8192)$。\n- 测试用例 4：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 0.2, 0.5, 8.0, 50, 10^{-7}, 8192)$。\n\n在所有情况下，透射概率 $T(E)$ 都是无量纲的。您的程序应生成单行输出，其中包含一个逗号分隔的四个 $T(E)$ 值的列表，每个值四舍五入到八位小数，并用方括号括起来（例如，$[0.12345678,0.23456789,0.98765432,0.11121314]$）。不应打印任何其他文本。",
            "solution": "首先验证问题，以确保其科学上合理、良定且完整。\n\n### 第 1 步：提取已知条件\n- **控制方程（无量纲化）**：$-\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$\n- **势能分布**：高斯势垒 $V(x) = V_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$\n- **渐近条件**：当 $|x| \\to \\infty$ 时，$V(x) \\to 0$。\n- **任务**：使用从第一性原理推导的传输矩阵法，数值近似透射概率 $T(E)$。\n- **方法论约束**：\n    - 使用 $V(x)$ 的分段常数近似。\n    - 计算区间为 $[-L, L]$，其中 $L$ 与 $\\sigma$ 成正比。\n    - 该区间被离散化为 $N$ 个宽度为 $\\Delta x$ 的均匀切片。\n    - 切片 $j$ 内的势能是中点值，$V_j = V(x_j)$。\n    - 局域波数 $k_j$ 由 $k_j^2 = E - V_j$ 定义。\n    - 为波振幅推导一个 $2\\times 2$ 的界面传输映射。\n    - 为穿过一个切片推导一个 $2\\times 2$ 的传播映射。\n    - 通过将这些映射相乘，组合成一个总传输矩阵 $\\mathbf{M}$。\n    - 应用散射边界条件：从左侧入射单位振幅波，从右侧无入射波。\n    - 使用渐近波数 $k_\\mathrm{L}$ 和 $k_\\mathrm{R}$ 求 $T(E)$。\n    - 实现一个关于 $N$ 的自适应加密循环，从初始值 $N_0$ 开始将 $N$ 加倍，直到 $|T_N - T_{N/2}|  \\varepsilon$ 或 $N  N_\\text{max}$。\n- **数值测试用例**：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max})$\n    - 用例 1：$(1.5, 1.0, 0.15, 6.0, 50, 10^{-6}, 8192)$\n    - 用例 2：$(1.5, 1.0, 1.5, 6.0, 50, 10^{-6}, 8192)$\n    - 用例 3：$(1.5, 1.0, 7.5, 6.0, 50, 10^{-8}, 8192)$\n    - 用例 4：$(1.5, 0.2, 0.5, 8.0, 50, 10^{-7}, 8192)$\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题是计算量子力学中的一个标准练习。它基于不含时薛定谔方程和传输矩阵法，这两者都是物理学中基础且成熟的概念。所有原理都是合理的。\n- **良定性**：问题是良定的。对于给定的能量 $E$ 和势能 $V(x)$，具有指定渐近边界条件的散射问题对于透射和反射振幅有唯一解。所描述的数值方法是寻找该解的标准收敛方法。\n- **客观性**：问题以精确、客观的数学语言陈述，没有主观或模棱两可的术语。\n- **不完整或矛盾的设置**：问题是自洽的。对于每个测试用例，都明确提供了势能和能量所需的所有物理参数，以及算法所需的所有数值参数（域大小、离散化、收敛准则）。\n- **不切实际或不可行**：物理参数对于量子力学中的模型问题而言，其数量级是典型的。数值参数是合理的，应该能在可行的计算量内得到收敛解。\n- **其他缺陷**：该问题是一项实质性任务，需要从第一性原理进行推导并实现一个非平凡的数值算法。它不存在任何其他列出的缺陷。\n\n### 第 3 步：结论和行动\n问题有效。将提供完整的解决方案。\n\n### 解法推导\n\n解法是按照问题陈述中概述的步骤构建的。\n\n**1. 计算域和离散化**\n高斯势 $V(x) = V_0 \\exp(-x^2 / (2\\sigma^2))$ 在远离 $x=0$ 时迅速衰减。我们选择一个有限计算域 $[-L, L]$，其中 $L = (\\text{L-factor}) \\cdot \\sigma$。在此域之外，势能被假定为零。选择 $L$ 的合理性在于确保 $V(\\pm L)$ 可以忽略不计。在 $x=\\pm L$ 处，势能为 $V(\\pm L) = V_0 \\exp(-L^2/(2\\sigma^2)) = V_0 \\exp(-(\\text{L-factor})^2/2)$。对于给定的最小 L-factor 值 6.0，有 $V(\\pm L) / V_0 = \\exp(-6^2/2) = \\exp(-18) \\approx 1.5 \\times 10^{-8}$，这是势垒高度的一个可忽略部分。因此，这个 $L$ 的选择是合理的。\n\n区间 $[-L, L]$ 被离散化为 $N$ 个均匀切片，每个切片的宽度为 $\\Delta x = 2L/N$。切片之间的界面位于位置 $x'_j = -L + j \\Delta x$，其中 $j = 0, 1, \\dots, N$。第 $j$ 个切片覆盖区间 $[x'_{j-1}, x'_j]$。切片 $j$（$j=1, \\dots, N$）内的势能通过其在中点 $x_j = -L + (j - 1/2)\\Delta x$ 处的值来近似，从而得到一个分段常数的势能分布 $V_j = V(x_j)$。\n\n**2. 局域解和波数**\n在每个切片 $j$ 内部，势能是常数，$V(x) = V_j$。薛定谔方程变为：\n$$-\\frac{d^2\\psi_j(x)}{dx^2} = (E - V_j)\\psi_j(x)$$\n我们将局域波数的平方定义为 $k_j^2 = E - V_j$。波数为 $k_j = \\sqrt{E - V_j}$。如果 $E  V_j$（经典禁区），$k_j$ 变为纯虚数，$k_j = i\\kappa_j$，其中 $\\kappa_j = \\sqrt{V_j - E}$。切片 $j$ 内的通解是一个右行平面波和一个左行平面波的叠加：\n$$\\psi_j(x) = A_j e^{i k_j x} + B_j e^{-i k_j x}$$\n其中 $A_j$ 和 $B_j$ 是复振幅。其导数为：\n$$\\frac{d\\psi_j(x)}{dx} = i k_j (A_j e^{i k_j x} - B_j e^{-i k_j x})$$\n\n**3. 传播矩阵和界面矩阵的推导**\n我们采用一种形式，其中波振幅是相对于每个切片的起点定义的。对于跨越 $[x'_{j-1}, x'_{j}]$ 的切片 $j$，我们使用局部坐标 $\\tilde{x} = x - x'_{j-1}$，所以 $\\tilde{x} \\in [0, \\Delta x]$。解为：\n$$\\psi_j(\\tilde{x}) = A_j e^{i k_j \\tilde{x}} + B_j e^{-i k_j \\tilde{x}}$$\n切片入口处（$\\tilde{x}=0$）的振幅矢量是 $\\mathbf{c}^{\\text{in}}_j = \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix}$。\n\n**传播映射**：在切片末端（$\\tilde{x}=\\Delta x$），波函数是：\n$$\\psi_j(\\Delta x) = A_j e^{i k_j \\Delta x} + B_j e^{-i k_j \\Delta x}$$\n相对于切片起点，其末端右行和左行分量的振幅分别为 $(A_j e^{i k_j \\Delta x}, B_j e^{-i k_j \\Delta x})$。传播映射将出射相量与入射振幅联系起来：\n$$ \\begin{pmatrix} A_j e^{i k_j \\Delta x} \\\\ B_j e^{-i k_j \\Delta x} \\end{pmatrix} = \\begin{pmatrix} e^{i k_j \\Delta x}  0 \\\\ 0  e^{-i k_j \\Delta x} \\end{pmatrix} \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix} $$\n因此，切片 $j$ 的**传播矩阵**是：\n$$ \\mathbf{P}_j = \\begin{pmatrix} e^{i k_j \\Delta x}  0 \\\\ 0  e^{-i k_j \\Delta x} \\end{pmatrix} $$\n\n**界面映射**：在切片 $j$（波数为 $k_j$）和切片 $j+1$（波数为 $k_{j+1}$）之间的界面 $x'_{j}$ 处，$\\psi(x)$ 和 $d\\psi/dx$ 都必须是连续的。令 $\\mathbf{c}^{\\text{out}}_j = \\mathbf{P}_j \\mathbf{c}^{\\text{in}}_j$ 为切片 $j$ 末端的相量矢量。令 $\\mathbf{c}^{\\text{in}}_{j+1} = \\begin{pmatrix} A_{j+1} \\\\ B_{j+1} \\end{pmatrix}$ 为切片 $j+1$ 起始处的振幅矢量。\n在 $x'_j$ 处 $\\psi$ 的连续性：$\\psi_j(\\Delta x) = \\psi_{j+1}(0)$。\n$$ A_j e^{i k_j \\Delta x} + B_j e^{-i k_j \\Delta x} = A_{j+1} + B_{j+1} $$\n在 $x'_j$ 处 $d\\psi/dx$ 的连续性：$\\psi_j'(\\Delta x) = \\psi_{j+1}'(0)$。\n$$ i k_j (A_j e^{i k_j \\Delta x} - B_j e^{-i k_j \\Delta x}) = i k_{j+1} (A_{j+1} - B_{j+1}) $$\n令 $\\alpha = A_j e^{i k_j \\Delta x}$ 和 $\\beta = B_j e^{-i k_j \\Delta x}$。方程组为：\n$$ \\alpha + \\beta = A_{j+1} + B_{j+1} $$\n$$ k_j(\\alpha - \\beta) = k_{j+1}(A_{j+1} - B_{j+1}) $$\n解此线性方程组，求 $A_{j+1}$ 和 $B_{j+1}$：\n$$ A_{j+1} = \\frac{1}{2} \\left( (\\alpha+\\beta) + \\frac{k_j}{k_{j+1}}(\\alpha-\\beta) \\right) = \\frac{k_{j+1}+k_j}{2k_{j+1}}\\alpha + \\frac{k_{j+1}-k_j}{2k_{j+1}}\\beta $$\n$$ B_{j+1} = \\frac{1}{2} \\left( (\\alpha+\\beta) - \\frac{k_j}{k_{j+1}}(\\alpha-\\beta) \\right) = \\frac{k_{j+1}-k_j}{2k_{j+1}}\\alpha + \\frac{k_{j+1}+k_j}{2k_{j+1}}\\beta $$\n这定义了**界面矩阵** $\\mathbf{I}_{j \\to j+1}$，它将切片 $j+1$ 的输入振幅与切片 $j$ 的输出相量联系起来：\n$$ \\mathbf{c}^{\\text{in}}_{j+1} = \\mathbf{I}_{j \\to j+1} \\mathbf{c}^{\\text{out}}_j \\quad \\text{其中} \\quad \\mathbf{I}_{j \\to j+1} = \\frac{1}{2k_{j+1}} \\begin{pmatrix} k_{j+1}+k_j  k_{j+1}-k_j \\\\ k_{j+1}-k_j  k_{j+1}+k_j \\end{pmatrix} $$\n\n**4. 总传输矩阵**\n单步（穿过切片 $j$ 然后跨越界面 $j$）的传输矩阵是 $\\mathbf{M}_j = \\mathbf{I}_{j \\to j+1} \\mathbf{P}_j$。该矩阵将切片 $j+1$ 的输入振幅与切片 $j$ 的输入振幅联系起来：\n$$ \\mathbf{c}^{\\text{in}}_{j+1} = \\mathbf{M}_j \\mathbf{c}^{\\text{in}}_j $$\n整个势垒区域的总传输矩阵 $\\mathbf{M}$ 将切片 1 起始处的振幅 $\\mathbf{c}^{\\text{in}}_1$ 与右侧自由空间区域（区域 $N+1$）起始处的振幅 $\\mathbf{c}^{\\text{in}}_{N+1}$ 联系起来：\n$$ \\mathbf{c}^{\\text{in}}_{N+1} = (\\mathbf{M}_N \\mathbf{M}_{N-1} \\cdots \\mathbf{M}_1) \\mathbf{c}^{\\text{in}}_1 $$\n我们还必须考虑在 $x=-L$ 处的第一个界面。设左侧自由空间区域为区域 0，波数为 $k_L = \\sqrt{E}$。切片 1 起始处的振幅通过第一个界面矩阵与区域 0 中的入射振幅相关联，$\\mathbf{c}^{\\text{in}}_1 = \\mathbf{I}_{0 \\to 1} \\mathbf{c}_0$。矢量 $\\mathbf{c}_0 = \\begin{pmatrix} A_0 \\\\ B_0 \\end{pmatrix}$ 包含入射和反射振幅。最终关系式为：\n$$ \\mathbf{c}^{\\text{in}}_{N+1} = (\\mathbf{M}_N \\cdots \\mathbf{M}_1 \\mathbf{I}_{0 \\to 1}) \\mathbf{c}_0 $$\n总传输矩阵为 $\\mathbf{M}_{\\text{total}} = \\mathbf{M}_N \\cdots \\mathbf{M}_1 \\mathbf{I}_{0 \\to 1}$，通过从右到左的矩阵乘积计算得出。\n\n**5. 透射概率**\n散射边界条件是：从左侧入射一个单位振幅的波（$A_0=1$），并且从右侧没有入射波。在我们的形式体系中，$\\mathbf{c}^{\\text{in}}_{N+1} = \\begin{pmatrix} A_T \\\\ 0 \\end{pmatrix}$，其中 $A_T$ 是透射振幅。方程为：\n$$ \\begin{pmatrix} A_T \\\\ 0 \\end{pmatrix} = \\mathbf{M}_{\\text{total}} \\begin{pmatrix} 1 \\\\ B_0 \\end{pmatrix} = \\begin{pmatrix} M_{11}  M_{12} \\\\ M_{21}  M_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ B_0 \\end{pmatrix} $$\n第二行给出 $0 = M_{21} + M_{22} B_0$，可用于求出反射振幅 $B_0$。第一行给出 $A_T = M_{11} + M_{12} B_0 = M_{11} - M_{12} \\frac{M_{21}}{M_{22}} = \\frac{\\det(\\mathbf{M}_{\\text{total}})}{M_{22}}$。\n总矩阵的行列式为 $\\det(\\mathbf{M}_{\\text{total}}) = \\det(\\mathbf{I}_{N \\to N+1})\\det(\\mathbf{P}_N)\\cdots\\det(\\mathbf{I}_{0 \\to 1}) = (\\frac{k_N}{k_{N+1}})(1)\\cdots(\\frac{k_0}{k_1}) = \\frac{k_0}{k_{N+1}}$。\n渐近波数为 $k_0 = k_L = \\sqrt{E}$ 和 $k_{N+1} = k_R = \\sqrt{E}$。因此，$\\det(\\mathbf{M}_{\\text{total}}) = k_L / k_R = 1$。透射振幅为 $A_T = 1/M_{22}$。\n\n透射概率 $T(E)$ 是透射概率流与入射概率流之比。对于平面波 $A e^{ikx}$，其概率流与 $k|A|^2$ 成正比。\n$$ T(E) = \\frac{j_{\\text{trans}}}{j_{\\text{inc}}} = \\frac{k_R |A_T|^2}{k_L |A_0|^2} = \\frac{k_R}{k_L} \\left| \\frac{1}{M_{22}} \\right|^2 $$\n由于 $k_L = k_R$，这简化为 $T(E) = 1 / |M_{22}|^2$。\n\n**6. 数值实现**\n实现一个自适应算法。对于每个测试用例，我们从 $N=N_0$ 开始。我们计算 $T(E)$。然后我们将 $N$ 加倍并重新计算 $T(E)$，持续此过程直到连续计算之间的绝对差值小于容差 $\\varepsilon$，或者直到 $N$ 超过 $N_\\text{max}$。对于给定的 $N$，计算过程包括：\n1.  定义切片中点 $x_j$ 的网格并计算势能 $V_j$。\n2.  计算所有切片的波数 $k_j = \\sqrt{E - V_j + 0j}$，以及渐近波数 $k_L=k_R=\\sqrt{E}$。\n3.  初始化总矩阵 $\\mathbf{M}_{\\text{total}} = \\mathbf{I}_{0 \\to 1}$。\n4.  从 $j=1$ 到 $N$ 循环，用当前步骤的矩阵进行左乘：$\\mathbf{M}_{\\text{total}} = (\\mathbf{I}_{j \\to j+1}\\mathbf{P}_j) \\mathbf{M}_{\\text{total}}$。\n5.  计算 $T(E) = 1 / |(\\mathbf{M}_{\\text{total}})_{2,2}|^2$。\n这将产生透射概率的收敛估计值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    \n    # Test cases: (V0, sigma, E, L_factor, N0, epsilon, N_max)\n    test_cases = [\n        (1.5, 1.0, 0.15, 6.0, 50, 1e-6, 8192),\n        (1.5, 1.0, 1.5, 6.0, 50, 1e-6, 8192),\n        (1.5, 1.0, 7.5, 6.0, 50, 1e-8, 8192),\n        (1.5, 0.2, 0.5, 8.0, 50, 1e-7, 8192),\n    ]\n\n    results = []\n    for params in test_cases:\n        T_final = calculate_transmission_probability(*params)\n        results.append(f\"{T_final:.8f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_transmission_probability(V0, sigma, E, L_factor, N0, epsilon, N_max):\n    \"\"\"\n    Calculates the transmission probability T(E) for a Gaussian barrier using an\n    adaptive transfer-matrix method.\n\n    Args:\n        V0 (float): Barrier height.\n        sigma (float): Barrier width parameter.\n        E (float): Incident electron energy.\n        L_factor (float): Factor to determine computational domain [-L, L] where L = L_factor * sigma.\n        N0 (int): Initial number of discretization slices.\n        epsilon (float): Convergence tolerance for T(E).\n        N_max (int): Maximum number of slices.\n\n    Returns:\n        float: The converged transmission probability T(E).\n    \"\"\"\n\n    N = N0\n    T_prev = -1.0  # Sentinel value\n\n    while N = N_max:\n        L = L_factor * sigma\n        delta_x = 2 * L / N\n\n        # Define slice midpoints and potential values\n        x_j = -L + (np.arange(N) + 0.5) * delta_x\n        V_j = V0 * np.exp(-x_j**2 / (2 * sigma**2))\n\n        # Wavenumbers: k_async, k_1, ..., k_N, k_async\n        # Ensure arguments to sqrt are complex to handle E  V cases.\n        k = np.sqrt(E - V_j + 0j)\n        k_asymptotic = np.sqrt(E + 0j)\n        \n        # Assemble the total transfer matrix M.\n        # The matrix multiplication order is M_total = M_N * ... * M_1 * I_0->1\n        # which is built by left-multiplication in a loop.\n        \n        # Start with the first interface matrix I_0->1 (from left lead to slice 1)\n        # k_left is k_asymptotic, k_right is k[0]\n        k_left = k_asymptotic\n        k_right = k[0]\n        \n        # Check for E=0 case where k_asymptotic is 0\n        if np.isclose(k_asymptotic.real, 0) and np.isclose(k_asymptotic.imag, 0):\n            # For E=0, transmission is exactly 0 unless V(x)=0 everywhere.\n            return 0.0\n\n        # Interface Matrix I = 1/(2*k_r) * [[k_r+k_l, k_r-k_l], [k_r-k_l, k_r+k_l]]\n        term1 = k_right + k_left\n        term2 = k_right - k_left\n        M_total = (0.5 / k_right) * np.array([[term1, term2], [term2, term1]], dtype=np.complex128)\n\n        # Loop through slices 1 to N\n        # For each slice j (1-indexed), the matrix step is I_{j -> j+1} @ P_j\n        for j in range(N):\n            # Propagation matrix for slice j (0-indexed in code)\n            k_curr = k[j]\n            P_j = np.array([[np.exp(1j * k_curr * delta_x), 0],\n                            [0, np.exp(-1j * k_curr * delta_x)]], dtype=np.complex128)\n\n            # Interface matrix from slice j to j+1\n            k_left = k_curr\n            # If at the last slice, the next region is the right lead\n            k_right = k[j + 1] if j  N - 1 else k_asymptotic\n\n            term1 = k_right + k_left\n            term2 = k_right - k_left\n            I_j_jp1 = (0.5 / k_right) * np.array([[term1, term2], [term2, term1]], dtype=np.complex128)\n            \n            # The matrix for this step is I @ P\n            M_step = I_j_jp1 @ P_j\n\n            # Update the total matrix by left-multiplication\n            M_total = M_step @ M_total\n        \n        # Transmission probability T = 1 / |M_22|^2 (or M[1,1] in 0-indexed)\n        # M_total relates right lead amplitudes to left lead amplitudes.\n        # A_T = 1/M_22. T = |A_T|^2.\n        T_current = 1.0 / np.abs(M_total[1, 1])**2\n\n        # Check for convergence\n        if T_prev >= 0 and np.abs(T_current - T_prev)  epsilon:\n            return T_current\n\n        T_prev = T_current\n        N *= 2\n\n    # Return the last calculated value if max iterations reached\n    return T_prev\n\nsolve()\n```"
        }
    ]
}