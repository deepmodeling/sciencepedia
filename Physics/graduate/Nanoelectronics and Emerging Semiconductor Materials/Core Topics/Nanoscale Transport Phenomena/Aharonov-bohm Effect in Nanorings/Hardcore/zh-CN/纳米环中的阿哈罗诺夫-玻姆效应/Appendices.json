{
    "hands_on_practices": [
        {
            "introduction": "Aharonov-Bohm 效应揭示了物理可观测量依赖于磁通量而非局域磁场，这是现代物理学基石之一——规范不变性——的体现。本练习将指导您在两种不同但物理等效的规范选择下，为纳米环数值构建紧束缚哈密顿量。通过比较它们的能谱和持续电流，您将直接验证基本物理量在不同的数学描述下保持不变，从而加深对这一深刻原理的理解。",
            "id": "4262357",
            "problem": "考虑一个具有 $N$ 个格点的理想一维纳米环，由一个紧束缚哈密顿量描述，该哈密顿量针对单个无自旋电子，其最近邻跃迁振幅为 $t$。在存在穿过环的磁通量 $\\Phi$ 的情况下，其动力学由非相对论量子力学中的最小耦合原理支配：正则动量根据 $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$ 进行修正，其中 $q$ 是电子电荷，$\\mathbf{A}$ 是磁矢量势。阿哈罗诺夫-玻姆效应（Aharonov-Bohm (AB) effect）规定，即使磁场被限制在环的内部并且在电子路径上为零，物理可观测量也可以依赖于环内包围的磁通量 $\\Phi$。磁通量量子为 $\\Phi_0 = h/e$，在紧束缚模型中，可以使用 Peierls 替换来一致地引入 $\\mathbf{A}$ 的效应，即给每个跃迁项乘以一个由 $\\mathbf{A}$ 沿着键的线积分给出的相位因子。\n\n在环形几何中，产生相同总磁通量 $\\Phi$ 的不同 $\\mathbf{A}$ 的规范选择通过规范变换相关联，因此物理可观测量必须是规范不变的。在一个离散环中，用于表示相同总磁通量的两种数学上明确定义的规范选择是：\n- 均匀方位角规范，其中总相位 $2\\pi f$（$f = \\Phi/\\Phi_0$）均匀分布在所有 $N$ 个键上，因此对于所有 $j$，从格点 $j$ 到格点 $j+1$ 的前向跃迁都带有相同的相位因子，而后向跃迁则带有其复共轭。这对应于在连续体中沿环切向的 $\\mathbf{A}$ 是恒定的情况。\n- 单分支切割规范，其中整个相位 $2\\pi f$ 集中在单个键上（例如，格点 $N-1$ 和 $0$ 之间），而所有其他键的跃迁振幅都是实数。这对应于一种规范，其中 $\\mathbf{A}$ 在环上除了一个分支切割处外，处处都是纯规范。\n\n你的任务是，从第一性原理出发，数值上证明能谱和基态持续电流在这些规范选择下是不变的。仅使用以下基本原理：\n- 薛定谔方程中的最小耦合原理 $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$。\n- 在存在磁矢量势的情况下，紧束缚模型的 Peierls 替换。\n- 磁通量量子 $\\Phi_0 = h/e$ 的定义。\n- 规范变换作为对哈密顿量的幺正变换，不会改变物理谱的事实。\n\n定义无量纲磁通参数 $f = \\Phi/\\Phi_0$（无单位），并构建两个 $N \\times N$ 的紧束缚哈密顿量 $H_{\\text{uni}}(N,t,f)$ 和 $H_{\\text{cut}}(N,t,f)$，分别对应于均匀方位角规范和单分支切割规范，并采用周期性边界条件。假设在位能为零。计算在每个测试磁通下两种哈密顿量的排序能谱，并计算每种规范下的基态能量 $E_0(f)$。使用一个小的步长 $\\delta f$，通过中心有限差分来近似归一化的基态持续电流 $I'(f) = -\\frac{\\partial E_0}{\\partial f}$，请注意 $I'(f)$ 的单位是能量/磁通量量子；由于你只需要比较不变性，因此无需将 $I'(f)$ 表示为物理单位。\n\n定义容差 $\\varepsilon_E = 10^{-10}$ 和 $\\varepsilon_I = 10^{-8}$。对于每个测试用例，产生两个布尔结果：\n- 一个谱不变性布尔值，表示两种规范的排序能谱之间的最大绝对差是否小于 $\\varepsilon_E$。\n- 一个电流不变性布尔值，表示从两种规范计算出的 $I'(f)$ 之间的绝对差是否小于 $\\varepsilon_I$。\n\n实现程序以评估以下测试套件，其中所有参数都是无量纲的或单位不需要明确报告，因为只输出布尔值：\n- 测试用例 1：$N = 16$， $t = 1.0$， $f = 0.25$， $\\delta f = 10^{-6}$。\n- 测试用例 2：$N = 12$， $t = 1.0$， $f = 0.0$， $\\delta f = 10^{-6}$。\n- 测试用例 3：$N = 10$， $t = 2.0$， $f = 0.5$， $\\delta f = 10^{-6}$。\n- 测试用例 4：$N = 3$， $t = 1.0$， $f = 0.3$， $\\delta f = 10^{-6}$。\n\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，其本身是一个按 $[\\text{spectrum\\_invariant}, \\text{current\\_invariant}]$ 顺序排列的包含两个布尔值的列表。例如，对于四个测试用例，输出格式必须为 $[[\\text{b}_{11},\\text{b}_{12}],[\\text{b}_{21},\\text{b}_{22}],[\\text{b}_{31},\\text{b}_{32}],[\\text{b}_{41},\\text{b}_{42}]]$, 其中每个 $\\text{b}_{ij}$ 为 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "这个问题的物理基础是量子力学中的最小耦合原理和规范不变性。对于在磁场中电荷为 $q=-e$ 的电子，动量算符根据 $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$ 进行修正，其中 $\\mathbf{A}$ 是磁矢量势。在紧束缚描述中，Peierls 替换忠实地编码了 $\\mathbf{A}$ 沿着离散键的影响：从格点 $i$ 到格点 $j$ 的跃迁振幅获得一个相位因子 $\\exp\\left( \\frac{i q}{\\hbar} \\int_i^j \\mathbf{A} \\cdot d\\mathbf{\\ell} \\right)$。对于总包围磁通量为 $\\Phi$ 的环，沿闭合回路的这些相位之和必须是 $2\\pi f$，其中 $f = \\Phi/\\Phi_0$ 且 $\\Phi_0 = h/e$。\n\n我们考虑两种产生相同总环路相位 $2\\pi f$ 的规范选择：\n\n1. 均匀方位角规范：总相位均匀分布在所有 $N$ 个键上，因此每个前向最近邻跃迁带有相位 $\\exp\\left( i \\frac{2\\pi f}{N} \\right)$，而后向跃迁则带有其复共轭。将此紧束缚哈密顿量表示为 $H_{\\text{uni}}(N,t,f)$，其矩阵元为\n$$\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{j,j+1} = -t \\, e^{i \\frac{2\\pi f}{N}}, \\quad\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{j+1,j} = -t \\, e^{-i \\frac{2\\pi f}{N}},\n$$\n对于 $j=0,1,\\ldots,N-2$，并在边界处周期性地实施，\n$$\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{N-1,0} = -t \\, e^{i \\frac{2\\pi f}{N}}, \\quad\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{0,N-1} = -t \\, e^{-i \\frac{2\\pi f}{N}}.\n$$\n所有在位项均为零。\n\n2. 单分支切割规范：整个环路相位集中在一个键上（选择在格点 $N-1$ 和 $0$ 之间），而所有其他键的跃迁振幅均为实数 $-t$。将此哈密顿量表示为 $H_{\\text{cut}}(N,t,f)$，其矩阵元为\n$$\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{j,j+1} = -t, \\quad\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{j+1,j} = -t, \\quad j=0,1,\\ldots,N-2,\n$$\n并在分支切割处，\n$$\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{N-1,0} = -t \\, e^{i 2\\pi f}, \\quad\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{0,N-1} = -t \\, e^{-i 2\\pi f}.\n$$\n\n这两个哈密顿量通过一个与格点相关的幺正规范变换相关联，$U = \\mathrm{diag}\\left(e^{i \\theta_0}, e^{i \\theta_1}, \\ldots, e^{i \\theta_{N-1}}\\right)$，其中选择 $\\theta_j = \\frac{2\\pi f}{N} j$ 会得到\n$$\nH_{\\text{cut}}(N,t,f) = U^{\\dagger} H_{\\text{uni}}(N,t,f) U,\n$$\n这意味着 $H_{\\text{uni}}$ 和 $H_{\\text{cut}}$ 是幺正等价的。因此，它们具有相同的谱和相同的物理可观测量（这些可观测量可以表示为本征值的函数）。这是规范不变性的直接体现。\n\n算法设计：\n\n- 使用上述定义，将 $H_{\\text{uni}}(N,t,f)$ 和 $H_{\\text{cut}}(N,t,f)$ 显式构造为 $N \\times N$ 的厄米矩阵。通过连接格点 $N-1$ 和格点 $0$ 来实现周期性边界条件。\n\n- 使用数值厄米本征求解器（例如，实现复厄米矩阵对角化的程序）计算两个哈密顿量的本征值。将本征值按升序排序，以获得能谱 $E^{\\text{uni}}(f)$ 和 $E^{\\text{cut}}(f)$。\n\n- 通过计算在相同 $f$ 下两个排序能谱之间的最大绝对差来量化谱不变性：\n$$\n\\Delta_E(f) = \\max_k \\left| E^{\\text{uni}}_k(f) - E^{\\text{cut}}_k(f) \\right|.\n$$\n如果 $\\Delta_E(f)  \\varepsilon_E$（其中 $\\varepsilon_E = 10^{-10}$），则声明谱是不变的。\n\n- 计算两种规范下的基态能量 $E_0^{\\text{uni}}(f)$ 和 $E_0^{\\text{cut}}(f)$，即最小的本征值。通过中心有限差分近似归一化持续电流（能量/磁通量量子）：\n$$\nI'_{\\text{uni}}(f) = -\\frac{E_0^{\\text{uni}}(f+\\delta f) - E_0^{\\text{uni}}(f-\\delta f)}{2 \\, \\delta f}, \\quad\nI'_{\\text{cut}}(f) = -\\frac{E_0^{\\text{cut}}(f+\\delta f) - E_0^{\\text{cut}}(f-\\delta f)}{2 \\, \\delta f}.\n$$\n然后计算\n$$\n\\Delta_I(f) = \\left| I'_{\\text{uni}}(f) - I'_{\\text{cut}}(f) \\right|.\n$$\n如果 $\\Delta_I(f)  \\varepsilon_I$（其中 $\\varepsilon_I = 10^{-8}$），则声明电流不变。\n\n- 边界情况考虑：在 $f = 0$ 时，两种规范中的相位都消失，不变性是平凡的。在 $f = 0.5$（半个磁通量量子）时，简并可能导致 $E_0(f)$ 出现尖点；中心有限差分仍然是一个定义明确的对称离散近似，并且规范不变性仍然存在。非常小的环（例如，$N = 3$）仍然遵守规范不变性；数值容差可以捕捉到残余的浮点误差。\n\n将上述过程应用于测试套件：\n- 测试用例 1：$N = 16$， $t = 1.0$， $f = 0.25$， $\\delta f = 10^{-6}$。\n- 测试用例 2：$N = 12$， $t = 1.0$， $f = 0.0$， $\\delta f = 10^{-6}$。\n- 测试用例 3：$N = 10$， $t = 2.0$， $f = 0.5$， $\\delta f = 10^{-6}$。\n- 测试用例 4：$N = 3$， $t = 1.0$， $f = 0.3$， $\\delta f = 10^{-6}$。\n\n程序为每个测试用例汇总两个布尔值 $[\\text{spectrum\\_invariant}, \\text{current\\_invariant}]$，并打印出形如\n$$\n[[\\text{b}_{11},\\text{b}_{12}],[\\text{b}_{21},\\text{b}_{22}],[\\text{b}_{31},\\text{b}_{32}],[\\text{b}_{41},\\text{b}_{42}]],\n$$\n的单行输出，其中每个 $\\text{b}_{ij}$ 为 $\\text{True}$ 或 $\\text{False}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_hamiltonian_uniform(N: int, t: float, f: float) -> np.ndarray:\n    \"\"\"\n    Build the NxN tight-binding Hamiltonian for a ring with uniform azimuthal gauge.\n    Each bond carries the same phase corresponding to total flux 2*pi*f uniformly distributed.\n    \"\"\"\n    H = np.zeros((N, N), dtype=np.complex128)\n    # Phase per bond in the forward direction\n    phi = 2.0 * np.pi * f / N\n    hop_forward = -t * np.exp(1j * phi)\n    hop_backward = -t * np.exp(-1j * phi)\n    # Fill nearest-neighbor hoppings\n    for j in range(N - 1):\n        H[j, j + 1] = hop_forward\n        H[j + 1, j] = hop_backward\n    # Periodic boundary\n    H[N - 1, 0] = hop_forward\n    H[0, N - 1] = hop_backward\n    # On-site energies are zero\n    return H\n\ndef build_hamiltonian_cut(N: int, t: float, f: float) -> np.ndarray:\n    \"\"\"\n    Build the NxN tight-binding Hamiltonian for a ring with single-branch-cut gauge.\n    All bonds are real except the boundary bond (N-1 to 0) carrying the total phase 2*pi*f.\n    \"\"\"\n    H = np.zeros((N, N), dtype=np.complex128)\n    # Real hopping for non-cut bonds\n    hop_real = -t\n    # Fill nearest-neighbor hoppings for bonds j -> j+1 (except the boundary bond)\n    for j in range(N - 1):\n        H[j, j + 1] = hop_real\n        H[j + 1, j] = hop_real\n    # Boundary bond carries entire phase\n    boundary_forward = -t * np.exp(1j * 2.0 * np.pi * f)\n    boundary_backward = -t * np.exp(-1j * 2.0 * np.pi * f)\n    H[N - 1, 0] = boundary_forward\n    H[0, N - 1] = boundary_backward\n    # On-site energies are zero\n    return H\n\ndef spectrum(H: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Compute sorted eigenvalues of a Hermitian Hamiltonian.\n    \"\"\"\n    # eigh is for Hermitian matrices, returns real eigenvalues for Hermitian input\n    vals = np.linalg.eigh(H)[0]\n    vals.sort()\n    return vals\n\ndef ground_state_energy(H: np.ndarray) -> float:\n    \"\"\"\n    Return the smallest eigenvalue (ground-state energy).\n    \"\"\"\n    vals = np.linalg.eigh(H)[0]\n    return float(np.min(vals))\n\ndef normalized_persistent_current(N: int, t: float, f: float, df: float,\n                                  builder) -> float:\n    \"\"\"\n    Compute normalized persistent current I'(f) = -dE0/df via central difference\n    using the provided Hamiltonian builder (uniform or cut gauge).\n    \"\"\"\n    H_minus = builder(N, t, f - df)\n    H_plus = builder(N, t, f + df)\n    E_minus = ground_state_energy(H_minus)\n    E_plus = ground_state_energy(H_plus)\n    # Central difference\n    dE_df = (E_plus - E_minus) / (2.0 * df)\n    return -dE_df\n\ndef compare_gauges(N: int, t: float, f: float, df: float,\n                   tol_energy: float = 1e-10, tol_current: float = 1e-8):\n    \"\"\"\n    Compare the uniform and cut gauges for given parameters.\n    Returns a tuple of booleans: (spectrum_invariant, current_invariant).\n    \"\"\"\n    H_uni = build_hamiltonian_uniform(N, t, f)\n    H_cut = build_hamiltonian_cut(N, t, f)\n\n    spec_uni = spectrum(H_uni)\n    spec_cut = spectrum(H_cut)\n\n    # Max absolute difference between sorted spectra\n    # Spectra lengths are the same (N), both sorted\n    max_diff_energy = float(np.max(np.abs(spec_uni - spec_cut)))\n\n    # Normalized persistent current via central difference\n    I_uni = normalized_persistent_current(N, t, f, df, build_hamiltonian_uniform)\n    I_cut = normalized_persistent_current(N, t, f, df, build_hamiltonian_cut)\n    diff_current = abs(I_uni - I_cut)\n\n    spectrum_invariant = (max_diff_energy  tol_energy)\n    current_invariant = (diff_current  tol_current)\n    return spectrum_invariant, current_invariant\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (N, t, f, df)\n    test_cases = [\n        (16, 1.0, 0.25, 1e-6),  # Happy path\n        (12, 1.0, 0.0,  1e-6),  # Zero flux boundary\n        (10, 2.0, 0.5,  1e-6),  # Half flux quantum edge case\n        (3,  1.0, 0.3,  1e-6),  # Small ring edge case\n    ]\n\n    results = []\n    for case in test_cases:\n        N, t, f, df = case\n        spectrum_invariant, current_invariant = compare_gauges(N, t, f, df)\n        results.append([spectrum_invariant, current_invariant])\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of [bool,bool] per test case.\n    # No extra text.\n    def bool_list_to_str(lst):\n        # Convert list of [bool,bool] to string with True/False\n        return \"[\" + \",\".join(\"True\" if x else \"False\" for x in lst) + \"]\"\n    output = \"[\" + \",\".join(bool_list_to_str(r) for r in results) + \"]\"\n    print(output)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在真实的纳米器件中，Aharonov-Bohm 效应很少孤立出现。这个实践问题探讨了磁通量的轨道效应与塞曼效应之间的相互作用，后者将电子自旋与磁场耦合起来。您将估算这两种能量尺度变得相当的特征磁场，并推断其对持续电流等可观测量产生的影响。这项练习旨在培养分析介观系统中竞争性物理现象的关键技能。",
            "id": "4262379",
            "problem": "一个在砷化铟二维电子气(2DEG)中制备的准一维半导体纳米环，被建模为一个平均半径为$R$、径向宽度可忽略 ($w \\ll R$) 的单模相干环。电子具有有效质量$m^{\\ast}$和朗德g因子$g$。一个垂直磁场$B$穿过该环，同时产生阿哈罗诺夫-玻姆(AB)磁通和塞曼自旋分裂。自旋轨道耦合可以忽略；假设自旋分裂纯粹是塞曼分裂。温度足够低，以至于相位相干长度超过环的周长，并且环是弹道的。\n\n从环上的正则动量量子化和非相对论色散关系出发，估算特征磁场$B_{Z}^{\\ast}$，在该磁场下塞曼能量与费米能级处的轨道能级间距相当。将该环视为一个一维通道，其波数量子化由存在AB磁通时的周期性边界条件确定，并使用与宿主2DEG相关的费米速度$v_{F}$。明确地令塞曼能量等于费米波数附近的轨道能级间距，并推导出$B_{Z}^{\\ast}$的闭式表达式，该表达式用$g$、玻尔磁子$\\mu_{B}$、约化普朗克常数$\\hbar$、环半径$R$以及$v_{F}$或费米波数$k_{F}$和$m^{\\ast}$表示。\n\n然后，使用以下参数对$B_{Z}^{\\ast}$进行数值计算，将最终结果以特斯拉为单位表示，并四舍五入到三位有效数字：\n- 平均半径 $R = 250\\,\\text{nm}$，\n- 有效质量 $m^{\\ast} = 0.023\\,m_{e}$，\n- 朗德g因子 $g = 15$，\n- 2DEG面密度 $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2}$，\n- 使用 $k_{F} = \\sqrt{2\\pi n_{s}}$ 和 $v_{F} = \\hbar k_{F}/m^{\\ast}$。\n\n最后，根据您的表达式和数值估算，简要地定性讨论当$B$接近并超过$B_{Z}^{\\ast}$时，持续电流$I(\\Phi)$以及磁电导AB振荡的振幅和相位预计将如何被改变，假设穿过的AB磁通固定，且环限制之外的轨道朗道量子化可忽略。\n\n你的最终答案必须是$B_{Z}^{\\ast}$的单个值，以特斯拉为单位，并四舍五入到三位有效数字。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：在砷化铟二维电子气(2DEG)中的准一维半导体纳米环。\n- **模型**：单模相干环。\n- **几何结构**：平均半径$R$，径向宽度可忽略$w \\ll R$。\n- **电子属性**：有效质量$m^{\\ast}$，朗德g因子$g$。\n- **外场**：提供阿哈罗诺夫-玻姆(AB)磁通和塞曼自旋分裂的垂直磁场$B$。\n- **假设/近似**：自旋轨道耦合被忽略；自旋分裂纯粹是塞曼分裂。温度低，确保相位相干长度超过环周长。环是弹道的。\n- **推导任务**：通过令塞曼能量等于费米能级处的轨道能级间距来估算特征磁场$B_{Z}^{\\ast}$。从正则动量量子化和非相对论色散关系开始。使用宿主2DEG的费米速度$v_{F}$。$B_{Z}^{\\ast}$的最终表达式应以$g$、$\\mu_{B}$、$\\hbar$、$R$以及$v_{F}$或($k_{F}$、$m^{\\ast}$)表示。\n- **数值计算任务**：计算$B_{Z}^{\\ast}$，单位为特斯拉，并四舍五入到三位有效数字。\n- **数值参数**：\n    - $R = 250\\,\\text{nm}$\n    - $m^{\\ast} = 0.023\\,m_{e}$\n    - $g = 15$\n    - $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2}$\n- **给定公式**：\n    - $k_{F} = \\sqrt{2\\pi n_{s}}$\n    - $v_{F} = \\hbar k_{F}/m^{\\ast}$\n- **定性讨论任务**：讨论当$B$接近并超过$B_{Z}^{\\ast}$时，持续电流$I(\\Phi)$和磁电导AB振荡的变化。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于量子力学（阿哈罗诺夫-玻姆效应、塞曼效应）和固态物理（二维电子气、有效质量、费米能级）的公认原理。物理系统和参数代表了纳米电子学领域的真实实验。该问题具有科学合理性。\n- **适定性**：问题设定了明确的目标：推导$B_{Z}^{\\ast}$的表达式，计算其值，并提供定性讨论。指令具体，指导了模型和近似的选择。所有必要信息要么已提供，要么是基本常数。该问题是适定的。\n- **客观性**：语言技术性强且精确，没有主观性或歧义。\n\n### 步骤3：结论与行动\n问题有效。这是一个介观物理学中标准的、表述清晰的问题。可以继续求解过程。\n\n### 求解推导\n在垂直磁场$B$中，纳米环内一个电子的总能量是其轨道能量和自旋（塞曼）能量之和。根据问题陈述，自旋轨道耦合被忽略。\n\n限制在半径为$R$、被磁通量$\\Phi = B \\pi R^2$穿过的一维环中的电子，其轨道能量是量子化的。轨道运动的单粒子哈密顿量由下式给出：\n$$\nH_{\\text{orb}} = \\frac{1}{2m^{\\ast}} \\left( \\hat{p}_{\\theta} + e A_{\\theta} \\right)^2\n$$\n其中$\\hat{p}_{\\theta} = \\frac{-i\\hbar}{R} \\frac{\\partial}{\\partial\\theta}$是沿圆周的正则动量算符，而$A_{\\theta} = \\frac{B R}{2} = \\frac{\\Phi}{2\\pi R}$是方位角方向的磁矢量势。由于周期性边界条件$\\psi(\\theta+2\\pi) = \\psi(\\theta)$，本征函数的形式为$\\psi_n(\\theta) = \\frac{1}{\\sqrt{2\\pi}} \\exp(i n \\theta)$，其中$n$是整数量子数。\n\n将哈密顿量作用于这些本征函数，得到能量本征值：\n$$\nE_{n}^{\\text{orb}} = \\frac{1}{2m^{\\ast} R^2} \\left( \\hbar n + e R A_{\\theta} \\right)^2 = \\frac{1}{2m^{\\ast} R^2} \\left( \\hbar n + \\frac{e\\Phi}{2\\pi} \\right)^2\n$$\n使用磁通量子$\\Phi_0 = h/e = 2\\pi\\hbar/e$，该表达式简化为：\n$$\nE_{n}^{\\text{orb}} = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left( n + \\frac{\\Phi}{\\Phi_0} \\right)^2\n$$\n\n塞曼能量源于电子的自旋磁矩与磁场的相互作用。它由$E_Z = g \\mu_B m_s B$给出，其中$m_s = \\pm 1/2$是自旋量子数，$g$是朗德g因子，$\\mu_B = e\\hbar/(2m_e)$是玻尔磁子（注意这里使用的是自由电子质量$m_e$）。两个自旋态之间的能量分裂为$\\Delta E_Z = E_{m_s=1/2} - E_{m_s=-1/2} = g \\mu_B B$。\n\n问题要求我们找到费米能级处的轨道能级间距。相邻轨道能级$n$和$n+1$之间的能量间距为：\n$$\n\\Delta E_{n, n+1}^{\\text{orb}} = E_{n+1}^{\\text{orb}} - E_{n}^{\\text{orb}} = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left[ \\left( n+1 + \\frac{\\Phi}{\\Phi_0} \\right)^2 - \\left( n + \\frac{\\Phi}{\\Phi_0} \\right)^2 \\right] = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left( 2n + 1 + 2\\frac{\\Phi}{\\Phi_0} \\right)\n$$\n在费米能级处，相关的量子数$n$是费米量子数$n_F$，它通过$n_F \\approx k_F R$与费米波数$k_F$相关。通常，对于纳米环，$n_F \\gg 1$。此外，阿哈罗诺夫-玻姆相位项$\\Phi/\\Phi_0$的量级为1。因此，我们可以近似$2n + 1 + 2\\Phi/\\Phi_0 \\approx 2n_F$。费米能级处的轨道能级间距变为：\n$$\n\\Delta E_{\\text{orb}} \\approx \\frac{\\hbar^2}{2m^{\\ast} R^2} (2n_F) = \\frac{\\hbar^2 n_F}{m^{\\ast} R^2}\n$$\n代入$n_F = k_F R$，我们得到：\n$$\n\\Delta E_{\\text{orb}} = \\frac{\\hbar^2 (k_F R)}{m^{\\ast} R^2} = \\frac{\\hbar^2 k_F}{m^{\\ast} R}\n$$\n使用费米速度的定义$v_F = \\hbar k_F / m^{\\ast}$，这个间距可以表示为：\n$$\n\\Delta E_{\\text{orb}} = \\frac{\\hbar v_F}{R}\n$$\n这个结果也可以从一维系统的色散关系$E(k) = \\hbar^2 k^2/(2m^{\\ast})$得到，其中能级间距为$\\Delta E \\approx \\frac{dE}{dk} \\Delta k$。在费米能级处，$\\frac{dE}{dk}|_{k_F} = \\frac{\\hbar^2 k_F}{m^{\\ast}} = \\hbar v_F$。环上的量子化条件$k=n/R$意味着波数空间中的间距为$\\Delta k = 1/R$。因此，$\\Delta E_{\\text{orb}} = (\\hbar v_F)(1/R)$。\n\n问题将特征磁场$B_{Z}^{\\ast}$定义为塞曼分裂等于此轨道能级间距时的磁场：\n$$\n\\Delta E_Z = \\Delta E_{\\text{orb}}\n$$\n$$\ng \\mu_B B_{Z}^{\\ast} = \\frac{\\hbar v_F}{R}\n$$\n解出$B_{Z}^{\\ast}$，得到用$v_F$表示的表达式：\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar v_F}{g \\mu_B R}\n$$\n为了用$k_F$和$m^{\\ast}$表示，我们代入$v_F = \\hbar k_F / m^{\\ast}$：\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar}{g \\mu_B R} \\left( \\frac{\\hbar k_F}{m^{\\ast}} \\right) = \\frac{\\hbar^2 k_F}{g \\mu_B m^{\\ast} R}\n$$\n这就是所要求的闭式表达式。\n\n### 数值计算\n我们给定以下参数：\n- $R = 250\\,\\text{nm} = 2.50 \\times 10^{-7}\\,\\text{m}$\n- $m^{\\ast} = 0.023\\,m_{e} = 0.023 \\times (9.10938 \\times 10^{-31}\\,\\text{kg}) \\approx 2.09516 \\times 10^{-32}\\,\\text{kg}$\n- $g = 15$\n- $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2} = 2.50 \\times 10^{15}\\,\\text{m}^{-2}$\n\n以及基本常数：\n- $\\hbar \\approx 1.05457 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n- $\\mu_B \\approx 9.27401 \\times 10^{-24}\\,\\text{J}\\cdot\\text{T}^{-1}$\n\n首先，我们计算2DEG的费米波数$k_F$：\n$$\nk_F = \\sqrt{2\\pi n_{s}} = \\sqrt{2\\pi (2.50 \\times 10^{15}\\,\\text{m}^{-2})} = \\sqrt{1.5708 \\times 10^{16}\\,\\text{m}^{-2}} \\approx 1.2533 \\times 10^{8}\\,\\text{m}^{-1}\n$$\n现在，我们可以将所有数值代入$B_{Z}^{\\ast}$的表达式中：\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar^2 k_F}{g \\mu_B m^{\\ast} R}\n$$\n$$\nB_{Z}^{\\ast} = \\frac{(1.05457 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s})^2 (1.2533 \\times 10^{8}\\,\\text{m}^{-1})}{(15) (9.27401 \\times 10^{-24}\\,\\text{J}\\cdot\\text{T}^{-1}) (2.09516 \\times 10^{-32}\\,\\text{kg}) (2.50 \\times 10^{-7}\\,\\text{m})}\n$$\n分子：$(1.11212 \\times 10^{-68}\\,\\text{J}^2\\cdot\\text{s}^2) (1.2533 \\times 10^{8}\\,\\text{m}^{-1}) \\approx 1.3938 \\times 10^{-60}\\,\\text{J}^2\\cdot\\text{s}^2\\cdot\\text{m}^{-1}$\n分母：$(15)(9.27401 \\times 10^{-24})(2.09516 \\times 10^{-32})(2.50 \\times 10^{-7})\\,\\text{J}\\cdot\\text{T}^{-1}\\cdot\\text{kg}\\cdot\\text{m}$\n分母 $\\approx (7.2891 \\times 10^{-61})\\,\\text{J}\\cdot\\text{T}^{-1}\\cdot\\text{kg}\\cdot\\text{m}$\n$$\nB_{Z}^{\\ast} = \\frac{1.3938 \\times 10^{-60}}{7.2891 \\times 10^{-61}}\\,\\text{T} \\approx 1.9122\\,\\text{T}\n$$\n四舍五入到三位有效数字，我们得到$B_{Z}^{\\ast} = 1.91\\,\\text{T}$。\n\n### 定性讨论\n持续电流$I(\\Phi)$和磁电导中的阿哈罗诺夫-玻姆(AB)振荡依赖于能谱$E_{n,m_s}$。这两种现象都以磁通量$\\Phi$为周期，周期为$\\Phi_0 = h/e$。\n\n当$B=0$时，自旋向上和自旋向下的能级是简并的。总电流和总电导是两个相同贡献之和。\n\n当$B$从零开始增加时，简并被解除，出现两组抛物线型能谱，它们之间因塞曼能量$\\Delta E_Z = g \\mu_B B$而发生相对位移。\n- **持续电流 $I(\\Phi)$**：持续电流是通过对费米能量以下所有占据态的贡献求和来计算的。由于塞曼分裂，自旋向上和自旋向下电子的占据态数目及其各自的能量变得不同。总电流$I(\\Phi) = I^{\\uparrow}(\\Phi) + I^{\\downarrow}(\\Phi)$是两个周期为$\\Phi_0$的信号的叠加。当$B$接近$B_{Z}^{\\ast}$时，塞曼分裂$\\Delta E_Z$变得与轨道能级间距$\\Delta E_{\\text{orb}}$相当。这导致具有不同自旋和轨道量子数的态之间发生能级交叉（例如，$E_{n, \\uparrow} \\approx E_{n+1, \\downarrow}$）。这些交叉显著地改变了系统作为磁通量函数的基态构型，导致持续电流的振幅、形状甚至符号发生剧烈变化。\n- **磁电导AB振荡**：电导振荡也源于量子干涉，它对能谱很敏感。总电导是两个自旋通道贡献之和，$G(\\Phi) = G^{\\uparrow}(\\Phi) + G^{\\downarrow}(\\Phi)$。因为费米波数$k_{F,\\uparrow}$和$k_{F,\\downarrow}$变得不同，两个通道可以发生干涉。当塞曼分裂$\\Delta E_Z$达到轨道间距$\\Delta E_{\\text{orb}}$的一个显著部分时，总AB振荡的振幅会被调制。具体来说，当$\\Delta E_Z$接近轨道间距的一半时，可以观察到AB振荡中出现$\\pi$的相移，表现为振荡模式的反转。当$B$接近并超过$B_{Z}^{\\ast}$（此时$\\Delta E_Z \\approx \\Delta E_{\\text{orb}}$）时，自旋通道之间相长或相消干涉的条件发生改变。这可能导致AB振荡振幅作为磁场$B$的函数出现抑制（猝灭）和随后的复苏。因此，$B_{Z}^{\\ast}$代表了一个基本的场标度，它控制着纳米环磁输运性质中自旋和轨道效应之间的相互作用。",
            "answer": "$$\n\\boxed{1.91}\n$$"
        },
        {
            "introduction": "理论预测是简洁的，但实验数据往往是复杂的，充满了背景噪声和系统性伪影。这最后一个实践练习模拟了一个真实的测量场景，挑战您从一个复杂的信号中分离出微弱的 Aharonov-Bohm 电导振荡。通过实施多项式去趋势和傅里叶分析等标准数据分析技术，您将学习如何对照实验现实来验证理论预测，这是任何研究型物理学家的重要技能。",
            "id": "4262338",
            "problem": "考虑单电子在一个介观纳米环中的相干输运，该纳米环有两条路径形成一个闭合回路。该纳米环被置于一个外部施加的磁场中，该磁场在径向方向上可能是不均匀的。核心观测量是由Aharonov-Bohm相位引起的、依赖于干涉的电导调制。您必须对测量信号进行建模，并实施一种计算策略，以从由非均匀磁场和一般磁阻趋势引起的背景伪影中分离出真实的Aharonov-Bohm信号特征。\n\n使用以下基本依据：\n\n- 在存在矢势的情况下，沿路径获得的量子力学相位由 $ \\Delta \\varphi_{\\mathrm{AB}} = \\frac{q}{\\hbar} \\oint \\mathbf{A} \\cdot d\\boldsymbol{\\ell} $ 给出，其中 $q$ 是电荷，$\\hbar$ 是约化普朗克常数。根据Stokes'定理，对于一个包围面积 $S$ 的闭合回路，$ \\Delta \\varphi_{\\mathrm{AB}} = \\frac{q}{\\hbar} \\iint_S \\mathbf{B} \\cdot d\\mathbf{S} $。\n- 定义磁通量子 $ \\Phi_0 = \\frac{h}{|q|} $，其中 $h$ 是普朗克常数。对于电子，使用 $ |q| = e $，其中 $e$ 是元电荷。\n\n几何与磁场模型：\n\n- 设纳米环的平均半径为 $ R $，径向宽度为 $ w $，因此内半径为 $ r_{\\mathrm{in}} = R - \\frac{w}{2} $，外半径为 $ r_{\\mathrm{out}} = R + \\frac{w}{2} $。环形区域面积为 $ S = \\pi \\left(r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2\\right) $。\n- 假设一个轴向对称的磁场分布 $ B(r; B) = B + g \\left(r - R\\right) + c \\left(r - R\\right)^2 $，其中 $B$ 是均匀扫描外场，单位为特斯拉；$g$ 是一阶径向梯度，单位为特斯拉/米；$c$ 是二阶径向曲率，单位为特斯拉/平方米。所有相位量的单位均为弧度。\n\n干涉与测量模型：\n\n- 设测得的归一化信号模型为\n$$ G(B) = G_0 + A_{\\mathrm{AB}} \\cos\\!\\left( \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 \\right) + M(B) + N(B), $$\n其中 $ G_0 $ 是一个恒定偏移量，$ A_{\\mathrm{AB}} $ 是Aharonov-Bohm振荡振幅，$ \\Phi(B) = \\iint_S B(r; B)\\, dS $ 是通过环形区域的磁通量，$ \\varphi_0 $ 是一个相位偏移（单位为弧度），$ M(B) $ 是一个平滑的磁阻背景，$ N(B) $ 是一个确定性干扰项，用于模拟与Aharonov-Bohm效应无关的伪振荡。\n- 平滑背景被建模为一个三次多项式 $ M(B) = \\alpha B + \\beta B^2 + \\gamma B^3 $，系数为 $ \\alpha, \\beta, \\gamma $。\n- 干扰项被建模为两个正弦分量的和 $ N(B) = s_1 \\sin\\!\\left( 2\\pi f_1 B \\right) + s_2 \\sin\\!\\left( 2\\pi f_2 B \\right) $，频率 $ f_1, f_2 $ 的单位为周期/特斯拉，振幅为 $ s_1, s_2 $。\n\n目标：\n\n1. 从基本依据出发，推导Aharonov-Bohm相位对扫描场 $ B $ 的依赖关系，并说明非均匀性参数 $ g $ 和 $ c $ 是改变振荡频率还是仅改变相位偏移。\n2. 实现一个程序以：\n   - 在指定的场扫描范围和等间距网格上合成 $ G(B) $。\n   - 使用两步策略分离出真实的Aharonov-Bohm信号特征：\n     a) 通过拟合和减去一个关于 $ B $ 的三次多项式进行去趋势，以移除 $ M(B) $。\n     b) 使用Hann窗和离散傅里叶变换对残差进行频域分析，以评估理论Aharonov-Bohm频率处的振幅。\n   - 使用在理论频率处的信噪比来量化检测，其中背景水平由排除最接近理论频率的频点后、在正频率范围内的谱振幅中位数来表征。\n   - 通过将残差投影到 $ \\cos\\!\\left( 2\\pi f_{\\mathrm{AB}} B \\right) $ 和 $ \\sin\\!\\left( 2\\pi f_{\\mathrm{AB}} B \\right) $ 上，并计算分数 $ \\mathrm{Var}(G_{\\mathrm{AB}})/\\mathrm{Var}(G_{\\mathrm{res}}) $，来量化Aharonov-Bohm分量能解释多少残差方差。\n3. 对于每个测试用例，输出：\n   - 理论Aharonov-Bohm周期，单位为特斯拉，定义为 $ \\Delta B_{\\mathrm{AB}} = \\Phi_0 / S $，四舍五入到六位小数。\n   - 一个布尔值，指示是否基于信噪比大于 $ 6 $ 成功检测。\n   - 方差分数，以小数形式表示，四舍五入到六位小数。\n\n测试套件：\n\n使用以下三个测试用例，每个用例指定 $ R $（米）、$ w $（米）、$ g $（特斯拉/米）、$ c $（特斯拉/平方米）、$ A_{\\mathrm{AB}} $（无量纲）、$ G_0 $（无量纲）、$ \\alpha, \\beta, \\gamma $（与 $ B $（特斯拉）一致的无量纲系数）、$ s_1, s_2 $（无量纲）、$ f_1, f_2 $（周期/特斯拉）、扫描范围 $ B_{\\min} $ 和 $ B_{\\max} $（特斯拉）以及点数 $ N $。\n\n- 案例1（基线，近均匀场）：\n  - $ R = 2.00 \\times 10^{-7} $，$ w = 4.00 \\times 10^{-8} $，$ g = 0.0 $，$ c = 0.0 $，\n  - $ A_{\\mathrm{AB}} = 0.15 $，$ G_0 = 0.0 $，\n  - $ \\alpha = 0.01 $，$ \\beta = 0.25 $，$ \\gamma = 0.00 $，\n  - $ s_1 = 0.02 $，$ s_2 = 0.01 $，$ f_1 = 7.3 $，$ f_2 = 20.0 $，\n  - $ B_{\\min} = -0.4 $，$ B_{\\max} = 0.4 $，$ N = 4096 $。\n\n- 案例2（中等非均匀性，较强背景）：\n  - $ R = 2.00 \\times 10^{-7} $，$ w = 4.00 \\times 10^{-8} $，$ g = 500.0 $，$ c = 1.00 \\times 10^{7} $，\n  - $ A_{\\mathrm{AB}} = 0.12 $，$ G_0 = 0.0 $，\n  - $ \\alpha = 0.02 $，$ \\beta = 0.35 $，$ \\gamma = 0.02 $，\n  - $ s_1 = 0.03 $，$ s_2 = 0.02 $，$ f_1 = 9.1 $，$ f_2 = 18.0 $，\n  - $ B_{\\min} = -0.4 $，$ B_{\\max} = 0.4 $，$ N = 4096 $。\n\n- 案例3（窄环，弱Aharonov-Bohm振幅，较强干扰）：\n  - $ R = 2.00 \\times 10^{-7} $，$ w = 1.00 \\times 10^{-8} $，$ g = 500.0 $，$ c = 5.00 \\times 10^{7} $，\n  - $ A_{\\mathrm{AB}} = 0.04 $，$ G_0 = 0.0 $，\n  - $ \\alpha = 0.03 $，$ \\beta = 0.40 $，$ \\gamma = 0.05 $，\n  - $ s_1 = 0.04 $，$ s_2 = 0.03 $，$ f_1 = 6.0 $，$ f_2 = 22.0 $，\n  - $ B_{\\min} = -0.4 $，$ B_{\\max} = 0.4 $，$ N = 4096 $。\n\n实现要求：\n\n- 使用 $ e = 1.602176634 \\times 10^{-19} \\, \\mathrm{C} $ 和 $ h = 6.62607015 \\times 10^{-34} \\, \\mathrm{J\\cdot s} $，以使 $ \\Phi_0 = h/e $ 的单位为韦伯。\n- 最终输出必须是单行，包含一个列表的列表，每个内部列表按上述顺序对应一个测试用例：$ [\\Delta B_{\\mathrm{AB}}, \\text{detected}, \\text{variance\\_fraction}] $。所有角度必须以弧度处理。周期 $ \\Delta B_{\\mathrm{AB}} $ 必须以特斯拉为单位表示，并四舍五入到六位小数；方差分数必须是小数，并四舍五入到六位小数；布尔值应为 True 或 False。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$ [[0.082300,\\mathrm{True},0.512345],[\\dots]] $）。",
            "solution": "用户提供的问题被评估为**有效**。它在科学上基于量子力学原理（Aharonov-Bohm效应），问题提法得当，定义和参数清晰完整，表述客观。该问题提出了一个既涉及理论推导又涉及计算信号处理的非平凡任务，代表了实验纳米电子学中的一个现实场景。\n\n### 1. 理论推导：Aharonov-Bohm相位与场非均匀性\n\n主要目标是确定Aharonov-Bohm (AB) 振荡频率如何受非均匀磁场的影响。AB效应核心的量子相位与电子路径所包围的磁通量 $ \\Phi(B) $ 成正比。电导模型中的总相位宗量为 $ \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 $。我们必须首先计算通过环形纳米环的总磁通量 $ \\Phi(B) $。\n\n磁通量是磁场 $ B(r; B) $ 在环形面积 $ S $ 上的积分。鉴于轴向对称性，面积元为 $ dS = 2\\pi r dr $。磁场模型为 $ B(r; B) = B + g(r-R) + c(r-R)^2 $。\n\n总磁通量为：\n$$ \\Phi(B) = \\iint_S B(r; B) \\, dS = \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ B + g(r-R) + c(r-R)^2 \\right] 2\\pi r \\, dr $$\n其中 $ r_{\\mathrm{in}} = R - w/2 $ 和 $ r_{\\mathrm{out}} = R + w/2 $ 是内半径和外半径。\n\n我们可以将积分分为依赖于扫描场 $ B $ 的部分和相对于 $ B $ 为常数的部分：\n$$ \\Phi(B) = \\int_{r_{\\mathrmin}}^{r_{\\mathrm{out}}} B \\cdot 2\\pi r \\, dr + \\int_{r_{\\mathrmin}}^{r_{\\mathrm{out}}} \\left[ g(r-R) + c(r-R)^2 \\right] 2\\pi r \\, dr $$\n\n第一项，代表来自均匀场分量的磁通量，简化为：\n$$ B \\int_{r_{\\mathrmin}}^{r_{\\mathrm{out}}} 2\\pi r \\, dr = B \\cdot \\pi (r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2) = B \\cdot S $$\n环形区域的面积 $ S = \\pi (r_{\\mathrm{out}}^2 - r_{\\mathrmin}^2) $，可以简化为 $ S = \\pi ((R+w/2)^2 - (R-w/2)^2) = \\pi(2Rw) = 2\\pi R w $。\n\n第二项 $ \\Phi_{\\mathrm{inhom}} $，是来自场径向非均匀性的磁通量，且与扫描场 $ B $ 无关：\n$$ \\Phi_{\\mathrm{inhom}} = 2\\pi \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ g(r^2 - Rr) + c(r^3 - 2Rr^2 + R^2r) \\right] dr $$\n对于给定的环几何形状和非均匀性参数 $ g $ 和 $ c $，计算此定积分会得到一个常数值。\n\n因此，总磁通量是 $ B $ 的线性函数：\n$$ \\Phi(B) = S \\cdot B + \\Phi_{\\mathrm{inhom}} $$\n\n将此代入电导模型的余弦宗量中：\n$$ \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 = \\frac{2\\pi}{\\Phi_0} (S \\cdot B + \\Phi_{\\mathrm{inhom}}) + \\varphi_0 = \\left(\\frac{2\\pi S}{\\Phi_0}\\right) B + \\left(\\frac{2\\pi \\Phi_{\\mathrm{inhom}}}{\\Phi_0} + \\varphi_0\\right) $$\n此表达式的形式为 $ 2\\pi f_{\\mathrm{AB}} B + \\varphi'_{\\mathrm{total}} $，其中：\n- 相对于 $ B $ 的振荡频率为 $ f_{\\mathrm{AB}} = \\frac{S}{\\Phi_0} $。\n- 总相位偏移为 $ \\varphi'_{\\mathrm{total}} = \\frac{2\\pi \\Phi_{\\mathrm{inhom}}}{\\Phi_0} + \\varphi_0 $。\n\n此推导表明，非均匀性参数 $ g $ 和 $ c $ **不会改变Aharonov-Bohm振荡频率** $ f_{\\mathrm{AB}} $。它们仅贡献于一个与扫描场 $ B $ 无关的恒定相位偏移。AB振荡的周期仅由环的面积 $ S $ 和磁通量子 $ \\Phi_0 $ 决定：\n$$ \\Delta B_{\\mathrm{AB}} = \\frac{1}{f_{\\mathrm{AB}}} = \\frac{\\Phi_0}{S} $$\n\n### 2. 计算策略\n\n所给问题要求进行计算分析，以从复合测量信号 $ G(B) $ 中提取AB信号。策略实施如下：\n\n**步骤1：信号合成**\n对于每个测试用例，在从 $ B_{\\min} $ 到 $ B_{\\max} $ 的 $ N $ 个等间距点上合成信号 $ G(B) $。这涉及计算模型的每个分量：\n- **Aharonov-Bohm项：** $ A_{\\mathrm{AB}} \\cos( \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 ) $。总磁通量 $ \\Phi(B) $ 使用上面推导的公式计算。未指定的相位偏移 $ \\varphi_0 $ 取为 $ 0 $，因为分析方法对该初始相位不敏感。\n- **磁阻背景：** $ M(B) = \\alpha B + \\beta B^2 + \\gamma B^3 $。\n- **干扰项：** $ N(B) = s_1 \\sin(2\\pi f_1 B) + s_2 \\sin(2\\pi f_2 B) $。\n将这些分量与偏移量 $ G_0 $ 相加，以生成完整信号 $ G(B) $。\n\n**步骤2：背景去趋势**\n平滑、低频的磁阻背景 $ M(B) $ 是一个显著的伪影。为移除它，使用最小二乘法 (`numpy.polyfit`) 将一个三次多项式拟合到合成信号 $ G(B) $。然后将这个拟合的多项式（它模拟了 $ G_0 + M(B) $）从 $ G(B) $ 中减去，得到残差信号 $ G_{\\mathrm{res}}(B) $，理想情况下它只包含AB振荡和干扰信号。\n$$ G_{\\mathrm{res}}(B) = G(B) - (\\hat{G}_0 + \\hat{\\alpha} B + \\hat{\\beta} B^2 + \\hat{\\gamma} B^3) \\approx A_{\\mathrm{AB}} \\cos(\\dots) + N(B) $$\n\n**步骤3：频域分析**\n为了分离和量化AB信号特征，我们分析残差信号 $ G_{\\mathrm{res}}(B) $ 的频率内容。\n- 对 $ G_{\\mathrm{res}}(B) $ 应用**Hann窗**以减少频谱泄漏，当对在采样窗口内不具周期性的有限长度信号执行离散傅里叶变换 (DFT) 时，会发生频谱泄漏。\n- 对加窗后的残差计算**快速傅里叶变换 (FFT)**，特别是实值版本 (`scipy.fft.rfft`)，以获得其振幅谱。此谱的x轴表示频率，单位为周期/特斯拉 ($ \\mathrm{T}^{-1} $)。\n\n**步骤4：用于检测的信噪比 (SBR)**\n真实的AB信号应在振幅谱中理论计算频率 $ f_{\\mathrm{AB}} = S/\\Phi_0 $ 处表现为一个峰。\n- **信号：** 最接近 $ f_{\\mathrm{AB}} $ 的频率仓中的谱分量振幅被识别为信号强度。\n- **背景：** 背景水平由所有其他正频率处谱振幅的**中位数**来表征。为避免AB峰自身的频谱泄漏影响背景估计，从计算中位数时排除一小部分频率仓（峰值仓及其直接邻居）。DC分量（频率为0）也被排除。\n- **SBR与检测：** SBR是信号振幅与背景水平的比率。如果该比率超过阈值 $ 6 $，则认为检测成功。\n\n**步骤5：可解释方差量化**\n该度量量化了仅AB分量能在多大程度上解释残差信号的振荡内容。\n- 将残差信号 $ G_{\\mathrm{res}}(B) $ 投影到以理论AB频率 $ f_{\\mathrm{AB}} $ 振荡的正弦和余弦函数的正交基上。这等效于将 $ G_{\\mathrm{res}}(B) $ 最小二乘拟合到一个模型 $ A_c \\cos(2\\pi f_{\\mathrm{AB}} B) + A_s \\sin(2\\pi f_{\\mathrm{AB}} B) $。\n- 得到的拟合信号 $ G_{\\mathrm{AB,proj}}(B) $ 代表了残差中可以由纯AB振荡描述的部分。\n- 可解释方差的分数计算为投影信号的方差与总残差信号的方差之比：$ \\mathrm{Var}(G_{\\mathrm{AB,proj}}) / \\mathrm{Var}(G_{\\mathrm{res}}) $。接近 $ 1 $ 的值表示AB效应主导了残差信号的方差。\n\n最后，计算每个测试用例所需的输出——理论AB周期 $ \\Delta B_{\\mathrm{AB}} $、布尔检测结果和方差分数——按指定要求四舍五入，并格式化为最终输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Solves the Aharonov-Bohm effect problem for a set of test cases.\n    It synthesizes the measured signal, applies a detrending and FFT-based\n    analysis to isolate the AB signature, and quantifies the detection and\n    variance contribution.\n    \"\"\"\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    h = 6.62607015e-34    # Planck's constant in J*s\n    Phi_0 = h / e        # Magnetic flux quantum in Webers (T*m^2)\n\n    # Test suite\n    test_cases = [\n        # Case 1\n        {\n            \"R\": 2.00e-7, \"w\": 4.00e-8, \"g\": 0.0, \"c\": 0.0,\n            \"A_AB\": 0.15, \"G_0\": 0.0,\n            \"alpha\": 0.01, \"beta\": 0.25, \"gamma\": 0.00,\n            \"s1\": 0.02, \"s2\": 0.01, \"f1\": 7.3, \"f2\": 20.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n        # Case 2\n        {\n            \"R\": 2.00e-7, \"w\": 4.00e-8, \"g\": 500.0, \"c\": 1.00e7,\n            \"A_AB\": 0.12, \"G_0\": 0.0,\n            \"alpha\": 0.02, \"beta\": 0.35, \"gamma\": 0.02,\n            \"s1\": 0.03, \"s2\": 0.02, \"f1\": 9.1, \"f2\": 18.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n        # Case 3\n        {\n            \"R\": 2.00e-7, \"w\": 1.00e-8, \"g\": 500.0, \"c\": 5.00e7,\n            \"A_AB\": 0.04, \"G_0\": 0.0,\n            \"alpha\": 0.03, \"beta\": 0.40, \"gamma\": 0.05,\n            \"s1\": 0.04, \"s2\": 0.03, \"f1\": 6.0, \"f2\": 22.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        # Unpack parameters for clarity\n        R, w, g, c = params[\"R\"], params[\"w\"], params[\"g\"], params[\"c\"]\n        A_AB, G_0 = params[\"A_AB\"], params[\"G_0\"]\n        alpha, beta, gamma = params[\"alpha\"], params[\"beta\"], params[\"gamma\"]\n        s1, s2, f1, f2 = params[\"s1\"], params[\"s2\"], params[\"f1\"], params[\"f2\"]\n        B_min, B_max, N = params[\"B_min\"], params[\"B_max\"], params[\"N\"]\n        \n        # 1. Theoretical Calculations\n        S = 2 * np.pi * R * w\n        delta_B_ab = Phi_0 / S\n        f_ab = 1 / delta_B_ab\n\n        # 2. Synthesize Signal G(B)\n        B_sweep = np.linspace(B_min, B_max, N)\n        \n        # Calculate inhomogeneous flux contribution\n        r_in = R - w / 2\n        r_out = R + w / 2\n\n        def flux_integral_term(r, R_val, g_val, c_val):\n            term_g = g_val * (r**3 / 3 - R_val * r**2 / 2)\n            term_c = c_val * (r**4 / 4 - 2 * R_val * r**3 / 3 + R_val**2 * r**2 / 2)\n            return term_g + term_c\n        \n        Phi_inhom = 2 * np.pi * (flux_integral_term(r_out, R, g, c) - flux_integral_term(r_in, R, g, c))\n        total_flux = S * B_sweep + Phi_inhom\n\n        # Signal components (phi_0 = 0)\n        G_ab_term = A_AB * np.cos(2 * np.pi / Phi_0 * total_flux)\n        M_B_term = alpha * B_sweep + beta * B_sweep**2 + gamma * B_sweep**3\n        N_B_term = s1 * np.sin(2 * np.pi * f1 * B_sweep) + s2 * np.sin(2 * np.pi * f2 * B_sweep)\n        \n        G = G_0 + G_ab_term + M_B_term + N_B_term\n\n        # 3. Analysis: Detrending\n        poly_coeffs = np.polyfit(B_sweep, G, 3)\n        poly_fit = np.polyval(poly_coeffs, B_sweep)\n        G_res = G - poly_fit\n\n        # 4. Analysis: FFT\n        hann_window = np.hanning(N)\n        G_res_windowed = G_res * hann_window\n        \n        G_spectrum = fft.rfft(G_res_windowed)\n        amp_spectrum = np.abs(G_spectrum)\n        \n        dB = (B_max - B_min) / (N - 1)\n        freqs = fft.rfftfreq(N, d=dB)\n        \n        # 5. SBR Calculation\n        idx_ab = np.argmin(np.abs(freqs - f_ab))\n        signal_amp = amp_spectrum[idx_ab]\n        \n        background_mask = np.ones_like(freqs, dtype=bool)\n        background_mask[0] = False # Exclude DC component\n\n        # Exclude window of 3 bins around AB peak from background\n        win_start = max(0, idx_ab - 1)\n        win_end = min(len(freqs), idx_ab + 2)\n        background_mask[win_start:win_end] = False\n        \n        background_level = np.median(amp_spectrum[background_mask])\n        \n        sbr = signal_amp / background_level if background_level > 1e-12 else np.inf\n        detected = sbr > 6.0\n\n        # 6. Variance Fraction Calculation\n        c_basis = np.cos(2 * np.pi * f_ab * B_sweep)\n        s_basis = np.sin(2 * np.pi * f_ab * B_sweep)\n\n        # Projection of G_res onto the AB basis functions\n        A_c = np.dot(G_res, c_basis) / np.dot(c_basis, c_basis)\n        A_s = np.dot(G_res, s_basis) / np.dot(s_basis, s_basis)\n        \n        G_ab_proj = A_c * c_basis + A_s * s_basis\n\n        var_g_ab = np.var(G_ab_proj)\n        var_g_res = np.var(G_res)\n\n        var_fraction = var_g_ab / var_g_res if var_g_res > 1e-12 else 0.0\n\n        # 7. Store results\n        all_results.append([delta_B_ab, detected, var_fraction])\n\n    # 8. Print final output in the required format\n    final_output_strings = []\n    for res in all_results:\n        period, is_detected, var_frac = res\n        res_str = f\"[{period:.6f},{str(is_detected)},{var_frac:.6f}]\"\n        final_output_strings.append(res_str)\n    \n    print(f\"[{','.join(final_output_strings)}]\")\n\nsolve()\n```"
        }
    ]
}