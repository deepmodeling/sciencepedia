{
    "hands_on_practices": [
        {
            "introduction": "对于任何存储技术而言，开关周期中消耗的能量都是一个关键的性能指标。这部分能量与极化-电场（$P-E$）磁滞回线所包围的面积直接相关。本练习将提供从剩余极化（$P_r$）和矫顽场（$E_c$）等基本材料参数计算开关能量的实践，从而加强对材料特性与器件功耗之间联系的理解。",
            "id": "4275892",
            "problem": "铁电随机存取存储器（FeRAM）单元中的平面电容器是使用铁电薄膜制造的。在准静态循环下，外加电场在一次完全极化反转过程中所做的单位体积功由电场相对于极化的闭路积分给出。测得的主极化-电场磁滞回线是对称的，并且可以很好地近似为一个理想的矩形回线，其特征是剩余极化 $P_{r}$ 和矫顽场 $E_{c}$，与开关极化相比，可逆（线性电介质）贡献可以忽略不计。该器件的电容器面积为 $A$，铁电层厚度为 $t$。使用场-位移功密度和环路积分的第一性原理定义，计算单个器件在每个开关周期中耗散的总能量（以焦耳为单位），其测量和几何参数如下：\n- 剩余极化 $P_{r} = 30\\,\\mu\\mathrm{C}/\\mathrm{cm}^{2}$，\n- 矫顽场 $E_{c} = 1.2\\,\\mathrm{MV}/\\mathrm{cm}$，\n- 面积 $A = 0.50\\,\\mu\\mathrm{m}^{2}$，\n- 厚度 $t = 10\\,\\mathrm{nm}$。\n\n最终答案以焦耳表示，并四舍五入到三位有效数字。答案中不要使用百分号。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 单位体积在一次完全极化反转过程中所做的功由闭路积分 $W_v = \\oint E \\, dP$ 给出，其中 $E$ 是电场，$P$ 是极化强度。\n- 主极化-电场磁滞回线被近似为一个对称的理想矩形回线。\n- 可逆（线性电介质）贡献可以忽略不计。\n- 剩余极化：$P_{r} = 30\\,\\mu\\mathrm{C}/\\mathrm{cm}^{2}$。\n- 矫顽场：$E_{c} = 1.2\\,\\mathrm{MV}/\\mathrm{cm}$。\n- 电容器面积：$A = 0.50\\,\\mu\\mathrm{m}^{2}$。\n- 铁电层厚度：$t = 10\\,\\mathrm{nm}$。\n- 最终答案以焦耳表示，并四舍五入到三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于铁电材料成熟的物理学原理。每个周期耗散的能量对应于磁滞回线的面积是一个基本概念。$P_r$、$E_c$、$A$ 和 $t$ 的值对于现代铁电器件是切合实际的。\n2.  **适定性：** 该问题提供了一个清晰的物理模型（理想矩形回线）和所有必要的参数，以计算一个单一、唯一的耗散能量数值。\n3.  **客观性：** 问题陈述使用了精确、客观的科学术语。\n4.  **完整性和一致性：** 提供了所有必需的数据，并且没有矛盾。对于这类问题，理想矩形回线的假设是一个有效的简化。\n5.  **现实性：** 物理尺寸和材料特性在当代纳米电子器件的合理范围内。\n\n### 步骤3：结论与行动\n问题有效。将构建一个解决方案。\n\n在一个完整的开关周期内，单位体积耗散的能量 $W_v$ 等于极化-电场（$P$-$E$）磁滞回线所包围的面积。问题将其定义为 $W_v = \\oint E \\, dP$。\n\n对于理想的矩形磁滞回线，极化在正剩余值 $+P_r$ 和负剩余值 $-P_r$ 之间切换。从 $+P_r$ 到 $-P_r$ 的切换发生在恒定的电场 $-E_c$ 下，而从 $-P_r$ 到 $+P_r$ 的切换发生在恒定的电场 $+E_c$ 下。\n\n因此，$P$-$E$ 平面中的回线是一个矩形，其顶点位于 $(E_c, P_r)$、 $(-E_c, P_r)$、 $(-E_c, -P_r)$ 和 $(E_c, -P_r)$。\n这个矩形的宽度是正负矫顽场之差：$\\Delta E = E_c - (-E_c) = 2E_c$。\n这个矩形的高度是正负剩余极化之差：$\\Delta P = P_r - (-P_r) = 2P_r$。\n\n这个矩形回线的面积代表单位体积所做的功，是其宽度和高度的乘积：\n$$W_v = (\\text{width}) \\times (\\text{height}) = (2E_c)(2P_r) = 4E_c P_r$$\n\n为了求出器件中耗散的总能量 $W_{total}$，我们必须将此能量密度乘以铁电材料的体积 $V$。体积由电容器面积 $A$ 和薄膜厚度 $t$ 的乘积给出。\n$$V = A \\times t$$\n$$W_{total} = W_v \\times V = (4E_c P_r) \\times (A t)$$\n\n在计算最终值之前，所有给定的参数都必须转换为一个一致的单位制，即国际单位制 (SI)。\n- 剩余极化：\n$P_{r} = 30\\,\\mu\\mathrm{C}/\\mathrm{cm}^{2} = 30 \\times 10^{-6}\\,\\mathrm{C} / (10^{-2}\\,\\mathrm{m})^{2} = 30 \\times 10^{-6}\\,\\mathrm{C} / 10^{-4}\\,\\mathrm{m}^{2} = 30 \\times 10^{-2}\\,\\mathrm{C}/\\mathrm{m}^{2} = 0.3\\,\\mathrm{C}/\\mathrm{m}^{2}$。\n- 矫顽场：\n$E_{c} = 1.2\\,\\mathrm{MV}/\\mathrm{cm} = 1.2 \\times 10^{6}\\,\\mathrm{V} / (10^{-2}\\,\\mathrm{m}) = 1.2 \\times 10^{8}\\,\\mathrm{V}/\\mathrm{m}$。\n- 面积：\n$A = 0.50\\,\\mu\\mathrm{m}^{2} = 0.50 \\times (10^{-6}\\,\\mathrm{m})^{2} = 0.50 \\times 10^{-12}\\,\\mathrm{m}^{2}$。\n- 厚度：\n$t = 10\\,\\mathrm{nm} = 10 \\times 10^{-9}\\,\\mathrm{m} = 1.0 \\times 10^{-8}\\,\\mathrm{m}$。\n\n现在，将这些国际单位制 (SI) 的值代入 $W_{total}$ 的表达式中：\n$$W_{total} = 4 \\times (1.2 \\times 10^{8}\\,\\mathrm{V}/\\mathrm{m}) \\times (0.3\\,\\mathrm{C}/\\mathrm{m}^{2}) \\times (0.50 \\times 10^{-12}\\,\\mathrm{m}^{2}) \\times (1.0 \\times 10^{-8}\\,\\mathrm{m})$$\n\n单位组合为 $(\\mathrm{V}/\\mathrm{m}) \\times (\\mathrm{C}/\\mathrm{m}^{2}) \\times \\mathrm{m}^{2} \\times \\mathrm{m} = \\mathrm{V} \\cdot \\mathrm{C} = \\mathrm{J}$，因为 $1\\,\\text{焦耳} = 1\\,\\text{伏特} \\times 1\\,\\text{库仑}$。\n\n让我们计算数值：\n$$W_{total} = (4 \\times 1.2 \\times 0.3 \\times 0.50 \\times 1.0) \\times 10^{8 - 12 - 8}\\,\\mathrm{J}$$\n$$W_{total} = (0.72) \\times 10^{-12}\\,\\mathrm{J}$$\n$$W_{total} = 7.2 \\times 10^{-13}\\,\\mathrm{J}$$\n\n问题要求答案四舍五入到三位有效数字。\n$$W_{total} = 7.20 \\times 10^{-13}\\,\\mathrm{J}$$\n这就是指定FeRAM单元在每个开关周期中耗散的总能量。",
            "answer": "$$\\boxed{7.20 \\times 10^{-13}}$$"
        },
        {
            "introduction": "除了静态能量成本，铁电器件的开关速度对于高性能存储器也至关重要。Kolmogorov–Avrami–Ishibashi (KAI) 模型是描述极化反转随时间变化的动力学过程的强大框架。本实践将指导您将实验开关数据与 KAI 模型进行拟合，这是表征铁电材料动态性能和理解其内在畴生长机制的一项关键技能。",
            "id": "4275866",
            "problem": "考虑一个铁电随机存取存储器 (FeRAM) 或铁电场效应晶体管 (FeFET) 中的铁电存储单元，其在恒定矩形电场脉冲下的极化翻转由成核与生长动力学控制。用于描述随时间变化的极化的一个成熟模型是 Kolmogorov–Avrami–Ishibashi (KAI) 模型。该模型将翻转极化表示为时间的函数，此函数是一个由维度和特征时间尺度控制的单调变换。使用 KAI 模型作为基础，从时间序列数据中推断描述翻转过程的动力学参数。\n\n从 KAI 模型出发，将每个数据集在指定幅度的恒定电场脉冲下的极化响应定义为时间 $t$ 和材料参数的函数。这些参数包括：饱和极化 $P_s$、特征翻转时间 $\\tau$ 和维度 $n$。将 $n$ 视为一个无量纲指数，用于量化畴生长过程的有效维度；将 $\\tau$ 视为一个设定动力学时间尺度的时间参数。假设对于每个数据集，$P_s$ 通过独立的饱和测量已知，并且在脉冲期间保持恒定。\n\n您的任务是设计一个程序，对每个给定的数据集，通过将 KAI 极化函数拟合给定的极化-时间值来执行参数 $n$ 和 $\\tau$ 的估计。拟合应通过一种基于原理的数值方法完成，该方法使用模型变换来获得初始估计值，然后通过非线性最小二乘法优化来精炼这些估计值。\n\n使用的基本原理和定义：\n- 在恒定电场脉冲下，极化 $P(t)$ 从 $0$ 单调演变至 $P_s$。KAI 动力学通过指数 $n$ 和时间尺度 $\\tau$ 来描述成核与生长过程。\n- 在适当情况下，自然对数和线性最小二乘法是用于模型线性化的标准变换方法。\n- 非线性最小二乘法优化通过最小化模型与数据之间的残差平方和来精煉参数估计。\n\n单位和数值约定：\n- 时间 $t$ 以微秒 (µs) 表示。所有时间量，包括输出的 $\\tau$，都必须以 µs 表示。\n- 极化 $P$ 和饱和极化 $P_s$ 以微库仑/平方厘米 (µC/cm$^2$) 表示。\n- 电场幅度 $E$ 以千伏/厘米 (kV/cm) 表示。电场幅度用于标记每个数据集，但并不直接用于拟合函数；它为不同数据集之间 $\\tau$ 和 $n$ 可能存在的差异提供了背景信息。\n- 维度指数 $n$ 是无量纲的。\n- $n$ 和 $\\tau$ 的最终数值输出必须四舍五入到三位小数。\n\n测试套件规范：\n您的程序必须为以下每个数据集拟合 $n$ 和 $\\tau$。对于每个数据集，都提供了 $P_s$、$E$ 和时间点 $t$ (以 µs 为单位)。每个数据集的极化样本 $P(t)$ 是使用 KAI 模型，在指定的时间点上，通过给定的真实参数 $(n_{\\text{true}}, \\tau_{\\text{true}})$ 计算得出，且不添加噪声，如下所示：\n$$ P(t) = P_s \\left(1 - \\exp\\left(-\\left(\\frac{t}{\\tau_{\\text{true}}}\\right)^{n_{\\text{true}}}\\right)\\right). $$\n\n- 数据集 A (慢速，近一维生长)：\n    - $E = 100$ kV/cm\n    - $P_s = 20$ µC/cm$^2$\n    - 真实值：$n_{\\text{true}} = 1.2$, $\\tau_{\\text{true}} = 5.0$ µs\n    - 时间点 $t$ (µs)：$[0.1, 0.2, 0.5, 1.0, 2.0, 3.0, 4.0, 5.0, 7.0, 10.0]$\n\n- 数据集 B (中速翻转，二维生长)：\n    - $E = 200$ kV/cm\n    - $P_s = 25$ µC/cm$^2$\n    - 真实值：$n_{\\text{true}} = 2.0$, $\\tau_{\\text{true}} = 1.5$ µs\n    - 时间点 $t$ (µs)：$[0.05, 0.1, 0.2, 0.4, 0.8, 1.2, 1.6, 2.5, 3.5, 5.0]$\n\n- 数据集 C (快速翻转，更高维度的生长)：\n    - $E = 300$ kV/cm\n    - $P_s = 15$ µC/cm$^2$\n    - 真实值：$n_{\\text{true}} = 3.1$, $\\tau_{\\text{true}} = 0.7$ µs\n    - 时间点 $t$ (µs)：$[0.02, 0.05, 0.08, 0.12, 0.2, 0.3, 0.5, 0.8, 1.2, 2.0]$\n\n算法要求：\n- 使用一种基于变换的方法，通过利用 KAI 函数的单调性和适当的对数变换来获得 $n$ 和 $\\tau$ 的初始估计值，确保在变换中只使用物理上有效的样本 ($0  P(t)  P_s$)。\n- 使用非线性最小二乘法将 KAI 模型拟合到提供的 $P(t)$ 数据，以精炼参数估计值。\n- 将拟合约束在物理合理的范围内：$0.5 \\le n \\le 5.0$, $\\tau > 0$。\n\n边界情况处理要求：\n- 在初始对数变换中，排除过于接近 $P(t) = 0$ 或 $P(t) = P_s$ 的样本，以避免因对 $0$ 或 $1$ 取对数而产生的奇异点。\n- 在计算对数时，通过应用适当的小阈值来确保数值稳定性。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按 A、B、C 顺序排列的每个数据集的拟合维度和特征时间，四舍五入到三位小数。该行必须是方括号括起来的逗号分隔列表，序列为 $[n_A, \\tau_A, n_B, \\tau_B, n_C, \\tau_C]$，其中每个 $\\tau$ 的单位为 µs，例如 $[1.200,5.000,2.000,1.500,3.100,0.700]$。\n\n您的程序必须是自包含的，使用指定的真实参数和时间点从 KAI 模型内部生成合成的 $P(t)$ 数据，执行拟合过程，并以确切指定的格式打印最终结果。",
            "solution": "问题要求估计铁电极化翻转的 Kolmogorov–Avrami–Ishibashi (KAI) 模型中的动力学参数——维度指数 $n$ 和特征翻转时间 $\\tau$。估计将在三个由模型本身生成的、无噪声的独立数据集上进行。指定的方法包括一个两步过程：首先，通过模型的线性化变换对参数进行初始估计；其次，使用非线性最小二乘法优化来精炼这些估计值。\n\nKAI 模型描述了在恒定外加电场下，随时间变化的翻转极化 $P(t)$ 如下：\n$$\nP(t) = P_s \\left(1 - \\exp\\left(-\\left(\\frac{t}{\\tau}\\right)^n\\right)\\right)\n$$\n此处，$P_s$ 是饱和极化，对于每个数据集都是已知的常数。需要确定的参数是 $n$ 和 $\\tau$。\n\n**步骤 1：通过模型线性化进行初始参数估计**\n\n为了获得 $n$ 和 $\\tau$ 的初始估计值，我们可以将 KAI 方程转换为线性形式。这种技术通常被称为 Avrami 图。\n\n首先，我们重排方程以分离指数项：\n$$\n\\frac{P(t)}{P_s} = 1 - \\exp\\left(-\\left(\\frac{t}{\\tau}\\right)^n\\right)\n$$\n$$\n1 - \\frac{P(t)}{P_s} = \\exp\\left(-\\left(\\frac{t}{\\tau}\\right)^n\\right)\n$$\n\n此变换对 $P(t)  P_s$ 的数据点有效。对两边取自然对数，得到：\n$$\n\\ln\\left(1 - \\frac{P(t)}{P_s}\\right) = -\\left(\\frac{t}{\\tau}\\right)^n\n$$\n\n此步骤要求 $1 - \\frac{P(t)}{P_s} > 0$，这等价于 $P(t)  P_s$。为了继续，我们将等式左侧变为正数，然后再次取对数：\n$$\n-\\ln\\left(1 - \\frac{P(t)}{P_s}\\right) = \\left(\\frac{t}{\\tau}\\right)^n\n$$\n\n再次对两边取自然对数，即可得到所需的线性形式。此步骤仅在 $P(t) > 0$ 时有效，因为这能确保 $-\\ln(1 - P(t)/P_s) > 0$。\n$$\n\\ln\\left(-\\ln\\left(1 - \\frac{P(t)}{P_s}\\right)\\right) = \\ln\\left(\\left(\\frac{t}{\\tau}\\right)^n\\right)\n$$\n\n利用对数的性质，我们可以展开右侧：\n$$\n\\ln\\left(-\\ln\\left(1 - \\frac{P(t)}{P_s}\\right)\\right) = n \\left( \\ln(t) - \\ln(\\tau) \\right)\n$$\n$$\n\\ln\\left(-\\ln\\left(1 - \\frac{P(t)}{P_s}\\right)\\right) = n \\ln(t) - n \\ln(\\tau)\n$$\n\n该方程是直线形式 $Y = mX + C$，其中：\n- $Y = \\ln\\left(-\\ln\\left(1 - \\frac{P(t)}{P_s}\\right)\\right)$\n- $X = \\ln(t)$\n- 斜率为 $m = n$。\n- y 轴截距为 $C = -n \\ln(\\tau)$。\n\n通过对变换后的数据点 $(X_i, Y_i)$ 进行线性最小二乘回归，我们可以确定斜率 $m$ 和截距 $C$。由此，我们推导出参数的初始估计值，记为 $n_0$ 和 $\\tau_0$：\n$$\nn_0 = m\n$$\n$$\n\\tau_0 = \\exp\\left(-\\frac{C}{m}\\right) = \\exp\\left(-\\frac{C}{n_0}\\right)\n$$\n\n根据问题的边界情况要求，当 $P(t)$ 非常接近 $0$ 或 $P_s$ 时，此变换在数值上是不稳定的。具体来说，会遇到 $\\ln(0)$ 的情况。因此，在初始估计步骤中必须排除 $P(t)$ 接近这些极限值的数据点。一个实用的方法是筛选掉翻转分数 $P(t)/P_s$ 在某个范围之外的数据点，例如，在 $0.01  P(t)/P_s  0.99$ 之外。\n\n**步骤 2：通过非线性最小二乘法 (NLLS) 优化进行参数精炼**\n\n来自线性拟合的初始估计值 $(n_0, \\tau_0)$ 作为更稳健的 NLLS 优化的起点。该方法直接将原始 KAI 模型拟合到数据，无需任何变换，从而避免了对数运算可能引入的偏差。\n\nNLLS 的目标是找到参数值 $(n, \\tau)$，以最小化观测极化数据 $P_i$ 与模型预测值 $P_{\\text{model}}(t_i; n, \\tau)$ 之间的残差平方和 ($SSR$)：\n$$\nSSR(n, \\tau) = \\sum_{i=1}^{N} \\left( P_i - P_{\\text{model}}(t_i; n, \\tau) \\right)^2\n$$\n其中 $N$ 是数据点的数量。\n\n这个优化问题需要数值求解。Python 的 SciPy 库中的 `scipy.optimize.curve_fit` 函数是实现此目的的绝佳工具。它实现了 Levenberg-Marquardt 算法，这是一种标准的、高效的 NLLS 方法。关键的是，此函数允许按照问题要求合并参数的边界：\n- $0.5 \\le n \\le 5.0$\n- $\\tau > 0$ (实际上，对于一个小的正数 $\\epsilon$，$\\tau \\ge \\epsilon$)\n\n**每个数据集的算法流程**\n\n1.  **数据生成**：对于每个测试用例，使用提供的真实参数 ($n_{\\text{true}}$, $\\tau_{\\text{true}}$)、饱和极化 $P_s$ 和时间点 $t_i$ 生成合成的极化数据 $P(t_i)$。\n2.  **初始猜测**：\n    a. 筛选 $(t_i, P_i)$ 数据对，排除 $P_i/P_s$ 过度接近 $0$ 或 $1$ 的点。\n    b. 对筛选后的数据应用双对数变换以获得 $(X_i, Y_i)$。\n    c. 对 $(X_i, Y_i)$ 进行线性回归，以找到斜率 $m$ 和截距 $C$。\n    d. 计算初始估计值 $n_0 = m$ 和 $\\tau_0 = \\exp(-C/m)$。\n3.  **非线性精炼**：\n    a. 为 NLLS 拟合器定义 KAI 模型函数，其中 $t$ 为自变量，$(n, \\tau)$ 为待拟合参数。$P_s$ 在拟合中是固定常数。\n    b. 使用 KAI 函数、完整的 $(t_i, P_i)$ 数据集、初始猜测值 $(n_0, \\tau_0)$ 以及指定的 $n$ 和 $\\tau$ 边界，调用 `scipy.optimize.curve_fit`。\n4.  **结果收集**：提取优化后的参数 $(n_{\\text{fit}}, \\tau_{\\text{fit}})$，并按要求四舍五入到三位小数。\n5.  **最终输出**：将所有数据集的结果整理成一个列表，并将其格式化为指定的字符串格式进行打印。\n\n由于输入数据是无噪声的，并且直接从 KAI 模型生成，因此拟合过程预计能够高精度地恢复真实参数，其精度仅受算法的数值精度限制。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves for the KAI model parameters for multiple datasets\n    by generating synthetic data and then applying a two-step fitting procedure.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        {\n            \"name\": \"A\",\n            \"E\": 100.0,  # kV/cm\n            \"Ps\": 20.0,  # µC/cm^2\n            \"n_true\": 1.2,\n            \"tau_true\": 5.0,  # µs\n            \"t_points\": np.array([0.1, 0.2, 0.5, 1.0, 2.0, 3.0, 4.0, 5.0, 7.0, 10.0]), # µs\n        },\n        # Dataset B\n        {\n            \"name\": \"B\",\n            \"E\": 200.0,\n            \"Ps\": 25.0,\n            \"n_true\": 2.0,\n            \"tau_true\": 1.5,\n            \"t_points\": np.array([0.05, 0.1, 0.2, 0.4, 0.8, 1.2, 1.6, 2.5, 3.5, 5.0]),\n        },\n        # Dataset C\n        {\n            \"name\": \"C\",\n            \"E\": 300.0,\n            \"Ps\": 15.0,\n            \"n_true\": 3.1,\n            \"tau_true\": 0.7,\n            \"t_points\": np.array([0.02, 0.05, 0.08, 0.12, 0.2, 0.3, 0.5, 0.8, 1.2, 2.0]),\n        },\n    ]\n\n    results = []\n\n    def kai_model(t, Ps, n, tau):\n        \"\"\"KAI model for polarization switching.\"\"\"\n        return Ps * (1.0 - np.exp(-(t / tau)**n))\n\n    for case in test_cases:\n        # Step 1: Generate synthetic data\n        Ps = case[\"Ps\"]\n        n_true = case[\"n_true\"]\n        tau_true = case[\"tau_true\"]\n        t_data = case[\"t_points\"]\n        P_data = kai_model(t_data, Ps, n_true, tau_true)\n\n        # Step 2: Obtain initial parameter estimates via linearization\n        \n        # Filter data to avoid log(0) issues, as per problem requirements.\n        # Only use points where the switched fraction is between 1% and 99%.\n        # This is robust for typical Avrami analysis.\n        valid_indices = np.where((P_data > 0.01 * Ps)  (P_data  0.99 * Ps))\n        t_filtered = t_data[valid_indices]\n        P_filtered = P_data[valid_indices]\n\n        # Apply the linearizing transformation: Y = n*X - n*ln(tau)\n        # where Y = ln(-ln(1 - P/Ps)) and X = ln(t)\n        X = np.log(t_filtered)\n        Y = np.log(-np.log(1.0 - P_filtered / Ps))\n        \n        if len(X)  2:\n            # Fallback if too few points remain after filtering.\n            # Using true values as guess for robustness, though not expected here.\n            n_initial, tau_initial = n_true, tau_true\n        else:\n            # Perform linear regression to find slope (n) and intercept (-n*ln(tau))\n            # `polyfit` with degree 1 returns [slope, intercept]\n            slope, intercept = np.polyfit(X, Y, 1)\n\n            n_initial = slope\n            # From intercept = -n*ln(tau) => tau = exp(-intercept/n)\n            tau_initial = np.exp(-intercept / n_initial)\n\n        # Step 3: Refine estimates using nonlinear least-squares (NLLS)\n\n        # Define the model function for curve_fit. Ps is fixed.\n        def kai_fit_func(t, n, tau):\n            return kai_model(t, Ps, n, tau)\n            \n        # Define parameter bounds as per problem specification.\n        # tau > 0 is handled by setting a small positive lower bound.\n        bounds = ([0.5, 1e-9], [5.0, np.inf])\n\n        # provide the initial guesses to the optimizer\n        initial_guess = [n_initial, tau_initial]\n\n        # Perform the NLLS fit\n        popt, _ = curve_fit(\n            f=kai_fit_func,\n            xdata=t_data,\n            ydata=P_data,\n            p0=initial_guess,\n            bounds=bounds\n        )\n\n        n_fit, tau_fit = popt\n\n        # Append rounded results to the list\n        results.append(round(n_fit, 3))\n        results.append(round(tau_fit, 3))\n\n    # Final print statement in the exact required format.\n    formatted_results = \",\".join(f\"{x:.3f}\" for x in results)\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "存储器件的长期可靠性，特别是其承受重复写入循环的能力，与其速度和功耗同等重要。这种被称为耐久性的可靠性，通常受到剩余极化（$P_r$）等铁电性能逐渐退化的限制。在本练习中，您将模拟与耐久性相关的退化如何影响铁电场效应晶体管（FeFET）的存储窗口，从而预测器件的工作寿命。",
            "id": "4275908",
            "problem": "铁电场效应晶体管（FeFET）是一种金属-铁电体-半导体结构，其中铁电层中的剩余极化 $P_{r}$ 在铁电体-半导体界面处感应出束缚表面电荷。考虑一个在阈值附近于准静态条件下工作的 $n$ 沟道器件，其中标准的金属-氧化物-半导体（MOS）阈值条件适用，且阈值时的半导体表面电势由 $2\\phi_{F}$ 固定。将束缚铁电电荷建模为界面处的面电荷密度 $\\pm P_{r}$。半导体上方的栅叠层可以建模为与金属栅极串联的单位面积电容为 $C_{ox}$ 的线性电介质，使得栅极电压与半导体表面之间的净静电耦合由 $C_{ox}$ 决定。\n\n假设重复的编程/擦除循环导致剩余极化发生与耐久性相关的衰减，遵循以下依赖于循环次数的模型\n$$\nP_{r}(n) = P_{r0}\\left(1 - \\alpha \\,\\ln(1+n)\\right),\n$$\n对于循环次数 $n \\in \\mathbb{N}$，其中 $P_{r0} > 0$ 是初始剩余极化，$\\alpha$ 是满足 $0  \\alpha  1$ 的无量纲退化系数，$\\ln(\\cdot)$ 表示自然对数。\n\n使用 Gauss’s law 和 MOS 阈值定义，推导存储窗口 $W(n)$ 的表达式，该窗口定义为两个饱和极化状态之间阈值电压的差值，作为 $P_{r}(n)$ 和 $C_{ox}$ 的函数。然后，给定一个满足 $0  W_{\\min}  \\frac{2P_{r0}}{C_{ox}}$ 的指定最小可接受存储窗口 $W_{\\min}$，计算循环次数 $n^{\\star}$ 的精确闭合形式表达式，在该循环次数下 $W(n)$ 首次等于 $W_{\\min}$（即，对于 $n > n^{\\star}$，开始低于指定阈值）。将 $n^{\\star}$ 完全用 $P_{r0}$、$\\alpha$、$C_{ox}$ 和 $W_{\\min}$ 表示。最终答案必须是单一的解析表达式。不需要进行数值计算。",
            "solution": "该问题要求我们首先推导铁电场效应晶体管（FeFET）的存储窗口作为其剩余极化和栅电容的函数，然后计算器件的耐久性，即存储窗口退化到最小可接受值所需的循环次数。\n\n首先，我们推导存储窗口 $W(n)$ 的表达式。该器件是一个 n 沟道 FeFET，可以建模为金属-铁电体-半导体（MFS）电容器。这种器件的阈值电压 $V_{th}$ 会因铁电体-半导体界面处存在净电荷密度而发生偏移。给定模型将铁电效应简化为该界面处的有效面电荷密度 $\\sigma_P = \\pm P_r$，其中 $P_r$ 是剩余极化。\n\n对于 MOS 型器件，由绝缘体-半导体界面处的面电荷密度 $\\sigma_{int}$ 引起的阈值电压偏移 $\\Delta V_{th}$ 的一般关系由下式给出：\n$$\n\\Delta V_{th} = -\\frac{\\sigma_{int}}{C_{ins}}\n$$\n其中 $C_{ins}$ 是绝缘体的单位面积电容。在本问题中，该电容表示为 $C_{ox}$。\n\nFeFET 有两个稳定的存储状态，对应于剩余极化矢量的两个相反方向，这在给定的循环次数 $n$ 下导致界面电荷密度为 $\\sigma_P = +P_r(n)$ 和 $\\sigma_P = -P_r(n)$。设 $V_{th,ref}$ 是一个极化为零（$P_r=0$）的等效器件的阈值电压。那么这两个状态的阈值电压相对于此参考值发生偏移。\n\n对于具有 p 型半导体衬底的 n 沟道器件，通过吸引电子在表面形成反型层来达到阈值。\n1.  **高 $V_{th}$ 状态**：此状态对应于使反型层更难形成的界面电荷。这需要一个排斥电子的负界面电荷。我们指定 $\\sigma_{int} = -P_r(n)$。产生的阈值电压为：\n    $$\n    V_{th,\\text{high}}(n) = V_{th,ref} - \\frac{-P_r(n)}{C_{ox}} = V_{th,ref} + \\frac{P_r(n)}{C_{ox}}\n    $$\n2.  **低 $V_{th}$ 状态**：此状态对应于一个有助于吸引电子的正界面电荷，从而降低了反型所需的栅极电压。我们指定 $\\sigma_{int} = +P_r(n)$。阈值电压为：\n    $$\n    V_{th,\\text{low}}(n) = V_{th,ref} - \\frac{+P_r(n)}{C_{ox}} = V_{th,ref} - \\frac{P_r(n)}{C_{ox}}\n    $$\n存储窗口 $W(n)$ 定义为这两个阈值电压之间的差值：\n$$\nW(n) = V_{th,\\text{high}}(n) - V_{th,\\text{low}}(n)\n$$\n代入这两个阈值电压的表达式：\n$$\nW(n) = \\left(V_{th,ref} + \\frac{P_r(n)}{C_{ox}}\\right) - \\left(V_{th,ref} - \\frac{P_r(n)}{C_{ox}}\\right)\n$$\n$$\nW(n) = \\frac{2 P_r(n)}{C_{ox}}\n$$\n这就是所要求的存储窗口作为 $P_r(n)$ 和 $C_{ox}$ 函数的表达式。\n\n接下来，我们引入给定的关于剩余极化耐久性相关退化的模型：\n$$\nP_r(n) = P_{r0}\\left(1 - \\alpha \\ln(1+n)\\right)\n$$\n将此代入我们关于 $W(n)$ 的表达式中：\n$$\nW(n) = \\frac{2 P_{r0}}{C_{ox}} \\left(1 - \\alpha \\ln(1+n)\\right)\n$$\n问题要求计算存储窗口退化到指定的最小值 $W_{\\min}$ 时的循环次数 $n^{\\star}$。这可以通过设置 $W(n^{\\star}) = W_{\\min}$ 来找到：\n$$\nW_{\\min} = \\frac{2 P_{r0}}{C_{ox}} \\left(1 - \\alpha \\ln(1+n^{\\star})\\right)\n$$\n我们现在求解这个方程以得到 $n^{\\star}$。重新排列各项以分离出对数项：\n$$\n\\frac{W_{\\min} C_{ox}}{2 P_{r0}} = 1 - \\alpha \\ln(1+n^{\\star})\n$$\n$$\n\\alpha \\ln(1+n^{\\star}) = 1 - \\frac{W_{\\min} C_{ox}}{2 P_{r0}}\n$$\n$$\n\\ln(1+n^{\\star}) = \\frac{1}{\\alpha} \\left(1 - \\frac{W_{\\min} C_{ox}}{2 P_{r0}}\\right)\n$$\n为了求解 $n^{\\star}$，我们对等式两边取指数：\n$$\n1+n^{\\star} = \\exp\\left[\\frac{1}{\\alpha} \\left(1 - \\frac{W_{\\min} C_{ox}}{2 P_{r0}}\\right)\\right]\n$$\n最后，从两边减去 1 得到 $n^{\\star}$ 的精确闭合形式表达式：\n$$\nn^{\\star} = \\exp\\left[\\frac{1}{\\alpha} \\left(1 - \\frac{W_{\\min} C_{ox}}{2 P_{r0}}\\right)\\right] - 1\n$$\n该表达式仅根据初始剩余极化 $P_{r0}$、退化系数 $\\alpha$、单位面积栅叠层电容 $C_{ox}$ 和最小可接受存储窗口 $W_{\\min}$ 给出了循环次数 $n^{\\star}$，符合要求。",
            "answer": "$$\\boxed{\\exp\\left(\\frac{1}{\\alpha}\\left(1 - \\frac{W_{\\min} C_{ox}}{2 P_{r0}}\\right)\\right) - 1}$$"
        }
    ]
}