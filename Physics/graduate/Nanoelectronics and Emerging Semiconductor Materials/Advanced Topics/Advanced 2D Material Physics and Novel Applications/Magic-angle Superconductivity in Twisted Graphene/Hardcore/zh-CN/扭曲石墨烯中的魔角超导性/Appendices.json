{
    "hands_on_practices": [
        {
            "introduction": "在特定“魔角”下出现的近似平坦的电子能带，是扭曲双层石墨烯独特性质的基石。第一个练习将提供一个直接的计算实践，让你亲手构建基础的Bistritzer-MacDonald (BM) 连续模型。通过数值对角化莫尔哈密顿量，你将亲眼见证这些平坦能带的出现，并理解模型参数的重要性 ()。",
            "id": "4285281",
            "problem": "你需要根据 Bistritzer-MacDonald (BM) 模型，为扭转双层石墨烯在给定的扭转角下构建并对角化其连续莫尔哈密顿量，以在平面波基中获得微带谱。目标是展示随着平面波动量基被截断到有限壳层，谱是如何收敛的。\n\n从以下基本出发点开始：\n\n- 单层石墨烯在其一个 Dirac 点附近由一个二维无质量 Dirac 哈密顿量 $h(\\mathbf{p}) = \\hbar v_F \\mathbf{p} \\cdot \\boldsymbol{\\sigma}$ 描述，其中 $\\hbar$ 是约化普朗克常数，$v_F$ 是费米速度，$\\mathbf{p}$ 是相对于 Dirac 点的动量，$\\boldsymbol{\\sigma} = (\\sigma_x,\\sigma_y)$ 是作用在子晶格赝自旋上的 Pauli 矩阵。\n\n- 在扭转角为 $\\theta$ 的扭转双层石墨烯中，两层相对于彼此旋转了 $\\pm \\theta/2$，因此上层和下层的 Dirac 哈密顿量为 $h_{\\pm}(\\mathbf{p}) = \\hbar v_F [R(\\pm \\theta/2)\\mathbf{p}] \\cdot \\boldsymbol{\\sigma}$，其中 $R(\\phi)$ 是作用于动量空间中矢量的二维旋转矩阵，旋转角度为 $\\phi$。\n\n- 层间隧穿可以通过一个具有三个主要傅里叶分量的空间周期性莫尔势来建模。在实空间中，层间耦合为 $T(\\mathbf{r}) = \\sum_{j=1}^3 T_j e^{i \\mathbf{q}_j \\cdot \\mathbf{r}}$，其中 $\\mathbf{q}_j$ 是构成莫尔倒易晶格第一星形的三个波矢，$T_j$ 是作用在子晶格空间中的 $2 \\times 2$ 矩阵。三个 $T_j$ 具有振幅 $w_0$ (子晶格内) 和 $w_1$ (子晶格间)，并具有固定的相对相位，对应于三重旋转对称性。\n\n- 两个旋转后的 Dirac 点之间的波矢分离大小为 $k_\\theta = 2 k_D \\sin(\\theta/2)$，其中 $k_D = \\frac{4\\pi}{3 a}$，$a$ 是石墨烯晶格常数。\n\n- 莫尔倒易晶格基矢可以选择为 $\\mathbf{b}_1 = \\mathbf{q}_2 - \\mathbf{q}_1$ 和 $\\mathbf{b}_2 = \\mathbf{q}_3 - \\mathbf{q}_1$。由整数对 $(m,n)$ 索引的平面波基使用动量 $\\mathbf{G}_{m,n} = m \\mathbf{b}_1 + n \\mathbf{b}_2$。\n\n- 在莫尔布里渊区中的固定晶体动量 $\\mathbf{k}$ 处，动量空间中的 BM 哈密顿量作用于基态 $\\lvert \\text{层}, \\text{子晶格}, m, n \\rangle$。层内块对于上层是 $h_{+}(\\mathbf{k} + \\mathbf{G}_{m,n})$，对于下层是 $h_{-}(\\mathbf{k} + \\mathbf{G}_{m,n} + \\mathbf{q}_1)$。层间块通过 $T_1$ 将上层 $(m,n)$ 与下层 $(m,n)$ 耦合，通过 $T_2$ 将其与下层 $(m+1,n)$ 耦合，通过 $T_3$ 将其与下层 $(m,n+1)$ 耦合，这与平面波谐波 $e^{i\\mathbf{q}_j \\cdot \\mathbf{r}}$ 一致。\n\n你必须实现以下步骤：\n\n1. 使用科学上公认的值定义物理常数 $\\hbar$、$v_F$ 和 $a$。使用 $v_F$ 作为常数，并以毫电子伏 (meV) 表示能量。\n\n2. 对于给定的扭转角 $\\theta$ (以度为单位指定)，构建三个大小为 $k_\\theta = 2 k_D \\sin(\\theta/2)$ 且相隔 $120^\\circ$ 的矢量 $\\mathbf{q}_1$、$\\mathbf{q}_2$ 和 $\\mathbf{q}_3$。然后定义 $\\mathbf{b}_1 = \\mathbf{q}_2 - \\mathbf{q}_1$ 和 $\\mathbf{b}_2 = \\mathbf{q}_3 - \\mathbf{q}_1$。\n\n3. 使用参数 $w_0$ 和 $w_1$ (均以 meV 为单位) 在子晶格空间中定义层间隧穿矩阵 $T_1$、$T_2$ 和 $T_3$。施加三重对称性相位，使得 $T_1 = \\begin{pmatrix} w_0  w_1 \\\\ w_1  w_0 \\end{pmatrix}$，$T_2 = \\begin{pmatrix} w_0  w_1 e^{-i 2\\pi/3} \\\\ w_1 e^{i 2\\pi/3}  w_0 \\end{pmatrix}$，$T_3 = \\begin{pmatrix} w_0  w_1 e^{i 2\\pi/3} \\\\ w_1 e^{-i 2\\pi/3}  w_0 \\end{pmatrix}$。\n\n4. 构建截断到由整数对 $(m,n)$ 定义的动量壳层的平面波基，其中 $(m,n)$ 满足 $\\max\\{|m|,|n|,|m+n|\\} \\leq N$，$N$ 是截断参数。这定义了一个六角形的 $\\mathbf{G}_{m,n}$ 矢量集，并产生一个有限维哈密顿量。\n\n5. 在给定的莫尔晶体动量 $\\mathbf{k}$ 处，组装块哈密顿量 $H(\\mathbf{k})$，其维度为 $4 M$，其中 $M$ 是壳层中 $(m,n)$ 对的数量，每层有两个子晶格，共两层。层内块对于上层是 $h_{+}(\\mathbf{k} + \\mathbf{G}_{m,n})$，对于下层是 $h_{-}(\\mathbf{k} + \\mathbf{G}_{m,n} + \\mathbf{q}_1)$。非对角层间块通过 $T_1$ 耦合 $(m,n)$ 与 $(m,n)$，通过 $T_2$ 耦合 $(m,n)$ 与 $(m+1,n)$，以及通过 $T_3$ 耦合 $(m,n)$ 与 $(m,n+1)$，如果这些索引存在于壳层内。确保厄米性 $H^\\dagger = H$。\n\n6. 对角化 $H(\\mathbf{k})$ 以获得能谱。提取在 $\\mathbf{k}$ 处的中心导带微带能量，即最小的严格正本征值。以 meV 表示能量。\n\n7. 将莫尔布里渊区高对称点定义为 $\\mathbf{\\Gamma} = (0,0)$、$\\mathbf{K}_m = (\\mathbf{b}_1 + \\mathbf{b}_2)/3$ 和 $\\mathbf{M} = \\mathbf{b}_1/2$。对于每个选择的 $\\theta$，计算这些点上的中心导带微带能量。\n\n8. 通过在选定的 $\\mathbf{k}$ 点比较 $N$ 和 $N+1$ 的结果，评估微带能量相对于壳层截断 $N$ 的收敛性。\n\n你的程序必须为以下测试套件实现上述内容：\n\n- 使用 $\\hbar = 6.582119569 \\times 10^{-16}$ 电子伏特·秒，$v_F = 1.0 \\times 10^{6}$ 米/秒，以及 $a = 0.246 \\times 10^{-9}$ 米。\n\n- 对所有测试使用层间隧穿参数 $w_0 = 80$ meV 和 $w_1 = 110$ meV。\n\n- 测试用例：\n  1. 扭转角 $\\theta = 1.05$ 度，比较在 $\\mathbf{\\Gamma}$ 点，$N=0$ 和 $N=1$ 时的中心导带微带能量的绝对差 (以 meV 为单位)。\n  2. 扭转角 $\\theta = 1.05$ 度，比较在 $\\mathbf{\\Gamma}$ 点，$N=1$ 和 $N=2$ 时的绝对差 (以 meV 为单位)。\n  3. 扭转角 $\\theta = 1.05$ 度，比较在 $\\mathbf{K}_m$ 点，$N=1$ 和 $N=2$ 时的绝对差 (以 meV 为单位)。\n  4. 扭转角 $\\theta = 1.05$ 度，对于 $N=2$，计算跨越 $\\mathbf{\\Gamma}$、$\\mathbf{K}_m$ 和 $\\mathbf{M}$ 的中心导带微带的带宽 (以 meV 为单位)，定义为这三点上 $\\max\\{E_+(\\mathbf{k})\\} - \\min\\{E_+(\\mathbf{k})\\}$。\n  5. 扭转角 $\\theta = 1.30$ 度，对于 $N=2$，计算跨越 $\\mathbf{\\Gamma}$、$\\mathbf{K}_m$ 和 $\\mathbf{M}$ 的中心导带微带的带宽 (以 meV 为单位)。\n  6. 扭转角 $\\theta = 1.05$ 度，比较在 $\\mathbf{K}_m$ 点，$N=2$ 和 $N=3$ 时的绝对差 (以 meV 为单位)。\n  7. 一个布尔值，指示在 $\\theta = 1.05$ 度时的带宽 (用例 4) 是否严格小于在 $\\theta = 1.30$ 度时的带宽 (用例 5)，这反映了在魔角附近增加的平坦度。\n\n角度输入必须以度为单位，所有能量输出必须以毫电子伏 (meV) 为单位。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果 (例如，`[result1,result2,result3,...]`)，其中前六个条目是浮点数，最后一个条目是布尔值。不应打印任何额外文本。",
            "solution": "### 第 1 步：提取已知条件\n问题提供了以下数据和定义：\n- **单层哈密顿量**: $h(\\mathbf{p}) = \\hbar v_F \\mathbf{p} \\cdot \\boldsymbol{\\sigma}$，其中 $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y)$。\n- **扭转双层哈密顿量**: 上层 ($+$) 和下层 ($-$) 分别为 $h_{\\pm}(\\mathbf{p}) = \\hbar v_F [R(\\pm \\theta/2)\\mathbf{p}] \\cdot \\boldsymbol{\\sigma}$。$R(\\phi)$ 是一个二维旋转矩阵。\n- **层间隧穿**: $T(\\mathbf{r}) = \\sum_{j=1}^3 T_j e^{i \\mathbf{q}_j \\cdot \\mathbf{r}}$。\n- **隧穿矩阵**:\n  $T_1 = \\begin{pmatrix} w_0  w_1 \\\\ w_1  w_0 \\end{pmatrix}$，\n  $T_2 = \\begin{pmatrix} w_0  w_1 e^{-i 2\\pi/3} \\\\ w_1 e^{i 2\\pi/3}  w_0 \\end{pmatrix}$，\n  $T_3 = \\begin{pmatrix} w_0  w_1 e^{i 2\\pi/3} \\\\ w_1 e^{-i 2\\pi/3}  w_0 \\end{pmatrix}$。\n- **莫尔波矢大小**: $k_\\theta = 2 k_D \\sin(\\theta/2)$，其中 $k_D = \\frac{4\\pi}{3 a}$。\n- **莫尔倒易基矢**: $\\mathbf{b}_1 = \\mathbf{q}_2 - \\mathbf{q}_1$，$\\mathbf{b}_2 = \\mathbf{q}_3 - \\mathbf{q}_1$。\n- **平面波动量**: $\\mathbf{G}_{m,n} = m \\mathbf{b}_1 + n \\mathbf{b}_2$。\n- **哈密顿矩阵元**:\n    - 层内 (上层): $h_{+}(\\mathbf{k} + \\mathbf{G}_{m,n})$。\n    - 层内 (下层): $h_{-}(\\mathbf{k} + \\mathbf{G}_{m,n} + \\mathbf{q}_1)$。\n    - 层间耦合: 上层 $(m,n)$ 通过 $T_1$ 与下层 $(m,n)$ 耦合，通过 $T_2$ 与下层 $(m+1,n)$ 耦合，通过 $T_3$ 与下层 $(m,n+1)$ 耦合。\n- **基矢截断**: 平面波基包含满足 $\\max\\{|m|,|n|,|m+n|\\} \\leq N$ 的整数对 $(m,n)$。\n- **目标可观测量**: 中心导带微带能量，定义为哈密顿矩阵 $H(\\mathbf{k})$ 的最小严格正本征值。\n- **莫尔布里渊区点**: $\\mathbf{\\Gamma} = (0,0)$，$\\mathbf{K}_m = (\\mathbf{b}_1 + \\mathbf{b}_2)/3$，$\\mathbf{M} = \\mathbf{b}_1/2$。\n- **物理常数**:\n    - $\\hbar = 6.582119569 \\times 10^{-16}$ eV·s\n    - $v_F = 1.0 \\times 10^{6}$ m/s\n    - $a = 0.246 \\times 10^{-9}$ m\n- **隧穿参数**: $w_0 = 80$ meV，$w_1 = 110$ meV。\n- **具体任务**: 一套七个计算，涉及在指定的扭转角 ($\\theta=1.05^\\circ, 1.30^\\circ$) 和截断水平 ($N=0, 1, 2, 3$) 下的能量差、带宽和一个布尔比较。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题描述了扭转双层石墨烯的 Bistritzer-MacDonald (BM) 连续模型的构建和对角化。这是现代凝聚态物理中一个基础且科学上已确立的模型。\n- **科学依据**: 该模型基于石墨烯的 Dirac 哈密顿量和周期性层间隧穿势，这些都是标准且广为接受的近似。所有常数和参数都在物理现实范围内。\n- **良态的**: 任务是构建一个有限维厄米矩阵并找到其本征值。这是一个数学上良态的问题，会产生一组唯一的实数本征值。矩阵构建的指令是具体且明确的。\n- **客观性**: 问题以精确的数学和物理术语陈述，没有任何主观或基于意见的语言。\n- **自洽且一致**: 提供了所有必需的参数、方程和定义。关于莫尔几何、哈密顿矩阵元和基矢截断的定义是内部一致的，并遵循了 BM 模型的一个特定、有效的表示。指定的层间耦合与莫尔倒易晶格矢量 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 的性质是一致的。\n\n该问题是一个标准的计算物理练习，不违反任何无效性标准。\n\n### 第 3 步：结论与行动\n问题是**有效的**。将提供一个完整的、有理有据的解决方案。\n\n### 解决方案\n\n该问题要求实现 Bistritzer-MacDonald (BM) 模型来计算扭转双层石墨烯 (TBG) 的电子能带结构。解决方案涉及在截断的平面波基中构建和对角化莫尔哈密顿量。\n\n#### 1. 常数和运动学参数\n首先，我们确定物理常数和派生参数。所有能量将以毫电子伏 (meV) 表示，长度以纳米 (nm) 表示。乘积 $\\hbar v_F$ 提供了自然的能量-动量尺度。\n- 约化普朗克常数: $\\hbar = 6.582119569 \\times 10^{-16}$ eV·s。\n- 费米速度: $v_F = 1.0 \\times 10^6$ m/s。\n- 石墨烯晶格常数: $a = 0.246$ nm。\n复合常数为 $\\hbar v_F = (6.582119569 \\times 10^{-16} \\text{ eV·s}) \\times (1.0 \\times 10^6 \\text{ m/s}) = 6.582119569 \\times 10^{-10} \\text{ eV·m} = 658.2119569$ meV·nm。\n\n对于给定的扭转角 $\\theta$，分隔两个 Dirac 锥的动量大小为 $k_\\theta = 2 k_D \\sin(\\theta/2)$，其中 $k_D = \\frac{4\\pi}{3a}$ 是单层石墨烯布里渊区中从 $\\Gamma$ 点到 $K$ 点的动量大小。\n\n#### 2. 莫尔晶格的几何结构\n层间势的周期性由三个大小为 $k_\\theta$、相隔 $120^\\circ$ 的矢量 $\\mathbf{q}_j$ 定义。我们采用的一个标准选择是：\n$$ \\mathbf{q}_1 = k_\\theta(0, -1), \\quad \\mathbf{q}_2 = k_\\theta(\\frac{\\sqrt{3}}{2}, \\frac{1}{2}), \\quad \\mathbf{q}_3 = k_\\theta(-\\frac{\\sqrt{3}}{2}, \\frac{1}{2}) $$\n莫尔倒易晶格由基矢 $\\mathbf{b}_1 = \\mathbf{q}_2 - \\mathbf{q}_1$ 和 $\\mathbf{b}_2 = \\mathbf{q}_3 - \\mathbf{q}_1$ 张成：\n$$ \\mathbf{b}_1 = k_\\theta(\\frac{\\sqrt{3}}{2}, \\frac{3}{2}), \\quad \\mathbf{b}_2 = k_\\theta(-\\frac{\\sqrt{3}}{2}, \\frac{3}{2}) $$\n一个通用的莫尔倒易晶格矢量是 $\\mathbf{G}_{m,n} = m\\mathbf{b}_1 + n\\mathbf{b}_2$，其中 m, n 为整数。\n\n#### 3. 哈密顿量公式\n哈密顿量作用于一个状态空间，该空间是层、子晶格和动量自由度的乘积。对于给定的莫尔晶体动量 $\\mathbf{k}$，一个基态可以写成 $|\\text{layer, sublattice, } \\mathbf{G}_{m,n}\\rangle$。哈密顿量是在此基中构建的。\n\n层内动力学由旋转的 Dirac 哈密顿量描述。对于动量 $\\mathbf{p}=(p_x, p_y)$，层 $l \\in \\{+,-\\}$ 的哈密顿量是 $h_l(\\mathbf{p}) = \\hbar v_F [R(l\\theta/2)\\mathbf{p}] \\cdot \\boldsymbol{\\sigma}$。矩阵形式为：\n$$ h_l(\\mathbf{p}) = \\hbar v_F \\begin{pmatrix} 0   (p_x - ip_y)e^{-il\\theta/2} \\\\ (p_x + ip_y)e^{il\\theta/2}  0 \\end{pmatrix} $$\n层间隧穿由参数为 $w_0$ 和 $w_1$ 的矩阵 $T_j$ 描述。\n\n#### 4. 组装哈密顿矩阵\n基矢被截断到一个有限的六角形 $\\mathbf{G}_{m,n}$ 矢量壳层，定义为 $\\max\\{|m|, |n|, |m+n|\\} \\leq N$。令 $M$ 为此类 $(m,n)$ 对的数量。哈密顿矩阵 $H(\\mathbf{k})$ 的总维度是 $4M \\times 4M$ (两层，每层两个子晶格)。\n\n我们通过首先遍历 $M$ 个平面波矢量 $\\mathbf{G}_{m,n}$ 来对基矢进行排序，对于每个矢量，我们有一个对应于 (顶层 A，顶层 B，底层 A，底层 B) 的四分量旋量。哈密顿矩阵按以下方式构建：\n\n1.  **生成基矢**: 对于给定的 $N$，生成 $M$ 个 $(m,n)$ 对的列表，并创建从每个对到索引 $i \\in [0, M-1]$ 的映射。\n\n2.  **对角块**: 对于每个对应于 $(m,n)$ 的基态 $i$，完整哈密顿量的对角 $4 \\times 4$ 块耦合了该动量扇区内的四个自由度。\n    - 顶层动量是 $\\mathbf{p}_{\\text{top}} = \\mathbf{k} + \\mathbf{G}_{m,n}$。\n    - 根据指定的规范，底层动量是 $\\mathbf{p}_{\\text{bot}} = \\mathbf{k} + \\mathbf{G}_{m,n} + \\mathbf{q}_1$。\n    - 层间的现场耦合通过 $T_1$ 实现。\n    索引 $i$ 的 $4 \\times 4$ 对角块是：\n    $$ H_{i,i}(\\mathbf{k}) = \\begin{pmatrix} h_+(\\mathbf{p}_{\\text{top}})   T_1 \\\\ T_1^\\dagger  h_-(\\mathbf{p}_{\\text{bot}}) \\end{pmatrix} $$\n    因为 $T_1$ 是实数且对称的，所以 $T_1^\\dagger = T_1$。\n\n3.  **非对角块**: $T_2$ 和 $T_3$ 项耦合了具有不同动量矢量的状态。按照问题的方案：\n    - 一个顶层状态 $(m,n)$ 通过 $T_2$ 耦合到一个底层状态 $(m+1, n)$。如果 $i$ 是 $(m,n)$ 的索引，$j$ 是 $(m+1, n)$ 的索引，这会将 $2 \\times 2$ 矩阵 $T_2$ 放置在 $4 \\times 4$ 块 $H_{i,j}$ 的右上象限中。\n    - 厄米性要求底层状态 $(m+1, n)$ 通过 $T_2^\\dagger$ 耦合回顶层状态 $(m,n)$。这会将 $T_2^\\dagger$ 放置在 $4 \\times 4$ 块 $H_{j,i}$ 的左下象限中。\n    - 类似地，$T_3$ 和 $T_3^\\dagger$ 耦合状态 $(m,n)$ 和 $(m,n+1)$。\n\n#### 5. 计算与谱分析\n一旦构建了完整的厄米矩阵 $H(\\mathbf{k})$，就对其进行数值对角化。本征值代表能量微带 $E_n(\\mathbf{k})$。问题要求的是中心导带微带的能量，即最小的严格正本征值。使用一个小的数值容差来将其与应为零的本征值区分开。\n\n所需的测试用例涉及在高等对称点 ($\\mathbf{\\Gamma}, \\mathbf{K}_m, \\mathbf{M}$) 计算该能量，以用于不同的角度和截断水平，然后计算能量差以评估收敛性，以及计算带宽以表征能带的平坦度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the twisted bilayer graphene problem.\n    It orchestrates the calculations for each of the seven test cases.\n    \"\"\"\n\n    # Physical constants and parameters\n    H_BAR_VF = 658.2119569  # meV * nm\n    A_LATTICE = 0.246  # nm\n    W0 = 80.0  # meV\n    W1 = 110.0  # meV\n\n    params = {\n        'h_bar_vf': H_BAR_VF,\n        'a': A_LATTICE,\n        'w0': W0,\n        'w1': W1\n    }\n\n    # Test cases\n    # Case 1: theta=1.05, k=Gamma, convergence N=0 vs N=1\n    theta1 = 1.05\n    geom1 = get_geometry(theta1, params)\n    k_gamma = np.array([0.0, 0.0])\n    e_n0_g = get_central_band_energy(theta1, 0, k_gamma, params, geom1)\n    e_n1_g = get_central_band_energy(theta1, 1, k_gamma, params, geom1)\n    result1 = abs(e_n1_g - e_n0_g)\n\n    # Case 2: theta=1.05, k=Gamma, convergence N=1 vs N=2\n    e_n2_g = get_central_band_energy(theta1, 2, k_gamma, params, geom1)\n    result2 = abs(e_n2_g - e_n1_g)\n\n    # Case 3: theta=1.05, k=Km, convergence N=1 vs N=2\n    k_m = geom1['k_m']\n    e_n1_km = get_central_band_energy(theta1, 1, k_m, params, geom1)\n    e_n2_km = get_central_band_energy(theta1, 2, k_m, params, geom1)\n    result3 = abs(e_n2_km - e_n1_km)\n\n    # Case 4: theta=1.05, N=2, bandwidth\n    e_n2_gamma_105 = get_central_band_energy(theta1, 2, k_gamma, params, geom1)\n    e_n2_km_105 = get_central_band_energy(theta1, 2, k_m, params, geom1)\n    e_n2_m_105 = get_central_band_energy(theta1, 2, geom1['m_k'], params, geom1)\n    energies_105 = [e_n2_gamma_105, e_n2_km_105, e_n2_m_105]\n    result4 = max(energies_105) - min(energies_105)\n\n    # Case 5: theta=1.30, N=2, bandwidth\n    theta2 = 1.30\n    geom2 = get_geometry(theta2, params)\n    e_n2_gamma_130 = get_central_band_energy(theta2, 2, k_gamma, params, geom2)\n    e_n2_km_130 = get_central_band_energy(theta2, 2, geom2['k_m'], params, geom2)\n    e_n2_m_130 = get_central_band_energy(theta2, 2, geom2['m_k'], params, geom2)\n    energies_130 = [e_n2_gamma_130, e_n2_km_130, e_n2_m_130]\n    result5 = max(energies_130) - min(energies_130)\n    \n    # Case 6: theta=1.05, k=Km, convergence N=2 vs N=3\n    e_n3_km = get_central_band_energy(theta1, 3, k_m, params, geom1)\n    result6 = abs(e_n3_km - e_n2_km)\n\n    # Case 7: Bandwidth comparison boolean\n    result7 = result4  result5\n\n    results = [result1, result2, result3, result4, result5, result6, result7]\n    \n    # Format and print the final output\n    formatted_results = [f\"{r:.7f}\" for r in results[:6]] + [str(results[6]).lower()]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef get_geometry(theta_deg, params):\n    \"\"\"Pre-calculates geometric quantities for a given twist angle.\"\"\"\n    theta_rad = np.deg2rad(theta_deg)\n    k_d = 4 * np.pi / (3 * params['a'])\n    k_theta = 2 * k_d * np.sin(theta_rad / 2)\n\n    q1 = k_theta * np.array([0, -1])\n    q2 = k_theta * np.array([np.sqrt(3)/2, 1/2])\n    q3 = k_theta * np.array([-np.sqrt(3)/2, 1/2])\n\n    b1 = q2 - q1\n    b2 = q3 - q1\n\n    return {\n        'k_theta': k_theta,\n        'q1': q1, 'q2': q2, 'q3': q3,\n        'b1': b1, 'b2': b2,\n        'k_m': (b1 + b2) / 3,\n        'm_k': b1 / 2\n    }\n\ndef get_central_band_energy(theta_deg, N, k_vec, params, geom):\n    \"\"\"\n    Constructs and diagonalizes the BM Hamiltonian for a given set of parameters.\n    Returns the energy of the central conduction miniband in meV.\n    \"\"\"\n    theta_rad = np.deg2rad(theta_deg)\n    h_bar_vf = params['h_bar_vf']\n    w0 = params['w0']\n    w1 = params['w1']\n\n    # Generate plane-wave basis\n    mn_list = []\n    for m in range(-N, N + 1):\n        for n in range(-N, N + 1):\n            if max(abs(m), abs(n), abs(m + n)) = N:\n                mn_list.append((m, n))\n    \n    M = len(mn_list)\n    mn_to_idx = {mn: i for i, mn in enumerate(mn_list)}\n    \n    H_dim = 4 * M\n    H = np.zeros((H_dim, H_dim), dtype=np.complex128)\n    \n    # Pauli matrices (sigma_x, sigma_y)\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=complex)\n    \n    # Interlayer tunneling matrices T_j\n    phase2 = np.exp(-1j * 2 * np.pi / 3)\n    phase3 = np.exp(1j * 2 * np.pi / 3)\n    T1 = np.array([[w0, w1], [w1, w0]], dtype=complex)\n    T2 = np.array([[w0, w1 * phase2], [w1 * np.conj(phase2), w0]], dtype=complex)\n    T3 = np.array([[w0, w1 * phase3], [w1 * np.conj(phase3), w0]], dtype=complex)\n    \n    # Single layer Dirac Hamiltonian generator\n    def h_dirac(p, layer_sign):\n        phi = layer_sign * theta_rad / 2.0\n        px, py = p\n        h = h_bar_vf * ((px * np.cos(phi) - py * np.sin(phi)) * sigma_x +\n                        (px * np.sin(phi) + py * np.cos(phi)) * sigma_y)\n        return h\n\n    # Assemble the Hamiltonian matrix\n    for i, (m, n) in enumerate(mn_list):\n        G = m * geom['b1'] + n * geom['b2']\n        idx_i = 4 * i\n\n        # Diagonal blocks (intra-layer terms and T1 coupling)\n        p_top = k_vec + G\n        p_bot = k_vec + G + geom['q1']\n\n        H[idx_i:idx_i+2, idx_i:idx_i+2] = h_dirac(p_top, 1)  # Top layer\n        H[idx_i+2:idx_i+4, idx_i+2:idx_i+4] = h_dirac(p_bot, -1) # Bottom layer\n        H[idx_i:idx_i+2, idx_i+2:idx_i+4] = T1 # Top -> Bot\n        H[idx_i+2:idx_i+4, idx_i:idx_i+2] = T1.T.conj() # Bot -> Top (Hermitian conjugate)\n\n        # Off-diagonal blocks (T2 and T3 couplings)\n        # T2 coupling: (m,n) -> (m+1, n)\n        if (m + 1, n) in mn_to_idx:\n            j = mn_to_idx[(m + 1, n)]\n            idx_j = 4 * j\n            H[idx_i:idx_i+2, idx_j+2:idx_j+4] = T2\n            H[idx_j+2:idx_j+4, idx_i:idx_i+2] = T2.T.conj()\n            \n        # T3 coupling: (m,n) -> (m, n+1)\n        if (m, n + 1) in mn_to_idx:\n            k_idx = mn_to_idx[(m, n + 1)]\n            idx_k = 4 * k_idx\n            H[idx_i:idx_i+2, idx_k+2:idx_k+4] = T3\n            H[idx_k+2:idx_k+4, idx_i:idx_i+2] = T3.T.conj()\n\n    # Diagonalize the Hermitian matrix\n    eigenvalues = np.linalg.eigh(H)[0]\n    \n    # Find the smallest strictly positive eigenvalue\n    positive_eigs = eigenvalues[eigenvalues > 1e-9]\n    if len(positive_eigs) == 0:\n        return 0.0 # Should not happen for non-zero couplings\n    \n    return np.min(positive_eigs)\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "一旦平坦能带形成，电子动能被抑制，电子-电子相互作用便占据主导地位，驱动系统进入关联绝缘态和超导态。本练习将从单粒子物理学转向相互作用的关键作用，要求你推导实验几何结构（特别是与屏蔽门的距离）如何控制有效库仑相互作用强度。这项实践连接了抽象的理论模型和具体的实验设计，展示了如何在实验室中调控关联效应 ()。",
            "id": "4285338",
            "problem": "考虑魔角扭转双层石墨烯（MATBG），其被六方氮化硼（hBN）介电层对称包裹，并由位于MATBG平面两侧中心距为 $D$ 的金属门进行屏蔽。hBN的相对介电常数为 $\\epsilon_{\\mathrm{h}}$，金属门被假定为理想导体。由小扭转角 $\\theta$ 产生的莫尔超晶格具有特征实空间周期 $L_{\\mathrm{m}}$ 和第一壳层倒易晶格矢量大小 $G_{\\mathrm{m}}$，由小角度几何关系定义：\n$$L_{\\mathrm{m}} = \\frac{a}{2 \\sin(\\theta/2)}, \\qquad G_{\\mathrm{m}} = \\frac{4 \\pi}{\\sqrt{3} \\, L_{\\mathrm{m}}},$$\n其中 $a$ 是单层石墨烯的晶格常数。将进入关联相图的主要电子-电子相互作用尺度处理为在莫尔尺度下计算的屏蔽库仑能。以未屏蔽的双体库仑能作为基本出发点，其在距离 $r$ 处的表达式为 $U(r) = \\frac{e^{2}}{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} \\, r}$，其中 $e$ 是元电荷，$\\epsilon_{0}$ 是真空介电常数。通过设置 $r = L_{\\mathrm{m}}$ 来近似相关的短程尺度，从而定义裸相互作用强度：\n$$U_{\\mathrm{bare}} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} \\, L_{\\mathrm{m}}}.$$\n在对称双金属门存在的情况下，使用经过充分验证的静电学结论：二维相互作用的长波分量在波矢量 $G$ 处被一个因子 $\\tanh(G D)$ 抑制。您应将此结论应用于 $G = G_{\\mathrm{m}}$，以获得莫尔尺度下的有效相互作用强度：\n$$U_{\\mathrm{eff}}(D) = U_{\\mathrm{bare}} \\, \\tanh\\!\\big(G_{\\mathrm{m}} D\\big).$$\n定义无量纲关联强度\n$$\\Lambda(D) = \\frac{U_{\\mathrm{eff}}(D)}{W},$$\n其中 $W$ 是最低莫尔能带的特征带宽。设 $\\Lambda_{\\mathrm{c}}$ 是一个阈值，标记相图中强关联（例如，关联绝缘体或超导）和弱关联（例如，常规金属性为）之间的边界。\n\n仅从上述定义和基本静电学出发，推导临界hBN厚度 $D_{\\mathrm{c}}$ 的闭式解析表达式（作为 $e$, $\\epsilon_{0}$, $\\epsilon_{\\mathrm{h}}$, $a$, $\\theta$, $W$ 和 $\\Lambda_{\\mathrm{c}}$ 的函数），使得 $\\Lambda(D_{\\mathrm{c}}) = \\Lambda_{\\mathrm{c}}$。您的最终答案必须是单一的闭式表达式。不需要进行数值计算。如果您之后选择进行计算，请将 $D_{\\mathrmc}$ 以纳米为单位表示，并将 $\\theta$ 以弧度为单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n问题陈述中提供的明确数据、变量和定义如下：\n- 莫尔超晶格实空间周期：$L_{\\mathrm{m}} = \\frac{a}{2 \\sin(\\theta/2)}$\n- 单层石墨烯晶格常数：$a$\n- 莫尔超晶格第一壳层倒易晶格矢量大小：$G_{\\mathrm{m}} = \\frac{4 \\pi}{\\sqrt{3} \\, L_{\\mathrm{m}}}$\n- 六方氮化硼（hBN）的相对介电常数：$\\epsilon_{\\mathrm{h}}$\n- 金属门与MATBG平面的距离：$D$\n- 元电荷：$e$\n- 真空介电常数：$\\epsilon_{0}$\n- 距离为 $r$ 时的未屏蔽双体库仑能：$U(r) = \\frac{e^{2}}{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} \\, r}$\n- 莫尔尺度下的裸相互作用强度：$U_{\\mathrm{bare}} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} \\, L_{\\mathrm{m}}}$\n- 对称双门存在时的有效相互作用强度：$U_{\\mathrm{eff}}(D) = U_{\\mathrm{bare}} \\, \\tanh(G_{\\mathrm{m}} D)$\n- 最低莫尔能带的特征带宽：$W$\n- 无量纲关联强度：$\\Lambda(D) = \\frac{U_{\\mathrm{eff}}(D)}{W}$\n- 临界关联强度阈值：$\\Lambda_{\\mathrm{c}}$\n- 为求得临界hBN厚度 $D_{\\mathrm{c}}$ 而需解的条件是：$\\Lambda(D_{\\mathrm{c}}) = \\Lambda_{\\mathrm{c}}$\n\n### 第2步：使用提取的已知条件进行验证\n根据所需标准对问题进行验证。\n- **科学依据充分：** 该问题牢固地植根于二维材料的既有物理学，特别是魔角扭转双层石墨烯（MATBG）。所描述的模型涉及莫尔超晶格、由金属门引起的屏蔽库仑相互作用，以及相互作用能与电子带宽的比较，这是凝聚态物理学中研究关联电子现象的一个标准且广泛使用的框架。屏蔽势的公式与 $\\tanh(GD)$ 成正比，是两个接地平面之间电荷片的经典静电学结果。该问题在科学上是合理的。\n- **适定性良好：** 该问题提供了一套完整的定义和方程，可以导出一个关于未知量 $D_{\\mathrm{c}}$ 的单一方程。任务是反演一个涉及双曲正切函数的关系，该函数在其定义域内是数学上适定的。只要物理参数使得反双曲正切函数的自变量在 $-1$ 和 $1$ 之间，就存在一个唯一且稳定的 $D_{\\mathrm{c}}$ 解。这个条件在物理上是必需的（屏蔽相互作用不能超过裸相互作用）。因此，该问题是适定的。\n- **客观性：** 该问题以精确、定量且无偏见的技术语言陈述。没有主观因素。\n- **结论：** 该问题满足所有有效性标准。这是一个有科学依据、适定且客观的问题，可以通过直接的解析推导来解决。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。我们现在开始求解。\n\n目标是基于条件 $\\Lambda(D_{\\mathrm{c}}) = \\Lambda_{\\mathrm{c}}$ 推导临界厚度 $D_{\\mathrm{c}}$ 的闭式表达式。\n我们从临界条件的定义方程开始：\n$$\n\\Lambda(D_{\\mathrm{c}}) = \\Lambda_{\\mathrm{c}}\n$$\n使用无量纲关联强度的定义 $\\Lambda(D) = \\frac{U_{\\mathrm{eff}}(D)}{W}$，我们代入 $D = D_{\\mathrm{c}}$：\n$$\n\\frac{U_{\\mathrm{eff}}(D_{\\mathrm{c}})}{W} = \\Lambda_{\\mathrm{c}}\n$$\n接下来，我们代入有效相互作用强度的表达式 $U_{\\mathrm{eff}}(D) = U_{\\mathrm{bare}} \\tanh(G_{\\mathrm{m}} D)$：\n$$\n\\frac{U_{\\mathrm{bare}} \\tanh(G_{\\mathrm{m}} D_{\\mathrm{c}})}{W} = \\Lambda_{\\mathrm{c}}\n$$\n现在，我们进行代数运算以分离出 $D_{\\mathrm{c}}$。首先，我们求解 $\\tanh$ 项：\n$$\n\\tanh(G_{\\mathrm{m}} D_{\\mathrm{c}}) = \\frac{\\Lambda_{\\mathrm{c}} W}{U_{\\mathrm{bare}}}\n$$\n为了分离出双曲正切的自变量，我们将反双曲正切函数 $\\arctanh$ 应用于方程两边：\n$$\nG_{\\mathrm{m}} D_{\\mathrm{c}} = \\arctanh\\left(\\frac{\\Lambda_{\\mathrm{c}} W}{U_{\\mathrm{bare}}}\\right)\n$$\n这给出了 $D_{\\mathrm{c}}$ 的表达式：\n$$\nD_{\\mathrm{c}} = \\frac{1}{G_{\\mathrm{m}}} \\arctanh\\left(\\frac{\\Lambda_{\\mathrm{c}} W}{U_{\\mathrm{bare}}}\\right)\n$$\n问题要求最终表达式是 $e$, $\\epsilon_{0}$, $\\epsilon_{\\mathrm{h}}$, $a$, $\\theta$, $W$ 和 $\\Lambda_{\\mathrm{c}}$ 的函数。我们必须将 $U_{\\mathrm{bare}}$, $G_{\\mathrm{m}}$ 和 $L_{\\mathrm{m}}$ 的定义代入此方程。\n首先，代入裸相互作用的表达式 $U_{\\mathrm{bare}} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} L_{\\mathrm{m}}}$：\n$$\nD_{\\mathrm{c}} = \\frac{1}{G_{\\mathrm{m}}} \\arctanh\\left(\\frac{\\Lambda_{\\mathrm{c}} W}{\\frac{e^{2}}{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} L_{\\mathrm{m}}}}\\right) = \\frac{1}{G_{\\mathrm{m}}} \\arctanh\\left(\\frac{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} L_{\\mathrm{m}} \\Lambda_{\\mathrm{c}} W}{e^{2}}\\right)\n$$\n接下来，代入莫尔倒易晶格矢量大小的表达式 $G_{\\mathrm{m}} = \\frac{4 \\pi}{\\sqrt{3} L_{\\mathrm{m}}}$：\n$$\nD_{\\mathrm{c}} = \\left(\\frac{\\sqrt{3} L_{\\mathrm{m}}}{4 \\pi}\\right) \\arctanh\\left(\\frac{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} L_{\\mathrm{m}} \\Lambda_{\\mathrm{c}} W}{e^{2}}\\right)\n$$\n最后，我们代入莫尔长度的表达式 $L_{\\mathrm{m}} = \\frac{a}{2 \\sin(\\theta/2)}$，以消除所有中间变量：\n$$\nD_{\\mathrm{c}} = \\left(\\frac{\\sqrt{3}}{4 \\pi}\\right) \\left(\\frac{a}{2 \\sin(\\theta/2)}\\right) \\arctanh\\left(\\frac{4 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} \\Lambda_{\\mathrm{c}} W}{e^{2}} \\left(\\frac{a}{2 \\sin(\\theta/2)}\\right)\\right)\n$$\n简化系数得到临界厚度 $D_{\\mathrm{c}}$ 的最终闭式表达式：\n$$\nD_{\\mathrm{c}} = \\frac{\\sqrt{3} a}{8 \\pi \\sin(\\theta/2)} \\arctanh\\left(\\frac{2 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} a \\Lambda_{\\mathrm{c}} W}{e^{2} \\sin(\\theta/2)}\\right)\n$$\n此表达式仅依赖于问题陈述中指定的基本常数和系统参数，符合要求。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{3} a}{8 \\pi \\sin(\\theta/2)} \\arctanh\\left(\\frac{2 \\pi \\epsilon_{0} \\epsilon_{\\mathrm{h}} a \\Lambda_{\\mathrm{c}} W}{e^{2} \\sin(\\theta/2)}\\right)}\n$$"
        },
        {
            "introduction": "关联态的性质通过输运测量来探测，其中电阻率是反映电子散射机制的主要指标。最后一个练习要求你实现一个电阻率模型，该模型主要由莫尔晶格增强的乌姆克拉普（Umklapp）散射决定，这是魔角石墨烯中的一个关键过程。通过将费米面几何与莫尔晶格周期性联系起来，你将计算出这种散射机制如何在特定电子填充下引起电阻率的特征峰，从而深入理解这些系统的实验信号 ()。",
            "id": "4285352",
            "problem": "你需要编写一个完整的程序，该程序基于有原理依据的记忆矩阵方法，估算在所谓的魔角附近扭转双层石墨烯中的直流 (DC) 电阻率，在魔角附近，乌姆克拉普散射（Umklapp scattering）会因莫尔周期性而增强。计算必须从线性响应和记忆矩阵形式理论出发，使用单一慢模，并推导出一个可用物理可测量参数和莫尔几何结构表达的可解表达式。所有角度必须以度为单位处理，温度以开尔文为单位，最终电阻率必须以 $\\mathrm{\\Omega}/\\square$ 表示。你的程序必须为指定的测试套件生成电阻率值，并将它们以单行逗号分隔列表的形式输出，并用方括号括起来（例如，$[r_1,r_2,r_3]$），每个值四舍五入到三位有效数字。\n\n使用的基本原理和建模假设：\n- 从线性响应理论和久保公式（Kubo formula）出发，通过记忆矩阵形式理论进行特化。在一个金属中，如果只有一个近守恒的动量模式 $P$ 控制着电流弛豫，那么直流 (DC) 电导率 $\\sigma_{\\mathrm{dc}}$ 可以通过静态 susceptibility 和动量-记忆元件表示为\n$$\\sigma_{\\mathrm{dc}} = \\frac{\\chi_{JP}^2}{M_{PP}},$$\n其中 $\\chi_{JP}$ 是耦合电流算符 $J$ 和动量 $P$ 的静态 susceptibility，而 $M_{PP}$ 是记忆矩阵的动量分量。对于弱莫尔周期势和长波输运，近似认为 $\\chi_{JP} \\approx n e$，其中 $n$ 是二维电子密度，$e$ 是基本电荷。因此，直流电阻率为\n$$\\rho = \\frac{1}{\\sigma_{\\mathrm{dc}}} = \\frac{M_{PP}}{(n e)^2}。$$\n- 假设对 $M_{PP}$ 的主要贡献来自电子-电子乌姆克拉普散射，其费米液体相空间标度与 $T^2$ 成正比，再乘以一个无量纲共振因子，该因子在可用动量转移匹配一个莫尔原胞倒格矢时急剧增强散射率。将此共振建模为一个洛伦兹函数，其变量为两倍费米动量与最小莫尔倒格矢模长之间的失配：\n$$M_{PP}(\\theta,\\nu,T) \\propto T^2 \\times \\mathcal{L}\\!\\left(2 k_F(\\nu,\\theta),\\, G_m(\\theta)\\right),$$\n$$\\mathcal{L}(X,G) = \\frac{1}{1 + \\left(\\frac{X-G}{\\delta G}\\right)^2},$$\n其中 $\\delta$ 是一个无量纲宽度参数，它包含了无序和有限寿命展宽的影响，$k_F$ 是费米动量，$G_m$ 是最小莫尔倒格矢的模长，两者都由扭转角 $\\theta$ 和填充数 $\\nu$ 决定。\n- 使用扭转石墨烯的莫尔超晶格的几何关系。莫尔晶格常数为\n$$a_m(\\theta) = \\frac{a_0}{2 \\sin\\!\\left(\\frac{\\theta}{2}\\right)},$$\n其中 $a_0$ 是石墨烯晶格常数。对于六角晶格，莫尔晶胞面积为\n$$A_m(\\theta) = \\frac{\\sqrt{3}}{2}\\, a_m(\\theta)^2。$$\n最小倒格矢的模长为\n$$G_m(\\theta) = \\frac{4\\pi}{\\sqrt{3}\\, a_m(\\theta)}。$$\n- 在填充数 $\\nu$ （每个莫尔晶胞的电子数）下的载流子密度为\n$$n(\\nu,\\theta) = \\frac{\\nu}{A_m(\\theta)}。$$\n假设四重简并（两倍自旋和两倍谷）。对于二维 (2D) 费米气体，$n$ 和 $k_F$ 的关系为\n$$n = \\frac{g_d\\, k_F^2}{4\\pi},\\quad g_d = 4,$$\n所以\n$$k_F(\\nu,\\theta) = \\sqrt{\\frac{4\\pi\\, n(\\nu,\\theta)}{g_d}}。$$\n- 通过一个有效动量弛豫时间 $\\tau_U^{-1} = B_U T^2 \\mathcal{L}(2 k_F, G_m)$ 来完善模型，该弛豫时间与单模记忆矩阵标度一致；于是\n$$\\rho(\\theta,\\nu,T) = \\frac{m^*}{n(\\nu,\\theta)\\, e^2}\\, \\tau_U^{-1}(\\theta,\\nu,T) = \\frac{m^*}{n(\\nu,\\theta)\\, e^2}\\, B_U\\, T^2\\, \\mathcal{L}\\!\\left(2 k_F(\\nu,\\theta),\\, G_m(\\theta)\\right),$$\n其中 $m^*$ 是一个有效质量参数，反映了魔角附近的能带平坦度，$B_U$ 是一个唯象的 Umklapp 强度，它将矩阵元权重和莫尔结构因子振幅合并为一个单一的标度。\n\n实现以下常数和参数的数值：\n- 石墨烯晶格常数 $a_0 = 0.246\\times 10^{-9}\\,\\mathrm{m}$。\n- 基本电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n- 电子静止质量 $m_e = 9.10938356\\times 10^{-31}\\,\\mathrm{kg}$，并取 $m^* = 0.5\\, m_e$。\n- Umklapp 前因子 $B_U = 1.0\\times 10^{9}\\,\\mathrm{s^{-1}\\,K^{-2}}$。\n- 简并度 $g_d = 4$。\n- 洛伦茲宽度参数 $\\delta = 0.05$。\n- 所有角度 $\\theta$ 以度为单位提供，必须在内部转换为弧度以用于三角函数。\n\n所需单位和舍入：\n- 温度 $T$ 必须以 $\\mathrm{K}$ 为单位提供。\n- 电阻率 $\\rho$ 必须以 $\\mathrm{\\Omega}/\\square$ 为单位计算和返回，并四舍五入到三位有效数字。\n- 角度输入以度为单位。\n\n测试套件：\n计算并报告以下参数集的 $\\rho(\\theta,\\nu,T)$，这些参数集旨在探测近公度填充时的共振增强、离共振行为、角度敏感性以及低温极限：\n- 情况 1：$\\theta = 1.10$ 度, $\\nu = 3.60$, $T = 20\\,\\mathrm{K}$。\n- 情况 2：$\\theta = 1.10$ 度, $\\nu = 2.00$, $T = 20\\,\\mathrm{K}$。\n- 情况 3：$\\theta = 1.20$ 度, $\\nu = 3.60$, $T = 20\\,\\mathrm{K}$。\n- 情况 4：$\\theta = 1.05$ 度, $\\nu = 3.60$, $T = 0\\,\\mathrm{K}$。\n- 情况 5：$\\theta = 1.10$ 度, $\\nu = 0.50$, $T = 5\\,\\mathrm{K}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序与上述情况相同。例如：\n$$[r_1,r_2,r_3,r_4,r_5],$$\n其中每个 $r_i$ 是计算出的电阻率，单位为 $\\mathrm{\\Omega}/\\square$，四舍五入到三位有效数字，以小数或科学记数法表示。",
            "solution": "该问题陈述经过了严格验证，并被确定为有效。它科学上基于一个简化但有物理动机的莫尔超晶格中电子输运模型，定义良好，提供了所有必要的参数和方程，并且没有矛盾、歧义或无法形式化的前提。该问题构成了一个基于凝聚态物理既定原理的、定义明确的计算任务。\n\n我们通过实现所提供的扭转双层石墨烯直流电阻率模型来着手开发解决方案。计算方法按步骤顺序 structuring，从输入参数开始，到最终的电阻率值结束。\n\n模型的核心是直流电阻率 $\\rho$ 作为扭转角 $\\theta$、莫尔填充因子 $\\nu$ 和温度 $T$ 的函数表达式：\n$$ \\rho(\\theta,\\nu,T) = \\frac{m^*}{n(\\nu,\\theta)\\, e^2}\\, B_U\\, T^2\\, \\mathcal{L}\\!\\left(2 k_F(\\nu,\\theta),\\, G_m(\\theta)\\right) $$\n此表达式需要计算几个中间量，这些量源自莫尔超晶格的几何结构和二维电子气的电子特性。\n\n步骤 1：莫尔几何计算\n第一步是确定莫尔超晶格的几何特性，这仅取决于扭轉角 $\\theta$。输入的角度 $\\theta$ 以度为单位，必须转换为弧度才能用于三角函数：$\\theta_{\\mathrm{rad}} = \\theta \\cdot \\pi/180$。\n莫尔晶格常数 $a_m$ 由下式给出：\n$$ a_m(\\theta) = \\frac{a_0}{2 \\sin(\\theta_{\\mathrm{rad}}/2)} $$\n其中 $a_0 = 0.246 \\times 10^{-9}\\, \\mathrm{m}$ 是石墨烯晶格常数。\n六角形莫尔晶胞的面积 $A_m$ 则是：\n$$ A_m(\\theta) = \\frac{\\sqrt{3}}{2} a_m(\\theta)^2 $$\n最小莫尔倒格矢的模长 $G_m$ 是 Umklapp 散射条件的关键参数：\n$$ G_m(\\theta) = \\frac{4\\pi}{\\sqrt{3}\\, a_m(\\theta)} $$\n\n步骤 2：电子特性计算\n接下来，我们计算电子特性，这取决于莫尔几何（通过 $A_m$）和填充因子 $\\nu$。二维载流子密度 $n$ 是单位面积的载流子数量。对于每个莫尔晶胞填充 $\\nu$ 个电子，密度为：\n$$ n(\\nu,\\theta) = \\frac{\\nu}{A_m(\\theta)} $$\n对于简并度为 $g_d=4$（自旋和谷）的二维电子气，载流子密度与费米动量 $k_F$ 相关：\n$$ n = \\frac{g_d k_F^2}{4\\pi} $$\n解出 $k_F$ 得：\n$$ k_F(\\nu,\\theta) = \\sqrt{\\frac{4\\pi\\, n(\\nu,\\theta)}{g_d}} $$\nUmklapp 散射的条件涉及一个倒格矢的动量转移。该模型考虑了一个过程，其中两个靠近费米面的电子发生散射，总动量变化约为 $2k_F$。当这个动量转移 $2 k_F$ 与莫尔倒格矢 $G_m$ 匹配时，发生共振，从而增强散射。\n\n步骤 3：电阻率计算\n最后一步是计算电阻率。散射增强由一个洛伦兹函数 $\\mathcal{L}$ 描述，该函数以共振条件 $2k_F = G_m$ 为中心：\n$$ \\mathcal{L}(2k_F, G_m) = \\frac{1}{1 + \\left(\\frac{2k_F - G_m}{\\delta G_m}\\right)^2} $$\n其中 $\\delta = 0.05$ 是一个无量纲展宽参数。\n\n计算完所有分量后，我们就可以组装最终的电阻率。因子 $B_U T^2$ 模拟了费米液体中电子-电子散射的 $T^2$ 依赖性。完整的表达式是：\n$$ \\rho(\\theta,\\nu,T) = \\left(\\frac{m^*}{n(\\nu,\\theta) e^2}\\right) \\times \\left(B_U T^2\\right) \\times \\mathcal{L}(2k_F, G_m) $$\n使用的常数如下：\n- 有效质量：$m^* = 0.5\\, m_e = 0.5 \\times (9.10938356\\times 10^{-31}\\,\\mathrm{kg})$\n- Umklapp 前因子：$B_U = 1.0\\times 10^{9}\\,\\mathrm{s^{-1}\\,K^{-2}}$\n- 基本电荷：$e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n\n对于 $T=0\\,\\mathrm{K}$ 的特殊情况，电阻率与 $T^2$ 成正比，所以 $\\rho(\\theta, \\nu, T=0) = 0$。这与完美费米液体的行为一致。\n\n所得电阻率的单位是 $\\mathrm{kg} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{s}^{-1} \\cdot \\mathrm{C}^{-2}$，等效于欧姆 ($\\Omega$)。由于这是一个二维电阻率，通常以欧姆每平方 ($\\Omega/\\square$) 为单位报价，这在量纲上是相同的。计算将通过为每个测试案例实施这些公式来进行，最终值将被四舍五入到三位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the DC resistivity in twisted bilayer graphene based on a\n    memory-matrix model for Umklapp scattering.\n    \"\"\"\n\n    # Define physical and model constants as per the problem statement.\n    A0 = 0.246e-9  # Graphene lattice constant, meters\n    E = 1.602176634e-19  # Elementary charge, Coulombs\n    ME = 9.10938356e-31  # Electron rest mass, kg\n    M_STAR = 0.5 * ME  # Effective mass, kg\n    BU = 1.0e9  # Umklapp prefactor, s^-1 K^-2\n    GD = 4  # Degeneracy factor (spin x valley), dimensionless\n    DELTA = 0.05  # Lorentzian width parameter, dimensionless\n\n    def calculate_resistivity(theta_deg, nu, T):\n        \"\"\"\n        Computes the resistivity for a given set of parameters.\n\n        Args:\n            theta_deg (float): Twist angle in degrees.\n            nu (float): Moiré filling factor (electrons per unit cell).\n            T (float): Temperature in Kelvin.\n\n        Returns:\n            float: The calculated resistivity in Ohms per square (Ω/sq).\n        \"\"\"\n        # A T^2 dependence means resistivity is zero at T=0.\n        if T == 0.0:\n            return 0.0\n        \n        # A filling of zero means no charge carriers, leading to infinite resistivity.\n        # This case is not in the test suite but is a physical edge case.\n        if nu == 0.0:\n            return np.inf\n\n        # Convert angle from degrees to radians for trigonometric functions.\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # Step 1: Calculate moiré geometry.\n        # Avoid division by zero for theta=0, though not in test suite.\n        if theta_rad == 0:\n            return np.nan\n        \n        # Moiré lattice constant.\n        a_m = A0 / (2.0 * np.sin(theta_rad / 2.0))\n        \n        # Moiré unit cell area.\n        A_m = (np.sqrt(3.0) / 2.0) * a_m**2\n        \n        # Smallest moiré reciprocal lattice vector magnitude.\n        G_m = (4.0 * np.pi) / (np.sqrt(3.0) * a_m)\n\n        # Step 2: Calculate electronic properties.\n        # Carrier density.\n        n = nu / A_m\n        \n        # Fermi momentum.\n        k_F = np.sqrt((4.0 * np.pi * n) / GD)\n\n        # Step 3: Calculate the resistivity.\n        # Lorentzian resonance factor.\n        X = 2.0 * k_F\n        lorentzian_arg_sq = ((X - G_m) / (DELTA * G_m))**2\n        lorentzian_factor = 1.0 / (1.0 + lorentzian_arg_sq)\n\n        # Final resistivity formula.\n        numerator = M_STAR * BU * T**2 * lorentzian_factor\n        denominator = n * E**2\n        \n        rho = numerator / denominator\n\n        return rho\n\n    def format_to_3_sig_figs(value):\n        \"\"\"Formats a number to three significant figures using the .3g specifier.\"\"\"\n        if not np.isfinite(value):\n            return str(value)\n        return f\"{value:.3g}\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.10, 3.60, 20.0),  # Case 1\n        (1.10, 2.00, 20.0),  # Case 2\n        (1.20, 3.60, 20.0),  # Case 3\n        (1.05, 3.60, 0.0),   # Case 4\n        (1.10, 0.50, 5.0)    # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        theta, nu, T = case\n        rho = calculate_resistivity(theta, nu, T)\n        results.append(rho)\n\n    # Format the results to three significant figures for final output.\n    formatted_results = [format_to_3_sig_figs(r) for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}