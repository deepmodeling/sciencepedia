{
    "hands_on_practices": [
        {
            "introduction": "理解能谷自由度的拓扑性质，首先要掌握其几何根源——贝里相位。本练习将引导你对一个典型的有能隙狄拉克模型进行基础的解析计算。通过直接应用贝里联络和贝里相位的定义，你将能够亲手推导出在一个闭合路径上的贝里相位，并将其与布洛赫球上矢量$\\mathbf{d}(\\mathbf{k})$扫过的立体角联系起来，从而加深对几何相位的理解。",
            "id": "4311606",
            "problem": "考虑一个二维 (2D) 有隙狄拉克材料在布里渊区 (BZ) 中某个谷点附近的双能带布洛赫哈密顿量，其定义为\n$$\nH_{\\tau}(\\mathbf{k}) \\;=\\; \\mathbf{d}_{\\tau}(\\mathbf{k})\\cdot \\boldsymbol{\\sigma},\n$$\n其中 $\\boldsymbol{\\sigma}$ 是泡利矩阵，谷指数 $\\tau\\in\\{+1,-1\\}$ 标记了两个不等价的谷，并且\n$$\n\\mathbf{d}_{\\tau}(\\mathbf{k}) \\;=\\; \\big(v\\,\\tau\\,k_{x},\\, v\\,k_{y},\\, m\\big),\n$$\n其中 $v>0$ 是一个恒定速度，$m>0$ 是一个与谷无关的质量项。设能带指数为 $n\\in\\{+1,-1\\}$，其中 $n=+1$ 表示导带，$n=-1$ 表示价带。能带 $n$ 的贝里联络定义为\n$$\n\\mathbf{A}_{n}(\\mathbf{k}) \\;=\\; i\\,\\langle u_{n}(\\mathbf{k})|\\nabla_{\\mathbf{k}} u_{n}(\\mathbf{k})\\rangle,\n$$\n其中 $|u_{n}(\\mathbf{k})\\rangle$ 是哈密顿量 $H_{\\tau}(\\mathbf{k})$ 对应于能带 $n$ 的布洛赫本征态的周期部分。\n\n考虑在 $\\mathbf{k}$ 空间中的一条闭合圆形路径 $C$，其参数化形式为\n$$\n\\mathbf{k}(\\varphi) \\;=\\; k_{0}\\,(\\cos\\varphi,\\;\\sin\\varphi),\\qquad \\varphi\\in[0,2\\pi],\n$$\n其中 $k_{0}>0$ 是固定的，路径沿 $\\varphi$ 增大的方向遍历。从上述基本定义出发，计算能带 $n$ 和谷 $\\tau$ 的贝里相位\n$$\n\\gamma_{n}(C) \\;=\\; \\int_{C}\\mathbf{A}_{n}\\cdot d\\mathbf{k}\n$$\n并将你的最终结果用 $m$、$v$、$k_{0}$、$\\tau$ 和 $n$ 表示。然后，将你的明确结果与单位矢量 $\\widehat{\\mathbf{d}}_{\\tau}(\\mathbf{k})=\\mathbf{d}_{\\tau}(\\mathbf{k})/|\\mathbf{d}_{\\tau}(\\mathbf{k})|$ 沿路径 $C$ 在布洛赫球面上所张的立体角联系起来，并用能带指数指出其比例因子和符号。\n\n请用弧度表示你最终的贝里相位。不需要进行数值近似；请提供一个闭式解析表达式。",
            "solution": "用户要求我解决一个关于二维有隙狄拉克材料中贝里相位的问题。\n\n### 第一步：提取已知条件\n- **哈密顿量**：$H_{\\tau}(\\mathbf{k}) = \\mathbf{d}_{\\tau}(\\mathbf{k})\\cdot \\boldsymbol{\\sigma}$，其中 $\\boldsymbol{\\sigma}$ 是泡利矩阵。\n- **谷指数**：$\\tau \\in \\{+1,-1\\}$。\n- **矢量 $\\mathbf{d}_{\\tau}(\\mathbf{k})$**：$\\mathbf{d}_{\\tau}(\\mathbf{k}) = (v\\,\\tau\\,k_{x},\\, v\\,k_{y},\\, m)$，其中 $v>0$ 且 $m>0$。\n- **能带指数**：$n \\in \\{+1,-1\\}$，分别对应导带和价带。\n- **贝里联络**：$\\mathbf{A}_{n}(\\mathbf{k}) = i\\,\\langle u_{n}(\\mathbf{k})|\\nabla_{\\mathbf{k}} u_{n}(\\mathbf{k})\\rangle$，其中 $|u_{n}(\\mathbf{k})\\rangle$ 是能带 $n$ 的本征态。\n- **积分路径**：$\\mathbf{k}$ 空间中的一条闭合圆形路径 $C$，$\\mathbf{k}(\\varphi) = k_{0}\\,(\\cos\\varphi, \\sin\\varphi)$，其中 $\\varphi\\in[0,2\\pi]$ 且 $k_0>0$。\n- **待计算量**：贝里相位 $\\gamma_{n}(C) = \\int_{C}\\mathbf{A}_{n}\\cdot d\\mathbf{k}$。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学上成立**：该问题描述了一个有质量的狄拉克哈密顿量，这是凝聚态物理中用于描述像有隙石墨烯或过渡金属二硫化物等材料的标准基本模型。贝里联络和贝里相位的定义在该领域是标准的。该设置在科学上是合理的。\n2.  **适定的**：问题是适定的。它提供了计算唯一贝里相位所需的所有必要信息（哈密顿量、路径、定义）。\n3.  **客观的**：语言精确、定量，且没有主观因素。\n4.  **完整且一致**：已知条件是自洽的，足以求解。没有矛盾之处。\n5.  **现实的**：该模型和参数虽然理想化，但在物理上是现实且相关的。\n\n### 第三步：结论与行动\n问题有效。我将继续进行求解。\n\n### 求解推导\n\n该哈密顿量是一个形式为 $H = \\mathbf{d}\\cdot\\boldsymbol{\\sigma}$ 的通用两能级系统。能量本征值由 $E_{n}(\\mathbf{k}) = n\\,|\\mathbf{d}_{\\tau}(\\mathbf{k})|$ 给出，其中 $n=+1$ 代表导带，$n=-1$ 代表价带。矢量 $\\mathbf{d}_{\\tau}(\\mathbf{k})$ 的模为\n$$\n|\\mathbf{d}_{\\tau}(\\mathbf{k})| = \\sqrt{(v\\,\\tau\\,k_x)^2 + (v\\,k_y)^2 + m^2} = \\sqrt{v^2(k_x^2 + k_y^2) + m^2} = \\sqrt{v^2 k^2 + m^2}\n$$\n其中 $k=|\\mathbf{k}|$。能量色散关系为 $E_n(k) = n\\sqrt{v^2 k^2 + m^2}$。\n\n本征态 $|u_n(\\mathbf{k})\\rangle$ 可以用单位矢量 $\\widehat{\\mathbf{d}}_{\\tau}(\\mathbf{k}) = \\mathbf{d}_{\\tau}(\\mathbf{k})/|\\mathbf{d}_{\\tau}(\\mathbf{k})|$ 的球坐标角 $(\\theta, \\phi)$ 来表示。\n$\\mathbf{d}_{\\tau}(\\mathbf{k})$ 的分量为 $d_x = v\\tau k_x$，$d_y = v k_y$ 和 $d_z = m$。\n极角 $\\theta$ 由下式给出\n$$\n\\cos\\theta(\\mathbf{k}) = \\frac{d_z}{|\\mathbf{d}_{\\tau}(\\mathbf{k})|} = \\frac{m}{\\sqrt{v^2 k^2 + m^2}}\n$$\n方位角 $\\phi$ 由 $d_x + i d_y = |\\mathbf{d}_{\\tau}|\\sin\\theta e^{i\\phi}$ 确定。我们有\n$$\nd_x + i d_y = v\\tau k_x + i v k_y = v(\\tau k_x + i k_y)\n$$\n此外，$\\sqrt{d_x^2+d_y^2} = \\sqrt{v^2 k_x^2 + v^2 k_y^2} = v k$。\n因此，相位因子为\n$$\ne^{i\\phi(\\mathbf{k})} = \\frac{d_x + i d_y}{\\sqrt{d_x^2+d_y^2}} = \\frac{v(\\tau k_x + i k_y)}{v k} = \\frac{\\tau k_x + i k_y}{k}\n$$\n两个能带 $n=\\pm 1$ 的归一化本征态为\n$$\n|u_{+1}(\\mathbf{k})\\rangle = \\begin{pmatrix} \\cos(\\theta/2) \\\\ e^{i\\phi}\\sin(\\theta/2) \\end{pmatrix}, \\quad |u_{-1}(\\mathbf{k})\\rangle = \\begin{pmatrix} -e^{-i\\phi}\\sin(\\theta/2) \\\\ \\cos(\\theta/2) \\end{pmatrix}\n$$\n对于一个通用的两能级系统本征态（如上由 $\\theta$ 和 $\\phi$ 参数化），其贝里联络可以计算得出。对于上能带 ($n=+1$)：\n$$\n\\mathbf{A}_{+1}(\\mathbf{k}) = i \\langle u_{+1} | \\nabla_{\\mathbf{k}} u_{+1} \\rangle = i \\left(\\cos(\\theta/2) \\quad e^{-i\\phi}\\sin(\\theta/2)\\right) \\nabla_{\\mathbf{k}} \\begin{pmatrix} \\cos(\\theta/2) \\\\ e^{i\\phi}\\sin(\\theta/2) \\end{pmatrix}\n$$\n$$\n\\langle u_{+1} | \\nabla_{\\mathbf{k}} u_{+1} \\rangle = \\cos(\\theta/2) \\left(-\\frac{1}{2}\\sin(\\theta/2)\\nabla_{\\mathbf{k}}\\theta\\right) + e^{-i\\phi}\\sin(\\theta/2) \\left( \\frac{1}{2}e^{i\\phi}\\cos(\\theta/2)\\nabla_{\\mathbf{k}}\\theta + i e^{i\\phi}\\sin(\\theta/2)\\nabla_{\\mathbf{k}}\\phi \\right)\n$$\n$$\n= -\\frac{1}{2}\\sin(\\theta/2)\\cos(\\theta/2)\\nabla_{\\mathbf{k}}\\theta + \\frac{1}{2}\\sin(\\theta/2)\\cos(\\theta/2)\\nabla_{\\mathbf{k}}\\theta + i \\sin^2(\\theta/2)\\nabla_{\\mathbf{k}}\\phi = i\\sin^2(\\theta/2)\\nabla_{\\mathbf{k}}\\phi\n$$\n因此，$\\mathbf{A}_{+1}(\\mathbf{k}) = i (i\\sin^2(\\theta/2)\\nabla_{\\mathbf{k}}\\phi) = -\\sin^2(\\theta/2)\\nabla_{\\mathbf{k}}\\phi$。\n对下能带 ($n=-1$) 进行类似的计算可得 $\\mathbf{A}_{-1}(\\mathbf{k}) = +\\sin^2(\\theta/2)\\nabla_{\\mathbf{k}}\\phi$。\n我们可以写出适用于两个能带的通用表达式：\n$$\n\\mathbf{A}_{n}(\\mathbf{k}) = -n \\sin^2(\\frac{\\theta(\\mathbf{k})}{2})\\nabla_{\\mathbf{k}}\\phi(\\mathbf{k}) = -n \\frac{1-\\cos(\\theta(\\mathbf{k}))}{2}\\nabla_{\\mathbf{k}}\\phi(\\mathbf{k})\n$$\n贝里相位是贝里联络沿路径 $C$ 的线积分：\n$$\n\\gamma_n(C) = \\oint_C \\mathbf{A}_n(\\mathbf{k}) \\cdot d\\mathbf{k} = \\oint_C -n \\frac{1-\\cos(\\theta(\\mathbf{k}))}{2} \\nabla_{\\mathbf{k}}\\phi(\\mathbf{k}) \\cdot d\\mathbf{k}\n$$\n路径 $C$ 是一个半径为 $k_0$ 的圆，因此沿该路径 $k=|\\mathbf{k}|=k_0$ 是常数。因此，$\\cos(\\theta(\\mathbf{k}))$ 在该路径上也是常数：\n$$\n\\cos\\theta_0 = \\frac{m}{\\sqrt{v^2 k_0^2 + m^2}}\n$$\n我们可以将常数因子从积分中提出：\n$$\n\\gamma_n(C) = -n \\frac{1-\\cos\\theta_0}{2} \\oint_C \\nabla_{\\mathbf{k}}\\phi(\\mathbf{k}) \\cdot d\\mathbf{k}\n$$\n积分 $\\oint_C \\nabla_{\\mathbf{k}}\\phi(\\mathbf{k}) \\cdot d\\mathbf{k}$ 是我们遍历闭合回路 $C$ 时角度 $\\phi$ 的总变化量。我们来计算这个变化量。路径参数化为 $\\mathbf{k}(\\varphi) = (k_0\\cos\\varphi, k_0\\sin\\varphi)$，其中 $\\varphi \\in [0,2\\pi]$。沿此路径，角 $\\phi$ 是 $\\varphi$ 的函数：\n$$\ne^{i\\phi(\\varphi)} = \\frac{\\tau (k_0\\cos\\varphi) + i (k_0\\sin\\varphi)}{k_0} = \\tau\\cos\\varphi + i\\sin\\varphi\n$$\n对于 $\\tau=+1$ 的谷：$e^{i\\phi(\\varphi)} = \\cos\\varphi + i\\sin\\varphi = e^{i\\varphi}$。这意味着 $\\phi(\\varphi) = \\varphi$。当 $\\varphi$ 从 $0$ 变到 $2\\pi$ 时，$\\phi$ 也从 $0$ 变到 $2\\pi$。总变化量为 $\\Delta\\phi = 2\\pi$。\n对于 $\\tau=-1$ 的谷：$e^{i\\phi(\\varphi)} = -\\cos\\varphi + i\\sin\\varphi = \\cos(\\pi-\\varphi) + i\\sin(\\pi-\\varphi) = e^{i(\\pi-\\varphi)}$。这意味着 $\\phi(\\varphi) = \\pi-\\varphi$。当 $\\varphi$ 从 $0$ 变到 $2\\pi$ 时，$\\phi$ 从 $\\pi$ 变到 $\\pi-2\\pi = -\\pi$。总变化量为 $\\Delta\\phi = -\\pi - \\pi = -2\\pi$。\n一般地，总变化量为 $\\Delta\\phi = 2\\pi\\tau$。\n将此代入贝里相位的表达式中：\n$$\n\\gamma_n(C) = -n \\frac{1-\\cos\\theta_0}{2} (2\\pi\\tau) = -n\\tau\\pi(1-\\cos\\theta_0)\n$$\n最后，代入 $\\cos\\theta_0$ 的表达式：\n$$\n\\gamma_n(C) = -n\\tau\\pi\\left(1 - \\frac{m}{\\sqrt{v^2 k_0^2 + m^2}}\\right)\n$$\n这就是能带 $n$ 和谷 $\\tau$ 的贝里相位。\n\n问题的第二部分是将其与单位矢量 $\\widehat{\\mathbf{d}}_{\\tau}(\\mathbf{k})$ 沿路径 $C$ 在布洛赫球面上所张的立体角联系起来。当 $\\mathbf{k}$ 遍历圆 $C$ 时，矢量 $\\widehat{\\mathbf{d}}_{\\tau}(\\mathbf{k})$ 在单位球面上描绘出一条路径。由于 $\\theta(\\mathbf{k})=\\theta_0$ 是常数，该路径是一个等纬度圆。方位角 $\\phi$ 变化了 $2\\pi\\tau$。此路径所包围的立体角 $\\Omega(C)$ 由球冠的面积给出，其符号由遍历方向决定。\n回路所张立体角的标准公式是 $\\Omega = \\oint (1-\\cos\\theta)d\\phi$。对于我们的路径，$\\theta=\\theta_0$ 是常数：\n$$\n\\Omega(C) = \\int_C (1-\\cos\\theta_0)d\\phi = (1-\\cos\\theta_0) \\int_C d\\phi = (1-\\cos\\theta_0)(2\\pi\\tau)\n$$\n$$\n\\Omega(C) = 2\\pi\\tau\\left(1 - \\frac{m}{\\sqrt{v^2 k_0^2 + m^2}}\\right)\n$$\n比较贝里相位 $\\gamma_n(C)$ 和立体角 $\\Omega(C)$ 的表达式：\n$$\n\\gamma_n(C) = -n\\tau\\pi(1-\\cos\\theta_0) = -\\frac{n}{2} \\left[ 2\\pi\\tau(1-\\cos\\theta_0) \\right] = -\\frac{n}{2} \\Omega(C)\n$$\n贝里相位与 $\\widehat{\\mathbf{d}}_{\\tau}$ 矢量环在布洛赫球面上所张的立体角成正比。比例因子为 $-n/2$。对于导带 ($n=+1$)，因子为 $-1/2$。对于价带 ($n=-1$)，因子为 $+1/2$。\n最终要求的结果是贝里相位的明确表达式。",
            "answer": "$$\n\\boxed{-n\\tau\\pi\\left(1 - \\frac{m}{\\sqrt{v^2 k_0^2 + m^2}}\\right)}\n$$"
        },
        {
            "introduction": "在掌握了贝里相位的基本计算后，下一步是量化整个能谷的拓扑性质。能谷陈数作为一个拓扑不变量，是判断材料是否具有能谷霍尔效应的关键。本练习将指导你使用一种强大且规范不变的数值方法（Fukui-Hatsugai-Suzuki方法），从一个给定的哈密顿量出发，计算能谷分辨的陈数。这项实践对于研究新材料的研究人员来说是一项至关重要的计算技能。",
            "id": "4311633",
            "problem": "考虑一个二维晶体电子系统，其在两个不等价的谷附近的低能物理由一个通过两个耦合的大质量狄拉克锥构建的四带连续哈密顿量所描述。设动量由向量 $\\mathbf{k}=(k_x,k_y)$ 表示，子格（赝自旋）自由度由泡利矩阵 $\\sigma_x$、$\\sigma_y$、$\\sigma_z$ 表示，谷自由度由泡利矩阵 $\\tau_x$、$\\tau_y$、$\\tau_z$ 表示。定义哈密顿量\n$$\nH(\\mathbf{k}) \\;=\\; v\\,k_x\\,\\sigma_x\\otimes I \\;+\\; v\\,k_y\\,\\sigma_y\\otimes I \\;-\\; v\\,K_0\\,\\sigma_x\\otimes \\tau_z \\;+\\; m\\,\\sigma_z\\otimes I \\;+\\; g\\,I\\otimes \\tau_x,\n$$\n其中 $v>0$ 是能带速度，$m$ 是狄拉克质量，$K_0>0$ 设定了沿 $k_x$ 轴的谷分离，$g\\ge 0$ 是一个使 $K$ 和 $K'$ 杂化的谷间耦合，$I$ 是单位矩阵。当 $g=0$ 时，该模型产生两个中心分别位于 $(k_x,k_y)=(+K_0,0)$ 和 $(k_x,k_y)=(-K_0,0)$ 附近的谷；当 $g>0$ 时，这两个谷会混合。\n\n根据布洛赫能带理论和几何相位形式，与已占据子空间（能量低于谱隙的能带集合）相关的贝里曲率可以在动量空间上定义。对于在矩形网格上的数值评估，存在一种规范不变的格点表述，该表述根据 $\\mathbf{k}$ 空间中相邻格点上已占据本征态的交叠矩阵，计算每个基本格框的离散贝里曲率；将这些离散曲率在一个区域内求和，可近似得到通过该区域的贝里通量。通过使用以各谷为中心的平滑谷投影算子对贝里曲率进行加权，可以构建一个谷分辨的陈数示性数。设谷权重函数为\n$$\nW_{+}(\\mathbf{k}) \\;=\\; \\exp\\!\\left(-\\frac{(k_x - K_0)^2 + k_y^2}{2\\,\\sigma^2}\\right), \\qquad\nW_{-}(\\mathbf{k}) \\;=\\; \\exp\\!\\left(-\\frac{(k_x + K_0)^2 + k_y^2}{2\\,\\sigma^2}\\right),\n$$\n其中 $\\sigma>0$ 设定了动量空间中谷选择的宽度。谷分辨的陈数示性数则定义为\n$$\nC_v^{+} \\;=\\; \\frac{1}{2\\pi}\\sum_{\\text{plaquettes}} F(\\mathbf{k})\\,W_{+}(\\mathbf{k}), \\qquad\nC_v^{-} \\;=\\; \\frac{1}{2\\pi}\\sum_{\\text{plaquettes}} F(\\mathbf{k})\\,W_{-}(\\mathbf{k}),\n$$\n其中 $F(\\mathbf{k})$ 表示在以 $\\mathbf{k}$ 为中心的格框上，与已占据子空间相关的离散贝里曲率。这些示性数用以量化谷分辨的拓扑对于谷间耦合 $g$ 以及由 $\\sigma$ 控制的弥散边界的鲁棒性。\n\n任务：实现一个程序，针对上面定义的哈密顿量 $H(\\mathbf{k})$，在动量空间的均匀矩形网格上，使用已占据子空间的规范不变的格点贝里曲率，数值计算 $(C_v^{+},C_v^{-})$。使用一个覆盖 $k_x\\in[-k_{\\max},k_{\\max}]$ 和 $k_y\\in[-k_{\\max},k_{\\max}]$ 的方形网格，其中 $k_{\\max}=2$，每个轴上有 $N=101$ 个点，形成 $(N-1)\\times(N-1)$ 个格框。对于每个测试用例，程序必须：\n- 使用固定的参数 $v=1$、$m=0.2$、$K_0=1.0$ 和给定的 $(g,\\sigma)$，在网格上构建 $H(\\mathbf{k})$。\n- 通过选择 $H(\\mathbf{k})$ 的两个能量最低的本征向量来确定每个 $\\mathbf{k}$ 点的已占据子空间。\n- 通过相邻格点已占据子空间之间的交叠矩阵，计算格框上的规范不变离散贝里曲率。\n- 通过将离散曲率乘以 $W_{+}$ 和 $W_{-}$ 进行加权求和，再除以 $2\\pi$ 来评估 $C_v^{+}$ 和 $C_v^{-}$。\n- 返回四舍五入到六位小数的结果。\n\n测试套件：\n- 用例 1 (happy path): $g=0.0$, $\\sigma=0.4$。\n- 用例 2 (中等谷间耦合): $g=0.2$, $\\sigma=0.4$。\n- 用例 3 (更强的耦合): $g=0.6$, $\\sigma=0.4$。\n- 用例 4 (弥散的谷边界): $g=0.2$, $\\sigma=0.9$。\n- 用例 5 (尖锐的谷边界): $g=0.2$, $\\sigma=0.2$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含所有五个测试用例的结果，格式为一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n[C_v^{+}\\text{(用例 1)},\\,C_v^{-}\\text{(用例 1)},\\,C_v^{+}\\text{(用例 2)},\\,C_v^{-}\\text{(用例 2)},\\,C_v^{+}\\text{(用例 3)},\\,C_v^{-}\\text{(用例 3)},\\,C_v^{+}\\text{(用例 4)},\\,C_v^{-}\\text{(用例 4)},\\,C_v^{+}\\text{(用例 5)},\\,C_v^{-}\\text{(用例 5)}].\n$$\n所有量均为无量纲，且必须打印为四舍五入到六位小数的结果。",
            "solution": "用户提供的问题是计算凝聚态物理中一个明确定义的任务，要求对一个给定的四带哈密顿量进行谷分辨陈数示性数的数值计算。初步验证证实该问题在科学上是合理的、自洽的，并且在算法上是可行的。\n\n### 1. 问题验证\n\n**第1步：提取的已知条件**\n- **哈密顿量：** $H(\\mathbf{k}) = v\\,k_x\\,\\sigma_x\\otimes I + v\\,k_y\\,\\sigma_y\\otimes I - v\\,K_0\\,\\sigma_x\\otimes \\tau_z + m\\,\\sigma_z\\otimes I + g\\,I\\otimes \\tau_x$。\n- **符号：** $\\mathbf{k}=(k_x, k_y)$ (动量)，$\\sigma_{x,y,z}$ (子格泡利矩阵)，$\\tau_{x,y,z}$ (谷泡利矩阵)，$I$ (单位矩阵)。\n- **参数：** $v$ (速度)，$m$ (质量)，$K_0$ (谷分离)，$g$ (谷间耦合)。\n- **谷权重函数：** $W_{\\pm}(\\mathbf{k}) = \\exp(-\\frac{(k_x \\mp K_0)^2 + k_y^2}{2\\,\\sigma^2})$，宽度为 $\\sigma > 0$。\n- **谷分辨的陈数示性数：** $C_v^{\\pm} = \\frac{1}{2\\pi}\\sum_{\\text{plaquettes}} F(\\mathbf{k})\\,W_{\\pm}(\\mathbf{k})$，其中 $F(\\mathbf{k})$ 是已占据子空间的离散贝里曲率。\n- **数值网格：** 针对 $k_x, k_y \\in [-k_{\\max}, k_{\\max}]$ 的方形网格，其中 $k_{\\max}=2$，每轴 $N=101$ 个点。\n- **已占据子空间：** 每个格点上 $H(\\mathbf{k})$ 的两个能量最低的本征向量。\n- **固定参数：** $v=1$，$m=0.2$，$K_0=1.0$。\n- **测试用例 $(g, \\sigma)$：**\n    1. $(0.0, 0.4)$\n    2. $(0.2, 0.4)$\n    3. $(0.6, 0.4)$\n    4. $(0.2, 0.9)$\n    5. $(0.2, 0.2)$\n\n**第2步：已知条件的验证**\n该问题具有坚实的科学基础，植根于物质拓扑相理论，特别是二维材料中的谷霍尔效应。所给出的哈密顿量是耦合大质量狄拉克费米子的标准模型，用于描述诸如有隙石墨烯或过渡金属二硫化物等系统。指定的计算贝里曲率的数值方法——一种规范不变的格点表述——是由 Fukui、Hatsugai 和 Suzuki 开发的一种成熟且鲁棒的技术。谷分辨陈数示性数的定义是精确且具有物理意义的。所有参数和数值规格都已提供，使得问题定义明确，没有歧义或矛盾。未检测到科学缺陷、不可行性或其他异常情况。\n\n**第3步：结论**\n该问题被判定为**有效**。将着手开发解决方案。\n\n### 2. 理论框架与解决方案设计\n\n解决方案需要计算谷分辨的陈数示性数，这些示性数量化了与动量空间中特定谷相关的拓扑荷。这将通过为指定的哈密顿量实现规范不变的格点贝里曲率表述来完成。\n\n**2.1. 哈密顿量**\n所提供的哈密顿量 $H(\\mathbf{k})$ 是一个 $4 \\times 4$ 矩阵，描述了两个耦合的大质量狄拉克锥。\n- 与 $v$ 和 $m$ 成比例的项构成了狄拉克哈密顿量的基本部分。\n- 项 $-vK_0\\sigma_x \\otimes \\tau_z$ 将两个狄拉克锥的中心在动量空间中移动到 $k_x = \\pm K_0$，从而创建了两个不同的谷。\n- 项 $g I \\otimes \\tau_x$ 耦合了这两个谷。当 $g=0$ 时，哈密顿量是块对角的，描述了两个独立的谷。当 $g>0$ 时，谷是杂化的。\n- 问题将“已占据子空间”定义为由能量最低的两个本征向量张成的空间。对于网格上的每个点 $\\mathbf{k}$，我们必须对角化 $H(\\mathbf{k})$ 并选择这两个本征向量。\n\n**2.2. 数值贝里曲率（Fukui-Hatsugai-Suzuki 方法）**\n已占据子空间的贝里曲率可以在离散的动量空间网格上进行数值计算，而无需固定规范。\n1.  **网格与本征态：** 在 $\\mathbf{k}$ 空间中定义一个 $N \\times N$ 个点的均匀网格。在每个点 $\\mathbf{k}_{i,j}$，我们找到 $M=2$ 个已占据态的本征向量，它们构成一个 $4 \\times 2$ 的基向量矩阵 $U_{i,j}$。\n2.  **连接变量：** 对于任意两个相邻的格点 $\\mathbf{k}$ 和 $\\mathbf{k}'$，我们计算已占据子空间的交叠矩阵：$M(\\mathbf{k}, \\mathbf{k}') = U(\\mathbf{k})^\\dagger U(\\mathbf{k}')$。这个 $M \\times M$ 矩阵的行列式捕捉了子空间的演化。从这个行列式定义一个 $U(1)$ 连接变量：\n    $$\n    L(\\mathbf{k}, \\mathbf{k}') = \\frac{\\det(M(\\mathbf{k}, \\mathbf{k}'))}{|\\det(M(\\mathbf{k}, \\mathbf{k}'))|}\n    $$\n3.  **格框通量：** 网格上的一个基本格框由四个顶点定义：$\\mathbf{k}_{i,j}$、$\\mathbf{k}_{i+1,j}$、$\\mathbf{k}_{i,j+1}$ 和 $\\mathbf{k}_{i+1,j+1}$。离散贝里曲率 $F(\\mathbf{k}_{i,j})$（或通过格框的贝里通量）是沿格框边界的连接变量乘积的辐角：\n    $$\n    F(\\mathbf{k}_{i,j}) = \\operatorname{Im} \\ln \\left( L_{i,j \\to i+1,j} \\cdot L_{i+1,j \\to i+1,j+1} \\cdot L_{i+1,j+1 \\to i,j+1} \\cdot L_{i,j+1 \\to i,j} \\right)\n    $$\n    其中 $L_{\\mathbf{k}' \\to \\mathbf{k}} = L(\\mathbf{k}, \\mathbf{k}')^*$。这可以简化为：\n    $$\n    F_{i,j} = \\operatorname{angle}\\left( L_{x}(i,j) \\cdot L_{y}(i+1,j) \\cdot L_{x}(i,j+1)^* \\cdot L_{y}(i,j)^* \\right)\n    $$\n    其中 $L_x(i,j)$ 是从 $(i,j)$到 $(i+1,j)$ 的连接，而 $L_y(i,j)$ 是从 $(i,j)$到 $(i,j+1)$ 的连接。\n\n**2.3. 谷分辨的陈数示性数**\n示性数 $C_v^{\\pm}$ 是通过对格框通量 $F_{i,j}$ 求和来计算的，并由在每个格框中心评估的相应谷投影函数 $W_{\\pm}(\\mathbf{k})$ 加权。\n$$\nC_v^{\\pm} = \\frac{1}{2\\pi} \\sum_{i=0}^{N-2} \\sum_{j=0}^{N-2} F_{i,j} \\, W_{\\pm}(\\mathbf{k}_{i,j}^{\\text{center}})\n$$\n格框 $(i,j)$ 的中心是 $\\mathbf{k}_{i,j}^{\\text{center}} = (\\frac{k_{x,i}+k_{x,i+1}}{2}, \\frac{k_{y,j}+k_{y,j+1}}{2})$。\n\n**2.4. 算法实现**\n数值实现将按以下步骤进行：\n1.  定义所有物理和数值常数（$v, m, K_0, k_{\\max}, N$）。定义泡利矩阵。\n2.  对于每个测试用例 $(g, \\sigma)$：\n    a.  创建 $N \\times N$ 的动量网格 $(k_x, k_y)$。\n    b.  为每个网格点构建 $4 \\times 4$ 的哈密顿量矩阵。在整个网格上进行矢量化操作是高效的。\n    c.  使用 `numpy.linalg.eigh` 对所有哈密顿量进行对角化。存储每个网格点上对应于两个最低本征值的两个本征向量。这将得到一个 $(N, N, 4, 2)$ 的数组 `occupied_states`。\n    d.  以矢量化方式计算所有连接变量。通过计算 `occupied_states[i,j]` 和 `occupied_states[i+1,j]` 之间的交叠来计算 $x$ 方向的连接 $L_x$。类似地计算 $y$ 方向的连接 $L_y$。\n    e.  使用适当的切片组合连接变量，以同时计算所有 $(N-1) \\times (N-1)$ 个格框的乘积。\n    f.  使用 `numpy.angle` 计算贝里曲率数组 $F$。\n    g.  在格框中心网格上构建权重函数数组 $W_+$ 和 $W_-$。\n    h.  通过计算展平的 $F$ 和 $W_{\\pm}$ 数组的点积，然后除以 $2\\pi$ 来计算 $C_v^{\\pm}$。\n    i.  将结果四舍五入到六位小数并存储。\n3.  将所有测试用例收集到的结果格式化为最终指定的输出字符串。\n\n此设计利用 NumPy 的矢量化能力来实现一个高效且简洁的实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes valley-resolved Chern indicators for a 4-band coupled Dirac Hamiltonian.\n    \"\"\"\n    # Fixed physical and numerical parameters\n    v = 1.0\n    m = 0.2\n    K0 = 1.0\n    k_max = 2.0\n    N = 101\n    \n    # Test cases from the problem statement: (g, sigma)\n    test_cases = [\n        (0.0, 0.4),  # Case 1\n        (0.2, 0.4),  # Case 2\n        (0.6, 0.4),  # Case 3\n        (0.2, 0.9),  # Case 4\n        (0.2, 0.2),  # Case 5\n    ]\n\n    # Pre-define Pauli matrices and identity\n    I2 = np.array([[1, 0], [0, 1]], dtype=complex)\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=complex)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=complex)\n\n    # Construct 4x4 matrix representations using Kronecker products\n    ham_k_x_term = v * np.kron(sigma_x, I2)\n    ham_k_y_term = v * np.kron(sigma_y, I2)\n    ham_valley_sep_term = -v * K0 * np.kron(sigma_x, sigma_z)\n    ham_mass_term = m * np.kron(sigma_z, I2)\n\n    # Momentum grid setup\n    k_vals = np.linspace(-k_max, k_max, N)\n    kx_grid, ky_grid = np.meshgrid(k_vals, k_vals, indexing='ij')\n\n    results = []\n\n    for g, sigma in test_cases:\n        # Construct the g-dependent term\n        ham_g_term = g * np.kron(I2, sigma_x)\n\n        # Construct the Hamiltonian H(k) for all k-points on the grid\n        # The axes are (kx_idx, ky_idx, matrix_row, matrix_col)\n        H = (kx_grid[:, :, np.newaxis, np.newaxis] * ham_k_x_term +\n             ky_grid[:, :, np.newaxis, np.newaxis] * ham_k_y_term +\n             ham_valley_sep_term + ham_mass_term + ham_g_term)\n\n        # Diagonalize the Hamiltonian at each k-point\n        # np.linalg.eigh is efficient for arrays of matrices\n        # The eigenvalues are sorted, so we take the first two eigenvectors\n        # for the occupied subspace (lowest two energies).\n        # evecs shape will be (N, N, 4, 4). We want (N, N, 4, 2).\n        _, evecs = np.linalg.eigh(H)\n        occupied_states = evecs[:, :, :, :2]\n\n        # Calculate link variables (vectorized)\n        \n        # X-direction links\n        states_x_base = occupied_states[:-1, :, :, :]\n        states_x_shifted = occupied_states[1:, :, :, :]\n        # Overlap matrix M_x(i, j) = U(i, j)^dagger U(i+1, j)\n        M_x = np.einsum('ijkm,ijkn->ijmn', states_x_base.conj(), states_x_shifted)\n        det_M_x = np.linalg.det(M_x)\n        link_U_x = det_M_x / np.abs(det_M_x) # Shape: (N-1, N)\n\n        # Y-direction links\n        states_y_base = occupied_states[:, :-1, :, :]\n        states_y_shifted = occupied_states[:, 1:, :, :]\n        # Overlap matrix M_y(i, j) = U(i, j)^dagger U(i, j+1)\n        M_y = np.einsum('ijkm,ijkn->ijmn', states_y_base.conj(), states_y_shifted)\n        det_M_y = np.linalg.det(M_y)\n        link_U_y = det_M_y / np.abs(det_M_y) # Shape: (N, N-1)\n\n        # Calculate plaquette Berry curvature\n        # The plaquette (i,j) uses links starting at (i,j), (i+1,j), (i,j+1)\n        U_x_ij = link_U_x[:, :-1]        # link from (i,j) to (i+1,j)\n        U_y_i1j = link_U_y[1:, :]         # link from (i+1,j) to (i+1,j+1)\n        U_x_ij1 = link_U_x[:, 1:]         # link from (i,j+1) to (i+1,j+1)\n        U_y_ij = link_U_y[:-1, :]         # link from (i,j) to (i,j+1)\n\n        plaquette_product = U_x_ij * U_y_i1j * U_x_ij1.conj() * U_y_ij.conj()\n        berry_curvature_grid = np.angle(plaquette_product) # Shape: (N-1, N-1)\n\n        # Calculate valley-resolved Chern indicators\n        dk = 2 * k_max / (N - 1)\n        plaquette_centers_k = k_vals[:-1] + dk / 2\n        kxc, kyc = np.meshgrid(plaquette_centers_k, plaquette_centers_k, indexing='ij')\n\n        # Valley weight functions\n        W_plus = np.exp(-((kxc - K0)**2 + kyc**2) / (2 * sigma**2))\n        W_minus = np.exp(-((kxc + K0)**2 + kyc**2) / (2 * sigma**2))\n\n        # Weighted sum of Berry curvatures\n        Cv_plus = np.sum(berry_curvature_grid * W_plus) / (2 * np.pi)\n        Cv_minus = np.sum(berry_curvature_grid * W_minus) / (2 * np.pi)\n\n        results.append(round(Cv_plus, 6))\n        results.append(round(Cv_minus, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "能谷霍尔效应的一个核心物理体现，是在拓扑不变量发生改变的畴壁上存在受拓扑保护的导电通道。本练习旨在将体拓扑性质与实际的物理现象联系起来。通过对这些一维畴壁模式的有效哈密顿量进行分析，你将模拟它们的输运特性，并亲自验证它们对特定类型无序的鲁棒性，同时量化由其他类型无序引起的背散射。这是理解拓扑物态的一个中心主题。",
            "id": "4311651",
            "problem": "考虑一个二维（2D）有能隙的狄拉克材料，它具有两个由 $\\tau \\in \\{+1,-1\\}$ 索引的不等价谷，并且在 $y=0$ 处存在一个沿 $x$ 方向的畴壁，质量隙在该畴壁两侧变号。设未受扰动的单粒子连续哈密顿量为\n$$\n\\hat{H}_{\\text{2D}} = v\\,(\\tau\\,\\sigma_x\\,\\hat{p}_x + \\sigma_y\\,\\hat{p}_y) + \\Delta(y)\\,\\sigma_z,\n$$\n其中 $v$ 是一个特征速度，$\\sigma_i$ 是子晶格空间中的泡利矩阵，$\\hat{p}_i$ 是动量算符，$\\Delta(y)$ 是一个能隙函数，满足 $\\Delta(y\\to +\\infty)>0$ 和 $\\Delta(y\\to -\\infty)<0$。从第一性原理可知，$\\Delta(y)$ 的这种符号变化会产生束缚在 $y=0$ 附近的一维（1D）畴壁模式，这些模式沿 $x$ 方向色散并且是谷极化的。将动力学投影到一维畴壁模式上，得到一个有效谷分辨哈密顿量，形式为\n$$\n\\hat{H}_0 = \\sum_{\\tau=\\pm 1}\\int dx\\,\\hat{\\psi}_{\\tau}^{\\dagger}(x)\\left(-i\\,\\tau\\,\\hbar v\\,\\partial_x\\right)\\hat{\\psi}_{\\tau}(x),\n$$\n其中 $\\hat{\\psi}_{\\tau}(x)$ 湮灭位置 $x$ 处谷指数为 $\\tau$ 的畴壁模式，$\\hbar$ 是约化普朗克常数，右行（$\\tau=+1$）和左行（$\\tau=-1$）模式沿畴壁反向传播。这个设置实现了谷霍尔效应畴壁通道。\n\n您将分析这些畴壁模式对无序势的鲁棒性并量化背散射。考虑两类微扰：\n\n1. 谷守恒的标量无序：一个势 $V(x)$，它不混合各个谷，并以下列形式进入哈密顿量\n$$\n\\hat{H}_{\\text{vp}} = \\sum_{\\tau=\\pm 1}\\int dx\\,\\hat{\\psi}_{\\tau}^{\\dagger}(x)\\,V(x)\\,\\hat{\\psi}_{\\tau}(x).\n$$\n\n2. 谷间混合微扰：一个势 $U(x)$，它混合了各个谷，并以下列形式进入哈密顿量\n$$\n\\hat{H}_{\\text{iv}} = \\int dx\\,U(x)\\,\\left[\\hat{\\psi}_{+}^{\\dagger}(x)\\,\\hat{\\psi}_{-}(x) + \\hat{\\psi}_{-}^{\\dagger}(x)\\,\\hat{\\psi}_{+}(x)\\right].\n$$\n\n仅从上述有效哈密顿量、散射态的定义和标准的一阶散射理论出发，执行以下操作：\n\n- 对于谷守恒的标量无序 $V(x)$，使用 $\\hat{H}_0 + \\hat{H}_{\\text{vp}}$ 的运动方程来确定在任何能量 $E>0$ 下，畴壁模式是否可能发生背散射。请基于传播解的结构提供一个清晰的论证。\n\n- 对于谷间混合 $U(x)$，使用能量为 $E$ 的反向传播模式之间的一维散射的领头阶玻恩近似，推导反射概率 $R(E)$ 关于 $U(x)$、$\\hbar$ 和 $v$ 的定量表达式。解释背散射对 $U(x)$ 的空间傅里叶分量和能量 $E$ 的依赖性。\n\n然后，为以下一系列物理上一致的参数集，实现一个算法来数值或解析地计算 $R(E)$。使用 $\\hbar v = 0.658\\,\\text{eV}\\cdot\\text{nm}$（适用于类石墨烯的畴壁模式），所有距离以 $\\text{nm}$ 表示，能量以 $\\text{eV}$ 表示，势强度以适当的导出单位表示，从而使反射概率 $R(E)$ 为无量纲。入射模式的能量 $E$ 通过 $k(E) = E/(\\hbar v)$ 设定一个波数 $k(E)$。\n\n测试套件：\n\n- 情况1（谷守恒，平滑）：$E = 0.1\\,\\text{eV}$，$V(x) = V_0\\,\\exp\\big(-x^2/(2\\sigma^2)\\big)$，其中 $V_0 = 0.05\\,\\text{eV}$ 且 $\\sigma = 10\\,\\text{nm}$。不存在谷间混合。输出反射概率 $R$ 为一个浮点数。\n\n- 情况2（谷间，单个短程）：$E = 0.1\\,\\text{eV}$，$U(x) = u_0\\,\\delta(x-x_0)$，其中 $u_0 = 0.02\\,\\text{eV}\\cdot\\text{nm}$ 且 $x_0 = 0\\,\\text{nm}$。输出 $R$ 为一个浮点数。\n\n- 情况3（谷间，两个短程，相长干涉）：$E = 0.1\\,\\text{eV}$，$U(x) = u_1\\,\\delta(x-x_1) + u_2\\,\\delta(x-x_2)$，其中 $u_1 = u_2 = 0.02\\,\\text{eV}\\cdot\\text{nm}$，$x_1 = 0\\,\\text{nm}$，且 $x_2 = \\pi/k(E)\\,\\text{nm}$，这会在背散射振幅中产生相长干涉。输出 $R$ 为一个浮点数。\n\n- 情况4（谷间，两个短程，相消干涉）：$E = 0.1\\,\\text{eV}$，$U(x) = u_1\\,\\delta(x-x_1) + u_2\\,\\delta(x-x_2)$，其中 $u_1 = u_2 = 0.02\\,\\text{eV}\\cdot\\text{nm}$，$x_1 = 0\\,\\text{nm}$，且 $x_2 = \\pi/(2k(E))\\,\\text{nm}$，这会在背散射振幅中产生相消干涉。输出 $R$ 为一个浮点数。\n\n- 情况5（谷间，较高能量下的平滑混合）：$E = 0.2\\,\\text{eV}$，$U(x) = U_0\\,\\exp\\big(-x^2/(2\\sigma^2)\\big)$，其中 $U_0 = 0.01\\,\\text{eV}$ 且 $\\sigma = 5\\,\\text{nm}$。输出 $R$ 为一个浮点数。\n\n- 情况6（谷间，较低能量下的平滑混合）：$E = 0.01\\,\\text{eV}$，$U(x) = U_0\\,\\exp\\big(-x^2/(2\\sigma^2)\\big)$，其中 $U_0 = 0.01\\,\\text{eV}$ 且 $\\sigma = 5\\,\\text{nm}$。输出 $R$ 为一个浮点数。\n\n您的程序应计算上述情况的反射概率，并生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，\"[result1,result2,...]\"）。每个结果必须是四舍五入到六位小数的浮点数。不应打印任何其他文本。输出是无量纲的，不需要单位说明。",
            "solution": "出发点是一个具有畴壁能隙的二维（2D）有质量狄拉克哈密顿量。当 $\\Delta(y)$ 在 $y=0$ 两侧变号时，Jackiw–Rebbi机制会产生局域在 $y=0$ 附近的束缚态，这些束缚态沿 $x$ 方向传播。在具有两个标记为 $\\tau=\\pm 1$ 的谷的材料中，到一维（1D）畴壁流形上的低能投影会产生每个谷一个的反向传播模式。一个描述这些畴壁模式的紧凑有效哈密顿量是\n$$\n\\hat{H}_0 = \\sum_{\\tau=\\pm 1}\\int dx\\,\\hat{\\psi}_{\\tau}^{\\dagger}(x)\\left(-i\\,\\tau\\,\\hbar v\\,\\partial_x\\right)\\hat{\\psi}_{\\tau}(x),\n$$\n它描述了 $\\tau=+1$ 的右行模式和 $\\tau=-1$ 的左行模式。色散是线性的，$E_{\\tau}(k) = \\tau\\,\\hbar v k$，因此能量为 $E>0$ 的 $\\tau=+1$ 通道中的激发具有波数 $k = E/(\\hbar v)$ 并向右传播，而相同能量的 $\\tau=-1$ 通道具有波数 $-k$ 并向左传播。\n\n现在我们考虑无序。一个谷守恒的标量势 $V(x)$ 增加了\n$$\n\\hat{H}_{\\text{vp}} = \\sum_{\\tau=\\pm 1}\\int dx\\,\\hat{\\psi}_{\\tau}^{\\dagger}(x)\\,V(x)\\,\\hat{\\psi}_{\\tau}(x),\n$$\n它在谷指数上作用相同且对角。例如，对于 $\\tau=+1$ 模式的单通道运动方程是\n$$\n\\left(-i\\,\\hbar v\\,\\partial_x + V(x)\\right)\\psi_{+}(x) = E\\,\\psi_{+}(x).\n$$\n这是一个一阶微分方程，其对于给定能量 $E$ 的通解是\n$$\n\\psi_{+}(x) = A\\,\\exp\\left\\{\\frac{i}{\\hbar v}\\int^{x}dx'\\,\\left(E - V(x')\\right)\\right\\},\n$$\n其中 $A$ 是某个常数振幅。在一个谷内只有一个右行解分支，势 $V(x)$ 仅修改局域相位累积，而不与左行态（属于另一个谷）耦合。因此，在同一个谷内没有可用的反向传播态可以散射进去，反射振幅恒为零。用更形式化的散射术语来说，单谷子空间中缺少左行通道意味着对于 $\\hat{H}_0 + \\hat{H}_{\\text{vp}}$，$S$矩阵的反射元为零，只要谷不混合，无论 $V(x)$ 的平滑度如何，透射率都保持为1。因此，\n$$\nR_{\\text{vp}}(E) = 0,\n$$\n这证明了畴壁模式对谷守恒无序的鲁棒性。\n\n背散射需要谷间混合。引入\n$$\n\\hat{H}_{\\text{iv}} = \\int dx\\,U(x)\\,\\left[\\hat{\\psi}_{+}^{\\dagger}(x)\\,\\hat{\\psi}_{-}(x) + \\hat{\\psi}_{-}^{\\dagger}(x)\\,\\hat{\\psi}_{+}(x)\\right],\n$$\n它允许在右行和左行通道之间发生散射。考虑一个能量为 $E$、波数为 $k = E/(\\hbar v)$ 的入射右行态，由平面波 $\\phi_{+}(x) = e^{ikx}$ 表示。相同能量的出射左行态是 $\\phi_{-}(x) = e^{-ikx}$。在微扰理论的领头阶（玻恩近似）中，从 $\\phi_{+}$ 到 $\\phi_{-}$ 的散射振幅与这些态之间 $U(x)$ 的矩阵元成正比：\n$$\nr(E) \\propto \\int dx\\,\\phi_{-}^{\\ast}(x)\\,U(x)\\,\\phi_{+}(x) = \\int dx\\,U(x)\\,e^{i(2k)x}.\n$$\n恢复手性一维狄拉克模式的正确归一化后，比例因子涉及群速度 $v$ 和 $\\hbar$，因此领头阶的无量纲反射振幅为\n$$\nr(E) = \\frac{1}{\\hbar v}\\int dx\\,U(x)\\,e^{i\\,2k\\,x}.\n$$\n反射概率是模的平方，\n$$\nR(E) = \\left|r(E)\\right|^2 = \\frac{1}{(\\hbar v)^2}\\left|\\int dx\\,U(x)\\,e^{i\\,2k\\,x}\\right|^2.\n$$\n这个结果表明，背散射由谷间混合势在波数 $2k$ 处的空间傅里叶分量决定，较高的能量（较大的 $k$）会通过其被抑制的高频傅里叶分量过滤掉平滑的 $U(x)$。由此得出几个有用的特例。\n\n1. 位于 $x_0$ 处、强度为 $u_0$ 的Delta函数杂质：\n$$\nU(x) = u_0\\,\\delta(x - x_0) \\quad \\Rightarrow \\quad r(E) = \\frac{u_0}{\\hbar v}\\,e^{i\\,2k x_0}, \\quad R(E) = \\left(\\frac{u_0}{\\hbar v}\\right)^2.\n$$\n注意，相位 $e^{i2kx_0}$ 在概率中被消除了。\n\n2. 位于位置 $\\{x_j\\}$、强度为 $\\{u_j\\}$ 的多个Delta杂质：\n$$\nU(x) = \\sum_j u_j\\,\\delta(x-x_j) \\quad \\Rightarrow \\quad r(E) = \\frac{1}{\\hbar v}\\sum_j u_j\\,e^{i\\,2k x_j}, \\quad R(E) = \\frac{1}{(\\hbar v)^2}\\left|\\sum_j u_j\\,e^{i\\,2k x_j}\\right|^2.\n$$\n散射体之间的干涉可以是相长的或相消的，这取决于相位 $2k x_j$。\n\n3. 宽度为 $\\sigma$ 的高斯型谷间混合：\n$$\nU(x) = U_0\\,\\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right) \\quad \\Rightarrow \\quad \\int dx\\,U(x)\\,e^{i\\,2k x} = U_0\\,\\sqrt{2\\pi}\\,\\sigma\\,e^{-2k^2\\sigma^2},\n$$\n因此\n$$\nr(E) = \\frac{U_0\\,\\sqrt{2\\pi}\\,\\sigma}{\\hbar v}\\,e^{-2k^2\\sigma^2}, \\quad R(E) = \\left(\\frac{U_0\\,\\sqrt{2\\pi}\\,\\sigma}{\\hbar v}\\right)^2 e^{-4k^2\\sigma^2}.\n$$\n这明确地量化了在较高能量下对平滑谷间混合的背散射抑制。\n\n程序的算法设计：\n\n- 使用 $\\hbar v = 0.658\\,\\text{eV}\\cdot\\text{nm}$。\n- 对于每个能量为 $E$ 的测试用例，计算 $k = E/(\\hbar v)$。\n- 情况1：由于无序是谷守恒的，设 $R=0$。\n- 情况2：使用单个delta函数公式 $R = (u_0/(\\hbar v))^2$。\n- 情况3和情况4：对复振幅 $u_j e^{i2kx_j}$求和，取其模的平方，然后除以 $(\\hbar v)^2$。\n- 情况5和情况6：使用高斯闭合形式 $R = \\left(\\frac{U_0\\sqrt{2\\pi}\\sigma}{\\hbar v}\\right)^2 e^{-4k^2\\sigma^2}$。\n- 将每个 $R$ 四舍五入到六位小数，并按要求格式打印列表。\n\n测试套件包括：\n- 一个具有谷守恒平滑无序的鲁棒性理想情况（情况1）。\n- 基准的谷间短程散射（情况2）。\n- 多个短程散射体之间的干涉效应：相长（情况3）和相消（情况4）。\n- 平滑谷间混合的能量依赖性：较高能量下的抑制（情况5）和接近零能量时的增强（情况6）。\n\n所有输出都是无量纲的浮点数，汇总为单个列表字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef reflection_probability_valley_preserving():\n    # Valley-preserving scalar disorder does not induce backscattering in a single chiral valley channel.\n    return 0.0\n\ndef reflection_probability_intervalley_deltas(E, hv, u_list, x_list):\n    \"\"\"\n    Compute R for intervalley mixing modeled as sum of delta-function impurities.\n    r(E) = (1/(hv)) * sum_j u_j * exp(i * 2k * x_j)\n    R(E) = |r(E)|^2\n    \"\"\"\n    k = E / hv\n    amplitudes = np.array(u_list, dtype=np.float64) * np.exp(1j * 2.0 * k * np.array(x_list, dtype=np.float64))\n    r = np.sum(amplitudes) / hv\n    R = np.abs(r)**2\n    return float(R)\n\ndef reflection_probability_intervalley_gaussian(E, hv, U0, sigma):\n    \"\"\"\n    Gaussian intervalley mixing: U(x) = U0 * exp(-x^2/(2 sigma^2))\n    Integral: U0 * sqrt(2*pi) * sigma * exp(-2 k^2 sigma^2)\n    r(E) = [U0 * sqrt(2*pi) * sigma * exp(-2 k^2 sigma^2)] / hv\n    R(E) = |r(E)|^2\n    \"\"\"\n    k = E / hv\n    integral = U0 * np.sqrt(2.0 * np.pi) * sigma * np.exp(-2.0 * (k**2) * (sigma**2))\n    r = integral / hv\n    R = (r**2)  # r is real for Gaussian centered at zero\n    return float(R)\n\ndef solve():\n    # Constants\n    hv = 0.658  # hbar * v in eV*nm\n\n    results = []\n\n    # Case 1: Valley-preserving smooth disorder\n    # E = 0.1 eV, V0 = 0.05 eV, sigma = 10 nm (irrelevant for R since valley-preserving)\n    R1 = reflection_probability_valley_preserving()\n    results.append(round(R1, 6))\n\n    # Case 2: Intervalley single delta\n    # E = 0.1 eV, u0 = 0.02 eV*nm, x0 = 0 nm\n    E2 = 0.1\n    u_list_2 = [0.02]\n    x_list_2 = [0.0]\n    R2 = reflection_probability_intervalley_deltas(E2, hv, u_list_2, x_list_2)\n    results.append(round(R2, 6))\n\n    # Case 3: Intervalley two deltas, constructive interference\n    # E = 0.1 eV, u1=u2=0.02 eV*nm, x1=0, x2=pi/k(E)\n    E3 = 0.1\n    k3 = E3 / hv\n    x2_constructive = np.pi / k3\n    u_list_3 = [0.02, 0.02]\n    x_list_3 = [0.0, float(x2_constructive)]\n    R3 = reflection_probability_intervalley_deltas(E3, hv, u_list_3, x_list_3)\n    results.append(round(R3, 6))\n\n    # Case 4: Intervalley two deltas, destructive interference\n    # E = 0.1 eV, u1=u2=0.02 eV*nm, x1=0, x2=pi/(2k(E))\n    E4 = 0.1\n    k4 = E4 / hv\n    x2_destructive = np.pi / (2.0 * k4)\n    u_list_4 = [0.02, 0.02]\n    x_list_4 = [0.0, float(x2_destructive)]\n    R4 = reflection_probability_intervalley_deltas(E4, hv, u_list_4, x_list_4)\n    results.append(round(R4, 6))\n\n    # Case 5: Intervalley smooth mixing at higher energy\n    # E = 0.2 eV, U0 = 0.01 eV, sigma = 5 nm\n    E5 = 0.2\n    U0_5 = 0.01\n    sigma_5 = 5.0\n    R5 = reflection_probability_intervalley_gaussian(E5, hv, U0_5, sigma_5)\n    results.append(round(R5, 6))\n\n    # Case 6: Intervalley smooth mixing at lower energy\n    # E = 0.01 eV, U0 = 0.01 eV, sigma = 5 nm\n    E6 = 0.01\n    U0_6 = 0.01\n    sigma_6 = 5.0\n    R6 = reflection_probability_intervalley_gaussian(E6, hv, U0_6, sigma_6)\n    results.append(round(R6, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}