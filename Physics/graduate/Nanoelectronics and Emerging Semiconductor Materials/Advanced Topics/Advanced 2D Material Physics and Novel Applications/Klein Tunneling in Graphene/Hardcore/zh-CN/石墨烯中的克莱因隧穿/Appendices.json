{
    "hands_on_practices": [
        {
            "introduction": "理解克莱因隧穿的第一步，是从其最简单的形式——单个静电势垒——开始。这项实践将引导你应用狄拉克哈密顿量和边界条件，推导出石墨烯中电子穿越势垒的透射和反射振幅。通过这个核心计算 ，你将亲手揭示赝自旋守恒如何导致在正常入射下完美透射这一非凡现象。",
            "id": "4284228",
            "problem": "单层石墨烯片的低能行为由无质量的狄拉克哈密顿量 $H = v_{F} \\left( \\sigma_{x} p_{x} + \\sigma_{y} p_{y} \\right) + V(x)$ 建模，其中 $v_{F}$ 是费米速度，$\\sigma_{x}$ 和 $\\sigma_{y}$ 是作用在子晶格赝自旋上的泡利矩阵，$p_{x}$ 和 $p_{y}$ 是动量算符。考虑一个急剧的静电阶跃势，$V(x) = 0$（区域I，$x0$）和 $V(x) = V_{0}$（区域II，$x>0$），其中 $V_{0} > 0$。一个能量为 $E>0$ 的类电子平面波从区域I入射到位于 $x=0$ 的界面上，入射角 $\\theta$ 是相对于界面法线测量的。\n\n假设为单谷，无谷间散射，并忽略任何质量项。专注于 $E  V_{0}$ 的情况，此时区域II为p型（类空穴）。令区域I中的 $k = E/(\\hbar v_{F})$，区域II中的 $q = |E - V_{0}|/(\\hbar v_{F})$。将区域II中的透射态记为具有守恒横向动量的平面波，因此有 $k \\sin \\theta = q \\sin \\theta_{2}$，其中 $\\theta_{2}$ 是透射态的动量角。约定透射群速度指向$+x$方向，对于空穴分支，这意味着 $\\cos \\theta_{2} \\le 0$。使用双分量旋量，并要求旋量在 $x=0$ 处连续。\n\n仅使用这些要素，推导在 $E  V_{0}$ 情况下的反射振幅 $r(\\theta)$ 和透射振幅 $t(\\theta)$（用 $\\theta$ 和 $\\theta_{2}$ 表示），然后求出透射概率 $T(\\theta)$，其定义为沿 $x$ 方向的透射概率流与入射概率流之比。最后，计算在正入射 $\\theta \\to 0$ 时的 $T(\\theta)$，并报告其精确值。角度必须以弧度处理。将最终答案表示为一个无单位的无量纲数。无需四舍五入。",
            "solution": "问题要求推导电子在石墨烯中从势垒上散射时的反射振幅 $r(\\theta)$ 和透射振幅 $t(\\theta)$、透射概率 $T(\\theta)$ 及其在正入射时的值，此为克莱因隧穿情况（$0  E  V_0$）。\n\n首先，我们建立两个区域中的波函数。低能行为由无质量的狄拉克哈密顿量 $H = v_{F} \\left( \\sigma_{x} p_{x} + \\sigma_{y} p_{y} \\right) + V(x)$ 决定。态是双分量旋量 $\\Psi(\\mathbf{r}) = \\psi(x) e^{i k_y y}$。横向动量分量 $p_y = \\hbar k_y$ 在 $x=0$ 处的界面上是守恒的。旋量振幅 $\\psi(x)$ 的本征值方程为：\n$$ \\left( v_{F} \\sigma_{x}(-i\\hbar \\partial_x) + v_{F} \\sigma_{y}(\\hbar k_y) + V(x) \\right) \\psi(x) = E \\psi(x) $$\n\n在区域I（$x0$）中，我们有 $V(x)=0$。能量为 $E > 0$。总波函数是入射波和反射波的叠加。\n入射粒子的能量为 $E = \\hbar v_F k$，动量为 $\\mathbf{k} = (k_x, k_y) = (k\\cos\\theta, k\\sin\\theta)$，其中 $k_x > 0$。对应的旋量是 $\\chi_{inc} = \\begin{pmatrix} 1 \\\\ e^{i\\theta} \\end{pmatrix}$。\n反射粒子具有相同的能量 $E$，但法向动量反向，因此其动量为 $\\mathbf{k}' = (-k_x, k_y) = (-k\\cos\\theta, k\\sin\\theta)$。对应的动量角为 $\\pi - \\theta$，旋量为 $\\chi_{ref} = \\begin{pmatrix} 1 \\\\ e^{i(\\pi-\\theta)} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -e^{-i\\theta} \\end{pmatrix}$。\n区域I中的总波函数是：\n$$ \\Psi_{I}(x,y) = \\left( \\begin{pmatrix} 1 \\\\ e^{i\\theta} \\end{pmatrix} e^{ik_x x} + r(\\theta) \\begin{pmatrix} 1 \\\\ -e^{-i\\theta} \\end{pmatrix} e^{-ik_x x} \\right) e^{ik_y y} $$\n\n在区域II（$x>0$）中，我们有 $V(x)=V_0$。问题陈述了 $0  E  V_0$，因此态是类空穴的，能量为 $E-V_0  0$。动量的大小由 $|E-V_0| = \\hbar v_F q$ 给出，其中 $q = |E - V_{0}|/(\\hbar v_{F})$。透射粒子的动量为 $\\mathbf{q} = (q_x, q_y)$。\n横向动量守恒意味着 $k_y = q_y$，这导出了给定的关系式 $k \\sin\\theta = q \\sin\\theta_2$，其中 $\\theta_2$ 是区域II中的动量角。\n动量角为 $\\theta_2$ 的类空穴态的旋量是 $\\chi_{trans} = \\begin{pmatrix} 1 \\\\ \\frac{\\hbar v_F(q_x+iq_y)}{E-V_0} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{\\hbar v_F q e^{i\\theta_2}}{-\\hbar v_F q} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -e^{i\\theta_2} \\end{pmatrix}$。\n问题指明透射态的群速度在 $+x$ 方向。对于空穴，群速度与动量反平行，因此这意味着 $q_x  0$。根据定义 $q_x = q \\cos\\theta_2$，这要求 $\\cos\\theta_2 \\le 0$。\n区域II中的波函数是：\n$$ \\Psi_{II}(x,y) = t(\\theta) \\begin{pmatrix} 1 \\\\ -e^{i\\theta_2} \\end{pmatrix} e^{iq_x x} e^{ik_y y} $$\n\n边界条件是波函数在 $x=0$ 处的连续性，即 $\\Psi_I(0,y) = \\Psi_{II}(0,y)$。这为振幅 $r \\equiv r(\\theta)$ 和 $t \\equiv t(\\theta)$ 产生了一个由两个线性方程组成的方程组：\n1. $1 + r = t$\n2. $e^{i\\theta} - r e^{-i\\theta} = -t e^{i\\theta_2}$\n\n我们解这个方程组。将(1)中的 $t=1+r$ 代入(2)：\n$$ e^{i\\theta} - r e^{-i\\theta} = -(1+r)e^{i\\theta_2} = -e^{i\\theta_2} - r e^{i\\theta_2} $$\n$$ e^{i\\theta} + e^{i\\theta_2} = r(e^{-i\\theta} - e^{i\\theta_2}) $$\n这给出了反射振幅：\n$$ r(\\theta) = \\frac{e^{i\\theta} + e^{i\\theta_2}}{e^{-i\\theta} - e^{i\\theta_2}} $$\n现在，我们用 $t=1+r$ 求出透射振幅 $t(\\theta)$：\n$$ t(\\theta) = 1 + \\frac{e^{i\\theta} + e^{i\\theta_2}}{e^{-i\\theta} - e^{i\\theta_2}} = \\frac{(e^{-i\\theta} - e^{i\\theta_2}) + (e^{i\\theta} + e^{i\\theta_2})}{e^{-i\\theta} - e^{i\\theta_2}} = \\frac{e^{i\\theta} + e^{-i\\theta}}{e^{-i\\theta} - e^{i\\theta_2}} $$\n$$ t(\\theta) = \\frac{2\\cos\\theta}{e^{-i\\theta} - e^{i\\theta_2}} $$\n\n接下来，我们推导透射概率 $T(\\theta)$。这是沿 $x$ 方向的透射概率流密度与沿 $x$ 方向的入射流密度之比。流算符为 $\\mathbf{j} = v_F \\vec{\\sigma}$，因此 $j_x = v_F \\sigma_x$。\n入射流密度为：\n$$ j_{x,inc} = \\left( \\begin{pmatrix} 1 \\\\ e^{i\\theta} \\end{pmatrix} e^{ik_x x} e^{ik_y y} \\right)^{\\dagger} v_F \\sigma_x \\left( \\begin{pmatrix} 1 \\\\ e^{i\\theta} \\end{pmatrix} e^{ik_x x} e^{ik_y y} \\right) = v_F \\begin{pmatrix} 1  e^{-i\\theta} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ e^{i\\theta} \\end{pmatrix} = v_F (e^{i\\theta} + e^{-i\\theta}) = 2v_F\\cos\\theta $$\n透射流密度为：\n$$ j_{x,trans} = \\Psi_{II}^{\\dagger} v_F \\sigma_x \\Psi_{II} = |t|^2 v_F \\begin{pmatrix} 1  -e^{-i\\theta_2} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -e^{i\\theta_2} \\end{pmatrix} = |t|^2 v_F (-e^{i\\theta_2} - e^{-i\\theta_2}) = -2v_F|t|^2\\cos\\theta_2 $$\n透射概率为 $T(\\theta) = j_{x,trans}/j_{x,inc}$：\n$$ T(\\theta) = \\frac{-2v_F|t|^2\\cos\\theta_2}{2v_F\\cos\\theta} = -\\frac{|t|^2\\cos\\theta_2}{\\cos\\theta} $$\n我们计算 $|t|^2$：\n$$ |t|^2 = \\left| \\frac{2\\cos\\theta}{e^{-i\\theta} - e^{i\\theta_2}} \\right|^2 = \\frac{4\\cos^2\\theta}{|(\\cos\\theta - \\cos\\theta_2) - i(\\sin\\theta + \\sin\\theta_2)|^2} = \\frac{4\\cos^2\\theta}{(\\cos\\theta - \\cos\\theta_2)^2 + (\\sin\\theta + \\sin\\theta_2)^2} $$\n分母展开为 $\\cos^2\\theta - 2\\cos\\theta\\cos\\theta_2 + \\cos^2\\theta_2 + \\sin^2\\theta + 2\\sin\\theta\\sin\\theta_2 + \\sin^2\\theta_2 = 2 - 2\\cos(\\theta+\\theta_2)$。\n所以， $|t|^2 = \\frac{4\\cos^2\\theta}{2(1 - \\cos(\\theta+\\theta_2))} = \\frac{2\\cos^2\\theta}{1 - \\cos(\\theta+\\theta_2)}$。\n将此代入 $T(\\theta)$ 的表达式中：\n$$ T(\\theta) = -\\frac{\\cos\\theta_2}{\\cos\\theta} \\left( \\frac{2\\cos^2\\theta}{1 - \\cos(\\theta+\\theta_2)} \\right) = \\frac{-2\\cos\\theta\\cos\\theta_2}{1 - \\cos(\\theta+\\theta_2)} $$\n\n最后，我们计算在正入射时，即在极限 $\\theta \\to 0$ 下的 $T(\\theta)$。根据斯涅尔定律 $k\\sin\\theta = q\\sin\\theta_2$，当 $\\theta\\to 0$ 时，我们必须有 $\\sin\\theta_2 \\to 0$。这意味着 $\\theta_2 \\to 0$ 或 $\\theta_2 \\to \\pi$。透射空穴态的物理条件是其群速度必须在 $+x$ 方向，这要求 $\\cos\\theta_2 \\le 0$。$\\theta_2 \\to 0$ 的情况给出 $\\cos\\theta_2 \\to 1$，这是不符合物理的。因此，正确的极限是 $\\theta_2 \\to \\pi$，这给出 $\\cos\\theta_2 \\to -1$。\n我们现在取 $T(\\theta)$ 的极限：\n$$ T(0) = \\lim_{\\substack{\\theta \\to 0 \\\\ \\theta_2 \\to \\pi}} \\frac{-2\\cos\\theta\\cos\\theta_2}{1 - \\cos(\\theta+\\theta_2)} $$\n当 $\\theta \\to 0$ 时，$\\cos\\theta \\to 1$。\n当 $\\theta_2 \\to \\pi$ 时，$\\cos\\theta_2 \\to -1$。\n分母中余弦的自变量趋近于 $\\theta+\\theta_2 \\to 0+\\pi=\\pi$。因此，$\\cos(\\theta+\\theta_2) \\to \\cos(\\pi)=-1$。\n将这些极限值代入表达式中：\n$$ T(0) = \\frac{-2(1)(-1)}{1 - (-1)} = \\frac{2}{2} = 1 $$\n这就是著名的正入射时完美透射的结果，是克莱因隧穿的一个关键特征。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在掌握了单个势垒的行为后，我们自然会问：对于更复杂的势垒结构，克莱因隧穿的完美透射特性是否依然存在？这项实践引入了强大的传输矩阵方法，这是一个用于分析多层结构的标准“动手”工具。通过构建和分析传输矩阵 ，你将证明在正常入射情况下，无论势垒的剖面多么复杂，反射都将被完全抑制，从而深刻理解克莱因隧穿的鲁棒性。",
            "id": "4284174",
            "problem": "考虑一个由无质量狄拉克哈密顿量描述的单层石墨烯片，该石墨烯片沿 $x$ 轴被划分为 $N$ 个具有分段恒定静电势的内部区域，两侧是两个半无限长的引线。势能分布为 $V(x) = V_{n}$（对于 $x \\in [x_{n}, x_{n+1})$，$n = 1, 2, \\dots, N$），$V(x) = V_{0}$（对于 $x  x_{1}$，左引线）以及 $V(x) = V_{N+1}$（对于 $x \\ge x_{N+1}$，右引线）。每个内部区域的宽度为 $d_{n} = x_{n+1} - x_{n}$。假设费米速度 $v_{F}$ 是均匀的，二维（2D）动量为 $\\boldsymbol{p} = (p_{x}, p_{y})$。入射电子的能量为 $E$，由于沿 $y$ 方向的平移不变性，横向波矢 $k_{y}$ 在整个结构中是守恒的。假设左引线是n型掺杂的，因此 $E - V_{0} > 0$，并允许其他区域的掺杂是任意的。\n\n动力学由无质量狄拉克哈密顿量决定\n$$\nH = v_{F}\\left(\\sigma_{x} p_{x} + \\sigma_{y} p_{y}\\right) + V(x)\\,\\mathbb{I},\n$$\n其中 $\\sigma_{x}$ 和 $\\sigma_{y}$ 是泡利矩阵，$\\mathbb{I}$ 是单位矩阵。在区域 $n$ 中，本征值方程为\n$$\n\\left[v_{F}\\left(\\sigma_{x} p_{x} + \\sigma_{y} p_{y}\\right) + V_{n}\\,\\mathbb{I}\\right]\\psi_{n}(x,y) = E\\,\\psi_{n}(x,y),\n$$\n其中 $\\epsilon_{n} \\equiv E - V_{n}$。定义 $k_{n} = |\\epsilon_{n}|/(\\hbar v_{F})$，纵向波矢 $k_{x,n}$ 满足 $k_{x,n}^{2} + k_{y}^{2} = k_{n}^{2}$（当 $k_{n}^{2} > k_{y}^{2}$ 时为传播模式），能带指数 $s_{n} = \\mathrm{sgn}(\\epsilon_{n}) \\in \\{+1,-1\\}$，以及传播角 $\\theta_{n} = \\arctan(k_{y}/k_{x,n})$。\n\n在每个区域 $n$ 中，将通解写成向右和向左传播的平面波旋量的叠加：\n$$\n\\psi_{n}(x,y) = a_{n}\\,\\exp\\!\\left(i k_{x,n} x + i k_{y} y\\right) u_{n}^{(+)} + b_{n}\\,\\exp\\!\\left(-i k_{x,n} x + i k_{y} y\\right) u_{n}^{(-)},\n$$\n其中旋量为\n$$\nu_{n}^{(+)} = \\begin{pmatrix} 1 \\\\ s_{n}\\,\\exp(i \\theta_{n}) \\end{pmatrix}, \\quad\nu_{n}^{(-)} = \\begin{pmatrix} 1 \\\\ s_{n}\\,\\exp\\!\\big(i(\\pi - \\theta_{n})\\big) \\end{pmatrix}.\n$$\n设 $U_{n} = \\begin{pmatrix} u_{n}^{(+)}  u_{n}^{(-)} \\end{pmatrix}$ 为区域 $n$ 中的 $2\\times 2$ 旋量基底矩阵。\n\n任务：\n1. 从每个界面 $x = x_{n}$ 处双分量旋量波函数 $\\psi$ 的连续性出发，推导连接区域 $n$ 和区域 $n+1$ 中系数向量的 $2\\times 2$ 界面矩阵 $I_{n,n+1}$：\n$$\n\\begin{pmatrix} a_{n} \\\\ b_{n} \\end{pmatrix} = I_{n,n+1} \\begin{pmatrix} a_{n+1} \\\\ b_{n+1} \\end{pmatrix},\n$$\n并用 $U_{n}^{-1}$ 和 $U_{n+1}$ 表示 $I_{n,n+1}$。\n\n2. 推导 $2\\times 2$ 传播矩阵 $P_{n}$，该矩阵将系数在宽度为 $d_n$ 的区域 $n$ 中向前传播。\n\n3. 使用界面和传播矩阵的乘积，构建连接左右引线中系数的总传输矩阵 $M$，\n$$\n\\begin{pmatrix} a_{0} \\\\ b_{0} \\end{pmatrix} = M \\begin{pmatrix} a_{N+1} \\\\ b_{N+1} \\end{pmatrix},\n$$\n并展示如何根据 $M$ 的矩阵元以及没有波从右引线入射的条件，计算透射振幅 $t$ 和反射振幅 $r$。使用电流密度定义\n$$\nj_{x} = v_{F}\\,\\psi^{\\dagger}\\,\\sigma_{x}\\,\\psi,\n$$\n用 $t$、$r$ 以及入射角和透射角表示透射概率 $T$ 和反射概率 $R$。\n\n4. 特殊化到法向入射 $k_{y} = 0$ 的情况，并证明每个界面矩阵都简化为置换矩阵或单位矩阵。推导出总传输矩阵 $M$ 的一般形式，并证明对于任意的 $N$ 和任意的 $\\{V_{n}\\}$，反射都为零。最后，计算在法向入射下通过整个多区域结构的总透射概率 $T$。\n\n将最终的透射概率表示为小数或分数。无需四舍五入。概率是无量纲的；最终数值答案中不要包含任何单位。",
            "solution": "问题陈述描述了单层石墨烯中的一个标准量子散射问题，该问题利用了传输矩阵方法。其基础物理学（体现在无质量狄拉克哈密顿量中）和数学框架是完善且科学合理的。这个问题是适定的，会导出一个唯一的解。问题中关于系数矩阵的符号存在一个微小的模糊之处，将使用标准的、物理上一致的解释来澄清和解决。\n\n问题为每个区域 $n$ 定义了常系数 $a_n, b_n$。波函数 $\\psi_n(x,y)$ 在每个界面 $x_j$ 处必须是连续的。传输矩阵方法将一个区域中的系数与下一个区域中的系数联系起来。让我们建立跨越界面 $x=x_n$ 的系数 $(a_{n-1}, b_{n-1})$ 和 $(a_n, b_n)$ 之间的关系。\n在 $x=x_n$ 处的波函数连续性意味着：\n$$ \\psi_{n-1}(x_n, y) = \\psi_n(x_n, y) $$\n代入通解形式并消去公共因子 $\\exp(i k_y y)$：\n$$ a_{n-1} e^{i k_{x,n-1} x_n} u_{n-1}^{(+)} + b_{n-1} e^{-i k_{x,n-1} x_n} u_{n-1}^{(-)} = a_n e^{i k_{x,n} x_n} u_n^{(+)} + b_n e^{-i k_{x,n} x_n} u_n^{(-)} $$\n这可以写成矩阵形式，使用旋量基底矩阵 $U_n = \\begin{pmatrix} u_n^{(+)}  u_n^{(-)} \\end{pmatrix}$ 和一个对角相位矩阵 $D_n(x) = \\mathrm{diag}(\\exp(i k_{x,n} x), \\exp(-i k_{x,n} x))$：\n$$ U_{n-1} D_{n-1}(x_n) \\begin{pmatrix} a_{n-1} \\\\ b_{n-1} \\end{pmatrix} = U_n D_n(x_n) \\begin{pmatrix} a_n \\\\ b_n \\end{pmatrix} $$\n由此，我们可以用区域 $n$ 的系数表示区域 $n-1$ 的系数：\n$$ \\begin{pmatrix} a_{n-1} \\\\ b_{n-1} \\end{pmatrix} = [D_{n-1}(x_n)]^{-1} U_{n-1}^{-1} U_n D_n(x_n) \\begin{pmatrix} a_n \\\\ b_n \\end{pmatrix} $$\n总传输矩阵 $M$ 是通过将这些变换从最右边的区域（$N+1$）链接到最左边的区域（$0$）来构造的。\n$$ M = \\left(\\prod_{n=1}^{N+1} [D_{n-1}(x_n)]^{-1} U_{n-1}^{-1} U_n D_n(x_n)\\right) $$\n这个表达式有些繁琐。我们采用一种更标准、物理上更透明的方法，该方法定义了相对于每个区域起始点 $x_n$ 的恒定系数 $(a_n, b_n)$。那么区域 $n$ 中（对于 $x \\in [x_n, x_{n+1})$）的完整波函数是：\n$$ \\psi_n(x,y) = \\left[ a_n e^{i k_{x,n} (x-x_n)} u_n^{(+)} + b_n e^{-i k_{x,n} (x-x_n)} u_n^{(-)} \\right] e^{ik_y y} $$\n在这个约定下，界面 $x=x_{n+1}$（其中 $x_{n+1}-x_n=d_n$）处的连续性将系数 $(a_n, b_n)$ 与 $(a_{n+1}, b_{n+1})$ 连接起来：\n$$ a_n e^{i k_{x,n} d_n} u_n^{(+)} + b_n e^{-i k_{x,n} d_n} u_n^{(-)} = a_{n+1} u_{n+1}^{(+)} + b_{n+1} u_{n+1}^{(-)} $$\n正如问题所要求的，这种表述方式自然地将区域内的传播与界面上的散射分离开来。\n\n### 任务1：界面矩阵 $I_{n,n+1}$\n双分量波函数在界面 $x = x_{n+1}$ 处必须是连续的。考虑该界面左右两侧的状态：$\\psi_n(x_{n+1}) = \\psi_{n+1}(x_{n+1})$。使用与位置相关的系数，这是：\n$$ U_n \\begin{pmatrix} a_n(x_{n+1}) \\\\ b_n(x_{n+1}) \\end{pmatrix} = U_{n+1} \\begin{pmatrix} a_{n+1}(x_{n+1}) \\\\ b_{n+1}(x_{n+1}) \\end{pmatrix} $$\n因此，连接界面两侧系数的矩阵是 $I_{n,n+1} = U_n^{-1} U_{n+1}$。问题的方程 $\\begin{pmatrix} a_{n} \\\\ b_{n} \\end{pmatrix} = I_{n,n+1} \\begin{pmatrix} a_{n+1} \\\\ b_{n+1} \\end{pmatrix}$ 因此被解释为连接在特定参考平面上定义的系数。基于一个标准框架，我们将使用 $I_{n,n+1}$ 来连接界面 $x_{n+1}$ 处的系数。\n为了计算 $I_{n,n+1}$，我们首先求 $U_n^{-1}$。\n旋量基底矩阵是 $U_n = \\begin{pmatrix} u_n^{(+)}  u_n^{(-)} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ s_n e^{i\\theta_n}  s_n e^{i(\\pi-\\theta_n)} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ s_n e^{i\\theta_n}  -s_n e^{-i\\theta_n} \\end{pmatrix}$。\n行列式为 $\\det(U_n) = -s_n e^{-i\\theta_n} - s_n e^{i\\theta_n} = -s_n(e^{i\\theta_n} + e^{-i\\theta_n}) = -2s_n\\cos\\theta_n$。\n逆矩阵是：\n$$ U_n^{-1} = \\frac{1}{-2s_n \\cos\\theta_n} \\begin{pmatrix} -s_n e^{-i\\theta_n}  -1 \\\\ -s_n e^{i\\theta_n}  1 \\end{pmatrix} = \\frac{s_n}{-2\\cos\\theta_n} \\begin{pmatrix} -e^{-i\\theta_n}  -s_n \\\\ -e^{i\\theta_n}  s_n \\end{pmatrix} = \\frac{1}{2\\cos\\theta_n} \\begin{pmatrix} s_n e^{-i\\theta_n}  1 \\\\ s_n e^{i\\theta_n}  -1 \\end{pmatrix} $$\n重新检查逆矩阵计算，使用 $s_n^{-1}=s_n$：\n$U_n^{-1} = \\frac{1}{-2s_n \\cos\\theta_n} \\begin{pmatrix} -s_n e^{-i\\theta_n}  -1 \\\\ -s_n e^{i\\theta_n}  1 \\end{pmatrix} = \\frac{1}{2\\cos\\theta_n} \\begin{pmatrix} e^{-i\\theta_n}  s_n \\\\ e^{i\\theta_n}  -s_n \\end{pmatrix}$。\n那么界面矩阵是：\n$I_{n,n+1} = U_n^{-1} U_{n+1} = \\frac{1}{2\\cos\\theta_n} \\begin{pmatrix} e^{-i\\theta_n}  s_n \\\\ e^{i\\theta_n}  -s_n \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ s_{n+1}e^{i\\theta_{n+1}}  -s_{n+1}e^{-i\\theta_{n+1}} \\end{pmatrix}$\n$$ I_{n,n+1} = \\frac{1}{2\\cos\\theta_n} \\begin{pmatrix} e^{-i\\theta_n} + s_n s_{n+1} e^{i\\theta_{n+1}}  e^{-i\\theta_n} - s_n s_{n+1} e^{-i\\theta_{n+1}} \\\\ e^{i\\theta_n} - s_n s_{n+1} e^{i\\theta_{n+1}}  e^{i\\theta_n} + s_n s_{n+1} e^{-i\\theta_{n+1}} \\end{pmatrix} $$\n\n### 任务2：传播矩阵 $P_n$\n在宽度为 $d_n = x_{n+1}-x_n$ 的区域 $n$ 内，系数由于平面波的相位相干累积而演化。从区域开始处的系数 $(a_n(x_n), b_n(x_n))$ 开始，区域末端的系数是 $(a_n(x_{n+1}), b_n(x_{n+1}))$。演化由以下公式给出：\n$$ a_n(x_{n+1}) = a_n(x_n) e^{i k_{x,n} (x_{n+1}-x_n)} = a_n(x_n) e^{i k_{x,n} d_n} $$\n$$ b_n(x_{n+1}) = b_n(x_n) e^{-i k_{x,n} (x_{n+1}-x_n)} = b_n(x_n) e^{-i k_{x,n} d_n} $$\n写成矩阵形式为：\n$$ \\begin{pmatrix} a_n(x_{n+1}) \\\\ b_n(x_{n+1}) \\end{pmatrix} = \\begin{pmatrix} e^{i k_{x,n} d_n}  0 \\\\ 0  e^{-i k_{x,n} d_n} \\end{pmatrix} \\begin{pmatrix} a_n(x_n) \\\\ b_n(x_n) \\end{pmatrix} $$\n因此，将系数在区域 $n$ 中向前传播的传播矩阵 $P_n$ 是：\n$$ P_n = \\begin{pmatrix} e^{i k_{x,n} d_n}  0 \\\\ 0  e^{-i k_{x,n} d_n} \\end{pmatrix} $$\n\n### 任务3：总传输矩阵、透射和反射\n我们构建总传输矩阵 $M$，它将左引线（区域 $0$，在 $x=x_1$ 处）中的系数与右引线（区域 $N+1$，在 $x=x_{N+1}$ 处）中的系数联系起来。设 $c_n$ 为区域 $n$ 入口点 $x_n$ 处的系数向量 $(a_n, b_n)^T$。\n在界面 $x_{n+1}$ 处：$U_n P_n(d_n) c_n = U_{n+1} c_{n+1}$，其中 $P_n(d_n)$ 是上面推导的传播矩阵。\n这得出 $c_n = [P_n(d_n)]^{-1} U_n^{-1} U_{n+1} c_{n+1}$。让我们将板 $n$ 的传输矩阵定义为 $T_n = [P_n(d_n)]^{-1} I_{n,n+1}$，其中 $I_{n,n+1}=U_n^{-1} U_{n+1}$。\n初始引线（区域 $0$）中的系数与最终引线（区域 $N+1$）中的系数通过这些矩阵的乘积相关联。让我们在第一个界面 $x_1$ 处定义区域 $0$ 的系数 $c_0=(a_0,b_0)^T$。区域 $0$ 是半无限的，所以没有传播矩阵。\n$$ \\begin{pmatrix} a_0 \\\\ b_0 \\end{pmatrix} = (U_0^{-1} U_1) \\begin{pmatrix} a_1 \\\\ b_1 \\end{pmatrix} $$\n其中 $(a_1,b_1)$ 是区域 $1$ 开始处（在 $x_1$ 处）的系数。\n组合关系：\n$$ c_0 = (U_0^{-1}U_1) c_1 $$\n$$ c_1 = T_1 c_2 = [P_1(d_1)]^{-1} (U_1^{-1}U_2) c_2 $$\n$$ \\dots $$\n$$ c_N = T_N c_{N+1} = [P_N(d_N)]^{-1} (U_N^{-1}U_{N+1}) c_{N+1} $$\n总传输矩阵 $M$ 是这些矩阵的乘积：\n$$ M = (U_0^{-1} U_1) \\left( \\prod_{n=1}^{N} [P_n(d_n)]^{-1} U_n^{-1} U_{n+1} \\right) = I_{0,1} \\left( \\prod_{n=1}^{N} P_n(-d_n) I_{n,n+1} \\right) $$\n其中 $P_n(-d_n) = \\mathrm{diag}(\\exp(-i k_{x,n} d_n), \\exp(i k_{x,n} d_n))$。\n\n散射边界条件是：一个从左边入射的单位振幅波（$a_0=1$），一个反射波（$b_0=r$），以及一个透射波。关键是，透射波的形式取决于最终区域 $N+1$ 是电子型的（$s_{N+1}=1$）还是空穴型的（$s_{N+1}=-1$）。这是因为空穴的群速度与其动量反平行。“透射”波必须将能量带离散射区域，这意味着其群速度 $v_{g,x}$ 必须为正。\n群速度为 $v_{g,x,n} = \\frac{1}{\\hbar}\\frac{\\partial \\epsilon_n}{\\partial k_{x,n}} = s_n v_F \\cos\\theta_n$。我们按照惯例取 $k_{x,n} = \\sqrt{k_n^2-k_y^2} > 0$，因此 $\\cos\\theta_n > 0$。\n- 如果 $s_{N+1}=1$，对于带有 $a_{N+1}$ 的波，$v_{g,x} > 0$，所以我们设置 $a_{N+1}=t$ 和 $b_{N+1}=0$。\n- 如果 $s_{N+1}=-1$，对于带有 $b_{N+1}$ 的波（相位 $\\exp(-ik_{x,N+1}x)$），$v_{g,x} > 0$，所以我们设置 $a_{N+1}=0$ 和 $b_{N+1}=t$。\n\n如果 $s_{N+1}=1$：$\\begin{pmatrix} 1 \\\\ r \\end{pmatrix} = M \\begin{pmatrix} t \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} M_{11} t \\\\ M_{21} t \\end{pmatrix} \\implies t = \\frac{1}{M_{11}}, r = \\frac{M_{21}}{M_{11}}$。\n如果 $s_{N+1}=-1$：$\\begin{pmatrix} 1 \\\\ r \\end{pmatrix} = M \\begin{pmatrix} 0 \\\\ t \\end{pmatrix} = \\begin{pmatrix} M_{12} t \\\\ M_{22} t \\end{pmatrix} \\implies t = \\frac{1}{M_{12}}, r = \\frac{M_{22}}{M_{12}}$。\n\n电流密度为 $j_x = v_F \\psi^{\\dagger} \\sigma_x \\psi$。对于平面波态 $\\psi_n = C u_n^{(\\pm)} e^{\\pm i k_{x,n}x+ik_y y}$，电流为 $j_x = |C|^2 v_F (u_n^{(\\pm)})^\\dagger \\sigma_x u_n^{(\\pm)} = |C|^2 v_F (\\pm 2 s_n \\cos\\theta_n)$。\n入射电流（$a_0=1, s_0=1$）为 $j_{inc} = 2 v_F \\cos\\theta_0$。反射电流为 $j_{ref} = -2 v_F \\cos\\theta_0 |r|^2$。对于 $s_{N+1}=1$ 边界条件，透射电流为 $j_{trans} = 2 v_F s_{N+1} \\cos\\theta_{N+1} |t|^2$；对于 $s_{N+1}=-1$ 边界条件，透射电流为 $j_{trans} = -2 v_F s_{N+1} \\cos\\theta_{N+1} |t|^2$。在这两种情况下，透射通量都是正的。\n反射概率是 $R = \\frac{|j_{ref}|}{j_{inc}} = |r|^2$。\n透射概率是 $T = \\frac{|j_{trans}|}{j_{inc}}$。\n对于 $s_{N+1}=1$：$T = \\frac{2 v_F \\cos\\theta_{N+1} |t|^2}{2 v_F \\cos\\theta_0} = \\frac{\\cos\\theta_{N+1}}{\\cos\\theta_0} |t|^2$。\n对于 $s_{N+1}=-1$：$T = \\frac{|-2 v_F(-1) \\cos\\theta_{N+1} |t|^2|}{2 v_F \\cos\\theta_0} = \\frac{\\cos\\theta_{N+1}}{\\cos\\theta_0} |t|^2$。\n所以，通用公式是 $T = \\frac{\\cos\\theta_{N+1}}{\\cos\\theta_0} |t|^2$。\n\n### 任务4：法向入射 ($k_y=0$)\n在法向入射时，$k_y=0$，这意味着对于所有区域 $n$，$\\theta_n = \\arctan(0) = 0$。同时，$k_{x,n} = k_n = |\\epsilon_n|/(\\hbar v_F)$。\n旋量简化为 $u_n^{(+)} = \\begin{pmatrix} 1 \\\\ s_n \\end{pmatrix}$ 和 $u_n^{(-)} = \\begin{pmatrix} 1 \\\\ -s_n \\end{pmatrix}$。\n基底矩阵变为 $U_n = \\begin{pmatrix} 1  1 \\\\ s_n  -s_n \\end{pmatrix}$。\n其逆矩阵是 $U_n^{-1} = \\frac{1}{-2s_n} \\begin{pmatrix} -s_n  -1 \\\\ -s_n  1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  s_n \\\\ 1  -s_n \\end{pmatrix}$，使用了 $s_n^{-1}=s_n$。\n界面矩阵 $I_{n,n+1} = U_n^{-1} U_{n+1}$ 是：\n$$ I_{n,n+1} = \\frac{1}{2} \\begin{pmatrix} 1  s_n \\\\ 1  -s_n \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ s_{n+1}  -s_{n+1} \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1+s_n s_{n+1}  1-s_n s_{n+1} \\\\ 1-s_n s_{n+1}  1+s_n s_{n+1} \\end{pmatrix} $$\n如果 $s_n=s_{n+1}$（能带没有变化，例如 n-n 结或 p-p 结），则 $s_n s_{n+1}=1$，并且 $I_{n,n+1}=\\mathbb{I}$（单位矩阵）。\n如果 $s_n \\neq s_{n+1}$（能带反转，n-p 结），则 $s_n s_{n+1}=-1$，并且 $I_{n,n+1}=\\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = \\sigma_x$（泡利-X 矩阵）。\n传播矩阵是 $P_n(-d_n) = \\mathrm{diag}(\\exp(-ik_n d_n), \\exp(ik_n d_n))$。让我们用 $D_n$ 来表示它们。\n总传输矩阵是 $M = I_{0,1} D_1 I_{1,2} D_2 \\dots D_N I_{N,N+1}$。\n每个 $I$ 要么是 $\\mathbb{I}$ 要么是 $\\sigma_x$，每个 $D$ 都是对角矩阵，其元素为 $\\exp(\\mp i\\phi)$。我们使用代数恒等式 $\\sigma_x D(\\phi) = D(-\\phi) \\sigma_x$，其中 $D(\\phi) = \\mathrm{diag}(\\exp(-i\\phi), \\exp(i\\phi))$。\n通过将所有 $\\sigma_x$ 矩阵移到右边，可以简化矩阵的乘积。每当一个 $\\sigma_x$ 经过一个 $D_n$ 时，$D_n$ 的相位就会翻转。最终矩阵的形式将是 $M=D_{tot} (\\sigma_x)^K$，其中 $K$ 是所有界面上符号翻转的总次数（$s_n \\to s_{n+1}$）。\n如果 $K$ 是偶数，$M = D_{tot}$，一个对角矩阵。\n如果 $K$ 是奇数，$M = D_{tot} \\sigma_x$，一个反对角矩阵。\n\n现在我们证明反射消失了。\n给定 $s_0=1$。\n情况1：最终区域 $N+1$ 是电子型的（$s_{N+1}=1$）。从 $s_0=1$ 到 $s_{N+1}=1$，符号翻转的次数 $K$ 必须是偶数。因此，$M$ 是一个对角矩阵：$M=\\begin{pmatrix} M_{11}  0 \\\\ 0  M_{22} \\end{pmatrix}$。\n$s_{N+1}=1$ 的边界条件是 $a_{N+1}=t, b_{N+1}=0$。\n$$ \\begin{pmatrix} 1 \\\\ r \\end{pmatrix} = \\begin{pmatrix} M_{11}  0 \\\\ 0  M_{22} \\end{pmatrix} \\begin{pmatrix} t \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} M_{11}t \\\\ 0 \\end{pmatrix} $$\n这立即得出 $r=0$。\n\n情况2：最终区域 $N+1$ 是空穴型的（$s_{N+1}=-1$）。从 $s_0=1$ 到 $s_{N+1}=-1$，符号翻转的次数 $K$ 必须是奇数。因此，$M$ 是一个反对角矩阵：$M=\\begin{pmatrix} 0  M_{12} \\\\ M_{21}  0 \\end{pmatrix}$。\n$s_{N+1}=-1$ 的边界条件是 $a_{N+1}=0, b_{N+1}=t$。\n$$ \\begin{pmatrix} 1 \\\\ r \\end{pmatrix} = \\begin{pmatrix} 0  M_{12} \\\\ M_{21}  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ t \\end{pmatrix} = \\begin{pmatrix} M_{12} t \\\\ 0 \\end{pmatrix} $$\n这也得出 $r=0$。\n\n在这两种情况下，反射振幅 $r$ 都为零。这表明，对于法向入射，无论势垒的数量或其高度如何，都没有背散射。这是克莱因佯谬的一种表现，受到石墨烯中载流子手性性质的保护。\n\n最后，我们计算总透射概率 $T$。\n由于 $R = |r|^2 = 0$，并且电流必须守恒，所以透射概率 $T$ 必须为 $1$。\n我们可以用我们的公式 $T = \\frac{\\cos\\theta_{N+1}}{\\cos\\theta_0} |t|^2$ 来验证这一点。在法向入射时，$\\theta_0=\\theta_{N+1}=0$，所以 $\\cos\\theta_0 = \\cos\\theta_{N+1} = 1$。\n透射概率就是 $T=|t|^2$。\n在情况1（$s_{N+1}=1$）中，我们发现 $1=M_{11}t$。矩阵 $M$ 是行列式为 $1$（对于 $I$）和 $1$（对于 $D$）的矩阵的乘积，所以 $\\det(M)=1$。对于一个对角矩阵 $M$，$M_{11}M_{22}=1$。$D_{tot}$ 的显式形式将有 $|(D_{tot})_{11}|=1$。因此 $|M_{11}|=1$，这意味着 $|t|^2=1/|M_{11}|^2=1$。\n在情况2（$s_{N+1}=-1$）中，我们发现 $1=M_{12}t$。对于一个反对角矩阵 $M$，$\\det(M)=-M_{12}M_{21}=1$。同样，$M$ 的矩阵元具有单位模量，所以 $|M_{12}|=1$，这意味着 $|t|^2=1/|M_{12}|^2=1$。\n在所有法向入射的情况下，透射概率都是完美的。\n\n总透射概率 $T=1$。",
            "answer": "$$ \\boxed{1} $$"
        },
        {
            "introduction": "理论分析为我们提供了深刻的见解，而计算物理则让我们能够直观地验证和探索这些理论。这项实践要求你从第一性原理出发，编写一个程序来数值求解一维狄拉克方程。通过模拟电子在势垒上的传播并计算其透射率 ，你不仅能以一种全新的方式验证克莱因隧穿的完美透射，还能掌握一种在解析解不可行时研究量子输运现象的重要计算技能。",
            "id": "4284221",
            "problem": "您必须编写一个完整且可运行的程序，对石墨烯中无质量载流子在垂直入射下穿过一个尖锐静电势阶的一维稳态狄拉克方程进行离散化和数值求解，并将数值计算出的透射率与该势阶的解析推导透射率进行验证。其基本依据是石墨烯单个谷附近的低能狄拉克哈密顿量，由 $H = v_F \\boldsymbol{\\sigma} \\cdot \\mathbf{p} + V(x) I$ 给出，其中 $v_F$ 是费米速度，$\\boldsymbol{\\sigma}$ 是泡利矩阵，$\\mathbf{p}$ 是动量算符，$V(x)$ 是一个在一维上变化的标量势。在垂直入射的情况下，问题简化为一维稳态方程 $[-i \\hbar v_F \\sigma_x \\partial_x + V(x) I]\\psi(x) = E \\psi(x)$，其中 $E$ 是能量，$\\hbar$ 是约化普朗克常数，$\\psi(x)$ 是双分量旋量。您的程序必须基于该方程的第一性原理离散化，实现一个有限差分传输更新方法，并通过评估守恒流来计算透射系数。\n\n您的程序必须执行以下任务：\n- 使用间距均匀的格点 $x_n$（间距为 $\\Delta x$）在一个区域内实现旋量的空间传播。该区域包含一个左侧区域（$x0$ 时 $V(x)=0$）和一个右侧区域（$x \\ge 0$ 时 $V(x)=V_0$）。在一个单元格内，对常数势 $V$ 使用精确的局域传播子 $M(\\Delta x; \\kappa) = \\exp(i \\sigma_x \\kappa \\Delta x)$，其中 $\\kappa(x) = (E - V(x))/(\\hbar v_F)$，$\\sigma_x$ 是泡利矩阵。这是一种科学上有效的方法，因为在一维情况下，该方程在每个单元格内可简化为常系数一阶线性系统。\n- 在最左侧用本征值为 $+1$ 的 $\\sigma_x$ 本征矢量（记为 $u_+$）初始化一个入射的右行波态。使用由局域 $\\kappa(x)$ 决定的更新矩阵在格点上传播该波态，并分别在最左侧和最右侧点上通过 $j_x(x) = v_F \\psi^\\dagger(x) \\sigma_x \\psi(x)$ 计算入射流和透射流。数值透射率为 $T_{\\text{num}} = j_x^{\\text{out}}/j_x^{\\text{in}}$，其中两个流都计算为实标量。\n- 通过在 $x=0$ 处施加旋量的连续性条件和一维狄拉克方程的流守恒，独立推导垂直入射下势阶的解析透射系数 $T_{\\text{step}}(E,V_0)$。您的程序必须通过直接求解两个区域中相应 $\\sigma_x$ 本征态之间的匹配条件来计算 $T_{\\text{step}}(E,V_0)$，而不是硬编码一个简化公式。\n- 对于每个测试用例，计算绝对差值 $\\Delta T = |T_{\\text{num}} - T_{\\text{step}}|$。\n\n科学和数值要求：\n- 能量 $E$ 和 $V_0$ 使用电子伏特 (eV)；在计算 $\\kappa(x) = (E - V(x))/(\\hbar v_F)$ 时，内部将其转换为焦耳 (J)，其中 $\\hbar$ 的单位是焦耳-秒，$v_F$ 的单位是米/秒。在程序中明确声明所有物理常量。\n- 使用 $v_F = 1.0 \\times 10^6$ 米/秒，以及 $\\hbar = 1.054571817 \\times 10^{-34}$ 焦耳-秒。基本电荷为 $q_e = 1.602176634 \\times 10^{-19}$ 库仑，用于通过 $E_{\\text{J}} = q_e E_{\\text{eV}}$ 将电子伏特转换为焦耳。\n- 空间长度必须以米 (m) 为单位指定。不使用角度，因此不需要角度单位。所有输出必须是无量纲浮点数。\n- 数值网格必须是均匀的，间距为 $\\Delta x$（单位为米）。选择物理上合理且数值稳定的区域长度和 $\\Delta x$，并确保每次更新都使用每个单元格的精确局域传播子 $M(\\Delta x; \\kappa)$。\n\n测试套件：\n- 用例1（电子到空穴透射的一般传播）：$E = 0.1$ eV, $V_0 = 0.2$ eV, 左侧区域长度 $L_\\text{left} = 1.0 \\times 10^{-8}$ m, 右侧区域长度 $L_\\text{right} = 1.0 \\times 10^{-8}$ m, 网格间距 $\\Delta x = 1.0 \\times 10^{-10}$ m。\n- 用例2（无势阶）：$E = 0.1$ eV, $V_0 = 0.0$ eV, $L_\\text{left} = 1.0 \\times 10^{-8}$ m, $L_\\text{right} = 1.0 \\times 10^{-8}$ m, $\\Delta x = 1.0 \\times 10^{-10}$ m。\n- 用例3（阈值对齐）：$E = 0.1$ eV, $V_0 = 0.1$ eV, $L_\\text{left} = 1.0 \\times 10^{-8}$ m, $L_\\text{right} = 1.0 \\times 10^{-8}$ m, $\\Delta x = 1.0 \\times 10^{-10}$ m。\n- 用例4（更高能量）：$E = 0.4$ eV, $V_0 = 0.2$ eV, $L_\\text{left} = 1.5 \\times 10^{-8}$ m, $L_\\text{right} = 1.5 \\times 10^{-8}$ m, $\\Delta x = 1.0 \\times 10^{-10}$ m。\n- 用例5（零能边界情况）：$E = 0.0$ eV, $V_0 = 0.2$ eV, $L_\\text{left} = 1.0 \\times 10^{-8}$ m, $L_\\text{right} = 1.0 \\times 10^{-8}$ m, $\\Delta x = 1.0 \\times 10^{-10}$ m。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按上述测试用例顺序排列的结果。每个元素必须是相应案例的绝对差值 $\\Delta T$，并以 Python 浮点数形式打印。例如，输出必须看起来像 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 都是一个浮点数。",
            "solution": "该问题要求验证石墨烯中电子穿过势阶的数值解与其解析解的一致性。该物理系统由垂直入射下无质量费米子的一维稳态狄拉克方程建模。\n\n### 步骤1：问题验证\n\n**提取的已知条件：**\n- **控制方程：** $[-i \\hbar v_F \\sigma_x \\partial_x + V(x) I]\\psi(x) = E \\psi(x)$\n- **势能剖面：** 在 $x=0$ 处有一个尖锐势阶，$x0$ 时 $V(x)=0$，$x \\ge 0$ 时 $V(x)=V_0$。\n- **数值方法：** 在间距为 $\\Delta x$ 的均匀网格上进行有限差分传输更新。单个网格单元上的局域传播子由 $M(\\Delta x; \\kappa) = \\exp(i \\sigma_x \\kappa \\Delta x)$ 给出，其中 $\\kappa(x) = (E - V(x))/(\\hbar v_F)$。\n- **初始条件：** 传播从最左侧开始，初始状态为一个右行波态，具体为 $\\sigma_x$ 对应本征值 $+1$ 的本征矢量。\n- **流和透射率：** 流为 $j_x(x) = v_F \\psi^\\dagger(x) \\sigma_x \\psi(x)$。数值透射率为 $T_{\\text{num}} = j_x^{\\text{out}}/j_x^{\\text{in}}$。\n- **解析方法：** 必须通过在 $x=0$ 处施加旋量 $\\psi(x)$ 的连续性条件来推导透射系数 $T_{\\text{step}}(E,V_0)$，并求解得到的方程组。\n- **物理常数：**\n    - 费米速度 $v_F = 1.0 \\times 10^6$ m/s\n    - 约化普朗克常数 $\\hbar = 1.054571817 \\times 10^{-34}$ J·s\n    - 基本电荷 $q_e = 1.602176634 \\times 10^{-19}$ C\n- **测试用例：** 提供了五组参数 $(E, V_0, L_\\text{left}, L_\\text{right}, \\Delta x)$。\n- **任务：** 对每个用例计算绝对差值 $\\Delta T = |T_{\\text{num}} - T_{\\text{step}}|$。\n\n**验证结论：**\n该问题是**有效的**。\n- 它具有**科学依据**，使用标准的低能狄拉克哈密顿量描述了石墨烯中已广为人知的克莱因隧穿现象。\n- 它是**适定的**，具有明确定义的控制方程、边界条件（通过初始状态隐含）以及要计算的特定量。\n- 它是**客观的**，所有参数和方法都得到了明确的规定。\n- 其设置是**完整且一致的**。所提供的采用精确局域传播子的数值方法是恰当且可靠的。比较数值和解析结果的要求是一个标准的验证程序。所提供的物理常数和测试用例参数都是符合实际的。\n\n### 步骤2：基于原理的求解推导\n\n解决方案将包括两部分：透射系数的解析推导和传播过程的数值实现，然后对两者进行比较。\n\n#### 解析解 ($T_{\\text{step}}$)\n\n垂直入射时的稳态狄拉克方程为：\n$$\n[-i \\hbar v_F \\sigma_x \\partial_x + V(x) I]\\psi(x) = E \\psi(x)\n$$\n这可以重新整理为关于双分量旋量 $\\psi(x)$ 的一阶常微分方程：\n$$\n\\partial_x \\psi(x) = i \\frac{E - V(x)}{\\hbar v_F} \\sigma_x \\psi(x) = i \\kappa(x) \\sigma_x \\psi(x)\n$$\n其中 $\\kappa(x) = (E - V(x)) / (\\hbar v_F)$。该方程的解由泡利矩阵 $\\sigma_x = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$ 的本征矢量构成。归一化本征矢量为：\n- $u_+ = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，对应本征值 $\\lambda=+1$（右行）\n- $u_- = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，对应本征值 $\\lambda=-1$（左行）\n\n在势能为常数 $V$ 的区域内，通解是右行波和左行波的叠加：\n$$\n\\psi(x) = c_+ e^{i\\kappa x} u_+ + c_- e^{-i\\kappa x} u_-\n$$\n其中 $\\kappa = (E-V)/(\\hbar v_F)$。\n\n我们对 $x=0$ 处的势阶散射问题进行建模：\n- **区域1 ($x0$):** $V(x)=0$，因此 $\\kappa_1 = E / (\\hbar v_F)$。波函数包含一个入射波（振幅为 $1$）和一个反射波（振幅为 $r$）：\n$$\n\\psi_1(x) = e^{i\\kappa_1 x} u_+ + r e^{-i\\kappa_1 x} u_-\n$$\n- **区域2 ($x \\ge 0$):** $V(x)=V_0$，因此 $\\kappa_2 = (E - V_0) / (\\hbar v_F)$。波函数只包含一个透射波（振幅为 $t$）：\n$$\n\\psi_2(x) = t e^{i\\kappa_2 x} u_+\n$$\n在边界 $x=0$ 处旋量的连续性要求 $\\psi_1(0) = \\psi_2(0)$：\n$$\nu_+ + r u_- = t u_+\n$$\n代入本征矢量的表达式：\n$$\n\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + r \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = t \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n这为未知振幅 $r$ 和 $t$ 产生了一个二元线性方程组：\n1. $1 + r = t$\n2. $1 - r = t$\n\n求解该方程组得到 $r=0$ 和 $t=1$。透射系数定义为透射流与入射流之比。流为 $j_x = v_F \\psi^\\dagger \\sigma_x \\psi$。\n- 入射流：$j_{\\text{in}} = v_F (e^{i\\kappa_1 x} u_+)^\\dagger \\sigma_x (e^{i\\kappa_1 x} u_+) = v_F u_+^\\dagger \\sigma_x u_+ = v_F |1|^2 = v_F$。\n- 透射流：$j_{\\text{trans}} = v_F (t e^{i\\kappa_2 x} u_+)^\\dagger \\sigma_x (t e^{i\\kappa_2 x} u_+) = v_F |t|^2 u_+^\\dagger \\sigma_x u_+ = v_F |t|^2$。\n\n解析透射系数为 $T_{\\text{step}} = j_{\\text{trans}} / j_{\\text{in}} = |t|^2$。由于 $t=1$，我们发现 $T_{\\text{step}} = 1$。这个结果与能量 $E$ 和势阶高度 $V_0$ 无关，是克莱因隧穿的一种表现。程序将按要求显式求解 $(r, t)$ 的线性系统。\n\n一个重要的见解是，在垂直入射的情况下，哈密顿量 $H = v_F \\sigma_x p_x + V(x) I$ 在 $\\sigma_x$ 本征矢量的基底下是​​对角的。这意味着两个赝自旋通道不发生耦合，一个纯粹制备在 $u_+$ 通道中的入射态不能被散射到 $u_-$ 通道中，从而导致零反射和完美透射。\n\n#### 数值解 ($T_{\\text{num}}$)\n\n数值解在从 $x_0 = -L_{\\text{left}}$ 到 $x_N = L_{\\text{right}}$ 的离散空间网格上传播旋量。从格点 $x_n$ 到 $x_{n+1}$ 的更新规则由常数势 $V(x_n)$ 的精确局域传播子给出：\n$$\n\\psi(x_{n+1}) = M(\\Delta x; \\kappa(x_n)) \\psi(x_n)\n$$\n传播矩阵 $M$ 计算如下：\n$$\nM(\\Delta x; \\kappa) = \\exp(i \\sigma_x \\kappa \\Delta x)\n$$\n利用 $(\\sigma_x)^2 = I$ 的性质，我们可以使用泡利矩阵的欧拉公式：\n$$\n\\exp(i\\theta\\sigma_x) = \\cos(\\theta)I + i\\sin(\\theta)\\sigma_x\n$$\n其中 $\\theta = \\kappa \\Delta x$。显式矩阵为：\n$$\nM(\\Delta x; \\kappa) = \\begin{pmatrix} \\cos(\\kappa \\Delta x)  i \\sin(\\kappa \\Delta x) \\\\ i \\sin(\\kappa \\Delta x)  \\cos(\\kappa \\Delta x) \\end{pmatrix}\n$$\n算法流程如下：\n1. 在 $x_0 = -L_{\\text{left}}$ 处将旋量初始化为右行本征矢量：$\\psi(x_0) = u_+$。\n2. 计算入射流 $j_x^{\\text{in}} = v_F \\psi(x_0)^\\dagger \\sigma_x \\psi(x_0) = v_F$。\n3. 对每个网格区间 $[x_n, x_{n+1}]$ 顺序应用传播矩阵：$\\psi_{n+1} = M_n \\psi_n$。\n4. 在终点 $x_N = L_{\\text{right}}$ 处，计算输出流 $j_x^{\\text{out}} = v_F \\psi(x_N)^\\dagger \\sigma_x \\psi(x_N)$。\n5. 数值透射率为 $T_{\\text{num}} = j_x^{\\text{out}} / j_x^{\\text{in}}$。\n\n关键在于，传播矩阵 $M$ 与 $\\sigma_x$ 对易（即 $[M, \\sigma_x]=0$）。由于每个局域传播子 $M_n$ 都是幺正的（$M_n^\\dagger M_n = I$），总传播子 $M_{\\text{total}} = M_{N-1}...M_0$ 也是幺正的。输出流为：\n$$\nj_x^{\\text{out}} = v_F (M_{\\text{total}}\\psi(x_0))^\\dagger \\sigma_x (M_{\\text{total}}\\psi(x_0)) = v_F \\psi(x_0)^\\dagger M_{\\text{total}}^\\dagger \\sigma_x M_{\\text{total}} \\psi(x_0)\n$$\n由于 $M_{\\text{total}}$ 与 $\\sigma_x$ 对易，我们可以写出 $M_{\\text{total}}^\\dagger \\sigma_x M_{\\text{total}} = M_{\\text{total}}^\\dagger M_{\\text{total}} \\sigma_x = I \\sigma_x = \\sigma_x$。这导致：\n$$\nj_x^{\\text{out}} = v_F \\psi(x_0)^\\dagger \\sigma_x \\psi(x_0) = j_x^{\\text{in}}\n$$\n因此，如果实现正确，数值方法也必须得出 $T_{\\text{num}} = 1$。\n\n#### 结论\n问题陈述中规定的解析方法和数值方法都正确地模拟了垂直入射下克莱因隧穿的完美透射特性。最终计算出的差值 $\\Delta T = |T_{\\text{num}} - T_{\\text{step}}|$ 应该小到可以忽略不计，仅受浮点精度误差的限制。程序实现将证明这种一致性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute difference between numerically calculated and\n    analytically derived transmission coefficients for massless Dirac\n    fermions across a 1D potential step in graphene.\n    \"\"\"\n\n    # Physical Constants\n    V_F = 1.0e6  # Fermi velocity in m/s\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J*s\n    Q_E = 1.602176634e-19  # Elementary charge in C\n\n    # Test cases: (E_eV, V0_eV, L_left_m, L_right_m, dx_m)\n    test_cases = [\n        (0.1, 0.2, 1.0e-8, 1.0e-8, 1.0e-10),\n        (0.1, 0.0, 1.0e-8, 1.0e-8, 1.0e-10),\n        (0.1, 0.1, 1.0e-8, 1.0e-8, 1.0e-10),\n        (0.4, 0.2, 1.5e-8, 1.5e-8, 1.0e-10),\n        (0.0, 0.2, 1.0e-8, 1.0e-8, 1.0e-10),\n    ]\n\n    results = []\n    \n    # Pauli matrix sigma_x\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=np.complex128)\n    \n    # Right-moving eigenvector u_+ of sigma_x (eigenvalue +1)\n    u_plus = (1 / np.sqrt(2)) * np.array([1, 1], dtype=np.complex128)\n\n    for E_eV, V0_eV, L_left, L_right, dx in test_cases:\n        # 1. Analytical Solution (T_step)\n        # Solve the boundary condition system:\n        # u+ + r*u- = t*u+\n        # This leads to the linear system:\n        # 1*r - 1*t = -1\n        # -1*r - 1*t = -1\n        # which can be solved for r and t.\n        A = np.array([[1, -1], [-1, -1]], dtype=float)\n        b = np.array([-1, -1], dtype=float)\n        try:\n            r, t = np.linalg.solve(A, b)\n            T_step = np.abs(t)**2\n        except np.linalg.LinAlgError:\n            # This case should not be reached for a well-posed system.\n            T_step = np.nan\n\n        # 2. Numerical Solution (T_num)\n        \n        # Convert energies to Joules\n        E_J = E_eV * Q_E\n        V0_J = V0_eV * Q_E\n        \n        # Set up the spatial grid\n        # Add a small epsilon to include the right endpoint\n        x_grid = np.arange(-L_left, L_right + dx/2, dx)\n        num_points = len(x_grid)\n        \n        # Define the potential on the grid\n        V_grid = np.zeros_like(x_grid)\n        V_grid[x_grid >= 0] = V0_J\n        \n        # Wavevector kappa(x)\n        kappa_grid = (E_J - V_grid) / (HBAR * V_F)\n        \n        # Initialize the spinor on the far left\n        psi_current = np.copy(u_plus)\n        \n        # Calculate incident current at x = -L_left\n        j_in = V_F * np.real(psi_current.conj().T @ sigma_x @ psi_current)\n\n        # Propagate the spinor across the grid\n        for i in range(num_points - 1):\n            kappa_i = kappa_grid[i]\n            theta = kappa_i * dx\n            cos_theta = np.cos(theta)\n            sin_theta = np.sin(theta)\n            \n            # Propagator matrix M = cos(theta)*I + i*sin(theta)*sigma_x\n            M = np.array([\n                [cos_theta, 1j * sin_theta],\n                [1j * sin_theta, cos_theta]\n            ], dtype=np.complex128)\n            \n            psi_current = M @ psi_current\n            \n        # Final spinor at x = L_right\n        psi_out = psi_current\n        \n        # Calculate transmitted current at x = L_right\n        j_out = V_F * np.real(psi_out.conj().T @ sigma_x @ psi_out)\n        \n        # Calculate numerical transmission, handle potential division by zero\n        if np.isclose(j_in, 0):\n            T_num = 0.0 if np.isclose(j_out, 0) else np.inf\n        else:\n            T_num = j_out / j_in\n\n        # 3. Compute absolute difference\n        delta_T = np.abs(T_num - T_step)\n        results.append(delta_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}