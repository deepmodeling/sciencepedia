{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨了狄拉克半金属与魏尔半金属之间的基本关系。通过从一个狄拉克哈密顿量出发，并引入一个破坏反演对称性的项，你将亲眼见证一个四重简并的狄拉克点如何分裂成两个独立的外尔点。这个练习对于理解魏尔点是这些拓扑材料中稳定且基本的构成单元，以及晶体对称性如何支配它们的存在至关重要。",
            "id": "4312413",
            "problem": "考虑一个狄拉克半金属在单个狄拉克点附近的低能四带模型。与能带理论和晶体对称性一致的最小有效哈密顿量在手性基下可以表示为\n$$\nH_{0}(\\mathbf{k}) \\,=\\, v\\,\\tau_{z}\\otimes\\big(\\boldsymbol{\\sigma}\\cdot \\mathbf{k}\\big),\n$$\n其中 $\\mathbf{k}=(k_{x},k_{y},k_{z})$ 是相对于狄拉克点测量的晶格动量，$v$ 是一个正的费米速度（为简单起见，假设其为各向同性），$\\boldsymbol{\\sigma}=(\\sigma_{x},\\sigma_{y},\\sigma_{z})$ 是作用在（赝）自旋子空间上的泡利矩阵，$\\tau_{z}$ 是作用在手性（节点）子空间上的泡利矩阵，它将两个相反手性的魏尔块组合成一个狄拉克点。空间反演对称性由幺正算符 $P=\\tau_{x}\\otimes \\mathbb{I}_{2}$ 实现，使得 $P\\,H_{0}(-\\mathbf{k})\\,P^{-1}=H_{0}(\\mathbf{k})$。时间反演对称性由 $T=(\\mathbb{I}_{2}\\otimes i\\sigma_{y})\\,K$ 实现，其中 $K$ 表示复共轭，因此有 $T\\,H_{0}(-\\mathbf{k})\\,T^{-1}=H_{0}(\\mathbf{k})$。\n\n现在考虑一个小的破坏空间反演对称性的微扰，该微扰在手性和自旋上是对角的，且正比于一个矩阵 $\\Gamma_{15}$，在此基下定义为\n$$\n\\Gamma_{15}\\equiv \\tau_{z}\\otimes \\mathbb{I}_{2},\n$$\n因此，完整的哈密顿量为\n$$\nH(\\mathbf{k}) \\,=\\, H_{0}(\\mathbf{k}) \\,+\\, b_{0}\\,\\Gamma_{15}\n\\,=\\, \\tau_{z}\\otimes \\Big(v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big),\n$$\n其中 $b_{0}\\ge 0$ 是一个实常数，用于参数化空间反演破缺的强度，并具有能量的量纲。\n\n从这些定义和对称性实现出发，完成以下任务：\n- 验证微扰 $b_{0}\\,\\Gamma_{15}$ 破坏了空间反演对称性，同时保持了时间反演对称性。\n- 对角化 $H(\\mathbf{k})$ 以获得能谱，确定两个魏尔节点顶点（在 $\\mathbf{k}=\\mathbf{0}$ 处的能带接触点）的能量，并确定由 $b_{0}\\,\\Gamma_{15}$ 引起的外尔节点之间的能量分离。\n- 从能带结构的角度简要阐述，在零磁场下和弱静磁场下，由相反手性的魏尔锥之间的能量偏移导致的一个可观测后果。不要使用高级的“快捷”公式。你的推理应基于布洛赫能带理论和朗道量子化的标准事实。\n\n将能量分离以 $b_{0}$ 的单个闭式解析表达式的形式报告。最终的方框答案中不要包含单位。无需四舍五入。",
            "solution": "该问题提出了一个狄拉克半金属的低能有效哈密顿量，并要求分析其在破坏空间反演对称性的微扰下的性质。任务是验证受扰动哈密顿量的对称性，确定能谱和产生的魏尔节点之间的能量分离，并描述这种能量分离的两个可观测后果。\n\n首先，我们验证问题的有效性。\n- **提取的已知条件**：\n  - 未受扰动的哈密顿量：$H_{0}(\\mathbf{k}) = v\\,\\tau_{z}\\otimes\\big(\\boldsymbol{\\sigma}\\cdot \\mathbf{k}\\big)$\n  - 完整哈密顿量：$H(\\mathbf{k}) = H_{0}(\\mathbf{k}) + b_{0}\\,\\Gamma_{15} = \\tau_{z}\\otimes \\Big(v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big)$\n  - 微扰参数：$b_{0}\\ge 0$\n  - 空间反演算符：$P=\\tau_{x}\\otimes \\mathbb{I}_{2}$\n  - 空间反演对称性条件：$P\\,H(-\\mathbf{k})\\,P^{-1}=H(\\mathbf{k})$\n  - 时间反演算符：$T=(\\mathbb{I}_{2}\\otimes i\\sigma_{y})\\,K$\n  - 时间反演对称性条件：$T\\,H(-\\mathbf{k})\\,T^{-1}=H(\\mathbf{k})$\n\n- **验证**：该问题具有科学依据，描述了从狄拉克半金属到魏尔半金属转变的标准教科书模型。算符和对称性在凝聚态物理的背景下定义正确。该问题是自洽的、客观的、适定的，要求从给定模型中推导出具体结果。因此，该问题被认为是有效的。\n\n我们现在按顺序解决这三个任务。\n\n**1. 对称性分析**\n\n我们根据空间反演和时间反演对称性条件来检验完整的哈密顿量 $H(\\mathbf{k})$。\n\n- **空间反演对称性**：我们将空间反演变换应用于 $H(\\mathbf{k})$。首先，我们计算 $H$ 在 $-\\mathbf{k}$ 处的值：\n$$\nH(-\\mathbf{k}) = \\tau_{z}\\otimes \\Big(v\\,\\boldsymbol{\\sigma}\\cdot (-\\mathbf{k}) + b_{0}\\,\\mathbb{I}_{2}\\Big) = \\tau_{z}\\otimes \\Big(-v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big)\n$$\n现在，我们用空间反演算符 $P=\\tau_x\\otimes \\mathbb{I}_2$ 进行相似变换。我们利用泡利矩阵反对易的事实，即 $\\{\\tau_x, \\tau_z\\} = 0$，这意味着 $\\tau_x \\tau_z = -\\tau_z \\tau_x$。由于 $\\tau_x^{-1} = \\tau_x$，我们有 $\\tau_x \\tau_z \\tau_x^{-1} = -\\tau_z$。\n$$\nP\\,H(-\\mathbf{k})\\,P^{-1} = (\\tau_{x}\\otimes \\mathbb{I}_{2})\\left[\\tau_{z}\\otimes \\Big(-v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big)\\right](\\tau_{x}\\otimes \\mathbb{I}_{2})^{-1}\n$$\n利用性质 $(A\\otimes B)(C\\otimes D) = (AC\\otimes BD)$，这变为：\n$$\nP\\,H(-\\mathbf{k})\\,P^{-1} = (\\tau_x \\tau_z \\tau_x^{-1}) \\otimes \\left(\\mathbb{I}_2 \\Big[-v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big] \\mathbb{I}_2^{-1}\\right)\n$$\n$$\n= (-\\tau_z) \\otimes \\Big(-v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big) = \\tau_z \\otimes \\Big(v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} - b_{0}\\,\\mathbb{I}_{2}\\Big)\n$$\n$$\n= H_0(\\mathbf{k}) - b_0\\,\\tau_z \\otimes \\mathbb{I}_2\n$$\n这个结果不等于原始的完整哈密顿量 $H(\\mathbf{k}) = H_0(\\mathbf{k}) + b_0\\,\\tau_z \\otimes \\mathbb{I}_2$，除非 $b_{0}=0$。因此，微扰项 $b_{0}\\,\\Gamma_{15}$ 破坏了空间反演对称性。\n\n- **时间反演对称性**：时间反演算符 $T = \\mathcal{U}K$（其中 $\\mathcal{U} = \\mathbb{I}_2 \\otimes i\\sigma_y$）作用于哈密顿量 $H(\\mathbf{k})$ 的方式为 $T\\,H(\\mathbf{k})\\,T^{-1} = \\mathcal{U} H(\\mathbf{k})^* \\mathcal{U}^{-1}$。对称性条件是 $T\\,H(-\\mathbf{k})\\,T^{-1}=H(\\mathbf{k})$。我们计算左侧：\n$$\nT\\,H(-\\mathbf{k})\\,T^{-1} = (\\mathbb{I}_2 \\otimes i\\sigma_y) \\left[H(-\\mathbf{k})\\right]^* (\\mathbb{I}_2 \\otimes i\\sigma_y)^{-1}\n$$\n首先，我们求 $H(-\\mathbf{k})$ 的复共轭。注意 $\\tau_z$、$\\sigma_x$、$\\sigma_z$、$b_0$ 和 $v$ 都是实的，而 $\\sigma_y$ 是纯虚数。\n$$\nH(-\\mathbf{k})^* = \\left[\\tau_z \\otimes (-v\\,\\boldsymbol{\\sigma}\\cdot\\mathbf{k} + b_0\\,\\mathbb{I}_2)\\right]^* = \\tau_z^* \\otimes (-v(\\boldsymbol{\\sigma}\\cdot\\mathbf{k})^* + b_0\\,\\mathbb{I}_2) = \\tau_z \\otimes (-v\\,\\boldsymbol{\\sigma}^*\\cdot\\mathbf{k} + b_0\\,\\mathbb{I}_2)\n$$\n我们现在使用 $\\mathcal{U} = \\mathbb{I}_2 \\otimes i\\sigma_y$ 和 $\\mathcal{U}^{-1} = \\mathbb{I}_2 \\otimes (-i\\sigma_y)$ 进行相似变换。\n$$\nT\\,H(-\\mathbf{k})\\,T^{-1} = \\tau_z \\otimes \\left[ (i\\sigma_y)(-v\\,\\boldsymbol{\\sigma}^*\\cdot\\mathbf{k} + b_0\\,\\mathbb{I}_2)(-i\\sigma_y) \\right]\n$$\n$$\n= \\tau_z \\otimes \\left[ -v\\,\\sigma_y(\\boldsymbol{\\sigma}^*\\cdot\\mathbf{k})\\sigma_y + b_0\\,\\sigma_y\\mathbb{I}_2\\sigma_y \\right]\n$$\n我们使用标准恒等式 $\\sigma_y \\boldsymbol{\\sigma}^* \\sigma_y = -\\boldsymbol{\\sigma}$。第二项是 $b_0\\,\\sigma_y^2 = b_0\\,\\mathbb{I}_2$。\n$$\nT\\,H(-\\mathbf{k})\\,T^{-1} = \\tau_z \\otimes \\left[ -v\\,(-\\boldsymbol{\\sigma}\\cdot\\mathbf{k}) + b_0\\,\\mathbb{I}_2 \\right] = \\tau_z \\otimes \\Big(v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big) = H(\\mathbf{k})\n$$\n对称性条件得到满足。哈密顿量 $H(\\mathbf{k})$ 保持时间反演对称性。这证实了微扰破坏了空间反演对称性，同时保持了时间反演对称性。\n\n**2. 对角化和能量分离**\n\n哈密顿量 $H(\\mathbf{k}) = \\tau_{z}\\otimes \\Big(v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}\\Big)$ 在 $\\tau_z$ 的本征矢量基中是块对角的。设 $\\tau_z$ 的本征值为 $\\chi=\\pm 1$，代表两种手性。哈密顿量分离为两个 $2\\times 2$ 的块：\n$$\nH_{\\chi}(\\mathbf{k}) = \\chi \\left( v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2} \\right)\n$$\n标准魏尔哈密顿量 $v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k}$ 的本征值为 $\\pm v |\\mathbf{k}|$。项 $b_0 \\mathbb{I}_2$ 只是对能量进行平移。\n- 对于正手性块 ($\\chi=+1$):\n  $$H_{+}(\\mathbf{k}) = v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2}$$\n  本征值为 $E_{+}(\\mathbf{k}) = b_0 \\pm v|\\mathbf{k}|$。这两条能带在 $\\mathbf{k}=\\mathbf{0}$ 处接触，形成一个能量为 $E_{node,+} = b_0$ 的魏尔节点。\n- 对于负手性块 ($\\chi=-1$):\n  $$H_{-}(\\mathbf{k}) = - (v\\,\\boldsymbol{\\sigma}\\cdot \\mathbf{k} + b_{0}\\,\\mathbb{I}_{2})$$\n  本征值为 $E_{-}(\\mathbf{k}) = -b_0 \\pm v|\\mathbf{k}|$。这两条能带在 $\\mathbf{k}=\\mathbf{0}$ 处接触，形成第二个能量为 $E_{node,-} = -b_0$ 的魏尔节点。\n\n原始在 $E=0$ 和 $\\mathbf{k}=\\mathbf{0}$ 处的四重简并狄拉克点被微扰分裂成两个不同的魏尔节点。两个节点都保持在 $\\mathbf{k}=\\mathbf{0}$，但在能量上分开了。\n两个魏尔节点顶点之间的能量分离 $\\Delta E$ 为：\n$$\n\\Delta E = |E_{node,+} - E_{node,-}| = |b_0 - (-b_0)| = |2b_0|\n$$\n由于问题说明 $b_0 \\ge 0$，分离值就是 $2b_0$。\n\n**3. 可观测后果**\n\n$2b_0$ 的能量偏移在相反手性的魏尔锥之间产生了直接的物理后果。\n\n- **在零磁场下**：能量偏移为光学吸收创造了一个新的阈值。假设费米能级在电荷中性点（$E_F=0$），价带被占据，导带为空。直接光学跃迁可以从负手性锥的最高价带（能量 $E=-b_0-v|\\mathbf{k}|$) 跃迁到正手性锥的最低导带（能量 $E=b_0+v|\\mathbf{k}|$)。对于垂直跃迁（$\\Delta\\mathbf{k} \\approx 0$），所需的光子能量为 $\\hbar\\omega = (b_0+v|\\mathbf{k}|) - (-b_0-v|\\mathbf{k}|) = 2b_0 + 2v|\\mathbf{k}|$。这种锥间跃迁的最小能量发生在 $\\mathbf{k}=\\mathbf{0}$ 处，在 $\\hbar\\omega = 2b_0$ 处产生一个尖锐的吸收边或光学电导谱中的一个新特征。\n\n- **在弱静磁场下**：能量偏移导致了不同的量子振荡频率。当施加磁场 $\\mathbf{B}$ 时，电子轨道被量子化为朗道能级。磁振荡（例如Shubnikov-de Haas (SdH) 效应）的频率与垂直于 $\\mathbf{B}$ 的费米面的极值截面积成正比。如果材料被掺杂，使得费米能级 $E_F$ 与两个魏尔锥的导带相交（例如，$E_F > b_0$），则会存在两个不同的费米面。它们的半径由 $E_F = b_0 + v k_F^{+}$ 和 $E_F = -b_0 + v k_F^{-}$ 给出。这得到 $k_F^{+} = (E_F - b_0)/v$ 和 $k_F^{-} = (E_F + b_0)/v$。相应的费米面截面积 $A_F^{\\pm} = \\pi (k_F^{\\pm})^2$ 是不同的。因此，SdH 测量将揭示两个不同的振荡频率，$F_{\\pm} \\propto A_F^{\\pm}$。观察到两个频率（通常在磁阻对 $1/B$ 的图像中表现为“拍频”图案）是两种不同大小的费米面共存的直接测量，而这是魏尔锥之间能量偏移 $2b_0$ 的直接后果。\n\n问题要求以单个闭式表达式给出能量分离。根据我们的对角化，这个值是 $2b_0$。",
            "answer": "$$\\boxed{2b_0}$$"
        },
        {
            "introduction": "并非所有的魏尔点都完全相同；它们的能量色散可以是“倾斜的”。本练习将介绍I型和II型魏尔半金属之间的区别，这是现代研究中的一个关键分类。你将推导出区分这两个相的数学条件，从而揭示魏尔锥的倾斜如何能极大地改变费米面，使其从一个点变为开放的电子和空穴口袋。",
            "id": "4312406",
            "problem": "考虑一个三维晶体中的单个魏尔节点，其低能哈密顿量为 $H_{0}(\\mathbf{q})=\\sum_{i=x,y,z} v_{i}\\, q_{i}\\, \\sigma_{i}$，其中 $\\sigma_{i}$ 是 Pauli 矩阵，$\\sigma_{0}$ 是 $2\\times 2$ 单位矩阵，$\\mathbf{q}=(q_{x},q_{y},q_{z})$ 是相对于该节点的晶体动量，而 $v_{i}>0$ 是沿晶体主轴的各向异性费米速度。一个普遍的晶体场或对称性允许的倾斜会引入一项 $H_{t}(\\mathbf{q})=\\mathbf{w}\\cdot \\mathbf{q}\\,\\sigma_{0}$，其中 $\\mathbf{w}=(w_{x},w_{y},w_{z})$ 是一个常矢量，从而得到完整的双带哈密顿量 $H(\\mathbf{q})=H_{t}(\\mathbf{q})+H_{0}(\\mathbf{q})$。\n\n仅从以下事实出发：形式为 $a(\\mathbf{q})\\,\\sigma_{0}+\\mathbf{b}(\\mathbf{q})\\cdot\\boldsymbol{\\sigma}$ 的哈密顿量，其能量本征值为 $E_{\\pm}(\\mathbf{q})=a(\\mathbf{q})\\pm |\\mathbf{b}(\\mathbf{q})|$；并且能量 $E=0$ 处的费米面由满足 $E_{\\pm}(\\mathbf{q})=0$ 的 $\\mathbf{q}$ 的轨迹所定义。请完成以下任务：\n\n- 从第一性原理出发，推导区分点状费米面（I 型锥）与开放电子-空穴口袋费米面（II 型锥）的条件，该条件取决于对于单位矢量 $\\mathbf{n}$，倾斜项 $|\\mathbf{w}\\cdot \\mathbf{n}|$ 和手性项 $\\sqrt{(v_{x} n_{x})^{2}+(v_{y} n_{y})^{2}+(v_{z} n_{z})^{2}}$ 之间的大小关系。\n- 将无量纲倾斜强度 $R$ 定义为极值比率 $R \\equiv \\sup_{\\mathbf{n}\\neq \\mathbf{0}} \\dfrac{|\\mathbf{w}\\cdot \\mathbf{n}|}{\\sqrt{(v_{x} n_{x})^{2}+(v_{y} n_{y})^{2}+(v_{z} n_{z})^{2}}}$，并使用变分法推导，以得到用 $w_{x},w_{y},w_{z}$ 和 $v_{x},v_{y},v_{z}$ 表示的 $R$ 的闭合表达式。\n- 利用你的结果，论证 $|\\mathbf{w}|  v_{\\min}$ 是锥体为 I 型的充分条件，而 $|\\mathbf{w}| > v_{\\max}$ 是锥体为 II 型的充分条件，其中 $v_{\\min} = \\min\\{v_{x}, v_{y}, v_{z}\\}$，$v_{\\max} = \\max\\{v_{x}, v_{y}, v_{z}\\}$。",
            "solution": "该问题提法恰当，具有科学依据，且内部一致。所有必要的定义和出发原则均已提供。我们可以开始求解。\n\n倾斜的魏尔节点的完整哈密顿量由 $H(\\mathbf{q})=H_{t}(\\mathbf{q})+H_{0}(\\mathbf{q})$ 给出。代入所提供的定义，我们有：\n$$H(\\mathbf{q}) = (\\mathbf{w}\\cdot \\mathbf{q})\\sigma_{0} + \\sum_{i=x,y,z} v_{i}\\, q_{i}\\, \\sigma_{i}$$\n该哈密顿量具有 $a(\\mathbf{q})\\,\\sigma_{0}+\\mathbf{b}(\\mathbf{q})\\cdot\\boldsymbol{\\sigma}$ 的一般形式，其中 $\\boldsymbol{\\sigma}=(\\sigma_x, \\sigma_y, \\sigma_z)$ 是 Pauli 矩阵的矢量。通过直接比较，我们确定标量部分 $a(\\mathbf{q})$ 和矢量部分 $\\mathbf{b}(\\mathbf{q})$：\n$$a(\\mathbf{q}) = \\mathbf{w}\\cdot \\mathbf{q} = w_{x}q_{x}+w_{y}q_{y}+w_{z}q_{z}$$\n$$\\mathbf{b}(\\mathbf{q}) = (v_{x}q_{x}, v_{y}q_{y}, v_{z}q_{z})$$\n问题陈述指明，此类哈密顿量的能量本征值为 $E_{\\pm}(\\mathbf{q})=a(\\mathbf{q})\\pm |\\mathbf{b}(\\mathbf{q})|$。代入我们已确定的项，可获得这两个能带的色散关系：\n$$E_{\\pm}(\\mathbf{q}) = \\mathbf{w}\\cdot \\mathbf{q} \\pm \\sqrt{(v_{x}q_{x})^{2}+(v_{y}q_{y})^{2}+(v_{z}q_{z})^{2}}$$\n能量 $E=0$ 处的费米面被定义为满足 $E_{+}(\\mathbf{q})=0$ 或 $E_{-}(\\mathbf{q})=0$ 的动量矢量 $\\mathbf{q}$ 的集合。这导出了以下条件：\n$$\\mathbf{w}\\cdot \\mathbf{q} \\pm \\sqrt{(v_{x}q_{x})^{2}+(v_{y}q_{y})^{2}+(v_{z}q_{z})^{2}} = 0$$\n$$\\implies (\\mathbf{w}\\cdot \\mathbf{q})^{2} = (v_{x}q_{x})^{2}+(v_{y}q_{y})^{2}+(v_{z}q_{z})^{2}$$\n这个方程描述了 $\\mathbf{q}$ 空间中的一个锥体。I 型和 II 型魏尔锥之间的区别取决于 $E=0$ 处费米面的结构。\n\nI 型锥对应于点状费米面，其中导带和价带仅在费米能级 $E=0$ 处的魏尔点 $\\mathbf{q}=\\mathbf{0}$ 相接触。这意味着对于任何非零动量 $\\mathbf{q} \\neq \\mathbf{0}$，两个能带的能量 $E_{+}(\\mathbf{q})$ 和 $E_{-}(\\mathbf{q})$ 必须同号（同为正或同为负）。因此，对于所有 $\\mathbf{q} \\neq \\mathbf{0}$，它们的乘积必须为正：\n$$E_{+}(\\mathbf{q})E_{-}(\\mathbf{q}) > 0 \\quad \\text{for all } \\mathbf{q} \\neq \\mathbf{0}$$\n计算该乘积：\n$$E_{+}(\\mathbf{q})E_{-}(\\mathbf{q}) = \\left(\\mathbf{w}\\cdot \\mathbf{q}\\right)^{2} - \\left(\\sqrt{(v_{x}q_{x})^{2}+(v_{y}q_{y})^{2}+(v_{z}q_{z})^{2}}\\right)^{2} = (\\mathbf{w}\\cdot \\mathbf{q})^{2} - \\sum_{i=x,y,z} (v_{i}q_{i})^{2}$$\n因此，对于 I 型锥，条件 $(\\mathbf{w}\\cdot \\mathbf{q})^{2} > \\sum_{i} (v_{i}q_{i})^{2}$ 是不被允许的；相反，必须满足：\n$$(\\mathbf{w}\\cdot \\mathbf{q})^{2}  \\sum_{i=x,y,z} (v_{i}q_{i})^{2} \\quad \\text{for all } \\mathbf{q} \\neq \\mathbf{0}$$\n\nII 型锥具有开放的电子和空穴口袋，这意味着导带和价带在有限动量处穿过 $E=0$ 能级，从而形成有限体积的费米面。如果存在至少一个 $\\mathbf{q}$ 空间方向，使得 $E_{+}(\\mathbf{q})$ 和 $E_{-}(\\mathbf{q})$ 异号，就会发生这种情况。这意味着对于某些 $\\mathbf{q} \\neq \\mathbf{0}$，它们的乘积为负：\n$$(\\mathbf{w}\\cdot \\mathbf{q})^{2} > \\sum_{i=x,y,z} (v_{i}q_{i})^{2} \\quad \\text{for some } \\mathbf{q} \\neq \\mathbf{0}$$\n\n为按方向分析这些条件，我们将动量矢量表示为 $\\mathbf{q} = q\\mathbf{n}$，其中 $q=|\\mathbf{q}|$ 是其模，$\\mathbf{n}=(n_x, n_y, n_z)$ 是一个单位矢量（$|\\mathbf{n}|=1$）。将此代入不等式中：\n$$(q\\,\\mathbf{w}\\cdot \\mathbf{n})^{2}  \\text{ or } > \\sum_{i} (v_{i}q n_{i})^{2}$$\n$$q^{2}(\\mathbf{w}\\cdot \\mathbf{n})^{2}  \\text{ or } > q^{2}\\sum_{i} (v_{i}n_{i})^{2}$$\n对于 $\\mathbf{q} \\neq \\mathbf{0}$（即 $q \\neq 0$），我们可以在不等式两边同除以 $q^{2}$ 而不改变不等号方向：\n$$(\\mathbf{w}\\cdot \\mathbf{n})^{2}  \\text{ or } > \\sum_{i} (v_{i}n_{i})^{2}$$\n对两边（均为非负）取平方根，得到方向性不等式：\n$$|\\mathbf{w}\\cdot \\mathbf{n}|  \\text{ or } > \\sqrt{(v_{x} n_{x})^{2}+(v_{y} n_{y})^{2}+(v_{z} n_{z})^{2}}$$\n如果对于所有单位矢量 $\\mathbf{n}$，左侧都严格小于右侧，则存在 I 型锥。如果对于至少一个单位矢量 $\\mathbf{n}$，左侧大于右侧，则存在 II 型锥。\n\n接下来，我们求解无量纲倾斜强度 $R$ 的闭合形式表达式：\n$$R \\equiv \\sup_{\\mathbf{n}\\neq \\mathbf{0}} \\frac{|\\mathbf{w}\\cdot \\mathbf{n}|}{\\sqrt{(v_{x} n_{x})^{2}+(v_{y} n_{y})^{2}+(v_{z} n_{z})^{2}}}$$\n由于该比率与 $\\mathbf{n}$ 的模无关，我们可以将上确界的范围限制在单位矢量 $|\\mathbf{n}|=1$ 上。为方便起见，我们转而最大化该比率的平方：\n$$R^{2} = \\sup_{|\\mathbf{n}|=1} \\frac{(\\mathbf{w}\\cdot \\mathbf{n})^{2}}{\\sum_{i} (v_{i} n_{i})^{2}}$$\n分子和分母都是关于 $\\mathbf{n}$ 各分量的二次型。我们可以将它们写成矩阵形式。设 $\\mathbf{n}$ 为列矢量。分子是 $(\\mathbf{n}^{T}\\mathbf{w})(\\mathbf{w}^{T}\\mathbf{n}) = \\mathbf{n}^{T}(\\mathbf{w}\\mathbf{w}^{T})\\mathbf{n}$。分母是 $\\mathbf{n}^{T} V^{2} \\mathbf{n}$，其中 $V = \\mathrm{diag}(v_{x}, v_{y}, v_{z})$，因此 $V^2 = \\mathrm{diag}(v_{x}^{2}, v_{y}^{2}, v_{z}^{2})$。\n$$R^{2} = \\sup_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{\\mathbf{n}^{T}(\\mathbf{w}\\mathbf{w}^{T})\\mathbf{n}}{\\mathbf{n}^{T}V^{2}\\mathbf{n}}$$\n这是广义瑞利商 (generalized Rayleigh quotient) 的最大值。该最大值由广义本征值问题 $A\\mathbf{x} = \\lambda B\\mathbf{x}$ 的最大本征值 $\\lambda_{\\max}$ 给出，其中 $A=\\mathbf{w}\\mathbf{w}^{T}$ 且 $B=V^{2}$。\n$$(\\mathbf{w}\\mathbf{w}^{T})\\mathbf{n} = \\lambda V^{2} \\mathbf{n}$$\n项 $\\mathbf{w}^{T}\\mathbf{n}$ 是一个标量。令 $c = \\mathbf{w}^{T}\\mathbf{n}$。方程变为 $c\\,\\mathbf{w} = \\lambda V^{2} \\mathbf{n}$。\n最大值不会在 $c=0$ 时出现，因为这对应于比值为 0 的最小值。假设 $c \\neq 0$ 和 $\\lambda \\neq 0$，我们可以解出 $\\mathbf{n}$：\n$$\\mathbf{n} = \\frac{c}{\\lambda}(V^{2})^{-1}\\mathbf{w}$$\n现在，我们将此结果代回到标量 $c$ 的定义中：\n$$c = \\mathbf{w}^{T}\\mathbf{n} = \\mathbf{w}^{T}\\left(\\frac{c}{\\lambda}(V^{2})^{-1}\\mathbf{w}\\right)$$\n因为 $c \\neq 0$，我们可以将两边同除以 $c$：\n$$1 = \\frac{1}{\\lambda} \\mathbf{w}^{T}(V^{2})^{-1}\\mathbf{w}$$\n解出本征值 $\\lambda$：\n$$\\lambda = \\mathbf{w}^{T}(V^{2})^{-1}\\mathbf{w}$$\n矩阵 $V^2$ 是对角矩阵，因此其逆矩阵为 $(V^{2})^{-1} = \\mathrm{diag}(v_{x}^{-2}, v_{y}^{-2}, v_{z}^{-2})$。执行矩阵乘法：\n$$\\lambda = (w_{x}, w_{y}, w_{z}) \\begin{pmatrix} v_{x}^{-2}  0  0 \\\\ 0  v_{y}^{-2}  0 \\\\ 0  0  v_{z}^{-2} \\end{pmatrix} \\begin{pmatrix} w_{x} \\\\ w_{y} \\\\ w_{z} \\end{pmatrix} = \\frac{w_{x}^{2}}{v_{x}^{2}} + \\frac{w_{y}^{2}}{v_{y}^{2}} + \\frac{w_{z}^{2}}{v_{z}^{2}}$$\n由于矩阵 $\\mathbf{w}\\mathbf{w}^{T}$ 的秩为 1，该问题只有一个非零本征值，因此它必定是最大值。所以，$R^{2} = \\lambda$。\n$$R^{2} = \\sum_{i=x,y,z} \\left(\\frac{w_{i}}{v_{i}}\\right)^{2}$$\n取平方根即得 $R$ 的表达式：\n$$R = \\sqrt{\\frac{w_{x}^{2}}{v_{x}^{2}} + \\frac{w_{y}^{2}}{v_{y}^{2}} + \\frac{w_{z}^{2}}{v_{z}^{2}}}$$\n\n最后，我们使用此结果来推导充分条件。\nI 型锥要求 $R1$。II 型锥要求 $R>1$。\n\n情况 1：假设 $|\\mathbf{w}|  v_{\\min}$，其中 $v_{\\min} = \\min\\{v_{x}, v_{y}, v_{z}\\}$。\n根据最小值的定义，对于所有 $i \\in \\{x,y,z\\}$，$v_{\\min} \\le v_{i}$。由于 $v_i>0$，这意味着 $v_{\\min}^{2} \\le v_{i}^{2}$，因此 $v_{i}^{-2} \\le v_{\\min}^{-2}$。\n我们可以确定 $R^{2}$ 的一个上界：\n$$R^{2} = \\sum_{i} \\frac{w_{i}^{2}}{v_{i}^{2}} \\le \\sum_{i} \\frac{w_{i}^{2}}{v_{\\min}^{2}} = \\frac{1}{v_{\\min}^{2}} \\sum_{i} w_{i}^{2} = \\frac{|\\mathbf{w}|^{2}}{v_{\\min}^{2}}$$\n根据假设 $|\\mathbf{w}|  v_{\\min}$，可以得出 $\\frac{|\\mathbf{w}|}{v_{\\min}}  1$，因此 $\\frac{|\\mathbf{w}|^{2}}{v_{\\min}^{2}}  1$。\n综合这些结果，我们发现 $R^{2}  1$，这意味着 $R  1$。这是 I 型锥的条件。因此，$|\\mathbf{w}|  v_{\\min}$ 是锥为 I 型的充分条件。\n\n情况 2：假设 $|\\mathbf{w}| > v_{\\max}$，其中 $v_{\\max} = \\max\\{v_{x}, v_{y}, v_{z}\\}$。\n根据最大值的定义，对于所有 $i \\in \\{x,y,z\\}$，$v_{\\max} \\ge v_{i}$。这意味着 $v_{\\max}^{2} \\ge v_{i}^{2}$，因此 $v_{i}^{-2} \\ge v_{\\max}^{-2}$。\n我们可以确定 $R^{2}$ 的一个下界：\n$$R^{2} = \\sum_{i} \\frac{w_{i}^{2}}{v_{i}^{2}} \\ge \\sum_{i} \\frac{w_{i}^{2}}{v_{\\max}^{2}} = \\frac{1}{v_{\\max}^{2}} \\sum_{i} w_{i}^{2} = \\frac{|\\mathbf{w}|^{2}}{v_{\\max}^{2}}$$\n根据假设 $|\\mathbf{w}| > v_{\\max}$，可以得出 $\\frac{|\\mathbf{w}|}{v_{\\max}} > 1$，因此 $\\frac{|\\mathbf{w}|^{2}}{v_{\\max}^{2}} > 1$。\n综合这些结果，我们发现 $R^{2} > 1$，这意味着 $R > 1$。这是 II 型锥的条件。因此，$|\\mathbf{w}| > v_{\\max}$ 是锥为 II 型的充分条件。\n所要求的最终答案是推导出的 $R$ 的表达式。",
            "answer": "$$\\boxed{\\sqrt{\\frac{w_{x}^{2}}{v_{x}^{2}} + \\frac{w_{y}^{2}}{v_{y}^{2}} + \\frac{w_{z}^{2}}{v_{z}^{2}}}}$$"
        },
        {
            "introduction": "魏尔半金属的标志性特征是其体-边对应关系，具体表现为奇特的费米弧表面态。本计算实践将指导你实现一种表面格林函数方法，用以计算一个格点模型的表面谱函数。这项强大的技术使你能够可视化费米弧，并从数值上验证它们连接体态魏尔点投影的作用，从而将抽象的拓扑理论与具体的、可观测的信号联系起来。",
            "id": "5306014",
            "problem": "考虑一个定义在简单立方晶格上的魏尔半金属双带紧束缚格点模型。三维布洛赫哈密顿量由函数向量 $\\mathbf{d}(\\mathbf{k}) = (d_x(\\mathbf{k}), d_y(\\mathbf{k}), d_z(\\mathbf{k}))$ 指定为 $H(\\mathbf{k}) = d_x(\\mathbf{k}) \\sigma_x + d_y(\\mathbf{k}) \\sigma_y + d_z(\\mathbf{k}) \\sigma_z$，其中 $\\sigma_x$、$\\sigma_y$ 和 $\\sigma_z$ 是泡利矩阵，$\\mathbf{k} = (k_x, k_y, k_z)$。在本问题中，您将把系统视为沿 $z$ 方向半无限（一个半无限平板），并在由 $\\mathbf{k}_{\\parallel} = (k_x, k_y)$ 定义的平行于表面的平面内具有平移不变性。该模型由以下公式指定：\n$$\nd_x(\\mathbf{k}) = t_x \\sin(k_x), \\quad d_y(\\mathbf{k}) = t_y \\sin(k_y), \\quad d_z(\\mathbf{k}) = m - t_{xy} \\left[\\cos(k_x) + \\cos(k_y)\\right] - t_z \\cos(k_z).\n$$\n为了表示半无限几何结构，沿 $z$ 方向进行傅里葉变换，并将问题写成一个由相同层组成的一维链，其在位 $2 \\times 2$ 矩阵 $H_0(\\mathbf{k}_{\\parallel})$ 和最近邻层间跃迁 $T$ 由以下公式给出：\n$$\nH_0(\\mathbf{k}_{\\parallel}) = t_x \\sin(k_x)\\,\\sigma_x + t_y \\sin(k_y)\\,\\sigma_y + \\left[m - t_{xy}(\\cos(k_x)+\\cos(k_y))\\right]\\,\\sigma_z,\\quad T = -\\frac{t_z}{2}\\,\\sigma_z.\n$$\n对于固定的面内动量 $\\mathbf{k}_{\\parallel}$，半无限链顶层在能量为 $\\omega$ 且具有一个小的正展宽 $\\eta$ 时的推迟表面格林函数是矩阵：\n$$\nG_{\\mathrm{surf}}(\\mathbf{k}_{\\parallel},\\omega) = \\left[(\\omega + i\\eta)\\,I - H_0(\\mathbf{k}_{\\parallel}) - \\Sigma(\\mathbf{k}_{\\parallel},\\omega)\\right]^{-1},\n$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵，$\\Sigma(\\mathbf{k}_{\\parallel},\\omega)$ 是通过迭代表面格林函数方法（对块三对角链进行抽取）从与半无限体的耦合中获得的自能。表面谱函数定义为：\n$$\nA(\\mathbf{k}_{\\parallel},\\omega) = -\\frac{1}{\\pi}\\,\\operatorname{Im}\\,\\operatorname{Tr}\\,G_{\\mathrm{surf}}(\\mathbf{k}_{\\parallel},\\omega).\n$$\n您的任务是实现迭代表面格林函数方法，在表面布里淵区的均匀网格上计算 $\\omega = 0$（费米能级）时的 $A(\\mathbf{k}_{\\parallel},\\omega)$，并算法上识别出费米弧。费米弧是 $A(\\mathbf{k}_{\\parallel},0)$ 中连接体态魏尔节点（体能隙闭合的解 $(k_x,k_y,k_z)$）在表面布里淵区中投影的连通高强度轨迹。角度必须以弧度处理。除这些规范外，不需要任何物理单位。\n\n从推迟格林函数和谱函数的基本定义出发，并基于经过充分检验的半无限块三对角系统的迭代抽取原理。不要假设或使用特定于魏尔半金属的预先推导的快捷公式；您的表面格林函数计算方法应从这些基础推导得出。\n\n实现以下内容：\n\n1. 对每个测试用例，根据指定参数构建 $H_0(\\mathbf{k}_{\\parallel})$ 和 $T$，使用迭代抽取方法计算 $G_{\\mathrm{surf}}(\\mathbf{k}_{\\parallel},\\omega)$ 直至收敛，并在一个均匀跨越 $k_x,k_y \\in [-\\pi,\\pi)$ 的 $N_k \\times N_k$ $\\mathbf{k}_{\\parallel}$ 网格上计算 $A(\\mathbf{k}_{\\parallel},\\omega)$。\n\n2. 通过检查条件 $\\sin(k_x)=0$、$\\sin(k_y)=0$ 和 $\\left|[m - t_{xy}(\\cos(k_x)+\\cos(k_y))]/t_z\\right| \\le 1$（对于 $(k_x,k_y) \\in \\{0,\\pi\\}\\times\\{0,\\pi\\}$）并求解 $\\cos(k_z) = [m - t_{xy}(\\cos(k_x)+\\cos(k_y))]/t_z$ 以获得 $k_z$ 来确定体态魏尔节点在表面布里淵区上的投影。表面投影是那些允许实数 $k_z$ 解的 $(k_x,k_y)$ 对。\n\n3. 通过对 $A(\\mathbf{k}_{\\parallel},0)$ 进行阈值化以获得高强度点的二值掩码（使用一个数据驱动的阈值，例如高百分位数，选择该阈值以保证在所有测试用例中都具有鲁棒性），并检测此掩码内是否存在连接不同投影魏尔节点位置的连通路径，从而识别费米弧。在 $\\mathbf{k}_{\\parallel}$ 网格上使用四邻域连通性，并采用与表面布里淵区一致的周期性边界条件。\n\n您的程序应处理以下测试套件，并生成单行输出，其中包含一个逗号分隔的布尔值Python列表，指示每个用例是否检测到至少一条连接不同投影魏尔节点的费米弧：\n\n- 测试用例 1（具有清晰分离的投影节点的通用魏尔半金属）：$t_x = 1.0$，$t_y = 1.0$，$t_{xy} = 1.0$，$t_z = 1.0$，$m = 0.5$，$\\eta = 0.01$，$N_k = 41$，$\\omega = 0$。\n- 测试用例 2（拓扑平凡情况）：$t_x = 1.0$，$t_y = 1.0$，$t_{xy} = 1.0$，$t_z = 1.0$，$m = 3.0$，$\\eta = 0.01$，$N_k = 41$，$\\omega = 0$。\n- 测试用例 3（具有更强展宽的近临界情况）：$t_x = 1.0$，$t_y = 1.0$，$t_{xy} = 1.0$，$t_z = 1.0$，$m = 1.0$，$\\eta = 0.05$，$N_k = 41$，$\\omega = 0$。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，“[True,False,True]”），并且不得打印任何其他文本。角度以弧度为单位，所有计算均无单位。最终答案必须是布尔值。",
            "solution": "该问题要求计算一个魏尔半金属模型的表面谱特性，并随后通过算法识别费米弧。这是一个多步计算物理问题，它结合了凝聚态理论的概念和数值算法。\n\n### 基于原理的解决方案设计\n\n该解决方案基于以下物理原理和数值方法构建：\n\n1.  **半无限系统与格林函数**：该系统是一个在 $xy$ 平面无限延伸但在 $z$ 方向上半無限的立方晶格（一个厚板）。由于在 $xy$ 平面内具有平移不变性，动量 $\\mathbf{k}_{\\parallel} = (k_x, k_y)$ 是一个好量子数。因此，该系统可以被视为沿 $z$ 方向的一维层状链，其中每一层由一个 $2 \\times 2$ 的矩阵哈密顿量 $H_0(\\mathbf{k}_{\\parallel})$ 描述，并通过跃迁矩阵 $T$ 与其邻居耦合。对于给定的 $\\mathbf{k}_{\\parallel}$，完整的哈密顿量在层索引基中是一个块三对角矩阵。\n\n2.  **迭代表面格林函数（抽取方法）**：表面层的性质由表面格林函数 $G_{\\mathrm{surf}}$ 捕捉。这是完整格林函数矩阵 $G = [(\\omega+i\\eta)I - H]^{-1}$ 的 $(0,0)$ 块。利用矩阵分块法，可以证明表面格林函数由下式给出：\n    $$\n    G_{\\mathrm{surf}}(\\mathbf{k}_{\\parallel},\\omega) = \\left[(\\omega + i\\eta)I - H_0(\\mathbf{k}_{\\parallel}) - \\Sigma(\\mathbf{k}_{\\parallel},\\omega)\\right]^{-1}\n    $$\n    在这里，$\\Sigma(\\mathbf{k}_{\\parallel},\\omega)$ 是自能，它包含了整个半无限体（所有索引 $z>0$ 的层）对表面层（$z=0$）的影响。自能源于到下一层的耦合 $T$。由于链在 $z \\ge 0$ 区域的平移对称性，自能必须满足以下自洽非线性矩阵方程：\n    $$\n    \\Sigma = T \\left[ (\\omega + i\\eta)I - H_0 - \\Sigma \\right]^{-1} T^\\dagger\n    $$\n    这个方程是通过注意到第 0 层的自能是到第 1 层的跃迁 $T$，乘以第 1 层的格林函数（现在是剩余链的“表面”），再乘以返回跃遷 $T^\\dagger$ 得出的。由于剩余的链与原始链相同，其表面格林函数具有相同的形式。\n    该方程通过迭代进行数值求解，这是一种抽取形式。从初始猜测 $\\Sigma_0 = 0$（一个未耦合的表面层）开始，我们进行迭代：\n    $$\n    \\Sigma_{n+1} = T \\left[ (\\omega + i\\eta)I - H_0 - \\Sigma_n \\right]^{-1} T^\\dagger\n    $$\n    这个迭代过程一直进行到 $\\Sigma_n$ 收敛，即直到连续迭代之间的变化小于一个小的容差。小的虚部 $\\eta > 0$ 确保矩阵是可逆的并且迭代收敛。\n\n3.  **表面谱函数**：表面的局域态密度由表面谱函数 $A(\\mathbf{k}_{\\parallel}, \\omega)$ 给出，它通过表面格林函数迹的虚部获得：\n    $$\n    A(\\mathbf{k}_{\\parallel},\\omega) = -\\frac{1}{\\pi} \\operatorname{Im} \\operatorname{Tr} G_{\\mathrm{surf}}(\\mathbf{k}_{\\parallel},\\omega)\n    $$\n    我们在费米能级（$\\omega=0$）处，为表面布里淵区中的 $\\mathbf{k}_{\\parallel}$ 点网格计算这个量。\n\n4.  **体-边界对应与魏尔节点**：魏尔半金属的一个关键特征是体-边界对应：体布里淵区中魏尔节点（导带和价带接触的点）的存在，必然导致拓扑保护的表面态的存在，即所谓的费米弧。这些弧是表面布里淵区中的零能态曲线，连接着相反手性的体魏尔节点的投影。\n    体魏尔节点出现在能隙闭合处，对于哈密顿量 $H(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，这对应于条件 $\\mathbf{d}(\\mathbf{k}) = \\mathbf{0}$。根据所提供的定义，这要求：\n    - $d_x(\\mathbf{k}) = t_x \\sin(k_x) = 0 \\implies k_x \\in \\{0, \\pi\\}$\n    - $d_y(\\mathbf{k}) = t_y \\sin(k_y) = 0 \\implies k_y \\in \\{0, \\pi\\}$\n    - $d_z(\\mathbf{k}) = m - t_{xy}(\\cos(k_x) + \\cos(k_y)) - t_z \\cos(k_z) = 0$\n    体魏尔节点的投影是那些使得关于 $d_z$ 的方程有实数解 $k_z$ 的 $(k_x, k_y)$ 对。这当且仅当 $|\\cos(k_z)| \\le 1$ 时成立，这转化为问题中提供的条件：$\\left|[m - t_{xy}(\\cos(k_x)+\\cos(k_y))]/t_z\\right| \\le 1$。我们在四个高对称点 $(k_x,k_y) \\in \\{(0,0), (0,\\pi), (\\pi,0), (\\pi,\\pi)\\}$ 检查这个条件。\n\n5.  **算法性弧检测**：为了通过算法检测费米弧，我们在不同魏尔节点的投影之间寻找一条高谱强度的连通路径。步骤如下：\n    a. 在 $N_k \\times N_k$ 网格上计算谱函数 $A(\\mathbf{k}_{\\parallel}, 0)$。\n    b. 应用一个数据驱动的阈值来创建一个二值掩码，以识别高强度区域。一个鲁棒的选择是谱函数值的高百分位数（例如，第90个百分位数），它可以适应每种情况的整体强度尺度。\n    c. 识别与投影的魏尔节点对应的网格索引。\n    d. 在二值掩码上执行连通分量标记。该算法将相邻的高强度网格点分组为簇或“分量”。它必须处理布里淵区的周期性边界条件。基于广度优先搜索（BFS）或深度优先搜索（DFS）的方法是合适的。\n    e. 最后，确定是否有任何单个连通分量包含对应于两个或更多不同投影魏尔节点的网格位置。如果存在这样的分量，它就代表一条连接节点的费米弧。\n\n这种结构化的方法将物理原理转化为一个具体的计算算法，正如在最终代码中实现的那样。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # (tx, ty, txy, tz, m, eta, Nk, omega)\n        (1.0, 1.0, 1.0, 1.0, 0.5, 0.01, 41, 0.0),\n        (1.0, 1.0, 1.0, 1.0, 3.0, 0.01, 41, 0.0),\n        (1.0, 1.0, 1.0, 1.0, 1.0, 0.05, 41, 0.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        results.append(process_case(case))\n\n    # Format the final output as a string representing a Python list.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef process_case(params):\n    \"\"\"\n    Processes a single test case: computes spectral function and checks for Fermi arcs.\n    \"\"\"\n    tx, ty, txy, tz, m, eta, Nk, omega = params\n    \n    # --- Part 1: Determine projected Weyl node locations ---\n    node_locations_symbolic = []\n    # Test the four high-symmetry points in the surface BZ\n    # (kx, ky) in {(0,0), (0,pi), (pi,0), (pi,pi)}\n    for kx_sym, ky_sym in [(0, np.pi), (np.pi, 0), (0, 0), (np.pi, np.pi)]:\n        cos_sum = np.cos(kx_sym) + np.cos(ky_sym)\n        # Condition for real kz solution\n        if tz != 0 and abs((m - txy * cos_sum) / tz) = 1.0:\n            if (kx_sym, ky_sym) not in node_locations_symbolic:\n                node_locations_symbolic.append((kx_sym, ky_sym))\n    \n    if len(node_locations_symbolic)  2:\n        return False\n    \n    k_grid = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n    idx_0 = np.argmin(np.abs(k_grid))\n    idx_pi = 0  # k_grid[0] is -pi, which is equivalent to pi\n\n    node_indices = []\n    for kx_s, ky_s in node_locations_symbolic:\n        ix = idx_pi if np.isclose(kx_s, np.pi) else idx_0\n        iy = idx_pi if np.isclose(ky_s, np.pi) else idx_0\n        if (ix,iy) not in node_indices:\n          node_indices.append((ix,iy))\n\n    if len(node_indices)  2:\n        return False\n\n    # --- Part 2: Compute surface spectral function A(k, omega=0) ---\n    A_map = np.zeros((Nk, Nk))\n    \n    # Pauli matrices\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=complex)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=complex)\n    \n    # Hopping matrix (constant in k)\n    T = -0.5 * tz * sigma_z\n    T_dagger = T.conj().T\n    \n    # Pre-compute identity matrix and energy\n    I = np.eye(2, dtype=complex)\n    E = omega + 1j * eta\n\n    for i, kx in enumerate(k_grid):\n        for j, ky in enumerate(k_grid):\n            # On-site Hamiltonian for the layer\n            d_x = tx * np.sin(kx)\n            d_y = ty * np.sin(ky)\n            d_z = m - txy * (np.cos(kx) + np.cos(ky))\n            H0 = d_x * sigma_x + d_y * sigma_y + d_z * sigma_z\n            \n            # Iteratively compute self-energy\n            Sigma = np.zeros((2, 2), dtype=complex)\n            for _ in range(50):  # 50 iterations are sufficient for convergence\n                try:\n                    inv_matrix = np.linalg.inv(E * I - H0 - Sigma)\n                except np.linalg.LinAlgError:\n                    Sigma = np.full((2,2), np.nan)\n                    break\n                Sigma_new = T @ inv_matrix @ T_dagger\n                if np.linalg.norm(Sigma_new - Sigma)  1e-9:\n                    break\n                Sigma = Sigma_new\n            \n            if np.isnan(Sigma).any():\n                A_map[i,j] = 0\n                continue\n            \n            # Compute surface Green's function\n            G_surf_inv = E * I - H0 - Sigma\n            try:\n                G_surf = np.linalg.inv(G_surf_inv)\n            except np.linalg.LinAlgError:\n                A_map[i, j] = 0\n                continue\n\n            # Compute spectral function\n            A_map[i, j] = -1.0 / np.pi * np.imag(np.trace(G_surf))\n\n    # --- Part 3: Identify Fermi arcs via connectivity analysis ---\n    if np.all(A_map == 0):\n        return False\n        \n    threshold = np.percentile(A_map[A_map > 0], 90)\n    mask = A_map > threshold\n\n    # Connected components labeling with 4-connectivity and periodic boundaries\n    labels = np.zeros_like(mask, dtype=int)\n    current_label = 1\n    for r in range(Nk):\n        for c in range(Nk):\n            if mask[r, c] and labels[r, c] == 0:\n                q = [(r, c)]\n                labels[r, c] = current_label\n                head = 0\n                while head  len(q):\n                    row, col = q[head]\n                    head += 1\n                    for dr, dc in [(0, 1), (0, -1), (1, 0), (-1, 0)]:\n                        nr, nc = (row + dr) % Nk, (col + dc) % Nk # Periodic BC\n                        if mask[nr, nc] and labels[nr, nc] == 0:\n                            labels[nr, nc] = current_label\n                            q.append((nr, nc))\n                current_label += 1\n\n    if current_label == 1:\n        return False\n    \n    unique_node_indices = list(set(node_indices))\n\n    for label_val in range(1, current_label):\n        nodes_in_component = 0\n        for r_idx, c_idx in unique_node_indices:\n            if labels[r_idx, c_idx] == label_val:\n                nodes_in_component += 1\n        if nodes_in_component >= 2:\n            return True\n            \n    return False\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}