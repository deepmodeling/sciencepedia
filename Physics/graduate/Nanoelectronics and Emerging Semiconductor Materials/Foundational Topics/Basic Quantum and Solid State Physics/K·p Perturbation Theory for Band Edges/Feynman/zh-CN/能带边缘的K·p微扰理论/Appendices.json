{
    "hands_on_practices": [
        {
            "introduction": "k·p微扰理论的核心思想是，通过考虑带间耦合来修正特定能带的色散关系。本练习提供了一个基础但至关重要的实践，即从一个简化的三带哈密顿量出发，运用二阶微扰理论精确推导导带和价带的有效质量。通过这个计算，您将亲身体验带间相互作用如何“重整化”电子的惯性，从而形成半导体物理中至关重要的有效质量概念。",
            "id": "4283678",
            "problem": "考虑一个在布里渊区中心附近的直接带隙半导体，在小波矢模长 $k = |\\mathbf{k}|$ 的情况下，使用 k·p 微扰理论对其进行建模。取一个由区中心布洛赫态 $\\{|c\\rangle, |v_{1}\\rangle, |v_{2}\\rangle\\}$ 组成的最小三能带基矢，其中 $|c\\rangle$ 是导带边态，而 $|v_{1}\\rangle$ 和 $|v_{2}\\rangle$ 是两个不同的价带边态。设在 $k=0$ 处的裸带边能量为 $E_{c}^{0}$、$E_{v_{1}}^{0}$ 和 $E_{v_{2}}^{0}$，且满足 $E_{c}^{0} > E_{v_{1}}^{0}$ 和 $E_{c}^{0} > E_{v_{2}}^{0}$。假设晶体是各向同性的，使得唯一非零的带间 k·p 耦合存在于导带与每个价带之间，并且它们是 $k$ 的线性函数，振幅为实数。具体来说，在有序基 $\\{|c\\rangle, |v_{1}\\rangle, |v_{2}\\rangle\\}$ 中， $k=0$ 附近的哈密顿量为\n$$\nH(k) \\;=\\;\n\\begin{pmatrix}\nE_{c}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}  A_{1}\\,k  A_{2}\\,k \\\\\nA_{1}\\,k  E_{v_{1}}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}  0 \\\\\nA_{2}\\,k  0  E_{v_{2}}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}\n\\end{pmatrix},\n$$\n其中 $m_{0}$ 是自由电子质量，$\\hbar$ 是约化普朗克常数，$A_{1}$ 和 $A_{2}$ 是实常数，它们通过 $A_{j} = \\dfrac{\\hbar}{m_{0}} P_{j}$ 包含了相应的各向同性动量矩阵元，其中 $P_{j} = |\\langle c|\\hat{\\mathbf{p}}\\cdot \\hat{\\mathbf{e}}|v_{j}\\rangle|$ 对于任意单位矢量 $\\hat{\\mathbf{e}}$ 成立（各向同性消除了方向依赖性）。在此阶次上，$|v_{1}\\rangle$ 和 $|v_{2}\\rangle$ 之间没有直接耦合。\n\n从标准的微观 k·p 哈密顿量 $H(\\mathbf{k}) = H_{0} + \\dfrac{\\hbar}{m_{0}}\\,\\mathbf{k}\\cdot \\hat{\\mathbf{p}} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}$ 出发，使用一个在 $k$ 的二阶精度内有效的严格约化过程（例如，Löwdin 划分）来消除非对角耦合，并为 $n \\in \\{c, v_{1}, v_{2}\\}$ 获得形式为 $E_{n}(k) = E_{n}^{\\star} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{n}^{\\star}} + \\mathcal{O}(k^{3})$ 的能带对角有效色散关系。明确计算：\n- 重整化带边能量 $E_{c}^{\\star}$、$E_{v_{1}}^{\\star}$、$E_{v_{2}}^{\\star}$，\n- 以及相应的有效质量 $m_{c}^{\\star}$、$m_{v_{1}}^{\\star}$、$m_{v_{2}}^{\\star}$，\n结果精确到 $k$ 的二阶，且仅用 $E_{c}^{0}$、$E_{v_{1}}^{0}$、$E_{v_{2}}^{0}$、$A_{1}$、$A_{2}$、$m_{0}$ 和 $\\hbar$ 表示。\n\n定义能隙 $\\Delta_{c v_{1}} \\equiv E_{c}^{0} - E_{v_{1}}^{0}$ 和 $\\Delta_{c v_{2}} \\equiv E_{c}^{0} - E_{v_{2}}^{0}$，并假设 $\\Delta_{c v_{1}} > 0$ 和 $\\Delta_{c v_{2}} > 0$。将最终能量以电子伏特为单位进行符号表示，并将有效质量表示为无量纲比 $m_{n}^{\\star}/m_{0}$。以单个行矩阵的形式给出最终答案，顺序为 $\\big(E_{c}^{\\star}, \\; m_{c}^{\\star}/m_{0}, \\; E_{v_{1}}^{\\star}, \\; m_{v_{1}}^{\\star}/m_{0}, \\; E_{v_{2}}^{\\star}, \\; m_{v_{2}}^{\\star}/m_{0}\\big)$。无需进行数值计算或四舍五入。",
            "solution": "用户希望我解决一个基于 k·p 微扰理论的问题。根据指示，我将首先验证问题陈述的有效性，如果有效，则继续进行解答。\n\n### 步骤 1：提取已知条件\n- **模型：** 在布里渊区中心 ($\\mathbf{k} \\approx \\mathbf{0}$) 附近的直接带隙半导体。\n- **理论：** 针对小波矢模长 $k=|\\mathbf{k}|$ 的 k·p 微扰理论。\n- **基矢：** 一个最小的 3 能带基矢 $\\{|c\\rangle, |v_{1}\\rangle, |v_{2}\\rangle\\}$。\n- **k=0 处的裸能量：** $E_{c}^{0}$、$E_{v_{1}}^{0}$ 和 $E_{v_{2}}^{0}$，条件为 $E_{c}^{0}  E_{v_{1}}^{0}$ 和 $E_{c}^{0}  E_{v_{2}}^{0}$。\n- **哈密顿量矩阵：** 在有序基 $\\{|c\\rangle, |v_{1}\\rangle, |v_{2}\\rangle\\}$ 中， $k=0$ 附近的哈密顿量由以下公式给出：\n$$\nH(k) \\;=\\;\n\\begin{pmatrix}\nE_{c}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}  A_{1}\\,k  A_{2}\\,k \\\\\nA_{1}\\,k  E_{v_{1}}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}  0 \\\\\nA_{2}\\,k  0  E_{v_{2}}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}\n\\end{pmatrix}\n$$\n- **常数和参数：** $m_{0}$ (自由电子质量)、$\\hbar$ (约化普朗克常数)以及 $A_{1}, A_{2}$ (来自各向同性动量矩阵元的实常数)。\n- **目标：** 使用一个在 $k$ 的二阶精度内有效的约化过程（如 Löwdin 划分）来找到能带对角的有效色散关系 $E_{n}(k) = E_{n}^{\\star} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{n}^{\\star}} + \\mathcal{O}(k^{3})$。\n- **要求输出：**\n  1. 重整化带边能量 $E_{c}^{\\star}$、$E_{v_{1}}^{\\star}$、$E_{v_{2}}^{\\star}$。\n  2. 有效质量 $m_{c}^{\\star}$、$m_{v_{1}}^{\\star}$、$m_{v_{2}}^{\\star}$。\n- **输出表达式：** 必须用 $E_{c}^{0}$、$E_{v_{1}}^{0}$、$E_{v_{2}}^{0}$、$A_{1}$、$A_{2}$、$m_{0}$ 和 $\\hbar$ 来表示。\n- **定义：** 能隙 $\\Delta_{c v_{1}} \\equiv E_{c}^{0} - E_{v_{1}}^{0}  0$ 和 $\\Delta_{c v_{2}} \\equiv E_{c}^{0} - E_{v_{2}}^{0}  0$。\n- **最终答案格式：** 一个单一的行矩阵 $\\big(E_{c}^{\\star}, \\; m_{c}^{\\star}/m_{0}, \\; E_{v_{1}}^{\\star}, \\; m_{v_{1}}^{\\star}/m_{0}, \\; E_{v_{2}}^{\\star}, \\; m_{v_{2}}^{\\star}/m_{0}\\big)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n这个问题在科学上是成立的，是半导体物理学中一个基于 k·p 微扰理论的标准练习。它的提法是适定的，提供了一个明确定义的哈密顿量，并要求在指定的精度阶次下求出特定的、可推导的量（重整化能量和有效质量）。语言客观而精确。问题是自洽的，提供了所有必要的常数和定义。该模型虽然经过简化（例如，各向同性、最小基矢），但它是一个有效且常见的起点，用于说明能带结构计算的原理，并且不包含任何物理或数学上的矛盾。所要求的任务虽然不简单但很标准，涉及将微扰理论应用于矩阵哈密顿量。考虑到问题的符号性质，要求将最终能量“以电子伏特表示”略显含糊，但这并不妨碍推导，因为它可以被解释为给定符号能量 $E_{n}^{0}$ 的单位约定。问题是有效的。\n\n### 步骤 3：结论与行动\n问题是有效的。我将继续进行详细的解答。\n\n---\n\n问题要求我们求解导带和两个价带的有效能量色散关系，结果精确到波矢模长 $k$ 的二阶。所提供的哈密顿量 $H(k)$ 可以使用二阶非简并微扰理论来处理。这等价于将 Löwdin 划分方法展开到所需阶次。\n\n让我们将哈密顿量 $H(k)$ 分解为一个对角部分 $H_{D}(k)$ 和一个非对角部分 $H_{OD}(k)$。\n$$\nH_D(k) =\n\\begin{pmatrix}\nE_{c}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}  0  0 \\\\\n0  E_{v_{1}}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}  0 \\\\\n0  0  E_{v_{2}}^{0} + \\dfrac{\\hbar^{2} k^{2}}{2 m_{0}}\n\\end{pmatrix}\n$$\n$$\nH_{OD}(k) =\n\\begin{pmatrix}\n0  A_{1}\\,k  A_{2}\\,k \\\\\nA_{1}\\,k  0  0 \\\\\nA_{2}\\,k  0  0\n\\end{pmatrix}\n$$\n在 $k=0$ 处的未微扰哈密顿量是 $H_0 = \\text{diag}(E_{c}^{0}, E_{v_1}^{0}, E_{v_2}^{0})$。相应的未微扰态是 $|c\\rangle$、 $|v_1\\rangle$ 和 $|v_2\\rangle$。完整的含 $k$ 的哈密顿量可以被视为围绕 $k=0$ 的微扰。\n\n根据二阶微扰理论，对于态 $|n\\rangle$ 的能量本征值 $E_n(k)$ 由以下公式给出：\n$$ E_n(k) = \\langle n|H(k)|n\\rangle + \\sum_{m \\neq n} \\frac{|\\langle n|H(k)|m\\rangle|^2}{E_{n}^{0} - E_{m}^{0}} + \\mathcal{O}(k^3) $$\n注意，在分母中，我们使用未微扰能量 $E_{n}^{0}$ 和 $E_{m}^{0}$，因为分子已经是 $k^2$ 阶的。在分母中使用含 $k$ 的能量会引入高于 $k^2$ 阶的项，这些项被忽略。\n矩阵元为：$\\langle n|H(k)|n\\rangle = H_{nn}(k) = E_{n}^{0} + \\frac{\\hbar^2 k^2}{2 m_0}$，对于 $n \\ne m$，$\\langle n|H(k)|m\\rangle = H_{nm}(k)$。\n\n**1. 导带 ($n=c$)**\n\n导带的能量 $E_c(k)$ 是通过设置 $n=c$ 并对其他能带 ($m=v_1, v_2$) 求和得到的：\n$$ E_c(k) \\approx H_{cc}(k) + \\frac{|H_{cv_1}(k)|^2}{E_{c}^{0} - E_{v_1}^{0}} + \\frac{|H_{cv_2}(k)|^2}{E_{c}^{0} - E_{v_2}^{0}} $$\n代入 $H(k)$ 的矩阵元：\n$$ E_c(k) \\approx \\left(E_{c}^{0} + \\frac{\\hbar^{2} k^{2}}{2 m_{0}}\\right) + \\frac{(A_1 k)^2}{E_{c}^{0} - E_{v_1}^{0}} + \\frac{(A_2 k)^2}{E_{c}^{0} - E_{v_2}^{0}} $$\n我们按 $k$ 的幂次对各项进行分组：\n$$ E_c(k) \\approx E_{c}^{0} + k^2 \\left( \\frac{\\hbar^{2}}{2 m_{0}} + \\frac{A_1^2}{E_{c}^{0} - E_{v_1}^{0}} + \\frac{A_2^2}{E_{c}^{0} - E_{v_2}^{0}} \\right) $$\n将此与抛物线色散形式 $E_{c}(k) = E_{c}^{\\star} + \\frac{\\hbar^{2} k^{2}}{2 m_{c}^{\\star}}$ 进行比较，我们可以确定重整化带边能量 $E_{c}^{\\star}$ 和有效质量 $m_{c}^{\\star}$。\n不含 $k$ 的项给出了重整化带边能量：\n$$ E_{c}^{\\star} = E_{c}^{0} $$\n$k^2$ 的系数给出了有效质量项：\n$$ \\frac{\\hbar^{2}}{2 m_{c}^{\\star}} = \\frac{\\hbar^{2}}{2 m_{0}} + \\frac{A_1^2}{E_{c}^{0} - E_{v_1}^{0}} + \\frac{A_2^2}{E_{c}^{0} - E_{v_2}^{0}} $$\n求解有效质量倒数比 $m_0/m_c^{\\star}$：\n$$ \\frac{1}{m_{c}^{\\star}} = \\frac{1}{m_{0}} + \\frac{2}{\\hbar^2}\\left( \\frac{A_1^2}{E_{c}^{0} - E_{v_1}^{0}} + \\frac{A_2^2}{E_{c}^{0} - E_{v_2}^{0}} \\right) $$\n$$ \\frac{m_0}{m_{c}^{\\star}} = 1 + \\frac{2m_0}{\\hbar^2}\\left( \\frac{A_1^2}{E_{c}^{0} - E_{v_1}^{0}} + \\frac{A_2^2}{E_{c}^{0} - E_{v_2}^{0}} \\right) $$\n所以，有效质量比为：\n$$ \\frac{m_{c}^{\\star}}{m_0} = \\left[ 1 + \\frac{2m_0 A_1^2}{\\hbar^2 (E_{c}^{0} - E_{v_1}^{0})} + \\frac{2m_0 A_2^2}{\\hbar^2 (E_{c}^{0} - E_{v_2}^{0})} \\right]^{-1} $$\n\n**2. 第一个价带 ($n=v_1$)**\n\n对第一个价带 $v_1$ 的处理过程是类似的。其他能带是 $m=c, v_2$。\n$$ E_{v_1}(k) \\approx H_{v_1 v_1}(k) + \\frac{|H_{v_1 c}(k)|^2}{E_{v_1}^{0} - E_{c}^{0}} + \\frac{|H_{v_1 v_2}(k)|^2}{E_{v_1}^{0} - E_{v_2}^{0}} $$\n从哈密顿量可知，$H_{v_1 v_2}(k) = 0$。\n$$ E_{v_1}(k) \\approx \\left(E_{v_1}^{0} + \\frac{\\hbar^{2} k^{2}}{2 m_{0}}\\right) + \\frac{(A_1 k)^2}{E_{v_1}^{0} - E_{c}^{0}} $$\n$$ E_{v_1}(k) \\approx E_{v_1}^{0} + k^2 \\left( \\frac{\\hbar^{2}}{2 m_{0}} + \\frac{A_1^2}{E_{v_1}^{0} - E_{c}^{0}} \\right) = E_{v_1}^{0} + k^2 \\left( \\frac{\\hbar^{2}}{2 m_{0}} - \\frac{A_1^2}{E_{c}^{0} - E_{v_1}^{0}} \\right) $$\n与 $E_{v_1}(k) = E_{v_1}^{\\star} + \\frac{\\hbar^{2} k^{2}}{2 m_{v_1}^{\\star}}$ 进行比较：\n$$ E_{v_1}^{\\star} = E_{v_1}^{0} $$\n$$ \\frac{\\hbar^{2}}{2 m_{v_1}^{\\star}} = \\frac{\\hbar^{2}}{2 m_{0}} - \\frac{A_1^2}{E_{c}^{0} - E_{v_1}^{0}} $$\n求解有效质量比：\n$$ \\frac{1}{m_{v_1}^{\\star}} = \\frac{1}{m_{0}} - \\frac{2 A_1^2}{\\hbar^2 (E_{c}^{0} - E_{v_1}^{0})} $$\n$$ \\frac{m_0}{m_{v_1}^{\\star}} = 1 - \\frac{2 m_0 A_1^2}{\\hbar^2 (E_{c}^{0} - E_{v_1}^{0})} $$\n$$ \\frac{m_{v_1}^{\\star}}{m_0} = \\left[ 1 - \\frac{2 m_0 A_1^2}{\\hbar^2 (E_{c}^{0} - E_{v_1}^{0})} \\right]^{-1} $$\n\n**3. 第二个价带 ($n=v_2$)**\n\n对第二个价带 $v_2$ 的计算遵循相同的逻辑。相互作用的能带是 $m=c$，因为 $H_{v_2 v_1}(k)=0$。\n$$ E_{v_2}(k) \\approx H_{v_2 v_2}(k) + \\frac{|H_{v_2 c}(k)|^2}{E_{v_2}^{0} - E_{c}^{0}} $$\n$$ E_{v_2}(k) \\approx \\left(E_{v_2}^{0} + \\frac{\\hbar^{2} k^{2}}{2 m_{0}}\\right) + \\frac{(A_2 k)^2}{E_{v_2}^{0} - E_{c}^{0}} $$\n$$ E_{v_2}(k) \\approx E_{v_2}^{0} + k^2 \\left( \\frac{\\hbar^{2}}{2 m_{0}} - \\frac{A_2^2}{E_{c}^{0} - E_{v_2}^{0}} \\right) $$\n与 $E_{v_2}(k) = E_{v_2}^{\\star} + \\frac{\\hbar^{2} k^{2}}{2 m_{v_2}^{\\star}}$ 进行比较：\n$$ E_{v_2}^{\\star} = E_{v_2}^{0} $$\n$$ \\frac{\\hbar^{2}}{2 m_{v_2}^{\\star}} = \\frac{\\hbar^{2}}{2 m_{0}} - \\frac{A_2^2}{E_{c}^{0} - E_{v_2}^{0}} $$\n求解有效质量比：\n$$ \\frac{1}{m_{v_2}^{\\star}} = \\frac{1}{m_{0}} - \\frac{2 A_2^2}{\\hbar^2 (E_{c}^{0} - E_{v_2}^{0})} $$\n$$ \\frac{m_0}{m_{v_2}^{\\star}} = 1 - \\frac{2 m_0 A_2^2}{\\hbar^2 (E_{c}^{0} - E_{v_2}^{0})} $$\n$$ \\frac{m_{v_2}^{\\star}}{m_0} = \\left[ 1 - \\frac{2 m_0 A_2^2}{\\hbar^2 (E_{c}^{0} - E_{v_2}^{0})} \\right]^{-1} $$\n\n结果表明，重整化带边能量 $E_n^{\\star}$ 与裸能量 $E_n^{0}$ 相同。这是因为微扰项与 $k$ 成正比，并在 $k=0$ 时消失，因此在布里渊区中心没有混合。重整化只影响能带的曲率，即有效质量。\n\n我们现在将这六个所需的量组合成一个单一的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nE_{c}^{0}  \n\\left( 1 + \\dfrac{2m_0 A_1^2}{\\hbar^2 (E_{c}^{0} - E_{v_1}^{0})} + \\dfrac{2m_0 A_2^2}{\\hbar^2 (E_{c}^{0} - E_{v_2}^{0})} \\right)^{-1}  \nE_{v_{1}}^{0}  \n\\left( 1 - \\dfrac{2 m_0 A_1^2}{\\hbar^2 (E_{c}^{0} - E_{v_1}^{0})} \\right)^{-1}  \nE_{v_{2}}^{0} \n\\left( 1 - \\dfrac{2 m_0 A_2^2}{\\hbar^2 (E_{c}^{0} - E_{v_2}^{0})} \\right)^{-1}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际的半导体材料中，价带结构通常比导带更为复杂，并表现出各向异性，这种特性由Luttinger参数（$\\gamma_1, \\gamma_2, \\gamma_3$）描述。本练习将理论与计算实践相结合，指导您建立一个线性最小二乘法模型，用于从给定的能带曲率数据中拟合这些关键的Luttinger参数。完成这项任务将使您掌握从理论或实验数据中提取材料哈密顿量参数的核心计算技能。",
            "id": "4283651",
            "problem": "给定一组关于立方半导体的从头算能带曲率数据，该数据位于布里渊区中心（$\\Gamma$）附近。在立方晶体的价带中，最顶部的能带源于总角动量 $J=3/2$。在波矢乘以动量（k·p）微扰理论框架下，并考虑立方对称性，沿着由归一化方向余弦 $(l,m,n)$ 表征的方向，重空穴和轻空穴色散关系中随波矢量二次方变化的行为，可以由三个无量纲材料参数 $\\gamma_1$, $\\gamma_2$ 和 $\\gamma_3$ 来描述。在 $\\Gamma$ 点附近，给定能带沿着方向 $(l,m,n)$、对于一个小的波矢大小 $k$，其能量色散关系具有形式 $E(k) = -(\\hbar^2/2m_0) c k^2$，此式为该能带和该方向定义了一个无量纲曲率系数 $c$。立方对称性意味着方向依赖性可以用方向余弦构建的不变量 $S = l^2 m^2 + m^2 n^2 + n^2 l^2$ 来表示。重空穴和轻空穴能带的曲率对 $\\gamma_1$, $\\gamma_2$, $\\gamma_3$ 和 $S$ 的依赖关系是关于这些参数的线性关系，并且遵循立方对称性。\n\n从适用于具有立方对称性的 $J=3/2$ 价带的 k·p 公式出发，您必须：\n- 推导重空穴和轻空穴曲率系数 $c$ 关于 $\\gamma_1$, $\\gamma_2$, $\\gamma_3$ 以及方向不变量 $S$ 的参数化表示。\n- 在给定一组沿不同方向测量的重空穴和轻空穴能带曲率 $c$ 的情况下，构建一个用于求解 $(\\gamma_1,\\gamma_2,\\gamma_3)$ 的线性最小二乘估计量。\n- 将该估计量实现为一个程序，计算最佳拟合的 $\\gamma_1$, $\\gamma_2$, $\\gamma_3$，并报告拟合的均方根残差。\n\n本问题中所有量均为无量纲，因此无需物理单位。所有浮点数输出请四舍五入到六位小数。\n\n测试套件：\n使用以下三组参数集作为测试用例。每个测试用例是一个测量列表。每个测量是一个元组，包含一个分量为 $(l,m,n)$ 的方向矢量（不一定归一化）、一个能带标签（`hh` 代表重空穴，`lh` 代表轻空穴）和一个测量的曲率 $c$。\n\n- 测试用例 $1$（通用的、与对称性一致的数据集）：\n  - $((1,0,0),\\text{`hh`},2.86)$\n  - $((1,0,0),\\text{`lh`},11.10)$\n  - $((1,1,0),\\text{`hh`},1.555)$\n  - $((1,1,0),\\text{`lh`},12.405)$\n  - $((1,1,1),\\text{`hh`},1.12)$\n  - $((1,1,1),\\text{`lh`},12.84)$\n\n- 测试用例 $2$（带有轻微噪声的近球形数据集）：\n  - $((1,0,0),\\text{`hh`},3.01)$\n  - $((1,0,0),\\text{`lh`},6.98)$\n  - $((1,1,0),\\text{`hh`},2.98)$\n  - $((1,1,0),\\text{`lh`},7.02)$\n  - $((1,1,1),\\text{`hh`},3.00)$\n  - $((1,1,1),\\text{`lh`},6.99)$\n\n- 测试用例 $3$（欠定的最小数据集）：\n  - $((1,0,0),\\text{`hh`},2.86)$\n\n您的程序必须：\n- 对于每次测量，在计算 $S$ 时，将方向矢量 $(l,m,n)$ 归一化为单位长度。\n- 构建并求解关于 $(\\gamma_1,\\gamma_2,\\gamma_3)$ 的线性最小二乘问题，该问题受限于曲率依赖关系的立方对称性形式。\n- 计算拟合的均方根残差。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个测试用例的结果，形式为一个由方括号括起来的逗号分隔列表。每个测试用例的结果必须是一个包含四个浮点数的内部列表，顺序为 `[γ1,γ2,γ3,rms]`，每个浮点数四舍五入到六位小数。例如，输出应类似于 `[[x1,x2,x3,r1],[y1,y2,y3,r2],[z1,z2,z3,r3]]`，不含多余的空格或文本。",
            "solution": "我们从立方半导体价带顶的波矢乘以动量（k·p）微扰理论出发，其中相关的布洛赫基态按照总角动量 $J=3/2$ 进行变换。在布里渊区中心 $\\Gamma$ 附近，关于波矢量 $\\mathbf{k}$ 的二阶有效哈密顿量可以写成 Luttinger 形式：\n$$\n\\hat{H}_v = -\\frac{\\hbar^2}{2 m_0} \\left[ \\gamma_1 k^2 - 2 \\gamma_2 \\sum_{i} \\hat{J}_i^2 k_i^2 - 4 \\gamma_3 \\sum_{i \\neq j} \\hat{J}_i \\hat{J}_j k_i k_j \\right],\n$$\n其中 $m_0$ 是自由电子质量，$k^2 = k_x^2 + k_y^2 + k_z^2$，$\\hat{J}_i$ 是自旋-$3/2$ 角动量矩阵。参数 $\\gamma_1$, $\\gamma_2$ 和 $\\gamma_3$ 是表征能带边曲率的无量纲 Luttinger 参数。\n\n对于一个具有归一化方向余弦 $(l,m,n)$ 和大小 $k$ 的固定传播方向，我们写作 $\\mathbf{k} = k \\hat{\\mathbf{n}}$，其中 $\\hat{\\mathbf{n}} = (l,m,n)$，因此 $k_i = k \\hat{n}_i$。哈密顿量变为关于 $k$ 的二次方形式，而重空穴和轻空穴的色散关系可通过对角化 $4 \\times 4$ 矩阵得到。立方对称性意味着方向依赖性可以由不变量捕获\n$$\nS(l,m,n) = l^2 m^2 + m^2 n^2 + n^2 l^2,\n$$\n该不变量在 $l$, $m$ 和 $n$ 的置换下是对称的，并且对于单位矢量满足 $0 \\le S \\le 1/3$。对于足够小的 $k$，沿方向 $\\hat{\\mathbf{n}}$ 计算 $\\hat{H}_v$ 的本征值得出：\n$$\nE_{hh}(k; \\hat{\\mathbf{n}}) = -\\frac{\\hbar^2}{2 m_0} c_{hh}(\\hat{\\mathbf{n}}) k^2,\\quad\nE_{lh}(k; \\hat{\\mathbf{n}}) = -\\frac{\\hbar^2}{2 m_0} c_{lh}(\\hat{\\mathbf{n}}) k^2,\n$$\n其曲率系数为\n$$\nc_{hh}(\\hat{\\mathbf{n}}) = \\gamma_1 - 2 \\left[ \\left(1 - 3 S(\\hat{\\mathbf{n}})\\right) \\gamma_2 + 3 S(\\hat{\\mathbf{n}}) \\gamma_3 \\right],\n$$\n$$\nc_{lh}(\\hat{\\mathbf{n}}) = \\gamma_1 + 2 \\left[ \\left(1 - 3 S(\\hat{\\mathbf{n}})\\right) \\gamma_2 + 3 S(\\hat{\\mathbf{n}}) \\gamma_3 \\right].\n$$\n这些表达式可以如下理解。在球形近似（即 $\\gamma_2 = \\gamma_3$）中，哈密顿量仅依赖于 $(\\hat{\\mathbf{J}} \\cdot \\hat{\\mathbf{n}})^2$，其对于自旋-$3/2$ 系统的本征值为 $9/4$（重空穴）和 $1/4$（轻空穴），从而得到与方向无关的 $c_{hh} = \\gamma_1 - 2 \\gamma_2$ 和 $c_{lh} = \\gamma_1 + 2 \\gamma_2$。立方各向异性通过差值 $\\gamma_3 - \\gamma_2$引入，并与由方向余弦构建的不变量 $S$ 成比例；这会修正能带分裂，使得涉及 $\\gamma_2$ 和 $\\gamma_3$ 的组合在沿 $\\left[100\\right]$ 方向（$S=0$）的 $\\gamma_2$ 主导和沿 $\\left[111\\right]$ 方向（$S=1/3$）的 $\\gamma_3$ 主导之间进行插值。\n\n以上两个方程对于 $(\\gamma_1,\\gamma_2,\\gamma_3)$ 是线性的。对于一次沿方向 $\\hat{\\mathbf{n}}$、能带标签为 $b \\in \\{\\text{hh}, \\text{lh}\\}$ 的已知测量，定义 $S = S(\\hat{\\mathbf{n}})$ 和符号 $\\sigma_b$（$\\sigma_{\\text{hh}} = -1$ 且 $\\sigma_{\\text{lh}} = +1$）。于是我们可以写出测量方程\n$$\nc = \\gamma_1 + \\sigma_b \\left[ 2 \\left(1 - 3 S \\right) \\gamma_2 + 6 S \\gamma_3 \\right],\n$$\n其形式为\n$$\nc = a_1 \\gamma_1 + a_2 \\gamma_2 + a_3 \\gamma_3,\n$$\n系数为\n$$\na_1 = 1,\\quad a_2 = \\sigma_b 2 \\left(1 - 3 S\\right),\\quad a_3 = \\sigma_b 6 S.\n$$\n收集 $N$ 次这样的测量，得到线性系统\n$$\n\\mathbf{A} \\boldsymbol{\\gamma} \\approx \\mathbf{c},\\quad \\text{其中}\\quad \\mathbf{A} \\in \\mathbb{R}^{N \\times 3},\\quad \\boldsymbol{\\gamma} = \\begin{bmatrix} \\gamma_1 \\\\ \\gamma_2 \\\\ \\gamma_3 \\end{bmatrix},\\quad \\mathbf{c} \\in \\mathbb{R}^{N}.\n$$\n使 $\\|\\mathbf{A}\\boldsymbol{\\gamma} - \\mathbf{c}\\|_2$ 最小化的最小二乘解 $\\hat{\\boldsymbol{\\gamma}}$ 可通过奇异值分解（SVD）求得 Moore–Penrose 伪逆给出：\n$$\n\\hat{\\boldsymbol{\\gamma}} = \\mathbf{A}^+ \\mathbf{c}.\n$$\n当 $\\mathbf{A}$ 为列满秩时，这等价于正规方程的解 $\\hat{\\boldsymbol{\\gamma}} = \\left(\\mathbf{A}^\\top \\mathbf{A}\\right)^{-1} \\mathbf{A}^\\top \\mathbf{c}$。拟合优度可以用均方根残差来概括\n$$\n\\text{rms} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^N \\left( \\left(\\mathbf{A}\\hat{\\boldsymbol{\\gamma}}\\right)_i - c_i \\right)^2 }.\n$$\n\n算法步骤：\n- 对于每个测量元组 $\\left((l,m,n), b, c\\right)$，将方向矢量归一化为单位长度：$\\left(\\tilde{l},\\tilde{m},\\tilde{n}\\right) = \\left(l,m,n\\right)/\\sqrt{l^2 + m^2 + n^2}$。\n- 计算 $S = \\tilde{l}^2 \\tilde{m}^2 + \\tilde{m}^2 \\tilde{n}^2 + \\tilde{n}^2 \\tilde{l}^2$。\n- 对于重空穴（`hh`）设 $\\sigma_b = -1$，对于轻空穴（`lh`）设 $\\sigma_b = +1$。\n- 构造行向量 $\\left[1,\\,\\sigma_b 2\\left(1 - 3 S\\right),\\,\\sigma_b 6 S\\right]$ 并附加到 $\\mathbf{A}$；将测量的曲率 $c$ 附加到 $\\mathbf{c}$。\n- 使用最小二乘求解器求解 $\\hat{\\boldsymbol{\\gamma}} = \\mathbf{A}^+ \\mathbf{c}$。\n- 计算 $\\text{rms} = \\sqrt{\\frac{1}{N} \\|\\mathbf{A} \\hat{\\boldsymbol{\\gamma}} - \\mathbf{c}\\|_2^2}$。\n- 将 $\\hat{\\boldsymbol{\\gamma}}$ 的每个分量和 $\\text{rms}$ 四舍五入到六位小数，并相应地格式化输出行。\n\n将此方法应用于提供的测试套件：\n- 测试用例 $1$ 对重空穴和轻空穴都使用了 $\\left[100\\right]$, $\\left[110\\right]$ 和 $\\left[111\\right]$ 方向，分别对应采样 $S = 0$, $S = 1/4$ 和 $S = 1/3$。数据与对称性一致，恢复的参数接近 $\\gamma_1 \\approx 6.98$, $\\gamma_2 \\approx 2.06$, $\\gamma_3 \\approx 2.93$，残差很小。\n- 测试用例 $2$ 代表一个带有轻微噪声的近球形数据集（近似 $\\gamma_2 \\approx \\gamma_3$）；拟合得到的 $\\gamma_1$ 接近 $5.0$，$\\gamma_2$ 和 $\\gamma_3$ 接近 $1.0$，同时仅捕获了极小的各向异性，非零残差反映了噪声的存在。\n- 测试用例 $3$ 是欠定的（一个方程，三个未知数）。基于 SVD 的最小二乘解返回与单个约束一致的最小范数估计，根据构造，其残差为零。\n- 程序实现了这些步骤，并按规定格式在单行中打印出三个结果列表 `[γ1,γ2,γ3,rms]`，每个值都四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef normalize_direction(dir_vec):\n    \"\"\"Normalize a 3D direction vector to unit length.\"\"\"\n    v = np.array(dir_vec, dtype=float)\n    norm = np.linalg.norm(v)\n    if norm == 0.0:\n        raise ValueError(\"Direction vector cannot be zero.\")\n    return v / norm\n\ndef compute_S(lmn):\n    \"\"\"Compute the cubic invariant S = l^2 m^2 + m^2 n^2 + n^2 l^2 for unit vector (l,m,n).\"\"\"\n    l, m, n = lmn\n    return (l**2) * (m**2) + (m**2) * (n**2) + (n**2) * (l**2)\n\ndef build_least_squares_system(measurements):\n    \"\"\"\n    Build the linear system A x ≈ y for gamma parameters from measurements.\n    Each measurement: ((l,m,n), band, curvature), band in {'hh','lh'}.\n    \"\"\"\n    rows = []\n    y = []\n    for (dir_vec, band, curvature) in measurements:\n        lmn = normalize_direction(dir_vec)\n        S = compute_S(lmn)\n        sigma = -1.0 if band == 'hh' else 1.0  # hh: -1, lh: +1\n        a1 = 1.0\n        a2 = sigma * 2.0 * (1.0 - 3.0 * S)\n        a3 = sigma * 6.0 * S\n        rows.append([a1, a2, a3])\n        y.append(curvature)\n    A = np.array(rows, dtype=float)\n    y = np.array(y, dtype=float)\n    return A, y\n\ndef fit_gammas(measurements):\n    \"\"\"Fit gamma1, gamma2, gamma3 via least squares and compute RMS residual.\"\"\"\n    A, y = build_least_squares_system(measurements)\n    # Solve least squares using SVD-based solver (minimum-norm solution if underdetermined).\n    x, residuals, rank, s = np.linalg.lstsq(A, y, rcond=None)\n    # Compute RMS residual explicitly to be robust across cases.\n    y_fit = A @ x\n    rms = float(np.sqrt(np.mean((y_fit - y) ** 2)))\n    return x, rms\n\ndef format_result(gammas, rms, decimals=6):\n    \"\"\"Format the result as [gamma1,gamma2,gamma3,rms] with fixed decimals and no spaces.\"\"\"\n    g1, g2, g3 = gammas\n    return f\"[{g1:.{decimals}f},{g2:.{decimals}f},{g3:.{decimals}f},{rms:.{decimals}f}]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: general, symmetry-consistent dataset\n        [\n            ((1, 0, 0), 'hh', 2.86),\n            ((1, 0, 0), 'lh', 11.10),\n            ((1, 1, 0), 'hh', 1.555),\n            ((1, 1, 0), 'lh', 12.405),\n            ((1, 1, 1), 'hh', 1.12),\n            ((1, 1, 1), 'lh', 12.84),\n        ],\n        # Test Case 2: near-spherical dataset with slight noise\n        [\n            ((1, 0, 0), 'hh', 3.01),\n            ((1, 0, 0), 'lh', 6.98),\n            ((1, 1, 0), 'hh', 2.98),\n            ((1, 1, 0), 'lh', 7.02),\n            ((1, 1, 1), 'hh', 3.00),\n            ((1, 1, 1), 'lh', 6.99),\n        ],\n        # Test Case 3: underdetermined minimal dataset\n        [\n            ((1, 0, 0), 'hh', 2.86),\n        ],\n    ]\n\n    results_str = []\n    for measurements in test_cases:\n        gammas, rms = fit_gammas(measurements)\n        results_str.append(format_result(gammas, rms, decimals=6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "k·p理论不仅能描述零磁场下的能带结构，其预测的有效质量 $m^*$ 和有效朗德 $g$ 因子 $g^*$ 更是决定了材料在磁场中的行为。本练习模拟了一个连接理论与实验物理学的典型工作流程：通过分析回旋共振实验数据来精确确定这些参数。您需要从基本原理出发，推导朗道能级的跃迁能量表达式，并利用这些表达式来拟合实验数据，从而同时提取出材料的 $m^*$ 和 $g^*$。",
            "id": "4283673",
            "problem": "给定一组在不同磁场下对新兴半导体材料进行的回旋共振（CR）测量数据。目标是通过拟合基于 $k\\cdot p$ 理论的朗道能级跃迁能量，提取导带边有效质量（表示为 $m^{*}$）和有效朗德 $g$ 因子（表示为 $g^{*}$）。此设定位于能带边附近，在该区域，波矢-点-动量（$k\\cdot p$）微扰理论给出了一个有效的单带描述，其中质量和自旋响应是能量依赖的，但在能带边处简化为常数参数 $m^{*}$ 和 $g^{*}$。共振数据包括自旋守恒和自旋翻转的回旋跃迁。您的推导和程序必须从一个基本且物理上合理的基础出发：电子与均匀磁场的最小耦合以及自旋塞曼相互作用，并结合能带边的 $k\\cdot p$ 有效哈密顿量。基于此，推导出共振跃迁能量作为磁场 $B$以及未知参数 $m^{*}$ 和 $g^{*}$ 的函数，然后进行拟合以确定每个数据集的 $m^{*}$ 和 $g^{*}$。\n\n推导的基础应为：\n- 均匀磁场中的最小耦合哈密顿量以及轨道运动的正则朗道量子化。\n- 与 $k\\cdot p$ 能带边描述相符的、带有有效朗德因子的自旋塞曼相互作用。\n- 在导带边附近使用 $k\\cdot p$ 微扰理论，以证明有效质量近似和有效自旋耦合的合理性，且不引入任何捷径或预先推导出的目标公式。\n\n请精确定义以下常数及其物理单位：\n- 约化普朗克常数，$\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$。\n- 基本电荷大小，$e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$。\n- 电子静止质量，$m_{0} = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$。\n- 玻尔磁子，$\\mu_{B} = \\dfrac{e\\hbar}{2m_{0}}$，单位 $\\mathrm{J/T}$。\n- 焦耳到毫电子伏特的转换，$1\\ \\mathrm{J} = \\dfrac{1000}{e}\\ \\mathrm{meV}$。\n\n单位和输出规范：\n- 磁场 $B$ 必须以 $\\mathrm{T}$ (特斯拉) 为单位。\n- 共振能量必须以 $\\mathrm{meV}$ (毫电子伏特) 为单位。\n- 最终结果必须报告为无量纲的 $m^{*}/m_{0}$ 和无量纲的 $g^{*}$，每个值都四舍五入到六位小数。\n- 您的程序应产生单行输出，其中包含所有数据集的结果，形式为方括号括起来的逗号分隔列表，每个数据集的结果是一个二元列表 $[m^{*}/m_{0}, g^{*}]$。例如：\"[[m1,g1],[m2,g2],[m3,g3]]\"，其中为数值。\n\n选择定则和跃迁标记：\n- 每个测量数据点都标记为自旋守恒回旋共振（“N”）或自旋翻转回旋共振（“SF+”）或（“SF-”），对应于轨道量子数变化 $|\\Delta n|=1$ 且自旋变化由光偏振和选择定则决定的跃迁。您必须从上述基础出发，依据第一性原理推导出每种跃迁能量对 $B$、$m^{*}$ 和 $g^{*}$ 的函数依赖关系，然后用它来拟合所提供的数据。\n\n测试套件：\n对于每个数据集，给定磁场值 $B$（单位 $\\mathrm{T}$）、测量的共振能量 $E$（单位 $\\mathrm{meV}$）和跃迁类型标记。使用这些数据同时拟合 $m^{*}$ 和 $g^{*}$。\n\n- 数据集1（化合物半导体，中等 $g^{*}$）：\n  - 磁场 $B$（单位 $\\mathrm{T}$）：$[1.0, 2.0, 3.5, 5.0]$，适用于下面列出的每种跃迁类型。\n  - 跃迁类型和测量的能量 $E$（单位 $\\mathrm{meV}$）：\n    - \"N\": $[1.729597, 3.459194, 6.0535895, 8.647985]$\n    - \"SF+\": $[1.704128, 3.408726, 5.964496, 8.520640]$\n    - \"SF-\": $[1.755066, 3.509662, 6.142683, 8.775330]$\n\n- 数据集2（窄带隙半导体，大 $|g^{*}|$）：\n  - 磁场 $B$（单位 $\\mathrm{T}$）：$[0.5, 1.0, 1.5, 2.5, 3.0]$，适用于下面列出的每种跃迁类型。\n  - 跃迁类型和测量的能量 $E$（单位 $\\mathrm{meV}$）：\n    - \"N\": $[4.1386785, 8.277357, 12.4160355, 20.6933925, 24.832071]$\n    - \"SF+\": $[2.662642, 5.325283, 7.9879245, 13.3132075, 15.975849]$\n    - \"SF-\": $[5.6147155, 11.229431, 16.8441465, 28.0735775, 33.688293]$\n\n- 数据集3（较大质量，正 $g^{*}$）：\n  - 磁场 $B$（单位 $\\mathrm{T}$）：$[0.1, 0.2, 0.5, 1.0]$，适用于下面列出的每种跃迁类型。\n  - 跃迁类型和测量的能量 $E$（单位 $\\mathrm{meV}$）：\n    - \"N\": $[0.0579415, 0.115883, 0.2897075, 0.579415]$\n    - \"SF+\": $[0.06951826, 0.13903652, 0.3475913, 0.6951826]$\n\n算法任务：\n- 从基本基础出发，为每种跃迁类型（“N”、“SF+”、“SF-”），推导跃迁能量作为 $B$、$m^{*}$ 和 $g^{*}$ 的函数表达式。\n- 对每个案例的整个数据集实施最小二乘法拟合，以提取 $m^{*}/m_{0}$ 和 $g^{*}$。\n- 使用物理上合理的边界条件，确保 $m^{*}/m_{0} > 0$，同时允许 $g^{*}$ 为任意实数。\n- 将三个数据集的最终输出表示为单行 \"[[m1,g1],[m2,g2],[m3,g3]]\"，每个数值四舍五入到六位小数，无量纲。\n\n您的程序必须是一个完整、可运行的 Python 3.12 脚本，仅使用指定的库，并且不得需要任何用户输入或外部文件。",
            "solution": "我们从通过波矢-点-动量（$k\\cdot p$）微扰理论推导出的、适用于导带边附近导带电子的有效哈密顿量开始。在能带边附近，导带与远程能带的混合导致了重整化的轨道动力学（由有效质量描述）和重整化的自旋耦合（由有效朗德因子描述）。在均匀磁场中，基本物理基础包括：\n1. 与电磁矢量势的最小耦合以及随之而来的轨道运动的朗道量子化。\n2. 自旋塞曼相互作用。\n\n能带边附近的有效哈密顿量写作\n$$\nH_{\\text{eff}} = \\frac{1}{2m^{*}} \\left(\\boldsymbol{\\pi}\\cdot\\boldsymbol{\\pi}\\right) + \\frac{1}{2} g^{*} \\mu_{B} \\boldsymbol{\\sigma}\\cdot \\mathbf{B},\n$$\n其中 $m^{*}$ 是能带边的导带有效质量，$g^{*}$ 是能带边的有效朗德因子，$\\boldsymbol{\\pi} = \\mathbf{p} + e\\mathbf{A}$ 是在均匀磁场 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$存在时的动能算符，$\\mu_{B}$ 是玻尔磁子，$\\boldsymbol{\\sigma}$ 是作用于自旋的泡利矩阵。该哈密顿量源于 $k\\cdot p$ 微扰理论，其中能带边的动力学由带间耦合导致的重整化参数所描述。尽管非抛物线校正可能使得 $m^{*}$ 和 $g^{*}$ 在远离能带边时依赖于能量，但在能带边处，它们被视为常数 $m^{*}$ 和 $g^{*}$。\n\n在均匀磁场中，对轨道项进行朗道量子化，得到能量阶梯\n$$\nE_{n}^{\\text{orb}} = \\hbar \\omega_{c} \\left(n+\\frac{1}{2}\\right), \\quad \\omega_{c} = \\frac{eB}{m^{*}},\n$$\n其中 $n\\in\\{0,1,2,\\dots\\}$ 是朗道能级指数，$B$ 是磁场大小。自旋塞曼项贡献了一个能量移动\n$$\nE_{\\text{Z}} = s \\frac{1}{2} g^{*} \\mu_{B} B,\n$$\n其中 $s=\\pm 1$ 分别代表自旋向上和自旋向下。相对于导带边的总朗道能级能量为\n$$\nE_{n,s} = \\hbar \\omega_{c} \\left(n+\\frac{1}{2}\\right) + s \\frac{1}{2} g^{*} \\mu_{B} B.\n$$\n\n回旋共振（CR）探测由辐射场驱动的朗道能级间的跃迁。在偶极近似下，轨道选择定则是 $|\\Delta n|=1$。自旋选择定则取决于光的偏振和矩阵元：自旋守恒跃迁是主要的回旋共振（“N”），其 $\\Delta s=0$；而自旋翻转回旋共振（“SF”）对应于 $\\Delta s=\\pm 1$。共振能量是最终和初始朗道能级能量之差。对于自旋守恒的回旋共振（“N”），考虑跃迁 $n,s\\to n+1,s$，\n$$\n\\Delta E_{\\text{N}} = E_{n+1,s}-E_{n,s} = \\hbar \\omega_{c}.\n$$\n对于自旋翻转回旋共振，存在两个分支，取决于在轨道跃迁期间自旋是升高还是降低。我们将跃迁过程中的净自旋增加表示为“SF+”，净自旋减少表示为“SF-”，\n$$\n\\Delta E_{\\text{SF}\\pm} = E_{n+1,s\\pm 1}-E_{n,s} = \\hbar \\omega_{c} \\pm g^{*}\\mu_{B} B.\n$$\n这些表达式直接源于 $E_{n,s}$ 的结构和选择定则，并且对于能带边处的理想抛物线能带，它们与朗道能级指数 $n$ 无关。\n\n现在，我们将 $\\hbar \\omega_{c}$ 和 $g^{*}\\mu_{B} B$ 的能量表示为毫电子伏特（$\\mathrm{meV}$）。使用常数\n$\\hbar$、$e$、$m_{0}$、$\\mu_{B} = e\\hbar/(2m_{0})$（单位 $\\mathrm{J/T}$），以及转换关系 $1\\ \\mathrm{J} = 1000/e\\ \\mathrm{meV}$，回旋项变为\n$$\n\\Delta E_{\\text{N}}(B;m^{*}) = \\frac{\\hbar e}{m^{*}} B \\times \\frac{1000}{e} = \\frac{\\hbar e}{m^{*}} B \\cdot \\frac{1000}{e},\n$$\n转换为 $\\mathrm{meV}$。记 $m^{*} = (m^{*}/m_{0}) m_{0}$，我们得到\n$$\n\\Delta E_{\\text{N}}(B; m^{*}/m_{0}) = \\frac{\\hbar e}{m_{0}} \\frac{B}{m^{*}/m_{0}} \\cdot \\frac{1000}{e} \\quad \\text{单位 meV}.\n$$\n类似地，塞曼项变为\n$$\n\\Delta E_{\\text{Z}}(B; g^{*}) = g^{*} \\mu_{B} B \\cdot \\frac{1000}{e} \\quad \\text{单位 meV}.\n$$\n因此，对于三种跃迁标记，\n$$\n\\Delta E_{\\text{N}}(B; m^{*}/m_{0}) = \\left(\\frac{\\hbar e}{m_{0}} \\cdot \\frac{1000}{e}\\right) \\frac{B}{m^{*}/m_{0}},\n$$\n$$\n\\Delta E_{\\text{SF}+}(B; m^{*}/m_{0},g^{*}) = \\Delta E_{\\text{N}}(B; m^{*}/m_{0}) + g^{*}\\mu_{B} B \\cdot \\frac{1000}{e},\n$$\n$$\n\\Delta E_{\\text{SF}-}(B; m^{*}/m_{0},g^{*}) = \\Delta E_{\\text{N}}(B; m^{*}/m_{0}) - g^{*}\\mu_{B} B \\cdot \\frac{1000}{e}.\n$$\n\n给定带有跃迁标记的测量对 $(B_{i}, E_{i})$，我们通过最小化残差平方和来拟合 $m^{*}/m_{0}$ 和 $g^{*}$\n$$\n\\min_{m^{*}/m_{0}  0,\\, g^{*}\\in\\mathbb{R}} \\sum_{i} \\left[E_{i} - \\Delta E_{\\text{label}_{i}}(B_{i}; m^{*}/m_{0}, g^{*})\\right]^{2}.\n$$\n这是一个具有两个参数的非线性最小二乘问题，其物理上合理的边界条件简单明了：$m^{*}/m_{0} \\in (0,\\infty)$ 和 $g^{*}\\in\\mathbb{R}$。\n\n算法实现：\n- 将每个数据点的标记映射到其对应的预测能量函数，如上所述。\n- 将常数统一转换为 $\\mathrm{meV}$。\n- 定义一个数据集中所有数据点的残差向量。\n- 使用带边界条件的鲁棒非线性最小二乘求解器来获得 $(m^{*}/m_{0}, g^{*})$。\n- 按要求将结果四舍五入到六位小数，并为所有数据集输出一个聚合的列表。\n\n提供的测试套件包括三个数据集。数据集1包含中等大小的 $g^{*}$ 和典型的化合物半导体有效质量；数据集2捕捉了具有大 $|g^{*}|$ 的窄带隙物理特性；数据集3探索了具有较大质量、正 $g^{*}$ 和小磁场的情况。这种多样性确保了对不同行为的覆盖：仅有自旋守恒的贡献、符号相反的组合自旋翻转位移，以及对 $B$ 标度的敏感性。拟合过程同时考虑所有跃迁类型，以消除 $m^{*}$（由自旋守恒分支的斜率确定）和 $g^{*}$（由每特斯拉的自旋翻转分裂确定）的歧义。最终程序遵循单位规范，并以要求的单行格式输出结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\n# Physical constants (SI)\nHBAR = 1.054571817e-34  # J*s\nE_CHARGE = 1.602176634e-19  # C\nM_E = 9.1093837015e-31  # kg\nMU_B = E_CHARGE * HBAR / (2.0 * M_E)  # J/T\n\n# Unit conversion: J - meV\nJ_TO_meV = 1000.0 / E_CHARGE  # meV/J\n\ndef cyclotron_energy_meV(B_T, m_ratio):\n    \"\"\"\n    Compute cyclotron resonance energy (spin-conserving) in meV:\n    E_N = (ħ e / (m_ratio * m0)) * B, converted to meV.\n    \"\"\"\n    return (HBAR * E_CHARGE / (m_ratio * M_E)) * B_T * J_TO_meV\n\ndef zeeman_energy_meV(B_T, gstar):\n    \"\"\"\n    Compute Zeeman energy magnitude in meV:\n    E_Z = g* * mu_B * B, converted to meV.\n    \"\"\"\n    return gstar * MU_B * B_T * J_TO_meV\n\ndef predict_energy_meV(B_T, transition_type, m_ratio, gstar):\n    \"\"\"\n    Predict the resonance energy in meV for a given transition type.\n    transition_type: 'N', 'SF+', or 'SF-'.\n    \"\"\"\n    E_c = cyclotron_energy_meV(B_T, m_ratio)\n    E_z = zeeman_energy_meV(B_T, gstar)\n    if transition_type == 'N':\n        return E_c\n    elif transition_type == 'SF+':\n        return E_c + E_z\n    elif transition_type == 'SF-':\n        return E_c - E_z\n    else:\n        raise ValueError(f\"Unknown transition type: {transition_type}\")\n\ndef fit_m_and_g(B_list, E_list, T_list, m_init=0.05, g_init=-10.0):\n    \"\"\"\n    Fit m_ratio (m*/m0) and gstar using nonlinear least squares for one dataset.\n    \"\"\"\n    B_arr = np.array(B_list, dtype=float)\n    E_arr = np.array(E_list, dtype=float)\n    # Encode transition types as strings; vectorized predict via loop in residuals\n    T_arr = np.array(T_list, dtype=object)\n\n    def residuals(params):\n        m_ratio, gstar = params\n        # Enforce positivity of m_ratio in residual definition via bounds in optimizer\n        preds = np.array([predict_energy_meV(B_arr[i], T_arr[i], m_ratio, gstar) for i in range(len(B_arr))], dtype=float)\n        return E_arr - preds\n\n    # Bounds: m_ratio in (1e-4, 5.0), gstar in (-2000, 2000)\n    bounds = ([1e-4, -2000.0], [5.0, 2000.0])\n    result = least_squares(residuals, x0=np.array([m_init, g_init], dtype=float), bounds=bounds, method='trf')\n    m_fit, g_fit = result.x\n    return float(m_fit), float(g_fit)\n\ndef build_dataset_1():\n    # Dataset 1\n    B = [1.0, 2.0, 3.5, 5.0]  # repeated for each transition type\n    # Types and energies correspond index-wise to B repeated\n    T = (['N'] * len(B)) + (['SF+'] * len(B)) + (['SF-'] * len(B))\n    E_N = [1.729597, 3.459194, 6.0535895, 8.647985]\n    E_SFp = [1.704128, 3.408726, 5.964496, 8.520640]\n    E_SFm = [1.755066, 3.509662, 6.142683, 8.775330]\n    # Flatten B to match concatenated energies\n    B_all = B + B + B\n    E_all = E_N + E_SFp + E_SFm\n    return B_all, E_all, T\n\ndef build_dataset_2():\n    # Dataset 2\n    B = [0.5, 1.0, 1.5, 2.5, 3.0]\n    T = (['N'] * len(B)) + (['SF+'] * len(B)) + (['SF-'] * len(B))\n    E_N = [4.1386785, 8.277357, 12.4160355, 20.6933925, 24.832071]\n    E_SFp = [2.662642, 5.325283, 7.9879245, 13.3132075, 15.975849]\n    E_SFm = [5.6147155, 11.229431, 16.8441465, 28.0735775, 33.688293]\n    B_all = B + B + B\n    E_all = E_N + E_SFp + E_SFm\n    return B_all, E_all, T\n\ndef build_dataset_3():\n    # Dataset 3\n    B = [0.1, 0.2, 0.5, 1.0]\n    T = (['N'] * len(B)) + (['SF+'] * len(B))\n    E_N = [0.0579415, 0.115883, 0.2897075, 0.579415]\n    E_SFp = [0.06951826, 0.13903652, 0.3475913, 0.6951826]\n    B_all = B + B\n    E_all = E_N + E_SFp\n    return B_all, E_all, T\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        build_dataset_1(),\n        build_dataset_2(),\n        build_dataset_3(),\n    ]\n\n    # Initial guesses tailored modestly; they will be refined by least-squares.\n    inits = [\n        (0.05, -5.0),\n        (0.02, -40.0),\n        (0.3, 5.0),\n    ]\n\n    results = []\n    for idx, case in enumerate(test_cases):\n        B_list, E_list, T_list = case\n        m_init, g_init = inits[idx]\n        m_ratio, gstar = fit_m_and_g(B_list, E_list, T_list, m_init=m_init, g_init=g_init)\n        # Round to six decimals as required\n        m_ratio = round(m_ratio, 6)\n        gstar = round(gstar, 6)\n        results.append([m_ratio, gstar])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join('[' + ','.join(map(str, r)) + ']' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}