{
    "hands_on_practices": [
        {
            "introduction": "To truly master Atomic Layer Deposition (ALD), we must first understand the microscopic origins of its characteristic Growth Per Cycle (GPC). This exercise guides you through a first-principles calculation, connecting the discrete nature of surface chemistry to the continuous growth of a thin film. By applying a site-counting model to the well-known $\\mathrm{Al}_{2}\\mathrm{O}_{3}$ process, you will quantitatively determine the ideal GPC from fundamental parameters like surface site density and film stoichiometry, building a foundational intuition for how atomic-scale events dictate macroscopic outcomes .",
            "id": "4263192",
            "problem": "In Atomic Layer Deposition (ALD), the Growth Per Cycle (GPC) of aluminum oxide $\\mathrm{Al}_{2}\\mathrm{O}_{3}$ using Trimethylaluminum (TMA) and water is governed by the number of metal centers incorporated per cycle and the film density. Consider a fully hydroxylated amorphous oxide surface where the hydroxyl site density is $n_{\\mathrm{OH}} = 4.0 \\ \\mathrm{nm}^{-2}$. Assume that in the TMA half-reaction on such a surface, one chemisorbed aluminum center is incorporated per hydroxyl site, so the chemisorbed monolayer density of aluminum after the TMA exposure is $n_{\\mathrm{chem}} = n_{\\mathrm{OH}}$. The film formed is amorphous $\\mathrm{Al}_{2}\\mathrm{O}_{3}$ with density $\\rho = 3.0 \\ \\mathrm{g}\\,\\mathrm{cm}^{-3}$. Use site-counting, mass conservation, and stoichiometry of $\\mathrm{Al}_{2}\\mathrm{O}_{3}$ to relate the GPC (in $\\mathrm{nm}/\\mathrm{cycle}$) to $n_{\\mathrm{chem}}$ and $\\rho$, starting from the facts that two aluminum atoms and three oxygen atoms compose one formula unit of $\\mathrm{Al}_{2}\\mathrm{O}_{3}$, and that thickness equals mass per area divided by density.\n\nTake Avogadro’s constant to be $N_{\\mathrm{A}} = 6.022 \\times 10^{23} \\ \\mathrm{mol}^{-1}$, the molar mass of aluminum to be $M_{\\mathrm{Al}} = 26.982 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}$, and the molar mass of oxygen to be $M_{\\mathrm{O}} = 15.999 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}$. Express the final GPC in $\\mathrm{nm}/\\mathrm{cycle}$ and round your answer to three significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of materials science and chemistry, is well-posed with sufficient information for a unique solution, and is free from any of the specified invalidating flaws.\n\nThe objective is to calculate the Growth Per Cycle (GPC) of $\\mathrm{Al}_{2}\\mathrm{O}_{3}$ in an Atomic Layer Deposition (ALD) process. The GPC represents the thickness of the film added in one complete ALD cycle. The problem directs a solution based on site-counting, stoichiometry, and the relationship between mass, volume, and density.\n\nThe GPC, which we denote as $\\Delta z$, is the change in film thickness per cycle. It can be calculated by dividing the mass of film material added per unit area in one cycle, $\\sigma_{\\mathrm{cycle}}$, by the density of the film, $\\rho$.\n$$\n\\mathrm{GPC} = \\Delta z = \\frac{\\sigma_{\\mathrm{cycle}}}{\\rho}\n$$\nThe problem provides the following values:\n- Chemisorbed aluminum center density per cycle: $n_{\\mathrm{chem}} = 4.0 \\ \\mathrm{nm}^{-2}$\n- Film density: $\\rho = 3.0 \\ \\mathrm{g}\\,\\mathrm{cm}^{-3}$\n- Molar mass of aluminum: $M_{\\mathrm{Al}} = 26.982 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}$\n- Molar mass of oxygen: $M_{\\mathrm{O}} = 15.999 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}$\n- Avogadro's constant: $N_{\\mathrm{A}} = 6.022 \\times 10^{23} \\ \\mathrm{mol}^{-1}$\n\nFirst, we determine the mass added per unit area per cycle, $\\sigma_{\\mathrm{cycle}}$. This mass corresponds to the a layer of stoichiometric aluminum oxide, $\\mathrm{Al}_{2}\\mathrm{O}_{3}$. We begin by calculating the molar mass of one formula unit of $\\mathrm{Al}_{2}\\mathrm{O}_{3}$, denoted as $M_{\\mathrm{Al_2O_3}}$.\n$$\nM_{\\mathrm{Al_2O_3}} = 2 \\times M_{\\mathrm{Al}} + 3 \\times M_{\\mathrm{O}}\n$$\nSubstituting the given values:\n$$\nM_{\\mathrm{Al_2O_3}} = 2 \\times (26.982 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}) + 3 \\times (15.999 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}) = 53.964 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1} + 47.997 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1} = 101.961 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}\n$$\nThe problem states that $n_{\\mathrm{chem}}$ is the number of aluminum atoms incorporated per unit area per cycle. According to the stoichiometry of $\\mathrm{Al}_{2}\\mathrm{O}_{3}$, there are two aluminum atoms per formula unit. Therefore, the number of $\\mathrm{Al}_{2}\\mathrm{O}_{3}$ formula units added per unit area per cycle, $N_{\\mathrm{FU}}$, is half the number of aluminum atoms added per unit area.\n$$\nN_{\\mathrm{FU}} = \\frac{n_{\\mathrm{chem}}}{2}\n$$\nThe mass of a single $\\mathrm{Al}_{2}\\mathrm{O}_{3}$ formula unit, $m_{\\mathrm{FU}}$, is its molar mass divided by Avogadro's constant.\n$$\nm_{\\mathrm{FU}} = \\frac{M_{\\mathrm{Al_2O_3}}}{N_{\\mathrm{A}}}\n$$\nThe mass added per unit area per cycle, $\\sigma_{\\mathrm{cycle}}$, is the product of the number of formula units per area and the mass of each formula unit.\n$$\n\\sigma_{\\mathrm{cycle}} = N_{\\mathrm{FU}} \\times m_{\\mathrm{FU}} = \\left(\\frac{n_{\\mathrm{chem}}}{2}\\right) \\times \\left(\\frac{M_{\\mathrm{Al_2O_3}}}{N_{\\mathrm{A}}}\\right) = \\frac{n_{\\mathrm{chem}} M_{\\mathrm{Al_2O_3}}}{2 N_{\\mathrm{A}}}\n$$\nNow we can write the full expression for the GPC.\n$$\n\\mathrm{GPC} = \\frac{\\sigma_{\\mathrm{cycle}}}{\\rho} = \\frac{n_{\\mathrm{chem}} M_{\\mathrm{Al_2O_3}}}{2 \\rho N_{\\mathrm{A}}}\n$$\nFor the numerical calculation, we must ensure all units are consistent. We will convert all quantities to a system based on nanometers ($\\mathrm{nm}$) and grams ($\\mathrm{g}$).\nThe given density is in $\\mathrm{g}\\,\\mathrm{cm}^{-3}$. We convert this to $\\mathrm{g}\\,\\mathrm{nm}^{-3}$ using the conversion $1 \\ \\mathrm{cm} = 10^7 \\ \\mathrm{nm}$.\n$$\n\\rho = 3.0 \\ \\mathrm{g}\\,\\mathrm{cm}^{-3} = 3.0 \\ \\frac{\\mathrm{g}}{(10^7 \\ \\mathrm{nm})^3} = 3.0 \\ \\frac{\\mathrm{g}}{10^{21} \\ \\mathrm{nm}^3} = 3.0 \\times 10^{-21} \\ \\mathrm{g}\\,\\mathrm{nm}^{-3}\n$$\nThe other parameters are:\n- $n_{\\mathrm{chem}} = 4.0 \\ \\mathrm{nm}^{-2}$\n- $M_{\\mathrm{Al_2O_3}} = 101.961 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1}$\n- $N_{\\mathrm{A}} = 6.022 \\times 10^{23} \\ \\mathrm{mol}^{-1}$\n\nWe substitute these values into the GPC equation.\n$$\n\\mathrm{GPC} = \\frac{(4.0 \\ \\mathrm{nm}^{-2}) \\times (101.961 \\ \\mathrm{g}\\,\\mathrm{mol}^{-1})}{2 \\times (3.0 \\times 10^{-21} \\ \\mathrm{g}\\,\\mathrm{nm}^{-3}) \\times (6.022 \\times 10^{23} \\ \\mathrm{mol}^{-1})}\n$$\nThe units cancel as follows: $\\frac{\\mathrm{nm}^{-2} \\cdot \\mathrm{g} \\cdot \\mathrm{mol}^{-1}}{\\mathrm{g} \\cdot \\mathrm{nm}^{-3} \\cdot \\mathrm{mol}^{-1}} = \\frac{\\mathrm{nm}^{-2}}{\\mathrm{nm}^{-3}} = \\mathrm{nm}$, which is the correct unit for thickness.\nNow, we calculate the numerical value.\n$$\n\\mathrm{GPC} = \\frac{4.0 \\times 101.961}{2 \\times 3.0 \\times 6.022 \\times 10^{2}} \\ \\mathrm{nm} = \\frac{407.844}{3613.2} \\ \\mathrm{nm}\n$$\n$$\n\\mathrm{GPC} \\approx 0.112878 \\ \\mathrm{nm}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\mathrm{GPC} \\approx 0.113 \\ \\mathrm{nm}\n$$\nThis value can be expressed in scientific notation as $1.13 \\times 10^{-1} \\ \\mathrm{nm}$.\nSo, the growth per cycle is approximately $0.113 \\ \\mathrm{nm}/\\mathrm{cycle}$. This is a typical value for the ALD of $\\mathrm{Al}_{2}\\mathrm{O}_{3}$, which is often cited as being around $0.1 \\ \\mathrm{nm}/\\mathrm{cycle}$.",
            "answer": "$$\n\\boxed{1.13 \\times 10^{-1}}\n$$"
        },
        {
            "introduction": "An ideal ALD process relies on the complete separation of precursor exposures in time, a task accomplished by the purge step. This practice moves our focus from the static surface to the dynamic environment of the reactor, addressing the critical question of \"how long to purge?\". You will apply principles of mass conservation and vacuum dynamics to model the exponential decay of precursor partial pressure, deriving the necessary purge time to prevent unwanted chemical vapor deposition (CVD) reactions and ensure true self-limiting growth . This calculation highlights the crucial link between reactor design parameters, such as volume $V$ and pumping speed $S$, and the overall efficiency and quality of the ALD process.",
            "id": "2469146",
            "problem": "An Atomic Layer Deposition (ALD) reactor executes a purge step immediately after a precursor dose to remove residual precursor from the gas phase before the next half-reaction. Consider a well-mixed, isothermal, constant-volume reactor of volume $V=20\\,\\text{L}$ connected to a pump with effective pumping speed $S=2000\\,\\text{L/s}$. During the purge, there is no inflow of precursor and no gas-phase reaction of the precursor; an inert carrier establishes a constant total pressure, and the gas mixture behaves ideally. Let $P_{A}(t)$ denote the precursor partial pressure. Starting from species mass conservation for a well-mixed control volume and the Ideal Gas Law, derive the governing relation for $P_{A}(t)$ and use it to determine the purge time required to reduce the precursor partial pressure by a factor of $10^{3}$ relative to its value at the start of the purge.\n\nRound your final answer to three significant figures and express the time in seconds.",
            "solution": "The problem is first critically examined for validity. The givens are:\n- Reactor volume: $V=20\\,\\text{L}$\n- Pumping speed: $S=2000\\,\\text{L/s}$\n- Model assumptions: well-mixed, isothermal, constant-volume reactor; no inflow or gas-phase reaction of precursor during purge; ideal gas behavior.\n- Objective: Derive the governing relation for precursor partial pressure $P_{A}(t)$ and calculate the time required to reduce $P_{A}$ by a factor of $10^{3}$.\n\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard pump-down process in a vacuum system, which is a fundamental concept in materials science and chemical engineering, particularly for processes like Atomic Layer Deposition (ALD). The model is a valid and widely used simplification. The provided data are physically consistent and sufficient for a unique solution. Therefore, the problem is valid and a solution will be derived.\n\nThe derivation begins with the species mass balance for precursor A in a well-mixed control volume, which is the reactor volume $V$. The general balance equation is: Rate of Accumulation = Rate of Inflow - Rate of Outflow + Rate of Generation.\n\nLet $m_{A}(t)$ be the mass of precursor A in the reactor at time $t$. The rate of accumulation is $\\frac{dm_{A}}{dt}$.\nAccording to the problem statement:\n- There is no inflow of precursor: Rate of Inflow = $0$.\n- There is no gas-phase reaction of the precursor: Rate of Generation = $0$.\n\nThe outflow is due to the pump. In a well-mixed reactor, the mass concentration of precursor A, $\\rho_{A}$, is uniform and given by $\\rho_{A} = \\frac{m_{A}}{V}$. The pump removes gas at a volumetric rate $S$. Thus, the mass outflow rate is the product of the mass concentration and the volumetric pumping speed:\n$$ \\text{Rate of Outflow} = \\rho_{A} S = \\frac{m_{A}}{V} S $$\nSubstituting these terms into the mass balance equation yields:\n$$ \\frac{dm_{A}}{dt} = 0 - \\frac{S}{V}m_{A} + 0 \\implies \\frac{dm_{A}}{dt} = -\\frac{S}{V} m_{A} $$\nThis is the differential equation for the mass of the precursor. To find the governing relation for the partial pressure $P_{A}(t)$, we must relate $m_{A}$ to $P_{A}$ using the Ideal Gas Law:\n$$ P_{A}V = n_{A}RT $$\nwhere $n_{A}$ is the number of moles of precursor A, $R$ is the ideal gas constant, and $T$ is the constant temperature. The number of moles is related to mass by the molar mass $M_{A}$ as $n_{A} = \\frac{m_{A}}{M_{A}}$. Substituting this in gives:\n$$ P_{A}V = \\frac{m_{A}}{M_{A}}RT \\implies m_{A} = \\frac{M_{A}V}{RT} P_{A} $$\nSince $V$, $T$, $M_{A}$, and $R$ are all constants, we can differentiate this expression with respect to time $t$:\n$$ \\frac{dm_{A}}{dt} = \\frac{M_{A}V}{RT} \\frac{dP_{A}}{dt} $$\nNow, we substitute the expressions for both $m_{A}$ and $\\frac{dm_{A}}{dt}$ back into the mass balance differential equation:\n$$ \\frac{M_{A}V}{RT} \\frac{dP_{A}}{dt} = -\\frac{S}{V} \\left( \\frac{M_{A}V}{RT} P_{A} \\right) $$\nThe constant factor $\\frac{M_{A}V}{RT}$ cancels from both sides, yielding the governing relation for the precursor partial pressure:\n$$ \\frac{dP_{A}}{dt} = -\\frac{S}{V} P_{A} $$\nThis is the first part of the required answer. To find the purge time, we solve this first-order linear ordinary differential equation by separation of variables. Let the purge start at $t=0$ with an initial pressure $P_{A}(0)$ and end at time $t_{f}$ with a final pressure $P_{A}(t_{f})$.\n$$ \\frac{dP_{A}}{P_{A}} = -\\frac{S}{V} dt $$\nIntegrating both sides over the specified interval:\n$$ \\int_{P_{A}(0)}^{P_{A}(t_{f})} \\frac{1}{P_{A}} dP_{A} = \\int_{0}^{t_{f}} -\\frac{S}{V} dt $$\n$$ \\left[ \\ln(P_{A}) \\right]_{P_{A}(0)}^{P_{A}(t_{f})} = -\\frac{S}{V} \\left[ t \\right]_{0}^{t_{f}} $$\n$$ \\ln(P_{A}(t_{f})) - \\ln(P_{A}(0)) = -\\frac{S}{V} t_{f} $$\nThis simplifies to:\n$$ \\ln\\left(\\frac{P_{A}(t_{f})}{P_{A}(0)}\\right) = -\\frac{S}{V} t_{f} $$\nThe problem requires finding the time $t_{f}$ for the partial pressure to be reduced by a factor of $10^{3}$, which means the pressure ratio is:\n$$ \\frac{P_{A}(t_{f})}{P_{A}(0)} = \\frac{1}{10^{3}} = 10^{-3} $$\nSubstituting this ratio into the integrated equation:\n$$ \\ln(10^{-3}) = -\\frac{S}{V} t_{f} $$\nUsing the logarithm property $\\ln(x^{a}) = a \\ln(x)$:\n$$ -3 \\ln(10) = -\\frac{S}{V} t_{f} $$\nSolving for the purge time $t_{f}$:\n$$ t_{f} = 3 \\ln(10) \\left(\\frac{V}{S}\\right) $$\nNow, we substitute the given numerical values: $V=20\\,\\text{L}$ and $S=2000\\,\\text{L/s}$.\n$$ t_{f} = 3 \\ln(10) \\left(\\frac{20\\,\\text{L}}{2000\\,\\text{L/s}}\\right) = 3 \\ln(10) \\left(0.01\\,\\text{s}\\right) $$\n$$ t_{f} = 0.03 \\ln(10)\\,\\text{s} $$\nUsing the numerical value for $\\ln(10) \\approx 2.302585$:\n$$ t_{f} \\approx 0.03 \\times 2.302585\\,\\text{s} \\approx 0.06907755\\,\\text{s} $$\nThe problem asks for the answer to be rounded to three significant figures. The calculated value is approximately $0.06907755\\,\\text{s}$. The third significant digit is $0$, and the next digit is $7$, so we round up.\n$$ t_{f} \\approx 0.0691\\,\\text{s} $$\nThis is the required purge time.",
            "answer": "$$\\boxed{0.0691}$$"
        },
        {
            "introduction": "While the assumption of complete surface saturation in each half-reaction is a useful idealization, real-world ALD processes are governed by reaction kinetics and finite exposure times. This advanced computational problem challenges you to model the dynamic evolution of the surface chemistry over multiple cycles . By implementing a kinetic model for the TMA/$\\mathrm{H}_{2}\\mathrm{O}$ system, you will discover how the surface composition reaches a steady periodic state, even when individual reactions are incomplete. This exercise provides a more nuanced understanding of how process parameters like precursor dose establish a stable, predictable GPC, revealing the robust nature of the ALD process.",
            "id": "2469106",
            "problem": "You are to model the two-step surface chemistry in one cycle of Atomic Layer Deposition (ALD) of aluminum oxide using Trimethylaluminum (TMA) and water ($\\text{H}_2\\text{O}$). Consider a uniform surface with a fixed density of reactive sites per unit area, denoted $S_{\\max}$ (in nm$^{-2}$). Each site is either hydroxylated ($\\text{--OH}$) or methyl-terminated ($\\text{--CH}_3$). Let $\\theta_{\\mathrm{OH}}$ and $\\theta_{\\mathrm{CH_3}}$ denote the areal densities (in nm$^{-2}$) of the $\\text{--OH}$ and $\\text{--CH}_3$ groups, respectively, satisfying the site balance $\\theta_{\\mathrm{OH}} + \\theta_{\\mathrm{CH_3}} = S_{\\max}$ at all times.\n\nIn each cycle, two half-reactions occur under constant partial pressure and exposure time:\n\n- TMA half-reaction: gas-phase TMA reacts with surface $\\text{--OH}$ to form $\\text{--CH}_3$ termination. Assume pseudo-first-order kinetics with respect to the surface group density under constant TMA partial pressure. The rate of consumption of $\\text{--OH}$ during TMA exposure is modeled by $d\\theta_{\\mathrm{OH}}/dt = -k_{\\mathrm{TMA}}\\,p_{\\mathrm{TMA}}\\,\\theta_{\\mathrm{OH}}$, with $k_{\\mathrm{TMA}}$ having units of $(\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1})$, $p_{\\mathrm{TMA}}$ in $\\mathrm{Pa}$, and time $t$ in $\\mathrm{s}$. The corresponding production rate for $\\text{--CH}_3$ is $d\\theta_{\\mathrm{CH_3}}/dt = +k_{\\mathrm{TMA}}\\,p_{\\mathrm{TMA}}\\,\\theta_{\\mathrm{OH}}$.\n- $\\text{H}_2\\text{O}$ half-reaction: gas-phase $\\text{H}_2\\text{O}$ reacts with surface $\\text{--CH}_3$ to regenerate $\\text{--OH}$. Assume pseudo-first-order kinetics with $d\\theta_{\\mathrm{CH_3}}/dt = -k_{\\mathrm{H_2O}}\\,p_{\\mathrm{H_2O}}\\,\\theta_{\\mathrm{CH_3}}$ and $d\\theta_{\\mathrm{OH}}/dt = +k_{\\mathrm{H_2O}}\\,p_{\\mathrm{H_2O}}\\,\\theta_{\\mathrm{CH_3}}$, with $k_{\\mathrm{H_2O}}$ in $(\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1})$ and $p_{\\mathrm{H_2O}}$ in $\\mathrm{Pa}$.\n\nLet the TMA and $\\text{H}_2\\text{O}$ exposure durations be $\\tau_{\\mathrm{TMA}}$ and $\\tau_{\\mathrm{H_2O}}$ (in $\\mathrm{s}$). Define the dimensionless exposure doses $D_{\\mathrm{TMA}} = k_{\\mathrm{TMA}}\\,p_{\\mathrm{TMA}}\\,\\tau_{\\mathrm{TMA}}$ and $D_{\\mathrm{H_2O}} = k_{\\mathrm{H_2O}}\\,p_{\\mathrm{H_2O}}\\,\\tau_{\\mathrm{H_2O}}$.\n\nUnder these assumptions, over one TMA exposure, the state update is\n$\\theta_{\\mathrm{OH}}^{+} = \\theta_{\\mathrm{OH}}^{-}\\,e^{-D_{\\mathrm{TMA}}}$ and $\\theta_{\\mathrm{CH_3}}^{+} = \\theta_{\\mathrm{CH_3}}^{-} + \\theta_{\\mathrm{OH}}^{-}\\left(1 - e^{-D_{\\mathrm{TMA}}}\\right)$,\nand over one $\\text{H}_2\\text{O}$ exposure,\n$\\theta_{\\mathrm{CH_3}}^{+} = \\theta_{\\mathrm{CH_3}}^{-}\\,e^{-D_{\\mathrm{H_2O}}}$ and $\\theta_{\\mathrm{OH}}^{+} = \\theta_{\\mathrm{OH}}^{-} + \\theta_{\\mathrm{CH_3}}^{-}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right)$.\nHere superscripts $-$ and $+$ denote the values immediately before and after a given half-reaction, respectively.\n\nTask:\n- Write a program that, given $S_{\\max}$, $k_{\\mathrm{TMA}}$, $p_{\\mathrm{TMA}}$, $\\tau_{\\mathrm{TMA}}$, $k_{\\mathrm{H_2O}}$, $p_{\\mathrm{H_2O}}$, and $\\tau_{\\mathrm{H_2O}}$, computes the steady periodic state compositions at the start of each half-cycle, that is:\n  1. The steady-state densities $(\\theta_{\\mathrm{OH}},\\theta_{\\mathrm{CH_3}})$ at the start of TMA exposure (immediately after $\\text{H}_2\\text{O}$ exposure).\n  2. The steady-state densities $(\\theta_{\\mathrm{OH}},\\theta_{\\mathrm{CH_3}})$ at the start of $\\text{H}_2\\text{O}$ exposure (immediately after TMA exposure).\n- Express all densities in nm$^{-2}$, rounded to six decimal places.\n\nUse the following test suite of parameter sets. Each set is a tuple $(S_{\\max}, k_{\\mathrm{TMA}}, p_{\\mathrm{TMA}}, \\tau_{\\mathrm{TMA}}, k_{\\mathrm{H_2O}}, p_{\\mathrm{H_2O}}, \\tau_{\\mathrm{H_2O}})$:\n\n- Test 1 (moderate exposures): $(5.0, 0.05, 20.0, 1.0, 0.03, 40.0, 1.0)$ so $D_{\\mathrm{TMA}} = 0.05 \\cdot 20.0 \\cdot 1.0 = 1.0$ and $D_{\\mathrm{H_2O}} = 0.03 \\cdot 40.0 \\cdot 1.0 = 1.2$.\n- Test 2 (saturating exposures): $(6.0, 0.1, 100.0, 1.0, 0.1, 100.0, 1.0)$ so $D_{\\mathrm{TMA}} = 10.0$ and $D_{\\mathrm{H_2O}} = 10.0$.\n- Test 3 (very low exposures): $(4.5, 0.001, 10.0, 1.0, 0.001, 10.0, 1.0)$ so $D_{\\mathrm{TMA}} = 0.01$ and $D_{\\mathrm{H_2O}} = 0.01$.\n- Test 4 (asymmetric exposures): $(7.0, 0.05, 100.0, 1.0, 0.01, 20.0, 1.0)$ so $D_{\\mathrm{TMA}} = 5.0$ and $D_{\\mathrm{H_2O}} = 0.2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets. For each test case, output a list of four floats in the order $[\\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}}, \\theta_{\\mathrm{CH_3}}^{\\mathrm{TMA\\_start}}, \\theta_{\\mathrm{OH}}^{\\mathrm{H_2O\\_start}}, \\theta_{\\mathrm{CH_3}}^{\\mathrm{H_2O\\_start}}]$, all in nm$^{-2}$ and rounded to six decimal places. For example, your program should print a single line like:\n[[a,b,c,d],[e,f,g,h],[i,j,k,l],[m,n,o,p]]\nwhere $a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p$ are the computed floats for the four tests, respectively.",
            "solution": "We develop the solution from first principles using site conservation and pseudo-first-order kinetics under constant gas exposure.\n\n1. Site conservation and state variables. Let $\\theta_{\\mathrm{OH}}$ and $\\theta_{\\mathrm{CH_3}}$ be the areal densities of hydroxyl and methyl terminations, respectively, with the site balance $\\theta_{\\mathrm{OH}} + \\theta_{\\mathrm{CH_3}} = S_{\\max}$. We seek the surface composition immediately before each exposure in the steady periodic state, meaning the state repeats cycle to cycle.\n\n2. Kinetic base for each half-reaction. For a gas-phase species under constant partial pressure reacting with a surface group, the Law of Mass Action and a mean-field surface model give a rate law first-order in the surface group and proportional to gas partial pressure, $r = k\\,p\\,\\theta$, where $k$ is an effective rate constant in $(\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1})$, $p$ is in $\\mathrm{Pa}$, and $\\theta$ is the surface-group density in nm$^{-2}$. Under constant $p$ over an exposure of duration $\\tau$, the governing equation $d\\theta/dt = \\pm k\\,p\\,\\theta$ integrates to an exponential transform with dimensionless dose $D = k\\,p\\,\\tau$.\n\n   - TMA half-reaction: $d\\theta_{\\mathrm{OH}}/dt = -k_{\\mathrm{TMA}}\\,p_{\\mathrm{TMA}}\\,\\theta_{\\mathrm{OH}}$ and $d\\theta_{\\mathrm{CH_3}}/dt = +k_{\\mathrm{TMA}}\\,p_{\\mathrm{TMA}}\\,\\theta_{\\mathrm{OH}}$. Integrating over time $\\tau_{\\mathrm{TMA}}$ yields\n   $\\theta_{\\mathrm{OH}}^{+} = \\theta_{\\mathrm{OH}}^{-} e^{-D_{\\mathrm{TMA}}}$ and $\\theta_{\\mathrm{CH_3}}^{+} = \\theta_{\\mathrm{CH_3}}^{-} + \\theta_{\\mathrm{OH}}^{-}\\left(1 - e^{-D_{\\mathrm{TMA}}}\\right)$, where $D_{\\mathrm{TMA}} = k_{\\mathrm{TMA}}\\,p_{\\mathrm{TMA}}\\,\\tau_{\\mathrm{TMA}}$.\n   - $\\text{H}_2\\text{O}$ half-reaction: $d\\theta_{\\mathrm{CH_3}}/dt = -k_{\\mathrm{H_2O}}\\,p_{\\mathrm{H_2O}}\\,\\theta_{\\mathrm{CH_3}}$ and $d\\theta_{\\mathrm{OH}}/dt = +k_{\\mathrm{H_2O}}\\,p_{\\mathrm{H_2O}}\\,\\theta_{\\mathrm{CH_3}}$. Integrating over $\\tau_{\\mathrm{H_2O}}$ gives\n   $\\theta_{\\mathrm{CH_3}}^{+} = \\theta_{\\mathrm{CH_3}}^{-} e^{-D_{\\mathrm{H_2O}}}$ and $\\theta_{\\mathrm{OH}}^{+} = \\theta_{\\mathrm{OH}}^{-} + \\theta_{\\mathrm{CH_3}}^{-}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right)$, where $D_{\\mathrm{H_2O}} = k_{\\mathrm{H_2O}}\\,p_{\\mathrm{H_2O}}\\,\\tau_{\\mathrm{H_2O}}$.\n\n   These updates conserve $\\theta_{\\mathrm{OH}} + \\theta_{\\mathrm{CH_3}}$, consistent with the site balance.\n\n3. Composing the two-step map over one cycle. Let the start-of-cycle state (start of TMA exposure) be $(\\theta_{\\mathrm{OH}}^{A}, \\theta_{\\mathrm{CH_3}}^{A})$, and after TMA exposure $(\\theta_{\\mathrm{OH}}^{B}, \\theta_{\\mathrm{CH_3}}^{B})$, and after H$_2$O exposure (which is also the start of the next cycle) $(\\theta_{\\mathrm{OH}}^{A'}, \\theta_{\\mathrm{CH_3}}^{A'})$.\n\n   From the TMA step,\n   $\\theta_{\\mathrm{OH}}^{B} = \\theta_{\\mathrm{OH}}^{A} e^{-D_{\\mathrm{TMA}}}$,\n   $\\theta_{\\mathrm{CH_3}}^{B} = \\theta_{\\mathrm{CH_3}}^{A} + \\theta_{\\mathrm{OH}}^{A}(1 - e^{-D_{\\mathrm{TMA}}})$.\n   From the $\\text{H}_2\\text{O}$ step,\n   $\\theta_{\\mathrm{CH_3}}^{A'} = \\theta_{\\mathrm{CH_3}}^{B} e^{-D_{\\mathrm{H_2O}}}$,\n   $\\theta_{\\mathrm{OH}}^{A'} = \\theta_{\\mathrm{OH}}^{B} + \\theta_{\\mathrm{CH_3}}^{B}(1 - e^{-D_{\\mathrm{H_2O}}})$.\n\n   Because $\\theta_{\\mathrm{OH}} + \\theta_{\\mathrm{CH_3}} = S_{\\max}$ at all times, we can reduce to a single variable. In particular, $\\theta_{\\mathrm{CH_3}}^{X} = S_{\\max} - \\theta_{\\mathrm{OH}}^{X}$ for any stage $X \\in \\{A,B,A'\\}$.\n\n   Substituting this into the composition after both steps, we obtain a one-dimensional affine map for $\\theta_{\\mathrm{OH}}$:\n   $\\theta_{\\mathrm{OH}}^{A'} = S_{\\max}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right) + \\left(\\theta_{\\mathrm{OH}}^{A} e^{-D_{\\mathrm{TMA}}}\\right) e^{-D_{\\mathrm{H_2O}}} = S_{\\max}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right) + \\theta_{\\mathrm{OH}}^{A} e^{-(D_{\\mathrm{TMA}} + D_{\\mathrm{H_2O}})}$.\n\n4. Steady periodic state and its uniqueness. At steady periodic state, the start-of-cycle composition is invariant, so $\\theta_{\\mathrm{OH}}^{A'} = \\theta_{\\mathrm{OH}}^{A} \\equiv \\theta_{\\mathrm{OH}}^{\\ast}$. Solving\n$\\theta_{\\mathrm{OH}}^{\\ast} = S_{\\max}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right) + \\theta_{\\mathrm{OH}}^{\\ast} e^{-(D_{\\mathrm{TMA}} + D_{\\mathrm{H_2O}})}$\nfor $\\theta_{\\mathrm{OH}}^{\\ast}$ gives\n$\\theta_{\\mathrm{OH}}^{\\ast} \\left(1 - e^{-(D_{\\mathrm{TMA}} + D_{\\mathrm{H_2O}})}\\right) = S_{\\max}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right)$,\nhence\n$\\theta_{\\mathrm{OH}}^{\\ast} = \\dfrac{S_{\\max}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right)}{1 - e^{-(D_{\\mathrm{TMA}} + D_{\\mathrm{H_2O}})}}$.\nThen $\\theta_{\\mathrm{CH_3}}^{\\ast} = S_{\\max} - \\theta_{\\mathrm{OH}}^{\\ast}$ is the steady composition at the start of TMA exposure. The composition at the start of $\\text{H}_2\\text{O}$ exposure is obtained by applying the TMA update once:\n$\\theta_{\\mathrm{OH}}^{B,\\ast} = \\theta_{\\mathrm{OH}}^{\\ast} e^{-D_{\\mathrm{TMA}}}$ and $\\theta_{\\mathrm{CH_3}}^{B,\\ast} = S_{\\max} - \\theta_{\\mathrm{OH}}^{B,\\ast}$.\n\n   The factor $e^{-(D_{\\mathrm{TMA}} + D_{\\mathrm{H_2O}})}$ lies strictly between $0$ and $1$ for positive doses, making the affine map a contraction and guaranteeing a unique and globally attracting steady periodic state, which justifies computing it either directly by the closed-form expression or via iterative cycling until convergence.\n\n5. Algorithm. For each test case:\n   - Compute $D_{\\mathrm{TMA}} = k_{\\mathrm{TMA}}\\,p_{\\mathrm{TMA}}\\,\\tau_{\\mathrm{TMA}}$ and $D_{\\mathrm{H_2O}} = k_{\\mathrm{H_2O}}\\,p_{\\mathrm{H_2O}}\\,\\tau_{\\mathrm{H_2O}}$.\n   - Compute $\\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} = \\dfrac{S_{\\max}\\left(1 - e^{-D_{\\mathrm{H_2O}}}\\right)}{1 - e^{-(D_{\\mathrm{TMA}} + D_{\\mathrm{H_2O}})}}$ and $\\theta_{\\mathrm{CH_3}}^{\\mathrm{TMA\\_start}} = S_{\\max} - \\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}}$.\n   - Compute $\\theta_{\\mathrm{OH}}^{\\mathrm{H_2O\\_start}} = \\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} e^{-D_{\\mathrm{TMA}}}$ and $\\theta_{\\mathrm{CH_3}}^{\\mathrm{H_2O\\_start}} = S_{\\max} - \\theta_{\\mathrm{OH}}^{\\mathrm{H_2O\\_start}}$.\n   - Round each density to six decimal places (nm$^{-2}$).\n\n6. Numerical evaluation for the test suite (rounded to six decimals; all in nm$^{-2}$). The program will compute:\n   - Test $1$: $S_{\\max} = 5.0$, $D_{\\mathrm{TMA}} = 1.0$, $D_{\\mathrm{H_2O}} = 1.2$. This yields $\\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} \\approx \\dfrac{5.0\\,(1 - e^{-1.2})}{1 - e^{-2.2}}$, $\\theta_{\\mathrm{CH_3}}^{\\mathrm{TMA\\_start}} = 5.0 - \\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}}$, $\\theta_{\\mathrm{OH}}^{\\mathrm{H_2O\\_start}} = \\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} e^{-1.0}$, $\\theta_{\\mathrm{CH_3}}^{\\mathrm{H_2O\\_start}} = 5.0 - \\theta_{\\mathrm{OH}}^{\\mathrm{H_2O\\_start}}$.\n   - Test $2$: $S_{\\max} = 6.0$, $D_{\\mathrm{TMA}} = 10.0$, $D_{\\mathrm{H_2O}} = 10.0$. Nearly complete conversion each half-cycle, so $\\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} \\approx 6.0$, $\\theta_{\\mathrm{CH_3}}^{\\mathrm{TMA\\_start}} \\approx 0.0$, $\\theta_{\\mathrm{OH}}^{\\mathrm{H_2O\\_start}} \\approx 6.0 e^{-10}$, $\\theta_{\\mathrm{CH_3}}^{\\mathrm{H_2O\\_start}} \\approx 6.0 - 6.0 e^{-10}$.\n   - Test $3$: $S_{\\max} = 4.5$, $D_{\\mathrm{TMA}} = 0.01$, $D_{\\mathrm{H_2O}} = 0.01$. In the small-dose limit, $\\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} \\approx S_{\\max} \\dfrac{D_{\\mathrm{H_2O}}}{D_{\\mathrm{TMA}} + D_{\\mathrm{H_2O}}} \\approx 2.25$, with small corrections due to exponentials.\n   - Test $4$: $S_{\\max} = 7.0$, $D_{\\mathrm{TMA}} = 5.0$, $D_{\\mathrm{H_2O}} = 0.2$. Strong TMA converts most –OH to –CH$_3$, while weak H$_2$O regenerates only a small fraction of –OH before the next cycle, giving $\\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} \\approx \\dfrac{7.0\\,(1 - e^{-0.2})}{1 - e^{-5.2}}$, $\\theta_{\\mathrm{OH}}^{\\mathrm{H_2O\\_start}} \\approx \\theta_{\\mathrm{OH}}^{\\mathrm{TMA\\_start}} e^{-5.0}$.\n\nThe implementation follows these formulas and prints the requested list of lists, with each value rounded to six decimal places and expressed in nm$^{-2}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef steady_state_composition(S_max, k_TMA, p_TMA, tau_TMA, k_H2O, p_H2O, tau_H2O):\n    # Compute dimensionless doses\n    D_TMA = k_TMA * p_TMA * tau_TMA\n    D_H2O = k_H2O * p_H2O * tau_H2O\n\n    # Avoid numerical issues when doses are extremely small (but > 0 per problem design)\n    exp_TMA = np.exp(-D_TMA)\n    exp_H2O = np.exp(-D_H2O)\n    exp_sum = np.exp(-(D_TMA + D_H2O))\n\n    denom = 1.0 - exp_sum\n    # Compute steady-state OH at start of TMA exposure\n    theta_OH_TMA_start = S_max * (1.0 - exp_H2O) / denom\n    theta_CH3_TMA_start = S_max - theta_OH_TMA_start\n\n    # After TMA exposure (start of H2O)\n    theta_OH_H2O_start = theta_OH_TMA_start * exp_TMA\n    theta_CH3_H2O_start = S_max - theta_OH_H2O_start\n\n    # Round to six decimals\n    return [\n        round(float(theta_OH_TMA_start), 6),\n        round(float(theta_CH3_TMA_start), 6),\n        round(float(theta_OH_H2O_start), 6),\n        round(float(theta_CH3_H2O_start), 6),\n    ]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (S_max [nm^-2], k_TMA [s^-1 Pa^-1], p_TMA [Pa], tau_TMA [s],\n    #              k_H2O [s^-1 Pa^-1], p_H2O [Pa], tau_H2O [s])\n    test_cases = [\n        (5.0, 0.05, 20.0, 1.0, 0.03, 40.0, 1.0),   # D_TMA = 1.0, D_H2O = 1.2\n        (6.0, 0.1, 100.0, 1.0, 0.1, 100.0, 1.0),   # D_TMA = 10.0, D_H2O = 10.0\n        (4.5, 0.001, 10.0, 1.0, 0.001, 10.0, 1.0), # D_TMA = 0.01, D_H2O = 0.01\n        (7.0, 0.05, 100.0, 1.0, 0.01, 20.0, 1.0),  # D_TMA = 5.0, D_H2O = 0.2\n    ]\n\n    results = []\n    for case in test_cases:\n        S_max, k_TMA, p_TMA, tau_TMA, k_H2O, p_H2O, tau_H2O = case\n        result = steady_state_composition(S_max, k_TMA, p_TMA, tau_TMA, k_H2O, p_H2O, tau_H2O)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Print a Python-like list of lists, single line.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}