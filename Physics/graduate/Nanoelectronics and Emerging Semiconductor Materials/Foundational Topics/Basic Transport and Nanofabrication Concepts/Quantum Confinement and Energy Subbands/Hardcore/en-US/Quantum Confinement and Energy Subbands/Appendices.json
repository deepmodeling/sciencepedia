{
    "hands_on_practices": [
        {
            "introduction": "The infinite quantum well provides a foundational understanding of energy quantization, but real semiconductor heterostructures are built with finite potential barriers. This practice bridges the gap between this ideal model and physical reality. By deriving and numerically solving the transcendental equations for a finite potential well, you will directly observe how the barrier height influences the bound-state energies and the number of confined states, skills that are essential for the design and analysis of quantum devices .",
            "id": "4296358",
            "problem": "You are to write a complete, runnable program that models a one-dimensional symmetric finite square quantum well in the Effective Mass Approximation (EMA). Starting only from the time-independent Schrödinger equation, continuity of the wave function and its derivative at potential discontinuities, and standard boundary conditions, derive the quantization conditions for bound states in a symmetric finite square well with interior potential $V(x)=0$ for $|x|<L/2$ and exterior barrier height $V(x)=V_0$ for $|x|\\ge L/2$. Express the well half-width as $a=L/2$, the interior wavenumber as $k=\\sqrt{2m^\\ast E}/\\hbar$, and the exterior decay constant as $\\kappa=\\sqrt{2m^\\ast (V_0-E)}/\\hbar$, where $\\hbar$ is the reduced Planck constant, $m^\\ast$ is the semiconductor effective mass, $E$ is the bound-state energy obeying $0 < E < V_0$, and $V_0$ is the finite barrier height. Reduce the quantization conditions to a dimensionless form in terms of $z=ka$ and $b=a\\sqrt{2m^\\ast V_0}/\\hbar$, and use these conditions to compute the lowest two bound-state energies $E_1$ (even parity) and $E_2$ (odd parity) when they exist. Compare each with the corresponding infinite square well energy levels of the same width $L$, namely $E_n^{(\\infty)}=\\hbar^2\\pi^2 n^2/(2m^\\ast L^2)$ for $n\\in\\{1,2\\}$.\n\nYour program must:\n- Implement a robust numerical procedure to locate the lowest even and odd parity solutions using the derived dimensionless quantization conditions without relying on closed-form shortcuts.\n- Convert all input physical parameters to International System of Units (SI) for calculation: lengths in meters, energy in joules, and mass in kilograms.\n- Output, for each test case, the relative shift for $E_1$ and $E_2$ defined by $(E_n(V_0)-E_n^{(\\infty)})/E_n^{(\\infty)}$ as dimensionless decimals. If a requested level $E_2$ does not exist for that test case, output $-1.0$ for its relative shift.\n\nUse the following constants within SI units:\n- Reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$,\n- Elementary charge (to convert electronvolt to joule) $q_e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$,\n- Free electron mass $m_0 = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$.\n\nTest suite (each case is a tuple of $(L,V_0,m^\\ast)$):\n- Case $1$: $L=5\\ \\mathrm{nm}$, $V_0=0.05\\ \\mathrm{eV}$, $m^\\ast=0.19\\,m_0$.\n- Case $2$: $L=5\\ \\mathrm{nm}$, $V_0=0.5\\ \\mathrm{eV}$, $m^\\ast=0.067\\,m_0$.\n- Case $3$: $L=5\\ \\mathrm{nm}$, $V_0=5.0\\ \\mathrm{eV}$, $m^\\ast=0.067\\,m_0$.\n- Case $4$: $L=10\\ \\mathrm{nm}$, $V_0=50.0\\ \\mathrm{eV}$, $m^\\ast=0.26\\,m_0$.\n\nAngle quantities in trigonometric functions are in radians. The final output must aggregate all test cases into a single line as a comma-separated list enclosed in square brackets, ordered as $[\\Delta_1^{(1)},\\Delta_2^{(1)},\\Delta_1^{(2)},\\Delta_2^{(2)},\\Delta_1^{(3)},\\Delta_2^{(3)},\\Delta_1^{(4)},\\Delta_2^{(4)}]$, where $\\Delta_n^{(i)}=(E_n(V_0)-E_n^{(\\infty)})/E_n^{(\\infty)}$ for test case $i$ and level $n$. All outputs are dimensionless decimals. If $E_2$ does not exist for a test case, place $-1.0$ for that position.",
            "solution": "The physical system under consideration is a one-dimensional symmetric finite square quantum well. The potential $V(x)$ is defined as $V(x)=0$ for $|x|<L/2$ and $V(x)=V_0$ for $|x|\\ge L/2$. For convenience, we define the half-width of the well as $a=L/2$. We seek bound-state solutions where the energy $E$ of the particle is in the range $0 < E < V_0$.\n\nThe analysis begins with the time-independent Schrödinger equation (TISE) in one dimension, under the Effective Mass Approximation (EMA), where the electron mass is replaced by its effective mass $m^\\ast$ in the semiconductor crystal:\n$$-\\frac{\\hbar^2}{2m^\\ast}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$$\nWe solve this equation in the three spatial regions:\nRegion I ($x \\le -a$): $V(x) = V_0$. The TISE is $\\frac{d^2\\psi}{dx^2} = \\frac{2m^\\ast(V_0-E)}{\\hbar^2}\\psi(x)$.\nDefining the decay constant $\\kappa = \\sqrt{2m^\\ast(V_0-E)}/\\hbar$, the equation becomes $\\frac{d^2\\psi}{dx^2} = \\kappa^2\\psi(x)$. The general solution is $\\psi_I(x) = C_1 e^{\\kappa x} + C_2 e^{-\\kappa x}$. For a bound state, the wavefunction must vanish as $x \\to -\\infty$, which requires $C_2=0$. Thus, $\\psi_I(x) = A e^{\\kappa x}$.\n\nRegion II ($-a < x < a$): $V(x) = 0$. The TISE is $\\frac{d^2\\psi}{dx^2} = -\\frac{2m^\\ast E}{\\hbar^2}\\psi(x)$.\nDefining the wavenumber $k = \\sqrt{2m^\\ast E}/\\hbar$, the equation becomes $\\frac{d^2\\psi}{dx^2} = -k^2\\psi(x)$. The general solution is oscillatory: $\\psi_{II}(x) = B\\cos(kx) + C\\sin(kx)$.\n\nRegion III ($x \\ge a$): $V(x) = V_0$. This region is symmetric to Region I. The TISE is again $\\frac{d^2\\psi}{dx^2} = \\kappa^2\\psi(x)$. The bound-state condition requires the wavefunction to vanish as $x \\to +\\infty$, which implies the solution is of the form $\\psi_{III}(x) = F e^{-\\kappa x}$.\n\nThe potential $V(x)$ is symmetric ($V(x)=V(-x)$), so the solutions $\\psi(x)$ can be separated into states of definite parity: even functions where $\\psi(x)=\\psi(-x)$ and odd functions where $\\psi(x)=-\\psi(-x)$.\n\n**Even Parity Solutions**\nFor an even function, $\\psi_{II}(x)$ must be a cosine function, so $C=0$ and $\\psi_{II}(x) = B\\cos(kx)$. By symmetry, we only need to apply boundary conditions at $x=a$.\nThe wavefunction $\\psi(x)$ and its derivative $\\psi'(x)$ must be continuous at $x=a$.\n1. $\\psi_{II}(a) = \\psi_{III}(a) \\implies B\\cos(ka) = F e^{-\\kappa a}$\n2. $\\psi'_{II}(a) = \\psi'_{III}(a) \\implies -kB\\sin(ka) = -\\kappa F e^{-\\kappa a}$\n\nDividing the second equation by the first gives:\n$$\\frac{-kB\\sin(ka)}{B\\cos(ka)} = \\frac{-\\kappa F e^{-\\kappa a}}{F e^{-\\kappa a}} \\implies k\\tan(ka) = \\kappa$$\nThis is the transcendental equation for even-parity bound states.\n\n**Odd Parity Solutions**\nFor an odd function, $\\psi_{II}(x)$ must be a sine function, so $B=0$ and $\\psi_{II}(x) = C\\sin(kx)$. Applying boundary conditions at $x=a$:\n1. $\\psi_{II}(a) = \\psi_{III}(a) \\implies C\\sin(ka) = F e^{-\\kappa a}$\n2. $\\psi'_{II}(a) = \\psi'_{III}(a) \\implies kC\\cos(ka) = -\\kappa F e^{-\\kappa a}$\n\nDividing the second equation by the first gives:\n$$\\frac{kC\\cos(ka)}{C\\sin(ka)} = \\frac{-\\kappa F e^{-\\kappa a}}{F e^{-\\kappa a}} \\implies k\\cot(ka) = -\\kappa$$\nThis is the transcendental equation for odd-parity bound states.\n\n**Dimensionless Formulation**\nTo facilitate a numerical solution, we introduce dimensionless variables. Let $z = ka$ and $\\eta = \\kappa a$. The quantization conditions become:\n- Even states: $z\\tan(z) = \\eta$\n- Odd states: $z\\cot(z) = -\\eta$, or $-z\\cot(z) = \\eta$\n\nWe can relate $z$ and $\\eta$ through a single parameter that characterizes the well.\n$$z^2 + \\eta^2 = (ka)^2 + (\\kappa a)^2 = a^2\\left(\\frac{2m^\\ast E}{\\hbar^2}\\right) + a^2\\left(\\frac{2m^\\ast (V_0-E)}{\\hbar^2}\\right) = \\frac{2m^\\ast a^2 V_0}{\\hbar^2}$$\nLet $b^2 = \\frac{2m^\\ast a^2 V_0}{\\hbar^2}$, which gives $b = \\frac{a \\sqrt{2m^\\ast V_0}}{\\hbar}$. The parameter $b$ depends only on the physical properties of the well ($L=2a$, $V_0$, $m^\\ast$), not on the energy $E$.\nFrom this, we have $\\eta = \\sqrt{b^2 - z^2}$. Substituting this into the quantization conditions yields the final forms to be solved numerically:\n- Even states ($E_1$, $E_3, \\dots$): $z\\tan(z) = \\sqrt{b^2 - z^2}$\n- Odd states ($E_2$, $E_4, \\dots$): $-z\\cot(z) = \\sqrt{b^2 - z^2}$\n\nThe energy of a state is found from its corresponding solution $z$ via $z=ka=\\frac{a\\sqrt{2m^\\ast E}}{\\hbar}$, which implies $E = \\frac{z^2 \\hbar^2}{2m^\\ast a^2}$.\n\n**Numerical Solution and Comparison**\nWe need to find the lowest energy even solution ($z_1$) and the lowest energy odd solution ($z_2$).\n- The first even solution $z_1$ is found by searching for the first root of $h_{even}(z) = z\\tan(z) - \\sqrt{b^2 - z^2} = 0$ in the interval $0 < z < \\pi/2$. A solution always exists for any $b>0$.\n- The first odd solution $z_2$ is found by searching for the first root of $h_{odd}(z) = z\\cot(z) + \\sqrt{b^2 - z^2} = 0$ in the interval $\\pi/2 < z < \\pi$. An odd solution exists only if the well is deep/wide enough, specifically when $b > \\pi/2$. If $b \\le \\pi/2$, no odd bound state exists.\n\nThe energies are compared to the infinite square well levels for a well of the same width $L=2a$, given by $E_n^{(\\infty)} = \\frac{n^2\\pi^2\\hbar^2}{2m^\\ast L^2} = \\frac{n^2\\pi^2\\hbar^2}{8m^\\ast a^2}$.\nThe relative shift is $\\Delta_n = (E_n(V_0) - E_n^{(\\infty)})/E_n^{(\\infty)}$.\n$$\\Delta_n = \\frac{\\frac{z_n^2 \\hbar^2}{2m^\\ast a^2} - \\frac{n^2\\pi^2\\hbar^2}{8m^\\ast a^2}}{\\frac{n^2\\pi^2\\hbar^2}{8m^\\ast a^2}} = \\frac{z_n^2/2}{n^2\\pi^2/8} - 1 = \\frac{4z_n^2}{n^2\\pi^2} - 1$$\nFor the two lowest states, this gives:\n- $\\Delta_1 = \\frac{4z_1^2}{\\pi^2} - 1$\n- $\\Delta_2 = \\frac{4z_2^2}{(2)^2\\pi^2} - 1 = \\frac{z_2^2}{\\pi^2} - 1$\n\nThe numerical implementation will involve a root-finding algorithm, such as the Brent method, to solve for $z_1$ and $z_2$ for each test case, after converting all given parameters to SI units. If $z_2$ does not exist for a given test case, its relative shift will be reported as $-1.0$.\nAll physical constants are used in their SI unit representations: $\\hbar$ in $\\mathrm{J\\cdot s}$, $q_e$ in $\\mathrm{C}$ for converting $\\mathrm{eV}$ to $\\mathrm{J}$, and $m_0$ in $\\mathrm{kg}$. Lengths are converted from $\\mathrm{nm}$ to $\\mathrm{m}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the finite square well problem for a given set of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    HBAR = 1.054571817e-34  # J·s\n    QE = 1.602176634e-19    # C\n    M0 = 9.1093837015e-31   # kg\n\n    # Test cases: (L_nm, V0_eV, m_star_ratio)\n    test_cases = [\n        (5.0, 0.05, 0.19),\n        (5.0, 0.5, 0.067),\n        (5.0, 5.0, 0.067),\n        (10.0, 50.0, 0.26),\n    ]\n\n    all_results = []\n    \n    # Small epsilon to avoid singularities at the boundaries of search intervals\n    epsilon = 1e-12\n\n    for L_nm, V0_eV, m_star_ratio in test_cases:\n        # Convert inputs to SI units\n        L = L_nm * 1e-9                     # m\n        a = L / 2.0                         # m\n        V0 = V0_eV * QE                     # J\n        m_star = m_star_ratio * M0          # kg\n\n        # Calculate the dimensionless well parameter 'b'\n        b = (a * np.sqrt(2 * m_star * V0)) / HBAR\n\n        # Define the transcendental functions for root-finding.\n        # h(z) = 0 needs to be solved.\n        # Even solutions: z * tan(z) = sqrt(b^2 - z^2)\n        def h_even(z):\n            if abs(b) < abs(z): # Avoid domain errors for sqrt\n                return np.nan # Should not happen if interval is correct\n            return z * np.tan(z) - np.sqrt(b**2 - z**2)\n\n        # Odd solutions: -z * cot(z) = sqrt(b^2 - z^2) -> z*cot(z) + sqrt(b^2 - z^2) = 0\n        def h_odd(z):\n            if abs(b) < abs(z): # Avoid domain errors for sqrt\n                return np.nan\n            return z / np.tan(z) + np.sqrt(b**2 - z**2)\n\n        # --- Calculate E1 (lowest even state) ---\n        # The first even state solution z1 is in (0, pi/2).\n        # It exists for any b > 0.\n        # The search interval for z is (0, min(b, pi/2)).\n        # brentq requires the function values at the interval ends to have opposite signs.\n        z1_upper_bound = min(b, np.pi / 2.0)\n        try:\n            z1 = brentq(h_even, epsilon, z1_upper_bound - epsilon)\n            # Relative shift for E1: delta_1 = (4 * z1^2 / pi^2) - 1\n            delta_1 = (4 * z1**2 / (np.pi**2)) - 1.0\n        except ValueError:\n             # This should not be reached for the even case as a solution always exists.\n             # Added for robustness.\n            delta_1 = -1.0 # Error indicator\n\n        all_results.append(delta_1)\n\n        # --- Calculate E2 (lowest odd state) ---\n        # The first odd state exists only if b > pi/2.\n        if b > np.pi / 2.0:\n            # The first odd state solution z2 is in (pi/2, pi).\n            # The search interval is (pi/2, min(b, pi)).\n            z2_upper_bound = min(b, np.pi)\n            try:\n                z2 = brentq(h_odd, np.pi / 2.0 + epsilon, z2_upper_bound - epsilon)\n                # Relative shift for E2: delta_2 = (z2^2 / pi^2) - 1\n                delta_2 = (z2**2 / (np.pi**2)) - 1.0\n            except ValueError:\n                # Can occur if bounds don't have opposite signs due to numerical precision.\n                delta_2 = -1.0 # Error indicator\n        else:\n            # The second bound state does not exist.\n            delta_2 = -1.0\n            \n        all_results.append(delta_2)\n\n    # Format the final output string as [res1,res2,res3,...]\n    # Using 'g' format specifier for clean decimal representation\n    output_str = f\"[{','.join(f'{res:.10g}' for res in all_results)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Once the discrete energy subbands are established, the next crucial question is how charge carriers occupy these states. This exercise moves from single-particle quantum mechanics to the statistical physics of many-electron systems in one dimension. You will explore the characteristic $1/\\sqrt{E}$ singularity of the one-dimensional Density of States (DOS) and use the Fermi-Dirac distribution to calculate carrier populations under thermal equilibrium, providing a quantitative understanding of how electrons are distributed among subbands in a quantum wire .",
            "id": "4296392",
            "problem": "A quasi-one-dimensional quantum wire with parabolic subbands exhibits a characteristic square-root singularity in the one-dimensional Density of States (DOS) near each subband edge. Consider the first two propagating modes (subbands) with edges at energies $E_1$ and $E_2$, measured relative to the electrochemical potential (Fermi energy) $E_{\\mathrm{F}}$, which is set to $0\\,\\mathrm{eV}$ as the reference. Assume identical spin and valley degeneracies for both modes and the same effective mass. Carriers obey the Fermi–Dirac distribution, and thermal smearing must be included.\n\nStarting only from the following fundamental base:\n- Quantum state counting in one dimension, parabolic dispersion in each subband, and the definition of the one-dimensional DOS as the derivative of the quantum state count with respect to energy.\n- The Fermi–Dirac distribution $f(E,T)=\\left(1+\\exp\\left(\\frac{E-E_{\\mathrm{F}}}{k_{\\mathrm{B}} T}\\right)\\right)^{-1}$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the absolute temperature.\n- The definition of linear carrier density in a subband as the integral over energy of the product of the DOS and the occupancy function.\n\nYour task is to write a complete, runnable program that, for each test case below, computes the fraction of carriers occupying the second subband,\n$$r=\\frac{n_2}{n_1+n_2},$$\nwhere $n_1$ and $n_2$ are the linear carrier densities contributed by the first and second subbands, respectively, obtained by integrating the appropriate quasi-one-dimensional DOS multiplied by the Fermi–Dirac function over energy. Because both subbands share the same effective mass and degeneracy, any common prefactors cancel in the ratio $r$. You must include thermal smearing at finite temperature.\n\nPhysical and numerical units:\n- Energies $E_1$, $E_2$, and $E_{\\mathrm{F}}$ must be in $\\mathrm{eV}$.\n- Temperature $T$ must be in $\\mathrm{K}$.\n- The final fraction $r$ must be reported as a dimensionless decimal number (not a percentage).\n\nTest suite of parameter values, each specified as a triple $(E_1,E_2,T)$ with $E_{\\mathrm{F}}=0\\,\\mathrm{eV}$:\n- Case A (happy path, symmetric offsets near $E_{\\mathrm{F}}$ at room temperature): $( -0.005\\,\\mathrm{eV},\\; +0.005\\,\\mathrm{eV},\\; 300\\,\\mathrm{K} )$.\n- Case B (low-temperature boundary with both subbands slightly below $E_{\\mathrm{F}}$): $( -0.001\\,\\mathrm{eV},\\; -0.0002\\,\\mathrm{eV},\\; 4\\,\\mathrm{K} )$.\n- Case C (both subbands above $E_{\\mathrm{F}}$ probing exponential tails): $( +0.002\\,\\mathrm{eV},\\; +0.005\\,\\mathrm{eV},\\; 300\\,\\mathrm{K} )$.\n- Case D (nearly symmetric small offsets at cryogenic temperature): $( -0.0005\\,\\mathrm{eV},\\; +0.0005\\,\\mathrm{eV},\\; 10\\,\\mathrm{K} )$.\n\nAlgorithmic requirements:\n- Evaluate the linear density in each subband by integrating the quasi-one-dimensional DOS times the Fermi–Dirac function over energy from the corresponding subband edge to sufficiently high energy, using a numerically stable transformation that resolves the square-root singularity at the band edge and the thermal tail. The final result must be the fraction $r$ for each case, as defined above.\n- Use the physical constants consistently; however, because $r$ is a ratio with identical subband prefactors, you may exploit cancellations that do not alter correctness.\n\nFinal output format:\n- Your program should produce a single line of output containing the four results for $r$ corresponding to the four cases, as a comma-separated list enclosed in square brackets, for example, $\\,[r_A,r_B,r_C,r_D]\\,$. Each entry must be a decimal number.\n\nNo user input is required. The program must be self-contained and runnable as-is.",
            "solution": "We begin from quantum state counting in one dimension and the Fermi–Dirac statistics. For a quasi-one-dimensional quantum wire with parabolic subbands, the dispersion in subband $n$ is $E(k)=E_n+\\frac{\\hbar^2 k^2}{2 m^\\ast}$, where $E_n$ is the subband edge, $\\hbar$ is the reduced Planck constant, $k$ is the wavevector, and $m^\\ast$ is the effective mass. The number of quantum states per unit length in a wavevector interval $\\mathrm{d}k$ including both propagation directions is $\\frac{g_s g_v}{\\pi}\\,\\mathrm{d}k$, where $g_s$ and $g_v$ are the spin and valley degeneracies, respectively. Differentiating with respect to energy via $k(E)=\\frac{\\sqrt{2 m^\\ast (E-E_n)}}{\\hbar}$ and $\\frac{\\mathrm{d}k}{\\mathrm{d}E}=\\frac{m^\\ast}{\\hbar \\sqrt{2 m^\\ast (E-E_n)}}$ yields the one-dimensional Density of States (DOS) per unit length per unit energy for $E \\ge E_n$,\n$$g_{1\\mathrm{D}}(E;E_n)=\\frac{g_s g_v}{\\pi}\\,\\frac{\\mathrm{d}k}{\\mathrm{d}E}=\\frac{g_s g_v}{\\pi \\hbar}\\sqrt{\\frac{m^\\ast}{2}}\\;\\frac{1}{\\sqrt{E-E_n}}.$$\nThe occupation probability at energy $E$ and temperature $T$ is the Fermi–Dirac distribution $f(E,T)=\\left(1+\\exp\\left(\\frac{E-E_{\\mathrm{F}}}{k_{\\mathrm{B}} T}\\right)\\right)^{-1}$, with $E_{\\mathrm{F}}=0\\,\\mathrm{eV}$ by convention here. The linear carrier density contributed by subband $n$ is then\n$$n_n(T)=\\int_{E_n}^{\\infty} g_{1\\mathrm{D}}(E;E_n)\\, f(E,T)\\,\\mathrm{d}E.$$\nSubstituting $E=E_n+t^2$ with $t\\ge 0$ removes the square-root singularity at the subband edge because $\\mathrm{d}E=2 t\\,\\mathrm{d}t$ and $\\sqrt{E-E_n}=t$. The integral becomes\n$$n_n(T)=\\frac{g_s g_v}{\\pi \\hbar}\\sqrt{\\frac{m^\\ast}{2}}\\int_{0}^{\\infty}\\frac{1}{t}\\,f(E_n+t^2,T)\\,(2 t\\,\\mathrm{d}t)=\\frac{2 g_s g_v}{\\pi \\hbar}\\sqrt{\\frac{m^\\ast}{2}}\\int_{0}^{\\infty} f(E_n+t^2,T)\\,\\mathrm{d}t.$$\nDefine the subband-independent prefactor\n$$C=\\frac{2 g_s g_v}{\\pi \\hbar}\\sqrt{\\frac{m^\\ast}{2}},$$\nand the subband-dependent integral\n$$I(E_n,T)=\\int_{0}^{\\infty} f(E_n+t^2,T)\\,\\mathrm{d}t.$$\nThen $n_n(T)=C\\,I(E_n,T)$. For two subbands with identical $g_s$, $g_v$, and $m^\\ast$, the fraction of carriers in the second subband is\n$$r=\\frac{n_2}{n_1+n_2}=\\frac{C\\,I(E_2,T)}{C\\,I(E_1,T)+C\\,I(E_2,T)}=\\frac{I(E_2,T)}{I(E_1,T)+I(E_2,T)},$$\nso the unknown prefactor cancels exactly. Therefore, to assess the impact of the quasi-one-dimensional DOS on thermal occupancy, it suffices to evaluate $I(E_n,T)$ numerically for each subband and compute $r$ from these integrals.\n\nFor numerical stability and efficiency:\n- The integrand $f(E_n+t^2,T)$ is smooth and monotonically decaying for large $t$, because $t^2$ grows quadratically and the Fermi–Dirac function decays approximately as $\\exp\\!\\left(-\\frac{t^2-E_{\\mathrm{F}}+E_n}{k_{\\mathrm{B}} T}\\right)$ for $t^2 \\gg k_{\\mathrm{B}} T$. Hence, truncating the semi-infinite domain is justified.\n- Choose an energy cutoff $E_{\\max}$ such that $E_{\\max}-E_{\\mathrm{F}}=\\alpha\\,k_{\\mathrm{B}} T$ with a sufficiently large dimensionless $\\alpha$. A practical and accurate choice is $\\alpha=40$, which yields a negligible tail on the order of $\\mathrm{e}^{-40}$. With $E_{\\mathrm{F}}=0$, set $E_{\\max}=\\alpha\\,k_{\\mathrm{B}}T$ in $\\mathrm{eV}$ and truncate the $t$-integral at $t_{\\max}=\\sqrt{\\max(E_{\\max}-E_n,0)}$.\n- The Boltzmann constant in consistent energy units is $k_{\\mathrm{B}}=8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$, so the argument of the exponential in $f(E,T)$ is dimensionless when energies are in $\\mathrm{eV}$ and $T$ is in $\\mathrm{K}$.\n\nAlgorithmic steps for each test case $(E_1,E_2,T)$:\n- Compute $k_{\\mathrm{B}} T$ in $\\mathrm{eV}$ as $kT=k_{\\mathrm{B}}\\,T$.\n- For each $E_n\\in\\{E_1,E_2\\}$, define $E_{\\max}=\\alpha\\,kT$ with $\\alpha=40$ and $t_{\\max}=\\sqrt{\\max(E_{\\max}-E_n,0)}$.\n- Numerically evaluate $I(E_n,T)=\\int_{0}^{t_{\\max}} \\left(1+\\exp\\left(\\frac{E_n+t^2}{kT}\\right)\\right)^{-1}\\,\\mathrm{d}t$ using reliable quadrature. The truncation error is exponentially small for the chosen $\\alpha$.\n- Return $r=\\frac{I(E_2,T)}{I(E_1,T)+I(E_2,T)}$.\n\nSanity checks and limiting cases:\n- Zero-temperature limit $T\\to 0$: $f(E,T)\\to \\Theta(E_{\\mathrm{F}}-E)=\\Theta(-E)$, where $\\Theta$ is the Heaviside step function, and the integral yields $I(E_n,0)=\\sqrt{\\max(-E_n,0)}$. Then $r=\\frac{\\sqrt{\\max(-E_2,0)}}{\\sqrt{\\max(-E_1,0)}+\\sqrt{\\max(-E_2,0)}}$, which is consistent with state counting up to the Fermi wavevectors.\n- High-temperature broadening increases the contribution from $E>E_{\\mathrm{F}}$, raising the occupancy of higher subbands relative to $T\\to 0$.\n\nImplementation details:\n- Use numerical quadrature with absolute and relative tolerances chosen to control the error to well below the variation induced by the thermal tail.\n- Because only the ratio $r$ is required, no explicit knowledge of $\\hbar$, $m^\\ast$, or degeneracies is necessary.\n\nApplying this to the specified test suite:\n- Case A: $(E_1,E_2,T)=(-0.005\\,\\mathrm{eV},+0.005\\,\\mathrm{eV},300\\,\\mathrm{K})$.\n- Case B: $(E_1,E_2,T)=(-0.001\\,\\mathrm{eV},-0.0002\\,\\mathrm{eV},4\\,\\mathrm{K})$.\n- Case C: $(E_1,E_2,T)=(+0.002\\,\\mathrm{eV},+0.005\\,\\mathrm{eV},300\\,\\mathrm{K})$.\n- Case D: $(E_1,E_2,T)=(-0.0005\\,\\mathrm{eV},+0.0005\\,\\mathrm{eV},10\\,\\mathrm{K})$.\n\nThe program computes $r$ for each case and prints a single line in the required list format $\\,[r_A,r_B,r_C,r_D]\\,$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef fermi_dirac(E_eV: float, kT_eV: float) -> float:\n    # Fermi-Dirac distribution with mu = 0 eV\n    # f = 1 / (1 + exp(E/kT))\n    x = E_eV / kT_eV\n    # For numerical stability: handle large positive/negative x automatically\n    return 1.0 / (1.0 + np.exp(x))\n\ndef I_subband(E_edge_eV: float, T_K: float, alpha: float = 40.0) -> float:\n    # Compute I(E_n, T) = \\int_0^{t_max} f(E_n + t^2, T) dt\n    # with t_max = sqrt(max(E_max - E_n, 0)), E_max = alpha * k_B T\n    kB_eV_per_K = 8.617333262e-5  # eV/K\n    kT = kB_eV_per_K * T_K\n    Emax = alpha * kT\n    delta = Emax - E_edge_eV\n    if delta <= 0.0:\n        return 0.0\n    t_max = np.sqrt(delta)\n\n    integrand = lambda t: fermi_dirac(E_edge_eV + t*t, kT)\n    # Quadrature over [0, t_max]\n    val, err = quad(integrand, 0.0, t_max, epsabs=1e-12, epsrel=1e-10, limit=200)\n    return val\n\ndef occupancy_fraction(E1_eV: float, E2_eV: float, T_K: float) -> float:\n    I1 = I_subband(E1_eV, T_K)\n    I2 = I_subband(E2_eV, T_K)\n    denom = I1 + I2\n    if denom == 0.0:\n        # If both integrals are numerically zero (extreme case), define fraction as 0.5 by symmetry.\n        return 0.5\n    return I2 / denom\n\ndef solve():\n    # Define the test cases from the problem statement: (E1, E2, T)\n    test_cases = [\n        (-0.005,  0.005, 300.0),   # Case A\n        (-0.001, -0.0002,   4.0),  # Case B\n        ( 0.002,  0.005, 300.0),   # Case C\n        (-0.0005, 0.0005,  10.0),  # Case D\n    ]\n\n    results = []\n    for (E1, E2, T) in test_cases:\n        r = occupancy_fraction(E1, E2, T)\n        # Format with a reasonable number of significant digits for stability\n        results.append(f\"{r:.12g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "The formation of discrete subbands has a direct and profound impact on electron transport, famously demonstrated by the quantization of conductance. This practice challenges you to connect theory with experimental observation using the Landauer formalism for coherent transport. You will analyze how each subband below the Fermi energy opens a \"channel\" for current flow, contributing to the total conductance, and investigate how non-ideal effects like backscattering cause deviations from the perfect quantized steps seen in ideal systems .",
            "id": "4296403",
            "problem": "A gate-defined Quantum Point Contact (QPC) embedded in a high-mobility Two-Dimensional Electron Gas (2DEG) hosted by an emerging van der Waals semiconductor is operated at low temperature such that phase-coherent, elastic transport dominates. As the gate voltage is swept, the QPC opens discrete one-dimensional subbands, producing conductance plateaus. Assume zero temperature and the linear-response regime with a small source-drain bias. Use the Landauer approach for coherent transport as the fundamental starting point. In this framework, each one-dimensional subband contributes a transmission channel with energy-dependent transmission probability.\n\nStarting from the Landauer formalism and the existence of quantized transverse modes, derive the general expression for the conductance plateau height in terms of the transmission probabilities of the occupied subbands. Then, explain how elastic backscattering that reduces each open channel’s transmission probability below unity, $T_{n} < 1$, modifies the plateau heights compared to the ideal case of $T_{n} = 1$. Finally, estimate the correction to the first plateau height when only the lowest subband is open and its transmission is $T_{1} = 0.9$ due to weak backscattering from atomic-scale edge roughness.\n\nExpress your final answer as an exact analytic expression in terms of the elementary charge $e$ and Planck’s constant $h$. Do not convert constants to numerical values; no rounding is required. Do not include physical units in your final boxed answer.",
            "solution": "The problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **System:** A gate-defined Quantum Point Contact (QPC) in a high-mobility Two-Dimensional Electron Gas (2DEG) hosted by an emerging van der Waals semiconductor.\n- **Operating Conditions:** Low temperature, phase-coherent, elastic transport.\n- **Assumptions:** Zero temperature ($T=0$), linear-response regime (small source-drain bias).\n- **Theoretical Framework:** Landauer approach for coherent transport.\n- **Physics:** The QPC opening leads to discrete one-dimensional subbands, which act as transmission channels with energy-dependent transmission probabilities, $T_n(E)$.\n- **Task 1:** Derive the general expression for the conductance plateau height in terms of the transmission probabilities of the occupied subbands.\n- **Task 2:** Explain how elastic backscattering ($T_n < 1$) modifies the plateau heights compared to the ideal case ($T_n = 1$).\n- **Task 3:** Estimate the correction to the first plateau height when only the lowest subband ($n=1$) is open and its transmission is $T_{1} = 0.9$.\n- **Output Format:** The final answer must be an exact analytic expression in terms of the elementary charge $e$ and Planck’s constant $h$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a canonical example in mesoscopic physics and quantum transport. The use of the Landauer formula, the concept of conductance quantization in a QPC, and the effect of backscattering are all well-established, fundamental principles. The context of a van der Waals semiconductor is modern and scientifically relevant. The problem is well-posed; the assumptions of zero temperature and linear response are standard simplifications that allow for a clear and unique solution. The language is objective and precise. The problem is self-contained and does not suffer from any of the specified invalidity flaws.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution\nThe foundation for analyzing coherent transport in the linear-response regime is the Landauer-Büttiker formalism. The net electrical current $I$ flowing between two reservoirs (source, L, and drain, R) connected by a multi-channel conductor is given by:\n$$I = \\frac{2e}{h} \\int_{-\\infty}^{\\infty} \\mathcal{T}(E) [f_L(E) - f_R(E)] dE$$\nHere, $e$ is the elementary charge, $h$ is Planck's constant, and the factor of $2$ accounts for spin degeneracy. $\\mathcal{T}(E)$ is the total transmission probability at energy $E$, which is the sum of transmission probabilities $T_n(E)$ for each of the $N$ available one-dimensional subbands (channels): $\\mathcal{T}(E) = \\sum_{n=1}^{N} T_n(E)$. The functions $f_L(E)$ and $f_R(E)$ are the Fermi-Dirac distributions for the source and drain reservoirs, respectively.\n\nUnder a small source-drain bias voltage $V$, the chemical potentials of the reservoirs are shifted to $\\mu_L = E_F + eV/2$ and $\\mu_R = E_F - eV/2$, where $E_F$ is the equilibrium Fermi energy. At zero temperature ($T=0$), the Fermi-Dirac distribution becomes a Heaviside step function: $f(E, \\mu) = \\Theta(\\mu - E)$.\nTherefore, the difference in the distribution functions is non-zero only in the energy window between the two chemical potentials:\n$$f_L(E) - f_R(E) = \\Theta(E_F + \\frac{eV}{2} - E) - \\Theta(E_F - \\frac{eV}{2} - E) = \\begin{cases} 1 & \\text{if } E_F - \\frac{eV}{2} < E < E_F + \\frac{eV}{2} \\\\ 0 & \\text{otherwise} \\end{cases}$$\nThe integral for the current becomes:\n$$I = \\frac{2e}{h} \\int_{E_F - eV/2}^{E_F + eV/2} \\left[ \\sum_{n} T_n(E) \\right] dE$$\nThe sum is over all subbands whose energy minima are below the energy $E$. In the linear response regime, $V$ is infinitesimally small, making the integration window of width $eV$ also very small. We can thus assume that the transmission probabilities $T_n(E)$ are constant over this narrow window and equal to their values at the Fermi energy, $T_n(E_F)$. The expression for the current simplifies to:\n$$I \\approx \\frac{2e}{h} \\left[ \\sum_{n} T_n(E_F) \\right] \\int_{E_F - eV/2}^{E_F + eV/2} dE = \\frac{2e}{h} \\left[ \\sum_{n} T_n(E_F) \\right] (eV)$$\nThe differential conductance $G$ is defined as $G = dI/dV$. For this linear system, it is simply $G=I/V$.\n$$G = \\frac{2e^2}{h} \\sum_{n \\in \\mathcal{N}} T_n(E_F)$$\nwhere the sum is over the set $\\mathcal{N}$ of occupied subbands (i.e., those whose bottoms are below $E_F$). This is the general expression for the conductance of a plateau. A plateau is observed because as the gate voltage is swept, the number of occupied subbands remains constant over a certain voltage range.\n\nNext, we compare the case with backscattering to the ideal case. In an ideal QPC, transport is perfectly ballistic, meaning there is no scattering within the constriction. For any subband that is open (occupied), an electron entering it is transmitted with certainty. This corresponds to a transmission probability of unity for all occupied subbands: $T_n = 1$ for all $n \\in \\mathcal{N}$. If there are $N$ such occupied subbands, the ideal conductance is:\n$$G_{\\text{ideal}} = \\frac{2e^2}{h} \\sum_{n=1}^{N} 1 = N \\frac{2e^2}{h}$$\nThis results in the famous quantized conductance plateaus at integer multiples of the conductance quantum, $G_0 = 2e^2/h$.\n\nElastic backscattering, caused by imperfections such as impurities or edge roughness, reduces the probability of an electron fully traversing the QPC. This means the transmission probability for each affected channel becomes less than unity, $T_n < 1$. Consequently, the measured conductance plateau height is:\n$$G = \\frac{2e^2}{h} \\sum_{n=1}^{N} T_n$$\nSince each $T_n \\le 1$ and at least one is strictly less than $1$, the sum $\\sum_{n=1}^{N} T_n$ is strictly less than $N$. Therefore, elastic backscattering modifies the plateaus by reducing their heights below the ideal quantized values of $N \\frac{2e^2}{h}$.\n\nFinally, we estimate the correction to the first plateau height. The first plateau corresponds to the case where only the lowest subband is occupied ($N=1$). The ideal conductance for this plateau is $G_{\\text{ideal},1} = 1 \\cdot \\frac{2e^2}{h} = \\frac{2e^2}{h}$.\nThe problem states that due to weak backscattering, the transmission probability of this subband is $T_1 = 0.9$. The actual conductance of the first plateau is therefore:\n$$G_1 = T_1 \\frac{2e^2}{h} = 0.9 \\frac{2e^2}{h}$$\nThe term \"correction\" refers to the deviation from the ideal value. The correction, $\\Delta G_1$, is the difference between the ideal conductance and the actual conductance:\n$$\\Delta G_1 = G_{\\text{ideal},1} - G_1 = \\frac{2e^2}{h} - 0.9 \\frac{2e^2}{h}$$\n$$\\Delta G_1 = (1 - 0.9) \\frac{2e^2}{h} = 0.1 \\frac{2e^2}{h}$$\nExpressing the decimal as a fraction for an exact analytic form gives:\n$$\\Delta G_1 = \\frac{1}{10} \\frac{2e^2}{h} = \\frac{e^2}{5h}$$\nThis is the requested correction to the first plateau height.",
            "answer": "$$\\boxed{\\frac{e^{2}}{5h}}$$"
        }
    ]
}