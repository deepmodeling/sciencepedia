{
    "hands_on_practices": [
        {
            "introduction": "Sommerfeld展开是理解费米系统低温行为的强大分析工具。在绝对零度 $T=0$ 时，费米-狄拉克分布是一个尖锐的阶跃函数，但在有限的低温下，热激发会引起分布函数的“拖尾”或展宽。本练习将指导你完成一个经典推导，运用Sommerfeld展开来精确计算三维简并半导体中费米能级随温度变化的领先修正项，这是一个在固态物理学中具有奠基意义的结论。",
            "id": "4275367",
            "problem": "一块三维体相的简并 $n$ 型半导体，具有单一的各向同性抛物线型导带，其带边能量为 $E_{c}$。导带中单位体积的态密度为\n$$\ng_{c}(E) \\;=\\; \\frac{1}{2\\pi^{2}}\\!\\left(\\frac{2m^{\\ast}}{\\hbar^{2}}\\right)^{\\!\\frac{3}{2}} \\sqrt{E - E_{c}}\\,\\Theta(E-E_{c}),\n$$\n其中 $m^{\\ast}$ 是有效质量，$\\hbar$ 是约化普朗克常数，$\\Theta(\\cdot)$ 是亥维赛德阶跃函数 (Heaviside step function)。在温度 $T=0$ 时，费米能级 $E_{F}(0)$ 位于导带内，其能量高出导带底 $E_c$ 的量为 $\\varepsilon_{F0} \\equiv E_{F}(0) - E_{c}  0$，这对应于由掺杂剂决定的固定电子浓度 $n$。对于满足 $k_{B}T \\ll \\varepsilon_{F0}$ 的温度 $T$，假设总电子浓度保持为 $n$（施主完全电离且空穴可忽略不计），并且电子遵循费米-狄拉克分布函数。\n\n使用索末菲展开 (Sommerfeld expansion)，并从第一性原理出发，将电子浓度表示为态密度乘以费米-狄拉克分布函数后对能量的积分，确定当 $T \\to 0$ 时，费米能级的主要低温修正项 $\\Delta E_{F}(T) \\equiv E_{F}(T) - E_{F}(0)$。您的最终答案必须是使用 $\\varepsilon_{F0}$、$k_{B}$ 和 $T$ 表示的单个闭式解析表达式。最终答案以焦耳为单位表示。不需要进行数值计算，也无需四舍五入。",
            "solution": "问题是要求解简并 $n$ 型半导体中费米能级的主要低温修正项 $\\Delta E_{F}(T) \\equiv E_{F}(T) - E_{F}(0)$。总电子浓度 $n$ 假定为常数，由掺杂浓度决定。\n\n电子浓度 $n$ 由态密度 $g_c(E)$ 和费米-狄拉克分布函数 $f(E, E_F, T)$ 的乘积在导带中所有可用能态上的积分给出。费米-狄拉克分布由下式给出\n$$f(E, E_F, T) = \\frac{1}{\\exp\\left(\\frac{E-E_F}{k_B T}\\right) + 1}$$\n其中 $E_F$ 是与温度相关的费米能级（化学势），$k_B$ 是玻尔兹曼常数，$T$ 是温度。\n\n电子浓度 $n$ 可表示为：\n$$n = \\int_{-\\infty}^{\\infty} g_c(E) f(E, E_F(T), T) dE$$\n鉴于 $g_c(E)$ 的形式，积分下限实际上是导带底 $E_c$。\n$$n = \\int_{E_c}^{\\infty} g_c(E) f(E, E_F(T), T) dE$$\n问题陈述，对于所考虑的低温，电子浓度 $n$ 是恒定的，即 $n$ 与温度无关。这是我们的核心约束条件。\n\n在绝对零度（$T=0$）时，费米-狄拉克分布变为一个阶跃函数：当 $E  E_F(0)$ 时 $f(E, E_F(0), 0) = 1$，当 $E  E_F(0)$ 时 $f(E, E_F(0), 0) = 0$。因此，电子浓度为：\n$$n = \\int_{E_c}^{E_F(0)} g_c(E) dE$$\n这里，$E_F(0)$ 是在 $T=0$ 时的费米能级。\n\n对于低但非零的温度（$k_B T \\ll E_F - E_c$），我们可以使用索末菲展开 (Sommerfeld expansion) 来计算 $n$ 的积分。对于形如 $I = \\int_{E_0}^{\\infty} H(E) f(E, E_F, T) dE$ 的积分，其展开式为：\n$$I \\approx \\int_{E_0}^{E_F} H(E) dE + \\frac{\\pi^2}{6}(k_B T)^2 H'(E_F)$$\n其中 $H'(E_F)$ 是 $H(E)$ 在 $E=E_F$ 处的导数。\n在我们的情况下，$H(E) = g_c(E)$ 且积分下限为 $E_c$。所以，在温度 $T$ 下的电子浓度为：\n$$n \\approx \\int_{E_c}^{E_F(T)} g_c(E) dE + \\frac{\\pi^2}{6}(k_B T)^2 g_c'(E_F(T))$$\n其中 $g_c'(E_F(T))$ 是在费米能级 $E_F(T)$ 处计算的态密度的导数。\n\n由于电子浓度 $n$ 是恒定的，我们可以令 $T=0$ 和有限温度 $T$ 下 $n$ 的表达式相等：\n$$\\int_{E_c}^{E_F(0)} g_c(E) dE = \\int_{E_c}^{E_F(T)} g_c(E) dE + \\frac{\\pi^2}{6}(k_B T)^2 g_c'(E_F(T))$$\n让我们定义积分 $I(E_F) = \\int_{E_c}^{E_F} g_c(E) dE$。该方程变为：\n$$I(E_F(0)) = I(E_F(T)) + \\frac{\\pi^2}{6}(k_B T)^2 g_c'(E_F(T))$$\n我们正在寻找小的修正量 $\\Delta E_F(T) = E_F(T) - E_F(0)$。我们可以在 $E_F(0)$ 附近对 $I(E_F(T))$ 进行泰勒展开：\n$$I(E_F(T)) = I(E_F(0) + \\Delta E_F) \\approx I(E_F(0)) + \\Delta E_F \\left(\\frac{dI}{dE_F}\\right)_{E_F=E_F(0)}$$\n根据微积分基本定理，$\\frac{dI}{dE_F} = g_c(E_F)$。因此：\n$$I(E_F(T)) \\approx I(E_F(0)) + \\Delta E_F g_c(E_F(0))$$\n将此代回我们的等式：\n$$I(E_F(0)) \\approx I(E_F(0)) + \\Delta E_F g_c(E_F(0)) + \\frac{\\pi^2}{6}(k_B T)^2 g_c'(E_F(T))$$\n消去两边的 $I(E_F(0))$ 得到：\n$$0 \\approx \\Delta E_F g_c(E_F(0)) + \\frac{\\pi^2}{6}(k_B T)^2 g_c'(E_F(T))$$\n第二项是 $(k_B T)^2$ 阶的修正项。我们可以在此项中近似 $g_c'(E_F(T)) \\approx g_c'(E_F(0))$，因为其差值是关于 $T$ 的更高阶项：\n$$0 \\approx \\Delta E_F g_c(E_F(0)) + \\frac{\\pi^2}{6}(k_B T)^2 g_c'(E_F(0))$$\n求解 $\\Delta E_F$，我们将其记为 $\\Delta E_F(T)$：\n$$\\Delta E_F(T) = - \\frac{\\pi^2}{6}(k_B T)^2 \\frac{g_c'(E_F(0))}{g_c(E_F(0))}$$\n对于粒子数恒定的系统，这是费米能级主要温度修正的通用表达式。\n\n现在，我们使用题目给出的特定态密度：\n$$g_c(E) = C(E - E_c)^{1/2}$$\n其中 $C = \\frac{1}{2\\pi^2}\\left(\\frac{2m^\\ast}{\\hbar^2}\\right)^{3/2}$ 是一个常数。我们不需要 $C$ 的显式形式，因为它将被消掉。\n$g_c(E)$ 对 $E$ 的导数为：\n$$g_c'(E) = \\frac{d}{dE} \\left[ C(E - E_c)^{1/2} \\right] = C \\cdot \\frac{1}{2}(E - E_c)^{-1/2}$$\n现在我们计算比率 $\\frac{g_c'(E)}{g_c(E)}$ 在 $E=E_F(0)$ 处的值：\n$$\\frac{g_c'(E_F(0))}{g_c(E_F(0))} = \\frac{\\frac{C}{2}(E_F(0) - E_c)^{-1/2}}{C(E_F(0) - E_c)^{1/2}} = \\frac{1}{2(E_F(0) - E_c)}$$\n题目定义了 $\\varepsilon_{F0} \\equiv E_F(0) - E_c$。将此代入该比率中：\n$$\\frac{g_c'(E_F(0))}{g_c(E_F(0))} = \\frac{1}{2\\varepsilon_{F0}}$$\n最后，我们将此结果代入 $\\Delta E_F(T)$ 的表达式中：\n$$\\Delta E_F(T) = - \\frac{\\pi^2}{6}(k_B T)^2 \\left( \\frac{1}{2\\varepsilon_{F0}} \\right)$$\n$$\\Delta E_F(T) = - \\frac{\\pi^2 (k_B T)^2}{12 \\varepsilon_{F0}}$$\n这就是费米能级的主要低温修正项。负号表示当温度从绝对零度升高时，费米能级会降低。该表达式具有能量的单位，符合要求。",
            "answer": "$$\n\\boxed{-\\frac{\\pi^2 (k_B T)^2}{12 \\varepsilon_{F0}}}\n$$"
        },
        {
            "introduction": "在掌握了温度效应的基本分析后，本练习将探讨材料的维度如何深刻地影响载流子统计。通过对比分析一个具有恒定态密度（DOS）的二维（2D）系统与一个态密度随能量平方根变化的传统三维（3D）系统，你将揭示它们的化学势 $\\mu(T)$ 为何对温度表现出截然不同的依赖关系。这种分析对于理解和设计以石墨烯和过渡金属硫化物（TMDs）为代表的现代低维材料至关重要。",
            "id": "4275371",
            "problem": "一个单层二维 ($2$D) 半导体，其电子处于一个单一的各向同性抛物线型导带中，有效质量为 $m^\\ast$，带边能量为 $E_c$。自旋简并度为 $g_s$，能谷简并度为 $g_v$。通过静电门控，电子面密度固定为 $n_s$。同时考虑一个三维 ($3$D) 体半导体，它具有相同的抛物线色散关系和简并度，以及固定的体电子密度 $n$。假设能带延伸至任意高的能量，并忽略能带的非抛物线性以及相互作用。\n\n仅从 (i) 费米-狄拉克 (FD) 分布的定义 $f(E)=\\left[1+\\exp\\left(\\frac{E-\\mu}{k_B T}\\right)\\right]^{-1}$，(ii) 在 $d$ 维下通过 $k$ 空间计数构建抛物线型能带的态密度，以及 (iii) 粒子数守恒出发，分析在 $2$D 和 $3$D 情况下，为了保持 $n_s$ 或 $n$ 固定，化学势 $\\mu(T)$ 必须如何随温度 $T$ 演化。特别地，关注低温简并区 $k_B T \\ll \\varepsilon_F$ 和非简并高温区。\n\n选出所有正确的表述。\n\nA. 在具有恒定态密度（高于 $E_c$）和固定面密度 $n_s$ 的 $2$D 抛物线型能带中，$\\mu(T)$ 在低温下与其零温值 $\\mu(0)=E_c+\\varepsilon_F$（其中 $\\varepsilon_F \\equiv n_s/D_{2\\mathrm{D}}$ 且 $D_{2\\mathrm{D}}$ 是单位面积的 $2$D 态密度）的偏差是指数级小的：当 $T\\to 0$ 时，$\\mu(T)=E_c+\\varepsilon_F - O\\!\\left(e^{-\\varepsilon_F/(k_B T)}\\right)$。相比之下，在固定 $n$ 的 $3$D 情况中，$\\mu(T)=E_F - O\\!\\left((k_B T)^2/E_F\\right)$，其主要修正是二次方的。\n\nB. 在非简并高温极限下，从带边测量的 $2$D 化学势满足 $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n_s}{D_{2\\mathrm{D}}\\,k_B T}\\right)$，而在 $3$D 中则有 $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n}{N_c(T)}\\right)$，其中有效态密度 $N_c(T)\\propto T^{3/2}$。\n\nC. 对于固定面密度 $n_s$ 的 $2$D 抛物线型能带，$\\mu(T)$ 在所有 $T0$ 的情况下都完全不随 $T$ 变化。\n\nD. 对于固定体密度 $n$ 的 $3$D 抛物线型能带，当温度 $T$ 从 $T=0$ 升高时，由于态密度的能量依赖性，$\\mu(T)$ 会增加到 $E_F$ 以上。\n\nE. 在固定 $n_s$ 的 $2$D 情况中，$\\mu(T)$ 对于所有 $T0$ 必然满足 $\\mu(T)E_c$。",
            "solution": "用户需要基于第一性原理，对具有抛物线型能带的二维和三维系统中化学势的温度依赖性进行详细分析。我将首先验证问题陈述，然后进行推导并评估各个选项。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n*   **系统1 ($2$D):** 一个单层二维 ($2$D) 半导体。\n    *   能带结构：单一的各向同性抛物线型导带，有效质量为 $m^\\ast$。\n    *   带边能量：$E_c$。\n    *   简并度：自旋简并度 $g_s$，能谷简并度 $g_v$。\n    *   载流子密度：固定的电子面密度 $n_s$。\n*   **系统2 ($3$D):** 一个三维 ($3$D) 体半导体。\n    *   能带结构：与 2D 相同的抛物线色散关系 ($E(k) = E_c + \\hbar^2 k^2 / (2m^\\ast)$)。\n    *   简并度：与 2D 相同的 $g_s$ 和 $g_v$。\n    *   载流子密度：固定的体电子密度 $n$。\n*   **假设：**\n    *   能带延伸至任意高的能量。\n    *   能带的非抛物线性以及相互作用被忽略。\n*   **出发原理：**\n    *   (i) 费米-狄拉克 (FD) 分布：$f(E)=\\left[1+\\exp\\left(\\frac{E-\\mu}{k_B T}\\right)\\right]^{-1}$。\n    *   (ii) 在 $d$ 维下通过 $k$ 空间计数构建抛物线型能带的态密度 (DOS)。\n    *   (iii) 粒子数守恒。\n*   **问题：** 分析在 $2$D 和 $3$D 情况下，为了保持 $n_s$ 或 $n$ 固定，化学势 $\\mu(T)$ 必须如何随温度 $T$ 演化，并关注低温简并区 ($k_B T \\ll \\varepsilon_F$) 和非简并高温区。\n\n**第二步：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 该问题描述了半导体物理和固态统计力学中的一个典型模型。抛物线型能带、有效质量、态密度和费米-狄拉克分布等概念都是基本原理。该模型是研究电子统计学的标准教科书案例。\n2.  **问题适定性：** 该问题是适定的。固定的粒子数约束，结合态密度和FD分布的定义，隐含地定义了一个唯一的函数 $\\mu(T)$。问题要求在特定极限下描述此函数的行为，这是一个可解的问题。\n3.  **客观性：** 问题陈述使用了精确、无偏见的科学语言。\n4.  **未发现缺陷：**\n    *   它不违反任何科学定律。\n    *   这是一个该主题核心的可形式化问题。\n    *   为进行所需分析，设置是完整的。物理参数 ($m^\\ast$, $g_s$, $g_v$) 以符号形式给出，这是恰当的。\n    *   能带延伸至无穷远的假设是一种理想化，但它是简化积分的标准做法，并且不会使带边附近的核心物理行为失效。\n    *   该问题既非微不足道，也非不适定。\n\n**第三步：结论与行动**\n\n问题陈述是有效的。我将根据给定的原理推导解答。\n\n### 推导\n\n在 $d$ 维空间中，总载流子浓度 $n_{d\\mathrm{D}}$ 由粒子数守恒给出：\n$$n_{d\\mathrm{D}} = \\int_{E_c}^{\\infty} D_{d\\mathrm{D}}(E) f(E) dE$$\n其中 $D_{d\\mathrm{D}}(E)$ 是单位面积 ($d=2$) 或单位体积 ($d=3$) 的态密度， $f(E)$ 是费米-狄拉克分布。\n\n**1. 态密度 (DOS)**\n\n对于各向同性抛物线型能带 $E(\\vec{k}) = E_c + \\frac{\\hbar^2 |\\vec{k}|^2}{2m^\\ast}$，k空间中一个微分壳层内的态数（包括自旋和能谷简并度）是 $g_s g_v dN_k$。这个壳层在 $d$ 维空间中的体积是 $S_d k^{d-1} dk$，其中 $S_d$ 是 $d$ 维单位球的表面积 ($S_2=2\\pi$, $S_3=4\\pi$)。单位实空间体积/面积的k空间态密度是 $1/(2\\pi)^d$。\n$$D_{d\\mathrm{D}}(E)dE = g_s g_v \\frac{S_d k^{d-1}}{(2\\pi)^d} dk$$\n根据色散关系，$k(E) = \\sqrt{2m^\\ast(E-E_c)}/\\hbar$，且 $dk = \\frac{1}{\\hbar}\\sqrt{\\frac{m^\\ast}{2(E-E_c)}}dE$。\n\n*   **二维情况 ($d=2$):**\n    $$D_{2\\mathrm{D}}(E) = g_s g_v \\frac{2\\pi k}{(2\\pi)^2} \\frac{dk}{dE} = \\frac{g_s g_v}{2\\pi} k(E) \\frac{dk}{dE}$$\n    因为 $k \\frac{dk}{dE} = \\frac{m^\\ast}{\\hbar^2}$，我们得到：\n    $$D_{2\\mathrm{D}}(E) = \\frac{g_s g_v m^\\ast}{2\\pi\\hbar^2} \\equiv D_{2\\mathrm{D}} \\quad (\\text{对于 } E \\ge E_c)$$\n    对于 $E \\ge E_c$，二维态密度是一个常数。\n\n*   **三维情况 ($d=3$):**\n    $$D_{3\\mathrm{D}}(E) = g_s g_v \\frac{4\\pi k^2}{(2\\pi)^3} \\frac{dk}{dE} = \\frac{g_s g_v}{2\\pi^2} k^2(E) \\frac{dk}{dE}$$\n    代入 $k^2$ 和 $dk/dE$：\n    $$D_{3\\mathrm{D}}(E) = \\frac{g_s g_v}{2\\pi^2} \\left(\\frac{2m^\\ast(E-E_c)}{\\hbar^2}\\right) \\left(\\frac{1}{\\hbar}\\sqrt{\\frac{m^\\ast}{2(E-E_c)}}\\right) = \\frac{g_s g_v}{2\\pi^2} \\left(\\frac{2m^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E-E_c}$$\n    对于 $E \\ge E_c$，三维态密度与 $\\sqrt{E-E_c}$ 成正比。\n\n**2. 化学势 $\\mu(T)$**\n\n**2.1. 二维情况**\n粒子数守恒方程为：\n$$n_s = \\int_{E_c}^{\\infty} D_{2\\mathrm{D}} \\frac{1}{1 + e^{(E-\\mu)/(k_B T)}} dE$$\n这个积分可以精确求解。令 $x = (E-\\mu)/(k_B T)$，则 $dE = k_B T dx$。\n$$n_s = D_{2\\mathrm{D}} k_B T \\int_{(E_c-\\mu)/(k_B T)}^{\\infty} \\frac{dx}{1+e^x} = D_{2\\mathrm{D}} k_B T \\left[ -\\ln(1+e^{-x}) \\right]_{(E_c-\\mu)/(k_B T)}^{\\infty}$$\n$$n_s = D_{2\\mathrm{D}} k_B T \\ln\\left(1 + e^{- (E_c-\\mu)/(k_B T)}\\right) = D_{2\\mathrm{D}} k_B T \\ln\\left(1 + e^{(\\mu-E_c)/(k_B T)}\\right)$$\n求解 $\\mu(T)$：\n$$e^{n_s/(D_{2\\mathrm{D}} k_B T)} = 1 + e^{(\\mu-E_c)/(k_B T)}$$\n$$\\mu(T) - E_c = k_B T \\ln\\left(e^{n_s/(D_{2\\mathrm{D}} k_B T)} - 1\\right)$$\n\n*   **低温极限 ($T \\to 0$):**\n    在 $T=0$ 时，$f(E)$ 是一个阶跃函数。$\\mu(0)=E_F$。\n    $n_s = \\int_{E_c}^{E_F} D_{2\\mathrm{D}} dE = D_{2\\mathrm{D}}(E_F - E_c)$。\n    从带边测量的费米能为 $\\varepsilon_F \\equiv E_F - E_c = n_s/D_{2\\mathrm{D}}$。所以 $\\mu(0) = E_c + \\varepsilon_F$。\n    对于小 $T$，令 $x = \\varepsilon_F / (k_B T) \\gg 1$。\n    $\\mu(T) - E_c = k_B T \\ln(e^x - 1) = k_B T \\ln(e^x(1-e^{-x})) = k_B T (x + \\ln(1-e^{-x}))$。\n    对于小 $y$，使用 $\\ln(1-y) \\approx -y$：\n    $\\mu(T) - E_c \\approx k_B T \\left(\\frac{\\varepsilon_F}{k_B T} - e^{-\\varepsilon_F/(k_B T)}\\right) = \\varepsilon_F - k_B T e^{-\\varepsilon_F/(k_B T)}$。\n    所以，$\\mu(T) \\approx (E_c + \\varepsilon_F) - k_B T e^{-\\varepsilon_F/(k_B T)}$。与 $\\mu(0)$ 的偏差是负的，并且是指数级小的。\n\n*   **高温极限 (非简并):**\n    当 $k_B T$ 很大时，$\\mu(T)$ 表达式中对数的自变量可以被近似。这对应于麦克斯韦-玻尔兹曼极限 $f(E) \\approx e^{-(E-\\mu)/(k_B T)}$。\n    $n_s = \\int_{E_c}^{\\infty} D_{2\\mathrm{D}} e^{-(E-\\mu)/(k_B T)} dE = D_{2\\mathrm{D}} e^{(\\mu-E_c)/(k_B T)} \\int_{E_c}^{\\infty} e^{-(E-E_c)/(k_B T)} dE$。\n    积分为 $k_B T$。\n    $n_s = D_{2\\mathrm{D}} k_B T e^{(\\mu-E_c)/(k_B T)}$。\n    $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)$。\n\n**2.2. 三维情况**\n$$n = \\int_{E_c}^{\\infty} C_3 \\sqrt{E-E_c} \\frac{1}{1 + e^{(E-\\mu)/(k_B T)}} dE$$\n其中 $C_3 = \\frac{g_s g_v}{2\\pi^2} (\\frac{2m^\\ast}{\\hbar^2})^{3/2}$。这个积分没有简单的闭合形式解。\n\n*   **低温极限 ($T \\to 0$):**\n    我们使用索末菲展开来处理积分 $I = \\int \\phi(E)f(E)dE$：\n    $I \\approx \\int_{E_c}^{\\mu} \\phi(E)dE + \\frac{\\pi^2}{6}(k_B T)^2 \\phi'(\\mu)$。\n    这里，$\\phi(E) = D_{3\\mathrm{D}}(E) = C_3 \\sqrt{E-E_c}$。粒子密度 $n$ 是恒定的。\n    $n \\approx \\int_{E_c}^{\\mu} D_{3\\mathrm{D}}(E) dE + \\frac{\\pi^2}{6}(k_B T)^2 D'_{3\\mathrm{D}}(\\mu)$。\n    在 $T=0$ 时，$n = \\int_{E_c}^{E_F} D_{3\\mathrm{D}}(E) dE$，其中 $E_F = \\mu(0)$。\n    $\\int_{E_c}^{E_F} D_{3\\mathrm{D}} dE \\approx \\int_{E_c}^{\\mu} D_{3\\mathrm{D}} dE + \\frac{\\pi^2}{6}(k_B T)^2 D'_{3\\mathrm{D}}(\\mu)$。\n    用 $E_F$ 附近的泰勒展开来近似第一项：$\\int_{E_c}^{\\mu} D_{3\\mathrm{D}} dE \\approx \\int_{E_c}^{E_F} D_{3\\mathrm{D}} dE + (\\mu - E_F)D_{3\\mathrm{D}}(E_F)$。同时，在修正项中，我们可以设置 $\\mu \\approx E_F$。\n    $0 \\approx (\\mu - E_F)D_{3\\mathrm{D}}(E_F) + \\frac{\\pi^2}{6}(k_B T)^2 D'_{3\\mathrm{D}}(E_F)$。\n    $\\mu(T) - E_F \\approx -\\frac{\\pi^2}{6}(k_B T)^2 \\frac{D'_{3\\mathrm{D}}(E_F)}{D_{3\\mathrm{D}}(E_F)}$。\n    $D'_{3\\mathrm{D}}(E) = \\frac{C_3}{2\\sqrt{E-E_c}}$，所以 $\\frac{D'_{3\\mathrm{D}}(E)}{D_{3\\mathrm{D}}(E)} = \\frac{1}{2(E-E_c)}$。\n    在 $E=E_F$ 处，此比值为 $\\frac{1}{2(E_F-E_c)}$。\n    $\\mu(T) - E_F \\approx -\\frac{\\pi^2}{12} \\frac{(k_B T)^2}{E_F - E_c}$。\n    在低温下，化学势随 T 呈二次方下降。\n\n*   **高温极限 (非简并):**\n    使用 $f(E) \\approx e^{-(E-\\mu)/(k_B T)}$：\n    $n = \\int_{E_c}^{\\infty} C_3 \\sqrt{E-E_c} \\, e^{-(E-\\mu)/(k_B T)} dE = C_3 e^{(\\mu-E_c)/(k_B T)} \\int_{E_c}^{\\infty} \\sqrt{E-E_c} \\, e^{-(E-E_c)/(k_B T)} dE$。\n    令 $x=(E-E_c)/(k_B T)$。积分为 $(k_B T)^{3/2} \\int_0^\\infty \\sqrt{x} e^{-x} dx = (k_B T)^{3/2} \\Gamma(3/2) = (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2}$。\n    $n = C_3 (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2} e^{(\\mu-E_c)/(k_B T)}$。\n    这通常写作 $n = N_c(T) e^{(\\mu-E_c)/(k_B T)}$，其中有效态密度为 $N_c(T) = C_3 (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2} = g_s g_v \\cdot 2 \\left(\\frac{m^\\ast k_B T}{2\\pi \\hbar^2}\\right)^{3/2}$。\n    $N_c(T) \\propto T^{3/2}$。\n    求解 $\\mu(T)$：\n    $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n}{N_c(T)}\\right)$。\n\n### 选项评估\n\n**A. 在具有恒定态密度（高于 $E_c$）和固定面密度 $n_s$ 的 $2$D 抛物线型能带中，$\\mu(T)$ 在低温下与其零温值 $\\mu(0)=E_c+\\varepsilon_F$（其中 $\\varepsilon_F \\equiv n_s/D_{2\\mathrm{D}}$ 且 $D_{2\\mathrm{D}}$ 是单位面积的 $2$D 态密度）的偏差是指数级小的：当 $T\\to 0$ 时，$\\mu(T)=E_c+\\varepsilon_F - O\\!\\left(e^{-\\varepsilon_F/(k_B T)}\\right)$。相比之下，在固定 $n$ 的 $3$D 情况中，$\\mu(T)=E_F - O\\!\\left((k_B T)^2/E_F\\right)$，其主要修正是二次方的。**\n*   **2D 部分：** 我的推导表明 $\\mu(T) \\approx (E_c + \\varepsilon_F) - k_B T e^{-\\varepsilon_F/(k_B T)}$。修正项确实是指数级小的。多项式因子 $k_B T$ 相对于指数项是次要的，所以数量级符号 $O(e^{-\\varepsilon_F/(k_B T)})$ 是正确的。\n*   **3D 部分：** 我的推导表明 $\\mu(T) - E_F \\approx -\\frac{\\pi^2}{12} \\frac{(k_B T)^2}{E_F - E_c}$。主要修正是负的，并且与 $(k_B T)^2$ 成正比。符号 $O((k_B T)^2/E_F)$ (假设分母中的 $E_F$ 代表相对于带边的费米能，$E_F-E_c$) 正确地捕捉了这种二次方依赖关系。\n*   **结论：** 正确。\n\n**B. 在非简并高温极限下，从带边测量的 $2$D 化学势满足 $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n_s}{D_{2\\mathrm{D}}\\,k_B T}\\right)$，而在 $3$D 中则有 $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n}{N_c(T)}\\right)$，其中有效态密度 $N_c(T)\\propto T^{3/2}$。**\n*   **2D 部分：** 我对二维高温极限的推导恰好得到 $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)$。这与表述相符。\n*   **3D 部分：** 我对三维高温极限的推导恰好得到 $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n}{N_c(T)}\\right)$，其中 $N_c(T)$ 的定义表明 $N_c(T) \\propto T^{3/2}$。这也与表述相符。\n*   **结论：** 正确。\n\n**C. 对于固定面密度 $n_s$ 的 $2$D 抛物线型能带，$\\mu(T)$ 在所有 $T0$ 的情况下都完全不随 $T$ 变化。**\n*   我对二维情况的精确表达式是 $\\mu(T) = E_c + k_B T \\ln\\left( e^{n_s/(D_{2\\mathrm{D}} k_B T)} - 1 \\right)$。这个函数显然依赖于 T。例如，在低温极限下，它以指数修正趋近于 $E_c+\\varepsilon_F$，而在高温极限下，它表现为 $k_B T \\ln(C/T)$，这也依赖于温度。因此，$\\mu(T)$ 不是恒定的。这个表述是错误的。关于二维中 $\\mu(T)$ 是常数的误解，仅在态密度是恒定且围绕 $\\mu$ 对称（例如，从 $-\\infty$ 延伸到 $+\\infty$）时才会产生，但由于带边在 $E_c$ 处，这里情况并非如此。\n*   **结论：** 不正确。\n\n**D. 对于固定体密度 $n$ 的 $3$D 抛物线型能带，当温度 $T$ 从 $T=0$ 升高时，由于态密度的能量依赖性，$\\mu(T)$ 会增加到 $E_F$ 以上。**\n*   我对三维低温的分析表明 $\\mu(T) \\approx E_F - \\frac{\\pi^2}{12} \\frac{(k_B T)^2}{E_F-E_c}$。由于当 $T0$ 时修正项是负的，$\\mu(T)$ *下降*到其零温值 $E_F$ 以下。随着温度升高，费米分布的热展宽会填充 $\\mu$ 以上的能态。由于三维态密度随能量增加而增加，在 $E  \\mu$ 处可用的态比在 $E  \\mu$ 处失去的态要多。为了保持粒子数 $n$ 恒定，化学势 $\\mu$ 必须降低。\n*   **结论：** 不正确。\n\n**E. 在固定 $n_s$ 的 $2$D 情况中，$\\mu(T)$ 对于所有 $T0$ 必然满足 $\\mu(T)E_c$。**\n*   我们来分析高温表达式：$\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)$。\n*   对于足够高的温度 $T$，对数的自变量 $\\frac{n_s}{D_{2\\mathrm{D}} k_B T}$ 将变得小于 $1$。当一个正数小于 $1$ 时，其自然对数是负的。\n*   因此，对于 $T  \\frac{n_s}{D_{2\\mathrm{D}} k_B}$，我们有 $\\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)  0$，这意味着 $\\mu(T) - E_c  0$，即 $\\mu(T)  E_c$。\n*   因此，关于对*所有* $T0$ 都有 $\\mu(T)E_c$ 的表述是错误的。在简并（低温）区，化学势高于 $E_c$，但在非简并（高温）区，它会降到带隙中。\n*   **结论：** 不正确。",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "实际的半导体器件分析往往需要超越理想化的解析极限，转而求解隐式定义费米能级的完整电荷中性方程。这项综合性练习旨在引导你设计并实现一个稳健的数值求解器，它能够利用完整的费米-狄拉克积分，自洽地计算由自由电子、空穴以及电离施主和受主共同决定的电荷平衡。这项实践将理论原理与器件工程和材料科学中使用的计算模拟工具紧密联系起来，是理论走向应用的桥梁。",
            "id": "4275340",
            "problem": "您的任务是设计并实现一个完整的、可运行的程序，用于在给定的绝对温度 $\\,T\\,$、施主密度 $\\,N_{\\mathrm{D}}\\,$ 和受主密度 $\\,N_{\\mathrm{A}}\\,$ 条件下，计算具有抛物线形能带的三维半导体的化学势（费米能级）$\\,\\mu\\,$，单位为电子伏特 (eV)。计算必须利用费米-狄拉克分布和态密度积分来强制执行电荷中性条件。您的算法必须是自洽的：施主和受主的占据情况取决于 $\\,\\mu\\,$，而 $\\,\\mu\\,$ 必须不断更新，直到达到电荷中性。\n\n您的推导必须从以下基本依据出发：\n- 费米-狄拉克分布 $\\,f(E,\\mu,T) = \\dfrac{1}{1+\\exp\\!\\left(\\dfrac{E-\\mu}{k_{\\mathrm{B}} T}\\right)}\\,$，其中 $\\,k_{\\mathrm{B}}\\,$ 是玻尔兹曼常数。\n- 导带的三维抛物线形能带的态密度为 $\\,D_{\\mathrm{c}}(E) = \\dfrac{1}{2\\pi^2}\\!\\left(\\dfrac{2 m_n^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E - E_{\\mathrm{C}}}\\,$（对于 $\\,E \\ge E_{\\mathrm{C}}\\,$），价带的态密度为 $\\,D_{\\mathrm{v}}(E) = \\dfrac{1}{2\\pi^2}\\!\\left(\\dfrac{2 m_p^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E_{\\mathrm{V}} - E}\\,$（对于 $\\,E \\le E_{\\mathrm{V}}\\,$），其中 $\\,m_n^\\ast\\,$ 和 $\\,m_p^\\ast\\,$ 分别是电子和空穴的有效质量，$\\,\\hbar\\,$ 是约化普朗克常数，$\\,E_{\\mathrm{C}}\\,$ 是导带底，$\\,E_{\\mathrm{V}}\\,$ 是价带顶。\n- 从这些积分得到的载流子浓度，\n$$\nn(\\mu,T) = \\int_{E_{\\mathrm{C}}}^{\\infty} D_{\\mathrm{c}}(E)\\, f(E,\\mu,T)\\, \\mathrm{d}E,\\qquad\np(\\mu,T) = \\int_{-\\infty}^{E_{\\mathrm{V}}} D_{\\mathrm{v}}(E)\\, \\big[1 - f(E,\\mu,T)\\big]\\, \\mathrm{d}E.\n$$\n- 建模为具有简并因子 $\\,g_{\\mathrm{D}}\\,$ 和 $\\,g_{\\mathrm{A}}\\,$ 以及能级 $\\,E_{\\mathrm{D}}\\,$ 和 $\\,E_{\\mathrm{A}}\\,$ 的单能级杂质的电离施主和受主密度：\n$$\nN_{\\mathrm{D}}^+(\\mu,T) = \\frac{N_{\\mathrm{D}}}{1 + g_{\\mathrm{D}} \\exp\\!\\left(\\frac{\\mu - E_{\\mathrm{D}}}{k_{\\mathrm{B}} T}\\right)},\\qquad\nN_{\\mathrm{A}}^-(\\mu,T) = \\frac{N_{\\mathrm{A}}}{1 + g_{\\mathrm{A}} \\exp\\!\\left(\\frac{E_{\\mathrm{A}} - \\mu}{k_{\\mathrm{B}} T}\\right)}.\n$$\n- 电荷中性条件，\n$$\nn(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) = p(\\mu,T) + N_{\\mathrm{D}}^+(\\mu,T).\n$$\n\n工作假设与建模要求：\n- 将导带和价带视为各向同性且具有上述态密度的抛物线形能带。\n- 使用归一化的 $\\,\\tfrac{1}{2}\\,$ 阶完全费米-狄拉克积分，\n$$\nF_{1/2}(\\eta) = \\frac{2}{\\sqrt{\\pi}} \\int_{0}^{\\infty} \\frac{\\sqrt{x}}{1 + \\exp(x - \\eta)}\\, \\mathrm{d}x,\n$$\n以及有效态密度 $\\,N_{\\mathrm{C}}(T) = 2 \\left( \\dfrac{2\\pi m_n^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\\,$, $\\,N_{\\mathrm{V}}(T) = 2 \\left( \\dfrac{2\\pi m_p^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\\,$（其中 $\\,h\\,$ 是普朗克常数）来表示载流子积分。使用这些来表示\n$$\nn(\\mu,T) = N_{\\mathrm{C}}(T)\\, F_{1/2}\\!\\left(\\frac{\\mu - E_{\\mathrm{C}}}{k_{\\mathrm{B}} T}\\right),\\qquad\np(\\mu,T) = N_{\\mathrm{V}}(T)\\, F_{1/2}\\!\\left(\\frac{E_{\\mathrm{V}} - \\mu}{k_{\\mathrm{B}} T}\\right).\n$$\n\n自洽算法设计要求：\n- 定义标量残差 $\\,R(\\mu) = n(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) - p(\\mu,T) - N_{\\mathrm{D}}^+(\\mu,T)\\,$。使用具有保证收敛性的稳健区间法（例如，二分法或区间割线法）求解根 $\\,R(\\mu^\\star) = 0\\,$。您必须在您的解法中解释收敛准则，并在代码中实现它们。\n- 您的算法必须确保区间 $\\,\\mu\\in[\\mu_{\\min},\\mu_{\\max}]\\,$ 内包含 $\\,R(\\mu)\\,$ 的符号变化。如果初始区间内不存在符号变化，您必须系统地扩大或扫描该区间，直到找到符号变化，或者直到可以断定在合理范围内不存在物理可行解。在本问题中，您必须实现一个安全的扫描策略，然后使用一个区间求根器。\n- 使用可靠的求积法对积分表达式进行数值计算，以实现 $\\,F_{1/2}(\\eta)\\,$。您可以使用在半无限域 $\\,x\\in[0,\\infty)\\,$ 上的数值积分。确保对于大的正或负 $\\,\\eta\\,$ 值具有数值稳定性。\n\n物理和数值单位：\n- 能量 $\\,E\\,$, $\\,\\mu\\,$, $\\,E_{\\mathrm{C}}\\,$, $\\,E_{\\mathrm{V}}\\,$, $\\,E_{\\mathrm{D}}\\,$, $\\,E_{\\mathrm{A}}\\,$ 必须以电子伏特 (eV) 为单位。\n- 温度 $\\,T\\,$ 必须以开尔文 (K) 为单位。\n- 密度 $\\,N_{\\mathrm{D}}\\,$, $\\,N_{\\mathrm{A}}\\,$, $\\,n\\,$, $\\,p\\,$, $\\,N_{\\mathrm{C}}\\,$, $\\,N_{\\mathrm{V}}\\,$ 必须以 $\\mathrm{cm}^{-3}$ 为单位。\n- 最终答案必须表示为以 eV 为单位的 $\\,\\mu\\,$ 值，并四舍五入到六位小数。\n\n收敛准则：\n- 当 $\\,|R(\\mu)| \\le \\varepsilon_R\\,$ 和 $\\,|\\Delta \\mu| \\le \\varepsilon_\\mu\\,$ 同时满足时，迭代求根必须停止，其中 $\\,\\varepsilon_\\mu = 10^{-6}\\,$ eV 且 $\\,\\varepsilon_R = \\max\\!\\big(10^{-6}\\,\\mathcal{N},\\,10^{8}\\big)\\,$，$\\,\\mathcal{N} = N_{\\mathrm{D}} + N_{\\mathrm{A}} + N_{\\mathrm{C}}(T) + N_{\\mathrm{V}}(T)\\,$。如果您选择的数值求根器不直接提供 $\\,|\\Delta \\mu|\\,$，则强制执行 $\\,|R(\\mu)| \\le \\varepsilon_R\\,$ 以及对 $\\,\\mu\\,$ 的绝对区间容差小于 $\\,\\varepsilon_\\mu\\,$。\n\n能带与材料参数：\n- 使用 $\\,E_{\\mathrm{V}} = 0\\,$ eV 和 $\\,E_{\\mathrm{C}} = E_{\\mathrm{g}}\\,$，带隙 $\\,E_{\\mathrm{g}}\\,$ 由每个测试用例指定。\n- 使用 $\\,m_n^\\ast = 1.08\\,m_0\\,$ 和 $\\,m_p^\\ast = 0.81\\,m_0\\,$，其中 $\\,m_0\\,$ 是电子静止质量。\n- 除非另有说明，否则使用 $\\,g_{\\mathrm{D}} = 2\\,$ 和 $\\,g_{\\mathrm{A}} = 4\\,$。\n\n测试套件：\n实现您的程序，为以下五组参数求解 $\\,\\mu\\,$。每个测试用例是一个元组 $\\,(\\,E_{\\mathrm{g}},\\, T,\\, N_{\\mathrm{D}},\\, N_{\\mathrm{A}},\\, E_{\\mathrm{D}},\\, E_{\\mathrm{A}},\\, g_{\\mathrm{D}},\\, g_{\\mathrm{A}}\\,)\\,$，其中能量单位为 eV，温度单位为 K，密度单位为 $\\mathrm{cm}^{-3}$。\n\n- 情况 1 (类本征，类硅):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 0\\,$, $\\,N_{\\mathrm{A}} = 0\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.05\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.05\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- 情况 2 (中等 n 型):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 1.0\\times 10^{16}\\,$, $\\,N_{\\mathrm{A}} = 0\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.045\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.05\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- 情况 3 (强 p 型):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 0\\,$, $\\,N_{\\mathrm{A}} = 1.0\\times 10^{18}\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.05\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.03\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- 情况 4 (补偿型，低温下不完全电离):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 50\\,$, $\\,N_{\\mathrm{D}} = 1.0\\times 10^{17}\\,$, $\\,N_{\\mathrm{A}} = 5.0\\times 10^{16}\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.05\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.06\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- 情况 5 (简并 n 型，重掺杂):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 5.0\\times 10^{19}\\,$, $\\,N_{\\mathrm{A}} = 1.0\\times 10^{17}\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.02\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.06\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。\n- 每个条目必须是对应测试用例的 $\\,\\mu\\,$ 值（单位为 eV），四舍五入到六位小数，并按上述顺序列出。例如，$\\,\\big[\\mu_1,\\mu_2,\\mu_3,\\mu_4,\\mu_5\\big]\\,$，其中每个 $\\,\\mu_i\\,$ 是一个六位小数。",
            "solution": "用户提供的问题被评估为**有效**。这是一个在半导体物理学领域中提法明确、有科学依据的问题，它要求开发一种数值算法，通过强制执行电荷中性条件来找到费米能级。该问题提供了所有必要的物理模型、方程和参数。\n\n### 1. 理论框架\n\n问题的核心是通过求解电荷中性方程来找到掺杂半导体中的化学势（费米能级）$\\mu$。该方程指出，总负电荷密度必须等于总正电荷密度。电荷载流子包括导带中的自由电子、价带中的自由空穴、电离的受主杂质和电离的施主杂质。\n\n电荷中性条件表示为：\n$$\nn(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) = p(\\mu,T) + N_{\\mathrm{D}}^+(\\mu,T)\n$$\n\n其中：\n- $n(\\mu,T)$ 是导带中的电子浓度。\n- $p(\\mu,T)$ 是价带中的空穴浓度。\n- $N_{\\mathrm{A}}^-(\\mu,T)$ 是电离受主的浓度。\n- $N_{\\mathrm{D}}^+(\\mu,T)$ 是电离施主的浓度。\n- $T$ 是绝对温度。\n\n为了求解 $\\mu$，我们定义一个残差函数 $R(\\mu,T)$，其根对应于电荷中性条件：\n$$\nR(\\mu,T) = n(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) - p(\\mu,T) - N_{\\mathrm{D}}^+(\\mu,T) = 0\n$$\n\n该方程的各项基于费米-狄拉克统计和态密度定义如下。\n\n### 2. 载流子浓度\n\n电子（$n$）和空穴（$p$）的浓度是通过对所有可用能态上的态密度（DOS）与相应占据概率的乘积进行积分得到的。\n\n对于最小能量为 $E_{\\mathrm{C}}$ 的抛物线形导带中的电子：\n$$\nn(\\mu,T) = \\int_{E_{\\mathrm{C}}}^{\\infty} D_{\\mathrm{c}}(E) f(E,\\mu,T) \\, \\mathrm{d}E\n$$\n其中 $f(E,\\mu,T) = \\frac{1}{1+\\exp\\left(\\frac{E-\\mu}{k_{\\mathrm{B}} T}\\right)}$ 是费米-狄拉克分布函数，而 $D_{\\mathrm{c}}(E) = \\dfrac{1}{2\\pi^2}\\left(\\dfrac{2 m_n^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E - E_{\\mathrm{C}}}$ 是导带态密度。\n\n对于最大能量为 $E_{\\mathrm{V}}$ 的抛物线形价带中的空穴：\n$$\np(\\mu,T) = \\int_{-\\infty}^{E_{\\mathrm{V}}} D_{\\mathrm{v}}(E) [1 - f(E,\\mu,T)] \\, \\mathrm{d}E\n$$\n其中 $1 - f(E,\\mu,T)$ 是一个能态被空穴占据的概率，而 $D_{\\mathrm{v}}(E) = \\dfrac{1}{2\\pi^2}\\left(\\dfrac{2 m_p^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E_{\\mathrm{V}} - E}$ 是价带态密度。\n\n这些积分可以使用定义为如下的 $j$ 阶完全费米-狄拉克积分 $F_j(\\eta)$ 来重新表述：\n$$\nF_j(\\eta) = \\frac{1}{\\Gamma(j+1)} \\int_{0}^{\\infty} \\frac{x^j}{1 + \\exp(x - \\eta)} \\, \\mathrm{d}x\n$$\n在我们的情况下，$j=\\frac{1}{2}$，且 $\\Gamma(\\frac{3}{2}) = \\frac{\\sqrt{\\pi}}{2}$。这导出了问题中的定义：\n$$\nF_{1/2}(\\eta) = \\frac{2}{\\sqrt{\\pi}} \\int_{0}^{\\infty} \\frac{\\sqrt{x}}{1 + \\exp(x - \\eta)} \\, \\mathrm{d}x\n$$\n载流子浓度可以紧凑地表示为：\n$$\nn(\\mu,T) = N_{\\mathrm{C}}(T) F_{1/2}\\left(\\frac{\\mu - E_{\\mathrm{C}}}{k_{\\mathrm{B}} T}\\right)\n$$\n$$\np(\\mu,T) = N_{\\mathrm{V}}(T) F_{1/2}\\left(\\frac{E_{\\mathrm{V}} - \\mu}{k_{\\mathrm{B}} T}\\right)\n$$\n这里，$N_{\\mathrm{C}}(T)$ 和 $N_{\\mathrm{V}}(T)$ 分别是指导带和价带的有效态密度：\n$$\nN_{\\mathrm{C}}(T) = 2 \\left( \\frac{2\\pi m_n^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\n$$\n$$\nN_{\\mathrm{V}}(T) = 2 \\left( \\frac{2\\pi m_p^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\n$$\n这些将使用国际单位制（SI）中的基本常数计算，得到以 $\\mathrm{m}^{-3}$ 为单位的结果，然后通过乘以 $10^{-6}$ 转换为 $\\mathrm{cm}^{-3}$。\n\n### 3. 电离杂质浓度\n\n电离施主（$N_{\\mathrm{D}}^+$）和受主（$N_{\\mathrm{A}}^-$）的浓度是在假设 $E_{\\mathrm{D}}$ 和 $E_{\\mathrm{A}}$ 处存在单一、无相互作用的能级的模型下计算的。电离概率同样由类费米-狄拉克统计决定，包括简并因子 $g_{\\mathrm{D}}$ 和 $g_{\\mathrm{A}}$：\n$$\nN_{\\mathrm{D}}^+(\\mu,T) = N_{\\mathrm{D}} \\left[ 1 - \\frac{1}{1 + \\frac{1}{g_{\\mathrm{D}}} \\exp\\left(\\frac{E_{\\mathrm{D}} - \\mu}{k_{\\mathrm{B}} T}\\right)} \\right] = \\frac{N_{\\mathrm{D}}}{1 + g_{\\mathrm{D}} \\exp\\left(\\frac{\\mu - E_{\\mathrm{D}}}{k_{\\mathrm{B}} T}\\right)}\n$$\n$$\nN_{\\mathrm{A}}^-(\\mu,T) = N_{\\mathrm{A}} \\left[ \\frac{1}{1 + g_{\\mathrm{A}} \\exp\\left(\\frac{E_{\\mathrm{A}} - \\mu}{k_{\\mathrm{B}} T}\\right)} \\right] = \\frac{N_{\\mathrm{A}}}{1 + g_{\\mathrm{A}} \\exp\\left(\\frac{E_{\\mathrm{A}} - \\mu}{k_{\\mathrm{B}} T}\\right)}\n$$\n其中 $N_{\\mathrm{D}}$ 和 $N_{\\mathrm{A}}$ 是施主和受主原子的总浓度。\n\n### 4. 数值求解策略\n\n**费米-狄拉克积分的实现**：\n积分 $F_{1/2}(\\eta)$ 将进行数值计算。一种稳健的方法是，对宽范围的 $\\eta$ 使用自适应求积例程，例如 `scipy.integrate.quad`。对于可能发生数值上溢或下溢的极端 $\\eta$ 值，渐近近似提供了稳定性和效率：\n- 对于大的负 $\\eta$（非简并情况，$\\eta \\ll 0$）：$F_{1/2}(\\eta) \\approx e^{\\eta}$。\n- 对于大的正 $\\eta$（简并情况，$\\eta \\gg 0$）：$F_{1/2}(\\eta) \\approx \\frac{4}{3\\sqrt{\\pi}}\\eta^{3/2}$。\n我们将实现一个包装函数，在 $\\eta  -30$ 和 $\\eta > 50$ 时切换到这些近似。\n\n**求根算法**：\n目标是找到残差函数 $R(\\mu,T) = 0$ 的根 $\\mu^\\star$。$R(\\mu,T)$ 的性质是选择稳健算法的关键。每一项对 $\\mu$ 的依赖关系是：\n- $n(\\mu,T)$ 是单调递增的。\n- $N_{\\mathrm{A}}^-(\\mu,T)$ 是单调递增的。\n- $-p(\\mu,T)$ 是单调递增的（因为 $p$ 是递减的）。\n- $-N_{\\mathrm{D}}^+(\\mu,T)$ 是单调递增的（因为 $N_{\\mathrm{D}}^+$ 是递减的）。\n\n由于 $R(\\mu,T)$ 是单调递增函数的和，它本身也随 $\\mu$ 严格单调递增。此外，当 $\\mu \\to -\\infty$ 时，$R(\\mu) \\to -\\infty$，而当 $\\mu \\to +\\infty$ 时，$R(\\mu) \\to +\\infty$。这保证了对于任何有效的物理参数集，都存在唯一的根 $\\mu^\\star$。\n\n这种单调性使得区间求根法成为理想选择。我们将使用 SciPy 中的 `brentq` 算法，它结合了二分法的可靠性与割线法和反二次插值法的速度。\n\n算法流程如下：\n1.  **建立区间**：对于给定的测试用例，为 $\\mu$ 定义一个宽的初始搜索区间，例如 $[\\mu_{\\min}, \\mu_{\\max}]$。一个安全的选择是超出带隙的范围，例如 $[E_{\\mathrm{V}} - 1.0 \\, \\text{eV}, E_{\\mathrm{C}} + 1.0 \\, \\text{eV}]$。\n2.  **验证符号变化**：我们将评估 $R(\\mu_{\\min})$ 和 $R(\\mu_{\\max})$。由于函数的特性，我们预期 $R(\\mu_{\\min})  0$ 且 $R(\\mu_{\\max}) > 0$，从而确认根在区间内。如果不是，可以系统地扩大区间，尽管这预计不会是必要的。\n3.  **求解**：使用函数 $R$、区间 $[\\mu_{\\min}, \\mu_{\\max}]$ 和指定的容差调用 `brentq` 求解器。我们将对根设置一个严格的绝对容差 `xtol`，为 $10^{-7} \\, \\text{eV}$。这比要求的 $\\varepsilon_\\mu = 10^{-6} \\, \\text{eV}$ 更严格，并且由于 $R(\\mu)$ 的陡峭性，将确保残差 $|R(\\mu^\\star)|$ 非常小，满足问题收敛准则的精神。\n\n整个过程是遍历每个测试用例，组合参数，定义相应的残差函数 $R(\\mu)$，并应用求根程序来获得 $\\mu$。所有涉及物理常数和能量转换的计算都必须小心处理。我们使用 `scipy.constants` 中的常数以获得高精度，并在适当的地方以国际单位制（SI）进行计算，然后转换为问题指定的单位（cm$^{-3}$ 和 eV）。",
            "answer": "```python\nimport numpy as np\nfrom scipy import constants\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the Fermi level (chemical potential) in a semiconductor for various\n    doping and temperature conditions by solving the charge neutrality equation.\n    \"\"\"\n\n    # --- Physical Constants ---\n    # Using scipy.constants for high precision.\n    m0 = constants.m_e  # Electron rest mass in kg\n    h = constants.h      # Planck constant in J·s\n    kB_J_K = constants.k # Boltzmann constant in J/K\n    q = constants.e      # Elementary charge in C\n\n    # Conversion factors\n    kB_eV_K = kB_J_K / q  # Boltzmann constant in eV/K\n\n    # --- Fermi-Dirac Integral F_1/2(eta) ---\n    def fermi_dirac_integral_half(eta):\n        \"\"\"\n        Computes the complete Fermi-Dirac integral of order 1/2.\n        F_1/2(eta) = (2/sqrt(pi)) * integral from 0 to inf of sqrt(x)/(1+exp(x-eta)) dx\n        \n        Uses asymptotic approximations for large positive or negative eta for stability\n        and performance.\n        \"\"\"\n        if eta > 50:\n            # Degenerate approximation\n            return (4 / (3 * np.sqrt(np.pi))) * eta**1.5\n        elif eta  -30:\n            # Non-degenerate (Maxwell-Boltzmann) approximation\n            return np.exp(eta)\n        else:\n            # Numerical integration using scipy.integrate.quad\n            integrand = lambda x: np.sqrt(x) / (1 + np.exp(x - eta))\n            result, _ = quad(integrand, 0, np.inf)\n            return (2 / np.sqrt(np.pi)) * result\n\n    # --- Test Cases ---\n    # Each tuple: (Eg [eV], T [K], ND [cm^-3], NA [cm^-3], ED [eV], EA [eV], gD, gA)\n    # The energy levels ED and EA are pre-calculated from the problem description.\n    # EV is set to 0 eV, so EC = Eg.\n    test_cases_desc = [\n        # Case 1: Intrinsic-like\n        (1.12, 300, 0.0, 0.0, 1.12 - 0.05, 0.0 + 0.05, 2, 4),\n        # Case 2: Moderately n-type\n        (1.12, 300, 1.0e16, 0.0, 1.12 - 0.045, 0.0 + 0.05, 2, 4),\n        # Case 3: Strongly p-type\n        (1.12, 300, 0.0, 1.0e18, 1.12 - 0.05, 0.0 + 0.03, 2, 4),\n        # Case 4: Compensated, low T\n        (1.12, 50, 1.0e17, 5.0e16, 1.12 - 0.05, 0.0 + 0.06, 2, 4),\n        # Case 5: Degenerate n-type\n        (1.12, 300, 5.0e19, 1.0e17, 1.12 - 0.02, 0.0 + 0.06, 2, 4),\n    ]\n\n    # --- Material Parameters ---\n    mn_star_eff = 1.08 * m0  # Electron effective mass\n    mp_star_eff = 0.81 * m0  # Hole effective mass\n\n    results = []\n\n    for case in test_cases_desc:\n        Eg, T, ND, NA, ED, EA, gD, gA = case\n        \n        # --- Setup for Current Case ---\n        EV = 0.0\n        EC = Eg\n        kT_eV = kB_eV_K * T\n\n        # Calculate effective density of states (Nc, Nv)\n        # Formula: 2 * (2*pi*m_eff*kB*T / h^2)^(3/2)\n        # Calculation is done in SI units (m^-3), then converted to cm^-3.\n        \n        nc_si = 2 * ( (2 * np.pi * mn_star_eff * kB_J_K * T) / (h**2) )**1.5\n        nv_si = 2 * ( (2 * np.pi * mp_star_eff * kB_J_K * T) / (h**2) )**1.5\n        \n        NC = nc_si * 1e-6  # Convert m^-3 to cm^-3\n        NV = nv_si * 1e-6  # Convert m^-3 to cm^-3\n\n        # --- Residual Function for Root Finding ---\n        def residual_charge_neutrality(mu):\n            \"\"\"\n            Calculates the net charge density R(mu) = n + NA_ion - p - ND_ion.\n            The root R(mu) = 0 is the solution for the Fermi level.\n            All energies (mu, EC, EV, ED, EA) are in eV.\n            All densities are in cm^-3.\n            \"\"\"\n            \n            # Electron concentration (n)\n            eta_n = (mu - EC) / kT_eV\n            n = NC * fermi_dirac_integral_half(eta_n)\n            \n            # Hole concentration (p)\n            eta_p = (EV - mu) / kT_eV\n            p = NV * fermi_dirac_integral_half(eta_p)\n            \n            # Ionized donor concentration (ND+)\n            exp_term_d = np.exp((mu - ED) / kT_eV)\n            ND_plus = ND / (1 + gD * exp_term_d)\n            \n            # Ionized acceptor concentration (NA-)\n            exp_term_a = np.exp((EA - mu) / kT_eV)\n            NA_minus = NA / (1 + gA * exp_term_a)\n            \n            return n + NA_minus - p - ND_plus\n\n        # --- Solve for Fermi Level (mu) ---\n        # Establish a wide search bracket for mu\n        mu_min = EV - 1.0\n        mu_max = EC + 1.0\n        \n        # Use Brent's method for robust and fast root finding.\n        # The function is monotonic, so a unique root is guaranteed to exist.\n        # A tight tolerance on mu ensures high precision.\n        try:\n            mu_solution = brentq(residual_charge_neutrality, mu_min, mu_max, xtol=1e-8)\n            results.append(round(mu_solution, 6))\n        except ValueError:\n            # This should ideally not happen for this problem due to monotonic nature.\n            # Handle case where root is not bracketed, which indicates an issue.\n            results.append(np.nan) # Or other error indication\n\n    # --- Final Output ---\n    # Format the results as a comma-separated list in brackets, rounded to 6 decimal places.\n    output_str = f\"[{','.join(f'{r:.6f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}