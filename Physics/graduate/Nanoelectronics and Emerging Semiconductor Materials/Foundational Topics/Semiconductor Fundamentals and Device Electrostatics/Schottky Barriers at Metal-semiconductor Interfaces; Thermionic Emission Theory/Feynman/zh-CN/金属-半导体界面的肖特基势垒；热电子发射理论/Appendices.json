{
    "hands_on_practices": [
        {
            "introduction": "温度相关的电流-电压（$I-V-T$）测量是表征肖特基势垒最有力的方法之一。通过分析在不同温度下测得的数据，我们可以将与温度无关的势垒高度与热激发过程分离开来。本练习将指导您使用阿伦尼乌斯图（Arrhenius plot），一种从实验数据中精确提取零偏压势垒高度 $\\phi_B$ 和理想因子 $n$ 的标准技术 。",
            "id": "4299391",
            "problem": "一个金属-半导体肖特基二极管在一个中等掺杂的 $n$ 型半导体上制造，使得跨接触面的输运主要由越过势垒的热电子发射主导。假设势垒高度 $\\phi_B$ 是均匀的，串联电阻可忽略，隧穿效应可忽略，并且在所考虑的电场范围内，镜像力导致的势垒降低很小。在固定的外加电压 $V$ 下，测量正向电流密度 $J$ 作为温度 $T$ 的函数，并将数据绘制成 $\\ln(J/T^2)$ 对 $1/T$ 的图像（阿伦尼乌斯图）。在 $T\\in[200,350]\\,\\mathrm{K}$ 的温度范围内，得到的是直线，在两个正向偏压下，斜率（单位为 $\\mathrm{K}$）为：\n- 在 $V_1=0.20\\,\\mathrm{V}$ 时：$S_1=-6.77\\times 10^3$，\n- 在 $V_2=0.50\\,\\mathrm{V}$ 时：$S_2=-3.87\\times 10^3$。\n\n使用来自电子分布的麦克斯韦-玻尔兹曼尾部的热电子发射的基本原理以及理想因子 $n$ 的概念，来推断在固定 $V$ 下正向电流的温度依赖性。然后确定哪一对 $(\\phi_B,n)$ 与上述阿伦尼乌斯斜率一致。取玻尔兹曼常数为 $k_B=8.617\\times 10^{-5}\\,\\mathrm{eV/K}$，并且注意，当 $V$ 的单位是伏特时，以电子伏特 (eV) 表示的 $qV$ 在数值上等于 $V$。\n\n选择正确的选项：\n- A. $\\phi_B=0.75\\,\\mathrm{eV}$, $n=1.20$。\n\n- B. $\\phi_B=0.58\\,\\mathrm{eV}$, $n=1.00$。\n\n- C. $\\phi_B=0.33\\,\\mathrm{eV}$, $n=1.20$。\n\n- D. $\\phi_B=0.75\\,\\mathrm{eV}$, $n=1.00$。",
            "solution": "该问题要求根据与温度相关的电流-电压测量结果，确定金属-半导体肖特基二极管的肖特基势垒高度 $\\phi_B$ 和理想因子 $n$。分析基于热电子发射模型。\n\n### 第1步：问题验证\n\n首先，我将仔细验证问题陈述。\n\n**1.1. 提取给定条件：**\n- 器件：金属-半导体肖特基二极管，$n$ 型半导体。\n- 输运机制：以热电子发射为主。\n- 假设：势垒高度 $\\phi_B$ 均匀，串联电阻可忽略，隧穿效应可忽略，镜像力导致的势垒降低很小。\n- 测量：在固定外加电压 $V$ 下，正向电流密度 $J$ 随温度 $T$ 的变化。\n- 数据表示：$\\ln(J/T^2)$ 对 $1/T$ 的图像。\n- 观察：在 $T \\in [200, 350]\\,\\mathrm{K}$ 温度范围内，图像为直线。\n- 数据点1：在 $V_1 = 0.20\\,\\mathrm{V}$ 的正向偏压下，图像斜率为 $S_1 = -6.77 \\times 10^3\\,\\mathrm{K}$。\n- 数据点2：在 $V_2 = 0.50\\,\\mathrm{V}$ 的正向偏压下，图像斜率为 $S_2 = -3.87 \\times 10^3\\,\\mathrm{K}$。\n- 常数：玻尔兹曼常数，$k_B = 8.617 \\times 10^{-5}\\,\\mathrm{eV/K}$。\n- 约定：以电子伏特 (eV) 为单位的 $qV$ 在数值上等于以伏特 (V) 为单位的 $V$。\n\n**1.2. 使用提取的给定条件进行验证：**\n该问题在科学上基于肖特基二极管的标准热电子发射理论，这是半导体器件物理学中的一个基本课题。使用阿伦尼乌斯图（$\\ln(J/T^2)$ vs. $1/T$）来提取活化能（并由此得到势垒高度）是一种标准的实验技术。理想因子 $n$ 是一个用于解释非理想行为的成熟概念。这个问题是适定的，提供了两个独立的测量值（两个电压下的斜率）来确定两个未知数（$\\phi_B$ 和 $n$）。语言客观而精确。数据在物理上是合理的：更高的正向偏压会降低有效势垒，这应该导致负斜率的绝对值更小，而实际上对于 $V_2 > V_1$，我们有 $|S_2| < |S_1|$。给定的电压、温度和斜率值对于半导体表征实验是现实的。问题是自洽的，没有矛盾或歧义。\n\n**1.3. 结论与行动：**\n问题陈述有效。我将继续推导解答。\n\n### 第2步：解答推导\n\n在正向偏压下，以热电子发射为主的肖特基二极管的电流密度 $J$ 由下式给出：\n$$ J = A^{**} T^2 \\exp\\left(-\\frac{q\\phi_B}{k_B T}\\right) \\left[ \\exp\\left(\\frac{qV}{nk_B T}\\right) - 1 \\right] $$\n其中 $A^{**}$ 是有效理查德森常数，$q$ 是元电荷，$\\phi_B$ 是零偏压势垒高度，$V$ 是外加正向偏压，$n$ 是理想因子，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n对于给定的正向偏压 $V_1 = 0.20\\,\\mathrm{V}$ 和 $V_2 = 0.50\\,\\mathrm{V}$，项 $qV/(nk_B T)$ 远大于 $1$。例如，在 $T=300\\,\\mathrm{K}$ 时，$k_B T \\approx (8.617 \\times 10^{-5}\\,\\mathrm{eV/K})(300\\,\\mathrm{K}) \\approx 0.0259\\,\\mathrm{eV}$。对于 $V_1 = 0.20\\,\\mathrm{V}$ 并假设 $n \\approx 1$，则 $qV_1/(nk_BT) \\approx 0.20/0.0259 \\approx 7.7$。因此，$\\exp(qV/(nk_B T)) \\gg 1$，$-1$ 项可以忽略。正向电流密度表达式简化为：\n$$ J \\approx A^{**} T^2 \\exp\\left(-\\frac{q\\phi_B}{k_B T}\\right) \\exp\\left(\\frac{qV}{nk_B T}\\right) $$\n合并指数项：\n$$ J \\approx A^{**} T^2 \\exp\\left( -\\frac{q(\\phi_B - V/n)}{k_B T} \\right) $$\n为了匹配阿伦尼乌斯图的形式，我们重新整理方程：\n$$ \\frac{J}{T^2} \\approx A^{**} \\exp\\left( -\\frac{q(\\phi_B - V/n)}{k_B T} \\right) $$\n对两边取自然对数：\n$$ \\ln\\left(\\frac{J}{T^2}\\right) \\approx \\ln(A^{**}) - \\frac{q(\\phi_B - V/n)}{k_B T} $$\n这个方程是直线形式 $y = c + mx$，其中 $y = \\ln(J/T^2)$，$x = 1/T$，截距 $c = \\ln(A^{**})$，斜率 $S$ 是：\n$$ S = -\\frac{q(\\phi_B - V/n)}{k_B} $$\n问题陈述中提到在图上获得了直线，这意味着在给定的温度范围内，$\\phi_B$ 和 $n$ 可以被视为常数。问题中使用的单位是：能量为 eV，电压为 V，$k_B$ 为 eV/K。在这个单位体系中，因子 $q$ 被隐式处理，斜率方程变为：\n$$ S(V) = -\\frac{\\phi_B - V/n}{k_B} $$\n其中 $\\phi_B$ 的单位是 eV，$V$ 的单位是 V，$k_B$ 的单位是 eV/K。斜率的单位是 $(\\mathrm{eV})/(\\mathrm{eV/K}) = \\mathrm{K}$，与问题陈述一致。\n\n现在我们基于提供的两个数据点，得到了一个关于两个未知数 $\\phi_B$ 和 $1/n$ 的二元线性方程组。\n对于 $(V_1, S_1) = (0.20\\,\\mathrm{V}, -6.77 \\times 10^3\\,\\mathrm{K})$：\n$$ -6.77 \\times 10^3 = -\\frac{\\phi_B - 0.20/n}{8.617 \\times 10^{-5}} $$\n$$ \\phi_B - \\frac{0.20}{n} = (6.77 \\times 10^3) \\times (8.617 \\times 10^{-5}) = 0.5832709 $$\n\n对于 $(V_2, S_2) = (0.50\\,\\mathrm{V}, -3.87 \\times 10^3\\,\\mathrm{K})$：\n$$ -3.87 \\times 10^3 = -\\frac{\\phi_B - 0.50/n}{8.617 \\times 10^{-5}} $$\n$$ \\phi_B - \\frac{0.50}{n} = (3.87 \\times 10^3) \\times (8.617 \\times 10^{-5}) = 0.3334800 $$\n\n我们得到方程组：\n1) $\\phi_B - 0.20/n = 0.58327$\n2) $\\phi_B - 0.50/n = 0.33348$\n\n为了求出 $1/n$，我们将方程(2)从方程(1)中减去：\n$$ (\\phi_B - 0.20/n) - (\\phi_B - 0.50/n) = 0.58327 - 0.33348 $$\n$$ 0.30/n = 0.24979 $$\n$$ \\frac{1}{n} = \\frac{0.24979}{0.30} \\approx 0.83263 $$\n这给出了理想因子：\n$$ n = \\frac{1}{0.83263} \\approx 1.20099 \\approx 1.20 $$\n\n现在，将 $1/n$ 的值代回方程(1)来求解 $\\phi_B$：\n$$ \\phi_B = 0.58327 + 0.20/n = 0.58327 + 0.20 \\times (0.83263) $$\n$$ \\phi_B = 0.58327 + 0.166526 = 0.749796 \\,\\mathrm{eV} \\approx 0.75\\,\\mathrm{eV} $$\n\n计算出的参数为 $\\phi_B \\approx 0.75\\,\\mathrm{eV}$ 和 $n \\approx 1.20$。\n\n### 第3步：逐项分析\n\n现在我们使用推导出的参数作为参考来评估每个选项。\n\n- **A. $\\phi_B=0.75\\,\\mathrm{eV}$, $n=1.20$。**\n这个选项与我们的计算结果完全匹配。让我们用这些值计算斜率来验证。\n$S_1 = -\\frac{0.75 - 0.20/1.20}{8.617 \\times 10^{-5}} = -\\frac{0.75 - 0.1666...}{8.617 \\times 10^{-5}} = -\\frac{0.5833...}{8.617 \\times 10^{-5}} \\approx -6770.8\\,\\mathrm{K} \\approx -6.77 \\times 10^3\\,\\mathrm{K}$。\n$S_2 = -\\frac{0.75 - 0.50/1.20}{8.617 \\times 10^{-5}} = -\\frac{0.75 - 0.4166...}{8.617 \\times 10^{-5}} = -\\frac{0.3333...}{8.617 \\times 10^{-5}} \\approx -3868.5\\,\\mathrm{K} \\approx -3.87 \\times 10^3\\,\\mathrm{K}$。\n两个计算出的斜率都与给定的实验值精确匹配（在四舍五入的范围内）。\n**结论：正确。**\n\n- **B. $\\phi_B=0.58\\,\\mathrm{eV}$, $n=1.00$。**\n让我们计算预期的斜率 $S_1$：\n$S_1 = -\\frac{0.58 - 0.20/1.00}{8.617 \\times 10^{-5}} = -\\frac{0.38}{8.617 \\times 10^{-5}} \\approx -4410\\,\\mathrm{K}$。\n这个 $-4.41 \\times 10^3\\,\\mathrm{K}$ 的值与给定的 $S_1 = -6.77 \\times 10^3\\,\\mathrm{K}$ 有显著差异。\n**结论：不正确。**\n\n- **C. $\\phi_B=0.33\\,\\mathrm{eV}$, $n=1.20$。**\n让我们计算预期的斜率 $S_1$：\n$S_1 = -\\frac{0.33 - 0.20/1.20}{8.617 \\times 10^{-5}} = -\\frac{0.33 - 0.1666...}{8.617 \\times 10^{-5}} = -\\frac{0.1633...}{8.617 \\times 10^{-5}} \\approx -1895\\,\\mathrm{K}$。\n这个 $-1.90 \\times 10^3\\,\\mathrm{K}$ 的值与给定的 $S_1 = -6.77 \\times 10^3\\,\\mathrm{K}$ 有显著差异。此外，对于 $V_2$，有效势垒 $\\phi_B - V_2/n = 0.33 - 0.50/1.20 = 0.33 - 0.4166...  0$，这在该模型中是物理上无意义的，并且会导致正斜率。\n**结论：不正确。**\n\n- **D. $\\phi_B=0.75\\,\\mathrm{eV}$, $n=1.00$。**\n让我们计算预期的斜率：\n$S_1 = -\\frac{0.75 - 0.20/1.00}{8.617 \\times 10^{-5}} = -\\frac{0.55}{8.617 \\times 10^{-5}} \\approx -6383\\,\\mathrm{K} \\approx -6.38 \\times 10^3\\,\\mathrm{K}$。\n这与给定的 $S_1 = -6.77 \\times 10^3\\,\\mathrm{K}$ 不同。\n$S_2 = -\\frac{0.75 - 0.50/1.00}{8.617 \\times 10^{-5}} = -\\frac{0.25}{8.617 \\times 10^{-5}} \\approx -2901\\,\\mathrm{K} \\approx -2.90 \\times 10^3\\,\\mathrm{K}$。\n这与给定的 $S_2 = -3.87 \\times 10^3\\,\\mathrm{K}$ 有很大差异。这对斜率与数据不一致。\n**结论：不正确。**\n\n只有选项A提供的 $\\phi_B$ 和 $n$ 值与两个实验数据点都一致。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在分析了串联电阻对测量数据的影响之后，下一步是从第一性原理出发构建一个物理模型来预测这种行为。本计算练习要求您建立一个自洽的输运模型，该模型耦合了界面处的热电子发射和半导体体材料中的漂移-扩散过程。通过数值求解，您可以深入理解宏观串联电阻是如何从微观输运物理中产生的 。",
            "id": "4299398",
            "problem": "您的任务是通过将金属-半导体肖特基接触点的热电子发射（TE）电流与包含接触点热电子发射边界条件的一维漂移-扩散输运模型进行比较，来验证该电流。您必须从基本原理出发推导出控制关系，并实现一个程序，该程序能针对一组给定参数，计算出TE限制的电流密度，以及从接触点与半导体体区之间自洽耦合得到的漂移-扩散限制的电流密度。然后，您必须量化高电场下的偏差。\n\n从以下基础开始：\n- 在金属-半导体肖特基势垒附近的非简并半导体中，载流子的分布遵循麦克斯韦-玻尔兹曼分布，温度为 $T$，玻尔兹曼常数为 $k_B$，基本电荷为 $q$。\n- 克服高度为 $q\\phi_B$ 的能垒的载流子通量，由其垂直于界面的速度分量和具有足够能量的态的占据情况决定。\n- 半导体体区中的输运的漂移-扩散描述将电流密度 $J$ 与电场 $E$ 通过迁移率 $\\mu$ 和非简并极限下的施主密度 $N_D$ 联系起来，并且长度为 $L$ 的均匀段上的电势降为 $V_{\\text{bulk}} = E L$。\n- 爱因斯坦关系将扩散系数 $D$ 和迁移率 $\\mu$ 联系起来，即 $D = \\mu k_B T/q$，在均匀体区中，当浓度梯度可忽略且处于强场下时，漂移项占主导地位。\n\n您的任务：\n1) 从第一性原理出发，推导跨越势垒的TE限制电流密度，作为势垒上的电势降 $V_s$、温度 $T$、势垒高度 $\\phi_B$ 和有效理查森常数 $A_R$ 的函数。\n2) 从体区中的漂移-扩散关系出发，推导一个连接 $J$、$V_{\\text{bulk}}$、$L$、$q$、$\\mu$ 和 $N_D$ 的欧姆串联表示。\n3) 应用基尔霍夫电压定律将势垒压降与体区压降耦合为 $V_{\\text{total}} = V_s + V_{\\text{bulk}}$，并求解同时满足接触点发射和体区输运的自洽电流密度 $J$，不使用任何简化公式。\n4) 将“纯TE”电流密度定义为当全部施加电压都降在势垒上时获得的电流密度，即 $V_s = V_{\\text{total}}$ 且 $V_{\\text{bulk}} = 0$，并明确计算它。\n5) 将自洽漂移-扩散电流密度与纯TE电流密度之间的偏差量化为一个小数，定义为 $(J_{\\text{DD}} - J_{\\text{TE,pure}})/J_{\\text{TE,pure}}$。如果 $J_{\\text{TE,pure}} = 0$，则定义偏差为 $0$。\n\n实现要求：\n- 您的程序必须建立势垒和体区之间的自洽耦合，并通过稳健的方法数值求解 $J$。公式必须具有通用性且科学上一致。\n- 在国际单位制（SI）中使用以下物理常数：$q = 1.602176634\\times 10^{-19}\\,C$，$k_B = 1.380649\\times 10^{-23}\\,J/K$。除非另有说明，否则使用有效理查森常数 $A_R = 1.2\\times 10^6\\,A\\,m^{-2}\\,K^{-2}$。\n- 所有电流密度以 $A/m^2$ 表示，电压以 $V$ 表示，长度以 $m$ 表示，温度以 $K$ 表示，势垒高度以 $eV$ 表示，施主密度以 $m^{-3}$ 表示，迁移率以 $m^2/(V\\cdot s)$ 表示。\n- 不涉及角度；无需角度单位。\n- 偏差必须以小数形式输出，而不是百分比。\n\n测试套件：\n为以下五个测试案例计算结果，每个案例指定为 $(T,\\ \\phi_B,\\ V_{\\text{total}},\\ L,\\ N_D,\\ \\mu,\\ A_R)$：\n- 案例1（理想情况）：$(300,\\ 0.7,\\ 0.2,\\ 1.0\\times 10^{-6},\\ 1.0\\times 10^{23},\\ 0.14,\\ 1.2\\times 10^6)$。\n- 案例2（高电场、长体区、低掺杂）：$(300,\\ 0.7,\\ 0.5,\\ 1.0\\times 10^{-3},\\ 1.0\\times 10^{21},\\ 0.05,\\ 1.2\\times 10^6)$。\n- 案例3（零施加电压）：$(300,\\ 0.7,\\ 0.0,\\ 1.0\\times 10^{-6},\\ 1.0\\times 10^{23},\\ 0.14,\\ 1.2\\times 10^6)$。\n- 案例4（高势垒）：$(300,\\ 0.9,\\ 1.0,\\ 1.0\\times 10^{-4},\\ 1.0\\times 10^{21},\\ 0.05,\\ 1.2\\times 10^6)$。\n- 案例5（高温、中等长度和掺杂）：$(500,\\ 0.6,\\ 0.2,\\ 1.0\\times 10^{-4},\\ 5.0\\times 10^{21},\\ 0.10,\\ 1.2\\times 10^6)$。\n\n输出规格：\n- 对于每个案例，计算三个量：纯TE电流密度 $J_{\\text{TE,pure}}$（单位 $A/m^2$），自洽漂移-扩散电流密度 $J_{\\text{DD}}$（单位 $A/m^2$），以及偏差 $(J_{\\text{DD}} - J_{\\text{TE,pure}})/J_{\\text{TE,pure}}$（以小数表示）。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按案例排序并展开为三元组，即 $[J_{\\text{TE,pure},1},J_{\\text{DD},1},\\delta_1,\\ J_{\\text{TE,pure},2},J_{\\text{DD},2},\\delta_2,\\ \\dots,\\ J_{\\text{TE,pure},5},J_{\\text{DD},5},\\delta_5]$。",
            "solution": "我们首先从第一性原理推导金属-半导体肖特基势垒的热电子发射电流。考虑半导体中的电子在温度 $T$ 下服从麦克斯韦-玻尔兹曼分布，其中玻尔兹曼常数为 $k_B$，基本电荷为 $q$。在界面处，电子必须克服高度为 $q\\phi_B$ 的能垒才能进入金属。从半导体进入金属的热电子通量是法向速度分量 $v_z$ 与具有足够能量穿越势垒的态的占据数之积对能量的积分。在非简并半导体和经典统计的假设下，该计算得出的电流密度与 $T^2$ 成正比，并带有一个由势垒引起的指数抑制因子。根据对称性，从金属进入半导体的反向通量也与 $T^2$ 成正比，并取决于金属中载流子面临的势垒。净电流是正向发射和反向发射之差。\n\n著名的理查森定律概括了这一点，通过有效理查森常数 $A_R$ 得到了饱和电流密度参数 $J_s$：\n$$\nJ_s = A_R\\,T^2 \\exp\\!\\left(-\\frac{q\\phi_B}{k_B T}\\right),\n$$\n其中 $A_R$ 可被视为一个与材料相关的常数，包含了有效质量。当电势 $V_s$ 降在势垒上时，半导体一侧相对于金属一侧的占据情况被改变，导致净发射的指数变化。跨越势垒的净热电子发射电流密度为\n$$\nJ_{\\text{TE}}(V_s) = J_s \\left[\\exp\\!\\left(\\frac{q V_s}{k_B T}\\right) - 1\\right].\n$$\n该形式源于正向发射（因 $V_s$ 引起的势垒降低而增强）和反向发射之间的不平衡。\n\n接下来，我们用漂移-扩散关系来描述半导体体区中的输运。在非简并、均匀掺杂极限下，施主密度为 $N_D$，电子迁移率为 $\\mu$，电流密度为\n$$\nJ = q n \\mu E + q D \\frac{dn}{dx}.\n$$\n根据爱因斯坦关系，$D = \\mu k_B T / q$。在均匀掺杂和强施加电场下，当浓度梯度可忽略时，漂移项占主导地位且 $n \\approx N_D$，从而得到一个欧姆形式\n$$\nJ \\approx q N_D \\mu\\, E.\n$$\n穿过长度为 $L$ 的均匀体区的电场 $E$ 产生电势降 $V_{\\text{bulk}} = E L$。结合这些，我们得到\n$$\nV_{\\text{bulk}} = \\frac{L}{q N_D \\mu}\\, J.\n$$\n该关系定义了一个有效串联体区系数 $r_s$，单位为 $V$ 每 $(A/m^2)$，\n$$\nr_s \\equiv \\frac{L}{q N_D \\mu},\n$$\n使得 $V_{\\text{bulk}} = r_s J$。\n\n接触点加体区系统的基尔霍夫电压定律为\n$$\nV_{\\text{total}} = V_s + V_{\\text{bulk}} = V_s + r_s J.\n$$\n自洽地耦合接触点关系和体区关系，得到稳态电流密度 $J$ 的非线性方程：\n$$\nJ = J_s \\left[\\exp\\!\\left(\\frac{q}{k_B T}\\left(V_{\\text{total}} - r_s J\\right)\\right) - 1\\right].\n$$\n定义 $\\gamma \\equiv q/(k_B T)$。确定 $J$ 的根的函数是\n$$\nF(J) = J - J_s\\left[\\exp\\!\\left(\\gamma \\left(V_{\\text{total}} - r_s J\\right)\\right) - 1\\right] = 0.\n$$\n一个稳健的求解方法是牛顿法，使用导数\n$$\n\\frac{dF}{dJ} = 1 + J_s\\, \\gamma\\, r_s\\, \\exp\\!\\left(\\gamma \\left(V_{\\text{total}} - r_s J\\right)\\right),\n$$\n该导数严格为正，确保了单调性并有助于收敛。一个有效的初始猜测是 $J_0 = \\min\\{J_{\\text{TE,pure}},\\, V_{\\text{total}}/r_s\\}$，其中\n$$\nJ_{\\text{TE,pure}} \\equiv J_s \\left[\\exp\\!\\left(\\gamma V_{\\text{total}}\\right) - 1\\right]\n$$\n是当全部电压降在势垒上时（$V_s = V_{\\text{total}}$ 且 $V_{\\text{bulk}}=0$）的“纯TE”电流密度。项 $V_{\\text{total}}/r_s$ 是当势垒压降可忽略时的漂移限制欧姆电流。\n\n偏差随后被量化为\n$$\n\\delta = \\begin{cases}\n\\dfrac{J_{\\text{DD}} - J_{\\text{TE,pure}}}{J_{\\text{TE,pure}}},  J_{\\text{TE,pure}} \\neq 0, \\\\\n0,  J_{\\text{TE,pure}} = 0,\n\\end{cases}\n$$\n其中 $J_{\\text{DD}}$ 是 $F(J)=0$ 的自洽解。\n\n算法步骤：\n- 对每个测试案例，根据 $A_R$、$T$ 和 $\\phi_B$ 计算 $J_s$。\n- 计算 $\\gamma = q/(k_B T)$ 和 $r_s = L/(q N_D \\mu)$。\n- 根据 $J_s$ 和 $\\gamma$ 在 $V_{\\text{total}}$ 处计算 $J_{\\text{TE,pure}}$。\n- 如果 $r_s = 0$，则设置 $J_{\\text{DD}} = J_{\\text{TE,pure}}$。否则，应用带有安全指数处理的牛顿法求解 $F(J)=0$ 以得到 $J \\ge 0$。\n- 计算偏差 $\\delta$。\n- 按指定顺序将所有案例的结果输出为单个扁平化列表。\n\n科学真实性和边界情况：\n- 在案例1中，串联体区压降很小，因此 $J_{\\text{DD}} \\approx J_{\\text{TE,pure}}$（理想情况）。\n- 在案例2中，长体区和低掺杂产生大的 $r_s$，强烈限制了 $J_{\\text{DD}}$；势垒上的电压很小，因此偏差很大且为负。\n- 在案例3中，$V_{\\text{total}}=0$ 导致 $J_{\\text{TE,pure}}=0$ 和 $J_{\\text{DD}}=0$，根据定义 $\\delta=0$。\n- 在案例4中，高势垒抑制了 $J_s$，即使在相当大的 $V_{\\text{total}}$ 下也只产生小电流；偏差适中。\n- 在案例5中，升高的 $T$ 降低了指数抑制并增加了 $J_s$，但串联体区的作用仍然取决于 $L$、$N_D$ 和 $\\mu$。\n\n所有计算出的电流密度必须以 $A/m^2$ 报告，电压以 $V$ 报告，长度以 $m$ 报告，温度以 $K$ 报告，势垒高度以 $eV$ 报告，施主密度以 $m^{-3}$ 报告，迁移率以 $m^2/(V\\cdot s)$ 报告，偏差以小数形式报告。程序将把输出汇总成指定的单行列表格式。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants in SI units\nq = 1.602176634e-19       # Coulomb\nkB = 1.380649e-23         # J/K\n\ndef pure_TE_current_density(T, phiB_eV, V_total, A_R):\n    \"\"\"\n    Compute the 'pure TE' current density (A/m^2) assuming the entire applied voltage\n    drops across the Schottky barrier.\n    \"\"\"\n    beta = (q * phiB_eV) / (kB * T)  # with phiB in eV, q*phiB converts to Joules\n    Js = A_R * (T**2) * np.exp(-beta)\n    gamma = q / (kB * T)\n    return Js * (np.exp(gamma * V_total) - 1.0)\n\ndef self_consistent_dd_current_density(T, phiB_eV, V_total, L, ND, mu, A_R, max_iter=100, tol=1e-12):\n    \"\"\"\n    Solve J = Js * (exp(gamma * (V_total - r_s * J)) - 1) for current density J (A/m^2),\n    where r_s = L / (q * mu * ND).\n    Uses Newton's method with safe exponent handling and nonnegative clamp.\n    \"\"\"\n    beta = (q * phiB_eV) / (kB * T)\n    Js = A_R * (T**2) * np.exp(-beta)\n    gamma = q / (kB * T)\n    # Series bulk coefficient r_s in V per (A/m^2)\n    denom = q * mu * ND\n    # Handle potential division by zero gracefully\n    if denom == 0.0:\n        return pure_TE_current_density(T, phiB_eV, V_total, A_R)\n    r_s = L / denom\n\n    # Initial guess: min(pure TE current, ohmic-limited current V/r_s)\n    J_te_pure = Js * (np.exp(gamma * V_total) - 1.0)\n    J_ohm = V_total / r_s if r_s > 0 else J_te_pure\n    J = max(0.0, min(J_te_pure, J_ohm)) if J_te_pure >= 0 else 0.0\n\n    # Newton iterations\n    for _ in range(max_iter):\n        exp_arg = gamma * (V_total - r_s * J)\n        # Prevent numerical overflow in exp; 700 is a safe upper bound for double precision\n        exp_arg = np.clip(exp_arg, -700.0, 700.0)\n        exp_term = np.exp(exp_arg)\n        F = J - Js * (exp_term - 1.0)\n\n        # Check convergence\n        if abs(F)  tol * (1.0 + abs(J_te_pure)):\n            break\n\n        dF = 1.0 + Js * gamma * r_s * exp_term\n        # Update\n        step = F / dF\n        J_new = J - step\n        # Clamp to nonnegative\n        if J_new  0.0:\n            # If Newton proposes negative, back off step\n            J_new = 0.5 * J\n        \n        J = J_new\n\n    return max(0.0, J)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T, phiB_eV, V_total, L, ND, mu, A_R)\n    test_cases = [\n        (300.0, 0.7, 0.2, 1.0e-6, 1.0e23, 0.14, 1.2e6),       # Case 1\n        (300.0, 0.7, 0.5, 1.0e-3, 1.0e21, 0.05, 1.2e6),        # Case 2\n        (300.0, 0.7, 0.0, 1.0e-6, 1.0e23, 0.14, 1.2e6),       # Case 3\n        (300.0, 0.9, 1.0, 1.0e-4, 1.0e21, 0.05, 1.2e6),        # Case 4\n        (500.0, 0.6, 0.2, 1.0e-4, 5.0e21, 0.10, 1.2e6),        # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        T, phiB_eV, V_total, L, ND, mu, A_R = case\n        J_te_pure = pure_TE_current_density(T, phiB_eV, V_total, A_R)\n        J_dd = self_consistent_dd_current_density(T, phiB_eV, V_total, L, ND, mu, A_R)\n        if J_te_pure != 0.0:\n            deviation = (J_dd - J_te_pure) / J_te_pure\n        else:\n            deviation = 0.0\n        results.extend([J_te_pure, J_dd, deviation])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# The function call is commented out to prevent execution in a non-interactive environment,\n# but it is included to show the complete script.\n# solve()\n```",
            "answer": "[430.7303352796116,428.8419614488358,-0.004384078893926588,46781295.69894396,3.99283738096752,-0.9999999146522342,0.0,0.0,0.0,5.109152391216551e+12,79.9489240361245,-0.999999984351676,27814030.12643534,159.93245464195758,-0.9999942510344558]"
        }
    ]
}