{"hands_on_practices": [{"introduction": "The relationship between a time-varying orientation, represented by a quaternion $q(t)$, and the instantaneous angular velocity $\\vec{\\omega}$ is a cornerstone of rigid body kinematics. This first practice problem challenges you to work from a given orientation history to deduce the body-frame angular velocity that produced it, a crucial skill for analyzing motion data from simulations or real-world sensors. [@problem_id:2031381]", "problem": "A small satellite is executing a pre-programmed attitude maneuver. Its orientation in space, relative to a fixed inertial reference frame, is described by a time-dependent unit quaternion $q(t) = q_s(t) + q_1(t)\\mathbf{i} + q_2(t)\\mathbf{j} + q_3(t)\\mathbf{k}$. A unit quaternion is a mathematical object used to represent rotations where $q_s$ is the scalar part, $(q_1, q_2, q_3)$ is the vector part, and the components satisfy the condition $q_s(t)^2 + q_1(t)^2 + q_2(t)^2 + q_3(t)^2 = 1$.\n\nThe components of the satellite's orientation quaternion are given by the following functions of time $t$ (in seconds):\n$$q_s(t) = \\cos\\left(\\frac{\\beta t^2}{2}\\right)\\cos\\left(\\frac{\\alpha t}{2}\\right)$$\n$$q_1(t) = \\cos\\left(\\frac{\\beta t^2}{2}\\right)\\sin\\left(\\frac{\\alpha t}{2}\\right)$$\n$$q_2(t) = \\sin\\left(\\frac{\\beta t^2}{2}\\right)\\sin\\left(\\frac{\\alpha t}{2}\\right)$$\n$$q_3(t) = \\sin\\left(\\frac{\\beta t^2}{2}\\right)\\cos\\left(\\frac{\\alpha t}{2}\\right)$$\nThe maneuver is defined by the constants $\\alpha = 0.50 \\text{ rad/s}$ and $\\beta = 0.10 \\text{ rad/s}^2$.\n\nDetermine the three components $(\\omega_x, \\omega_y, \\omega_z)$ of the satellite's angular velocity vector $\\vec{\\omega}_B$ as measured in its own body-fixed reference frame at the instant $t = 2.0$ s.\n\nExpress your answer as the numerical values of the three components, in the specified order $(\\omega_x, \\omega_y, \\omega_z)$. All components must be in units of rad/s. Round your final answers to three significant figures.", "solution": "Let $q(t) = [q_{s}(t), q_{1}(t), q_{2}(t), q_{3}(t)]$ be a unit quaternion with scalar part $q_{s}$ and vector part $q_{v} = (q_{1}, q_{2}, q_{3})$. Using the standard quaternion kinematics for body angular velocity, the relation is\n$$\n\\dot{q} = \\frac{1}{2}\\, q \\otimes [0,\\vec{\\omega}_{B}],\n$$\nso that\n$$\n\\vec{\\omega}_{B} = 2\\,\\text{vec}\\!\\left(q^{*} \\otimes \\dot{q}\\right),\n$$\nwhere $q^{*}$ is the quaternion conjugate of $q$ and $\\text{vec}(\\cdot)$ extracts the vector part.\n\nIntroduce the shorthand\n$$\nA(t) = \\frac{\\alpha t}{2}, \\quad B(t) = \\frac{\\beta t^{2}}{2}, \\quad A' = \\frac{\\alpha}{2}, \\quad B' = \\beta t,\n$$\nand define $cA = \\cos A$, $sA = \\sin A$, $cB = \\cos B$, $sB = \\sin B$. The given quaternion components are\n$$\nq_{s} = cB\\,cA,\\quad q_{1} = cB\\,sA,\\quad q_{2} = sB\\,sA,\\quad q_{3} = sB\\,cA.\n$$\nThis quaternion factors as a product of two elementary rotations:\n$$\nq(t) = q_{B}(t) \\otimes q_{A}(t), \\quad q_{A} = [\\cos A,\\, \\sin A\\,\\mathbf{i}], \\quad q_{B} = [\\cos B,\\, \\sin B\\,\\mathbf{k}],\n$$\nwhich one verifies by direct quaternion multiplication. Here $q_{A}$ is a rotation by angle $2A = \\alpha t$ about the body $x$-axis (right factor), and $q_{B}$ is a rotation by angle $2B = \\beta t^{2}$ about the inertial $z$-axis (left factor).\n\nDifferentiate the product:\n$$\n\\dot{q} = \\dot{q}_{B} \\otimes q_{A} + q_{B} \\otimes \\dot{q}_{A}.\n$$\nUsing the kinematic relations for each factor,\n$$\n\\dot{q}_{A} = \\frac{1}{2}\\,q_{A}\\otimes[0,\\alpha\\,\\mathbf{e}_{x}], \\qquad\n\\dot{q}_{B} = \\frac{1}{2}\\,[0, 2\\beta t\\,\\mathbf{e}_{z}]\\otimes q_{B},\n$$\nwe obtain\n$$\n\\dot{q} = \\frac{1}{2}\\,[0, 2\\beta t\\,\\mathbf{e}_{z}]\\otimes q + \\frac{1}{2}\\,q\\otimes[0,\\alpha\\,\\mathbf{e}_{x}].\n$$\nFor any unit quaternion $q$ and inertial vector $\\mathbf{v}_{I}$, the identity\n$$\n[0,\\mathbf{v}_{I}] \\otimes q = q \\otimes [0, R(q)^{T}\\mathbf{v}_{I}]\n$$\nholds, where $R(q)$ maps body to inertial vectors. Applying this to the first term gives\n$$\n\\dot{q} = \\frac{1}{2}\\,q\\otimes\\big[0,\\; \\alpha\\,\\mathbf{e}_{x} + 2\\beta t\\,R(q)^{T}\\mathbf{e}_{z}\\big].\n$$\nComparing with $\\dot{q} = \\frac{1}{2} q \\otimes [0,\\vec{\\omega}_{B}]$ yields\n$$\n\\vec{\\omega}_{B} = \\alpha\\,\\mathbf{e}_{x} + 2\\beta t\\,R(q)^{T}\\mathbf{e}_{z}.\n$$\n\nCompute $R(q)^{T}\\mathbf{e}_{z}$ from $q$. For a unit quaternion $q = [q_{0},q_{1},q_{2},q_{3}]$ mapping body to inertial, the inertial $z$-axis expressed in body coordinates is the third column of $R(q)^{T}$, i.e.,\n$$\nR(q)^{T}\\mathbf{e}_{z} =\n\\begin{pmatrix}\n2(q_{1}q_{3} - q_{0}q_{2}) \\\\\n2(q_{2}q_{3} + q_{0}q_{1}) \\\\\n1 - 2(q_{1}^{2} + q_{2}^{2})\n\\end{pmatrix}.\n$$\nSubstitute $q_{0}=cB cA$, $q_{1}=cB sA$, $q_{2}=sB sA$, $q_{3}=sB cA$ to get\n$$\n2(q_{1}q_{3} - q_{0}q_{2}) = 2 cB sB (sA cA - cA sA) = 0,\n$$\n$$\n2(q_{2}q_{3} + q_{0}q_{1}) = 2(sB^{2} sA cA + cB^{2} cA sA) = 2 sA cA = \\sin(2A),\n$$\n$$\n1 - 2(q_{1}^{2} + q_{2}^{2}) = 1 - 2 sA^{2}(cB^{2} + sB^{2}) = 1 - 2 sA^{2} = \\cos(2A).\n$$\nHence\n$$\nR(q)^{T}\\mathbf{e}_{z} =\n\\begin{pmatrix}\n0 \\\\\n\\sin(2A) \\\\\n\\cos(2A)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n\\sin(\\alpha t) \\\\\n\\cos(\\alpha t)\n\\end{pmatrix}.\n$$\nTherefore, the body angular velocity components are\n$$\n\\vec{\\omega}_{B}(t) =\n\\begin{pmatrix}\n\\omega_{x} \\\\\n\\omega_{y} \\\\\n\\omega_{z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\alpha \\\\\n2\\beta t\\,\\sin(\\alpha t) \\\\\n2\\beta t\\,\\cos(\\alpha t)\n\\end{pmatrix}.\n$$\n\nAt $t = 2.0$ s with $\\alpha = 0.50$ and $\\beta = 0.10$,\n$$\n\\alpha t = 1.0,\\quad 2\\beta t = 0.40,\n$$\nso\n$$\n\\omega_{x} = 0.50,\\quad \\omega_{y} = 0.40\\,\\sin(1.0) \\approx 0.337,\\quad \\omega_{z} = 0.40\\,\\cos(1.0) \\approx 0.216,\n$$\nall in rad/s, rounded to three significant figures.", "answer": "$$\\boxed{\\begin{pmatrix} 0.500  0.337  0.216 \\end{pmatrix}}$$", "id": "2031381"}, {"introduction": "Beyond analyzing motion, quaternions are a powerful tool for planning and control, allowing us to define smooth and efficient orientation trajectories. In this exercise, you will tackle an inverse dynamics problem: given a desired reorientation path defined by Spherical Linear Interpolation (SLERP), you must calculate the precise time-varying torque needed to make a spacecraft follow it, connecting kinematic goals to dynamic reality. [@problem_id:2031398]", "problem": "A spacecraft, modeled as a rigid body, is being reoriented by its attitude control system. In its body-fixed frame, aligned with the principal axes $(\\hat{e}_1, \\hat{e}_2, \\hat{e}_3)$, the principal moments of inertia are $I_1 = I_0$, $I_2 = 2I_0$, and $I_3 = 3I_0$ for some constant $I_0$.\n\nThe orientation of the spacecraft is represented by a unit quaternion $q = w + x\\mathbf{i} + y\\mathbf{j} + z\\mathbf{k}$. The reorientation maneuver takes a total time $T$. The initial orientation at $t=0$ is given by the identity quaternion, $q_0 = 1$. The target orientation at $t=T$ is $q_f = \\frac{1}{\\sqrt{2}} + \\frac{1}{2}\\mathbf{i} + \\frac{1}{2}\\mathbf{j}$.\n\nThe orientation path $q(t)$ is prescribed to follow a specific type of Spherical Linear Interpolation (SLERP) defined by the formula:\n$$\nq(t) = q_0 \\left(q_0^{-1} q_f\\right)^{t/T}\n$$\nfor $t \\in [0, T]$.\n\nDetermine the time-varying torque vector $\\vec{\\tau}(t) = (\\tau_1, \\tau_2, \\tau_3)$ that must be applied by the control system to enforce this motion. The torque should be expressed in the spacecraft's body frame. Your answer should be a vector expression in terms of the constants $I_0$ and $T$.", "solution": "We use quaternion kinematics and rigid-body dynamics in the body frame. The prescribed SLERP is\n$$\nq(t) = q_{0} \\left(q_{0}^{-1} q_{f}\\right)^{t/T}.\n$$\nWith $q_{0}=1$, this becomes\n$$\nq(t) = \\left(q_{f}\\right)^{t/T} = \\exp\\!\\left(\\frac{t}{T}\\,\\ln q_{f}\\right).\n$$\nFor unit quaternions, the kinematic relation in the body frame is\n$$\n\\dot{q} = \\frac{1}{2}\\,q \\otimes (0,\\boldsymbol{\\omega}),\n$$\nwhere $\\boldsymbol{\\omega}$ is the angular velocity expressed in the body frame and $(0,\\boldsymbol{\\omega})$ is the corresponding pure imaginary quaternion. Differentiating $q(t)$ gives\n$$\n\\dot{q}(t) = \\frac{1}{T}\\,q(t)\\otimes \\ln q_{f}.\n$$\nIdentifying with the kinematic equation, we obtain\n$$\n(0,\\boldsymbol{\\omega}) = \\frac{2}{T}\\,\\ln q_{f},\n$$\nso $\\boldsymbol{\\omega}$ is constant in time and equals\n$$\n\\boldsymbol{\\omega} = \\frac{2}{T}\\,\\mathrm{vect}\\!\\left(\\ln q_{f}\\right).\n$$\n\nNext, compute $\\ln q_{f}$. Write $q_{f} = w + \\mathbf{v}$ with $w=\\frac{1}{\\sqrt{2}}$ and $\\mathbf{v}=\\left(\\frac{1}{2},\\frac{1}{2},0\\right)$. For a unit quaternion, $w=\\cos(\\theta/2)$, $|\\mathbf{v}|=\\sin(\\theta/2)$, axis $\\hat{\\mathbf{u}}=\\mathbf{v}/|\\mathbf{v}|$, and\n$$\n\\ln q_{f} = \\left(0,\\hat{\\mathbf{u}}\\,\\frac{\\theta}{2}\\right).\n$$\nHere $|\\mathbf{v}|=\\sqrt{\\frac{1}{2}}=\\frac{1}{\\sqrt{2}}$ and $w=\\frac{1}{\\sqrt{2}}$, hence $\\theta = 2 \\operatorname{atan2}(|\\mathbf{v}|,w) = \\frac{\\pi}{2}$ and\n$$\n\\hat{\\mathbf{u}} = \\frac{\\left(\\frac{1}{2},\\frac{1}{2},0\\right)}{\\frac{1}{\\sqrt{2}}} = \\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}},0\\right).\n$$\nTherefore\n$$\n\\ln q_{f} = \\left(0,\\hat{\\mathbf{u}}\\,\\frac{\\theta}{2}\\right) = \\left(0,\\frac{\\pi}{4}\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}},0\\right)\\right).\n$$\nIt follows that the constant body angular velocity is\n$$\n\\boldsymbol{\\omega} = \\frac{2}{T}\\,\\mathrm{vect}\\!\\left(\\ln q_{f}\\right) = \\frac{\\pi}{2T}\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}},0\\right) = \\left(\\frac{\\pi}{2\\sqrt{2}\\,T},\\frac{\\pi}{2\\sqrt{2}\\,T},0\\right).\n$$\n\nIn the body frame aligned with principal axes, the rigid-body dynamics are\n$$\n\\boldsymbol{\\tau} = \\mathbf{I}\\,\\dot{\\boldsymbol{\\omega}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\,\\boldsymbol{\\omega}),\n$$\nwith $\\mathbf{I}=\\mathrm{diag}(I_{1},I_{2},I_{3})=\\mathrm{diag}(I_{0},2I_{0},3I_{0})$. Since $\\boldsymbol{\\omega}$ is constant, $\\dot{\\boldsymbol{\\omega}}=\\mathbf{0}$ and\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{\\omega} \\times (\\mathbf{I}\\,\\boldsymbol{\\omega}).\n$$\nLet $a \\equiv \\frac{\\pi}{2\\sqrt{2}\\,T}$. Then $\\boldsymbol{\\omega}=(a,a,0)$ and\n$$\n\\mathbf{I}\\,\\boldsymbol{\\omega} = (I_{0}a,\\,2I_{0}a,\\,0).\n$$\nHence\n$$\n\\boldsymbol{\\tau} = (a,a,0) \\times (I_{0}a,2I_{0}a,0) = \\left(0,\\,0,\\,a\\cdot 2I_{0}a - a\\cdot I_{0}a\\right) = \\left(0,0,I_{0}a^{2}\\right).\n$$\nSubstituting $a^{2} = \\left(\\frac{\\pi}{2\\sqrt{2}\\,T}\\right)^{2} = \\frac{\\pi^{2}}{8T^{2}}$ gives the constant torque vector in the body frame:\n$$\n\\boldsymbol{\\tau}(t) = \\left(0,\\,0,\\,\\frac{I_{0}\\pi^{2}}{8T^{2}}\\right).\n$$\nThis torque is time-invariant and aligned with $\\hat{e}_{3}$, providing the required gyroscopic moment to maintain the constant body-rate SLERP motion.", "answer": "$$\\boxed{\\begin{pmatrix}0  0  \\frac{I_{0}\\pi^{2}}{8T^{2}}\\end{pmatrix}}$$", "id": "2031398"}, {"introduction": "A fundamental challenge in astronautics and robotics is attitude determination: figuring out an object's orientation from sensor measurements. This final practice puts you in the role of an attitude determination algorithm designer, tasking you with finding the optimal orientation quaternion that best aligns measured star directions with their known positions in a celestial catalog by minimizing a cost function. [@problem_id:2031402]", "problem": "A spacecraft's attitude determination system is tasked with finding its orientation in space. The system uses a star tracker to measure the directions to known stars in its own body-fixed coordinate frame. These measurements are then compared to the known directions of the same stars in a celestial reference frame.\n\nThe orientation of the spacecraft's body frame relative to the reference frame can be described by a rotation matrix, $\\mathbf{R}$, which transforms a vector from the reference frame to the body frame: $\\mathbf{v}_{\\text{body}} = \\mathbf{R} \\mathbf{v}_{\\text{ref}}$. This rotation is parameterized by a unit quaternion $\\mathbf{q} = [q_x, q_y, q_z, q_w]^T$, where $[q_x, q_y, q_z]^T$ is the vector part and $q_w$ is the scalar part. The quaternion is constrained to be normalized ($\\mathbf{q}^T\\mathbf{q} = 1$) and to have a non-negative scalar part ($q_w \\ge 0$).\n\nThe system has made observations of two stars. In the celestial reference frame, the stars' direction vectors are:\n$$\n\\mathbf{r}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{r}_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nIn the spacecraft's body frame, the measured direction vectors for these same stars are:\n$$\n\\mathbf{b}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{b}_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nThe optimal orientation is the one that minimizes the following cost function, which represents the weighted sum of squared errors between the predicted and measured vectors:\n$$\nL(\\mathbf{q}) = \\frac{1}{2} \\sum_{i=1}^{2} w_i \\|\\mathbf{b}_i - \\mathbf{R}(\\mathbf{q})\\mathbf{r}_i\\|^2\n$$\nFor this system, the weights for both star observations are equal, with $w_1 = 1.0$ and $w_2 = 1.0$.\n\nDetermine the four numerical components $(q_x, q_y, q_z, q_w)$ of the optimal orientation quaternion $\\mathbf{q}$. Round your final answers for each component to five significant figures.", "solution": "We seek the rotation $\\mathbf{R}$ that maps the known reference directions $\\mathbf{r}_{i}$ to the measured body directions $\\mathbf{b}_{i}$ and minimizes\n$$\nL(\\mathbf{q}) = \\frac{1}{2}\\sum_{i=1}^{2} w_{i}\\|\\mathbf{b}_{i} - \\mathbf{R}(\\mathbf{q})\\mathbf{r}_{i}\\|^{2}, \\quad w_{1}=w_{2}=1.\n$$\nBecause the data are noise-free and consistent with a proper rotation, the minimum is achieved when $\\mathbf{R}\\mathbf{r}_{i}=\\mathbf{b}_{i}$ for both $i=1,2$, which yields $L(\\mathbf{q})=0$, the global minimum under the unit-quaternion constraint.\n\nLet $\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}$ denote the standard basis. The constraints are\n$$\n\\mathbf{R}\\mathbf{e}_{1}=\\mathbf{b}_{1}=\\mathbf{e}_{1}, \\quad \\mathbf{R}\\mathbf{e}_{2}=\\mathbf{b}_{2}=\\mathbf{e}_{3}.\n$$\nFor a proper rotation, the columns of $\\mathbf{R}$ are orthonormal with right-handed orientation, hence the third column must satisfy\n$$\n\\mathbf{R}\\mathbf{e}_{3} = (\\mathbf{R}\\mathbf{e}_{1}) \\times (\\mathbf{R}\\mathbf{e}_{2}) = \\mathbf{e}_{1} \\times \\mathbf{e}_{3} = -\\mathbf{e}_{2}.\n$$\nTherefore\n$$\n\\mathbf{R} = \\begin{pmatrix}\n1  0  0 \\\\\n0  0  -1 \\\\\n0  1  0\n\\end{pmatrix}.\n$$\nThis matrix equals the standard rotation about the $x$-axis by angle $\\theta$, with\n$$\n\\mathbf{R}_{x}(\\theta) = \\begin{pmatrix}\n1  0  0 \\\\\n0  \\cos\\theta  -\\sin\\theta \\\\\n0  \\sin\\theta  \\cos\\theta\n\\end{pmatrix},\n$$\nso by comparison $\\cos\\theta=0$ and $\\sin\\theta=1$, giving $\\theta=\\frac{\\pi}{2}$.\n\nA unit quaternion representing a rotation by angle $\\theta$ about a unit axis $\\mathbf{u}=(u_{x},u_{y},u_{z})^{T}$ is\n$$\n\\mathbf{q} = \\begin{pmatrix}\nu_{x}\\sin\\!\\left(\\frac{\\theta}{2}\\right) \\\\\nu_{y}\\sin\\!\\left(\\frac{\\theta}{2}\\right) \\\\\nu_{z}\\sin\\!\\left(\\frac{\\theta}{2}\\right) \\\\\n\\cos\\!\\left(\\frac{\\theta}{2}\\right)\n\\end{pmatrix},\n$$\nwhich is normalized and has scalar part $q_{w}=\\cos(\\theta/2)$. Here $\\mathbf{u}=\\mathbf{e}_{1}$ and $\\theta=\\frac{\\pi}{2}$, so\n$$\n\\mathbf{q} = \\begin{pmatrix}\n\\sin\\!\\left(\\frac{\\pi}{4}\\right) \\\\\n0 \\\\\n0 \\\\\n\\cos\\!\\left(\\frac{\\pi}{4}\\right)\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{\\sqrt{2}}{2} \\\\\n0 \\\\\n0 \\\\\n\\frac{\\sqrt{2}}{2}\n\\end{pmatrix},\n$$\nwhich satisfies $q_{w}\\ge 0$. Rounding each component to five significant figures gives\n$$\n(q_{x},q_{y},q_{z},q_{w}) = (0.70711, 0, 0, 0.70711).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.70711  0  0  0.70711\\end{pmatrix}}$$", "id": "2031402"}]}