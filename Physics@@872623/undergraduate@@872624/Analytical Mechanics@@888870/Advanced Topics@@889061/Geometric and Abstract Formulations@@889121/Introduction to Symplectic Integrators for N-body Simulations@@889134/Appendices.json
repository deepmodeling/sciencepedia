{"hands_on_practices": [{"introduction": "The defining feature of a symplectic integrator is its ability to preserve the geometric structure of phase space. This exercise provides a direct and tangible demonstration of this principle by tracking the evolution of a small area in phase space under two different algorithms [@problem_id:2060446]. By comparing a non-symplectic method with a symplectic one, you will see how one distorts this area while the other preserves it, revealing the very essence of why symplectic methods excel in long-term simulations.", "problem": "A fundamental concept in the numerical simulation of Hamiltonian systems is the preservation of phase-space volume, a property known as symplecticity. This problem explores the difference between a non-symplectic and a symplectic integrator by examining how they transform an area element in phase space.\n\nConsider a one-dimensional harmonic oscillator whose dynamics are governed by the dimensionless Hamiltonian $H(q, p) = \\frac{1}{2}(p^2 + q^2)$, where $q$ is the position and $p$ is the momentum. The corresponding equations of motion are $\\dot{q} = p$ and $\\dot{p} = -q$.\n\nWe will analyze the evolution of the system using two different numerical integration schemes with a fixed time step $\\Delta t$.\n\n**Method 1 (Forward Euler):**\nThe state $(q_{n+1}, p_{n+1})$ at time step $n+1$ is calculated from the state $(q_n, p_n)$ at step $n$ using the forward Euler method:\n$$q_{n+1} = q_n + \\Delta t \\cdot p_n$$\n$$p_{n+1} = p_n - \\Delta t \\cdot q_n$$\n\n**Method 2 (Symplectic Euler A):**\nThe state is updated using a semi-implicit or symplectic Euler scheme as follows:\n$$p_{n+1} = p_n - \\Delta t \\cdot q_n$$\n$$q_{n+1} = q_n + \\Delta t \\cdot p_{n+1}$$\n\nAn initial, small square patch in phase space is defined by its four vertices centered at $(q_c, p_c) = (1.2, 0.5)$. The vertices are located at $(1.2 \\pm 0.01, 0.5 \\pm 0.01)$.\n\nApply a single time step of size $\\Delta t = 0.15$ to these four vertices using both Method 1 and Method 2. This transforms the initial square into two different parallelograms. Let $A_{FE}$ be the area of the parallelogram resulting from Method 1, and $A_{SEA}$ be the area of the parallelogram resulting from Method 2.\n\nCalculate the ratio $\\frac{A_{FE}}{A_{SEA}}$. Provide your answer as a number rounded to four significant figures.", "solution": "We consider the linear maps induced by one time step of each method. For a linear update $(q_{n+1},p_{n+1})^{T} = M (q_{n},p_{n})^{T}$, the area of any small patch is multiplied by $|\\det M|$. Since the harmonic oscillator and both integrators here are linear in $(q,p)$, the Jacobian is constant across the phase plane, so the area scaling is the same for the entire patch, independent of its center and size.\n\nLet $h=\\Delta t$.\n\nMethod 1 (Forward Euler): The update is\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix}.\n$$\nThus $M_{FE}=\\begin{pmatrix}1 & h\\\\ -h & 1\\end{pmatrix}$ and\n$$\n\\det M_{FE} = 1\\cdot 1 - (h)(-h) = 1 + h^{2}.\n$$\nTherefore the area scales as $A_{FE} = (1+h^{2})A_{0}$, where $A_{0}$ is the initial squareâ€™s area.\n\nMethod 2 (Symplectic Euler A): The update is\n$p_{n+1}=p_{n}-h q_{n}$, so $q_{n+1}=q_{n}+h p_{n+1}=q_{n}+h p_{n}-h^{2} q_{n}=(1-h^{2})q_{n}+h p_{n}$.\nHence\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1-h^{2} & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix},\n$$\nso $M_{SEA}=\\begin{pmatrix}1-h^{2} & h\\\\ -h & 1\\end{pmatrix}$ and\n$$\n\\det M_{SEA}=(1-h^{2})\\cdot 1 - h(-h) = 1-h^{2}+h^{2}=1.\n$$\nTherefore $A_{SEA}=A_{0}$.\n\nThe requested ratio is\n$$\n\\frac{A_{FE}}{A_{SEA}}=\\frac{(1+h^{2})A_{0}}{A_{0}}=1+h^{2}.\n$$\nWith $h=\\Delta t=0.15$, we obtain\n$$\n\\frac{A_{FE}}{A_{SEA}}=1+0.15^{2}=1.0225.\n$$\nRounded to four significant figures, this is $1.023$.", "answer": "$$\\boxed{1.023}$$", "id": "2060446"}, {"introduction": "Moving from theory to practice, we now apply one of the most popular symplectic algorithms: the position Verlet method. This integrator is a workhorse in computational physics, valued for its accuracy, stability, and simplicity [@problem_id:2060480]. By manually performing several integration steps for a particle in a non-linear potential, you will gain hands-on experience with the update sequence and can observe its excellent energy conservation properties firsthand.", "problem": "A point particle of mass $m=1.0~\\text{kg}$ moves in one dimension under the influence of a conservative force. The potential energy of the particle is given by the function $V(q) = \\frac{k}{4}q^4$, where $q$ is the position in meters and the constant $k = 1.0~\\text{N/m}^3$. The motion of this particle is to be approximated using a numerical integration method.\n\nWe will employ the position Verlet integration algorithm. For a given time step $\\Delta t$, the state of the particle $(q_n, v_n)$ at time $t_n = n\\Delta t$ is updated to the state $(q_{n+1}, v_{n+1})$ at time $t_{n+1}$ using the following sequence of operations:\n1.  Calculate the new position $q_{n+1}$: $q_{n+1} = q_n + v_n \\Delta t + \\frac{1}{2} a_n (\\Delta t)^2$.\n2.  Calculate the new acceleration $a_{n+1}$ using the new position: $a_{n+1} = F(q_{n+1})/m$.\n3.  Calculate the new velocity $v_{n+1}$: $v_{n+1} = v_n + \\frac{1}{2} (a_n + a_{n+1}) \\Delta t$.\n\nIn these equations, $a_n$ is the acceleration at time $t_n$, and $F(q)$ is the force corresponding to the potential $V(q)$.\n\nThe particle is initially at rest ($v_0 = 0.0~\\text{m/s}$) at position $q_0 = 1.0~\\text{m}$ at time $t_0=0$. Using a time step of $\\Delta t=0.5~\\text{s}$, perform two full integration steps to find the particle's approximate position $q_2$ and velocity $v_2$ at time $t_2=1.0~\\text{s}$.\n\nFinally, calculate the total mechanical energy of the particle, $E_2 = \\frac{1}{2}mv_2^2 + V(q_2)$, at time $t_2$. Express your final answer for the energy $E_2$ in Joules, rounded to three significant figures.", "solution": "The conservative force is determined from the potential by $F(q)=-\\frac{dV}{dq}$. With $V(q)=\\frac{k}{4}q^{4}$ and $k=1$, we have\n$$\nF(q)=-q^{3},\\qquad a(q)=\\frac{F(q)}{m}=-q^{3}\\quad\\text{since }m=1.\n$$\nGiven $\\Delta t=\\frac{1}{2}$, the position Verlet updates are\n$$\nq_{n+1}=q_{n}+v_{n}\\Delta t+\\frac{1}{2}a_{n}\\Delta t^{2},\\quad\na_{n+1}=-q_{n+1}^{3},\\quad\nv_{n+1}=v_{n}+\\frac{1}{2}\\left(a_{n}+a_{n+1}\\right)\\Delta t.\n$$\n\nStep from $n=0$ to $n=1$:\n- Initial data: $q_{0}=1$, $v_{0}=0$, $a_{0}=-q_{0}^{3}=-1$.\n- Position:\n$$\nq_{1}=q_{0}+v_{0}\\Delta t+\\frac{1}{2}a_{0}\\Delta t^{2}\n=1+0\\cdot\\frac{1}{2}+\\frac{1}{2}(-1)\\left(\\frac{1}{2}\\right)^{2}\n=1-\\frac{1}{8}=\\frac{7}{8}.\n$$\n- Acceleration:\n$$\na_{1}=-q_{1}^{3}=-\\left(\\frac{7}{8}\\right)^{3}=-\\frac{343}{512}.\n$$\n- Velocity:\n$$\nv_{1}=v_{0}+\\frac{1}{2}\\left(a_{0}+a_{1}\\right)\\Delta t\n=0+\\frac{1}{2}\\left(-1-\\frac{343}{512}\\right)\\cdot\\frac{1}{2}\n=-\\frac{855}{2048}.\n$$\n\nStep from $n=1$ to $n=2$:\n- Position:\n$$\nq_{2}=q_{1}+v_{1}\\Delta t+\\frac{1}{2}a_{1}\\Delta t^{2}\n=\\frac{7}{8}+\\left(-\\frac{855}{2048}\\right)\\frac{1}{2}+\\frac{1}{2}\\left(-\\frac{343}{512}\\right)\\left(\\frac{1}{2}\\right)^{2}\n=\\frac{1193}{2048}.\n$$\n- Acceleration:\n$$\na_{2}=-q_{2}^{3}=-\\left(\\frac{1193}{2048}\\right)^{3}=-\\frac{1,697,936,057}{8,589,934,592}.\n$$\n- Velocity:\n$$\nv_{2}=v_{1}+\\frac{1}{2}\\left(a_{1}+a_{2}\\right)\\Delta t\n=-\\frac{855}{2048}+\\frac{1}{2}\\left(-\\frac{343}{512}-\\frac{1,697,936,057}{8,589,934,592}\\right)\\cdot\\frac{1}{2}\n=-\\frac{21,797,040,825}{34,359,738,368}.\n$$\n\nTotal mechanical energy at $t_{2}$:\n$$\nE_{2}=\\frac{1}{2}mv_{2}^{2}+V(q_{2})\n=\\frac{1}{2}\\left(\\frac{21,797,040,825}{34,359,738,368}\\right)^{2}+\\frac{1}{4}\\left(\\frac{1193}{2048}\\right)^{4}.\n$$\nEvaluating numerically,\n$v_{2}\\approx -0.63437738063$, $q_{2}\\approx 0.58251953125$,\nso\n$$\n\\frac{1}{2}v_{2}^{2}\\approx 0.2012173305,\\qquad \\frac{1}{4}q_{2}^{4}\\approx 0.0287860433,\n$$\nhence\n$$\nE_{2}\\approx 0.2300033738\\ \\text{J}.\n$$\nRounded to three significant figures, $E_{2}=0.230~\\text{J}$.", "answer": "$$\\boxed{0.230}$$", "id": "2060480"}, {"introduction": "While symplectic integrators offer remarkable long-term stability, their use is not without limits; the numerical solution can still become unstable if the time step is too large. This practice explores the crucial concept of numerical stability by analyzing the behavior of the symplectic Euler method applied to a simple harmonic oscillator [@problem_id:2060479]. Determining the maximum allowable time step provides critical insight into the practical constraints of implementing any numerical integration scheme.", "problem": "Symplectic integrators are a class of numerical methods designed for solving Hamilton's equations of motion, which are particularly effective for long-term simulations of conservative systems such as those in celestial mechanics. Their primary advantage is the preservation of the symplectic structure of phase space, which leads to excellent long-term energy conservation properties.\n\nConsider a simple one-dimensional harmonic oscillator with position $q$ and constant angular frequency $\\omega$. Its equation of motion is given by:\n$$\n\\frac{d^2q}{dt^2} = -\\omega^2 q\n$$\nWe wish to solve this equation numerically using the symplectic Euler A algorithm. This method discretizes the system into time steps of size $\\Delta t > 0$. Given the state $(q_n, v_n)$ at time $t_n$, where $v_n = \\frac{dq}{dt}|_{t=t_n}$, the state at time $t_{n+1} = t_n + \\Delta t$ is computed using the following two steps:\n1.  Update velocity: $v_{n+1} = v_n - \\omega^2 q_n \\Delta t$\n2.  Update position: $q_{n+1} = q_n + v_{n+1} \\Delta t$\n\nA numerical integration scheme is considered stable if the computed quantities (in this case, position and velocity) remain bounded for all integration steps. This requirement places a constraint on the maximum allowed size of the time step $\\Delta t$.\n\nDetermine the maximum time step, $\\Delta t_{\\text{max}}$, as a function of $\\omega$, for which the symplectic Euler A method is stable when applied to the simple harmonic oscillator.", "solution": "We write the symplectic Euler A update in matrix form. From\n$v_{n+1} = v_n - \\omega^{2} q_n \\Delta t$ and $q_{n+1} = q_n + v_{n+1} \\Delta t$,\nwe substitute $v_{n+1}$ into the equation for $q_{n+1}$ to obtain\n$q_{n+1} = \\left(1 - \\omega^{2} \\Delta t^{2}\\right) q_n + \\Delta t\\, v_n$ and $v_{n+1} = -\\omega^{2} \\Delta t\\, q_n + v_n$.\nDefine the state vector $y_n = \\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}$. Then the one-step map is linear:\n$$\ny_{n+1} = M\\, y_n, \\quad M = \\begin{pmatrix} 1 - \\omega^{2} \\Delta t^{2} & \\Delta t \\\\ -\\omega^{2} \\Delta t & 1 \\end{pmatrix}.\n$$\nThe stability of the linear recurrence is determined by the eigenvalues of $M$. Compute the determinant and trace:\n$$\n\\det(M) = \\left(1 - \\omega^{2} \\Delta t^{2}\\right)\\cdot 1 - \\Delta t \\cdot \\left(-\\omega^{2} \\Delta t\\right) = 1, \\qquad \\operatorname{tr}(M) = \\left(1 - \\omega^{2} \\Delta t^{2}\\right) + 1 = 2 - \\omega^{2} \\Delta t^{2}.\n$$\nSince $\\det(M)=1$, the characteristic polynomial is\n$$\n\\lambda^{2} - \\operatorname{tr}(M)\\, \\lambda + 1 = 0.\n$$\nFor the iterates to remain bounded for all steps and all initial conditions, the eigenvalues must lie on the unit circle and the map must not be defective. For a $2 \\times 2$ real matrix with $\\det(M)=1$, this occurs precisely when $|\\operatorname{tr}(M)| < 2$, which ensures complex-conjugate eigenvalues of unit modulus. Using $\\operatorname{tr}(M) = 2 - \\omega^{2} \\Delta t^{2}$, the condition\n$$\n|\\operatorname{tr}(M)| < 2\n$$\nis equivalent to\n$$\n|2 - \\omega^{2} \\Delta t^{2}| < 2 \\quad \\Longleftrightarrow \\quad 0 < \\omega^{2} \\Delta t^{2} < 4.\n$$\nBecause $\\Delta t > 0$, this yields\n$$\n\\Delta t < \\frac{2}{\\omega}.\n$$\nThus the largest admissible time step ensuring stability is\n$$\n\\Delta t_{\\text{max}} = \\frac{2}{\\omega}.\n$$\nAt the endpoint $\\Delta t = \\frac{2}{\\omega}$, the trace equals $-2$, giving a repeated eigenvalue $-1$ and a defective matrix (not equal to $-I$), which leads to linear growth and hence loss of boundedness. Therefore the strict inequality is required, and the maximum allowable time step is $\\frac{2}{\\omega}$.", "answer": "$$\\boxed{\\frac{2}{\\omega}}$$", "id": "2060479"}]}