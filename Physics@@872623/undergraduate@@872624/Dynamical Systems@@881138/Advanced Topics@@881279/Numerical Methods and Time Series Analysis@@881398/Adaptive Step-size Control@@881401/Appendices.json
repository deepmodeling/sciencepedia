{"hands_on_practices": [{"introduction": "The heart of any adaptive step-size controller is the rule that governs how to change the step size based on the estimated error. This first exercise [@problem_id:1659045] tasks you with deriving this fundamental scaling law. By understanding how the local error relates to the step size $h$ and the method's order $p$, you can calculate the optimal next step size to precisely meet a desired accuracy tolerance.", "problem": "In the field of computational science, numerical methods are used to approximate solutions to Ordinary Differential Equations (ODEs). A crucial aspect of modern solvers is adaptive step-size control, which adjusts the integration step size, $h$, to maintain a desired level of accuracy while minimizing computational cost.\n\nConsider a numerical integration method of order $p$. The local truncation error, $\\epsilon$, incurred in a single step is known to be proportional to the step size raised to the power of $(p+1)$. This relationship can be expressed as $\\epsilon \\propto h^{p+1}$.\n\nAn engineer is using such a solver with a method of order $p=4$. The solver is configured with a constant target tolerance, $tol$, for the local error. After taking a step with size $h_{old}$, the error estimation module reports a local error of $\\epsilon_{old} = \\frac{1}{2} tol$. To prepare for the next integration step, the control algorithm must propose a new step size, $h_{new}$. The new step size is chosen such that the predicted error for the next step, $\\epsilon_{new}$, would be precisely equal to the target tolerance, $tol$.\n\nAssuming the proportionality constant relating the error to the step size does not change significantly between these two consecutive steps, determine the expression for the proposed new step size $h_{new}$ in terms of the old step size $h_{old}$.", "solution": "The local truncation error for a method of order $p$ satisfies $\\epsilon = C h^{p+1}$, where $C$ is an approximately constant proportionality factor between consecutive steps. For the old step,\n$$\n\\epsilon_{old} = C h_{old}^{p+1} = \\frac{1}{2} tol.\n$$\nFor the proposed new step, we require\n$$\n\\epsilon_{new} = C h_{new}^{p+1} = tol.\n$$\nTaking the ratio,\n$$\n\\frac{\\epsilon_{new}}{\\epsilon_{old}} = \\frac{C h_{new}^{p+1}}{C h_{old}^{p+1}} = \\left(\\frac{h_{new}}{h_{old}}\\right)^{p+1} = \\frac{tol}{\\frac{1}{2} tol} = 2.\n$$\nThus,\n$$\n\\left(\\frac{h_{new}}{h_{old}}\\right)^{p+1} = 2 \\quad \\Rightarrow \\quad \\frac{h_{new}}{h_{old}} = 2^{\\frac{1}{p+1}}.\n$$\nFor $p=4$, we obtain\n$$\nh_{new} = 2^{\\frac{1}{5}} h_{old}.\n$$", "answer": "$$\\boxed{2^{\\frac{1}{5}} h_{old}}$$", "id": "1659045"}, {"introduction": "An adaptive controller's behavior is more than just a means to an end; it is a rich source of information about the system's dynamics. When a solution behaves dramatically, such as approaching a finite-time singularity, the controller must react by drastically shrinking the step size. This practice [@problem_id:1659002] challenges you to predict this behavior analytically, demonstrating how the sequence of step sizes can act as a diagnostic tool to detect and characterize difficult parts of the solution trajectory.", "problem": "An engineer is using a numerical solver to simulate a specific chemical reaction. The concentration of a substance, denoted by $y(t)$, is governed by the ordinary differential equation:\n$$\n\\frac{dy}{dt} = A y^{n}\n$$\nwhere $t$ is time. For this particular reaction, the constant parameters are $A  0$ and $n=3$. The initial concentration at $t=0$ is $y(0) = y_0  0$. It is known that the solution $y(t)$ to this equation experiences a finite-time singularity, meaning it goes to infinity at a finite time $t_s  0$.\n\nThe numerical solver employs an adaptive step-size control strategy. It uses an integration method of order $p=4$. The core of the adaptive algorithm is to adjust the step size $h$ to maintain a nearly constant local truncation error, $\\epsilon$, for each step. The local truncation error for a single step is estimated by the formula:\n$$\n\\text{Err} \\approx C |y^{(p+1)}(t)| h^{p+1}\n$$\nwhere $y^{(p+1)}(t)$ is the $(p+1)$-th derivative of the exact solution with respect to time, and $C$ is a constant characteristic of the numerical method. The solver adjusts $h$ so that $\\text{Err} \\approx \\epsilon$.\n\nAs the simulation time $t$ approaches the singularity time $t_s$, the step size $h$ is observed to shrink following a power-law relationship with respect to the remaining time, $\\tau = t_s - t$. This relationship can be expressed as:\n$$\nh \\approx K \\tau^{\\beta}\n$$\nfor some constant $K$ and a scaling exponent $\\beta$, in the limit where $\\tau \\to 0$.\n\nDetermine the numerical value of the exponent $\\beta$.", "solution": "We start from the given ordinary differential equation with $n=3$:\n$$\n\\frac{dy}{dt} = A y^{3}, \\quad A0, \\quad y(0)=y_{0}0.\n$$\nSeparate variables and integrate:\n$$\n\\int y^{-3}\\,dy = \\int A\\,dt \\quad \\Longrightarrow \\quad -\\frac{1}{2} y^{-2} = A t + c.\n$$\nImpose $y(0)=y_{0}$ to find $c$:\n$$\n-\\frac{1}{2} y_{0}^{-2} = c \\quad \\Longrightarrow \\quad y^{-2}(t) = y_{0}^{-2} - 2 A t.\n$$\nThe blow-up (finite-time singularity) occurs at the time $t_{s}$ where $y^{-2}(t_{s})=0$, hence\n$$\nt_{s} = \\frac{y_{0}^{-2}}{2A}.\n$$\nDefine the remaining time $\\tau = t_{s}-t$. Near $t_{s}$ (i.e., as $\\tau \\to 0^{+}$),\n$$\ny^{-2}(t) = 2A \\tau \\quad \\Longrightarrow \\quad y(t) \\sim (2A)^{-\\frac{1}{2}} \\tau^{-\\frac{1}{2}}.\n$$\nThus, asymptotically, $y(t)$ behaves like $c \\tau^{-m}$ with $c=(2A)^{-\\frac{1}{2}}$ and $m=\\frac{1}{2}$. Derivatives with respect to $t$ can be related to derivatives with respect to $\\tau$ by $d/dt = - d/d\\tau$. For $k \\in \\mathbb{N}$,\n$$\n\\frac{d^{k}}{dt^{k}} y(t) = (-1)^{k} \\frac{d^{k}}{d\\tau^{k}} \\big(c \\tau^{-m}\\big) \\sim \\text{const} \\cdot \\tau^{-m-k},\n$$\nwhere the constant depends on $c$, $m$, and $k$, but the power of $\\tau$ is $-m-k$. Therefore, for a method of order $p=4$, we need the $(p+1)$-th derivative, i.e., $k=5$, and we obtain\n$$\n\\big|y^{(5)}(t)\\big| \\sim \\text{const} \\cdot \\tau^{-\\left(m+5\\right)} = \\text{const} \\cdot \\tau^{-\\frac{11}{2}}.\n$$\nThe adaptive step-size control uses the local truncation error model\n$$\n\\text{Err} \\approx C \\big|y^{(p+1)}(t)\\big| h^{p+1},\n$$\nand maintains $\\text{Err} \\approx \\epsilon$ with $p=4$, so\n$$\n\\epsilon \\approx C \\big|y^{(5)}(t)\\big| h^{5} \\quad \\Longrightarrow \\quad h^{5} \\approx \\frac{\\epsilon}{C \\big|y^{(5)}(t)\\big|}.\n$$\nUsing the asymptotic scaling $\\big|y^{(5)}(t)\\big| \\sim \\text{const} \\cdot \\tau^{-\\frac{11}{2}}$, we find\n$$\nh \\sim \\left(\\frac{\\epsilon}{C}\\right)^{\\frac{1}{5}} \\big(\\text{const}\\big)^{-\\frac{1}{5}} \\tau^{\\frac{11}{10}}.\n$$\nHence, in the relation $h \\approx K \\tau^{\\beta}$ as $\\tau \\to 0^{+}$, the exponent is\n$$\n\\beta = \\frac{11}{10}.\n$$", "answer": "$$\\boxed{\\frac{11}{10}}$$", "id": "1659002"}, {"introduction": "In many practical applications, especially for stiff systems, controlling accuracy is not the only concern; ensuring the numerical stability of the solver is equally crucial. This advanced exercise [@problem_id:1658994] places you in a realistic scenario where you must balance competing demands from an accuracy controller and a stability controller. You will learn to arbitrate between different step-size proposals to create a robust, composite controller that ensures both accuracy and computational efficiency.", "problem": "An engineer is simulating a stiff electro-mechanical system modeled by an index-1 Differential-Algebraic Equation (DAE). The simulation uses an implicit, first-order accurate time-stepping method. To ensure both stability and accuracy, a composite adaptive step-size controller is implemented. This controller must dynamically adjust the time step, $h$, based on two separate criteria: the estimated Local Truncation Error (LTE) of the differential variables and the convergence behavior of the nonlinear Newton-Raphson solver used for the algebraic constraints.\n\nAfter completing a time step of size $h_n = 0.01$ s, the controller has the following information:\n1.  **LTE-based control**: The goal is to keep the norm of the LTE below a tolerance of $\\text{TOL}_{y} = 1.0 \\times 10^{-6}$. The estimated LTE for the step just completed was $\\|\\tau_{n+1}\\| = 5.0 \\times 10^{-5}$. The proposed next step size from this controller, $h_{\\text{new, LTE}}$, is calculated using the formula:\n    $$h_{\\text{new, LTE}} = \\rho \\cdot h_n \\left( \\frac{\\text{TOL}_{y}}{\\|\\tau_{n+1}\\|} \\right)^{1/(p+1)}$$\n    where $p=1$ is the order of the time-stepping method and $\\rho = 0.9$ is a safety factor.\n\n2.  **Newton-convergence-based control**: The Newton-Raphson solver is expected to converge in a target number of iterations, $k_{\\text{target}} = 3$. However, for the step just completed, it required $k_{\\text{actual}} = 8$ iterations. The proposed next step size from this controller, $h_{\\text{new, Newton}}$, is calculated using the formula:\n    $$h_{\\text{new, Newton}} = h_n \\left( \\frac{k_{\\text{target}}}{k_{\\text{actual}}} \\right)^{\\gamma}$$\n    where $\\gamma = 0.5$ is a control gain.\n\nThe final step size, $h_{n+1}$, is determined by a conservative arbitration rule. First, it takes the minimum of the two proposals. Second, to prevent overly aggressive increases, the step size is not allowed to grow by more than a factor of $h_{\\text{max\\_growth}} = 1.5$ from one step to the next. The complete rule is:\n$$h_{n+1} = \\min(h_{\\text{new, LTE}}, h_{\\text{new, Newton}}, h_{\\text{max\\_growth}} \\cdot h_n)$$\n\nCalculate the new time step $h_{n+1}$ that the controller will select. Express your answer in seconds, rounded to three significant figures.", "solution": "We use the given adaptive control rules for a first-order implicit method with $p=1$.\n\nFor LTE-based control, with $\\text{TOL}_{y}=1.0\\times 10^{-6}$, $\\|\\tau_{n+1}\\|=5.0\\times 10^{-5}$, $\\rho=0.9$, and $h_{n}=0.01$, the proposal is\n$$\nh_{\\text{new, LTE}}=\\rho\\, h_{n}\\left(\\frac{\\text{TOL}_{y}}{\\|\\tau_{n+1}\\|}\\right)^{\\frac{1}{p+1}}\n=0.9\\cdot 0.01\\left(\\frac{1.0\\times 10^{-6}}{5.0\\times 10^{-5}}\\right)^{\\frac{1}{2}}.\n$$\nCompute the ratio $\\frac{1.0\\times 10^{-6}}{5.0\\times 10^{-5}}=2.0\\times 10^{-2}$, hence\n$$\nh_{\\text{new, LTE}}=0.9\\cdot 0.01\\cdot \\sqrt{2.0\\times 10^{-2}}=0.9\\cdot 0.01\\cdot 0.141421356\\approx 0.001272792.\n$$\n\nFor Newton-convergence-based control, with $k_{\\text{target}}=3$, $k_{\\text{actual}}=8$, $\\gamma=0.5$, and $h_{n}=0.01$, the proposal is\n$$\nh_{\\text{new, Newton}}=h_{n}\\left(\\frac{k_{\\text{target}}}{k_{\\text{actual}}}\\right)^{\\gamma}\n=0.01\\left(\\frac{3}{8}\\right)^{0.5}=0.01\\sqrt{0.375}\\approx 0.01\\cdot 0.612372435\\approx 0.006123724.\n$$\n\nThe growth limiter is\n$$\nh_{\\text{max\\_growth}}\\cdot h_{n}=1.5\\cdot 0.01=0.015.\n$$\n\nThe arbitration rule selects\n$$\nh_{n+1}=\\min\\left(h_{\\text{new, LTE}},\\, h_{\\text{new, Newton}},\\, h_{\\text{max\\_growth}}\\cdot h_{n}\\right)\n=\\min\\left(0.001272792,\\, 0.006123724,\\, 0.015\\right)=0.001272792.\n$$\n\nRounding to three significant figures gives $h_{n+1}=0.00127$ seconds.", "answer": "$$\\boxed{0.00127}$$", "id": "1658994"}]}