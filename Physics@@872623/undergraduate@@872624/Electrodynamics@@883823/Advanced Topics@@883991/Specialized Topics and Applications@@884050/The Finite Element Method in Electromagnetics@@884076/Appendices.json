{"hands_on_practices": [{"introduction": "The first step in any successful Finite Element Method (FEM) simulation is to correctly formulate the underlying physics as a partial differential equation. This exercise guides you through this crucial initial stage for a magnetostatics problem involving multiple materials. By correctly identifying the governing equations for the magnetic vector potential in different regions, you build the foundational understanding necessary before any discretization or computation can begin [@problem_id:1616428].", "problem": "An engineer is tasked with modeling the magnetic field distribution in a long electromagnetic actuator using the Finite Element Method (FEM). The actuator's cross-section in the $xy$-plane consists of three distinct regions: a central iron core ($\\Omega_{iron}$), a non-concentric cylindrical air gap within the core ($\\Omega_{air}$), and a copper coil region ($\\Omega_{coil}$) surrounding the core. The iron core is made of a soft magnetic material with a constant relative permeability $\\mu_r$, so its magnetic permeability is $\\mu_{iron} = \\mu_r \\mu_0$. The air gap and the copper coil region are assumed to have the permeability of free space, $\\mu_0$. The coil carries a steady, uniform Direct Current (DC) that creates an axial current density $\\mathbf{J} = J_z \\hat{k}$ within the region $\\Omega_{coil}$, and the current density is zero everywhere else.\n\nDue to the system's length, the problem can be treated as two-dimensional. The magnetic field is generated by the current $J_z$, and the appropriate potential to solve for is the $z$-component of the magnetic vector potential, $A_z(x, y)$. The entire actuator is computationally modeled inside a large bounding box, and on the outer boundary of this box, $\\Gamma_{box}$, the magnetic vector potential is assumed to be zero, i.e., $A_z = 0$.\n\nTo set up the simulation, the engineer must define the governing partial differential equation for $A_z$ in each of the three regions ($\\Omega_{iron}$, $\\Omega_{air}$, $\\Omega_{coil}$). Which of the following sets of equations correctly describes the physical problem to be solved by the FEM software?\n\nA. The problem is described by the Laplace equation in all regions:\n- In $\\Omega_{iron}$: $-\\nabla^2 A_z = 0$\n- In $\\Omega_{air}$: $-\\nabla^2 A_z = 0$\n- In $\\Omega_{coil}$: $-\\nabla^2 A_z = 0$\n\nB. The problem is described by a Poisson equation where the source term $J_z$ is present in all regions:\n- In $\\Omega_{iron}$: $-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = J_z$\n- In $\\Omega_{air}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n- In $\\Omega_{coil}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nC. The problem is described by a set of equations where the source term $J_z$ is non-zero only in the coil region:\n- In $\\Omega_{iron}$: $-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = 0$\n- In $\\Omega_{air}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = 0$\n- In $\\Omega_{coil}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nD. The problem is described by an incorrect formulation that improperly uses permeability instead of reluctivity:\n- In $\\Omega_{iron}$: $-\\nabla \\cdot (\\mu_{iron} \\nabla A_z) = 0$\n- In $\\Omega_{air}$: $-\\nabla \\cdot (\\mu_0 \\nabla A_z) = 0$\n- In $\\Omega_{coil}$: $-\\nabla \\cdot (\\mu_0 \\nabla A_z) = J_z$\n\nE. The problem is described by a single form of the Poisson equation, $-\\nabla^2 A_z = \\mu J_z$, applied to all regions:\n- In $\\Omega_{iron}$: $-\\nabla^2 A_z = \\mu_{iron} J_z$\n- In $\\Omega_{air}$: $-\\nabla^2 A_z = \\mu_0 J_z$\n- In $\\Omega_{coil}$: $-\\nabla^2 A_z = \\mu_0 J_z$", "solution": "We work in magnetostatics and use Maxwell’s equations with the magnetic vector potential. The governing equations are\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\mathbf{B} = \\mu \\mathbf{H}, \\quad \\mathbf{B} = \\nabla \\times \\mathbf{A}.\n$$\nChoosing the magnetic vector potential with only a nonzero axial component in a two-dimensional setting, we set $\\mathbf{A} = A_{z}(x,y)\\,\\hat{k}$. Then\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A} = \\left(\\frac{\\partial A_{z}}{\\partial y}\\right)\\hat{i} - \\left(\\frac{\\partial A_{z}}{\\partial x}\\right)\\hat{j} + 0\\,\\hat{k}.\n$$\nUsing the constitutive relation $\\mathbf{H} = \\frac{1}{\\mu}\\mathbf{B}$ (with scalar, piecewise constant $\\mu$), we have\n$$\nH_{x} = \\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}, \\quad H_{y} = -\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}.\n$$\nAmpere’s law gives the source equation for the $z$-component:\n$$\nJ_{z} = \\left(\\nabla \\times \\mathbf{H}\\right)_{z} = \\frac{\\partial H_{y}}{\\partial x} - \\frac{\\partial H_{x}}{\\partial y}.\n$$\nSubstituting $H_{x}$ and $H_{y}$,\n$$\nJ_{z} = \\frac{\\partial}{\\partial x}\\left(-\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right)\n= -\\frac{\\partial}{\\partial x}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right).\n$$\nThis is compactly written as\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu}\\nabla A_{z}\\right) = J_{z}.\n$$\nBoundary condition on the outer boundary is $A_{z} = 0$ on $\\Gamma_{box}$.\n\nThe material properties are piecewise constant:\n$$\n\\mu = \\mu_{iron} = \\mu_{r}\\mu_{0} \\text{ in } \\Omega_{iron}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{air}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{coil}.\n$$\nThe source current density is axial and confined to the coil:\n$$\nJ_{z} \\neq 0 \\text{ in } \\Omega_{coil}, \\quad J_{z} = 0 \\text{ in } \\Omega_{iron} \\cup \\Omega_{air}.\n$$\nTherefore, the governing PDE in each region is\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{iron}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{iron},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{air},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = J_{z} \\quad \\text{in } \\Omega_{coil}.\n$$\nThis matches option C. Option A omits the source in the coil. Option B incorrectly applies the source in all regions. Option D incorrectly uses $\\mu$ instead of $1/\\mu$ in the differential operator. Option E uses $-\\nabla^{2}A_{z}=\\mu J_{z}$; while equivalent within a single homogeneous region with constant $\\mu$, it is not the correct heterogeneous formulation needed across multiple regions with different $\\mu$, and it also misleadingly presents a source term in regions where $J_{z}=0$ must be enforced explicitly. Hence the correct formulation is option C.", "answer": "$$\\boxed{C}$$", "id": "1616428"}, {"introduction": "Once the governing equation is established, the core of the FEM lies in discretizing the domain and translating the continuous problem into a system of algebraic equations. This practice focuses on a key part of this process: assembling the global matrices from individual element contributions. You will calculate a specific entry in the global \"mass matrix\" for an eigenvalue problem, which is fundamental for finding the resonant frequencies of an electromagnetic cavity, gaining hands-on experience with the \"stitching\" process that defines the method [@problem_id:1616451].", "problem": "Consider a two-dimensional square metallic cavity with perfectly conducting walls. The cavity occupies the region $0 \\le x \\le L$ and $0 \\le y \\le L$. The cavity is partially filled with a uniform, isotropic, non-magnetic dielectric material. The region defined by $0 \\le y \\le x$ and $0 \\le x \\le L$ is filled with this dielectric, which has a relative permittivity of $\\epsilon_r$. The remaining region of the cavity, defined by $0 \\le x < y$ and $0 \\le y \\le L$, is a vacuum with relative permittivity of 1.\n\nWe are interested in calculating the Transverse Electric (TE) resonant modes of this cavity. For TE modes, the analysis can be simplified by solving for the longitudinal magnetic field component, $H_z(x,y)$, which satisfies the Helmholtz equation $\\nabla^2 H_z + \\omega^2 \\mu_0 \\epsilon(x,y) H_z = 0$, where $\\epsilon(x,y)$ is the position-dependent permittivity. The boundary conditions imposed by the perfectly conducting walls require the normal derivative of $H_z$ to be zero on all boundaries.\n\nTo find the resonant frequencies, we can use the Finite Element Method (FEM). This approach transforms the differential equation into a generalized matrix eigenvalue problem of the form $[S]\\{H\\} - k_0^2 [T]\\{H\\} = \\{0\\}$. Here, $\\{H\\}$ is a vector of the nodal values of $H_z$, $k_0^2 = \\omega^2 \\mu_0 \\epsilon_0$, and $[S]$ and $[T]$ are global matrices assembled from element contributions. The entries of the element matrix $[T]^e$ are given by the integral $T_{ij}^e = \\int_e \\epsilon_r(x,y) N_i(x,y) N_j(x,y) \\,dA$, where $N_i$ are the linear basis (shape) functions for element $e$, and $\\epsilon_r(x,y)$ is the relative permittivity within that element.\n\nFor this problem, the square domain is discretized into two linear triangular elements using four nodes: node 1 at (0,0), node 2 at (L,0), node 3 at (L,L), and node 4 at (0,L). Element 1 is defined by the vertices (nodes) 1, 2, and 3. Element 2 is defined by the vertices (nodes) 1, 3, and 4.\n\nYour task is to calculate the entry $T_{33}$ of the global matrix $[T]$, which corresponds to the node located at (L,L). Express your answer as a symbolic expression in terms of $L$ and $\\epsilon_r$.", "solution": "For TE modes in a 2D PEC cavity, the longitudinal magnetic field satisfies the weak form that leads (after FEM discretization) to the generalized eigenproblem $[S]\\{H\\} - k_{0}^{2}[T]\\{H\\} = \\{0\\}$ with element mass-type matrix entries\n$$\nT_{ij}^{e}=\\int_{e}\\epsilon_{r}(x,y)\\,N_{i}(x,y)\\,N_{j}(x,y)\\,dA,\n$$\nwhere $N_{i}$ are linear nodal shape functions on triangle $e$, and $\\epsilon_{r}(x,y)$ is constant within each element for this mesh because the diagonal $y=x$ coincides with the material interface. The global entry $T_{33}$ (for the node at $(L,L)$) is the sum of the contributions from the two elements that contain node 3:\n$$\nT_{33}=\\sum_{e\\in\\{(1,2,3),(1,3,4)\\}}\\int_{e}\\epsilon_{r}^{(e)}\\,\\left(N_{3}^{(e)}\\right)^{2}\\,dA,\n$$\nwith $\\epsilon_{r}^{(1,2,3)}=\\epsilon_{r}$ (dielectric, region $0\\leq y\\leq x$) and $\\epsilon_{r}^{(1,3,4)}=1$ (vacuum, region $x<y$). For a linear triangular element with area $A_{e}$, the standard consistent mass-matrix result (which can be shown by mapping to the reference triangle) gives\n$$\n\\int_{e}\\left(N_{i}\\right)^{2}\\,dA=\\frac{A_{e}}{6}.\n$$\nA direct verification uses the reference triangle with vertices $(0,0)$, $(1,0)$, $(0,1)$ where $N_{3}=\\eta$ and\n$$\n\\int_{\\text{ref}} \\eta^{2}\\,d\\xi\\,d\\eta=\\int_{0}^{1}\\int_{0}^{1-\\eta}\\eta^{2}\\,d\\xi\\,d\\eta=\\int_{0}^{1}\\eta^{2}(1-\\eta)\\,d\\eta=\\frac{1}{12},\n$$\nand under an affine map to any physical linear triangle, $dA=\\det(J)\\,d\\xi d\\eta$ is constant and scales the integral by the area ratio, yielding $A_{e}/6$.\n\nEach of the two triangles has area $A_{e}=L^{2}/2$. Therefore,\n$$\nT_{33}=\\epsilon_{r}\\left(\\frac{A_{1}}{6}\\right)+1\\left(\\frac{A_{2}}{6}\\right)=\\epsilon_{r}\\left(\\frac{L^{2}}{12}\\right)+\\left(\\frac{L^{2}}{12}\\right)=\\frac{L^{2}}{12}\\left(\\epsilon_{r}+1\\right).\n$$\nThis integral is unaffected by the measure-zero interface along $y=x$.", "answer": "$$\\boxed{\\frac{L^{2}}{12}\\left(\\epsilon_{r}+1\\right)}$$", "id": "1616451"}, {"introduction": "The power of FEM extends beyond standard engineering calculations to the exploration of profound physical phenomena. This advanced practice delves into the non-trivial nature of the magnetic vector potential $\\mathbf{A}$ in a region where the magnetic field $\\mathbf{B}$ is zero—a classical analogue to the Aharonov-Bohm effect. By numerically computing the circulation of $\\mathbf{A}$, you will see how FEM can be used to investigate the topological and non-local properties of electromagnetic fields, providing a bridge between numerical methods and deep theoretical concepts [@problem_id:1616410].", "problem": "Consider an idealized, infinitely long solenoid aligned with the $z$-axis, with a radius $R$. It carries a steady current that produces a uniform magnetic field $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$ for radial distances $\\rho \\le R$ and a null magnetic field, $\\mathbf{B} = \\mathbf{0}$, for $\\rho > R$. The total magnetic flux confined within the solenoid is denoted by $\\Phi_B$.\n\nIn the exterior region ($\\rho > R$), although the magnetic field is zero, the magnetic vector potential $\\mathbf{A}$ is non-zero and non-trivial due to the topologically non-simply connected nature of the space. A numerical simulation using the Finite Element Method (FEM) is performed to solve for the vector potential $\\mathbf{A}$ in the $xy$-plane for the region exterior to the solenoid. The simulation outputs the values of $\\mathbf{A}$ at a series of discrete points (nodes). These nodes are located at the vertices of a regular $N$-sided polygon, centered at the origin, with all vertices lying on a circle of radius $r_p > R$.\n\nYour task is to compute the numerical approximation for the circulation of the vector potential, $\\oint \\mathbf{A} \\cdot d\\mathbf{l}$, along the perimeter of this $N$-sided polygon. The calculation must be performed by summing the contributions from each of the $N$ straight line segments that form the polygon. For each segment, the vector potential $\\mathbf{A}$ should be approximated by a linear interpolation between its known values at the two vertices that define the segment.\n\nDetermine a closed-form expression for this numerically approximated circulation in terms of the total magnetic flux $\\Phi_B$ and the number of polygon sides $N$.", "solution": "By Stokes' theorem, the circulation of the vector potential $\\mathbf{A}$ around any closed loop must equal the magnetic flux passing through the surface enclosed by that loop. For a path outside the solenoid ($\\rho > R$), the enclosed flux is the total flux of the solenoid, $\\Phi_B$. So, for a circular path of radius $\\rho$, $\\oint \\mathbf{A} \\cdot d\\mathbf{l} = \\Phi_B$. A suitable gauge choice for the vector potential in the exterior region is the azimuthally symmetric one:\n$$\n\\mathbf{A}(\\rho, \\phi) = \\frac{\\Phi_B}{2\\pi \\rho} \\hat{\\boldsymbol{\\phi}}\n$$\nA numerical simulation provides the values of $\\mathbf{A}$ at the $N$ vertices of a regular polygon of radius $r_p > R$. Let the vertices be $\\mathbf{r}_k$ for $k=0, 1, \\dots, N-1$. The vector potential at vertex $k$ is $\\mathbf{A}_k = \\mathbf{A}(\\mathbf{r}_k) = \\frac{\\Phi_B}{2\\pi r_p} \\hat{\\boldsymbol{\\phi}}_k$. Let's denote the constant magnitude as $A_0 = \\frac{\\Phi_B}{2\\pi r_p}$.\n\nThe total circulation along the polygon is the sum of the line integrals over the $N$ straight segments. The contribution from the segment between vertex $\\mathbf{r}_k$ and $\\mathbf{r}_{k+1}$ (with $\\mathbf{r}_N = \\mathbf{r}_0$) is $\\int_{\\mathbf{r}_k}^{\\mathbf{r}_{k+1}} \\mathbf{A} \\cdot d\\mathbf{l}$.\n\nThe problem asks to use a linear interpolation of $\\mathbf{A}$ along each segment. The displacement vector for the segment is $\\Delta\\mathbf{l}_k = \\mathbf{r}_{k+1} - \\mathbf{r}_k$. The line integral over this segment can be approximated using the trapezoidal rule, which is exact for a linear interpolant:\n$$\nI_k = \\int_{\\text{segment } k} \\mathbf{A} \\cdot d\\mathbf{l} \\approx \\frac{\\mathbf{A}_k + \\mathbf{A}_{k+1}}{2} \\cdot \\Delta\\mathbf{l}_k = \\frac{\\mathbf{A}_k + \\mathbf{A}_{k+1}}{2} \\cdot (\\mathbf{r}_{k+1} - \\mathbf{r}_k)\n$$\nWe expand the dot product:\n$$\nI_k = \\frac{1}{2} (\\mathbf{A}_k \\cdot \\mathbf{r}_{k+1} - \\mathbf{A}_k \\cdot \\mathbf{r}_k + \\mathbf{A}_{k+1} \\cdot \\mathbf{r}_{k+1} - \\mathbf{A}_{k+1} \\cdot \\mathbf{r}_k)\n$$\nIn polar coordinates, the position vector $\\mathbf{r}$ is purely radial ($\\mathbf{r} = r \\hat{\\boldsymbol{\\rho}}$) and the vector potential $\\mathbf{A}$ is purely azimuthal ($\\mathbf{A} = A \\hat{\\boldsymbol{\\phi}}$). Since the radial and azimuthal unit vectors are orthogonal, $\\mathbf{A}_k \\cdot \\mathbf{r}_k = 0$ and $\\mathbf{A}_{k+1} \\cdot \\mathbf{r}_{k+1} = 0$.\nLet the angle of vertex $k$ be $\\theta_k = 2\\pi k / N$. Then $\\mathbf{A}_k = A_0 \\hat{\\boldsymbol{\\phi}}_k$ and $\\mathbf{r}_{k+1} = r_p \\hat{\\boldsymbol{\\rho}}_{k+1}$. The dot product is:\n$$\n\\mathbf{A}_k \\cdot \\mathbf{r}_{k+1} = A_0 r_p (\\hat{\\boldsymbol{\\phi}}_k \\cdot \\hat{\\boldsymbol{\\rho}}_{k+1}) = A_0 r_p \\sin(\\theta_{k+1} - \\theta_k) = A_0 r_p \\sin\\left(\\frac{2\\pi}{N}\\right)\n$$\nSimilarly,\n$$\n\\mathbf{A}_{k+1} \\cdot \\mathbf{r}_k = A_0 r_p (\\hat{\\boldsymbol{\\phi}}_{k+1} \\cdot \\hat{\\boldsymbol{\\rho}}_k) = A_0 r_p \\sin(\\theta_k - \\theta_{k+1}) = -A_0 r_p \\sin\\left(\\frac{2\\pi}{N}\\right)\n$$\nSubstituting these into the expression for $I_k$:\n$$\nI_k = \\frac{1}{2} \\left[ A_0 r_p \\sin\\left(\\frac{2\\pi}{N}\\right) - 0 + 0 - \\left(-A_0 r_p \\sin\\left(\\frac{2\\pi}{N}\\right)\\right) \\right] = A_0 r_p \\sin\\left(\\frac{2\\pi}{N}\\right)\n$$\nThe total circulation is the sum over all $N$ identical segments:\n$$\n\\oint \\mathbf{A} \\cdot d\\mathbf{l} = \\sum_{k=0}^{N-1} I_k = N \\cdot I_k = N A_0 r_p \\sin\\left(\\frac{2\\pi}{N}\\right)\n$$\nFinally, substituting back $A_0 = \\frac{\\Phi_B}{2\\pi r_p}$:\n$$\n\\oint \\mathbf{A} \\cdot d\\mathbf{l} = N \\left(\\frac{\\Phi_B}{2\\pi r_p}\\right) r_p \\sin\\left(\\frac{2\\pi}{N}\\right) = \\frac{N \\Phi_B}{2\\pi} \\sin\\left(\\frac{2\\pi}{N}\\right)\n$$\nAs a check, for large $N$, we can use the small angle approximation $\\sin(x) \\approx x$. The circulation becomes $\\frac{N \\Phi_B}{2\\pi} \\left(\\frac{2\\pi}{N}\\right) = \\Phi_B$, which is the exact analytical result.", "answer": "$$\\boxed{\\frac{N}{2\\pi}\\,\\Phi_{B}\\,\\sin\\!\\left(\\frac{2\\pi}{N}\\right)}$$", "id": "1616410"}]}