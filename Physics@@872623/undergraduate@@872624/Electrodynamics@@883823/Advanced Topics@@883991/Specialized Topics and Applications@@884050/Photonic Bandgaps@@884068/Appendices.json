{"hands_on_practices": [{"introduction": "The most fundamental property of a 1D photonic crystal, or Bragg stack, is its primary reflection band, often called the first-order stop-band. This exercise provides a foundational calculation for locating the center of this band. By applying the Bragg condition, you will determine the specific wavelength that is most strongly reflected due to constructive interference from the periodic layers, a core concept in designing optical filters and mirrors [@problem_id:1596452].", "problem": "A materials scientist is engineering a Distributed Bragg Reflector (DBR), a key component in many optical devices like lasers and filters. The DBR is constructed from a periodic stack of alternating layers of two different non-magnetic, lossless dielectric materials deposited on a substrate. For this specific design, the first material is tantalum pentoxide, which has a refractive index of $n_1 = 2.15$, and each layer has a physical thickness of $d_1 = 78.0$ nm. The second material is silicon dioxide, with a refractive index of $n_2 = 1.46$ and a layer thickness of $d_2 = 115.0$ nm.\n\nAssuming light is incident normal to the surface of this structure, calculate the central wavelength of the first-order photonic stop-band. This corresponds to the wavelength at which there is maximum constructive interference for reflections from the periodic layers.\n\nExpress your answer in nanometers (nm), rounded to three significant figures.", "solution": "At normal incidence for a one-dimensional periodic stack of two non-magnetic, lossless dielectric layers, the central (Bragg) wavelength of the first-order photonic stop-band is determined by the condition that the optical thickness of one period equals one-half of the wavelength. This yields the Bragg condition\n$$\n\\lambda_{0}=\\frac{2\\left(n_{1}d_{1}+n_{2}d_{2}\\right)}{m},\n$$\nwhere $m$ is the diffraction order. For the first order, $m=1$, so\n$$\n\\lambda_{0}=2\\left(n_{1}d_{1}+n_{2}d_{2}\\right).\n$$\nSubstituting the given values,\n$$\nn_{1}d_{1}=2.15\\times 78.0\\ \\text{nm}=167.7\\ \\text{nm},\n$$\n$$\nn_{2}d_{2}=1.46\\times 115.0\\ \\text{nm}=167.9\\ \\text{nm},\n$$\nso\n$$\nn_{1}d_{1}+n_{2}d_{2}=167.7\\ \\text{nm}+167.9\\ \\text{nm}=335.6\\ \\text{nm}.\n$$\nTherefore,\n$$\n\\lambda_{0}=2\\times 335.6\\ \\text{nm}=671.2\\ \\text{nm}.\n$$\nRounding to three significant figures gives $671$ nm.", "answer": "$$\\boxed{671}$$", "id": "1596452"}, {"introduction": "While the primary bandgap is often the focus, periodic structures also exhibit higher-order gaps at shorter wavelengths. Interestingly, the strength of these gaps—and even their existence—depends on the specific geometry of the repeating unit cell. This theoretical exercise delves into the reason why, showing that a gap's presence is tied to the Fourier series representation of the material's periodic dielectric function, and you will derive the condition under which a specific higher-order gap can be made to vanish completely [@problem_id:999264].", "problem": "A one-dimensional Bragg stack is a periodic structure formed by alternating layers of two different dielectric materials. Consider a stack with layers of refractive index $n_1$ and thickness $d_1$, and layers of refractive index $n_2$ and thickness $d_2$. The period of the structure is $\\Lambda = d_1 + d_2$.\n\nFor light at normal incidence, this structure exhibits photonic stop bands (or band gaps), which are frequency ranges where light cannot propagate through the structure. These gaps are centered at frequencies for which the Bragg condition is approximately satisfied. The existence and width of the $m$-th order stop band (where $m$ is a positive integer) are determined by the $m$-th Fourier coefficient of the periodic dielectric function profile, $\\epsilon(z)$. If this Fourier coefficient is zero, the corresponding stop band vanishes.\n\nAssuming the materials are lossless and non-magnetic, and that $n_1 \\neq n_2$, determine the relationship between the layer thicknesses, $d_1$ and $d_2$, that causes the second-order ($m=2$) photonic stop band to vanish for normally incident light. Express your answer as an equation relating $d_1$ and $d_2$.", "solution": "We model the periodic dielectric profile as\n$$\n\\epsilon(z)=\\begin{cases}\n\\epsilon_1\\equiv n_1^2,&0\\le z<d_1,\\\\\n\\epsilon_2\\equiv n_2^2,&d_1\\le z<\\Lambda,\n\\end{cases}\n\\quad\\Lambda=d_1+d_2.\n$$\nThe $m$-th Fourier coefficient is\n$$\n\\epsilon_m=\\frac{1}{\\Lambda}\\int_0^\\Lambda\\epsilon(z)e^{-i \\frac{2\\pi m}{\\Lambda}z}\\,dz\n=\\frac{1}{\\Lambda}\\Bigl[\\epsilon_1\\int_0^{d_1}e^{-i m G z}dz+\\epsilon_2\\int_{d_1}^{\\Lambda}e^{-i m G z}dz\\Bigr],\n\\quad G=\\frac{2\\pi}{\\Lambda}.\n$$\nCompute the integrals:\n$$\n\\int_0^{d_1}e^{-i m G z}dz=\\frac{1-e^{-i m G d_1}}{i m G},\\qquad\n\\int_{d_1}^{\\Lambda}e^{-i m G z}dz=\\frac{e^{-i m G d_1}-e^{-i m G\\Lambda}}{i m G}\n=\\frac{e^{-i m G d_1}-1}{i m G}.\n$$\nHence\n$$\n\\epsilon_m\n=\\frac{1}{\\Lambda i m G}\\Bigl[\\epsilon_1(1-e^{-i m G d_1})+\\epsilon_2(e^{-i m G d_1}-1)\\Bigr]\n=\\frac{\\epsilon_1-\\epsilon_2}{\\Lambda i m G}\\bigl(1-e^{-i m G d_1}\\bigr).\n$$\nFor the $m$-th stop band to vanish we require $\\epsilon_m=0$.  Since $\\epsilon_1\\neq\\epsilon_2$, \n$$\n1-e^{-i m G d_1}=0\\;\\Longrightarrow\\;e^{-i m\\frac{2\\pi}{\\Lambda}d_1}=1\\;\\Longrightarrow\\;\nm\\frac{d_1}{\\Lambda}=k,\\quad k\\in\\mathbb{Z}.\n$$\nFor the physically nontrivial zero in the first period one takes $k=1$.  For the second-order band $m=2$,\n$$\n2\\frac{d_1}{\\Lambda}=1\\;\\Longrightarrow\\;\\frac{d_1}{d_1+d_2}=\\frac12\n\\;\\Longrightarrow\\;d_1=d_2.\n$$", "answer": "$$\\boxed{d_1 = d_2}$$", "id": "999264"}, {"introduction": "To gain a complete picture of a photonic crystal's properties, we need a method that reveals all allowed and forbidden frequency bands, not just the center of one gap. The Transfer Matrix Method (TMM) is a powerful computational technique used for exactly this purpose in 1D systems. In this practice, you will implement the TMM to calculate the full band structure, identifying all the frequency ranges where light cannot propagate and bridging the gap between analytical theory and practical simulation tools [@problem_id:2387580].", "problem": "A one-dimensional photonic crystal is formed by the infinite periodic repetition of a unit cell consisting of two homogeneous, isotropic, lossless, nonmagnetic dielectric layers at normal incidence. Let layer 1 have relative permittivity $\\varepsilon_{r1}$ and thickness $d_1$ (in meters), and layer 2 have relative permittivity $\\varepsilon_{r2}$ and thickness $d_2$ (in meters). Assume vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$, speed of light in vacuum $c = 299{,}792{,}458\\,\\mathrm{m/s}$, and vacuum permittivity $\\varepsilon_0 = 1/(\\mu_0 c^2)\\,\\mathrm{F/m}$. The refractive index of layer $j$ is $n_j = \\sqrt{\\varepsilon_{rj}}$. The unit cell is ordered as layer 1 followed by layer 2, with period $a = d_1 + d_2$. Consider time-harmonic fields with angular frequency $\\omega = 2\\pi f$ at normal incidence and require the existence of nontrivial Bloch waves consistent with the periodic structure. For each frequency $f$ (in hertz), determine whether a propagating Bloch solution exists; frequencies for which no propagating Bloch solution exists form photonic band gaps. For each test case below, identify all frequency intervals within the provided range $[f_{\\min}, f_{\\max}]$ that constitute photonic band gaps, and report each interval as a two-element list $[f_\\mathrm{lower}, f_\\mathrm{upper}]$ in hertz. Express all reported frequencies in hertz (Hz), rounded to the nearest $1.0\\times 10^{10}\\,\\mathrm{Hz}$. If there are no photonic band gaps within the specified range, report an empty list for that test case.\n\nTest suite (each tuple is $(\\varepsilon_{r1}, \\varepsilon_{r2}, d_1, d_2, f_{\\min}, f_{\\max})$, with thicknesses in meters and frequencies in hertz):\n- Case 1 (high-contrast, quarter-wave design near a central frequency): $\\left(2.25,\\ 12.25,\\ \\dfrac{c}{4\\,\\sqrt{2.25}\\,2.0\\times 10^{14}},\\ \\dfrac{c}{4\\,\\sqrt{12.25}\\,2.0\\times 10^{14}},\\ 1.0\\times 10^{14},\\ 4.0\\times 10^{14}\\right)$.\n- Case 2 (homogeneous limit): $\\left(4.0,\\ 4.0,\\ 2.0\\times 10^{-7},\\ 3.0\\times 10^{-7},\\ 1.0\\times 10^{14},\\ 3.0\\times 10^{14}\\right)$.\n- Case 3 (low-contrast, quarter-wave design near a central frequency): $\\left(2.25,\\ 2.56,\\ \\dfrac{c}{4\\,\\sqrt{2.25}\\,3.0\\times 10^{14}},\\ \\dfrac{c}{4\\,\\sqrt{2.56}\\,3.0\\times 10^{14}},\\ 1.5\\times 10^{14},\\ 4.5\\times 10^{14}\\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The $i$-th element corresponds to the $i$-th test case and must itself be a list of the photonic band gaps found for that test case, where each band gap is reported as a two-element list $[f_\\mathrm{lower}, f_\\mathrm{upper}]$ in hertz, using the rounding rule above. For example, a valid output structure with two gaps for the first case and none for the second case would look like: $[[f_{1,\\mathrm{low}},f_{1,\\mathrm{high}}],[f_{2,\\mathrm{low}},f_{2,\\mathrm{high}}]],[]$. The program must aggregate the three test cases into one line, for example: $[[\\dots],[\\dots,\\dots]],[],[[\\dots]]]$. No additional text should be printed.", "solution": "The problem is to determine the frequency intervals corresponding to photonic band gaps for a one-dimensional, infinite photonic crystal at normal incidence. The problem is well-posed and scientifically sound, based on the standard transfer matrix method for analyzing periodic dielectric structures.\n\nA photonic band gap consists of frequencies for which no propagating Bloch waves can exist in the periodic structure. The condition for the existence of a propagating Bloch wave with Bloch wavevector $K$ in a one-dimensional periodic structure with period $a$ is given by the dispersion relation, which can be derived using the transfer matrix method.\n\nLet the unit cell consist of two layers with refractive indices $n_1 = \\sqrt{\\varepsilon_{r1}}$, $n_2 = \\sqrt{\\varepsilon_{r2}}$ and thicknesses $d_1$, $d_2$. The period is $a = d_1 + d_2$. For a time-harmonic electromagnetic wave with angular frequency $\\omega = 2\\pi f$ at normal incidence, the propagation through the layered structure can be described by a $2 \\times 2$ transfer matrix. This matrix relates the tangential components of the electric and magnetic fields, $(E, H)$, at the beginning of a unit cell to the fields at the end of the cell.\n\nThe transfer matrix $U_{cell}$ for one period ($a=d_1+d_2$) is the product of the matrices for each layer, $U_{cell} = U_2 U_1$, where $U_j$ is the forward-propagating transfer matrix for layer $j$. The matrix for a single layer of thickness $d_j$ and refractive index $n_j$ is:\n$$\nU_j = \\begin{pmatrix} \\cos(k_j d_j) & -i\\eta_j \\sin(k_j d_j) \\\\ -i\\frac{1}{\\eta_j} \\sin(k_j d_j) & \\cos(k_j d_j) \\end{pmatrix}\n$$\nHere, $k_j = n_j \\omega/c = 2\\pi f n_j / c$ is the wavenumber in the layer, and $\\eta_j = \\eta_0/n_j$ is the wave impedance, with $\\eta_0 = \\sqrt{\\mu_0/\\varepsilon_0}$ being the impedance of free space. Since the problem concerns lossless, nonmagnetic media, this formulation is appropriate. The product of the individual matrices gives the transfer matrix for the unit cell: $U_{cell} = U_2 U_1$.\n\nAccording to Bloch's theorem, for an eigenmode in a periodic system, the fields at the end of a unit cell must be equal to the fields at the beginning, multiplied by a phase factor $e^{iKa}$, where $K$ is the Bloch wavevector. This implies that $e^{iKa}$ must be an eigenvalue of the unit cell transfer matrix $U_{cell}$. The eigenvalues $\\lambda$ of a $2 \\times 2$ matrix with determinant $1$ (which is the case here as $\\det(U_j)=1$) are given by the characteristic equation $\\lambda^2 - \\text{Tr}(U_{cell})\\lambda + 1 = 0$.\n\nThe eigenvalues are $e^{\\pm iKa}$, and their sum is $2\\cos(Ka) = \\text{Tr}(U_{cell})$. This leads to the dispersion relation:\n$$\n\\cos(Ka) = \\frac{1}{2} \\text{Tr}(U_{cell})\n$$\nPropagating waves (real $K$) exist only when the right-hand side is within the range $[-1, 1]$. Frequencies for which $|\\frac{1}{2} \\text{Tr}(U_{cell})| > 1$ correspond to complex $K$, representing evanescent waves that cannot propagate indefinitely. These frequency ranges are the photonic band gaps.\n\nLet's compute the trace of $U_{cell} = U_2 U_1$:\n$$\n\\text{Tr}(U_{cell}) = 2\\cos(k_1d_1)\\cos(k_2d_2) - \\left(\\frac{\\eta_2}{\\eta_1} + \\frac{\\eta_1}{\\eta_2}\\right)\\sin(k_1d_1)\\sin(k_2d_2)\n$$\nSince $\\eta_j = \\eta_0/n_j$, the ratio $\\eta_2/\\eta_1 = n_1/n_2$. Substituting this, we define a function $H(f)$:\n$$\nH(f) = \\frac{1}{2}\\text{Tr}(U_{cell}) = \\cos(k_1d_1)\\cos(k_2d_2) - \\frac{1}{2}\\left(\\frac{n_1}{n_2} + \\frac{n_2}{n_1}\\right)\\sin(k_1d_1)\\sin(k_2d_2)\n$$\nThe photonic band gaps are the frequency intervals where $|H(f)| > 1$.\n\nThe algorithmic procedure to find these gaps is as follows:\n1.  For each test case, define the parameters $\\varepsilon_{r1}, \\varepsilon_{r2}, d_1, d_2, f_{\\min}, f_{\\max}$. The refractive indices are $n_j = \\sqrt{\\varepsilon_{rj}}$. The speed of light $c$ is given as $299{,}792{,}458\\,\\mathrm{m/s}$. A special case is when $n_1=n_2$, which corresponds to a homogeneous medium. In this case, the term $\\frac{1}{2}(\\frac{n_1}{n_2} + \\frac{n_2}{n_1}) = 1$, and $H(f)$ simplifies to $\\cos(k_1(d_1+d_2))$. Since a cosine function is always bounded between $-1$ and $1$, there are no band gaps.\n2.  The band edges are the frequencies $f$ where $|H(f)| = 1$, i.e., $H(f) = 1$ or $H(f) = -1$.\n3.  We find these band-edge frequencies numerically. The frequency range $[f_{\\min}, f_{\\max}]$ is discretized into a fine grid. We search for intervals on this grid where the functions $H(f)-1$ or $H(f)+1$ change sign, indicating the presence of a root.\n4.  The `scipy.optimize.brentq` function is used to find the precise location of each root within these bracketing intervals.\n5.  All found roots, along with $f_{\\min}$ and $f_{\\max}$, form a set of boundary points that partition the frequency range.\n6.  For each subinterval between two consecutive boundary points, we check if it lies within a band gap by evaluating $H(f)$ at the midpoint of the subinterval. If $|H(f_{mid})| > 1$, the subinterval is part of a band gap.\n7.  The resulting band gap intervals are collected. Adjacent intervals forming a single continuous gap are merged.\n8.  The lower and upper bounds of each final gap interval are rounded to the nearest $1.0\\times 10^{10}\\,\\mathrm{Hz}$ as specified.\n9.  The final result for each test case is a list of these rounded band gap intervals. If no gaps are found, an empty list is reported.\n\nThis numerical approach is general and robust for any set of parameters. For the special cases of quarter-wave stacks (Cases 1 and 3), analytical solutions exist and can be used to verify the numerical results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for photonic band gaps in a 1D photonic crystal for given test cases.\n\n    The method is based on the transfer matrix formalism for 1D periodic systems.\n    A band gap exists for frequencies where the magnitude of the half-trace of\n    the unit cell transfer matrix exceeds 1. This condition is checked across the\n    specified frequency range for each test case.\n    \"\"\"\n\n    C_LIGHT = 299792458.0  # Speed of light in vacuum, m/s\n\n    def setup_test_cases():\n        \"\"\"Pre-calculates parameters for test cases to avoid using eval().\"\"\"\n        \n        # Case 1: High-contrast quarter-wave stack\n        c1_eps1, c1_eps2 = 2.25, 12.25\n        c1_n1, c1_n2 = np.sqrt(c1_eps1), np.sqrt(c1_eps2)\n        c1_fc = 2.0e14\n        c1_d1 = C_LIGHT / (4.0 * c1_n1 * c1_fc)\n        c1_d2 = C_LIGHT / (4.0 * c1_n2 * c1_fc)\n        c1_fmin, c1_fmax = 1.0e14, 4.0e14\n        case1 = (c1_eps1, c1_eps2, c1_d1, c1_d2, c1_fmin, c1_fmax)\n\n        # Case 2: Homogeneous medium\n        c2_eps1, c2_eps2 = 4.0, 4.0\n        c2_d1, c2_d2 = 2.0e-7, 3.0e-7\n        c2_fmin, c2_fmax = 1.0e14, 3.0e14\n        case2 = (c2_eps1, c2_eps2, c2_d1, c2_d2, c2_fmin, c2_fmax)\n\n        # Case 3: Low-contrast quarter-wave stack\n        c3_eps1, c3_eps2 = 2.25, 2.56\n        c3_n1, c3_n2 = np.sqrt(c3_eps1), np.sqrt(c3_eps2)\n        c3_fc = 3.0e14\n        c3_d1 = C_LIGHT / (4.0 * c3_n1 * c3_fc)\n        c3_d2 = C_LIGHT / (4.0 * c3_n2 * c3_fc)\n        c3_fmin, c3_fmax = 1.5e14, 4.5e14\n        case3 = (c3_eps1, c3_eps2, c3_d1, c3_d2, c3_fmin, c3_fmax)\n        \n        return [case1, case2, case3]\n\n    test_cases = setup_test_cases()\n    all_results = []\n    \n    for case in test_cases:\n        eps1, eps2, d1, d2, f_min, f_max = case\n        \n        n1 = np.sqrt(eps1)\n        n2 = np.sqrt(eps2)\n        \n        # Handle the homogeneous case where no contrast means no band gaps\n        if np.isclose(n1, n2):\n            all_results.append([])\n            continue\n\n        def H_func(f):\n            \"\"\"Calculates the half-trace of the transfer matrix.\"\"\"\n            f = np.asarray(f)\n            k1 = n1 * 2.0 * np.pi * f / C_LIGHT\n            k2 = n2 * 2.0 * np.pi * f / C_LIGHT\n            \n            cos_k1d1 = np.cos(k1 * d1)\n            cos_k2d2 = np.cos(k2 * d2)\n            sin_k1d1 = np.sin(k1 * d1)\n            sin_k2d2 = np.sin(k2 * d2)\n            \n            ratio_term = 0.5 * (n1 / n2 + n2 / n1)\n            \n            return cos_k1d1 * cos_k2d2 - ratio_term * sin_k1d1 * sin_k2d2\n\n        # Find roots of H(f) = +/- 1, which are the band edges\n        boundaries = {f_min, f_max}\n        num_points = 20000\n        freqs = np.linspace(f_min, f_max, num_points)\n        h_vals = H_func(freqs)\n        \n        h_plus_1 = h_vals + 1.0\n        h_minus_1 = h_vals - 1.0\n\n        for i in range(num_points - 1):\n            if h_plus_1[i] * h_plus_1[i+1] < 0:\n                try:\n                    root = brentq(lambda f: H_func(f) + 1.0, freqs[i], freqs[i+1])\n                    boundaries.add(root)\n                except ValueError:\n                    pass\n            if h_minus_1[i] * h_minus_1[i+1] < 0:\n                try:\n                    root = brentq(lambda f: H_func(f) - 1.0, freqs[i], freqs[i+1])\n                    boundaries.add(root)\n                except ValueError:\n                    pass\n        \n        sorted_boundaries = sorted(list(boundaries))\n        \n        gaps = []\n        rounding_precision = 1.0e10\n        \n        for i in range(len(sorted_boundaries) - 1):\n            f_low = sorted_boundaries[i]\n            f_high = sorted_boundaries[i+1]\n            \n            if f_high - f_low < 1e-9 * (f_max - f_min):\n                continue\n\n            mid_f = (f_low + f_high) / 2.0\n            h_mid = H_func(mid_f)\n            \n            # Check if the interval is a band gap\n            if h_mid > 1.0 or h_mid < -1.0:\n                f_low_rounded = round(f_low / rounding_precision) * rounding_precision\n                f_high_rounded = round(f_high / rounding_precision) * rounding_precision\n                \n                if f_low_rounded < f_high_rounded:\n                    # Merge with previous gap if adjacent\n                    if gaps and np.isclose(gaps[-1][1], f_low_rounded):\n                        gaps[-1][1] = f_high_rounded\n                    else:\n                        gaps.append([f_low_rounded, f_high_rounded])\n\n        all_results.append(gaps)\n\n    # Format the final output string as specified\n    output_str_parts = []\n    for res in all_results:\n        # Custom string formatting to avoid extra spaces and ensure correct structure\n        if not res:\n            output_str_parts.append(\"[]\")\n        else:\n            gap_strs = [f\"[{g[0]},{g[1]}]\" for g in res]\n            output_str_parts.append(f\"[{','.join(gap_strs)}]\")\n            \n    print(f\"[{','.join(output_str_parts)}]\")\n\nsolve()\n```", "id": "2387580"}]}