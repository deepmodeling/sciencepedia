{"hands_on_practices": [{"introduction": "Understanding how a pulse's energy propagates begins with the concept of group velocity. This exercise [@problem_id:1815495] provides practice in calculating this crucial quantity directly from a medium's dispersion relation, $\\omega(k)$. By determining the specific conditions required for a wave packet to travel at a small fraction of the speed of light, you will reinforce the fundamental link between a wave's properties and the dispersive characteristics of the medium it travels through.", "problem": "The propagation of radio waves through the Earth's ionosphere can be modeled by considering the ionosphere as a cold, unmagnetized plasma. In this model, the relationship between the angular frequency $\\omega$ of an electromagnetic wave and its wave number $k$ is described by the dispersion relation:\n$$ \\omega(k) = \\sqrt{\\omega_p^2 + (ck)^2} $$\nHere, $c$ is the speed of light in vacuum, and $\\omega_p$ is the plasma frequency, a constant value that depends on the electron density of the ionosphere. A signal, which is a wave packet composed of various frequencies, travels at the group velocity.\n\nDetermine the wave number $k$ for which the group velocity of a wave packet is exactly 1% of the speed of light in vacuum. Your answer should be a symbolic expression in terms of $\\omega_p$ and $c$.", "solution": "We model the ionosphere as a cold, unmagnetized plasma with dispersion relation $\\omega(k) = \\sqrt{\\omega_{p}^{2} + c^{2}k^{2}}$. The group velocity is defined by the physical principle $v_{g} = \\frac{d\\omega}{dk}$. Differentiating the given dispersion relation with respect to $k$ yields\n$$\nv_{g} = \\frac{d}{dk}\\left(\\sqrt{\\omega_{p}^{2} + c^{2}k^{2}}\\right) = \\frac{1}{2}\\left(\\omega_{p}^{2} + c^{2}k^{2}\\right)^{-\\frac{1}{2}} \\cdot 2c^{2}k = \\frac{c^{2}k}{\\sqrt{\\omega_{p}^{2} + c^{2}k^{2}}}.\n$$\nWe require the group velocity to be exactly a fraction $\\frac{1}{100}$ of the speed of light $c$, so we set\n$$\n\\frac{c^{2}k}{\\sqrt{\\omega_{p}^{2} + c^{2}k^{2}}} = \\frac{c}{100}.\n$$\nDividing both sides by $c$ gives\n$$\n\\frac{ck}{\\sqrt{\\omega_{p}^{2} + c^{2}k^{2}}} = \\frac{1}{100}.\n$$\nSquaring both sides,\n$$\n\\frac{c^{2}k^{2}}{\\omega_{p}^{2} + c^{2}k^{2}} = \\frac{1}{10000}.\n$$\nCross-multiplying,\n$$\n10000\\,c^{2}k^{2} = \\omega_{p}^{2} + c^{2}k^{2}.\n$$\nRearranging terms,\n$$\n(10000 - 1)c^{2}k^{2} = \\omega_{p}^{2} \\quad \\Rightarrow \\quad 9999\\,c^{2}k^{2} = \\omega_{p}^{2}.\n$$\nSolving for $k^{2}$,\n$$\nk^{2} = \\frac{\\omega_{p}^{2}}{9999\\,c^{2}}.\n$$\nTaking the square root, we obtain\n$$\nk = \\pm \\frac{\\omega_{p}}{c\\sqrt{9999}}.\n$$\nSince the requirement is that the group velocity equals the positive value $\\frac{1}{100}c$, and $v_{g}$ has the same sign as $k$, we select the positive root. Therefore,\n$$\nk = \\frac{\\omega_{p}}{c\\sqrt{9999}}.\n$$", "answer": "$$\\boxed{\\frac{\\omega_{p}}{c\\sqrt{9999}}}$$", "id": "1815495"}, {"introduction": "While group velocity describes the overall speed of a pulse, the reshaping of the pulse envelope is governed by how group velocity itself changes with frequency. This effect, known as group velocity dispersion (GVD) and quantified by the parameter $\\beta_2 = \\frac{d^2k}{d\\omega^2}$, is explored in this practical problem [@problem_id:1815504]. You will investigate how sending a specially prepared \"chirped\" pulse through a dispersive medium can lead to pulse compression, a technique essential for generating the ultrashort, high-power pulses used in modern laser systems.", "problem": "A simplified model for a pulse compressor, a key component in high-power laser systems, involves sending a chirped laser pulse through a dispersive optical medium. Consider an optical pulse that is initially \"down-chirped,\" meaning its instantaneous frequency decreases linearly with time from its leading edge to its trailing edge. The initial temporal duration of the pulse is $\\Delta t_{in} = 50.0 \\text{ ps}$. The total frequency bandwidth spanned by the pulse is $\\Delta \\omega = 2.50 \\times 10^{13} \\text{ rad/s}$.\n\nThe pulse is sent through a length $L = 7.60 \\text{ m}$ of a special optical fiber. The fiber material exhibits normal dispersion over the pulse's bandwidth. The effect of this dispersion is characterized by the group velocity dispersion parameter $\\beta_2 = \\frac{d^2k}{d\\omega^2} = 2.00 \\times 10^{-25} \\text{ s}^2/\\text{m}$, where $k$ is the wavenumber and $\\omega$ is the angular frequency.\n\nAssuming the pulse shape remains determined by the separation of its leading and trailing edges and that higher-order dispersion effects are negligible, calculate the final temporal duration of the pulse after it exits the fiber.\n\nExpress your final answer in picoseconds (ps), rounded to three significant figures.", "solution": "We model the propagation-induced temporal shift of each frequency component by the frequency-dependent group delay. Let $k(\\omega)$ be the wavenumber, with\n$$\n\\beta_{1}(\\omega) = \\frac{dk}{d\\omega}, \\qquad \\beta_{2} = \\frac{d^{2}k}{d\\omega^{2}}.\n$$\nAfter a length $L$, the group delay for angular frequency $\\omega$ is\n$$\n\\tau_{g}(\\omega) = \\beta_{1}(\\omega)\\,L.\n$$\nLinearizing $\\beta_{1}(\\omega)$ around the pulse center frequency $\\omega_{0}$,\n$$\n\\beta_{1}(\\omega) \\approx \\beta_{1}(\\omega_{0}) + \\beta_{2}\\,(\\omega - \\omega_{0}).\n$$\nConsider the leading and trailing edges associated with $\\omega_{h}$ (higher frequency) and $\\omega_{l}$ (lower frequency), respectively, for a down-chirped input. The difference in group delays between these two frequencies is\n$$\n\\Delta \\tau_{g} = \\tau_{g}(\\omega_{l}) - \\tau_{g}(\\omega_{h}) = \\left[\\beta_{1}(\\omega_{l}) - \\beta_{1}(\\omega_{h})\\right]L = \\beta_{2}L(\\omega_{l} - \\omega_{h}) = -\\,\\beta_{2}L\\,\\Delta\\omega,\n$$\nwhere $\\Delta\\omega = \\omega_{h} - \\omega_{l}  0$ is the total bandwidth.\n\nThe output temporal separation between the edges is the input separation plus the difference in group delays:\n$$\n\\Delta t_{\\text{out}} = \\left[t_{\\text{in}}(\\omega_{l}) + \\tau_{g}(\\omega_{l})\\right] - \\left[t_{\\text{in}}(\\omega_{h}) + \\tau_{g}(\\omega_{h})\\right] = \\Delta t_{\\text{in}} + \\Delta \\tau_{g} = \\Delta t_{\\text{in}} - \\beta_{2}L\\,\\Delta\\omega.\n$$\nFor normal dispersion ($\\beta_{2}  0$) with a down-chirped input, this reduces the pulse duration. Substituting the given values,\n$$\n\\beta_{2}L\\,\\Delta\\omega = \\left(2.00 \\times 10^{-25}\\,\\text{s}^{2}/\\text{m}\\right)\\left(7.60\\,\\text{m}\\right)\\left(2.50 \\times 10^{13}\\,\\text{s}^{-1}\\right) = 3.80 \\times 10^{-11}\\,\\text{s} = 38.0\\,\\text{ps}.\n$$\nTherefore,\n$$\n\\Delta t_{\\text{out}} = 50.0\\,\\text{ps} - 38.0\\,\\text{ps} = 12.0\\,\\text{ps}.\n$$\nRounded to three significant figures and expressed in picoseconds, the final temporal duration is $12.0$.", "answer": "$$\\boxed{12.0}$$", "id": "1815504"}, {"introduction": "To truly grasp the dynamics of pulse propagation, there is no substitute for watching the pulse evolve over time. This advanced computational practice [@problem_id:2450202] guides you from static calculations to a dynamic simulation. By implementing a Fourier-domain solution to the propagation equation, you will model how a Gaussian data bit broadens as it travels down an optical fiber, directly visualizing the consequences of group velocity dispersion on signal integrity.", "problem": "You are tasked with writing a complete, runnable program that constructs and propagates a single optical data bit modeled as a Gaussian wave packet through a lossless single-mode fiber and measures its temporal broadening. The computational model must be based on the scalar, linear slowly varying envelope equation, which is a well-tested description of pulse evolution in dispersive media derived from Maxwellâ€™s equations under the slowly varying envelope approximation:\n$$\n\\frac{\\partial A(T,z)}{\\partial z}=\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\frac{\\partial^{2}A(T,z)}{\\partial T^{2}},\n$$\nwhere $A(T,z)$ is the complex field envelope, $z$ is the propagation coordinate, and $T$ is the retarded time defined by $T=t-z/v_{g}$ with $t$ the laboratory time and $v_{g}$ the group velocity. The parameter $\\beta_{2}$ is the group-velocity-dispersion coefficient. You must construct the initial condition at $z=0$ as a transform-limited Gaussian data bit, then evolve it to a specified distance, and finally compute the output full width at half maximum (FWHM) of the intensity $|A|^{2}$. All quantities and results must be handled with consistent units.\n\nYour program must adhere to the following specifications.\n\n- Initial condition. Use a transform-limited Gaussian intensity profile with a specified intensity full width at half maximum $T_{\\mathrm{FWHM},0}$, so that the intensity is\n$$\nI(T,0)=|A(T,0)|^{2}=\\exp\\!\\left(-\\frac{T^{2}}{\\sigma^{2}}\\right),\n$$\nwith $\\sigma=T_{\\mathrm{FWHM},0}/\\left(2\\sqrt{\\ln 2}\\right)$ and the corresponding field envelope $A(T,0)=\\exp\\!\\left(-\\frac{T^{2}}{2\\sigma^{2}}\\right)$.\n- Evolution model. Numerically solve the above linear partial differential equation in retarded time $T$ using a Fourier-domain method that is consistent with the definition of the temporal angular frequency $\\omega$ associated with $T$. You must treat dispersion exactly in the frequency domain and ensure correct unit conversions. No absorption, gain, nonlinearity, or higher-order dispersion terms are to be included.\n- Measurement. Compute the output intensity $I(T,z)=|A(T,z)|^{2}$ at the specified distance $z$ and estimate the temporal intensity FWHM by locating the two times $T_{\\mathrm{L}}$ and $T_{\\mathrm{R}}$ at which $I(T,z)$ equals one half of its peak value, using interpolation between neighboring samples if necessary. Report $T_{\\mathrm{FWHM},z}=T_{\\mathrm{R}}-T_{\\mathrm{L}}$.\n- Units. The dispersion parameter $\\beta_{2}$ will be provided in $\\mathrm{ps}^{2}/\\mathrm{km}$ and distances in $\\mathrm{km}$. Convert internally to the International System of Units (SI): seconds and meters. The final answers must be reported as temporal FWHM values in picoseconds. All angles, if any appear, are in radians.\n- Discretization. Use a uniform retarded-time window of duration $T_{\\mathrm{span}}=4096\\,\\mathrm{ps}$ with $N=32768$ equispaced samples for all test cases. Assume periodic boundary conditions induced by the discrete Fourier transform. Choose the time origin such that $T=0$ lies at the center of the computational window.\n- Test suite. Your program must compute results for the following five parameter sets, each specified as an initial intensity FWHM $T_{\\mathrm{FWHM},0}$ in picoseconds, a dispersion coefficient $\\beta_{2}$ in $\\mathrm{ps}^{2}/\\mathrm{km}$, and a propagation distance $z$ in kilometers:\n    - Case $1$: $T_{\\mathrm{FWHM},0}=10\\,\\mathrm{ps}$, $\\beta_{2}=-21\\,\\mathrm{ps}^{2}/\\mathrm{km}$, $z=50\\,\\mathrm{km}$.\n    - Case $2$: $T_{\\mathrm{FWHM},0}=10\\,\\mathrm{ps}$, $\\beta_{2}=0\\,\\mathrm{ps}^{2}/\\mathrm{km}$, $z=50\\,\\mathrm{km}$.\n    - Case $3$: $T_{\\mathrm{FWHM},0}=5\\,\\mathrm{ps}$, $\\beta_{2}=2\\,\\mathrm{ps}^{2}/\\mathrm{km}$, $z=10\\,\\mathrm{km}$.\n    - Case $4$: $T_{\\mathrm{FWHM},0}=20\\,\\mathrm{ps}$, $\\beta_{2}=-21\\,\\mathrm{ps}^{2}/\\mathrm{km}$, $z=0.5\\,\\mathrm{km}$.\n    - Case $5$: $T_{\\mathrm{FWHM},0}=30\\,\\mathrm{ps}$, $\\beta_{2}=35\\,\\mathrm{ps}^{2}/\\mathrm{km}$, $z=80\\,\\mathrm{km}$.\n- Output. Your program must produce a single line of output containing the measured output FWHM values for the above cases, in picoseconds, rounded to exactly six digits after the decimal point, aggregated as a comma-separated list enclosed in square brackets. For example, the output format must be of the form [$a$,$b$,$c$,$d$,$e$] where $a$, $b$, $c$, $d$, and $e$ are decimal numbers with exactly six digits after the decimal point and no units included in the line. The internal computations must maintain physical units as specified above and the returned numeric values must correspond to picoseconds.", "solution": "The problem is found to be valid. It is scientifically grounded in the well-established theory of optical pulse propagation in dispersive media, described by the scalar, linear slowly varying envelope equation. The problem is well-posed, providing a linear partial differential equation with a properly defined initial condition and all necessary parameters. It is objective, with all requirements stated in clear, quantitative terms. A unique, stable, and meaningful solution can be obtained through the specified numerical methods.\n\nThe solution will be constructed by numerically solving the governing partial differential equation using the split-step Fourier method. For the given linear, uncoupled equation, this method is not an approximation but rather an exact numerical implementation of the analytical solution in the frequency domain.\n\nThe governing equation is:\n$$\n\\frac{\\partial A(T,z)}{\\partial z}=\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\frac{\\partial^{2}A(T,z)}{\\partial T^{2}}\n$$\nwhere $A(T,z)$ is the complex field envelope, $z$ is the propagation distance, $T$ is the retarded time, and $\\beta_{2}$ is the group-velocity dispersion parameter.\n\nThe solution proceeds in the following steps:\n\n1.  **Unit Conversion and Discretization**: All input parameters are first converted into SI units (meters, seconds) to ensure physical consistency.\n    -   $T_{\\mathrm{FWHM},0}$ $[\\mathrm{ps}] \\rightarrow [\\mathrm{s}]$: multiply by $10^{-12}$.\n    -   $z$ $[\\mathrm{km}] \\rightarrow [\\mathrm{m}]$: multiply by $10^3$.\n    -   $\\beta_{2}$ $[\\mathrm{ps}^{2}/\\mathrm{km}] \\rightarrow [\\mathrm{s}^{2}/\\mathrm{m}]$: multiply by $10^{-12 \\times 2} / 10^3 = 10^{-27}$.\n\n    The computational domain is discretized. A retarded time window of duration $T_{\\mathrm{span}} = 4096 \\times 10^{-12}\\,\\mathrm{s}$ is sampled with $N=32768$ points. This defines a time step of $dT = T_{\\mathrm{span}}/N$. A centered time grid $T$ is created, spanning from $-T_{\\mathrm{span}}/2$ to $T_{\\mathrm{span}}/2 - dT$. The corresponding angular frequency grid $\\omega$ is constructed based on the properties of the discrete Fourier transform. The frequency vector $\\nu$ is first obtained using `numpy.fft.fftfreq(N, d=dT)`, and then converted to angular frequency via $\\omega = 2\\pi\\nu$.\n\n2.  **Initial Condition**: The initial pulse at $z=0$ is a transform-limited Gaussian. The complex field envelope $A(T,0)$ is constructed on the time grid $T$:\n    $$\n    A(T,0) = \\exp\\!\\left(-\\frac{T^{2}}{2\\sigma^{2}}\\right)\n    $$\n    The parameter $\\sigma$ is calculated from the given initial intensity full width at half-maximum, $T_{\\mathrm{FWHM},0}$:\n    $$\n    \\sigma = \\frac{T_{\\mathrm{FWHM},0}}{2\\sqrt{\\ln 2}}\n    $$\n    Here, all time variables are in SI units.\n\n3.  **Frequency-Domain Propagation**: The PDE is solved in the frequency domain. Applying the temporal Fourier transform $\\mathcal{F}$ defined as $\\tilde{A}(\\omega,z) = \\mathcal{F}\\{A(T,z)\\}$, the second-order derivative becomes a multiplication: $\\mathcal{F}\\{\\partial^2A/\\partial T^2\\} = (\\mathrm{i}\\omega)^2 \\tilde{A}(\\omega,z) = -\\omega^2 \\tilde{A}(\\omega,z)$. The PDE transforms into a set of uncoupled ordinary differential equations, one for each frequency component $\\omega$:\n    $$\n    \\frac{d\\tilde{A}(\\omega,z)}{dz} = -\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\omega^2 \\tilde{A}(\\omega,z)\n    $$\n    For a propagation distance $z$, the solution is found by multiplying the initial spectrum $\\tilde{A}(\\omega,0)$ by a transfer function (propagator) $H(\\omega,z)$:\n    $$\n    \\tilde{A}(\\omega,z) = \\tilde{A}(\\omega,0) \\exp\\left(-\\mathrm{i}\\,\\frac{\\beta_{2}}{2}\\,\\omega^2 z\\right)\n    $$\n    The numerical algorithm implements this solution:\n    a. The initial field $A(T,0)$ is transformed to the frequency domain using the Fast Fourier Transform (FFT): $\\tilde{A}(\\omega,0) = \\mathrm{FFT}[A(T,0)]$.\n    b. The propagator $H(\\omega,z)$ is constructed on the discrete frequency grid $\\omega$.\n    c. The output spectrum is computed: $\\tilde{A}(\\omega,z) = \\tilde{A}(\\omega,0) \\cdot H(\\omega,z)$.\n    d. The resulting spectrum is transformed back to the time domain using the Inverse FFT (IFFT) to obtain the propagated field envelope $A(T,z) = \\mathrm{IFFT}[\\tilde{A}(\\omega,z)]$.\n    To handle the frequency ordering of the FFT algorithm correctly, `fftshift` and `ifftshift` operations are used to work with centered frequency and time domains.\n\n4.  **FWHM Measurement**: The output intensity profile is calculated as $I(T,z) = |A(T,z)|^2$. The full width at half-maximum, $T_{\\mathrm{FWHM}, z}$, is then determined.\n    a. The peak intensity $I_{\\mathrm{peak}} = \\max_T I(T,z)$ is found.\n    b. The half-maximum value is $I_{\\mathrm{half}} = I_{\\mathrm{peak}}/2$.\n    c. The grid points bracketing the two crossings of the intensity profile with the $I_{\\mathrm{half}}$ level are identified. Let these be $(T_{i-1}, I_{i-1})$ and $(T_i, I_i)$ for the left crossing $T_\\mathrm{L}$, and $(T_j, I_j)$ and $(T_{j+1}, I_{j+1})$ for the right crossing $T_\\mathrm{R}$, such that $I_{i-1}  I_{\\mathrm{half}}  I_i$ and $I_j  I_{\\mathrm{half}}  I_{j+1}$.\n    d. Linear interpolation is used to find the precise crossing points $T_{\\mathrm{L}}$ and $T_{\\mathrm{R}}$:\n    $$\n    T_{\\mathrm{L}} = T_{i-1} + (T_i - T_{i-1}) \\frac{I_{\\mathrm{half}} - I_{i-1}}{I_i - I_{i-1}}\n    $$\n    $$\n    T_{\\mathrm{R}} = T_j + (T_{j+1} - T_j) \\frac{I_{\\mathrm{half}} - I_j}{I_{j+1} - I_j}\n    $$\n    e. The FWHM is computed as $T_{\\mathrm{FWHM},z} = T_{\\mathrm{R}} - T_{\\mathrm{L}}$.\n    f. This result, in seconds, is converted back to picoseconds by multiplying by $10^{12}$ before being reported.\n\nThis procedure is applied to each of the five test cases provided. The numerical implementation must handle all array indexing and FFT shifts with care to ensure correctness.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (T_FWHM_0 [ps], beta2 [ps^2/km], z [km])\n        (10.0, -21.0, 50.0),\n        (10.0, 0.0, 50.0),\n        (5.0, 2.0, 10.0),\n        (20.0, -21.0, 0.5),\n        (30.0, 35.0, 80.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        fwhm_out_ps = solve_case(*case)\n        results.append(f\"{fwhm_out_ps:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(t_fwhm_0_ps, beta2_ps2_km, z_km):\n    \"\"\"\n    Constructs, propagates, and measures a Gaussian wave packet for a single case.\n\n    Args:\n        t_fwhm_0_ps (float): Initial intensity FWHM in picoseconds.\n        beta2_ps2_km (float): Group-velocity dispersion in ps^2/km.\n        z_km (float): Propagation distance in kilometers.\n\n    Returns:\n        float: Output temporal intensity FWHM in picoseconds.\n    \"\"\"\n    # --- 1. Discretization and Unit Conversion ---\n\n    # Discretization parameters\n    N = 32768  # Number of points\n    T_span_ps = 4096.0  # Time window duration in ps\n\n    # Conversion factors\n    PS_TO_S = 1e-12\n    KM_TO_M = 1e3\n    PS2_KM_TO_S2_M = 1e-27  # (1e-12)^2 / 1e3\n\n    # Convert to SI units\n    t_fwhm_0_si = t_fwhm_0_ps * PS_TO_S\n    beta2_si = beta2_ps2_km * PS2_KM_TO_S2_M\n    z_si = z_km * KM_TO_M\n    T_span_si = T_span_ps * PS_TO_S\n\n    # Set up computational grids\n    dt_si = T_span_si / N\n    # Time grid (centered at T=0)\n    T_si = np.linspace(-T_span_si / 2, T_span_si / 2, N, endpoint=False)\n    # Frequency grid (in standard FFT order)\n    nu_si = np.fft.fftfreq(N, d=dt_si)\n    omega_si = 2.0 * np.pi * nu_si\n    \n    # --- 2. Initial Condition ---\n\n    # Calculate sigma from FWHM\n    sigma_si = t_fwhm_0_si / (2.0 * np.sqrt(np.log(2)))\n    \n    # Construct initial field envelope A(T, 0)\n    A_T_0 = np.exp(-T_si**2 / (2.0 * sigma_si**2))\n\n    # --- 3. Propagation Step (Fourier Domain) ---\n    \n    # The propagation operator in the frequency domain\n    # D_op = -i * beta2/2 * omega^2\n    # A(omega, z) = A(omega, 0) * exp(D_op * z)\n    propagator = np.exp(-1j * beta2_si / 2.0 * omega_si**2 * z_si)\n\n    # FFT of initial condition\n    A_omega_0 = np.fft.fft(A_T_0)\n    \n    # Apply propagator in frequency domain\n    A_omega_z = A_omega_0 * propagator\n    \n    # IFFT to get field at distance z\n    A_T_z = np.fft.ifft(A_omega_z)\n\n    # --- 4. FWHM Measurement ---\n\n    # Calculate intensity\n    I_T_z = np.abs(A_T_z)**2\n    \n    # Find peak intensity and half-max value\n    I_peak = np.max(I_T_z)\n    I_half = I_peak / 2.0\n\n    # Handle the case of no broadening\n    if beta2_si == 0:\n        return t_fwhm_0_ps\n\n    # Find indices where intensity is above half-maximum\n    # This is more robust than searching from the peak\n    above_half_max_indices = np.where(I_T_z > I_half)[0]\n    \n    if len(above_half_max_indices)  2:\n        # Not enough points above half max, something is wrong\n        # or pulse is too narrow for grid. Return 0.\n        return 0.0\n\n    # Left crossing index (first point above half max)\n    idx_L_start = above_half_max_indices[0]\n    # Right crossing index (last point above half max)\n    idx_R_end = above_half_max_indices[-1]\n\n    # Linear interpolation for left crossing T_L\n    I1, I2 = I_T_z[idx_L_start - 1], I_T_z[idx_L_start]\n    T1, T2 = T_si[idx_L_start - 1], T_si[idx_L_start]\n    T_L_si = T1 + (T2 - T1) * (I_half - I1) / (I2 - I1)\n\n    # Linear interpolation for right crossing T_R\n    I1, I2 = I_T_z[idx_R_end], I_T_z[idx_R_end + 1]\n    T1, T2 = T_si[idx_R_end], T_si[idx_R_end + 1]\n    T_R_si = T1 + (T2 - T1) * (I_half - I1) / (I2 - I1)\n\n    # Calculate FWHM\n    t_fwhm_z_si = T_R_si - T_L_si\n\n    # Convert back to picoseconds for reporting\n    return t_fwhm_z_si / PS_TO_S\n\nsolve()\n```", "id": "2450202"}]}