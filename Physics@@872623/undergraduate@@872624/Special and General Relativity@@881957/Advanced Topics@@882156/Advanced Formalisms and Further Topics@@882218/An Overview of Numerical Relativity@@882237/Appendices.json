{"hands_on_practices": [{"introduction": "Numerical relativity simulations must capture physics across vast scales, from the compact regions near black holes to the distant zones where gravitational waves are extracted. Using a uniformly high-resolution grid is computationally prohibitive. This challenge is overcome using Adaptive Mesh Refinement (AMR), a technique that places high-resolution grids only where they are most needed. This practice problem [@problem_id:1814393] provides a quantitative look into just how effective this strategy is by comparing the number of grid points in a simplified AMR setup to a uniform grid.", "problem": "Numerical simulations in general relativity, particularly those involving binary black hole mergers, must handle physical phenomena occurring on vastly different length scales. The computational grid must be fine enough to resolve the strong gravitational fields near the black holes, yet large enough to encompass the entire system and extract the outgoing gravitational waves far away. This poses a significant computational challenge.\n\nTo analyze this, consider a simplified model of a 3D simulation of a binary system. The simulation is performed within a large cubic computational domain of side length $L$. The smallest dynamically important feature size that must be resolved throughout the simulation is $\\delta$.\n\nWe will compare two different strategies for discretizing this domain:\n\n1.  **Uniform Grid:** A straightforward approach is to use a single, uniform cubic grid that covers the entire domain. To resolve the smallest feature size $\\delta$ everywhere, the grid spacing must be set to $\\Delta x = \\delta$ throughout the domain of side $L$. Let the total number of grid cells in this case be $N_\\text{unif}$.\n\n2.  **Adaptive Mesh Refinement (AMR) Grid:** A more sophisticated approach is Adaptive Mesh Refinement (AMR), which uses a hierarchy of nested grids with different resolutions. Consider a setup with three refinement levels:\n    *   **Level 0:** A coarse base grid with spacing $\\Delta x_0$ that covers the entire domain of side $L$.\n    *   **Level 1:** An intermediate cubic grid with spacing $\\Delta x_1$ that covers a smaller region of side length $L/C_1$ centered within the domain.\n    *   **Level 2:** A fine cubic grid with spacing $\\Delta x_2$ that covers the innermost region of side length $L/C_2$ where the black holes are located.\n\n    The grid spacing between successive levels is related by a constant refinement factor, $r$, such that $\\Delta x_{k+1} = \\Delta x_k / r$. The finest grid must resolve the smallest physical scale, so we set $\\Delta x_2 = \\delta$. For the purposes of this problem, assume the total number of grid cells in the AMR grid, $N_\\text{AMR}$, is the sum of the cells at each of the three individual grid levels.\n\nGiven the dimensionless parameters $r=2$, $C_1=4$, and $C_2=32$, calculate the ratio $N_\\text{unif} / N_\\text{AMR}$. This ratio represents the factor by which the total number of computational cells is reduced by using this specific AMR strategy compared to a uniform grid. Round your final answer to three significant figures.", "solution": "We require the total number of 3D grid cells for each strategy.\n\nUniform grid:\nTo resolve the smallest feature size everywhere, set $\\Delta x=\\delta$. The number of cells per side is $L/\\delta$, so the total number of cells is\n$$\nN_\\text{unif}=\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\n\nAMR grid:\nThe refinement relation is $\\Delta x_{k+1}=\\Delta x_{k}/r$, with $\\Delta x_{2}=\\delta$. Thus\n$$\n\\Delta x_{1}=r\\,\\delta,\\qquad \\Delta x_{0}=r^{2}\\delta.\n$$\nThe number of cells at each level is the region side length divided by the level spacing, cubed:\n$$\nN_{0}=\\left(\\frac{L}{\\Delta x_{0}}\\right)^{3}=\\left(\\frac{L}{r^{2}\\delta}\\right)^{3}=r^{-6}\\left(\\frac{L}{\\delta}\\right)^{3},\n$$\n$$\nN_{1}=\\left(\\frac{L/C_{1}}{\\Delta x_{1}}\\right)^{3}=\\left(\\frac{L}{C_{1}r\\delta}\\right)^{3}=C_{1}^{-3}r^{-3}\\left(\\frac{L}{\\delta}\\right)^{3},\n$$\n$$\nN_{2}=\\left(\\frac{L/C_{2}}{\\Delta x_{2}}\\right)^{3}=\\left(\\frac{L}{C_{2}\\delta}\\right)^{3}=C_{2}^{-3}\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\nSumming levels (as specified),\n$$\nN_\\text{AMR}=N_{0}+N_{1}+N_{2}=\\left[r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}\\right]\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\nTherefore the ratio is\n$$\n\\frac{N_\\text{unif}}{N_\\text{AMR}}=\\frac{\\left(L/\\delta\\right)^{3}}{\\left[r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}\\right]\\left(L/\\delta\\right)^{3}}=\\frac{1}{r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}}.\n$$\nWith $r=2$, $C_{1}=4$, $C_{2}=32$,\n$$\nr^{-6}=\\frac{1}{64},\\quad C_{1}^{-3}r^{-3}=\\frac{1}{64}\\cdot\\frac{1}{8}=\\frac{1}{512},\\quad C_{2}^{-3}=\\frac{1}{32768},\n$$\nso\n$$\n\\frac{N_\\text{unif}}{N_\\text{AMR}}=\\frac{1}{\\frac{1}{64}+\\frac{1}{512}+\\frac{1}{32768}}=\\frac{1}{\\frac{577}{32768}}=\\frac{32768}{577}\\approx 56.790\\ldots\n$$\nRounded to three significant figures, the ratio is $56.8$.", "answer": "$$\\boxed{56.8}$$", "id": "1814393"}, {"introduction": "When Einstein's equations are formulated for computer simulation, they come with built-in consistency checks known as constraints. Numerical errors can cause the solution to drift away from satisfying these constraints, a dangerous effect called constraint violation. To ensure stability, modern codes add 'constraint damping' terms that guide the solution back on track. This exercise [@problem_id:1814401] explores a simplified toy model that brilliantly illustrates the core mechanism, showing how these terms cause constraint violations to propagate away and decay exponentially over time.", "problem": "In numerical relativity, the Einstein field equations are often cast into a system of first-order partial differential equations that describe the time evolution of geometric quantities. A critical feature of these equations is the existence of constraint equations, such as the Hamiltonian and momentum constraints, which must be satisfied at all times. However, numerical methods can introduce errors that cause solutions to drift away from the \"constraint surface\" where these constraints are zero. This phenomenon is known as constraint violation.\n\nTo combat this, modern evolution schemes often incorporate \"constraint damping\" terms. These are carefully chosen additions to the evolution equations designed to actively drive the constraint violations back towards zero.\n\nConsider a simplified one-dimensional toy model that mimics this behavior. The system is described by three fields: $\\phi(x,t)$, $\\Pi(x,t)$, and an auxiliary field $K(x,t)$. The \"constraint\" in this model is defined as the quantity $C(x,t) = K(x,t) - \\frac{\\partial \\phi}{\\partial x}(x,t)$. For a physically exact solution, this constraint must be zero everywhere for all time.\n\nTo ensure stability, the evolution equations for the fields are modified with damping terms as follows:\n1.  $\\frac{\\partial \\phi}{\\partial t} = \\Pi + \\alpha C$\n2.  $\\frac{\\partial \\Pi}{\\partial t} = \\frac{\\partial K}{\\partial x}$\n3.  $\\frac{\\partial K}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C$\n\nHere, $\\alpha$ and $\\beta$ are positive real constants representing the strength of the damping and propagation of the constraint.\n\nSuppose that at time $t=0$, a small, localized numerical error results in an initial constraint violation given by a Gaussian profile:\n$$C(x,0) = C_0 \\exp\\left(-\\frac{x^2}{w^2}\\right)$$\nwhere $C_0$ is the initial amplitude of the violation and $w$ is its characteristic width.\n\nDerive the analytical expression for the constraint violation, $C(x,t)$, for all subsequent times $t > 0$.", "solution": "We begin with the definition of the constraint $C(x,t) = K(x,t) - \\frac{\\partial \\phi}{\\partial x}(x,t)$. Differentiate this with respect to time and use the given evolution equations to obtain a closed equation for $C$.\n\nCompute the time derivative:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial K}{\\partial t} - \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\phi}{\\partial x}\\right).\n$$\nSubstitute the evolution equations $\\frac{\\partial K}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C$ and $\\frac{\\partial \\phi}{\\partial t} = \\Pi + \\alpha C$:\n$$\n\\frac{\\partial C}{\\partial t} = \\left(\\frac{\\partial \\Pi}{\\partial x} - \\beta C\\right) - \\frac{\\partial}{\\partial x}\\left(\\Pi + \\alpha C\\right).\n$$\nExpand the spatial derivative:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C - \\frac{\\partial \\Pi}{\\partial x} - \\alpha \\frac{\\partial C}{\\partial x}.\n$$\nCancel the $\\frac{\\partial \\Pi}{\\partial x}$ terms to obtain the linear first-order PDE:\n$$\n\\frac{\\partial C}{\\partial t} + \\alpha \\frac{\\partial C}{\\partial x} = -\\beta C.\n$$\n\nSolve this by the method of characteristics. Along characteristic curves defined by\n$$\n\\frac{d x}{d t} = \\alpha,\n$$\nthe constraint satisfies the ordinary differential equation\n$$\n\\frac{d C}{d t} = -\\beta C.\n$$\nIntegrating the characteristic equations gives $x(t) = x_{0} + \\alpha t$ and\n$$\nC(x(t),t) = C(x_{0},0)\\exp\\left(-\\beta t\\right).\n$$\nEliminate $x_{0}$ using $x_{0} = x - \\alpha t$ to write the general solution:\n$$\nC(x,t) = \\exp\\left(-\\beta t\\right) C(x - \\alpha t,0).\n$$\n\nApply the given initial condition $C(x,0) = C_{0} \\exp\\left(-\\frac{x^{2}}{w^{2}}\\right)$ to determine\n$$\nC(x,t) = C_{0} \\exp\\left(-\\beta t\\right) \\exp\\left(-\\frac{(x - \\alpha t)^{2}}{w^{2}}\\right).\n$$\nThis expression shows that the initial Gaussian constraint violation is advected with speed $\\alpha$ and damped at rate $\\beta$, retaining its Gaussian shape and width $w$ for all $t > 0$.", "answer": "$$\\boxed{C_{0}\\,\\exp\\left(-\\beta t\\right)\\,\\exp\\left(-\\frac{(x-\\alpha t)^{2}}{w^{2}}\\right)}$$", "id": "1814401"}, {"introduction": "A crucial step in developing any numerical relativity code is validation: proving it can correctly reproduce known physics before tackling the unknown. A standard benchmark is to evolve a static, spherically symmetric star, a configuration described by the Tolman-Oppenheimer-Volkoff (TOV) solution. In a perfect simulation, this star should remain perfectly still. This practice problem [@problem_id:1814400] asks you to identify the most fundamental quantities that should be monitored to confirm that the code is successfully maintaining the static nature of the spacetime and the hydrostatic equilibrium of the star, a core task in code verification.", "problem": "A researcher is testing a new numerical relativity code designed to solve Einstein's field equations for a self-gravitating perfect fluid. The code is based on a 3+1 decomposition of spacetime, where the spacetime metric $g_{\\mu\\nu}$ is split into a lapse function $\\alpha$, a shift vector $\\beta^i$, and a spatial 3-metric $\\gamma_{ij}$. The spacetime interval is given by $ds^2 = -\\alpha^2 dt^2 + \\gamma_{ij} (dx^i + \\beta^i dt)(dx^j + \\beta^j dt)$. The evolution system tracks the time evolution of $\\gamma_{ij}$ and the extrinsic curvature $K_{ij}$, which is related to the time derivative of the spatial metric. The perfect fluid is described by its rest-mass density $\\rho_0$, pressure $p$, and 3-velocity $v^i$ as measured by observers moving orthogonal to the spatial slices.\n\nAs a standard validation test, the researcher sets up initial data corresponding to a stable, static, non-rotating, spherically symmetric star. This configuration is an exact solution to the Tolman-Oppenheimer-Volkoff (TOV) equations. For such a solution, the spacetime is static, meaning there is a coordinate system where all metric and fluid variables are independent of time. In this coordinate system, the shift vector and the fluid's 3-velocity are identically zero ($\\beta^i = 0$, $v^i=0$).\n\nThe researcher then evolves this initial data forward in time. Due to numerical errors (truncation error, round-off error), the solution will not remain perfectly static. The goal is to monitor quantities that are most sensitive to any deviation from the exact static solution, which would indicate either a flaw in the code or the growth of an unstable mode.\n\nWhich of the following pairs of quantities provides the most direct and fundamental check on whether the numerical simulation is correctly maintaining the static nature of the spacetime and the hydrostatic equilibrium of the star?\n\nA. The central pressure $p_c$, and the total ADM (Arnowitt-Deser-Misner) gravitational mass of the spacetime, $M_G$.\n\nB. The maximum value of the time derivative of the lapse function across the grid, $\\max(|\\partial_t \\alpha|)$, and the magnitude of the time derivative of the central rest-mass density, $|\\partial_t \\rho_{0,c}|$.\n\nC. The L2-norm of the fluid's 3-velocity, $\\|v^i\\|_2 = \\sqrt{\\int (v_i v^i) \\sqrt{\\gamma} d^3x}$, and the L2-norm of the extrinsic curvature, $\\|K_{ij}\\|_2 = \\sqrt{\\int (K_{ij} K^{ij}) \\sqrt{\\gamma} d^3x}$.\n\nD. The value of the lapse function at the center of the star, $\\alpha_c$, and the determinant of the spatial metric, $\\det(\\gamma_{ij})$, at a fixed point on the star's surface.\n\nE. The total rest mass of the star, $M_0 = \\int \\rho_0 \\sqrt{\\gamma} d^3x$, and the maximum value of the Kretschmann scalar, $\\max(R_{abcd}R^{abcd})$, on the grid.", "solution": "We identify the defining conditions for a static, spherically symmetric, non-rotating Tolman-Oppenheimer-Volkoff (TOV) solution in a 3+1 decomposition. The line element is\n$$\nds^{2}=-\\alpha^{2} dt^{2}+\\gamma_{ij}(dx^{i}+\\beta^{i} dt)(dx^{j}+\\beta^{j} dt),\n$$\nwith lapse $\\alpha$, shift $\\beta^{i}$, and spatial metric $\\gamma_{ij}$. For a static spacetime, there exists a coordinate system adapted to a timelike Killing vector such that all fields are time independent:\n$$\n\\partial_{t} \\alpha=0,\\quad \\partial_{t} \\beta^{i}=0,\\quad \\partial_{t} \\gamma_{ij}=0.\n$$\nFor the non-rotating perfect fluid in hydrostatic equilibrium, the Eulerian 3-velocity vanishes,\n$$\nv^{i}=0,\n$$\nand spherical symmetry plus staticity imply $\\beta^{i}=0$ in the adapted coordinates.\n\nThe extrinsic curvature is defined in 3+1 form as\n$$\nK_{ij}=-\\frac{1}{2\\alpha}\\left(\\partial_{t}\\gamma_{ij}-\\mathcal{L}_{\\beta}\\gamma_{ij}\\right)\n=-\\frac{1}{2\\alpha}\\left(\\partial_{t}\\gamma_{ij}-D_{i}\\beta_{j}-D_{j}\\beta_{i}\\right),\n$$\nwhere $D_{i}$ is the covariant derivative compatible with $\\gamma_{ij}$ and $\\mathcal{L}_{\\beta}$ is the Lie derivative along $\\beta^{i}$. In the static, adapted frame with $\\partial_{t}\\gamma_{ij}=0$ and $\\beta^{i}=0$, one has\n$$\nK_{ij}=0.\n$$\nTherefore, exact staticity of the geometry is equivalent (in this slicing) to $K_{ij}\\equiv 0$ everywhere. Likewise, exact hydrostatic equilibrium with the fluid at rest with respect to Eulerian observers is characterized by\n$$\nv^{i}\\equiv 0.\n$$\n\nThese two vanishing conditions provide the most direct and fundamental diagnostics of deviations from the static TOV solution under time evolution. A global and sensitive way to monitor them is via their L2 norms over the slice,\n$$\n\\|v^{i}\\|_{2}=\\left(\\int v_{i}v^{i}\\sqrt{\\gamma}\\,d^{3}x\\right)^{\\frac{1}{2}},\\qquad\n\\|K_{ij}\\|_{2}=\\left(\\int K_{ij}K^{ij}\\sqrt{\\gamma}\\,d^{3}x\\right)^{\\frac{1}{2}},\n$$\nwhich vanish identically in the exact solution and increase with any spurious motion or geometric time dependence introduced by numerical errors.\n\nWe now assess the proposed options:\n\n- Option A monitors $p_{c}$ and $M_{G}$. The ADM mass $M_{G}$ is conserved in asymptotically flat spacetimes even during dynamical oscillations, so it is not a sensitive indicator of staticity. The central pressure $p_{c}$ can oscillate while the geometry remains correct, and being a single-point quantity it is less sensitive to localized deviations.\n\n- Option B uses $\\max(|\\partial_{t}\\alpha|)$ and $|\\partial_{t}\\rho_{0,c}|$. While a static solution has $\\partial_{t}\\alpha=0$ and $\\partial_{t}\\rho_{0}=0$ in an adapted static gauge, $\\partial_{t}\\alpha$ is gauge dependent and can be nonzero under common slicing conditions despite physical staticity. Monitoring only the central density time derivative misses off-center deviations.\n\n- Option C directly targets the fundamental staticity conditions $v^{i}=0$ and $K_{ij}=0$ through their L2 norms, providing global, highly sensitive, and physically transparent diagnostics of any departure from a static geometry and hydrostatic equilibrium.\n\n- Option D monitors $\\alpha_{c}$ and $\\det(\\gamma_{ij})$ at a point, both of which are strongly gauge dependent and not invariant indicators of staticity; single-point values are also poor global diagnostics.\n\n- Option E uses $M_{0}$ and $\\max(R_{abcd}R^{abcd})$. The rest mass $M_{0}$ is globally conserved (up to numerical atmosphere effects) regardless of staticity, and the Kretschmann scalar maximum is not uniquely tied to time independence and can be comparatively insensitive to small-amplitude oscillations.\n\nTherefore, the pair that most directly and fundamentally checks the maintenance of static spacetime and hydrostatic equilibrium is the L2 norms of the fluid 3-velocity and the extrinsic curvature, i.e., Option C.", "answer": "$$\\boxed{C}$$", "id": "1814400"}]}