{"hands_on_practices": [{"introduction": "The first Hohenberg-Kohn theorem and its associated variational principle form the theoretical bedrock of Density Functional Theory. The principle states that the energy calculated from any trial electron density $n_{trial}(\\vec{r})$ will always be greater than or equal to the true ground-state energy $E_0$. This exercise [@problem_id:1407256] presents a thought-provoking paradox to test your understanding of the subtle but crucial conditions under which this powerful principle holds true, particularly the concept of \"N-representability.\"", "problem": "An undergraduate student is exploring the foundations of Density Functional Theory (DFT). They decide to test the Hohenberg-Kohn (HK) variational principle on the simplest possible system: a single, non-relativistic hydrogen atom.\n\nThe external potential for the hydrogen atom is given by $v_{ext}(\\vec{r}) = -1/r$ in atomic units. The exact ground-state energy is known to be $E_0 = -0.5$ Hartrees. For a one-electron system, the total energy can be expressed as an exact functional of the electron density $n(\\vec{r})$:\n$$E[n] = T_s[n] + \\int v_{ext}(\\vec{r}) n(\\vec{r}) d^3\\vec{r}$$\nwhere $T_s[n]$ is the kinetic energy functional for a single non-interacting electron with density $n(\\vec{r})$.\n\nThe student performs two calculations using two different trial electron densities, $n_A(\\vec{r})$ and $n_B(\\vec{r})$.\n1.  Using the trial density $n_A(\\vec{r})$, the calculated energy is $E[n_A] = -0.46$ Hartrees.\n2.  Using the trial density $n_B(\\vec{r})$, the calculated energy is $E[n_B] = -0.53$ Hartrees.\n\nThe second result, where $E[n_B]  E_0$, appears to be a direct violation of the second Hohenberg-Kohn theorem (the variational principle), which states that any valid trial density must yield an energy greater than or equal to the true ground-state energy. Assuming the kinetic energy functional $T_s[n]$ was evaluated exactly and all numerical integrations were performed without error, what is the most fundamental theoretical reason for this paradoxical result?\n\nA. The Hohenberg-Kohn theorems are derived for many-electron systems and are known to fail for the special case of a one-electron system like hydrogen.\n\nB. The variational principle in DFT is only an approximation itself and does not guarantee a lower bound for the energy.\n\nC. The result must be due to the use of an approximate kinetic energy functional $T_s[n]$, as the exact form of this functional is unknown even for a single electron.\n\nD. The trial density $n_B(\\vec{r})$ is not a physically valid density for a one-electron system (i.e., it is not \"N-representable\"), thereby violating a crucial precondition for the variational principle to apply.\n\nE. Calculation B has uncovered a more stable electronic state for the hydrogen atom than was previously known, indicating that $E_0 = -0.5$ Hartrees is not the true ground state.", "solution": "We begin from the exact Hohenberg-Kohn variational formulation in the Levy-Lieb constrained-search form. For a given external potential $v(\\vec r)$ and particle number $N$, define the universal functional\n$$\nF[n] = \\min_{\\Psi \\to n} \\langle \\Psi | \\hat T + \\hat V_{ee} | \\Psi \\rangle,\n$$\nwhere the minimization is over all antisymmetric $N$-electron wavefunctions $\\Psi$ yielding the density $n(\\vec r)$. For any density $n$ that is $N$-representable (i.e., comes from at least one such $\\Psi$), the DFT energy functional is\n$$\nE_{v}[n] = F[n] + \\int v(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r.\n$$\nLet $\\Psi_{n}$ be a wavefunction that attains (or arbitrarily approaches) the minimum in the definition of $F[n]$. Then\n$$\nE_{v}[n] = \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} | \\Psi_{n} \\rangle + \\int v \\, n\n= \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} + \\hat V | \\Psi_{n} \\rangle \\ge E_{0},\n$$\nwhere $E_{0}$ is the exact ground-state energy and the inequality follows from the Rayleigh-Ritz principle. Hence, for every $N$-representable density $n$, one has\n$$\nE_{v}[n] \\ge E_{0}.\n$$\n\nSpecializing to a one-electron system, $\\hat V_{ee} = 0$ and\n$$\nF[n] = T_{s}[n] = \\min_{\\psi \\to n} \\langle \\psi | \\hat T | \\psi \\rangle = T_{W}[n],\n$$\nwith the exact Weizs√§cker functional\n$$\nT_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\vec r)|^{2}}{n(\\vec r)} \\, d^{3}\\vec r,\n$$\nprovided $n$ is $N$-representable and sufficiently regular so that $\\sqrt{n} \\in H^{1}(\\mathbb{R}^{3})$ (ensuring finite kinetic energy). Therefore, for any physically valid one-electron density $n$,\n$$\nE[n] = T_{s}[n] + \\int v_{ext}(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r \\ge E_{0}.\n$$\n\nIn the problem, $E[n_{B}]  E_{0}$ is obtained while assuming $T_{s}[n]$ is evaluated exactly and integrations are exact. The inequality above shows that such a result cannot occur for any $N$-representable one-electron density. Thus, the only remaining logical possibility is that $n_{B}$ is not a physically admissible one-electron density (fails $N$-representability or, equivalently for the HK variational bound via constrained search, lies outside the domain of $F[n]$). Typical violations include lack of nonnegativity, incorrect normalization to $N=1$, or insufficient regularity such that no wavefunction $\\psi$ with $|\\psi|^{2} = n_{B}$ and finite kinetic energy exists.\n\nEvaluating the options:\n- A is false: the HK theorems apply to any $N$, and for $N=1$ the functional is exactly known.\n- B is false: the DFT variational principle is rigorous for the constrained-search functional on its domain.\n- C is false: for $N=1$, $T_{s}[n]$ is exactly $T_{W}[n]$.\n- D is correct: the paradox arises because $n_{B}$ is not $N$-representable, invalidating the variational bound.\n- E is false: $E_{0}$ for hydrogen is exactly known and cannot be undercut by a physical density.\n\nTherefore, the fundamental theoretical reason is that the trial density $n_{B}$ is not $N$-representable.", "answer": "$$\\boxed{D}$$", "id": "1407256"}, {"introduction": "While the Hohenberg-Kohn theorems guarantee that a ground-state density exists, the Kohn-Sham method provides a practical recipe for finding it. This is done by mapping the complex many-electron system onto a simpler one of non-interacting electrons moving in an effective potential, $v_s(r)$. This practice [@problem_id:1999050] invites you to dissect this central potential, analyzing its components to understand its physical behavior at different length scales, from the deep pull of the nucleus to the subtle screening effects far away.", "problem": "In the framework of Density Functional Theory (DFT), the complex many-electron problem is mapped onto a simpler system of non-interacting electrons moving in an effective potential. For a spherically symmetric atom, this is the Kohn-Sham effective potential, $v_s(r)$, which is a function of the distance $r$ from the nucleus. It is defined as the sum of three terms:\n$v_s(r) = v_{ext}(r) + v_H(r) + v_{xc}(r)$\nwhere:\n- $v_{ext}(r)$ is the external potential due to the nucleus of charge $+Ze$, where $Z$ is the atomic number and $e$ is the elementary charge.\n- $v_H(r)$ is the Hartree potential, which represents the classical electrostatic repulsion from the total electron density distribution, $n(r)$.\n- $v_{xc}(r)$ is the exchange-correlation potential, which accounts for all many-body quantum effects beyond the classical Hartree repulsion.\n\nConsider a single, isolated, neutral Neon atom in its ground state. The atomic number of Neon is $Z=10$. Analyze the mathematical behavior of the Kohn-Sham effective potential $v_s(r)$ in the two limiting cases: very close to the nucleus ($r \\to 0$) and very far from the nucleus ($r \\to \\infty$).\n\nFor the purpose of simplifying the expressions, all quantities are given in atomic units, where the elementary charge $e$, the electron mass $m_e$, the reduced Planck constant $\\hbar$, and the Coulomb constant $k_e = 1/(4\\pi\\epsilon_0)$ are all set to 1. In these units, the potential from a point charge $q$ at a distance $r$ is simply $q/r$.\n\nWhich of the following statements correctly describes the asymptotic behavior of $v_s(r)$ for a neutral Neon atom?\n\nA. As $r \\to 0$, $v_s(r)$ behaves like $-10/r$. As $r \\to \\infty$, $v_s(r)$ approaches $0$.\n\nB. As $r \\to 0$, $v_s(r)$ behaves like $-9/r$. As $r \\to \\infty$, $v_s(r)$ behaves like $-1/r$.\n\nC. As $r \\to 0$, $v_s(r)$ behaves like $-10/r$. As $r \\to \\infty$, $v_s(r)$ behaves like $-1/r$.\n\nD. As $r \\to 0$, $v_s(r)$ approaches a finite, constant negative value. As $r \\to \\infty$, $v_s(r)$ approaches $0$.\n\nE. As $r \\to 0$, $v_s(r)$ behaves like $-10/r$. As $r \\to \\infty$, $v_s(r)$ behaves like $-1/r^2$.", "solution": "In Kohn-Sham density functional theory, the effective potential is the sum\n$$\nv_{s}(r)=v_{\\text{ext}}(r)+v_{H}(r)+v_{xc}(r).\n$$\nIn atomic units for a nucleus of charge $+Z$ at the origin,\n$$\nv_{\\text{ext}}(r)=-\\frac{Z}{r}.\n$$\nFor a spherically symmetric electron density $n(r)$, the Hartree potential can be written as\n$$\nv_{H}(r)=4\\pi\\left(\\frac{1}{r}\\int_{0}^{r}n(r')\\,r'^{2}\\,dr'+\\int_{r}^{\\infty}n(r')\\,r'\\,dr'\\right).\n$$\n\nLimit $r\\to 0$. The first Hartree term behaves as\n$$\n\\frac{4\\pi}{r}\\int_{0}^{r}n(r')\\,r'^{2}\\,dr'=\\frac{4\\pi n(0)}{r}\\int_{0}^{r}r'^{2}\\,dr'+\\text{higher orders}=\\frac{4\\pi n(0)}{3}r^{2}+O(r^{3}),\n$$\nwhich vanishes as $r\\to 0$. The second Hartree term approaches a finite constant,\n$$\n4\\pi\\int_{0}^{\\infty}n(r')\\,r'\\,dr',\n$$\nbecause $n(r')$ is finite at the origin and decays rapidly at large $r$. Thus $v_{H}(r)$ is finite at $r=0$. The exact exchange-correlation potential $v_{xc}(r)$ is also finite at the nucleus; the electron-nucleus Kato cusp condition ensures that the only $1/r$ singularity in $v_{s}(r)$ comes from $v_{\\text{ext}}(r)$. Therefore,\n$$\nv_{s}(r)=-\\frac{Z}{r}+O(1)\\quad\\text{as }r\\to 0.\n$$\nFor Neon, $Z=10$, hence\n$$\nv_{s}(r)\\sim -\\frac{10}{r}\\quad\\text{as }r\\to 0.\n$$\n\nLimit $r\\to\\infty$. Using the spherical expression above, for large $r$,\n$$\nv_{H}(r)=\\frac{1}{r}\\left[4\\pi\\int_{0}^{r}n(r')\\,r'^{2}\\,dr'\\right]+4\\pi\\int_{r}^{\\infty}n(r')\\,r'\\,dr'.\n$$\nLet $N=4\\pi\\int_{0}^{\\infty}n(r')\\,r'^{2}\\,dr'$ be the total number of electrons. Then as $r\\to\\infty$, the enclosed charge tends to $N$ and the tail integral vanishes faster than $1/r$, so\n$$\nv_{H}(r)=\\frac{N}{r}+o\\!\\left(\\frac{1}{r}\\right).\n$$\nHence\n$$\nv_{\\text{ext}}(r)+v_{H}(r)=-\\frac{Z}{r}+\\frac{N}{r}+o\\!\\left(\\frac{1}{r}\\right)=\\frac{N-Z}{r}+o\\!\\left(\\frac{1}{r}\\right).\n$$\nFor a neutral atom, $N=Z$, so the leading $1/r$ term cancels and $v_{\\text{ext}}(r)+v_{H}(r)=o(1/r)$. The exact exchange-correlation potential supplies the correct asymptotic behavior for finite systems, obeying the exchange-correlation hole sum rule $\\int n_{xc}(\\mathbf{r},\\mathbf{r}')\\,d\\mathbf{r}'=-1$, which yields\n$$\nv_{xc}(r)\\sim -\\frac{1}{r}\\quad\\text{as }r\\to\\infty.\n$$\nTherefore the full Kohn-Sham potential behaves as\n$$\nv_{s}(r)=v_{\\text{ext}}(r)+v_{H}(r)+v_{xc}(r)\\sim -\\frac{1}{r}\\quad\\text{as }r\\to\\infty.\n$$\n\nCombining both limits for a neutral Neon atom, one has $v_{s}(r)\\sim -10/r$ as $r\\to 0$ and $v_{s}(r)\\sim -1/r$ as $r\\to\\infty$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1999050"}, {"introduction": "A common point of confusion when first encountering the results of a Kohn-Sham DFT calculation is the physical meaning of the orbital energies, or eigenvalues, $\\epsilon_i$. It is tempting to assume that the total electronic energy of the system is simply the sum of the energies of all occupied orbitals, but this is incorrect. This exercise [@problem_id:1999063] guides you to uncover the precise relationship between the sum of eigenvalues and the total energy, revealing how electron-electron interactions are accounted for and preventing a common misinterpretation of DFT results.", "problem": "In the framework of Kohn-Sham (KS) Density Functional Theory (DFT), the total electronic energy of a ground-state N-electron system is given by the functional:\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\nHere, $T_s[\\rho]$ is the kinetic energy of a non-interacting reference system with the same density $\\rho$, $E_{ext}[\\rho]$ is the potential energy from the external potential (usually from atomic nuclei), $E_H[\\rho]$ is the classical electron-electron Coulomb repulsion energy (the Hartree energy), and $E_{xc}[\\rho]$ is the exchange-correlation energy, which contains all the non-classical many-body effects.\n\nThe electron density $\\rho(\\mathbf{r})$ is constructed from a set of single-particle orbitals, $\\phi_i$, as $\\rho(\\mathbf{r}) = \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2$. These orbitals are solutions to the KS equations:\n$$ \\left( -\\frac{\\hbar^2}{2m} \\nabla^2 + v_{eff}(\\mathbf{r}) \\right) \\phi_i(\\mathbf{r}) = \\epsilon_i \\phi_i(\\mathbf{r}) $$\nwhere $\\epsilon_i$ are the KS eigenvalues (orbital energies).\n\nFor a neutral nitrogen atom (N, atomic number Z=7), a DFT calculation yields the following occupied KS eigenvalues:\n$\\epsilon_{1s} = -381.5$ eV\n$\\epsilon_{2s} = -18.6$ eV\n$\\epsilon_{2p_x} = \\epsilon_{2p_y} = \\epsilon_{2p_z} = -8.1$ eV\n\nThe same calculation gives a total electronic energy of $E[\\rho] = -1483.2$ eV. The sum of the occupied KS eigenvalues is $\\sum_{i}^{occ} \\epsilon_i = 2 \\times (-381.5) + 2 \\times (-18.6) + 3 \\times (-8.1) = -824.5$ eV. This sum is clearly not equal to the total electronic energy.\n\nWhich of the following statements provides the correct physical reason for this discrepancy?\n\nA. The sum of the eigenvalues is physically meaningless, and its difference from the total energy is a computational artifact of the specific exchange-correlation functional used.\n\nB. The sum of the eigenvalues fails to properly account for the electron-electron interactions; specifically, it double-counts the classical Hartree repulsion energy and incorrectly represents the exchange-correlation energy contribution.\n\nC. The sum of the eigenvalues represents only the potential energy of the electrons, and the discrepancy arises from the complete omission of the electronic kinetic energy.\n\nD. The sum of the eigenvalues accurately represents all electron-electron and kinetic energy contributions, but it completely omits the interaction energy between the electrons and the nucleus.\n\nE. The total energy calculation is flawed because, by the Hellmann-Feynman theorem, the total energy must be equal to the sum of the orbital energies for any self-consistent calculation.", "solution": "The core of this problem is to understand the relationship between the Kohn-Sham (KS) total energy, $E[\\rho]$, and the sum of the occupied KS eigenvalues, $\\sum_i^{occ} \\epsilon_i$.\n\nLet's start with the expression for the total electronic energy in KS-DFT:\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\nwhere $T_s$ is the non-interacting kinetic energy, $E_{ext}$ is the electron-nucleus attraction energy, $E_H$ is the classical electron-electron (Hartree) repulsion energy, and $E_{xc}$ is the exchange-correlation energy.\n\nNow, let's analyze the sum of the occupied eigenvalues. The KS eigenvalue $\\epsilon_i$ is obtained from the KS equation:\n$$H_{KS} \\phi_i = \\epsilon_i \\phi_i$$\nwhere $H_{KS}$ is the KS Hamiltonian. The eigenvalue $\\epsilon_i$ is the expectation value of the KS Hamiltonian with respect to the orbital $\\phi_i$:\n$$ \\epsilon_i = \\langle \\phi_i | H_{KS} | \\phi_i \\rangle $$\nThe KS Hamiltonian is defined as $H_{KS} = T_{op} + v_{eff}(\\mathbf{r})$, where $T_{op} = -\\frac{\\hbar^2}{2m} \\nabla^2$ is the kinetic energy operator and $v_{eff}$ is the effective potential. The effective potential is given by:\n$$ v_{eff}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r}) $$\nHere, $v_{ext}$ is the external potential, $v_H(\\mathbf{r}) = \\frac{\\delta E_H}{\\delta \\rho}$ is the Hartree potential, and $v_{xc}(\\mathbf{r}) = \\frac{\\delta E_{xc}}{\\delta \\rho}$ is the exchange-correlation potential.\n\nThe sum of the occupied eigenvalues is therefore:\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} + v_{ext} + v_H + v_{xc} | \\phi_i \\rangle $$\nWe can separate the terms:\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle $$\n\nLet's identify each of these summed terms with the components of the total energy functional:\n1.  $\\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle = T_s[\\rho]$, the non-interacting kinetic energy.\n2.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle = \\int \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2 v_{ext}(\\mathbf{r}) d\\mathbf{r} = \\int \\rho(\\mathbf{r}) v_{ext}(\\mathbf{r}) d\\mathbf{r} = E_{ext}[\\rho]$, the electron-nucleus attraction energy.\n3.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$. The Hartree energy functional is $E_H[\\rho] = \\frac{1}{2} \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$. This factor of $\\frac{1}{2}$ is crucial; it prevents double-counting the interaction between pairs of electrons. Therefore, the term in the eigenvalue sum is exactly twice the Hartree energy: $\\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r} = 2E_H[\\rho]$.\n4.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}$. This term is the expectation value of the exchange-correlation potential, which is generally not equal to the exchange-correlation energy functional, $E_{xc}[\\rho]$.\n\nSo, the sum of the eigenvalues is:\n$$ \\sum_{i=1}^{N} \\epsilon_i = T_s[\\rho] + E_{ext}[\\rho] + 2E_H[\\rho] + \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r} $$\n\nNow, we compare this to the total energy expression:\n$$ E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho] $$\n\nThe discrepancy arises from two terms related to electron-electron interactions:\n- The sum of eigenvalues contains $2E_H[\\rho]$, while the total energy contains $E_H[\\rho]$. The eigenvalue sum double-counts the classical Coulomb repulsion.\n- The sum of eigenvalues contains the term $\\int \\rho v_{xc} d\\mathbf{r}$, while the total energy contains the exchange-correlation energy $E_{xc}[\\rho]$. These are not the same.\n\nTherefore, the relationship between the total energy and the sum of eigenvalues is:\n$$ E[\\rho] = \\sum_{i=1}^{N} \\epsilon_i - E_H[\\rho] + (E_{xc}[\\rho] - \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}) $$\n\nThe sum of eigenvalues is not the total energy because it improperly accounts for electron-electron interactions. Let's evaluate the given options:\nA. Incorrect. The sum of eigenvalues has a physical meaning (related to the total energy via the aequation above) and is not just a computational artifact.\nB. Correct. This statement accurately identifies that the sum of eigenvalues double-counts the Hartree energy and incorrectly treats the exchange-correlation energy contribution. This is the precise reason for the discrepancy.\nC. Incorrect. The sum of eigenvalues explicitly includes the kinetic energy term, $T_s[\\rho]$.\nD. Incorrect. The sum of eigenvalues explicitly includes the electron-nucleus interaction energy, $E_{ext}[\\rho]$.\nE. Incorrect. The Hellmann-Feynman theorem relates the derivative of the total energy to the expectation value of the derivative of the Hamiltonian, which is a different concept. There is no general theorem stating that the total energy must equal the sum of orbital energies in KS-DFT (this is only true for non-interacting particles or in Hartree-Fock theory where Koopmans' theorem provides a link, but even there the sum of orbital energies is not the total energy).", "answer": "$$\\boxed{B}$$", "id": "1999063"}]}