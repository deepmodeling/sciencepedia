{"hands_on_practices": [{"introduction": "A common starting point for students in quantum mechanics is the particle in an infinite potential well, which has conveniently simple sinusoidal solutions. However, when we transition to the more physically realistic finite potential well, we must re-evaluate our assumptions. This exercise challenges you to consider why the simple solutions for the infinite well are not sufficient, forcing you to focus on the crucial boundary conditions that govern all quantum wavefunctions [@problem_id:2036033]. Understanding which physical requirement is violated is the first step toward constructing the true solutions for the finite well.", "problem": "An undergraduate student is studying a one-dimensional quantum system consisting of a particle of mass $m$ in a symmetric finite potential well. The potential energy $V(x)$ is defined as:\n$$\nV(x) = \\begin{cases} 0  \\text{for } |x|  a \\\\ V_0  \\text{for } |x| \\ge a \\end{cases}\n$$\nwhere $V_0$ is a positive constant.\n\nDrawing from their knowledge of the particle in an infinite box, the student proposes a wavefunction for a possible energy eigenstate of the finite well:\n$$\n\\psi_{\\text{guess}}(x) = \\begin{cases} C \\sin\\left(\\frac{\\pi x}{a}\\right)  \\text{for } |x| \\le a \\\\ 0  \\text{for } |x|  a \\end{cases}\n$$\nwhere $C$ is a normalization constant. While this function resembles an eigenstate, it is not a physically valid solution for the finite potential well problem.\n\nWhich of the following fundamental requirements for a physically acceptable wavefunction is violated by $\\psi_{\\text{guess}}(x)$?\n\nA. The wavefunction must be normalizable.\n\nB. The wavefunction must be a solution to the Time-Independent Schrödinger Equation (TISE) in the region where the potential is zero.\n\nC. The wavefunction must be continuous everywhere.\n\nD. The first derivative of the wavefunction must be continuous everywhere the potential is finite.\n\nE. The energy eigenvalue corresponding to the wavefunction must be less than the potential barrier $V_0$.", "solution": "We are given a finite square well\n$$\nV(x)=\\begin{cases}\n0  \\text{for } |x|a\\\\\nV_{0}  \\text{for } |x|\\ge a\n\\end{cases}\n$$\nand the proposed wavefunction\n$$\n\\psi_{\\text{guess}}(x)=\\begin{cases}\nC\\sin\\!\\left(\\frac{\\pi x}{a}\\right)  \\text{for } |x|\\le a\\\\\n0  \\text{for } |x|a\n\\end{cases}.\n$$\nA physically acceptable stationary-state wavefunction must satisfy the following in one dimension:\n- It must be normalizable, i.e., $\\int_{-\\infty}^{\\infty}|\\psi(x)|^{2}\\,dx\\infty$.\n- It must satisfy the time-independent Schrödinger equation (TISE) in each region:\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi}{dx^{2}}+V(x)\\psi=E\\psi.\n$$\n- It must be continuous everywhere.\n- Its first derivative must be continuous at every point where $V(x)$ is finite (equivalently, where there is no delta-like singularity), which follows from integrating the TISE across a small interval around such a point.\n\nWe now test $\\psi_{\\text{guess}}$ against each requirement.\n\n1) Normalizability:\nSince $\\psi_{\\text{guess}}(x)=0$ for $|x|a$ and is bounded for $|x|\\le a$, we have\n$$\n\\int_{-\\infty}^{\\infty}|\\psi_{\\text{guess}}(x)|^{2}\\,dx\n=|C|^{2}\\int_{-a}^{a}\\sin^{2}\\!\\left(\\frac{\\pi x}{a}\\right)\\,dx\\infty,\n$$\nso a finite normalization constant $C$ exists. Thus normalizability is satisfied.\n\n2) Satisfaction of the TISE in the region $|x|a$ where $V=0$:\nFor $|x|\\le a$, compute\n$$\n\\frac{d^{2}}{dx^{2}}\\left[\\sin\\!\\left(\\frac{\\pi x}{a}\\right)\\right]\n=-\\left(\\frac{\\pi}{a}\\right)^{2}\\sin\\!\\left(\\frac{\\pi x}{a}\\right).\n$$\nThus\n$$\n-\\frac{\\hbar^{2}}{2m}\\psi_{\\text{guess}}''(x)\n=-\\frac{\\hbar^{2}}{2m}\\left[-\\left(\\frac{\\pi}{a}\\right)^{2}\\right]C\\sin\\!\\left(\\frac{\\pi x}{a}\\right)\n=\\frac{\\hbar^{2}\\pi^{2}}{2ma^{2}}\\psi_{\\text{guess}}(x).\n$$\nTherefore, in the region $|x|a$, the TISE is satisfied with energy\n$$\nE=\\frac{\\hbar^{2}\\pi^{2}}{2ma^{2}}.\n$$\n\n3) Continuity of the wavefunction:\nEvaluate at the boundaries. At $x=a$, inside value is $C\\sin(\\pi)=0$ and outside value is $0$, so $\\psi$ is continuous at $x=a$. Similarly at $x=-a$, $C\\sin(-\\pi)=0$ matches the outside value $0$. Hence continuity holds.\n\n4) Continuity of the first derivative at finite potential steps:\nFrom the TISE,\n$$\n-\\frac{\\hbar^{2}}{2m}\\psi''+(V-E)\\psi=0\\quad\\Rightarrow\\quad\n\\psi''=\\frac{2m}{\\hbar^{2}}(V-E)\\psi.\n$$\nIntegrate from $a-\\epsilon$ to $a+\\epsilon$:\n$$\n\\psi'(a+\\epsilon)-\\psi'(a-\\epsilon)\n=\\int_{a-\\epsilon}^{a+\\epsilon}\\frac{2m}{\\hbar^{2}}(V-E)\\psi\\,dx.\n$$\nIf $V$ is finite and $\\psi$ is finite at $x=a$, then the integrand is bounded and the integral tends to $0$ as $\\epsilon\\to 0$. Therefore,\n$$\n\\psi'(a^{+})=\\psi'(a^{-}),\n$$\nand the same applies at $x=-a$. Thus $\\psi'$ must be continuous at $x=\\pm a$ for a finite potential step.\n\nFor $\\psi_{\\text{guess}}$,\n- Inside derivative for $|x|a$:\n$$\n\\psi_{\\text{guess}}'(x)=C\\frac{\\pi}{a}\\cos\\!\\left(\\frac{\\pi x}{a}\\right).\n$$\nHence\n$$\n\\psi_{\\text{guess}}'(a^{-})=C\\frac{\\pi}{a}\\cos(\\pi)=-C\\frac{\\pi}{a},\\quad\n\\psi_{\\text{guess}}'((-a)^{+})=C\\frac{\\pi}{a}\\cos(-\\pi)=-C\\frac{\\pi}{a}.\n$$\n- Outside for $|x|a$, $\\psi_{\\text{guess}}(x)=0$ identically, so\n$$\n\\psi_{\\text{guess}}'(a^{+})=0,\\quad \\psi_{\\text{guess}}'((-a)^{-})=0.\n$$\nThus there is a jump in the first derivative at $x=\\pm a$, violating the required continuity of $\\psi'$ at finite potential.\n\n5) On the condition $EV_{0}$:\nFor bound states in this finite well, one indeed requires $EV_{0}$. The energy implied by the inside sinusoid is $E=\\hbar^{2}\\pi^{2}/(2ma^{2})$, which may or may not be less than $V_{0}$ depending on parameters; thus this is not the fundamental, universal violation in the proposed function. Moreover, even if $EV_{0}$, the derivative discontinuity persists.\n\nConclusion: The violated requirement is the continuity of the first derivative at points where the potential is finite, i.e., option D.", "answer": "$$\\boxed{D}$$", "id": "2036033"}, {"introduction": "Having established the boundary conditions, our next step is to develop a visual and conceptual understanding of the resulting wavefunctions. A key feature of the finite well is that the particle has a non-zero probability of being found in the \"classically forbidden\" region outside the well, a phenomenon known as quantum tunneling. This practice asks you to sketch the probability density for an excited state, which requires combining the concepts of parity, quantum nodes, and this characteristic exponential decay outside the well [@problem_id:2036006]. This skill of visualizing quantum states is fundamental to interpreting the behavior of atomic and molecular systems.", "problem": "An electron is confined within a one-dimensional symmetric finite potential well described by the potential energy function $V(x)$. The potential is zero for $|x|  L/2$ and has a constant positive value $V_0$ for $|x| \\ge L/2$. The electron is in the second excited state, which is the third bound energy eigenstate (labeled by the principal quantum number $n=3$). The energy of this state, $E_3$, is known to be less than $V_0$.\n\nLet $\\psi_3(x)$ be the time-independent wavefunction for this state. Which of the following statements provides the most accurate qualitative description of the corresponding probability density, $|\\psi_3(x)|^2$?\n\nA. The probability density has a single peak centered at $x=0$. The probability of finding the electron is strictly zero for all locations $|x| \\ge L/2$.\n\nB. The probability density has two distinct peaks located symmetrically about the origin and a node (a point of zero probability) at $x=0$. The probability of finding the electron is non-zero but decays exponentially in the regions where $|x| \\ge L/2$.\n\nC. The probability density is symmetric about $x=0$ and features three distinct peaks within the region $|x|  L/2$. It has two nodes inside this region. The probability of finding the electron is non-zero and decays exponentially toward zero in the regions where $|x| \\ge L/2$.\n\nD. The probability density is an odd function with respect to the origin ($x=0$). The probability density is strictly zero for all locations $|x| \\ge L/2$.\n\nE. The probability density has three distinct peaks within the region $|x|  L/2$. In the regions where $|x| \\ge L/2$, the probability density is non-zero and continues to oscillate with a small, constant amplitude.", "solution": "We consider the time-independent Schrödinger equation for a particle of mass $m$ in a one-dimensional potential $V(x)$:\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi(x)}{dx^{2}}+V(x)\\psi(x)=E\\psi(x).\n$$\nThe potential is symmetric, $V(x)=V(-x)$, with $V(x)=0$ for $|x|L/2$ and $V(x)=V_{0}$ for $|x|\\ge L/2$. For a bound state we have $EV_{0}$.\n\nBecause $V(x)$ is even, the Hamiltonian commutes with the parity operator, so energy eigenfunctions can be chosen with definite parity (even or odd). The general forms of the solutions in each region follow from the Schrödinger equation.\n\nInside the well, $|x|L/2$, where $V(x)=0$, the equation reduces to\n$$\n-\\frac{\\hbar^{2}}{2m}\\psi''(x)=E\\psi(x),\n$$\nwhose solutions are oscillatory with wave number\n$$\nk=\\frac{\\sqrt{2mE}}{\\hbar}.\n$$\nThus one may write, according to parity,\n$$\n\\psi_{\\text{in, even}}(x)=A\\cos(kx),\\qquad \\psi_{\\text{in, odd}}(x)=A\\sin(kx).\n$$\n\nOutside the well, $|x|\\ge L/2$, where $V(x)=V_{0}$ and $EV_{0}$, the equation becomes\n$$\n-\\frac{\\hbar^{2}}{2m}\\psi''(x)+(V_{0}-E)\\psi(x)=0,\n$$\nwhose solutions are exponential with decay constant\n$$\n\\kappa=\\frac{\\sqrt{2m\\left(V_{0}-E\\right)}}{\\hbar}.\n$$\nNormalizability requires exponential decay at infinity, so for large $|x|$,\n$$\n\\psi_{\\text{out}}(x)\\propto \\exp\\!\\big(-\\kappa |x|\\big),\n$$\nup to amplitudes fixed by continuity at $x=\\pm L/2$. Therefore the probability density outside is non-zero but decays exponentially toward zero:\n$$\n|\\psi(x)|^{2}\\propto \\exp\\!\\big(-2\\kappa |x|\\big)\\quad \\text{for }|x|\\ge L/2.\n$$\n\nParity and node structure distinguish the bound states. In a symmetric finite well the bound states alternate in parity: the ground state ($n=1$) is even and node-free inside; the first excited state ($n=2$) is odd with one node at $x=0$; the second excited state ($n=3$) is even again. An even-parity $n=3$ state has two nodes inside the well (symmetric about $x=0$), which creates three antinodes (peaks) of $|\\psi(x)|^{2}$ within $|x|L/2$. Since either even or odd $\\psi(x)$ yields an even probability density $|\\psi(x)|^{2}$, the probability density is symmetric about the origin.\n\nComparing to the options:\n- Statements that the probability is strictly zero for $|x|\\ge L/2$ describe the infinite well, not the finite well; thus such statements are incorrect here.\n- A node at $x=0$ corresponds to an odd-parity state ($n=2$), not the even $n=3$ state.\n- Exponential decay outside is the correct behavior for $EV_{0}$; continued oscillation outside would occur only for $EV_{0}$ and is not compatible with a bound state.\n\nTherefore, the accurate qualitative description for $n=3$ is: $|\\psi_{3}(x)|^{2}$ is symmetric about $x=0$, has three peaks within $|x|L/2$ with two internal nodes, and decays exponentially (but is non-zero) in the regions $|x|\\ge L/2$. This corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "2036006"}, {"introduction": "While qualitative sketches provide intuition, physics is a quantitative science. The precise energy levels of a particle in a finite well are determined by transcendental equations that cannot be solved with simple algebra. This final practice bridges the gap between abstract theory and practical application by guiding you through the numerical solution of these equations [@problem_id:2434189]. By using computational tools to find the allowed energy eigenvalues for a given potential, you will gain hands-on experience with the methods physicists use to make concrete predictions for real-world quantum systems.", "problem": "You are given a one-dimensional, symmetric finite square well potential defined by\n$$\nV(x) = \\begin{cases}\n- V_0,  |x| \\le a,\\\\\n0,  |x|  a,\n\\end{cases}\n$$\nwhere $V_0 > 0$ is the well depth and $a > 0$ is the half-width of the well. A non-relativistic quantum particle of mass $m$ has bound-state energy eigenvalues $E$ that satisfy $-V_0  E  0$. For such $E$, define the interior wavenumber $k$ and exterior decay constant $\\kappa$ by\n$$\nk = \\frac{\\sqrt{2 m (E + V_0)}}{\\hbar}, \\quad \\kappa = \\frac{\\sqrt{2 m (-E)}}{\\hbar}.\n$$\nBy enforcing wavefunction continuity and differentiability at $x = \\pm a$, the energy eigenvalues $E$ are characterized by the transcendental equations\n$$\n\\text{even parity:}\\quad k \\tan(k a) = \\kappa,\n$$\n$$\n\\text{odd parity:}\\quad -k \\cot(k a) = \\kappa.\n$$\nIntroduce the dimensionless variables $x = k a$ and $\\zeta = a \\sqrt{2 m V_0} / \\hbar$. Then the above equations can be rewritten as\n$$\n\\text{even:}\\quad x \\tan(x) = \\sqrt{\\zeta^2 - x^2}, \\quad \\text{for } x \\in \\big( m \\pi,\\, m \\pi + \\tfrac{\\pi}{2} \\big), \\, m \\in \\mathbb{Z}_{\\ge 0}, \\, x  \\zeta\n$$\n$$\n\\text{odd:}\\quad -x \\cot(x) = \\sqrt{\\zeta^2 - x^2}, \\quad \\text{for } x \\in \\big( m \\pi + \\tfrac{\\pi}{2},\\, (m + 1) \\pi \\big), \\, m \\in \\mathbb{Z}_{\\ge 0}, \\, x  \\zeta\n$$\nwith all trigonometric arguments in radians. Each admissible solution $x$ gives a bound-state energy\n$$\nE = \\frac{\\hbar^2}{2 m a^2} x^2 - V_0,\n$$\nwhich must satisfy $-V_0  E  0$ by construction.\n\nConstants and units:\n- Use $\\hbar = 1.054571817 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$, the reduced Planck constant.\n- Use the elementary charge $q_e = 1.602176634 \\times 10^{-19}\\,\\text{C}$ to convert between joules and electronvolts: $1\\,\\text{eV} = q_e\\,\\text{J}$.\n- All input lengths are in meters; all masses are in kilograms; all energies in the final output must be expressed in electronvolts (eV).\n- All trigonometric function arguments must be interpreted in radians.\n\nTask:\nFor each parameter set in the test suite below, determine all bound-state energy eigenvalues $E$ that satisfy the above transcendental equations, and report them in electronvolts as floating-point numbers rounded to $6$ decimal places. Report energies in ascending order (that is, from the most negative to the least negative). If there are no bound states, report an empty list for that case.\n\nTest suite (each case is a triple ($m, V_0, a$)):\n- Case $1$: $m = m_e$, $V_0 = 10.0\\,\\text{eV}$, $a = 0.5 \\times 10^{-9}\\,\\text{m}$,\n- Case $2$: $m = 0.067\\, m_e$, $V_0 = 0.3\\,\\text{eV}$, $a = 5.0 \\times 10^{-9}\\,\\text{m}$,\n- Case $3$: $m = m_e$, $V_0 = 2.0\\,\\text{eV}$, $a = 0.2 \\times 10^{-9}\\,\\text{m}$,\n\nwhere $m_e = 9.1093837015 \\times 10^{-31}\\,\\text{kg}$ is the electron rest mass.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a bracketed, comma-separated list of the bound-state energies (in electronvolts) for the corresponding test case, rounded to $6$ decimal places. For example, a valid structural format is\n$$\n\\big[ [E_{1,1}, E_{1,2}, \\dots], [E_{2,1}, \\dots], [E_{3,1}, \\dots] \\big],\n$$\nand the exact output must be printed without any spaces or explanatory text, for instance\n$$\n[[E_{1,1},E_{1,2}],[E_{2,1},E_{2,2},E_{2,3}],[E_{3,1}]].\n$$", "solution": "The problem presented is a standard exercise in quantum mechanics: determining the bound-state energy eigenvalues for a particle in a one-dimensional finite square well potential. This task is scientifically sound, well-posed, and all necessary physical constants and parameters are provided. The formulation is self-contained and mathematically consistent. Therefore, the problem is valid, and a solution will be provided.\n\nThe core of the problem is to solve two transcendental equations that arise from applying boundary conditions to the solutions of the time-independent Schrödinger equation. These equations characterize the allowed energies for states of even and odd parity, respectively.\n\nThe potential is given by\n$$\nV(x) = \\begin{cases}\n-V_0,  |x| \\le a \\\\\n0,  |x|  a\n\\end{cases}\n$$\nfor a particle of mass $m$, where $V_0 > 0$ and $a > 0$. For bound states, the energy $E$ must be in the range $-V_0  E  0$.\n\nThe analysis is greatly simplified by introducing the dimensionless variables $x = ka$ and $\\zeta = a \\sqrt{2 m V_0} / \\hbar$, where $k = \\sqrt{2m(E+V_0)}/\\hbar$ is the wavenumber inside the well. The parameter $\\zeta$ represents the \"strength\" of the potential well, combining its depth $V_0$ and half-width $a$. With these variables, the transcendental equations become:\n$$\n\\text{Even parity states:}\\quad x \\tan(x) = \\sqrt{\\zeta^2 - x^2}\n$$\n$$\n\\text{Odd parity states:}\\quad -x \\cot(x) = \\sqrt{\\zeta^2 - x^2}\n$$\nThe constraint on energy, $-V_0  E  0$, translates to the condition $0  x  \\zeta$. Each solution $x$ corresponds to a unique energy eigenvalue given by:\n$$\nE = \\frac{\\hbar^2 x^2}{2 m a^2} - V_0\n$$\nOur task is to find all solutions $x$ for each given set of parameters $(m, V_0, a)$, and then compute the corresponding energies $E$.\n\nThe algorithmic approach to solving this problem is as follows:\n\n1.  **Parameter Calculation**: For each test case, we first compute the dimensionless well strength $\\zeta$. All input parameters ($m, V_0, a$) and physical constants ($\\hbar, q_e, m_e$) must be converted to a consistent system of units, the International System of Units (SI), before calculation. The potential depth $V_0$, given in electronvolts (eV), is converted to joules (J) using the elementary charge $q_e$.\n\n2.  **Root-Finding Strategy**: The solutions for $x$ are the roots of the functions $f_e(x) = x \\tan(x) - \\sqrt{\\zeta^2 - x^2}$ and $f_o(x) = -x \\cot(x) - \\sqrt{\\zeta^2 - x^2}$. A graphical analysis shows that the solutions are ordered and lie in distinct intervals. The $n$-th energy state (with $n=1$ being the ground state) has a corresponding dimensionless wavenumber $x_n$ that lies in the interval $((n-1)\\pi/2, n\\pi/2)$.\n    - States with odd index $n = 1, 3, 5, \\dots$ are of even parity and are solutions to $f_e(x) = 0$.\n    - States with even index $n = 2, 4, 6, \\dots$ are of odd parity and are solutions to $f_o(x) = 0$.\n\n    We can systematically find all roots by iterating through the state index $n=1, 2, 3, \\ldots$ and searching for a root within the appropriate interval, as long as the start of the interval $(n-1)\\pi/2$ is less than $\\zeta$. The search for a root $x$ is confined to the range $[(n-1)\\pi/2, \\min(n\\pi/2, \\zeta)]$.\n\n3.  **Numerical Method**: A robust numerical root-finding algorithm is required. The Brent-Dekker method (available in SciPy as `brentq`) is an excellent choice. It is a hybrid bracketing method that guarantees convergence if the function values at the endpoints of the search interval have opposite signs.\n    - For even parity states, the function $f_e(x)$ changes sign from negative to positive over the interval $(m\\pi, m\\pi+\\pi/2)$, where $m = (n-1)/2$.\n    - For odd parity states, the function $f_o(x)$ changes sign from negative to positive over the interval $(m\\pi+\\pi/2, (m+1)\\pi)$, where $m=(n-2)/2$.\n    This sign-change property ensures the reliability of the `brentq` method. To avoid singularities of $\\tan(x)$ and $\\cot(x)$ at the interval boundaries, the search bracket is slightly contracted, for example, by a small amount $\\epsilon$.\n\n4.  **Energy Calculation and Finalization**: For each root $x_n$ found, the corresponding energy $E_n$ is calculated in joules using the formula derived earlier. This energy is then converted to electronvolts by dividing by $q_e$. The resulting energies for each test case are sorted in ascending order (which is naturally produced by finding roots $x_n$ for increasing $n$) and rounded to $6$ decimal places as required. The final output is formatted as a list of lists.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Finds the bound-state energy eigenvalues for a 1D finite square well.\n    \"\"\"\n    # Physical constants in SI units\n    hbar = 1.054571817e-34  # Reduced Planck constant (J*s)\n    m_e = 9.1093837015e-31   # Electron rest mass (kg)\n    q_e = 1.602176634e-19    # Elementary charge (C)\n\n    test_cases = [\n        # Case 1: (m, V0, a)\n        (m_e, 10.0, 0.5e-9),\n        # Case 2: (m, V0, a)\n        (0.067 * m_e, 0.3, 5.0e-9),\n        # Case 3: (m, V0, a)\n        (m_e, 2.0, 0.2e-9),\n    ]\n\n    all_results = []\n    for m, V0_eV, a in test_cases:\n        energies = find_bound_state_energies(m, V0_eV, a, hbar, q_e)\n        all_results.append(energies)\n\n    # Format the final output string as per problem specification\n    results_str = []\n    for res_list in all_results:\n        formatted_list = [f\"{e:.6f}\" for e in res_list]\n        results_str.append(f\"[{','.join(formatted_list)}]\")\n    final_output = f\"[{','.join(results_str)}]\"\n    print(final_output)\n\ndef find_bound_state_energies(m, V0_eV, a, hbar, q_e):\n    \"\"\"\n    Calculates all bound state energies for a given set of parameters.\n    \"\"\"\n    if V0_eV = 0:\n        return []\n\n    V0_J = V0_eV * q_e\n    \n    # Calculate the dimensionless well strength parameter zeta\n    zeta = (a * np.sqrt(2 * m * V0_J)) / hbar\n\n    solutions_x = []\n    n = 1\n    epsilon = 1e-12  # Small offset to avoid singularities\n\n    while True:\n        lower_bound = (n - 1) * np.pi / 2\n        upper_bound = n * np.pi / 2\n\n        if lower_bound = zeta:\n            break\n\n        # Define search bracket, ensuring it's within [0, zeta] and avoids singularities\n        bracket_start = lower_bound + epsilon\n        bracket_end = min(upper_bound - epsilon, zeta - epsilon)\n\n        if bracket_start = bracket_end:\n            # If the search interval is invalid or too small, stop for this n\n            # This can happen if upper_bound is very close to or less than lower_bound\n            # or if zeta is reached.\n            n += 1\n            if bracket_end  zeta - epsilon: # Case where upper_bound is reached earlier\n                continue\n            else: # Case where zeta limit is reached\n                break\n\n        try:\n            if n % 2 == 1:  # Even parity states (n=1, 3, 5, ...)\n                # Equation: x * tan(x) - sqrt(zeta^2 - x^2) = 0\n                func = lambda x: x * np.tan(x) - np.sqrt(zeta**2 - x**2)\n                sol = root_scalar(func, bracket=[bracket_start, bracket_end], method='brentq')\n                if sol.converged:\n                    solutions_x.append(sol.root)\n            else:  # Odd parity states (n=2, 4, 6, ...)\n                # Equation: -x * cot(x) - sqrt(zeta^2 - x^2) = 0\n                # Use cot(x) = 1/tan(x)\n                # This check ensures we don't divide by zero near multiples of pi,\n                # which are avoided by the epsilon-contracted bracket.\n                func = lambda x: -x / np.tan(x) - np.sqrt(zeta**2 - x**2)\n                sol = root_scalar(func, bracket=[bracket_start, bracket_end], method='brentq')\n                if sol.converged:\n                    solutions_x.append(sol.root)\n        except ValueError:\n            # This can happen if the function does not cross zero in the bracket,\n            # which might occur at the last possible state near x=zeta.\n            # We can check this scenario manually.\n            h_start = func(bracket_start)\n            h_end = func(bracket_end)\n            if h_start * h_end  0:\n                # No root in this interval, and since it's the last one, we're done.\n                pass\n            else:\n                 # Another issue occurred; for this problem we can assume it means no more roots\n                 pass\n        \n        n += 1\n\n    # Calculate energies from solutions x\n    energies_eV = []\n    if solutions_x:\n        # Precompute the energy conversion constant\n        energy_const = hbar**2 / (2 * m * a**2 * q_e)\n        for x_sol in solutions_x:\n            E = energy_const * x_sol**2 - V0_eV\n            energies_eV.append(E)\n\n    # Energies are naturally sorted as x is found in increasing order.\n    # We round them as the final step.\n    return [round(e, 6) for e in energies_eV]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2434189"}]}