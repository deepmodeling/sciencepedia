{"hands_on_practices": [{"introduction": "The cornerstone of the Abelian-Higgs model is the mechanism by which a gauge boson acquires mass through spontaneous symmetry breaking. This exercise takes you to the heart of that process. By applying the Euler-Lagrange equations to the Lagrangian, you will derive the effective equation of motion for the gauge field and see precisely how its interaction with the Higgs condensate gives rise to a mass term, transforming the familiar Maxwell equations into the Proca equation for a massive vector field. [@problem_id:1093426]", "problem": "Consider the Abelian-Higgs model in $(3+1)$-dimensional Minkowski spacetime with metric signature $(+,-,-,-)$. The dynamics of the system are described by the Lagrangian density:\n$$ \\mathcal{L} = -\\frac{1}{4} F_{\\mu\\nu}F^{\\mu\\nu} + (D_\\mu \\phi)^* (D^\\mu \\phi) - V(\\phi) $$\nwhere $\\phi$ is a complex scalar field, and $A_\\mu$ is a U(1) gauge field. The field strength tensor is $F_{\\mu\\nu} = \\partial_\\mu A_\\nu - \\partial_\\nu A_\\mu$, and the covariant derivative is $D_\\mu = \\partial_\\mu + iqA_\\mu$, with $q$ being the coupling constant (charge). The potential is given by $V(\\phi) = -\\mu^2 |\\phi|^2 + \\lambda (|\\phi|^2)^2$, with $\\mu^2  0$ and $\\lambda  0$, which leads to spontaneous symmetry breaking.\n\nAfter spontaneous symmetry breaking, the scalar field acquires a non-zero vacuum expectation value (VEV). By choosing the unitary gauge, the scalar field can be expressed in terms of its real VEV, $v$, and a real scalar fluctuation field, $h(x)$, as:\n$$ \\phi(x) = \\frac{1}{\\sqrt{2}}(v+h(x)) $$\nThe Euler-Lagrange equation for the gauge field $A_\\nu$, derived from this Lagrangian, can be expressed in a form analogous to Maxwell's equations with a source:\n$$ \\partial_\\mu F^{\\mu\\nu} = J_{\\text{eff}}^\\nu $$\nDetermine the expression for the effective four-current $J_{\\text{eff}}^\\nu$. Your answer should be in terms of the Higgs fluctuation field $h(x)$, the gauge field $A^\\nu(x)$, the VEV $v$, and the charge $q$.", "solution": "1. Euler–Lagrange for A_ν:\nThe equation of motion for the gauge field is $\\partial_\\mu F^{\\mu\\nu} = J^\\nu_{\\text{eff}}$, where the effective current is given by $J^\\nu_{\\text{eff}} = - \\frac{\\partial \\mathcal{L}_{\\text{mat}}}{\\partial A_\\nu}$.\n\n2. Matter Lagrangian term:\nThe matter part of the Lagrangian involving the gauge field is $\\mathcal{L}_{\\text{mat}} \\supset (D_\\mu\\phi)^*(D^\\mu\\phi)$. Expanding this gives terms coupling $A_\\mu$ to $\\phi$:\n$$(D_\\mu\\phi)^*(D^\\mu\\phi)\n= \\dots -iqA^\\mu(\\phi\\partial_\\mu\\phi^* - \\phi^*\\partial_\\mu\\phi)\n+q^2A_\\mu A^\\mu|\\phi|^2.$$\n\n3. Compute current:\nTaking the functional derivative $-\\partial/\\partial A_\\nu$ yields the current:\n$$J_{\\text{eff}}^\\nu = iq(\\phi\\partial^\\nu\\phi^* - \\phi^*\\partial^\\nu\\phi) - 2q^2|\\phi|^2A^\\nu.$$\n\n4. In unitary gauge $\\phi=(v+h)/\\sqrt2\\in\\mathbb R$:\nThe scalar field is real, so $\\phi^*=\\phi$. The first term in the current vanishes:\n$$\\phi\\partial^\\nu\\phi^*-\\phi^*\\partial^\\nu\\phi=0,\\quad\n|\\phi|^2=\\frac{(v+h)^2}{2}.$$\n\n5. Hence\n$$J_{\\text{eff}}^\\nu=-2q^2\\frac{(v+h)^2}{2}A^\\nu=-q^2(v+h)^2A^\\nu.$$", "answer": "$$\\boxed{-\\,q^2\\,(v+h(x))^2\\,A^\\nu(x)}$$", "id": "1093426"}, {"introduction": "Beyond describing massive particles, the Abelian-Higgs model supports stable, non-trivial field configurations known as topological defects. This practice explores Nielsen-Olesen vortices, which are line-like defects in three-dimensional spacetime. You will analyze these solutions in the special Bogomol'nyi-Prasad-Sommerfield (BPS) limit, a scenario where a fine-tuning of the potential simplifies the dynamics dramatically. By solving the resulting first-order BPS equations, you can determine exact properties of the vortex, such as the magnetic field at its core, revealing the deep interplay between topology, energy, and the structure of the fields. [@problem_id:382048]", "problem": "Consider the Abelian-Higgs model in a three-dimensional spacetime (two spatial dimensions and one time dimension). The theory describes a complex scalar field $\\phi$ with electric charge $e$ interacting with a U(1) gauge field $A_\\mu = (A_0, A_1, A_2)$. We are interested in static field configurations, where $\\partial_0 \\phi = 0$ and $\\partial_0 A_i = 0$ for $i=1, 2$. The energy of such a static configuration is given by the functional:\n$$ E = \\int d^2x \\left[ \\frac{1}{2} |D_i \\phi|^2 + \\frac{1}{2} B^2 + V(\\phi) \\right] $$\nwhere the integration is over the spatial plane $\\mathbb{R}^2$. The covariant derivatives are $D_i \\phi = (\\partial_i - i e A_i) \\phi$, the magnetic field is $B = \\partial_1 A_2 - \\partial_2 A_1$, and the potential is set to the specific Bogomol'nyi-Prasad-Sommerfield (BPS) form:\n$$ V(\\phi) = \\frac{e^2}{8} (|\\phi|^2 - v^2)^2 $$\nwhere $v$ is a positive real constant representing the vacuum expectation value of $|\\phi|$.\n\nThis theory admits stable, finite-energy solitonic solutions known as Nielsen-Olesen vortices. These solutions are characterized by a quantized topological charge $n \\in \\mathbb{Z}$, which corresponds to the winding number of the phase of $\\phi$ at spatial infinity. The BPS nature of the potential implies that the energy of any configuration is bounded from below by a value proportional to its topological charge. This bound is saturated for configurations that satisfy a set of first-order differential equations, known as the BPS equations.\n\nFor a fundamental vortex with topological charge $n=1$, determine the magnitude of the magnetic field, $|B|$, at the center of the vortex ($r=0$).", "solution": "To determine the magnitude of the magnetic field $ |B| $ at the center of a Nielsen-Olesen vortex with topological charge $ n = 1 $, we analyze the Bogomol'nyi-Prasad-Sommerfield (BPS) equations derived from the energy functional of the Abelian-Higgs model in 2+1 dimensions.\n\n---\n\n### **Step 1: Energy Functional and BPS Equations**\n\nThe static energy is given by:\n$$\nE = \\int d^2x \\left[ \\frac{1}{2} |D_i \\phi|^2 + \\frac{1}{2} B^2 + V(\\phi) \\right],\n$$\nwhere $ D_i \\phi = (\\partial_i - i e A_i)\\phi $, $ B = \\partial_1 A_2 - \\partial_2 A_1 $, and the potential is:\n$$\nV(\\phi) = \\frac{e^2}{8} (|\\phi|^2 - v^2)^2.\n$$\n\nBy rewriting the energy functional using the Bogomol'nyi completion-of-squares trick, one can show that the energy is minimized for configurations satisfying a set of first-order differential equations, the BPS equations:\n$$\nD_1 \\phi \\pm i D_2 \\phi = 0, \\quad B = \\mp \\frac{e}{2}(v^2 - |\\phi|^2).\n$$\nWe will choose the upper sign convention, so $B = - \\frac{e}{2}(v^2 - |\\phi|^2)$.\n\n---\n\n### **Step 2: Radial Ansatz for $ n = 1 $ Vortex**\n\nFor a static, radially symmetric solution with winding number $ n = 1 $, we use the ansatz:\n$$\n\\phi(r) = v f(r) e^{i\\theta}, \\quad A_\\theta(r) = \\frac{1 - a(r)}{e r},\n$$\nwhere $ f(r) $ and $ a(r) $ are real profile functions satisfying boundary conditions:\n$$\nf(0) = 0, \\quad f(\\infty) = 1, \\quad a(0) = 1, \\quad a(\\infty) = 0.\n$$\n\nThe magnetic field becomes:\n$$\nB = \\frac{1}{r} \\partial_r (r A_\\theta) = -\\frac{a'(r)}{e r}.\n$$\n\nFrom the BPS equation $ B = - \\frac{e}{2}(v^2 - |\\phi|^2) $, we substitute $ |\\phi|^2 = v^2 f(r)^2 $ to get:\n$$\nB(r) = - \\frac{e v^2}{2} (1 - f(r)^2).\n$$\n\n---\n\n### **Step 3: Evaluate $ B $ at $ r = 0 $**\n\nAt the center of the vortex ($ r = 0 $), the scalar field must vanish to keep the energy finite, consistent with the topological winding:\n$$\n|\\phi(0)| = v f(0) = 0 \\quad \\Rightarrow \\quad f(0) = 0.\n$$\n\nSubstituting into the expression for $ B(r) $:\n$$\nB(0) = - \\frac{e v^2}{2} (1 - f(0)^2) = - \\frac{e v^2}{2}.\n$$\n\nThus, the magnitude of the magnetic field at the center is:\n$$\n|B(0)| = \\frac{e v^2}{2}.\n$$\n\n---\n\n### **Conclusion**\n\nThe BPS nature of the potential ensures that the magnetic field is directly related to the deviation of the scalar field from its vacuum expectation value. At the core of the vortex, where the scalar field vanishes, the magnetic field reaches its maximum value.", "answer": "$$\\boxed{\\frac{e v^2}{2}}$$", "id": "382048"}, {"introduction": "From the analytical properties of a single vortex, we now transition to the collective behavior of a network of these defects in a cosmological setting. This computational exercise guides you through a simulation of cosmic string formation in the early universe, the 3+1 dimensional analogue of vortices. You will implement a lattice gauge theory algorithm to generate a network of strings from random initial conditions and measure their density. This practice offers a powerful glimpse into how the theoretical framework of the Abelian-Higgs model is used in modern computational cosmology to study the potential relics of phase transitions in our universe. [@problem_id:2407397]", "problem": "You are asked to construct a complete, runnable program that generates a gauge-invariant estimate of cosmic string length density from random initial conditions of an Abelian-Higgs model in the London limit on a periodic three-dimensional cubic lattice. All calculations are to be performed in lattice units with lattice spacing set to $a=1$. All angles must be in radians. The final results must be printed as real numbers rounded to six decimal places.\n\nStart from the following fundamental and well-tested base:\n(1) The Abelian-Higgs model possesses a local Unitary group of degree one (U(1)) gauge symmetry. In the London limit, the complex scalar (Higgs) field is written as $\\phi(x) = v \\exp\\{ \\mathrm{i}\\,\\theta(x) \\}$ with fixed magnitude $v$, and the gauge field is represented on links by U(1) link variables $U_{\\mu}(x) = \\exp\\{\\mathrm{i}\\,\\alpha_{\\mu}(x)\\}$.\n(2) Gauge-invariant phase differences on links are built as the principal branch of $\\Delta_{\\mu}\\theta(x) - \\alpha_{\\mu}(x)$, where $\\Delta_{\\mu}\\theta(x) \\equiv \\theta(x+\\hat{\\mu}) - \\theta(x)$ and the principal branch function maps any angle to the interval $(-\\pi,\\pi]$.\n(3) The single-valuedness of $\\phi(x)$ modulo $2\\pi$, together with U(1) gauge invariance, implies that the oriented sum of gauge-invariant phase differences around an elementary plaquette $(\\mu,\\nu)$ equals $2\\pi n_{p}$ for some integer $n_{p}$. A nonzero integer $n_{p}$ signals a local string segment piercing that plaquette.\n(4) In three dimensions, each plaquette with nonzero $|n_{p}|$ corresponds to a segment of string of length $a$ along the dual link perpendicular to the plaquette. Therefore, with $a=1$, the total string length $L$ equals the sum of $|n_{p}|$ over all plaquettes. The string length density is then $\\rho = L / V$ with volume $V = N^{3}$.\n\nTask:\nImplement the following algorithm in a general-purpose programming language of your choice. Your program must be self-contained and not read any input.\n\n(1) Lattice and fields. Use a periodic cubic lattice of size $N \\times N \\times N$ with lattice spacing $a=1$. Represent the scalar phase field $\\theta(\\mathbf{x})$ on sites and the gauge field link angles $\\alpha_{\\mu}(\\mathbf{x})$ on links for $\\mu \\in \\{x,y,z\\}$.\n(2) Correlated scalar phases. Generate a mean-zero Gaussian random field $g(\\mathbf{x})$ with an approximately Gaussian two-point correlation of length $\\xi$ by filtering white noise in Fourier space with the factor $\\exp\\{-\\tfrac{1}{2}\\xi^{2}|\\mathbf{k}|^{2}\\}$, where $\\mathbf{k}$ uses the periodic discrete angular frequencies. Map to phases by $\\theta(\\mathbf{x}) = \\mathrm{wrap}(g(\\mathbf{x}))$, where $\\mathrm{wrap}(\\cdot)$ maps to $(-\\pi,\\pi]$.\n(3) Random gauge links. For each link direction $\\mu$, draw $\\alpha_{\\mu}(\\mathbf{x})$ independently from a normal distribution with mean $0$ and standard deviation $\\sigma_{A}$, then wrap each to $(-\\pi,\\pi]$.\n(4) Gauge-invariant link angles. Define\n\n$$\n\\omega_{\\mu}(\\mathbf{x}) = \\mathrm{wrap}\\!\\left( \\theta(\\mathbf{x}+\\hat{\\mu}) - \\theta(\\mathbf{x}) - \\alpha_{\\mu}(\\mathbf{x}) \\right).\n$$\n\n(5) Plaquette winding integers. For each oriented plaquette in the $(\\mu,\\nu)$ plane at site $\\mathbf{x}$, compute\n\n$$\ns_{\\mu\\nu}(\\mathbf{x}) = \\omega_{\\mu}(\\mathbf{x}) + \\omega_{\\nu}(\\mathbf{x}+\\hat{\\mu}) - \\omega_{\\mu}(\\mathbf{x}+\\hat{\\nu}) - \\omega_{\\nu}(\\mathbf{x}),\n$$\n\nwith all site indices taken modulo $N$ due to periodic boundaries. Define the integer winding by\n\n$$\nn_{\\mu\\nu}(\\mathbf{x}) = \\mathrm{round}\\!\\left( \\frac{s_{\\mu\\nu}(\\mathbf{x})}{2\\pi} \\right).\n$$\n\n(6) String length density. Let\n\n$$\nL = \\sum_{\\mathbf{x}} \\sum_{\\mu\\nu} \\left| n_{\\mu\\nu}(\\mathbf{x}) \\right|, \\quad \\rho = \\frac{L}{N^{3}}.\n$$\n\nReport $\\rho$ as a real number in lattice units.\n(7) Angle units. All angles are in radians.\n(8) Rounding. Round each reported $\\rho$ to six decimal places.\n\nTest suite:\nRun your program on the following parameter sets, where each tuple is $(N,\\ \\xi,\\ \\sigma_{A},\\ \\text{seed})$ and $\\text{seed}$ initializes the pseudorandom number generator to ensure reproducibility:\n- Case 1 (happy path): $(16,\\ 2.5,\\ 0.2,\\ 12345)$.\n- Case 2 (short correlation length): $(16,\\ 0.5,\\ 0.2,\\ 54321)$.\n- Case 3 (long correlation length): $(16,\\ 4.0,\\ 0.2,\\ 202311)$.\n- Case 4 (strong gauge fluctuations): $(16,\\ 2.5,\\ 1.0,\\ 999)$.\n- Case 5 (small lattice boundary case): $(8,\\ 3.5,\\ 0.2,\\ 424242)$.\n\nFinal output format:\nYour program should produce a single line of output containing the five rounded densities as a comma-separated list enclosed in square brackets, for example $[\\rho_{1},\\rho_{2},\\rho_{3},\\rho_{4},\\rho_{5}]$. Each $\\rho_{i}$ must be rounded to six decimal places and printed as a standard decimal numeral in lattice units (unitless). No other text must be printed.", "solution": "The problem requires the computation of cosmic string length density in a $3$D lattice simulation of the Abelian-Higgs model in the London limit. The solution is constructed by following the specified algorithm precisely.\n\nStep $1$: Lattice and Field Initialization\nA periodic cubic lattice of dimensions $N \\times N \\times N$ is considered, with the lattice spacing set to unity, $a=1$. The scalar field is represented by its phase, $\\theta(\\mathbf{x})$, which is a real-valued field defined on the sites of the lattice. The $U(1)$ gauge field is represented by link variables, which for this problem are characterized by their phases, $\\alpha_{\\mu}(\\mathbf{x})$, where $\\mu \\in \\{x, y, z\\}$ denotes the direction of the link originating from site $\\mathbf{x}$. These fields will be represented numerically as arrays.\n\nStep $2$: Generation of Correlated Scalar Phases\nThe initial state of the scalar phase field $\\theta(\\mathbf{x})$ is generated to have spatial correlations characterized by a length scale $\\xi$. This is a crucial step mimicking defect formation via the Kibble-Zurek mechanism. The procedure is as follows:\nFirst, a $3$D array of white noise is created by populating each lattice site with a random number drawn from a standard normal distribution. Let this field be $w(\\mathbf{x})$.\nSecond, this real-space noise field is transformed into Fourier space using a $3$D Fast Fourier Transform (FFT), yielding $\\tilde{w}(\\mathbf{k})$.\nThird, a Gaussian filter, $F(\\mathbf{k}) = \\exp\\{-\\tfrac{1}{2}\\xi^{2}|\\mathbf{k}|^{2}\\}$, is applied in Fourier space. The momentum vectors $\\mathbf{k}$ are those appropriate for a periodic lattice of size $N$, with components $k_i = \\frac{2\\pi m_i}{N}$ for $m_i$ being integers. The filter suppresses high-momentum (high-frequency) modes, enforcing a correlation length $\\xi$ in real space.\nFourth, the filtered field $\\tilde{g}(\\mathbf{k}) = \\tilde{w}(\\mathbf{k}) F(\\mathbf{k})$ is transformed back to real space using an inverse FFT to obtain the correlated Gaussian field $g(\\mathbf{x})$.\nFinally, the scalar phase field is obtained by mapping $g(\\mathbf{x})$ to the angular interval $(-\\pi, \\pi]$ via a wrapping function, $\\theta(\\mathbf{x}) = \\mathrm{wrap}(g(\\mathbf{x}))$. This mapping is implemented as $\\mathrm{wrap}(y) = (y + \\pi) \\pmod{2\\pi} - \\pi$.\n\nStep $3$: Generation of Random Gauge Links\nThe gauge field link phases $\\alpha_{\\mu}(\\mathbf{x})$ are introduced as completely uncorrelated random variables. For each link, a value is drawn from a normal distribution with mean $0$ and standard deviation $\\sigma_A$. These values are also wrapped to the interval $(-\\pi, \\pi]$. This represents a random, fluctuating gauge background.\n\nStep $4$: Computation of Gauge-Invariant Link Angles\nThe raw phase difference of the scalar field between two adjacent sites, $\\Delta_{\\mu}\\theta(x) = \\theta(x+\\hat{\\mu}) - \\theta(x)$, is not gauge-invariant. A physically meaningful and gauge-invariant quantity is formed by subtracting the gauge field phase on the connecting link. We compute this gauge-invariant link angle, $\\omega_{\\mu}(\\mathbf{x})$, for every link in the lattice:\n$$\n\\omega_{\\mu}(\\mathbf{x}) = \\mathrm{wrap}\\!\\left( \\theta(\\mathbf{x}+\\hat{\\mu}) - \\theta(\\mathbf{x}) - \\alpha_{\\mu}(\\mathbf{x}) \\right)\n$$\nOn the periodic lattice, the shift $\\mathbf{x}+\\hat{\\mu}$ is implemented as a circular shift of the array indices.\n\nStep $5$: Calculation of Plaquette Winding Integers\nA cosmic string is a topological defect, a singularity in the phase field. On a lattice, its presence is detected by a non-zero net phase accumulation around an elementary square loop, a plaquette. The sum of the gauge-invariant link angles around an oriented plaquette in the $(\\mu, \\nu)$-plane is calculated as:\n$$\ns_{\\mu\\nu}(\\mathbf{x}) = \\omega_{\\mu}(\\mathbf{x}) + \\omega_{\\nu}(\\mathbf{x}+\\hat{\\mu}) - \\omega_{\\mu}(\\mathbf{x}+\\hat{\\nu}) - \\omega_{\\nu}(\\mathbf{x})\n$$\nThe condition of single-valuedness of the fields in the continuum limit requires this sum to be an integer multiple of $2\\pi$. We extract this integer, the plaquette winding number $n_{\\mu\\nu}(\\mathbf{x})$, by dividing by $2\\pi$ and rounding to the nearest integer:\n$$\nn_{\\mu\\nu}(\\mathbf{x}) = \\mathrm{round}\\!\\left( \\frac{s_{\\mu\\nu}(\\mathbf{x})}{2\\pi} \\right)\n$$\nA non-zero integer $|n_{\\mu\\nu}(\\mathbf{x})|$ indicates that $|n_{\\mu\\nu}(\\mathbf{x})|$ strings pierce the plaquette at $\\mathbf{x}$. This is calculated for the three distinct plaquette orientations: $(x, y)$, $(y, z)$, and $(z, x)$ (or $(x, z)$), covering all possibilities for $\\mu  \\nu$.\n\nStep $6$: Total String Length and Density\nWith the lattice spacing $a=1$, a plaquette pierced by a string corresponds to a string segment of length $1$. The total length of the cosmic string network, $L$, is the sum of absolute winding numbers over all plaquettes on the lattice.\n$$\nL = \\sum_{\\mathbf{x}} \\sum_{\\mu\\nu} \\left| n_{\\mu\\nu}(\\mathbf{x}) \\right|\n$$\nThe string length density, $\\rho$, is a macroscopic quantity defined as the total length per unit volume, $V = N^3$:\n$$\n\\rho = \\frac{L}{N^{3}}\n$$\n\nStep $7$ and $8$: Final Reporting\nThe entire simulation is performed for each test case specified. The resulting density $\\rho$ is rounded to $6$ decimal places and presented in the required format. The use of a fixed seed for the pseudorandom number generator ensures the reproducibility of the results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (N, xi, sigma_A, seed)\n        (16, 2.5, 0.2, 12345),\n        (16, 0.5, 0.2, 54321),\n        (16, 4.0, 0.2, 202311),\n        (16, 2.5, 1.0, 999),\n        (8, 3.5, 0.2, 424242),\n    ]\n\n    results = []\n    for params in test_cases:\n        N, xi, sigma_A, seed = params\n        rho = run_simulation(N, xi, sigma_A, seed)\n        results.append(f\"{rho:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(N, xi, sigma_A, seed):\n    \"\"\"\n    Executes the cosmic string simulation for a single set of parameters.\n\n    Args:\n        N (int): The size of the cubic lattice (N x N x N).\n        xi (float): The correlation length of the scalar field.\n        sigma_A (float): The standard deviation for the gauge field fluctuations.\n        seed (int): The seed for the random number generator.\n\n    Returns:\n        float: The calculated string length density rho.\n    \"\"\"\n    # Initialize the random number generator for reproducibility\n    rng = np.random.default_rng(seed)\n\n    # A utility function to map angles to the interval (-pi, pi]\n    def wrap_to_pi(x):\n        return (x + np.pi) % (2 * np.pi) - np.pi\n\n    # --- Step 2: Correlated scalar phases ---\n    # Generate white noise in real space\n    white_noise = rng.standard_normal(size=(N, N, N))\n    \n    # FFT to momentum space\n    white_noise_k = np.fft.fftn(white_noise)\n    \n    # Create momentum grid\n    k_vals = np.fft.fftfreq(N) * 2 * np.pi\n    Kx, Ky, Kz = np.meshgrid(k_vals, k_vals, k_vals, indexing='ij')\n    K2 = Kx**2 + Ky**2 + Kz**2\n    \n    # Apply Gaussian filter. Avoid division by zero at k=0 if xi is infinite.\n    # The problem implies finite xi, so no special handling is needed.\n    filter_k = np.exp(-0.5 * xi**2 * K2)\n    \n    # Filter the noise and inverse FFT back to real space\n    correlated_field_g = np.fft.ifftn(white_noise_k * filter_k).real\n    \n    # Map to phases theta\n    theta = wrap_to_pi(correlated_field_g)\n\n    # --- Step 3: Random gauge links ---\n    # Generate random gauge fields alpha_mu for mu=x,y,z\n    alpha = rng.normal(loc=0.0, scale=sigma_A, size=(3, N, N, N))\n    alpha = wrap_to_pi(alpha)\n    alpha_x, alpha_y, alpha_z = alpha[0], alpha[1], alpha[2]\n\n    # --- Step 4: Gauge-invariant link angles ---\n    # theta(x+mu) is a circular shift by +1 in coordinate, which is -1 in index\n    theta_px = np.roll(theta, shift=-1, axis=0)\n    theta_py = np.roll(theta, shift=-1, axis=1)\n    theta_pz = np.roll(theta, shift=-1, axis=2)\n    \n    omega_x = wrap_to_pi(theta_px - theta - alpha_x)\n    omega_y = wrap_to_pi(theta_py - theta - alpha_y)\n    omega_z = wrap_to_pi(theta_pz - theta - alpha_z)\n\n    # --- Step 5: Plaquette winding integers ---\n    # The sum s_munu = w_mu(x) + w_nu(x+mu) - w_mu(x+nu) - w_nu(x)\n    \n    # (x,y) plaquettes\n    s_xy = (omega_x + np.roll(omega_y, shift=-1, axis=0) -\n            np.roll(omega_x, shift=-1, axis=1) - omega_y)\n    \n    # (y,z) plaquettes\n    s_yz = (omega_y + np.roll(omega_z, shift=-1, axis=1) -\n            np.roll(omega_y, shift=-1, axis=2) - omega_z)\n\n    # (z,x) plaquettes\n    s_zx = (omega_z + np.roll(omega_x, shift=-1, axis=2) -\n            np.roll(omega_z, shift=-1, axis=0) - omega_x)\n\n    # Calculate winding numbers n_munu = round(s_munu / 2pi)\n    n_xy = np.round(s_xy / (2 * np.pi))\n    n_yz = np.round(s_yz / (2 * np.pi))\n    n_zx = np.round(s_zx / (2 * np.pi))\n\n    # --- Step 6: String length density ---\n    # Total length L is the sum of absolute winding numbers\n    total_length = np.sum(np.abs(n_xy)) + np.sum(np.abs(n_yz)) + np.sum(np.abs(n_zx))\n    \n    # Volume V = N^3\n    volume = N**3\n    \n    # Density rho = L / V\n    rho = total_length / volume\n    \n    return rho\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2407397"}]}