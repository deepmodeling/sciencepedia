{"hands_on_practices": [{"introduction": "An optical clock's performance is fundamentally limited by the stability of the laser used to probe the atomic transition. This practice explores the feedback servo loop that 'locks' the laser's frequency to the atomic resonance, the very heart of the clock's operation. By calculating the unity-gain frequency, you will gain insight into the servo's bandwidth, a critical parameter that dictates how effectively the system can suppress laser frequency noise [@problem_id:1257064].", "problem": "In an optical clock experiment, a narrow-linewidth laser is stabilized to a high-Q atomic resonance. The stabilization is achieved using a digital feedback servo loop. The loop works as follows: the frequency difference between the laser and the atomic resonance, $\\delta\\nu$, is converted into a voltage error signal, $V_{err}$. This conversion is characterized by a discriminator with a slope $D$, in units of V/Hz. The error signal is then fed into a digital Proportional-Integral (PI) controller, which runs at a sampling period of $T_s$. The controller generates a correction voltage, $V_c$, which is applied to an actuator that tunes the laser's frequency. The laser's frequency response to the correction voltage is given by a tuning coefficient $K_{laser}$, in units of Hz/V.\n\nFor frequencies $f$ much smaller than the sampling rate $1/T_s$, the transfer function of the digital PI controller can be well-approximated by its continuous-time analog:\n$$\nC(f) = g_p + \\frac{g_i}{j 2\\pi f T_s}\n$$\nwhere $g_p$ is the dimensionless proportional gain and $g_i$ is the dimensionless integral gain. The term $j$ is the imaginary unit.\n\nThe plant (the system being controlled, i.e., the discriminator and laser actuator) is assumed to have a flat frequency response in the range of interest. The total open-loop gain of the servo, $G_{OL}(f)$, is the product of the controller and plant transfer functions. We are interested in the unity-gain frequency, $f_u$, which is a key metric for the servo's bandwidth. The unity-gain frequency is defined as the frequency at which the magnitude of the open-loop gain is equal to one: $|G_{OL}(f_u)| = 1$.\n\nAssume that any time delays in the loop (e.g., from analog-to-digital conversion and computation) primarily affect the phase of the open-loop gain and can be neglected when calculating its magnitude. Also, assume the servo is operated in a regime where $g_p D K_{laser}  1$, which ensures the expression for the unity-gain frequency is real-valued.\n\nCalculate the unity-gain frequency, $f_u$, of this laser-locking servo system in terms of the given parameters: $g_p$, $g_i$, $T_s$, $D$, and $K_{laser}$.", "solution": "1. The open-loop gain is\n$$\nG_{OL}(f)=C(f)\\,D\\,K_{laser}\n=\\Bigl(g_p+\\frac{g_i}{j2\\pi fT_s}\\Bigr)\\,D\\,K_{laser}.\n$$\n2. At the unity-gain frequency $f_u$, $|G_{OL}(f_u)|=1$, so\n$$\n\\Bigl|g_p+\\frac{g_i}{j2\\pi f_uT_s}\\Bigr|\\,D\\,K_{laser}=1.\n$$\n3. Evaluate the magnitude:\n$$\n\\sqrt{g_p^2+\\Bigl(\\frac{g_i}{2\\pi f_uT_s}\\Bigr)^2}\\;D\\,K_{laser}=1.\n$$\n4. Square both sides:\n$$\n\\bigl(g_p^2+\\tfrac{g_i^2}{(2\\pi f_uT_s)^2}\\bigr)\\,D^2K_{laser}^2=1.\n$$\n5. Solve for $(2\\pi f_uT_s)^2$:\n$$\n\\frac{g_i^2}{(2\\pi f_uT_s)^2}\n= \\frac{1}{D^2K_{laser}^2}-g_p^2\n=\\frac{1-g_p^2D^2K_{laser}^2}{D^2K_{laser}^2}.\n$$\n6. Hence\n$$\n2\\pi f_uT_s\n=\\frac{g_i}{\\sqrt{\\displaystyle\\frac{1-g_p^2D^2K_{laser}^2}{D^2K_{laser}^2}}}\n=\\frac{g_i\\,D\\,K_{laser}}{\\sqrt{1-g_p^2D^2K_{laser}^2}}.\n$$\n7. Finally,\n$$\nf_u\n=\\frac{1}{2\\pi T_s}\\,\\frac{g_i\\,D\\,K_{laser}}{\\sqrt{1-(g_pD\\,K_{laser})^2}}.\n$$", "answer": "$$\\boxed{\\frac{g_i\\,D\\,K_{laser}}{2\\pi\\,T_s\\,\\sqrt{1-(g_p\\,D\\,K_{laser})^2}}}$$", "id": "1257064"}, {"introduction": "While we often model atoms as simple two-level systems for clarity, reality is more complex. This exercise delves into a crucial source of error in optical clocks: unwanted coupling to other atomic levels during the interrogation pulse. By applying perturbation theory, you will calculate the population leakage to an off-resonant state, learning how to quantify a key systematic effect that can limit a clock's accuracy [@problem_id:1257132].", "problem": "An atom, modeled as a three-level system, is being considered for use in an optical clock. The relevant levels are the ground state $|g\\rangle$, the excited clock state $|e\\rangle$, and an auxiliary off-resonant state $|r\\rangle$. The energy differences are given by $E_e - E_g = \\hbar\\omega_{eg}$ and $E_r - E_e = \\hbar\\omega_{re}$. The atom is initially in the ground state $|g\\rangle$.\n\nTo perform a state inversion on the clock transition $|g\\rangle \\leftrightarrow |e\\rangle$, a laser with frequency $\\omega_L=\\omega_{eg}$ is applied as a square pulse starting at $t=0$. This laser drives the $|g\\rangle \\leftrightarrow |e\\rangle$ transition with a Rabi frequency $\\Omega_{ge}$. The duration of the pulse is set to $T = \\pi/\\Omega_{ge}$ to function as a $\\pi$-pulse for an ideal two-level system.\n\nHowever, the same laser also weakly couples the excited state $|e\\rangle$ to the auxiliary state $|r\\rangle$ with a Rabi frequency $\\Omega_{er}$. This coupling leads to population leakage, an error source for the clock operation.\n\nYour task is to calculate the population that has leaked into state $|r\\rangle$, $P_r(T) = |\\langle r|\\psi(T)\\rangle|^2$, at the end of the pulse at time $t=T$.\n\nTo solve this, work in an appropriate rotating frame and make the rotating-wave approximation (RWA). Treat the coupling to level $|r\\rangle$ (i.e., the term proportional to $\\Omega_{er}$) as a perturbation, and find the leakage population to the lowest non-vanishing order in $\\Omega_{er}$. Express your answer in terms of $\\Omega_{ge}$, $\\Omega_{er}$, and the detuning $\\Delta = \\omega_{re}$.", "solution": "We work in the rotating frame at $\\omega_L=\\omega_{eg}$ and invoke the RWA. The three-level Hamiltonian, in the basis $\\{|g\\rangle,|e\\rangle,|r\\rangle\\}$, is\n$$\nH=\\frac{\\hbar}{2}\\Bigl[\\Omega_{ge}\\,|g\\rangle\\langle e|+\\Omega_{er}\\,e^{i\\Delta t}\\,|e\\rangle\\langle r|+\\text{h.c.}\\Bigr]\n+\\hbar\\Delta\\,|r\\rangle\\langle r|\\,. \n$$\nWe solve exactly for the $g\\!-\\!e$ dynamics (ignoring $|r\\rangle$):\n$$\na_g(t)=\\cos\\frac{\\Omega_{ge}t}{2},\\qquad\na_e(t)=-i\\sin\\frac{\\Omega_{ge}t}{2}\\,.\n$$\nTreating the $e\\!-\\!r$ coupling perturbatively to first order in $\\Omega_{er}$, the amplitude in $|r\\rangle$ at time $T$ is\n$$\na_r(T)=-\\frac{i}{\\hbar}\\int_0^T\\langle r|H_I(t)|\\psi^{(0)}(t)\\rangle\\,dt\n=-i\\frac{\\Omega_{er}}{2}\\!\\int_0^T\\!a_e(t)\\,e^{i\\Delta t}\\,dt.\n$$\nSubstitute $a_e(t)=-i\\sin(\\Omega_{ge}t/2)$ and set $T=\\pi/\\Omega_{ge}$:\n$$\na_r(T)\n=-\\frac{\\Omega_{er}}{2}\\int_0^T\\sin\\frac{\\Omega_{ge}t}{2}\\,e^{i\\Delta t}\\,dt\n\\equiv-\\frac{\\Omega_{er}}{2}\\,I.\n$$\nWe compute\n$$\nI=\\int_0^T\\sin\\frac{\\Omega_{ge}t}{2}e^{i\\Delta t}dt\n=\\frac1{2i}\\!\\int_0^T\\bigl[e^{i(\\Delta+\\Omega_{ge}/2)t}-e^{i(\\Delta-\\Omega_{ge}/2)t}\\bigr]dt\n$$\n$$\n=-\\frac12\\Bigl[\\frac{e^{i(\\Delta+\\frac{\\Omega_{ge}}2)T}-1}{\\Delta+\\frac{\\Omega_{ge}}2}\n-\\frac{e^{i(\\Delta-\\frac{\\Omega_{ge}}2)T}-1}{\\Delta-\\frac{\\Omega_{ge}}2}\\Bigr].\n$$\nWith $T=\\pi/\\Omega_{ge}$, one finds\n$$\ne^{i(\\Delta\\pm\\frac{\\Omega_{ge}}2)T}\n=e^{i(\\frac{\\pi\\Delta}{\\Omega_{ge}}\\pm\\frac\\pi2)}\n=\\pm i\\,e^{i\\frac{\\pi\\Delta}{\\Omega_{ge}}},\n$$\nand after algebra\n$$\nI=-\\frac{i\\Delta\\,e^{i\\frac{\\pi\\Delta}{\\Omega_{ge}}}+\\frac{\\Omega_{ge}}2}\n{\\Delta^2-\\bigl(\\frac{\\Omega_{ge}}2\\bigr)^2}.\n$$\nHence the leakage probability is\n$$\nP_r(T)=|a_r(T)|^2\n=\\frac{\\Omega_{er}^2}{4}\\,\\bigl|I\\bigr|^2\n=\\frac{\\Omega_{er}^2}{4}\\,\\frac{\\Delta^2+\\frac{\\Omega_{ge}^2}{4}\n-\\Omega_{ge}\\Delta\\sin\\!\\bigl(\\tfrac{\\pi\\Delta}{\\Omega_{ge}}\\bigr)}\n{\\Bigl(\\Delta^2-\\frac{\\Omega_{ge}^2}{4}\\Bigr)^2}.\n$$", "answer": "$$\n\\boxed{\\frac{\\Omega_{er}^2}{4}\\,\n\\frac{\\displaystyle \\Delta^2+\\frac{\\Omega_{ge}^2}{4}\n-\\Omega_{ge}\\,\\Delta\\,\\sin\\!\\Bigl(\\frac{\\pi\\Delta}{\\Omega_{ge}}\\Bigr)}\n{\\displaystyle\\Bigl(\\Delta^2-\\frac{\\Omega_{ge}^2}{4}\\Bigr)^2}}.\n$$", "id": "1257132"}, {"introduction": "The world's most stable timescales are not generated by a single clock, but by a carefully weighted average of many. This final practice explores how to optimally combine multiple independent clocks to create a synthetic timescale with superior stability. Using the method of Lagrange multipliers, you will derive the optimal weighting scheme, revealing the powerful statistical principle that the most stable clocks should contribute the most to the average [@problem_id:1257184].", "problem": "An advanced timescale algorithm aims to create a highly stable synthetic clock signal by combining the outputs of multiple independent atomic clocks. Consider a system of three such independent clocks. The stability of each clock $i$ (for $i=1, 2, 3$) at a particular averaging time $\\tau$ is characterized by its Allan variance, denoted as $\\sigma_i^2$.\n\nA synthetic clock's time error, $x_c(t)$, is constructed as a weighted linear combination of the time errors of the individual clocks, $x_i(t)$:\n$$\nx_c(t) = w_1 x_1(t) + w_2 x_2(t) + w_3 x_3(t)\n$$\nFor this to represent a valid time average, the weights $w_i$ must be real numbers that sum to unity, i.e., $\\sum_{i=1}^3 w_i = 1$.\n\nBecause the noise sources of the clocks are independent, the Allan variance of the synthetic clock, $\\sigma_c^2$, is related to the individual Allan variances by the following expression:\n$$\n\\sigma_c^2 = w_1^2 \\sigma_1^2 + w_2^2 \\sigma_2^2 + w_3^2 \\sigma_3^2\n$$\nYour task is to find the optimal weighting scheme that minimizes the Allan variance of the synthetic clock.\n\nDerive an expression for the optimal weight $w_1$ in terms of the individual Allan variances $\\sigma_1^2$, $\\sigma_2^2$, and $\\sigma_3^2$.", "solution": "1. Define the optimization problem. The objective is to minimize the Allan variance:\n   $$\\sigma_c^2 = w_1^2\\sigma_1^2 + w_2^2\\sigma_2^2 + w_3^2\\sigma_3^2$$\n   subject to the constraint:\n   $$w_1 + w_2 + w_3 = 1\\,.$$\n\n2. Form the Lagrangian:\n   $$\\mathcal{L} = w_1^2\\sigma_1^2 + w_2^2\\sigma_2^2 + w_3^2\\sigma_3^2 - \\lambda(w_1 + w_2 + w_3 - 1)\\,.$$\n\n3. Stationarity conditions:\n   $$\\frac{\\partial\\mathcal{L}}{\\partial w_i} = 2w_i\\sigma_i^2 - \\lambda = 0\n     \\quad\\Longrightarrow\\quad\n     w_i = \\frac{\\lambda}{2\\sigma_i^2},\\quad i=1,2,3.$$\n\n4. Enforce the constraint:\n   $$\\sum_{i=1}^3 w_i = \\frac{\\lambda}{2}\\sum_{i=1}^3\\frac{1}{\\sigma_i^2} = 1\n     \\quad\\Longrightarrow\\quad\n     \\frac{\\lambda}{2} = \\frac{1}{\\sum_{i=1}^3\\frac{1}{\\sigma_i^2}}.$$\n\n5. Substitute back to find each weight:\n   $$w_i = \\frac{1/\\sigma_i^2}{\\sum_{j=1}^3 1/\\sigma_j^2}\\,,\n     \\quad\\text{hence}\\quad\n     w_1 = \\frac{1/\\sigma_1^2}{1/\\sigma_1^2 + 1/\\sigma_2^2 + 1/\\sigma_3^2}\\,.$$", "answer": "$$\\boxed{\\frac{1/\\sigma_1^2}{1/\\sigma_1^2 + 1/\\sigma_2^2 + 1/\\sigma_3^2}}$$", "id": "1257184"}]}