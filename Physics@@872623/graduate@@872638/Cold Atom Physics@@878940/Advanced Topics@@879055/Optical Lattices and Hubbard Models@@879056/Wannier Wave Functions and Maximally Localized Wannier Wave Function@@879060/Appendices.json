{"hands_on_practices": [{"introduction": "One of the most powerful applications of Wannier functions is the derivation of simplified tight-binding models from an underlying continuous potential. This practice bridges the gap between the continuous Schr√∂dinger equation and discrete lattice models by guiding you through the calculation of a key parameter. You will compute the nearest-neighbor hopping amplitude by evaluating the potential energy matrix element between adjacent Wannier functions, providing a tangible link between the potential landscape and the emergent lattice dynamics ([@problem_id:1279679]).", "problem": "Consider a one-dimensional system of non-interacting particles in a periodic potential, such as that experienced by cold atoms in an optical lattice. The potential is given by\n$$\nV(x) = V_0 \\cos\\left(\\frac{2\\pi x}{a}\\right)\n$$\nwhere $V_0$ is the potential amplitude and $a$ is the lattice constant.\n\nIn the tight-binding limit (i.e., for a deep lattice potential), the single-particle wave functions can be described by Wannier functions, $W_n(x)$, which are localized around the lattice sites $R_n = na$, where $n$ is an integer. For the lowest energy band and in this limit, the Wannier function centered at site $n$ is well-approximated by a normalized Gaussian wave packet:\n$$\nW_n(x) \\approx \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{(x - na)^2}{\\sigma^2}\\right)\n$$\nwhere $\\sigma$ is the spatial width of the wave packet, and we assume $\\sigma \\ll a$.\n\nYour task is to compute the nearest-neighbor potential energy matrix element, defined as $J = \\langle W_n | V(x) | W_{n+1} \\rangle$. Due to the translational symmetry of the system, this value is independent of the specific site $n$.\n\nCalculate this matrix element $J$. State your answer as a closed-form analytical expression in terms of the parameters $V_0$, $a$, and $\\sigma$.", "solution": "We are asked to calculate the nearest-neighbor potential energy matrix element $J = \\langle W_n | V(x) | W_{n+1} \\rangle$. Due to translational invariance, this matrix element is independent of $n$. We can therefore set $n=0$ without loss of generality and calculate $J = \\langle W_0 | V(x) | W_1 \\rangle$.\n\nThe matrix element is given by the integral:\n$$\nJ = \\int_{-\\infty}^{\\infty} W_0^*(x) V(x) W_1(x) \\, dx\n$$\n\nThe Wannier functions are real, so $W_0^*(x) = W_0(x)$. Let's substitute the given expressions for the Wannier functions and the potential. For $n=0$ and $n=1$, the Wannier functions are:\n$$\nW_0(x) = \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right)\n$$\n$$\nW_1(x) = \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{(x - a)^2}{\\sigma^2}\\right)\n$$\nAnd the potential is:\n$$\nV(x) = V_0 \\cos\\left(\\frac{2\\pi x}{a}\\right)\n$$\n\nSubstituting these into the integral for $J$:\n$$\nJ = \\int_{-\\infty}^{\\infty} \\left[ \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right) \\right] \\left[ V_0 \\cos\\left(\\frac{2\\pi x}{a}\\right) \\right] \\left[ \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{(x-a)^2}{\\sigma^2}\\right) \\right] \\, dx\n$$\n\nWe can pull out the constants:\n$$\nJ = V_0 \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right) \\exp\\left(-\\frac{(x-a)^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi x}{a}\\right) \\, dx\n$$\n\nNext, we combine the arguments of the exponential functions:\n$$\n-\\frac{x^2}{\\sigma^2} - \\frac{(x-a)^2}{\\sigma^2} = -\\frac{1}{\\sigma^2} (x^2 + x^2 - 2ax + a^2) = -\\frac{1}{\\sigma^2} (2x^2 - 2ax + a^2)\n$$\nWe complete the square for the quadratic term in $x$:\n$$\n2x^2 - 2ax + a^2 = 2\\left(x^2 - ax\\right) + a^2 = 2\\left(\\left(x - \\frac{a}{2}\\right)^2 - \\frac{a^2}{4}\\right) + a^2 = 2\\left(x - \\frac{a}{2}\\right)^2 - \\frac{a^2}{2} + a^2 = 2\\left(x - \\frac{a}{2}\\right)^2 + \\frac{a^2}{2}\n$$\nSo the exponential term becomes:\n$$\n\\exp\\left(-\\frac{1}{\\sigma^2} \\left[2\\left(x - \\frac{a}{2}\\right)^2 + \\frac{a^2}{2}\\right]\\right) = \\exp\\left(-\\frac{2}{\\sigma^2}\\left(x - \\frac{a}{2}\\right)^2\\right) \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right)\n$$\n\nNow, we substitute this back into the integral for $J$:\n$$\nJ = V_0 \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2}{\\sigma^2}\\left(x - \\frac{a}{2}\\right)^2\\right) \\cos\\left(\\frac{2\\pi x}{a}\\right) \\, dx\n$$\n\nTo solve the integral, we perform a change of variables: $u = x - a/2$, which implies $x = u + a/2$ and $du = dx$. The integral becomes:\n$$\nI_{\\text{int}} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2u^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi}{a}\\left(u + \\frac{a}{2}\\right)\\right) \\, du\n$$\nUsing the identity $\\cos(A+B) = \\cos A \\cos B - \\sin A \\sin B$:\n$$\n\\cos\\left(\\frac{2\\pi u}{a} + \\pi\\right) = \\cos\\left(\\frac{2\\pi u}{a}\\right)\\cos(\\pi) - \\sin\\left(\\frac{2\\pi u}{a}\\right)\\sin(\\pi) = -\\cos\\left(\\frac{2\\pi u}{a}\\right)\n$$\nSo the integral simplifies to:\n$$\nI_{\\text{int}} = -\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2u^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi u}{a}\\right) \\, du\n$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} e^{-Ax^2} \\cos(kx) \\, dx = \\sqrt{\\frac{\\pi}{A}} e^{-k^2/(4A)}$.\nIn our case, $A = 2/\\sigma^2$ and $k = 2\\pi/a$.\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2u^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi u}{a}\\right) \\, du = \\sqrt{\\frac{\\pi}{2/\\sigma^2}} \\exp\\left(-\\frac{(2\\pi/a)^2}{4(2/\\sigma^2)}\\right)\n$$\n$$\n= \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{4\\pi^2/a^2}{8/\\sigma^2}\\right) = \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\n$$\nTherefore,\n$$\nI_{\\text{int}} = - \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\n$$\n\nFinally, we substitute this result back into the expression for $J$:\n$$\nJ = V_0 \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) \\left(- \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\\right)\n$$\nThe terms in the square roots cancel out:\n$$\n\\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\sqrt{\\frac{\\pi \\sigma^2}{2}} = \\sqrt{\\frac{2}{\\pi \\sigma^2} \\cdot \\frac{\\pi \\sigma^2}{2}} = \\sqrt{1} = 1\n$$\nThis leaves us with the final expression for $J$:\n$$\nJ = -V_0 \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\n$$\n$$\nJ = -V_0 \\exp\\left[-\\frac{1}{2}\\left(\\frac{a^2}{\\sigma^2} + \\frac{\\pi^2 \\sigma^2}{a^2}\\right)\\right]\n$$", "answer": "$$\n\\boxed{-V_0 \\exp\\left[-\\frac{1}{2}\\left(\\frac{a^2}{\\sigma^2} + \\frac{\\pi^2 \\sigma^2}{a^2}\\right)\\right]}\n$$", "id": "1279679"}, {"introduction": "The properties of Wannier functions are deeply intertwined with the underlying symmetries of the crystal. This exercise explores how inversion symmetry rigorously constrains the possible locations of Wannier function centers, pinning them to high-symmetry points within the unit cell. By connecting the center's position to the inversion eigenvalues of Bloch states, this problem offers a window into the topological aspects of band theory and the quantization of electronic polarization ([@problem_id:1279665]).", "problem": "Consider a one-dimensional insulator with lattice constant $a$. The crystal possesses inversion symmetry, and we choose the origin of the coordinate system, $x=0$, to be an inversion center. Consequently, all points $x=ma$ (where $m$ is an integer) are equivalent inversion centers.\n\nFor a single, isolated energy band, the cell-periodic part of the Bloch functions, $|u_k\\rangle$, can be chosen to be eigenstates of the inversion operator $\\hat{I}$ (where $(\\hat{I}f)(x) = f(-x)$) at the high-symmetry points of the Brillouin zone, $k=0$ and $k=\\pi/a$. The corresponding eigenvalues are $\\xi_0$ and $\\xi_{\\pi/a}$:\n$$\n\\hat{I}|u_0\\rangle = \\xi_0 |u_0\\rangle\n$$\n$$\n\\hat{I}|u_{\\pi/a}\\rangle = \\xi_{\\pi/a} |u_{\\pi/a}\\rangle\n$$\nwhere $\\xi_0, \\xi_{\\pi/a}$ can only take values of $+1$ or $-1$.\n\nA basis of localized Wannier functions $|W_R\\rangle$ can be constructed for this band, where $|W_R\\rangle$ is the Wannier function localized in the unit cell at lattice vector $R=ma$. The center of the Wannier function in the home unit cell ($R=0$) is given by the expectation value $\\bar{x} = \\langle W_0|\\hat{x}|W_0\\rangle$. By choosing the phases of the Bloch functions across the Brillouin zone appropriately, one can construct maximally localized Wannier functions (MLWFs). For a system with inversion symmetry, the centers of these MLWFs are pinned to high-symmetry positions.\n\nGiven the inversion eigenvalues $\\xi_0$ and $\\xi_{\\pi/a}$ for the Bloch states at $k=0$ and $k=\\pi/a$, determine the position of the Wannier center $\\bar{x}$ for the MLWF in the home unit cell. Your answer should be expressed in terms of $a$, $\\xi_0$, and $\\xi_{\\pi/a}$, and should lie in the interval $[0, a)$.", "solution": "1. The inversion eigenvalues at $k=0$ and $k=\\pi/a$ satisfy $\\xi_0,\\;\\xi_{\\pi/a}\\in\\{+1,-1\\}$.  Under inversion symmetry the single-band Wannier center $\\bar x$ in the home cell can only lie at $0$ or $a/2\\pmod a$.  Its value is determined by the product $\\xi_0\\xi_{\\pi/a}$:\n   - If $\\xi_0\\xi_{\\pi/a}=+1$, then $\\bar x=0$.\n   - If $\\xi_0\\xi_{\\pi/a}=-1$, then $\\bar x=a/2$.\n\n2. We may write a single expression that yields these two cases:\n$$\n\\bar x \\;=\\; a\\,\\frac{1 - \\xi_0\\,\\xi_{\\pi/a}}{4}.\n$$\nIndeed, for $\\xi_0\\xi_{\\pi/a}=+1$ this gives $\\bar x=0$, and for $\\xi_0\\xi_{\\pi/a}=-1$ it gives $\\bar x=a/2$.", "answer": "$$\\boxed{\\frac{a}{4}\\,\\bigl(1 - \\xi_0\\,\\xi_{\\pi/a}\\bigr)}$$", "id": "1279665"}, {"introduction": "Since the phase of Bloch functions can be chosen freely at each $k$-point, there are infinitely many valid sets of Wannier functions. The Marzari-Vanderbilt method provides a robust algorithm to find the unique set that is maximally localized. This exercise has you perform a critical mathematical step within that algorithm, which is essential for finding the Wannier centers, by calculating the logarithm of an inter-k-point overlap matrix ([@problem_id:1279731]).", "problem": "In the theory of electronic structure, maximally localized Wannier functions (MLWFs) provide a real-space representation of the electronic states in a periodic solid. They are constructed from the delocalized Bloch states $|\\psi_{n\\mathbf{k}}\\rangle$, where $n$ is the band index and $\\mathbf{k}$ is the crystal momentum in the Brillouin zone. The procedure for generating MLWFs, developed by Marzari and Vanderbilt, involves minimizing the total spatial spread of the Wannier functions.\n\nA key object in this procedure is the inter-k-point overlap matrix, whose elements are defined as $M_{mn}^{(\\mathbf{k}, \\mathbf{b})} = \\langle u_{m\\mathbf{k}} | u_{n, \\mathbf{k}+\\mathbf{b}} \\rangle$. Here, $|u_{n\\mathbf{k}}\\rangle = e^{-i\\mathbf{k}\\cdot\\mathbf{r}} |\\psi_{n\\mathbf{k}}\\rangle$ are the cell-periodic parts of the Bloch functions, and $\\mathbf{b}$ is a vector connecting neighboring k-points in a discretized mesh of the Brillouin zone. These matrices are unitary for any isolated group of bands.\n\nThe Wannier function centers, which encode the positions of the localized orbitals, are determined from the eigenvalues of these overlap matrices. This requires computing the matrix logarithm, $L = \\ln M$.\n\nConsider a simple two-band model where, for a specific k-point $\\mathbf{k}$ and its neighbor $\\mathbf{k}+\\mathbf{b}$, the overlap matrix is given by:\n$$\nM = \\begin{pmatrix} \\cos\\theta & i\\sin\\theta \\\\ i\\sin\\theta & \\cos\\theta \\end{pmatrix}\n$$\nwhere $\\theta$ is a real parameter determined by the system's Hamiltonian and the k-point mesh.\n\nYour task is to compute the trace of the square of the logarithm of this matrix, $\\mathrm{Tr}[(\\ln M)^2]$. Use the principal branch of the complex logarithm, which for a complex number $z = r e^{i\\phi}$ is defined as $\\ln z = \\ln r + i\\phi$ with $-\\pi < \\phi \\le \\pi$.", "solution": "We wish to compute $\\Tr[(\\ln M)^2]$ for \n\n$$\nM = \\begin{pmatrix}\\cos\\theta & i\\sin\\theta\\\\i\\sin\\theta & \\cos\\theta\\end{pmatrix}.\n$$\n\n\n1. Eigenvalues of $M$.  \n  Write \n  \n$$\n    M = \\cos\\theta\\,I + i\\sin\\theta\\,\\sigma_x,\n  $$\n\n  where $\\sigma_x$ has eigenvalues $\\pm1$.  Hence the eigenvalues of $M$ are\n  \n$$\n    \\lambda_{\\pm} = \\cos\\theta \\pm i\\sin\\theta = e^{\\pm i\\theta}.\n  $$\n\n\n2. Logarithm of the eigenvalues.  \n  On the principal branch with $-\\pi<\\theta\\le\\pi$,\n  \n$$\n    \\ln\\lambda_{+} = \\ln(e^{i\\theta}) = i\\theta,\n    \\quad\n    \\ln\\lambda_{-} = \\ln(e^{-i\\theta}) = -\\,i\\theta.\n  $$\n\n\n3. Square of the logarithms.  \n  \n$$\n    (\\ln\\lambda_{\\pm})^2 = (\\,\\pm i\\theta)^2 = -\\,\\theta^2.\n  $$\n\n\n4. Trace of $(\\ln M)^2$.  \n  Since trace is the sum of eigenvalues of $(\\ln M)^2$,\n  \n$$\n    \\Tr[(\\ln M)^2]\n    = (\\ln\\lambda_{+})^2 + (\\ln\\lambda_{-})^2\n    = -\\theta^2 + (-\\theta^2)\n    = -2\\,\\theta^2.\n  $$", "answer": "$$\\boxed{-2\\theta^2}$$", "id": "1279731"}]}