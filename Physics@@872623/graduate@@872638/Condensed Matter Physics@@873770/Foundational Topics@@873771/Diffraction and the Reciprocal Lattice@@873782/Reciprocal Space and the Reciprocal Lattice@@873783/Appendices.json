{"hands_on_practices": [{"introduction": "The relationship between a direct lattice and its reciprocal counterpart can reveal deep structural symmetries. This practice explores this relationship for a body-centered tetragonal (BCT) lattice, demonstrating the fundamental principle that the reciprocal of a body-centered lattice is face-centered. By deriving the reciprocal lattice from first principles, you will uncover the systematic selection rules that define its structure and learn how geometric parameters like the $c/a$ ratio influence its conventional crystallographic description [@problem_id:3013682]. This exercise solidifies the connection between the direct space centering translations and the resulting geometry of the reciprocal lattice.", "problem": "Consider a body-centered tetragonal direct lattice with conventional basis vectors $\\mathbf{a}_{1} = a\\,\\hat{\\mathbf{x}}$, $\\mathbf{a}_{2} = a\\,\\hat{\\mathbf{y}}$, and $\\mathbf{a}_{3} = c\\,\\hat{\\mathbf{z}}$, and a body-centering translation $\\mathbf{t} = \\frac{1}{2}(\\mathbf{a}_{1} + \\mathbf{a}_{2} + \\mathbf{a}_{3})$. Let a primitive basis for this lattice be constructed from three vectors $\\mathbf{p}_{1}$, $\\mathbf{p}_{2}$, and $\\mathbf{p}_{3}$ chosen so that the volume defined by $\\mathbf{p}_{1}\\cdot(\\mathbf{p}_{2}\\times\\mathbf{p}_{3})$ equals the primitive cell volume. Starting from the fundamental definition of the reciprocal lattice as the set of all wavevectors $\\mathbf{G}$ that satisfy $\\exp(i\\,\\mathbf{G}\\cdot\\mathbf{R})=1$ for every direct-lattice vector $\\mathbf{R}$, and the core formula for the reciprocal primitive vectors $\\mathbf{g}_{i}$ in terms of $\\mathbf{p}_{i}$, derive the primitive reciprocal vectors of the body-centered tetragonal lattice. Using only these definitions, determine the centering type of the reciprocal lattice by analyzing the constraint imposed by the body-centering translation on the allowed integer linear combinations of a convenient orthogonal reciprocal basis, and then construct a minimal conventional tetragonal cell for the reciprocal lattice through an explicit unimodular integer transformation of the orthogonal basis. Finally, find the critical value of the axial ratio $c/a$ at which the conventional description of the reciprocal lattice naturally switches between two crystallographically equivalent centered tetragonal descriptions related by a $45^{\\circ}$ rotation of the basal plane, identifying the case when the reciprocal lattice is most naturally represented as base-centered tetragonal. Your final answer must be the single closed-form value of this critical ratio. No numerical approximation is required.", "solution": "We begin by specifying a primitive basis for the body-centered tetragonal direct lattice. A standard choice is\n$$\n\\mathbf{p}_{1} = \\frac{1}{2}(a\\,\\hat{\\mathbf{x}} + a\\,\\hat{\\mathbf{y}}),\\quad\n\\mathbf{p}_{2} = \\frac{1}{2}(a\\,\\hat{\\mathbf{x}} + c\\,\\hat{\\mathbf{z}}),\\quad\n\\mathbf{p}_{3} = \\frac{1}{2}(a\\,\\hat{\\mathbf{y}} + c\\,\\hat{\\mathbf{z}}).\n$$\nThe primitive cell volume is\n$$\nV \\equiv \\mathbf{p}_{1}\\cdot(\\mathbf{p}_{2}\\times\\mathbf{p}_{3}).\n$$\nComputing the cross products and dot product explicitly,\n\n$$\n\\mathbf{p}_{2}\\times\\mathbf{p}_{3} =\n\\begin{vmatrix}\n\\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\\n\\frac{a}{2} & 0 & \\frac{c}{2} \\\\\n0 & \\frac{a}{2} & \\frac{c}{2}\n\\end{vmatrix}\n= \\left(-\\frac{ac}{4},\\,-\\frac{ac}{4},\\,\\frac{a^{2}}{4}\\right),\n$$\n\nand\n\n$$\nV = \\mathbf{p}_{1}\\cdot(\\mathbf{p}_{2}\\times\\mathbf{p}_{3}) = \\left(\\frac{a}{2},\\,\\frac{a}{2},\\,0\\right)\\cdot\\left(-\\frac{ac}{4},\\,-\\frac{ac}{4},\\,\\frac{a^{2}}{4}\\right) = -\\frac{a^{2}c}{4}.\n$$\n\nThus $|V| = \\frac{a^{2}c}{4}$.\n\nBy the fundamental definition of reciprocal primitive vectors,\n$$\n\\mathbf{g}_{1} = 2\\pi\\,\\frac{\\mathbf{p}_{2}\\times\\mathbf{p}_{3}}{V},\\quad\n\\mathbf{g}_{2} = 2\\pi\\,\\frac{\\mathbf{p}_{3}\\times\\mathbf{p}_{1}}{V},\\quad\n\\mathbf{g}_{3} = 2\\pi\\,\\frac{\\mathbf{p}_{1}\\times\\mathbf{p}_{2}}{V}.\n$$\nWe compute:\n\n$$\n\\mathbf{g}_{1} = 2\\pi\\,\\frac{(-ac/4,\\,-ac/4,\\,a^{2}/4)}{-a^{2}c/4} = 2\\pi\\left(\\frac{1}{a},\\,\\frac{1}{a},\\,-\\frac{1}{c}\\right),\n$$\n\n\n$$\n\\mathbf{p}_{3}\\times\\mathbf{p}_{1} =\n\\begin{vmatrix}\n\\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\\n0 & \\frac{a}{2} & \\frac{c}{2} \\\\\n\\frac{a}{2} & \\frac{a}{2} & 0\n\\end{vmatrix}\n= \\left(-\\frac{ac}{4},\\,\\frac{ac}{4},\\,-\\frac{a^{2}}{4}\\right),\n$$\n\nso\n\n$$\n\\mathbf{g}_{2} = 2\\pi\\,\\frac{(-ac/4,\\,ac/4,\\,-a^{2}/4)}{-a^{2}c/4}\n= 2\\pi\\left(\\frac{1}{a},\\,-\\frac{1}{a},\\,\\frac{1}{c}\\right),\n$$\n\nand\n\n$$\n\\mathbf{p}_{1}\\times\\mathbf{p}_{2} =\n\\begin{vmatrix}\n\\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\\n\\frac{a}{2} & \\frac{a}{2} & 0 \\\\\n\\frac{a}{2} & 0 & \\frac{c}{2}\n\\end{vmatrix}\n= \\left(\\frac{ac}{4},\\,-\\frac{ac}{4},\\,-\\frac{a^{2}}{4}\\right),\n$$\n\nso\n\n$$\n\\mathbf{g}_{3} = 2\\pi\\,\\frac{(ac/4,\\,-ac/4,\\,-a^{2}/4)}{-a^{2}c/4}\n= 2\\pi\\left(-\\frac{1}{a},\\,\\frac{1}{a},\\,\\frac{1}{c}\\right).\n$$\n\n\nA convenient orthogonal reciprocal basis aligned with the conventional tetragonal axes is\n\n$$\n\\mathbf{b}_{1} = 2\\pi\\,\\frac{1}{a}\\,\\hat{\\mathbf{x}},\\quad\n\\mathbf{b}_{2} = 2\\pi\\,\\frac{1}{a}\\,\\hat{\\mathbf{y}},\\quad\n\\mathbf{b}_{3} = 2\\pi\\,\\frac{1}{c}\\,\\hat{\\mathbf{z}}.\n$$\n\nUsing these, the primitive reciprocal vectors can be expressed as\n\n$$\n\\mathbf{g}_{1} = \\mathbf{b}_{1} + \\mathbf{b}_{2} - \\mathbf{b}_{3},\\quad\n\\mathbf{g}_{2} = \\mathbf{b}_{1} - \\mathbf{b}_{2} + \\mathbf{b}_{3},\\quad\n\\mathbf{g}_{3} = -\\mathbf{b}_{1} + \\mathbf{b}_{2} + \\mathbf{b}_{3}.\n$$\n\nAny reciprocal lattice vector is an integer combination\n\n$$\n\\mathbf{G} = m\\,\\mathbf{g}_{1} + n\\,\\mathbf{g}_{2} + p\\,\\mathbf{g}_{3},\n$$\n\nwhich can be rewritten in the orthogonal basis as\n\n$$\n\\mathbf{G} = u\\,\\mathbf{b}_{1} + v\\,\\mathbf{b}_{2} + w\\,\\mathbf{b}_{3},\n$$\n\nwith the integer coefficients $(u,v,w)$ given by\n\n$$\nu = m + n - p,\\quad v = m - n + p,\\quad w = -m + n + p.\n$$\n\nFrom these relations,\n\n$$\nu + v = 2m,\\quad v + w = 2p,\\quad u + w = 2n,\n$$\n\nwhich implies $u+v$, $v+w$, and $u+w$ are all even. Equivalently, $u$, $v$, and $w$ have the same parity (either all even or all odd). This centering condition shows that the reciprocal lattice is not the full simple tetragonal lattice generated by $\\mathbf{b}_{1},\\mathbf{b}_{2},\\mathbf{b}_{3}$; it is a centered sublattice. In crystallographic language, the reciprocal of a body-centered tetragonal lattice is a face-centered tetragonal lattice in the orthogonal basis $\\{\\mathbf{b}_{i}\\}$, because the parity constraint on $(u,v,w)$ is the hallmark of face-centering in this conventional frame. However, a face-centered tetragonal (FCT) lattice is crystallographically equivalent to a body-centered tetragonal (BCT) lattice, and a conventional choice for the new BCT cell involves a $45^{\\circ}$ rotation of the basal plane. A natural choice for the rotated basal vectors is\n\n$$\n\\mathbf{B}_{1} = \\mathbf{b}_{1} + \\mathbf{b}_{2},\\quad\n\\mathbf{B}_{2} = \\mathbf{b}_{1} - \\mathbf{b}_{2},\\quad\n\\mathbf{B}_{3} = \\mathbf{b}_{3}.\n$$\n\nThese satisfy $|\\mathbf{B}_{1}| = |\\mathbf{B}_{2}| = \\sqrt{2}\\,|\\mathbf{b}_{1}| = \\sqrt{2}\\,\\frac{2\\pi}{a}$ and $|\\mathbf{B}_{3}| = \\frac{2\\pi}{c}$, and they define a conventional tetragonal cell. In this conventional reciprocal cell, the axial ratio is\n\n$$\n\\frac{c^{*}}{a^{*}_{\\mathrm{C}}} = \\frac{|\\mathbf{B}_{3}|}{|\\mathbf{B}_{1}|} = \\frac{\\frac{2\\pi}{c}}{\\sqrt{2}\\,\\frac{2\\pi}{a}} = \\frac{a}{\\sqrt{2}\\,c} = \\frac{1}{\\sqrt{2}}\\frac{1}{(c/a)}.\n$$\n\nThe qualitative description of the centered tetragonal type obtained after this $45^{\\circ}$ rotation hinges on whether this ratio is greater than $1$ or less than $1$. The switch occurs when this ratio is unity:\n\n$$\n\\frac{a}{\\sqrt{2}\\,c} = 1\\quad\\Longleftrightarrow\\quad \\frac{c}{a} = \\frac{1}{\\sqrt{2}}.\n$$\n\nThus, the critical axial ratio in the direct body-centered tetragonal lattice that marks the transition in the most natural conventional centered tetragonal description of its reciprocal (between the two equivalent centered tetragonal representations related by a $45^{\\circ}$ basal rotation) is $c/a = 1/\\sqrt{2}$. For $c/a < 1/\\sqrt{2}$ the rotated cell has $c^{*}/a^{*}_{\\mathrm{C}} > 1$; for $c/a > 1/\\sqrt{2}$ it has $c^{*}/a^{*}_{\\mathrm{C}} < 1$. The value $c/a = 1/\\sqrt{2}$ is the unique critical point requested.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$", "id": "3013682"}, {"introduction": "Moving beyond pure crystallography, the reciprocal lattice provides the stage for describing the behavior of waves, such as electrons, in a crystal. The geometry of the energy dispersion function $\\varepsilon(\\mathbf{k})$ within the Brillouin zone has profound consequences for a material's electronic properties. This exercise challenges you to find van Hove singularities, which are features in the electronic density of states that arise from points where the band velocity vanishes [@problem_id:3013711]. By analyzing the topology of the energy surface, you will connect stationary points—specifically saddle points—to observable divergences in the density of states, a cornerstone of solid-state theory.", "problem": "Consider electrons on a two-dimensional ($2\\mathrm{D}$) square Bravais lattice with lattice constant $a$, described within a single-band tight-binding model with real nearest-neighbor hopping $t>0$ and next-nearest-neighbor hopping $t'$. The first Brillouin zone (BZ) is the square $\\{(k_x,k_y): -\\pi/a \\le k_x \\le \\pi/a,\\,-\\pi/a \\le k_y \\le \\pi/a\\}$. The Bloch dispersion is\n$$\n\\varepsilon(\\mathbf{k}) \\equiv \\varepsilon(k_x,k_y) = -2t\\big[\\cos(k_x a)+\\cos(k_y a)\\big] \\;-\\; 4t'\\,\\cos(k_x a)\\cos(k_y a),\n$$\nwith the parameter regime $|t'/t|1/2$ so that no additional stationary points appear away from high-symmetry points.\n\nUsing only the definition of the single-particle density of states (DOS)\n$$\nD(\\varepsilon) = \\frac{1}{(2\\pi)^2}\\int_{\\mathrm{BZ}} \\mathrm{d}^2k\\;\\delta\\!\\big(\\varepsilon-\\varepsilon(\\mathbf{k})\\big),\n$$\nand the characterization of van Hove singularities as nonanalyticities of $D(\\varepsilon)$ originating from stationary points of $\\varepsilon(\\mathbf{k})$ in reciprocal space, carry out the following:\n\n- Determine all stationary points $\\mathbf{k}_0$ of $\\varepsilon(\\mathbf{k})$ in the first Brillouin zone by solving $\\nabla_{\\mathbf{k}}\\varepsilon(\\mathbf{k}_0)=\\mathbf{0}$.\n- For each stationary point, compute the Hessian matrix of second derivatives of $\\varepsilon(\\mathbf{k})$ and classify the point as a minimum, maximum, or saddle point by the signs of the principal curvatures.\n- Using a local quadratic expansion of $\\varepsilon(\\mathbf{k})$ about a stationary point and the DOS definition above, justify which class of stationary point yields a divergence in $D(\\varepsilon)$ and identify the energies at which such divergences occur.\n- From this analysis, extract the energy of the van Hove singularity, $\\varepsilon_{\\mathrm{vH}}$, in terms of $t$ and $t'$.\n\nReport your final answer as the single closed-form expression for the ratio $\\varepsilon_{\\mathrm{vH}}/t$ (that is, express the van Hove energy in units of the nearest-neighbor hopping $t$). No numerical rounding is required.", "solution": "The problem statement is scientifically grounded, well-posed, and self-contained, providing a valid basis for a rigorous analytical solution.\n\nThe energy dispersion for electrons in a single-band tight-binding model on a two-dimensional square lattice with nearest-neighbor hopping $t$ and next-nearest-neighbor hopping $t'$ is given by\n$$\n\\varepsilon(\\mathbf{k}) = \\varepsilon(k_x, k_y) = -2t\\big[\\cos(k_x a)+\\cos(k_y a)\\big] - 4t'\\,\\cos(k_x a)\\cos(k_y a)\n$$\nwhere $a$ is the lattice constant. The first Brillouin zone (BZ) is a square defined by $-\\frac{\\pi}{a} \\le k_x, k_y \\le \\frac{\\pi}{a}$.\n\nVan Hove singularities in the density of states $D(\\varepsilon)$ arise from stationary points of the dispersion relation $\\varepsilon(\\mathbf{k})$, where the group velocity $\\mathbf{v}_g(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}\\varepsilon(\\mathbf{k})$ vanishes. We thus need to solve $\\nabla_{\\mathbf{k}}\\varepsilon(\\mathbf{k}) = \\mathbf{0}$.\n\nThe components of the gradient are:\n\\begin{align*}\n\\frac{\\partial\\varepsilon}{\\partial k_x} = -2t(-\\sin(k_x a) \\cdot a) - 4t'(-\\sin(k_x a) \\cdot a \\cdot \\cos(k_y a)) \\\\\n= 2a\\sin(k_x a) [t + 2t'\\cos(k_y a)] \\\\\n\\frac{\\partial\\varepsilon}{\\partial k_y} = -2t(-\\sin(k_y a) \\cdot a) - 4t'(\\cos(k_x a) \\cdot (-\\sin(k_y a) \\cdot a)) \\\\\n= 2a\\sin(k_y a) [t + 2t'\\cos(k_x a)]\n\\end{align*}\nSetting both partial derivatives to zero gives the system of equations:\n\\begin{align*}\n\\sin(k_x a) [t + 2t'\\cos(k_y a)] = 0 \\\\\n\\sin(k_y a) [t + 2t'\\cos(k_x a)] = 0\n\\end{align*}\nThese equations must be solved for $\\mathbf{k}=(k_x, k_y)$ within the first BZ. One possible set of solutions comes from $\\sin(k_x a) = 0$ and $\\sin(k_y a) = 0$. This implies $k_x a \\in \\{0, \\pm\\pi\\}$ and $k_y a \\in \\{0, \\pm\\pi\\}$. These correspond to the high-symmetry points in the BZ:\n\\begin{itemize}\n    \\item $\\mathbf{\\Gamma}$ point: $(k_x, k_y) = (0, 0)$.\n    \\item $\\mathbf{X}$ points: $(k_x, k_y) = (\\pm\\pi/a, 0)$ and $(0, \\pm\\pi/a)$.\n    \\item $\\mathbf{M}$ points: $(k_x, k_y) = (\\pm\\pi/a, \\pm\\pi/a)$.\n\\end{itemize}\nAnother possibility is that the terms in the brackets are zero: $t + 2t'\\cos(k_y a) = 0$ and $t + 2t'\\cos(k_x a) = 0$. This would imply $\\cos(k_x a) = \\cos(k_y a) = -t/(2t')$. However, the problem states the parameter regime is $|t'/t|  1/2$, which means $|t/(2t')|  1$. Since the cosine function cannot exceed $1$ in magnitude, this second case has no solutions. Thus, the only stationary points are the high-symmetry points listed above.\n\nTo classify these stationary points, we compute the Hessian matrix $H_{ij} = \\frac{\\partial^2\\varepsilon}{\\partial k_i \\partial k_j}$. The second derivatives are:\n\\begin{align*}\n\\frac{\\partial^2\\varepsilon}{\\partial k_x^2} = 2a^2\\cos(k_x a)[t + 2t'\\cos(k_y a)] \\\\\n\\frac{\\partial^2\\varepsilon}{\\partial k_y^2} = 2a^2\\cos(k_y a)[t + 2t'\\cos(k_x a)] \\\\\n\\frac{\\partial^2\\varepsilon}{\\partial k_x \\partial k_y} = 4a^2t'\\sin(k_x a)\\sin(k_y a)\n\\end{align*}\n\nAt the stationary points, the off-diagonal terms vanish, and the Hessian is diagonal. The signs of the diagonal elements (which are proportional to the principal curvatures) determine the nature of the extremum.\n\n\\begin{enumerate}\n    \\item At the $\\mathbf{\\Gamma}$ point, $(k_x, k_y) = (0,0)$:\n    $H_{xx} = 2a^2(t+2t')$, $H_{yy} = 2a^2(t+2t')$.\n    Given $t0$ and $|t'/t|1/2$, it follows that $-t/2  t'  t/2$, so $0  t+2t'  2t$. Both curvatures are positive, so this is a local minimum (the band bottom). The energy is $\\varepsilon_\\Gamma = -4t-4t'$.\n\n    \\item At the $\\mathbf{M}$ point, $(k_x, k_y) = (\\pi/a, \\pi/a)$:\n    $H_{xx} = -2a^2(t-2t')$, $H_{yy} = -2a^2(t-2t')$.\n    From $|t'/t|1/2$, we have $0  t-2t'  2t$. The curvatures are thus both negative. This is a local maximum (the band top). The energy is $\\varepsilon_M = 4t-4t'$.\n\n    \\item At the $\\mathbf{X}$ point, $(k_x, k_y) = (\\pi/a, 0)$:\n    $H_{xx} = -2a^2(t-2t')$, $H_{yy} = 2a^2(t+2t')$.\n    As established, $t-2t'  0$ and $t+2t'  0$. Therefore, $H_{xx}  0$ and $H_{yy}  0$. The curvatures have opposite signs, so this is a saddle point. The analysis for $(0, \\pi/a)$ is identical by symmetry. The energy at these saddle points is:\n    $$\n    \\varepsilon(\\pi/a, 0) = -2t[\\cos(\\pi)+\\cos(0)] - 4t'\\cos(\\pi)\\cos(0) = -2t(-1+1) - 4t'(-1)(1) = 4t'\n    $$\n\\end{enumerate}\n\nNow we must determine which type of stationary point leads to a divergence in the density of states $D(\\varepsilon)$. The DOS is defined as:\n$$\nD(\\varepsilon) = \\frac{1}{(2\\pi)^2}\\int_{\\mathrm{BZ}} \\mathrm{d}^2k\\;\\delta(\\varepsilon-\\varepsilon(\\mathbf{k}))\n$$\nNear a stationary point $\\mathbf{k}_0$ with energy $\\varepsilon_0 = \\varepsilon(\\mathbf{k}_0)$, we can use a local quadratic expansion of the dispersion. After rotating coordinates to align with the principal axes of the Hessian, the expansion is:\n$$\n\\varepsilon(\\mathbf{q}) \\approx \\varepsilon_0 + \\frac{1}{2}\\lambda_1 q_1^2 + \\frac{1}{2}\\lambda_2 q_2^2\n$$\nwhere $\\mathbf{q} = \\mathbf{k} - \\mathbf{k}_0$ and $\\lambda_1, \\lambda_2$ are the eigenvalues of the Hessian matrix.\nFor a minimum or maximum, $\\lambda_1$ and $\\lambda_2$ have the same sign. The iso-energy surfaces are ellipses. In $2\\mathrm{D}$, this leads to a step-function discontinuity in $D(\\varepsilon)$ at $\\varepsilon_0$. For example, at a minimum ($\\lambda_1, \\lambda_2  0$), the phase space volume with energy below $\\varepsilon$ is the area of an ellipse, which is proportional to $(\\varepsilon - \\varepsilon_0)$. The DOS, being the derivative of this volume, is a constant for $\\varepsilon  \\varepsilon_0$ and zero for $\\varepsilon  \\varepsilon_0$. This is a discontinuity, but not a divergence.\n\nFor a saddle point, $\\lambda_1$ and $\\lambda_2$ have opposite signs, e.g., $\\lambda_10, \\lambda_20$. The expansion is:\n$$\n\\varepsilon(\\mathbf{q}) \\approx \\varepsilon_0 + \\frac{1}{2}\\lambda_1 q_1^2 - \\frac{1}{2}|\\lambda_2| q_2^2\n$$\nLet's analyze the DOS integral for $\\varepsilon \\approx \\varepsilon_0$. Let $\\Delta\\varepsilon = \\varepsilon - \\varepsilon_0$.\n$$\nD(\\varepsilon) \\propto \\iint \\mathrm{d}q_1 \\mathrm{d}q_2 \\; \\delta\\left(\\Delta\\varepsilon - \\frac{1}{2}\\lambda_1 q_1^2 + \\frac{1}{2}|\\lambda_2| q_2^2\\right)\n$$\nIntegrating over $q_2$ first, this yields a result proportional to $\\int \\frac{\\mathrm{d}q_1}{\\sqrt{\\frac{1}{2}\\lambda_1 q_1^2 - \\Delta\\varepsilon}}$. This integral, evaluated between appropriate limits, behaves as $-\\ln|\\Delta\\varepsilon| = -\\ln|\\varepsilon - \\varepsilon_0|$ as $\\Delta\\varepsilon \\to 0$. This logarithmic divergence is the van Hove singularity.\n\nTherefore, the van Hove singularity occurs at the energy of the saddle points. From our earlier calculation, the energy of the saddle points at $(\\pm\\pi/a, 0)$ and $(0, \\pm\\pi/a)$ is:\n$$\n\\varepsilon_{\\mathrm{vH}} = 4t'\n$$\nThe problem asks for the ratio of this energy to the nearest-neighbor hopping parameter $t$.\n$$\n\\frac{\\varepsilon_{\\mathrm{vH}}}{t} = \\frac{4t'}{t}\n$$", "answer": "$$\\boxed{\\frac{4t'}{t}}$$", "id": "3013711"}, {"introduction": "Many crucial physical quantities, such as total energy or density of states, are calculated by integrating functions over the Brillouin zone. While analytical solutions are rare, numerical methods provide powerful tools for these calculations. This computational practice guides you through implementing and comparing two essential Brillouin zone integration techniques: the Monkhorst-Pack sampling and the linear tetrahedron method [@problem_id:3013667]. By first deriving an exact analytical result for a model system, you will gain hands-on experience in evaluating the accuracy and convergence of these foundational algorithms used extensively in modern computational condensed matter physics.", "problem": "You are to implement a numerical comparison of two Brillouin zone integration schemes in reciprocal space for a model band structure on a simple cubic lattice. The reciprocal lattice of a simple cubic Bravais lattice with lattice constant $a$ is also simple cubic with reciprocal lattice vectors spanning the Brillouin zone (BZ) defined by the cube $[-\\pi/a,\\pi/a]^3$. Set $a=1$, so the BZ is $[-\\pi,\\pi]^3$, and all wavevectors are in radians. Consider a single-band nearest-neighbor tight-binding dispersion, $E(\\mathbf{k})=-2t\\left[\\cos(k_x)+\\cos(k_y)+\\cos(k_z)\\right]$, with $t=1$, where $k_x$, $k_y$, and $k_z$ are the components of $\\mathbf{k}$ in radians. The target quantity to integrate over the Brillouin zone is $I=\\int_{\\mathrm{BZ}} E(\\mathbf{k})^2 \\,\\mathrm{d}^3k$. This quantity is a real-valued scalar and has units of electronvolt squared times radian cubed, but for this problem you will report numerical float values for errors only.\n\nYour program must compute $I$ numerically in two ways and compare their accuracy:\n- Tetrahedron method: Partition the Brillouin zone into a uniform grid of $m$ subdivisions per axis, creating $m^3$ small cubes. Each small cube is decomposed into $6$ tetrahedra using a consistent simplex decomposition associated with the body diagonal from the corner at $(i,j,\\ell)$ to $(i+1,j+1,\\ell+1)$ (Freudenthal triangulation). Within each tetrahedron, approximate $E(\\mathbf{k})^2$ by linear interpolation from values at the tetrahedron’s vertices and integrate exactly over the tetrahedron volume. The integral of a linear function over a tetrahedron equals the tetrahedron volume times the average of the function values at the four vertices. Use this to obtain the numerical integral $I_{\\mathrm{tet}}$.\n- Monkhorst–Pack (MP) sampling: Construct a uniform Monkhorst–Pack grid with $m$ points per axis and a shift parameter $s\\in\\{0,0.5\\}$. Let the grid spacing be $h=2\\pi/m$. For each integer triple $(i,j,\\ell)$ with $0\\leq i,j,\\ell\\leq m-1$, define the sampling point $\\mathbf{k}_{i,j,\\ell}=\\left(-\\pi+(i+s)h,\\,-\\pi+(j+s)h,\\,-\\pi+(\\ell+s)h\\right)$ in radians. Approximate the integral by a Riemann sum $I_{\\mathrm{MP}}\\approx \\sum_{i,j,\\ell} E(\\mathbf{k}_{i,j,\\ell})^2\\,h^3$.\n\nUse the following fundamental base for derivation:\n- The Brillouin zone of a simple cubic lattice with $a=1$ spans $[-\\pi,\\pi]^3$ in reciprocal space.\n- The dispersion $E(\\mathbf{k})$ is given as above and is a well-tested model in solid state physics.\n- The integral over the Brillouin zone is defined as a volume integral in reciprocal space.\n- The integral of a linear function over a tetrahedron equals the tetrahedron volume times the average of the function values at the four vertices.\n\nDerive the exact analytic value $I_{\\mathrm{exact}}$ starting from the stated dispersion and basic trigonometric identities without invoking any shortcut formulas for solid-state integrals. Then implement both numerical methods to approximate $I$ and compute the absolute errors $|I_{\\mathrm{tet}}-I_{\\mathrm{exact}}|$ and $|I_{\\mathrm{MP}}-I_{\\mathrm{exact}}|$ for each test case. Angles must be in radians.\n\nDesign details for the tetrahedron method on each small cube between grid indices $(i,j,\\ell)$ and $(i+1,j+1,\\ell+1)$:\n- Label the cube’s vertices by local indices $0$ through $7$ as $0=(i,j,\\ell)$, $1=(i+1,j,\\ell)$, $2=(i,j+1,\\ell)$, $3=(i+1,j+1,\\ell)$, $4=(i,j,\\ell+1)$, $5=(i+1,j,\\ell+1)$, $6=(i,j+1,\\ell+1)$, $7=(i+1,j+1,\\ell+1)$.\n- Decompose the cube into $6$ tetrahedra with vertex index sets $[0,1,3,7]$, $[0,1,5,7]$, $[0,2,3,7]$, $[0,2,6,7]$, $[0,4,5,7]$, $[0,4,6,7]$.\n- The tetrahedron volume in physical units is $(h^3)/6$, where $h=2\\pi/m$. The integral of the linear interpolant of $E(\\mathbf{k})^2$ over one tetrahedron equals $(h^3/24)$ times the sum of the values of $E(\\mathbf{k})^2$ at its four vertices.\n\nYour program must implement both methods, compute the absolute errors, and aggregate the results for the provided test suite. All computations must use radians. No external input is allowed; all parameters are fixed in the program.\n\nTest suite:\n- Case 1: $m=1$, $s=0$.\n- Case 2: $m=1$, $s=0.5$.\n- Case 3: $m=4$, $s=0.5$.\n- Case 4: $m=8$, $s=0.5$.\n- Case 5: $m=12$, $s=0.5$.\n\nFor each case, the program must output a single line containing a comma-separated list enclosed in square brackets, where each element is a two-element list $[e_{\\mathrm{tet}},e_{\\mathrm{MP}}]$ consisting of the absolute error for the tetrahedron method and the absolute error for the Monkhorst–Pack sampling, respectively, both as floats. For example, the output format must be like $[[e_{1,\\mathrm{tet}},e_{1,\\mathrm{MP}}],[e_{2,\\mathrm{tet}},e_{2,\\mathrm{MP}}],\\ldots]$ on a single line with no extra text.", "solution": "The problem requires the numerical comparison of two Brillouin zone integration schemes, the tetrahedron method and Monkhorst-Pack sampling, for a given tight-binding energy dispersion on a simple cubic lattice. First, we must derive the exact analytical value of the integral to serve as a benchmark. Then, we formulate the algorithms for both numerical methods as specified.\n\nThe physical parameters are set to unity, i.e., lattice constant $a=1$ and hopping parameter $t=1$. The Brillouin Zone (BZ) is the cube $[-\\pi, \\pi]^3$. The energy dispersion is given by:\n$$ E(\\mathbf{k}) = -2(\\cos(k_x) + \\cos(k_y) + \\cos(k_z)) $$\nThe quantity to be integrated over the BZ is $f(\\mathbf{k}) = E(\\mathbf{k})^2$. The integral is:\n$$ I = \\int_{\\mathrm{BZ}} E(\\mathbf{k})^2 \\,d^3k = \\int_{-\\pi}^{\\pi} \\int_{-\\pi}^{\\pi} \\int_{-\\pi}^{\\pi} E(k_x, k_y, k_z)^2 \\,dk_x \\,dk_y \\,dk_z $$\n\n**1. Analytical Derivation of $I_{\\mathrm{exact}}$**\n\nWe first expand the integrand $E(\\mathbf{k})^2$:\n$$ E(\\mathbf{k})^2 = [-2(\\cos(k_x) + \\cos(k_y) + \\cos(k_z))]^2 $$\n$$ E(\\mathbf{k})^2 = 4(\\cos^2(k_x) + \\cos^2(k_y) + \\cos^2(k_z) + 2\\cos(k_x)\\cos(k_y) + 2\\cos(k_x)\\cos(k_z) + 2\\cos(k_y)\\cos(k_z)) $$\nThe integral of this expression over the cubic BZ $[-\\pi, \\pi]^3$ can be evaluated term by term. The integrals of the cross-terms, such as $2\\cos(k_x)\\cos(k_y)$, vanish. This is because the integral over each variable is separable:\n$$ \\int_{-\\pi}^{\\pi} \\int_{-\\pi}^{\\pi} \\int_{-\\pi}^{\\pi} 2\\cos(k_x)\\cos(k_y) \\,dk_x \\,dk_y \\,dk_z = 2 \\left( \\int_{-\\pi}^{\\pi} \\cos(k_x) dk_x \\right) \\left( \\int_{-\\pi}^{\\pi} \\cos(k_y) dk_y \\right) \\left( \\int_{-\\pi}^{\\pi} dk_z \\right) $$\nThe integral of $\\cos(k)$ over $[-\\pi, \\pi]$ is zero:\n$$ \\int_{-\\pi}^{\\pi} \\cos(k) \\,dk = [\\sin(k)]_{-\\pi}^{\\pi} = \\sin(\\pi) - \\sin(-\\pi) = 0 - 0 = 0 $$\nTherefore, all three cross-terms in the expansion of $E(\\mathbf{k})^2$ integrate to zero. We are left with the squared terms:\n$$ I = 4 \\int_{\\mathrm{BZ}} (\\cos^2(k_x) + \\cos^2(k_y) + \\cos^2(k_z)) \\,d^3k $$\nBy symmetry, the integral of each $\\cos^2(k_i)$ term will be the same. Let's compute the integral for the $\\cos^2(k_x)$ term:\n$$ \\int_{\\mathrm{BZ}} \\cos^2(k_x) \\,d^3k = \\left( \\int_{-\\pi}^{\\pi} \\cos^2(k_x) dk_x \\right) \\left( \\int_{-\\pi}^{\\pi} dk_y \\right) \\left( \\int_{-\\pi}^{\\pi} dk_z \\right) $$\nThe required integrals are:\n$$ \\int_{-\\pi}^{\\pi} 1 \\,dk = 2\\pi $$\n$$ \\int_{-\\pi}^{\\pi} \\cos^2(k) \\,dk = \\int_{-\\pi}^{\\pi} \\frac{1 + \\cos(2k)}{2} \\,dk = \\left[ \\frac{k}{2} + \\frac{\\sin(2k)}{4} \\right]_{-\\pi}^{\\pi} = \\left(\\frac{\\pi}{2}\\right) - \\left(-\\frac{\\pi}{2}\\right) = \\pi $$\nSubstituting these results back, the integral of the $\\cos^2(k_x)$ term is:\n$$ \\int_{\\mathrm{BZ}} \\cos^2(k_x) \\,d^3k = (\\pi)(2\\pi)(2\\pi) = 4\\pi^3 $$\nThe total integral $I$ is the sum of the contributions from the three symmetric terms:\n$$ I_{\\mathrm{exact}} = 4 (4\\pi^3 + 4\\pi^3 + 4\\pi^3) = 4(12\\pi^3) = 48\\pi^3 $$\nThis is the exact analytical value, which will be used to compute the errors of the numerical methods.\n\n**2. Numerical Integration Schemas**\n\n**2.1. Monkhorst-Pack (MP) Sampling**\nThe MP method approximates the integral by a weighted sum of the function values at a set of special points (k-points) in the BZ. For an $m \\times m \\times m$ grid with shift $s$, the k-points are:\n$$ \\mathbf{k}_{i,j,\\ell} = (-\\pi+(i+s)h, \\,-\\pi+(j+s)h, \\,-\\pi+(\\ell+s)h) $$\nwhere $h = 2\\pi/m$ is the grid spacing, and $i, j, \\ell$ are integers from $0$ to $m-1$. The integral is approximated by the Riemann sum:\n$$ I_{\\mathrm{MP}} = \\sum_{i,j,\\ell=0}^{m-1} E(\\mathbf{k}_{i,j,\\ell})^2 \\Delta V_{\\mathbf{k}} $$\nwhere the volume element per k-point is $\\Delta V_{\\mathbf{k}} = h^3 = (2\\pi/m)^3$. The algorithm consists of generating the specified grid of k-points, evaluating $E(\\mathbf{k})^2$ at each point, summing the results, and multiplying by $h^3$.\n\n**2.2. Tetrahedron Method**\nThis method partitions the BZ into a grid of $m^3$ small cubes of side length $h=2\\pi/m$. The grid vertices are at positions $\\mathbf{k}_{i,j,\\ell} = (-\\pi+ih, \\, -\\pi+jh, \\, -\\pi+\\ell h)$ for $i,j,\\ell \\in \\{0, \\dots, m\\}$. The function $E(\\mathbf{k})^2$ is evaluated at these $(m+1)^3$ vertices.\n\nEach small cube is decomposed into $6$ tetrahedra. The problem specifies a Freudenthal triangulation relative to the main diagonal connecting local vertices $0=(i,j,\\ell)$ and $7=(i+1,j+1,\\ell+1)$. The tetrahedron vertex sets are $[0,1,3,7]$, $[0,1,5,7]$, $[0,2,3,7]$, $[0,2,6,7]$, $[0,4,5,7]$, and $[0,4,6,7]$.\n\nWithin each tetrahedron, the function $E(\\mathbf{k})^2$ is approximated by a linear interpolant of its values at the four vertices. The integral of a linear function over a tetrahedron is its volume multiplied by the average of the function's values at its vertices. The volume of each tetrahedron is $V_T = h^3/6$. Thus, the integral of $E(\\mathbf{k})^2$ over one tetrahedron is:\n$$ I_T = \\frac{V_T}{4} \\sum_{p=1}^{4} E(\\mathbf{k}_p)^2 = \\frac{h^3}{24} \\sum_{p=1}^{4} E(\\mathbf{k}_p)^2 $$\nThe integral over a small cube is the sum of integrals over the $6$ constituent tetrahedra. By summing the contributions from each vertex, we can determine the weight of each of the cube's $8$ vertices in the total integral for that cube. Let $F_p$ be the value of $E(\\mathbf{k})^2$ at local vertex $p$:\n- Vertex $0$ is part of all $6$ tetrahedra.\n- Vertex $7$ is part of all $6$ tetrahedra.\n- Vertices $1, 2, 3, 4, 5, 6$ are each part of $2$ tetrahedra.\n\nThe sum of function values over all $6$ tetrahedra in a cube is:\n$$ \\sum_{\\text{tetras}} \\sum_{\\text{vertices}} F_p = 6F_0 + 2F_1 + 2F_2 + 2F_3 + 2F_4 + 2F_5 + 2F_6 + 6F_7 $$\nThus, the integral over a single cube, indexed by its origin vertex $(i,j,\\ell)$, is:\n$$ I_{\\text{cube}}(i,j,\\ell) = \\frac{h^3}{24} \\sum_{p=0}^{7} C_p F_p(i,j,\\ell) $$\nwhere $C_p$ are the integer coefficients $\\{6, 2, 2, 2, 2, 2, 2, 6\\}$. The total integral $I_{\\mathrm{tet}}$ is the sum of $I_{\\text{cube}}$ over all $m^3$ cubes. This can be implemented efficiently by pre-computing all $(m+1)^3$ vertex values into an array and performing vectorized sums over slices of this array corresponding to each of the $8$ vertex types across all cubes.\n\n**3. Error Calculation**\nFor each test case $(m, s)$, we compute the numerical integrals $I_{\\mathrm{tet}}(m)$ and $I_{\\mathrm{MP}}(m,s)$. The absolute errors are then calculated as:\n$$ e_{\\mathrm{tet}} = |I_{\\mathrm{tet}} - I_{\\mathrm{exact}}| $$\n$$ e_{\\mathrm{MP}} = |I_{\\mathrm{MP}} - I_{\\mathrm{exact}}| $$\nThese pairs of errors form the output for each case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares the accuracy of the tetrahedron method and Monkhorst-Pack\n    sampling for integrating a tight-binding dispersion over the Brillouin zone.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1, 0.0),\n        (1, 0.5),\n        (4, 0.5),\n        (8, 0.5),\n        (12, 0.5),\n    ]\n\n    # The exact analytical value of the integral I = integral(E(k)^2 d^3k)\n    # derived as 48 * pi^3.\n    I_exact = 48.0 * np.pi**3\n\n    def energy_sq(kx, ky, kz):\n        \"\"\"\n        Calculates E(k)^2 = 4 * (cos(kx) + cos(ky) + cos(kz))^2.\n        kx, ky, kz are 3D-grid-compatible arrays.\n        \"\"\"\n        return 4.0 * (np.cos(kx) + np.cos(ky) + np.cos(kz))**2\n\n    def compute_I_mp(m, s):\n        \"\"\"\n        Computes the integral using Monkhorst-Pack sampling.\n        \"\"\"\n        if m == 0:\n            return 0.0\n        h = 2.0 * np.pi / m\n        \n        # Create grid coordinates for sampling points using broadcasting\n        # to form an implicit m x m x m grid.\n        i = np.arange(m).reshape(m, 1, 1)\n        j = np.arange(m).reshape(1, m, 1)\n        l = np.arange(m).reshape(1, 1, m)\n\n        kx = -np.pi + (i + s) * h\n        ky = -np.pi + (j + s) * h\n        kz = -np.pi + (l + s) * h\n        \n        # Evaluate function on the 3D grid of k-points.\n        E_sq_values = energy_sq(kx, ky, kz)\n        \n        # Approximate integral with a Riemann sum.\n        I_mp = np.sum(E_sq_values) * h**3\n        return I_mp\n\n    def compute_I_tet(m):\n        \"\"\"\n        Computes the integral using the linear tetrahedron method.\n        \"\"\"\n        if m == 0:\n            return 0.0\n        h = 2.0 * np.pi / m\n        \n        # Create a grid of (m+1) vertices along one axis.\n        k_coords = -np.pi + np.arange(m + 1) * h\n        \n        # Create 3D vertex grid coordinates using broadcasting.\n        kx = k_coords.reshape(m + 1, 1, 1)\n        ky = k_coords.reshape(1, m + 1, 1)\n        kz = k_coords.reshape(1, 1, m + 1)\n        \n        # Evaluate function E^2 at all (m+1)^3 vertices.\n        F_values = energy_sq(kx, ky, kz)\n        \n        # S_p corresponds to the sum of F_values over all m^3 cubes\n        # for a vertex with local index p (0 to 7).\n        S0 = np.sum(F_values[:m, :m, :m])\n        S1 = np.sum(F_values[1:m+1, :m, :m])\n        S2 = np.sum(F_values[:m, 1:m+1, :m])\n        S3 = np.sum(F_values[1:m+1, 1:m+1, :m])\n        S4 = np.sum(F_values[:m, :m, 1:m+1])\n        S5 = np.sum(F_values[1:m+1, :m, 1:m+1])\n        S6 = np.sum(F_values[:m, 1:m+1, 1:m+1])\n        S7 = np.sum(F_values[1:m+1, 1:m+1, 1:m+1])\n        \n        # The integral over one cube is (h^3/24) * sum_of_values.\n        # The sum of values over one cube is (6*F0 + 2*F1 + ... + 6*F7).\n        # We sum over all cubes by summing the S_p arrays.\n        total_sum_of_values = 6*S0 + 2*S1 + 2*S2 + 2*S3 + 2*S4 + 2*S5 + 2*S6 + 6*S7\n\n        I_tet = (h**3 / 24.0) * total_sum_of_values\n        return I_tet\n\n    results = []\n    for m, s in test_cases:\n        I_tet = compute_I_tet(m)\n        I_mp = compute_I_mp(m, s)\n        \n        e_tet = abs(I_tet - I_exact)\n        e_mp = abs(I_mp - I_exact)\n        \n        results.append([e_tet, e_mp])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3013667"}]}