{"hands_on_practices": [{"introduction": "The Clausius-Mossotti relation connects the macroscopic relative permittivity, $\\varepsilon_r$, to the microscopic molecular polarizability, $\\alpha$. Before diving into its derivation, it is crucial to ensure the mathematical consistency of the expressions involved. This first exercise provides a foundational check by guiding you through a dimensional analysis of the key dimensionless group $N\\alpha/(3\\varepsilon_0)$, reinforcing your understanding of the fundamental quantities at play.", "problem": "In a homogeneous isotropic dielectric, the microscopic electric dipole moment $\\mathbf{p}$ of a molecule responds linearly to the electric field $\\mathbf{E}$ according to $\\mathbf{p}=\\alpha\\,\\mathbf{E}$, where $\\alpha$ is the molecular polarizability. The number density of molecules is $N$ and the vacuum permittivity is $\\varepsilon_0$. The combination $N\\alpha/(3\\varepsilon_0)$ arises naturally in discussions of local fields and the relation between polarization and macroscopic response. Starting from fundamental definitions and the International System of Units (SI), perform a dimensional analysis to verify that $N\\alpha/(3\\varepsilon_0)$ is dimensionless. Use $[\\alpha]=\\mathrm{C}\\,\\mathrm{m}^{2}/\\mathrm{V}$ and $[N]=\\mathrm{m}^{-3}$, and derive $[\\varepsilon_0]$ from Coulomb’s law $F=\\frac{1}{4\\pi\\varepsilon_0}\\frac{q_1 q_2}{r^2}$ as well as from the definitions of the volt $\\mathrm{V}$ and the coulomb $\\mathrm{C}$. Express all derived units in terms of the SI base units $\\mathrm{kg}$, $\\mathrm{m}$, $\\mathrm{s}$, and $\\mathrm{A}$, where the newton $\\mathrm{N}$ and the joule $\\mathrm{J}$ satisfy $[\\mathrm{N}]=\\mathrm{kg}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$ and $[\\mathrm{J}]=\\mathrm{kg}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$. Conclude by providing the pure number that represents the overall base-unit factor for $N\\alpha/(3\\varepsilon_0)$. No rounding is required and no units should be included in the final answer.", "solution": "The problem requires a dimensional analysis of the quantity $\\frac{N\\alpha}{3\\varepsilon_0}$ to verify that it is dimensionless. The analysis must be performed starting from fundamental definitions in the International System of Units (SI), expressing all derived units in terms of the SI base units: kilogram ($\\mathrm{kg}$), meter ($\\mathrm{m}$), second ($\\mathrm{s}$), and ampere ($\\mathrm{A}$). Finally, we are asked to provide the pure number representing the overall base-unit factor for this expression.\n\nLet the quantity be denoted by $X = \\frac{N\\alpha}{3\\varepsilon_0}$. The numerical factor $3$ in the denominator is a dimensionless constant. Therefore, to verify that $X$ is dimensionless, we must show that the combination of physical quantities $\\frac{N\\alpha}{\\varepsilon_0}$ is dimensionless. We denote the dimension of a physical quantity $Q$ by $[Q]$. Our task is to show that $[\\frac{N\\alpha}{\\varepsilon_0}] = 1$.\n\nWe will proceed by determining the dimensions of each quantity ($N$, $\\alpha$, and $\\varepsilon_0$) in terms of the base units $\\mathrm{M}$ (mass), $\\mathrm{L}$ (length), $\\mathrm{T}$ (time), and $\\mathrm{I}$ (current), which correspond to $\\mathrm{kg}$, $\\mathrm{m}$, $\\mathrm{s}$, and $\\mathrm{A}$, respectively.\n\n1.  **Dimensions of the vacuum permittivity, $\\varepsilon_0$**:\n    We start from Coulomb's law, which gives the force $F$ between two point charges $q_1$ and $q_2$ separated by a distance $r$:\n    $$F = \\frac{1}{4\\pi\\varepsilon_0} \\frac{q_1 q_2}{r^2}$$\n    The factor $4\\pi$ is dimensionless. We can solve for the dimensions of $\\varepsilon_0$:\n    $$[\\varepsilon_0] = \\frac{[q_1][q_2]}{[F][r^2]} = \\frac{[q]^2}{[F][L]^2}$$\n    The dimension of charge, $[q]$, is derived from the definition of current $I = \\frac{dq}{dt}$, so $[q] = [I][t] = \\mathrm{I}\\,\\mathrm{T}$. In SI units, this is $\\mathrm{A}\\,\\mathrm{s}$.\n    The dimension of force, $[F]$, is given by Newton's second law, $[F] = [\\text{mass} \\times \\text{acceleration}] = \\mathrm{M}\\,\\mathrm{L}\\,\\mathrm{T}^{-2}$. In SI units, this is $\\mathrm{kg}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$ (the Newton, $\\mathrm{N}$).\n    Substituting these into the expression for $[\\varepsilon_0]$:\n    $$[\\varepsilon_0] = \\frac{(\\mathrm{I}\\,\\mathrm{T})^2}{(\\mathrm{M}\\,\\mathrm{L}\\,\\mathrm{T}^{-2})(\\mathrm{L}^2)} = \\frac{\\mathrm{I}^2\\,\\mathrm{T}^2}{\\mathrm{M}\\,\\mathrm{L}^3\\,\\mathrm{T}^{-2}} = \\mathrm{M}^{-1}\\,\\mathrm{L}^{-3}\\,\\mathrm{T}^4\\,\\mathrm{I}^2$$\n    In terms of SI units: $[\\varepsilon_0] = \\mathrm{kg}^{-1}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^4\\,\\mathrm{A}^2$.\n\n2.  **Dimensions of the molecular polarizability, $\\alpha$**:\n    The problem provides the unit of polarizability as $[\\alpha] = \\mathrm{C}\\,\\mathrm{m}^{2}/\\mathrm{V}$. We must express the Coulomb ($\\mathrm{C}$) and Volt ($\\mathrm{V}$) in base units.\n    As established, the unit of charge is $[\\mathrm{C}] = \\mathrm{A}\\,\\mathrm{s}$.\n    The Volt is the unit of electric potential, defined as energy per unit charge: $[\\mathrm{V}] = \\frac{[\\text{Energy}]}{[\\text{Charge}]} = \\frac{[\\mathrm{J}]}{[\\mathrm{C}]}$.\n    The unit of energy, the Joule ($\\mathrm{J}$), has dimensions of force times distance: $[\\mathrm{J}] = [F][L] = (\\mathrm{M}\\,\\mathrm{L}\\,\\mathrm{T}^{-2})(\\mathrm{L}) = \\mathrm{M}\\,\\mathrm{L}^2\\,\\mathrm{T}^{-2}$. In SI units, $[\\mathrm{J}] = \\mathrm{kg}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n    Now we can find the dimensions of the Volt:\n    $$[\\mathrm{V}] = \\frac{\\mathrm{M}\\,\\mathrm{L}^2\\,\\mathrm{T}^{-2}}{\\mathrm{I}\\,\\mathrm{T}} = \\mathrm{M}\\,\\mathrm{L}^2\\,\\mathrm{T}^{-3}\\,\\mathrm{I}^{-1}$$\n    In SI units, $[\\mathrm{V}] = \\mathrm{kg}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-3}\\,\\mathrm{A}^{-1}$.\n    Finally, we find the dimensions of $\\alpha$:\n    $$[\\alpha] = \\frac{[\\mathrm{C}][\\mathrm{m}]^2}{[\\mathrm{V}]} = \\frac{(\\mathrm{I}\\,\\mathrm{T})(\\mathrm{L}^2)}{\\mathrm{M}\\,\\mathrm{L}^2\\,\\mathrm{T}^{-3}\\,\\mathrm{I}^{-1}} = \\frac{\\mathrm{I}\\,\\mathrm{T}\\,\\mathrm{L}^2}{\\mathrm{M}\\,\\mathrm{L}^2\\,\\mathrm{T}^{-3}\\,\\mathrm{I}^{-1}} = \\mathrm{M}^{-1}\\,\\mathrm{T}^4\\,\\mathrm{I}^2$$\n    In terms of SI units: $[\\alpha] = \\mathrm{kg}^{-1}\\,\\mathrm{s}^4\\,\\mathrm{A}^2$.\n\n3.  **Dimensions of the number density, $N$**:\n    The number density $N$ is the number of molecules per unit volume. The number of molecules is a dimensionless count.\n    $$[N] = \\frac{1}{[\\text{Volume}]} = \\frac{1}{\\mathrm{L}^3} = \\mathrm{L}^{-3}$$\n    In SI units, $[N] = \\mathrm{m}^{-3}$.\n\n4.  **Dimensional analysis of the complete expression**:\n    Now we combine the dimensions of $N$, $\\alpha$, and $\\varepsilon_0$:\n    $$\\left[\\frac{N\\alpha}{\\varepsilon_0}\\right] = \\frac{[N][\\alpha]}{[\\varepsilon_0]} = \\frac{(\\mathrm{L}^{-3})(\\mathrm{M}^{-1}\\,\\mathrm{T}^4\\,\\mathrm{I}^2)}{\\mathrm{M}^{-1}\\,\\mathrm{L}^{-3}\\,\\mathrm{T}^4\\,\\mathrm{I}^2}$$\n    We can cancel the terms:\n    $$\\frac{\\mathrm{L}^{-3}}{\\mathrm{L}^{-3}} \\cdot \\frac{\\mathrm{M}^{-1}}{\\mathrm{M}^{-1}} \\cdot \\frac{\\mathrm{T}^4}{\\mathrm{T}^4} \\cdot \\frac{\\mathrm{I}^2}{\\mathrm{I}^2} = 1 \\cdot 1 \\cdot 1 \\cdot 1 = 1$$\n    The result is a pure number, $1$, which signifies that the quantity is dimensionless. Since $\\frac{N\\alpha}{\\varepsilon_0}$ is dimensionless, and $3$ is a dimensionless number, the entire expression $\\frac{N\\alpha}{3\\varepsilon_0}$ is verified to be dimensionless.\n\n5.  **Pure number for the overall base-unit factor**:\n    The problem asks for the \"pure number that represents the overall base-unit factor for $N\\alpha/(3\\varepsilon_0)$\". This factor is the numerical coefficient that arises from expressing the combination of units in terms of base units. The SI system is a coherent system of units, which means that the conversion factors between derived units (such as $\\mathrm{N}$, $\\mathrm{J}$, $\\mathrm{V}$, $\\mathrm{C}$) and the base units ($\\mathrm{kg}$, $\\mathrm{m}$, $\\mathrm{s}$, $\\mathrm{A}$) are all exactly $1$. For example, $1\\,\\mathrm{N} = 1\\,\\mathrm{kg}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$.\n    Our dimensional analysis showed that the combination of units for $\\frac{N\\alpha}{\\varepsilon_0}$ simplifies to:\n    $$\\frac{(\\mathrm{m}^{-3})(\\mathrm{kg}^{-1}\\,\\mathrm{s}^4\\,\\mathrm{A}^2)}{\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^4\\,\\mathrm{A}^2} = 1$$\n    The numerical factor resulting from this cancellation of units is $1$. The factor of $3$ in the denominator is an explicit, dimensionless numerical constant present in the physical formula itself; it does not arise from unit conversion. The \"base-unit factor\" refers to the numerical result of the unit analysis. Therefore, the base-unit factor for the physical part of the expression, $\\frac{N\\alpha}{\\varepsilon_0}$, is $1$. Including the dimensionless constant $3$ does not change the factor that arises from the base-unit conversion. The overall base-unit factor is $1$.", "answer": "$$\\boxed{1}$$", "id": "3001541"}, {"introduction": "To describe the optical properties of materials, we must extend our static model to account for time-varying fields. This comprehensive practice guides you through the derivation of the frequency-dependent dielectric permittivity, $\\varepsilon_r(\\omega)$, by combining the classical Lorentz model of a bound electron as a damped harmonic oscillator with the Lorentz local field correction. Completing this derivation provides a deep insight into the microscopic origins of optical dispersion and absorption.", "problem": "Consider a three-dimensional isotropic and centrosymmetric dielectric crystal with cubic symmetry, composed of identical bound electrons of charge $e$ and mass $m$ attached to their equilibrium positions by harmonic restoring forces with natural angular frequency $\\omega_{0}$ and subject to linear damping characterized by a phenomenological rate $\\gamma$. The crystal has number density $N$ of such oscillators per unit volume. The sample is driven by a spatially uniform, time-harmonic electric field $E(t)=\\Re\\{E\\,\\exp(-i\\omega t)\\}$ of angular frequency $\\omega$.\n\nStarting from Newton’s second law for a driven, damped harmonic oscillator and the definition of the electric dipole moment $p=e x$ for a displacement $x$, do the following:\n\n1. Solve the microscopic equation of motion in the frequency domain to obtain the complex, frequency-dependent microscopic polarizability $\\alpha(\\omega)$ defined by $p(\\omega)=\\alpha(\\omega)\\,E_{\\mathrm{loc}}(\\omega)$, where $E_{\\mathrm{loc}}$ is the local electric field acting on an oscillator.\n2. Discuss the physical meanings of $\\Re\\{\\alpha(\\omega)\\}$ and $\\Im\\{\\alpha(\\omega)\\}$ in terms of dispersive response and absorption for $\\omega$ near $\\omega_{0}$, based solely on causality and power dissipation arguments.\n3. Using the Lorentz local-field construction for an isotropic cubic medium, $E_{\\mathrm{loc}}(\\omega)=E(\\omega)+P(\\omega)/(3\\varepsilon_{0})$, and the polarization density $P(\\omega)=N\\,p(\\omega)$, obtain a self-consistent relation between the macroscopic polarization $P(\\omega)$ and the macroscopic field $E(\\omega)$. From this, eliminate $P(\\omega)$ in favor of the relative permittivity $\\varepsilon_{r}(\\omega)$ defined by $D(\\omega)=\\varepsilon_{0}\\varepsilon_{r}(\\omega)\\,E(\\omega)$, and express $\\varepsilon_{r}(\\omega)$ entirely in terms of $\\omega$, $\\omega_{0}$, $\\gamma$, $e$, $m$, $N$, and $\\varepsilon_{0}$ within the International System of Units (SI).\n\nProvide your final result as a single, closed-form analytic expression for $\\varepsilon_{r}(\\omega)$ in terms of these parameters. Do not evaluate numerically and do not round. The final answer you report must be only this expression.", "solution": "The problem asks for the derivation of the frequency-dependent relative permittivity $\\varepsilon_r(\\omega)$ of an isotropic dielectric crystal, starting from the microscopic Lorentz model for bound electrons and incorporating the Lorentz local field correction. The derivation proceeds in three steps as outlined in the problem statement.\n\n### Part 1: Microscopic Polarizability $\\alpha(\\omega)$\n\nWe begin with the equation of motion for a single bound electron of mass $m$ and charge $e$. The electron is treated as a damped harmonic oscillator driven by the local electric field, $E_{\\mathrm{loc}}(t)$. The restoring force is characterized by a natural angular frequency $\\omega_{0}$, and the damping force is characterized by a rate $\\gamma$. Newton's second law for the displacement $x(t)$ of the electron from its equilibrium position is:\n$$m \\frac{d^2x}{dt^2} + m\\gamma \\frac{dx}{dt} + m\\omega_0^2 x = e E_{\\mathrm{loc}}(t)$$\nThe driving field and the response are time-harmonic. We use complex phasors, such that $E_{\\mathrm{loc}}(t) = \\Re\\{E_{\\mathrm{loc}}(\\omega) e^{-i\\omega t}\\}$ and $x(t) = \\Re\\{x(\\omega) e^{-i\\omega t}\\}$. Substituting these into the differential equation, the time derivatives become multiplications by $-i\\omega$:\n$$m(-i\\omega)^2 x(\\omega) e^{-i\\omega t} + m\\gamma(-i\\omega) x(\\omega) e^{-i\\omega t} + m\\omega_0^2 x(\\omega) e^{-i\\omega t} = e E_{\\mathrm{loc}}(\\omega) e^{-i\\omega t}$$\nDividing by $e^{-i\\omega t}$ and factoring out $x(\\omega)$, we get:\n$$x(\\omega) \\left( -m\\omega^2 - im\\gamma\\omega + m\\omega_0^2 \\right) = e E_{\\mathrm{loc}}(\\omega)$$\nSolving for the complex amplitude of the displacement, $x(\\omega)$:\n$$x(\\omega) = \\frac{e E_{\\mathrm{loc}}(\\omega)}{m(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)}$$\nThe induced electric dipole moment is defined as $p(t) = e x(t)$, so its complex amplitude is $p(\\omega) = e x(\\omega)$.\n$$p(\\omega) = \\frac{e^2 E_{\\mathrm{loc}}(\\omega)}{m(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)}$$\nThe microscopic polarizability, $\\alpha(\\omega)$, is defined by the linear relation $p(\\omega) = \\alpha(\\omega) E_{\\mathrm{loc}}(\\omega)$. By comparing this definition with the derived expression for $p(\\omega)$, we identify $\\alpha(\\omega)$ as:\n$$\\alpha(\\omega) = \\frac{e^2}{m(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)}$$\n\n### Part 2: Physical Meaning of Real and Imaginary Parts of $\\alpha(\\omega)$\n\nThe complex polarizability $\\alpha(\\omega)$ relates the induced dipole moment to the driving local field. We can write it in terms of its real and imaginary parts, $\\alpha(\\omega) = \\alpha'(\\omega) + i\\alpha''(\\omega)$.\n\nThe real part, $\\alpha'(\\omega) = \\Re\\{\\alpha(\\omega)\\}$, governs the component of the dipole moment that oscillates in phase with the driving field. This in-phase response is responsible for the elastic scattering of light and determines the refractive index of the medium away from resonance. It describes how the medium alters the phase velocity of the electromagnetic wave, which is the essence of dispersion.\n\nThe imaginary part, $\\alpha''(\\omega) = \\Im\\{\\alpha(\\omega)\\}$, governs the component of the dipole moment that oscillates in quadrature ($\\pi/2$ out of phase) with the driving field. This out-of-phase component is responsible for the absorption of energy from the field by the medium. To demonstrate this based on causality and power dissipation, we calculate the time-averaged power absorbed by a single oscillator, $\\langle P_{abs} \\rangle = \\langle \\mathbf{F} \\cdot \\mathbf{v} \\rangle$, where the driving force is $\\mathbf{F}(t) = e \\mathbf{E}_{\\mathrm{loc}}(t)$ and the velocity is $\\mathbf{v}(t) = \\frac{d\\mathbf{x}}{dt}$. For time-harmonic quantities, the time-average is given by $\\langle A(t)B(t) \\rangle = \\frac{1}{2}\\Re\\{A(\\omega)B(\\omega)^*\\}$, where $A(\\omega)$ and $B(\\omega)^*$ are the complex amplitudes.\nHere, $F(\\omega) = e E_{\\mathrm{loc}}(\\omega)$ and $v(\\omega) = -i\\omega x(\\omega) = -\\frac{i\\omega}{e}p(\\omega) = -\\frac{i\\omega}{e}\\alpha(\\omega)E_{\\mathrm{loc}}(\\omega)$.\nThe time-averaged power absorbed is:\n$$\\langle P_{abs} \\rangle = \\frac{1}{2} \\Re\\{ F(\\omega) v(\\omega)^* \\} = \\frac{1}{2} \\Re\\left\\{ e E_{\\mathrm{loc}}(\\omega) \\left( -\\frac{i\\omega}{e}\\alpha(\\omega)E_{\\mathrm{loc}}(\\omega) \\right)^* \\right\\}$$\n$$\\langle P_{abs} \\rangle = \\frac{1}{2} \\Re\\left\\{ e E_{\\mathrm{loc}}(\\omega) \\left( \\frac{i\\omega}{e}\\alpha^*(\\omega)E_{\\mathrm{loc}}^*(\\omega) \\right) \\right\\} = \\frac{1}{2} \\Re\\left\\{ i\\omega \\alpha^*(\\omega) |E_{\\mathrm{loc}}(\\omega)|^2 \\right\\}$$\nSubstituting $\\alpha^*(\\omega) = \\alpha'(\\omega) - i\\alpha''(\\omega)$:\n$$\\langle P_{abs} \\rangle = \\frac{1}{2} \\Re\\left\\{ i\\omega (\\alpha'(\\omega) - i\\alpha''(\\omega)) |E_{\\mathrm{loc}}(\\omega)|^2 \\right\\} = \\frac{1}{2} \\Re\\left\\{ (i\\omega\\alpha'(\\omega) + \\omega\\alpha''(\\omega)) |E_{\\mathrm{loc}}(\\omega)|^2 \\right\\}$$\n$$\\langle P_{abs} \\rangle = \\frac{1}{2} \\omega \\alpha''(\\omega) |E_{\\mathrm{loc}}(\\omega)|^2$$\nFrom the expression for $\\alpha(\\omega)$, we can find $\\alpha''(\\omega)$:\n$$\\alpha''(\\omega) = \\Im\\left\\{ \\frac{e^2/m}{(\\omega_0^2 - \\omega^2) - i\\gamma\\omega} \\cdot \\frac{(\\omega_0^2 - \\omega^2) + i\\gamma\\omega}{(\\omega_0^2 - \\omega^2) + i\\gamma\\omega} \\right\\} = \\frac{e^2/m}{(\\omega_0^2 - \\omega^2)^2 + (\\gamma\\omega)^2} (\\gamma\\omega)$$\nSince $\\gamma$ and $\\omega$ are positive, $\\alpha''(\\omega) > 0$. Causality requires that the system can only absorb energy from the driving field on average, so $\\langle P_{abs} \\rangle \\ge 0$. Our result is consistent with this principle and shows that the imaginary part of the polarizability, $\\Im\\{\\alpha(\\omega)\\}$, is directly proportional to the rate of energy absorption. This absorption is maximal near the resonance frequency $\\omega \\approx \\omega_0$.\n\n### Part 3: Macroscopic Relative Permittivity $\\varepsilon_r(\\omega)$\n\nThe macroscopic polarization density $P(\\omega)$ is the total dipole moment per unit volume, given by $P(\\omega) = N p(\\omega)$, where $N$ is the number density of oscillators.\n$$P(\\omega) = N \\alpha(\\omega) E_{\\mathrm{loc}}(\\omega)$$\nFor an isotropic cubic medium, the Lorentz local field $E_{\\mathrm{loc}}(\\omega)$ is related to the macroscopic field $E(\\omega)$ and the polarization $P(\\omega)$ by:\n$$E_{\\mathrm{loc}}(\\omega) = E(\\omega) + \\frac{P(\\omega)}{3\\varepsilon_0}$$\nSubstituting this expression for $E_{\\mathrm{loc}}(\\omega)$ into the equation for $P(\\omega)$:\n$$P(\\omega) = N \\alpha(\\omega) \\left( E(\\omega) + \\frac{P(\\omega)}{3\\varepsilon_0} \\right)$$\nWe can now solve for $P(\\omega)$ in terms of the macroscopic field $E(\\omega)$:\n$$P(\\omega) - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0} P(\\omega) = N\\alpha(\\omega) E(\\omega)$$\n$$P(\\omega) \\left( 1 - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0} \\right) = N\\alpha(\\omega) E(\\omega)$$\n$$P(\\omega) = \\frac{N\\alpha(\\omega)}{1 - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0}} E(\\omega)$$\nThe relative permittivity $\\varepsilon_r(\\omega)$ is defined via the electric displacement field $D(\\omega) = \\varepsilon_0 \\varepsilon_r(\\omega) E(\\omega)$. The displacement field is also related to the polarization by $D(\\omega) = \\varepsilon_0 E(\\omega) + P(\\omega)$. Equating these two expressions gives:\n$$P(\\omega) = \\varepsilon_0 (\\varepsilon_r(\\omega) - 1) E(\\omega)$$\nNow, we equate the two expressions for $P(\\omega)$:\n$$\\varepsilon_0 (\\varepsilon_r(\\omega) - 1) E(\\omega) = \\frac{N\\alpha(\\omega)}{1 - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0}} E(\\omega)$$\nDividing by $\\varepsilon_0 E(\\omega)$ (assuming $E(\\omega) \\neq 0$):\n$$\\varepsilon_r(\\omega) - 1 = \\frac{N\\alpha(\\omega)/\\varepsilon_0}{1 - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0}}$$\nSolving for $\\varepsilon_r(\\omega)$:\n$$\\varepsilon_r(\\omega) = 1 + \\frac{N\\alpha(\\omega)/\\varepsilon_0}{1 - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0}} = \\frac{1 - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0} + \\frac{N\\alpha(\\omega)}{\\varepsilon_0}}{1 - \\frac{N\\alpha(\\omega)}{3\\varepsilon_0}} = \\frac{1 + \\frac{2}{3}\\frac{N\\alpha(\\omega)}{\\varepsilon_0}}{1 - \\frac{1}{3}\\frac{N\\alpha(\\omega)}{\\varepsilon_0}}$$\nThis is the Clausius-Mossotti relation generalized for a frequency-dependent polarizability. Finally, we substitute the expression for $\\alpha(\\omega)$ from Part 1 into this equation. Let's analyze the term $\\frac{N\\alpha(\\omega)}{3\\varepsilon_0}$:\n$$\\frac{N\\alpha(\\omega)}{3\\varepsilon_0} = \\frac{N}{3\\varepsilon_0} \\left( \\frac{e^2}{m(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)} \\right) = \\frac{Ne^2}{3m\\varepsilon_0(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)}$$\nSubstituting this into the expression for $\\varepsilon_r(\\omega)$:\n$$\\varepsilon_r(\\omega) = \\frac{1 + 2 \\left( \\frac{Ne^2}{3m\\varepsilon_0(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)} \\right)}{1 - \\left( \\frac{Ne^2}{3m\\varepsilon_0(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)} \\right)}$$\nMultiplying the numerator and denominator by $3m\\varepsilon_0(\\omega_0^2 - \\omega^2 - i\\gamma\\omega)$:\n$$\\varepsilon_r(\\omega) = \\frac{3m\\varepsilon_0(\\omega_0^2 - \\omega^2 - i\\gamma\\omega) + 2Ne^2}{3m\\varepsilon_0(\\omega_0^2 - \\omega^2 - i\\gamma\\omega) - Ne^2}$$\nDividing numerator and denominator by $3m\\varepsilon_0$:\n$$\\varepsilon_r(\\omega) = \\frac{(\\omega_0^2 - \\omega^2 - i\\gamma\\omega) + \\frac{2Ne^2}{3m\\varepsilon_0}}{(\\omega_0^2 - \\omega^2 - i\\gamma\\omega) - \\frac{Ne^2}{3m\\varepsilon_0}}$$\nThis is the final closed-form expression for the relative permittivity $\\varepsilon_r(\\omega)$ in terms of the given parameters.", "answer": "$$\\boxed{\\frac{\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega + \\frac{2Ne^{2}}{3m\\varepsilon_{0}}}{\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega - \\frac{Ne^{2}}{3m\\varepsilon_{0}}}}$$", "id": "3001483"}, {"introduction": "A cornerstone of the Lorentz local field theory is the assertion that for a site with cubic symmetry, the net electric field from discrete dipoles inside the conceptual Lorentz sphere is zero. This advanced computational practice challenges you to verify this assumption directly, rather than taking it on faith. By implementing a direct lattice sum of dipole fields in a simple cubic crystal, you will gain a tangible appreciation for the power of symmetry arguments and the validity of the continuum approximation used in the local field correction.", "problem": "Consider an infinite three-dimensional simple cubic lattice of identical point dipoles with lattice constant $a$ and one dipole per primitive cell. Each dipole has moment $\\mathbf{p} = p\\,\\hat{\\mathbf{z}}$ aligned with the global $z$-axis. The macroscopic polarization is $\\mathbf{P} = P\\,\\hat{\\mathbf{z}}$, and the dipole moment per lattice site satisfies $p = P a^3$ so that $\\mathbf{P}$ equals dipole moment per cell volume. The electric field $\\mathbf{E}(\\mathbf{r})$ produced at a point by a single point dipole $\\mathbf{p}$ placed at $\\mathbf{R}$ in vacuum is given by the well-tested formula\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0}\\,\\frac{1}{|\\mathbf{r}-\\mathbf{R}|^3}\\left[3\\big(\\mathbf{p}\\cdot \\hat{\\mathbf{u}}\\big)\\hat{\\mathbf{u}} - \\mathbf{p}\\right],\n$$\nwhere $\\hat{\\mathbf{u}} = \\frac{\\mathbf{r}-\\mathbf{R}}{|\\mathbf{r}-\\mathbf{R}|}$ and $\\varepsilon_0$ is the vacuum permittivity.\n\nDefine the Lorentz sphere of radius $R$ centered at the origin coinciding with a lattice site. The discrete near-field correction arising from lattice discreteness is modeled by the sum of the $z$-component of the dipolar electric field at the origin produced by all dipoles whose lattice sites $\\mathbf{R} = a(i\\,\\hat{\\mathbf{x}}+j\\,\\hat{\\mathbf{y}}+k\\,\\hat{\\mathbf{z}})$ lie strictly inside the sphere, excluding the dipole at the origin:\n$$\nE_{\\mathrm{near}}(R) = \\sum_{\\substack{(i,j,k)\\in\\mathbb{Z}^3\\\\ (i,j,k)\\neq(0,0,0)\\\\ a\\sqrt{i^2+j^2+k^2}\\le R}}\\left[\\frac{1}{4\\pi \\varepsilon_0}\\,\\frac{1}{|\\mathbf{R}|^3}\\left(3\\big(\\mathbf{p}\\cdot \\hat{\\mathbf{R}}\\big)\\hat{R}_z - p\\right)\\right],\n$$\nwith $\\hat{\\mathbf{R}}=\\mathbf{R}/|\\mathbf{R}|$ and $\\hat{R}_z$ its $z$-component. The local field is commonly decomposed as a macroscopic contribution plus the Lorentz term plus a near-field correction; to quantify the correction relative to the Lorentz contribution, define the dimensionless ratio\n$$\n\\delta(R) = \\frac{E_{\\mathrm{near}}(R)}{P/(3\\varepsilon_0)}.\n$$\n\nStarting from the given fundamental dipole field formula, implement a direct lattice sum inside the Lorentz sphere to compute $E_{\\mathrm{near}}(R)$ and $\\delta(R)$ for the parameter sets below. Your program must perform the integer lattice enumeration exactly as stated, exclude the origin, and include a lattice site if and only if $a\\sqrt{i^2+j^2+k^2}\\le R$. Use $\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$, and express $E_{\\mathrm{near}}(R)$ in volts per meter (V/m). Angles, if any appear in your implementation, must be in radians. Return floats rounded to ten decimal places.\n\nTest suite (each case specifies $(a,P,R)$, with $R$ provided as a multiple of $a$ and the program must convert to meters):\n- Case 1 (near-neighbor shell only): $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=1.01\\,a$.\n- Case 2 (includes face-diagonal neighbors): $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=1.42\\,a$.\n- Case 3 (multiple shells): $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=3.01\\,a$.\n- Case 4 (scaling check in polarization): $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.2\\ \\mathrm{C/m^2}$, $R=3.01\\,a$.\n- Case 5 (scaling check in lattice constant): $a=3.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=3.01\\,a$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a two-element list $[E_{\\mathrm{near}}(R),\\delta(R)]$ with both elements as floats rounded to ten decimal places. For example, the output format must be like:\n$$\n\\texttt{[[E1,delta1],[E2,delta2],[E3,delta3],[E4,delta4],[E5,delta5]]}.\n$$", "solution": "The user wants me to solve a numerical problem in condensed matter physics.\n\n### **Part 1: Problem Validation**\n\nI will first validate the problem statement.\n\n**Step 1: Extract Givens**\n-   **Lattice**: Infinite 3D simple cubic, lattice constant $a$, one dipole per primitive cell.\n-   **Dipole moment**: $\\mathbf{p} = p\\,\\hat{\\mathbf{z}}$, identical for all dipoles.\n-   **Polarization**: Macroscopic polarization $\\mathbf{P} = P\\,\\hat{\\mathbf{z}}$.\n-   **Constitutive Relation**: $p = P a^3$.\n-   **Single Dipole Field**: $\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\epsilon_0}\\,\\frac{1}{|\\mathbf{r}-\\mathbf{R}|^3}\\left[3\\big(\\mathbf{p}\\cdot \\hat{\\mathbf{u}}\\big)\\hat{\\mathbf{u}} - \\mathbf{p}\\right]$, where $\\hat{\\mathbf{u}} = \\frac{\\mathbf{r}-\\mathbf{R}}{|\\mathbf{r}-\\mathbf{R}|}$.\n-   **Lattice Sites**: $\\mathbf{R} = a(i\\,\\hat{\\mathbf{x}}+j\\,\\hat{\\mathbf{y}}+k\\,\\hat{\\mathbf{z}})$ for $(i,j,k)\\in\\mathbb{Z}^3$.\n-   **Near-Field Correction $E_{\\mathrm{near}}(R)$**: The $z$-component of the electric field at the origin from all dipoles with lattice sites strictly inside a Lorentz sphere of radius $R$, excluding the origin. The problem text mentions \"strictly inside\" but provides the following explicit formula and inclusion rule, which take precedence:\n    $$\n    E_{\\mathrm{near}}(R) = \\sum_{\\substack{(i,j,k)\\in\\mathbb{Z}^3\\\\ (i,j,k)\\neq(0,0,0)\\\\ a\\sqrt{i^2+j^2+k^2}\\le R}}\\left[\\frac{1}{4\\pi \\epsilon_0}\\,\\frac{1}{|\\mathbf{R}|^3}\\left(3\\big(\\mathbf{p}\\cdot \\hat{\\mathbf{R}}\\big)\\hat{R}_z - p\\right)\\right]\n    $$\n-   **Inclusion Rule**: A lattice site $\\mathbf{R}$ is included if and only if $a\\sqrt{i^2+j^2+k^2}\\le R$.\n-   **Dimensionless Ratio $\\delta(R)$**: $\\delta(R) = \\frac{E_{\\mathrm{near}}(R)}{P/(3\\epsilon_0)}$.\n-   **Constant**: $\\epsilon_0 = 8.854187817\\times 10^{-12}\\ \\mathrm{F/m}$.\n-   **Task**: Implement a direct lattice sum to compute $E_{\\mathrm{near}}(R)$ and $\\delta(R)$, rounding results to ten decimal places.\n-   **Test Suite**:\n    1.  $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=1.01\\,a$.\n    2.  $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=1.42\\,a$.\n    3.  $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=3.01\\,a$.\n    4.  $a=4.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.2\\ \\mathrm{C/m^2}$, $R=3.01\\,a$.\n    5.  $a=3.0\\times 10^{-10}\\ \\mathrm{m}$, $P=0.1\\ \\mathrm{C/m^2}$, $R=3.01\\,a$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is a standard, canonical exercise in solid-state physics concerning the calculation of the local field in a dielectric solid. The dipole field formula and the Lorentz construction are fundamental concepts in electromagnetism. The problem is scientifically sound.\n-   **Well-Posed**: The problem is well-posed. It provides an explicit mathematical formula for the quantity to be calculated, $E_{\\mathrm{near}}(R)$, and all necessary parameters. The summation is over a finite, well-defined set of lattice points, ensuring a unique and stable solution for each test case.\n-   **Objective**: The problem is stated in precise, objective, and mathematical language, free from ambiguity or subjective content.\n\nThe problem does contain a minor linguistic imprecision, stating \"strictly inside the sphere\" in the descriptive text while the mathematical formula and the explicit inclusion rule both use a non-strict inequality ($a\\sqrt{i^2+j^2+k^2} \\le R$). The explicit mathematical definition and rule are unambiguous and will be followed. This does not render the problem invalid. All other validation criteria are met.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\n### **Part 2: Solution**\n\nThe objective is to compute the near-field correction $E_{\\mathrm{near}}(R)$ and the dimensionless ratio $\\delta(R)$ by performing a direct summation over lattice points within a sphere of radius $R$.\n\n**1. Simplification of the Summand**\nThe quantity to be calculated is a sum of contributions from each dipole at a lattice site $\\mathbf{R} = a(i\\hat{\\mathbf{x}} + j\\hat{\\mathbf{y}} + k\\hat{\\mathbf{z}})$ to the electric field at the origin ($\\mathbf{r}=\\mathbf{0}$). The summand is the $z$-component of this field.\n\nThe formula for the summand provided in the problem is:\n$$\n\\text{Summand} = \\frac{1}{4\\pi \\epsilon_0 |\\mathbf{R}|^3} \\left[ 3(\\mathbf{p}\\cdot\\hat{\\mathbf{R}})\\hat{R}_z - p \\right]\n$$\nGiven $\\mathbf{p} = p\\hat{\\mathbf{z}}$, the dot product is $\\mathbf{p}\\cdot\\hat{\\mathbf{R}} = p(\\hat{\\mathbf{z}}\\cdot\\hat{\\mathbf{R}})$. The component $\\hat{\\mathbf{z}}\\cdot\\hat{\\mathbf{R}}$ is precisely the $z$-component of the unit vector $\\hat{\\mathbf{R}}$, which is denoted $\\hat{R}_z$.\nSubstituting this, the term in the brackets becomes $3(p\\hat{R}_z)\\hat{R}_z - p = p(3\\hat{R}_z^2 - 1)$.\n\nThe full expression for the contribution from a single dipole is:\n$$\nE_{\\mathbf{R},z} = \\frac{p}{4\\pi \\epsilon_0 |\\mathbf{R}|^3} (3\\hat{R}_z^2 - 1)\n$$\nWe substitute the geometric quantities for a simple cubic lattice:\n-   $|\\mathbf{R}| = a\\sqrt{i^2+j^2+k^2}$\n-   $\\hat{R}_z = \\frac{ak}{|\\mathbf{R}|} = \\frac{k}{\\sqrt{i^2+j^2+k^2}}$\n-   $p = Pa^3$\n\nSubstituting these into the expression for $E_{\\mathbf{R},z}$:\n$$\nE_{\\mathbf{R},z} = \\frac{Pa^3}{4\\pi \\epsilon_0 (a\\sqrt{i^2+j^2+k^2})^3} \\left( 3\\left(\\frac{k}{\\sqrt{i^2+j^2+k^2}}\\right)^2 - 1 \\right)\n$$\n$$\nE_{\\mathbf{R},z} = \\frac{P}{4\\pi \\epsilon_0} \\frac{1}{(i^2+j^2+k^2)^{3/2}} \\left( \\frac{3k^2}{i^2+j^2+k^2} - 1 \\right)\n$$\n$$\nE_{\\mathbf{R},z} = \\frac{P}{4\\pi \\epsilon_0} \\frac{3k^2 - (i^2+j^2+k^2)}{(i^2+j^2+k^2)^{5/2}} = \\frac{P}{4\\pi \\epsilon_0} \\frac{2k^2 - i^2 - j^2}{(i^2+j^2+k^2)^{5/2}}\n$$\nThis is the term to be summed for each lattice point $(i,j,k)$.\n\n**2. The Lattice Sum and a Critical Symmetry Argument**\nThe total near field is the sum over all points satisfying the given conditions:\n$$\nE_{\\mathrm{near}}(R) = \\sum_{\\substack{0 < i^2+j^2+k^2 \\le (R/a)^2}} E_{\\mathbf{R},z} = \\frac{P}{4\\pi \\epsilon_0} \\sum_{\\substack{0 < i^2+j^2+k^2 \\le (R/a)^2}} \\frac{2k^2 - i^2 - j^2}{(i^2+j^2+k^2)^{5/2}}\n$$\nLet's denote the geometric part of the sum as $S(R/a)$:\n$$\nS(R/a) = \\sum_{\\substack{(i,j,k)\\in\\mathbb{Z}^3 \\\\ 0 < i^2+j^2+k^2 \\le (R/a)^2}} \\frac{2k^2 - i^2 - j^2}{(i^2+j^2+k^2)^{5/2}}\n$$\nA crucial property of this sum for a simple cubic lattice arises from its symmetry. The summation is over a set of integer points $(i,j,k)$ contained within a sphere centered at the origin. This set of points is invariant under any permutation of the coordinates $i, j, k$. For example, if $(i_0, j_0, k_0)$ is in the set, then so is $(j_0, k_0, i_0)$, since $j_0^2+k_0^2+i_0^2 = i_0^2+j_0^2+k_0^2$.\n\nLet us decompose the sum $S$ as $2\\Sigma_z - \\Sigma_x - \\Sigma_y$, where:\n$$\n\\Sigma_x = \\sum \\frac{i^2}{d^5}, \\quad \\Sigma_y = \\sum \\frac{j^2}{d^5}, \\quad \\Sigma_z = \\sum \\frac{k^2}{d^5} \\quad (d^2 = i^2+j^2+k^2)\n$$\nDue to the permutation symmetry of the summation domain, the values of these three sums must be identical. A formal proof involves a change of variables. For instance, to show $\\Sigma_x = \\Sigma_z$, we can relabel the summation indices $(i,j,k) \\to (k,j,i)$. The summation domain and the denominator $d^5$ are unchanged by this permutation, but the numerator $i^2$ becomes $k^2$. Therefore, $\\Sigma_x = \\Sigma_y = \\Sigma_z$.\n\nSubstituting this result back into the expression for the total sum $S(R/a)$:\n$$\nS(R/a) = 2\\Sigma_z - \\Sigma_x - \\Sigma_y = 2\\Sigma_z - \\Sigma_z - \\Sigma_z = 0\n$$\nThis is a rigorous analytical result: for a simple cubic lattice, the sum of dipolar fields at the origin from all other dipoles contained within any spherical volume centered at the origin is exactly zero. This holds regardless of the sphere's radius.\n\n**3. Calculation of $E_{\\mathrm{near}}(R)$ and $\\delta(R)$**\nWith the analytical result $S(R/a) = 0$, the physical quantities become:\n-   $E_{\\mathrm{near}}(R) = \\frac{P}{4\\pi \\epsilon_0} \\times 0 = 0$\n-   $\\delta(R) = \\frac{E_{\\mathrm{near}}(R)}{P/(3\\epsilon_0)} = 0$\n\nThis result holds for all five test cases, as they all pertain to a simple cubic lattice and a spherical summation volume. The problem is thus a conceptual check of this fundamental principle of symmetry in electrostatics.\n\n**4. Algorithmic Implementation**\nThe program will perform the direct summation as instructed. While the analytical result is zero, the implementation serves as a numerical verification. The code will iterate through all integer triplets $(i,j,k)$ that fall within the specified Lorentz sphere for each test case. It will calculate the contribution from each point and accumulate the sum. Due to the perfect symmetry of the sum, the final numerical result, before any rounding, is expected to be extremely close to zero (e.g., on the order of machine epsilon, $\\approx 10^{-16}$). Rounding to ten decimal places as requested will yield exactly $0.0$.\n\nThe algorithm outline is as follows:\n1.  For each test case $(a, P, R_{mult})$, where $R=R_{mult} \\cdot a$.\n2.  Initialize a sum variable $S$ to $0.0$.\n3.  Determine the integer search bounds: $i_{max} = \\lfloor R_{mult} \\rfloor$.\n4.  Iterate through $i, j, k$ within a progressively constrained cubic box that contains the sphere:\n    -   $i \\in [-i_{max}, i_{max}]$\n    -   $j \\in [-\\lfloor\\sqrt{R_{mult}^2-i^2}\\rfloor, \\lfloor\\sqrt{R_{mult}^2-i^2}\\rfloor]$\n    -   $k \\in [-\\lfloor\\sqrt{R_{mult}^2-i^2-j^2}\\rfloor, \\lfloor\\sqrt{R_{mult}^2-i^2-j^2}\\rfloor]$\n5.  Inside the loops, exclude the origin $(0,0,0)$.\n6.  Calculate the term $\\frac{2k^2 - i^2 - j^2}{(i^2+j^2+k^2)^{5/2}}$ and add it to $S$.\n7.  After the summation, calculate $E_{\\mathrm{near}} = \\frac{P}{4\\pi\\epsilon_0}S$ and $\\delta = \\frac{3}{4\\pi}S$.\n8.  Round the final values to ten decimal places and store them.\n9.  Format the collection of results into the specified output string.\n\nThis implementation will explicitly carry out the required calculation and numerically confirm the analytical prediction of zero for all cases.", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the near-field correction E_near and the dimensionless ratio delta\n    for a simple cubic lattice of dipoles.\n\n    The problem asks for a direct summation of the electric field contributions\n    from dipoles within a spherical volume (the Lorentz sphere). For a simple\n    cubic lattice with dipoles aligned along a crystallographic axis (here, z),\n    a rigorous symmetry argument shows that this sum is analytically zero for any\n    spherical summation volume centered on a lattice site.\n\n    The proof relies on the fact that the set of lattice points inside the sphere\n    is symmetric with respect to permutations of the i, j, k coordinates. This\n    causes the sum of the geometric factor (2*k^2 - i^2 - j^2) / (i^2+j^2+k^2)^(5/2)\n    to be exactly zero when summed over all included points.\n\n    This program implements the direct summation as requested. As predicted by theory,\n    the numerical result for the sum is zero to within floating-point precision,\n    and therefore zero after rounding.\n    \"\"\"\n    # Physical constant\n    epsilon0 = 8.854187817e-12  # Vacuum permittivity in F/m\n\n    # Test suite from the problem statement: (a in m, P in C/m^2, R_mult)\n    test_cases = [\n        (4.0e-10, 0.1, 1.01),  # Case 1\n        (4.0e-10, 0.1, 1.42),  # Case 2\n        (4.0e-10, 0.1, 3.01),  # Case 3\n        (4.0e-10, 0.2, 3.01),  # Case 4\n        (3.0e-10, 0.1, 3.01),  # Case 5\n    ]\n\n    results = []\n    \n    for a, P, R_mult in test_cases:\n        # The geometric sum S depends only on the ratio R/a = R_mult.\n        S = 0.0\n        \n        R_mult_sq = R_mult**2\n        i_max = math.floor(R_mult)\n        \n        # Iterate over a bounding box and then check sphere condition.\n        # A more efficient method is to shrink the inner loop bounds.\n        for i in range(-i_max, i_max + 1):\n            i_sq = i**2\n            # Calculate max j for this i\n            j_bound_sq = R_mult_sq - i_sq\n            if j_bound_sq  0:\n                continue\n            j_max = math.floor(math.sqrt(j_bound_sq))\n\n            for j in range(-j_max, j_max + 1):\n                j_sq = j**2\n                # Calculate max k for this i, j\n                k_bound_sq = R_mult_sq - i_sq - j_sq\n                if k_bound_sq  0:\n                    continue\n                k_max = math.floor(math.sqrt(k_bound_sq))\n\n                for k in range(-k_max, k_max + 1):\n                    # Exclude the dipole at the origin\n                    if i == 0 and j == 0 and k == 0:\n                        continue\n                    \n                    k_sq = k**2\n                    d2 = float(i_sq + j_sq + k_sq) # d^2 = i^2+j^2+k^2\n                    \n                    # The loops are constructed to only include points within the sphere,\n                    # so this check is redundant.\n                    # if d2 > R_mult_sq:\n                    #     continue\n                        \n                    term = (2.0 * k_sq - i_sq - j_sq) / (d2**2.5)\n                    S += term\n\n        # Calculate E_near and delta from the geometric sum S\n        E_near = (P / (4.0 * np.pi * epsilon0)) * S\n        delta = (3.0 / (4.0 * np.pi)) * S\n        \n        # Round final results to ten decimal places\n        E_near_rounded = round(E_near, 10)\n        delta_rounded = round(delta, 10)\n        \n        # Ensure that negative zero is formatted as 0.0\n        if E_near_rounded == -0.0: E_near_rounded = 0.0\n        if delta_rounded == -0.0: delta_rounded = 0.0\n\n        results.append([f\"{E_near_rounded:.10f}\", f\"{delta_rounded:.10f}\"])\n\n    # Format the final output string exactly as requested\n    output_str = \"[\" + \",\".join([f\"[{e[0]},{e[1]}]\" for e in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3001504"}]}