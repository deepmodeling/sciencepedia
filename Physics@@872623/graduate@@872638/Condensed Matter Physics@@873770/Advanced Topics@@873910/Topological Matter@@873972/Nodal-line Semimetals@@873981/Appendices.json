{"hands_on_practices": [{"introduction": "The existence of a nodal line is fundamentally a geometric condition on the band structure. This first exercise provides a direct, hands-on calculation to see how such a feature emerges from a simple tight-binding model. By tuning a single parameter, you will determine the precise range over which the conduction and valence bands touch along a continuous loop in the Brillouin zone, solidifying the connection between the Hamiltonian's parameters and the resulting topological structure [@problem_id:1122812].", "problem": "In condensed matter physics, a nodal-line semimetal is a material whose conduction and valence bands touch along a continuous line, known as a nodal line or nodal loop, in the momentum space (Brillouin zone).\n\nConsider a simplified two-dimensional tight-binding model for a nodal-line semimetal on a square lattice with lattice constant $a$. The low-energy behavior of this system is described by the $2 \\times 2$ Hamiltonian matrix:\n$$\nH(\\mathbf{k}) = h(\\mathbf{k}) \\sigma_z = \\left(t(\\cos(k_x a) + \\cos(k_y a)) - \\mu \\right) \\sigma_z\n$$\nHere, $\\mathbf{k} = (k_x, k_y)$ is the wavevector, $\\sigma_z$ is the third Pauli matrix, $t$ is the nearest-neighbor hopping amplitude, and $\\mu$ is a parameter related to the chemical potential that controls the band filling. We can work in units where the hopping amplitude $t=1$ and the lattice constant $a=1$. The Hamiltonian then simplifies to:\n$$\nH(\\mathbf{k}) = (\\cos(k_x) + \\cos(k_y) - M) \\sigma_z\n$$\nwhere $M$ is a dimensionless parameter. The first Brillouin zone is defined by $k_x, k_y \\in [-\\pi, \\pi]$.\n\nThe energy bands are given by the eigenvalues of $H(\\mathbf{k})$. A nodal line exists when the energy gap between the two bands closes, which occurs when the eigenvalues are zero. Such gapless points form a continuous nodal loop in the Brillouin zone for a certain range of the parameter $M$. This range is an open interval, $M \\in (M_{\\text{min}}, M_{\\text{max}})$. At the endpoints of this interval, $M=M_{\\text{min}}$ and $M=M_{\\text{max}}$, the nodal loop shrinks to a single point.\n\nCalculate the total width $W$ of the parameter range for which a nodal loop exists, defined as $W = M_{\\text{max}} - M_{\\text{min}}$.", "solution": "The nodal loop exists when the energy gap closes, which occurs when the eigenvalues of the Hamiltonian are zero. This happens when:\n\n$$\n\\cos(k_x) + \\cos(k_y) - M = 0\n$$\n\nor equivalently:\n\n$$\n\\cos(k_x) + \\cos(k_y) = M\n$$\n\nwhere $k_x, k_y \\in [-\\pi, \\pi]$.\n\nThe function $f(k_x, k_y) = \\cos(k_x) + \\cos(k_y)$ ranges over $[-2, 2]$ because:\n- The minimum value is $-2$, achieved at $(k_x, k_y) = (\\pm\\pi, \\pm\\pi)$.\n- The maximum value is $2$, achieved at $(k_x, k_y) = (0, 0)$.\n\nFor $M \\in (-2, 2)$, the solution set of $\\cos(k_x) + \\cos(k_y) = M$ forms a continuous closed curve (a nodal loop) in the Brillouin zone. At $M = -2$ and $M = 2$, the solution set degenerates to a single point: $(\\pm\\pi, \\pm\\pi)$ for $M = -2$ and $(0, 0)$ for $M = 2$. Therefore, the nodal loop exists for $M$ in the open interval $(M_{\\text{min}}, M_{\\text{max}})$ where:\n\n$$\nM_{\\text{min}} = -2, \\quad M_{\\text{max}} = 2\n$$\n\n\nThe total width $W$ is defined as:\n\n$$\nW = M_{\\text{max}} - M_{\\text{min}}\n$$\n\nSubstituting the values:\n\n$$\nW = 2 - (-2) = 4\n$$", "answer": "$$ \\boxed{4} $$", "id": "1122812"}, {"introduction": "Nodal lines are not typically accidental; their existence is often guaranteed by underlying crystal symmetries. This exercise explores the crucial concept of symmetry protection using a low-energy effective Hamiltonian, a powerful tool for isolating essential physics. You will first see how a combined parity-time ($PT$) symmetry protects a nodal ring and then investigate the consequences of breaking this symmetry, which opens a mass gap and drives a topological phase transition from a semimetal to an insulator [@problem_id:3007268].", "problem": "Consider a spinless two-band Bloch Hamiltonian in three spatial dimensions with combined spatial inversion and time-reversal symmetry (parity-time symmetry, abbreviated as $PT$) near a symmetry-protected nodal ring. Assume that, in a neighborhood of the ring, the low-energy Hamiltonian can be written in cylindrical coordinates $k_{x} = k_{\\rho}\\cos\\phi$, $k_{y} = k_{\\rho}\\sin\\phi$, $k_{z}$ as\n$$\nH_{0}(\\mathbf{k}) \\;=\\; d_{x}(\\mathbf{k})\\,\\sigma_{x} \\;+\\; d_{z}(\\mathbf{k})\\,\\sigma_{z},\n$$\nwith\n$$\nd_{x}(\\mathbf{k}) \\;=\\; v_{\\rho}\\big(k_{\\rho} - k_{0}\\big),\\qquad d_{z}(\\mathbf{k}) \\;=\\; v_{z}\\,k_{z},\n$$\nwhere $v_{\\rho} \\!>\\! 0$, $v_{z} \\!>\\! 0$ are real velocities, $k_{0} \\!>\\! 0$ sets the radius of the nodal ring in the $k_{z}\\!=\\!0$ plane, and $\\sigma_{x}$, $\\sigma_{z}$ are Pauli matrices acting in a two-band orbital subspace. You may assume that $PT$ symmetry for spinless fermions implies that, in an appropriate basis, $H_{0}(\\mathbf{k})$ is a real matrix for all $\\mathbf{k}$.\n\n(a) Using only the stated symmetry implication and the given form of $H_{0}(\\mathbf{k})$, explain why the spectrum of $H_{0}(\\mathbf{k})$ exhibits a nodal ring and identify its location in momentum space.\n\n(b) Now add an onsite term\n$$\nH_{m} \\;=\\; m\\,\\sigma_{y},\n$$\nwith real constant $m \\neq 0$. Justify, from first principles of how $PT$ acts on matrices and complex conjugation, why this term breaks $PT$ symmetry in the spinless case and argue that the combined Hamiltonian $H(\\mathbf{k}) = H_{0}(\\mathbf{k}) + H_{m}$ becomes fully gapped.\n\n(c) Define $q_{\\rho} \\equiv k_{\\rho} - k_{0}$ and $q_{z} \\equiv k_{z}$ as small deviations transverse to the former nodal ring. The direct band gap at a fixed momentum $\\mathbf{k}$ is defined as the energy difference between the conduction and valence bands at that same $\\mathbf{k}$. Derive the analytic expression for the direct gap $\\Delta(q_{\\rho},q_{z})$ in terms of $m$, $v_{\\rho}$, $v_{z}$, $q_{\\rho}$, and $q_{z}$, valid to leading order in these deviations. Your final answer must be a single closed-form expression. Do not approximate or round; keep all symbols as defined. Express your final answer as an analytic expression without units.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It represents a standard model in condensed matter physics for describing nodal-line semimetals and the effect of symmetry-breaking perturbations. We may therefore proceed with a full solution.\n\nThe problem asks for a three-part analysis of a two-band Hamiltonian model for a nodal-line semimetal.\n\n(a) Nodal ring identification in $H_{0}(\\mathbf{k})$.\n\nThe given Hamiltonian is $H_{0}(\\mathbf{k}) = d_{x}(\\mathbf{k})\\,\\sigma_{x} + d_{z}(\\mathbf{k})\\,\\sigma_{z}$. This is a $2 \\times 2$ matrix of the general form $\\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$, where $\\boldsymbol{\\sigma} = (\\sigma_{x}, \\sigma_{y}, \\sigma_{z})$ is the vector of Pauli matrices and $\\mathbf{d}(\\mathbf{k}) = (d_{x}(\\mathbf{k}), 0, d_{z}(\\mathbf{k}))$. The energy eigenvalues of such a Hamiltonian are given by $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})|$.\nIn our case, the eigenvalues are:\n$$\nE_{\\pm}(\\mathbf{k}) = \\pm \\sqrt{d_{x}(\\mathbf{k})^{2} + d_{z}(\\mathbf{k})^{2}}\n$$\nA nodal feature, or a degeneracy in the spectrum, occurs where the energy gap between the two bands closes. This means $E_{+}(\\mathbf{k}) = E_{-}(\\mathbf{k})$, which is only possible if the energy of both bands is zero. This requires the magnitude of the $\\mathbf{d}$-vector to vanish:\n$$\n|\\mathbf{d}(\\mathbf{k})| = \\sqrt{d_{x}(\\mathbf{k})^{2} + d_{z}(\\mathbf{k})^{2}} = 0\n$$\nThis single condition is equivalent to two simultaneous conditions for the real functions $d_{x}(\\mathbf{k})$ and $d_{z}(\\mathbf{k})$:\n$1$. $d_{x}(\\mathbf{k}) = v_{\\rho}(k_{\\rho} - k_{0}) = 0$. Since $v_{\\rho}>0$ is given, this implies $k_{\\rho} = k_{0}$.\n$2$. $d_{z}(\\mathbf{k}) = v_{z}k_{z} = 0$. Since $v_{z}>0$ is given, this implies $k_{z} = 0$.\n\nThe set of points in momentum space $(\\mathbf{k})$ satisfying both conditions is defined by $k_{\\rho} = \\sqrt{k_x^2 + k_y^2} = k_{0}$ and $k_{z}=0$. This is the equation of a circle of radius $k_{0}$ centered at the origin in the $k_{z}=0$ plane. This is the nodal ring.\n\nThe problem specifies that for spinless fermions with $PT$ symmetry, the Hamiltonian $H_0(\\mathbf{k})$ can be chosen to be a real matrix. A general $2 \\times 2$ Hamiltonian is $H = d_0 I + d_x\\sigma_x + d_y\\sigma_y + d_z\\sigma_z$. Since $\\sigma_x$ and $\\sigma_z$ are real matrices while $\\sigma_y$ is purely imaginary, the condition that $H_0(\\mathbf{k})$ is real (assuming real coefficients $d_i$) implies that the coefficient of $\\sigma_y$ must be zero, i.e., $d_y(\\mathbf{k})=0$. In a generic three-dimensional system, closing the gap would require three conditions to be met ($d_x=0, d_y=0, d_z=0$), which typically occurs only at isolated points (Weyl points). The $PT$ symmetry, by forcing $d_y(\\mathbf{k})=0$ for all $\\mathbf{k}$, reduces the number of conditions for a degeneracy from three to two. The two conditions $d_x(\\mathbf{k})=0$ and $d_z(\\mathbf{k})=0$ define a line in the three-dimensional momentum space, which in this case is the nodal ring.\n\n(b) $PT$ symmetry breaking and gap opening.\n\nThe added term is $H_{m} = m\\,\\sigma_{y}$, where $m$ is a non-zero real constant. We need to justify why this term breaks $PT$ symmetry from first principles. For a spinless system, the time-reversal operator is simply the complex conjugation operator, $T = K$. The parity operator $P$ inverts momentum, $\\mathbf{k} \\to -\\mathbf{k}$. A Hamiltonian $H$ is $PT$-symmetric if it is invariant under the combined operation, i.e., $(PT)H(PT)^{-1} = H$.\n\nLet's analyze the action of $PT$ on the term $H_m$. Since $H_m$ is independent of momentum $\\mathbf{k}$, the parity operator has a trivial action on it within the orbital basis (i.e., $P H_m P^{-1} = H_m$). The action of the full $PT$ operator is then:\n$$\n(PT)H_{m}(PT)^{-1} = K (P H_{m} P^{-1}) K^{-1} = K H_{m} K^{-1}\n$$\nSubstituting $H_m = m\\sigma_y$ and noting that $m$ is a real constant:\n$$\nK (m\\sigma_{y}) K^{-1} = m K \\sigma_{y} K^{-1} = m \\sigma_{y}^{*}\n$$\nThe Pauli matrix $\\sigma_y$ is given by $\\sigma_{y} = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}$. Its complex conjugate is $\\sigma_{y}^{*} = \\begin{pmatrix} 0 & i \\\\ -i & 0 \\end{pmatrix} = -\\sigma_{y}$.\nTherefore, we have:\n$$\n(PT)H_{m}(PT)^{-1} = -m\\sigma_{y} = -H_{m}\n$$\nThe condition for $H_m$ to respect $PT$ symmetry is $(PT)H_{m}(PT)^{-1} = H_{m}$, which would mean $-H_m = H_m$. This is only satisfied if $H_m=0$, which requires $m=0$. As the problem states $m \\neq 0$, the term $H_m$ breaks $PT$ symmetry.\n\nNow we argue that the combined Hamiltonian $H(\\mathbf{k}) = H_{0}(\\mathbf{k}) + H_{m}$ is fully gapped. The new Hamiltonian is:\n$$\nH(\\mathbf{k}) = d_{x}(\\mathbf{k})\\,\\sigma_{x} + m\\,\\sigma_{y} + d_{z}(\\mathbf{k})\\,\\sigma_{z}\n$$\nThis is of the form $\\mathbf{d'}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$ with a new vector $\\mathbf{d'}(\\mathbf{k}) = (d_{x}(\\mathbf{k}), m, d_{z}(\\mathbf{k}))$. The energy eigenvalues are $E'_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d'}(\\mathbf{k})|$.\n$$\nE'_{\\pm}(\\mathbf{k}) = \\pm \\sqrt{d_{x}(\\mathbf{k})^{2} + m^{2} + d_{z}(\\mathbf{k})^{2}}\n$$\nThe system is gapped if the energy difference between the bands is always non-zero for any $\\mathbf{k}$. This means the eigenvalues can never be zero. A zero eigenvalue would require $|\\mathbf{d'}(\\mathbf{k})|=0$, which implies $d_{x}(\\mathbf{k})^{2} + m^{2} + d_{z}(\\mathbf{k})^{2} = 0$. Since $d_x$, $d_z$, and $m$ are real, their squares are non-negative. The sum can be zero only if each term is zero: $d_x(\\mathbf{k})=0$, $m=0$, and $d_z(\\mathbf{k})=0$. However, the problem specifies $m \\neq 0$. Thus, the quantity under the square root, $[v_{\\rho}(k_{\\rho}-k_{0})]^2 + m^2 + [v_z k_z]^2$, is strictly positive for all values of $\\mathbf{k}$. Its minimum value is $m^2$, which occurs at the location of the former nodal ring ($k_\\rho=k_0, k_z=0$). Since the eigenvalues are never zero, the spectrum is fully gapped.\n\n(c) Derivation of the direct band gap.\n\nThe direct band gap $\\Delta$ at a given momentum $\\mathbf{k}$ is the difference between the energy of the conduction band ($E'_{+}$) and the valence band ($E'_{-}$) at that same $\\mathbf{k}$.\n$$\n\\Delta(\\mathbf{k}) = E'_{+}(\\mathbf{k}) - E'_{-}(\\mathbf{k})\n$$\nUsing the eigenvalues derived in part (b):\n$$\n\\Delta(\\mathbf{k}) = \\left(\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\\right) - \\left(-\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\\right) = 2\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\n$$\nThe problem asks for this expression in terms of the small momentum deviations $q_{\\rho} = k_{\\rho} - k_{0}$ and $q_{z} = k_{z}$. The model Hamiltonian is already linearized in these deviations, as $d_{x}(\\mathbf{k}) = v_{\\rho}(k_{\\rho} - k_{0}) = v_{\\rho}q_{\\rho}$ and $d_{z}(\\mathbf{k}) = v_{z}k_{z} = v_{z}q_{z}$. These are the leading-order terms for the Hamiltonian components near the nodal ring. Substituting these into the expression for the gap, we obtain the expression for the gap that is consistent with this leading-order Hamiltonian.\n$$\n\\Delta(q_{\\rho},q_{z}) = 2\\sqrt{(v_{\\rho}q_{\\rho})^{2} + m^{2} + (v_{z}q_{z})^{2}}\n$$\nThis simplifies to:\n$$\n\\Delta(q_{\\rho},q_{z}) = 2\\sqrt{v_{\\rho}^{2}q_{\\rho}^{2} + m^{2} + v_{z}^{2}q_{z}^{2}}\n$$\nThis is the final closed-form analytic expression for the direct gap, valid within the given leading-order model.", "answer": "$$\n\\boxed{2 \\sqrt{v_{\\rho}^{2} q_{\\rho}^{2} + m^{2} + v_{z}^{2} q_{z}^{2}}}\n$$", "id": "3007268"}, {"introduction": "A profound feature of topological matter is the bulk-boundary correspondence, which dictates that non-trivial bulk topology leads to exotic states at the system's boundary. For nodal-line semimetals, this manifests as unique 'drumhead' surface states that span the region of momentum space enclosed by the projected nodal line. This computational practice guides you through the process of numerically verifying this correspondence by constructing a slab model and identifying these tell-tale surface states, bridging abstract topological theory with a concrete, observable prediction [@problem_id:3007279].", "problem": "Consider a minimal two-band tight-binding model on a simple cubic lattice that realizes a nodal-line semimetal with a nodal ring in the plane of wave vector component $k_z = 0$. The Bloch Hamiltonian in momentum space is given by\n$$\nH(\\mathbf{k}) = \\left[m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) - t_z \\cos k_z\\right]\\sigma_z + v \\sin k_z \\,\\sigma_x,\n$$\nwhere $\\mathbf{k} = (k_x,k_y,k_z)$, $\\sigma_x$ and $\\sigma_z$ are Pauli matrices acting in orbital space, and $m$, $t_{xy}$, $t_z$, and $v$ are real parameters. All energies are dimensionless and expressed in units where the lattice constant is $1$, and all angles are in radians.\n\nStarting from the definitions of the tight-binding Hamiltonian and Bloch’s theorem, and using the discrete Fourier transform between real space and momentum space along a single axis, implement open boundary conditions along the $z$ axis for a slab with $N$ layers and crystal momentum $(k_x,k_y)$ held fixed. Your implementation must:\n- Derive the real-space slab Hamiltonian $H_{\\text{slab}}(k_x,k_y)$ that is block tridiagonal with $2 \\times 2$ blocks, using only nearest-layer couplings along $z$ implied by the given Bloch Hamiltonian.\n- Numerically diagonalize $H_{\\text{slab}}(k_x,k_y)$ to obtain eigenvalues $E_\\alpha$ and normalized eigenvectors $\\lvert \\psi_\\alpha \\rangle$.\n- Quantify surface localization by computing the probability weight on the first $s$ and last $s$ layers for each eigenstate:\n$$\nw_{\\text{left},\\alpha} = \\sum_{n=1}^{s} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\\quad\nw_{\\text{right},\\alpha} = \\sum_{n=N-s+1}^{N} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\n$$\nwhere $\\psi_\\alpha(n,o)$ is the amplitude on layer $n$ and orbital $o$.\n- Declare that a surface drumhead state is present at $(k_x,k_y)$ if there exists at least one eigenstate with $\\lvert E_\\alpha \\rvert \\le \\delta$ and $\\max\\{w_{\\text{left},\\alpha}, w_{\\text{right},\\alpha}\\} \\ge w_{\\text{th}}$.\n\nUse the following fixed parameter values for all computations:\n- $m = 1.5$, $t_{xy} = 1.0$, $t_z = 1.0$, $v = 0.6$.\n- Slab thickness $N = 80$ layers.\n- Surface window thickness $s = 4$ layers.\n- Energy window $\\delta = 0.08$.\n- Surface localization threshold $w_{\\text{th}} = 0.3$.\n\nTest suite. For the fixed model and parameters above, evaluate the presence or absence of surface drumhead states for the following four $(k_x,k_y)$ points (angles in radians):\n- Case $1$: $(k_x,k_y) = (0,0)$.\n- Case $2$: $(k_x,k_y) = (\\pi,\\pi)$.\n- Case $3$: $(k_x,k_y) = (2\\pi/3,0)$.\n- Case $4$: $(k_x,k_y) = (\\pi,0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of Python boolean literals enclosed in square brackets, in the order of the cases above, for example, $[{\\tt True},{\\tt False},{\\tt False},{\\tt True}]$. There are no physical units to report because the model is dimensionless, and all angles are in radians. The final output is therefore a list of four booleans on a single line. The program must be self-contained and require no user input.", "solution": "To model a finite slab with open boundary conditions along the $z$-axis, we perform an inverse Fourier transform on the Bloch Hamiltonian $H(\\mathbf{k})$ with respect to $k_z$. The terms $\\cos k_z = (e^{ik_z} + e^{-ik_z})/2$ and $\\sin k_z = (e^{ik_z} - e^{-ik_z})/(2i)$ in $H(\\mathbf{k})$ correspond to nearest-neighbor layer couplings in real space. For a slab of $N$ layers, this results in a $2N \\times 2N$ block-tridiagonal matrix, $H_{\\text{slab}}(k_x,k_y)$, where each block is a $2 \\times 2$ matrix acting on the orbital degrees of freedom.\n\nThe diagonal blocks, representing the intra-layer (onsite) Hamiltonian for each layer, are given by:\n$$\nH_0(k_x, k_y) = \\left[m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right)\\right]\\sigma_z\n$$\nThe off-diagonal blocks, representing the inter-layer hopping from layer $n$ to $n+1$, are given by:\n$$\nT = -\\frac{t_z}{2}\\sigma_z - i\\frac{v}{2}\\sigma_x\n$$\nThe hopping from layer $n+1$ to $n$ is given by the Hermitian conjugate, $T^\\dagger$.\n\nFor a fixed in-plane momentum $(k_x,k_y)$, we numerically construct this $2N \\times 2N$ Hermitian matrix and diagonalize it to find its eigenvalues $E_\\alpha$ and corresponding eigenvectors $|\\psi_\\alpha\\rangle$. Each eigenvector has $2N$ components, which can be indexed as $\\psi_\\alpha(n,o)$, representing the amplitude on layer $n \\in \\{1, \\dots, N\\}$ and orbital $o \\in \\{1, 2\\}$.\n\nA drumhead surface state is identified by two simultaneous conditions:\n1.  **Near-zero energy:** The eigenenergy must lie within a small window around the Fermi level, $|E_\\alpha| \\le \\delta$.\n2.  **Surface localization:** The eigenstate's probability density must be concentrated near the surfaces of the slab. We quantify this by calculating the probability weight on the first $s$ layers ($w_{\\text{left},\\alpha}$) and the last $s$ layers ($w_{\\text{right},\\alpha}$). A state is considered surface-localized if $\\max\\{w_{\\text{left},\\alpha}, w_{\\text{right},\\alpha}\\} \\ge w_{\\text{th}}$.\n\nThe existence of these topological surface states is predicted by the bulk topology. For this model, states are expected inside the region of the surface Brillouin zone where $\\cos k_x + \\cos k_y > 0.5$. The provided Python code implements this full procedure—constructing the slab Hamiltonian, diagonalizing it, and checking the criteria for each of the four test cases—to determine the presence or absence of a drumhead state.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_slab_hamiltonian(kx, ky, params, N):\n    \"\"\"\n    Construct the 2N x 2N slab Hamiltonian with open boundaries along z.\n    params: dict with keys m, txy, tz, v\n    \"\"\"\n    m = params[\"m\"]\n    txy = params[\"txy\"]\n    tz = params[\"tz\"]\n    v = params[\"v\"]\n\n    # Pauli matrices\n    sx = np.array([[0.0, 1.0],\n                   [1.0, 0.0]], dtype=np.complex128)\n    sz = np.array([[1.0, 0.0],\n                   [0.0, -1.0]], dtype=np.complex128)\n\n    # Onsite block H0(kx,ky) = [m - txy (cos kx + cos ky)] * sz\n    H0_coeff = (m - txy * (np.cos(kx) + np.cos(ky)))\n    H0 = H0_coeff * sz\n\n    # Nearest-layer hopping T = -(tz/2) * sz - i (v/2) * sx\n    T = -(tz / 2.0) * sz - 1j * (v / 2.0) * sx\n    T_dag = T.conj().T\n\n    dim = 2 * N\n    H = np.zeros((dim, dim), dtype=np.complex128)\n\n    # Fill diagonal blocks\n    for n in range(N):\n        i0 = 2 * n\n        H[i0:i0+2, i0:i0+2] = H0\n\n    # Fill off-diagonal nearest-layer blocks\n    for n in range(N - 1):\n        i0 = 2 * n\n        j0 = 2 * (n + 1)\n        H[i0:i0+2, j0:j0+2] = T\n        H[j0:j0+2, i0:i0+2] = T_dag\n\n    return H\n\ndef surface_drumhead_present(kx, ky, params, N, s, delta, wthr):\n    \"\"\"\n    Determine if a drumhead surface state is present for given (kx,ky).\n    Criteria: exists eigenstate with |E| <= delta and surface weight >= wthr.\n    \"\"\"\n    H = build_slab_hamiltonian(kx, ky, params, N)\n    # Hermitian eigen-decomposition\n    evals, evecs = np.linalg.eigh(H)\n\n    # Reshape eigenvectors to (N,2) per state for probability computations\n    present = False\n    # Pre-compute layer indices for left and right surfaces\n    left_layers = list(range(0, s))\n    right_layers = list(range(N - s, N))\n\n    for idx, E in enumerate(evals):\n        if abs(E) <= delta:\n            vec = evecs[:, idx]\n            # Reshape to (N, 2)\n            psi = vec.reshape(N, 2)\n            # Probability per layer (sum over orbitals)\n            layer_prob = np.sum(np.abs(psi)**2, axis=1).real\n            # Normalization safety (should already be normalized)\n            total = np.sum(layer_prob)\n            if total <= 0:\n                continue\n            # Compute surface weights\n            w_left = float(np.sum(layer_prob[left_layers]))\n            w_right = float(np.sum(layer_prob[right_layers]))\n            if max(w_left, w_right) >= wthr:\n                present = True\n                break\n\n    return present\n\ndef solve():\n    # Fixed parameters as specified in the problem\n    params = {\n        \"m\": 1.5,\n        \"txy\": 1.0,\n        \"tz\": 1.0,\n        \"v\": 0.6,\n    }\n    N = 80\n    s = 4\n    delta = 0.08\n    wthr = 0.3\n\n    # Test cases: angles in radians\n    test_cases = [\n        (0.0, 0.0),                 # Case 1: inside\n        (np.pi, np.pi),             # Case 2: outside\n        (2.0 * np.pi / 3.0, 0.0),   # Case 3: boundary\n        (np.pi, 0.0),               # Case 4: outside\n    ]\n\n    results = []\n    for kx, ky in test_cases:\n        res = surface_drumhead_present(kx, ky, params, N, s, delta, wthr)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3007279"}]}