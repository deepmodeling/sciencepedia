{"hands_on_practices": [{"introduction": "Ghost imaging was first demonstrated with thermal light, revealing that quantum entanglement is not a prerequisite for this remarkable effect. This exercise takes you back to these foundations, asking you to derive the resolution of a ghost image formed with a partially coherent classical source. By working through this problem [@problem_id:718454], you will gain a fundamental understanding of how spatial correlations, whether classical or quantum, can be used to form an image of an object that the imaging detector never directly illuminates.", "problem": "Consider a lensless ghost imaging setup. A partially coherent light source, modeled as a chaotic thermal source, is located at the plane $z=0$. The mutual coherence function of the source field $E_s(\\mathbf{r})$ is given by a stationary Gaussian profile:\n$$ \\langle E_s^*(\\mathbf{r}_1) E_s(\\mathbf{r}_2) \\rangle = I_0 \\exp\\left(-\\frac{|\\mathbf{r}_1 - \\mathbf{r}_2|^2}{2\\sigma_c^2}\\right) $$\nwhere $\\mathbf{r}_1$ and $\\mathbf{r}_2$ are transverse position vectors at $z=0$, $I_0$ is the average intensity, and $\\sigma_c$ represents the transverse coherence length. A 50/50 beam splitter at $z=0$ divides the beam into two paths.\n\n1.  **Test Path:** The beam propagates a distance $d$ in free space to an object plane. The object is a thin Gaussian aperture with an intensity transmission function given by $T(\\mathbf{r}_o) = \\exp(-|\\mathbf{r}_o|^2/\\sigma_a^2)$, where $\\mathbf{r}_o$ is the transverse coordinate in the object plane and $\\sigma_a$ is the characteristic radius of the aperture. The total transmitted intensity is measured by a bucket detector (a detector that integrates over all transverse spatial coordinates).\n2.  **Reference Path:** The beam propagates a distance $d$ (the same as in the test path) in free space to a high-resolution detector, such as a CCD camera. This detector measures the intensity distribution $I_R(\\mathbf{r}_r)$, where $\\mathbf{r}_r$ is the transverse coordinate in the reference detector plane.\n\nThe ghost image is reconstructed by calculating the correlation of the intensity fluctuations between the two detectors. The image profile is given by $G(\\mathbf{r}_r) = \\langle \\Delta I_T \\Delta I_R(\\mathbf{r}_r) \\rangle$, where $I_T$ is the bucket detector signal, and $\\Delta I = I - \\langle I \\rangle$ represents the intensity fluctuation. For a thermal source, this correlation is proportional to the square modulus of the field cross-correlation, integrated over the object's aperture:\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\, T(\\mathbf{r}_o) \\, \\left| \\langle E_T^*(\\mathbf{r}_o) E_R(\\mathbf{r}_r) \\rangle \\right|^2 $$\nwhere $E_T(\\mathbf{r}_o)$ is the field at the object plane (before the object) and $E_R(\\mathbf{r}_r)$ is the field at the reference detector plane.\n\nThe resulting ghost image profile $G(\\mathbf{r}_r)$ is a Gaussian function of $\\mathbf{r}_r$: $G(\\mathbf{r}_r) \\propto \\exp(-|\\mathbf{r}_r|^2/\\sigma_g^2)$. Derive the squared width, $\\sigma_g^2$, of this reconstructed ghost image.\n\nUse the paraxial approximation for free-space propagation (the Fresnel diffraction integral). The field $E(\\mathbf{r}, z)$ at a distance $z$ from a source plane with field $E_s(\\mathbf{r}')$ is given by:\n$$ E(\\mathbf{r}, z) = \\frac{-ik}{2\\pi z} e^{ikz} \\int d^2\\mathbf{r}' E_s(\\mathbf{r}') \\exp\\left(\\frac{ik}{2z} |\\mathbf{r} - \\mathbf{r}'|^2\\right) $$\nwhere $k$ is the wave number.", "solution": "The profile of the ghost image is given by:\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\, T(\\mathbf{r}_o) \\, \\left| C(\\mathbf{r}_o, \\mathbf{r}_r) \\right|^2 $$\nwhere $T(\\mathbf{r}_o) = \\exp(-|\\mathbf{r}_o|^2/\\sigma_a^2)$ is the object's transmission function and $C(\\mathbf{r}_o, \\mathbf{r}_r) = \\langle E_T^*(\\mathbf{r}_o) E_R(\\mathbf{r}_r) \\rangle$ is the cross-correlation between the field at the object plane and the field at the reference detector plane.\n\n**1. Calculate the Field Cross-Correlation $C(\\mathbf{r}_o, \\mathbf{r}_r)$**\n\nFirst, we express the fields $E_T(\\mathbf{r}_o)$ and $E_R(\\mathbf{r}_r)$ by propagating the source field $E_s$ over a distance $d$ using the given Fresnel diffraction integral:\n$$ C(\\mathbf{r}_o, \\mathbf{r}_r) = \\left\\langle \\left( \\int d^2\\mathbf{r}_1 P^*(\\mathbf{r}_o, \\mathbf{r}_1; d) E_s^*(\\mathbf{r}_1) \\right) \\left( \\int d^2\\mathbf{r}_2 P(\\mathbf{r}_r, \\mathbf{r}_2; d) E_s(\\mathbf{r}_2) \\right) \\right\\rangle $$\nwhere $P(\\mathbf{r}, \\mathbf{r}'; d)$ is the paraxial propagator. Bringing the expectation value inside the integrals acts on the source fields:\n$$ C(\\mathbf{r}_o, \\mathbf{r}_r) = \\iint d^2\\mathbf{r}_1 d^2\\mathbf{r}_2 P^*(\\mathbf{r}_o, \\mathbf{r}_1; d) P(\\mathbf{r}_r, \\mathbf{r}_2; d) \\langle E_s^*(\\mathbf{r}_1) E_s(\\mathbf{r}_2) \\rangle $$\nWe substitute the propagator $P(\\mathbf{r}, \\mathbf{r}'; d) \\propto \\exp\\left(\\frac{ik}{2d}|\\mathbf{r}-\\mathbf{r}'|^2\\right)$ and the given mutual coherence function $\\langle E_s^*(\\mathbf{r}_1) E_s(\\mathbf{r}_2) \\rangle \\propto \\exp\\left(-\\frac{|\\mathbf{r}_1 - \\mathbf{r}_2|^2}{2\\sigma_c^2}\\right)$. After a lengthy but standard calculation involving a change of variables (e.g., $\\mathbf{u} = \\mathbf{r}_1 - \\mathbf{r}_2$ and $\\mathbf{U} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$) and performing the Gaussian integrals, one finds that for a stationary source, the cross-correlation function simplifies significantly. The result is:\n$$ C(\\mathbf{r}_o, \\mathbf{r}_r) \\propto \\exp\\left(-\\frac{|\\mathbf{r}_o-\\mathbf{r}_r|^2}{2\\sigma_c^2}\\right) \\times (\\text{phase factor}) $$\nThe phase factor depends on $|\\mathbf{r}_o|^2$ and $|\\mathbf{r}_r|^2$. When we take the squared modulus, this phase factor disappears:\n$$ |C(\\mathbf{r}_o, \\mathbf{r}_r)|^2 \\propto \\left| \\exp\\left(-\\frac{|\\mathbf{r}_o-\\mathbf{r}_r|^2}{2\\sigma_c^2}\\right) \\right|^2 = \\exp\\left(-\\frac{|\\mathbf{r}_o-\\mathbf{r}_r|^2}{\\sigma_c^2}\\right) $$\n\n**2. Calculate the Ghost Image Profile $G(\\mathbf{r}_r)$**\n\nNow we substitute this result back into the expression for the ghost image profile:\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\exp\\left(-\\frac{|\\mathbf{r}_o|^2}{\\sigma_a^2}\\right) \\exp\\left(-\\frac{|\\mathbf{r}_o - \\mathbf{r}_r|^2}{\\sigma_c^2}\\right) $$\nThis integral is a convolution of two Gaussian functions. The convolution of two Gaussians, $\\exp(-|\\mathbf{r}|^2/W_1^2)$ and $\\exp(-|\\mathbf{r}|^2/W_2^2)$, results in another Gaussian, $\\exp(-|\\mathbf{r}|^2/W_3^2)$, where the squared widths simply add: $W_3^2 = W_1^2 + W_2^2$.\n\nIn our case, the first Gaussian is the object's transmission function with squared width $W_1^2 = \\sigma_a^2$. The second Gaussian is the correlation function with squared width $W_2^2 = \\sigma_c^2$. Therefore, the resulting ghost image profile $G(\\mathbf{r}_r)$ is a Gaussian with a squared width $\\sigma_g^2$ given by:\n$$ \\sigma_g^2 = \\sigma_a^2 + \\sigma_c^2 $$\n\nBy comparing this to the expected form $G(\\mathbf{r}_r) \\propto \\exp(-|\\mathbf{r}_r|^2/\\sigma_g^2)$, we identify the squared width of the ghost image.", "answer": "$$ \\boxed{\\sigma_a^2 + \\sigma_c^2} $$", "id": "718454"}, {"introduction": "While classical light can produce a ghost image, entangled photons offer potential advantages, particularly in low-light regimes where background noise is a significant factor. Realizing these advantages requires overcoming practical challenges like detector noise and accidental coincidences. This practice problem [@problem_id:718391] tasks you with deriving the signal-to-noise ratio ($SNR$) for an entangled-photon ghost imaging system, providing critical insight into the factors that determine the quality and feasibility of a quantum imaging experiment.", "problem": "Consider an entangled-photon ghost imaging system. A source produces pairs of spatially entangled photons (signal and idler) at a total rate of $R_p$. The generated two-photon state exhibits perfect spatial correlation, meaning that if the idler photon is detected at a transverse position $\\vec{\\rho}$, the signal photon is guaranteed to be at the same transverse position $\\vec{\\rho}$.\n\nThe idler photon travels directly to a high-resolution detector, $D_i$, which consists of an array of identical pixels. The idler beam uniformly illuminates an area $A_{beam}$ on this detector. Each pixel has an area of $A_{pix}$ and a dark count rate of $D_i$. The quantum efficiency of the idler detector is $\\eta_i$.\n\nThe signal photon travels to an object and then to a bucket detector, $D_s$, which has no spatial resolution. The signal beam also uniformly illuminates an area $A_{beam}$ on the object plane. The object is a simple binary mask: an opaque screen covering the entire beam area, with a single transmissive aperture of area $A_{obj}$ located within the beam. The bucket detector $D_s$ has a quantum efficiency of $\\eta_s$ and a dark count rate of $D_s$.\n\nA coincidence logic unit records an event if signals from $D_s$ and a specific pixel on $D_i$ arrive within a coincidence time window $\\tau_c$. The image is reconstructed by plotting the number of coincidence counts for each pixel of $D_i$ over a total measurement time $T_{meas}$.\n\nAssume that the number of counts for any process follows Poisson statistics. The signal ($S$) for imaging the aperture is defined as the difference between the average number of coincidence counts for a pixel whose corresponding location on the object is transmissive ($N_{on}$) and the average number for a pixel whose corresponding location is opaque ($N_{off}$). The noise ($N$) is defined as the standard deviation of this difference, $N = \\sqrt{\\mathrm{Var}(N_{on} - N_{off})}$, assuming the \"on\" and \"off\" measurements are statistically independent.\n\nDerive the expression for the signal-to-noise ratio, $SNR = S/N$, for imaging the aperture. Your final answer should be expressed in terms of the given parameters: $R_p, \\eta_s, \\eta_i, D_s, D_i, A_{beam}, A_{obj}, A_{pix}, \\tau_c$, and $T_{meas}$.", "solution": "The derivation proceeds in several steps:\n\n**1. Singles Rates**\nFirst, we determine the single-detector count rates.\nThe rate at the idler detector pixel, $R_i$, is the sum of detected entangled photons and dark counts:\n$$ R_{i} = R_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i} + D_{i} $$\nThe rate at the signal bucket detector, $R_s$, is the sum of detected photons transmitted through the object aperture and dark counts:\n$$ R_{s} = R_{p}\\frac{A_{obj}}{A_{beam}}\\eta_{s} + D_{s} $$\n\n**2. Coincidence Rates**\nNext, we determine the coincidence rates.\nThe true-coincidence rate, $R_t$, for a pixel corresponding to a transmissive part of the object occurs when both photons of an entangled pair are detected. This rate is:\n$$ R_{t} = R_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i}\\eta_{s} $$\nThe accidental-coincidence rate, $R_{acc}$, is due to uncorrelated detection events at the two detectors falling within the coincidence window $\\tau_c$:\n$$ R_{acc} = R_{i}R_{s}\\tau_{c} $$\n\n**3. Mean Coincidence Counts**\nOver the total measurement time $T_{meas}$, the total number of coincidence counts for an \"on\" pixel (transmissive) is the sum of true and accidental coincidences:\n$$ N_{on} = (R_{t} + R_{acc})T_{meas} $$\nFor an \"off\" pixel (opaque), there are no true coincidences, only accidental ones:\n$$ N_{off} = R_{acc}T_{meas} $$\n\n**4. Signal and Noise**\nThe signal is defined as the difference in counts between \"on\" and \"off\" pixels:\n$$ S = N_{on} - N_{off} = R_{t}T_{meas} $$\nThe noise is the standard deviation of this difference. Since the \"on\" and \"off\" measurements are independent Poisson processes, the variances add:\n$$ \\mathrm{Var}(N_{on} - N_{off}) = \\mathrm{Var}(N_{on}) + \\mathrm{Var}(N_{off}) = \\langle N_{on} \\rangle + \\langle N_{off} \\rangle $$\n$$ \\mathrm{Var}(N_{on} - N_{off}) = (R_{t} + R_{acc})T_{meas} + R_{acc}T_{meas} = (R_{t} + 2R_{acc})T_{meas} $$\nThe noise is the square root of the variance:\n$$ N = \\sqrt{(R_{t} + 2R_{acc})T_{meas}} $$\n\n**5. Signal-to-Noise Ratio (SNR)**\nFinally, the SNR is the ratio of the signal to the noise:\n$$ \\mathrm{SNR} = \\frac{S}{N} = \\frac{R_{t}T_{meas}}{\\sqrt{(R_{t} + 2R_{acc})T_{meas}}} = \\frac{R_{t}\\sqrt{T_{meas}}}{\\sqrt{R_{t} + 2R_{acc}}} $$\nSubstituting the full expressions for $R_t$ and $R_{acc}$ gives the final answer.", "answer": "$$\\boxed{\n\\frac{R_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i}\\eta_{s}\\sqrt{T_{meas}}}\n{\\sqrt{\nR_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i}\\eta_{s}\n+2\\bigl(R_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i}+D_{i}\\bigr)\n\\bigl(R_{p}\\frac{A_{obj}}{A_{beam}}\\eta_{s}+D_{s}\\bigr)\\tau_{c}\n}}\n}$$", "id": "718391"}, {"introduction": "Computational Ghost Imaging (CGI) has become the dominant technique by replacing the physical reference beam with a sequence of known, computer-generated patterns. While powerful, this method is not immune to experimental imperfections, which can introduce artifacts into the final image. In this exercise [@problem_id:718477], you will investigate how different types of noise in the detection system can lead to a uniform background bias, demonstrating the crucial role of the differential correlation algorithm in mitigating specific systematic errors.", "problem": "In a computational ghost imaging (CGI) experiment, an object is imaged by correlating a sequence of known, random intensity patterns with the corresponding total intensity measurements from a single-pixel \"bucket\" detector.\n\nConsider a CGI setup with the following characteristics:\n1.  The patterns are displayed on a spatial light modulator (SLM) with a total of $M$ pixels.\n2.  A sequence of $N$ random binary patterns, $\\{P_n(\\vec{\\rho}_k)\\}_{n=1}^N$, is used, where $\\vec{\\rho}_k$ is the position of the $k$-th pixel ($k=1, \\dots, M$).\n3.  For any given pattern $n$ and pixel $k$, the value $P_{n,k} \\equiv P_n(\\vec{\\rho}_k)$ is either $1$ (light on) or $0$ (light off). The patterns are statistically independent from pixel to pixel and from one realization to the next. The probability of any pixel being 'on' is $P(P_{n,k}=1) = p$.\n4.  The object is described by a transmission function $T_k \\equiv T(\\vec{\\rho}_k)$. The light transmitted through the object is collected by the bucket detector.\n5.  The signal measured by the bucket detector for the $n$-th pattern, $I_n$, consists of two parts: a signal proportional to the total transmitted light, and a noise signal.\n    -   The light-induced signal is $I_{s,n} = \\eta \\sum_{k=1}^M P_{n,k} T_k$, where $\\eta$ is the detection efficiency.\n    -   The total noise signal has two components: one from the detector's intrinsic constant dark count level, $D_0$, and an additional pattern-correlated noise component. This correlated noise arises from electronic crosstalk and is proportional to the total number of 'on' pixels in the pattern, given by $\\beta \\sum_{k=1}^M P_{n,k}$, where $\\beta$ is a coupling coefficient.\n    -   The total signal is therefore $I_n = \\eta \\sum_{k=1}^M P_{n,k} T_k + D_0 + \\beta \\sum_{k=1}^M P_{n,k}$.\n6.  The image $G_k$ is reconstructed using the standard differential correlation formula:\n    $$ G_k = \\langle I_n P_{n,k} \\rangle_n - \\langle I_n \\rangle_n \\langle P_{n,k} \\rangle_n $$\n    where $\\langle \\cdot \\rangle_n$ denotes the average over all $N$ patterns.\n\nAssuming the number of patterns $N$ is large enough to replace the sample averages with their statistical expectation values, derive the expression for the background bias, $B$, in the reconstructed image. The background bias is the portion of the reconstructed signal $G_k$ that is spatially uniform and independent of the object's transmission function $T_k$.", "solution": "The reconstructed image for pixel $k$ is given by $G_k = \\langle I_n P_{n,k} \\rangle - \\langle I_n \\rangle \\langle P_{n,k} \\rangle$. We calculate each term using statistical expectation values.\n\nThe bucket signal is $I_n = \\eta\\sum_{j=1}^M P_{n,j}T_j + D_0 + \\beta\\sum_{j=1}^M P_{n,j}$.\nThe statistical properties of the binary patterns are: $\\langle P_{n,k} \\rangle = p$, and $\\langle P_{n,j}P_{n,k} \\rangle = p$ if $j=k$ (since $P^2=P$ for values 0,1), and $\\langle P_{n,j}P_{n,k} \\rangle = p^2$ if $j \\neq k$ (due to independence).\n\n**1. Compute $\\langle I_n P_{n,k} \\rangle$:**\n$$ \\langle I_n P_{n,k} \\rangle = \\left\\langle \\left( \\eta\\sum_{j} P_{n,j}T_j + D_0 + \\beta\\sum_{j} P_{n,j} \\right) P_{n,k} \\right\\rangle $$\n$$ \\langle I_n P_{n,k} \\rangle = \\eta\\sum_{j}T_j\\langle P_{n,j}P_{n,k}\\rangle + D_0\\langle P_{n,k}\\rangle + \\beta\\sum_{j}\\langle P_{n,j}P_{n,k}\\rangle $$\nWe split the summations into $j=k$ and $j \\neq k$:\n$$ \\sum_{j}T_j\\langle P_{n,j}P_{n,k}\\rangle = T_k\\langle P_{n,k}^2 \\rangle + \\sum_{j \\neq k} T_j\\langle P_{n,j}P_{n,k}\\rangle = T_k p + \\left(\\sum_{j \\neq k} T_j\\right) p^2 $$\n$$ \\sum_{j}\\langle P_{n,j}P_{n,k}\\rangle = \\langle P_{n,k}^2 \\rangle + \\sum_{j \\neq k}\\langle P_{n,j}P_{n,k}\\rangle = p + (M-1)p^2 $$\nSubstituting these back gives:\n$$ \\langle I_n P_{n,k} \\rangle = \\eta \\left( pT_k + p^2\\left(\\sum_{j \\neq k} T_j\\right) \\right) + D_0 p + \\beta(p + (M-1)p^2) $$\n\n**2. Compute $\\langle I_n \\rangle \\langle P_{n,k} \\rangle$:**\nFirst, we find the average bucket signal $\\langle I_n \\rangle$:\n$$ \\langle I_n \\rangle = \\left\\langle \\eta\\sum_{j} P_{n,j}T_j + D_0 + \\beta\\sum_{j} P_{n,j} \\right\\rangle = \\eta\\sum_{j} T_j\\langle P_{n,j}\\rangle + D_0 + \\beta\\sum_{j}\\langle P_{n,j}\\rangle $$\n$$ \\langle I_n \\rangle = \\eta p \\sum_j T_j + D_0 + \\beta M p $$\nThen we multiply by $\\langle P_{n,k} \\rangle = p$:\n$$ \\langle I_n \\rangle \\langle P_{n,k} \\rangle = p \\left( \\eta p \\sum_j T_j + D_0 + \\beta M p \\right) = \\eta p^2 \\sum_j T_j + D_0 p + \\beta M p^2 $$\n\n**3. Subtract the terms to find $G_k$:**\n$$ G_k = \\left[ \\eta \\left( pT_k + p^2\\sum_{j \\neq k} T_j \\right) + D_0 p + \\beta(p + (M-1)p^2) \\right] - \\left[ \\eta p^2 \\sum_j T_j + D_0 p + \\beta M p^2 \\right] $$\nLet's simplify by grouping terms.\n- The $D_0$ terms cancel: $D_0 p - D_0 p = 0$.\n- The $\\eta$ terms: $\\eta(pT_k + p^2\\sum_{j \\neq k} T_j - p^2\\sum_j T_j) = \\eta(pT_k - p^2 T_k) = \\eta p(1-p)T_k$. This is the object-dependent signal.\n- The $\\beta$ terms: $\\beta(p + (M-1)p^2 - Mp^2) = \\beta(p + Mp^2 - p^2 - Mp^2) = \\beta p(1-p)$. This is the object-independent background.\n\nCombining these gives the full reconstructed signal:\n$$ G_k = \\eta p(1-p)T_k + \\beta p(1-p) $$\nThe background bias, $B$, is the portion of $G_k$ that is spatially uniform and independent of the object transmission $T_k$. From the expression above, this is:\n$$ B = \\beta p(1-p) $$", "answer": "$$\\boxed{\\beta p(1-p)}$$", "id": "718477"}]}