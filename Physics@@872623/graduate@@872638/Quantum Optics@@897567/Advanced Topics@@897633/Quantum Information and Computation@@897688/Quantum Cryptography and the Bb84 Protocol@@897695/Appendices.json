{"hands_on_practices": [{"introduction": "The security of the BB84 protocol hinges on the fact that an eavesdropper's measurement inevitably disturbs the quantum states, a direct consequence of the no-cloning theorem. This first exercise provides a quantitative foundation for this principle by analyzing the most straightforward eavesdropping strategy: the intercept-resend attack. By calculating the expected Quantum Bit Error Rate (QBER), you will see precisely how such an attack becomes detectable to Alice and Bob, revealing a fundamental vulnerability in any attempt to \"listen in\" on the quantum channel. [@problem_id:715084]", "problem": "In the BB84 protocol for quantum key distribution, Alice sends single photons (qubits) to Bob. She encodes her bits '0' and '1' using one of two randomly chosen bases:\n1.  The rectilinear basis (Z-basis): $\\{|0\\rangle, |1\\rangle\\}$\n2.  The diagonal basis (X-basis): $\\{|+\\rangle, |-\\rangle\\}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$ and $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$.\n\nAn eavesdropper, Eve, conducts an intercept-resend attack. She intercepts every qubit from Alice, measures it in a basis of her choosing, and then sends a new qubit to Bob, prepared in the state she measured. Eve does not know Alice's basis choice for each qubit. Her strategy is to choose her measurement basis probabilistically: she selects the Z-basis with probability $p$ and the X-basis with probability $1-p$.\n\nAfter the transmission, Alice and Bob perform sifting: they communicate over a public channel to compare their basis choices and discard any bits for which they used different bases. The remaining sequence of bits is the sifted key. The Quantum Bit Error Rate (QBER) is the fraction of bits in this sifted key that Bob receives incorrectly.\n\nAssume Alice chooses her basis (Z or X) and her bit value ('0' or '1') with uniform probability for each transmission. Given that Eve's basis-choice probability is $p = 1/3$, derive the expected QBER that Alice and Bob will observe in their sifted key.", "solution": "The Quantum Bit Error Rate (QBER) is calculated on the sifted key, which only contains the bits where Alice and Bob used the same measurement basis. Since Alice chooses her basis uniformly at random, half of the sifted bits will correspond to instances where both used the Z-basis, and the other half will correspond to instances where both used the X-basis. We need to calculate the error rate for each case and then average them.\n\nLet $Q_Z$ be the error rate when both Alice and Bob use the Z-basis.\nLet $Q_X$ be the error rate when both Alice and Bob use the X-basis.\n\n**1. Calculating $Q_Z$ (Alice and Bob use Z-basis)**\n\nWithout loss of generality, assume Alice sends the state $|0\\rangle$.\nEve intercepts this qubit.\n- With probability $p$, Eve chooses the Z-basis. She measures $|0\\rangle$ and correctly identifies the state as $|0\\rangle$ with probability 1. She then sends $|0\\rangle$ to Bob. Bob, using the Z-basis, measures $|0\\rangle$. In this case, no error occurs. The contribution to the error rate is $p \\times 0 = 0$.\n- With probability $1-p$, Eve chooses the X-basis. She measures the state $|0\\rangle$ in the $\\{|+\\rangle, |-\\rangle\\}$ basis. The state can be written as $|0\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle)$.\n    - Eve measures $|+\\rangle$ with probability $|\\langle+|0\\rangle|^2 = 1/2$. She then sends $|+\\rangle$ to Bob.\n    - Eve measures $|-\\rangle$ with probability $|\\langle-|0\\rangle|^2 = 1/2$. She then sends $|-\\rangle$ to Bob.\n\nNow, Bob measures the state he receives from Eve in the Z-basis.\n- If Bob receives $|+\\rangle$, he measures it. The state is $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$. Bob measures $|0\\rangle$ (correct) with probability $1/2$ and $|1\\rangle$ (error) with probability $1/2$.\n- If Bob receives $|-\\rangle$, he measures it. The state is $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$. Bob measures $|0\\rangle$ (correct) with probability $1/2$ and $|1\\rangle$ (error) with probability $1/2$.\n\nThe probability of error, when Eve uses the X-basis, is $1/2$.\nThe total error rate $Q_Z$ is the sum of probabilities of all paths leading to an error:\n$$Q_Z = p \\cdot (0) + (1-p) \\cdot \\left[ \\left(\\frac{1}{2}\\right)_{\\text{Eve measures +}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} + \\left(\\frac{1}{2}\\right)_{\\text{Eve measures -}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} \\right]$$\n$$Q_Z = (1-p) \\left( \\frac{1}{4} + \\frac{1}{4} \\right) = \\frac{1-p}{2}$$\n\n**2. Calculating $Q_X$ (Alice and Bob use X-basis)**\n\nWithout loss of generality, assume Alice sends the state $|+\\rangle$.\nEve intercepts this qubit.\n- With probability $p$, Eve chooses the Z-basis. She measures $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$.\n    - Eve measures $|0\\rangle$ with probability $1/2$ and sends $|0\\rangle$.\n    - Eve measures $|1\\rangle$ with probability $1/2$ and sends $|1\\rangle$.\nBob receives this state and measures in the X-basis.\n- If Bob receives $|0\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle)$, he measures $|+\\rangle$ (correct) with probability $1/2$ and $|-\\rangle$ (error) with probability $1/2$.\n- If Bob receives $|1\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle - |-\\rangle)$, he measures $|+\\rangle$ (correct) with probability $1/2$ and $|-\\rangle$ (error) with probability $1/2$.\nThe probability of an error, if Eve uses the Z-basis, is $1/2$.\n- With probability $1-p$, Eve chooses the X-basis. She measures $|+\\rangle$ correctly, sends $|+\\rangle$ to Bob, who also measures $|+\\rangle$. No error occurs. The contribution to the error rate is $(1-p) \\times 0 = 0$.\n\nThe total error rate $Q_X$ is:\n$$Q_X = p \\cdot \\left[ \\left(\\frac{1}{2}\\right)_{\\text{Eve measures 0}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} + \\left(\\frac{1}{2}\\right)_{\\text{Eve measures 1}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} \\right] + (1-p) \\cdot (0)$$\n$$Q_X = p \\left( \\frac{1}{4} + \\frac{1}{4} \\right) = \\frac{p}{2}$$\n\n**3. Calculating the Total QBER**\n\nSince Alice chooses her basis uniformly, the final sifted key will, on average, contain an equal number of bits from the Z-basis and X-basis agreements. The total QBER is the average of $Q_Z$ and $Q_X$.\n$$QBER = \\frac{1}{2} Q_Z + \\frac{1}{2} Q_X$$\n$$QBER = \\frac{1}{2} \\left( \\frac{1-p}{2} \\right) + \\frac{1}{2} \\left( \\frac{p}{2} \\right) = \\frac{1-p+p}{4} = \\frac{1}{4}$$\n\nInterestingly, the QBER is independent of Eve's basis-choice probability $p$. The problem specifies $p = 1/3$. Substituting this value (or any other) into the final expression does not change the result.\n$$QBER = \\frac{1}{4}$$", "answer": "$$ \\boxed{\\frac{1}{4}} $$", "id": "715084"}, {"introduction": "A sophisticated eavesdropper might employ strategies more advanced than simple interception and immediate measurement. This practice explores a \"coherent attack,\" where Eve uses a CNOT gate to entangle her own quantum system (an ancilla) with the qubit Alice sends to Bob, delaying her measurement until after Alice and Bob's public discussion. Analyzing this scenario will deepen your understanding of the security challenges in QKD and introduce the tools, like the density matrix formalism, needed to evaluate more complex, entanglement-based attacks. [@problem_id:714929]", "problem": "In the context of the BB84 quantum key distribution protocol, an eavesdropper, Eve, seeks to obtain information about the secret key. She implements a generalized CNOT attack by intercepting the qubit sent from Alice to Bob. Eve uses a CNOT gate where the signal qubit acts as the control qubit and her own ancilla qubit acts as the target.\n\nThe four states used in the BB84 protocol are from two mutually unbiased bases:\n1.  The rectilinear (Z) basis: $\\{|0\\rangle, |1\\rangle\\}$\n2.  The diagonal (X) basis: $\\{|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle), |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)\\}$\n\nAlice randomly chooses a basis and a state within that basis to send to Bob. Bob also randomly chooses a basis for his measurement. They later communicate over a classical channel to discard measurements made in mismatched bases, forming a \"sifted key\".\n\nEve's CNOT attack is described by the unitary transformation $U_{CNOT}$ acting on the combined system of the signal qubit (A) and her ancilla (E): $U_{CNOT}|c\\rangle_A |t\\rangle_E = |c\\rangle_A |t \\oplus c\\rangle_E$. For her attack, Eve prepares her ancilla in the general pure state $|\\psi\\rangle_E = \\cos\\theta |0\\rangle_E + \\sin\\theta |1\\rangle_E$, where $\\theta$ is a real parameter controlled by Eve.\n\nAssuming Alice and Bob select their bases with equal probability ($1/2$ for Z-basis, $1/2$ for X-basis), derive the average Quantum Bit Error Rate (QBER), denoted $e_{bit}$, that this attack induces in the sifted key. The QBER is defined as the fraction of bits in the sifted key that Bob receives incorrectly. Express your answer in terms of the parameter $\\theta$.", "solution": "We must calculate the error rate induced by Eve's attack in both the Z-basis and X-basis, and then average them to find the overall QBER in the sifted key.\n\n**1. Relevant equations:**\n*   CNOT action: $U_{CNOT}|c\\rangle_A|t\\rangle_E=|c\\rangle_A|t\\oplus c\\rangle_E$.\n*   Eve’s ancilla: $|\\psi\\rangle_E=\\cos\\theta\\,|0\\rangle_E+\\sin\\theta\\,|1\\rangle_E$.\n*   QBER $e_{bit}$ is the average probability that Bob’s bit differs from Alice’s, considering only the cases where their bases match.\n\n**2. Z-basis case (Alice and Bob both use Z-basis)**\nAlice sends either $|0\\rangle_A$ or $|1\\rangle_A$. Eve applies the CNOT operation.\n*   If Alice sends $|0\\rangle_A$, the joint state is $|0\\rangle_A|\\psi\\rangle_E$. The CNOT acts as the identity since the control is $|0\\rangle$:\n$U_{CNOT} \\left( |0\\rangle_A (\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E) \\right) = |0\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E)$.\nThe signal qubit remains $|0\\rangle_A$. Bob measures $|0\\rangle_A$. No error.\n*   If Alice sends $|1\\rangle_A$, the joint state is $|1\\rangle_A|\\psi\\rangle_E$. The CNOT flips the target qubit:\n$U_{CNOT} \\left( |1\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E) \\right) = |1\\rangle_A(\\cos\\theta|1\\rangle_E+\\sin\\theta|0\\rangle_E)$.\nThe signal qubit remains $|1\\rangle_A$. Bob measures $|1\\rangle_A$. No error.\n\nIn both cases, the signal qubit sent to Bob is unchanged in the Z-basis. Thus, the error rate in the Z-basis is zero:\n$e_Z = 0$.\n\n**3. X-basis case (Alice and Bob both use X-basis)**\nAlice sends either $|+\\rangle_A$ or $|-\\rangle_A$. Let's analyze the case where Alice sends $|+\\rangle_A = \\frac{1}{\\sqrt{2}}(|0\\rangle_A+|1\\rangle_A)$.\nThe initial state is $|\\Psi_{in}\\rangle = |+\\rangle_A |\\psi\\rangle_E = \\frac{1}{\\sqrt{2}}(|0\\rangle_A+|1\\rangle_A)(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E)$.\nAfter Eve's CNOT operation, the state becomes:\n$|\\Psi_{out}\\rangle = \\frac{1}{\\sqrt{2}} \\left[ |0\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E) + |1\\rangle_A(\\cos\\theta|1\\rangle_E+\\sin\\theta|0\\rangle_E) \\right]$\n$|\\Psi_{out}\\rangle = \\frac{1}{\\sqrt{2}} \\left[ \\cos\\theta(|00\\rangle+|11\\rangle) + \\sin\\theta(|01\\rangle+|10\\rangle) \\right]$.\n\nTo find the state Bob receives, we trace out Eve's ancilla to find the reduced density matrix of the signal qubit $\\rho_A$:\n$\\rho_A = \\text{Tr}_E(|\\Psi_{out}\\rangle\\langle\\Psi_{out}|)$.\nA calculation yields:\n$$ \\rho_A = \\frac{1}{2} \\begin{pmatrix} 1 & 2\\cos\\theta\\sin\\theta \\\\ 2\\cos\\theta\\sin\\theta & 1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 & \\sin(2\\theta) \\\\ \\sin(2\\theta) & 1 \\end{pmatrix} = \\frac{1}{2} (I + \\sin(2\\theta)\\sigma_X) $$\nBob measures this state in the X-basis. An error occurs if he measures $|-\\rangle$ when Alice sent $|+\\rangle$. The probability of this is:\n$$ P(\\text{error}) = \\langle - | \\rho_A | - \\rangle = \\text{Tr}(|-\\rangle\\langle-|\\rho_A) $$\n$$ P(\\text{error}) = \\text{Tr}\\left( \\frac{1}{2}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\frac{1}{2}\\begin{pmatrix} 1 & \\sin(2\\theta) \\\\ \\sin(2\\theta) & 1 \\end{pmatrix} \\right) = \\frac{1}{4} \\text{Tr}\\begin{pmatrix} 1-\\sin(2\\theta) & \\sin(2\\theta)-1 \\\\ \\dots & \\dots \\end{pmatrix} $$\n$$ P(\\text{error}) = \\frac{1}{4} (1-\\sin(2\\theta) + 1-\\sin(2\\theta)) = \\frac{2 - 2\\sin(2\\theta)}{4} = \\frac{1-\\sin(2\\theta)}{2} $$\nBy symmetry, the error probability is the same if Alice sends $|-\\rangle$. So, the error rate in the X-basis is:\n$$ e_X = \\frac{1-\\sin(2\\theta)}{2} $$\n\n**4. Average QBER**\nThe sifted key is composed of 50% Z-basis results and 50% X-basis results. The total QBER is the average of the error rates in each basis:\n$$ e_{bit} = \\frac{1}{2}e_Z + \\frac{1}{2}e_X = \\frac{1}{2}(0) + \\frac{1}{2} \\left( \\frac{1-\\sin(2\\theta)}{2} \\right) = \\frac{1-\\sin(2\\theta)}{4} $$", "answer": "$$\\boxed{\\frac{1-\\sin(2\\theta)}{4}}$$", "id": "714929"}, {"introduction": "The presence of errors in the sifted key is not just an indicator of eavesdropping; it is a fundamental aspect of any realistic communication channel, and from a security perspective, all errors must be attributed to a potential eavesdropper. The crucial question then becomes: how much secure key can be distilled in the presence of these errors? This final exercise bridges the gap between physical error analysis and information-theoretic security by having you calculate the secret key rate for a specific noisy channel, connecting the Quantum Bit Error Rate ($e_{bit}$) and Phase Error Rate ($e_{phase}$) to the ultimate performance of the protocol. [@problem_id:714902]", "problem": "In the context of quantum key distribution (QKD), the BB84 protocol is a cornerstone method for establishing a shared secret key between two parties, traditionally named Alice and Bob. Alice prepares qubits in one of four states belonging to two mutually unbiased bases: the Z-basis, $\\{|0\\rangle, |1\\rangle\\}$, or the X-basis, $\\{|+\\rangle, |-\\rangle\\}$. Bob randomly chooses to measure each incoming qubit in either the Z-basis or the X-basis.\n\nThe process of generating a secure key is compromised by noise in the quantum channel connecting Alice and Bob. Consider a specific noisy channel that, with probability $p$, applies a Pauli-Y error ($\\sigma_Y$) to a transmitted qubit, and with probability $1-p$, leaves the qubit unaltered (applies the identity operator $I$).\n\nThe performance and security of the protocol are quantified by two key parameters:\n1.  The Quantum Bit Error Rate ($e_{bit}$), which is the fraction of bits that differ between Alice's and Bob's sifted keys. This is determined by comparing a subset of bits after they have discarded all instances where they used different bases. Due to the symmetry of the protocol, we can calculate $e_{bit}$ by considering the error probability when both Alice and Bob use the Z-basis.\n2.  The Phase Error Rate ($e_{phase}$), which is the error rate that would have been observed in the conjugate basis. For a key established in the Z-basis, $e_{phase}$ is the error rate that would be measured if both parties had used the X-basis.\n\nIn the asymptotic limit (infinitely long keys), a lower bound on the secret key rate $r$ (the fraction of secure key bits per sifted bit) is given by the Devetak-Winter formula, which for the BB84 protocol simplifies to:\n$$r = 1 - H_2(e_{bit}) - H_2(e_{phase})$$\nwhere $H_2(x) = -x \\log_2(x) - (1-x) \\log_2(1-x)$ is the binary Shannon entropy function. A positive secret key rate ($r > 0$) is possible only if the errors are not too high.\n\nThe quantum states and operator are defined as:\n$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, |1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle), |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$\n$\\sigma_Y = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}$\n\nYour task is to derive the secret key rate $r$ for this specific noisy channel. Express your final answer in terms of the error probability $p$ and the binary entropy function $H_2(x)$.", "solution": "To find the secret key rate $r$, we must first calculate the bit error rate ($e_{bit}$) and the phase error rate ($e_{phase}$) for the given Pauli-Y channel.\n\n**1. Calculate the Quantum Bit Error Rate ($e_{bit}$)**\n\nThe bit error rate is the error probability when Alice and Bob both use the Z-basis $\\{|0\\rangle, |1\\rangle\\}$. A channel error occurs with probability $p$, applying the $\\sigma_Y$ operator.\n*   Effect of $\\sigma_Y$ on Z-basis states:\n    *   $\\sigma_Y |0\\rangle = i|1\\rangle$\n    *   $\\sigma_Y |1\\rangle = -i|0\\rangle$\nIf Alice sends $|0\\rangle$, an error transforms it to $i|1\\rangle$. When Bob measures in the Z-basis, he will measure $|1\\rangle$ with probability 1. This is a bit flip.\nSimilarly, if Alice sends $|1\\rangle$, an error transforms it to $-i|0\\rangle$, which Bob measures as $|0\\rangle$. This is also a bit flip.\nAn error in the bit value occurs if and only if the $\\sigma_Y$ error happens. Therefore, the bit error rate is equal to the probability of the error occurring:\n$$e_{bit} = p$$\n\n**2. Calculate the Phase Error Rate ($e_{phase}$)**\n\nThe phase error rate is the error probability that would be measured if Alice and Bob both used the X-basis $\\{|+\\rangle, |-\\rangle\\}$.\n*   Effect of $\\sigma_Y$ on X-basis states:\n    *   $\\sigma_Y |+\\rangle = \\sigma_Y \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) = \\frac{1}{\\sqrt{2}}(i|1\\rangle - i|0\\rangle) = -i \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle) = -i|-\\rangle$\n    *   $\\sigma_Y |-\\rangle = \\sigma_Y \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle) = \\frac{1}{\\sqrt{2}}(i|1\\rangle - (-i|0\\rangle)) = i \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) = i|+\\rangle$\nIf Alice sends $|+\\rangle$, an error transforms it to $-i|-\\rangle$. When Bob measures in the X-basis, he will measure $|-\\rangle$ with probability 1 (the global phase $-i$ is irrelevant). This is a \"phase\" flip.\nSimilarly, if Alice sends $|-\\rangle$, an error transforms it to $i|+\\rangle$, which Bob measures as $|+\\rangle$.\nAn error in the phase value occurs if and only if the $\\sigma_Y$ error happens. Therefore, the phase error rate is also equal to the probability of the error:\n$$e_{phase} = p$$\n\n**3. Calculate the Secret Key Rate ($r$)**\n\nNow we plug these rates into the Devetak-Winter formula for the secret key rate per sifted bit:\n$$r = 1 - H_2(e_{bit}) - H_2(e_{phase})$$\nSubstituting our results:\n$$r = 1 - H_2(p) - H_2(p)$$\n$$r = 1 - 2H_2(p)$$", "answer": "$$\\boxed{1-2H_2(p)}$$", "id": "714902"}]}