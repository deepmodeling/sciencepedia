{"hands_on_practices": [{"introduction": "This first exercise provides a crucial test of your understanding of how cluster states are constructed. By calculating the fidelity loss from a single failed entangling gate, you will explore the structural integrity of the state and the non-local impact of a local error. This practice reinforces the fundamental properties of the Controlled-Z gates that form the backbone of the cluster state. [@problem_id:652622]", "problem": "An $N$-qubit linear cluster state, denoted $|C_N\\rangle$, is a fundamental resource for one-way quantum computing. It can be generated by preparing $N$ qubits in the state $|\\psi_0\\rangle = |+\\rangle^{\\otimes N}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$, and then sequentially applying controlled-phase (CPHASE or CZ) gates to adjacent qubits. The CPHASE gate acting on qubits $i$ and $j$, denoted $CZ_{i,j}$, applies a phase of $-1$ to the state $|11\\rangle_{ij}$ and leaves other computational basis states unchanged. The total unitary operation for generating the ideal state is $U_{ideal} = CZ_{N-1,N} \\circ \\dots \\circ CZ_{2,3} \\circ CZ_{1,2}$, where the gate $CZ_{j,j+1}$ is applied after $CZ_{j-1,j}$. Thus, the ideal linear cluster state is $|\\psi_{ideal}\\rangle = U_{ideal} |\\psi_0\\rangle$.\n\nConsider a scenario where the generation process is faulty. Specifically, one of the CPHASE gates, $CZ_{k,k+1}$ for a given $k \\in \\{1, 2, \\dots, N-1\\}$, fails to be applied. This is equivalent to replacing the $CZ_{k,k+1}$ operation with the identity operator, $I_{k,k+1}$. The resulting faulty state is denoted $|\\psi_{faulty}\\rangle$.\n\nYour task is to derive the fidelity, $F = |\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle|^2$, between the ideal $N$-qubit linear cluster state and the state produced by the faulty process. The final result should be a real number.", "solution": "The problem asks for the fidelity $F = |\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle|^2$ between an ideal $N$-qubit linear cluster state and a faulty version where one CPHASE gate was missed.\n\n1.  **Define the states and unitaries:**\n    The initial state is $|\\psi_0\\rangle = |+\\rangle^{\\otimes N}$.\n    The CPHASE gate is $CZ_{j,j+1}$. It is a Hermitian and unitary operator, so $CZ_{j,j+1}^\\dagger = CZ_{j,j+1}$ and $CZ_{j,j+1}^2 = I$.\n    The ideal unitary is $U_{ideal} = \\left(\\prod_{j=1}^{N-1} CZ_{j,j+1}\\right)$, applied sequentially. Let's write this as $U_{ideal} = U_{N-1} \\circ \\dots \\circ U_1$, where $U_j = CZ_{j,j+1}$.\n    The ideal state is $|\\psi_{ideal}\\rangle = U_{ideal} |\\psi_0\\rangle = U_{N-1} \\cdots U_1 |\\psi_0\\rangle$.\n\n    The faulty process misses the gate $U_k = CZ_{k,k+1}$. The faulty unitary is:\n    $U_{faulty} = U_{N-1} \\cdots U_{k+1} \\cdot I_{k, k+1} \\cdot U_{k-1} \\cdots U_1$.\n    The faulty state is $|\\psi_{faulty}\\rangle = U_{faulty} |\\psi_0\\rangle$.\n\n2.  **Simplify the fidelity expression:**\n    The fidelity is $F = |\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle|^2$.\n    The inner product is $\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle = \\langle \\psi_0 | U_{ideal}^\\dagger U_{faulty} | \\psi_0 \\rangle$.\n    Let's analyze the operator product $U_{ideal}^\\dagger U_{faulty}$.\n    Since each $U_j$ is Hermitian, $U_{ideal}^\\dagger = (U_{N-1} \\cdots U_1)^\\dagger = U_1^\\dagger \\cdots U_{N-1}^\\dagger = U_1 \\cdots U_{N-1}$.\n    So, $U_{ideal}^\\dagger U_{faulty} = (U_1 \\cdots U_{k-1} U_k U_{k+1} \\cdots U_{N-1}) (U_{N-1} \\cdots U_{k+1} I U_{k-1} \\cdots U_1)$.\n    The CPHASE gates $U_j$ and $U_l$ commute if $|j-l| > 1$. However, adjacent gates do not commute. Also, $U_j^2=I$.\n    Let's group the unitaries. Let $U_{>k} = U_{N-1} \\cdots U_{k+1}$ and $U_{<k} = U_{k-1} \\cdots U_1$.\n    $|\\psi_{ideal}\\rangle = U_{>k} U_k U_{<k} |\\psi_0\\rangle$.\n    $|\\psi_{faulty}\\rangle = U_{>k} U_{<k} |\\psi_0\\rangle$.\n    The inner product becomes:\n    $$\n    \\langle \\psi_{ideal} | \\psi_{faulty} \\rangle = \\langle \\psi_0 | (U_{>k} U_k U_{<k})^\\dagger (U_{>k} U_{<k}) | \\psi_0 \\rangle\n    $$\n    $$\n    = \\langle \\psi_0 | U_{<k}^\\dagger U_k^\\dagger U_{>k}^\\dagger U_{>k} U_{<k} | \\psi_0 \\rangle\n    $$\n    Since $U_{>k}$ is unitary, $U_{>k}^\\dagger U_{>k} = I$. Since $U_k$ is Hermitian, $U_k^\\dagger=U_k$.\n    $$\n    \\langle \\psi_{ideal} | \\psi_{faulty} \\rangle = \\langle \\psi_0 | U_{<k}^\\dagger U_k U_{<k} | \\psi_0 \\rangle\n    $$\n    Let's define an intermediate state $|\\phi_k\\rangle = U_{<k} |\\psi_0\\rangle = (CZ_{k-1,k} \\cdots CZ_{1,2}) |+\\rangle^{\\otimes N}$. The inner product is then $\\langle \\phi_k | U_k | \\phi_k \\rangle = \\langle \\phi_k | CZ_{k,k+1} | \\phi_k \\rangle$.\n\n3.  **Analyze the state $|\\phi_k\\rangle$:**\n    The unitary $U_{<k}$ acts only on qubits $1, \\dots, k$. The state of qubits $k+1, \\dots, N$ remains $|+\\rangle$.\n    The state of qubits $1, \\dots, k$ is $(CZ_{k-1,k} \\cdots CZ_{1,2}) |+\\rangle^{\\otimes k}$, which is precisely the definition of a $k$-qubit linear cluster state, $|C_k\\rangle$.\n    So, $|\\phi_k\\rangle = |C_k\\rangle \\otimes |+\\rangle^{\\otimes (N-k)}$.\n\n4.  **Calculate the expectation value:**\n    We need to compute $E = \\langle \\phi_k | CZ_{k,k+1} | \\phi_k \\rangle$. The operator $CZ_{k,k+1}$ acts only on qubits $k$ and $k+1$. The expectation value can be found by tracing over the reduced density matrix of these two qubits, $\\rho_{k,k+1}$.\n    $$\n    E = \\mathrm{Tr}_{k,k+1}(\\rho_{k,k+1} CZ_{k,k+1})\n    $$\n    The state $|\\phi_k\\rangle$ is a product state between the system of qubits $\\{1, \\dots, k\\}$ and the qubit $k+1$. So, the reduced density matrix factorizes: $\\rho_{k,k+1} = \\rho_k \\otimes \\rho_{k+1}$.\n    The state of qubit $k+1$ is $|+\\rangle$, so $\\rho_{k+1} = |+\\rangle\\langle+|$.\n    The state of qubit $k$ is given by its reduced density matrix from $|C_k\\rangle$, i.e., $\\rho_k = \\mathrm{Tr}_{\\{1,\\dots,k-1\\}}(|C_k\\rangle\\langle C_k|)$.\n\n    We must consider two cases based on the structure of $|C_k\\rangle$.\n\n    **Case 1: $k=1$**\n    $U_{<1}$ is an empty product, so it is the identity operator.\n    $|\\phi_1\\rangle = |\\psi_0\\rangle = |+\\rangle^{\\otimes N}$.\n    The relevant two-qubit state is $|++\\rangle_{1,2}$.\n    $E = \\langle ++ |_{1,2} CZ_{1,2} | ++ \\rangle_{1,2}$.\n    We can express $CZ_{1,2} = |0\\rangle\\langle0|\\otimes I + |1\\rangle\\langle1|\\otimes Z$. An equivalent useful form is $CZ_{1,2} = \\frac{1}{2}(I_1\\otimes I_2 + Z_1\\otimes I_2 + I_1\\otimes Z_2 - Z_1\\otimes Z_2)$.\n    The expectation value is:\n    $$\n    E = \\langle + | \\langle + | \\frac{1}{2}(I+Z_1+Z_2-Z_1Z_2) | + \\rangle | + \\rangle = \\frac{1}{2}(\\langle+|I|+\\rangle + \\langle+|Z|+\\rangle + \\langle+|Z|+\\rangle - \\langle+|Z|+\\rangle\\langle+|Z|+\\rangle)\n    $$\n    Since $\\langle+|I|+\\rangle = 1$ and $\\langle+|Z|+\\rangle = 0$, we get:\n    $$\n    E = \\frac{1}{2}(1 + 0 + 0 - 0) = \\frac{1}{2}\n    $$\n\n    **Case 2: $k > 1$**\n    For a linear cluster state $|C_k\\rangle$ with $k>1$, the qubit $k$ is connected to qubit $k-1$. For any qubit in a connected graph state (with more than one qubit), its single-qubit reduced density matrix is the maximally mixed state.\n    Therefore, $\\rho_k = \\frac{1}{2}I_k$.\n    The two-qubit reduced density matrix is $\\rho_{k,k+1} = \\rho_k \\otimes \\rho_{k+1} = (\\frac{1}{2}I_k) \\otimes (|+\\rangle_{k+1}\\langle+|)$.\n    The expectation value is:\n    $$\n    E = \\mathrm{Tr}_{k,k+1} \\left[ \\left(\\frac{1}{2}I_k \\otimes |+\\rangle_{k+1}\\langle+|\\right) \\cdot CZ_{k,k+1} \\right]\n    $$\n    Using the form $CZ_{k,k+1} = |0\\rangle_k\\langle 0| \\otimes I_{k+1} + |1\\rangle_k\\langle 1| \\otimes Z_{k+1}$:\n    $$\n    E = \\frac{1}{2} \\mathrm{Tr}_{k,k+1} \\left[ I_k \\otimes |+\\rangle\\langle+| \\cdot (|0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes Z) \\right]\n    $$\n    $$\n    E = \\frac{1}{2} \\mathrm{Tr}_{k,k+1} \\left[ |0\\rangle_k\\langle 0| \\otimes |+\\rangle_{k+1}\\langle+| + |1\\rangle_k\\langle 1| \\otimes |+\\rangle_{k+1}\\langle+|Z_{k+1} \\right]\n    $$\n    Now, take the trace over each qubit subspace:\n    $$\n    E = \\frac{1}{2} \\left[ \\mathrm{Tr}_k(|0\\rangle\\langle 0|) \\mathrm{Tr}_{k+1}(|+\\rangle\\langle+|) + \\mathrm{Tr}_k(|1\\rangle\\langle 1|) \\mathrm{Tr}_{k+1}(|+\\rangle\\langle+|Z_{k+1}) \\right]\n    $$\n    We know $\\mathrm{Tr}(|i\\rangle\\langle i|) = 1$ and $\\mathrm{Tr}(|+\\rangle\\langle+|) = 1$. The term $\\mathrm{Tr}_{k+1}(|+\\rangle\\langle+|Z_{k+1}) = \\langle +|Z|+\\rangle = 0$.\n    $$\n    E = \\frac{1}{2} [ (1)(1) + (1)(0) ] = \\frac{1}{2}\n    $$\n\n5.  **Final Fidelity Calculation:**\n    In both cases ($k=1$ and $k>1$), the inner product $\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle$ is equal to $E = 1/2$.\n    The fidelity is therefore:\n    $$\n    F = |E|^2 = \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}\n    $$\n    The fidelity is independent of both the number of qubits $N$ and the position $k$ of the failed gate.", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "652622"}, {"introduction": "Building on the structure of cluster states, this problem moves to a primary application: measurement-based quantum teleportation. You will analyze how a simple linear cluster state functions as a \"quantum wire\" and, more importantly, how noise on an intermediate qubit impacts the final fidelity. This exercise offers a practical look at error propagation in the one-way computing model. [@problem_id:652635]", "problem": "In one-way quantum computing, a quantum state can be teleported along a \"quantum wire\" composed of a linear cluster state. Consider a 3-qubit linear wire utilizing qubits labeled 1, 2, and 3.\n\nThe process unfolds as follows:\n1.  A 3-qubit linear cluster state $|\\psi_{cl}\\rangle_{123}$ is prepared. This state is generated by initializing the three qubits in the state $|+\\rangle^{\\otimes 3}$ (where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$) and then applying a Controlled-Z ($CZ$) gate to the pairs (1,2) and (2,3).\n2.  An arbitrary single-qubit state $|\\phi_{in}\\rangle = \\alpha|0\\rangle + \\beta|1\\rangle$ is encoded as the initial state of qubit 1. The full initial state of the system is thus $|\\Psi_0\\rangle = CZ_{23} CZ_{12} (|\\phi_{in}\\rangle_1 \\otimes |+\\rangle_2 \\otimes |+\\rangle_3)$.\n3.  Qubit 1 is measured in the X-basis, $\\{|+\\rangle, |-\\rangle\\}$, yielding classical outcome $s_1 \\in \\{0, 1\\}$.\n4.  After the measurement of qubit 1, the central qubit (qubit 2) is subjected to a depolarizing channel, $\\mathcal{E}_p$. The channel is defined by its action on a single-qubit density matrix $\\rho$: $\\mathcal{E}_p(\\rho) = (1-p)\\rho + p \\frac{I}{2}$, where $p$ is the error probability and $I$ is the $2 \\times 2$ identity matrix.\n5.  Qubit 2 is then measured in the X-basis, yielding classical outcome $s_2 \\in \\{0, 1\\}$.\n6.  Based on the outcomes $s_1$ and $s_2$, a final correction operator $U_{corr} = Z_3^{s_1} X_3^{s_2}$ is applied to qubit 3 to recover the teleported state.\n\nYour task is to derive the average fidelity $F$ of this teleportation process. The average fidelity is defined as $F = \\int d\\psi \\langle\\psi|\\rho_{out}(\\psi)|\\psi\\rangle$, where the integral is over all possible input states $|\\psi\\rangle$ on the Bloch sphere and $\\rho_{out}(\\psi)$ is the final density matrix of qubit 3 when the input is $|\\psi\\rangle$. For this channel, the fidelity is independent of the input state, so you may calculate it for an arbitrary $|\\phi_{in}\\rangle$.\n\nDerive the expression for the average fidelity $F$ as a function of the error probability $p$.", "solution": "1. Cluster-state teleportation yields an identity channel. After measuring qubit 1 in the $X$-basis with outcome $s_1$, and qubit 2 in the $X$-basis with outcome $s_2$, followed by the correction $Z_3^{s_1}X_3^{s_2}$, the overall transformation from qubit 1 to qubit 3 is perfect: \n$$\\rho_{in}\\;\\mapsto\\;\\rho_{3}=\\rho_{in}\\,. $$\n\n2. Inclusion of the depolarizing channel $\\mathcal E_p$ on qubit 2 inserts, in the middle of the perfect teleportation, the map \n$$\\mathcal E_p(\\rho)=(1-p)\\,\\rho+p\\,\\frac{I}{2}\\,. $$ \nSince the two halves of teleportation are ideal, the net channel from qubit 1 to qubit 3 is exactly $\\mathcal E_p$.\n\n3. The fidelity for a pure input $|\\psi\\rangle\\langle\\psi|=\\rho$ under $\\mathcal E_p$ is\n$$\nF(\\psi)=\\langle\\psi|\\mathcal E_p(\\rho)|\\psi\\rangle\n=(1-p)\\langle\\psi|\\rho|\\psi\\rangle+p\\,\\frac{\\langle\\psi|I|\\psi\\rangle}{2}\n=(1-p)+\\frac{p}{2}\n=1-\\frac{p}{2}\\,. \n$$\nThis is independent of $|\\psi\\rangle$, hence the average fidelity is\n$$\nF=1-\\frac{p}{2}\\,. \n$$", "answer": "$$\\boxed{1-\\frac{p}{2}}$$", "id": "652635"}, {"introduction": "This final practice expands our view to the relationship between different types of cluster states. You are tasked with finding the most efficient way to convert one graph state into another, which reveals an elegant underlying principle: transformations between cluster states correspond to simple operations on their associated graphs. This demonstrates the powerful algebraic framework and flexibility inherent in the graph state formalism. [@problem_id:652761]", "problem": "In the field of one-way quantum computing, cluster states serve as a universal resource. A cluster state $|\\psi_G\\rangle$ is associated with a mathematical graph $G=(V, E)$, where the vertices $V$ represent qubits and the edges $E$ represent entanglement operations. To create a cluster state, one typically starts with all $N=|V|$ qubits in the state $|+\\rangle^{\\otimes N}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$, and then applies a Controlled-Z (CZ) gate for every edge in the graph $E$. The $\\text{CZ}_{ij}$ gate is a two-qubit gate that applies a phase of -1 to the state if and only if both qubits $i$ and $j$ are in the state $|1\\rangle$.\n\nThe 4-qubit Greenberger-Horne-Zeilinger (GHZ) state is given by $|\\text{GHZ}_4\\rangle = \\frac{1}{\\sqrt{2}}(|0000\\rangle + |1111\\rangle)$. This state is not, by the above definition, a cluster state. However, it is locally-unitarily equivalent to the cluster state corresponding to a \"star graph\" on 4 qubits. A star graph has one central vertex connected to all other vertices. For the purpose of this problem, you should consider the task of transforming this equivalent star-graph cluster state.\n\nConsider a 4-qubit system. The \"star-graph\" cluster state, $|\\psi_{star}\\rangle$, is defined on a graph where one qubit (e.g., qubit 1) is connected to the other three qubits (2, 3, and 4). The \"square-graph\" cluster state, $|\\psi_{square}\\rangle$, is defined on a graph where the four qubits are arranged in a cycle (e.g., with edges connecting 1-2, 2-3, 3-4, and 4-1).\n\nThe transformation from one cluster state to another on the same set of qubits can be accomplished solely by applying a sequence of CZ gates. Your task is to derive the minimal number of CZ gates required to transform the 4-qubit star-graph cluster state into the 4-qubit square-graph cluster state.", "solution": "Consider two graph states $|\\psi_{star}\\rangle$ and $|\\psi_{square}\\rangle$ on the same vertex set $V=\\{1,2,3,4\\}$.  Applying a CZ gate between qubits $i,j$ toggles the presence of edge $(i,j)$ in the underlying graph.  Thus the minimal CZ sequence corresponds to the symmetric difference of the edge sets.\n\n1. Define the edge sets\n$$\nE_{star}=\\{(1,2),(1,3),(1,4)\\},\\quad\nE_{square}=\\{(1,2),(2,3),(3,4),(4,1)\\}.\n$$\n\n2. Compute their intersection and symmetric difference:\n$$\nE_{star}\\cap E_{square}=\\{(1,2),(1,4)\\},\n$$\n$$\nE_{star}\\triangle E_{square}\n=(E_{star}\\cup E_{square})\\setminus(E_{star}\\cap E_{square})\n=\\{(1,3),(2,3),(3,4)\\}.\n$$\n\n3. The number of CZ gates required equals the size of the symmetric difference:\n$$\n\\bigl|E_{star}\\triangle E_{square}\\bigr|=3.\n$$", "answer": "$$\\boxed{3}$$", "id": "652761"}]}