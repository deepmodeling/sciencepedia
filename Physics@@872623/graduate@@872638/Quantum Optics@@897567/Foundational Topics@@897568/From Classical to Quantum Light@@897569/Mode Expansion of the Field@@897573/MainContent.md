## Introduction
The [quantization of the electromagnetic field](@entry_id:155376) is a foundational pillar of modern physics, bridging classical electromagnetism with quantum mechanics and giving birth to the field of quantum optics. At the heart of this process lies a powerful mathematical and conceptual framework known as **mode expansion**. This technique addresses the challenge of quantizing a continuous field by decomposing it into a discrete, infinite set of independent [normal modes](@entry_id:139640), providing a clear and rigorous path to understanding the particle-like nature of light.

This article provides a comprehensive exploration of the mode expansion of the field. It begins by establishing the core principles, then demonstrates their application in a wide range of physical contexts, and finally offers hands-on exercises to solidify understanding. The first chapter, **"Principles and Mechanisms"**, lays the theoretical groundwork, showing how each field mode can be treated as a quantum harmonic oscillator and how this leads to the concepts of photons, creation/[annihilation operators](@entry_id:180957), and the celebrated zero-point energy. The second chapter, **"Applications and Interdisciplinary Connections"**, showcases the versatility of the mode expansion formalism by applying it to solve real-world problems in photonics, [condensed matter](@entry_id:747660) physics, and even cosmology. Finally, the **"Hands-On Practices"** section provides a set of targeted problems designed to connect the abstract theory to measurable [physical quantities](@entry_id:177395), allowing you to put these powerful concepts to work.

## Principles and Mechanisms

The [quantization of the electromagnetic field](@entry_id:155376) is a cornerstone of modern physics, providing the theoretical foundation for [quantum optics](@entry_id:140582) and describing the particle-like nature of light. The central strategy of this quantization, known as [canonical quantization](@entry_id:148501), is to decompose the classical field into a set of independent [normal modes](@entry_id:139640). Upon quantization, each of these modes is shown to behave identically to a [quantum harmonic oscillator](@entry_id:140678). The discrete energy levels of these oscillators give rise to the concept of the **photon**, the fundamental quantum of the electromagnetic field. This chapter elucidates the principles and mechanisms of this **mode expansion**, demonstrating how the [field operators](@entry_id:140269) and the Hamiltonian are constructed and how this formalism is applied to various physical systems.

### The Field as a Collection of Harmonic Oscillators

The most profound insight of [field quantization](@entry_id:160906) is the mathematical equivalence between a normal mode of the electromagnetic field and a single quantum harmonic oscillator (QHO). The state of the entire field can be described by specifying the excitation level of each of its constituent oscillators. The total energy of the field is the sum of the energies of these independent oscillators.

This insight is formally expressed in the structure of the field Hamiltonian, $\hat{H}$. For a field decomposed into modes indexed by a [wavevector](@entry_id:178620) $\mathbf{k}$ and a polarization state $s$, the Hamiltonian takes the [canonical form](@entry_id:140237):
$$ \hat{H} = \sum_{\mathbf{k},s} \hbar \omega_k \left(\hat{a}_{\mathbf{k},s}^\dagger \hat{a}_{\mathbf{k},s} + \frac{1}{2}\right) $$
Here, $\omega_k$ is the angular frequency of the mode. The operators $\hat{a}_{\mathbf{k},s}$ and $\hat{a}_{\mathbf{k},s}^\dagger$ are the **[annihilation](@entry_id:159364)** and **[creation operators](@entry_id:191512)**, respectively, for the mode $(\mathbf{k},s)$. They are analogous to the [ladder operators](@entry_id:156006) of the QHO and obey the bosonic commutation relation $[\hat{a}_{\mathbf{k},s}, \hat{a}_{\mathbf{k}',s'}^\dagger] = \delta_{\mathbf{k}\mathbf{k}'}\delta_{ss'}$.

The operator $\hat{N}_{\mathbf{k},s} = \hat{a}_{\mathbf{k},s}^\dagger \hat{a}_{\mathbf{k},s}$ is the **[number operator](@entry_id:153568)**; its eigenvalues are integers $n_{\mathbf{k},s} = 0, 1, 2, \dots$, which represent the number of [energy quanta](@entry_id:145536) in that mode. These quanta are what we identify as **photons**. A state of the field is specified by the set of [occupation numbers](@entry_id:155861) for all modes, a representation known as a **Fock state** or [number state](@entry_id:180241).

### Quantization in Free Space: The Plane-Wave Basis

To see how the canonical Hamiltonian arises from first principles, we perform the [quantization of the electromagnetic field](@entry_id:155376) in a source-free region of space. We begin with the classical expression for the total energy of the field within a large quantization volume $V$:
$$ H = \int_V \left( \frac{\mathbf{D} \cdot \mathbf{E}}{2} + \frac{\mathbf{B} \cdot \mathbf{H}}{2} \right) d^3r $$
In a simple linear, isotropic, and non-[dispersive medium](@entry_id:180771) with permittivity $\epsilon$ and permeability $\mu_0$ (corresponding to a refractive index $n = \sqrt{\epsilon/\epsilon_0}$), this becomes $H = \int_V (\frac{\epsilon}{2} |\mathbf{E}|^2 + \frac{1}{2\mu_0} |\mathbf{B}|^2) d^3r$.

The quantization procedure involves promoting the fields $\mathbf{E}$ and $\mathbf{B}$ to operators. This is most conveniently done through the [vector potential](@entry_id:153642) $\mathbf{A}$. In the **Coulomb gauge** ($\nabla \cdot \mathbf{A} = 0$), the [scalar potential](@entry_id:276177) is zero, and the fields are given by $\mathbf{E} = -\frac{\partial \mathbf{A}}{\partial t}$ and $\mathbf{B} = \nabla \times \mathbf{A}$. We expand the vector potential operator $\hat{\mathbf{A}}(\mathbf{r})$ in terms of plane-wave modes, which are the normal modes for a cubic volume $V$ with [periodic boundary conditions](@entry_id:147809):
$$ \hat{\mathbf{A}}(\mathbf{r}) = \sum_{\mathbf{k},\lambda} C_k \left[ \mathbf{e}_{\mathbf{k},\lambda} \hat{a}_{\mathbf{k},\lambda} e^{i\mathbf{k}\cdot\mathbf{r}} + \mathbf{e}^*_{\mathbf{k},\lambda} \hat{a}^\dagger_{\mathbf{k},\lambda} e^{-i\mathbf{k}\cdot\mathbf{r}} \right] $$
Here, $\lambda \in \{1, 2\}$ labels the two transverse polarizations, $\mathbf{e}_{\mathbf{k},\lambda}$ are the polarization unit vectors, and $C_k$ is a normalization constant that we must determine.

The central task is to choose $C_k$ such that substituting the resulting [field operators](@entry_id:140269) $\hat{\mathbf{E}}$ and $\hat{\mathbf{B}}$ into the [energy integral](@entry_id:166228) yields the canonical QHO Hamiltonian [@problem_id:694043]. The electric and magnetic [field operators](@entry_id:140269) are found by applying the classical relations to $\hat{\mathbf{A}}$. For example, [the electric field operator](@entry_id:196320) is:
$$ \hat{\mathbf{E}}(\mathbf{r}) = \sum_{\mathbf{k},\lambda} i \omega_k C_k \left[ \mathbf{e}_{\mathbf{k},\lambda} \hat{a}_{\mathbf{k},\lambda} e^{i\mathbf{k}\cdot\mathbf{r}} - \mathbf{e}^*_{\mathbf{k},\lambda} \hat{a}^\dagger_{\mathbf{k},\lambda} e^{-i\mathbf{k}\cdot\mathbf{r}} \right] $$
A similar expression is found for $\hat{\mathbf{B}} = \nabla \times \hat{\mathbf{A}}$. When these are substituted into the Hamiltonian integral, the orthogonality of the [plane waves](@entry_id:189798), $\int_V e^{i(\mathbf{k}-\mathbf{k}')\cdot\mathbf{r}} d^3r = V \delta_{\mathbf{k}\mathbf{k}'}$, eliminates cross-terms between different modes. The calculation reveals that the total energy is the sum of contributions from each mode, and that for each mode, the electric and [magnetic energy](@entry_id:265074) contributions are equal. This is a manifestation of the **equipartition of energy** in electromagnetic waves.

By comparing the resulting expression with the target Hamiltonian form, we can solve for the normalization constant $C_k$. For a medium with refractive index $n$ and [permittivity](@entry_id:268350) $\epsilon = \epsilon_0 n^2$, the result is:
$$ C_k = \sqrt{\frac{\hbar}{2V \epsilon_0 n^2 \omega_k}} $$
With this normalization, the [field operators](@entry_id:140269) are fully defined. For instance, in free space ($n=1$), [the electric field operator](@entry_id:196320) is:
$$ \hat{\mathbf{E}}(\mathbf{r}) = i \sum_{\mathbf{k}, \lambda} \sqrt{\frac{\hbar \omega_{\mathbf{k}}}{2 \epsilon_0 V}} \left( \hat{a}_{\mathbf{k}, \lambda} \mathbf{e}_{\mathbf{k}, \lambda} e^{i \mathbf{k} \cdot \mathbf{r}} - \hat{a}^\dagger_{\mathbf{k}, \lambda} \mathbf{e}_{\mathbf{k}, \lambda}^* e^{-i \mathbf{k} \cdot \mathbf{r}} \right) $$

### The Vacuum and Zero-Point Energy

The ground state of the quantized field is the **vacuum state** $|0\rangle$, defined as the state containing no photons. It is the eigenstate of all [annihilation operators](@entry_id:180957) with eigenvalue zero: $\hat{a}_{\mathbf{k},s} |0\rangle = 0$ for all modes. A remarkable consequence of the QHO formalism is that the energy of this vacuum state is not zero. The expectation value of the Hamiltonian in the vacuum is:
$$ E_0 = \langle 0 | \hat{H} | 0 \rangle = \left\langle 0 \left| \sum_{\mathbf{k},s} \hbar \omega_k \left(\hat{a}_{\mathbf{k},s}^\dagger \hat{a}_{\mathbf{k},s} + \frac{1}{2}\right) \right| 0 \right\rangle = \sum_{\mathbf{k},s} \frac{1}{2}\hbar\omega_k $$
This is the **zero-point energy** of the field. Since the sum is over an infinite number of modes, the total zero-point energy is infinite. This divergence signals that our model is incomplete at very high energies (very short length scales), but the concept of [zero-point energy](@entry_id:142176) has real, measurable consequences, such as the Casimir effect and the Lamb shift.

While the total energy is infinite, we can calculate a finite zero-point [spectral energy density](@entry_id:168013). To do this, we take the [continuum limit](@entry_id:162780), where the sum over discrete modes is replaced by an integral over wavevector space: $\frac{1}{V}\sum_\mathbf{k} \to \int \frac{d^3k}{(2\pi)^3}$. The vacuum energy density $\langle \mathcal{H} \rangle_0 = E_0/V$ becomes:
$$ \langle \mathcal{H} \rangle_0 = \int \frac{d^3k}{(2\pi)^3} \cdot 2 \cdot \frac{1}{2}\hbar\omega_k = \frac{\hbar}{(2\pi)^3} \int_0^\infty (4\pi k^2) (ck) dk = \frac{\hbar c}{2\pi^2} \int_0^\infty k^3 dk $$
This integral is clearly divergent, a problem often called the "ultraviolet catastrophe" of the vacuum. To manage this, one can introduce a sharp high-frequency cutoff $\Omega_c$, integrating only up to $k_{\max} = \Omega_c/c$ [@problem_id:693835]. This regularization procedure yields a finite vacuum energy density:
$$ \langle \mathcal{H} \rangle_0^{\text{reg}} = \frac{\hbar c}{2\pi^2} \frac{k_{\max}^4}{4} = \frac{\hbar \Omega_c^4}{8\pi^2 c^3} $$
This result shows that the [vacuum energy](@entry_id:155067) density scales with the fourth power of the frequency cutoff.

The [zero-point energy](@entry_id:142176) density depends on the properties of the medium. For a general linear medium with [permittivity](@entry_id:268350) $\epsilon$ and permeability $\mu$, the [dispersion relation](@entry_id:138513) is $\omega_k = k/\sqrt{\epsilon\mu}$. Following a similar procedure, one can find the zero-point [spectral energy density](@entry_id:168013) (energy per unit volume per unit angular frequency) [@problem_id:694006]:
$$ \frac{dU_{ZPE}}{d\omega} = \frac{\hbar(\epsilon\mu)^{3/2}}{2\pi^2}\,\omega^3 $$
This $\omega^3$ dependence is a fundamental feature of the three-dimensional vacuum.

### Field Dynamics and Commutation Relations

The consistency of the quantization scheme can be verified by examining the dynamics of the [field operators](@entry_id:140269) in the Heisenberg picture. The [equation of motion](@entry_id:264286) for any operator $\hat{O}$ is given by $i\hbar \frac{d\hat{O}}{dt} = [\hat{O}, \hat{H}]$. Let us consider the dynamics of the [vector potential](@entry_id:153642) operator $\hat{\mathbf{A}}$. To do so, it is useful to express the Hamiltonian in terms of $\hat{\mathbf{A}}$ and its canonical momentum $\hat{\mathbf{\Pi}} = -\epsilon_0 \hat{\mathbf{E}}_{\perp}$, where $\hat{\mathbf{E}}_{\perp}$ is the transverse electric field. The fundamental commutation relation is $[A_i(\mathbf{r}), \Pi_j(\mathbf{r}')] = i\hbar \delta_{ij}^{\perp}(\mathbf{r}-\mathbf{r}')$, where $\delta_{ij}^{\perp}$ is the transverse [delta function](@entry_id:273429).

We can compute the commutator of the Hamiltonian with the [vector potential](@entry_id:153642) operator [@problem_id:694017]. The only part of the Hamiltonian that does not commute with $\hat{\mathbf{A}}$ is the term involving $\hat{\mathbf{\Pi}}^2$:
$$ [\hat{H}, \hat{A}_i(\mathbf{r}_0)] = \left[ \int d^3r' \frac{1}{2\epsilon_0} \sum_j \hat{\Pi}_j(r')^2, \hat{A}_i(\mathbf{r}_0) \right] = \frac{1}{2\epsilon_0} \int d^3r' \sum_j [\hat{\Pi}_j(r')^2, \hat{A}_i(\mathbf{r}_0)] $$
Using the identity $[B^2, A] = B[B,A] + [B,A]B$ and the fundamental commutator, the result simplifies to:
$$ [\hat{H}, \hat{\mathbf{A}}(\mathbf{r}_0)] = -i\frac{\hbar}{\epsilon_0} \hat{\mathbf{\Pi}}(\mathbf{r}_0) = i\hbar \hat{\mathbf{E}}_{\perp}(\mathbf{r}_0) $$
Inserting this into Heisenberg's equation of motion gives $\frac{d\hat{\mathbf{A}}}{dt} = \frac{1}{i\hbar}(i\hbar \hat{\mathbf{E}}_{\perp}) = \hat{\mathbf{E}}_{\perp}$. Recalling that in the Coulomb gauge $\hat{\mathbf{E}} = -\frac{\partial \hat{\mathbf{A}}}{\partial t}$ and $\hat{\mathbf{E}}_{\perp} = \hat{\mathbf{E}}$, this result confirms that the quantum dynamics are consistent with Maxwell's equations.

The [field operators](@entry_id:140269) themselves have non-trivial equal-time commutation relations. For example, for a one-dimensional field propagating along the z-axis, the commutator between the transverse electric and magnetic field components can be calculated by substituting their mode expansions and using the bosonic commutation relations for the operators $\hat{a}_{k,\lambda}$ [@problem_id:693973]. The calculation is intricate and involves an integral representation of the derivative of the Dirac delta function, yielding:
$$ [\hat{E}_x(z), \hat{B}_y(z')] = -\frac{i\hbar}{\mathcal{A} \epsilon_0} \delta'(z-z') $$
where $\mathcal{A}$ is the transverse mode area. This result demonstrates that [field operators](@entry_id:140269) at different spatial points do not, in general, commute. This locality property is a hallmark of quantum field theory and is deeply connected to causality.

### Mode Expansion in Bounded Geometries

While plane waves are convenient for describing fields in free space, many practical applications in quantum optics involve fields confined within structures like resonant cavities or waveguides. In such cases, the field must be expanded in a basis of mode functions that satisfy the specific boundary conditions imposed by the structure.

Consider a perfectly conducting rectangular cavity with dimensions $a, b, L$. The electromagnetic field is zero inside the conductors, so the mode functions must vanish at the boundaries. This leads to standing wave solutions. For Transverse Electric (TE) modes, the mode functions $\mathbf{u}_{mnp}(\mathbf{r})$ are composed of sines and cosines. The [field operators](@entry_id:140269) are expanded in terms of these modes, with each mode $(m,n,p)$ having its own [creation and annihilation operators](@entry_id:147121), $\hat{a}_{mnp}^\dagger$ and $\hat{a}_{mnp}$.

This formalism allows us to ask very concrete questions about the nature of photons. For example, what is the measurable effect of adding a single photon to a cavity? We can answer this by calculating the change in the expectation value of the squared electric field, $\Delta E^2 = \langle 1 | \hat{\mathbf{E}}(\mathbf{r}_0)^2 | 1 \rangle - \langle 0 | \hat{\mathbf{E}}(\mathbf{r}_0)^2 | 0 \rangle$, at a point $\mathbf{r}_0$ in the cavity [@problem_id:694039]. For the vacuum state, $\langle 0 | \hat{\mathbf{E}}(\mathbf{r}_0)^2 | 0 \rangle$ is non-zero, representing the contribution from vacuum fluctuations of all modes. For a single-photon state, say in the TE$_{121}$ mode, the expectation value $\langle 1_{121} | \hat{\mathbf{E}}(\mathbf{r}_0)^2 | 1_{121} \rangle$ is larger. The calculation shows that the change $\Delta E^2$ is directly proportional to $\hbar\omega_{121}$ and the squared value of the mode function $|\mathbf{u}_{121}(\mathbf{r}_0)|^2$. This explicitly connects the abstract notion of a photon to a tangible increase in the field fluctuations within the spatial profile of its corresponding mode.

The general procedure for quantizing fields in bounded geometries remains the same: identify a complete, orthogonal set of mode functions that satisfy the boundary conditions, and normalize them such that the Hamiltonian takes the canonical QHO form. This has been demonstrated for [plane waves](@entry_id:189798) in a box, TE modes in a rectangular cavity, and can be extended to other systems like the Transverse-Magnetic (TM) modes in a parallel-plate waveguide [@problem_id:694070].

### Polarization: An Internal Degree of Freedom

In addition to its energy and momentum, specified by the mode index $\mathbf{k}$, a photon possesses an internal degree of freedom: **polarization**. For each wavevector $\mathbf{k}$, there are two orthogonal [polarization states](@entry_id:175130), indexed by $\lambda=1,2$. These can be chosen as a linear basis (e.g., horizontal and vertical) or a circular basis (right- and left-handed helicity).

A single photon's polarization state is described by a vector in a two-dimensional Hilbert space. For a photon propagating along the $z$-axis, the linear [basis states](@entry_id:152463) are $|1_x\rangle$ and $|1_y\rangle$, while the circular [basis states](@entry_id:152463) are $|1_+\rangle$ (right-circularly polarized, RHC) and $|1_-\rangle$ (left-circularly polarized, LHC). They are related by:
$$ |1_x\rangle = \frac{1}{\sqrt{2}} (|1_+\rangle + |1_-\rangle) \quad \text{and} \quad |1_y\rangle = \frac{i}{\sqrt{2}} ( |1_-\rangle - |1_+\rangle) $$
The [helicity](@entry_id:157633) of a photon, which is the projection of its spin onto its direction of motion, is a physical observable represented by the operator $\hat{S}_z$. The circular polarization states are its [eigenstates](@entry_id:149904): $\hat{S}_z |1_\pm\rangle = \pm\hbar |1_\pm\rangle$.

Quantum superposition allows for states that are combinations of these [basis states](@entry_id:152463). For instance, consider a single-photon state that is a superposition of an x-polarized state and a right-circularly polarized state, $|\tilde{\psi}\rangle = |1_x\rangle + i \gamma |1_+\rangle$, where $\gamma$ is a real constant [@problem_id:693949]. To find the [expectation value](@entry_id:150961) of its helicity, we first express the state in the helicity basis and normalize it. The normalized state is $|{\psi}\rangle = \frac{1}{\sqrt{1+\gamma^2}} [ (\frac{1}{\sqrt{2}} + i \gamma) |1_+\rangle + \frac{1}{\sqrt{2}} |1_-\rangle ]$. The expectation value of the helicity operator is then found to be:
$$ \langle\hat{S}_z\rangle = \langle\psi|\hat{S}_z|\psi\rangle = \frac{\hbar \gamma^2}{1+\gamma^2} $$
This calculation exemplifies how the principles of quantum mechanics apply directly to the polarization properties of individual photons.

### Connection to Beam Optics: The Paraxial Approximation

The [plane-wave basis](@entry_id:140187) is mathematically convenient but does not directly represent a spatially localized laser beam. Such beams are better described within the **[paraxial approximation](@entry_id:177930)**. For a beam propagating predominantly along the $z$-axis, the transverse components of its [wavevector](@entry_id:178620), $\mathbf{k}_T = (k_x, k_y)$, are much smaller than the longitudinal component, $k_z$. The exact dispersion relation $k_z = \sqrt{k^2 - |\mathbf{k}_T|^2}$ can be Taylor expanded for small $|\mathbf{k}_T|$:
$$ k_z(\mathbf{k}_T) \approx k\left(1 - \frac{|\mathbf{k}_T|^2}{2k^2} - \frac{|\mathbf{k}_T|^4}{8k^4} - \dots \right) = k - \frac{|\mathbf{k}_T|^2}{2k} - \frac{|\mathbf{k}_T|^4}{8k^3} - \dots $$
The [paraxial approximation](@entry_id:177930) consists of keeping only the first two terms. The second term, proportional to $|\mathbf{k}_T|^2$, is responsible for diffraction and is the basis of the [paraxial wave equation](@entry_id:171182). The next term, proportional to $|\mathbf{k}_T|^4$, represents the first **non-paraxial correction**.

The magnitude of this correction can be estimated for a realistic beam, such as a Gaussian beam with waist radius $w_0$. By averaging the correction term $\Delta k_{z,\text{np}} = -|\mathbf{k}_T|^4 / (8k^3)$ over the transverse [spatial frequency](@entry_id:270500) power spectrum of the Gaussian beam, one finds the average correction to be $\langle \Delta k_{z,\text{np}} \rangle = -1/(k^3w_0^4)$ [@problem_id:693868]. This shows that non-paraxial effects become more significant for tightly focused beams (small $w_0$) and shorter wavelengths (large $k$).

Within the paraxial regime, it is often more useful to expand the field in a basis of [transverse modes](@entry_id:163265) that retain their shape upon propagation, such as Hermite-Gaussian or Laguerre-Gaussian modes. The paraxial Hamiltonian can be transformed from the [plane-wave basis](@entry_id:140187) to, for instance, the Hermite-Gaussian basis. An interesting feature arises from this transformation: the Hamiltonian is not perfectly diagonal in this new basis [@problem_id:693901]. For instance, the matrix element coupling the fundamental Gaussian mode $(n=0, m=0)$ to the higher-order mode $(n=2, m=0)$ is non-zero:
$$ H_{00,20}^{(k_z)} = \langle b_{00} | \hat{H} | b_{20} \rangle = -\frac{\hbar c}{2\sqrt{2}\,k_z\,w_0^2} $$
This off-diagonal coupling, arising from the $|\mathbf{k}_T|^2$ term in the Hamiltonian, governs the evolution of the beam's transverse profile as it propagates, giving rise to phenomena like the Gouy phase shift. The mode expansion formalism, therefore, not only provides the foundation for understanding photons but also offers a powerful and versatile framework for analyzing the propagation of classical and quantum states of light in a wide array of physical scenarios.