{"hands_on_practices": [{"introduction": "To understand the potential geo-effectiveness of a Coronal Mass Ejection (CME), we must first model its evolution as it propagates from the Sun. This practice explores how the magnetic field strength within a CME, modeled as an expanding toroidal flux rope, changes over vast distances. By applying the principle of magnetic flux conservation within the ideal Magnetohydrodynamics (MHD) framework, you will derive a crucial scaling law that links the CME's expansion geometry to the decay of its internal magnetic field, a key parameter for space weather prediction.", "problem": "A Coronal Mass Ejection (CME) can be modeled as an expanding, ideal magnetohydrodynamic (MHD) flux rope with a toroidal geometry. The flux rope is characterized by a time-dependent major radius $R_c(t)$ (distance from the Sun's center to the geometric center of the torus cross-section) and a time-dependent minor radius $a(t)$.\n\nWithin this model, the toroidal magnetic field component $B_t$ at a cylindrical distance $r_{cyl}$ from the main axis of the torus is given by\n$$B_t(r_{cyl}, t) = B_{t,c}(t) \\frac{R_c(t)}{r_{cyl}}$$\nwhere $B_{t,c}(t)$ is the toroidal field strength at the center of the torus cross-section (where $r_{cyl} = R_c(t)$).\n\nAs the CME propagates outwards, the flux rope expands. Observations suggest that the expansion is not necessarily self-similar. Assume the minor radius evolves with the major radius according to the power law\n$$a(t) = k R_c(t)^\\beta$$\nwhere $k$ is a constant and $\\beta$ is a scaling index, with $0  \\beta  1$.\n\nIn ideal MHD, the total toroidal magnetic flux $\\Psi_t$ passing through the minor cross-section of the torus is conserved. In the asymptotic limit of large expansion, where $R_c(t) \\gg a(t)$, the central toroidal field is expected to follow a power law of the form $B_{t,c}(t) \\propto R_c(t)^{-\\eta}$.\n\nDerive an expression for the scaling index $\\eta$ in terms of the parameter $\\beta$.\n\nYou may find the following definite integral useful:\n$$ \\int_0^{2\\pi} \\frac{d\\theta}{A + B \\cos\\theta} = \\frac{2\\pi}{\\sqrt{A^2 - B^2}} \\quad \\text{for} \\quad A  |B| $$", "solution": "The problem asks for the scaling index $\\eta$ in the relation $B_{t,c}(t) \\propto R_c(t)^{-\\eta}$ for an expanding toroidal CME flux rope. The derivation is based on the conservation of toroidal magnetic flux $\\Psi_t$.\n\n**Step 1: Express the toroidal magnetic flux $\\Psi_t$.**\n\nThe toroidal magnetic flux is the integral of the toroidal magnetic field $B_t$ over the circular cross-section of the torus, which has area $A = \\pi a^2$. We use local polar coordinates $(\\rho, \\theta)$ centered on the axis of the minor cross-section, such that a point in the cross-section has a cylindrical distance from the main torus axis of $r_{cyl} = R_c + \\rho \\cos\\theta$. The area element is $dA = \\rho \\, d\\rho \\, d\\theta$.\n\nThe flux $\\Psi_t$ is given by:\n$$ \\Psi_t = \\iint_A B_t \\, dA = \\int_0^a \\int_0^{2\\pi} B_t(r_{cyl}(\\rho, \\theta), t) \\, \\rho \\, d\\rho \\, d\\theta $$\n\nSubstituting the given expression for $B_t$:\n$$ \\Psi_t = \\int_0^a \\int_0^{2\\pi} \\left( B_{t,c}(t) \\frac{R_c(t)}{R_c(t) + \\rho \\cos\\theta} \\right) \\rho \\, d\\rho \\, d\\theta $$\n\nFor simplicity, we will drop the explicit time dependence, as the integration is at a fixed instant in time.\n$$ \\Psi_t = B_{t,c} R_c \\int_0^a \\rho \\left( \\int_0^{2\\pi} \\frac{d\\theta}{R_c + \\rho \\cos\\theta} \\right) d\\rho $$\n\n**Step 2: Evaluate the integral.**\n\nFirst, we solve the inner integral over $\\theta$ using the provided formula with $A=R_c$ and $B=\\rho$. Since $\\rho \\le a$ and we are in the regime $R_c \\gg a$, the condition $A|B|$ is satisfied.\n$$ \\int_0^{2\\pi} \\frac{d\\theta}{R_c + \\rho \\cos\\theta} = \\frac{2\\pi}{\\sqrt{R_c^2 - \\rho^2}} $$\n\nNow, substitute this result back into the expression for $\\Psi_t$:\n$$ \\Psi_t = B_{t,c} R_c \\int_0^a \\rho \\left( \\frac{2\\pi}{\\sqrt{R_c^2 - \\rho^2}} \\right) d\\rho = 2\\pi B_{t,c} R_c \\int_0^a \\frac{\\rho}{\\sqrt{R_c^2 - \\rho^2}} d\\rho $$\n\nNext, we evaluate the integral over $\\rho$. Let $u = R_c^2 - \\rho^2$. Then $du = -2\\rho \\, d\\rho$, so $\\rho \\, d\\rho = -du/2$. The integration limits change from $\\rho=0 \\to u=R_c^2$ and $\\rho=a \\to u=R_c^2-a^2$.\n$$ \\int_0^a \\frac{\\rho}{\\sqrt{R_c^2 - \\rho^2}} d\\rho = \\int_{R_c^2}^{R_c^2-a^2} \\frac{-du/2}{\\sqrt{u}} = -\\frac{1}{2} \\left[ 2\\sqrt{u} \\right]_{R_c^2}^{R_c^2-a^2} = -\\left[ \\sqrt{u} \\right]_{R_c^2}^{R_c^2-a^2} $$\n$$ = -(\\sqrt{R_c^2 - a^2} - \\sqrt{R_c^2}) = R_c - \\sqrt{R_c^2 - a^2} $$\n\nSubstituting this back gives the full expression for the toroidal flux:\n$$ \\Psi_t = 2\\pi B_{t,c} R_c (R_c - \\sqrt{R_c^2 - a^2}) $$\nWe can factor out $R_c$ from the square root to get:\n$$ \\Psi_t = 2\\pi B_{t,c} R_c^2 \\left(1 - \\sqrt{1 - \\left(\\frac{a}{R_c}\\right)^2}\\right) $$\n\n**Step 3: Apply flux conservation and the expansion law.**\n\nAccording to ideal MHD, $\\Psi_t$ is a constant during the expansion. Thus:\n$$ B_{t,c}(t) R_c(t)^2 \\left(1 - \\sqrt{1 - \\left(\\frac{a(t)}{R_c(t)}\\right)^2}\\right) = \\text{Constant} $$\n\nThis implies the following scaling for $B_{t,c}(t)$:\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 \\left(1 - \\sqrt{1 - \\left(\\frac{a(t)}{R_c(t)}\\right)^2}\\right)} $$\n\nNow, we substitute the given expansion law $a(t) = k R_c(t)^\\beta$:\n$$ \\frac{a(t)}{R_c(t)} = \\frac{k R_c(t)^\\beta}{R_c(t)} = k R_c(t)^{\\beta-1} $$\nSo the scaling becomes:\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 \\left(1 - \\sqrt{1 - k^2 R_c(t)^{2(\\beta-1)}}\\right)} $$\n\n**Step 4: Perform the asymptotic analysis for large $R_c$.**\n\nWe want to find the power-law scaling in the limit $R_c(t) \\to \\infty$. Since $0  \\beta  1$, the exponent $\\beta-1$ is negative. Therefore, as $R_c \\to \\infty$, the term $x = k^2 R_c(t)^{2(\\beta-1)}$ approaches zero.\n\nWe can use the Taylor expansion for $\\sqrt{1-x}$ for small $x$:\n$$ \\sqrt{1-x} \\approx 1 - \\frac{1}{2}x + \\mathcal{O}(x^2) $$\nThe term in the denominator's parentheses becomes:\n$$ 1 - \\sqrt{1 - x} \\approx 1 - \\left(1 - \\frac{1}{2}x\\right) = \\frac{1}{2}x $$\nSubstituting $x = k^2 R_c(t)^{2(\\beta-1)}$ back into this approximation:\n$$ 1 - \\sqrt{1 - k^2 R_c(t)^{2(\\beta-1)}} \\approx \\frac{1}{2} k^2 R_c(t)^{2(\\beta-1)} $$\n\nNow substitute this asymptotic form back into the scaling relation for $B_{t,c}(t)$:\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 \\left(\\frac{1}{2} k^2 R_c(t)^{2(\\beta-1)}\\right)} $$\nThe constants $\\frac{1}{2}k^2$ can be absorbed into the proportionality constant.\n$$ B_{t,c}(t) \\propto \\frac{1}{R_c(t)^2 R_c(t)^{2\\beta - 2}} = \\frac{1}{R_c(t)^{2 + 2\\beta - 2}} = R_c(t)^{-2\\beta} $$\n\n**Step 5: Identify the scaling index $\\eta$.**\n\nBy comparing our derived scaling $B_{t,c}(t) \\propto R_c(t)^{-2\\beta}$ with the desired form $B_{t,c}(t) \\propto R_c(t)^{-\\eta}$, we can directly identify the scaling index $\\eta$.\n$$ \\eta = 2\\beta $$", "answer": "$$ \\boxed{2\\beta} $$", "id": "235145"}, {"introduction": "The space weather impact of a CME can be dramatically amplified when it interacts with previously ejected solar material. This exercise models such a scenario, where a fast CME drives a shock wave into the slower ejecta ahead of it, a common cause of major geomagnetic storms. You will apply the fundamental Rankine-Hugoniot conservation laws across a shock front to derive the shock's propagation speed, honing your skills in analyzing hydrodynamic discontinuities in an astrophysical context.", "problem": "Coronal Mass Ejections (CMEs) are large-scale eruptions of plasma and magnetic field from the Sun. When a fast CME follows a slower one, a shock wave can form at their interaction front. This phenomenon is crucial for space weather forecasting as it can lead to enhanced particle acceleration.\n\nConsider a simplified one-dimensional model of such an interaction. A slow CME has created a region of space filled with its ejecta, which we model as a uniform medium of constant density $\\rho_1$ moving radially outward from the Sun at a constant speed $v_1$. A second, faster CME is launched subsequently along the same radial path. Its leading edge acts as an impermeable piston, traveling at a constant speed $v_2  v_1$.\n\nThis piston drives a forward shock into the ejecta of the first CME. Let the speed of this shock front be $v_s$ in the stationary reference frame of the Sun. Treat the plasma on both sides of the shock as an ideal gas with a constant adiabatic index $\\gamma$. You may assume that the upstream medium (the ejecta of the first CME) is 'cold', meaning its thermal pressure is negligible. Furthermore, neglect the effects of magnetic fields.\n\nDerive an expression for the speed of the shock front, $v_s$. Your final answer should be expressed in terms of $v_1$, $v_2$, and $\\gamma$.", "solution": "To solve for the shock speed $v_s$, we apply the Rankine-Hugoniot conservation laws in the stationary frame of the Sun.\n\n**Step 1: Write the conservation equations.**\nThe conservation of mass across the shock front is:\n$$ \\rho_1 (v_s - v_1) = \\rho_2 (v_s - v_2) $$\nThe conservation of momentum, neglecting the upstream pressure ($p_1 \\approx 0$), is:\n$$ p_2 + \\rho_2 (v_s - v_2)^2 = \\rho_1 (v_s - v_1)^2 $$\n\n**Step 2: Apply the strong shock condition.**\nSince the upstream medium is 'cold', the shock is strong. For a strong shock, the density compression ratio is constant:\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{\\gamma+1}{\\gamma-1} $$\n\n**Step 3: Combine equations and solve.**\nFrom the mass conservation law, we can write:\n$$ v_s - v_2 = \\frac{\\rho_1}{\\rho_2} (v_s - v_1) $$\nSubstituting the density ratio from the strong shock condition gives:\n$$ v_s - v_2 = \\frac{\\gamma-1}{\\gamma+1} (v_s - v_1) $$\nNow, we rearrange the equation to solve for $v_s$. First, let's isolate $v_2$:\n$$ v_2 = v_s - \\frac{\\gamma-1}{\\gamma+1}(v_s - v_1) = \\frac{2}{\\gamma+1}v_s + \\frac{\\gamma-1}{\\gamma+1}v_1 $$\nMultiply by $(\\gamma+1)$ to clear the denominator:\n$$ (\\gamma+1)v_2 = 2v_s + (\\gamma-1)v_1 $$\nFinally, solving for $v_s$ yields the desired expression:\n$$ 2v_s = (\\gamma+1)v_2 - (\\gamma-1)v_1 \\quad\\Longrightarrow\\quad v_s = \\frac{(\\gamma+1)v_2 - (\\gamma-1)v_1}{2} $$", "answer": "$$\\boxed{\\frac{(\\gamma+1)v_2 - (\\gamma-1)v_1}{2}}$$", "id": "235296"}, {"introduction": "Accurate space weather prediction often relies on synthesizing information from multiple, independent forecast models. This hands-on problem delves into the statistical methods used to create an optimal composite forecast for CME geo-effectiveness. By minimizing the Brier score, a standard metric for probabilistic forecast accuracy, you will derive the ideal weights for combining two models, revealing how a model's contribution to the final forecast is directly related to its individual performance.", "problem": "In the field of space weather forecasting, a key challenge is the accurate prediction of whether a Coronal Mass Ejection (CME) will cause a significant geomagnetic storm at Earth. To improve forecast accuracy, it is common to combine predictions from multiple independent models.\n\nConsider two probabilistic forecasting models, A and B, which provide probabilities $p_A$ and $p_B$ for a CME being geo-effective. The actual outcome is a binary variable $o$, where $o=1$ if a storm occurs and $o=0$ if it does not. The accuracy of a probabilistic forecast is commonly measured by the Brier score, defined as the mean squared error $BS = \\langle (p - o)^2 \\rangle$, where the angle brackets denote an average over a large ensemble of past events.\n\nA composite forecast $p_C$ can be formed by a linear weighting of the individual model forecasts:\n$$p_C = w_A p_A + (1-w_A) p_B$$\nwhere $w_A$ is the weight assigned to Model A's forecast.\n\nLong-term verification studies have been performed for two specific models under consideration for predicting storms from a certain class of CMEs:\n1.  **Model A** is a complex magnetohydrodynamic (MHD) simulation. Its Brier score, $BS_A$, is found to be directly proportional to the characteristic turbulent magnetic energy density, $U_{turb}$, in the CME's solar source region. This relationship is given by $BS_A = \\alpha U_{turb}$, where $\\alpha$ is an empirical constant.\n2.  **Model B** is a simpler, drag-based empirical model. Its Brier score, $BS_B$, is primarily determined by the variability in the ambient solar wind a CME propagates through. This is quantified by the variance of the solar wind proton density, $\\sigma_{sw}^2$, along the Sun-Earth path, with the relationship $BS_B = \\beta \\sigma_{sw}^2$, where $\\beta$ is another empirical constant.\n\nAssume that both forecasts, $p_A$ and $p_B$, are statistically **calibrated**, meaning the average forecast probability matches the observed frequency of the event ($ \\langle p_A \\rangle = \\langle p_B \\rangle = \\langle o \\rangle $). Further assume that the forecast errors, $e_A = p_A - o$ and $e_B = p_B - o$, are **uncorrelated** ($\\langle e_A e_B \\rangle = 0$).\n\nDerive the optimal weighting coefficient $w_A$ for Model A that minimizes the Brier score of the composite forecast, $p_C$. Express your answer in terms of the physical parameters $U_{turb}$, $\\sigma_{sw}^2$, and the constants $\\alpha$ and $\\beta$.", "solution": "The optimal weight $w_A$ is found by minimizing the Brier score ($BS_C$) of the composite forecast $p_C$.\n\n**Step 1: Express the Brier score of the composite forecast.**\nThe composite forecast is $p_C = w_A p_A + (1-w_A)p_B$. The error of the composite forecast is $e_C = p_C - o = w_A(p_A - o) + (1-w_A)(p_B - o) = w_A e_A + (1-w_A)e_B$.\nThe Brier score is the mean squared error:\n$$ BS_C = \\langle e_C^2 \\rangle = \\langle (w_A e_A + (1-w_A)e_B)^2 \\rangle $$\nExpanding this expression gives:\n$$ BS_C = w_A^2 \\langle e_A^2 \\rangle + (1-w_A)^2 \\langle e_B^2 \\rangle + 2w_A(1-w_A)\\langle e_A e_B \\rangle $$\nGiven that the errors are uncorrelated, $\\langle e_A e_B \\rangle = 0$. The expression simplifies to:\n$$ BS_C = w_A^2 \\langle e_A^2 \\rangle + (1-w_A)^2 \\langle e_B^2 \\rangle = w_A^2 BS_A + (1-w_A)^2 BS_B $$\n\n**Step 2: Substitute the given physical relationships.**\nWe are given $BS_A = \\alpha U_{turb}$ and $BS_B = \\beta \\sigma_{sw}^2$. Substituting these into the expression for $BS_C$:\n$$ BS_C(w_A) = w_A^2 (\\alpha U_{turb}) + (1-w_A)^2 (\\beta \\sigma_{sw}^2) $$\n\n**Step 3: Minimize the Brier score with respect to $w_A$.**\nTo find the minimum, we take the derivative of $BS_C$ with respect to $w_A$ and set it to zero:\n$$ \\frac{dBS_C}{dw_A} = \\frac{d}{dw_A} \\left[ w_A^2 (\\alpha U_{turb}) + (1-w_A)^2 (\\beta \\sigma_{sw}^2) \\right] = 0 $$\n$$ 2w_A (\\alpha U_{turb}) + 2(1-w_A)(-1)(\\beta \\sigma_{sw}^2) = 0 $$\n$$ w_A \\alpha U_{turb} = (1-w_A)\\beta \\sigma_{sw}^2 $$\n$$ w_A \\alpha U_{turb} = \\beta \\sigma_{sw}^2 - w_A \\beta \\sigma_{sw}^2 $$\n$$ w_A (\\alpha U_{turb} + \\beta \\sigma_{sw}^2) = \\beta \\sigma_{sw}^2 $$\n\n**Step 4: Solve for the optimal weight $w_A$.**\n$$ w_A = \\frac{\\beta \\sigma_{sw}^2}{\\alpha U_{turb} + \\beta \\sigma_{sw}^2} $$\nThis expression represents the optimal weight for Model A as a function of the physical parameters that determine each model's error.", "answer": "$$\\boxed{\\frac{\\beta\\,\\sigma_{sw}^2}{\\alpha\\,U_{turb} + \\beta\\,\\sigma_{sw}^2}}$$", "id": "235172"}]}