{"hands_on_practices": [{"introduction": "Let's begin with a foundational calculation for the BBPSSW protocol, a cornerstone of entanglement distillation. In this exercise, you will trace the evolution of two noisy Bell pairs through the protocol's steps of local CNOT operations and measurements. By calculating the final fidelity for a simple bit-flip error model, you'll gain direct insight into how this protocol probabilistically filters errors to enhance entanglement [@problem_id:76649].", "problem": "Consider an entanglement distillation scheme based on the BBPSSW protocol. Two parties, Alice and Bob, share two pairs of qubits, denoted (A1, B1) and (A2, B2). Each pair of qubits is prepared independently by an identical source. The sources aim to produce the Bell state $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$, but are noisy. The effect of the noise is to apply a bit-flip operation on one of the qubits, transforming $|\\Phi^+\\rangle$ into $|\\Psi^+\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle + |10\\rangle)$. This error occurs with probability $p$. Thus, the state of each pair is described by the density matrix:\n$$\n\\rho_{\\text{pair}} = (1-p)|\\Phi^+\\rangle\\langle\\Phi^+| + p|\\Psi^+\\rangle\\langle\\Psi^+|\n$$\n\nThe BBPSSW distillation protocol is then applied to the two pairs:\n1. Alice applies a CNOT gate to her qubits, with A1 as the control qubit and A2 as the target qubit ($C_{A1,A2}$).\n2. Bob applies a CNOT gate to his qubits, with B1 as the control qubit and B2 as the target qubit ($C_{B1,B2}$).\n3. Both Alice and Bob measure their second qubit (A2 and B2, respectively) in the computational basis $\\{|0\\rangle, |1\\rangle\\}$.\n4. The protocol is declared successful if their measurement outcomes are identical (i.e., both measure 0, or both measure 1). If successful, they keep the first qubit pair (A1, B1). Otherwise, the pair is discarded.\n\nYour task is to calculate the fidelity of the final state of the pair (A1, B1) with respect to the ideal state $|\\Phi^+\\rangle$, conditioned on the protocol being successful. Express your answer as a function of the error probability $p$.", "solution": "Let the two qubit pairs be labeled 1 and 2. The initial state of the full four-qubit system (A1, A2, B1, B2) is given by the tensor product of the individual pair states:\n$$\n\\rho_{in} = \\rho_{\\text{pair}}^{(1)} \\otimes \\rho_{\\text{pair}}^{(2)}\n$$\nwhere $\\rho_{\\text{pair}}^{(i)} = (1-p)|\\Phi^+_i\\rangle\\langle\\Phi^+_i| + p|\\Psi^+_i\\rangle\\langle\\Psi^+_i|$. Expanding this expression gives four terms:\n\\begin{align*}\n\\rho_{in} = (1-p)^2 |\\Phi^+_1\\rangle\\langle\\Phi^+_1| \\otimes |\\Phi^+_2\\rangle\\langle\\Phi^+_2| \\\\\n+ p(1-p) |\\Phi^+_1\\rangle\\langle\\Phi^+_1| \\otimes |\\Psi^+_2\\rangle\\langle\\Psi^+_2| \\\\\n+ p(1-p) |\\Psi^+_1\\rangle\\langle\\Psi^+_1| \\otimes |\\Phi^+_2\\rangle\\langle\\Phi^+_2| \\\\\n+ p^2 |\\Psi^+_1\\rangle\\langle\\Psi^+_1| \\otimes |\\Psi^+_2\\rangle\\langle\\Psi^+_2|\n\\end{align*}\n\nThe BBPSSW protocol applies the unitary operation $U = C_{A1,A2} \\otimes C_{B1,B2}$ to the state $\\rho_{in}$. We need to compute the effect of $U$ on the four pure states in the expansion. Let's analyze the transformation of a generic product state $|ij\\rangle_{A1B1} \\otimes |kl\\rangle_{A2B2}$. To apply the CNOTs, we reorder the qubits to $(A1, A2, B1, B2)$: $|ikjl\\rangle_{A1A2B1B2}$. The operation transforms this to $|i, k\\oplus i\\rangle_{A1A2} |j, l\\oplus j\\rangle_{B1B2}$.\n\nLet's compute the transformation for each of the four components of $\\rho_{in}$.\n\n**Case 1: Initial state $|\\Phi^+_1\\rangle \\otimes |\\Phi^+_2\\rangle$**\n$|\\Phi^+_1\\rangle \\otimes |\\Phi^+_2\\rangle = \\left(\\frac{1}{\\sqrt{2}}\\sum_{i=0}^1|ii\\rangle_{A1B1}\\right) \\otimes \\left(\\frac{1}{\\sqrt{2}}\\sum_{j=0}^1|jj\\rangle_{A2B2}\\right) = \\frac{1}{2}\\sum_{i,j}|ii\\rangle_{A1B1} \\otimes |jj\\rangle_{A2B2}$.\nReordering qubits: $\\frac{1}{2}\\sum_{i,j}|ijij\\rangle_{A1A2B1B2}$.\nApplying $U$:\n$U \\left(\\frac{1}{2}\\sum_{i,j}|ijij\\rangle\\right) = \\frac{1}{2}\\sum_{i,j} |i, j\\oplus i\\rangle_{A1A2} |i, j\\oplus i\\rangle_{B1B2}$.\nLet $k=j\\oplus i$. The sum over $j$ is equivalent to a sum over $k$.\n$ \\frac{1}{2}\\sum_{i,k} |ik\\rangle_{A1A2} |ik\\rangle_{B1B2} = \\frac{1}{2}\\sum_{i,k} |i\\rangle_{A1}|k\\rangle_{A2} |i\\rangle_{B1}|k\\rangle_{B2} $.\nReordering back to pairs (A1,B1) and (A2,B2):\n$ \\left(\\frac{1}{\\sqrt{2}}\\sum_i |ii\\rangle_{A1B1}\\right) \\otimes \\left(\\frac{1}{\\sqrt{2}}\\sum_k |kk\\rangle_{A2B2}\\right) = |\\Phi^+\\rangle_{A1B1} \\otimes |\\Phi^+\\rangle_{A2B2} $.\n\n**Case 2: Initial state $|\\Phi^+_1\\rangle \\otimes |\\Psi^+_2\\rangle$**\n$|\\Phi^+_1\\rangle \\otimes |\\Psi^+_2\\rangle = \\left(\\frac{1}{\\sqrt{2}}\\sum_{i=0}^1|ii\\rangle_{A1B1}\\right) \\otimes \\left(\\frac{1}{\\sqrt{2}}\\sum_{j=0}^1|j,j\\oplus 1\\rangle_{A2B2}\\right) = \\frac{1}{2}\\sum_{i,j}|ii\\rangle_{A1B1} \\otimes |j,j\\oplus 1\\rangle_{A2B2}$.\nReordering qubits: $\\frac{1}{2}\\sum_{i,j}|i,j,i,j\\oplus 1\\rangle_{A1A2B1B2}$.\nApplying $U$: $\\frac{1}{2}\\sum_{i,j} |i, j\\oplus i\\rangle_{A1A2} |i, (j\\oplus 1)\\oplus i\\rangle_{B1B2}$.\nLet $k=j\\oplus i$:\n$\\frac{1}{2}\\sum_{i,k} |ik\\rangle_{A1A2} |i, k\\oplus 1\\rangle_{B1B2} = \\left(\\frac{1}{\\sqrt{2}}\\sum_i |ii\\rangle_{A1B1}\\right) \\otimes \\left(\\frac{1}{\\sqrt{2}}\\sum_k |k,k\\oplus 1\\rangle_{A2B2}\\right) = |\\Phi^+\\rangle_{A1B1} \\otimes |\\Psi^+\\rangle_{A2B2}$.\n\n**Case 3: Initial state $|\\Psi^+_1\\rangle \\otimes |\\Phi^+_2\\rangle$**\nBy symmetry with Case 2, we can infer the result by swapping the roles of pairs 1 and 2. However, the CNOTs are asymmetric.\n$|\\Psi^+_1\\rangle \\otimes |\\Phi^+_2\\rangle = \\frac{1}{2}\\sum_{i,j}|i,i\\oplus 1\\rangle_{A1B1} \\otimes |jj\\rangle_{A2B2}$.\nReordering: $\\frac{1}{2}\\sum_{i,j}|i,j,i\\oplus 1,j\\rangle_{A1A2B1B2}$.\nApplying $U$: $\\frac{1}{2}\\sum_{i,j} |i, j\\oplus i\\rangle_{A1A2} |i\\oplus 1, j\\oplus(i\\oplus 1)\\rangle_{B1B2} = \\frac{1}{2}\\sum_{i,j} |i, j\\oplus i\\rangle_{A1A2} |i\\oplus 1, j\\oplus i \\oplus 1\\rangle_{B1B2}$.\nLet $k=j\\oplus i$:\n$\\frac{1}{2}\\sum_{i,k} |ik\\rangle_{A1A2} |i\\oplus 1, k\\oplus 1\\rangle_{B1B2} = \\left(\\frac{1}{\\sqrt{2}}\\sum_i |i,i\\oplus 1\\rangle_{A1B1}\\right) \\otimes \\left(\\frac{1}{\\sqrt{2}}\\sum_k |k,k\\oplus 1\\rangle_{A2B2}\\right) = |\\Psi^+\\rangle_{A1B1} \\otimes |\\Psi^+\\rangle_{A2B2}$.\n\n**Case 4: Initial state $|\\Psi^+_1\\rangle \\otimes |\\Psi^+_2\\rangle$**\n$|\\Psi^+_1\\rangle \\otimes |\\Psi^+_2\\rangle = \\frac{1}{2}\\sum_{i,j}|i,i\\oplus 1\\rangle_{A1B1} \\otimes |j,j\\oplus 1\\rangle_{A2B2}$.\nReordering: $\\frac{1}{2}\\sum_{i,j}|i,j,i\\oplus 1,j\\oplus 1\\rangle_{A1A2B1B2}$.\nApplying $U$: $\\frac{1}{2}\\sum_{i,j} |i, j\\oplus i\\rangle_{A1A2} |i\\oplus 1, (j\\oplus 1)\\oplus (i\\oplus 1)\\rangle_{B1B2} = \\frac{1}{2}\\sum_{i,j} |i, j\\oplus i\\rangle_{A1A2} |i\\oplus 1, j\\oplus i\\rangle_{B1B2}$.\nLet $k=j\\oplus i$:\n$\\frac{1}{2}\\sum_{i,k} |ik\\rangle_{A1A2} |i\\oplus 1, k\\rangle_{B1B2} = \\left(\\frac{1}{\\sqrt{2}}\\sum_i |i,i\\oplus 1\\rangle_{A1B1}\\right) \\otimes \\left(\\frac{1}{\\sqrt{2}}\\sum_k |kk\\rangle_{A2B2}\\right) = |\\Psi^+\\rangle_{A1B1} \\otimes |\\Phi^+\\rangle_{A2B2}$.\n\nThe state after the CNOT operations, $\\rho_{mid} = U\\rho_{in}U^\\dagger$, is:\n\\begin{align*}\n\\rho_{mid} = (1-p)^2 |\\Phi^+_{A1B1}\\Phi^+_{A2B2}\\rangle\\langle\\Phi^+_{A1B1}\\Phi^+_{A2B2}| \\\\\n+ p(1-p) |\\Phi^+_{A1B1}\\Psi^+_{A2B2}\\rangle\\langle\\Phi^+_{A1B1}\\Psi^+_{A2B2}| \\\\\n+ p(1-p) |\\Psi^+_{A1B1}\\Psi^+_{A2B2}\\rangle\\langle\\Psi^+_{A1B1}\\Psi^+_{A2B2}| \\\\\n+ p^2 |\\Psi^+_{A1B1}\\Phi^+_{A2B2}\\rangle\\langle\\Psi^+_{A1B1}\\Phi^+_{A2B2}|\n\\end{align*}\n(where $|\\Phi^+_{A1B1}\\Phi^+_{A2B2}\\rangle = |\\Phi^+\\rangle_{A1B1}\\otimes|\\Phi^+\\rangle_{A2B2}$, etc.)\n\nNext, qubits A2 and B2 are measured. The protocol succeeds if outcomes are the same, i.e., outcomes 00 or 11. The measurement projector for success is $M_{succ} = |00\\rangle\\langle00|_{A2B2} + |11\\rangle\\langle11|_{A2B2}$.\nThe probability of success for a state $|\\psi\\rangle_{A1B1} \\otimes |\\phi\\rangle_{A2B2}$ is $\\mathrm{Tr}(M_{succ}|\\phi\\rangle\\langle\\phi|) = \\langle\\phi|M_{succ}|\\phi\\rangle$.\nFor $|\\phi\\rangle = |\\Phi^+\\rangle_{A2B2} = \\frac{1}{\\sqrt{2}}(|00\\rangle+|11\\rangle)$, the probability is $|\\langle00|\\Phi^+\\rangle|^2 + |\\langle11|\\Phi^+\\rangle|^2 = (1/\\sqrt{2})^2 + (1/\\sqrt{2})^2 = 1$.\nFor $|\\phi\\rangle = |\\Psi^+\\rangle_{A2B2} = \\frac{1}{\\sqrt{2}}(|01\\rangle+|10\\rangle)$, the probability is $|\\langle00|\\Psi^+\\rangle|^2 + |\\langle11|\\Psi^+\\rangle|^2 = 0+0=0$.\n\nSo, the protocol succeeds only if the state of pair (A2,B2) is $|\\Phi^+\\rangle$. This occurs in Cases 1 and 4.\n- Success from Case 1: Probability $(1-p)^2 \\times 1 = (1-p)^2$. The remaining state on (A1,B1) is $|\\Phi^+\\rangle_{A1B1}$.\n- Success from Case 4: Probability $p^2 \\times 1 = p^2$. The remaining state on (A1,B1) is $|\\Psi^+\\rangle_{A1B1}$.\nCases 2 and 3 fail with probability 1.\n\nThe total probability of success is $P_{succ} = (1-p)^2 + p^2$.\nThe unnormalized final state of pair (A1,B1), conditioned on success, is the sum of the successful outcomes weighted by their probabilities:\n$$\n\\rho'_{final} = (1-p)^2 |\\Phi^+\\rangle\\langle\\Phi^+| + p^2 |\\Psi^+\\rangle\\langle\\Psi^+|\n$$\nThe normalized final state is $\\rho_{final} = \\frac{1}{P_{succ}}\\rho'_{final}$:\n$$\n\\rho_{final} = \\frac{(1-p)^2 |\\Phi^+\\rangle\\langle\\Phi^+| + p^2 |\\Psi^+\\rangle\\langle\\Psi^+|}{(1-p)^2 + p^2}\n$$\nThe fidelity of this state with respect to $|\\Phi^+\\rangle$ is $F = \\langle\\Phi^+|\\rho_{final}|\\Phi^+\\rangle$.\n$$\nF = \\frac{(1-p)^2 \\langle\\Phi^+|\\Phi^+\\rangle\\langle\\Phi^+|\\Phi^+\\rangle + p^2 \\langle\\Phi^+|\\Psi^+\\rangle\\langle\\Psi^+|\\Phi^+\\rangle}{(1-p)^2 + p^2}\n$$\nSince $\\langle\\Phi^+|\\Phi^+\\rangle = 1$ and $\\langle\\Phi^+|\\Psi^+\\rangle = 0$ (as the states are orthogonal), this simplifies to:\n$$\nF = \\frac{(1-p)^2}{(1-p)^2 + p^2} = \\frac{1-2p+p^2}{1-2p+p^2+p^2} = \\frac{1-2p+p^2}{1-2p+2p^2}\n$$", "answer": "$$ \\boxed{\\frac{(1-p)^2}{(1-p)^2 + p^2}} $$", "id": "76649"}, {"introduction": "A single round of distillation may not be enough to reach the high fidelities required for quantum algorithms. This practice explores the power and cost of *recursive* purification, where the output of one round becomes the input for the next. You will calculate the expected number of initial noisy pairs consumed to achieve a target fidelity, revealing the critical trade-off between entanglement quality and resource expenditure in recursive schemes [@problem_id:76640].", "problem": "A source produces a stream of noisy entangled qubit pairs. For each pair, the state is described by the density matrix\n$$\n\\rho_0 = F_0 |\\Phi^+\\rangle\\langle\\Phi^+| + (1-F_0) |\\Psi^+\\rangle\\langle\\Psi^+|\n$$\nwhere $F_0$ is the initial fidelity with respect to the target Bell state $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$. The error state is the Bell state $|\\Psi^+\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle + |10\\rangle)$, which corresponds to a bit-flip error on one of the qubits.\n\nTo improve the fidelity, a recursive purification protocol is employed. A single round of this protocol proceeds as follows:\n1.  Two pairs, labeled $(A_1, B_1)$ and $(A_2, B_2)$, are drawn from the current supply. Alice possesses qubits $A_1$ and $A_2$, while Bob holds $B_1$ and $B_2$.\n2.  Alice performs a CNOT gate with $A_1$ as the control qubit and $A_2$ as the target. Simultaneously, Bob performs a CNOT gate with $B_1$ as the control and $B_2$ as the target.\n3.  Following the CNOT operations, Alice measures qubit $A_2$ and Bob measures qubit $B_2$, both in the computational basis $\\{|0\\rangle, |1\\rangle\\}$.\n4.  Alice and Bob communicate their measurement results. If their outcomes are identical (both 0 or both 1), the protocol round is successful. The first pair, $(A_1, B_1)$, is retained as the purified output, and the second pair is discarded. If their outcomes are different, the round fails, and both pairs are discarded.\n\nThe successfully purified pairs from one round form the supply for the subsequent round. This recursive procedure continues until the fidelity of the output pairs surpasses a predetermined target, $F_{target}$.\n\nGiven an initial fidelity $F_0 = 4/5$ and a target fidelity $F_{target} = 99/100$, what is the expected total number of initial pairs consumed to produce a single pair with fidelity exceeding $F_{target}$?", "solution": "1. Relevant relations. For fidelity $F$ at one round, the purified fidelity and success probability are\n$$\nF' = \\frac{F^2}{F^2 + (1 - F)^2}, \n\\qquad\np = F^2 + (1 - F)^2.\n$$\nTo obtain one purified pair of fidelity $F'$ from pairs of fidelity $F$, on average one needs $2/p$ pairs of fidelity $F$.\n\n2. Recursive fidelities. Start with $F_0 = 4/5$ and target $F_{target}=99/100$.\nCompute\n$$\nF_1 = \\frac{(4/5)^2}{(4/5)^2 + (1 - 4/5)^2}\n      = \\frac{16/25}{16/25 + 1/25}\n      = \\frac{16}{17},\n$$\n$$\nF_2 = \\frac{(16/17)^2}{(16/17)^2 + (1 - 16/17)^2}\n      = \\frac{256/289}{256/289 + 1/289}\n      = \\frac{256}{257}.\n$$\nSince $F_2 = 256/257  99/100$, two rounds suffice.\n\n3. Success probabilities\n$$\np_0 = F_0^2 + (1 - F_0)^2 = \\frac{16}{25} + \\frac{1}{25} = \\frac{17}{25},\n$$\n$$\np_1 = F_1^2 + (1 - F_1)^2 = \\frac{256}{289} + \\frac{1}{289} = \\frac{257}{289}.\n$$\n\n4. Total expected consumption. Two rounds consume\n$$\nE = \\frac{2}{p_0}\\,\\frac{2}{p_1}\n   = \\frac{2}{17/25}\\,\\frac{2}{257/289}\n   = \\frac{50}{17}\\,\\frac{578}{257}\n   = \\frac{1700}{257}.\n$$", "answer": "$$\\boxed{\\frac{1700}{257}}$$", "id": "76640"}, {"introduction": "Our protocols have so far relied on perfect Local Operations and Classical Communication (LOCC). This final exercise challenges that idealization by introducing errors into the classical communication channel, a crucial component of the protocol's post-selection logic. Analyzing the DEJMPS protocol under these realistic conditions will demonstrate how noise in classical components can degrade performance and why robust design is essential for all aspects of a quantum protocol [@problem_id:76703].", "problem": "An essential task in quantum communication is entanglement distillation, where multiple copies of a noisy entangled state are processed to produce a smaller number of states with higher fidelity to a target maximally entangled state. The Deutsch-Ekert-Jozsa-Macchiavello-Popescu-Sanpera (DEJMPS) protocol is one such method.\n\nConsider two parties, Alice and Bob, who share two identical and independent copies of a Bell-diagonal state $\\rho_{AB}$ on a two-qubit system. The state is given by\n$$ \\rho_{AB} = F |\\Phi^+\\rangle\\langle\\Phi^+| + (1-F) |\\Psi^+\\rangle\\langle\\Psi^+| $$\nwhere $F \\in (1/2, 1)$ is the initial fidelity with respect to the Bell state $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$, and $|\\Psi^+\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle + |10\\rangle)$. Let the two shared pairs be denoted $(A_1, B_1)$ and $(A_2, B_2)$.\n\nThe DEJMPS protocol proceeds as follows:\n1.  Alice applies a CNOT gate to her two qubits, with $A_1$ as control and $A_2$ as target ($CNOT_{A_1,A_2}$).\n2.  Bob applies a CNOT gate to his two qubits, with $B_1$ as control and $B_2$ as target ($CNOT_{B_1,B_2}$).\n3.  Alice and Bob perform local measurements on their second qubits, $A_2$ and $B_2$ respectively, in the computational basis $\\{|0\\rangle, |1\\rangle\\}$. Let their measurement outcomes be $m_A \\in \\{0, 1\\}$ and $m_B \\in \\{0, 1\\}$.\n4.  The communication of these classical bits is imperfect. Both Alice's and Bob's transmitted bits are independently flipped with a probability $\\epsilon$. That is, Alice reports $m'_A = m_A \\oplus e_A$ and Bob reports $m'_B = m_B \\oplus e_B$, where $e_A$ and $e_B$ are independent random variables that are 1 with probability $\\epsilon$ and 0 with probability $1-\\epsilon$.\n5.  They decide to keep the first qubit pair $(A_1, B_1)$ if their reported outcomes are identical, i.e., $m'_A = m'_B$. Otherwise, the pair is discarded.\n\nFor a general initial Bell-diagonal state $\\rho = \\sum_{i=0}^3 \\lambda_i |\\Psi_i\\rangle\\langle\\Psi_i|$, where $|\\Psi_0\\rangle=|\\Phi^+\\rangle, |\\Psi_1\\rangle=|\\Psi^+\\rangle, |\\Psi_2\\rangle=|\\Phi^-\\rangle, |\\Psi_3\\rangle=|\\Psi^-\\rangle$, the protocol transforms the coefficients $\\vec{\\lambda} = (\\lambda_0, \\lambda_1, \\lambda_2, \\lambda_3)$ of the state of the first pair. The transformation depends on the (true) measurement outcomes $m_A, m_B$.\n\n- If $m_A = m_B$, the unnormalized new coefficients $\\vec{\\lambda}'$ are given by:\n    $\\lambda'_0 \\propto \\lambda_0^2 + \\lambda_2^2$\n    $\\lambda'_1 \\propto \\lambda_1^2 + \\lambda_3^2$\n    $\\lambda'_2 \\propto 2\\lambda_0\\lambda_2$\n    $\\lambda'_3 \\propto 2\\lambda_1\\lambda_3$\nThe probability of this outcome is $p_{succ} = (\\lambda_0+\\lambda_2)^2 + (\\lambda_1+\\lambda_3)^2$.\n\n- If $m_A \\ne m_B$, the unnormalized new coefficients $\\vec{\\tilde{\\lambda}}'$ are given by:\n    $\\tilde{\\lambda}'_0 \\propto \\lambda_0\\lambda_1 + \\lambda_2\\lambda_3$\n    $\\tilde{\\lambda}'_1 \\propto \\lambda_0\\lambda_1 + \\lambda_2\\lambda_3$\n    $\\tilde{\\lambda}'_2 \\propto \\lambda_0\\lambda_3 + \\lambda_1\\lambda_2$\n    $\\tilde{\\lambda}'_3 \\propto \\lambda_0\\lambda_3 + \\lambda_1\\lambda_2$\nThe probability of this outcome is $p_{fail} = 2(\\lambda_0+\\lambda_2)(\\lambda_1+\\lambda_3)$.\n\nGiven the initial state and the noisy protocol, calculate the fidelity of the final state of the first pair $(A_1, B_1)$ with respect to $|\\Phi^+\\rangle$. Express your answer as a function of $F$ and $\\epsilon$.", "solution": "The problem asks for the fidelity of the post-selected state with respect to $|\\Phi^+\\rangle$. The initial state is a mixture of $|\\Phi^+\\rangle$ and $|\\Psi^+\\rangle$. A general Bell-diagonal state is $\\rho = \\sum_{i=0}^3 \\lambda_i |\\Psi_i\\rangle\\langle\\Psi_i|$. The fidelity with respect to $|\\Phi^+\\rangle$ is $\\lambda_0$.\n\nThe initial state is $\\rho_{AB} = F |\\Phi^+\\rangle\\langle\\Phi^+| + (1-F) |\\Psi^+\\rangle\\langle\\Psi^+|$. This corresponds to the coefficient vector $\\vec{\\lambda} = (F, 1-F, 0, 0)$.\n\nFirst, let's analyze the protocol with perfect measurements. We calculate the state and success probability for the two cases of true measurement outcomes.\n\nCase 1: True measurement outcomes are the same, $m_A = m_B$.\nThe probability of this event, $p_{succ}$, is given by the formula:\n$$ p_{succ} = (\\lambda_0+\\lambda_2)^2 + (\\lambda_1+\\lambda_3)^2 = (F+0)^2 + (1-F+0)^2 = F^2 + (1-F)^2 $$\nThe unnormalized coefficients of the new state, $\\rho'_{succ}$, are:\n$\\lambda'_0 \\propto F^2 + 0^2 = F^2$\n$\\lambda'_1 \\propto (1-F)^2 + 0^2 = (1-F)^2$\n$\\lambda'_2 \\propto 2(F)(0) = 0$\n$\\lambda'_3 \\propto 2(1-F)(0) = 0$\nThe normalization constant is the sum of these proportionalities, which is $F^2 + (1-F)^2$.\nSo the normalized coefficients are $\\lambda'_{succ,0} = \\frac{F^2}{F^2 + (1-F)^2}$ and $\\lambda'_{succ,1} = \\frac{(1-F)^2}{F^2 + (1-F)^2}$.\nThe fidelity of this state is $F'_{succ} = \\lambda'_{succ,0} = \\frac{F^2}{F^2 + (1-F)^2}$.\n\nCase 2: True measurement outcomes are different, $m_A \\ne m_B$.\nThe probability of this event, $p_{fail}$, is given by:\n$$ p_{fail} = 2(\\lambda_0+\\lambda_2)(\\lambda_1+\\lambda_3) = 2(F+0)(1-F+0) = 2F(1-F) $$\nThe unnormalized coefficients of the new state, $\\rho'_{fail}$, are:\n$\\tilde{\\lambda}'_0 \\propto F(1-F) + 0 \\cdot 0 = F(1-F)$\n$\\tilde{\\lambda}'_1 \\propto F(1-F) + 0 \\cdot 0 = F(1-F)$\n$\\tilde{\\lambda}'_2 \\propto F \\cdot 0 + (1-F) \\cdot 0 = 0$\n$\\tilde{\\lambda}'_3 \\propto F \\cdot 0 + (1-F) \\cdot 0 = 0$\nThe normalization constant is $F(1-F)+F(1-F) = 2F(1-F)$.\nSo the normalized coefficients are $\\tilde{\\lambda}'_{fail,0} = \\frac{F(1-F)}{2F(1-F)} = \\frac{1}{2}$ and $\\tilde{\\lambda}'_{fail,1} = \\frac{F(1-F)}{2F(1-F)} = \\frac{1}{2}$.\nThe fidelity of this state is $F'_{fail} = \\tilde{\\lambda}'_{fail,0} = \\frac{1}{2}$.\nNote that $p_{succ} + p_{fail} = F^2 + (1-F)^2 + 2F(1-F) = (F+1-F)^2 = 1$, as expected.\n\nNow, we include the classical measurement errors. Alice and Bob keep the pair $(A_1,B_1)$ if their reported outcomes are equal, $m'_A = m'_B$.\nLet $m_A, m_B$ be the true outcomes and $e_A, e_B$ be the error bits.\n$m'_A = m_A \\oplus e_A$, $m'_B = m_B \\oplus e_B$.\nThe condition $m'_A = m'_B$ is equivalent to $m_A \\oplus e_A = m_B \\oplus e_B$, or $m_A \\oplus m_B = e_A \\oplus e_B$.\n\nThe event $e_A \\oplus e_B = 0$ occurs if $e_A=e_B=0$ or $e_A=e_B=1$. The probability is $P(e_A \\oplus e_B = 0) = (1-\\epsilon)(1-\\epsilon) + \\epsilon\\epsilon = (1-\\epsilon)^2 + \\epsilon^2 = 1 - 2\\epsilon + 2\\epsilon^2$.\nThe event $e_A \\oplus e_B = 1$ occurs if $e_A=0, e_B=1$ or $e_A=1, e_B=0$. The probability is $P(e_A \\oplus e_B = 1) = (1-\\epsilon)\\epsilon + \\epsilon(1-\\epsilon) = 2\\epsilon(1-\\epsilon)$.\n\nSo, the parties select the pair if:\n- ($m_A = m_B$) AND ($e_A \\oplus e_B = 0$). This happens with probability $p_{succ} \\times P(e_A \\oplus e_B = 0)$. The resulting state has fidelity $F'_{succ}$.\n- ($m_A \\ne m_B$) AND ($e_A \\oplus e_B = 1$). This happens with probability $p_{fail} \\times P(e_A \\oplus e_B = 1)$. The resulting state has fidelity $F'_{fail}$.\n\nThe final state $\\rho_{out}$ is a mixture of the states from these two scenarios. The fidelity of $\\rho_{out}$ is the weighted average of the fidelities $F'_{succ}$ and $F'_{fail}$.\nThe weight for each case is the probability of that case happening, conditioned on the pair being kept.\nThe total probability of keeping the pair is:\n$$ P_{keep} = p_{succ} P(e_A \\oplus e_B = 0) + p_{fail} P(e_A \\oplus e_B = 1) $$\n$$ P_{keep} = (F^2 + (1-F)^2)(1-2\\epsilon+2\\epsilon^2) + 2F(1-F) (2\\epsilon(1-\\epsilon)) $$\nThe unnormalized fidelity contribution from the \"successful\" branch is $p_{succ} P(e_A \\oplus e_B = 0) F'_{succ}$.\nThe unnormalized fidelity contribution from the \"failure\" branch is $p_{fail} P(e_A \\oplus e_B = 1) F'_{fail}$.\nThe final fidelity $F_{out}$ is the sum of these contributions divided by $P_{keep}$.\n$$ F_{out} = \\frac{p_{succ} P(e_A \\oplus e_B = 0) F'_{succ} + p_{fail} P(e_A \\oplus e_B = 1) F'_{fail}}{P_{keep}} $$\nLet's substitute the expressions:\nNumerator:\n$$ (F^2+(1-F)^2)(1-2\\epsilon+2\\epsilon^2)\\frac{F^2}{F^2+(1-F)^2} + 2F(1-F)(2\\epsilon(1-\\epsilon))\\frac{1}{2} $$\n$$ = F^2(1-2\\epsilon+2\\epsilon^2) + 2F(1-F)\\epsilon(1-\\epsilon) $$\nDenominator is $P_{keep}$:\n$$ P_{keep} = (F^2+(1-F)^2)(1-2\\epsilon+2\\epsilon^2) + 4F(1-F)\\epsilon(1-\\epsilon) $$\nSo the final fidelity is:\n$$ F_{out} = \\frac{F^2(1-2\\epsilon+2\\epsilon^2) + 2F(1-F)\\epsilon(1-\\epsilon)}{(F^2+(1-F)^2)(1-2\\epsilon+2\\epsilon^2) + 4F(1-F)\\epsilon(1-\\epsilon)} $$\nWe can expand $F^2+(1-F)^2 = F^2 + 1 - 2F + F^2 = 2F^2-2F+1$.\n$$ F_{out} = \\frac{F^2(1-2\\epsilon+2\\epsilon^2) + 2(F-F^2)\\epsilon(1-\\epsilon)}{(2F^2-2F+1)(1-2\\epsilon+2\\epsilon^2) + 4(F-F^2)\\epsilon(1-\\epsilon)} $$\nThis is the final expression for the output fidelity.", "answer": "$$ \\boxed{\\frac{F^2(1-2\\epsilon+2\\epsilon^2) + 2F(1-F)\\epsilon(1-\\epsilon)}{(F^2+(1-F)^2)(1-2\\epsilon+2\\epsilon^2) + 4F(1-F)\\epsilon(1-\\epsilon)}} $$", "id": "76703"}]}