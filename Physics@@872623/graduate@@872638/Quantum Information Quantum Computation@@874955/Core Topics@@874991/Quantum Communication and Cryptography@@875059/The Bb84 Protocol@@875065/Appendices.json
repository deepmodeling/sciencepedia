{"hands_on_practices": [{"introduction": "The fundamental security of the BB84 protocol rests on the fact that an eavesdropper cannot gain information without introducing detectable disturbances. This exercise [@problem_id:715047] invites you to quantify this principle by analyzing the most straightforward eavesdropping strategy: the intercept-resend attack. By calculating the Quantum Bit Error Rate (QBER) this attack induces, you will derive a critical threshold that signals the presence of an active adversary on the quantum channel.", "problem": "In a quantum key distribution scheme based on the BB84 protocol, Alice sends single photons to Bob. For each transmission, she randomly encodes a classical bit ('0' or '1') using one of two polarization bases: the rectilinear basis ($+$) or the diagonal basis ($\\times$).\nThe quantum states for the bases are defined as:\n- Rectilinear basis ($+$): $|0\\rangle$ (horizontal polarization), $|1\\rangle$ (vertical polarization).\n- Diagonal basis ($\\times$): $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$, $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$.\n\nAlice chooses her basis for each photon completely at random, with a probability of $\\frac{1}{2}$ for the rectilinear basis and $\\frac{1}{2}$ for the diagonal basis. Similarly, Bob, for his measurement of each incoming photon, chooses his basis randomly with a probability of $\\frac{1}{2}$ for each basis. After the quantum transmission, Alice and Bob communicate over a public classical channel to perform basis reconciliation, keeping only the bits for which they used the same basis. This set of bits forms the sifted key.\n\nAn eavesdropper, Eve, mounts an intercept-resend attack. She intercepts every photon from Alice, measures it, and then sends a new photon to Bob prepared in the state corresponding to her measurement outcome. However, Eve's strategy is not symmetric. She suspects Alice might have a preference for one basis, so she chooses her measurement basis with a bias: she uses the rectilinear basis ($+$) with probability $p$ and the diagonal basis ($\\times$) with probability $1-p$.\n\nDerive the Quantum Bit Error Rate (QBER) this attack induces in the sifted key shared between Alice and Bob. The QBER is defined as the fraction of bits in the sifted key that are different from what Alice originally sent. Express your answer as a function of $p$.", "solution": "We denote by $A\\in\\{+,\\times\\}$ Alice’s basis, $E\\in\\{+,\\times\\}$ Eve’s basis chosen with $P(E=+)=p$, and $B\\in\\{+,\\times\\}$ Bob’s basis. The sifted key is obtained when $A=B$, which occurs with probability $P(A=B)=P(A=+,B=+)+P(A=\\times,B=\\times)=\\frac{1}{4}+\\frac{1}{4}=\\frac{1}{2}$.\nCondition on the two cases for the sifted key:\n\nCase 1: $A=B=+$. This occurs with probability $1/4$.\n- If $E=+$ (probability $p$), Eve measures in the correct basis and resends the right state, so there is no error.\n- If $E=\\times$ (probability $1-p$), Eve measures in the wrong basis. Her measurement outcome is random, and when Bob measures the resent state in the $+$ basis, his outcome will be random. This leads to an error with probability $1/2$.\nThe probability of an error in this case is $P(\\text{error}\\mid A=B=+) = p \\cdot 0 + (1-p) \\cdot \\frac{1}{2} = \\frac{1-p}{2}$.\n\nCase 2: $A=B=\\times$. This also occurs with probability $1/4$.\n- If $E=+$ (probability $p$), Eve measures in the wrong basis, inducing an error with probability $1/2$.\n- If $E=\\times$ (probability $1-p$), Eve measures correctly, inducing no error.\nThe probability of an error in this case is $P(\\text{error}\\mid A=B=\\times) = p \\cdot \\frac{1}{2} + (1-p) \\cdot 0 = \\frac{p}{2}$.\n\nThe total probability of an error occurring in the sifted key is the sum of the probabilities of errors in each case, weighted by the probability of that case:\n$$ P(\\text{error and sifted}) = P(\\text{error}\\mid A=B=+)P(A=B=+) + P(\\text{error}\\mid A=B=\\times)P(A=B=\\times) $$\n$$ P(\\text{error and sifted}) = \\left(\\frac{1-p}{2}\\right) \\frac{1}{4} + \\left(\\frac{p}{2}\\right) \\frac{1}{4} = \\frac{1-p+p}{8} = \\frac{1}{8} $$\nThe QBER is the conditional probability of an error given that the bit is in the sifted key:\n$$ \\text{QBER} = \\frac{P(\\text{error and sifted})}{P(\\text{sifted})} = \\frac{1/8}{1/2} = \\frac{1}{4} $$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "715047"}, {"introduction": "In any real-world quantum communication system, errors arise not only from potential eavesdroppers but also from inherent imperfections in the hardware and channel. This practice [@problem_id:143401] shifts our focus from active attacks to the practical challenges of photon loss and detector dark counts. Calculating the QBER under these realistic conditions highlights a central problem in QKD: disentangling environmental noise from malicious interference to accurately assess security.", "problem": "In a simplified model of the BB84 quantum key distribution protocol, we consider the effects of channel loss and detector dark counts on the Quantum Bit Error Rate (QBER).\n\nAlice sends single-photon qubits to Bob through a quantum channel with transmissivity $\\eta$, where $0 \\le \\eta \\le 1$. For each bit, Bob randomly chooses a measurement basis (Z or X). For a given basis choice, Bob's detection apparatus consists of two ideal single-photon detectors. For example, in the Z-basis, one detector ($D_0$) clicks for the state $|0\\rangle$ and the other ($D_1$) for the state $|1\\rangle$.\n\nThe detectors are not perfect and suffer from dark counts. Each detector has a probability $p_d$ of firing in a given time window, even if no photon is incident upon it. We assume that these dark count events are independent for each detector. We also assume that $p_d$ is small enough that more complex error sources can be neglected. The channel itself does not induce bit-flip errors; it only causes photon loss.\n\nAfter the transmission phase, Alice and Bob perform sifting, keeping only the results for which they used the same measurement basis. For these sifted bits, a result is considered valid and is added to the key if and only if **exactly one** of the two corresponding detectors fired. If both detectors fire or neither detector fires, the result for that time window is discarded.\n\nAn error is registered if, for a sifted bit, the detector that fired does not correspond to the bit value Alice originally sent. For example, if Alice sent '0' and Bob measured in the same basis, an error occurs if detector $D_1$ fires and $D_0$ does not.\n\nCalculate the QBER for the sifted key as a function of the channel transmissivity $\\eta$ and the detector dark count probability $p_d$.", "solution": "To calculate the Quantum Bit Error Rate (QBER), we consider the scenario where Alice and Bob use the same measurement basis (after sifting). The QBER is defined as the ratio of the number of erroneous valid detections to the total number of valid detections. A valid detection occurs when exactly one detector fires. An error occurs if the detector that fires does not correspond to the bit Alice sent.\n\nAssume Alice sends a bit '0' (the case for '1' is symmetric). The channel transmissivity is $\\eta$, so the photon is received by Bob with probability $\\eta$ and lost with probability $1-\\eta$. Bob uses two ideal detectors: $D_0$ for state $|0\\rangle$ and $D_1$ for $|1\\rangle$. Each detector has a dark count probability $p_d$, and dark counts are independent.\n\n**Case 1: Photon is received (probability $\\eta$)**\n- The photon is directed to $D_0$ (since Alice sent '0'), so $D_0$ fires.\n- For a valid event, exactly one detector must fire. This means $D_1$ must not fire from a dark count.\n- Probability of valid, correct detection: The photon arrives ($\\eta$), and $D_1$ does not have a dark count ($1-p_d$). So, $P(\\text{valid, correct | received}) = \\eta(1-p_d)$.\n- An error is not possible in this case, because a valid event requires $D_0$ to fire.\n\n**Case 2: Photon is lost (probability $1 - \\eta$)**\n- No photon arrives. Any detection is due to dark counts.\n- A valid detection occurs if exactly one detector fires due to a dark count.\n  - $D_0$ fires ($p_d$) and $D_1$ does not ($1-p_d$): This is a correct outcome. Probability is $(1-\\eta)p_d(1-p_d)$.\n  - $D_1$ fires ($p_d$) and $D_0$ does not ($1-p_d$): This is an error. Probability is $(1-\\eta)p_d(1-p_d)$.\n\n**Total probabilities**\nBy symmetry, the analysis is identical if Alice sends '1'. We can sum the probabilities for any given transmission:\n- Probability of a valid detection, $P_{\\text{valid}}$:\n  $$ P_{\\text{valid}} = \\underbrace{\\eta (1 - p_d)}_{\\text{Photon received, no D1 dark count}} + \\underbrace{(1 - \\eta) p_d (1 - p_d)}_{\\text{Photon lost, D0 dark count}} + \\underbrace{(1 - \\eta) p_d (1 - p_d)}_{\\text{Photon lost, D1 dark count}} $$\n  $$ P_{\\text{valid}} = \\eta(1-p_d) + 2(1-\\eta)p_d(1-p_d) = (1-p_d)[\\eta + 2(1-\\eta)p_d] $$\n\n- Probability of an error, $P_{\\text{error}}$: An error only occurs when the photon is lost and the \"wrong\" detector has a dark count while the \"correct\" one does not.\n  $$ P_{\\text{error}} = (1-\\eta)p_d(1-p_d) $$\n\n**QBER calculation**\nThe QBER is the ratio of the error probability to the valid detection probability:\n$$ \\text{QBER} = \\frac{P_{\\text{error}}}{P_{\\text{valid}}} = \\frac{(1 - \\eta) p_d (1 - p_d)}{(1 - p_d)[\\eta + 2 (1 - \\eta) p_d]} $$\nAssuming $p_d  1$, we can cancel the $(1-p_d)$ term:\n$$ \\text{QBER} = \\frac{(1 - \\eta) p_d}{\\eta + 2(1 - \\eta) p_d} $$", "answer": "$$ \\boxed{\\dfrac{ (1-\\eta) p_d }{ \\eta + 2 (1-\\eta) p_d }} $$", "id": "143401"}, {"introduction": "To combat sophisticated attacks like the photon-number-splitting (PNS) attack, modern QKD systems employ the decoy-state method, turning a security vulnerability into a tool for channel characterization. This exercise [@problem_id:143224] frames the protocol design as an optimization problem, a common task in practical engineering. You will determine the optimal trade-off between using pulses to generate the raw key and using them as decoys to estimate security parameters, thereby maximizing the final secure key rate in a finite-key scenario.", "problem": "In a practical implementation of the BB84 quantum key distribution (QKD) protocol, Alice and Bob must contend with channel losses and the threat of sophisticated eavesdropping strategies, such as the photon-number-splitting (PNS) attack. To counteract the PNS attack and to securely estimate the channel parameters, the decoy-state method is employed. Alice sends a mixture of signal states and decoy states, which are chosen from the same basis states but have different mean photon numbers.\n\nConsider a decoy-state BB84 system where Alice sends a total of $N_{tot}$ pulses to Bob. A fraction $\\gamma$ of these pulses are designated as 'signal' states, intended for generating the raw key, while the remaining fraction $(1-\\gamma)$ are 'decoy' states, used for parameter estimation. The final number of secure key bits, $S$, depends critically on this allocation ratio $\\gamma$.\n\nFor a fixed total number of transmissions $N_{tot}$, a simplified but realistic model for the total secure key in the finite-key regime is given by:\n$$S(\\gamma) = K \\gamma - \\frac{B}{\\sqrt{1-\\gamma}}$$\nwhere $\\gamma \\in (0, 1)$.\n\nIn this model:\n- The term $K\\gamma$ represents the number of secret bits generated from the signal states in the asymptotic limit (i.e., for an infinitely long key). The positive constant $K$ encapsulates the total number of pulses, channel transmittance, detector efficiency, and the reconciled key rate for single-photon components.\n- The term $-\\frac{B}{\\sqrt{1-\\gamma}}$ represents the total reduction in the secret key length due to finite-key effects. The statistical uncertainty in the parameters estimated from the decoy states leads to a stricter security proof and a shorter final key. This penalty decreases as more decoy states are sent (i.e., as $(1-\\gamma)$ increases). The positive constant $B$ depends on the security parameter of the protocol and the total number of pulses $N_{tot}$.\n\nYour task is to find the optimal allocation ratio $\\gamma_{opt}$ that maximizes the total secure key $S(\\gamma)$. Assume that the constants $K$ and $B$ are such that the optimal value $\\gamma_{opt}$ lies strictly between 0 and 1. Express your answer as a closed-form expression in terms of the constants $K$ and $B$.", "solution": "To find the optimal allocation ratio $\\gamma_{\\text{opt}}$ that maximizes the secure key length $S(\\gamma) = K\\gamma - \\frac{B}{\\sqrt{1-\\gamma}}$, we take the first derivative of $S(\\gamma)$ with respect to $\\gamma$ and set it to zero.\n\nFirst, rewrite $S(\\gamma)$ using exponent notation:\n$$ S(\\gamma) = K\\gamma - B(1-\\gamma)^{-1/2} $$\nNow, we compute the derivative $\\frac{dS}{d\\gamma}$ using the power rule and the chain rule:\n$$ \\frac{dS}{d\\gamma} = \\frac{d}{d\\gamma}(K\\gamma) - \\frac{d}{d\\gamma}\\left(B(1-\\gamma)^{-1/2}\\right) $$\n$$ \\frac{dS}{d\\gamma} = K - B \\cdot \\left(-\\frac{1}{2}\\right)(1-\\gamma)^{-3/2} \\cdot (-1) $$\n$$ \\frac{dS}{d\\gamma} = K - \\frac{B}{2}(1-\\gamma)^{-3/2} $$\nSet the derivative to zero to find the critical point:\n$$ K - \\frac{B}{2}(1-\\gamma)^{-3/2} = 0 $$\nSolve for $\\gamma$:\n$$ K = \\frac{B}{2}(1-\\gamma)^{-3/2} $$\n$$ (1-\\gamma)^{-3/2} = \\frac{2K}{B} $$\nRaise both sides to the power of $-2/3$:\n$$ \\left((1-\\gamma)^{-3/2}\\right)^{-2/3} = \\left(\\frac{2K}{B}\\right)^{-2/3} $$\n$$ 1-\\gamma = \\left(\\frac{B}{2K}\\right)^{2/3} $$\nTherefore, the optimal ratio is:\n$$ \\gamma_{\\text{opt}} = 1 - \\left(\\frac{B}{2K}\\right)^{2/3} $$\nTo confirm this is a maximum, we compute the second derivative:\n$$ \\frac{d^2S}{d\\gamma^2} = \\frac{d}{d\\gamma} \\left( K - \\frac{B}{2}(1-\\gamma)^{-3/2} \\right) = -\\frac{B}{2} \\cdot \\left(-\\frac{3}{2}\\right)(1-\\gamma)^{-5/2} \\cdot (-1) = -\\frac{3B}{4}(1-\\gamma)^{-5/2} $$\nSince $B > 0$ and we are given that $\\gamma_{\\text{opt}} \\in (0,1)$, the term $(1-\\gamma)^{-5/2}$ is positive. Thus, the second derivative is negative, confirming that our solution for $\\gamma_{\\text{opt}}$ is a maximum.", "answer": "$$\\boxed{1 - \\left( \\frac{B}{2K} \\right)^{\\frac{2}{3}}}$$", "id": "143224"}]}