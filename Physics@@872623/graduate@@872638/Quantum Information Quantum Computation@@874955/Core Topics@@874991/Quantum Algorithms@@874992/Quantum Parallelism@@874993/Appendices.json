{"hands_on_practices": [{"introduction": "The core of quantum parallelism lies in an oracle's ability to act on a superposition of all inputs simultaneously. This exercise [@problem_id:125408] provides a foundational example, walking through the direct application of a parallel oracle to a simple two-qubit superposition. By calculating the probability of a specific outcome, you will see how the function is evaluated for all possible inputs in a single step, with the results encoded into the state of the system.", "problem": "A 4-qubit quantum system is composed of two 2-qubit registers: an input register and an output register. The state of the system is described in the Hilbert space $\\mathcal{H} = (\\mathbb{C}^2)^{\\otimes 2} \\otimes (\\mathbb{C}^2)^{\\otimes 2}$. The computational basis for a single qubit is $\\{|0\\rangle, |1\\rangle\\}$.\n\nThe system is initialized in the state $|\\psi_{in}\\rangle = |+\\rangle^{\\otimes 2} \\otimes |0\\rangle^{\\otimes 2}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ and $|0\\rangle^{\\otimes 2} = |00\\rangle$.\n\nA quantum oracle, represented by the unitary operator $U_f$, is applied to the system. This oracle evaluates the classical function $f: \\{0,1\\}^2 \\to \\{0,1\\}^2$ defined by:\n$$f(x_1, x_2) = (x_1, x_1 \\oplus x_2)$$\nwhere $\\oplus$ denotes addition modulo 2 (XOR). The action of the oracle on the computational basis states $|x_1 x_2\\rangle|y_1 y_2\\rangle$ is given by:\n$$U_f |x_1 x_2\\rangle |y_1 y_2\\rangle = |x_1 x_2\\rangle |y_1 \\oplus f_1(x_1, x_2), y_2 \\oplus f_2(x_1, x_2)\\rangle$$\nwhere $f_1$ and $f_2$ are the two components of the function $f$.\n\nAfter the oracle $U_f$ is applied to the initial state $|\\psi_{in}\\rangle$, a measurement in the computational basis is performed on the output register (the last two qubits). Calculate the probability of obtaining the outcome $|11\\rangle$.", "solution": "1. The initial state is\n$$|\\psi_{in}\\rangle = |+\\rangle^{\\otimes2}\\otimes|00\\rangle\n=\\bigl(\\tfrac1{\\sqrt2}(|0\\rangle+|1\\rangle)\\bigr)^{\\otimes2}\\otimes|00\\rangle\n=\\frac1{2}\\sum_{x_1,x_2\\in\\{0,1\\}}|x_1x_2\\rangle\\otimes|00\\rangle.$$\n\n2. The oracle action is \n$$U_f\\,|x_1x_2\\rangle|y_1y_2\\rangle\n=|x_1x_2\\rangle\\,|y_1\\oplus f_1(x_1,x_2),\\,y_2\\oplus f_2(x_1,x_2)\\rangle,$$\nwith $f(x_1,x_2)=(x_1,\\;x_1\\oplus x_2)$.\n\n3. Applying $U_f$ to $|\\psi_{in}\\rangle$ gives\n$$|\\psi_{\\rm out}\\rangle\n=\\frac1{2}\\sum_{x_1,x_2}|x_1x_2\\rangle\\,|f(x_1,x_2)\\rangle.$$\n\n4. We measure the last two qubits and want the outcome $|11\\rangle$.  This occurs only if\n$$f(x_1,x_2)=(1,1)\\quad\\Longrightarrow\\quad x_1=1,\\;x_1\\oplus x_2=1\n\\;\\Rightarrow\\;x_2=0.$$\nThus exactly one term $|10\\rangle|11\\rangle$ contributes, with amplitude $1/2$.\n\n5. The probability of $|11\\rangle$ on the output register is\n$$P(11)=\\bigl|\\tfrac1{2}\\bigr|^2=\\tfrac14.$$", "answer": "$$\\boxed{\\frac14}$$", "id": "125408"}, {"introduction": "Building on the basic mechanism, we now explore how quantum algorithms harness the results of parallel function evaluation through interference. The Bernstein-Vazirani algorithm is a canonical example, ideally yielding a secret string with certainty after a single query. This problem [@problem_id:125316] introduces a subtle flaw in the oracle, allowing you to investigate how a single imperfection in the parallel computation disrupts the delicate interference pattern and impacts the algorithm's success probability.", "problem": "The Bernstein-Vazirani (BV) algorithm is a quantum algorithm that provides a dramatic example of quantum parallelism. It solves the problem of finding a secret $n$-bit string $s = s_{n-1}s_{n-2}...s_0$. The access to the secret string is provided by a function oracle $f_s: \\{0,1\\}^n \\to \\{0,1\\}$ defined by the bitwise inner product $f_s(x) = s \\cdot x \\pmod 2$.\n\nThe standard BV algorithm uses a quantum circuit with $n$ qubits for the input register and one ancillary qubit for the output. The circuit proceeds as follows:\n1. Initialize the $n$ input qubits to $|0\\rangle^{\\otimes n}$ and the ancillary qubit to $|1\\rangle$.\n2. Apply a Hadamard gate ($H$) to all $n+1$ qubits. This prepares the input register in a uniform superposition $\\frac{1}{\\sqrt{2^n}}\\sum_{x \\in \\{0,1\\}^n}|x\\rangle$ and the ancilla in the state $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$.\n3. Apply the quantum oracle $U_f$, which maps $|x\\rangle|y\\rangle$ to $|x\\rangle|y \\oplus f_s(x)\\rangle$. The choice of $|-\\rangle$ for the ancilla cleverly turns this into a phase oracle, which applies a phase to the input register: $U_f(|x\\rangle \\otimes |-\\rangle) = (-1)^{f_s(x)}|x\\rangle \\otimes |-\\rangle$.\n4. Apply a Hadamard gate $H^{\\otimes n}$ to the input register.\n5. Measure the input register in the computational basis. In a perfect execution, the measurement outcome is exactly the secret string $s$.\n\nConsider a 3-qubit ($n=3$) implementation of the BV algorithm designed to find the secret string $s=110$. However, the phase oracle is faulty. For a single computational basis state $|x_0\\rangle = |101\\rangle$, the oracle fails to apply the phase and acts as the identity operator. For all other basis states $|x\\rangle \\neq |101\\rangle$, the oracle operates correctly. That is, the faulty oracle $U_f'$ acts on the input register states as:\n$$\nU_f' |x\\rangle = \\begin{cases}\n    (-1)^{s \\cdot x} |x\\rangle, & \\text{if } x \\neq 101 \\\\\n    |x\\rangle, & \\text{if } x = 101\n\\end{cases}\n$$\nAssuming the rest of the algorithm is performed flawlessly, calculate the probability of measuring the correct secret string $s=110$.", "solution": "We have $n=3$, secret string $s=110$, and the faulty oracle acts as \n$$\n\\alpha_x = \\begin{cases}\n(-1)^{s\\cdot x},&x\\neq x_0=101,\\\\\n1,&x=x_0.\n\\end{cases}\n$$\n1. After the first Hadamards the input register is\n$$\n|\\psi_1\\rangle=\\frac1{\\sqrt{2^3}}\\sum_{x\\in\\{0,1\\}^3}|x\\rangle.\n$$\n2. After the faulty phase oracle,\n$$\n|\\psi_2\\rangle=\\frac1{\\sqrt{8}}\\sum_{x}\\alpha_x|x\\rangle.\n$$\n3. Applying $H^{\\otimes3}$ gives amplitudes\n$$\nA(y)=\\langle y|\\psi_3\\rangle\n=\\frac1{2^3}\\sum_{x}\\alpha_x\\,(-1)^{x\\cdot y}.\n$$\n4. Separate out the faulty term $x_0=101$:\n\n$$\n\\sum_{x}\\alpha_x(-1)^{x\\cdot y}\n=\\sum_{x}(-1)^{s\\cdot x}(-1)^{x\\cdot y}\n\\;+\\;\\bigl[1-(-1)^{s\\cdot x_0}\\bigr](-1)^{x_0\\cdot y}.\n$$\n\nThe first sum is the ideal BV result:\n$$\n\\sum_{x}(-1)^{s\\cdot x+x\\cdot y}\n=\\sum_{x}(-1)^{x\\cdot(s\\oplus y)}\n=2^3\\,\\delta_{y,s}.\n$$\nDefine $\\Delta=1-(-1)^{s\\cdot x_0}$. Thus\n$$\nA(y)\n=\\delta_{y,s}\n\\;+\\;\\frac{\\Delta}{8}(-1)^{x_0\\cdot y}.\n$$\n5. For $y=s=110$ and $x_0=101$, compute\n$$\ns\\cdot x_0=1\\cdot1+1\\cdot0+0\\cdot1\\equiv1\\pmod2,\n\\quad\n(-1)^{s\\cdot x_0}=-1,\n\\quad\n\\Delta=1-(-1)=2,\n$$\nand\n$$\n(-1)^{x_0\\cdot s}=(-1)^{1}=-1.\n$$\nHence\n$$\nA(s)=1+\\frac{2}{8}(-1)\n=1-\\tfrac14=\\tfrac34,\n\\qquad\nP(s)=|A(s)|^2=\\bigl(\\tfrac34\\bigr)^2=\\tfrac{9}{16}.\n$$", "answer": "$$\\boxed{\\tfrac{9}{16}}$$", "id": "125316"}, {"introduction": "Quantum parallelism doesn't just enable finding a single answer; it creates complex final states whose global properties can reveal information about the function. This exercise [@problem_id:125266] moves beyond simple outcome probabilities to the calculation of an expectation value—the total magnetization—after a parallel oracle has marked specific states in a superposition. This practice demonstrates a more sophisticated analysis common in quantum algorithms, where information is extracted from the collective behavior of the qubits rather than a single measurement outcome.", "problem": "An $n$-qubit register is used to perform a quantum computation. The register is initialized in the state $|0\\rangle^{\\otimes n}$. The following sequence of operations is then applied:\n\n1.  A layer of Hadamard gates ($H^{\\otimes n}$) is applied to the register. A single Hadamard gate acts on a qubit as $H = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$.\n2.  A phase oracle, $U_f$, is applied. This oracle marks computational basis states $|x\\rangle = |x_1x_2\\dots x_n\\rangle$ where the Hamming weight of the bit string $x$ is exactly one. The Hamming weight, $w(x)$, is the number of 1s in the string $x$. The action of the oracle is defined as $U_f|x\\rangle = (-1)^{f(x)}|x\\rangle$, where $f(x)=1$ if $w(x)=1$ and $f(x)=0$ otherwise.\n3.  A second layer of Hadamard gates ($H^{\\otimes n}$) is applied to the register.\n\nLet the final state of the register be $|\\psi_f\\rangle$. Your task is to compute the total magnetization of the final state, which is defined as the expectation value of the operator $M = \\frac{1}{n}\\sum_{i=1}^n Z_i$, where $Z_i$ is the Pauli-Z operator acting on the $i$-th qubit. Express your answer as a function of $n$.", "solution": "We denote the input register state by $|0\\rangle^{\\otimes n}$.  Define the phase‐flipped function \n$$g(x)=(-1)^{f(x)},\\qquad f(x)=\\begin{cases}1,&w(x)=1,\\\\0,&\\text{else,}\\end{cases}$$ \nso $g(x)=-1$ if $w(x)=1$ and $g(x)=+1$ otherwise.  \n\n1. After the first Hadamard layer\n$$|\\psi_1\\rangle=H^{\\otimes n}|0\\rangle^{\\otimes n}\n=\\frac1{\\sqrt{2^n}}\\sum_{x\\in\\{0,1\\}^n}|x\\rangle\\,.$$\n2. After the phase oracle,\n$$|\\psi_2\\rangle\n=\\frac1{\\sqrt{2^n}}\\sum_xg(x)\\,|x\\rangle.$$\n3. After the second Hadamard layer the amplitude of $|z\\rangle$ is\n$$a_z=\\langle z|\\psi_f\\rangle\n=\\frac1{2^n}\\sum_{x}g(x)(-1)^{x\\cdot z}\\,.$$\nHence the final state is $|\\psi_f\\rangle=\\sum_za_z|z\\rangle\\,$.  \n\n4. The expectation of the magnetization operator \n$M=\\frac1n\\sum_{i=1}^nZ_i$ reduces by symmetry to\n$$\\langle M\\rangle\n=\\langle Z_1\\rangle\n=\\sum_z|a_z|^2(-1)^{z_1}\n=\\frac1{4^n}\\sum_{x,x'}g(x)g(x')\\sum_z(-1)^{z\\cdot(x+x'+e_1)}.$$\nUsing $\\sum_z(-1)^{z\\cdot K}=2^n\\delta_{K,0}$ one finds\n$$\\langle Z_1\\rangle\n=\\frac1{2^n}\\sum_xg(x)\\,g(x\\oplus e_1)\n=\\frac1{2^n}\\sum_x(-1)^{f(x)+f(x\\oplus e_1)}.$$\n\n5.  Split the sum over $x_1=0,1$ and let $u=\\sum_{i=2}^n x_i$.  One checks\nfor each $x_1$ that exactly $n$ terms give $(-1)$ and $2^{n-1}-n$ terms give $(+1)$.\nHence\n$$\\sum_x(-1)^{f(x)+f(x\\oplus e_1)}=2\\bigl(2^{\\,n-1}-2n\\bigr)\n=2^n-4n.$$\nTherefore\n$$\\langle M\\rangle\n=1-\\frac{4n}{2^n}\\,. $$", "answer": "$$\\boxed{1-\\frac{4n}{2^n}}$$", "id": "125266"}]}