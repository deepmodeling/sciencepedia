{"hands_on_practices": [{"introduction": "The power of Grover's algorithm begins with the oracle, a \"black box\" that uniquely identifies the target state. This exercise demystifies the oracle by tasking you with its construction from fundamental quantum gates. Building an oracle for a specific marked state, as detailed in this problem [@problem_id:1426395], is the first and most crucial problem-specific step in designing any quantum search.", "problem": "In the development of a quantum search algorithm for a 3-qubit system, a key component is the \"oracle\" operator, $U_w$. This operator is designed to identify a specific \"marked\" computational basis state, $|w\\rangle$, by applying a phase shift of $-1$ to it, while leaving all other basis states unchanged. The action of the oracle is formally described by the transformation $U_w|x\\rangle = (-1)^{f(x)}|x\\rangle$, where $f(x)=1$ if the input state $|x\\rangle$ is the marked state $|w\\rangle$, and $f(x)=0$ otherwise.\n\nConsider a 3-qubit register where the qubits are indexed from right to left, such that a general basis state is written as $|q_2 q_1 q_0\\rangle$. The marked state for our search problem is $|w\\rangle = |110\\rangle$.\n\nYou are provided with a library of elementary quantum gates to construct the oracle. This library includes:\n1.  A single-qubit Pauli-X gate, denoted as $X_k$, which acts on qubit $k$. This gate flips the state of the qubit, such that $X_k|0\\rangle = |1\\rangle$ and $X_k|1\\rangle = |0\\rangle$.\n2.  A three-qubit doubly-controlled-Z gate, denoted as $CCZ_{i,j,k}$. This gate applies a Pauli-Z gate to a target qubit $k$ if and only if both control qubits $i$ and $j$ are in the state $|1\\rangle$. The Pauli-Z gate applies a phase flip to the $|1\\rangle$ state ($Z|1\\rangle = -|1\\rangle$) and leaves the $|0\\rangle$ state unchanged ($Z|0\\rangle = |0\\rangle$). Consequently, the $CCZ_{i,j,k}$ gate applies a phase of $-1$ only to the basis state where qubits $i, j, k$ are all $|1\\rangle$.\n\nGate sequences are written in the order of application from right to left. For example, the sequence $A \\cdot B \\cdot C$ means that gate $C$ is applied first, followed by gate $B$, and finally gate $A$.\n\nWhich of the following gate sequences correctly implements the required oracle for the marked state $|w\\rangle = |110\\rangle$?\n\nA. $CCZ_{2,1,0}$\n\nB. $X_0 \\cdot CCZ_{2,1,0} \\cdot X_0$\n\nC. $X_2 \\cdot CCZ_{2,1,0} \\cdot X_2$\n\nD. $X_1 \\cdot CCZ_{2,1,0} \\cdot X_1$\n\nE. $X_2 \\cdot X_1 \\cdot CCZ_{2,1,0} \\cdot X_1 \\cdot X_2$", "solution": "We require an oracle $U_{w}$ that acts on computational basis states as\n$$\nU_{w}|q_{2}q_{1}q_{0}\\rangle =\n\\begin{cases}\n-\\,|q_{2}q_{1}q_{0}\\rangle, & \\text{if } |q_{2}q_{1}q_{0}\\rangle=|110\\rangle,\\\\\n\\;\\;|q_{2}q_{1}q_{0}\\rangle, & \\text{otherwise}.\n\\end{cases}\n$$\nEquivalently, for bit values $q_{k}\\in\\{0,1\\}$, this is\n$U_{w}|q_{2}q_{1}q_{0}\\rangle = (-1)^{q_{2}q_{1}(1-q_{0})}|q_{2}q_{1}q_{0}\\rangle,$\nso only the state with $q_{2}=1$, $q_{1}=1$, $q_{0}=0$ acquires a phase of $-1$.\n\nThe available $CCZ_{2,1,0}$ gate applies a phase $-1$ only to $|111\\rangle$, i.e.,\n$CCZ_{2,1,0}|q_{2}q_{1}q_{0}\\rangle = (-1)^{q_{2}q_{1}q_{0}}|q_{2}q_{1}q_{0}\\rangle.$\nTo shift the marked pattern from $|111\\rangle$ to $|110\\rangle$, we conjugate $CCZ_{2,1,0}$ by $X_{0}$, flipping the third qubit (the target) before and after:\n$$\nU := X_{0}\\cdot CCZ_{2,1,0}\\cdot X_{0}.\n$$\nActing on a general basis state,\n1) The rightmost $X_{0}$ maps $|q_{2}q_{1}q_{0}\\rangle$ to $|q_{2}q_{1}\\bar{q}_{0}\\rangle$ with $\\bar{q}_{0}=1-q_{0}$.\n2) Then $CCZ_{2,1,0}$ contributes a phase $-1$ if and only if $q_{2}=1$, $q_{1}=1$, and $\\bar{q}_{0}=1$, i.e., precisely when $q_{2}=1$, $q_{1}=1$, $q_{0}=0$.\n3) The leftmost $X_{0}$ restores the third qubit, yielding the original basis state and the intended phase.\n\nHence\n$\\left(X_{0}\\cdot CCZ_{2,1,0}\\cdot X_{0}\\right)|q_{2}q_{1}q_{0}\\rangle\n= (-1)^{q_{2}q_{1}(1-q_{0})}|q_{2}q_{1}q_{0}\\rangle,$\nwhich is exactly the desired oracle for the marked state $|110\\rangle$.\n\nVerification of other options:\n- $CCZ_{2,1,0}$ alone marks $|111\\rangle$, not $|110\\rangle$.\n- $X_{2}\\cdot CCZ_{2,1,0}\\cdot X_{2}$ marks states with $q_{2}=0$, $q_{1}=1$, $q_{0}=1$, i.e., $|011\\rangle$.\n- $X_{1}\\cdot CCZ_{2,1,0}\\cdot X_{1}$ marks $|101\\rangle$.\n- $X_{2}\\cdot X_{1}\\cdot CCZ_{2,1,0}\\cdot X_{1}\\cdot X_{2}$ marks $|001\\rangle$.\n\nTherefore, the correct sequence is $X_{0}\\cdot CCZ_{2,1,0}\\cdot X_{0}$, which is option B.", "answer": "$$\\boxed{B}$$", "id": "1426395"}, {"introduction": "After the oracle marks the target state with a phase, this change is not yet an increased probability of measurement. The second key component of the algorithm, the Grover diffusion operator, is needed to amplify this phase into a large amplitude. This practice [@problem_id:1426368] focuses on constructing the matrix representation of this operator, helping to solidify its geometric interpretation as an \"inversion about the mean,\" the engine that drives the amplification process.", "problem": "In the study of quantum algorithms, Grover's algorithm provides a significant speedup for searching an unstructured database. A key component of this algorithm is the Grover diffusion operator, often described as an \"inversion about the mean\" operation. This operator, denoted by $G$, is crucial for amplifying the amplitude of the target state.\n\nConsider a quantum register composed of 2 qubits. The state of this system can be described in a 4-dimensional Hilbert space. The Grover diffusion operator $G$ is defined by the expression:\n$$G = 2|s\\rangle\\langle s| - I$$\nwhere $I$ is the identity operator, and $|s\\rangle$ is the normalized, uniform superposition of all computational basis states.\n\nDetermine the matrix representation of the Grover diffusion operator $G$ for this 2-qubit system. Your representation should be in the standard computational basis, ordered as $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$.", "solution": "For a 2-qubit register, the Hilbert space dimension is $N=2^{2}=4$. The normalized uniform superposition over the computational basis $\\{|00\\rangle,|01\\rangle,|10\\rangle,|11\\rangle\\}$ is\n$$\n|s\\rangle=\\frac{1}{\\sqrt{N}}\\sum_{x\\in\\{00,01,10,11\\}}|x\\rangle=\\frac{1}{2}\\left(|00\\rangle+|01\\rangle+|10\\rangle+|11\\rangle\\right),\n$$\nwhich satisfies $\\langle s|s\\rangle=1$ because\n$$\n\\langle s|s\\rangle=\\left(\\frac{1}{2}\\right)^{2}\\sum_{x,y}\\langle x|y\\rangle=\\frac{1}{4}\\cdot 4=1.\n$$\nThe rank-one projector onto $|s\\rangle$ is\n$$\n|s\\rangle\\langle s|=\\left(\\frac{1}{2}\\right)^{2}\\sum_{x,y}|x\\rangle\\langle y|=\\frac{1}{4}\\sum_{x,y}|x\\rangle\\langle y|,\n$$\nwhich, in the ordered basis $\\{|00\\rangle,|01\\rangle,|10\\rangle,|11\\rangle\\}$, is the $4\\times 4$ matrix with every entry equal to $\\frac{1}{4}$. Therefore,\n$$\n2|s\\rangle\\langle s|=\\frac{1}{2}\\begin{pmatrix}\n1 & 1 & 1 & 1\\\\\n1 & 1 & 1 & 1\\\\\n1 & 1 & 1 & 1\\\\\n1 & 1 & 1 & 1\n\\end{pmatrix}.\n$$\nBy definition, the Grover diffusion operator is $G=2|s\\rangle\\langle s|-I$, where $I$ is the $4\\times 4$ identity. Subtracting $I$ yields\n$$\nG=\\begin{pmatrix}\n\\frac{1}{2}-1 & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & \\frac{1}{2}-1 & \\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}-1 & \\frac{1}{2}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}-1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2}\n\\end{pmatrix}.\n$$\nThis matrix acts as $G|s\\rangle=|s\\rangle$ and as $-I$ on the subspace orthogonal to $|s\\rangle$, implementing inversion about the mean.", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2}\n\\end{pmatrix}}$$", "id": "1426368"}, {"introduction": "With the oracle to mark the target and the diffusion operator to amplify it, a crucial question remains: how many times should this two-step process be repeated? Contrary to intuition, more iterations are not always better, and \"overshooting\" the target is a real possibility. This exercise [@problem_id:1426405] addresses the practical task of calculating the optimal number of Grover iterations to maximize the success probability, a vital step for ensuring the algorithm's efficiency.", "problem": "A cybersecurity team is using a quantum computer to search for vulnerabilities in a cryptographic system. The total search space consists of $N = 2^{10}$ possible configurations. Due to a design flaw, it is known that exactly $M=4$ of these configurations are \"weak\" and will compromise the system's security if found. The team employs Grover's search algorithm to find one of these weak configurations.\n\nIn Grover's algorithm, a sequence of quantum operations, collectively known as a \"Grover iteration,\" is applied repeatedly to a quantum state. After a certain number of iterations, a measurement is performed. The probability of measuring a weak configuration depends on the number of iterations performed.\n\nDetermine the optimal number of Grover iterations, $k$, that the team should perform to have the highest probability of identifying a weak configuration upon measurement. The number of iterations must be an integer.", "solution": "Let $N$ be the total number of items and $M$ the number of marked (weak) items. In Groverâ€™s algorithm, define the angle $\\theta$ by\n$$\n\\sin(\\theta)=\\sqrt{\\frac{M}{N}}.\n$$\nAfter $k$ Grover iterations, the success probability is\n$$\nP(k)=\\sin^{2}\\big((2k+1)\\theta\\big).\n$$\nThis is maximized when $(2k+1)\\theta$ is as close as possible to $\\frac{\\pi}{2}$, which yields the optimal iteration count\n$k^{\\ast}=\\left\\lfloor \\frac{\\pi}{4\\theta}-\\frac{1}{2}\\right\\rfloor.$\nFor the given values $N=2^{10}$ and $M=4$,\n$$\n\\sqrt{\\frac{M}{N}}=\\sqrt{\\frac{4}{2^{10}}}=\\sqrt{\\frac{1}{256}}=\\frac{1}{16},\n$$\nso\n$$\n\\theta=\\arcsin\\!\\left(\\frac{1}{16}\\right).\n$$\nThus,\n$$\nk^{\\ast}=\\left\\lfloor \\frac{\\pi}{4\\arcsin\\!\\left(\\frac{1}{16}\\right)}-\\frac{1}{2}\\right\\rfloor.\n$$\nTo select the correct integer, evaluate approximately. Using the series for $\\arcsin(x)$ at $x=\\frac{1}{16}$,\n$$\n\\arcsin(x)=x+\\frac{x^{3}}{6}+\\frac{3x^{5}}{40}+\\frac{5x^{7}}{112}+\\cdots,\n$$\ngives\n$$\n\\theta=\\arcsin\\!\\left(\\frac{1}{16}\\right)\\approx 0.062540761796,\n$$\nhence\n$$\n\\frac{\\pi}{4\\theta}\\approx \\frac{3.141592653589793}{4\\times 0.062540761796}\\approx 12.5581803,\n$$\nand so\n$$\n\\frac{\\pi}{4\\theta}-\\frac{1}{2}\\approx 12.0581803.\n$$\nTaking the floor yields $k^{\\ast}=12$. Equivalently, using the common approximation $k\\approx \\left\\lfloor \\frac{\\pi}{4}\\sqrt{\\frac{N}{M}} \\right\\rfloor$ gives $\\left\\lfloor \\frac{\\pi}{4}\\cdot 16 \\right\\rfloor=\\left\\lfloor 4\\pi \\right\\rfloor=12$, consistent with the more accurate computation.", "answer": "$$\\boxed{12}$$", "id": "1426405"}]}