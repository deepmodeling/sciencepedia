{"hands_on_practices": [{"introduction": "The geometric interpretation of Grover's algorithm beautifully simplifies its dynamics into a rotation within a two-dimensional plane. This exercise connects this geometric picture to a physically meaningful quantity: the expectation value of the oracle operator, which indicates the state's alignment with the oracle's eigenspaces. By calculating how this value evolves with each iteration [@problem_id:88187], you will gain a deeper intuition for the state's periodic journey towards and away from the target state.", "problem": "Grover's search algorithm provides a quadratic speedup for unstructured search problems. The core of the algorithm is an iterative process that amplifies the amplitude of a marked quantum state within a larger state space.\n\nConsider a quantum system with an $N$-dimensional Hilbert space, spanned by an orthonormal computational basis $\\{|x\\rangle\\}_{x=0}^{N-1}$. The task is to find a single marked state, denoted by $|\\omega\\rangle$, from this basis. The algorithm starts in a uniform superposition of all basis states, $|s\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$.\n\nEach iteration of the algorithm consists of applying the Grover operator, $G$, to the state of the system. The Grover operator is a product of two unitary operators, $G = U_s U_\\omega$, where:\n1.  The oracle operator, $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$, flips the phase of the marked state $|\\omega\\rangle$. Here, $I$ is the identity operator.\n2.  The diffusion operator, $U_s = 2|s\\rangle\\langle s| - I$, reflects the state about the initial state $|s\\rangle$.\n\nAfter $k$ iterations, the system is in the state $|\\psi_k\\rangle = G^k |s\\rangle$.\n\nYour task is to compute the expectation value of the oracle operator $U_\\omega$ with respect to the state $|\\psi_k\\rangle$. This quantity, $\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$, provides insight into how the state aligns with the eigenspaces of the oracle as the algorithm progresses.\n\nExpress your answer as a function of the number of items $N$ and the number of iterations $k$.", "solution": "To compute the expectation value $\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$, we work in the two-dimensional subspace spanned by the marked state $|\\omega\\rangle$ and a state $|\\alpha\\rangle$ representing the superposition of all unmarked states.\n\nLet $\\theta = \\arcsin(1/\\sqrt{N})$. The initial state $|s\\rangle$ can be written as:\n$$ |s\\rangle = \\sin\\theta \\, |\\omega\\rangle + \\cos\\theta \\, |\\alpha\\rangle $$\nwhere $|\\alpha\\rangle$ is a normalized state orthogonal to $|\\omega\\rangle$.\n\nThe Grover operator $G$ rotates the state in this plane by an angle of $2\\theta$ per iteration. After $k$ iterations, the state is:\n$$ |\\psi_k\\rangle = \\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle $$\nThe oracle operator is $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$. Applying it to $|\\psi_k\\rangle$ gives:\n$$ U_\\omega |\\psi_k\\rangle = -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle $$\nNow we compute the expectation value $\\langle \\psi_k | U_\\omega | \\psi_k \\rangle$. Using the orthonormality of $|\\omega\\rangle$ and $|\\alpha\\rangle$:\n$$\n\\begin{aligned}\n\\langle \\psi_k | U_\\omega | \\psi_k \\rangle = \\left( \\sin((2k+1)\\theta) \\, \\langle\\omega| + \\cos((2k+1)\\theta) \\, \\langle\\alpha| \\right) \\left( -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle \\right) \\\\\n= -\\sin^2((2k+1)\\theta) + \\cos^2((2k+1)\\theta) \\\\\n= \\cos(2(2k+1)\\theta)\n\\end{aligned}\n$$\nwhere we used the identity $\\cos(2\\phi) = \\cos^2\\phi - \\sin^2\\phi$. Substituting $\\theta = \\arcsin(1/\\sqrt{N})$:\n$$ \\langle U_\\omega \\rangle_k = \\cos\\left(2(2k+1) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right) = \\cos\\left((4k+2) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right) $$", "answer": "$$\n\\boxed{ \\cos\\left( (4k+2) \\arcsin\\left( \\frac{1}{\\sqrt{N}} \\right) \\right) }\n$$", "id": "88187"}, {"introduction": "Real-world quantum computers are susceptible to noise, and imperfect state preparation is a common challenge. This practice problem models a realistic scenario where the initial state is not a perfect uniform superposition but has \"leaked\" into a state outside the standard Grover subspace [@problem_id:88215]. Analyzing this situation will illuminate how such errors affect the algorithm's maximum success probability, offering crucial insights into the performance and robustness of Grover's search on near-term hardware.", "problem": "Consider Grover's search algorithm for a single marked item $|w\\rangle$ in a database of $N$ items. The algorithm operates in an $N$-dimensional Hilbert space $\\mathcal{H}$. The standard algorithm evolves states within a 2D subspace $\\mathcal{H}_G$ spanned by the target state $|w\\rangle$ and the uniform superposition state $|\\psi_{\\text{unif}}\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{i=0}^{N-1}|i\\rangle$.\n\nSuppose that due to an imperfection in state preparation, the initial state $|\\psi_0\\rangle$ is not the perfect uniform superposition. Instead, it is a pure state with a fidelity $F=|\\langle \\psi_{\\text{unif}} | \\psi_0 \\rangle|^2 = 1-\\epsilon^2$ with respect to $|\\psi_{\\text{unif}}\\rangle$, where $0  \\epsilon  1$ is a small parameter. The imperfection is modeled as a leakage of amplitude into a state $|\\psi_{\\text{leak}}\\rangle$ which is normalized and lies in the subspace $\\mathcal{H}_G^\\perp$, the orthogonal complement of $\\mathcal{H}_G$. Specifically, the initial state is given by\n$$\n|\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle\n$$\nwhere we assume $\\epsilon$ is real and positive.\n\nThe search is performed by applying the standard Grover operator $G = U_{\\psi_{\\text{unif}}} U_w$, where $U_w = I-2|w\\rangle\\langle w|$ is the oracle and $U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$ is the diffusion operator.\n\nAssume that the size of the database $N$ is such that for an ideal search (starting from $|\\psi_{\\text{unif}}\\rangle$), there exists an optimal integer number of iterations, denoted $k_{\\text{opt}}$, that finds the marked state $|w\\rangle$ with probability 1.\n\nCalculate the success probability of finding the state $|w\\rangle$ if we run the algorithm on the imperfect initial state $|\\psi_0\\rangle$ for this same optimal number of iterations $k_{\\text{opt}}$.", "solution": "The initial state is given by:\n$$ |\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle $$\nwhere $|\\psi_{\\text{leak}}\\rangle$ is normalized and lies in $\\mathcal{H}_G^\\perp$, the orthogonal complement of the 2D search subspace $\\mathcal{H}_G$. This means $\\langle w | \\psi_{\\text{leak}} \\rangle = 0$ and $\\langle \\psi_{\\text{unif}} | \\psi_{\\text{leak}} \\rangle = 0$.\n\nThe Grover operator is $G = U_{\\psi_{\\text{unif}}} U_w$. We analyze its action on a vector $|v\\rangle \\in \\mathcal{H}_G^\\perp$.\n1.  Since $\\langle w | v \\rangle = 0$, the oracle $U_w = I - 2|w\\rangle\\langle w|$ acts as the identity: $U_w |v\\rangle = |v\\rangle$.\n2.  Since $\\langle \\psi_{\\text{unif}} | v \\rangle = 0$, the diffusion operator $U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$ acts as a sign flip: $U_{\\psi_{\\text{unif}}}|v\\rangle = -|v\\rangle$.\n\nTherefore, the Grover operator acts as $G|v\\rangle = U_{\\psi_{\\text{unif}}} U_w |v\\rangle = U_{\\psi_{\\text{unif}}}|v\\rangle = -|v\\rangle$. This means any component of the state in the orthogonal subspace $\\mathcal{H}_G^\\perp$ simply flips its sign at each iteration. After $k$ iterations, $G^k |v\\rangle = (-1)^k |v\\rangle$.\n\nThe state after $k_{\\text{opt}}$ iterations is found by applying $G^{k_{\\text{opt}}}$ to $|\\psi_0\\rangle$:\n$$ |\\psi_{k_{\\text{opt}}}\\rangle = G^{k_{\\text{opt}}} |\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle + \\epsilon G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle $$\nBy assumption, for the ideal search, $k_{\\text{opt}}$ iterations map the initial state to the target state: $G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle = |w\\rangle$. For the leakage component, we have $G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle = (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle$. Substituting these results gives:\n$$ |\\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle $$\nThe success probability is the squared magnitude of the overlap with the target state $|w\\rangle$:\n$$ P_{succ} = |\\langle w | \\psi_{k_{\\text{opt}}}\\rangle|^2 $$\nThe overlap is:\n$$ \\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\langle w | \\left( \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle \\right) = \\sqrt{1-\\epsilon^2} \\langle w | w \\rangle + \\epsilon (-1)^{k_{\\text{opt}}} \\langle w | \\psi_{\\text{leak}} \\rangle $$\nSince $\\langle w | w \\rangle = 1$ and $\\langle w | \\psi_{\\text{leak}} \\rangle = 0$, the overlap simplifies to:\n$$ \\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2} $$\nThe success probability is therefore:\n$$ P_{succ} = \\left( \\sqrt{1-\\epsilon^2} \\right)^2 = 1 - \\epsilon^2 $$", "answer": "$$ \\boxed{1 - \\epsilon^2} $$", "id": "88215"}, {"introduction": "The efficacy of the standard Grover algorithm stems from its two fixed reflections, one about the target state and one about the initial uniform superposition. This exercise challenges you to explore a fascinating variant where the diffusion operator is dynamic, reflecting the state about the result of the *previous* iteration [@problem_id:88288]. Solving this problem requires applying the principles of geometric reflections in a step-by-step context, providing a deeper appreciation for the specific structure that makes the standard algorithm so effective.", "problem": "In a quantum search problem over a space of $N$ items, we are given an oracle operator $U_w = I - 2|w\\rangle\\langle w|$ which marks a single state $|w\\rangle$. The standard Grover algorithm starts from the uniform superposition state $|s\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$ and iteratively applies the Grover operator $G = U_s U_w$, where $U_s = 2|s\\rangle\\langle s| - I$ is the diffusion operator that reflects about the initial state $|s\\rangle$.\n\nConsider a variation of this algorithm where the diffusion operator is updated at each step. Let $|\\psi_k\\rangle$ be the state of the system after $k$ iterations. The initial state is $|\\psi_0\\rangle = |s\\rangle$. For subsequent steps ($k \\ge 1$), the state is updated according to the rule\n$$|\\psi_k\\rangle = D_k U_w |\\psi_{k-1}\\rangle$$\nwhere the diffusion operator at step $k$, denoted by $D_k$, is a reflection about the state from the previous step, $|\\psi_{k-1}\\rangle$. That is,\n$$D_k = 2|\\psi_{k-1}\\rangle\\langle\\psi_{k-1}| - I$$\nCalculate the success probability, $P_{succ} = |\\langle w | \\psi_2 \\rangle|^2$, of measuring the marked state $|w\\rangle$ after two full iterations of this modified algorithm. Express your answer as a closed-form analytic expression in terms of $N$.", "solution": "We work in the two-dimensional subspace spanned by the marked state $|w\\rangle$ and an orthogonal state $|r\\rangle$ such that $|s\\rangle$ is in this plane.\nLet $\\alpha = \\langle w|s\\rangle = \\frac{1}{\\sqrt{N}}$ and $\\gamma = \\sqrt{1-\\alpha^2} = \\sqrt{1-\\frac{1}{N}}$.\nThe initial state is $|\\psi_0\\rangle = |s\\rangle = \\alpha|w\\rangle + \\gamma|r\\rangle$.\n\n1.  **First iteration ($k=1$)**:\n    The new state is $|\\psi_1\\rangle = D_1 U_w |\\psi_0\\rangle$, where $D_1 = 2|\\psi_0\\rangle\\langle\\psi_0| - I$. This is a standard Grover iteration. The resulting state is of the form $|\\psi_1\\rangle = A_1|w\\rangle+B_1|r\\rangle$, where the coefficients correspond to a rotation by $2\\theta$ (where $\\sin\\theta = \\alpha$):\n    $$ A_1 = \\sin(3\\theta) = \\alpha(3-4\\alpha^2) = \\frac{1}{\\sqrt{N}}\\left(3-\\frac{4}{N}\\right) = \\frac{3N-4}{N\\sqrt{N}} $$\n    $$ B_1 = \\cos(3\\theta) = \\gamma(1-4\\alpha^2) = \\sqrt{1-\\frac{1}{N}}\\left(1-\\frac{4}{N}\\right) = \\frac{(N-4)\\sqrt{N-1}}{N\\sqrt{N}} $$\n\n2.  **Second iteration ($k=2$)**:\n    The new state is $|\\psi_2\\rangle = D_2 U_w |\\psi_1\\rangle$, where $D_2 = 2|\\psi_1\\rangle\\langle\\psi_1| - I$. This is a reflection of the state $U_w|\\psi_1\\rangle$ about the axis $|\\psi_1\\rangle$.\n    $$ |\\psi_2\\rangle = 2\\langle \\psi_1|U_w|\\psi_1\\rangle |\\psi_1\\rangle - U_w|\\psi_1\\rangle $$\n    The success amplitude is the component along $|w\\rangle$:\n    $$ \\langle w|\\psi_2\\rangle = 2\\langle \\psi_1|U_w|\\psi_1\\rangle \\langle w|\\psi_1\\rangle - \\langle w|U_w|\\psi_1\\rangle $$\n    We compute the terms:\n    - $\\langle w|\\psi_1\\rangle = A_1$\n    - $U_w|\\psi_1\\rangle = -A_1|w\\rangle+B_1|r\\rangle$, so $\\langle w|U_w|\\psi_1\\rangle = -A_1$\n    - $\\langle \\psi_1|U_w|\\psi_1\\rangle = \\langle A_1 w + B_1 r | -A_1 w + B_1 r\\rangle = B_1^2 - A_1^2$\n    \n    Let $\\delta_2 = B_1^2 - A_1^2$. The amplitude is $\\langle w|\\psi_2\\rangle = 2\\delta_2 A_1 - (-A_1) = A_1(2\\delta_2 + 1)$.\n    \n    $$ \\delta_2 = B_1^2 - A_1^2 = \\frac{(N-4)^2(N-1)}{N^3} - \\frac{(3N-4)^2}{N^3} = \\frac{N^3-18N^2+48N-32}{N^3} $$\n    $$ 2\\delta_2+1 = \\frac{2(N^3-18N^2+48N-32)}{N^3} + 1 = \\frac{3N^3-36N^2+96N-64}{N^3} $$\n\n3.  **Final Probability**:\n    The success amplitude is:\n    $$ \\langle w|\\psi_2\\rangle = A_1(2\\delta_2+1) = \\left(\\frac{3N-4}{N\\sqrt{N}}\\right) \\left(\\frac{3N^3-36N^2+96N-64}{N^3}\\right) $$\n    The probability is its square:\n    $$ P_{succ} = |\\langle w|\\psi_2\\rangle|^2 = \\frac{(3N-4)^2 (3N^3-36N^2+96N-64)^2}{N^9} $$", "answer": "$$\\boxed{\\frac{(3N-4)^2(3N^3-36N^2+96N-64)^2}{N^9}}$$", "id": "88288"}]}