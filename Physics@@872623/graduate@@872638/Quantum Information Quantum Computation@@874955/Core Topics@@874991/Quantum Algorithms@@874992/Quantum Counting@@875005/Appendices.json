{"hands_on_practices": [{"introduction": "The power of quantum counting lies in its geometric interpretation: the algorithm measures the angle of rotation performed by the Grover operator. This first practice invites you to solidify your understanding of this core principle [@problem_id:115905]. By considering a search confined to a known subspace, you will see how the fundamental relationship between the number of solutions and the measured phase emerges directly from the geometry of the problem, reinforcing the foundational concepts of the algorithm.", "problem": "The Quantum Counting Algorithm (QCA) is designed to determine the number of marked items, $M$, within a search space of size $N$. It achieves this by performing Quantum Phase Estimation (QPE) on the Grover search operator, $G$. The standard QCA assumes the search is conducted over the entire computational basis of a Hilbert space $\\mathcal{H}$ of dimension $N$, starting from a uniform superposition over all basis states.\n\nConsider a modified scenario. We are given a Hilbert space $\\mathcal{H}$ of total dimension $N$. Within this space, there is a specific subspace $\\mathcal{S} \\subset \\mathcal{H}$ of dimension $D  N$, which is spanned by a known orthonormal basis $\\{|s_j\\rangle\\}_{j=1}^D$. We are promised that all $M$ marked states, which we denote by the set $W$, are contained entirely within this subspace, i.e., $W \\subset \\{|s_j\\rangle\\}_{j=1}^D$.\n\nThe quantum search algorithm is adapted to this scenario. The initial state is prepared as a uniform superposition over the basis states of the known subspace $\\mathcal{S}$:\n$$\n|\\psi_{\\mathcal{S}}\\rangle = \\frac{1}{\\sqrt{D}} \\sum_{j=1}^{D} |s_j\\rangle\n$$\nThe Grover operator, $G$, is constructed using this specific initial state. The oracle, $S_w$, acts as usual, flipping the sign of any marked state: $S_w|x\\rangle = -|x\\rangle$ if $|x\\rangle \\in W$ and $S_w|x\\rangle = |x\\rangle$ otherwise. The diffusion operator, $S_{\\psi_{\\mathcal{S}}}$, reflects states about the initial state $|\\psi_{\\mathcal{S}}\\rangle$: $S_{\\psi_{\\mathcal{S}}} = I - 2|\\psi_{\\mathcal{S}}\\rangle\\langle\\psi_{\\mathcal{S}}|$. The full Grover operator is then $G = -S_{\\psi_{\\mathcal{S}}} S_w$.\n\nThe QCA applies QPE to the unitary operator $G$ using $|\\psi_{\\mathcal{S}}\\rangle$ as the input state. The algorithm provides an estimate for an eigenphase of $G$. The action of $G$ is confined to a two-dimensional subspace determined by the marked and unmarked states within $\\mathcal{S}$. Find the exact value of the positive eigenphase, $\\phi$, of the Grover operator $G$ that the algorithm seeks to estimate. Express your answer as a closed-form expression in terms of the subspace dimension $D$ and the number of marked states $M$.", "solution": "1. Define the marked and unmarked-state superpositions within $\\mathcal{S}$:\n$$\n|\\beta\\rangle = \\frac{1}{\\sqrt{M}}\\sum_{|s_j\\rangle\\in W}|s_j\\rangle,\n\\qquad\n|\\alpha\\rangle = \\frac{1}{\\sqrt{D-M}}\\sum_{|s_j\\rangle\\notin W}|s_j\\rangle.\n$$\n2. Rewrite the initial state:\n$$\n|\\psi_{\\mathcal{S}}\\rangle\n=\\frac{1}{\\sqrt{D}}\\sum_{j=1}^D|s_j\\rangle\n=\\sqrt{\\frac{D-M}{D}}\\,|\\alpha\\rangle+\\sqrt{\\frac{M}{D}}\\,|\\beta\\rangle.\n$$\nSet\n$$\n\\cos\\theta=\\sqrt{\\frac{D-M}{D}}, \n\\quad\n\\sin\\theta=\\sqrt{\\frac{M}{D}}, \n\\quad\n\\theta=\\arcsin\\!\\Bigl(\\sqrt{\\tfrac{M}{D}}\\Bigr).\n$$\n3. The oracle reflection and diffusion operators act as reflections in the $\\{|\\alpha\\rangle,|\\beta\\rangle\\}$ subspace:\n$$\nS_w:\\;|\\beta\\rangle\\to-|\\beta\\rangle,\\;|\\alpha\\rangle\\to|\\alpha\\rangle,\n\\quad\nS_{\\psi_{\\mathcal{S}}}:\\;|\\psi_{\\mathcal{S}}\\rangle\\to-|\\psi_{\\mathcal{S}}\\rangle.\n$$\n4. The Grover iterate\n$$\nG=-S_{\\psi_{\\mathcal{S}}}S_w\n$$\nrestricts to a rotation by $2\\theta$ in the $\\{|\\alpha\\rangle,|\\beta\\rangle\\}$ plane. Its eigenvalues are $e^{\\pm i2\\theta}$, so the positive eigenphase is\n$$\n\\phi=2\\theta=2\\arcsin\\!\\Bigl(\\sqrt{\\frac{M}{D}}\\Bigr).\n$$", "answer": "$$\\boxed{2\\arcsin\\!\\Bigl(\\sqrt{\\frac{M}{D}}\\Bigr)}$$", "id": "115905"}, {"introduction": "A primary motivation for quantum counting is to determine the optimal number of iterations for a subsequent Grover search. Here, we transition from the theory of phase estimation to its practical application [@problem_id:116019]. This exercise demonstrates how an estimated phase from quantum counting is used to configure a search algorithm and allows you to quantify the impact of estimation error on the final probability of success.", "problem": "In the quantum search problem, we are given a search space of size $N$ with $M$ marked items. Grover's algorithm can find a marked item with high probability. The algorithm is based on iterating a quantum operator $G$. The action of $G$ is equivalent to a rotation in a specific two-dimensional Hilbert space.\n\nLet the state be described by a phase angle $\\phi = \\frac{1}{\\pi}\\arcsin(\\sqrt{M/N})$. The initial state of the search is $|\\psi_0\\rangle$. After $k$ applications of the Grover operator, the state becomes $|\\psi_k\\rangle = G^k |\\psi_0\\rangle$. The probability of finding a marked item upon measuring the state $|\\psi_k\\rangle$ is given by\n$$ P_{succ}(k, \\phi) = \\sin^2((2k+1)\\pi\\phi) $$\nThe optimal number of iterations, $k_{opt}$, depends on the true phase $\\phi$, which is generally unknown.\n\nTo overcome this, one can first use the Quantum Counting algorithm to get an estimate, $\\tilde{\\phi}$, for the true phase $\\phi$. Based on this estimate, one can compute an estimated number of iterations to run Grover's algorithm. A common formula to estimate the number of iterations is $k_{est} = \\lfloor \\frac{1}{4\\tilde{\\phi}} \\rfloor$, which is valid for $\\tilde{\\phi} \\in (0, 1/2]$.\n\nSuppose the true phase for a given search problem is $\\phi_{true} = \\frac{1}{10}$. A run of the Quantum Counting algorithm on a small quantum computer yields an estimated phase $\\tilde{\\phi} = \\frac{1}{16}$.\n\nA Grover search is then performed with a number of iterations $k$ determined by the estimate $\\tilde{\\phi}$, i.e., $k = \\lfloor \\frac{1}{4\\tilde{\\phi}} \\rfloor$. Calculate the success probability of this Grover search.", "solution": "The true phase is $\\phi_{true} = \\frac{1}{10}$, and the estimated phase is $\\tilde{\\phi} = \\frac{1}{16}$. The number of Grover iterations $k$ is determined by the formula:\n\n$$\nk = \\left\\lfloor \\frac{1}{4\\tilde{\\phi}} \\right\\rfloor\n$$\n\nSubstitute $\\tilde{\\phi} = \\frac{1}{16}$:\n\n$$\nk = \\left\\lfloor \\frac{1}{4 \\cdot \\frac{1}{16}} \\right\\rfloor = \\left\\lfloor \\frac{1}{\\frac{4}{16}} \\right\\rfloor = \\left\\lfloor \\frac{1}{\\frac{1}{4}} \\right\\rfloor = \\left\\lfloor 4 \\right\\rfloor = 4\n$$\n\nThe success probability after $k$ iterations is given by:\n\n$$\nP_{succ}(k, \\phi_{true}) = \\sin^2\\left((2k + 1) \\pi \\phi_{true}\\right)\n$$\n\nSubstitute $k = 4$ and $\\phi_{true} = \\frac{1}{10}$:\n\n$$\nP_{succ} = \\sin^2\\left( (2 \\cdot 4 + 1) \\cdot \\pi \\cdot \\frac{1}{10} \\right) = \\sin^2\\left( 9 \\cdot \\frac{\\pi}{10} \\right) = \\sin^2\\left( \\frac{9\\pi}{10} \\right)\n$$\n\nUsing the identity $\\sin(\\theta) = \\sin(\\pi - \\theta)$:\n\n$$\n\\sin\\left( \\frac{9\\pi}{10} \\right) = \\sin\\left( \\pi - \\frac{\\pi}{10} \\right) = \\sin\\left( \\frac{\\pi}{10} \\right)\n$$\n\nThus:\n\n$$\nP_{succ} = \\sin^2\\left( \\frac{\\pi}{10} \\right)\n$$\n\nUsing the double-angle formula $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$:\n\n$$\n\\sin^2\\left( \\frac{\\pi}{10} \\right) = \\frac{1 - \\cos\\left( \\frac{\\pi}{5} \\right)}{2}\n$$\n\nThe value $\\cos\\left( \\frac{\\pi}{5} \\right) = \\cos(36^\\circ) = \\frac{\\sqrt{5} + 1}{4}$ is standard. Substitute:\n\n$$\n\\sin^2\\left( \\frac{\\pi}{10} \\right) = \\frac{1 - \\frac{\\sqrt{5} + 1}{4}}{2} = \\frac{ \\frac{4 - (\\sqrt{5} + 1)}{4} }{2} = \\frac{3 - \\sqrt{5}}{8}\n$$\n\nTherefore, the success probability is $\\frac{3 - \\sqrt{5}}{8}$.", "answer": "$$ \\boxed{\\dfrac{3 - \\sqrt{5}}{8}} $$", "id": "116019"}, {"introduction": "Moving from ideal algorithms to practical implementations requires confronting the reality of noise and finite resources. This final practice explores a crucial trade-off in designing the quantum counting circuit [@problem_id:115894]. Increasing the number of counting qubits improves precision by reducing discretization error, but it also makes the circuit deeper and more susceptible to decoherence. By finding the optimal balance, you will gain valuable insight into designing quantum algorithms that perform robustly on realistic, noisy hardware.", "problem": "The Quantum Counting algorithm is a cornerstone of quantum computation, designed to estimate the number of solutions, $M$, within a search space of size $N=2^n$. The algorithm achieves this by applying Quantum Phase Estimation (QPE) to the Grover operator, $G$. The relevant eigenvalues of $G$ are $e^{\\pm i \\theta}$, where the phase $\\theta$ is related to the number of solutions by $M/N = \\sin^2(\\theta/2)$. QPE uses $t$ auxiliary \"counting\" qubits to produce an estimate of $\\theta$.\n\nIn any realistic implementation, the accuracy of the estimated phase $\\hat{\\theta}$ is limited by two competing sources of error, which depend on the choice of $t$:\n\n1.  **Discretization Error:** The QPE algorithm fundamentally discretizes the continuous phase spectrum. The precision of this discretization is determined by the maximum effective evolution time, which is proportional to $2^t$ due to the use of controlled operators up to $G^{2^{t-1}}$. Based on the principles of quantum metrology, the variance of the phase estimator $\\hat{\\theta}$ from this \"Heisenberg-limited\" discretization scales inversely with the square of the evolution time. This contribution to the variance is given by:\n    $$ \\text{Var}_{\\text{disc}}(\\hat{\\theta}) = \\frac{\\alpha}{4^t} $$\n    where $\\alpha$ is a positive constant determined by the specifics of the QPE circuit and the true phase $\\theta$.\n\n2.  **Decoherence Error:** The quantum circuit for counting is subject to noise. We model this with a per-gate amplitude damping channel. The total depth of the circuit is dominated by the highest-power Grover operator and is therefore proportional to $2^t$. The cumulative effect of the damping channel throughout the computation is a diffusion of the phase information, which introduces an additional, independent source of variance. A well-motivated model for this decoherence-induced variance is that it grows linearly with the circuit depth. This contribution is given by:\n    $$ \\text{Var}_{\\text{deco}}(\\hat{\\theta}) = \\beta \\cdot 2^t $$\n    where $\\beta$ is a positive constant representing the strength of the decoherence process.\n\nAssuming a Bayesian estimation framework with a non-informative prior for the phase $\\theta$, the posterior distribution for $\\theta$ is well-approximated by a Gaussian. Its variance is the sum of the variances from these two independent error sources, $\\text{Var}_{\\text{total}} = \\text{Var}_{\\text{disc}} + \\text{Var}_{\\text{deco}}$.\n\nYour task is to find the optimal number of counting qubits, $t_{\\text{opt}}$, that minimizes this total posterior variance. For the purpose of optimization, treat $t$ as a continuous, positive real variable. Derive the expression for $t_{\\text{opt}}$ in terms of the constants $\\alpha$ and $\\beta$.", "solution": "We wish to minimize \n$$\n\\mathrm{Var}_{\\rm total}(t)=\\alpha\\,4^{-t}+\\beta\\,2^{t}\n$$\nwith respect to the continuous variable $t0$. \n\n1. Compute the derivative:\n$$\n\\frac{d}{dt}\\mathrm{Var}_{\\rm total}\n=\\alpha\\frac{d}{dt}2^{-2t}+\\beta\\frac{d}{dt}2^{t}\n=\\alpha(-2\\ln2)\\,2^{-2t}+\\beta(\\ln2)\\,2^{t}\\,.\n$$\n\n2. Set the derivative to zero for an extremum:\n$$\n-2\\alpha\\ln2\\,2^{-2t}+\\beta\\ln2\\,2^{t}=0\n\\quad\\Longrightarrow\\quad\n\\beta\\,2^{t}=2\\alpha\\,2^{-2t}\\,.\n$$\n\n3. Solve for $t$:\n$$\n\\beta\\,2^{3t}=2\\alpha\n\\quad\\Longrightarrow\\quad\n2^{3t}=\\frac{2\\alpha}{\\beta}\n\\quad\\Longrightarrow\\quad\n3t\\ln2=\\ln\\!\\bigl(2\\alpha/\\beta\\bigr)\n\\quad\\Longrightarrow\\quad\nt=\\frac{1}{3}\\,\\frac{\\ln\\!\\bigl(2\\alpha/\\beta\\bigr)}{\\ln2}\n=\\frac{1}{3}\\log_{2}\\!\\frac{2\\alpha}{\\beta}\\,.\n$$\n\nOne checks the second derivative is positive at this point, confirming a minimum.", "answer": "$$\\boxed{\\frac{1}{3}\\log_{2}\\!\\frac{2\\alpha}{\\beta}}$$", "id": "115894"}]}