{"hands_on_practices": [{"introduction": "Understanding the quantum order-finding algorithm begins with analyzing its ideal, error-free execution. The power of the algorithm stems from the inverse Quantum Fourier Transform, which converts the phase information into sharp peaks in the measurement probability distribution. This first practice [@problem_id:160729] challenges you to calculate the probability of a specific measurement outcome, reinforcing the core principles of constructive interference that lead to a successful result.", "problem": "The quantum order-finding algorithm is a key component of Shor's algorithm for factoring integers. It is designed to find the smallest positive integer $r$, called the order, such that $x^r \\equiv 1 \\pmod{N}$ for given coprime integers $x$ and $N$.\n\nThe algorithm uses two quantum registers: a control register with $Q=2^n$ states (for some integer $n$) and a target register. After a series of operations involving controlled modular exponentiation, a measurement on the target register projects the control register into a periodic superposition of computational basis states. For simplicity, we will consider the case where this post-measurement state is given by:\n$$\n|\\psi\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} |mr\\rangle\n$$\nHere, $r$ is the order, and the sum is over all non-negative integers $m$ such that $mr  Q$. The normalization factor is $1/\\sqrt{M}$, where $M$ is the total number of terms in the superposition.\n\nThe final step of the algorithm is to apply the inverse Quantum Fourier Transform (QFT) to the state $|\\psi\\rangle$ and measure the control register. The action of the inverse QFT on a basis state $|j\\rangle$ is defined as:\n$$\n\\text{QFT}^\\dagger |j\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{k=0}^{Q-1} e^{-2\\pi i jk/Q} |k\\rangle\n$$\n\nConsider the specific problem of finding the order of $x=10$ modulo $N=21$. The order for this case is $r=6$. Let the size of the control register be $Q=256$. Assuming the state of the control register before the QFT is exactly the state $|\\psi\\rangle$ described above, calculate the probability of measuring the outcome $k=128$ in the control register.", "solution": "The state before the inverse QFT is given by:\n\n$$\n|\\psi\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} |m r\\rangle\n$$\n\nwhere $r = 6$ is the order, $Q = 256$ is the size of the control register, and $M$ is the number of terms satisfying $m r  Q$. The values of $m$ range from 0 to the maximum integer such that $m r  Q$. Since $r = 6$ and $Q = 256$:\n\n$$\nm_{\\text{max}} = \\left\\lfloor \\frac{Q - 1}{r} \\right\\rfloor = \\left\\lfloor \\frac{255}{6} \\right\\rfloor = 42\n$$\n\nThus, $m = 0, 1, 2, \\ldots, 42$, which gives $M = 43$.\n\nThe inverse QFT acts on a basis state $|j\\rangle$ as:\n\n$$\n\\text{QFT}^\\dagger |j\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{k=0}^{Q-1} e^{-2\\pi i j k / Q} |k\\rangle\n$$\n\nApplying the inverse QFT to $|\\psi\\rangle$:\n\n$$\n\\text{QFT}^\\dagger |\\psi\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} \\text{QFT}^\\dagger |m r\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} \\left( \\frac{1}{\\sqrt{Q}} \\sum_{k=0}^{Q-1} e^{-2\\pi i (m r) k / Q} |k\\rangle \\right)\n$$\n\nThe amplitude for state $|k\\rangle$ is:\n\n$$\n\\alpha_k = \\frac{1}{\\sqrt{M Q}} \\sum_{m=0}^{M-1} e^{-2\\pi i m r k / Q}\n$$\n\nThe probability of measuring outcome $k$ is $|\\alpha_k|^2$. For $k = 128$:\n\n$$\n\\alpha_{128} = \\frac{1}{\\sqrt{M Q}} \\sum_{m=0}^{M-1} e^{-2\\pi i m \\cdot 6 \\cdot 128 / 256}\n$$\n\nSimplify the exponent:\n\n$$\n\\frac{6 \\cdot 128}{256} = \\frac{768}{256} = 3\n$$\n\nThus:\n\n$$\ne^{-2\\pi i m \\cdot 3} = e^{-6\\pi i m} = (e^{-2\\pi i})^{3m} = 1^{3m} = 1\n$$\n\nsince $e^{-2\\pi i} = 1$. The sum becomes:\n\n$$\n\\sum_{m=0}^{M-1} 1 = M\n$$\n\nSo the amplitude is:\n\n$$\n\\alpha_{128} = \\frac{1}{\\sqrt{M Q}} \\cdot M = \\sqrt{\\frac{M}{Q}}\n$$\n\nThe probability is:\n\n$$\n|\\alpha_{128}|^2 = \\left( \\sqrt{\\frac{M}{Q}} \\right)^2 = \\frac{M}{Q}\n$$\n\nSubstituting $M = 43$ and $Q = 256$:\n\n$$\n\\frac{43}{256}\n$$", "answer": "$$ \\boxed{\\dfrac{43}{256}} $$", "id": "160729"}, {"introduction": "Real-world quantum computers are subject to imperfections, and this exercise [@problem_id:160728] explores the impact of a common type of systematic error: a small, constant phase offset applied with each unitary operation. By calculating the resulting shift in the measurement outcome's peak, you will gain hands-on experience in analyzing how coherent errors propagate through the algorithm and affect its output. This is a key step in error characterization and mitigation for quantum hardware.", "problem": "The quantum order-finding algorithm, a key component of Shor's algorithm for factoring, can be understood as an application of the Quantum Phase Estimation (QPE) algorithm. To find the order $r$ of an integer $x$ modulo $N$, we use QPE to estimate the phase $\\phi$ associated with an eigenvalue of the unitary operator $U_x$ defined by $U_x|y\\rangle = |xy \\pmod{N}\\rangle$. The eigenvalues of $U_x$ are of the form $e^{2\\pi i s/r}$ for $s \\in \\{0, 1, \\dots, r-1\\}$. The QPE algorithm estimates one of the phases $\\phi_s = s/r$.\n\nThe standard QPE circuit uses a first register of $n$ qubits (let $Q=2^n$) and a second register to hold an eigenvector of $U_x$. After applying a series of controlled-$U_x^{2^j}$ gates (for $j=0, \\dots, n-1$) and an inverse Quantum Fourier Transform, a measurement on the first register yields an integer $k$. In the ideal case, the probability distribution of $k$ peaks sharply at the integer value closest to $Q\\phi_s$.\n\nConsider a scenario where the implementation of the controlled unitary gates is imperfect. Specifically, assume a systematic rotational error occurs, which can be modeled by replacing the ideal unitary operator $U_x$ with a flawed operator $U'_x = e^{i\\delta} U_x$, where $\\delta$ is a small constant phase.\n\nGiven the following parameters:\n- The algorithm is analyzing the phase corresponding to the label $s=1$.\n- The order of the element $x$ is $r=32$.\n- The first quantum register (the \"counting\" register) uses a number of qubits such that its total number of states is $Q=1024$.\n- The systematic phase error is given by $\\delta = \\pi/256$.\n\nDetermine the integer offset, $\\Delta k = k_{err} - k_{ideal}$, of the primary Fourier peak caused by this systematic error. Here, $k_{ideal}$ is the measurement outcome with the highest probability in the ideal (no error) case, and $k_{err}$ is the corresponding peak location in the presence of the error.", "solution": "The ideal phase to be estimated is $\\phi_s = s/r = 1/32$.  \nThe systematic error modifies the unitary operator to $U'_x = e^{i\\delta} U_x$, where $\\delta = \\pi/256$.  \nThe eigenvalue of $U'_x$ for the same eigenvector becomes $e^{i\\delta} e^{2\\pi i s/r} = e^{i(2\\pi s/r + \\delta)}$.  \nThus, the erroneous phase angle is $\\theta_{\\text{err}} = 2\\pi s/r + \\delta$.  \nThe phase $\\phi_{\\text{err}}$ is given by $\\phi_{\\text{err}} = \\theta_{\\text{err}} / (2\\pi) = (2\\pi s/r + \\delta) / (2\\pi) = s/r + \\delta/(2\\pi)$.  \n\nSubstituting $s=1$, $r=32$, and $\\delta = \\pi/256$:  \n$\\phi_{\\text{err}} = 1/32 + (\\pi/256) / (2\\pi) = 1/32 + 1/(256 \\cdot 2) = 1/32 + 1/512$.  \n\nThe number of states in the first register is $Q=1024$.  \nThe ideal measurement outcome $k_{\\text{ideal}}$ corresponds to $Q \\phi_s = 1024 \\cdot (1/32) = 32$.  \nSince $32$ is an integer, $k_{\\text{ideal}} = 32$.  \n\nThe erroneous measurement outcome $k_{\\text{err}}$ corresponds to $Q \\phi_{\\text{err}} = 1024 \\cdot (1/32 + 1/512)$.  \nCompute:  \n$1024 \\cdot (1/32) = 32$,  \n$1024 \\cdot (1/512) = 1024 / 512 = 2$.  \nThus, $Q \\phi_{\\text{err}} = 32 + 2 = 34$.  \nSince $34$ is an integer, $k_{\\text{err}} = 34$.  \n\nThe offset is $\\Delta k = k_{\\text{err}} - k_{\\text{ideal}} = 34 - 32 = 2$.", "answer": "$$ \\boxed{2} $$", "id": "160728"}, {"introduction": "Beyond systematic errors, quantum computations are affected by stochastic noise from environmental interactions, which leads to decoherence. This advanced practice [@problem_id:160701] introduces the depolarizing channel as a model for this noise and asks you to compute its effect on the algorithm's success probability. Working through this problem will require the density matrix formalism, providing a deeper insight into the practical limitations and resilience of quantum algorithms on near-term devices.", "problem": "The quantum order-finding algorithm is a key component of Shor's algorithm for factoring integers. It is a special case of the quantum phase estimation algorithm. In this problem, we consider an order-finding circuit designed to determine an order $r$. The circuit consists of two registers: a control register of $n$ qubits and a target register. The control register is initialized to the state $|0\\rangle^{\\otimes n}$ and then transformed by a Hadamard gate on each qubit, resulting in the state $\\frac{1}{\\sqrt{Q}} \\sum_{j=0}^{Q-1} |j\\rangle$, where $Q=2^n$. The target register is prepared in an eigenstate $|u_s\\rangle$ of a unitary operator $U$ such that $U|u_s\\rangle = e^{2\\pi i s/r} |u_s\\rangle$.\n\nThe core of the algorithm involves applying a series of controlled-$U^{2^l}$ operations for $l=0, 1, \\dots, n-1$. The $l$-th control qubit then controls the application of the unitary $U^{2^l}$ to the target register. After these operations, an inverse Quantum Fourier Transform (QFT$^{-1}$) is applied to the control register, which is then measured in the computational basis. In the ideal, noiseless case, measuring an outcome $k$ allows one to deduce the order $r$.\n\nNow, consider a non-ideal scenario where each of the $n$ control qubits is affected by noise. Specifically, immediately after each controlled-$U^{2^l}$ gate is applied, the corresponding control qubit $l$ is subjected to a single-qubit depolarizing channel $\\mathcal{E}_p$. The action of this channel on a single-qubit density matrix $\\rho$ is given by $\\mathcal{E}_p(\\rho) = (1-p) \\rho + p \\frac{I}{2}$, where $I$ is the $2 \\times 2$ identity matrix and $p$ is the error probability.\n\nGiven the following parameters:\n- The order to be found is $r=4$.\n- The chosen integer is $s=1$.\n- The number of states in the control register is $Q=16$.\n- The depolarizing error probability is $p=1/10$.\n\nAssume the target register is prepared in the eigenstate $|u_s\\rangle$ corresponding to $s=1$. Compute the probability of measuring the ideal outcome $k=4$ in the final measurement of the control register.", "solution": "We label the control register by 4 qubits (so $Q=2^4=16$) and denote basis states by bit-strings $|x\\rangle = |x_3x_2x_1x_0\\rangle$, with integer value $x=\\sum_{l=0}^3 2^l x_l$. After the Hadamards and the controlled-$U^{2^l}$ gates on the target eigenstate $|u_s\\rangle$, the control register is in the pure state\n$$\n|\\psi\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{x=0}^{Q-1} e^{2\\pi i \\frac{s}{r}x} |x\\rangle\n$$\nThe corresponding density matrix is $\\rho=|\\psi\\rangle\\langle\\psi|$, with elements $\\rho_{x,y}=\\frac{1}{Q} e^{2\\pi i\\frac{s}{r}(x-y)}$.\n\nNext, each qubit $l$ undergoes a depolarizing channel $\\mathcal{E}_p$ acting on that qubit alone. One shows that on the multi-qubit density matrix this yields\n$$\n\\rho^{(\\mathrm{noisy})}_{x,y} = \\rho_{x,y} (1-p)^{H(x,y)}, \\quad \\rho^{(\\mathrm{noisy})}_{x,x} = \\frac{1}{Q}\n$$\nwhere $H(x,y)$ is the Hamming distance of the bit-strings $x,y$. Finally one applies QFT$^{-1}$ on the control register and measures in the computational basis. A standard calculation gives for the probability to obtain outcome $k$\n$$\nP(k) = \\langle k| \\text{QFT}^{-1} \\rho^{(\\mathrm{noisy})} \\text{QFT} |k\\rangle = \\frac{1}{Q} \\sum_{x,y} \\rho^{(\\mathrm{noisy})}_{x,y} e^{2\\pi i\\frac{k(y-x)}{Q}}\n$$\nSubstitute $\\rho_{x,y}=\\frac{1}{Q}e^{2\\pi i\\frac{s}{r}(x-y)}$ and factor the sum over qubits. One finds\n$$\nP(k) = \\frac{1}{Q^2} \\sum_{x,y}(1-p)^{H(x,y)} e^{2\\pi i\\bigl(\\frac{s}{r}-\\frac{k}{Q}\\bigr)(x-y)} = \\frac{1}{16}\\prod_{l=0}^3\\Bigl[1+(1-p)\\cos\\bigl(2\\pi 2^l\\phi\\bigr)\\Bigr]\n$$\nwhere $\\phi=s/r-k/Q$. For the \"ideal\" outcome $k=4$, with $s=1, r=4, Q=16$, one has\n$$\n\\phi = \\frac{1}{4} - \\frac{4}{16} = 0 \\implies \\cos(2\\pi 2^l\\phi)=1 \\quad \\forall l\n$$\nHence\n$$\nP(k=4) = \\frac{1}{16}\\bigl[1+(1-p)\\bigr]^4 = \\frac{1}{16}(2-p)^4\n$$\nFinally, substituting $p=\\frac{1}{10}$ gives $2-p=\\frac{19}{10}$ and\n$$\nP(k=4) = \\frac{1}{16}\\Bigl(\\frac{19}{10}\\Bigr)^4 = \\frac{130321}{160000}\n$$", "answer": "$$\\boxed{\\frac{130321}{160000}}$$", "id": "160701"}]}