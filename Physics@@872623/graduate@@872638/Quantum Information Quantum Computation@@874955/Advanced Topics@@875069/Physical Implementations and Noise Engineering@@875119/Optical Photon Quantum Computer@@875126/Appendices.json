{"hands_on_practices": [{"introduction": "The behavior of multiple identical photons in an interferometer is a cornerstone of linear optical quantum computing. Unlike classical waves, the quantum nature of photons leads to complex interference patterns governed by bosonic statistics. This practice provides a fundamental exercise in calculating these quantum probabilities by applying the permanent formula to the interferometer's unitary transformation matrix, a key skill for analyzing any linear optical circuit. [@problem_id:107063]", "problem": "Consider a 3-port cascaded interferometer designed for linear optical quantum computing. The interferometer consists of three spatial modes. The modes are manipulated by a sequence of optical elements. First, a 50:50 beam splitter, $BS_1$, couples modes 1 and 2. Then, a phase shifter applies a phase shift of $\\theta$ to mode 2. Finally, a second 50:50 beam splitter, $BS_2$, couples modes 2 and 3.\n\nThe transformation induced by a 50:50 beam splitter on two input modes with creation operators $(a_j^\\dagger, a_k^\\dagger)$ to two output modes with creation operators $(b_j^\\dagger, b_k^\\dagger)$ is described by the unitary matrix:\n$$\nU_{BS} = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1 & i \\\\\ni & 1\n\\end{pmatrix}\n$$\nsuch that $\\begin{pmatrix} b_j^\\dagger \\\\ b_k^\\dagger \\end{pmatrix} = U_{BS} \\begin{pmatrix} a_j^\\dagger \\\\ a_k^\\dagger \\end{pmatrix}$. The phase shifter on a mode $k$ transforms its creation operator as $a_k^\\dagger \\to e^{i\\theta} a_k^\\dagger$.\n\nAn input state consisting of two photons in mode 1 and one photon in mode 2, with mode 3 being in the vacuum state, is sent into the interferometer. This state can be written in the Fock basis as $|2, 1, 0\\rangle$.\n\nYour task is to calculate the probability of detecting one photon in each of the three output modes, i.e., finding the system in the output state $|1, 1, 1\\rangle$.", "solution": "The problem asks for the probability of the transition from an input Fock state $|n_1, n_2, n_3\\rangle = |2, 1, 0\\rangle$ to an output Fock state $|n'_1, n'_2, n'_3\\rangle = |1, 1, 1\\rangle$ after passing through a 3-port linear optical interferometer.\n\n**Step 1: Determine the unitary transformation matrix of the interferometer**\n\nThe interferometer consists of three stages acting on the three modes. We can represent each stage by a $3 \\times 3$ unitary matrix acting on the column vector of creation operators $(a_1^\\dagger, a_2^\\dagger, a_3^\\dagger)^T$.\n\n1.  The first beam splitter $BS_1$ acts on modes 1 and 2. Its matrix representation is:\n    $$\n    U_1 = \\begin{pmatrix}\n    1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\n    i/\\sqrt{2} & 1/\\sqrt{2} & 0 \\\\\n    0 & 0 & 1\n    \\end{pmatrix}\n    $$\n2.  The phase shifter applies a phase $e^{i\\theta}$ to mode 2. Its matrix is:\n    $$\n    U_\\theta = \\begin{pmatrix}\n    1 & 0 & 0 \\\\\n    0 & e^{i\\theta} & 0 \\\\\n    0 & 0 & 1\n    \\end{pmatrix}\n    $$\n3.  The second beam splitter $BS_2$ acts on modes 2 and 3. Its matrix is:\n    $$\n    U_2 = \\begin{pmatrix}\n    1 & 0 & 0 \\\\\n    0 & 1/\\sqrt{2} & i/\\sqrt{2} \\\\\n    0 & i/\\sqrt{2} & 1/\\sqrt{2}\n    \\end{pmatrix}\n    $$\n\nThe total transformation matrix $U$ for the interferometer is the product of these matrices in reverse order of application: $U = U_2 U_\\theta U_1$.\nFirst, we compute $U_\\theta U_1$:\n$$\nU_\\theta U_1 = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & e^{i\\theta} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni/\\sqrt{2} & 1/\\sqrt{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni e^{i\\theta}/\\sqrt{2} & e^{i\\theta}/\\sqrt{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nNext, we multiply by $U_2$:\n$$\nU = U_2 (U_\\theta U_1) =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1/\\sqrt{2} & i/\\sqrt{2} \\\\\n0 & i/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni e^{i\\theta}/\\sqrt{2} & e^{i\\theta}/\\sqrt{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n$$\nU = \\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\n(1/\\sqrt{2})(i e^{i\\theta}/\\sqrt{2}) & (1/\\sqrt{2})(e^{i\\theta}/\\sqrt{2}) & (i/\\sqrt{2})(1) \\\\\n(i/\\sqrt{2})(i e^{i\\theta}/\\sqrt{2}) & (i/\\sqrt{2})(e^{i\\theta}/\\sqrt{2}) & (1/\\sqrt{2})(1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni e^{i\\theta}/2 & e^{i\\theta}/2 & i/\\sqrt{2} \\\\\n-e^{i\\theta}/2 & i e^{i\\theta}/2 & 1/\\sqrt{2}\n\\end{pmatrix}\n$$\n\n**Step 2: Use the formula for transition amplitude**\n\nThe transition amplitude for a multi-photon process from input state $|\\mathbf{n}\\rangle = |n_1, ..., n_m\\rangle$ to output state $|\\mathbf{n'}\\rangle = |n'_1, ..., n'_m\\rangle$ through a linear optical network described by a unitary matrix $U$ is given by:\n$$\n\\langle \\mathbf{n'} | \\mathcal{U} | \\mathbf{n} \\rangle = \\frac{\\text{perm}(U_S)}{\\sqrt{n_1! \\dots n_m! \\cdot n'_1! \\dots n'_m!}}\n$$\nwhere $U_S$ is a submatrix of $U$ constructed according to the input and output photon numbers. For an input state with $n_k$ photons in mode $k$ and output with $n'_j$ photons in mode $j$, the matrix $U_S$ is formed by taking $n_k$ copies of the $k$-th column of $U$ and $n'_j$ copies of the $j$-th row of $U$.\n\nIn our case, the input state is $|2,1,0\\rangle$ and the output state is $|1,1,1\\rangle$. The total number of photons is $N=3$. The matrix $U_S$ is a $3 \\times 3$ matrix. Its columns are determined by the input state: two copies of the first column of $U$ and one copy of the second column of $U$. Its rows are determined by the output state: one copy of each of the three rows of $U$.\nSo, $U_S$ is:\n$$\nU_S = \\begin{pmatrix}\nU_{11} & U_{11} & U_{12} \\\\\nU_{21} & U_{21} & U_{22} \\\\\nU_{31} & U_{31} & U_{32}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2} & 1/\\sqrt{2} & i/\\sqrt{2} \\\\\ni e^{i\\theta}/2 & i e^{i\\theta}/2 & e^{i\\theta}/2 \\\\\n-e^{i\\theta}/2 & -e^{i\\theta}/2 & i e^{i\\theta}/2\n\\end{pmatrix}\n$$\n\n**Step 3: Calculate the permanent of $U_S$**\n\nThe permanent of a $3 \\times 3$ matrix $A = (a_{ij})$ is given by $\\text{perm}(A) = \\sum_{\\sigma \\in S_3} \\prod_{i=1}^3 a_{i, \\sigma(i)}$.\nFor a matrix of the form $A = \\begin{pmatrix} a & a & b \\\\ c & c & d \\\\ e & e & f \\end{pmatrix}$, the permanent is $\\text{perm}(A) = 2(acf + ade + bce)$.\nLet's identify the elements:\n$a = U_{11} = 1/\\sqrt{2}$\n$b = U_{12} = i/\\sqrt{2}$\n$c = U_{21} = i e^{i\\theta}/2$\n$d = U_{22} = e^{i\\theta}/2$\n$e = U_{31} = -e^{i\\theta}/2$\n$f = U_{32} = i e^{i\\theta}/2$\n\nNow we compute the terms:\n$acf = (1/\\sqrt{2})(i e^{i\\theta}/2)(i e^{i\\theta}/2) = -e^{2i\\theta}/(4\\sqrt{2})$\n$ade = (1/\\sqrt{2})(e^{i\\theta}/2)(-e^{i\\theta}/2) = -e^{2i\\theta}/(4\\sqrt{2})$\n$bce = (i/\\sqrt{2})(i e^{i\\theta}/2)(-e^{i\\theta}/2) = e^{2i\\theta}/(4\\sqrt{2})$\n\nSumming these up:\n$acf + ade + bce = -e^{2i\\theta}/(4\\sqrt{2}) - e^{2i\\theta}/(4\\sqrt{2}) + e^{2i\\theta}/(4\\sqrt{2}) = -e^{2i\\theta}/(4\\sqrt{2})$\nSo, the permanent is:\n$\\text{perm}(U_S) = 2 \\times (-e^{2i\\theta}/(4\\sqrt{2})) = -e^{2i\\theta}/(2\\sqrt{2})$.\n\n**Step 4: Calculate the probability**\n\nThe normalization factor is $\\sqrt{n_1! n_2! n_3! \\cdot n'_1! n'_2! n'_3!} = \\sqrt{2! \\cdot 1! \\cdot 0! \\cdot 1! \\cdot 1! \\cdot 1!} = \\sqrt{2}$.\nThe amplitude $A$ is:\n$$\nA = \\frac{\\text{perm}(U_S)}{\\sqrt{2}} = \\frac{-e^{2i\\theta}/(2\\sqrt{2})}{\\sqrt{2}} = -\\frac{e^{2i\\theta}}{4}\n$$\nThe probability $P$ is the squared modulus of the amplitude:\n$$\nP = |A|^2 = \\left|-\\frac{e^{2i\\theta}}{4}\\right|^2 = \\left(\\frac{1}{4}\\right)^2 |-e^{2i\\theta}|^2 = \\frac{1}{16} \\cdot 1 = \\frac{1}{16}\n$$\nThe probability is independent of the phase shift $\\theta$.", "answer": "$$\n\\boxed{\\frac{1}{16}}\n$$", "id": "107063"}, {"introduction": "The powerful interference effects central to boson sampling and optical quantum computing critically depend on the perfect indistinguishability of the photons. This exercise explores the consequences of breaking this condition, modeling a scenario where one photon is partially distinguishable due to a temporal delay. By calculating the output probability as a function of photon overlap, you will gain a quantitative understanding of how experimental imperfections can degrade quantum interference. [@problem_id:107142]", "problem": "In a boson sampling experiment, three photons are injected into a symmetric 3-port interferometer, with one photon per input port. The interferometer, known as a tritter, is described by the 3x3 unitary matrix $U$, which is the discrete Fourier transform matrix:\n$$ U = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & \\omega & \\omega^2 \\\\ 1 & \\omega^2 & \\omega \\end{pmatrix} $$\nwhere $\\omega = e^{i2\\pi/3}$.\n\nThe input state is prepared with one photon in each of the three input modes. The photons entering input modes 1 and 2 are identical in all respects. The photon entering input mode 3 is identical to the others in all properties except for its temporal profile. It is prepared with a temporal delay $\\tau$ with respect to the other two.\n\nThe temporal wavepackets of the photons are modeled as normalized Gaussians with a characteristic temporal width $\\sigma_t$. The temporal wavepacket for photons 1 and 2 is $\\psi_0(t)$, and for photon 3 is $\\psi_0(t-\\tau)$. The overlap between the delayed and non-delayed wavepackets is given by a real parameter $g = \\langle\\psi_0|\\psi_0(\\cdot-\\tau)\\rangle = \\exp(-\\frac{\\tau^2}{4\\sigma_t^2})$.\n\nCalculate the probability $P(1,1,1)$ of detecting exactly one photon at each of the three output ports. Express your answer as a function of the normalized temporal overlap $g$.", "solution": "1. The probability with partially distinguishable photons is given by\n$$\nP(1,1,1)=\\sum_{\\sigma,\\pi\\in S_3}\\Bigl[\\prod_{i=1}^3U_{i,\\sigma(i)}U^*_{i,\\pi(i)}\\Bigr]\\,\n\\prod_{k=1}^3\\langle\\phi_{\\sigma(k)}|\\phi_{\\pi(k)}\\rangle\\,,\n$$\nwhere $\\langle\\phi_i|\\phi_j\\rangle=1$ if $i,j\\in\\{1,2\\}$ or $i=j=3$, and $\\langle\\phi_i|\\phi_j\\rangle=g$ if one index is 3 and the other is in $\\{1,2\\}$.\n\n2. Define the amplitude\n$$\nA_\\sigma=\\prod_{i=1}^3U_{i,\\sigma(i)}\\,,\\qquad \n\\sum_\\sigma A_\\sigma=\\text{Perm}(U)\\,,\\qquad\n|\\text{Perm}(U)|^2=\\frac{1}{3}\\,,\\quad \n\\sum_\\sigma|A_\\sigma|^2=\\frac{6}{27}=\\frac{2}{9}\\,.\n$$\n\n3. Split the double sum into two classes:\n– (i) $\\sigma(3)=\\pi(3)$: here all overlaps are unity, \n$$S_1=\\sum_{\\sigma,\\pi:\\,\\sigma(3)=\\pi(3)}A_\\sigma A_\\pi^*\n=\\sum_{j=1}^3\\Bigl|\\sum_{\\sigma:\\,\\sigma(3)=j}A_\\sigma\\Bigr|^2\n= \\frac{1}{9}\\,.\n$$\n– (ii) $\\sigma(3)\\neq\\pi(3)$: here the product of overlaps is $g^2$, and\n$$\nS_2=\\sum_{\\sigma,\\pi:\\,\\sigma(3)\\neq\\pi(3)}A_\\sigma A_\\pi^*\n=\\bigl|\\text{Perm}(U)\\bigr|^2-S_1\n=\\frac{1}{3}-\\frac{1}{9}=\\frac{2}{9}\\,.\n$$\n\n4. Thus\n$$\nP(1,1,1)=1\\cdot S_1+g^2\\cdot S_2\n=\\frac{1}{9}+\\frac{2}{9}\\,g^2\n=\\frac{1+2g^2}{9}\\,.\n$$", "answer": "$$\\boxed{\\frac{1+2g^2}{9}}$$", "id": "107142"}, {"introduction": "Building large-scale entangled resources like cluster states is essential for measurement-based quantum computing, but in optical systems, the entangling 'fusion' gates are often probabilistic. This practice moves beyond the physics of a single gate to the systems-level challenge of resource management under uncertainty. By modeling a sequential construction process where failures are catastrophic, you will calculate the average number of resources required, revealing the steep cost of probabilistic operations and the critical need for high success probabilities. [@problem_id:107002]", "problem": "In measurement-based quantum computing (MBQC), large entangled resource states known as cluster states are prepared and then consumed by a sequence of single-qubit measurements. A primary challenge in optical implementations of MBQC is the probabilistic nature of entangling operations.\n\nConsider the task of building a four-qubit square cluster state. The state can be visualized as four qubits at the vertices of a square, with entanglement links corresponding to the edges. The construction starts with four qubits in the product state $|+\\rangle^{\\otimes 4}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$. The four entanglement links (CZ gates) required to form the square topology are created sequentially.\n\nThe creation of an entangling link between any two qubits is attempted via a probabilistic process, which for the purposes of this problem can be modeled as a \"fusion gate\". Each attempt to create a link consumes one heralded Bell pair and succeeds with a probability $p$.\n\nThe construction of the four-qubit square cluster state is planned as a sequential process:\n1.  An edge is created between qubits 1 and 2, forming a 2-qubit linear cluster.\n2.  An edge is created between qubits 2 and 3, forming a 3-qubit linear cluster.\n3.  An edge is created between qubits 3 and 4, forming a 4-qubit linear cluster.\n4.  Finally, an edge is created between qubits 4 and 1 to close the loop, completing the square cluster.\n\nA crucial aspect of this fabrication process is its sensitivity to failure. At any stage of construction, a failed attempt to add the next required edge causes the entire existing entangled structure to decohere. When this happens, the construction must be restarted from the very beginning (i.e., from the initial four-qubit product state). Note that a failure on the very first attempt (building the 2-qubit cluster) does not destroy any pre-existing entanglement, as there is none.\n\nYour task is to compute the total average number of heralded Bell pairs required to successfully construct the four-qubit square cluster state. Express your answer as a closed-form analytical expression in terms of the success probability $p$.", "solution": "Let $C$ be the total average number of heralded Bell pairs required. The construction process is sequential and involves creating four entanglement links. Let's denote the intermediate structures by the number of edges they contain:\n-   $S_0$: The initial state of four unentangled qubits.\n-   $S_1$: A 2-qubit linear cluster with one edge.\n-   $S_2$: A 3-qubit linear cluster with two edges.\n-   $S_3$: A 4-qubit linear cluster with three edges.\n-   $S_4$: The final 4-qubit square cluster with four edges.\n\nLet $C_k$ be the expected total number of Bell pairs required to successfully construct the structure $S_k$, starting from $S_0$. Our goal is to find $C_4$.\n\n**Step 1: Calculate the cost to create $S_1$**\n\nTo get from $S_0$ to $S_1$, we attempt to create the first edge. Each attempt is a Bernoulli trial with success probability $p$, and costs one Bell pair. Since there is no pre-existing entanglement, a failure does not force a restart of a larger structure. The number of attempts, $N_1$, follows a geometric distribution with parameter $p$.\nThe probability mass function is $P(N_1=n) = (1-p)^{n-1}p$ for $n=1, 2, \\dots$.\nThe expected number of attempts (and thus Bell pairs) is:\n$$C_1 = E[N_1] = \\frac{1}{p}$$\n\n**Step 2: Formulate a recurrence relation for $C_k$**\n\nFor $k \\ge 2$, to construct the structure $S_k$, we must have first successfully constructed $S_{k-1}$. Then, we attempt to add the $k$-th edge. A failure at this stage destroys the entire $S_{k-1}$ structure, forcing a complete restart from $S_0$.\n\nLet's find the expected cost $C_k$ for $k \\in \\{2, 3, 4\\}$. The total process to obtain $S_k$ can be viewed as a sequence of attempts to add the $k$-th edge to a successfully prepared $S_{k-1}$ structure. Let $N_k$ be the number of attempts needed to create the $k$-th edge.\n\nFor each attempt, we must first have the $S_{k-1}$ structure. The expected cost to build $S_{k-1}$ is $C_{k-1}$.\nLet's consider the process to form the $k$-th edge, given we have just formed $S_{k-1}$. Let $N$ be the number of attempts.\n-   If the first attempt succeeds (probability $p$), the total cost is the cost to build $S_{k-1}$ plus 1 BP for the successful attempt. Total cost given success on 1st try: $C_{k-1} + 1$.\n-   If the first attempt fails (probability $1-p$), we have spent 1 BP, lost the structure, and must restart the entire process of building $S_k$ from scratch. The expected cost from this point forward is $C_k$. So, the total cost given failure on 1st try is $C_{k-1} + 1 + C_k$.\n\nUsing the law of total expectation for $C_k$:\n$$C_k = p \\cdot (C_{k-1} + 1) + (1-p) \\cdot (C_{k-1} + 1 + C_k)$$\nThe logic above is slightly flawed because $C_{k-1}$ is an expectation, not a fixed cost. Let's use a more rigorous argument.\n\nLet's analyze the cost to go from $S_{k-1}$ to $S_k$. Let $N$ be the number of attempts for the $k$-th edge. $N$ follows a geometric distribution, $P(N=n) = p(1-p)^{n-1}$.\nThe final successful attempt (the $n$-th one) is preceded by $n-1$ failures.\n-   The cost of the successful sequence of operations is $C_{k-1} + 1$ (build $S_{k-1}$, then add the final edge).\n-   Each of the $n-1$ failures costs 1 BP for the attempt itself, and requires rebuilding the $S_{k-1}$ structure from scratch, which has an expected cost of $C_{k-1}$. So each failed sequence costs $C_{k-1}+1$.\n\nSo, the total expected cost $C_k$, given it takes $n$ attempts for the last stage, is $E[C_k|N=n] = (n-1)(C_{k-1}+1) + (C_{k-1}+1) = n(C_{k-1}+1)$.\nNow, let's find the unconditional expectation $C_k$ by averaging over all possible values of $n$:\n$$C_k = E[E[C_k|N=n]] = \\sum_{n=1}^\\infty P(N=n) \\cdot n(C_{k-1}+1)$$\n$$C_k = (C_{k-1}+1) \\sum_{n=1}^\\infty n(1-p)^{n-1}p$$\nThe sum is the expectation of the geometric distribution, which is $1/p$.\n$$C_k = (C_{k-1}+1) \\cdot \\frac{1}{p}$$\nThis gives us the recurrence relation for $k=2, 3, 4$:\n$$C_k = \\frac{C_{k-1}+1}{p}$$\n\n**Step 3: Solve the recurrence relation**\n\nWe have $C_1 = 1/p$. We can now find $C_2, C_3,$ and $C_4$ iteratively.\n\n-   For $k=2$:\n    $$C_2 = \\frac{C_1+1}{p} = \\frac{\\frac{1}{p}+1}{p} = \\frac{1+p}{p^2}$$\n\n-   For $k=3$:\n    $$C_3 = \\frac{C_2+1}{p} = \\frac{\\frac{1+p}{p^2}+1}{p} = \\frac{\\frac{1+p+p^2}{p^2}}{p} = \\frac{1+p+p^2}{p^3}$$\n\n-   For $k=4$:\n    $$C_4 = \\frac{C_3+1}{p} = \\frac{\\frac{1+p+p^2}{p^3}+1}{p} = \\frac{\\frac{1+p+p^2+p^3}{p^3}}{p} = \\frac{1+p+p^2+p^3}{p^4}$$\n\nThis is the average number of Bell pairs required.\n\n**Step 4: Express the answer in a closed form**\n\nThe numerator is a finite geometric series: $\\sum_{i=0}^{3} p^i = \\frac{1-p^4}{1-p}$.\nSubstituting this into the expression for $C_4$:\n$$C_4 = \\frac{\\frac{1-p^4}{1-p}}{p^4} = \\frac{1-p^4}{p^4(1-p)}$$\nThis is the final closed-form expression for the average total number of Bell pairs.\n\nAlternatively, we can express $C_4$ as:\n$$C_4 = \\frac{1}{p^4} + \\frac{p}{p^4} + \\frac{p^2}{p^4} + \\frac{p^3}{p^4} = \\frac{1}{p} + \\frac{1}{p^2} + \\frac{1}{p^3} + \\frac{1}{p^4}$$\nThis form clearly shows the compounding cost of potential failures at each stage of the construction.", "answer": "$$ \\boxed{\\frac{1-p^4}{p^4(1-p)}} $$", "id": "107002"}]}