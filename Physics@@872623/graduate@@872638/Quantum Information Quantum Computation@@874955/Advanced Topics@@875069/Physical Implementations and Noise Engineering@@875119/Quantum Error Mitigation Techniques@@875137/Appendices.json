{"hands_on_practices": [{"introduction": "Zero-noise extrapolation (ZNE) is a powerful and intuitive technique that treats noise as a tunable parameter. By measuring an observable at different, amplified noise levels, we can extrapolate back to the zero-noise limit, much like one might do to account for an unknown source of friction in a classical mechanics experiment. This exercise [@problem_id:121292] demonstrates the core logic of ZNE using a simple linear model, showing how to calculate the noise-free value from measurements at just two different noise levels.", "problem": "Zero-noise extrapolation (ZNE) is a quantum error mitigation technique used to estimate the ideal, noise-free expectation value of an observable. This is achieved by systematically amplifying the noise in a quantum circuit in a controlled manner, measuring the expectation value at different noise levels, and then extrapolating the results back to the zero-noise limit.\n\nA common method for noise amplification for a gate $U$ is to replace it with the sequence $U(U^\\dagger U)^k$ for integer $k \\ge 0$. This sequence is logically equivalent to $U$ but involves a total of $c=2k+1$ gates, thus amplifying the noise associated with each gate application. For a CNOT gate, its unitary $U_{CNOT}$ is self-adjoint ($U_{CNOT}^\\dagger = U_{CNOT}$), so this procedure corresponds to replacing a single CNOT with a sequence of $c=2k+1$ CNOTs.\n\nConsider the preparation of a two-qubit Bell state, $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$, from the initial state $|00\\rangle$. The circuit consists of an ideal Hadamard gate applied to the first qubit, followed by a CNOT gate with the first qubit as control and the second as target.\n\nThe CNOT gate is subject to a depolarizing noise model. Each application of the CNOT gate is described by the quantum channel $\\mathcal{N}(\\rho)$, defined as:\n$$ \\mathcal{N}(\\rho) = (1-p) U_{CNOT} \\rho U_{CNOT}^\\dagger + p \\frac{I_4}{4} $$\nwhere $p$ is the error probability, $\\rho$ is the two-qubit state, and $I_4$ is the two-qubit identity matrix.\n\nTo mitigate the error, the ZNE procedure described above is used. The single CNOT gate in the circuit is replaced by $c$ sequential applications of the noisy CNOT channel $\\mathcal{N}$, where $c$ is the amplification factor. The fidelity of the resulting state $\\rho_{final}(c)$ with the ideal Bell state $|\\Phi^+\\rangle$ is then measured. This fidelity is given by $F(c) = \\langle\\Phi^+ | \\rho_{final}(c) | \\Phi^+\\rangle$.\n\nSuppose the fidelities are measured for amplification factors $c=1$ and $c=3$, yielding the values $F_1$ and $F_3$, respectively. Using a linear extrapolation model, $F_{extrap}(c) = ac + b$, determine the zero-noise extrapolated fidelity $F_0 = F_{extrap}(0)$. Express your answer as a function of the error probability $p$.", "solution": "1. **Fidelity for c=1:** After the ideal Hadamard and one noisy CNOT, the state is $\\rho_1=\\mathcal{N}(|\\psi_{in}\\rangle\\langle\\psi_{in}|)=(1-p)\\ket{\\Phi^+}\\bra{\\Phi^+}+p\\frac{I_4}{4}$. The fidelity is:\n   $$F_1=\\bra{\\Phi^+}\\rho_1\\ket{\\Phi^+}=(1-p)\\cdot1+p\\cdot\\frac{1}{4}=1-\\frac{3p}{4}.$$\n\n2. **Fidelity for c=3:** The noisy process for $c=3$ is $\\rho_3 = \\mathcal{N}(\\mathcal{N}(\\mathcal{N}(|\\psi_{in}\\rangle\\langle\\psi_{in}|)))$. Let $\\rho_k$ be the state after $k$ noisy CNOT applications. Since $U_{CNOT}|\\Phi^+\\rangle=|\\Phi^+\\rangle$, we have $U_{CNOT}\\rho_k U_{CNOT}^\\dagger = \\rho_k$ for $k\\ge 1$. The update rule is $\\rho_k = (1-p)\\rho_{k-1} + p\\frac{I_4}{4}$ for $k>1$. By repeatedly applying this rule starting from $\\rho_1$, we find:\n   $$\\rho_3=(1-p)^3\\ket{\\Phi^+}\\bra{\\Phi^+}+(3p-3p^2+p^3)\\frac{I_4}{4}.$$\n   The fidelity is therefore:\n   $$F_3=(1-p)^3+(3p-3p^2+p^3)\\frac{1}{4} = \\frac{4-9p+9p^2-3p^3}{4}.$$\n\n3. **Linear Extrapolation:** Using a linear model $F_{extrap}(c) = ac+b$, the zero-noise value is $F_0 = b$. From the measurements at $c=1$ and $c=3$, we have $F_1=a+b$ and $F_3=3a+b$. Solving for $b$ gives $F_0=b=\\frac{3F_1-F_3}{2}$.\n   Substituting the expressions for $F_1$ and $F_3$:\n   $$F_0 = \\frac{3\\left(1-\\frac{3p}{4}\\right)-\\frac{4-9p+9p^2-3p^3}{4}}{2} = \\frac{\\frac{12-9p}{4} - \\frac{4-9p+9p^2-3p^3}{4}}{2} = \\frac{8-9p^2+3p^3}{8}.$$", "answer": "$$\\boxed{\\frac{8-9p^2+3p^3}{8}}$$", "id": "121292"}, {"introduction": "A more formal approach to error mitigation involves characterizing the noise channel and computationally inverting its effect during data post-processing. The Pauli Transfer Matrix (PTM) is a standard tool for this purpose, describing how the channel transforms the expectation values of Pauli operators. This practice [@problem_id:121285] guides you through inverting a noise channel's PTM to express an ideal observable as a linear combination of measurable, noisy expectation values, which is the foundational concept behind quasi-probability methods.", "problem": "In quantum information processing, errors in quantum measurements can be characterized and mitigated. The expectation value of a multi-qubit Pauli operator $P$, $\\langle P \\rangle = \\text{tr}(P\\rho)$, where $\\rho$ is the quantum state, is the fundamental quantity of interest. A noisy measurement process can be modeled by a quantum channel $\\mathcal{E}$ that acts on the state just before an ideal measurement, such that the noisy expectation value is $\\langle P \\rangle_{\\text{noisy}} = \\text{tr}(P\\mathcal{E}(\\rho))$.\n\nThe action of a quantum channel on the full set of Pauli operators can be described by a Pauli-Transfer Matrix (PTM). For an $n$-qubit system there are $4^n$ Pauli operators $\\{P_j\\}$, which form a basis for operators. The PTM, denoted $R_\\mathcal{E}$, is a $4^n \\times 4^n$ real matrix that relates the ideal and noisy Pauli expectation values:\n$$\n\\langle P_i \\rangle_{\\text{noisy}} = \\sum_{j=0}^{4^n-1} (R_\\mathcal{E})_{ij} \\langle P_j \\rangle_{\\text{ideal}}\n$$\nThis can be written in vector form as $\\vec{v}_{\\text{noisy}} = R_\\mathcal{E} \\vec{v}_{\\text{ideal}}$. Quantum error mitigation aims to recover the ideal expectation values by inverting this relationship: $\\vec{v}_{\\text{ideal}} = R_\\mathcal{E}^{-1} \\vec{v}_{\\text{noisy}}$. This means an ideal expectation value can be expressed as a linear combination of noisy ones.\n\nConsider a single-qubit experiment. The basis of Pauli operators is $\\{P_0, P_1, P_2, P_3\\} = \\{I, X, Y, Z\\}$. The measurement is affected by a noise channel $\\mathcal{E}$ which is a composition of two processes: first, a coherent error described by a unitary rotation $U = e^{-i\\theta Y/2}$ is applied to the state, and second, this is followed by an incoherent depolarizing error described by the channel $\\mathcal{D}_p(\\sigma) = (1-p)\\sigma + p \\frac{I}{2}$. The parameter $\\theta$ is a small rotation angle, and $p$ is the probability of depolarization, with $0 \\le p < 1$.\n\nThe ideal expectation value of the Pauli $Z$ operator, $\\langle Z \\rangle_{\\text{ideal}}$, can be reconstructed from the noisy expectation values of the four Pauli operators:\n$$\n\\langle Z \\rangle_{\\text{ideal}} = c_I \\langle I \\rangle_{\\text{noisy}} + c_X \\langle X \\rangle_{\\text{noisy}} + c_Y \\langle Y \\rangle_{\\text{noisy}} + c_Z \\langle Z \\rangle_{\\text{noisy}}\n$$\nYour task is to determine the coefficient $c_X$ in this linear combination.", "solution": "We work in the Pauli basis \\{I,X,Y,Z\\} with indices 0,1,2,3. A channelâ€™s Pauli-transfer matrix (PTM) $R$ satisfies \n$$\\langle P_i\\rangle_{\\rm out}=\\sum_j R_{ij}\\langle P_j\\rangle_{\\rm in}\\,. $$\n\n1. Unitary rotation $U=e^{-i\\theta Y/2}$ about $Y$ has PTM \n$$\nR_U=\\begin{pmatrix}\n1 & 0      & 0 & 0\\\\\n0 & \\cos\\theta & 0 & \\sin\\theta\\\\\n0 & 0      & 1 & 0\\\\\n0 & -\\sin\\theta &0 & \\cos\\theta\n\\end{pmatrix}\\!,\n$$\nsince $U XU^\\dagger=X\\cos\\theta+Z\\sin\\theta$ and $U ZU^\\dagger=Z\\cos\\theta-X\\sin\\theta$.\n\n2. Depolarizing channel $D_p(\\sigma)=(1-p)\\sigma + p\\,\\tfrac{I}{2}$ has PTM \n$$\nR_D=\\mathrm{diag}\\bigl(1,\\,1-p,\\,1-p,\\,1-p\\bigr)\\!.\n$$\n\n3. The full channel $\\mathcal E=D_p\\circ U$ has \n$$\nR_E=R_D\\,R_U,\\quad\nR_E^{-1}=R_U^{-1}\\,R_D^{-1}\n$$\nwith \n$$\nR_D^{-1}=\\mathrm{diag}\\bigl(1,\\,(1-p)^{-1},\\,(1-p)^{-1},\\,(1-p)^{-1}\\bigr),\n\\quad\nR_U^{-1}=\\begin{pmatrix}\n1 & 0      & 0 & 0\\\\\n0 & \\cos\\theta & 0 & -\\sin\\theta\\\\\n0 & 0      & 1 & 0\\\\\n0 & \\sin\\theta &0 & \\cos\\theta\n\\end{pmatrix}.\n$$\n\n4. The reconstruction formula \n$$\n\\langle Z\\rangle_{\\rm ideal}\n=\\sum_{Q\\in\\{I,X,Y,Z\\}}c_Q\\,\\langle Q\\rangle_{\\rm noisy}\n$$\nhas coefficients $c_Q=(R_E^{-1})_{Z,Q}$. In particular\n$$\nc_X=(R_E^{-1})_{3,1}\n=\\bigl[R_U^{-1}\\bigr]_{3,1}\\,(1-p)^{-1}\n=\\sin\\theta\\,\\frac1{1-p}.\n$$", "answer": "$$\\boxed{\\frac{\\sin\\theta}{1-p}}$$", "id": "121285"}, {"introduction": "For many problems in quantum chemistry and materials science, the primary goal is to find the ground state energy of a Hamiltonian, $H$. Quantum Subspace Expansion (QSE) is an error mitigation technique specifically designed for this task, which works by finding the best possible energy estimate within a small subspace built around a noisy reference state. This exercise [@problem_id:121253] simulates the data analysis step of a QSE experiment, where you will use a set of pre-computed noisy expectation values to construct and solve the generalized eigenvalue problem at the heart of the method.", "problem": "An experimentalist is studying the two-qubit system described by the Hamiltonian $H = J X_1 X_2 + h Z_1$, where $X_i, Y_i, Z_i$ are the standard Pauli operators for qubit $i$, and $J, h$ are real coupling constants. The goal is to determine the ground state energy of this system using the Quantum Subspace Expansion (QSE) error mitigation technique.\n\nThe experimentalist prepares a noisy quantum state $\\rho$, which is an approximation of the true ground state. To mitigate errors, the Hamiltonian is diagonalized within a subspace spanned by applying a set of operators $\\{O_1, O_2, O_3\\}$ to the noisy state. This procedure leads to a generalized eigenvalue problem (GEP) of the form $\\mathbf{H} \\mathbf{v} = E \\mathbf{S} \\mathbf{v}$, where the matrix elements are given by $H_{ij} = \\text{Tr}(\\rho O_i^\\dagger H O_j)$ and $S_{ij} = \\text{Tr}(\\rho O_i^\\dagger O_j)$. The lowest eigenvalue $E$ of this GEP provides an error-mitigated estimate of the ground state energy.\n\nThe basis for the expansion is chosen as $\\{O_1, O_2, O_3\\}$, where $O_1 = I$ (identity), $O_2 = H$, and $O_3 = X_1 Y_2$. All three operators are Hermitian.\n\nThe experimentalist has measured the necessary expectation values, which are subject to some noise characterized by a parameter $p \\in [0, 1)$. The measured values, in terms of $J$, $h$, and $p$, are as follows:\nLet $E_0 \\equiv \\sqrt{J^2+h^2}$. The measured expectation values $\\langle A \\rangle \\equiv \\text{Tr}(\\rho A)$ are:\n- $\\langle I \\rangle = 1$\n- $\\langle H \\rangle = -(1-p)E_0$\n- $\\langle H^2 \\rangle = E_0^2$\n- $\\langle H^3 \\rangle = -(1-p)E_0^3$\n- $\\langle X_1 Y_2 \\rangle = 0$\n- $\\langle (X_1 Y_2)^2 \\rangle = 1$\n- $\\langle H X_1 Y_2 \\rangle = 0$\n- $\\langle H^2 X_1 Y_2 \\rangle = 0$\n- $\\langle (X_1 Y_2) H (X_1 Y_2) \\rangle = (1-p)E_0$\n\nAll other required matrix elements, such as $\\langle O_i^\\dagger O_j \\rangle$ and $\\langle O_i^\\dagger H O_j \\rangle$, can be deduced from this list (e.g., $\\langle O_j^\\dagger O_i \\rangle = \\langle O_i^\\dagger O_j \\rangle^*$ since the expectation value is real).\n\nYour task is to compute the error-mitigated ground state energy by setting up and solving the generalized eigenvalue problem. Express your final answer in terms of $J$ and $h$.", "solution": "We work in the basis $\\{O_1=I,O_2=H,O_3=X_1Y_2\\}$. Define $E_0=\\sqrt{J^2+h^2}$. From the given expectation values one finds\n\n1. Overlap matrix $S_{ij}=\\langle O_iO_j\\rangle$:\n$$\nS=\\begin{pmatrix}\n\\langle I\\rangle & \\langle H\\rangle & \\langle X_1Y_2\\rangle\\\\\n\\langle H\\rangle & \\langle H^2\\rangle & \\langle H\\,X_1Y_2\\rangle\\\\\n\\langle X_1Y_2\\rangle & \\langle H\\,X_1Y_2\\rangle & \\langle (X_1Y_2)^2\\rangle\n\\end{pmatrix}\n=\\begin{pmatrix}\n1 & -(1-p)E_0 & 0\\\\\n-(1-p)E_0 & E_0^2 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n\n2. Hamiltonian matrix $H_{ij}=\\langle O_i\\,H\\,O_j\\rangle$:\n$$\nH=\\begin{pmatrix}\n\\langle H\\rangle & \\langle H^2\\rangle & \\langle H\\,X_1Y_2\\rangle\\\\\n\\langle H^2\\rangle & \\langle H^3\\rangle & \\langle H^2\\,X_1Y_2\\rangle\\\\\n\\langle X_1Y_2\\,H\\rangle & \\langle X_1Y_2\\,H\\,H\\rangle & \\langle X_1Y_2\\,H\\,X_1Y_2\\rangle\n\\end{pmatrix}\n=\\begin{pmatrix}\n-(1-p)E_0 & E_0^2 & 0\\\\\nE_0^2 & -(1-p)E_0^3 & 0\\\\\n0 & 0 & (1-p)E_0\n\\end{pmatrix}.\n$$\n\n3. The generalized eigenvalue problem $H\\,\\mathbf v=E\\,S\\,\\mathbf v$ decouples into\n(a) a $2\\times2$ block on $\\{I,H\\}$ and \n(b) a single equation on $X_1Y_2$ giving $E=(1-p)E_0$.  \nSolve the $2\\times2$ block via \n$$\\det\\bigl(H_{2\\times2}-E\\,S_{2\\times2}\\bigr)=0.$$\nOne finds the secular equation\n$$p(2-p)\\,E_0^2\\,(E^2-E_0^2)=0\\;\\;\\Longrightarrow\\;\\;E=\\pm E_0.$$\nHence the eigenvalues are $\\{-E_0,\\,+E_0,\\,(1-p)E_0\\}$, and the lowest is\n$$E_{\\rm min}=-E_0=-\\sqrt{J^2+h^2}\\,. $$", "answer": "$$\\boxed{-\\sqrt{J^2 + h^2}}$$", "id": "121253"}]}