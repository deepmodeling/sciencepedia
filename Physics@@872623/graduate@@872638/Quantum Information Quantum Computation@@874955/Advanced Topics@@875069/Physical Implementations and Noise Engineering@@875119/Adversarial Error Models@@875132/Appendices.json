{"hands_on_practices": [{"introduction": "Understanding the impact of adversarial actions often begins with analyzing simple, fundamental quantum circuits. This first exercise models an adversary who can inject a single dephasing error at the most damaging moment during the preparation of a three-qubit GHZ state. By working through this problem, you will practice tracking quantum state evolution through a sequence of gates and a noise channel, and you will learn to adopt an adversarial mindset to identify the worst-case scenario that minimizes the final state fidelity [@problem_id:44176]. This is a foundational skill for assessing the robustness of any quantum protocol.", "problem": "A standard circuit for preparing a three-qubit Greenberger-Horne-Zeilinger (GHZ) state, $|\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)$, from the initial state $|\\psi_0\\rangle = |000\\rangle$ consists of a sequence of three gates:\n1.  $G_1$: A Hadamard gate on qubit 1 ($H_1$).\n2.  $G_2$: A Controlled-NOT gate with qubit 1 as control and qubit 2 as target ($CNOT_{12}$).\n3.  $G_3$: A Controlled-NOT gate with qubit 1 as control and qubit 3 as target ($CNOT_{13}$).\n\nThe ideal final state is $|\\psi_f\\rangle = G_3 G_2 G_1 |\\psi_0\\rangle = |\\text{GHZ}_3\\rangle$.\n\nConsider a scenario where an adversary can introduce an error. The error model is a single-qubit dephasing channel, described by the Kraus operators $E_0 = \\sqrt{1-\\gamma}I$ and $E_1 = \\sqrt{\\gamma}Z$, where $Z$ is the Pauli-Z operator. The action of the channel on a density matrix $\\rho$ is $\\mathcal{E}_\\gamma(\\rho) = E_0 \\rho E_0^\\dagger + E_1 \\rho E_1^\\dagger = (1-\\gamma)\\rho + \\gamma Z\\rho Z$.\n\nThe adversary's goal is to minimize the fidelity of the final state with the ideal state $|\\text{GHZ}_3\\rangle$. They can insert the dephasing channel $\\mathcal{E}_\\gamma$ exactly once, on any single qubit $j \\in \\{1, 2, 3\\}$, immediately after any one of the gates $G_k$ where $k \\in \\{1, 2, 3\\}$.\n\nThe fidelity between a pure state $|\\psi\\rangle$ and a mixed state $\\sigma$ is given by $F(|\\psi\\rangle, \\sigma) = \\langle\\psi|\\sigma|\\psi\\rangle$.\n\nCalculate the worst-case fidelity $F_{worst}$, which is the minimum possible fidelity achievable by the adversary. Your answer should be an expression in terms of the dephasing strength $\\gamma$.", "solution": "The fidelity between the ideal state $ |\\text{GHZ}_3\\rangle $ and the final state $ \\sigma $ is given by:\n\n$$\nF(|\\text{GHZ}_3\\rangle, \\sigma) = \\langle \\text{GHZ}_3 | \\sigma | \\text{GHZ}_3 \\rangle.\n$$\n\nThe dephasing channel $ \\mathcal{E}_\\gamma $ with Kraus operators $ E_0 = \\sqrt{1-\\gamma} I $ and $ E_1 = \\sqrt{\\gamma} Z $ is inserted once after gate $ G_k $ on qubit $ j $. The state after gate $ G_k $ is pure, denoted $ |\\psi_k\\rangle $. After the channel, the state becomes:\n\n$$\n\\rho_k = \\mathcal{E}_\\gamma(|\\psi_k\\rangle\\langle\\psi_k|) = (1-\\gamma) |\\psi_k\\rangle\\langle\\psi_k| + \\gamma Z_j |\\psi_k\\rangle\\langle\\psi_k| Z_j.\n$$\n\nThe remaining gates $ U_{\\text{rem}} $ (from $ G_{k+1} $ to $ G_3 $) are applied, so the final state is:\n\n$$\n\\sigma = U_{\\text{rem}} \\rho_k U_{\\text{rem}}^\\dagger = (1-\\gamma) U_{\\text{rem}} |\\psi_k\\rangle\\langle\\psi_k| U_{\\text{rem}}^\\dagger + \\gamma U_{\\text{rem}} (Z_j |\\psi_k\\rangle\\langle\\psi_k| Z_j) U_{\\text{rem}}^\\dagger.\n$$\n\nDefine:\n- $ |\\phi\\rangle = U_{\\text{rem}} |\\psi_k\\rangle = |\\text{GHZ}_3\\rangle $ (ideal final state without error),\n- $ |\\phi_j\\rangle = U_{\\text{rem}} (Z_j |\\psi_k\\rangle) $ (state after error and remaining gates).\n\nThen:\n\n$$\n\\sigma = (1-\\gamma) |\\phi\\rangle\\langle\\phi| + \\gamma |\\phi_j\\rangle\\langle\\phi_j|.\n$$\n\nThe fidelity is:\n\n$$\nF = \\langle \\text{GHZ}_3 | \\sigma | \\text{GHZ}_3 \\rangle = (1-\\gamma) \\langle \\text{GHZ}_3 | \\phi \\rangle \\langle \\phi | \\text{GHZ}_3 \\rangle + \\gamma \\langle \\text{GHZ}_3 | \\phi_j \\rangle \\langle \\phi_j | \\text{GHZ}_3 \\rangle.\n$$\n\nSince $ |\\phi\\rangle = |\\text{GHZ}_3\\rangle $, $ \\langle \\text{GHZ}_3 | \\phi \\rangle = 1 $, and:\n\n$$\nF = (1-\\gamma) \\cdot 1 + \\gamma |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 - \\gamma + \\gamma |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2.\n$$\n\n\nNow, compute $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 $ for each insertion point and qubit.\n\n- **After $ G_1 $ (Hadamard on qubit 1):**  \n  Initial state: $ |\\psi_0\\rangle = |000\\rangle $.  \n  After $ G_1 $: $ |\\psi_1\\rangle = H_1 |000\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |100\\rangle) $.  \n  Apply $ Z_j $:  \n  - $ j=1 $: $ Z_1 |\\psi_1\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |100\\rangle) $.  \n    Apply $ G_2 $ (CNOT$_{12}$): $ \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $.  \n    Apply $ G_3 $ (CNOT$_{13}$): $ \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $.  \n    So $ |\\phi_j\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $.  \n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = \\frac{1}{2} (\\langle 000|000\\rangle - \\langle 000|111\\rangle + \\langle 111|000\\rangle - \\langle 111|111\\rangle) = \\frac{1}{2}(1 - 0 + 0 - 1) = 0 $.  \n    Thus, $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $.  \n  - $ j=2 $: $ Z_2 |\\psi_1\\rangle = |\\psi_1\\rangle $ (no change, as second qubit is $ |0\\rangle $).  \n    After $ G_2 $ and $ G_3 $: $ |\\phi_j\\rangle = |\\text{GHZ}_3\\rangle $, so $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $.  \n  - $ j=3 $: Similar to $ j=2 $, $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $.  \n  Fidelities: $ j=1 $: $ F = 1 - \\gamma $, $ j=2,3 $: $ F = 1 $.\n\n- **After $ G_2 $ (CNOT$_{12}$):**  \n  After $ G_2 $: $ |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |110\\rangle) $.  \n  Apply $ Z_j $:  \n  - $ j=1 $: $ Z_1 |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $.  \n    Apply $ G_3 $ (CNOT$_{13}$): $ \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $.  \n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = 0 $, so $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $.  \n  - $ j=2 $: $ Z_2 |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $ (same as $ j=1 $).  \n    After $ G_3 $: $ |\\phi_j\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $, so $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $.  \n  - $ j=3 $: $ Z_3 |\\psi_2\\rangle = |\\psi_2\\rangle $ (no change).  \n    After $ G_3 $: $ |\\phi_j\\rangle = |\\text{GHZ}_3\\rangle $, so $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $.  \n  Fidelities: $ j=1,2 $: $ F = 1 - \\gamma $, $ j=3 $: $ F = 1 $.\n\n- **After $ G_3 $ (CNOT$_{13}$):**  \n  After $ G_3 $: $ |\\psi_3\\rangle = |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |111\\rangle) $.  \n  Apply $ Z_j $ (no remaining gates):  \n  - $ j=1 $: $ Z_1 |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $.  \n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = \\langle \\text{GHZ}_3 | Z_1 | \\text{GHZ}_3 \\rangle = 0 $, so $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $.  \n  - $ j=2,3 $: Similarly, $ Z_j |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $, so $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $.  \n  Fidelities: All $ j $: $ F = 1 - \\gamma $.\n\nThe minimum fidelity over all cases is $ 1 - \\gamma $, achieved when:\n- After $ G_1 $ on qubit 1,\n- After $ G_2 $ on qubit 1 or 2,\n- After $ G_3 $ on any qubit.\nThus, $ F_{\\text{worst}} = 1 - \\gamma $.", "answer": "$$ \\boxed{1 - \\gamma} $$", "id": "44176"}, {"introduction": "Quantum error correction provides a powerful defense against noise, but its effectiveness is fundamentally tied to the assumptions made about that noise. This next practice explores this critical dependence by examining the 3-qubit bit-flip code, which is designed to perfectly correct single bit-flip errors. You will investigate what happens when an adversary, instead of introducing a simple bit-flip, applies a more general unitary error [@problem_id:44102]. Calculating the worst-case average fidelity reveals how a targeted, adversarial error can completely bypass a code's defenses, highlighting the crucial distinction between stochastic and adversarial error models.", "problem": "The 3-qubit bit-flip code is a simple quantum error-correcting code that encodes one logical qubit into three physical qubits. The logical basis states are defined as $|0_L\\rangle = |000\\rangle$ and $|1_L\\rangle = |111\\rangle$. An arbitrary pure state of the logical qubit can be written as $|\\psi_L\\rangle = \\alpha |0_L\\rangle + \\beta |1_L\\rangle$, where $\\alpha, \\beta$ are complex coefficients satisfying $|\\alpha|^2 + |\\beta|^2 = 1$.\n\nThe standard error correction procedure for this code involves measuring two syndrome operators, $S_1 = Z_1 Z_2$ and $S_2 = Z_2 Z_3$. The measurement outcomes $(\\lambda_1, \\lambda_2)$ of $(S_1, S_2)$ indicate the error type:\n- $(+1, +1)$: No error detected. Correction: apply identity $I$.\n- $(-1, +1)$: Bit-flip ($X$) on qubit 1. Correction: apply $X_1$.\n- $(+1, -1)$: Bit-flip ($X$) on qubit 3. Correction: apply $X_3$.\n- $(-1, -1)$: Bit-flip ($X$) on qubit 2. Correction: apply $X_2$.\n\nConsider an adversarial setting where an adversary can apply an arbitrary single-qubit unitary error, $U$, to any one of the three physical qubits. The adversary knows the initial state $|\\psi_L\\rangle$ and chooses the unitary $U$ and the location of the error (i.e., which of the three qubits to apply it to) to maximize the damage. The damage is quantified by the fidelity between the initial state $|\\psi_L\\rangle$ and the final state $\\rho_f$ after the error and correction cycle, $F = \\langle\\psi_L|\\rho_f|\\psi_L\\rangle$.\n\nYour task is to compute the worst-case average fidelity, $F_{WC}$. This is defined as the minimum fidelity, minimized over all adversarial choices (the unitary $U$ and the qubit it acts on), which has then been averaged over all possible initial logical pure states $|\\psi_L\\rangle$ (assuming a uniform distribution over the logical Bloch sphere).\n\nWhat is the value of $F_{WC}$?", "solution": "1. The error-correction channel on the logical qubit has Kraus operators arising from the two syndromes (no-flip and flip on qubit 1), \n$$A_0=\\begin{pmatrix}\\alpha_0&0\\\\0&\\beta_1\\end{pmatrix},\\qquad\nA_1=\\begin{pmatrix}\\alpha_1&0\\\\0&\\beta_0\\end{pmatrix},$$\nin the $\\{|0_L\\rangle,|1_L\\rangle\\}$ basis, where the single-qubit error $U$ on qubit 1 is expanded as \n$$U=u_0 I+u_1 X+u_2 Y+u_3 Z,$$\nso that \n$$\\alpha_0=u_0+u_3,\\;\\alpha_1=u_1+i\\,u_2,\\;\n\\beta_0=u_1-i\\,u_2,\\;\\beta_1=u_0-u_3.$$\n2. For a $d=2$ channel with Kraus $\\{A_i\\}$ the average fidelity is \n$$F_{\\rm avg}=\\frac{\\sum_i|\\Tr A_i|^2 + d}{d(d+1)} \n=\\frac{|\\Tr A_0|^2+|\\Tr A_1|^2+2}{6}.$$\nHere \n$$\\Tr A_0=(\\alpha_0+\\beta_1)=2u_0,\\quad \n\\Tr A_1=(\\alpha_1+\\beta_0)=2u_1,$$\nand unitarity of $U$ gives $|u_0|^2+|u_1|^2+|u_2|^2+|u_3|^2=1$.  Hence\n$$F_{\\rm avg}=\\frac{4(|u_0|^2+|u_1|^2)+2}{6}=\\frac{2(|u_0|^2+|u_1|^2)+1}{3}.$$\n3. The adversary minimizes this by choosing $u_0=u_1=0$ (e.g.\\ $U=Z$), so $|u_0|^2+|u_1|^2=0$ and \n$$F_{WC}=\\frac{1}{3}.$$", "answer": "$$\\boxed{1/3}$$", "id": "44102"}, {"introduction": "Moving beyond foundational circuits and codes, we now consider the impact of adversarial errors on near-term quantum algorithms. This exercise focuses on the Variational Quantum Eigensolver (VQE), where the goal is to find the ground state energy of a Hamiltonian. Here, the adversary's objective is not merely to degrade state fidelity, but to directly corrupt the final computational resultâ€”the energy estimate [@problem_id:44218]. This problem offers an elegant, geometric perspective using the Bloch sphere to determine how an adversary can orient a coherent rotational error to cause the maximum possible deviation in the measured energy, providing insight into the vulnerability of variational algorithms.", "problem": "A single-qubit system is described by the Hamiltonian $H = \\cos(\\alpha) Z + \\sin(\\alpha) X$, where $X$ and $Z$ are the Pauli matrices and $\\alpha$ is a real parameter. To find the ground state energy of this system, a Variational Quantum Eigensolver (VQE) is employed. The VQE uses a parameterized trial state $|\\psi(\\theta)\\rangle = U(\\theta)|0\\rangle$, where $|0\\rangle$ is the computational basis state and the unitary ansatz is a rotation around the y-axis, $U(\\theta) = R_y(\\theta) = \\exp(-i\\frac{\\theta}{2} Y)$. Here, $Y$ is the Pauli-Y matrix and $\\theta$ is the variational parameter.\n\nAssume that the VQE optimization has been performed successfully in a noiseless environment, yielding the optimal parameter $\\theta^*$ that minimizes the energy expectation value $E(\\theta) = \\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$. The resulting state is thus the true ground state of the Hamiltonian, $|\\psi_{opt}\\rangle = |\\psi(\\theta^*)\\rangle$.\n\nNow, consider an adversarial scenario where a malicious agent introduces a coherent error into the computation. This error is modeled by the application of a single additional quantum gate, $U_{err}$, immediately after the state preparation. The state of the system becomes $|\\tilde{\\psi}\\rangle = U_{err}|\\psi_{opt}\\rangle$. The error gate is a rotation of angle $\\epsilon$ around an arbitrary axis $\\vec{n}$ (a unit vector in $\\mathbb{R}^3$), given by $U_{err} = R_{\\vec{n}}(\\epsilon) = \\exp(-i\\frac{\\epsilon}{2} \\vec{n}\\cdot\\vec{\\sigma})$, where $\\vec{\\sigma} = (X, Y, Z)$ is the vector of Pauli matrices.\n\nThe adversary's goal is to maximize the energy of the final state. They can freely choose the rotation axis $\\vec{n}$. Your task is to determine the worst-case energy error, $\\Delta E$, which is defined as the difference between the maximum possible energy expectation value achievable by the adversary and the true ground state energy $E_g$.\n\nFind an expression for this worst-case energy error, $\\Delta E = \\left(\\max_{\\vec{n}} \\langle\\tilde{\\psi}|H|\\tilde{\\psi}\\rangle\\right) - E_g$, as a function of the error angle $\\epsilon$.", "solution": "The Hamiltonian is $H = \\cos(\\alpha) Z + \\sin(\\alpha) X$. Its eigenvalues are found from the characteristic equation:\n$$\n\\det(H - \\lambda I) = \\lambda^2 - (\\cos^2 \\alpha + \\sin^2 \\alpha) = \\lambda^2 - 1 = 0,\n$$\nso the eigenvalues are $\\pm 1$. The ground state energy is $E_g = -1$.\n\nThe ground state $|\\psi_{\\text{opt}}\\rangle$ has a Bloch vector $\\vec{v}$ antiparallel to the Hamiltonian vector $\\vec{h} = (\\sin \\alpha, 0, \\cos \\alpha)$, so $\\vec{v} = -\\vec{h} = (-\\sin \\alpha, 0, -\\cos \\alpha)$. The magnitude $|\\vec{h}| = \\sqrt{\\sin^2 \\alpha + \\cos^2 \\alpha} = 1$, so $\\vec{v} \\cdot \\vec{h} = -1$.\n\nThe error gate $U_{\\text{err}} = R_{\\vec{n}}(\\epsilon)$ rotates the Bloch vector of $|\\psi_{\\text{opt}}\\rangle$ by angle $\\epsilon$ around axis $\\vec{n}$. The energy expectation after rotation is:\n$$\n\\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = \\vec{h} \\cdot \\vec{v}',\n$$\nwhere $\\vec{v}' = R_{\\vec{n}}(\\epsilon) \\vec{v}$.\n\nSubstituting $\\vec{v} = -\\vec{h}$:\n$$\n\\vec{v}' = R_{\\vec{n}}(\\epsilon) (-\\vec{h}).\n$$\nThe dot product becomes:\n$$\n\\vec{h} \\cdot \\vec{v}' = \\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) (-\\vec{h})] = -\\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) \\vec{h}].\n$$\nUsing the rotation formula for a vector $\\vec{u}$ around $\\vec{n}$:\n$$\nR_{\\vec{n}}(\\epsilon) \\vec{u} = \\cos \\epsilon \\, \\vec{u} + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{u}) \\vec{n} + \\sin \\epsilon \\, (\\vec{n} \\times \\vec{u}).\n$$\nThus:\n$$\n\\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) \\vec{h}] = \\vec{h} \\cdot \\left[ \\cos \\epsilon \\, \\vec{h} + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h}) \\vec{n} + \\sin \\epsilon \\, (\\vec{n} \\times \\vec{h}) \\right].\n$$\nExpanding the dot product:\n$$\n= \\cos \\epsilon \\, (\\vec{h} \\cdot \\vec{h}) + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h}) (\\vec{h} \\cdot \\vec{n}) + \\sin \\epsilon \\, \\vec{h} \\cdot (\\vec{n} \\times \\vec{h}).\n$$\nSince $\\vec{h} \\cdot \\vec{h} = 1$, $\\vec{h} \\cdot (\\vec{n} \\times \\vec{h}) = \\vec{n} \\cdot (\\vec{h} \\times \\vec{h}) = 0$, and $(\\vec{h} \\cdot \\vec{n})^2 = (\\vec{n} \\cdot \\vec{h})^2$:\n$$\n= \\cos \\epsilon + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2.\n$$\nTherefore:\n$$\n\\vec{h} \\cdot \\vec{v}' = - \\left[ \\cos \\epsilon + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2 \\right].\n$$\nThe energy expectation is:\n$$\n\\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = -\\cos \\epsilon - (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2.\n$$\nMaximizing over $\\vec{n}$ requires minimizing $(\\vec{n} \\cdot \\vec{h})^2$, as $1 - \\cos \\epsilon \\geq 0$. The minimum is $0$, achieved when $\\vec{n}$ is perpendicular to $\\vec{h}$. Thus:\n$$\n\\max_{\\vec{n}} \\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = -\\cos \\epsilon.\n$$\nThe worst-case energy error is:\n$$\n\\Delta E = \\left( \\max_{\\vec{n}} \\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle \\right) - E_g = (-\\cos \\epsilon) - (-1) = 1 - \\cos \\epsilon.\n$$", "answer": "$$\\boxed{1 - \\cos \\epsilon}$$", "id": "44218"}]}