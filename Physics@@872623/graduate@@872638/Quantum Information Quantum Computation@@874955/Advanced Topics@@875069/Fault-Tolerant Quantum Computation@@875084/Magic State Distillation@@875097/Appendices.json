{"hands_on_practices": [{"introduction": "Our first exercise provides a concrete look at the primary goal of magic state distillation: error suppression. We will analyze a hypothetical 8-to-1 protocol based on a distance-3 code, where the dominant failure mechanism is the miscorrection of two-qubit errors. By calculating the leading-order output infidelity, you will directly derive the quadratic relationship between input and output error rates, a hallmark of many foundational distillation protocols. [@problem_id:83563]", "problem": "The distillation of magic states is a crucial subroutine in many schemes for fault-tolerant quantum computation. This process consumes multiple noisy magic states to produce a single magic state of higher fidelity. In this problem, we will analyze the performance of a particular magic state distillation protocol.\n\nThe magic state in question is the $|H\\rangle$ state, defined as $|H\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$, which is the $+1$ eigenstate of the Pauli-X operator. The protocol starts with eight noisy input states, where each state $\\rho_{in}$ is the result of a Z-error channel acting on an ideal $|H\\rangle$ state. The density matrix of each input state is given by:\n$$ \\rho_{in} = (1-\\epsilon)|H\\rangle\\langle H| + \\epsilon|-\\rangle\\langle -| $$\nwhere $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$ and $\\epsilon$ is the initial infidelity. An error on a given qubit corresponds to a Pauli $Z$ operator flipping the state from $|H\\rangle$ to $|-\\rangle$.\n\nThe distillation protocol is based on a specific $[[8, 1, 3]]$ quantum error-correcting code. A distance $d=3$ code can correct any single-qubit error. The protocol proceeds as follows:\n1.  Eight physical qubits are prepared, each in an identical noisy state $\\rho_{in}$. This initial 8-qubit state represents a noisy version of the logical $|\\bar{H}\\rangle$ state.\n2.  The seven stabilizer generators of the $[[8, 1, 3]]$ code are measured.\n3.  A standard error-correction procedure is applied based on the measurement outcomes (the error syndrome).\n\nThe properties of this specific code and its decoding procedure are as follows:\n*   Any single-qubit $Z$ error is perfectly corrected, meaning the final state has no logical error.\n*   Any two-qubit $Z$ error (i.e., an error of the form $Z_i Z_j$ for $i \\neq j$) is mis-corrected in such a way that it becomes a logical $Z_L$ error on the encoded qubit.\n*   Errors of weight three or higher may or may not be corrected, but their contribution to the final infidelity can be ignored for this problem.\n\nYour task is to calculate the infidelity $\\epsilon_{out}$ of the final, single-qubit logical state. The output infidelity is defined as the probability that the final state is the logical $|\\bar{-}\\rangle$ state. Please provide the expression for $\\epsilon_{out}$ to the leading, non-vanishing order in $\\epsilon$.", "solution": "The output infidelity $\\epsilon_{out}$ is defined as the probability that the final state is the logical $|\\bar{-}\\rangle$ state. This occurs when a logical $Z_L$ error is present after error correction.\n\nEach input state undergoes a Z-error channel, and the errors on different qubits are independent. The probability of a Z error on any single qubit is $\\epsilon$, and the probability of no error is $1 - \\epsilon$.\n\nBased on the properties of the $[[8, 1, 3]]$ code:\n- Any single-qubit Z error is perfectly corrected, resulting in no logical error.\n- Any two-qubit Z error (i.e., $Z_i Z_j$ for $i \\neq j$) is mis-corrected to a logical $Z_L$ error.\n- Errors of weight three or higher can be ignored for the leading order in $\\epsilon$, as per the problem statement.\n\nThe event leading to a logical $Z_L$ error at the leading non-vanishing order is exactly two Z errors occurring on the eight qubits. The probability of exactly two errors is given by the binomial distribution:\n\n$$ P(\\text{exactly two errors}) = \\binom{8}{2} \\epsilon^2 (1 - \\epsilon)^{6} $$\n\nExpanding $(1 - \\epsilon)^6$:\n\n$$ (1 - \\epsilon)^6 = 1 - 6\\epsilon + 15\\epsilon^2 - 20\\epsilon^3 + \\cdots $$\n\nMultiplying by $\\binom{8}{2} \\epsilon^2$:\n\n$$ P(\\text{exactly two errors}) = \\binom{8}{2} \\epsilon^2 (1 - 6\\epsilon + 15\\epsilon^2 - \\cdots) = \\binom{8}{2} \\epsilon^2 - 6\\binom{8}{2} \\epsilon^3 + \\cdots $$\n\nThe leading non-vanishing term is $\\binom{8}{2} \\epsilon^2$. Calculating the binomial coefficient:\n\n$$ \\binom{8}{2} = \\frac{8!}{2! \\, 6!} = \\frac{8 \\times 7}{2 \\times 1} = 28 $$\n\nThus:\n\n$$ \\epsilon_{out} = 28 \\epsilon^2 + \\mathcal{O}(\\epsilon^3) $$\n\nTherefore, to the leading non-vanishing order in $\\epsilon$, the output infidelity is $28 \\epsilon^2$.", "answer": "$$ \\boxed{28 \\epsilon^{2}} $$", "id": "83563"}, {"introduction": "Having seen quadratic error suppression, we now examine a more powerful and widely studied example: the 15-to-1 distillation protocol. This practice explores how using a larger, more structured code—the $[[15, 1, 3]]$ Reed-Muller code—can achieve a superior, cubic reduction in error probability. Analyzing this protocol will deepen your understanding of the relationship between a code's structure and the distillation performance it enables. [@problem_id:105364]", "problem": "In fault-tolerant quantum computation, non-Clifford gates such as the $T$ gate are essential for achieving universality. Since these gates are notoriously difficult to implement with high fidelity, protocols for \"magic state distillation\" are employed. These protocols take multiple noisy copies of a \"magic state\" as input and produce a single copy with much higher fidelity. The purified magic state can then be used to implement the desired non-Clifford gate via a teleportation-based circuit.\n\nA key magic state for the $T$ gate, $T = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix}$, is the state $|A\\rangle = T|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$.\nConsider a supply of noisy magic states, where each state is described by the density matrix\n$$ \\rho_{in} = (1-\\epsilon) |A\\rangle\\langle A| + \\epsilon |A^{\\perp}\\rangle\\langle A^{\\perp}| $$\nHere, $|A^{\\perp}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - e^{i\\pi/4}|1\\rangle)$ is the state orthogonal to $|A\\rangle$, and $\\epsilon$ is the initial error probability. The initial fidelity of these states is $F_{in} = \\langle A|\\rho_{in}|A\\rangle = 1-\\epsilon$. It can be shown that this error model is equivalent to a quantum channel that applies a Pauli $Z$ error to the ideal state $|A\\rangle$ with probability $\\epsilon$.\n\nThe 15-to-1 magic state distillation protocol, first proposed by Bravyi and Kitaev, takes 15 copies of $\\rho_{in}$ and attempts to produce one higher-fidelity state $\\rho_{out}$. The protocol is based on the [[15, 1, 3]] quantum Reed-Muller code. It works by encoding the logical state into 15 physical qubits and then measuring the stabilizer generators of the code. If the measurement syndrome is trivial (all outcomes are $+1$), the output state is accepted. Otherwise, it is discarded.\n\nFor your calculation, you will need the following essential properties of the [[15, 1, 3]] code used in this protocol, which is a CSS code derived from the classical $[15, 11, 3]$ Hamming code:\n1.  The code has a distance of $d=3$. This implies that all error patterns affecting one or two qubits are detected by the stabilizer measurements.\n2.  The error model corresponds to Pauli $Z$ errors. An error operator consisting of a product of $Z$s on a set of qubits $S$, denoted $Z_S$, is undetected if it commutes with all stabilizers. For this specific code, this occurs if $S$ is a codeword in the classical [15, 11, 3] Hamming code.\n3.  If an undetected error occurs, it corrupts the output state, causing a logical error. The lowest weight of such error operators is 3. The number of classical codewords of weight 3 in the $[15, 11, 3]$ Hamming code is exactly 35.\n\nAssuming the initial error probability $\\epsilon$ is small, calculate the fidelity $F_{out}$ of the output state $\\rho_{out}$ from the 15-to-1 distillation protocol. Your answer should be an expression in terms of $\\epsilon$, accurate to the lowest non-vanishing order of $\\epsilon$.", "solution": "The fidelity of the output state, $F_{\\text{out}}$, is the probability that the output state is correct given that it is accepted. The protocol accepts the state when the error pattern is trivial, i.e., corresponds to a logical identity operation. In this CSS code construction, this occurs when the Z-error pattern is a codeword in the underlying classical code.\n\nThe probability that no error occurs on any of the 15 qubits is $P(\\text{no error}) = (1-\\epsilon)^{15}$. This is the event that leads to a correct output state.\n\nThe protocol accepts if the error pattern is a codeword in the classical [15, 11, 3] Hamming code. A logical error occurs if the error pattern is a *non-zero* codeword. The lowest weight of such codewords is 3.\nThe probability of a specific weight-3 codeword error occurring is $\\epsilon^3 (1-\\epsilon)^{12}$.\nSince there are 35 such codewords, the total probability of a leading-order logical error is $P(\\text{logical error}) = 35 \\epsilon^3 (1-\\epsilon)^{12} + \\mathcal{O}(\\epsilon^4)$.\n\nThe total acceptance probability, $P_{\\text{accept}}$, is the sum of the probabilities of all error patterns that are codewords. To leading order, this is dominated by the no-error event and the weight-3 error events.\n$$ P_{\\text{accept}} = P(\\text{no error}) + P(\\text{logical error}) \\approx (1-\\epsilon)^{15} + 35 \\epsilon^3 (1-\\epsilon)^{12} $$\n\nThe output fidelity is the ratio of the probability of the correct outcome to the probability of any accepted outcome:\n$$ F_{\\text{out}} = \\frac{P(\\text{no error})}{P_{\\text{accept}}} = \\frac{(1-\\epsilon)^{15}}{(1-\\epsilon)^{15} + 35 \\epsilon^3 (1-\\epsilon)^{12}} $$\n\nFor small $\\epsilon$, we can approximate the terms.\n$(1-\\epsilon)^n \\approx 1 - n\\epsilon$.\n$$ F_{\\text{out}} \\approx \\frac{1}{(1 + \\frac{35 \\epsilon^3 (1-\\epsilon)^{12}}{(1-\\epsilon)^{15}})} = \\frac{1}{1 + 35 \\epsilon^3 (1-\\epsilon)^{-3}} $$\n\nUsing the binomial expansion $(1-x)^{-n} \\approx 1+nx$ for small $x$:\n$(1-\\epsilon)^{-3} \\approx 1 + 3\\epsilon$.\n$$ F_{\\text{out}} \\approx \\frac{1}{1 + 35 \\epsilon^3 (1+3\\epsilon)} = \\frac{1}{1 + 35\\epsilon^3 + \\mathcal{O}(\\epsilon^4)} $$\n\nUsing the expansion $\\frac{1}{1+x} \\approx 1 - x$ for small $x$:\n$$ F_{\\text{out}} \\approx 1 - 35\\epsilon^3 $$\n\nThe output infidelity is $\\epsilon_{\\text{out}} = 1 - F_{\\text{out}} \\approx 35\\epsilon^3$. This shows the characteristic cubic error suppression of the 15-to-1 protocol. The fidelity to the lowest non-vanishing order of $\\epsilon$ is $1 - 35\\epsilon^3$.", "answer": "$$ \\boxed{1 - 35\\epsilon^{3}} $$", "id": "105364"}, {"introduction": "Effective distillation relies on the entire process of error detection *and* correction. This final exercise moves beyond analyzing input error rates to investigate what happens when the error correction machinery itself malfunctions. You will trace the consequences of a specific fault—applying the wrong Pauli correction—to determine the resulting logical error and calculate its impact on the output state's fidelity, highlighting the crucial link between physical operations and the logical information they protect. [@problem_id:98634]", "problem": "A fault-tolerant quantum computation scheme uses the five-qubit `[[5,1,3]]` error-correcting code to prepare high-fidelity T-states. The five-qubit code is defined by the stabilizer generators:\n$$ g_1 = X \\otimes Z \\otimes Z \\otimes X \\otimes I $$\n$$ g_2 = I \\otimes X \\otimes Z \\otimes Z \\otimes X $$\n$$ g_3 = X \\otimes I \\otimes X \\otimes Z \\otimes Z $$\n$$ g_4 = Z \\otimes X \\otimes I \\otimes X \\otimes Z $$\nThe corresponding logical Pauli operators are:\n$$ \\bar{X} = X \\otimes X \\otimes X \\otimes X \\otimes X $$\n$$ \\bar{Z} = Z \\otimes Z \\otimes Z \\otimes Z \\otimes Z $$\n$$ \\bar{Y} = i\\bar{X}\\bar{Z} $$\n\nThe protocol is designed to produce a logical T-state, denoted $|T\\rangle_L$, which corresponds to the ideal single-qubit T-state $|T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$ in the logical basis $\\{|0\\rangle_L, |1\\rangle_L\\}$.\n\nSuppose that during one run of the protocol, a single-qubit Pauli Z error occurs on the first physical qubit, described by the operator $E = Z \\otimes I \\otimes I \\otimes I \\otimes I$. The error is detected by measuring the stabilizer generators. However, due to a hardware malfunction, an incorrect recovery operation is applied. Instead of the proper correction, a Pauli X operator is applied to the first physical qubit, $C = X \\otimes I \\otimes I \\otimes I \\otimes I$.\n\nAssume the protocol proceeds as if the correction was successful, meaning the state is then processed by the subsequent logical operations. The net effect of the initial error and the faulty correction is a residual error operator $E_{res} = C \\cdot E$ acting on the encoded logical state $|T\\rangle_L$. The action of a physical error operator on the codespace is equivalent to the action of a corresponding logical Pauli operator. This logical operator is determined by the commutation relations of the physical error operator with the logical operators $\\bar{X}$ and $\\bar{Z}$.\n\nCalculate the fidelity, $F = |\\langle T|_L |\\psi_{out}\\rangle_L|^2$, between the ideal logical T-state $|T\\rangle_L$ and the final state of the logical qubit, $|\\psi_{out}\\rangle_L$.", "solution": "The initial error is $E = Z_1$. The faulty correction is $C = X_1$. The residual error operator is $E_{\\text{res}} = C \\cdot E = X_1 Z_1$.\nSince $X_1 Z_1 = i Y_1$, the residual error is a Pauli $Y$ operator on the first qubit, up to a global phase which does not affect the state vector or fidelity. So, $E_{\\text{res}} \\propto Y_1$.\n\nWe need to determine which logical operator ($I_L, X_L, Y_L, Z_L$) this physical operator corresponds to. We do this by checking its commutation relations with the logical operators $\\bar{X}$ and $\\bar{Z}$.\n\n1.  Commutation with $\\bar{X} = X_1 X_2 X_3 X_4 X_5$:\n    The residual error $Y_1$ acts on the first qubit. The logical operator $\\bar{X}$ has an $X_1$ on the first qubit. Since $\\{Y_1, X_1\\} = Y_1 X_1 + X_1 Y_1 = (-iZ_1) + (iZ_1) = 0$, $Y_1$ anti-commutes with $\\bar{X}$.\n\n2.  Commutation with $\\bar{Z} = Z_1 Z_2 Z_3 Z_4 Z_5$:\n    The logical operator $\\bar{Z}$ has a $Z_1$ on the first qubit. Since $\\{Y_1, Z_1\\} = Y_1 Z_1 + Z_1 Y_1 = (iX_1) + (-iX_1) = 0$, $Y_1$ anti-commutes with $\\bar{Z}$.\n\nAn operator that anti-commutes with both $\\bar{X}$ and $\\bar{Z}$ acts as a logical $\\bar{Y}$ operator on the codespace. Therefore, the final state is $|\\psi_{out}\\rangle_L = \\bar{Y} |T\\rangle_L$ (up to a global phase).\n\nThe ideal logical T-state is $|T\\rangle_L = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + e^{i\\pi/4} |1\\rangle_L)$.\nThe action of $\\bar{Y}$ on the logical basis states is $\\bar{Y}|0\\rangle_L = i|1\\rangle_L$ and $\\bar{Y}|1\\rangle_L = -i|0\\rangle_L$.\nApplying $\\bar{Y}$ to the logical T-state:\n$$ |\\psi_{out}\\rangle_L = \\bar{Y} |T\\rangle_L = \\frac{1}{\\sqrt{2}} \\left( \\bar{Y}|0\\rangle_L + e^{i\\pi/4} \\bar{Y}|1\\rangle_L \\right) = \\frac{1}{\\sqrt{2}} \\left( i|1\\rangle_L - i e^{i\\pi/4}|0\\rangle_L \\right) = \\frac{-i e^{i\\pi/4}}{\\sqrt{2}} \\left(|0\\rangle_L + i e^{-i\\pi/4}|1\\rangle_L \\right) $$\n\nThe fidelity is $F = |\\langle T|_L |\\psi_{out}\\rangle_L|^2$. Let's compute the inner product $\\langle T|_L |\\psi_{out}\\rangle_L$:\n$$ \\langle T|_L = \\frac{1}{\\sqrt{2}} (\\langle 0|_L + e^{-i\\pi/4} \\langle 1|_L) $$\n$$ \\langle T|_L |\\psi_{out}\\rangle_L = \\frac{1}{\\sqrt{2}} (\\langle 0|_L + e^{-i\\pi/4} \\langle 1|_L) \\cdot \\frac{1}{\\sqrt{2}} (i|1\\rangle_L - i e^{i\\pi/4}|0\\rangle_L) $$\n$$ = \\frac{i}{2} \\left( \\langle 0|_L|1\\rangle_L - e^{i\\pi/4}\\langle 0|_L|0\\rangle_L + e^{-i\\pi/4}\\langle 1|_L|1\\rangle_L - e^{-i\\pi/4}e^{i\\pi/4}\\langle 1|_L|0\\rangle_L \\right) $$\nUsing orthonormality of the logical basis states:\n$$ = \\frac{i}{2} \\left( 0 - e^{i\\pi/4}(1) + e^{-i\\pi/4}(1) - 1(0) \\right) = \\frac{i}{2} (e^{-i\\pi/4} - e^{i\\pi/4}) $$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$:\n$$ = \\frac{i}{2} (-2i \\sin(\\pi/4)) = \\sin(\\pi/4) = \\frac{\\sqrt{2}}{2} $$\nThe fidelity is the magnitude squared of this inner product:\n$$ F = \\left| \\frac{\\sqrt{2}}{2} \\right|^2 = \\frac{2}{4} = \\frac{1}{2} $$", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "98634"}]}