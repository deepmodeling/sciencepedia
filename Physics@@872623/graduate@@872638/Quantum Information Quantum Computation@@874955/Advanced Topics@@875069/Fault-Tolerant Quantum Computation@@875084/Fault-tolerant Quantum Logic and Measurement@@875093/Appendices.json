{"hands_on_practices": [{"introduction": "A central goal in fault-tolerant quantum computing is to perform logical operations on encoded qubits. An ideal scenario is to implement a logical gate by applying the corresponding physical gate to each constituent qubitâ€”a method known as a transversal implementation. This practice explores a crucial limitation of this approach by examining the transversal $S$-gate on the Steane code, revealing why not all logical gates in the universal set can be implemented so simply. Calculating the fidelity between the ideal and actual resulting states provides a concrete understanding of how such operations can fail and motivates the need for more advanced techniques [@problem_id:84602].", "problem": "The Steane code is a `[[7, 1, 3]]` quantum error-correcting code that encodes one logical qubit into seven physical qubits. It is a type of CSS code constructed from the classical `[7, 4, 3]` Hamming code, denoted as $C_H$. The 16 codewords of $C_H$ are partitioned into two sets: $C_e$, the set of 8 even-weight codewords, and $C_o$, the set of 8 odd-weight codewords.\n\nThe logical basis states are defined as uniform superpositions over these sets:\n$$\n|0\\rangle_L = \\frac{1}{\\sqrt{|C_e|}} \\sum_{c \\in C_e} |c\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_e} |c\\rangle\n$$\n$$\n|1\\rangle_L = \\frac{1}{\\sqrt{|C_o|}} \\sum_{c \\in C_o} |c\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_o} |c\\rangle\n$$\nwhere $|c\\rangle = |c_1 c_2 \\dots c_7\\rangle$ are computational basis states. A particularly useful logical state is $|+\\rangle_L = \\frac{1}{\\sqrt{2}}(|0\\rangle_L + |1\\rangle_L)$, which can be shown to be the uniform superposition of all 16 codewords of the Hamming code $C_H = C_e \\cup C_o$:\n$$\n|+\\rangle_L = \\frac{1}{\\sqrt{|C_H|}} \\sum_{c \\in C_H} |c\\rangle = \\frac{1}{4} \\sum_{c \\in C_H} |c\\rangle\n$$\n\nThe ideal logical S-gate, denoted $S_L$, is defined by its action on the logical basis states: $S_L|0\\rangle_L = |0\\rangle_L$ and $S_L|1\\rangle_L = i|1\\rangle_L$. In contrast, a transversal S-gate is implemented by applying the single-qubit S-gate, $$S = \\begin{pmatrix} 1 & 0 \\\\ 0 & i \\end{pmatrix},$$ to each of the seven physical qubits, i.e., $S^{\\otimes 7}$. The action of the transversal gate on a computational basis state $|c\\rangle$ is $S^{\\otimes 7}|c\\rangle = i^{w(c)} |c\\rangle$, where $w(c)$ is the Hamming weight of the bit string $c$.\n\nThe weight distribution for the classical `[7, 4, 3]` Hamming code $C_H$ is given by $\\{A_w\\}$, where $A_w$ is the number of codewords with Hamming weight $w$. The non-zero values are $A_0=1$, $A_3=7$, $A_4=7$, and $A_7=1$.\n\nYour task is to calculate the fidelity between the ideal state after an S-gate application and the actual state obtained from a transversal S-gate operation, both starting from $|+\\rangle_L$. The fidelity $F$ is defined as $F = |\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle|^2$, where $|\\psi_{\\text{ideal}}\\rangle = S_L |+\\rangle_L$ and $|\\psi_{\\text{actual}}\\rangle = S^{\\otimes 7} |+\\rangle_L$.", "solution": "The fidelity is defined as $F = |\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle|^2$, where:\n- $ |\\psi_{\\text{ideal}}\\rangle = S_L |+\\rangle_L $\n- $ |\\psi_{\\text{actual}}\\rangle = S^{\\otimes 7} |+\\rangle_L $\n\nFirst, express $ |+\\rangle_L $ using the given uniform superposition over the Hamming code $ C_H $:\n\n$$\n|+\\rangle_L = \\frac{1}{4} \\sum_{c \\in C_H} |c\\rangle\n$$\n\nsince $ |C_H| = 16 $ and the normalization factor is $ \\frac{1}{\\sqrt{16}} = \\frac{1}{4} $.\n\nThe ideal logical S-gate acts as:\n\n$$\nS_L |0\\rangle_L = |0\\rangle_L, \\quad S_L |1\\rangle_L = i |1\\rangle_L\n$$\n\nGiven $ |+\\rangle_L = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + |1\\rangle_L) $, apply $ S_L $:\n\n$$\nS_L |+\\rangle_L = \\frac{1}{\\sqrt{2}} (S_L |0\\rangle_L + S_L |1\\rangle_L) = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + i |1\\rangle_L)\n$$\n\nExpress $ |0\\rangle_L $ and $ |1\\rangle_L $ in terms of the codeword sets $ C_e $ (even-weight) and $ C_o $ (odd-weight):\n\n$$\n|0\\rangle_L = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_e} |c\\rangle, \\quad |1\\rangle_L = \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_o} |c\\rangle\n$$\n\nSubstitute:\n\n$$\n|\\psi_{\\text{ideal}}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_e} |c\\rangle + i \\frac{1}{\\sqrt{8}} \\sum_{c \\in C_o} |c\\rangle \\right) = \\frac{1}{4} \\left( \\sum_{c \\in C_e} |c\\rangle + i \\sum_{c \\in C_o} |c\\rangle \\right)\n$$\n\nsince $ \\frac{1}{\\sqrt{2}} \\cdot \\frac{1}{\\sqrt{8}} = \\frac{1}{\\sqrt{16}} = \\frac{1}{4} $.\n\nThe transversal S-gate acts on a computational basis state as $ S^{\\otimes 7} |c\\rangle = i^{w(c)} |c\\rangle $, so:\n\n$$\n|\\psi_{\\text{actual}}\\rangle = S^{\\otimes 7} |+\\rangle_L = \\frac{1}{4} \\sum_{c \\in C_H} i^{w(c)} |c\\rangle\n$$\n\n\nThe inner product is:\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\left[ \\frac{1}{4} \\left( \\sum_{c' \\in C_e} \\langle c'| - i \\sum_{c' \\in C_o} \\langle c'| \\right) \\right] \\left[ \\frac{1}{4} \\sum_{c \\in C_H} i^{w(c)} |c\\rangle \\right]\n$$\n\nsince the adjoint changes $ i $ to $ -i $. This simplifies to:\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} \\left[ \\sum_{c' \\in C_e} \\langle c'| - i \\sum_{c' \\in C_o} \\langle c'| \\right] \\left[ \\sum_{c \\in C_H} i^{w(c)} |c\\rangle \\right]\n$$\n\nDue to orthogonality, $ \\langle c' | c \\rangle = \\delta_{c',c} $, and the sets $ C_e $ and $ C_o $ are disjoint subsets of $ C_H $. Split the sum over $ c \\in C_H $ into $ c \\in C_e $ and $ c \\in C_o $:\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} \\left[ \\sum_{c \\in C_e} i^{w(c)} - i \\sum_{c \\in C_o} i^{w(c)} \\right]\n$$\n\n\nUsing the weight distribution of the Hamming code $ C_H $:\n- Weight 0: $ A_0 = 1 $ (in $ C_e $)\n- Weight 3: $ A_3 = 7 $ (in $ C_o $)\n- Weight 4: $ A_4 = 7 $ (in $ C_e $)\n- Weight 7: $ A_7 = 1 $ (in $ C_o $)\n\nCompute the sums:\n\n$$\n\\sum_{c \\in C_e} i^{w(c)} = (i^0) \\cdot A_0 + (i^4) \\cdot A_4 = (1) \\cdot 1 + (1) \\cdot 7 = 8\n$$\n\n\n$$\n\\sum_{c \\in C_o} i^{w(c)} = (i^3) \\cdot A_3 + (i^7) \\cdot A_7 = (-i) \\cdot 7 + (-i) \\cdot 1 = -8i\n$$\n\nSubstitute:\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} \\left[ 8 - i \\cdot (-8i) \\right]\n$$\n\nSimplify $-i \\cdot (-8i) = 8i^2 = 8(-1) = -8$:\n\n$$\n\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle = \\frac{1}{16} [8 + (-8)] = \\frac{0}{16} = 0\n$$\n\nThus, the fidelity is:\n\n$$\nF = |\\langle \\psi_{\\text{ideal}} | \\psi_{\\text{actual}} \\rangle|^2 = |0|^2 = 0\n$$", "answer": "$$ \\boxed{0} $$", "id": "84602"}, {"introduction": "Once an error occurs, the next step is to detect and correct it using a decoder. This exercise delves into the mechanics of the toric code and the widely used minimum-weight perfect matching (MWPM) decoder, a cornerstone of modern quantum error correction. By analyzing the system's response to a specific correlated physical error, you will trace the creation of a syndrome and see firsthand how the decoder's logic can lead to a correction that results in a logical error. This practice highlights the critical challenge posed by correlated noise and provides insight into the failure modes of standard decoding algorithms [@problem_id:84627].", "problem": "A two-dimensional toric code is constructed on an $L \\times L$ square lattice with periodic boundary conditions (i.e., a torus). Qubits reside on the edges of this lattice. The code is defined by a set of stabilizer operators. For each vertex $v$, there is a star operator $A_v = \\bigotimes_{j \\in \\text{star}(v)} X_j$, and for each plaquette $p$, there is a plaquette operator $B_p = \\bigotimes_{j \\in \\text{edge}(p)} Z_j$. Here, $\\text{star}(v)$ is the set of edges incident to vertex $v$, and $\\text{edge}(p)$ is the set of edges bounding plaquette $p$. A state in the codespace $|\\psi_L\\rangle$ satisfies $A_v |\\psi_L\\rangle = |\\psi_L\\rangle$ for all $v$ and $B_p |\\psi_L\\rangle = |\\psi_L\\rangle$ for all $p$.\n\nConsider a distance-$d$ toric code with $d=L=3$. The vertices of the lattice can be labeled by integer coordinates $(x,y)$ where $x,y \\in \\{0, 1, 2\\}$, and all arithmetic on coordinates is performed modulo $L=3$. A horizontal edge connects vertices $(x,y)$ and $(x+1,y)$, and we denote the qubit on this edge as $h_{x,y}$. A vertical edge connects $(x,y)$ and $(x,y+1)$, and we denote its qubit as $v_{x,y}$.\n\nSuppose the system is subjected to a correlated Pauli-$Z$ error event described by the operator $E = Z(h_{0,1}) Z(h_{1,1})$, where $Z(q)$ is the Pauli-$Z$ operator acting on qubit $q$. This error will violate some of the star stabilizers, creating a syndrome. An error correction procedure is then applied, which consists of two steps:\n1.  The locations of the violated star stabilizers (the syndrome) are identified.\n2.  A correction operator $C$, which is a product of Pauli-$Z$ operators forming a chain connecting the syndrome locations, is applied. This chain is chosen to have the minimum possible number of operators (i.e., shortest path). This is the principle of a minimum-weight perfect matching (MWPM) decoder for a single pair of defects. If multiple such shortest paths exist, the decoder chooses one uniformly at random.\n\nA logical error occurs if the combined operator $C \\cdot E$ is equivalent to a non-trivial logical operator of the code. For $Z$-type errors, we are concerned with the logical $Z$ operator, $Z_L$, which is a product of $Z$ operators on a chain of qubits forming a homologically non-trivial loop around the torus.\n\nGiven the specific correlated error $E = Z(h_{0,1}) Z(h_{1,1})$ on the $L=3$ toric code, what is the probability that a logical error remains after the MWPM correction procedure is applied?", "solution": "1. The error operator is \n$$\nE = Z(h_{0,1})\\,Z(h_{1,1}).\n$$\nEach $Z$ on a horizontal edge flips the eigenvalue of the two incident star operators. The star at vertex $(1,1)$ sees two $Z$ operators and returns to $+1$, while the stars at $(0,1)$ and $(2,1)$ each see one $Z$ operator and are violated. Thus the syndrome defects lie at\n$$\nv_1 = (0,1),\\quad v_2 = (2,1).\n$$\n\n2.  The MWPM decoder connects $v_1$ and $v_2$ by the shortest path of $Z$ operators. On a $3\\times3$ torus the distance\n$$\nd\\bigl((0,1),(2,1)\\bigr)=1\n$$\nvia the single horizontal edge $h_{2,1}$. This path is unique, so\n$$\nC = Z(h_{2,1}).\n$$\n\n3.  The combined operator is\n$$\nC\\,E \n= Z(h_{2,1})\\,Z(h_{0,1})\\,Z(h_{1,1})\n$$\nwhich is exactly the product of $Z$ on all three horizontal edges at $y=1$. This is a homologically non-trivial loop around the torus, i.e., the logical operator $Z_L$. Therefore every realization of this error plus correction yields a logical $Z$ operator on the state.\n\n4.  Hence the probability of a residual logical error is\n$$\n1.\n$$", "answer": "$$\\boxed{1}$$", "id": "84627"}, {"introduction": "To overcome the limitations of transversal gates for operations like the $T$-gate, fault-tolerant architectures rely on protocols such as magic state distillation. This practice provides a hands-on look into the 15-to-1 distillation protocol, a method for producing high-fidelity resource states required for non-Clifford gates. You will investigate how the protocol handles a correlated error on its input states, transforming it into a specific logical error on the output qubit. By calculating the final state's fidelity, you will gain a quantitative understanding of how distillation purifies quantum states while managing the propagation of uncorrectable errors [@problem_id:84659].", "problem": "The 15-to-1 magic state distillation protocol is a cornerstone of fault-tolerant quantum computation. It is designed to take 15 noisy copies of the magic state $|A\\rangle$ and produce a single, higher-fidelity copy of $|A\\rangle$. The magic state is given by $$|A\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle),$$ which is essential for implementing the non-Clifford $T$ gate.\n\nThe protocol leverages a $[[15,1,3]]$ quantum error-correcting code. A key functional characteristic of this protocol is its interaction with input errors:\n1.  Errors affecting only a single input qubit are perfectly corrected, meaning the output is the ideal state $|A\\rangle$.\n2.  Errors affecting two input qubits, such as a Pauli error $P_i P_j$ on qubits $i$ and $j$, are not corrected. Instead, the protocol is designed such that these errors are converted into a specific, non-trivial logical Pauli error on the single output qubit.\n\nConsider a scenario where the 15 input states are prepared such that with probability $1-\\epsilon$, the system is in the ideal state $|A\\rangle^{\\otimes 15}$, and with probability $\\epsilon$, it is in the corrupted state $X_1 X_2 |A\\rangle^{\\otimes 15}$. Here, $X_1 X_2$ represents a correlated Pauli $X$ error on the first two input qubits.\n\nAssume that for this protocol, an input error of the form $X_1X_2$ is transformed into a Pauli $Y$ error on the output qubit. Furthermore, you may assume that to leading order in $\\epsilon$, the probability of the protocol succeeding and producing an output qubit is independent of whether this specific error was present on the input.\n\nCalculate the fidelity $F = \\langle A|\\rho_{\\text{out}}|A\\rangle$ of the output state $\\rho_{\\text{out}}$ with the ideal magic state $|A\\rangle$. Express your answer to leading order in $\\epsilon$.", "solution": "The output state $\\rho_{\\text{out}}$ is a mixture of two cases, conditioned on the protocol succeeding:\n- With probability $1 - \\epsilon$, the input is ideal, and the output is $|A\\rangle$.\n- With probability $\\epsilon$, the input has the error $X_1 X_2$, which the protocol converts to a $Y$ error on the output, resulting in $Y |A\\rangle$.\n\nThus, the output density matrix is:\n$$\n\\rho_{\\text{out}} = (1 - \\epsilon) |A\\rangle\\langle A| + \\epsilon  (Y |A\\rangle\\langle A| Y^\\dagger)\n$$\nSince $Y$ is Hermitian ($Y^\\dagger = Y$), this simplifies to:\n$$\n\\rho_{\\text{out}} = (1 - \\epsilon) |A\\rangle\\langle A| + \\epsilon  (Y |A\\rangle\\langle A| Y)\n$$\n\nThe fidelity is defined as $F = \\langle A| \\rho_{\\text{out}} |A\\rangle$. Substituting $\\rho_{\\text{out}}$:\n$$\nF = \\langle A| \\left[ (1 - \\epsilon) |A\\rangle\\langle A| + \\epsilon  Y |A\\rangle\\langle A| Y \\right] |A\\rangle\n$$\nExpanding:\n$$\nF = (1 - \\epsilon) \\langle A|A\\rangle\\langle A|A\\rangle + \\epsilon  \\langle A| Y |A\\rangle \\langle A| Y |A\\rangle\n$$\nSince $|A\\rangle$ is normalized, $\\langle A|A\\rangle = 1$. Thus:\n$$\nF = (1 - \\epsilon) \\cdot 1 \\cdot 1 + \\epsilon  \\left( \\langle A| Y |A\\rangle \\right)^2\n$$\n\nNow compute $\\langle A| Y |A\\rangle$. The magic state is:\n$$\n|A\\rangle = \\frac{1}{\\sqrt{2}} \\left( |0\\rangle + e^{i\\pi/4} |1\\rangle \\right)\n$$\nApplying $Y$:\n$$\nY |A\\rangle = \\frac{1}{\\sqrt{2}} \\left( Y|0\\rangle + e^{i\\pi/4} Y|1\\rangle \\right) = \\frac{1}{\\sqrt{2}} \\left( i |1\\rangle - i e^{i\\pi/4} |0\\rangle \\right) = \\frac{i}{\\sqrt{2}} \\left( |1\\rangle - e^{i\\pi/4} |0\\rangle \\right)\n$$\nThe inner product is:\n$$\n\\langle A| Y |A\\rangle = \\left[ \\frac{1}{\\sqrt{2}} \\left( \\langle 0| + e^{-i\\pi/4} \\langle 1| \\right) \\right] \\left[ \\frac{i}{\\sqrt{2}} \\left( |1\\rangle - e^{i\\pi/4} |0\\rangle \\right) \\right]\n$$\nExpanding:\n$$\n\\langle A| Y |A\\rangle = \\frac{i}{2} \\left[ \\langle 0|1\\rangle - e^{i\\pi/4} \\langle 0|0\\rangle + e^{-i\\pi/4} \\langle 1|1\\rangle - e^{-i\\pi/4} e^{i\\pi/4} \\langle 1|0\\rangle \\right]\n$$\nUsing orthonormality ($\\langle i|j\\rangle = \\delta_{ij}$):\n$$\n\\langle A| Y |A\\rangle = \\frac{i}{2} \\left[ 0 - e^{i\\pi/4} \\cdot 1 + e^{-i\\pi/4} \\cdot 1 - 0 \\right] = \\frac{i}{2} \\left( e^{-i\\pi/4} - e^{i\\pi/4} \\right)\n$$\nThe expression $e^{-i\\pi/4} - e^{i\\pi/4} = -2i \\sin(\\pi/4)$, so:\n$$\n\\langle A| Y |A\\rangle = \\frac{i}{2} \\left( -2i \\sin(\\pi/4) \\right) = \\frac{i \\cdot (-2i)}{2} \\sin(\\pi/4) = \\frac{2}{2} \\sin(\\pi/4) = \\sin(\\pi/4)\n$$\nSince $\\sin(\\pi/4) = \\sqrt{2}/2$:\n$$\n\\langle A| Y |A\\rangle = \\frac{\\sqrt{2}}{2}\n$$\n\nSquaring this result:\n$$\n\\left( \\langle A| Y |A\\rangle \\right)^2 = \\left( \\frac{\\sqrt{2}}{2} \\right)^2 = \\frac{2}{4} = \\frac{1}{2}\n$$\n\nSubstituting back into the fidelity:\n$$\nF = (1 - \\epsilon) + \\epsilon \\cdot \\frac{1}{2} = 1 - \\epsilon + \\frac{\\epsilon}{2} = 1 - \\frac{\\epsilon}{2}\n$$\nThis expression is to leading order in $\\epsilon$, as higher-order terms in $\\epsilon$ are negligible.", "answer": "$$ \\boxed{1 - \\frac{\\epsilon}{2}} $$", "id": "84659"}]}