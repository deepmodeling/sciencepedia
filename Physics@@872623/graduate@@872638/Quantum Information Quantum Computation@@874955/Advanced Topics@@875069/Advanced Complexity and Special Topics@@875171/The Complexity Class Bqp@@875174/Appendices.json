{"hands_on_practices": [{"introduction": "The Hidden Shift Problem is a cornerstone of quantum algorithmics, providing a clear example of a problem that lies in BQP and is believed to be intractable for classical computers. This exercise provides an opportunity to analyze the standard quantum algorithm for this problem in a concrete setting [@problem_id:148973]. By calculating the probability of a successful measurement for a specific instance, you will gain hands-on experience with the core components of the algorithm, including the role of the Quantum Fourier Transform in extracting the hidden information from a quantum state.", "problem": "The hidden shift problem for an abelian group $G$ is a well-known problem in the complexity class BQP (Bounded-error Quantum Polynomial time). Given oracle access to two functions $f_0: G \\to \\{0,1\\}$ and $f_1: G \\to \\{0,1\\}$ that are promised to be related by a hidden shift $s \\in G$ such that $f_1(x) = f_0(x-s)$ for all $x \\in G$, the goal is to find $s$.\n\nA standard quantum algorithm to solve this problem is as follows:\n1. Prepare a three-register state $\\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle) \\otimes \\frac{1}{\\sqrt{|G|}}\\sum_{x \\in G} |x\\rangle \\otimes |0\\rangle$.\n2. Apply a controlled-oracle operation, which applies the oracle $U_{f_0}$ if the control qubit is $|0\\rangle$ and $U_{f_1}$ if it is $|1\\rangle$. The oracle $U_f$ acts as $U_f|x\\rangle|y\\rangle = |x\\rangle|y \\oplus f(x)\\rangle$.\n3. Apply a Hadamard gate to the control qubit.\n4. Measure the control qubit. A measurement outcome of '1' indicates success for this stage of the algorithm, and the remaining state can be used to extract information about $s$. An outcome of '0' is a failure.\n5. If the control qubit is measured as '1', apply the Quantum Fourier Transform (QFT) over $G$ to the register that holds $|x\\rangle$.\n6. Measure this register to obtain a character index $k$.\n\nIn a single run of this algorithm, a measurement of a character index $k$ that is coprime to the order of the group $|G|$ provides the maximal information for determining $s$. Let us define a \"successful measurement\" as an outcome where the control qubit is measured as '1' AND the subsequent measurement of the character index yields a value $k$ that is coprime to $|G|$.\n\nConsider the specific instance of the hidden shift problem for the cyclic group $G = \\mathbb{Z}_N$ with $N=8$. The two functions are given by their oracle implementations, with $f_0(x) = \\delta_{x,1}$ and $f_1(x) = \\delta_{x,4}$, where $\\delta_{i,j}$ is the Kronecker delta.\n\nCalculate the total probability of obtaining a \"successful measurement\" in a single run of the algorithm described above.", "solution": "The problem asks for the probability of a \"successful measurement\" for a specific instance of the hidden shift problem. This is the joint probability of two events: first, measuring the control qubit to be '1', and second, measuring a character index $k$ that is coprime to $N=8$.\n\nFirst, let's identify the hidden shift $s$. The problem states $f_1(x) = f_0(x-s)$.\nGiven $f_0(x) = \\delta_{x,1}$ and $f_1(x) = \\delta_{x,4}$, we have $\\delta_{x,4} = \\delta_{x-s,1}$.\nThis equality must hold for all $x \\in \\mathbb{Z}_8$. Let's test $x=4$: $\\delta_{4,4} = 1$ and $\\delta_{4-s,1}=1$. This implies $4-s \\equiv 1 \\pmod 8$, which gives the hidden shift $s=3$.\n\nThe initial state is $|\\Psi_0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle) \\otimes \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle \\otimes |0\\rangle$.\nAfter applying the controlled-oracle $C-U_f = |0\\rangle\\langle0|\\otimes U_{f_0} + |1\\rangle\\langle1|\\otimes U_{f_1}$, the state becomes:\n$$|\\Psi_1\\rangle = \\frac{1}{\\sqrt{2N}} \\left( |0\\rangle \\sum_{x=0}^{N-1} |x\\rangle|f_0(x)\\rangle + |1\\rangle \\sum_{x=0}^{N-1} |x\\rangle|f_1(x)\\rangle \\right)$$\nApplying the Hadamard gate to the first qubit:\n$$|\\Psi_2\\rangle = \\frac{1}{2\\sqrt{N}} \\left( (|0\\rangle+|1\\rangle) \\sum_{x} |x\\rangle|f_0(x)\\rangle + (|0\\rangle-|1\\rangle) \\sum_{x} |x\\rangle|f_1(x)\\rangle \\right)$$\n$$|\\Psi_2\\rangle = \\frac{1}{2\\sqrt{N}} \\left( |0\\rangle \\left(\\sum_{x} |x\\rangle|f_0(x)\\rangle + |x\\rangle|f_1(x)\\rangle \\right) + |1\\rangle \\left(\\sum_{x} |x\\rangle|f_0(x)\\rangle - |x\\rangle|f_1(x)\\rangle \\right) \\right)$$\n\nThe probability of measuring '1' on the control qubit, $P(\\text{ctrl=1})$, is the squared norm of the $|1\\rangle$ component. Let $|\\phi_1\\rangle = \\sum_{x} (|x\\rangle|f_0(x)\\rangle - |x\\rangle|f_1(x)\\rangle)$.\n$$P(\\text{ctrl=1}) = \\frac{1}{4N} ||\\phi_1||^2 = \\frac{1}{4N} \\left\\langle \\sum_{x'} (\\langle x'|\\langle f_0(x')| - \\langle x'|\\langle f_1(x')|) \\cdot \\sum_{x} (|x\\rangle|f_0(x)\\rangle - |x\\rangle|f_1(x)\\rangle) \\right\\rangle$$\n$$P(\\text{ctrl=1}) = \\frac{1}{4N} \\sum_x (\\langle f_0(x)|f_0(x)\\rangle - \\langle f_0(x)|f_1(x)\\rangle - \\langle f_1(x)|f_0(x)\\rangle + \\langle f_1(x)|f_1(x)\\rangle)$$\n$$P(\\text{ctrl=1}) = \\frac{1}{4N} \\sum_x (2 - 2\\delta_{f_0(x), f_1(x)}) = \\frac{1}{2N} \\sum_x (1 - \\delta_{f_0(x), f_0(x-s)})$$\nLet $C = \\{x \\in \\mathbb{Z}_N | f_0(x) = f_0(x-s)\\}$. Then $\\sum_x \\delta_{f_0(x), f_0(x-s)} = |C|$.\nThe sum evaluates to $N - |C|$. So, $P(\\text{ctrl=1}) = \\frac{N-|C|}{2N}$.\n\nFor $N=8, s=3$ and $f_0(x)=\\delta_{x,1}$, we have $f_0(x-3)=\\delta_{x-3,1}=\\delta_{x,4}$.\nWe need to find the size of the set $C = \\{x \\in \\mathbb{Z}_8 | \\delta_{x,1} = \\delta_{x,4}\\}$. This equality holds if both sides are zero, which is for all $x$ except $1$ and $4$.\nFor $x=1$, $\\delta_{1,1}=1$ and $\\delta_{1,4}=0$. Not equal.\nFor $x=4$, $\\delta_{4,1}=0$ and $\\delta_{4,4}=1$. Not equal.\nFor all other 6 values of $x$, both sides are 0. So, $|C|=6$.\n$$P(\\text{ctrl=1}) = \\frac{8-6}{2\\cdot 8} = \\frac{2}{16} = \\frac{1}{8}$$\n\nIf the control qubit is measured as '1', the state of the other two registers (normalized) is:\n$$|\\psi_{\\text{post}}\\rangle = \\frac{1}{\\sqrt{2(N-|C|)}} \\sum_x (|x\\rangle|f_0(x)\\rangle - |x\\rangle|f_0(x-s)\\rangle)$$\nUsing $y=x-s, x=y+s$ in the second term, we get:\n$$|\\psi_{\\text{post}}\\rangle = \\frac{1}{\\sqrt{2(N-|C|)}} \\sum_x (|x\\rangle - |x+s\\rangle) \\otimes |f_0(x)\\rangle$$\nApplying the QFT on the first register, where $QFT|x\\rangle = \\frac{1}{\\sqrt{N}}\\sum_k \\omega^{xk} |k\\rangle$ with $\\omega=e^{2\\pi i/N}$:\n$$|\\Psi_{\\text{final}}\\rangle = \\frac{1}{\\sqrt{2N(N-|C|)}} \\sum_k (1-\\omega^{sk}) |k\\rangle \\otimes \\left(\\sum_x \\omega^{xk} |f_0(x)\\rangle\\right)$$\nThe conditional probability of measuring character index $k$, given ctrl=1, is:\n$$P(k|\\text{ctrl=1}) = \\frac{|1-\\omega^{sk}|^2}{2N(N-|C|)} \\left\\| \\sum_x \\omega^{xk} |f_0(x)\\rangle \\right\\|^2$$\nLet's compute the norm term. $f_0(x)=\\delta_{x,1}$, so only the $x=1$ term gives $|1\\rangle$, others give $|0\\rangle$.\n$$\\sum_x \\omega^{xk} |f_0(x)\\rangle = \\omega^{1\\cdot k} |1\\rangle + \\sum_{x\\neq 1} \\omega^{xk} |0\\rangle$$\nThe norm squared is $||\\omega^k|1\\rangle||^2 + ||(\\sum_{x\\neq 1}\\omega^{xk})|0\\rangle||^2 = |\\omega^k|^2 + |\\sum_{x\\neq 1}\\omega^{xk}|^2$.\nFor $k \\in \\{1,...,7\\}$, $\\sum_{x=0}^{7} \\omega^{xk} = 0$, so $\\sum_{x\\neq 1}\\omega^{xk} = -\\omega^k$.\nThe norm squared is $1^2 + |-\\omega^k|^2 = 1+1=2$.\nPlugging values $N=8, s=3, |C|=6$:\n$$P(k|\\text{ctrl=1}) = \\frac{|1-e^{2\\pi i (3k/8)}|^2}{2(8)(8-6)} \\cdot 2 = \\frac{|1-e^{i3\\pi k/4}|^2}{16}$$\nUsing $|1-e^{i\\theta}|^2 = (1-\\cos\\theta)^2+\\sin^2\\theta = 2-2\\cos\\theta = 4\\sin^2(\\theta/2)$:\n$$P(k|\\text{ctrl=1}) = \\frac{4\\sin^2(3\\pi k/8)}{16} = \\frac{\\sin^2(3\\pi k/8)}{4}$$\nThis is valid for $k=1, \\dots, 7$. For $k=0$, $P(0|\\text{ctrl=1})=0$ since $\\sin(0)=0$.\n\nA \"successful measurement\" requires $k$ to be coprime to $N=8$. The coprime integers are $\\{1, 3, 5, 7\\}$. We need to find the probability of measuring one of these $k$'s, given ctrl=1.\n$$P(\\text{coprime } k | \\text{ctrl=1}) = \\sum_{k \\in \\{1,3,5,7\\}} P(k|\\text{ctrl=1}) = \\frac{1}{4} \\sum_{k \\in \\{1,3,5,7\\}} \\sin^2\\left(\\frac{3\\pi k}{8}\\right)$$\nLet's calculate the terms:\n$\\sin^2(3\\pi/8) = \\cos^2(\\pi/2 - 3\\pi/8) = \\cos^2(\\pi/8) = \\frac{1+\\cos(\\pi/4)}{2} = \\frac{1+1/\\sqrt{2}}{2} = \\frac{2+\\sqrt{2}}{4}$.\n$\\sin^2(9\\pi/8) = \\sin^2(\\pi+\\pi/8) = \\sin^2(\\pi/8) = \\frac{1-\\cos(\\pi/4)}{2} = \\frac{1-1/\\sqrt{2}}{2} = \\frac{2-\\sqrt{2}}{4}$.\n$\\sin^2(15\\pi/8) = \\sin^2(2\\pi - \\pi/8) = \\sin^2(-\\pi/8) = \\sin^2(\\pi/8) = \\frac{2-\\sqrt{2}}{4}$.\n$\\sin^2(21\\pi/8) = \\sin^2(3\\pi - 3\\pi/8) = \\sin(3\\pi/8)^2 = \\frac{2+\\sqrt{2}}{4}$.\n\nThe sum is:\n$$\\sum_{k \\in \\{1,3,5,7\\}} \\sin^2\\left(\\frac{3\\pi k}{8}\\right) = \\frac{2+\\sqrt{2}}{4} + \\frac{2-\\sqrt{2}}{4} + \\frac{2-\\sqrt{2}}{4} + \\frac{2+\\sqrt{2}}{4} = \\frac{8}{4} = 2$$\n$$P(\\text{coprime } k | \\text{ctrl=1}) = \\frac{1}{4}(2) = \\frac{1}{2}$$\n\nThe total probability of a successful measurement is the product of the probabilities of the two required events:\n$$P(\\text{success}) = P(\\text{coprime } k | \\text{ctrl=1}) \\times P(\\text{ctrl=1})$$\n$$P(\\text{success}) = \\frac{1}{2} \\times \\frac{1}{8} = \\frac{1}{16}$$", "answer": "$$ \\boxed{\\frac{1}{16}} $$", "id": "148973"}, {"introduction": "While understanding the power of quantum algorithms is essential, a complete picture of the BQP complexity class also requires understanding its limitations. The adversary method is a primary technique for proving lower bounds on the quantum query complexity of computational problems. This practice problem invites you to engage with a central piece of the landmark proof for the unstructured search problem's complexity [@problem_id:148989]. Calculating the spectral norm of the adversary matrix provides direct insight into how these lower bounds are formally established.", "problem": "The adversary method is a powerful technique for proving lower bounds on the query complexity of quantum algorithms. For a function $f(D) \\to R$ computed by a quantum algorithm, where $D$ is the set of possible inputs, the query complexity $Q(f)$ is the minimum number of queries to an oracle for the input required to compute $f(x)$ with high probability.\n\nA version of the adversary bound is given by $Q(f) = \\Omega\\left(\\text{adv}^{\\pm}(f)\\right)$, where $\\text{adv}^{\\pm}(f)$ is the adversary value, defined as\n$$\n\\text{adv}^{\\pm}(f) = \\max_{\\Gamma} \\frac{||\\Gamma||_{\\text{spec}}}{||\\Gamma_{\\text{adv}}||_{\\text{spec}}}\n$$\nHere, $\\Gamma$ is a complex-valued \"adversary matrix\" whose rows and columns are indexed by the inputs in $D$. A key property of $\\Gamma$ is that its entries $\\Gamma_{xy}$ must be zero if $f(x) = f(y)$. $||\\cdot||_{\\text{spec}}$ denotes the spectral norm of a matrix (its largest singular value). The matrix $\\Gamma_{\\text{adv}}$ is defined as $\\max_{i} ||\\Gamma_i||_{\\text{spec}}$, where $\\Gamma_i$ is a matrix related to $\\Gamma$ that captures the algorithm's ability to distinguish inputs by querying the $i$-th element of the input.\n\nThis problem concerns the quantum unstructured search problem, which is to find a unique \"marked\" item in a database of $N$ items. The input is a binary string $x = (x_0, x_1, \\ldots, x_{N-1})$ of length $N$ with the promise that exactly one bit is 1. Let's say $x_m=1$. The goal of the algorithm is to output the index $m$. The set of possible inputs can be denoted by $\\{x^{(0)}, x^{(1)}, \\ldots, x^{(N-1)}\\}$, where $x^{(m)}$ is the string with a 1 at position $m$ and 0s elsewhere. The function to be computed is $f(x^{(m)}) = m$. Since $f(x^{(j)}) \\neq f(x^{(k)})$ for any $j \\neq k$, any pair of distinct inputs must be distinguished.\n\nA simple yet effective choice for the adversary matrix $\\Gamma$ in this problem is one that relates all pairs of inputs that need to be distinguished. The matrix elements are defined for $j, k \\in \\{0, 1, \\ldots, N-1\\}$ as:\n$$\n\\Gamma_{jk} = \\begin{cases} 1  \\text{if } j \\neq k \\\\ 0  \\text{if } j = k \\end{cases}\n$$\nThis choice of $\\Gamma$, when used in the adversary method, leads to the tight lower bound of $\\Omega(\\sqrt{N})$ for the unstructured search problem.\n\nYour task is to calculate the spectral norm, $||\\Gamma||_{\\text{spec}}$, of this specific adversary matrix $\\Gamma$ for a search problem with $N=8$ items.", "solution": "1. Define $J_N$ as the $N\\times N$ all-ones matrix and $I_N$ as the $N\\times N$ identity. Then \n$$\n\\Gamma = J_N - I_N,\n$$ \nwith $N=8$.\n\n2. The eigenvalues of $J_N$ are $N$ (multiplicity 1) and $0$ (multiplicity $N-1$). \n\n3. Subtracting $I_N$ shifts each eigenvalue by $-1$, so $\\Gamma$ has eigenvalues\n$$\n\\lambda_1 = N-1\\quad(\\text{once}), \n\\quad \n\\lambda_{2,\\dots,N} = -1\\quad(\\text{multiplicity }N-1).\n$$\n\n4. The spectral norm is the maximum absolute eigenvalue:\n$$\n\\|\\Gamma\\|_{\\rm spec} = \\max\\{|N-1|,\\,|{-1}|\\} = N-1.\n$$\n\n5. Substituting $N=8$ gives\n$$\n\\|\\Gamma\\|_{\\rm spec} = 8-1 = 7.\n$$", "answer": "$$\\boxed{7}$$", "id": "148989"}, {"introduction": "Abstract algorithms in BQP must ultimately be compiled into instructions for a physical quantum computer, which typically operates using a finite set of fault-tolerant gates. This compilation process, known as gate synthesis, introduces approximation errors and resource costs that are critical to an algorithm's overall performance. This exercise delves into this practical aspect by focusing on the synthesis of a single-qubit rotation, a common component in algorithms like the QFT [@problem_id:148970]. You will calculate the T-count, a key metric for fault-tolerant resource estimation, required to approximate a target rotation to a desired precision.", "problem": "In quantum computation, single-qubit rotations are fundamental building blocks. Arbitrary rotations are often synthesized by approximating them with a sequence of gates from a universal fault-tolerant gate set, such as Clifford+T gates. The number of T-gates (the T-count) is a dominant factor in the overall resource cost of many quantum algorithms.\n\nThis problem concerns a standard method for synthesizing an arbitrary Z-axis rotation, $R_z(\\theta) = \\begin{pmatrix} e^{-i\\theta/2}  0 \\\\ 0  e^{i\\theta/2} \\end{pmatrix}$. The method relies on finding a high-precision approximation of the target rotation angle $\\theta$ with a so-called dyadic angle $\\phi$, which can be synthesized exactly. This task is a specific instance of Diophantine approximation.\n\nAn angle $\\phi$ is dyadic if it is of the form $\\phi = m\\pi/2^k$ for some integers $m$ and $k$. The rotation $R_z(\\phi)$ can then be synthesized using a circuit of Clifford and T-gates. For a given $\\phi = m\\pi/2^k$, we first simplify the fraction $m/2^k$ by dividing out any common factors of 2, resulting in a representation $m'\\pi/2^{k'}$ where $m'$ is odd. The T-count for synthesizing this rotation is given by the cost function:\n$$ C(k', m') = 3(k'-1) + \\text{HW}_2(m') $$\nwhere $k' \\ge 1$ and $\\text{HW}_2(m')$ is the Hamming weight of the integer $m'$ (i.e., the number of ones in its binary representation).\n\nYour task is to find the minimum T-count required to synthesize the rotation $R_z(2\\pi/5)$ with a precision of $\\epsilon = 10^{-4}$. The precision is measured by the operator norm of the difference between the target unitary $U_{target} = R_z(2\\pi/5)$ and the approximation $U_{approx} = R_z(\\phi)$, such that $\\|U_{target} - U_{approx}\\| \\le \\epsilon$.\n\nFor your calculations, you may use the small-angle approximation $\\|R_z(\\theta) - R_z(\\phi)\\| \\approx |\\theta - \\phi|/2$. Find the exact integer value for the minimum T-count.", "solution": "We seek a dyadic angle $\\phi = \\frac{m\\pi}{2^k}$ with integers $m,k$ such that $\\|R_z(2\\pi/5)-R_z(\\phi)\\| \\le \\epsilon=10^{-4}$.\nUsing the small-angle approximation $\\|R_z(\\theta)-R_z(\\phi)\\| \\approx \\frac{|\\theta-\\phi|}{2}$, the precision requirement becomes:\n$$|\\theta-\\phi| \\le 2\\epsilon \\quad\\Longrightarrow\\quad \\left|\\frac{2\\pi}{5}-\\frac{m\\pi}{2^k}\\right| \\le 2\\epsilon \\;\\Longleftrightarrow\\; \\left|\\frac{2}{5}-\\frac{m}{2^k}\\right| \\le \\frac{2\\epsilon}{\\pi}$$\nLet $\\delta = \\frac{2\\epsilon}{\\pi} = \\frac{2 \\cdot 10^{-4}}{\\pi} \\approx 6.3662 \\times 10^{-5}$.\nFor fixed $k$, the best $m$ is $m=\\text{round}(0.4\\cdot2^k)$, and the approximation error is $\\left|\\frac{m}{2^k}-0.4\\right|$. We tabulate the error for increasing $k$ until it falls below $\\delta$:\n*   $k=11$: error $\\approx 9.77 \\times 10^{-5} > \\delta$\n*   $k=12$: error $\\approx 9.77 \\times 10^{-5} > \\delta$\n*   $k=13$: error $\\approx 2.44 \\times 10^{-5} \\le \\delta$\n\nThus the minimal $k$ is $k=13$, with $m=\\text{round}(0.4 \\cdot 2^{13}) = \\text{round}(3276.8)=3277$.\nSince $3277$ is odd, the simplified form is $\\phi=\\frac{3277\\pi}{2^{13}}$, so $k'=13$ and $m'=3277$.\nThe T-count cost is:\n$$C(k',m')=3(k'-1)+\\mathrm{HW}_2(m') = 3 \\cdot 12+\\mathrm{HW}_2(3277)$$\nWriting $3277_{10} = 110011001101_2$ shows $\\mathrm{HW}_2(3277)=7$. Hence:\n$$C=36+7=43$$", "answer": "$$\\boxed{43}$$", "id": "148970"}]}