{"hands_on_practices": [{"introduction": "The Solovay-Kitaev algorithm must be able to synthesize any desired rotation. This fundamentally requires that the available infinitesimal generators, combined with new directions generated by their Lie brackets, form a complete basis for the Lie algebra $\\mathfrak{su}(2)$. This exercise explores this geometric foundation by asking you to compute the Gram determinant for such a basis, which provides a quantitative measure of its non-degeneracy and ability to span the space of all possible infinitesimal rotations [@problem_id:172619].", "problem": "The Solovay-Kitaev theorem is a cornerstone of quantum compiling, establishing that any arbitrary quantum gate can be efficiently approximated by a sequence of gates from a finite, universal set. The proof of this theorem is deeply rooted in the geometric structure of the Lie group $SU(2)$ and its corresponding Lie algebra $\\mathfrak{su}(2)$. The recursive method for finding successively better approximations relies on analyzing group commutators, which translate to Lie brackets in the algebra. The linear independence and geometric arrangement of the algebra elements are fundamental to the efficiency of the method.\n\nThe Lie algebra $\\mathfrak{su}(2)$ is the 3-dimensional real vector space of $2 \\times 2$ traceless, skew-hermitian matrices. We equip this space with the inner product $\\langle X, Y \\rangle = -2\\text{Tr}(XY)$ for any $X, Y \\in \\mathfrak{su}(2)$. This inner product is proportional to the Killing form of $\\mathfrak{su}(2)$.\n\nConsider two elements $A, B \\in \\mathfrak{su}(2)$ that represent directions of infinitesimal rotations. They are normalized with respect to the given inner product, i.e., $\\langle A, A \\rangle = 1$ and $\\langle B, B \\rangle = 1$. The generators are not orthogonal; their overlap is characterized by the angle $\\phi \\in (0, \\pi)$ such that $\\langle A, B \\rangle = \\cos\\phi$.\n\nTo generate a rotation about a new axis, one can utilize the Lie bracket $C = [A, B] = AB - BA$. For non-collinear $A$ and $B$ (i.e., $\\phi \\in (0, \\pi)$), the set $\\{A, B, C\\}$ forms a basis for $\\mathfrak{su}(2)$. A measure of the non-degeneracy or \"quality\" of this basis is its Gram determinant, $\\det(G)$, where $G$ is the Gram matrix with elements $G_{ij} = \\langle v_i, v_j \\rangle$ for the ordered basis $\\{v_1, v_2, v_3\\} = \\{A, B, C\\}$.\n\nCalculate the Gram determinant for the basis $\\{A, B, C\\}$ as a function of the angle $\\phi$.", "solution": "We denote \n$$c=\\langle A,B\\rangle=\\cos\\phi\\,,\\qquad \\|A\\|^2=\\|B\\|^2=1\\,. $$\n1.  The Gram matrix in the ordered basis $\\{A,B,C\\}$ with $C=[A,B]$ is\n$$\nG=\\begin{pmatrix}\n\\langle A,A\\rangle&\\langle A,B\\rangle&\\langle A,C\\rangle\\\\\n\\langle B,A\\rangle&\\langle B,B\\rangle&\\langle B,C\\rangle\\\\\n\\langle C,A\\rangle&\\langle C,B\\rangle&\\langle C,C\\rangle\n\\end{pmatrix}\n=\\begin{pmatrix}\n1&c&0\\\\\nc&1&0\\\\\n0&0&\\langle C,C\\rangle\n\\end{pmatrix}.\n$$\nThe off-diagonal terms involving $C$ are zero. Using the isomorphism between $(\\mathfrak{su}(2), [\\cdot,\\cdot])$ and $(\\mathbb{R}^3, \\times)$ and the fact that the inner product corresponds to the dot product, we have $A \\leftrightarrow \\vec{a}$, $B \\leftrightarrow \\vec{b}$, and $C \\leftrightarrow \\vec{a} \\times \\vec{b}$. The inner products become scalar triple products, which are zero:\n$$ \\langle A,C\\rangle \\propto \\vec{a} \\cdot (\\vec{a} \\times \\vec{b}) = 0, \\quad \\langle B,C\\rangle \\propto \\vec{b} \\cdot (\\vec{a} \\times \\vec{b}) = 0. $$\n2.  To compute $\\langle C,C\\rangle=\\langle[A,B],[A,B]\\rangle$, we continue with the isomorphism $\\mathfrak{su}(2)\\simeq\\mathbb{R}^3$. With $A\\leftrightarrow\\vec a$, $B\\leftrightarrow\\vec b$ where $|\\vec a|=|\\vec b|=1$ and $\\vec a\\cdot\\vec b=c=\\cos\\phi$, we have:\n$$[A,B]\\leftrightarrow\\vec a\\times\\vec b,\\qquad\n\\langle C,C\\rangle \\propto |\\vec a\\times\\vec b|^2\n=|\\vec a|^2|\\vec b|^2 - (\\vec a \\cdot \\vec b)^2 = 1-c^2=\\sin^2\\phi.\n$$\nSince the inner product is proportional to the dot product, and the vectors corresponding to $A,B$ are unit vectors, the proportionality constant is 1. Thus, $\\langle C, C \\rangle = \\sin^2\\phi$.\n3.  Hence the determinant is\n$$\\det G=(1-c^2)\\,\\langle C,C\\rangle\n=(1-\\cos^2\\phi)\\,\\sin^2\\phi\n=\\sin^4\\phi.\n$$", "answer": "$$\\boxed{\\sin^4\\phi}$$", "id": "172619"}, {"introduction": "Once we establish that commutators provide access to the full space of rotations, the next challenge is to control the *size* of these rotations. The recursive nature of the Solovay-Kitaev algorithm relies on generating successively smaller rotations with high precision. This practice delves into the algebraic mechanics of this process, demonstrating how carefully constructed sequences of group commutators can be used with the Baker-Campbell-Hausdorff formula to cancel dominant, low-order terms and isolate specific higher-order effects [@problem_id:172577].", "problem": "In the context of the Solovay-Kitaev theorem, sequences of quantum gates are used to approximate a desired unitary operation. A key technique is the construction of increasingly complex unitary operations by forming sequences of group commutators, which in turn approximate Lie commutators of the gate Hamiltonians.\n\nLet $V = e^{-iH_V \\delta}$ and $W = e^{-iH_W \\delta}$ be two quantum gates, where $H_V$ and $H_W$ are Hamiltonians and $\\delta$ is a small, dimensionless parameter. A simple group commutator is $S_c(n, m) = V^n W^m V^{-n} W^{-m}$, where $n$ and $m$ are integers. To leading order in $\\delta$, this sequence approximates $\\exp(-nm[H_V, H_W]\\delta^2)$.\n\nTo generate higher-order nested commutators, one can form products of such commutator sequences. Consider the composite sequence $S = S_c(n_1, m_1) S_c(n_2, m_2)$. By choosing the integer exponents $\\{n_1, m_1, n_2, m_2\\}$ appropriately, it is possible to cancel the leading-order term proportional to $[H_V, H_W]\\delta^2$ and isolate terms of order $\\delta^3$.\n\nYour task is to find the smallest positive integers $n_1, m_1, n_2$ and the smallest magnitude non-zero integer $m_2$ that satisfy the following two conditions:\n1. The coefficient of the $[H_V, H_W]\\delta^2$ term in the Baker-Campbell-Hausdorff (BCH) expansion for $\\log(S)$ is zero.\n2. The coefficient of the $[H_V, [H_V, H_W]]\\delta^3$ term in the BCH expansion for $\\log(S)$ is zero, thereby isolating the $[[H_V, H_W], H_W]$ term at order $\\delta^3$.\n\nUsing these values, calculate the product $P = n_1 m_1 n_2 m_2$.\n\nYou will need the following result from the BCH formula for the exponent $Z$ of a group commutator $e^X e^Y e^{-X} e^{-Y}$:\n$$\ne^X e^Y e^{-X} e^{-Y} = e^Z, \\quad \\text{with} \\quad Z = [X,Y] + \\frac{1}{2}[X,[X,Y]] - \\frac{1}{2}[Y,[X,Y]] + \\mathcal{O}(\\delta^4)\n$$\nwhere for $S_c(n,m)$, $X=-inH_V\\delta$ and $Y=-imH_W\\delta$.", "solution": "We denote \n$$X_i=-i n_i H_V\\delta,\\quad Y_i=-i m_i H_W\\delta\\,,\\quad i=1,2$$\nand use the commutator expansion for each\n$$S_c(n_i,m_i)=e^{X_i}e^{Y_i}e^{-X_i}e^{-Y_i}=e^{Z_i},$$\nwith\n$$Z_i=[X_i,Y_i]+\\tfrac12[X_i,[X_i,Y_i]]-\\tfrac12[Y_i,[X_i,Y_i]]+\\mathcal{O}(\\delta^4).$$\n\n1. Compute the leading $\\delta^2$ term. Let $C=[H_V,H_W]$. Then\n$$[X_i,Y_i]=(-i n_i\\delta)(-i m_i\\delta)\\,[H_V,H_W]\n=-n_i m_i\\,\\delta^2\\,C.$$\nHence\n$$Z_i=-n_i m_i\\,\\delta^2C+\\mathcal{O}(\\delta^3).$$\nFor the composite $S=S_c(n_1,m_1)S_c(n_2,m_2)$, the BCH sum to $\\mathcal{O}(\\delta^3)$ gives\n$$\\log S=Z_1+Z_2+\\mathcal{O}(\\delta^3)=-\\bigl(n_1m_1+n_2m_2\\bigr)\\delta^2\\,C+\\mathcal{O}(\\delta^3).$$\nCondition 1 (vanishing of the $\\delta^2$ term) yields\n$$n_1m_1+n_2m_2=0.\\tag{1}$$\n\n2. Compute the $\\delta^3$ terms in each $Z_i$. We have\n$$[X_i,[X_i,Y_i]]\n=-n_i^2m_i\\,i\\delta^3\\,[H_V,C],\\qquad\n[Y_i,[X_i,Y_i]]\n=-n_im_i^2\\,i\\delta^3\\,[H_W,C],$$\nso that\n$$Z_i=-n_im_i\\,\\delta^2C\n+\\tfrac{i\\delta^3}{2}\\bigl(n_i^2m_i\\,[H_V,C]\\,-\\,n_im_i^2\\,[H_W,C]\\bigr)\n+\\mathcal{O}(\\delta^4).$$\nSumming and ignoring $\\mathcal{O}(\\delta^4)$ and commutators of $Z_1,Z_2$ gives\n$$\\log S=\n-\\bigl(n_1m_1+n_2m_2\\bigr)\\delta^2C\n+\\frac{i\\delta^3}{2}\\Bigl((n_1^2m_1+n_2^2m_2)[H_V,C]\n-(n_1m_1^2+n_2m_2^2)[H_W,C]\\Bigr).$$\nCondition 1 makes the $\\delta^2$ term zero.  \nCondition 2 (vanishing of the $[H_V,C]\\delta^3$ term) yields\n$$n_1^2m_1+n_2^2m_2=0.\\tag{2}$$\n\n3. Solve (1),(2) in integers with $n_1,n_2,m_1>0$, $m_2\\neq0$ minimal in magnitude.\nFrom (1) $n_2m_2=-n_1m_1$, and substituting into (2) gives $n_1^2m_1 + n_2(-n_1m_1) = n_1m_1(n_1-n_2) = 0$. Since $n_1,m_1>0$, this implies $n_2=n_1$. Substituting this back into (1) gives $n_1m_1+n_1m_2=0$, which implies $m_2=-m_1$.\nChoosing the smallest positive integers $n_1=1, m_1=1$ gives $n_2=1$, $m_2=-1$.\nThus \n$$P=n_1m_1n_2m_2=1\\cdot1\\cdot1\\cdot(-1)=-1.$$", "answer": "$$\\boxed{-1}$$", "id": "172577"}, {"introduction": "The remarkable efficiency of the Solovay-Kitaev algorithm stems from its recursive structure, where the approximation error shrinks superlinearly, as in $\\epsilon_{k+1} \\propto \\epsilon_k^p$ with $p > 1$. This scaling exponent $p$ is not arbitrary; it is a direct consequence of the algebraic structure of the commutator sequence used to generate the approximation. This exercise provides a chance to explore this deep connection by analyzing an alternative recursive construction and deriving its characteristic scaling exponent from first principles [@problem_id:172594].", "problem": "The Solovay-Kitaev theorem provides a constructive method for efficiently approximating any desired unitary operation $U$ using a sequence of gates from a finite, universal gate set $\\mathcal{G}$. The algorithm is recursive. If one has an approximation $U_k$ to $U$ with error $\\epsilon_k = \\|U - U_k\\|$, a better approximation $U_{k+1}$ can be constructed such that the error scales as $\\epsilon_{k+1} \\approx C \\epsilon_k^p$ for some constant $C$ and an exponent $p>1$.\n\nThis recursion is achieved by finding a short gate sequence $S_k \\in \\mathcal{G}$ that approximates the remaining error unitary, $R_k = U U_k^{-1}$. The new approximation is then $U_{k+1} = S_k U_k$. A standard method involves approximating $R_k$ with a group commutator, $S_k = [V, W] = VWV^{-1}W^{-1}$, where $V$ and $W$ are themselves shorter gate sequences.\n\nLet $V = e^{-iA\\tau}$ and $W = e^{-iB\\tau}$ be two unitary operations, where $A$ and $B$ are Hermitian operators (generators in the Lie algebra $\\mathfrak{su}(d)$) and $\\tau$ is a small real parameter. The generator of the commutator $[V, W]$ can be found using the Baker-Campbell-Hausdorff (BCH) formula.\n\nConsider an alternative recursive step based on the asymmetric commutator-like product $S = V^2 W V^{-2} W^{-1}$.\n1.  The leading-order generator of $S$ can be expressed as $g = \\mathcal{C} \\cdot \\tau^2 [B,A]$, where $\\mathcal{C}$ is a purely numerical constant.\n2.  The recursive construction based on this product $S$ results in an error scaling relationship $\\epsilon_{k+1} \\propto \\epsilon_k^p$, where $p$ is the scaling exponent.\n\nYour task is to determine the ratio $\\mathcal{R} = p / \\mathcal{C}$ for this alternative construction.", "solution": "The problem asks for the ratio of the error scaling exponent $p$ to the prefactor $\\mathcal{C}$ of the leading-order generator for the unitary product $S = V^2 W V^{-2} W^{-1}$.\n\n**Step 1: Find the leading-order generator and the constant $\\mathcal{C}$**\n\nThe given unitary operation is $S = V^2 W V^{-2} W^{-1}$. This can be identified as the group commutator of $V^2$ and $W$:\n$$\nS = [V^2, W]\n$$\nLet $V = e^X$ and $W = e^Y$, where $X = -iA\\tau$ and $Y = -iB\\tau$. Then $V^2 = e^{2X}$.\n$$\nS = [e^{2X}, e^Y]\n$$\nTo find the generator of $S$, we compute its logarithm using the Baker-Campbell-Hausdorff (BCH) formula. The leading term of $\\log([e^{A'}, e^{B'}])$ is simply $[A',B']$.\nIn our case, we set $A' = 2X$ and $B' = Y$. The leading-order term is:\n$$\n\\log(S) \\approx [2X, Y] = 2[X,Y]\n$$\nSubstituting $X = -iA\\tau$ and $Y = -iB\\tau$:\n$$\n2[-iA\\tau, -iB\\tau] = 2(-i\\tau)^2[A,B] = -2\\tau^2[A,B] = 2\\tau^2[B,A]\n$$\nThe problem statement defines the leading-order generator as $g = \\mathcal{C} \\cdot \\tau^2 [B,A]$. By comparing our result with this definition, we identify the constant $\\mathcal{C}$:\n$$\n2\\tau^2[B,A] = \\mathcal{C} \\tau^2 [B,A] \\implies \\mathcal{C} = 2\n$$\n\n**Step 2: Determine the error scaling exponent $p$**\n\nThe recursive step of the Solovay-Kitaev algorithm aims to approximate the error unitary $R_k = U U_k^{-1}$, which is close to the identity. We can write $R_k \\approx e^{-iH_k\\epsilon_k}$ for some Hermitian operator $H_k$, where $\\epsilon_k$ is the error magnitude at step $k$.\n\nWe use the sequence $S_k = V_k^2 W_k V_k^{-2} W_k^{-1}$ to approximate $R_k$. Let $V_k=e^{-iA\\tau_k}$ and $W_k=e^{-iB\\tau_k}$. The approximation is made by matching the leading-order generators:\n$$\n\\log(R_k) \\approx \\log(S_k)\n$$\n$$\n-iH_k\\epsilon_k \\approx 2\\tau_k^2[B,A]\n$$\nTo satisfy this relation (assuming we can find generators $A,B$ in our gate set's Lie algebra such that $[B,A]$ is proportional to $H_k$), we must choose the parameter $\\tau_k$ such that $\\tau_k^2$ is proportional to $\\epsilon_k$.\n$$\n\\tau_k^2 \\propto \\epsilon_k \\implies \\tau_k \\propto \\sqrt{\\epsilon_k}\n$$\nThe error of this approximation determines the error of the next step, $\\epsilon_{k+1}$. This error is given by the difference between $R_k$ and $S_k$. For small errors, this is well-approximated by the difference of their logarithms:\n$$\n\\epsilon_{k+1} \\approx \\| R_k - S_k \\| \\approx \\| \\log(R_k) - \\log(S_k) \\|\n$$\nThe difference in the logarithms is dominated by the next-to-leading order term in the BCH expansion of $\\log(S_k)$. The BCH expansion for a commutator shows that the next terms after the leading $[A', B']$ term are of the form $[A', [A', B']]$ and $[B', [A', B']]$. Since $A'$ and $B'$ are of order $\\tau_k$, the leading term is order $\\tau_k^2$ and the next-to-leading order terms are of order $\\tau_k^3$.\nThe error in the approximation is therefore:\n$$\n\\epsilon_{k+1} \\approx \\|R_k - S_k\\| \\propto \\tau_k^3\n$$\nSince $\\tau_k \\propto \\sqrt{\\epsilon_k}$, we have:\n$$\n\\epsilon_{k+1} \\propto (\\sqrt{\\epsilon_k})^3 = \\epsilon_k^{3/2}\n$$\nComparing this to the general form $\\epsilon_{k+1} \\propto \\epsilon_k^p$, we find the error scaling exponent:\n$$\np = \\frac{3}{2}\n$$\n\n**Step 3: Calculate the ratio $\\mathcal{R}$**\n\nWe are asked to find the ratio $\\mathcal{R} = p / \\mathcal{C}$. Using the values we found:\n$$\np = \\frac{3}{2} \\quad \\text{and} \\quad \\mathcal{C} = 2\n$$\n$$\n\\mathcal{R} = \\frac{p}{\\mathcal{C}} = \\frac{3/2}{2} = \\frac{3}{4}\n$$", "answer": "$$ \\boxed{\\frac{3}{4}} $$", "id": "172594"}]}