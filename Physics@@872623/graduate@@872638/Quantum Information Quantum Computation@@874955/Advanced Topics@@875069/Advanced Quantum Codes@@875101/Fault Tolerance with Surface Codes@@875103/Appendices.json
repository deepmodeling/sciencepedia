{"hands_on_practices": [{"introduction": "Understanding how a decoder can fail is as important as understanding how it succeeds. This first exercise explores a fundamental failure mode of the widely used minimum-weight perfect matching (MWPM) decoder. By analyzing a scenario where the decoder misinterprets a syndrome, you will derive a crucial relationship between the code distance and the minimum weight of a physical error that can cause a logical error [@problem_id:82660].", "problem": "Consider a rotated planar surface code of distance $d$, where $d$ is an odd integer. The code's data qubits reside on the edges of a grid. The stabilizers are of two types: X-type star operators associated with vertices of one sublattice (say, white vertices on a checkerboard), and Z-type plaquette operators associated with the faces of the grid.\n\nA Pauli-Z error chain $E$ occurs on the data qubits. The resulting error syndrome is measured, and it is found that exactly two X-stabilizers, $S_A$ and $S_B$, are violated (i.e., their measurement outcome is -1). The vertices corresponding to $S_A$ and $S_B$ are adjacent in the grid, connected by a single edge which corresponds to data qubit $q_{AB}$.\n\nA standard minimum-weight perfect matching (MWPM) decoder is used to infer the error from the syndrome. To correct an error syndrome consisting of two defects, the decoder's default assumption is that the error occurred along the shortest path between the defects. In this case, it infers an error chain $E_{inf}$ consisting of a single Pauli-Z error on the qubit $q_{AB}$.\n\nHowever, this inference is incorrect. The actual error chain, $E_{actual}$, is different from $E_{inf}$, but creates the same syndrome. The combination of the actual error and the decoder's inferred correction, $E_{actual} \\cdot E_{inf}$, constitutes a non-trivial logical Z operator, $Z_L$, leading to a logical error.\n\nAssuming such a logical error has occurred, determine the minimum possible weight of the error chain $E_{actual}$. The weight of an error chain is the number of single-qubit Pauli operators it contains. Express your answer in terms of the code distance $d$.", "solution": "1.  Let $E_{\\inf}$ be the inferred error chain, which corresponds to a single Pauli-Z error on qubit $q_{AB}$. Its weight is $\\mathrm{wt}(E_{\\inf}) = 1$. Let $C = E_{\\actual} \\cdot E_{\\inf}$ be the closed cycle formed by the combination of the actual error and the inferred error. Since this causes a logical error, $C$ must be a non-trivial logical operator. By definition of the code distance, the minimum weight of such an operator is $d$, so we consider the case where $\\mathrm{wt}(C) = d$.\n\n2.  The actual error can be expressed as $E_{\\actual} = C \\cdot E_{\\inf}$. The weight of the symmetric difference of two sets of operators (qubits) is given by $\\mathrm{wt}(A \\cdot B) = \\mathrm{wt}(A) + \\mathrm{wt}(B) - 2|A \\cap B|$, where $|A \\cap B|$ is the number of qubits they have in common. Therefore, the weight of the actual error is $\\mathrm{wt}(E_{\\actual}) = \\mathrm{wt}(C) + \\mathrm{wt}(E_{\\inf}) - 2|C \\cap E_{\\inf}|$.\n\n3.  To find the minimum possible weight of $E_{\\actual}$, we must maximize the overlap $|C \\cap E_{\\inf}|$. Since $E_{\\inf}$ consists of only a single qubit, the maximum possible overlap is $|C \\cap E_{\\inf}| = 1$. Substituting the known values, we get the minimum weight for $E_{\\actual}$: $\\mathrm{wt}(E_{\\actual}) = d + 1 - 2(1) = d - 1$.\n\nHence, the minimum possible weight of the actual error chain $E_{\\actual}$ that could cause this logical error is $d-1$.", "answer": "$$\\boxed{d-1}$$", "id": "82660"}, {"introduction": "While Pauli errors provide a convenient basis for analysis, real quantum systems are subject to more complex noise processes. This practice problem moves beyond the Pauli model to consider the effect of amplitude damping, a common form of energy relaxation, on a logical qubit [@problem_id:82743]. You will calculate the resulting fidelity of a logical state, providing insight into how the protective properties of the surface code manifest against realistic noise.", "problem": "A distance-$d$ toric code is a quantum error-correcting code defined on a $d \\times d$ square lattice with periodic boundary conditions (a torus). The physical qubits, known as data qubits, reside on the edges of the lattice. The code is a stabilizer code, defined by two types of stabilizer generators: star operators $A_s = \\prod_{i \\in \\text{star}(s)} X_i$ for each vertex (star) $s$, and plaquette operators $B_p = \\prod_{i \\in \\partial p} Z_i$ for each face (plaquette) $p$. Here, $X_i$ and $Z_i$ are the Pauli operators for the qubit on edge $i$. A state $|\\psi\\rangle$ is in the codespace if $A_s|\\psi\\rangle = |\\psi\\rangle$ and $B_p|\\psi\\rangle = |\\psi\\rangle$ for all $s, p$.\n\nThe logical zero state, $|0_L\\rangle$, is a state within this codespace that is also a $+1$ eigenstate of the logical $Z_L$ operator. A key property of $|0_L\\rangle$ (and any other state in the codespace) is that for any single data qubit $k$, the expectation value $\\langle 0_L | P_k | 0_L \\rangle = 0$ for any Pauli operator $P_k \\in \\{X_k, Y_k, Z_k\\}$.\n\nSuppose the system is initialized in the logical zero state $|0_L\\rangle$. A single data qubit, labeled $k$, undergoes an amplitude damping quantum channel $\\mathcal{E}$. This channel describes energy relaxation and is defined by the Kraus operators:\n$$\nE_0 = \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{1-\\gamma} \\end{pmatrix}, \\quad E_1 = \\begin{pmatrix} 0  \\sqrt{\\gamma} \\\\ 0  0 \\end{pmatrix}\n$$\nwhere $\\gamma$ is the probability of decay from the excited state $|1\\rangle$ to the ground state $|0\\rangle$.\n\nThe initial state of the system is $\\rho_0 = |0_L\\rangle\\langle 0_L|$. After the noise acts on qubit $k$, the final state is $\\rho_f = \\mathcal{E}_k(\\rho_0)$. Calculate the fidelity of the final state with respect to the initial logical state, given by $F = \\langle 0_L | \\rho_f | 0_L \\rangle$. Your final answer should be an expression in terms of $\\gamma$.", "solution": "The goal is to compute the fidelity $F = \\langle 0_L | \\rho_f | 0_L \\rangle$, where $\\rho_f$ is the state of the system after a single data qubit $k$ undergoes amplitude damping.\n\n1.  **Express the final state $\\rho_f$:**\n    The initial state is $\\rho_0 = |0_L\\rangle\\langle 0_L|$. The amplitude damping channel $\\mathcal{E}_k$ acts only on qubit $k$. The final state is given by the operator-sum representation:\n    $$\n    \\rho_f = \\mathcal{E}_k(\\rho_0) = E_{0,k} \\rho_0 E_{0,k}^\\dagger + E_{1,k} \\rho_0 E_{1,k}^\\dagger\n    $$\n    where $E_{0,k} = I \\otimes \\dots \\otimes E_0 \\otimes \\dots \\otimes I$ and $E_{1,k}$ is defined similarly, with the non-identity part acting on qubit $k$.\n\n2.  **Express the fidelity $F$ in terms of Kraus operators:**\n    Substituting the expression for $\\rho_f$ into the fidelity formula:\n    $$\n    F = \\langle 0_L | (E_{0,k} \\rho_0 E_{0,k}^\\dagger + E_{1,k} \\rho_0 E_{1,k}^\\dagger) | 0_L \\rangle\n    $$\n    Substituting $\\rho_0 = |0_L\\rangle\\langle 0_L|$:\n    $$\n    F = \\langle 0_L | E_{0,k} |0_L\\rangle\\langle 0_L| E_{0,k}^\\dagger | 0_L \\rangle + \\langle 0_L | E_{1,k} |0_L\\rangle\\langle 0_L| E_{1,k}^\\dagger | 0_L \\rangle\n    $$\n    Since the Kraus operators for amplitude damping are real matrices in the computational basis, they are Hermitian up to their action on the state space. More simply, we can write this as:\n    $$\n    F = |\\langle 0_L | E_{0,k} | 0_L \\rangle|^2 + |\\langle 0_L | E_{1,k} | 0_L \\rangle|^2\n    $$\n\n3.  **Express Kraus operators in the Pauli basis:**\n    To evaluate the expectation values, it's convenient to write the Kraus operators in terms of Pauli matrices. Using $|0\\rangle\\langle0| = \\frac{I+Z}{2}$ and $|1\\rangle\\langle1| = \\frac{I-Z}{2}$:\n    $$\n    E_0 = |0\\rangle\\langle0| + \\sqrt{1-\\gamma}|1\\rangle\\langle1| = \\frac{I+Z}{2} + \\sqrt{1-\\gamma}\\frac{I-Z}{2} = \\frac{1+\\sqrt{1-\\gamma}}{2} I + \\frac{1-\\sqrt{1-\\gamma}}{2} Z\n    $$\n    Using $|0\\rangle\\langle1| = \\frac{X+iY}{2}$:\n    $$\n    E_1 = \\sqrt{\\gamma}|0\\rangle\\langle1| = \\frac{\\sqrt{\\gamma}}{2}(X+iY)\n    $$\n\n4.  **Evaluate the expectation values:**\n    We now compute the matrix elements of these operators with respect to the logical state $|0_L\\rangle$. The operators act non-trivially only on qubit $k$.\n    For the first term:\n    $$\n    \\langle 0_L | E_{0,k} | 0_L \\rangle = \\left\\langle 0_L \\left| \\frac{1+\\sqrt{1-\\gamma}}{2} I_k + \\frac{1-\\sqrt{1-\\gamma}}{2} Z_k \\right| 0_L \\right\\rangle\n    $$\n    $$\n    = \\frac{1+\\sqrt{1-\\gamma}}{2} \\langle 0_L | I_k | 0_L \\rangle + \\frac{1-\\sqrt{1-\\gamma}}{2} \\langle 0_L | Z_k | 0_L \\rangle\n    $$\n    From the problem statement, we know that for any single-qubit Pauli operator $P_k$, its expectation value in a logical state is zero. Thus, $\\langle 0_L | Z_k | 0_L \\rangle = 0$. Also, $\\langle 0_L | I_k | 0_L \\rangle = \\langle 0_L | 0_L \\rangle = 1$.\n    $$\n    \\langle 0_L | E_{0,k} | 0_L \\rangle = \\frac{1+\\sqrt{1-\\gamma}}{2} (1) + \\frac{1-\\sqrt{1-\\gamma}}{2} (0) = \\frac{1+\\sqrt{1-\\gamma}}{2}\n    $$\n    For the second term:\n    $$\n    \\langle 0_L | E_{1,k} | 0_L \\rangle = \\left\\langle 0_L \\left| \\frac{\\sqrt{\\gamma}}{2}(X_k+iY_k) \\right| 0_L \\right\\rangle = \\frac{\\sqrt{\\gamma}}{2} \\left( \\langle 0_L | X_k | 0_L \\rangle + i \\langle 0_L | Y_k | 0_L \\rangle \\right)\n    $$\n    Using the same property, $\\langle 0_L | X_k | 0_L \\rangle = 0$ and $\\langle 0_L | Y_k | 0_L \\rangle = 0$.\n    $$\n    \\langle 0_L | E_{1,k} | 0_L \\rangle = \\frac{\\sqrt{\\gamma}}{2} (0 + i \\cdot 0) = 0\n    $$\n\n5.  **Calculate the final fidelity:**\n    Substitute these expectation values back into the expression for $F$:\n    $$\n    F = \\left| \\frac{1+\\sqrt{1-\\gamma}}{2} \\right|^2 + |0|^2\n    $$\n    $$\n    F = \\frac{(1+\\sqrt{1-\\gamma})^2}{4}\n    $$\n    Expanding this expression gives:\n    $$\n    F = \\frac{1^2 + 2\\sqrt{1-\\gamma} + (\\sqrt{1-\\gamma})^2}{4} = \\frac{1 + 2\\sqrt{1-\\gamma} + 1-\\gamma}{4} = \\frac{2 - \\gamma + 2\\sqrt{1-\\gamma}}{4}\n    $$", "answer": "$$\n\\boxed{\\frac{(1+\\sqrt{1-\\gamma})^2}{4}}\n$$", "id": "82743"}, {"introduction": "Fault tolerance must account for errors in the correction process itself, not just errors on the data qubits. This final exercise introduces the essential concept of spacetime decoding, which treats measurement errors on an equal footing with physical qubit errors [@problem_id:82687]. By analyzing the syndrome pattern produced by a persistently faulty detector, you will see how the MWPM decoder interprets temporal defects and determines the most likely underlying fault.", "problem": "Consider a standard toric surface code defined on a large 2D square lattice. The data qubits reside on the edges of the lattice. The stabilizer group is generated by two types of operators: $X$-stabilizers (star operators) centered on vertices and $Z$-stabilizers (plaquette operators) centered on the faces of the lattice.\n\nTo detect errors, all stabilizers are measured periodically in discrete time steps $t=1, 2, 3, \\dots$. We focus on the detection of $X$-type errors using the $Z$-stabilizers. A syndrome is extracted at each time step, where a value of $-1$ for a given $Z$-stabilizer indicates that an odd number of $X$ errors has occurred on its support. A defect is registered at a spacetime location $(p, t)$ if the measurement outcome of the plaquette stabilizer $S_p$ at time $t$ differs from its outcome at time $t-1$.\n\nDecoding is performed using a minimum-weight perfect matching (MWPM) algorithm on a 3D spacetime graph of these defects. The vertices of this graph are the spacetime locations of the defects. Edges in the graph represent the most likely fundamental error events that could connect a pair of defects. We consider a simplified noise model where any single-qubit $X$ error or any single-plaquette measurement error are equally probable. Consequently, the weight of any edge in the decoding graph that corresponds to a single fundamental error event is taken to be unity.\n\nSuppose a single $Z$-plaquette detector, for a plaquette labeled $p_0$, is faulty. This detector becomes \"stuck\" and reports the incorrect value of $-1$ for $K$ consecutive measurement cycles, from $t=1$ to $t=K$. Before this period (at $t=0$) and after (from $t=K+1$ onwards), the detector functions correctly. Assume that the system is initialized in a state with all stabilizer outcomes being $+1$, and no actual qubit errors occur throughout this entire process.\n\nThe MWPM decoder will interpret the pattern of defects caused by this faulty detector and identify a corresponding error chain (a path in the decoding graph) to correct it. What is the total weight of this error chain?", "solution": "The reported outcomes for the faulty detector at plaquette $p_0$ are:\n- $m(p_0, 0) = +1$\n- $m(p_0, t) = -1$ for $t = 1, 2, \\dots, K$\n- $m(p_0, t) = +1$ for $t \\geq K+1$\n\nA defect at $(p, t)$ is defined by:\n\n$$\n\\delta(p, t) = \n\\begin{cases} \n1  \\text{if } m(p, t) \\neq m(p, t-1) \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n\n\nFor $p_0$:\n- $\\delta(p_0, 1) = 1$ since $m(p_0, 1) = -1 \\neq m(p_0, 0) = +1$\n- $\\delta(p_0, t) = 0$ for $t = 2, 3, \\dots, K$ since $m(p_0, t) = -1 = m(p_0, t-1)$\n- $\\delta(p_0, K+1) = 1$ since $m(p_0, K+1) = +1 \\neq m(p_0, K) = -1$\n\nFor $p \\neq p_0$, $m(p, t) = +1$ for all $t$, so $\\delta(p, t) = 0$ for all $t$. Thus, the only defects are at $(p_0, 1)$ and $(p_0, K+1)$.\n\nThe MWPM decoder pairs these defects with a minimal-weight error chain. Each fundamental error event (single-qubit $X$ error or single-plaquette measurement error) has weight 1. The minimal chain explaining the defects uses $K$ measurement errors at $p_0$ for times $t = 1, 2, \\dots, K$:\n- A measurement error at $(p_0, t)$ causes defects at $(p_0, t)$ and $(p_0, t+1)$.\n- The chain of $K$ measurement errors:\n  - Error at $t=1$: defects at $(p_0, 1)$, $(p_0, 2)$\n  - Error at $t=2$: defects at $(p_0, 2)$, $(p_0, 3)$\n  - $\\vdots$\n  - Error at $t=K$: defects at $(p_0, K)$, $(p_0, K+1)$\n- Defects at $t = 2, 3, \\dots, K$ appear twice and cancel modulo 2, leaving only defects at $(p_0, 1)$ and $(p_0, K+1)$.\n\nThe total weight is the sum of the weights of the $K$ measurement errors, each of weight 1, so the total weight is $K$.\n\nOther chains, such as those with qubit errors, require at least $K+1$ errors to avoid extra defects, so they are not minimal.", "answer": "$$ \\boxed{K} $$", "id": "82687"}]}