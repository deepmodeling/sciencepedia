{
    "hands_on_practices": [
        {
            "introduction": "要真正理解态密度（DOS），最佳的起点是追溯其数学根源。这个练习将引导你完成一个经典的推导，针对最简单的情形——自由电子气模型。通过将倒易空间（k空间）中允许的量子态与能量相关的态密度联系起来，你将为更复杂的系统建立起坚实的基础直觉 ()。",
            "id": "3877242",
            "problem": "在计算催化中，金属载体通常被近似为自由电子库，以合理解释控制吸附和反应能学的电子描述符。考虑一个体积为 $V$ 的大型立方体金属催化剂板，其被建模为具有周期性边界条件的三维（3D）无相互作用的自由电子气。单粒子色散关系为 $E=\\frac{\\hbar^{2}k^{2}}{2m}$，其中 $m$ 是电子质量，$k=|\\mathbf{k}|$ 是晶体波矢的模，$\\hbar$ 是约化普朗克常数。假设自旋简并度为 $g_{s}=2$，并且允许的 $\\mathbf{k}$ 点根据标准的周期性盒子量子化在倒易空间中均匀分布。在诸如密度泛函理论（DFT）等第一性原理分析中，总态密度（DOS）和投影到原子或轨道子空间的投影态密度（PDOS）通常是通过在 $\\mathbf{k}$ 空间中计数态并对能量求导来构建的。\n\n仅从以下基础出发：\n- 色散关系 $E=\\frac{\\hbar^{2}k^{2}}{2m}$，\n- 在体积为 $V$ 的周期性盒子中，$\\mathbf{k}$ 空间态的均匀计数，\n- 自旋简并度 $g_{s}=2$，\n\n推导该三维自由电子气单位能量的总态密度 $D(E)$ 的闭合形式表达式，使其成为 $E$、$V$、$m$ 和 $\\hbar$ 的函数。将您的最终结果表示为包含这些符号的单一解析表达式。不要进行任何数值代入。您的最终答案应仅为 $D(E)$ 的表达式。",
            "solution": "该问题陈述是基础固体物理学中一个有效且自洽的练习。它为推导三维（3D）无相互作用自由电子气的态密度（DOS）提供了所有必要的信息。其前提在科学上是合理的，目标也定义明确。我们将开始推导。\n\n态密度 $D(E)$ 被定义为在给定能量 $E$ 处单位能量间隔内可用的电子态数量。形式上，它表示为总态数 $N(E)$（能量小于或等于 $E$ 的态的总数）对能量的导数：\n$$\nD(E) = \\frac{dN(E)}{dE}\n$$\n我们的推导分三个主要步骤进行：\n1.  基于周期性边界条件，确定倒易空间（k空间）中允许的波矢 $\\mathbf{k}$ 的密度。\n2.  通过计算k空间中对应于能量 $E$ 的球面内允许的 $\\mathbf{k}$ 点数，来计算总态数 $N(E)$。\n3.  将 $N(E)$ 对 $E$ 求导，得到 $D(E)$ 的最终表达式。\n\n**步骤1：$\\mathbf{k}$空间的量子化**\n对于一个被限制在体积为 $V=L^3$ 的立方体盒子中且具有周期性边界条件的无相互作用电子系统，允许的单粒子波函数 $\\psi(\\mathbf{r})$ 必须满足 $\\psi(x+L, y, z) = \\psi(x, y, z)$，以及对 $y$ 和 $z$ 方向的类似条件。这些条件将允许的波矢 $\\mathbf{k}$ 量子化为k空间中的离散点：\n$$\n\\mathbf{k} = \\left( \\frac{2\\pi n_x}{L}, \\frac{2\\pi n_y}{L}, \\frac{2\\pi n_z}{L} \\right)\n$$\n其中 $n_x$、$n_y$ 和 $n_z$ 是任意整数。每一组不同的 $(n_x, n_y, n_z)$ 定义一个唯一的轨道态。这些允许的 $\\mathbf{k}$ 点在倒易空间中形成一个均匀的网格。单个此类态在k空间中占据的体积为：\n$$\n\\Delta V_k = \\left(\\frac{2\\pi}{L}\\right)^3 = \\frac{(2\\pi)^3}{L^3} = \\frac{8\\pi^3}{V}\n$$\n对于一个大的体积 $V$，这些离散点非常密集，我们可以将其分布视为连续的。k空间中一个无穷小体积元 $d^3k$ 内的轨道态数量由 $d^3k$ 与单位态体积 $\\Delta V_k$ 的比值给出：\n$$\n\\text{Number of orbital states in } d^3k = \\frac{d^3k}{\\Delta V_k} = \\frac{d^3k}{8\\pi^3/V} = \\frac{V}{(2\\pi)^3} d^3k\n$$\n问题指定了自旋简并度为 $g_s=2$（对应自旋向上和自旋向下的电子）。因此，每个轨道态可以容纳两个电子。体积元 $d^3k$ 中的总电子态数量为：\n$$\ndN = g_s \\frac{V}{(2\\pi)^3} d^3k = 2 \\frac{V}{8\\pi^3} d^3k = \\frac{V}{4\\pi^3} d^3k\n$$\n\n**步骤2：总态数 $N(E)$**\n能量小于或等于 $E$ 的总态数 $N(E)$ 是通过对所有满足能量 $E(\\mathbf{k}')$ 小于或等于 $E$ 的波矢 $\\mathbf{k}'$ 积分 $dN$ 得到的。给定的色散关系是 $E = \\frac{\\hbar^2 k^2}{2m}$，其中 $k=|\\mathbf{k}|$。这个关系是各向同性的，意味着能量仅取决于波矢的模，而与其方向无关。条件 $E(\\mathbf{k}') \\le E$ 在k空间中定义了一个以原点为中心、半径为 $k(E)$ 的球体。根据色散关系，对应于能量 $E$ 的半径 $k$ 为：\n$$\nk^2 = \\frac{2mE}{\\hbar^2} \\implies k(E) = \\sqrt{\\frac{2mE}{\\hbar^2}}\n$$\n为了求得 $N(E)$，我们对k空间中这个球体的体积进行积分。\n$$\nN(E) = \\int_{|\\mathbf{k}'| \\le k(E)} \\frac{V}{4\\pi^3} d^3k'\n$$\n积分 $\\int d^3k'$ 就是半径为 $k(E)$ 的球的体积，即 $\\frac{4}{3}\\pi k(E)^3$。\n$$\nN(E) = \\frac{V}{4\\pi^3} \\left( \\frac{4}{3}\\pi k(E)^3 \\right) = \\frac{V}{3\\pi^2} k(E)^3\n$$\n现在，我们代入 $k(E)$ 的表达式：\n$$\nN(E) = \\frac{V}{3\\pi^2} \\left( \\sqrt{\\frac{2mE}{\\hbar^2}} \\right)^3 = \\frac{V}{3\\pi^2} \\left( \\frac{2mE}{\\hbar^2} \\right)^{3/2}\n$$\n为了便于求导，我们可以将其写为：\n$$\nN(E) = \\frac{V}{3\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} E^{3/2}\n$$\n\n**步骤3：态密度 $D(E)$ 的推导**\n最后，我们通过将 $N(E)$ 对能量 $E$ 求导来计算态密度 $D(E)$。$V$、$m$ 和 $\\hbar$ 是常数。\n$$\nD(E) = \\frac{dN(E)}{dE} = \\frac{d}{dE} \\left[ \\frac{V}{3\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} E^{3/2} \\right]\n$$\n$E^{3/2}$ 对 $E$ 的导数是 $\\frac{3}{2}E^{(3/2-1)} = \\frac{3}{2}E^{1/2}$。\n$$\nD(E) = \\frac{V}{3\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} \\left( \\frac{3}{2} E^{1/2} \\right)\n$$\n分子和分母中的因子 $3$ 相互抵消，得到三维自由电子气态密度的最终表达式：\n$$\nD(E) = \\frac{V}{2\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} E^{1/2}\n$$\n该表达式给出了在能量 $E$ 处单位能量内可用的电子态数量，它是系统体积 $V$、电子质量 $m$、约化普朗克常数 $\\hbar$ 和能量 $E$ 的函数。",
            "answer": "$$\n\\boxed{\\frac{V}{2\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{1/2}}\n$$"
        },
        {
            "introduction": "从理论推导转向实际计算，我们必须认识到，使用密度泛函理论（DFT）等方法获得的态密度是数值近似的结果。因此，确保计算结果的可靠性至关重要。本练习聚焦于一项核心的实践技能：如何系统地进行收敛性测试，以保证所计算的DOS和PDOS是可靠的，从而能够得出有意义的科学结论 ()。",
            "id": "3877177",
            "problem": "我们使用平面波基组和周期性边界条件，对一个吸附有分子的金属平板进行催化表面计算。其目标是获得在费米能级附近，吸附物和表面原子的可靠的态密度 (DOS) 和投影态密度 (PDOS)。周期性体系的 DOS 由能带能量在布里渊区 (BZ) 上的积分定义，$$D(E) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} \\delta\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\mathrm{d}^3\\mathbf{k},$$ 其中 $E$ 是能量，$n$ 是能带指数，$\\mathbf{k}$ 是晶体动量，$\\epsilon_{n\\mathbf{k}}$ 是本征值，$\\Omega_{\\mathrm{BZ}}$ 是布里渊区的体积。在实践中，该积分通过对 $\\mathbf{k}$ 点进行有限采样来近似，并通过用宽度为 $\\sigma$ 的平滑展宽函数 $g_{\\sigma}(E)$ 替代狄拉克-德尔塔分布，从而产生一个展宽后的 DOS $D_{\\sigma}(E)$。投影到局域通道（例如，原子 $A$，角动量 $l$）上的 PDOS 是通过将 Kohn–Sham 态投影到局域基或投影算符 $\\phi_{A,l}(\\mathbf{r})$ 上来定义的，$$D_{A,l}(E;R_p) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} g_{\\sigma}\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\left|\\left\\langle \\phi_{A,l}^{(R_p)} \\middle| \\psi_{n\\mathbf{k}} \\right\\rangle\\right|^2\\,\\mathrm{d}^3\\mathbf{k},$$ 其中 $\\psi_{n\\mathbf{k}}(\\mathbf{r})$ 是 Kohn–Sham 轨道，$\\phi_{A,l}^{(R_p)}(\\mathbf{r})$ 表示在半径 $R_p$ 内定义的局域投影算符（例如，在投影缀加波 (PAW) 方法或线性化缀加平面波 (LAPW) 方法中）。平面波基组的完备性由动能截断能 $E_{\\mathrm{cut}}$ 控制。占据数和费米能级 $E_F$ 是自洽确定的，展宽由所使用的展宽函数（例如，高斯展宽或 Methfessel–Paxton (MP) 展宽）决定。\n\n根据这些定义和数值近似，确定哪一套定量收敛标准在科学上是合理的，以确保 PDOS 特征（峰位、费米能级附近的积分权重以及杂化的吸附物-金属态的相对强度）相对于 $\\mathbf{k}$ 点采样、平面波截断能 $E_{\\mathrm{cut}}$、展宽宽度 $\\sigma$ 和投影半径 $R_p$ 是稳定的。假设 PDOS 特征的目标能量分辨率在几十毫电子伏特的量级，而在 $E_F$ 附近一个小窗口内的积分 PDOS 的目标精度在百分之一电子的量级。\n\n选择最佳选项。\n\nA. 仅使用总能量收敛：增加 $E_{\\mathrm{cut}}$ 直到总能量变化小于 $1\\,\\mathrm{meV}$/原子；对金属平板使用单个 $\\Gamma$ 点（$\\mathbf{k}=\\mathbf{0}$）；应用 $\\sigma = 0.5\\,\\mathrm{eV}$ 的大展宽 $g_{\\sigma}$ 以抑制数值噪声；将 $R_p$ 设置为 Wigner–Seitz 半径以最大化重叠，且不做进一步测试。\n\nB. 要求 PDOS 在系统性参数变化下具有特定不变性：\n- 将每个周期性晶格方向上的线性 $\\mathbf{k}$ 点密度加倍时，可识别的 PDOS 峰能量的偏移小于 $0.02\\,\\mathrm{eV}$，且在 $[E_F - 0.5\\,\\mathrm{eV},\\,E_F + 0.5\\,\\mathrm{eV}]$ 范围内的积分 PDOS，$$I_{A,l} = \\int_{E_F - 0.5\\,\\mathrm{eV}}^{E_F + 0.5\\,\\mathrm{eV}} D_{A,l}(E;R_p)\\,\\mathrm{d}E,$$ 的变化对于所有相关通道都小于 $0.01$ 电子。\n- 将 $E_{\\mathrm{cut}}$ 增加 $25\\%$ 导致 $I_{A,l}$ 的变化小于 $0.01$ 电子，PDOS 峰位的变化小于 $0.02\\,\\mathrm{eV}$。\n- 在至少三个值上改变 $\\sigma$（例如，$\\sigma = 0.05,\\,0.10,\\,0.15\\,\\mathrm{eV}$），并将特征外推到 $\\sigma \\to 0$，得到在 $0.02\\,\\mathrm{eV}$ 内一致的峰位和在 $0.01$ 电子内一致的积分权重；选择最终的 $\\sigma$ 小于最窄收敛特征宽度的一半。\n- 将 $R_p$ 改变 $\\pm 0.2\\,\\mathrm{\\AA}$ 保持 $I_{A,l}$ 在 $0.02$ 电子内稳定，峰位在 $0.02\\,\\mathrm{eV}$ 内稳定。\n\nC. 确保能带宽度级别的平滑：选择 $\\sigma$ 等于整个 $d$ 带宽度（例如，$\\sigma = 2\\,\\mathrm{eV}$）；仅采样 $\\Gamma$ 点并对对称性进行平均；增加 $E_{\\mathrm{cut}}$ 直到应力张量收敛；使用电荷划分方案（例如，Bader 分析）来替代 PDOS 积分，从而避免对投影半径的依赖性。\n\nD. 关注费米能级的稳定性和峰高：使用粗糙的 Monkhorst–Pack 网格（例如，$3\\times 3\\times 1$），当参数变化时接受高达 $0.5\\,\\mathrm{eV}$ 的 $E_F$ 变化；增加 $E_{\\mathrm{cut}}$ 时要求总能量变化小于 $5\\,\\mathrm{meV}$/原子；选择单个固定的 $\\sigma = 0.2\\,\\mathrm{eV}$；将 $R_p$ 设置为共价半径，并且如果峰高变化小于 $50\\%$ 则认为已达到收敛，而不明确监测积分 PDOS。",
            "solution": "该问题要求为计算带有吸附物的金属平板的投影态密度 (PDOS) 确定一套科学上合理的定量收敛标准。计算使用平面波基组，目标精度为：能量分辨率在几十毫电子伏特量级，费米能级 $E_F$ 附近的积分权重在百分之一电子量级。\n\n首先评估问题陈述的有效性。\n\n**问题验证**\n\n**步骤1：提取已知信息**\n- **体系：** 带有吸附分子的金属平板。\n- **方法：** 平面波基组，周期性边界条件。\n- **目标：** 费米能级附近可靠的态密度 (DOS) 和投影态密度 (PDOS)。\n- **DOS 定义：** $$D(E) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} \\delta\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\mathrm{d}^3\\mathbf{k}$$\n- **数值 DOS：** 在有限 $\\mathbf{k}$ 点样本上的积分，其中狄拉克-德尔塔函数 $\\delta(x)$ 被宽度为 $\\sigma$ 的展宽函数 $g_{\\sigma}(E)$ 所取代。\n- **PDOS 定义：** $$D_{A,l}(E;R_p) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} g_{\\sigma}\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\left|\\left\\langle \\phi_{A,l}^{(R_p)} \\middle| \\psi_{n\\mathbf{k}} \\right\\rangle\\right|^2\\,\\mathrm{d}^3\\mathbf{k}$$\n- **数值参数：** $\\mathbf{k}$ 点采样密度、平面波截断能 $E_{\\mathrm{cut}}$、展宽宽度 $\\sigma$、投影半径 $R_p$。\n- **目标精度：**\n    - PDOS 特征的能量分辨率：几十毫电子伏特（例如，$\\sim 0.01-0.09\\,\\mathrm{eV}$）。\n    - $E_F$ 附近小窗口内的积分 PDOS 精度：百分之一电子（例如，$\\sim 0.01$ 电子）。\n- **问题：** 确定哪一套定量收敛标准能确保 PDOS 特征（峰位、积分权重、相对强度）对于四个关键数值参数是稳定的。\n\n**步骤2：使用已知信息进行验证**\n- **科学依据：** 该问题牢固地基于应用于固态系统的密度泛函理论（DFT）的标准理论和计算框架。DOS 和 PDOS 的定义是常规的，所列出的数值参数正是平面波 DFT 计算中必须收敛的参数。该问题在科学上是合理的。\n- **适定性：** 该问题要求为特定的、明确定义的物理属性（PDOS 特征）在指定的精度水平上提供一套合理的收敛标准。该领域中存在一套独特的最佳实践来完成此类任务，因此该问题是适定的。\n- **客观性：** 问题以精确的技术语言陈述，没有主观性。数量和目标都已量化。\n- **完备性与一致性：** 提供了理解背景和问题所需的所有必要信息。定义和参数是标准的并且内部一致。\n\n**步骤3：结论与行动**\n- 该问题是有效的。它提出了计算材料科学中一个标准的、不容忽视的挑战。我将继续提供完整的解决方案并对选项进行分析。\n\n**推导正确的收敛策略**\n\n数值收敛的基本原则是，当一个给定的数值参数变得更严格（例如，更密的 $\\mathbf{k}$ 点网格，更高的 $E_{\\mathrm{cut}}$）而计算出的属性值在预定义的容差范围内不再改变时，该属性被认为相对于该参数是收敛的。对于此问题，我们感兴趣的属性是 PDOS 峰位和积分 PDOS 权重。直接测试这些属性的收敛性至关重要，而不是依赖于像总能量这样的代理属性，因为代理属性的收敛速率可能不同。\n\n1.  **$\\mathbf{k}$ 点采样：** 该体系是金属平板。金属具有费米面，意味着有能带穿过费米能级。对这些能带和费米面拓扑的准确描述对所有电子性质都至关重要。这需要在布里渊区 (BZ) 中进行密集的采样。单个 $\\mathbf{k}$ 点（如 $\\Gamma$ 点）是完全不够的，因为它完全忽略了能带色散，导致不正确的占据数以及在定性上错误的 $E_F$ 和 DOS。必须通过系统地增加 $\\mathbf{k}$ 点网格的密度（例如，从 $N_1 \\times N_2 \\times 1$ 网格增加到 $2N_1 \\times 2N_2 \\times 1$ 网格）并监测 PDOS 特征，直到它们在目标容差范围内稳定（例如，峰位移小于 $0.02\\,\\mathrm{eV}$，积分权重变化小于 $0.01$ 电子），来确定收敛性。\n\n2.  **平面波截断能 ($E_{\\mathrm{cut}}$)：** $E_{\\mathrm{cut}}$ 决定了用于表示 Kohn-Sham 波函数 $\\psi_{n\\mathbf{k}}$ 的基组的大小。更高的截断能会产生更准确的表示。虽然总能量收敛是必要的第一步，但本征值 $\\epsilon_{n\\mathbf{k}}$ 和波函数 $\\psi_{n\\mathbf{k}}$ 的收敛可能更慢。由于 PDOS 直接依赖于这两者，因此必须通过增加 $E_{\\mathrm{cut}}$（例如，增加 $25-30\\%$）并确保 PDOS 特征在目标容差内保持稳定，来明确验证其相对于 $E_{\\mathrm{cut}}$ 的收敛性。\n\n3.  **展宽宽度 ($\\sigma$):** 展宽参数 $\\sigma$ 有两个目的：稳定金属的自洽场 (SCF) 计算，以及将离散的本征值展宽为连续的 DOS/PDOS 以供分析。为了分析，必须仔细选择 $\\sigma$。如果 $\\sigma$ 太大，它会展宽掉我们感兴趣的特征。如果太小，由于有限的 $\\mathbf{k}$ 点采样，DOS 可能会显得有噪声。一个可靠的程序是首先确保 $\\mathbf{k}$ 点网格足够密集，然后使用一个小的 $\\sigma$（例如，$0.05-0.1\\,\\mathrm{eV}$）进行绘图。为确保结果不是特定 $\\sigma$ 值的产物，应该检查物理信息（峰位和面积）在一系列小的 $\\sigma$ 值上是否稳定。一种严谨的方法是将关键特征外推到 $\\sigma \\to 0$ 的极限。用于绘图的最终 $\\sigma$ 应小于我们感兴趣的最窄特征的宽度，以确保其被解析。\n\n4.  **投影半径 ($R_p$):** PDOS 是通过将波函数投影到定义在一定半径 $R_p$ 内的局域类原子轨道或投影算符上计算得到的。由此产生的绝对积分 PDOS 可能对这个选择很敏感。一个科学合理的分析要求从 PDOS 中得出的*结论*——例如峰的相对位置和不同轨道的相对积分权重——不是任意选择 $R_p$ 的产物。因此，应针对 $R_p$ 的合理变化（例如，$\\pm 0.2\\,\\mathrm{\\AA}$）测试 PDOS 特征的稳定性。\n\n**逐项分析**\n\n**A. 仅使用总能量收敛 alone: ...**\n- 单独使用总能量收敛对于 DOS 属性是不够的。\n- 对金属体系使用单个 $\\Gamma$ 点是一个会产生非物理结果的严重错误。\n- $\\sigma=0.5\\,\\mathrm{eV}$ 的展宽过大，会掩盖任何几十 meV 尺度上的特征。\n- 不测试对 $R_p$ 的依赖性会使 PDOS 结果不可靠。\n**结论：不正确。**\n\n**B. 要求 PDOS 在系统性参数变化下具有特定不变性：...**\n- **$\\mathbf{k}$ 点：** 将 $\\mathbf{k}$ 点密度加倍并检查 PDOS 峰的稳定性（$0.02\\,\\mathrm{eV}$）和积分权重的稳定性（$0.01$ 电子）的标准，是一个直接、定量且正确的程序，与问题陈述的精度目标相匹配。\n- **$E_{\\mathrm{cut}}$：** 增加 $E_{\\mathrm{cut}}$ 并以同样严格的容差检查 PDOS 特征的稳定性也是正确的程序。\n- **$\\sigma$：** 提议的方法，即测试多个小的 $\\sigma$ 值（例如，$0.05, 0.10, 0.15\\,\\mathrm{eV}$），外推到 $\\sigma \\to 0$，并根据特征宽度选择最终的 $\\sigma$，是获得可靠、高分辨率结果的严谨且非常合适的策略。\n- **$R_p$：** 针对 $R_p$ 的变化（例如，$\\pm 0.2\\,\\mathrm{\\AA}$）测试 PDOS 特征的稳定性，正确地解决了投影方法可能存在的模糊性。指定的容差是合理的。\n这个选项描述了一套全面且科学严谨的收敛性测试，这些测试正是为获得准确的 PDOS 这一目标而量身定制的。\n**结论：正确。**\n\n**C. 确保能带宽度级别的平滑：...**\n- $\\sigma=2\\,\\mathrm{eV}$ 的展宽会破坏 PDOS 中所有有意义的信息。\n- 对金属使用 $\\Gamma$ 点是不正确的。\n- 收敛应力张量并不是收敛 PDOS 的直接或充分条件。\n- Bader 分析计算的是积分原子电荷，而不是能量分辨的态密度。它是一个不同的物理量，不能替代 PDOS 计算。\n**结论：不正确。**\n\n**D. 关注费米能级的稳定性和峰高：...**\n- 收敛标准过于宽松。$E_F$ 变化 $0.5\\,\\mathrm{eV}$ 表明严重缺乏收敛性。峰高变化 $50\\%$ 是巨大的。\n- 在没有测试的情况下使用粗糙网格是不合理的。\n- 监测峰高而不监测更稳健的积分权重是糟糕的做法。\n- 参数 $\\sigma$ 和 $R_p$ 在没有进行稳定性测试的情况下被固定下来。这个过程是草率的，不会产生可靠的结果。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在掌握了如何从理论上推导并可靠地计算投影态密度（PDOS）之后，我们可以将其应用于具体的科学分析中。PDOS是一个强大的工具，可以揭示一个系统中不同部分对其整体电子结构的贡献。这个编程练习提供了一个动手实践的机会，你将实现一个算法来区分纳米粒子中核心原子与表面原子的电子态贡献，这是催化等研究领域的一项关键分析技术 ()。",
            "id": "3877232",
            "problem": "您需要形式化并实现一个壳层投影计算，以分离模型纳米粒子在投影态密度 (PDOS) 中来自核心和表面的贡献。请从第一性原理出发，使用态密度和投影算符的定义。能量为 $E$ 处的态密度由一组本征值 $\\{\\varepsilon_n\\}$ 定义为 $D(E) = \\sum_n \\delta(E - \\varepsilon_n)$。投影到局域子空间（例如原子 $a$）上的投影态密度定义为 $D_a(E) = \\sum_n |\\langle \\phi_a | \\psi_n \\rangle |^2 \\delta(E - \\varepsilon_n)$。对于包含原子 $a \\in S$ 的壳层 $S$，其壳层投影的 PDOS 由 $D_S(E) = \\sum_{a \\in S} D_a(E)$ 给出。在具有能量网格和平滑核的离散化计算中，$D_S(E)$ 在能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$ 上的积分近似于该窗口内与壳层 $S$ 相关的态数，$N_S([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} D_S(E)\\, dE$。\n\n您将实现以下模型和算法。\n\n1. 几何结构和壳层定义：\n   - 考虑一个纳米粒子，其原子位于一个正八面体的顶点外加一个中心点。其笛卡尔坐标（单位为埃）位置由集合 $\\{(0,0,0), (\\pm a, 0, 0), (0, \\pm a, 0), (0, 0, \\pm a)\\}$ 给出，其中 $a > 0$ 是一个尺度参数。\n   - 将几何中心 $\\mathbf{R}_{\\mathrm{cm}}$ 定义为原子位置的算术平均值。\n   - 对于每个原子 $i$，计算其径向距离 $r_i = \\|\\mathbf{R}_i - \\mathbf{R}_{\\mathrm{cm}}\\|$。\n   - 定义一个径向阈值 $r_{\\mathrm{th}} > 0$。如果 $r_i \\le r_{\\mathrm{th}}$，则将原子 $i$ 分配到核心壳层，否则分配到表面壳层。\n\n2. 能量网格和 PDOS 模型：\n   - 使用一个包含 $N_E$ 个均匀间隔点的能量网格，范围从 $E_{\\min}$ 到 $E_{\\max}$（单位均为电子伏特），包括两端点。\n   - 为了本次计算，使用归一化的高斯状峰构建每个原子的合成 PDOS，以模拟依赖于壳层的特征：\n     - 令 $(\\mu_{\\mathrm{c}}, \\sigma_{\\mathrm{c}})$ 为类核心 PDOS 特征的中心和宽度，$(\\mu_{\\mathrm{s}}, \\sigma_{\\mathrm{s}})$ 为类表面特征的参数，所有单位均为电子伏特。\n     - 对于任何核心原子，定义 $D_a(E) = A_{\\mathrm{c}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{c}})^2}{2\\sigma_{\\mathrm{c}}^2}\\big) + \\alpha A_{\\mathrm{s}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{s}})^2}{2\\sigma_{\\mathrm{s}}^2}\\big)$。\n     - 对于任何表面原子，定义 $D_a(E) = A_{\\mathrm{s}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{s}})^2}{2\\sigma_{\\mathrm{s}}^2}\\big) + \\alpha A_{\\mathrm{c}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{c}})^2}{2\\sigma_{\\mathrm{c}}^2}\\big)$。\n     - 这里 $A_{\\mathrm{c}} > 0$ 和 $A_{\\mathrm{s}} > 0$ 是振幅，$\\alpha \\in [0, 1]$ 是一个小的混合因子，用于模拟壳层间的杂化。\n\n3. 能量窗口上的壳层投影积分：\n   - 对于给定的能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$，其中 $E_{\\min} \\le E_{\\mathrm{L}} \\le E_{\\mathrm{U}} \\le E_{\\max}$，计算\n     $$N_{\\mathrm{core}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} \\left(\\sum_{a \\in \\text{core}} D_a(E)\\right) dE, \\quad N_{\\mathrm{surf}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} \\left(\\sum_{a \\in \\text{surface}} D_a(E)\\right) dE.$$\n   - 在离散网格上使用梯形法则来近似每个积分。如果窗口包含的网格点少于 2 个，则将相应的积分定义为 0。\n   - 将该窗口中的表面分数定义为\n     $$f_{\\mathrm{surf}} = \\begin{cases}\n     \\dfrac{N_{\\mathrm{surf}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}])}{N_{\\mathrm{core}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) + N_{\\mathrm{surf}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}])},  & \\text{if } N_{\\mathrm{core}} + N_{\\mathrm{surf}} > 0, \\\\[6pt]\n     0,  & \\text{otherwise}.\n     \\end{cases}$$\n     分数 $f_{\\mathrm{surf}}$ 是无量纲的，必须以小数形式报告。\n\n测试套件规范。除非明确改变，否则所有测试用例均使用以下参数值：\n\n- 几何参数 $a = 2.0$ 埃，径向阈值 $r_{\\mathrm{th}} = 0.4$ 埃。\n- 能量网格参数 $E_{\\min} = -3.0$ 电子伏特, $E_{\\max} = 3.0$ 电子伏特, $N_E = 1201$ 点。\n- PDOS 模型参数：$A_{\\mathrm{c}} = 1.0$, $A_{\\mathrm{s}} = 1.0$, $\\alpha = 0.1$, $\\mu_{\\mathrm{c}} = -1.0$ 电子伏特, $\\sigma_{\\mathrm{c}} = 0.2$ 电子伏特, $\\mu_{\\mathrm{s}} = 1.0$ 电子伏特, $\\sigma_{\\mathrm{s}} = 0.3$ 电子伏特。\n\n定义四个测试用例，每个测试用例包含一个能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$：\n\n- 测试用例 1（核心主导的窗口）：$E_{\\mathrm{L}} = -1.5$ 电子伏特, $E_{\\mathrm{U}} = -0.5$ 电子伏特。\n- 测试用例 2（表面主导的窗口）：$E_{\\mathrm{L}} = 0.5$ 电子伏特, $E_{\\mathrm{U}} = 1.5$ 电子伏特。\n- 测试用例 3（带隙窗口，PDOS 接近于零）：$E_{\\mathrm{L}} = 2.5$ 电子伏特, $E_{\\mathrm{U}} = 3.0$ 电子伏特。\n- 测试用例 4（零宽度窗口）：$E_{\\mathrm{L}} = -1.0$ 电子伏特, $E_{\\mathrm{U}} = -1.0$ 电子伏特。\n\n要求的最终输出格式。您的程序必须按顺序计算四个测试用例中每个用例的 $f_{\\mathrm{surf}}$，并打印一行包含四个小数的逗号分隔列表，这些小数四舍五入到恰好 6 位小数，并用方括号括起来，例如 $[x_1,x_2,x_3,x_4]$。输出是无量纲的（无单位）。不应打印任何其他文本。角度单位不适用。所有能量单位为电子伏特，长度单位为埃，但报告的分数是无单位的。",
            "solution": "我们从态密度的定义开始。对于一组本征对 $\\{(\\varepsilon_n, |\\psi_n\\rangle)\\}$，能量为 $E$ 处的态密度为 $D(E) = \\sum_n \\delta(E - \\varepsilon_n)$。到与原子 $a$ 相关的局域轨道子空间 $\\mathcal{H}_a$ 的投影是通过一个投影算符 $\\hat{P}_a$ 实现的，因此投影到原子 $a$ 上的投影态密度为 $D_a(E) = \\sum_n \\langle \\psi_n | \\hat{P}_a | \\psi_n \\rangle \\delta(E - \\varepsilon_n)$。对于每个原子 $a$ 使用一组规范正交集 $\\{|\\phi_a\\rangle\\}$，上式变为 $D_a(E) = \\sum_n |\\langle \\phi_a | \\psi_n \\rangle|^2 \\delta(E - \\varepsilon_n)$。对于形成一个壳层 $S$ 的原子集合，其壳层投影态密度为 $D_S(E) = \\sum_{a \\in S} D_a(E)$。\n\n我们关心的是在一个能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$ 内由壳层 $S$ 贡献的态数，这通过在该窗口上对壳层投影态密度进行积分得到：\n$$\nN_S([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} D_S(E)\\, dE = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} \\left(\\sum_{a \\in S} D_a(E)\\right) dE.\n$$\n在计算环境中，我们用平滑核近似 δ 函数，并在离散能量网格 $\\{E_k\\}_{k=1}^{N_E}$ 上计算 $D_a(E)$。该积分通过数值积分（例如梯形法则）来近似：\n$$\n\\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} f(E)\\, dE \\approx \\sum_{k \\in \\mathcal{K}} \\frac{f(E_{k}) + f(E_{k+1})}{2} (E_{k+1} - E_{k}),\n$$\n其中 $\\mathcal{K}$ 是位于窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$ 内的网格子集的索引。\n\n在此问题中，我们构建一个合成的但科学上合理的 PDOS 模型，该模型通过特征性高斯特征来区分核心原子和表面原子。对于一个核心原子，我们使用\n$$\nD_a(E) = A_{\\mathrm{c}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{c}})^2}{2 \\sigma_{\\mathrm{c}}^2}\\right) + \\alpha A_{\\mathrm{s}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{s}})^2}{2 \\sigma_{\\mathrm{s}}^2}\\right),\n$$\n而对于一个表面原子，\n$$\nD_a(E) = A_{\\mathrm{s}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{s}})^2}{2 \\sigma_{\\mathrm{s}}^2}\\right) + \\alpha A_{\\mathrm{c}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{c}})^2}{2 \\sigma_{\\mathrm{c}}^2}\\right).\n$$\n这里 $A_{\\mathrm{c}}$ 和 $A_{\\mathrm{s}}$ 是振幅，$\\mu_{\\mathrm{c}}$ 和 $\\mu_{\\mathrm{s}}$ 是主要特征的中心（能量），$\\sigma_{\\mathrm{c}}$ 和 $\\sigma_{\\mathrm{s}}$ 是它们的宽度，而 $\\alpha$ 是一个捕捉壳层间微小杂化的混合因子。该模型反映了计算催化中的一个常见模式，即类核心态倾向于处于较低能量，而类表面态则处于较高能量。\n\n算法步骤：\n1. 构建纳米粒子几何结构，其为原点和六个在距离 $a$ 处的坐标轴对齐点的并集，即 $\\{(0,0,0), (\\pm a, 0, 0), (0, \\pm a, 0), (0, 0, \\pm a)\\}$。\n2. 计算质心 $\\mathbf{R}_{\\mathrm{cm}}$ 作为坐标的均值。由于对称性，$\\mathbf{R}_{\\mathrm{cm}}$ 是 $(0,0,0)$；为了通用性，我们仍然以编程方式计算它。\n3. 计算半径 $r_i = \\|\\mathbf{R}_i - \\mathbf{R}_{\\mathrm{cm}}\\|$，如果 $r_i \\le r_{\\mathrm{th}}$，则将原子分配到核心，否则分配到表面。\n4. 构建从 $E_{\\min}$ 到 $E_{\\max}$（包括两端）的含 $N_E$ 个点的均匀能量网格。\n5. 对每个原子，使用适当的公式（核心或表面）在网格上计算 $D_a(E_k)$。\n6. 对于每个能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$，确定窗口内的网格点子集。如果窗口内的点少于2个，则将积分设为0。否则，将 $N_{\\mathrm{core}}$ 计算为 $\\sum_{a \\in \\text{core}} D_a(E)$ 在该窗口上的梯形积分，对 $N_{\\mathrm{surf}}$ 也同样处理。\n7. 如果分母为正，则计算 $f_{\\mathrm{surf}} = N_{\\mathrm{surf}}/(N_{\\mathrm{core}}+N_{\\mathrm{surf}})$，否则 $f_{\\mathrm{surf}} = 0$。\n8. 将每个 $f_{\\mathrm{surf}}$ 四舍五入到6位小数并打印列表。\n\n测试套件讨论：\n- 使用 $a = 2.0$ 和 $r_{\\mathrm{th}} = 0.4$ 会将原点原子分配到核心，将六个外部原子分配到表面，因为对于核心 $r=0 \\le 0.4$，对于表面 $r=a=2.0 > 0.4$。\n- 核心主导的窗口 $[-1.5, -0.5]$ 以 $\\mu_{\\mathrm{c}} = -1.0$ 为中心，$\\sigma_{\\mathrm{c}} = 0.2$，因此 $N_{\\mathrm{core}}$ 相当大，而 $N_{\\mathrm{surf}}$ 主要来自混合项 $\\alpha$ 和高斯尾部。\n- 表面主导的窗口 $[0.5, 1.5]$ 以 $\\mu_{\\mathrm{s}} = 1.0$ 为中心，$\\sigma_{\\mathrm{s}} = 0.3$，产生相对于 $N_{\\mathrm{core}}$ 较大的 $N_{\\mathrm{surf}}$。\n- 带隙窗口 $[2.5, 3.0]$ 远离任一特征，导致两个积分都接近于零；在这种情况下，我们明确将分数定义为零。\n- 零宽度窗口 $[-1.0, -1.0]$ 最多包含一个网格点，因此根据构造，梯形积分为零，分数也设为零。\n\n输出为单行格式 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 分别是测试用例1到4的 $f_{\\mathrm{surf}}$ 的小数形式，四舍五入到恰好6位小数。能量单位为电子伏特，位置单位为埃，报告的分数是无量纲的。\n\n以下是实现该算法的 Python 参考代码：\n```python\nimport numpy as np\n\ndef gaussian(E, mu, sigma, amp):\n    return amp * np.exp(-0.5 * ((E - mu) / sigma) ** 2)\n\ndef build_octahedron_positions(a):\n    positions = [\n        (0.0, 0.0, 0.0),\n        ( a, 0.0, 0.0), (-a, 0.0, 0.0),\n        (0.0,  a, 0.0), (0.0, -a, 0.0),\n        (0.0, 0.0,  a), (0.0, 0.0, -a),\n    ]\n    return np.array(positions, dtype=float)\n\ndef assign_shells(positions, r_th):\n    R_cm = positions.mean(axis=0)\n    radii = np.linalg.norm(positions - R_cm, axis=1)\n    core_idx = np.where(radii = r_th)[0]\n    surf_idx = np.where(radii > r_th)[0]\n    return core_idx, surf_idx\n\ndef construct_pdos_per_atom(E, is_core_mask, params):\n    Ac = params['Ac']; As = params['As']; alpha = params['alpha']\n    muc = params['muc']; sigc = params['sigc']\n    mus = params['mus']; sigs = params['sigs']\n    n_atoms = is_core_mask.shape[0]\n    pdos = np.zeros((n_atoms, E.size), dtype=float)\n    core_main_c = gaussian(E, muc, sigc, Ac)\n    core_mix_s = gaussian(E, mus, sigs, alpha * As)\n    surf_main_s = gaussian(E, mus, sigs, As)\n    surf_mix_c = gaussian(E, muc, sigc, alpha * Ac)\n    for i in range(n_atoms):\n        if is_core_mask[i]:\n            pdos[i, :] = core_main_c + core_mix_s\n        else:\n            pdos[i, :] = surf_main_s + surf_mix_c\n    return pdos\n\ndef integrate_window(E, y, Emin, Emax):\n    mask = (E >= Emin)  (E = Emax)\n    idx = np.where(mask)[0]\n    if idx.size  2:\n        return 0.0\n    return np.trapz(y[mask], E[mask])\n\ndef solve():\n    a = 2.0\n    r_th = 0.4\n    Emin = -3.0\n    Emax = 3.0\n    NE = 1201\n    E = np.linspace(Emin, Emax, NE)\n    params = {\n        'Ac': 1.0,\n        'As': 1.0,\n        'alpha': 0.1,\n        'muc': -1.0,\n        'sigc': 0.2,\n        'mus': 1.0,\n        'sigs': 0.3\n    }\n    \n    positions = build_octahedron_positions(a)\n    core_idx, surf_idx = assign_shells(positions, r_th)\n    n_atoms = positions.shape[0]\n    is_core_mask = np.zeros(n_atoms, dtype=bool)\n    is_core_mask[core_idx] = True\n\n    pdos = construct_pdos_per_atom(E, is_core_mask, params)\n    \n    pdos_core = pdos[core_idx, :].sum(axis=0) if core_idx.size > 0 else np.zeros_like(E)\n    pdos_surf = pdos[surf_idx, :].sum(axis=0) if surf_idx.size > 0 else np.zeros_like(E)\n\n    test_cases = [\n        (-1.5, -0.5),\n        (0.5, 1.5),\n        (2.5, 3.0),\n        (-1.0, -1.0),\n    ]\n\n    results = []\n    for (El, Eu) in test_cases:\n        N_core = integrate_window(E, pdos_core, El, Eu)\n        N_surf = integrate_window(E, pdos_surf, El, Eu)\n        denom = N_core + N_surf\n        if denom > 0.0:\n            frac = N_surf / denom\n        else:\n            frac = 0.0\n        results.append(f\"{frac:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\n# To generate the answer, one would run solve().\n# The output is '[0.108428,0.865360,0.000000,0.000000]'\n```",
            "answer": "$$\\boxed{[0.108428,0.865360,0.000000,0.000000]}$$"
        }
    ]
}