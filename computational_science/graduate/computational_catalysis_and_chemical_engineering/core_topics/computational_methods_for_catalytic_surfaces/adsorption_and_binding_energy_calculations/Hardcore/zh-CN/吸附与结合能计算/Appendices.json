{
    "hands_on_practices": [
        {
            "introduction": "此练习构成了计算吸附能量学的基础。它将引导您直接应用吸附能的基本定义，使用从密度泛函理论 (DFT) 计算中获得的总能量。通过完成此实践 ，您将巩固对如何将原始计算输出转化为具有物理意义的吸附能的理解，这是任何表面科学研究中关键的第一步。",
            "id": "3867641",
            "problem": "为了研究闭壳层分子在金属 $(111)$ 表面上的吸附，我们采用密度泛函理论 (DFT)，在广义梯度近似 (GGA) 和投影缀加波 (PAW) 方法的框架下，进行了一次周期性平板计算。所有总能量均在相同的设置下计算（相同的晶格矢量、平面波截断能、$k$点网格和真空层厚度）。结构被完全弛豫，直到任何未约束原子上的最大残余力低于预设阈值。弛豫后获得以下总能量：\n- 洁净平板的总能量：$E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$。\n- 孤立吸附物（在相同的超胞和真空中）的总能量：$E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$。\n- 吸附物在平板上的总能量：$E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$。\n\n假设吸附过程定义为将弛豫后的孤立吸附物从无穷远处移动到弛豫后平板的确定位置上进行结合，期间计算设置和化学计量比均无变化。根据反应能的基础热力学定义，即 Born–Oppenheimer 势能面上产物与反应物之间的内能变化，请仅使用所提供的数据计算吸附能 $E_{\\mathrm{ads}}$。\n\n在产生 $E_{\\mathrm{slab+ads}}$ 的结构弛豫中，残余力最大的三个未约束原子上最终的力的大小分别为 $0.012\\,\\mathrm{eV}/\\AA$、$0.019\\,\\mathrm{eV}/\\AA$ 和 $0.017\\,\\mathrm{eV}/\\AA$。请简要描述弛豫后最大力判据的力学意义，并判断如果阈值为 $0.020\\,\\mathrm{eV}/\\AA$，这些值是否表明计算已收敛。\n\n吸附能以电子伏特为单位表示。将您的最终数值答案四舍五入至三位有效数字。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **计算类型**：在广义梯度近似 (GGA) 和投影缀加波 (PAW) 方法框架下的密度泛函理论 (DFT)。\n- **体系**：一个闭壳层分子吸附在用周期性平板建模的金属 $(111)$ 表面上。\n- **计算一致性**：所有计算（平板、孤立吸附物、组合体系）均采用相同的晶格矢量、平面波截断能、$k$点网格和真空层厚度。\n- **结构状态**：所有结构都已完全弛豫。\n- **总能量**：\n  - 洁净平板的总能量：$E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$。\n  - 孤立吸附物的总能量（在相同的超胞中）：$E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$。\n  - 吸附物在平板上的总能量：$E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$。\n- **用于收敛性检查的力数据**：\n  - 未约束原子上三个最大残余力的大小：$0.012\\,\\mathrm{eV}/\\AA$、$0.019\\,\\mathrm{eV}/\\AA$ 和 $0.017\\,\\mathrm{eV}/\\AA$。\n  - 力收敛阈值：$0.020\\,\\mathrm{eV}/\\AA$。\n- **任务**：\n  1. 计算吸附能 $E_{\\mathrm{ads}}$（以电子伏特为单位），并四舍五入至三位有效数字。\n  2. 简要描述弛豫后最大力判据的力学意义，并根据所提供的数据评估收敛性。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题在计算材料科学和量子化学的原理上有充分的依据。使用DFT结合GGA和PAW方法是研究吸附等表面现象的标准方法。从各组分的总能量计算吸附能是该领域的一个基石概念。所有数值和术语都是标准的、科学正确的。\n- **适定性**：该问题是适定的。它提供了计算吸附能所需的所有数值数据（$E_{\\mathrm{slab}}$、$E_{\\mathrm{ads}}^{\\mathrm{iso}}$、$E_{\\mathrm{slab+ads}}$）。吸附过程的定义清晰，并符合该领域的标准惯例。关于力收敛性的问题第二部分也是自洽的。存在唯一解。\n- **客观性**：该问题是客观的，使用了计算化学中常见的精确技术语言。没有主观或含糊的陈述。\n\n该问题没有表现出任何科学上不健全、不完整、矛盾或不可行等缺陷。这是其领域内一个标准的、基本的问题。\n\n### 第3步：结论与行动\n该问题是**有效的**。将制定解决方案。\n\n根据要求，解决方案包括两部分：吸附能的计算和力收敛判据的解释。\n\n**第1部分：吸附能的计算**\n\n吸附能 $E_{\\mathrm{ads}}$ 表示吸附物分子与表面结合时的能量变化。吸附过程可以写成一个反应：\n$$\n\\text{Slab} + \\text{Adsorbate} \\rightarrow \\text{Slab-Adsorbate System}\n$$\n在零开尔文温度下的DFT计算中，该过程的能量变化计算为最终状态（产物）的总能量减去初始状态（反应物）的总能量之和。反应物是孤立、弛豫的洁净平板和孤立、弛豫的吸附物分子。产物是吸附物结合到平板上的组合体系，也处于其弛豫状态。\n\n因此，吸附能的公式为：\n$$\nE_{\\mathrm{ads}} = E_{\\mathrm{slab+ads}} - (E_{\\mathrm{slab}} + E_{\\mathrm{ads}}^{\\mathrm{iso}})\n$$\n其中：\n- $E_{\\mathrm{slab+ads}}$ 是吸附物在其表面上的弛豫后平板的总能量。\n- $E_{\\mathrm{slab}}$ 是弛豫后洁净平板的总能量。\n- $E_{\\mathrm{ads}}^{\\mathrm{iso}}$ 是弛豫后孤立吸附物分子的总能量，在同一个超胞中计算以确保能量参考的一致性并消除基组重叠误差 (BSSE)，尽管GGA相比其他一些方法对BSSE不太敏感。\n\n使用给定值：\n$E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$\n$E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$\n$E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$\n\n首先，我们计算反应物的总能量：\n$$\nE_{\\mathrm{reactants}} = E_{\\mathrm{slab}} + E_{\\mathrm{ads}}^{\\mathrm{iso}} = -256.873\\,\\mathrm{eV} + (-14.209\\,\\mathrm{eV}) = -271.082\\,\\mathrm{eV}\n$$\n现在，我们可以计算吸附能：\n$$\nE_{\\mathrm{ads}} = E_{\\mathrm{slab+ads}} - E_{\\mathrm{reactants}} = -271.427\\,\\mathrm{eV} - (-271.082\\,\\mathrm{eV})\n$$\n$$\nE_{\\mathrm{ads}} = -271.427\\,\\mathrm{eV} + 271.082\\,\\mathrm{eV} = -0.345\\,\\mathrm{eV}\n$$\n吸附能的负号表示该过程是放热的，意味着吸附时会释放能量，并且束缚态比分离的组分更稳定。这是自发吸附发生的必要条件。\n\n问题要求答案四舍五入至三位有效数字。计算出的值 $-0.345\\,\\mathrm{eV}$ 已经有三位有效数字（数字 $3$、$4$ 和 $5$）。\n\n**第2部分：力判据的意义和收敛性评估**\n\n在量子力学计算中，结构弛豫旨在找到 Born-Oppenheimer 势能面 (PES) 上的一个局域最小值。PES 描述了体系的总能量作为其原子核位置的函数。一个稳定的平衡几何构型对应于能量处于局域最小值的点。\n\n从力学上讲，平衡的一个条件是每个原子上的合力为零。在 PES 的背景下，作用在原子 $i$ 上的力 $\\vec{F}_i$ 是总能量 $E$ 相对于该原子坐标 $\\vec{r}_i$ 的负梯度：\n$$\n\\vec{F}_i = -\\nabla_{\\vec{r}_i} E\n$$\n因此，在 PES 的一个局域最小值（或任何驻点）上，所有原子上的力都为零。\n\n在数值计算中，实际上不可能找到一个所有力都精确为零的几何构型。相反，当所有未约束原子上的力都小于一个预定义的、很小的正值（称为力收敛阈值）时，弛豫就被认为是“收敛”的。 “最大力判据”规定，体系中所有未约束原子中最大力矢量的大小必须小于此阈值。这确保了体系非常接近 PES 上的一个驻点，并且任何进一步的结构变化只会导致总能量发生可忽略不计的变化。\n\n对于给定的问题：\n- 力收敛阈值设置为 $0.020\\,\\mathrm{eV}/\\AA$。\n- 报告的三个最大残余力的大小为 $0.012\\,\\mathrm{eV}/\\AA$、$0.019\\,\\mathrm{eV}/\\AA$ 和 $0.017\\,\\mathrm{eV}/\\AA$。\n- 这些力中的最大值为 $\\max(0.012, 0.019, 0.017) = 0.019\\,\\mathrm{eV}/\\AA$。\n\n为评估收敛性，我们将观察到的最大力与阈值进行比较：\n$$\n0.019\\,\\mathrm{eV}/\\AA  0.020\\,\\mathrm{eV}/\\AA\n$$\n由于体系中最大的残余力小于指定的收敛阈值，因此根据给定的判据，结构弛豫被认为是成功收敛的。",
            "answer": "$$\n\\boxed{-0.345}\n$$"
        },
        {
            "introduction": "找到一个原子受力趋近于零的结构只是完成了一半的工作；我们必须确认它代表一个真正的能量极小点，而非一个不稳定的过渡态。此实践  深入探讨了振动分析这一必要的后处理步骤。您将通过实施一个算法来分析赫斯矩阵，通过识别虚频来区分稳定极小点和鞍点，从而确保您预测的吸附构型的物理有效性。",
            "id": "3867632",
            "problem": "给定一个从计算催化和化学工程中的吸附几何构型验证中提取的简化振动分析任务。目标是通过振动分析和本征模检测，确定所报告的吸附几何构型是对应于势能面（PES）上的真正最小值点，还是一个鞍点。推导和算法的基本基础应从 Born–Oppenheimer 近似和势能关于稳定点的二阶泰勒展开开始，并结合 Hessian 矩阵和用于简正模分析的质量加权的定义。\n\n从以下基本原理开始：\n\n1. 在 Born–Oppenheimer 近似下，势能面 $V(\\mathbf{R})$ 取决于原子核坐标 $\\mathbf{R}$，一个稳定点 $\\mathbf{R}_0$ 满足 $\\nabla V(\\mathbf{R}_0) = \\mathbf{0}$。\n\n2. 势能围绕 $\\mathbf{R}_0$ 的二阶泰勒展开为 $V(\\mathbf{R}_0 + \\Delta \\mathbf{R}) \\approx V(\\mathbf{R}_0) + \\tfrac{1}{2}\\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}$，其中 $\\mathbf{K}$ 是二阶导数的 Hessian 矩阵，其分量为 $K_{\\alpha\\beta} = \\left. \\dfrac{\\partial^2 V}{\\partial R_{\\alpha} \\partial R_{\\beta}}\\right|_{\\mathbf{R}_0}$。\n\n3. 定义对角质量矩阵 $\\mathbf{M}$，其中包含每个坐标重复的原子质量，以及质量加权 Hessian 矩阵 $\\mathbf{F} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$。简正模分析求解本征问题 $\\mathbf{F} \\mathbf{v}_i = \\lambda_i \\mathbf{v}_i$，其中 $\\lambda_i$ 是曲率本征值，在一致的单位下与角频率的平方成正比。\n\n4. 在移除刚性平移和旋转后，真正的最小值点的特征是其 Hessian 矩阵是半正定的；等效地，对于质量加权 Hessian 矩阵 $\\mathbf{F}$，在数值容差范围内，对于所有的 $i$ 都必须有 $\\lambda_i \\ge 0$。一阶鞍点恰好有一个负本征值 $\\lambda_i  0$，它对应于沿着一个不稳定本征模的虚频。\n\n您的程序必须实现以下算法：\n\n- 给定一个对称 Hessian 矩阵 $\\mathbf{K}$ 和一个原子质量列表 $m_j$，为每个坐标 $\\alpha$ 构建对角质量加权 $d_\\alpha = 1/\\sqrt{m_\\alpha}$，并计算 $\\mathbf{F} = \\mathrm{diag}(d) \\, \\mathbf{K} \\, \\mathrm{diag}(d)$。\n\n- 计算 $\\mathbf{F}$ 的所有本征值 $\\lambda_i$ 和标准正交本征向量 $\\mathbf{v}_i$。\n\n- 使用一个严格的数值阈值 $\\varepsilon$ 来区分物理负值与数值噪声。将虚模的数量 $N_{\\mathrm{imag}}$ 计为满足 $\\lambda_i  -\\varepsilon$ 的本征值的数量。\n\n- 确定一个布尔分类 $b_{\\mathrm{min}}$，如果 $N_{\\mathrm{imag}} = 0$，则 $b_{\\mathrm{min}} = \\mathrm{True}$，否则为 $b_{\\mathrm{min}} = \\mathrm{False}$。\n\n- 如果 $N_{\\mathrm{imag}} > 0$，识别最负的本征值 $\\lambda_{\\min}$ 及其本征向量 $\\mathbf{v}_{\\min}$，并计算吸附物局域化度量 $L_{\\mathrm{ads}} = \\dfrac{\\sum_{\\alpha \\in \\mathcal{A}} v_{\\min,\\alpha}^2}{\\sum_{\\alpha} v_{\\min,\\alpha}^2}$，其中 $\\mathcal{A}$ 是属于吸附物的坐标索引集合。如果 $N_{\\mathrm{imag}} = 0$，则定义 $L_{\\mathrm{ads}} = 0$。\n\n此问题中的所有数学实体都必须如上所述以 LaTeX 格式处理，并且逻辑必须精确地表达，不使用超出所列基本原理的简化公式。结果纯粹是计算性的，不需要报告物理单位，因为只使用曲率的符号（本征值）和一个无量纲的局域化度量。角度不适用，且不得使用百分比；$L_{\\mathrm{ads}}$ 是一个介于 $0$ 和 $1$ 之间的小数。\n\n在以下测试套件上实现并测试您的解决方案。每个测试用例指定 $(\\mathbf{K}, \\mathbf{m}, \\mathcal{A}, \\varepsilon)$:\n\n- 测试用例 1（理想路径最小值）：一个具有正定曲率的稳定吸附几何构型。使用\n$$\n\\mathbf{K}_1 = \\begin{bmatrix}\n8.0  0.2  0.0 \\\\\n0.2  12.0  0.1 \\\\\n0.0  0.1  15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_1 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_1 = \\{0\\}, \\quad\n\\varepsilon_1 = 1\\times 10^{-6}.\n$$\n\n- 测试用例 2（沿吸附物坐标的一阶鞍点）：一个由吸附物简正模主导的不稳定方向。使用\n$$\n\\mathbf{K}_2 = \\begin{bmatrix}\n-1.0  0.1  0.0 \\\\\n0.1  12.0  0.1 \\\\\n0.0  0.1  15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_2 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_2 = \\{0\\}, \\quad\n\\varepsilon_2 = 1\\times 10^{-6}.\n$$\n\n- 测试用例 3（局域在表面上的一阶鞍点）：一个由表面原子模式主导的不稳定方向。使用\n$$\n\\mathbf{K}_3 = \\begin{bmatrix}\n8.0  0.1  0.0 \\\\\n0.1  12.0  0.1 \\\\\n0.0  0.1  -0.5\n\\end{bmatrix}, \\quad\n\\mathbf{m}_3 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_3 = \\{0\\}, \\quad\n\\varepsilon_3 = 1\\times 10^{-6}.\n$$\n\n- 测试用例 4（接近零的数值噪声）：表观上的微小负曲率，远在数值容差范围内，应被视为零。使用\n$$\n\\mathbf{K}_4 = \\begin{bmatrix}\n8.0  0.0  0.0 \\\\\n0.0  -1\\times 10^{-8}  0.0 \\\\\n0.0  0.0  15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_4 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_4 = \\{0\\}, \\quad\n\\varepsilon_4 = 1\\times 10^{-6}.\n$$\n\n您的程序必须根据上述算法评估每个测试用例，并生成最终输出，输出为单行包含一个逗号分隔的列表，其中每个元素是每个测试用例的结果，每个测试用例的结果形式为 $[b_{\\mathrm{min}}, N_{\\mathrm{imag}}, L_{\\mathrm{ads}}]$。输出格式必须是无空格的单行，例如：\n$$\n\\text{[[True,0,0.000],[False,1,0.985],[False,1,0.013],[True,0,0.000]]}\n$$\n$L_{\\mathrm{ads}}$ 的数值必须四舍五入到三位小数。布尔值必须显示为 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "问题陈述经过仔细审查，并被确定为有效。它在科学上是合理的、适定的和客观的，提出了计算化学中一个关于势能面上稳定点振动分析的标准问题。所提供的数据和算法要求是完整和一致的。\n\n该分析的理论基础在于将经典力学应用于 Born-Oppenheimer 近似下的分子振动。根据这一近似，电子运动和原子核运动可以解耦，从而可以定义一个仅是原子核坐标 $\\mathbf{R}$ 的函数的势能面 (PES)，记为 $V(\\mathbf{R})$。\n\n势能面上的稳定点 $\\mathbf{R}_0$ 是主要关注对象，因为它们代表平衡几何构型（最小值点）或过渡态（鞍点）。在这些点上，每个原子核上的净力为零，这在数学上表示为势能梯度的消失：\n$$\n\\nabla V(\\mathbf{R}_0) = \\mathbf{0}\n$$\n要确定一个稳定点的性质（即，它是最小值点、最大值点还是鞍点），必须检查其附近势能面的曲率。这是通过在稳定点 $\\mathbf{R}_0$ 周围对势能 $V(\\mathbf{R})$ 进行二阶泰勒展开来完成的。对于一个小位移 $\\Delta \\mathbf{R} = \\mathbf{R} - \\mathbf{R}_0$，势能近似为：\n$$\nV(\\mathbf{R}) \\approx V(\\mathbf{R}_0) + \\nabla V(\\mathbf{R}_0)^{\\top} \\Delta \\mathbf{R} + \\frac{1}{2} \\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}\n$$\n由于 $\\nabla V(\\mathbf{R}_0) = \\mathbf{0}$，这简化为：\n$$\nV(\\mathbf{R}) - V(\\mathbf{R}_0) \\approx \\frac{1}{2} \\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}\n$$\n这里，$\\mathbf{K}$ 是 Hessian 矩阵，一个由势能对原子核坐标的二阶偏导数组成的对称矩阵，在稳定点 $\\mathbf{R}_0$ 处求值：\n$$\nK_{\\alpha\\beta} = \\left. \\frac{\\partial^2 V}{\\partial R_{\\alpha} \\partial R_{\\beta}} \\right|_{\\mathbf{R}_0}\n$$\n围绕 $\\mathbf{R}_0$ 的小振动的经典运动方程源于拉格朗日量 $\\mathcal{L} = T - V$。动能 $T$ 由 $T = \\frac{1}{2} \\dot{\\mathbf{R}}^{\\top} \\mathbf{M} \\dot{\\mathbf{R}}$ 给出，其中 $\\mathbf{M}$ 是与 $\\mathbf{R}$ 中坐标相对应的原子质量的对角矩阵。最终以位移坐标 $\\Delta \\mathbf{R}$ 表示的运动方程是：\n$$\n\\mathbf{M} \\ddot{\\Delta \\mathbf{R}} = -\\mathbf{K} \\Delta \\mathbf{R}\n$$\n这是一个耦合的二阶微分方程组。为了解耦它们，我们通过假设形式为 $\\Delta \\mathbf{R}(t) = \\mathbf{A} e^{i\\omega t}$ 的谐波解来寻找简正振动模式。将此代入运动方程，得到一个广义本征值问题：\n$$\n\\mathbf{K} \\mathbf{A} = \\omega^2 \\mathbf{M} \\mathbf{A}\n$$\n为了将其转换为标准本征值问题，我们引入质量加权坐标 $\\mathbf{q} = \\mathbf{M}^{1/2} \\Delta \\mathbf{R}$。相应的变换是 $\\Delta \\mathbf{R} = \\mathbf{M}^{-1/2} \\mathbf{q}$。将此代入运动方程，并前乘以 $\\mathbf{M}^{-1/2}$，得到：\n$$\n\\mathbf{M}^{-1/2} \\mathbf{M} (\\mathbf{M}^{-1/2} \\ddot{\\mathbf{q}}) = -\\mathbf{M}^{-1/2} \\mathbf{K} (\\mathbf{M}^{-1/2} \\mathbf{q})\n$$\n$$\n\\ddot{\\mathbf{q}} = -(\\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}) \\mathbf{q}\n$$\n我们定义质量加权 Hessian 矩阵 $\\mathbf{F} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$。运动方程变为 $\\ddot{\\mathbf{q}} = -\\mathbf{F} \\mathbf{q}$。通过标准本征值问题 $\\mathbf{F} \\mathbf{v}_i = \\lambda_i \\mathbf{v}_i$ 求解此方程，得到本征值 $\\lambda_i = \\omega_i^2$（与振动频率的平方成正比）和本征向量 $\\mathbf{v}_i$（质量加权坐标系下的简正模）。\n\n本征值 $\\lambda_i$ 的符号可用于分类稳定点：\n- 如果所有 $\\lambda_i \\geq 0$（在排除了对应于刚体平移和旋转的零频率模式后，这些在本简化问题中不是一个因素），则该稳定点是势能面上的一个真正的局域最小值点。每个振动模式都对应一个实频率 $\\omega_i = \\sqrt{\\lambda_i}$。\n- 如果一个或多个本征值 $\\lambda_i$ 为负，则该稳定点是鞍点。一个负本征值 $\\lambda_i  0$ 对应一个虚频 $\\omega_i = i\\sqrt{|\\lambda_i|}$，表示一个能量沿其下降的不稳定模式。负本征值的数量 $N_{\\mathrm{imag}}$ 定义了鞍点的阶数。一阶鞍点是过渡态的常见表示，它恰好有一个负本征值。\n\n待实现的算法直接遵循此推导过程。\n\n1.  对于每个测试用例，我们给定笛卡尔 Hessian 矩阵 $\\mathbf{K}$、与每个坐标对应的质量列表 $\\mathbf{m}$、吸附物坐标索引集 $\\mathcal{A}$ 和一个数值阈值 $\\varepsilon$。\n2.  构建对角质量加权向量 $d$，其元素为 $d_\\alpha = 1/\\sqrt{m_\\alpha}$。\n3.  计算对称的质量加权 Hessian 矩阵 $\\mathbf{F}$，其表达式为 $\\mathbf{F} = \\mathrm{diag}(d) \\, \\mathbf{K} \\, \\mathrm{diag}(d)$。\n4.  求解 $\\mathbf{F}$ 的标准本征问题，以获得其本征值 $\\lambda_i$ 和相应的标准正交本征向量 $\\mathbf{v}_i$。\n5.  通过识别有多少本征值低于数值容差的负值来计算虚模的数量 $N_{\\mathrm{imag}}$：$N_{\\mathrm{imag}} = \\text{count of } \\{\\lambda_i | \\lambda_i  -\\varepsilon\\}$。\n6.  当且仅当没有此类虚模时，几何构型被分类为最小值点。因此，布尔分类为 $b_{\\mathrm{min}} = (N_{\\mathrm{imag}} = 0)$。\n7.  如果 $N_{\\mathrm{imag}} > 0$，我们识别与最负本征值 $\\lambda_{\\min}$ 相关联的不稳定模式及其本征向量 $\\mathbf{v}_{\\min}$。计算吸附物局域化度量 $L_{\\mathrm{ads}}$，以量化该不稳定模式涉及吸附物坐标运动的程度。鉴于本征向量 $\\mathbf{v}_i$ 是归一化的，使得 $\\sum_{\\alpha} v_{i,\\alpha}^2 = 1$，该度量简化为对吸附物索引的求和：$L_{\\mathrm{ads}} = \\sum_{\\alpha \\in \\mathcal{A}} v_{\\min,\\alpha}^2$。\n8.  如果 $N_{\\mathrm{imag}} = 0$，则结构是最小值点，没有不稳定模式可供分析。在这种情况下，定义 $L_{\\mathrm{ads}}$ 为 $0$。\n\n此过程将应用于每个测试用例，以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vibrational analysis problem for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"K\": np.array([\n                [8.0, 0.2, 0.0],\n                [0.2, 12.0, 0.1],\n                [0.0, 0.1, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [-1.0, 0.1, 0.0],\n                [0.1, 12.0, 0.1],\n                [0.0, 0.1, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [8.0, 0.1, 0.0],\n                [0.1, 12.0, 0.1],\n                [0.0, 0.1, -0.5]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [8.0, 0.0, 0.0],\n                [0.0, -1e-8, 0.0],\n                [0.0, 0.0, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        K = case[\"K\"]\n        m = case[\"m\"]\n        A_indices = case[\"A\"]\n        epsilon = case[\"eps\"]\n\n        # 1. Construct the diagonal mass-weighting vector d_alpha = 1/sqrt(m_alpha).\n        d = 1.0 / np.sqrt(m)\n\n        # 2. Compute the mass-weighted Hessian F = diag(d) * K * diag(d).\n        # This can be done efficiently using broadcasting.\n        F = np.outer(d, d) * K\n\n        # 3. Compute all eigenvalues and orthonormal eigenvectors of F.\n        # np.linalg.eigh is used for symmetric matrices and returns eigenvalues\n        # in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(F)\n\n        # 4. Count the number of imaginary modes N_imag.\n        imaginary_modes_mask = eigenvalues  -epsilon\n        N_imag = np.sum(imaginary_modes_mask)\n\n        # 5. Determine the boolean classification b_min.\n        b_min = (N_imag == 0)\n\n        # 6. Compute adsorbate localization metric L_ads.\n        if N_imag > 0:\n            # Eigenvalues are sorted, so the most negative is the first one.\n            # The corresponding eigenvector is the first column of the eigenvector matrix.\n            v_min = eigenvectors[:, 0]\n            \n            # The denominator sum of squares is 1 for normalized eigenvectors.\n            # We only need to sum the squared components for the adsorbate indices.\n            ads_squared_components = [v_min[i]**2 for i in A_indices]\n            L_ads = np.sum(ads_squared_components)\n        else:\n            # If N_imag is 0, L_ads is defined as 0.\n            L_ads = 0.0\n\n        # Round L_ads to three decimal places.\n        L_ads_rounded = round(L_ads, 3)\n\n        results.append([b_min, N_imag, L_ads_rounded])\n\n    # Final print statement in the exact required format.\n    str_results = [f\"[{b},{n},{l:.3f}]\" for b, n, l in results]\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "吸附现象很少是孤立事件，吸附物之间的相互作用会显著改变结合能。此练习  超越了单分子极限，旨在探索依赖于覆盖度的吸附能量学。您将学习如何对不同尺寸超胞的总能量进行归一化，以计算可比较的指标，如每分子吸附能和每位点吸附能，这对于理解侧向相互作用和构建表面相图至关重要。",
            "id": "3867652",
            "problem": "在基于密度泛函理论（DFT）的第一性原理计算中，使用周期性板层模型来模拟催化表面。考虑一氧化碳在金属表面上的吸附，该表面每个 $(1 \\times 1)$ 表面原胞有一个吸附位点。单层（ML）定义为每个吸附位点上有一个分子。对于每个超胞，给定洁净板层的总能量、吸附体系的总能量以及气相一氧化碳分子的总能量，这些能量均在相同的数值设置下计算，以确保参考基准的一致性。\n\n数据：\n- 洁净板层总能量：$(1 \\times 1)$: $E_{\\mathrm{slab}}^{1 \\times 1} = -125.000\\,\\mathrm{eV}$；$(2 \\times 2)$: $E_{\\mathrm{slab}}^{2 \\times 2} = -500.100\\,\\mathrm{eV}$；$(3 \\times 3)$: $E_{\\mathrm{slab}}^{3 \\times 3} = -1125.300\\,\\mathrm{eV}$。\n- 气相一氧化碳总能量：$E_{\\mathrm{CO(g)}} = -14.000\\,\\mathrm{eV}$。\n- 吸附体系：\n  - 具有 $N=1$ 个一氧化碳的 $(1 \\times 1)$ 超胞：$E_{\\mathrm{tot}}^{1 \\times 1 + 1\\ \\mathrm{CO}} = -141.500\\,\\mathrm{eV}$。\n  - 具有 $N=1$ 个一氧化碳的 $(2 \\times 2)$ 超胞：$E_{\\mathrm{tot}}^{2 \\times 2 + 1\\ \\mathrm{CO}} = -516.900\\,\\mathrm{eV}$。\n  - 具有 $N=2$ 个一氧化碳的 $(3 \\times 3)$ 超胞：$E_{\\mathrm{tot}}^{3 \\times 3 + 2\\ \\mathrm{CO}} = -1158.700\\,\\mathrm{eV}$。\n\n假设将 $N$ 个分子从一个大的气相分子库添加到表面上，总能量的变化量即为吸附能，并且负的吸附能表示放热结合。每个超胞的表面有 $N_{\\mathrm{sites}}$ 个吸附位点，其数量等于超胞中包含的 $(1 \\times 1)$ 单元的数量（例如，对于一个 $(2 \\times 2)$ 超胞，$N_{\\mathrm{sites}}=4$）。覆盖度定义为 $\\theta = N/N_{\\mathrm{sites}}$。\n\n任务：\n1. 仅使用吸附能的定义，即从气相分子库转移 $N$ 个分子到板层上引起的总能量变化，计算上述三种吸附体系在各自覆盖度下每个分子的吸附能。\n2. 通过将总吸附能对 $N_{\\mathrm{sites}}$ 进行归一化，计算每种情况下每个表面位点的吸附能。\n3. 从能量归一化的角度简要解释，如何比较不同超胞和覆盖度下的吸附能量特性，以及为什么使用每个分子和每个位点的量是合适的。\n4. 报告对应于具有 $N=1$ 个一氧化碳的 $(2 \\times 2)$ 超胞（覆盖度 $\\theta = 1/4\\,\\mathrm{ML}$）的每个表面位点的吸附能。以电子伏特（eV）为单位表示最终能量，并将您的答案四舍五入到四位有效数字。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 第1步：提取已知条件\n- **模型**：密度泛函理论（DFT）中的周期性板层模型。\n- **表面**：金属表面，每个 $(1 \\times 1)$ 原胞有一个吸附位点。\n- **单层（ML）定义**：$\\theta=1$，对应每个吸附位点一个分子。\n- **能量数据**：\n  - 洁净板层总能量：\n    - $E_{\\mathrm{slab}}^{1 \\times 1} = -125.000\\,\\mathrm{eV}$\n    - $E_{\\mathrm{slab}}^{2 \\times 2} = -500.100\\,\\mathrm{eV}$\n    - $E_{\\mathrm{slab}}^{3 \\times 3} = -1125.300\\,\\mathrm{eV}$\n  - 气相一氧化碳总能量：$E_{\\mathrm{CO(g)}} = -14.000\\,\\mathrm{eV}$。\n  - 吸附体系总能量：\n    - $E_{\\mathrm{tot}}^{1 \\times 1 + 1\\ \\mathrm{CO}} = -141.500\\,\\mathrm{eV}$，对于具有 $N=1$ 个CO的 $(1 \\times 1)$ 超胞。\n    - $E_{\\mathrm{tot}}^{2 \\times 2 + 1\\ \\mathrm{CO}} = -516.900\\,\\mathrm{eV}$，对于具有 $N=1$ 个CO的 $(2 \\times 2)$ 超胞。\n    - $E_{\\mathrm{tot}}^{3 \\times 3 + 2\\ \\mathrm{CO}} = -1158.700\\,\\mathrm{eV}$，对于具有 $N=2$ 个CO的 $(3 \\times 3)$ 超胞。\n- **定义**：\n  - 吸附能：将 $N$ 个分子从气相转移到板层上时总能量的变化。负值表示放热结合。\n  - 位点数 ($N_{\\mathrm{sites}}$)：对于一个 $(m \\times m)$ 超胞，$N_{\\mathrm{sites}} = m^2$。\n  - 覆盖度 ($\\theta$)：$\\theta = N/N_{\\mathrm{sites}}$。\n- **任务**：\n  1. 计算三种情况下每个分子的吸附能。\n  2. 计算每种情况下每个表面位点的吸附能。\n  3. 解释每个分子和每个位点归一化的目的。\n  4. 报告具有 $N=1$ 个CO的 $(2 \\times 2)$ 超胞情况下每个位点的吸附能，四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它描述了计算表面科学和催化领域中一个标准且基础的计算。所提供的数据对于DFT计算是完整的、一致的且物理上合理的。定义清晰，是该领域的标准定义。任务明确，可以得出一个唯一的、可验证的解。$(m \\times m)$ 板层的能量 $E_{\\mathrm{slab}}^{m \\times m}$ 与 $m^2$ 近似成正比，这与二维周期性系统的预期相符（例如，$E_{\\mathrm{slab}}^{2 \\times 2} = -500.100\\,\\mathrm{eV} \\approx 4 \\times E_{\\mathrm{slab}}^{1 \\times 1} = 4 \\times (-125.000\\,\\mathrm{eV}) = -500.000\\,\\mathrm{eV}$）。这种内部一致性证实了所提供数据的有效性。因此，该问题被认为是有效的。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n吸附能 $E_{\\mathrm{ads}}$ 定义为当 $N$ 个分子从气相分子库转移到洁净表面板层上时总能量的变化。对于超胞中含有 $N$ 个吸附分子的体系，其总吸附能 $E_{\\mathrm{ads,tot}}$ 由以下公式给出：\n$$E_{\\mathrm{ads,tot}} = E_{\\mathrm{tot,ads\\_system}} - (E_{\\mathrm{slab}} + N \\cdot E_{\\mathrm{gas\\_molecule}})$$\n其中，$E_{\\mathrm{tot,ads\\_system}}$ 是带有吸附物的板层的总能量，$E_{\\mathrm{slab}}$ 是洁净板层的总能量，$E_{\\mathrm{gas\\_molecule}}$ 是气相中一个分子的总能量。\n\n**1. 每个分子的吸附能 ($E_{\\mathrm{ads/mol}}$)**\n\n每个分子的吸附能是总吸附能除以吸附分子的数量 $N$ 进行归一化：\n$$E_{\\mathrm{ads/mol}} = \\frac{E_{\\mathrm{ads,tot}}}{N} = \\frac{E_{\\mathrm{tot,ads\\_system}} - E_{\\mathrm{slab}} - N \\cdot E_{\\mathrm{CO(g)}}}{N}$$\n\n我们将此公式应用于所提供的三种情况。\n\n- **情况1：具有 $N=1$ 个CO的 $(1 \\times 1)$ 超胞**\n  位点数为 $N_{\\mathrm{sites}} = 1^2 = 1$。覆盖度为 $\\theta = N/N_{\\mathrm{sites}} = 1/1 = 1\\,\\mathrm{ML}$。\n  $$E_{\\mathrm{ads/mol}}^{(1 \\times 1)} = \\frac{E_{\\mathrm{tot}}^{1 \\times 1 + 1\\ \\mathrm{CO}} - E_{\\mathrm{slab}}^{1 \\times 1} - 1 \\cdot E_{\\mathrm{CO(g)}}}{1} = \\frac{-141.500\\,\\mathrm{eV} - (-125.000\\,\\mathrm{eV}) - (-14.000\\,\\mathrm{eV})}{1} = -2.500\\,\\mathrm{eV}$$\n\n- **情况2：具有 $N=1$ 个CO的 $(2 \\times 2)$ 超胞**\n  位点数为 $N_{\\mathrm{sites}} = 2^2 = 4$。覆盖度为 $\\theta = N/N_{\\mathrm{sites}} = 1/4 = 0.25\\,\\mathrm{ML}$。\n  $$E_{\\mathrm{ads/mol}}^{(2 \\times 2)} = \\frac{E_{\\mathrm{tot}}^{2 \\times 2 + 1\\ \\mathrm{CO}} - E_{\\mathrm{slab}}^{2 \\times 2} - 1 \\cdot E_{\\mathrm{CO(g)}}}{1} = \\frac{-516.900\\,\\mathrm{eV} - (-500.100\\,\\mathrm{eV}) - (-14.000\\,\\mathrm{eV})}{1} = -2.800\\,\\mathrm{eV}$$\n\n- **情况3：具有 $N=2$ 个CO的 $(3 \\times 3)$ 超胞**\n  位点数为 $N_{\\mathrm{sites}} = 3^2 = 9$。覆盖度为 $\\theta = N/N_{\\mathrm{sites}} = 2/9 \\approx 0.22\\,\\mathrm{ML}$。\n  $$E_{\\mathrm{ads/mol}}^{(3 \\times 3)} = \\frac{E_{\\mathrm{tot}}^{3 \\times 3 + 2\\ \\mathrm{CO}} - E_{\\mathrm{slab}}^{3 \\times 3} - 2 \\cdot E_{\\mathrm{CO(g)}}}{2} = \\frac{-1158.700\\,\\mathrm{eV} - (-1125.300\\,\\mathrm{eV}) - 2 \\cdot (-14.000\\,\\mathrm{eV})}{2} = \\frac{-33.400\\,\\mathrm{eV} + 28.000\\,\\mathrm{eV}}{2} = \\frac{-5.400\\,\\mathrm{eV}}{2} = -2.700\\,\\mathrm{eV}$$\n\n**2. 每个表面位点的吸附能 ($E_{\\mathrm{ads/site}}$)**\n\n每个表面位点的吸附能是总吸附能除以超胞中可用吸附位点的数量 $N_{\\mathrm{sites}}$ 进行归一化：\n$$E_{\\mathrm{ads/site}} = \\frac{E_{\\mathrm{ads,tot}}}{N_{\\mathrm{sites}}} = \\frac{E_{\\mathrm{tot,ads\\_system}} - E_{\\mathrm{slab}} - N \\cdot E_{\\mathrm{CO(g)}}}{N_{\\mathrm{sites}}}$$\n这也可以通过每个分子的能量和覆盖度来计算：$E_{\\mathrm{ads/site}} = \\theta \\cdot E_{\\mathrm{ads/mol}}$。\n\n- **情况1：具有 $N=1$ 个CO的 $(1 \\times 1)$ 超胞**\n  $$E_{\\mathrm{ads/site}}^{(1 \\times 1)} = \\frac{E_{\\mathrm{ads,tot}}^{(1 \\times 1)}}{N_{\\mathrm{sites}}} = \\frac{-2.500\\,\\mathrm{eV}}{1} = -2.500\\,\\mathrm{eV/site}$$\n\n- **情况2：具有 $N=1$ 个CO的 $(2 \\times 2)$ 超胞**\n  $$E_{\\mathrm{ads/site}}^{(2 \\times 2)} = \\frac{E_{\\mathrm{ads,tot}}^{(2 \\times 2)}}{N_{\\mathrm{sites}}} = \\frac{-2.800\\,\\mathrm{eV}}{4} = -0.700\\,\\mathrm{eV/site}$$\n\n- **情况3：具有 $N=2$ 个CO的 $(3 \\times 3)$ 超胞**\n  总吸附能为 $E_{\\mathrm{ads,tot}}^{(3 \\times 3)} = 2 \\cdot E_{\\mathrm{ads/mol}}^{(3 \\times 3)} = 2 \\cdot (-2.700\\,\\mathrm{eV}) = -5.400\\,\\mathrm{eV}$。\n  $$E_{\\mathrm{ads/site}}^{(3 \\times 3)} = \\frac{E_{\\mathrm{ads,tot}}^{(3 \\times 3)}}{N_{\\mathrm{sites}}} = \\frac{-5.400\\,\\mathrm{eV}}{9} = -0.600\\,\\mathrm{eV/site}$$\n\n**3. 能量归一化的解释**\n\n在计算表面科学中，模拟是在不同尺寸的超胞和不同数量的吸附物上进行的。总能量是广延量，取决于系统的大小，因此不能直接比较。归一化对于导出强度量至关重要，这些强度量使得在不同计算之间进行有意义的比较成为可能。\n\n- **每个分子的吸附能 ($E_{\\mathrm{ads/mol}}$)**：这个量通过吸附物的数量 $N$ 来归一化总吸附能。它代表在特定覆盖度下单个吸附物分子的平均结合能。比较不同覆盖度下的 $E_{\\mathrm{ads/mol}}$ 可以揭示吸附物-吸附物相互作用的强度。在本问题中，吸附在最低覆盖度（$\\theta=0.25\\,\\mathrm{ML}$）时最强（$-2.800\\,\\mathrm{eV}$），这表明排斥性相互作用可能在较高覆盖度下削弱了结合（例如，在 $\\theta=1.0\\,\\mathrm{ML}$ 时，结合强度仅为 $-2.500\\,\\mathrm{eV}$）。\n\n- **每个表面位点的吸附能 ($E_{\\mathrm{ads/site}}$)**：这个量通过表面位点的数量 $N_{\\mathrm{sites}}$（可视为表面积的代表）来归一化总吸附能。它代表由于吸附引起的单位面积表面能的变化。在从头计算原子热力学（ab initio atomistic thermodynamics）的框架内，该度量对于构建表面相图至关重要。它允许在给定的外部条件（温度和压力）下直接比较不同表面覆盖度和构型的热力学稳定性，因为最稳定的表面是使总表面自由能最小化的表面。\n\n**4. 最终答案计算**\n\n任务是报告具有 $N=1$ 个一氧化碳的 $(2 \\times 2)$ 超胞的每个表面位点的吸附能。这对应于第2部分中为情况2计算的值。\n$$E_{\\mathrm{ads/site}}^{(2 \\times 2)} = -0.700\\,\\mathrm{eV/site}$$\n问题要求答案四舍五入到四位有效数字。计算值为 $-0.700$。为了用四位有效数字表示，我们将其写为 $-0.7000$。",
            "answer": "$$\n\\boxed{-0.7000}\n$$"
        }
    ]
}