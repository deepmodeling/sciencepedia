{
    "hands_on_practices": [
        {
            "introduction": "本节我们将从最基础的计算入手：如何从第一性原理计算得到的总能量中求出吸附能。这个练习将巩固吸附能在零温下的热力学定义，并让您熟悉判断结构弛豫是否收敛的关键标准，这是任何表面科学计算的基石。",
            "id": "3867641",
            "problem": "为了研究一个闭壳层分子在金属 $(111)$ 表面上的吸附，我们采用密度泛函理论 (DFT) 中的广义梯度近似 (GGA) 和投影缀加波 (PAW) 方法进行了一次周期性平板计算。所有的总能量都是在相同的设置下计算的（相同的晶格矢量、平面波截断能、$k$ 点网格和真空层厚度）。结构被充分弛豫，直到任何未受约束原子上的最大残余力低于预设阈值。弛豫后获得以下总能量：\n- 洁净平板的总能量：$E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$。\n- 孤立吸附物（在相同的超胞和真空中）的总能量：$E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$。\n- 吸附物在平板上的总能量：$E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$。\n\n假设吸附过程定义为将弛豫后的孤立吸附物从无穷远处移动到已弛豫平板的确定位点上进行结合，期间计算设置或化学计量比均无变化。基于反应能作为 Born–Oppenheimer 势能面上产物和反应物之间内能变化的基础热力学定义，请仅使用所提供的数据计算吸附能 $E_{\\mathrm{ads}}$。\n\n在产生 $E_{\\mathrm{slab+ads}}$ 的结构弛豫中，残余力最大的三个未受约束原子上，最终的力的大小分别为 $0.012\\,\\mathrm{eV}/\\AA$、$0.019\\,\\mathrm{eV}/\\AA$ 和 $0.017\\,\\mathrm{eV}/\\AA$。简要描述弛豫后最大力判据的力学意义，并判断在阈值为 $0.020\\,\\mathrm{eV}/\\AA$ 的情况下，这些值是否表明计算已经收敛。\n\n吸附能以电子伏特表示。将最终数值答案四舍五入至三位有效数字。",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **计算类型**：密度泛函理论 (DFT) 中的广义梯度近似 (GGA) 和投影缀加波 (PAW) 方法。\n- **体系**：一个闭壳层分子吸附在金属 $(111)$ 表面上，使用周期性平板进行建模。\n- **计算一致性**：所有计算（平板、孤立吸附物、组合体系）均在相同的晶格矢量、平面波截断能、$k$ 点网格和真空层厚度下进行。\n- **结构状态**：所有结构均已充分弛豫。\n- **总能量**：\n  - 洁净平板的总能量：$E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$。\n  - 孤立吸附物的总能量（在相同的超胞中）：$E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$。\n  - 吸附物在平板上的总能量：$E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$。\n- **用于收敛性检查的力数据**：\n  - 未受约束原子上三个最大残余力的大小：$0.012\\,\\mathrm{eV}/\\AA$、$0.019\\,\\mathrm{eV}/\\AA$ 和 $0.017\\,\\mathrm{eV}/\\AA$。\n  - 力收敛阈值：$0.020\\,\\mathrm{eV}/\\AA$。\n- **任务**：\n  1. 计算吸附能 $E_{\\mathrm{ads}}$，以电子伏特为单位，并四舍五入至三位有效数字。\n  2. 简要描述弛豫后最大力判据的力学意义，并根据所提供的数据评估收敛性。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题在计算材料科学和量子化学的原理上有充分的依据。使用DFT、GGA和PAW方法是研究吸附等表面现象的标准方法。从各组成部分的总能量计算吸附能的概念是该领域的基石。所有数值和术语都是标准的、科学正确的。\n- **适定性**：该问题是适定的。它提供了计算吸附能所需的所有数值数据（$E_{\\mathrm{slab}}$、$E_{\\mathrm{ads}}^{\\mathrm{iso}}$、$E_{\\mathrm{slab+ads}}$）。吸附过程的定义清晰，并符合该领域的标准惯例。关于力收敛的第二部分问题也是自洽的。存在唯一解。\n- **客观性**：该问题是客观的，使用了计算化学中常见的精确技术语言。没有主观或模棱两可的陈述。\n\n该问题没有表现出任何诸如科学上不合理、不完整、矛盾或不可行性等缺陷。这是其领域内一个标准的基础问题。\n\n### 步骤3：结论与行动\n该问题是 **有效的**。将制定解决方案。\n\n解决方案按要求包括两部分：吸附能的计算和力收敛判据的解释。\n\n**第1部分：吸附能的计算**\n\n吸附能 $E_{\\mathrm{ads}}$ 表示吸附物分子与表面结合时的能量变化。吸附过程可以写成一个反应：\n$$\n\\text{平板} + \\text{吸附物} \\rightarrow \\text{平板-吸附物体系}\n$$\n在零开尔文下的 DFT 计算中，此过程的能量变化计算为最终态（产物）的总能量减去初始态（反应物）的总能量之和。反应物是孤立、弛豫的洁净平板和孤立、弛豫的吸附物分子。产物是吸附物与平板结合的组合体系，也处于其弛豫状态。\n\n因此，吸附能的计算公式为：\n$$\nE_{\\mathrm{ads}} = E_{\\mathrm{slab+ads}} - (E_{\\mathrm{slab}} + E_{\\mathrm{ads}}^{\\mathrm{iso}})\n$$\n其中：\n- $E_{\\mathrm{slab+ads}}$ 是吸附物在其表面上的弛豫平板的总能量。\n- $E_{\\mathrm{slab}}$ 是弛豫的洁净平板的总能量。\n- $E_{\\mathrm{ads}}^{\\mathrm{iso}}$ 是弛豫的孤立吸附物分子的总能量，在相同的超胞中计算以确保能量参考的一致性和抵消基组重叠误差 (BSSE)，尽管 GGA 对 BSSE 的敏感性低于其他一些方法。\n\n使用给定值：\n$E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$\n$E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$\n$E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$\n\n首先，我们计算反应物的总能量：\n$$\nE_{\\mathrm{reactants}} = E_{\\mathrm{slab}} + E_{\\mathrm{ads}}^{\\mathrm{iso}} = -256.873\\,\\mathrm{eV} + (-14.209\\,\\mathrm{eV}) = -271.082\\,\\mathrm{eV}\n$$\n现在，我们可以计算吸附能：\n$$\nE_{\\mathrm{ads}} = E_{\\mathrm{slab+ads}} - E_{\\mathrm{reactants}} = -271.427\\,\\mathrm{eV} - (-271.082\\,\\mathrm{eV})\n$$\n$$\nE_{\\mathrm{ads}} = -271.427\\,\\mathrm{eV} + 271.082\\,\\mathrm{eV} = -0.345\\,\\mathrm{eV}\n$$\n吸附能的负号表示该过程是放热的，意味着吸附时释放能量，且结合态比分离的组分更稳定。这是自发吸附发生的必要条件。\n\n问题要求答案四舍五入至三位有效数字。计算出的值 $-0.345\\,\\mathrm{eV}$ 已经有三位有效数字（数字 $3$、$4$ 和 $5$）。\n\n**第2部分：力判据的意义和收敛性评估**\n\n量子力学计算中的结构弛豫旨在找到 Born-Oppenheimer 势能面 (PES) 上的一个局域最小值。PES 描述了体系的总能量作为其原子核位置的函数。一个稳定的平衡几何构型对应于能量处于局域最小值的点。\n\n从力学上讲，平衡的一个条件是每个原子上的净力为零。在 PES 的背景下，原子 $i$ 上的力 $\\vec{F}_i$ 是总能量 $E$ 相对于该原子坐标 $\\vec{r}_i$ 的负梯度：\n$$\n\\vec{F}_i = -\\nabla_{\\vec{r}_i} E\n$$\n因此，在 PES 的一个局域最小值（或任何驻点）上，所有原子上的力都为零。\n\n在数值计算中，实际上不可能找到一个所有力都精确为零的几何构型。取而代之的是，当所有未受约束原子上的力都小于一个预定义的、很小的正值（即力收敛阈值）时，就认为弛豫已经“收敛”。“最大力判据”规定，体系中所有未受约束原子中最大力矢量的大小必须小于此阈值。这确保了体系非常接近 PES 上的一个驻点，并且任何进一步的结构变化只会导致总能量发生可忽略不计的变化。\n\n对于给定的问题：\n- 力收敛阈值设定为 $0.020\\,\\mathrm{eV}/\\AA$。\n- 报告的三个最大残余力的大小分别为 $0.012\\,\\mathrm{eV}/\\AA$、$0.019\\,\\mathrm{eV}/\\AA$ 和 $0.017\\,\\mathrm{eV}/\\AA$。\n- 这些力中的最大值为 $\\max(0.012, 0.019, 0.017) = 0.019\\,\\mathrm{eV}/\\AA$。\n\n为了评估收敛性，我们将观察到的最大力与阈值进行比较：\n$$\n0.019\\,\\mathrm{eV}/\\AA < 0.020\\,\\mathrm{eV}/\\AA\n$$\n由于体系中的最大残余力小于指定的收敛阈值，因此根据给定的判据，结构弛豫被认为是成功收敛的。",
            "answer": "$$\n\\boxed{-0.345}\n$$"
        },
        {
            "introduction": "成功的几何优化会找到一个原子受力为零的驻点，但这个点是稳定的能量极小点还是不稳定的过渡态？本练习将深入探讨计算后至关重要的验证步骤：振动频率分析。您将学习如何利用Hessian矩阵的本征值来确认您计算得到的结构是否代表了势能面上的一个真实能量极小点。",
            "id": "3867632",
            "problem": "给定一个简化的振动分析任务，该任务源于计算催化和化学工程中吸附几何构型的验证。目标是通过振动分析和本征模检测，确定一个已报道的吸附几何构型对应于势能面 (PES) 上的真极小值点还是鞍点。推导和算法的基本依据应从玻恩-奥本海默近似、势能围绕驻点的二阶泰勒展开，以及用于简正模分析的Hessian矩阵和质量加权的定义开始。\n\n从以下基本原理出发：\n\n1. 在玻恩-奥本海默近似下，势能面 $V(\\mathbf{R})$ 取决于原子核坐标 $\\mathbf{R}$，驻点 $\\mathbf{R}_0$ 满足 $\\nabla V(\\mathbf{R}_0) = \\mathbf{0}$。\n\n2. 势能围绕 $\\mathbf{R}_0$ 的二阶泰勒展开为 $V(\\mathbf{R}_0 + \\Delta \\mathbf{R}) \\approx V(\\mathbf{R}_0) + \\tfrac{1}{2}\\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}$，其中 $\\mathbf{K}$ 是二阶导数的Hessian矩阵，其分量为 $K_{\\alpha\\beta} = \\left. \\dfrac{\\partial^2 V}{\\partial R_{\\alpha} \\partial R_{\\beta}}\\right|_{\\mathbf{R}_0}$。\n\n3. 定义对角质量矩阵 $\\mathbf{M}$，其中包含每个坐标对应的原子质量，以及质量加权的Hessian矩阵 $\\mathbf{F} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$。简正模分析求解本征问题 $\\mathbf{F} \\mathbf{v}_i = \\lambda_i \\mathbf{v}_i$，其中 $\\lambda_i$ 是曲率本征值，在一致的单位下与角频率的平方成正比。\n\n4. 在移除刚性平移和旋转后，一个真极小值点的特征是其Hessian矩阵为半正定；等效地，对于质量加权的Hessian矩阵 $\\mathbf{F}$，在数值容差范围内，必须对所有 $i$ 都有 $\\lambda_i \\ge 0$。一个一阶鞍点恰好有一个负本征值 $\\lambda_i < 0$，对应于沿着一个不稳定本征模的虚频。\n\n您的程序必须实现以下算法：\n\n- 给定对称Hessian矩阵 $\\mathbf{K}$ 和原子质量列表 $m_j$，为每个坐标 $\\alpha$ 构建对角质量加权因子 $d_\\alpha = 1/\\sqrt{m_\\alpha}$，并计算 $\\mathbf{F} = \\mathrm{diag}(d) \\, \\mathbf{K} \\, \\mathrm{diag}(d)$。\n\n- 计算 $\\mathbf{F}$ 的所有本征值 $\\lambda_i$ 和标准正交本征向量 $\\mathbf{v}_i$。\n\n- 使用严格的数值阈值 $\\varepsilon$ 来区分物理上的负值与数值噪声。将虚模数量 $N_{\\mathrm{imag}}$ 计为满足 $\\lambda_i < -\\varepsilon$ 的本征值个数。\n\n- 确定一个布尔分类 $b_{\\mathrm{min}}$，如果 $N_{\\mathrm{imag}} = 0$ 则 $b_{\\mathrm{min}} = \\mathrm{True}$，否则为 $b_{\\mathrm{min}} = \\mathrm{False}$。\n\n- 如果 $N_{\\mathrm{imag}} > 0$，识别出最负的本征值 $\\lambda_{\\min}$ 及其本征向量 $\\mathbf{v}_{\\min}$，并计算吸附物局域化度量 $L_{\\mathrm{ads}} = \\dfrac{\\sum_{\\alpha \\in \\mathcal{A}} v_{\\min,\\alpha}^2}{\\sum_{\\alpha} v_{\\min,\\alpha}^2}$，其中 $\\mathcal{A}$ 是属于吸附物的坐标索引集合。如果 $N_{\\mathrm{imag}} = 0$，则定义 $L_{\\mathrm{ads}} = 0$。\n\n此问题中所有的数学实体必须如上所示使用LaTeX处理，并且逻辑必须严格按照列出的基本原理表达，不得使用超出范围的简化公式。结果是纯计算性的，不需要报告物理单位，因为只使用了曲率的符号（本征值）和一个无量纲的局域化度量。角度不适用，也不得使用百分比；$L_{\\mathrm{ads}}$ 是一个介于 $0$ 和 $1$ 之间的小数。\n\n在以下测试集上实现并测试您的解决方案。每个测试用例指定 $(\\mathbf{K}, \\mathbf{m}, \\mathcal{A}, \\varepsilon):$\n\n- 测试用例1（正常路径极小值）：一个具有正定曲率的稳定吸附几何构型。使用\n$$\n\\mathbf{K}_1 = \\begin{bmatrix}\n8.0  0.2  0.0 \\\\\n0.2  12.0  0.1 \\\\\n0.0  0.1  15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_1 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_1 = \\{0\\}, \\quad\n\\varepsilon_1 = 1\\times 10^{-6}.\n$$\n\n- 测试用例2（沿吸附物坐标的一阶鞍点）：一个由吸附物简正模主导的不稳定方向。使用\n$$\n\\mathbf{K}_2 = \\begin{bmatrix}\n-1.0  0.1  0.0 \\\\\n0.1  12.0  0.1 \\\\\n0.0  0.1  15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_2 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_2 = \\{0\\}, \\quad\n\\varepsilon_2 = 1\\times 10^{-6}.\n$$\n\n- 测试用例3（局域在表面上的一阶鞍点）：一个由表面原子模式主导的不稳定方向。使用\n$$\n\\mathbf{K}_3 = \\begin{bmatrix}\n8.0  0.1  0.0 \\\\\n0.1  12.0  0.1 \\\\\n0.0  0.1  -0.5\n\\end{bmatrix}, \\quad\n\\mathbf{m}_3 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_3 = \\{0\\}, \\quad\n\\varepsilon_3 = 1\\times 10^{-6}.\n$$\n\n- 测试用例4（近零数值噪声）：表观上微小的负曲率，远在数值容差范围内，应被视为零。使用\n$$\n\\mathbf{K}_4 = \\begin{bmatrix}\n8.0  0.0  0.0 \\\\\n0.0  -1\\times 10^{-8}  0.0 \\\\\n0.0  0.0  15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_4 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_4 = \\{0\\}, \\quad\n\\varepsilon_4 = 1\\times 10^{-6}.\n$$\n\n您的程序必须根据上述算法评估每个测试用例，并生成最终输出。输出为单行，包含一个逗号分隔的列表，其中每个元素是针对单个测试用例的结果列表，格式为 $[b_{\\mathrm{min}}, N_{\\mathrm{imag}}, L_{\\mathrm{ads}}]$。输出格式必须是无空格的单行，例如：\n$$\n\\text{[[True,0,0.000],[False,1,0.985],[False,1,0.013],[True,0,0.000]]}\n$$\n$L_{\\mathrm{ads}}$ 的数值必须四舍五入到三位小数。布尔值必须显示为 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上是合理的、定义明确且客观的，提出了计算化学中一个关于势能面上驻点的振动分析的标准问题。所提供的数据和算法要求是完整且一致的。\n\n该分析的理论基础在于玻恩-奥本海默近似下，将经典力学应用于分子振动。根据此近似，电子运动和原子核运动可以解耦，从而可以定义一个仅是原子核坐标 $\\mathbf{R}$ 的函数——势能面 (PES)，记为 $V(\\mathbf{R})$。\n\nPES上的驻点 $\\mathbf{R}_0$ 是主要研究对象，因为它们代表平衡几何构型（极小值点）或过渡态（鞍点）。在这些点上，每个原子核上的净力为零，这在数学上表示为势能梯度的消失：\n$$\n\\nabla V(\\mathbf{R}_0) = \\mathbf{0}\n$$\n为了确定驻点的性质（即，它是极小值点、极大值点还是鞍点），必须检查其附近的PES曲率。这可以通过对势能 $V(\\mathbf{R})$ 在驻点 $\\mathbf{R}_0$ 附近进行二阶泰勒展开来完成。对于小位移 $\\Delta \\mathbf{R} = \\mathbf{R} - \\mathbf{R}_0$，势能近似为：\n$$\nV(\\mathbf{R}) \\approx V(\\mathbf{R}_0) + \\nabla V(\\mathbf{R}_0)^{\\top} \\Delta \\mathbf{R} + \\frac{1}{2} \\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}\n$$\n由于 $\\nabla V(\\mathbf{R}_0) = \\mathbf{0}$，上式简化为：\n$$\nV(\\mathbf{R}) - V(\\mathbf{R}_0) \\approx \\frac{1}{2} \\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}\n$$\n这里，$\\mathbf{K}$ 是Hessian矩阵，是一个势能对原子核坐标的二阶偏导数组成的对称矩阵，在驻点 $\\mathbf{R}_0$ 处求值：\n$$\nK_{\\alpha\\beta} = \\left. \\frac{\\partial^2 V}{\\partial R_{\\alpha} \\partial R_{\\beta}} \\right|_{\\mathbf{R}_0}\n$$\n围绕 $\\mathbf{R}_0$ 的小振动的经典运动方程源自拉格朗日量 $\\mathcal{L} = T - V$。动能 $T$ 由 $T = \\frac{1}{2} \\dot{\\mathbf{R}}^{\\top} \\mathbf{M} \\dot{\\mathbf{R}}$ 给出，其中 $\\mathbf{M}$ 是与 $\\mathbf{R}$ 中坐标相对应的原子质量的对角矩阵。由此得到的以位移坐标 $\\Delta \\mathbf{R}$ 表示的运动方程是：\n$$\n\\mathbf{M} \\ddot{\\Delta \\mathbf{R}} = -\\mathbf{K} \\Delta \\mathbf{R}\n$$\n这是一个耦合二阶微分方程组。为了解耦它们，我们通过假设一个形式为 $\\Delta \\mathbf{R}(t) = \\mathbf{A} e^{i\\omega t}$ 的谐波解来寻找简正振动模。将此解代入运动方程，得到一个广义本征值问题：\n$$\n\\mathbf{K} \\mathbf{A} = \\omega^2 \\mathbf{M} \\mathbf{A}\n$$\n为了将其转换为标准本征值问题，我们引入质量加权坐标 $\\mathbf{q} = \\mathbf{M}^{1/2} \\Delta \\mathbf{R}$。相应的变换是 $\\Delta \\mathbf{R} = \\mathbf{M}^{-1/2} \\mathbf{q}$。将此代入运动方程并左乘 $\\mathbf{M}^{-1/2}$ 得：\n$$\n\\mathbf{M}^{-1/2} \\mathbf{M} (\\mathbf{M}^{-1/2} \\ddot{\\mathbf{q}}) = -\\mathbf{M}^{-1/2} \\mathbf{K} (\\mathbf{M}^{-1/2} \\mathbf{q})\n$$\n$$\n\\ddot{\\mathbf{q}} = -(\\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}) \\mathbf{q}\n$$\n我们定义质量加权Hessian矩阵 $\\mathbf{F} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$。运动方程变为 $\\ddot{\\mathbf{q}} = -\\mathbf{F} \\mathbf{q}$。通过求解标准本征值问题 $\\mathbf{F} \\mathbf{v}_i = \\lambda_i \\mathbf{v}_i$ 来解决此问题，得到本征值 $\\lambda_i = \\omega_i^2$（与振动频率的平方成正比）和本征向量 $\\mathbf{v}_i$（质量加权坐标系下的简正模）。\n\n本征值 $\\lambda_i$ 的符号可用于对驻点进行分类：\n- 如果所有 $\\lambda_i \\ge 0$（在排除了对应于刚体平移和旋转的零频模式后，这些模式在本简化问题中不是一个因素），则该驻点是PES上的一个真局域极小值点。每个振动模式都对应一个实频 $\\omega_i = \\sqrt{\\lambda_i}$。\n- 如果一个或多个本征值 $\\lambda_i$ 为负，则该驻点是一个鞍点。一个负本征值 $\\lambda_i < 0$ 对应一个虚频 $\\omega_i = i\\sqrt{|\\lambda_i|}$，表示一个能量沿其下降的不稳定模式。负本征值的数量 $N_{\\mathrm{imag}}$ 定义了鞍点的阶数。一阶鞍点，作为过渡态的常见表示，恰好有一个负本征值。\n\n待实现的算法直接遵循此推导过程。\n\n1.  对于每个测试用例，我们都给定笛卡尔Hessian矩阵 $\\mathbf{K}$、一个与每个坐标对应的质量列表 $\\mathbf{m}$、吸附物坐标索引集合 $\\mathcal{A}$ 以及一个数值阈值 $\\varepsilon$。\n2.  构建对角质量加权向量 $d$，其元素为 $d_\\alpha = 1/\\sqrt{m_\\alpha}$。\n3.  计算对称的质量加权Hessian矩阵 $\\mathbf{F}$，公式为 $\\mathbf{F} = \\mathrm{diag}(d) \\, \\mathbf{K} \\, \\mathrm{diag}(d)$。\n4.  求解 $\\mathbf{F}$ 的标准本征问题，以获得其本征值 $\\lambda_i$ 和相应的标准正交本征向量 $\\mathbf{v}_i$。\n5.  通过识别有多少个本征值在数值容差之外为负，来计算虚模的数量 $N_{\\mathrm{imag}}$：$N_{\\mathrm{imag}} = \\text{count of } \\{\\lambda_i | \\lambda_i < -\\varepsilon\\}$。\n6.  当且仅当不存在此类虚模时，该几何构型被分类为极小值点。因此，布尔分类为 $b_{\\mathrm{min}} = (N_{\\mathrm{imag}} = 0)$。\n7.  如果 $N_{\\mathrm{imag}} > 0$，我们识别与最负本征值 $\\lambda_{\\min}$ 相关联的不稳定模式及其本征向量 $\\mathbf{v}_{\\min}$。计算吸附物局域化度量 $L_{\\mathrm{ads}}$ 以量化此不稳定模式涉及吸附物坐标运动的程度。鉴于本征向量 $\\mathbf{v}_i$ 是归一化的，使得 $\\sum_{\\alpha} v_{i,\\alpha}^2 = 1$，该度量简化为对吸附物索引的求和：$L_{\\mathrm{ads}} = \\sum_{\\alpha \\in \\mathcal{A}} v_{\\min,\\alpha}^2$。\n8.  如果 $N_{\\mathrm{imag}} = 0$，该结构为极小值点，没有不稳定模式可供分析。在这种情况下，定义 $L_{\\mathrm{ads}}$ 为 $0$。\n\n此过程将应用于每个测试用例以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vibrational analysis problem for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"K\": np.array([\n                [8.0, 0.2, 0.0],\n                [0.2, 12.0, 0.1],\n                [0.0, 0.1, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [-1.0, 0.1, 0.0],\n                [0.1, 12.0, 0.1],\n                [0.0, 0.1, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [8.0, 0.1, 0.0],\n                [0.1, 12.0, 0.1],\n                [0.0, 0.1, -0.5]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [8.0, 0.0, 0.0],\n                [0.0, -1e-8, 0.0],\n                [0.0, 0.0, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        K = case[\"K\"]\n        m = case[\"m\"]\n        A_indices = case[\"A\"]\n        epsilon = case[\"eps\"]\n\n        # 1. Construct the diagonal mass-weighting vector d_alpha = 1/sqrt(m_alpha).\n        d = 1.0 / np.sqrt(m)\n\n        # 2. Compute the mass-weighted Hessian F = diag(d) * K * diag(d).\n        # This can be done efficiently using broadcasting.\n        F = np.outer(d, d) * K\n\n        # 3. Compute all eigenvalues and orthonormal eigenvectors of F.\n        # np.linalg.eigh is used for symmetric matrices and returns eigenvalues\n        # in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(F)\n\n        # 4. Count the number of imaginary modes N_imag.\n        imaginary_modes_mask = eigenvalues < -epsilon\n        N_imag = np.sum(imaginary_modes_mask)\n\n        # 5. Determine the boolean classification b_min.\n        b_min = (N_imag == 0)\n\n        # 6. Compute adsorbate localization metric L_ads.\n        if N_imag > 0:\n            # Eigenvalues are sorted, so the most negative is the first one.\n            # The corresponding eigenvector is the first column of the eigenvector matrix.\n            v_min = eigenvectors[:, 0]\n            \n            # The denominator sum of squares is 1 for normalized eigenvectors.\n            # We only need to sum the squared components for the adsorbate indices.\n            ads_squared_components = [v_min[i]**2 for i in A_indices]\n            L_ads = np.sum(ads_squared_components)\n        else:\n            # If N_imag is 0, L_ads is defined as 0.\n            L_ads = 0.0\n\n        # Round L_ads to three decimal places.\n        L_ads_rounded = round(L_ads, 3)\n\n        results.append([b_min, N_imag, L_ads_rounded])\n\n    # Final print statement in the exact required format.\n    str_results = [f\"[{b},{n},{l:.3f}]\" for b, n, l in results]\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "密度泛函理论（DFT）计算依赖于近似，其中交换关联泛函的选择是不确定性的一个主要来源。这个高级练习将带您超越单个确定性数值，转向更符合科研实际的概率性视角。您将学习如何利用来自不同泛函的一组结果来量化这种认识不确定性，并以具有统计意义的置信区间来报告吸附能。",
            "id": "3867648",
            "problem": "一项表面科学计算为给定的催化剂表面上的吸附物，从多种交换相关泛函中得到电子基态总能量。吸附能的基本定义是，在有效零温和零压下，将吸附物从气相转移到表面时内能的变化，其中电子能量被视为内能。根据此定义，某个泛函的吸附能是三个总能量之差：组合体系、洁净表面和孤立吸附物。由于交换相关泛函的选择会引起模型差异，应使用泛函系综来量化吸附能中的认知不确定性。将系综中校正后的吸附能视为来自一个未知均值和方差的未知分布的独立抽样，并通过对均值和方差采用无信息先验，计算平均吸附能的置信水平为 $0.95$ 的贝叶斯可信区间。\n\n您的程序必须为每个测试用例实现以下步骤：\n- 对于每个泛函 $f$，根据组合体系、洁净板层和孤立吸附物的电子总能量，计算吸附能 $E_{\\mathrm{ads},f}$。\n- 对每个泛函应用校准偏差 $b_f$，以获得校正后的吸附能 $E_{\\mathrm{ads},f}^{\\mathrm{corr}}$。其符号约定为：泛函的预期过结合（更强的放热吸附，即更负的能量）对应于 $b_f < 0$，欠结合对应于 $b_f > 0$，校正公式为 $E_{\\mathrm{ads},f}^{\\mathrm{corr}} = E_{\\mathrm{ads},f} - b_f$。\n- 将集合 $\\{E_{\\mathrm{ads},f}^{\\mathrm{corr}}\\}$ 建模为来自一个未知均值和方差的分布的抽样，对这些参数采用无信息先验，并基于此先验选择计算系综平均吸附能的 $0.95$ 贝叶斯可信区间。\n- 所有能量均以 $\\mathrm{eV}$ 表示，报告的数值四舍五入到三位小数。\n\n测试套件：\n- 案例 $1$（理想情况，多个泛函）：\n  - 组合体系能量 $E_{\\mathrm{slab+ads}}$: $-411.250\\,\\mathrm{eV}$, $-410.900\\,\\mathrm{eV}$, $-411.700\\,\\mathrm{eV}$, $-411.500\\,\\mathrm{eV}$, $-411.070\\,\\mathrm{eV}$。\n  - 洁净板层能量 $E_{\\mathrm{slab}}$: $-400.000\\,\\mathrm{eV}$, $-399.800\\,\\mathrm{eV}$, $-400.500\\,\\mathrm{eV}$, $-400.200\\,\\mathrm{eV}$, $-399.900\\,\\mathrm{eV}$。\n  - 孤立吸附物能量 $E_{\\mathrm{adsorbate}}$: $-10.000\\,\\mathrm{eV}$, $-9.950\\,\\mathrm{eV}$, $-10.100\\,\\mathrm{eV}$, $-10.050\\,\\mathrm{eV}$, $-10.020\\,\\mathrm{eV}$。\n  - 校准偏差 $b_f$: $-0.050\\,\\mathrm{eV}$, $+0.100\\,\\mathrm{eV}$, $-0.020\\,\\mathrm{eV}$, $+0.080\\,\\mathrm{eV}$, $0.000\\,\\mathrm{eV}$。\n- 案例 $2$（边界情况，小系综）：\n  - 组合体系能量 $E_{\\mathrm{slab+ads}}$: $-308.550\\,\\mathrm{eV}$, $-309.000\\,\\mathrm{eV}$。\n  - 洁净板层能量 $E_{\\mathrm{slab}}$: $-300.000\\,\\mathrm{eV}$, $-300.200\\,\\mathrm{eV}$。\n  - 孤立吸附物能量 $E_{\\mathrm{adsorbate}}$: $-8.000\\,\\mathrm{eV}$, $-8.050\\,\\mathrm{eV}$。\n  - 校准偏差 $b_f$: $+0.050\\,\\mathrm{eV}$, $-0.030\\,\\mathrm{eV}$。\n- 案例 $3$（边缘情况，存在离群值的系综）：\n  - 组合体系能量 $E_{\\mathrm{slab+ads}}$: $-513.000\\,\\mathrm{eV}$, $-512.700\\,\\mathrm{eV}$, $-512.900\\,\\mathrm{eV}$, $-512.950\\,\\mathrm{eV}$, $-512.800\\,\\mathrm{eV}$, $-514.500\\,\\mathrm{eV}$。\n  - 洁净板层能量 $E_{\\mathrm{slab}}$: $-500.000\\,\\mathrm{eV}$, $-499.500\\,\\mathrm{eV}$, $-500.200\\,\\mathrm{eV}$, $-499.800\\,\\mathrm{eV}$, $-500.100\\,\\mathrm{eV}$, $-500.000\\,\\mathrm{eV}$。\n  - 孤立吸附物能量 $E_{\\mathrm{adsorbate}}$: $-12.000\\,\\mathrm{eV}$, $-12.100\\,\\mathrm{eV}$, $-11.900\\,\\mathrm{eV}$, $-12.050\\,\\mathrm{eV}$, $-12.000\\,\\mathrm{eV}$, $-12.000\\,\\mathrm{eV}$。\n  - 校准偏差 $b_f$: $+0.050\\,\\mathrm{eV}$, $+0.020\\,\\mathrm{eV}$, $-0.030\\,\\mathrm{eV}$, $0.000\\,\\mathrm{eV}$, $+0.040\\,\\mathrm{eV}$, $-0.100\\,\\mathrm{eV}$。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。其中每个测试用例对应一个 $[\\mu, L, U]$ 形式的子列表，$\\mu$ 是系综平均吸附能（单位 $\\mathrm{eV}$），$L$ 是下界（单位 $\\mathrm{eV}$），$U$ 是上界（单位 $\\mathrm{eV}$），每个值都四舍五入到三位小数。例如，输出格式为 $[[\\mu_1,L_1,U_1],[\\mu_2,L_2,U_2],[\\mu_3,L_3,U_3]]$。",
            "solution": "该问题具有科学依据、提法明确、客观，并包含足够的信息以获得唯一解。它描述了计算催化和表面科学中一个标准的、现代的工作流程，用于确定吸附能并量化在密度泛函理论（DFT）中因选择不同交换相关泛函而产生的认知不确定性。该过程包括计算吸附能，应用系统偏差校正，然后使用贝叶斯推断来确定真实平均吸附能的可信区间。\n\n解决方案通过以下顺序步骤实现。\n\n首先，对于每个由 $f$ 索引的交换相关泛函，计算其吸附能 $E_{\\mathrm{ads},f}$。该量表示吸附物分子从气相过渡到催化剂表面时的电子能量变化。基本公式为：\n$$E_{\\mathrm{ads},f} = E_{\\mathrm{slab+ads},f} - (E_{\\mathrm{slab},f} + E_{\\mathrm{adsorbate},f})$$\n其中 $E_{\\mathrm{slab+ads},f}$ 是组合体系（吸附物在催化剂板层上）的总电子能量，$E_{\\mathrm{slab},f}$ 是洁净板层的能量，$E_{\\mathrm{adsorbate},f}$ 是气相中孤立吸附物分子的能量。按照惯例，更负的 $E_{\\mathrm{ads},f}$ 表示更强的结合（一个更放热的过程）。\n\n其次，对每个计算出的吸附能应用校准偏差 $b_f$，以校正给定泛函已知的系统误差。倾向于过结合（产生过于负的吸附能）的泛函具有负偏差 $b_f < 0$，而欠结合的泛函具有正偏差 $b_f > 0$。校正后的吸附能 $E_{\\mathrm{ads},f}^{\\mathrm{corr}}$ 由下式给出：\n$$E_{\\mathrm{ads},f}^{\\mathrm{corr}} = E_{\\mathrm{ads},f} - b_f$$\n此校正将原始计算能量调整至更准确的值。\n\n第三，将校正后的吸附能集合 $\\{E_{\\mathrm{ads},1}^{\\mathrm{corr}}, E_{\\mathrm{ads},2}^{\\mathrm{corr}}, \\dots, E_{\\mathrm{ads},n}^{\\mathrm{corr}}\\}$ 视为从一个未知均值 $\\mu$ 和未知方差 $\\sigma^2$ 的正态分布中抽取的样本，样本大小为 $n$。目标是找到均值 $\\mu$ 的贝叶斯可信区间。为实现这一目标，我们对参数 $\\mu$ 和 $\\sigma^2$ 采用无信息先验。此场景下的标准选择是Jeffreys先验，它与方差的倒数成正比：\n$$p(\\mu, \\sigma^2) \\propto \\frac{1}{\\sigma^2}$$\n该先验是异常的，但能导出正常的后验分布。将此先验与正态似然函数结合，并通过积分消去讨厌参数 $\\sigma^2$，可得到 $\\mu$ 的边缘后验分布。贝叶斯统计学中一个公认的结果是，此过程会得到一个 $\\mu$ 的后验分布，该分布是学生t分布的位置-尺度变换。具体来说，量：\n$$ T = \\frac{\\mu - \\bar{x}}{s / \\sqrt{n}} $$\n服从自由度为 $\\nu = n-1$ 的学生t分布。在此表达式中：\n- $n$ 是系综中泛函的数量。\n- $\\bar{x}$ 是校正后吸附能的样本均值：$\\bar{x} = \\frac{1}{n}\\sum_{f=1}^{n} E_{\\mathrm{ads},f}^{\\mathrm{corr}}$。\n- $s$ 是样本标准差（使用无偏估计量）：$s = \\sqrt{\\frac{1}{n-1}\\sum_{f=1}^{n} (E_{\\mathrm{ads},f}^{\\mathrm{corr}} - \\bar{x})^2}$。\n\n$\\mu$ 的 $(1-\\alpha)$ 贝叶斯可信区间以样本均值 $\\bar{x}$ 为中心，构造如下：\n$$ \\left[ \\bar{x} - t_{1-\\alpha/2, \\nu} \\frac{s}{\\sqrt{n}}, \\quad \\bar{x} + t_{1-\\alpha/2, \\nu} \\frac{s}{\\sqrt{n}} \\right] $$\n其中 $t_{1-\\alpha/2, \\nu}$ 是自由度为 $\\nu = n-1$ 的学生t分布的上 $(1-\\alpha/2)$ 分位数。对于指定的 $0.95$ 可信水平，我们有 $\\alpha = 0.05$，因此需要 $t_{0.975, n-1}$ 分位数。需要报告的系综均值是样本均值 $\\bar{x}$，它也是 $\\mu$ 的后验分布的均值。\n\n因此，每个测试用例的算法如下：\n1.  计算校正后吸附能的向量 $\\{x_f\\}$，其中 $x_f = (E_{\\mathrm{slab+ads},f} - (E_{\\mathrm{slab},f} + E_{\\mathrm{adsorbate},f})) - b_f$。\n2.  计算系综的大小 $n$。\n3.  计算向量 $\\{x_f\\}$ 的样本均值 $\\bar{x}$ 和样本标准差 $s$（自由度为 $n-1$）。\n4.  确定自由度 $\\nu = n-1$。\n5.  使用统计函数（如 `scipy.stats.t.ppf`）找到临界t值 $t_{crit} = t_{0.975, \\nu}$。\n6.  计算误差范围 $E_{margin} = t_{crit} \\times s / \\sqrt{n}$。\n7.  报告的值是均值 $\\mu = \\bar{x}$、下界 $L = \\bar{x} - E_{margin}$ 和上界 $U = \\bar{x} + E_{margin}$。\n8.  所有结果四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases described in the prompt.\n    Calculates the ensemble mean adsorption energy and its 95% Bayesian\n    credible interval from a set of DFT calculations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"E_slab_ads\": np.array([-411.250, -410.900, -411.700, -411.500, -411.070]),\n            \"E_slab\": np.array([-400.000, -399.800, -400.500, -400.200, -399.900]),\n            \"E_adsorbate\": np.array([-10.000, -9.950, -10.100, -10.050, -10.020]),\n            \"biases\": np.array([-0.050, 0.100, -0.020, 0.080, 0.000]),\n        },\n        {\n            \"E_slab_ads\": np.array([-308.550, -309.000]),\n            \"E_slab\": np.array([-300.000, -300.200]),\n            \"E_adsorbate\": np.array([-8.000, -8.050]),\n            \"biases\": np.array([0.050, -0.030]),\n        },\n        {\n            \"E_slab_ads\": np.array([-513.000, -512.700, -512.900, -512.950, -512.800, -514.500]),\n            \"E_slab\": np.array([-500.000, -499.500, -500.200, -499.800, -500.100, -500.000]),\n            \"E_adsorbate\": np.array([-12.000, -12.100, -11.900, -12.050, -12.000, -12.000]),\n            \"biases\": np.array([0.050, 0.020, -0.030, 0.000, 0.040, -0.100]),\n        },\n    ]\n\n    results = []\n    confidence_level = 0.95\n\n    for case in test_cases:\n        # Step 1: Compute adsorption energy for each functional\n        E_ads = case[\"E_slab_ads\"] - (case[\"E_slab\"] + case[\"E_adsorbate\"])\n\n        # Step 2: Apply calibration bias\n        E_ads_corr = E_ads - case[\"biases\"]\n\n        # Step 3: Compute statistics for the Bayesian credible interval\n        n = len(E_ads_corr)\n        if n < 2:\n            # The formula for sample standard deviation with ddof=1 is undefined for n<2.\n            # Problem constraints guarantee n>=2. This is a safeguard.\n            # For n=1, uncertainty would be infinite under this model.\n            # Let's assume this case won't happen based on test suite.\n            results.append([float('nan'), float('nan'), float('nan')])\n            continue\n\n        # Ensemble mean (posterior mean of mu)\n        mu_mean = np.mean(E_ads_corr)\n        \n        # Sample standard deviation with n-1 degrees of freedom (ddof=1)\n        s = np.std(E_ads_corr, ddof=1)\n        \n        # Degrees of freedom for the t-distribution\n        nu = n - 1\n        \n        # Calculate the critical value from the t-distribution for the 95% credible interval\n        # t.ppf(q, df) gives the value t* such that P(T <= t*) = q\n        # For a two-sided interval at level (1-alpha), we need q = 1 - alpha/2\n        alpha = 1 - confidence_level\n        t_crit = t.ppf(1 - alpha / 2, df=nu)\n        \n        # Calculate the margin of error\n        margin_of_error = t_crit * s / np.sqrt(n)\n        \n        # Lower and upper bounds of the credible interval\n        lower_bound = mu_mean - margin_of_error\n        upper_bound = mu_mean + margin_of_error\n        \n        # Round the results to three decimal places\n        mu_rounded = round(mu_mean, 3)\n        L_rounded = round(lower_bound, 3)\n        U_rounded = round(upper_bound, 3)\n        \n        # Ensure -0.000 is formatted as 0.000\n        if mu_rounded == -0.0: mu_rounded = 0.0\n        if L_rounded == -0.0: L_rounded = 0.0\n        if U_rounded == -0.0: U_rounded = 0.0\n        \n        results.append([mu_rounded, L_rounded, U_rounded])\n\n    # Final print statement in the exact required format\n    # The default str() representation of a list is '[item1, item2, ...]'\n    # which matches the required sublist format '[\\mu_1,L_1,U_1]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}