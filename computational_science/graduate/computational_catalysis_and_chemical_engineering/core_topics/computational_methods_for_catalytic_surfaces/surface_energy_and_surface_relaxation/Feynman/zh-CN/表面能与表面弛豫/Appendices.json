{
    "hands_on_practices": [
        {
            "introduction": "这项实践是计算表面科学的核心，它建立了从总能量计算中提取表面能的基本流程。我们将使用假设的密度泛函理论(DFT)数据，来推导对称板模型的表面能，通过外推到无限厚度来消除有限尺寸效应，并量化由原子弛豫引起的能量降低。这个练习将帮助你掌握表面能计算的标准方法。",
            "id": "3901262",
            "problem": "您的任务是设计并实现密度泛函理论 (DFT) 中使用的标准板层模型方法，用以计算对称板层的表面自由能，并量化表面弛豫效应。请从基本定义出发：表面自由能是在固定组分下，从体相晶体中创造出表面时每单位面积所需的可逆功；对于在周期性边界条件下具有两个相同表面的对称板层，其额外能量仅源于这些表面的存在。利用此定义和基本的能量衡算，推导出对称板层的表面自由能关于总能量和面积的表达式。请勿使用任何简化公式；需从第一性原理出发推导表达式，并以算法形式实现。\n\n然后，设计一个程序，利用基于两个表面间相互作用随板层厚度衰减的渐近论证，来消除板层厚度方向上的有限尺寸效应。对计算出的表面自由能与原子数倒数进行线性回归，以外推至无限厚度极限。通过分别使用未弛豫和已弛豫的板层能量，来包含原子弛豫的效应，并量化由弛豫引起的表面自由能降低。\n\n您的程序必须为每个测试用例执行以下步骤：\n- 给定原子数列表 $N$、以电子伏特 ($\\text{eV}$) 为单位的每个原子的体相能量 $E_{\\text{bulk}}$、未弛豫和已弛豫两种几何构型的总板层能量 $E_{\\text{slab}}(N)$（以电子伏特 $\\text{eV}$ 为单位）以及以平方埃 ($\\text{\\AA}^2$) 为单位的表面积 $A$，分别计算未弛豫和已弛豫两种情况下每个 $N$ 对应的单位面积表面自由能。使用符合物理的对称板层解释来推导并应用正确的表达式。\n- 将所有计算出的表面能从电子伏特每平方埃 ($\\text{eV}/\\text{\\AA}^2$) 转换为焦耳每平方米 ($\\text{J}/\\text{m}^2$)。使用换算关系 $1$ 电子伏特 ($\\text{eV}$) $= 1.602176634\\times 10^{-19}$ 焦耳 ($\\text{J}$) 和 $1$ 平方埃 ($\\text{\\AA}^2$) $= 10^{-20}$ 平方米 ($\\text{m}^2$)。\n- 将已弛豫情况下的表面自由能值作为 $1/N$ 的函数，使用线性模型进行拟合，以估计无限厚度极限 $\\gamma_{\\infty}$（$1/N \\to 0$ 时的截距），单位为焦耳每平方米 ($\\text{J}/\\text{m}^2$)。同样地，拟合未弛豫情况的数据以估计其无限厚度极限，并以 $\\Delta \\gamma = \\gamma_{\\infty}^{\\text{unrelaxed}} - \\gamma_{\\infty}^{\\text{relaxed}}$ 定义的正常量形式，报告由弛豫引起的降低值。\n- 为已弛豫情况确定一个布尔收敛指示符，定义为 $\\max_{N} |\\gamma_{\\text{relaxed}}(N) - \\gamma_{\\infty}^{\\text{relaxed}}|  T$，其中容差 $T$ 设置为 $0.05$ 焦耳每平方米 ($\\text{J}/\\text{m}^2$)。若不等式成立，返回 $\\text{True}$；否则，返回 $\\text{False}$。\n\n所有最终的表面能均以焦耳每平方米 ($\\text{J}/\\text{m}^2$) 为单位，四舍五入至三位小数，收敛指示符为布尔值。计算不涉及角度；无需角度单位。\n\n测试套件参数：\n- 案例 1（理想情况，中等有限尺寸效应）：\n  - $A = 58.4$ $\\text{\\AA}^2$\n  - $E_{\\text{bulk}} = -3.91$ $\\text{eV}$\n  - $N \\in \\{24, 28, 32, 36, 40\\}$\n  - $E_{\\text{slab}}^{\\text{unrelaxed}}(N)$ 单位 $\\text{eV}$：$\\{-84.371, -100.028857143, -115.68225, -131.332666667, -146.981\\}$\n  - $E_{\\text{slab}}^{\\text{relaxed}}(N)$ 单位 $\\text{eV}$：$\\{-86.0687, -101.717628571, -117.364325, -133.009533333, -148.6537\\}$\n- 案例 2（边界情况，小 N 时有强有限尺寸效应）：\n  - $A = 25.0$ $\\text{\\AA}^2$\n  - $E_{\\text{bulk}} = -7.10$ $\\text{eV}$\n  - $N \\in \\{8, 10, 12, 14\\}$\n  - $E_{\\text{slab}}^{\\text{unrelaxed}}(N)$ 单位 $\\text{eV}$：$\\{-48.55, -62.9, -77.2, -91.4714286\\}$\n  - $E_{\\text{slab}}^{\\text{relaxed}}(N)$ 单位 $\\text{eV}$：$\\{-50.425, -64.7, -78.95, -93.1857143\\}$\n- 案例 3（边缘情况，大 N 时接近收敛）：\n  - $A = 92.0$ $\\text{\\AA}^2$\n  - $E_{\\text{bulk}} = -5.50$ $\\text{eV}$\n  - $N \\in \\{54, 60, 66, 72\\}$\n  - $E_{\\text{slab}}^{\\text{unrelaxed}}(N)$ 单位 $\\text{eV}$：$\\{-287.2368889, -320.238, -353.2389091, -386.2396667\\}$\n  - $E_{\\text{slab}}^{\\text{relaxed}}(N)$ 单位 $\\text{eV}$：$\\{-287.7925926, -320.7933333, -353.7939394, -386.7944444\\}$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例产生一个包含三个元素的列表 $[\\gamma_{\\infty}^{\\text{relaxed}}, \\Delta \\gamma, \\text{converged}]$。例如，输出格式必须严格为：$\\big[[\\gamma_1, \\Delta\\gamma_1, \\text{bool}_1],[\\gamma_2, \\Delta\\gamma_2, \\text{bool}_2],[\\gamma_3, \\Delta\\gamma_3, \\text{bool}_3]\\big]$，所有 $\\gamma$ 值单位为 $\\text{J}/\\text{m}^2$ 并四舍五入到三位小数，布尔值以编程语言的规范布尔格式打印。",
            "solution": "该问题要求计算对称板层的表面自由能，并考虑表面弛豫和有限尺寸误差的影响。该过程基于热力学和固态物理学的基本原理，并应用于密度泛函理论 (DFT) 计算中。\n\n首先，我们必须从第一性原理推导表面自由能 $\\gamma$ 的表达式。表面自由能定义为在恒定温度、压力和化学成分下，创造一个新表面时每单位面积所需的可逆功。对于温度为 $0$ 开尔文的固态系统（这是基态 DFT 计算的标准设置），吉布斯自由能的变化简化为总内能的变化。\n\n考虑一个体相晶体。包含 $N$ 个原子的这部分晶体的总能量可以表示为 $N \\cdot E_{\\text{bulk}}$，其中 $E_{\\text{bulk}}$ 是体相材料中每个原子的能量。现在，想象我们解理该晶体，创建一个包含 $N$ 个原子的板层，该板层具有两个相同的表面，每个表面的面积为 $A$。这个新系统的总能量是板层能量 $E_{\\text{slab}}(N)$。创造这两个表面需要能量，即表面能。与体相中等量原子相比，板层的总额外能量为：\n$$\n\\Delta E = E_{\\text{slab}}(N) - N \\cdot E_{\\text{bulk}}\n$$\n这个额外能量 $\\Delta E$ 是创造两个表面的能量代价。根据定义，该能量也等于 $2\\gamma A$，其中因子 $2$ 是因为对称板层有两个相同的表面。\n$$\n2\\gamma A = E_{\\text{slab}}(N) - N \\cdot E_{\\text{bulk}}\n$$\n求解表面自由能 $\\gamma$，我们得到计算的核心方程，它依赖于原子数（或层数）$N$：\n$$\n\\gamma(N) = \\frac{E_{\\text{slab}}(N) - N \\cdot E_{\\text{bulk}}}{2A}\n$$\n根据所提供的输入，此计算的单位将是电子伏特每平方埃 ($\\text{eV}/\\text{\\AA}^2$)。我们需要将其转换为国际单位制单位焦耳每平方米 ($\\text{J}/\\text{m}^2$)。给定的转换因子为 $1 \\text{ eV} = 1.602176634 \\times 10^{-19} \\text{ J}$ 和 $1 \\text{ \\AA} = 10^{-10} \\text{ m}$，这意味着 $1 \\text{ \\AA}^2 = 10^{-20} \\text{ m}^2$。因此，转换因子为：\n$$\n\\frac{1 \\text{ eV}}{1 \\text{ \\AA}^2} = \\frac{1.602176634 \\times 10^{-19} \\text{ J}}{10^{-20} \\text{ m}^2} = 16.02176634 \\frac{\\text{J}}{\\text{m}^2}\n$$\n在实践中，板层的 DFT 计算会受到有限尺寸效应的影响。有限厚度为 $N$ 的板层有两个表面，它们可以通过板层的体相部分相互作用。这种相互作用能通常随板层厚度的增加而衰减。一个常见的近似是，这种残余相互作用能，以及由此产生的计算表面能误差，与板层厚度的倒数成正比，而在表面积恒定的情况下，这与原子数 $N$ 的倒数 $1/N$ 成正比。这导出了一个渐近关系：\n$$\n\\gamma(N) \\approx \\gamma_{\\infty} + \\frac{m}{N}\n$$\n其中 $\\gamma_{\\infty}$ 是无限厚度极限下 ($N \\to \\infty$) 的真实表面能，而 $m$ 是一个与两个表面之间相互作用相关的常数。为了确定 $\\gamma_{\\infty}$，我们可以计算一系列递增板层厚度（$N_1, N_2, \\dots$）对应的 $\\gamma(N)$，并对数据点 $(\\frac{1}{N_i}, \\gamma(N_i))$ 进行线性回归。所得直线的 y 轴截距即为外推值 $\\gamma_{\\infty}$。\n\n此过程应用于两组板层能量数据：一组用于未弛豫的板层，其中原子固定在其体相截断位置 ($E_{\\text{slab}}^{\\text{unrelaxed}}$)；另一组用于已弛豫的板层，其中原子被允许移动以最小化总能量 ($E_{\\text{slab}}^{\\text{relaxed}}$)。这使得可以量化表面弛豫的效应。未弛豫情况的外推表面能记为 $\\gamma_{\\infty}^{\\text{unrelaxed}}$，已弛豫情况的记为 $\\gamma_{\\infty}^{\\text{relaxed}}$。由弛豫引起的表面自由能降低量则为：\n$$\n\\Delta \\gamma = \\gamma_{\\infty}^{\\text{unrelaxed}} - \\gamma_{\\infty}^{\\text{relaxed}}\n$$\n物理上，弛豫使表面原子能够找到能量更低的位置，因此我们预期 $\\Delta \\gamma > 0$。\n\n最后，我们必须评估计算出的已弛豫表面能相对于板层厚度的收敛性。收敛指示符定义为：如果任何有限厚度表面能与外推的无限厚度值之间的最大绝对偏差小于给定容差 $T$，则为 $\\text{True}$。\n$$\n\\text{converged} = \\left( \\max_{N} |\\gamma_{\\text{relaxed}}(N) - \\gamma_{\\infty}^{\\text{relaxed}}|  T \\right)\n$$\n对于这个问题，容差指定为 $T = 0.05 \\text{ J}/\\text{m}^2$。\n\n每个测试用例的算法如下：\n1. 对于未弛豫和已弛豫的数据集，使用推导的公式为每个给定的原子数 $N$ 计算表面能 $\\gamma(N)$。\n2. 将所有计算出的 $\\gamma(N)$ 值从 $\\text{eV}/\\text{\\AA}^2$ 转换为 $\\text{J}/\\text{m}^2$。\n3. 准备线性回归数据：x 值为 $1/N$，y 值为对应的 $\\gamma(N)$。\n4. 对两个数据集进行线性回归，找到截距 $\\gamma_{\\infty}^{\\text{unrelaxed}}$ 和 $\\gamma_{\\infty}^{\\text{relaxed}}$。\n5. 计算弛豫能量差 $\\Delta \\gamma = \\gamma_{\\infty}^{\\text{unrelaxed}} - \\gamma_{\\infty}^{\\text{relaxed}}$。\n6. 通过找到有限厚度已弛豫能量与外推值 $\\gamma_{\\infty}^{\\text{relaxed}}$ 之间的最大绝对差，并将其与容差 $T = 0.05 \\text{ J}/\\text{m}^2$ 进行比较，来确定收敛布尔值。\n7. 整理结果 $[\\gamma_{\\infty}^{\\text{relaxed}}, \\Delta \\gamma, \\text{converged}]$，并将能量值四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the surface energy problem for the given test cases.\n    \"\"\"\n    \n    # Conversion constant from eV/Angstrom^2 to J/m^2\n    EV_PER_A2_TO_J_PER_M2 = 1.602176634e-19 / 1e-20\n    \n    # Convergence tolerance in J/m^2\n    TOLERANCE = 0.05\n\n    test_cases = [\n        {\n            \"A\": 58.4,\n            \"E_bulk\": -3.91,\n            \"N\": np.array([24, 28, 32, 36, 40]),\n            \"E_slab_unrelaxed\": np.array([-84.371, -100.028857143, -115.68225, -131.332666667, -146.981]),\n            \"E_slab_relaxed\": np.array([-86.0687, -101.717628571, -117.364325, -133.009533333, -148.6537]),\n        },\n        {\n            \"A\": 25.0,\n            \"E_bulk\": -7.10,\n            \"N\": np.array([8, 10, 12, 14]),\n            \"E_slab_unrelaxed\": np.array([-48.55, -62.9, -77.2, -91.4714286]),\n            \"E_slab_relaxed\": np.array([-50.425, -64.7, -78.95, -93.1857143]),\n        },\n        {\n            \"A\": 92.0,\n            \"E_bulk\": -5.50,\n            \"N\": np.array([54, 60, 66, 72]),\n            \"E_slab_unrelaxed\": np.array([-287.2368889, -320.238, -353.2389091, -386.2396667]),\n            \"E_slab_relaxed\": np.array([-287.7925926, -320.7933333, -353.7939394, -386.7944444]),\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N_vals = case[\"N\"]\n        E_bulk_per_atom = case[\"E_bulk\"]\n        area = case[\"A\"]\n        \n        # Calculate surface energy for unrelaxed and relaxed slabs\n        def calculate_gamma_series(E_slab_series):\n            # Formula: gamma = (E_slab(N) - N * E_bulk) / (2 * A)\n            gamma_ev_a2 = (E_slab_series - N_vals * E_bulk_per_atom) / (2 * area)\n            return gamma_ev_a2 * EV_PER_A2_TO_J_PER_M2\n\n        gamma_unrelaxed_series = calculate_gamma_series(case[\"E_slab_unrelaxed\"])\n        gamma_relaxed_series = calculate_gamma_series(case[\"E_slab_relaxed\"])\n        \n        # Prepare data for linear regression: x = 1/N\n        inv_N = 1.0 / N_vals\n        \n        # Perform linear regression to find the intercept (gamma_infinity)\n        # np.polyfit(x, y, 1) returns [slope, intercept]\n        \n        # Unrelaxed fit\n        _, gamma_inf_unrelaxed = np.polyfit(inv_N, gamma_unrelaxed_series, 1)\n        \n        # Relaxed fit\n        _, gamma_inf_relaxed = np.polyfit(inv_N, gamma_relaxed_series, 1)\n        \n        # Calculate relaxation-induced decrease in surface energy\n        delta_gamma = gamma_inf_unrelaxed - gamma_inf_relaxed\n\n        # Determine convergence indicator for the relaxed set\n        max_deviation = np.max(np.abs(gamma_relaxed_series - gamma_inf_relaxed))\n        is_converged = max_deviation  TOLERANCE\n        \n        # Append results, rounding to three decimal places\n        results.append([\n            round(gamma_inf_relaxed, 3),\n            round(delta_gamma, 3),\n            is_converged\n        ])\n\n    # Final print statement in the exact required format.\n    # str(list) automatically adds spaces after commas, matching the implied format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在了解了弛豫的能量效应后，我们现在来探究其物理根源。本练习将通过最小化一个多体势函数，构建一个简化的原子模型来模拟表面附近原子的逐层位移。这为我们理解表面化学键断裂如何驱动结构变化以降低总能量提供了具体的物理图像。",
            "id": "3901280",
            "problem": "您的任务是实现一个计算程序，用于确定一维原子平板中的表面弛豫，该程序需与计算催化和化学工程中使用的基本原理保持一致。考虑一个由 $N$ 个原子层组成的平板，这些原子层沿笛卡尔坐标系的表面法线方向 $z$ 排列。未弛豫的体相截断构型的位置为 $z_i^{\\mathrm{bulk}} = (i-1)a_0$，其中 $i \\in \\{1,\\dots,N\\}$，$a_0$ 是体相层间距。底层的位置 $z_1$ 固定在 $z_1 = 0$ 处，以代表一个半无限衬底，而层 $i \\geq 2$ 允许沿 $z$ 方向弛豫。\n\n您的模型必须使用一个通常用于捕捉因表面附近配位数减少而引起的表面弛豫效应的多体能量泛函。设平板的总能量 $E(\\mathbf{z})$ 为\n$$\nE(\\mathbf{z}) = \\sum_{1 \\leq i  j \\leq N} \\phi\\!\\left(r_{ij}\\right) + \\sum_{i=1}^N F\\!\\left(\\rho_i\\right),\n$$\n其中 $r_{ij} = |z_i - z_j|$ 是层间分离距离，$\\phi(r)$ 是原子对势，$\\rho_i$ 是第 $i$ 层的局部配位数度量（电子密度），$F(\\rho)$ 是嵌入能。假设采用以下经过充分检验的形式和定义：\n- 对势：\n$$\n\\phi(r) = \\varepsilon \\left[ \\left(\\frac{r_0}{r}\\right)^{12} - 2 \\left(\\frac{r_0}{r}\\right)^6 \\right],\n$$\n其中 $\\varepsilon$ 是势阱深度，$r_0$ 是特征距离（$\\phi(r)$ 的最小值在 $r=r_0$ 处取得）。\n- 配位数度量：\n$$\n\\rho_i = \\sum_{\\substack{j=1 \\\\ j \\neq i}}^N g(r_{ij}), \\quad \\text{其中} \\quad g(r) = \\left(\\frac{r_0}{r}\\right)^6,\n$$\n该值随分离距离的增大而衰减。\n- 嵌入能：\n$$\nF(\\rho) = -\\alpha \\sqrt{\\rho},\n$$\n其中参数 $\\alpha$ 控制多体贡献的强度。\n\n求和中只包含 $r_{ij} \\leq r_{\\mathrm{cut}}$ 的相互作用。距离 $z_i$ 和特征长度 $r_0$ 必须以埃 (Å) 为单位表示，能量 $\\phi(r)$ 和 $F(\\rho)$ 必须以电子伏特 (eV) 为单位表示。弛豫问题由力学平衡定义，即总能量相对于自由层位置的驻定性：\n$$\n\\frac{\\partial E(\\mathbf{z})}{\\partial z_k} = 0 \\quad \\text{对于所有自由的 } k \\in \\{2,\\dots,N\\}.\n$$\n为保持物理真实性，您必须确保原子层不发生交叉，即对于所有 $i$ 都有 $z_{i+1} > z_i$。为此，通过层间距 $d_i = z_{i+1} - z_i$（其中 $i \\in \\{1,\\dots,N-1\\}$）来参数化构型，并设置边界条件以确保 $d_i > 0$。\n\n您的程序必须：\n- 使用上述定义和截断半径 $r_{\\mathrm{cut}}$ 构建总能量 $E(\\mathbf{z})$。\n- 在箱式约束下，对总能量 $E(\\mathbf{z})$ 关于自由层间距 $d_i$ 进行最小化，以确保 $d_i$ 保持正值且在物理上合理。\n- 从 $d_i$ 和 $z_1=0$ 重构弛豫后的位置 $z_i^\\star$。\n- 报告所有 $i \\in \\{1,\\dots,N\\}$ 的层分辨位移 $u_i = z_i^\\star - z_i^{\\mathrm{bulk}}$，单位为埃 (Å)，并四舍五入到六位小数。\n\n使用以下测试套件来展示其正确性和覆盖范围：\n- 情况 1（具有表面弛豫的一般情况）：$N=6$，$a_0=2.5$ Å，$\\varepsilon=0.2$ eV，$r_0=2.5$ Å，$\\alpha=0.1$ eV，$r_{\\mathrm{cut}}=7.5$ Å。每个 $d_i$ 的边界为 $[0.7a_0,1.3a_0]$。\n- 情况 2（没有多体效应因而弛豫可忽略不计的边界情况）：$N=6$，$a_0=2.5$ Å，$\\varepsilon=0.2$ eV，$r_0=2.5$ Å，$\\alpha=0.0$ eV，$r_{\\mathrm{cut}}=7.5$ Å。每个 $d_i$ 的边界为 $[0.7a_0,1.3a_0]$。\n- 情况 3（软键合但更强的配位驱动导致更显著的弛豫）：$N=10$，$a_0=2.5$ Å，$\\varepsilon=0.1$ eV，$r_0=2.5$ Å，$\\alpha=0.25$ eV，$r_{\\mathrm{cut}}=10.0$ Å。每个 $d_i$ 的边界为 $[0.7a_0,1.3a_0]$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例对应一个包含 $N$ 个浮点数位移的列表，单位为埃，四舍五入到六位小数。例如，整体格式必须是\n$$\n[ [u_1^{(1)}, u_2^{(1)}, \\dots], [u_1^{(2)}, u_2^{(2)}, \\dots], [u_1^{(3)}, u_2^{(3)}, \\dots] ].\n$$\n此问题中不涉及角度，因此不需要角度单位。此问题中不涉及百分比，请勿在任何地方使用百分号。",
            "solution": "目标是通过基于力学平衡第一性原理的能量最小化方法，计算平板的层分辨位移。相关的基本依据是：(i) 保守系统的总势能决定其平衡状态，(ii) 力学平衡对应于能量相对于自由度的梯度为零，以及 (iii) 表面弛豫是由于表面配位数的改变而出现的，我们通过一个多体泛函来捕捉这一效应。我们概述其推导过程和算法。\n\n我们考虑沿 $z$ 方向、由索引 $i \\in \\{1,\\dots,N\\}$ 标记的原子层。未弛豫的体相截断位置为 $z_i^{\\mathrm{bulk}} = (i-1)a_0$。底层固定在 $z_1 = 0$，而所有其他层仅沿 $z$ 方向移动。为防止非物理的层交叉，我们通过层间距 $d_i = z_{i+1}-z_i$（其中 $i \\in \\{1,\\dots,N-1\\}$）进行参数化，这些间距被约束为正值（箱式约束 $d_i \\in [d_{\\min}, d_{\\max}]$ 且 $d_{\\min} > 0$）。\n\n总能量被建模为\n$$\nE(\\mathbf{z}) = \\sum_{1 \\leq i  j \\leq N} \\phi\\!\\left(r_{ij}\\right) + \\sum_{i=1}^N F\\!\\left(\\rho_i\\right), \\quad \\text{其中} \\quad r_{ij} = |z_i-z_j|.\n$$\n我们采用以下形式：\n- 对势，\n$$\n\\phi(r) = \\varepsilon \\left[ \\left(\\frac{r_0}{r}\\right)^{12} - 2 \\left(\\frac{r_0}{r}\\right)^6 \\right],\n$$\n这是一种移位的 Lennard-Jones 型势，其最小值在 $r=r_0$ 处，能量为 $-\\varepsilon$。\n- 配位数度量，\n$$\n\\rho_i = \\sum_{\\substack{j=1 \\\\ j \\neq i}}^N g(r_{ij}), \\quad \\text{其中} \\quad g(r) = \\left(\\frac{r_0}{r}\\right)^6,\n$$\n该项体现了随分离距离增大而减小的局部电子密度。\n- 嵌入能，\n$$\nF(\\rho) = -\\alpha \\sqrt{\\rho},\n$$\n该项模拟了随配位数增加而增强的多体稳定化效应。这些函数通常用于捕捉表面键合的变化，在表面处 $\\rho_i$ 减小，嵌入作用变弱，通常导致最表层间距的收缩（表面弛豫）。\n\n为确保计算易行性和物理真实性，相互作用在有限的截断半径 $r_{ij} \\leq r_{\\mathrm{cut}}$ 处被截断：\n$$\nE(\\mathbf{z}) = \\sum_{\\substack{1 \\leq i  j \\leq N \\\\ r_{ij} \\leq r_{\\mathrm{cut}}}} \\phi(r_{ij}) + \\sum_{i=1}^N F\\!\\left(\\sum_{\\substack{j=1 \\\\ j \\neq i \\\\ r_{ij} \\leq r_{\\mathrm{cut}}}}^N g(r_{ij})\\right).\n$$\n由于 $z_1=0$ 且 $z_{i+1} = z_i + d_i$，整个构型可以通过以下方式重构\n$$\nz_1 = 0, \\quad z_2 = d_1, \\quad z_3 = d_1 + d_2, \\quad \\dots, \\quad z_N = \\sum_{k=1}^{N-1} d_k.\n$$\n力学平衡条件即为驻定方程，\n$$\n\\frac{\\partial E}{\\partial d_k} = 0 \\quad \\text{对于} \\quad k \\in \\{1,\\dots,N-1\\}.\n$$\n对于自由层，这些方程等价于 $\\partial E / \\partial z_i = 0$，因为 $z_i$ 是 $d_k$ 的系数为单位的仿射函数。原则上，可以显式计算梯度。为作说明，对特定 $z_k$ 的导数是\n$$\n\\frac{\\partial E}{\\partial z_k} = \n\\sum_{\\substack{j=1 \\\\ j \\neq k}}^N \\phi'(r_{kj}) \\cdot \\frac{\\partial r_{kj}}{\\partial z_k}\n+ \\sum_{i=1}^N F'(\\rho_i) \\cdot \\frac{\\partial \\rho_i}{\\partial z_k}.\n$$\n对于对势项，由于 $r_{kj} = |z_k-z_j|$，我们有 $\\frac{\\partial r_{kj}}{\\partial z_k} = \\mathrm{sgn}(z_k-z_j)$，并且 $\\phi'(r) = \\varepsilon \\left[ -12 \\left(\\frac{r_0}{r}\\right)^{12} \\frac{1}{r} + 12 \\left(\\frac{r_0}{r}\\right)^6 \\frac{1}{r} \\right]$。对于密度项，\n$$\n\\frac{\\partial \\rho_k}{\\partial z_k} = \\sum_{\\substack{j=1 \\\\ j \\neq k}}^N g'(r_{kj}) \\cdot \\mathrm{sgn}(z_k-z_j), \n\\quad \\text{以及} \\quad\n\\frac{\\partial \\rho_i}{\\partial z_k} = g'(r_{ik}) \\cdot \\left(-\\mathrm{sgn}(z_i-z_k)\\right) \\quad \\text{对于} \\quad i \\neq k,\n$$\n其中 $g'(r) = -6\\left(\\frac{r_0}{r}\\right)^6 \\frac{1}{r}$ 且 $F'(\\rho) = -\\frac{\\alpha}{2\\sqrt{\\rho}}$。由于多体耦合，完整的表达式虽然在代数上是可解的，但非常冗长。实践中，稳健的拟牛顿优化方法可以通过函数求值和近似梯度来处理此问题。\n\n算法步骤：\n1. 初始化所有 $k \\in \\{1,\\dots,N-1\\}$ 的 $d_k^{(0)} = a_0$，这对应于 $z_i^{\\mathrm{bulk}}$。\n2. 定义边界 $d_k \\in [\\lambda_{\\min} a_0, \\lambda_{\\max} a_0]$，其中 $\\lambda_{\\min} > 0$ 且 $\\lambda_{\\max} > \\lambda_{\\min}$，以强制实现层不交叉和物理位移限制。在测试套件中，我们设置为 $[0.7 a_0, 1.3 a_0]$。\n3. 构建 $E(\\mathbf{z}(\\mathbf{d}))$，并使用有界拟牛顿算法对 $\\mathbf{d}$ 进行数值最小化。这通过在约束下满足驻定条件来强制实现离散力学平衡。\n4. 恢复弛豫后的位置 $z_i^\\star$，并计算位移 $u_i = z_i^\\star - z_i^{\\mathrm{bulk}}$，单位为埃。\n5. 将每个 $u_i$ 四舍五入到六位小数。\n6. 对所有测试用例重复以上步骤，以形成最终的输出列表。\n\n测试用例覆盖范围的基本原理：\n- 情况 1 展示了中等多体作用强度下的典型表面弛豫。当 $\\alpha > 0$ 时，顶层通过减小层间距来补偿减少的配位数，导致表面附近出现小的负值 $u_i$，而在类体相的内部 $u_i$ 则可忽略不计。\n- 情况 2 设置 $\\alpha = 0$，消除了多体配位作用。由于对势的最小值与 $a_0$ 匹配，系统已处于对势平衡状态。因此，位移在数值精度范围内为零，这用于测试边界行为。\n- 情况 3 通过 $\\varepsilon$ 减小了对势刚度，但通过 $\\alpha$ 增大了多体驱动，这通常会放大弛豫效应。此情况用于测试敏感性以及弛豫效应向更深层的穿透情况。\n\n单位被严格规定：距离使用埃，能量使用电子伏特。所有报告的 $u_i$ 必须以埃为单位，并四舍五入到六位小数。程序将三个列表（每个用例一个）聚合到一个打印在单行的方括号列表中，确保了普适性和确定性测试，不依赖于任何外部文件或输入。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef eam_energy(d, N, a0, epsilon, r0, alpha, r_cut):\n    \"\"\"\n    Compute total energy for a 1D slab with N layers parameterized by interlayer spacings d.\n    Distances in Angstroms (Å), energies in electronvolts (eV).\n    \"\"\"\n    # Reconstruct positions z from interlayer spacings d, with z1 = 0\n    z = np.zeros(N, dtype=float)\n    z[1:] = np.cumsum(d)\n\n    # Compute pair energy with cutoff\n    E_pair = 0.0\n    # Precompute all r_ij within cutoff\n    for i in range(N - 1):\n        zi = z[i]\n        for j in range(i + 1, N):\n            r = abs(z[j] - zi)\n            if r = r_cut:\n                # Lennard-Jones-like pair potential (min at r0)\n                # epsilon * [ (r0/r)^12 - 2 (r0/r)^6 ]\n                x = r0 / r\n                x6 = x ** 6\n                E_pair += epsilon * (x6 ** 2 - 2.0 * x6)\n\n    # Compute coordination rho_i and embedding energy\n    rho = np.zeros(N, dtype=float)\n    for i in range(N):\n        zi = z[i]\n        # Sum over neighbors within cutoff\n        s = 0.0\n        for j in range(N):\n            if j == i:\n                continue\n            r = abs(z[j] - zi)\n            if r = r_cut:\n                # g(r) = (r0/r)^6\n                s += (r0 / r) ** 6\n        rho[i] = s\n\n    # Embedding energy F(rho) = -alpha * sqrt(rho)\n    # Guard against tiny negative numerical values due to floating point\n    rho_clamped = np.clip(rho, 0.0, None)\n    E_embed = -alpha * np.sum(np.sqrt(rho_clamped))\n\n    return E_pair + E_embed\n\n\ndef relax_slab(N, a0, epsilon, r0, alpha, r_cut, bounds_scale=(0.7, 1.3)):\n    \"\"\"\n    Minimize the energy with respect to interlayer spacings d_i under box constraints.\n    Returns the layer-resolved displacements u_i in Angstroms (Å).\n    \"\"\"\n    # Initial guess: bulk-terminated spacings\n    d0 = np.full(N - 1, a0, dtype=float)\n\n    # Bounds to enforce non-crossing and physical ranges\n    lower = bounds_scale[0] * a0\n    upper = bounds_scale[1] * a0\n    bounds = [(lower, upper) for _ in range(N - 1)]\n\n    # Objective for optimizer\n    def objective(dvec):\n        return eam_energy(dvec, N, a0, epsilon, r0, alpha, r_cut)\n\n    # Perform bounded optimization (quasi-Newton)\n    res = minimize(\n        objective,\n        d0,\n        method='L-BFGS-B',\n        bounds=bounds,\n        options={'maxiter': 500, 'ftol': 1e-12}\n    )\n\n    d_opt = res.x\n\n    # Reconstruct relaxed positions z_i^* from d_opt\n    z_relaxed = np.zeros(N, dtype=float)\n    z_relaxed[1:] = np.cumsum(d_opt)\n\n    # Bulk positions\n    z_bulk = np.array([i * a0 for i in range(N)], dtype=float)\n\n    # Displacements u_i = z_i^* - z_i_bulk (Å)\n    u = z_relaxed - z_bulk\n\n    # Round to 6 decimals\n    u_rounded = [float(f\"{val:.6f}\") for val in u]\n    return u_rounded\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N, a0 [Å], epsilon [eV], r0 [Å], alpha [eV], r_cut [Å], bounds_scale)\n    test_cases = [\n        (6, 2.5, 0.2, 2.5, 0.1, 7.5, (0.7, 1.3)),  # Case 1: general relaxation\n        (6, 2.5, 0.2, 2.5, 0.0, 7.5, (0.7, 1.3)),  # Case 2: no many-body -> negligible relaxation\n        (10, 2.5, 0.1, 2.5, 0.25, 10.0, (0.7, 1.3)),  # Case 3: softer bonding, stronger embedding\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a0, epsilon, r0, alpha, r_cut, bscale = case\n        u = relax_slab(N, a0, epsilon, r0, alpha, r_cut, bounds_scale=bscale)\n        results.append(u)\n\n    # Final print statement in the exact required format: list of lists, one line.\n    # Each sublist corresponds to displacements (Å) rounded to six decimals for a given test case.\n    print(\"[\" + \",\".join(\"[\" + \",\".join(f\"{val:.6f}\" for val in case_result) + \"]\" for case_result in results) + \"]\")\n\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "DFT计算依赖于对交换相关($\\text{XC}$)泛函的近似，而泛函的选择会显著影响预测表面能的准确性。这最后一个练习模拟了一项常见的研究任务：将不同的$\\text{XC}$泛函（如PBE、SCAN和杂化泛函）的计算结果与可靠的参考值进行基准比较。这个练习强调了验证计算方法以确保其预测能力的重要性。",
            "id": "3901295",
            "problem": "你需要编写一个完整、可运行的程序，用于量化交换相关泛函的选择对表面能的影响，并根据代表实验或更高级别理论的参考数据构建基准测试指标。该程序必须实现基于物理定义的逻辑，而非使用简化的快捷公式。\n\n我们感兴趣的物理量是表面能 $\\,\\gamma\\,$，其定义为从块体固相中创造出表面所需的可逆功/单位面积。考虑一个从块体中解理出的对称平板，从而产生 $\\,s=2\\,$ 个等效表面。程序必须针对每种交换相关泛函——Perdew–Burke–Ernzerhof (PBE)、Strongly Constrained and Appropriately Normed (SCAN) 以及一种具有部分精确交换的代表性杂化泛函 (HYB)——使用每个测试用例的以下数据来计算 $\\,\\gamma\\,$：\n- 未弛豫平板的总能量（单位：电子伏特）$\\,E_{\\mathrm{slab}}^{\\mathrm{(XC)}}\\,$.\n- 每层块体的能量（单位：电子伏特）$\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(XC)}}\\,$.\n- 层数 $\\,N_{\\mathrm{layers}}\\,$.\n- 模拟晶胞的表面积 $\\,A\\,$（单位：平方埃）。\n- 弛豫分数 $\\,r^{\\mathrm{(XC)}}\\,$，以小数形式表示，指由于表面弛豫导致的 $\\,\\gamma\\,$ 的分数减少量，应将其乘到未弛豫值上。\n- 参考的弛豫表面能 $\\,\\gamma_{\\mathrm{ref}}\\,$（单位：焦耳/平方米），代表实验或更高级别理论的基准值。\n\n你的程序必须：\n1. 使用单位面积可逆功的定义，根据所提供的能量和几何量，计算出创建 $\\,s=2\\,$ 个表面时的未弛豫表面能 $\\,\\gamma\\,$。\n2. 应用所提供的弛豫分数 $\\,r^{\\mathrm{(XC)}}\\,$，得到每种泛函的弛豫表面能 $\\,\\gamma\\,$。\n3. 对每个测试用例，计算每种泛函的弛豫表面能 $\\,\\gamma\\,$ 相对于所提供的 $\\,\\gamma_{\\mathrm{ref}}\\,$ 的绝对误差，最佳泛函的索引（绝对误差最小的那个；PBE 用 $\\,0\\,$，SCAN 用 $\\,1\\,$，HYB 用 $\\,2\\,$），以及三种泛函的平均绝对误差。\n4. 将所有表面能和误差以焦耳/平方米为单位表示为浮点数，并四舍五入到三位小数。不涉及角度；不需要角度单位。\n\n你的程序必须统一使用以下常数和单位：\n- 电子伏特到焦耳的转换：$\\,1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}\\,$.\n- 埃到米的转换：$\\,1\\,\\text{\\AA} = 1 \\times 10^{-10}\\,\\mathrm{m}\\,$, 因此 $\\,1\\,\\text{\\AA}^2 = 1 \\times 10^{-20}\\,\\mathrm{m}^2\\,$.\n- 创建的表面数量：$\\,s=2\\,$.\n\n具有科学合理参数的测试套件：\n- 案例 1 (铜 (Cu) $(111)$):\n  - $\\,N_{\\mathrm{layers}} = 7\\,$, $\\,A = 52.4\\,\\text{\\AA}^2\\,$, $\\,\\gamma_{\\mathrm{ref}} = 1.85\\,\\mathrm{J}/\\mathrm{m}^2\\,$.\n  - PBE: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(PBE)}} = -3.72\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(PBE)}} = -14.27\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(PBE)}} = 0.10\\,$.\n  - SCAN: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(SCAN)}} = -3.95\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(SCAN)}} = -14.57\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(SCAN)}} = 0.08\\,$.\n  - HYB: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(HYB)}} = -4.10\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(HYB)}} = -14.30\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(HYB)}} = 0.05\\,$.\n- 案例 2 (铂 (Pt) $(100)$):\n  - $\\,N_{\\mathrm{layers}} = 9\\,$, $\\,A = 50.0\\,\\text{\\AA}^2\\,$, $\\,\\gamma_{\\mathrm{ref}} = 2.60\\,\\mathrm{J}/\\mathrm{m}^2\\,$.\n  - PBE: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(PBE)}} = -5.85\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(PBE)}} = -37.67\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(PBE)}} = 0.15\\,$.\n  - SCAN: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(SCAN)}} = -6.10\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(SCAN)}} = -38.05\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(SCAN)}} = 0.12\\,$.\n  - HYB: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(HYB)}} = -6.25\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(HYB)}} = -38.13\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(HYB)}} = 0.08\\,$.\n- 案例 3 (二氧化钛 (TiO$_2$) $(110)$):\n  - $\\,N_{\\mathrm{layers}} = 6\\,$, $\\,A = 65.0\\,\\text{\\AA}^2\\,$, $\\,\\gamma_{\\mathrm{ref}} = 1.25\\,\\mathrm{J}/\\mathrm{m}^2\\,$.\n  - PBE: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(PBE)}} = -15.20\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(PBE)}} = -83.09\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(PBE)}} = 0.25\\,$.\n  - SCAN: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(SCAN)}} = -16.00\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(SCAN)}} = -85.46\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(SCAN)}} = 0.20\\,$.\n  - HYB: $\\,E_{\\mathrm{bulk,layer}}^{\\mathrm{(HYB)}} = -16.40\\,\\mathrm{eV}\\,$, $\\,E_{\\mathrm{slab}}^{\\mathrm{(HYB)}} = -87.05\\,\\mathrm{eV}\\,$, $\\,r^{\\mathrm{(HYB)}} = 0.15\\,$.\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身也是一个用方括号括起来的逗号分隔列表，顺序为 $[\\gamma_{\\mathrm{PBE}}, \\gamma_{\\mathrm{SCAN}}, \\gamma_{\\mathrm{HYB}}, \\text{best\\_index}, \\text{best\\_abs\\_error}, \\text{MAE}]$。其中，所有 $\\,\\gamma\\,$ 和误差值均以 $\\,\\mathrm{J}/\\mathrm{m}^2\\,$ 为单位，四舍五入到三位小数，而 $\\,\\text{best\\_index}\\,$ 是 $\\{0,1,2\\}$ 中的一个整数。\n例如，输出结构必须如下所示：\n$[[x_{11},x_{12},x_{13},i_1,e_1,m_1],[x_{21},x_{22},x_{23},i_2,e_2,m_2],[x_{31},x_{32},x_{33},i_3,e_3,m_3]]$，\n其中每个 $\\,x_{jk}\\,$、$\\,e_j\\,$ 和 $\\,m_j\\,$ 都是以 $\\,\\mathrm{J}/\\mathrm{m}^2\\,$ 为单位且四舍五入到三位小数的浮点数。",
            "solution": "所述问题在科学上是合理的、定义清晰的，并包含了解决该问题所需的所有信息。它完全属于计算材料科学领域，是评估不同密度泛函理论 (DFT) 交换相关 (XC) 泛函性能的一个标准且有效的练习。因此，我们可以着手制定一个有原则的解决方案。\n\n我们关注的主要物理量是表面能，用符号 $\\gamma$ 表示。它被定义为表面相对于块体的单位面积过剩吉布斯自由能。在温度 $T=0\\,\\mathrm{K}$ 时（DFT 计算通常在此温度下进行），这等同于单位面积的过剩内能。其定义由解理块体晶体以产生新表面所需的可逆功给出。对于对称平板模型，其中创建了两个等效表面，未弛豫的表面能 $\\gamma_{\\mathrm{unrelaxed}}$ 是使用 DFT 计算的总能量来计算的。\n\n包含 $N_{\\mathrm{layers}}$ 层的平板总能量为 $E_{\\mathrm{slab}}^{\\mathrm{(XC)}}$。为了找出由表面引起的过剩能量，我们必须减去等效数量的原子或化学式单元在块体晶体中构型时的能量。问题提供了每层块体的能量 $E_{\\mathrm{bulk,layer}}^{\\mathrm{(XC)}}$。因此，与平板含有相同物质的量的参考块体材料的能量为 $E_{\\mathrm{bulk,eq}} = N_{\\mathrm{layers}} \\times E_{\\mathrm{bulk,layer}}^{\\mathrm{(XC)}}$。\n\n与创建平板相关的总过剩能量是平板能量与等效块体材料能量之差：\n$$\n\\Delta E^{\\mathrm{(XC)}} = E_{\\mathrm{slab}}^{\\mathrm{(XC)}} - E_{\\mathrm{bulk,eq}} = E_{\\mathrm{slab}}^{\\mathrm{(XC)}} - N_{\\mathrm{layers}} \\times E_{\\mathrm{bulk,layer}}^{\\mathrm{(XC)}}\n$$\n这个过剩能量 $\\Delta E^{\\mathrm{(XC)}}$ 归因于创建了两个表面，每个表面的面积为 $A$。总的新表面积为 $s \\times A$，问题中指定 $s=2$。因此，未弛豫的表面能是每单位创建表面积的过剩能量：\n$$\n\\gamma_{\\mathrm{unrelaxed}}^{\\mathrm{(XC)}} = \\frac{\\Delta E^{\\mathrm{(XC)}}}{sA} = \\frac{E_{\\mathrm{slab}}^{\\mathrm{(XC)}} - N_{\\mathrm{layers}} \\times E_{\\mathrm{bulk,layer}}^{\\mathrm{(XC)}}}{2A}\n$$\n使用所提供的数据进行的计算得出 $\\gamma_{\\mathrm{unrelaxed}}^{\\mathrm{(XC)}}$ 的单位是电子伏特/平方埃 ($\\mathrm{eV}/\\text{\\AA}^2$)。\n\n该值对应于原子位置与块体晶体中完全相同的平板，即未弛豫或理想解理状态。实际上，表面附近的原子会移动（弛豫）到新的平衡位置，以最小化平板的总能量。这种结构弛豫总是会降低平板的总能量，从而降低表面能。问题通过弛豫分数 $r^{\\mathrm{(XC)}}$ 来量化此效应，该分数代表弛豫后表面能的分数减少量。因此，弛豫后的表面能 $\\gamma_{\\mathrm{relaxed}}^{\\mathrm{(XC)}}$ 计算如下：\n$$\n\\gamma_{\\mathrm{relaxed}}^{\\mathrm{(XC)}} = \\gamma_{\\mathrm{unrelaxed}}^{\\mathrm{(XC)}} \\times (1 - r^{\\mathrm{ (XC)}})\n$$\n为了将这些理论值与实验或更高级别理论的参考值 $\\gamma_{\\mathrm{ref}}$ 进行比较，我们必须确保单位一致。计算出的表面能必须从 $\\mathrm{eV}/\\text{\\AA}^2$ 转换为焦耳/平方米 ($\\mathrm{J}/\\mathrm{m}^2$)。转换因子由所提供的基本常数导出：\n$$\n\\text{Conversion Factor} = \\frac{1\\,\\mathrm{eV}}{1\\,\\text{\\AA}^2} = \\frac{1.602176634 \\times 10^{-19}\\,\\mathrm{J}}{(1 \\times 10^{-10}\\,\\mathrm{m})^2} = \\frac{1.602176634 \\times 10^{-19}\\,\\mathrm{J}}{1 \\times 10^{-20}\\,\\mathrm{m}^2} = 16.02176634\\,\\frac{\\mathrm{J}/\\mathrm{m}^2}{\\mathrm{eV}/\\text{\\AA}^2}\n$$\n对于每个测试用例和每种泛函 (XC = PBE, SCAN, HYB)，我们计算以 $\\mathrm{J}/\\mathrm{m}^2$ 为单位的 $\\gamma_{\\mathrm{relaxed}}^{\\mathrm{(XC)}}$。然后，我们通过计算绝对误差来评估每种泛函相对于参考值 $\\gamma_{\\mathrm{ref}}$ 的性能：\n$$\n\\text{AE}^{\\mathrm{(XC)}} = |\\gamma_{\\mathrm{relaxed}}^{\\mathrm{(XC)}} - \\gamma_{\\mathrm{ref}}|\n$$\n对于给定的案例，性能最佳的泛函是绝对误差最小的那个。其索引报告为 PBE 的 $0$、SCAN 的 $1$ 或 HYB 的 $2$。最小绝对误差本身也会被报告。最后，该测试用例中三种泛函的平均绝对误差 (MAE) 提供了其集体性能的摘要指标：\n$$\n\\text{MAE} = \\frac{1}{3} \\sum_{\\mathrm{XC}} \\text{AE}^{\\mathrm{(XC)}} = \\frac{\\text{AE}^{\\mathrm{ (PBE)}} + \\text{AE}^{\\mathrm{(SCAN)}} + \\text{AE}^{\\mathrm{(HYB)}}}{3}\n$$\n所有最终的能量和误差值都应四舍五入到三位小数。算法流程是遍历每个测试用例，对三种泛函中的每一种应用这些物理公式和基准测试步骤，并按规定格式化结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates and benchmarks surface energies for different XC functionals.\n    \"\"\"\n    # Define physical constants for unit conversion\n    EV_TO_JOULE = 1.602176634e-19\n    ANGSTROM_SQ_TO_METER_SQ = 1e-20\n    # Conversion factor from eV/Å² to J/m²\n    CONVERSION_FACTOR = EV_TO_JOULE / ANGSTROM_SQ_TO_METER_SQ\n    \n    # Number of surfaces created in the symmetric slab model\n    S_SURFACES = 2.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N_layers, A, gamma_ref, functional_data)\n    # functional_data is a list of tuples: [(E_slab, E_bulk_layer, r), ...] for PBE, SCAN, HYB\n    test_cases = [\n        # Case 1 (Copper (Cu) (111))\n        (7, 52.4, 1.85, [\n            (-14.27, -3.72, 0.10),  # PBE\n            (-14.57, -3.95, 0.08),  # SCAN\n            (-14.30, -4.10, 0.05)   # HYB\n        ]),\n        # Case 2 (Platinum (Pt) (100))\n        (9, 50.0, 2.60, [\n            (-37.67, -5.85, 0.15),  # PBE\n            (-38.05, -6.10, 0.12),  # SCAN\n            (-38.13, -6.25, 0.08)   # HYB\n        ]),\n        # Case 3 (Titanium dioxide (TiO2) (110))\n        (6, 65.0, 1.25, [\n            (-83.09, -15.20, 0.25), # PBE\n            (-85.46, -16.00, 0.20), # SCAN\n            (-87.05, -16.40, 0.15)  # HYB\n        ])\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n_layers, area_ang2, gamma_ref_jm2, functional_data = case\n        \n        relaxed_gammas_jm2 = []\n        \n        for e_slab_ev, e_bulk_layer_ev, r_frac in functional_data:\n            # 1. Compute the unrelaxed surface energy in eV/Å²\n            # gamma_unrelaxed = (E_slab - N_layers * E_bulk_layer) / (2 * A)\n            excess_energy_ev = e_slab_ev - n_layers * e_bulk_layer_ev\n            gamma_unrelaxed_ev_ang2 = excess_energy_ev / (S_SURFACES * area_ang2)\n            \n            # 2. Apply the fractional relaxation to get relaxed gamma in eV/Å²\n            gamma_relaxed_ev_ang2 = gamma_unrelaxed_ev_ang2 * (1.0 - r_frac)\n            \n            # 3. Convert the relaxed surface energy to J/m²\n            gamma_relaxed_jm2 = gamma_relaxed_ev_ang2 * CONVERSION_FACTOR\n            relaxed_gammas_jm2.append(gamma_relaxed_jm2)\n\n        # 4. Compute benchmarking metrics\n        relaxed_gammas = np.array(relaxed_gammas_jm2)\n        \n        # Absolute errors for each functional\n        abs_errors = np.abs(relaxed_gammas - gamma_ref_jm2)\n        \n        # Index of the best functional (smallest absolute error)\n        best_index = int(np.argmin(abs_errors))\n        \n        # The best absolute error\n        best_abs_error = abs_errors[best_index]\n        \n        # Mean Absolute Error (MAE) across the three functionals\n        mae = np.mean(abs_errors)\n        \n        # 5. Format the results for the current test case\n        # Round all gamma and error values to three decimal places.\n        case_result = [\n            round(relaxed_gammas[0], 3),\n            round(relaxed_gammas[1], 3),\n            round(relaxed_gammas[2], 3),\n            best_index,\n            round(best_abs_error, 3),\n            round(mae, 3)\n        ]\n        all_results.append(case_result)\n\n    # Format the final output string as specified\n    # The format must be exactly [[...],[...],[...]] without extra spaces\n    output_str = \"[\" + \",\".join([\n        f\"[{g_pbe:.3f},{g_scan:.3f},{g_hyb:.3f},{idx},{best_err:.3f},{m:.3f}]\"\n        for g_pbe, g_scan, g_hyb, idx, best_err, m in all_results\n    ]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}