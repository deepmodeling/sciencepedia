{
    "hands_on_practices": [
        {
            "introduction": "在平面波密度泛函理论计算中，平面波动能截断 $E_{\\text{cut}}$ 是一个决定计算精度和成本的关键参数。尽管单个系统的总能量随 $E_{\\text{cut}}$ 的增加收敛缓慢，但能量差（如吸附能）的收敛速度通常要快得多。这种现象源于误差对消，即在计算能量差时，各个组分总能量中的大部分数值误差会相互抵消。本练习  将通过一个吸附能计算模型，让你亲身体验如何确定达到目标精度所需的最小 $E_{\\text{cut}}$，从而掌握收敛性测试的基本方法。",
            "id": "3875446",
            "problem": "您的任务是量化平面波密度泛函理论（DFT）计算中，一氧化碳（CO）在铂（Pt(111)）表面吸附的基组收敛性，重点关注数值精度以及确定一个最小平面波动能截断值，以达到指定的容差。考虑基于组合体系和孤立体系总能量的吸附能定义，其中吸附能定义为 $E_{\\mathrm{ads}} = E_{\\mathrm{CO/Pt}} - (E_{\\mathrm{Pt}} + E_{\\mathrm{CO}})$，单位为电子伏特（eV）。对于动能截断值为 $E_{\\mathrm{cut}}$（单位为 eV）的平面波基组，将每个体系计算出的总能量建模为通过幂律形式的基组误差从上方收敛到其完备基组极限：\n- $E_{X}(E_{\\mathrm{cut}}) = E_{X}^{\\infty} + \\delta_{X}(E_{\\mathrm{cut}})$,\n- $\\delta_{X}(E_{\\mathrm{cut}}) = c_{X} \\, E_{\\mathrm{cut}}^{-p_{X}}$,\n其中 $X \\in \\{\\mathrm{CO/Pt}, \\mathrm{Pt}, \\mathrm{CO}\\}$，$c_{X} \\ge 0$ 且 $p_{X} > 0$。这里 $E_{X}^{\\infty}$ 表示完备基组能量（当 $E_{\\mathrm{cut}} \\to \\infty$ 时的极限）。由此，在有限截断值下的吸附能为\n$$\nE_{\\mathrm{ads}}(E_{\\mathrm{cut}}) = E_{\\mathrm{ads}}^{\\infty} + \\delta_{\\mathrm{CO/Pt}}(E_{\\mathrm{cut}}) - \\delta_{\\mathrm{Pt}}(E_{\\mathrm{cut}}) - \\delta_{\\mathrm{CO}}(E_{\\mathrm{cut}}),\n$$\n其中 $E_{\\mathrm{ads}}^{\\infty} = E_{\\mathrm{CO/Pt}}^{\\infty} - (E_{\\mathrm{Pt}}^{\\infty} + E_{\\mathrm{CO}}^{\\infty})$。\n\n您的程序必须：\n- 在离散的截断值网格 $[200, 300, 400, 500, 600, 700, 800]$ eV 上计算 $E_{\\mathrm{ads}}(E_{\\mathrm{cut}})$（即，在 $E_{\\mathrm{cut}} = 200, 300, 400, 500, 600, 700$ 和 $800$ 时，所有单位均为 eV）。\n- 对于下面的每个测试用例，确定所提供网格中的最小 $E_{\\mathrm{cut}}$，使得相对于最高截断值结果 $E_{\\mathrm{ads}}(800)$ 的吸附能绝对变化小于或等于 $0.010$ eV（即 $|E_{\\mathrm{ads}}(E_{\\mathrm{cut}}) - E_{\\mathrm{ads}}(800)| \\le 0.010$）。以 eV 为单位报告最小的 $E_{\\mathrm{cut}}$。\n\n使用以下参数值的测试套件。每个案例指定 $E_{\\mathrm{ads}}^{\\infty}$，$c_{\\mathrm{CO/Pt}}$，$p_{\\mathrm{CO/Pt}}$，$c_{\\mathrm{Pt}}$，$p_{\\mathrm{Pt}}$，$c_{\\mathrm{CO}}$，$p_{\\mathrm{CO}}$：\n- 案例 1（部分抵消的中等误差）：$E_{\\mathrm{ads}}^{\\infty} = -1.60$ eV，$c_{\\mathrm{CO/Pt}} = 200$，$p_{\\mathrm{CO/Pt}} = 1.6$，$c_{\\mathrm{Pt}} = 250$，$p_{\\mathrm{Pt}} = 1.5$，$c_{\\mathrm{CO}} = 80$，$p_{\\mathrm{CO}} = 2.0$。\n- 案例 2（由于强抵消导致的早期收敛）：$E_{\\mathrm{ads}}^{\\infty} = -1.75$ eV，$c_{\\mathrm{CO/Pt}} = 600$，$p_{\\mathrm{CO/Pt}} = 1.5$，$c_{\\mathrm{Pt}} = 580$，$p_{\\mathrm{Pt}} = 1.5$，$c_{\\mathrm{CO}} = 5$，$p_{\\mathrm{CO}} = 2.2$。\n- 案例 3（由吸附体系主导的缓慢收敛）：$E_{\\mathrm{ads}}^{\\infty} = -1.50$ eV，$c_{\\mathrm{CO/Pt}} = 400$，$p_{\\mathrm{CO/Pt}} = 1.4$，$c_{\\mathrm{Pt}} = 200$，$p_{\\mathrm{Pt}} = 2.5$，$c_{\\mathrm{CO}} = 50$，$p_{\\mathrm{CO}} = 2.0$。\n- 案例 4（仅在最高截断值处满足阈值）：$E_{\\mathrm{ads}}^{\\infty} = -2.00$ eV，$c_{\\mathrm{CO/Pt}} = 1000$，$p_{\\mathrm{CO/Pt}} = 1.3$，$c_{\\mathrm{Pt}} = 100$，$p_{\\mathrm{Pt}} = 1.3$，$c_{\\mathrm{CO}} = 50$，$p_{\\mathrm{CO}} = 1.3$。\n\n物理和数值单位：\n- 所有能量必须以 eV 为单位处理和解释。\n- 以 eV 为单位报告最小截断值，作为数值。\n- 不涉及角度。\n- 容差为 $0.010$ eV，对应于 $10$ meV。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个案例的最小截断值，格式为方括号内以逗号分隔的列表，每个元素是以 eV 为单位的数字，例如 $[500,200,700,800]$。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于计算材料科学的原理，特别是密度泛函理论（DFT）的计算。该问题是适定的，为每个测试用例提供了清晰的数学模型、一套完整的参数以及明确的目标。术语客观而精确，设置内部一致且无矛盾。\n\n任务是确定所需的最小平面波动能截断值 $E_{\\text{cut}}$，以便将计算出的吸附能 $E_{\\mathrm{ads}}$ 收敛到指定的数值容差内。这是计算研究中的一个标准且关键的程序，通过平衡计算成本和精度来确保结果的数值准确性。\n\n吸附能 $E_{\\mathrm{ads}}$ 定义为组合体系（吸附物在基底上）的总能量与孤立组分能量之和的差：\n$$E_{\\mathrm{ads}} = E_{\\mathrm{CO/Pt}} - (E_{\\mathrm{Pt}} + E_{\\mathrm{CO}})$$\n在任何使用有限基组（例如 DFT 中的平面波基组）的实际计算中，任何体系 $X$ 计算出的总能量，记为 $E_{X}(E_{\\text{cut}})$，都会偏离其真实的完备基组极限 $E_{X}^{\\infty}$。这个偏差就是基组不完备性误差，$\\delta_{X}(E_{\\text{cut}})$。问题为该误差提供了一个基于经验的幂律模型，该模型依赖于动能截断值 $E_{\\text{cut}}$：\n$$E_{X}(E_{\\text{cut}}) = E_{X}^{\\infty} + \\delta_{X}(E_{\\text{cut}})$$\n其中误差项由下式给出：\n$$\\delta_{X}(E_{\\text{cut}}) = c_{X} \\, E_{\\text{cut}}^{-p_{X}}$$\n参数 $c_X$ 和 $p_X$ 取决于体系 $X$ 和计算的具体细节（例如，赝势）。对于所涉及的三个体系——一氧化碳在铂板上的组合体系（$X = \\mathrm{CO/Pt}$）、裸铂板（$X = \\mathrm{Pt}$）和孤立的一氧化碳分子（$X = \\mathrm{CO}$）——在有限截断值 $E_{\\text{cut}}$ 下的吸附能可以表示为：\n$$E_{\\mathrm{ads}}(E_{\\text{cut}}) = E_{\\mathrm{CO/Pt}}(E_{\\text{cut}}) - (E_{\\mathrm{Pt}}(E_{\\text{cut}}) + E_{\\mathrm{CO}}(E_{\\text{cut}}))$$\n$$E_{\\mathrm{ads}}(E_{\\text{cut}}) = (E_{\\mathrm{CO/Pt}}^{\\infty} + \\delta_{\\mathrm{CO/Pt}}(E_{\\text{cut}})) - ((E_{\\mathrm{Pt}}^{\\infty} + \\delta_{\\mathrm{Pt}}(E_{\\text{cut}})) + (E_{\\mathrm{CO}}^{\\infty} + \\delta_{\\mathrm{CO}}(E_{\\text{cut}})))$$\n通过重新排列并代入定义 $E_{\\mathrm{ads}}^{\\infty} = E_{\\mathrm{CO/Pt}}^{\\infty} - (E_{\\mathrm{Pt}}^{\\infty} + E_{\\mathrm{CO}}^{\\infty})$，我们得到了吸附能作为截断值函数的工作方程：\n$$E_{\\mathrm{ads}}(E_{\\text{cut}}) = E_{\\mathrm{ads}}^{\\infty} + \\delta_{\\mathrm{CO/Pt}}(E_{\\text{cut}}) - \\delta_{\\mathrm{Pt}}(E_{\\text{cut}}) - \\delta_{\\mathrm{CO}}(E_{\\text{cut}})$$\n将误差项的幂律形式代入，得到待计算的最终表达式：\n$$E_{\\mathrm{ads}}(E_{\\text{cut}}) = E_{\\mathrm{ads}}^{\\infty} + c_{\\mathrm{CO/Pt}} E_{\\text{cut}}^{-p_{\\mathrm{CO/Pt}}} - c_{\\mathrm{Pt}} E_{\\text{cut}}^{-p_{\\mathrm{Pt}}} - c_{\\mathrm{CO}} E_{\\text{cut}}^{-p_{\\mathrm{CO}}}$$\n目标是从离散的值网格 $\\{200, 300, 400, 500, 600, 700, 800\\}$ eV 中找到最小的 $E_{\\text{cut}}$，使得计算出的吸附能充分收敛。收敛性是相对于网格中最高截断值 $E_{\\mathrm{cut,max}} = 800$ eV 下获得的值进行测试的，该值作为可用的最佳参考值 $E_{\\mathrm{ads,ref}}$。收敛标准是一个绝对容差，$\\tau = 0.010$ eV：\n$$|E_{\\mathrm{ads}}(E_{\\text{cut}}) - E_{\\mathrm{ads,ref}}| \\le \\tau$$\n其中 $E_{\\mathrm{ads,ref}} = E_{\\mathrm{ads}}(800)$。\n\n对于每个测试用例，算法按以下步骤进行：\n1.  案例的参数（$E_{\\mathrm{ads}}^{\\infty}$, $c_{\\mathrm{CO/Pt}}$, $p_{\\mathrm{CO/Pt}}$, $c_{\\mathrm{Pt}}$, $p_{\\mathrm{Pt}}$, $c_{\\mathrm{CO}}$, $p_{\\mathrm{CO}}$）用于定义特定的函数 $E_{\\mathrm{ads}}(E_{\\text{cut}})$。\n2.  参考能量 $E_{\\mathrm{ads,ref}}$ 通过在 $E_{\\mathrm{cut}} = 800$ eV 处计算该函数得到。\n3.  算法按升序遍历截断值网格 $E_{\\mathrm{cut}} \\in \\{200, 300, 400, 500, 600, 700, 800\\}$ eV。\n4.  对于网格中的每个 $E_{\\mathrm{cut}}$，计算 $E_{\\mathrm{ads}}(E_{\\mathrm{cut}})$，并将其绝对差 $|E_{\\mathrm{ads}}(E_{\\mathrm{cut}}) - E_{\\mathrm{ads,ref}}|$ 与容差 $\\tau = 0.010$ eV 进行比较。\n5.  第一个满足不等式的 $E_{\\mathrm{cut}}$ 值即为该案例所需的最小截断值。该值被记录下来。\n对所有四个测试用例重复此过程，并汇总所得的最小截断值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimal plane-wave kinetic energy cutoff for four test cases\n    of CO adsorption on Pt(111), based on a provided convergence model.\n    \"\"\"\n    \n    # Define the discrete grid of cutoff energies in eV.\n    cutoff_grid = [200, 300, 400, 500, 600, 700, 800]\n    \n    # Define the convergence tolerance in eV.\n    tolerance = 0.010\n    \n    # Define the parameter sets for the four test cases.\n    # Format: (E_ads_inf, c_comp, p_comp, c_surf, p_surf, c_gas, p_gas)\n    # where comp=CO/Pt, surf=Pt, gas=CO.\n    test_cases = [\n        # Case 1: Moderate errors with partial cancellation\n        (-1.60, 200, 1.6, 250, 1.5, 80, 2.0),\n        # Case 2: Early convergence due to strong cancellation\n        (-1.75, 600, 1.5, 580, 1.5, 5, 2.2),\n        # Case 3: Slow convergence dominated by adsorbed system\n        (-1.50, 400, 1.4, 200, 2.5, 50, 2.0),\n        # Case 4: Threshold met only at highest cutoff\n        (-2.00, 1000, 1.3, 100, 1.3, 50, 1.3)\n    ]\n\n    def calculate_e_ads(e_cut, params):\n        \"\"\"\n        Calculates the adsorption energy for a given cutoff and parameter set.\n        \n        Args:\n            e_cut (float): The kinetic energy cutoff in eV.\n            params (tuple): A tuple containing the model parameters:\n                            (E_ads_inf, c_CO/Pt, p_CO/Pt, c_Pt, p_Pt, c_CO, p_CO).\n        \n        Returns:\n            float: The calculated adsorption energy in eV.\n        \"\"\"\n        e_ads_inf, c_comp, p_comp, c_surf, p_surf, c_gas, p_gas = params\n        \n        e_ads = (e_ads_inf +\n                 c_comp * e_cut**(-p_comp) -\n                 c_surf * e_cut**(-p_surf) -\n                 c_gas * e_cut**(-p_gas))\n        return e_ads\n\n    results = []\n    \n    # Process each test case\n    for case_params in test_cases:\n        # Calculate the reference adsorption energy at the highest cutoff\n        e_ads_ref = calculate_e_ads(cutoff_grid[-1], case_params)\n        \n        minimal_cutoff_found = False\n        for e_cut in cutoff_grid:\n            # Calculate the adsorption energy at the current cutoff\n            e_ads_current = calculate_e_ads(e_cut, case_params)\n            \n            # Check if the convergence criterion is met\n            if np.abs(e_ads_current - e_ads_ref) = tolerance:\n                results.append(e_cut)\n                minimal_cutoff_found = True\n                break\n        \n        # This case should not be entered given problem structure,\n        # as the highest cutoff always satisfies the condition.\n        if not minimal_cutoff_found:\n             # Fallback, theoretically unreachable\n            results.append(cutoff_grid[-1])\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "实际的量子化学计算往往涉及多个需要同时收敛的数值参数。本练习将探讨功函数（一个关键的表面物理性质）的计算，它同时对真空层厚度 $L$ 和布里渊区采样的 $k$ 点网格密度敏感。为了模拟真实研究中的决策过程，我们引入了一个简化的计算成本模型，挑战你不仅要达到所需的精度，还要以最低的计算代价实现这一目标。通过这个练习 ，你将学会在多维参数空间中寻找兼顾精度与效率的最佳计算设置。",
            "id": "3875442",
            "problem": "考虑在密度泛函理论 (DFT) 中使用板坯模型（slab geometry）模拟的金属表面。功函数由基本关系 $ \\phi = V_{\\mathrm{vac}} - E_{F} $ 定义，其中 $ \\phi $ 是功函数，$ V_{\\mathrm{vac}} $ 是远离表面的真空区域中的静电势，$ E_{F} $ 是板坯的费米能级。在周期性板坯计算中，有限的真空层间距和布里渊区 (BZ) 采点会引入数值误差，从而使 $ \\phi $ 产生偏差，这些误差可以从静电学和数值积分的第一性原理来理解。\n\n根据针对表面偶极子周期性阵列的泊松方程以及金属的屏蔽性质，势中的有限真空相互作用误差随真空层间距 $ L $ 呈指数衰减，即 $ \\Delta \\phi_{\\mathrm{vac}}(L) \\propto \\exp(-\\alpha L) $，其中 $ \\alpha $ 是一个由倏逝波模式和材料响应决定的衰减常数。根据针对光滑周期被积函数的数值求积理论，对于具有良好行为费米面的金属，在二维布里渊区中进行 k 点采样的误差，对于边长为 $ N $ 的方形 k 点网格（一个 $ N \\times N $ 的网格），其标度关系为幂律 $ \\Delta \\phi_{k}(N) \\propto N^{-p} $，其中对于应用于光滑函数的梯形或辛普森型法则，$ p \\ge 2 $。在没有其他强耦合效应的情况下，领头阶组合误差可以近似地相加为\n$$\n\\Delta \\phi(L,N) \\approx A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p},\n$$\n其中 $ A $、$ \\alpha $、$ B $ 和 $ p $ 是依赖于材料和方法的常数。\n\n假设一个物理上真实的金(111)表面 Au(111) 的代理模型，其渐近收敛功函数为 $ \\phi_{\\infty} $，并校准了常数以反映典型的金属板坯行为：\n- $ \\phi_{\\infty} = 5.310 \\text{ eV} $，\n- $ A = 0.200 \\text{ eV} $，\n- $ \\alpha = 0.400 \\text{ \\AA}^{-1} $，\n- $ B = 0.120 \\text{ eV} $，\n- $ p = 2 $。\n\n假设在有限的 $ L $ 和 $ N $ 下计算出的功函数由以下模型描述\n$$\n\\phi(L,N) = \\phi_{\\infty} + \\Delta \\phi(L,N) = \\phi_{\\infty} + A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p}.\n$$\n假设一个简单的计算成本模型，该模型反映了平面波板坯计算中的主要标度贡献，\n$$\nC(L,N) = c_{k} \\, N^{2} + c_{L} \\, L,\n$$\n其中 $ c_{k} = 1.0 $（任意单位/每平方 k 网格边长）和 $ c_{L} = 0.5 $（任意单位/每埃真空层）。\n\n任务：给定候选的真空层间距 $ L $（单位为埃）和 k 网格边长 $ N $（无量纲）的集合，以及一个绝对精度目标 $ \\epsilon $（单位为电子伏特），绘制收敛景观图 $ \\phi(L,N) $，并找出满足 $ |\\phi(L,N) - \\phi_{\\infty}| \\le \\epsilon $ 且最小化成本 $ C(L,N) $ 的最小计算设置 $ (L,N) $。如果有多个 $ (L,N) $ 对以相同的最小成本满足精度目标，则通过选择较小的 $ N $ 来打破平局，然后选择较小的 $ L $。如果没有候选设置满足精度目标，则返回一个表示不可行的哨兵结果。\n\n物理单位和舍入要求：\n- 所有功函数和绝对误差均以电子伏特 (eV) 为单位报告，并四舍五入到 $ 10^{-3} $ eV。\n- 真空层间距 $ L $ 的单位是埃 ($ \\text{\\AA} $)。\n- 成本 $ C $ 以任意单位计，四舍五入到 $ 10^{-3} $。\n\n带有覆盖范围的测试套件：\n- 情况 1（一般正常路径）：$ L \\in \\{6,8,10,12,15\\} $ $ \\text{\\AA} $，$ N \\in \\{4,6,8,10,12\\} $，$ \\epsilon = 0.010 \\text{ eV} $。\n- 情况 2（不可行性边界情况）：$ L \\in \\{6,7,8\\} $ $ \\text{\\AA} $，$ N \\in \\{3,4,5\\} $，$ \\epsilon = 0.008 \\text{ eV} $。\n- 情况 3（边界相等情况）：$ L \\in \\{8,10\\} $ $ \\text{\\AA} $，$ N \\in \\{10,12\\} $，$ \\epsilon = 0.00935244 \\text{ eV} $。\n\n要求的最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个项目本身是一个逗号分隔的列表 $ [L,N,\\phi,e,C] $，分别代表真空层间距 $ L $ ($ \\text{\\AA} $)、k 网格边长 $ N $、计算出的功函数 $ \\phi $（eV，四舍五入到 $ 10^{-3} $ eV）、绝对误差 $ e = |\\phi - \\phi_{\\infty}| $（eV，四舍五入到 $ 10^{-3} $ eV）和计算成本 $ C $（任意单位，四舍五入到 $ 10^{-3} $）。如果没有组合满足目标，则返回 $ [-1,-1,-1,-1,-1] $。对于给定的测试套件，输出应为单行，类似于\n$ [[L_{1},N_{1},\\phi_{1},e_{1},C_{1}],[L_{2},N_{2},\\phi_{2},e_{2},C_{2}],[L_{3},N_{3},\\phi_{3},e_{3},C_{3}]] $，\n其中的数值由您的计算填充。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 第1步：提取给定信息\n\n明确提供了以下数据和模型：\n- **功函数定义**：$ \\phi = V_{\\mathrm{vac}} - E_{F} $\n- **组合误差模型**：对于给定的真空层间距 $ L $ 和 $ N \\times N $ 的 k 网格边长，计算出的功函数 $ \\phi(L,N) $ 建模为 $ \\phi(L,N) = \\phi_{\\infty} + \\Delta \\phi(L,N) $，其中 $ \\Delta \\phi(L,N) $ 是可加误差。\n- **误差公式**：$ \\Delta \\phi(L,N) \\approx A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p} $\n- **模型参数**：\n  - 收敛功函数：$ \\phi_{\\infty} = 5.310 \\text{ eV} $\n  - 误差系数 $ A = 0.200 \\text{ eV} $\n  - 误差衰减常数 $ \\alpha = 0.400 \\text{ \\AA}^{-1} $\n  - 误差系数 $ B = 0.120 \\text{ eV} $\n  - 误差指数 $ p = 2 $\n- **计算成本模型**：$ C(L,N) = c_{k} \\, N^{2} + c_{L} \\, L $\n- **成本参数**：\n  - k 网格成本因子：$ c_{k} = 1.0 $ (任意单位/($k$-网格边长)$^2$)\n  - 真空成本因子：$ c_{L} = 0.5 $ (任意单位/$\\text{\\AA}$)\n- **任务目标**：给定 $ L $ 和 $ N $ 的候选值集合以及一个绝对精度目标 $ \\epsilon $，找到既满足精度标准 $ |\\phi(L,N) - \\phi_{\\infty}| \\le \\epsilon $ 又最小化计算成本 $ C(L,N) $ 的配对 $ (L,N) $。\n- **平局打破规则**：对于相同的最小成本，通过选择较小的 $ N $，然后选择较小的 $ L $ 来打破平局。\n- **不可行性条件**：如果没有 $ (L,N) $ 对满足精度目标，必须返回一个哨兵结果 $ [-1,-1,-1,-1,-1] $。\n- **舍入和单位**：所有功函数 $ \\phi $、绝对误差 $ e $ 和成本 $ C $ 的最终值都应四舍五入到 $ 10^{-3} $（三位小数）。$ L $ 的单位是埃 ($ \\text{\\AA} $)，$ N $ 是无量纲的。\n- **测试套件**：\n  - 情况 1：$ L \\in \\{6,8,10,12,15\\} $ $ \\text{\\AA} $，$ N \\in \\{4,6,8,10,12\\} $，$ \\epsilon = 0.010 \\text{ eV} $。\n  - 情况 2：$ L \\in \\{6,7,8\\} $ $ \\text{\\AA} $，$ N \\in \\{3,4,5\\} $，$ \\epsilon = 0.008 \\text{ eV} $。\n  - 情况 3：$ L \\in \\{8,10\\} $ $ \\text{\\AA} $，$ N \\in \\{10,12\\} $，$ \\epsilon = 0.00935244 \\text{ eV} $。\n\n### 第2步：使用提取的给定信息进行验证\n\n根据验证标准对问题进行评估：\n- **科学基础**：该问题在计算材料科学，特别是密度泛函理论 (DFT) 的原理方面有很好的基础。表面相互作用误差随真空间距呈指数衰减以及布里渊区积分误差呈幂律衰减，是用于分析板坯计算收敛性的标准、有物理动机的模型。成本函数 $ C(L,N) $ 正确反映了平面波 DFT 代码的主要标度行为。所有提供的参数对于像 Au(111) 这样的金属体系都是物理上合理的。\n- **适定性**：该问题在数学上是适定的。它提供了所有必要的函数、参数和约束。目标明确定义（在精度约束下最小化成本），并且平局打破规则确保对于任何有效的输入集都存在唯一解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述，没有任何主观或推测性元素。\n\n该问题没有表现出任何列举的缺陷（例如，科学上不健全、不完整、模棱两可）。它代表了计算研究中遇到的一个标准优化任务。\n\n### 第3步：结论和行动\n\n该问题是**有效的**。将制定一个解决方案。\n\n### 解决方案推导\n\n任务是从一个离散的候选集合中找到一对最优的计算参数 $ (L, N) $，它在满足误差约束的同时最小化成本函数。对于每个测试用例，将通过系统地评估所有可能的配对来获得解决方案。\n\n控制方程定义如下：\n计算出的功函数由下式给出：\n$$ \\phi(L,N) = \\phi_{\\infty} + A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p} $$\n代入给定常数：\n$$ \\phi(L,N) = 5.310 + 0.200 \\,\\mathrm{e}^{-0.400 L} + 0.120 \\, N^{-2} $$\n\n相对于收敛值 $ \\phi_{\\infty} $ 的绝对误差 $ e(L,N) $ 是：\n$$ e(L,N) = |\\phi(L,N) - \\phi_{\\infty}| = |A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p}| $$\n由于 $ A $、$ B $、$ L $ 和 $ N $ 都是正数，绝对值内的表达式总是正的。因此，误差就是：\n$$ e(L,N) = A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p} = 0.200 \\,\\mathrm{e}^{-0.400 L} + 0.120 \\, N^{-2} $$\n精度约束是 $ e(L,N) \\le \\epsilon $。\n\n计算成本函数是：\n$$ C(L,N) = c_{k} \\, N^{2} + c_{L} \\, L $$\n代入给定常数：\n$$ C(L,N) = 1.0 \\, N^{2} + 0.5 \\, L $$\n\n为每个测试用例解决问题的算法如下：\n1.  初始化一个空列表 `valid_candidates`，用于存储满足精度要求的配置参数。\n2.  对于一个给定的测试用例，包含 $ L $ 和 $ N $ 的候选集以及目标精度 $ \\epsilon $，遍历所有可能的配对 $ (L, N) $。\n3.  对于每个配对，计算误差 $ e(L,N) $。\n4.  如果 $ e(L,N) \\leq \\epsilon $，则该配对是一个有效候选。计算其相关成本 $ C(L,N) $，并将元组 $ (C, N, L) $ 存储在 `valid_candidates` 列表中。以这个顺序存储元组有助于根据平局打破规则进行排序。\n5.  检查完所有配对后，检查 `valid_candidates` 列表。\n    a. 如果列表为空，则没有参数组合满足精度目标。该测试用例的问题是不可行的，记录哨兵结果 $ [-1,-1,-1,-1,-1] $。\n    b. 如果列表包含一个或多个候选，则按升序对其进行排序。由于元组结构是 $ (C, N, L) $，这会自动先按成本排序，然后按 $ N $，再按 $ L $，正确实现了指定的平局打破逻辑。\n6.  排序后列表的第一个元素 $ (C^*, N^*, L^*) $ 代表最优配置。\n7.  使用最优参数 $ L^* $ 和 $ N^* $，计算最终量：\n    - 计算出的功函数 $ \\phi(L^*, N^*) $。\n    - 绝对误差 $ e(L^*, N^*) $。\n    - 计算成本 $ C(L^*, N^*) $。\n8.  按照要求，将计算出的 $ \\phi $、$ e $ 和 $ C $ 的值四舍五入到 $ 10^{-3} $。\n9.  将该测试用例的最终结果格式化为列表 $ [L^*, N^*, \\phi, e, C] $。\n\n这个过程是确定性的，保证能根据问题的标准为每个测试用例找到唯一的最优解。它将为提供的测试套件实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding optimal computational parameters (L, N)\n    for DFT slab calculations based on a given error and cost model.\n    \"\"\"\n\n    # --- Model Constants ---\n    PHI_INF = 5.310  # Converged work function in eV\n    A = 0.200        # Error coefficient in eV\n    ALPHA = 0.400    # Error decay constant in 1/Angstrom\n    B = 0.120        # Error coefficient in eV\n    P = 2            # Error exponent\n    C_K = 1.0        # k-mesh cost factor\n    C_L = 0.5        # Vacuum cost factor\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"L_set\": [6, 8, 10, 12, 15],\n            \"N_set\": [4, 6, 8, 10, 12],\n            \"epsilon\": 0.010\n        },\n        {\n            \"L_set\": [6, 7, 8],\n            \"N_set\": [3, 4, 5],\n            \"epsilon\": 0.008\n        },\n        {\n            \"L_set\": [8, 10],\n            \"N_set\": [10, 12],\n            \"epsilon\": 0.00935244\n        }\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        L_set = case[\"L_set\"]\n        N_set = case[\"N_set\"]\n        epsilon = case[\"epsilon\"]\n\n        valid_candidates = []\n\n        for L in L_set:\n            for N in N_set:\n                # Calculate the absolute error\n                error = A * np.exp(-ALPHA * L) + B * (N ** -P)\n\n                # Check if the accuracy target is met\n                if error = epsilon:\n                    # Calculate the computational cost\n                    cost = C_K * (N ** 2) + C_L * L\n                    # Store as (cost, N, L) for sorting\n                    valid_candidates.append((cost, N, L))\n\n        if not valid_candidates:\n            # No valid configuration found\n            final_results.append([-1, -1, -1.0, -1.0, -1.0])\n        else:\n            # Sort to find the minimum cost, with tie-breaking N then L\n            valid_candidates.sort()\n            best_cost, best_N, best_L = valid_candidates[0]\n\n            # Recalculate final values for the optimal (L, N) pair\n            optimal_error = A * np.exp(-ALPHA * best_L) + B * (best_N ** -P)\n            optimal_phi = PHI_INF + optimal_error\n            optimal_cost = C_K * (best_N ** 2) + C_L * best_L\n\n            # Round values to 3 decimal places\n            phi_rounded = round(optimal_phi, 3)\n            error_rounded = round(optimal_error, 3)\n            cost_rounded = round(optimal_cost, 3)\n\n            final_results.append([best_L, best_N, phi_rounded, error_rounded, cost_rounded])\n\n    # --- Format and Print Final Output ---\n    # The output format must be a list of lists, represented as a string.\n    # e.g., [[L1,N1,phi1,e1,C1],[L2,N2,phi2,e2,C2]]\n    result_strings = []\n    for res in final_results:\n        if res[0] == -1:\n            # Sentinel case\n            result_strings.append(\"[-1,-1,-1.000,-1.000,-1.000]\")\n        else:\n            L, N, phi, e, C = res\n            result_strings.append(f\"[{L},{N},{phi:.3f},{e:.3f},{C:.3f}]\")\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "误差对消是计算催化领域能够以可接受的成本获得高精度能量差的关键。前面的练习让你直观感受了其效果，而本练习将引导你对其进行定量分析。我们将深入探究计算误差的来源，并考察反应物和产物之间误差行为的相似性如何决定最终反应能的准确性。在这个练习  中，你将使用一个精细的参数化模型，计算吸附能的绝对误差，并将其与各组分总能量的误差进行比较，最终得出一个“误差对消比”，从而深刻理解这一使高精度计算成为可能的核心原理。",
            "id": "3875307",
            "problem": "请考虑与铂（111）表面氢吸附相关的三个体系的玻恩–奥本海默电子能量 $E$：一个洁净的周期性铂板、一个孤立的氢原子，以及吸附了一个氢原子的铂板。将洁净铂板的能量记为 $E_{\\mathrm{S}}$，孤立氢原子的能量记为 $E_{\\mathrm{H}}$，吸附有氢原子的铂板能量记为 $E_{\\mathrm{SH}}$，吸附能记为 $\\Delta E_{\\mathrm{ads}} \\equiv E_{\\mathrm{SH}} - E_{\\mathrm{S}} - E_{\\mathrm{H}}$。在计算催化学中，这些量通过电子结构方法（如密度泛函理论，DFT）进行计算，其收敛性和数值精度由平面波能量截断和布里渊区（BZ）采样（$k$点数量）控制。量子力学的变分原理确保了不完备的平面波基组所产生的能量会高于收敛值，并且这种基组误差会随着平面波能量截断的增加而单调减小。由有限$k$点采样引起的布里渊区数值积分误差会随着$k$点数量的增加而减小。\n\n您将实现一个程序，用一个简化的、物理上合理的参数化误差模型来模拟这些收敛行为。对于每个体系 $X \\in \\{\\mathrm{S}, \\mathrm{H}, \\mathrm{SH}\\}$：\n$$\nE_X^{\\mathrm{approx}}(E_{\\mathrm{cut}},K) \\;=\\; E_X^{\\mathrm{true}} \\;+\\; \\frac{\\alpha_X}{E_{\\mathrm{cut}}} \\;+\\; \\frac{\\gamma_X}{E_{\\mathrm{cut}}^2} \\;+\\; \\frac{\\beta_X}{K} \\;+\\; \\frac{\\delta_X}{E_{\\mathrm{cut}}\\,K},\n$$\n其中 $E_{\\mathrm{cut}}$ 是以电子伏特为单位的平面波能量截断， $K$ 是用于采样布里渊区的总面内$k$点数，模型系数捕捉了领先阶的基组误差和采样误差。对于孤立的氢原子，由于其被视为非周期性计算，将采样项设为零，\n$$\nE_{\\mathrm{H}}^{\\mathrm{approx}}(E_{\\mathrm{cut}}) \\;=\\; E_{\\mathrm{H}}^{\\mathrm{true}} \\;+\\; \\frac{\\alpha_{\\mathrm{H}}}{E_{\\mathrm{cut}}} \\;+\\; \\frac{\\gamma_{\\mathrm{H}}}{E_{\\mathrm{cut}}^2}.\n$$\n定义反映误差幅度上定性差异的体系相关系数：\n- 铂板：$\\alpha_{\\mathrm{S}} = 25\\,\\mathrm{eV}^2$, $\\gamma_{\\mathrm{S}} = 2000\\,\\mathrm{eV}^3$, $\\beta_{\\mathrm{S}} = 1.8\\,\\mathrm{eV}$, $\\delta_{\\mathrm{S}} = 10\\,\\mathrm{eV}^2$。\n- 氢原子：$\\alpha_{\\mathrm{H}} = 5\\,\\mathrm{eV}^2$, $\\gamma_{\\mathrm{H}} = 1000\\,\\mathrm{eV}^3$。\n- 吸附有氢原子的板：通过乘法因子 $m_\\alpha$ 和 $m_\\beta$ 模拟相对于洁净板在误差特性上物理合理的失配，\n$$\n\\alpha_{\\mathrm{SH}} = \\alpha_{\\mathrm{S}}(1+m_\\alpha), \\quad \\gamma_{\\mathrm{SH}} = \\gamma_{\\mathrm{S}}(1+m_\\alpha), \\quad \\beta_{\\mathrm{SH}} = \\beta_{\\mathrm{S}}(1+m_\\beta), \\quad \\delta_{\\mathrm{SH}} = \\delta_{\\mathrm{S}}(1+m_\\alpha).\n$$\n使用以下真实能量（所有能量以电子伏特表示）：\n$$\nE_{\\mathrm{S}}^{\\mathrm{true}} = -100.000, \\quad E_{\\mathrm{H}}^{\\mathrm{true}} = -13.600, \\quad \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}} = -0.450,\n$$\n并定义 $E_{\\mathrm{SH}}^{\\mathrm{true}} = E_{\\mathrm{S}}^{\\mathrm{true}} + E_{\\mathrm{H}}^{\\mathrm{true}} + \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}} = -114.050$。\n\n对于下面测试套件中的每一组参数 $(E_{\\mathrm{cut}},K,m_\\alpha,m_\\beta)$，您必须：\n1. 计算 $E_{\\mathrm{S}}^{\\mathrm{approx}}$、$E_{\\mathrm{H}}^{\\mathrm{approx}}$、$E_{\\mathrm{SH}}^{\\mathrm{approx}}$，单位为 $\\mathrm{eV}$。\n2. 计算 $\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} = E_{\\mathrm{SH}}^{\\mathrm{approx}} - E_{\\mathrm{S}}^{\\mathrm{approx}} - E_{\\mathrm{H}}^{\\mathrm{approx}}$，单位为 $\\mathrm{eV}$。\n3. 计算吸附能的绝对误差 $|\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} - \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}}|$，单位为 $\\mathrm{eV}$。\n4. 通过以下比率量化误差抵消：\n$$\nC \\;=\\; \\frac{\\left|\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} - \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}}\\right|}{\\sqrt{\\frac{\\left(E_{\\mathrm{SH}}^{\\mathrm{approx}}-E_{\\mathrm{SH}}^{\\mathrm{true}}\\right)^2 + \\left(E_{\\mathrm{S}}^{\\mathrm{approx}}-E_{\\mathrm{S}}^{\\mathrm{true}}\\right)^2 + \\left(E_{\\mathrm{H}}^{\\mathrm{approx}}-E_{\\mathrm{H}}^{\\mathrm{true}}\\right)^2}{3}}}.\n$$\n这个 $C$ 值衡量了误差抵消的程度：较小的值表示相对于原始能量误差的幅度，有更强的抵消作用。\n5. 通过评估由下式定义的布尔值 $B$，来判断吸附能是否满足目标精度容差：\n$$\nB \\;=\\; \\left(\\left|\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} - \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}}\\right| \\leq 0.020\\right).\n$$\n\n测试套件（每个案例是一个元组 $(E_{\\mathrm{cut}},K,m_\\alpha,m_\\beta)$）：\n- 案例1（良好收敛，轻度失配）：$(500, 36, 0.05, 0.05)$。\n- 案例2（基组受限，相同采样）：$(250, 36, 0.05, 0.05)$。\n- 案例3（采样受限，采样中较大失配）：$(500, 4, 0.05, 0.20)$。\n- 案例4（两者均差，强烈失配）：$(200, 1, 0.30, 0.30)$。\n- 案例5（中等设置，不等失配）：$(350, 9, 0.20, 0.05)$。\n- 案例6（近乎理想，无失配）：$(600, 100, 0.00, 0.00)$。\n\n要求的输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试案例，并且本身也是一个逗号分隔的列表，形式为：\n$$\n[\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}}\\ \\mathrm{(eV)},\\ |\\mathrm{error}|\\ \\mathrm{(eV)},\\ C,\\ B].\n$$\n所有浮点数必须四舍五入到六位小数，能量单位必须是电子伏特，布尔值必须以Python布尔字面量（literal）的形式报告。例如：\n$$\n[[x_1,y_1,z_1,B_1],[x_2,y_2,z_2,B_2],\\ldots]\n$$\n其中 $x_i$、$y_i$、$z_i$ 是以电子伏特为单位的浮点数，$B_i$ 是一个布尔值。\n\n该问题具有普适性，因为所有操作都简化为对所提供参数和常量的算术和逻辑运算；不涉及角度。通过遵循所述的参数化模型和单位来确保科学真实性。",
            "solution": "所提供的问题是有效的。它在科学上基于计算材料科学的原理，特别是关于密度泛函理论（DFT）计算中的数值收敛性。该问题陈述清晰，提供了一套完整且一致的定义、方程和参数。使用参数化模型研究误差传播和抵消是一种标准的教学工具，反映了计算研究中的真实挑战。所有术语都有客观明确的定义。该问题要求将给定的公式应用于一组测试案例，这是一项直接且可验证的任务。\n\n问题的核心是使用一个简化的参数化模型来计算氢原子在铂表面上的吸附能 $\\Delta E_{\\mathrm{ads}}$，该模型用于模拟从量子力学计算中得到的总能量。该模型考虑了周期性平面波计算中两个主要的数值误差来源：由能量截断 $E_{\\mathrm{cut}}$ 控制的基组不完备性，以及由$k$点数量 $K$ 控制的布里渊区离散采样。一个体系 $X$ 的近似能量 $E_X^{\\mathrm{approx}}$ 被建模为其真实、完全收敛的能量 $E_X^{\\mathrm{true}}$ 与几个随 $E_{\\mathrm{cut}}$ 和 $K$ 增加而减小的误差项之和。\n\n对于周期性体系 $X \\in \\{\\mathrm{S}, \\mathrm{SH}\\}$，模型由下式给出：\n$$\nE_X^{\\mathrm{approx}}(E_{\\mathrm{cut}},K) \\;=\\; E_X^{\\mathrm{true}} \\;+\\; \\underbrace{\\frac{\\alpha_X}{E_{\\mathrm{cut}}} \\;+\\; \\frac{\\gamma_X}{E_{\\mathrm{cut}}^2}}_{\\text{基组误差}} \\;+\\; \\underbrace{\\frac{\\beta_X}{K} \\;+\\; \\frac{\\delta_X}{E_{\\mathrm{cut}}\\,K}}_{\\text{BZ采样误差}}\n$$\n正系数 $\\alpha_X$ 和 $\\gamma_X$ 确保了基组误差为正，这与量子力学的变分原理一致，该原理指出不完备的基组会产生一个能量估计值，该值是真实基态能量的上限。孤立的氢原子是一个非周期性体系，没有布里渊区，其能量模型正确地省略了与 $K$ 相关的项：\n$$\nE_{\\mathrm{H}}^{\\mathrm{approx}}(E_{\\mathrm{cut}}) \\;=\\; E_{\\mathrm{H}}^{\\mathrm{true}} \\;+\\; \\frac{\\alpha_{\\mathrm{H}}}{E_{\\mathrm{cut}}} \\;+\\; \\frac{\\gamma_{\\mathrm{H}}}{E_{\\mathrm{cut}}^2}\n$$\n问题定义了所有必需的真实能量和误差系数。组合体系（带有吸附物的板）的系数 $\\alpha_{\\mathrm{SH}}$、$\\gamma_{\\mathrm{SH}}$、$\\beta_{\\mathrm{SH}}$ 和 $\\delta_{\\mathrm{SH}}$ 通过失配因子 $m_\\alpha$ 和 $m_\\beta$ 与洁净板的系数相关联。这种设置真实地模拟了吸附物的存在会改变体系收敛行为这一事实。\n\n主要关注的量是吸附能，它是一个能量差：\n$$\n\\Delta E_{\\mathrm{ads}} = E_{\\mathrm{SH}} - E_{\\mathrm{S}} - E_{\\mathrm{H}}\n$$\n我们通过代入各组分的近似能量来计算近似吸附能 $\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}}$：\n$$\n\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} = E_{\\mathrm{SH}}^{\\mathrm{approx}} - E_{\\mathrm{S}}^{\\mathrm{approx}} - E_{\\mathrm{H}}^{\\mathrm{approx}}\n$$\n计算科学中的一个关键概念是在计算能量差时误差会发生抵消。吸附能的绝对误差为 $|\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} - \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}}|$。让我们将体系 $X$ 的总能量误差表示为 $\\mathcal{E}_X = E_X^{\\mathrm{approx}} - E_X^{\\mathrm{true}}$。吸附能的误差可以表示为：\n$$\n\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} - \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}} = (E_{\\mathrm{SH}}^{\\mathrm{true}} + \\mathcal{E}_{\\mathrm{SH}}) - (E_{\\mathrm{S}}^{\\mathrm{true}} + \\mathcal{E}_{\\mathrm{S}}) - (E_{\\mathrm{H}}^{\\mathrm{true}} + \\mathcal{E}_{\\mathrm{H}}) - (E_{\\mathrm{SH}}^{\\mathrm{true}} - E_{\\mathrm{S}}^{\\mathrm{true}} - E_{\\mathrm{H}}^{\\mathrm{true}}) = \\mathcal{E}_{\\mathrm{SH}} - \\mathcal{E}_{\\mathrm{S}} - \\mathcal{E}_{\\mathrm{H}}\n$$\n此表达式表明，最终量的误差取决于各组分误差之间的差值。如果误差 $\\mathcal{E}_{\\mathrm{SH}}$ 和 $\\mathcal{E}_{\\mathrm{S}}$相似，它们将在很大程度上相互抵消，导致 $\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}}$ 的净误差远小于单个误差 $\\mathcal{E}_{\\mathrm{S}}$、$\\mathcal{E}_{\\mathrm{H}}$ 和 $\\mathcal{E}_{\\mathrm{SH}}$。问题要求我们通过比率 $C$ 来量化这种抵消：\n$$\nC \\;=\\; \\frac{\\left|\\mathcal{E}_{\\mathrm{SH}} - \\mathcal{E}_{\\mathrm{S}} - \\mathcal{E}_{\\mathrm{H}}\\right|}{\\sqrt{\\frac{\\mathcal{E}_{\\mathrm{SH}}^2 + \\mathcal{E}_{\\mathrm{S}}^2 + \\mathcal{E}_{\\mathrm{H}}^2}{3}}}\n$$\n分子是净误差的大小，而分母是各组分误差大小的均方根（RMS）。$C \\ll 1$ 的值表示强烈的误差抵消，而 $C \\approx \\sqrt{3}$ 则表示误差累加。\n\n最后，问题要求评估计算出的吸附能是否满足指定的精度阈值 $0.020\\,\\mathrm{eV}$，这由一个布尔变量 $B$ 来评估。\n\n解决方案涉及对每个给定的测试案例 $(E_{\\mathrm{cut}},K,m_\\alpha,m_\\beta)$ 进行系统化、分步的计算。\n1. 定义所有常量参数和真实能量。\n2. 对于每个测试案例，根据 $m_\\alpha$ 和 $m_\\beta$ 计算 SH 体系的特定系数。\n3. 使用给定的公式计算三个体系中每个体系的误差项 $\\mathcal{E}_{\\mathrm{S}}$、$\\mathcal{E}_{\\mathrm{H}}$ 和 $\\mathcal{E}_{\\mathrm{SH}}$。\n4. 计算 $\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} = \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}} + \\mathcal{E}_{\\mathrm{SH}} - \\mathcal{E}_{\\mathrm{S}} - \\mathcal{E}_{\\mathrm{H}}$。\n5. 计算绝对误差 $|\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}} - \\Delta E_{\\mathrm{ads}}^{\\mathrm{true}}|$。\n6. 计算抵消比率 $C$。包含一个条件检查以处理所有组分误差均为零的理论情况，此时净误差也为零，$C$ 定义为 $0$。\n7. 评估布尔条件 $B$。\n8. 将每个测试案例的结果——$\\Delta E_{\\mathrm{ads}}^{\\mathrm{approx}}$、绝对误差、$C$ 和 $B$——格式化为字符串，浮点数四舍五入到六位小数，并收集这些字符串。\n9. 将所有测试案例的字符串连接起来，并以指定的列表的列表格式呈现。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Calculates the convergence behavior of hydrogen adsorption energy on Pt(111)\n    using a parametric error model.\n    \"\"\"\n\n    # Define true (converged) energies in eV\n    E_S_true = -100.000\n    E_H_true = -13.600\n    delta_E_ads_true = -0.450\n    E_SH_true = E_S_true + E_H_true + delta_E_ads_true\n\n    # Define error model coefficients\n    # Platinum slab (S)\n    alpha_S = 25.0  # eV^2\n    gamma_S = 2000.0  # eV^3\n    beta_S = 1.8  # eV\n    delta_S = 10.0  # eV^2\n    \n    # Hydrogen atom (H)\n    alpha_H = 5.0  # eV^2\n    gamma_H = 1000.0  # eV^3\n    \n    # Define test suite: (E_cut, K, m_alpha, m_beta)\n    test_cases = [\n        (500, 36, 0.05, 0.05),   # Case 1\n        (250, 36, 0.05, 0.05),   # Case 2\n        (500, 4, 0.05, 0.20),    # Case 3\n        (200, 1, 0.30, 0.30),    # Case 4\n        (350, 9, 0.20, 0.05),    # Case 5\n        (600, 100, 0.00, 0.00),  # Case 6\n    ]\n\n    all_formatted_results = []\n\n    for case in test_cases:\n        E_cut, K, m_alpha, m_beta = case\n\n        # 1. Compute individual energy errors (E_approx - E_true)\n        \n        # Error for the clean slab (S)\n        err_S = (alpha_S / E_cut) + \\\n                (gamma_S / E_cut**2) + \\\n                (beta_S / K) + \\\n                (delta_S / (E_cut * K))\n\n        # Error for the isolated hydrogen atom (H)\n        err_H = (alpha_H / E_cut) + \\\n                (gamma_H / E_cut**2)\n        \n        # Coefficients for the slab with adsorbed hydrogen (SH)\n        alpha_SH = alpha_S * (1 + m_alpha)\n        gamma_SH = gamma_S * (1 + m_alpha)\n        beta_SH = beta_S * (1 + m_beta)\n        delta_SH = delta_S * (1 + m_alpha)\n\n        # Error for the slab with adsorbed hydrogen (SH)\n        err_SH = (alpha_SH / E_cut) + \\\n                 (gamma_SH / E_cut**2) + \\\n                 (beta_SH / K) + \\\n                 (delta_SH / (E_cut * K))\n\n        # 2. Compute approximate adsorption energy\n        delta_E_ads_approx = E_SH_true + err_SH - (E_S_true + err_S) - (E_H_true + err_H)\n        \n        # 3. Compute absolute error in adsorption energy\n        # This simplifies to |err_SH - err_S - err_H|\n        ads_error = abs(delta_E_ads_approx - delta_E_ads_true)\n        \n        # 4. Quantify error cancellation\n        # Numerator is the absolute error in the energy difference\n        numerator_c = ads_error\n        \n        # Denominator is the RMS of the absolute errors of the components\n        rms_error_sq = (err_SH**2 + err_S**2 + err_H**2) / 3.0\n        \n        # Avoid division by zero if all errors happen to be zero\n        if rms_error_sq > 0:\n            denominator_c = math.sqrt(rms_error_sq)\n            C_ratio = numerator_c / denominator_c\n        else:\n            C_ratio = 0.0  # Perfect cancellation/no error\n\n        # 5. Assess accuracy tolerance\n        accuracy_tolerance = 0.020\n        B_val = (ads_error = accuracy_tolerance)\n\n        # Format results for this case into the required string format\n        case_string = (\n            f\"[{delta_E_ads_approx:.6f},\"\n            f\"{ads_error:.6f},\"\n            f\"{C_ratio:.6f},\"\n            f\"{B_val}]\"\n        )\n        all_formatted_results.append(case_string)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}