{
    "hands_on_practices": [
        {
            "introduction": "要从根本上理解催化剂表面的扩散现象，我们必须建立微观原子运动与宏观可测量属性之间的桥梁。连续时间随机行走（CTRW）模型为此提供了坚实的理论基础，它将单个原子或分子的离散跳跃事件与整体的扩散行为联系起来。通过这个练习，您将从第一性原理出发，推导在方形晶格上进行随机行走（即所谓的“醉汉走路”）的均方根位移，并验证其结果与宏观菲克扩散定律的一致性，从而深入理解扩散系数 $D$ 的物理意义 。",
            "id": "3900863",
            "problem": "一种吸附物种在方形晶格催化剂上进行无偏见的表面扩散，该过程表示为连续时间随机行走 (Continuous-Time Random Walk, CTRW)。晶格间距为 $a$，该过程是各向同性的，仅涉及最近邻跳跃。离开一个格点的总速率为 $k$，每次跳跃到四个最近邻之一的概率均等。在时间 $t=0$ 时，吸附物位于原点。\n\n从具有指数等待时间和独立同分布步长的连续时间马尔可夫过程的定义出发，推导均方位移 $\\langle r^{2}(t)\\rangle$ 作为 $a$、$k$ 和 $t$ 的函数的解析表达式。然后，使用二维的基本菲克扩散关系，证明你的结果所隐含的粗粒化连续介质扩散系数 $D$ 与 $D = (a^{2} k)/4$ 一致。\n\n假设 $a$ 的单位是米，$t$ 的单位是秒，用平方米表示均方位移。提供一个关于 $\\langle r^{2}(t)\\rangle$ 的单一闭式解析表达式。无需四舍五入。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 物理系统是一种在方形晶格催化剂上扩散的吸附物种。\n- 该过程被建模为无偏见的连续时间随机行走 (CTRW)。\n- 晶格间距用 $a$ 表示。\n- 扩散是各向同性的，跳跃仅限于四个最近邻。\n- 离开任何格点的总速率为一个常数 $k$。\n- 跳跃到任何特定最近邻的概率是相等的，这意味着四个可能方向的概率均为 $1/4$。\n- 初始条件是吸附物在时间 $t=0$ 时位于原点。\n- 提供了一个用于一致性检查的扩散系数目标表达式：$D = (a^{2} k)/4$。\n- 应使用二维的基本菲克扩散关系。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于标准的 CTRW 模型，这是统计物理和化学工程中描述扩散过程的一个基本概念。所有方面都符合已建立的科学原理。\n- **适定性：** 这是一个适定问题。它提供了对随机过程的完整描述，包括几何结构（方形晶格）、步长（$a$）和时间动态（速率为 $k$ 的泊松过程）。其目标——推导均方位移 (MSD) 并验证一个相关的扩散系数表达式——是明确的，并且有一个唯一的、可推导的解。\n- **客观性：** 该问题使用精确、客观的科学语言进行陈述。诸如“无偏见的”、“各向同性的”和“CTRW”等术语在这一语境下是标准的、无歧义的。\n- **结论：** 该问题没有表现出验证标准中列出的任何缺陷。它在科学上是合理的、适定的、客观的且可形式化的。\n\n**第三步：结论与行动**\n- 该问题被判定为 **有效**。将提供完整解答。\n\n### 均方位移的推导\n\n设吸附物在时间 $t$ 的位置为 $\\vec{r}(t)$。均方位移 (MSD) 定义为 $\\langle r^{2}(t) \\rangle = \\langle |\\vec{r}(t)|^{2} \\rangle$。该过程是一个 CTRW，其中总位移是各个跳跃向量的总和。设 $N(t)$ 是到时间 $t$ 为止发生的跳跃次数。经过 $N(t)$ 次跳跃后的位移向量为 $\\vec{r}(t) = \\sum_{i=1}^{N(t)} \\vec{s}_i$，其中 $\\vec{s}_i$ 是第 $i$ 次跳跃的向量。\n\n时间 $t$ 的 MSD 是该位移向量大小平方的期望值。我们可以使用迭代期望来计算它，首先在固定步数 $n$ 的情况下对步长的选择进行平均，然后对时间 $t$ 的步数 $N(t)$ 的分布进行平均。\n\n我们首先计算固定步数 $n$ 的 MSD。\n$$\n\\langle |\\vec{r}_{n}|^{2} \\rangle = \\left\\langle \\left( \\sum_{i=1}^{n} \\vec{s}_i \\right) \\cdot \\left( \\sum_{j=1}^{n} \\vec{s}_j \\right) \\right\\rangle = \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\langle \\vec{s}_i \\cdot \\vec{s}_j \\rangle\n$$\n这个和可以分解为 $i=j$ 的项和 $i \\neq j$ 的项。\n$$\n\\langle |\\vec{r}_{n}|^{2} \\rangle = \\sum_{i=1}^{n} \\langle |\\vec{s}_i|^{2} \\rangle + \\sum_{i \\neq j} \\langle \\vec{s}_i \\cdot \\vec{s}_j \\rangle\n$$\n跳跃是独立同分布的 (i.i.d.)。对于 $i \\neq j$，向量 $\\vec{s}_i$ 和 $\\vec{s}_j$ 是独立的，所以它们乘积的期望等于期望的乘积：$\\langle \\vec{s}_i \\cdot \\vec{s}_j \\rangle = \\langle \\vec{s}_i \\rangle \\cdot \\langle \\vec{s}_j \\rangle$。\n\n该行走在方形晶格上是无偏见且各向同性的。可能的跳跃向量为 $(a, 0)$、$(-a, 0)$、$(0, a)$ 和 $(0, -a)$。每个向量出现的概率为 $p=1/4$。平均跳跃向量 $\\langle \\vec{s} \\rangle$ 是：\n$$\n\\langle \\vec{s} \\rangle = \\frac{1}{4} (a, 0) + \\frac{1}{4} (-a, 0) + \\frac{1}{4} (0, a) + \\frac{1}{4} (0, -a) = (0, 0)\n$$\n由于 $\\langle \\vec{s} \\rangle = \\vec{0}$，所有的交叉项（$i \\neq j$）都为零：$\\langle \\vec{s}_i \\cdot \\vec{s}_j \\rangle = \\vec{0} \\cdot \\vec{0} = 0$。\n\n$n$ 步的 MSD 简化为对角项的和：\n$$\n\\langle |\\vec{r}_{n}|^{2} \\rangle = \\sum_{i=1}^{n} \\langle |\\vec{s}_i|^{2} \\rangle\n$$\n对于任何一次跳跃，位移的大小都是晶格间距 $a$，所以 $|\\vec{s}_i|^{2} = a^{2}$。由于这对每次跳跃都是一个恒定值，其期望为 $\\langle |\\vec{s}_i|^{2} \\rangle = a^{2}$。\n$$\n\\langle |\\vec{r}_{n}|^{2} \\rangle = \\sum_{i=1}^{n} a^{2} = n a^{2}\n$$\n现在，我们必须将步数 $n$ 与时间 $t$ 联系起来。问题陈述中提到，离开一个格点的总速率是 $k$。这描述了跳跃事件的泊松过程。连续跳跃之间的等待时间呈指数分布，均值为 $1/k$。对于持续时间为 $t$ 的时间间隔，跳跃次数 $N(t)$ 服从泊松分布，其均值为 $\\langle N(t) \\rangle = k t$。\n\n时间 $t$ 的 MSD 是对 $\\langle |\\vec{r}_{N(t)}|^{2} \\rangle = N(t) a^{2}$ 在 $N(t)$ 的分布上求平均值：\n$$\n\\langle r^{2}(t) \\rangle = \\langle N(t) a^{2} \\rangle = a^{2} \\langle N(t) \\rangle\n$$\n代入平均跳跃次数 $\\langle N(t) \\rangle = k t$：\n$$\n\\langle r^{2}(t) \\rangle = a^{2} k t\n$$\n这就是均方位移的解析表达式。如果 $a$ 的单位是米，$t$ 的单位是秒，那么速率 $k$ 的单位必须是 $s^{-1}$，得到的 MSD $\\langle r^{2}(t) \\rangle$ 的单位将是 $m^{2}$。\n\n### 与菲克扩散的一致性\n\n问题要求使用菲克扩散关系来证明与所提供的扩散系数的一致性。对于一个 $d$ 维系统，MSD 的长时间渐近行为由下式给出：\n$$\n\\langle r^{2}(t) \\rangle = 2d D t\n$$\n其中 $D$ 是扩散系数。该问题描述的是在方形晶格上的扩散，这是一个二维（$d=2$）系统。因此，适用的菲克关系是：\n$$\n\\langle r^{2}(t) \\rangle = 4 D t\n$$\n通过将我们推导出的 MSD 表达式与菲克关系相等，我们可以提取出隐含的扩散系数。\n$$\na^{2} k t = 4 D t\n$$\n对于 $t  0$，我们可以两边同除以 $t$：\n$$\na^{2} k = 4 D\n$$\n求解 $D$ 可得：\n$$\nD = \\frac{a^{2} k}{4}\n$$\n这个结果与问题陈述中为验证而提供的表达式 $D = (a^{2} k)/4$ 完全相同。因此，从 CTRW 模型的推导与该系统扩散的宏观菲克描述是一致的。均方位移的最终表达式是 $\\langle r^{2}(t) \\rangle = a^{2} k t$。",
            "answer": "$$ \\boxed{a^{2} k t} $$"
        },
        {
            "introduction": "在上一节的随机行走模型中，跳跃速率 $k$ 是一个关键参数，它遵循阿伦尼乌斯关系，指数依赖于活化能垒 $E_a$。因此，准确计算扩散能垒是预测扩散速率的核心任务。微动弹性带（Nudged Elastic Band, NEB）方法是计算化学和材料科学中寻找最小能量路径（MEP）和确定鞍点（即过渡态）能量的标准计算工具。本实践将指导您在一个给定的二维势能面上，通过编写代码实现NEB算法，亲手构建连接两个稳定吸附位点的反应路径，并计算出扩散过程所需的活化能 。",
            "id": "3900845",
            "problem": "要求您遵循微动弹性带（Nudged Elastic Band, NEB）方法的概念框架，形式化并实现催化表面上两个吸附位点之间最小能量路径的离散近似。这两个位点是 (111) 表面上的面心立方（Face-Centered Cubic, FCC）位点和密排六方（Hexagonal Close-Packed, HCP）位点。最终程序必须计算扩散势垒，其定义为最小能量路径上的鞍点能量，以电子伏特表示。此构建必须基于第一性原理和核心定义。\n\n从以下基本原理和事实出发：\n- 最小能量路径是构型空间中连接两个局部极小值的一条路径，沿着该路径，势能在垂直于路径的方向上被最小化。在鞍点处，势能的梯度为零，且其黑塞矩阵恰好有一个负特征值。\n- 晶体表面上吸附物的势能面是位置的光滑函数，势能的梯度通过最速下降法驱动构型弛豫。\n- 离散路径可以表示为一组由谐振子弹簧连接的“图像”（image），这些弹簧强制实现近似均匀的参数化，但不会在垂直于路径方向上偏置路径的形状。\n\n使用以下光滑且物理上合理的二维势能面来表示单个原子吸附物沿着晶体学方向在 FCC 和 HCP 位点之间扩散，并在垂直于路径的方向上具有约束曲率：\n$$\nV(x,y) \\;=\\; \\frac{16\\,E_b}{a^4}\\left[\\left(x - \\frac{a}{2}\\right)^2 - \\left(\\frac{a}{2}\\right)^2\\right]^2 \\;+\\; \\gamma\\,y^2,\n$$\n其中 $x$ 和 $y$ 是以埃（angstrom）为单位的笛卡尔坐标，$a$ 是以埃为单位的晶格参数，$E_b$ 是以电子伏特为单位的可调势垒能量，$\\gamma$ 是以电子伏特每平方埃为单位的横向曲率。预因子的选择保证了沿 $y=0$ 线的势垒高度在 $x=a/2$ 处为 $E_b$，并在 $x=0$ 和 $x=a$ 处有极小值。\n\n将路径的端点定义为 FCC 位点 $(x,y)=(0,0)$ 和 HCP 位点 $(x,y)=(a,0)$，其中 $a0$。路径被离散为包含固定端点在内的 $N$ 个图像。这些图像由弹性系数为 $k$（单位为电子伏特每平方埃）的谐振子弹簧连接。您必须从第一性原理出发，构建一个数学上合理的离散 NEB 公式：\n- 在每个内部图像索引 $i$ 处，基于相邻图像定义一个离散切线 $\\,\\mathbf{t}_i\\,$，使其能够一致地近似路径方向。\n- 将图像 $i$ 上的物理力 $-\\nabla V(\\mathbf{R}_i)$ 分解为平行和垂直于局部切线的两个分量，并仅保留物理力的垂直分量。\n- 沿切线方向添加弹簧力分量以维持近似均匀的参数化，而不添加任何会偏置路径的垂直弹簧分量。\n- 可选地，为改进鞍点识别，实现一种“攀爬”变体，其中能量最高的内部图像沿切线方向上升，并沿垂直方向下降，以收敛到鞍点。\n\n您的程序必须：\n- 通过在端点之间进行线性插值来初始化图像。\n- 使用推导出的 NEB 力迭代地弛豫内部图像，直到完成固定的迭代次数或达到关于最大力范数的合理收敛阈值。在整个过程中，端点必须保持固定。\n- 将势垒能量确定为收敛后的离散路径上（不包括端点）的最大势能；如果激活了攀爬变体，则使用攀爬图像的能量作为势垒估计值。\n- 报告下面指定测试集的势垒能量。\n\n单位和输出规范：\n- 位置必须以埃处理。能量必须以电子伏特为单位。最终的势垒能量必须以电子伏特报告。\n- 最终的程序输出必须是单行，包含一个方括号内的逗号分隔列表，其中每个条目是对应一个测试用例的势垒能量，表示为四舍五入到六位小数的浮点数，单位为电子伏特。\n\n测试集和参数覆盖范围：\n- 对每个案例，使用上面定义的势 $V(x,y)$ 和指定的参数。图像必须包含端点 $(0,0)$ 和 $(a,0)$。\n- 对每个案例，元组为 $(a, E_b, \\gamma, N, k, \\text{climb})$，其中 $a$ 的单位是埃，$E_b$ 的单位是电子伏特，$\\gamma$ 的单位是电子伏特每平方埃，$N$ 是大于或等于 $3$ 的整数，$k$ 的单位是电子伏特每平方埃，$\\text{climb}$ 是一个布尔值，指示是否启用攀爬变体。\n\n提供并使用以下测试集：\n- 案例 1：$(a=2.5,\\,E_b=0.12,\\,\\gamma=1.0,\\,N=9,\\,k=5.0,\\,\\text{climb}=\\text{True})$。\n- 案例 2：$(a=2.5,\\,E_b=0.12,\\,\\gamma=0.5,\\,N=7,\\,k=0.1,\\,\\text{climb}=\\text{True})$。\n- 案例 3：$(a=2.5,\\,E_b=0.05,\\,\\gamma=1.0,\\,N=5,\\,k=3.0,\\,\\text{climb}=\\text{False})$。\n- 案例 4：$(a=2.5,\\,E_b=0.20,\\,\\gamma=1.5,\\,N=11,\\,k=10.0,\\,\\text{climb}=\\text{True})$。\n- 案例 5：$(a=2.5,\\,E_b=0.12,\\,\\gamma=2.0,\\,N=3,\\,k=1.0,\\,\\text{climb}=\\text{True})$。\n\n您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表，结果以电子伏特为单位，四舍五入到六位小数，格式如下：\n\"[result1,result2,result3,result4,result5]\".",
            "solution": "问题陈述已经过验证，被认为是合理的。它提出了一个在计算物理学领域中定义明确、有科学依据的问题，没有矛盾或含糊之处。任务是为一个指定的二维势能面（PES）实现微动弹性带（NEB）方法，这是一种用于寻找化学反应和扩散过程中最小能量路径（MEP）的基石算法。\n\n我们首先形式化反应路径的离散表示。该路径是一系列构型或“图像”，用其坐标 $\\mathbf{R}_i = (x_i, y_i)$ 表示，其中 $i=0, 1, \\dots, N-1$。图像总数为 $N$。端点 $\\mathbf{R}_0$ 和 $\\mathbf{R}_{N-1}$ 分别固定在过程的初始态和最终态——在此案例中，即 FCC 位点 $(0,0)$ 和 HCP 位点 $(a,0)$。中间的 $N-2$ 个图像是可移动的。\n\n势能面 $V(\\mathbf{R})$ 由以下公式给出：\n$$\nV(x,y) = \\frac{16\\,E_b}{a^4}\\left[\\left(x - \\frac{a}{2}\\right)^2 - \\left(\\frac{a}{2}\\right)^2\\right]^2 + \\gamma\\,y^2\n$$\n在位置 $\\mathbf{R}_i$ 的图像上由该势产生的力是势的负梯度，即 $\\mathbf{F}_{phys,i} = -\\nabla V(\\mathbf{R}_i)$。梯度的分量为：\n$$\n\\frac{\\partial V}{\\partial x} = \\frac{32\\,E_b}{a^4} (x^2 - ax)(2x - a) = \\frac{32\\,E_b}{a^4} x(x-a)(2x-a)\n$$\n$$\n\\frac{\\partial V}{\\partial y} = 2\\gamma y\n$$\nNEB 方法的核心思想是在每个图像上构造一个总力，以驱动图像链朝向最小能量路径移动。这个力是两个分量的和：一个修正的物理力和一个弹簧力。一个简单的做法是让图像仅在物理力 $\\mathbf{F}_{phys,i}$ 和谐振子弹簧力 $\\mathbf{F}_{spring,i} = k(\\mathbf{R}_{i+1} - 2\\mathbf{R}_i + \\mathbf{R}_{i-1})$ 的作用下弛豫，但这会导致路径滑入能量极小点并表现出“切角”行为。\n\nNEB 中的“微动”修正了这个问题。我们希望物理力只在垂直于路径的方向上作用，从而在不影响沿路径位置的情况下最小化能量。相反，我们希望弹簧力只在平行于路径的方向上作用，以确保图像间距均匀，而不偏置路径的形状。这需要在每个图像 $i$ 处定义一个局部切向量 $\\mathbf{t}_i$。对于内部图像 $i$ 处的切线，一个稳健的选择是连接其相邻图像的归一化向量：\n$$\n\\mathbf{t}_i = \\frac{\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}}{\\|\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}\\|}\n$$\n物理力垂直于路径的分量可以通过投射掉平行分量来获得：\n$$\n\\mathbf{F}_{phys,i}^{\\perp} = \\mathbf{F}_{phys,i} - (\\mathbf{F}_{phys,i} \\cdot \\mathbf{t}_i)\\mathbf{t}_i\n$$\n问题为平行弹簧力分量指定了一种特殊形式，旨在均衡相邻图像之间的距离：\n$$\n\\mathbf{F}_{spring,i}^{\\parallel} = k(\\|\\mathbf{R}_{i+1} - \\mathbf{R}_i\\| - \\|\\mathbf{R}_i - \\mathbf{R}_{i-1}\\|) \\mathbf{t}_i\n$$\n在标准（非攀爬）内部图像 $i$ 上的总 NEB 力是这两个投影力的和：\n$$\n\\mathbf{F}_{NEB, i} = \\mathbf{F}_{phys,i}^{\\perp} + \\mathbf{F}_{spring,i}^{\\parallel}\n$$\n为了精确地定位鞍点，采用了攀爬图像 NEB（CI-NEB）变体。势能最高的内部图像（设其索引为 $i_{climb}$）被指定为“攀爬”图像。该图像不再受任何弹簧力的作用。此外，其物理力平行于路径的分量被反转。这会驱动该图像沿最小能量路径“上坡”朝向鞍点移动，同时继续在垂直方向上最小化其能量。攀爬图像上的力为：\n$$\n\\mathbf{F}_{climb, i_{climb}} = \\mathbf{F}_{phys, i_{climb}} - 2(\\mathbf{F}_{phys, i_{climb}} \\cdot \\mathbf{t}_{i_{climb}})\\mathbf{t}_{i_{climb}} = \\mathbf{F}_{phys, i_{climb}}^{\\perp} - \\mathbf{F}_{phys, i_{climb}}^{\\parallel}\n$$\n算法流程如下：\n$1$. 通过在端点 $\\mathbf{R}_0=(0,0)$ 和 $\\mathbf{R}_{N-1}=(a,0)$ 之间进行线性插值来创建 $N$ 个图像，从而初始化路径。\n$2$. 迭代更新 $N-2$ 个内部图像的位置。在每次迭代中：\n    a. 计算所有图像的势能 $V(\\mathbf{R}_i)$。\n    b. 如果攀爬变体被激活，找出能量最高的内部图像 $i_{climb}$。\n    c. 对于每个内部图像 $i \\in [1, N-2]$，计算切线 $\\mathbf{t}_i$ 和总力 $\\mathbf{F}_i$（$\\mathbf{F}_{NEB, i}$ 或 $\\mathbf{F}_{climb, i}$）。\n    d. 使用简单的最速下降优化步骤更新图像位置：$\\mathbf{R}_i \\gets \\mathbf{R}_i + \\alpha \\mathbf{F}_i$，其中 $\\alpha$ 是一个小的、恒定的学习率。\n$3$. 当任何内部图像上的最大力的大小低于指定的收敛阈值，或达到最大迭代次数时，循环终止。\n$4$. 收敛后，确定扩散势垒。如果使用了 CI-NEB，扩散势垒是攀爬图像的势能 $V(\\mathbf{R}_{i_{climb}})$。否则，它是所有弛豫后的内部图像中的最大势能。\n\n这个过程为确定最小能量路径及其相关的活化势垒提供了一种稳健且物理上合理的方法，并在以下程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the NEB calculations for the specified test suite\n    and print the results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, E_b, gamma, N, k, climb)\n        (2.5, 0.12, 1.0, 9, 5.0, True),\n        (2.5, 0.12, 0.5, 7, 0.1, True),\n        (2.5, 0.05, 1.0, 5, 3.0, False),\n        (2.5, 0.20, 1.5, 11, 10.0, True),\n        (2.5, 0.12, 2.0, 3, 1.0, True),\n    ]\n\n    results = []\n    \n    # Optimization parameters\n    learning_rate = 0.01\n    num_iterations = 20000\n    force_threshold = 1e-6 # eV/Angstrom\n\n    for case in test_cases:\n        a, E_b, gamma, N, k, climb = case\n        barrier = run_neb(a, E_b, gamma, N, k, climb,\n                          learning_rate, num_iterations, force_threshold)\n        results.append(f\"{barrier:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef potential(coords, a, E_b, gamma):\n    \"\"\"\n    Calculates the potential energy V(x,y) for one or more coordinates.\n    coords is a NumPy array of shape (..., 2).\n    \"\"\"\n    x = coords[..., 0]\n    y = coords[..., 1]\n    term_x = (16.0 * E_b / a**4) * ((x - a / 2.0)**2 - (a / 2.0)**2)**2\n    term_y = gamma * y**2\n    return term_x + term_y\n\ndef gradient(coords, a, E_b, gamma):\n    \"\"\"\n    Calculates the gradient of the potential energy nabla(V) at given coordinates.\n    coords is a NumPy array of shape (..., 2).\n    \"\"\"\n    x = coords[..., 0]\n    y = coords[..., 1]\n    \n    # dV/dx = (32*E_b/a**4) * x*(x-a)*(2*x-a)\n    dv_dx = (32.0 * E_b / a**4) * x * (x - a) * (2.0 * x - a)\n    dv_dy = 2.0 * gamma * y\n    \n    if coords.ndim > 1:\n        return np.stack((dv_dx, dv_dy), axis=-1)\n    else:\n        return np.array([dv_dx, dv_dy])\n\ndef compute_neb_forces(images, a, E_b, gamma, k, climb):\n    \"\"\"\n    Computes the NEB forces for all interior images.\n    \"\"\"\n    N = images.shape[0]\n    forces = np.zeros_like(images)\n    \n    # Calculate energies for all images to identify climbing image if needed\n    energies = potential(images, a, E_b, gamma)\n    \n    i_climb = -1\n    if climb and N > 2:\n        # The climbing image is the one with the highest energy (among interior images)\n        i_climb = np.argmax(energies[1:-1]) + 1\n        \n    for i in range(1, N - 1):\n        # Local tangent at image i using centered difference\n        tangent = images[i+1] - images[i-1]\n        tangent_norm = np.linalg.norm(tangent)\n        if tangent_norm > 1e-9:\n            tangent /= tangent_norm\n        else:\n            # Fallback for colocated neighbors, though unlikely in a real run.\n            tangent = np.array([1.0, 0.0])\n\n        # True force from the potential\n        F_phys = -gradient(images[i], a, E_b, gamma)\n\n        if i == i_climb:\n            # Climbing image force: invert parallel component of true force\n            F_phys_parallel_mag = np.dot(F_phys, tangent)\n            F_total = F_phys - 2.0 * F_phys_parallel_mag * tangent\n        else:\n            # Standard NEB image force\n            # Perpendicular component of the true force\n            F_phys_parallel_mag = np.dot(F_phys, tangent)\n            F_phys_perp = F_phys - F_phys_parallel_mag * tangent\n\n            # Spring force component along the tangent\n            len_next = np.linalg.norm(images[i+1] - images[i])\n            len_prev = np.linalg.norm(images[i] - images[i-1])\n            F_spring_parallel = k * (len_next - len_prev) * tangent\n            \n            F_total = F_phys_perp + F_spring_parallel\n            \n        forces[i] = F_total\n\n    return forces\n\ndef run_neb(a, E_b, gamma, N, k, climb, learning_rate, num_iterations, force_threshold):\n    \"\"\"\n    Performs the NEB calculation for a single test case.\n    \"\"\"\n    # 1. Initialize images by linear interpolation\n    images = np.zeros((N, 2))\n    images[:, 0] = np.linspace(0.0, a, N)\n\n    # 2. Optimization loop\n    for _ in range(num_iterations):\n        forces = compute_neb_forces(images, a, E_b, gamma, k, climb)\n        \n        # Check for convergence on the maximum force norm for any movable image\n        max_force_norm = 0.0\n        if N > 2:\n            max_force_norm = np.max(np.linalg.norm(forces[1:-1], axis=1))\n        \n        if max_force_norm  force_threshold:\n            break\n        \n        # 3. Update interior image positions using steepest descent\n        images[1:-1] += learning_rate * forces[1:-1]\n\n    # 4. Calculate final barrier energy\n    if N = 2:\n        return 0.0 # No barrier if there are no interior images\n        \n    final_energies = potential(images[1:-1], a, E_b, gamma)\n    barrier_energy = np.max(final_energies)\n\n    return barrier_energy\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "真实的催化剂表面很少是完全各向同性的；晶体结构的对称性决定了其势能面（PES）在不同方向上可能存在差异，从而导致扩散行为的各向异性。过渡态理论（TST）为我们提供了从势能面的微观特征（如极小点和鞍点的振动频率）计算跳跃速率的强大框架。在这个高级练习中，您将应用谐振过渡态理论，针对一个可分离的各向异性势能面，推导出主扩散系数分量 $D_{xx}$ 和 $D_{yy}$ 的比率，从而揭示势能面的形状如何直接决定宏观扩散的优先方向 。",
            "id": "3900854",
            "problem": "一个质量为 $m$ 的吸附原子在晶体表面扩散，其势能面 (PES) 是可分离且各向异性的，由 $V(x,y)=V_{x}\\cos\\!\\left(\\frac{2\\pi x}{a}\\right)+V_{y}\\cos\\!\\left(\\frac{2\\pi y}{b}\\right)$ 给出，其中 $V_{x}0$ 且 $V_{y}0$，$a$ 和 $b$ 分别是沿 $x$ 和 $y$ 方向的晶格周期。假设覆盖度低，吸附物-吸附物相互作用可忽略不计，且扩散通过沿坐标轴在相邻极小值点之间的热激活跳跃进行。在温度为 $T$ 的经典极限下进行计算，并使用谐振近似下的过渡态理论 (TST)：极小值点和一阶鞍点附近的微小振动是谐振的，并且反应坐标是可分离的。从长时间均方位移定义扩散张量分量 $D_{xx}$ 和 $D_{yy}$，并将 $k_{x}$ ($k_{y}$) 定义为沿 $+x$ ($+y$) 方向到特定最近邻的微观跳跃速率。从过渡态理论（TST）原理出发，即速率由势阱中的平衡布居数乘以通过无重穿分界面的正向反应通量给出，并利用极小值点和鞍点处振动配分函数的谐振近似，推导扩散系数之比 $D_{xx}/D_{yy}$ 的解析表达式，该表达式用 $V_{x}$、$V_{y}$、$a$、$b$、$m$、$T$ 和玻尔兹曼常数 $k_{B}$ 表示。将最终答案表示为闭合形式的解析表达式。不需要进行数值计算或四舍五入。",
            "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且良定的。势能面和假设的扩散机制是一致的，从而可以进行严格的推导。\n\n目标是推导扩散张量对角分量之比 $D_{xx}/D_{yy}$ 的表达式。对于通过离散跳跃在晶格上进行的扩散，扩散系数与微观跳跃速率和跳跃长度有关。对于二维矩形晶格，这些关系由下式给出：\n$$D_{xx} = k_x l_x^2$$\n$$D_{yy} = k_y l_y^2$$\n此处，$k_x$ 和 $k_y$ 分别是向 $x$ 和 $y$ 正方向上特定相邻位置的跳跃速率。跳跃长度 $l_x$ 和 $l_y$ 是沿各自坐标轴的相邻极小值点之间的距离。\n\n从给定的势能面 (PES)，$V(x,y)=V_{x}\\cos\\!\\left(\\frac{2\\pi x}{a}\\right)+V_{y}\\cos\\!\\left(\\frac{2\\pi y}{b}\\right)$，其中 $V_{x}0$ 且 $V_{y}0$，我们可以确定驻点的位置。势能的极小值点出现在两个余弦项都等于 $-1$ 的地方。这发生在坐标 $(x,y) = ((n+\\frac{1}{2})a, (m+\\frac{1}{2})b)$ 处，其中 $n, m$ 为任意整数。沿 $x$ 方向的相邻极小值点之间的距离（例如，从 $(-\\frac{a}{2}, \\frac{b}{2})$ 到 $(\\frac{a}{2}, \\frac{b}{2})$）是 $l_x=a$。类似地，沿 $y$ 方向的相邻极小值点之间的距离是 $l_y=b$。\n因此，扩散系数之比为：\n$$\\frac{D_{xx}}{D_{yy}} = \\frac{k_x a^2}{k_y b^2}$$\n问题的核心是使用谐振过渡态理论 (TST) 来确定速率 $k_x$ 和 $k_y$。TST 速率表达式由下式给出：\n$$k = \\frac{\\prod_{i=1}^{N} \\nu_i^{MIN}}{\\prod_{i=1}^{N-1} \\nu_i^{SP}} \\exp\\left(-\\frac{E_a}{k_B T}\\right)$$\n其中 $\\nu_i^{MIN}$ 是能量极小值点（反应物态）处的 $N$ 个实振动频率，$\\nu_i^{SP}$ 是一阶鞍点（过渡态）处的 $N-1$ 个实振动频率，$E_a$ 是活化能 ($V_{SP} - V_{MIN}$)，$k_B$ 是玻尔兹曼常数，$T$ 是温度。对于这个二维问题，$N=2$。\n\n首先，我们分析势能面驻点的性质。梯度为 $\\nabla V = \\left( -\\frac{2\\pi V_x}{a}\\sin(\\frac{2\\pi x}{a}), -\\frac{2\\pi V_y}{b}\\sin(\\frac{2\\pi y}{b}) \\right)$。由于势能的可分离性，海森矩阵是对角的：\n$$H(x,y) = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2}  0 \\\\ 0  \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix} = \\begin{pmatrix} -V_x \\left(\\frac{2\\pi}{a}\\right)^2 \\cos(\\frac{2\\pi x}{a})  0 \\\\ 0  -V_y \\left(\\frac{2\\pi}{b}\\right)^2 \\cos(\\frac{2\\pi y}{b}) \\end{pmatrix}$$\n\n**1. 分析 $x$ 方向的跳跃 ($k_x$)**\n\n$x$ 方向的一次跳跃连接两个相邻的极小值点，例如，从 $(-\\frac{a}{2}, \\frac{b}{2})$ 到 $(\\frac{a}{2}, \\frac{b}{2})$。\n\n**极小值点（初态）：**\n让我们考虑位于 $(x_{MIN}, y_{MIN}) = (-\\frac{a}{2}, \\frac{b}{2})$ 的极小值点。\n势能为 $V_{MIN} = V_x \\cos(-\\pi) + V_y \\cos(\\pi) = -V_x - V_y$。\n极小值点处海森矩阵的对角元是等效劲度系数。在 $x=\\pm a/2$ 处，$H_{xx} = -V_x (\\frac{2\\pi}{a})^2 \\cos(\\pm \\pi) = V_x (\\frac{2\\pi}{a})^2$。因此，$k_{x,MIN} = V_x (\\frac{2\\pi}{a})^2$。类似地，$k_{y,MIN} = V_y (\\frac{2\\pi}{b})^2$。\n极小值点处的振动频率为 $\\nu = \\frac{1}{2\\pi}\\sqrt{k/m}$：\n$\\nu_x^{MIN} = \\frac{1}{2\\pi}\\sqrt{\\frac{k_{x,MIN}}{m}} = \\frac{1}{a}\\sqrt{\\frac{V_x}{m}}$\n$\\nu_y^{MIN} = \\frac{1}{2\\pi}\\sqrt{\\frac{k_{y,MIN}}{m}} = \\frac{1}{b}\\sqrt{\\frac{V_y}{m}}$\n\n**鞍点（x-方向跳跃的过渡态）：**\n在 $(-\\frac{a}{2}, \\frac{b}{2})$ 和 $(\\frac{a}{2}, \\frac{b}{2})$ 之间跳跃的过渡态位于中点 $(x_{SPx}, y_{SPx}) = (0, \\frac{b}{2})$。\n势能为 $V_{SP,x} = V_x \\cos(0) + V_y \\cos(\\pi) = V_x - V_y$。\nx-方向跳跃的活化能是 $E_{a,x} = V_{SP,x} - V_{MIN} = (V_x - V_y) - (-V_x - V_y) = 2V_x$。\n在此鞍点，海森分量为：\n$H_{xx} = -V_x (\\frac{2\\pi}{a})^2 \\cos(0) = -V_x (\\frac{2\\pi}{a})^2  0$（不稳定模式，反应坐标）。\n$H_{yy} = -V_y (\\frac{2\\pi}{b})^2 \\cos(\\pi) = V_y (\\frac{2\\pi}{b})^2  0$（稳定模式）。\n在此鞍点，单一束缚振动的频率是沿 $y$ 方向的：\n$\\nu_y^{SPx} = \\frac{1}{2\\pi}\\sqrt{\\frac{V_y (2\\pi/b)^2}{m}} = \\frac{1}{b}\\sqrt{\\frac{V_y}{m}}$。注意 $\\nu_y^{SPx} = \\nu_y^{MIN}$。\n\n**跳跃速率 $k_x$：**\n使用 TST 公式：\n$$k_x = \\frac{\\nu_x^{MIN} \\nu_y^{MIN}}{\\nu_y^{SPx}} \\exp\\left(-\\frac{E_{a,x}}{k_B T}\\right) = \\nu_x^{MIN} \\exp\\left(-\\frac{2V_x}{k_B T}\\right)$$\n$$k_x = \\frac{1}{a}\\sqrt{\\frac{V_x}{m}} \\exp\\left(-\\frac{2V_x}{k_B T}\\right)$$\n\n**2. 分析 $y$ 方向的跳跃 ($k_y$)**\n\n$y$ 方向的一次跳跃连接，例如，从极小值点 $(\\frac{a}{2}, -\\frac{b}{2})$ 到 $(\\frac{a}{2}, \\frac{b}{2})$。\n\n**极小值点（初态）：**\n极小值点的性质与之前相同。$V_{MIN} = -V_x - V_y$。\n$\\nu_x^{MIN} = \\frac{1}{a}\\sqrt{\\frac{V_x}{m}}$ 且 $\\nu_y^{MIN} = \\frac{1}{b}\\sqrt{\\frac{V_y}{m}}$。\n\n**鞍点（y-方向跳跃的过渡态）：**\n过渡态位于 $(x_{SPy}, y_{SPy}) = (\\frac{a}{2}, 0)$。\n势能为 $V_{SP,y} = V_x \\cos(\\pi) + V_y \\cos(0) = -V_x + V_y$。\n活化能是 $E_{a,y} = V_{SP,y} - V_{MIN} = (-V_x + V_y) - (-V_x - V_y) = 2V_y$。\n在此鞍点，海森分量为：\n$H_{xx} = -V_x (\\frac{2\\pi}{a})^2 \\cos(\\pi) = V_x (\\frac{2\\pi}{a})^2  0$（稳定模式）。\n$H_{yy} = -V_y (\\frac{2\\pi}{b})^2 \\cos(0) = -V_y (\\frac{2\\pi}{b})^2  0$（不稳定模式）。\n单一束缚振动的频率是沿 $x$ 方向的：\n$\\nu_x^{SPy} = \\frac{1}{2\\pi}\\sqrt{\\frac{V_x (2\\pi/a)^2}{m}} = \\frac{1}{a}\\sqrt{\\frac{V_x}{m}}$。注意 $\\nu_x^{SPy} = \\nu_x^{MIN}$。\n\n**跳跃速率 $k_y$：**\n$$k_y = \\frac{\\nu_x^{MIN} \\nu_y^{MIN}}{\\nu_x^{SPy}} \\exp\\left(-\\frac{E_{a,y}}{k_B T}\\right) = \\nu_y^{MIN} \\exp\\left(-\\frac{2V_y}{k_B T}\\right)$$\n$$k_y = \\frac{1}{b}\\sqrt{\\frac{V_y}{m}} \\exp\\left(-\\frac{2V_y}{k_B T}\\right)$$\n\n**3. 扩散系数之比**\n\n现在我们可以计算比率 $D_{xx}/D_{yy}$。\n$$D_{xx} = k_x a^2 = \\left(\\frac{1}{a}\\sqrt{\\frac{V_x}{m}} \\exp\\left(-\\frac{2V_x}{k_B T}\\right)\\right) a^2 = a\\sqrt{\\frac{V_x}{m}} \\exp\\left(-\\frac{2V_x}{k_B T}\\right)$$\n$$D_{yy} = k_y b^2 = \\left(\\frac{1}{b}\\sqrt{\\frac{V_y}{m}} \\exp\\left(-\\frac{2V_y}{k_B T}\\right)\\right) b^2 = b\\sqrt{\\frac{V_y}{m}} \\exp\\left(-\\frac{2V_y}{k_B T}\\right)$$\n该比率为：\n$$\\frac{D_{xx}}{D_{yy}} = \\frac{a\\sqrt{\\frac{V_x}{m}} \\exp\\left(-\\frac{2V_x}{k_B T}\\right)}{b\\sqrt{\\frac{V_y}{m}} \\exp\\left(-\\frac{2V_y}{k_B T}\\right)}$$\n简化表达式：\n$$\\frac{D_{xx}}{D_{yy}} = \\frac{a}{b} \\sqrt{\\frac{V_x}{V_y}} \\frac{\\exp\\left(-\\frac{2V_x}{k_B T}\\right)}{\\exp\\left(-\\frac{2V_y}{k_B T}\\right)} = \\frac{a}{b} \\sqrt{\\frac{V_x}{V_y}} \\exp\\left(-\\frac{2V_x}{k_B T} + \\frac{2V_y}{k_B T}\\right)$$\n$$\\frac{D_{xx}}{D_{yy}} = \\frac{a}{b} \\sqrt{\\frac{V_x}{V_y}} \\exp\\left(\\frac{2(V_y - V_x)}{k_B T}\\right)$$\n这就是扩散系数之比的最终解析表达式。",
            "answer": "$$\\boxed{\\frac{a}{b} \\sqrt{\\frac{V_x}{V_y}} \\exp\\left(\\frac{2(V_y - V_x)}{k_B T}\\right)}$$"
        }
    ]
}