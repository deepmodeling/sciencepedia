{
    "hands_on_practices": [
        {
            "introduction": "This first exercise grounds our understanding of Kinetic Monte Carlo in a fundamental physical model. By analyzing the simplest possible catalytic system—a single site undergoing adsorption and desorption—we can directly connect the microscopic rates of KMC to a macroscopic, analytically solvable differential equation . This practice is valuable for building intuition about how the elementary steps in a KMC simulation give rise to well-known kinetic models, in this case, the time-dependent approach to the Langmuir isotherm.",
            "id": "3884607",
            "problem": "Consider a single catalytic site represented as a two-state on-lattice model in a Kinetic Monte Carlo (KMC) framework. The site can be either vacant or occupied by an adsorbate. The system is coupled to a gas phase at fixed partial pressure $p$ and temperature, and the adsorbate desorbs back into the continuum (off-lattice) gas phase. Assume the following:\n\n- Adsorption onto a vacant site occurs with propensity proportional to the gas partial pressure, modeled by a rate $k_a p$, where $k_a$ is a constant capturing the sticking probability and molecular impingement kinetics.\n- Desorption from an occupied site occurs with a constant rate $k_d$ that depends on the activation energy and temperature via an Arrhenius-type dependence, but is treated here as a known constant.\n- Let $P_{\\text{occupied}}(t)$ denote the probability that the site is occupied at time $t$, and assume the initial condition $P_{\\text{occupied}}(0)=0$ (initially vacant).\n- There are no lateral interactions between sites, and the gas-phase supply maintains $p$ constant in time. The underlying dynamics can be modeled as a two-state Continuous-Time Markov Chain (CTMC).\n\nStarting from the master equation for a two-state CTMC, derive the time-dependent expression for $P_{\\text{occupied}}(t)$ in terms of $k_a$, $p$, $k_d$, and $t$, and determine the long-time limit of the coverage as $t \\to \\infty$. Express your final answer as a single closed-form analytic expression for $P_{\\text{occupied}}(t)$ with all parameters symbolic. No numerical evaluation or rounding is required. The final answer should be dimensionless.",
            "solution": "The problem presents a valid and well-posed scenario grounded in the fundamental principles of chemical kinetics and statistical mechanics. It describes the Langmuir adsorption-desorption process on a single catalytic site, which can be rigorously modeled as a two-state Continuous-Time Markov Chain (CTMC). All necessary parameters, rates, and initial conditions are provided, and there are no internal contradictions or scientific inaccuracies. I will now proceed to derive the solution.\n\nLet the state of the single catalytic site be described by a stochastic variable. The site can be in one of two states: vacant (state $V$) or occupied (state $O$). Let $P_V(t)$ be the probability that the site is vacant at time $t$, and let $P_{\\text{occupied}}(t)$ be the probability that the site is occupied at time $t$. As there are only two possible states, the probabilities must sum to unity at all times:\n$$P_V(t) + P_{\\text{occupied}}(t) = 1$$\nThe problem provides the initial condition that the site is vacant at $t=0$, which translates to:\n$$P_{\\text{occupied}}(0) = 0$$\nThis implies that $P_V(0) = 1$.\n\nThe dynamics of the system are governed by two elementary processes:\n1. Adsorption: A molecule from the gas phase adsorbs onto a vacant site. This is a transition from state $V$ to state $O$. The rate of this process is given as proportional to the partial pressure $p$, specifically $k_a p$.\n2. Desorption: An adsorbed molecule desorbs from an occupied site back into the gas phase. This is a transition from state $O$ to state $V$. The rate of this process is given as a constant, $k_d$.\n\nThe time evolution of the probability of the site being occupied, $P_{\\text{occupied}}(t)$, is described by the master equation for this two-state CTMC. The rate of change of $P_{\\text{occupied}}(t)$ is the rate of transitions into the occupied state minus the rate of transitions out of the occupied state.\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = (\\text{rate of } V \\to O) - (\\text{rate of } O \\to V) $$\nThe rate of transitions into state $O$ is the probability of being in state $V$, $P_V(t)$, multiplied by the transition rate from $V$ to $O$, which is $k_a p$.\nThe rate of transitions out of state $O$ is the probability of being in state $O$, $P_{\\text{occupied}}(t)$, multiplied by the transition rate from $O$ to $V$, which is $k_d$.\nThus, the master equation is:\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = (k_a p) P_V(t) - k_d P_{\\text{occupied}}(t) $$\nTo solve this equation for $P_{\\text{occupied}}(t)$, we must eliminate $P_V(t)$. Using the conservation of probability, $P_V(t) = 1 - P_{\\text{occupied}}(t)$, we substitute this into the master equation:\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = k_a p (1 - P_{\\text{occupied}}(t)) - k_d P_{\\text{occupied}}(t) $$\nExpanding the terms, we get:\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = k_a p - k_a p P_{\\text{occupied}}(t) - k_d P_{\\text{occupied}}(t) $$\nThis is a first-order linear ordinary differential equation. We can rearrange it into the standard form $\\frac{dy}{dt} + f(t)y = g(t)$:\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} + (k_a p + k_d) P_{\\text{occupied}}(t) = k_a p $$\nThis equation can be solved using the method of integrating factors. The integrating factor, $I(t)$, is given by:\n$$ I(t) = \\exp\\left(\\int (k_a p + k_d) dt\\right) = \\exp((k_a p + k_d)t) $$\nMultiplying the entire differential equation by $I(t)$:\n$$ \\exp((k_a p + k_d)t) \\frac{dP_{\\text{occupied}}(t)}{dt} + (k_a p + k_d) \\exp((k_a p + k_d)t) P_{\\text{occupied}}(t) = k_a p \\exp((k_a p + k_d)t) $$\nThe left-hand side of the equation is now the derivative of the product of $P_{\\text{occupied}}(t)$ and the integrating factor $I(t)$:\n$$ \\frac{d}{dt} \\left[ P_{\\text{occupied}}(t) \\exp((k_a p + k_d)t) \\right] = k_a p \\exp((k_a p + k_d)t) $$\nNext, we integrate both sides with respect to time $t$:\n$$ \\int \\frac{d}{dt} \\left[ P_{\\text{occupied}}(t) \\exp((k_a p + k_d)t) \\right] dt = \\int k_a p \\exp((k_a p + k_d)t) dt $$\n$$ P_{\\text{occupied}}(t) \\exp((k_a p + k_d)t) = \\frac{k_a p}{k_a p + k_d} \\exp((k_a p + k_d)t) + C $$\nwhere $C$ is the constant of integration. To find the general solution for $P_{\\text{occupied}}(t)$, we isolate it by dividing by the integrating factor:\n$$ P_{\\text{occupied}}(t) = \\frac{k_a p}{k_a p + k_d} + C \\exp(-(k_a p + k_d)t) $$\nTo determine the constant $C$, we apply the initial condition $P_{\\text{occupied}}(0) = 0$:\n$$ 0 = \\frac{k_a p}{k_a p + k_d} + C \\exp(0) $$\n$$ 0 = \\frac{k_a p}{k_a p + k_d} + C $$\nSolving for $C$, we find:\n$$ C = -\\frac{k_a p}{k_a p + k_d} $$\nSubstituting this value of $C$ back into the general solution gives the specific solution for $P_{\\text{occupied}}(t)$:\n$$ P_{\\text{occupied}}(t) = \\frac{k_a p}{k_a p + k_d} - \\frac{k_a p}{k_a p + k_d} \\exp(-(k_a p + k_d)t) $$\nFactoring out the common term provides the final, tidy expression:\n$$ P_{\\text{occupied}}(t) = \\frac{k_a p}{k_a p + k_d} \\left( 1 - \\exp(-(k_a p + k_d)t) \\right) $$\nThis is the time-dependent expression for the probability of the site being occupied.\n\nThe problem also requires determining the long-time limit of the coverage, which is equivalent to $P_{\\text{occupied}}(t)$ as $t \\to \\infty$. Taking the limit:\n$$ \\lim_{t \\to \\infty} P_{\\text{occupied}}(t) = \\lim_{t \\to \\infty} \\left[ \\frac{k_a p}{k_a p + k_d} \\left( 1 - \\exp(-(k_a p + k_d)t) \\right) \\right] $$\nSince $k_a$, $p$, and $k_d$ are positive constants, the sum $k_a p + k_d$ is positive. Therefore, the exponential term decays to zero as $t \\to \\infty$:\n$$ \\lim_{t \\to \\infty} \\exp(-(k_a p + k_d)t) = 0 $$\nThe steady-state occupancy is thus:\n$$ P_{\\text{occupied}}(t \\to \\infty) = \\frac{k_a p}{k_a p + k_d} (1 - 0) = \\frac{k_a p}{k_a p + k_d} $$\nThis result is the well-known Langmuir isotherm, which gives the fractional surface coverage at equilibrium. This confirms the physical correctness of our derived time-dependent solution.\nThe final answer required is the full time-dependent expression for $P_{\\text{occupied}}(t)$.",
            "answer": "$$\n\\boxed{\\frac{k_a p}{k_a p + k_d} \\left( 1 - \\exp(-(k_a p + k_d)t) \\right)}\n$$"
        },
        {
            "introduction": "To simulate a realistic surface, we must scale up from an isolated site to a large grid, which introduces the challenge of handling boundaries. This practice addresses a crucial implementation detail of on-lattice KMC: creating a seamless simulation space to minimize finite-size artifacts . Mastering the logic of periodic boundary conditions and the corresponding index calculations is an essential programming skill for developing robust and correct on-lattice models.",
            "id": "3884595",
            "problem": "A catalytic surface is modeled as a rectangular, on-lattice Kinetic Monte Carlo (KMC) system with Periodic Boundary Conditions (PBC) in both directions. The surface consists of a grid of $L_x \\times L_y$ lattice sites. In PBC, the lattice is topologically a torus: lattice coordinates are identified modulo the lattice periodicities, so that moving one step beyond a boundary re-enters from the opposite side. Sites are enumerated by a linear site index $s$ in row-major order, i.e., the map from coordinates to linear index is $s = i + L_x \\, j$ with coordinate indices $i \\in \\{0,\\ldots,L_x-1\\}$ and $j \\in \\{0,\\ldots,L_y-1\\}$. Assume the modulo operator on an integer $a \\bmod n$ returns the unique remainder in $\\{0,\\ldots,n-1\\}$ and that $\\lfloor \\cdot \\rfloor$ denotes the floor function.\n\nIn an on-lattice KMC step, to propose nearest-neighbor diffusion or reaction events, one must compute for any site $s$ the linear indices of its four nearest neighbors along $\\pm \\hat{\\boldsymbol{x}}$ and $\\pm \\hat{\\boldsymbol{y}}$, such that there are no edge artifacts under PBC.\n\nWhich option gives a correct and implementation-robust prescription for computing the four neighbor indices for every site $s$ that is consistent with the definitions above and avoids edge artifacts?\n\nA. Compute coordinates from $s$ by $i = s \\bmod L_x$ and $j = \\left\\lfloor s / L_x \\right\\rfloor$. Then compute\n- Right neighbor: $s_{\\mathrm{R}} = \\left(\\left(i + 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$,\n- Left neighbor: $s_{\\mathrm{L}} = \\left(\\left(i - 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$,\n- Up neighbor: $s_{\\mathrm{U}} = i + L_x \\left(\\left(j + 1 + L_y\\right) \\bmod L_y\\right)$,\n- Down neighbor: $s_{\\mathrm{D}} = i + L_x \\left(\\left(j - 1 + L_y\\right) \\bmod L_y\\right)$.\n\nB. Work directly with the linear index $s$ and set\n- Right neighbor: $s_{\\mathrm{R}} = \\left(s + 1\\right) \\bmod \\left(L_x L_y\\right)$,\n- Left neighbor: $s_{\\mathrm{L}} = \\left(s - 1 + L_x L_y\\right) \\bmod \\left(L_x L_y\\right)$,\n- Up neighbor: $s_{\\mathrm{U}} = \\left(s + L_x\\right) \\bmod \\left(L_x L_y\\right)$,\n- Down neighbor: $s_{\\mathrm{D}} = \\left(s - L_x + L_x L_y\\right) \\bmod \\left(L_x L_y\\right)$.\n\nC. Use one-based coordinates but the same linear index $s \\in \\{0,\\ldots,L_x L_y - 1\\}$: set $i' = 1 + (s \\bmod L_x)$ and $j' = 1 + \\left\\lfloor s / L_x \\right\\rfloor$, then define\n- $i'_{\\mathrm{R}} = \\left(\\left(i' + 1\\right) \\bmod L_x\\right)$, $i'_{\\mathrm{L}} = \\left(\\left(i' - 1 + L_x\\right) \\bmod L_x\\right)$, $j'_{\\mathrm{U}} = \\left(\\left(j' + 1\\right) \\bmod L_y\\right)$, $j'_{\\mathrm{D}} = \\left(\\left(j' - 1 + L_y\\right) \\bmod L_y\\right)$,\nand map back to linear indices via $s_{\\alpha} = i'_{\\alpha} + L_x \\, j'_{\\alpha}$ for $\\alpha \\in \\{\\mathrm{R,L,U,D}\\}$.\n\nD. Compute coordinates by $i = \\left\\lfloor s / L_y \\right\\rfloor$ and $j = s \\bmod L_y$ (column-major style), then set\n- Right neighbor: $s_{\\mathrm{R}} = \\left(\\left(i + 1 + L_y\\right) \\bmod L_y\\right) + L_y \\, j$,\n- Left neighbor: $s_{\\mathrm{L}} = \\left(\\left(i - 1 + L_y\\right) \\bmod L_y\\right) + L_y \\, j$,\n- Up neighbor: $s_{\\mathrm{U}} = i + L_y \\left(\\left(j + 1 + L_x\\right) \\bmod L_x\\right)$,\n- Down neighbor: $s_{\\mathrm{D}} = i + L_y \\left(\\left(j - 1 + L_x\\right) \\bmod L_x\\right)$.\n\nSelect one option.",
            "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **System:** A rectangular, on-lattice Kinetic Monte Carlo (KMC) model.\n- **Lattice Dimensions:** A grid of $L_x \\times L_y$ lattice sites.\n- **Boundary Conditions:** Periodic Boundary Conditions (PBC) in both $\\hat{\\boldsymbol{x}}$ and $\\hat{\\boldsymbol{y}}$ directions, making the lattice a topological torus.\n- **Site Indexing:** Sites are enumerated by a linear index $s$.\n- **Indexing Scheme:** Row-major order is specified.\n- **Coordinate-to-Index Map:** The mapping from 2D coordinates $(i, j)$ to the linear index $s$ is explicitly given as $s = i + L_x \\, j$.\n- **Coordinate Ranges:** The coordinate indices are $i \\in \\{0, \\ldots, L_x-1\\}$ and $j \\in \\{0, \\ldots, L_y-1\\}$.\n- **Modulo Operator:** The operator $a \\bmod n$ returns the unique remainder in the set $\\{0, \\ldots, n-1\\}$.\n- **Floor Function:** $\\lfloor \\cdot \\rfloor$ denotes the standard floor function.\n- **Objective:** To find a correct and implementation-robust set of formulas for the linear indices of the four nearest neighbors (Right, Left, Up, Down) for any site $s$, consistent with the definitions and PBC.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in computational physics and materials science. Lattice models with PBC and row-major indexing are standard constructs in KMC and other simulation techniques. The problem is a practical exercise in implementing neighborhood finding on a periodic grid. It is scientifically valid.\n- **Well-Posed:** All necessary information is provided. The lattice structure, indexing scheme, and boundary conditions are explicitly defined. The goal is to find a set of mathematical expressions, which can be derived and verified. A unique correct solution exists.\n- **Objective:** The problem is stated in precise mathematical language. Terms like \"row-major order\" and the specific coordinate-to-index mapping formula leave no room for ambiguity. The term \"implementation-robust\" is reasonably interpreted in this context as avoiding common pitfalls of specific programming language implementations of the modulo operator (e.g., for negative operands), a standard consideration in computational science.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a well-defined, standard problem in computational science. I will now proceed to derive the solution and evaluate the given options.\n\n### Derivation of the Correct Neighbor Finding Prescription\n\n1.  **Inverse Mapping (Linear Index to Coordinates):**\n    We are given the row-major mapping $s = i + L_x \\, j$, where $i \\in \\{0, \\ldots, L_x-1\\}$ and $j \\in \\{0, \\ldots, L_y-1\\}$. To find the neighbors of a site $s$, we must first determine its coordinates $(i, j)$.\n    -   To find the column index $i$, we can take the expression modulo $L_x$:\n        $$s \\bmod L_x = (i + L_x \\, j) \\bmod L_x$$\n        Since $L_x \\, j$ is a multiple of $L_x$, its remainder modulo $L_x$ is $0$. As $i \\in \\{0, \\ldots, L_x-1\\}$, we have $i \\bmod L_x = i$.\n        Therefore, $i = s \\bmod L_x$.\n    -   To find the row index $j$, we use integer division. From $s = i + L_x \\, j$, we can write $s - i = L_x \\, j$. Thus, $j = (s - i) / L_x$. Since $i$ and $j$ must be integers, this implies $j = \\lfloor (s - i) / L_x \\rfloor$. Substituting $i = s \\bmod L_x$, we get $j = \\lfloor (s - (s \\bmod L_x)) / L_x \\rfloor$. By the definition of integer division, $s = \\lfloor s/L_x \\rfloor L_x + (s \\bmod L_x)$. Comparing this to $s = j L_x + i$, we directly identify $j = \\lfloor s / L_x \\rfloor$.\n    -   So, the inverse mapping is: $i = s \\bmod L_x$ and $j = \\lfloor s / L_x \\rfloor$.\n\n2.  **Neighbor Coordinates with PBC:**\n    For a site at coordinates $(i, j)$, its nearest neighbors' coordinates are found by adding or subtracting $1$ from the corresponding coordinate and applying PBC.\n    -   Right neighbor ($\\hat{\\boldsymbol{x}}$ direction): $(i+1, j)$. With PBC, the new $x$-coordinate becomes $(i+1) \\bmod L_x$. The coordinate is $((i+1) \\bmod L_x, j)$.\n    -   Left neighbor ($-\\hat{\\boldsymbol{x}}$ direction): $(i-1, j)$. With PBC, the new $x$-coordinate is $(i-1) \\bmod L_x$. The coordinate is $((i-1) \\bmod L_x, j)$.\n    -   Up neighbor ($\\hat{\\boldsymbol{y}}$ direction): $(i, j+1)$. With PBC, the new $y$-coordinate is $(j+1) \\bmod L_y$. The coordinate is $(i, (j+1) \\bmod L_y)$.\n    -   Down neighbor ($-\\hat{\\boldsymbol{y}}$ direction): $(i, j-1)$. With PBC, the new $y$-coordinate is $(j-1) \\bmod L_y$. The coordinate is $(i, (j-1) \\bmod L_y)$.\n\n    To ensure \"implementation-robustness,\" especially in programming languages where `a % n` can be negative for negative `a`, it is standard practice to use the form `(a + n) % n`. This yields:\n    -   $i_{\\mathrm{L}} = (i - 1 + L_x) \\bmod L_x$\n    -   $j_{\\mathrm{D}} = (j - 1 + L_y) \\bmod L_y$\n    The expressions for right and up neighbors do not strictly need this as $i+1$ and $j+1$ are always non-negative, but applying the same pattern for consistency is common:\n    -   $i_{\\mathrm{R}} = (i + 1 + L_x) \\bmod L_x = (i + 1) \\bmod L_x$\n    -   $j_{\\mathrm{U}} = (j + 1 + L_y) \\bmod L_y = (j + 1) \\bmod L_y$\n\n3.  **Forward Mapping (Neighbor Coordinates to Linear Index):**\n    We now use the original mapping $s_{\\text{neighbor}} = i_{\\text{neighbor}} + L_x \\, j_{\\text{neighbor}}$ to find the linear indices of the neighbors.\n    -   Right neighbor: $s_{\\mathrm{R}} = ((i + 1) \\bmod L_x) + L_x \\, j$. Robust form: $s_{\\mathrm{R}} = ((i + 1 + L_x) \\bmod L_x) + L_x \\, j$.\n    -   Left neighbor: $s_{\\mathrm{L}} = ((i - 1 + L_x) \\bmod L_x) + L_x \\, j$.\n    -   Up neighbor: $s_{\\mathrm{U}} = i + L_x \\, ((j + 1 + L_y) \\bmod L_y)$.\n    -   Down neighbor: $s_{\\mathrm{D}} = i + L_x \\, ((j - 1 + L_y) \\bmod L_y)$.\n\nThis completes the derivation. Now we evaluate the options.\n\n### Option-by-Option Analysis\n\n**A. Compute coordinates from $s$ by $i = s \\bmod L_x$ and $j = \\left\\lfloor s / L_x \\right\\rfloor$. Then compute...**\n- The coordinate extraction formulas are $i = s \\bmod L_x$ and $j = \\lfloor s / L_x \\rfloor$. This perfectly matches our derivation for row-major order.\n- The neighbor index formulas are:\n  - $s_{\\mathrm{R}} = \\left(\\left(i + 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$\n  - $s_{\\mathrm{L}} = \\left(\\left(i - 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$\n  - $s_{\\mathrm{U}} = i + L_x \\left(\\left(j + 1 + L_y\\right) \\bmod L_y\\right)$\n  - $s_{\\mathrm{D}} = i + L_x \\left(\\left(j - 1 + L_y\\right) \\bmod L_y\\right)$\nThese formulas are identical to those derived from first principles, including the robust implementation of the modulo operator.\n**Verdict: Correct.**\n\n**B. Work directly with the linear index $s$ and set...**\nThis option avoids converting to 2D coordinates and works directly with the linear index $s$.\n- **Right neighbor:** $s_{\\mathrm{R}} = (s + 1) \\bmod (L_x L_y)$. Let's test this on a site at the right edge of a row, e.g., $i = L_x-1$. Its index is $s = (L_x-1) + L_x j$. The formula gives $s+1 = (L_x-1) + L_x j + 1 = L_x + L_x j = L_x(j+1)$. This corresponds to the site with coordinates $(0, j+1)$, which is the first site of the *next* row. The correct neighbor is at $(0, j)$, with index $0 + L_x j = L_x j$. The formula is incorrect as it does not wrap around within the same row. This method only works for 1D PBC.\n- **Left neighbor:** $s_{\\mathrm{L}} = (s - 1 + L_x L_y) \\bmod (L_x L_y)$. Similarly, for a site at the left edge ($i=0$), $s = L_x j$. The formula gives $s-1 = L_x j - 1 = (L_x-1) + L_x(j-1)$, which is the last site of the *previous* row. The correct neighbor is at $(L_x-1, j)$, index $(L_x-1) + L_x j$. The formula is incorrect.\n- **Up/Down neighbors:** The formulas $s_{\\mathrm{U}} = (s+L_x) \\bmod (L_x L_y)$ and $s_{\\mathrm{D}} = (s-L_x+L_x L_y) \\bmod (L_x L_y)$ are fortuitously correct. Because of the row-major ordering, moving up or down a row corresponds to adding or subtracting a full row length, $L_x$, from the index. The modulo by the total number of sites, $L_x L_y$, correctly handles the wrap-around between the top and bottom rows.\nHowever, since the prescription for left and right neighbors is flawed, the option as a whole is invalid.\n**Verdict: Incorrect.**\n\n**C. Use one-based coordinates but the same linear index $s \\in \\{0,\\ldots,L_x L_y - 1\\}$...**\nThis option introduces a one-based coordinate system, $i' \\in \\{1, \\ldots, L_x\\}$ and $j' \\in \\{1, \\ldots, L_y\\}$.\n- The mapping $i' = 1 + (s \\bmod L_x)$ and $j' = 1 + \\lfloor s / L_x \\rfloor$ correctly converts a $0$-based index $s$ to $1$-based coordinates $(i', j')$.\n- The neighbor coordinate formulas, e.g., $i'_{\\mathrm{R}} = ((i' + 1) \\bmod L_x)$, are flawed. Because $i'$ is $1$-based, for the rightmost column $i' = L_x$, this gives $(L_x+1) \\bmod L_x = 1$. This seems to wrap correctly from column $L_x$ to $1$. However, for $i' = L_x-1$, it gives $(L_x-1+1) \\bmod L_x = L_x \\bmod L_x = 0$. The resulting coordinate $i'_{R}$ is $0$, which is outside the defined one-based range $\\{1, ..., L_x\\}$. The option mixes one-based and zero-based indexing conventions in an inconsistent manner.\n- The final formula for re-mapping to a linear index, $s_{\\alpha} = i'_{\\alpha} + L_x \\, j'_{\\alpha}$, is also inconsistent. It takes a calculated neighbor coordinate (e.g., $i'_{\\mathrm{R}}$, which we found could be $0$-based) and adds it to $L_x$ times another neighbor coordinate (e.g., $j'_{\\mathrm{R}}$). The notation is ambiguous, and the mixture of indexing bases makes it fundamentally unsound.\n**Verdict: Incorrect.**\n\n**D. Compute coordinates by $i = \\left\\lfloor s / L_y \\right\\rfloor$ and $j = s \\bmod L_y$ (column-major style)...**\nThis option proposes an alternative coordinate extraction scheme.\n- The problem statement explicitly defines **row-major order** with the map $s = i + L_x \\, j$.\n- The formulas proposed in this option, $i = \\lfloor s / L_y \\rfloor$ and $j = s \\bmod L_y$, correspond to **column-major order**, where the index increases fastest along columns. This can be seen by writing its inverse map: $s = j + L_y \\, i$.\n- This initial step directly contradicts the premise given in the problem statement. Any subsequent calculations based on this incorrect premise are therefore invalid in the context of the stated problem.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from the discrete grid of on-lattice models, this exercise delves into the continuous world of off-lattice simulations where particle positions are not restricted to fixed sites. We will explore the conceptual and mathematical nature of boundary conditions, such as absorbing and reflecting walls, which encode physical interactions at edges or sinks . By deriving the mean residence time of a diffusing particle near a boundary, you will practice applying the principles of stochastic processes to quantify particle behavior in an off-lattice environment.",
            "id": "3884627",
            "problem": "A catalytic surface microenvironment is often idealized in kinetic Monte Carlo (KMC) as a set of coupled reaction-diffusion events. In off-lattice diffusion, the position of an adsorbate is a continuous variable that evolves stochastically, and boundaries encode physical interactions with edges, steps, and sinks. Explain, in conceptual terms appropriate for off-lattice diffusion in KMC, how reflective and absorbing boundaries modify the evolution of a diffusing particle at a boundary. Then, consider a single diffusing adsorbate on a one-dimensional line segment representing a normal coordinate to a flat catalyst terrace, with domain $x \\in [0,L]$, where $x=0$ is the physical boundary of interest and $x=L$ represents a distant reflecting wall. The particle undergoes unbiased diffusion with constant diffusion coefficient $D>0$, starts at $x=x_0$ with $x_0 \\in (\\ell,L)$, and evolves until absorption at $x=0$. Define the “mean residence time near the boundary” as the expected total time the particle spends in the boundary layer $x \\in [0,\\ell]$ prior to absorption at $x=0$, where $\\ell \\in (0,L)$ is a fixed layer thickness.\n\nStarting from fundamental definitions of Brownian motion and its Fokker–Planck generator, derive a boundary-value formulation for the mean residence time in $[0,\\ell]$ and solve it to obtain an analytical expression in terms of $D$ and $\\ell$ for the mean residence time when $x_0 \\in (\\ell,L)$. Express your final answer in seconds. No rounding is required; report a closed-form expression.",
            "solution": "The problem asks for two things: first, a conceptual explanation of reflective and absorbing boundaries in the context of off-lattice kinetic Monte Carlo (KMC) diffusion; and second, the derivation and solution of a boundary-value problem for the mean residence time of a diffusing particle in a specific region of a one-dimensional domain.\n\nFirst, we address the conceptual part. In an off-lattice KMC simulation, a particle's position is a continuous variable. The particle's trajectory is a sequence of stochastic jumps, where the time between jumps and the destination of each jump are determined by the underlying physical model, often a Langevin equation or its overdamped limit, Brownian motion. Boundaries represent physical constraints or interfaces.\n\nAn **absorbing boundary** at a position, say $x=0$, represents a perfect sink. When a diffusing particle's trajectory first reaches this boundary, it is immediately and permanently removed from the system. In a simulation, this means the particle's state is set to 'absorbed', and its trajectory is terminated. In the language of partial differential equations (PDEs) that describe the probability density of the particle, such as the Fokker-Planck equation, an absorbing boundary imposes a Dirichlet boundary condition. For example, the probability density $p(x,t)$ is set to zero at the boundary for all time $t>0$, i.e., $p(0,t)=0$, because any particle reaching that point is instantly removed.\n\nA **reflecting boundary** at a position, say $x=L$, represents an impenetrable barrier that conserves the particle within the domain. When a particle encounters this boundary, its velocity component normal to the boundary is reversed, essentially 'bouncing' it back into the domain. In a simulation of Brownian motion, this can be implemented by reflecting the proposed move across the boundary plane. For the corresponding Fokker-Planck equation, a reflecting boundary imposes a no-flux condition, which is a Neumann boundary condition. The flux $J(x,t)$ is proportional to the spatial derivative of the probability density, $J(x,t) = -D \\frac{\\partial p}{\\partial x}$. A no-flux condition thus translates to $\\frac{\\partial p}{\\partial x}\\big|_{x=L} = 0$.\n\nNow, we proceed with the mathematical derivation. The system consists of a single particle undergoing unbiased one-dimensional diffusion on the domain $x \\in [0,L]$, governed by the stochastic differential equation for Brownian motion: $dX_t = \\sqrt{2D} dW_t$, where $D$ is the constant diffusion coefficient and $W_t$ is a standard Wiener process. The boundary at $x=0$ is absorbing, and the boundary at $x=L$ is reflecting.\n\nWe are asked to find the \"mean residence time\" in the boundary layer $[0,\\ell]$, which we denote by $T(x_0)$. This is the expected total time the particle spends in the interval $[0,\\ell]$ before it is absorbed at $x=0$, given that it starts at position $x_0$. Mathematically, this is expressed as:\n$$ T(x_0) = \\mathbb{E}_{x_0}\\left[ \\int_0^{\\tau_0} \\mathbb{I}_{[0,\\ell]}(X_t) dt \\right] $$\nwhere $\\mathbb{E}_{x_0}$ is the expectation conditioned on the starting position $X_0 = x_0$, $\\tau_0$ is the first passage time to the absorbing boundary at $x=0$, and $\\mathbb{I}_{[0,\\ell]}(x)$ is the indicator function, which equals $1$ if $x \\in [0,\\ell]$ and $0$ otherwise.\n\nThe governing equation for such expected values is the backward Fokker-Planck (or Kolmogorov backward) equation. For a general functional $\\mathbb{E}_x[\\int_0^{\\tau} f(X_t) dt]$, the expected value $g(x)$ satisfies the ordinary differential equation (ODE) $\\mathcal{L}g(x) = -f(x)$, where $\\mathcal{L}$ is the generator of the diffusion process. For unbiased diffusion in one dimension, the generator is $\\mathcal{L} = D \\frac{d^2}{dx^2}$. In our problem, the function $f(x)$ is the indicator function $\\mathbb{I}_{[0,\\ell]}(x)$.\n\nTherefore, the mean residence time $T(x)$ satisfies the following Poisson equation:\n$$ D \\frac{d^2 T}{dx^2} = -\\mathbb{I}_{[0,\\ell]}(x) $$\nThis equation is subject to boundary conditions derived from the nature of the boundaries:\n$1$. At the absorbing boundary $x=0$: If the particle starts at $x=0$, it is absorbed instantly, so it spends zero time in the domain. Thus, $T(0) = 0$.\n$2$. At the reflecting boundary $x=L$: The condition for a reflecting wall for this type of problem is a zero-gradient (Neumann) condition. This reflects the \"no-flux\" nature of the boundary, meaning that the expected time for a particle starting at $L-\\epsilon$ is, to first order, the same as one starting at $L$. Thus, $\\frac{dT}{dx}\\big|_{x=L} = 0$.\n\nWe solve the ODE by splitting the domain into two regions: $[0, \\ell]$ and $[\\ell, L]$.\n\nFor $x \\in [0, \\ell]$ (Region 1):\nThe equation is $\\frac{d^2 T_1}{dx^2} = -\\frac{1}{D}$.\nIntegrating once gives $\\frac{dT_1}{dx} = -\\frac{x}{D} + C_1$.\nIntegrating a second time gives $T_1(x) = -\\frac{x^2}{2D} + C_1 x + C_2$.\n\nFor $x \\in [\\ell, L]$ (Region 2):\nThe equation is $\\frac{d^2 T_2}{dx^2} = 0$.\nIntegrating once gives $\\frac{dT_2}{dx} = C_3$.\nIntegrating a second time gives $T_2(x) = C_3 x + C_4$.\n\nWe have four constants of integration ($C_1, C_2, C_3, C_4$) and four conditions to determine them:\na) Boundary condition at $x=0$: $T_1(0) = 0$.\n   $T_1(0) = -\\frac{0^2}{2D} + C_1(0) + C_2 = 0 \\implies C_2 = 0$.\n\nb) Boundary condition at $x=L$: $\\frac{dT_2}{dx}\\big|_{x=L} = 0$.\n   $\\frac{dT_2}{dx} = C_3 \\implies C_3 = 0$.\n\nc) Continuity of the solution at $x=\\ell$: $T(x)$ must be continuous, so $T_1(\\ell) = T_2(\\ell)$.\n   With $C_2=0$ and $C_3=0$, we have $T_1(x) = -\\frac{x^2}{2D} + C_1 x$ and $T_2(x) = C_4$.\n   The condition becomes $-\\frac{\\ell^2}{2D} + C_1 \\ell = C_4$.\n\nd) Continuity of the derivative at $x=\\ell$: The derivative $\\frac{dT}{dx}$ (the flux) must also be continuous.\n   $\\frac{dT_1}{dx}\\big|_{x=\\ell} = \\frac{dT_2}{dx}\\big|_{x=\\ell}$.\n   $-\\frac{\\ell}{D} + C_1 = C_3$.\n   Since $C_3=0$, we find $C_1 = \\frac{\\ell}{D}$.\n\nNow we can find the last constant, $C_4$, using the result from (c):\n$C_4 = -\\frac{\\ell^2}{2D} + \\left(\\frac{\\ell}{D}\\right)\\ell = -\\frac{\\ell^2}{2D} + \\frac{\\ell^2}{D} = \\frac{\\ell^2}{2D}$.\n\nWith all constants determined, the full solution for the mean residence time $T(x)$ is:\n$$ T(x) = \\begin{cases} T_1(x) = \\frac{\\ell x}{D} - \\frac{x^2}{2D} & \\text{for } x \\in [0, \\ell] \\\\ T_2(x) = \\frac{\\ell^2}{2D} & \\text{for } x \\in [\\ell, L] \\end{cases} $$\nThe problem asks for the mean residence time for a particle starting at $x_0 \\in (\\ell,L)$. This corresponds to the solution in Region 2.\nFor any $x_0 \\in (\\ell, L)$, the mean residence time is $T(x_0) = T_2(x_0) = \\frac{\\ell^2}{2D}$.\n\nThis result is independent of the starting position $x_0$ (as long as it is outside the layer $[0,\\ell]$) and the position of the reflecting wall $L$. This is physically intuitive: any particle starting in $(\\ell,L]$ must first reach $x=\\ell$ to begin accumulating residence time. By the strong Markov property of Brownian motion, its behavior after first reaching $\\ell$ is independent of its prior path. The reflecting wall at $L$ ensures the particle eventually reaches $\\ell$ with probability $1$, but does not affect the conditional mean time spent in $[0,\\ell]$ once it arrives at the interface.\n\nThe problem asks for the answer to be expressed in seconds, which is a unit of time. We check the dimensions of our result. The diffusion coefficient $D$ has dimensions of $[Length]^2/[Time]$, and the layer thickness $\\ell$ has dimensions of $[Length]$.\nThe dimensions of our expression are $\\frac{[\\ell]^2}{[D]} = \\frac{[Length]^2}{[Length]^2/[Time]} = [Time]$. The expression is dimensionally correct, so if $D$ and $\\ell$ are given in SI units ($m^2/s$ and $m$), the result will be in seconds.",
            "answer": "$$\\boxed{\\frac{\\ell^2}{2D}}$$"
        }
    ]
}