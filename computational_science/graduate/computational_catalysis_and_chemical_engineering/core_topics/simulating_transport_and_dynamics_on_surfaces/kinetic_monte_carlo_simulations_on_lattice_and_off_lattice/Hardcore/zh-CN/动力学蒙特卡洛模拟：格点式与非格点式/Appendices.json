{
    "hands_on_practices": [
        {
            "introduction": "本练习将在动力学蒙特卡洛（KMC）的微观世界与宏观化学动力学之间架起一座桥梁。通过分析最简单的系统——一个经历吸附和解吸的单一活性位点——我们可以从第一性原理推导出著名的Langmuir等温线，为更复杂的模拟提供坚实的理论基础 ()。",
            "id": "3884607",
            "problem": "考虑一个在动力学蒙特卡洛 (KMC) 框架下表示为双态格点模型的单一催化位点。该位点可以为空置或被吸附物占据。系统与一个具有固定分压 $p$ 和温度的气相耦合，吸附物解吸回到连续（非格点）气相中。假设如下：\n\n- 吸附到空置位点的速率与气体分压成正比，其速率模型为 $k_a p$，其中 $k_a$ 是一个常数，包含了粘附概率和分子碰撞动力学。\n- 从占据位点解吸的速率为一个常数 $k_d$，该常数通过阿伦尼乌斯型关系依赖于活化能和温度，但在此处被视为一个已知常数。\n- 令 $P_{\\text{occupied}}(t)$ 表示位点在时间 $t$ 被占据的概率，并假设初始条件为 $P_{\\text{occupied}}(0)=0$（初始为空置）。\n- 位点之间没有侧向相互作用，气相供应维持 $p$ 不随时间变化。其潜在动力学可以建模为一个双态连续时间马尔可夫链 (CTMC)。\n\n从双态 CTMC 的主方程出发，推导 $P_{\\text{occupied}}(t)$ 关于 $k_a$、$p$、$k_d$ 和 $t$ 的时间依赖表达式，并确定当 $t \\to \\infty$ 时覆盖度的长时间极限。将您的最终答案表示为 $P_{\\text{occupied}}(t)$ 的单个闭式解析表达式，所有参数均为符号。无需进行数值计算或四舍五入。最终答案应为无量纲的。",
            "solution": "该问题提出了一个有效且适定的情景，其基础是化学动力学和统计力学的基本原理。它描述了单一催化位点上的朗缪尔吸附-解吸过程，该过程可以严格地建模为双态连续时间马尔可夫链 (CTMC)。所有必要的参数、速率和初始条件都已提供，并且没有内部矛盾或科学不准确之处。我现在开始推导解答。\n\n令单个催化位点的状态由一个随机变量描述。该位点可以处于两种状态之一：空置（状态 $V$）或占据（状态 $O$）。令 $P_V(t)$ 为位点在时间 $t$ 为空置的概率，令 $P_{\\text{occupied}}(t)$ 为位点在时间 $t$ 被占据的概率。由于只有两种可能的状态，在任何时刻，概率之和必须为 1：\n$$P_V(t) + P_{\\text{occupied}}(t) = 1$$\n问题给出的初始条件是位点在 $t=0$ 时为空置，这等价于：\n$$P_{\\text{occupied}}(0) = 0$$\n这意味着 $P_V(0) = 1$。\n\n系统的动力学由两个基本过程控制：\n1. 吸附：一个气相分子吸附到空置位点上。这是从状态 $V$ 到状态 $O$ 的跃迁。该过程的速率与分压 $p$ 成正比，具体为 $k_a p$。\n2. 解吸：一个已吸附的分子从占据位点解吸回气相中。这是从状态 $O$ 到状态 $V$ 的跃迁。该过程的速率为一个常数 $k_d$。\n\n位点被占据的概率 $P_{\\text{occupied}}(t)$ 的时间演化由该双态 CTMC 的主方程描述。$P_{\\text{occupied}}(t)$ 的变化率等于跃迁进入占据状态的速率减去跃迁出占据状态的速率。\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = (\\text{从 } V \\to O \\text{ 的速率}) - (\\text{从 } O \\to V \\text{ 的速率}) $$\n跃迁进入状态 $O$ 的速率是处于状态 $V$ 的概率 $P_V(t)$ 乘以从 $V$ 到 $O$ 的跃迁速率 $k_a p$。\n跃迁出状态 $O$ 的速率是处于状态 $O$ 的概率 $P_{\\text{occupied}}(t)$ 乘以从 $O$ 到 $V$ 的跃迁速率 $k_d$。\n因此，主方程为：\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = (k_a p) P_V(t) - k_d P_{\\text{occupied}}(t) $$\n为了解出 $P_{\\text{occupied}}(t)$，我们必须消去 $P_V(t)$。利用概率守恒关系 $P_V(t) = 1 - P_{\\text{occupied}}(t)$，我们将其代入主方程：\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = k_a p (1 - P_{\\text{occupied}}(t)) - k_d P_{\\text{occupied}}(t) $$\n展开各项，我们得到：\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} = k_a p - k_a p P_{\\text{occupied}}(t) - k_d P_{\\text{occupied}}(t) $$\n这是一个一阶线性常微分方程。我们可以将其重排为标准形式 $\\frac{dy}{dt} + f(t)y = g(t)$：\n$$ \\frac{dP_{\\text{occupied}}(t)}{dt} + (k_a p + k_d) P_{\\text{occupied}}(t) = k_a p $$\n这个方程可以用积分因子法求解。积分因子 $I(t)$ 由下式给出：\n$$ I(t) = \\exp\\left(\\int (k_a p + k_d) dt\\right) = \\exp((k_a p + k_d)t) $$\n将整个微分方程乘以 $I(t)$：\n$$ \\exp((k_a p + k_d)t) \\frac{dP_{\\text{occupied}}(t)}{dt} + (k_a p + k_d) \\exp((k_a p + k_d)t) P_{\\text{occupied}}(t) = k_a p \\exp((k_a p + k_d)t) $$\n方程的左侧现在是 $P_{\\text{occupied}}(t)$ 和积分因子 $I(t)$ 乘积的导数：\n$$ \\frac{d}{dt} \\left[ P_{\\text{occupied}}(t) \\exp((k_a p + k_d)t) \\right] = k_a p \\exp((k_a p + k_d)t) $$\n接下来，我们对两边关于时间 $t$ 进行积分：\n$$ \\int \\frac{d}{dt} \\left[ P_{\\text{occupied}}(t) \\exp((k_a p + k_d)t) \\right] dt = \\int k_a p \\exp((k_a p + k_d)t) dt $$\n$$ P_{\\text{occupied}}(t) \\exp((k_a p + k_d)t) = \\frac{k_a p}{k_a p + k_d} \\exp((k_a p + k_d)t) + C $$\n其中 $C$ 是积分常数。为了求得 $P_{\\text{occupied}}(t)$ 的通解，我们将其分离出来，即两边同除以积分因子：\n$$ P_{\\text{occupied}}(t) = \\frac{k_a p}{k_a p + k_d} + C \\exp(-(k_a p + k_d)t) $$\n为了确定常数 $C$，我们应用初始条件 $P_{\\text{occupied}}(0) = 0$：\n$$ 0 = \\frac{k_a p}{k_a p + k_d} + C \\exp(0) $$\n$$ 0 = \\frac{k_a p}{k_a p + k_d} + C $$\n解出 $C$：\n$$ C = -\\frac{k_a p}{k_a p + k_d} $$\n将这个 $C$ 的值代回通解，得到 $P_{\\text{occupied}}(t)$ 的特解：\n$$ P_{\\text{occupied}}(t) = \\frac{k_a p}{k_a p + k_d} - \\frac{k_a p}{k_a p + k_d} \\exp(-(k_a p + k_d)t) $$\n提出公因子后，得到最终的简洁表达式：\n$$ P_{\\text{occupied}}(t) = \\frac{k_a p}{k_a p + k_d} \\left( 1 - \\exp(-(k_a p + k_d)t) \\right) $$\n这就是位点被占据概率的时间依赖表达式。\n\n该问题还要求确定覆盖度的长时间极限，这等价于 $t \\to \\infty$ 时的 $P_{\\text{occupied}}(t)$。取极限：\n$$ \\lim_{t \\to \\infty} P_{\\text{occupied}}(t) = \\lim_{t \\to \\infty} \\left[ \\frac{k_a p}{k_a p + k_d} \\left( 1 - \\exp(-(k_a p + k_d)t) \\right) \\right] $$\n由于 $k_a$、$p$ 和 $k_d$ 都是正常数，它们的和 $k_a p + k_d$ 是正的。因此，当 $t \\to \\infty$ 时，指数项衰减为零：\n$$ \\lim_{t \\to \\infty} \\exp(-(k_a p + k_d)t) = 0 $$\n因此，稳态占据率为：\n$$ P_{\\text{occupied}}(t \\to \\infty) = \\frac{k_a p}{k_a p + k_d} (1 - 0) = \\frac{k_a p}{k_a p + k_d} $$\n这个结果是著名的朗缪尔等温线，它给出了平衡时的分数表面覆盖度。这证实了我们推导的时间依赖解的物理正确性。\n要求的最终答案是 $P_{\\text{occupied}}(t)$ 的完整时间依赖表达式。",
            "answer": "$$\n\\boxed{\\frac{k_a p}{k_a p + k_d} \\left( 1 - \\exp(-(k_a p + k_d)t) \\right)}\n$$"
        },
        {
            "introduction": "从单个位点扩展到整个表面，本练习解决格上KMC中的一个核心实现挑战：如何正确处理网格的拓扑结构。您将学习如何使用高效且稳健的索引技术来实现周期性边界条件，这对于模拟体相材料和表面、同时最小化有限尺寸效应至关重要 ()。",
            "id": "3884595",
            "problem": "一个催化表面被建模为一个矩形的、格点上的动力学蒙特卡洛（KMC）系统，在两个方向上都具有周期性边界条件（PBC）。该表面由一个 $L_x \\times L_y$ 的晶格位点网格组成。在PBC中，晶格在拓扑上是一个环面：晶格坐标根据晶格周期性进行取模识别，因此，移动一步越过边界会从相对的另一侧重新进入。位点通过一个线性位点指数 $s$ 以行主序进行枚举，即从坐标到线性指数的映射为 $s = i + L_x \\, j$，其中坐标指数 $i \\in \\{0,\\ldots,L_x-1\\}$ 且 $j \\in \\{0,\\ldots,L_y-1\\}$。假设作用于整数的模运算符 $a \\bmod n$ 返回 $\\{0,\\ldots,n-1\\}$ 中的唯一余数，并且 $\\lfloor \\cdot \\rfloor$ 表示向下取整函数。\n\n在一次格点KMC步骤中，为了提出最近邻扩散或反应事件，必须为任意位点 $s$ 计算其沿 $\\pm \\hat{\\boldsymbol{x}}$ 和 $\\pm \\hat{\\boldsymbol{y}}$ 方向的四个最近邻的线性指数，并确保在PBC下没有边界效应。\n\n哪个选项为计算每个位点 $s$ 的四个邻居指数提供了一种正确且在实现上稳健的方案，该方案与上述定义一致并避免了边界效应？\n\nA. 通过 $i = s \\bmod L_x$ 和 $j = \\left\\lfloor s / L_x \\right\\rfloor$ 从 $s$ 计算坐标。然后计算\n- 右邻居：$s_{\\mathrm{R}} = \\left(\\left(i + 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$，\n- 左邻居：$s_{\\mathrm{L}} = \\left(\\left(i - 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$，\n- 上邻居：$s_{\\mathrm{U}} = i + L_x \\left(\\left(j + 1 + L_y\\right) \\bmod L_y\\right)$，\n- 下邻居：$s_{\\mathrm{D}} = i + L_x \\left(\\left(j - 1 + L_y\\right) \\bmod L_y\\right)$。\n\nB. 直接使用线性指数 $s$ 并设置\n- 右邻居：$s_{\\mathrm{R}} = \\left(s + 1\\right) \\bmod \\left(L_x L_y\\right)$，\n- 左邻居：$s_{\\mathrm{L}} = \\left(s - 1 + L_x L_y\\right) \\bmod \\left(L_x L_y\\right)$，\n- 上邻居：$s_{\\mathrm{U}} = \\left(s + L_x\\right) \\bmod \\left(L_x L_y\\right)$，\n- 下邻居：$s_{\\mathrm{D}} = \\left(s - L_x + L_x L_y\\right) \\bmod \\left(L_x L_y\\right)$。\n\nC. 使用从1开始的坐标，但使用相同的线性指数 $s \\in \\{0,\\ldots,L_x L_y - 1\\}$：设置 $i' = 1 + (s \\bmod L_x)$ 和 $j' = 1 + \\left\\lfloor s / L_x \\right\\rfloor$，然后定义\n- $i'_{\\mathrm{R}} = \\left(\\left(i' + 1\\right) \\bmod L_x\\right)$，$i'_{\\mathrm{L}} = \\left(\\left(i' - 1 + L_x\\right) \\bmod L_x\\right)$，$j'_{\\mathrm{U}} = \\left(\\left(j' + 1\\right) \\bmod L_y\\right)$，$j'_{\\mathrm{D}} = \\left(\\left(j' - 1 + L_y\\right) \\bmod L_y\\right)$，\n并通过 $s_{\\alpha} = i'_{\\alpha} + L_x \\, j'_{\\alpha}$（其中 $\\alpha \\in \\{\\mathrm{R,L,U,D}\\}$）映射回线性指数。\n\nD. 通过 $i = \\left\\lfloor s / L_y \\right\\rfloor$ 和 $j = s \\bmod L_y$（列主序风格）计算坐标，然后设置\n- 右邻居：$s_{\\mathrm{R}} = \\left(\\left(i + 1 + L_y\\right) \\bmod L_y\\right) + L_y \\, j$，\n- 左邻居：$s_{\\mathrm{L}} = \\left(\\left(i - 1 + L_y\\right) \\bmod L_y\\right) + L_y \\, j$，\n- 上邻居：$s_{\\mathrm{U}} = i + L_y \\left(\\left(j + 1 + L_x\\right) \\bmod L_x\\right)$，\n- 下邻居：$s_{\\mathrm{D}} = i + L_y \\left(\\left(j - 1 + L_x\\right) \\bmod L_x\\right)$。\n\n选择一个选项。",
            "solution": "首先验证问题陈述，以确保其科学上合理、定义明确且客观。\n\n### 步骤1：提取已知条件\n- **系统：** 一个矩形的、格点上的动力学蒙特卡洛（KMC）模型。\n- **晶格维度：** 一个 $L_x \\times L_y$ 的晶格位点网格。\n- **边界条件：** 在 $\\hat{\\boldsymbol{x}}$ 和 $\\hat{\\boldsymbol{y}}$ 两个方向上都采用周期性边界条件（PBC），使得晶格成为一个拓扑环面。\n- **位点索引：** 位点通过线性指数 $s$ 进行枚举。\n- **索引方案：** 指定为行主序。\n- **坐标到索引的映射：** 从二维坐标 $(i, j)$ 到线性指数 $s$ 的映射被明确给出为 $s = i + L_x \\, j$。\n- **坐标范围：** 坐标指数为 $i \\in \\{0, \\ldots, L_x-1\\}$ 和 $j \\in \\{0, \\ldots, L_y-1\\}$。\n- **模运算符：** 运算符 $a \\bmod n$ 返回集合 $\\{0, \\ldots, n-1\\}$ 中的唯一余数。\n- **向下取整函数：** $\\lfloor \\cdot \\rfloor$ 表示标准的向下取整函数。\n- **目标：** 找到一套正确且在实现上稳健的公式，用于计算任意位点 $s$ 的四个最近邻（右、左、上、下）的线性指数，且与定义和PBC一致。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础：** 该问题牢固地植根于计算物理学和材料科学。带有PBC和行主序索引的晶格模型是KMC及其他模拟技术中的标准构造。该问题是在周期性网格上实现邻居查找的一个实践练习。它在科学上是有效的。\n- **定义明确：** 提供了所有必要的信息。晶格结构、索引方案和边界条件都已明确定义。目标是找到一组可以推导和验证的数学表达式。存在唯一的正确解。\n- **客观性：** 问题以精确的数学语言陈述。“行主序”等术语以及特定的坐标到索引的映射公式没有留下任何歧义的余地。在此背景下，“实现上稳健”一词可以合理地解释为避免特定编程语言实现模运算符时的常见陷阱（例如，对于负操作数），这是计算科学中的一个标准考虑。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。这是一个在计算科学中定义明确的标准问题。我现在将着手推导解决方案并评估给出的选项。\n\n### 正确邻居查找方案的推导\n\n1.  **逆向映射（线性指数到坐标）：**\n    我们已知行主序映射 $s = i + L_x \\, j$，其中 $i \\in \\{0, \\ldots, L_x-1\\}$ 和 $j \\in \\{0, \\ldots, L_y-1\\}$。要找到位点 $s$ 的邻居，我们必须首先确定其坐标 $(i, j)$。\n    -   要找到列指数 $i$，我们可以对表达式模 $L_x$：\n        $$s \\bmod L_x = (i + L_x \\, j) \\bmod L_x$$\n        由于 $L_x \\, j$ 是 $L_x$ 的倍数，其模 $L_x$ 的余数为 $0$。又因为 $i \\in \\{0, \\ldots, L_x-1\\}$，我们有 $i \\bmod L_x = i$。\n        因此，$i = s \\bmod L_x$。\n    -   要找到行指数 $j$，我们使用整数除法。从 $s = i + L_x \\, j$，我们可以写出 $s - i = L_x \\, j$。因此，$j = (s - i) / L_x$。由于 $i$ 和 $j$ 必须是整数，这意味着 $j = \\lfloor (s - i) / L_x \\rfloor$。代入 $i = s \\bmod L_x$，我们得到 $j = \\lfloor (s - (s \\bmod L_x)) / L_x \\rfloor$。根据整数除法的定义，$s = \\lfloor s/L_x \\rfloor L_x + (s \\bmod L_x)$。将其与 $s = j L_x + i$ 进行比较，我们可以直接确定 $j = \\lfloor s / L_x \\rfloor$。\n    -   所以，逆向映射为：$i = s \\bmod L_x$ 和 $j = \\lfloor s / L_x \\rfloor$。\n\n2.  **带有PBC的邻居坐标：**\n    对于坐标为 $(i, j)$ 的位点，其最近邻的坐标可以通过对相应坐标加或减 $1$ 并应用PBC来找到。\n    -   右邻居（$\\hat{\\boldsymbol{x}}$ 方向）：$(i+1, j)$。在PBC下，新的 $x$ 坐标变为 $(i+1) \\bmod L_x$。坐标为 $((i+1) \\bmod L_x, j)$。\n    -   左邻居（$-\\hat{\\boldsymbol{x}}$ 方向）：$(i-1, j)$。在PBC下，新的 $x$ 坐标为 $(i-1) \\bmod L_x$。坐标为 $((i-1) \\bmod L_x, j)$。\n    -   上邻居（$\\hat{\\boldsymbol{y}}$ 方向）：$(i, j+1)$。在PBC下，新的 $y$ 坐标为 $(j+1) \\bmod L_y$。坐标为 $(i, (j+1) \\bmod L_y)$。\n    -   下邻居（$-\\hat{\\boldsymbol{y}}$ 方向）：$(i, j-1)$。在PBC下，新的 $y$ 坐标为 $(j-1) \\bmod L_y$。坐标为 $(i, (j-1) \\bmod L_y)$。\n\n    为了确保“实现上稳健”，特别是在某些编程语言中 `a % n` 对于负数 `a` 可能得到负值，通常采用 `(a + n) % n` 的形式。这得到：\n    -   $i_{\\mathrm{L}} = (i - 1 + L_x) \\bmod L_x$\n    -   $j_{\\mathrm{D}} = (j - 1 + L_y) \\bmod L_y$\n    右邻居和上邻居的表达式严格来说不需要这样做，因为 $i+1$ 和 $j+1$ 总是非负的，但为了保持一致性，通常会应用相同的模式：\n    -   $i_{\\mathrm{R}} = (i + 1 + L_x) \\bmod L_x = (i + 1) \\bmod L_x$\n    -   $j_{\\mathrm{U}} = (j + 1 + L_y) \\bmod L_y = (j + 1) \\bmod L_y$\n\n3.  **正向映射（邻居坐标到线性指数）：**\n    现在我们使用原始映射 $s_{\\text{neighbor}} = i_{\\text{neighbor}} + L_x \\, j_{\\text{neighbor}}$ 来找到邻居的线性指数。\n    -   右邻居：$s_{\\mathrm{R}} = ((i + 1) \\bmod L_x) + L_x \\, j$。稳健形式：$s_{\\mathrm{R}} = ((i + 1 + L_x) \\bmod L_x) + L_x \\, j$。\n    -   左邻居：$s_{\\mathrm{L}} = ((i - 1 + L_x) \\bmod L_x) + L_x \\, j$。\n    -   上邻居：$s_{\\mathrm{U}} = i + L_x \\, ((j + 1 + L_y) \\bmod L_y)$。\n    -   下邻居：$s_{\\mathrm{D}} = i + L_x \\, ((j - 1 + L_y) \\bmod L_y)$。\n\n推导完成。现在我们评估各个选项。\n\n### 逐个选项分析\n\n**A. 通过 $i = s \\bmod L_x$ 和 $j = \\left\\lfloor s / L_x \\right\\rfloor$ 从 $s$ 计算坐标。然后计算...**\n- 坐标提取公式为 $i = s \\bmod L_x$ 和 $j = \\lfloor s / L_x \\rfloor$。这与我们针对行主序的推导完全匹配。\n- 邻居指数公式为：\n  - $s_{\\mathrm{R}} = \\left(\\left(i + 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$\n  - $s_{\\mathrm{L}} = \\left(\\left(i - 1 + L_x\\right) \\bmod L_x\\right) + L_x \\, j$\n  - $s_{\\mathrm{U}} = i + L_x \\left(\\left(j + 1 + L_y\\right) \\bmod L_y\\right)$\n  - $s_{\\mathrm{D}} = i + L_x \\left(\\left(j - 1 + L_y\\right) \\bmod L_y\\right)$\n这些公式与从第一性原理推导出的公式完全相同，包括模运算符的稳健实现。\n**结论：正确。**\n\n**B. 直接使用线性指数 $s$ 并设置...**\n这个选项避免了转换为二维坐标，而是直接对线性指数 $s$ 进行操作。\n- **右邻居：** $s_{\\mathrm{R}} = (s + 1) \\bmod (L_x L_y)$。让我们在一个位于行右边缘的位点上测试它，例如 $i = L_x-1$。其指数为 $s = (L_x-1) + L_x j$。该公式给出 $s+1 = (L_x-1) + L_x j + 1 = L_x + L_x j = L_x(j+1)$。这对应于坐标为 $(0, j+1)$ 的位点，即*下一*行的第一个位点。正确的邻居应位于 $(0, j)$，指数为 $0 + L_x j = L_x j$。该公式不正确，因为它没有在同一行内回绕。此方法仅适用于一维PBC。\n- **左邻居：** $s_{\\mathrm{L}} = (s - 1 + L_x L_y) \\bmod (L_x L_y)$。类似地，对于一个位于左边缘（$i=0$）的位点，$s = L_x j$。该公式给出 $s-1 = L_x j - 1 = (L_x-1) + L_x(j-1)$，这是*上一*行的最后一个位点。正确的邻居应位于 $(L_x-1, j)$，指数为 $(L_x-1) + L_x j$。该公式不正确。\n- **上/下邻居：** 公式 $s_{\\mathrm{U}} = (s+L_x) \\bmod (L_x L_y)$ 和 $s_{\\mathrm{D}} = (s-L_x+L_x L_y) \\bmod (L_x L_y)$ 碰巧是正确的。因为是行主序，向上或向下移动一行对应于从指数中加上或减去一整行的长度 $L_x$。对总位点数 $L_x L_y$ 取模正确地处理了顶行和底行之间的回绕。\n然而，由于左右邻居的方案存在缺陷，整个选项是无效的。\n**结论：不正确。**\n\n**C. 使用从1开始的坐标，但使用相同的线性指数 $s \\in \\{0,\\ldots,L_x L_y - 1\\}$...**\n此选项引入了一个从1开始的坐标系，$i' \\in \\{1, \\ldots, L_x\\}$ 和 $j' \\in \\{1, \\ldots, L_y\\}$。\n- 映射 $i' = 1 + (s \\bmod L_x)$ 和 $j' = 1 + \\lfloor s / L_x \\rfloor$ 正确地将一个从0开始的指数 $s$ 转换为从1开始的坐标 $(i', j')$。\n- 邻居坐标的公式，例如 $i'_{\\mathrm{R}} = ((i' + 1) \\bmod L_x)$，是有缺陷的。因为 $i'$ 是从1开始的，对于最右边的一列 $i' = L_x$，这会得到 $(L_x+1) \\bmod L_x = 1$。这似乎能正确地从列 $L_x$ 回绕到 $1$。然而，对于 $i' = L_x-1$，它得到 $(L_x-1+1) \\bmod L_x = L_x \\bmod L_x = 0$。结果坐标 $i'_{R}$ 为 $0$，这超出了定义的从1开始的范围 $\\{1, ..., L_x\\}$。该选项以不一致的方式混合了从1开始和从0开始的索引约定。\n- 用于重新映射到线性指数的最终公式 $s_{\\alpha} = i'_{\\alpha} + L_x \\, j'_{\\alpha}$ 也是不一致的。它取一个计算出的邻居坐标（例如，$i'_{\\mathrm{R}}$，我们发现它可能是从0开始的）并将其与另一个邻居坐标乘以 $L_x$（例如，$j'_{\\mathrm{R}}$）相加。该表示法是模棱两可的，并且索引基的混合使其根本上不合理。\n**结论：不正确。**\n\n**D. 通过 $i = \\left\\lfloor s / L_y \\right\\rfloor$ 和 $j = s \\bmod L_y$（列主序风格）计算坐标...**\n此选项提出了另一种坐标提取方案。\n- 问题陈述明确定义了**行主序**，其映射为 $s = i + L_x \\, j$。\n- 此选项中提出的公式 $i = \\lfloor s / L_y \\rfloor$ 和 $j = s \\bmod L_y$ 对应于**列主序**，其中指数沿着列增长最快。这可以通过写出其逆映射看出：$s = j + L_y \\, i$。\n- 这第一步就直接与问题陈述中给出的前提相矛盾。因此，基于这个不正确前提的任何后续计算在所述问题的背景下都是无效的。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "本练习将介绍格下KMC的连续世界，其中粒子自由移动，而非在固定位点之间跳跃。您将首先探索不同边界类型的物理意义，然后解决一个扩散理论中的经典问题，将随机粒子轨迹与使用Fokker-Planck方程的连续介质描述联系起来 ()。",
            "id": "3884627",
            "problem": "在动力学蒙特卡洛 (KMC; Kinetic Monte Carlo) 中，催化表面微环境通常被理想化为一组耦合的反应-扩散事件。在离格扩散中，吸附物的位置是一个随机演化的连续变量，而边界则编码了与边缘、台阶和汇的物理相互作用。请用适用于KMC中离格扩散的概念性术语解释，反射边界和吸收边界如何在边界处改变扩散粒子的演化。然后，考虑一个在一维线段上扩散的单个吸附物，该线段代表一个垂直于平坦催化剂平台的法向坐标，其域为 $x \\in [0,L]$，其中 $x=0$ 是所关注的物理边界，而 $x=L$ 代表一个远处的反射壁。该粒子以恒定的扩散系数 $D>0$ 进行无偏扩散，从 $x=x_0$（其中 $x_0 \\in (\\ell,L)$）开始，演化直到在 $x=0$ 处被吸收。将“边界附近的平均停留时间”定义为粒子在 $x=0$ 处被吸收之前，在边界层 $x \\in [0,\\ell]$ 中所花费的预期总时间，其中 $\\ell \\in (0,L)$ 是一个固定的层厚度。\n\n从Brownian运动及其Fokker-Planck生成元的基本定义出发，推导在 $[0,\\ell]$ 内平均停留时间的边值问题表述，并求解该问题，以获得当 $x_0 \\in (\\ell,L)$ 时，平均停留时间关于 $D$ 和 $\\ell$ 的解析表达式。以秒为单位表示您的最终答案。无需四舍五入；报告一个闭式表达式。",
            "solution": "该问题要求两部分内容：首先，在离格动力学蒙特卡洛 (KMC) 扩散的背景下，对反射边界和吸收边界进行概念性解释；其次，针对一维域特定区域内扩散粒子的平均停留时间，推导并求解一个边值问题。\n\n首先，我们讨论概念部分。在离格KMC模拟中，粒子的位置是一个连续变量。粒子的轨迹是一系列随机跳跃，跳跃之间的时间和每次跳跃的目的地由其潜在的物理模型决定，通常是Langevin方程或其过阻尼极限，即Brownian运动。边界代表物理约束或界面。\n\n位于某个位置（例如 $x=0$）的**吸收边界**代表一个理想的汇。当一个扩散粒子的轨迹首次到达此边界时，它会立即并永久地从系统中移除。在模拟中，这意味着粒子的状态被设置为“已吸收”，其轨迹被终止。在描述粒子概率密度（例如Fokker-Planck方程）的偏微分方程 (PDE) 的语言中，吸收边界施加了Dirichlet边界条件。例如，概率密度 $p(x,t)$ 在边界处对所有时间 $t>0$ 都被设为零，即 $p(0,t)=0$，因为任何到达该点的粒子都会被立即移除。\n\n位于某个位置（例如 $x=L$）的**反射边界**代表一个不可穿透的屏障，它将粒子保留在域内。当粒子遇到此边界时，其垂直于边界的速度分量被反转，实质上是将其“弹回”到域中。在Brownian运动的模拟中，这可以通过将提议的移动跨越边界平面进行反射来实现。对于相应的Fokker-Planck方程，反射边界施加了一个无通量条件，即Neumann边界条件。通量 $J(x,t)$ 与概率密度的空间导数成正比，$J(x,t) = -D \\frac{\\partial p}{\\partial x}$。因此，无通量条件可转化为 $\\frac{\\partial p}{\\partial x}\\big|_{x=L} = 0$。\n\n现在，我们进行数学推导。该系统包含一个在域 $x \\in [0,L]$ 上进行无偏一维扩散的单个粒子，其运动由Brownian运动的随机微分方程所描述：$dX_t = \\sqrt{2D} dW_t$，其中 $D$ 是恒定的扩散系数，$W_t$ 是一个标准Wiener过程。$x=0$ 处的边界是吸收性的，$x=L$ 处的边界是反射性的。\n\n我们被要求找出在边界层 $[0,\\ell]$ 内的“平均停留时间”，我们将其记为 $T(x_0)$。这是在粒子从位置 $x_0$ 开始的条件下，在 $x=0$ 处被吸收之前，它在区间 $[0,\\ell]$ 内所花费的预期总时间。在数学上，这表示为：\n$$ T(x_0) = \\mathbb{E}_{x_0}\\left[ \\int_0^{\\tau_0} \\mathbb{I}_{[0,\\ell]}(X_t) dt \\right] $$\n其中 $\\mathbb{E}_{x_0}$ 是以起始位置 $X_0 = x_0$ 为条件的期望值，$\\tau_0$ 是到达 $x=0$ 处吸收边界的首次通过时间，$\\mathbb{I}_{[0,\\ell]}(x)$ 是指示函数，如果 $x \\in [0,\\ell]$ 则其值为1，否则为0。\n\n此类期望值的控制方程是后向Fokker-Planck（或Kolmogorov后向）方程。对于一个泛函 $\\mathbb{E}_x[\\int_0^{\\tau} f(X_t) dt]$，其期望值 $g(x)$ 满足常微分方程 (ODE) $\\mathcal{L}g(x) = -f(x)$，其中 $\\mathcal{L}$ 是扩散过程的生成元。对于一维无偏扩散，生成元是 $\\mathcal{L} = D \\frac{d^2}{dx^2}$。在我们的问题中，函数 $f(x)$ 是指示函数 $\\mathbb{I}_{[0,\\ell]}(x)$。\n\n因此，平均停留时间 $T(x)$ 满足以下Poisson方程：\n$$ D \\frac{d^2 T}{dx^2} = -\\mathbb{I}_{[0,\\ell]}(x) $$\n该方程受制于由边界性质导出的边界条件：\n1. 在吸收边界 $x=0$ 处：如果粒子从 $x=0$ 开始，它会立即被吸收，因此它在域内花费的时间为零。因此，$T(0) = 0$。\n2. 在反射边界 $x=L$ 处：对于此类问题，反射壁的条件是零梯度（Neumann）条件。这反映了边界的“无通量”性质，意味着从 $L-\\epsilon$ 开始的粒子的期望时间，在一阶近似下，与从 $L$ 开始的粒子相同。因此，$\\frac{dT}{dx}\\big|_{x=L} = 0$。\n\n我们通过将域分成两个区域来求解该常微分方程：$[0, \\ell]$ 和 $[\\ell, L]$。\n\n对于 $x \\in [0, \\ell]$ (区域1)：\n方程为 $\\frac{d^2 T_1}{dx^2} = -\\frac{1}{D}$。\n积分一次得到 $\\frac{dT_1}{dx} = -\\frac{x}{D} + C_1$。\n再积分一次得到 $T_1(x) = -\\frac{x^2}{2D} + C_1 x + C_2$。\n\n对于 $x \\in [\\ell, L]$ (区域2)：\n方程为 $\\frac{d^2 T_2}{dx^2} = 0$。\n积分一次得到 $\\frac{dT_2}{dx} = C_3$。\n再积分一次得到 $T_2(x) = C_3 x + C_4$。\n\n我们有四个积分常数 ($C_1, C_2, C_3, C_4$) 和四个条件来确定它们：\na) 在 $x=0$ 处的边界条件：$T_1(0) = 0$。\n   $T_1(0) = -\\frac{0^2}{2D} + C_1(0) + C_2 = 0 \\implies C_2 = 0$。\n\nb) 在 $x=L$ 处的边界条件：$\\frac{dT_2}{dx}\\big|_{x=L} = 0$。\n   $\\frac{dT_2}{dx} = C_3 \\implies C_3 = 0$。\n\nc) 在 $x=\\ell$ 处解的连续性：$T(x)$ 必须是连续的，所以 $T_1(\\ell) = T_2(\\ell)$。\n   在 $C_2=0$ 和 $C_3=0$ 的情况下，我们有 $T_1(x) = -\\frac{x^2}{2D} + C_1 x$ 和 $T_2(x) = C_4$。\n   条件变为 $-\\frac{\\ell^2}{2D} + C_1 \\ell = C_4$。\n\nd) 在 $x=\\ell$ 处导数的连续性：导数 $\\frac{dT}{dx}$（通量）也必须是连续的。\n   $\\frac{dT_1}{dx}\\big|_{x=\\ell} = \\frac{dT_2}{dx}\\big|_{x=\\ell}$。\n   $-\\frac{\\ell}{D} + C_1 = C_3$。\n   由于 $C_3=0$，我们得到 $C_1 = \\frac{\\ell}{D}$。\n\n现在我们可以使用 (c) 的结果来找到最后一个常数 $C_4$：\n$C_4 = -\\frac{\\ell^2}{2D} + \\left(\\frac{\\ell}{D}\\right)\\ell = -\\frac{\\ell^2}{2D} + \\frac{\\ell^2}{D} = \\frac{\\ell^2}{2D}$。\n\n在所有常数都确定后，平均停留时间 $T(x)$ 的完整解是：\n$$ T(x) = \\begin{cases} T_1(x) = \\frac{\\ell x}{D} - \\frac{x^2}{2D}  \\text{对于 } x \\in [0, \\ell] \\\\ T_2(x) = \\frac{\\ell^2}{2D}  \\text{对于 } x \\in [\\ell, L] \\end{cases} $$\n问题要求的是从 $x_0 \\in (\\ell,L)$ 开始的粒子的平均停留时间。这对应于区域2中的解。\n对于任何 $x_0 \\in (\\ell, L)$，平均停留时间为 $T(x_0) = T_2(x_0) = \\frac{\\ell^2}{2D}$。\n\n这个结果与起始位置 $x_0$（只要它在层 $[0,\\ell]$ 之外）以及反射壁的位置 $L$ 无关。这在物理上是直观的：任何从 $(\\ell,L]$ 开始的粒子必须首先到达 $x=\\ell$ 才能开始累积停留时间。根据Brownian运动的强Markov性质，它在首次到达 $\\ell$ 之后的行为与其先前的路径无关。$L$ 处的反射壁确保粒子最终以概率1到达 $\\ell$，但一旦到达界面，它不影响在 $[0,\\ell]$ 内花费的条件平均时间。\n\n问题要求答案以秒为单位表示，这是一个时间单位。我们检查结果的量纲。扩散系数 $D$ 的量纲为 $[长度]^2/[时间]$，层厚度 $\\ell$ 的量纲为 $[长度]$。\n我们表达式的量纲是 $\\frac{[\\ell]^2}{[D]} = \\frac{[长度]^2}{[长度]^2/[时间]} = [时间]$。该表达式在量纲上是正确的，所以如果 $D$ 和 $\\ell$ 以国际单位制（SI）单位（$m^2/s$ 和 $m$）给出，结果将以秒为单位。",
            "answer": "$$\\boxed{\\frac{\\ell^2}{2D}}$$"
        }
    ]
}