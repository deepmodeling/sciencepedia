{
    "hands_on_practices": [
        {
            "introduction": "The Brønsted-Evans-Polanyi (BEP) relationship, which posits a linear correlation between activation energies ($E_a$) and reaction energies ($\\Delta E$), is a cornerstone of modern catalysis. This exercise provides a foundational hands-on experience by tasking you with implementing an Ordinary Least Squares (OLS) regression from first principles to determine the BEP parameters $\\alpha$ and $E_0$ from a set of computationally generated data. By building the regression algorithm yourself, you will gain a deeper understanding of the statistical basis of this ubiquitous linear free-energy relationship and develop a crucial skill for analyzing catalytic data .",
            "id": "3871019",
            "problem": "You are tasked with implementing an algorithmically sound fit of the Brønsted-Evans-Polanyi (BEP) linear relationship between the activation barrier and reaction energy to estimate the intercept and slope from data generated by the Nudged Elastic Band (NEB) method. The Brønsted-Evans-Polanyi (BEP) relationship posits that the activation energy $E_a$ for an elementary step on a potential energy surface correlates linearly with the thermodynamic driving force (reaction energy) $\\Delta E$ for that step. In computational catalysis, the NEB method provides consistent barrier and reaction energy estimates, and the BEP relationship is used to construct microkinetic models with reduced parameter dimensionality.\n\nStarting from the following foundational base:\n- Transition State Theory (TST) connects reaction rate constants to activation barriers, and the NEB method provides $E_a$ and $\\Delta E$ at consistent configurations on the potential energy surface.\n- The BEP relationship models $E_a$ as a linear function of $\\Delta E$. Your objective is to estimate the parameters of this linear model by minimizing the sum of squared residuals between the observed activation energies and those predicted by the model.\n- Ordinary Least Squares (OLS) is a well-tested method to estimate linear model parameters by minimizing the sum of squared errors.\n\nImplement a program that, for each dataset of pairs $\\{(E_a,\\Delta E)\\}$ provided below, performs an Ordinary Least Squares fit of the linear model $E_a = E_0 + \\alpha \\,\\Delta E$, where $E_0$ is the intercept (reported in electronvolts) and $\\alpha$ is the slope (dimensionless). Compute and report:\n1. The regression slope $\\alpha$.\n2. The regression intercept $E_0$ in electronvolts.\n3. The coefficient of determination $R^2$ as a measure of goodness-of-fit, defined by the fraction of variance in $E_a$ explained by the linear model.\n\nFor numerical stability and completeness, adopt the following rules:\n- Use the unbiased OLS normal-equation solution derived from minimizing the sum of squared residuals. Do not use black-box regression utilities; implement the calculation from first principles using sums and means.\n- If the variance of $\\Delta E$ in a dataset is zero, set $\\alpha = 0$ and $E_0$ equal to the mean of $E_a$. For $R^2$, if the total sum of squares of $E_a$ is zero and the residual sum of squares is also zero, set $R^2 = 1$. If the total sum of squares of $E_a$ is zero but the residual sum of squares is nonzero, set $R^2 = 0$.\n- All energies are in electronvolts (eV). Report $E_0$ in eV. Report $\\alpha$ and $R^2$ as dimensionless numbers.\n\nUse the following test suite of datasets, each specified as a list of $(E_a,\\Delta E)$ pairs in electronvolts:\n- Case 1 (three NEB-calculated barriers; typical positive BEP slope): $\\{(E_a,\\Delta E) = (1.0,0.5),(0.8,0.2),(0.5,-0.3)\\}$.\n- Case 2 (four points; moderate noise consistent with a BEP slope near $0.5$): $\\{(E_a,\\Delta E) = (0.87,0.4),(0.64,0.0),(0.55,-0.2),(0.38,-0.6)\\}$.\n- Case 3 (three points; small spread in $\\Delta E$ to test numerical stability): $\\{(E_a,\\Delta E) = (0.761,0.100),(0.7591,0.101),(0.7599,0.099)\\}$.\n- Case 4 (three points; an outlier to reduce $R^2$): $\\{(E_a,\\Delta E) = (0.22,-0.5),(0.73,0.2),(1.25,0.6)\\}$.\n- Case 5 (three points; perfectly linear symmetric set; $R^2$ should be high): $\\{(E_a,\\Delta E) = (0.40,-1.0),(0.80,0.0),(1.20,1.0)\\}$.\n\nYour program must compute, for each case, the triplet $[\\alpha, E_0, R^2]$ and round each value to six decimal places. The final output must be a single line containing a comma-separated list of these triplets, enclosed in square brackets. For example, the output format is $[[\\alpha_1,E_{0,1},R^2_1],[\\alpha_2,E_{0,2},R^2_2],\\dots]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[alpha1,E01,R21],[alpha2,E02,R22],...]\"). No additional text should be printed.",
            "solution": "The problem requires the implementation of an Ordinary Least Squares (OLS) regression to determine the parameters of the Brønsted-Evans-Polanyi (BEP) linear model, $E_a = E_0 + \\alpha \\Delta E$, from given datasets of activation energies ($E_a$) and reaction energies ($\\Delta E$). The parameters to be determined are the intercept $E_0$ and the slope $\\alpha$. Additionally, the coefficient of determination, $R^2$, must be calculated as a measure of the goodness-of-fit. The implementation must be from first principles, based on the minimization of the sum of squared residuals.\n\nLet a given dataset consist of $n$ pairs of observations $(\\Delta E_i, E_{a,i})$ for $i=1, \\dots, n$. We define the independent variable as $x_i = \\Delta E_i$ and the dependent variable as $y_i = E_{a,i}$. The linear model predicts the activation energy as $y_i^{\\text{pred}} = E_0 + \\alpha x_i$.\n\nThe OLS method finds the optimal values of $E_0$ and $\\alpha$ by minimizing the sum of squared residuals (SSR), $S(E_0, \\alpha)$, which is the sum of the squared differences between the observed values $y_i$ and the predicted values $y_i^{\\text{pred}}$.\n$$\nS(E_0, \\alpha) = \\sum_{i=1}^{n} (y_i - y_i^{\\text{pred}})^2 = \\sum_{i=1}^{n} (y_i - (E_0 + \\alpha x_i))^2\n$$\nTo find the minimum, we take the partial derivatives of $S$ with respect to $E_0$ and $\\alpha$ and set them to zero. This yields the normal equations:\n$$\n\\frac{\\partial S}{\\partial E_0} = -2 \\sum_{i=1}^{n} (y_i - E_0 - \\alpha x_i) = 0\n$$\n$$\n\\frac{\\partial S}{\\partial \\alpha} = -2 \\sum_{i=1}^{n} x_i(y_i - E_0 - \\alpha x_i) = 0\n$$\nLet $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$ and $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i$ be the sample means of $\\Delta E$ and $E_a$, respectively. The first normal equation simplifies to:\n$$\n\\sum y_i - nE_0 - \\alpha \\sum x_i = 0 \\implies n\\bar{y} - nE_0 - n\\alpha\\bar{x} = 0 \\implies E_0 = \\bar{y} - \\alpha \\bar{x}\n$$\nThis demonstrates that the regression line must pass through the point of sample means $(\\bar{x}, \\bar{y})$. Substituting this expression for $E_0$ into the second normal equation and simplifying yields the solution for the slope $\\alpha$:\n$$\n\\alpha = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2}\n$$\nThe numerator is the sample covariance between $x$ and $y$ (multiplied by $n-1$), and the denominator is the sample variance of $x$ (multiplied by $n-1$).\n\nThe coefficient of determination, $R^2$, quantifies the proportion of the variance in the dependent variable $E_a$ that is predictable from the independent variable $\\Delta E$. It is defined as:\n$$\nR^2 = 1 - \\frac{\\text{SSR}}{\\text{SST}}\n$$\nwhere SSR is the sum of squared residuals as defined before, and SST is the total sum of squares, which measures the total variance of the dependent variable $y_i$ around its mean $\\bar{y}$.\n$$\n\\text{SST} = \\sum_{i=1}^{n} (y_i - \\bar{y})^2\n$$\n$$\n\\text{SSR} = \\sum_{i=1}^{n} (y_i - (E_0 + \\alpha x_i))^2\n$$\nAn $R^2$ value of $1$ indicates a perfect fit, while a value of $0$ indicates that the model provides no improvement over simply using the mean $\\bar{y}$ as the prediction.\n\nThe problem specifies handling of special numerical cases:\n1.  If the variance of $\\Delta E$ is zero (i.e., $\\sum (x_i - \\bar{x})^2 = 0$), the denominator in the expression for $\\alpha$ is zero. In this case, $\\alpha$ is set to $0$ and $E_0$ is set to the mean of $E_a$, i.e., $E_0 = \\bar{y}$. This is physically reasonable, as with no variation in $\\Delta E$, no correlation can be established.\n2.  If the total sum of squares of $E_a$ is zero (i.e., $\\text{SST} = 0$), all $E_a$ values are identical.\n    - If the residual sum of squares (SSR) is also zero, it implies a perfect prediction. $R^2$ is set to $1$.\n    - If SSR is non-zero, the model fails to capture the constant data, indicating a poor fit. $R^2$ is set to $0$.\n\nThe algorithmic procedure for each dataset is as follows:\n1.  Separate the data pairs into arrays for $\\Delta E$ (denoted $x$) and $E_a$ (denoted $y$).\n2.  Compute the means $\\bar{x}$ and $\\bar{y}$.\n3.  Compute the term $S_{xx} = \\sum (x_i - \\bar{x})^2$, which is proportional to the variance of $x$.\n4.  If $S_{xx}$ is numerically zero, set $\\alpha = 0$ and $E_0 = \\bar{y}$. Otherwise, compute $S_{xy} = \\sum (x_i - \\bar{x})(y_i - \\bar{y})$ and calculate $\\alpha = S_{xy} / S_{xx}$ and $E_0 = \\bar{y} - \\alpha \\bar{x}$.\n5.  Compute the total sum of squares $\\text{SST} = \\sum (y_i - \\bar{y})^2$.\n6.  Compute the residual sum of squares $\\text{SSR} = \\sum (y_i - (E_0 + \\alpha x_i))^2$.\n7.  Calculate $R^2$ using the formula $R^2 = 1 - \\text{SSR}/\\text{SST}$, applying the specified rules for the case where $\\text{SST}$ is zero.\n8.  Collect the resulting triplet $[\\alpha, E_0, R^2]$, round each value to six decimal places, and format the final output as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs an Ordinary Least Squares fit for the Brønsted-Evans-Polanyi\n    relationship on several datasets and formats the output.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a list of (E_a, Delta_E) pairs in eV.\n    test_cases = [\n        # Case 1\n        [(1.0, 0.5), (0.8, 0.2), (0.5, -0.3)],\n        # Case 2\n        [(0.87, 0.4), (0.64, 0.0), (0.55, -0.2), (0.38, -0.6)],\n        # Case 3\n        [(0.761, 0.100), (0.7591, 0.101), (0.7599, 0.099)],\n        # Case 4\n        [(0.22, -0.5), (0.73, 0.2), (1.25, 0.6)],\n        # Case 5\n        [(0.40, -1.0), (0.80, 0.0), (1.20, 1.0)],\n    ]\n\n    results = []\n    \n    # A small tolerance for floating point comparisons to zero.\n    TOLERANCE = 1e-12\n\n    for case_data in test_cases:\n        # Unpack data into E_a (y) and Delta_E (x)\n        # Note: The problem gives (Ea, DeltaE), so y is first and x is second.\n        data = np.array(case_data)\n        y = data[:, 0]  # Activation energy E_a\n        x = data[:, 1]  # Reaction energy Delta_E\n        \n        n = len(x)\n        \n        # Calculate means\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n        \n        # Calculate sum of squared deviations for the independent variable x\n        s_xx = np.sum((x - x_mean)**2)\n        \n        # Handle the case where the variance of Delta_E is zero\n        if s_xx < TOLERANCE:\n            alpha = 0.0\n            e0 = y_mean\n        else:\n            # Calculate sum of products of deviations\n            s_xy = np.sum((x - x_mean) * (y - y_mean))\n            \n            # Calculate slope (alpha) and intercept (e0)\n            alpha = s_xy / s_xx\n            e0 = y_mean - alpha * x_mean\n            \n        # Calculate the coefficient of determination (R^2)\n        # Total Sum of Squares (SST)\n        sst = np.sum((y - y_mean)**2)\n        \n        # Residual Sum of Squares (SSR)\n        y_pred = e0 + alpha * x\n        ssr = np.sum((y - y_pred)**2)\n        \n        # Handle special cases for R^2 calculation\n        if sst < TOLERANCE:\n            if ssr < TOLERANCE:\n                r_squared = 1.0\n            else:\n                r_squared = 0.0\n        else:\n            r_squared = 1.0 - (ssr / sst)\n            \n        # Round results to six decimal places\n        alpha_rounded = round(alpha, 6)\n        e0_rounded = round(e0, 6)\n        r_squared_rounded = round(r_squared, 6)\n        \n        results.append([alpha_rounded, e0_rounded, r_squared_rounded])\n\n    # Format the final output string\n    # e.g., [[alpha1,E01,R21],[alpha2,E02,R22],...]\n    formatted_results = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "While electronic structure calculations provide the potential energy surface, a complete physical picture must account for the quantum nature of atomic nuclei, which possess zero-point vibrational energy (ZPE). This practice explores the impact of ZPE corrections on calculated activation barriers and reaction energies, a critical step in refining computational predictions. You will learn how to apply these essential harmonic corrections and quantify their effect on the parameters of the BEP relationship, providing insight into how nuclear quantum effects can systematically shift observed catalytic trends .",
            "id": "3870968",
            "problem": "A surface-mediated elementary reaction proceeds from a well-defined initial state (reactant, R) to a product state (P) through a single saddle point (transition state, TS). In periodic electronic-structure calculations that neglect nuclear zero-point motion, the electronic activation barrier and reaction energy are found to be $E_{a}^{\\mathrm{el}} = 0.80\\,\\mathrm{eV}$ and $\\Delta E^{\\mathrm{el}} = -0.20\\,\\mathrm{eV}$, respectively. Independent normal-mode analyses (harmonic approximation) yield zero-point energy (ZPE) corrections for each stationary point: $\\Delta \\mathrm{ZPE}_{R} = 0.10\\,\\mathrm{eV}$, $\\Delta \\mathrm{ZPE}_{\\mathrm{TS}} = 0.06\\,\\mathrm{eV}$, and $\\Delta \\mathrm{ZPE}_{P} = 0.04\\,\\mathrm{eV}$. A previously fitted Brønsted-Evans-Polanyi (BEP) linear free-energy relationship for this reaction family, constructed on the electronic energies without ZPE, has slope $\\alpha = 0.60$.\n\nUsing only the fundamental definitions that (i) the activation energy equals the energy difference between the transition state and the reactant, and (ii) the reaction energy equals the energy difference between the product and the reactant, first derive how state-specific ZPE corrections modify $E_{a}$ and $\\Delta E$. Then compute the ZPE-corrected activation barrier $E_{a}^{\\mathrm{corr}}$ and reaction energy $\\Delta E^{\\mathrm{corr}}$ from the data above. Finally, assuming the BEP slope $\\alpha$ remains unchanged upon ZPE correction, compute the BEP-intercept shift $\\Delta E_{0} \\equiv E_{0}^{\\mathrm{corr}} - E_{0}^{\\mathrm{el}}$ implied by these ZPE corrections.\n\nReport your final numerical results as a single row matrix containing, in order, $E_{a}^{\\mathrm{corr}}$, $\\Delta E^{\\mathrm{corr}}$, and $\\Delta E_{0}$. Round all three entries to four significant figures and express energies in $\\mathrm{eV}$.",
            "solution": "The user has requested the validation of the problem statement, followed by a complete solution if the problem is deemed valid.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Electronic activation barrier: $E_{a}^{\\mathrm{el}} = 0.80\\,\\mathrm{eV}$\n- Electronic reaction energy: $\\Delta E^{\\mathrm{el}} = -0.20\\,\\mathrm{eV}$\n- Zero-point energy (ZPE) correction for the reactant (R): $\\Delta \\mathrm{ZPE}_{R} = 0.10\\,\\mathrm{eV}$\n- ZPE correction for the transition state (TS): $\\Delta \\mathrm{ZPE}_{\\mathrm{TS}} = 0.06\\,\\mathrm{eV}$\n- ZPE correction for the product (P): $\\Delta \\mathrm{ZPE}_{P} = 0.04\\,\\mathrm{eV}$\n- Brønsted-Evans-Polanyi (BEP) slope: $\\alpha = 0.60$\n- Definition of activation energy: $E_{a} = E_{\\mathrm{TS}} - E_{\\mathrm{R}}$\n- Definition of reaction energy: $\\Delta E = E_{\\mathrm{P}} - E_{\\mathrm{R}}$\n- Task 1: Derive how ZPE corrections modify $E_{a}$ and $\\Delta E$.\n- Task 2: Compute the ZPE-corrected activation barrier $E_{a}^{\\mathrm{corr}}$ and reaction energy $\\Delta E^{\\mathrm{corr}}$.\n- Task 3: Compute the BEP-intercept shift $\\Delta E_{0} \\equiv E_{0}^{\\mathrm{corr}} - E_{0}^{\\mathrm{el}}$.\n- Output format: Report $E_{a}^{\\mathrm{corr}}$, $\\Delta E^{\\mathrm{corr}}$, and $\\Delta E_{0}$ in a row matrix, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the required criteria:\n- **Scientifically Grounded**: The problem is based on fundamental concepts of computational chemistry and heterogeneous catalysis, including electronic structure calculations, zero-point energy corrections within the harmonic approximation, and linear free-energy relationships (specifically the BEP relation). All concepts and terminologies are standard in the field. The provided energy values are physically realistic for a surface-catalyzed reaction.\n- **Well-Posed**: The problem is clearly stated, self-contained, and provides all necessary data and definitions to arrive at a unique solution. The required calculations are logically ordered and unambiguous.\n- **Objective**: The problem is presented using precise, quantitative, and unbiased language. It is free from any subjective or speculative content.\n\nBased on this evaluation, the problem statement is free from any scientific flaws, inconsistencies, or ambiguities. It is a valid, well-posed problem in computational chemical engineering.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A detailed solution will be provided.\n\n### Solution\n\nThe solution proceeds in three parts as requested by the problem statement.\n\n**Part 1: Derivation of ZPE-Corrected Energy Expressions**\n\nLet $E^{\\mathrm{el}}_{i}$ be the electronic energy of a stationary state $i$ (where $i \\in \\{R, TS, P\\}$), and let $\\Delta\\mathrm{ZPE}_{i}$ be its corresponding zero-point energy correction. The ZPE-corrected total energy, $E^{\\mathrm{corr}}_{i}$, is the sum of these two components:\n$$E^{\\mathrm{corr}}_{i} = E^{\\mathrm{el}}_{i} + \\Delta\\mathrm{ZPE}_{i}$$\nThe activation energy, $E_a$, and reaction energy, $\\Delta E$, are defined as energy differences.\n\nThe ZPE-corrected activation barrier, $E_a^{\\mathrm{corr}}$, is defined as the difference between the corrected energies of the transition state and the reactant:\n$$E_a^{\\mathrm{corr}} = E^{\\mathrm{corr}}_{\\mathrm{TS}} - E^{\\mathrm{corr}}_{\\mathrm{R}}$$\nSubstituting the expression for corrected energy:\n$$E_a^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{TS}} + \\Delta\\mathrm{ZPE}_{\\mathrm{TS}}) - (E^{\\mathrm{el}}_{\\mathrm{R}} + \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\nRearranging terms to group electronic energies and ZPE corrections separately:\n$$E_a^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{TS}} - E^{\\mathrm{el}}_{\\mathrm{R}}) + (\\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\nBy definition, the electronic activation barrier is $E_a^{\\mathrm{el}} = E^{\\mathrm{el}}_{\\mathrm{TS}} - E^{\\mathrm{el}}_{\\mathrm{R}}$. Therefore, the relationship between the corrected and electronic activation barriers is:\n$$E_a^{\\mathrm{corr}} = E_a^{\\mathrm{el}} + \\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\n\nSimilarly, the ZPE-corrected reaction energy, $\\Delta E^{\\mathrm{corr}}$, is defined as the difference between the corrected energies of the product and the reactant:\n$$\\Delta E^{\\mathrm{corr}} = E^{\\mathrm{corr}}_{\\mathrm{P}} - E^{\\mathrm{corr}}_{\\mathrm{R}}$$\nSubstituting the expression for corrected energy:\n$$\\Delta E^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{P}} + \\Delta\\mathrm{ZPE}_{\\mathrm{P}}) - (E^{\\mathrm{el}}_{\\mathrm{R}} + \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\nRearranging terms:\n$$\\Delta E^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{P}} - E^{\\mathrm{el}}_{\\mathrm{R}}) + (\\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\nBy definition, the electronic reaction energy is $\\Delta E^{\\mathrm{el}} = E^{\\mathrm{el}}_{\\mathrm{P}} - E^{\\mathrm{el}}_{\\mathrm{R}}$. Thus, the relationship is:\n$$\\Delta E^{\\mathrm{corr}} = \\Delta E^{\\mathrm{el}} + \\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\nThis completes the required derivation.\n\n**Part 2: Computation of $E_a^{\\mathrm{corr}}$ and $\\Delta E^{\\mathrm{corr}}$**\n\nUsing the derived formulae and the given data:\n- $E_{a}^{\\mathrm{el}} = 0.80\\,\\mathrm{eV}$\n- $\\Delta E^{\\mathrm{el}} = -0.20\\,\\mathrm{eV}$\n- $\\Delta \\mathrm{ZPE}_{R} = 0.10\\,\\mathrm{eV}$\n- $\\Delta \\mathrm{ZPE}_{\\mathrm{TS}} = 0.06\\,\\mathrm{eV}$\n- $\\Delta \\mathrm{ZPE}_{P} = 0.04\\,\\mathrm{eV}$\n\nThe ZPE-corrected activation barrier is:\n$$E_a^{\\mathrm{corr}} = 0.80\\,\\mathrm{eV} + 0.06\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV} = 0.76\\,\\mathrm{eV}$$\n\nThe ZPE-corrected reaction energy is:\n$$\\Delta E^{\\mathrm{corr}} = -0.20\\,\\mathrm{eV} + 0.04\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV} = -0.26\\,\\mathrm{eV}$$\n\n**Part 3: Computation of the BEP Intercept Shift $\\Delta E_0$**\n\nThe Brønsted-Evans-Polanyi relationship is a linear model of the form $E_a = \\alpha \\Delta E + E_0$, where $\\alpha$ is the slope and $E_0$ is the intercept.\n\nFor the electronic energies, the relationship is:\n$$E_a^{\\mathrm{el}} = \\alpha \\Delta E^{\\mathrm{el}} + E_0^{\\mathrm{el}}$$\nThe intercept is therefore $E_0^{\\mathrm{el}} = E_a^{\\mathrm{el}} - \\alpha \\Delta E^{\\mathrm{el}}$.\n\nFor the ZPE-corrected energies, assuming the slope $\\alpha$ is unchanged:\n$$E_a^{\\mathrm{corr}} = \\alpha \\Delta E^{\\mathrm{corr}} + E_0^{\\mathrm{corr}}$$\nThe intercept is $E_0^{\\mathrm{corr}} = E_a^{\\mathrm{corr}} - \\alpha \\Delta E^{\\mathrm{corr}}$.\n\nThe shift in the intercept, $\\Delta E_0$, is defined as $\\Delta E_0 = E_0^{\\mathrm{corr}} - E_0^{\\mathrm{el}}$. Substituting the expressions for the intercepts:\n$$\\Delta E_0 = (E_a^{\\mathrm{corr}} - \\alpha \\Delta E^{\\mathrm{corr}}) - (E_a^{\\mathrm{el}} - \\alpha \\Delta E^{\\mathrm{el}})$$\n$$\\Delta E_0 = (E_a^{\\mathrm{corr}} - E_a^{\\mathrm{el}}) - \\alpha (\\Delta E^{\\mathrm{corr}} - \\Delta E^{\\mathrm{el}})$$\nFrom Part 1, we know the differences $(E_a^{\\mathrm{corr}} - E_a^{\\mathrm{el}})$ and $(\\Delta E^{\\mathrm{corr}} - \\Delta E^{\\mathrm{el}})$:\n$$E_a^{\\mathrm{corr}} - E_a^{\\mathrm{el}} = \\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\n$$\\Delta E^{\\mathrm{corr}} - \\Delta E^{\\mathrm{el}} = \\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\nSubstituting these into the expression for $\\Delta E_0$:\n$$\\Delta E_0 = (\\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}) - \\alpha (\\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\nNow, we insert the given numerical values: $\\alpha=0.60$, $\\Delta\\mathrm{ZPE}_{\\mathrm{R}}=0.10\\,\\mathrm{eV}$, $\\Delta\\mathrm{ZPE}_{\\mathrm{TS}}=0.06\\,\\mathrm{eV}$, and $\\Delta\\mathrm{ZPE}_{\\mathrm{P}}=0.04\\,\\mathrm{eV}$.\n$$\\Delta E_0 = (0.06\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV}) - 0.60 \\times (0.04\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV})$$\n$$\\Delta E_0 = (-0.04\\,\\mathrm{eV}) - 0.60 \\times (-0.06\\,\\mathrm{eV})$$\n$$\\Delta E_0 = -0.04\\,\\mathrm{eV} + 0.036\\,\\mathrm{eV}$$\n$$\\Delta E_0 = -0.004\\,\\mathrm{eV}$$\n\nRounding the final results to four significant figures as requested:\n$E_a^{\\mathrm{corr}} = 0.7600\\,\\mathrm{eV}$\n$\\Delta E^{\\mathrm{corr}} = -0.2600\\,\\mathrm{eV}$\n$\\Delta E_0 = -0.004000\\,\\mathrm{eV}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7600 & -0.2600 & -0.004000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The predictive power of BEP relationships is greatest when applied to a consistent \"reaction family\" sharing a common mechanism. This advanced exercise challenges you to move beyond simple regression and into the realm of model selection, a critical skill for any computational researcher. Using the Akaike Information Criterion (AIC), you will quantitatively assess whether a single, pooled BEP model is sufficient or if separating data by mechanistic class—such as oxidative addition versus sigma-bond metathesis—yields a more robust and physically justified description of catalytic reactivity .",
            "id": "3870994",
            "problem": "You are given density functional theory (DFT)-computed reaction energies and activation barriers for a set of carbon–hydrogen bond activation steps over late transition metal catalysts, with each data point labeled by a mechanistic class. The two mechanistic labels provided are oxidative addition and sigma-bond metathesis. Your task is to design and implement a protocol that, for each mechanistic class and for the pooled dataset, estimates the best linear mapping from the reaction energy to the activation barrier characterized by a slope and an intercept. The protocol must be grounded in well-tested principles of transition state theory and physically motivated energy landscape arguments, and it must assess whether model fitting that respects mechanistic grouping is essential relative to a single pooled fit.\n\nUse the following context as the fundamental base for your reasoning and algorithm design without stating or using the target concept as a given formula. Transition State Theory (TST) provides that the rate constant $k$ of an elementary step is $k = A \\exp\\left(-E_a/(k_B T)\\right)$, where $A$ is a pre-exponential factor, $E_a$ is the activation barrier, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. Empirical and theoretical observations for thermally activated processes indicate that variations in reaction thermochemistry $\\,\\Delta E\\,$ and the position of the transition state along the reaction coordinate jointly modulate the barrier height. Affine linearity between the barrier and thermochemistry can be motivated by local expansions of the barrier around a reference reaction energy combined with Hammond-type arguments for transition state movement. Ordinary least squares (OLS) is a standard method for estimating linear mappings between measured inputs and outputs under Gaussian residual assumptions. To compare whether mechanistic grouping is essential, use the Akaike Information Criterion (AIC) defined as $\\mathrm{AIC} = n \\ln\\left(\\mathrm{RSS}/n\\right) + 2k$, where $n$ is the number of observations, $\\mathrm{RSS}$ is the residual sum of squares, and $k$ is the number of fitted parameters.\n\nImplement the protocol as follows:\n- Partition the dataset by mechanistic label and also consider the pooled dataset combining all points.\n- For each partition, estimate the slope $\\alpha$ and intercept $E_0$ of the best affine mapping from $\\,\\Delta E\\,$ to $\\,E_a\\,$ using ordinary least squares.\n- Compute the residual sum of squares $\\mathrm{RSS}$ and the Akaike Information Criterion $\\mathrm{AIC}$ for each partition.\n- Compare the total grouped $\\mathrm{AIC}$, defined as the sum of the $\\mathrm{AIC}$ values over the mechanistic partitions, against the pooled $\\mathrm{AIC}$. Define a boolean improvement flag that is $1$ if the grouped $\\mathrm{AIC}$ is strictly less than the pooled $\\mathrm{AIC}$ and $0$ otherwise.\n\nUnits and numerical requirements:\n- All energies $\\,\\Delta E\\,$ and $\\,E_a\\,$ are provided in electronvolts (eV). Report $E_0$ in electronvolts (eV) and $\\alpha$ as dimensionless values. Report $\\mathrm{AIC}$ as a dimensionless float.\n- Round all floating-point outputs to $4$ decimal places.\n- Angles do not appear in this problem.\n\nTest suite:\nUse exactly the following labeled datasets and do not modify the values. For oxidative addition (OA), use $\\,\\Delta E\\,\\mathrm{(eV)} = [\\,0.10,\\,0.30,\\,0.50,\\,0.70,\\,0.90\\,]$ and $\\,E_a\\,\\mathrm{(eV)} = [\\,0.425,\\,0.540,\\,0.675,\\,0.820,\\,0.915\\,]$. For sigma-bond metathesis (SBM), use $\\,\\Delta E\\,\\mathrm{(eV)} = [\\,-0.20,\\,0.00,\\,0.20,\\,0.40,\\,0.60\\,]$ and $\\,E_a\\,\\mathrm{(eV)} = [\\,0.790,\\,0.860,\\,0.890,\\,0.970,\\,1.015\\,]$. The SBM dataset includes the boundary case $\\,\\Delta E = 0.00\\,$ which allows testing the intercept interpretation. The combined pooled dataset is the concatenation of the OA and SBM datasets.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the exact order:\n$[\\,\\alpha_{\\mathrm{OA}},\\,E_{0,\\mathrm{OA}},\\,\\alpha_{\\mathrm{SBM}},\\,E_{0,\\mathrm{SBM}},\\,\\alpha_{\\mathrm{all}},\\,E_{0,\\mathrm{all}},\\,\\mathrm{AIC}_{\\mathrm{grouped}},\\,\\mathrm{AIC}_{\\mathrm{pooled}},\\,\\mathrm{improvement\\_flag}\\,]$,\nwhere $\\,\\alpha_{\\mathrm{OA}}\\,$ and $\\,E_{0,\\mathrm{OA}}\\,$ are the slope and intercept for oxidative addition, $\\,\\alpha_{\\mathrm{SBM}}\\,$ and $\\,E_{0,\\mathrm{SBM}}\\,$ are the slope and intercept for sigma-bond metathesis, $\\,\\alpha_{\\mathrm{all}}\\,$ and $\\,E_{0,\\mathrm{all}}\\,$ are the slope and intercept for the pooled dataset, $\\,\\mathrm{AIC}_{\\mathrm{grouped}}\\,$ is the sum of the group-wise AIC values, $\\,\\mathrm{AIC}_{\\mathrm{pooled}}\\,$ is the AIC of the pooled model, and $\\,\\mathrm{improvement\\_flag}\\,$ is an integer $\\,0\\,$ or $\\,1\\,$. All floating-point values must be rounded to $4$ decimal places. The output must strictly follow the format example $[\\,0.1234,0.5678,0.1234,0.5678,0.1234,0.5678,-12.3456,-12.3456,1\\,]$.",
            "solution": "The problem requires the design and implementation of a computational protocol to analyze the relationship between reaction energies ($\\Delta E$) and activation barriers ($E_a$) for two classes of catalytic reactions: oxidative addition (OA) and sigma-bond metathesis (SBM). The core task is to determine the best-fit affine mapping, $E_a = \\alpha \\Delta E + E_0$, for each class and for a pooled dataset, and then to use the Akaike Information Criterion (AIC) to assess whether treating the two mechanistic classes separately provides a statistically superior model compared to a single model for the combined data. This type of linear relationship is a cornerstone of catalysis, known as a Brønsted-Evans-Polanyi (BEP) relationship.\n\nThe foundation of the protocol rests on two key principles: linear regression via Ordinary Least Squares (OLS) for parameter estimation, and AIC for model selection.\n\nFirst, we address the estimation of the parameters $\\alpha$ (the BEP slope) and $E_0$ (the intrinsic activation barrier). For a given dataset of $n$ points $(\\Delta E_i, E_{a,i})$, the goal of OLS is to find the line that minimizes the sum of the squared vertical distances between the data points and the line. This quantity is the Residual Sum of Squares (RSS):\n$$ \\mathrm{RSS} = \\sum_{i=1}^{n} (E_{a,i} - (\\alpha \\Delta E_i + E_0))^2 $$\nThe values of $\\alpha$ and $E_0$ that minimize this function can be found analytically. Given the sample means $\\overline{\\Delta E} = \\frac{1}{n}\\sum_{i=1}^{n} \\Delta E_i$ and $\\overline{E_a} = \\frac{1}{n}\\sum_{i=1}^{n} E_{a,i}$, the optimal parameters are:\n$$ \\alpha = \\frac{\\sum_{i=1}^{n} (\\Delta E_i - \\overline{\\Delta E})(E_{a,i} - \\overline{E_a})}{\\sum_{i=1}^{n} (\\Delta E_i - \\overline{\\Delta E})^2} $$\n$$ E_0 = \\overline{E_a} - \\alpha \\overline{\\Delta E} $$\nThe parameter $E_0$ represents the activation barrier when the reaction is thermoneutral ($\\Delta E = 0$), and $\\alpha$ quantifies the sensitivity of the activation barrier to changes in reaction thermochemistry. According to Hammond's Postulate, $\\alpha$ is often interpreted as a measure of the position of the transition state along the reaction coordinate, with values typically between $0$ and $1$.\n\nSecond, we must compare two competing modeling hypotheses: (1) a \"grouped\" model where OA and SBM reactions are described by separate BEP relationships, and (2) a \"pooled\" model where a single BEP relationship describes all data points regardless of mechanism. The Akaike Information Criterion (AIC) provides a means for this comparison. AIC evaluates the trade-off between the goodness of fit (a lower RSS) and the complexity of the model (the number of fitted parameters). The formula is given as:\n$$ \\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{RSS}}{n}\\right) + 2k $$\nHere, $n$ is the number of data points, $\\mathrm{RSS}$ is the residual sum of squares from the OLS fit, and $k$ is the number of parameters in the model. For our affine model, $E_a = \\alpha \\Delta E + E_0$, we are estimating two parameters ($\\alpha$ and $E_0$), so $k=2$. A lower AIC value indicates a better model, suggesting that it achieves a good fit without being overly complex.\n\nThe computational protocol will proceed as follows:\n1.  Define a function that accepts a set of $\\Delta E$ and $E_a$ data. This function will:\n    a. Calculate the OLS parameters $\\alpha$ and $E_0$.\n    b. Compute the predicted activation barriers, $\\hat{E}_{a,i} = \\alpha \\Delta E_i + E_0$.\n    c. Calculate the RSS from the true and predicted barriers.\n    d. Calculate the AIC using $n$ as the number of points and $k=2$.\n    e. Return the calculated $\\alpha$, $E_0$, and AIC.\n\n2.  This function will be applied three times:\n    a. To the oxidative addition (OA) data, yielding $\\alpha_{\\mathrm{OA}}$, $E_{0,\\mathrm{OA}}$, and $\\mathrm{AIC}_{\\mathrm{OA}}$.\n    b. To the sigma-bond metathesis (SBM) data, yielding $\\alpha_{\\mathrm{SBM}}$, $E_{0,\\mathrm{SBM}}$, and $\\mathrm{AIC}_{\\mathrm{SBM}}$.\n    c. To the pooled dataset (concatenated OA and SBM data), yielding $\\alpha_{\\mathrm{all}}$, $E_{0,\\mathrm{all}}$, and $\\mathrm{AIC}_{\\mathrm{pooled}}$.\n\n3.  The total AIC for the grouped model is defined as the sum of the individual AICs:\n    $$ \\mathrm{AIC}_{\\mathrm{grouped}} = \\mathrm{AIC}_{\\mathrm{OA}} + \\mathrm{AIC}_{\\mathrm{SBM}} $$\n    This approach correctly represents the information loss from fitting two separate models.\n\n4.  Finally, we compare the two modeling strategies. An improvement flag is set to $1$ if the grouped model is superior (i.e., has a strictly lower AIC value) and $0$ otherwise.\n    $$ \\mathrm{improvement\\_flag} = \\begin{cases} 1 & \\text{if } \\mathrm{AIC}_{\\mathrm{grouped}} < \\mathrm{AIC}_{\\mathrm{pooled}} \\\\ 0 & \\text{otherwise} \\end{cases} $$\n    A flag of $1$ implies that the mechanistic distinction is statistically meaningful and that using separate models for OA and SBM is justified by the data. All floating-point results will be rounded to four decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Note: scipy is permitted but not required for this problem,\n# as np.polyfit is sufficient for ordinary least squares.\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting Brønsted-Evans-Polanyi relationships for\n    catalytic C-H activation and comparing model performance using AIC.\n    \"\"\"\n    # Define the datasets from the problem statement.\n    test_cases = {\n        \"OA\": {\n            \"delta_e\": np.array([0.10, 0.30, 0.50, 0.70, 0.90]),\n            \"e_a\": np.array([0.425, 0.540, 0.675, 0.820, 0.915]),\n        },\n        \"SBM\": {\n            \"delta_e\": np.array([-0.20, 0.00, 0.20, 0.40, 0.60]),\n            \"e_a\": np.array([0.790, 0.860, 0.890, 0.970, 1.015]),\n        },\n    }\n\n    # Combine datasets for the pooled analysis\n    pooled_delta_e = np.concatenate([test_cases[\"OA\"][\"delta_e\"], test_cases[\"SBM\"][\"delta_e\"]])\n    pooled_e_a = np.concatenate([test_cases[\"OA\"][\"e_a\"], test_cases[\"SBM\"][\"e_a\"]])\n    \n    test_cases[\"all\"] = {\n        \"delta_e\": pooled_delta_e,\n        \"e_a\": pooled_e_a,\n    }\n\n    def perform_regression_analysis(delta_e, e_a):\n        \"\"\"\n        Performs OLS regression and calculates AIC for a given dataset.\n\n        Args:\n            delta_e (np.ndarray): Reaction energies (independent variable).\n            e_a (np.ndarray): Activation barriers (dependent variable).\n\n        Returns:\n            tuple: Contains slope (alpha), intercept (E0), and AIC.\n        \"\"\"\n        # Number of data points\n        n = len(delta_e)\n        # Number of fitted parameters for an affine model (slope, intercept)\n        k = 2\n\n        # Use numpy.polyfit for Ordinary Least Squares to find slope (alpha) and intercept (E0)\n        # It returns coefficients in descending power order, so [slope, intercept] for degree 1\n        alpha, e0 = np.polyfit(delta_e, e_a, 1)\n\n        # Calculate predicted activation barriers\n        e_a_predicted = alpha * delta_e + e0\n\n        # Calculate Residual Sum of Squares (RSS)\n        rss = np.sum((e_a - e_a_predicted)**2)\n\n        # Calculate Akaike Information Criterion (AIC)\n        # Use a small epsilon to avoid log(0) in case of a perfect fit\n        if rss <= 0:\n            aic = -np.inf\n        else:\n            aic = n * np.log(rss / n) + 2 * k\n        \n        return alpha, e0, aic\n\n    # Perform analysis for each partition\n    alpha_oa, e0_oa, aic_oa = perform_regression_analysis(test_cases[\"OA\"][\"delta_e\"], test_cases[\"OA\"][\"e_a\"])\n    alpha_sbm, e0_sbm, aic_sbm = perform_regression_analysis(test_cases[\"SBM\"][\"delta_e\"], test_cases[\"SBM\"][\"e_a\"])\n    alpha_all, e0_all, aic_pooled = perform_regression_analysis(test_cases[\"all\"][\"delta_e\"], test_cases[\"all\"][\"e_a\"])\n\n    # Calculate total grouped AIC as the sum of individual AICs\n    aic_grouped = aic_oa + aic_sbm\n\n    # Determine if the grouped model is an improvement\n    improvement_flag = 1 if aic_grouped < aic_pooled else 0\n\n    # Collect all results\n    results = [\n        alpha_oa, e0_oa,\n        alpha_sbm, e0_sbm,\n        alpha_all, e0_all,\n        aic_grouped, aic_pooled,\n        improvement_flag,\n    ]\n\n    # Format the results for output\n    formatted_results = []\n    for res in results:\n        if isinstance(res, (float, np.floating)):\n            formatted_results.append(f\"{res:.4f}\")\n        else:\n            formatted_results.append(str(res))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}