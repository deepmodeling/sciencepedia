{
    "hands_on_practices": [
        {
            "introduction": "Langmuir-Hinshelwood (LH) 机理是多相催化的基石，它描述了反应物如何在催化剂表面吸附、反应并最终生成产物。深刻理解反应速率如何响应反应物分压和温度的变化，是预测和优化催化剂性能的核心。本练习将指导你从基本原理出发，推导一个典型的双分子 LH 反应的速率方程和反应级数，并结合 van't Hoff 方程分析温度对吸附平衡的影响，从而掌握构建和分析表面动力学模型的关键技能 ()。",
            "id": "3879681",
            "problem": "考虑一个催化表面反应的二元朗缪尔-欣谢尔伍德（Langmuir-Hinshelwood, LH）机理，该反应涉及两种气相物质 $A$ 和 $B$。这两种物质在同一种类型的表面活性位点上竞争吸附，并通过一个基元双分子表面反应进行反应。假设以下基元步骤和模型假设成立：(i) $A$ 和 $B$ 的非解离吸附遵循质量作用动力学，(ii) 每种物质的吸附和解吸达到准平衡状态，具有明确定义的吸附平衡常数，(iii) 每个吸附物占据一个位点，且无横向相互作用（理想平均场朗缪尔模型），(iv) 只有单一类型的均匀表面位点，(v) 位点平衡强制执行分数覆盖度的守恒，以及 (vi) 吸附的 $A$ 和 $B$ 之间的表面反应是基元且不可逆的。\n\n你需要基于第一性原理，推导并实现产物生成速率相对于分压 $p_A$ 和 $p_B$ 的反应级数。从基元表面步骤的质量作用动力学、吸附/解吸的准平衡以及朗缪尔位点平衡这些基本原理出发。不要从任何预先给定的速率表达式开始。使用以下定义和物理关系：\n\n- 吸附平衡由与温度相关的平衡常数 $K_A(T)$ 和 $K_B(T)$ 表征，当压力以 $\\text{bar}$ 为单位时，其单位为 $\\text{bar}^{-1}$。这些常数遵循范特霍夫（van’t Hoff）关系，该关系由参考温度 $T_{\\mathrm{ref}}$ 和吸附焓 $\\Delta H_A$ 和 $\\Delta H_B$（对于放热吸附为负值）参数化：\n$$\nK_i(T) \\;=\\; K_{i,\\mathrm{ref}} \\,\\exp\\!\\left(\\frac{\\Delta H_i}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}}-\\frac{1}{T}\\right)\\right), \\quad i \\in \\{A,B\\}.\n$$\n- 表面反应速率常数 $k_s(T)$ 遵循阿伦尼乌斯（Arrhenius）行为，$k_s(T) \\;=\\; k_0 \\exp\\!\\left(-\\frac{E_a}{R T}\\right)$，其中 $k_0$ 是指前因子，$E_a$ 是表面反应的活化能。尽管 $k_s(T)$ 会影响速率的大小，但在所述假设下，当对 $p_A$ 和 $p_B$ 求导以获得反应级数时，$k_s(T)$ 对压力依赖性没有贡献。\n- 反应级数定义为速率 $r$ 相对于分压的对数灵敏度：\n$$\nn_A \\;=\\; \\frac{\\partial \\ln r}{\\partial \\ln p_A}, \\qquad\nn_B \\;=\\; \\frac{\\partial \\ln r}{\\partial \\ln p_B}.\n$$\n\n任务：\n1. 从基元步骤、吸附的准平衡以及分数覆盖度的朗缪尔位点平衡出发，推导吸附的 $A$ 和 $B$ 的分数覆盖度（用 $p_A$、$p_B$、$K_A(T)$、$K_B(T)$ 和空位点分数表示）。然后，获得吸附的 $A$ 和 $B$ 之间基元表面反应的速率 $r$ 作为这些量的函数。\n2. 从你推导出的 $r$，获得反应级数 $n_A$ 和 $n_B$ 的闭式表达式，该表达式仅为 $p_A$、$p_B$、$K_A(T)$ 和 $K_B(T)$ 的函数。\n3. 实现一个程序，使用所提供的物理常数和关系，为以下 $(p_A,p_B,T)$ 值的测试组计算 $n_A$ 和 $n_B$。该程序必须通过范特霍夫关系计算 $K_A(T)$ 和 $K_B(T)$，然后根据你推导的表达式计算 $n_A$ 和 $n_B$。所有分压以 $\\text{bar}$ 表示，所有温度以 $\\text{K}$ 表示。反应级数是无量纲的。每个报告的数字应四舍五入到六位小数。\n常数：\n- $R = 8.314462618 \\;\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$，\n- $T_{\\mathrm{ref}} = 500 \\;\\text{K}$，\n- $K_{A,\\mathrm{ref}} = 2.0 \\;\\text{bar}^{-1}$，\n- $K_{B,\\mathrm{ref}} = 0.2 \\;\\text{bar}^{-1}$，\n- $\\Delta H_A = -40000 \\;\\text{J}\\,\\text{mol}^{-1}$，\n- $\\Delta H_B = -20000 \\;\\text{J}\\,\\text{mol}^{-1}$，\n- $k_0 = 1.0\\times 10^5 \\;\\text{s}^{-1}$（计算反应级数不需要），\n- $E_a = 60000 \\;\\text{J}\\,\\text{mol}^{-1}$（计算反应级数不需要）。\n\n测试组（每个元组为 $(p_A,p_B,T)$）：\n- 情况 1：$(0.01,\\,0.01,\\,700)$\n- 情况 2：$(5.0,\\,0.1,\\,500)$\n- 情况 3：$(0.5,\\,40.0,\\,350)$\n- 情况 4：$(20.0,\\,0.0,\\,450)$\n- 情况 5：$(1.0,\\,1.0,\\,300)$\n- 情况 6：$(1.0,\\,1.0,\\,800)$\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个双元素列表 $[n_A,n_B]$，两个数字都四舍五入到六位小数。例如，输出格式必须是\n$$\n[[n_{A,1},n_{B,1}],[n_{A,2},n_{B,2}],\\ldots,[n_{A,6},n_{B,6}]]\n$$\n列表中不插入空格，并精确地作为单行打印。",
            "solution": "用户在化学工程和多相催化领域提供了一个有效的问题陈述。该问题要求推导并实现一个二元朗缪尔-欣谢尔伍德（LH）催化反应的反应级数表达式。该问题具有科学依据，提法明确，并提供了所有必要的参数。\n\n推导过程按要求从基本原理出发。令 $*$ 表示一个空的表面位点，$A(g)$ 和 $B(g)$ 表示气相反应物，$A*$ 和 $B*$ 表示相应的吸附物种。\n\n**1. 表面覆盖度和反应速率的推导**\n\n该过程的基元步骤如下：\n1.  物种A的可逆、非解离吸附： $A(g) + * \\rightleftharpoons A*$\n2.  物种B的可逆、非解离吸附： $B(g) + * \\rightleftharpoons B*$\n3.  不可逆的基元表面反应： $A* + B* \\rightarrow \\text{产物} + 2*$\n\n令 $\\theta_A$、$\\theta_B$ 和 $\\theta_v$ 分别为物种A、物种B和空位点的分数表面覆盖度。\n\n在吸附的准平衡假设下（步骤1和2），每种物质的吸附速率等于解吸速率。对于物种A，这表示为：\n$$r_{ad,A} = r_{des,A}$$\n使用质量作用动力学，其中吸附速率与分压 $p_A$ 和空位点分数 $\\theta_v$ 成正比，解吸速率与吸附位点分数 $\\theta_A$ 成正比：\n$$k_{ad,A} p_A \\theta_v = k_{des,A} \\theta_A$$\n整理后得到 $\\theta_A$ 的表达式：\n$$\\theta_A = \\frac{k_{ad,A}}{k_{des,A}} p_A \\theta_v = K_A(T) p_A \\theta_v$$\n其中 $K_A(T) = k_{ad,A}/k_{des,A}$ 是物种A的与温度相关的吸附平衡常数。\n\n对于物种B，通过完全相同的论证：\n$$\\theta_B = K_B(T) p_B \\theta_v$$\n其中 $K_B(T)$ 是物种B的吸附平衡常数。\n\n朗缪尔模型假设总位点数是固定的。位点平衡方程指出，所有分数覆盖度的总和必须为1：\n$$\\theta_A + \\theta_B + \\theta_v = 1$$\n我们现在可以通过将 $\\theta_A$ 和 $\\theta_B$ 的平衡表达式代入位点平衡方程来求解覆盖度：\n$$K_A(T) p_A \\theta_v + K_B(T) p_B \\theta_v + \\theta_v = 1$$\n将 $\\theta_v$ 因子提出：\n$$\\theta_v(1 + K_A(T) p_A + K_B(T) p_B) = 1$$\n这就得出了空位点分数的表达式：\n$$\\theta_v = \\frac{1}{1 + K_A(T) p_A + K_B(T) p_B}$$\n将这个 $\\theta_v$ 的表达式代回 $\\theta_A$ 和 $\\theta_B$ 的方程中，我们得到表面覆盖度的最终表达式：\n$$\\theta_A = \\frac{K_A(T) p_A}{1 + K_A(T) p_A + K_B(T) p_B}$$\n$$\\theta_B = \\frac{K_B(T) p_B}{1 + K_A(T) p_A + K_B(T) p_B}$$\n\n表面反应步骤 $A* + B* \\rightarrow \\text{产物}$ 被规定为基元且不可逆的。因此，该反应的速率 $r$ 由应用于表面物种的质量作用定律给出：\n$$r = k_s(T) \\theta_A \\theta_B$$\n其中 $k_s(T)$ 是表面反应速率常数。代入推导出的 $\\theta_A$ 和 $\\theta_B$ 的表达式，得到完整的速率定律：\n$$r(p_A, p_B, T) = k_s(T) \\frac{K_A(T) p_A}{(1 + K_A(T) p_A + K_B(T) p_B)} \\frac{K_B(T) p_B}{(1 + K_A(T) p_A + K_B(T) p_B)}$$\n$$r = \\frac{k_s(T) K_A(T) K_B(T) p_A p_B}{(1 + K_A(T) p_A + K_B(T) p_B)^2}$$\n这就是两种竞争吸附物种之间双分子反应的朗缪尔-欣谢尔伍德速率表达式。\n\n**2. 反应级数的推导**\n\n相对于某物种的反应级数定义为速率对其分压的对数导数。对于物种A，反应级数 $n_A$ 为：\n$$n_A = \\frac{\\partial \\ln r}{\\partial \\ln p_A} \\equiv \\frac{p_A}{r} \\frac{\\partial r}{\\partial p_A}$$\n为了推导 $n_A$ 的表达式，我们首先对速率表达式 $r$ 取自然对数：\n$$\\ln r = \\ln(k_s(T) K_A(T) K_B(T)) + \\ln p_A + \\ln p_B - 2 \\ln(1 + K_A(T) p_A + K_B(T) p_B)$$\n现在，我们对 $\\ln r$ 求关于 $p_A$ 的偏导数，同时保持 $p_B$ 和 $T$ 不变。项 $k_s(T)$、$K_A(T)$ 和 $K_B(T)$ 相对于压力是常数。\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{\\partial}{\\partial p_A} \\left[ \\ln p_A - 2 \\ln(1 + K_A p_A + K_B p_B) \\right]$$\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{1}{p_A} - 2 \\frac{1}{1 + K_A p_A + K_B p_B} \\frac{\\partial}{\\partial p_A}(1 + K_A p_A + K_B p_B)$$\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{1}{p_A} - \\frac{2 K_A}{1 + K_A p_A + K_B p_B}$$\n使用链式法则定义 $n_A = \\frac{\\partial \\ln r}{\\partial \\ln p_A} = p_A\\frac{\\partial \\ln r}{\\partial p_A}$：\n$$n_A = p_A \\left( \\frac{1}{p_A} - \\frac{2 K_A}{1 + K_A p_A + K_B p_B} \\right)$$\n$$n_A = 1 - \\frac{2 K_A p_A}{1 + K_A p_A + K_B p_B}$$\n这就是相对于物种A的反应级数的最终表达式。\n\n$n_B$ 的推导是对称的：\n$$n_B = \\frac{\\partial \\ln r}{\\partial \\ln p_B}$$\n对 $\\ln r$ 求关于 $p_B$ 的偏导数：\n$$\\frac{\\partial (\\ln r)}{\\partial p_B} = \\frac{1}{p_B} - \\frac{2 K_B}{1 + K_A p_A + K_B p_B}$$\n乘以 $p_B$：\n$$n_B = p_B \\left( \\frac{1}{p_B} - \\frac{2 K_B}{1 + K_A p_A + K_B p_B} \\right)$$\n$$n_B = 1 - \\frac{2 K_B p_B}{1 + K_A p_A + K_B p_B}$$\n\n**3. 实现计划**\n推导出的表达式将在一个Python程序中实现。该程序将首先定义给定的物理常数。然后，对于每个测试用例 $(p_A, p_B, T)$：\na. 它将使用提供的范特霍夫方程计算与温度相关的吸附常数 $K_A(T)$ 和 $K_B(T)$：\n   $$K_i(T) = K_{i,\\mathrm{ref}} \\exp\\left(\\frac{\\Delta H_i}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}}-\\frac{1}{T}\\right)\\right)$$\nb. 然后它将计算分母项 $D = 1 + K_A(T) p_A + K_B(T) p_B$。\nc. 最后，它将计算 $n_A = 1 - 2 K_A(T) p_A / D$ 和 $n_B = 1 - 2 K_B(T) p_B / D$。\nd. 每个测试用例的结果，四舍五入到六位小数，将被收集并格式化为所需的输出字符串。当反应物分压为零的特殊情况（如测试用例4中$p_B=0.0$），推导出的公式能正确处理，得到 $n_B=1$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes reaction orders for a Langmuir-Hinshelwood mechanism.\n    \"\"\"\n\n    # --- Define Physical Constants ---\n    R = 8.314462618  # J mol^-1 K^-1\n    T_ref = 500.0      # K\n    K_A_ref = 2.0      # bar^-1\n    K_B_ref = 0.2      # bar^-1\n    dH_A = -40000.0    # J mol^-1\n    dH_B = -20000.0    # J mol^-1\n    # k0 and Ea are not needed for reaction order calculation.\n\n    # --- Define Test Suite ---\n    # Each tuple is (p_A [bar], p_B [bar], T [K])\n    test_cases = [\n        (0.01, 0.01, 700.0),\n        (5.0, 0.1, 500.0),\n        (0.5, 40.0, 350.0),\n        (20.0, 0.0, 450.0),\n        (1.0, 1.0, 300.0),\n        (1.0, 1.0, 800.0),\n    ]\n\n    def calculate_K(K_ref, dH, T):\n        \"\"\"\n        Calculates the adsorption equilibrium constant K at temperature T\n        using the van't Hoff relation.\n        \"\"\"\n        if T == 0:\n            # Avoid division by zero; realistically, T > 0K.\n            # As T->0, for exothermic adsorption, K->infinity.\n            return float('inf')\n        \n        exponent = (dH / R) * ((1.0 / T_ref) - (1.0 / T))\n        return K_ref * np.exp(exponent)\n\n    def calculate_orders(p_A, p_B, T):\n        \"\"\"\n        Calculates the reaction orders n_A and n_B.\n        \"\"\"\n        # Calculate temperature-dependent equilibrium constants\n        K_A = calculate_K(K_A_ref, dH_A, T)\n        K_B = calculate_K(K_B_ref, dH_B, T)\n\n        # Calculate the denominator of the rate expression\n        denominator = 1.0 + K_A * p_A + K_B * p_B\n\n        # Calculate reaction orders based on the derived expressions\n        # n_A = 1 - 2 * K_A * p_A / denominator\n        # n_B = 1 - 2 * K_B * p_B / denominator\n        if denominator == 0:\n            # Should not happen under physical conditions\n            return (np.nan, np.nan)\n        \n        n_A = 1.0 - (2.0 * K_A * p_A) / denominator\n        n_B = 1.0 - (2.0 * K_B * p_B) / denominator\n        \n        return n_A, n_B\n\n    results = []\n    for case in test_cases:\n        p_A, p_B, T = case\n        n_A, n_B = calculate_orders(p_A, p_B, T)\n        \n        # Round the results to six decimal places\n        n_A_rounded = round(n_A, 6)\n        n_B_rounded = round(n_B, 6)\n        \n        results.append([n_A_rounded, n_B_rounded])\n\n    # Format the final output string exactly as required\n    # e.g., [[-0.818182,0.909091],[...]]\n    # Using str().replace() is a robust way to remove spaces.\n    final_output = str(results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在从理论模型转向实验验证时，程序升温脱附 (Temperature Programmed Desorption, TPD) 是一种揭示表面吸附和反应动力学的强大技术。通过分析 TPD 谱图，我们可以推断出脱附过程的微观机理，例如区分分子直接脱附（一级过程）和原子复合脱附（二级过程）。本练习基于 Polanyi-Wigner 方程，要求你推导不同脱附级数下 TPD 峰值温度 ($T_p$) 的解析表达式，这将加深你对 TPD 实验数据背后物理化学原理的理解，并锻炼你处理复杂动力学问题的能力 ()。",
            "id": "3879672",
            "problem": "一个程序升温脱附（TPD）实验根据 $T(t) = T_0 + \\beta t$ 对催化剂表面随时间进行线性加热，其恒定升温速率为 $\\beta > 0$。考虑一种可以通过两种不同微观机理脱附的双原子产物：（i）预先形成的双原子吸附物的分子脱附，该过程对表面覆盖度是一级的；（ii）两个吸附原子缔合（重组）脱附形成双原子气相分子，该过程对覆盖度是二级的。设表面覆盖度为 $\\theta$，并假设遵循 Polanyi–Wigner 速率定律 $r(T) = \\nu \\theta^{n} \\exp\\!\\big(-E/(k_B T)\\big)$，其中分子脱附时 $n = 1$，缔合脱附时 $n = 2$。此处，$E$ 是活化能（假设其不依赖于 $T$ 和 $\\theta$），$\\nu$ 是一个恒定的尝试频率（指前因子），$k_B$ 是玻尔兹曼常数。覆盖度通过连续性方程 $d\\theta/dt = -r(T)$ 演化。\n\n严格从这些基础出发，并仅使用物理上合理的近似，推导一级和二级反应两种情况下的最大速率（峰值）条件，并获得峰值温度 $T_p$ 的闭式解析表达式。对于二级机理，使用一个由 Arrhenius 因子的强温度依赖性所支持的前沿近似，将峰值处的覆盖度 $\\theta_p$ 与初始覆盖度 $\\theta_0$ 联系起来，并保留 $T_p$ 对 $\\theta_0$ 的主导阶依赖关系。将每个峰值温度以开尔文表示。如果需要使用逆特殊函数来获得闭式解，请使用 Lambert $W$ 函数的主分支。\n\n以行矩阵的形式，用符号 $\\{E, \\nu, \\beta, k_B, \\theta_0\\}$ 给出最终答案，即两个表达式 $T_p^{(1)}$ 和 $T_p^{(2)}$。无需进行数值计算，也无需四舍五入。",
            "solution": "该问题具有科学依据，定义明确，客观，并包含足够的信息以获得唯一解。程序升温脱附（TPD）、Polanyi-Wigner 速率定律以及前沿分析等近似方法的使用，是表面科学和化学动力学领域的标准概念。因此，该问题被认定为有效。\n\n脱附速率 $r$ 由 Polanyi–Wigner 方程给出：\n$$r(t) = \\nu \\theta(t)^n \\exp\\left(-\\frac{E}{k_B T(t)}\\right)$$\n速率是时间 $t$ 的函数，它通过随时间变化的覆盖度 $\\theta(t)$ 和温度 $T(t)$ 来体现。峰值温度 $T_p$ 对应于脱附速率达到最大值时的温度。为找到此最大值，我们将速率对时间的导数设为零：$\\frac{dr}{dt} = 0$。对多变量函数使用链式法则，我们得到：\n$$\\frac{dr}{dt} = \\frac{\\partial r}{\\partial \\theta} \\frac{d\\theta}{dt} + \\frac{\\partial r}{\\partial T} \\frac{dT}{dt} = 0$$\n$r$ 的偏导数是：\n$$\\frac{\\partial r}{\\partial \\theta} = n \\nu \\theta^{n-1} \\exp\\left(-\\frac{E}{k_B T}\\right) = \\frac{n r}{\\theta}$$\n$$\\frac{\\partial r}{\\partial T} = \\nu \\theta^n \\exp\\left(-\\frac{E}{k_B T}\\right) \\left(\\frac{E}{k_B T^2}\\right) = \\frac{E r}{k_B T^2}$$\n根据问题陈述，我们有连续性方程 $\\frac{d\\theta}{dt} = -r$ 和线性升温斜坡 $\\frac{dT}{dt} = \\beta$。将这些表达式代入最大值条件，并在峰值温度 $T_p$ 和相应的峰值覆盖度 $\\theta_p$ 处进行计算：\n$$\\left(\\frac{n r_p}{\\theta_p}\\right)(-r_p) + \\left(\\frac{E r_p}{k_B T_p^2}\\right)(\\beta) = 0$$\n假设峰值速率非零 ($r_p \\neq 0$)，我们可以除以 $r_p$：\n$$-\\frac{n r_p}{\\theta_p} + \\frac{E \\beta}{k_B T_p^2} = 0$$\n代入峰值速率的表达式 $r_p = \\nu \\theta_p^n \\exp\\left(-\\frac{E}{k_B T_p}\\right)$：\n$$\\frac{n}{\\theta_p} \\left[\\nu \\theta_p^n \\exp\\left(-\\frac{E}{k_B T_p}\\right)\\right] = \\frac{E \\beta}{k_B T_p^2}$$\n这简化为一般的峰值条件，通常称为 Redhead 方程：\n$$n \\nu \\theta_p^{n-1} \\exp\\left(-\\frac{E}{k_B T_p}\\right) = \\frac{E \\beta}{k_B T_p^2}$$\n\n情况1：一级脱附 ($n=1$)。\n对于 $n=1$，峰值条件变为：\n$$(1) \\nu \\theta_p^{1-1} \\exp\\left(-\\frac{E}{k_B T_p}\\right) = \\frac{E \\beta}{k_B T_p^2}$$\n$$\\nu \\exp\\left(-\\frac{E}{k_B T_p}\\right) = \\frac{E \\beta}{k_B T_p^2}$$\n这个关于 $T_p$ 的方程与覆盖度无关，这是一级 TPD 峰的一个关键特征。为了解这个关于 $T_p$ 的超越方程，我们对其进行重排：\n$$\\frac{\\nu k_B}{E \\beta} = \\frac{1}{T_p^2} \\exp\\left(\\frac{E}{k_B T_p}\\right)$$\n令 $x = \\frac{E}{k_B T_p}$。这意味着 $T_p = \\frac{E}{k_B x}$。将其代入方程得到：\n$$\\frac{\\nu k_B}{E \\beta} = \\left(\\frac{k_B x}{E}\\right)^2 \\exp(x) = \\frac{k_B^2}{E^2} x^2 \\exp(x)$$\n$$\\frac{\\nu E}{\\beta k_B} = x^2 \\exp(x)$$\n取平方根（因为对于物理参数 $x>0$）：\n$$\\sqrt{\\frac{\\nu E}{\\beta k_B}} = x \\exp\\left(\\frac{x}{2}\\right)$$\n令 $u = \\frac{x}{2}$。则 $x=2u$。方程变为：\n$$\\sqrt{\\frac{\\nu E}{\\beta k_B}} = (2u) \\exp(u) \\implies u \\exp(u) = \\frac{1}{2}\\sqrt{\\frac{\\nu E}{\\beta k_B}}$$\n形如 $u\\exp(u) = C$ 的方程的解由 Lambert $W$ 函数的主分支给出，$u = W(C)$。因此：\n$$u = W\\left(\\frac{1}{2}\\sqrt{\\frac{\\nu E}{\\beta k_B}}\\right)$$\n代回 $u = \\frac{x}{2} = \\frac{E}{2k_B T_p}$：\n$$\\frac{E}{2 k_B T_p^{(1)}} = W\\left(\\frac{1}{2}\\sqrt{\\frac{\\nu E}{\\beta k_B}}\\right)$$\n求解一级峰值温度 $T_p^{(1)}$，得到：\n$$T_p^{(1)} = \\frac{E}{2 k_B W\\left(\\frac{1}{2}\\sqrt{\\frac{\\nu E}{\\beta k_B}}\\right)}$$\n\n情况2：二级脱附 ($n=2$)。\n对于 $n=2$，一般峰值条件是：\n$$2 \\nu \\theta_p \\exp\\left(-\\frac{E}{k_B T_p}\\right) = \\frac{E \\beta}{k_B T_p^2}$$\n该方程依赖于峰值处的覆盖度 $\\theta_p$。我们必须使用指定的近似方法将 $\\theta_p$ 与初始覆盖度 $\\theta_0$ 联系起来。我们从对速率定律积分开始：\n$$\\frac{d\\theta}{dt} = -\\nu \\theta^2 \\exp\\left(-\\frac{E}{k_B T}\\right)$$\n使用 $dt = \\frac{dT}{\\beta}$，我们分离变量并从实验开始时（$T_0, \\theta_0$）到峰值时（$T_p, \\theta_p$）进行积分：\n$$\\int_{\\theta_0}^{\\theta_p} \\frac{d\\theta}{\\theta^2} = -\\frac{\\nu}{\\beta} \\int_{T_0}^{T_p} \\exp\\left(-\\frac{E}{k_B T}\\right) dT$$\n$$\\left[-\\frac{1}{\\theta}\\right]_{\\theta_0}^{\\theta_p} = -\\frac{1}{\\theta_p} + \\frac{1}{\\theta_0} = -\\frac{\\nu}{\\beta} \\int_{T_0}^{T_p} \\exp\\left(-\\frac{E}{k_B T}\\right) dT$$\nArrhenius 因子的强温度依赖性为近似该积分提供了依据（特别是因为 $E \\gg k_B T$ 且在 $T_0$ 时脱附可忽略不计）：\n$$\\int_{T_0}^{T_p} \\exp\\left(-\\frac{E}{k_B T}\\right) dT \\approx \\frac{k_B T_p^2}{E} \\exp\\left(-\\frac{E}{k_B T_p}\\right)$$\n将此近似代回积分后的速率方程：\n$$\\frac{1}{\\theta_0} - \\frac{1}{\\theta_p} \\approx -\\frac{\\nu}{\\beta} \\frac{k_B T_p^2}{E} \\exp\\left(-\\frac{E}{k_B T_p}\\right)$$\n从 $n=2$ 的峰值条件，我们可以写出 $\\exp\\left(-\\frac{E}{k_B T_p}\\right) = \\frac{E\\beta}{2\\nu\\theta_p k_B T_p^2}$。代入此式可得：\n$$\\frac{1}{\\theta_0} - \\frac{1}{\\theta_p} \\approx -\\frac{\\nu k_B T_p^2}{\\beta E} \\left(\\frac{E\\beta}{2\\nu\\theta_p k_B T_p^2}\\right) = -\\frac{1}{2\\theta_p}$$\n重排以求解 $\\theta_p$：\n$$\\frac{1}{\\theta_0} \\approx \\frac{1}{\\theta_p} - \\frac{1}{2\\theta_p} = \\frac{1}{2\\theta_p} \\implies \\theta_p \\approx \\frac{\\theta_0}{2}$$\n这个标准结果表明，对于二级过程，当一半的初始吸附物脱附时，出现峰值最大值。现在，我们将 $\\theta_p = \\frac{\\theta_0}{2}$ 代入 $n=2$ 的峰值条件：\n$$2 \\nu \\left(\\frac{\\theta_0}{2}\\right) \\exp\\left(-\\frac{E}{k_B T_p}\\right) = \\frac{E \\beta}{k_B T_p^2}$$\n$$\\nu \\theta_0 \\exp\\left(-\\frac{E}{k_B T_p}\\right) = \\frac{E \\beta}{k_B T_p^2}$$\n该方程与一级情况具有相同的形式，但有效指前因子为 $\\nu \\theta_0$。遵循与 $n=1$ 情况相同的代数步骤，我们发现：\n$$\\frac{\\nu \\theta_0 E}{\\beta k_B} = x^2 \\exp(x)$$\n其中 $x = \\frac{E}{k_B T_p}$。$x$ 的解为：\n$$x = 2 W\\left(\\frac{1}{2}\\sqrt{\\frac{\\nu \\theta_0 E}{\\beta k_B}}\\right)$$\n代回 $x=\\frac{E}{k_B T_p^{(2)}}$ 并求解二级峰值温度 $T_p^{(2)}$：\n$$T_p^{(2)} = \\frac{E}{2 k_B W\\left(\\frac{1}{2}\\sqrt{\\frac{\\nu \\theta_0 E}{\\beta k_B}}\\right)}$$\n该表达式保留了对初始覆盖度 $\\theta_0$ 的主导阶依赖关系。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{E}{2 k_B W\\left(\\frac{1}{2}\\sqrt{\\frac{\\nu E}{\\beta k_B}}\\right)}  \\frac{E}{2 k_B W\\left(\\frac{1}{2}\\sqrt{\\frac{\\nu \\theta_0 E}{\\beta k_B}}\\right)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然简单的动力学模型可以解析求解，但真实的催化体系通常需要通过求解常微分方程组 (ODEs) 来进行数值模拟。在这一过程中，“刚性” (stiffness) 问题是一个普遍存在的关键挑战，它源于体系中不同基元反应在时间尺度上的巨大差异。本练习将引导你学习如何通过分析动力学系统的雅可比矩阵 (Jacobian matrix) 及其特征值来诊断和应对刚性问题，这对于任何构建和运行微动力学模拟的研究者来说，都是一项至关重要的实践技能 ()。",
            "id": "3879644",
            "problem": "考虑一个混合均匀的等温催化表面，其上只有一种类型的空位，该过程通过Langmuir–Hinshelwood机理进行建模。两种吸附物$A$和$B$竞争性地吸附、解吸，并经历双分子表面反应，生成气相产物$P$。设$\\theta_A$和$\\theta_B$分别表示$A$和$B$在表面上的分数覆盖度，$\\theta_\\star$表示空位的分数。位点平衡为$ \\theta_\\star + \\theta_A + \\theta_B = 1$。气相分压为$p_A$和$p_B$（单位为$\\mathrm{Pa}$）。基元步骤如下：\n- 吸附：$A(\\mathrm{g}) + \\star \\to A\\star$ 和 $B(\\mathrm{g}) + \\star \\to B\\star$。\n- 解吸：$A\\star \\to A(\\mathrm{g}) + \\star$ 和 $B\\star \\to B(\\mathrm{g}) + \\star$。\n- 表面反应：$A\\star + B\\star \\to P(\\mathrm{g}) + 2\\star$。\n\n假设每个基元步骤的广义质量作用速率如下：\n- $A$的吸附：$r_{\\mathrm{ads},A} = k_{\\mathrm{ads},A} \\, p_A \\, \\theta_\\star$。\n- $A$的解吸：$r_{\\mathrm{des},A} = k_{\\mathrm{des},A} \\, \\theta_A$。\n- $B$的吸附：$r_{\\mathrm{ads},B} = k_{\\mathrm{ads},B} \\, p_B \\, \\theta_\\star$。\n- $B$的解吸：$r_{\\mathrm{des},B} = k_{\\mathrm{des},B} \\, \\theta_B$。\n- 表面反应：$r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B$。\n\n这里，$k_{\\mathrm{ads},A}$和$k_{\\mathrm{ads},B}$的单位是$\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$，而$k_{\\mathrm{des},A}$、$k_{\\mathrm{des},B}$和$k_{\\mathrm{rxn}}$的单位是$\\mathrm{s}^{-1}$。覆盖度的控制性常微分方程（ODEs）为\n$$\n\\frac{d\\theta_A}{dt} = r_{\\mathrm{ads},A} - r_{\\mathrm{des},A} - r_{\\mathrm{rxn}}, \\quad\n\\frac{d\\theta_B}{dt} = r_{\\mathrm{ads},B} - r_{\\mathrm{des},B} - r_{\\mathrm{rxn}},\n$$\n其中$\\theta_\\star = 1 - \\theta_A - \\theta_B$。\n\n在给定的状态$(\\theta_A,\\theta_B)$和参数$(p_A,p_B,k_{\\mathrm{ads},A},k_{\\mathrm{des},A},k_{\\mathrm{ads},B},k_{\\mathrm{des},B},k_{\\mathrm{rxn}})$下，构建动力学系统的$2\\times 2$雅可比矩阵$J(\\theta_A,\\theta_B)$，其元素为\n$$\nJ_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}, \\quad \n\\text{其中 } \\mathbf{f}(\\theta_A,\\theta_B) = \\begin{bmatrix} d\\theta_A/dt \\\\ d\\theta_B/dt \\end{bmatrix}。\n$$\n使用$J$的特征值分析来识别刚性，并提出一种高效的数值积分策略。定义刚性比\n$$\n\\kappa = \\frac{\\max\\{|\\lambda_1|,|\\lambda_2|\\}}{\\min\\{|\\lambda_1|,|\\lambda_2|\\}}, \n$$\n其中$\\lambda_1,\\lambda_2$是$J$的特征值，而$|\\cdot|$表示复模。如果最小模小于$10^{-12}$，在计算$\\kappa$时将其视为$10^{-12}$。如果$\\kappa > 100$，则将系统分类为刚性（布尔值输出）。根据以下规则选择方法代码，提出数值策略：\n- $0$表示非刚性区域（推荐使用显式Runge–Kutta方法，如$RK45$），\n- $2$表示中等刚性区域（$100 < \\kappa \\leq 1000$，推荐使用隐式Runge–Kutta方法，如$Radau$），\n- $1$表示非常刚性区域（$\\kappa > 1000$，推荐使用隐式多步法，如$BDF$）。\n\n此外，根据谱半径$\\rho = \\max\\{|\\lambda_1|,|\\lambda_2|\\}$，计算一个保守的显式步长建议（单位为秒），以保证线性稳定性：\n$$\n\\Delta t_{\\mathrm{safe}} = \\frac{\\alpha}{\\rho},\n$$\n其中，如果非刚性（$\\kappa \\leq 100$），则$\\alpha = 0.2$；如果中等刚性（$100 < \\kappa \\leq 1000$），则$\\alpha = 0.05$；如果非常刚性（$\\kappa > 1000$），则$\\alpha = 0.01$。如果$\\rho = 0$，则设置$\\Delta t_{\\mathrm{safe}} = 1.0$。\n\n对下面的每个测试用例，在指定的初始覆盖度下计算雅可比矩阵并执行特征值分析。以$\\mathrm{s}$为单位表示$\\Delta t_{\\mathrm{safe}}$。\n\n测试套件（每个元组对应$(p_A, p_B, k_{\\mathrm{ads},A}, k_{\\mathrm{des},A}, k_{\\mathrm{ads},B}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}, \\theta_A^0, \\theta_B^0)$）：\n1. $(10{,}000, 5{,}000, 1\\times 10^{-4}, 1\\times 10^{-2}, 2\\times 10^{-4}, 5\\times 10^{-3}, 5\\times 10^{-1}, 0.10, 0.10)$\n2. $(20{,}000, 20{,}000, 5\\times 10^{-5}, 1\\times 10^{-2}, 5\\times 10^{-5}, 1\\times 10^{-2}, 1\\times 10^{4}, 0.30, 0.30)$\n3. $(50{,}000, 40{,}000, 1\\times 10^{-4}, 5\\times 10^{-2}, 2\\times 10^{-4}, 1\\times 10^{-2}, 1\\times 10^{-1}, 0.90, 0.09)$\n4. $(100, 100, 1\\times 10^{-5}, 1\\times 10^{-3}, 1\\times 10^{-5}, 1\\times 10^{-3}, 0, 0.01, 0.01)$\n\n对于每个测试用例，您的程序必须按顺序计算并输出以下四个值：刚性比$\\kappa$（浮点数）、刚性分类（布尔值）、推荐的方法代码（整数）以及建议的显式稳定步长$\\Delta t_{\\mathrm{safe}}$（浮点数，单位秒）。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。整体输出列表应为每个测试用例的四个值按顺序串联而成，形成一个长度为$16$的单一扁平列表。",
            "solution": "用户提供的问题陈述经过了严格的验证过程。\n\n### 步骤1：提取已知条件\n- **模型框架**：一个由Langmuir-Hinshelwood机理描述的混合均匀的等温催化表面，涉及两种物质$A$和$B$的竞争性吸附。\n- **状态变量**：分数表面覆盖度$\\theta_A$和$\\theta_B$。\n- **位点平衡约束**：$\\theta_\\star = 1 - \\theta_A - \\theta_B$，其中$\\theta_\\star$是空位的分数。\n- **系统输入**：分压$p_A$和$p_B$，单位为$\\mathrm{Pa}$。\n- **基元步骤和速率定律**：\n    - 吸附($A$)：$r_{\\mathrm{ads},A} = k_{\\mathrm{ads},A} \\, p_A \\, \\theta_\\star$。\n    - 解吸($A$)：$r_{\\mathrm{des},A} = k_{\\mathrm{des},A} \\, \\theta_A$。\n    - 吸附($B$)：$r_{\\mathrm{ads},B} = k_{\\mathrm{ads},B} \\, p_B \\, \\theta_\\star$。\n    - 解吸($B$)：$r_{\\mathrm{des},B} = k_{\\mathrm{des},B} \\, \\theta_B$。\n    - 表面反应($A\\star + B\\star$)：$r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B$。\n- **速率常数**：$k_{\\mathrm{ads},A}, k_{\\mathrm{ads},B}$单位为$\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$；$k_{\\mathrm{des},A}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}$单位为$\\mathrm{s}^{-1}$。\n- **控制ODE**：覆盖度的时间演化由向量函数$\\mathbf{f}(\\theta_A, \\theta_B) = [f_1, f_2]^T$给出，其中：\n    $$f_1 = \\frac{d\\theta_A}{dt} = r_{\\mathrm{ads},A} - r_{\\mathrm{des},A} - r_{\\mathrm{rxn}}$$\n    $$f_2 = \\frac{d\\theta_B}{dt} = r_{\\mathrm{ads},B} - r_{\\mathrm{des},B} - r_{\\mathrm{rxn}}$$\n- **雅可比矩阵**：$J_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}$，其中$i,j \\in \\{1,2\\}$，$\\theta_1=\\theta_A$且$\\theta_2=\\theta_B$。\n- **刚性比($\\kappa$)**：$\\kappa = \\frac{\\max\\{|\\lambda_1|,|\\lambda_2|\\}}{\\min\\{|\\lambda_1|,|\\lambda_2|\\}}$，其中$\\lambda_1, \\lambda_2$是$J$的特征值。如果$\\min\\{|\\lambda_i|\\} < 10^{-12}$，则将其下限设为$10^{-12}$。\n- **刚性分类**：如果$\\kappa > 100$，则系统是刚性的。\n- **数值方法代码**：$0$表示非刚性($\\kappa \\leq 100$)，$2$表示中等刚性($100 < \\kappa \\leq 1000$)，$1$表示非常刚性($\\kappa > 1000$)。\n- **安全步长($\\Delta t_{\\mathrm{safe}}$)**：$\\Delta t_{\\mathrm{safe}} = \\frac{\\alpha}{\\rho}$，其中$\\rho$是$J$的谱半径。对于非刚性、中等刚性或非常刚性的系统，$\\alpha$分别为$0.2$、$0.05$或$0.01$。如果$\\rho = 0$，则$\\Delta t_{\\mathrm{safe}} = 1.0\\,\\mathrm{s}$。\n- **任务**：对于一组测试用例，在给定的初始覆盖度下，计算$\\kappa$、刚性布尔值、方法代码和$\\Delta t_{\\mathrm{safe}}$。\n- **测试套件**：提供了四组参数$(p_A, p_B, k_{\\mathrm{ads},A}, k_{\\mathrm{des},A}, k_{\\mathrm{ads},B}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}, \\theta_A^0, \\theta_B^0)$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于成熟的表面动力学Langmuir-Hinshelwood模型，这是催化领域的一个基本概念。通过雅可比矩阵特征值分析系统刚性是常微分方程(ODEs)数值解的标准严谨方法，尤其是在化学动力学中。该问题在化学和数学上是合理的。\n- **适定性**：该问题是完全指定的。所有必要的常数、初始条件和函数形式都已提供。关于刚性、方法代码和步长的定义是明确的，可以为每个测试用例计算出唯一的解。\n- **客观性**：问题陈述使用了精确、客观的数学语言。分类标准是定量的，没有主观解释的余地。\n- **结论**：该问题不违反任何无效标准。它具有科学依据、适定性、客观性和完整性。\n\n### 步骤3：判定与行动\n该问题被判定为**有效**。将提供一个解决方案。\n\n### 基于原理的解决方案\n该解决方案需要在状态空间中的特定点$(\\theta_A, \\theta_B)$处，分析给定ODE系统的局部稳定性和刚性。此分析使用系统的雅可比矩阵进行。\n\n**1. ODE系统的构建**\n\n首先，我们通过将位点平衡方程$\\theta_\\star = 1 - \\theta_A - \\theta_B$代入速率定律，明确地用状态变量$\\theta_A$和$\\theta_B$表示覆盖度的变化率$f_1 = d\\theta_A/dt$和$f_2 = d\\theta_B/dt$：\n$$\nf_1(\\theta_A, \\theta_B) = k_{\\mathrm{ads},A} \\, p_A \\, (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\, \\theta_A - k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B\n$$\n$$\nf_2(\\theta_A, \\theta_B) = k_{\\mathrm{ads},B} \\, p_B \\, (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\, \\theta_B - k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B\n$$\n\n**2. 雅可比矩阵的推导**\n\n雅可比矩阵$J$将系统动力学在点$(\\theta_A, \\theta_B)$附近线性化。其元素$J_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}$，表征了一个覆盖度的微小扰动如何影响另一个覆盖度的变化率。自变量为$\\theta_1 \\equiv \\theta_A$和$\\theta_2 \\equiv \\theta_B$。\n\n四个偏导数的计算如下：\n- **$J_{11} = \\frac{\\partial f_1}{\\partial \\theta_A}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_A} \\left( k_{\\mathrm{ads},A} p_A (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\theta_A - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{des},A} - k_{\\mathrm{rxn}} \\theta_B\n  $$\n- **$J_{12} = \\frac{\\partial f_1}{\\partial \\theta_B}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_B} \\left( k_{\\mathrm{ads},A} p_A (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\theta_A - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{rxn}} \\theta_A\n  $$\n- **$J_{21} = \\frac{\\partial f_2}{\\partial \\theta_A}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_A} \\left( k_{\\mathrm{ads},B} p_B (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\theta_B - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{rxn}} \\theta_B\n  $$\n- **$J_{22} = \\frac{\\partial f_2}{\\partial \\theta_B}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_B} \\left( k_{\\mathrm{ads},B} p_B (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\theta_B - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{des},B} - k_{\\mathrm{rxn}} \\theta_A\n  $$\n因此，雅可比矩阵为：\n$$\nJ(\\theta_A, \\theta_B) = \\begin{bmatrix}\n-k_{\\mathrm{ads},A} p_A - k_{\\mathrm{des},A} - k_{\\mathrm{rxn}} \\theta_B   -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{rxn}} \\theta_A \\\\\n-k_{\\mathrm{ads},B} p_B - k_{\\mathrm{rxn}} \\theta_B   -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{des},B} - k_{\\mathrm{rxn}} \\theta_A\n\\end{bmatrix}\n$$\n\n**3. 特征值分析与刚性表征**\n\n雅可比矩阵的特征值$\\lambda$决定了系统对扰动响应的特征时间尺度。对于一个稳定系统，特征值的实部为负，其大小$|\\mathrm{Re}(\\lambda)|$是弛豫时间尺度的倒数。\n\n- **刚性**：如果一个系统的特征时间尺度相差悬殊，则该系统在数值上是刚性的。这通过刚性比$\\kappa$来量化，定义为最大与最小特征值模之比。\n  $$\n  \\kappa = \\frac{\\max\\{|\\lambda_1|, |\\lambda_2|\\}}{\\min\\{|\\lambda_1|, |\\lambda_2|\\}}\n  $$\n  大的$\\kappa$表示刚性，意味着显式数值积分器将被最快的过程（最大的$|\\lambda|$）迫使采取极小的时间步长，来解决最慢过程（最小的$|\\lambda|$）时间尺度上的系统，从而导致效率低下。\n- **数值策略**：ODE求解器的选择取决于此刚性分类。非刚性问题可以用显式方法（如Runge-Kutta 45）高效求解，而刚性问题需要隐式方法（如BDF、Radau）以在合理的步长下保持稳定性。\n- **显式步长限制**：对于显式方法，时间步长$\\Delta t$受到方法稳定域的限制，该稳定域与谱半径$\\rho = \\max\\{|\\lambda_i|\\}$成反比。问题提供了一个保守的“安全”步长公式，$\\Delta t_{\\mathrm{safe}} = \\alpha / \\rho$，其中$\\alpha$是一个安全系数，随着刚性的增加而减小。\n\n**4. 计算算法**\n\n对每个测试用例，执行以下步骤：\n1.  将给定的参数$(p_A, p_B, k_{\\dots}, \\theta_A^0, \\theta_B^0)$代入雅可比矩阵元素$J_{11}, J_{12}, J_{21}, J_{22}$的推导表达式中。\n2.  构建$2 \\times 2$的数值雅可比矩阵。\n3.  计算其两个特征值$\\lambda_1$和$\\lambda_2$。\n4.  计算特征值的复模$|\\lambda_1|$和$|\\lambda_2|$。\n5.  确定$\\lambda_{\\max} = \\max\\{|\\lambda_1|, |\\lambda_2|\\}$和$\\lambda_{\\min} = \\min\\{|\\lambda_1|, |\\lambda_2|\\}$。\n6.  计算刚性比$\\kappa = \\lambda_{\\max} / \\max(\\lambda_{\\min}, 10^{-12})$。\n7.  根据$\\kappa$的值对系统进行分类并确定方法代码。\n8.  根据分类确定因子$\\alpha$。\n9.  计算安全步长$\\Delta t_{\\mathrm{safe}} = \\alpha / \\lambda_{\\max}$（使用$\\rho = \\lambda_{\\max}$），处理$\\rho=0$的情况。\n10. 整理四个结果值：$\\kappa$（浮点数）、刚性（布尔值）、方法代码（整数）和$\\Delta t_{\\mathrm{safe}}$（浮点数）。\n\n该过程在提供的Python代码中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stiffness of a surface reaction kinetic system for several test cases.\n    For each case, it computes the Jacobian matrix, its eigenvalues, the stiffness ratio,\n    a stiffness classification, a recommended numerical method, and a safe explicit step size.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (p_A, p_B, k_ads_A, k_des_A, k_ads_B, k_des_B, k_rxn, theta_A_initial, theta_B_initial)\n    test_cases = [\n        (10000.0, 5000.0, 1.0e-4, 1.0e-2, 2.0e-4, 5.0e-3, 5.0e-1, 0.10, 0.10),\n        (20000.0, 20000.0, 5.0e-5, 1.0e-2, 5.0e-5, 1.0e-2, 1.0e4, 0.30, 0.30),\n        (50000.0, 40000.0, 1.0e-4, 5.0e-2, 2.0e-4, 1.0e-2, 1.0e-1, 0.90, 0.09),\n        (100.0, 100.0, 1.0e-5, 1.0e-3, 1.0e-5, 1.0e-3, 0.0, 0.01, 0.01)\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        p_A, p_B, k_ads_A, k_des_A, k_ads_B, k_des_B, k_rxn, theta_A, theta_B = case\n\n        # Construct the Jacobian matrix J(theta_A, theta_B) based on the derived analytical expressions.\n        # J_ij = d(f_i)/d(theta_j), where f = [d(theta_A)/dt, d(theta_B)/dt]\n        J11 = -k_ads_A * p_A - k_des_A - k_rxn * theta_B\n        J12 = -k_ads_A * p_A - k_rxn * theta_A\n        J21 = -k_ads_B * p_B - k_rxn * theta_B\n        J22 = -k_ads_B * p_B - k_des_B - k_rxn * theta_A\n        \n        J = np.array([[J11, J12], [J21, J22]])\n        \n        # Compute the eigenvalues of the Jacobian matrix.\n        eigenvalues = np.linalg.eigvals(J)\n        \n        # Calculate the moduli (absolute values) of the eigenvalues.\n        lambda_moduli = np.abs(eigenvalues)\n        \n        # Get the maximum and minimum modulus.\n        lambda_max_mod = np.max(lambda_moduli)\n        lambda_min_mod = np.min(lambda_moduli)\n        \n        # Calculate the stiffness ratio kappa.\n        # Apply the floor of 1e-12 to the minimum modulus as per the problem statement.\n        kappa_denominator = max(lambda_min_mod, 1e-12)\n        kappa = lambda_max_mod / kappa_denominator\n        \n        # Determine stiffness classification and recommend the numerical method code.\n        is_stiff = kappa > 100.0\n        \n        if kappa <= 100.0:\n            # Non-stiff regime\n            method_code = 0\n            alpha = 0.2\n        elif kappa <= 1000.0:\n            # Moderately stiff regime\n            method_code = 2\n            alpha = 0.05\n        else:  # kappa > 1000.0\n            # Very stiff regime\n            method_code = 1\n            alpha = 0.01\n            \n        # Calculate the conservative explicit step size suggestion.\n        # Spectral radius rho is the maximum eigenvalue modulus.\n        rho = lambda_max_mod\n        \n        # Handle the special case where the spectral radius is zero.\n        if rho == 0.0:\n            delta_t_safe = 1.0\n        else:\n            delta_t_safe = alpha / rho\n            \n        # Append the four computed values for this test case to the results list.\n        all_results.extend([kappa, is_stiff, method_code, delta_t_safe])\n        \n    # Print the final flattened list of results in the required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}