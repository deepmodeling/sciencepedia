{
    "hands_on_practices": [
        {
            "introduction": "任何机器学习原子间势（MLIP）的第一步都是将原子结构转化为机器学习模型可以理解的数学表示。Behler-Parrinello对称函数是实现这一目标的一种开创性方法，它能以一种满足旋转、平移和置换不变性的方式捕捉每个原子的局部化学环境。通过对一个理想化的晶体结构进行计算 ，本练习将帮助您具体理解这些抽象的描述符是如何从原子坐标中构建出来的。",
            "id": "90953",
            "problem": "在机器学习原子间势领域，Behler-Parrinello 对称函数是创建稳健且精确的原子相互作用模型的基石。这些函数以一种对旋转、平移和同类原子的置换保持不变的方式，描述了原子的局域化学环境。\n\n一种常见的径向对称函数，记为 $G^i(\\eta, R_s)$，量化了中心原子 $i$ 周围邻近原子 $j$ 的径向分布。其定义如下：\n$$\nG^i(\\eta, R_s) = \\sum_{j \\neq i} e^{-\\eta (R_{ij} - R_s)^2} f_c(R_{ij})\n$$\n此处，$R_{ij}$ 是原子 $i$ 和 $j$ 之间的距离。参数 $\\eta$ 控制高斯函数的宽度，而 $R_s$ 定义了高斯函数中心的径向距离。求和项遍及截断半径 $R_c$ 内的所有邻原子 $j$。该截断由截断函数 $f_c(R_{ij})$ 实现，它使得每个邻原子的贡献在其距离接近 $R_c$ 时平滑地变为零。$f_c(R_{ij})$ 的一个常用形式是余弦截断函数：\n$$\nf_c(R_{ij}) = \\begin{cases}\n\\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi R_{ij}}{R_c}\\right) + 1 \\right)  \\text{if } R_{ij} \\le R_c \\\\\n0  \\text{if } R_{ij} > R_c\n\\end{cases}\n$$\n\n考虑一个排列成理想简单立方（SC）晶格的元素中的单个原子，其晶格常数为 $a$。对于位于该晶格原点的原子，推导径向对称函数 $G^i(\\eta, R_s)$ 值的解析表达式。使用截断半径 $R_c = \\frac{7}{4}a$。您的最终表达式应以晶格常数 $a$ 和对称函数参数 $\\eta$、$R_s$ 表示。",
            "solution": "1. **识别相关原子**\n首先，我们需要确定在截断半径 $R_c = \\frac{7}{4}a = 1.75a$ 内有哪些邻居原子。在一个晶格常数为 $a$ 的简单立方（SC）晶格中，相对于位于原点的中心原子 $i$，其邻居原子位于 $(n_x, n_y, n_z)a$ 的位置，其中 $(n_x, n_y, n_z)$ 是不全为零的整数三元组。原子与原点之间的距离为 $R = a\\sqrt{n_x^2 + n_y^2 + n_z^2}$。我们需要找到所有满足 $R \\le R_c$ 的邻居壳层。\n\n-   **第一近邻**：坐标形如 $(\\pm 1, 0, 0)$ 及其置换，共有6个原子。距离为 $R_1 = a\\sqrt{1^2+0+0} = a$。由于 $a  1.75a$，这些原子在截断半径内。\n-   **第二近邻**：坐标形如 $(\\pm 1, \\pm 1, 0)$ 及其置换，共有12个原子。距离为 $R_2 = a\\sqrt{1^2+1^2+0} = a\\sqrt{2} \\approx 1.414a$。由于 $1.414a  1.75a$，这些原子在截断半径内。\n-   **第三近邻**：坐标形如 $(\\pm 1, \\pm 1, \\pm 1)$，共有8个原子。距离为 $R_3 = a\\sqrt{1^2+1^2+1^2} = a\\sqrt{3} \\approx 1.732a$。由于 $1.732a  1.75a$，这些原子也在截断半径内。\n-   **第四近邻**：坐标形如 $(\\pm 2, 0, 0)$ 及其置换，距离为 $R_4 = a\\sqrt{2^2+0+0} = 2a$。由于 $2a > 1.75a$，这些原子以及所有更远的原子都在截断半径之外。\n\n因此，只有前三个邻居壳层对对称函数有贡献。\n\n2. **计算每个壳层的贡献**\n径向对称函数的定义为 $G^i(\\eta, R_s) = \\sum_{j \\neq i} e^{-\\eta (R_{ij} - R_s)^2} f_c(R_{ij})$。我们将对每个壳层分别计算其贡献，然后相加。\n\n-   **第一壳层贡献 ($R_1 = a$)**:\n    有 6 个原子，每个的贡献为 $e^{-\\eta(a-R_s)^2}f_c(a)$。\n    $f_c(a) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi a}{R_c}\\right) + 1 \\right) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi a}{\\frac{7}{4}a}\\right) + 1 \\right) = \\frac{1}{2} \\left( \\cos\\left(\\frac{4\\pi}{7}\\right) + 1 \\right)$。\n    总贡献为 $6 \\times e^{-\\eta(a-R_s)^2} \\times \\frac{1}{2} \\left( \\cos(\\frac{4\\pi}{7}) + 1 \\right)$。\n\n-   **第二壳层贡献 ($R_2 = a\\sqrt{2}$)**:\n    有 12 个原子，每个的贡献为 $e^{-\\eta(a\\sqrt{2}-R_s)^2}f_c(a\\sqrt{2})$。\n    $f_c(a\\sqrt{2}) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi a\\sqrt{2}}{R_c}\\right) + 1 \\right) = \\frac{1}{2} \\left( \\cos\\left(\\frac{4\\pi\\sqrt{2}}{7}\\right) + 1 \\right)$。\n    总贡献为 $12 \\times e^{-\\eta(a\\sqrt{2}-R_s)^2} \\times \\frac{1}{2} \\left( \\cos(\\frac{4\\pi\\sqrt{2}}{7}) + 1 \\right)$。\n\n-   **第三壳层贡献 ($R_3 = a\\sqrt{3}$)**:\n    有 8 个原子，每个的贡献为 $e^{-\\eta(a\\sqrt{3}-R_s)^2}f_c(a\\sqrt{3})$。\n    $f_c(a\\sqrt{3}) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi a\\sqrt{3}}{R_c}\\right) + 1 \\right) = \\frac{1}{2} \\left( \\cos\\left(\\frac{4\\pi\\sqrt{3}}{7}\\right) + 1 \\right)$。\n    总贡献为 $8 \\times e^{-\\eta(a\\sqrt{3}-R_s)^2} \\times \\frac{1}{2} \\left( \\cos(\\frac{4- \\pi\\sqrt{3}}{7}) + 1 \\right)$。\n\n3. **求和得到最终表达式**\n将所有壳层的贡献相加，得到最终的表达式：\n$$\nG^i = 3\\,e^{-\\eta(a-R_s)^2}\\left(\\cos\\left(\\frac{4\\pi}{7}\\right)+1\\right) + 6\\,e^{-\\eta(a\\sqrt{2}-R_s)^2}\\left(\\cos\\left(\\frac{4\\pi\\sqrt{2}}{7}\\right)+1\\right) + 4\\,e^{-\\eta(a\\sqrt{3}-R_s)^2}\\left(\\cos\\left(\\frac{4\\pi\\sqrt{3}}{7}\\right)+1\\right)\n$$",
            "answer": "$$\\boxed{G^i(\\eta,R_s) = 3e^{-\\eta(a-R_s)^2}\\left(\\cos\\frac{4\\pi}{7}+1\\right) + 6e^{-\\eta(a\\sqrt{2}-R_s)^2}\\left(\\cos\\frac{4\\pi\\sqrt{2}}{7}+1\\right) + 4e^{-\\eta(a\\sqrt{3}-R_s)^2}\\left(\\cos\\frac{4\\pi\\sqrt{3}}{7}+1\\right)}$$"
        },
        {
            "introduction": "MLIP的核心目标是准确预测系统的势能，从而构建势能面（PES）。一旦我们知道了能量如何随原子位置变化，就可以通过计算能量对原子坐标的负梯度来获得作用在每个原子上的力。本练习  将通过一个简单的原子系统，让您亲手实践从一个给定的势能函数计算总能量和原子间作用力的过程，从而阐明力与势能之间的基本关系 $F = -\\nabla E$。",
            "id": "3822117",
            "problem": "考虑一个用于说明简单机器学习原子间势 (MLIP) 的一维三原子构型。每个原子的能量定义为\n$$\\varepsilon(\\mathcal{N}_i)=\\sum_{j\\in \\mathcal{N}_i} a \\exp(-b r_{ij}),$$\n其中 $r_{ij}$ 是原子 $i$ 和 $j$ 之间的欧几里得距离，$a$ 和 $b$ 是正常数，$\\mathcal{N}_i$ 是原子 $i$ 的邻居集合，包含所有其他原子。系统的总能量是所有原子的原子能量之和。原子 $k$ 上的经典力定义为 $\\mathbf{F}_k=-\\nabla_{\\mathbf{R}_k} E_{\\mathrm{tot}}$，其中 $\\mathbf{R}_k$ 是原子 $k$ 的位置，$E_{\\mathrm{tot}}$ 是总能量。\n\n取三个沿 $x$ 轴共线排列的原子，其位置分别为 $x_1=0\\,\\mathrm{\\AA}$、$x_2=2.0\\,\\mathrm{\\AA}$ 和 $x_3=3.5\\,\\mathrm{\\AA}$。使用参数 $a=0.25\\,\\mathrm{eV}$ 和 $b=1.0\\,\\mathrm{\\AA}^{-1}$。假设 $\\mathcal{N}_i=\\{j\\neq i\\}$（即所有其他原子都是邻居），并忽略任何边界条件。\n\n计算总能量 $E_{\\mathrm{tot}}$ 和每个原子在 $x$ 方向上的力 $F_{1x}$、$F_{2x}$ 和 $F_{3x}$。最终能量以电子伏特 (eV) 表示，力以电子伏特每埃 ($\\mathrm{eV}/\\mathrm{\\AA}$) 表示。将最终数值四舍五入到四位有效数字。",
            "solution": "系统的总能量 $E_{\\mathrm{tot}}$ 是各个原子能量 $\\varepsilon_i$ 的总和。根据题意，每个原子的能量是其与所有其他原子相互作用的能量之和，因此总能量可以表示为所有原子对相互作用能量之和的两倍（因为每对相互作用在计算两个原子的原子能量时都被计算了一次）：\n$$E_{\\mathrm{tot}} = \\sum_{i} \\varepsilon_i = \\sum_{i} \\sum_{j \\neq i} a e^{-b r_{ij}} = 2a \\left( e^{-b r_{12}} + e^{-b r_{13}} + e^{-b r_{23}} \\right)$$\n\n1.  **计算原子间距离**:\n    根据原子坐标 $x_1=0\\,\\mathrm{\\AA}$，$x_2=2.0\\,\\mathrm{\\AA}$ 和 $x_3=3.5\\,\\mathrm{\\AA}$：\n    $r_{12} = |x_2 - x_1| = 2.0\\,\\mathrm{\\AA}$\n    $r_{13} = |x_3 - x_1| = 3.5\\,\\mathrm{\\AA}$\n    $r_{23} = |x_3 - x_2| = 1.5\\,\\mathrm{\\AA}$\n\n2.  **计算总能量**:\n    代入参数 $a=0.25\\,\\mathrm{eV}$ 和 $b=1.0\\,\\mathrm{\\AA}^{-1}$：\n    $$E_{\\mathrm{tot}} = 2(0.25) \\left( e^{-1.0 \\times 2.0} + e^{-1.0 \\times 3.5} + e^{-1.0 \\times 1.5} \\right)$$\n    $$E_{\\mathrm{tot}} = 0.5 \\left( e^{-2.0} + e^{-3.5} + e^{-1.5} \\right)$$\n    $$E_{\\mathrm{tot}} \\approx 0.5 (0.135335 + 0.030197 + 0.223130) \\approx 0.194331\\,\\mathrm{eV}$$\n    四舍五入到四位有效数字，得到 $E_{\\mathrm{tot}} \\approx 0.1943\\,\\mathrm{eV}$。\n\n3.  **计算力**:\n    原子 $k$ 在 $x$ 方向上的力 $F_{kx}$ 是总能量对该原子坐标 $x_k$ 的负偏导数：$F_{kx} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_k}$。\n    \n    -   对原子1的力 $F_{1x}$:\n        $$F_{1x} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_1} = -2a \\left[ \\frac{\\partial}{\\partial x_1}e^{-b|x_2-x_1|} + \\frac{\\partial}{\\partial x_1}e^{-b|x_3-x_1|} \\right]$$\n        利用 $\\frac{d}{dx}|u(x)| = \\text{sgn}(u(x)) \\frac{du}{dx}$ 和链式法则，我们得到：\n        $$F_{1x} = -2a \\left[ -b e^{-b r_{12}} (-1)\\text{sgn}(x_2-x_1) - b e^{-b r_{13}} (-1)\\text{sgn}(x_3-x_1) \\right]$$\n        $$F_{1x} = -2ab \\left[ e^{-b r_{12}}\\text{sgn}(x_2-x_1) + e^{-b r_{13}}\\text{sgn}(x_3-x_1) \\right]$$\n        由于 $x_2 > x_1$ 且 $x_3 > x_1$，$\\text{sgn}(x_2-x_1)=1$ 且 $\\text{sgn}(x_3-x_1)=1$。\n        $$F_{1x} = -2(0.25)(1.0) \\left( e^{-2.0} + e^{-3.5} \\right) \\approx -0.5 (0.135335 + 0.030197) \\approx -0.08277\\,\\mathrm{eV}/\\mathrm{\\AA}$$\n\n    -   对原子3的力 $F_{3x}$:\n        $$F_{3x} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_3} = -2a \\left[ \\frac{\\partial}{\\partial x_3}e^{-b|x_3-x_1|} + \\frac{\\partial}{\\partial x_3}e^{-b|x_3-x_2|} \\right]$$\n        $$F_{3x} = -2a \\left[ -b e^{-b r_{13}} (1)\\text{sgn}(x_3-x_1) - b e^{-b r_{23}} (1)\\text{sgn}(x_3-x_2) \\right]$$\n        $$F_{3x} = 2ab \\left[ e^{-b r_{13}}\\text{sgn}(x_3-x_1) + e^{-b r_{23}}\\text{sgn}(x_3-x_2) \\right]$$\n        由于 $x_3 > x_1$ 且 $x_3 > x_2$，$\\text{sgn}(x_3-x_1)=1$ 且 $\\text{sgn}(x_3-x_2)=1$。\n        $$F_{3x} = 2(0.25)(1.0) \\left( e^{-3.5} + e^{-1.5} \\right) \\approx 0.5 (0.030197 + 0.223130) \\approx 0.1267\\,\\mathrm{eV}/\\mathrm{\\AA}$$\n\n    -   对原子2的力 $F_{2x}$:\n        $$F_{2x} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_2} = -2a \\left[ \\frac{\\partial}{\\partial x_2}e^{-b|x_2-x_1|} + \\frac{\\partial}{\\partial x_2}e^{-b|x_3-x_2|} \\right]$$\n        $$F_{2x} = -2a \\left[ -b e^{-b r_{12}} (1)\\text{sgn}(x_2-x_1) - b e^{-b r_{23}} (-1)\\text{sgn}(x_3-x_2) \\right]$$\n        $$F_{2x} = -2ab \\left[ -e^{-b r_{12}}\\text{sgn}(x_2-x_1) + e^{-b r_{23}}\\text{sgn}(x_3-x_2) \\right]$$\n        由于 $x_2 > x_1$ 且 $x_3 > x_2$，$\\text{sgn}(x_2-x_1)=1$ 且 $\\text{sgn}(x_3-x_2)=1$。\n        $$F_{2x} = -0.5 \\left( -e^{-2.0} + e^{-1.5} \\right) \\approx -0.5(-0.135335 + 0.223130) \\approx -0.04390\\,\\mathrm{eV}/\\mathrm{\\AA}$$\n\n    所有力都四舍五入到四位有效数字。",
            "answer": "$$ \\boxed{E_{\\mathrm{tot}} = 0.1943\\,\\mathrm{eV}, \\quad F_{1x} = -0.08277\\,\\mathrm{eV}/\\mathrm{\\AA}, \\quad F_{2x} = -0.04390\\,\\mathrm{eV}/\\mathrm{\\AA}, \\quad F_{3x} = 0.1267\\,\\mathrm{eV}/\\mathrm{\\AA}} $$"
        },
        {
            "introduction": "物理定律对于我们分配给相同类型原子的任意标签是无感的，这意味着交换两个相同原子的标签不应改变系统的总能量。MLIPs 必须严格遵守这种置换不变性。本练习  通过构建一个故意违反此对称性的“坏”模型，并与一个正确的模型进行对比，来量化由此产生的物理谬误。这个实践清晰地揭示了为何在 MLIPs 的设计中强制执行基本物理对称性是至关重要的。",
            "id": "3886545",
            "problem": "要求您在计算催化和化学工程领域，形式化并量化机器学习（ML）原子间势中违反相同原子置换不变性的后果。目标是构建一个场景，其中依赖于索引的特征导致人为的能量分裂，并根据一个有物理基础的参考来量化由此产生的预测误差。从一个有物理动机的、置换不变的参考能量出发，并用它来分析一个故意设计的置换可变的代理模型。您的程序必须生成一行输出，其中包含一组测试构型的聚合数值结果，以无量纲的约化单位表示，并四舍五入到八位小数。\n\n基本原理：\n- 在经典力学和量子力学中，相同的原子是不可区分的；总能量必须在原子标签的任何置换下保持不变。形式上，如果有 $N$ 个相同的原子，并且一个构型由成对距离的集合 $\\{r_{ij}\\}$ 描述，那么对称群 $S_N$ 中的任何索引置换 $\\pi$ 都必须满足 $E(\\{r_{ij}\\}) = E(\\{r_{\\pi(i)\\pi(j)}\\})$。\n- 一个用于非键相互作用的、经过充分测试的标准成对能量函数是 Lennard-Jones (LJ) 势。在特征能量和长度尺度均设为 1 的约化单位中，构型的总能量计算如下\n$$\nE_{\\text{LJ}}(\\mathbf{R}) = \\sum_{1 \\leq i  j \\leq N} 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma}{r_{ij}}\\right)^6\\right],\n$$\n其中 $r_{ij} = \\|\\mathbf{r}_i - \\mathbf{r}_j\\|$，$ \\varepsilon $ 和 $ \\sigma $ 分别是能量和长度尺度，并且对无序对的求和确保了置换不变性。使用约化单位，其中 $\\varepsilon = 1$ 和 $\\sigma = 1$，因此能量和距离是无量纲的。\n\n依赖索引的代理模型：\n- 定义依赖于局部距离的每个原子的描述符，\n$$\nd_i = \\sum_{\\substack{j=1 \\\\ j \\neq i}}^{N} \\exp\\left(-\\frac{r_{ij}}{\\sigma}\\right), \\quad e_i = \\sum_{\\substack{j=1 \\\\ j \\neq i}}^{N} \\frac{r_{ij}}{\\sigma}.\n$$\n- 通过使用依赖于索引的权重，构建一个故意设计的置换可变的代理能量，\n$$\nE_{\\text{bad}}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) = \\sum_{i=1}^{N} \\left[a_i \\, d_i + b_i \\, e_i\\right],\n$$\n其中 $\\mathbf{a} = (a_1, \\dots, a_N)$ 和 $\\mathbf{b} = (b_1, \\dots, b_N)$ 依赖于原子索引。在标签的置换 $\\pi \\in S_N$ 下，预测的能量变为\n$$\nE_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) = \\sum_{i=1}^{N} \\left[a_{\\pi(i)} \\, d_i + b_{\\pi(i)} \\, e_i\\right],\n$$\n如果 $d_i$ 和 $e_i$ 不全相等，这对于相同的原子可能会有所不同。\n- 为了比较，构建一个具有共享权重的置换不变的代理模型，\n$$\nE_{\\text{good}}(\\mathbf{R}; a, b) = \\sum_{i=1}^{N} \\left[a \\, d_i + b \\, e_i\\right].\n$$\n\n每个测试案例需要计算的量：\n- 在一组标签置换 $\\mathcal{P}$ 上的人为能量分裂幅度，\n$$\n\\Delta_{\\text{split}} = \\max_{\\pi \\in \\mathcal{P}} E_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) - \\min_{\\pi \\in \\mathcal{P}} E_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}).\n$$\n- 相对于 LJ 能量，依赖索引的模型在 $\\mathcal{P}$ 上的最大绝对预测误差，\n$$\n\\text{Err}_{\\text{bad,max}} = \\max_{\\pi \\in \\mathcal{P}} \\left|E_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) - E_{\\text{LJ}}(\\mathbf{R})\\right|.\n$$\n- 置换不变代理模型（共享权重）的绝对预测误差，\n$$\n\\text{Err}_{\\text{good}} = \\left|E_{\\text{good}}(\\mathbf{R}; a, b) - E_{\\text{LJ}}(\\mathbf{R})\\right|.\n$$\n\n角度单位无关紧要，因为只使用距离。所有能量和距离都必须以无量纲的约化单位表示，其中 $\\varepsilon = 1$ 和 $\\sigma = 1$。将所有输出四舍五入到八位小数。\n\n测试套件：\n- 使用以下四个构型案例。坐标以三维空间中的笛卡尔坐标给出，单位为约化单位。使用 $\\varepsilon = 1$ 和 $\\sigma = 1$。对于每个案例，应用由单位置换和反向索引置换组成的置换集 $\\mathcal{P}$。共享权重为 $a = 0.9$，$b = -0.15$。\n\n案例 $1$（非对称线性三原子，理想路径）：\n- $N = 3$,\n- 位置：$\\left(0.0, 0.0, 0.0\\right)$, $\\left(1.2, 0.0, 0.0\\right)$, $\\left(2.5, 0.0, 0.0\\right)$,\n- 依赖索引的权重：$\\mathbf{a} = (0.8, 1.4, 0.5)$, $\\mathbf{b} = (-0.3, 0.2, 0.1)$.\n\n案例 $2$（等边三角形，对称边界条件）：\n- $N = 3$,\n- 边长：$L = 1.6$,\n- 位置：$\\left(0.0, 0.0, 0.0\\right)$, $\\left(L, 0.0, 0.0\\right)$, $\\left(\\frac{L}{2}, \\frac{\\sqrt{3}}{2} L, 0.0\\right)$,\n- 依赖索引的权重：$\\mathbf{a} = (0.8, 1.4, 0.5)$, $\\mathbf{b} = (-0.3, 0.2, 0.1)$.\n\n案例 $3$（双原子对，边界情况）：\n- $N = 2$,\n- 位置：$\\left(0.0, 0.0, 0.0\\right)$, $\\left(1.1, 0.0, 0.0\\right)$,\n- 依赖索引的权重：$\\mathbf{a} = (1.2, 0.7)$, $\\mathbf{b} = (-0.25, 0.05)$.\n\n案例 $4$（非对称矩形布局中的四个原子）：\n- $N = 4$,\n- 位置：$\\left(0.0, 0.0, 0.0\\right)$, $\\left(1.4, 0.0, 0.0\\right)$, $\\left(0.0, 2.2, 0.0\\right)$, $\\left(2.1, 2.3, 0.0\\right)$,\n- 依赖索引的权重：$\\mathbf{a} = (0.7, 1.1, 0.6, 1.5)$, $\\mathbf{b} = (-0.2, 0.25, -0.05, 0.3)$.\n\n要求的最终输出格式：\n- 对于每个案例，计算三元组 $\\left[\\Delta_{\\text{split}}, \\text{Err}_{\\text{bad,max}}, \\text{Err}_{\\text{good}}\\right]$ 作为浮点数。您的程序应生成单行输出，其中包含这些按案例排列的三元组列表，四舍五入到八位小数，格式为以逗号分隔的 Python 风格列表，并用方括号括起来，例如 $\\left[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots\\right]$。",
            "solution": "此问题的核心是量化一个机器学习模型因未能遵循置换不变性（即相同原子不可区分的物理原理）而引入的误差。解决方案遵循以下步骤，对每个测试案例进行计算：\n\n1.  **计算参考能量 $E_{\\text{LJ}}$**：\n    首先，根据给定的原子坐标计算所有原子对之间的距离 $r_{ij}$。然后，使用这些距离计算物理上正确的 Lennard-Jones (LJ) 能量作为基准。在约化单位 ($\\varepsilon = 1, \\sigma = 1$) 下，公式为：\n    $$E_{\\text{LJ}} = \\sum_{1 \\leq i  j \\leq N} 4 \\left(r_{ij}^{-12} - r_{ij}^{-6}\\right)$$\n\n2.  **计算原子描述符**:\n    对于每个原子 $i$，根据其周围的原子几何环境，计算描述符 $d_i$ 和 $e_i$：\n    $$d_i = \\sum_{j \\neq i} \\exp(-r_{ij})$$\n    $$e_i = \\sum_{j \\neq i} r_{ij}$$\n\n3.  **计算置换不变模型 $E_{\\text{good}}$ 及其误差**:\n    使用共享权重 ($a=0.9, b=-0.15$) 计算置换不变的代理模型能量 $E_{\\text{good}}$：\n    $$E_{\\text{good}} = \\sum_{i=1}^{N} (a \\, d_i + b \\, e_i)$$\n    其相对于 LJ 参考能量的绝对误差为 $\\text{Err}_{\\text{good}} = |E_{\\text{good}} - E_{\\text{LJ}}|$。\n\n4.  **计算违反置换不变性的模型 $E_{\\text{bad}}$ 并量化其效应**:\n    使用依赖于原子索引的权重 $\\mathbf{a}$ 和 $\\mathbf{b}$ 来计算“坏”模型的能量。我们考虑两种标签排列方式：\n    -   **单位置换 ($\\pi_{id}$)**: 原子标签与其索引一致。能量为 $E_{\\text{bad}}^{(\\pi_{id})} = \\sum_{i=1}^{N} (a_i d_i + b_i e_i)$。\n    -   **反向置换 ($\\pi_{rev}$)**: 原子标签与索引顺序相反。能量为 $E_{\\text{bad}}^{(\\pi_{rev})} = \\sum_{i=1}^{N} (a_{\\pi_{rev}(i)} d_i + b_{\\pi_{rev}(i)} e_i)$。\n\n    然后计算以下量：\n    -   **人为能量分裂 ($\\Delta_{\\text{split}}$)**: $\\Delta_{\\text{split}} = |E_{\\text{bad}}^{(\\pi_{id})} - E_{\\text{bad}}^{(\\pi_{rev})}|$。这个值直接度量了违反置换不变性导致的能量差异。\n    -   **坏模型的最大误差 ($\\text{Err}_{\\text{bad,max}}$)**: $\\text{Err}_{\\text{bad,max}} = \\max(|E_{\\text{bad}}^{(\\pi_{id})} - E_{\\text{LJ}}|, |E_{\\text{bad}}^{(\\pi_{rev})} - E_{\\text{LJ}}|)$。这反映了有缺陷模型在不同标签下的最坏预测误差。\n\n通过对四个案例重复以上计算，可以得到每个案例的三元组 $[\\Delta_{\\text{split}}, \\text{Err}_{\\text{bad,max}}, \\text{Err}_{\\text{good}}]$，最终汇总成题目要求的输出格式。",
            "answer": "[[0.72083549,0.92383794,0.11905494],[0.00000000,0.40722359,0.30138381],[0.09340989,0.13454279,0.02100867],[1.00207559,1.40103779,0.30252579]]"
        }
    ]
}