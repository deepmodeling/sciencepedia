{
    "hands_on_practices": [
        {
            "introduction": "要真正理解晶体轨道哈密顿布居 (COHP) 图谱的物理意义，最好的方法是从一个最简单的模型——两个相互作用的轨道——出发进行推导。本练习将从第一性原理出发，解析地推导出该体系的COHP谱。通过这个过程，我们将清晰地看到成键和反键态如何分别以负值和正值的峰出现，从而为解读来自真实计算的复杂COHP图谱打下坚实的理论基础。",
            "id": "3876496",
            "problem": "考虑一个在正交归一基中的双能级紧束缚(TB)表示，它描述了一个吸附物轨道 $\\{\\phi_{A}\\}$ 与一个表面轨道 $\\{\\phi_{B}\\}$ 之间的相互作用。在此基下的哈密顿量为\n$$\nH \\;=\\; \\begin{pmatrix}\n\\epsilon_{A}  t \\\\\nt  \\epsilon_{B}\n\\end{pmatrix},\n$$\n其中 $\\epsilon_{A}$ 和 $\\epsilon_{B}$ 是在位能，$t$ 是一个实值耦合（跃迁）参数。假设重叠矩阵是单位矩阵，且轨道是实数且归一化的。$H$ 的本征态用 $\\{\\,|\\psi_{n}\\rangle\\,\\}$ 表示，其本征能量为 $\\{\\,E_{n}\\,\\}$，分量为 $c_{nA} \\equiv \\langle \\phi_{A}|\\psi_{n}\\rangle$ 和 $c_{nB} \\equiv \\langle \\phi_{B}|\\psi_{n}\\rangle$。\n\n在正交归一基和实值哈密顿量矩阵元的情况下，位点 $A$ 和 $B$ 之间的晶体轨道哈密顿布居 (Crystal Orbital Hamilton Population, COHP) 定义为能量分辨的量\n$$\nCOHP_{AB}(E) \\;=\\; \\sum_{n} \\delta\\!\\left(E - E_{n}\\right)\\, c_{nA}\\, H_{AB}\\, c_{nB},\n$$\n其中 $\\delta(\\cdot)$ 表示狄拉克(Dirac)δ分布，且 $H_{AB}=t$。\n\n从紧束缚哈密顿量 $H$ 和上述定义出发，推导一个关于 $\\epsilon_{A}$、$\\epsilon_{B}$ 和 $t$ 的 $COHP_{AB}(E)$ 的闭式解析表达式，该表达式应表示为位于 $H$ 的两个本征能量处的狄拉克δ函数之和。然后，根据你的表达式和物理上一致的符号约定，解释哪个δ函数贡献对应于成键稳定化，哪个对应于反键去稳定化。\n\n你的最终答案必须是 $COHP_{AB}(E)$ 关于 $\\epsilon_{A}$、$\\epsilon_{B}$、$t$ 和 $\\delta(\\cdot)$ 的单一解析表达式。不需要进行数值计算。最终表达式中不需要单位。如果你引入任何缩写，请在首次使用时写出全称（例如，晶体轨道哈密顿布居 (Crystal Orbital Hamilton Population, COHP)）。",
            "solution": "该问题在科学上基于量子力学，表述清晰、客观且内部一致，因此是有效的。我们可以进行推导。\n\n目标是为一个双能级紧束缚系统推导晶体轨道哈密顿布居 (COHP) 的解析表达式，并解释其组成部分。COHP 对正交归一基和实哈密顿量元定义为：\n$$\nCOHP_{AB}(E) = \\sum_{n} \\delta(E - E_{n})\\, c_{nA}\\, H_{AB}\\, c_{nB}\n$$\n其中 $|\\psi_n\\rangle = c_{nA}|\\phi_A\\rangle + c_{nB}|\\phi_B\\rangle$ 是能量为 $E_n$ 的第 $n$ 个本征态，而 $H_{AB}$ 是轨道 $|\\phi_A\\rangle$ 和 $|\\phi_B\\rangle$ 之间的耦合矩阵元。\n\n首先，我们必须求解给定哈密顿量的本征值问题：\n$$\nH = \\begin{pmatrix} \\epsilon_{A}  t \\\\ t  \\epsilon_{B} \\end{pmatrix}\n$$\n本征值 $E$ 是久期方程 $\\det(H - E I) = 0$ 的根：\n$$\n\\det\\begin{pmatrix} \\epsilon_{A} - E  t \\\\ t  \\epsilon_{B} - E \\end{pmatrix} = (\\epsilon_{A} - E)(\\epsilon_{B} - E) - t^2 = 0\n$$\n这导出一个二次方程：\n$$\nE^2 - (\\epsilon_{A} + \\epsilon_{B})E + \\epsilon_{A}\\epsilon_{B} - t^2 = 0\n$$\n使用二次公式求解 $E$ 可得到两个本征能量：\n$$\nE = \\frac{(\\epsilon_{A} + \\epsilon_{B}) \\pm \\sqrt{(\\epsilon_{A} + \\epsilon_{B})^2 - 4(\\epsilon_{A}\\epsilon_{B} - t^2)}}{2} = \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} \\pm \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\n$$\n我们将较低的能量（成键）态记为 $E_1$，较高的能量（反键）态记为 $E_2$：\n$$\nE_1 = \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\n$$\n$$\nE_2 = \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} + \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\n$$\n\n接下来，我们需要为每个本征态 $n \\in \\{1, 2\\}$ 计算项 $c_{nA} H_{AB} c_{nB}$。鉴于 $H_{AB} = t$，该项变为 $t\\, c_{nA}\\, c_{nB}$。本征矢量系数的乘积 $c_{nA}c_{nB}$ 可以使用 Hellmann-Feynman 定理巧妙地确定。该定理指出，对于哈密顿量中的一个参数 $\\lambda$，本征值 $E_n$ 对 $\\lambda$ 的导数由哈密顿量导数的期望值给出：\n$$\n\\frac{\\partial E_n}{\\partial \\lambda} = \\left\\langle \\psi_n \\left| \\frac{\\partial H}{\\partial \\lambda} \\right| \\psi_n \\right\\rangle\n$$\n在我们的情况下，参数是跃迁积分 $t$。哈密顿量的导数为：\n$$\n\\frac{\\partial H}{\\partial t} = \\frac{\\partial}{\\partial t} \\begin{pmatrix} \\epsilon_{A}  t \\\\ t  \\epsilon_{B} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}\n$$\n应用该定理：\n$$\n\\frac{\\partial E_n}{\\partial t} = \\left\\langle \\psi_n \\left| \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\right| \\psi_n \\right\\rangle = \\begin{pmatrix} c_{nA}  c_{nB} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} c_{nA} \\\\ c_{nB} \\end{pmatrix} = c_{nA}c_{nB} + c_{nB}c_{nA} = 2c_{nA}c_{nB}\n$$\n我们利用了对于实对称哈密顿量，其系数是实数这一事实。由此，我们找到了系数乘积的直接关系：\n$$\nc_{nA}c_{nB} = \\frac{1}{2} \\frac{\\partial E_n}{\\partial t}\n$$\n现在，我们计算本征能量关于 $t$ 的导数：\n$$\n\\frac{\\partial E_1}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2} \\right] = -\\frac{1}{2} \\frac{8t}{2\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} = \\frac{-2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n$$\n\\frac{\\partial E_2}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} + \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2} \\right] = +\\frac{1}{2} \\frac{8t}{2\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} = \\frac{2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n使用这些导数，我们找到每个状态的哈密顿加权布居项 $t c_{nA} c_{nB}$：\n对于 $n=1$：\n$$\nt c_{1A} c_{1B} = t \\left( \\frac{1}{2} \\frac{\\partial E_1}{\\partial t} \\right) = \\frac{t}{2} \\left( \\frac{-2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right) = \\frac{-t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n对于 $n=2$：\n$$\nt c_{2A} c_{2B} = t \\left( \\frac{1}{2} \\frac{\\partial E_2}{\\partial t} \\right) = \\frac{t}{2} \\left( \\frac{2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right) = \\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n现在我们可以将这些结果代入 $COHP_{AB}(E)$ 的定义中：\n$$\nCOHP_{AB}(E) = \\delta(E - E_1) (t c_{1A} c_{1B}) + \\delta(E - E_2) (t c_{2A} c_{2B})\n$$\n$$\nCOHP_{AB}(E) = \\delta(E - E_1) \\left( \\frac{-t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right) + \\delta(E - E_2) \\left( \\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right)\n$$\n这可以简化为最终的解析表达式：\n$$\nCOHP_{AB}(E) = -\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\delta(E - E_1) + \\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\delta(E - E_2)\n$$\n代入 $E_1$ 和 $E_2$ 的表达式即可得到完整形式。\n\n为了进行解释，我们分析这两个贡献。在标准的 COHP 分析中，成键相互作用对总能量有稳定化作用，其 COHP 值为负。\n能量为 $E_1$ 的本征态代表轨道的成键组合，导致能量上的稳定化。在 $COHP_{AB}(E)$ 表达式中，其对应 δ 函数的振幅为：\n$$\n-\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n该值是严格为负的（对于 $t \\ne 0$）。因此，根据标准的符号约定，负的 COHP 值对应于成键稳定化。\n\n能量为 $E_2$ 的本征态代表反键组合，导致相对于非相互作用轨道而言的能量去稳定化。其 δ 函数的振幅为：\n$$\n\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n该值为严格正值。因此，正的 COHP 值对应于反键去稳定化。\n\n总而言之，位于较低能量 $E_1$ 处的 δ 函数具有负系数，代表成键相互作用；而位于较高能量 $E_2$ 处的 δ 函数具有正系数，代表反键相互作用。",
            "answer": "$$\n\\boxed{-\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\left[ \\delta\\left(E - \\left(\\frac{\\epsilon_{A} + \\epsilon_{B}}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\\right)\\right) - \\delta\\left(E - \\left(\\frac{\\epsilon_{A} + \\epsilon_{B}}{2} + \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\\right)\\right) \\right]}\n$$"
        },
        {
            "introduction": "化学家们发展了多种工具来定量描述化学键，但不同方法关注的侧重点各不相同。本练习将比较积分晶体轨道哈密顿布居 (ICOHP) 与经典的马利肯重叠布居 (MOP)。通过在一个包含轨道重叠的简单模型中推导它们之间的直接关系，我们将揭示COHP分析的独特优势：它提供了一个*能量加权*的化学键强度度量，直接关联到化学键对体系总能量稳定性的贡献。",
            "id": "3876510",
            "problem": "考虑一个与计算催化相关的对称双原子片段，它由两个原子 $A$ 和 $B$ 组成，每个原子各有一个价原子轨道。使用非正交基，通过类休克尔的原子轨道线性组合 (LCAO) 方法来模拟其电子结构。在 $\\{\\phi_{A},\\phi_{B}\\}$ 基组中，哈密顿矩阵 $\\mathbf{H}$ 和重叠矩阵 $\\mathbf{S}$ 分别为\n$$\n\\mathbf{H} \\equiv \\begin{pmatrix}\n\\alpha  \\beta \\\\\n\\beta  \\alpha\n\\end{pmatrix},\n$$\n$$\n\\mathbf{S} \\equiv \\begin{pmatrix}\n1  s \\\\\ns  1\n\\end{pmatrix},\n$$\n其中 $|\\beta|$ 表征原子间的能量耦合，$0 \\leq s  1$ 为轨道重叠。假设为闭壳层占据，两个电子位于能量最低的分子轨道中，且费米能级位于成键和反键能级之间。从广义本征值问题 $\\mathbf{H}\\mathbf{c} = E\\,\\mathbf{S}\\mathbf{c}$ 和以下基本定义出发：\n- $A$ 和 $B$ 之间在能量 $E$ 处的晶体轨道哈密顿布居 (COHP) 定义为\n$$\nCOHP_{AB}(E) \\equiv \\sum_{n} f_{n}\\,c_{A}^{(n)} c_{B}^{(n)}\\,H_{AB}\\,\\delta\\!\\big(E - E_{n}\\big),\n$$\n其中 $f_{n}$ 是分子轨道 $n$ 的占据数，$E_{n}$ 是其能量，$c_{A}^{(n)}$ 和 $c_{B}^{(n)}$ 是在 $\\phi_{A}$ 和 $\\phi_{B}$ 上的展开系数，$H_{AB}=\\beta$，$\\delta(\\cdot)$ 是狄拉克 $\\delta$ 分布。积分到费米能级 $E_{F}$ 的积分晶体轨道哈密顿布居 (ICOHP) 为\n$$\nICOHP_{AB} \\equiv \\int_{-\\infty}^{E_{F}} COHP_{AB}(E)\\,dE.\n$$\n- $A$ 和 $B$ 之间的马利肯重叠布居 (MOP) 为\n$$\nMOP_{AB} \\equiv P_{AB} S_{AB} + P_{BA} S_{BA},\n$$\n其中原子轨道基下的密度矩阵为 $P_{\\mu\\nu} \\equiv \\sum_{n} f_{n}\\,c_{\\mu}^{(n)} c_{\\nu}^{(n)}$ 且 $S_{AB}=S_{BA}=s$。\n\n仅使用这些定义和广义本征值问题，完成以下任务：\n1. 求解成键分子轨道的系数，并根据重叠度规进行归一化，即强制满足 $\\mathbf{c}^{\\top}\\mathbf{S}\\mathbf{c} = 1$。\n2. 表达已占据成键轨道的非对角密度矩阵元 $P_{AB}$，并用它定义一个类休克尔键级 $p_{AB}$ 为 $p_{AB} \\equiv P_{AB}$。\n3. 推导 $ICOHP_{AB}$ 和 $p_{AB}$ 之间的解析关系。\n4. 推导 $MOP_{AB}$ 的解析表达式，然后计算 $ICOHP_{AB}/MOP_{AB}$ 的比值（用 $\\beta$ 和 $s$ 表示）。\n\n以单个闭式表达式的形式给出 $ICOHP_{AB}/MOP_{AB}$（用 $\\beta$ 和 $s$ 表示）的最终答案。不需要进行数值计算或四舍五入。最终答案必须是无单位的解析表达式。",
            "solution": "问题验证如下：\n- **第一步：提取已知条件**\n  - 哈密顿矩阵：$\\mathbf{H} \\equiv \\begin{pmatrix} \\alpha  \\beta \\\\ \\beta  \\alpha \\end{pmatrix}$\n  - 重叠矩阵：$\\mathbf{S} \\equiv \\begin{pmatrix} 1  s \\\\ s  1 \\end{pmatrix}$，其中 $0 \\leq s  1$\n  - 基组：$\\{\\phi_{A},\\phi_{B}\\}$\n  - 占据情况：闭壳层，两个电子 ($f_{1}=2$) 位于能量最低的分子轨道（成键，$n=1$），零个电子 ($f_{2}=0$) 位于能量较高的分子轨道（反键，$n=2$）。\n  - 费米能级 $E_{F}$ 位于成键和反键轨道能量之间。\n  - $COHP_{AB}(E) \\equiv \\sum_{n} f_{n}\\,c_{A}^{(n)} c_{B}^{(n)}\\,H_{AB}\\,\\delta(E - E_{n})$，其中 $H_{AB}=\\beta$。\n  - $ICOHP_{AB} \\equiv \\int_{-\\infty}^{E_{F}} COHP_{AB}(E)\\,dE$。\n  - $MOP_{AB} \\equiv P_{AB} S_{AB} + P_{BA} S_{BA}$，其中 $S_{AB}=S_{BA}=s$。\n  - 密度矩阵：$P_{\\mu\\nu} \\equiv \\sum_{n} f_{n}\\,c_{\\mu}^{(n)} c_{\\nu}^{(n)}$。\n  - 归一化条件：$\\mathbf{c}^{\\top}\\mathbf{S}\\mathbf{c} = 1$。\n  - 键级定义：$p_{AB} \\equiv P_{AB}$。\n\n- **第二步：使用提取的已知条件进行验证**\n  - 该问题具有**科学依据**。这是一个量子化学入门中的标准问题，它在包含轨道重叠的类休克尔框架内应用了原子轨道线性组合 (LCAO) 方法。晶体轨道哈密顿布居 (COHP)、积分晶体轨道哈密顿布居 (ICOHP) 和马利肯重叠布居 (MOP) 的概念是计算材料科学和化学中用于化学键分析的成熟工具。\n  - 该问题是**适定的**。它提供了推导唯一解析解所需的所有必要定义和约束。指令是按顺序给出的，并导向一个最终的单一表达式。\n  - 该问题是**客观的**。所有术语都有数学定义，语言精确，没有主观内容。\n  - 问题的设定是**完整且一致的**。所有矩阵、变量和条件都已明确说明。\n  - 在模型的框架内，该情景是**科学上可信的**。条件 $0 \\leq s  1$ 对于归一化但非相同的原子轨道之间的重叠积分是物理上必需的。\n\n- **第三步：结论与行动**\n  - 该问题被判定为**有效**。现在开始求解过程。\n\n解题过程遵循问题陈述中指定的四个步骤。\n\n**1. 求解成键分子轨道的系数。**\n分子轨道能量 $E$ 和系数 $\\mathbf{c}$ 通过求解广义本征值问题 $\\mathbf{H}\\mathbf{c} = E\\mathbf{S}\\mathbf{c}$ 得到。如果久期行列式为零，则存在非平凡解：\n$$\n\\det(\\mathbf{H} - E\\mathbf{S}) = 0\n$$\n$$\n\\det\\begin{pmatrix} \\alpha - E  \\beta - Es \\\\ \\beta - Es  \\alpha - E \\end{pmatrix} = (\\alpha - E)^{2} - (\\beta - Es)^{2} = 0\n$$\n这得到 $\\alpha - E = \\pm(\\beta - Es)$。我们求解这两个能量：\n- 对于 `+` 的情况：$\\alpha - E = \\beta - Es \\implies E(1-s) = \\alpha - \\beta \\implies E_{\\text{anti}} = \\frac{\\alpha - \\beta}{1 - s}$。\n- 对于 `-` 的情况：$\\alpha - E = -(\\beta - Es) \\implies E(1+s) = \\alpha + \\beta \\implies E_{\\text{bond}} = \\frac{\\alpha + \\beta}{1 + s}$。\n由于成键相互作用的特征是 $\\beta  0$ 且我们有 $0 \\leq s  1$，所以成键轨道对应于较低的能量，$E_{1} = E_{\\text{bond}}$。\n\n我们现在通过求解 $(\\mathbf{H} - E_{1}\\mathbf{S})\\mathbf{c}^{(1)} = \\mathbf{0}$ 来找到成键轨道的系数，记为 $\\mathbf{c}^{(1)} = \\begin{pmatrix} c_{A}^{(1)} \\\\ c_{B}^{(1)} \\end{pmatrix}$。\n使用矩阵方程的第一行：\n$$\n(\\alpha - E_{1})c_{A}^{(1)} + (\\beta - E_{1}s)c_{B}^{(1)} = 0\n$$\n代入 $E_{1} = \\frac{\\alpha + \\beta}{1 + s}$：\n$$\n\\left(\\alpha - \\frac{\\alpha + \\beta}{1+s}\\right)c_{A}^{(1)} + \\left(\\beta - s\\frac{\\alpha + \\beta}{1+s}\\right)c_{B}^{(1)} = 0\n$$\n$$\n\\left(\\frac{\\alpha(1+s) - (\\alpha+\\beta)}{1+s}\\right)c_{A}^{(1)} + \\left(\\frac{\\beta(1+s) - s(\\alpha+\\beta)}{1+s}\\right)c_{B}^{(1)} = 0\n$$\n$$\n\\left(\\frac{\\alpha s - \\beta}{1+s}\\right)c_{A}^{(1)} + \\left(\\frac{\\beta - \\alpha s}{1+s}\\right)c_{B}^{(1)} = 0\n$$\n$$\n(\\alpha s - \\beta)c_{A}^{(1)} - (\\alpha s - \\beta)c_{B}^{(1)} = 0\n$$\n假设存在非平凡的相互作用，即 $\\alpha s \\neq \\beta$，我们得到 $c_{A}^{(1)} = c_{B}^{(1)}$。\n现在，我们应用归一化条件 $\\left(\\mathbf{c}^{(1)}\\right)^{\\top}\\mathbf{S}\\mathbf{c}^{(1)} = 1$：\n$$\n\\begin{pmatrix} c_{A}^{(1)}  c_{B}^{(1)} \\end{pmatrix} \\begin{pmatrix} 1  s \\\\ s  1 \\end{pmatrix} \\begin{pmatrix} c_{A}^{(1)} \\\\ c_{B}^{(1)} \\end{pmatrix} = (c_{A}^{(1)})^{2} + 2s c_{A}^{(1)}c_{B}^{(1)} + (c_{B}^{(1)})^{2} = 1\n$$\n代入 $c_{A}^{(1)} = c_{B}^{(1)} = c$：\n$$\nc^{2} + 2sc^{2} + c^{2} = 1 \\implies 2c^{2}(1+s) = 1 \\implies c = \\frac{1}{\\sqrt{2(1+s)}}\n$$\n因此，成键轨道的归一化系数为 $c_{A}^{(1)} = c_{B}^{(1)} = \\frac{1}{\\sqrt{2(1+s)}}$。\n\n**2. 表达密度矩阵元 $P_{AB}$ 和键级 $p_{AB}$。**\n密度矩阵元 $P_{AB}$ 由 $P_{AB} = \\sum_{n} f_{n}\\,c_{A}^{(n)} c_{B}^{(n)}$ 给出。\n只有成键轨道 ($n=1$) 被占据，占据数为 $f_{1}=2$。\n$$\nP_{AB} = f_{1}\\,c_{A}^{(1)} c_{B}^{(1)} = 2 \\left( \\frac{1}{\\sqrt{2(1+s)}} \\right) \\left( \\frac{1}{\\sqrt{2(1+s)}} \\right) = \\frac{2}{2(1+s)} = \\frac{1}{1+s}\n$$\n类休克尔键级定义为 $p_{AB} \\equiv P_{AB}$，所以 $p_{AB} = \\frac{1}{1+s}$。\n\n**3. 推导 $ICOHP_{AB}$ 和 $p_{AB}$ 之间的关系。**\n积分 COHP 定义为：\n$$\nICOHP_{AB} = \\int_{-\\infty}^{E_{F}} COHP_{AB}(E)\\,dE = \\int_{-\\infty}^{E_{F}} \\left( \\sum_{n} f_{n}\\,c_{A}^{(n)} c_{B}^{(n)}\\,H_{AB}\\,\\delta(E - E_{n}) \\right) dE\n$$\n我们可以交换求和与积分的顺序：\n$$\nICOHP_{AB} = \\sum_{n} f_{n}\\,c_{A}^{(n)} c_{B}^{(n)}\\,H_{AB} \\int_{-\\infty}^{E_{F}} \\delta(E - E_{n})\\,dE\n$$\n积分 $\\int_{-\\infty}^{E_{F}} \\delta(E - E_{n})\\,dE$ 的值，如果轨道能量 $E_{n}$ 低于费米能级 $E_{F}$ 则为 $1$，否则为 $0$。如题所述，只有成键轨道 ($n=1$) 被占据，所以 $E_1  E_F$。求和简化为 $n=1$ 的单项：\n$$\nICOHP_{AB} = f_{1}\\,c_{A}^{(1)} c_{B}^{(1)}\\,H_{AB}\n$$\n从第 2 步我们知道 $P_{AB} = f_{1}\\,c_{A}^{(1)} c_{B}^{(1)}$，这也定义为键级 $p_{AB}$。已知 $H_{AB}=\\beta$。\n$$\nICOHP_{AB} = P_{AB}\\,\\beta = p_{AB}\\,\\beta\n$$\n这就是 $ICOHP_{AB}$ 和 $p_{AB}$ 之间的解析关系。\n\n**4. 推导 $MOP_{AB}$ 并计算比值 $ICOHP_{AB}/MOP_{AB}$。**\n马利肯重叠布居定义为 $MOP_{AB} = P_{AB} S_{AB} + P_{BA} S_{BA}$。\n密度矩阵是对称的，所以 $P_{BA} = \\sum_{n} f_{n}\\,c_{B}^{(n)} c_{A}^{(n)} = P_{AB}$。已知 $S_{AB} = S_{BA} = s$。\n$$\nMOP_{AB} = P_{AB}s + P_{AB}s = 2P_{AB}s\n$$\n代入第 2 步中 $P_{AB}$ 的表达式：\n$$\nMOP_{AB} = 2 \\left(\\frac{1}{1+s}\\right) s = \\frac{2s}{1+s}\n$$\n现在我们计算所求的比值。使用第 3 步和第 2 步的结果：\n$$\nICOHP_{AB} = p_{AB}\\beta = \\frac{1}{1+s}\\beta\n$$\n比值为：\n$$\n\\frac{ICOHP_{AB}}{MOP_{AB}} = \\frac{\\beta/(1+s)}{2s/(1+s)}\n$$\n对于 $s \\ne 0$，$(1+s)$ 项可以消去：\n$$\n\\frac{ICOHP_{AB}}{MOP_{AB}} = \\frac{\\beta}{2s}\n$$\n这就是用 $\\beta$ 和 $s$ 表示的最终闭式表达式。注意，此表达式在 $s \\in (0, 1)$ 时有效，因为当 $s=0$ 时分母为零。",
            "answer": "$$\n\\boxed{\\frac{\\beta}{2s}}\n$$"
        },
        {
            "introduction": "COHP分析的真正威力在于其在复杂材料体系中的应用，它能将抽象的量子化学概念与可观测的宏观性质联系起来。本练习将搭建一座从理论到实际研究的桥梁，指导你构建一个完整的计算工作流。通过模拟吸附物与金属表面之间化学键的强度如何随表面位点（平台、台阶、扭结）和吸附覆盖度的变化而变化，我们将直接体验COHP如何被用于洞察多相催化中的关键问题。",
            "id": "3876498",
            "problem": "您接到的指令是构建一个计算工作流，用于评估多相催化相关表面位点上的金属-吸附物对的晶体轨道哈密顿布居 (COHP)，并提取随吸附物覆盖度变化的位点特异性趋势。该工作流必须以一个完整、可运行的程序实现。\n\n推导的基本依据是在 Born–Oppenheimer 近似下的单粒子 Kohn–Sham (KS) 哈密顿量、周期性固体的 Bloch 定理，以及晶体轨道哈密顿布居 (COHP) 的定义。考虑一个简化的紧束缚表示，每个原胞有两个局域轨道，一个在表面金属位点上，另一个在吸附物上。将金属轨道表示为位点 $A$，吸附物轨道表示为位点 $B$。布里渊区 (BZ) 通过一个均匀的波矢 $k$ 网格进行采样。\n\n从以下经过充分检验的事实和定义出发：\n- 在局域轨道基中，波矢为 $k$ 的 KS 哈密顿量可以表示为一个厄米矩阵 $\\mathbf{H}(k)$。在简化的双轨道模型中，令\n$$\n\\mathbf{H}(k) = \\begin{pmatrix}\n\\varepsilon_A  t_{AB}(k) \\\\\nt_{AB}(k)  \\varepsilon_B\n\\end{pmatrix},\n$$\n其中 $\\varepsilon_A$ 和 $\\varepsilon_B$ 是轨道 $A$ 和 $B$ 的在位能，而 $t_{AB}(k)$ 是非对角耦合项，由于周期性，它可能依赖于 $k$。\n- 对于每个 $k$，本征问题 $\\mathbf{H}(k)\\,\\mathbf{C}_{k,n} = \\epsilon_{k,n}\\,\\mathbf{C}_{k,n}$ 定义了本征值 $\\epsilon_{k,n}$ 和归一化本征矢 $\\mathbf{C}_{k,n} = (c_{A}(k,n),c_{B}(k,n))^\\top$。\n- 轨道 $A$ 和 $B$ 的能量分辨晶体轨道哈密顿布居 (COHP)，按照成键贡献为负值的约定，定义为\n$$\n\\mathrm{COHP}_{AB}(E) = \\sum_{k}\\,w_k\\sum_{n} \\left[c_{A}(k,n)\\,H_{AB}(k)\\,c_{B}(k,n)\\right]\\,\\delta\\!\\left(E - \\epsilon_{k,n}\\right),\n$$\n其中 $H_{AB}(k)=t_{AB}(k)$ 是非对角元，$w_k$ 是布里渊区采样权重，$\\delta(\\cdot)$ 是 Dirac delta 函数。在数值实践中，delta 函数被一个宽度为 $\\sigma$ 的归一化高斯函数进行展宽所取代。\n\n为了捕捉不同表面位点（平台、台阶、扭折）上吸附物的覆盖度，我们对紧束缚参数采用一种物理上合理的、依赖于覆盖度 $\\theta\\in[0,1]$ 和位点类型 $s\\in\\{\\text{terrace},\\text{step},\\text{kink}\\}$ 的参数化关系：\n- 在位能：\n$$\n\\varepsilon_A(s,\\theta) = \\varepsilon_{A,0} + \\Delta_A(s),\\quad\n\\varepsilon_B(\\theta) = \\varepsilon_{B,0} + \\beta\\,\\theta,\n$$\n其中 $\\varepsilon_{A,0}$ 和 $\\varepsilon_{B,0}$ 是基准值，$\\Delta_A(s)$ 编码了由配位引起的位点特异性移动，而 $\\beta\\,\\theta$ 项则使吸附物能级随覆盖度移动。\n- 耦合：\n$$\nt_{AB}(k;s,\\theta) = t_0(s)\\left(1 - \\alpha\\,\\theta \\right) + t_{k,\\mathrm{mod}}(s)\\,\\cos k,\n$$\n其中 $t_0(s)$ 是位点特异性的基准金属-吸附物耦合，$\\alpha$ 是随覆盖度变化的衰减因子，$t_{k,\\mathrm{mod}}(s)$ 设定了耦合的周期性调制。\n\n您必须将能量轴离散化为一个均匀网格 $\\{E_i\\}$，该网格跨越一个指定的区间，并用归一化高斯函数来近似 Dirac delta 函数：\n$$\n\\delta(E - \\epsilon_{k,n}) \\approx \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(E - \\epsilon_{k,n})^2}{2\\sigma^2}\\right).\n$$\n然后，通过对所有能带和所有 $k$ 点的展宽贡献求和，得到能量分辨的 $\\mathrm{COHP}_{AB}(E_i)$，而积分成键指示符则计算为\n$$\nI_{AB}^{}(E_F) = \\int_{E_{\\min}}^{E_F} \\mathrm{COHP}_{AB}(E)\\,dE,\n$$\n其中 $E_F$ 是费米能。在具有均匀网格间距 $\\Delta E$ 的离散表示中，这成为对 $E_i \\le E_F$ 的黎曼和：\n$$\nI_{AB}^{}(E_F) \\approx \\sum_{i: E_i \\le E_F} \\mathrm{COHP}_{AB}(E_i)\\,\\Delta E.\n$$\n\n实现以下具体且自包含的工作流：\n- 使用一维布里渊区，$k\\in[0,\\pi]$，用 $N_k$ 个点进行均匀采样，权重相等，为 $w_k = 1/N_k$。\n- 使用能量网格 $E\\in[E_{\\min},E_{\\max}]$，用 $N_E$ 个点进行均匀采样。高斯展宽宽度为 $\\sigma$（单位为电子伏特）。\n- 基准参数（均以电子伏特为单位）固定为\n$$\n\\varepsilon_{A,0} = -2.0,\\quad \\varepsilon_{B,0} = -0.5,\\quad \\beta = 1.0,\n$$\n位点特异性参数为\n$$\n\\Delta_A(\\text{terrace}) = 0.0,\\quad \\Delta_A(\\text{step}) = +0.5,\\quad \\Delta_A(\\text{kink}) = +1.0,\n$$\n$$\nt_0(\\text{terrace}) = 1.5,\\quad t_0(\\text{step}) = 2.0,\\quad t_0(\\text{kink}) = 2.5,\n$$\n$$\nt_{k,\\mathrm{mod}}(\\text{terrace}) = 0.3,\\quad t_{k,\\mathrm{mod}}(\\text{step}) = 0.4,\\quad t_{k,\\mathrm{mod}}(\\text{kink}) = 0.5.\n$$\n- 费米能为 $E_F = 0.0$ 电子伏特。\n- 能量网格的范围和大小为 $E_{\\min} = -6.0$ 电子伏特，$E_{\\max} = +4.0$ 电子伏特，$N_E = 4000$。布里渊区采样大小为 $N_k = 200$。\n\n您的程序必须：\n1.  对每个 $k$，使用位点类型 $s$、覆盖度 $\\theta$、衰减因子 $\\alpha$ 以及可选的覆盖值 $t_{k,\\mathrm{mod}}^{\\mathrm{override}}$（如果提供，则替换 $t_{k,\\mathrm{mod}}(s)$）来构建 $\\mathbf{H}(k)$。\n2.  在每个 $k$ 点，求解 $\\epsilon_{k,n}$ 和 $\\mathbf{C}_{k,n}$，其中 $n\\in\\{1,2\\}$。\n3.  使用宽度为 $\\sigma$ 的高斯展宽和成键为负的符号约定，在能量网格上构建 $\\mathrm{COHP}_{AB}(E_i)$。\n4.  通过将 $E_i\\le E_F$ 的 $\\mathrm{COHP}_{AB}(E_i)$ 求和并乘以均匀网格间距 $\\Delta E$ 来计算积分成键指示符 $I_{AB}^{}(E_F)$。\n5.  对每个测试用例，以电子伏特为单位返回 $I_{AB}^{}(E_F)$，格式为十进制浮点数。\n\n角度单位：所有 $k$ 值均为弧度。能量单位：所有能量均为电子伏特。您的程序必须以电子伏特为单位生成输出，并表示为十进制浮点数。\n\n测试套件：\n- 情况1（正常路径）：$s=\\text{terrace}$，$\\theta=0.0$，$\\sigma=0.15$，$\\alpha=0.6$，无 $t_{k,\\mathrm{mod}}$ 覆盖。\n- 情况2（高覆盖度平台）：$s=\\text{terrace}$，$\\theta=1.0$，$\\sigma=0.15$，$\\alpha=0.6$，无覆盖。\n- 情况3（台阶位点，中等覆盖度）：$s=\\text{step}$，$\\theta=0.5$，$\\sigma=0.08$，$\\alpha=0.6$，无覆盖。\n- 情况4（扭折位点，中等覆盖度，窄展宽）：$s=\\text{kink}$，$\\theta=0.5$，$\\sigma=0.05$，$\\alpha=0.6$，无覆盖。\n- 情况5（边缘情况，零耦合基准）：$s=\\text{kink}$，$\\theta=1.0$，$\\sigma=0.05$，$\\alpha=1.0$，使用 $t_{k,\\mathrm{mod}}^{\\mathrm{override}}=0.0$ 覆盖以消除 $k$ 调制并强制 $t_{AB}(k)=0$，这应导致 $\\mathrm{COHP}_{AB}(E)$ 恒等于零，因此 $I_{AB}^{}(E_F)=0.0$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述五个情况的顺序排列结果，例如，\"[result1,result2,result3,result4,result5]\"。每个结果必须是一个以电子伏特为单位的十进制浮点数。不应打印任何其他文本。",
            "solution": "问题陈述为一个计算工作流提供了一个完整且科学上合理的规范，该工作流用于计算一个简化的金属-吸附物体系双轨道紧束缚模型的晶体轨道哈密顿布居 (COHP) 和积分 COHP ($I_{AB}^{}(E_F)$)。该模型包含了对表面位点类型 $s$、吸附物覆盖度 $\\theta$ 和波矢 $k$ 的依赖性。问题是适定的、客观的，并且所有必要的参数和数值步骤都已明确定义。因此，该问题被认为是有效的，并提供了如下解决方案。\n\n任务的核心是为一组给定的参数实现所提供的公式。该工作流遵循以下主要步骤：\n1.  为一维布里渊区 (BZ) 和能量轴定义计算网格。\n2.  对于每个测试用例，根据位点类型 $s$、覆盖度 $\\theta$ 和其他指定常数，确定特定的紧束缚参数 $(\\varepsilon_A, \\varepsilon_B, t_{AB}(k))$。\n3.  遍历布里渊区网格中的所有波矢 $k$。在每个 $k$ 点：\n    a. 构建 $2 \\times 2$ 的 Kohn-Sham 哈密顿矩阵 $\\mathbf{H}(k)$。\n    b. 求解本征问题 $\\mathbf{H}(k)\\mathbf{C}_{k,n} = \\epsilon_{k,n}\\mathbf{C}_{k,n}$ 以获得能量本征值（能带）$\\epsilon_{k,n}$ 和相应的归一化本征矢 $\\mathbf{C}_{k,n}$。\n4.  通过对所有 $k$ 点和所有能带 $n$ 的贡献求和，计算能量分辨的 $\\mathrm{COHP}_{AB}(E)$。每个状态 $(\\epsilon_{k,n}, \\mathbf{C}_{k,n})$ 的贡献由布里渊区权重 $w_k$ 加权，乘以布居项 $c_A(k,n)H_{AB}(k)c_B(k,n)$，并使用高斯函数在能量网格上进行展宽。\n5.  通过对能量点 $E_i$ 直到费米能 $E_F$ 的所有 $\\mathrm{COHP}_{AB}(E_i)$ 值进行离散求和，并乘以能量网格间距 $\\Delta E$，来计算积分成键指示符 $I_{AB}^{}(E_F)$。\n\n**1. 计算网格和常数**\n问题指定了一个均匀采样的一维布里渊区。波矢集合为 $k \\in [0, \\pi]$，有 $N_k=200$ 个点。布里渊区采样权重是均匀的，$w_k = 1/N_k$。能量轴被离散化为一个均匀网格，包含 $N_E=4000$ 个点，范围从 $E_{\\min} = -6.0$ eV 到 $E_{\\max} = +4.0$ eV。能量步长为 $\\Delta E = (E_{\\max} - E_{\\min}) / (N_E-1)$。费米能固定在 $E_F = 0.0$ eV。\n\n**2. 哈密顿量的参数化**\n对于由位点 $s$、覆盖度 $\\theta$ 和衰减因子 $\\alpha$ 定义的每个测试用例，哈密顿量 $\\mathbf{H}(k)$ 的参数计算如下：\n- 金属轨道 $A$ 的在位能为 $\\varepsilon_A(s) = \\varepsilon_{A,0} + \\Delta_A(s)$。\n- 吸附物轨道 $B$ 的在位能为 $\\varepsilon_B(\\theta) = \\varepsilon_{B,0} + \\beta\\theta$。\n- 非对角耦合项 $t_{AB}$ 依赖于 $k$、$s$ 和 $\\theta$：\n$$\nt_{AB}(k;s,\\theta) = t_0(s)(1 - \\alpha\\theta) + t_{k,\\mathrm{mod}}(s)\\cos(k)\n$$\n一个可选参数 $t_{k,\\mathrm{mod}}^{\\mathrm{override}}$ 可以替换依赖于位点的 $t_{k,\\mathrm{mod}}(s)$。最终的 $2 \\times 2$ 哈密顿矩阵为：\n$$\n\\mathbf{H}(k) = \\begin{pmatrix} \\varepsilon_A  t_{AB}(k) \\\\ t_{AB}(k)  \\varepsilon_B \\end{pmatrix}\n$$\n\n**3. 布里渊区积分和本征求解**\n程序遍历生成的网格中的 $N_k$ 个波矢。对于每个 $k$，构建实对称矩阵 $\\mathbf{H}(k)$。该矩阵的本征问题使用标准的数值库函数（例如 `numpy.linalg.eigh`）求解，该函数高效地返回两个实数本征值 $\\epsilon_{k,1}, \\epsilon_{k,2}$ 和相应的标准正交本征矢 $\\mathbf{C}_{k,1}, \\mathbf{C}_{k,2}$。每个本征矢 $\\mathbf{C}_{k,n}$ 是一个列向量 $\\begin{pmatrix} c_A(k,n) \\\\ c_B(k,n) \\end{pmatrix}$。\n\n**4. 构建能量分辨的 COHP**\n能量分辨的 $\\mathrm{COHP}_{AB}(E)$ 在离散能量网格 $\\{E_i\\}$ 上构建。每个电子态 $(k,n)$ 的贡献被加到总和中。定义中的 Dirac delta 函数被一个以态能量 $\\epsilon_{k,n}$ 为中心、宽度为 $\\sigma$ 的归一化高斯函数所取代。在能量点 $E_i$ 处的离散化 $\\mathrm{COHP}_{AB}$ 的公式为：\n$$\n\\mathrm{COHP}_{AB}(E_i) = \\sum_{k} w_k \\sum_{n=1}^{2} \\left[c_{A}(k,n) H_{AB}(k) c_{B}(k,n)\\right] \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(E_i - \\epsilon_{k,n})^2}{2\\sigma^2}\\right)\n$$\n在数值上，这通过初始化一个大小为 $N_E$ 的零数组 `cohp_E` 来实现。然后，在对 $k$ 和 $n$ 的循环中，计算项 $w_k \\cdot [c_{A}(k,n) t_{AB}(k) c_{B}(k,n)]$，并将其乘以一个表示在整个能量网格上求值的高斯函数的向量。然后将此向量加到 `cohp_E` 数组中。这种矢量化的方法计算效率高。\n\n**5. 计算积分成键指示符**\n最后一步是计算截至费米能级的积分成键指示符 $I_{AB}^{}(E_F)$。这通过对能量分辨 COHP 的已占据部分进行黎曼求和来完成：\n$$\nI_{AB}^{}(E_F) \\approx \\sum_{i: E_i \\le E_F} \\mathrm{COHP}_{AB}(E_i) \\Delta E\n$$\n这包括识别能量网格中 $E_i \\le E_F$ 的所有索引 $i$，对 `cohp_E` 数组中相应的值求和，并将总和乘以能量步长 $\\Delta E$。得到的浮点数是单个测试用例的最终输出。程序的整体结构包括一个主驱动程序，该程序遍历所提供的测试用例，为每个用例调用一个实现上述逻辑的核心函数。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_icohp(s: str, theta: float, sigma: float, alpha: float, tk_mod_override: float = None) - float:\n    \"\"\"\n    Calculates the integrated Crystal Orbital Hamilton Population (ICOHP) for a\n    given set of physical parameters.\n\n    Args:\n        s: Site type ('terrace', 'step', 'kink').\n        theta: Adsorbate coverage (0.0 to 1.0).\n        sigma: Gaussian smearing width in eV.\n        alpha: Coverage attenuation factor for coupling.\n        tk_mod_override: Optional override for the k-dependent coupling modulation.\n\n    Returns:\n        The integrated COHP value up to the Fermi level in eV.\n    \"\"\"\n    # Define baseline and site-specific parameters in eV\n    SITE_PARAMS = {\n        'terrace': {'delta_A': 0.0, 't0': 1.5, 'tk_mod': 0.3},\n        'step':    {'delta_A': 0.5, 't0': 2.0, 'tk_mod': 0.4},\n        'kink':    {'delta_A': 1.0, 't0': 2.5, 'tk_mod': 0.5},\n    }\n    EPS_A0 = -2.0  # eV\n    EPS_B0 = -0.5  # eV\n    BETA = 1.0     # eV\n\n    # Define computational grid parameters\n    E_FERMI = 0.0  # eV\n    E_MIN, E_MAX, N_E = -6.0, 4.0, 4000\n    N_K = 200\n\n    # 1. Setup grids\n    energy_grid = np.linspace(E_MIN, E_MAX, N_E)\n    delta_e = (E_MAX - E_MIN) / (N_E - 1)\n    k_grid = np.linspace(0, np.pi, N_K)\n    k_weight = 1.0 / N_K\n\n    # 2. Determine model parameters for the given case\n    site_p = SITE_PARAMS[s]\n    eps_A = EPS_A0 + site_p['delta_A']\n    eps_B = EPS_B0 + BETA * theta\n    t0 = site_p['t0']\n    tk_mod = tk_mod_override if tk_mod_override is not None else site_p['tk_mod']\n\n    # Initialize the energy-resolved COHP array\n    cohp_E = np.zeros(N_E)\n    \n    # Optimization for the test case where coupling is zero\n    if t0 * (1 - alpha * theta) == 0.0 and tk_mod == 0.0:\n        return 0.0\n\n    # 3. Loop over all k-points in the Brillouin Zone\n    for k in k_grid:\n        # a. Construct the Hamiltonian matrix H(k)\n        t_AB_k = t0 * (1.0 - alpha * theta) + tk_mod * np.cos(k)\n        H_k = np.array([[eps_A, t_AB_k], [t_AB_k, eps_B]])\n\n        # b. Solve the eigenproblem for H(k)\n        eigenvalues, eigenvectors = np.linalg.eigh(H_k)\n\n        # 4. Accumulate COHP contributions from all bands (n=1, 2)\n        for n in range(2):\n            eps_kn = eigenvalues[n]\n            C_kn = eigenvectors[:, n]  # C_kn = [c_A, c_B]\n            c_A_kn, c_B_kn = C_kn[0], C_kn[1]\n\n            # Calculate the population term: c_A * H_AB * c_B\n            # H_AB(k) is the off-diagonal element t_AB_k\n            P_kn = c_A_kn * t_AB_k * c_B_kn\n\n            # Apply Gaussian smearing for the delta function\n            gauss_smearing = (1.0 / (sigma * np.sqrt(2.0 * np.pi))) * \\\n                             np.exp(-((energy_grid - eps_kn)**2) / (2.0 * sigma**2))\n            \n            # Add the contribution of this state (k, n) to the total COHP\n            cohp_E += k_weight * P_kn * gauss_smearing\n\n    # 5. Integrate COHP up to the Fermi energy\n    integration_mask = energy_grid = E_FERMI\n    integrated_cohp = np.sum(cohp_E[integration_mask]) * delta_e\n\n    return integrated_cohp\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1: terrace, zero coverage\n        {'s': 'terrace', 'theta': 0.0, 'sigma': 0.15, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 2: terrace, full coverage\n        {'s': 'terrace', 'theta': 1.0, 'sigma': 0.15, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 3: step, intermediate coverage\n        {'s': 'step', 'theta': 0.5, 'sigma': 0.08, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 4: kink, intermediate coverage, narrow smearing\n        {'s': 'kink', 'theta': 0.5, 'sigma': 0.05, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 5: kink, full coverage, zero coupling\n        {'s': 'kink', 'theta': 1.0, 'sigma': 0.05, 'alpha': 1.0, 'tk_mod_override': 0.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_icohp(**case)\n        results.append(f\"{result:.7f}\")\n\n    print(f\"[{','.join(results)}]\")\n\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}