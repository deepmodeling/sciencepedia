{
    "hands_on_practices": [
        {
            "introduction": "要掌握一个分析工具，最好的方法是从其最简单的应用形式入手。这个练习将引导我们为一个基础的双能级紧束缚模型推导出晶体轨道哈密顿布居 (COHP) 的解析表达式。通过这个过程，我们将清晰地看到COHP如何将成键和反键相互作用在能量上分离开来，从而为理解更复杂的体系打下坚实的理论基础。",
            "id": "3876496",
            "problem": "考虑一个在标准正交基中的双能级紧束缚 (TB) 表示，描述了一个吸附物轨道 $\\{\\phi_{A}\\}$ 与一个单一表面轨道 $\\{\\phi_{B}\\}$ 的相互作用。在此基中，哈密顿量为\n$$\nH \\;=\\; \\begin{pmatrix}\n\\epsilon_{A}  t \\\\\nt  \\epsilon_{B}\n\\end{pmatrix},\n$$\n其中 $\\epsilon_{A}$ 和 $\\epsilon_{B}$ 是在位能，$t$ 是一个实值耦合（跃迁）参数。假设交叠矩阵是单位矩阵，且轨道是实的和归一化的。$H$ 的本征态用 $\\{\\,|\\psi_{n}\\rangle\\,\\}$ 表示，其本征能量为 $\\{\\,E_{n}\\,\\}$，分量为 $c_{nA} \\equiv \\langle \\phi_{A}|\\psi_{n}\\rangle$ 和 $c_{nB} \\equiv \\langle \\phi_{B}|\\psi_{n}\\rangle$。\n\n在标准正交基和实值哈密顿矩阵元的情况下，位点 $A$ 和 $B$ 之间的能量分辨晶体轨道哈密顿布居 (Crystal Orbital Hamilton Population, COHP) 定义为：\n$$\nCOHP_{AB}(E) \\;=\\; \\sum_{n} \\delta\\!\\left(E - E_{n}\\right)\\, c_{nA}\\, H_{AB}\\, c_{nB},\n$$\n其中 $\\delta(\\cdot)$ 表示狄拉克 delta 分布，且 $H_{AB}=t$。\n\n从紧束缚哈密顿量 $H$ 和上述定义出发，推导 $COHP_{AB}(E)$ 的一个闭合形式解析表达式，该表达式用 $\\epsilon_{A}$、$\\epsilon_{B}$ 和 $t$ 表示，并表达为位于 $H$ 的两个本征能量处的狄拉克 delta 函数之和。然后，根据您的表达式和物理上一致的符号约定，解释哪个 delta 函数的贡献对应于成键稳定化，哪个对应于反键去稳定化。\n\n您的最终答案必须是 $COHP_{AB}(E)$ 的一个单一解析表达式，用 $\\epsilon_{A}$、$\\epsilon_{B}$、$t$ 和 $\\delta(\\cdot)$ 表示。无需进行数值计算。最终表达式中不需要单位。如果引入任何缩写，请在首次使用时写出全称（例如，晶体轨道哈密顿布居 (Crystal Orbital Hamilton Population, COHP)）。",
            "solution": "经判定，该问题在科学上基于量子力学，问题设定良好、客观且内部一致，因此有效。我们可以继续进行推导。\n\n目标是为一个双能级紧束缚系统推导晶体轨道哈密顿布居 (COHP) 的解析表达式，并解释其组成部分。根据问题描述，我们采用与现代实践一致的 COHP 定义：\n$$\nCOHP_{AB}(E) = \\sum_{n} \\delta(E - E_{n})\\, c_{nA}\\, H_{AB}\\, c_{nB}\n$$\n其中 $|\\psi_n\\rangle = c_{nA}|\\phi_A\\rangle + c_{nB}|\\phi_B\\rangle$ 是能量为 $E_n$ 的第 $n$ 个本征态，$H_{AB}$ 是轨道 $|\\phi_A\\rangle$ 和 $|\\phi_B\\rangle$ 之间的耦合矩阵元。\n\n首先，我们必须求解给定哈密顿量的本征值问题：\n$$\nH = \\begin{pmatrix} \\epsilon_{A}  t \\\\ t  \\epsilon_{B} \\end{pmatrix}\n$$\n本征值 $E$ 是久期方程 $\\det(H - E I) = 0$ 的根：\n$$\n\\det\\begin{pmatrix} \\epsilon_{A} - E  t \\\\ t  \\epsilon_{B} - E \\end{pmatrix} = (\\epsilon_{A} - E)(\\epsilon_{B} - E) - t^2 = 0\n$$\n这导出一个二次方程：\n$$\nE^2 - (\\epsilon_{A} + \\epsilon_{B})E + \\epsilon_{A}\\epsilon_{B} - t^2 = 0\n$$\n使用二次公式求解 $E$ 得到两个本征能量：\n$$\nE = \\frac{(\\epsilon_{A} + \\epsilon_{B}) \\pm \\sqrt{(\\epsilon_{A} + \\epsilon_{B})^2 - 4(\\epsilon_{A}\\epsilon_{B} - t^2)}}{2} = \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} \\pm \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\n$$\n我们将较低能量（成键）态表示为 $E_1$，较高能量（反键）态表示为 $E_2$：\n$$\nE_1 = \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\n$$\n$$\nE_2 = \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} + \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\n$$\n\n接下来，我们需要对每个本征态 $n \\in \\{1, 2\\}$ 计算项 $c_{nA} H_{AB} c_{nB}$。鉴于 $H_{AB} = t$，该项变为 $t\\, c_{nA}\\, c_{nB}$。本征向量系数的乘积 $c_{nA}c_{nB}$ 可以使用 Hellmann-Feynman 定理巧妙地确定。该定理指出，对于哈密顿量中的一个参数 $\\lambda$，一个本征值 $E_n$ 对 $\\lambda$ 的导数由哈密顿量导数的期望值给出：\n$$\n\\frac{\\partial E_n}{\\partial \\lambda} = \\left\\langle \\psi_n \\left| \\frac{\\partial H}{\\partial \\lambda} \\right| \\psi_n \\right\\rangle\n$$\n在我们的情况中，参数是跃迁积分 $t$。哈密顿量的导数是：\n$$\n\\frac{\\partial H}{\\partial t} = \\frac{\\partial}{\\partial t} \\begin{pmatrix} \\epsilon_{A}  t \\\\ t  \\epsilon_{B} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}\n$$\n应用该定理：\n$$\n\\frac{\\partial E_n}{\\partial t} = \\left\\langle \\psi_n \\left| \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\right| \\psi_n \\right\\rangle = \\begin{pmatrix} c_{nA}  c_{nB} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} c_{nA} \\\\ c_{nB} \\end{pmatrix} = c_{nA}c_{nB} + c_{nB}c_{nA} = 2c_{nA}c_{nB}\n$$\n我们利用了对于实对称哈密顿量，其系数是实数这一事实。由此，我们找到了系数乘积的直接关系：\n$$\nc_{nA}c_{nB} = \\frac{1}{2} \\frac{\\partial E_n}{\\partial t}\n$$\n现在，我们计算本征能量关于 $t$ 的导数：\n$$\n\\frac{\\partial E_1}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2} \\right] = -\\frac{1}{2} \\frac{8t}{2\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} = \\frac{-2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n$$\n\\frac{\\partial E_2}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\frac{\\epsilon_{A} + \\epsilon_{B}}{2} + \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2} \\right] = +\\frac{1}{2} \\frac{8t}{2\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} = \\frac{2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n使用这些导数，我们找到每个态的哈密顿加权布居项 $t c_{nA} c_{nB}$：\n对于 $n=1$：\n$$\nt c_{1A} c_{1B} = t \\left( \\frac{1}{2} \\frac{\\partial E_1}{\\partial t} \\right) = \\frac{t}{2} \\left( \\frac{-2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right) = \\frac{-t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n对于 $n=2$：\n$$\nt c_{2A} c_{2B} = t \\left( \\frac{1}{2} \\frac{\\partial E_2}{\\partial t} \\right) = \\frac{t}{2} \\left( \\frac{2t}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right) = \\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n现在我们可以将这些结果代入 $COHP_{AB}(E)$ 的定义中：\n$$\nCOHP_{AB}(E) = \\delta(E - E_1) (t c_{1A} c_{1B}) + \\delta(E - E_2) (t c_{2A} c_{2B})\n$$\n$$\nCOHP_{AB}(E) = \\delta(E - E_1) \\left( \\frac{-t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right) + \\delta(E - E_2) \\left( \\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\right)\n$$\n这简化为最终的解析表达式：\n$$\nCOHP_{AB}(E) = -\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\delta(E - E_1) + \\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\delta(E - E_2)\n$$\n代入 $E_1$ 和 $E_2$ 的表达式即可得到完整形式。\n\n为了进行解释，我们分析这两个贡献。按照标准的COHP符号约定（本文主体部分已阐述），负的COHP值表示成键相互作用，而正值表示反键相互作用。\n能量为 $E_1$ 的本征态代表了轨道的成键组合，导致能量上的稳定化。在 $COHP_{AB}(E)$ 表达式中，其对应 delta 函数的振幅为：\n$$\n-\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n该值是严格为负的（对于 $t \\ne 0$）。因此，一个负的 COHP 值对应于**成键**稳定化。\n\n能量为 $E_2$ 的本征态代表了反键组合，导致相对于非相互作用轨道在能量上的去稳定化。其 delta 函数的振幅为：\n$$\n\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}}\n$$\n该值是严格为正的。因此，一个正的 COHP 值对应于**反键**去稳定化。\n\n总而言之，在较低能量 $E_1$ 处的 delta 函数具有负系数，代表成键相互作用；而在较高能量 $E_2$ 处的 delta 函数具有正系数，代表反键相互作用。这与标准的化学直觉完全一致。",
            "answer": "$$\n\\boxed{\\frac{t^2}{\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}} \\left[ \\delta\\left(E - \\left(\\frac{\\epsilon_{A} + \\epsilon_{B}}{2} + \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\\right)\\right) - \\delta\\left(E - \\left(\\frac{\\epsilon_{A} + \\epsilon_{B}}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_{A} - \\epsilon_{B})^2 + 4t^2}\\right)\\right) \\right]}\n$$"
        },
        {
            "introduction": "化学键的直观图像常常将“同相”的轨道重叠与成键稳定化联系起来，但这并非总是成立。本练习通过一个精心设计的思想实验，揭示了晶体轨道重叠布居 (COOP) 和晶体轨道哈密顿布居 (COHP) 之间微妙而深刻的差异。通过分析一个非正交双能级模型，我们将探讨一种特殊情况：一个正的重叠布居如何与一个反键的哈密顿贡献并存，从而加深我们对轨道相互作用本质的理解。",
            "id": "3876477",
            "problem": "考虑一个与计算催化相关的金属-吸附物相互作用的最小二能级、非正交原子轨道线性组合（LCAO）模型，其中一个过渡金属表面轨道 $d$ 与一个吸附物 $p$ 轨道相互作用（例如，金属 $d$ 轨道与为反馈捐赠而排列的吸附物 $p$ 轨道之间的 $\\pi$ 型相互作用）。获得晶体轨道的广义特征值问题是\n$$\n\\mathbf{H}\\,\\mathbf{c} = E\\,\\mathbf{S}\\,\\mathbf{c},\n$$\n其中 $\\mathbf{c}$ 集合了金属 $d$ 轨道和吸附物 $p$ 轨道上的展开系数，$E$ 是晶体轨道能量，$\\mathbf{H}$ 是哈密顿矩阵，$\\mathbf{S}$ 是重叠矩阵。取\n$$\n\\mathbf{H} = \\begin{pmatrix} \\varepsilon_d  H_{dp} \\\\ H_{dp}  \\varepsilon_p \\end{pmatrix}, \\quad \\mathbf{S} = \\begin{pmatrix} 1  S_{dp} \\\\ S_{dp}  1 \\end{pmatrix},\n$$\n所选参数对于弱到中等强度的 $\\pi$ 相互作用具有化学合理性：\n- 金属在位能 $\\varepsilon_d = +1\\,\\text{eV}$，\n- 吸附物在位能 $\\varepsilon_p = -2\\,\\text{eV}$，\n- 重叠 $S_{dp} = +0.2$（同相空间重叠），\n- 非对角哈密顿量 $H_{dp} = +0.3\\,\\text{eV}$（与此方向上为正的 Slater–Koster $\\pi$ 型耦合积分一致）。\n\n将在能量 $E$ 时 $d$ 和 $p$ 之间的晶体轨道重叠布居（Crystal Orbital Overlap Population, COOP）定义为与 $c_d(E)\\,c_p(E)\\,S_{dp}$ 成正比，其中 $c_d(E)$ 和 $c_p(E)$ 是能量为 $E$ 的晶体轨道在 $d$ 和 $p$ 上的展开系数。将在能量 $E$ 时 $d$ 和 $p$ 之间的晶体轨道哈密顿布居（Crystal Orbital Hamilton Population, COHP）定义为与 $c_d(E)\\,H_{dp}\\,c_p(E)$ 成正比；根据晶体轨道哈密顿布居（COHP）分析中使用的惯用符号，负的 COHP 表示成键稳定化，正的 COHP 表示反键去稳定化。\n\n从这些定义和广义特征值问题出发，确定对于高能量晶体轨道（具有较大 $E$ 的解），其重叠布居是正还是负，以及哈密顿布居表示成键还是反键。你的推理必须从特征值问题以及系数和矩阵元素的符号出发，不得使用简便法则。哪个选项正确地描述了符号，并就在相位和能量排列方面提供了正确的物理学解释？\n\nA. 对于高能量晶体轨道，$c_d$ 和 $c_p$ 符号相同，所以 $c_d\\,c_p\\,S_{dp} > 0$（正重叠布居）。因为 $H_{dp} > 0$，所以 $c_d\\,H_{dp}\\,c_p > 0$，因此 COHP 为正，表示反键。这种情况发生于同相组合因正的非对角哈密顿量和 $E \\approx \\varepsilon_d$ 的能量排列而处于更高能量时，使得 $H_{dp} - E\\,S_{dp} > 0$ 并有利于形成一个同相的高能态。\n\nB. 对于高能量晶体轨道，由于能量不匹配，$c_d$ 和 $c_p$ 符号相反，所以重叠布居为负，且在 $H_{dp} > 0$ 的情况下 COHP 也为负，意味着高能态是成键的。\n\nC. 晶体轨道哈密顿布居的符号仅取决于重叠 $S_{dp}$ 的符号；由于 $S_{dp} > 0$，每当重叠布居为正时，COHP 必须为负（成键）。\n\nD. 即使 $H_{dp} > 0$，被占据的高能态也必然是成键的，因为占据会降低总能量；因此，当高能态被占据时，不论系数的相位如何，其 COHP 必须为负。",
            "solution": "用户要求对一个关于双能级原子轨道线性组合（LCAO）模型中晶体轨道哈密顿布居（COHP）分析的问题进行严格验证和详细解答。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **系统：** 一个包含金属 $d$ 轨道和吸附物 $p$ 轨道的双能级模型。\n- **控制方程：** 广义特征值问题 $\\mathbf{H}\\,\\mathbf{c} = E\\,\\mathbf{S}\\,\\mathbf{c}$。\n- **矩阵和向量：**\n    $$\n    \\mathbf{H} = \\begin{pmatrix} \\varepsilon_d  H_{dp} \\\\ H_{dp}  \\varepsilon_p \\end{pmatrix}, \\quad \\mathbf{S} = \\begin{pmatrix} 1  S_{dp} \\\\ S_{dp}  1 \\end{pmatrix}, \\quad \\mathbf{c} = \\begin{pmatrix} c_d \\\\ c_p \\end{pmatrix}\n    $$\n- **参数：**\n    - 金属在位能 $\\varepsilon_d = +1\\,\\text{eV}$。\n    - 吸附物在位能 $\\varepsilon_p = -2\\,\\text{eV}$。\n    - 重叠积分 $S_{dp} = +0.2$。\n    - 非对角哈密顿元素 $H_{dp} = +0.3\\,\\text{eV}$。\n- **定义：**\n    - 晶体轨道重叠布居（COOP）与 $c_d(E)\\,c_p(E)\\,S_{dp}$ 成正比。\n    - 晶体轨道哈密顿布居（COHP）与 $c_d(E)\\,H_{dp}\\,c_p(E)$ 成正比。\n    - COHP 符号约定：负 COHP 意味着成键；正 COHP 意味着反键。\n- **任务：** 对于高能量晶体轨道，确定重叠布居的符号以及哈密顿布居表示成键还是反键。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于标准的 LCAO 方法和公认的 COOP/COHP 分析框架，这些是计算材料科学和化学的基础。参数被说明为具有化学合理性。此项有效。\n- **适定性：** 该问题是一个标准的 $2 \\times 2$ 广义特征值问题。它已用所有必要的参数和定义完全指定，确保可以确定唯一的特征值和相应的特征向量。此项有效。\n- **客观性：** 该问题使用精确的数学和科学语言描述，没有主观或含糊的术语。此项有效。\n\n**第3步：结论与行动**\n该问题陈述科学合理、适定且客观。它是**有效的**。现在开始解题过程。\n\n### 解题推导\n\n问题的核心在于求解广义特征值方程 $(\\mathbf{H} - E\\mathbf{S})\\mathbf{c} = \\mathbf{0}$，即：\n$$\n\\begin{pmatrix} \\varepsilon_d - E  H_{dp} - E S_{dp} \\\\ H_{dp} - E S_{dp}  \\varepsilon_p - E \\end{pmatrix} \\begin{pmatrix} c_d \\\\ c_p \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从该矩阵方程的第一行，我们可以建立系数 $c_d$ 和 $c_p$ 之间的关系：\n$$\n(\\varepsilon_d - E) c_d + (H_{dp} - E S_{dp}) c_p = 0\n$$\n$$\n(H_{dp} - E S_{dp}) c_p = -(\\varepsilon_d - E) c_d\n$$\n这给出了系数的比值：\n$$\n\\frac{c_p}{c_d} = -\\frac{\\varepsilon_d - E}{H_{dp} - E S_{dp}} = \\frac{E - \\varepsilon_d}{H_{dp} - E S_{dp}}\n$$\n该问题涉及高能量晶体轨道。两个原子轨道 $\\varepsilon_d$ 和 $\\varepsilon_p$ 之间的相互作用将产生两个分子轨道，一个能量 $E_-$ 低于 $\\varepsilon_d$ 和 $\\varepsilon_p$，另一个能量 $E_+$ 高于两者。因此，对于能量为 $E_+$ 的高能量轨道，我们必须有 $E_+ > \\varepsilon_d$ 和 $E_+ > \\varepsilon_p$。\n\n给定 $\\varepsilon_d = +1\\,\\text{eV}$，比值中的分子 $E_+ - \\varepsilon_d$ 必须为正。\n$$\nE_+ - \\varepsilon_d > 0\n$$\n因此，比值 $c_p/c_d$ 的符号由分母 $H_{dp} - E_+ S_{dp}$ 的符号决定。为求此符号，我们首先需要求出 $E_+$。能量是久期行列式 $\\det(\\mathbf{H} - E\\mathbf{S}) = 0$ 的根：\n$$\n(\\varepsilon_d - E)(\\varepsilon_p - E) - (H_{dp} - E S_{dp})^2 = 0\n$$\n代入给定的参数值：$\\varepsilon_d = +1$, $\\varepsilon_p = -2$, $S_{dp} = +0.2$, 和 $H_{dp} = +0.3$:\n$$\n(1 - E)(-2 - E) - (0.3 - 0.2 E)^2 = 0\n$$\n$$\n(-2 - E + 2E + E^2) - (0.09 - 0.12E + 0.04E^2) = 0\n$$\n$$\n(E^2 + E - 2) - (0.04E^2 - 0.12E + 0.09) = 0\n$$\n$$\n0.96E^2 + 1.12E - 2.09 = 0\n$$\n使用二次公式，$E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nE = \\frac{-1.12 \\pm \\sqrt{(1.12)^2 - 4(0.96)(-2.09)}}{2(0.96)} = \\frac{-1.12 \\pm \\sqrt{1.2544 + 8.0256}}{1.92} = \\frac{-1.12 \\pm \\sqrt{9.28}}{1.92}\n$$\n由于 $\\sqrt{9} = 3$ 且 $\\sqrt{9.28} \\approx 3.046$，两个能量特征值为：\n$$\nE_+ = \\frac{-1.12 + 3.046}{1.92} \\approx \\frac{1.926}{1.92} \\approx +1.003\\,\\text{eV}\n$$\n$$\nE_- = \\frac{-1.12 - 3.046}{1.92} \\approx \\frac{-4.166}{1.92} \\approx -2.170\\,\\text{eV}\n$$\n高能量为 $E_+ \\approx +1.003\\,\\text{eV}$。正如预期，$E_+ > \\varepsilon_d = +1\\,\\text{eV}$。\n\n现在我们计算在 $E = E_+$ 时系数比值的分母的符号：\n$$\nH_{dp} - E_+ S_{dp} = 0.3 - (1.003)(0.2) = 0.3 - 0.2006 = 0.0994\n$$\n该量为正。\n因此，高能态的系数比值为：\n$$\n\\frac{c_p}{c_d} = \\frac{E_+ - \\varepsilon_d}{H_{dp} - E_+ S_{dp}} = \\frac{\\text{正}}{\\text{正}} > 0\n$$\n这意味着高能量轨道的系数 $c_d$ 和 $c_p$ 符号**相同**。\n\n根据这个结果，我们可以描述高能量轨道的 COOP 和 COHP：\n\n1.  **晶体轨道重叠布居（COOP）：** COOP 与 $c_d c_p S_{dp}$ 成正比。\n    -   由于 $c_d$ 和 $c_p$ 符号相同，它们的乘积 $c_d c_p$ 为正。\n    -   给定的重叠积分 $S_{dp} = +0.2$ 为正。\n    -   因此，COOP 与 $(+)(+) = +$ 成正比，意味着重叠布居为**正**。\n\n2.  **晶体轨道哈密顿布居（COHP）：** COHP 与 $c_d H_{dp} c_p$ 成正比。\n    -   乘积 $c_d c_p$ 为正。\n    -   给定的哈密顿元素 $H_{dp} = +0.3\\,\\text{eV}$ 为正。\n    -   因此，COHP 与 $(+)(+)(+) = +$ 成正比，意味着哈密顿布居为**正**。\n\n根据问题的符号约定，正的 COHP 表示**反键**相互作用。\n\n**高能量轨道总结：** 系数 $c_d$ 和 $c_p$ 符号相同。这导致正的重叠布居（COOP）和正的哈密顿布居（COHP），表示一个反键态。这在物理上是一致的，因为相互作用产生的高能量轨道应该是反键的。\n\n### 选项评估\n\n**A. 对于高能量晶体轨道，$c_d$ 和 $c_p$ 符号相同，所以 $c_d\\,c_p\\,S_{dp} > 0$（正重叠布居）。因为 $H_{dp} > 0$，所以 $c_d\\,H_{dp}\\,c_p > 0$，因此 COHP 为正，表示反键。这种情况发生于同相组合因正的非对角哈密顿量和 $E \\approx \\varepsilon_d$ 的能量排列而处于更高能量时，使得 $H_{dp} - E\\,S_{dp} > 0$ 并有利于形成一个同相的高能态。**\n-   关于 $c_d$ 和 $c_p$ 符号相同的陈述是**正确的**。\n-   关于重叠布居为正的结论是**正确的**。\n-   关于 COHP 为正并因此是反键的结论是**正确的**。\n-   附加的解释也是**正确的**。它准确地指出，对于高能态（其中 $E - \\varepsilon_d > 0$），同相特性（$c_p/c_d>0$）取决于条件 $H_{dp} - E\\,S_{dp} > 0$，我们已对给定参数验证了此条件。对于同相组合因正的 $H_{dp}$ 而能量更高的描述也是正确的解释。\n\n**B. 对于高能量晶体轨道，由于能量不匹配，$c_d$ 和 $c_p$ 符号相反，所以重叠布居为负，且在 $H_{dp} > 0$ 的情况下 COHP 也为负，意味着高能态是成键的。**\n-   关于 $c_d$ 和 $c_p$ 符号相反的前提是**不正确的**。我们的推导显示它们符号相同。这使得整个选项无效。\n\n**C. 晶体轨道哈密顿布居的符号仅取决于重叠 $S_{dp}$ 的符号；由于 $S_{dp} > 0$，每当重叠布居为正时，COHP 必须为负（成键）。**\n-   关于 COHP 的符号仅取决于 $S_{dp}$ 符号的前提是**不正确的**。COHP 与 $c_d c_p H_{dp}$ 成正比，而 COOP 与 $c_d c_p S_{dp}$ 成正比。COHP 的符号取决于 $c_d c_p$ 和 $H_{dp}$ 的符号。关系是 $\\text{sign}(\\text{COHP}) = \\text{sign}(\\text{COOP}) \\times \\text{sign}(H_{dp}) / \\text{sign}(S_{dp})$。对于本题，由于 $H_{dp} > 0$ 和 $S_{dp} > 0$，COHP 和 COOP 符号相同。该选项错误地声称它们必须有相反的符号。\n\n**D. 即使 $H_{dp} > 0$，被占据的高能态也必然是成键的，因为占据会降低总能量；因此，当高能态被占据时，不论系数的相位如何，其 COHP 必须为负。**\n-   这个陈述包含多个基本错误。根据定义，高能态是反键的（或至少是非键的），其占据会使系统不稳定（提高总能量），相对于仅填充成键态而言。关于“占据会降低总能量”的论点在此上下文中是错误的。此外，声称 COHP 为负“不论系数的相位如何”与 COHP 的定义相悖，COHP 明确依赖于系数的乘积 $c_d c_p$。该选项是**不正确的**。\n\n基于此分析，选项A是唯一一个完全符合第一性原理推导的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论知识的最终价值在于其解决实际问题的能力。这个实践项目要求我们将COHP的理论框架转化为一个功能性的计算程序，用于模拟异相催化中的一个核心问题：吸附物与金属表面之间的化学键强度如何随吸附位点（如平台、台阶、扭结）和覆盖度的变化而改变。通过完成这个编码任务，您将掌握将COHP分析应用于具体化学场景、并从中提取定量趋势的核心技能。",
            "id": "3876498",
            "problem": "您接到的指令是构建一个计算工作流，用于评估与多相催化相关的表面位点上金属-吸附物对的晶体轨道哈密顿布居 (COHP)，并提取随吸附物覆盖度变化的位点特异性趋势。该工作流必须以一个完整、可运行的程序实现。\n\n该推导的基础是 Born–Oppenheimer 近似下的单粒子 Kohn–Sham (KS) 哈密顿量、针对周期性固体的 Bloch 定理以及晶体轨道哈密顿布居 (COHP) 的定义。考虑一个简化的紧束缚表示，每个原胞有两个局域轨道，一个在表面金属位点上，一个在吸附物上。将金属轨道记为位点 $A$，吸附物轨道记为位点 $B$。布里渊区 (BZ) 通过均匀的波矢 $k$ 网格进行采样。\n\n从以下经过充分检验的事实和定义出发：\n- 在局域轨道基下，波矢为 $k$ 时的 KS 哈密顿量可以表示为一个厄米矩阵 $\\mathbf{H}(k)$。在简化的双轨道模型中，令\n$$\n\\mathbf{H}(k) = \\begin{pmatrix}\n\\varepsilon_A  t_{AB}(k) \\\\\nt_{AB}(k)  \\varepsilon_B\n\\end{pmatrix},\n$$\n其中 $\\varepsilon_A$ 和 $\\varepsilon_B$ 是轨道 $A$ 和 $B$ 的在位能，$t_{AB}(k)$ 是由于周期性可能依赖于 $k$ 的非对角耦合。\n- 对每个 $k$，本征问题 $\\mathbf{H}(k)\\,\\mathbf{C}_{k,n} = \\epsilon_{k,n}\\,\\mathbf{C}_{k,n}$ 定义了本征值 $\\epsilon_{k,n}$ 和归一化本征矢 $\\mathbf{C}_{k,n} = (c_{A}(k,n),c_{B}(k,n))^\\top$。\n- 轨道 $A$ 和 $B$ 的能量分辨晶体轨道哈密顿布居 (COHP) 定义为\n$$\n\\mathrm{COHP}_{AB}(E) = \\sum_{k}\\,w_k\\sum_{n} \\left[c_{A}(k,n)\\,H_{AB}(k)\\,c_{B}(k,n)\\right]\\,\\delta\\!\\left(E - \\epsilon_{k,n}\\right),\n$$\n其中 $H_{AB}(k)=t_{AB}(k)$ 是非对角元，$w_k$ 是布里渊区采样权重，$\\delta(\\cdot)$ 是 Dirac δ 函数。按照通常的约定，负的COHP值表示成键相互作用，正值表示反键相互作用。在数值实践中，δ 函数被宽度为 $\\sigma$ 的归一化高斯函数替代以进行展宽。\n\n为了捕捉不同表面位点（平台、台阶、扭折）上的吸附物覆盖度，我们采用紧束缚参数对覆盖度 $\\theta\\in[0,1]$ 和位点类型 $s\\in\\{\\text{terrace},\\text{step},\\text{kink}\\}$ 的物理上合理的参数化依赖关系：\n- 在位能：\n$$\n\\varepsilon_A(s,\\theta) = \\varepsilon_{A,0} + \\Delta_A(s),\\quad\n\\varepsilon_B(\\theta) = \\varepsilon_{B,0} + \\beta\\,\\theta,\n$$\n其中 $\\varepsilon_{A,0}$ 和 $\\varepsilon_{B,0}$ 是基准值，$\\Delta_A(s)$ 编码了由于配位引起的位点特异性移动，而 $\\beta\\,\\theta$ 使吸附物能级随覆盖度移动。\n- 耦合：\n$$\nt_{AB}(k;s,\\theta) = t_0(s)\\left(1 - \\alpha\\,\\theta \\right) + t_{k,\\mathrm{mod}}(s)\\,\\cos k,\n$$\n其中 $t_0(s)$ 是位点特异性的基准金属-吸附物耦合，$\\alpha$ 是随覆盖度变化的衰减因子，$t_{k,\\mathrm{mod}}(s)$ 设定了耦合的周期性调制。\n\n您必须将能量轴离散化为一个跨越指定区间的均匀网格 $\\{E_i\\}$，并用归一化高斯函数近似 Dirac δ 函数：\n$$\n\\delta(E - \\epsilon_{k,n}) \\approx \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(E - \\epsilon_{k,n})^2}{2\\sigma^2}\\right).\n$$\n然后，通过对所有能带和所有 $k$ 点的展宽贡献求和，得到能量分辨的 $\\mathrm{COHP}_{AB}(E_i)$，积分成键指示符计算如下：\n$$\nI_{AB}^{}(E_F) = \\int_{E_{\\min}}^{E_F} \\mathrm{COHP}_{AB}(E)\\,dE,\n$$\n其中 $E_F$ 是费米能。在具有均匀网格间距 $\\Delta E$ 的离散表示中，这变为对 $E_i \\le E_F$ 的黎曼和：\n$$\nI_{AB}^{}(E_F) \\approx \\sum_{i: E_i \\le E_F} \\mathrm{COHP}_{AB}(E_i)\\,\\Delta E.\n$$\n\n实现以下具体且自洽的工作流：\n- 使用一维布里渊区，$k\\in[0,\\pi]$，用 $N_k$ 个点进行均匀采样，权重相等，为 $w_k = 1/N_k$。\n- 使用能量网格 $E\\in[E_{\\min},E_{\\max}]$，用 $N_E$ 个点进行均匀采样。高斯展宽宽度为 $\\sigma$（单位为电子伏特）。\n- 基准参数（均以电子伏特为单位）固定为\n$$\n\\varepsilon_{A,0} = -2.0,\\quad \\varepsilon_{B,0} = -0.5,\\quad \\beta = 1.0,\n$$\n且位点特异性参数为\n$$\n\\Delta_A(\\text{terrace}) = 0.0,\\quad \\Delta_A(\\text{step}) = +0.5,\\quad \\Delta_A(\\text{kink}) = +1.0,\n$$\n$$\nt_0(\\text{terrace}) = 1.5,\\quad t_0(\\text{step}) = 2.0,\\quad t_0(\\text{kink}) = 2.5,\n$$\n$$\nt_{k,\\mathrm{mod}}(\\text{terrace}) = 0.3,\\quad t_{k,\\mathrm{mod}}(\\text{step}) = 0.4,\\quad t_{k,\\mathrm{mod}}(\\text{kink}) = 0.5.\n$$\n- 费米能为 $E_F = 0.0$ 电子伏特。\n- 能量网格的边界和大小为 $E_{\\min} = -6.0$ 电子伏特，$E_{\\max} = +4.0$ 电子伏特，以及 $N_E = 4000$。布里渊区采样点数为 $N_k = 200$。\n\n您的程序必须：\n1. 对每个 $k$，使用位点类型 $s$、覆盖度 $\\theta$、衰减因子 $\\alpha$ 以及可选的覆盖项 $t_{k,\\mathrm{mod}}^{\\mathrm{override}}$（如果提供，则替换 $t_{k,\\mathrm{mod}}(s)$）来构建 $\\mathbf{H}(k)$。\n2. 对每个 $k$，求解 $n\\in\\{1,2\\}$ 时的 $\\epsilon_{k,n}$ 和 $\\mathbf{C}_{k,n}$。\n3. 在能量网格上使用宽度为 $\\sigma$ 的高斯展宽，并遵循成键为负的符号约定来组装 $\\mathrm{COHP}_{AB}(E_i)$。\n4. 通过将 $E_i\\le E_F$ 的 $\\mathrm{COHP}_{AB}(E_i)$ 求和并乘以均匀网格间距 $\\Delta E$ 来计算积分成键指示符 $I_{AB}^{}(E_F)$。\n5. 对每个测试用例，以电子伏特为单位，将 $I_{AB}^{}(E_F)$ 作为十进制浮点数返回。\n\n角度单位：所有 $k$ 值都以弧度为单位。能量单位：所有能量都以电子伏特为单位。您的程序必须以电子伏特为单位生成输出，并表示为十进制浮点数。\n\n测试套件：\n- 情况1（正常路径）：$s=\\text{terrace}$，$\\theta=0.0$，$\\sigma=0.15$，$\\alpha=0.6$，无 $t_{k,\\mathrm{mod}}$ 的覆盖项。\n- 情况2（高覆盖度平台）：$s=\\text{terrace}$，$\\theta=1.0$，$\\sigma=0.15$，$\\alpha=0.6$，无覆盖项。\n- 情况3（台阶位点，中等覆盖度）：$s=\\text{step}$，$\\theta=0.5$，$\\sigma=0.08$，$\\alpha=0.6$，无覆盖项。\n- 情况4（扭折位点，中等覆盖度，窄展宽）：$s=\\text{kink}$，$\\theta=0.5$，$\\sigma=0.05$，$\\alpha=0.6$，无覆盖项。\n- 情况5（边界情况零耦合基线）：$s=\\text{kink}$，$\\theta=1.0$，$\\sigma=0.05$，$\\alpha=1.0$，用 $t_{k,\\mathrm{mod}}^{\\mathrm{override}}=0.0$ 覆盖以消除 $k$ 调制并强制 $t_{AB}(k)=0$，这应该产生恒为零的 $\\mathrm{COHP}_{AB}(E)$，因此 $I_{AB}^{}(E_F)=0.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按上述五种情况顺序排列的结果，以逗号分隔并用方括号括起，例如“[result1,result2,result3,result4,result5]”。每个结果必须是电子伏特为单位的十进制浮点数。不应打印任何其他文本。",
            "solution": "问题陈述为一个计算工作流提供了完整且科学合理的规范，该工作流用于计算一个简化的金属-吸附物体系双轨道紧束缚模型的晶体轨道哈密顿布居 (COHP) 和积分 COHP ($I_{AB}^{}(E_F)$)。该模型包含了对表面位点类型 $s$、吸附物覆盖度 $\\theta$ 和波矢 $k$ 的依赖性。此问题定义明确、客观，并且所有必要的参数和数值程序都已明确定义。因此，该问题被认为是有效的，并在下面提供了解决方案。\n\n任务的核心是为一组给定参数实现所提供的公式。工作流遵循以下主要步骤：\n1.  为一维布里渊区 (BZ) 和能量轴定义计算网格。\n2.  对于每个测试用例，根据位点类型 $s$、覆盖度 $\\theta$ 和其他指定常数，确定具体的紧束缚参数 $(\\varepsilon_A, \\varepsilon_B, t_{AB}(k))$。\n3.  遍历布里渊区网格中的所有波矢 $k$。在每个 $k$ 点：\n    a. 构建 $2 \\times 2$ 的 Kohn-Sham 哈密顿矩阵 $\\mathbf{H}(k)$。\n    b. 求解本征问题 $\\mathbf{H}(k)\\mathbf{C}_{k,n} = \\epsilon_{k,n}\\mathbf{C}_{k,n}$ 以获得能量本征值（能带）$\\epsilon_{k,n}$ 和相应的归一化本征矢 $\\mathbf{C}_{k,n}$。\n4.  通过对所有 $k$ 点和所有能带 $n$ 的贡献求和来计算能量分辨的 $\\mathrm{COHP}_{AB}(E)$。每个态 $(\\epsilon_{k,n}, \\mathbf{C}_{k,n})$ 的贡献乘以布里渊区权重 $w_k$，再乘以布居项 $c_A(k,n)H_{AB}(k)c_B(k,n)$，并使用高斯函数在能量网格上进行展宽。\n5.  通过对所有能量点 $E_i$ 直到费米能 $E_F$ 的 $\\mathrm{COHP}_{AB}(E_i)$ 值进行离散求和，并乘以能量网格间距 $\\Delta E$，来计算积分成键指示符 $I_{AB}^{}(E_F)$。\n\n**1. 计算网格和常数**\n问题指定了一个均匀采样的一维布里渊区。波矢集合由 $k \\in [0, \\pi]$ 给出，包含 $N_k=200$ 个点。布里渊区采样权重是均匀的，$w_k = 1/N_k$。能量轴被离散化为一个从 $E_{\\min} = -6.0$ eV 到 $E_{\\max} = +4.0$ eV 的均匀网格，包含 $N_E=4000$ 个点。能量步长为 $\\Delta E = (E_{\\max} - E_{\\min}) / (N_E-1)$。费米能固定在 $E_F = 0.0$ eV。\n\n**2. 哈密顿量的参数化**\n对于每个由位点 $s$、覆盖度 $\\theta$ 和衰减因子 $\\alpha$ 定义的测试用例，哈密顿量 $\\mathbf{H}(k)$ 的参数计算如下：\n- 金属轨道 $A$ 的在位能为 $\\varepsilon_A(s) = \\varepsilon_{A,0} + \\Delta_A(s)$。\n- 吸附物轨道 $B$ 的在位能为 $\\varepsilon_B(\\theta) = \\varepsilon_{B,0} + \\beta\\theta$。\n- 非对角耦合项 $t_{AB}$ 依赖于 $k$、$s$ 和 $\\theta$：\n$$\nt_{AB}(k;s,\\theta) = t_0(s)(1 - \\alpha\\theta) + t_{k,\\mathrm{mod}}(s)\\cos(k)\n$$\n一个可选参数 $t_{k,\\mathrm{mod}}^{\\mathrm{override}}$ 可以替换位点相关的 $t_{k,\\mathrm{mod}}(s)$。得到的 $2 \\times 2$ 哈密顿矩阵为：\n$$\n\\mathbf{H}(k) = \\begin{pmatrix} \\varepsilon_A  t_{AB}(k) \\\\ t_{AB}(k)  \\varepsilon_B \\end{pmatrix}\n$$\n\n**3. 布里渊区积分和本征求解**\n程序遍历生成网格中的 $N_k$ 个波矢。对每个 $k$，构建实对称矩阵 $\\mathbf{H}(k)$。使用标准数值库函数（例如 `numpy.linalg.eigh`）求解该矩阵的本征问题，该函数高效地返回两个实数本征值 $\\epsilon_{k,1}, \\epsilon_{k,2}$ 和相应的标准正交本征矢 $\\mathbf{C}_{k,1}, \\mathbf{C}_{k,2}$。每个本征矢 $\\mathbf{C}_{k,n}$ 是一个列向量 $\\begin{pmatrix} c_A(k,n) \\\\ c_B(k,n) \\end{pmatrix}$。\n\n**4. 能量分辨 COHP 的组装**\n能量分辨的 $\\mathrm{COHP}_{AB}(E)$ 在离散能量网格 $\\{E_i\\}$ 上构建。每个电子态 $(k,n)$ 的贡献被加到总和中。定义中的 Dirac δ 函数被一个以态能量 $\\epsilon_{k,n}$ 为中心、宽度为 $\\sigma$ 的归一化高斯函数所取代。在能量点 $E_i$ 处离散化的 $\\mathrm{COHP}_{AB}$ 的公式是：\n$$\n\\mathrm{COHP}_{AB}(E_i) = \\sum_{k} w_k \\sum_{n=1}^{2} \\left[c_{A}(k,n) H_{AB}(k) c_{B}(k,n)\\right] \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(E_i - \\epsilon_{k,n})^2}{2\\sigma^2}\\right)\n$$\n在数值上，这是通过初始化一个大小为 $N_E$ 的零数组 `cohp_E` 来实现的。然后，在对 $k$ 和 $n$ 的循环中，计算项 $w_k \\cdot [c_{A}(k,n) t_{AB}(k) c_{B}(k,n)]$，并将其乘以一个表示在整个能量网格上求值的高斯函数的向量。然后将此向量添加到 `cohp_E` 数组中。这种向量化方法在计算上是高效的。\n\n**5. 积分成键指示符的计算**\n最后一步是计算截至费米能级的积分成键指示符 $I_{AB}^{}(E_F)$。这是通过对能量分辨 COHP 的已占据部分使用黎曼和来完成的：\n$$\nI_{AB}^{}(E_F) \\approx \\sum_{i: E_i \\le E_F} \\mathrm{COHP}_{AB}(E_i) \\Delta E\n$$\n这包括识别能量网格中所有满足 $E_i \\le E_F$ 的索引 $i$，对 `cohp_E` 数组中相应的值求和，然后将总和乘以能量步长 $\\Delta E$。得到的浮点数是单个测试用例的最终输出。整个程序结构由一个主驱动程序组成，该驱动程序遍历所提供的测试用例，并为每个用例调用一个实现上述逻辑的核心函数。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_icohp(s: str, theta: float, sigma: float, alpha: float, tk_mod_override: float = None) -> float:\n    \"\"\"\n    Calculates the integrated Crystal Orbital Hamilton Population (ICOHP) for a\n    given set of physical parameters.\n\n    Args:\n        s: Site type ('terrace', 'step', 'kink').\n        theta: Adsorbate coverage (0.0 to 1.0).\n        sigma: Gaussian smearing width in eV.\n        alpha: Coverage attenuation factor for coupling.\n        tk_mod_override: Optional override for the k-dependent coupling modulation.\n\n    Returns:\n        The integrated COHP value up to the Fermi level in eV.\n    \"\"\"\n    # Define baseline and site-specific parameters in eV\n    SITE_PARAMS = {\n        'terrace': {'delta_A': 0.0, 't0': 1.5, 'tk_mod': 0.3},\n        'step':    {'delta_A': 0.5, 't0': 2.0, 'tk_mod': 0.4},\n        'kink':    {'delta_A': 1.0, 't0': 2.5, 'tk_mod': 0.5},\n    }\n    EPS_A0 = -2.0  # eV\n    EPS_B0 = -0.5  # eV\n    BETA = 1.0     # eV\n\n    # Define computational grid parameters\n    E_FERMI = 0.0  # eV\n    E_MIN, E_MAX, N_E = -6.0, 4.0, 4000\n    N_K = 200\n\n    # 1. Setup grids\n    energy_grid = np.linspace(E_MIN, E_MAX, N_E)\n    delta_e = (E_MAX - E_MIN) / (N_E - 1)\n    k_grid = np.linspace(0, np.pi, N_K)\n    k_weight = 1.0 / N_K\n\n    # 2. Determine model parameters for the given case\n    site_p = SITE_PARAMS[s]\n    eps_A = EPS_A0 + site_p['delta_A']\n    eps_B = EPS_B0 + BETA * theta\n    t0 = site_p['t0']\n    tk_mod = tk_mod_override if tk_mod_override is not None else site_p['tk_mod']\n\n    # Initialize the energy-resolved COHP array\n    cohp_E = np.zeros(N_E)\n    \n    # Optimization for the test case where coupling is zero\n    if t0 * (1 - alpha * theta) == 0.0 and tk_mod == 0.0:\n        return 0.0\n\n    # 3. Loop over all k-points in the Brillouin Zone\n    for k in k_grid:\n        # a. Construct the Hamiltonian matrix H(k)\n        t_AB_k = t0 * (1.0 - alpha * theta) + tk_mod * np.cos(k)\n        H_k = np.array([[eps_A, t_AB_k], [t_AB_k, eps_B]])\n\n        # b. Solve the eigenproblem for H(k)\n        eigenvalues, eigenvectors = np.linalg.eigh(H_k)\n\n        # 4. Accumulate COHP contributions from all bands (n=1, 2)\n        for n in range(2):\n            eps_kn = eigenvalues[n]\n            C_kn = eigenvectors[:, n]  # C_kn = [c_A, c_B]\n            c_A_kn, c_B_kn = C_kn[0], C_kn[1]\n\n            # Calculate the population term: c_A * H_AB * c_B\n            # H_AB(k) is the off-diagonal element t_AB_k\n            P_kn = c_A_kn * t_AB_k * c_B_kn\n\n            # Apply Gaussian smearing for the delta function\n            gauss_smearing = (1.0 / (sigma * np.sqrt(2.0 * np.pi))) * \\\n                             np.exp(-((energy_grid - eps_kn)**2) / (2.0 * sigma**2))\n            \n            # Add the contribution of this state (k, n) to the total COHP\n            # Following the standard convention where bonding is negative.\n            cohp_E += k_weight * P_kn * gauss_smearing\n\n    # 5. Integrate COHP up to the Fermi energy\n    integration_mask = energy_grid = E_FERMI\n    integrated_cohp = np.sum(cohp_E[integration_mask]) * delta_e\n\n    return integrated_cohp\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1: terrace, zero coverage\n        {'s': 'terrace', 'theta': 0.0, 'sigma': 0.15, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 2: terrace, full coverage\n        {'s': 'terrace', 'theta': 1.0, 'sigma': 0.15, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 3: step, intermediate coverage\n        {'s': 'step', 'theta': 0.5, 'sigma': 0.08, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 4: kink, intermediate coverage, narrow smearing\n        {'s': 'kink', 'theta': 0.5, 'sigma': 0.05, 'alpha': 0.6, 'tk_mod_override': None},\n        # Case 5: kink, full coverage, zero coupling\n        {'s': 'kink', 'theta': 1.0, 'sigma': 0.05, 'alpha': 1.0, 'tk_mod_override': 0.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_icohp(**case)\n        # The expected output format from the problem description\n        # is a list of floats. For example: [-0.6277259,-0.2116035,...]\n        results.append(result)\n\n    print(f\"[{','.join([f'{r:.7f}' for r in results])}]\")\n\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}