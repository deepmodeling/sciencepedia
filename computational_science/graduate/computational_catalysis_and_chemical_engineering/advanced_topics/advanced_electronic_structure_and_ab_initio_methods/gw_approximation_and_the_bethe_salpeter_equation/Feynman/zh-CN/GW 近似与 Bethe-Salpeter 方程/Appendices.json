{
    "hands_on_practices": [
        {
            "introduction": "理解复杂理论的最佳途径之一是从一个简单、可解的模型开始。这项练习利用一个双能级系统——可以被视为多体物理学中的“氢原子”模型——来揭示随机相位近似（RPA）中动态屏蔽的核心机制。通过分析推导筛选相互作用 $W(\\omega)$，您可以直观地看到集体激发（如等离激元）是如何从电子间的相互作用中产生的 。这个基础练习为您理解更复杂的计算方法奠定了坚实的理论基石。",
            "id": "3881843",
            "problem": "考虑一个吸附物在金属催化剂表面共振的最小模型，其中与屏蔽相关的电子子空间由两个单粒子态张成：一个能量为 $\\varepsilon_{v}$ 的初始占据态 $\\lvert v \\rangle$ 和一个能量为 $\\varepsilon_{c}$ 的初始空态 $\\lvert c \\rangle$，其中 $\\Delta \\equiv \\varepsilon_{c}-\\varepsilon_{v} > 0$。假设温度为零，自旋简并度为 $2$，且由于与金属连续谱的杂化，能级间相干性的有效退相干率为 $\\gamma > 0$。设一个外加标量微扰耦合到投影至该两能级子空间的电子密度算符上。用 $\\rho_{vc} \\equiv \\langle v \\rvert \\hat{\\rho} \\lvert c \\rangle$ 表示相应的非对角矩阵元，并定义广义振子强度 $S \\equiv \\lvert \\rho_{vc} \\rvert^{2}$。\n\n使用线性响应以及推迟独立粒子极化率 $P_{0}(\\omega)$ 作为此子空间中推迟密度-密度响应函数的定义，计算该两能级模型的 $P_{0}(\\omega)$，并仔细考虑自旋简并度和退相干率 $\\gamma$。然后，在随机相位近似 (RPA) 框架内，用裸相互作用矩阵元 $v$ 和 $P_{0}(\\omega)$ 表示此单模子空间中的标量屏蔽相互作用 $W(\\omega)$，并推导 $W(\\omega)$ 作为 $\\omega$、$\\Delta$、$\\gamma$、$S$ 和 $v$ 的函数的闭合形式表达式。\n\n您的推导必须从线性响应的第一性原理（例如，推迟密度-密度响应函数）和定义RPA中屏蔽的戴森式几何重求和出发，不得引用任何针对此两能级系统的预先给定的中间公式。最后，给出 $W(\\omega)$ 的最终简化解析表达式。\n\n请以单个闭合形式表达式的形式提供您的最终答案。不包含单位。不要四舍五入。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。它代表了凝聚态物理中用于计算电子屏蔽的一个标准（尽管简化了）模型。所有必要的参数和理论框架都已明确定义。因此，我们可以进行严格的推导。\n\n求解过程分为两个主要阶段。首先，我们计算给定两能级系统的推迟独立粒子极化率 $P_0(\\omega)$。其次，我们在随机相位近似（RPA）框架内使用此结果来求得屏蔽相互作用 $W(\\omega)$。\n\n**第一部分：独立粒子极化率 $P_0(\\omega)$ 的推导**\n\n对于独立粒子体系，推迟密度-密度响应函数（或极化率）由Lehmann表示给出，该表示可以从线性响应的Kubo公式推导出来。在零温（$T=0$）下，推迟极化率 $P_0(\\omega)$ 的表达式为：\n$$ P_0(\\omega) = \\sum_{i,j} (f_i - f_j) \\frac{\\lvert \\langle j \\rvert \\hat{\\rho} \\lvert i \\rangle \\rvert^2}{\\omega - (\\varepsilon_j - \\varepsilon_i) + i\\eta} $$\n此处，求和遍及所有单粒子态 $\\lvert i \\rangle$ 和 $\\lvert j \\rangle$。$f_i$ 是态 $\\lvert i \\rangle$ 的占据数（占据为1，空为0）。$\\varepsilon_i$ 是态 $\\lvert i \\rangle$ 的能量。$\\hat{\\rho}$ 是外加微扰所耦合的密度算符。$\\eta$ 是一个无穷小正常数。问题给出了一个有限的退相干率 $\\gamma > 0$，它将取代 $\\eta$。我们还考虑了 $g_s=2$ 的自旋简并度。\n\n在我们特定的两能级模型中，态是已占据的价态 $\\lvert v \\rangle$ 和空的导态 $\\lvert c \\rangle$。占据数分别为 $f_v=1$ 和 $f_c=0$。对态的求和中有两项不为零：\n1.  从 $\\lvert v \\rangle$ 到 $\\lvert c \\rangle$ 的激发：此时，$i=v$ 且 $j=c$。占据因子为 $f_v - f_c = 1-0 = 1$。能量差为 $\\varepsilon_j - \\varepsilon_i = \\varepsilon_c - \\varepsilon_v = \\Delta$。\n2.  从 $\\lvert c \\rangle$ 到 $\\lvert v \\rangle$ 的“退激发”：此时，$i=c$ 且 $j=v$。占据因子为 $f_c - f_v = 0-1 = -1$。能量差为 $\\varepsilon_j - \\varepsilon_i = \\varepsilon_v - \\varepsilon_c = -\\Delta$。\n\n问题将广义振子强度定义为 $S \\equiv \\lvert \\rho_{vc} \\rvert^2 = \\lvert \\langle v \\rvert \\hat{\\rho} \\lvert c \\rangle \\rvert^2$。由于 $\\hat{\\rho}$ 是一个厄米算符，我们有 $\\lvert \\langle c \\rvert \\hat{\\rho} \\lvert v \\rangle \\rvert^2 = \\lvert \\langle v \\rvert \\hat{\\rho} \\lvert c \\rangle^* \\rvert^2 = \\lvert \\langle v \\rvert \\hat{\\rho} \\lvert c \\rangle \\rvert^2 = S$。\n\n将这些代入Lehmann公式并包含自旋简并因子 $g_s=2$，我们得到：\n$$ P_0(\\omega) = g_s \\left[ (f_v-f_c)\\frac{\\lvert \\langle c \\rvert \\hat{\\rho} \\lvert v \\rangle \\rvert^2}{\\omega - (\\varepsilon_c - \\varepsilon_v) + i\\gamma} + (f_c-f_v)\\frac{\\lvert \\langle v \\rvert \\hat{\\rho} \\lvert c \\rangle \\rvert^2}{\\omega - (\\varepsilon_v - \\varepsilon_c) + i\\gamma} \\right] $$\n$$ P_0(\\omega) = 2 \\left[ (1)\\frac{S}{\\omega - \\Delta + i\\gamma} + (-1)\\frac{S}{\\omega - (-\\Delta) + i\\gamma} \\right] $$\n$$ P_0(\\omega) = 2S \\left( \\frac{1}{\\omega - \\Delta + i\\gamma} - \\frac{1}{\\omega + \\Delta + i\\gamma} \\right) $$\n为简化起见，我们将两项通分：\n$$ P_0(\\omega) = 2S \\left( \\frac{(\\omega + \\Delta + i\\gamma) - (\\omega - \\Delta + i\\gamma)}{(\\omega - \\Delta + i\\gamma)(\\omega + \\Delta + i\\gamma)} \\right) $$\n$$ P_0(\\omega) = 2S \\left( \\frac{2\\Delta}{(\\omega + i\\gamma)^2 - \\Delta^2} \\right) $$\n$$ P_0(\\omega) = \\frac{4S\\Delta}{(\\omega + i\\gamma)^2 - \\Delta^2} $$\n这就是该模型系统推迟独立粒子极化率的闭合形式表达式。\n\n**第二部分：屏蔽相互作用 $W(\\omega)$ 的推导**\n\n随机相位近似（RPA）通过对一个无穷极化气泡几何级数求和，用裸相互作用 $v$ 来描述屏蔽相互作用 $W$。该求和过程由一个戴森式方程表示。对于此单模模型中的标量，该方程为：\n$$ W(\\omega) = v + v P_0(\\omega) W(\\omega) $$\n该方程可以通过代数方法求解 $W(\\omega)$：\n$$ W(\\omega) - v P_0(\\omega) W(\\omega) = v $$\n$$ W(\\omega) (1 - v P_0(\\omega)) = v $$\n$$ W(\\omega) = \\frac{v}{1 - v P_0(\\omega)} $$\n这是屏蔽相互作用的一般RPA表达式。\n\n现在，我们将推导出的 $P_0(\\omega)$ 表达式代入此方程：\n$$ W(\\omega) = \\frac{v}{1 - v \\left( \\frac{4S\\Delta}{(\\omega + i\\gamma)^2 - \\Delta^2} \\right)} $$\n为简化起见，我们将分子和分母同乘以 $(\\omega + i\\gamma)^2 - \\Delta^2$：\n$$ W(\\omega) = \\frac{v ((\\omega + i\\gamma)^2 - \\Delta^2)}{(\\omega + i\\gamma)^2 - \\Delta^2 - v(4S\\Delta)} $$\n通过合并分母中的项，该表达式可以写得更紧凑：\n$$ W(\\omega) = v \\frac{(\\omega + i\\gamma)^2 - \\Delta^2}{(\\omega + i\\gamma)^2 - (\\Delta^2 + 4vS\\Delta)} $$\n这就是在RPA中屏蔽相互作用 $W(\\omega)$ 的最终简化解析表达式。$W(\\omega)$ 的极点定义了吸附物体系的集体电子激发（等离激元）的能量，这些能量相对于单粒子能量 $\\Delta$ 发生了移动，移动量由电子-电子相互作用 $v$ 决定。分子表明，在未屏蔽响应的极点处，即在单粒子激发频率处，屏蔽效应为零。\n该表达式的完全展开形式是：\n$$ W(\\omega) = v \\frac{\\omega^2 - \\gamma^2 - \\Delta^2 + 2i\\omega\\gamma}{\\omega^2 - \\gamma^2 - (\\Delta^2 + 4vS\\Delta) + 2i\\omega\\gamma} $$\n因式分解为平方项的形式在物理上更具洞察力，并被认为是更优的简化形式。",
            "answer": "$$\n\\boxed{v \\frac{(\\omega+i\\gamma)^2 - \\Delta^2}{(\\omega+i\\gamma)^2 - (\\Delta^2 + 4vS\\Delta)}}\n$$"
        },
        {
            "introduction": "在将理论应用于实际计算之前，我们必须处理计算方法本身带来的伪影。先进的电子结构计算，包括 GW 方法，通常在周期性边界条件（PBC）下进行，这对于模拟晶体和表面至关重要。然而，当计算准粒子能隙（涉及带电系统）时，PBC 会引入体系与其周期性镜像之间非物理的静电相互作用。这项练习将引导您从基本静电学原理出发，推导并应用一个关键的有限尺寸校正项 ，从而确保从有限尺寸的超晶胞计算中获得准确的、趋于孤立系统极限的 GW 结果。",
            "id": "3881850",
            "problem": "一个与催化反应相关的中性被吸附分子，在边长为 $L$ 的周期性立方晶胞中，使用多体微扰理论中的格林函数乘以屏蔽库仑相互作用 (GW) 近似以及通过 Bethe-Salpeter 方程 (BSE) 处理中性激发的方法进行模拟。GW 方法中的准粒子 (QP) 能量对应于带电态，而基态是中性的。在具有均匀中和背景的周期性边界条件下，增加或移除一个电子会产生一个净电荷，该电荷与其周期性镜像相互作用，并引起周围介质的极化响应。考虑一个相对介电常数为 $\\epsilon_r$ 的有效均匀介电环境，该环境代表了催化剂载体和溶剂的长波屏蔽效应。\n\n从经典静电学和晶格求和原理出发，为准粒子带隙提出并论证一个有限尺寸修正。准粒子带隙定义为 $E_{\\mathrm{g}}^{\\mathrm{QP}} = \\mathrm{IP} - \\mathrm{EA}$，其中 $\\mathrm{IP}$ 是电离势，$\\mathrm{EA}$ 是电子亲和能。你的论证应从基本定律（即库仑定律和叠加原理）开始，并应在长程范围内将增加或移除的电荷视为点电荷。利用在具有中和背景的周期性晶格中的镜像电荷相互作用的概念，获得与 $L$ 和 $\\epsilon_r$ 的主导阶标度关系。假设对于在中和背景中的点电荷的自相互作用，该立方晶格具有一个无量纲的马德隆常数 $\\alpha_{\\mathrm{M}}$。\n\n然后，对于一个在 $\\epsilon_r = 4$ 环境中、边长 $L = 20\\,\\text{\\AA}$ 的立方盒子，使用 $\\alpha_{\\mathrm{M}} = 2.837297$ 和库仑前因子 $e^2/(4\\pi\\epsilon_0) = 14.3996\\,\\text{eV}\\cdot\\text{\\AA}$，计算应从计算出的准粒子带隙中减去的有限尺寸修正的大小，以估计其无限晶胞极限。以电子伏特 (eV) 为单位表示最终能量，并将你的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导并计算在周期性立方晶胞中计算的分子准粒子带隙的主导阶有限尺寸修正。该修正源于在周期性边界条件 (PBC) 下进行带电晶胞计算时产生的虚假静电相互作用。\n\n推导过程从经典静电学的基本原理出发。\n\n首先，我们确定有限尺寸误差的来源。在 PBC 下的模拟中，单位晶胞被复制以铺满整个空间。当计算带电态（例如，电离势 IP 或电子亲和能 EA）的能量时，一个净电荷 $q$ 被引入到模拟晶胞中。这个电荷不仅与自身晶胞内的其他粒子相互作用，还与其在所有复制晶胞中的周期性镜像相互作用。为了防止由于净电荷密度的长程库仑相互作用导致总能量发散，通常会向系统中添加一个均匀的中和背景电荷密度 $\\rho = -q/V$，其中 $V=L^3$ 是晶胞体积。\n\n在边长为 $L$ 的有限晶胞中计算的带电系统的总能量 $E_q(L)$，可以与无限晶胞（孤立）极限下的能量 $E_q(\\infty)$ 通过以下关系联系起来：\n$$E_q(L) = E_q(\\infty) + \\Delta E_{\\text{err}}(q, L)$$\n其中 $\\Delta E_{\\text{err}}(q, L)$ 是由于晶胞有限尺寸引起的误差项。对于带电系统，主导阶误差由中和背景中周期性电荷阵列的静电自相互作用能决定。\n\n让我们来推导这个静电误差项 $\\Delta E(q, L)$，它是 $\\Delta E_{\\text{err}}(q, L)$ 的主要组成部分。我们将带电分子建模为位于立方晶胞原点的点电荷 $q$。该系统嵌入在相对介电常数为 $\\epsilon_r$ 的均匀介质中。必须计算这个电荷晶格的总静电能。根据库仑定律和叠加原理，我们必须对所有电荷对之间的相互作用求和。这是一个条件收敛的和，通过 Ewald 求和方法来处理。\n\n单个点电荷 $q$ 与其所有周期性镜像和中和背景相互作用的静电能的晶格求和结果，被称为该晶格构型的马德隆能量。它是电荷 $q$ 与周期性系统中所有其他电荷（其镜像和背景）所产生的静电势之间的相互作用能。在电荷位置（$\\mathbf{r}=\\mathbf{0}$）处的这个电势由以下公式给出：\n$$V_{\\text{other}}(\\mathbf{0}) = \\frac{\\alpha_{\\mathrm{M}}}{L} \\frac{q}{4\\pi\\epsilon_0\\epsilon_r}$$\n此处，$\\alpha_{\\mathrm{M}}$ 是针对特定晶格类型（本例中为简立方）和中和背景定义的无量纲马德隆常数。对单位晶胞的能量贡献是电荷与其所受电势乘积的一半，因子 $1/2$ 是为了防止重复计算相互作用能。因此，虚假的静电能为：\n$$\\Delta E(q, L) = \\frac{1}{2} q V_{\\text{other}}(\\mathbf{0}) = \\frac{1}{2} q \\left( \\frac{\\alpha_{\\mathrm{M}}}{L} \\frac{q}{4\\pi\\epsilon_0\\epsilon_r} \\right) = \\frac{\\alpha_{\\mathrm{M}} q^2}{2 L \\epsilon_r} \\left( \\frac{1}{4\\pi\\epsilon_0} \\right)$$\n这个公式给出了在边长为 $L$ 的立方晶胞中，带有净电荷 $q$ 的系统的总能量的主导阶有限尺寸修正。它与 $1/L$ 成标度关系。注意，对于中性系统（$q=0$），该项为零，正如预期的那样。\n\n接下来，我们将此修正应用于电离势 (IP) 和电子亲和能 (EA) 的定义。\n电离势是移除一个电子所需的能量，从而产生一个电荷为 $q=+e$ 的系统。在尺寸为 $L$ 的晶胞中计算的 $\\mathrm{IP}$ 为：\n$$\\mathrm{IP}(L) = E_{N-1}(L) - E_N(L)$$\n其中 $E_{N-1}(L)$ 是电荷为 $+e$ 的系统的能量，$E_N(L)$ 是中性系统的能量。应用我们的修正：\n$$\\mathrm{IP}(L) \\approx \\left( E_{N-1}(\\infty) + \\Delta E(q=+e, L) \\right) - E_N(\\infty) = \\mathrm{IP}(\\infty) + \\Delta E(q=+e, L)$$\n电子亲和能是增加一个电子时释放的能量，从而产生一个电荷为 $q=-e$ 的系统。计算出的 $\\mathrm{EA}$ 为：\n$$\\mathrm{EA}(L) = E_N(L) - E_{N+1}(L)$$\n其中 $E_{N+1}(L)$ 是电荷为 $-e$ 的系统的能量。应用我们的修正：\n$$\\mathrm{EA}(L) \\approx E_N(\\infty) - \\left( E_{N+1}(\\infty) + \\Delta E(q=-e, L) \\right) = \\mathrm{EA}(\\infty) - \\Delta E(q=-e, L)$$\n修正项 $\\Delta E(q, L)$ 取决于 $q^2$，因此对于电荷 $+e$ 和 $-e$ 是相同的：\n$$\\Delta E(q=+e, L) = \\Delta E(q=-e, L) = \\frac{\\alpha_{\\mathrm{M}} e^2}{2 L \\epsilon_r} \\left( \\frac{1}{4\\pi\\epsilon_0} \\right)$$\n\n最后，我们确定准粒子带隙 $E_{\\mathrm{g}}^{\\mathrm{QP}} = \\mathrm{IP} - \\mathrm{EA}$ 的修正。\n$$E_{\\mathrm{g}}^{\\mathrm{QP}}(L) = \\mathrm{IP}(L) - \\mathrm{EA}(L)$$\n代入 $\\mathrm{IP}(L)$ 和 $\\mathrm{EA}(L)$ 的表达式：\n$$E_{\\mathrm{g}}^{\\mathrm{QP}}(L) \\approx \\left( \\mathrm{IP}(\\infty) + \\Delta E(q=+e, L) \\right) - \\left( \\mathrm{EA}(\\infty) - \\Delta E(q=-e, L) \\right)$$\n$$E_{\\mathrm{g}}^{\\mathrm{QP}}(L) \\approx (\\mathrm{IP}(\\infty) - \\mathrm{EA}(\\infty)) + \\Delta E(q=+e, L) + \\Delta E(q=-e, L)$$\n$$E_{\\mathrm{g}}^{\\mathrm{QP}}(L) \\approx E_{\\mathrm{g}}^{\\mathrm{QP}}(\\infty) + 2 \\left( \\frac{\\alpha_{\\mathrm{M}} e^2}{2 L \\epsilon_r} \\frac{1}{4\\pi\\epsilon_0} \\right)$$\n$$E_{\\mathrm{g}}^{\\mathrm{QP}}(L) \\approx E_{\\mathrm{g}}^{\\mathrm{QP}}(\\infty) + \\frac{\\alpha_{\\mathrm{M}}}{L \\epsilon_r} \\frac{e^2}{4\\pi\\epsilon_0}$$\n因此，为了获得无限晶胞极限 $E_{\\mathrm{g}}^{\\mathrm{QP}}(\\infty)$，必须从计算出的带隙 $E_{\\mathrm{g}}^{\\mathrm{QP}}(L)$ 中减去的有限尺寸修正是：\n$$\\Delta E_{\\mathrm{g}} = E_{\\mathrm{g}}^{\\mathrm{QP}}(L) - E_{\\mathrm{g}}^{\\mathrm{QP}}(\\infty) = \\frac{\\alpha_{\\mathrm{M}}}{L \\epsilon_r} \\left( \\frac{e^2}{4\\pi\\epsilon_0} \\right)$$\n此修正按要求与 $1/L$ 和 $1/\\epsilon_r$ 成标度关系。\n\n现在，我们使用所提供的数据计算此修正的数值：\n立方盒子的边长，$L = 20\\,\\text{\\AA}$。\n介质的相对介电常数，$\\epsilon_r = 4$。\n简立方晶格的马德隆常数，$\\alpha_{\\mathrm{M}} = 2.837297$。\n库仑前因子，$\\frac{e^2}{4\\pi\\epsilon_0} = 14.3996\\,\\text{eV}\\cdot\\text{\\AA}$。\n\n将这些值代入推导出的 $\\Delta E_{\\mathrm{g}}$ 表达式中：\n$$\\Delta E_{\\mathrm{g}} = \\frac{2.837297}{(20\\,\\text{\\AA}) \\times 4} \\times (14.3996\\,\\text{eV}\\cdot\\text{\\AA})$$\n$$\\Delta E_{\\mathrm{g}} = \\frac{2.837297}{80\\,\\text{\\AA}} \\times (14.3996\\,\\text{eV}\\cdot\\text{\\AA})$$\n$$\\Delta E_{\\mathrm{g}} = \\frac{40.8559216852}{80}\\,\\text{eV}$$\n$$\\Delta E_{\\mathrm{g}} = 0.510699021\\,\\text{eV}$$\n问题要求修正的大小四舍五入到四位有效数字。\n$$\\Delta E_{\\mathrm{g}} \\approx 0.5107\\,\\text{eV}$$\n这就是应该从计算获得的准粒子带隙中减去的值，以修正主导阶有限尺寸误差。",
            "answer": "$$\\boxed{0.5107}$$"
        },
        {
            "introduction": "现在，让我们将 GW 方法应用于一个在催化领域具有直接意义的问题：确定被吸附物覆盖的表面的电子性质。这项综合性练习将准粒子方程、初始密度泛函理论（DFT）起点的影响以及来自吸附物的静电效应等概念融为一体。通过执行一个虽简化但物理内涵丰富的 $G_0W_0$ 算法，您将深入了解如何运用这些先进方法来模拟真实材料，并分析计算结果对不同初始近似（如 PBE 和 HSE 泛函）的敏感性 。",
            "id": "3881829",
            "problem": "给定一个有物理动机的、简化的单次格林函数乘以屏蔽库仑相互作用 ($G_0W_0$) 模型，用于估算带有吸附水分子的二氧化钛平板的价带顶准粒子电离势。目标是从两种不同的 Kohn–Sham 参考出发——即 Perdew–Burke–Ernzerhof (PBE) 广义梯度近似和 Heyd–Scuseria–Ernzerhof (HSE) 杂化泛函——计算并比较电离势，并分析其起始点依赖性。建模过程必须严格地从多体微扰理论和静电学的基本定义出发，并推导出一个数值可评估的算法。\n\n从以下基本依据出发：\n- $GW$ 近似中的准粒子方程：与 Kohn–Sham 态 $\\lvert \\psi_n \\rangle$ 相关联的准粒子能量 $E_n^{\\mathrm{QP}}$ 由 $E_n^{\\mathrm{QP}} = E_n^{\\mathrm{KS}} + Z_n \\langle \\psi_n \\lvert \\Sigma(E_n^{\\mathrm{KS}}) - V_{\\mathrm{xc}} \\rvert \\psi_n \\rangle$ 确定，其中 $Z_n = \\left[ 1 - \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\omega)}{\\partial \\omega} \\big\\vert_{\\omega = E_n^{\\mathrm{KS}}} \\right]^{-1}$ 是准粒子重整化因子，$\\Sigma(\\omega)$ 是多体自能，$V_{\\mathrm{xc}}$ 是交换相关势。\n- $GW$ 近似中的自能为 $\\Sigma = i G W$，其中 $G$ 是单粒子格林函数，$W$ 是动态屏蔽库仑相互作用。\n- 在静电学中，对于具有表面偶极密度为 $\\mu_s$ 的吸附偶极层的表面，其真空能级对齐会因一个势阶 $\\Delta \\phi = - \\mu_s / \\varepsilon_0$ 而发生移动，其中 $\\varepsilon_0$ 是真空介电常数。对于单位面积上具有垂直于表面的平均偶极投影 $p_n$ 的 $N$ 个分子，$\\mu_s = N p_n$。\n- 电离势定义为 $I = E_{\\mathrm{vac}} - E_{\\mathrm{VBM}}^{\\mathrm{QP}}$，其中 $E_{\\mathrm{vac}}$ 是真空能级，$E_{\\mathrm{VBM}}^{\\mathrm{QP}}$ 是价带顶 (VBM) 的准粒子能量。\n\n为获得与这些基础一致的可计算算法，请采用以下科学合理且自洽的简化：\n- 将动态屏蔽相互作用 $W(\\omega)$ 表示为由高频介电常数 $\\varepsilon_{\\infty}$ 和极点频率 $\\omega_p$ 表征的单个等离激元-极点模型。通过将有效屏蔽重整化为 $\\varepsilon_{\\mathrm{eff}} = \\varepsilon_{\\infty} + K_{\\mathrm{eh}} / E_g$，在静态水平上引入来自 Bethe-Salpeter 方程 (BSE) 的两粒子电子-空穴相关性，其中 $K_{\\mathrm{eh}}$ 是有效电子-空穴相互作用强度，$E_g = E_c^{\\mathrm{KS}} - E_v^{\\mathrm{KS}}$ 是 Kohn-Sham 带隙。\n- 将已占据价带顶的自能相关部分建模为与等离激元极点耦合的主导粒子项，从而产生一个由 $\\Sigma_c(E) = - \\frac{g_{\\mathrm{eff}}^2}{E - E_c^{\\mathrm{KS}} + \\omega_p}$ 近似的在壳频率相关位移，其中 $g_{\\mathrm{eff}} = g \\times \\left( \\varepsilon_{\\infty} / \\varepsilon_{\\mathrm{eff}} \\right)$ 通过 BSE 重整化屏蔽来重新标度耦合 $g$。这捕捉了计算 $Z$ 所需的 $\\Sigma_c$ 的主要能量依赖性及其导数 $\\frac{\\partial \\Sigma_c}{\\partial E} = \\frac{g_{\\mathrm{eff}}^2}{\\left( E - E_c^{\\mathrm{KS}} + \\omega_p \\right)^2}$。\n- 通过自能交换部分在价带顶态上的期望值 $\\Sigma_x$ 来处理它，并减去与所选起始泛函相对应的交换相关势期望值 $V_{\\mathrm{xc}}$。净静态替换为 $\\Delta_x = \\Sigma_x - V_{\\mathrm{xc}}$。\n\n因此，计算准粒子电离势的算法如下：\n1. 对于每个起始点（PBE 或 HSE），取给定的 Kohn–Sham 能量 $E_v^{\\mathrm{KS}}$ (VBM) 和 $E_c^{\\mathrm{KS}}$ (CBM)，以及价带顶上的交换相关势期望值 $V_{\\mathrm{xc}}$。\n2. 计算 Kohn–Sham 带隙 $E_g = E_c^{\\mathrm{KS}} - E_v^{\\mathrm{KS}}$。\n3. 计算 BSE 重整化屏蔽 $\\varepsilon_{\\mathrm{eff}} = \\varepsilon_{\\infty} + K_{\\mathrm{eh}} / E_g$ 和有效耦合 $g_{\\mathrm{eff}} = g \\times \\left( \\varepsilon_{\\infty} / \\varepsilon_{\\mathrm{eff}} \\right)$。\n4. 评估相关自能 $\\Sigma_c(E_v^{\\mathrm{KS}}) = - \\frac{g_{\\mathrm{eff}}^2}{E_v^{\\mathrm{KS}} - E_c^{\\mathrm{KS}} + \\omega_p}$ 及其导数 $\\frac{\\partial \\Sigma_c}{\\partial E}\\big\\vert_{E_v^{\\mathrm{KS}}} = \\frac{g_{\\mathrm{eff}}^2}{\\left( E_v^{\\mathrm{KS}} - E_c^{\\mathrm{KS}} + \\omega_p \\right)^2}$。\n5. 计算重整化因子 $Z_v = \\left[ 1 - \\frac{\\partial \\Sigma_c}{\\partial E}\\big\\vert_{E_v^{\\mathrm{KS}}} \\right]^{-1}$。\n6. 计算准粒子 VBM 能量 $E_v^{\\mathrm{QP}} = E_v^{\\mathrm{KS}} + Z_v \\left( \\Delta_x + \\Sigma_c(E_v^{\\mathrm{KS}}) \\right)$，其中 $\\Delta_x = \\Sigma_x - V_{\\mathrm{xc}}$。\n7. 使用吸附物诱导的表面偶极密度，通过 Helmholtz 方程计算真空能级位移 $\\Delta \\phi$。给定覆盖度 $\\theta$（单位为 $\\mathrm{nm}^{-2}$）和偶极投影 $p_n$（单位为 Debye），通过 $\\theta_{\\mathrm{m}^{-2}} = \\theta \\times 10^{18}$ 将 $\\theta$ 转换为 $\\mathrm{m}^{-2}$，通过 $p_n^{\\mathrm{C}\\cdot \\mathrm{m}} = p_n \\times 3.33564 \\times 10^{-30}$ 将 $p_n$ 转换为库仑-米，并设置 $\\Delta \\phi = - \\theta_{\\mathrm{m}^{-2}} p_n^{\\mathrm{C}\\cdot \\mathrm{m}} / \\varepsilon_0$（单位为伏特）。能量需以电子伏特报告，对于一个电子，$1\\,\\mathrm{V}$ 等于 $1\\,\\mathrm{eV}$。\n8. 电离势为 $I = \\Delta \\phi - E_v^{\\mathrm{QP}}$，单位为 $\\mathrm{eV}$。\n\n所有输入的能量 ($E_v^{\\mathrm{KS}}$, $E_c^{\\mathrm{KS}}$, $\\Sigma_x$, $V_{\\mathrm{xc}}$, $\\omega_p$, $g$) 均已提供，并且是以平板内部的平均静电势为参考。您必须严格执行上述算法，不得添加任何额外的启发式修正。\n\n将最终的电离势以电子伏特表示，并将报告的每个浮点数四舍五入到三位小数。此问题不涉及角度，也不需要百分比。\n\n测试套件：\n- 案例 1（典型覆盖度，中等激子重整化）：\n  - PBE: $E_v^{\\mathrm{KS}} = -7.40\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -3.20\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -5.10\\,\\mathrm{eV}$。\n  - HSE: $E_v^{\\mathrm{KS}} = -8.30\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -2.70\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -7.00\\,\\mathrm{eV}$。\n  - 通用参数: $\\Sigma_x = -10.20\\,\\mathrm{eV}$, $g = 2.50\\,\\mathrm{eV}$, $\\omega_p = 21.0\\,\\mathrm{eV}$, $\\varepsilon_{\\infty} = 5.5$, $K_{\\mathrm{eh}} = 1.00\\,\\mathrm{eV}$, $\\theta = 5.0\\,\\mathrm{nm}^{-2}$, $p_n = 0.60\\,\\mathrm{D}$。\n- 案例 2（零覆盖度边界，弱激子重整化）：\n  - PBE: $E_v^{\\mathrm{KS}} = -7.20\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -3.00\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -5.00\\,\\mathrm{eV}$。\n  - HSE: $E_v^{\\mathrm{KS}} = -8.00\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -2.60\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -7.20\\,\\mathrm{eV}$。\n  - 通用参数: $\\Sigma_x = -10.00\\,\\mathrm{eV}$, $g = 2.40\\,\\mathrm{eV}$, $\\omega_p = 20.0\\,\\mathrm{eV}$, $\\varepsilon_{\\infty} = 5.5$, $K_{\\mathrm{eh}} = 0.80\\,\\mathrm{eV}$, $\\theta = 0.0\\,\\mathrm{nm}^{-2}$, $p_n = 0.00\\,\\mathrm{D}$。\n- 案例 3（高覆盖度，强激子重整化）：\n  - PBE: $E_v^{\\mathrm{KS}} = -7.60\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -3.10\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -5.20\\,\\mathrm{eV}$。\n  - HSE: $E_v^{\\mathrm{KS}} = -8.50\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -2.60\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -7.10\\,\\mathrm{eV}$。\n  - 通用参数: $\\Sigma_x = -10.50\\,\\mathrm{eV}$, $g = 2.60\\,\\mathrm{eV}$, $\\omega_p = 22.0\\,\\mathrm{eV}$, $\\varepsilon_{\\infty} = 5.5$, $K_{\\mathrm{eh}} = 1.20\\,\\mathrm{eV}$, $\\theta = 10.0\\,\\mathrm{nm}^{-2}$, $p_n = 0.70\\,\\mathrm{D}$。\n- 案例 4（等离激元耦合改变后的灵敏度检查，覆盖度与案例 1 相同）：\n  - PBE: $E_v^{\\mathrm{KS}} = -7.30\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -3.25\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -5.05\\,\\mathrm{eV}$。\n  - HSE: $E_v^{\\mathrm{KS}} = -8.10\\,\\mathrm{eV}$, $E_c^{\\mathrm{KS}} = -2.75\\,\\mathrm{eV}$, $V_{\\mathrm{xc}} = -7.05\\,\\mathrm{eV}$。\n  - 通用参数: $\\Sigma_x = -10.10\\,\\mathrm{eV}$, $g = 2.30\\,\\mathrm{eV}$, $\\omega_p = 19.0\\,\\mathrm{eV}$, $\\varepsilon_{\\infty} = 5.5$, $K_{\\mathrm{eh}} = 0.95\\,\\mathrm{eV}$, $\\theta = 5.0\\,\\mathrm{nm}^{-2}$, $p_n = 0.60\\,\\mathrm{D}$。\n\n所有能量单位为 $\\mathrm{eV}$，频率单位为 $\\mathrm{eV}$（使用 $\\hbar = 1$ 进行频率-能量映射），偶极矩单位为 Debye，覆盖度单位为 $\\mathrm{nm}^{-2}$，且 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F}\\,\\mathrm{m}^{-1}$。\n\n您的程序应实现上述算法，并生成一行输出，其中包含一个列表的列表。每个内部列表对应一个测试案例，并包含三个以 $\\mathrm{eV}$ 为单位的浮点数：PBE 起始的电离势、HSE 起始的电离势，以及它们的差值（HSE 减去 PBE），所有数值均四舍五入到三位小数。例如，输出格式必须类似于 \"[[I_PBE_1,I_HSE_1,Delta_1],[I_PBE_2,I_HSE_2,Delta_2],[I_PBE_3,I_HSE_3,Delta_3],[I_PBE_4,I_HSE_4,Delta_4]]\"。",
            "solution": "所提出的问题是凝聚态物理领域一个有效的、自洽的计算练习。它在科学上基于多体微扰理论的原理，特别是 $GW$ 近似和 Bethe-Salpeter 方程 (BSE)，以及基本的静电学。该问题定义明确，提供了清晰、确定性的算法和所有必要的参数，确保可以计算出唯一且稳定的解。该问题是客观的，没有任何科学或逻辑上的不一致之处。因此，可以提供一个合理的解决方案。\n\n主要目标是计算带有吸附水分子的二氧化钛平板的准粒子电离势 $I$。这是通过一个简化的单次 $G_0W_0$ 模型来完成的，该模型从两种不同的 Kohn–Sham (KS) 密度泛函理论计算出发：一种基于 Perdew–Burke–Ernzerhof (PBE) 泛函，另一种基于 Heyd–Scuseria–Ernzerhof (HSE) 泛函。对结果差异的分析将量化 $G_0W_0$ 校正的起始点依赖性。\n\n电离势定义为将一个电子从材料的价带顶 (VBM) 移至真空能级 $E_{\\mathrm{vac}}$ 所需的能量。\n$$\nI = E_{\\mathrm{vac}} - E_{\\mathrm{VBM}}^{\\mathrm{QP}}\n$$\n此处，$E_{\\mathrm{VBM}}^{\\mathrm{QP}}$ 是价带顶的准粒子能量。带有吸附水分子的平板表面形成一个偶极层，这会使真空能级相对于平板内部的平均静电势（我们的参考点，设为 $0\\,\\mathrm{eV}$）发生移动。这个位移 $\\Delta \\phi$ 由亥姆霍兹方程针对表面偶极密度 $\\mu_s$ 描述：\n$$\n\\Delta \\phi = - \\frac{\\mu_s}{\\varepsilon_0}\n$$\n其中 $\\varepsilon_0$ 是真空介电常数。表面偶极密度由 $\\mu_s = N p_n$ 给出，其中 $N$ 是单位面积的分子数，$p_n$ 是垂直于表面的平均偶极矩分量。因此，真空能级为 $E_{\\mathrm{vac}} = \\Delta \\phi$。\n\n准粒子能量 $E_{\\mathrm{VBM}}^{\\mathrm{QP}}$ 是通过使用多体微扰理论校正价带顶的初始 Kohn–Sham 能量 $E_v^{\\mathrm{KS}}$ 来计算的。线性化的准粒子方程为：\n$$\nE_v^{\\mathrm{QP}} = E_v^{\\mathrm{KS}} + Z_v \\left\\langle \\psi_v \\left\\lvert \\Sigma(E_v^{\\mathrm{KS}}) - V_{\\mathrm{xc}} \\right\\rvert \\psi_v \\right\\rangle\n$$\n其中 $\\Sigma$ 是电子自能，$V_{\\mathrm{xc}}$ 是初始 DFT 计算中的交换相关势，$Z_v$ 是价带顶态 $\\lvert \\psi_v \\rangle$ 的准粒子重整化因子。\n\n自能 $\\Sigma = i G W$ 由交换部分 $\\Sigma_x$ 和相关部分 $\\Sigma_c$ 组成。校正项可以写为期望值的和：$\\langle \\Sigma_x - V_{\\mathrm{xc}} \\rangle + \\langle \\Sigma_c(E_v^{\\mathrm{KS}}) \\rangle$。问题提供了交换部分的期望值 $\\Sigma_x$ 和 KS 势的期望值 $V_{\\mathrm{xc}}$。它们的差值表示为 $\\Delta_x = \\Sigma_x - V_{\\mathrm{xc}}$。\n\n自能的相关部分 $\\Sigma_c$ 使用简化的等离激元-极点近似进行建模。对于已占据的价带顶态，该模型提供了在能量 $E$ 处计算 $\\Sigma_c$ 的表达式：\n$$\n\\Sigma_c(E) = - \\frac{g_{\\mathrm{eff}}^2}{E - E_c^{\\mathrm{KS}} + \\omega_p}\n$$\n其中 $E_c^{\\mathrm{KS}}$ 是导带底 (CBM) 的 KS 能量，$\\omega_p$ 是特征等离激元频率，$g_{\\mathrm{eff}}$ 是有效电子-等离激元耦合强度。这种有效耦合通过以下关系解释了屏蔽效应，包括来自 Bethe-Salpeter 方程的静态电子-空穴相互作用：\n$$\ng_{\\mathrm{eff}} = g \\times \\left( \\frac{\\varepsilon_{\\infty}}{\\varepsilon_{\\mathrm{eff}}} \\right) \\quad \\text{with} \\quad \\varepsilon_{\\mathrm{eff}} = \\varepsilon_{\\infty} + \\frac{K_{\\mathrm{eh}}}{E_g}\n$$\n在这里，$g$ 是裸耦合常数，$\\varepsilon_{\\infty}$ 是高频介电常数，$K_{\\mathrm{eh}}$ 是有效电子-空穴相互作用强度，$E_g = E_c^{\\mathrm{KS}} - E_v^{\\mathrm{KS}}$ 是 Kohn–Sham 带隙。\n\n准粒子重整化因子 $Z_v$ 解释了自能的能量依赖性。其定义为：\n$$\nZ_v = \\left[ 1 - \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\omega)}{\\partial \\omega} \\bigg\\vert_{\\omega = E_v^{\\mathrm{KS}}} \\right]^{-1}\n$$\n在我们的模型中，只有相关部分 $\\Sigma_c$ 是能量依赖的。其导数为：\n$$\n\\frac{\\partial \\Sigma_c(E)}{\\partial E} \\bigg\\vert_{E_v^{\\mathrm{KS}}} = \\frac{g_{\\mathrm{eff}}^2}{\\left( E_v^{\\mathrm{KS}} - E_c^{\\mathrm{KS}} + \\omega_p \\right)^2} = \\frac{g_{\\mathrm{eff}}^2}{\\left( \\omega_p - E_g \\right)^2}\n$$\n因此，$Z_v = \\left[ 1 - \\frac{g_{\\mathrm{eff}}^2}{\\left( \\omega_p - E_g \\right)^2} \\right]^{-1}$。\n\n结合这些元素，针对每个起始点（PBE 和 HSE）的完整计算算法如下：\n1.  计算 KS 带隙 $E_g = E_c^{\\mathrm{KS}} - E_v^{\\mathrm{KS}}$。\n2.  计算有效屏蔽 $\\varepsilon_{\\mathrm{eff}}$ 和有效耦合 $g_{\\mathrm{eff}}$。\n3.  评估相关自能 $\\Sigma_c(E_v^{\\mathrm{KS}}) = -g_{\\mathrm{eff}}^2 / (\\omega_p - E_g)$ 及其能量导数。\n4.  计算重整化因子 $Z_v$。\n5.  确定准粒子能量 $E_v^{\\mathrm{QP}} = E_v^{\\mathrm{KS}} + Z_v \\left( (\\Sigma_x - V_{\\mathrm{xc}}) + \\Sigma_c(E_v^{\\mathrm{KS}}) \\right)$。\n6.  计算真空能级位移 $\\Delta \\phi = - (\\theta \\times 10^{18}) \\times (p_n \\times 3.33564 \\times 10^{-30}) / \\varepsilon_0$。以 eV 为单位的能量位移在数值上等于以伏特为单位的电位位移，因此 $\\Delta \\phi_{\\mathrm{eV}} = \\Delta \\phi_{\\mathrm{V}}$。\n7.  最后，计算电离势 $I = \\Delta \\phi - E_v^{\\mathrm{QP}}$。\n\n对每个测试案例实施此程序，以确定 PBE 和 HSE 起始点的电离势，并计算它们的差值以评估此 $G_0W_0$ 模型的起始点依赖性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating quasiparticle ionization potentials\n    for a TiO2 slab based on a simplified G0W0 model.\n    \"\"\"\n    # Constants\n    EPSILON_0 = 8.8541878128e-12  # F/m\n    DEBYE_TO_CM = 3.33564e-30     # C*m per Debye\n\n    test_cases = [\n        # Case 1\n        {\n            \"pbe\": {\"E_v_ks\": -7.40, \"E_c_ks\": -3.20, \"V_xc\": -5.10},\n            \"hse\": {\"E_v_ks\": -8.30, \"E_c_ks\": -2.70, \"V_xc\": -7.00},\n            \"common\": {\"Sigma_x\": -10.20, \"g\": 2.50, \"omega_p\": 21.0, \"eps_inf\": 5.5,\n                       \"K_eh\": 1.00, \"theta\": 5.0, \"p_n\": 0.60}\n        },\n        # Case 2\n        {\n            \"pbe\": {\"E_v_ks\": -7.20, \"E_c_ks\": -3.00, \"V_xc\": -5.00},\n            \"hse\": {\"E_v_ks\": {\"E_v_ks\": -8.00, \"E_c_ks\": -2.60, \"V_xc\": -7.20},\n            \"common\": {\"Sigma_x\": -10.00, \"g\": 2.40, \"omega_p\": 20.0, \"eps_inf\": 5.5,\n                       \"K_eh\": 0.80, \"theta\": 0.0, \"p_n\": 0.00}\n        },\n        # Case 3\n        {\n            \"pbe\": {\"E_v_ks\": -7.60, \"E_c_ks\": -3.10, \"V_xc\": -5.20},\n            \"hse\": {\"E_v_ks\": -8.50, \"E_c_ks\": -2.60, \"V_xc\": -7.10},\n            \"common\": {\"Sigma_x\": -10.50, \"g\": 2.60, \"omega_p\": 22.0, \"eps_inf\": 5.5,\n                       \"K_eh\": 1.20, \"theta\": 10.0, \"p_n\": 0.70}\n        },\n        # Case 4\n        {\n            \"pbe\": {\"E_v_ks\": -7.30, \"E_c_ks\": -3.25, \"V_xc\": -5.05},\n            \"hse\": {\"E_v_ks\": -8.10, \"E_c_ks\": -2.75, \"V_xc\": -7.05},\n            \"common\": {\"Sigma_x\": -10.10, \"g\": 2.30, \"omega_p\": 19.0, \"eps_inf\": 5.5,\n                       \"K_eh\": 0.95, \"theta\": 5.0, \"p_n\": 0.60}\n        },\n    ]\n\n    def calculate_ionization_potential(ks_params, common_params):\n        \"\"\"\n        Implements the 8-step algorithm to calculate the ionization potential.\n        \n        Args:\n            ks_params (dict): Dictionary with Kohn-Sham specific parameters (E_v_ks, E_c_ks, V_xc).\n            common_params (dict): Dictionary with parameters common to both PBE and HSE.\n            \n        Returns:\n            float: The calculated ionization potential in eV.\n        \"\"\"\n        # Unpack parameters\n        E_v_ks = ks_params[\"E_v_ks\"]\n        E_c_ks = ks_params[\"E_c_ks\"]\n        V_xc = ks_params[\"V_xc\"]\n        \n        Sigma_x = common_params[\"Sigma_x\"]\n        g = common_params[\"g\"]\n        omega_p = common_params[\"omega_p\"]\n        eps_inf = common_params[\"eps_inf\"]\n        K_eh = common_params[\"K_eh\"]\n        theta = common_params[\"theta\"]\n        p_n = common_params[\"p_n\"]\n\n        # Step 1  2: Compute Kohn-Sham band gap\n        E_g = E_c_ks - E_v_ks\n\n        # Step 3: Compute BSE-renormalized screening and effective coupling\n        if E_g == 0:\n            # Avoid division by zero, though not expected with given data\n            E_g = 1e-9 \n        eps_eff = eps_inf + K_eh / E_g\n        g_eff = g * (eps_inf / eps_eff)\n\n        # Step 4: Evaluate the correlation self-energy and its derivative\n        denom = omega_p - E_g\n        if denom == 0:\n            denom = 1e-9\n            \n        Sigma_c_val = - (g_eff**2) / denom\n        dSigma_c_dE_val = (g_eff**2) / (denom**2)\n\n        # Step 5: Compute the renormalization factor\n        Z_v = 1.0 / (1.0 - dSigma_c_dE_val)\n\n        # Step 6: Compute the quasiparticle VBM energy\n        Delta_x = Sigma_x - V_xc\n        E_v_qp = E_v_ks + Z_v * (Delta_x + Sigma_c_val)\n\n        # Step 7: Compute the vacuum level shift\n        theta_m2 = theta * 1e18\n        p_n_Cm = p_n * DEBYE_TO_CM\n        mu_s = theta_m2 * p_n_Cm\n        delta_phi = -mu_s / EPSILON_0  # in Volts\n        # For an electron, a shift of X Volts corresponds to an energy change of X eV\n        delta_phi_eV = delta_phi\n\n        # Step 8: Compute the ionization potential\n        I = delta_phi_eV - E_v_qp\n        \n        return I\n\n    results = []\n    for case_data in test_cases:\n        # Handle the nested structure in Case 2's HSE data\n        pbe_params = case_data[\"pbe\"]\n        hse_params_raw = case_data[\"hse\"]\n        common_params = case_data[\"common\"]\n\n        if isinstance(hse_params_raw.get(\"E_v_ks\"), dict):\n            # This is the nested structure from Case 2\n            hse_params = hse_params_raw[\"E_v_ks\"]\n        else:\n            hse_params = hse_params_raw\n\n        ip_pbe = calculate_ionization_potential(pbe_params, common_params)\n        ip_hse = calculate_ionization_potential(hse_params, common_params)\n        delta = ip_hse - ip_pbe\n        \n        results.append([\n            round(ip_pbe, 3),\n            round(ip_hse, 3),\n            round(delta, 3)\n        ])\n\n    # Format the final output string exactly as required.\n    formatted_sublists = []\n    for sublist in results:\n        # Using f-strings to ensure three decimal places in the output string\n        formatted_sublists.append(f\"[{sublist[0]:.3f},{sublist[1]:.3f},{sublist[2]:.3f}]\")\n    \n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}