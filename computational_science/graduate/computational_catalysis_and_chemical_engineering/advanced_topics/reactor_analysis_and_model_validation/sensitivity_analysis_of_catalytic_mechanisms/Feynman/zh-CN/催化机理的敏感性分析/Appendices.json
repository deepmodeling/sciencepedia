{
    "hands_on_practices": [
        {
            "introduction": "灵敏度分析的核心在于理解系统的状态如何响应其参数的微小变化。为了掌握这一概念，我们从最基础的表面科学模型——Langmuir等温线入手。这个练习将指导您在一个理想化的吸附-解吸平衡体系中，推导空位分数对吸附平衡常数的局部灵敏度系数，并用它来量化微扰带来的影响。通过这个基础实践，您将为后续更复杂的动力学系统分析奠定坚实的数学基础。",
            "id": "3899027",
            "problem": "使用单一位点 Langmuir 吸附模型来描述气相物质 $A$ 在具有均匀位点的催化剂表面上的吸附。吸附反应为 $A(g) + * \\rightleftharpoons A*$，其中 $*$ 表示一个空位点，$A*$ 表示一个被吸附的物质。假设在固定温度下吸附处于准平衡状态，因此表面覆盖度满足 $ \\theta_{A} = K_{A}\\, c_{A}\\, \\theta_{*}$，其中 $K_{A}$ 是吸附平衡常数，$c_{A}$ 是 $A$ 的气相摩尔浓度。位点平衡为 $ \\theta_{*} + \\theta_{A} = 1$，所有覆盖度均为总位点的分数。考虑在固定气体浓度下，自由位点分数对吸附平衡常数的局部静态灵敏度，定义为 $S_{K} \\equiv \\left.\\frac{\\partial \\theta_{*}}{\\partial K_{A}}\\right|_{c_{A}}$。\n\n仅从上面给出的位点平衡和准平衡关系出发，推导 $S_{K}$ 关于 $K_{A}$ 和 $c_{A}$ 的解析表达式。然后，在固定 $c_{A}$ 的情况下，使用一阶微扰近似 $\\Delta \\theta_{*} \\approx S_{K}\\, \\Delta K_{A}$，评估当吸附平衡常数从 $K_{A}$ 小幅增加到 $K_{A} + \\Delta K_{A}$ 时自由位点分数的变化。使用以下参数值：$c_{A} = 2.0\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}$，$K_{A} = 5.0\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}$，以及 $\\Delta K_{A} = 0.10\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}$。将 $\\Delta \\theta_{*}$ 的最终数值结果四舍五入到四位有效数字。将最终答案表示为无量纲量。",
            "solution": "该问题经验证具有科学依据，提法恰当，客观且一致。这是化学反应工程中关于 Langmuir 吸附模型灵敏度分析的一个标准练习。没有可识别的缺陷。\n\n该问题为单一位点 Langmuir 吸附过程提供了以下关系式：\n1. 准平衡关系：$\\theta_{A} = K_{A}\\, c_{A}\\, \\theta_{*}$\n2. 位点平衡：$\\theta_{*} + \\theta_{A} = 1$\n\n此处，$\\theta_{A}$ 是物质 $A$ 的分数表面覆盖度，$\\theta_{*}$ 是空位点的分数表面覆盖度（自由位点分数），$K_{A}$ 是吸附平衡常数，$c_{A}$ 是 $A$ 的气相浓度。\n\n第一步是推导自由位点分数 $\\theta_{*}$ 关于独立参数 $K_{A}$ 和 $c_{A}$ 的显式表达式。我们可以将第一个方程代入第二个方程以消去 $\\theta_{A}$：\n$$\n\\theta_{*} + (K_{A}\\, c_{A}\\, \\theta_{*}) = 1\n$$\n从左侧提取公因式 $\\theta_{*}$ 可得：\n$$\n\\theta_{*} (1 + K_{A}\\, c_{A}) = 1\n$$\n求解 $\\theta_{*}$ 可得到著名的 Langmuir 等温线表达式，用于表示空位点分数：\n$$\n\\theta_{*} = \\frac{1}{1 + K_{A}\\, c_{A}}\n$$\n问题要求计算自由位点分数对吸附平衡常数的局部静态灵敏度，其定义为：\n$$\nS_{K} \\equiv \\left.\\frac{\\partial \\theta_{*}}{\\partial K_{A}}\\right|_{c_{A}}\n$$\n为了求得此值，我们将 $\\theta_{*}$ 的表达式对 $K_{A}$ 求导，并将 $c_{A}$ 视为常数。使用链式法则求导，具体为 $\\frac{d}{dx}(u^{-1}) = -u^{-2} \\frac{du}{dx}$，其中 $u = 1 + K_{A}\\, c_{A}$：\n$$\n\\frac{\\partial u}{\\partial K_{A}} = \\frac{\\partial}{\\partial K_{A}}(1 + K_{A}\\, c_{A}) = c_{A}\n$$\n因此，导数为：\n$$\nS_{K} = \\frac{\\partial}{\\partial K_{A}} \\left( (1 + K_{A}\\, c_{A})^{-1} \\right) = -1 \\cdot (1 + K_{A}\\, c_{A})^{-2} \\cdot \\frac{\\partial}{\\partial K_{A}}(1 + K_{A}\\, c_{A})\n$$\n$$\nS_{K} = -(1 + K_{A}\\, c_{A})^{-2} \\cdot c_{A}\n$$\n这给出了灵敏度的最终解析表达式：\n$$\nS_{K} = -\\frac{c_{A}}{(1 + K_{A}\\, c_{A})^{2}}\n$$\n问题的第二部分要求我们使用一阶微扰近似来估计由于平衡常数的微小变化 $\\Delta K_{A}$ 引起的自由位点分数的变化 $\\Delta \\theta_{*}$。该近似式如下：\n$$\n\\Delta \\theta_{*} \\approx S_{K}\\, \\Delta K_{A}\n$$\n代入我们推导出的 $S_{K}$ 表达式：\n$$\n\\Delta \\theta_{*} \\approx \\left(-\\frac{c_{A}}{(1 + K_{A}\\, c_{A})^{2}}\\right) \\Delta K_{A}\n$$\n现在，我们将给定的数值代入此表达式：\n$c_{A} = 2.0\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}$\n$K_{A} = 5.0\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}$\n$\\Delta K_{A} = 0.10\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}$\n\n首先，我们计算无量纲乘积 $K_{A}\\, c_{A}$：\n$$\nK_{A}\\, c_{A} = (5.0\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}) \\times (2.0\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}) = 10.0\n$$\n接下来，我们将此值代入 $\\Delta \\theta_{*}$ 的表达式中：\n$$\n\\Delta \\theta_{*} \\approx \\left(-\\frac{2.0}{(1 + 10.0)^{2}}\\right) \\times 0.10\n$$\n$$\n\\Delta \\theta_{*} \\approx \\left(-\\frac{2.0}{(11.0)^{2}}\\right) \\times 0.10\n$$\n$$\n\\Delta \\theta_{*} \\approx \\left(-\\frac{2.0}{121}\\right) \\times 0.10\n$$\n$$\n\\Delta \\theta_{*} \\approx -\\frac{0.20}{121}\n$$\n进行最后的除法运算：\n$$\n\\Delta \\theta_{*} \\approx -0.00165289256...\n$$\n问题要求将结果四舍五入到四位有效数字。前四位有效数字是 $1$、$6$、$5$ 和 $2$。第五位数字是 $8$，大于或等于 $5$，因此我们将第四位数字向上取整。\n$$\n\\Delta \\theta_{*} \\approx -0.001653\n$$\n该结果是无量纲的，这对于分数覆盖度的变化是符合预期的。负号在物理上是一致的，因为吸附平衡常数（$K_A$）的增加意味着更强的吸附，从而导致自由位点分数（$\\theta_*$）的减少。",
            "answer": "$$\n\\boxed{-0.001653}\n$$"
        },
        {
            "introduction": "在掌握了平衡态模型后，我们将转向更为普适和强大的微观动力学建模方法——稳态近似。在实际催化过程中，催化剂表面常存在“休眠”物种，如催化剂毒物或非反应性中间体，它们会占据活性位点，从而影响整体的转换频率（TOF）。本练习将引导您在一个包含休眠物种的稳态微观动力学模型中，运用归一化灵敏度分析来量化其影响，并揭示灵敏度与该物种表面覆盖率之间简洁而深刻的物理联系。",
            "id": "3899011",
            "problem": "考虑一个非均相催化微观动力学机理，该机理包含一个空的表面位点、一个吸附的反应物和一个可以可逆地占据活性位点的休眠中间体。气相反应物表示为 $R$，产物为 $P$，休眠物种为 $D$，空位点表示为 $*$（表面位点）。假设理想的质量作用动力学、等温等压条件、均匀的表面和准静态稳态。反应步骤如下：\n（1）$R(g) + * \\rightleftharpoons R*$，吸附速率常数为 $k_{R,ads}$（单位：$\\mathrm{Pa^{-1}\\,s^{-1}}$），解吸速率常数为 $k_{R,des}$（单位：$\\mathrm{s^{-1}}$），反应物分压为 $p_R$（单位：$\\mathrm{Pa}$）。\n（2）$R* \\rightarrow P(g) + *$，表面反应速率常数为 $k_{rxn}$（单位：$\\mathrm{s^{-1}}$）。\n（3）$D(g) + * \\rightleftharpoons D*$，吸附速率常数为 $k_{D,ads}$（单位：$\\mathrm{Pa^{-1}\\,s^{-1}}$），解吸速率常数为 $k_{D,des}$（单位：$\\mathrm{s^{-1}}$），休眠物种分压为 $p_D$（单位：$\\mathrm{Pa}$）。\n\n令分数覆盖度为 $\\theta_*$、$\\theta_R$ 和 $\\theta_D$，并假设位点平衡为 $\\theta_* + \\theta_R + \\theta_D = 1$。由质量作用动力学控制的常微分方程（ODE）系统是根据每一步的净速率构建的，稳态条件要求所有分数覆盖度的时间导数都等于 $0$。转换频率（TOF）是每个位点的产物生成速率，定义为 $TOF = k_{rxn}\\,\\theta_R$，单位为 $\\mathrm{s^{-1}}$。\n\n从位点平衡和质量作用动力学出发，推导稳态分数覆盖度，并用参数表示 $TOF$。定义关于休眠中间体 $D$ 可逆吸附和解吸的一阶归一化灵敏度系数为\n$S_{k_{D,ads}} = \\dfrac{k_{D,ads}}{TOF}\\,\\dfrac{\\partial\\,TOF}{\\partial\\,k_{D,ads}}$ 和 $S_{k_{D,des}} = \\dfrac{k_{D,des}}{TOF}\\,\\dfrac{\\partial\\,TOF}{\\partial\\,k_{D,des}}$。\n您必须在稳态下，基于所述的动力学假设，得到这些灵敏度的闭式表达式。\n\n实现一个程序，对于下面列出的参数集，计算并为每个集合返回三元组 $[TOF, S_{k_{D,ads}}, S_{k_{D,des}}]$，其中 $TOF$ 的单位是 $\\mathrm{s^{-1}}$，灵敏度是表示为小数的无量纲实数。数学推导必须遵循所述的基本原理，并且不得引用任何不能从所提供的动力学方案中直接推导出的公式。\n\n使用以下测试套件（所有量均为正实数，单位已标明）：\n\n测试用例1（一般情况）：\n$p_R = 10^5$ $\\mathrm{Pa}$，$p_D = 2\\times 10^4$ $\\mathrm{Pa}$，$k_{R,ads} = 10^{-5}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{R,des} = 0.5$ $\\mathrm{s^{-1}}$，$k_{rxn} = 5$ $\\mathrm{s^{-1}}$，$k_{D,ads} = 5\\times 10^{-6}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{D,des} = 0.1$ $\\mathrm{s^{-1}}$。\n\n测试用例2（休眠物种快速解吸的边界情况）：\n$p_R = 10^5$ $\\mathrm{Pa}$，$p_D = 2\\times 10^4$ $\\mathrm{Pa}$，$k_{R,ads} = 10^{-5}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{R,des} = 0.5$ $\\mathrm{s^{-1}}$，$k_{rxn} = 5$ $\\mathrm{s^{-1}}$，$k_{D,ads} = 5\\times 10^{-6}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{D,des} = 100$ $\\mathrm{s^{-1}}$。\n\n测试用例3（休眠物种强阻塞的边缘情况）：\n$p_R = 10^5$ $\\mathrm{Pa}$，$p_D = 5\\times 10^4$ $\\mathrm{Pa}$，$k_{R,ads} = 10^{-5}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{R,des} = 0.5$ $\\mathrm{s^{-1}}$，$k_{rxn} = 5$ $\\mathrm{s^{-1}}$，$k_{D,ads} = 2\\times 10^{-5}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{D,des} = 0.05$ $\\mathrm{s^{-1}}$。\n\n测试用例4（休眠物种分压可忽略的边缘情况）：\n$p_R = 5\\times 10^4$ $\\mathrm{Pa}$，$p_D = 10$ $\\mathrm{Pa}$，$k_{R,ads} = 5\\times 10^{-6}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{R,des} = 2$ $\\mathrm{s^{-1}}$，$k_{rxn} = 5$ $\\mathrm{s^{-1}}$，$k_{D,ads} = 10^{-5}$ $\\mathrm{Pa^{-1}\\,s^{-1}}$，$k_{D,des} = 1$ $\\mathrm{s^{-1}}$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，不含空格。结果必须按以下顺序展开：$[TOF_1, S_{k_{D,ads},1}, S_{k_{D,des},1}, TOF_2, S_{k_{D,ads},2}, S_{k_{D,des},2}, TOF_3, S_{k_{D,ads},3}, S_{k_{D,des},3}, TOF_4, S_{k_{D,ads},4}, S_{k_{D,des},4}]$。",
            "solution": "该问题在科学和数学上是适定的，提供了所有必要信息，以便基于化学动力学的基本原理推导出唯一解。我们将着手进行推导。\n\n该系统由一个均匀表面上催化反应的三个基元步骤描述：\n(1) 反应物 $R$ 的可逆吸附：$R(g) + * \\rightleftharpoons R*$\n(2) 不可逆的表面反应：$R* \\rightarrow P(g) + *$\n(3) 休眠物种 $D$ 的可逆吸附：$D(g) + * \\rightleftharpoons D*$\n\n系统处于稳态，意味着所有表面覆盖度的时间导数均为零。空位点（$*$）、吸附的反应物（$R*$）和休眠物种（$D*$）的分数覆盖度分别表示为 $\\theta_*$、$\\theta_R$ 和 $\\theta_D$。它们受位点平衡方程的约束：\n$$\n\\theta_* + \\theta_R + \\theta_D = 1\n$$\n\n首先，我们根据质量作用动力学为每个基元步骤构建速率表达式：\n- $R$ 吸附速率（正向步骤1）：$r_{+1} = k_{R,ads} p_R \\theta_*$\n- $R$ 解吸速率（逆向步骤1）：$r_{-1} = k_{R,des} \\theta_R$\n- 表面反应速率（正向步骤2）：$r_{+2} = k_{rxn} \\theta_R$\n- $D$ 吸附速率（正向步骤3）：$r_{+3} = k_{D,ads} p_D \\theta_*$\n- $D$ 解吸速率（逆向步骤3）：$r_{-3} = k_{D,des} \\theta_D$\n\n吸附物种 $R*$ 和 $D*$ 覆盖度的净变化率由以下公式给出：\n$$\n\\frac{d\\theta_R}{dt} = r_{+1} - r_{-1} - r_{+2} = k_{R,ads} p_R \\theta_* - k_{R,des} \\theta_R - k_{rxn} \\theta_R\n$$\n$$\n\\frac{d\\theta_D}{dt} = r_{+3} - r_{-3} = k_{D,ads} p_D \\theta_* - k_{D,des} \\theta_D\n$$\n\n在稳态假设下，这些时间导数为零：\n$$\nk_{R,ads} p_R \\theta_* - (k_{R,des} + k_{rxn}) \\theta_R = 0 \\quad (I)\n$$\n$$\nk_{D,ads} p_D \\theta_* - k_{D,des} \\theta_D = 0 \\quad (II)\n$$\n\n从这两个方程，我们可以用空位点覆盖度 $\\theta_*$ 来表示 $\\theta_R$ 和 $\\theta_D$：\n从 $(I)$：\n$$\n\\theta_R = \\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}} \\theta_*\n$$\n从 $(II)$：\n$$\n\\theta_D = \\frac{k_{D,ads} p_D}{k_{D,des}} \\theta_*\n$$\n\n现在，我们将这些表达式代入位点平衡方程 $\\theta_* + \\theta_R + \\theta_D = 1$：\n$$\n\\theta_* + \\left(\\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}}\\right) \\theta_* + \\left(\\frac{k_{D,ads} p_D}{k_{D,des}}\\right) \\theta_* = 1\n$$\n\n提取公因式 $\\theta_*$ 得：\n$$\n\\theta_* \\left(1 + \\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}} + \\frac{k_{D,ads} p_D}{k_{D,des}}\\right) = 1\n$$\n\n解出 $\\theta_*$：\n$$\n\\theta_* = \\frac{1}{1 + \\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}} + \\frac{k_{D,ads} p_D}{k_{D,des}}}\n$$\n\n转换频率（$TOF$）定义为每个位点的产物生成速率，对应于表面反应步骤的速率：$TOF = r_{+2} = k_{rxn} \\theta_R$。代入用 $\\theta_*$ 表示的 $\\theta_R$ 表达式：\n$$\nTOF = k_{rxn} \\left(\\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}}\\right) \\theta_*\n$$\n代入 $\\theta_*$ 的表达式：\n$$\nTOF = k_{rxn} \\frac{\\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}}}{1 + \\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}} + \\frac{k_{D,ads} p_D}{k_{D,des}}}\n$$\n这就是 $TOF$ 的闭式表达式。为简化后续推导，我们定义两个无量纲组：\n$$\nA = \\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}}\n$$\n$$\nB = \\frac{k_{D,ads} p_D}{k_{D,des}}\n$$\n覆盖度和 $TOF$ 可以紧凑地写为：\n$$\n\\theta_* = \\frac{1}{1 + A + B}\n$$\n$$\n\\theta_R = A \\theta_* = \\frac{A}{1 + A + B}\n$$\n$$\n\\theta_D = B \\theta_* = \\frac{B}{1 + A + B}\n$$\n$$\nTOF = k_{rxn} \\theta_R = k_{rxn} \\frac{A}{1 + A + B}\n$$\n\n接下来，我们推导一阶归一化灵敏度系数。通用定义为 $S_x = \\frac{x}{y} \\frac{\\partial y}{\\partial x} = \\frac{\\partial \\ln y}{\\partial \\ln x}$。\n\n**关于 $k_{D,ads}$ 的灵敏度：**\n灵敏度系数为 $S_{k_{D,ads}} = \\frac{k_{D,ads}}{TOF} \\frac{\\partial TOF}{\\partial k_{D,ads}}$。\n我们可以通过对数导数更方便地求解：$S_{k_{D,ads}} = \\frac{\\partial \\ln(TOF)}{\\partial \\ln(k_{D,ads})}$。\n$$\n\\ln(TOF) = \\ln(k_{rxn}) + \\ln(A) - \\ln(1+A+B)\n$$\n由于 $A$ 不依赖于 $k_{D,ads}$，且 $B$ 与 $k_{D,ads}$ 成正比（即 $\\frac{\\partial \\ln B}{\\partial \\ln k_{D,ads}} = 1$），我们有：\n$$\nS_{k_{D,ads}} = 0 + 0 - \\frac{\\partial \\ln(1+A+B)}{\\partial \\ln k_{D,ads}} = -\\frac{1}{1+A+B} \\frac{\\partial (1+A+B)}{\\partial \\ln k_{D,ads}} = -\\frac{1}{1+A+B} \\frac{\\partial B}{\\partial \\ln k_{D,ads}}\n$$\n$$\nS_{k_{D,ads}} = -\\frac{1}{1+A+B} \\left( \\frac{\\partial B}{\\partial \\ln B} \\frac{\\partial \\ln B}{\\partial \\ln k_{D,ads}} \\right) = -\\frac{B}{1+A+B}\n$$\n认识到 $\\theta_D = \\frac{B}{1+A+B}$，我们得到一个简洁的结果：\n$$\nS_{k_{D,ads}} = -\\theta_D\n$$\n\n**关于 $k_{D,des}$ 的灵敏度：**\n灵敏度系数为 $S_{k_{D,des}} = \\frac{\\partial \\ln(TOF)}{\\partial \\ln(k_{D,des})}$。\n由于 $B$ 与 $k_{D,des}$ 成反比（即 $\\frac{\\partial \\ln B}{\\partial \\ln k_{D,des}} = -1$），我们有：\n$$\nS_{k_{D,des}} = -\\frac{1}{1+A+B} \\frac{\\partial B}{\\partial \\ln k_{D,des}} = -\\frac{1}{1+A+B} \\left( \\frac{\\partial B}{\\partial \\ln B} \\frac{\\partial \\ln B}{\\partial \\ln k_{D,des}} \\right)\n$$\n$$\nS_{k_{D,des}} = -\\frac{B}{1+A+B} (-1) = \\frac{B}{1+A+B}\n$$\n再次认识到 $\\theta_D$ 的表达式：\n$$\nS_{k_{D,des}} = \\theta_D\n$$\n注意到 $S_{k_{D,ads}} + S_{k_{D,des}} = 0$，这是在控制位点可用性的准平衡步骤中，参数以比率形式出现的典型特征。\n\n所需的计算将使用这些推导出的闭式表达式以编程方式实现。\n用于实现的公式总结：\n1. $A = \\frac{k_{R,ads} p_R}{k_{R,des} + k_{rxn}}$\n2. $B = \\frac{k_{D,ads} p_D}{k_{D,des}}$\n3. $TOF = k_{rxn} \\frac{A}{1 + A + B}$\n4. $\\theta_D = \\frac{B}{1 + A + B}$\n5. $S_{k_{D,ads}} = -\\theta_D$\n6. $S_{k_{D,des}} = \\theta_D$",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Turnover Frequency (TOF) and sensitivity coefficients \n    for a given microkinetic model under steady-state conditions.\n    \"\"\"\n\n    # Test cases as provided in the problem statement.\n    # Each tuple contains: \n    # (p_R, p_D, k_R_ads, k_R_des, k_rxn, k_D_ads, k_D_des)\n    test_cases = [\n        # Test case 1 (general case)\n        (1e5, 2e4, 1e-5, 0.5, 5.0, 5e-6, 0.1),\n        # Test case 2 (boundary with fast dormant desorption)\n        (1e5, 2e4, 1e-5, 0.5, 5.0, 5e-6, 100.0),\n        # Test case 3 (edge with strong dormant blocking)\n        (1e5, 5e4, 1e-5, 0.5, 5.0, 2e-5, 0.05),\n        # Test case 4 (edge with negligible dormant partial pressure)\n        (5e4, 10.0, 5e-6, 2.0, 5.0, 1e-5, 1.0)\n    ]\n\n    def calculate_metrics(p_R, p_D, k_R_ads, k_R_des, k_rxn, k_D_ads, k_D_des):\n        \"\"\"\n        Calculates TOF and sensitivities based on the derived closed-form expressions.\n\n        Args:\n            p_R (float): Partial pressure of reactant R (Pa).\n            p_D (float): Partial pressure of dormant species D (Pa).\n            k_R_ads (float): Adsorption rate constant for R (Pa^-1 s^-1).\n            k_R_des (float): Desorption rate constant for R (s^-1).\n            k_rxn (float): Surface reaction rate constant (s^-1).\n            k_D_ads (float): Adsorption rate constant for D (Pa^-1 s^-1).\n            k_D_des (float): Desorption rate constant for D (s^-1).\n\n        Returns:\n            tuple: A tuple containing (TOF, S_k_Dads, S_k_Ddes).\n        \"\"\"\n        \n        # Calculate the dimensionless groups A and B from the derivation.\n        # A relates to the reactant R*.\n        # B relates to the dormant species D*.\n        A = (k_R_ads * p_R) / (k_R_des + k_rxn)\n        B = (k_D_ads * p_D) / k_D_des\n        \n        # Common denominator for all coverage expressions.\n        denominator = 1.0 + A + B\n        \n        # Calculate the Turnover Frequency (TOF = k_rxn * theta_R)\n        # where theta_R = A / (1 + A + B)\n        tof = k_rxn * (A / denominator)\n        \n        # Calculate the steady-state coverage of the dormant species, theta_D.\n        # theta_D = B / (1 + A + B)\n        theta_D = B / denominator\n        \n        # The sensitivity coefficients are directly related to theta_D.\n        # S_k_Dads = -theta_D\n        # S_k_Ddes = theta_D\n        s_k_D_ads = -theta_D\n        s_k_D_des = theta_D\n        \n        return tof, s_k_D_ads, s_k_D_des\n\n    # A flattened list to store all results in the required order.\n    results = []\n    \n    for case in test_cases:\n        tof, s_k_D_ads, s_k_D_des = calculate_metrics(*case)\n        results.extend([tof, s_k_D_ads, s_k_D_des])\n\n    # Format the final output as a comma-separated list within square brackets.\n    # The map(str, ...) ensures all numbers are converted to their string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "最终，任何动力学分析都应回归到最基本的参数层面，即构成速率常数的Arrhenius参数：指前因子$A_i$和活化能$E_i$。理解催化循环对这些基本参数的灵敏度，对于指导实验（哪些参数需要更精确的测量？）和催化剂设计（应针对性地调控哪个活化能或指前因子？）至关重要。这项综合性练习将引导您构建一个完整微观动力学模型的灵敏度向量，并探索其随温度的变化规律，这正是现代计算催化领域中一项标准且强大的分析技术。",
            "id": "3899057",
            "problem": "考虑一个单活性位点微观动力学模型，用于描述一个包含吸附、脱附和表面反应等基元步骤的多相催化转化过程。这些步骤如下\n- 吸附: $A(g) + * \\xrightarrow{k_{1f}} A*$，\n- 脱附: $A* \\xrightarrow{k_{1r}} A(g) + *$，\n- 表面反应: $A* \\xrightarrow{k_{2}} P(g) + *$，\n其中 $*$ 表示一个空位点，$A*$ 是吸附的反应物，$P(g)$ 是气相产物。速率常数遵循阿伦尼乌斯定律 $k_i(T) = A_i \\exp(-E_i/(R T))$，其中 $A_i$ 是指前因子，$E_i$ 是活化能，$T$ 是绝对温度，$R$ 是普适气体常数。吸附步骤对气相反应物 $A$ 是一级反应，其吸附速率为 $r_{1f} = k_{1f}(T) \\, p_A \\, \\theta_*$，脱附速率为 $r_{1r} = k_{1r}(T) \\, \\theta_A$，表面反应速率为 $r_2 = k_2(T) \\, \\theta_A$。此处，$p_A$ 是 $A$ 的分压，$\\theta_A$ 是 $A*$ 的分数覆盖度，$\\theta_* = 1 - \\theta_A$ 是空位点分数。假设理想气体行为以及恒定 $p_A$ 下的等温、等压条件。转换频率 (TOF) 定义为每个位点上的稳态产物生成速率，即 $\\mathrm{TOF}(T) = $ 在稳态下计算的 $r_2$。\n\n您的任务是：\n- 从上述基本定义（质量作用动力学、位点平衡 $\\theta_* + \\theta_A = 1$ 以及由 $d\\theta_A/dt = 0$ 定义的稳态）出发，推导 $\\mathrm{TOF}(T)$ 关于 $k_{1f}(T)$、$k_{1r}(T)$、$k_2(T)$ 和 $p_A$ 的表达式。\n- 对每个阿伦尼乌斯参数 $p \\in \\{A_{1f}, A_{1r}, A_2, E_{1f}, E_{1r}, E_2\\}$，计算由下式定义的转换频率的归一化灵敏度\n$$\nS_p^{\\mathrm{TOF}}(T) \\equiv \\frac{p}{\\mathrm{TOF}(T)} \\, \\frac{\\partial \\, \\mathrm{TOF}(T)}{\\partial p}.\n$$\n- 对于下面测试套件中的每组参数，在指定的参考温度 $T_{\\mathrm{ref}}$ 下，构建对所有阿伦尼乌斯参数 $\\{A_i, E_i\\}$ 的归一化灵敏度向量，其顺序为 $\\big[S_{A_{1f}}^{\\mathrm{TOF}}(T_{\\mathrm{ref}}), S_{A_{1r}}^{\\mathrm{TOF}}(T_{\\mathrm{ref}}), S_{A_{2}}^{\\mathrm{TOF}}(T_{\\mathrm{ref}}), S_{E_{1f}}^{\\mathrm{TOF}}(T_{\\mathrm{ref}}), S_{E_{1r}}^{\\mathrm{TOF}}(T_{\\mathrm{ref}}), S_{E_{2}}^{\\mathrm{TOF}}(T_{\\mathrm{ref}})\\big]$。\n- 对每个测试用例，在指定的温度网格上计算与温度相关的灵敏度曲线 $S_{E_i}^{\\mathrm{TOF}}(T)$。\n\n所有计算必须使用：\n- 普适气体常数 $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$ (写作 $R = 8.314462618$ J/mol/K)。 \n- 以千焦/摩尔为单位提供的活化能必须转换为焦耳/摩尔，即乘以 $1000$。\n- 温度单位为开尔文。压力单位为帕斯卡。\n- 最终的灵敏度 $S_p^{\\mathrm{TOF}}(T)$ 是无量纲的，因此输出中无需单位。\n\n测试套件：\n- 用例 $1$：\n  - 参数：$A_{1f} = 1.0 \\times 10^5$ s$^{-1}$ Pa$^{-1}$，$E_{1f} = 0.0$ kJ/mol；$A_{1r} = 1.0 \\times 10^{13}$ s$^{-1}$，$E_{1r} = 60.0$ kJ/mol；$A_{2} = 5.0 \\times 10^{12}$ s$^{-1}$，$E_{2} = 80.0$ kJ/mol。\n  - 操作条件：$p_A = 1.0 \\times 10^5$ Pa；$T_{\\mathrm{ref}} = 700$ K；温度网格 $T \\in \\{500, 600, 700, 800, 900\\}$ K。\n- 用例 $2$：\n  - 参数：$A_{1f} = 5.0 \\times 10^4$ s$^{-1}$ Pa$^{-1}$，$E_{1f} = 10.0$ kJ/mol；$A_{1r} = 1.0 \\times 10^{12}$ s$^{-1}$，$E_{1r} = 50.0$ kJ/mol；$A_{2} = 1.0 \\times 10^{13}$ s$^{-1}$，$E_{2} = 110.0$ kJ/mol。\n  - 操作条件：$p_A = 2.0 \\times 10^5$ Pa；$T_{\\mathrm{ref}} = 650$ K；温度网格 $T \\in \\{450, 650, 850\\}$ K。\n- 用例 $3$：\n  - 参数：$A_{1f} = 2.0 \\times 10^5$ s$^{-1}$ Pa$^{-1}$，$E_{1f} = 20.0$ kJ/mol；$A_{1r} = 5.0 \\times 10^{12}$ s$^{-1}$，$E_{1r} = 70.0$ kJ/mol；$A_{2} = 8.0 \\times 10^{12}$ s$^{-1}$，$E_{2} = 90.0$ kJ/mol。\n  - 操作条件：$p_A = 5.0 \\times 10^4$ Pa；$T_{\\mathrm{ref}} = 800$ K；温度网格 $T \\in \\{600, 800, 1000\\}$ K。\n\n最终输出格式：\n- 对每个用例，生成一个包含两个元素的列表：\n  1. 在 $T_{\\mathrm{ref}}$ 下计算的 $6$ 个归一化灵敏度的有序向量：$\\big[S_{A_{1f}}, S_{A_{1r}}, S_{A_{2}}, S_{E_{1f}}, S_{E_{1r}}, S_{E_{2}}\\big]$。\n  2. 一个长度等于网格温度数量的列表，其中每个元素是在相应网格温度下计算的三个与温度相关的灵敏度 $\\big[S_{E_{1f}}(T), S_{E_{1r}}(T), S_{E_{2}}(T)\\big]$ 的列表，按所给顺序排列。\n- 将三个用例的结果汇总到一个外部列表中。您的程序应生成一行输出，其中包含这个汇总列表，编码为无空格的方括号、逗号分隔结构，例如：$[ [\\dots], [\\dots], [\\dots] ]$ 但不含空格。所有浮点数在打印前必须四舍五入到恰好 $8$ 位小数。\n\n答案规范：\n- 您的程序必须完全按照定义计算所要求的灵敏度，并按规定在单行上输出汇总列表。不应打印任何额外文本。",
            "solution": "该问题在科学上是适定且自洽的，为严谨求解提供了所有必要信息。我们首先推导转换频率 (TOF) 的解析表达式，然后推导归一化灵敏度的表达式。\n\n**1. 转换频率 (TOF) 的推导**\n\n所提出的微观动力学模型包含三个基元步骤：\n- 吸附: $A(g) + * \\xrightarrow{k_{1f}} A*$\n- 脱附: $A* \\xrightarrow{k_{1r}} A(g) + *$\n- 表面反应: $A* \\xrightarrow{k_{2}} P(g) + *$\n\n这些步骤的速率如下：\n- 吸附速率: $r_{1f} = k_{1f}(T) \\, p_A \\, \\theta_*$\n- 脱附速率: $r_{1r} = k_{1r}(T) \\, \\theta_A$\n- 表面反应速率: $r_2 = k_2(T) \\, \\theta_A$\n\n此处，$\\theta_A$ 是吸附物种 $A*$ 的分数覆盖度，$\\theta_*$ 是空位点的分数。总位点数是守恒的，从而得到位点平衡方程：\n$$ \\theta_A + \\theta_* = 1 \\implies \\theta_* = 1 - \\theta_A $$\n$A*$ 的表面覆盖度变化率由其生成步骤和消耗步骤的速率平衡给出：\n$$ \\frac{d\\theta_A}{dt} = r_{1f} - r_{1r} - r_2 $$\n代入速率表达式和位点平衡：\n$$ \\frac{d\\theta_A}{dt} = k_{1f} p_A (1 - \\theta_A) - k_{1r} \\theta_A - k_2 \\theta_A $$\n$$ \\frac{d\\theta_A}{dt} = k_{1f} p_A - (k_{1f} p_A + k_{1r} + k_2) \\theta_A $$\n该问题要求在稳态下进行分析，稳态的定义是所有表面中间体的净变化率为零。因此，我们设 $\\frac{d\\theta_A}{dt} = 0$：\n$$ 0 = k_{1f} p_A - (k_{1f} p_A + k_{1r} + k_2) \\theta_A $$\n求解稳态覆盖度 $\\theta_{A,ss}$：\n$$ \\theta_{A,ss} = \\frac{k_{1f} p_A}{k_{1f} p_A + k_{1r} + k_2} $$\n转换频率 (TOF) 定义为每个位点上的稳态产物生成速率。在此机理中，产物 $P(g)$ 仅在表面反应步骤中生成。因此，$\\mathrm{TOF} = $ 在稳态下计算的 $r_2$：\n$$ \\mathrm{TOF}(T) = k_2(T) \\, \\theta_{A,ss} $$\n代入 $\\theta_{A,ss}$ 的表达式：\n$$ \\mathrm{TOF}(T) = k_2 \\frac{k_{1f} p_A}{k_{1f} p_A + k_{1r} + k_2} $$\n该表达式表示了 TOF 作为速率常数（$k_{1f}$、$k_{1r}$、$k_2$）和分压 $p_A$ 的函数。温度依赖性通过阿伦尼乌斯定律 $k_i(T) = A_i \\exp(-E_i / (RT))$ 蕴含在速率常数中。\n\n**2. 归一化灵敏度的推导**\n\nTOF 相对于任一参数 $p$ 的归一化灵敏度定义为：\n$$ S_p^{\\mathrm{TOF}} \\equiv \\frac{p}{\\mathrm{TOF}} \\frac{\\partial \\, \\mathrm{TOF}}{\\partial p} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(p)} $$\n参数 $p$ 是阿伦尼乌斯参数 $\\{A_{1f}, A_{1r}, A_2, E_{1f}, E_{1r}, E_2\\}$。为了方便求导，我们先对 TOF 表达式取对数：\n$$ \\ln(\\mathrm{TOF}) = \\ln(k_2) + \\ln(k_{1f} p_A) - \\ln(k_{1f} p_A + k_{1r} + k_2) $$\n令 $D = k_{1f} p_A + k_{1r} + k_2$。\n\n首先，我们计算对指前因子 $A_i$ 的灵敏度。利用链式法则以及关系 $\\frac{\\partial \\ln k_i}{\\partial \\ln A_i} = 1$，我们得到 $S_{A_i}^{\\mathrm{TOF}} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(A_i)} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(k_i)}$。\n\n- **对 $A_{1f}$ 的灵敏度 ($S_{A_{1f}}^{\\mathrm{TOF}}$):**\n$$ S_{A_{1f}}^{\\mathrm{TOF}} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(k_{1f})} = \\frac{\\partial \\ln(k_{1f} p_A)}{\\partial \\ln(k_{1f})} - \\frac{\\partial \\ln(D)}{\\partial \\ln(k_{1f})} = 1 - \\frac{k_{1f}}{D} \\frac{\\partial D}{\\partial k_{1f}} = 1 - \\frac{k_{1f}}{D}(p_A) = \\frac{k_{1r} + k_2}{D} $$\n\n- **对 $A_{1r}$ 的灵敏度 ($S_{A_{1r}}^{\\mathrm{TOF}}$):**\n$$ S_{A_{1r}}^{\\mathrm{TOF}} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(k_{1r})} = 0 - \\frac{\\partial \\ln(D)}{\\partial \\ln(k_{1r})} = -\\frac{k_{1r}}{D} \\frac{\\partial D}{\\partial k_{1r}} = -\\frac{k_{1r}}{D} $$\n\n- **对 $A_2$ 的灵敏度 ($S_{A_2}^{\\mathrm{TOF}}$):**\n$$ S_{A_2}^{\\mathrm{TOF}} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(k_2)} = \\frac{\\partial \\ln(k_2)}{\\partial \\ln(k_2)} - \\frac{\\partial \\ln(D)}{\\partial \\ln(k_2)} = 1 - \\frac{k_2}{D} \\frac{\\partial D}{\\partial k_2} = 1 - \\frac{k_2}{D} = \\frac{k_{1f} p_A + k_{1r}}{D} $$\n\n我们可以通过求和来验证这些表达式的自洽性：\n$$ S_{A_{1f}}^{\\mathrm{TOF}} + S_{A_{1r}}^{\\mathrm{TOF}} + S_{A_2}^{\\mathrm{TOF}} = \\frac{k_{1r} + k_2}{D} - \\frac{k_{1r}}{D} + \\frac{k_{1f} p_A + k_{1r}}{D} = \\frac{(k_{1r} + k_2) - k_{1r} + (k_{1f} p_A + k_{1r})}{D} = \\frac{k_{1f} p_A + k_{1r} + k_2}{D} = 1 $$\n这个求和恒等式成立，为我们的推导提供了有力的验证。\n\n接下来，我们计算对活化能 $E_i$ 的灵敏度。再次使用链式法则，并利用关系 $\\frac{\\partial \\ln k_i}{\\partial \\ln E_i} = -\\frac{E_i}{RT}$：\n$$ S_{E_i}^{\\mathrm{TOF}} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(E_i)} = \\frac{\\partial \\ln(\\mathrm{TOF})}{\\partial \\ln(k_i)} \\frac{\\partial \\ln(k_i)}{\\partial \\ln(E_i)} = S_{A_i}^{\\mathrm{TOF}} \\cdot \\left(-\\frac{E_i}{RT}\\right) $$\n这给出了一个简洁的关系，将对活化能的灵敏度与对指前因子的灵敏度联系起来。\n\n**最终灵敏度表达式总结**\n令 $D(T) = k_{1f}(T) p_A + k_{1r}(T) + k_2(T)$，其中 $k_i(T) = A_i \\exp(-E_i / (RT))$。\n\n- $S_{A_{1f}}^{\\mathrm{TOF}}(T) = \\frac{k_{1r}(T) + k_2(T)}{D(T)}$\n- $S_{A_{1r}}^{\\mathrm{TOF}}(T) = -\\frac{k_{1r}(T)}{D(T)}$\n- $S_{A_2}^{\\mathrm{TOF}}(T) = \\frac{k_{1f}(T) p_A + k_{1r}(T)}{D(T)}$\n\n- $S_{E_{1f}}^{\\mathrm{TOF}}(T) = -\\frac{E_{1f}}{RT} S_{A_{1f}}^{\\mathrm{TOF}}(T) = -\\frac{E_{1f}}{RT} \\left( \\frac{k_{1r}(T) + k_2(T)}{D(T)} \\right)$\n- $S_{E_{1r}}^{\\mathrm{TOF}}(T) = -\\frac{E_{1r}}{RT} S_{A_{1r}}^{\\mathrm{TOF}}(T) = \\frac{E_{1r}}{RT} \\left( \\frac{k_{1r}(T)}{D(T)} \\right)$\n- $S_{E_2}^{\\mathrm{TOF}}(T) = -\\frac{E_2}{RT} S_{A_2}^{\\mathrm{TOF}}(T) = -\\frac{E_2}{RT} \\left( \\frac{k_{1f}(T) p_A + k_{1r}(T)}{D(T)} \\right)$\n\n这些是需要对给定测试用例进行数值实现的表达式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sensitivities for a microkinetic model of catalytic conversion.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.314462618\n\n    # Test suite from the problem statement\n    test_cases = [\n        {\n            \"params\": {\n                \"A1f\": 1.0e5, \"E1f\": 0.0,\n                \"A1r\": 1.0e13, \"E1r\": 60.0,\n                \"A2\": 5.0e12, \"E2\": 80.0\n            },\n            \"conditions\": {\n                \"pA\": 1.0e5,\n                \"T_ref\": 700,\n                \"T_grid\": [500, 600, 700, 800, 900]\n            }\n        },\n        {\n            \"params\": {\n                \"A1f\": 5.0e4, \"E1f\": 10.0,\n                \"A1r\": 1.0e12, \"E1r\": 50.0,\n                \"A2\": 1.0e13, \"E2\": 110.0\n            },\n            \"conditions\": {\n                \"pA\": 2.0e5,\n                \"T_ref\": 650,\n                \"T_grid\": [450, 650, 850]\n            }\n        },\n        {\n            \"params\": {\n                \"A1f\": 2.0e5, \"E1f\": 20.0,\n                \"A1r\": 5.0e12, \"E1r\": 70.0,\n                \"A2\": 8.0e12, \"E2\": 90.0\n            },\n            \"conditions\": {\n                \"pA\": 5.0e4,\n                \"T_ref\": 800,\n                \"T_grid\": [600, 800, 1000]\n            }\n        }\n    ]\n\n    def calculate_sensitivities(T, params, pA):\n        \"\"\"\n        Calculates the normalized sensitivities at a given temperature T.\n        \"\"\"\n        # Unpack parameters and convert energies from kJ/mol to J/mol\n        A1f, E1f = params[\"A1f\"], params[\"E1f\"] * 1000.0\n        A1r, E1r = params[\"A1r\"], params[\"E1r\"] * 1000.0\n        A2, E2 = params[\"A2\"], params[\"E2\"] * 1000.0\n        \n        # Denominator for Arrhenius exponential\n        RT = R * T\n        \n        # Calculate rate constants k_i(T) = A_i * exp(-E_i / RT)\n        k1f = A1f * np.exp(-E1f / RT) if RT > 0 else 0.0\n        k1r = A1r * np.exp(-E1r / RT) if RT > 0 else 0.0\n        k2 = A2 * np.exp(-E2 / RT) if RT > 0 else 0.0\n\n        # Denominator D from TOF expression\n        D = k1f * pA + k1r + k2\n        if D == 0: # Avoid division by zero\n            return [0.0] * 6, [0.0] * 3\n\n        # Sensitivities to pre-exponential factors (S_A)\n        # S_A1f = (k1r + k2) / D\n        # S_A1r = -k1r / D\n        # S_A2 = (k1f * pA + k1r) / D\n        S_A1f = (k1r + k2) / D\n        S_A1r = -k1r / D\n        S_A2 = (k1f * pA + k1r) / D\n        \n        # Sensitivities to activation energies (S_E)\n        # S_Ei = - (E_i / RT) * S_Ai\n        S_E1f = - (E1f / RT) * S_A1f if RT > 0 else 0.0\n        S_E1r = - (E1r / RT) * S_A1r if RT > 0 else 0.0\n        S_E2 = - (E2 / RT) * S_A2 if RT > 0 else 0.0\n        \n        sens_ref_vector = [S_A1f, S_A1r, S_A2, S_E1f, S_E1r, S_E2]\n        sens_energy_vector = [S_E1f, S_E1r, S_E2]\n        \n        return sens_ref_vector, sens_energy_vector\n\n    all_results = []\n    for case in test_cases:\n        params = case[\"params\"]\n        conditions = case[\"conditions\"]\n        pA = conditions[\"pA\"]\n        \n        # 1. Compute sensitivities at T_ref\n        sens_ref, _ = calculate_sensitivities(conditions[\"T_ref\"], params, pA)\n        \n        # 2. Compute energy sensitivities over the temperature grid\n        sens_grid = []\n        for T in conditions[\"T_grid\"]:\n            _, sens_energy = calculate_sensitivities(T, params, pA)\n            sens_grid.append(sens_energy)\n            \n        all_results.append([sens_ref, sens_grid])\n\n    # --- FORMATTING THE FINAL OUTPUT STRING ---\n    def format_float_list(flist):\n        return f\"[{','.join(f'{x:.8f}' for x in flist)}]\"\n\n    def format_nested_list(nlist):\n        return f\"[{','.join(format_float_list(sub) for sub in nlist)}]\"\n\n    case_strings = []\n    for case_result in all_results:\n        ref_str = format_float_list(case_result[0])\n        grid_str = format_nested_list(case_result[1])\n        case_strings.append(f\"[{ref_str},{grid_str}]\")\n    \n    final_output = f\"[{','.join(case_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}