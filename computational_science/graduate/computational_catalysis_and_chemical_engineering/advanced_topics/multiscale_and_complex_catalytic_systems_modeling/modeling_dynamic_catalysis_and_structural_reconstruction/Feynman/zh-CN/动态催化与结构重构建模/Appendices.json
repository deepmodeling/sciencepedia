{
    "hands_on_practices": [
        {
            "introduction": "本练习是一个基础性的解析推导。它演示了如何从数学上处理周期性变化的反应速率——这是动态催化中的常见情景。练习的目标是推导出一个精确的时间平均速率解析表达式，并揭示一个关键原理：由于阿伦尼乌斯方程的非线性，振荡条件下的平均速率不等于平均条件下的速率 。",
            "id": "3888723",
            "problem": "考虑动态催化中的一个单中心表面反应，其中基元步骤 $A^* \\rightarrow B^*$ 以瞬时一级速率 $r(t)$ 进行，其表达式为 $r(t) = k(t)\\,\\theta_A$。在此式中，$\\theta_A$ 是物种 $A^*$ 的恒定覆盖度，该覆盖度通过相对于反应和结构动力学过程而言快速的吸附-解吸过程来维持；$k(t)$ 是随时间变化的速率常数，它源于周期性结构重构对反应能垒的调制。假设速率常数为 $k(t) = k_0 \\exp\\left(-\\alpha \\sin(\\omega t)\\right)$，其中 $k_0 > 0$ 是一个基准速率常数，$\\alpha \\ge 0$ 是一个无量纲的调制振幅，它描述了能垒对结构坐标的敏感性，而 $\\omega > 0$ 是由外部刺激施加的结构调制的角频率。\n\n请仅使用微观动力学建模的第一性原理和周期函数的时间平均法，推导在长时间周期性稳态下的精确时间平均速率 $\\langle r \\rangle$。然后，确定在快调制极限（定义为 $\\omega \\rightarrow \\infty$）和慢调制极限（定义为 $\\omega \\rightarrow 0$）下，$\\langle r \\rangle$ 对 $\\alpha$ 和 $\\omega$ 的依赖关系。您可以假设平均是在整数个调制周期内进行的。请将您的最终答案表示为关于 $\\langle r \\rangle$ 的单个封闭形式解析表达式。无需四舍五入，最终表达式中也不需要单位。",
            "solution": "该问题陈述经评估是有效的，因为它具有科学依据、问题适定且客观。它为动态催化系统微观动力学建模中的一个标准问题提供了一个自洽且一致的框架。\n\n反应 $A^* \\rightarrow B^*$ 的瞬时速率由 $r(t) = k(t)\\,\\theta_A$ 给出。物种 $A^*$ 的覆盖度（记为 $\\theta_A$）是恒定的。速率常数 $k(t)$ 是一个时间周期函数，由 $k(t) = k_0 \\exp(-\\alpha \\sin(\\omega t))$ 给出，其中 $k_0$、$\\alpha$ 和 $\\omega$ 是正常数（$\\alpha \\ge 0$）。结构调制的周期，也就是速率常数 $k(t)$ 的周期，是 $T = \\frac{2\\pi}{\\omega}$。\n\n主要任务是推导在长时间周期性稳态下，单个周期内的时间平均速率 $\\langle r \\rangle$。周期函数 $f(t)$ 在其周期 $T$ 上的时间平均定义为：\n$$\n\\langle f \\rangle = \\frac{1}{T} \\int_{0}^{T} f(t) \\, dt\n$$\n将此定义应用于速率 $r(t)$：\n$$\n\\langle r \\rangle = \\frac{1}{T} \\int_{0}^{T} r(t) \\, dt = \\frac{1}{T} \\int_{0}^{T} k(t) \\theta_A \\, dt\n$$\n由于 $\\theta_A$ 定义为常数，可以将其从积分中提出：\n$$\n\\langle r \\rangle = \\theta_A \\left( \\frac{1}{T} \\int_{0}^{T} k(t) \\, dt \\right) = \\theta_A \\langle k(t) \\rangle\n$$\n现在，我们代入 $k(t)$ 及其周期 $T = \\frac{2\\pi}{\\omega}$ 的给定表达式：\n$$\n\\langle r \\rangle = \\theta_A \\left( \\frac{\\omega}{2\\pi} \\int_{0}^{2\\pi/\\omega} k_0 \\exp(-\\alpha \\sin(\\omega t)) \\, dt \\right)\n$$\n常数 $k_0$ 也可以被提出：\n$$\n\\langle r \\rangle = k_0 \\theta_A \\frac{\\omega}{2\\pi} \\int_{0}^{2\\pi/\\omega} \\exp(-\\alpha \\sin(\\omega t)) \\, dt\n$$\n为了求解该积分，我们进行变量替换。令 $u = \\omega t$，则 $du = \\omega \\, dt$。积分上下限分别从 $t=0$ 和 $t=2\\pi/\\omega$ 变为 $u=0$ 和 $u=2\\pi$。\n$$\n\\langle r \\rangle = k_0 \\theta_A \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\exp(-\\alpha \\sin(u)) \\, du\n$$\n此积分为第一类修正贝塞尔函数的一个著名积分表示。零阶（$n=0$）第一类修正贝塞尔函数（记为 $I_0(z)$）的定义为：\n$$\nI_0(z) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\exp(z \\cos\\theta) \\, d\\theta\n$$\n我们可以证明，涉及 $\\sin(u)$ 的积分等价于涉及 $\\cos(\\theta)$ 的积分。由于被积函数 $\\exp(-\\alpha \\sin(u))$ 具有 $2\\pi$ 周期性，我们可以平移积分区间而不改变积分的值。我们做替换 $u = \\theta + \\frac{\\pi}{2}$：\n$$\n\\int_{0}^{2\\pi} \\exp(-\\alpha \\sin(u)) \\, du = \\int_{-\\pi/2}^{3\\pi/2} \\exp\\left(-\\alpha \\sin\\left(\\theta + \\frac{\\pi}{2}\\right)\\right) \\, d\\theta = \\int_{-\\pi/2}^{3\\pi/2} \\exp(-\\alpha \\cos\\theta) \\, d\\theta\n$$\n由于被积函数 $\\exp(-\\alpha \\cos\\theta)$ 本身也是周期为 $2\\pi$ 的周期函数，我们可以在任何长度为 $2\\pi$ 的区间上积分，例如 $[0, 2\\pi]$：\n$$\n\\int_{-\\pi/2}^{3\\pi/2} \\exp(-\\alpha \\cos\\theta) \\, d\\theta = \\int_{0}^{2\\pi} \\exp(-\\alpha \\cos\\theta) \\, d\\theta\n$$\n因此，该积分变为：\n$$\n\\int_{0}^{2\\pi} \\exp(-\\alpha \\sin(u)) \\, du = \\int_{0}^{2\\pi} \\exp(-\\alpha \\cos\\theta) \\, d\\theta = 2\\pi I_0(-\\alpha)\n$$\n修正贝塞尔函数具有性质 $I_n(-z) = (-1)^n I_n(z)$。对于零阶（$n=0$），这简化为 $I_0(-z) = I_0(z)$。因此：\n$$\n\\int_{0}^{2\\pi} \\exp(-\\alpha \\sin(u)) \\, du = 2\\pi I_0(\\alpha)\n$$\n将此结果代回我们关于 $\\langle r \\rangle$ 的表达式中：\n$$\n\\langle r \\rangle = k_0 \\theta_A \\frac{1}{2\\pi} \\left( 2\\pi I_0(\\alpha) \\right)\n$$\n这就简化为时间平均速率的最终封闭形式表达式：\n$$\n\\langle r \\rangle = k_0 \\theta_A I_0(\\alpha)\n$$\n此表达式给出了对于任何有效参数集的精确时间平均速率。问题进一步要求确定在快（$\\omega \\rightarrow \\infty$）和慢（$\\omega \\rightarrow 0$）调制极限下，$\\langle r \\rangle$ 对 $\\alpha$ 和 $\\omega$ 的依赖关系。\n\n观察我们推导出的表达式，我们注意到时间平均速率 $\\langle r \\rangle$ 是 $k_0$、$\\theta_A$ 和 $\\alpha$ 的函数，但它完全独立于调制频率 $\\omega$。这是在整数个周期上进行平均的直接结果；周期的具体时长不影响周期函数的平均值。因此，对于所有 $\\omega > 0$，包括 $\\omega \\rightarrow \\infty$ 和 $\\omega \\rightarrow 0$ 的极限情况，$\\langle r \\rangle$ 对参数的依赖关系是相同的。\n\n在快调制和慢调制极限下，依赖关系如下：\n1.  时间平均速率 $\\langle r \\rangle$ 与角频率 $\\omega$ 无关。\n2.  时间平均速率 $\\langle r \\rangle$ 通过零阶第一类修正贝塞尔函数 $I_0(\\alpha)$ 依赖于调制振幅 $\\alpha$。由于对于所有实数 $\\alpha$ 都有 $I_0(\\alpha) \\ge 1$（且 $I_0(0)=1$），振荡的存在（$\\alpha > 0$）总会导致时间平均速率大于或等于没有调制时的速率 $k_0 \\theta_A$。这一现象是 Jensen 不等式应用于凸函数指数函数的结果。\n\n对于 $\\langle r \\rangle$ 的单个封闭形式解析表达式在所有指定条件下都保持为 $k_0 \\theta_A I_0(\\alpha)$。",
            "answer": "$$\n\\boxed{k_0 \\theta_A I_0(\\alpha)}\n$$"
        },
        {
            "introduction": "当分析更真实的催化系统时，我们常常需要处理多个相互耦合的过程，例如吸附和表面重构，这些过程的复杂性使得解析求解变得不可能。本练习要求你构建一个数值模拟程序，求解一组在外力驱动下的耦合常微分方程(ODEs)，从而学习如何找到系统的长期周期性稳态（即极限环），并计算循环平均性质 。这项实践对于模拟动态条件下催化剂的复杂响应至关重要。",
            "id": "3888647",
            "problem": "考虑一个可以在两种结构状态之间动态重构的催化表面，这两种状态表示为 $R_0$（未重构）和 $R_1$（已重构）。令 $x(t)$ 为时间 $t$ 时处于状态 $R_1$ 的表面分数，因此处于状态 $R_0$ 的分数为 $1 - x(t)$。一种吸附物种 $A$ 的气相分压 $p_A(t)$ 控制着表面上 $A$ 的覆盖度 $\\theta(t)$，而覆盖度反过来又调节 $R_0 \\rightleftharpoons R_1$ 的动力学过程。\n\n假设以下基于物理的定律：\n- 吸附和解吸遵循朗缪尔动力学与质量作用定律，因此覆盖度服从以下常微分方程 (ODE)：$$\\frac{d\\theta}{dt} = k_{\\mathrm{ads}}\\,p_A(t)\\,\\left(1-\\theta(t)\\right) - k_{\\mathrm{des}}\\,\\theta(t),$$ 其中 $k_{\\mathrm{ads}}$ 的单位是 $\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$，$k_{\\mathrm{des}}$ 的单位是 $\\mathrm{s}^{-1}$，$\\theta(t)$ 是无量纲的。\n- 重构和解构遵循具有覆盖度调节速率的一级相变：$$\\frac{dx}{dt} = k_{01}\\!\\left(\\theta(t)\\right)\\,\\left(1 - x(t)\\right) - k_{10}\\!\\left(\\theta(t)\\right)\\,x(t),$$ 其中 $k_{01}\\!\\left(\\theta\\right) = k_{01}^0\\,\\exp\\!\\left(\\alpha\\,\\theta\\right)$ 且 $k_{10}\\!\\left(\\theta\\right) = k_{10}^0\\,\\exp\\!\\left(-\\beta\\,\\theta\\right)$。此处 $k_{01}^0$ 和 $k_{10}^0$ 是基础速率常数，单位为 $\\mathrm{s}^{-1}$，$\\alpha$ 和 $\\beta$ 是无量纲参数，反映覆盖度如何稳定或破坏给定结构。\n\n设进料是分压 $p_A(t)$ 的方波强迫，周期为 $T$，占空比为 $d$：在每个持续时间为 $T$ 的周期内，$p_A(t)$ 在 $d T$ 秒内等于高值 $p_{\\mathrm{high}}$，在 $(1-d)T$ 秒内等于低值 $p_{\\mathrm{low}}$。假设系统是良好混合且等温的，并且除 $p_A(t)$ 外，所有参数均为常数。\n\n从初始条件 $\\theta(0) = 0$ 和 $x(0) = 0$ 开始，在方波强迫下模拟耦合的常微分方程，直到达到周期性稳态。周期性稳态定义为一个极限环，在该环中，一个周期开始时的状态与上一周期开始时的状态在小的数值容差范围内重复。在周期性稳态下，计算周期平均的重构分数：$$\\bar{x} = \\frac{1}{T}\\int_{t_0}^{t_0 + T} x(t)\\,dt,$$ 其中 $t_0$ 是极限环上一个周期的开始时间。每个测试最终报告的量是 $\\bar{x}$ 的无量纲十进制数值，四舍五入到六位小数。最终输出值中不应包含任何物理单位。\n\n设计并实现一个程序，使用常微分方程数值积分对以下参数集测试套件进行上述计算。下面所有数字都要求按其所述单位进行解释，所有符号定义如上。\n\n测试套件（每个案例为一组参数）：\n- 案例 1（平衡强迫，中等周期）：$k_{\\mathrm{ads}} = 5.0\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$，$k_{\\mathrm{des}} = 0.5\\,\\mathrm{s}^{-1}$，$k_{01}^0 = 0.2\\,\\mathrm{s}^{-1}$，$k_{10}^0 = 0.05\\,\\mathrm{s}^{-1}$，$\\alpha = 4.0$，$\\beta = 2.0$，$p_{\\mathrm{low}} = 0.1\\,\\mathrm{bar}$，$p_{\\mathrm{high}} = 1.0\\,\\mathrm{bar}$，$T = 2.0\\,\\mathrm{s}$，$d = 0.5$。\n- 案例 2（高频强迫）：$k_{\\mathrm{ads}} = 5.0\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$，$k_{\\mathrm{des}} = 0.5\\,\\mathrm{s}^{-1}$，$k_{01}^0 = 0.2\\,\\mathrm{s}^{-1}$，$k_{10}^0 = 0.05\\,\\mathrm{s}^{-1}$，$\\alpha = 4.0$，$\\beta = 2.0$，$p_{\\mathrm{low}} = 0.1\\,\\mathrm{bar}$，$p_{\\mathrm{high}} = 1.0\\,\\mathrm{bar}$，$T = 0.05\\,\\mathrm{s}$，$d = 0.5$。\n- 案例 3（低频强迫）：$k_{\\mathrm{ads}} = 5.0\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$，$k_{\\mathrm{des}} = 0.5\\,\\mathrm{s}^{-1}$，$k_{01}^0 = 0.2\\,\\mathrm{s}^{-1}$，$k_{10}^0 = 0.05\\,\\mathrm{s}^{-1}$，$\\alpha = 4.0$，$\\beta = 2.0$，$p_{\\mathrm{low}} = 0.1\\,\\mathrm{bar}$，$p_{\\mathrm{high}} = 1.0\\,\\mathrm{bar}$，$T = 10.0\\,\\mathrm{s}$，$d = 0.5$。\n- 案例 4（有偏占空比）：$k_{\\mathrm{ads}} = 5.0\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$，$k_{\\mathrm{des}} = 0.5\\,\\mathrm{s}^{-1}$，$k_{01}^0 = 0.2\\,\\mathrm{s}^{-1}$，$k_{10}^0 = 0.05\\,\\mathrm{s}^{-1}$，$\\alpha = 4.0$，$\\beta = 2.0$，$p_{\\mathrm{low}} = 0.1\\,\\mathrm{bar}$，$p_{\\mathrm{high}} = 1.0\\,\\mathrm{bar}$，$T = 2.0\\,\\mathrm{s}$，$d = 0.8$。\n\n算法要求：\n- 根据方波对 $p_A(t)$ 使用分段常数强迫，在长度为 $dT$ 和 $(1-d)T$ 的段上进行积分。\n- 迭代完整的周期，直到一个周期开始和结束时的状态之差的范数小于一个小的容差，从而确定周期性稳态。然后，通过对 $x(t)$ 进行数值积分，计算极限环上一个完整周期的 $\\bar{x}$。\n- 程序必须为所有四个案例生成结果，并将它们汇总到单行输出中，该输出包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_i$ 是案例 $i$ 的四舍五入后的小数值。\n\n答案格式和单位：\n- 以小数形式表示最终的重构分数值，四舍五入到六位小数，不带单位。",
            "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **状态变量：** $x(t)$（处于状态 $R_1$ 的表面分数）、$1 - x(t)$（处于状态 $R_0$ 的分数）和 $\\theta(t)$（吸附物覆盖度）。\n- **控制常微分方程 (ODE)：**\n  - $\\frac{d\\theta}{dt} = k_{\\mathrm{ads}}\\,p_A(t)\\,\\left(1-\\theta(t)\\right) - k_{\\mathrm{des}}\\,\\theta(t)$\n  - $\\frac{dx}{dt} = k_{01}\\!\\left(\\theta(t)\\right)\\,\\left(1 - x(t)\\right) - k_{10}\\!\\left(\\theta(t)\\right)\\,x(t)$\n- **速率表达式：**\n  - $k_{01}\\!\\left(\\theta\\right) = k_{01}^0\\,\\exp\\!\\left(\\alpha\\,\\theta\\right)$\n  - $k_{10}\\!\\left(\\theta\\right) = k_{10}^0\\,\\exp\\!\\left(-\\beta\\,\\theta\\right)$\n- **强迫函数 $p_A(t)$：** 周期为 $T$、占空比为 $d$ 的方波。\n  - 在 $d T$ 的持续时间内，$p_A(t) = p_{\\mathrm{high}}$。\n  - 在 $(1-d)T$ 的持续时间内，$p_A(t) = p_{\\mathrm{low}}$。\n- **初始条件：** $\\theta(0) = 0$，$x(0) = 0$。\n- **目标：** 计算周期性稳态下的周期平均重构分数 $\\bar{x} = \\frac{1}{T}\\int_{t_0}^{t_0 + T} x(t)\\,dt$，并四舍五入到六位小数。\n- **测试案例的参数集：**\n  - 案例 1：$k_{\\mathrm{ads}} = 5.0\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$，$k_{\\mathrm{des}} = 0.5\\,\\mathrm{s}^{-1}$，$k_{01}^0 = 0.2\\,\\mathrm{s}^{-1}$，$k_{10}^0 = 0.05\\,\\mathrm{s}^{-1}$，$\\alpha = 4.0$，$\\beta = 2.0$，$p_{\\mathrm{low}} = 0.1\\,\\mathrm{bar}$，$p_{\\mathrm{high}} = 1.0\\,\\mathrm{bar}$，$T = 2.0\\,\\mathrm{s}$，$d = 0.5$。\n  - 案例 2：与案例 1 相同，但 $T = 0.05\\,\\mathrm{s}$。\n  - 案例 3：与案例 1 相同，但 $T = 10.0\\,\\mathrm{s}$。\n  - 案例 4：与案例 1 相同，但 $d = 0.8$。\n- **算法要求：** 使用常微分方程数值积分，通过收敛容差迭代至周期性稳态，然后使用数值积分计算周期平均值。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学基础：** 问题描述了一个吸附物诱导的表面重构的动力学模型。使用朗缪尔动力学处理吸附/解吸，并使用一级速率定律处理结构相变，且速率由吸附物覆盖度调节，这些都是表面科学和多相催化领域中标准且成熟的形式。该模型具有科学合理性，代表了动态催化的一个简化但现实的图景。\n2.  **适定性：** 问题提供了一个由两个耦合的、非线性的、一阶常微分方程组成的系统，并指定了一个分段常数强迫函数。给出了初始条件。速率函数是良态的，确保状态变量 $\\theta(t)$ 和 $x(t)$ 保持在其物理上有意义的范围 $[0, 1]$ 内。对于一个在周期性强迫下的耗散系统，预期会收敛到一个唯一的、稳定的极限环。找到此极限环并计算周期平均值的过程定义清晰。该问题在数学上是适定的。\n3.  **客观性：** 问题以精确的数学和物理术语陈述。所有量都有明确的定义。没有主观或基于观点的内容。\n4.  **完整性与一致性：** 提供了所有参数、方程、初始条件和目标。单位内部一致：例如，在 $d\\theta/dt$ 方程中，$k_{\\mathrm{ads}}\\,p_A$ 和 $k_{\\mathrm{des}}$ 两项的单位都是 $\\mathrm{s}^{-1}$，这对于无量纲量的变化率是正确的。设置是完整的，没有矛盾。\n\n### 步骤 3：结论与行动\n该问题具有科学基础、适定性、客观性和完整性。它提出了一个植根于既定化学动力学原理的、有一定难度的数值挑战。该问题被判定为 **有效**。将开发解决方案。\n\n### 解决方案\n\n该问题要求对一个耦合常微分方程 (ODE) 系统进行数值求解，该系统模拟了周期性强迫下动态重构的催化表面。系统的状态由向量 $Y(t) = [\\theta(t), x(t)]^T$ 描述，其中 $\\theta(t)$ 是吸附物 $A$ 的表面覆盖度，$x(t)$ 是处于重构态 $R_1$ 的表面分数。\n\n控制 ODE 系统为：\n$$\n\\frac{dY}{dt} = F(Y, p_A(t)) =\n\\begin{pmatrix}\n\\frac{d\\theta}{dt} \\\\\n\\frac{dx}{dt}\n\\end{pmatrix}\n$$\n其中分量函数为：\n$$\n\\frac{d\\theta}{dt} = k_{\\mathrm{ads}}\\,p_A(t)\\,\\left(1-\\theta\\right) - k_{\\mathrm{des}}\\,\\theta\n$$\n$$\n\\frac{dx}{dt} = k_{01}\\!\\left(\\theta\\right)\\,\\left(1 - x\\right) - k_{10}\\!\\left(\\theta\\right)\\,x\n$$\n重构和解构速率常数受覆盖度 $\\theta$ 调节：\n$$\nk_{01}\\!\\left(\\theta\\right) = k_{01}^0\\,\\exp\\!\\left(\\alpha\\,\\theta\\right)\n$$\n$$\nk_{10}\\!\\left(\\theta\\right) = k_{10}^0\\,\\exp\\!\\left(-\\beta\\,\\theta\\right)\n$$\n外部控制是分压 $p_A(t)$，它遵循一个周期为 $T$、占空比为 $d$、高压为 $p_{\\mathrm{high}}$、低压为 $p_{\\mathrm{low}}$ 的方波模式。\n\n求解过程主要分为两个阶段：\n1.  **寻找周期性稳态（极限环）：** 从初始条件 $Y(0) = [\\theta(0), x(0)]^T = [0, 0]^T$ 开始，随时间向前模拟系统。模拟逐个周期进行。对于每个周期，积分被分成对应于分段恒定压力的两个部分：\n    - 持续时间为 $d T$、压力为 $p_A = p_{\\mathrm{high}}$ 的区间。\n    - 持续时间为 $(1-d)T$、压力为 $p_A = p_{\\mathrm{low}}$ 的区间。\n    令 $Y_n$ 为第 $n$ 个周期开始时的系统状态。我们对 ODE 进行一个完整周期的数值积分，以获得下一个周期开始时的状态 $Y_{n+1}$。重复此迭代过程，直到系统达到周期性稳态或极限环。当一个周期开始时的状态向量不再发生显著变化时，即当连续状态之间的差的欧几里得范数小于一个小的容差 $\\epsilon$ 时：$\\|Y_{n+1} - Y_n\\|  \\epsilon$，宣告收敛。我们使用一个稳健的数值 ODE 求解器 `scipy.integrate.solve_ivp` 来完成此任务。\n\n2.  **计算周期平均重构分数 $\\bar{x}$：** 一旦达到周期性稳态，设稳定周期开始时的状态为 $Y_{ss}$。然后，我们从 $Y_{ss}$ 开始，对单个周期进行一次最终的高精度积分。为了计算积分 $\\int_{t_0}^{t_0+T} x(t)\\,dt$，我们指示 `solve_ivp` 函数产生“密集输出”。这提供了一个连续的插值函数（一个多项式样条），它能精确地表示求解器内部时间步之间的解 $x(t)$。\n然后，周期平均值由下式给出：\n$$\n\\bar{x} = \\frac{1}{T}\\int_{t_{ss}}^{t_{ss} + T} x(t)\\,dt\n$$\n这个积分通过将其分解为对应于压力阶段的两个部分来计算，并对由 `solve_ivp` 生成的 $x(t)$ 的插值函数使用标准的数值积分程序 `scipy.integrate.quad`：\n$$\n\\bar{x} = \\frac{1}{T} \\left( \\int_{t_{ss}}^{t_{ss}+dT} x_{\\mathrm{high}}(t)\\,dt + \\int_{t_{ss}+dT}^{t_{ss}+T} x_{\\mathrm{low}}(t)\\,dt \\right)\n$$\n其中 $x_{\\mathrm{high}}(t)$ 和 $x_{\\mathrm{low}}(t)$ 分别是高压和低压阶段的解函数。\n\n最终的实现将是一个 Python 脚本，该脚本定义了 ODE 系统和参数，然后对问题陈述中指定的四个测试案例中的每一个执行这个两阶段的数值程序。得到的 $\\bar{x}$ 值四舍五入到六位小数，并格式化为一个列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\n\ndef solve():\n    \"\"\"\n    Solves the dynamic catalysis problem for all specified test cases.\n    \"\"\"\n\n    # Test suite of parameter sets.\n    test_cases = [\n        # Case 1 (balanced forcing, moderate period)\n        {\n            \"k_ads\": 5.0, \"k_des\": 0.5, \"k01_0\": 0.2, \"k10_0\": 0.05,\n            \"alpha\": 4.0, \"beta\": 2.0, \"p_low\": 0.1, \"p_high\": 1.0,\n            \"T\": 2.0, \"d\": 0.5,\n        },\n        # Case 2 (high-frequency forcing)\n        {\n            \"k_ads\": 5.0, \"k_des\": 0.5, \"k01_0\": 0.2, \"k10_0\": 0.05,\n            \"alpha\": 4.0, \"beta\": 2.0, \"p_low\": 0.1, \"p_high\": 1.0,\n            \"T\": 0.05, \"d\": 0.5,\n        },\n        # Case 3 (low-frequency forcing)\n        {\n            \"k_ads\": 5.0, \"k_des\": 0.5, \"k01_0\": 0.2, \"k10_0\": 0.05,\n            \"alpha\": 4.0, \"beta\": 2.0, \"p_low\": 0.1, \"p_high\": 1.0,\n            \"T\": 10.0, \"d\": 0.5,\n        },\n        # Case 4 (biased duty cycle)\n        {\n            \"k_ads\": 5.0, \"k_des\": 0.5, \"k01_0\": 0.2, \"k10_0\": 0.05,\n            \"alpha\": 4.0, \"beta\": 2.0, \"p_low\": 0.1, \"p_high\": 1.0,\n            \"T\": 2.0, \"d\": 0.8,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(params)\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef ode_system(t, y, p_A, params):\n    \"\"\"\n    Defines the system of coupled ODEs.\n    - y[0]: theta (coverage)\n    - y[1]: x (reconstructed fraction)\n    \"\"\"\n    theta, x = y\n    k_ads = params[\"k_ads\"]\n    k_des = params[\"k_des\"]\n    k01_0 = params[\"k01_0\"]\n    k10_0 = params[\"k10_0\"]\n    alpha = params[\"alpha\"]\n    beta = params[\"beta\"]\n\n    # Rate of change of coverage theta\n    dtheta_dt = k_ads * p_A * (1 - theta) - k_des * theta\n\n    # Coverage-dependent reconstruction/deconstruction rates\n    k01 = k01_0 * np.exp(alpha * theta)\n    k10 = k10_0 * np.exp(-beta * theta)\n\n    # Rate of change of reconstructed fraction x\n    dx_dt = k01 * (1 - x) - k10 * x\n\n    return [dtheta_dt, dx_dt]\n\ndef run_simulation(params):\n    \"\"\"\n    Runs the simulation for a single set of parameters to find the\n    cycle-averaged reconstructed fraction at periodic steady state.\n    \"\"\"\n    p_high = params[\"p_high\"]\n    p_low = params[\"p_low\"]\n    T = params[\"T\"]\n    d = params[\"d\"]\n\n    T_high = d * T\n    T_low = (1.0 - d) * T\n\n    # Initial conditions\n    y_current = np.array([0.0, 0.0])\n\n    # --- Stage 1: Find the periodic steady state (limit cycle) ---\n    max_periods = 1000  # Safety break\n    tolerance = 1e-12    # Convergence tolerance\n\n    y_ss_start = None\n    for i in range(max_periods):\n        y_start_period = y_current.copy()\n\n        # High pressure segment\n        sol_high = solve_ivp(\n            fun=ode_system,\n            t_span=[0, T_high],\n            y0=y_start_period,\n            args=(p_high, params),\n            method='RK45',\n            rtol=1e-8,\n            atol=1e-11\n        )\n        y_mid_period = sol_high.y[:, -1]\n\n        # Low pressure segment\n        sol_low = solve_ivp(\n            fun=ode_system,\n            t_span=[0, T_low],\n            y0=y_mid_period,\n            args=(p_low, params),\n            method='RK45',\n            rtol=1e-8,\n            atol=1e-11\n        )\n        y_end_period = sol_low.y[:, -1]\n\n        # Check for convergence to the limit cycle\n        if np.linalg.norm(y_end_period - y_start_period)  tolerance:\n            y_ss_start = y_end_period\n            break\n        \n        y_current = y_end_period\n    \n    if y_ss_start is None:\n        raise RuntimeError(\"Periodic steady state not reached within max_periods.\")\n\n    # --- Stage 2: Calculate the cycle-averaged value of x ---\n    # High pressure segment with dense output for quadrature\n    sol_high_dense = solve_ivp(\n        fun=ode_system,\n        t_span=[0, T_high],\n        y0=y_ss_start,\n        args=(p_high, params),\n        method='RK45',\n        dense_output=True,\n        rtol=1e-8,\n        atol=1e-11\n    )\n    y_mid_ss = sol_high_dense.y[:, -1]\n\n    # Low pressure segment with dense output for quadrature\n    sol_low_dense = solve_ivp(\n        fun=ode_system,\n        t_span=[T_high, T],\n        y0=y_mid_ss,\n        args=(p_low, params),\n        method='RK45',\n        dense_output=True,\n        rtol=1e-8,\n        atol=1e-11\n    )\n\n    # Use quadrature to integrate the dense solution for x(t)\n    integral_high, _ = quad(lambda t: sol_high_dense.sol(t)[1], 0, T_high)\n    integral_low, _ = quad(lambda t: sol_low_dense.sol(t)[1], T_high, T)\n\n    # Calculate cycle-averaged value\n    x_bar = (integral_high + integral_low) / T\n    \n    return x_bar\n\nsolve()\n```"
        },
        {
            "introduction": "除了确定性模型（如常微分方程），我们还需要掌握随机方法，以捕捉原子尺度上事件的离散和概率性。本练习将引导你从确定性模型转向随机模型，推导一种适用于时变速率的“无拒绝”动力学蒙特卡洛(KMC)算法的核心规则 。掌握如何处理非平稳速率对于模拟处于缓慢变化的外部条件（如变化的电化学势）下的系统是一项关键技能。",
            "id": "3888663",
            "problem": "在动态操作下，由于缓慢增加的电化学势调节了活化能垒，催化表面表现出随时间变化的反应和重构倾向。考虑一个包含两个基元事件的最小模型：物种吸附到一个位点，以及在同一位点发生的一步表面结构重构。吸附的瞬时速率记为 $k_{1}(t)$，重构的瞬时速率记为 $k_{2}(t)$。您的目标是为此非平稳过程实现一种无拒绝动力学蒙特卡洛（KMC）算法，在该算法中，事件时钟根据随时间变化的强度的精确统计来推进，而无需提议和拒绝移动。从非平稳点过程的第一性原理出发，特别是基于在一个区间内未观察到事件的概率由累积风险决定以及该过程在无穷小意义上是无记忆的这两个原则，推导出在复合瞬时速率 $R(t) = \\sum_{i} k_{i}(t)$ 下，下一事件时间的一般抽样规则。\n\n然后，将您的推导应用于以下由动态催化和结构重构启发的科学上合理的调制：电化学势缓慢增加，使得 $k_{1}(t)$ 和 $k_{2}(t)$ 都按比例地由一个源于能垒降低的相同乘法因子 $m(t) = \\exp(\\alpha t)$ 缩放，其中 $\\alpha$ 是一个量纲为时间倒数的常数参数。具体而言，设 $k_{1}(t) = k_{1,0}\\,\\exp(\\alpha t)$ 和 $k_{2}(t) = k_{2,0}\\,\\exp(\\alpha t)$，其中 $k_{1,0}  0$，$k_{2,0}  0$ 且 $\\alpha  0$，并假设当前模拟时间为 $t_{0} = 0$。令 $u \\in (0,1)$ 为一个用于抽取下一事件时间的均匀随机变量。使用您的一般规则，推导出抽样事件时间 $t(u)$ 关于 $u$、$k_{1,0}$、$k_{2,0}$ 和 $\\alpha$ 的闭式解析表达式。\n\n以秒为单位表示最终时间。如果您选择数值计算，请四舍五入到四位有效数字；否则请提供符号表达式。最终答案必须是单个闭式解析表达式。",
            "solution": "问题要求为一个具有瞬时速率的过程推导一种无拒绝动力学蒙特卡洛（KMC）算法中的下一事件时间的抽样规则，然后将其应用于一个具体案例。推导必须从非平稳点过程的第一性原理出发。\n\n首先，我们推导下一事件时间的一般抽样规则。令 $R(t)$ 为所有可能事件的总瞬时速率，$R(t) = \\sum_{i} k_{i}(t)$。这是非齐次泊松过程的强度函数。设当前模拟时间为 $t_0$。我们寻求下一事件的时间 $t$。令 $T$ 为代表下一事件时间的随机变量。\n\n此类过程的基本公理是，在无穷小时间间隔 $[t', t' + dt')$ 内发生事件的概率为 $R(t') dt'$。在此区间内没有事件发生的概率是 $1 - R(t') dt'$。\n\n问题陈述引导我们使用这样一个原理：在有限区间内未观察到事件的概率由累积风险决定。让我们来推导它。令 $P(t_0, t)$ 为在区间 $[t_0, t)$ 内未观察到事件的概率。对于此区间的一个无穷小扩展到 $[t_0, t+dt)$，由于过程的独立增量（无穷小无记忆）性质，没有事件发生的概率是 $[t_0, t)$ 内没有事件的概率和 $[t, t+dt)$ 内没有事件的概率的乘积。\n$$P(t_0, t+dt) = P(t_0, t) \\times (1 - R(t) dt)$$\n整理后得到 $P(t_0, t)$ 的微分方程：\n$$P(t_0, t+dt) - P(t_0, t) = -P(t_0, t) R(t) dt$$\n$$\\frac{dP(t_0, t)}{dt} = -R(t) P(t_0, t)$$\n这个一阶线性常微分方程可以通过初始条件 $P(t_0, t_0) = 1$（在零长度区间内没有事件发生的概率为1）来求解。\n$$\\int_{1}^{P(t_0, t)} \\frac{dP'}{P'} = -\\int_{t_0}^{t} R(t') dt'$$\n$$\\ln(P(t_0, t)) - \\ln(1) = -\\int_{t_0}^{t} R(t') dt'$$\n$$P(t_0, t) = \\exp\\left(-\\int_{t_0}^{t} R(t') dt'\\right)$$\n这个概率 $P(t_0, t)$ 是下一事件时间 $T$ 的生存函数。即 $P(T  t-t_0) = P(t_0, t)$。\n\n下一事件时间的累积分布函数（CDF）$F_T(t)$ 是事件在时间 $t$ 之前发生的概率，$P(T \\leq t)$。它由以下公式给出：\n$$F_T(t) = 1 - P(T  t) = 1 - P(t_0, t) = 1 - \\exp\\left(-\\int_{t_0}^{t} R(t') dt'\\right)$$\n为了使用逆变换采样法对下一事件时间 $t$ 进行抽样，我们从 $(0, 1)$ 上的均匀分布中抽取一个随机数 $u$，并将其设置为等于CDF：\n$$u = 1 - \\exp\\left(-\\int_{t_0}^{t} R(t') dt'\\right)$$\n求解积分项：\n$$1 - u = \\exp\\left(-\\int_{t_0}^{t} R(t') dt'\\right)$$\n对两边取自然对数：\n$$\\ln(1 - u) = -\\int_{t_0}^{t} R(t') dt'$$\n由于 $u$ 是 $(0, 1)$ 上的均匀变量，$1-u$ 也是 $(0, 1)$ 上的均匀变量。习惯上用一个新的均匀变量（也记为 $u$）来代替 $1-u$。然而，为了清晰和直接，我们也可以将方程重新整理为：\n$$\\int_{t_0}^{t} R(t') dt' = -\\ln(1-u)$$\n进一步的常见简化是注意到如果 $u$ 在 $(0,1)$ 上均匀分布，那么 $-\\ln(u)$ 服从标准指数分布。让我们通过设置 $u' = 1-u$ 来重写方程：\n$$\\int_{t_0}^{t} R(t') dt' = -\\ln(u')$$\n同样，由于 $u'$ 在 $(0,1)$ 上均匀分布，我们可以去掉撇号。因此，一般抽样规则是求解以下关于 $t$ 的方程：\n$$\\int_{t_0}^{t} R(t') dt' = -\\ln(u)$$\n其中 $u \\in (0, 1)$ 是一个均匀随机变量。\n\n接下来，我们将此一般规则应用于所提供的具体案例。瞬时速率为 $k_1(t) = k_{1,0} \\exp(\\alpha t)$ 和 $k_2(t) = k_{2,0} \\exp(\\alpha t)$。总速率 $R(t)$ 是它们的和：\n$$R(t) = k_1(t) + k_2(t) = k_{1,0} \\exp(\\alpha t) + k_{2,0} \\exp(\\alpha t) = (k_{1,0} + k_{2,0}) \\exp(\\alpha t)$$\n为简洁起见，令 $R_0 = k_{1,0} + k_{2,0}$。那么 $R(t) = R_0 \\exp(\\alpha t)$。\n问题指定当前时间为 $t_0 = 0$。我们将这些代入一般抽样方程：\n$$\\int_{0}^{t} R_0 \\exp(\\alpha t') dt' = -\\ln(u)$$\n我们计算左侧的积分：\n$$\\int_{0}^{t} R_0 \\exp(\\alpha t') dt' = R_0 \\left[ \\frac{\\exp(\\alpha t')}{\\alpha} \\right]_{0}^{t} = \\frac{R_0}{\\alpha} (\\exp(\\alpha t) - \\exp(\\alpha \\cdot 0))$$\n由于 $\\exp(0) = 1$，积分为：\n$$\\frac{R_0}{\\alpha} (\\exp(\\alpha t) - 1)$$\n现在，我们将其设为等于 $-\\ln(u)$ 并求解 $t$：\n$$\\frac{R_0}{\\alpha} (\\exp(\\alpha t) - 1) = -\\ln(u)$$\n我们继续通过代数方法分离 $t$：\n$$\\exp(\\alpha t) - 1 = -\\frac{\\alpha}{R_0} \\ln(u)$$\n$$\\exp(\\alpha t) = 1 - \\frac{\\alpha}{R_0} \\ln(u)$$\n$$\\alpha t = \\ln\\left(1 - \\frac{\\alpha}{R_0} \\ln(u)\\right)$$\n$$t = \\frac{1}{\\alpha} \\ln\\left(1 - \\frac{\\alpha}{R_0} \\ln(u)\\right)$$\n最后，我们将 $R_0 = k_{1,0} + k_{2,0}$ 代回，得到抽樣事件时间 $t$ 作为随机变量 $u$ 和系统参数的函数的最终表达式：\n$$t(u) = \\frac{1}{\\alpha} \\ln\\left(1 - \\frac{\\alpha}{k_{1,0} + k_{2,0}} \\ln(u)\\right)$$\n参数 $k_{1,0}$、$k_{2,0}$ 和 $\\alpha$ 均为正数。由于 $u \\in (0,1)$，$\\ln(u)$ 为负数。因此，项 $-\\frac{\\alpha}{k_{1,0}+k_{2,0}}\\ln(u)$ 为正数，确保了对数的参数大于 $1$。这保证了计算出的时间 $t$ 是实数且为正，这是必须的。\n这个闭式解析表达式是最终答案。",
            "answer": "$$ \\boxed{ \\frac{1}{\\alpha} \\ln\\left(1 - \\frac{\\alpha}{k_{1,0} + k_{2,0}} \\ln(u)\\right) } $$"
        }
    ]
}