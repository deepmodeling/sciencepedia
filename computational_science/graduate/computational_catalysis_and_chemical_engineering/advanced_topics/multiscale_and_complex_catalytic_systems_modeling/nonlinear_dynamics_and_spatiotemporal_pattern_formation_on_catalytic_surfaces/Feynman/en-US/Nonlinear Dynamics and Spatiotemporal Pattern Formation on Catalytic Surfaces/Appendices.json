{
    "hands_on_practices": [
        {
            "introduction": "The fascinating and complex dynamics observed on catalytic surfaces have their roots in a simple physical constraint: a finite number of active sites for which reactant molecules must compete. This hands-on derivation guides you through the process of constructing a complete Langmuir-Hinshelwood-Hougen-Watson (LHHW) rate law from elementary mechanistic steps. By explicitly accounting for competitive adsorption and the site balance, you will see firsthand how simple microscopic events give rise to a highly nonlinear macroscopic rate expression, which is the ultimate source of phenomena like kinetic bistability and oscillatory behavior . This exercise provides the chemical foundation for understanding why these systems are anything but simple.",
            "id": "3893207",
            "problem": "A flat catalytic surface with a single, uniform type of adsorption site is contacted by an isothermal, well-mixed gas mixture containing species $A$, $B$, and $P$. The elementary mechanism consists of three reversible adsorption steps and one irreversible surface reaction step: gas-phase $A$ and $B$ adsorb to form $A^*$ and $B^*$, gas-phase $P$ adsorbs to form $P^*$, and the surface reaction converts $A^*$ and $B^*$ to $P^*$ while releasing one vacant site. Assume ideal-gas behavior in the gas phase, a mean-field description of the surface, and quasi-equilibrium for the adsorption–desorption steps. Each adsorbate $i \\in \\{A,B,P\\}$ is monodentate and blocks one site upon adsorption. The surface has fractional coverages $\\theta_A$, $\\theta_B$, $\\theta_P$, and $\\theta_*$ for $A^*$, $B^*$, $P^*$, and vacant sites, respectively, and satisfies the site balance $\\theta_* + \\theta_A + \\theta_B + \\theta_P = 1$. The adsorption quasi-equilibria are characterized by equilibrium constants $K_A$, $K_B$, and $K_P$, defined so that $\\theta_i$ scales with $p_i$ and $\\theta_*$ under quasi-equilibrium. The irreversible surface reaction is elementary and proceeds between nearest-neighbor $A^*$ and $B^*$ under the mean-field approximation; its temperature-dependent rate constant is $k$.\n\nStarting from the stated mechanistic and thermodynamic assumptions and fundamental laws (mass action for elementary steps, ideal-gas relation for activities, and the site balance), first express the reaction rate in terms of the surface coverages and then eliminate the coverages to obtain a closed-form analytic expression for the net production rate $r$ of $P^*$ as a function of the gas-phase partial pressures $p_A$, $p_B$, and $p_P$ and the constants $K_A$, $K_B$, $K_P$, and $k$. In your derivation, justify each step from first principles, including the form of the adsorption isotherms under quasi-equilibrium and the site balance constraint.\n\nThen, analyze qualitatively how the site balance and surface blocking by adsorbates can modify the apparent reaction orders with respect to $p_A$ and $p_B$ across coverage regimes, explaining why non-integer and even negative apparent orders can arise in high-coverage limits and how such nonlinearities in $r(\\theta_*, \\theta_A, \\theta_B, \\theta_P)$ relate to spatiotemporal pattern formation on catalytic surfaces in reaction–diffusion models.\n\nProvide as your final output only the closed-form analytic expression for $r$ in terms of $p_A$, $p_B$, $p_P$, $K_A$, $K_B$, $K_P$, and $k$ under the monodentate assumptions stated. No numerical evaluation is required.",
            "solution": "The problem is deemed valid as it is scientifically grounded, self-contained, well-posed, and objective. It presents a standard scenario in chemical kinetics and catalysis that is suitable for rigorous analysis. We will proceed with a full derivation and analysis.\n\nThe problem requires the derivation of a rate law for a catalytic reaction based on a proposed elementary mechanism. We begin by formalizing the reaction steps and the associated kinetic and thermodynamic assumptions.\n\nThe mechanism consists of the following elementary steps:\n$1$. Reversible adsorption of reactant $A$: $A(g) + * \\rightleftharpoons A^*$\n$2$. Reversible adsorption of reactant $B$: $B(g) + * \\rightleftharpoons B^*$\n$3$. Reversible adsorption of product $P$: $P(g) + * \\rightleftharpoons P^*$\n$4$. Irreversible surface reaction: $A^* + B^* \\rightarrow P^* + *$\n\nHere, $(g)$ denotes a species in the gas phase, $*$ represents a vacant catalytic site, and $i^*$ represents an adsorbed species $i$ on a site. The surface coverages are denoted by $\\theta_A$, $\\theta_B$, $\\theta_P$, and $\\theta_*$ for adsorbed $A$, adsorbed $B$, adsorbed $P$, and vacant sites, respectively.\n\nThe net production rate of $P^*$, denoted by $r$, is determined by the rate-determining step, which is the irreversible surface reaction. According to the law of mass action for an elementary step, the rate is proportional to the product of the concentrations of the reactants. Under the mean-field approximation, the surface is treated as a uniform medium, and the \"concentration\" of a surface species is its fractional coverage. Therefore, the rate of the surface reaction is given by:\n$$r = k \\theta_A \\theta_B$$\nwhere $k$ is the temperature-dependent rate constant for this elementary step.\n\nOur goal is to express $r$ in terms of the partial pressures of the gas-phase species ($p_A$, $p_B$, $p_P$) and the constants of the system ($k$, $K_A$, $K_B$, $K_P$). To do this, we must express the coverages $\\theta_A$ and $\\theta_B$ as functions of these external variables.\n\nWe utilize the assumption that the three adsorption-desorption steps are in a state of quasi-equilibrium. This means that for each of these steps, the forward rate (adsorption) is equal to the reverse rate (desorption).\nFor the adsorption of species $i \\in \\{A, B, P\\}$:\n$$i(g) + * \\rightleftharpoons i^*$$\nThe rate of adsorption is proportional to the partial pressure of $i$ in the gas phase, $p_i$ (which acts as the activity for an ideal gas), and the fractional coverage of vacant sites, $\\theta_*$. The rate of desorption is proportional to the fractional coverage of the adsorbed species, $\\theta_i$.\n$$k_{ad,i} p_i \\theta_* = k_{des,i} \\theta_i$$\nRearranging this equilibrium condition gives:\n$$\\theta_i = \\frac{k_{ad,i}}{k_{des,i}} p_i \\theta_*$$\nThe ratio of the adsorption and desorption rate constants defines the adsorption equilibrium constant, $K_i$:\n$$K_i = \\frac{k_{ad,i}}{k_{des,i}}$$\nThis definition is consistent with the problem statement that $\\theta_i$ scales with $p_i$ and $\\theta_*$. Applying this to species $A$, $B$, and $P$, we obtain the following set of equations, known as Langmuir isotherms for competitive adsorption:\n$$\\theta_A = K_A p_A \\theta_*$$\n$$\\theta_B = K_B p_B \\theta_*$$\n$$\\theta_P = K_P p_P \\theta_*$$\n\nThe system of equations is closed by the site balance constraint. Since each adsorbate is monodentate, occupying one site, the sum of all fractional coverages must equal unity:\n$$\\theta_* + \\theta_A + \\theta_B + \\theta_P = 1$$\nWe can now solve for the unknown coverages. We substitute the equilibrium expressions for $\\theta_A$, $\\theta_B$, and $\\theta_P$ into the site balance equation:\n$$\\theta_* + (K_A p_A \\theta_*) + (K_B p_B \\theta_*) + (K_P p_P \\theta_*) = 1$$\nFactoring out the vacant site coverage $\\theta_*$ yields:\n$$\\theta_* (1 + K_A p_A + K_B p_B + K_P p_P) = 1$$\nSolving for $\\theta_*$:\n$$\\theta_* = \\frac{1}{1 + K_A p_A + K_B p_B + K_P p_P}$$\nThis expression shows how the availability of vacant sites decreases as the partial pressures of adsorbing species increase, a phenomenon known as site blocking.\n\nNow we can express the reactant coverages, $\\theta_A$ and $\\theta_B$, solely in terms of gas-phase partial pressures and constants by substituting the expression for $\\theta_*$:\n$$\\theta_A = K_A p_A \\theta_* = \\frac{K_A p_A}{1 + K_A p_A + K_B p_B + K_P p_P}$$\n$$\\theta_B = K_B p_B \\theta_* = \\frac{K_B p_B}{1 + K_A p_A + K_B p_B + K_P p_P}$$\n\nFinally, we substitute these expressions for $\\theta_A$ and $\\theta_B$ back into the rate equation $r = k \\theta_A \\theta_B$:\n$$r = k \\left( \\frac{K_A p_A}{1 + K_A p_A + K_B p_B + K_P p_P} \\right) \\left( \\frac{K_B p_B}{1 + K_A p_A + K_B p_B + K_P p_P} \\right)$$\nThis simplifies to the final closed-form analytic expression for the reaction rate, which is a form of the Langmuir-Hinshelwood-Hougen-Watson (LHHW) rate law:\n$$r = \\frac{k K_A K_B p_A p_B}{(1 + K_A p_A + K_B p_B + K_P p_P)^2}$$\n\nNext, we qualitatively analyze the implications of this rate law. The apparent reaction order with respect to a species $j$ is defined as $\\alpha_j = \\frac{\\partial(\\ln r)}{\\partial(\\ln p_j)}$. The denominator term $(1 + K_A p_A + K_B p_B + K_P p_P)^2$ is the source of the rich nonlinear behavior. This term arises directly from the site balance constraint and embodies the effect of surface blocking due to competitive adsorption.\n\n1.  **Low Coverage Limit**: When all partial pressures are very low ($p_A, p_B, p_P \\rightarrow 0$), the denominator approaches $1^2=1$. The rate law simplifies to $r \\approx k K_A K_B p_A p_B$. In this regime, the reaction is first-order with respect to $p_A$ and first-order with respect to $p_B$. The surface is mostly vacant, so adsorbates do not compete for sites.\n\n2.  **High Coverage Limit (Reactant Inhibition)**: Consider the case where $p_A$ is very high, such that $K_A p_A \\gg 1 + K_B p_B + K_P p_P$. The surface becomes saturated with species $A^*$. The denominator is dominated by the $K_A p_A$ term: $(K_A p_A)^2$. The rate law becomes:\n    $$r \\approx \\frac{k K_A K_B p_A p_B}{(K_A p_A)^2} = \\frac{k K_B p_B}{K_A p_A}$$\n    In this limit, the apparent order with respect to $p_A$ is $-1$, and the order with respect to $p_B$ is $1$. The reactant $A$ inhibits its own reaction rate. This occurs because excess $A$ occupies most of the catalytic sites, leaving very few vacant sites for $B$ to adsorb. The rate becomes limited by the availability of sites for $B$. Symmetrically, if $p_B$ is very high and dominates the denominator, the rate becomes $r \\approx \\frac{k K_A p_A}{K_B p_B}$, exhibiting an apparent order of $-1$ with respect to $p_B$.\n\n3.  **High Coverage Limit (Product Inhibition)**: If the product $P$ adsorbs strongly and its partial pressure $p_P$ is high, the surface can be \"poisoned\" by the product. If $K_P p_P$ dominates the denominator, the rate law becomes:\n    $$r \\approx \\frac{k K_A K_B p_A p_B}{(K_P p_P)^2}$$\n    Here, the rate is first-order in $p_A$ and $p_B$, but has an apparent order of $-2$ with respect to $p_P$. Strong product adsorption severely hinders the reaction by blocking sites required for the reactants.\n\nBetween these limiting cases, the apparent reaction orders vary continuously and take on non-integer values. The site balance, by coupling the coverages of all species, ensures that the availability of any one species on the surface depends on the gas-phase pressures of all others. This competition for finite resources (sites) is the fundamental reason for the emergence of non-integer and negative apparent reaction orders.\n\nThis inherent nonlinearity in the reaction kinetics is a critical prerequisite for the formation of spatiotemporal patterns in reaction-diffusion systems on catalytic surfaces. Such patterns arise from the interplay of local reaction kinetics and spatial transport (diffusion). The derived LHHW rate law provides the nonlinear \"reaction\" part of a reaction-diffusion model, e.g., $\\frac{\\partial \\theta_i}{\\partial t} = R_i(\\{\\theta_j\\}) + D_i \\nabla^2 \\theta_i$. The negative apparent orders correspond to inhibitory or negative feedback loops in the reaction network. For example, the inhibition by reactant $A$ at high coverage ($r \\propto 1/p_A$) is a form of substrate inhibition. In the context of pattern formation theory (e.g., Turing systems), a common mechanism requires a short-range activator and a long-range inhibitor. A reaction scheme with kinetics like the one derived here can fulfill this requirement if, for example, one of the inhibiting species (e.g., $A$ in the high-coverage regime) diffuses much faster than an activating species. The strong nonlinearities, particularly the rate decrease at high reactant or product concentrations, create the instabilities necessary for the system to spontaneously break spatial symmetry and form complex patterns like spirals, targets, or stationary Turing structures.",
            "answer": "$$\n\\boxed{\\frac{k K_A K_B p_A p_B}{(1 + K_A p_A + K_B p_B + K_P p_P)^{2}}}\n$$"
        },
        {
            "introduction": "Once we have established that catalytic kinetics are inherently nonlinear, as demonstrated in the LHHW model , the next task is to mathematically characterize their dynamic potential. This practice introduces the powerful framework of bifurcation theory, a cornerstone of nonlinear dynamics, to analyze the behavior of a general activator-inhibitor model. You will perform a hands-on calculation to find a saddle-node bifurcation point—a critical threshold where the system's steady states are created or destroyed. Understanding such \"tipping points\" is essential for predicting the conditions under which a catalytic surface can exhibit multistability, which is a key prerequisite for the formation of stationary spatial patterns.",
            "id": "3893226",
            "problem": "Consider a nondimensional activator–inhibitor kinetic model for a catalytic surface reaction in the absence of diffusion. Let $u(t)$ denote a dimensionless surface coverage of an autocatalytically generated reactive intermediate (activator) and $v(t)$ denote a dimensionless coverage of an inhibiting adsorbate (inhibitor). The kinetics are modeled by the ordinary differential equations\n$$\n\\frac{du}{dt} \\;=\\; f(u,v;\\mu) \\;=\\; \\mu\\,u\\,(1 - u)\\;-\\;v\\;+\\;\\kappa\\,u^{3},\n$$\n$$\n\\frac{dv}{dt} \\;=\\; g(u,v) \\;=\\; \\epsilon\\,(\\alpha\\,u \\;-\\; v),\n$$\nwhere $\\mu$ is a dimensionless feed-rate parameter for the activator precursor, $\\kappa>0$ is the strength of autocatalysis, $\\alpha>0$ describes the linear coupling of the inhibitor production to the activator, and $\\epsilon>0$ is the inhibitor relaxation rate. Assume the physically relevant coverage constraints $0<u<1$ and $0<v<1$ at steady state.\n\nUsing the definition of a saddle-node (fold) bifurcation in planar kinetics without diffusion, compute the unique interior saddle-node bifurcation point in terms of the parameter $\\mu$ by solving the simultaneous conditions $f(u,v;\\mu)=0$, $g(u,v)=0$, and $\\det(J(u,v;\\mu))=0$, where $J(u,v;\\mu)$ is the Jacobian matrix of the kinetic vector field $(f,g)$ with respect to $(u,v)$. Take $\\alpha=\\tfrac{3}{4}$, $\\kappa=1$, and any fixed $\\epsilon>0$. Express your final answer as the single dimensionless value of $\\mu$ corresponding to the interior $(0<u<1)$ saddle-node. No rounding is required; report the exact value.",
            "solution": "The problem requires the determination of the saddle-node bifurcation point for a given activator-inhibitor kinetic model in the absence of diffusion. A saddle-node bifurcation in a planar system described by $\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x}; \\mu)$, where $\\mathbf{x}=(u,v)$ and $\\mathbf{F}=(f,g)$, occurs at a point $(u_c, v_c)$ for a critical parameter value $\\mu_c$ where the system satisfies the following three simultaneous conditions:\n$1$. The system is at a steady state: $f(u,v;\\mu) = 0$.\n$2$. The system is at a steady state: $g(u,v) = 0$.\n$3$. The Jacobian matrix of the system is singular: $\\det(J(u,v;\\mu)) = 0$.\n\nThe provided kinetic model is:\n$$ \\frac{du}{dt} = f(u,v;\\mu) = \\mu u (1 - u) - v + \\kappa u^{3} $$\n$$ \\frac{dv}{dt} = g(u,v) = \\epsilon (\\alpha u - v) $$\nWe are given the parameter values $\\alpha=\\frac{3}{4}$, $\\kappa=1$, and $\\epsilon>0$. The physically relevant domain is defined by $0<u<1$ and $0<v<1$ at the steady state.\n\nFirst, we apply the steady-state conditions.\nFrom $g(u,v)=0$:\n$$ \\epsilon(\\alpha u - v) = 0 $$\nSince $\\epsilon > 0$, this simplifies to:\n$$ v = \\alpha u $$\nSubstituting the given value $\\alpha = \\frac{3}{4}$, we have:\n$$ v = \\frac{3}{4} u \\quad (*)$$\n\nNext, we apply the condition $f(u,v;\\mu)=0$ and substitute the values for $\\kappa$ and $v$:\n$$ \\mu u(1-u) - \\left(\\frac{3}{4} u\\right) + (1) u^3 = 0 $$\n$$ \\mu u - \\mu u^2 - \\frac{3}{4} u + u^3 = 0 $$\nFor an interior fixed point, $u \\neq 0$. We can divide the equation by $u$:\n$$ \\mu (1-u) - \\frac{3}{4} + u^2 = 0 \\quad (**) $$\n\nNow, we must compute the Jacobian matrix $J$ and its determinant. The Jacobian is given by:\n$$ J = \\begin{pmatrix} \\frac{\\partial f}{\\partial u} & \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u} & \\frac{\\partial g}{\\partial v} \\end{pmatrix} $$\nThe partial derivatives are:\n$\\frac{\\partial f}{\\partial u} = \\frac{\\partial}{\\partial u} (\\mu u - \\mu u^2 - v + u^3) = \\mu - 2\\mu u + 3u^2 = \\mu(1-2u) + 3u^2$\n$\\frac{\\partial f}{\\partial v} = -1$\n$\\frac{\\partial g}{\\partial u} = \\frac{\\partial}{\\partial u} (\\epsilon\\alpha u - \\epsilon v) = \\epsilon\\alpha$\n$\\frac{\\partial g}{\\partial v} = -\\epsilon$\n\nThe Jacobian matrix is:\n$$ J = \\begin{pmatrix} \\mu(1-2u) + 3u^2 & -1 \\\\ \\epsilon\\alpha & -\\epsilon \\end{pmatrix} $$\nThe determinant of the Jacobian is:\n$$ \\det(J) = (\\mu(1-2u) + 3u^2)(-\\epsilon) - (-1)(\\epsilon\\alpha) = -\\epsilon(\\mu(1-2u) + 3u^2) + \\epsilon\\alpha $$\nThe bifurcation condition $\\det(J)=0$ is:\n$$ -\\epsilon(\\mu(1-2u) + 3u^2) + \\epsilon\\alpha = 0 $$\nSince $\\epsilon > 0$, we can divide by $-\\epsilon$:\n$$ \\mu(1-2u) + 3u^2 - \\alpha = 0 $$\nSubstituting $\\alpha = \\frac{3}{4}$:\n$$ \\mu(1-2u) + 3u^2 - \\frac{3}{4} = 0 \\quad (***) $$\n\nWe now have a system of two algebraic equations, $(**)$ and $(***)$, for the two unknowns $u$ and $\\mu$:\n$1$. $\\mu(1-u) + u^2 - \\frac{3}{4} = 0$\n$2$. $\\mu(1-2u) + 3u^2 - \\frac{3}{4} = 0$\n\nFrom the first equation, we can express $\\mu$ in terms of $u$ (assuming $u \\neq 1$):\n$$ \\mu = \\frac{\\frac{3}{4} - u^2}{1-u} $$\nFrom the second equation, we can also express $\\mu$ in terms of $u$ (assuming $u \\neq \\frac{1}{2}$):\n$$ \\mu = \\frac{\\frac{3}{4} - 3u^2}{1-2u} $$\nEquating these two expressions for $\\mu$:\n$$ \\frac{\\frac{3}{4} - u^2}{1-u} = \\frac{\\frac{3}{4} - 3u^2}{1-2u} $$\nTo simplify, multiply the numerators and denominators by $4$:\n$$ \\frac{3 - 4u^2}{1-u} = \\frac{3 - 12u^2}{1-2u} $$\nCross-multiplying yields:\n$$ (3 - 4u^2)(1 - 2u) = (3 - 12u^2)(1 - u) $$\n$$ 3 - 6u - 4u^2 + 8u^3 = 3 - 3u - 12u^2 + 12u^3 $$\nCollecting all terms on one side:\n$$ (12-8)u^3 + (4-12)u^2 + (6-3)u + (3-3) = 0 $$\n$$ 4u^3 - 8u^2 + 3u = 0 $$\nFactoring out $u$:\n$$ u(4u^2 - 8u + 3) = 0 $$\nThis equation has three real roots for $u$.\nThe first root is $u=0$. This corresponds to a boundary steady state, not an interior one, so we discard it based on the condition $0 < u < 1$.\nThe other two roots come from the quadratic equation $4u^2 - 8u + 3 = 0$. We can factor this as $(2u-1)(2u-3)=0$.\nThe roots are:\n$u_1 = \\frac{1}{2}$\n$u_2 = \\frac{3}{2}$\n\nWe must check these roots against the physical constraint $0 < u < 1$.\nThe root $u_2 = \\frac{3}{2}$ is greater than $1$, so it is not a physically valid solution.\nThe root $u_1 = \\frac{1}{2}$ is within the valid range ($0 < \\frac{1}{2} < 1$). This is the unique interior solution for the surface coverage $u$ at the bifurcation point.\n\nNow, we find the corresponding value of $\\mu$ by substituting $u = \\frac{1}{2}$ into one of the expressions for $\\mu$. Using the first expression, $\\mu = \\frac{\\frac{3}{4} - u^2}{1-u}$:\n$$ \\mu = \\frac{\\frac{3}{4} - (\\frac{1}{2})^2}{1 - \\frac{1}{2}} = \\frac{\\frac{3}{4} - \\frac{1}{4}}{\\frac{1}{2}} = \\frac{\\frac{2}{4}}{\\frac{1}{2}} = \\frac{\\frac{1}{2}}{\\frac{1}{2}} = 1 $$\nFinally, we can find the value of $v$ at this point to ensure it also satisfies its constraint:\n$v = \\frac{3}{4}u = \\frac{3}{4} \\cdot \\frac{1}{2} = \\frac{3}{8}$.\nSince $0 < \\frac{3}{8} < 1$, this is a valid interior point.\nThe unique interior saddle-node bifurcation occurs at $(u,v) = (\\frac{1}{2}, \\frac{3}{8})$ when the parameter $\\mu$ has the value $1$. The question asks for this value of $\\mu$.\nThe final answer is the dimensionless value of $\\mu$ at the bifurcation.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "The emergence of intricate spatiotemporal patterns occurs when local nonlinear kinetics, with features like the bifurcations analyzed in , are coupled with the spatial transport of species via surface diffusion. This final practice bridges theory and observation by tasking you with building the computational machinery to simulate this process. You will develop a finite difference scheme to solve a full reaction-diffusion equation and, critically, derive the stability constraints (the Courant–Friedrichs–Lewy or CFL condition) for your numerical method. Mastering this skill is paramount for any computational scientist, as it ensures that your simulations of spirals, targets, and other patterns are both physically meaningful and numerically sound.",
            "id": "3893169",
            "problem": "Consider a two-dimensional reaction–diffusion model for adsorbate coverage on a catalytic surface, represented by a scalar field $ \\theta(x,y,t) $ that denotes the fractional surface coverage of an intermediate (dimensionless, bounded between $ 0 $ and $ 1 $). The governing equation, derived from mass conservation and Fick’s law with a source term for reaction kinetics, is\n$$\n\\partial_t \\theta = D \\nabla^2 \\theta + f(\\theta),\n$$\nwhere $ D > 0 $ is the surface diffusivity (dimensionless in this formulation) and $ f(\\theta) $ is a nonlinear reaction term derived from microkinetic models. The boundary is no-flux (Neumann): $ \\partial_n \\theta = 0 $ along all edges of the domain. Your tasks are:\n- Propose a second-order accurate finite difference scheme in space for $ \\nabla^2 \\theta $ on a uniform Cartesian grid and combine it with an explicit time-stepping method. Explicitly specify how to impose Neumann boundary conditions to second-order accuracy.\n- Linearize the scheme around a uniform state $ \\theta^\\star $ with $ f'(\\theta^\\star) = \\alpha $ (where $ \\alpha $ is a real constant) and derive a Courant–Friedrichs–Lewy (CFL) condition (time step restriction) for explicit forward Euler time stepping that guarantees absolute stability for the decaying modes. Clearly state the condition in terms of $ D $, $ \\Delta x $, $ \\Delta y $, and $ \\alpha $.\n- Implement a program that, for a suite of parameter sets, computes the maximum stable time step $ \\Delta t_{\\max} $ implied by your derived CFL condition and evaluates whether a given candidate time step $ \\Delta t $ satisfies the condition. If the linearized reaction slope $ \\alpha > 0 $, explain why no choice of $ \\Delta t $ can render the forward Euler scheme absolutely stable for long-wave modes, and define $ \\Delta t_{\\max} = 0 $ in this case.\n\nScientific base: use the conservation law $ \\partial_t \\theta = - \\nabla \\cdot \\mathbf{J} + R(\\theta) $, Fick’s law $ \\mathbf{J} = - D \\nabla \\theta $, and the definition of Neumann boundary condition $ \\partial_n \\theta = 0 $. Do not assume any pre-specified formulas beyond second-order central differences and forward Euler.\n\nDiscretization setting: Let the computational domain be $ [0,L_x] \\times [0,L_y] $ with uniform grids $ N_x $ and $ N_y $ points in $ x $ and $ y $, respectively. The grid spacings are $ \\Delta x = L_x/(N_x - 1) $ and $ \\Delta y = L_y/(N_y - 1) $. The second-order central difference stencil is used in the interior. At boundaries, impose the Neumann condition by appropriate ghost-point elimination or reflection to maintain second-order accuracy. The explicit time update is forward Euler.\n\nTest suite: For each case below, compute $ \\Delta t_{\\max} $ and a boolean indicating whether the provided $ \\Delta t $ satisfies the stability condition. All quantities are dimensionless.\n\n- Case $ 1 $ (general balanced diffusion and damping): $ L_x = 1.0 $, $ L_y = 1.0 $, $ N_x = 65 $, $ N_y = 65 $, $ D = 0.01 $, $ \\alpha = -1.5 $. Use $ \\Delta t = 0.6 \\, \\Delta t_{\\max} $.\n- Case $ 2 $ (anisotropic grid, pure diffusion): $ L_x = 2.0 $, $ L_y = 0.5 $, $ N_x = 51 $, $ N_y = 21 $, $ D = 0.05 $, $ \\alpha = 0.0 $. Use $ \\Delta t = 1.05 \\, \\Delta t_{\\max} $.\n- Case $ 3 $ (reaction-driven growth): $ L_x = 1.0 $, $ L_y = 1.0 $, $ N_x = 33 $, $ N_y = 33 $, $ D = 0.02 $, $ \\alpha = 0.5 $. Use $ \\Delta t = 10^{-3} $.\n- Case $ 4 $ (coarse grid, weak diffusion, mild damping): $ L_x = 1.0 $, $ L_y = 1.0 $, $ N_x = 3 $, $ N_y = 5 $, $ D = 10^{-4} $, $ \\alpha = -10^{-3} $. Use $ \\Delta t = 100.0 $.\n\nFinal output specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case’s result is the list $ [\\Delta t_{\\max}, \\text{is\\_stable}] $. For example, the output should look like $ [[a_1,b_1],[a_2,b_2],\\dots] $ with $ a_i $ a float and $ b_i $ a boolean.\n\nYour derivation and implementation must be universally applicable and fully self-contained, without reliance on external files or inputs. Angles do not appear; therefore, no angle unit specification is required. No physical units appear because the formulation is dimensionless.",
            "solution": "The problem requires the analysis of a reaction-diffusion model on a catalytic surface, governed by the partial differential equation (PDE):\n$$\n\\partial_t \\theta = D \\nabla^2 \\theta + f(\\theta)\n$$\nwhere $ \\theta(x,y,t) $ is the fractional surface coverage, $ D > 0 $ is the surface diffusivity, and $ f(\\theta) $ is a nonlinear reaction term. The domain is a rectangle $ [0,L_x] \\times [0,L_y] $ with no-flux (Neumann) boundary conditions, $ \\partial_n \\theta = 0 $.\n\nThe tasks involve proposing a numerical scheme, performing a linear stability analysis to derive the time step restriction (CFL condition) for an explicit forward Euler method, and implementing a program to compute this restriction for several test cases.\n\n### Task 1: Discretization Scheme\n\nWe discretize the domain using a uniform Cartesian grid with points $ (x_i, y_j) $, where $ x_i = i \\Delta x $ for $ i=0, \\dots, N_x-1 $ and $ y_j = j \\Delta y $ for $ j=0, \\dots, N_y-1 $. The grid spacings are $ \\Delta x = L_x/(N_x-1) $ and $ \\Delta y = L_y/(N_y-1) $. Let $ \\theta_{i,j}^n \\approx \\theta(x_i, y_j, n\\Delta t) $.\n\n**Spatial Discretization:** The Laplacian operator, $ \\nabla^2 \\theta = \\partial_{xx} \\theta + \\partial_{yy} \\theta $, is discretized using a second-order accurate central difference stencil for interior grid points:\n$$\n(\\nabla^2 \\theta)_{i,j} \\approx \\frac{\\theta_{i+1,j} - 2\\theta_{i,j} + \\theta_{i-1,j}}{(\\Delta x)^2} + \\frac{\\theta_{i,j+1} - 2\\theta_{i,j} + \\theta_{i,j-1}}{(\\Delta y)^2}\n$$\n\n**Temporal Discretization:** The time derivative, $ \\partial_t \\theta $, is discretized using the first-order accurate explicit forward Euler method:\n$$\n(\\partial_t \\theta)_{i,j}^n \\approx \\frac{\\theta_{i,j}^{n+1} - \\theta_{i,j}^n}{\\Delta t}\n$$\n\n**Full Discretized Equation:** Combining these, the update rule for an interior point is:\n$$\n\\frac{\\theta_{i,j}^{n+1} - \\theta_{i,j}^n}{\\Delta t} = D \\left( \\frac{\\theta_{i+1,j}^n - 2\\theta_{i,j}^n + \\theta_{i-1,j}^n}{(\\Delta x)^2} + \\frac{\\theta_{i,j+1}^n - 2\\theta_{i,j}^n + \\theta_{i,j-1}^n}{(\\Delta y)^2} \\right) + f(\\theta_{i,j}^n)\n$$\n\n**Neumann Boundary Conditions:** The no-flux condition $ \\partial_n \\theta = 0 $ is imposed to second-order accuracy using the method of ghost points. For example, at the left boundary $ i=0 $, the condition is $ \\partial_x \\theta = 0 $. A central difference approximation is centered at $ i=0 $:\n$$\n\\frac{\\theta_{1,j} - \\theta_{-1,j}}{2 \\Delta x} = 0 \\implies \\theta_{-1,j} = \\theta_{1,j}\n$$\nHere, $ \\theta_{-1,j} $ is the value at a fictitious \"ghost\" point outside the domain. By substituting this condition into the Laplacian stencil at $ i=0 $, we eliminate the ghost point:\n$$\n(\\partial_{xx} \\theta)_{0,j} \\approx \\frac{\\theta_{1,j} - 2\\theta_{0,j} + \\theta_{-1,j}}{(\\Delta x)^2} = \\frac{\\theta_{1,j} - 2\\theta_{0,j} + \\theta_{1,j}}{(\\Delta x)^2} = \\frac{2(\\theta_{1,j} - \\theta_{0,j})}{(\\Delta x)^2}\n$$\nThis procedure is applied similarly to all other boundaries and corners.\n\n### Task 2: Linear Stability Analysis and CFL Condition\n\nWe linearize the scheme around a uniform steady state $ \\theta^\\star $. A uniform state implies $ \\nabla^2 \\theta^\\star = 0 $, so the steady-state condition $ D \\nabla^2 \\theta^\\star + f(\\theta^\\star) = 0 $ reduces to $ f(\\theta^\\star) = 0 $. Let $ \\theta_{i,j}^n = \\theta^\\star + \\epsilon_{i,j}^n $, where $ \\epsilon_{i,j}^n $ is a small perturbation. The reaction term is linearized as $ f(\\theta_{i,j}^n) \\approx f(\\theta^\\star) + f'(\\theta^\\star)(\\theta_{i,j}^n - \\theta^\\star) = \\alpha \\epsilon_{i,j}^n $.\n\nSubstituting this into the discretized equation and canceling terms yields the evolution equation for the perturbation:\n$$\n\\frac{\\epsilon_{i,j}^{n+1} - \\epsilon_{i,j}^n}{\\Delta t} = D \\left( \\frac{\\epsilon_{i+1,j}^n - 2\\epsilon_{i,j}^n + \\epsilon_{i-1,j}^n}{(\\Delta x)^2} + \\frac{\\epsilon_{i,j+1}^n - 2\\epsilon_{i,j}^n + \\epsilon_{i,j-1}^n}{(\\Delta y)^2} \\right) + \\alpha \\epsilon_{i,j}^n\n$$\nWe perform a von Neumann stability analysis by considering a single Fourier mode for the perturbation, $ \\epsilon_{i,j}^n = G^n e^{I(k_x x_i + k_y y_j)} $, where $ G $ is the amplification factor and $ I = \\sqrt{-1} $. Substituting this form into the perturbation equation gives:\n$$\nG = 1 + \\Delta t \\left[ D \\left( \\frac{e^{I k_x \\Delta x} + e^{-I k_x \\Delta x} - 2}{(\\Delta x)^2} + \\frac{e^{I k_y \\Delta y} + e^{-I k_y \\Delta y} - 2}{(\\Delta y)^2} \\right) + \\alpha \\right]\n$$\nUsing $ e^{i\\phi} + e^{-i\\phi} = 2\\cos(\\phi) $ and $ \\cos(\\phi) - 1 = -2\\sin^2(\\phi/2) $, we simplify the expression for $ G $:\n$$\nG(k_x, k_y) = 1 + \\alpha \\Delta t - \\frac{4 D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) - \\frac{4 D \\Delta t}{(\\Delta y)^2} \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right)\n$$\nFor absolute stability of the forward Euler scheme, the amplification factor must satisfy $ |G| \\le 1 $ for all possible wavenumbers $ k_x, k_y $. Since $ G $ is real, this is equivalent to $ -1 \\le G \\le 1 $.\n\n1.  **Upper Bound, $ G \\le 1 $**:\n    $$\n    1 + \\alpha \\Delta t - \\Delta t \\left[ \\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{4D}{(\\Delta y)^2} \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right] \\le 1\n    $$\n    $$\n    \\alpha \\le \\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{4D}{(\\Delta y)^2} \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right)\n    $$\n    The term on the right is always non-negative. If $ \\alpha \\le 0 $, this condition is always satisfied. However, if $ \\alpha > 0 $, we must consider the \"long-wave modes\" where $ k_x \\to 0 $ and $ k_y \\to 0 $. For the mode $ (k_x, k_y) = (0,0) $, the right-hand side is $ 0 $. The condition becomes $ \\alpha \\le 0 $, which contradicts the assumption $ \\alpha > 0 $. This means that for any $ \\Delta t > 0 $, the uniform perturbation mode will grow as $ \\epsilon^{n+1} = (1 + \\alpha \\Delta t)\\epsilon^n $, rendering the scheme unconditionally unstable. Therefore, for $ \\alpha > 0 $, the maximum stable time step is $ \\Delta t_{\\max} = 0 $.\n\n2.  **Lower Bound, $ G \\ge -1 $**:\n    $$\n    -1 \\le 1 + \\alpha \\Delta t - \\Delta t \\left[ \\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{4D}{(\\Delta y)^2} \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) \\right]\n    $$\n    $$\n    \\Delta t \\left[ \\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{4D}{(\\Delta y)^2} \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) - \\alpha \\right] \\le 2\n    $$\n    This condition must hold for all wavenumbers. The most restrictive case (the one that constrains $ \\Delta t $ most severely) occurs when the term in the brackets is maximized. This happens for the highest frequency modes, where $ \\sin^2(\\cdot) $ reaches its maximum value of $ 1 $. The corresponding wavenumbers, e.g., $ k_x = \\pi / \\Delta x $, are present in the discrete spectrum for Neumann boundary conditions.\n    The maximum value of the bracketed term is $ \\frac{4D}{(\\Delta x)^2} + \\frac{4D}{(\\Delta y)^2} - \\alpha $.\n    The stability condition becomes:\n    $$\n    \\Delta t \\left( 4D\\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right) - \\alpha \\right) \\le 2\n    $$\n    For $ \\alpha \\le 0 $, the term $ 4D(\\dots) - \\alpha $ is strictly positive. We can rearrange to find the limit on $ \\Delta t $.\n\n**CFL Condition:**\n-   If $ \\alpha > 0 $, then $ \\Delta t_{\\max} = 0 $.\n-   If $ \\alpha \\le 0 $, the maximum stable time step is:\n    $$\n    \\Delta t_{\\max} = \\frac{2}{4D\\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right) - \\alpha}\n    $$\n    A given time step $ \\Delta t $ is stable if and only if $ \\Delta t \\le \\Delta t_{\\max} $.\n\n### Implementation Logic\n\nThe program will implement the derived formulas to solve the test suite. For each case, it will:\n1.  Calculate grid spacings $ \\Delta x = L_x / (N_x - 1) $ and $ \\Delta y = L_y / (N_y - 1) $.\n2.  Check the value of $ \\alpha $. If $ \\alpha > 0 $, set $ \\Delta t_{\\max} = 0 $.\n3.  If $ \\alpha \\le 0 $, calculate $ \\Delta t_{\\max} $ using the formula derived above.\n4.  Determine the candidate time step $ \\Delta t $ from the problem specification.\n5.  Evaluate the boolean stability condition $ \\Delta t \\le \\Delta t_{\\max} $.\n6.  Collect the pair $ [\\Delta t_{\\max}, \\text{is\\_stable}] $ for each case and format the final output as specified.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_stability(Lx, Ly, Nx, Ny, D, alpha, dt_candidate_spec):\n    \"\"\"\n    Calculates the maximum stable time step and checks a candidate time step.\n\n    Args:\n        Lx (float): Domain length in x.\n        Ly (float): Domain length in y.\n        Nx (int): Number of grid points in x.\n        Ny (int): Number of grid points in y.\n        D (float): Diffusivity.\n        alpha (float): Linearized reaction rate slope.\n        dt_candidate_spec (tuple): A tuple (value, type) where type can be\n                                   'relative' or 'absolute'.\n\n    Returns:\n        list: A list containing [dt_max, is_stable].\n    \"\"\"\n    if Nx > 1:\n        dx = Lx / (Nx - 1)\n        dx_inv_sq = 1 / dx**2\n    else:\n        dx_inv_sq = 0\n\n    if Ny > 1:\n        dy = Ly / (Ny - 1)\n        dy_inv_sq = 1 / dy**2\n    else:\n        dy_inv_sq = 0\n\n    dt_max = 0.0\n    if alpha > 0:\n        # Unconditionally unstable for the long-wave mode (k=0) with forward Euler.\n        dt_max = 0.0\n    else:  # alpha = 0\n        denominator = 4.0 * D * (dx_inv_sq + dy_inv_sq) - alpha\n        if denominator > 1e-12: # Avoid division by zero or small numbers\n            dt_max = 2.0 / denominator\n        else:\n            # Denominator is non-positive, meaning no restriction from this condition.\n            # This can happen if D=0 and alpha=0.\n            # Effectively, the time step can be infinitely large.\n            dt_max = float('inf')\n\n    # Determine the candidate dt\n    val, spec_type = dt_candidate_spec\n    if spec_type == 'relative':\n        dt_candidate = val * dt_max\n    else: # absolute\n        dt_candidate = val\n\n    # Check stability. The tolerance is to handle floating point comparisons.\n    is_stable = dt_candidate = dt_max + 1e-12 * abs(dt_max)\n    \n    return [dt_max, is_stable]\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite.\n    \"\"\"\n    test_cases = [\n        # Case 1: L_x, L_y, N_x, N_y, D, alpha, dt_candidate_spec\n        (1.0, 1.0, 65, 65, 0.01, -1.5, (0.6, 'relative')),\n        # Case 2\n        (2.0, 0.5, 51, 21, 0.05, 0.0, (1.05, 'relative')),\n        # Case 3\n        (1.0, 1.0, 33, 33, 0.02, 0.5, (1e-3, 'absolute')),\n        # Case 4\n        (1.0, 1.0, 3, 5, 1e-4, -1e-3, (100.0, 'absolute')),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, Nx, Ny, D, alpha, dt_spec = case\n        result = calculate_stability(Lx, Ly, Nx, Ny, D, alpha, dt_spec)\n        results.append(result)\n\n    # Format output as a string representing a list of lists.\n    # e.g., [[val1, bool1], [val2, bool2], ...]\n    output_str = '['\n    for i, res in enumerate(results):\n        dt_max_str = f\"{res[0]:.7f}\" if np.isfinite(res[0]) else \"'inf'\"\n        is_stable_str = str(res[1]).lower()\n        output_str += f\"[{dt_max_str}, {is_stable_str}]\"\n        if i  len(results) - 1:\n            output_str += ', '\n    output_str += ']'\n    \n    # The problem asks for the output line, not python to print it.\n    # But for self-containment, the print statement is used here.\n    # The actual output string for copy-pasting is constructed above.\n    print(str(results).replace(\"'\", \"\"))\n\n\nsolve()\n```"
        }
    ]
}