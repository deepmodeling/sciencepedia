{
    "hands_on_practices": [
        {
            "introduction": "The long-term stability of a molecular dynamics simulation is paramount, and it hinges critically on the choice of the integration algorithm. For Hamiltonian systems, where total energy should be conserved, not all numerical methods are equal. This exercise explores the crucial property of \"symplecticity,\" which guarantees bounded energy error over long timescales. By implementing and contrasting the symplectic Velocity Verlet algorithm with the simpler, non-symplectic Forward Euler method for a harmonic oscillator, you will gain a concrete, hands-on understanding of why Verlet-type integrators are the foundation of modern MD simulations .",
            "id": "3873271",
            "problem": "Consider a one-dimensional Hamiltonian system representative of a Molecular Dynamics (MD) microcanonical trajectory for a single particle in a harmonic potential, defined by the Hamiltonian $H(q,p) = T(p) + V(q)$ with $T(p) = \\frac{p^2}{2m}$ and $V(q) = \\frac{k q^2}{2}$. The equations of motion are given by Newton's second law and Hamilton's equations, namely $\\dot{q} = \\frac{\\partial H}{\\partial p}$ and $\\dot{p} = -\\frac{\\partial H}{\\partial q}$, with $m$ denoting mass, $k$ the spring constant, $q$ the position, and $p$ the momentum. The phase-space symplectic form is represented by the constant skew-symmetric matrix $J$ and a discrete-time map $(q_n,p_n) \\mapsto (q_{n+1},p_{n+1})$ is symplectic if its Jacobian $M$ satisfies $M^\\top J M = J$. You will relate symplecticity to numerical stability and demonstrate a counterexample where a non-symplectic integrator exhibits secular energy drift.\n\nStarting from Newton's laws and the separable Hamiltonian structure, derive from first principles why a composition method that exactly integrates the kinetic and potential sub-Hamiltonians (a kick-drift-kick scheme commonly known in computational chemistry as the Velocity Verlet method) is symplectic. Contrast this with the explicit Forward Euler method and argue, on the basis of the linearized update and the volume-preservation/symplecticity condition, why Forward Euler is not symplectic for the harmonic oscillator and therefore can produce secular energy drift.\n\nThen implement a program that numerically integrates the harmonic oscillator with reduced units specified explicitly as follows: set the mass to $m = 1$, the spring constant to $k = 1$, and the angular frequency to $\\omega = \\sqrt{k/m} = 1$. Use initial conditions $q(0) = 1$ and $p(0) = 0$ (equivalently, initial velocity $v(0) = p(0)/m = 0$). Integrate the equations of motion over a total reduced time $T$, producing time series for position $q_n$, velocity $v_n$, and energy $E_n = \\frac{1}{2} m v_n^2 + \\frac{1}{2} k q_n^2$ at each time step $t_n = n \\Delta t$.\n\nImplement and compare two integrators:\n\n- The Velocity Verlet method, which uses the kick-drift-kick composition of exact sub-flows of $T(p)$ and $V(q)$.\n- The explicit Forward Euler method, which updates position and velocity by applying the right-hand sides of the ordinary differential equations at the current state.\n\nFor each integrator and each test case, compute the least-squares linear regression slope of $E_n$ versus $t_n$. This slope has units of reduced energy per reduced time and should be reported as a floating-point number. A near-zero slope indicates bounded energy error, whereas a positive slope indicates secular drift.\n\nUse the following test suite, which exercises a happy path, a moderate time step, and a larger time step edge case:\n\n- Test case $1$: $\\Delta t = 0.01$, $T = 100$.\n- Test case $2$: $\\Delta t = 0.05$, $T = 100$.\n- Test case $3$: $\\Delta t = 0.20$, $T = 100$.\n\nFor each test case, compute and return a pair of floats $[s_{\\mathrm{Euler}}, s_{\\mathrm{Verlet}}]$, where $s_{\\mathrm{Euler}}$ is the regression slope for Forward Euler and $s_{\\mathrm{Verlet}}$ is the regression slope for Velocity Verlet. All quantities are in reduced units with $m = 1$, $k = 1$, and $\\omega = 1$, and slopes must be expressed in reduced energy per reduced time.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and ordered by the test cases as given. Each element in the list must itself be a comma-separated, bracketed list with the pair $[s_{\\mathrm{Euler}}, s_{\\mathrm{Verlet}}]$. For example, the output format must be exactly like $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$, where $x_i$ and $y_i$ are floating-point numbers computed by your program for test case $i$.",
            "solution": "Begin with the separable Hamiltonian $H(q,p) = T(p) + V(q)$, where $T(p) = \\frac{p^2}{2m}$ and $V(q) = \\frac{k q^2}{2}$. Hamilton's equations are $\\dot{q} = \\frac{\\partial H}{\\partial p}$ and $\\dot{p} = -\\frac{\\partial H}{\\partial q}$. In reduced units with $m = 1$ and $k = 1$, the angular frequency is $\\omega = \\sqrt{k/m} = 1$ and the equations simplify to $\\dot{q} = p$ and $\\dot{p} = -q$, or equivalently $\\ddot{q} = -q$.\n\nA map $(q_n,p_n) \\mapsto (q_{n+1},p_{n+1})$ is symplectic if its Jacobian $M$ satisfies the symplectic condition $M^\\top J M = J$, where for one degree of freedom the canonical symplectic form corresponds to the matrix\n$$\nJ = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}.\n$$\nSymplectic maps preserve phase-space volume (Liouville's theorem) and the symplectic two-form, and, via backward error analysis, they can be interpreted as the exact flow of a modified Hamiltonian $\\tilde{H}$ that differs from $H$ by higher-order terms in the time step $\\Delta t$. This implies that along symplectic numerical trajectories, the energy error is bounded and typically oscillatory around the true constant energy.\n\nConsider the composition of exact sub-flows of the kinetic and potential sub-Hamiltonians over a time step $\\Delta t$. The exact flow generated by $T(p)$ with $V(q)$ held constant updates $q$ by a drift and leaves $p$ unchanged:\n$$\n\\Phi_T^{\\Delta t}: \\quad q \\mapsto q + \\Delta t \\,\\frac{\\partial T}{\\partial p} = q + \\Delta t \\, p, \\quad p \\mapsto p.\n$$\nThe exact flow generated by $V(q)$ with $T(p)$ held constant updates $p$ by a kick and leaves $q$ unchanged:\n$$\n\\Phi_V^{\\Delta t}: \\quad q \\mapsto q, \\quad p \\mapsto p - \\Delta t \\, \\frac{\\partial V}{\\partial q} = p - \\Delta t \\, k q.\n$$\nEach sub-flow is symplectic because it is the exact Hamiltonian evolution of a separable Hamiltonian component. The Velocity Verlet method is the symmetric Strang composition (kick-drift-kick):\n$$\n\\Phi_{\\mathrm{VV}}^{\\Delta t} = \\Phi_V^{\\Delta t/2} \\circ \\Phi_T^{\\Delta t} \\circ \\Phi_V^{\\Delta t/2}.\n$$\nA composition of symplectic maps is symplectic, hence $\\Phi_{\\mathrm{VV}}^{\\Delta t}$ is symplectic. In explicit update form for one dimension with $m = 1$ and $k = 1$, this reads:\n- Half kick: $p_{n+\\frac{1}{2}} = p_n - \\frac{\\Delta t}{2} \\, q_n$.\n- Drift: $q_{n+1} = q_n + \\Delta t \\, p_{n+\\frac{1}{2}}$.\n- Half kick: $p_{n+1} = p_{n+\\frac{1}{2}} - \\frac{\\Delta t}{2} \\, q_{n+1}$.\nEquivalently using velocity $v = p/m$ and acceleration $a(q) = -q$, one has the well-known Velocity Verlet steps:\n$$\nv_{n+\\frac{1}{2}} = v_n + \\frac{\\Delta t}{2} \\, a(q_n), \\quad q_{n+1} = q_n + \\Delta t \\, v_{n+\\frac{1}{2}}, \\quad v_{n+1} = v_{n+\\frac{1}{2}} + \\frac{\\Delta t}{2} \\, a(q_{n+1}).\n$$\nBecause the method is a symmetric composition of exact sub-flows, it preserves the symplectic form and exhibits bounded energy error consistent with the exact flow of a nearby modified Hamiltonian $\\tilde{H} = H + \\mathcal{O}(\\Delta t^2)$.\n\nIn contrast, the explicit Forward Euler method for the harmonic oscillator applies the right-hand sides at the current state:\n$$\nq_{n+1} = q_n + \\Delta t \\, v_n, \\quad v_{n+1} = v_n + \\Delta t \\, a(q_n) = v_n - \\Delta t \\, q_n.\n$$\nWriting the update for the state vector $x_n = \\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}$, the Forward Euler method yields a linear map $x_{n+1} = A x_n$ with\n$$\nA = \\begin{pmatrix}\n1 & \\Delta t \\\\\n- \\Delta t & 1\n\\end{pmatrix}.\n$$\nFor a symplectic map in one dimension, phase-space volume must be preserved, which implies $\\det(A) = 1$. Here,\n$$\n\\det(A) = 1 + (\\Delta t)^2 > 1,\n$$\nso the method does not preserve phase-space volume and thus is not symplectic. An equivalent symplecticity test is $A^\\top J A = J$, which fails for this $A$. The eigenvalues of $A$ are\n$$\n\\lambda_{\\pm} = 1 \\pm i \\Delta t,\n$$\nwith magnitude $|\\lambda_{\\pm}| = \\sqrt{1 + (\\Delta t)^2} > 1$, indicating amplification of the state norm and secular growth of energy. Therefore, Forward Euler produces secular energy drift even for small $\\Delta t$ when applied to undamped oscillatory Hamiltonian systems.\n\nTo quantify this behavior numerically, one computes the energy at each discrete time,\n$$\nE_n = \\frac{1}{2} m v_n^2 + \\frac{1}{2} k q_n^2,\n$$\nwith $m = 1$ and $k = 1$ in reduced units. For each integrator and test case, one performs a least-squares linear regression of $E_n$ versus $t_n = n \\Delta t$ to obtain a slope $s$ with units of reduced energy per reduced time. A slope $s$ near $0$ indicates bounded oscillatory energy error, consistent with a symplectic integrator. A positive slope $s$ indicates secular energy growth, consistent with a non-symplectic integrator.\n\nThe program implements both integrators, generates trajectories for the specified test suite, computes the regression slopes for energy drift, and outputs a single line containing the list $[[s_{\\mathrm{Euler}}^{(1)}, s_{\\mathrm{Verlet}}^{(1)}],[s_{\\mathrm{Euler}}^{(2)}, s_{\\mathrm{Verlet}}^{(2)}],[s_{\\mathrm{Euler}}^{(3)}, s_{\\mathrm{Verlet}}^{(3)}]]$, where the superscript index denotes the test case. The expected qualitative outcome is that $s_{\\mathrm{Euler}}^{(i)}$ are positive and grow with $\\Delta t$, while $s_{\\mathrm{Verlet}}^{(i)}$ remain near zero across all test cases, demonstrating the link between symplecticity and numerical stability in MD and providing a counterexample where a non-symplectic integrator exhibits secular energy drift.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef forward_euler_ho(q0, v0, dt, T):\n    \"\"\"\n    Forward Euler integration for 1D harmonic oscillator with m=1, k=1.\n    Returns arrays of times and energies.\n    \"\"\"\n    n_steps = int(np.round(T / dt))\n    q = q0\n    v = v0\n    times = np.empty(n_steps + 1, dtype=float)\n    energies = np.empty(n_steps + 1, dtype=float)\n    # initial\n    times[0] = 0.0\n    energies[0] = 0.5 * v * v + 0.5 * q * q\n    for n in range(1, n_steps + 1):\n        # Forward Euler updates\n        q_new = q + dt * v\n        v_new = v - dt * q\n        q, v = q_new, v_new\n        t = n * dt\n        times[n] = t\n        energies[n] = 0.5 * v * v + 0.5 * q * q\n    return times, energies\n\ndef velocity_verlet_ho(q0, v0, dt, T):\n    \"\"\"\n    Velocity Verlet integration for 1D harmonic oscillator with m=1, k=1.\n    Returns arrays of times and energies.\n    \"\"\"\n    n_steps = int(np.round(T / dt))\n    q = q0\n    v = v0\n    # acceleration a = -q\n    a = -q\n    times = np.empty(n_steps + 1, dtype=float)\n    energies = np.empty(n_steps + 1, dtype=float)\n    times[0] = 0.0\n    energies[0] = 0.5 * v * v + 0.5 * q * q\n    for n in range(1, n_steps + 1):\n        # half kick\n        v_half = v + 0.5 * dt * a\n        # drift\n        q_new = q + dt * v_half\n        # new acceleration\n        a_new = -q_new\n        # half kick\n        v_new = v_half + 0.5 * dt * a_new\n        # update\n        q, v, a = q_new, v_new, a_new\n        t = n * dt\n        times[n] = t\n        energies[n] = 0.5 * v * v + 0.5 * q * q\n    return times, energies\n\ndef linear_regression_slope(t, y):\n    \"\"\"\n    Compute least-squares slope of y vs t.\n    \"\"\"\n    # subtract means to improve numerical stability\n    t_mean = np.mean(t)\n    y_mean = np.mean(y)\n    dt = t - t_mean\n    dy = y - y_mean\n    denom = np.dot(dt, dt)\n    if denom == 0.0:\n        return 0.0\n    slope = float(np.dot(dt, dy) / denom)\n    return slope\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (dt, T)\n    test_cases = [\n        (0.01, 100.0),  # happy path: small time step\n        (0.05, 100.0),  # moderate time step\n        (0.20, 100.0),  # larger time step edge case\n    ]\n    # initial conditions in reduced units: m=1, k=1, omega=1\n    q0 = 1.0\n    v0 = 0.0\n\n    results = []\n    for dt, T in test_cases:\n        # Forward Euler\n        t_eu, e_eu = forward_euler_ho(q0, v0, dt, T)\n        slope_eu = linear_regression_slope(t_eu, e_eu)\n        # Velocity Verlet\n        t_vv, e_vv = velocity_verlet_ho(q0, v0, dt, T)\n        slope_vv = linear_regression_slope(t_vv, e_vv)\n        results.append([slope_eu, slope_vv])\n\n    # Final print statement in the exact required format.\n    # Print as a list of lists: [[s_eu1,s_vv1],[s_eu2,s_vv2],[s_eu3,s_vv3]]\n    # Convert floats to repr to avoid scientific notation quirks; default str is fine.\n    def fmt_pair(pair):\n        return \"[\" + \",\".join(map(str, pair)) + \"]\"\n    print(\"[\" + \",\".join(fmt_pair(r) for r in results) + \"]\")\n\nsolve()\n```"
        },
        {
            "introduction": "To simulate bulk materials and avoid artificial surface effects, molecular dynamics simulations universally employ periodic boundary conditions (PBC). This technique tiles space with replicas of the central simulation box, creating an effectively infinite system. A fundamental challenge in PBC is to correctly calculate the interaction between particles by considering the closest periodic image, a rule known as the \"minimum image convention.\" This practice requires you to derive the mathematical formula for this convention from first principles, providing a deep, geometric insight into how interactions are computed in the vast majority of MD simulations .",
            "id": "3873256",
            "problem": "In classical molecular dynamics for computational catalysis and chemical engineering, interactions between particles are often computed in a periodically replicated cubic simulation cell to mimic bulk environments. Consider two particles with Cartesian positions $\\mathbf{r}_{i} = (x_{i}, y_{i}, z_{i})$ and $\\mathbf{r}_{j} = (x_{j}, y_{j}, z_{j})$ inside a cubic box of side length $L$ under periodic boundary conditions (PBC). The space is tiled by integer translations of the cubic box, so that particle $j$ has infinitely many images at positions $\\mathbf{r}_{j} + L \\mathbf{n}$ for $\\mathbf{n} \\in \\mathbb{Z}^{3}$. The Euclidean separation between $i$ and a given image of $j$ is defined by the Euclidean norm. In practice, the minimum image convention is used to compute pairwise interactions by selecting the image of particle $j$ that is closest to particle $i$.\n\nUsing only the following foundational elements:\n- the Euclidean norm in $\\mathbb{R}^{3}$,\n- the periodic tiling by the cubic lattice $L \\mathbb{Z}^{3}$,\n- and the definition of the minimum image convention as the choice of the image that minimizes the Euclidean distance,\n\nderive from first principles a closed-form analytic expression for the minimum-image interparticle separation $r_{ij}$ in terms of the raw component differences $\\Delta x = x_{j} - x_{i}$, $\\Delta y = y_{j} - y_{i}$, $\\Delta z = z_{j} - z_{i}$, and the box length $L$. Your final expression must be written explicitly using only arithmetic operations and, if needed, the floor function. Do not invoke any prepackaged “wrapping” formulas; show how the formula follows from the minimization over integer lattice translations.\n\nProvide, as your final answer, the single closed-form analytic expression for $r_{ij}$ that implements the minimum image convention in a cubic box of side length $L$. No numerical evaluation is required. Express the final answer as a single analytic expression without units.",
            "solution": "The problem requires the derivation of a closed-form analytic expression for the minimum-image interparticle separation, $r_{ij}$, between two particles $i$ and $j$ in a cubic simulation box of side length $L$ under periodic boundary conditions. The derivation must proceed from first principles, namely the minimization of the Euclidean distance over all periodic images.\n\nLet the Cartesian positions of the two particles be $\\mathbf{r}_{i} = (x_{i}, y_{i}, z_{i})$ and $\\mathbf{r}_{j} = (x_{j}, y_{j}, z_{j})$. Due to the periodic boundary conditions, particle $j$ has an infinite number of periodic images located at positions $\\mathbf{r}_{j,\\mathbf{n}} = \\mathbf{r}_{j} + L \\mathbf{n}$, where $\\mathbf{n} = (n_x, n_y, n_z)$ is an integer vector, i.e., $n_x, n_y, n_z \\in \\mathbb{Z}$.\n\nThe vector separation between particle $i$ and an image $\\mathbf{n}$ of particle $j$ is given by:\n$$ \\mathbf{d}(\\mathbf{n}) = \\mathbf{r}_{j,\\mathbf{n}} - \\mathbf{r}_{i} = (\\mathbf{r}_{j} - \\mathbf{r}_{i}) + L \\mathbf{n} $$\nLet $\\Delta\\mathbf{r} = \\mathbf{r}_{j} - \\mathbf{r}_{i} = (\\Delta x, \\Delta y, \\Delta z)$ be the raw separation vector, where $\\Delta x = x_{j} - x_{i}$, $\\Delta y = y_{j} - y_{i}$, and $\\Delta z = z_{j} - z_{i}$. The separation vector to an image is then $\\mathbf{d}(\\mathbf{n}) = \\Delta\\mathbf{r} + L \\mathbf{n}$.\n\nThe minimum image convention states that the interaction is computed using the shortest possible separation vector. This corresponds to finding the integer vector $\\mathbf{n}^*$ that minimizes the squared Euclidean distance, $d^2(\\mathbf{n}) = ||\\mathbf{d}(\\mathbf{n})||^2$.\n$$ d^2(\\mathbf{n}) = ||\\Delta\\mathbf{r} + L \\mathbf{n}||^2 = (\\Delta x + L n_x)^2 + (\\Delta y + L n_y)^2 + (\\Delta z + L n_z)^2 $$\nThe total squared distance is a sum of three independent terms, one for each Cartesian coordinate. Therefore, we can minimize the total distance by minimizing each term separately. Let us focus on the $x$-component term:\n$$ f(n_x) = (\\Delta x + L n_x)^2 $$\nWe need to find the integer $n_x \\in \\mathbb{Z}$ that minimizes this function. The expression represents a parabola in the variable $n_x$. The minimum of this parabola occurs when the term inside the square is zero, i.e., $\\Delta x + L n_x = 0$, which would give a (generally non-integer) value of $n_x = -\\frac{\\Delta x}{L}$. Since $n_x$ must be an integer, the integer $n_x^*$ that minimizes $f(n_x)$ is the integer closest to the real-valued minimum, $-\\frac{\\Delta x}{L}$.\n\nAn alternative and more direct approach is to define the minimum image separation vector, $\\Delta\\mathbf{r}' = (\\Delta x', \\Delta y', \\Delta z')$. This vector is the shortest possible vector connecting particle $i$ to any image of particle $j$. Such a vector must have components that lie within the central simulation box centered at the origin, which for a cubic box of side $L$ is the region $[-\\frac{L}{2}, \\frac{L}{2}] \\times [-\\frac{L}{2}, \\frac{L}{2}] \\times [-\\frac{L}{2}, \\frac{L}{2}]$.\nThe minimum image vector $\\Delta\\mathbf{r}'$ is related to the raw separation vector $\\Delta\\mathbf{r}$ by a translation of an integer multiple of the box vector:\n$$ \\Delta\\mathbf{r}' = \\Delta\\mathbf{r} - L \\mathbf{m} $$\nfor some integer vector $\\mathbf{m} = (m_x, m_y, m_z) \\in \\mathbb{Z}^3$. We need to find the integer $m_x$ such that the resulting component $\\Delta x'$ falls within the desired range. By convention, we choose the interval $[-\\frac{L}{2}, \\frac{L}{2})$.\n$$ -\\frac{L}{2} \\le \\Delta x' < \\frac{L}{2} $$\nSubstituting the expression for $\\Delta x'$:\n$$ -\\frac{L}{2} \\le \\Delta x - L m_x < \\frac{L}{2} $$\nDividing all parts by $L$:\n$$ -\\frac{1}{2} \\le \\frac{\\Delta x}{L} - m_x < \\frac{1}{2} $$\nRearranging the inequalities to isolate $m_x$:\n$$ \\frac{\\Delta x}{L} - \\frac{1}{2} < m_x \\le \\frac{\\Delta x}{L} + \\frac{1}{2} $$\nFor any real number $u$, there is a unique integer $k$ in the interval $(u-1, u]$, which is given by $k = \\lfloor u \\rfloor$. Applying this to our inequality, with $u = \\frac{\\Delta x}{L} + \\frac{1}{2}$, we find that the unique integer $m_x$ must be:\n$$ m_x = \\left\\lfloor \\frac{\\Delta x}{L} + \\frac{1}{2} \\right\\rfloor $$\nThis expression effectively rounds the value $\\frac{\\Delta x}{L}$ to the nearest integer.\n\nThe component of the minimum image separation vector in the $x$-direction is therefore:\n$$ \\Delta x' = \\Delta x - L m_x = \\Delta x - L \\left\\lfloor \\frac{\\Delta x}{L} + \\frac{1}{2} \\right\\rfloor $$\nThe same logic applies independently to the $y$ and $z$ components:\n$$ \\Delta y' = \\Delta y - L \\left\\lfloor \\frac{\\Delta y}{L} + \\frac{1}{2} \\right\\rfloor $$\n$$ \\Delta z' = \\Delta z - L \\left\\lfloor \\frac{\\Delta z}{L} + \\frac{1}{2} \\right\\rfloor $$\nThe minimum-image interparticle separation, $r_{ij}$, is the Euclidean norm (magnitude) of this minimum image separation vector $\\Delta\\mathbf{r}' = (\\Delta x', \\Delta y', \\Delta z')$.\n$$ r_{ij} = ||\\Delta\\mathbf{r}'|| = \\sqrt{(\\Delta x')^2 + (\\Delta y')^2 + (\\Delta z')^2} $$\nSubstituting the expressions for the components, we arrive at the final closed-form expression for $r_{ij}$:\n$$ r_{ij} = \\sqrt{ \\left( \\Delta x - L \\left\\lfloor \\frac{\\Delta x}{L} + \\frac{1}{2} \\right\\rfloor \\right)^2 + \\left( \\Delta y - L \\left\\lfloor \\frac{\\Delta y}{L} + \\frac{1}{2} \\right\\rfloor \\right)^2 + \\left( \\Delta z - L \\left\\lfloor \\frac{\\Delta z}{L} + \\frac{1}{2} \\right\\rfloor \\right)^2 } $$\nThis expression is constructed solely from arithmetic operations and the floor function, as required by the problem statement.",
            "answer": "$$\n\\boxed{\n\\sqrt{ \\left( \\Delta x - L \\left\\lfloor \\frac{\\Delta x}{L} + \\frac{1}{2} \\right\\rfloor \\right)^2 + \\left( \\Delta y - L \\left\\lfloor \\frac{\\Delta y}{L} + \\frac{1}{2} \\right\\rfloor \\right)^2 + \\left( \\Delta z - L \\left\\lfloor \\frac{\\Delta z}{L} + \\frac{1}{2} \\right\\rfloor \\right)^2 }\n}\n$$"
        },
        {
            "introduction": "A successful molecular dynamics simulation requires a careful marriage of the physical model and the numerical algorithm. The choice of timestep, $\\Delta t$, is not arbitrary; it is fundamentally limited by the fastest motions in the system, which are dictated by the steepness of the interaction potentials. This capstone exercise connects these concepts by having you analyze the widely used Lennard-Jones potential. You will derive its characteristic vibrational frequency and use it to determine the maximum stable timestep for the Verlet algorithm, thus linking the analytical properties of a physical potential directly to a critical, practical parameter for running a stable simulation .",
            "id": "3873340",
            "problem": "A pair of identical adsorbate atoms of mass $m$ each interact via the Lennard–Jones (LJ) pair potential $u(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$, where $r$ is the interatomic separation, $\\epsilon > 0$ sets the energy scale, and $\\sigma > 0$ sets the length scale. In a Molecular Dynamics (MD) simulation advanced with the Verlet algorithm, the maximum stable time step is constrained by the highest vibrational frequency of the system. Starting strictly from Newton’s second law and the definition of force as the negative gradient of potential energy, do the following:\n\n1. Derive the scalar radial force $f(r)=-\\frac{du}{dr}$ associated with $u(r)$ and write the pairwise force vector $\\mathbf{F}(r)=f(r)\\,\\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the unit vector along the interatomic axis.\n2. Determine the equilibrium separation $r_{\\mathrm{m}}$ by solving $\\frac{du}{dr}=0$, and compute the curvature $u''(r_{\\mathrm{m}})$.\n3. Linearize the relative motion about $r_{\\mathrm{m}}$ to obtain a harmonic oscillator for the relative coordinate with reduced mass $\\mu$ and angular frequency $\\omega$. Using the discrete position-Verlet update obtained from Taylor-expanding the exact solution to second order, perform a linear stability analysis of the resulting recurrence relation for the harmonic oscillator and obtain the largest stable time step $\\Delta t_{\\max}$ in terms of $\\omega$.\n4. Combine the above results to express $\\Delta t_{\\max}$ solely in terms of $m$, $\\sigma$, and $\\epsilon$.\n\nBriefly note the limiting behaviors of the LJ force derived in part 1 as $r\\to 0$ and as $r\\to \\infty$ to ensure physical realism of your expressions, but do not include these limits in your final boxed answer.\n\nExpress your final answer as a single closed-form analytic expression in terms of $m$ (kilograms), $\\sigma$ (meters), and $\\epsilon$ (Joules). Do not substitute numerical values. Do not include units inside the final boxed answer.",
            "solution": "The solution proceeds in four stages as specified by the problem statement.\n\n1. Derivation of the interaction force.\nThe Lennard-Jones (LJ) pair potential is given by\n$$u(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\nwhere $r$ is the interatomic separation, $\\epsilon$ is the energy scale, and $\\sigma$ is the length scale. For ease of differentiation, we can write the potential as\n$$u(r) = 4\\epsilon\\left[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}\\right]$$\nThe scalar radial force $f(r)$ is defined as the negative gradient of the potential energy, $f(r) = -\\frac{du}{dr}$. Applying this definition:\n$$f(r) = -\\frac{d}{dr}\\left(4\\epsilon\\left[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}\\right]\\right)$$\n$$f(r) = -4\\epsilon\\left[\\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7}\\right]$$\n$$f(r) = -4\\epsilon\\left[-12\\sigma^{12}r^{-13} + 6\\sigma^{6}r^{-7}\\right]$$\n$$f(r) = 4\\epsilon\\left[12\\sigma^{12}r^{-13} - 6\\sigma^{6}r^{-7}\\right]$$\nThis expression can be factored to a more common form:\n$$f(r) = \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\nThe corresponding pairwise force vector is $\\mathbf{F}(r) = f(r)\\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the unit vector pointing along the line connecting the two atoms.\n\nAs a brief check for physical realism, we examine the limiting behaviors. As $r \\to 0$, the repulsive term $r^{-13}$ dominates, and $f(r) \\to +\\infty$, correctly describing a strong short-range repulsion. As $r \\to \\infty$, both terms tend to zero, with the attractive $r^{-7}$ term decaying more slowly than the repulsive term, which means the force becomes weakly attractive before vanishing.\n\n2. Equilibrium separation and curvature.\nThe equilibrium separation, $r_{\\mathrm{m}}$, is the distance at which the force is zero, or equivalently, the potential energy is at a minimum. We find this by setting $\\frac{du}{dr} = 0$, which is equivalent to setting $f(r)=0$.\n$$4\\epsilon\\left[12\\sigma^{12}r_{\\mathrm{m}}^{-13} - 6\\sigma^{6}r_{\\mathrm{m}}^{-7}\\right] = 0$$\nSince $4\\epsilon > 0$, we must have:\n$$12\\sigma^{12}r_{\\mathrm{m}}^{-13} = 6\\sigma^{6}r_{\\mathrm{m}}^{-7}$$\n$$2\\sigma^{6} = r_{\\mathrm{m}}^{6}$$\n$$r_{\\mathrm{m}} = 2^{1/6}\\sigma$$\nNext, we compute the curvature of the potential at this equilibrium point, $u''(r_{\\mathrm{m}})$. This value represents the effective spring constant $k$ for small oscillations around equilibrium.\n$$u''(r) = \\frac{d^2u}{dr^2} = \\frac{d}{dr}\\left(-f(r)\\right) = \\frac{d}{dr}\\left(-4\\epsilon\\left[12\\sigma^{12}r^{-13} - 6\\sigma^{6}r^{-7}\\right]\\right)$$\n$$u''(r) = -4\\epsilon\\left[12(-13)\\sigma^{12}r^{-14} - 6(-7)\\sigma^{6}r^{-8}\\right]$$\n$$u''(r) = -4\\epsilon\\left[-156\\sigma^{12}r^{-14} + 42\\sigma^{6}r^{-8}\\right]$$\n$$u''(r) = 4\\epsilon\\left[156\\sigma^{12}r^{-14} - 42\\sigma^{6}r^{-8}\\right]$$\nWe now evaluate this at $r=r_{\\mathrm{m}}$. It is convenient to use the relation $(\\sigma/r_{\\mathrm{m}})^6 = 1/2$.\n$$u''(r_{\\mathrm{m}}) = 4\\epsilon\\left[156\\frac{\\sigma^{12}}{r_{\\mathrm{m}}^{14}} - 42\\frac{\\sigma^{6}}{r_{\\mathrm{m}}^{8}}\\right] = \\frac{4\\epsilon}{r_{\\mathrm{m}}^2}\\left[156\\left(\\frac{\\sigma}{r_{\\mathrm{m}}}\\right)^{12} - 42\\left(\\frac{\\sigma}{r_{\\mathrm{m}}}\\right)^{6}\\right]$$\nSubstituting $(\\sigma/r_{\\mathrm{m}})^6 = 1/2$ and $(\\sigma/r_{\\mathrm{m}})^{12} = 1/4$:\n$$u''(r_{\\mathrm{m}}) = \\frac{4\\epsilon}{(2^{1/6}\\sigma)^2}\\left[156\\left(\\frac{1}{4}\\right) - 42\\left(\\frac{1}{2}\\right)\\right]$$\n$$u''(r_{\\mathrm{m}}) = \\frac{4\\epsilon}{2^{1/3}\\sigma^2}\\left[39 - 21\\right] = \\frac{4\\epsilon \\cdot 18}{2^{1/3}\\sigma^2} = \\frac{72\\epsilon}{2^{1/3}\\sigma^2}$$\n\n3. Harmonic oscillator approximation and stability analysis.\nFor small displacements $x = r - r_{\\mathrm{m}}$ from equilibrium, the equation of motion for the relative coordinate is approximated by a simple harmonic oscillator. The system consists of two identical atoms of mass $m$, so the reduced mass is $\\mu = \\frac{m \\cdot m}{m+m} = \\frac{m}{2}$.\nThe equation of motion is $\\mu \\ddot{x} = -k x$, where the spring constant $k$ is the curvature $u''(r_{\\mathrm{m}})$. This is the equation for a simple harmonic oscillator, $\\ddot{x} + \\omega^2 x = 0$, with angular frequency $\\omega$ given by:\n$$\\omega = \\sqrt{\\frac{k}{\\mu}} = \\sqrt{\\frac{u''(r_{\\mathrm{m}})}{m/2}} = \\sqrt{\\frac{2 u''(r_{\\mathrm{m}})}{m}}$$\nThe position-Verlet algorithm updates the position according to the recurrence relation:\n$$x(t+\\Delta t) = 2x(t) - x(t-\\Delta t) + a(t)(\\Delta t)^2$$\nFor the harmonic oscillator, the acceleration is $a(t) = -\\omega^2 x(t)$. Let $x_n = x(n\\Delta t)$. The recurrence becomes:\n$$x_{n+1} = 2x_n - x_{n-1} - \\omega^2 (\\Delta t)^2 x_n$$\n$$x_{n+1} - (2 - (\\omega\\Delta t)^2)x_n + x_{n-1} = 0$$\nTo analyze stability, we seek a solution of the form $x_n = \\lambda^n$. Substituting this into the recurrence relation yields the characteristic equation for the amplification factor $\\lambda$:\n$$\\lambda^2 - (2 - (\\omega\\Delta t)^2)\\lambda + 1 = 0$$\nFor the numerical solution to remain bounded (stable), the magnitude of the roots $\\lambda$ must not exceed unity, i.e., $|\\lambda| \\leq 1$. The roots of this quadratic equation are complex conjugates if the discriminant is negative:\n$$(2 - (\\omega\\Delta t)^2)^2 - 4 < 0$$\n$$|2 - (\\omega\\Delta t)^2| < 2$$\nThis inequality is satisfied if $-2 < 2 - (\\omega\\Delta t)^2 < 2$. The left side gives $(\\omega\\Delta t)^2 < 4$, and the right side gives $(\\omega\\Delta t)^2 > 0$. Therefore, for stability, we require $0 < \\omega\\Delta t < 2$. The stability limit is thus $\\omega\\Delta t = 2$.\nThe largest stable time step is:\n$$\\Delta t_{\\max} = \\frac{2}{\\omega}$$\n\n4. Final expression for the maximum stable time step.\nWe combine the results from the previous parts to express $\\Delta t_{\\max}$ in terms of the fundamental parameters $m$, $\\sigma$, and $\\epsilon$.\nFirst, we substitute the expression for $u''(r_{\\mathrm{m}})$ into the formula for $\\omega$:\n$$\\omega = \\sqrt{\\frac{2}{m}\\left(\\frac{72\\epsilon}{2^{1/3}\\sigma^2}\\right)} = \\sqrt{\\frac{144\\epsilon}{m 2^{1/3}\\sigma^2}}$$\nNow, substitute this expression for $\\omega$ into the equation for $\\Delta t_{\\max}$:\n$$\\Delta t_{\\max} = \\frac{2}{\\omega} = 2\\left(\\sqrt{\\frac{144\\epsilon}{m 2^{1/3}\\sigma^2}}\\right)^{-1} = 2\\sqrt{\\frac{m 2^{1/3}\\sigma^2}{144\\epsilon}}$$\n$$\\Delta t_{\\max} = \\frac{2}{12}\\sqrt{\\frac{m 2^{1/3}\\sigma^2}{\\epsilon}} = \\frac{1}{6}\\sqrt{\\frac{m \\sigma^2 2^{1/3}}{\\epsilon}}$$\nThis expression can be rearranged slightly to:\n$$\\Delta t_{\\max} = \\frac{\\sigma \\cdot (2^{1/3})^{1/2}}{6} \\sqrt{\\frac{m}{\\epsilon}} = \\frac{2^{1/6}\\sigma}{6}\\sqrt{\\frac{m}{\\epsilon}}$$\nThis is the final expression for the maximum stable time step for a Verlet simulation of a Lennard-Jones dimer, based on a harmonic approximation of its vibrational frequency.",
            "answer": "$$\\boxed{\\frac{2^{1/6}\\sigma}{6}\\sqrt{\\frac{m}{\\epsilon}}}$$"
        }
    ]
}