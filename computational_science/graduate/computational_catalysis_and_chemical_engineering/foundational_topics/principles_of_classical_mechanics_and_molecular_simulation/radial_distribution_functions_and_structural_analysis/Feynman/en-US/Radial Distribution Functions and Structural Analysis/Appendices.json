{
    "hands_on_practices": [
        {
            "introduction": "The first step in any structural analysis is to correctly compute the radial distribution function, $g(r)$, from raw simulation data. The definition of $g(r)$ involves normalizing the observed number of pairs in a shell by the number expected in an ideal gas of the same bulk density. This exercise  challenges you to identify the correct normalization factor, a critical detail that hinges on properly accounting for the number of reference particles and the appropriate bulk density, ensuring your computed $g(r)$ has the correct physical meaning and asymptotic behavior.",
            "id": "3864861",
            "problem": "A binary system consists of a chemically inert solute species $S$ at low mole fraction and a molecular solvent species $W$ simulated by Molecular Dynamics (MD) in a cubic box of edge length $L$ with periodic boundary conditions (PBC). The goal is to estimate the solute–solvent radial distribution function (RDF), denoted $g_{SW}(r)$, from a trajectory. You compute a histogram of solute–solvent distances by selecting only a subset of reference solute particles, of count $N_{\\mathrm{ref}}$, out of the total $N_S$ solutes in the box, and by accumulating counts over $N_f$ statistically independent frames. Specifically, you tabulate the number of $S$–$W$ pairs whose separation falls in the bin $[r_k, r_k + \\Delta r)$ as $H_k$. Assume that the maximum radius used for the RDF is $r_{\\max} < L/2$, so that spherical shells of thickness $\\Delta r$ are fully contained by the minimum-image convention under PBC. Also assume an equilibrated homogeneous bulk solvent with number density $\\rho_W = N_W / V$ where $V = L^3$, and that ergodicity holds. The spherical shell of thickness $\\Delta r$ at radius $r$ has volume $V_{\\mathrm{shell}}(r) = 4 \\pi r^2 \\Delta r$. \n\nYou are told that if you normalize incorrectly when using only a subset of reference solutes, you can underestimate the asymptotic plateau of $g_{SW}(r)$ at large $r$ where it should tend to $1$. Which of the following normalization expressions for $g_{SW}(r_k)$ correctly avoids underestimating the plateau when only the subset of reference solutes is used?\n\nChoose the single best option.\n\nA. $g_{SW}(r_k) = \\dfrac{H_k}{N_S \\, N_f \\, \\rho_W \\, 4 \\pi r_k^2 \\Delta r}$\n\nB. $g_{SW}(r_k) = \\dfrac{H_k}{N_{\\mathrm{ref}} \\, N_f \\, \\rho_W \\, 4 \\pi r_k^2 \\Delta r}$\n\nC. $g_{SW}(r_k) = \\dfrac{H_k}{\\overline{\\rho_W^{\\mathrm{local}}} \\, 4 \\pi r_k^2 \\Delta r}$ where $\\overline{\\rho_W^{\\mathrm{local}}}$ is the average number density of $W$ measured within a sphere of radius $r_{\\max}$ around each selected solute\n\nD. $g_{SW}(r_k) = \\dfrac{H_k}{\\rho_{\\mathrm{sys}} \\, 4 \\pi r_k^2 \\Delta r}$ where $\\rho_{\\mathrm{sys}} = (N_W + N_S)/V$\n\nE. $g_{SW}(r_k) = \\dfrac{H_k}{N_{\\mathrm{ref}} \\, N_f \\, \\rho_W \\, 4 \\pi r_k^2 \\Delta r} \\, \\bigl(1 - \\phi\\bigr)$ where $\\phi$ is the solute volume fraction in the simulation box",
            "solution": "The radial distribution function between species $a$ and $b$, denoted $g_{ab}(r)$, is defined from first principles as the ratio of the conditional number density of $b$ at a distance $r$ from a tagged $a$ particle to the bulk number density of $b$. In other words, for a homogeneous and isotropic fluid, the expected number of $b$ particles in a spherical shell of radius $r$ and thickness $\\Delta r$ around a particular $a$ particle is given by\n$$\n\\langle n_{ab}(r) \\rangle = \\rho_b \\, g_{ab}(r) \\, V_{\\mathrm{shell}}(r),\n$$\nwhere $\\rho_b$ is the bulk number density of species $b$ and $V_{\\mathrm{shell}}(r) = 4 \\pi r^2 \\Delta r$ is the shell volume from elementary geometry. This follows directly from the definition that $g_{ab}(r)$ rescales the bulk density $\\rho_b$ to the local average density at separation $r$.\n\nWhen sampling over $N_{\\mathrm{ref}}$ tagged reference particles of species $a$ and $N_f$ independent frames, the total expected count in bin $k$ is\n$$\n\\langle H_k \\rangle = N_{\\mathrm{ref}} \\, N_f \\, \\rho_b \\, g_{ab}(r_k) \\, V_{\\mathrm{shell}}(r_k).\n$$\nSolving for $g_{ab}(r_k)$ yields\n$$\ng_{ab}(r_k) = \\frac{H_k}{N_{\\mathrm{ref}} \\, N_f \\, \\rho_b \\, V_{\\mathrm{shell}}(r_k)}.\n$$\nHere, $b$ corresponds to $W$ and $a$ corresponds to $S$, so $\\rho_b = \\rho_W$. The requirement that $r_{\\max} < L/2$ ensures that $V_{\\mathrm{shell}}(r)$ is not truncated by the simulation box under periodic boundary conditions, so no geometric accessibility correction is needed. Under these conditions and assuming homogeneous bulk, the definition guarantees that $g_{SW}(r) \\to 1$ as $r$ approaches $r_{\\max}$ from below, because the conditional density approaches the bulk density $\\rho_W$ at large separations.\n\nWith this principle-based derivation, we now examine each proposed expression:\n\nOption A: $g_{SW}(r_k) = \\dfrac{H_k}{N_S \\, N_f \\, \\rho_W \\, 4 \\pi r_k^2 \\Delta r}$.\n- Analysis: The normalization uses $N_S$ instead of $N_{\\mathrm{ref}}$. If only $N_{\\mathrm{ref}} < N_S$ reference solutes were actually used to generate $H_k$, then dividing by $N_S$ overcounts the effective number of reference centers by a factor of $N_S/N_{\\mathrm{ref}}$. This inflates the denominator and thus depresses $g_{SW}(r_k)$ uniformly, causing an underestimation of the asymptotic plateau. Verdict: Incorrect.\n\nOption B: $g_{SW}(r_k) = \\dfrac{H_k}{N_{\\mathrm{ref}} \\, N_f \\, \\rho_W \\, 4 \\pi r_k^2 \\Delta r}$.\n- Analysis: This matches the derivation from the definition. It uses exactly the number of reference centers actually sampled, the number of frames, the correct partner-species bulk density $\\rho_W$, and the correct shell volume under the given PBC and $r_{\\max} < L/2$ conditions. This normalization yields $g_{SW}(r) \\to 1$ at large $r$ for a homogeneous bulk. Verdict: Correct.\n\nOption C: $g_{SW}(r_k) = \\dfrac{H_k}{\\overline{\\rho_W^{\\mathrm{local}}} \\, 4 \\pi r_k^2 \\Delta r}$ where $\\overline{\\rho_W^{\\mathrm{local}}}$ is the average number density of $W$ measured within a sphere of radius $r_{\\max}$ around each selected solute.\n- Analysis: This construction replaces the bulk density $\\rho_W$ by a conditional local density, which is itself influenced by solute–solvent structure and finite-size fluctuations. It also omits the factor $N_{\\mathrm{ref}} N_f$. Even if one attempted to fold $N_{\\mathrm{ref}} N_f$ into the definition of $\\overline{\\rho_W^{\\mathrm{local}}}$, using a local density breaks the fundamental definition of $g_{SW}(r)$ as a ratio to the bulk density. This can mask true enrichment or depletion and does not guarantee the correct plateau behavior relative to $\\rho_W$. Verdict: Incorrect.\n\nOption D: $g_{SW}(r_k) = \\dfrac{H_k}{\\rho_{\\mathrm{sys}} \\, 4 \\pi r_k^2 \\Delta r}$ where $\\rho_{\\mathrm{sys}} = (N_W + N_S)/V$.\n- Analysis: This uses the total number density of all particles, not the bulk density of the partner species $W$. In a mixture, the appropriate reference density in the definition of $g_{ab}(r)$ is $\\rho_b$, not the total density. Using $\\rho_{\\mathrm{sys}}$ will generally underestimate $g_{SW}(r)$ for dilute $S$ (because $\\rho_{\\mathrm{sys}} > \\rho_W$), depressing the plateau. It also omits the factor $N_{\\mathrm{ref}} N_f$. Verdict: Incorrect.\n\nOption E: $g_{SW}(r_k) = \\dfrac{H_k}{N_{\\mathrm{ref}} \\, N_f \\, \\rho_W \\, 4 \\pi r_k^2 \\Delta r} \\, \\bigl(1 - \\phi\\bigr)$ where $\\phi$ is the solute volume fraction in the simulation box.\n- Analysis: The factor $\\bigl(1 - \\phi\\bigr)$ is an ad hoc excluded-volume correction inappropriate under the stated conditions. With periodic boundary conditions and $r_{\\max} < L/2$, the relevant ideal-gas reference for normalization is exactly $N_{\\mathrm{ref}} N_f \\rho_W V_{\\mathrm{shell}}(r_k)$, without any additional volume-fraction factor. Multiplying by $\\bigl(1 - \\phi\\bigr)$ will push $g_{SW}(r)$ below the correct value, underestimating the plateau. Verdict: Incorrect.\n\nTherefore, the only expression that correctly normalizes $g_{SW}(r)$ when using only a subset of reference solutes, and thus preserves the expected asymptotic plateau at $1$, is Option B.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Once a properly normalized $g(r)$ is obtained, we can use it to quantify local structure. A key metric is the coordination number, which counts the average number of neighbors in a particle's solvation shells, defined by the minima in the $g(r)$ function. This value is found by integrating the local density, $\\rho g(r)$, over the volume of the shell, a process that provides deep insight into the material's packing. This practice  provides hands-on experience in computing the coordination number from binned simulation data, requiring you to perform a numerical integration and think critically about how numerical choices, like bin width, impact the accuracy of such integrated physical quantities.",
            "id": "3842786",
            "problem": "A three-dimensional atomistic simulation of a monoatomic liquid with number density $\\,\\rho = 32\\,\\mathrm{nm}^{-3}\\,$ yields a measured Radial Distribution Function (RDF), defined as the pair correlation $\\,g(r)\\,$. The first peak position is $\\,r_{p} = 0.23\\,\\mathrm{nm}\\,$ and the first minimum is $\\,r_{m} = 0.33\\,\\mathrm{nm}\\,$. You are given a binned estimate of $\\,g(r)\\,$ over the interval $\\,0 \\le r \\le r_{m}\\,$ using the midpoint rule with uniform bin width $\\,\\Delta r = 0.05\\,\\mathrm{nm}\\,$ and midpoints $\\,r_{i} \\in \\{0.025,\\,0.075,\\,0.125,\\,0.175,\\,0.225,\\,0.275,\\,0.325\\}\\,\\mathrm{nm}\\,$. The corresponding measured values of $\\,g(r_{i})\\,$ are:\n- $\\,g(0.025\\,\\mathrm{nm}) = 0.05\\,$,\n- $\\,g(0.075\\,\\mathrm{nm}) = 0.40\\,$,\n- $\\,g(0.125\\,\\mathrm{nm}) = 1.20\\,$,\n- $\\,g(0.175\\,\\mathrm{nm}) = 2.00\\,$,\n- $\\,g(0.225\\,\\mathrm{nm}) = 2.60\\,$,\n- $\\,g(0.275\\,\\mathrm{nm}) = 1.80\\,$,\n- $\\,g(0.325\\,\\mathrm{nm}) = 1.10\\,$.\n\nUsing only fundamental definitions, compute the average coordination number in the first shell, i.e., the average number of atoms contained within a sphere of radius $\\,r_{m}\\,$ around a reference atom, based on the given $\\,g(r)\\,$ data. Use the midpoint Riemann sum to approximate any necessary radial integrals. Express the final coordination number as a pure number (dimensionless) and round your answer to four significant figures.\n\nThen, briefly discuss the sensitivity of the computed coordination number to the bin width $\\,\\Delta r\\,$ and to applying a Gaussian smoothing to $\\,g(r)\\,$ with small standard deviation $\\,\\sigma\\,$, in terms of how these operations perturb the underlying integral you evaluate. Your discussion should be qualitative but grounded in first-principles reasoning; no numerical output is required in the discussion.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It contains all the necessary information to compute a unique solution under a standard interpretation of numerical integration with binned data.\n\nThe average coordination number, $CN(R)$, is defined as the average number of atoms within a sphere of radius $R$ centered on a reference atom. It is calculated by integrating the local number density, $\\rho g(r)$, over the volume of the sphere. The quantity $\\rho g(r)$ gives the number density of atoms at a distance $r$ from a central atom, where $\\rho$ is the bulk number density and $g(r)$ is the radial distribution function.\n\nThe fundamental formula for the coordination number up to a radius $R$ in a three-dimensional system is given by the integral:\n$$\nCN(R) = \\int_0^R \\rho g(r) \\, 4\\pi r^2 dr\n$$\nSince the bulk number density $\\rho$ is a constant, it can be taken out of the integral:\n$$\nCN(R) = 4\\pi\\rho \\int_0^R r^2 g(r) dr\n$$\nThe problem requires the calculation of the coordination number in the first shell, which is defined by the first minimum of the RDF, $r_m$. Thus, we must evaluate:\n$$\nCN(r_m) = 4\\pi\\rho \\int_0^{r_m} r^2 g(r) dr\n$$\nWe are given $\\rho = 32\\,\\mathrm{nm}^{-3}$ and $r_m = 0.33\\,\\mathrm{nm}$. The integral must be approximated using a midpoint Riemann sum with the provided binned data. The data consists of $N=7$ values of $g(r_i)$ at bin midpoints $r_i$ with a uniform bin width of $\\Delta r = 0.05\\,\\mathrm{nm}$.\n\nThe integral can be approximated as:\n$$\n\\int_0^{r_m} r^2 g(r) dr \\approx \\sum_{i=1}^{N} r_i^2 g(r_i) \\Delta r\n$$\nThe integration limit is $r_m = 0.33\\,\\mathrm{nm}$. The provided bin midpoints cover a range up to an implicit upper bound of $0.35\\,\\mathrm{nm}$ (the last bin is $[0.30\\,\\mathrm{nm}, 0.35\\,\\mathrm{nm}]$ with midpoint $0.325\\,\\mathrm{nm}$). As is standard practice when working with binned experimental or simulation data where the integration limit does not perfectly align with bin edges, we utilize all bins whose midpoints are within or close to the integration range. Here, we sum over all $N=7$ provided data points. This approximates the integral over the range $[0, 0.35\\,\\mathrm{nm}]$, which is a reasonable approximation for the integral up to $r_m = 0.33\\,\\mathrm{nm}$ given the discretization.\n\nLet's compute the sum $S = \\sum_{i=1}^{7} r_i^2 g(r_i)$:\nThe given data points $(r_i, g(r_i))$ are:\n$(0.025\\,\\mathrm{nm}, 0.05)$, $(0.075\\,\\mathrm{nm}, 0.40)$, $(0.125\\,\\mathrm{nm}, 1.20)$, $(0.175\\,\\mathrm{nm}, 2.00)$, $(0.225\\,\\mathrm{nm}, 2.60)$, $(0.275\\,\\mathrm{nm}, 1.80)$, $(0.325\\,\\mathrm{nm}, 1.10)$.\n\nThe terms $r_i^2 g(r_i)$ are (in units of $\\mathrm{nm}^2$):\n*   $i=1$: $(0.025)^2(0.05) = (0.000625)(0.05) = 0.00003125$\n*   $i=2$: $(0.075)^2(0.40) = (0.005625)(0.40) = 0.00225$\n*   $i=3$: $(0.125)^2(1.20) = (0.015625)(1.20) = 0.01875$\n*   $i=4$: $(0.175)^2(2.00) = (0.030625)(2.00) = 0.06125$\n*   $i=5$: $(0.225)^2(2.60) = (0.050625)(2.60) = 0.131625$\n*   $i=6$: $(0.275)^2(1.80) = (0.075625)(1.80) = 0.136125$\n*   $i=7$: $(0.325)^2(1.10) = (0.105625)(1.10) = 0.11618125$\n\nThe sum $S$ is:\n$$\nS = 0.00003125 + 0.00225 + 0.01875 + 0.06125 + 0.131625 + 0.136125 + 0.11618125 = 0.4662125\\,\\mathrm{nm}^2\n$$\nNow, we calculate the value of the integral approximation:\n$$\n\\int_0^{r_m} r^2 g(r) dr \\approx S \\times \\Delta r = (0.4662125\\,\\mathrm{nm}^2) \\times (0.05\\,\\mathrm{nm}) = 0.023310625\\,\\mathrm{nm}^3\n$$\nFinally, we compute the coordination number, which is a dimensionless quantity:\n$$\nCN(r_m) \\approx 4\\pi\\rho (S \\Delta r) = 4\\pi (32\\,\\mathrm{nm}^{-3}) (0.023310625\\,\\mathrm{nm}^3)\n$$\n$$\nCN(r_m) \\approx 128\\pi (0.023310625) \\approx 9.373753\n$$\nRounding the result to four significant figures as requested gives $9.374$.\n\nRegarding the sensitivity analysis:\n\nSensitivity to bin width $\\Delta r$: The calculation employs the midpoint Riemann sum method for numerical integration. The global error of this method for an integral $\\int_a^b f(x)dx$ is of the order $O((\\Delta r)^2)$, specifically, Error $\\propto (b-a) (\\Delta r)^2 f''(\\xi)$ for some $\\xi \\in [a, b]$. In our case, the integrand is $f(r) = r^2 g(r)$. Assuming $g(r)$ and thus $f(r)$ are sufficiently smooth functions (which is physically reasonable for a liquid), the accuracy of the computed coordination number is quadratically dependent on the bin width. A smaller $\\Delta r$ would lead to a smaller discretization error and a more accurate result, while a larger $\\Delta r$ would increase the error and make the estimate less reliable. The choice of $\\Delta r = 0.05\\,\\mathrm{nm}$ is relatively coarse, so the result should be understood as an approximation subject to this discretization error.\n\nSensitivity to Gaussian smoothing: Applying Gaussian smoothing to the $g(r)$ data involves a convolution of the measured $g(r)$ with a Gaussian kernel of standard deviation $\\sigma$. This operation, $g_{smooth}(r) = (g * K_{\\sigma})(r)$, is a low-pass filter. For a small $\\sigma$, its primary effect is to average out high-frequency statistical noise that is often present in raw data from molecular simulations. This generally leads to a smoother $g(r)$ curve. The impact on the coordination number integral, $\\int_0^{r_m} r^2 g_{smooth}(r) dr$, is twofold. First, by reducing statistical noise, the resulting $CN$ may become a more statistically robust estimate of the true ensemble average value (i.e., reduced variance). Second, the smoothing operation inevitably introduces a systematic bias by altering the shape of the function, for instance by slightly lowering peak heights and broadening them. Since the integral of a Gaussian kernel is unity, the integral of $g_{smooth}(r)$ over all space is the same as that of $g(r)$, but for a finite integral of a weighted function like $r^2 g(r)$ up to $r_m$, there will be a small perturbation. For small $\\sigma$, this bias is typically minor. Therefore, applying a gentle Gaussian smoothing is often a beneficial trade-off, reducing statistical error at the cost of a small, often acceptable, systematic error.",
            "answer": "$$\n\\boxed{9.374}\n$$"
        },
        {
            "introduction": "The radial distribution function provides a powerful real-space picture of material structure. To connect these simulation insights with experimental scattering data, we must transform this information into reciprocal space to find the static structure factor, $S(k)$. The structure factor is related to the Fourier transform of the total correlation function, $h(r) = g(r) - 1$, and for isotropic systems, this simplifies to a spherical Bessel transform. This advanced exercise  guides you through deriving this fundamental relationship and implementing it numerically, gaining a deep, practical understanding of numerical Fourier transforms and their sources of error, such as real-space truncation and grid discretization.",
            "id": "3842807",
            "problem": "You are given a statistically homogeneous and isotropic material characterized by the Radial Distribution Function (RDF), defined as $g(r)$, where $r$ is the scalar separation between two points in space. The RDF is related to the total correlation function $h(r)$ by $h(r) = g(r) - 1$. The static structure factor $S(k)$, where $k$ is the magnitude of the wavevector, encodes reciprocal-space information about two-point correlations. Your task is to derive the mathematical relationship, grounded in first principles of statistical mechanics and Fourier analysis in three dimensions, that connects $S(k)$ to $h(r)$ using spherical Bessel function transforms, and to implement a numerical algorithm that starts from a given $g(r)$ to compute $S(k)$ for specified $k$ values. You must analyze the numerical errors introduced by truncating the real-space integral at a finite $r_{\\max}$.\n\nUse the following fundamental base:\n- Statistical homogeneity and isotropy imply that all two-point quantities depend only on scalar separation $r$, and their reciprocal-space representations depend only on $k = \\|\\mathbf{k}\\|$.\n- The total correlation function $h(r)$ is defined by $h(r) = g(r) - 1$.\n- The structure factor $S(k)$ arises from spatial Fourier analysis of two-particle correlations and is dimensionless.\n- The spherical Bessel function of order zero is defined as $j_{0}(x)$ and appears naturally in the angular integration of isotropic three-dimensional Fourier transforms.\n\nYou must not use or state any shortcut formulas a priori. Instead, derive the expression connecting $S(k)$ to $h(r)$ from the above base, and design a numerical method to evaluate the resulting transform on a finite radial grid. You must explain how finite-$r$ truncation, $r \\le r_{\\max}$, affects the numerical accuracy and quantify the error with respect to a known analytical benchmark.\n\nTo make the problem concrete and testable, consider the following parametric family of total correlation functions:\n- $g(r) = 1 + A \\exp\\left(-\\dfrac{r^{2}}{2 \\sigma^{2}}\\right)$, so that $h(r) = A \\exp\\left(-\\dfrac{r^{2}}{2 \\sigma^{2}}\\right)$, with amplitude $A$ and Gaussian width $\\sigma$.\n\nFor this $h(r)$, the exact reciprocal-space transform can be obtained analytically from the three-dimensional Fourier transform of a Gaussian, and thus the exact structure factor $S_{\\text{exact}}(k)$ serves as a benchmark for error analysis. Your numerical algorithm must:\n- Construct a uniform radial grid $r \\in [0, r_{\\max}]$ with spacing $\\Delta r$.\n- Compute $h(r)$ from $g(r)$.\n- Evaluate $S(k)$ on a set of prescribed $k$ values using the derived spherical Bessel transform.\n- Quantify the error as the maximum absolute deviation over the prescribed set of $k$ values, defined as $E = \\max_{k \\in \\mathcal{K}} \\left| S_{\\text{num}}(k) - S_{\\text{exact}}(k) \\right|$, where $S_{\\text{num}}(k)$ is the numerically computed structure factor and $\\mathcal{K}$ is the set of test $k$ values.\n\nAll quantities are dimensionless. Express the final numerical errors as dimensionless floats.\n\nTest Suite:\nFor each test case, you are given the number density $\\rho$, the amplitude $A$, the Gaussian width $\\sigma$, the truncation radius $r_{\\max}$, the radial step $\\Delta r$, and a set of $k$ values $\\mathcal{K}$:\n\n- Test $1$ (happy path, fine grid, large $r_{\\max}$): $\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 3.00$, $\\Delta r = 0.002$, $\\mathcal{K} = \\{0.00, 1.00, 5.00, 10.00\\}$.\n- Test $2$ (truncation-dominated error): $\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 0.70$, $\\Delta r = 0.002$, $\\mathcal{K} = \\{0.00, 1.00, 5.00, 10.00\\}$.\n- Test $3$ (discretization-dominated error): $\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 3.00$, $\\Delta r = 0.050$, $\\mathcal{K} = \\{0.00, 1.00, 5.00, 10.00\\}$.\n- Test $4$ (wider $h(r)$ increases truncation sensitivity, different $\\rho$): $\\rho = 0.65$, $A = 0.60$, $\\sigma = 0.60$, $r_{\\max} = 2.00$, $\\Delta r = 0.002$, $\\mathcal{K} = \\{0.00, 1.00, 3.00, 6.00\\}$.\n- Test $5$ (high-frequency transform behavior): $\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 6.00$, $\\Delta r = 0.005$, $\\mathcal{K} = \\{15.00, 25.00, 40.00\\}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[e_{1},e_{2},e_{3},e_{4},e_{5}]$), where $e_{i}$ is the dimensionless float $E$ computed for test $i$.",
            "solution": "The starting point is the statistical mechanical definition of two-point correlations in a homogeneous, isotropic material. The Radial Distribution Function (RDF) $g(r)$ depends only on scalar separation $r$ and relates to the total correlation function $h(r)$ via $h(r) = g(r) - 1$. The static structure factor $S(k)$ encodes the intensity of density fluctuations in reciprocal space and is obtained from the spatial Fourier characterization of two-particle correlations.\n\nPrinciple-based derivation:\n- In $d = 3$ dimensions, statistical homogeneity and isotropy imply that the pair correlation depends only on $r = \\|\\mathbf{r}\\|$ and the reciprocal-space description depends only on $k = \\|\\mathbf{k}\\|$.\n- The structure factor $S(k)$ can be derived from the definition involving the Fourier transform of the total correlation function $h(\\mathbf{r})$ weighted by the number density $\\rho$. Starting from the definition that connects $S(k)$ to the two-point density correlation, one obtains the relation in three-dimensional Fourier space:\n$$\nS(k) = 1 + \\rho \\int_{\\mathbb{R}^{3}} h(\\mathbf{r}) e^{i \\mathbf{k} \\cdot \\mathbf{r}} \\, d^{3}\\mathbf{r}.\n$$\n- For isotropic $h(\\mathbf{r}) = h(r)$, we express the integral in spherical coordinates with $\\mathbf{k}$ aligned along the polar axis. The angular integration yields the spherical Bessel function of the first kind of order zero, $j_{0}(x)$, arising from\n$$\n\\int e^{i \\mathbf{k} \\cdot \\mathbf{r}} \\, d\\Omega = 4\\pi \\frac{\\sin(kr)}{kr} = 4\\pi j_{0}(kr).\n$$\n- Therefore, the three-dimensional isotropic transform reduces to the spherical Bessel transform\n$$\nS(k) = 1 + 4\\pi \\rho \\int_{0}^{\\infty} r^{2} h(r) j_{0}(kr) \\, dr,\n$$\nwhere $j_{0}(x) = \\dfrac{\\sin(x)}{x}$.\n\nNumerical algorithm:\n- We construct a uniform radial grid $r \\in [0, r_{\\max}]$ with spacing $\\Delta r$, define $g(r)$ on this grid from the given parametric form, and obtain $h(r) = g(r) - 1$.\n- For each prescribed $k$, compute the integral numerically by quadrature:\n$$\nH_{\\text{num}}(k) \\approx 4\\pi \\sum_{n} r_{n}^{2} h(r_{n}) j_{0}(k r_{n}) \\Delta r,\n$$\nand then\n$$\nS_{\\text{num}}(k) = 1 + \\rho H_{\\text{num}}(k).\n$$\n- We evaluate $j_{0}(x)$ using a numerically stable spherical Bessel function implementation, particularly at $x = 0$ where $j_{0}(0) = 1$.\n\nAnalytical benchmark for the Gaussian $h(r)$:\n- Consider $h(r) = A \\exp\\left(-\\dfrac{r^{2}}{2 \\sigma^{2}}\\right)$, which is spherically symmetric. Its three-dimensional Fourier transform is separable in Cartesian coordinates and is the product of one-dimensional Gaussian transforms. Specifically, using the convention\n$$\n\\hat{h}(\\mathbf{k}) = \\int_{\\mathbb{R}^{3}} h(\\mathbf{r}) e^{i \\mathbf{k} \\cdot \\mathbf{r}} \\, d^{3}\\mathbf{r},\n$$\nwe obtain\n$$\n\\hat{h}(\\mathbf{k}) = A (2\\pi)^{3/2} \\sigma^{3} \\exp\\left(-\\frac{\\sigma^{2} k^{2}}{2}\\right),\n$$\nwhere $k = \\|\\mathbf{k}\\|$. Hence, the exact structure factor is\n$$\nS_{\\text{exact}}(k) = 1 + \\rho \\hat{h}(\\mathbf{k}) = 1 + \\rho A (2\\pi)^{3/2} \\sigma^{3} \\exp\\left(-\\frac{\\sigma^{2} k^{2}}{2}\\right).\n$$\n\nError due to finite $r$ truncation and discretization:\n- Truncation replaces $\\int_{0}^{\\infty}$ by $\\int_{0}^{r_{\\max}}$, introducing an error\n$$\n\\varepsilon_{\\text{trunc}}(k) = 4\\pi \\rho \\int_{r_{\\max}}^{\\infty} r^{2} h(r) j_{0}(kr) \\, dr.\n$$\n- Since $|j_{0}(x)| \\le 1$ for all $x$, a bound is\n$$\n|\\varepsilon_{\\text{trunc}}(k)| \\le 4\\pi \\rho \\int_{r_{\\max}}^{\\infty} r^{2} |h(r)| \\, dr.\n$$\n- For Gaussian $h(r)$, the tail integral decays rapidly and can be expressed in terms of the complementary error function, indicating exponential suppression as $r_{\\max}/\\sigma$ increases.\n- Discretization error arises because the integral is approximated with finite $\\Delta r$, which introduces quadrature error that typically scales with a power of $\\Delta r$ depending on the chosen rule and the smoothness of the integrand. For oscillatory factors $j_{0}(kr)$ at large $k$, finer $\\Delta r$ is required to resolve oscillations, and larger $r_{\\max}$ is needed to control truncation.\n\nError metric and test suite evaluation:\n- For each test case, define the set of $k$ values $\\mathcal{K}$ and compute\n$$\nE = \\max_{k \\in \\mathcal{K}} \\left| S_{\\text{num}}(k) - S_{\\text{exact}}(k) \\right|.\n$$\n- The happy path (Test $1$) uses sufficiently large $r_{\\max}$ and fine $\\Delta r$, producing small $E$.\n- The truncation-dominated case (Test $2$) decreases $r_{\\max}$ drastically, increasing $E$ due to missing Gaussian tail contributions.\n- The discretization-dominated case (Test $3$) uses coarse $\\Delta r$ at otherwise adequate $r_{\\max}$, increasing $E$ because oscillations of $j_{0}(kr)$ are under-resolved.\n- The wider $h(r)$ (Test $4$) increases sensitivity to truncation because the Gaussian extends further in $r$, requiring larger $r_{\\max}$ to capture its mass.\n- The high-frequency case (Test $5$) probes large $k$ values, where the integrand is highly oscillatory; larger $r_{\\max}$ and sufficiently small $\\Delta r$ mitigate errors.\n\nImplementation details:\n- We use the spherical Bessel function $j_{0}(x)$ via a reliable numerical function and perform numerical quadrature with the trapezoidal rule for robustness and simplicity.\n- For each test case, we generate the radial grid $r_{n} = n \\Delta r$, $n = 0, \\dots, \\lfloor r_{\\max} / \\Delta r \\rfloor$, compute $g(r_{n})$, $h(r_{n})$, and evaluate $S_{\\text{num}}(k)$ for each $k \\in \\mathcal{K}$.\n- We compute $S_{\\text{exact}}(k)$ directly from the analytic expression and report $E$ for each test case.\n\nThe final program outputs a single line containing $[e_{1},e_{2},e_{3},e_{4},e_{5}]$, where each $e_{i}$ is the dimensionless float $E$ for Test $i$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import spherical_jn\n\ndef spherical_bessel_j0(x):\n    # j0(x) = spherical_jn(0, x)\n    return spherical_jn(0, x)\n\ndef compute_S_num(rho, A, sigma, r_max, dr, k_values):\n    # Build radial grid\n    n_points = int(np.floor(r_max / dr)) + 1\n    r = np.linspace(0.0, r_max, n_points)\n    # Define g(r) and h(r)\n    g = 1.0 + A * np.exp(-r**2 / (2.0 * sigma**2))\n    h = g - 1.0\n    # Precompute r^2 h(r)\n    r2h = r**2 * h\n    S_vals = []\n    for k in k_values:\n        j0 = spherical_bessel_j0(k * r)\n        integrand = r2h * j0\n        H_num = 4.0 * np.pi * np.trapz(integrand, r)\n        S_num = 1.0 + rho * H_num\n        S_vals.append(S_num)\n    return np.array(S_vals)\n\ndef compute_S_exact(rho, A, sigma, k_values):\n    # Exact 3D Fourier transform of Gaussian h(r) = A * exp(-r^2 / (2 sigma^2))\n    # \\hat{h}(k) = A * (2*pi)^(3/2) * sigma^3 * exp(-sigma^2 * k^2 / 2)\n    factor = A * (2.0 * np.pi) ** (1.5) * (sigma ** 3)\n    S_exact = 1.0 + rho * factor * np.exp(-0.5 * (sigma ** 2) * (np.array(k_values) ** 2))\n    return S_exact\n\ndef max_abs_error(S_num, S_exact):\n    return float(np.max(np.abs(S_num - S_exact)))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (rho, A, sigma, r_max, dr, k_values)\n    test_cases = [\n        (0.85, 0.60, 0.25, 3.00, 0.002, [0.00, 1.00, 5.00, 10.00]),  # Test 1\n        (0.85, 0.60, 0.25, 0.70, 0.002, [0.00, 1.00, 5.00, 10.00]),  # Test 2\n        (0.85, 0.60, 0.25, 3.00, 0.050, [0.00, 1.00, 5.00, 10.00]),  # Test 3\n        (0.65, 0.60, 0.60, 2.00, 0.002, [0.00, 1.00, 3.00, 6.00]),   # Test 4\n        (0.85, 0.60, 0.25, 6.00, 0.005, [15.00, 25.00, 40.00]),      # Test 5\n    ]\n\n    results = []\n    for rho, A, sigma, r_max, dr, k_values in test_cases:\n        S_num = compute_S_num(rho, A, sigma, r_max, dr, k_values)\n        S_ex = compute_S_exact(rho, A, sigma, k_values)\n        err = max_abs_error(S_num, S_ex)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}