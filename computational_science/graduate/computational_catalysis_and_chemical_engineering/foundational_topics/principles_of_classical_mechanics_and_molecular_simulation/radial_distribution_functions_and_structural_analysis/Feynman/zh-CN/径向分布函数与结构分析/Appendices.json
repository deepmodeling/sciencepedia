{
    "hands_on_practices": [
        {
            "introduction": "径向分布函数（$g(r)$）最直接的应用之一是量化原子周围的局部结构。通过对$g(r)$进行积分，我们可以计算出在给定半径内的平均原子数，即配位数。本练习  将指导你如何从离散的$g(r)$数据中计算第一配位壳层的配位数，并探讨该计算对数据分箱和处理方法的敏感性。",
            "id": "3842786",
            "problem": "对一种数密度为 $\\,\\rho = 32\\,\\mathrm{nm}^{-3}\\,$ 的单原子液体进行三维原子模拟，得到了测量的径向分布函数 (RDF)，定义为对相关函数 $\\,g(r)\\,$。其第一个峰值位置为 $\\,r_{p} = 0.23\\,\\mathrm{nm}\\,$，第一个极小值为 $\\,r_{m} = 0.33\\,\\mathrm{nm}\\,$。给定在区间 $\\,0 \\le r \\le r_{m}\\,$ 上使用中点法则得到的 $\\,g(r)\\,$ 的分箱估计值，其箱宽均匀为 $\\,\\Delta r = 0.05\\,\\mathrm{nm}\\,$，中点为 $\\,r_{i} \\in \\{0.025,\\,0.075,\\,0.125,\\,0.175,\\,0.225,\\,0.275,\\,0.325\\}\\,\\mathrm{nm}\\,$。对应的 $\\,g(r_{i})\\,$ 测量值为：\n- $\\,g(0.025\\,\\mathrm{nm}) = 0.05\\,$，\n- $\\,g(0.075\\,\\mathrm{nm}) = 0.40\\,$，\n- $\\,g(0.125\\,\\mathrm{nm}) = 1.20\\,$，\n- $\\,g(0.175\\,\\mathrm{nm}) = 2.00\\,$，\n- $\\,g(0.225\\,\\mathrm{nm}) = 2.60\\,$，\n- $\\,g(0.275\\,\\mathrm{nm}) = 1.80\\,$，\n- $\\,g(0.325\\,\\mathrm{nm}) = 1.10\\,$。\n\n仅使用基本定义，根据给定的 $\\,g(r)\\,$ 数据，计算第一壳层中的平均配位数，即以一个参考原子为中心、半径为 $\\,r_{m}\\,$ 的球体内包含的平均原子数。使用中点黎曼和来近似任何必要的径向积分。将最终的配位数表示为一个纯数（无量纲），并将您的答案四舍五入到四位有效数字。\n\n然后，简要讨论计算出的配位数对箱宽 $\\,\\Delta r\\,$ 和对 $\\,g(r)\\,$ 应用具有小标准差 $\\,\\sigma\\,$ 的高斯平滑的敏感性，从这些操作如何扰动您所计算的基础积分的角度进行讨论。您的讨论应是定性的，但需基于第一性原理推断；讨论中不需要数值输出。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、问题明确且客观的。在对分箱数据进行数值积分的标准解释下，它包含了计算唯一解所需的所有必要信息。\n\n平均配位数 $CN(R)$ 定义为以一个参考原子为中心、半径为 $R$ 的球体内的平均原子数。它是通过在球体体积上对局域数密度 $\\rho g(r)$ 进行积分来计算的。量 $\\rho g(r)$ 给出了距离中心原子 $r$ 处的原子数密度，其中 $\\rho$ 是体数密度，而 $g(r)$ 是径向分布函数。\n\n在三维系统中，直至半径 $R$ 的配位数的基本公式由以下积分给出：\n$$\nCN(R) = \\int_0^R \\rho g(r) \\, 4\\pi r^2 dr\n$$\n由于体数密度 $\\rho$ 是一个常数，可以将其从积分中提出：\n$$\nCN(R) = 4\\pi\\rho \\int_0^R r^2 g(r) dr\n$$\n问题要求计算第一壳层中的配位数，该壳层由 RDF 的第一个极小值 $r_m$ 定义。因此，我们必须计算：\n$$\nCN(r_m) = 4\\pi\\rho \\int_0^{r_m} r^2 g(r) dr\n$$\n给定 $\\rho = 32\\,\\mathrm{nm}^{-3}$ 和 $r_m = 0.33\\,\\mathrm{nm}$。该积分必须使用提供的分箱数据和中点黎曼和进行近似。数据包含在箱中点 $r_i$ 处的 $N=7$ 个 $g(r_i)$ 值，均匀箱宽为 $\\Delta r = 0.05\\,\\mathrm{nm}$。\n\n该积分可以近似为：\n$$\n\\int_0^{r_m} r^2 g(r) dr \\approx \\sum_{i=1}^{N} r_i^2 g(r_i) \\Delta r\n$$\n积分上限为 $r_m = 0.33\\,\\mathrm{nm}$。提供的箱中点覆盖了一个范围，其隐式上限为 $0.35\\,\\mathrm{nm}$ (最后一个箱是 $[0.30\\,\\mathrm{nm}, 0.35\\,\\mathrm{nm}]$，中点为 $0.325\\,\\mathrm{nm}$)。在处理分箱的实验或模拟数据时，当积分上限与箱边界不能完美对齐时，标准做法是利用所有中点在积分范围内或接近积分范围的箱。在这里，我们对所有 $N=7$ 个给定的数据点进行求和。这近似了在 $[0, 0.35\\,\\mathrm{nm}]$ 范围内的积分，考虑到离散化，这是对积分到 $r_m = 0.33\\,\\mathrm{nm}$ 的一个合理近似。\n\n让我们计算总和 $S = \\sum_{i=1}^{7} r_i^2 g(r_i)$：\n给定的数据点 $(r_i, g(r_i))$ 是：\n$(0.025\\,\\mathrm{nm}, 0.05)$，$(0.075\\,\\mathrm{nm}, 0.40)$，$(0.125\\,\\mathrm{nm}, 1.20)$，$(0.175\\,\\mathrm{nm}, 2.00)$，$(0.225\\,\\mathrm{nm}, 2.60)$，$(0.275\\,\\mathrm{nm}, 1.80)$，$(0.325\\,\\mathrm{nm}, 1.10)$。\n\n各项 $r_i^2 g(r_i)$ 的值（单位为 $\\mathrm{nm}^2$）是：\n\\begin{itemize}\n    \\item $i=1$: $(0.025)^2(0.05) = (0.000625)(0.05) = 0.00003125$\n    \\item $i=2$: $(0.075)^2(0.40) = (0.005625)(0.40) = 0.00225$\n    \\item $i=3$: $(0.125)^2(1.20) = (0.015625)(1.20) = 0.01875$\n    \\item $i=4$: $(0.175)^2(2.00) = (0.030625)(2.00) = 0.06125$\n    \\item $i=5$: $(0.225)^2(2.60) = (0.050625)(2.60) = 0.131625$\n    \\item $i=6$: $(0.275)^2(1.80) = (0.075625)(1.80) = 0.136125$\n    \\item $i=7$: $(0.325)^2(1.10) = (0.105625)(1.10) = 0.11618125$\n\\end{itemize}\n总和 $S$ 是：\n$$\nS = 0.00003125 + 0.00225 + 0.01875 + 0.06125 + 0.131625 + 0.136125 + 0.11618125 = 0.4662125\\,\\mathrm{nm}^2\n$$\n现在，我们计算积分的近似值：\n$$\n\\int_0^{r_m} r^2 g(r) dr \\approx S \\times \\Delta r = (0.4662125\\,\\mathrm{nm}^2) \\times (0.05\\,\\mathrm{nm}) = 0.023310625\\,\\mathrm{nm}^3\n$$\n最后，我们计算配位数，这是一个无量纲的量：\n$$\nCN(r_m) \\approx 4\\pi\\rho (S \\Delta r) = 4\\pi (32\\,\\mathrm{nm}^{-3}) (0.023310625\\,\\mathrm{nm}^3)\n$$\n$$\nCN(r_m) \\approx 128\\pi (0.023310625) \\approx 9.373753\n$$\n按要求将结果四舍五入到四位有效数字，得到 $9.374$。\n\n关于敏感性分析：\n\n对箱宽 $\\Delta r$ 的敏感性：该计算采用了中点黎曼和方法进行数值积分。对于积分 $\\int_a^b f(x)dx$，该方法的全局误差为 $O((\\Delta r)^2)$ 阶，具体来说，误差 $\\propto (b-a) (\\Delta r)^2 f''(\\xi)$，其中 $\\xi \\in [a, b]$。在我们的情况下，被积函数是 $f(r) = r^2 g(r)$。假设 $g(r)$ 以及 $f(r)$ 是足够光滑的函数（对于液体来说，这在物理上是合理的），那么计算出的配位数的精度与箱宽的平方成正比。较小的 $\\Delta r$ 会导致较小的离散化误差和更准确的结果，而较大的 $\\Delta r$ 会增加误差并使估计值不太可靠。$\\Delta r = 0.05\\,\\mathrm{nm}$ 的选择相对较粗，因此结果应被理解为受此离散化误差影响的近似值。\n\n对高斯平滑的敏感性：对 $g(r)$ 数据应用高斯平滑涉及到将测量的 $g(r)$ 与标准差为 $\\sigma$ 的高斯核进行卷积。此操作 $g_{smooth}(r) = (g * K_{\\sigma})(r)$ 是一个低通滤波器。对于小的 $\\sigma$，其主要作用是平滑掉分子模拟原始数据中经常存在的高频统计噪声。这通常会得到一条更平滑的 $g(r)$ 曲线。对配位数积分 $\\int_0^{r_m} r^2 g_{smooth}(r) dr$ 的影响是双重的。首先，通过减少统计噪声，得到的 $CN$ 可能会成为对真实系综平均值更具统计鲁棒性的估计（即方差减小）。其次，平滑操作不可避免地会通过改变函数形状（例如，稍微降低峰高并使其变宽）而引入系统偏差。由于高斯核的积分为1， $g_{smooth}(r)$ 在整个空间上的积分与 $g(r)$ 的相同，但对于像 $r^2 g(r)$ 这样的加权函数在有限区间 $r_m$ 内的积分，将会有一个小的扰动。对于小的 $\\sigma$，这种偏差通常很小。因此，应用温和的高斯平滑通常是一种有益的权衡，它以小的、通常可接受的系统误差为代价，减少了统计误差。",
            "answer": "$$\n\\boxed{9.374}\n$$"
        },
        {
            "introduction": "理论上，$g(r)$描述的是无限大体系中的平均结构，但在计算机模拟中，我们使用的是施加了周期性边界条件（PBC）的有限尺寸晶胞。本练习  将引导你从第一性原理出发，分析当计算距离超过模拟盒子尺寸一半时，最小镜像约定（MIC）如何引入几何伪影。理解并量化这种系统偏差对于正确解读模拟结果至关重要。",
            "id": "3842810",
            "problem": "一种均匀各向同性材料被模拟为在边长为$L$的单个周期性立方晶胞中的$N$个点粒子，其数密度为$\\rho$。结构分析通过径向分布函数（RDF）进行，其定义为局部对密度与理想气体参考值的比值，即真实的连续RDF $g(r)$ 满足 $g(r) = \\frac{1}{4 \\pi r^{2} \\rho}$ 乘以以一个参考粒子为中心、半径为$r$、厚度为$\\mathrm{d}r$的球壳内的期望粒子数。在实践中，RDF估计量 $\\hat{g}(r)$ 是在周期性边界条件下使用最小镜像约定从粒子对计算得出的，而不像处理长程相互作用的Ewald求和（Ewald summation (ES)）那样对所有周期性副本的贡献进行求和。\n\n仅从RDF是对计数与理想气体壳层体积之比的定义，以及最小镜像位移矢量位于立方体 $\\{(x,y,z): |x| \\le L/2, |y| \\le L/2, |z| \\le L/2\\}$ 内这一几何事实出发，解释为什么在不重构完整周期性壳层（即，不进行类似ES的副本求和）的情况下，$\\hat{g}(r)$ 应该只在 $r  L/2$ 的范围内报告。然后，对于超出$L/2$但未达到最近盒子棱线距离的区间，特别是对于 $L/2  r \\le L/\\sqrt{2}$，为一个均匀各向同性系统从第一性原理推导精确的乘性偏差因子 $B(r)$，使得 $\\hat{g}(r) = B(r) \\, g(r)$。你的推导必须通过计算位于最小镜像立方体内的半径为$r$的球壳面积的比例来进行，仅使用球冠的基本几何关系，而不借用任何RDF估计量的快捷公式。\n\n将你的最终答案表示为关于$L$和$r$的$B(r)$的闭式解析表达式。不需要单位。不要四舍五入；不要求数值近似。最终答案必须是单个表达式。",
            "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 第1步：提取已知条件\n- 系统：$N$个点粒子，数密度为$\\rho$。\n- 模拟晶胞：边长为$L$的单个周期性立方晶胞。\n- 材料性质：均匀各向同性。\n- 真实RDF定义：$g(r) = \\frac{1}{4 \\pi r^{2} \\rho} \\times (\\text{半径为 } r \\text{、厚度为 } \\mathrm{d}r \\text{ 的球壳内的期望粒子数})$。\n- RDF估计量 $\\hat{g}(r)$：使用最小镜像约定（MIC）从粒子对计算得出。\n- MIC几何：最小镜像位移矢量位于立方体 $\\{(x,y,z): |x| \\le L/2, |y| \\le L/2, |z| \\le L/2\\}$ 内。该立方体是周期性映像构成的简单立方晶格的Wigner-Seitz原胞。\n- 计算约束：不对周期性副本求和（即，不使用类似Ewald求和的方法进行对计数）。\n- 任务1：解释为什么 $\\hat{g}(r)$ 应该只在 $r  L/2$ 的范围内报告。\n- 任务2：推导在 $L/2  r \\le L/\\sqrt{2}$ 范围内的乘性偏差因子 $B(r)$，使得 $\\hat{g}(r) = B(r) g(r)$。\n- 推导约束：推导必须从第一性原理出发，通过计算位于最小镜像立方体内的球壳面积的比例，并使用球冠的基本几何关系。\n\n### 第2步：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题是计算统计物理学和材料科学中的标准问题。径向分布函数（RDF）、周期性边界条件（PBC）和最小镜像约定（MIC）的概念是分子模拟的基础。所描述的几何伪影是一个众所周知的问题。\n- **适定性**：该问题是适定的。它提供了一个清晰的物理和几何设置，并要求在变量$r$的确定范围内进行特定推导。目标是推导一个单一、唯一的解析表达式。\n- **客观性**：该问题以精确、客观的语言陈述。它要求进行数学推导，不含主观性。\n- **完整性和一致性**：该问题为推导提供了所有必要信息：模拟晶胞的形状（立方体）、边长$L$、对计数方法（MIC）以及要考虑的距离$r$的特定范围。约束条件是一致且清晰的。\n- **可行性**：该设置是模拟系统的标准表示。所需的推导基于基本的三维欧几里得几何，是完全可行的。\n\n### 第3步：结论与行动\n该问题是有效的。这是一个计算物理学中定义明确的问题，考验对模拟方法学的基本理解。将提供一个合理的解决方案。\n\n径向分布函数（RDF），$g(r)$，提供了一种衡量在距离一个参考粒子$r$处找到另一个粒子的概率的方法，该概率是相对于理想气体的。在具有周期性边界条件（PBC）和最小镜像约定（MIC）的模拟中计算出的估计量$\\hat{g}(r)$由下式给出：\n$$\n\\hat{g}(r) = \\frac{V}{N} \\frac{\\langle n(r) \\rangle}{V_{shell}(r)}\n$$\n其中 $\\langle n(r) \\rangle$ 是在围绕中心粒子的半径为$r$、厚度为$\\mathrm{d}r$的球壳中找到的平均粒子数，$V_{shell}(r) = 4\\pi r^2 \\mathrm{d}r$ 是该壳层的体积，而 $\\frac{N}{V} = \\rho$ 是数密度。对于一个均匀系统，真实的对密度是 $\\rho g(r)$。在围绕一个参考粒子的采样体积 $V_{sampled}$ 中找到的对数是 $\\rho g(r) V_{sampled}$。估计量 $\\hat{g}(r)$ 假设采样体积是完整的球壳 $V_{shell}(r)$。因此：\n$$\n\\hat{g}(r) = \\frac{\\rho g(r) V_{sampled}(r)}{\\rho V_{shell}(r)} = g(r) \\frac{V_{sampled}(r)}{V_{shell}(r)}\n$$\n由于厚度 $\\mathrm{d}r$ 是无穷小且恒定的，体积之比等价于表面积之比。设 $A_{sampled}(r)$ 为在MIC下可访问的半径为$r$的球壳面积，而 $A_{total}(r) = 4\\pi r^2$ 为壳层的总面积。偏差因子 $B(r)$ 正是这个比率：\n$$\nB(r) = \\frac{A_{sampled}(r)}{A_{total}(r)}\n$$\n\n首先，我们解释为什么 $\\hat{g}(r)$ 通常只在 $r  L/2$ 的范围内报告。MIC确保对于任何粒子对，我们都考虑其最近周期性映像之间的距离。这等同于将一个参考粒子放置在边长为$L$的立方晶胞中心，该晶胞在每个笛卡尔方向上从$-L/2$延伸到$+L/2$，并在此晶胞内寻找所有其他粒子。以参考粒子为中心的半径为$r$的球面代表了第二个粒子在距离$r$处所有可能位置的轨迹。如果 $r  L/2$，这个完整的球面都包含在MIC立方体内。因此，采样体积 $V_{sampled}(r)$ 确实是完整的球壳体积 $V_{shell}(r)$。偏差因子 $B(r)$ 为 $1$，$\\hat{g}(r)$ 是 $g(r)$ 的无偏估计量。然而，如果 $r > L/2$，半径为$r$的球面不再完全包含在MIC立方体内。球面的部分区域会位于该立方体之外。由于MIC计算只“看到”该立方体内的粒子对，它会漏掉本应存在于被截断区域中的任何粒子对。然而，RDF计算中的归一化分母仍然是 $4\\pi r^2 \\mathrm{d}r$，这隐含地假设了整个壳层都被采样。这种不匹配导致了系统性的计数不足，使得 $\\hat{g}(r)$ 人为地小于 $g(r)$。这是一种几何伪影，而不是物理效应。为避免这种伪影，人们将计算限制在 $r  L/2$ 的范围内，这是采样体积保持完整的最大半径。\n\n接下来，我们推导在特定范围 $L/2  r \\le L/\\sqrt{2}$ 内的精确乘性偏差因子 $B(r)$。MIC立方体由不等式 $|x| \\le L/2$、 $|y| \\le L/2$ 和 $|z| \\le L/2$ 定义。中心到任何一个面的距离是 $L/2$。中心到一条棱的距离是 $\\sqrt{(L/2)^2 + (L/2)^2} = L/\\sqrt{2}$。中心到一个角的距离是 $\\sqrt{(L/2)^2 + (L/2)^2 + (L/2)^2} = \\sqrt{3}L/2$。\n\n在给定范围 $L/2  r \\le L/\\sqrt{2}$ 内，一个以原点为中心、半径为$r$的球面与MIC立方体的六个面相交，但未达到其棱或角。这意味着位于立方体外部的球面部分由六个相同的、不重叠的球冠组成。\n\n位于立方体内部的球面部分面积 $A_{sampled}(r)$，是球的总面积 $A_{total}(r) = 4\\pi r^2$ 减去这六个球冠的面积。我们来计算单个球冠的面积。一个球冠由一个与球面相交的平面所定义。立方体的六个面对应于平面 $x=\\pm L/2$，$y=\\pm L/2$ 和 $z=\\pm L/2$。让我们考虑由平面 $x=L/2$ 切割出的球冠。\n球冠的表面积由公式 $A_{cap} = 2\\pi r h$ 给出，其中$r$是球的半径，$h$是球冠的高度。高度$h$是沿轴线从球极点到切割平面的距离。\n球体以原点为中心，半径为$r$。切割平面距离中心的距离为 $d = L/2$。球冠的高度是球的半径与到平面的距离之差：\n$$\nh = r - \\frac{L}{2}\n$$\n一个这样的球冠的面积是：\n$$\nA_{cap} = 2\\pi r \\left(r - \\frac{L}{2}\\right)\n$$\n由于有六个这样相同的球冠（在$x, y, z$方向的正负面各一个），MIC立方体外部的总面积是：\n$$\nA_{outside}(r) = 6 \\times A_{cap} = 6 \\times 2\\pi r \\left(r - \\frac{L}{2}\\right) = 12\\pi r \\left(r - \\frac{L}{2}\\right) = 12\\pi r^2 - 6\\pi r L\n$$\n位于立方体内的球表面积就是：\n$$\nA_{sampled}(r) = A_{total}(r) - A_{outside}(r) = 4\\pi r^2 - (12\\pi r^2 - 6\\pi r L)\n$$\n$$\nA_{sampled}(r) = 4\\pi r^2 - 12\\pi r^2 + 6\\pi r L = 6\\pi r L - 8\\pi r^2\n$$\n偏差因子 $B(r)$ 是采样面积与总面积的比值：\n$$\nB(r) = \\frac{A_{sampled}(r)}{A_{total}(r)} = \\frac{6\\pi r L - 8\\pi r^2}{4\\pi r^2}\n$$\n我们可以从分子和分母中约去公因子 $2\\pi r^2$，但为求精确，我们约去 $4\\pi r$：\n$$\nB(r) = \\frac{r(6\\pi L - 8\\pi r)}{4\\pi r^2} = \\frac{6L - 8r}{4r}\n$$\n化简表达式得到偏差因子的最终形式：\n$$\nB(r) = \\frac{2(3L - 4r)}{2(2r)} = \\frac{3L - 4r}{2r} = \\frac{3L}{2r} - 2\n$$\n该表达式在 $L/2  r \\le L/\\sqrt{2}$ 范围内有效。作为检验，在下界 $r \\to (L/2)^+$ 处，$B(L/2) = \\frac{3L}{2(L/2)} - 2 = 3 - 2 = 1$，这正确地表明当球面刚接触到各个面时没有偏差。对于指定范围内的任何$r$，$L/2  r$ 意味着 $L  2r$，所以 $3L  6r$。同样 $L/2  r \\implies 2r > L \\implies 8r > 4L$。从表达式 $B(r) = \\frac{3L-4r}{2r}$ 来看，因为 $r > L/2 \\implies 4r > 2L$，所以 $3L-4r$ 是否为正并不是显而易见的。让我们重新审视。$r \\le L/\\sqrt{2} \\implies r^2 \\le L^2/2 \\implies 2r^2 \\le L^2$。让我们检查$B(r)$的零点：$3L/2r-2=0 \\implies 3L=4r \\implies r=3L/4$。由于 $\\sqrt{2} \\approx 1.414$，$1/\\sqrt{2} \\approx 0.707$。我们处于 $0.5L  r \\le 0.707L$ 的范围内。值 $r=3L/4=0.75L$ 在此范围之外，因此在 $L/2  r \\le L/\\sqrt{2}$ 内 $B(r)$ 不会变为零或负数。此外，因为 $r  3L/4$，所以 $4r  3L$ 成立，确保了 $B(r)$ 在整个指定区间内为正。",
            "answer": "$$\n\\boxed{\\frac{3L}{2r} - 2}\n$$"
        },
        {
            "introduction": "$g(r)$提供了关于原子排列的直观实空间图像，而静态结构因子$S(k)$则在倒易空间中描述了相同的结构信息，并且可以直接与X射线或中子散射实验进行比较。本练习  将带你完成从$g(r)$计算$S(k)$所需的数学推导和数值实现。通过这项实践，你将掌握连接实空间和倒易空间的傅里葉-贝塞尔变换，并学会分析截断和离散化等数值误差的来源。",
            "id": "3842807",
            "problem": "给定一种统计均匀且各向同性的材料，其特征由径向分布函数 (RDF) $g(r)$ 描述，其中 $r$ 是空间中两点之间的标量距离。RDF 通过 $h(r) = g(r) - 1$ 与总相关函数 $h(r)$ 相关。静态结构因子 $S(k)$（其中 $k$ 是波矢的模）编码了关于两点相关的倒易空间信息。您的任务是，基于统计力学和三维傅里叶分析的第一性原理，使用球贝塞尔函数变换推导连接 $S(k)$ 与 $h(r)$ 的数学关系，并实现一个数值算法，该算法从给定的 $g(r)$ 开始，为指定的 $k$ 值计算 $S(k)$。您必须分析在有限 $r_{\\max}$ 处截断实空间积分所引入的数值误差。\n\n使用以下基本依据：\n- 统计均匀性和各向同性意味着所有两点量仅取决于标量距离 $r$，并且它们的倒易空间表示仅取决于 $k = \\|\\mathbf{k}\\|$。\n- 总相关函数 $h(r)$ 定义为 $h(r) = g(r) - 1$。\n- 结构因子 $S(k)$ 源于双粒子相关的空间傅里叶分析，并且是无量纲的。\n- 零阶球贝塞尔函数定义为 $j_{0}(x)$，它在各向同性三维傅里叶变换的角度积分中自然出现。\n\n您不能先验地使用或陈述任何快捷公式。相反，您必须从上述基础出发，推导出连接 $S(k)$ 与 $h(r)$ 的表达式，并设计一种数值方法来在有限径向网格上评估所产生的变换。您必须解释有限-$r$截断（$r \\le r_{\\max}$）如何影响数值精度，并相对于已知的解析基准来量化误差。\n\n为了使问题具体且可测试，请考虑以下总相关函数的参数族：\n- $g(r) = 1 + A \\exp\\!\\left(-\\dfrac{r^{2}}{2 \\sigma^{2}}\\right)$，因此 $h(r) = A \\exp\\!\\left(-\\dfrac{r^{2}}{2 \\sigma^{2}}\\right)$，其中振幅为 $A$，高斯宽度为 $\\sigma$。\n\n对于此 $h(r)$，可以从高斯函数的三维傅里叶变换中解析地获得精确的倒易空间变换，因此精确的结构因子 $S_{\\text{exact}}(k)$ 可作为误差分析的基准。您的数值算法必须：\n- 构建一个间距为 $\\Delta r$ 的均匀径向网格 $r \\in [0, r_{\\max}]$。\n- 从 $g(r)$ 计算 $h(r)$。\n- 使用推导出的球贝塞尔变换，在一组给定的 $k$ 值上评估 $S(k)$。\n- 将误差量化为在给定 $k$ 值集合上的最大绝对偏差，定义为 $E = \\max_{k \\in \\mathcal{K}} \\left| S_{\\text{num}}(k) - S_{\\text{exact}}(k) \\right|$，其中 $S_{\\text{num}}(k)$ 是数值计算的结构因子，$\\mathcal{K}$ 是测试 $k$ 值的集合。\n\n所有量均为无量纲。将最终的数值误差表示为无量纲浮点数。\n\n测试套件：\n对于每个测试用例，您将获得数密度 $\\rho$、振幅 $A$、高斯宽度 $\\sigma$、截断半径 $r_{\\max}$、径向步长 $\\Delta r$ 和一组 $k$ 值 $\\mathcal{K}$：\n\n- 测试 1（理想路径，细网格，大 $r_{\\max}$）：$\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 3.00$, $\\Delta r = 0.002$, $\\mathcal{K} = \\{0.00, 1.00, 5.00, 10.00\\}$。\n- 测试 2（截断主导误差）：$\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 0.70$, $\\Delta r = 0.002$, $\\mathcal{K} = \\{0.00, 1.00, 5.00, 10.00\\}$。\n- 测试 3（离散化主导误差）：$\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 3.00$, $\\Delta r = 0.050$, $\\mathcal{K} = \\{0.00, 1.00, 5.00, 10.00\\}$。\n- 测试 4（更宽的 $h(r)$ 增加了截断敏感性，不同的 $\\rho$）：$\\rho = 0.65$, $A = 0.60$, $\\sigma = 0.60$, $r_{\\max} = 2.00$, $\\Delta r = 0.002$, $\\mathcal{K} = \\{0.00, 1.00, 3.00, 6.00\\}$。\n- 测试 5（高频变换行为）：$\\rho = 0.85$, $A = 0.60$, $\\sigma = 0.25$, $r_{\\max} = 6.00$, $\\Delta r = 0.005$, $\\mathcal{K} = \\{15.00, 25.00, 40.00\\}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[e_{1},e_{2},e_{3},e_{4},e_{5}]$），其中 $e_{i}$ 是为测试 $i$ 计算的无量纲浮点数 $E$。",
            "solution": "出发点是均匀、各向同性材料中两点相关的统计力学定义。径向分布函数 (RDF) $g(r)$ 仅取决于标量距离 $r$，并通过 $h(r) = g(r) - 1$ 与总相关函数 $h(r)$ 相关。静态结构因子 $S(k)$ 编码了倒易空间中密度涨落的强度，它是通过对双粒子相关进行空间傅里叶表征得到的。\n\n基于原理的推导：\n- 在 $d = 3$ 维中，统计均匀性和各向同性意味着对相关仅取决于 $r = \\|\\mathbf{r}\\|$，而倒易空间描述仅取决于 $k = \\|\\mathbf{k}\\|$。\n- 结构因子 $S(k)$ 可以从涉及总相关函数 $h(\\mathbf{r})$ 的傅里叶变换（由数密度 $\\rho$ 加权）的定义中推导出来。从连接 $S(k)$ 与两点密度相关的定义出发，可以得到三维傅里叶空间中的关系：\n$$\nS(k) = 1 + \\rho \\int_{\\mathbb{R}^{3}} h(\\mathbf{r}) e^{i \\mathbf{k} \\cdot \\mathbf{r}} \\, d^{3}\\mathbf{r}.\n$$\n- 对于各向同性的 $h(\\mathbf{r}) = h(r)$，我们在球坐标中表示该积分，并将 $\\mathbf{k}$ 与极轴对齐。角度积分产生零阶第一类球贝塞尔函数 $j_{0}(x)$，它源于\n$$\n\\int e^{i \\mathbf{k} \\cdot \\mathbf{r}} \\, d\\Omega = 4\\pi \\frac{\\sin(kr)}{kr} = 4\\pi j_{0}(kr).\n$$\n- 因此，三维各向同性变换简化为球贝塞尔变换\n$$\nS(k) = 1 + 4\\pi \\rho \\int_{0}^{\\infty} r^{2} h(r) j_{0}(kr) \\, dr,\n$$\n其中 $j_{0}(x) = \\dfrac{\\sin(x)}{x}$。\n\n数值算法：\n- 我们构建一个间距为 $\\Delta r$ 的均匀径向网格 $r \\in [0, r_{\\max}]$，根据给定的参数形式在该网格上定义 $g(r)$，并获得 $h(r) = g(r) - 1$。\n- 对于每个给定的 $k$，通过求积法数值计算积分：\n$$\nH_{\\text{num}}(k) \\approx 4\\pi \\sum_{n} r_{n}^{2} h(r_{n}) j_{0}(k r_{n}) \\Delta r,\n$$\n然后\n$$\nS_{\\text{num}}(k) = 1 + \\rho H_{\\text{num}}(k).\n$$\n- 我们使用数值稳定的球贝塞尔函数实现来评估 $j_{0}(x)$，特别是在 $x=0$ 处，$j_{0}(0)=1$。\n\n高斯 $h(r)$ 的解析基准：\n- 考虑 $h(r) = A \\exp\\!\\left(-\\dfrac{r^{2}}{2 \\sigma^{2}}\\right)$，它是球对称的。其三维傅里叶变换在笛卡尔坐标中是可分离的，是一维高斯变换的乘积。具体来说，使用惯例\n$$\n\\hat{h}(\\mathbf{k}) = \\int_{\\mathbb{R}^{3}} h(\\mathbf{r}) e^{i \\mathbf{k} \\cdot \\mathbf{r}} \\, d^{3}\\mathbf{r},\n$$\n我们得到\n$$\n\\hat{h}(\\mathbf{k}) = A (2\\pi)^{3/2} \\sigma^{3} \\exp\\!\\left(-\\frac{\\sigma^{2} k^{2}}{2}\\right),\n$$\n其中 $k = \\|\\mathbf{k}\\|$。因此，精确的结构因子是\n$$\nS_{\\text{exact}}(k) = 1 + \\rho A (2\\pi)^{3/2} \\sigma^{3} \\exp\\!\\left(-\\frac{\\sigma^{2} k^{2}}{2}\\right).\n$$\n\n由有限 $r$ 截断和离散化引起的误差：\n- 截断用 $\\int_{0}^{r_{\\max}}$ 替换了 $\\int_{0}^{\\infty}$，引入了一个误差\n$$\n\\varepsilon_{\\text{trunc}}(k) = 4\\pi \\rho \\int_{r_{\\max}}^{\\infty} r^{2} h(r) j_{0}(kr) \\, dr.\n$$\n- 由于对所有 $x$，都有 $|j_{0}(x)| \\le 1$，一个界限是\n$$\n|\\varepsilon_{\\text{trunc}}(k)| \\le 4\\pi \\rho \\int_{r_{\\max}}^{\\infty} r^{2} |h(r)| \\, dr.\n$$\n- 对于高斯 $h(r)$，尾部积分迅速衰减，可以用互补误差函数表示，表明随着 $r_{\\max}/\\sigma$ 的增加，误差呈指数级抑制。\n- 离散化误差的产生是因为积分是用有限的 $\\Delta r$ 近似的，这引入了求积误差，其大小通常与 $\\Delta r$ 的某个幂成正比，具体取决于所选的规则和被积函数的平滑度。对于大 $k$ 处的振荡因子 $j_{0}(kr)$，需要更精细的 $\\Delta r$ 来解析振荡，并且需要更大的 $r_{\\max}$ 来控制截断。\n\n误差度量和测试套件评估：\n- 对于每个测试用例，定义 $k$ 值的集合 $\\mathcal{K}$ 并计算\n$$\nE = \\max_{k \\in \\mathcal{K}} \\left| S_{\\text{num}}(k) - S_{\\text{exact}}(k) \\right|.\n$$\n- 理想路径（测试 1）使用足够大的 $r_{\\max}$ 和精细的 $\\Delta r$，产生小的 $E$。\n- 截断主导的情况（测试 2）大幅减小 $r_{\\max}$，由于缺少高斯尾部贡献而增加了 $E$。\n- 离散化主导的情况（测试 3）在其他方面足够的 $r_{\\max}$ 下使用粗糙的 $\\Delta r$，由于对 $j_{0}(kr)$ 的振荡解析不足而增加了 $E$。\n- 更宽的 $h(r)$（测试 4）增加了对截断的敏感性，因为高斯函数在 $r$ 中延伸得更远，需要更大的 $r_{\\max}$ 来捕获其质量。\n- 高频情况（测试 5）探测大的 $k$ 值，此时被积函数高度振荡；较大的 $r_{\\max}$ 和足够小的 $\\Delta r$ 可以减轻误差。\n\n实现细节：\n- 我们通过一个可靠的数值函数使用球贝塞尔函数 $j_{0}(x)$，并使用梯形法则进行数值求积，以保证鲁棒性和简单性。\n- 对于每个测试用例，我们生成径向网格 $r_{n} = n \\Delta r, n = 0, \\dots, \\lfloor r_{\\max} / \\Delta r \\rfloor$，计算 $g(r_{n})$, $h(r_{n})$，并为每个 $k \\in \\mathcal{K}$ 评估 $S_{\\text{num}}(k)$。\n- 我们直接从解析表达式计算 $S_{\\text{exact}}(k)$，并报告每个测试用例的 $E$。\n\n最终程序输出单行，包含 $[e_{1},e_{2},e_{3},e_{4},e_{5}]$，其中每个 $e_{i}$ 是测试 $i$ 的无量纲浮点数 $E$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import spherical_jn\n\ndef spherical_bessel_j0(x):\n    # j0(x) = spherical_jn(0, x)\n    return spherical_jn(0, x)\n\ndef compute_S_num(rho, A, sigma, r_max, dr, k_values):\n    # Build radial grid\n    n_points = int(np.floor(r_max / dr)) + 1\n    r = np.linspace(0.0, r_max, n_points)\n    # Define g(r) and h(r)\n    g = 1.0 + A * np.exp(-r**2 / (2.0 * sigma**2))\n    h = g - 1.0\n    # Precompute r^2 h(r)\n    r2h = r**2 * h\n    S_vals = []\n    for k in k_values:\n        j0 = spherical_bessel_j0(k * r)\n        integrand = r2h * j0\n        H_num = 4.0 * np.pi * np.trapz(integrand, r)\n        S_num = 1.0 + rho * H_num\n        S_vals.append(S_num)\n    return np.array(S_vals)\n\ndef compute_S_exact(rho, A, sigma, k_values):\n    # Exact 3D Fourier transform of Gaussian h(r) = A * exp(-r^2 / (2 sigma^2))\n    # \\hat{h}(k) = A * (2*pi)^(3/2) * sigma^3 * exp(-sigma^2 * k^2 / 2)\n    factor = A * (2.0 * np.pi) ** (1.5) * (sigma ** 3)\n    S_exact = 1.0 + rho * factor * np.exp(-0.5 * (sigma ** 2) * (np.array(k_values) ** 2))\n    return S_exact\n\ndef max_abs_error(S_num, S_exact):\n    return float(np.max(np.abs(S_num - S_exact)))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (rho, A, sigma, r_max, dr, k_values)\n    test_cases = [\n        (0.85, 0.60, 0.25, 3.00, 0.002, [0.00, 1.00, 5.00, 10.00]),  # Test 1\n        (0.85, 0.60, 0.25, 0.70, 0.002, [0.00, 1.00, 5.00, 10.00]),  # Test 2\n        (0.85, 0.60, 0.25, 3.00, 0.050, [0.00, 1.00, 5.00, 10.00]),  # Test 3\n        (0.65, 0.60, 0.60, 2.00, 0.002, [0.00, 1.00, 3.00, 6.00]),   # Test 4\n        (0.85, 0.60, 0.25, 6.00, 0.005, [15.00, 25.00, 40.00]),      # Test 5\n    ]\n\n    results = []\n    for rho, A, sigma, r_max, dr, k_values in test_cases:\n        S_num = compute_S_num(rho, A, sigma, r_max, dr, k_values)\n        S_ex = compute_S_exact(rho, A, sigma, k_values)\n        err = max_abs_error(S_num, S_ex)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}