## 引言
在[计算催化](@entry_id:165043)和化学工程领域，对材料的原子尺度理解是推动创新的关键。晶体、表面和[纳米材料](@entry_id:150391)等周期性体系的模拟，构成了这一探索的核心。然而，要精确求解这些无限体系的电子结构，需要一个既严谨又高效的理论框架。[平面波基组](@entry_id:178287)正是在此背景下应运而生，成为周期性体系第一性原理计算的黄金标准。它不仅提供了一个系统可控的精度提升路径，还凭借其独特的计算优势，使得对复杂催化过程的模拟成为可能。

本文旨在全面解析[平面波基组](@entry_id:178287)这一强大的计算方法。我们将填补理论概念与实际应用之间的鸿沟，为读者构建一个从基本原理到前沿研究的完整知识体系。通过学习本文，您将掌握[平面波](@entry_id:189798)方法的核心思想，理解其为何在模拟周期性体系时如此成功，并学会如何将其应用于解决真实的科学问题。

为实现这一目标，文章将分为三个核心部分。我们将在第一章“原理与机制”中，深入探讨[布洛赫定理](@entry_id:137461)、赝势理论和PAW方法等基石概念，揭示平面波方法的理论根源和力学构造。接着，在第二章“应用与交叉学科联系”中，我们将展示平面波方法如何在[表面科学](@entry_id:155397)、多相催化和材料物理等领域大放异彩，并探讨其与实验技术和更高级理论方法的交叉融合。最后，在“动手实践”部分，通过一系列精心设计的问题，您将有机会将理论知识转化为解决具体计算挑战的实践能力。

## 原理与机制

在周期性体系的量子力学计算中，选择一个完备且高效的基组来展开电子[波函数](@entry_id:201714)是核心挑战之一。对于晶体、表面和纳米线等具有平移对称性的体系，[平面波基组](@entry_id:178287)提供了一个系统、严谨且在计算上极具吸[引力](@entry_id:189550)的框架。本章将深入探讨[平面波基组](@entry_id:178287)的理论基础、实际应用机制及其在计算催化和化学工程领域中的关键优势与挑战。

### 周期性、[布洛赫定理](@entry_id:137461)与倒易空间

周期性体系最根本的特征是其在空间中重复的结构。这种离散[平移对称性](@entry_id:171614)是理解其[电子性质](@entry_id:748898)的基石。考虑一个具有周期性有效势 $V(\mathbf{r})$ 的单[电子哈密顿量](@entry_id:177588) $\hat{H} = -\frac{\hbar^2}{2m}\nabla^2 + V(\mathbf{r})$，其中对于任何布拉维格矢 $\mathbf{R}$，势满足 $V(\mathbf{r}+\mathbf{R})=V(\mathbf{r})$。

我们可以定义一个[晶格](@entry_id:148274)[平移算符](@entry_id:756122) $\hat{T}_{\mathbf{R}}$，其作用于任意函数 $\psi(\mathbf{r})$ 的效果是 $\hat{T}_{\mathbf{R}}\psi(\mathbf{r}) = \psi(\mathbf{r}+\mathbf{R})$。由于哈密顿量中的[动能算符](@entry_id:265633)和势能算符都具有与格点平移操作的对易性，即 $[\hat{H}, \hat{T}_{\mathbf{R}}] = 0$，这意味着哈密顿量 $\hat{H}$ 与所有[平移算符](@entry_id:756122) $\hat{T}_{\mathbf{R}}$ 共享一个共同的[本征函数](@entry_id:154705)集。

根据群论，这些[本征函数](@entry_id:154705)可以被一个[波矢](@entry_id:178620) $\mathbf{k}$ 标记，并满足如下关系，这便是**[布洛赫定理](@entry_id:137461) (Bloch's Theorem)** 的核心表述 ：
$$ \psi_{\mathbf{k}}(\mathbf{r} + \mathbf{R}) = e^{i\mathbf{k}\cdot\mathbf{R}}\psi_{\mathbf{k}}(\mathbf{r}) $$
这里的 $e^{i\mathbf{k}\cdot\mathbf{R}}$ 是[平移算符](@entry_id:756122) $\hat{T}_{\mathbf{R}}$ 的本征值。向量 $\mathbf{k}$ 被称为**[晶体动量](@entry_id:136369)**或**[布洛赫波矢](@entry_id:746866)**，它为电子态提供了一个[量子数](@entry_id:145558)标签。

[布洛赫定理](@entry_id:137461)还有另一种等价且更具启发性的形式。我们可以将[布洛赫函数](@entry_id:189422)写作一个平面波 $e^{i\mathbf{k}\cdot\mathbf{r}}$ 与一个具有[晶格](@entry_id:148274)周期性的函数 $u_{n\mathbf{k}}(\mathbf{r})$ 的乘积：
$$ \psi_{n\mathbf{k}}(\mathbf{r}) = e^{i\mathbf{k}\cdot\mathbf{r}}u_{n\mathbf{k}}(\mathbf{r}), \quad \text{其中} \quad u_{n\mathbf{k}}(\mathbf{r}+\mathbf{R}) = u_{n\mathbf{k}}(\mathbf{r}) $$
这里，$n$ 是能带指数，用于区分在同一个 $\mathbf{k}$ 值下可能存在的多个不同[本征态](@entry_id:149904)。这种形式清晰地表明，晶体中的电子[波函数](@entry_id:201714)是一个被[晶格](@entry_id:148274)周期性函数调制的[平面波](@entry_id:189798)。

值得注意的是，[晶体动量](@entry_id:136369) $\mathbf{k}$ 的定义并非唯一的。考虑一个**倒易格矢** $\mathbf{G}$，它定义为对于所有[实空间](@entry_id:754128)格矢 $\mathbf{R}$ 均满足 $e^{i\mathbf{G}\cdot\mathbf{R}} = 1$。如果我们用 $\mathbf{k}' = \mathbf{k}+\mathbf{G}$ 替换 $\mathbf{k}$，[平移算符](@entry_id:756122)的[本征值保持](@entry_id:636565)不变：
$$ e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{R}} = e^{i\mathbf{k}\cdot\mathbf{R}}e^{i\mathbf{G}\cdot\mathbf{R}} = e^{i\mathbf{k}\cdot\mathbf{R}} \times 1 = e^{i\mathbf{k}\cdot\mathbf{R}} $$
这意味着标签 $\mathbf{k}$ 和 $\mathbf{k}+\mathbf{G}$ 描述的是同一个物理状态，因为它们对应于平移群的同一个[不可约表示](@entry_id:263310) 。因此，我们只需在倒易空间的一个原胞（通常选择为**第一布里渊区 (First Brillouin Zone)**）内考虑所有不等价的 $\mathbf{k}$ 点，即可描述体系的所有电子态。

[布洛赫定理](@entry_id:137461)的成立仅依赖于[哈密顿量](@entry_id:144286)的离散[平移不变性](@entry_id:195885)。无论势是局域的还是非局域的（例如在密度泛函理论中使用的范数守恒赝势），只要其核满足[晶格](@entry_id:148274)周期性，定理就成立。实际计算中常采用的**[玻恩-冯·卡门](@entry_id:201892) ([Born-von Karman](@entry_id:201892)) 边界条件**，本质上是对一个宏观超胞施加周期性，其作用是使布里渊区内的 $\mathbf{k}$ 点离散化，但这并非[布洛赫定理](@entry_id:137461)成立的前提。然而，如果存在破坏[平移对称性](@entry_id:171614)的外部场（如均匀磁场），常规的[布洛赫定理](@entry_id:137461)将不再适用，需要引入磁[平移算符](@entry_id:756122)等更复杂的理论 。

### [平面波基组](@entry_id:178287)的构建与截断

[布洛赫定理](@entry_id:137461)自然地引出了[平面波基组](@entry_id:178287)。由于函数 $u_{n\mathbf{k}}(\mathbf{r})$ 具有[晶格](@entry_id:148274)周期性，它可以被展开为[傅里叶级数](@entry_id:139455)的形式，其基函数由倒易格矢 $\mathbf{G}$ 决定：
$$ u_{n\mathbf{k}}(\mathbf{r}) = \sum_{\mathbf{G}} c_{n\mathbf{k}}(\mathbf{G}) e^{i\mathbf{G}\cdot\mathbf{r}} $$
将此展开代入[布洛赫函数](@entry_id:189422)的第二种形式，我们得到给定波矢 $\mathbf{k}$ 下的任意一个 Kohn-Sham 轨道 $\psi_{n\mathbf{k}}(\mathbf{r})$ 的[平面波展开](@entry_id:152012)式：
$$ \psi_{n\mathbf{k}}(\mathbf{r}) = \sum_{\mathbf{G}} c_{n\mathbf{k}}(\mathbf{G}) e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}} $$
这表明，对于一个特定的 $\mathbf{k}$ 点，其对应的[本征函数](@entry_id:154705)可以由一组波矢为 $\{\mathbf{k}+\mathbf{G}\}$ 的平面波线性组合而成。

在实际计算中，这个无限的基组必须被截断为一个有限大小的集合。一个物理上合理且在计算上鲁棒的截断方法是，只包含那些动能小于某个阈值的平面波。这个阈值被称为**[动能截断](@entry_id:186065)能 (kinetic energy cutoff)**，记为 $E_{\text{cut}}$。一个[平面波基](@entry_id:140187)函数 $e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}$ 的动能为 $\frac{\hbar^2}{2m}|\mathbf{k}+\mathbf{G}|^2$。因此，对于给定的 $\mathbf{k}$ 点，有限的基组由满足以下条件的[平面波](@entry_id:189798)构成 ：
$$ \frac{\hbar^2}{2m}|\mathbf{k}+\mathbf{G}|^2 \le E_{\text{cut}} $$
这种截断方式的一个核心优势是其**系统收敛性**。根据量子力学中的 **Rayleigh-Ritz [变分原理](@entry_id:198028)**，对于任何不完备的基组，计算得到的基态总能量总是真实[基态能量](@entry_id:263704)的上限。当我们增加 $E_{\text{cut}}$ 时，基组会变得更加完备。具体来说，如果 $E_{\text{cut},1}  E_{\text{cut},2}$，那么在 $E_{\text{cut},1}$ 下的基组是 $E_{\text{cut},2}$ 下基组的一个子集。这种**嵌套子空间**的特性确保了随着 $E_{\text{cut}}$ 的增加，计算得到的基态总能量会系统地、单调地（从上方）收敛到[完备基组极限](@entry_id:200862)下的真实值。这种可控的收敛性是平面波方法最强大的优点之一。

### 核心区的挑战：[赝势](@entry_id:170389)与PAW方法

尽管[平面波基组](@entry_id:178287)具有诸多优点，但直接用其描述全电子体系面临着巨大的挑战。其根源在于原子核附近电子[波函数](@entry_id:201714)的剧烈行为。根据**卡托[尖点条件](@entry_id:190416) (Kato's cusp condition)**，在原子核位置，由于[库仑势](@entry_id:154276)的奇异性，电子[波函数](@entry_id:201714)虽然是连续的，但其一阶导数不连续，形成一个“尖点” 。同时，[内层电子](@entry_id:163897)的[波函数](@entry_id:201714)在空间上高度局域且快速振荡。

从[傅里叶分析](@entry_id:137640)的角度来看，一个函数越不光滑，其傅里叶展开系数的衰减速度就越慢。一个具有导数不连续尖点的函数，其[傅里叶系数](@entry_id:144886) $|c_G|$ 随着[波矢](@entry_id:178620)大小 $|G|$ 的增加，其衰减速度仅为 $|G|^{-2}$。这意味着要精确描述原子核附近的[波函数](@entry_id:201714)尖点和[内层电子](@entry_id:163897)的快速振荡，需要包含大量高动能（大 $|G|$ 值）的平面波，即需要一个非常大、甚至在计算上不切实际的 $E_{\text{cut}}$ 值。

为了克服这一困难，同时保留[平面波](@entry_id:189798)的优势，研究者们发展了**赝势 (pseudopotential)** 方法。其核心思想是，[化学键](@entry_id:145092)合主要由价电子决定，而[内层电子](@entry_id:163897)及其[波函数](@entry_id:201714)的复杂形态在很大程度上保持不变。因此，我们可以用一个更平滑、更弱的[有效势](@entry_id:1124192)（赝势）来替代原子核的强[库仑势](@entry_id:154276)以及[内层电子](@entry_id:163897)的[屏蔽效应](@entry_id:136974)。这个赝势被精心设计，使其在一个截断半径 $r_c$ 之外与真实的全电子势产生的效果完全相同。

使用赝势计算得到的价电子[波函数](@entry_id:201714)被称为**赝[波函数](@entry_id:201714) (pseudo-wavefunction)**。由于赝势在核心区域是平滑的，赝[波函数](@entry_id:201714)也相应地变得平滑，不再具有尖点和快速振荡。更光滑的函数意味着其[傅里叶系数](@entry_id:144886)会以更快的速度衰减（例如 $|G|^{-4}$ 或更快），因此可以用一个相对较小的 $E_{\text{cut}}$ 值来精确描述，从而极大地降低了计算成本 。

现代计算中，**投影缀加波 (Projector Augmented-Wave, PAW)** 方法已成为主流，它被认为是[赝势方法](@entry_id:137874)在理论上更严谨和精确的推广 。PAW方法通过一个[线性变换](@entry_id:149133) $\mathcal{T}$，在形式上精确地将计算上易于处理的平滑赝[波函数](@entry_id:201714) $|\tilde{\Psi}_n\rangle$ 与真实的、包含所有振荡细节的全电子[波函数](@entry_id:201714) $|\Psi_n\rangle$ 联系起来：$|\Psi_n\rangle = \mathcal{T} |\tilde{\Psi}_n\rangle$。

这个变换在每个原子 $a$ 周围定义的“缀加球” (augmentation sphere) 之外是单位算符，而在球内则通过一组局域的原子中心基函数进行修正。[PAW方法](@entry_id:753811)的核心要素包括 ：
1.  **分波 (Partial waves)**：对于每个原子，预先计算一组数值化的全电子分波 $\{|\phi_i^a\rangle\}$ 和与之对应的平滑赝分波 $\{|\tilde{\phi}_i^a\rangle\}$。它们在缀加球半径 $r_c^a$ 外完全一致。
2.  **投影算符 (Projectors)**：构造一组局域化的[投影算符](@entry_id:154142) $\{|\tilde{p}_i^a\rangle\}$，它们与赝分波是双正交的，即 $\langle \tilde{p}_i^a | \tilde{\phi}_j^a \rangle = \delta_{ij}$。这使得我们可以将全局的平滑[波函数](@entry_id:201714)投影到每个原子中心的局域基上。
3.  **变换关系**：全电子[波函数](@entry_id:201714)可以通过平滑[波函数](@entry_id:201714)加上一个局域修正项来重构：
    $$ |\Psi_n\rangle = |\tilde{\Psi}_n\rangle + \sum_{a,i} \left( |\phi_i^a\rangle - |\tilde{\phi}_i^a\rangle \right) \langle \tilde{p}_i^a | \tilde{\Psi}_n \rangle $$
    这表明，全电子与赝[波函数](@entry_id:201714)之间的差异，由一组局域化的基函数 $|\phi_i^a\rangle - |\tilde{\phi}_i^a\rangle$ 展开，其展开系数由平滑[波函数](@entry_id:201714)与投影算符的交叠积分 $\langle \tilde{p}_i^a | \tilde{\Psi}_n \rangle$ 给出 。
4.  **补偿电荷 (Compensation charge)**：为了确保体系的静电势被正确描述，[PAW方法](@entry_id:753811)引入了补偿[电荷密度](@entry_id:144672) $\hat{n}(\mathbf{r})$。其构造要求是，平滑电荷密度与补偿[电荷密度](@entry_id:144672)之和所产生的静电势，在缀加球外部与真实的全电子[电荷密度](@entry_id:144672)产生的[静电势](@entry_id:188370)完全相同。这通过匹配两种[电荷分布](@entry_id:144400)在球内的所有[多极矩](@entry_id:191120)（直到某个高阶截断）来实现，从而保证了[长程静电相互作用](@entry_id:1127441)的精确性 。

在实际应用中，特别是对于催化表面这类低配位环境，缀加半径 $r_c^a$ 的选择至关重要。使用较小的 $r_c^a$ 可以让更多的成键区域被显式地作为全电子处理，从而提高PAW势的**可移植性 (transferability)** 和计算精度，但代价是需要更高的 $E_{\text{cut}}$。在表面吸附或重构过程中，原子间距可能比体相中更短，选择较小的 $r_c^a$ 也能有效避免缀加球之间发生不物理的重叠 。

### 实际实现与计算优势

#### 计算框架与正交性

在截断的[平面波基组](@entry_id:178287)中，[Kohn-Sham方程](@entry_id:143968)被转化为一个矩阵本征值问题。[平面波基](@entry_id:140187)函数 $\{e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}\}$ 的一个突出优点是它们是**正交的 (orthonormal)**。这意味着基函数之间的交叠矩阵 $S$ 是[单位矩阵](@entry_id:156724) $I$。因此，[Kohn-Sham方程](@entry_id:143968)的代数形式是一个标准的厄米[本征值问题](@entry_id:142153)：
$$ H \mathbf{c} = \epsilon \mathbf{c} $$
相比之下，使用非正交的局域[原子轨道基组](@entry_id:1121226)（如[高斯基组](@entry_id:198430)）会导致一个广义本征值问题 $H \mathbf{c} = \epsilon S \mathbf{c}$，其中交叠矩阵 $S$ 包含了基函数非正交的度量信息。标准本征值问题在数值求解上更为简单和稳定。例如，描述占据态子空间的投影算符 $P$ 在[正交基](@entry_id:264024)下满足[幂等性](@entry_id:190768) $P^2=P$，而在[非正交基](@entry_id:154908)下则满足更复杂的 $PSP=P$ 。

#### [快速傅里叶变换](@entry_id:143432)（FFT）的高效应用

平面波方法的计算效率在很大程度上得益于**[快速傅里叶变换](@entry_id:143432) (Fast Fourier Transform, FFT)** 的巧妙运用。哈密顿量中的[动能算符](@entry_id:265633)在[倒易空间](@entry_id:754151)（[平面波基](@entry_id:140187)矢表象下）是对角的，其[矩阵元](@entry_id:186505)就是平面波的动能。而局域的有效势（如哈特里势和交换关联势）则在实空间中是对角（点乘）的。

FFT允许我们在[实空间](@entry_id:754128)网格和倒易空间（[傅里叶系数](@entry_id:144886)）之间进行高效的切换，其计算复杂度约为 $O(N\log N)$，其中 $N$ 是网格点数。这使得我们可以在最适合的空间中执行不同的计算：在[倒易空间](@entry_id:754151)计算动能项，然后通过逆FFT变换到[实空间](@entry_id:754128)网格，在实[空间计算](@entry_id:905865)势能项的贡献，再通过FFT变换回[倒易空间](@entry_id:754151)，如此循环。

为了确保数值的精确性，[离散傅里叶变换](@entry_id:144032)的归一化约定必须与连续[傅里叶级数](@entry_id:139455)的定义相兼容。一种常见的约定是 ：
- **正向变换（实空间到[倒易空间](@entry_id:754151)）**：
  $$ \tilde{\rho}[\mathbf{k}] = \frac{1}{N} \sum_{\mathbf{n}} \rho[\mathbf{n}] \exp\left(-i 2\pi \left(\frac{k_x n_x}{N_x} + \frac{k_y n_y}{N_y} + \frac{k_z n_z}{N_z}\right)\right) $$
- **逆向变换（倒易空间到实空间）**：
  $$ \rho[\mathbf{n}] = \sum_{\mathbf{k}} \tilde{\rho}[\mathbf{k}] \exp\left(i 2\pi \left(\frac{k_x n_x}{N_x} + \frac{k_y n_y}{N_y} + \frac{k_z n_z}{N_z}\right)\right) $$
这里，$\rho[\mathbf{n}]$ 是[实空间](@entry_id:754128)格点上的函数值，$\tilde{\rho}[\mathbf{k}]$ 是其离散[傅里叶系数](@entry_id:144886)，N是总格点数。这个约定确保了离散系数 $\tilde{\rho}[\mathbf{k}]$ 直接对应于连续[傅里叶系数](@entry_id:144886)的[数值近似](@entry_id:161970)，并且逆变换可以直接恢复实空间格点值而无需额外的缩放因子。

#### [平面波基组](@entry_id:178287)的关键优势总结

综合来看，[平面波基组](@entry_id:178287)具有一系列使其在周期性体系计算中备受青睐的独特优势：
1.  **系统收敛性**：计算精度由单一参数 $E_{\text{cut}}$ 控制，通过增加该参数可以系统地、单调地提高计算结果的准确性。
2.  **无[普莱力](@entry_id:167194) (Pulay force)**：[平面波基](@entry_id:140187)函数的位置仅由计算盒子（超胞）的尺寸决定，与原子坐标无关。因此，在进行[结构优化](@entry_id:176910)时，基组不会随着原子的移动而改变，从而避免了因基函数对原子坐标的依赖性而产生的非物理力，即[普莱力](@entry_id:167194) 。这使得力的计算更为简洁和精确。
3.  **无[基组重叠误差](@entry_id:174681) (BSSE)**：在研究分子吸附或片段相互作用时，局域[原子基组](@entry_id:1121220)会引入一种称为**[基组重叠误差](@entry_id:174681) (Basis Set Superposition Error, BSSE)** 的人为误差。这是因为一个片段可以“借用”另一个片段的基函数来降低自身的能量。在[平面波计算](@entry_id:753473)中，只要所有能量（如复合物、孤立的吸附质和表面）都在完全相同的超胞和计算参数下进行，它们就共享完全相同的、与原子位置无关的基组。因此，不存在“借用”基函数的问题，BSSE 自然地被消除了 。
4.  **[无偏性](@entry_id:902438)**：基组均匀地分布在整个空间，对所有原子一视同仁，不偏向任何特定的原子位置或化学环境。这使得[平面波](@entry_id:189798)方法非常适合描述成键方式复杂多样的体系，如金属、催化剂表面和熔融盐。
5.  **高效的[预处理](@entry_id:141204)**：在求解本征值问题的[迭代算法](@entry_id:160288)中，可以使用非常高效的对角预处理器。由于[动能算符](@entry_id:265633)在[平面波基](@entry_id:140187)下是对角的，其逆矩阵（或近似逆）可以很容易地构造出来，极大地加速了收敛速度 。

### 具体体系与计算挑战的处理

#### [布里渊区积分](@entry_id:188454)与[对称性约化](@entry_id:199270)

对于晶体，总能量等物理量需要在整个[布里渊区](@entry_id:142395)（BZ）内对所有占据的电子态进行积分。在数值上，这个积分被一个在离散 $\mathbf{k}$ 点网格上的求和所替代，这个网格通常由 **Monkhorst-Pack** 方法生成。

计算成本与所选的 $\mathbf{k}$ 点数目成正比。幸运的是，我们可以利用晶体的空间对称性来大幅减少需要计算的 $\mathbf{k}$ 点数目。如果[哈密顿量](@entry_id:144286)在某个[点群](@entry_id:142456)操作 $S$ 下不变，那么能带结构也具有相应的对称性，即 $E_n(\mathbf{k}) = E_n(S\mathbf{k})$。这意味着所有通过[对称操作](@entry_id:143398)联系起来的 $\mathbf{k}$ 点（构成一个“轨道”或“星”）是等价的，我们只需在每个轨道中选取一个代表性的 $\mathbf{k}$ 点进行计算即可。这些代表性 $\mathbf{k}$ 点构成了**不可约布里渊区 (Irreducible Brillouin Zone, IBZ)**。

例如，对于一个具有 $p4mm$ 平面群（其[点群](@entry_id:142456)为 $D_4$）的二维正方表面，在一个 $8 \times 8$ 的 $\mathbf{k}$ 点网格上，总共有 $64$ 个点。$D_4$ 群包含 8 个[对称操作](@entry_id:143398)。通过使用**[伯恩赛德引理](@entry_id:146768) (Burnside's Lemma)** 或直接枚举，可以确定这 64 个点在 $D_4$ 群作用下分成了 15 个不等价的轨道。因此，我们只需在 IBZ 中计算 15 个 $\mathbf{k}$ 点，就能获得整个[布里渊区](@entry_id:142395)的信息，从而将计算量减少了约 $64/15 \approx 4$ 倍 。

#### 金属体系的处理：电子涂抹技术

在处理金属体系时，一个常见的挑战是[自洽场](@entry_id:136549)（SCF）迭代过程的收敛性问题。金属的特征是在[费米能](@entry_id:143977)级附近有连续的能态分布。在零温下，电子占据数在[费米能](@entry_id:143977)级处有一个急剧的阶跃（从1到0）。在SCF迭代中，势的微小变化可能导致大量[能级穿越](@entry_id:152596)[费米面](@entry_id:137798)，引起占据数的剧烈变化，进而导致电荷密度和势的大幅振荡（称为“电荷晃动”），阻碍收敛。

为了解决这个问题，通常采用**电子涂抹 (smearing)** 技术。这相当于在有限的[电子温度](@entry_id:180280) $T$ 下进行计算，此时电子的占据数由平滑的**费米-狄拉克分布**描述：
$$ f_{n\mathbf{k}}(T) = \left[1+\exp\left(\frac{\varepsilon_{n\mathbf{k}}-\mu}{k_{\mathrm{B}}T}\right)\right]^{-1} $$
这里 $\mu$ 是化学势。平滑的占据数函数使得电荷密度[对势](@entry_id:1135706)的响应变得连续和缓和，从而极大地稳定了SCF收敛 。

然而，这种方法引入了一个人为的温度，计算得到的变分量是电子自由能 $F(T) = E(T) - TS(T)$，而不是我们通常关心的零温内能 $E(0)$。为了得到物理上有意义的结果（如吸附能），必须消除这个涂抹效应。基于**[索末菲展开](@entry_id:149655) (Sommerfeld expansion)**，可以证明在低温极限下，内能 $E(T)$ 和自由能 $F(T)$ 与零温内能 $E(0)$ 的偏差都与 $T^2$ 成正比：
$$ E(T) = E(0) + A T^2 + O(T^4) $$
$$ F(T) = E(0) - A T^2 + O(T^4) $$
这为我们提供了一个精确的外推方案：
1.  在几个不同的、较小的涂抹温度 $T_i$ 下进行计算，得到相应的自由能 $F(T_i)$ 和熵 $S(T_i)$。
2.  计算出每个温度下的内能 $E(T_i) = F(T_i) + T_iS(T_i)$。
3.  绘制 $E(T_i)$ 关于 $T_i^2$ 的关系图。
4.  对这些数据点进行线性拟合。根据上述理论，这些点应落在一条直线上。
5.  该直线在 $T^2=0$ 处的截距，即为我们所求的、已修正的零温内能 $E(0)$ 。

通过这些原理和机制，[平面波基组](@entry_id:178287)为研究复杂周期性体系（如[催化表面](@entry_id:1122127)）的[电子结构](@entry_id:145158)和性质提供了一个强大、可靠且高效的计算平台。