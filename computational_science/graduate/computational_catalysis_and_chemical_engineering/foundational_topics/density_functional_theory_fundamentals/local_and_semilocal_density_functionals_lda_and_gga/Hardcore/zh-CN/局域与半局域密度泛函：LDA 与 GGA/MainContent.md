## 引言
在量子力学计算领域，[密度泛函理论](@entry_id:139027)（DFT）已成为探索物质电子结构不可或缺的工具。其成功的核心，也是其最大的挑战，在于对[交换相关泛函](@entry_id:142042) $E_{xc}[n]$ 的精确描述。由于其精确形式未知，我们必须依赖于近似。本文旨在深入剖析两类最基本且影响深远的近似：局域密度近似（LDA）和[广义梯度近似](@entry_id:274118)（GGA）。文章将系统性地解决一个核心问题：这些基础泛函是如何构建的，它们在实际应用中表现如何，以及它们的内在局限性是什么？通过阅读本文，读者将首先在“原理与机制”章节中掌握LDA和GGA的理论基础和构建逻辑。接着，在“应用与跨学科交叉”章节中，读者将看到这些理论如何应用于催化和材料科学，并了解其系统性偏差的来源。最后，“动手实践”部分将提供具体的练习，以加深对核心概念的理解。本介绍将引导您进入对这些[计算化学](@entry_id:143039)基石的深入探索。

## 原理与机制

在密度泛函理论（DFT）的 Kohn-Sham (KS) 框架中，一个多电子体系的总能量被精确地重写为几个部分的和。除了非相互作用体系的动能、电子与原子核的相互作用能以及电子密度与其自身的经典[静电排斥](@entry_id:162128)能（即[哈特里能量](@entry_id:167303)）之外，剩余的所有复杂的量子力学效应都被归入一个单一的项中：**[交换相关泛函](@entry_id:142042) (exchange-correlation functional)**，记为 $E_{xc}[n]$。这个泛函是 KS-DFT 理论的核心和难点，它的精确形式是未知的，因此必须对其进行近似。本章将深入探讨两类最基本且应用最广泛的近似泛函：**局域密度近似 (Local Density Approximation, LDA)** 和 **[广义梯度近似](@entry_id:274118) (Generalized Gradient Approximation, GGA)**。我们将从它们的[构造原理](@entry_id:141667)出发，揭示它们如何对电子间的交换与相关效应进行建模，并最终阐述它们在计算催化和[化学工程](@entry_id:143883)领域应用时固有的优势与局限性。

### 科恩-沈[交换相关泛函](@entry_id:142042)

在深入研究近似方法之前，我们必须首先精确地定义[交换相关能](@entry_id:138029)量 $E_{xc}[n]$ 及其在 KS 方程中的作用。对于一个总能量为 $E[n]$ 的真实相互作用电子体系，其动能为 $T[n]$，电子间[相互作用能](@entry_id:264333)为 $V_{ee}[n]$。KS 方法引入一个具有相同电子密度 $n(\mathbf{r})$ 的虚拟的非相互作用体系，其动能为 $T_s[n]$。总能量泛函可以分解为：

$E[n] = T_s[n] + E_H[n] + E_{ext}[n] + E_{xc}[n]$

其中 $E_H[n]$ 是[哈特里能量](@entry_id:167303)，即电子密度的经典库仑自排斥能，$E_{ext}[n]$ 是外势能。通过与真实体系的能量表达式对比，我们可以得到 $E_{xc}[n]$ 的严格定义：

$E_{xc}[n] = (T[n] - T_s[n]) + (V_{ee}[n] - E_H[n])$

这一定义揭示了 $E_{xc}[n]$ 的双重来源 。第一部分 $(T[n] - T_s[n])$ 是真实相互作用体系与非相互作用参考体系之间的**动能差**，通常被称为动能相关部分。第二部分 $(V_{ee}[n] - E_H[n])$ 代表了**非经典的[电子-电子相互作用](@entry_id:139900)**，它包含了源于[泡利不相容原理](@entry_id:141850)的**交换效应 (exchange)** 和超出平均场描述的电子**相关运动 (correlation)**。因此，$E_{xc}[n]$ 是一个包含了量子力学效应的复杂项。

为了最小化总能量，我们求解一组单粒子薛定谔方程，即 KS 方程：

$\left( -\frac{\hbar^2}{2m} \nabla^2 + v_s(\mathbf{r}) \right) \phi_i(\mathbf{r}) = \epsilon_i \phi_i(\mathbf{r})$

这里的有效势 $v_s(\mathbf{r})$ 是产生正确基态密度的势场。它由外势 $v_{ext}(\mathbf{r})$、哈特里势 $v_H(\mathbf{r})$ 和[交换相关势](@entry_id:180254) $v_{xc}(\mathbf{r})$ 构成。**[交换相关势](@entry_id:180254) (exchange-correlation potential)** $v_{xc}(\mathbf{r})$ 定义为[交换相关能](@entry_id:138029)对电子密度的**泛函导数**：

$v_{xc}(\mathbf{r}) = \frac{\delta E_{xc}[n]}{\delta n(\mathbf{r})}$

这个势是一个局域的乘法势，它将复杂的量子多体效应以一种平均场的方式引入到单粒子方程中。理解 $E_{xc}[n]$（一个标量，代表能量贡献）和 $v_{xc}(\mathbf{r})$（一个空间函数，代表[有效势](@entry_id:1124192)）之间的区别至关重要，因为我们所有的近似都必须为这两者提供具体的数学形式 。

### 局域密度近似 (LDA)：基于[均匀电子气](@entry_id:195006)的模型

最简单、也是最具奠基意义的近似方法是**局域密度近似 (Local Density Approximation, LDA)**。LDA 的核心思想极为简洁：它假设在一个真实、密度不均匀的体系中，空间中每一点 $\mathbf{r}$ 的[交换相关能](@entry_id:138029)量密度，可以近似为密度等于该点局域密度 $n(\mathbf{r})$ 的**[均匀电子气](@entry_id:195006) (Uniform Electron Gas, UEG)** 的[交换相关能](@entry_id:138029)量密度。

#### [均匀电子气](@entry_id:195006)模型

[均匀电子气](@entry_id:195006)（也称为“电子 jellium”）是一个理想化的模型系统，它由大量相互作用的电子均匀分布在一个体积中，并由一个均匀的正电荷背景来中和，以保证整个系统呈[电中性](@entry_id:138647) 。由于其完美的平移对称性，KS 轨道是[平面波](@entry_id:189798)，体系的性质完全由其恒定的电子密度 $n$ 决定。在 UEG 模型中，[交换相关能](@entry_id:138029)的两个分量——交换能和[相关能](@entry_id:144432)——可以被精确计算或高精度地模拟。

LDA 泛函的数学形式如下：

$E_{xc}^{\mathrm{LDA}}[n] = \int n(\mathbf{r}) \varepsilon_{xc}^{\mathrm{unif}}(n(\mathbf{r})) d\mathbf{r}$

其中 $\varepsilon_{xc}^{\mathrm{unif}}(n)$ 是[均匀电子气](@entry_id:195006)中每个电子的[交换相关能](@entry_id:138029)，它是密度 $n$ 的函数。根据其构造，LDA 对于密度恒定的体系是精确的。对于密度缓慢变化的体系，可以将真实的 $E_{xc}[n]$ 按梯度的幂次进行展开，而 LDA 正是这个梯度展开的零阶项。因此，[LDA](@entry_id:138982) 在密度变化非常平缓的极限下是渐近准确的 。

#### LDA 的[参数化](@entry_id:265163)

[LDA](@entry_id:138982) 泛函的实际应用依赖于对 $\varepsilon_{xc}^{\mathrm{unif}}(n)$ 的精确了解。它通常被分为交换和相关两个部分：$\varepsilon_{xc}^{\mathrm{unif}} = \varepsilon_x^{\mathrm{unif}} + \varepsilon_c^{\mathrm{unif}}$。

**交换部分**：对于 UEG，交换能部分 $\varepsilon_x^{\mathrm{unif}}$ 有一个解析表达式，即 Dirac 公式，它表明交换能与密度的 $1/3$ 次方成正比：$\varepsilon_x^{\mathrm{unif}}(n) \propto n^{1/3}$。

**相关部分**：[相关能](@entry_id:144432)部分 $\varepsilon_c^{\mathrm{unif}}$ 的形式要复杂得多，没有简单的解析解。它的值是通过高精度的**[量子蒙特卡洛](@entry_id:144383) (Quantum Monte Carlo, QMC)** 模拟（由 Ceperley 和 Alder 完成）得到的。这些 QMC 计算为一系列离散的密度值提供了近乎“精确”的[相关能](@entry_id:144432)数据 。为了在 DFT 计算中使用，研究者们需要将这些离散的数据点拟合成一个连续的[解析函数](@entry_id:139584)。这个过程被称为**[参数化](@entry_id:265163) (parameterization)**。

在[参数化](@entry_id:265163)过程中，通常使用**[维格纳-赛兹半径](@entry_id:139918) (Wigner-Seitz radius)** $r_s = (3/(4\pi n))^{1/3}$ 作为密度的无量纲替代变量。$r_s$ 直观地表示了平均每个电子所占据的球形空间的半径。一个成功的[参数化](@entry_id:265163)方案（如 Vosko-Wilk-Nusair (VWN) 或 Perdew-Zunger (PZ81)）不仅要精确拟合 QMC 数据点，还必须满足已知的物理约束 ：
1.  **高密度极限 ($r_s \to 0$)**：[相关能](@entry_id:144432)必须重现由[多体微扰理论](@entry_id:168555)推导出的对数形式 $\varepsilon_c(r_s) \approx A \ln(r_s) + B$。
2.  **低密度极限 ($r_s \to \infty$)**：电子趋向于形成维格纳[晶格](@entry_id:148274)，[相关能](@entry_id:144432)具有 $C/r_s$ 的[渐近行为](@entry_id:160836)。

#### [自旋极化](@entry_id:164038)：局域[自旋密度](@entry_id:267742)近似 (LSDA)

在催化等领域，体系常常具有不为零的净自旋，即自旋极化。为了处理这种情况，[LDA](@entry_id:138982) 被推广为**局域[自旋密度](@entry_id:267742)近似 (Local Spin Density Approximation, LSDA)**。在 LSDA 中，能量密度不仅依赖于总密度 $n(\mathbf{r})$，还依赖于**局域自旋极化率** $\zeta(\mathbf{r}) = (n_\uparrow(\mathbf{r}) - n_\downarrow(\mathbf{r}))/n(\mathbf{r})$。

$\varepsilon_c^{\mathrm{unif}}$ 的[参数化](@entry_id:265163)现在需要对 $\zeta$ 有所依赖，即 $\varepsilon_c(r_s, \zeta)$。QMC 数据通常只在两个极限情况下可用：非极化（顺磁，$\zeta=0$）和完全极化（铁磁，$\zeta=1$）。为了处理任意的 $\zeta$ 值，需要一个**自旋内插 (spin interpolation)** 公式。这个内插函数不是随意的，它必须满足严格的物理约束 ：
-   **对称性**：由于交换自旋上和自旋下的标签不会改变物理，$\varepsilon_c(r_s, \zeta)$ 必须是 $\zeta$ 的[偶函数](@entry_id:163605)，即 $\varepsilon_c(r_s, \zeta) = \varepsilon_c(r_s, -\zeta)$。
-   **零点斜率**：作为[偶函数](@entry_id:163605)的直接推论，$\varepsilon_c$ 在 $\zeta=0$ 处的导数必须为零：$\partial \varepsilon_c / \partial \zeta |_{\zeta=0} = 0$。
-   **[自旋刚度](@entry_id:141189)**：$\varepsilon_c$ 在 $\zeta=0$ 处的二阶导数，即**[自旋刚度](@entry_id:141189) (spin stiffness)**，是一个有确定理论值的物理量，精确的内插函数应该能重现它。

这些约束保证了 LSDA 泛函在描述磁性体系时具有正确的物理行为。

### [广义梯度近似 (GGA)](@entry_id:140295)：感知密度的变化

尽管 [LDA](@entry_id:138982) 在描述近乎均匀的体系（如简单金属）方面取得了成功，但它对于原子、分子和表面等密度变化剧烈的体系则表现不佳。其根本原因在于 LDA 的“局域”本性：它只关心一点上的密度值，而忽略了该点周围密度的变化情况。

为了改进这一点，**[广义梯度近似](@entry_id:274118) (Generalized Gradient Approximation, GGA)** 被提出。GGA 是一种**半局域 (semilocal)** 泛函，它不仅包含局域密度 $n(\mathbf{r})$ 的信息，还引入了密度梯度 $\nabla n(\mathbf{r})$ 的信息 。通过感知密度的变化率，GGA 能够更好地区分不同的化学环境。

GGA 泛函的一般形式为：

$E_{xc}^{\mathrm{GGA}}[n] = \int f(n(\mathbf{r}), \nabla n(\mathbf{r})) d\mathbf{r}$

在实际构造中，通常引入一个无量纲的**简约密度梯度 (reduced density gradient)** $s$：

$s(\mathbf{r}) = \frac{|\nabla n(\mathbf{r})|}{2 k_F(\mathbf{r}) n(\mathbf{r})}$

其中 $k_F = (3\pi^2 n)^{1/3}$ 是与局域密度相关联的[费米波矢](@entry_id:140713)。这个变量 $s$ 衡量了密度变化的快慢。GGA 的[交换能](@entry_id:137069)部分通常写成 LDA [交换能](@entry_id:137069)乘以一个**增强因子 (enhancement factor)** $F_x(s)$ 的形式：

$E_x^{\mathrm{GGA}}[n] = \int \varepsilon_x^{\mathrm{LDA}}(n(\mathbf{r})) F_x(s(\mathbf{r})) d\mathbf{r}$

当密度均匀时，$|\nabla n|=0$，$s=0$，如果要求 $F_x(0)=1$，则 GGA 能够自然地退化到 LDA 的正确极限。

#### GGA 的非经验性构造：以 PBE 为例

与早期一些依赖于经验拟合的 GGA 不同，现代 GGA 泛函（如 Perdew-Burke-Ernzerhof, PBE）是**非经验性 (non-empirical)** 的，它们的参数完全由满足一系列已知的物理精确约束来确定。理解这些约束是掌握现代 DFT 核心思想的关键。

一个关键的理论工具是**[交换相关空穴](@entry_id:140213) (exchange-correlation hole)** $h_{xc}(\mathbf{r}, \mathbf{r}')$，它描述了在 $\mathbf{r}$ 处存在一个电子的条件下，在 $\mathbf{r}'$ 处找到另一个电子的概率的减少量。[交换空穴](@entry_id:148904) $h_x$ 来自泡利不相容原理，它满足一个严格的**求和规则 (sum rule)** ：

$\int n(\mathbf{r}') h_x(\mathbf{r}, \mathbf{r}') d\mathbf{r}' = -1$

这个规则表明，每个电子周围都恰好“排开”了另外一个电子的电量。这个求和规则是构造可靠交换泛函的基石。对于相关空穴 $h_c$，其积分为零，意味着相关效应只是重新分布电子，而不改变总的粒子数。

PBE 泛函的构造正是基于满足这类精确约束 ：
1.  **均匀气体极限**：在 $s \to 0$ 时，PBE 必须重现 [LDA](@entry_id:138982) 的结果。
2.  **[线性响应](@entry_id:146180)**：PBE 并不严格满足[交换能](@entry_id:137069)的二阶梯度展开，而是选择满足一个更重要的物理约束：使整个[交换相关泛函](@entry_id:142042)正确地重现[均匀电子气](@entry_id:195006)的**[线性响应](@entry_id:146180)**。这一约束将交换部分的梯度修正系数 $\mu$ 与相关部分的梯度修正系数 $\beta$ 联系起来，即 $\mu = (\pi^2/3)\beta \approx 0.2195$。这体现了交换和相关效应之间深刻的内在联系。
3.  **Lieb-Oxford 界**：这是一个严格的数学下界，规定了任何体系的[交换相关能](@entry_id:138029) $E_{xc}$ 不能低于某个值。PBE 通过控制其增强因子 $F_x(s)$ 在大梯度 ($s \to \infty$) 时的行为来严格满足这个界限。在考虑[自旋极化](@entry_id:164038)后，这一约束确定了 PBE 泛函的另一个关键参数 $\kappa \approx 0.804$。

通过这种非经验性的方式，PBE 成为了一个普适、稳健且预测能力强的泛函，在计算催化领域得到了极其广泛的应用。

### 局域与半局域泛函的固有局限性

尽管 LDA 和 GGA 在许多应用中取得了巨大成功，但它们的（半）局域本性也带来了几个根本性的、无法克服的缺陷。对于计算催化和化学工程的研究者来说，深刻理解这些局限性与理解它们的优势同等重要。

#### 局限性一：[自相互作用误差](@entry_id:260813) (SIE)

在 DFT 中，一个电子不应与自身相互作用。在精确的理论中，[哈特里能量](@entry_id:167303)中包含的非物理的电子[自相互作用](@entry_id:201333)部分，被交换能量精确地抵消了。然而，在 LDA 和 GGA 中，这种抵消是不完全的。这种残留的、虚假的自排斥被称为**[自相互作用误差](@entry_id:260813) (Self-Interaction Error, SIE)** 。

SIE 的一个主要后果是它会人为地偏爱**电子的[离域](@entry_id:183327)化 (delocalization)**。一个被 SIE “污染”的电子会感受到一个虚假的自身[排斥势](@entry_id:185622)，为了降低能量，它会倾向于将自己的[波函数](@entry_id:201714)“摊开”到更广阔的空间中。这种离域化倾向导致了对 $E(N)$（能量-电子数）曲线的错误描述。精确的 $E(N)$ 曲线在整数电子数之间应为一系列直线段，这禁止了孤立体系出现分数电荷。而 [LDA](@entry_id:138982)/GGA 得到的 $E(N)$ 曲线是**凸的**，这意味着分数电荷的体系能量被人为地降低了。

在[催化表面](@entry_id:1122127)吸附的研究中，SIE 导致了灾难性的后果。当一个分子吸附在金属表面时，[LDA](@entry_id:138982)/GGA 会预测出过度的、非物理性的**分数电荷转移**。这种虚假的电荷转移会带来额外的人为能量降低，使得计算出的吸附体系过于稳定。因此，[LDA](@entry_id:138982) 和 GGA 普遍存在对[化学吸附](@entry_id:149998)物种（特别是涉及[电荷转移](@entry_id:155270)的）的**过度吸附 (overbinding)** 问题，即预测的吸附能通常比实验值更负 。

#### 局限性二：无法描述长程范德华作用

**范德华 (van der Waals, vdW) 相互作用**，或称色散力，起源于[瞬时偶极](@entry_id:139165)矩之间的长程[电动力学](@entry_id:158759)关联。这是一个根本上的**非局域 (nonlocal)** 效应，它的能量依赖于空间中两个不同区域的[电子密度涨落](@entry_id:748910)。

而 LDA 和 GGA 的数学形式是（半）局域的。它们的能量密度在 $\mathbf{r}$ 点只依赖于该点及其无限小邻域内的信息。考虑两个在空间上分离、电子云没有重叠的分子 A 和 B。对于这样一个体系，总的[交换相关能](@entry_id:138029)可以严格地写为：

$E_{xc}^{\mathrm{sl}}[n_A + n_B] = \int \varepsilon_{xc}(n_A(\mathbf{r})+n_B(\mathbf{r}), \dots) d\mathbf{r} = \int_{A} \varepsilon_{xc}(n_A, \dots) d\mathbf{r} + \int_{B} \varepsilon_{xc}(n_B, \dots) d\mathbf{r} = E_{xc}^{\mathrm{sl}}[n_A] + E_{xc}^{\mathrm{sl}}[n_B]$

这意味着，体系的总能量等于两个孤立[分子能量](@entry_id:190933)之和，[相互作用能](@entry_id:264333)为零 。因此，[LDA](@entry_id:138982) 和 GGA 在数学上就无法描述长程 vdW 相互作用，其能量随距离衰减的行为（如 $-C_6/R^6$）完全丢失。

这对**[物理吸附](@entry_id:153189)**的研究是致命的，因为[物理吸附](@entry_id:153189)的主导作用力正是 vdW 力。使用标准的 LDA 和 GGA 计算[物理吸附](@entry_id:153189)体系，通常会得到严重**欠约束 (underbinding)** 的结果，甚至根本无法形成稳定的吸附态。因此，在处理这类问题时，必须采用专门的 vdW 校正方法（如 [DFT-D](@entry_id:172133)、[vdW-DF](@entry_id:203596) 等）。

#### 局限性三：[带隙问题](@entry_id:143831)与[导数不连续性](@entry_id:136336)

对于半导体和绝缘体，其**基本[带隙](@entry_id:138445) (fundamental band gap)** $E_g$ 定义为[电离能](@entry_id:136678) $I$ 和[电子亲和能](@entry_id:147520) $A$ 之差：$E_g = I - A$。在精确的 KS 理论中，这个[带隙](@entry_id:138445)由 KS 轨道本征值[能隙](@entry_id:138445) $\Delta_{KS}$ 和一个称为**[导数不连续性](@entry_id:136336) (derivative discontinuity)** 的项 $\Delta_{xc}$ 组成：$E_g = \Delta_{KS} + \Delta_{xc}$。

[导数不连续性](@entry_id:136336)来源于[交换相关势](@entry_id:180254) $v_{xc}(\mathbf{r})$ 在体系总电子数 $N$ 穿过整数时的突变。这种突变是精确泛函的一个内在属性。然而，[LDA](@entry_id:138982) 和 GGA 的 $v_{xc}(\mathbf{r})$ 是通过对一个关于 $n$ 和 $\nabla n$ 的[光滑函数](@entry_id:267124)的求导得到的。当电子数 $N$ 发生微小变化时，$n(\mathbf{r})$ 和 $\nabla n(\mathbf{r})$ 也随之平滑变化，因此 $v_{xc}(\mathbf{r})$ 也是连续变化的，不会出现突变 。

因此，对于所有标准的 LDA 和 GGA 泛函，$\Delta_{xc} \approx 0$。这意味着它们预测的[带隙](@entry_id:138445)约等于 KS [能隙](@entry_id:138445)，而后者通常远小于实验测得的基本[带隙](@entry_id:138445)。这就是著名的“**DFT [带隙问题](@entry_id:143831)**”：LDA 和 GGA 会系统性地、严重地**低估**半导体和绝缘体的[带隙](@entry_id:138445)。这对于研究作为催化剂的金属氧化物或硫化物等[材料的电子性质](@entry_id:269415)是一个巨大的挑战。

### 展望：通往更高精度的阶梯

为了克服 GGA 的局限性，研究者们在所谓的“[雅各布天梯](@entry_id:139901)”上攀登，发展了更高级的泛函。紧随 GGA 之后的是**[meta-GGA](@entry_id:191648)**。

Meta-GGA 泛函在 $n$ 和 $\nabla n$ 的基础上，引入了第三个局域信息：**非相互作用动能密度 (kinetic energy density)** $\tau(\mathbf{r})$：

$\tau(\mathbf{r}) = \frac{1}{2} \sum_i^{\mathrm{occ}} |\nabla \phi_i(\mathbf{r})|^2$

需要强调的是，尽管 $\tau$ 是通过 KS 轨道计算得出的（这使得 [meta-GGA](@entry_id:191648) 成为隐式的轨道依赖泛函），但它在能量密度表达式中仅以其在局域点 $\mathbf{r}$ 的值出现。因此，[meta-GGA](@entry_id:191648) 仍然是一种**半局域**泛函 。

$\tau$ 的引入提供了关于局域成键环境的更丰富信息。例如，通过构造一个由 $\tau$ 和其他参考动能密度（如 UEG 的 $\tau_{unif}$ 和 von Weizsäcker 动能密度 $\tau_W$）组成的无量纲指标，[meta-GGA](@entry_id:191648) 可以有效地区分单轨道区域（如分子尾部的真空区）、[共价键](@entry_id:146178)区域和金属区域 。这种增强的识别能力使得 [meta-GGA](@entry_id:191648) 在描述[化学键断裂](@entry_id:276545)、[反应能](@entry_id:143747)垒以及区分不同类型的化学相互作用方面，通常比 GGA 更为准确，为解决 GGA 的一些固有问题提供了新的途径。