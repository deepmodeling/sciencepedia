{
    "hands_on_practices": [
        {
            "introduction": "Mastering the derivation of the Langmuir isotherm is a foundational skill in surface science. This exercise starts from first principles, equating the rates of adsorption and desorption at dynamic equilibrium to derive the relationship between gas pressure $p$ and fractional surface coverage $\\theta$. By working through this problem , you will build the bedrock model for adsorption on an ideal surface, which serves as the reference for all more advanced isotherms.",
            "id": "3867955",
            "problem": "A gas-phase adsorbate $A$ interacts with a catalytically active surface comprised of a large number of identical and non-interacting sites at temperature $T$. Assume monolayer adsorption, negligible lateral interactions, and ideal gas behavior. Let the fractional surface coverage be $\\theta$, so that site conservation implies $\\theta + \\theta_{\\mathrm{vac}} = 1$, where $\\theta_{\\mathrm{vac}}$ is the fraction of vacant sites. Under isothermal and isobaric conditions, model adsorption and desorption as elementary steps with mass-action kinetics:\n- Adsorption rate: $r_{\\mathrm{ads}} = k_{\\mathrm{ads}}\\,p\\,(1-\\theta)$.\n- Desorption rate: $r_{\\mathrm{des}} = k_{\\mathrm{des}}\\,\\theta$.\nHere, $p$ is the gas-phase pressure of $A$, and $k_{\\mathrm{ads}}$ and $k_{\\mathrm{des}}$ are temperature-dependent rate coefficients. Define the adsorption equilibrium constant $K \\equiv k_{\\mathrm{ads}}/k_{\\mathrm{des}}$, which has units of $\\mathrm{bar^{-1}}$ when pressure is measured in $\\mathrm{bar}$.\n\nStarting from the principle of dynamic equilibrium $r_{\\mathrm{ads}} = r_{\\mathrm{des}}$ and the site conservation relationship, derive an expression for the fractional coverage $\\theta$ as a function of $p$ and $K$. Then, using $K = 0.2\\,\\mathrm{bar^{-1}}$, evaluate $\\theta$ at $p = 0.1\\,\\mathrm{bar}$, $p = 1\\,\\mathrm{bar}$, and $p = 10\\,\\mathrm{bar}$. Also determine the half-coverage pressure $p_{1/2}$ defined by $\\theta(p_{1/2}) = \\tfrac{1}{2}$.\n\nComment on the saturation behavior as $p$ increases based on your derived expression and the computed values. Report your final numerical results as the tuple $\\big(\\theta(0.1\\,\\mathrm{bar}),\\,\\theta(1\\,\\mathrm{bar}),\\,\\theta(10\\,\\mathrm{bar}),\\,p_{1/2}\\big)$. Express $\\theta$ values as exact fractions if possible; if you choose decimals, round to four significant figures. Express $p_{1/2}$ in $\\mathrm{bar}$.",
            "solution": "The problem will be validated by first extracting all given information and then checking it against criteria for scientific soundness and well-posedness.\n\n**Step 1: Extracted Givens**\n- Adsorbate: $A$ (gas-phase) on a catalytic surface.\n- Surface properties: A large number of identical and non-interacting sites.\n- Assumptions: Monolayer adsorption, negligible lateral interactions, ideal gas behavior.\n- Conditions: Isothermal (constant temperature $T$) and isobaric (constant pressure $p$).\n- Fractional surface coverage: $\\theta$.\n- Fraction of vacant sites: $\\theta_{\\mathrm{vac}}$.\n- Site conservation: $\\theta + \\theta_{\\mathrm{vac}} = 1$.\n- Adsorption rate: $r_{\\mathrm{ads}} = k_{\\mathrm{ads}}\\,p\\,(1-\\theta)$.\n- Desorption rate: $r_{\\mathrm{des}} = k_{\\mathrm{des}}\\,\\theta$.\n- Rate coefficients: $k_{\\mathrm{ads}}$, $k_{\\mathrm{des}}$.\n- Adsorption equilibrium constant: $K \\equiv k_{\\mathrm{ads}}/k_{\\mathrm{des}}$, with units of $\\mathrm{bar^{-1}}$.\n- Equilibrium condition: $r_{\\mathrm{ads}} = r_{\\mathrm{des}}$.\n- Numerical value of equilibrium constant: $K = 0.2\\,\\mathrm{bar^{-1}}$.\n- Pressures for evaluation: $p = 0.1\\,\\mathrm{bar}$, $p = 1\\,\\mathrm{bar}$, and $p = 10\\,\\mathrm{bar}$.\n- Half-coverage pressure definition: $\\theta(p_{1/2}) = \\tfrac{1}{2}$.\n- Required output: An expression for $\\theta(p, K)$, its numerical values at the given pressures, the value of $p_{1/2}$, a comment on saturation behavior, and a final tuple of results.\n\n**Step 2: Validation of Givens**\nThe problem is scientifically grounded. It describes the Langmuir adsorption model, a cornerstone of surface science and heterogeneous catalysis. The rate expressions for adsorption and desorption are based on the law of mass action, a fundamental principle of chemical kinetics. The adsorption rate is proportional to the partial pressure of the adsorbate $p$ and the fraction of available vacant sites $(1-\\theta)$, while the desorption rate is proportional to the fraction of occupied sites $\\theta$. All assumptions (monolayer adsorption, identical sites, no lateral interactions) are the standard idealizations for the elementary Langmuir model. The problem is well-posed, providing all necessary definitions, relationships, and numerical values to derive the requested quantities. The setup is internally consistent and objective. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Adsorption Isotherm**\nThe derivation begins with the principle of dynamic equilibrium, where the rate of adsorption equals the rate of desorption.\n$$\nr_{\\mathrm{ads}} = r_{\\mathrm{des}}\n$$\nSubstituting the given rate expressions:\n$$\nk_{\\mathrm{ads}}\\,p\\,(1-\\theta) = k_{\\mathrm{des}}\\,\\theta\n$$\nOur goal is to solve this equation for the fractional coverage $\\theta$. We expand the left-hand side:\n$$\nk_{\\mathrm{ads}}\\,p - k_{\\mathrm{ads}}\\,p\\,\\theta = k_{\\mathrm{des}}\\,\\theta\n$$\nNext, we rearrange the equation to group all terms containing $\\theta$ on one side:\n$$\nk_{\\mathrm{ads}}\\,p = k_{\\mathrm{des}}\\,\\theta + k_{\\mathrm{ads}}\\,p\\,\\theta\n$$\nFactoring out $\\theta$ from the right-hand side gives:\n$$\nk_{\\mathrm{ads}}\\,p = \\theta (k_{\\mathrm{des}} + k_{\\mathrm{ads}}\\,p)\n$$\nIsolating $\\theta$ yields:\n$$\n\\theta = \\frac{k_{\\mathrm{ads}}\\,p}{k_{\\mathrm{des}} + k_{\\mathrm{ads}}\\,p}\n$$\nTo express this in terms of the equilibrium constant $K \\equiv k_{\\mathrm{ads}}/k_{\\mathrm{des}}$, we divide both the numerator and the denominator by the desorption rate coefficient $k_{\\mathrm{des}}$:\n$$\n\\theta = \\frac{\\frac{k_{\\mathrm{ads}}}{k_{\\mathrm{des}}}\\,p}{\\frac{k_{\\mathrm{des}}}{k_{\\mathrm{des}}} + \\frac{k_{\\mathrm{ads}}}{k_{\\mathrm{des}}}\\,p}\n$$\nSubstituting $K$ for $k_{\\mathrm{ads}}/k_{\\mathrm{des}}$ and simplifying, we arrive at the Langmuir adsorption isotherm:\n$$\n\\theta(p, K) = \\frac{K\\,p}{1 + K\\,p}\n$$\n\n**Evaluation of Fractional Coverage $\\theta$**\nWe are given $K = 0.2\\,\\mathrm{bar^{-1}}$. We now evaluate $\\theta$ for the specified pressures.\n\n1.  At $p = 0.1\\,\\mathrm{bar}$:\n    $$\n    \\theta(0.1) = \\frac{(0.2)(0.1)}{1 + (0.2)(0.1)} = \\frac{0.02}{1 + 0.02} = \\frac{0.02}{1.02} = \\frac{2}{102} = \\frac{1}{51}\n    $$\n2.  At $p = 1\\,\\mathrm{bar}$:\n    $$\n    \\theta(1) = \\frac{(0.2)(1)}{1 + (0.2)(1)} = \\frac{0.2}{1 + 0.2} = \\frac{0.2}{1.2} = \\frac{2}{12} = \\frac{1}{6}\n    $$\n3.  At $p = 10\\,\\mathrm{bar}$:\n    $$\n    \\theta(10) = \\frac{(0.2)(10)}{1 + (0.2)(10)} = \\frac{2}{1 + 2} = \\frac{2}{3}\n    $$\n\n**Determination of the Half-Coverage Pressure $p_{1/2}$**\nThe half-coverage pressure $p_{1/2}$ is defined as the pressure at which $\\theta = \\frac{1}{2}$. We use the derived isotherm expression:\n$$\n\\frac{1}{2} = \\frac{K\\,p_{1/2}}{1 + K\\,p_{1/2}}\n$$\nMultiplying both sides by $2(1 + K\\,p_{1/2})$ gives:\n$$\n1 + K\\,p_{1/2} = 2\\,K\\,p_{1/2}\n$$\nSubtracting $K\\,p_{1/2}$ from both sides yields:\n$$\n1 = K\\,p_{1/2}\n$$\nSolving for $p_{1/2}$ gives a general relationship:\n$$\np_{1/2} = \\frac{1}{K}\n$$\nUsing the given value $K = 0.2\\,\\mathrm{bar^{-1}}$:\n$$\np_{1/2} = \\frac{1}{0.2\\,\\mathrm{bar^{-1}}} = 5\\,\\mathrm{bar}\n$$\n\n**Comment on Saturation Behavior**\nThe derived expression for fractional coverage is $\\theta = \\frac{K\\,p}{1 + K\\,p}$. To analyze the behavior as pressure $p$ increases, we examine the limit of $\\theta$ as $p \\rightarrow \\infty$:\n$$\n\\lim_{p \\to \\infty} \\theta(p) = \\lim_{p \\to \\infty} \\frac{K\\,p}{1 + K\\,p}\n$$\nDividing the numerator and denominator by $p$:\n$$\n\\lim_{p \\to \\infty} \\frac{K}{\\frac{1}{p} + K} = \\frac{K}{0 + K} = 1\n$$\nThis limit shows that as the pressure becomes very large, the fractional coverage $\\theta$ approaches $1$. This corresponds to a state of saturation, where nearly all available adsorption sites on the surface are occupied. The computed values are consistent with this behavior: as $p$ increases from $0.1\\,\\mathrm{bar}$ to $1\\,\\mathrm{bar}$ to $10\\,\\mathrm{bar}$, $\\theta$ increases from $\\frac{1}{51}$ (approximately $0.02$) to $\\frac{1}{6}$ (approximately $0.167$) to $\\frac{2}{3}$ (approximately $0.667$), progressively approaching saturation.\n\nThe final numerical results for the tuple $\\big(\\theta(0.1\\,\\mathrm{bar}),\\,\\theta(1\\,\\mathrm{bar}),\\,\\theta(10\\,\\mathrm{bar}),\\,p_{1/2}\\big)$ are $(\\frac{1}{51}, \\frac{1}{6}, \\frac{2}{3}, 5\\,\\mathrm{bar})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{51}  \\frac{1}{6}  \\frac{2}{3}  5 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Real-world surfaces often defy the ideal assumptions of the Langmuir model, primarily due to interactions between adsorbed molecules. This practice introduces the Frumkin isotherm, which accounts for these lateral interactions through a mean-field energy term $w$. By starting from the equality of chemical potentials for the gas and adsorbed phases, you will derive and numerically solve the implicit equation for coverage $\\theta$ , gaining insight into how attractive ($w \\lt 0$) or repulsive ($w \\gt 0$) forces affect adsorption behavior.",
            "id": "3867892",
            "problem": "Consider a thermally equilibrated ideal gas adsorbing on a rigid, uniform lattice of catalytic sites where each site can be either vacant or occupied by a single adsorbate. Assume a mean-field approximation for lateral interactions among adsorbates on neighboring sites, and let the homogeneous lateral interaction energy per adsorbate be given by $w$ (negative values correspond to net attractive interactions and positive values correspond to net repulsive interactions). The equilibrium surface coverage is defined as the fractional occupancy $0  \\theta  1$.\n\nUse the following fundamental base to derive a scalar nonlinear equation in $\\,\\theta\\,$ that must be satisfied at equilibrium:\n\n- Equality of chemical potentials at equilibrium: $\\,\\mu_{\\mathrm{ads}}(\\theta, T) = \\mu_{\\mathrm{gas}}(p, T)\\,$.\n- Ideal gas chemical potential: $\\,\\mu_{\\mathrm{gas}}(p,T) = \\mu_{\\mathrm{gas}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\\,$, where $R$ is the universal gas constant and $p^{0}$ is a reference pressure.\n- Mean-field lattice adsorbate chemical potential composed of a configurational entropy term and a lateral interaction term: $\\,\\mu_{\\mathrm{ads}}(\\theta,T) = \\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta\\,$.\n\nDefine the equilibrium constant $K$ (with units of inverse pressure) via the standard-state relation $\\,K \\equiv \\dfrac{1}{p^{0}} \\exp\\!\\left(\\dfrac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T}\\right)\\,$ so that the derived equation involves the model parameters $K$, $w$, $T$, $p$, and the scalar unknown $\\,\\theta\\,$. You must not use any pre-memorized adsorption isotherms; instead, derive the equation for $\\,\\theta\\,$ from the stated base.\n\nThen, write a program to solve the derived scalar nonlinear equation numerically for $\\,\\theta\\,$ for each parameter set in the test suite below. Each solution $\\,\\theta\\,$ must be returned as a real number in the open interval $\\,\\left(0,1\\right)\\,$ and expressed as a decimal fraction rounded to six decimal places. Use $\\,R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$ and convert $\\,w\\,$ from $\\mathrm{kJ\\,mol^{-1}}$ to $\\mathrm{J\\,mol^{-1}}$ before computation. All pressures $\\,p\\,$ are in $\\mathrm{bar}$, temperature $\\,T\\,$ is in $\\mathrm{K}$, and $\\,K\\,$ is in $\\mathrm{bar^{-1}}$. The computed coverage $\\,\\theta\\,$ is dimensionless.\n\nTest suite (each tuple is $(K, w, T, p)$):\n- Case A (happy path, cooperative adsorption): $\\,(0.5, -2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$.\n- Case B (boundary, very low pressure): $\\,(0.5, -2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 10^{-8}\\,\\mathrm{bar})\\,$.\n- Case C (neutral interactions, reduces to no-lateral-interaction limit): $\\,(0.5, 0\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$.\n- Case D (repulsive interactions): $\\,(0.5, +2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$.\n- Case E (stronger attraction): $\\,(0.5, -4\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$.\n- Case F (high pressure, cooperative adsorption): $\\,(0.5, -2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 20\\,\\mathrm{bar})\\,$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\,[\\theta_{A},\\theta_{B},\\theta_{C},\\theta_{D},\\theta_{E},\\theta_{F}]$). Each entry must be rounded to six decimal places and ordered according to the cases A through F.",
            "solution": "The problem statement is scientifically grounded, well-posed, and contains all necessary information to derive the governing equation and solve it numerically for the specified test cases. It is therefore deemed valid.\n\nThe solution process involves two main steps: first, to derive the scalar nonlinear equation for the equilibrium surface coverage $\\theta$ from the provided fundamental principles, and second, to implement a numerical routine to solve this equation for each set of parameters.\n\n**Step 1: Derivation of the Equilibrium Equation**\n\nThe condition for thermodynamic equilibrium between the gas phase and the adsorbed phase is the equality of their chemical potentials.\n$$\n\\mu_{\\mathrm{ads}}(\\theta, T) = \\mu_{\\mathrm{gas}}(p, T)\n$$\n\nThe problem provides the expressions for the chemical potential of the gas, $\\mu_{\\mathrm{gas}}$, and the adsorbed layer, $\\mu_{\\mathrm{ads}}$:\n$$\n\\mu_{\\mathrm{gas}}(p,T) = \\mu_{\\mathrm{gas}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n$$\n\\mu_{\\mathrm{ads}}(\\theta,T) = \\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta\n$$\nHere, $\\theta$ is the fractional surface coverage, $T$ is the temperature, $p$ is the pressure, $R$ is the universal gas constant, $w$ is the mean-field lateral interaction energy, $\\mu_{\\mathrm{gas}}^{0}(T)$ and $\\mu_{\\mathrm{ads}}^{0}(T)$ are the standard-state chemical potentials of the gas and adsorbate, respectively, and $p^0$ is the reference pressure.\n\nEquating the two expressions for chemical potential:\n$$\n\\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta = \\mu_{\\mathrm{gas}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\nTo isolate the terms involving $\\theta$, we rearrange the equation:\n$$\nR T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta = \\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\nNext, we divide the entire equation by $R T$:\n$$\n\\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} = \\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T} + \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\nThe problem defines the equilibrium constant, $K$, as:\n$$\nK \\equiv \\dfrac{1}{p^{0}} \\exp\\!\\left(\\dfrac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T}\\right)\n$$\nTaking the natural logarithm of this definition gives:\n$$\n\\ln(K) = \\ln\\left(\\frac{1}{p^0}\\right) + \\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T} = -\\ln(p^0) + \\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T}\n$$\nFrom this, we can express the standard-state chemical potential difference term as:\n$$\n\\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T} = \\ln(K) + \\ln(p^0) = \\ln(K p^0)\n$$\n\nSubstituting this back into our rearranged equilibrium equation:\n$$\n\\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} = \\ln(K p^0) + \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\nUsing the logarithm property $\\ln(a) + \\ln(b) = \\ln(ab)$, the right-hand side simplifies to:\n$$\n\\ln(K p^0) + \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right) = \\ln\\left(K p^0 \\cdot \\frac{p}{p^0}\\right) = \\ln(K p)\n$$\n\nThis leads to the final form of the implicit equation for $\\theta$, known as the Frumkin-Fowler-Guggenheim isotherm equation:\n$$\n\\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} = \\ln(K p)\n$$\nThis is the scalar nonlinear equation that must be solved for $\\theta$. To solve it numerically, we formulate it as a root-finding problem. We define a function $f(\\theta)$ such that we seek the root of $f(\\theta) = 0$:\n$$\nf(\\theta) = \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} - \\ln(K p) = 0\n$$\n\n**Step 2: Numerical Solution Strategy**\n\nThe unknown $\\theta$ is physically constrained to the open interval $(0, 1)$. We need to find the root of the function $f(\\theta)$ within this interval.\nLet's analyze the behavior of $f(\\theta)$ at the boundaries of its domain:\n- As $\\theta \\to 0^+$, the term $\\ln\\left(\\frac{\\theta}{1-\\theta}\\right) \\to -\\infty$, so $f(\\theta) \\to -\\infty$.\n- As $\\theta \\to 1^-$, the term $\\ln\\left(\\frac{\\theta}{1-\\theta}\\right) \\to +\\infty$, so $f(\\theta) \\to +\\infty$.\n\nSince the function $f(\\theta)$ is continuous on $(0, 1)$ and goes from $-\\infty$ to $+\\infty$, the Intermediate Value Theorem guarantees that at least one root exists in this interval. For the parameter ranges given, the function is also monotonic, ensuring a unique root.\n\nA suitable numerical method for this problem is a bracketing root-finding algorithm, such as the Brent-Dekker method (`brentq` in `scipy.optimize`). This method is robust as it requires finding an interval $[a, b]$ where $f(a)$ and $f(b)$ have opposite signs. Given the boundary behavior of $f(\\theta)$, we can choose $a$ to be a small positive number (e.g., $10^{-12}$) and $b$ to be a number slightly less than $1$ (e.g., $1 - 10^{-12}$), which will reliably bracket the root.\n\nThe implementation will iterate through each test case, define the function $f(\\theta)$ with the specific parameters $(K, w, T, p)$, and use `scipy.optimize.brentq` to find the unique root $\\theta \\in (0, 1)$. The interaction energy $w$ must be converted from $\\mathrm{kJ\\,mol^{-1}}$ to $\\mathrm{J\\,mol^{-1}}$ by multiplying by $1000$. The computed value of $\\theta$ for each case is then rounded to six decimal places for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Derives and solves the Frumkin-Fowler-Guggenheim adsorption isotherm equation\n    for several test cases.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.31446261815324\n\n    # Test suite: each tuple is (K [bar^-1], w [kJ mol^-1], T [K], p [bar])\n    test_cases = [\n        # Case A (happy path, cooperative adsorption)\n        (0.5, -2.0, 400.0, 1.0),\n        # Case B (boundary, very low pressure)\n        (0.5, -2.0, 400.0, 1e-8),\n        # Case C (neutral interactions, Langmuir isotherm)\n        (0.5, 0.0, 400.0, 1.0),\n        # Case D (repulsive interactions)\n        (0.5, 2.0, 400.0, 1.0),\n        # Case E (stronger attraction)\n        (0.5, -4.0, 400.0, 1.0),\n        # Case F (high pressure, cooperative adsorption)\n        (0.5, -2.0, 400.0, 20.0),\n    ]\n\n    results = []\n    \n    # Define search interval for theta, which must be in (0, 1)\n    # The interval is chosen to be slightly smaller than (0, 1) to avoid\n    # numerical issues with log(0) or division by zero at the boundaries.\n    lower_bound = 1e-15\n    upper_bound = 1.0 - 1e-15\n\n    for K, w_kJ_mol, T, p in test_cases:\n        # Convert w from kJ/mol to J/mol\n        w = w_kJ_mol * 1000.0\n\n        # The nonlinear equation to solve is f(theta) = 0, where:\n        # f(theta) = ln(theta / (1-theta)) + w*theta/(R*T) - ln(K*p)\n        # We need to find the root theta in the interval (0, 1).\n\n        # Pre-calculate constant terms for efficiency.\n        # Check for non-positive p or K is good practice, though not needed here.\n        if K = 0 or p = 0:\n            # Physical parameters K and p must be positive.\n            # Handle this as an error or an edge case if necessary.\n            # For this problem, all inputs are valid.\n            # For p - 0+, K*p - 0+, log(K*p) - -inf.\n            # The equation is ln(theta/(1-theta)) + w*theta/(R*T) = -inf,\n            # which implies theta must be extremely close to 0.\n            log_Kp = -np.inf \n        else:\n            log_Kp = np.log(K * p)\n\n        def f(theta):\n            \"\"\"\n            The root-finding function f(theta) = 0. This function captures\n            the parameters K, w, T, p from the outer scope.\n            \"\"\"\n            # The term np.log(theta / (1.0 - theta)) is the core of the configurational entropy.\n            # The term (w * theta) / (R * T) is the mean-field interaction energy contribution.\n            # The term log_Kp contains the pressure and standard state information.\n            return np.log(theta / (1.0 - theta)) + (w * theta) / (R * T) - log_Kp\n\n        # Use brentq to find the root. It requires the function to have\n        # opposite signs at the interval endpoints.\n        # As theta - 0+, f(theta) - -inf.\n        # As theta - 1-, f(theta) - +inf.\n        # Thus, our interval [lower_bound, upper_bound] is guaranteed to bracket the root.\n        theta_solution = brentq(f, lower_bound, upper_bound)\n        \n        # Append the formatted result to the list\n        results.append(f\"{theta_solution:.6f}\")\n\n    # Print the final output in the required format: [res1,res2,...]\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solver\nsolve()\n```"
        },
        {
            "introduction": "The equilibrium constant $K$ is the central parameter in any adsorption isotherm, and its temperature dependence holds the key to the process's thermodynamics. This exercise guides you through using the van 't Hoff equation, which relates $\\ln K$ to the inverse temperature $1/T$. By performing a linear regression on provided data , you will learn how to extract the standard adsorption enthalpy ($\\Delta H_{\\mathrm{ads}}$) and entropy ($\\Delta S_{\\mathrm{ads}}$), a crucial skill for parameterizing models and understanding the energetics of surface phenomena.",
            "id": "3867925",
            "problem": "You are given equilibrium constants for adsorption at three temperatures and asked to determine the adsorption enthalpy and adsorption entropy from first principles and data fitting. Consider a non-dissociative, monomolecular adsorption process on a rigid, uniform surface under low coverage such that lateral interactions are negligible. At chemical equilibrium, the standard Gibbs free energy change for adsorption, denoted $\\Delta G^\\circ_{\\mathrm{ads}}$, is related to the equilibrium constant $K$ by thermodynamic definitions. The standard Gibbs free energy change is also related to the standard adsorption enthalpy $\\Delta H_{\\mathrm{ads}}$ and standard adsorption entropy $\\Delta S_{\\mathrm{ads}}$. Using these facts, justify the functional dependence of $\\ln K$ on $1/T$ and extract $\\Delta H_{\\mathrm{ads}}$ and $\\Delta S_{\\mathrm{ads}}$ by a statistically sound linear fit.\n\nImplement a program that:\n- Uses the natural logarithm for $\\ln$.\n- Performs an Ordinary Least Squares (OLS) linear regression of $y$ versus $x$, where $y = \\ln K$ and $x = 1/T$, to obtain a slope and an intercept. Then, deduce $\\Delta H_{\\mathrm{ads}}$ and $\\Delta S_{\\mathrm{ads}}$ from thermodynamic identities.\n- Uses the Universal Gas Constant (UGC) $R$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, with $R = 8.314462618$.\n\nPhysical units and output requirements:\n- Temperatures must be treated in $\\mathrm{K}$.\n- Equilibrium constants $K$ are dimensionless.\n- Report $\\Delta H_{\\mathrm{ads}}$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ and $\\Delta S_{\\mathrm{ads}}$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ as floating point numbers.\n- Angles are not involved.\n- Your program should produce a single line of output containing the results as a list of lists, with each inner list containing two floating point numbers in the order $[\\Delta H_{\\mathrm{ads}}, \\Delta S_{\\mathrm{ads}}]$, and the overall result enclosed in square brackets with no spaces, for example: $[[h_1,s_1],[h_2,s_2],[h_3,s_3]]$.\n\nTest suite:\nUse the following four cases. In each case, the temperature set is $[350,400,450]\\,\\mathrm{K}$ and the corresponding equilibrium constants $K(T)$ are given. All $K$ values are dimensionless.\n1. Case A (moderate exothermic adsorption, moderate entropy loss): Temperatures $[350,400,450]$ with $K$ values $[173.0,20.16,3.83]$.\n2. Case B (strongly exothermic adsorption, larger entropy loss): Temperatures $[350,400,450]$ with $K$ values $[13300.0,412.0,28.3]$.\n3. Case C (near-zero enthalpy change, small entropy loss): Temperatures $[350,400,450]$ with $K$ values $[0.772,0.741,0.715]$.\n4. Case D (moderately exothermic adsorption with slight measurement noise): Temperatures $[350,400,450]$ with $K$ values $[2.04,0.540,0.213]$.\n\nAlgorithmic specification for OLS:\nGiven data points $(x_i,y_i)$ with $x_i = 1/T_i$ and $y_i = \\ln K(T_i)$, compute the slope $m$ and intercept $b$ via OLS. Then infer $\\Delta H_{\\mathrm{ads}}$ and $\\Delta S_{\\mathrm{ads}}$ from physically justified relationships.\n\nFinal output format:\n- Produce a single line that is a comma-separated list enclosed in square brackets and containing exactly four inner lists, each inner list in the form $[\\Delta H_{\\mathrm{ads}},\\Delta S_{\\mathrm{ads}}]$, and no spaces anywhere in the string. For example: $[[h_A,s_A],[h_B,s_B],[h_C,s_C],[h_D,s_D]]$.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of chemical thermodynamics, well-posed, and provides all necessary information for a unique solution. The task is to determine the standard adsorption enthalpy, $\\Delta H_{\\mathrm{ads}}$, and the standard adsorption entropy, $\\Delta S_{\\mathrm{ads}}$, from experimental data of equilibrium constants, $K$, at different temperatures, $T$. This will be achieved by leveraging the van 't Hoff equation, which describes the temperature dependence of the equilibrium constant. The derivation and application are as follows.\n\nThe analysis begins with two fundamental thermodynamic relationships. First, the standard Gibbs free energy change of adsorption, $\\Delta G^\\circ_{\\mathrm{ads}}$, is defined in terms of the standard enthalpy and entropy changes:\n\n$$\n\\Delta G^\\circ_{\\mathrm{ads}} = \\Delta H_{\\mathrm{ads}} - T\\Delta S_{\\mathrm{ads}}\n$$\n\nHere, $\\Delta H_{\\mathrm{ads}}$ and $\\Delta S_{\\mathrm{ads}}$ are assumed to be constant over the temperature range of interest, a common and reasonable approximation for many systems over a limited range.\n\nSecond, for a process at chemical equilibrium, the standard Gibbs free energy change is related to the thermodynamic equilibrium constant, $K$, by the equation:\n\n$$\n\\Delta G^\\circ_{\\mathrm{ads}} = -RT \\ln K\n$$\n\nwhere $R$ is the Universal Gas Constant and $T$ is the absolute temperature in Kelvin. The problem specifies that $K$ is dimensionless, which is consistent with its use in the argument of a logarithm.\n\nBy equating these two expressions for $\\Delta G^\\circ_{\\mathrm{ads}}$, we establish a direct link between the equilibrium constant and the thermodynamic state functions:\n\n$$\n-RT \\ln K = \\Delta H_{\\mathrm{ads}} - T\\Delta S_{\\mathrm{ads}}\n$$\n\nTo justify the linear relationship requested in the problem, we rearrange this equation to express $\\ln K$ as a function of $T$:\n\n$$\n\\ln K = -\\frac{\\Delta H_{\\mathrm{ads}}}{RT} + \\frac{T\\Delta S_{\\mathrm{ads}}}{RT}\n$$\n\n$$\n\\ln K = \\left(-\\frac{\\Delta H_{\\mathrm{ads}}}{R}\\right) \\frac{1}{T} + \\frac{\\Delta S_{\\mathrm{ads}}}{R}\n$$\n\nThis equation is a form of the van 't Hoff equation. It is now evident that this equation has the form of a straight line, $y = mx + b$, where:\n- The dependent variable is $y = \\ln K$.\n- The independent variable is $x = 1/T$.\n- The slope of the line is $m = -\\frac{\\Delta H_{\\mathrm{ads}}}{R}$.\n- The y-intercept is $b = \\frac{\\Delta S_{\\mathrm{ads}}}{R}$.\n\nThis linear form validates the problem's proposed methodology: performing an Ordinary Least Squares (OLS) linear regression on a plot of $\\ln K$ versus $1/T$ to find the slope $m$ and intercept $b$.\n\nOnce the OLS regression is performed on the experimental data points $(x_i, y_i) = (1/T_i, \\ln K_i)$, we obtain the best-fit values for the slope $m$ and the intercept $b$. From these, we can algebraically solve for the desired thermodynamic quantities:\n\n$$\n\\Delta H_{\\mathrm{ads}} = -mR\n$$\n\n$$\n\\Delta S_{\\mathrm{ads}} = bR\n$$\n\nThe algorithmic procedure for each test case is as follows:\n1.  Given a set of temperatures $T_i$ and corresponding equilibrium constants $K_i$. The value of the Universal Gas Constant is given as $R = 8.314462618 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n2.  Transform the data into the linear variables: $x_i = 1/T_i$ and $y_i = \\ln K_i$.\n3.  Perform an OLS linear regression on the $(x_i, y_i)$ data points to compute the slope $m$ and the intercept $b$. For a set of $N$ data points $(x_i, y_i)$, the OLS coefficients are calculated to minimize the sum of squared residuals. For a linear model $y = mx+b$, the slope $m$ and intercept $b$ are given by:\n    $$m = \\frac{N \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{N \\sum(x_i^2) - (\\sum x_i)^2}$$\n    $$b = \\bar{y} - m\\bar{x} = \\frac{\\sum y_i - m \\sum x_i}{N}$$\n    where $\\bar{x}$ and $\\bar{y}$ are the means of the $x$ and $y$ values, respectively.\n4.  Use the derived slope and intercept to calculate the standard adsorption enthalpy $\\Delta H_{\\mathrm{ads}}$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ and standard adsorption entropy $\\Delta S_{\\mathrm{ads}}$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n5.  Report the results $[\\Delta H_{\\mathrm{ads}}, \\Delta S_{\\mathrm{ads}}]$ for each case as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the adsorption enthalpy and entropy from equilibrium constants at various temperatures\n    using the van 't Hoff equation and Ordinary Least Squares (OLS) linear regression.\n    \"\"\"\n    \n    # Universal Gas Constant in J mol^-1 K^-1\n    R = 8.314462618\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing a list of temperatures (K) and a list of equilibrium constants (dimensionless).\n    test_cases = [\n        # Case A\n        ([350, 400, 450], [173.0, 20.16, 3.83]),\n        # Case B\n        ([350, 400, 450], [13300.0, 412.0, 28.3]),\n        # Case C\n        ([350, 400, 450], [0.772, 0.741, 0.715]),\n        # Case D\n        ([350, 400, 450], [2.04, 0.540, 0.213]),\n    ]\n    \n    results = []\n    \n    for temps, ks in test_cases:\n        # Convert lists to NumPy arrays for vectorized operations.\n        # Use np.float64 for precision.\n        T = np.array(temps, dtype=np.float64)\n        K = np.array(ks, dtype=np.float64)\n\n        # The van 't Hoff equation is ln(K) = -ΔH/R * (1/T) + ΔS/R.\n        # This is a linear equation of the form y = mx + b.\n        # y = ln(K)\n        # x = 1/T\n        # m (slope) = -ΔH/R\n        # b (intercept) = ΔS/R\n        \n        # Prepare the variables for linear regression.\n        x = 1.0 / T\n        y = np.log(K)\n\n        # Perform OLS linear regression using NumPy's polyfit for a degree 1 polynomial.\n        # This returns the coefficients [slope, intercept].\n        slope, intercept = np.polyfit(x, y, 1)\n\n        # Calculate the thermodynamic quantities from the slope and intercept.\n        # From m = -ΔH/R = ΔH = -m * R\n        # From b = ΔS/R  = ΔS = b * R\n        delta_H_ads = -slope * R\n        delta_S_ads = intercept * R\n        \n        # Append the calculated values to the results list.\n        results.append([delta_H_ads, delta_S_ads])\n        \n    # Format the final output string as a list of lists with no spaces, as specified.\n    inner_strings = [f\"[{h},{s}]\" for h, s in results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}