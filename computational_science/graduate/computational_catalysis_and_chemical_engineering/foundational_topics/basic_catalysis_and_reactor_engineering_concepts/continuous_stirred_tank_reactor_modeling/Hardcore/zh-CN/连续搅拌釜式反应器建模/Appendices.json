{
    "hands_on_practices": [
        {
            "introduction": "在化学合成中，最大化目标产物的产率同时最小化副产物是至关重要的。本练习  将带您分析一个包含平行反应和串联反应的反应网络，这是反应工程中的一个典型问题。通过建立并求解各物种的稳态物料衡算方程，您将能够推导出中间产物产率的解析表达式，从而深入理解停留时间 $\\tau$ 和反应速率常数 $k_i$ 对反应选择性的影响。",
            "id": "3874622",
            "problem": "一个由一级反应 $A \\to B$、$A \\to C$ 和 $B \\to D$ 组成的液相反应网络，在单个充分混合的连续搅拌釜式反应器（CSTR）中等温进行。该反应器体积为 $V$，进料体积流量为 $q$，进料中仅包含物种 $A$，其浓度为 $C_{A,f}$。出口体积流量等于入口体积流量，且液体密度恒定，因此 $V$ 保持不变。定义停留时间 $\\tau \\equiv V/q$。每个反应都是基元反应且不可逆，其一级反应速率常数分别为：$A \\to B$ 的为 $k_1$，$A \\to C$ 的为 $k_2$，$B \\to D$ 的为 $k_3$，其中每个 $k_i$ 的量纲均为时间的倒数。\n\n使用完全混合 CSTR 中的物种摩尔衡算式：\n累积量 $=$ 输入 $-$ 输出 $+$ 生成量，\n从第一性原理出发，推导稳态出口浓度 $C_A$、$C_B$、$C_C$ 和 $C_D$（用 $k_1$、$k_2$、$k_3$、$\\tau$ 和 $C_{A,f}$ 表示）。\n\n然后，将 B 相对于 A 的产率定义为在稳态下离开反应器的 B 的量占入口 A 的量的分数，即 $Y_B \\equiv C_B/C_{A,f}$。确定 $Y_B$ 的一个闭式解析表达式（用 $k_1$、$k_2$、$k_3$ 和 $\\tau$ 表示）。\n\n将您的最终答案表示为 $Y_B$ 的单个闭式解析表达式。无需进行数值计算。",
            "solution": "该问题陈述具有科学依据、提法恰当、客观，并包含了推导唯一解所需的所有信息。它代表了化学反应工程中的一个标准问题。因此，该问题被认为是有效的，并将从第一性原理推导求解。\n\n出发点是连续搅拌釜式反应器（CSTR）中任意物种 $j$ 的通用摩尔衡算式：\n$$ \\text{累积量} = \\text{输入} - \\text{输出} + \\text{生成量} $$\n对于体积为 $V$ 的恒定液相系统，这可以用摩尔浓度 $C_j$ 表示：\n$$ V \\frac{dC_j}{dt} = q C_{j,in} - q C_{j,out} + R_j V $$\n其中 $q$ 是体积流量，$C_{j,in}$ 是物种 $j$ 的入口浓度，$C_{j,out}$ 是出口浓度，$R_j$ 是物种 $j$ 的净体积生成速率。\n\n反应器是充分混合的，这意味着反应器内部的浓度是均匀的，并等于出口浓度，即 $C_{j,out} = C_j$。问题指定了稳态操作，这意味着累积项为零，即 $\\frac{dC_j}{dt} = 0$。将摩尔衡算式两边同除以 $q$ 并引入停留时间 $\\tau \\equiv V/q$，物种 $j$ 的稳态摩尔衡算式简化为：\n$$ 0 = C_{j,in} - C_j + \\tau R_j $$\n\n接下来，我们根据给定的一级反应网络，定义每个物种（$A, B, C, D$）的净生成速率 $R_j$：\n1. $ A \\xrightarrow{k_1} B $，速率为 $r_1 = k_1 C_A$\n2. $ A \\xrightarrow{k_2} C $，速率为 $r_2 = k_2 C_A$\n3. $ B \\xrightarrow{k_3} D $，速率为 $r_3 = k_3 C_B$\n\n每个物种的净生成速率是生成该物种的反应速率之和减去消耗该物种的反应速率之和。\n对物种 $A$ 而言：$A$ 在反应 1 和 2 中被消耗。\n$$ R_A = -r_1 - r_2 = -k_1 C_A - k_2 C_A = -(k_1 + k_2)C_A $$\n对物种 $B$ 而言：$B$ 在反应 1 中生成，在反应 3 中被消耗。\n$$ R_B = r_1 - r_3 = k_1 C_A - k_3 C_B $$\n对物种 $C$ 而言：$C$ 在反应 2 中生成。\n$$ R_C = r_2 = k_2 C_A $$\n对物种 $D$ 而言：$D$ 在反应 3 中生成。\n$$ R_D = r_3 = k_3 C_B $$\n\n现在，我们将稳态摩尔衡算式应用于每个物种。进料仅包含物种 $A$，因此 $C_{A,in} = C_{A,f}$ 且 $C_{B,in} = C_{C,in} = C_{D,in} = 0$。\n\n**物种 A：**\n$$ 0 = C_{A,f} - C_A + \\tau R_A $$\n$$ 0 = C_{A,f} - C_A + \\tau(-(k_1 + k_2)C_A) $$\n$$ C_{A,f} = C_A + \\tau(k_1 + k_2)C_A $$\n$$ C_{A,f} = C_A (1 + \\tau(k_1 + k_2)) $$\n求解 A 的稳态出口浓度 $C_A$：\n$$ C_A = \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} $$\n\n**物种 B：**\n$$ 0 = C_{B,in} - C_B + \\tau R_B $$\n$$ 0 = 0 - C_B + \\tau(k_1 C_A - k_3 C_B) $$\n$$ C_B = \\tau k_1 C_A - \\tau k_3 C_B $$\n$$ C_B(1 + \\tau k_3) = \\tau k_1 C_A $$\n求解 $C_B$（用 $C_A$ 表示）：\n$$ C_B = \\frac{\\tau k_1 C_A}{1 + \\tau k_3} $$\n代入 $C_A$ 的表达式：\n$$ C_B = \\frac{\\tau k_1}{1 + \\tau k_3} \\left( \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} \\right) = \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\n\n**物种 C：**\n$$ 0 = C_{C,in} - C_C + \\tau R_C $$\n$$ 0 = 0 - C_C + \\tau(k_2 C_A) $$\n$$ C_C = \\tau k_2 C_A $$\n代入 $C_A$ 的表达式：\n$$ C_C = \\tau k_2 \\left( \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} \\right) = \\frac{\\tau k_2 C_{A,f}}{1 + \\tau(k_1 + k_2)} $$\n\n**物种 D：**\n$$ 0 = C_{D,in} - C_D + \\tau R_D $$\n$$ 0 = 0 - C_D + \\tau(k_3 C_B) $$\n$$ C_D = \\tau k_3 C_B $$\n代入 $C_B$ 的表达式：\n$$ C_D = \\tau k_3 \\left( \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} \\right) = \\frac{\\tau^2 k_1 k_3 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\n\n问题要求的是 B 相对于 A 的产率的表达式，定义为 $Y_B \\equiv C_B/C_{A,f}$。我们使用推导出的 $C_B$ 表达式：\n$$ Y_B = \\frac{C_B}{C_{A,f}} = \\frac{1}{C_{A,f}} \\left( \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} \\right) $$\n消去 $C_{A,f}$ 项，我们得到 B 产率的最终闭式表达式：\n$$ Y_B = \\frac{\\tau k_1}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\n该表达式用指定的参数 $k_1$、$k_2$、$k_3$ 和 $\\tau$ 表示。",
            "answer": "$$\\boxed{\\frac{\\tau k_1}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))}}$$"
        },
        {
            "introduction": "反应器在达到其最佳运行状态之前，必须经历一个启动阶段。理解这一瞬态过程对于过程控制和效率至关重要。本练习  要求您对一个从空釜开始填充的CSTR进行动态建模，通过求解描述反应物浓度随时间变化的微分方程，来确定达到指定转化率所需的时间。",
            "id": "3874624",
            "problem": "考虑一个理想混合的连续搅拌釜反应器（CSTR），其中物种 $A$ 发生等温、一级液相反应生成产物，其速率定律为 $r_{A} = -k C_{A}$，其中 $k$ 是反应速率常数，$C_{A}$ 是反应器中物种 $A$ 的浓度。在时间 $t = 0$ 时，一股恒定体积流量 $F$、入口浓度为 $C_{A,0}$ 的进料开始注入一个初始为空的容器中。反应器的体积控制如下：在填充阶段，出口保持关闭，直到液体体积在时间 $t = \\tau$ 达到其设计值 $V$，其中名义停留时间定义为 $\\tau = V/F$。在 $t = \\tau$ 时，出口打开，此后反应器在恒定体积 $V$ 下运行，且入口和出口流速相等。\n\n从基本物种衡算和转化率的定义 $X(t) = 1 - \\frac{C_{A}(t)}{C_{A,0}}$ 出发，推导瞬时转化率 $X(t)$ 首次等于在恒定体积操作下获得的稳态转化率 $X_{\\mathrm{ss}}$ 的特定分数 $\\alpha$ 时的时间 $t$ 的闭合形式表达式。符号化地使用入口浓度 $C_{A,0}$，并假设在任何时候密度恒定且混合完美。然后，在 $\\alpha = 0.95$、$\\tau = 200\\,\\mathrm{s}$ 和 $k = 0.01\\,\\mathrm{s}^{-1}$ 的情况下，计算该时间。\n\n将您的最终数值答案四舍五入到四位有效数字，并以秒为单位表示时间。",
            "solution": "该问题要求推导在一个经历特定启动程序的 CSTR 中，转化率达到其最终稳态值的分数 $\\alpha$ 时的时间 $t$。解法分为两个时间域：填充阶段 ($0 \\le t \\le \\tau$) 和恒定体积操作阶段 ($t > \\tau$)。\n\n基本原理是反应物 $A$ 的物种摩尔衡算：\n$$\n\\text{摩尔进入速率} - \\text{摩尔流出速率} + \\text{摩尔生成速率} = \\text{摩尔累积速率}\n$$\n用符号表示，对于物种 $A$，其摩尔流率为 $F_{A,0}$ (入口) 和 $F_A$ (出口)，反应速率为 $r_A$，反应器体积为 $V(t)$：\n$$\nF_{A,0} - F_A + r_A V(t) = \\frac{dN_A}{dt}\n$$\n对于一个恒定体积流量 $F$ 和恒定密度的液相反应，这可以用浓度 $C_A$ 来表示：$F_{A,0} = F C_{A,0}$，$F_A = F C_A$ 和 $N_A = C_A V(t)$。衡算式变为：\n$$\nF C_{A,0} - F C_A + r_A V(t) = \\frac{d(C_A V(t))}{dt}\n$$\n该反应为一级反应，速率定律为 $r_A = -k C_A$。\n\n**第一阶段：填充周期 ($0 \\le t \\le \\tau$)**\n\n在此阶段，反应器正在填充，因此体积是时间的函数，$V(t) = F t$。出口关闭，因此出口流率为零 ($F_A = 0$)。物种衡算方程为：\n$$\nF C_{A,0} + (-k C_A) (F t) = \\frac{d(C_A F t)}{dt}\n$$\n除以常数 $F$ 并对右侧应用乘积法则，得到：\n$$\nC_{A,0} - k t C_A = \\frac{d(C_A t)}{dt} = t \\frac{dC_A}{dt} + C_A\n$$\n将其重新排列成一阶线性常微分方程 (ODE) 的标准形式：\n$$\nt \\frac{dC_A}{dt} + (1 + k t) C_A = C_{A,0}\n$$\n或\n$$\n\\frac{dC_A}{dt} + \\left(\\frac{1}{t} + k\\right) C_A = \\frac{C_{A,0}}{t}\n$$\n在时间 $t=0$ 时，反应器是空的。进入反应釜的第一批流体的浓度为 $C_{A,0}$。由于初始体积为零，不可能发生反应。因此，初始条件是 $C_A(t \\to 0^+) = C_{A,0}$。这个 ODE 的积分因子是 $I(t) = \\exp\\left(\\int \\left(\\frac{1}{t} + k\\right) dt\\right) = \\exp(\\ln(t) + kt) = t \\exp(kt)$。\n将 ODE 乘以 $I(t)$:\n$$\n\\frac{d}{dt}(C_A \\cdot t \\exp(kt)) = \\frac{C_{A,0}}{t} \\cdot t \\exp(kt) = C_{A,0} \\exp(kt)\n$$\n对时间从 $0$ 到 $t$ 积分：\n$$\n\\int_{0}^{t} d(C_A(s) \\cdot s \\exp(ks)) = C_A(t) \\cdot t \\exp(kt) - \\lim_{s \\to 0^+} (C_A(s) \\cdot s \\exp(ks)) = \\int_{0}^{t} C_{A,0} \\exp(ks) ds\n$$\n左边的极限项为零，因为 $s \\to 0$ 且 $C_A(s)$ 趋近于一个有限值 $C_{A,0}$。右边的积分是 $\\frac{C_{A,0}}{k}(\\exp(kt) - 1)$。\n$$\nC_A(t) \\cdot t \\exp(kt) = \\frac{C_{A,0}}{k}(\\exp(kt) - 1)\n$$\n求解填充阶段 ($0 \\le t \\le \\tau$) 的 $C_A(t)$：\n$$\nC_{A,1}(t) = \\frac{C_{A,0}}{kt} (1 - \\exp(-kt))\n$$\n在填充阶段结束时，即 $t = \\tau$ 时，浓度为：\n$$\nC_A(\\tau) = \\frac{C_{A,0}}{k\\tau} (1 - \\exp(-k\\tau))\n$$\n\n**第二阶段：恒定体积操作 ($t > \\tau$)**\n\n对于 $t > \\tau$，反应器体积恒定为 $V$，并且入口和出口流率等于 $F$。物种衡算式变为：\n$$\nF C_{A,0} - F C_A - k C_A V = V \\frac{dC_A}{dt}\n$$\n除以 $V$ 并使用停留时间的定义 $\\tau = V/F$:\n$$\n\\frac{1}{\\tau} C_{A,0} - \\frac{1}{\\tau} C_A - k C_A = \\frac{dC_A}{dt}\n$$\n重新排列得到 ODE：\n$$\n\\frac{dC_A}{dt} + \\left(\\frac{1}{\\tau} + k\\right) C_A = \\frac{C_{A,0}}{\\tau}\n$$\n这是一个具有常系数的一阶线性 ODE。其解是瞬态部分和稳态部分之和。稳态浓度 $C_{A,\\mathrm{ss}}$ 可通过设置 $\\frac{dC_A}{dt} = 0$ 求得：\n$$\n\\left(\\frac{1}{\\tau} + k\\right) C_{A,\\mathrm{ss}} = \\frac{C_{A,0}}{\\tau} \\implies C_{A,\\mathrm{ss}} = \\frac{C_{A,0}/\\tau}{1/\\tau + k} = \\frac{C_{A,0}}{1 + k\\tau}\n$$\n对于 $t > \\tau$，$C_A(t)$ 的解具有形式 $C_A(t) = C_{A,\\mathrm{ss}} + B \\exp\\left(-\\left(\\frac{1}{\\tau}+k\\right)(t-\\tau)\\right)$，其中 $B$ 是一个常数，由该阶段的初始条件确定，即来自第一阶段的 $C_A(\\tau)$。\n在 $t=\\tau$ 时，$C_A(\\tau) = C_{A,\\mathrm{ss}} + B$。因此，$B = C_A(\\tau) - C_{A,\\mathrm{ss}}$。\n对于 $t > \\tau$ 的浓度分布为：\n$$\nC_{A,2}(t) = C_{A,\\mathrm{ss}} + (C_A(\\tau) - C_{A,\\mathrm{ss}}) \\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right)\n$$\n\n**确定目标时间**\n\n目标是找到时间 $t$，在该时间点，转化率 $X(t) = 1 - \\frac{C_A(t)}{C_{A,0}}$ 等于稳态转化率 $X_{\\mathrm{ss}}$ 的一个分数 $\\alpha$。\n首先，稳态转化率为：\n$$\nX_{\\mathrm{ss}} = 1 - \\frac{C_{A,\\mathrm{ss}}}{C_{A,0}} = 1 - \\frac{1}{1+k\\tau} = \\frac{k\\tau}{1+k\\tau}\n$$\n目标转化率是 $X_{\\text{target}} = \\alpha X_{\\mathrm{ss}} = \\alpha \\frac{k\\tau}{1+k\\tau}$。\n这对应于一个目标浓度 $C_{A,\\text{target}}$：\n$$\n1 - \\frac{C_{A,\\text{target}}}{C_{A,0}} = \\alpha \\frac{k\\tau}{1+k\\tau} \\implies \\frac{C_{A,\\text{target}}}{C_{A,0}} = 1 - \\alpha \\frac{k\\tau}{1+k\\tau}\n$$\n我们必须确定这个转化率是在第一阶段还是第二阶段达到的。我们计算在 $t=\\tau$ 时的转化率：\n$X(\\tau) = 1 - \\frac{C_A(\\tau)}{C_{A,0}} = 1 - \\frac{1 - \\exp(-k\\tau)}{k\\tau}$。\n使用给定值：$\\tau=200\\,\\mathrm{s}$，$k=0.01\\,\\mathrm{s}^{-1}$，$\\alpha=0.95$。\nDamköhler 数为 $k\\tau = (0.01\\,\\mathrm{s}^{-1})(200\\,\\mathrm{s}) = 2$。\n$X_{\\mathrm{ss}} = \\frac{2}{1+2} = \\frac{2}{3}$。\n$X_{\\text{target}} = 0.95 \\times \\frac{2}{3} = \\frac{1.9}{3} \\approx 0.6333$。\n$X(\\tau) = 1 - \\frac{1 - \\exp(-2)}{2} \\approx 1 - \\frac{1-0.1353}{2} = 1 - 0.4323 = 0.5677$。\n因为 $X_{\\text{target}} > X(\\tau)$，所以目标转化率在第二阶段 ($t > \\tau$) 达到。\n\n我们通过设置 $C_{A,2}(t) = C_{A,\\text{target}}$ 来求解 $t$：\n$$\nC_{A,\\text{target}} = C_{A,\\mathrm{ss}} + (C_A(\\tau) - C_{A,\\mathrm{ss}}) \\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right)\n$$\n除以 $C_{A,0}$ 并重新整理以求解指数项：\n$$\n\\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right) = \\frac{C_{A,\\text{target}} - C_{A,\\mathrm{ss}}}{C_A(\\tau) - C_{A,\\mathrm{ss}}} = \\frac{C_{A,\\text{target}}/C_{A,0} - C_{A,\\mathrm{ss}}/C_{A,0}}{C_A(\\tau)/C_{A,0} - C_{A,\\mathrm{ss}}/C_{A,0}}\n$$\n代入浓度比的表达式：\n分子：$\\left(1 - \\alpha \\frac{k\\tau}{1+k\\tau}\\right) - \\frac{1}{1+k\\tau} = \\frac{1+k\\tau - \\alpha k\\tau - 1}{1+k\\tau} = \\frac{(1-\\alpha)k\\tau}{1+k\\tau}$。\n分母：$\\frac{1 - \\exp(-k\\tau)}{k\\tau} - \\frac{1}{1+k\\tau} = \\frac{(1+k\\tau)(1-\\exp(-k\\tau)) - k\\tau}{k\\tau(1+k\\tau)} = \\frac{1 - (1+k\\tau)\\exp(-k\\tau)}{k\\tau(1+k\\tau)}$。\n该比率变为：\n$$\n\\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right) = \\frac{\\frac{(1-\\alpha)k\\tau}{1+k\\tau}}{\\frac{1 - (1+k\\tau)\\exp(-k\\tau)}{k\\tau(1+k\\tau)}} = \\frac{(1-\\alpha)(k\\tau)^2}{1 - (1+k\\tau)\\exp(-k\\tau)}\n$$\n取自然对数并求解 $t$：\n$$\n-\\frac{1+k\\tau}{\\tau}(t-\\tau) = \\ln\\left(\\frac{(1-\\alpha)(k\\tau)^2}{1 - (1+k\\tau)\\exp(-k\\tau)}\\right)\n$$\n$$\nt-\\tau = -\\frac{\\tau}{1+k\\tau} \\ln\\left(\\frac{(1-\\alpha)(k\\tau)^2}{1 - (1+k\\tau)\\exp(-k\\tau)}\\right)\n$$\n使用 $\\ln(1/x) = -\\ln(x)$:\n$$\nt = \\tau + \\frac{\\tau}{1+k\\tau} \\ln\\left(\\frac{1 - (1+k\\tau)\\exp(-k\\tau)}{(1-\\alpha)(k\\tau)^2}\\right)\n$$\n这是时间 $t$ 的最终闭合形式表达式。\n\n**数值计算**\n\n我们代入给定值：$\\alpha = 0.95$，$\\tau = 200\\,\\mathrm{s}$，以及 $k\\tau=2$。\n$$\nt = 200 + \\frac{200}{1+2} \\ln\\left(\\frac{1 - (1+2)\\exp(-2)}{(1-0.95)(2)^2}\\right)\n$$\n$$\nt = 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 3\\exp(-2)}{0.05 \\times 4}\\right)\n$$\n$$\nt = 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 3\\exp(-2)}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 3(0.135335)}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 0.406005}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln\\left(\\frac{0.593995}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln(2.969975)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} (1.08856)\n$$\n$$\nt \\approx 200 + 72.5707\n$$\n$$\nt \\approx 272.5707\\,\\mathrm{s}\n$$\n四舍五入到四位有效数字，时间为 $272.6\\,\\mathrm{s}$。",
            "answer": "$$\n\\boxed{272.6}\n$$"
        },
        {
            "introduction": "对于放热反应，将物料衡算与能量衡算耦合起来进行分析是保障反应器安全运行的核心。本练习  将引导您进入非等温CSTR建模的复杂领域，在这里，反应速率与温度通过阿伦尼乌斯定律非线性地耦合在一起。通过数值求解和灵敏度分析，您将学会识别潜在的操作风险，例如热失控，这是化学过程安全中的一个关键技能。",
            "id": "3874662",
            "problem": "考虑一个非等温连续搅拌釜反应器 (CSTR)，其中在液相中发生一个将物种 $A$ 转化为 $B$ 的单一不可逆一级反应。该反应器在稳态下运行，体积进料速率为 $F$，总传热参数为 $U A$，其中 $U$ 是总传热系数，$A$ 是换热面积。反应器内容物完美混合，密度恒定，比热容恒定。$A$ 的进料浓度为 $C_{A f}$，进料温度为 $T_f$。冷却剂（反应器外部）的温度为 $T_c$。反应器体积为 $V$。反应速率常数遵循阿伦尼乌斯定律 $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$，其中 $k_0$ 是指前因子，$E$ 是活化能，$R$ 是普适气体常数。反应热为 $\\Delta H$，对于放热反应，其值为负。\n\n从物种 $A$ 的基本质量平衡和反应器的能量平衡开始：\n- 物种 $A$ 的质量平衡（稳态）：\n$$0 = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A.$$\n- 能量平衡（稳态）：\n$$0 = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right),$$\n其中 $\\rho$ 是流体密度，$C_p$ 是定压比热容。\n\n定义残差向量 $\\mathbf{R}(\\mathbf{x}, \\mathbf{p})$，其中 $\\mathbf{x} = \\begin{bmatrix} C_A \\\\ T \\end{bmatrix}$，参数 $\\mathbf{p} = \\begin{bmatrix} U A \\\\ F \\end{bmatrix}$：\n$$R_1(C_A, T; U A, F) = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A,$$\n$$R_2(C_A, T; U A, F) = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right).$$\n稳态满足 $\\mathbf{R}(\\mathbf{x}^*, \\mathbf{p}) = \\mathbf{0}$。\n\n您的任务：\n1. 使用牛顿类方法求解稳态非线性系统 $\\mathbf{R}(\\mathbf{x}^*, \\mathbf{p}) = \\mathbf{0}$ 以得到 $\\mathbf{x}^* = \\begin{bmatrix} C_A^* \\\\ T^* \\end{bmatrix}$，初始化条件为 $T^{(0)} = T_f + 100\\,\\mathrm{K}$ 和 $C_A^{(0)} = 0.5\\,C_{A f}$。有物理意义的解必须满足 $C_A^* \\ge 0$ 和 $T^* > 0$。\n2. 使用隐函数定理推导稳态温度 $T^*$ 相对于 $U A$ 和 $F$ 的灵敏度。设残差关于状态的雅可比矩阵为\n$$\\mathbf{J}_x = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial C_A} & \\dfrac{\\partial R_1}{\\partial T} \\\\\n\\dfrac{\\partial R_2}{\\partial C_A} & \\dfrac{\\partial R_2}{\\partial T}\n\\end{bmatrix},$$\n残差关于参数的偏导数为\n$$\\mathbf{J}_{U A} = \\begin{bmatrix}\\dfrac{\\partial R_1}{\\partial (U A)} \\\\ \\dfrac{\\partial R_2}{\\partial (U A)} \\end{bmatrix}, \\qquad\n\\mathbf{J}_{F} = \\begin{bmatrix}\\dfrac{\\partial R_1}{\\partial F} \\\\ \\dfrac{\\partial R_2}{\\partial F} \\end{bmatrix}。$$\n使用 $\\dfrac{d \\mathbf{x}^*}{d p} = - \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{p}$，提取 $\\dfrac{d T^*}{d (U A)}$ 和 $\\dfrac{d T^*}{d F}$。为避免单位依赖性，报告无量纲归一化灵敏度\n$$S_{U A} = \\dfrac{U A}{T^*}\\,\\dfrac{d T^*}{d (U A)}, \\qquad S_{F} = \\dfrac{F}{T^*}\\,\\dfrac{d T^*}{d F}。$$\n3. 通过检查条件 $\\left|S_{U A}\\right| > 1$ 和 $\\left|S_{F}\\right| > 1$ 来识别参数微小变化导致温度剧烈变化的区域。如果参数 $1$ 百分比的变化导致 $T^*$ 超过 $1$ 百分比的变化，即相应的归一化灵敏度幅值超过 $1$，则该区域被归类为相对于该参数的“大偏移”区域。\n4. 为保证数值稳健性，如果 $\\mathbf{J}_x$ 是病态的，请使用最小二乘解来计算 $\\dfrac{d \\mathbf{x}^*}{d p}$。\n\n在整个过程中使用以下固定常数和单位：\n- $V = 1.0\\,\\mathrm{m}^3$,\n- $\\rho = 1000\\,\\mathrm{kg/m}^3$,\n- $C_p = 4180\\,\\mathrm{J/(kg\\cdot K)}$,\n- $\\Delta H = -1.2\\times 10^{5}\\,\\mathrm{J/mol}$,\n- $k_0 = 7.2\\times 10^{10}\\,\\mathrm{s}^{-1}$,\n- $E = 8.314\\times 10^{4}\\,\\mathrm{J/mol}$,\n- $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$,\n- $C_{A f} = 2500\\,\\mathrm{mol/m}^3$,\n- $T_f = 300\\,\\mathrm{K}$,\n- $T_c = 290\\,\\mathrm{K}$。\n\n测试套件（每个案例是一对 $(U A, F)$）：\n- 案例 $1$ (理想情况): $U A = 5000\\,\\mathrm{W/K}$， $F = 1.0\\times 10^{-3}\\,\\mathrm{m}^3/\\mathrm{s}$。\n- 案例 $2$ (低移除率和低流速，接近潜在的热灵敏度): $U A = 200\\,\\mathrm{W/K}$， $F = 1.0\\times 10^{-4}\\,\\mathrm{m}^3/\\mathrm{s}$。\n- 案例 $3$ (高移除率和较高流速): $U A = 15000\\,\\mathrm{W/K}$， $F = 3.0\\times 10^{-3}\\,\\mathrm{m}^3/\\mathrm{s}$。\n\n您的程序必须为每个测试案例计算稳态温度 $T^*$ (单位K)、归一化灵敏度 $S_{U A}$ 和 $S_{F}$ (无量纲)，以及关于 $U A$ 和 $F$ 的大偏移区域的布尔指标。最终输出必须是单行，包含一个列表的列表，每个测试案例一个，每个内部列表的顺序为 $\\left[T^*, S_{U A}, S_{F}, \\text{large\\_UA}, \\text{large\\_F}\\right]$，其中 $\\text{large\\_UA}$ 和 $\\text{large\\_F}$ 是布尔值。将 $T^*$ 以 $\\mathrm{K}$ 为单位表示，四舍五入到六位小数，$S_{U A}$ 和 $S_{F}$ 也四舍五入到六位小数。最终输出格式必须严格如下：\n$$\\text{[}[T_1^*, S_{U A,1}, S_{F,1}, \\text{large\\_UA}_1, \\text{large\\_F}_1], [T_2^*, S_{U A,2}, S_{F,2}, \\text{large\\_UA}_2, \\text{large\\_F}_2], [T_3^*, S_{U A,3}, S_{F,3}, \\text{large\\_UA}_3, \\text{large\\_F}_3]\\text{]}.$$\n不应打印任何其他文本。",
            "solution": "我们从稳态下连续搅拌釜反应器 (CSTR) 的基本质量和能量平衡开始。物种 $A$ 和温度的控制残差方程为\n$$R_1(C_A, T; U A, F) = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A,$$\n$$R_2(C_A, T; U A, F) = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right),$$\n其中 $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$。稳态同时满足 $R_1 = 0$ 和 $R_2 = 0$。\n\n第 $1$ 步（稳态计算）：我们求解非线性系统 $\\mathbf{R}(\\mathbf{x}, \\mathbf{p}) = \\mathbf{0}$，其中 $\\mathbf{x} = \\begin{bmatrix} C_A \\\\ T \\end{bmatrix}$，$\\mathbf{p} = \\begin{bmatrix} U A \\\\ F \\end{bmatrix}$。我们使用一个牛顿类方法（例如，混合 Powell 型方法），初始化于 $T^{(0)} = T_f + 100\\,\\mathrm{K}$ 和 $C_A^{(0)} = 0.5\\,C_{A f}$，并接受产生 $C_A \\ge 0$ 和 $T > 0$ 的解。为了数值稳健性，如果求解器未能收敛，可以尝试多个初始猜测，并选择在满足 $C_A \\ge 0$ 和 $T > 0$ 的条件下使残差范数 $\\left\\|\\mathbf{R}\\right\\|_2$ 最小化的可行解。\n\n第 $2$ 步（通过隐函数定理计算灵敏度）：定义残差关于状态变量的雅可比矩阵，\n$$\\mathbf{J}_x = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial C_A}  & \\dfrac{\\partial R_1}{\\partial T} \\\\\n\\dfrac{\\partial R_2}{\\partial C_A}  & \\dfrac{\\partial R_2}{\\partial T}\n\\end{bmatrix},$$\n在稳态 $(C_A^*, T^*)$ 下计算。我们首先计算必要的导数。令 $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$ 并注意\n$$\\dfrac{d k}{d T} = k(T)\\,\\dfrac{E}{R T^2}。$$\n使用 $r = k(T)\\,C_A$，我们有\n$$\\dfrac{\\partial R_1}{\\partial C_A} = -\\dfrac{F}{V} - k(T),$$\n$$\\dfrac{\\partial R_1}{\\partial T} = -C_A\\,\\dfrac{d k}{d T} = -C_A\\,k(T)\\,\\dfrac{E}{R T^2},$$\n$$\\dfrac{\\partial R_2}{\\partial C_A} = \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T),$$\n$$\\dfrac{\\partial R_2}{\\partial T} = -\\dfrac{F}{V} + \\dfrac{-\\Delta H}{\\rho C_p}\\,C_A\\,\\dfrac{d k}{d T} - \\dfrac{U A}{\\rho C_p V}\n= -\\dfrac{F}{V} + \\dfrac{-\\Delta H}{\\rho C_p}\\,C_A\\,k(T)\\,\\dfrac{E}{R T^2} - \\dfrac{U A}{\\rho C_p V}。$$\n接下来，残差关于参数 $U A$ 和 $F$ 的导数为\n$$\\mathbf{J}_{U A} = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial (U A)} \\\\\n\\dfrac{\\partial R_2}{\\partial (U A)}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 \\\\\n-\\dfrac{1}{\\rho C_p V}\\left(T - T_c\\right)\n\\end{bmatrix},$$\n$$\\mathbf{J}_{F} = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial F} \\\\\n\\dfrac{\\partial R_2}{\\partial F}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\dfrac{1}{V}\\left(C_{A f} - C_A\\right) \\\\\n\\dfrac{1}{V}\\left(T_f - T\\right)\n\\end{bmatrix}。$$\n根据隐函数定理，对于一个非奇异的 $\\mathbf{J}_x$，稳态 $\\mathbf{x}^*$ 随参数平滑变化，且\n$$\\dfrac{d \\mathbf{x}^*}{d p} = - \\mathbf{J}_x^{-1}\\,\\mathbf{J}_p,$$\n其中 $p$ 是 $U A$ 或 $F$。提取第二个分量以获得\n$$\\dfrac{d T^*}{d (U A)} = \\left(- \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{U A}\\right)_2, \\qquad \\dfrac{d T^*}{d F} = \\left(- \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{F}\\right)_2。$$\n为了提供与单位无关的度量，定义归一化灵敏度\n$$S_{U A} = \\dfrac{U A}{T^*}\\,\\dfrac{d T^*}{d (U A)}, \\qquad S_{F} = \\dfrac{F}{T^*}\\,\\dfrac{d T^*}{d F}。$$\n\n第 $3$ 步（大偏移区域的分类）：如果对于 $U A$ 有 $\\left|S_{U A}\\right| > 1$ 或对于 $F$ 有 $\\left|S_F\\right| > 1$，则该区域表现出对参数微小变化的巨大温度响应。这些阈值对应于参数 $1$ 百分比的变化引起 $T^*$ 超过 $1$ 百分比的变化。\n\n第 $4$ 步（数值稳健性）：如果 $\\mathbf{J}_x$ 是病态的或接近奇异的，直接求逆可能是不稳定的。在这种情况下，使用伪逆或稳健的求解器以最小二乘方式求解线性系统 $\\mathbf{J}_x\\,\\dfrac{d \\mathbf{x}^*}{d p} = -\\mathbf{J}_p$ 来计算灵敏度。\n\n算法设计：\n- 根据阿伦尼乌斯定律实现 $k(T)$ 和 $\\dfrac{d k}{d T}$。\n- 使用提供的常数和输入 $(U A, F)$ 设置残差函数 $R_1$ 和 $R_2$。\n- 使用一个根查找算法，初始化于 $T^{(0)} = T_f + 100\\,\\mathrm{K}$ 和 $C_A^{(0)} = 0.5\\,C_{A f}$；如果求解器失败或产生非物理值，则用其他可行的初始猜测重试，并选择在满足 $C_A \\ge 0$ 和 $T > 0$ 的条件下具有最小残差范数的解。\n- 在解处解析计算 $\\mathbf{J}_x$ 并构建 $\\mathbf{J}_{U A}$ 和 $\\mathbf{J}_F$。\n- 使用线性求解器求解 $\\dfrac{d \\mathbf{x}^*}{d (U A)}$ 和 $\\dfrac{d \\mathbf{x}^*}{d F}$；如果 $\\mathbf{J}_x$ 是病态的，则使用最小二乘求解器。\n- 构建 $S_{U A}$ 和 $S_F$，应用大偏移阈值，并将 $T^*$、$S_{U A}$ 和 $S_F$ 四舍五入到六位小数。\n- 对每个测试案例重复此过程，并按指定格式用单行打印结果列表。\n\n这种方法将反应器的热行为与物理定律（质量和能量平衡）及阿伦尼乌斯依赖性直接联系起来，揭示了雅可比矩阵结构如何控制灵敏度，并识别了靠近操作边界的参数区域，在这些区域中，微小的扰动可能导致巨大的温度变化。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\n# Constants (SI units)\nV = 1.0                 # m^3\nrho = 1000.0            # kg/m^3\nCp = 4180.0             # J/(kg*K)\nDeltaH = -1.2e5         # J/mol (exothermic, negative)\nk0 = 7.2e10             # 1/s\nE = 8.314e4             # J/mol\nRgas = 8.314            # J/(mol*K)\nCAf = 2500.0            # mol/m^3\nTf = 300.0              # K\nTc = 290.0              # K\n\ndef arrhenius_k(T):\n    return k0 * np.exp(-E / (Rgas * T))\n\ndef dk_dT(T):\n    k = arrhenius_k(T)\n    return k * (E / (Rgas * T**2))\n\ndef residuals(x, UA, F):\n    CA, T = x\n    k = arrhenius_k(T)\n    R1 = (F / V) * (CAf - CA) - k * CA\n    R2 = (F / V) * (Tf - T) + (-DeltaH / (rho * Cp)) * k * CA - (UA / (rho * Cp * V)) * (T - Tc)\n    return np.array([R1, R2])\n\ndef jacobian_x(x, UA, F):\n    CA, T = x\n    k = arrhenius_k(T)\n    dkdt = dk_dT(T)\n    dR1_dCA = -(F / V) - k\n    dR1_dT = -CA * dkdt\n    dR2_dCA = (-DeltaH / (rho * Cp)) * k\n    dR2_dT = -(F / V) + (-DeltaH / (rho * Cp)) * CA * dkdt - (UA / (rho * Cp * V))\n    return np.array([[dR1_dCA, dR1_dT],\n                     [dR2_dCA, dR2_dT]])\n\ndef jacobian_param_UA(x):\n    CA, T = x\n    dR1_dUA = 0.0\n    dR2_dUA = -(1.0 / (rho * Cp * V)) * (T - Tc)\n    return np.array([dR1_dUA, dR2_dUA])\n\ndef jacobian_param_F(x):\n    CA, T = x\n    dR1_dF = (1.0 / V) * (CAf - CA)\n    dR2_dF = (1.0 / V) * (Tf - T)\n    return np.array([dR1_dF, dR2_dF])\n\ndef solve_steady_state(UA, F):\n    # Initial guesses: primary and backups\n    guesses = [\n        np.array([0.5 * CAf, Tf + 100.0]),\n        np.array([CAf, Tf]),\n        np.array([0.1 * CAf, Tf + 200.0]),\n        np.array([0.01 * CAf, Tf + 50.0]),\n    ]\n    best_sol = None\n    best_res_norm = np.inf\n    for x0 in guesses:\n        sol = root(lambda x: residuals(x, UA, F), x0, method='hybr')\n        if sol.success:\n            CA_sol, T_sol = sol.x\n            if CA_sol >= 0.0 and T_sol > 0.0:\n                res_norm = np.linalg.norm(residuals(sol.x, UA, F))\n                if res_norm  best_res_norm:\n                    best_res_norm = res_norm\n                    best_sol = sol.x\n    if best_sol is None:\n        # As a fallback, return a physically plausible small conversion, near feed temperature\n        return np.array([max(0.0, 0.5 * CAf), max(1e-6, Tf)])\n    return best_sol\n\ndef sensitivities(x_star, UA, F):\n    Jx = jacobian_x(x_star, UA, F)\n    JU = jacobian_param_UA(x_star)\n    JF = jacobian_param_F(x_star)\n\n    # Solve Jx * dxdp = -Jp for p in {UA, F}\n    # Use solve if well-conditioned, else least squares.\n    def solve_linear(J, b):\n        try:\n            return np.linalg.solve(J, b)\n        except np.linalg.LinAlgError:\n            # Least squares\n            return np.linalg.lstsq(J, b, rcond=None)[0]\n\n    dxdUA = solve_linear(Jx, -JU)\n    dxdF = solve_linear(Jx, -JF)\n\n    CA_star, T_star = x_star\n    dT_dUA = dxdUA[1]\n    dT_dF = dxdF[1]\n\n    # Normalized sensitivities (dimensionless)\n    S_UA = (UA / T_star) * dT_dUA\n    S_F = (F / T_star) * dT_dF\n\n    return T_star, S_UA, S_F\n\ndef analyze_case(UA, F):\n    x_star = solve_steady_state(UA, F)\n    T_star, S_UA, S_F = sensitivities(x_star, UA, F)\n    # Large-shift regime flags\n    large_UA = abs(S_UA) > 1.0\n    large_F = abs(S_F) > 1.0\n    # Round values to six decimals as required\n    T_star_r = round(float(T_star), 6)\n    S_UA_r = round(float(S_UA), 6)\n    S_F_r = round(float(S_F), 6)\n    return [T_star_r, S_UA_r, S_F_r, large_UA, large_F]\n\ndef solve():\n    test_cases = [\n        (5000.0, 1.0e-3),   # Case 1: happy path\n        (200.0, 1.0e-4),    # Case 2: low removal and low flow\n        (15000.0, 3.0e-3),  # Case 3: high removal and flow\n    ]\n    results = [analyze_case(UA, F) for UA, F in test_cases]\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}