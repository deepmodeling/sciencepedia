{
    "hands_on_practices": [
        {
            "introduction": "Chemical synthesis rarely involves a single, clean transformation. This practice challenges you to model a more realistic scenario: a network of competing and sequential reactions. By applying the steady-state mole balance principle to each species, you will derive expressions for the final concentrations, allowing you to calculate the yield of a desired intermediate product—a fundamental task in process optimization. ",
            "id": "3874622",
            "problem": "A liquid-phase network of first-order reactions $A \\to B$, $A \\to C$, and $B \\to D$ proceeds isothermally in a single, well-mixed continuous stirred-tank reactor (CSTR). The reactor has volume $V$ and is fed at volumetric flow rate $q$ with a feed containing only species $A$ at concentration $C_{A,f}$. The outlet volumetric flow rate equals the inlet, and the liquid density is constant so that $V$ is constant. Define the residence time $\\tau \\equiv V/q$. Each reaction is elementary and irreversible with first-order rate constants $k_1$ for $A \\to B$, $k_2$ for $A \\to C$, and $k_3$ for $B \\to D$, where each $k_i$ has dimensions of inverse time.\n\nUsing the species mole balance in a perfectly mixed CSTR,\naccumulation $=$ in $-$ out $+$ generation,\nderive, from first principles, the steady-state outlet concentrations $C_A$, $C_B$, $C_C$, and $C_D$ in terms of $k_1$, $k_2$, $k_3$, $\\tau$, and $C_{A,f}$.\n\nThen define the yield of $B$ on $A$ as the fraction of inlet $A$ that exits the reactor as $B$ at steady state, $Y_B \\equiv C_B/C_{A,f}$. Determine a closed-form analytic expression for $Y_B$ in terms of $k_1$, $k_2$, $k_3$, and $\\tau$.\n\nExpress your final answer as a single closed-form analytic expression for $Y_B$. No numerical evaluation is required.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution. It represents a standard problem in chemical reaction engineering. Therefore, the problem is deemed valid and a solution will be derived from first principles.\n\nThe starting point is the general mole balance for a generic species $j$ in a Continuous Stirred-Tank Reactor (CSTR):\n$$ \\text{accumulation} = \\text{in} - \\text{out} + \\text{generation} $$\nFor a liquid-phase system with constant volume $V$, this can be expressed in terms of molar concentrations $C_j$:\n$$ V \\frac{dC_j}{dt} = q C_{j,in} - q C_{j,out} + R_j V $$\nwhere $q$ is the volumetric flow rate, $C_{j,in}$ is the inlet concentration of species $j$, $C_{j,out}$ is the outlet concentration, and $R_j$ is the net volumetric rate of formation of species $j$.\n\nThe reactor is well-mixed, which means the concentration inside the reactor is uniform and equal to the outlet concentration, $C_{j,out} = C_j$. The problem specifies steady-state operation, which means the accumulation term is zero, $\\frac{dC_j}{dt} = 0$. Dividing the mole balance by $q$ and introducing the residence time $\\tau \\equiv V/q$, the steady-state mole balance for species $j$ simplifies to:\n$$ 0 = C_{j,in} - C_j + \\tau R_j $$\n\nNext, we define the net rates of formation $R_j$ for each species ($A, B, C, D$) based on the given first-order reaction network:\n1. $ A \\xrightarrow{k_1} B $, with rate $r_1 = k_1 C_A$\n2. $ A \\xrightarrow{k_2} C $, with rate $r_2 = k_2 C_A$\n3. $ B \\xrightarrow{k_3} D $, with rate $r_3 = k_3 C_B$\n\nThe net rate of formation for each species is the sum of the rates of the reactions that produce it minus the sum of the rates of the reactions that consume it.\nFor species $A$: $A$ is consumed in reactions $1$ and $2$.\n$$ R_A = -r_1 - r_2 = -k_1 C_A - k_2 C_A = -(k_1 + k_2)C_A $$\nFor species $B$: $B$ is formed in reaction $1$ and consumed in reaction $3$.\n$$ R_B = r_1 - r_3 = k_1 C_A - k_3 C_B $$\nFor species $C$: $C$ is formed in reaction $2$.\n$$ R_C = r_2 = k_2 C_A $$\nFor species $D$: $D$ is formed in reaction $3$.\n$$ R_D = r_3 = k_3 C_B $$\n\nNow, we apply the steady-state mole balance to each species. The feed contains only species $A$, so $C_{A,in} = C_{A,f}$ and $C_{B,in} = C_{C,in} = C_{D,in} = 0$.\n\n**Species A:**\n$$ 0 = C_{A,f} - C_A + \\tau R_A $$\n$$ 0 = C_{A,f} - C_A + \\tau(-(k_1 + k_2)C_A) $$\n$$ C_{A,f} = C_A + \\tau(k_1 + k_2)C_A $$\n$$ C_{A,f} = C_A (1 + \\tau(k_1 + k_2)) $$\nSolving for the steady-state outlet concentration of $A$, $C_A$:\n$$ C_A = \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} $$\n\n**Species B:**\n$$ 0 = C_{B,in} - C_B + \\tau R_B $$\n$$ 0 = 0 - C_B + \\tau(k_1 C_A - k_3 C_B) $$\n$$ C_B = \\tau k_1 C_A - \\tau k_3 C_B $$\n$$ C_B(1 + \\tau k_3) = \\tau k_1 C_A $$\nSolving for $C_B$ in terms of $C_A$:\n$$ C_B = \\frac{\\tau k_1 C_A}{1 + \\tau k_3} $$\nSubstituting the expression for $C_A$:\n$$ C_B = \\frac{\\tau k_1}{1 + \\tau k_3} \\left( \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} \\right) = \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\n\n**Species C:**\n$$ 0 = C_{C,in} - C_C + \\tau R_C $$\n$$ 0 = 0 - C_C + \\tau(k_2 C_A) $$\n$$ C_C = \\tau k_2 C_A $$\nSubstituting the expression for $C_A$:\n$$ C_C = \\tau k_2 \\left( \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} \\right) = \\frac{\\tau k_2 C_{A,f}}{1 + \\tau(k_1 + k_2)} $$\n\n**Species D:**\n$$ 0 = C_{D,in} - C_D + \\tau R_D $$\n$$ 0 = 0 - C_D + \\tau(k_3 C_B) $$\n$$ C_D = \\tau k_3 C_B $$\nSubstituting the expression for $C_B$:\n$$ C_D = \\tau k_3 \\left( \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} \\right) = \\frac{\\tau^2 k_1 k_3 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\n\nThe problem asks for an expression for the yield of $B$ on $A$, defined as $Y_B \\equiv C_B/C_{A,f}$. We use the derived expression for $C_B$:\n$$ Y_B = \\frac{C_B}{C_{A,f}} = \\frac{1}{C_{A,f}} \\left( \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} \\right) $$\nCanceling the $C_{A,f}$ term, we obtain the final closed-form expression for the yield of $B$:\n$$ Y_B = \\frac{\\tau k_1}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\nThis expression is in terms of the specified parameters $k_1$, $k_2$, $k_3$, and $\\tau$.",
            "answer": "$$\\boxed{\\frac{\\tau k_1}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))}}$$"
        },
        {
            "introduction": "The assumption of simple power-law kinetics often breaks down in catalytic systems. This exercise explores a CSTR where the reaction is limited by reactant self-inhibition, a common phenomenon in heterogeneous catalysis described by a Langmuir-Hinshelwood type rate law. Integrating this more complex kinetic model into the standard CSTR design equation demonstrates how non-linearities arise and how they can be solved to predict reactor performance. ",
            "id": "3874633",
            "problem": "A liquid-phase single-species reaction occurs over a suspended catalyst in a Continuous Stirred-Tank Reactor (CSTR). The reactant, species $A$, experiences self-inhibition on catalytic sites such that the intrinsic volumetric rate of consumption is given by the reactant-inhibition rate law $r_{A}=-\\dfrac{k\\,C_{A}}{1+K\\,C_{A}}$, where $k$ is a positive rate constant and $K$ is a positive inhibition constant. The reactor operates isothermally at constant density, with perfect mixing. The feed contains species $A$ at concentration $C_{A,\\text{in}}$ and volumetric flow rate $F$, and the reactor volume is $V$. Assume a single, irreversible reaction with no byproduct accumulation affecting the rate and no transport limitations.\n\nStarting only from the species balance principle for a well-mixed reactor and the given rate law, derive the steady-state relation for the effluent concentration $C_{A}$ and solve for the physically admissible steady-state $C_{A}$ using the following parameter values: $V=1.0\\,\\text{m}^{3}$, $F=0.50\\,\\text{m}^{3}\\,\\text{s}^{-1}$, $C_{A,\\text{in}}=100\\,\\text{mol}\\,\\text{m}^{-3}$, $k=1.0\\,\\text{s}^{-1}$, and $K=1.0\\times 10^{-2}\\,\\text{m}^{3}\\,\\text{mol}^{-1}$.\n\nThen, evaluate the corresponding volumetric reaction rate $r_{A}$ at the steady-state concentration. Round both the steady-state concentration and the reaction rate to four significant figures. Express $C_{A}$ in $\\text{mol}\\,\\text{m}^{-3}$ and $r_{A}$ in $\\text{mol}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$.",
            "solution": "The analysis begins with the fundamental species mole balance for a substance in a well-mixed Continuous Stirred-Tank Reactor (CSTR). For a species $A$, this principle is expressed as:\n$$\n\\text{Accumulation} = \\text{In} - \\text{Out} + \\text{Generation}\n$$\nIn mathematical terms, for a reactor of volume $V$ with a volumetric flow rate $F$, this balance is written as:\n$$\nV \\frac{dC_A}{dt} = F C_{A,\\text{in}} - F C_A + V r_A\n$$\nwhere $C_A$ is the concentration of species $A$ in the reactor and the effluent, $C_{A,\\text{in}}$ is the feed concentration, and $r_A$ is the volumetric rate of reaction of species $A$.\n\nThe problem specifies steady-state operation, which implies that the concentration does not change with time. Therefore, the accumulation term is zero:\n$$\n\\frac{dC_A}{dt} = 0\n$$\nThe mole balance equation simplifies to:\n$$\n0 = F C_{A,\\text{in}} - F C_A + V r_A\n$$\nThis equation can be rearranged to relate the change in concentration to the reaction rate:\n$$\nF(C_{A,\\text{in}} - C_A) = -V r_A\n$$\nIntroducing the space time, $\\tau$, defined as the ratio of reactor volume to volumetric flow rate, $\\tau = \\frac{V}{F}$:\n$$\nC_{A,\\text{in}} - C_A = -\\tau r_A\n$$\nThe problem provides the intrinsic volumetric rate of consumption of species $A$ based on a reactant-inhibition mechanism:\n$$\nr_A = -\\frac{k C_A}{1 + K C_A}\n$$\nwhere $k$ is the rate constant and $K$ is the inhibition constant. Substituting this rate law into the steady-state mole balance yields the relation for the effluent concentration $C_A$:\n$$\nC_{A,\\text{in}} - C_A = -\\tau \\left( -\\frac{k C_A}{1 + K C_A} \\right)\n$$\n$$\nC_{A,\\text{in}} - C_A = \\frac{\\tau k C_A}{1 + K C_A}\n$$\nTo solve for $C_A$, we rearrange this equation into a polynomial form.\n$$\n(C_{A,\\text{in}} - C_A)(1 + K C_A) = \\tau k C_A\n$$\nExpanding the left-hand side gives:\n$$\nC_{A,\\text{in}} + K C_{A,\\text{in}} C_A - C_A - K C_A^2 = \\tau k C_A\n$$\nGrouping all terms on one side results in a quadratic equation for $C_A$:\n$$\nK C_A^2 + (1 + \\tau k - K C_{A,\\text{in}})C_A - C_{A,\\text{in}} = 0\n$$\nThis is a quadratic equation of the form $a x^2 + b x + c = 0$ with $x = C_A$, and the coefficients are:\n$a = K$\n$b = 1 + \\tau k - K C_{A,\\text{in}}$\n$c = -C_{A,\\text{in}}$\n\nNext, we substitute the given parameter values to find the numerical solution:\n$V = 1.0\\,\\text{m}^3$\n$F = 0.50\\,\\text{m}^3\\,\\text{s}^{-1}$\n$C_{A,\\text{in}} = 100\\,\\text{mol}\\,\\text{m}^{-3}$\n$k = 1.0\\,\\text{s}^{-1}$\n$K = 1.0 \\times 10^{-2}\\,\\text{m}^3\\,\\text{mol}^{-1} = 0.01\\,\\text{m}^3\\,\\text{mol}^{-1}$\n\nFirst, we calculate the space time $\\tau$:\n$$\n\\tau = \\frac{V}{F} = \\frac{1.0\\,\\text{m}^3}{0.50\\,\\text{m}^3\\,\\text{s}^{-1}} = 2.0\\,\\text{s}\n$$\nNow, we calculate the coefficients of the quadratic equation:\n$$\na = K = 0.01\n$$\n$$\nb = 1 + (2.0)(1.0) - (0.01)(100) = 1 + 2.0 - 1.0 = 2.0\n$$\n$$\nc = -C_{A,\\text{in}} = -100\n$$\nThe resulting quadratic equation for $C_A$ is:\n$$\n0.01 C_A^2 + 2.0 C_A - 100 = 0\n$$\nWe solve for $C_A$ using the quadratic formula, $C_A = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nC_A = \\frac{-2.0 \\pm \\sqrt{(2.0)^2 - 4(0.01)(-100)}}{2(0.01)}\n$$\n$$\nC_A = \\frac{-2.0 \\pm \\sqrt{4.0 + 4.0}}{0.02} = \\frac{-2.0 \\pm \\sqrt{8.0}}{0.02} = \\frac{-2.0 \\pm 2\\sqrt{2}}{0.02}\n$$\nThis gives two possible mathematical solutions for $C_A$:\n$$\nC_{A,1} = \\frac{-2.0 + 2\\sqrt{2}}{0.02} = 100(\\sqrt{2} - 1) \\approx 100(1.41421 - 1) = 41.421\\,\\text{mol}\\,\\text{m}^{-3}\n$$\n$$\nC_{A,2} = \\frac{-2.0 - 2\\sqrt{2}}{0.02} = -100(\\sqrt{2} + 1) \\approx -100(1.41421 + 1) = -241.421\\,\\text{mol}\\,\\text{m}^{-3}\n$$\nConcentration must be a non-negative physical quantity. Therefore, the second root, $C_{A,2}$, is physically inadmissible. The only physically meaningful solution is $C_{A,1}$. The effluent concentration must also be less than the inlet concentration for a consumption reaction ($41.421  100$), which is satisfied.\nRounding the physically admissible concentration to four significant figures gives:\n$$\nC_A \\approx 41.42\\,\\text{mol}\\,\\text{m}^{-3}\n$$\nFinally, we evaluate the corresponding volumetric reaction rate $r_A$ at this steady-state concentration. We can use either the rate law or the rearranged mole balance. Using the mole balance $r_A = (C_A - C_{A,\\text{in}})/\\tau$ with the unrounded value for $C_A$ enhances accuracy.\n$$\nr_A = \\frac{100(\\sqrt{2}-1) - 100}{2.0} = \\frac{100\\sqrt{2} - 200}{2.0} = 50\\sqrt{2} - 100 \\approx -29.289\\,\\text{mol}\\,\\text{m}^{-3}\\,\\text{s}^{-1}\n$$\nRounding the reaction rate to four significant figures gives:\n$$\nr_A \\approx -29.29\\,\\text{mol}\\,\\text{m}^{-3}\\,\\text{s}^{-1}\n$$\nThe negative sign correctly indicates that species $A$ is being consumed.\nThe required values are the steady-state concentration $C_A$ and the corresponding reaction rate $r_A$.\n$C_A = 41.42\\,\\text{mol}\\,\\text{m}^{-3}$\n$r_A = -29.29\\,\\text{mol}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 41.42  -29.29 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The true behavior of most industrial reactors is governed by the tight coupling between reaction kinetics and heat transfer. This advanced computational practice moves into the realm of non-isothermal CSTR modeling, where the Arrhenius-dependent reaction rate influences the energy balance, and the temperature in turn dictates the reaction rate. You will not only solve this coupled non-linear system but also perform a sensitivity analysis, a crucial skill for assessing reactor stability and identifying critical operating parameters. ",
            "id": "3874662",
            "problem": "Consider a nonisothermal Continuous Stirred-Tank Reactor (CSTR) with a single irreversible first-order reaction converting species $A$ to $B$ in a liquid phase. The reactor operates at steady state with volumetric feed flow rate $F$ and overall heat transfer parameter $U A$, where $U$ is the overall heat transfer coefficient and $A$ is the heat exchange area. The reactor contents are perfectly mixed, the density is constant, and the specific heat capacity is constant. The feed concentration of $A$ is $C_{A f}$ and the feed temperature is $T_f$. The coolant (external to the reactor) is at temperature $T_c$. The reactor volume is $V$. The reaction rate constant follows the Arrhenius law $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$, where $k_0$ is the pre-exponential factor, $E$ is the activation energy, and $R$ is the Universal Gas Constant. The heat of reaction is $\\Delta H$ and is negative for an exothermic reaction.\n\nStart from the fundamental mass balance for species $A$ and the energy balance for the reactor:\n- Mass balance for species $A$ (steady state): \n$$0 = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A.$$\n- Energy balance (steady state):\n$$0 = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right),$$\nwhere $\\rho$ is the fluid density and $C_p$ is the specific heat capacity at constant pressure.\n\nDefine the residual vector $\\mathbf{R}(\\mathbf{x}, \\mathbf{p})$ with $\\mathbf{x} = \\begin{bmatrix} C_A \\\\ T \\end{bmatrix}$ and parameters $\\mathbf{p} = \\begin{bmatrix} U A \\\\ F \\end{bmatrix}$:\n$$R_1(C_A, T; U A, F) = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A,$$\n$$R_2(C_A, T; U A, F) = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right).$$\nA steady state satisfies $\\mathbf{R}(\\mathbf{x}^*, \\mathbf{p}) = \\mathbf{0}$.\n\nYour tasks:\n1. Solve the steady-state nonlinear system $\\mathbf{R}(\\mathbf{x}^*, \\mathbf{p}) = \\mathbf{0}$ for $\\mathbf{x}^* = \\begin{bmatrix} C_A^* \\\\ T^* \\end{bmatrix}$ using a Newton-type method initialized at $T^{(0)} = T_f + 100\\,\\mathrm{K}$ and $C_A^{(0)} = 0.5\\,C_{A f}$. The physically meaningful solution must satisfy $C_A^* \\ge 0$ and $T^*  0$.\n2. Derive the sensitivity of the steady-state temperature $T^*$ with respect to $U A$ and $F$ using the implicit function theorem. Let the Jacobian of the residuals with respect to the state be \n$$\\mathbf{J}_x = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial C_A}  \\dfrac{\\partial R_1}{\\partial T} \\\\\n\\dfrac{\\partial R_2}{\\partial C_A}  \\dfrac{\\partial R_2}{\\partial T}\n\\end{bmatrix},$$\nand the partial derivatives of the residuals with respect to parameters be \n$$\\mathbf{J}_{U A} = \\begin{bmatrix}\\dfrac{\\partial R_1}{\\partial (U A)} \\\\ \\dfrac{\\partial R_2}{\\partial (U A)} \\end{bmatrix}, \\qquad\n\\mathbf{J}_{F} = \\begin{bmatrix}\\dfrac{\\partial R_1}{\\partial F} \\\\ \\dfrac{\\partial R_2}{\\partial F} \\end{bmatrix}.$$\nUsing $\\dfrac{d \\mathbf{x}^*}{d p} = - \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{p}$, extract $\\dfrac{d T^*}{d (U A)}$ and $\\dfrac{d T^*}{d F}$. To avoid unit dependence, report the dimensionless normalized sensitivities\n$$S_{U A} = \\dfrac{U A}{T^*}\\,\\dfrac{d T^*}{d (U A)}, \\qquad S_{F} = \\dfrac{F}{T^*}\\,\\dfrac{d T^*}{d F}.$$\n3. Identify regimes where small parameter changes lead to large temperature shifts by checking the conditions $\\left|S_{U A}\\right|  1$ and $\\left|S_{F}\\right|  1$. A regime is classified as “large-shift” with respect to a parameter if a $1$ percent change in the parameter produces more than a $1$ percent change in $T^*$, i.e., the corresponding normalized sensitivity magnitude exceeds $1$.\n4. For numerical robustness, if $\\mathbf{J}_x$ is ill-conditioned, use a least-squares solution to compute $\\dfrac{d \\mathbf{x}^*}{d p}$.\n\nUse the following fixed constants and units throughout:\n- $V = 1.0\\,\\mathrm{m}^3$,\n- $\\rho = 1000\\,\\mathrm{kg/m}^3$,\n- $C_p = 4180\\,\\mathrm{J/(kg\\cdot K)}$,\n- $\\Delta H = -1.2\\times 10^{5}\\,\\mathrm{J/mol}$,\n- $k_0 = 7.2\\times 10^{10}\\,\\mathrm{s}^{-1}$,\n- $E = 8.314\\times 10^{4}\\,\\mathrm{J/mol}$,\n- $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$,\n- $C_{A f} = 2500\\,\\mathrm{mol/m}^3$,\n- $T_f = 300\\,\\mathrm{K}$,\n- $T_c = 290\\,\\mathrm{K}$.\n\nTest suite (each case is a pair $(U A, F)$):\n- Case $1$ (happy path): $U A = 5000\\,\\mathrm{W/K}$, $F = 1.0\\times 10^{-3}\\,\\mathrm{m}^3/\\mathrm{s}$.\n- Case $2$ (low removal and low flow, near potential thermal sensitivity): $U A = 200\\,\\mathrm{W/K}$, $F = 1.0\\times 10^{-4}\\,\\mathrm{m}^3/\\mathrm{s}$.\n- Case $3$ (high removal and higher flow): $U A = 15000\\,\\mathrm{W/K}$, $F = 3.0\\times 10^{-3}\\,\\mathrm{m}^3/\\mathrm{s}$.\n\nYour program must, for each test case, compute the steady-state temperature $T^*$ in $\\mathrm{K}$, the normalized sensitivities $S_{U A}$ and $S_{F}$ (dimensionless), and the boolean indicators for large-shift regimes with respect to $U A$ and $F$. The final output must be a single line containing a list of lists, one per test case, each inner list in the order $\\left[T^*, S_{U A}, S_{F}, \\text{large\\_UA}, \\text{large\\_F}\\right]$, where $\\text{large\\_UA}$ and $\\text{large\\_F}$ are booleans. Express $T^*$ in $\\mathrm{K}$, rounded to six decimal places, and $S_{U A}$ and $S_{F}$ rounded to six decimal places. The final output format must be exactly:\n$$\\text{[}[T_1^*, S_{U A,1}, S_{F,1}, \\text{large\\_UA}_1, \\text{large\\_F}_1], [T_2^*, S_{U A,2}, S_{F,2}, \\text{large\\_UA}_2, \\text{large\\_F}_2], [T_3^*, S_{U A,3}, S_{F,3}, \\text{large\\_UA}_3, \\text{large\\_F}_3]\\text{]}.$$\nNo other text should be printed.",
            "solution": "We begin from the fundamental mass and energy balances for a Continuous Stirred-Tank Reactor (CSTR) at steady state. The governing residual equations for species $A$ and temperature are\n$$R_1(C_A, T; U A, F) = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A,$$\n$$R_2(C_A, T; U A, F) = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right),$$\nwith $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$. A steady state satisfies $R_1 = 0$ and $R_2 = 0$ simultaneously.\n\nStep $1$ (steady-state computation): We solve the nonlinear system $\\mathbf{R}(\\mathbf{x}, \\mathbf{p}) = \\mathbf{0}$ with $\\mathbf{x} = \\begin{bmatrix} C_A \\\\ T \\end{bmatrix}$ and $\\mathbf{p} = \\begin{bmatrix} U A \\\\ F \\end{bmatrix}$. We use a Newton-type method (for example, a hybrid Powell-type method) initialized at $T^{(0)} = T_f + 100\\,\\mathrm{K}$ and $C_A^{(0)} = 0.5\\,C_{A f}$, and accept the solution that yields $C_A \\ge 0$ and $T  0$. For numerical robustness, one can attempt multiple initial guesses if the solver fails to converge and select the feasible solution minimizing the residual norm $\\left\\|\\mathbf{R}\\right\\|_2$.\n\nStep $2$ (sensitivities via implicit function theorem): Define the Jacobian of residuals with respect to the state variables,\n$$\\mathbf{J}_x = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial C_A}  \\dfrac{\\partial R_1}{\\partial T} \\\\\n\\dfrac{\\partial R_2}{\\partial C_A}  \\dfrac{\\partial R_2}{\\partial T}\n\\end{bmatrix},$$\ncomputed at the steady state $(C_A^*, T^*)$. We first compute the necessary derivatives. Let $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$ and note that\n$$\\dfrac{d k}{d T} = k(T)\\,\\dfrac{E}{R T^2}.$$\nUsing $r = k(T)\\,C_A$, we have\n$$\\dfrac{\\partial R_1}{\\partial C_A} = -\\dfrac{F}{V} - k(T),$$\n$$\\dfrac{\\partial R_1}{\\partial T} = -C_A\\,\\dfrac{d k}{d T} = -C_A\\,k(T)\\,\\dfrac{E}{R T^2},$$\n$$\\dfrac{\\partial R_2}{\\partial C_A} = \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T),$$\n$$\\dfrac{\\partial R_2}{\\partial T} = -\\dfrac{F}{V} + \\dfrac{-\\Delta H}{\\rho C_p}\\,C_A\\,\\dfrac{d k}{d T} - \\dfrac{U A}{\\rho C_p V}\n= -\\dfrac{F}{V} + \\dfrac{-\\Delta H}{\\rho C_p}\\,C_A\\,k(T)\\,\\dfrac{E}{R T^2} - \\dfrac{U A}{\\rho C_p V}.$$\nNext, the residual derivatives with respect to parameters $U A$ and $F$ are\n$$\\mathbf{J}_{U A} = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial (U A)} \\\\\n\\dfrac{\\partial R_2}{\\partial (U A)}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 \\\\\n-\\dfrac{1}{\\rho C_p V}\\left(T - T_c\\right)\n\\end{bmatrix},$$\n$$\\mathbf{J}_{F} = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial F} \\\\\n\\dfrac{\\partial R_2}{\\partial F}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\dfrac{1}{V}\\left(C_{A f} - C_A\\right) \\\\\n\\dfrac{1}{V}\\left(T_f - T\\right)\n\\end{bmatrix}.$$\nBy the implicit function theorem, for a nonsingular $\\mathbf{J}_x$, the steady state $\\mathbf{x}^*$ varies smoothly with parameters and\n$$\\dfrac{d \\mathbf{x}^*}{d p} = - \\mathbf{J}_x^{-1}\\,\\mathbf{J}_p,$$\nwhere $p$ is either $U A$ or $F$. Extract the second component to obtain\n$$\\dfrac{d T^*}{d (U A)} = \\left(- \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{U A}\\right)_2, \\qquad \\dfrac{d T^*}{d F} = \\left(- \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{F}\\right)_2.$$\nTo provide unit-independent measures, define the normalized sensitivities\n$$S_{U A} = \\dfrac{U A}{T^*}\\,\\dfrac{d T^*}{d (U A)}, \\qquad S_{F} = \\dfrac{F}{T^*}\\,\\dfrac{d T^*}{d F}.$$\n\nStep $3$ (classification of large-shift regimes): A regime exhibits large temperature response to small parameter changes if $\\left|S_{U A}\\right|  1$ for $U A$ or $\\left|S_F\\right|  1$ for $F$. These thresholds correspond to a $1$ percent change in the parameter inducing more than a $1$ percent change in $T^*$.\n\nStep $4$ (numerical robustness): If $\\mathbf{J}_x$ is ill-conditioned or nearly singular, directly inverting it can be unstable. In such cases, solve the linear system $\\mathbf{J}_x\\,\\dfrac{d \\mathbf{x}^*}{d p} = -\\mathbf{J}_p$ in a least-squares sense using a pseudoinverse or a robust solver to compute sensitivities.\n\nAlgorithmic design:\n- Implement $k(T)$ and $\\dfrac{d k}{d T}$ per Arrhenius law.\n- Set up the residual functions $R_1$ and $R_2$ using the provided constants and inputs $(U A, F)$.\n- Use a root-finding algorithm initialized at $T^{(0)} = T_f + 100\\,\\mathrm{K}$ and $C_A^{(0)} = 0.5\\,C_{A f}$; if the solver fails or yields nonphysical values, retry with alternative feasible initial guesses and pick the solution with the smallest residual norm subject to $C_A \\ge 0$ and $T  0$.\n- Compute $\\mathbf{J}_x$ analytically at the solution and form $\\mathbf{J}_{U A}$ and $\\mathbf{J}_F$.\n- Solve for $\\dfrac{d \\mathbf{x}^*}{d (U A)}$ and $\\dfrac{d \\mathbf{x}^*}{d F}$ using linear solvers; if $\\mathbf{J}_x$ is ill-conditioned, use a least-squares solver.\n- Form $S_{U A}$ and $S_F$, apply the large-shift threshold, and round $T^*$, $S_{U A}$, and $S_F$ to six decimal places.\n- Repeat for each test case and print a single line with the list of results in the specified format.\n\nThis approach directly ties reactor thermal behavior to physical laws (mass and energy balances) and the Arrhenius dependence, reveals how the Jacobian structure controls sensitivity, and identifies parameter regimes near operational boundaries where small perturbations can cause large temperature shifts.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\n# Constants (SI units)\nV = 1.0                 # m^3\nrho = 1000.0            # kg/m^3\nCp = 4180.0             # J/(kg*K)\nDeltaH = -1.2e5         # J/mol (exothermic, negative)\nk0 = 7.2e10             # 1/s\nE = 8.314e4             # J/mol\nRgas = 8.314            # J/(mol*K)\nCAf = 2500.0            # mol/m^3\nTf = 300.0              # K\nTc = 290.0              # K\n\ndef arrhenius_k(T):\n    return k0 * np.exp(-E / (Rgas * T))\n\ndef dk_dT(T):\n    k = arrhenius_k(T)\n    return k * (E / (Rgas * T**2))\n\ndef residuals(x, UA, F):\n    CA, T = x\n    k = arrhenius_k(T)\n    R1 = (F / V) * (CAf - CA) - k * CA\n    R2 = (F / V) * (Tf - T) + (-DeltaH / (rho * Cp)) * k * CA - (UA / (rho * Cp * V)) * (T - Tc)\n    return np.array([R1, R2])\n\ndef jacobian_x(x, UA, F):\n    CA, T = x\n    k = arrhenius_k(T)\n    dkdt = dk_dT(T)\n    dR1_dCA = -(F / V) - k\n    dR1_dT = -CA * dkdt\n    dR2_dCA = (-DeltaH / (rho * Cp)) * k\n    dR2_dT = -(F / V) + (-DeltaH / (rho * Cp)) * CA * dkdt - (UA / (rho * Cp * V))\n    return np.array([[dR1_dCA, dR1_dT],\n                     [dR2_dCA, dR2_dT]])\n\ndef jacobian_param_UA(x):\n    CA, T = x\n    dR1_dUA = 0.0\n    dR2_dUA = -(1.0 / (rho * Cp * V)) * (T - Tc)\n    return np.array([dR1_dUA, dR2_dUA])\n\ndef jacobian_param_F(x):\n    CA, T = x\n    dR1_dF = (1.0 / V) * (CAf - CA)\n    dR2_dF = (1.0 / V) * (Tf - T)\n    return np.array([dR1_dF, dR2_dF])\n\ndef solve_steady_state(UA, F):\n    # Initial guesses: primary and backups\n    guesses = [\n        np.array([0.5 * CAf, Tf + 100.0]),\n        np.array([CAf, Tf]),\n        np.array([0.1 * CAf, Tf + 200.0]),\n        np.array([0.01 * CAf, Tf + 50.0]),\n    ]\n    best_sol = None\n    best_res_norm = np.inf\n    for x0 in guesses:\n        sol = root(lambda x: residuals(x, UA, F), x0, method='hybr')\n        if sol.success:\n            CA_sol, T_sol = sol.x\n            if CA_sol >= 0.0 and T_sol > 0.0:\n                res_norm = np.linalg.norm(residuals(sol.x, UA, F))\n                if res_norm  best_res_norm:\n                    best_res_norm = res_norm\n                    best_sol = sol.x\n    if best_sol is None:\n        # As a fallback, return a physically plausible small conversion, near feed temperature\n        return np.array([max(0.0, 0.5 * CAf), max(1e-6, Tf)])\n    return best_sol\n\ndef sensitivities(x_star, UA, F):\n    Jx = jacobian_x(x_star, UA, F)\n    JU = jacobian_param_UA(x_star)\n    JF = jacobian_param_F(x_star)\n\n    # Solve Jx * dxdp = -Jp for p in {UA, F}\n    # Use solve if well-conditioned, else least squares.\n    def solve_linear(J, b):\n        try:\n            return np.linalg.solve(J, b)\n        except np.linalg.LinAlgError:\n            # Least squares\n            return np.linalg.lstsq(J, b, rcond=None)[0]\n\n    dxdUA = solve_linear(Jx, -JU)\n    dxdF = solve_linear(Jx, -JF)\n\n    CA_star, T_star = x_star\n    dT_dUA = dxdUA[1]\n    dT_dF = dxdF[1]\n\n    # Normalized sensitivities (dimensionless)\n    S_UA = (UA / T_star) * dT_dUA\n    S_F = (F / T_star) * dT_dF\n\n    return T_star, S_UA, S_F\n\ndef analyze_case(UA, F):\n    x_star = solve_steady_state(UA, F)\n    T_star, S_UA, S_F = sensitivities(x_star, UA, F)\n    # Large-shift regime flags\n    large_UA = abs(S_UA) > 1.0\n    large_F = abs(S_F) > 1.0\n    # Round values to six decimals as required\n    T_star_r = round(float(T_star), 6)\n    S_UA_r = round(float(S_UA), 6)\n    S_F_r = round(float(S_F), 6)\n    return [T_star_r, S_UA_r, S_F_r, large_UA, large_F]\n\ndef solve():\n    test_cases = [\n        (5000.0, 1.0e-3),   # Case 1: happy path\n        (200.0, 1.0e-4),    # Case 2: low removal and low flow\n        (15000.0, 3.0e-3),  # Case 3: high removal and flow\n    ]\n    results = [analyze_case(UA, F) for UA, F in test_cases]\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}