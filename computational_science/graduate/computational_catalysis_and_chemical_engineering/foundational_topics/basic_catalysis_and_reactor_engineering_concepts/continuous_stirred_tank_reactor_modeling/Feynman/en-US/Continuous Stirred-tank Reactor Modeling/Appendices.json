{
    "hands_on_practices": [
        {
            "introduction": "Mastering CSTR modeling begins with a firm grasp of steady-state analysis, which describes the reactor's long-term behavior under constant operating conditions. This first practice challenges you to model a common industrial scenario: a network of competing and sequential reactions . By applying the fundamental principle of mole balance to each species, you will derive analytical expressions for steady-state concentrations and product yield, a critical skill for optimizing reactor performance for a desired product.",
            "id": "3874622",
            "problem": "A liquid-phase network of first-order reactions $A \\to B$, $A \\to C$, and $B \\to D$ proceeds isothermally in a single, well-mixed continuous stirred-tank reactor (CSTR). The reactor has volume $V$ and is fed at volumetric flow rate $F$ with a feed containing only species $A$ at concentration $C_{A,f}$. The outlet volumetric flow rate equals the inlet, and the liquid density is constant so that $V$ is constant. Define the residence time $\\tau \\equiv V/F$. Each reaction is elementary and irreversible with first-order rate constants $k_1$ for $A \\to B$, $k_2$ for $A \\to C$, and $k_3$ for $B \\to D$, where each $k_i$ has dimensions of inverse time.\n\nUsing the species mole balance in a perfectly mixed CSTR,\naccumulation $=$ in $-$ out $+$ generation,\nderive, from first principles, the steady-state outlet concentrations $C_A$, $C_B$, $C_C$, and $C_D$ in terms of $k_1$, $k_2$, $k_3$, $\\tau$, and $C_{A,f}$.\n\nThen define the yield of $B$ on $A$ as the fraction of inlet $A$ that exits the reactor as $B$ at steady state, $Y_B \\equiv C_B/C_{A,f}$. Determine a closed-form analytic expression for $Y_B$ in terms of $k_1$, $k_2$, $k_3$, and $\\tau$.\n\nExpress your final answer as a single closed-form analytic expression for $Y_B$. No numerical evaluation is required.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution. It represents a standard problem in chemical reaction engineering. Therefore, the problem is deemed valid and a solution will be derived from first principles.\n\nThe starting point is the general mole balance for a generic species $j$ in a Continuous Stirred-Tank Reactor (CSTR):\n$$ \\text{accumulation} = \\text{in} - \\text{out} + \\text{generation} $$\nFor a liquid-phase system with constant volume $V$, this can be expressed in terms of molar concentrations $C_j$:\n$$ V \\frac{dC_j}{dt} = F C_{j,in} - F C_{j,out} + R_j V $$\nwhere $F$ is the volumetric flow rate, $C_{j,in}$ is the inlet concentration of species $j$, $C_{j,out}$ is the outlet concentration, and $R_j$ is the net volumetric rate of formation of species $j$.\n\nThe reactor is well-mixed, which means the concentration inside the reactor is uniform and equal to the outlet concentration, $C_{j,out} = C_j$. The problem specifies steady-state operation, which means the accumulation term is zero, $\\frac{dC_j}{dt} = 0$. Dividing the mole balance by $F$ and introducing the residence time $\\tau \\equiv V/F$, the steady-state mole balance for species $j$ simplifies to:\n$$ 0 = C_{j,in} - C_j + \\tau R_j $$\n\nNext, we define the net rates of formation $R_j$ for each species ($A, B, C, D$) based on the given first-order reaction network:\n1. $ A \\xrightarrow{k_1} B $, with rate $r_1 = k_1 C_A$\n2. $ A \\xrightarrow{k_2} C $, with rate $r_2 = k_2 C_A$\n3. $ B \\xrightarrow{k_3} D $, with rate $r_3 = k_3 C_B$\n\nThe net rate of formation for each species is the sum of the rates of the reactions that produce it minus the sum of the rates of the reactions that consume it.\nFor species $A$: $A$ is consumed in reactions $1$ and $2$.\n$$ R_A = -r_1 - r_2 = -k_1 C_A - k_2 C_A = -(k_1 + k_2)C_A $$\nFor species $B$: $B$ is formed in reaction $1$ and consumed in reaction $3$.\n$$ R_B = r_1 - r_3 = k_1 C_A - k_3 C_B $$\nFor species $C$: $C$ is formed in reaction $2$.\n$$ R_C = r_2 = k_2 C_A $$\nFor species $D$: $D$ is formed in reaction $3$.\n$$ R_D = r_3 = k_3 C_B $$\n\nNow, we apply the steady-state mole balance to each species. The feed contains only species $A$, so $C_{A,in} = C_{A,f}$ and $C_{B,in} = C_{C,in} = C_{D,in} = 0$.\n\n**Species A:**\n$$ 0 = C_{A,f} - C_A + \\tau R_A $$\n$$ 0 = C_{A,f} - C_A + \\tau(-(k_1 + k_2)C_A) $$\n$$ C_{A,f} = C_A + \\tau(k_1 + k_2)C_A $$\n$$ C_{A,f} = C_A (1 + \\tau(k_1 + k_2)) $$\nSolving for the steady-state outlet concentration of $A$, $C_A$:\n$$ C_A = \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} $$\n\n**Species B:**\n$$ 0 = C_{B,in} - C_B + \\tau R_B $$\n$$ 0 = 0 - C_B + \\tau(k_1 C_A - k_3 C_B) $$\n$$ C_B = \\tau k_1 C_A - \\tau k_3 C_B $$\n$$ C_B(1 + \\tau k_3) = \\tau k_1 C_A $$\nSolving for $C_B$ in terms of $C_A$:\n$$ C_B = \\frac{\\tau k_1 C_A}{1 + \\tau k_3} $$\nSubstituting the expression for $C_A$:\n$$ C_B = \\frac{\\tau k_1}{1 + \\tau k_3} \\left( \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} \\right) = \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\n\n**Species C:**\n$$ 0 = C_{C,in} - C_C + \\tau R_C $$\n$$ 0 = 0 - C_C + \\tau(k_2 C_A) $$\n$$ C_C = \\tau k_2 C_A $$\nSubstituting the expression for $C_A$:\n$$ C_C = \\tau k_2 \\left( \\frac{C_{A,f}}{1 + \\tau(k_1 + k_2)} \\right) = \\frac{\\tau k_2 C_{A,f}}{1 + \\tau(k_1 + k_2)} $$\n\n**Species D:**\n$$ 0 = C_{D,in} - C_D + \\tau R_D $$\n$$ 0 = 0 - C_D + \\tau(k_3 C_B) $$\n$$ C_D = \\tau k_3 C_B $$\nSubstituting the expression for $C_B$:\n$$ C_D = \\tau k_3 \\left( \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} \\right) = \\frac{\\tau^2 k_1 k_3 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\n\nThe problem asks for an expression for the yield of $B$ on $A$, defined as $Y_B \\equiv C_B/C_{A,f}$. We use the derived expression for $C_B$:\n$$ Y_B = \\frac{C_B}{C_{A,f}} = \\frac{1}{C_{A,f}} \\left( \\frac{\\tau k_1 C_{A,f}}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} \\right) $$\nCanceling the $C_{A,f}$ term, we obtain the final closed-form expression for the yield of $B$:\n$$ Y_B = \\frac{\\tau k_1}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))} $$\nThis expression is in terms of the specified parameters $k_1$, $k_2$, $k_3$, and $\\tau$.",
            "answer": "$$\\boxed{\\frac{\\tau k_1}{(1 + \\tau k_3)(1 + \\tau(k_1 + k_2))}}$$"
        },
        {
            "introduction": "While steady-state operation is often the goal, understanding a reactor's transient behavior during startup, shutdown, or process upsets is essential for safe and efficient design. This exercise moves beyond the algebraic equations of steady state to the realm of ordinary differential equations to model the dynamic evolution of conversion during a CSTR startup . Solving this problem will provide direct insight into the characteristic time required for a reactor to reach its design operating point, a key consideration in process control and operations.",
            "id": "3874624",
            "problem": "Consider a perfectly mixed Continuous Stirred-Tank Reactor (CSTR) performing an isothermal, first-order liquid-phase reaction of species $A$ to products with rate law $r_{A} = -k C_{A}$, where $k$ is the reaction rate constant and $C_{A}$ is the concentration of species $A$ in the reactor. A feed of constant volumetric flow rate $F$ and inlet concentration $C_{A,0}$ is initiated at time $t = 0$ into an initially empty vessel. The reactor volume is controlled as follows: the outlet remains closed during the filling phase until the liquid volume reaches its design value $V$ at time $t = \\tau$, where the nominal residence time is defined as $\\tau = V/F$. At $t = \\tau$, the outlet is opened and the reactor is operated at constant volume $V$ thereafter with equal inlet and outlet flow rates.\n\nStarting from fundamental species balances and the definition of conversion $X(t) = 1 - \\frac{C_{A}(t)}{C_{A,0}}$, derive, in closed form, the time $t$ at which the instantaneous conversion $X(t)$ first equals a specified fraction $\\alpha$ of the steady-state conversion $X_{\\mathrm{ss}}$ obtained under constant-volume operation. Use the inlet concentration $C_{A,0}$ symbolically and assume constant density and perfect mixing at all times. Then, evaluate this time for the case $\\alpha = 0.95$, $\\tau = 200\\,\\mathrm{s}$, and $k = 0.01\\,\\mathrm{s}^{-1}$.\n\nRound your final numerical answer to four significant figures and express the time in seconds.",
            "solution": "The problem requires the derivation of the time $t$ at which the conversion in a CSTR undergoing a specific startup procedure reaches a fraction $\\alpha$ of its final steady-state value. The solution is partitioned into two time domains: a filling phase ($0 \\le t \\le \\tau$) and a constant-volume operation phase ($t > \\tau$).\n\nThe fundamental principle is the species mole balance for reactant $A$:\n$$\n\\text{Rate of Moles In} - \\text{Rate of Moles Out} + \\text{Rate of Moles Generated} = \\text{Rate of Moles Accumulated}\n$$\nIn symbolic terms, for a species $A$ with molar flow rates $F_{A,0}$ (in) and $F_A$ (out), reaction rate $r_A$, and reactor volume $V(t)$:\n$$\nF_{A,0} - F_A + r_A V(t) = \\frac{dN_A}{dt}\n$$\nGiven a liquid-phase reaction with constant volumetric flow rate $F$ and constant density, this can be expressed in terms of concentrations $C_A$: $F_{A,0} = F C_{A,0}$, $F_A = F C_A$, and $N_A = C_A V(t)$. The balance becomes:\n$$\nF C_{A,0} - F C_A + r_A V(t) = \\frac{d(C_A V(t))}{dt}\n$$\nThe reaction is first-order with rate law $r_A = -k C_A$.\n\n**Phase 1: Filling Period ($0 \\le t \\le \\tau$)**\n\nDuring this phase, the reactor is filling, so the volume is a function of time, $V(t) = F t$. The outlet is closed, so the outlet flow rate is zero ($F_A = 0$). The species balance equation is:\n$$\nF C_{A,0} + (-k C_A) (F t) = \\frac{d(C_A F t)}{dt}\n$$\nDividing by the constant $F$ and applying the product rule to the right-hand side gives:\n$$\nC_{A,0} - k t C_A = \\frac{d(C_A t)}{dt} = t \\frac{dC_A}{dt} + C_A\n$$\nRearranging this into the standard form of a first-order linear ordinary differential equation (ODE):\n$$\nt \\frac{dC_A}{dt} + (1 + k t) C_A = C_{A,0}\n$$\nor\n$$\n\\frac{dC_A}{dt} + \\left(\\frac{1}{t} + k\\right) C_A = \\frac{C_{A,0}}{t}\n$$\nAt time $t=0$, the reactor is empty. The very first element of fluid entering the tank has concentration $C_{A,0}$. Since the volume is initially zero, no reaction can have occurred. Thus, the initial condition is $C_A(t \\to 0^+) = C_{A,0}$. The integrating factor for this ODE is $I(t) = \\exp\\left(\\int \\left(\\frac{1}{t} + k\\right) dt\\right) = \\exp(\\ln(t) + kt) = t \\exp(kt)$.\nMultiplying the ODE by $I(t)$:\n$$\n\\frac{d}{dt}(C_A \\cdot t \\exp(kt)) = \\frac{C_{A,0}}{t} \\cdot t \\exp(kt) = C_{A,0} \\exp(kt)\n$$\nIntegrating with respect to time from $0$ to $t$:\n$$\n\\int_{0}^{t} d(C_A(s) \\cdot s \\exp(ks)) = C_A(t) \\cdot t \\exp(kt) - \\lim_{s \\to 0^+} (C_A(s) \\cdot s \\exp(ks)) = \\int_{0}^{t} C_{A,0} \\exp(ks) ds\n$$\nThe limit term on the left is zero since $s \\to 0$ and $C_A(s)$ approaches a finite value $C_{A,0}$. The integral on the right is $\\frac{C_{A,0}}{k}(\\exp(kt) - 1)$.\n$$\nC_A(t) \\cdot t \\exp(kt) = \\frac{C_{A,0}}{k}(\\exp(kt) - 1)\n$$\nSolving for $C_A(t)$ for the filling phase ($0 \\le t \\le \\tau$):\n$$\nC_{A,1}(t) = \\frac{C_{A,0}}{kt} (1 - \\exp(-kt))\n$$\nAt the end of the filling phase, $t = \\tau$, the concentration is:\n$$\nC_A(\\tau) = \\frac{C_{A,0}}{k\\tau} (1 - \\exp(-k\\tau))\n$$\n\n**Phase 2: Constant-Volume Operation ($t > \\tau$)**\n\nFor $t > \\tau$, the reactor volume is constant at $V$, and the inlet and outlet flow rates are equal to $F$. The species balance becomes:\n$$\nF C_{A,0} - F C_A - k C_A V = V \\frac{dC_A}{dt}\n$$\nDividing by $V$ and using the definition of residence time $\\tau = V/F$:\n$$\n\\frac{1}{\\tau} C_{A,0} - \\frac{1}{\\tau} C_A - k C_A = \\frac{dC_A}{dt}\n$$\nRearranging gives the ODE:\n$$\n\\frac{dC_A}{dt} + \\left(\\frac{1}{\\tau} + k\\right) C_A = \\frac{C_{A,0}}{\\tau}\n$$\nThis is a linear first-order ODE with constant coefficients. The solution is the sum of a transient and a steady-state part. The steady-state concentration, $C_{A,\\mathrm{ss}}$, is found by setting $\\frac{dC_A}{dt} = 0$:\n$$\n\\left(\\frac{1}{\\tau} + k\\right) C_{A,\\mathrm{ss}} = \\frac{C_{A,0}}{\\tau} \\implies C_{A,\\mathrm{ss}} = \\frac{C_{A,0}/\\tau}{1/\\tau + k} = \\frac{C_{A,0}}{1 + k\\tau}\n$$\nThe solution for $C_A(t)$ for $t > \\tau$ is of the form $C_A(t) = C_{A,\\mathrm{ss}} + B \\exp\\left(-\\left(\\frac{1}{\\tau}+k\\right)(t-\\tau)\\right)$, where $B$ is a constant determined by the initial condition for this phase, which is $C_A(\\tau)$ from Phase 1.\nAt $t=\\tau$, $C_A(\\tau) = C_{A,\\mathrm{ss}} + B$. Thus, $B = C_A(\\tau) - C_{A,\\mathrm{ss}}$.\nThe concentration profile for $t > \\tau$ is:\n$$\nC_{A,2}(t) = C_{A,\\mathrm{ss}} + (C_A(\\tau) - C_{A,\\mathrm{ss}}) \\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right)\n$$\n\n**Determining the Target Time**\n\nThe goal is to find the time $t$ at which the conversion $X(t) = 1 - \\frac{C_A(t)}{C_{A,0}}$ equals a fraction $\\alpha$ of the steady-state conversion $X_{\\mathrm{ss}}$.\nFirst, the steady-state conversion is:\n$$\nX_{\\mathrm{ss}} = 1 - \\frac{C_{A,\\mathrm{ss}}}{C_{A,0}} = 1 - \\frac{1}{1+k\\tau} = \\frac{k\\tau}{1+k\\tau}\n$$\nThe target conversion is $X_{\\text{target}} = \\alpha X_{\\mathrm{ss}} = \\alpha \\frac{k\\tau}{1+k\\tau}$.\nThis corresponds to a target concentration $C_{A,\\text{target}}$:\n$$\n1 - \\frac{C_{A,\\text{target}}}{C_{A,0}} = \\alpha \\frac{k\\tau}{1+k\\tau} \\implies \\frac{C_{A,\\text{target}}}{C_{A,0}} = 1 - \\alpha \\frac{k\\tau}{1+k\\tau}\n$$\nWe must determine if this conversion is reached during Phase 1 or Phase 2. We evaluate the conversion at $t=\\tau$:\n$X(\\tau) = 1 - \\frac{C_A(\\tau)}{C_{A,0}} = 1 - \\frac{1 - \\exp(-k\\tau)}{k\\tau}$.\nUsing the given values: $\\tau=200\\,\\mathrm{s}$, $k=0.01\\,\\mathrm{s}^{-1}$, $\\alpha=0.95$.\nThe Damköhler number is $k\\tau = (0.01\\,\\mathrm{s}^{-1})(200\\,\\mathrm{s}) = 2$.\n$X_{\\mathrm{ss}} = \\frac{2}{1+2} = \\frac{2}{3}$.\n$X_{\\text{target}} = 0.95 \\times \\frac{2}{3} = \\frac{1.9}{3} \\approx 0.6333$.\n$X(\\tau) = 1 - \\frac{1 - \\exp(-2)}{2} \\approx 1 - \\frac{1-0.1353}{2} = 1 - 0.4323 = 0.5677$.\nSince $X_{\\text{target}} > X(\\tau)$, the target conversion is reached in Phase 2 ($t > \\tau$).\n\nWe solve for $t$ by setting $C_{A,2}(t) = C_{A,\\text{target}}$:\n$$\nC_{A,\\text{target}} = C_{A,\\mathrm{ss}} + (C_A(\\tau) - C_{A,\\mathrm{ss}}) \\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right)\n$$\nDividing by $C_{A,0}$ and rearranging to solve for the exponential term:\n$$\n\\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right) = \\frac{C_{A,\\text{target}} - C_{A,\\mathrm{ss}}}{C_A(\\tau) - C_{A,\\mathrm{ss}}} = \\frac{C_{A,\\text{target}}/C_{A,0} - C_{A,\\mathrm{ss}}/C_{A,0}}{C_A(\\tau)/C_{A,0} - C_{A,\\mathrm{ss}}/C_{A,0}}\n$$\nSubstituting the expressions for the concentration ratios:\nNumerator: $\\left(1 - \\alpha \\frac{k\\tau}{1+k\\tau}\\right) - \\frac{1}{1+k\\tau} = \\frac{1+k\\tau - \\alpha k\\tau - 1}{1+k\\tau} = \\frac{(1-\\alpha)k\\tau}{1+k\\tau}$.\nDenominator: $\\frac{1 - \\exp(-k\\tau)}{k\\tau} - \\frac{1}{1+k\\tau} = \\frac{(1+k\\tau)(1-\\exp(-k\\tau)) - k\\tau}{k\\tau(1+k\\tau)} = \\frac{1 - (1+k\\tau)\\exp(-k\\tau)}{k\\tau(1+k\\tau)}$.\nThe ratio becomes:\n$$\n\\exp\\left(-\\frac{1+k\\tau}{\\tau}(t-\\tau)\\right) = \\frac{\\frac{(1-\\alpha)k\\tau}{1+k\\tau}}{\\frac{1 - (1+k\\tau)\\exp(-k\\tau)}{k\\tau(1+k\\tau)}} = \\frac{(1-\\alpha)(k\\tau)^2}{1 - (1+k\\tau)\\exp(-k\\tau)}\n$$\nTaking the natural logarithm and solving for $t$:\n$$\n-\\frac{1+k\\tau}{\\tau}(t-\\tau) = \\ln\\left(\\frac{(1-\\alpha)(k\\tau)^2}{1 - (1+k\\tau)\\exp(-k\\tau)}\\right)\n$$\n$$\nt-\\tau = -\\frac{\\tau}{1+k\\tau} \\ln\\left(\\frac{(1-\\alpha)(k\\tau)^2}{1 - (1+k\\tau)\\exp(-k\\tau)}\\right)\n$$\nUsing $\\ln(1/x) = -\\ln(x)$:\n$$\nt = \\tau + \\frac{\\tau}{1+k\\tau} \\ln\\left(\\frac{1 - (1+k\\tau)\\exp(-k\\tau)}{(1-\\alpha)(k\\tau)^2}\\right)\n$$\nThis is the final closed-form expression for the time $t$.\n\n**Numerical Evaluation**\n\nWe substitute the given values: $\\alpha = 0.95$, $\\tau = 200\\,\\mathrm{s}$, and $k\\tau=2$.\n$$\nt = 200 + \\frac{200}{1+2} \\ln\\left(\\frac{1 - (1+2)\\exp(-2)}{(1-0.95)(2)^2}\\right)\n$$\n$$\nt = 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 3\\exp(-2)}{0.05 \\times 4}\\right)\n$$\n$$\nt = 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 3\\exp(-2)}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 3(0.135335)}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln\\left(\\frac{1 - 0.406005}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln\\left(\\frac{0.593995}{0.2}\\right)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} \\ln(2.969975)\n$$\n$$\nt \\approx 200 + \\frac{200}{3} (1.08856)\n$$\n$$\nt \\approx 200 + 72.5707\n$$\n$$\nt \\approx 272.5707\\,\\mathrm{s}\n$$\nRounding to four significant figures, the time is $272.6\\,\\mathrm{s}$.",
            "answer": "$$\n\\boxed{272.6}\n$$"
        },
        {
            "introduction": "Most chemical reactions involve significant heat effects, making non-isothermal reactor modeling a critical topic with profound implications for safety and stability. This final practice explores the coupled, non-linear mass and energy balances that govern a non-isothermal CSTR, where the reaction rate's exponential dependence on temperature via the Arrhenius equation often leads to complex behaviors . Because these systems rarely have analytical solutions, this problem guides you through a computational approach to find the steady-state operating point and perform a sensitivity analysis, revealing how susceptible the reactor temperature is to changes in process parameters.",
            "id": "3874662",
            "problem": "Consider a nonisothermal Continuous Stirred-Tank Reactor (CSTR) with a single irreversible first-order reaction converting species $A$ to $B$ in a liquid phase. The reactor operates at steady state with volumetric feed flow rate $F$ and overall heat transfer parameter $U A$, where $U$ is the overall heat transfer coefficient and $A$ is the heat exchange area. The reactor contents are perfectly mixed, the density is constant, and the specific heat capacity is constant. The feed concentration of $A$ is $C_{A f}$ and the feed temperature is $T_f$. The coolant (external to the reactor) is at temperature $T_c$. The reactor volume is $V$. The reaction rate constant follows the Arrhenius law $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$, where $k_0$ is the pre-exponential factor, $E$ is the activation energy, and $R$ is the Universal Gas Constant. The heat of reaction is $\\Delta H$ and is negative for an exothermic reaction.\n\nStart from the fundamental mass balance for species $A$ and the energy balance for the reactor:\n- Mass balance for species $A$ (steady state): \n$$0 = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A.$$\n- Energy balance (steady state):\n$$0 = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right),$$\nwhere $\\rho$ is the fluid density and $C_p$ is the specific heat capacity at constant pressure.\n\nDefine the residual vector $\\mathbf{R}(\\mathbf{x}, \\mathbf{p})$ with $\\mathbf{x} = \\begin{bmatrix} C_A \\\\ T \\end{bmatrix}$ and parameters $\\mathbf{p} = \\begin{bmatrix} U A \\\\ F \\end{bmatrix}$:\n$$R_1(C_A, T; U A, F) = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A,$$\n$$R_2(C_A, T; U A, F) = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right).$$\nA steady state satisfies $\\mathbf{R}(\\mathbf{x}^*, \\mathbf{p}) = \\mathbf{0}$.\n\nYour tasks:\n1. Solve the steady-state nonlinear system $\\mathbf{R}(\\mathbf{x}^*, \\mathbf{p}) = \\mathbf{0}$ for $\\mathbf{x}^* = \\begin{bmatrix} C_A^* \\\\ T^* \\end{bmatrix}$ using a Newton-type method initialized at $T^{(0)} = T_f + 100\\,\\mathrm{K}$ and $C_A^{(0)} = 0.5\\,C_{A f}$. The physically meaningful solution must satisfy $C_A^* \\ge 0$ and $T^* > 0$.\n2. Derive the sensitivity of the steady-state temperature $T^*$ with respect to $U A$ and $F$ using the implicit function theorem. Let the Jacobian of the residuals with respect to the state be \n$$\\mathbf{J}_x = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial C_A} & \\dfrac{\\partial R_1}{\\partial T} \\\\\n\\dfrac{\\partial R_2}{\\partial C_A} & \\dfrac{\\partial R_2}{\\partial T}\n\\end{bmatrix},$$\nand the partial derivatives of the residuals with respect to parameters be \n$$\\mathbf{J}_{U A} = \\begin{bmatrix}\\dfrac{\\partial R_1}{\\partial (U A)} \\\\ \\dfrac{\\partial R_2}{\\partial (U A)} \\end{bmatrix}, \\qquad\n\\mathbf{J}_{F} = \\begin{bmatrix}\\dfrac{\\partial R_1}{\\partial F} \\\\ \\dfrac{\\partial R_2}{\\partial F} \\end{bmatrix}.$$\nUsing $\\dfrac{d \\mathbf{x}^*}{d p} = - \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{p}$, extract $\\dfrac{d T^*}{d (U A)}$ and $\\dfrac{d T^*}{d F}$. To avoid unit dependence, report the dimensionless normalized sensitivities\n$$S_{U A} = \\dfrac{U A}{T^*}\\,\\dfrac{d T^*}{d (U A)}, \\qquad S_{F} = \\dfrac{F}{T^*}\\,\\dfrac{d T^*}{d F}.$$\n3. Identify regimes where small parameter changes lead to large temperature shifts by checking the conditions $\\left|S_{U A}\\right| > 1$ and $\\left|S_{F}\\right| > 1$. A regime is classified as “large-shift” with respect to a parameter if a $1$ percent change in the parameter produces more than a $1$ percent change in $T^*$, i.e., the corresponding normalized sensitivity magnitude exceeds $1$.\n4. For numerical robustness, if $\\mathbf{J}_x$ is ill-conditioned, use a least-squares solution to compute $\\dfrac{d \\mathbf{x}^*}{d p}$.\n\nUse the following fixed constants and units throughout:\n- $V = 1.0\\,\\mathrm{m}^3$,\n- $\\rho = 1000\\,\\mathrm{kg/m}^3$,\n- $C_p = 4180\\,\\mathrm{J/(kg\\cdot K)}$,\n- $\\Delta H = -1.2\\times 10^{5}\\,\\mathrm{J/mol}$,\n- $k_0 = 7.2\\times 10^{10}\\,\\mathrm{s}^{-1}$,\n- $E = 8.314\\times 10^{4}\\,\\mathrm{J/mol}$,\n- $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$,\n- $C_{A f} = 2500\\,\\mathrm{mol/m}^3$,\n- $T_f = 300\\,\\mathrm{K}$,\n- $T_c = 290\\,\\mathrm{K}$.\n\nTest suite (each case is a pair $(U A, F)$):\n- Case $1$ (happy path): $U A = 5000\\,\\mathrm{W/K}$, $F = 1.0\\times 10^{-3}\\,\\mathrm{m}^3/\\mathrm{s}$.\n- Case $2$ (low removal and low flow, near potential thermal sensitivity): $U A = 200\\,\\mathrm{W/K}$, $F = 1.0\\times 10^{-4}\\,\\mathrm{m}^3/\\mathrm{s}$.\n- Case $3$ (high removal and higher flow): $U A = 15000\\,\\mathrm{W/K}$, $F = 3.0\\times 10^{-3}\\,\\mathrm{m}^3/\\mathrm{s}$.\n\nYour program must, for each test case, compute the steady-state temperature $T^*$ in $\\mathrm{K}$, the normalized sensitivities $S_{U A}$ and $S_{F}$ (dimensionless), and the boolean indicators for large-shift regimes with respect to $U A$ and $F$. The final output must be a single line containing a list of lists, one per test case, each inner list in the order $\\left[T^*, S_{U A}, S_{F}, \\text{large\\_UA}, \\text{large\\_F}\\right]$, where $\\text{large\\_UA}$ and $\\text{large\\_F}$ are booleans. Express $T^*$ in $\\mathrm{K}$, rounded to six decimal places, and $S_{U A}$ and $S_{F}$ rounded to six decimal places. The final output format must be exactly:\n$$\\text{[}[T_1^*, S_{U A,1}, S_{F,1}, \\text{large\\_UA}_1, \\text{large\\_F}_1], [T_2^*, S_{U A,2}, S_{F,2}, \\text{large\\_UA}_2, \\text{large\\_F}_2], [T_3^*, S_{U A,3}, S_{F,3}, \\text{large\\_UA}_3, \\text{large\\_F}_3]\\text{]}.$$\nNo other text should be printed.",
            "solution": "We begin from the fundamental mass and energy balances for a Continuous Stirred-Tank Reactor (CSTR) at steady state. The governing residual equations for species $A$ and temperature are\n$$R_1(C_A, T; U A, F) = \\dfrac{F}{V}\\left(C_{A f} - C_A\\right) - k(T)\\,C_A,$$\n$$R_2(C_A, T; U A, F) = \\dfrac{F}{V}\\left(T_f - T\\right) + \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T)\\,C_A - \\dfrac{U A}{\\rho C_p V}\\left(T - T_c\\right),$$\nwith $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$. A steady state satisfies $R_1 = 0$ and $R_2 = 0$ simultaneously.\n\nStep $1$ (steady-state computation): We solve the nonlinear system $\\mathbf{R}(\\mathbf{x}, \\mathbf{p}) = \\mathbf{0}$ with $\\mathbf{x} = \\begin{bmatrix} C_A \\\\ T \\end{bmatrix}$ and $\\mathbf{p} = \\begin{bmatrix} U A \\\\ F \\end{bmatrix}$. We use a Newton-type method (for example, a hybrid Powell-type method) initialized at $T^{(0)} = T_f + 100\\,\\mathrm{K}$ and $C_A^{(0)} = 0.5\\,C_{A f}$, and accept the solution that yields $C_A \\ge 0$ and $T > 0$. For numerical robustness, one can attempt multiple initial guesses if the solver fails to converge and select the feasible solution minimizing the residual norm $\\left\\|\\mathbf{R}\\right\\|_2$.\n\nStep $2$ (sensitivities via implicit function theorem): Define the Jacobian of residuals with respect to the state variables,\n$$\\mathbf{J}_x = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial C_A} & \\dfrac{\\partial R_1}{\\partial T} \\\\\n\\dfrac{\\partial R_2}{\\partial C_A} & \\dfrac{\\partial R_2}{\\partial T}\n\\end{bmatrix},$$\ncomputed at the steady state $(C_A^*, T^*)$. We first compute the necessary derivatives. Let $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$ and note that\n$$\\dfrac{d k}{d T} = k(T)\\,\\dfrac{E}{R T^2}.$$\nUsing $r = k(T)\\,C_A$, we have\n$$\\dfrac{\\partial R_1}{\\partial C_A} = -\\dfrac{F}{V} - k(T),$$\n$$\\dfrac{\\partial R_1}{\\partial T} = -C_A\\,\\dfrac{d k}{d T} = -C_A\\,k(T)\\,\\dfrac{E}{R T^2},$$\n$$\\dfrac{\\partial R_2}{\\partial C_A} = \\dfrac{-\\Delta H}{\\rho C_p}\\,k(T),$$\n$$\\dfrac{\\partial R_2}{\\partial T} = -\\dfrac{F}{V} + \\dfrac{-\\Delta H}{\\rho C_p}\\,C_A\\,\\dfrac{d k}{d T} - \\dfrac{U A}{\\rho C_p V}\n= -\\dfrac{F}{V} + \\dfrac{-\\Delta H}{\\rho C_p}\\,C_A\\,k(T)\\,\\dfrac{E}{R T^2} - \\dfrac{U A}{\\rho C_p V}.$$\nNext, the residual derivatives with respect to parameters $U A$ and $F$ are\n$$\\mathbf{J}_{U A} = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial (U A)} \\\\\n\\dfrac{\\partial R_2}{\\partial (U A)}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 \\\\\n-\\dfrac{1}{\\rho C_p V}\\left(T - T_c\\right)\n\\end{bmatrix},$$\n$$\\mathbf{J}_{F} = \\begin{bmatrix}\n\\dfrac{\\partial R_1}{\\partial F} \\\\\n\\dfrac{\\partial R_2}{\\partial F}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\dfrac{1}{V}\\left(C_{A f} - C_A\\right) \\\\\n\\dfrac{1}{V}\\left(T_f - T\\right)\n\\end{bmatrix}.$$\nBy the implicit function theorem, for a nonsingular $\\mathbf{J}_x$, the steady state $\\mathbf{x}^*$ varies smoothly with parameters and\n$$\\dfrac{d \\mathbf{x}^*}{d p} = - \\mathbf{J}_x^{-1}\\,\\mathbf{J}_p,$$\nwhere $p$ is either $U A$ or $F$. Extract the second component to obtain\n$$\\dfrac{d T^*}{d (U A)} = \\left(- \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{U A}\\right)_2, \\qquad \\dfrac{d T^*}{d F} = \\left(- \\mathbf{J}_x^{-1}\\,\\mathbf{J}_{F}\\right)_2.$$\nTo provide unit-independent measures, define the normalized sensitivities\n$$S_{U A} = \\dfrac{U A}{T^*}\\,\\dfrac{d T^*}{d (U A)}, \\qquad S_{F} = \\dfrac{F}{T^*}\\,\\dfrac{d T^*}{d F}.$$\n\nStep $3$ (classification of large-shift regimes): A regime exhibits large temperature response to small parameter changes if $\\left|S_{U A}\\right| > 1$ for $U A$ or $\\left|S_F\\right| > 1$ for $F$. These thresholds correspond to a $1$ percent change in the parameter inducing more than a $1$ percent change in $T^*$.\n\nStep $4$ (numerical robustness): If $\\mathbf{J}_x$ is ill-conditioned or nearly singular, directly inverting it can be unstable. In such cases, solve the linear system $\\mathbf{J}_x\\,\\dfrac{d \\mathbf{x}^*}{d p} = -\\mathbf{J}_p$ in a least-squares sense using a pseudoinverse or a robust solver to compute sensitivities.\n\nAlgorithmic design:\n- Implement $k(T)$ and $\\dfrac{d k}{d T}$ per Arrhenius law.\n- Set up the residual functions $R_1$ and $R_2$ using the provided constants and inputs $(U A, F)$.\n- Use a root-finding algorithm initialized at $T^{(0)} = T_f + 100\\,\\mathrm{K}$ and $C_A^{(0)} = 0.5\\,C_{A f}$; if the solver fails or yields nonphysical values, retry with alternative feasible initial guesses and pick the solution with the smallest residual norm subject to $C_A \\ge 0$ and $T > 0$.\n- Compute $\\mathbf{J}_x$ analytically at the solution and form $\\mathbf{J}_{U A}$ and $\\mathbf{J}_F$.\n- Solve for $\\dfrac{d \\mathbf{x}^*}{d (U A)}$ and $\\dfrac{d \\mathbf{x}^*}{d F}$ using linear solvers; if $\\mathbf{J}_x$ is ill-conditioned, use a least-squares solver.\n- Form $S_{U A}$ and $S_F$, apply the large-shift threshold, and round $T^*$, $S_{U A}$, and $S_F$ to six decimal places.\n- Repeat for each test case and print a single line with the list of results in the specified format.\n\nThis approach directly ties reactor thermal behavior to physical laws (mass and energy balances) and the Arrhenius dependence, reveals how the Jacobian structure controls sensitivity, and identifies parameter regimes near operational boundaries where small perturbations can cause large temperature shifts.",
            "answer": "[[429.575026, -0.061763, 0.059293, False, False], [498.056712, -10.98226, 9.888764, True, True], [323.003186, -0.279768, 0.222718, False, False]]"
        }
    ]
}