{
    "hands_on_practices": [
        {
            "introduction": "本练习将带你回到分子轨道理论的数学核心。我们将通过一个简化的双原子吸附模型，从第一性原理出发求解广义本征值问题。这个实践的关键在于处理非正交的原子轨道基组，这比教科书中常见的零重叠假设更接近于量子化学计算的实际情况，它将帮助你深入理解分子轨道的能量和系数是如何从原子轨道的相互作用中产生的。",
            "id": "3872759",
            "problem": "考虑一个用于计算催化领域的双原子吸附片段的最小原子轨道线性组合（LCAO）描述，该模型由位于相邻位点上的两个相互作用的类氢 $1s$ 轨道 $|A\\rangle$ 和 $|B\\rangle$ 构成。该基组是非正交的，其重叠积分为 $S_{AA}=S_{BB}=1$ 和 $S_{AB}=S_{BA}=S$，其中 $0  S  1$。在此基组中，单电子哈密顿矩阵元为 $H_{AA}=H_{BB}=\\alpha$ 和 $H_{AB}=H_{BA}=\\beta$，其中 $\\beta$ 代表位点间的耦合。假设体系为闭壳层体系，自旋简并度为 $2$，并在非正交基下使用 Rayleigh–Ritz 变分原理，这导出了广义本征值问题 $H\\,\\mathbf{c}=\\epsilon\\,S\\,\\mathbf{c}$。\n\n任务：\n- 从广义本征值问题 $H\\,\\mathbf{c}=\\epsilon\\,S\\,\\mathbf{c}$ 出发，确定两个分子轨道（MO）的能量以及在非正交基下的相应归一化展开系数。\n- 将此双轨道体系中 $A$ 和 $B$ 之间的 Mulliken 键级定义为 $BO_{AB}=P_{AB}\\,S_{AB}$，其中密度矩阵元为 $P_{AB}=2\\sum_{i} f(\\epsilon_{i})\\,c_{A i}\\,c_{B i}$，求和遍及由 $i\\in\\{- , +\\}$ 索引的两个分子轨道，$c_{\\mu i}$ 是分子轨道展开系数，$f(\\epsilon)$ 是 Fermi–Dirac 占据函数 $f(\\epsilon)=\\left(1+\\exp\\left(\\frac{\\epsilon-\\mu}{k_{B}T}\\right)\\right)^{-1}$，其中 $\\mu$ 为化学势，$k_{B}$ 为玻尔兹曼常数，$T$ 为温度。\n- 使用上述确定的量，获得 $BO_{AB}$ 的一个显式解析表达式，该表达式是关于 $S$、$\\alpha$、$\\beta$、$\\mu$ 和 $T$ 的函数。\n- 根据您的表达式，在 $f(\\epsilon_{-})\\approx 1$ 且 $f(\\epsilon_{+})\\approx 0$ 的情况下，定性讨论增加 $S$ 如何影响计算出的 $BO_{AB}$。\n\n将您的最终结果表示为 Mulliken 键级 $BO_{AB}(S,\\alpha,\\beta,\\mu,T)$ 的单个解析表达式。键级是无量纲的。无需进行数值计算或四舍五入。",
            "solution": "我们从非正交基下的 Rayleigh–Ritz 变分原理开始，它导出广义本征值问题 $H\\,\\mathbf{c}=\\epsilon\\,S\\,\\mathbf{c}$。在给定的双函数基 $\\{|A\\rangle,|B\\rangle\\}$ 中，哈密顿矩阵和重叠矩阵为\n$$\nH=\\begin{pmatrix}\n\\alpha  \\beta \\\\\n\\beta  \\alpha\n\\end{pmatrix},\\quad\nS=\\begin{pmatrix}\n1  S \\\\\nS  1\n\\end{pmatrix}.\n$$\n分子轨道系数 $\\mathbf{c}=(c_{A},c_{B})^{\\top}$ 和能量 $\\epsilon$ 满足\n$$\n\\left(H-\\epsilon\\,S\\right)\\mathbf{c}=\\mathbf{0}.\n$$\n非平庸解要求\n$$\n\\det\\!\\left(H-\\epsilon\\,S\\right)=0.\n$$\n具体地，\n$$\n\\det\\!\\begin{pmatrix}\n\\alpha-\\epsilon  \\beta-\\epsilon S \\\\\n\\beta-\\epsilon S  \\alpha-\\epsilon\n\\end{pmatrix}\n=(\\alpha-\\epsilon)^{2}-(\\beta-\\epsilon S)^{2}=0.\n$$\n因此，\n$$\n(\\alpha-\\epsilon)=\\pm\\,(\\beta-\\epsilon S).\n$$\n考虑以下两种情况：\n\n$1.$ 能量中取负号的情况（成键解）：\n$$\n\\alpha-\\epsilon=-(\\beta-\\epsilon S)\\;\\Rightarrow\\;\\alpha+\\beta=\\epsilon(1+S)\\;\\Rightarrow\\;\\epsilon_{-}=\\frac{\\alpha+\\beta}{1+S}.\n$$\n由 $(\\alpha-\\epsilon)c_{A}+(\\beta-\\epsilon S)c_{B}=0$ 和 $\\alpha-\\epsilon_{-}=-(\\beta-\\epsilon_{-}S)$，我们得到\n$$\n\\frac{c_{A}}{c_{B}}=\\frac{-(\\beta-\\epsilon_{-}S)}{\\alpha-\\epsilon_{-}}=1,\n$$\n因此对于成键分子轨道有 $c_{A}=c_{B}$。在非正交度规下进行归一化：\n$$\n\\mathbf{c}^{\\top}S\\,\\mathbf{c}=c_{A}^{2}S_{AA}+2c_{A}c_{B}S_{AB}+c_{B}^{2}S_{BB}=2c^{2}(1+S)=1\\quad\\Rightarrow\\quad c=\\frac{1}{\\sqrt{2(1+S)}}.\n$$\n因此，\n$$\nc_{A}^{(-)}=c_{B}^{(-)}=\\frac{1}{\\sqrt{2(1+S)}}.\n$$\n\n$2.$ 能量中取正号的情况（反键解）：\n$$\n\\alpha-\\epsilon=(\\beta-\\epsilon S)\\;\\Rightarrow\\;\\alpha-\\beta=\\epsilon(1-S)\\;\\Rightarrow\\;\\epsilon_{+}=\\frac{\\alpha-\\beta}{1-S}.\n$$\n由 $(\\alpha-\\epsilon)c_{A}+(\\beta-\\epsilon S)c_{B}=0$ 和 $\\alpha-\\epsilon_{+}=(\\beta-\\epsilon_{+}S)$，我们得到\n$$\n\\frac{c_{A}}{c_{B}}=\\frac{-(\\beta-\\epsilon_{+}S)}{\\alpha-\\epsilon_{+}}=-1,\n$$\n因此对于反键分子轨道有 $c_{A}=-c_{B}$。进行归一化：\n$$\n\\mathbf{c}^{\\top}S\\,\\mathbf{c}=c_{A}^{2}+2c_{A}c_{B}S+c_{B}^{2}=2c^{2}(1-S)=1\\quad\\Rightarrow\\quad c=\\frac{1}{\\sqrt{2(1-S)}}.\n$$\n因此，\n$$\nc_{A}^{(+)}=\\frac{1}{\\sqrt{2(1-S)}},\\quad c_{B}^{(+)}=-\\frac{1}{\\sqrt{2(1-S)}}.\n$$\n\n现在我们构建 $A$ 和 $B$ 之间的 Mulliken 键级。对于自旋简并度为 $2$ 的闭壳层体系，密度矩阵元为\n$$\nP_{AB}=2\\sum_{i\\in\\{-,+\\}} f(\\epsilon_{i})\\,c_{A i}\\,c_{B i},\n$$\n其中 Fermi–Dirac 占据数为\n$$\nf(\\epsilon)=\\frac{1}{1+\\exp\\left(\\frac{\\epsilon-\\mu}{k_{B}T}\\right)}.\n$$\n使用归一化系数，\n$$\nc_{A}^{(-)}c_{B}^{(-)}=\\frac{1}{2(1+S)},\\quad c_{A}^{(+)}c_{B}^{(+)}=-\\frac{1}{2(1-S)}.\n$$\n因此，\n$$\nP_{AB}=2\\left[f(\\epsilon_{-})\\cdot\\frac{1}{2(1+S)}+f(\\epsilon_{+})\\cdot\\left(-\\frac{1}{2(1-S)}\\right)\\right]\n=\\frac{f(\\epsilon_{-})}{1+S}-\\frac{f(\\epsilon_{+})}{1-S}.\n$$\n当 $S_{AB}=S$ 时，Mulliken 键级变为\n$$\nBO_{AB}=P_{AB}S=S\\left(\\frac{f(\\epsilon_{-})}{1+S}-\\frac{f(\\epsilon_{+})}{1-S}\\right).\n$$\n代入能量表达式，\n$$\n\\epsilon_{-}=\\frac{\\alpha+\\beta}{1+S},\\quad \\epsilon_{+}=\\frac{\\alpha-\\beta}{1-S},\n$$\n我们得到\n$$\nBO_{AB}(S,\\alpha,\\beta,\\mu,T)=S\\left(\\frac{1}{1+S}\\cdot\\frac{1}{1+\\exp\\left(\\frac{\\frac{\\alpha+\\beta}{1+S}-\\mu}{k_{B}T}\\right)}-\\frac{1}{1-S}\\cdot\\frac{1}{1+\\exp\\left(\\frac{\\frac{\\alpha-\\beta}{1-S}-\\mu}{k_{B}T}\\right)}\\right).\n$$\n\n对 $S$ 的定性依赖关系：在接近基态的典型成键情况下，$f(\\epsilon_{-})\\approx 1$ 且 $f(\\epsilon_{+})\\approx 0$。此时\n$$\nBO_{AB}\\approx S\\cdot\\frac{1}{1+S}=\\frac{S}{1+S},\n$$\n这是 $S$ 的一个单调递增函数，其导数为 $\\frac{\\partial}{\\partial S}\\left(\\frac{S}{1+S}\\right)=\\frac{1}{(1+S)^{2}}0$。因此，在这种情况下增加 $S$ 会增加计算出的 Mulliken 键级。在有限温度下，$f(\\epsilon_{+})0$，第二项会减小 $BO_{AB}$，但前因子结构仍然意味着，除非反键轨道占据占主导地位，否则较大的 $S$ 倾向于增强成键贡献。",
            "answer": "$$\\boxed{S\\left(\\frac{1}{1+S}\\cdot\\frac{1}{1+\\exp\\left(\\frac{\\frac{\\alpha+\\beta}{1+S}-\\mu}{k_{B}T}\\right)}-\\frac{1}{1-S}\\cdot\\frac{1}{1+\\exp\\left(\\frac{\\frac{\\alpha-\\beta}{1-S}-\\mu}{k_{B}T}\\right)}\\right)}$$"
        },
        {
            "introduction": "对称性是化学中一个极其强大的工具，它能大大简化我们对化学键的理解。在这个练习中，你将运用群论中的投影算符方法，为氨分子（$NH_3$）的配体轨道构建对称匹配的线性组合（SALCs）。通过这个实践，你将掌握一个核心技能：如何利用分子的对称性来预测哪些原子轨道之间可以发生有效的相互作用，从而在进行复杂的计算之前，就对分子轨道图的结构有一个定性的深刻认识。",
            "id": "3872783",
            "problem": "在计算催化和化学工程中，构建配体群轨道（ligand group orbitals）的对称性匹配线性组合（SALCs; symmetry-adapted linear combinations）为理解决定吸附、活化和键形成的轨道相互作用提供了严谨的基础。考虑氨分子 $NH_3$ 中的三个氢配体轨道，它们被模型化为三个分别位于每个氢原子上的归一化氢 $1s$ 函数 $\\{ \\phi_{1}, \\phi_{2}, \\phi_{3} \\}$。该分子被理想化为具有 $C_{3v}$ 对称性，其中氮原子位于 $C_{3}$ 轴的顶点，三个氢原子在垂直于 $C_{3}$ 轴的平面上形成一个等边三角形。假设集合 $\\{ \\phi_{i} \\}$ 是标准正交的，并且 $C_{3v}$ 的每个对称操作根据几何结构通过置换和/或固定这些基函数来作用。\n\n仅使用群论投影算符形式和应用于分子对称性的表示论核心定义，构建三个氢配体轨道的对称性匹配线性组合（SALCs），这些组合按照 $C_{3v}$ 的不可约表示进行变换。然后，基于氮价层轨道的变换性质，确定哪些氮原子轨道可以与每个 SALC 相互作用（即具有非零重叠和相容的对称性）。\n\n最后，以单个精确解析表达式的形式报告全对称 SALC（即按照 $A_{1}$ 不可约表示变换的那个）中每个配体轨道上的归一化系数。不需要四舍五入。给出最终答案时无需单位。",
            "solution": "问题要求为属于 $C_{3v}$ 点群的氨分子 ($NH_3$) 中的三个氢 $1s$ 轨道构建对称性匹配线性组合（SALCs）。基组被定义为三个标准正交的氢 $1s$ 轨道，$\\{\\phi_1, \\phi_2, \\phi_3\\}$。\n\n首先，我们必须确定在 $C_{3v}$ 群的对称操作下，基组 $\\{\\phi_1, \\phi_2, \\phi_3\\}$ 的变换所生成的可约表示 $\\Gamma_{3H}$。$C_{3v}$ 中的操作有 $E$ (恒等操作)、$2C_3$ (两次 $120^\\circ$ 旋转) 和 $3\\sigma_v$ (三个垂直镜面)。对于给定操作，表示的特征标是变换矩阵的迹，这可以简化为在该操作下保持不变的基函数的数量。\n\n设氢原子标记为 $H_1$、$H_2$ 和 $H_3$，它们各自的轨道为 $\\phi_1$、$\\phi_2$ 和 $\\phi_3$。\n-   在恒等操作 $\\hat{E}$ 下，所有三个轨道都保持原位：$\\hat{E}(\\phi_i) = \\phi_i$。未移动的轨道数为 $3$。因此，特征标 $\\chi(E) = 3$。\n-   在 $\\hat{C}_3$ 旋转操作下，所有三个氢原子都被置换：$\\hat{C}_3(\\phi_1) = \\phi_2$, $\\hat{C}_3(\\phi_2) = \\phi_3$, $\\hat{C}_3(\\phi_3) = \\phi_1$。没有轨道保留在原位。未移动的轨道数为 $0$。因此，$\\chi(C_3) = 0$。\n-   在 $\\hat{\\sigma}_v$ 反射操作下，镜面穿过氮原子和一个氢原子（例如 $H_1$），并平分另外两个氢原子（$H_2$ 和 $H_3$）之间的夹角。此操作使 $\\phi_1$ 保持原位，但交换 $\\phi_2$ 和 $\\phi_3$。未移动的轨道数为 $1$。因此，$\\chi(\\sigma_v) = 1$。\n\n因此，可约表示 $\\Gamma_{3H}$ 的特征标为：\n$$\n\\begin{array}{c|ccc}\n\\hline\nC_{3v}  E  2C_3  3\\sigma_v \\\\\n\\hline\n\\Gamma_{3H}  3  0  1 \\\\\n\\hline\n\\end{array}\n$$\n\n接下来，我们将 $\\Gamma_{3H}$ 分解为 $C_{3v}$ 群的不可约表示（irreps）的组合。$C_{3v}$ 的特征标表如下：\n$$\n\\begin{array}{c|ccc|l}\n\\hline\nC_{3v}  E  2C_3  3\\sigma_v  \\text{函数} \\\\\n\\hline\nA_1  1  1  1  z, z^2, x^2+y^2 \\\\\nA_2  1  1  -1  R_z \\\\\nE  2  -1  0  (x,y), (xz,yz), (x^2-y^2, xy) \\\\\n\\hline\n\\end{array}\n$$\n群的阶为 $h = 6$。不可约表示 $i$ 在可约表示中出现的次数 $a_i$ 由约化公式给出：\n$$ a_i = \\frac{1}{h} \\sum_R n_R \\cdot \\chi_{\\text{red}}(R) \\cdot \\chi_{\\text{irr}}^{(i)}(R) $$\n其中 $n_R$ 是类 $R$ 中操作的数量。\n\n对于 $A_1$ 不可约表示：\n$$ a_{A_1} = \\frac{1}{6} [(1)(3)(1) + (2)(0)(1) + (3)(1)(1)] = \\frac{1}{6}(3 + 0 + 3) = 1 $$\n对于 $A_2$ 不可约表示：\n$$ a_{A_2} = \\frac{1}{6} [(1)(3)(1) + (2)(0)(1) + (3)(1)(-1)] = \\frac{1}{6}(3 + 0 - 3) = 0 $$\n对于 $E$ 不可约表示：\n$$ a_{E} = \\frac{1}{6} [(1)(3)(2) + (2)(0)(-1) + (3)(1)(0)] = \\frac{1}{6}(6 + 0 + 0) = 1 $$\n因此，可约表示分解为 $\\Gamma_{3H} = A_1 + E$。这表明三个氢轨道将形成一个具有 $A_1$ 对称性的 SALC 和一对具有 $E$ 对称性的简并 SALC。\n\n现在我们使用投影算符 $\\hat{P}^{(i)} \\propto \\sum_R \\chi_{\\text{irr}}^{(i)}(R) \\hat{R}$ 来构建 SALC。我们将此算符应用于一个代表性的基函数 $\\phi_1$。\n\n对于 $A_1$ SALC：\n$$ \\hat{P}^{(A_1)}(\\phi_1) \\propto [1 \\cdot \\hat{E} + 1 \\cdot \\hat{C}_3 + 1 \\cdot \\hat{C}_3^2 + 1 \\cdot \\hat{\\sigma}_{v(1)} + 1 \\cdot \\hat{\\sigma}_{v(2)} + 1 \\cdot \\hat{\\sigma}_{v(3)}](\\phi_1) $$\n$$ \\hat{P}^{(A_1)}(\\phi_1) \\propto \\phi_1 + \\phi_2 + \\phi_3 + \\phi_1 + \\phi_3 + \\phi_2 = 2(\\phi_1 + \\phi_2 + \\phi_3) $$\n未归一化的 $A_1$ SALC 是 $\\Psi_{A_1, \\text{unnorm}} = \\phi_1 + \\phi_2 + \\phi_3$。\n为了将其归一化，我们使用条件 $\\langle \\Psi | \\Psi \\rangle = 1$。鉴于基函数的标准正交性 $\\langle \\phi_i | \\phi_j \\rangle = \\delta_{ij}$：\n$$ \\langle \\Psi_{A_1, \\text{unnorm}} | \\Psi_{A_1, \\text{unnorm}} \\rangle = \\langle \\phi_1 + \\phi_2 + \\phi_3 | \\phi_1 + \\phi_2 + \\phi_3 \\rangle = 1^2 + 1^2 + 1^2 = 3 $$\n归一化常数为 $N = 1/\\sqrt{3}$。归一化后的 $A_1$ SALC 是：\n$$ \\Psi_{A_1} = \\frac{1}{\\sqrt{3}}(\\phi_1 + \\phi_2 + \\phi_3) $$\n\n对于 $E$ SALCs：\n$$ \\hat{P}^{(E)}(\\phi_1) \\propto [2 \\cdot \\hat{E} - 1 \\cdot \\hat{C}_3 - 1 \\cdot \\hat{C}_3^2 + 0 \\cdot (\\text{reflections})](\\phi_1) $$\n$$ \\hat{P}^{(E)}(\\phi_1) \\propto 2\\hat{E}(\\phi_1) - \\hat{C}_3(\\phi_1) - \\hat{C}_3^2(\\phi_1) = 2\\phi_1 - \\phi_2 - \\phi_3 $$\n第一个未归一化的 $E$ SALC 是 $\\Psi_{Ea, \\text{unnorm}} = 2\\phi_1 - \\phi_2 - \\phi_3$。\n归一化：\n$$ \\langle \\Psi_{Ea, \\text{unnorm}} | \\Psi_{Ea, \\text{unnorm}} \\rangle = 2^2 + (-1)^2 + (-1)^2 = 6 $$\n归一化后的 SALC 是 $\\Psi_{Ea} = \\frac{1}{\\sqrt{6}}(2\\phi_1 - \\phi_2 - \\phi_3)$。\n\n为了找到第二个正交的 $E$ 对称性 SALC，我们可以将投影算符应用于另一个基函数，如 $\\phi_2$，并使用 Gram-Schmidt 正交化方法，或者我们可以通过观察构建一个与 $\\Psi_{A_1}$ 和 $\\Psi_{Ea}$ 都正交的组合。一个简单的组合是 $\\phi_2 - \\phi_3$。\n正交性检查：\n$\\langle \\phi_1+\\phi_2+\\phi_3 | \\phi_2-\\phi_3 \\rangle = 1 - 1 = 0$。\n$\\langle 2\\phi_1-\\phi_2-\\phi_3 | \\phi_2-\\phi_3 \\rangle = -1 - (-1) = 0$。\n该组合与另外两个正交。因此，第二个未归一化的 $E$ SALC 是 $\\Psi_{Eb, \\text{unnorm}} = \\phi_2 - \\phi_3$。\n归一化：\n$$ \\langle \\Psi_{Eb, \\text{unnorm}} | \\Psi_{Eb, \\text{unnorm}} \\rangle = 1^2 + (-1)^2 = 2 $$\n归一化后的 SALC 是 $\\Psi_{Eb} = \\frac{1}{\\sqrt{2}}(\\phi_2 - \\phi_3)$。\n\n完整的 SALC 集合是：\n$$ \\Psi_{A_1} = \\frac{1}{\\sqrt{3}}(\\phi_1 + \\phi_2 + \\phi_3) $$\n$$ \\Psi_{E} = \\left\\{ \\begin{array}{l} \\Psi_{Ea} = \\frac{1}{\\sqrt{6}}(2\\phi_1 - \\phi_2 - \\phi_3) \\\\ \\Psi_{Eb} = \\frac{1}{\\sqrt{2}}(\\phi_2 - \\phi_3) \\end{array} \\right. $$\n\n接下来，我们确定氮价层轨道（$2s, 2p_x, 2p_y, 2p_z$）的对称性，以识别潜在的相互作用。对于非零的重叠积分 $\\langle \\Psi_{\\text{SALC}} | \\phi_{\\text{N}} \\rangle$，$\\Psi_{\\text{SALC}}$ 和 $\\phi_{\\text{N}}$ 的表示的直积必须包含全对称不可约表示（$A_1$）。这只有在两个轨道属于同一个不可约表示时才可能。\n-   氮的 $2s$ 轨道是球对称的，在所有对称操作下保持不变。它按照 $A_1$ 变换。\n-   氮的 $2p_z$ 轨道沿主轴 $C_3$ 轴（$z$ 轴）分布。它在群的所有对称操作下也保持不变。它按照 $A_1$ 变换。\n-   氮的 $2p_x$ 和 $2p_y$ 轨道垂直于 $C_3$ 轴。它们成对地变换。如特征标表所示，函数 $(x, y)$ 按照 $E$ 表示进行变换。因此，$(2p_x, 2p_y)$ 轨道按照 $E$ 变换。\n\n因此，相互作用由对称性匹配决定：\n-   $A_1$ SALC, $\\Psi_{A_1}$，可以与同样具有 $A_1$ 对称性的氮 $2s$ 和 $2p_z$ 轨道形成成键和反键分子轨道。\n-   简并的 $E$ SALC 对，$\\{\\Psi_{Ea}, \\Psi_{Eb}\\}$，可以与同样具有 $E$ 对称性的简并氮 $(2p_x, 2p_y)$ 轨道对形成成键和反键分子轨道。\n\n问题的最后一部分要求给出全对称 SALC（即 $A_1$ SALC）中每个配体轨道上的归一化系数。归一化后的 SALC 是：\n$$ \\Psi_{A_1} = \\frac{1}{\\sqrt{3}}\\phi_1 + \\frac{1}{\\sqrt{3}}\\phi_2 + \\frac{1}{\\sqrt{3}}\\phi_3 $$\n三个配体轨道（$\\phi_1, \\phi_2, \\phi_3$）中每一个的系数都是相同的，等于 $1/\\sqrt{3}$。",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{3}}}$$"
        },
        {
            "introduction": "从理想化的理论模型迈向真实的计算化学研究，我们必须面对并解决计算方法带来的系统误差。本练习聚焦于一个在计算催化中至关重要的问题：基组叠加误差（BSSE）。你将通过分析一组模拟的吸附能数据，亲手计算未校正和经过反向校正（CP-corrected）的吸附能，并量化BSSE的大小。这项实践旨在让你理解BSSE的来源，并掌握在实际研究中获得可靠相互作用能的关键技术。",
            "id": "3872814",
            "problem": "考虑一个分子吸附质在催化表面上的吸附，使用分子电子结构理论和以原子为中心的高斯基组进行分析。当一个体系的各个碎片相互借用基函数，从而人为地降低了组合体系的计算能量时，就会产生基组重叠误差（BSSE）。Rayleigh–Ritz 变分原理保证了，对于给定的哈密顿量和扩大的基组，变分基态能量估计值不会增加，这解释了为何 BSSE 会导致相互作用能或吸附能中出现虚假的过结合。\n\n你的任务是计算包含和不包含 Boys–Bernardi 平衡校正（CP）的吸附能，报告 BSSE 的大小，并量化其对基组弥散度标量度量（标量越大，基组越弥散）的依赖性。所有能量都以有限基组变分估计值的形式提供，并应被视为实值标量。你必须从第一性原理出发进行推理：使用吸附能的定义，即组合体系与其分离碎片之间的能量差，并利用源自 Rayleigh–Ritz 变分原理和鬼基函数概念的 CP 校正的物理意义。除了这些基本思想，不要引入任何捷径或经验校正公式。\n\n使用的定义：\n- 基组重叠误差（Basis Set Superposition Error, BSSE）：有限基组变分计算中的一种人为误差，其中体系的碎片在组合几何构型和基组中计算时，通过相互借用基函数来降低自身的能量。\n- Boys–Bernardi 平衡校正（Counterpoise, CP）：一种校正方法，其中每个碎片的能量在完整的组合基组中重新计算，此时将另一个碎片的基函数作为鬼（没有电子，没有原子核），从而确保定义相互作用能或吸附能的能量差计算中具有一致的变分空间。\n\n现提供一个基组测试套件，其特征为一个标量弥散度参数 $d$（无量纲）以及以下能量值（均以电子伏特 eV 为单位）。对于每种情况，给出的量是：吸附质-表面组合体系的总能量 $E_{\\mathrm{AB}}$、孤立吸附质的能量 $E_{\\mathrm{A}}$、孤立表面的能量 $E_{\\mathrm{B}}$、在含鬼基函数的组合基组中计算的吸附质能量 $E_{\\mathrm{A}}^{\\mathrm{AB}}$，以及在含鬼基函数的组合基组中计算的表面能量 $E_{\\mathrm{B}}^{\\mathrm{AB}}$。能量以 eV 为单位指定，并且必须按给定值使用。\n\n测试套件（每行为一种情况）：\n1. 最小基组，$d = 0.3$：$E_{\\mathrm{AB}} = -111.450$，$E_{\\mathrm{A}} = -10.000$，$E_{\\mathrm{B}} = -100.000$，$E_{\\mathrm{A}}^{\\mathrm{AB}} = -10.080$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -100.070$。\n2. 双ζ基组，$d = 0.6$：$E_{\\mathrm{AB}} = -112.620$，$E_{\\mathrm{A}} = -10.500$，$E_{\\mathrm{B}} = -100.800$，$E_{\\mathrm{A}}^{\\mathrm{AB}} = -10.560$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -100.845$。\n3. 增广双ζ基组，$d = 0.8$：$E_{\\mathrm{AB}} = -112.900$，$E_{\\mathrm{A}} = -10.620$，$E_{\\mathrm{B}} = -101.000$，$E_{\\mathrm{A}}^{\\mathrm{AB}} = -10.656$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -101.022$。\n4. 三ζ基组，$d = 1.0$：$E_{\\mathrm{AB}} = -113.400$，$E_{\\mathrm{A}} = -10.840$，$E_{\\mathrm{B}} = -101.400$，$E_{\\mathrm{A}}^{\\mathrm{AB}} = -10.865$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -101.415$。\n5. 增广三ζ基组，$d = 1.2$：$E_{\\mathrm{AB}} = -113.540$，$E_{\\mathrm{A}} = -10.880$，$E_{\\mathrm{B}} = -101.500$，$E_{\\mathrm{A}}^{\\mathrm{AB}} = -10.896$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -101.508$。\n6. 近完备基组（基准），$d = 1.5$：$E_{\\mathrm{AB}} = -114.260$，$E_{\\mathrm{A}} = -11.200$，$E_{\\mathrm{B}} = -102.000$，$E_{\\mathrm{A}}^{\\mathrm{AB}} = -11.202$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -102.001$。\n\n要求：\n- 仅使用上述定义，计算每种情况下未经 CP 校正的吸附能、经过 CP 校正的吸附能以及 BSSE 的大小。所有能量必须以电子伏特（eV）为单位报告。\n- 通过最小二乘法将 BSSE 的大小对基组弥散度的依赖关系拟合为一条直线 $y = m d + b$，其中 $y$ 是 BSSE 的大小，$d$ 是弥散度参数。报告斜率 $m$，单位为电子伏特每单位弥散度（eV per unit diffuseness）。\n- 数值输出必须格式化为四舍五入到六位小数的实数。不涉及角度。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。内容必须是一个列表，其前六个元素是按给定顺序为每个测试用例包含三个浮点数的列表，$[E_{\\mathrm{ads}}^{\\mathrm{nonCP}}, E_{\\mathrm{ads}}^{\\mathrm{CP}}, \\lvert \\Delta_{\\mathrm{BSSE}} \\rvert]$，其后是全局斜率 $m$ 的单个浮点数。例如，最终结构是 $[[\\dots],[\\dots],\\dots,[\\dots],m]$，其中每个内部列表包含三个以 eV 为单位的浮点数，$m$ 的单位是电子伏特每单位弥散度。",
            "solution": "我们从 Rayleigh–Ritz 变分原理出发，该原理指出，对于从有限维空间中选择的近似波函数 $\\Psi$，其变分基态能量估计值 $E[\\Psi]$ 满足 $E[\\Psi] \\ge E_{0}$，其中 $E_{0}$ 是精确的基态能量。当两个碎片（记为 $\\mathrm{A}$ 和 $\\mathrm{B}$）作为一个组合体系 $\\mathrm{AB}$ 一起计算时，有限基组可以包含以两个碎片为中心的函数。在孤立基组中计算碎片能量，与在包含鬼基函数（即另一碎片上的基函数，但不含电子或原子核）的组合基组中计算相比，会改变可用的变分空间，从而改变能量估计值。用更多基函数计算的能量不会增加，通常会减少：$E_{\\mathrm{A}}^{\\mathrm{AB}} \\le E_{\\mathrm{A}}$ 和 $E_{\\mathrm{B}}^{\\mathrm{AB}} \\le E_{\\mathrm{B}}$。这种基函数的借用是基组重叠误差（BSSE）的物理根源。\n\n吸附能定义为由分离的碎片形成组合体系时总能量的变化。根据这个定义，未经平衡校正（nonCP）的吸附能由组合体系的能量与在各自孤立基组中计算的碎片能量之和的差值给出。经过平衡校正（CP）的吸附能使用在完整的含鬼基函数的组合基组中计算的碎片能量，从而确保能量差中各项的变分空间保持一致。根据这些定义，BSSE 的大小是 nonCP 和 CP 吸附能之间的绝对差值，它量化了由基组借用引入的虚假稳定性。\n\n对每个测试用例，计算步骤如下：\n1. 使用能量差的定义计算 nonCP 吸附能：$E_{\\mathrm{ads}}^{\\mathrm{nonCP}} = E_{\\mathrm{AB}} - E_{\\mathrm{A}} - E_{\\mathrm{B}}$。\n2. 使用鬼基函数计算 CP 校正的吸附能：$E_{\\mathrm{ads}}^{\\mathrm{CP}} = E_{\\mathrm{AB}} - E_{\\mathrm{A}}^{\\mathrm{AB}} - E_{\\mathrm{B}}^{\\mathrm{AB}}$。\n3. 计算 BSSE 的大小：$|\\Delta_{\\mathrm{BSSE}}| = |E_{\\mathrm{ads}}^{\\mathrm{nonCP}} - E_{\\mathrm{ads}}^{\\mathrm{CP}}|$。\n4. 通过最小二乘法将数据对 $(d_{i}, |\\Delta_{\\mathrm{BSSE}}|_{i})$ 拟合为一条直线 $y = m d + b$，从而量化对弥散度 $d$ 的依赖性。斜率为\n$$\nm = \\frac{\\sum_{i=1}^{N} (d_{i} - \\bar{d})(y_{i} - \\bar{y})}{\\sum_{i=1}^{N} (d_{i} - \\bar{d})^{2}},\n$$\n其中 $\\bar{d}$ 和 $\\bar{y}$ 分别是 $d_{i}$ 和 $y_{i}$ 的样本均值，$N$ 是案例数。\n\n对所提供的数据（所有能量单位均为电子伏特，eV）进行这些计算，我们得到：\n\n案例 $1$ ($d = 0.3$)：\n- $E_{\\mathrm{ads}}^{\\mathrm{nonCP}} = -111.450 - (-10.000) - (-100.000) = -1.450000$。\n- $E_{\\mathrm{ads}}^{\\mathrm{CP}} = -111.450 - (-10.080) - (-100.070) = -1.300000$。\n- $|\\Delta_{\\mathrm{BSSE}}| = |-1.450000 - (-1.300000)| = 0.150000$。\n\n案例 $2$ ($d = 0.6$)：\n- $E_{\\mathrm{ads}}^{\\mathrm{nonCP}} = -112.620 - (-10.500) - (-100.800) = -1.320000$。\n- $E_{\\mathrm{ads}}^{\\mathrm{CP}} = -112.620 - (-10.560) - (-100.845) = -1.215000$。\n- $|\\Delta_{\\mathrm{BSSE}}| = 0.105000$。\n\n案例 $3$ ($d = 0.8$)：\n- $E_{\\mathrm{ads}}^{\\mathrm{nonCP}} = -112.900 - (-10.620) - (-101.000) = -1.280000$。\n- $E_{\\mathrm{ads}}^{\\mathrm{CP}} = -112.900 - (-10.656) - (-101.022) = -1.222000$。\n- $|\\Delta_{\\mathrm{BSSE}}| = 0.058000$。\n\n案例 $4$ ($d = 1.0$)：\n- $E_{\\mathrm{ads}}^{\\mathrm{nonCP}} = -113.400 - (-10.840) - (-101.400) = -1.160000$。\n- $E_{\\mathrm{ads}}^{\\mathrm{CP}} = -113.400 - (-10.865) - (-101.415) = -1.120000$。\n- $|\\Delta_{\\mathrm{BSSE}}| = 0.040000$。\n\n案例 $5$ ($d = 1.2$)：\n- $E_{\\mathrm{ads}}^{\\mathrm{nonCP}} = -113.540 - (-10.880) - (-101.500) = -1.160000$。\n- $E_{\\mathrm{ads}}^{\\mathrm{CP}} = -113.540 - (-10.896) - (-101.508) = -1.136000$。\n- $|\\Delta_{\\mathrm{BSSE}}| = 0.024000$。\n\n案例 $6$ ($d = 1.5$)：\n- $E_{\\mathrm{ads}}^{\\mathrm{nonCP}} = -114.260 - (-11.200) - (-102.000) = -1.060000$。\n- $E_{\\mathrm{ads}}^{\\mathrm{CP}} = -114.260 - (-11.202) - (-102.001) = -1.057000$。\n- $|\\Delta_{\\mathrm{BSSE}}| = 0.003000$。\n\n将线性模型 $y = m d + b$ 拟合到数据对 $(d, |\\Delta_{\\mathrm{BSSE}}|)$，其中 $d = [0.3, 0.6, 0.8, 1.0, 1.2, 1.5]$ 且 $y = [0.150000, 0.105000, 0.058000, 0.040000, 0.024000, 0.003000]$。使用最小二乘法公式，\n$$\n\\bar{d} = \\frac{0.3 + 0.6 + 0.8 + 1.0 + 1.2 + 1.5}{6} = 0.900000,\\quad\n\\bar{y} = \\frac{0.150000 + 0.105000 + 0.058000 + 0.040000 + 0.024000 + 0.003000}{6} = 0.063333.\n$$\n斜率为\n$$\nm = \\frac{\\sum_{i=1}^{6} (d_{i} - 0.900000)(y_{i} - 0.063333)}{\\sum_{i=1}^{6} (d_{i} - 0.900000)^{2}} \\approx -0.124239.\n$$\n\n所有量均以电子伏特（eV）为单位报告，斜率 $m$ 以电子伏特每单位弥散度为单位报告。程序必须输出单行，其格式为\n$$\n[[E_{\\mathrm{ads}}^{\\mathrm{nonCP}}(1), E_{\\mathrm{ads}}^{\\mathrm{CP}}(1), |\\Delta_{\\mathrm{BSSE}}|(1)], \\ldots, [E_{\\mathrm{ads}}^{\\mathrm{nonCP}}(6), E_{\\mathrm{ads}}^{\\mathrm{CP}}(6), |\\Delta_{\\mathrm{BSSE}}|(6)], m]\n$$\n每个实数四舍五入到六位小数，并严格按照测试套件的顺序排列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (label, diffuseness d, E_AB, E_A, E_B, E_A_ghost, E_B_ghost)\n    test_cases = [\n        (\"minimal\", 0.3, -111.450, -10.000, -100.000, -10.080, -100.070),\n        (\"dz\",      0.6, -112.620, -10.500, -100.800, -10.560, -100.845),\n        (\"aug-dz\",  0.8, -112.900, -10.620, -101.000, -10.656, -101.022),\n        (\"tz\",      1.0, -113.400, -10.840, -101.400, -10.865, -101.415),\n        (\"aug-tz\",  1.2, -113.540, -10.880, -101.500, -10.896, -101.508),\n        (\"near-cbs\",1.5, -114.260, -11.200, -102.000, -11.202, -102.001),\n    ]\n\n    # Compute adsorption energies and BSSE magnitudes for each case.\n    per_case_results = []\n    d_values = []\n    bsse_magnitudes = []\n\n    for case in test_cases:\n        _, d, E_AB, E_A, E_B, E_A_ghost, E_B_ghost = case\n        # Non-CP adsorption energy: E_AB - E_A - E_B\n        E_ads_noncp = E_AB - E_A - E_B\n        # CP-corrected adsorption energy: E_AB - E_A^AB - E_B^AB\n        E_ads_cp = E_AB - E_A_ghost - E_B_ghost\n        # BSSE magnitude: |E_ads_noncp - E_ads_cp|\n        bsse_mag = abs(E_ads_noncp - E_ads_cp)\n\n        # Round to 6 decimals for output formatting\n        E_ads_noncp = round(E_ads_noncp, 6)\n        E_ads_cp = round(E_ads_cp, 6)\n        bsse_mag = round(bsse_mag, 6)\n\n        per_case_results.append([E_ads_noncp, E_ads_cp, bsse_mag])\n        d_values.append(d)\n        bsse_magnitudes.append(bsse_mag)\n\n    # Fit a straight line y = m d + b via least squares and report slope m.\n    d_arr = np.array(d_values, dtype=float)\n    y_arr = np.array(bsse_magnitudes, dtype=float)\n    # Use numpy.polyfit for linear fit; returns [m, b]\n    m, b = np.polyfit(d_arr, y_arr, 1)\n    m = round(float(m), 6)\n\n    # Prepare final aggregated output list: six case results followed by slope m.\n    # Ensure exact required format: single line, comma-separated, enclosed in square brackets.\n    # We'll format nested lists and the slope.\n    results_str_parts = []\n    for triple in per_case_results:\n        results_str_parts.append(f\"[{','.join(f'{val:.6f}' for val in triple)}]\")\n    results_str_parts.append(f\"{m:.6f}\")\n    print(f\"[{','.join(results_str_parts)}]\")\n\nsolve()\n```"
        }
    ]
}