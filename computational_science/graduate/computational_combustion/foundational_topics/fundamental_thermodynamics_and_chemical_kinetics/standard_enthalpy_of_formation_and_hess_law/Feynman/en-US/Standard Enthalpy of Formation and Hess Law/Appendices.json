{
    "hands_on_practices": [
        {
            "introduction": "Mastery of computational combustion begins with a firm grasp of its foundational thermochemical principles. This first exercise reinforces the direct application of Hess's Law to calculate a reaction enthalpy from standard enthalpies of formation. More importantly, it prompts a reflection on a cornerstone convention: the zero-enthalpy reference state for elements, a concept essential for constructing and interpreting any thermochemical database. ",
            "id": "2956726",
            "problem": "At temperature $298.15\\,\\mathrm{K}$ and standard pressure $1\\,\\mathrm{bar}$, consider the gas-phase reaction $\\mathrm{2NO(g) + O_2(g) \\to 2NO_2(g)}$. Using only the definition of the standard enthalpy of formation and Hess’s law, derive an expression for the standard reaction enthalpy $\\Delta H^\\circ$ of this reaction in terms of standard molar enthalpies of formation. Then evaluate it numerically using the following data:\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{NO(g)},\\,298.15\\,\\mathrm{K}\\right) = +90.25\\,\\mathrm{kJ\\,mol^{-1}}$,\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{NO_2(g)},\\,298.15\\,\\mathrm{K}\\right) = +33.18\\,\\mathrm{kJ\\,mol^{-1}}$.\nJustify, from first principles, the role of elemental $\\mathrm{O_2(g)}$ in the calculation and explain why its standard enthalpy of formation is taken as zero without loss of generality, and how this convention is consistent with Hess’s law.\n\nReport the value of $\\Delta H^\\circ$ for the reaction as written, in $\\mathrm{kJ}$ for the stoichiometric equation above, rounded to four significant figures.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of chemical thermodynamics, is well-posed with sufficient data for a unique solution, and is expressed in objective, unambiguous language. We will therefore proceed with a complete solution.\n\nThe problem requires a three-part analysis: first, a justification of the thermochemical treatment of elemental substances; second, a derivation of the reaction enthalpy expression using Hess's law; and third, the numerical evaluation of this enthalpy.\n\nFirst, we address the role of elemental oxygen, $\\mathrm{O_2(g)}$, and the value of its standard enthalpy of formation. The standard enthalpy of formation, denoted $\\Delta H_f^\\circ$, is defined as the change in enthalpy when one mole of a substance is formed from its constituent elements in their respective standard states at a specified temperature and standard pressure ($1\\,\\mathrm{bar}$). The standard state of an element is its most stable form under these conditions. For oxygen at $298.15\\,\\mathrm{K}$ and $1\\,\\mathrm{bar}$, the standard state is gaseous dioxygen, $\\mathrm{O_2(g)}$.\n\nTo determine the standard enthalpy of formation of $\\mathrm{O_2(g)}$, we must consider the reaction that forms one mole of $\\mathrm{O_2(g)}$ from its constituent element (oxygen) in its standard state ($\\mathrm{O_2(g)}$). This notional reaction is:\n$$\n\\mathrm{O_2(g)} \\to \\mathrm{O_2(g)}\n$$\nEnthalpy is a state function, meaning its change, $\\Delta H$, depends only on the initial and final states of the system. In this case, the initial and final states are identical. Consequently, the enthalpy change for this process is necessarily zero. Thus, by definition, the standard enthalpy of formation of any element in its standard state is zero. For oxygen:\n$$\n\\Delta H_f^\\circ(\\mathrm{O_2(g)}) = 0\n$$\nThis convention is consistent with Hess’s law, which states that the total enthalpy change for a chemical reaction is independent of the pathway taken. Hess's law is concerned with enthalpy *differences* ($\\Delta H$), not absolute enthalpy values (which are not experimentally accessible). By defining the enthalpy of formation of elements in their standard states as the zero-point on the enthalpy scale, we establish a common, convenient reference from which the enthalpies of all compounds can be measured. Any other choice for this reference point would be an arbitrary constant added to the enthalpy of every substance. When calculating a reaction enthalpy as the difference between product and reactant enthalpies, such a constant would cancel out, leaving the final $\\Delta H^\\circ$ unchanged. Therefore, the convention $\\Delta H_f^\\circ(\\text{element, std. state}) = 0$ is a matter of convenience that does not compromise the physical reality described by Hess's law.\n\nNext, we derive an expression for the standard reaction enthalpy, $\\Delta H^\\circ$, for the reaction:\n$$\n2\\mathrm{NO(g)} + \\mathrm{O_2(g)} \\to 2\\mathrm{NO_2(g)}\n$$\nWe apply Hess's law by constructing a hypothetical two-step pathway from reactants to products, passing through the constituent elements in their standard states ($\\mathrm{N_2(g)}$ and $\\mathrm{O_2(g)}$).\n\nStep $1$: Decomposition of reactants into their constituent elements.\nThe decomposition of $2$ moles of $\\mathrm{NO(g)}$ is the reverse of its formation reaction. The formation of $1$ mole of $\\mathrm{NO(g)}$ is $\\frac{1}{2}\\mathrm{N_2(g)} + \\frac{1}{2}\\mathrm{O_2(g)} \\to \\mathrm{NO(g)}$, with enthalpy change $\\Delta H_f^\\circ(\\mathrm{NO(g)})$. Therefore, the reaction $2\\mathrm{NO(g)} \\to \\mathrm{N_2(g)} + \\mathrm{O_2(g)}$ has an enthalpy change of $-2 \\times \\Delta H_f^\\circ(\\mathrm{NO(g)})$. The other reactant, $\\mathrm{O_2(g)}$, is already an element in its standard state, so its enthalpy of decomposition is zero, which is consistent with $-\\Delta H_f^\\circ(\\mathrm{O_2(g)}) = -0 = 0$.\nThe total enthalpy change for Step $1$ is:\n$$\n\\Delta H_1 = -[2 \\times \\Delta H_f^\\circ(\\mathrm{NO(g)}) + 1 \\times \\Delta H_f^\\circ(\\mathrm{O_2(g)})]\n$$\nStep $2$: Formation of products from the constituent elements.\nThe formation of $2$ moles of $\\mathrm{NO_2(g)}$ from its elements is $\\mathrm{N_2(g)} + 2\\mathrm{O_2(g)} \\to 2\\mathrm{NO_2(g)}$. The enthalpy change for this step is $2 \\times \\Delta H_f^\\circ(\\mathrm{NO_2(g)})$.\nThe enthalpy change for Step $2$ is:\n$$\n\\Delta H_2 = 2 \\times \\Delta H_f^\\circ(\\mathrm{NO_2(g)})\n$$\nAccording to Hess's law, the standard reaction enthalpy $\\Delta H^\\circ$ is the sum of the enthalpy changes of the steps: $\\Delta H^\\circ = \\Delta H_1 + \\Delta H_2$.\n$$\n\\Delta H^\\circ = \\left( 2 \\times \\Delta H_f^\\circ(\\mathrm{NO_2(g)}) \\right) - \\left( 2 \\times \\Delta H_f^\\circ(\\mathrm{NO(g)}) + 1 \\times \\Delta H_f^\\circ(\\mathrm{O_2(g)}) \\right)\n$$\nThis is the general expression derived from first principles. It is an application of the general formula $\\Delta H^\\circ = \\sum_{\\text{products}} \\nu_p \\Delta H_f^\\circ(P) - \\sum_{\\text{reactants}} \\nu_r \\Delta H_f^\\circ(R)$, where $\\nu$ represents the stoichiometric coefficients.\n\nFinally, we evaluate this expression numerically using the provided data:\n$\\Delta H_f^\\circ(\\mathrm{NO(g)}) = +90.25\\,\\mathrm{kJ\\,mol^{-1}}$\n$\\Delta H_f^\\circ(\\mathrm{NO_2(g)}) = +33.18\\,\\mathrm{kJ\\,mol^{-1}}$\nAnd from our preceding analysis, $\\Delta H_f^\\circ(\\mathrm{O_2(g)}) = 0\\,\\mathrm{kJ\\,mol^{-1}}$.\n\nSubstituting these values into the derived expression:\n$$\n\\Delta H^\\circ = \\left( 2 \\times (+33.18\\,\\mathrm{kJ}) \\right) - \\left( 2 \\times (+90.25\\,\\mathrm{kJ}) + 1 \\times (0\\,\\mathrm{kJ}) \\right)\n$$\nThe calculation yields:\n$$\n\\Delta H^\\circ = 66.36\\,\\mathrm{kJ} - (180.50\\,\\mathrm{kJ} + 0\\,\\mathrm{kJ})\n$$\n$$\n\\Delta H^\\circ = 66.36\\,\\mathrm{kJ} - 180.50\\,\\mathrm{kJ}\n$$\n$$\n\\Delta H^\\circ = -114.14\\,\\mathrm{kJ}\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value is $-114.14$. Rounding to four significant figures gives $-114.1$.",
            "answer": "$$ \\boxed{-114.1} $$"
        },
        {
            "introduction": "Computational solvers translate chemical reaction networks into a robust mathematical language. This practice moves beyond single-reaction calculations to the framework used in modern combustion codes, introducing the stoichiometric and element incidence matrices. By working through this exercise, you will see how fundamental laws—element conservation and the additivity of reaction enthalpies (Hess's Law)—are elegantly verified and applied using linear algebra, ensuring the internal consistency of a reaction mechanism. ",
            "id": "4029794",
            "problem": "An engineer is developing a reduced gas-phase mechanism to be used in a computational combustion solver. The species set is $\\mathcal{S} = \\{\\text{CH}_4(\\text{g}), \\text{O}_2(\\text{g}), \\text{CO}(\\text{g}), \\text{CO}_2(\\text{g}), \\text{H}_2(\\text{g}), \\text{H}_2\\text{O}(\\text{g})\\}$ and the mechanism consists of the following three reversible steps written in the forward direction:\n- Reaction $A$: $\\text{CH}_4 + \\text{H}_2\\text{O} \\rightarrow \\text{CO} + 3\\,\\text{H}_2$.\n- Reaction $B$: $\\text{CO} + \\text{H}_2\\text{O} \\rightarrow \\text{CO}_2 + \\text{H}_2$.\n- Reaction $C$: $\\text{H}_2 + \\tfrac{1}{2}\\,\\text{O}_2 \\rightarrow \\text{H}_2\\text{O}$.\n\nThe solver enforces conservation of chemical elements and uses heats of reaction derived from standard enthalpies of formation at the reference temperature $T^{\\circ} = 298\\,\\mathrm{K}$ via fundamental thermochemical definitions and Hess’s law. The standard enthalpies of formation for the species in $\\mathcal{S}$ at $T^{\\circ}$ are:\n- $\\Delta H_{f}^{\\circ}(\\text{CH}_4(\\text{g})) = -74.873\\,\\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}(\\text{O}_2(\\text{g})) = 0\\,\\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}(\\text{CO}(\\text{g})) = -110.530\\,\\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}(\\text{CO}_2(\\text{g})) = -393.522\\,\\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}(\\text{H}_2(\\text{g})) = 0\\,\\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}(\\text{H}_2\\text{O}(\\text{g})) = -241.826\\,\\mathrm{kJ/mol}$.\n\nTasks:\n- Using the definition of stoichiometric coefficients, construct the stoichiometric matrix $S \\in \\mathbb{R}^{6 \\times 3}$ whose columns correspond to reactions $A$, $B$, and $C$, and whose rows correspond to the ordered species in $\\mathcal{S}$. Adopt the convention that reactants have negative stoichiometric coefficients and products have positive stoichiometric coefficients.\n- Construct the element incidence matrix $A \\in \\mathbb{Z}^{3 \\times 6}$ whose rows correspond to the elements $\\{\\text{C}, \\text{H}, \\text{O}\\}$ and whose columns correspond to the species in $\\mathcal{S}$, with entries equal to the number of atoms of each element in one molecule of the species.\n- Verify element conservation by demonstrating from first principles that $A S = 0$, i.e., each reaction conserves atoms of $\\text{C}$, $\\text{H}$, and $\\text{O}$.\n- Using the fundamental definition of reaction enthalpy in terms of standard enthalpies of formation and Hess’s law, compute the standard heat of reaction $\\Delta H^{\\circ}$ for reactions $A$, $B$, and $C$ at $T^{\\circ}$. Then form the composite reaction $R_{\\text{tot}} = A + B + 4\\,C$, derive its net stoichiometry, and verify that it equals the complete combustion of methane to gaseous water: $\\text{CH}_4 + 2\\,\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\,\\text{H}_2\\text{O}$. Check the consistency of heats of reaction by showing that the heat of the composite reaction computed by linearity agrees with the direct computation from standard enthalpies of formation.\n- Report the overall standard heat of combustion of methane to gaseous water at $T^{\\circ}$, expressed in $\\text{kJ/mol}$, and round your final answer to four significant figures.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is based on fundamental principles of physical chemistry, specifically thermochemistry and mass balance in chemical reactions. All necessary data are provided, and the tasks are clearly defined, leading to a unique and verifiable solution.\n\nThe ordered set of species is $\\mathcal{S} = \\{\\text{CH}_4(\\text{g}), \\text{O}_2(\\text{g}), \\text{CO}(\\text{g}), \\text{CO}_2(\\text{g}), \\text{H}_2(\\text{g}), \\text{H}_2\\text{O}(\\text{g})\\}$. We will denote the species by their index $i$ from $1$ to $6$. The reactions are indexed $j \\in \\{A, B, C\\}$.\n\nFirst, we construct the stoichiometric matrix $S \\in \\mathbb{R}^{6 \\times 3}$. The entry $S_{ij}$ is the stoichiometric coefficient $\\nu_{ij}$ of species $i$ in reaction $j$. By convention, reactants have negative coefficients and products have positive coefficients.\n\nReaction $A$: $\\text{CH}_4 + \\text{H}_2\\text{O} \\rightarrow \\text{CO} + 3\\,\\text{H}_2$. The stoichiometric vector is $\\boldsymbol{\\nu}_A = (-1, 0, 1, 0, 3, -1)^T$.\nReaction $B$: $\\text{CO} + \\text{H}_2\\text{O} \\rightarrow \\text{CO}_2 + \\text{H}_2$. The stoichiometric vector is $\\boldsymbol{\\nu}_B = (0, 0, -1, 1, 1, -1)^T$.\nReaction $C$: $\\text{H}_2 + \\tfrac{1}{2}\\,\\text{O}_2 \\rightarrow \\text{H}_2\\text{O}$. The stoichiometric vector is $\\boldsymbol{\\nu}_C = (0, -1/2, 0, 0, -1, 1)^T$.\n\nCombining these column vectors yields the stoichiometric matrix $S$:\n$$S = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 0 & -1/2 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & 0 \\\\ 3 & 1 & -1 \\\\ -1 & -1 & 1 \\end{pmatrix}$$\n\nNext, we construct the element incidence matrix $A \\in \\mathbb{Z}^{3 \\times 6}$. The entry $A_{ki}$ is the number of atoms of element $k$ in one molecule of species $i$. The elements are ordered as $\\{\\text{C}, \\text{H}, \\text{O}\\}$.\nRow for Carbon (C): Species are $\\text{CH}_4, \\text{O}_2, \\text{CO}, \\text{CO}_2, \\text{H}_2, \\text{H}_2\\text{O}$. Number of C atoms: $(1, 0, 1, 1, 0, 0)$.\nRow for Hydrogen (H): Number of H atoms: $(4, 0, 0, 0, 2, 2)$.\nRow for Oxygen (O): Number of O atoms: $(0, 2, 1, 2, 0, 1)$.\n\nCombining these row vectors yields the element incidence matrix $A$:\n$$A = \\begin{pmatrix} 1 & 0 & 1 & 1 & 0 & 0 \\\\ 4 & 0 & 0 & 0 & 2 & 2 \\\\ 0 & 2 & 1 & 2 & 0 & 1 \\end{pmatrix}$$\n\nWe now verify the conservation of elements. The conservation of element $k$ in reaction $j$ is expressed as $\\sum_{i=1}^{6} A_{ki} S_{ij} = 0$. This is equivalent to the matrix product $AS$ being the zero matrix.\n$$AS = \\begin{pmatrix} 1 & 0 & 1 & 1 & 0 & 0 \\\\ 4 & 0 & 0 & 0 & 2 & 2 \\\\ 0 & 2 & 1 & 2 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 0 & -1/2 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & 0 \\\\ 3 & 1 & -1 \\\\ -1 & -1 & 1 \\end{pmatrix}$$\nPerforming the multiplication:\n$$(AS)_{11} = (1)(-1) + (1)(1) = 0$$\n$$(AS)_{12} = (1)(-1) + (1)(1) = 0$$\n$$(AS)_{13} = 0$$\n$$(AS)_{21} = (4)(-1) + (2)(3) + (2)(-1) = -4 + 6 - 2 = 0$$\n$$(AS)_{22} = (2)(1) + (2)(-1) = 0$$\n$$(AS)_{23} = (2)(-1) + (2)(1) = 0$$\n$$(AS)_{31} = (1)(1) + (1)(-1) = 0$$\n$$(AS)_{32} = (1)(-1) + (2)(1) + (1)(-1) = -1 + 2 - 1 = 0$$\n$$(AS)_{33} = (2)(-1/2) + (1)(1) = -1 + 1 = 0$$\nThus, we obtain the $3 \\times 3$ zero matrix, confirming that all three reactions conserve C, H, and O atoms.\n$$AS = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\n\nNow, we compute the standard heat of reaction, $\\Delta H_j^{\\circ}$, for each reaction $j$ using the standard enthalpies of formation, $\\Delta H_{f,i}^{\\circ}$:\n$$\\Delta H_j^{\\circ} = \\sum_{i=1}^{6} \\nu_{ij} \\Delta H_{f,i}^{\\circ}$$\nThe provided data are: $\\Delta H_{f}^{\\circ}(\\text{CH}_4) = -74.873\\,\\mathrm{kJ/mol}$, $\\Delta H_{f}^{\\circ}(\\text{O}_2) = 0\\,\\mathrm{kJ/mol}$, $\\Delta H_{f}^{\\circ}(\\text{CO}) = -110.530\\,\\mathrm{kJ/mol}$, $\\Delta H_{f}^{\\circ}(\\text{CO}_2) = -393.522\\,\\mathrm{kJ/mol}$, $\\Delta H_{f}^{\\circ}(\\text{H}_2) = 0\\,\\mathrm{kJ/mol}$, and $\\Delta H_{f}^{\\circ}(\\text{H}_2\\text{O}) = -241.826\\,\\mathrm{kJ/mol}$.\n\nFor Reaction $A$: $\\text{CH}_4 + \\text{H}_2\\text{O} \\rightarrow \\text{CO} + 3\\,\\text{H}_2$\n$$\\Delta H_A^{\\circ} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}) + 3 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2)] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{CH}_4) + 1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})]$$\n$$\\Delta H_A^{\\circ} = [-110.530 + 3(0)] - [-74.873 - 241.826] = -110.530 - (-316.699) = 206.169\\,\\mathrm{kJ/mol}$$\n\nFor Reaction $B$: $\\text{CO} + \\text{H}_2\\text{O} \\rightarrow \\text{CO}_2 + \\text{H}_2$\n$$\\Delta H_B^{\\circ} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}_2) + 1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2)] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}) + 1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})]$$\n$$\\Delta H_B^{\\circ} = [-393.522 + 0] - [-110.530 - 241.826] = -393.522 - (-352.356) = -41.166\\,\\mathrm{kJ/mol}$$\n\nFor Reaction $C$: $\\text{H}_2 + \\tfrac{1}{2}\\,\\text{O}_2 \\rightarrow \\text{H}_2\\text{O}$\n$$\\Delta H_C^{\\circ} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2) + \\tfrac{1}{2} \\cdot \\Delta H_f^{\\circ}(\\text{O}_2)]$$\n$$\\Delta H_C^{\\circ} = [-241.826] - [0 + \\tfrac{1}{2}(0)] = -241.826\\,\\mathrm{kJ/mol}$$\n\nNext, we analyze the composite reaction $R_{\\text{tot}} = A + B + 4C$. The net stoichiometric vector $\\boldsymbol{\\nu}_{\\text{tot}}$ is the linear combination of the individual reaction vectors: $\\boldsymbol{\\nu}_{\\text{tot}} = \\boldsymbol{\\nu}_A + \\boldsymbol{\\nu}_B + 4\\boldsymbol{\\nu}_C$.\n$$\\boldsymbol{\\nu}_{\\text{tot}} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 3 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\\\ 1 \\\\ 1 \\\\ -1 \\end{pmatrix} + 4\\begin{pmatrix} 0 \\\\ -1/2 \\\\ 0 \\\\ 0 \\\\ -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 1-1 \\\\ 1 \\\\ 3+1-4 \\\\ -1-1+4 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -2 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 2 \\end{pmatrix}$$\nThis vector corresponds to species coefficients: $\\nu_{\\text{CH}_4}=-1$, $\\nu_{\\text{O}_2}=-2$, $\\nu_{\\text{CO}}=0$, $\\nu_{\\text{CO}_2}=1$, $\\nu_{\\text{H}_2}=0$, $\\nu_{\\text{H}_2\\text{O}}=2$. Writing this as a chemical equation yields:\n$$\\text{CH}_4 + 2\\,\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\,\\text{H}_2\\text{O}$$\nThis is the equation for the complete combustion of methane to gaseous water, as required.\n\nFinally, we verify the consistency of the heats of reaction.\nMethod 1: By Hess's law, the heat of the composite reaction is the linear combination of the individual heats of reaction:\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = \\Delta H_A^{\\circ} + \\Delta H_B^{\\circ} + 4\\Delta H_C^{\\circ}$$\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = 206.169 + (-41.166) + 4(-241.826) = 206.169 - 41.166 - 967.304 = -802.301\\,\\mathrm{kJ/mol}$$\n\nMethod 2: Directly calculate the heat of reaction for $\\text{CH}_4 + 2\\,\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\,\\text{H}_2\\text{O}$.\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}_2) + 2 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{CH}_4) + 2 \\cdot \\Delta H_f^{\\circ}(\\text{O}_2)]$$\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = [-393.522 + 2(-241.826)] - [-74.873 + 2(0)]$$\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = [-393.522 - 483.652] - [-74.873] = -877.174 + 74.873 = -802.301\\,\\mathrm{kJ/mol}$$\nThe results from both methods are identical, which confirms the consistency of the thermodynamic data and the reaction mechanism.\n\nThe overall standard heat of combustion of methane to gaseous water at $T^{\\circ} = 298\\,\\mathrm{K}$ is $\\Delta H^{\\circ}_{R_{\\text{tot}}} = -802.301\\,\\mathrm{kJ/mol}$. Rounding to four significant figures gives $-802.3\\,\\mathrm{kJ/mol}$.",
            "answer": "$$\n\\boxed{-802.3}\n$$"
        },
        {
            "introduction": "The standard enthalpy values we often take for granted are the product of rigorous statistical analysis. In reality, experimental measurements of reaction enthalpies contain noise and may even be inconsistent with one another. This advanced exercise delves into the practical challenge of data reconciliation, introducing the powerful method of weighted least-squares estimation to derive a self-consistent set of standard enthalpies of formation from an overdetermined set of experimental data. This is how high-quality thermochemical databases are built and maintained. ",
            "id": "4067066",
            "problem": "Consider a set of combustion reactions at standard state and reference temperature $T = 298\\,\\mathrm{K}$. Let the vector of unknown standard enthalpies of formation (at $T = 298\\,\\mathrm{K}$) be $h \\in \\mathbb{R}^4$, ordered as $h = \\left[h_{\\mathrm{CH_4}},\\, h_{\\mathrm{CO}},\\, h_{\\mathrm{CO_2}},\\, h_{\\mathrm{H_2O(l)}}\\right]^\\top$, with each component expressed in $\\mathrm{kJ/mol}$. By the law of summation of reaction enthalpies known as Hess's law, the standard enthalpy of reaction $\\Delta H_{\\mathrm{rxn}}$ for a balanced reaction equals the stoichiometric sum of formation enthalpies of products minus reactants; this yields a linear model $y = S h + \\varepsilon$, where $y \\in \\mathbb{R}^m$ is the vector of measured reaction enthalpies (in $\\mathrm{kJ/mol}$), $S \\in \\mathbb{R}^{m \\times 4}$ is the stoichiometric coefficient matrix with products positive and reactants negative, and $\\varepsilon$ is the measurement error vector. Assume species $\\mathrm{O_2}$, $\\mathrm{H_2}$, and $\\mathrm{N_2}$ are elements in their reference states, thus their standard enthalpies of formation are zero and do not appear in $h$.\n\nThe five reactions and their corresponding stoichiometric rows (mapping to the ordering of $h$ above) are:\n- Reaction $1$: $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O(l)}$, row $S_1 = \\left[-1,\\, 0,\\, +1,\\, +2\\right]$.\n- Reaction $2$: $\\mathrm{CH_4} + 1.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO} + 2\\,\\mathrm{H_2O(l)}$, row $S_2 = \\left[-1,\\, +1,\\, 0,\\, +2\\right]$.\n- Reaction $3$: $\\mathrm{H_2} + 0.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{H_2O(l)}$, row $S_3 = \\left[0,\\, 0,\\, 0,\\, +1\\right]$.\n- Reaction $4$: $\\mathrm{CO} + 0.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2}$, row $S_4 = \\left[0,\\, -1,\\, +1,\\, 0\\right]$.\n- Reaction $5$: $\\mathrm{CH_4} + \\mathrm{H_2O(l)} \\rightarrow \\mathrm{CO} + 3\\,\\mathrm{H_2}$, row $S_5 = \\left[-1,\\, +1,\\, 0,\\, -1\\right]$.\n\nCollect these rows to form the matrix\n$$\nS = \\begin{bmatrix}\n-1 & 0 & +1 & +2 \\\\\n-1 & +1 & 0 & +2 \\\\\n0 & 0 & 0 & +1 \\\\\n0 & -1 & +1 & 0 \\\\\n-1 & +1 & 0 & -1\n\\end{bmatrix}.\n$$\n\nTo reconcile the measured reaction enthalpies using least squares estimation, adopt a weighted least squares criterion with diagonal weight matrix $W = \\mathrm{diag}(w_1,\\ldots,w_m)$, where $w_i = 1/\\sigma_i^2$ and $\\sigma_i$ is the reported standard deviation (in $\\mathrm{kJ/mol}$) of measurement $y_i$. In the presence of measurements with effectively infinite variance (i.e., $\\sigma_i = +\\infty$), treat $w_i = 0$, which removes their influence on the estimator.\n\nYour task is to implement a program that, for the following test suite, computes the weighted least squares estimator $\\hat{h}$ of $h$ from the model $y = S h + \\varepsilon$, using\n$$\n\\hat{h} = \\left(S^\\top W S\\right)^{+} S^\\top W y,\n$$\nwhere $(\\cdot)^{+}$ denotes the Moore–Penrose pseudoinverse to ensure numerical robustness. Express all enthalpies in $\\mathrm{kJ/mol}$.\n\nTest suite (each case provides $y$ and $\\sigma$):\n- Case $1$ (general case with moderate uncertainties):\n  - $y^{(1)} = \\left[-890.20,\\,-607.10,\\,-286.00,\\,-283.30,\\,250.50\\right]^\\top$\n  - $\\sigma^{(1)} = \\left[0.50,\\,1.20,\\,0.40,\\,0.50,\\,1.00\\right]^\\top$\n- Case $2$ (boundary weighting: one measurement is highly uncertain):\n  - $y^{(2)} = \\left[-890.20,\\,-607.10,\\,-286.00,\\,-283.30,\\,250.50\\right]^\\top$\n  - $\\sigma^{(2)} = \\left[0.50,\\,100.00,\\,0.40,\\,0.50,\\,1.00\\right]^\\top$\n- Case $3$ (edge case: effectively remove reaction $3$ by infinite variance):\n  - $y^{(3)} = \\left[-890.60,\\,-606.80,\\,-285.70,\\,-283.00,\\,250.80\\right]^\\top$\n  - $\\sigma^{(3)} = \\left[0.50,\\,1.20,\\,+\\infty,\\,0.50,\\,1.00\\right]^\\top$\n\nRequirements:\n- Compute $\\hat{h}$ for each case using the weighted least squares estimator defined above, with $W = \\mathrm{diag}\\left(1/\\sigma_i^2\\right)$ and $1/(+\\infty)^2 = 0$.\n- Express all enthalpies in $\\mathrm{kJ/mol}$ and round each component of $\\hat{h}$ to $2$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where the $k$-th element is a list of the four rounded components of $\\hat{h}$ for Case $k$, in the same order as $h$ (i.e., $\\left[h_{\\mathrm{CH_4}}, h_{\\mathrm{CO}}, h_{\\mathrm{CO_2}}, h_{\\mathrm{H_2O(l)}}\\right]$). For example, the output format must be of the form\n$$\n\\left[\\left[h^{(1)}_1, h^{(1)}_2, h^{(1)}_3, h^{(1)}_4\\right], \\left[h^{(2)}_1, h^{(2)}_2, h^{(2)}_3, h^{(2)}_4\\right], \\left[h^{(3)}_1, h^{(3)}_2, h^{(3)}_3, h^{(3)}_4\\right]\\right].\n$$\n\nDesign for coverage:\n- Case $1$ is a typical well-conditioned reconciliation task.\n- Case $2$ tests the influence of a low-weight measurement on the estimator.\n- Case $3$ tests the handling of effectively missing data via zero weights while maintaining identifiability.\n\nAnswer all enthalpies in $\\mathrm{kJ/mol}$. Angles do not appear; no angle unit is needed. No percentages appear; no percentage unit is needed.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of thermochemistry (Hess's Law) and statistics (weighted least squares), is well-posed by providing a clear objective and a robust numerical method (Moore-Penrose pseudoinverse) to handle potential rank-deficiency, and is specified with objective, unambiguous data and instructions.\n\nThe problem requires the computation of the standard enthalpies of formation, $h \\in \\mathbb{R}^4$, for four chemical species: $h = \\left[h_{\\mathrm{CH_4}},\\, h_{\\mathrm{CO}},\\, h_{\\mathrm{CO_2}},\\, h_{\\mathrm{H_2O(l)}}\\right]^\\top$. The estimate is to be derived from a set of $m=5$ measured reaction enthalpies, $y \\in \\mathbb{R}^5$, which are related to $h$ through a linear model $y = Sh + \\varepsilon$. Here, $S \\in \\mathbb{R}^{5 \\times 4}$ is the stoichiometric matrix, and $\\varepsilon$ represents measurement errors.\n\nThe guiding principle for finding the optimal estimate $\\hat{h}$ is the method of weighted least squares (WLS). This method is appropriate when the measurement errors are not uniform, i.e., they have different variances. The WLS estimator minimizes the weighted sum of squared residuals, $\\chi^2 = \\sum_{i=1}^m w_i (y_i - (S\\hat{h})_i)^2$. In matrix form, this is expressed as minimizing $\\chi^2 = (y - S\\hat{h})^\\top W (y - S\\hat{h})$, where $W$ is a diagonal matrix of weights. The weights $w_i$ are a measure of the confidence in each measurement $y_i$ and are typically chosen as the reciprocal of the variance of the measurement, $w_i = 1/\\sigma_i^2$, where $\\sigma_i$ is the standard deviation of the $i$-th measurement. This choice gives higher influence to more precise measurements (smaller $\\sigma_i$) and less influence to uncertain ones (larger $\\sigma_i$). In the limit of infinite uncertainty, $\\sigma_i \\to \\infty$, the weight $w_i \\to 0$, effectively removing the $i$-th measurement from consideration.\n\nThe solution to the WLS minimization problem is found by solving the weighted normal equations:\n$$\n\\left(S^\\top W S\\right) \\hat{h} = S^\\top W y\n$$\nThe problem specifies the use of the Moore-Penrose pseudoinverse, denoted by $(\\cdot)^{+}$, to solve for $\\hat{h}$. This is crucial because the matrix $S$, and consequently $A = S^\\top W S$, may be rank-deficient (i.e., singular). A rank-deficient system does not contain enough information to uniquely determine all components of $h$. The pseudoinverse provides the unique solution $\\hat{h}$ that both satisfies the least-squares criterion and has the minimum Euclidean norm $\\|\\hat{h}\\|_2$. The formula is:\n$$\n\\hat{h} = \\left(S^\\top W S\\right)^{+} S^\\top W y\n$$\nThe computational procedure for each test case is as follows:\n1.  Define the constant stoichiometric matrix $S$ with dimensions $5 \\times 4$ as given:\n    $$\n    S = \\begin{bmatrix}\n    -1 & 0 & +1 & +2 \\\\\n    -1 & +1 & 0 & +2 \\\\\n    0 & 0 & 0 & +1 \\\\\n    0 & -1 & +1 & 0 \\\\\n    -1 & +1 & 0 & -1\n    \\end{bmatrix}\n    $$\n2.  For a given test case, define the vector of measured reaction enthalpies $y \\in \\mathbb{R}^5$ and the vector of standard deviations $\\sigma \\in \\mathbb{R}^5$.\n3.  Calculate the vector of weights $w \\in \\mathbb{R}^5$ where each element is $w_i = 1/\\sigma_i^2$. For any $\\sigma_i = \\infty$, the corresponding weight $w_i$ is $0$.\n4.  Construct the diagonal weight matrix $W = \\mathrm{diag}(w)$.\n5.  Compute the matrix product $A = S^\\top W S$, which is a $4 \\times 4$ matrix.\n6.  Compute the vector product $b = S^\\top W y$, which is a $4 \\times 1$ vector.\n7.  Calculate the Moore-Penrose pseudoinverse of $A$, denoted $A^{+}$.\n8.  Determine the estimated enthalpy vector by computing the product $\\hat{h} = A^{+} b$.\n9.  Round each of the four components of the resulting vector $\\hat{h}$ to two decimal places.\n\nThis procedure is applied to each of the three test cases, which are designed to test a general scenario (Case 1), the effect of a highly uncertain measurement (Case 2), and the handling of a missing measurement via infinite variance (Case 3). The results for all cases are then aggregated and formatted as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the weighted least squares estimate of standard enthalpies of formation\n    for a set of chemical species based on measured reaction enthalpies.\n    \"\"\"\n\n    # Define the constant stoichiometric matrix S.\n    # The columns correspond to [CH4, CO, CO2, H2O(l)].\n    S = np.array([\n        [-1,  0,  1,  2],  # Reaction 1: CH4 + 2 O2 -> CO2 + 2 H2O(l)\n        [-1,  1,  0,  2],  # Reaction 2: CH4 + 1.5 O2 -> CO + 2 H2O(l)\n        [ 0,  0,  0,  1],  # Reaction 3: H2 + 0.5 O2 -> H2O(l)\n        [ 0, -1,  1,  0],  # Reaction 4: CO + 0.5 O2 -> CO2\n        [-1,  1,  0, -1]   # Reaction 5: CH4 + H2O(l) -> CO + 3 H2\n    ])\n\n    # Define the test suite. Each case is a tuple of (y, sigma).\n    # y: vector of measured reaction enthalpies (kJ/mol).\n    # sigma: vector of standard deviations of measurements (kJ/mol).\n    test_cases = [\n        # Case 1: General case with moderate uncertainties.\n        (\n            np.array([-890.20, -607.10, -286.00, -283.30, 250.50]),\n            np.array([0.50, 1.20, 0.40, 0.50, 1.00])\n        ),\n        # Case 2: Boundary weighting, one measurement is highly uncertain.\n        (\n            np.array([-890.20, -607.10, -286.00, -283.30, 250.50]),\n            np.array([0.50, 100.00, 0.40, 0.50, 1.00])\n        ),\n        # Case 3: Edge case, effectively remove reaction 3 by infinite variance.\n        (\n            np.array([-890.60, -606.80, -285.70, -283.00, 250.80]),\n            np.array([0.50, 1.20, np.inf, 0.50, 1.00])\n        )\n    ]\n\n    results = []\n\n    for y, sigma in test_cases:\n        # Calculate weights w_i = 1/sigma_i^2.\n        # np.inf**2 is inf, and 1/inf is 0.0, handling the infinite variance case.\n        with np.errstate(divide='ignore'): # Suppress divide by zero warning for inf\n            weights = 1.0 / (sigma**2)\n        \n        # Construct the diagonal weight matrix W.\n        W = np.diag(weights)\n\n        # Compute the matrix A = S^T * W * S.\n        A = S.T @ W @ S\n        \n        # Compute the vector b = S^T * W * y.\n        b = S.T @ W @ y\n        \n        # Calculate the Moore-Penrose pseudoinverse of A.\n        A_pinv = np.linalg.pinv(A)\n        \n        # Calculate the weighted least squares estimate of h.\n        h_hat = A_pinv @ b\n        \n        # Round the result to 2 decimal places and convert to a list.\n        rounded_h = np.round(h_hat, 2).tolist()\n        results.append(rounded_h)\n\n    # Format the final output string as a list of lists.\n    # The default str() representation of a list of lists is used,\n    # and join(',') correctly assembles the final string.\n    # e.g., str([1.0, 2.0]) -> '[1.0, 2.0]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}