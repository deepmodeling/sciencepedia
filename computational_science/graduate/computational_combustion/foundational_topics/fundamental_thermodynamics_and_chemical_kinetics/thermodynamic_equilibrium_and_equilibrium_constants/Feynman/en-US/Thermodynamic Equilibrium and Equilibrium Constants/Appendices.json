{
    "hands_on_practices": [
        {
            "introduction": "This first practice establishes the fundamental connection between first-principle thermodynamics and the practical computation of equilibrium constants. By deriving the expression for $K_p(T)$ from the chemical potential and then implementing a program to calculate its value for a key reaction in thermal $\\mathrm{NO_x}$ formation, you will solidify your understanding of how thermochemical data governs chemical equilibrium. This exercise () is essential for building predictive models of high-temperature gas systems.",
            "id": "4072086",
            "problem": "Consider the elementary gas-phase reaction under ideal-gas assumptions, at a standard state pressure of $p^\\circ = 1\\,\\mathrm{bar}$, $$\\mathrm{N_2} + \\mathrm{O_2} \\rightleftharpoons 2\\,\\mathrm{NO}.$$ Starting only from the definitions of chemical potential, the equilibrium condition, and the thermodynamic identities relating the Gibbs free energy, enthalpy, entropy, and heat capacity, derive an expression for the dimensionless equilibrium constant in terms of the standard-state molar Gibbs energy change of reaction at temperature $T$ for this reaction. Then, implement the derived expression to compute the temperature dependence of the equilibrium constant using the provided standard thermochemical data and heat capacity correlations.\n\nAssumptions and given standard thermochemical data:\n- Ideal gas behavior for all species, with the standard state defined at $p^\\circ = 1\\,\\mathrm{bar}$.\n- Reference temperature $T_0 = 298.15\\,\\mathrm{K}$.\n- Universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nFor each species $i \\in \\{\\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{NO}\\}$, the molar heat capacity is given by the quadratic correlation\n$$ c_{p,i}(T) = a_i + b_i T + c_i T^2, $$\nwith $c_{p,i}$ in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and $T$ in $\\mathrm{K}$, valid for $298\\,\\mathrm{K} \\le T \\le 3500\\,\\mathrm{K}$. The coefficients are:\n- For $\\mathrm{N_2}$: $a_{\\mathrm{N_2}} = 26.0385\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $b_{\\mathrm{N_2}} = 0.01084\\,\\mathrm{J\\,mol^{-1}\\,K^{-2}}$, $c_{\\mathrm{N_2}} = -1.875\\times 10^{-6}\\,\\mathrm{J\\,mol^{-1}\\,K^{-3}}$.\n- For $\\mathrm{O_2}$: $a_{\\mathrm{O_2}} = 25.9580\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $b_{\\mathrm{O_2}} = 0.01200\\,\\mathrm{J\\,mol^{-1}\\,K^{-2}}$, $c_{\\mathrm{O_2}} = -1.955\\times 10^{-6}\\,\\mathrm{J\\,mol^{-1}\\,K^{-3}}$.\n- For $\\mathrm{NO}$: $a_{\\mathrm{NO}} = 27.7537\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $b_{\\mathrm{NO}} = 0.007463\\,\\mathrm{J\\,mol^{-1}\\,K^{-2}}$, $c_{\\mathrm{NO}} = -1.212\\times 10^{-6}\\,\\mathrm{J\\,mol^{-1}\\,K^{-3}}$.\n\nStandard molar entropies at $T_0$:\n- $S^\\circ_{\\mathrm{N_2}}(T_0) = 191.609\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n- $S^\\circ_{\\mathrm{O_2}}(T_0) = 205.147\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n- $S^\\circ_{\\mathrm{NO}}(T_0) = 210.765\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nStandard molar enthalpies of formation at $T_0$:\n- $h^\\circ_{f,\\mathrm{N_2}}(T_0) = 0\\,\\mathrm{J\\,mol^{-1}}$,\n- $h^\\circ_{f,\\mathrm{O_2}}(T_0) = 0\\,\\mathrm{J\\,mol^{-1}}$,\n- $h^\\circ_{f,\\mathrm{NO}}(T_0) = 90290\\,\\mathrm{J\\,mol^{-1}}$.\n\nUse the above data and correlations to compute for each species $i$ its standard molar enthalpy $H^\\circ_i(T)$ and standard molar entropy $S^\\circ_i(T)$ at a temperature $T$ by integrating from $T_0$ to $T$:\n- $$H^\\circ_i(T) = h^\\circ_{f,i}(T_0) + \\int_{T_0}^{T} c_{p,i}(T')\\,\\mathrm{d}T',$$\n- $$S^\\circ_i(T) = S^\\circ_i(T_0) + \\int_{T_0}^{T} \\frac{c_{p,i}(T')}{T'}\\,\\mathrm{d}T'.$$\n\nThen obtain $G^\\circ_i(T) = H^\\circ_i(T) - T\\,S^\\circ_i(T)$ and the reaction standard Gibbs energy change\n$$\\Delta G^\\circ(T) = 2\\,G^\\circ_{\\mathrm{NO}}(T) - G^\\circ_{\\mathrm{N_2}}(T) - G^\\circ_{\\mathrm{O_2}}(T).$$\n\nFinally, compute the dimensionless equilibrium constant $K_p(T)$ for the reaction at each temperature $T$ as dictated by your derivation.\n\nImplement a program that computes $K_p(T)$ for the following test suite of temperatures (all in $\\mathrm{K}$):\n- $298.15$ (edge case near the reference state),\n- $1000.0$ (moderate high temperature),\n- $2000.0$ (typical combustion-relevant high temperature),\n- $3000.0$ (very high temperature),\n- $3500.0$ (upper bound of given heat capacity validity).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$). Each result must be a float in scientific notation with exactly eight digits after the decimal point, and the equilibrium constant is dimensionless. For example, a valid output might look like $[1.23456789e-03,2.34567891e-02,3.45678912e+00]$.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard problem in chemical thermodynamics, providing all necessary data and a clear methodology for its solution.\n\nThe solution is developed in two parts as requested: first, a derivation of the relationship between the equilibrium constant and the standard Gibbs free energy change of reaction, and second, the detailed calculation of the equilibrium constant at specified temperatures.\n\n### Part 1: Derivation of the Equilibrium Constant Expression\n\nThe chemical potential, $\\mu_i$, of a species $i$ in an ideal gas mixture at temperature $T$ and partial pressure $p_i$ is given by:\n$$\n\\mu_i(T, p_i) = \\mu_i^\\circ(T) + RT \\ln\\left(\\frac{p_i}{p^\\circ}\\right)\n$$\nwhere $\\mu_i^\\circ(T)$ is the standard chemical potential of species $i$ at temperature $T$ and the standard pressure $p^\\circ = 1\\,\\mathrm{bar}$. The universal gas constant is denoted by $R$. The standard chemical potential $\\mu_i^\\circ(T)$ is identical to the standard molar Gibbs free energy, $G^\\circ_i(T)$, of the species. Thus, we can write:\n$$\n\\mu_i(T, p_i) = G^\\circ_i(T) + RT \\ln\\left(\\frac{p_i}{p^\\circ}\\right)\n$$\nThe condition for chemical equilibrium for a general reaction $\\sum_i \\nu_i M_i = 0$ at constant temperature and pressure is that the change in Gibbs free energy is zero:\n$$\n\\Delta G_{rxn} = \\sum_i \\nu_i \\mu_i = 0\n$$\nwhere $\\nu_i$ are the stoichiometric coefficients (positive for products, negative for reactants) and $M_i$ represents the chemical species.\n\nFor the specific reaction $\\mathrm{N_2} + \\mathrm{O_2} \\rightleftharpoons 2\\,\\mathrm{NO}$, the stoichiometric coefficients are $\\nu_{\\mathrm{N_2}} = -1$, $\\nu_{\\mathrm{O_2}} = -1$, and $\\nu_{\\mathrm{NO}} = 2$. Applying the equilibrium condition:\n$$\n2\\mu_{\\mathrm{NO}} - \\mu_{\\mathrm{N_2}} - \\mu_{\\mathrm{O_2}} = 0\n$$\nSubstituting the expression for the chemical potential of each species:\n$$\n2\\left[G^\\circ_{\\mathrm{NO}}(T) + RT \\ln\\left(\\frac{p_{\\mathrm{NO}}}{p^\\circ}\\right)\\right] - \\left[G^\\circ_{\\mathrm{N_2}}(T) + RT \\ln\\left(\\frac{p_{\\mathrm{N_2}}}{p^\\circ}\\right)\\right] - \\left[G^\\circ_{\\mathrm{O_2}}(T) + RT \\ln\\left(\\frac{p_{\\mathrm{O_2}}}{p^\\circ}\\right)\\right] = 0\n$$\nWe can rearrange this equation by grouping the standard Gibbs free energy terms and the logarithmic terms:\n$$\n\\left(2G^\\circ_{\\mathrm{NO}}(T) - G^\\circ_{\\mathrm{N_2}}(T) - G^\\circ_{\\mathrm{O_2}}(T)\\right) + RT\\left[2\\ln\\left(\\frac{p_{\\mathrm{NO}}}{p^\\circ}\\right) - \\ln\\left(\\frac{p_{\\mathrm{N_2}}}{p^\\circ}\\right) - \\ln\\left(\\frac{p_{\\mathrm{O_2}}}{p^\\circ}\\right)\\right] = 0\n$$\nThe first term in parentheses is the standard Gibbs free energy change for the reaction, $\\Delta G^\\circ(T)$:\n$$\n\\Delta G^\\circ(T) = \\sum_i \\nu_i G^\\circ_i(T) = 2G^\\circ_{\\mathrm{NO}}(T) - G^\\circ_{\\mathrm{N_2}}(T) - G^\\circ_{\\mathrm{O_2}}(T)\n$$\nUsing the properties of logarithms, the second term can be combined:\n$$\nRT\\left[\\ln\\left(\\left(\\frac{p_{\\mathrm{NO}}}{p^\\circ}\\right)^2\\right) - \\ln\\left(\\frac{p_{\\mathrm{N_2}}}{p^\\circ}\\right) - \\ln\\left(\\frac{p_{\\mathrm{O_2}}}{p^\\circ}\\right)\\right] = RT \\ln\\left[\\frac{\\left(p_{\\mathrm{NO}}/p^\\circ\\right)^2}{\\left(p_{\\mathrm{N_2}}/p^\\circ\\right)\\left(p_{\\mathrm{O_2}}/p^\\circ\\right)}\\right]\n$$\nThe dimensionless quantity inside the logarithm is the equilibrium constant expressed in terms of partial pressures, $K_p(T)$:\n$$\nK_p(T) = \\frac{\\left(p_{\\mathrm{NO}}/p^\\circ\\right)^2}{\\left(p_{\\mathrm{N_2}}/p^\\circ\\right)\\left(p_{\\mathrm{O_2}}/p^\\circ\\right)}\n$$\nSubstituting these definitions back into the equilibrium condition equation yields:\n$$\n\\Delta G^\\circ(T) + RT \\ln(K_p(T)) = 0\n$$\nSolving for $K_p(T)$ provides the required relationship:\n$$\n\\ln(K_p(T)) = -\\frac{\\Delta G^\\circ(T)}{RT} \\implies K_p(T) = \\exp\\left(-\\frac{\\Delta G^\\circ(T)}{RT}\\right)\n$$\nThis completes the derivation.\n\n### Part 2: Computational Procedure\n\nTo compute $K_p(T)$, we must first determine $\\Delta G^\\circ(T)$ at each specified temperature $T$. This requires calculating the standard molar Gibbs free energy $G^\\circ_i(T)$ for each species $i \\in \\{\\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{NO}\\}$.\n\n**Step 1: Calculate Standard Molar Enthalpy $H^\\circ_i(T)$**\n\nThe standard molar enthalpy at temperature $T$ is found by integrating the molar heat capacity $c_{p,i}(T')$ from the reference temperature $T_0 = 298.15\\,\\mathrm{K}$ to $T$, and adding the standard enthalpy of formation at $T_0$, $h^\\circ_{f,i}(T_0)$.\n$$\nH^\\circ_i(T) = h^\\circ_{f,i}(T_0) + \\int_{T_0}^{T} c_{p,i}(T')\\,\\mathrm{d}T'\n$$\nGiven the quadratic correlation $c_{p,i}(T') = a_i + b_i T' + c_i (T')^2$, the integral is:\n$$\n\\int_{T_0}^{T} (a_i + b_i T' + c_i (T')^2)\\,\\mathrm{d}T' = \\left[a_i T' + \\frac{b_i}{2}(T')^2 + \\frac{c_i}{3}(T')^3\\right]_{T_0}^{T}\n$$\n$$\n= a_i(T - T_0) + \\frac{b_i}{2}(T^2 - T_0^2) + \\frac{c_i}{3}(T^3 - T_0^3)\n$$\nThus, $H^\\circ_i(T)$ can be computed for each species using the provided coefficients $a_i, b_i, c_i$ and the standard enthalpy of formation $h^\\circ_{f,i}(T_0)$.\n\n**Step 2: Calculate Standard Molar Entropy $S^\\circ_i(T)$**\n\nSimilarly, the standard molar entropy at temperature $T$ is found by integrating $c_{p,i}(T')/T'$ from $T_0$ to $T$ and adding the standard entropy at $T_0$, $S^\\circ_i(T_0)$.\n$$\nS^\\circ_i(T) = S^\\circ_i(T_0) + \\int_{T_0}^{T} \\frac{c_{p,i}(T')}{T'}\\,\\mathrm{d}T'\n$$\nThe integral evaluates to:\n$$\n\\int_{T_0}^{T} \\left(\\frac{a_i}{T'} + b_i + c_i T'\\right)\\,\\mathrm{d}T' = \\left[a_i \\ln(T') + b_i T' + \\frac{c_i}{2}(T')^2\\right]_{T_0}^{T}\n$$\n$$\n= a_i(\\ln(T) - \\ln(T_0)) + b_i(T - T_0) + \\frac{c_i}{2}(T^2 - T_0^2) = a_i\\ln\\left(\\frac{T}{T_0}\\right) + b_i(T - T_0) + \\frac{c_i}{2}(T^2 - T_0^2)\n$$\nThus, $S^\\circ_i(T)$ can be computed for each species using the provided coefficients and the standard entropy $S^\\circ_i(T_0)$.\n\n**Step 3: Calculate Standard Molar Gibbs Free Energy $G^\\circ_i(T)$**\n\nWith $H^\\circ_i(T)$ and $S^\\circ_i(T)$ known, the standard molar Gibbs free energy is calculated using its definition:\n$$\nG^\\circ_i(T) = H^\\circ_i(T) - T S^\\circ_i(T)\n$$\n\n**Step 4: Calculate Standard Gibbs Free Energy Change of Reaction $\\Delta G^\\circ(T)$**\n\nUsing the values of $G^\\circ_i(T)$ for each species, the standard Gibbs free energy change for the reaction $\\mathrm{N_2} + \\mathrm{O_2} \\rightleftharpoons 2\\,\\mathrm{NO}$ is:\n$$\n\\Delta G^\\circ(T) = 2 G^\\circ_{\\mathrm{NO}}(T) - G^\\circ_{\\mathrm{N_2}}(T) - G^\\circ_{\\mathrm{O_2}}(T)\n$$\n\n**Step 5: Calculate the Equilibrium Constant $K_p(T)$**\n\nFinally, the dimensionless equilibrium constant $K_p(T)$ is computed using the derived formula from Part 1:\n$$\nK_p(T) = \\exp\\left(-\\frac{\\Delta G^\\circ(T)}{RT}\\right)\n$$\nThis procedure is applied for each temperature in the test suite to obtain the final results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the temperature-dependent equilibrium constant Kp for the reaction N2 + O2 = 2NO.\n    \"\"\"\n    # Global constants\n    R = 8.314462618  # Universal gas constant in J mol^-1 K^-1\n    T0 = 298.15        # Reference temperature in K\n\n    # Thermochemical data for each species\n    # h_f_T0: Standard enthalpy of formation at T0 in J/mol\n    # s_T0: Standard entropy at T0 in J mol^-1 K^-1\n    # cp_coeffs: Coefficients for cp(T) = a + bT + cT^2\n    species_data = {\n        'N2': {\n            'h_f_T0': 0.0,\n            's_T0': 191.609,\n            'cp_coeffs': {'a': 26.0385, 'b': 0.01084, 'c': -1.875e-6}\n        },\n        'O2': {\n            'h_f_T0': 0.0,\n            's_T0': 205.147,\n            'cp_coeffs': {'a': 25.9580, 'b': 0.01200, 'c': -1.955e-6}\n        },\n        'NO': {\n            'h_f_T0': 90290.0,\n            's_T0': 210.765,\n            'cp_coeffs': {'a': 27.7537, 'b': 0.007463, 'c': -1.212e-6}\n        }\n    }\n\n    # Test suite of temperatures in Kelvin\n    temperatures = [298.15, 1000.0, 2000.0, 3000.0, 3500.0]\n\n    def calculate_thermo_properties(T, species):\n        \"\"\"\n        Calculates standard molar enthalpy H_T and entropy S_T at temperature T.\n        \n        Args:\n            T (float): The target temperature in K.\n            species (dict): A dictionary containing thermochemical data for the species.\n\n        Returns:\n            tuple: A tuple containing (H_T, S_T) in J/mol and J/(mol*K) respectively.\n        \"\"\"\n        h_f_T0 = species['h_f_T0']\n        s_T0 = species['s_T0']\n        a = species['cp_coeffs']['a']\n        b = species['cp_coeffs']['b']\n        c = species['cp_coeffs']['c']\n\n        # Calculate the change in enthalpy from T0 to T by integrating cp(T)\n        delta_H = a * (T - T0) + (b / 2) * (T**2 - T0**2) + (c / 3) * (T**3 - T0**3)\n        H_T = h_f_T0 + delta_H\n\n        # Calculate the change in entropy from T0 to T by integrating cp(T)/T\n        # Handle the case T = T0 to avoid log(1) computation, although it is zero.\n        if T == T0:\n            delta_S = 0.0\n        else:\n            delta_S = a * np.log(T / T0) + b * (T - T0) + (c / 2) * (T**2 - T0**2)\n        S_T = s_T0 + delta_S\n        \n        return H_T, S_T\n\n    results = []\n    for T in temperatures:\n        # Calculate H and S for each species at temperature T\n        H_N2, S_N2 = calculate_thermo_properties(T, species_data['N2'])\n        H_O2, S_O2 = calculate_thermo_properties(T, species_data['O2'])\n        H_NO, S_NO = calculate_thermo_properties(T, species_data['NO'])\n\n        # Calculate standard molar Gibbs free energy G = H - T*S for each species\n        G_N2 = H_N2 - T * S_N2\n        G_O2 = H_O2 - T * S_O2\n        G_NO = H_NO - T * S_NO\n\n        # Calculate the standard Gibbs free energy change for the reaction\n        # Reaction: N2 + O2 = 2NO\n        # Stoichiometric coefficients: v_NO = 2, v_N2 = -1, v_O2 = -1\n        delta_G_reaction = 2 * G_NO - (G_N2 + G_O2)\n\n        # Calculate the equilibrium constant Kp\n        Kp = np.exp(-delta_G_reaction / (R * T))\n        results.append(Kp)\n\n    # Format the results into the required string format\n    output_str = f\"[{','.join([f'{r:.8e}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Realistic combustion systems involve numerous species and reactions, requiring a systematic approach to problem formulation. This practice moves beyond a single reaction to address the setup of a complex multi-species equilibrium problem for a methane-air mixture. By defining the elemental conservation constraints and determining the number of independent reactions needed for a solution (), you will learn the foundational step common to all computational chemical equilibrium codes.",
            "id": "4072095",
            "problem": "A lean premixed methane–air mixture at equivalence ratio $\\phi=0.8$ is brought to thermodynamic equilibrium at fixed temperature $T$ and pressure $P$. Assume an ideal gas mixture and dry air with molar composition $y_{\\mathrm{O_2}}=0.21$ and $y_{\\mathrm{N_2}}=0.79$. Consider $1$ mol of initial methane, $\\mathrm{CH_4}$, premixed with air. For the equilibrium calculation, adopt the chemically plausible species set $\\mathcal{S}=\\{\\mathrm{CO_2},\\mathrm{CO},\\mathrm{H_2O},\\mathrm{H_2},\\mathrm{O_2},\\mathrm{O},\\mathrm{H},\\mathrm{OH},\\mathrm{N_2}\\}$ and neglect all other species and ionization. Treat nitrogen chemistry as frozen except for $\\mathrm{N_2}$.\n\nUsing only fundamental conservation of chemical elements and the definition of equivalence ratio, proceed as follows:\n\n1) From the definition of equivalence ratio and the stoichiometry of complete methane oxidation, determine the initial moles of $\\mathrm{O_2}$ and $\\mathrm{N_2}$ present per $1$ mol of $\\mathrm{CH_4}$ at $\\phi=0.8$.\n\n2) Formulate the elemental conservation constraints for elements $\\mathrm{C}$, $\\mathrm{H}$, $\\mathrm{O}$, and $\\mathrm{N}$ in the compact matrix form $\\mathbf{A}\\,\\mathbf{n}=\\mathbf{b}$, where $\\mathbf{n}$ collects the unknown equilibrium mole numbers of the species in $\\mathcal{S}$ and $\\mathbf{b}$ collects the total element moles implied by the initial mixture.\n\n3) Based on these constraints and the chosen species set, determine the minimum number of independent equilibrium-constant relations required to close a mass-action formulation for the composition at fixed $T$ and $P$.\n\nExpress the final answer as a single integer. No rounding is required. No units are needed for the final answer.",
            "solution": "The problem asks for the minimum number of independent equilibrium-constant relations required to determine the composition of a methane-air mixture at thermodynamic equilibrium. The solution to such a problem is found by balancing the number of unknown species concentrations with the number of available constraint equations. In a system at fixed temperature $T$ and pressure $P$, the unknowns are the mole numbers, $n_j$, of each of the $N_{species}$ species present at equilibrium.\n\nThese unknowns are subject to $K$ linear constraints imposed by the conservation of chemical elements. The number of independent elemental conservation equations, $K$, is equal to the rank of the atom matrix $\\mathbf{A}$, where $A_{ij}$ is the number of atoms of element $i$ in a molecule of species $j$.\n\nThe system of $N_{species}$ unknown mole numbers is therefore underdetermined by the $K$ elemental conservation equations alone. To close the system, we must introduce additional equations derived from the principle of chemical equilibrium. For a mass-action formulation, this is accomplished by specifying a set of $N_{reactions}$ independent chemical reactions. The law of mass action is then applied to each of these reactions, providing one equilibrium-constant relation per reaction. The minimum number of such relations required to close the system is the number of independent reactions, given by:\n$$N_{reactions} = N_{species} - K = N_{species} - \\text{rank}(\\mathbf{A})$$\nWe will now follow the steps outlined in the problem to determine this number.\n\n1) First, we determine the composition of the initial reactant mixture. The problem specifies $1$ mol of methane, $\\mathrm{CH_4}$, premixed with air at an equivalence ratio of $\\phi=0.8$. The stoichiometric (complete) oxidation of methane in air is:\n$$\\mathrm{CH_4} + a_{st}(\\mathrm{O_2} + \\frac{y_{\\mathrm{N_2}}}{y_{\\mathrm{O_2}}}\\mathrm{N_2}) \\rightarrow \\mathrm{CO_2} + 2\\mathrm{H_2O} + a_{st} \\frac{y_{\\mathrm{N_2}}}{y_{\\mathrm{O_2}}}\\mathrm{N_2}$$\nBalancing the oxygen atoms gives $2 = a_{st} \\times 2$, so the stoichiometric oxygen-to-fuel mole ratio is $a_{st} = 2$.\n\nThe equivalence ratio $\\phi$ is defined as the actual fuel-to-oxidizer ratio divided by the stoichiometric fuel-to-oxidizer ratio. Using moles of $\\mathrm{O_2}$ as the measure of the oxidizer:\n$$\\phi = \\frac{(\\text{moles of fuel} / \\text{moles of } \\mathrm{O_2})_{actual}}{(\\text{moles of fuel} / \\text{moles of } \\mathrm{O_2})_{st}} = \\frac{(1 / a_{actual})}{(1 / a_{st})} = \\frac{a_{st}}{a_{actual}}$$\nGiven $\\phi=0.8$ and $a_{st}=2$, we find the actual moles of $\\mathrm{O_2}$ per mole of $\\mathrm{CH_4}$:\n$$a_{actual} = \\frac{a_{st}}{\\phi} = \\frac{2}{0.8} = 2.5$$\nSo, the initial mixture contains $2.5$ mol of $\\mathrm{O_2}$. The moles of $\\mathrm{N_2}$ are determined by the composition of air:\n$$n_{\\mathrm{N_2,init}} = a_{actual} \\times \\frac{y_{\\mathrm{N_2}}}{y_{\\mathrm{O_2}}} = 2.5 \\times \\frac{0.79}{0.21}$$\nThe initial reactant mixture is $1\\,\\mathrm{CH_4} + 2.5\\,\\mathrm{O_2} + (2.5 \\times \\frac{0.79}{0.21})\\,\\mathrm{N_2}$.\n\n2) Next, we formulate the elemental conservation constraints in the form $\\mathbf{A}\\,\\mathbf{n}=\\mathbf{b}$. The set of plausible equilibrium species is given as $\\mathcal{S}=\\{\\mathrm{CO_2},\\mathrm{CO},\\mathrm{H_2O},\\mathrm{H_2},\\mathrm{O_2},\\mathrm{O},\\mathrm{H},\\mathrm{OH},\\mathrm{N_2}\\}$. The number of species is $N_{species} = 9$. The vector of unknown equilibrium mole numbers is:\n$$\\mathbf{n} = \\begin{pmatrix} n_{\\mathrm{CO_2}} \\\\ n_{\\mathrm{CO}} \\\\ n_{\\mathrm{H_2O}} \\\\ n_{\\mathrm{H_2}} \\\\ n_{\\mathrm{O_2}} \\\\ n_{\\mathrm{O}} \\\\ n_{\\mathrm{H}} \\\\ n_{\\mathrm{OH}} \\\\ n_{\\mathrm{N_2}} \\end{pmatrix}$$\nThe vector $\\mathbf{b}$ contains the total moles of each element (C, H, O, N) in the initial mixture. Based on $1\\,\\mathrm{CH_4} + 2.5\\,\\mathrm{O_2} + (2.5 \\times \\frac{0.79}{0.21})\\,\\mathrm{N_2}$:\n$b_C = 1 \\times (\\text{moles of } \\mathrm{CH_4}) = 1$\n$b_H = 4 \\times (\\text{moles of } \\mathrm{CH_4}) = 4$\n$b_O = 2 \\times (\\text{moles of } \\mathrm{O_2}) = 2 \\times 2.5 = 5$\n$b_N = 2 \\times (\\text{moles of } \\mathrm{N_2}) = 2 \\times (2.5 \\times \\frac{0.79}{0.21}) = \\frac{3.95}{0.21}$\nSo, $\\mathbf{b} = [1, 4, 5, \\frac{3.95}{0.21}]^T$.\n\nThe atom matrix $\\mathbf{A}$ has its rows corresponding to the elements (C, H, O, N) and columns corresponding to the species in $\\mathbf{n}$. The entry $A_{ij}$ is the number of atoms of element $i$ in species $j$.\n$$\\mathbf{A} = \\begin{pmatrix}\n1  1  0  0  0  0  0  0  0 \\\\\n0  0  2  2  0  0  1  1  0 \\\\\n2  1  1  0  2  1  0  1  0 \\\\\n0  0  0  0  0  0  0  0  2\n\\end{pmatrix}$$\n\n3) Finally, we determine the minimum number of independent equilibrium-constant relations, which is $N_{species} - \\text{rank}(\\mathbf{A})$. We have $N_{species}=9$. We must find the rank of the $4 \\times 9$ matrix $\\mathbf{A}$. The rank is the number of linearly independent rows or columns. The four rows represent the conservation of four distinct chemical elements: C, H, O, and N. We can formally prove their linear independence. A linear combination of the rows is zero if $c_1 \\mathbf{r}_1 + c_2 \\mathbf{r}_2 + c_3 \\mathbf{r}_3 + c_4 \\mathbf{r}_4 = \\mathbf{0}$, where $\\mathbf{r}_i$ is the $i$-th row.\nLooking at the 9th column, we have $c_4 \\cdot 2 = 0$, which implies $c_4=0$.\nLooking at the 1st column, we have $c_1 \\cdot 1 + c_3 \\cdot 2 = 0$.\nLooking at the 2nd column, we have $c_1 \\cdot 1 + c_3 \\cdot 1 = 0$.\nSubtracting the second equation from the first gives $c_3=0$, which in turn implies $c_1=0$.\nLooking at the 3rd column, with $c_1=c_3=0$, we have $c_2 \\cdot 2 = 0$, which implies $c_2=0$.\nSince $c_1=c_2=c_3=c_4=0$ is the only solution, the four row vectors are linearly independent. Therefore, the rank of matrix $\\mathbf{A}$ is $4$.\n\nAn alternative method is to find a $4 \\times 4$ submatrix with a non-zero determinant. Let us select the columns corresponding to the species $\\mathrm{CO_2}$, $\\mathrm{H_2O}$, $\\mathrm{O_2}$, and $\\mathrm{N_2}$ (columns 1, 3, 5, and 9):\n$$\\begin{vmatrix}\n1  0  0  0 \\\\\n0  2  0  0 \\\\\n2  1  2  0 \\\\\n0  0  0  2\n\\end{vmatrix} = 1 \\cdot 2 \\cdot 2 \\cdot 2 = 8$$\nSince the determinant is non-zero, the rank of $\\mathbf{A}$ is at least $4$. As the matrix has only $4$ rows, its rank cannot exceed $4$. Thus, $\\text{rank}(\\mathbf{A}) = 4$.\n\nThe number of independent equilibrium-constant relations is:\n$$N_{reactions} = N_{species} - \\text{rank}(\\mathbf{A}) = 9 - 4 = 5$$\nThis is the number of independent reactions that can be formed among the $9$ species, and it represents the number of additional non-linear equations required to solve for the equilibrium mole numbers, in addition to the $4$ linear elemental conservation constraints.",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "The predictions of any computational model are only as reliable as their input data, which always contains some degree of uncertainty. This advanced practice introduces the crucial concept of sensitivity analysis, a method for quantifying how errors in thermochemical data propagate to the final results. By applying linearization to the water-gas shift reaction (), you will gain a hands-on understanding of how to assess the robustness of your equilibrium calculations.",
            "id": "4072059",
            "problem": "Consider the gas-phase reaction $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$ at constant temperature $T$ and pressure $p$, modeled as an ideal gas mixture. An initially prepared mixture contains $1$ $\\mathrm{mol}$ of $\\mathrm{CO_2}$ and $1$ $\\mathrm{mol}$ of $\\mathrm{H_2}$, with no $\\mathrm{CO}$ or $\\mathrm{H_2O}$ present. The system is brought to thermodynamic equilibrium at $T = 1200 \\ \\mathrm{K}$ and $p = 1 \\ \\mathrm{bar}$. At this temperature, the reaction’s equilibrium constant in terms of partial pressures, $K_p$, has been determined (from standard thermochemical data) to equal $1$.\n\nSuppose now that the standard enthalpy of formation of water vapor at the same temperature, $\\Delta H_f^\\circ(\\mathrm{H_2O}, T)$, is subject to a small uncertain perturbation. Assume the uncertainty affects only the enthalpy, not the standard entropy of formation, so that the resulting perturbation of the reaction’s standard Gibbs free energy change is $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = \\nu_{\\mathrm{H_2O}} \\, \\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T)$, where $\\nu_{\\mathrm{H_2O}}$ is the stoichiometric coefficient of $\\mathrm{H_2O}$ in the reaction. The universal gas constant is $R = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$.\n\nUsing linearization of the mass-action equations about the nominal equilibrium state at $K_p = 1$, quantify the first-order change in the equilibrium mole fraction of carbon monoxide, $\\delta y_{\\mathrm{CO}}$, caused by a positive perturbation $\\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T) = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$. Express your answer as a decimal, and round to four significant figures. The final answer must be given without units.",
            "solution": "The problem is first validated.\n\n*   **Givens Extraction**:\n    *   Reaction: $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$\n    *   Phase: Gas phase, ideal gas mixture.\n    *   Conditions: Constant temperature $T = 1200 \\ \\mathrm{K}$ and pressure $p = 1 \\ \\mathrm{bar}$.\n    *   Initial composition: $n_{\\mathrm{CO_2},0} = 1 \\ \\mathrm{mol}$, $n_{\\mathrm{H_2},0} = 1 \\ \\mathrm{mol}$, $n_{\\mathrm{CO},0} = 0 \\ \\mathrm{mol}$, $n_{\\mathrm{H_2O},0} = 0 \\ \\mathrm{mol}$.\n    *   Nominal equilibrium constant: $K_p = 1$.\n    *   Perturbation expression: $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = \\nu_{\\mathrm{H_2O}} \\, \\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T)$.\n    *   Perturbation magnitude: $\\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T) = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$.\n    *   Constant: $R = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$.\n    *   Objective: Find the first-order change in the equilibrium mole fraction of carbon monoxide, $\\delta y_{\\mathrm{CO}}$, using linearization.\n\n*   **Validation**:\n    *   The problem is scientifically grounded in the principles of chemical thermodynamics, specifically the law of mass action and the relationship between Gibbs free energy and the equilibrium constant.\n    *   The reaction is the well-known water-gas shift reaction, and the given conditions are physically plausible.\n    *   The problem is well-posed, providing all necessary data and a clear objective. It specifies the method of linearization, which is a standard analytical technique.\n    *   The setup is internally consistent and free of ambiguities.\n    *   The problem is deemed **valid**.\n\nThe solution proceeds as follows.\n\nFirst, we characterize the nominal equilibrium state. Let $\\xi$ be the extent of reaction in moles. Based on the stoichiometry of $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$ and the initial amounts, the number of moles of each species at equilibrium is:\n$n_{\\mathrm{CO_2}} = 1 - \\xi$\n$n_{\\mathrm{H_2}} = 1 - \\xi$\n$n_{\\mathrm{CO}} = \\xi$\n$n_{\\mathrm{H_2O}} = \\xi$\n\nThe total number of moles in the mixture is $N_{tot} = (1 - \\xi) + (1 - \\xi) + \\xi + \\xi = 2$. The total number of moles is constant throughout the reaction.\n\nThe mole fraction of each species $i$, $y_i$, is given by $y_i = n_i / N_{tot}$.\n$y_{\\mathrm{CO_2}} = \\frac{1 - \\xi}{2}$\n$y_{\\mathrm{H_2}} = \\frac{1 - \\xi}{2}$\n$y_{\\mathrm{CO}} = \\frac{\\xi}{2}$\n$y_{\\mathrm{H_2O}} = \\frac{\\xi}{2}$\n\nThe equilibrium constant in terms of partial pressures, $K_p$, is defined as:\n$$K_p = \\frac{p_{\\mathrm{CO}} p_{\\mathrm{H_2O}}}{p_{\\mathrm{CO_2}} p_{\\mathrm{H_2}}}$$\nUsing Dalton's law, the partial pressure of species $i$ is $p_i = y_i p$.\n$$K_p = \\frac{(y_{\\mathrm{CO}} p) (y_{\\mathrm{H_2O}} p)}{(y_{\\mathrm{CO_2}} p) (y_{\\mathrm{H_2}} p)} = \\frac{y_{\\mathrm{CO}} y_{\\mathrm{H_2O}}}{y_{\\mathrm{CO_2}} y_{\\mathrm{H_2}}} p^{(1+1)-(1+1)} = \\frac{y_{\\mathrm{CO}} y_{\\mathrm{H_2O}}}{y_{\\mathrm{CO_2}} y_{\\mathrm{H_2}}}$$\nSince the sum of stoichiometric coefficients of products minus reactants, $\\Delta \\nu_g$, is $0$, $K_p$ is independent of pressure and equal to the equilibrium constant in terms of mole fractions, $K_y$.\n\nSubstituting the expressions for mole fractions in terms of $\\xi$:\n$$K_p = \\frac{(\\frac{\\xi}{2})(\\frac{\\xi}{2})}{(\\frac{1-\\xi}{2})(\\frac{1-\\xi}{2})} = \\frac{\\xi^2}{(1-\\xi)^2} = \\left(\\frac{\\xi}{1-\\xi}\\right)^2$$\n\nFor the nominal equilibrium state, we are given $K_p = 1$. Solving for the nominal equilibrium extent of reaction, $\\xi_{eq}$:\n$$1 = \\left(\\frac{\\xi_{eq}}{1-\\xi_{eq}}\\right)^2$$\nSince $\\xi_{eq}$ must be positive (as products are formed from zero initial amounts), we take the positive square root:\n$$1 = \\frac{\\xi_{eq}}{1-\\xi_{eq}} \\implies 1 - \\xi_{eq} = \\xi_{eq} \\implies 2\\xi_{eq} = 1 \\implies \\xi_{eq} = 0.5 \\ \\mathrm{mol}$$\nThe nominal equilibrium mole fraction of carbon monoxide, $y_{\\mathrm{CO},eq}$, is:\n$$y_{\\mathrm{CO},eq} = \\frac{\\xi_{eq}}{2} = \\frac{0.5}{2} = 0.25$$\n\nNext, we analyze the effect of the perturbation. We need to find the first-order change $\\delta y_{\\mathrm{CO}}$. Since $y_{\\mathrm{CO}} = \\xi/2$, the change is given by $\\delta y_{\\mathrm{CO}} = \\frac{1}{2} \\delta \\xi$. We need to find $\\delta \\xi$.\nWe use linearization to relate a small change in $K_p$, $\\delta K_p$, to the resulting change in $\\xi$, $\\delta \\xi$:\n$$\\delta K_p \\approx \\left(\\frac{dK_p}{d\\xi}\\right)_{\\xi_{eq}} \\delta \\xi$$\nWe must compute the derivative of $K_p$ with respect to $\\xi$:\n$$\\frac{dK_p}{d\\xi} = \\frac{d}{d\\xi} \\left[ ( \\xi (1-\\xi)^{-1} )^2 \\right] = 2\\left(\\frac{\\xi}{1-\\xi}\\right) \\frac{d}{d\\xi}\\left(\\frac{\\xi}{1-\\xi}\\right) = 2\\left(\\frac{\\xi}{1-\\xi}\\right) \\frac{(1)(1-\\xi) - (\\xi)(-1)}{(1-\\xi)^2} = 2\\left(\\frac{\\xi}{1-\\xi}\\right) \\frac{1}{(1-\\xi)^2} = \\frac{2\\xi}{(1-\\xi)^3}$$\nEvaluating this derivative at the nominal equilibrium point $\\xi_{eq} = 0.5$:\n$$\\left(\\frac{dK_p}{d\\xi}\\right)_{\\xi_{eq}=0.5} = \\frac{2(0.5)}{(1 - 0.5)^3} = \\frac{1}{(0.5)^3} = \\frac{1}{0.125} = 8$$\nThus, $\\delta \\xi \\approx \\frac{\\delta K_p}{8}$.\n\nNow, we must find $\\delta K_p$ resulting from the perturbation in the standard Gibbs free energy of reaction, $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ$. The relationship is:\n$$\\Delta G_{\\mathrm{rxn}}^\\circ = -RT \\ln K_p \\implies K_p = \\exp\\left(-\\frac{\\Delta G_{\\mathrm{rxn}}^\\circ}{RT}\\right)$$\nLinearizing this relationship:\n$$\\delta K_p \\approx \\left(\\frac{dK_p}{d(\\Delta G_{\\mathrm{rxn}}^\\circ)}\\right)_{\\text{nom}} \\delta \\Delta G_{\\mathrm{rxn}}^\\circ$$\nThe derivative is:\n$$\\frac{dK_p}{d(\\Delta G_{\\mathrm{rxn}}^\\circ)} = \\exp\\left(-\\frac{\\Delta G_{\\mathrm{rxn}}^\\circ}{RT}\\right) \\left(-\\frac{1}{RT}\\right) = -\\frac{K_p}{RT}$$\nAt the nominal state, $K_p = 1$, so:\n$$\\left(\\frac{dK_p}{d(\\Delta G_{\\mathrm{rxn}}^\\circ)}\\right)_{\\text{nom}} = -\\frac{1}{RT}$$\nTherefore, $\\delta K_p \\approx -\\frac{\\delta \\Delta G_{\\mathrm{rxn}}^\\circ}{RT}$.\n\nThe problem states that the perturbation in Gibbs free energy is $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = \\nu_{\\mathrm{H_2O}} \\, \\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T)$. For the reaction $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$, the stoichiometric coefficient of water vapor, $\\nu_{\\mathrm{H_2O}}$, is $+1$.\nGiven $\\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T) = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$, we have $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$.\n\nNow we can calculate $\\delta K_p$ using $T = 1200 \\ \\mathrm{K}$ and $R = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$:\n$$RT = (8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1})(1200 \\ \\mathrm{K}) = 9977.3551416 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$$\n$$\\delta K_p \\approx -\\frac{2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}}{9977.3551416 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}} \\approx -0.2004539$$\n\nUsing this, we find $\\delta \\xi$:\n$$\\delta \\xi \\approx \\frac{\\delta K_p}{8} \\approx \\frac{-0.2004539}{8} \\approx -0.0250567$$\n\nFinally, we calculate the change in the mole fraction of carbon monoxide:\n$$\\delta y_{\\mathrm{CO}} = \\frac{1}{2} \\delta \\xi \\approx \\frac{-0.0250567}{2} \\approx -0.01252835$$\n\nRounding the result to four significant figures, we get:\n$$\\delta y_{\\mathrm{CO}} \\approx -0.01253$$\nThe negative sign indicates that a positive perturbation to the Gibbs free energy of reaction shifts the equilibrium to the left, decreasing the amount of products, as expected.",
            "answer": "$$\\boxed{-0.01253}$$"
        }
    ]
}