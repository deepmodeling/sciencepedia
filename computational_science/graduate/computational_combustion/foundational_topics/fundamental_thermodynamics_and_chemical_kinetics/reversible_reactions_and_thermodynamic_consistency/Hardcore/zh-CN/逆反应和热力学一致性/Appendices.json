{
    "hands_on_practices": [
        {
            "introduction": "反应的热力学数据通常以基于压力的平衡常数 $K_p$ 给出。然而，化学动力学模拟通常使用物种浓度进行计算。本练习  旨在揭示一个关键且常见的陷阱：对于总摩尔数发生变化的反应（$\\Delta \\nu \\neq 0$），绝不能简单地假设 $K_p = K_c$。通过一个具体的计算，你将量化这种错误假设所引入的显著误差，从而巩固对这两种形式平衡常数之间必要转换的理解。",
            "id": "4058170",
            "problem": "考虑一个单步、可逆、基元气相反应，并假设其为理想气体，\n$$\\text{A} + \\text{B} \\rightleftharpoons \\text{C},$$\n其化学计量系数为 $\\nu_{\\text{A}} = -1$、$\\nu_{\\text{B}} = -1$、$\\nu_{\\text{C}} = +1$，因此化学计量系数之和为 $\\Delta \\nu = \\sum_{i} \\nu_{i} = -1$。系统温度为 $T = 1800$ $\\text{K}$，并采用以下标准态约定：标准压力为 $P^{\\circ} = 1.000 \\times 10^{5}$ $\\text{Pa}$，标准浓度为 $c^{\\circ} = 1.000$ $\\text{mol}\\,\\text{m}^{-3}$。普适气体常数为 $R = 8.314462618$ $\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。在温度 $T$ 下，基于分压（活度参考标准为 $P^{\\circ}$）的平衡常数为 $K_{p}(T) = 4.00 \\times 10^{-6}$（无量纲）。该机理采用质量作用动力学，以浓度单位（摩尔每立方米）表示，因此正向反应进程速率为 $r_{f} = k_{f}(T)\\,c_{\\text{A}}\\,c_{\\text{B}}$，逆向反应进程速率为 $r_{r} = k_{r}(T)\\,c_{\\text{C}}$。假设 $k_{f}(T)$ 已知且为有限值。\n\n仅从理想气体定律、平衡常数的标准定义以及质量作用动力学的细致平衡原理出发，完成以下任务：\n- 推导与所述标准态一致的 $K_{p}(T)$ 和基于浓度的平衡常数 $K_{c}(T)$ 之间的关系，并根据给定数据计算 $K_{c}(T)$。\n- 写出该反应中，将 $k_{f}(T)$ 和 $k_{r}(T)$ 与 $K_{c}(T)$ 联系起来的热力学一致性表达式。\n- 如果错误地假设 $K_{c}(T) = K_{p}(T)$，但仍使用相同的细致平衡关系，请量化逆向反应速率常数的相对误差，\n$$\\varepsilon \\equiv \\frac{k_{r,\\text{err}}(T) - k_{r,\\text{true}}(T)}{k_{r,\\text{true}}(T)},$$\n结果表示为单个十进制数。将答案四舍五入至四位有效数字。将相对误差表示为无量纲的十进制数。",
            "solution": "首先对问题进行验证。\n\n### 步骤1：提取已知条件\n- **反应：** 单步、可逆、基元气相反应 $\\text{A} + \\text{B} \\rightleftharpoons \\text{C}$。\n- **化学计量：** $\\nu_{\\text{A}} = -1$，$\\nu_{\\text{B}} = -1$，$\\nu_{\\text{C}} = +1$。摩尔数的净变化为 $\\Delta \\nu = \\sum_{i} \\nu_{i} = 1 - 1 - 1 = -1$。\n- **热力学状态：** 温度 $T = 1800$ K。该系统为理想气体混合物。\n- **标准态：**\n    - 标准压力：$P^{\\circ} = 1.000 \\times 10^{5}$ Pa。\n    - 标准浓度：$c^{\\circ} = 1.000$ mol m$^{-3}$。\n- **常数：** 普适气体常数 $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$。\n- **平衡常数：** 基于压力的平衡常数为 $K_{p}(T) = 4.00 \\times 10^{-6}$（无量纲，参考标准为 $P^{\\circ}$）。\n- **动力学：** 以浓度单位表示的质量作用动力学。\n    - 正向反应进程速率：$r_{f} = k_{f}(T)\\,c_{\\text{A}}\\,c_{\\text{B}}$。\n    - 逆向反应进程速率：$r_{r} = k_{r}(T)\\,c_{\\text{C}}$。\n- **约束条件：** 正向反应速率常数 $k_{f}(T)$ 已知且为有限值。\n- **目标：**\n    1.  推导 $K_{p}(T)$ 与基于浓度的平衡常数 $K_{c}(T)$ 之间的关系，并计算 $K_{c}(T)$。\n    2.  写出将 $k_{f}(T)$、$k_{r}(T)$ 和 $K_{c}(T)$ 联系起来的热力学一致性表达式。\n    3.  如果假设 $K_{c}(T) = K_{p}(T)$，量化相对误差 $\\varepsilon \\equiv \\frac{k_{r,\\text{err}}(T) - k_{r,\\text{true}}(T)}{k_{r,\\text{true}}(T)}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是化学热力学和动力学中的一个标准练习，基于理想气体定律、质量作用定律和细致平衡原理等基本原则。\n- **科学依据：** 问题基于已建立的概念。对于高温气相反应，所给数值在物理上是合理的。\n- **适定性：** 问题是自洽的。所有必要数据（$T$、$P^{\\circ}$、$c^{\\circ}$、$R$、$K_{p}$）均已提供，足以确定唯一解。问题具体且可量化。\n- **客观性：** 问题以精确、无偏见的语言陈述。\n\n该问题没有科学或事实上的不健全之处，是可形式化的、完整的且结构良好。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n**第1部分：$K_{p}(T)$ 与 $K_{c}(T)$ 之间的关系**\n\n无量纲平衡常数 $K_p(T)$ 是根据各物种的活度定义的，其中理想气体物种 $i$ 的活度 $a_i$ 是其分压 $p_i$ 除以标准压力 $P^\\circ$。\n$$a_i = \\frac{p_i}{P^\\circ}$$\n反应 $\\text{A} + \\text{B} \\rightleftharpoons \\text{C}$ 的平衡常数 $K_p(T)$ 由各物种活度与其化学计量系数 $\\nu_i$ 次方的乘积给出：\n$$K_p(T) = \\prod_i a_i^{\\nu_i} = \\frac{a_{\\text{C}}}{a_{\\text{A}} a_{\\text{B}}} = \\frac{p_{\\text{C}}/P^\\circ}{(p_{\\text{A}}/P^\\circ)(p_{\\text{B}}/P^\\circ)} = \\frac{p_{\\text{C}}}{p_{\\text{A}} p_{\\text{B}}} P^\\circ$$\n根据理想气体定律，分压 $p_i$ 与摩尔浓度 $c_i$ 的关系为 $p_i = c_i R T$。将此代入 $K_p(T)$ 的表达式中：\n$$K_p(T) = \\frac{c_{\\text{C}} R T}{(c_{\\text{A}} R T)(c_{\\text{B}} R T)} P^\\circ = \\left( \\frac{c_{\\text{C}}}{c_{\\text{A}} c_{\\text{B}}} \\right) \\frac{P^\\circ}{R T}$$\n\n类似地，无量纲的基于浓度的平衡常数 $K_c(T)$ 是使用参考标准浓度 $c^\\circ$ 的活度来定义的。\n$$a'_i = \\frac{c_i}{c^\\circ}$$\n$$K_c(T) = \\prod_i (a'_i)^{\\nu_i} = \\frac{a'_{\\text{C}}}{a'_{\\text{A}} a'_{\\text{B}}} = \\frac{c_{\\text{C}}/c^\\circ}{(c_{\\text{A}}/c^\\circ)(c_{\\text{B}}/c^\\circ)} = \\left( \\frac{c_{\\text{C}}}{c_{\\text{A}} c_{\\text{B}}} \\right) c^\\circ$$\n令 $K_{\\text{conc}} = \\frac{c_{\\text{C}}}{c_{\\text{A}} c_{\\text{B}}}$ 为平衡浓度的比值，它是有量纲的。那么 $K_c(T) = K_{\\text{conc}} c^\\circ$。\n从 $K_p(T)$ 的表达式可知，$K_p(T) = K_{\\text{conc}} \\frac{P^\\circ}{R T}$。\n代入 $K_{\\text{conc}} = K_c(T)/c^\\circ$：\n$$K_p(T) = \\frac{K_c(T)}{c^\\circ} \\frac{P^\\circ}{R T}$$\n因此，$K_p(T)$ 和 $K_c(T)$ 之间的关系为：\n$$K_c(T) = K_p(T) \\left( \\frac{c^\\circ R T}{P^\\circ} \\right)$$\n这与通用公式 $K_p(T) = K_c(T) \\left( \\frac{c^\\circ RT}{P^\\circ} \\right)^{\\Delta\\nu}$ 一致，其中对于本例 $\\Delta\\nu = -1$。\n\n现在，我们使用给定数据计算 $K_c(T)$ 的值：\n$$K_c(1800\\,\\text{K}) = (4.00 \\times 10^{-6}) \\left( \\frac{(1.000\\,\\text{mol}\\,\\text{m}^{-3}) (8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}) (1800\\,\\text{K})}{1.000 \\times 10^5\\,\\text{Pa}} \\right)$$\n$$K_c(1800\\,\\text{K}) = (4.00 \\times 10^{-6}) \\left( \\frac{14966.0327...}{100000} \\right) \\approx 5.9864 \\times 10^{-7}$$\n\n**第2部分：速率常数的热力学一致性关系**\n\n细致平衡原理断言，在平衡状态下，正向反应速率等于逆向反应速率。\n$$r_{f, \\text{eq}} = r_{r, \\text{eq}}$$\n使用给定的质量作用速率定律：\n$$k_f(T) c_{\\text{A,eq}} c_{\\text{B,eq}} = k_r(T) c_{\\text{C,eq}}$$\n整理得到速率常数的比值为：\n$$\\frac{k_f(T)}{k_r(T)} = \\frac{c_{\\text{C,eq}}}{c_{\\text{A,eq}} c_{\\text{B,eq}}}$$\n等式右边是有量纲的平衡常数 $K_{\\text{conc}}$。从第1部分可知，$K_{\\text{conc}} = K_c(T)/c^\\circ$。\n因此，将 $k_f(T)$ 和 $k_r(T)$ 与无量纲平衡常数 $K_c(T)$ 联系起来的热力学一致性表达式为：\n$$\\frac{k_f(T)}{k_r(T)} = \\frac{K_c(T)}{c^\\circ}$$\n该关系确保反应动力学将弛豫到正确的热力学平衡状态。整理得到逆向反应速率常数：\n$$k_r(T) = k_f(T) \\frac{c^\\circ}{K_c(T)}$$\n\n**第3部分：相对误差计算**\n\n“真实”的逆向反应速率常数 $k_{r,\\text{true}}(T)$ 是使用上面推导的正确热力学关系计算的。\n$$k_{r,\\text{true}}(T) = k_f(T) \\frac{c^\\circ}{K_c(T)}$$\n错误的逆向反应速率常数 $k_{r,\\text{err}}(T)$ 源于 $K_c(T) = K_p(T)$ 的不正确假设。虽然使用了相同的细致平衡关系，但输入了错误的平衡常数值。\n$$k_{r,\\text{err}}(T) = k_f(T) \\frac{c^\\circ}{K_p(T)}$$\n相对误差 $\\varepsilon$ 定义为：\n$$\\varepsilon = \\frac{k_{r,\\text{err}}(T) - k_{r,\\text{true}}(T)}{k_{r,\\text{true}}(T)} = \\frac{k_{r,\\text{err}}(T)}{k_{r,\\text{true}}(T)} - 1$$\n现在我们可以计算错误速率常数与真实速率常数的比值：\n$$\\frac{k_{r,\\text{err}}(T)}{k_{r,\\text{true}}(T)} = \\frac{k_f(T) \\frac{c^\\circ}{K_p(T)}}{k_f(T) \\frac{c^\\circ}{K_c(T)}} = \\frac{K_c(T)}{K_p(T)}$$\n将此代入 $\\varepsilon$ 的表达式中：\n$$\\varepsilon = \\frac{K_c(T)}{K_p(T)} - 1$$\n从第1部分可知关系式 $K_c(T) = K_p(T) \\left( \\frac{c^\\circ R T}{P^\\circ} \\right)$。因此，该比值为：\n$$\\frac{K_c(T)}{K_p(T)} = \\frac{c^\\circ R T}{P^\\circ}$$\n因此，相对误差与 $K_p(T)$ 的具体值无关，仅取决于温度和标准态的定义。\n$$\\varepsilon = \\frac{c^\\circ R T}{P^\\circ} - 1$$\n现在，我们代入数值：\n$$c^\\circ = 1.000\\,\\text{mol}\\,\\text{m}^{-3}$$\n$$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$$\n$$T = 1800\\,\\text{K}$$\n$$P^\\circ = 1.000 \\times 10^5\\,\\text{Pa} = 1.000 \\times 10^5\\,\\text{J}\\,\\text{m}^{-3}$$\n$$\\varepsilon = \\frac{(1.000)(8.314462618)(1800)}{1.000 \\times 10^5} - 1$$\n$$\\varepsilon = \\frac{14966.0327124}{100000} - 1$$\n$$\\varepsilon = 0.149660327... - 1 = -0.85033967...$$\n四舍五入到四位有效数字，相对误差为：\n$$\\varepsilon \\approx -0.8503$$\n这个显著的负误差表明，错误计算出的逆向反应速率常数仅为其真实值的大约 $15\\%$。",
            "answer": "$$ \\boxed{-0.8503} $$"
        },
        {
            "introduction": "从理论走向实践，在计算模型中确保热力学一致性需要一个稳健的实现。本练习  将指导你开发一个可复用的程序，以根据正向反应速率系数 $k_f$ 和基于压力的平衡常数 $K_p$ 正确计算逆向反应速率系数 $k_r$。掌握这一实现，包括正确处理涉及 $(RT/p^\\circ)^{\\Delta\\nu}$ 的转换因子，是构建精确可靠的燃烧模拟工具的一项基本技能。",
            "id": "4058172",
            "problem": "一个可逆基元气相反应表示为 $\\sum_i \\nu_i^{\\prime} X_i \\rightleftharpoons \\sum_i \\nu_i^{\\prime\\prime} X_i$，其中 $\\nu_i^{\\prime}$ 和 $\\nu_i^{\\prime\\prime}$ 分别是物种 $X_i$ 在正向和反向反应中的化学计量系数。令 $\\Delta \\nu \\equiv \\sum_i \\nu_i^{\\prime\\prime} - \\sum_i \\nu_i^{\\prime}$ 表示整个反应中总摩尔数的净变化。正向速率系数 $k_f$ 以与理想气体定律（IGL）$p_i = c_i R T$ 一致的、基于浓度的单位给出，其中 $p_i$ 是分压（单位：$\\mathrm{Pa}$），$c_i$ 是浓度（单位：$\\mathrm{mol/m^3}$），$R$ 是普适气体常数（单位：$\\mathrm{J/(mol\\cdot K)}$），$T$ 是温度（单位：$\\mathrm{K}$）。反向速率系数 $k_r$ 必须根据基于压力的平衡常数 $K_p(T)$ 计算，该常数是相对于标准态压力（SSP）$p^\\circ = 1~\\mathrm{bar}$ 定义的，其中 $1~\\mathrm{bar} = 10^5~\\mathrm{Pa}$。假设理想气体热力学和基元反应动力学。\n\n从第一性原理出发，即 (i) 基元反应的质量作用定律，(ii) 理想气体定律（IGL），以及 (iii) 压力形式平衡常数的热力学定义，推导 $k_r$ 和 $k_f$ 之间确保平衡时热力学一致性（细致平衡）的关系。具体来说，展示如何在将 $K_p(T)$ 转换为关联 $k_f$ 和 $k_r$ 所需的、基于浓度的平衡常数 $K_c(T)$ 时，正确地引入 $\\Delta \\nu$ 和因子 $(R T / p^\\circ)^{\\Delta \\nu}$。\n\n然后实现一个鲁棒的程序，该程序：\n- 根据给定的反应物和产物的整数化学计量系数列表，计算 $\\Delta \\nu$。\n- 使用 $(R T / p^\\circ)$ 的正确幂次将 $K_p(T)$ 转换为 $K_c(T)$。\n- 根据 $k_f$ 和 $K_c(T)$ 计算 $k_r$，以满足细致平衡。\n\n所有量都必须使用国际单位制（SI）。正向速率系数 $k_f$ 以SI单位提供，与浓度单位 $\\mathrm{mol/m^3}$ 和时间单位 $\\mathrm{s}$ 一致。对于单分子反应（$\\sum_i \\nu_i^{\\prime} = 1$），$k_f$ 的单位是 $\\mathrm{s^{-1}}$；对于双分子反应（$\\sum_i \\nu_i^{\\prime} = 2$），$k_f$ 的单位是 $\\mathrm{m^3/(mol\\cdot s)}$；对于三分子反应（$\\sum_i \\nu_i^{\\prime} = 3$），$k_f$ 的单位是 $\\mathrm{m^6/(mol^2\\cdot s)}$，更高阶反应依此类推。你的程序必须输出与这些惯例一致的SI单位的 $k_r$。\n\n使用普适气体常数 $R = 8.31446261815324~\\mathrm{J/(mol\\cdot K)}$ 和标准态压力 $p^\\circ = 10^5~\\mathrm{Pa}$。\n\n测试套件：\n提供一个程序，用于评估以下四个测试案例。每个测试案例定义为一个元组 $(k_f, T, K_p, \\boldsymbol{\\nu}^{\\prime}, \\boldsymbol{\\nu}^{\\prime\\prime})$：\n\n- 案例1（理想情况，$\\Delta \\nu = 0$）：类水煤气变换反应的化学计量\n  - $k_f = 10^{-3}$,\n  - $T = 1200$,\n  - $K_p = 1.2$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [1, 1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [1, 1]$.\n\n- 案例2（净摩尔数减少，$\\Delta \\nu = -1$）：$2\\mathrm{H}_2 + \\mathrm{O}_2 \\rightleftharpoons 2\\mathrm{H}_2\\mathrm{O}$\n  - $k_f = 10^{-16}$,\n  - $T = 1000$,\n  - $K_p = 10^{14}$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [2, 1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [2]$.\n\n- 案例3（净摩尔数增加，$\\Delta \\nu = +1$）：$\\mathrm{N}_2\\mathrm{O}_4 \\rightleftharpoons 2\\mathrm{NO}_2$\n  - $k_f = 2 \\times 10^{-3}$,\n  - $T = 400$,\n  - $K_p = 0.05$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [2]$.\n\n- 案例4（高温分解，$\\Delta \\nu = +1$）：$\\mathrm{H}_2 \\rightleftharpoons 2\\mathrm{H}$\n  - $k_f = 100$,\n  - $T = 2500$,\n  - $K_p = 10^{-3}$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [2]$.\n\n要求的最终输出格式：\n你的程序应生成单行输出，其中包含四个测试案例计算出的反向速率系数，以逗号分隔的列表形式包含在方括号内，并按上述顺序排列，例如 $\\left[ r_1, r_2, r_3, r_4 \\right]$，其中每个 $r_i$ 是一个浮点数，代表以SI单位表示的、与基于浓度的动力学一致的 $k_r$。",
            "solution": "该问题是有效的，因为它科学地基于化学动力学和热力学的基本原理，提法明确，提供了所有必要的数据，并以客观、正式的语言表述。因此，我们可以进行推导和求解。\n\n该问题要求推导出一个热力学上一致的关系，用于描述一般基元气相反应中正向速率系数 $k_f$ 和反向速率系数 $k_r$ 之间的关系：\n$$\n\\sum_{i} \\nu_i^{\\prime} X_i \\rightleftharpoons \\sum_{i} \\nu_i^{\\prime\\prime} X_i\n$$\n在这里，$X_i$ 是一个化学物种，$\\nu_i^{\\prime}$ 和 $\\nu_i^{\\prime\\prime}$ 分别是它作为反应物（正向）和产物（反向）的化学计量系数。\n\n我们的推导将按要求基于三个第一性原理：(i) 基元反应的质量作用定律，(ii) 理想气体定律（IGL），以及 (iii) 基于压力的平衡常数 $K_p$ 的热力学定义。\n\n首先，我们应用质量作用定律。对于一个基元反应，正向反应速率 $R_f$ 与反应物浓度的乘积成正比，每种反应物的浓度都取其化学计量系数次幂：\n$$\nR_f = k_f \\prod_{i} [X_i]^{\\nu_i^{\\prime}}\n$$\n其中 $[X_i]$ 表示物种 $X_i$ 的摩尔浓度，单位为 $\\mathrm{mol/m^3}$，$k_f$ 是正向速率系数。\n\n同样，反向反应速率 $R_r$ 由下式给出：\n$$\nR_r = k_r \\prod_{i} [X_i]^{\\nu_i^{\\prime\\prime}}\n$$\n其中 $k_r$ 是反向速率系数。\n\n细致平衡原理要求，在化学平衡时，对于每一个基元反应，正向速率必须等于反向速率。因此，在平衡时，$R_{f, \\text{eq}} = R_{r, \\text{eq}}$：\n$$\nk_f \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime}} = k_r \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime}}\n$$\n其中下标 'eq' 表示平衡条件。\n\n该方程可以重排，将速率系数之比与平衡浓度乘积之比关联起来：\n$$\n\\frac{k_f}{k_r} = \\frac{\\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime}}}{\\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime}}} = \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime}}\n$$\n根据定义，此表达式的右侧是基于浓度的平衡常数 $K_c(T)$：\n$$\nK_c(T) = \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime}}\n$$\n因此，速率系数通过 $K_c(T)$ 直接相关：\n$$\n\\frac{k_f(T)}{k_r(T)} = K_c(T)\n$$\n\n接下来，我们引入基于压力的热力学平衡常数 $K_p(T)$。对于理想气体混合物，物种 $i$ 的活度定义为 $a_i = p_i / p^\\circ$，其中 $p_i$ 是其分压，$p^\\circ$ 是标准态压力（$1~\\mathrm{bar}$ 或 $10^5~\\mathrm{Pa}$）。$K_p(T)$ 是根据平衡时的这些活度定义的：\n$$\nK_p(T) = \\prod_{i} a_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} = \\prod_{i} \\left( \\frac{p_{i, \\text{eq}}}{p^\\circ} \\right)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}\n$$\n我们可以分离压力项：\n$$\nK_p(T) = \\frac{\\prod_{i} p_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{\\prod_{i} (p^\\circ)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}} = \\frac{\\prod_{i} p_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{(p^\\circ)^{\\sum_i (\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}\n$$\n令 $\\Delta \\nu$ 为反应中总摩尔数的净变化，定义为 $\\Delta \\nu = \\sum_i \\nu_i^{\\prime\\prime} - \\sum_i \\nu_i^{\\prime}$。$K_p(T)$ 的表达式变为：\n$$\nK_p(T) = \\frac{\\prod_{i} p_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{(p^\\circ)^{\\Delta \\nu}}\n$$\n\n现在，我们使用理想气体定律（IGL）将基于压力的常数和基于浓度的常数联系起来。IGL将物种的分压 $p_i$ 与其摩尔浓度 $[X_i]$ 和温度 $T$ 相关联：\n$$\np_i = [X_i] R T\n$$\n其中 $R$ 是普适气体常数。将IGL代入 $K_p(T)$ 的表达式中：\n$$\nK_p(T) = \\frac{\\prod_{i} ([X_i]_{\\text{eq}} R T)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{(p^\\circ)^{\\Delta \\nu}}\n$$\n将各项分解出来，我们得到：\n$$\nK_p(T) = \\frac{ \\left( \\prod_{i} [X_i]_{\\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} \\right) \\left( \\prod_{i} (R T)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} \\right) }{(p^\\circ)^{\\Delta \\nu}}\n$$\n分子中的第一项是 $K_c(T)$。第二项简化为 $(R T)^{\\sum_i (\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} = (R T)^{\\Delta \\nu}$。这得出了 $K_p(T)$ 和 $K_c(T)$ 之间的基本关系：\n$$\nK_p(T) = K_c(T) \\frac{(R T)^{\\Delta \\nu}}{(p^\\circ)^{\\Delta \\nu}} = K_c(T) \\left( \\frac{R T}{p^\\circ} \\right)^{\\Delta \\nu}\n$$\n\n为了求得 $k_r$，我们首先用给定的 $K_p(T)$ 来表示 $K_c(T)$：\n$$\nK_c(T) = K_p(T) \\left( \\frac{R T}{p^\\circ} \\right)^{-\\Delta \\nu} = K_p(T) \\left( \\frac{p^\\circ}{R T} \\right)^{\\Delta \\nu}\n$$\n最后，通过将其代入细致平衡关系 $k_r = k_f / K_c$，我们得到所需的反向速率系数公式：\n$$\nk_r(T) = \\frac{k_f(T)}{K_c(T)} = \\frac{k_f(T)}{K_p(T) \\left( \\frac{p^\\circ}{R T} \\right)^{\\Delta \\nu}}\n$$\n这简化为待实现的最终表达式：\n$$\nk_r(T) = \\frac{k_f(T)}{K_p(T)} \\left( \\frac{R T}{p^\\circ} \\right)^{\\Delta \\nu}\n$$\n这个关系确保了热力学一致性。算法实现将包括：\n1. 从输入的化学计量系数向量计算 $\\Delta \\nu = \\sum \\nu_i^{\\prime\\prime} - \\sum \\nu_i^{\\prime}$。\n2. 计算无量纲转换项 $(RT/p^\\circ)^{\\Delta\\nu}$。注意 $p^\\circ$ 必须使用SI单位（$\\mathrm{Pa}$）以匹配 $R$ 和 $T$。\n3. 使用推导出的公式计算 $k_r$。通过对各项进行量纲分析可知，$k_r$ 的单位将与浓度 $\\mathrm{mol/m^3}$ 和时间 $\\mathrm{s}$ 一致。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the reverse rate coefficient for a reversible elementary\n    gas-phase reaction to ensure thermodynamic consistency.\n    \"\"\"\n\n    # Define physical constants in SI units.\n    # Universal gas constant in J/(mol·K)\n    R = 8.31446261815324\n    # Standard State Pressure (SSP) in Pa (1 bar = 10^5 Pa)\n    P_STANDARD = 100000.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k_f, T, K_p, nu_prime, nu_double_prime)\n    # k_f: forward rate coefficient (SI units, mol/m^3 basis)\n    # T: temperature (K)\n    # K_p: pressure-based equilibrium constant (dimensionless)\n    # nu_prime: list of reactant stoichiometric coefficients\n    # nu_double_prime: list of product stoichiometric coefficients\n    test_cases = [\n        # Case 1: Water-gas shift-like, Delta_nu = 0\n        (1.0e-3, 1200.0, 1.2, [1, 1], [1, 1]),\n        \n        # Case 2: Water formation, Delta_nu = -1\n        (1.0e-16, 1000.0, 1.0e14, [2, 1], [2]),\n        \n        # Case 3: N2O4 dissociation, Delta_nu = +1\n        (2.0e-3, 400.0, 0.05, [1], [2]),\n        \n        # Case 4: H2 dissociation, Delta_nu = +1\n        (100.0, 2500.0, 1.0e-3, [1], [2]),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        kf, T, Kp, nu_prime, nu_double_prime = case\n\n        # Step 1: Compute Delta_nu, the net change in total mole number.\n        sum_nu_prime = sum(nu_prime)\n        sum_nu_double_prime = sum(nu_double_prime)\n        delta_nu = float(sum_nu_double_prime - sum_nu_prime)\n\n        # Step 2: Compute the conversion factor.\n        # The reverse rate coefficient is kr = kf / Kc.\n        # The relationship between dimensionless Kp and dimensional Kc is Kp = Kc * (RT/p_std)**delta_nu.\n        # So Kc = Kp / (RT/p_std)**delta_nu = Kp * (p_std/RT)**delta_nu.\n        # Therefore, kr = kf / (Kp * (p_std/RT)**delta_nu) = (kf/Kp) * (RT/p_std)**delta_nu.\n        \n        # The term (R * T / P_STANDARD) has units of m^3/mol if we are careful,\n        # but the overall expression gives kr in the correct units.\n        conversion_factor = (R * T / P_STANDARD) ** delta_nu\n        \n        # Step 3: Compute the reverse rate coefficient kr.\n        # Handle the case where Kp might be zero to avoid division by zero,\n        # though not expected in these test cases.\n        if Kp == 0:\n            # If Kp is zero, the reverse reaction is infinitely favored,\n            # implying kr would be infinitely large if kf is non-zero.\n            # This is a physical edge case not present in the tests.\n            # For practical purposes, we might represent this as infinity.\n            kr = float('inf')\n        else:\n            kr = (kf / Kp) * conversion_factor\n            \n        results.append(kr)\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of float values enclosed in square brackets.\n    # Using a list comprehension and str.join for clean formatting.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个反应机理被实现后，我们如何验证它是否正确地遵循了热力学定律？这个高级实践  将挑战你设计并构建一个用于细致平衡（detailed balance）的数值验证测试。通过首先计算出真正的热力学平衡组分，然后在此状态下评估正向和逆向反应速率，你将创建一个强大的工具来确认反应的净速率在平衡点正确地趋近于零，这使你能够验证动力学模型并诊断其中的不一致性。",
            "id": "4058122",
            "problem": "您需要设计并实现一个数值测试，通过计算在热力学平衡常数约束下的组分处的正逆反应速率残差，来验证单个可逆反应的细致平衡。该测试必须具有通用性、透明性和可复现性。您的程序必须接受一个小的、指定的反应测试套件，并为每个案例生成一行输出，列出其残差度量。\n\n从以下基本原理出发：\n- 理想气体定律 (IGL)：理想气体的分压和浓度通过 $p_i = C_i R T$ 相关联，其中 $p_i$ 是分压，$C_i$ 是摩尔浓度（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$），$R$ 是普适气体常数，$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T$ 是绝对温度（单位 $\\mathrm{K}$）。\n- 质量作用定律：对于净化学计量为 $\\sum_i \\nu_{i,f} X_i \\rightleftharpoons \\sum_i \\nu_{i,r} X_i$ 的反应，正反应速率为 $r_f = k_f \\prod_i C_i^{\\nu_{i,f}}$，逆反应速率为 $r_r = k_r \\prod_i C_i^{\\nu_{i,r}}$，其中 $k_f$ 和 $k_r$ 是速率系数，其单位与总反应级数和给定的浓度 $C_i$（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$）相一致。\n- 热力学平衡常数：基于压力的平衡常数为 $K_p(T) = \\exp\\!\\left(-\\Delta G^\\circ_r(T)/(R T)\\right)$，其中 $\\Delta G^\\circ_r(T)$ 是标准反应吉布斯自由能变（单位 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$）。基于浓度的平衡常数通过 $K_p(T) = K_c(T) (R T)^{\\Delta \\nu}$ 相关联，其中 $\\Delta \\nu = \\sum_i \\nu_{i,r} - \\sum_i \\nu_{i,f}$。\n\n在热力学平衡状态下，对于一个热力学一致的机理，细致平衡成立：当组分满足 $K_c(T)$ 且 $k_r = k_f / K_c(T)$ 时，有 $r_f = r_r$。您的任务是，在对每个反应强制满足 $K_c(T)$ 的组分下，计算 $r_f - r_r$，并展示当 $k_r$ 不是由 $K_c(T)$ 计算得出时，违反热力学一致性的情况是如何表现的。\n\n定义单个反应的反应进度 $\\xi$，其初始浓度为 $C_{i,0}$，净化学计量符号系数为 $s_i = \\nu_{i,r} - \\nu_{i,f}$，因此 $C_i(\\xi) = C_{i,0} + s_i \\xi$。单一反应混合物的平衡组分可通过求解以下标量约束方程找到：\n$$\n\\frac{\\prod_i C_i(\\xi)^{\\nu_{i,r}}}{\\prod_i C_i(\\xi)^{\\nu_{i,f}}} \\;=\\; K_c(T),\n$$\n并受到保持所有 $C_i(\\xi) \\ge 0$ 的物理边界条件的约束。使用这个 $\\xi$ 来评估 $r_f$ 和 $r_r$，并报告一个归一化残差：\n$$\n\\varepsilon \\;=\\; \\frac{r_f - r_r}{\\lvert r_f \\rvert + \\lvert r_r \\rvert + \\varepsilon_0},\n$$\n其中 $\\varepsilon_0$ 是一个小的正数（使用 $10^{-300}$）以防止除以零。归一化残差 $\\varepsilon$ 是无量纲的。\n\n使用阿伦尼乌斯形式 $k_f(T) = A T^n \\exp\\!\\left(-E_a/(R T)\\right)$ 实现正反应速率系数，其中 $A$、$n$ 和 $E_a$ 是提供的参数。单位必须一致：浓度 $C_i$ 单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，温度 $T$ 单位为 $\\mathrm{K}$，活化能 $E_a$ 单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$，时间单位为 $\\mathrm{s}$。$A$ 的单位取决于总反应级数 $m = \\sum_i \\nu_{i,f}$：对于 $m = 1$，$A$ 的单位是 $\\mathrm{s}^{-1}$；对于 $m = 2$，$A$ 的单位是 $\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$；对于 $m = 3$，$A$ 的单位是 $\\mathrm{m}^6\\,\\mathrm{mol}^{-2}\\,\\mathrm{s}^{-1}$，依此类推。\n\n测试套件。使用以下三个案例。在每个案例中，计算 $K_p(T)$、$K_c(T)$、平衡进度 $\\xi$、正反应速率系数 $k_f(T)$、逆反应速率系数 $k_r(T)$、速率 $r_f$ 和 $r_r$，然后计算 $\\varepsilon$。\n\n- 案例1 (热力学一致，$\\Delta \\nu$ 为负):\n    - 反应: $A + B \\rightleftharpoons C$。\n    - 温度: $T = 1000\\,\\mathrm{K}$。\n    - 标准反应吉布斯自由能: $\\Delta G^\\circ_r(T) = -20000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n    - 净化学计量系数: $\\nu_{A,f} = 1$, $\\nu_{B,f} = 1$, $\\nu_{C,r} = 1$，其余为零。因此 $\\Delta \\nu = 1 - 2 = -1$。\n    - 初始浓度: $C_{A,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{B,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{C,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n    - 阿伦尼乌斯参数 (正向): $A = 1.0 \\times 10^{6}$, $n = 0.0$, $E_a = 60000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n    - 逆反应速率系数: $k_r = k_f / K_c(T)$ (一致)。\n\n- 案例2 (热力学违规展示，$\\Delta \\nu$ 为正):\n    - 反应: $C \\rightleftharpoons A + B$。\n    - 温度: $T = 1200\\,\\mathrm{K}$。\n    - 标准反应吉布斯自由能: $\\Delta G^\\circ_r(T) = +15000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n    - 净化学计量系数: $\\nu_{C,f} = 1$, $\\nu_{A,r} = 1$, $\\nu_{B,r} = 1$，其余为零。因此 $\\Delta \\nu = 2 - 1 = +1$。\n    - 初始浓度: $C_{C,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{A,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{B,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n    - 阿伦尼乌斯参数 (正向): $A = 1.0 \\times 10^{3}$, $n = 0.0$, $E_a = 80000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n    - 逆反应速率系数: $k_r = \\alpha \\, k_f / K_c(T)$，其中 $\\alpha = 2.0$ (有意不一致)。\n\n- 案例3 (热力学一致，$\\Delta \\nu$ 为零作为边界情况):\n    - 反应: $A + B \\rightleftharpoons D + E$。\n    - 温度: $T = 800\\,\\mathrm{K}$。\n    - 标准反应吉布斯自由能: $\\Delta G^\\circ_r(T) = -5000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n    - 净化学计量系数: $\\nu_{A,f} = 1$, $\\nu_{B,f} = 1$, $\\nu_{D,r} = 1$, $\\nu_{E,r} = 1$，其余为零。因此 $\\Delta \\nu = (1 + 1) - (1 + 1) = 0$。\n    - 初始浓度: $C_{A,0} = 0.5\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{B,0} = 0.5\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{D,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{E,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n    - 阿伦尼乌斯参数 (正向): $A = 2.0 \\times 10^{5}$, $n = 0.0$, $E_a = 50000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n    - 逆反应速率系数: $k_r = k_f / K_c(T)$ (一致)。\n\n算法要求：\n- 使用上述公式计算 $K_p(T)$ 和 $K_c(T)$。\n- 通过在物理上允许的区间 $\\xi \\in [\\xi_{\\min}, \\xi_{\\max}]$ 上使用一个鲁棒的求根方法求解关于 $K_c(T)$ 的标量方程，来计算平衡反应进度 $\\xi$，其中 $\\xi_{\\min}$ 和 $\\xi_{\\max}$ 由 $C_i(\\xi) \\ge 0$ 确定。\n- 评估 $r_f$、$r_r$ 和归一化残差 $\\varepsilon$。\n- 您的程序必须是一个完整、可运行的脚本。不要读取输入；将测试套件的数值内嵌在程序中。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果，例如：$[r_1,r_2,r_3]$，其中每个 $r_j$ 是案例 $j$ 计算出的 $\\varepsilon$，格式为 Python 默认的浮点数。这些残差是无量纲的，不需要进行物理单位转换。",
            "solution": "目标是通过在对每个反应强制执行热力学平衡常数 $K_c(T)$ 的组分下，评估差值 $r_f - r_r$ 来测试细致平衡。推理从第一性原理出发。\n\n从理想气体定律 (IGL) 和质量作用定律开始。对于单个反应 $\\sum_i \\nu_{i,f} X_i \\rightleftharpoons \\sum_i \\nu_{i,r} X_i$，定义符号化学计量系数 $s_i = \\nu_{i,r} - \\nu_{i,f}$。如果反应从初始浓度 $C_{i,0}$ 开始，进行到进度 $\\xi$，则瞬时浓度为 $C_i(\\xi) = C_{i,0} + s_i \\xi$。假设理想气体行为，反应的基于浓度的平衡常数为：\n$$\nK_c(T) \\;=\\; \\frac{K_p(T)}{(R T)^{\\Delta \\nu}}, \\quad \\Delta \\nu \\;=\\; \\sum_i \\nu_{i,r} - \\sum_i \\nu_{i,f}, \\quad K_p(T) \\;=\\; \\exp\\!\\left(-\\frac{\\Delta G^\\circ_r(T)}{R T}\\right).\n$$\n此关系源于 $K_p = \\prod_i p_i^{\\nu_{i,r}} / \\prod_i p_i^{\\nu_{i,f}}$ 的定义和理想气体定律 $p_i = C_i R T$，从而得出 $K_p = K_c (R T)^{\\Delta \\nu}$。\n\n热力学一致性和微观可逆性意味着在平衡时 $r_f = r_r$，前提是逆反应速率系数满足 $k_r = k_f / K_c(T)$ 并且组分强制满足 $K_c(T)$。为了构建一个数值测试，我们通过一个关于 $\\xi$ 的标量方程来强制实现平衡组分：\n$$\n\\Phi(\\xi) \\;\\equiv\\; \\frac{\\prod_i C_i(\\xi)^{\\nu_{i,r}}}{\\prod_i C_i(\\xi)^{\\nu_{i,f}}} \\;-\\; K_c(T) \\;=\\; 0.\n$$\n我们在由 $C_i(\\xi) \\ge 0$ 决定的允许区间上求解 $\\xi$。具体来说，如果 $s_i  0$，则 $\\xi \\le C_{i,0}/(-s_i)$；如果 $s_i > 0$，则 $\\xi \\ge -C_{i,0}/s_i$。对于仅从反应物开始的典型正向反应过程，我们将 $\\xi$ 约束在 $[0, \\min_{i: s_i  0} C_{i,0}/(-s_i)]$ 区间内。\n\n一旦找到 $\\xi$，我们就计算浓度 $C_i(\\xi)$，然后使用质量作用定律计算正向和逆向速率：\n$$\nr_f \\;=\\; k_f(T)\\, \\prod_i C_i(\\xi)^{\\nu_{i,f}}, \\qquad k_f(T) \\;=\\; A T^n \\exp\\!\\left(-\\frac{E_a}{R T}\\right),\n$$\n$$\nr_r \\;=\\; k_r(T)\\, \\prod_i C_i(\\xi)^{\\nu_{i,r}}, \\qquad k_r(T) \\;=\\; \\frac{k_f(T)}{K_c(T)} \\quad \\text{(一致)}.\n$$\n为了展示违规情况，我们设置 $k_r(T) = \\alpha\\, k_f(T)/K_c(T)$，其中某个 $\\alpha \\ne 1$，从而打破细致平衡。然后我们计算归一化残差：\n$$\n\\varepsilon \\;=\\; \\frac{r_f - r_r}{\\lvert r_f \\rvert + \\lvert r_r \\rvert + \\varepsilon_0},\n$$\n其中 $\\varepsilon_0 = 10^{-300}$ 以避免除以零。对于一个一致的机理，在平衡时分子趋于 $0$ (在数值舍入误差范围内)，从而得到 $\\varepsilon \\approx 0$。对于不一致的逆反应速率，$\\varepsilon$ 将不为零，其大小由违规程度 $\\alpha - 1$ 和平衡速率共同决定。\n\n将此方法应用于三个测试案例：\n\n案例1：$A + B \\rightleftharpoons C$ 在 $T = 1000\\,\\mathrm{K}$，$\\Delta G^\\circ_r = -20000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。计算 $K_p = \\exp\\!\\left(20000/(8.314462618 \\cdot 1000)\\right)$，然后 $\\Delta \\nu = -1$ 且 $K_c = K_p / (R T)^{-1} = K_p \\cdot R T$。平衡约束简化为\n$$\n\\frac{C_C}{C_A C_B} \\;=\\; K_c, \\quad C_A = 1 - \\xi, \\; C_B = 1 - \\xi, \\; C_C = \\xi,\n$$\n这从 $\\xi = K_c (1 - \\xi)^2$ 中得到 $\\xi$。程序通过鲁棒的求根方法求解此方程。当 $k_r = k_f/K_c$ 时，残差 $\\varepsilon$ 应接近于 $0$。\n\n案例2：$C \\rightleftharpoons A + B$ 在 $T = 1200\\,\\mathrm{K}$，$\\Delta G^\\circ_r = +15000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。计算 $K_p = \\exp\\!\\left(-15000/(8.314462618 \\cdot 1200)\\right)$，然后 $\\Delta \\nu = +1$ 且 $K_c = K_p / (R T)^{+1}$。平衡约束简化为\n$$\n\\frac{C_A C_B}{C_C} \\;=\\; K_c, \\quad C_C = 1 - \\xi, \\; C_A = \\xi, \\; C_B = \\xi,\n$$\n这得到 $\\xi^2/(1 - \\xi) = K_c$。当 $k_r = \\alpha\\, k_f/K_c$ 且 $\\alpha = 2.0$ 时，细致平衡被违反，$\\varepsilon$ 将不为零。\n\n案例3：$A + B \\rightleftharpoons D + E$ 在 $T = 800\\,\\mathrm{K}$，$\\Delta G^\\circ_r = -5000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$\\Delta \\nu = 0$ 所以 $K_c = K_p$。约束条件为\n$$\n\\frac{C_D C_E}{C_A C_B} \\;=\\; K_c, \\quad C_A = 0.5 - \\xi, \\; C_B = 0.5 - \\xi, \\; C_D = \\xi, \\; C_E = \\xi,\n$$\n导致 $\\xi^2/(0.5 - \\xi)^2 = K_c$。因为 $k_r = k_f/K_c$，残差应再次接近于 $0$。这个案例也作为 $\\Delta \\nu = 0$ 的边界情况，消除了 $(R T)^{\\Delta \\nu}$ 因子。\n\n数值考虑：\n- 求根在受 $C_i(\\xi) \\ge 0$ 约束的区间上进行。\n- 如有必要，可使用对数来求解函数以提高鲁棒性，但在这些案例中直接评估比率即可。\n- 残差归一化避免了单位依赖性，并能独立于绝对速率大小突出显示违规情况。\n\n最终程序为指定的测试套件实现了这些步骤，并以所需的格式 $[r_1,r_2,r_3]$ 打印单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\nR = 8.314462618  # J/(mol*K)\n\ndef arrhenius_k(A, n, Ea, T):\n    \"\"\"Compute Arrhenius rate coefficient k_f(T) = A * T^n * exp(-Ea/(R*T)).\"\"\"\n    return A * (T ** n) * np.exp(-Ea / (R * T))\n\ndef Kp_from_deltaG(deltaG, T):\n    \"\"\"Compute pressure-based equilibrium constant Kp(T) = exp(-ΔG/(R*T)).\"\"\"\n    return np.exp(-deltaG / (R * T))\n\ndef Kc_from_Kp(Kp, T, delta_nu):\n    \"\"\"Compute concentration-based equilibrium constant Kc from Kp.\"\"\"\n    # Kp = Kc * (R T)^{Δν} => Kc = Kp / (R T)^{Δν}\n    return Kp / ((R * T) ** delta_nu)\n\ndef equilibrium_extent(Kc, C0, nu_f, nu_r):\n    \"\"\"\n    Solve for reaction extent xi such that\n    prod(C_i(xi)^{nu_r_i}) / prod(C_i(xi)^{nu_f_i}) = Kc\n    subject to concentrations C_i(xi) = C0_i + s_i * xi >= 0.\n    \"\"\"\n    s = np.array(nu_r) - np.array(nu_f)\n    C0 = np.array(C0, dtype=float)\n    nu_f = np.array(nu_f, dtype=float)\n    nu_r = np.array(nu_r, dtype=float)\n\n    # Determine admissible interval for xi: ensure C_i(xi) >= 0 for all i\n    # Lower bound: max over s_i > 0 of (-C0_i / s_i), generally 0 for our setups.\n    xi_lower_candidates = []\n    for Ci0, si in zip(C0, s):\n        if si > 0:\n            xi_lower_candidates.append(-Ci0 / si)\n    xi_lower = max([0.0] + xi_lower_candidates)  # prefer forward extent >= 0\n\n    # Upper bound: min over s_i  0 of (C0_i / -s_i)\n    xi_upper_candidates = []\n    for Ci0, si in zip(C0, s):\n        if si  0:\n            xi_upper_candidates.append(Ci0 / (-si))\n    xi_upper = min(xi_upper_candidates) if xi_upper_candidates else 1e6  # large if no consumption\n\n    # Define the equilibrium function f(xi) = ratio - Kc\n    def f(xi):\n        Ci = C0 + s * xi\n        # If any concentration is non-positive, penalize\n        if np.any(Ci = 0):\n            return np.nan\n        numerator = 1.0\n        denominator = 1.0\n        # Compute product avoiding overflow via logs if needed; here direct is fine\n        for Cij, nu_ij in zip(Ci, nu_r):\n            if nu_ij != 0:\n                numerator *= Cij ** nu_ij\n        for Cij, nu_ij in zip(Ci, nu_f):\n            if nu_ij != 0:\n                denominator *= Cij ** nu_ij\n        return (numerator / denominator) - Kc\n\n    # Evaluate at bounds\n    # Slightly shrink interval to avoid exact zero concentrations\n    eps = 1e-15\n    a = xi_lower + eps\n    b = xi_upper - eps if np.isfinite(xi_upper) else xi_lower + 1.0\n    # Ensure a  b\n    if b = a:\n        # Degenerate interval; return boundary\n        return max(xi_lower, min(xi_upper, xi_lower))\n\n    fa = f(a)\n    fb = f(b)\n\n    # If either bound hits NaN due to concentrations, adjust inward\n    # Attempt a few times to find valid evaluations\n    attempts = 0\n    while (np.isnan(fa) or np.isnan(fb)) and attempts  20:\n        a += eps\n        b -= eps\n        fa = f(a)\n        fb = f(b)\n        attempts += 1\n\n    # If function values have different signs, use brentq\n    if not np.isnan(fa) and not np.isnan(fb) and fa * fb = 0:\n        try:\n            xi = brentq(f, a, b, maxiter=100, xtol=1e-12, rtol=1e-12)\n            return xi\n        except Exception:\n            # Fall back to midpoint if root finding fails\n            return 0.5 * (a + b)\n\n    # If no sign change, pick the point where |f| is smaller\n    # This approximates pushing to the nearest feasible quasi-equilibrium\n    if np.isnan(fa) and not np.isnan(fb):\n        return b\n    if np.isnan(fb) and not np.isnan(fa):\n        return a\n    if np.isnan(fa) and np.isnan(fb):\n        # No feasible point; return lower bound\n        return xi_lower\n    return a if abs(fa)  abs(fb) else b\n\ndef compute_rates_and_residual(T, deltaG, nu_f, nu_r, C0, A, n, Ea, alpha=1.0):\n    \"\"\"\n    Compute k_f, k_r, equilibrium composition, rates and normalized residual epsilon.\n    alpha scales k_r to demonstrate violations: k_r = alpha * k_f / Kc.\n    \"\"\"\n    # Equilibrium constants\n    Kp = Kp_from_deltaG(deltaG, T)\n    delta_nu = float(np.sum(nu_r) - np.sum(nu_f))\n    Kc = Kc_from_Kp(Kp, T, delta_nu)\n\n    # Equilibrium extent and composition\n    xi = equilibrium_extent(Kc, C0, nu_f, nu_r)\n    s = np.array(nu_r) - np.array(nu_f)\n    Ci = np.array(C0, dtype=float) + s * xi\n\n    # Forward and reverse rate coefficients\n    kf = arrhenius_k(A, n, Ea, T)\n    kr = alpha * kf / Kc\n\n    # Compute rates\n    rf = kf\n    rr = kr\n    # Multiply by the appropriate concentration products\n    for Cij, nu_ij in zip(Ci, nu_f):\n        if nu_ij != 0:\n            rf *= Cij ** nu_ij\n    for Cij, nu_ij in zip(Ci, nu_r):\n        if nu_ij != 0:\n            rr *= Cij ** nu_ij\n\n    # Normalized residual\n    tiny = 1e-300\n    eps = (rf - rr) / (abs(rf) + abs(rr) + tiny)\n    return eps\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T, deltaG, nu_f, nu_r, C0_list, A, n, Ea, alpha)\n    test_cases = [\n        # Case 1: A + B => C, consistent\n        (1000.0, -20000.0,\n         [1, 1, 0],  # nu_f for A, B, C\n         [0, 0, 1],  # nu_r for A, B, C\n         [1.0, 1.0, 0.0],  # initial concentrations\n         1.0e6, 0.0, 60000.0, 1.0),\n        # Case 2: C => A + B, inconsistent with alpha=2.0\n        (1200.0, +15000.0,\n         [0, 0, 1],  # nu_f for A, B, C\n         [1, 1, 0],  # nu_r for A, B, C\n         [0.0, 0.0, 1.0],  # initial concentrations\n         1.0e3, 0.0, 80000.0, 2.0),\n        # Case 3: A + B => D + E, consistent, delta_nu = 0\n        (800.0, -5000.0,\n         [1, 1, 0, 0],  # nu_f for A, B, D, E\n         [0, 0, 1, 1],  # nu_r for A, B, D, E\n         [0.5, 0.5, 0.0, 0.0],  # initial concentrations\n         2.0e5, 0.0, 50000.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, deltaG, nu_f, nu_r, C0, A, n, Ea, alpha = case\n        eps = compute_rates_and_residual(T, deltaG, nu_f, nu_r, C0, A, n, Ea, alpha)\n        results.append(eps)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}