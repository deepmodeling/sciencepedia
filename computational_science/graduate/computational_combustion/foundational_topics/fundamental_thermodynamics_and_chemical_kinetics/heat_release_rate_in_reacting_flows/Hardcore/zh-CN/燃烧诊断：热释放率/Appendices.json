{
    "hands_on_practices": [
        {
            "introduction": "要准确量化燃烧过程中的能量释放，我们必须将热力学与化学动力学联系起来。本练习从第一性原理出发，推导并计算了理想反应器中的体积放热率 。通过这个实践，你将掌握如何利用反应的化学计量、物种的生成焓和反应进程率来确定放热率，这是理解和模拟任何反应流的基础。",
            "id": "4029587",
            "problem": "在一个理想搅拌反应器（PSR）内，一个空间均匀、稳定、等压的反应流由一个单一的全局氧化步骤主导，该步骤并非通常的完全燃烧。化学反应由以下基本化学计量变化表示\n$$\\mathrm{CH}_4 + 1.5\\,\\mathrm{O}_2 \\rightarrow \\mathrm{CO} + 2\\,\\mathrm{H}_2\\mathrm{O}，$$\n其中氮气作为惰性稀释剂。假设理想气体行为，并忽略参考状态与反应器温度之间的显焓变化，因此物种焓可以近似为其在参考温度下的标准生成焓。提供了在$298\\,\\mathrm{K}$下的以下标准生成焓：\n$$h_{f,\\mathrm{CH}_4}^{\\circ}(298\\,\\mathrm{K}) = -74.85\\,\\mathrm{kJ/mol},\\quad h_{f,\\mathrm{O}_2}^{\\circ}(298\\,\\mathrm{K}) = 0\\,\\mathrm{kJ/mol},$$\n$$h_{f,\\mathrm{CO}}^{\\circ}(298\\,\\mathrm{K}) = -110.53\\,\\mathrm{kJ/mol},\\quad h_{f,\\mathrm{H}_2\\mathrm{O}}^{\\circ}(298\\,\\mathrm{K}) = -241.826\\,\\mathrm{kJ/mol}。$$\n\n在 PSR 内部，单位体积的摩尔反应进度率经测量为 $r = 15.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。利用反应流的能量守恒定律和以标准生成焓表示的物种焓的定义，推导出一个用化学计量系数、标准生成焓和摩尔反应进度率表示的体积放热率表达式，然后在给定假设下进行数值计算。\n\n以$\\mathrm{MW/m}^3$为单位表示最终的放热率，并将答案四舍五入到四位有效数字。最终答案必须是一个实数。",
            "solution": "本问题要求推导并计算在理想搅拌反应器（PSR）中化学反应流的体积放热率，记作 $\\dot{q}$。\n\n体积放热率定义为单位体积内化学能转化为热能的速率。对于一个包含 $N$ 种化学物质的系统，这在数学上表示为各物种单位体积的摩尔生成率 $\\dot{\\Omega}_k$ 与其相应的摩尔焓 $h_k$ 乘积之和的负值：\n$$ \\dot{q} = - \\sum_{k=1}^{N} \\dot{\\Omega}_k h_k $$\n在给定温度 $T$ 下，物种的摩尔焓 $h_k$ 是其在参考温度 $T_{ref}$ 下的标准摩尔生成焓 $h_{f,k}^{\\circ}(T_{ref})$ 与从 $T_{ref}$ 到 $T$ 的显焓变化之和：\n$$ h_k(T) = h_{f,k}^{\\circ}(T_{ref}) + \\int_{T_{ref}}^{T} C_{p,k}(T') dT' $$\n其中 $C_{p,k}$ 是物种 $k$ 的定压摩尔热容。\n\n问题陈述了一个关键的简化假设：“忽略参考状态与反应器温度之间的显焓变化”。这是一个将积分项设为零的正式指令，意味着每个物种的焓可以近似为其标准生成焓：\n$$ h_k(T) \\approx h_{f,k}^{\\circ}(T_{ref}) $$\n将此近似代入 $\\dot{q}$ 的表达式中，得到：\n$$ \\dot{q} \\approx - \\sum_{k=1}^{N} \\dot{\\Omega}_k h_{f,k}^{\\circ} $$\n问题指明化学反应由单一的全局反应控制。对于单个反应，任何物种 $k$ 的摩尔生成率 $\\dot{\\Omega}_k$ 与单位体积的摩尔反应进度率 $r$ 成正比。比例常数是平衡反应方程式中物种 $k$ 的化学计量系数 $\\nu_k$（对于产物 $\\nu_k > 0$，对于反应物 $\\nu_k  0$）：\n$$ \\dot{\\Omega}_k = \\nu_k r $$\n将此关系代入 $\\dot{q}$ 的方程中：\n$$ \\dot{q} = - \\sum_{k=1}^{N} (\\nu_k r) h_{f,k}^{\\circ} = -r \\left( \\sum_{k=1}^{N} \\nu_k h_{f,k}^{\\circ} \\right) $$\n括号中的项是标准反应热 $\\Delta H_R^{\\circ}$ 的定义：\n$$ \\Delta H_R^{\\circ} = \\sum_{k=1}^{N} \\nu_k h_{f,k}^{\\circ} = \\sum_{\\text{products}} |\\nu_k| h_{f,k}^{\\circ} - \\sum_{\\text{reactants}} |\\nu_k| h_{f,k}^{\\circ} $$\n因此，在所述假设下，推导出的体积放热率表达式为：\n$$ \\dot{q} = -r \\Delta H_R^{\\circ} $$\n现在，我们可以对该表达式进行数值计算。全局反应如下：\n$$ \\mathrm{CH}_4 + 1.5\\,\\mathrm{O}_2 \\rightarrow \\mathrm{CO} + 2\\,\\mathrm{H}_2\\mathrm{O} $$\n化学计量系数为：$\\nu_{\\mathrm{CH}_4} = -1$、$\\nu_{\\mathrm{O}_2} = -1.5$、$\\nu_{\\mathrm{CO}} = 1$ 以及 $\\nu_{\\mathrm{H}_2\\mathrm{O}} = 2$。\n\n标准反应热 $\\Delta H_R^{\\circ}$ 使用所提供的在 $T_{ref} = 298\\,\\mathrm{K}$ 下的标准生成焓计算：\n- $h_{f,\\mathrm{CH}_4}^{\\circ} = -74.85\\,\\mathrm{kJ/mol}$\n- $h_{f,\\mathrm{O}_2}^{\\circ} = 0\\,\\mathrm{kJ/mol}$\n- $h_{f,\\mathrm{CO}}^{\\circ} = -110.53\\,\\mathrm{kJ/mol}$\n- $h_{f,\\mathrm{H}_2\\mathrm{O}}^{\\circ} = -241.826\\,\\mathrm{kJ/mol}$\n\n$$ \\Delta H_R^{\\circ} = (1 \\cdot h_{f,\\mathrm{CO}}^{\\circ} + 2 \\cdot h_{f,\\mathrm{H}_2\\mathrm{O}}^{\\circ}) - (1 \\cdot h_{f,\\mathrm{CH}_4}^{\\circ} + 1.5 \\cdot h_{f,\\mathrm{O}_2}^{\\circ}) $$\n$$ \\Delta H_R^{\\circ} = [1(-110.53) + 2(-241.826)]\\,\\mathrm{kJ/mol} - [1(-74.85) + 1.5(0)]\\,\\mathrm{kJ/mol} $$\n$$ \\Delta H_R^{\\circ} = [-110.53 - 483.652]\\,\\mathrm{kJ/mol} - [-74.85]\\,\\mathrm{kJ/mol} $$\n$$ \\Delta H_R^{\\circ} = -594.182\\,\\mathrm{kJ/mol} + 74.85\\,\\mathrm{kJ/mol} $$\n$$ \\Delta H_R^{\\circ} = -519.332\\,\\mathrm{kJ/mol} $$\n$\\Delta H_R^{\\circ}$ 的负号表明该反应是放热反应。单位体积的摩尔反应进度率给定为 $r = 15.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n将这些值代入 $\\dot{q}$ 的表达式中：\n$$ \\dot{q} = -(15.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}) \\times (-519.332\\,\\mathrm{kJ/mol}) $$\n$$ \\dot{q} = 8101.5792\\,\\mathrm{kJ}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\n问题要求答案以兆瓦每立方米（$\\mathrm{MW/m}^3$）为单位，并四舍五入到四位有效数字。单位 $\\mathrm{kJ}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ 等效于 $\\mathrm{kW/m}^3$。我们使用换算关系 $1\\,\\mathrm{MW} = 1000\\,\\mathrm{kW}$：\n$$ \\dot{q} = 8101.5792\\,\\mathrm{kW/m}^3 = \\frac{8101.5792}{1000}\\,\\mathrm{MW/m}^3 $$\n$$ \\dot{q} = 8.1015792\\,\\mathrm{MW/m}^3 $$\n四舍五入到四位有效数字，我们得到：\n$$ \\dot{q} \\approx 8.102\\,\\mathrm{MW/m}^3 $$",
            "answer": "$$\\boxed{8.102}$$"
        },
        {
            "introduction": "在实际燃烧系统中，例如喷气发动机和工业燃烧器，燃料和氧化剂通常是非预混的。本练习将带你进入非预混燃烧的建模世界，利用混合分数这一核心概念来描述反应速率 。你将推导并实现一个混合限制模型，这不仅能加深你对非预混火焰中放热率物理机制的理解，还能锻炼你的计算编程能力。",
            "id": "4029590",
            "problem": "要求您在混合分数框架下，为非预混反应流中的体积热释放率 (HRR) 开发、推导和实现一个计算程序。目标是基于第一性原理，得到一个物理上一致的体积热释放率表达式，该表达式适合以编程方式进行计算。推导过程必须从基本守恒定律和广为接受的定义出发，并且不得在没有正当理由的情况下假设任何简化公式。\n\n出发点和假设：\n- 考虑一个由两股流混合形成的非预混火焰：一股是燃料质量分数为 $Y_{F,\\infty}$ 的纯燃料流，另一股是氧化剂质量分数为 $Y_{O,\\infty}$ 的纯氧化剂流。混合分数 $Z$ 是一个守恒标量，表示燃料流对局部混合物的贡献 ($Z \\in [0,1]$)，因此反应前混合线给出了作为 $Z$ 函数的 $Y_F(Z)$ 和 $Y_O(Z)$。\n- 假设一个单步不可逆反应，消耗燃料和氧化剂生成产物，每单位质量燃料消耗的反应热为常数 $Q$（燃烧热，对于放热反应为正值）。\n- 设 $s$ 为反应化学计量所隐含的化学计量氧化剂与燃料质量比。\n- 设 $\\rho$ 为局部质量密度，$k$ 为一个单位为 $\\mathrm{s}^{-1}$ 的混合限制有效速率系数，它捕捉了非预混火焰段中分子混合的时间尺度。\n\n任务：\n1. 从反应流的能量守恒和比焓源项的定义出发，推导一个用燃料消耗率表示的体积热释放率 $\\dot{q}$ 的数学上一致的表达式。明确地将 $\\dot{q}$ 与燃料质量消耗率和反应热 $Q$ 联系起来。最终结果必须以 $\\mathrm{W/m^3}$ 为单位表示。\n2. 在非预混流中，使用混合分数 $Z$ 的定义和反应前线性混合，将 $Y_F(Z)$ 和 $Y_O(Z)$ 表示为 $Z$、$Y_{F,\\infty}$ 和 $Y_{O,\\infty}$ 的函数。然后，利用化学计量一致性，推导化学计量混合分数 $Z_{\\mathrm{st}}$ 作为 $Y_{F,\\infty}$、$Y_{O,\\infty}$ 和 $s$ 的函数，不假设任何简化方法。确认在 $Z=Z_{\\mathrm{st}}$ 时，局部比例恰好符合化学计量。\n3. 针对非预混火焰，提出并论证一个用于局部燃料消耗率的混合限制有限速率封闭模型，该模型需遵循化学计量和限制反应物原理。该封闭模型必须产生一个单位为 $\\mathrm{kg/(m^3\\,s)}$ 的消耗率，并且必须与假设的 $k$ 和 $\\rho$ 一致。\n\n实现：\n- 在一个完整的、可运行的程序中实现推导出的 $\\dot{q}(Z;\\rho,k,Q,Y_{F,\\infty},Y_{O,\\infty},s)$ 表达式。\n- 使用下面的参数值作为测试套件。对于指定 $Z=Z_{\\mathrm{st}}$ 的条目，请根据提供的 $Y_{F,\\infty}$、$Y_{O,\\infty}$ 和 $s$ 值计算 $Z_{\\mathrm{st}}$。\n- 将每个计算出的热释放率以 $\\mathrm{W/m^3}$ 表示。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[r_1,r_2,r_3]$）。\n\n测试套件 (每个元组为 $(\\rho,k,Q,Y_{F,\\infty},Y_{O,\\infty},s,Z)$):\n- 案例 1：甲烷-空气，化学计量比：$(1.2,10,5\\times 10^{7},1.0,0.233,4,Z_{\\mathrm{st}})$。\n- 案例 2：甲烷-空气，纯氧化剂混合点：$(1.2,10,5\\times 10^{7},1.0,0.233,4,0)$。\n- 案例 3：甲烷-空气，纯燃料混合点：$(1.2,10,5\\times 10^{7},1.0,0.233,4,1)$。\n- 案例 4：氢气-空气，中等富燃混合物：$(0.9,50,1.2\\times 10^{8},1.0,0.233,8,0.5)$。\n- 案例 5：氢气-空气，化学计量比：$(1.0,100,1.2\\times 10^{8},1.0,0.233,8,Z_{\\mathrm{st}})$。\n- 案例 6：甲烷-空气，高密度富燃：$(10.0,5,5\\times 10^{7},1.0,0.233,4,0.8)$。\n- 案例 7：甲烷-空气，化学计量比，混合速率常数为零：$(1.2,0,5\\times 10^{7},1.0,0.233,4,Z_{\\mathrm{st}})$。\n\n测试套件中的所有数值对于非预混火焰都是物理上合理的。输出值必须是对应于每个案例的热释放率（单位为 $\\mathrm{W/m^3}$）的浮点数，并汇总到程序打印的作为唯一输出行的单个方括号列表中。",
            "solution": "问题陈述已经过验证，被认为是计算燃烧学领域一个适定的、有科学依据的客观问题。它要求推导和实现一个非预混火焰中体积热释放率的模型，这是一项标准的、实质性的任务。所有提供的信息都是自洽、一致且物理上合理的。因此，我们可以开始求解。\n\n解决方案按问题陈述的要求分为三个部分：首先，建立体积热释放率 $\\dot{q}$ 与燃料消耗率之间的关系；其次，推导混合分数框架的关键量，包括化学计量混合分数 $Z_{\\mathrm{st}}$；第三，为燃料消耗率假设一个基于物理的封闭模型。\n\n### 任务 1：体积热释放率推导\n\n体积热释放率 $\\dot{q}$ 定义为单位体积内化学反应释放能量的速率，单位为 $\\mathrm{W/m^3}$ 或 $\\mathrm{J/(m^3 s)}$。在反应流中，总焓守恒方程中的源项正是这个量。\n\n对于一个化学反应物种系统，热释放率由所有物种 $i$ 的质量生成率 $\\dot{\\omega}_i$（单位 $\\mathrm{kg/(m^3 s)}$）与其标准生成焓 $\\Delta h_{f,i}^{\\circ}$（单位 $\\mathrm{J/kg}$）的乘积的负值求和得到：\n$$\n\\dot{q} = - \\sum_{i} \\dot{\\omega}_i \\Delta h_{f,i}^{\\circ}\n$$\n问题将化学反应简化为一个单步不可逆反应，其中燃料（$F$）和氧化剂（$O$）反应生成产物（$P$）：\n$$\n1\\,\\mathrm{kg}\\; F + s\\,\\mathrm{kg}\\; O \\longrightarrow (1+s)\\,\\mathrm{kg}\\; P\n$$\n其中 $s$ 是化学计量的氧化剂与燃料质量比。设 $\\dot{\\omega}_F^{\\text{cons}}$ 为燃料的质量消耗率，它是一个单位为 $\\mathrm{kg/(m^3 s)}$ 的正值。那么燃料物种的源项为 $\\dot{\\omega}_F = -\\dot{\\omega}_F^{\\text{cons}}$，氧化剂的源项为 $\\dot{\\omega}_O = -s\\dot{\\omega}_F^{\\text{cons}}$。\n\n问题将 $Q$ 定义为每单位质量燃料消耗的反应热，对于放热反应是一个正值。根据定义，$Q$ 是反应的焓变，按燃料质量归一化：\n$$\nQ = -\\left( \\Delta h_{f,P}^{\\circ} \\frac{m_P}{m_F} - \\Delta h_{f,F}^{\\circ} \\frac{m_F}{m_F} - \\Delta h_{f,O}^{\\circ} \\frac{m_O}{m_F} \\right) = -\\left( (1+s)\\Delta h_{f,P}^{\\circ} - \\Delta h_{f,F}^{\\circ} - s\\Delta h_{f,O}^{\\circ} \\right)\n$$\n为简单起见，假设除燃料和氧化剂外的产物和反应物的生成焓为零（这是一个常见的约定），这会使问题简化。但是，我们可以更直接地进行。总热释放率为：\n$$\n\\dot{q} = -(\\dot{\\omega}_F \\Delta h_{f,F}^{\\circ} + \\dot{\\omega}_O \\Delta h_{f,O}^{\\circ} + \\dot{\\omega}_P \\Delta h_{f,P}^{\\circ})\n$$\n用 $\\dot{\\omega}_F^{\\text{cons}}$ 表示反应速率：$\\dot{\\omega}_F = -\\dot{\\omega}_F^{\\text{cons}}$，$\\dot{\\omega}_O = -s\\dot{\\omega}_F^{\\text{cons}}$，以及 $\\dot{\\omega}_P = (1+s)\\dot{\\omega}_F^{\\text{cons}}$。\n$$\n\\dot{q} = -(-\\dot{\\omega}_F^{\\text{cons}} \\Delta h_{f,F}^{\\circ} -s\\dot{\\omega}_F^{\\text{cons}} \\Delta h_{f,O}^{\\circ} + (1+s)\\dot{\\omega}_F^{\\text{cons}} \\Delta h_{f,P}^{\\circ})\n$$\n$$\n\\dot{q} = \\dot{\\omega}_F^{\\text{cons}} (\\Delta h_{f,F}^{\\circ} + s\\Delta h_{f,O}^{\\circ} - (1+s)\\Delta h_{f,P}^{\\circ})\n$$\n括号中的项正是 $Q$ 的定义。因此，体积热释放率与燃料质量消耗率 $\\dot{\\omega}_F^{\\text{cons}}$ 成正比：\n$$\n\\dot{q} = \\dot{\\omega}_F^{\\text{cons}} Q\n$$\n为简化符号，从这里开始，我们用 $\\dot{\\omega}_F$ 表示正的燃料消耗率。\n\n### 任务 2：混合分数与化学计量\n\n混合分数 $Z$ 是一个守恒标量，用于衡量给定流体微团中源自燃料流的质量比例。其范围从 $Z=0$（纯氧化剂流）到 $Z=1$（纯燃料流）。\n未反应混合物的组分由燃料流和氧化剂流的线性混合确定。燃料流（$Z=1$）的燃料质量分数为 $Y_{F,1} = Y_{F,\\infty}$，氧化剂质量分数为 $Y_{O,1}=0$。氧化剂流（$Z=0$）的 $Y_{F,2}=0$，$Y_{O,2}=Y_{O,\\infty}$。\n在混合分数为 $Z$ 的点，未反应混合物中燃料（$Y_F^0$）和氧化剂（$Y_O^0$）的质量分数由下式给出：\n$$\nY_F^0(Z) = Z \\cdot Y_{F,1} + (1-Z) \\cdot Y_{F,2} = Z Y_{F,\\infty}\n$$\n$$\nY_O^0(Z) = Z \\cdot Y_{O,1} + (1-Z) \\cdot Y_{O,2} = (1-Z) Y_{O,\\infty}\n$$\n化学计量条件定义为可用燃料和氧化剂的质量比恰好等于完全燃烧所需的比例 $s$ 的状态。发生这种情况时的混合分数即为化学计量混合分数 $Z_{\\mathrm{st}}$。在这一点上，未反应质量分数的比率必须等于 $s$：\n$$\n\\frac{Y_O^0(Z_{\\mathrm{st}})}{Y_F^0(Z_{\\mathrm{st}})} = s\n$$\n代入 $Y_F^0$ 和 $Y_O^0$ 的表达式：\n$$\n\\frac{(1-Z_{\\mathrm{st}}) Y_{O,\\infty}}{Z_{\\mathrm{st}} Y_{F,\\infty}} = s\n$$\n我们求解这个代数方程以得到 $Z_{\\mathrm{st}}$：\n$$\n(1-Z_{\\mathrm{st}}) Y_{O,\\infty} = s Z_{\\mathrm{st}} Y_{F,\\infty}\n$$\n$$\nY_{O,\\infty} - Z_{\\mathrm{st}}Y_{O,\\infty} = s Z_{\\mathrm{st}} Y_{F,\\infty}\n$$\n$$\nY_{O,\\infty} = Z_{\\mathrm{st}}(s Y_{F,\\infty} + Y_{O,\\infty})\n$$\n$$\nZ_{\\mathrm{st}} = \\frac{Y_{O,\\infty}}{s Y_{F,\\infty} + Y_{O,\\infty}}\n$$\n这个推导出的表达式允许从边界流的组分和反应化学计量计算 $Z_{\\mathrm{st}}$。\n\n### 任务 3：混合限制的反应速率封闭模型\n\n在非预混燃烧中，总反应速率通常受燃料和氧化剂在分子水平上混合的速率控制，而不是受化学动力学控制。问题指定了一个混合限制的有效速率系数 $k$（单位为 $\\mathrm{s}^{-1}$），它代表了该混合过程的特征时间倒数。\n\n燃料消耗率 $\\dot{\\omega}_F$ 的封闭模型必须遵循限制反应物原理：当燃料或氧化剂任一耗尽时，反应停止。该模型应反映出消耗速率与局部密度 $\\rho$、混合速率 $k$ 以及限制反应物的可用量成正比。\n\n可用燃料质量分数为 $Y_F^0(Z) = Z Y_{F,\\infty}$。可用氧化剂质量分数为 $Y_O^0(Z) = (1-Z) Y_{O,\\infty}$。根据化学计量，1 千克燃料需要 $s$ 千克氧化剂。因此，可用氧化剂能消耗的燃料量为 $Y_O^0(Z)/s$。\n\n可反应的燃料量受限于可用燃料量与可用氧化剂的燃料当量之间的最小值。我们将这个可反应燃料质量分数 $Y_{F, \\text{reactable}}$ 定义为：\n$$\nY_{F, \\text{reactable}}(Z) = \\min\\left( Y_F^0(Z), \\frac{Y_O^0(Z)}{s} \\right) = \\min\\left( Z Y_{F,\\infty}, \\frac{(1-Z)Y_{O,\\infty}}{s} \\right)\n$$\n该表达式正确地识别了限制反应物：\n- 如果 $Z  Z_{\\mathrm{st}}$，混合物是贫燃的。第一项更小。\n- 如果 $Z > Z_{\\mathrm{st}}$，混合物是富燃的。第二项更小。\n- 如果 $Z = Z_{\\mathrm{st}}$，如 $Z_{\\mathrm{st}}$ 的推导所示，两项相等。\n\n混合限制的燃料消耗率 $\\dot{\\omega}_F$ 被建模为这个可反应燃料质量在混合时间尺度 $1/k$ 内被消耗的速率：\n$$\n\\dot{\\omega}_F(\\rho, k, Z) = \\rho k Y_{F, \\text{reactable}}(Z)\n$$\n代入 $Y_{F, \\text{reactable}}$ 的表达式：\n$$\n\\dot{\\omega}_F = \\rho k \\min\\left( Z Y_{F,\\infty}, \\frac{(1-Z)Y_{O,\\infty}}{s} \\right)\n$$\n该模型提供了一个单位为 $\\mathrm{kg/(m^3 s)}$ 的反应速率，与混合速率 $k$ 成正比，并正确地遵循了限制反应物原理。\n\n### 用于实现的最终表达式\n\n综合所有三个任务的结果，我们得到了体积热释放率 $\\dot{q}$ 作为局部混合分数 $Z$ 和其他给定参数的函数的完整表达式：\n$$\n\\dot{q}(Z; \\rho, k, Q, Y_{F,\\infty}, Y_{O,\\infty}, s) = Q \\cdot \\dot{\\omega}_F = \\rho k Q \\min\\left( Z Y_{F,\\infty}, \\frac{(1-Z)Y_{O,\\infty}}{s} \\right)\n$$\n此表达式现在可以进行编程实现。对于 $Z$ 被指定为 $Z_{\\mathrm{st}}$ 的情况，将首先使用任务2中推导的公式计算其值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a computational procedure for the volumetric Heat Release Rate (HRR)\n    in nonpremixed reacting flows using a mixture fraction framework.\n    \"\"\"\n\n    # Test suite: each tuple is (rho, k, Q, Y_F_inf, Y_O_inf, s, Z)\n    # rho: density (kg/m^3)\n    # k: mixing rate coefficient (1/s)\n    # Q: heat of combustion (J/kg_fuel)\n    # Y_F_inf: fuel mass fraction in the fuel stream\n    # Y_O_inf: oxidizer mass fraction in the oxidizer stream\n    # s: stoichiometric oxidizer-to-fuel mass ratio\n    # Z: mixture fraction (or 'Z_st' for stoichiometric)\n    test_cases = [\n        # Case 1: Methane–air at stoichiometry\n        (1.2, 10.0, 5.0e7, 1.0, 0.233, 4.0, 'Z_st'),\n        # Case 2: Methane–air, oxidizer-only mixing point\n        (1.2, 10.0, 5.0e7, 1.0, 0.233, 4.0, 0.0),\n        # Case 3: Methane–air, fuel-only mixing point\n        (1.2, 10.0, 5.0e7, 1.0, 0.233, 4.0, 1.0),\n        # Case 4: Hydrogen–air, moderately fuel-rich mixture\n        (0.9, 50.0, 1.2e8, 1.0, 0.233, 8.0, 0.5),\n        # Case 5: Hydrogen–air at stoichiometry\n        (1.0, 100.0, 1.2e8, 1.0, 0.233, 8.0, 'Z_st'),\n        # Case 6: Methane–air, dense and fuel-rich\n        (10.0, 5.0, 5.0e7, 1.0, 0.233, 4.0, 0.8),\n        # Case 7: Methane–air at stoichiometry with zero mixing rate constant\n        (1.2, 0.0, 5.0e7, 1.0, 0.233, 4.0, 'Z_st'),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, k, Q, Y_F_inf, Y_O_inf, s, Z_val = case\n        \n        # If Z is specified as 'Z_st', calculate the stoichiometric mixture fraction\n        if Z_val == 'Z_st':\n            # Z_st = Y_O_inf / (s * Y_F_inf + Y_O_inf)\n            if (s * Y_F_inf + Y_O_inf) == 0:\n                Z = 0.0 # Avoid division by zero, though not expected with given data\n            else:\n                Z = Y_O_inf / (s * Y_F_inf + Y_O_inf)\n        else:\n            Z = float(Z_val)\n            \n        # These are the unreacted mass fractions of fuel and oxidizer based on mixing alone\n        # Y_F_unreacted = Z * Y_F_inf\n        # Y_O_unreacted = (1 - Z) * Y_O_inf\n\n        # The amount of fuel that can react is limited by the minimum of available fuel\n        # and the fuel-equivalent of available oxidizer.\n        # This is the \"reactable\" fuel mass fraction.\n        # Term 1: available fuel\n        fuel_term = Z * Y_F_inf\n        # Term 2: fuel equivalent of available oxidizer\n        if s == 0:\n             oxidizer_term = float('inf') # Avoid division by zero for non-reacting cases\n        else:\n             oxidizer_term = ((1.0 - Z) * Y_O_inf) / s\n        \n        Y_F_reactable = np.min([fuel_term, oxidizer_term])\n        \n        # The fuel consumption rate (omega_dot_F) is modeled using a mixing-limited closure.\n        # omega_dot_F = rho * k * Y_F_reactable   [kg/(m^3*s)]\n        omega_dot_F = rho * k * Y_F_reactable\n        \n        # The volumetric heat release rate (q_dot) is the fuel consumption rate\n        # multiplied by the heat of reaction per unit mass of fuel.\n        # q_dot = omega_dot_F * Q  [W/m^3]\n        q_dot = omega_dot_F * Q\n        \n        results.append(q_dot)\n\n    # Format the final output as a comma-separated list in square brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "放热率不仅是一个静态的热源项，其动态波动可以与声波耦合，产生被称为热声不稳定性的剧烈振荡。本练习探讨了这一前沿课题，要求你从线化守恒方程出发，推导声波振幅的增长率 。通过这个实践，你将深入理解瑞利准则（Rayleigh criterion）的物理内涵，以及放热率波动如何成为燃烧系统动态行为的关键驱动力。",
            "id": "4029592",
            "problem": "考虑一个长度为 $L$、横截面积恒为 $A$ 的一维刚性壁管道，其中充满了理想气体，初始状态为均匀的基态压力 $p_0$、密度 $\\rho_0$ 和温度 $T_0$。设比热比为 $\\gamma$，声速为 $c$，其中 $c^2 = \\gamma p_0 / \\rho_0$。忽略平均流、粘性和热传导。假设为小振幅声学，并且由于反应流的存在，有一个空间分布、随时间变化的体积放热率 $q'(x,t)$。声场由半波长驻波模态主导，其压力和速度扰动为\n$$\np'(x,t) = \\hat{p}\\,\\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\cos(\\omega t), \\quad u'(x,t) = \\tilde{u}\\,\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin(\\omega t),\n$$\n其中 $\\hat{p}$ 是压力振幅，$\\tilde{u}$ 是待由线性波动关系确定的速度振幅，$\\omega$ 是该模态的角频率。体积放热振荡由下式给出\n$$\nq'(x,t) = \\hat{q}\\,\\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\cos(\\omega t + \\phi),\n$$\n其振幅为 $\\hat{q}$，相对于压力振荡的相位为 $\\phi$。管道两端是完全反射的，因此在一个周期内没有净声能通量穿过边界。\n\n从包含热量添加的理想气体线性化守恒定律和基本热力学恒等式（不使用简化公式）出发，推导由热声耦合引起的声学模态振幅的周期平均指数增长率 $\\sigma$，假设 $\\sigma / \\omega \\ll 1$，因此在一个声学周期内振幅变化很小。然后，对以下数值计算 $\\sigma$：\n$$\nL = 1\\,\\mathrm{m},\\quad A = 1.0\\times 10^{-2}\\,\\mathrm{m}^2,\\quad p_0 = 1.01325\\times 10^{5}\\,\\mathrm{Pa},\\quad \\gamma = 1.4,\n$$\n$$\n\\hat{p} = 1.0\\times 10^{2}\\,\\mathrm{Pa},\\quad \\hat{q} = 1.0\\times 10^{3}\\,\\mathrm{W/m^3},\\quad \\phi = \\frac{\\pi}{3}\\,\\mathrm{rad}.\n$$\n将 $\\sigma$ 的最终数值四舍五入到四位有效数字，并以 $\\mathrm{s^{-1}}$ 为单位表示。",
            "solution": "我们从一维理想气体带体积热量添加的线性化守恒方程开始，忽略平均流、粘性和传导。连续性方程和动量方程为\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0, \\qquad \\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0.\n$$\n用温度表示的、带体积放热 $q'$ 的能量方程，在主导阶上为\n$$\n\\rho_0 c_v \\frac{\\partial T'}{\\partial t} = -p_0 \\frac{\\partial u'}{\\partial x} + q',\n$$\n其中 $c_v$ 是定容比热。理想气体状态方程给出 $p' = R(\\rho_0 T' + T_0 \\rho')$，其中 $R = c_p - c_v$ 且 $c_p/c_v = \\gamma$。对状态方程关于时间求导，并使用连续性方程和能量方程消去 $\\partial \\rho'/\\partial t$ 和 $\\partial T'/\\partial t$，得到带热量添加的线性压力方程，\n$$\n\\frac{\\partial p'}{\\partial t} + \\gamma p_0 \\frac{\\partial u'}{\\partial x} = (\\gamma - 1)\\,q'.\n$$\n这可以通过注意到对于理想气体 $R T_0 = p_0 / \\rho_0$ 和 $c_p = \\gamma c_v$ 来验证，从而得到所述的耦合系数 $(\\gamma - 1)$。\n\n为了推导声能平衡，将动量方程乘以 $u'$，压力方程乘以 $p'/(\\gamma p_0)$，然后相加：\n$$\n\\rho_0 u' \\frac{\\partial u'}{\\partial t} + \\frac{p'}{\\gamma p_0} \\frac{\\partial p'}{\\partial t} + u' \\frac{\\partial p'}{\\partial x} + \\frac{p'}{\\gamma p_0}\\,\\gamma p_0 \\frac{\\partial u'}{\\partial x} = \\frac{\\gamma - 1}{\\gamma p_0} p'\\,q'.\n$$\n识别出二次型的时间导数，并重新整理为散度形式，我们写出\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{\\rho_0 u'^2}{2} + \\frac{p'^2}{2\\gamma p_0}\\right) + \\frac{\\partial}{\\partial x}\\left(p' u'\\right) = \\frac{\\gamma - 1}{\\gamma p_0}\\,p' q'.\n$$\n在管道体积 $V$ 上积分，并使用边界条件（在一个周期内通过两端的净声通量为零，即刚性、完全反射的壁面使得 $\\int_{\\partial V} p' u' \\, dS$ 的周期平均值为零），我们得到声能方程\n$$\n\\frac{dE}{dt} = \\int_V \\frac{\\gamma - 1}{\\gamma p_0}\\,\\langle p' q' \\rangle_t \\, dV,\n$$\n其中总声能为\n$$\nE(t) = \\int_V \\left(\\frac{\\rho_0 u'^2}{2} + \\frac{p'^2}{2\\gamma p_0}\\right) dV,\n$$\n且 $\\langle \\cdot \\rangle_t$ 表示在声学周期 $T = 2\\pi/\\omega$ 上的周期平均。\n\n对于波数为 $k = \\pi/L$ 的半波模态，振幅之间的齐次（无源）驻波关系可通过组合线性无源方程获得；对于平面波，$p'$ 和 $u'$ 通过 $u' = \\pm p'/(\\rho_0 c)$ 相关，在驻波中存在正交相移。与给定的空间形式一致，我们有\n$$\nu'(x,t) = \\frac{\\hat{p}}{\\rho_0 c}\\,\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin(\\omega t),\n$$\n这满足动量方程，其中 $p'(x,t) = \\hat{p}\\cos(\\pi x/L)\\cos(\\omega t)$。\n\n此模态的周期平均总声能为\n$$\n\\langle E \\rangle_t = \\int_0^L \\int_A \\left(\\frac{\\rho_0 \\langle u'^2 \\rangle_t}{2} + \\frac{\\langle p'^2 \\rangle_t}{2\\gamma p_0}\\right) dA\\,dx.\n$$\n计算时间平均值 $\\langle \\cos^2(\\omega t)\\rangle_t = \\langle \\sin^2(\\omega t)\\rangle_t = \\frac{1}{2}$ 和空间积分\n$$\n\\int_0^L \\cos^2\\!\\left(\\frac{\\pi x}{L}\\right) dx = \\int_0^L \\sin^2\\!\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{L}{2}.\n$$\n因此，\n$$\n\\langle p'^2 \\rangle_t = \\frac{1}{2}\\hat{p}^2 \\cos^2\\!\\left(\\frac{\\pi x}{L}\\right), \\quad \\langle u'^2 \\rangle_t = \\frac{1}{2}\\left(\\frac{\\hat{p}}{\\rho_0 c}\\right)^2 \\sin^2\\!\\left(\\frac{\\pi x}{L}\\right).\n$$\n在横截面积 $A$ 和 $x \\in [0,L]$ 上积分，得到\n$$\n\\langle E \\rangle_t = A \\left[ \\int_0^L \\frac{\\rho_0}{2}\\cdot \\frac{1}{2}\\left(\\frac{\\hat{p}}{\\rho_0 c}\\right)^2 \\sin^2\\!\\left(\\frac{\\pi x}{L}\\right) dx + \\int_0^L \\frac{1}{2\\gamma p_0}\\cdot \\frac{1}{2}\\hat{p}^2 \\cos^2\\!\\left(\\frac{\\pi x}{L}\\right) dx \\right].\n$$\n使用 $c^2 = \\gamma p_0/\\rho_0$，两个积分计算得到相同的值，从而\n$$\n\\langle E \\rangle_t = A \\left[ \\frac{\\hat{p}^2}{4\\rho_0 c^2}\\cdot \\frac{L}{2} + \\frac{\\hat{p}^2}{4\\gamma p_0}\\cdot \\frac{L}{2} \\right] = A L \\frac{\\hat{p}^2}{8\\gamma p_0} + A L \\frac{\\hat{p}^2}{8\\gamma p_0} = A L \\frac{\\hat{p}^2}{4\\gamma p_0}.\n$$\n\n接下来，计算周期平均源项。给定的 $q'(x,t)$ 在空间上与 $\\cos(\\pi x/L)$ 同相，但在时间上有一个相位 $\\phi$。乘积的周期平均为\n$$\n\\left\\langle p'(x,t)\\,q'(x,t)\\right\\rangle_t = \\hat{p}\\hat{q}\\,\\cos^2\\!\\left(\\frac{\\pi x}{L}\\right)\\left\\langle \\cos(\\omega t)\\cos(\\omega t + \\phi)\\right\\rangle_t = \\frac{1}{2}\\hat{p}\\hat{q}\\,\\cos^2\\!\\left(\\frac{\\pi x}{L}\\right)\\cos\\phi,\n$$\n因为 $\\langle \\cos(\\omega t)\\cos(\\omega t+\\phi) \\rangle_t = \\frac{1}{2}\\cos\\phi$。将其在体积上积分，得到\n$$\n\\int_V \\left\\langle p' q' \\right\\rangle_t \\, dV = A \\int_0^L \\frac{1}{2}\\hat{p}\\hat{q}\\,\\cos^2\\!\\left(\\frac{\\pi x}{L}\\right)\\cos\\phi \\, dx = A \\cdot \\frac{1}{2}\\hat{p}\\hat{q}\\cos\\phi \\cdot \\frac{L}{2} = A L \\frac{\\hat{p}\\hat{q}\\cos\\phi}{4}.\n$$\n\n由于一个周期内没有净边界通量，周期平均能量增长率为\n$$\n\\left\\langle \\frac{dE}{dt} \\right\\rangle_t = \\frac{\\gamma - 1}{\\gamma p_0} \\int_V \\left\\langle p' q' \\right\\rangle_t \\, dV = \\frac{\\gamma - 1}{\\gamma p_0} \\cdot A L \\frac{\\hat{p}\\hat{q}\\cos\\phi}{4}.\n$$\n假设相对于声学周期增长缓慢，声能与振幅的平方成正比，因此如果模态振幅按 $\\exp(\\sigma t)$ 增长，则 $E(t) \\propto \\exp(2\\sigma t)$ 且\n$$\n\\frac{1}{\\langle E \\rangle_t} \\left\\langle \\frac{dE}{dt} \\right\\rangle_t \\approx 2\\sigma.\n$$\n因此，\n$$\n\\sigma = \\frac{1}{2} \\cdot \\frac{\\gamma - 1}{\\gamma p_0} \\cdot \\frac{A L \\frac{\\hat{p}\\hat{q}\\cos\\phi}{4}}{A L \\frac{\\hat{p}^2}{4\\gamma p_0}} = \\frac{\\gamma - 1}{2} \\cdot \\frac{\\hat{q}\\cos\\phi}{\\hat{p}} \\cdot \\frac{1}{\\hat{p}} \\cdot \\frac{\\gamma p_0}{\\gamma p_0}.\n$$\n使用显式形式仔细进行代数运算，\n$$\n\\sigma = \\frac{1}{2} \\cdot \\frac{\\gamma - 1}{\\gamma p_0} \\cdot \\frac{A L \\hat{p}\\hat{q}\\cos\\phi / 4}{A L \\hat{p}^2 /(4\\gamma p_0)} = \\frac{1}{2} \\cdot \\frac{\\gamma - 1}{\\gamma p_0} \\cdot \\frac{\\hat{p}\\hat{q}\\cos\\phi}{\\hat{p}^2} \\cdot \\gamma p_0 = \\frac{\\gamma - 1}{2} \\cdot \\frac{\\hat{q}\\cos\\phi}{\\hat{p}}.\n$$\n因此，周期平均指数增长率为\n$$\n\\sigma = \\frac{\\gamma - 1}{2} \\cdot \\frac{\\hat{q}\\cos\\phi}{\\hat{p}}.\n$$\n注意，对于一个模态，如果其在 $p'$ 和 $q'$ 中的空间耦合因子相同，并且边界储存声能但在一个周期内无净通量，则 $A L$ 和 $\\gamma p_0$ 因子会消掉，留下一个与由模态能量密度振幅归一化的瑞利指数密度成正比的简洁表达式。$\\cos\\phi$ 的符号体现了瑞利判据：正向同相耦合（$|\\phi|  \\pi/2$）产生 $\\sigma > 0$。\n\n现在代入给定的数值。当 $\\gamma = 1.4$，$\\hat{q} = 1.0\\times 10^{3}\\,\\mathrm{W/m^3}$，$\\hat{p} = 1.0\\times 10^{2}\\,\\mathrm{Pa}$，以及 $\\phi = \\pi/3$ 时，\n$$\n\\cos\\phi = \\cos\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{2}, \\quad \\gamma - 1 = 0.4.\n$$\n因此，\n$$\n\\sigma = \\frac{0.4}{2} \\cdot \\frac{1.0\\times 10^{3} \\cdot \\frac{1}{2}}{1.0\\times 10^{2}} = 0.2 \\cdot \\frac{500}{100} = 0.2 \\cdot 5 = 1.0.\n$$\n四舍五入到四位有效数字并以 $\\mathrm{s^{-1}}$ 表示，结果为 $1.000\\,\\mathrm{s^{-1}}$。",
            "answer": "$$\\boxed{1.000}$$"
        }
    ]
}