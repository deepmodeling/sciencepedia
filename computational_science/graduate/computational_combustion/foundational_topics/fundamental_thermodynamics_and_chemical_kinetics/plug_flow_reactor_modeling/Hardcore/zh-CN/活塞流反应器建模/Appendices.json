{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你从最基本的摩尔守恒原理出发，推导平推流反应器（PFR）的积分形式设计方程。通过对一级和二级反应动力学进行积分，你将亲身体验反应级数如何影响达到特定转化率所需的反应器尺寸，从而为更复杂的反应器设计问题奠定坚实的数学基础。",
            "id": "3872934",
            "problem": "在平推流反应器 (PFR) 中进行物质 $A$ 到 $B$ 的液相等温不可逆异构化反应。进料只包含物质 $A$，其摩尔流量为 $F_{A0}$，浓度为 $C_{A0}$。密度恒定，体积流量恒定，无副反应，且轴向返混可忽略不计。根据候选的微观动力学机理， $A$ 的消失速率可能是关于 $A$ 的一级或二级反应：\n- 一级反应假设：$-r_{A} = k_{1} C_{A}$，其中 $k_{1}$ 为常数。\n- 二级反应假设：$-r_{A} = k_{2} C_{A}^{2}$，其中 $k_{2}$ 为常数。\n\n从反应器微元切片的稳态摩尔衡算和转化率的定义出发，推导 PFR 设计方程 $\\mathrm{d}X/\\mathrm{d}V = -r_{A}/F_{A0}$。然后，使用液相恒密度关系式 $C_{A} = C_{A0}(1-X)$，在每种动力学假设下进行积分，以获得反应器体积 $V$ 作为转化率 $X$ 的函数。对于目标转化率 $X = 0.85$，在恒定温度 $T$、进料摩尔流量 $F_{A0} = 10\\ \\mathrm{kmol}/\\mathrm{h}$、进料浓度 $C_{A0} = 1.0\\ \\mathrm{kmol}/\\mathrm{m}^{3}$、一级反应速率常数 $k_{1} = 0.75\\ \\mathrm{h}^{-1}$ 和二级反应速率常数 $k_{2} = 1.6\\ \\mathrm{m}^{3}/(\\mathrm{kmol}\\cdot\\mathrm{h})$ 的条件下，计算两种动力学假设下达到 $X=0.85$ 所需反应器体积的无量纲比值 $V_{\\text{second}}/V_{\\text{first}}$。将最终比值四舍五入至四位有效数字，并以无单位的纯数字形式报告。",
            "solution": "经评估，该问题陈述科学合理、提法恰当、客观、完整且一致。它代表了化学反应器设计中的一个标准问题。因此，有必要给出完整的解答。\n\n解答按要求分三个阶段进行：首先，推导以转化率表示的平推流反应器 (PFR) 设计方程；其次，针对一级和二级动力学对该方程进行积分，求出所需反应器体积 $V$ 作为转化率 $X$ 的函数；第三，在指定条件下，计算两种动力学模型所需体积的数值比。\n\n**1. PFR 设计方程的推导**\n\n我们从对在稳态下运行的 PFR 的一个微元体积 $\\mathrm{d}V$ 内的物质 $A$ 进行摩尔衡算开始。通用摩尔衡算方程为：\n$$\n\\text{流入} - \\text{流出} + \\text{生成} = \\text{累积}\n$$\n对于从体积 $V$ 到 $V + \\mathrm{d}V$ 的微元切片以及物质 $A$，该方程可表示为：\n$$\nF_{A}|_{V} - F_{A}|_{V+\\mathrm{d}V} + r_{A} \\mathrm{d}V = 0\n$$\n其中 $F_A$ 是 $A$ 的摩尔流量，$r_A$ 是单位体积内 $A$ 的生成速率。由于是稳态假设，累积项为零。\n$F_{A}|_{V+\\mathrm{d}V}$ 项可以表示为在 $V$ 附近的泰勒级数展开：$F_{A}|_{V+\\mathrm{d}V} = F_{A}|_{V} + \\frac{\\mathrm{d}F_A}{\\mathrm{d}V}\\mathrm{d}V + \\dots$。忽略高阶项，衡算方程变为：\n$$\nF_{A}|_{V} - \\left( F_{A}|_{V} + \\frac{\\mathrm{d}F_A}{\\mathrm{d}V}\\mathrm{d}V \\right) + r_{A} \\mathrm{d}V = 0\n$$\n$$\n-\\frac{\\mathrm{d}F_A}{\\mathrm{d}V}\\mathrm{d}V + r_{A} \\mathrm{d}V = 0\n$$\n两边同除以 $\\mathrm{d}V$ 得到以摩尔流量表示的 PFR 设计方程：\n$$\n\\frac{\\mathrm{d}F_A}{\\mathrm{d}V} = r_A\n$$\n反应物 $A$ 的分数转化率 $X$ 定义为已反应的 $A$ 的摩尔数占初始摩尔数的分数：\n$$\nX = \\frac{F_{A0} - F_A}{F_{A0}}\n$$\n其中 $F_{A0}$ 是反应器入口（$V=0$）处 $A$ 的摩尔进料速率。整理得到 $F_A$ 的表达式：\n$$\nF_A = F_{A0}(1-X)\n$$\n由于 $F_{A0}$ 是常数，对 $F_A$ 关于反应器体积 $V$ 求导得到：\n$$\n\\frac{\\mathrm{d}F_A}{\\mathrm{d}V} = \\frac{\\mathrm{d}}{\\mathrm{d}V}[F_{A0}(1-X)] = -F_{A0}\\frac{\\mathrm{d}X}{\\mathrm{d}V}\n$$\n将此结果代入摩尔衡算式 $\\frac{\\mathrm{d}F_A}{\\mathrm{d}V} = r_A$ 中，得到：\n$$\n-F_{A0}\\frac{\\mathrm{d}X}{\\mathrm{d}V} = r_A\n$$\n最后，我们整理得到题目所要求的、以转化率 $X$ 和 $A$ 的消失速率 $-r_A$ 表示的 PFR 设计方程：\n$$\n\\frac{\\mathrm{d}X}{\\mathrm{d}V} = \\frac{-r_A}{F_{A0}}\n$$\n至此，第一部分的推导完成。\n\n**2. 反应器体积作为转化率的函数**\n\n对于密度恒定的液相反应，体积流量 $v$ 是恒定的。物质 $A$ 的浓度 $C_A$ 与其摩尔流量 $F_A$ 通过 $C_A = F_A/v$ 相关联。在入口处，$C_{A0} = F_{A0}/v_{0}$。由于 $v=v_0$，我们可以写出：\n$$\nC_A = \\frac{F_A}{v_0} = \\frac{F_{A0}(1-X)}{v_0} = C_{A0}(1-X)\n$$\n这证实了问题陈述中给出的关系式。现在我们针对每种动力学假设对设计方程进行积分。\n\n设计方程可以分离变量并积分，以求得达到转化率 $X$ 所需的体积 $V$：\n$$\nV = F_{A0} \\int_{0}^{X} \\frac{1}{-r_A} \\mathrm{d}X'\n$$\n\n**一级反应假设：**\n速率定律为 $-r_A = k_1 C_A$。代入浓度表达式，我们得到：\n$$\n-r_A = k_1 C_{A0}(1-X)\n$$\n将此式代入设计方程的积分形式：\n$$\nV_{\\text{first}} = F_{A0} \\int_{0}^{X} \\frac{1}{k_1 C_{A0}(1-X')} \\mathrm{d}X'\n$$\n由于 $F_{A0}$、$k_1$ 和 $C_{A0}$ 是常数，我们可以将它们移到积分符号外：\n$$\nV_{\\text{first}} = \\frac{F_{A0}}{k_1 C_{A0}} \\int_{0}^{X} \\frac{1}{1-X'} \\mathrm{d}X' = \\frac{F_{A0}}{k_1 C_{A0}} [-\\ln(1-X')]_{0}^{X}\n$$\n$$\nV_{\\text{first}} = \\frac{F_{A0}}{k_1 C_{A0}} [-\\ln(1-X) - (-\\ln(1-0))] = -\\frac{F_{A0}}{k_1 C_{A0}} \\ln(1-X) = \\frac{F_{A0}}{k_1 C_{A0}} \\ln\\left(\\frac{1}{1-X}\\right)\n$$\n\n**二级反应假设：**\n速率定律为 $-r_A = k_2 C_A^2$。代入浓度表达式：\n$$\n-r_A = k_2 (C_{A0}(1-X))^2 = k_2 C_{A0}^2 (1-X)^2\n$$\n将此式代入积分设计方程：\n$$\nV_{\\text{second}} = F_{A0} \\int_{0}^{X} \\frac{1}{k_2 C_{A0}^2 (1-X')^2} \\mathrm{d}X'\n$$\n将常数移到积分符号外：\n$$\nV_{\\text{second}} = \\frac{F_{A0}}{k_2 C_{A0}^2} \\int_{0}^{X} (1-X')^{-2} \\mathrm{d}X' = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left[\\frac{1}{1-X'}\\right]_{0}^{X}\n$$\n$$\nV_{\\text{second}} = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{1}{1-X} - \\frac{1}{1-0}\\right) = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{1 - (1-X)}{1-X}\\right)\n$$\n$$\nV_{\\text{second}} = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{X}{1-X}\\right)\n$$\n\n**3. 反应器体积比的计算**\n\n我们现在使用推导出的表达式计算比值 $V_{\\text{second}}/V_{\\text{first}}$：\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{\\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{X}{1-X}\\right)}{\\frac{F_{A0}}{k_1 C_{A0}} \\ln\\left(\\frac{1}{1-X}\\right)}\n$$\n通过消去项（$F_{A0}$ 和一个 $C_{A0}$ 因子）来简化表达式：\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{k_1}{k_2 C_{A0}} \\frac{\\left(\\frac{X}{1-X}\\right)}{\\ln\\left(\\frac{1}{1-X}\\right)}\n$$\n这是该比值的最终符号表达式。现在，我们代入给定的数值：\n- 目标转化率 $X = 0.85$。\n- 一级反应速率常数 $k_1 = 0.75\\ \\mathrm{h}^{-1}$。\n- 二级反应速率常数 $k_2 = 1.6\\ \\mathrm{m}^{3}/(\\mathrm{kmol}\\cdot\\mathrm{h})$。\n- 进料浓度 $C_{A0} = 1.0\\ \\mathrm{kmol}/\\mathrm{m}^{3}$。\n\n首先，计算中间项：\n$$\n1 - X = 1 - 0.85 = 0.15\n$$\n$$\n\\frac{X}{1-X} = \\frac{0.85}{0.15} = \\frac{17}{3}\n$$\n$$\n\\frac{1}{1-X} = \\frac{1}{0.15} = \\frac{20}{3}\n$$\n$$\n\\ln\\left(\\frac{1}{1-X}\\right) = \\ln\\left(\\frac{20}{3}\\right)\n$$\n现在，将这些以及常数代入比值表达式中：\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{0.75\\ \\mathrm{h}^{-1}}{(1.6\\ \\mathrm{m}^{3}/(\\mathrm{kmol}\\cdot\\mathrm{h})) (1.0\\ \\mathrm{kmol}/\\mathrm{m}^{3})} \\frac{\\frac{17}{3}}{\\ln\\left(\\frac{20}{3}\\right)}\n$$\n第一项中的单位相互抵消，正如无量纲比值所预期的那样：\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{0.75}{1.6} \\frac{\\frac{17}{3}}{\\ln\\left(\\frac{20}{3}\\right)} = 0.46875 \\times \\frac{5.666...}{1.8971199...}\n$$\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = 0.46875 \\times 2.986980... \\approx 1.399678...\n$$\n将最终结果四舍五入至四位有效数字，得到 $1.400$。",
            "answer": "$$\n\\boxed{1.400}\n$$"
        },
        {
            "introduction": "在掌握了基本的设计方程后，本练习将探讨一个特殊的但重要的动力学情景：零级反应。你需要分析在不同相态（液相和气相）下，转化率随反应器长度的变化规律，并思考零级动力学假设背后的物理限制。这个思想实验旨在深化你对动力学模型与流体动力学相互作用的理解。",
            "id": "3894947",
            "problem": "考虑一个稳态、等温、恒定横截面积的活塞流反应器 (PFR)，其中进行着消耗反应物 $A$ 的单一不可逆反应。设单位反应器体积的消耗速率对 $A$ 为零级，即 $r_{A} = -k$，其中 $k  0$ 且与 $C_{A}$ 和位置无关，前提是 $A$ 存在。在 $z = 0$ 处的入口浓度为 $C_{A0}$，轴向坐标为 $z \\ge 0$。设表观速度为 $u(z) = v(z)/A_{c}$，其中 $v(z)$ 是体积流量，$A_{c}$ 是横截面积。假设轴向返混和径向梯度可忽略不计。定义转化率 $X_{A}(z) = \\left(C_{A0} - C_{A}(z)\\right)/C_{A0}$。\n\n仅从长度为 $dz$ 的微分片元上的物种守恒定律和 $X_{A}(z)$ 的定义出发，分析 $X_{A}(z)$ 随 $z$ 线性变化的条件，并讨论浓度保持非负的物理要求。当说明时，你可以假设为不可压缩液体；当说明时，可以假设为恒温恒压的理想气体。选择所有正确的陈述。\n\nA. 在一个等温液相 PFR 中，若密度恒定且 $A_{c}$ 恒定（因此 $u$ 恒定），零级动力学 $r_{A} = -k$ 意味着 $C_{A}(z)$ 和 $X_{A}(z)$ 是 $z$ 的严格线性函数，直到 $C_{A}$ 在一个有限的耗尽长度 $z^{\\ast} = u\\,C_{A0}/k$ 处达到 $0$ 为止，此后对于所有 $z \\ge z^{\\ast}$，$X_{A}(z) = 1$。\n\nB. 在一个恒温恒压的气相 PFR 中，对于一个净化学计量摩尔数变化 $\\Delta \\nu \\ne 0$ 的理想气体反应，在 $r_{A} = -k$ 的条件下，$X_{A}(z)$ 对于所有的 $z$ 始终是 $z$ 的严格线性函数，因为反应速率不依赖于 $C_{A}$。\n\nC. 如果存在轴向压降以至于 $u(z)$ 随 $z$ 变化，只要 $k$ 是常数，零级反应条件 $r_{A} = -k$ 就足以保证 $X_{A}(z)$ 是 $z$ 的严格线性函数，即使 $u(z)$ 不是常数。\n\nD. 如果零级动力学是由 $A$ 导致的催化剂表面饱和引起的，那么零级反应区间在物理上要求 $C_{A}$ 足够大以维持饱和状态；当 $C_{A} \\to 0$ 时，该假设不成立，没有 $A$ 反应无法进行，这意味着存在一个有限的耗尽长度，超过该长度后 $r_{A} = 0$ 且 $X_{A}(z)$ 饱和在 $1$。\n\nE. 在一个恒温恒压的气相 PFR 中，对于一个净化学计量摩尔数变化为 $\\Delta \\nu = 0$ 且压降可忽略不计的理想气体反应，$u$ 是恒定的；在 $r_{A} = -k$ 的条件下，$X_{A}(z)$ 在达到耗尽长度之前是 $z$ 的线性函数，超过该长度后 $X_{A}(z) = 1$。",
            "solution": "### 核心推导\n\n首先，我们从以转化率表示的PFR设计方程入手。对于反应器微元体积 $dV$，物料衡算为：\n$$F_{A0} \\frac{dX_A}{dV} = -r_A$$\n其中 $F_{A0}$ 是A的入口摩尔流量，$X_A$ 是A的转化率，$-r_A$ 是A的消耗速率，$V$ 是反应器体积。\n\n根据题意，反应为零级，因此 $-r_A = k$（一个常数），前提是反应物 $A$ 存在。\n反应器体积微元与轴向长度微元 $dz$ 的关系是 $dV = A_c dz$，其中 $A_c$ 是恒定的横截面积。\n将这些代入设计方程，我们得到：\n$$F_{A0} \\frac{dX_A}{A_c dz} = k$$\n整理得到转化率随轴向位置的变化率：\n$$\\frac{dX_A}{dz} = \\frac{k A_c}{F_{A0}}$$\n由于 $k$，$A_c$ 和 $F_{A0}$ 都是常数，因此 $\\frac{dX_A}{dz}$ 是一个正的常数，只要反应在进行（即 $X_A  1$）。\n\n对上式从入口 $z=0$（$X_A=0$）积分到任意位置 $z$（$X_A(z)$），我们得到：\n$$X_A(z) = \\left(\\frac{k A_c}{F_{A0}}\\right) z$$\n这个结果表明，只要反应物 $A$ 尚未耗尽，转化率 $X_A$ 就与轴向位置 $z$ 呈严格的线性关系。这个推导不依赖于流体速度 $u(z)$ 是否变化，也不依赖于流体是液相还是气相。\n\n反应将在转化率达到1时停止。我们可以计算出反应物A被完全耗尽所需的反应器长度，即耗尽长度 $z^\\ast$：\n$$1 = \\left(\\frac{k A_c}{F_{A0}}\\right) z^\\ast \\implies z^\\ast = \\frac{F_{A0}}{k A_c}$$\n对于 $z \\ge z^\\ast$，反应停止（$-r_A = 0$），转化率保持在 $X_A = 1$。\n\n### 逐项分析\n\n**A.** 在等温液相PFR中，密度和速度 $u$ 恒定。我们可以用入口浓度和速度表示入口流量：$F_{A0} = u A_c C_{A0}$。代入耗尽长度的表达式：\n$z^\\ast = \\frac{u A_c C_{A0}}{k A_c} = \\frac{u C_{A0}}{k}$。\n该陈述指出，$X_A(z)$（以及 $C_A(z) = C_{A0}(1-X_A(z))$）是 $z$ 的线性函数，直到在 $z^\\ast = u C_{A0} / k$ 处耗尽，之后 $X_A(z)=1$。这与我们的推导完全一致。**因此，陈述A是正确的。**\n\n**B.** 在气相反应中，即使净摩尔数变化 $\\Delta\\nu \\ne 0$ 导致速度 $u(z)$ 变化，我们上面的核心推导表明 $X_A(z)$ 仍然与 $z$ 呈线性关系，因为设计方程 $dX_A/dz = \\text{常数}$ 不依赖于 $u(z)$。然而，该陈述声称 $X_A(z)$ “对于所有的 $z$ 始终是 $z$ 的严格线性函数”。这是不正确的。当 $z \\ge z^\\ast$ 时，$X_A(z)$ 变为常数1，不再是严格线性的。**因此，陈述B是错误的。**\n\n**C.** 如果存在轴向压降，速度 $u(z)$ 会变化。如上所述，这并不影响 $X_A$ 与 $z$ 的线性关系。但是，与B类似，该陈述声称 $X_A(z)$ 是“$z$ 的严格线性函数”，没有指明该线性关系仅在反应物耗尽前有效。这个表述不严谨，因为它对所有 $z$ 都不成立。**因此，陈述C是错误的。**\n\n**D.** 此陈述探讨了零级动力学的物理基础，例如在异相催化中，当反应物浓度足够高以至于催化剂表面活性位点完全饱和时。它正确地指出，这个假设在反应物浓度趋于零时会失效，因为反应速率必须在没有反应物时降至零。这物理上意味着反应会在一个有限的长度内停止，之后转化率饱和在1。这个物理描述与我们的数学模型的结果（存在耗尽长度 $z^\\ast$）是完全吻合的。**因此，陈述D是正确的。**\n\n**E.** 在一个恒温恒压、净摩尔数变化为零（$\\Delta\\nu=0$）的气相反应中，总摩尔数和平均分子量保持不变。根据理想气体状态方程 $P = \\rho RT/\\bar{W}$，密度 $\\rho$ 也是恒定的。由于质量流率 $\\dot{m} = \\rho u A_c$ 恒定，且 $\\rho$ 和 $A_c$ 恒定，所以速度 $u$ 也必须是恒定的。这种情况在数学上与选项A中的恒密度液相情况完全相同。该陈述准确地描述了 $X_A(z)$ 在达到耗尽长度之前是线性的，之后等于1。**因此，陈述E是正确的。**\n\n综上所述，正确的陈述是A、D和E。",
            "answer": "$$\\boxed{ADE}$$"
        },
        {
            "introduction": "这个综合性计算练习将挑战你将理论知识转化为实际的计算机模型。你需要耦合质量衡算、能量衡算以及温度依赖的热力学（van't Hoff 方程），来模拟一个绝热PFR中的可逆吸热反应。通过编程实现，你将能预测反应器内的温度和浓度分布，并识别由于温度下降而导致的“近平衡失速”现象，这是设计和操作真实反应器时需要考虑的关键问题。",
            "id": "3894917",
            "problem": "考虑一个稳态、绝热的平推流反应器 (PFR)，其中两种气相物质之间发生单一、基元、可逆的吸热反应，即 $A \\rightleftharpoons B$。该反应器横截面积恒定，并在恒定压力下运行。进料中可能含有一种惰性物质 $I$。总摩尔流量 $F_{\\text{tot}}$ 是 $A$、$B$ 和 $I$ 的摩尔流量之和。必须使用以下基本原理来推导模型：\n- PFR 中物质 $i$ 的一维稳态摩尔衡算为 $dF_i/dz = \\nu_i r V'$，其中 $z$ 是轴向坐标（单位：米），$\\nu_i$ 是物质 $i$ 的化学计量系数，$r$ 是反应速率（单位：$\\text{mol}/(\\text{m}^3\\cdot\\text{s})$），$V' = A_c$ 是反应器横截面积（单位：$\\text{m}^2$）。\n- 绝热 PFR 的一维稳态能量衡算为 $dT/dz = -\\Delta H_{\\text{rxn}}\\, r\\, A_c / \\left(\\sum_j F_j C_{p,j}\\right)$，其中 $T$ 是温度（单位：$\\text{K}$），$\\Delta H_{\\text{rxn}}  0$ 是吸热反应的反应焓（单位：$\\text{J}/\\text{mol}$），$C_{p,j}$ 是物质 $j$ 的恒压摩尔热容（单位：$\\text{J}/(\\text{mol}\\cdot\\text{K})$），求和遍及所有存在的物质。\n- 理想气体定律意味着总摩尔浓度 $C_{\\text{tot}} = P/(R T)$（单位：$\\text{mol}/\\text{m}^3$），其中 $P$ 的单位是 $\\text{Pa}$，普适气体常数 $R$ 的单位是 $\\text{J}/(\\text{mol}\\cdot\\text{K})$。分浓度为 $C_i = y_i C_{\\text{tot}}$，其中 $y_i = F_i/F_{\\text{tot}}$。\n- 基元可逆反应的速率定律为 $r = k_f(T) C_A - k_r(T) C_B$，其 Arrhenius 动力学为 $k_f(T) = k_{0,f} \\exp\\!\\left(-E_f/(R T)\\right)$，其中 $k_{0,f}$ 是指前因子（单位：$\\text{s}^{-1}$），$E_f$ 是正向活化能（单位：$\\text{J}/\\text{mol}$）。热力学一致性要求 $k_r(T) = k_f(T)/K_{\\text{eq}}(T)$。\n- 平衡常数 $K_{\\text{eq}}(T)$ 的 van't Hoff 关系为 $d\\ln K_{\\text{eq}}/dT = \\Delta H_{\\text{rxn}}/(R T^2)$，当在参考温度 $T_{\\text{ref}}$ 下已知 $K_{\\text{eq}}(T_{\\text{ref}}) = K_{\\text{ref}}$ 时，该式积分可得 $\\ln K_{\\text{eq}}(T) = \\ln K_{\\text{ref}} + \\Delta H_{\\text{rxn}}/R \\left(1/T_{\\text{ref}} - 1/T\\right)$。\n- 在理想气体近似下的反应商为 $Q = y_B/y_A$。\n\n定义一个“近平衡停滞”位置 $z^\\star$，其为满足无量纲接近度量 $\\left|\\ln\\!\\left(Q/K_{\\text{eq}}(T)\\right)\\right| \\le \\tau$ 的最小轴向位置，其中给定容差 $\\tau  0$。如果在反应器长度内没有出现这样的位置，则报告 $z^\\star = -1.0$。\n\n您的任务是：\n1. 基于这些原理，推导关于 $F_A(z)$、$F_B(z)$ 和 $T(z)$ 的耦合微分方程，并阐明与温度相关的平衡如何通过 $k_r(T) = k_f(T)/K_{\\text{eq}}(T)$ 影响逆反应速率。\n2. 实现一个稳健的数值求解器，该求解器沿 $z$ 从入口到指定的最大长度对耦合系统进行积分，检测第一个满足 $\\left|\\ln\\!\\left(Q/K_{\\text{eq}}(T)\\right)\\right| \\le \\tau$ 的轴向位置 $z^\\star$。使用一种在 $y_A$ 或 $y_B$ 非常小时数值上适定的事件检测策略。\n3. 对于下面的每个测试用例，计算 $z^\\star$（单位：米），四舍五入到六位小数。如果在反应器长度内未检测到停滞，则返回 $-1.000000$。\n\n使用普适气体常数 $R = 8.31446261815324\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$。\n\n测试套件：\n- 案例 1（吸热，含惰性物质，温度下降显著）：\n  - $A_c = 0.01\\,\\text{m}^2$\n  - $P = 2.0\\times 10^5\\,\\text{Pa}$\n  - $T_{\\text{in}} = 800.0\\,\\text{K}$\n  - $F_{A,0} = 1.0\\,\\text{mol}/\\text{s}$，$F_{B,0} = 0.0\\,\\text{mol}/\\text{s}$，$F_{I,0} = 2.0\\,\\text{mol}/\\text{s}$\n  - $C_{p,A} = 35.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，$C_{p,B} = 35.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，$C_{p,I} = 30.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$\n  - $\\Delta H_{\\text{rxn}} = 5.0\\times 10^4\\,\\text{J}/\\text{mol}$\n  - $k_{0,f} = 2.0\\times 10^5\\,\\text{s}^{-1}$，$E_f = 8.0\\times 10^4\\,\\text{J}/\\text{mol}$\n  - $K_{\\text{ref}} = 3.0$ 于 $T_{\\text{ref}} = 800.0\\,\\text{K}$\n  - $\\tau = 0.02$\n  - $z_{\\max} = 5.0\\,\\text{m}$\n- 案例 2（吸热但温度依赖性较弱，无惰性物质）：\n  - $A_c = 0.02\\,\\text{m}^2$\n  - $P = 1.5\\times 10^5\\,\\text{Pa}$\n  - $T_{\\text{in}} = 700.0\\,\\text{K}$\n  - $F_{A,0} = 2.0\\,\\text{mol}/\\text{s}$，$F_{B,0} = 0.5\\,\\text{mol}/\\text{s}$，$F_{I,0} = 0.0\\,\\text{mol}/\\text{s}$\n  - $C_{p,A} = 33.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，$C_{p,B} = 33.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，$C_{p,I} = 0.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$\n  - $\\Delta H_{\\text{rxn}} = 8.0\\times 10^3\\,\\text{J}/\\text{mol}$\n  - $k_{0,f} = 1.0\\times 10^5\\,\\text{s}^{-1}$，$E_f = 7.0\\times 10^4\\,\\text{J}/\\text{mol}$\n  - $K_{\\text{ref}} = 2.0$ 于 $T_{\\text{ref}} = 700.0\\,\\text{K}$\n  - $\\tau = 0.02$\n  - $z_{\\max} = 10.0\\,\\text{m}$\n- 案例 3（与案例 1 相同，但停滞容差更严格）：\n  - $A_c = 0.01\\,\\text{m}^2$\n  - $P = 2.0\\times 10^5\\,\\text{Pa}$\n  - $T_{\\text{in}} = 800.0\\,\\text{K}$\n  - $F_{A,0} = 1.0\\,\\text{mol}/\\text{s}$，$F_{B,0} = 0.0\\,\\text{mol}/\\text{s}$，$F_{I,0} = 2.0\\,\\text{mol}/\\text{s}$\n  - $C_{p,A} = 35.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，$C_{p,B} = 35.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，$C_{p,I} = 30.0\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$\n  - $\\Delta H_{\\text{rxn}} = 5.0\\times 10^4\\,\\text{mol}$\n  - $k_{0,f} = 2.0\\times 10^5\\,\\text{s}^{-1}$，$E_f = 8.0\\times 10^4\\,\\text{J}/\\text{mol}$\n  - $K_{\\text{ref}} = 3.0$ 于 $T_{\\text{ref}} = 800.0\\,\\text{K}$\n  - $\\tau = 1.0\\times 10^{-4}$\n  - $z_{\\max} = 5.0\\,\\text{m}$\n\n您的程序应生成单行输出，其中包含三个计算出的停滞位置（单位：米），以逗号分隔并用方括号括起（例如，“[z1,z2,z3]”），每个数字四舍五入到六位小数，并以米为单位表示。输出必须严格遵循此格式。",
            "solution": "### 步骤 1：问题有效性验证\n该问题陈述清晰、科学合理且自洽，为标准的计算化学工程问题。它要求推导和求解一个耦合的常微分方程（ODE）系统，以模拟绝热PFR中的可逆反应。所有必需的方程、参数和初始条件均已提供。该问题是适定的，可以进行数值求解。\n\n### 步骤 2：控制方程推导\n我们将建立一个描述状态向量 $\\mathbf{y}(z) = [F_A(z), T(z)]^T$ 沿反应器轴向位置 $z$ 变化的ODE系统。\n\n1.  **摩尔衡算与化学计量**：\n    对于反应 $A \\rightleftharpoons B$，化学计量系数为 $\\nu_A = -1$ 和 $\\nu_B = +1$。惰性物质 $I$ 的摩尔流量 $F_I$ 保持恒定，即 $F_I(z) = F_{I,0}$。\n    A和B的摩尔衡算方程分别为：\n    $$ \\frac{dF_A}{dz} = \\nu_A r A_c = -r A_c $$\n    $$ \\frac{dF_B}{dz} = \\nu_B r A_c = +r A_c $$\n    将两者相加，得到 $d(F_A + F_B)/dz = 0$，这意味着 $F_A(z) + F_B(z) = F_{A,0} + F_{B,0}$（常数）。因此，我们可以用 $F_A$ 来表示 $F_B$：\n    $$F_B(z) = F_{A,0} + F_{B,0} - F_A(z)$$\n    总摩尔流量也是恒定的：$F_{\\text{tot}} = F_A(z) + F_B(z) + F_I(z) = F_{A,0} + F_{B,0} + F_{I,0}$。\n    因此，我们只需对一个摩尔流量（$F_A$）进行积分。\n\n2.  **反应速率 ($r$) 表达式**：\n    基元反应的速率定律为 $r = k_f(T) C_A - k_r(T) C_B$。\n    利用热力学一致性关系 $k_r(T) = k_f(T)/K_{\\text{eq}}(T)$，速率表达式变为：\n    $$ r = k_f(T) \\left( C_A - \\frac{C_B}{K_{\\text{eq}}(T)} \\right) $$\n    使用理想气体定律 $C_j = y_j (P/RT) = (F_j/F_{\\text{tot}}) (P/RT)$，代入上式得到速率 $r$ 关于摩尔流量和温度的表达式：\n    $$ r = k_f(T) \\frac{P}{RT F_{\\text{tot}}} \\left( F_A - \\frac{F_B}{K_{\\text{eq}}(T)} \\right) $$\n    其中：\n    - 正向速率常数 $k_f(T)$ 由阿伦尼乌斯方程给出：$k_f(T) = k_{0,f} \\exp\\left(-\\frac{E_f}{RT}\\right)$。\n    - 平衡常数 $K_{\\text{eq}}(T)$ 由积分形式的范特霍夫方程给出：$K_{\\text{eq}}(T) = \\exp\\left( \\ln K_{\\text{ref}} + \\frac{\\Delta H_{\\text{rxn}}}{R} \\left(\\frac{1}{T_{\\text{ref}}} - \\frac{1}{T}\\right) \\right)$。\n\n3.  **能量衡算**：\n    绝热PFR的能量衡算方程为：\n    $$ \\frac{dT}{dz} = -\\frac{\\Delta H_{\\text{rxn}}\\, r\\, A_c}{\\sum_j F_j C_{p,j}} $$\n    分母是总热容流率，随反应进程而变：$\\sum_j F_j C_{p,j} = F_A C_{p,A} + F_B C_{p,B} + F_I C_{p,I}$。\n\n4.  **最终的ODE系统**：\n    联立上述方程，我们得到关于状态向量 $\\mathbf{y}(z) = [F_A(z), T(z)]^T$ 的耦合一阶ODE系统：\n    $$ \\frac{dF_A}{dz} = -r A_c $$\n    $$ \\frac{dT}{dz} = -\\frac{\\Delta H_{\\text{rxn}}\\, r\\, A_c}{F_A C_{p,A} + (F_{A,0} + F_{B,0} - F_A) C_{p,B} + F_{I,0} C_{p,I}} $$\n    其中 $r$ 是依赖于 $F_A$ 和 $T$ 的函数。该系统的初始条件为 $z=0$ 处的 $\\mathbf{y}(0) = [F_{A,0}, T_{\\text{in}}]$。\n\n### 步骤 3：数值实现策略\n\n1.  **ODE求解器**：我们将使用Python中SciPy库的 `solve_ivp` 函数。该函数是一个功能强大且稳健的ODE求解器，并内置了事件检测功能。\n\n2.  **事件检测**：我们需要找到满足条件 $|\\ln(Q/K_{\\text{eq}})| \\le \\tau$ 的最小正位置 $z^\\star$。这等价于寻找事件函数 $g(z, \\mathbf{y}) = |\\ln(Q/K_{\\text{eq}})| - \\tau$ 的第一个根。\n    - **数值稳定性**：当 $F_A$ 或 $F_B$ 趋近于零时，反应商 $Q = F_B/F_A$ 的对数 $\\ln(Q)$ 会变得无定义或导致数值溢出。为避免此问题，事件函数的实现需要加入保护机制。例如，在计算 $Q$ 之前，检查 $F_A$ 和 $F_B$ 是否低于一个小的阈值。如果 $F_B$ 接近零（如在反应初期），$Q$ 接近零，$\\ln(Q)$ 趋于负无穷，$|\\ln(Q/K_{\\text{eq}})|$ 是一个大正数，此时不应触发事件。\n    - **事件属性**：随着反应趋于平衡，事件函数的值会从正值减小并穿越零。因此，我们需要检测一个方向为负（`direction = -1`）的过零事件。同时，一旦事件被检测到，积分就应停止，因此我们将事件的 `terminal` 属性设置为 `True`。\n\n3.  **算法流程**：\n    - 对每个案例，将所有参数打包。\n    - 定义一个函数，根据当前状态 `y = [F_A, T]` 计算导数向量 `dydz`。\n    - 定义一个事件函数 `event_stall`，该函数计算 $g(z, \\mathbf{y})$。\n    - 使用 `solve_ivp` 对ODE系统从 $z=0$ 到 $z=z_{\\max}$ 进行积分。\n    - 如果 `solve_ivp` 的返回结果中包含事件，则停滞位置 $z^\\star$ 是第一个被记录的事件时间 `sol.t_events[0][0]`。\n    - 如果在积分区间内没有检测到事件，则 $z^\\star$ 为 -1.0。\n    - 格式化输出结果。\n以下是实现此逻辑的完整Python代码。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the near-equilibrium stall position in a PFR for given test cases.\n    \"\"\"\n    R_GAS = 8.31446261815324\n\n    test_cases = [\n        # Case 1 (endothermic with inert, strong temperature drop):\n        {\n            \"Ac\": 0.01, \"P\": 2.0e5, \"T_in\": 800.0,\n            \"F_A0\": 1.0, \"F_B0\": 0.0, \"F_I0\": 2.0,\n            \"CpA\": 35.0, \"CpB\": 35.0, \"CpI\": 30.0,\n            \"dH_rxn\": 5.0e4, \"k0f\": 2.0e5, \"Ef\": 8.0e4,\n            \"K_ref\": 3.0, \"T_ref\": 800.0,\n            \"tau\": 0.02, \"z_max\": 5.0\n        },\n        # Case 2 (endothermic but mild temperature dependence, no inert):\n        {\n            \"Ac\": 0.02, \"P\": 1.5e5, \"T_in\": 700.0,\n            \"F_A0\": 2.0, \"F_B0\": 0.5, \"F_I0\": 0.0,\n            \"CpA\": 33.0, \"CpB\": 33.0, \"CpI\": 0.0,\n            \"dH_rxn\": 8.0e3, \"k0f\": 1.0e5, \"Ef\": 7.0e4,\n            \"K_ref\": 2.0, \"T_ref\": 700.0,\n            \"tau\": 0.02, \"z_max\": 10.0\n        },\n        # Case 3 (same as Case 1 but stringent stall tolerance):\n        {\n            \"Ac\": 0.01, \"P\": 2.0e5, \"T_in\": 800.0,\n            \"F_A0\": 1.0, \"F_B0\": 0.0, \"F_I0\": 2.0,\n            \"CpA\": 35.0, \"CpB\": 35.0, \"CpI\": 30.0,\n            \"dH_rxn\": 5.0e4, \"k0f\": 2.0e5, \"Ef\": 8.0e4,\n            \"K_ref\": 3.0, \"T_ref\": 800.0,\n            \"tau\": 1.0e-4, \"z_max\": 5.0\n        }\n    ]\n\n    def dydz(z, y, p):\n        \"\"\"\n        Defines the system of ordinary differential equations for the PFR model.\n        y = [F_A, T]\n        \"\"\"\n        F_A, T = y\n\n        # State variable protection\n        if T = 0: return [0.0, 0.0]\n        F_A = max(0.0, F_A)\n        \n        # Algebraic relations\n        F_B = p[\"F_A0\"] + p[\"F_B0\"] - F_A\n        F_B = max(0.0, F_B)\n        F_tot = p[\"F_A0\"] + p[\"F_B0\"] + p[\"F_I0\"]\n\n        # Temperature-dependent parameters\n        k_f = p[\"k0f\"] * np.exp(-p[\"Ef\"] / (R_GAS * T))\n        \n        log_K_ref = np.log(p[\"K_ref\"])\n        ln_K_eq = log_K_ref + (p[\"dH_rxn\"] / R_GAS) * (1.0 / p[\"T_ref\"] - 1.0 / T)\n        K_eq = np.exp(ln_K_eq)\n\n        # Rate of reaction\n        r = k_f * (p[\"P\"] / (R_GAS * T * F_tot)) * (F_A - F_B / K_eq)\n\n        # Derivatives\n        dFA_dz = -r * p[\"Ac\"]\n        \n        sum_FCp = F_A * p[\"CpA\"] + F_B * p[\"CpB\"] + p[\"F_I0\"] * p[\"CpI\"]\n        if abs(sum_FCp)  1e-12:\n            dT_dz = 0.0\n        else:\n            dT_dz = -p[\"dH_rxn\"] * r * p[\"Ac\"] / sum_FCp\n        \n        return [dFA_dz, dT_dz]\n\n    def event_stall(z, y, p):\n        \"\"\"\n        Event function to detect near-equilibrium stall.\n        Triggers when |ln(Q/K_eq)| - tau = 0.\n        \"\"\"\n        F_A, T = y\n        \n        # Guard against undefined logs at z=0 or due to numerical error\n        if F_A = 1e-20 or T = 0: return 1.0\n        \n        F_B = p[\"F_A0\"] + p[\"F_B0\"] - F_A\n        if F_B = 1e-20: return 1.0\n        \n        # Reaction quotient\n        Q = F_B / F_A\n        \n        # Equilibrium constant\n        log_K_ref = np.log(p[\"K_ref\"])\n        ln_K_eq = log_K_ref + (p[\"dH_rxn\"] / R_GAS) * (1.0 / p[\"T_ref\"] - 1.0 / T)\n        K_eq = np.exp(ln_K_eq)\n        if K_eq = 1e-20: return 1.0\n\n        # Event function value\n        value = np.abs(np.log(Q / K_eq)) - p[\"tau\"]\n        return value\n\n    event_stall.terminal = True\n    event_stall.direction = -1\n\n    results = []\n    for params in test_cases:\n        y0 = [params[\"F_A0\"], params[\"T_in\"]]\n        z_span = [0, params[\"z_max\"]]\n        \n        rtol = 1e-9\n        atol = 1e-12\n\n        sol = solve_ivp(\n            dydz, \n            z_span, \n            y0, \n            args=(params,),\n            method='RK45', \n            events=event_stall, \n            dense_output=True,\n            rtol=rtol,\n            atol=atol\n        )\n\n        if sol.status == 1 and len(sol.t_events[0]) > 0:\n            z_star = sol.t_events[0][0]\n        else:\n            z_star = -1.0\n            \n        results.append(f\"{z_star:.6f}\")\n\n    # Expected format: [z1,z2,z3]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}