{
    "hands_on_practices": [
        {
            "introduction": "此练习旨在深入探讨全局反应模型的基本参数与实验可观测的表观活化能之间的关系。通过推导两者之间的联系，您将更深刻地理解全局反应速率的温度依赖性是如何源于内在的阿伦尼乌斯项以及温度对物种浓度的影响。这项分析对于解释实验数据和评估全局模型的预测能力至关重要。",
            "id": "4028516",
            "problem": "气态燃料的单步总包氧化模型使用经验速率定律 $r = k \\, C_{F}^{a} \\, C_{O_{2}}^{b}$，其中 $r$ 是燃料的体积消耗速率，$C_{F}$ 和 $C_{O_{2}}$ 分别是燃料和氧气的摩尔浓度，$a$ 和 $b$ 是总包反应级数。速率系数的温度依赖性由修正的 Arrhenius 形式 $k = A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)$ 描述，其中 $A$ 是指前因子，$n$ 是温度指数，$E_{a}$ 是活化能，$R$ 是通用气体常数，$T$ 是绝对温度。\n\n考虑一个在恒定总压 $p$ 下、具有固定反应物摩尔分数 $X_{F}$ 和 $X_{O_{2}}$（低转化率）的充分搅拌环境，因此对于每种物质 $i$，其摩尔浓度遵循理想气体关系 $C_{i} = \\frac{X_{i} \\, p}{R T}$。将在恒压和固定组分条件下的表观活化能定义为\n$$\nE_{\\mathrm{app}}(T) \\equiv - R \\, \\frac{d \\ln r}{d \\!\\left(1/T\\right)} \\, .\n$$\n从所述的经验速率定律、修正的 Arrhenius 温度依赖关系以及浓度的理想气体关系出发，推导 $E_{\\mathrm{app}}(T)$ 关于 $E_{a}$、$R$、$T$、$n$、$a$ 和 $b$ 的解析表达式。然后，对于参数 $E_{a} = 1.60 \\times 10^{5} \\ \\mathrm{J/mol}$，$n = 0.60$，$a = 1.10$，$b = 0.35$ 和 $R = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$，计算在 $T = 1450 \\ \\mathrm{K}$ 时的 $E_{\\mathrm{app}}$。将最终数值答案四舍五入到四位有效数字。以 $\\mathrm{kJ/mol}$ 为单位表示最终能量。",
            "solution": "该问题要求推导在特定条件下，针对总包反应机理的表观活化能 $E_{\\mathrm{app}}(T)$ 的表达式，然后进行数值计算。\n\n分析从给定的燃料消耗速率 $r$ 的经验速率定律开始：\n$$\nr = k \\, C_{F}^{a} \\, C_{O_{2}}^{b}\n$$\n速率系数 $k$ 遵循修正的 Arrhenius 温度依赖关系：\n$$\nk = A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\n在恒定总压 $p$ 和固定摩尔分数 $X_F$ 和 $X_{O_2}$ 的条件下，燃料 ($C_F$) 和氧气 ($C_{O_2}$) 的摩尔浓度由理想气体定律给出：\n$$\nC_{F} = \\frac{X_{F} \\, p}{R T} \\quad \\text{和} \\quad C_{O_{2}} = \\frac{X_{O_{2}} \\, p}{R T}\n$$\n首先，我们通过代入 $k$、$C_F$ 和 $C_{O_2}$ 的表达式，来构建反应速率 $r$ 的完整表达式：\n$$\nr = \\left[ A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right) \\right] \\left( \\frac{X_{F} \\, p}{R T} \\right)^{a} \\left( \\frac{X_{O_{2}} \\, p}{R T} \\right)^{b}\n$$\n我们可以将依赖于温度 $T$ 的项和在给定条件下（$A$、$X_F$、$X_{O_2}$、$p$、$R$、$a$、$b$、$n$）为常数的项进行分组。\n$$\nr = A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b} \\cdot T^{n} \\left( \\frac{1}{T} \\right)^{a} \\left( \\frac{1}{T} \\right)^{b} \\cdot \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\n合并 $T$ 的幂次：\n$$\nr = \\left[ A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b} \\right] T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\n方括号中的项相对于温度是常数。我们用常数 $K'$ 来表示它：\n$$\nK' = A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b}\n$$\n速率表达式简化为：\n$$\nr = K' \\, T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\n表观活化能定义为：\n$$\nE_{\\mathrm{app}}(T) \\equiv - R \\, \\frac{d \\ln r}{d \\!\\left(1/T\\right)}\n$$\n为了计算这个导数，我们首先对速率表达式取自然对数：\n$$\n\\ln r = \\ln \\left( K' \\, T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right) \\right)\n$$\n$$\n\\ln r = \\ln K' + \\ln(T^{n - a - b}) + \\ln\\left(\\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\\right)\n$$\n$$\n\\ln r = \\ln K' + (n - a - b) \\ln T - \\frac{E_{a}}{R T}\n$$\n现在我们必须对 $\\ln r$ 求关于 $1/T$ 的导数。我们使用链式法则：\n$$\n\\frac{d(\\ln r)}{d(1/T)} = \\frac{d(\\ln r)}{dT} \\cdot \\frac{dT}{d(1/T)}\n$$\n首先，我们求 $\\ln r$ 关于 $T$ 的导数：\n$$\n\\frac{d(\\ln r)}{dT} = \\frac{d}{dT} \\left( \\ln K' + (n - a - b) \\ln T - \\frac{E_{a}}{R} T^{-1} \\right)\n$$\n由于 $\\ln K'$ 是一个常数，其导数为零。\n$$\n\\frac{d(\\ln r)}{dT} = (n - a - b) \\frac{1}{T} - \\frac{E_{a}}{R} (-1) T^{-2} = \\frac{n - a - b}{T} + \\frac{E_{a}}{R T^2}\n$$\n接下来，我们确定 $T$ 关于 $1/T$ 的导数。令 $u = 1/T$，这意味着 $T = 1/u = u^{-1}$。\n$$\n\\frac{dT}{d(1/T)} = \\frac{dT}{du} = -1 \\cdot u^{-2} = -u^{-2} = -(1/T)^{-2} = -T^2\n$$\n现在我们使用链式法则将这些结果结合起来：\n$$\n\\frac{d(\\ln r)}{d(1/T)} = \\left( \\frac{n - a - b}{T} + \\frac{E_{a}}{R T^2} \\right) (-T^2)\n$$\n$$\n\\frac{d(\\ln r)}{d(1/T)} = - (n - a - b) T - \\frac{E_{a}}{R}\n$$\n最后，我们将其代回 $E_{\\mathrm{app}}(T)$ 的定义中：\n$$\nE_{\\mathrm{app}}(T) = -R \\left[ - (n - a - b) T - \\frac{E_{a}}{R} \\right]\n$$\n$$\nE_{\\mathrm{app}}(T) = R (n - a - b) T + R \\frac{E_{a}}{R}\n$$\n这就得出了表观活化能的所需解析表达式：\n$$\nE_{\\mathrm{app}}(T) = E_{a} + (n - a - b) R T\n$$\n下一步是使用给定的参数计算此表达式的值：\n$E_{a} = 1.60 \\times 10^{5} \\ \\mathrm{J/mol}$\n$n = 0.60$\n$a = 1.10$\n$b = 0.35$\n$R = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$\n$T = 1450 \\ \\mathrm{K}$\n\n首先，我们计算指数和：\n$$\nn - a - b = 0.60 - 1.10 - 0.35 = -0.50 - 0.35 = -0.85\n$$\n现在，将这些值代入推导出的 $E_{\\mathrm{app}}(T)$ 表达式中：\n$$\nE_{\\mathrm{app}}(1450 \\, \\mathrm{K}) = (1.60 \\times 10^{5}) + (-0.85) \\times (8.314) \\times (1450)\n$$\n计算第二项：\n$$\n(n - a - b) R T = (-0.85) \\times (8.314 \\ \\mathrm{J/(mol \\cdot K)}) \\times (1450 \\ \\mathrm{K}) = -10247.005 \\ \\mathrm{J/mol}\n$$\n现在，将各项相加求得表观活化能：\n$$\nE_{\\mathrm{app}}(1450 \\, \\mathrm{K}) = 160000 \\ \\mathrm{J/mol} - 10247.005 \\ \\mathrm{J/mol} = 149752.995 \\ \\mathrm{J/mol}\n$$\n问题要求最终答案以 $\\mathrm{kJ/mol}$ 为单位，并四舍五入到四位有效数字。\n$$\nE_{\\mathrm{app}} = 149752.995 \\ \\mathrm{J/mol} \\times \\frac{1 \\ \\mathrm{kJ}}{1000 \\ \\mathrm{J}} = 149.752995 \\ \\mathrm{kJ/mol}\n$$\n将该值四舍五入到四位有效数字，得到：\n$$\nE_{\\mathrm{app}} \\approx 149.8 \\ \\mathrm{kJ/mol}\n$$",
            "answer": "$$\\boxed{149.8}$$"
        },
        {
            "introduction": "本练习从单步模型扩展到用于模拟解离过程的半经验机理，这是高温动力学研究的基石。您将应用稳态近似（Steady State Approximation, SSA）和三体碰撞效率的概念，推导出一个有效的、依赖于压力的速率系数。此过程揭示了简化模型如何捕捉复杂的压力“衰减”（fall-off）行为，这是连接基元反应与宏观动力学的重要环节。",
            "id": "4028526",
            "problem": "分子氧的化学活化单分子解离在一个半经验全局动力学框架中通过带有第三体碰撞物的活化-失活机理来表示，该机理适用于压力衰减分析。考虑以下反应\n$$\\text{O}_{2} + \\text{M} \\xrightleftharpoons[k_{-1}(T)]{k_{1}(T)} \\text{O}_{2}^{*} + \\text{M}, \\quad \\text{O}_{2}^{*} \\xrightarrow{k_{2}(T)} 2\\,\\text{O},$$\n其中 $\\text{M}$ 表示从气体混合物中抽取的通用碰撞物，$\\text{O}_{2}^{*}$ 是一个激发态中间体。温度为 $T = 2000\\,\\text{K}$，总压力为 $P = 10\\,\\text{atm}$。混合物的摩尔分数为 $x_{\\text{N}_{2}} = 0.70$，$x_{\\text{O}_{2}} = 0.20$，$x_{\\text{CO}_{2}} = 0.05$ 和 $x_{\\text{H}_{2}\\text{O}} = 0.05$。第三体碰撞效率为 $\\alpha_{\\text{N}_{2}} = 1.0$，$\\alpha_{\\text{O}_{2}} = 1.2$，$\\alpha_{\\text{CO}_{2}} = 2.0$ 和 $\\alpha_{\\text{H}_{2}\\text{O}} = 6.0$。\n\n假设理想气体行为。使用理想气体定律和质量作用定律作为基本依据，并对中间体 $\\text{O}_{2}^{*}$ 使用稳态近似（SSA）（将SSA定义为中间体浓度的净变化率与其生成和消耗速率相比可以忽略不计的近似）。碰撞伙伴浓度将采用混合物平均的第三体近似处理，即有效碰撞物浓度为\n$$[\\text{M}]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [i],$$\n其中 $[i]$ 是物种 $i$ 的摩尔浓度，求和遍历 $\\text{N}_{2}$、$\\text{O}_{2}$、$\\text{CO}_{2}$ 和 $\\text{H}_{2}\\text{O}$。\n\n随温度变化的速率常数遵循阿伦尼乌斯形式，\n$$k_{1}(T) = A_{1} T^{n_{1}} \\exp\\!\\left(-\\frac{E_{1}}{R T}\\right), \\quad k_{-1}(T) = A_{-1} T^{n_{-1}} \\exp\\!\\left(-\\frac{E_{-1}}{R T}\\right), \\quad k_{2}(T) = A_{2} T^{n_{2}} \\exp\\!\\left(-\\frac{E_{2}}{R T}\\right),$$\n参数为 $A_{1} = 1.0 \\times 10^{-1}\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$，$n_{1} = 0$，$E_{1} = 5.0 \\times 10^{3}\\,\\text{J}\\,\\text{mol}^{-1}$；$A_{-1} = 1.0\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$，$n_{-1} = 0$，$E_{-1} = 0$；$A_{2} = 1.0 \\times 10^{13}\\,\\text{s}^{-1}$，$n_{2} = 0$，$E_{2} = 2.40 \\times 10^{5}\\,\\text{J}\\,\\text{mol}^{-1}$。使用 $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ 和 $1\\,\\text{atm} = 1.01325 \\times 10^{5}\\,\\text{Pa}$。\n\n仅从这些定义和所述基本定律出发，推导在稳态近似和第三体混合物平均条件下 $\\text{O}_{2}$ 解离的有效一级速率系数 $k_{\\text{eff}}(T,P,\\{x_{i},\\alpha_{i}\\})$，然后针对给定状态进行数值计算。将最终数值结果四舍五入至四位有效数字。以 $\\text{s}^{-1}$ 为单位表示最终答案。",
            "solution": "### 解题推导\n\n总解离反应为 $\\text{O}_{2} \\rightarrow 2\\,\\text{O}$。该反应的速率定义为 $\\text{O}_2$ 的净消耗速率，可以用有效一级速率系数 $k_{\\text{eff}}$ 表示为：\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{\\text{eff}}[\\text{O}_{2}]$$\n我们的目标是推导 $k_{\\text{eff}}$ 的表达式并对其进行求值。\n\n首先，我们根据给定的基元反应写出中间体物种 $\\text{O}_{2}^{*}$ 的速率定律：\n$$\\frac{d[\\text{O}_{2}^{*}]}{dt} = \\text{(生成速率)} - \\text{(消耗速率)}$$\n$$\\frac{d[\\text{O}_{2}^{*}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}} - k_{2}(T)[\\text{O}_{2}^{*}]$$\n\n我们对激发态中间体 $\\text{O}_{2}^{*}$ 应用稳态近似（SSA），即假设其浓度很小且随时间的变化可以忽略不计。因此，我们将其净生成速率设为零：\n$$\\frac{d[\\text{O}_{2}^{*}]}{dt} \\approx 0$$\n$$k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}} - k_{2}(T)[\\text{O}_{2}^{*}] = 0$$\n\n现在，我们求解中间体的稳态浓度 $[\\text{O}_{2}^{*}]_{\\text{ss}}$：\n$$k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} = [\\text{O}_{2}^{*}]_{\\text{ss}} \\left( k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T) \\right)$$\n$$[\\text{O}_{2}^{*}]_{\\text{ss}} = \\frac{k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)}$$\n\n反应物 $\\text{O}_{2}$ 的净消耗速率由下式给出：\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}}$$\n将 $[\\text{O}_{2}^{*}]_{\\text{ss}}$ 的稳态近似表达式代入此方程：\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)\\left(\\frac{k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)}\\right)[\\text{M}]_{\\text{eff}}$$\n提取公因式 $k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}}$：\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} \\left( 1 - \\frac{k_{-1}(T)[\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)} \\right)$$\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} \\left( \\frac{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T) - k_{-1}(T)[\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)} \\right)$$\n$$-\\frac{d[\\text{O}_{2}]}{dt} = \\left( \\frac{k_{1}(T) k_{2}(T) [\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)} \\right) [\\text{O}_{2}]$$\n\n将此结果与定义式 $-\\frac{d[\\text{O}_{2}]}{dt} = k_{\\text{eff}}[\\text{O}_{2}]$ 进行比较，我们确定了有效一级速率系数的表达式：\n$$k_{\\text{eff}}(T, P, \\{x_{i}, \\alpha_{i}\\}) = \\frac{k_{1}(T) k_{2}(T) [\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)}$$\n\n接下来，我们对该表达式进行数值计算。\n\n1.  **计算混合物的总摩尔浓度。**\n    根据理想气体定律 $P V = n R T$，总摩尔浓度 $[Tot] = \\frac{n}{V}$ 由下式给出：\n    $$[Tot] = \\frac{P}{R T}$$\n    以国际单位制表示的压力为 $P = 10\\,\\text{atm} \\times (1.01325 \\times 10^{5}\\,\\text{Pa}\\,\\text{atm}^{-1}) = 1.01325 \\times 10^{6}\\,\\text{Pa}$。\n    $$[Tot] = \\frac{1.01325 \\times 10^{6}\\,\\text{Pa}}{(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2000\\,\\text{K})} \\approx 60.9323\\,\\text{mol}\\,\\text{m}^{-3}$$\n\n2.  **计算有效碰撞物浓度 $[\\text{M}]_{\\text{eff}}$。**\n    该浓度计算为各物种浓度的加权和：\n    $$[\\text{M}]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [i] = \\sum_{i} \\alpha_{i} x_{i} [Tot] = [Tot] \\left( \\sum_{i} \\alpha_{i} x_{i} \\right)$$\n    混合物平均的碰撞效率因子为：\n    $$\\sum_{i} \\alpha_{i} x_{i} = \\alpha_{\\text{N}_{2}}x_{\\text{N}_{2}} + \\alpha_{\\text{O}_{2}}x_{\\text{O}_{2}} + \\alpha_{\\text{CO}_{2}}x_{\\text{CO}_{2}} + \\alpha_{\\text{H}_{2}\\text{O}}x_{\\text{H}_{2}\\text{O}}$$\n    $$\\sum_{i} \\alpha_{i} x_{i} = (1.0)(0.70) + (1.2)(0.20) + (2.0)(0.05) + (6.0)(0.05) = 0.70 + 0.24 + 0.10 + 0.30 = 1.34$$\n    $$[\\text{M}]_{\\text{eff}} = (60.9323\\,\\text{mol}\\,\\text{m}^{-3}) \\times 1.34 \\approx 81.6493\\,\\text{mol}\\,\\text{m}^{-3}$$\n\n3.  **计算 $T = 2000\\,\\text{K}$ 时随温度变化的速率常数。**\n    对于所有三个反应，指前温度指数 $n$ 均为 0。阿伦尼乌斯形式简化为 $k(T) = A \\exp(-E/RT)$。\n    $RT$ 项为 $(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2000\\,\\text{K}) = 16628.925\\,\\text{J}\\,\\text{mol}^{-1}$。\n    -   $k_{1}(2000) = (1.0 \\times 10^{-1}) \\exp\\left(-\\frac{5.0 \\times 10^{3}}{16628.925}\\right) \\approx 0.0740316\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$\n    -   $k_{-1}(2000) = (1.0) \\exp\\left(-\\frac{0}{16628.925}\\right) = 1.0\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$\n    -   $k_{2}(2000) = (1.0 \\times 10^{13}) \\exp\\left(-\\frac{2.40 \\times 10^{5}}{16628.925}\\right) \\approx 5.39570 \\times 10^{6}\\,\\text{s}^{-1}$\n\n4.  **计算有效速率系数 $k_{\\text{eff}}$。**\n    我们将数值代入推导出的表达式。我们来检查一下单位：\n    $$k_{\\text{eff}} = \\frac{(\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1})(\\text{s}^{-1})(\\text{mol}\\,\\text{m}^{-3})}{(\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1})(\\text{mol}\\,\\text{m}^{-3}) + (\\text{s}^{-1})} = \\frac{\\text{s}^{-2}}{\\text{s}^{-1}} = \\text{s}^{-1}$$\n    单位是正确的。\n    $$k_{\\text{eff}} = \\frac{(0.0740316) (5.39570 \\times 10^{6}) (81.6493)}{(1.0)(81.6493) + (5.39570 \\times 10^{6})}$$\n    分子：\n    $$k_{1} k_{2} [\\text{M}]_{\\text{eff}} \\approx (0.0740316) (5.39570 \\times 10^{6}) (81.6493) \\approx 3.26131 \\times 10^{7}\\,\\text{s}^{-2}$$\n    分母：\n    $$k_{-1}[\\text{M}]_{\\text{eff}} + k_{2} \\approx (1.0)(81.6493) + (5.39570 \\times 10^{6}) \\approx 5.39578 \\times 10^{6}\\,\\text{s}^{-1}$$\n    $$k_{\\text{eff}} \\approx \\frac{3.26131 \\times 10^{7}}{5.39578 \\times 10^{6}} \\approx 6.04414\\,\\text{s}^{-1}$$\n\n将结果四舍五入至四位有效数字得到 $6.044$。",
            "answer": "$$\\boxed{6.044}$$"
        },
        {
            "introduction": "这项高级计算实践直接应对了在使用全局机理模拟燃烧系统时固有的数值挑战。您将通过实施算子分裂法（operator splitting method）来处理由化学反应和混合时间尺度的巨大差异所导致的数值刚度问题。掌握这种方法对于开发稳健的计算流体动力学（CFD）和反应器模型是一项至关重要的技能。",
            "id": "4028518",
            "problem": "考虑一个空间均匀、恒压、理想搅拌反应器（Perfectly Stirred Reactor, PSR）模型，其中单个全局半经验反应代表碳氢化合物的氧化过程。设状态向量为 $\\mathbf{y} = [Y_F, Y_O, T]^{\\top}$，其中 $Y_F$ 是燃料质量分数，$Y_O$ 是氧化剂质量分数，$T$ 是温度（单位：开尔文）。假设理想气体行为，混合物热容 $c_p$ 为常数，且单步全局反应速率遵循阿伦尼乌斯动力学。全局反应速率定义为\n$$\n\\Omega(Y_F, Y_O, T) = A \\, Y_F^{a} \\, Y_O^{b} \\, \\exp\\!\\left(-\\frac{E}{R_u \\, T}\\right),\n$$\n其中 $A$ 是指前因子，$a$ 和 $b$ 分别是关于 $Y_F$ 和 $Y_O$ 的全局反应级数，$E$ 是活化能，$R_u$ 是通用气体常数。令 $s$ 表示氧化剂与燃料的化学计量质量比。化学源项由下式给出\n$$\n\\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{R}} = -\\Omega,\\quad\n\\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{R}} = - s \\, \\Omega,\\quad\n\\left.\\frac{dT}{dt}\\right|_{\\mathrm{R}} = \\frac{\\Delta h}{c_p} \\, \\Omega,\n$$\n其中 $\\Delta h$ 是单位质量燃料消耗释放的比热。与组分和温度为 $(Y_{F,\\mathrm{in}}, Y_{O,\\mathrm{in}}, T_{\\mathrm{in}})$ 的进料流的混合被建模为具有混合时间尺度 $\\tau$ 的线性松弛过程：\n$$\n\\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{F,\\mathrm{in}} - Y_F}{\\tau},\\quad\n\\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{O,\\mathrm{in}} - Y_O}{\\tau},\\quad\n\\left.\\frac{dT}{dt}\\right|_{\\mathrm{M}} = \\frac{T_{\\mathrm{in}} - T}{\\tau}.\n$$\n因此，完整的耦合常微分方程（ODE）系统为\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}) = \\mathbf{M}(\\mathbf{y}) + \\mathbf{R}(\\mathbf{y}),\n$$\n其中 $\\mathbf{M}$ 和 $\\mathbf{R}$ 由上述混合和反应的贡献定义。\n\n您的任务如下。\n\n1) 从均匀控制质量的物种和能量守恒以及上述半经验阿伦尼乌斯形式出发，解释为何当 $E/(R_u T)$ 较大时系统是数值刚性的，并推导线性混合算子在有限时间步长上的精确流映射。特别是，推导混合子问题在长度为 $\\Delta t$ 的时间间隔内的解析解：\n$$\nY_F(t+\\Delta t) = Y_{F,\\mathrm{in}} + \\left(Y_F(t) - Y_{F,\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right),\n$$\n$Y_O$ 和 $T$ 也有类似的表达式。\n\n2) 使用以下在每个大小为 $\\Delta t$ 的时间步长上的组合，为完整系统设计一个二阶 Strang 分裂时间积分器：\n$$\n\\Phi_{\\Delta t}^{\\mathrm{Strang}} \\equiv \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right) \\circ \\exp\\!\\left(\\Delta t \\,\\mathcal{R}\\right) \\circ \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right),\n$$\n其中 $\\mathcal{M}$ 和 $\\mathcal{R}$ 分别表示混合和反应子问题的生成元，$\\exp(\\cdot)$ 表示相关的流映射。通过使用刚性求解器数值积分纯反应 ODE 来实现 $\\exp\\!\\left(\\Delta t\\,\\mathcal{R}\\right)$，并使用您在第 1 部分中推导的精确解来实现 $\\exp\\!\\left(\\Delta t\\,\\mathcal{M}\\right)$。\n\n3) 通过使用刚性 ODE 求解器在相同的时间范围内直接对耦合 ODE 系统（混合加反应）进行积分，实现一个参考解。\n\n4) 对于下述每个测试用例，计算 Strang 分裂解与参考解在最终时刻的最大分量相对误差：\n$$\n\\varepsilon_{\\max} = \\max_{q \\in \\{Y_F, Y_O, T\\}} \\frac{\\left| q_{\\mathrm{split}}(t_{\\mathrm{end}}) - q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|}{\\max\\!\\left(\\left| q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|,\\, \\epsilon\\right)},\n$$\n其中 $\\epsilon = 10^{-12}$ 是一个小的正则化常数，以避免除以零。为每个案例报告 $\\varepsilon_{\\max}$ 作为一个浮点数。\n\n对所有案例使用以下常数：\n- 通用气体常数 $R_u = 8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 热容 $c_p = 1000 \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。\n- 单位燃料质量热释放 $\\Delta h = 5.0 \\times 10^{7} \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$。\n- 化学计量氧化剂燃料质量比 $s = 4.0$。\n- 全局反应级数 $a = 1.0$, $b = 1.0$。\n\n对于每个案例，参数元组为\n$$\n\\left(A,\\ E,\\ \\tau,\\ \\Delta t,\\ t_{\\mathrm{end}},\\ Y_{F,0},\\ Y_{O,0},\\ T_0,\\ Y_{F,\\mathrm{in}},\\ Y_{O,\\mathrm{in}},\\ T_{\\mathrm{in}}\\right).\n$$\n\n提供一个单一程序，对以下测试套件进行计算：\n\n- 案例 1（顺利路径，混合状态与初始状态相同）：\n  $$\n  \\left(1.0\\times 10^{6},\\ 1.0\\times 10^{5},\\ 2.0\\times 10^{-2},\\ 1.0\\times 10^{-4},\\ 1.0\\times 10^{-2},\\ 2.0\\times 10^{-2},\\ 2.0\\times 10^{-1},\\ 1.0\\times 10^{3},\\ 2.0\\times 10^{-2},\\ 2.0\\times 10^{-1},\\ 1.0\\times 10^{3}\\right).\n  $$\n\n- 案例 2（混合与反应时间尺度竞争）：\n  $$\n  \\left(2.0\\times 10^{6},\\ 1.1\\times 10^{5},\\ 1.0\\times 10^{-2},\\ 5.0\\times 10^{-4},\\ 2.0\\times 10^{-2},\\ 3.0\\times 10^{-2},\\ 1.0\\times 10^{-1},\\ 9.0\\times 10^{2},\\ 0.0,\\ 2.3\\times 10^{-1},\\ 9.0\\times 10^{2}\\right).\n  $$\n\n- 案例 3（贫氧，反应受限）：\n  $$\n  \\left(5.0\\times 10^{6},\\ 1.2\\times 10^{5},\\ 5.0\\times 10^{-2},\\ 2.0\\times 10^{-4},\\ 1.0\\times 10^{-2},\\ 2.0\\times 10^{-2},\\ 1.0\\times 10^{-2},\\ 1.2\\times 10^{3},\\ 0.0,\\ 5.0\\times 10^{-2},\\ 1.2\\times 10^{3}\\right).\n  $$\n\n- 案例 4（单个大时间步长等于总时长）：\n  $$\n  \\left(5.0\\times 10^{5},\\ 1.0\\times 10^{5},\\ 2.0\\times 10^{-2},\\ 5.0\\times 10^{-3},\\ 5.0\\times 10^{-3},\\ 1.5\\times 10^{-2},\\ 2.1\\times 10^{-1},\\ 1.1\\times 10^{3},\\ 1.0\\times 10^{-2},\\ 2.1\\times 10^{-1},\\ 1.1\\times 10^{3}\\right).\n  $$\n\n- 案例 5（极小时间步长以测试分裂法的收敛性）：\n  $$\n  \\left(2.0\\times 10^{6},\\ 1.1\\times 10^{5},\\ 1.0\\times 10^{-2},\\ 5.0\\times 10^{-6},\\ 2.0\\times 10^{-2},\\ 3.0\\times 10^{-2},\\ 1.0\\times 10^{-1},\\ 9.0\\times 10^{2},\\ 0.0,\\ 2.3\\times 10^{-1},\\ 9.0\\times 10^{2}\\right).\n  $$\n\n所有物理单位必须如上所述，时间单位为秒，温度单位为开尔文。程序必须：\n\n- 分别为纯反应系统和完全耦合系统实现 Strang 分裂积分器和使用刚性 ODE 求解器的参考积分器。\n- 对于每个案例，输出一个等于上述定义的 $\\varepsilon_{\\max}$ 的浮点值。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4,r5]”），其中每个 $r_i$ 是为第 $i$ 个案例计算出的 $\\varepsilon_{\\max}$，表示为十进制数。",
            "solution": "### 第一部分：系统刚性与混合问题的解析解\n\n#### 数值刚性\nODE 系统 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y})$ 的数值刚性源于系统动力学特征时间尺度的巨大差异。这在数学上通过雅可比矩阵 $\\mathbf{J} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{y}}$ 的特征值来表征。如果特征值 $\\lambda_i$ 具有负实部，并且比率 $\\max_i |\\mathrm{Re}(\\lambda_i)| / \\min_i |\\mathrm{Re}(\\lambda_i)|$ 非常大，则系统是刚性的。\n\n在给定的问题中，刚性主要源于化学反应项 $\\mathbf{R}(\\mathbf{y})$，特别是反应速率 $\\Omega$ 对温度 $T$ 的高度敏感性。反应子问题的雅可比矩阵 $\\mathbf{J}_{\\mathcal{R}} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{y}}$ 包含与 $\\Omega$ 的导数成比例的项。驱动刚性的最重要项是关于温度的导数：\n$$\n\\frac{\\partial \\Omega}{\\partial T} = A \\, Y_F^{a} \\, Y_O^{b} \\, \\exp\\!\\left(-\\frac{E}{R_u \\, T}\\right) \\left(\\frac{E}{R_u T^2}\\right) = \\Omega \\cdot \\frac{E}{R_u T^2}\n$$\n无量纲量 $\\beta = \\frac{E}{R_u T}$ 是 Zeldovich 数，代表反应的温度敏感性。对于典型的燃烧场景，$E$ 很大，使得 $\\beta \\gg 1$。$\\mathbf{J}_{\\mathcal{R}}$ 的特征值与此导数有关。例如，反应提高温度，而温度又指数级增加反应速率的反馈回路，导致一个非常快的动态模式（一个绝对值很大的负特征值）。这标志着一个非常短的反应时间尺度，通常比混合时间尺度 $\\tau$ 或实际积分时间步长 $\\Delta t$ 小几个数量级。除非时间步长小到令人望而却步，否则显式数值方法对于此类系统是不稳定的，因此必须使用隐式或“刚性”求解器。\n\n#### 混合流映射的推导\n混合子问题由一组非耦合的线性一阶 ODE 描述。令 $q(t)$ 代表任何一个状态变量（$Y_F(t)$, $Y_O(t)$, 或 $T(t)$），$q_{\\mathrm{in}}$ 为其对应的入口值。控制方程为：\n$$\n\\frac{dq}{dt} = \\frac{q_{\\mathrm{in}} - q}{\\tau}\n$$\n这是一个线性非齐次 ODE。它可以通过变量分离法求解。令 $u(t) = q(t) - q_{\\mathrm{in}}$。则 $\\frac{du}{dt} = \\frac{dq}{dt}$，方程变换为：\n$$\n\\frac{du}{dt} = -\\frac{u}{\\tau}\n$$\n分离变量得到：\n$$\n\\frac{1}{u} du = -\\frac{1}{\\tau} dt\n$$\n我们将此方程从时间 $t$ 积分到 $t+\\Delta t$，其中状态从 $u(t)$ 变为 $u(t+\\Delta t)$：\n$$\n\\int_{u(t)}^{u(t+\\Delta t)} \\frac{1}{u'} du' = \\int_{t}^{t+\\Delta t} -\\frac{1}{\\tau} dt'\n$$\n$$\n\\left[ \\ln|u'| \\right]_{u(t)}^{u(t+\\Delta t)} = -\\frac{1}{\\tau} \\left[ t' \\right]_{t}^{t+\\Delta t}\n$$\n$$\n\\ln|u(t+\\Delta t)| - \\ln|u(t)| = -\\frac{\\Delta t}{\\tau}\n$$\n$$\n\\ln \\left| \\frac{u(t+\\Delta t)}{u(t)} \\right| = -\\frac{\\Delta t}{\\tau}\n$$\n对两边取指数：\n$$\n\\frac{u(t+\\Delta t)}{u(t)} = \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\n$$\nu(t+\\Delta t) = u(t) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\n代回 $u(t) = q(t) - q_{\\mathrm{in}}$：\n$$\nq(t+\\Delta t) - q_{\\mathrm{in}} = \\left(q(t) - q_{\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\n整理得到 $q(t+\\Delta t)$ 的最终表达式，即混合算子 $\\exp(\\Delta t \\mathcal{M})$ 的精确流映射：\n$$\nq(t+\\Delta t) = q_{\\mathrm{in}} + \\left(q(t) - q_{\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\n此解析解将用于在 Strang 分裂方案中实现 $\\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)$ 步骤。\n\n### 第二部分和第三部分：数值方案设计\n\n解决方案需要为同一个 ODE 系统实现两种不同的时间积分方案并比较它们的结果。\n\n#### 参考解\n参考解是通过从 $t=0$ 到 $t=t_{\\mathrm{end}}$ 直接积分完整的耦合 ODE 系统 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{R}(\\mathbf{y}) + \\mathbf{M}(\\mathbf{y})$ 来获得的。右侧函数 $\\mathbf{F}(\\mathbf{y})$ 为：\n$$\n\\mathbf{F}(\\mathbf{y}) = \\begin{bmatrix}\n-\\Omega(Y_F, Y_O, T) + (Y_{F,\\mathrm{in}} - Y_F)/\\tau \\\\\n-s\\,\\Omega(Y_F, Y_O, T) + (Y_{O,\\mathrm{in}} - Y_O)/\\tau \\\\\n\\frac{\\Delta h}{c_p}\\Omega(Y_F, Y_O, T) + (T_{\\mathrm{in}} - T)/\\tau\n\\end{bmatrix}\n$$\n鉴于系统的刚性，该积分必须使用刚性 ODE 求解器进行，例如在 `scipy.integrate.solve_ivp` 中可用的后向差分公式（BDF）方法。\n\n#### Strang 分裂解\nStrang 分裂法通过顺序求解混合和反应的子问题来逼近解。对于大小为 $\\Delta t$ 的单个时间步，状态 $\\mathbf{y}(t)$ 通过三个顺序操作推进到 $\\mathbf{y}(t+\\Delta t)$：\n1.  **第一个混合半步**：通过求解纯混合 ODE，将状态推进 $\\frac{\\Delta t}{2}$ 的时间步长。我们使用上面推导的解析解。设 $\\mathbf{y}^{(0)} = \\mathbf{y}(t)$。我们计算 $\\mathbf{y}^{(1)} = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)(\\mathbf{y}^{(0)})$。\n2.  **反应全步**：从 $\\mathbf{y}^{(1)}$ 开始，在整个时间步长 $\\Delta t$ 上积分纯反应 ODE $\\frac{d\\mathbf{y}}{dt} = \\mathbf{R}(\\mathbf{y})$。该子问题 $\\frac{d\\mathbf{y}}{dt} = [-\\Omega, -s\\Omega, \\frac{\\Delta h}{c_p}\\Omega]^\\top$ 是系统的刚性部分。它使用刚性求解器进行数值求解。结果是 $\\mathbf{y}^{(2)} = \\exp\\!\\left(\\Delta t \\,\\mathcal{R}\\right)(\\mathbf{y}^{(1)})$。\n3.  **第二个混合半步**：使用解析解，将状态 $\\mathbf{y}^{(2)}$ 再求解一个 $\\frac{\\Delta t}{2}$ 时间步长的纯混合 ODE。该步的最终状态是 $\\mathbf{y}(t+\\Delta t) = \\mathbf{y}^{(3)} = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)(\\mathbf{y}^{(2)})$。\n\n此序列重复执行总时间步数 $N = t_{\\mathrm{end}} / \\Delta t$ 次。该方法在 $\\Delta t$ 上是二阶精确的，意味着在固定的最终时间，全局误差与 $(\\Delta t)^2$ 成正比。\n\n### 第四部分：误差计算\n\n在计算出参考解 $\\mathbf{y}_{\\mathrm{ref}}(t_{\\mathrm{end}})$ 和 Strang 分裂解 $\\mathbf{y}_{\\mathrm{split}}(t_{\\mathrm{end}})$ 的最终状态向量后，根据提供的公式计算最大分量相对误差 $\\varepsilon_{\\max}$。这需要评估三个分量（$Y_F, Y_O, T$）中每一个的相对误差，并取最大值。小的正则化常数 $\\epsilon=10^{-12}$ 可防止当参考分量值为零时出现除以零的情况。实现将精确遵循此定义。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Meticulous and exacting professor's implementation of the PSR model integration.\n\ndef solve():\n    \"\"\"\n    Main driver function to execute the PSR model simulation for all test cases.\n    It implements a reference integrator and a Strang splitting integrator,\n    and computes the error between them for each case.\n    \"\"\"\n\n    # Global constants as specified in the problem statement.\n    CONSTS = {\n        'Ru': 8.314,       # J/mol/K\n        'cp': 1000.0,      # J/kg/K\n        'dh': 5.0e7,       # J/kg\n        's': 4.0,          # Stoichiometric oxidizer-to-fuel mass ratio\n        'a': 1.0,          # Fuel reaction order\n        'b': 1.0,          # Oxidizer reaction order\n    }\n    ERROR_REG = 1e-12\n\n    # Test cases defined as tuples of parameters.\n    # (A, E, tau, dt, t_end, Y_F0, Y_O0, T0, Y_Fin, Y_Oin, Tin)\n    test_cases = [\n        # Case 1 (happy path, mixing equal to the initial state)\n        (1.0e6, 1.0e5, 2.0e-2, 1.0e-4, 1.0e-2, 2.0e-2, 2.0e-1, 1.0e3, 2.0e-2, 2.0e-1, 1.0e3),\n        # Case 2 (competing mixing and reaction time scales)\n        (2.0e6, 1.1e5, 1.0e-2, 5.0e-4, 2.0e-2, 3.0e-2, 1.0e-1, 9.0e2, 0.0, 2.3e-1, 9.0e2),\n        # Case 3 (oxidizer-lean, reaction limited)\n        (5.0e6, 1.2e5, 5.0e-2, 2.0e-4, 1.0e-2, 2.0e-2, 1.0e-2, 1.2e3, 0.0, 5.0e-2, 1.2e3),\n        # Case 4 (single large time step equal to the horizon)\n        (5.0e5, 1.0e5, 2.0e-2, 5.0e-3, 5.0e-3, 1.5e-2, 2.1e-1, 1.1e3, 1.0e-2, 2.1e-1, 1.1e3),\n        # Case 5 (very small time step to test convergence of splitting)\n        (2.0e6, 1.1e5, 1.0e-2, 5.0e-6, 2.0e-2, 3.0e-2, 1.0e-1, 9.0e2, 0.0, 2.3e-1, 9.0e2),\n    ]\n\n    results = []\n\n    def Omega_rate(Y_F, Y_O, T, A, E, Ru, a, b):\n        \"\"\"Computes the global reaction rate Omega.\"\"\"\n        # Ensure mass fractions are non-negative for physical and numerical stability.\n        Y_F_clip = max(0.0, Y_F)\n        Y_O_clip = max(0.0, Y_O)\n        if T = 0:\n            return 0.0\n        return A * (Y_F_clip**a) * (Y_O_clip**b) * np.exp(-E / (Ru * T))\n\n    def reaction_rhs(t, y, params):\n        \"\"\"RHS function for the reaction-only ODE system.\"\"\"\n        Y_F, Y_O, T = y\n        consts = params['consts']\n        # Negative mass fractions can arise during integration steps. Clip at zero.\n        if Y_F  0 or Y_O  0:\n            omega = 0.0\n        else:\n            omega = Omega_rate(Y_F, Y_O, T, params['A'], params['E'], consts['Ru'], consts['a'], consts['b'])\n        \n        dYF_dt = -omega\n        dYO_dt = -consts['s'] * omega\n        dT_dt = (consts['dh'] / consts['cp']) * omega\n        return np.array([dYF_dt, dYO_dt, dT_dt])\n\n    def coupled_rhs(t, y, params):\n        \"\"\"RHS function for the coupled (mixing + reaction) ODE system.\"\"\"\n        Y_F, Y_O, T = y\n        \n        # Reaction part\n        reaction_vector = reaction_rhs(t, y, params)\n        \n        # Mixing part\n        y_in = params['y_in']\n        tau = params['tau']\n        dYF_dt_mix = (y_in[0] - Y_F) / tau\n        dYO_dt_mix = (y_in[1] - Y_O) / tau\n        dT_dt_mix = (y_in[2] - T) / tau\n        mixing_vector = np.array([dYF_dt_mix, dYO_dt_mix, dT_dt_mix])\n        \n        return reaction_vector + mixing_vector\n\n    def analytical_mix_step(y, y_in, dt, tau):\n        \"\"\"Applies the analytical solution for the mixing-only step.\"\"\"\n        y_out = y_in + (y - y_in) * np.exp(-dt / tau)\n        return y_out\n\n    for case_params in test_cases:\n        A, E, tau, dt, t_end, Y_F0, Y_O0, T0, Y_Fin, Y_Oin, Tin = case_params\n        \n        y0 = np.array([Y_F0, Y_O0, T0])\n        y_in = np.array([Y_Fin, Y_Oin, Tin])\n        \n        params = {'A': A, 'E': E, 'tau': tau, 'y_in': y_in, 'consts': CONSTS}\n        \n        # --- 3) Reference Solution ---\n        # Integrate the full coupled system directly with a stiff solver.\n        t_span_ref = [0, t_end]\n        sol_ref = solve_ivp(\n            fun=coupled_rhs,\n            t_span=t_span_ref,\n            y0=y0,\n            method='BDF',\n            args=(params,),\n            dense_output=True,\n            rtol=1e-9,\n            atol=1e-12\n        )\n        y_ref_final = sol_ref.sol(t_end)\n\n        # --- 2) Strang Splitting Solution ---\n        y_split = np.copy(y0)\n        num_steps = int(round(t_end / dt))\n        \n        # If t_end is effectively zero, skip integration.\n        if num_steps > 0:\n            for _ in range(num_steps):\n                # First half-step of mixing\n                y_split = analytical_mix_step(y_split, y_in, dt / 2.0, tau)\n                \n                # Full step of reaction (numerically integrated)\n                t_span_react = [0, dt]\n                sol_react = solve_ivp(\n                    fun=reaction_rhs,\n                    t_span=t_span_react,\n                    y0=y_split,\n                    method='BDF',\n                    args=(params,),\n                    rtol=1e-9,\n                    atol=1e-12\n                )\n                y_split = sol_react.y[:, -1]\n                \n                # Second half-step of mixing\n                y_split = analytical_mix_step(y_split, y_in, dt / 2.0, tau)\n        \n        y_split_final = y_split\n\n        # --- 4) Error Calculation ---\n        diff = np.abs(y_split_final - y_ref_final)\n        denominator = np.maximum(np.abs(y_ref_final), ERROR_REG)\n        relative_errors = diff / denominator\n        max_rel_error = np.max(relative_errors)\n        \n        results.append(max_rel_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}