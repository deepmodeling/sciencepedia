{
    "hands_on_practices": [
        {
            "introduction": "Global reaction models are powerful tools, but their parameters can be subtle. This exercise explores the distinction between the intrinsic activation energy, $E_a$, in the Arrhenius expression and the *apparent* activation energy, $E_{\\mathrm{app}}$, that would be measured experimentally at constant pressure. By deriving the relationship between them, you will develop a deeper understanding of how the functional form of a global rate law, including temperature-dependent concentrations, influences the overall temperature sensitivity of the reaction .",
            "id": "4028516",
            "problem": "A single-step global oxidation model for a gaseous fuel uses the empirical rate law $r = k \\, C_{F}^{a} \\, C_{O_{2}}^{b}$, where $r$ is the volumetric rate of consumption of the fuel, $C_{F}$ and $C_{O_{2}}$ are the molar concentrations of fuel and oxygen, and $a$ and $b$ are global reaction orders. The temperature dependence of the rate coefficient is described by a modified Arrhenius form $k = A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)$, where $A$ is a pre-exponential parameter, $n$ is a temperature exponent, $E_{a}$ is the activation energy, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nConsider a well-stirred environment at constant total pressure $p$ with fixed reactant mole fractions $X_{F}$ and $X_{O_{2}}$ (low conversion), so that the molar concentrations obey the ideal-gas relation $C_{i} = \\frac{X_{i} \\, p}{R T}$ for each species $i$. Define the apparent activation energy at constant pressure and fixed composition as\n$$\nE_{\\mathrm{app}}(T) \\equiv - R \\, \\frac{d \\ln r}{d \\!\\left(1/T\\right)} \\, .\n$$\nStarting from the stated empirical rate law, the modified Arrhenius temperature dependence, and the ideal-gas relation for concentrations, derive an analytic expression for $E_{\\mathrm{app}}(T)$ in terms of $E_{a}$, $R$, $T$, $n$, $a$, and $b$. Then, for parameters $E_{a} = 1.60 \\times 10^{5} \\ \\mathrm{J/mol}$, $n = 0.60$, $a = 1.10$, $b = 0.35$, and $R = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$, evaluate $E_{\\mathrm{app}}$ at $T = 1450 \\ \\mathrm{K}$. Round your final numerical answer to four significant figures. Express the final energy in $\\mathrm{kJ/mol}$.",
            "solution": "The problem requires the derivation of an expression for the apparent activation energy, $E_{\\mathrm{app}}(T)$, for a global reaction mechanism under specific conditions, followed by a numerical evaluation.\n\nThe analysis begins with the provided empirical rate law for the fuel consumption rate, $r$:\n$$\nr = k \\, C_{F}^{a} \\, C_{O_{2}}^{b}\n$$\nThe rate coefficient, $k$, follows a modified Arrhenius temperature dependence:\n$$\nk = A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nThe molar concentrations of the fuel ($C_F$) and oxygen ($C_{O_2}$) are given by the ideal-gas law under conditions of constant total pressure $p$ and fixed mole fractions $X_F$ and $X_{O_2}$:\n$$\nC_{F} = \\frac{X_{F} \\, p}{R T} \\quad \\text{and} \\quad C_{O_{2}} = \\frac{X_{O_{2}} \\, p}{R T}\n$$\nFirst, we construct the full expression for the reaction rate $r$ by substituting the expressions for $k$, $C_F$, and $C_{O_2}$:\n$$\nr = \\left[ A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right) \\right] \\left( \\frac{X_{F} \\, p}{R T} \\right)^{a} \\left( \\frac{X_{O_{2}} \\, p}{R T} \\right)^{b}\n$$\nWe can group the terms that are dependent on temperature $T$ and those that are constant under the given conditions ($A$, $X_F$, $X_{O_2}$, $p$, $R$, $a$, $b$, $n$).\n$$\nr = A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b} \\cdot T^{n} \\left( \\frac{1}{T} \\right)^{a} \\left( \\frac{1}{T} \\right)^{b} \\cdot \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nCombining the powers of $T$:\n$$\nr = \\left[ A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b} \\right] T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nThe term in the square brackets is constant with respect to temperature. Let us denote it by a constant $K'$:\n$$\nK' = A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b}\n$$\nThe rate expression simplifies to:\n$$\nr = K' \\, T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nThe apparent activation energy is defined as:\n$$\nE_{\\mathrm{app}}(T) \\equiv - R \\, \\frac{d \\ln r}{d \\!\\left(1/T\\right)}\n$$\nTo evaluate this derivative, we first take the natural logarithm of the rate expression:\n$$\n\\ln r = \\ln \\left( K' \\, T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right) \\right)\n$$\n$$\n\\ln r = \\ln K' + \\ln(T^{n - a - b}) + \\ln\\left(\\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\\right)\n$$\n$$\n\\ln r = \\ln K' + (n - a - b) \\ln T - \\frac{E_{a}}{R T}\n$$\nNow we must differentiate $\\ln r$ with respect to $1/T$. We use the chain rule:\n$$\n\\frac{d(\\ln r)}{d(1/T)} = \\frac{d(\\ln r)}{dT} \\cdot \\frac{dT}{d(1/T)}\n$$\nFirst, we find the derivative of $\\ln r$ with respect to $T$:\n$$\n\\frac{d(\\ln r)}{dT} = \\frac{d}{dT} \\left( \\ln K' + (n - a - b) \\ln T - \\frac{E_{a}}{R} T^{-1} \\right)\n$$\nSince $\\ln K'$ is a constant, its derivative is zero.\n$$\n\\frac{d(\\ln r)}{dT} = (n - a - b) \\frac{1}{T} - \\frac{E_{a}}{R} (-1) T^{-2} = \\frac{n - a - b}{T} + \\frac{E_{a}}{R T^2}\n$$\nNext, we determine the derivative of $T$ with respect to $1/T$. Let $u = 1/T$, which implies $T = 1/u = u^{-1}$.\n$$\n\\frac{dT}{d(1/T)} = \\frac{dT}{du} = -1 \\cdot u^{-2} = -u^{-2} = -(1/T)^{-2} = -T^2\n$$\nNow we combine these results using the chain rule:\n$$\n\\frac{d(\\ln r)}{d(1/T)} = \\left( \\frac{n - a - b}{T} + \\frac{E_{a}}{R T^2} \\right) (-T^2)\n$$\n$$\n\\frac{d(\\ln r)}{d(1/T)} = - (n - a - b) T - \\frac{E_{a}}{R}\n$$\nFinally, we substitute this back into the definition of $E_{\\mathrm{app}}(T)$:\n$$\nE_{\\mathrm{app}}(T) = -R \\left[ - (n - a - b) T - \\frac{E_{a}}{R} \\right]\n$$\n$$\nE_{\\mathrm{app}}(T) = R (n - a - b) T + R \\frac{E_{a}}{R}\n$$\nThis yields the desired analytic expression for the apparent activation energy:\n$$\nE_{\\mathrm{app}}(T) = E_{a} + (n - a - b) R T\n$$\nThe next step is to evaluate this expression for the given parameters:\n$E_{a} = 1.60 \\times 10^{5} \\ \\mathrm{J/mol}$\n$n = 0.60$\n$a = 1.10$\n$b = 0.35$\n$R = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$\n$T = 1450 \\ \\mathrm{K}$\n\nFirst, we compute the exponent sum:\n$$\nn - a - b = 0.60 - 1.10 - 0.35 = -0.50 - 0.35 = -0.85\n$$\nNow, substitute the values into the derived expression for $E_{\\mathrm{app}}(T)$:\n$$\nE_{\\mathrm{app}}(1450 \\, \\mathrm{K}) = (1.60 \\times 10^{5}) + (-0.85) \\times (8.314) \\times (1450)\n$$\nCalculate the second term:\n$$\n(n - a - b) R T = (-0.85) \\times (8.314 \\ \\mathrm{J/(mol \\cdot K)}) \\times (1450 \\ \\mathrm{K}) = -10247.005 \\ \\mathrm{J/mol}\n$$\nNow, sum the terms to find the apparent activation energy:\n$$\nE_{\\mathrm{app}}(1450 \\, \\mathrm{K}) = 160000 \\ \\mathrm{J/mol} - 10247.005 \\ \\mathrm{J/mol} = 149752.995 \\ \\mathrm{J/mol}\n$$\nThe problem requires the final answer to be in units of $\\mathrm{kJ/mol}$ and rounded to four significant figures.\n$$\nE_{\\mathrm{app}} = 149752.995 \\ \\mathrm{J/mol} \\times \\frac{1 \\ \\mathrm{kJ}}{1000 \\ \\mathrm{J}} = 149.752995 \\ \\mathrm{kJ/mol}\n$$\nRounding this value to four significant figures gives:\n$$\nE_{\\mathrm{app}} \\approx 149.8 \\ \\mathrm{kJ/mol}\n$$",
            "answer": "$$\\boxed{149.8}$$"
        },
        {
            "introduction": "Semi-empirical mechanisms often model complex processes like dissociation using a sequence of simpler steps. This practice demonstrates how to derive an effective, pressure-dependent rate coefficient for a unimolecular reaction using the steady-state approximation and the concept of third-body collision efficiencies . Mastering this technique is essential for building models that accurately capture the \"fall-off\" behavior of reactions over a range of pressures, a critical aspect of practical combustion systems.",
            "id": "4028526",
            "problem": "A chemically activated unimolecular dissociation of molecular oxygen is represented in a semi-empirical global kinetic framework by the activation–deactivation mechanism with a third-body collider, suitable for falloff analysis. Consider the reactions\n$$\\text{O}_{2} + \\text{M} \\xrightleftharpoons[k_{-1}(T)]{k_{1}(T)} \\text{O}_{2}^{*} + \\text{M}, \\quad \\text{O}_{2}^{*} \\xrightarrow{k_{2}(T)} 2\\,\\text{O},$$\nwhere $\\text{M}$ denotes a generic collider drawn from the gas mixture, and $\\text{O}_{2}^{*}$ is an energized intermediate. The temperature is $T = 2000\\,\\text{K}$ and the total pressure is $P = 10\\,\\text{atm}$. The mixture mole fractions are $x_{\\text{N}_{2}} = 0.70$, $x_{\\text{O}_{2}} = 0.20$, $x_{\\text{CO}_{2}} = 0.05$, and $x_{\\text{H}_{2}\\text{O}} = 0.05$. The third-body collision efficiencies are $\\alpha_{\\text{N}_{2}} = 1.0$, $\\alpha_{\\text{O}_{2}} = 1.2$, $\\alpha_{\\text{CO}_{2}} = 2.0$, and $\\alpha_{\\text{H}_{2}\\text{O}} = 6.0$.\n\nAssume ideal-gas behavior. Use the Ideal Gas Law and the law of mass action as the fundamental base, and the Steady State Approximation (SSA) for the intermediate $\\text{O}_{2}^{*}$ (define SSA as the approximation that the net rate of change of intermediate concentration is negligible compared to its formation and consumption rates). The collision partner concentration is to be treated with the mixture-averaged third-body approximation, meaning an effective collider concentration\n$$[\\text{M}]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [i],$$\nwhere $[i]$ is the molar concentration of species $i$, and the sum runs over $\\text{N}_{2}$, $\\text{O}_{2}$, $\\text{CO}_{2}$, and $\\text{H}_{2}\\text{O}$.\n\nThe temperature-dependent rate constants follow Arrhenius forms,\n$$k_{1}(T) = A_{1} T^{n_{1}} \\exp\\!\\left(-\\frac{E_{1}}{R T}\\right), \\quad k_{-1}(T) = A_{-1} T^{n_{-1}} \\exp\\!\\left(-\\frac{E_{-1}}{R T}\\right), \\quad k_{2}(T) = A_{2} T^{n_{2}} \\exp\\!\\left(-\\frac{E_{2}}{R T}\\right),$$\nwith parameters $A_{1} = 1.0 \\times 10^{-1}\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$, $n_{1} = 0$, $E_{1} = 5.0 \\times 10^{3}\\,\\text{J}\\,\\text{mol}^{-1}$; $A_{-1} = 1.0\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$, $n_{-1} = 0$, $E_{-1} = 0$; $A_{2} = 1.0 \\times 10^{13}\\,\\text{s}^{-1}$, $n_{2} = 0$, $E_{2} = 2.40 \\times 10^{5}\\,\\text{J}\\,\\text{mol}^{-1}$. Use $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ and $1\\,\\text{atm} = 1.01325 \\times 10^{5}\\,\\text{Pa}$.\n\nStarting only from these definitions and the stated fundamental laws, derive the effective first-order rate coefficient $k_{\\text{eff}}(T,P,\\{x_{i},\\alpha_{i}\\})$ for $\\text{O}_{2}$ dissociation under SSA and third-body mixture averaging, and then evaluate it numerically for the given state. Round your final numerical value to four significant figures. Express the final answer in $\\text{s}^{-1}$.",
            "solution": "The overall dissociation reaction is $\\text{O}_{2} \\rightarrow 2\\,\\text{O}$. The rate of this reaction is defined as the net rate of consumption of $\\text{O}_2$, which can be expressed in terms of an effective first-order rate coefficient $k_{\\text{eff}}$ as:\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{\\text{eff}}[\\text{O}_{2}]$$\nOur goal is to derive an expression for $k_{\\text{eff}}$ and evaluate it.\n\nFirst, we write the rate law for the intermediate species $\\text{O}_{2}^{*}$ based on the given elementary reactions:\n$$\\frac{d[\\text{O}_{2}^{*}]}{dt} = \\text{(rate of formation)} - \\text{(rate of consumption)}$$\n$$\\frac{d[\\text{O}_{2}^{*}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}} - k_{2}(T)[\\text{O}_{2}^{*}]$$\n\nWe apply the Steady State Approximation (SSA) to the energized intermediate $\\text{O}_{2}^{*}$, which assumes that its concentration is small and changes negligibly over time. Thus, we set its net rate of formation to zero:\n$$\\frac{d[\\text{O}_{2}^{*}]}{dt} \\approx 0$$\n$$k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}} - k_{2}(T)[\\text{O}_{2}^{*}] = 0$$\n\nNow, we solve for the steady-state concentration of the intermediate, $[\\text{O}_{2}^{*}]_{\\text{ss}}$:\n$$k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} = [\\text{O}_{2}^{*}]_{\\text{ss}} \\left( k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T) \\right)$$\n$$[\\text{O}_{2}^{*}]_{\\text{ss}} = \\frac{k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)}$$\n\nThe net rate of consumption of the reactant $\\text{O}_{2}$ is given by:\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}}$$\nSubstituting the SSA expression for $[\\text{O}_{2}^{*}]_{\\text{ss}}$ into this equation:\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}(T)\\left(\\frac{k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)}\\right)[\\text{M}]_{\\text{eff}}$$\nFactor out the common term $k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}}$:\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} \\left( 1 - \\frac{k_{-1}(T)[\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)} \\right)$$\n$$-\\frac{d[\\text{O}_{2}]}{dt} = k_{1}(T)[\\text{O}_{2}][\\text{M}]_{\\text{eff}} \\left( \\frac{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T) - k_{-1}(T)[\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)} \\right)$$\n$$-\\frac{d[\\text{O}_{2}]}{dt} = \\left( \\frac{k_{1}(T) k_{2}(T) [\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)} \\right) [\\text{O}_{2}]$$\n\nBy comparing this result with the definition $-\\frac{d[\\text{O}_{2}]}{dt} = k_{\\text{eff}}[\\text{O}_{2}]$, we identify the expression for the effective first-order rate coefficient:\n$$k_{\\text{eff}}(T, P, \\{x_{i}, \\alpha_{i}\\}) = \\frac{k_{1}(T) k_{2}(T) [\\text{M}]_{\\text{eff}}}{k_{-1}(T)[\\text{M}]_{\\text{eff}} + k_{2}(T)}$$\n\nNext, we evaluate this expression numerically.\n\n1.  **Calculate the total molar concentration of the mixture.**\n    Using the Ideal Gas Law, $P V = n R T$, the total molar concentration $[Tot] = \\frac{n}{V}$ is given by:\n    $$[Tot] = \\frac{P}{R T}$$\n    The pressure in SI units is $P = 10\\,\\text{atm} \\times (1.01325 \\times 10^{5}\\,\\text{Pa}\\,\\text{atm}^{-1}) = 1.01325 \\times 10^{6}\\,\\text{Pa}$.\n    $$[Tot] = \\frac{1.01325 \\times 10^{6}\\,\\text{Pa}}{(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2000\\,\\text{K})} \\approx 60.9323\\,\\text{mol}\\,\\text{m}^{-3}$$\n\n2.  **Calculate the effective collider concentration $[\\text{M}]_{\\text{eff}}$.**\n    This is calculated as a weighted sum of the species concentrations:\n    $$[\\text{M}]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [i] = \\sum_{i} \\alpha_{i} x_{i} [Tot] = [Tot] \\left( \\sum_{i} \\alpha_{i} x_{i} \\right)$$\n    The mixture-averaged collision efficiency factor is:\n    $$\\sum_{i} \\alpha_{i} x_{i} = \\alpha_{\\text{N}_{2}}x_{\\text{N}_{2}} + \\alpha_{\\text{O}_{2}}x_{\\text{O}_{2}} + \\alpha_{\\text{CO}_{2}}x_{\\text{CO}_{2}} + \\alpha_{\\text{H}_{2}\\text{O}}x_{\\text{H}_{2}\\text{O}}$$\n    $$\\sum_{i} \\alpha_{i} x_{i} = (1.0)(0.70) + (1.2)(0.20) + (2.0)(0.05) + (6.0)(0.05) = 0.70 + 0.24 + 0.10 + 0.30 = 1.34$$\n    $$[\\text{M}]_{\\text{eff}} = (60.9323\\,\\text{mol}\\,\\text{m}^{-3}) \\times 1.34 \\approx 81.6493\\,\\text{mol}\\,\\text{m}^{-3}$$\n\n3.  **Calculate the temperature-dependent rate constants at $T = 2000\\,\\text{K}$.**\n    For all three reactions, the pre-exponential temperature exponent $n$ is $0$. The Arrhenius form simplifies to $k(T) = A \\exp(-E/RT)$.\n    The term $RT$ is $(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2000\\,\\text{K}) = 16628.925\\,\\text{J}\\,\\text{mol}^{-1}$.\n    -   $k_{1}(2000) = (1.0 \\times 10^{-1}) \\exp\\left(-\\frac{5.0 \\times 10^{3}}{16628.925}\\right) \\approx 0.0740316\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$\n    -   $k_{-1}(2000) = (1.0) \\exp\\left(-\\frac{0}{16628.925}\\right) = 1.0\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$\n    -   $k_{2}(2000) = (1.0 \\times 10^{13}) \\exp\\left(-\\frac{2.40 \\times 10^{5}}{16628.925}\\right) \\approx 5.39570 \\times 10^{6}\\,\\text{s}^{-1}$\n\n4.  **Calculate the effective rate coefficient $k_{\\text{eff}}$.**\n    We substitute the numerical values into the derived expression. Let's check the units:\n    $$k_{\\text{eff}} = \\frac{(\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1})(\\text{s}^{-1})(\\text{mol}\\,\\text{m}^{-3})}{(\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1})(\\text{mol}\\,\\text{m}^{-3}) + (\\text{s}^{-1})} = \\frac{\\text{s}^{-2}}{\\text{s}^{-1}} = \\text{s}^{-1}$$\n    The units are correct.\n    $$k_{\\text{eff}} = \\frac{(0.0740316) (5.39570 \\times 10^{6}) (81.6493)}{(1.0)(81.6493) + (5.39570 \\times 10^{6})}$$\n    Numerator:\n    $$k_{1} k_{2} [\\text{M}]_{\\text{eff}} \\approx (0.0740316) (5.39570 \\times 10^{6}) (81.6493) \\approx 3.26131 \\times 10^{7}\\,\\text{s}^{-2}$$\n    Denominator:\n    $$k_{-1}[\\text{M}]_{\\text{eff}} + k_{2} \\approx (1.0)(81.6493) + (5.39570 \\times 10^{6}) \\approx 5.39578 \\times 10^{6}\\,\\text{s}^{-1}$$\n    $$k_{\\text{eff}} \\approx \\frac{3.26131 \\times 10^{7}}{5.39578 \\times 10^{6}} \\approx 6.04414\\,\\text{s}^{-1}$$\n\nRounding the result to four significant figures gives $6.044$.",
            "answer": "$$\\boxed{6.044}$$"
        },
        {
            "introduction": "The vast disparity between fast chemical time scales and slower transport time scales makes combustion simulation numerically \"stiff\" and computationally expensive. This advanced practice guides you through implementing an operator splitting method—specifically, Strang splitting—to efficiently solve the stiff ordinary differential equations for a reacting system . This hands-on coding exercise provides vital experience with a powerful numerical technique widely used in research-level computational combustion codes to decouple and solve complex multi-physics problems.",
            "id": "4028518",
            "problem": "Consider a spatially homogeneous, constant-pressure, perfectly stirred reactor (Perfectly Stirred Reactor (PSR)) model in which a single global, semi-empirical reaction represents hydrocarbon oxidation. Let the state vector be $\\mathbf{y} = [Y_F, Y_O, T]^{\\top}$, where $Y_F$ is the fuel mass fraction, $Y_O$ is the oxidizer mass fraction, and $T$ is the temperature in Kelvin. Assume ideal-gas behavior with constant mixture heat capacity $c_p$ and a one-step global reaction rate that follows Arrhenius kinetics. The global reaction rate is defined as\n$$\n\\Omega(Y_F, Y_O, T) = A \\, Y_F^{a} \\, Y_O^{b} \\, \\exp\\!\\left(-\\frac{E}{R_u \\, T}\\right),\n$$\nwhere $A$ is the pre-exponential factor, $a$ and $b$ are global reaction orders with respect to $Y_F$ and $Y_O$, respectively, $E$ is the activation energy, and $R_u$ is the universal gas constant. Let $s$ denote the oxidizer-to-fuel stoichiometric mass ratio. The chemical source terms are given by\n$$\n\\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{R}} = -\\Omega,\\quad\n\\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{R}} = - s \\, \\Omega,\\quad\n\\left.\\frac{dT}{dt}\\right|_{\\mathrm{R}} = \\frac{\\Delta h}{c_p} \\, \\Omega,\n$$\nwhere $\\Delta h$ is the specific heat release per unit mass of fuel consumed. Mixing with a feed stream of composition and temperature $(Y_{F,\\mathrm{in}}, Y_{O,\\mathrm{in}}, T_{\\mathrm{in}})$ is modeled as linear relaxation with a mixing time scale $\\tau$:\n$$\n\\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{F,\\mathrm{in}} - Y_F}{\\tau},\\quad\n\\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{O,\\mathrm{in}} - Y_O}{\\tau},\\quad\n\\left.\\frac{dT}{dt}\\right|_{\\mathrm{M}} = \\frac{T_{\\mathrm{in}} - T}{\\tau}.\n$$\nThe full coupled Ordinary Differential Equation (ODE) system is therefore\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}) = \\mathbf{M}(\\mathbf{y}) + \\mathbf{R}(\\mathbf{y}),\n$$\nwith $\\mathbf{M}$ and $\\mathbf{R}$ defined by the mixing and reaction contributions above.\n\nYour tasks are as follows.\n\n1) Starting from conservation of species and energy for a homogeneous control mass and the semi-empirical Arrhenius form above, explain why the system is numerically stiff for large $E/(R_u T)$ and derive the linear mixing operator’s exact flow map over a finite time step. In particular, derive the analytical solution of the mixing subproblem over a time interval of length $\\Delta t$:\n$$\nY_F(t+\\Delta t) = Y_{F,\\mathrm{in}} + \\left(Y_F(t) - Y_{F,\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right),\n$$\nwith analogous expressions for $Y_O$ and $T$.\n\n2) Design a second-order Strang splitting time integrator for the complete system using the following composition over each time step of size $\\Delta t$:\n$$\n\\Phi_{\\Delta t}^{\\mathrm{Strang}} \\equiv \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right) \\circ \\exp\\!\\left(\\Delta t \\,\\mathcal{R}\\right) \\circ \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right),\n$$\nwhere $\\mathcal{M}$ and $\\mathcal{R}$ denote the generators of the mixing and reaction subproblems, respectively, and $\\exp(\\cdot)$ denotes the associated flow map. Implement $\\exp\\!\\left(\\Delta t\\,\\mathcal{R}\\right)$ by numerically integrating the reaction-only ODE using a stiff solver, and implement $\\exp\\!\\left(\\Delta t\\,\\mathcal{M}\\right)$ using the exact solution you derived in part $1$.\n\n3) Implement a reference solution by integrating the coupled ODE system (mixing plus reaction combined) directly with a stiff ODE solver over the same time horizon.\n\n4) For each test case below, compute the maximum componentwise relative error at the final time between the Strang-split solution and the reference solution:\n$$\n\\varepsilon_{\\max} = \\max_{q \\in \\{Y_F, Y_O, T\\}} \\frac{\\left| q_{\\mathrm{split}}(t_{\\mathrm{end}}) - q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|}{\\max\\!\\left(\\left| q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|,\\, \\epsilon\\right)},\n$$\nwhere $\\epsilon = 10^{-12}$ is a small regularization constant to avoid division by zero. Report $\\varepsilon_{\\max}$ as a floating-point number for each case.\n\nUse the following constants for all cases:\n- Universal gas constant $R_u = 8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- Heat capacity $c_p = 1000 \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$.\n- Heat release per unit fuel mass $\\Delta h = 5.0 \\times 10^{7} \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$.\n- Stoichiometric oxidizer-to-fuel mass ratio $s = 4.0$.\n- Global reaction orders $a = 1.0$, $b = 1.0$.\n\nFor each case, the parameter tuple is\n$$\n(A, E, \\tau, \\Delta t, t_{\\mathrm{end}}, Y_{F,0}, Y_{O,0}, T_0, Y_{F,\\text{in}}, Y_{O,\\text{in}}, T_{\\text{in}}).\n$$\n\nProvide a single program that carries out the computations for the following test suite:\n\n- Case $1$ (happy path, mixing equal to the initial state):\n  $$\n  (1.0\\times 10^{6}, 1.0\\times 10^{5}, 2.0\\times 10^{-2}, 1.0\\times 10^{-4}, 1.0\\times 10^{-2}, 2.0\\times 10^{-2}, 2.0\\times 10^{-1}, 1.0\\times 10^{3}, 2.0\\times 10^{-2}, 2.0\\times 10^{-1}, 1.0\\times 10^{3}).\n  $$\n\n- Case $2$ (competing mixing and reaction time scales):\n  $$\n  (2.0\\times 10^{6}, 1.1\\times 10^{5}, 1.0\\times 10^{-2}, 5.0\\times 10^{-4}, 2.0\\times 10^{-2}, 3.0\\times 10^{-2}, 1.0\\times 10^{-1}, 9.0\\times 10^{2}, 0.0, 2.3\\times 10^{-1}, 9.0\\times 10^{2}).\n  $$\n\n- Case $3$ (oxidizer-lean, reaction limited):\n  $$\n  (5.0\\times 10^{6}, 1.2\\times 10^{5}, 5.0\\times 10^{-2}, 2.0\\times 10^{-4}, 1.0\\times 10^{-2}, 2.0\\times 10^{-2}, 1.0\\times 10^{-2}, 1.2\\times 10^{3}, 0.0, 5.0\\times 10^{-2}, 1.2\\times 10^{3}).\n  $$\n\n- Case $4$ (single large time step equal to the horizon):\n  $$\n  (5.0\\times 10^{5}, 1.0\\times 10^{5}, 2.0\\times 10^{-2}, 5.0\\times 10^{-3}, 5.0\\times 10^{-3}, 1.5\\times 10^{-2}, 2.1\\times 10^{-1}, 1.1\\times 10^{3}, 1.0\\times 10^{-2}, 2.1\\times 10^{-1}, 1.1\\times 10^{3}).\n  $$\n\n- Case $5$ (very small time step to test convergence of splitting):\n  $$\n  (2.0\\times 10^{6}, 1.1\\times 10^{5}, 1.0\\times 10^{-2}, 5.0\\times 10^{-6}, 2.0\\times 10^{-2}, 3.0\\times 10^{-2}, 1.0\\times 10^{-1}, 9.0\\times 10^{2}, 0.0, 2.3\\times 10^{-1}, 9.0\\times 10^{2}).\n  $$\n\nAll physical units must be as specified above, with time in seconds and temperature in Kelvin. The program must:\n\n- Implement the Strang splitting integrator and the reference integrator using a stiff ODE solver for the reaction-only and full coupled systems, respectively.\n- For each case, output a floating-point value equal to $\\varepsilon_{\\max}$ defined above.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\"), where each $r_i$ is the computed $\\varepsilon_{\\max}$ for case $i$ expressed as a decimal number.",
            "solution": "### Part 1: System Stiffness and Analytical Mixing Solution\n\n#### Numerical Stiffness\nNumerical stiffness in an ODE system $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y})$ arises from a wide separation in the characteristic time scales of the system's dynamics. This is mathematically characterized by the eigenvalues of the Jacobian matrix, $\\mathbf{J} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{y}}$. If the eigenvalues $\\lambda_i$ have negative real parts and the ratio $\\max_i |\\mathrm{Re}(\\lambda_i)| / \\min_i |\\mathrm{Re}(\\lambda_i)|$ is very large, the system is stiff.\n\nIn the given problem, the stiffness originates primarily from the chemical reaction term $\\mathbf{R}(\\mathbf{y})$, specifically from the high sensitivity of the reaction rate $\\Omega$ to temperature $T$. The Jacobian of the reaction subproblem, $\\mathbf{J}_{\\mathcal{R}} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{y}}$, contains entries proportional to derivatives of $\\Omega$. The most significant term driving stiffness is the derivative with respect to temperature:\n$$\n\\frac{\\partial \\Omega}{\\partial T} = A \\, Y_F^{a} \\, Y_O^{b} \\, \\exp\\!\\left(-\\frac{E}{R_u \\, T}\\right) \\left(\\frac{E}{R_u T^2}\\right) = \\Omega \\cdot \\frac{E}{R_u T^2}\n$$\nThe dimensionless quantity $\\beta = \\frac{E}{R_u T}$ is the Zeldovich number, which represents the temperature sensitivity of the reaction. For typical combustion scenarios, $E$ is large, making $\\beta \\gg 1$. The eigenvalues of $\\mathbf{J}_{\\mathcal{R}}$ are related to this derivative. For example, the feedback loop where reaction increases temperature, which in turn exponentially increases the reaction rate, leads to a very fast dynamic mode (a large-magnitude negative eigenvalue). This signifies a very short reaction time scale, often many orders of magnitude smaller than the mixing time scale $\\tau$ or a practical integration time step $\\Delta t$. Explicit numerical methods are unstable for such systems unless the time step is prohibitively small, necessitating the use of implicit, or \"stiff,\" solvers.\n\n#### Derivation of the Mixing Flow Map\nThe mixing subproblem is described by a set of uncoupled, linear first-order ODEs. Let $q(t)$ represent any of the state variables ($Y_F(t)$, $Y_O(t)$, or $T(t)$) and $q_{\\mathrm{in}}$ be its corresponding inlet value. The governing equation is:\n$$\n\\frac{dq}{dt} = \\frac{q_{\\mathrm{in}} - q}{\\tau}\n$$\nThis is a linear non-homogeneous ODE. It can be solved by separation of variables. Let $u(t) = q(t) - q_{\\mathrm{in}}$. Then $\\frac{du}{dt} = \\frac{dq}{dt}$, and the equation transforms to:\n$$\n\\frac{du}{dt} = -\\frac{u}{\\tau}\n$$\nSeparating variables yields:\n$$\n\\frac{1}{u} du = -\\frac{1}{\\tau} dt\n$$\nWe integrate this equation from time $t$ to $t+\\Delta t$, where the state changes from $u(t)$ to $u(t+\\Delta t)$:\n$$\n\\int_{u(t)}^{u(t+\\Delta t)} \\frac{1}{u'} du' = \\int_{t}^{t+\\Delta t} -\\frac{1}{\\tau} dt'\n$$\n$$\n\\left[ \\ln|u'| \\right]_{u(t)}^{u(t+\\Delta t)} = -\\frac{1}{\\tau} \\left[ t' \\right]_{t}^{t+\\Delta t}\n$$\n$$\n\\ln|u(t+\\Delta t)| - \\ln|u(t)| = -\\frac{\\Delta t}{\\tau}\n$$\n$$\n\\ln \\left| \\frac{u(t+\\Delta t)}{u(t)} \\right| = -\\frac{\\Delta t}{\\tau}\n$$\nExponentiating both sides gives:\n$$\n\\frac{u(t+\\Delta t)}{u(t)} = \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\n$$\nu(t+\\Delta t) = u(t) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\nSubstituting back $u(t) = q(t) - q_{\\mathrm{in}}$:\n$$\nq(t+\\Delta t) - q_{\\mathrm{in}} = \\left(q(t) - q_{\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\nRearranging for $q(t+\\Delta t)$ gives the final expression for the exact flow map of the mixing operator, $\\exp(\\Delta t \\mathcal{M})$:\n$$\nq(t+\\Delta t) = q_{\\mathrm{in}} + \\left(q(t) - q_{\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\nThis analytical solution will be used to implement the $\\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)$ steps in the Strang splitting scheme.\n\n### Part 2 & 3: Numerical Scheme Design\n\nThe solution requires implementing two different time integration schemes for the same ODE system and comparing their results.\n\n#### Reference Solution\nThe reference solution is obtained by directly integrating the full coupled ODE system, $\\frac{d\\mathbf{y}}{dt} = \\mathbf{R}(\\mathbf{y}) + \\mathbf{M}(\\mathbf{y})$, from $t=0$ to $t=t_{\\mathrm{end}}$. The right-hand side function, $\\mathbf{F}(\\mathbf{y})$, is:\n$$\n\\mathbf{F}(\\mathbf{y}) = \\begin{bmatrix}\n-\\Omega(Y_F, Y_O, T) + (Y_{F,\\mathrm{in}} - Y_F)/\\tau \\\\\n-s\\,\\Omega(Y_F, Y_O, T) + (Y_{O,\\mathrm{in}} - Y_O)/\\tau \\\\\n\\frac{\\Delta h}{c_p}\\Omega(Y_F, Y_O, T) + (T_{\\mathrm{in}} - T)/\\tau\n\\end{bmatrix}\n$$\nGiven the stiffness of the system, this integration must be performed with a stiff ODE solver, such as the Backward Differentiation Formula (BDF) method, available in `scipy.integrate.solve_ivp`.\n\n#### Strang Splitting Solution\nThe Strang splitting method approximates the solution by sequentially solving the subproblems for mixing and reaction. For a single time step of size $\\Delta t$, the state $\\mathbf{y}(t)$ is advanced to $\\mathbf{y}(t+\\Delta t)$ via three sequential operations:\n1.  **First Mixing Half-Step**: Advance the state by solving the mixing-only ODEs for a time step of $\\frac{\\Delta t}{2}$. We use the analytical solution derived above. Let $\\mathbf{y}^{(0)} = \\mathbf{y}(t)$. We compute $\\mathbf{y}^{(1)} = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)(\\mathbf{y}^{(0)})$.\n2.  **Reaction Full-Step**: Starting from $\\mathbf{y}^{(1)}$, integrate the reaction-only ODEs, $\\frac{d\\mathbf{y}}{dt} = \\mathbf{R}(\\mathbf{y})$, over a full time step $\\Delta t$. This subproblem, $\\frac{d\\mathbf{y}}{dt} = [-\\Omega, -s\\Omega, \\frac{\\Delta h}{c_p}\\Omega]^\\top$, is the stiff part of the system. It is solved numerically using a stiff solver. The result is $\\mathbf{y}^{(2)} = \\exp\\!\\left(\\Delta t \\,\\mathcal{R}\\right)(\\mathbf{y}^{(1)})$.\n3.  **Second Mixing Half-Step**: Advance the state $\\mathbf{y}^{(2)}$ by solving the mixing-only ODEs for another time step of $\\frac{\\Delta t}{2}$ using the analytical solution. The final state for the step is $\\mathbf{y}(t+\\Delta t) = \\mathbf{y}^{(3)} = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)(\\mathbf{y}^{(2)})$.\n\nThis sequence is repeated for the total number of time steps, $N = t_{\\mathrm{end}} / \\Delta t$. This method is second-order accurate in $\\Delta t$, meaning the global error at a fixed final time is proportional to $(\\Delta t)^2$.\n\n### Part 4: Error Computation\n\nAfter computing the final state vectors for both the reference solution, $\\mathbf{y}_{\\mathrm{ref}}(t_{\\mathrm{end}})$, and the Strang splitting solution, $\\mathbf{y}_{\\mathrm{split}}(t_{\\mathrm{end}})$, the maximum componentwise relative error, $\\varepsilon_{\\max}$, is calculated according to the provided formula. This requires evaluating the relative error for each of the three components ($Y_F, Y_O, T$) and taking the maximum. The small regularization constant $\\epsilon=10^{-12}$ prevents division by zero if a reference component value is zero. The implementation will follow this definition precisely.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Meticulous and exacting professor's implementation of the PSR model integration.\n\ndef solve():\n    \"\"\"\n    Main driver function to execute the PSR model simulation for all test cases.\n    It implements a reference integrator and a Strang splitting integrator,\n    and computes the error between them for each case.\n    \"\"\"\n\n    # Global constants as specified in the problem statement.\n    CONSTS = {\n        'Ru': 8.314,       # J/mol/K\n        'cp': 1000.0,      # J/kg/K\n        'dh': 5.0e7,       # J/kg\n        's': 4.0,          # Stoichiometric oxidizer-to-fuel mass ratio\n        'a': 1.0,          # Fuel reaction order\n        'b': 1.0,          # Oxidizer reaction order\n    }\n    ERROR_REG = 1e-12\n\n    # Test cases defined as tuples of parameters.\n    # (A, E, tau, dt, t_end, Y_F0, Y_O0, T0, Y_Fin, Y_Oin, Tin)\n    test_cases = [\n        # Case 1 (happy path, mixing equal to the initial state)\n        (1.0e6, 1.0e5, 2.0e-2, 1.0e-4, 1.0e-2, 2.0e-2, 2.0e-1, 1.0e3, 2.0e-2, 2.0e-1, 1.0e3),\n        # Case 2 (competing mixing and reaction time scales)\n        (2.0e6, 1.1e5, 1.0e-2, 5.0e-4, 2.0e-2, 3.0e-2, 1.0e-1, 9.0e2, 0.0, 2.3e-1, 9.0e2),\n        # Case 3 (oxidizer-lean, reaction limited)\n        (5.0e6, 1.2e5, 5.0e-2, 2.0e-4, 1.0e-2, 2.0e-2, 1.0e-2, 1.2e3, 0.0, 5.0e-2, 1.2e3),\n        # Case 4 (single large time step equal to the horizon)\n        (5.0e5, 1.0e5, 2.0e-2, 5.0e-3, 5.0e-3, 1.5e-2, 2.1e-1, 1.1e3, 1.0e-2, 2.1e-1, 1.1e3),\n        # Case 5 (very small time step to test convergence of splitting)\n        (2.0e6, 1.1e5, 1.0e-2, 5.0e-6, 2.0e-2, 3.0e-2, 1.0e-1, 9.0e2, 0.0, 2.3e-1, 9.0e2),\n    ]\n\n    results = []\n\n    def Omega_rate(Y_F, Y_O, T, A, E, Ru, a, b):\n        \"\"\"Computes the global reaction rate Omega.\"\"\"\n        # Ensure mass fractions are non-negative for physical and numerical stability.\n        Y_F_clip = max(0.0, Y_F)\n        Y_O_clip = max(0.0, Y_O)\n        if T <= 0:\n            return 0.0\n        return A * (Y_F_clip**a) * (Y_O_clip**b) * np.exp(-E / (Ru * T))\n\n    def reaction_rhs(t, y, params):\n        \"\"\"RHS function for the reaction-only ODE system.\"\"\"\n        Y_F, Y_O, T = y\n        consts = params['consts']\n        # Negative mass fractions can arise during integration steps. Clip at zero.\n        if Y_F < 0 or Y_O < 0:\n            omega = 0.0\n        else:\n            omega = Omega_rate(Y_F, Y_O, T, params['A'], params['E'], consts['Ru'], consts['a'], consts['b'])\n        \n        dYF_dt = -omega\n        dYO_dt = -consts['s'] * omega\n        dT_dt = (consts['dh'] / consts['cp']) * omega\n        return np.array([dYF_dt, dYO_dt, dT_dt])\n\n    def coupled_rhs(t, y, params):\n        \"\"\"RHS function for the coupled (mixing + reaction) ODE system.\"\"\"\n        Y_F, Y_O, T = y\n        \n        # Reaction part\n        reaction_vector = reaction_rhs(t, y, params)\n        \n        # Mixing part\n        y_in = params['y_in']\n        tau = params['tau']\n        dYF_dt_mix = (y_in[0] - Y_F) / tau\n        dYO_dt_mix = (y_in[1] - Y_O) / tau\n        dT_dt_mix = (y_in[2] - T) / tau\n        mixing_vector = np.array([dYF_dt_mix, dYO_dt_mix, dT_dt_mix])\n        \n        return reaction_vector + mixing_vector\n\n    def analytical_mix_step(y, y_in, dt, tau):\n        \"\"\"Applies the analytical solution for the mixing-only step.\"\"\"\n        y_out = y_in + (y - y_in) * np.exp(-dt / tau)\n        return y_out\n\n    for case_params in test_cases:\n        A, E, tau, dt, t_end, Y_F0, Y_O0, T0, Y_Fin, Y_Oin, Tin = case_params\n        \n        y0 = np.array([Y_F0, Y_O0, T0])\n        y_in = np.array([Y_Fin, Y_Oin, Tin])\n        \n        params = {'A': A, 'E': E, 'tau': tau, 'y_in': y_in, 'consts': CONSTS}\n        \n        # --- 3) Reference Solution ---\n        # Integrate the full coupled system directly with a stiff solver.\n        t_span_ref = [0, t_end]\n        sol_ref = solve_ivp(\n            fun=coupled_rhs,\n            t_span=t_span_ref,\n            y0=y0,\n            method='BDF',\n            args=(params,),\n            dense_output=True,\n            rtol=1e-9,\n            atol=1e-12\n        )\n        y_ref_final = sol_ref.sol(t_end)\n\n        # --- 2) Strang Splitting Solution ---\n        y_split = np.copy(y0)\n        num_steps = int(round(t_end / dt))\n        \n        # If t_end is effectively zero, skip integration.\n        if num_steps > 0:\n            for _ in range(num_steps):\n                # First half-step of mixing\n                y_split = analytical_mix_step(y_split, y_in, dt / 2.0, tau)\n                \n                # Full step of reaction (numerically integrated)\n                t_span_react = [0, dt]\n                sol_react = solve_ivp(\n                    fun=reaction_rhs,\n                    t_span=t_span_react,\n                    y0=y_split,\n                    method='BDF',\n                    args=(params,),\n                    rtol=1e-9,\n                    atol=1e-12\n                )\n                y_split = sol_react.y[:, -1]\n                \n                # Second half-step of mixing\n                y_split = analytical_mix_step(y_split, y_in, dt / 2.0, tau)\n        \n        y_split_final = y_split\n\n        # --- 4) Error Calculation ---\n        diff = np.abs(y_split_final - y_ref_final)\n        denominator = np.maximum(np.abs(y_ref_final), ERROR_REG)\n        relative_errors = diff / denominator\n        max_rel_error = np.max(relative_errors)\n        \n        results.append(max_rel_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}