{
    "hands_on_practices": [
        {
            "introduction": "Global reaction models are powerful tools for simplifying complex chemical kinetics, but their parameters require careful interpretation. This exercise demonstrates a crucial concept: the distinction between the intrinsic activation energy ($E_a$) of the Arrhenius law and the *apparent* activation energy observed under specific experimental or simulation conditions. By deriving the apparent activation energy for a system at constant pressure, you will gain hands-on experience with how temperature-dependent concentrations can alter the overall temperature sensitivity of the reaction rate .",
            "id": "4028516",
            "problem": "A single-step global oxidation model for a gaseous fuel uses the empirical rate law $r = k \\, C_{F}^{a} \\, C_{O_{2}}^{b}$, where $r$ is the volumetric rate of consumption of the fuel, $C_{F}$ and $C_{O_{2}}$ are the molar concentrations of fuel and oxygen, and $a$ and $b$ are global reaction orders. The temperature dependence of the rate coefficient is described by a modified Arrhenius form $k = A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)$, where $A$ is a pre-exponential parameter, $n$ is a temperature exponent, $E_{a}$ is the activation energy, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nConsider a well-stirred environment at constant total pressure $p$ with fixed reactant mole fractions $X_{F}$ and $X_{O_{2}}$ (low conversion), so that the molar concentrations obey the ideal-gas relation $C_{i} = \\frac{X_{i} \\, p}{R T}$ for each species $i$. Define the apparent activation energy at constant pressure and fixed composition as\n$$\nE_{\\mathrm{app}}(T) \\equiv - R \\, \\frac{d \\ln r}{d \\!\\left(1/T\\right)} \\, .\n$$\nStarting from the stated empirical rate law, the modified Arrhenius temperature dependence, and the ideal-gas relation for concentrations, derive an analytic expression for $E_{\\mathrm{app}}(T)$ in terms of $E_{a}$, $R$, $T$, $n$, $a$, and $b$. Then, for parameters $E_{a} = 1.60 \\times 10^{5} \\ \\mathrm{J/mol}$, $n = 0.60$, $a = 1.10$, $b = 0.35$, and $R = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$, evaluate $E_{\\mathrm{app}}$ at $T = 1450 \\ \\mathrm{K}$. Round your final numerical answer to four significant figures. Express the final energy in $\\mathrm{kJ/mol}$.",
            "solution": "The problem requires the derivation of an expression for the apparent activation energy, $E_{\\mathrm{app}}(T)$, for a global reaction mechanism under specific conditions, followed by a numerical evaluation.\n\nThe analysis begins with the provided empirical rate law for the fuel consumption rate, $r$:\n$$\nr = k \\, C_{F}^{a} \\, C_{O_{2}}^{b}\n$$\nThe rate coefficient, $k$, follows a modified Arrhenius temperature dependence:\n$$\nk = A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nThe molar concentrations of the fuel ($C_F$) and oxygen ($C_{O_2}$) are given by the ideal-gas law under conditions of constant total pressure $p$ and fixed mole fractions $X_F$ and $X_{O_2}$:\n$$\nC_{F} = \\frac{X_{F} \\, p}{R T} \\quad \\text{and} \\quad C_{O_{2}} = \\frac{X_{O_{2}} \\, p}{R T}\n$$\nFirst, we construct the full expression for the reaction rate $r$ by substituting the expressions for $k$, $C_F$, and $C_{O_2}$:\n$$\nr = \\left[ A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right) \\right] \\left( \\frac{X_{F} \\, p}{R T} \\right)^{a} \\left( \\frac{X_{O_{2}} \\, p}{R T} \\right)^{b}\n$$\nWe can group the terms that are dependent on temperature $T$ and those that are constant under the given conditions ($A$, $X_F$, $X_{O_2}$, $p$, $R$, $a$, $b$, $n$).\n$$\nr = A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b} \\cdot T^{n} \\left( \\frac{1}{T} \\right)^{a} \\left( \\frac{1}{T} \\right)^{b} \\cdot \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nCombining the powers of $T$:\n$$\nr = \\left[ A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b} \\right] T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nThe term in the square brackets is constant with respect to temperature. Let us denote it by a constant $K'$:\n$$\nK' = A \\left( \\frac{p}{R} \\right)^{a+b} X_{F}^{a} X_{O_{2}}^{b}\n$$\nThe rate expression simplifies to:\n$$\nr = K' \\, T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\n$$\nThe apparent activation energy is defined as:\n$$\nE_{\\mathrm{app}}(T) \\equiv - R \\, \\frac{d \\ln r}{d \\!\\left(1/T\\right)}\n$$\nTo evaluate this derivative, we first take the natural logarithm of the rate expression:\n$$\n\\ln r = \\ln \\left( K' \\, T^{n - a - b} \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right) \\right)\n$$\n$$\n\\ln r = \\ln K' + \\ln(T^{n - a - b}) + \\ln\\left(\\exp\\!\\left(-\\frac{E_{a}}{R T}\\right)\\right)\n$$\n$$\n\\ln r = \\ln K' + (n - a - b) \\ln T - \\frac{E_{a}}{R T}\n$$\nNow we must differentiate $\\ln r$ with respect to $1/T$. We use the chain rule:\n$$\n\\frac{d(\\ln r)}{d(1/T)} = \\frac{d(\\ln r)}{dT} \\cdot \\frac{dT}{d(1/T)}\n$$\nFirst, we find the derivative of $\\ln r$ with respect to $T$:\n$$\n\\frac{d(\\ln r)}{dT} = \\frac{d}{dT} \\left( \\ln K' + (n - a - b) \\ln T - \\frac{E_{a}}{R} T^{-1} \\right)\n$$\nSince $\\ln K'$ is a constant, its derivative is zero.\n$$\n\\frac{d(\\ln r)}{dT} = (n - a - b) \\frac{1}{T} - \\frac{E_{a}}{R} (-1) T^{-2} = \\frac{n - a - b}{T} + \\frac{E_{a}}{R T^2}\n$$\nNext, we determine the derivative of $T$ with respect to $1/T$. Let $u = 1/T$, which implies $T = 1/u = u^{-1}$.\n$$\n\\frac{dT}{d(1/T)} = \\frac{dT}{du} = -1 \\cdot u^{-2} = -u^{-2} = -(1/T)^{-2} = -T^2\n$$\nNow we combine these results using the chain rule:\n$$\n\\frac{d(\\ln r)}{d(1/T)} = \\left( \\frac{n - a - b}{T} + \\frac{E_{a}}{R T^2} \\right) (-T^2)\n$$\n$$\n\\frac{d(\\ln r)}{d(1/T)} = - (n - a - b) T - \\frac{E_{a}}{R}\n$$\nFinally, we substitute this back into the definition of $E_{\\mathrm{app}}(T)$:\n$$\nE_{\\mathrm{app}}(T) = -R \\left[ - (n - a - b) T - \\frac{E_{a}}{R} \\right]\n$$\n$$\nE_{\\mathrm{app}}(T) = R (n - a - b) T + R \\frac{E_{a}}{R}\n$$\nThis yields the desired analytic expression for the apparent activation energy:\n$$\nE_{\\mathrm{app}}(T) = E_{a} + (n - a - b) R T\n$$\nThe next step is to evaluate this expression for the given parameters:\n$E_{a} = 1.60 \\times 10^{5} \\ \\mathrm{J/mol}$\n$n = 0.60$\n$a = 1.10$\n$b = 0.35$\n$R = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$\n$T = 1450 \\ \\mathrm{K}$\n\nFirst, we compute the exponent sum:\n$$\nn - a - b = 0.60 - 1.10 - 0.35 = -0.50 - 0.35 = -0.85\n$$\nNow, substitute the values into the derived expression for $E_{\\mathrm{app}}(T)$:\n$$\nE_{\\mathrm{app}}(1450 \\, \\mathrm{K}) = (1.60 \\times 10^{5}) + (-0.85) \\times (8.314) \\times (1450)\n$$\nCalculate the second term:\n$$\n(n - a - b) R T = (-0.85) \\times (8.314 \\ \\mathrm{J/(mol \\cdot K)}) \\times (1450 \\ \\mathrm{K}) = -10247.005 \\ \\mathrm{J/mol}\n$$\nNow, sum the terms to find the apparent activation energy:\n$$\nE_{\\mathrm{app}}(1450 \\, \\mathrm{K}) = 160000 \\ \\mathrm{J/mol} - 10247.005 \\ \\mathrm{J/mol} = 149752.995 \\ \\mathrm{J/mol}\n$$\nThe problem requires the final answer to be in units of $\\mathrm{kJ/mol}$ and rounded to four significant figures.\n$$\nE_{\\mathrm{app}} = 149752.995 \\ \\mathrm{J/mol} \\times \\frac{1 \\ \\mathrm{kJ}}{1000 \\ \\mathrm{J}} = 149.752995 \\ \\mathrm{kJ/mol}\n$$\nRounding this value to four significant figures gives:\n$$\nE_{\\mathrm{app}} \\approx 149.8 \\ \\mathrm{kJ/mol}\n$$",
            "answer": "$$\\boxed{149.8}$$"
        },
        {
            "introduction": "Moving beyond single-step models, many critical combustion reactions, such as dissociation and isomerization, are pressure-dependent. This dependence is often modeled using semi-empirical mechanisms that represent a sequence of collisional activation, deactivation, and reaction steps. This practice guides you through the application of the steady-state approximation to a Lindemann-type mechanism to derive an effective, pressure-dependent rate coefficient, incorporating the important concept of mixture-averaged third-body collision efficiencies .",
            "id": "4028526",
            "problem": "A chemically activated unimolecular dissociation of molecular oxygen is represented in a semi-empirical global kinetic framework by the activation–deactivation mechanism with a third-body collider, suitable for falloff analysis. Consider the reactions\n$$\\text{O}_{2} + \\text{M} \\xrightleftharpoons[k_{-1}(T)]{k_{1}(T)} \\text{O}_{2}^{*} + \\text{M}, \\quad \\text{O}_{2}^{*} \\xrightarrow{k_{2}(T)} 2\\,\\text{O},$$\nwhere $\\text{M}$ denotes a generic collider drawn from the gas mixture, and $\\text{O}_{2}^{*}$ is an energized intermediate. The temperature is $T = 2000\\,\\text{K}$ and the total pressure is $P = 10\\,\\text{atm}$. The mixture mole fractions are $x_{\\text{N}_{2}} = 0.70$, $x_{\\text{O}_{2}} = 0.20$, $x_{\\text{CO}_{2}} = 0.05$, and $x_{\\text{H}_{2}\\text{O}} = 0.05$. The third-body collision efficiencies are $\\alpha_{\\text{N}_{2}} = 1.0$, $\\alpha_{\\text{O}_{2}} = 1.2$, $\\alpha_{\\text{CO}_{2}} = 2.0$, and $\\alpha_{\\text{H}_{2}\\text{O}} = 6.0$.\n\nAssume ideal-gas behavior. Use the Ideal Gas Law and the law of mass action as the fundamental base, and the Steady State Approximation (SSA) for the intermediate $\\text{O}_{2}^{*}$ (define SSA as the approximation that the net rate of change of intermediate concentration is negligible compared to its formation and consumption rates). The collision partner concentration is to be treated with the mixture-averaged third-body approximation, meaning an effective collider concentration\n$$[\\text{M}]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [i],$$\nwhere $[i]$ is the molar concentration of species $i$, and the sum runs over $\\text{N}_{2}$, $\\text{O}_{2}$, $\\text{CO}_{2}$, and $\\text{H}_{2}\\text{O}$.\n\nThe temperature-dependent rate constants follow Arrhenius forms,\n$$k_{1}(T) = A_{1} T^{n_{1}} \\exp\\!\\left(-\\frac{E_{1}}{R T}\\right), \\quad k_{-1}(T) = A_{-1} T^{n_{-1}} \\exp\\!\\left(-\\frac{E_{-1}}{R T}\\right), \\quad k_{2}(T) = A_{2} T^{n_{2}} \\exp\\!\\left(-\\frac{E_{2}}{R T}\\right),$$\nwith parameters $A_{1} = 1.0 \\times 10^{-1}\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$, $n_{1} = 0$, $E_{1} = 5.0 \\times 10^{3}\\,\\text{J}\\,\\text{mol}^{-1}$; $A_{-1} = 1.0\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$, $n_{-1} = 0$, $E_{-1} = 0$; $A_{2} = 1.0 \\times 10^{13}\\,\\text{s}^{-1}$, $n_{2} = 0$, $E_{2} = 2.40 \\times 10^{5}\\,\\text{J}\\,\\text{mol}^{-1}$. Use $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ and $1\\,\\text{atm} = 1.01325 \\times 10^{5}\\,\\text{Pa}$.\n\nStarting only from these definitions and the stated fundamental laws, derive the effective first-order rate coefficient $k_{\\text{eff}}(T,P,\\{x_{i},\\alpha_{i}\\})$ for $\\text{O}_{2}$ dissociation under SSA and third-body mixture averaging, and then evaluate it numerically for the given state. Round your final numerical value to four significant figures. Express the final answer in $\\text{s}^{-1}$.",
            "solution": "The problem requires us to derive and evaluate the effective first-order rate coefficient, $k_{\\text{eff}}$, for the dissociation of $\\text{O}_2$ based on a Lindemann-type mechanism. The derivation relies on the Steady-State Approximation (SSA) for the energized intermediate species $\\text{O}_2^*$.\n\nThe given reaction mechanism is:\n1.  $\\text{O}_{2} + \\text{M} \\xrightarrow{k_{1}(T)} \\text{O}_{2}^{*} + \\text{M}$ (Activation)\n2.  $\\text{O}_{2}^{*} + \\text{M} \\xrightarrow{k_{-1}(T)} \\text{O}_{2} + \\text{M}$ (Deactivation)\n3.  $\\text{O}_{2}^{*} \\xrightarrow{k_{2}(T)} 2\\,\\text{O}$ (Dissociation)\n\n**Step 1: Apply the Steady-State Approximation**\n\nThe rate of change of the concentration of the intermediate $\\text{O}_2^*$ is written by summing the rates of the reactions that produce it and consume it:\n$$ \\frac{d[\\text{O}_{2}^{*}]}{dt} = k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}} - k_{2}[\\text{O}_{2}^{*}] $$\nThe SSA assumes that the concentration of this highly reactive intermediate is small and does not change significantly over time, so we set its net rate of change to zero:\n$$ \\frac{d[\\text{O}_{2}^{*}]}{dt} \\approx 0 $$\n$$ k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}[\\text{O}_{2}^{*}][\\text{M}]_{\\text{eff}} - k_{2}[\\text{O}_{2}^{*}] = 0 $$\nWe can now solve for the steady-state concentration of the intermediate, $[\\text{O}_{2}^{*}]_{\\text{ss}}$:\n$$ k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} = [\\text{O}_{2}^{*}]_{\\text{ss}} \\left( k_{-1}[\\text{M}]_{\\text{eff}} + k_{2} \\right) $$\n$$ [\\text{O}_{2}^{*}]_{\\text{ss}} = \\frac{k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}}}{k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}} $$\n\n**Step 2: Derive the Overall Rate Law**\n\nThe overall rate of dissociation is defined as the net rate of consumption of $\\text{O}_2$. From the mechanism, $\\text{O}_2$ is consumed in the forward activation step and produced in the deactivation step.\n$$ \\text{Rate} = -\\frac{d[\\text{O}_{2}]}{dt} = k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}[\\text{O}_{2}^{*}]_{\\text{ss}}[\\text{M}]_{\\text{eff}} $$\nSubstitute the expression for $[\\text{O}_{2}^{*}]_{\\text{ss}}$ into the rate equation:\n$$ -\\frac{d[\\text{O}_{2}]}{dt} = k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} - k_{-1}\\left( \\frac{k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}}}{k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}} \\right)[\\text{M}]_{\\text{eff}} $$\nFactor out the common terms $k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}}$:\n$$ -\\frac{d[\\text{O}_{2}]}{dt} = k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} \\left( 1 - \\frac{k_{-1}[\\text{M}]_{\\text{eff}}}{k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}} \\right) $$\nCombine the terms in the parenthesis over a common denominator:\n$$ -\\frac{d[\\text{O}_{2}]}{dt} = k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} \\left( \\frac{(k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}) - k_{-1}[\\text{M}]_{\\text{eff}}}{k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}} \\right) $$\n$$ -\\frac{d[\\text{O}_{2}]}{dt} = k_{1}[\\text{O}_{2}][\\text{M}]_{\\text{eff}} \\left( \\frac{k_{2}}{k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}} \\right) $$\nThis gives the overall rate law:\n$$ -\\frac{d[\\text{O}_{2}]}{dt} = \\left( \\frac{k_{1} k_{2} [\\text{M}]_{\\text{eff}}}{k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}} \\right) [\\text{O}_{2}] $$\nBy comparing this to the first-order rate expression, Rate $= k_{\\text{eff}}[\\text{O}_2]$, we identify the effective rate coefficient:\n$$ k_{\\text{eff}} = \\frac{k_{1} k_{2} [\\text{M}]_{\\text{eff}}}{k_{-1}[\\text{M}]_{\\text{eff}} + k_{2}} $$\n\n**Step 3: Numerical Evaluation**\n\n1.  **Calculate total molar concentration $[Tot]$**:\n    Using the Ideal Gas Law, $[Tot] = \\frac{P}{RT}$.\n    $P = 10\\,\\text{atm} \\times (1.01325 \\times 10^{5}\\,\\text{Pa/atm}) = 1.01325 \\times 10^{6}\\,\\text{Pa}$.\n    $T = 2000\\,\\text{K}$.\n    $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n    $$ [Tot] = \\frac{1.01325 \\times 10^{6}\\,\\text{Pa}}{(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2000\\,\\text{K})} \\approx 60.9323\\,\\text{mol}\\,\\text{m}^{-3} $$\n\n2.  **Calculate effective collider concentration $[\\text{M}]_{\\text{eff}}$**:\n    $[\\text{M}]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [i] = [Tot] \\sum_{i} \\alpha_{i} x_{i}$.\n    $$ \\sum \\alpha_{i} x_{i} = (1.0)(0.70) + (1.2)(0.20) + (2.0)(0.05) + (6.0)(0.05) = 0.70 + 0.24 + 0.10 + 0.30 = 1.34 $$\n    $$ [\\text{M}]_{\\text{eff}} = (60.9323\\,\\text{mol}\\,\\text{m}^{-3}) \\times 1.34 \\approx 81.6493\\,\\text{mol}\\,\\text{m}^{-3} $$\n\n3.  **Calculate rate constants at $T = 2000\\,\\text{K}$**:\n    The Arrhenius form is $k(T) = A \\exp(-E/RT)$, since all $n_i=0$.\n    $RT = (8.314462618)(2000) \\approx 16628.925\\,\\text{J}\\,\\text{mol}^{-1}$.\n    $$ k_{1} = (1.0 \\times 10^{-1}) \\exp\\left(-\\frac{5000}{16628.925}\\right) \\approx 0.0740316\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1} $$\n    $$ k_{-1} = (1.0) \\exp(0) = 1.0\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1} $$\n    $$ k_{2} = (1.0 \\times 10^{13}) \\exp\\left(-\\frac{2.40 \\times 10^{5}}{16628.925}\\right) \\approx 5.39570 \\times 10^{6}\\,\\text{s}^{-1} $$\n\n4.  **Calculate $k_{\\text{eff}}$**:\n    $$ k_{\\text{eff}} = \\frac{(0.0740316)(5.39570 \\times 10^{6})(81.6493)}{(1.0)(81.6493) + (5.39570 \\times 10^{6})} $$\n    $$ k_{\\text{eff}} = \\frac{3.26131 \\times 10^{7}}{81.6493 + 5.39570 \\times 10^{6}} = \\frac{3.26131 \\times 10^{7}}{5.39578 \\times 10^{6}} \\approx 6.04414\\,\\text{s}^{-1} $$\n\nRounding the result to four significant figures gives $6.044\\,\\text{s}^{-1}$.",
            "answer": "$$\\boxed{6.044}$$"
        },
        {
            "introduction": "A key challenge in computational combustion is the numerical \"stiffness\" of the governing equations, which arises from the vast range of time scales from slow transport to extremely fast chemical reactions. This coding exercise provides a direct, practical encounter with this problem and a powerful solution technique: operator splitting. You will implement a second-order Strang splitting integrator to decouple the stiff reaction chemistry from the non-stiff mixing processes, a method that is fundamental to the development of efficient and stable reacting flow solvers .",
            "id": "4028518",
            "problem": "Consider a spatially homogeneous, constant-pressure, perfectly stirred reactor (Perfectly Stirred Reactor (PSR)) model in which a single global, semi-empirical reaction represents hydrocarbon oxidation. Let the state vector be $\\mathbf{y} = [Y_F, Y_O, T]^{\\top}$, where $Y_F$ is the fuel mass fraction, $Y_O$ is the oxidizer mass fraction, and $T$ is the temperature in Kelvin. Assume ideal-gas behavior with constant mixture heat capacity $c_p$ and a one-step global reaction rate that follows Arrhenius kinetics. The global reaction rate is defined as\n$$\n\\Omega(Y_F, Y_O, T) = A \\, Y_F^{a} \\, Y_O^{b} \\, \\exp\\!\\left(-\\frac{E}{R_u \\, T}\\right),\n$$\nwhere $A$ is the pre-exponential factor, $a$ and $b$ are global reaction orders with respect to $Y_F$ and $Y_O$, respectively, $E$ is the activation energy, and $R_u$ is the universal gas constant. Let $s$ denote the oxidizer-to-fuel stoichiometric mass ratio. The chemical source terms are given by\n$$\n\\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{R}} = -\\Omega,\\quad\n\\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{R}} = - s \\, \\Omega,\\quad\n\\left.\\frac{dT}{dt}\\right|_{\\mathrm{R}} = \\frac{\\Delta h}{c_p} \\, \\Omega,\n$$\nwhere $\\Delta h$ is the specific heat release per unit mass of fuel consumed. Mixing with a feed stream of composition and temperature $(Y_{F,\\mathrm{in}}, Y_{O,\\mathrm{in}}, T_{\\mathrm{in}})$ is modeled as linear relaxation with a mixing time scale $\\tau$:\n$$\n\\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{F,\\mathrm{in}} - Y_F}{\\tau},\\quad\n\\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{O,\\mathrm{in}} - Y_O}{\\tau},\\quad\n\\left.\\frac{dT}{dt}\\right|_{\\mathrm{M}} = \\frac{T_{\\mathrm{in}} - T}{\\tau}.\n$$\nThe full coupled Ordinary Differential Equation (ODE) system is therefore\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}) = \\mathbf{M}(\\mathbf{y}) + \\mathbf{R}(\\mathbf{y}),\n$$\nwith $\\mathbf{M}$ and $\\mathbf{R}$ defined by the mixing and reaction contributions above.\n\nYour tasks are as follows.\n\n1) Starting from conservation of species and energy for a homogeneous control mass and the semi-empirical Arrhenius form above, explain why the system is numerically stiff for large $E/(R_u T)$ and derive the linear mixing operator’s exact flow map over a finite time step. In particular, derive the analytical solution of the mixing subproblem over a time interval of length $\\Delta t$:\n$$\nY_F(t+\\Delta t) = Y_{F,\\mathrm{in}} + \\left(Y_F(t) - Y_{F,\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right),\n$$\nwith analogous expressions for $Y_O$ and $T$.\n\n2) Design a second-order Strang splitting time integrator for the complete system using the following composition over each time step of size $\\Delta t$:\n$$\n\\Phi_{\\Delta t}^{\\mathrm{Strang}} \\equiv \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right) \\circ \\exp\\!\\left(\\Delta t \\,\\mathcal{R}\\right) \\circ \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right),\n$$\nwhere $\\mathcal{M}$ and $\\mathcal{R}$ denote the generators of the mixing and reaction subproblems, respectively, and $\\exp(\\cdot)$ denotes the associated flow map. Implement $\\exp\\!\\left(\\Delta t\\,\\mathcal{R}\\right)$ by numerically integrating the reaction-only ODE using a stiff solver, and implement $\\exp\\!\\left(\\Delta t\\,\\mathcal{M}\\right)$ using the exact solution you derived in part $1$.\n\n3) Implement a reference solution by integrating the coupled ODE system (mixing plus reaction combined) directly with a stiff ODE solver over the same time horizon.\n\n4) For each test case below, compute the maximum componentwise relative error at the final time between the Strang-split solution and the reference solution:\n$$\n\\varepsilon_{\\max} = \\max_{q \\in \\{Y_F, Y_O, T\\}} \\frac{\\left| q_{\\mathrm{split}}(t_{\\mathrm{end}}) - q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|}{\\max\\!\\left(\\left| q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|,\\, \\epsilon\\right)},\n$$\nwhere $\\epsilon = 10^{-12}$ is a small regularization constant to avoid division by zero. Report $\\varepsilon_{\\max}$ as a floating-point number for each case.\n\nUse the following constants for all cases:\n- Universal gas constant $R_u = 8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- Heat capacity $c_p = 1000 \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$.\n- Heat release per unit fuel mass $\\Delta h = 5.0 \\times 10^{7} \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$.\n- Stoichiometric oxidizer-to-fuel mass ratio $s = 4.0$.\n- Global reaction orders $a = 1.0$, $b = 1.0$.\n\nFor each case, the parameter tuple is\n$$\n\\left(A,\\ E,\\ \\tau,\\ \\Delta t,\\ t_{\\mathrm{end}},\\ Y_{F,0},\\ Y_{O,0},\\ T_0,\\ Y_{F,\\mathrm{in}},\\ Y_{O,\\mathrm{in}},\\ T_{\\mathrm{in}}\\right).\n$$\n\nProvide a single program that carries out the computations for the following test suite:\n\n- Case $1$ (happy path, mixing equal to the initial state):\n  $$\n  \\left(1.0\\times 10^{6},\\ 1.0\\times 10^{5},\\ 2.0\\times 10^{-2},\\ 1.0\\times 10^{-4},\\ 1.0\\times 10^{-2},\\ 2.0\\times 10^{-2},\\ 2.0\\times 10^{-1},\\ 1.0\\times 10^{3},\\ 2.0\\times 10^{-2},\\ 2.0\\times 10^{-1},\\ 1.0\\times 10^{3}\\right).\n  $$\n\n- Case $2$ (competing mixing and reaction time scales):\n  $$\n  \\left(2.0\\times 10^{6},\\ 1.1\\times 10^{5},\\ 1.0\\times 10^{-2},\\ 5.0\\times 10^{-4},\\ 2.0\\times 10^{-2},\\ 3.0\\times 10^{-2},\\ 1.0\\times 10^{-1},\\ 9.0\\times 10^{2},\\ 0.0,\\ 2.3\\times 10^{-1},\\ 9.0\\times 10^{2}\\right).\n  $$\n\n- Case $3$ (oxidizer-lean, reaction limited):\n  $$\n  \\left(5.0\\times 10^{6},\\ 1.2\\times 10^{5},\\ 5.0\\times 10^{-2},\\ 2.0\\times 10^{-4},\\ 1.0\\times 10^{-2},\\ 2.0\\times 10^{-2},\\ 1.0\\times 10^{-2},\\ 1.2\\times 10^{3},\\ 0.0,\\ 5.0\\times 10^{-2},\\ 1.2\\times 10^{3}\\right).\n  $$\n\n- Case $4$ (single large time step equal to the horizon):\n  $$\n  \\left(5.0\\times 10^{5},\\ 1.0\\times 10^{5},\\ 2.0\\times 10^{-2},\\ 5.0\\times 10^{-3},\\ 5.0\\times 10^{-3},\\ 1.5\\times 10^{-2},\\ 2.1\\times 10^{-1},\\ 1.1\\times 10^{3},\\ 1.0\\times 10^{-2},\\ 2.1\\times 10^{-1},\\ 1.1\\times 10^{3}\\right).\n  $$\n\n- Case $5$ (very small time step to test convergence of splitting):\n  $$\n  \\left(2.0\\times 10^{6},\\ 1.1\\times 10^{5},\\ 1.0\\times 10^{-2},\\ 5.0\\times 10^{-6},\\ 2.0\\times 10^{-2},\\ 3.0\\times 10^{-2},\\ 1.0\\times 10^{-1},\\ 9.0\\times 10^{2},\\ 0.0,\\ 2.3\\times 10^{-1},\\ 9.0\\times 10^{2}\\right).\n  $$\n\nAll physical units must be as specified above, with time in seconds and temperature in Kelvin. The program must:\n\n- Implement the Strang splitting integrator and the reference integrator using a stiff ODE solver for the reaction-only and full coupled systems, respectively.\n- For each case, output a floating-point value equal to $\\varepsilon_{\\max}$ defined above.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\"), where each $r_i$ is the computed $\\varepsilon_{\\max}$ for case $i$ expressed as a decimal number.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\nThe givens are extracted verbatim from the problem statement:\n- **State Vector**: $\\mathbf{y} = [Y_F, Y_O, T]^{\\top}$, where $Y_F$ is the fuel mass fraction, $Y_O$ is the oxidizer mass fraction, and $T$ is the temperature in Kelvin.\n- **Global Reaction Rate**: $\\Omega(Y_F, Y_O, T) = A \\, Y_F^{a} \\, Y_O^{b} \\, \\exp\\!\\left(-\\frac{E}{R_u \\, T}\\right)$.\n- **Parameters**: $A$ (pre-exponential factor), $a, b$ (reaction orders), $E$ (activation energy), $R_u$ (universal gas constant).\n- **Chemical Source Terms (Vector $\\mathbf{R}(\\mathbf{y})$)**:\n  $$ \\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{R}} = -\\Omega,\\quad \\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{R}} = - s \\, \\Omega,\\quad \\left.\\frac{dT}{dt}\\right|_{\\mathrm{R}} = \\frac{\\Delta h}{c_p} \\, \\Omega $$\n- **Mixing Source Terms (Vector $\\mathbf{M}(\\mathbf{y})$)**:\n  $$ \\left.\\frac{dY_F}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{F,\\mathrm{in}} - Y_F}{\\tau},\\quad \\left.\\frac{dY_O}{dt}\\right|_{\\mathrm{M}} = \\frac{Y_{O,\\mathrm{in}} - Y_O}{\\tau},\\quad \\left.\\frac{dT}{dt}\\right|_{\\mathrm{M}} = \\frac{T_{\\mathrm{in}} - T}{\\tau} $$\n- **Governing ODE System**: $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}) = \\mathbf{M}(\\mathbf{y}) + \\mathbf{R}(\\mathbf{y})$.\n- **Strang Splitting Composition**: $\\Phi_{\\Delta t}^{\\mathrm{Strang}} \\equiv \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right) \\circ \\exp\\!\\left(\\Delta t \\,\\mathcal{R}\\right) \\circ \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)$.\n- **Error Metric**: $\\varepsilon_{\\max} = \\max_{q \\in \\{Y_F, Y_O, T\\}} \\frac{\\left| q_{\\mathrm{split}}(t_{\\mathrm{end}}) - q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|}{\\max\\!\\left(\\left| q_{\\mathrm{ref}}(t_{\\mathrm{end}}) \\right|,\\, \\epsilon\\right)}$, with $\\epsilon = 10^{-12}$.\n- **Constants**:\n  - $R_u = 8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n  - $c_p = 1000 \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n  - $\\Delta h = 5.0 \\times 10^{7} \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$\n  - $s = 4.0$\n  - $a = 1.0$, $b = 1.0$\n- **Test Case Structure**: Parameter tuple $\\left(A,\\ E,\\ \\tau,\\ \\Delta t,\\ t_{\\mathrm{end}},\\ Y_{F,0},\\ Y_{O,0},\\ T_0,\\ Y_{F,\\mathrm{in}},\\ Y_{O,\\mathrm{in}},\\ T_{\\mathrm{in}}\\right)$.\n- **Test Cases**: Five specific tuples are provided.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded**: The problem describes a Perfectly Stirred Reactor (PSR) with a one-step global reaction, which is a standard, widely used simplification in computational combustion. The governing equations for mass fractions and temperature are based on fundamental conservation laws for a homogeneous control mass subject to chemical reaction and mixing. The Arrhenius form of the reaction rate is a cornerstone of chemical kinetics. The formulation is scientifically sound.\n- **Well-Posed**: The problem specifies a system of ordinary differential equations with initial conditions. For the given physical parameters, a unique, stable solution is expected to exist. The numerical tasks—implementing specified integration schemes and computing a defined error metric—are unambiguous.\n- **Objective**: The problem is stated in precise mathematical and physical terms, free of subjective or ambiguous language.\n- **Incomplete or Contradictory Setup**: The problem is self-contained. All constants, parameters, initial conditions, and governing equations required to perform the specified tasks are provided. There are no apparent contradictions.\n- **Unrealistic or Infeasible**: The provided parameter values are within a plausible range for global combustion models. The setup is physically and computationally feasible.\n\n### Step 3: Verdict and Action\n\nThe problem statement is declared **valid**. It is scientifically sound, well-posed, objective, and complete. A full solution will be provided.\n\n---\n\n### Part 1: System Stiffness and Analytical Mixing Solution\n\n#### Numerical Stiffness\nNumerical stiffness in an ODE system $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y})$ arises from a wide separation in the characteristic time scales of the system's dynamics. This is mathematically characterized by the eigenvalues of the Jacobian matrix, $\\mathbf{J} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{y}}$. If the eigenvalues $\\lambda_i$ have negative real parts and the ratio $\\max_i |\\mathrm{Re}(\\lambda_i)| / \\min_i |\\mathrm{Re}(\\lambda_i)|$ is very large, the system is stiff.\n\nIn the given problem, the stiffness originates primarily from the chemical reaction term $\\mathbf{R}(\\mathbf{y})$, specifically from the high sensitivity of the reaction rate $\\Omega$ to temperature $T$. The Jacobian of the reaction subproblem, $\\mathbf{J}_{\\mathcal{R}} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{y}}$, contains entries proportional to derivatives of $\\Omega$. The most significant term driving stiffness is the derivative with respect to temperature:\n$$\n\\frac{\\partial \\Omega}{\\partial T} = A \\, Y_F^{a} \\, Y_O^{b} \\, \\exp\\!\\left(-\\frac{E}{R_u \\, T}\\right) \\left(\\frac{E}{R_u T^2}\\right) = \\Omega \\cdot \\frac{E}{R_u T^2}\n$$\nThe dimensionless quantity $\\beta = \\frac{E}{R_u T}$ is the Zeldovich number, which represents the temperature sensitivity of the reaction. For typical combustion scenarios, $E$ is large, making $\\beta \\gg 1$. The eigenvalues of $\\mathbf{J}_{\\mathcal{R}}$ are related to this derivative. For example, the feedback loop where reaction increases temperature, which in turn exponentially increases the reaction rate, leads to a very fast dynamic mode (a large-magnitude negative eigenvalue). This signifies a very short reaction time scale, often many orders of magnitude smaller than the mixing time scale $\\tau$ or a practical integration time step $\\Delta t$. Explicit numerical methods are unstable for such systems unless the time step is prohibitively small, necessitating the use of implicit, or \"stiff,\" solvers.\n\n#### Derivation of the Mixing Flow Map\nThe mixing subproblem is described by a set of uncoupled, linear first-order ODEs. Let $q(t)$ represent any of the state variables ($Y_F(t)$, $Y_O(t)$, or $T(t)$) and $q_{\\mathrm{in}}$ be its corresponding inlet value. The governing equation is:\n$$\n\\frac{dq}{dt} = \\frac{q_{\\mathrm{in}} - q}{\\tau}\n$$\nThis is a linear non-homogeneous ODE. It can be solved by separation of variables. Let $u(t) = q(t) - q_{\\mathrm{in}}$. Then $\\frac{du}{dt} = \\frac{dq}{dt}$, and the equation transforms to:\n$$\n\\frac{du}{dt} = -\\frac{u}{\\tau}\n$$\nSeparating variables yields:\n$$\n\\frac{1}{u} du = -\\frac{1}{\\tau} dt\n$$\nWe integrate this equation from time $t$ to $t+\\Delta t$, where the state changes from $u(t)$ to $u(t+\\Delta t)$:\n$$\n\\int_{u(t)}^{u(t+\\Delta t)} \\frac{1}{u'} du' = \\int_{t}^{t+\\Delta t} -\\frac{1}{\\tau} dt'\n$$\n$$\n\\left[ \\ln|u'| \\right]_{u(t)}^{u(t+\\Delta t)} = -\\frac{1}{\\tau} \\left[ t' \\right]_{t}^{t+\\Delta t}\n$$\n$$\n\\ln|u(t+\\Delta t)| - \\ln|u(t)| = -\\frac{\\Delta t}{\\tau}\n$$\n$$\n\\ln \\left| \\frac{u(t+\\Delta t)}{u(t)} \\right| = -\\frac{\\Delta t}{\\tau}\n$$\nExponentiating both sides gives:\n$$\n\\frac{u(t+\\Delta t)}{u(t)} = \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\n$$\nu(t+\\Delta t) = u(t) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\nSubstituting back $u(t) = q(t) - q_{\\mathrm{in}}$:\n$$\nq(t+\\Delta t) - q_{\\mathrm{in}} = \\left(q(t) - q_{\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\nRearranging for $q(t+\\Delta t)$ gives the final expression for the exact flow map of the mixing operator, $\\exp(\\Delta t \\mathcal{M})$:\n$$\nq(t+\\Delta t) = q_{\\mathrm{in}} + \\left(q(t) - q_{\\mathrm{in}}\\right) \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\n$$\nThis analytical solution will be used to implement the $\\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)$ steps in the Strang splitting scheme.\n\n### Part 2 & 3: Numerical Scheme Design\n\nThe solution requires implementing two different time integration schemes for the same ODE system and comparing their results.\n\n#### Reference Solution\nThe reference solution is obtained by directly integrating the full coupled ODE system, $\\frac{d\\mathbf{y}}{dt} = \\mathbf{R}(\\mathbf{y}) + \\mathbf{M}(\\mathbf{y})$, from $t=0$ to $t=t_{\\mathrm{end}}$. The right-hand side function, $\\mathbf{F}(\\mathbf{y})$, is:\n$$\n\\mathbf{F}(\\mathbf{y}) = \\begin{bmatrix}\n-\\Omega(Y_F, Y_O, T) + (Y_{F,\\mathrm{in}} - Y_F)/\\tau \\\\\n-s\\,\\Omega(Y_F, Y_O, T) + (Y_{O,\\mathrm{in}} - Y_O)/\\tau \\\\\n\\frac{\\Delta h}{c_p}\\Omega(Y_F, Y_O, T) + (T_{\\mathrm{in}} - T)/\\tau\n\\end{bmatrix}\n$$\nGiven the stiffness of the system, this integration must be performed with a stiff ODE solver, such as the Backward Differentiation Formula (BDF) method, available in `scipy.integrate.solve_ivp`.\n\n#### Strang Splitting Solution\nThe Strang splitting method approximates the solution by sequentially solving the subproblems for mixing and reaction. For a single time step of size $\\Delta t$, the state $\\mathbf{y}(t)$ is advanced to $\\mathbf{y}(t+\\Delta t)$ via three sequential operations:\n1.  **First Mixing Half-Step**: Advance the state by solving the mixing-only ODEs for a time step of $\\frac{\\Delta t}{2}$. We use the analytical solution derived above. Let $\\mathbf{y}^{(0)} = \\mathbf{y}(t)$. We compute $\\mathbf{y}^{(1)} = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)(\\mathbf{y}^{(0)})$.\n2.  **Reaction Full-Step**: Starting from $\\mathbf{y}^{(1)}$, integrate the reaction-only ODEs, $\\frac{d\\mathbf{y}}{dt} = \\mathbf{R}(\\mathbf{y})$, over a full time step $\\Delta t$. This subproblem, $\\frac{d\\mathbf{y}}{dt} = [-\\Omega, -s\\Omega, \\frac{\\Delta h}{c_p}\\Omega]^\\top$, is the stiff part of the system. It is solved numerically using a stiff solver. The result is $\\mathbf{y}^{(2)} = \\exp\\!\\left(\\Delta t \\,\\mathcal{R}\\right)(\\mathbf{y}^{(1)})$.\n3.  **Second Mixing Half-Step**: Advance the state $\\mathbf{y}^{(2)}$ by solving the mixing-only ODEs for another time step of $\\frac{\\Delta t}{2}$ using the analytical solution. The final state for the step is $\\mathbf{y}(t+\\Delta t) = \\mathbf{y}^{(3)} = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathcal{M}\\right)(\\mathbf{y}^{(2)})$.\n\nThis sequence is repeated for the total number of time steps, $N = t_{\\mathrm{end}} / \\Delta t$. This method is second-order accurate in $\\Delta t$, meaning the global error at a fixed final time is proportional to $(\\Delta t)^2$.\n\n### Part 4: Error Computation\n\nAfter computing the final state vectors for both the reference solution, $\\mathbf{y}_{\\mathrm{ref}}(t_{\\mathrm{end}})$, and the Strang splitting solution, $\\mathbf{y}_{\\mathrm{split}}(t_{\\mathrm{end}})$, the maximum componentwise relative error, $\\varepsilon_{\\max}$, is calculated according to the provided formula. This requires evaluating the relative error for each of the three components ($Y_F, Y_O, T$) and taking the maximum. The small regularization constant $\\epsilon=10^{-12}$ prevents division by zero if a reference component value is zero. The implementation will follow this definition precisely.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Meticulous and exacting professor's implementation of the PSR model integration.\n\ndef solve():\n    \"\"\"\n    Main driver function to execute the PSR model simulation for all test cases.\n    It implements a reference integrator and a Strang splitting integrator,\n    and computes the error between them for each case.\n    \"\"\"\n\n    # Global constants as specified in the problem statement.\n    CONSTS = {\n        'Ru': 8.314,       # J/mol/K\n        'cp': 1000.0,      # J/kg/K\n        'dh': 5.0e7,       # J/kg\n        's': 4.0,          # Stoichiometric oxidizer-to-fuel mass ratio\n        'a': 1.0,          # Fuel reaction order\n        'b': 1.0,          # Oxidizer reaction order\n    }\n    ERROR_REG = 1e-12\n\n    # Test cases defined as tuples of parameters.\n    # (A, E, tau, dt, t_end, Y_F0, Y_O0, T0, Y_Fin, Y_Oin, Tin)\n    test_cases = [\n        # Case 1 (happy path, mixing equal to the initial state)\n        (1.0e6, 1.0e5, 2.0e-2, 1.0e-4, 1.0e-2, 2.0e-2, 2.0e-1, 1.0e3, 2.0e-2, 2.0e-1, 1.0e3),\n        # Case 2 (competing mixing and reaction time scales)\n        (2.0e6, 1.1e5, 1.0e-2, 5.0e-4, 2.0e-2, 3.0e-2, 1.0e-1, 9.0e2, 0.0, 2.3e-1, 9.0e2),\n        # Case 3 (oxidizer-lean, reaction limited)\n        (5.0e6, 1.2e5, 5.0e-2, 2.0e-4, 1.0e-2, 2.0e-2, 1.0e-2, 1.2e3, 0.0, 5.0e-2, 1.2e3),\n        # Case 4 (single large time step equal to the horizon)\n        (5.0e5, 1.0e5, 2.0e-2, 5.0e-3, 5.0e-3, 1.5e-2, 2.1e-1, 1.1e3, 1.0e-2, 2.1e-1, 1.1e3),\n        # Case 5 (very small time step to test convergence of splitting)\n        (2.0e6, 1.1e5, 1.0e-2, 5.0e-6, 2.0e-2, 3.0e-2, 1.0e-1, 9.0e2, 0.0, 2.3e-1, 9.0e2),\n    ]\n\n    results = []\n\n    def Omega_rate(Y_F, Y_O, T, A, E, Ru, a, b):\n        \"\"\"Computes the global reaction rate Omega.\"\"\"\n        # Ensure mass fractions are non-negative for physical and numerical stability.\n        Y_F_clip = max(0.0, Y_F)\n        Y_O_clip = max(0.0, Y_O)\n        if T <= 0:\n            return 0.0\n        return A * (Y_F_clip**a) * (Y_O_clip**b) * np.exp(-E / (Ru * T))\n\n    def reaction_rhs(t, y, params):\n        \"\"\"RHS function for the reaction-only ODE system.\"\"\"\n        Y_F, Y_O, T = y\n        consts = params['consts']\n        # The Omega_rate function handles non-positive mass fractions by clipping.\n        omega = Omega_rate(Y_F, Y_O, T, params['A'], params['E'], consts['Ru'], consts['a'], consts['b'])\n        \n        dYF_dt = -omega\n        dYO_dt = -consts['s'] * omega\n        dT_dt = (consts['dh'] / consts['cp']) * omega\n        return np.array([dYF_dt, dYO_dt, dT_dt])\n\n    def coupled_rhs(t, y, params):\n        \"\"\"RHS function for the coupled (mixing + reaction) ODE system.\"\"\"\n        Y_F, Y_O, T = y\n        \n        # Reaction part\n        reaction_vector = reaction_rhs(t, y, params)\n        \n        # Mixing part\n        y_in = params['y_in']\n        tau = params['tau']\n        dYF_dt_mix = (y_in[0] - Y_F) / tau\n        dYO_dt_mix = (y_in[1] - Y_O) / tau\n        dT_dt_mix = (y_in[2] - T) / tau\n        mixing_vector = np.array([dYF_dt_mix, dYO_dt_mix, dT_dt_mix])\n        \n        return reaction_vector + mixing_vector\n\n    def analytical_mix_step(y, y_in, dt, tau):\n        \"\"\"Applies the analytical solution for the mixing-only step.\"\"\"\n        y_out = y_in + (y - y_in) * np.exp(-dt / tau)\n        return y_out\n\n    for case_params in test_cases:\n        A, E, tau, dt, t_end, Y_F0, Y_O0, T0, Y_Fin, Y_Oin, Tin = case_params\n        \n        y0 = np.array([Y_F0, Y_O0, T0])\n        y_in = np.array([Y_Fin, Y_Oin, Tin])\n        \n        params = {'A': A, 'E': E, 'tau': tau, 'y_in': y_in, 'consts': CONSTS}\n        \n        # --- 3) Reference Solution ---\n        # Integrate the full coupled system directly with a stiff solver.\n        t_span_ref = [0, t_end]\n        sol_ref = solve_ivp(\n            fun=coupled_rhs,\n            t_span=t_span_ref,\n            y0=y0,\n            method='BDF',\n            args=(params,),\n            dense_output=True,\n            rtol=1e-9,\n            atol=1e-12\n        )\n        y_ref_final = sol_ref.sol(t_end)\n\n        # --- 2) Strang Splitting Solution ---\n        y_split = np.copy(y0)\n        num_steps = int(round(t_end / dt))\n        \n        # If t_end is effectively zero, skip integration.\n        if num_steps > 0:\n            for _ in range(num_steps):\n                # First half-step of mixing\n                y_split = analytical_mix_step(y_split, y_in, dt / 2.0, tau)\n                \n                # Full step of reaction (numerically integrated)\n                t_span_react = [0, dt]\n                sol_react = solve_ivp(\n                    fun=reaction_rhs,\n                    t_span=t_span_react,\n                    y0=y_split,\n                    method='BDF',\n                    args=(params,),\n                    rtol=1e-9,\n                    atol=1e-12\n                )\n                y_split = sol_react.y[:, -1]\n                \n                # Second half-step of mixing\n                y_split = analytical_mix_step(y_split, y_in, dt / 2.0, tau)\n        \n        y_split_final = y_split\n\n        # --- 4) Error Calculation ---\n        diff = np.abs(y_split_final - y_ref_final)\n        denominator = np.maximum(np.abs(y_ref_final), ERROR_REG)\n        relative_errors = diff / denominator\n        max_rel_error = np.max(relative_errors)\n        \n        results.append(max_rel_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}