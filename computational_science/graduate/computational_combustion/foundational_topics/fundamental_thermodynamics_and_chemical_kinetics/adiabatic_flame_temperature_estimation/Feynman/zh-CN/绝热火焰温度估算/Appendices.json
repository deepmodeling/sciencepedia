{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，它将帮助你掌握绝热火焰温度估算的核心原理。通过应用热力学第一定律，即反应物和产物的焓守恒，我们可以推导出一个基本方程。 这个练习通过假设产物的平均热容为常数，将问题简化为代数求解，使你能够清晰地看到化学计量比（通过当量比 $\\phi$ 体现）和反应热如何直接影响最终的火焰温度。",
            "id": "4006482",
            "problem": "考虑一个完全搅拌、稳流、绝热、恒压的燃烧室，其中初始温度为 $T_0 = 298\\,\\mathrm{K}$ 的气态甲烷 $\\mathrm{CH_4}$ 与干燥空气进行燃烧。将所有气体视为理想气体，并忽略解离和辐射。干燥空气被建模为 $\\mathrm{O_2}$ 的摩尔分数为 $0.21$、$\\mathrm{N_2}$ 的摩尔分数为 $0.79$ 的混合物；为方便起见，假设 $\\mathrm{N_2}$ 以 $3.76\\,\\mathrm{mol\\,N_2/mol\\,O_2}$ 的固定摩尔比伴随 $\\mathrm{O_2}$。在 $298\\,\\mathrm{K}$ 时的标准摩尔生成焓为：$\\Delta h_f^\\circ(\\mathrm{CH_4(g)}) = -74.85\\,\\mathrm{kJ/mol}$，$\\Delta h_f^\\circ(\\mathrm{CO_2(g)}) = -393.52\\,\\mathrm{kJ/mol}$，$\\Delta h_f^\\circ(\\mathrm{H_2O(g)}) = -241.826\\,\\mathrm{kJ/mol}$，$\\Delta h_f^\\circ(\\mathrm{O_2(g)}) = 0$ 和 $\\Delta h_f^\\circ(\\mathrm{N_2(g)}) = 0$。在预期的火焰温度范围内，将产物组分的平均摩尔定压热容近似为常数：$c_{p,\\mathrm{CO_2}} = 50.0\\,\\mathrm{J/(mol\\cdot K)}$，$c_{p,\\mathrm{H_2O}} = 40.0\\,\\mathrm{J/(mol\\cdot K)}$，$c_{p,\\mathrm{O_2}} = 36.0\\,\\mathrm{J/(mol\\cdot K)}$ 和 $c_{p,\\mathrm{N_2}} = 34.0\\,\\mathrm{J/(mol\\cdot K)}$。\n\n将当量比 $\\phi$ 定义为实际燃料-氧化剂摩尔比与化学计量燃料-氧化剂摩尔比之比。对于一摩尔甲烷，化学计量的氧化剂需求量为 $2$ 摩尔 $\\mathrm{O_2}$。对于贫燃情况 $\\phi  1$，氧化剂进料为 $2/\\phi$ 摩尔的 $\\mathrm{O_2}$，并伴有 $(2/\\phi)\\times 3.76$ 摩尔的 $\\mathrm{N_2}$。\n\n从稳流反应器的热力学第一定律和理想气体混合物的焓定义出发，并使用元素守恒确定 $\\phi  1$ 时的产物组成，推导联系绝热火焰温度 $T_{\\mathrm{ad}}$ 与反应热释放及产物显焓升高的表达式。然后，对于 $\\phi = 0.80$ 的情况，在所述假设下数值计算 $T_{\\mathrm{ad}}$。\n\n以 $\\mathrm{K}$ 为单位表示最终温度，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导绝热火焰温度 $T_{\\mathrm{ad}}$ 的表达式，并对甲烷的贫燃情况进行数值计算。分析从稳流开放系统（控制体积）的热力学第一定律开始。\n\n对于一个没有轴功（$\\dot{W}_s = 0$）且没有热传递（$\\dot{Q} = 0$）的稳流、绝热、恒压燃烧室，热力学第一定律简化为焓守恒。进入燃烧室的反应物的总焓必须等于离开燃烧室的产物的总焓。以摩尔为基础，这表示为：\n$$\n\\sum_{\\text{reactants}} N_i \\bar{h}_i(T_R) = \\sum_{\\text{products}} N_j \\bar{h}_j(T_P)\n$$\n其中 $N_i$ 和 $N_j$ 分别是反应物组分 $i$ 和产物组分 $j$ 的摩尔数，$\\bar{h}$ 是摩尔焓。令 $H_R$ 为反应物的总焓，$H_P$ 为产物的总焓，因此 $H_R = H_P$。\n\n反应物处于初始温度 $T_R = T_0 = 298\\,\\mathrm{K}$，这是标准参考温度。产物处于最终绝热火焰温度 $T_P = T_{\\mathrm{ad}}$。\n\n在温度 $T$ 下，理想气体组分 $i$ 的绝对摩尔焓 $\\bar{h}_i(T)$ 是其在参考温度 $T_0$ 下的标准摩尔生成焓（记为 $\\Delta \\bar{h}_{f,i}^\\circ$）与其从 $T_0$ 到 $T$ 的显焓变化之和。\n$$\n\\bar{h}_i(T) = \\Delta \\bar{h}_{f,i}^\\circ + \\bar{h}_i(T) - \\bar{h}_i(T_0) = \\Delta \\bar{h}_{f,i}^\\circ + \\int_{T_0}^{T} \\bar{c}_{p,i}(T') dT'\n$$\n题目中说明假设平均摩尔定压热容 $\\bar{c}_{p,i}$ 为常数。因此，显焓项简化为 $\\bar{c}_{p,i}(T - T_0)$。\n\n对于处于 $T_R = T_0$ 的反应物，显焓项为零。因此，反应物的总焓是其生成焓之和：\n$$\nH_R = \\sum_{\\text{reactants}} N_i \\bar{h}_i(T_0) = \\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ\n$$\n\n对于处于 $T_P = T_{\\mathrm{ad}}$ 的产物，总焓为：\n$$\nH_P = \\sum_{\\text{products}} N_j \\bar{h}_j(T_{\\mathrm{ad}}) = \\sum_{\\text{products}} N_j \\left[ \\Delta \\bar{h}_{f,j}^\\circ + \\bar{c}_{p,j}(T_{\\mathrm{ad}} - T_0) \\right]\n$$\n$$\nH_P = \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ + \\left( \\sum_{\\text{products}} N_j \\bar{c}_{p,j} \\right) (T_{\\mathrm{ad}} - T_0)\n$$\n\n令反应物和产物的焓相等（$H_R = H_P$）：\n$$\n\\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ = \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ + \\left( \\sum_{\\text{products}} N_j \\bar{c}_{p,j} \\right) (T_{\\mathrm{ad}} - T_0)\n$$\n该表达式将绝热火焰温度与热释放和显焓升高联系起来。项 $\\left(\\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ - \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ\\right)$ 表示在标准温度 $T_0$ 下的反应热，它被释放并被产物吸收为显热。重新整理以求解 $T_{\\mathrm{ad}}$，得到所求的表达式：\n$$\nT_{\\mathrm{ad}} = T_0 + \\frac{\\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ - \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ}{\\sum_{\\text{products}} N_j \\bar{c}_{p,j}}\n$$\n这就完成了问题的第一部分。\n\n接下来，我们必须确定一摩尔甲烷（$\\mathrm{CH_4}$）在贫燃（$\\phi  1$）条件下反应物和产物的组成。化学计量反应为 $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$。化学计量燃料-氧化剂摩尔比是 $1/2$。实际燃料-氧化剂比由当量比定义给出 $\\phi = \\frac{(\\mathrm{F}/\\mathrm{A})_{\\text{actual}}}{(\\mathrm{F}/\\mathrm{A})_{\\text{stoich}}}$。这里，A 仅指 $\\mathrm{O_2}$。对于 $1$ 摩尔燃料，$\\mathrm{O_2}$ 的实际摩尔数为 $(1/\\phi) \\times 2$。因此，对于贫燃情况，每摩尔燃料供应的 $\\mathrm{O_2}$ 摩尔数为 $2/\\phi$，并伴有 $(2/\\phi) \\times 3.76$ 摩尔的 $\\mathrm{N_2}$。\n\n反应方程式为：\n$$\n\\mathrm{CH_4} + \\frac{2}{\\phi}(\\mathrm{O_2} + 3.76\\,\\mathrm{N_2}) \\rightarrow a\\,\\mathrm{CO_2} + b\\,\\mathrm{H_2O} + c\\,\\mathrm{O_2} + d\\,\\mathrm{N_2}\n$$\n进行元素平衡以找出产物的摩尔系数（$a, b, c, d$）：",
            "answer": "$$\\boxed{2.014 \\times 10^3}$$"
        },
        {
            "introduction": "在真实的燃烧过程中，气体的热容会随温度发生显著变化，这是一个不可忽略的因素。本练习将引导你使用工业界和学术界广泛应用的NASA七系数多项式来精确计算焓值，从而向更真实的火焰温度估算迈出重要一步。 你需要通过编程实现一个数值求根算法来求解能量平衡方程，这将锻炼你处理复杂热化学数据和解决非线性问题的核心工程能力。",
            "id": "4006481",
            "problem": "您的任务是推导并实现一个算法，使用通过美国国家航空航天局 (National Aeronautics and Space Administration, NASA) 七系数多项式表示的、随温度变化的热容，来计算碳氢化合物燃烧的绝热火焰温度。该情景为一个绝热、稳态、恒压的理想气体燃烧过程，无轴功输出，且动能和势能的变化可忽略不计。假设极限反应物完全燃烧生成二氧化碳和水蒸气，并将产物中任何过量的氧气、氮气或甲烷视为非反应组分。产物中的水被视作水蒸气。空气被模拟为按摩尔分数计含有 $21\\%$ 氧气和 $79\\%$ 氮气的混合物。\n\n从第一性原理出发，使用绝热过程的稳流能量方程，该方程意味着总摩尔焓守恒：\n$$\n\\sum_i n_{r,i}\\, h_i(T_0) \\;=\\; \\sum_j n_{p,j}\\, h_j(T_{\\mathrm{ad}})\n$$\n其中 $n_{r,i}$ 和 $n_{p,j}$ 分别是反应物组分 $i$ 和产物组分 $j$ 的摩尔量，$h_k(T)$ 是组分 $k$ 在温度 $T$ 下的摩尔焓，$T_0$ 是反应物入口温度，而 $T_{\\mathrm{ad}}$ 是待求的绝热火焰温度。\n\n使用 NASA 七系数多项式形式对每种组分的摩尔焓 $h(T)$ 进行建模。对于系数为 $\\{a_1,a_2,a_3,a_4,a_5,a_6,a_7\\}$ 且在特定温度范围内有效的给定组分，其无量纲热容和焓函数如下：\n$$\n\\frac{c_p(T)}{R} \\;=\\; a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4,\n$$\n$$\n\\frac{h(T)}{R\\,T} \\;=\\; a_1 + \\frac{a_2 T}{2} + \\frac{a_3 T^2}{3} + \\frac{a_4 T^3}{4} + \\frac{a_5 T^4}{5} + \\frac{a_6}{T},\n$$\n其中 $R$ 是通用气体常数。使用以下低温（$200\\,\\mathrm{K}$ 至 $1000\\,\\mathrm{K}$）和高温（$1000\\,\\mathrm{K}$ 至 $6000\\,\\mathrm{K}$）系数集的分段多项式。包含的组分有甲烷($\\mathrm{CH_4}$)、氧气($\\mathrm{O_2}$)、氮气($\\mathrm{N_2}$)、二氧化碳($\\mathrm{CO_2}$)和水蒸气($\\mathrm{H_2O}$)。\n\n对于 $\\mathrm{CH_4}$：\n- 低温：$[5.14987613,\\,-0.013671,\\;4.918005\\times 10^{-5},\\,-4.835016\\times 10^{-8},\\;1.753601\\times 10^{-11},\\,-10246.6476,\\,-4.641303]$\n- 高温：$[7.48514950,\\,-0.007243135,\\;2.225501\\times 10^{-6},\\,-3.102517\\times 10^{-10},\\;1.360730\\times 10^{-14},\\,-10602.047,\\,-14.0991]$\n\n对于 $\\mathrm{O_2}$：\n- 低温：$[3.78245636,\\,-0.002996734,\\;9.847302\\times 10^{-6},\\,-9.681295\\times 10^{-9},\\;3.243728\\times 10^{-12},\\,-1063.94356,\\;3.657675]$\n- 高温：$[3.28253784,\\;0.001483088,\\,-7.579666\\times 10^{-7},\\;2.094706\\times 10^{-10},\\,-2.167178\\times 10^{-14},\\,-1088.059,\\;5.453231]$\n\n对于 $\\mathrm{N_2}$：\n- 低温：$[3.53100528,\\,-0.0001236609,\\,-5.029994\\times 10^{-7},\\;2.435306\\times 10^{-9},\\,-1.408812\\times 10^{-12},\\,-1046.976,\\;2.967474]$\n- 高温：$[2.95257626,\\;0.001396901,\\,-4.926316\\times 10^{-7},\\;7.860103\\times 10^{-11},\\,-4.607553\\times 10^{-15},\\,-923.948,\\;5.871892]$\n\n对于 $\\mathrm{CO_2}$：\n- 低温：$[2.35677352,\\;0.008984596,\\,-7.123562\\times 10^{-6},\\;2.459190\\times 10^{-9},\\,-1.436995\\times 10^{-13},\\,-48371.96,\\;9.901052]$\n- 高温：$[3.85796028,\\;0.004414370,\\,-2.214814\\times 10^{-6},\\;5.234901\\times 10^{-10},\\,-4.720841\\times 10^{-14},\\,-48759.16,\\;2.271638]$\n\n对于 $\\mathrm{H_2O}$ (水蒸气)：\n- 低温：$[4.198640,\\,-0.002036434,\\;6.520402\\times 10^{-6},\\,-5.487970\\times 10^{-9},\\;1.771978\\times 10^{-12},\\,-30293.7267,\\,-0.849032208]$\n- 高温：$[3.03399249,\\;0.002176918,\\,-1.640725\\times 10^{-7},\\,-9.704198\\times 10^{-11},\\;1.682010\\times 10^{-14},\\,-30004.297,\\;4.966770]$\n\n使用 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。从 NASA 多项式计算出的焓 $h(T)$ 是基于一致参考标度的绝对摩尔焓；因此，在能量平衡中，您必须直接使用反应物在 $T_0$ 下和产物在 $T_{\\mathrm{ad}}$ 下的 $h(T)$ 值。\n\n将当量比 $\\phi$ 定义为：\n$$\n\\phi \\;=\\; \\frac{(F/O)_{\\mathrm{actual}}}{(F/O)_{\\mathrm{stoich}}},\n$$\n甲烷的化学计量关系为 $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$。对于给定的 $\\phi$ 和 $n_{\\mathrm{CH_4}}$ 摩尔的甲烷，计算入口氧气的摩尔数为：\n$$\nn_{\\mathrm{O_2,in}} \\;=\\; \\frac{2\\,n_{\\mathrm{CH_4}}}{\\phi},\n$$\n以及伴随的氮气摩尔数为：\n$$\nn_{\\mathrm{N_2,in}} \\;=\\; 3.7619 \\, n_{\\mathrm{O_2,in}}.\n$$\n通过极限反应物确定反应进度 $\\xi$：\n$$\n\\xi \\;=\\; \\min\\left(n_{\\mathrm{CH_4}},\\;\\frac{n_{\\mathrm{O_2,in}}}{2}\\right).\n$$\n产物组分则为：\n- $n_{\\mathrm{CO_2}} = \\xi$,\n- $n_{\\mathrm{H_2O}} = 2\\,\\xi$,\n- $n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2\\,\\xi$,\n- $n_{\\mathrm{CH_4,ex}} = n_{\\mathrm{CH_4}} - \\xi$,\n- $n_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}}$.\n\n实现一个求根算法来求解满足能量平衡方程的 $T_{\\mathrm{ad}}$。确保在一个覆盖碳氢化合物-空气燃烧的物理合理火焰温度（例如，从 $300\\,\\mathrm{K}$ 到 $4000\\,\\mathrm{K}$）的温度区间内进行稳健的区间限定，并在绝对焓残差小于 $10^{-3}\\ \\mathrm{J/mol}$ 或温度区间宽度小于 $10^{-6}\\ \\mathrm{K}$ 时终止。\n\n物理单位：输出温度必须以 $\\mathrm{K}$ 为单位表示，并四舍五入到两位小数。\n\n角度单位：不适用。\n\n百分比：不适用。\n\n您的程序必须生成单行输出，其中包含以下测试套件计算出的绝热火焰温度，格式为用方括号括起来的逗号分隔列表：\n- 案例 $1$：$n_{\\mathrm{CH_4}} = 1.0$ 摩尔，$\\phi = 1.0$，$T_0 = 298.15\\ \\mathrm{K}$。\n- 案例 $2$：$n_{\\mathrm{CH_4}} = 1.0$ 摩尔，$\\phi = 1.0$，$T_0 = 800.00\\ \\mathrm{K}$。\n- 案例 $3$：$n_{\\mathrm{CH_4}} = 1.0$ 摩尔，$\\phi = 0.80$，$T_0 = 298.15\\ \\mathrm{K}$。\n- 案例 $4$：$n_{\\mathrm{CH_4}} = 1.0$ 摩尔，$\\phi = 1.20$，$T_0 = 298.15\\ \\mathrm{K}$。\n\n最终输出格式规范：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[T_1,T_2,T_3,T_4]$），其中每个 $T_i$ 是以 $\\mathrm{K}$ 为单位并四舍五入到两位小数的绝热火焰温度，行内任何位置均无空格。",
            "solution": "该问题要求计算在特定条件下甲烷($\\mathrm{CH_4}$)与空气燃烧的绝热火焰温度 $T_{\\mathrm{ad}}$。这是一个经典的热力学问题，可通过将热力学第一定律应用于一个稳态、稳流、绝热、等压且无功相互作用的反应系统来求解。\n\n**1. 基本原理：焓守恒**\n\n对于一个动能和势能变化可忽略不计且无轴功输出的稳流绝热系统，热力学第一定律简化为总焓守恒。在温度 $T_0$ 下进入系统的反应物的总焓，必须等于在绝热火焰温度 $T_{\\mathrm{ad}}$ 下离开系统的产物的总焓。该原理表示为：\n$$\nH_{\\text{reactants}}(T_0) = H_{\\text{products}}(T_{\\mathrm{ad}})\n$$\n用摩尔量表示，该平衡关系为：\n$$\n\\sum_{i \\in \\text{reactants}} n_{r,i}\\, h_i(T_0) = \\sum_{j \\in \\text{products}} n_{p,j}\\, h_j(T_{\\mathrm{ad}})\n$$\n其中 $n_k$ 代表组分 $k$ 的摩尔数，$h_k(T)$ 是其在温度 $T$ 下的绝对摩尔焓。我们的目标是找到满足此方程的温度 $T_{\\mathrm{ad}}$。\n\n**2. 基于 NASA 多项式的摩尔焓**\n\n每种组分的绝对摩尔焓 $h(T)$ 采用 NASA 七系数多项式形式进行建模。为无量纲焓 $\\frac{h(T)}{RT}$ 提供的公式经整理可求解 $h(T)$：\n$$\nh(T) = R T \\left( a_1 + \\frac{a_2 T}{2} + \\frac{a_3 T^2}{3} + \\frac{a_4 T^3}{4} + \\frac{a_5 T^4}{5} + \\frac{a_6}{T} \\right)\n$$\n这里，$R$ 是通用气体常数（$8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$），$T$ 是以开尔文为单位的绝对温度，而 $\\{a_1, a_2, \\ldots, a_7\\}$ 是特定于组分的系数。对于每种组分，提供了两组系数：一组用于低温范围（$200\\,\\mathrm{K} \\le T  1000\\,\\mathrm{K}$），另一组用于高温范围（$1000\\,\\mathrm{K} \\le T \\le 6000\\,\\mathrm{K}$）。计算算法必须根据进行焓评估的温度 $T$ 来选择合适的系数集。\n\n**3. 化学计量与组分摩尔平衡**\n\n反应物和产物混合物的组成必须根据给定的当量比 $\\phi$ 来确定。所有计算均以 $n_{\\mathrm{CH_4}} = 1.0$ 摩尔的燃料为基准。\n\n甲烷在氧气中的化学计量燃烧反应为：\n$$\n\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}\n$$\n化学计量的燃料-氧气比为 $(F/O)_{\\mathrm{stoich}} = \\frac{n_{\\mathrm{CH_4}}}{n_{\\mathrm{O_2}}} = \\frac{1}{2}$。当量比 $\\phi$ 定义为实际燃料/氧气比除以化学计量比：\n$$\n\\phi = \\frac{(F/O)_{\\mathrm{actual}}}{(F/O)_{\\mathrm{stoich}}} = \\frac{n_{\\mathrm{CH_4}}/n_{\\mathrm{O_2,in}}}{1/2} = \\frac{2\\,n_{\\mathrm{CH_4}}}{n_{\\mathrm{O_2,in}}}\n$$\n由此，我们确定所供应的氧气摩尔数：\n$$\nn_{\\mathrm{O_2,in}} = \\frac{2\\,n_{\\mathrm{CH_4}}}{\\phi}\n$$\n空气按摩尔分数计由 $21\\%$ 的 $\\mathrm{O_2}$ 和 $79\\%$ 的 $\\mathrm{N_2}$ 组成，因此伴随的惰性氮气的摩尔数为：\n$$\nn_{\\mathrm{N_2,in}} = n_{\\mathrm{O_2,in}} \\times \\frac{0.79}{0.21} \\approx 3.7619 \\, n_{\\mathrm{O_2,in}}\n$$\n\n反应进度 $\\xi$ 由极限反应物决定。反应每进行一摩尔，消耗 $1$ 摩尔的 $\\mathrm{CH_4}$ 和 $2$ 摩尔的 $\\mathrm{O_2}$。最大可能进度为：\n$$\n\\xi = \\min\\left(n_{\\mathrm{CH_4,in}}, \\frac{n_{\\mathrm{O_2,in}}}{2}\\right)\n$$\n然后，假设极限反应物完全燃烧，产物组分的摩尔量计算如下：\n-   $\\mathrm{CO_2}$ 的摩尔数：$n_{\\mathrm{CO_2}} = \\xi$\n-   $\\mathrm{H_2O}$ 的摩尔数：$n_{\\mathrm{H_2O}} = 2\\xi$\n-   过量 $\\mathrm{O_2}$ 的摩尔数：$n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2\\xi$\n-   过量 $\\mathrm{CH_4}$ 的摩尔数：$n_{\\mathrm{CH_4,ex}} = n_{\\mathrm{CH_4,in}} - \\xi$\n-   $\\mathrm{N_2}$ 的摩尔数：$n_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}}$ (惰性)\n\n**4. 通过求根的算法求解**\n\n问题现在简化为求解以下非线性残差函数 $F(T)$ 的根 $T_{\\mathrm{ad}}$：\n$$\nF(T) = H_{\\text{products}}(T) - H_{\\text{reactants}}(T_0) = 0\n$$\n其中，对于给定的案例，$H_{\\text{reactants}}(T_0)$ 是一个常数值。\n\n算法流程如下：\n1.  对于每个测试案例（由 $\\phi$ 和 $T_0$ 定义，其中 $n_{\\mathrm{CH_4}}=1.0$）：\n    a.  计算所有反应物组分的摩尔量：$n_{\\mathrm{CH_4, in}}$、$n_{\\mathrm{O_2, in}}$、$n_{\\mathrm{N_2, in}}$。\n    b.  计算反应物混合物在初始温度 $T_0$ 下的总焓：$H_{\\text{reactants}}(T_0) = \\sum_{i} n_{r,i} h_i(T_0)$。\n    c.  计算所有产物组分的摩尔量：$n_{\\mathrm{CO_2}}$、$n_{\\mathrm{H_2O}}$、$n_{\\mathrm{O_2,ex}}$、$n_{\\mathrm{CH_4,ex}}$ 和 $n_{\\mathrm{N_2}}$。\n    d.  定义残差函数 $F(T)$，它计算产物混合物在给定温度 $T$ 下的总焓 $H_{\\text{products}}(T) = \\sum_{j} n_{p,j} h_j(T)$，并减去预先计算的 $H_{\\text{reactants}}(T_0)$。\n2.  使用数值求根算法求解 $F(T_{\\mathrm{ad}})=0$。像 Brent 方法这样的区间法是合适的，因为函数 $F(T)$ 是单调的，并且问题保证在区间 $[300\\,\\mathrm{K}, 4000\\,\\mathrm{K}]$ 内存在一个根。物理上的原因是，对于放热反应，$H_{\\text{products}}(T_0)  H_{\\text{reactants}}(T_0)$，因此 $F(T_0)  0$。随着产物温度升高，其显焓增加，确保 $F(T)$ 最终会变为正值。因此，`scipy.optimize.brentq` 是一个绝佳的选择。\n3.  找到的根 $T_{\\mathrm{ad}}$ 就是绝热火焰温度。然后根据要求将此值四舍五入到两位小数。\n4.  对所有测试案例重复此过程，并将结果汇编成指定的输出格式。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the adiabatic flame temperature for methane combustion.\n    \n    This function solves the energy balance equation for an adiabatic, constant-pressure\n    combustion process. It uses NASA 7-coefficient polynomials to model the\n    temperature-dependent enthalpy of each species. A root-finding algorithm\n    is employed to find the temperature at which the total enthalpy of the products\n    equals the total enthalpy of the reactants.\n    \"\"\"\n\n    # Universal Gas Constant in J/(mol*K)\n    R = 8.314462618\n\n    # NASA 7-coefficient polynomial data for each species.\n    # Format: {species: {'low': [a1..a7], 'high': [a1..a7]}}\n    nasa_coeffs = {\n        'CH4': {\n            'low': np.array([5.14987613, -0.013671, 4.918005e-05, -4.835016e-08, 1.753601e-11, -10246.6476, -4.641303]),\n            'high': np.array([7.48514950, -0.007243135, 2.225501e-06, -3.102517e-10, 1.360730e-14, -10602.047, -14.0991])\n        },\n        'O2': {\n            'low': np.array([3.78245636, -0.002996734, 9.847302e-06, -9.681295e-09, 3.243728e-12, -1063.94356, 3.657675]),\n            'high': np.array([3.28253784, 0.001483088, -7.579666e-07, 2.094706e-10, -2.167178e-14, -1088.059, 5.453231])\n        },\n        'N2': {\n            'low': np.array([3.53100528, -0.0001236609, -5.029994e-07, 2.435306e-09, -1.408812e-12, -1046.976, 2.967474]),\n            'high': np.array([2.95257626, 0.001396901, -4.926316e-07, 7.860103e-11, -4.607553e-15, -923.948, 5.871892])\n        },\n        'CO2': {\n            'low': np.array([2.35677352, 0.008984596, -7.123562e-06, 2.459190e-09, -1.436995e-13, -48371.96, 9.901052]),\n            'high': np.array([3.85796028, 0.004414370, -2.214814e-06, 5.234901e-10, -4.720841e-14, -48759.16, 2.271638])\n        },\n        'H2O': {\n            'low': np.array([4.198640, -0.002036434, 6.520402e-06, -5.487970e-09, 1.771978e-12, -30293.7267, -0.849032208]),\n            'high': np.array([3.03399249, 0.002176918, -1.640725e-07, -9.704198e-11, 1.682010e-14, -30004.297, 4.966770])\n        }\n    }\n\n    def get_molar_enthalpy(species, T):\n        \"\"\"Calculates molar enthalpy h(T) for a given species and temperature.\"\"\"\n        if T  1000.0:\n            coeffs = nasa_coeffs[species]['low']\n        else:\n            coeffs = nasa_coeffs[species]['high']\n        \n        a1, a2, a3, a4, a5, a6, _ = coeffs\n        \n        term1 = a1\n        term2 = a2 * T / 2\n        term3 = a3 * T**2 / 3\n        term4 = a4 * T**3 / 4\n        term5 = a5 * T**4 / 5\n        term6 = a6 / T\n        \n        h = R * T * (term1 + term2 + term3 + term4 + term5 + term6)\n        return h\n\n    # Test cases: (n_CH4, phi, T0)\n    test_cases = [\n        (1.0, 1.0, 298.15),   # Case 1\n        (1.0, 1.0, 800.00),   # Case 2\n        (1.0, 0.80, 298.15),  # Case 3\n        (1.0, 1.20, 298.15)   # Case 4\n    ]\n\n    results = []\n\n    for n_ch4_in, phi, T0 in test_cases:\n        # Step 1: Determine reactant composition\n        n_o2_in = 2.0 * n_ch4_in / phi\n        # N2/O2 ratio in air is 79/21\n        n_n2_in = n_o2_in * (79.0 / 21.0)\n        \n        reactants = {'CH4': n_ch4_in, 'O2': n_o2_in, 'N2': n_n2_in}\n\n        # Step 2: Calculate total enthalpy of reactants at T0\n        H_reactants = sum(n * get_molar_enthalpy(sp, T0) for sp, n in reactants.items())\n\n        # Step 3: Determine product composition\n        # Extent of reaction (xi) based on limiting reactant\n        xi = min(n_ch4_in, n_o2_in / 2.0)\n        \n        n_co2_out = xi\n        n_h2o_out = 2.0 * xi\n        n_o2_out = n_o2_in - 2.0 * xi\n        n_ch4_out = n_ch4_in - xi\n        n_n2_out = n_n2_in\n        \n        products = {\n            'CO2': n_co2_out, \n            'H2O': n_h2o_out,\n            'O2': n_o2_out,\n            'CH4': n_ch4_out,\n            'N2': n_n2_out\n        }\n\n        # Step 4: Define residual function for root-finding\n        def enthalpy_residual(T_ad):\n            \"\"\"Calculates H_products(T_ad) - H_reactants(T0).\"\"\"\n            H_products = sum(n * get_molar_enthalpy(sp, T_ad) \n                             for sp, n in products.items() if n > 0)\n            return H_products - H_reactants\n            \n        # Step 5: Solve for the adiabatic flame temperature (T_ad)\n        # The search interval [300 K, 4000 K] is physically reasonable.\n        try:\n            T_ad = brentq(enthalpy_residual, 300.0, 4000.0, xtol=1e-6, rtol=1e-8)\n            results.append(f\"{T_ad:.2f}\")\n        except ValueError:\n            # This should not happen if the problem is well-posed.\n            results.append(\"Error\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在极高的火焰温度下，“完全燃烧”的假设不再成立，产物会发生离解并生成新的物质，如氮氧化物（NO）和离子。本练习将带你进入更前沿的领域，通过耦合能量守恒与化学平衡来考虑这些高温效应。 你将需要建立并求解一个非线性方程组，同时处理热力学NO的生成和Saha电离平衡，从而得到更精确的“平衡”火焰温度。这项实践将显著提升你对复杂热化学系统建模和求解的能力。",
            "id": "4006472",
            "problem": "考虑一个经历绝热、恒压燃烧并达到热力学平衡的贫燃预混甲烷-空气火焰。目标是通过求解一个耦合非线性系统来估算绝热火焰温度，该系统强制满足能量守恒、元素守恒以及包括热力型氮氧化物和电离在内的高温现象的化学平衡。假设为理想气体混合物，并忽略二氧化碳和水的离解。\n\n从稳态、绝热、无轴功的一维流动的热力学第一定律出发，该定律意味着反应物的总焓等于产物的总焓。使用氮和氧的元素守恒以及理想气体平衡关系。考虑产物中包含以下组分：二氧化碳、水蒸气、氮气分子、氧气分子、一氧化氮、电离一氧化氮和电子。通过电离一氧化氮和电子的摩尔数相等来强制满足电中性。\n\n设燃料为甲烷，氧化剂为干空气，其中氧气摩尔分数为 $x_{\\mathrm{O_2}} = 0.2095$，氮气摩尔分数为 $x_{\\mathrm{N_2}} = 0.7905$。设全局当量比为 $\\phi \\in (0,1)$，因此混合物是贫燃的。使用一摩尔甲烷作为燃料基准。入口压力为 $p$（单位 $\\mathrm{Pa}$），入口温度为 $T_0$（单位 $\\mathrm{K}$）。入口氧气摩尔数为 $n_{\\mathrm{O_2,in}} = 2/\\phi$，入口氮气摩尔数为 $n_{\\mathrm{N_2,in}} = (x_{\\mathrm{N_2}}/x_{\\mathrm{O_2}})\\,n_{\\mathrm{O_2,in}}$。完全燃烧产物二氧化碳和水蒸气的摩尔数分别为 $n_{\\mathrm{CO_2}} = 1$ 和 $n_{\\mathrm{H_2O}} = 2$。初始过量氧气摩尔数为 $n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2$，对于 $\\phi  1$ 该值必须为正。\n\n设未知产物中一氧化氮的摩尔数为 $n_{\\mathrm{NO}}$，电离一氧化氮的摩尔数为 $n_{\\mathrm{NO^+}}$，电子的摩尔数为 $n_{e}$。通过 $n_{e} = n_{\\mathrm{NO^+}}$ 强制满足电中性。考虑到一氧化氮的生成及其电离，剩余产物中氧气分子和氮气分子的摩尔数可由元素守恒得出：\n$$\nn_{\\mathrm{O_2}} = n_{\\mathrm{O_2,ex}} - \\frac{n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}}}{2}, \\quad\nn_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}} - \\frac{n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}}}{2}.\n$$\n设总产物摩尔数为\n$$\nn_{\\mathrm{tot}} = n_{\\mathrm{CO_2}} + n_{\\mathrm{H_2O}} + n_{\\mathrm{N_2}} + n_{\\mathrm{O_2}} + n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}} + n_e.\n$$\n\n通过反应 $2\\,\\mathrm{NO} \\rightleftharpoons \\mathrm{N_2} + \\mathrm{O_2}$ 在理想气体定律下的平衡常数来施加化学平衡。对于此反应，以摩尔数表示的平衡常数与压力无关：\n$$\nK_p(T) = \\frac{n_{\\mathrm{N_2}}\\,n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2}.\n$$\n使用 van’t Hoff 形式来近似 $K_p(T)$，其中标准反应焓 $\\Delta H^\\circ$ 和熵 $\\Delta S^\\circ$ 与温度无关，因此\n$$\n\\ln K_p(T) = -\\frac{\\Delta G^\\circ(T)}{R\\,T}, \\quad \\Delta G^\\circ(T) = \\Delta H^\\circ - T\\,\\Delta S^\\circ,\n$$\n常数值为 $\\Delta H^\\circ = -180500\\,\\mathrm{J/mol}$ 和 $\\Delta S^\\circ = -24.74\\,\\mathrm{J/(mol\\cdot K)}$，其中 $R$ 是普适气体常数。\n\n通过反应 $\\mathrm{NO} \\rightleftharpoons \\mathrm{NO^+} + e^-$ 的 Saha 方程来施加一氧化氮的电离平衡。使用理想气体数密度，并将配分函数比近似为1，以摩尔分数 $y_i = n_i/n_{\\mathrm{tot}}$ 表示的 Saha 关系为\n$$\n\\frac{y_e\\,y_{\\mathrm{NO^+}}}{y_{\\mathrm{NO}}} = S(T)\\,\\frac{k_B\\,T}{p},\n$$\n其中 $S(T) = 2\\left(\\frac{2\\pi m_e k_B T}{h^2}\\right)^{3/2}\\exp\\left(-\\frac{E_{\\mathrm{ion}}}{k_B T}\\right)$, $m_e$ 是电子质量, $h$ 是 Planck 常数, $k_B$ 是 Boltzmann 常数, $E_{\\mathrm{ion}}$ 是一氧化氮的电离能, $E_{\\mathrm{ion}} = 9.26\\,\\mathrm{eV}$。\n\n设在 $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$ 时的标准生成焓为 $h_f^\\circ(\\mathrm{CH_4}) = -74850\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{CO_2}) = -393522\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{H_2O(g)}) = -241826\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{NO}) = 90250\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{NO^+}) = h_f^\\circ(\\mathrm{NO}) + 9.26\\times 96485\\,\\mathrm{J/mol}$, 对于 $\\mathrm{O_2}$, $\\mathrm{N_2}$ 和 $e^-$，$h_f^\\circ$ 等于 $0\\,\\mathrm{J/mol}$。使用线性温度依赖关系 $c_{p,i}(T) = a_i + b_i\\,T$ 来模拟各组分的等压热容，其系数 $(a_i,b_i)$ 的单位为 $\\mathrm{J/(mol\\cdot K)}$ 和 $\\mathrm{J/(mol\\cdot K^2)}$：\n$$\n\\begin{aligned}\n(\\mathrm{CO_2}): (a,b) = (37.0,\\,0.0030), \\quad (\\mathrm{H_2O}): (33.6,\\,0.0040), \\quad (\\mathrm{N_2}): (29.0,\\,0.0027),\\\\\n(\\mathrm{O_2}): (29.0,\\,0.0025), \\quad (\\mathrm{NO}): (30.0,\\,0.0030), \\quad (\\mathrm{NO^+}): (30.0,\\,0.0030),\\\\\n(\\mathrm{e^-}): (20.786,\\,0.0), \\quad (\\mathrm{CH_4}): (35.0,\\,0.0100).\n\\end{aligned}\n$$\n从 $T_{\\mathrm{ref}}$ 开始的显焓增量为 $\\Delta h_i(T;T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} c_{p,i}(T')\\,\\mathrm{d}T' = a_i\\,(T-T_{\\mathrm{ref}}) + \\frac{b_i}{2}\\,(T^2 - T_{\\mathrm{ref}}^2)$。\n\n设入口处的反应物焓值为\n$$\nH_{\\mathrm{in}} = n_{\\mathrm{CH_4}}\\left[h_f^\\circ(\\mathrm{CH_4}) + \\Delta h_{\\mathrm{CH_4}}(T_0;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{O_2,in}}\\left[0 + \\Delta h_{\\mathrm{O_2}}(T_0;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{N_2,in}}\\left[0 + \\Delta h_{\\mathrm{N_2}}(T_0;T_{\\mathrm{ref}})\\right],\n$$\n其中 $n_{\\mathrm{CH_4}} = 1$。产物焓值为\n$$\n\\begin{aligned}\nH_{\\mathrm{out}}(T,n_{\\mathrm{NO}},n_{\\mathrm{NO^+}}) =\nn_{\\mathrm{CO_2}}\\left[h_f^\\circ(\\mathrm{CO_2}) + \\Delta h_{\\mathrm{CO_2}}(T;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{H_2O}}\\left[h_f^\\circ(\\mathrm{H_2O}) + \\Delta h_{\\mathrm{H_2O}}(T;T_{\\mathrm{ref}})\\right]\\\\\n\\quad + n_{\\mathrm{N_2}}\\left[0 + \\Delta h_{\\mathrm{N_2}}(T;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{O_2}}\\left[0 + \\Delta h_{\\mathrm{O_2}}(T;T_{\\mathrm{ref}})\\right]\\\\\n\\quad + n_{\\mathrm{NO}}\\left[h_f^\\circ(\\mathrm{NO}) + \\Delta h_{\\mathrm{NO}}(T;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{NO^+}}\\left[h_f^\\circ(\\mathrm{NO^+}) + \\Delta h_{\\mathrm{NO^+}}(T;T_{\\mathrm{ref}})\\right]\\\\\n\\quad + n_{e}\\left[0 + \\Delta h_{e}(T;T_{\\mathrm{ref}})\\right].\n\\end{aligned}\n$$\n绝热火焰温度 $T_{\\mathrm{ad}}$ 和产物组分 $(n_{\\mathrm{NO}},n_{\\mathrm{NO^+}})$ 满足非线性系统\n$$\n\\begin{cases}\nK_p(T) - \\dfrac{n_{\\mathrm{N_2}}\\,n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2} = 0,\\\\[1em]\n\\dfrac{y_e\\,y_{\\mathrm{NO^+}}}{y_{\\mathrm{NO}}} - S(T)\\,\\dfrac{k_B T}{p} = 0,\\\\[1em]\nH_{\\mathrm{out}}(T,n_{\\mathrm{NO}},n_{\\mathrm{NO^+}}) - H_{\\mathrm{in}} = 0,\n\\end{cases}\n$$\n其中 $y_i = n_i/n_{\\mathrm{tot}}$ 且 $n_e = n_{\\mathrm{NO^+}}$。所有组分的摩尔数必须为非负数，且 $n_{\\mathrm{O_2}} \\ge 0$。\n\n实现一个程序来数值求解该系统，得到绝热火焰温度，并为每个测试用例只返回火焰温度。使用以下具有指定输入 $(\\phi, p, T_0)$ 的测试套件：\n- 案例1：$\\phi = 0.85$, $p = 100000\\,\\mathrm{Pa}$, $T_0 = 298.15\\,\\mathrm{K}$。\n- 案例2：$\\phi = 0.70$, $p = 100000\\,\\mathrm{Pa}$, $T_0 = 298.15\\,\\mathrm{K}$。\n- 案例3：$\\phi = 0.85$, $p = 5000000\\,\\mathrm{Pa}$, $T_0 = 298.15\\,\\mathrm{K}$。\n- 案例4：$\\phi = 0.85$, $p = 100000\\,\\mathrm{Pa}$, $T_0 = 800.00\\,\\mathrm{K}$。\n\n您的程序应生成一行输出，其中包含绝热火焰温度（单位为 $\\mathrm{K}$，四舍五入到一位小数），形式为方括号括起来的逗号分隔列表，例如 $[T_1,T_2,T_3,T_4]$。",
            "solution": "用户提供了一个具有科学依据且定义明确的计算燃烧学问题。任务是通过数值求解一个代表能量守恒、元素守恒和化学平衡的耦合非线性方程组，来确定贫燃甲烷-空气混合物的绝热火焰温度。该问题是有效的，将提供一个完整的解决方案。\n\n### 问题建模与控制方程\n\n热力学平衡时产物气体的状态由绝热火焰温度 $T$ 和产物组分的摩尔数描述。根据问题陈述，该系统由三个未知数确定：温度 $T$、一氧化氮摩尔数 $n_{\\mathrm{NO}}$ 和电离一氧化氮摩尔数 $n_{\\mathrm{NO^+}}$。所有其他产物摩尔数可以从这三个变量和初始反应物组分中推导出来。因此，问题是求解一个包含三个未知数的三个非线性方程组的根，$\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$，其中 $\\mathbf{x} = (T, n_{\\mathrm{NO}}, n_{\\mathrm{NO^+}})$。\n\n三个控制方程是：\n1.  **热力型NO平衡**：反应 $2\\,\\mathrm{NO} \\rightleftharpoons \\mathrm{N_2} + \\mathrm{O_2}$ 的平衡由平衡常数 $K_p(T)$ 给出。\n2.  **NO电离平衡**：一氧化氮的电离反应 $\\mathrm{NO} \\rightleftharpoons \\mathrm{NO^+} + e^-$ 由 Saha 方程描述。\n3.  **能量守恒**：对于绝热、恒压过程，热力学第一定律要求温度为 $T$ 的产物焓等于温度为 $T_0$ 的反应物焓。\n\n让我们来定义向量函数 $\\mathbf{F}$ 的分量。\n\n**变量与派生量**\n我们选择数值求解器的自变量以增强稳定性。摩尔数可以跨越多个数量级，并且必须为正。因此，我们求解温度 $T$、一氧化氮摩尔数的自然对数 $u_1 = \\ln(n_{\\mathrm{NO}})$ 和电离一氧化氮摩尔数的自然对数 $u_2 = \\ln(n_{\\mathrm{NO^+}})$。我们的状态向量是 $\\mathbf{x} = (T, u_1, u_2)$。这种变换确保了 $n_{\\mathrm{NO}} = \\exp(u_1)$ 和 $n_{\\mathrm{NO^+}} = \\exp(u_2)$ 始终为正。\n\n对于给定的输入集 $(\\phi, p, T_0)$ 和状态向量 $\\mathbf{x}$，我们计算派生量：\n- 反应物摩尔数：$n_{\\mathrm{CH_4}} = 1$, $n_{\\mathrm{O_2,in}} = 2/\\phi$, $n_{\\mathrm{N_2,in}} = (x_{\\mathrm{N_2}}/x_{\\mathrm{O_2}}) n_{\\mathrm{O_2,in}} \\approx 3.7733\\, n_{\\mathrm{O_2,in}}$。\n- 过量氧气：$n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2$。\n- 产物摩尔数：\n    - $n_{\\mathrm{NO}} = \\exp(u_1)$, $n_{\\mathrm{NO^+}} = \\exp(u_2)$。\n    - $n_e = n_{\\mathrm{NO^+}}$ (电中性)。\n    - $n_{\\mathrm{CO_2}} = 1$, $n_{\\mathrm{H_2O}} = 2$。\n    - $n_{\\mathrm{O_2}} = n_{\\mathrm{O_2,ex}} - (n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}})/2$。\n    - $n_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}} - (n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}})/2$。\n    - $n_{\\mathrm{tot}} = 1 + n_{\\mathrm{H_2O}} + n_{\\mathrm{O_2}} + n_{\\mathrm{N_2}} + n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}} + n_e = 1 + n_{\\mathrm{O_2,in}} + n_{\\mathrm{N_2,in}} + n_{\\mathrm{NO^+}}$。\n\n**残差方程**\n为了提高数值稳定性，我们以对数形式构建平衡方程。需要驱动为零的三个残差函数是：\n\n1.  **NO平衡残差, $F_0$**：\n    从 $K_p(T) = \\frac{n_{\\mathrm{N_2}} n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2}$，我们对两边取自然对数：\n    $$F_0(T, u_1, u_2) = \\ln(K_p(T)) - \\ln\\left(\\frac{n_{\\mathrm{N_2}} n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2}\\right) = \\ln(K_p(T)) - (\\ln(n_{\\mathrm{N_2}}) + \\ln(n_{\\mathrm{O_2}}) - 2u_1) = 0$$\n    其中 $\\ln(K_p(T)) = -(\\Delta H^\\circ - T\\Delta S^\\circ)/(RT) = -\\Delta H^\\circ/(RT) + \\Delta S^\\circ/R$。\n\n2.  **Saha平衡残差, $F_1$**：\n    从 $\\frac{y_e y_{\\mathrm{NO^+}}}{y_{\\mathrm{NO}}} = S(T)\\frac{k_B T}{p}$，我们代入 $y_i = n_i/n_{\\mathrm{tot}}$ 和 $n_e = n_{\\mathrm{NO^+}}$：\n    $\\frac{(n_{\\mathrm{NO^+}}/n_{\\mathrm{tot}})^2}{n_{\\mathrm{NO}}/n_{\\mathrm{tot}}} = \\frac{n_{\\mathrm{NO^+}}^2}{n_{\\mathrm{NO}} n_{\\mathrm{tot}}} = S(T)\\frac{k_B T}{p}$。\n    取自然对数：\n    $$F_1(T, u_1, u_2) = 2\\ln(n_{\\mathrm{NO^+}}) - \\ln(n_{\\mathrm{NO}}) - \\ln(n_{\\mathrm{tot}}) - \\ln\\left(S(T)\\frac{k_B T}{p}\\right) = 2u_2 - u_1 - \\ln(n_{\\mathrm{tot}}) - \\ln\\left(S(T)\\frac{k_B T}{p}\\right) = 0$$\n    其中 $S(T) = 2\\left(\\frac{2\\pi m_e k_B T}{h^2}\\right)^{3/2}\\exp\\left(-\\frac{E_{\\mathrm{ion}}}{k_B T}\\right)$。\n\n3.  **能量平衡残差, $F_2$**：\n    这基于第一定律, $H_{\\mathrm{out}}(T, n_{\\mathrm{NO}}, n_{\\mathrm{NO^+}}) = H_{\\mathrm{in}}(T_0)$。\n    $$F_2(T, u_1, u_2) = H_{\\mathrm{out}}(T, \\exp(u_1), \\exp(u_2)) - H_{\\mathrm{in}}(T_0) = 0$$\n    反应物焓 $H_{\\mathrm{in}}$ 和产物焓 $H_{\\mathrm{out}}$ 按物种焓的总和计算, $H = \\sum_i n_i h_i(T)$。每个物种的焓是其在 $T_{\\mathrm{ref}}$ 的标准生成焓与其从 $T_{\\mathrm{ref}}$ 到指定温度的显焓变化之和：$h_i(T) = h_{f,i}^\\circ + \\Delta h_i(T; T_{\\mathrm{ref}})$。\n    显焓通过对给定的线性热容函数积分计算：\n    $$\\Delta h_i(T; T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} c_{p,i}(T')\\,\\mathrm{d}T' = a_i(T-T_{\\mathrm{ref}}) + \\frac{b_i}{2}(T^2 - T_{\\mathrm{ref}}^2)$$\n\n### 数值求解策略\n\n系统 $\\mathbf{F}(T, u_1, u_2) = \\mathbf{0}$ 将使用数值求根算法求解。`scipy.optimize.root` 函数实现了一种鲁棒的准牛顿方法，非常适合此任务。\n\n总体算法如下：\n1.  定义问题陈述中提供的所有物理和热化学常数。\n2.  对于每个测试案例 $(\\phi, p, T_0)$：\n    a.  预先计算恒定的反应物性质：$n_{\\mathrm{O_2,in}}$、$n_{\\mathrm{N_2,in}}$、$n_{\\mathrm{O_2,ex}}$ 和总反应物焓 $H_{\\mathrm{in}}(T_0)$。\n    b.  定义残差函数 $\\mathbf{F}(\\mathbf{x})$，该函数接受向量 $\\mathbf{x}=(T, u_1, u_2)$ 并返回残差向量 $(F_0, F_1, F_2)$。此函数将使用预先计算的反应物性质。\n    c.  在残差函数内部，我们必须确保摩尔数 $n_{\\mathrm{O_2}}$ 和 $n_{\\mathrm{N_2}}$ 保持为正，这是对数项和物理有效性所要求的。如果它们变为非正数，则返回一个大的惩罚值，以引导求解器避开这个非物理区域。\n    d.  为求解器提供一个合理的初始猜测值。基于典型的贫燃甲烷-空气燃烧，初始温度猜测值 $T_g \\approx 2100\\,\\mathrm{K}$ 是合适的。$n_{\\mathrm{NO}}$ 和 $n_{\\mathrm{NO^+}}$ 的摩尔数预计很小，对应于 $u_1$ 和 $u_2$ 的负值。基于初步估计，选择初始猜测值 $\\mathbf{x}_g = (2100, -6, -25)$。\n    e.  调用 `scipy.optimize.root` 找到解向量 $\\mathbf{x}^*$。\n    f.  解向量的第一个元素 $T^*$ 是绝热火焰温度。\n3.  收集所有测试案例的结果温度，将它们格式化为一位小数，并以指定的列表格式打印。\n\n这种结构化方法确保了问题中复杂的、耦合的物理过程被转化为一个性态良好的数值系统，可以高效、准确地求解。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.constants import k, h, m_e, R\n\ndef solve():\n    \"\"\"\n    Main function to solve for adiabatic flame temperature for a set of test cases.\n    \"\"\"\n    # Physical and chemical constants\n    CONSTS = {\n        'x_O2': 0.2095,\n        'x_N2': 0.7905,\n        'T_ref': 298.15,  # K\n        'R': R,  # J/(mol*K)\n        'k_B': k,  # J/K\n        'h': h,  # J*s\n        'm_e': m_e,  # kg\n        'E_ion_eV': 9.26,  # eV\n        'eV_to_J': 1.602176634e-19,  # J/eV\n        'F': 96485.0,  # J/mol/eV (approx. Faraday constant)\n        'dH_NO_rxn': -180500.0,  # J/mol\n        'dS_NO_rxn': -24.74,  # J/(mol*K)\n    }\n    CONSTS['E_ion_J'] = CONSTS['E_ion_eV'] * CONSTS['eV_to_J']\n\n    # Standard enthalpies of formation (J/mol) at T_ref\n    HF_O = {\n        'CH4': -74850.0, 'CO2': -393522.0, 'H2O': -241826.0,\n        'NO': 90250.0, 'O2': 0.0, 'N2': 0.0, 'e-': 0.0\n    }\n    HF_O['NO+'] = HF_O['NO'] + CONSTS['E_ion_eV'] * CONSTS['F']\n\n    # Heat capacity coefficients c_p(T) = a + bT; a in J/(mol*K), b in J/(mol*K^2)\n    CP_COEFFS = {\n        'CH4': (35.0, 0.0100), 'CO2': (37.0, 0.0030), 'H2O': (33.6, 0.0040),\n        'N2': (29.0, 0.0027), 'O2': (29.0, 0.0025), 'NO': (30.0, 0.0030),\n        'NO+': (30.0, 0.0030), 'e-': (20.786, 0.0)\n    }\n\n    test_cases = [\n        # (phi, p (Pa), T0 (K))\n        (0.85, 100000.0, 298.15),\n        (0.70, 100000.0, 298.15),\n        (0.85, 5000000.0, 298.15),\n        (0.85, 100000.0, 800.00),\n    ]\n\n    results = []\n    for phi, p, T0 in test_cases:\n        residual_func = create_residual_function(phi, p, T0, CONSTS, HF_O, CP_COEFFS)\n        \n        # Initial guess: [T (K), ln(n_NO), ln(n_NO+)]\n        x_guess = np.array([2100.0, -6.0, -25.0])\n        \n        # Levenberg-Marquardt ('lm') can be more robust for some problems\n        sol = root(residual_func, x_guess, method='hybr', tol=1e-8)\n        \n        if sol.success:\n            T_ad = sol.x[0]\n            results.append(f\"{T_ad:.1f}\")\n        else:\n            # Fallback for failed convergence, though not expected for these cases\n            results.append(\"NaN\")\n            \n    print(f\"[{','.join(results)}]\")\n\ndef create_residual_function(phi, p, T0, consts, hf_o, cp_coeffs):\n    \"\"\"\n    Factory function to create a residual function with problem parameters encapsulated.\n    \"\"\"\n    T_ref = consts['T_ref']\n\n    def sensible_enthalpy(T, species):\n        a, b = cp_coeffs[species]\n        return a * (T - T_ref) + 0.5 * b * (T**2 - T_ref**2)\n\n    # Reactant properties\n    n_CH4 = 1.0\n    n_O2_in = 2.0 / phi\n    n_N2_in = n_O2_in * (consts['x_N2'] / consts['x_O2'])\n    n_O2_ex = n_O2_in - 2.0\n    n_tot_in = n_CH4 + n_O2_in + n_N2_in\n\n    # Reactant enthalpy (constant for a given case)\n    H_in = (\n        n_CH4 * (hf_o['CH4'] + sensible_enthalpy(T0, 'CH4')) +\n        n_O2_in * sensible_enthalpy(T0, 'O2') +\n        n_N2_in * sensible_enthalpy(T0, 'N2')\n    )\n\n    def residual(x):\n        T, u1, u2 = x\n        \n        if T = 0:\n            return np.array([1e6, 1e6, 1e6])\n\n        n_NO = np.exp(u1)\n        n_NO_plus = np.exp(u2)\n        n_e = n_NO_plus\n\n        # Product mole numbers from element conservation\n        n_sum_NOx = n_NO + n_NO_plus\n        n_O2 = n_O2_ex - 0.5 * n_sum_NOx\n        n_N2 = n_N2_in - 0.5 * n_sum_NOx\n        \n        # Physicality constraints\n        if n_O2 = 0 or n_N2 = 0:\n            return np.array([1e6, 1e6, 1e6])\n\n        n_CO2 = 1.0\n        n_H2O = 2.0\n        n_tot = n_tot_in + n_NO_plus\n        \n        # --- Residual F0: Thermal NO equilibrium ---\n        ln_Kp_NO = -consts['dH_NO_rxn'] / (consts['R'] * T) + consts['dS_NO_rxn'] / consts['R']\n        F0 = ln_Kp_NO - (np.log(n_N2) + np.log(n_O2) - 2 * u1)\n        \n        # --- Residual F1: Saha ionization equilibrium ---\n        # S(T)*k*T/p term\n        S_T_term = 2.0 * ((2 * np.pi * consts['m_e'] * consts['k_B'] * T) / (consts['h']**2))**1.5\n        saha_factor = S_T_term * np.exp(-consts['E_ion_J'] / (consts['k_B'] * T)) * (consts['k_B'] * T / p)\n        \n        if saha_factor = 0:\n            return np.array([1e6, 1e6, 1e6])\n            \n        ln_saha = np.log(saha_factor)\n        F1 = (2 * u2 - u1 - np.log(n_tot)) - ln_saha\n\n        # --- Residual F2: Energy balance ---\n        product_species = ['CO2', 'H2O', 'N2', 'O2', 'NO', 'NO+', 'e-']\n        product_moles = [n_CO2, n_H2O, n_N2, n_O2, n_NO, n_NO_plus, n_e]\n        \n        H_out = 0.0\n        for i, species in enumerate(product_species):\n            n_i = product_moles[i]\n            h_i = hf_o[species] + sensible_enthalpy(T, species)\n            H_out += n_i * h_i\n            \n        F2 = H_out - H_in\n        \n        return np.array([F0, F1, F2])\n\n    return residual\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}