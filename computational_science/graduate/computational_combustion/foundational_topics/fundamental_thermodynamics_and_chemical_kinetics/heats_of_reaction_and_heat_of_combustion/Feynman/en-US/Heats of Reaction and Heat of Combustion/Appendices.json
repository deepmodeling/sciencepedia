{
    "hands_on_practices": [
        {
            "introduction": "The starting point for any energy analysis in combustion is to determine the heat released under standardized conditions. This exercise applies Hess's Law, a cornerstone of thermochemistry, to calculate the standard heat of combustion, $\\Delta H_c^\\circ$, from tabulated standard enthalpies of formation, $\\Delta H_f^\\circ$. This practice solidifies the fundamental method for quantifying reaction energy and introduces the crucial engineering skill of validating computational results against high-fidelity experimental data.",
            "id": "4029853",
            "problem": "A computational combustion model for hydrocarbon fuels requires accurate standard molar heats of combustion to close the energy equation and to calibrate reaction mechanisms. Consider the complete combustion of benzene at standard conditions ($298.15$ K, $1$ atm) to carbon dioxide and liquid water. Treat benzene in its standard liquid state. Use the thermochemical definition of standard molar enthalpy of formation and the fact that enthalpy is a state function, together with stoichiometric conservation, to determine the standard molar heat of combustion.\n\nThe balanced reaction is\n$$\\mathrm{C_6H_6(l) + \\tfrac{15}{2}\\,O_2(g) \\to 6\\,CO_2(g) + 3\\,H_2O(l)}.$$\n\nUse the following standard molar enthalpies of formation at $298.15$ K:\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{CO_2(g)}\\right) = -393.509$ kJ/mol,\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(l)}\\right) = -285.830$ kJ/mol,\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{C_6H_6(l)}\\right) = +49.0$ kJ/mol,\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{O_2(g)}\\right) = 0$ kJ/mol.\n\nCompute the standard molar heat of combustion $\\Delta H_c^\\circ$ of benzene for the reaction above. Then, verify your computed value against the National Institute of Standards and Technology (NIST) recommended value of $-3268.0$ kJ/mol at $298.15$ K by briefly explaining potential reasons for any deviation that may arise from using tabulated formation data. Express the final energy in kJ/mol and round your answer to four significant figures.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. It is a standard application of fundamental principles of thermochemistry and is free of any invalidating flaws. Therefore, a solution can be derived.\n\nThe standard molar heat of combustion, $\\Delta H_c^\\circ$, is a specific type of standard enthalpy of reaction, $\\Delta H_{rxn}^\\circ$. According to Hess's Law, the enthalpy change of a reaction is independent of the path taken. This principle allows for the calculation of the standard enthalpy change of a reaction from the standard molar enthalpies of formation, $\\Delta H_f^\\circ$, of the products and reactants. Enthalpy is a state function, which underlies this law.\n\nThe general formula is:\n$$ \\Delta H_c^\\circ = \\sum_p \\nu_p \\Delta H_f^\\circ(\\text{products}) - \\sum_r \\nu_r \\Delta H_f^\\circ(\\text{reactants}) $$\nwhere $\\nu_p$ and $\\nu_r$ are the stoichiometric coefficients of the products and reactants, respectively.\n\nThe balanced chemical equation for the complete combustion of liquid benzene is given as:\n$$ \\mathrm{C_6H_6(l) + \\tfrac{15}{2}\\,O_2(g) \\to 6\\,CO_2(g) + 3\\,H_2O(l)} $$\n\nFrom this equation, we identify the reactants, products, and their respective stoichiometric coefficients:\nReactants:\n- $\\mathrm{C_6H_6(l)}$: $\\nu_{\\mathrm{C_6H_6}} = 1$\n- $\\mathrm{O_2(g)}$: $\\nu_{\\mathrm{O_2}} = \\frac{15}{2} = 7.5$\n\nProducts:\n- $\\mathrm{CO_2(g)}$: $\\nu_{\\mathrm{CO_2}} = 6$\n- $\\mathrm{H_2O(l)}$: $\\nu_{\\mathrm{H_2O}} = 3$\n\nThe standard molar enthalpies of formation, $\\Delta H_f^\\circ$, at $298.15 \\, \\mathrm{K}$ are provided:\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{CO_2(g)}\\right) = -393.509 \\, \\mathrm{kJ/mol}$\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(l)}\\right) = -285.830 \\, \\mathrm{kJ/mol}$\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{C_6H_6(l)}\\right) = +49.0 \\, \\mathrm{kJ/mol}$\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{O_2(g)}\\right) = 0 \\, \\mathrm{kJ/mol}$ (by definition for an element in its standard state)\n\nWe apply the formula for $\\Delta H_c^\\circ$:\n$$ \\Delta H_c^\\circ = \\left[ 6 \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{CO_2(g)}\\right) + 3 \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(l)}\\right) \\right] - \\left[ 1 \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{C_6H_6(l)}\\right) + \\tfrac{15}{2} \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{O_2(g)}\\right) \\right] $$\n\nFirst, let's calculate the sum of the enthalpies of formation for the products, scaled by their stoichiometric coefficients:\n$$ \\sum_p \\nu_p \\Delta H_f^\\circ(\\text{products}) = 6 \\, \\mathrm{mol} \\times (-393.509 \\, \\mathrm{kJ/mol}) + 3 \\, \\mathrm{mol} \\times (-285.830 \\, \\mathrm{kJ/mol}) $$\n$$ \\sum_p \\nu_p \\Delta H_f^\\circ(\\text{products}) = (-2361.054 \\, \\mathrm{kJ}) + (-857.490 \\, \\mathrm{kJ}) = -3218.544 \\, \\mathrm{kJ} $$\n\nNext, we calculate the sum for the reactants:\n$$ \\sum_r \\nu_r \\Delta H_f^\\circ(\\text{reactants}) = 1 \\, \\mathrm{mol} \\times (+49.0 \\, \\mathrm{kJ/mol}) + \\tfrac{15}{2} \\, \\mathrm{mol} \\times (0 \\, \\mathrm{kJ/mol}) $$\n$$ \\sum_r \\nu_r \\Delta H_f^\\circ(\\text{reactants}) = 49.0 \\, \\mathrm{kJ} + 0 \\, \\mathrm{kJ} = 49.0 \\, \\mathrm{kJ} $$\n\nNow, we compute the standard molar heat of combustion:\n$$ \\Delta H_c^\\circ = (-3218.544 \\, \\mathrm{kJ}) - (49.0 \\, \\mathrm{kJ}) $$\n$$ \\Delta H_c^\\circ = -3267.544 \\, \\mathrm{kJ} $$\nThis value is for the combustion of $1$ mole of benzene as written in the reaction. Therefore, the standard molar heat of combustion is $-3267.544 \\, \\mathrm{kJ/mol}$.\n\nThe problem requires rounding the final answer to four significant figures.\n$$ \\Delta H_c^\\circ \\approx -3268 \\, \\mathrm{kJ/mol} $$\n\nThe second part of the problem asks for a comparison of this computed value with the NIST recommended value of $-3268.0 \\, \\mathrm{kJ/mol}$ and an explanation for any deviation.\nOur calculated value, $-3267.544 \\, \\mathrm{kJ/mol}$, is extremely close to the NIST value. The difference is $-3268.0 - (-3267.544) = -0.456 \\, \\mathrm{kJ/mol}$. When rounded to four significant figures, our value becomes $-3268 \\, \\mathrm{kJ/mol}$, which matches the integer part of the NIST value. The small deviation can be attributed to several factors inherent in thermochemical calculations:\n1.  **Experimental Uncertainty**: The standard enthalpies of formation used as input are experimentally determined quantities, each with an associated measurement uncertainty. These uncertainties propagate through the calculation. For example, the value for $\\Delta H_f^\\circ(\\mathrm{C_6H_6(l)})$ is given as $+49.0 \\, \\mathrm{kJ/mol}$, with only one decimal place, suggesting lower precision compared to the other values.\n2.  **Internal Consistency of Data**: The NIST recommended value for $\\Delta H_c^\\circ(\\mathrm{C_6H_6(l)})$ is part of a large, internally consistent thermochemical network. This database is globally optimized to minimize discrepancies over thousands of species and reactions. The individual $\\Delta H_f^\\circ$ values used in our calculation may originate from different experiments or evaluations and may not be perfectly consistent with the specific set used by NIST to derive its final recommended value.\n3.  **Direct vs. Indirect Determination**: The NIST value for the heat of combustion may be based on high-precision direct measurements, such as bomb calorimetry of benzene combustion. Such direct measurements are often more accurate for a specific reaction than values calculated indirectly from the heats of formation of other compounds, as was done here. The Hess's Law calculation is fundamentally sound, but its accuracy is limited by the accuracy of the input data.\n\nThe very close agreement between the calculated value and the NIST benchmark validates the quality of the provided formation enthalpy data and the application of Hess's Law.\nThe final requested value is the computed heat of combustion, rounded to four significant figures.\nComputed value: $-3267.544 \\, \\mathrm{kJ/mol}$.\nRounded value: $-3268 \\, \\mathrm{kJ/mol}$.",
            "answer": "$$\\boxed{-3268}$$"
        },
        {
            "introduction": "While the standard heat of combustion is a useful benchmark, real combustion processes occur over a wide range of temperatures, necessitating a method to find the heat of reaction at any arbitrary state. This practice integrates Hess's law with Kirchhoff's law to generalize the calculation from a single reference point to a function of temperature, $\\Delta H_c(T)$. You will implement standard computational models for temperature-dependent heat capacities, bridging the gap between static textbook values and the dynamic routines required for realistic simulations of multi-component fuels. ",
            "id": "4029797",
            "problem": "You are to derive and implement a computation of the temperature-dependent heat of combustion, denoted by $\\Delta H_c(T)$, for a gaseous multi-component hydrocarbon fuel mixture burning in air, using the integration of Hess’s law, Kirchhoff’s law, and a thermodynamic model for sensible enthalpy based on the National Aeronautics and Space Administration (NASA) heat capacity polynomials. The derivation must start from the following fundamental base: (i) the definition of enthalpy and the First Law of Thermodynamics at constant pressure, (ii) Hess’s law (enthalpy of reaction is a state function equal to the sum of products’ enthalpies minus the sum of reactants’ enthalpies for the same state), and (iii) Kirchhoff’s law (the temperature dependence of the enthalpy of reaction equals the integral of the heat capacity difference between products and reactants). You will then express the enthalpy change at temperature $T$ using a piecewise NASA heat capacity model and implement it in a program.\n\nThe reaction under consideration is complete stoichiometric combustion to carbon dioxide and water vapor (lower heating value convention), with nitrogen treated as thermally participating but chemically inert. Air is modeled as a mixture providing oxygen and nitrogen with molar ratio $\\chi_{\\mathrm{N_2}/\\mathrm{O_2}} = 3.76$. All species are treated as ideal gases.\n\nDefine the general hydrocarbon species by its elemental composition $\\mathrm{C}_a \\mathrm{H}_b$. For one mole of this species, complete stoichiometric combustion requires $a + \\frac{b}{4}$ moles of $\\mathrm{O_2}$ and yields $a$ moles of $\\mathrm{CO_2}$ and $\\frac{b}{2}$ moles of $\\mathrm{H_2O}$, with $\\chi_{\\mathrm{N_2}/\\mathrm{O_2}} \\times \\left(a + \\frac{b}{4}\\right)$ moles of $\\mathrm{N_2}$ entering and leaving unchanged.\n\nLet the fuel mixture contain species $\\mathrm{CH_4}$ and $\\mathrm{C_2H_6}$ with mole fractions $x_{\\mathrm{CH_4}}$ and $x_{\\mathrm{C_2H_6}}$, respectively, satisfying $x_{\\mathrm{CH_4}} + x_{\\mathrm{C_2H_6}} = 1$. Per mole of the fuel mixture, the stoichiometric products and oxidizer requirements are determined by linearity: the total $\\mathrm{CO_2}$ moles equal $x_{\\mathrm{CH_4}}\\cdot 1 + x_{\\mathrm{C_2H_6}}\\cdot 2$, the total $\\mathrm{H_2O}$ moles equal $x_{\\mathrm{CH_4}}\\cdot 2 + x_{\\mathrm{C_2H_6}}\\cdot 3$, the total $\\mathrm{O_2}$ moles equal $x_{\\mathrm{CH_4}}\\cdot 2 + x_{\\mathrm{C_2H_6}}\\cdot 3.5$, and the total $\\mathrm{N_2}$ moles equal $3.76$ times the $\\mathrm{O_2}$ moles.\n\nLet the standard reference temperature be $T_0 = 298$ $\\mathrm{K}$. The standard molar enthalpies of formation at $T_0$ for the species are:\n- $\\Delta H_f^\\circ(\\mathrm{CH_4}, T_0) = -74.85$ $\\mathrm{kJ/mol}$,\n- $\\Delta H_f^\\circ(\\mathrm{C_2H_6}, T_0) = -84.00$ $\\mathrm{kJ/mol}$,\n- $\\Delta H_f^\\circ(\\mathrm{CO_2}, T_0) = -393.52$ $\\mathrm{kJ/mol}$,\n- $\\Delta H_f^\\circ(\\mathrm{H_2O(g)}, T_0) = -241.826$ $\\mathrm{kJ/mol}$,\n- $\\Delta H_f^\\circ(\\mathrm{O_2}, T_0) = 0$ $\\mathrm{kJ/mol}$,\n- $\\Delta H_f^\\circ(\\mathrm{N_2}, T_0) = 0$ $\\mathrm{kJ/mol}$.\n\nUsing Hess’s law, the standard enthalpy of reaction at $T_0$ per mole of fuel mixture is\n$$\n\\Delta H^\\circ_{\\mathrm{rxn}}(T_0) = \\sum_i \\nu_i^{\\mathrm{prod}} \\,\\Delta H_f^\\circ(i,T_0) - \\sum_j \\nu_j^{\\mathrm{react}} \\,\\Delta H_f^\\circ(j,T_0),\n$$\nwhere $\\nu^{\\mathrm{prod}}$ and $\\nu^{\\mathrm{react}}$ are the stoichiometric coefficients of products and reactants per mole of the fuel mixture, respectively.\n\nBy Kirchhoff’s law, for any temperature $T$, the enthalpy of reaction at $T$ satisfies\n$$\n\\Delta H_{\\mathrm{rxn}}(T) = \\Delta H^\\circ_{\\mathrm{rxn}}(T_0) + \\int_{T_0}^{T} \\left[ \\sum_i \\nu_i^{\\mathrm{prod}} c_{p,i}(T') - \\sum_j \\nu_j^{\\mathrm{react}} c_{p,j}(T') \\right] \\, \\mathrm{d}T'.\n$$\nThe heat of combustion is $\\Delta H_c(T) = \\Delta H_{\\mathrm{rxn}}(T)$ for the specified products and reactants. Report $\\Delta H_c(T)$ in $\\mathrm{kJ/mol}$ of the fuel mixture, with the conventional sign (negative for exothermic reaction).\n\nFor the sensible enthalpy model, use the NASA seven-coefficient heat capacity polynomial in the form\n$$\n\\frac{c_{p,i}(T)}{R} = a_{1,i} + a_{2,i} T + a_{3,i} T^2 + a_{4,i} T^3 + a_{5,i} T^4,\n$$\nwith a piecewise coefficient set:\n- For $T$ in $[200,1000]$ $\\mathrm{K}$, use the “low-$T$” coefficients $\\{a_{k,i}^{\\mathrm{low}}\\}_{k=1}^{5}$.\n- For $T$ in $(1000,6000]$ $\\mathrm{K}$, use the “high-$T$” coefficients $\\{a_{k,i}^{\\mathrm{high}}\\}_{k=1}^{5}$.\n\nThe universal gas constant is $R = 8.314462618$ $\\mathrm{J/mol\\cdot K}$. Integrate $\\int c_{p,i}(T')\\,\\mathrm{d}T'$ analytically for each polynomial segment; if $T$ crosses $1000$ $\\mathrm{K}$, sum the contributions from $[T_0,1000]$ and $[1000,T]$ using the appropriate coefficient sets.\n\nUse the following coefficient sets (dimensionless, for $c_{p}/R$) that are scientifically plausible and self-consistent for the species in this problem:\n\nLow-temperature ($200$–$1000$ $\\mathrm{K}$):\n- $\\mathrm{CH_4}$: $a_1=4.210$, $a_2=0.0022$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{C_2H_6}$: $a_1=6.250$, $a_2=0.0040$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{O_2}$: $a_1=3.500$, $a_2=0.0007$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{N_2}$: $a_1=3.500$, $a_2=0.0007$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{CO_2}$: $a_1=4.400$, $a_2=0.0013$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{H_2O}$: $a_1=4.080$, $a_2=0.0009$, $a_3=0$, $a_4=0$, $a_5=0$.\n\nHigh-temperature ($1000$–$6000$ $\\mathrm{K}$):\n- $\\mathrm{CH_4}$: $a_1=5.700$, $a_2=0.0010$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{C_2H_6}$: $a_1=7.500$, $a_2=0.0020$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{O_2}$: $a_1=3.600$, $a_2=0.0007$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{N_2}$: $a_1=3.600$, $a_2=0.0007$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{CO_2}$: $a_1=4.700$, $a_2=0.0011$, $a_3=0$, $a_4=0$, $a_5=0$.\n- $\\mathrm{H_2O}$: $a_1=4.200$, $a_2=0.0006$, $a_3=0$, $a_4=0$, $a_5=0$.\n\nReference lower heating values at $T_0$ (water as vapor) to be used for validation are:\n- $\\Delta H_c^\\circ(\\mathrm{CH_4}, T_0) = -802.322$ $\\mathrm{kJ/mol}$,\n- $\\Delta H_c^\\circ(\\mathrm{C_2H_6}, T_0) = -1428.518$ $\\mathrm{kJ/mol}$.\n\nYour program must implement the above principles to compute $\\Delta H_c(T)$ and perform validation. The required unit for all enthalpy outputs is $\\mathrm{kJ/mol}$ of the fuel mixture.\n\nTest Suite:\nProvide computations for the following parameter sets, each specified by $(x_{\\mathrm{CH_4}}, x_{\\mathrm{C_2H_6}}, T)$ per mole of the fuel mixture:\n- Case $1$: $(1.0, 0.0, 298)$; output the absolute deviation between the computed $\\Delta H_c(298)$ and the given reference value for $\\mathrm{CH_4}$, in $\\mathrm{kJ/mol}$.\n- Case $2$: $(0.0, 1.0, 298)$; output the absolute deviation between the computed $\\Delta H_c(298)$ and the given reference value for $\\mathrm{C_2H_6}$, in $\\mathrm{kJ/mol}$.\n- Case $3$: $(0.7, 0.3, 300)$; output $\\Delta H_c(300)$ in $\\mathrm{kJ/mol}$.\n- Case $4$: $(0.7, 0.3, 1000)$; output $\\Delta H_c(1000)$ in $\\mathrm{kJ/mol}$.\n- Case $5$: $(0.7, 0.3, 1500)$; output $\\Delta H_c(1500)$ in $\\mathrm{kJ/mol}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for Cases $1$–$5$ as a comma-separated list enclosed in square brackets, in the exact order of the cases above. For example, the printed output must look like `[result1,result2,result3,result4,result5]`, where each entry is a float in $\\mathrm{kJ/mol}$.",
            "solution": "The problem is valid as it is scientifically grounded, self-contained, and well-posed. It presents a standard computational thermodynamics problem based on established principles (Hess’s law, Kirchhoff’s law) and standard data forms (NASA polynomials). The provided data, including standard enthalpies of formation and reference heats of combustion, are internally consistent. We can, therefore, proceed with a formal derivation and solution.\n\nThe fundamental task is to compute the heat of combustion of a fuel mixture at a given temperature $T$, denoted as $\\Delta H_c(T)$. The heat of combustion is equivalent to the enthalpy of reaction, $\\Delta H_{\\mathrm{rxn}}(T)$, for the specified complete, stoichiometric combustion process. The derivation follows a two-step application of Hess's law and Kirchhoff's law.\n\nFirst, we establish the overall combustion reaction for one mole of the fuel mixture, which consists of $x_{\\mathrm{CH_4}}$ moles of methane ($\\mathrm{CH_4}$) and $x_{\\mathrm{C_2H_6}}$ moles of ethane ($\\mathrm{C_2H_6}$). The total reaction is the linear combination of the individual combustion reactions. For a general hydrocarbon $\\mathrm{C}_a \\mathrm{H}_b$, the stoichiometric reaction in air is:\n$$\n\\mathrm{C}_a \\mathrm{H}_b + \\left(a + \\frac{b}{4}\\right)\\mathrm{O_2} + 3.76\\left(a + \\frac{b}{4}\\right)\\mathrm{N_2} \\rightarrow a\\mathrm{CO_2} + \\frac{b}{2}\\mathrm{H_2O} + 3.76\\left(a + \\frac{b}{4}\\right)\\mathrm{N_2}\n$$\nFor $\\mathrm{CH_4}$, we have $a=1, b=4$. For $\\mathrm{C_2H_6}$, we have $a=2, b=6$. The stoichiometric coefficients ($\\nu_i$) per mole of fuel mixture are thus linear combinations based on mole fractions:\nReactants:\n- $\\nu_{\\mathrm{CH_4}}^{\\mathrm{react}} = x_{\\mathrm{CH_4}}$\n- $\\nu_{\\mathrm{C_2H_6}}^{\\mathrm{react}} = x_{\\mathrm{C_2H_6}}$\n- $\\nu_{\\mathrm{O_2}}^{\\mathrm{react}} = x_{\\mathrm{CH_4}}\\left(1 + \\frac{4}{4}\\right) + x_{\\mathrm{C_2H_6}}\\left(2 + \\frac{6}{4}\\right) = 2x_{\\mathrm{CH_4}} + 3.5x_{\\mathrm{C_2H_6}}$\nProducts:\n- $\\nu_{\\mathrm{CO_2}}^{\\mathrm{prod}} = x_{\\mathrm{CH_4}}(1) + x_{\\mathrm{C_2H_6}}(2) = x_{\\mathrm{CH_4}} + 2x_{\\mathrm{C_2H_6}}$\n- $\\nu_{\\mathrm{H_2O}}^{\\mathrm{prod}} = x_{\\mathrm{CH_4}}\\left(\\frac{4}{2}\\right) + x_{\\mathrm{C_2H_6}}\\left(\\frac{6}{2}\\right) = 2x_{\\mathrm{CH_4}} + 3x_{\\mathrm{C_2H_6}}$\nThe moles of nitrogen, $\\nu_{\\mathrm{N_2}} = 3.76 \\times \\nu_{\\mathrm{O_2}}^{\\mathrm{react}}$, are identical on the reactant and product sides, reflecting its chemically inert nature.\n\n**Step 1: Enthalpy of Combustion at Standard Temperature ($T_0$) using Hess's Law**\nHess's law states that the enthalpy change of a reaction is independent of the path taken. The standard enthalpy of reaction at the reference temperature $T_0 = 298$ K, $\\Delta H^\\circ_{\\mathrm{rxn}}(T_0)$, is calculated as the sum of the standard enthalpies of formation of the products minus that of the reactants, each weighted by their stoichiometric coefficients.\n$$\n\\Delta H^\\circ_{\\mathrm{rxn}}(T_0) = \\sum_i \\nu_i^{\\mathrm{prod}} \\Delta H_f^\\circ(i, T_0) - \\sum_j \\nu_j^{\\mathrm{react}} \\Delta H_f^\\circ(j, T_0)\n$$\nFor our specific mixture, this becomes:\n$$\n\\Delta H^\\circ_{\\mathrm{rxn}}(T_0) = \\left[ \\nu_{\\mathrm{CO_2}}^{\\mathrm{prod}}\\Delta H_f^\\circ(\\mathrm{CO_2}, T_0) + \\nu_{\\mathrm{H_2O}}^{\\mathrm{prod}}\\Delta H_f^\\circ(\\mathrm{H_2O}, T_0) \\right] - \\left[ \\nu_{\\mathrm{CH_4}}^{\\mathrm{react}}\\Delta H_f^\\circ(\\mathrm{CH_4}, T_0) + \\nu_{\\mathrm{C_2H_6}}^{\\mathrm{react}}\\Delta H_f^\\circ(\\mathrm{C_2H_6}, T_0) \\right]\n$$\nNote that the standard enthalpies of formation for elements in their stable form, $\\Delta H_f^\\circ(\\mathrm{O_2}, T_0)$ and $\\Delta H_f^\\circ(\\mathrm{N_2}, T_0)$, are zero by definition and thus do not appear in the final expression.\n\n**Step 2: Temperature Dependence using Kirchhoff's Law**\nKirchhoff's law describes the effect of temperature on the enthalpy of reaction. The change in reaction enthalpy with temperature is related to the difference in heat capacity between products and reactants.\n$$\n\\Delta H_{\\mathrm{rxn}}(T) = \\Delta H^\\circ_{\\mathrm{rxn}}(T_0) + \\int_{T_0}^{T} \\Delta c_p(T') \\, \\mathrm{d}T'\n$$\nwhere $\\Delta c_p(T')$ is the difference in molar heat capacities:\n$$\n\\Delta c_p(T) = \\sum_i \\nu_i^{\\mathrm{prod}} c_{p,i}(T) - \\sum_j \\nu_j^{\\mathrm{react}} c_{p,j}(T)\n$$\nExpanding for our system:\n$$\n\\Delta c_p(T) = \\left[ \\nu_{\\mathrm{CO_2}}^{\\mathrm{prod}}c_{p,\\mathrm{CO_2}}(T) + \\nu_{\\mathrm{H_2O}}^{\\mathrm{prod}}c_{p,\\mathrm{H_2O}}(T) + \\nu_{\\mathrm{N_2}}c_{p,\\mathrm{N_2}}(T) \\right] - \\left[ \\nu_{\\mathrm{CH_4}}^{\\mathrm{react}}c_{p,\\mathrm{CH_4}}(T) + \\nu_{\\mathrm{C_2H_6}}^{\\mathrm{react}}c_{p,\\mathrm{C_2H_6}}(T) + \\nu_{\\mathrm{O_2}}^{\\mathrm{react}}c_{p,\\mathrm{O_2}}(T) + \\nu_{\\mathrm{N_2}}c_{p,\\mathrm{N_2}}(T) \\right]\n$$\nSince $\\nu_{\\mathrm{N_2}}$ is the same for products and reactants, the $c_{p,\\mathrm{N_2}}(T)$ terms cancel out.\n$$\n\\Delta c_p(T) = \\left[ \\nu_{\\mathrm{CO_2}}^{\\mathrm{prod}}c_{p,\\mathrm{CO_2}}(T) + \\nu_{\\mathrm{H_2O}}^{\\mathrm{prod}}c_{p,\\mathrm{H_2O}}(T) \\right] - \\left[ \\nu_{\\mathrm{CH_4}}^{\\mathrm{react}}c_{p,\\mathrm{CH_4}}(T) + \\nu_{\\mathrm{C_2H_6}}^{\\mathrm{react}}c_{p,\\mathrm{C_2H_6}}(T) + \\nu_{\\mathrm{O_2}}^{\\mathrm{react}}c_{p,\\mathrm{O_2}}(T) \\right]\n$$\n\n**Step 3: Integration of Heat Capacity Polynomials**\nThe heat capacity for each species $i$ is given by a simplified NASA polynomial: $\\frac{c_{p,i}(T)}{R} = a_{1,i} + a_{2,i} T$, since coefficients $a_3, a_4, a_5$ are zero. We can define a single polynomial for $\\Delta c_p(T)$:\n$$\n\\frac{\\Delta c_p(T)}{R} = \\Delta a_1 + \\Delta a_2 T\n$$\nwhere the $\\Delta a_k$ coefficients are computed as:\n$$\n\\Delta a_k = \\left[ \\nu_{\\mathrm{CO_2}}^{\\mathrm{prod}} a_{k,\\mathrm{CO_2}} + \\nu_{\\mathrm{H_2O}}^{\\mathrm{prod}} a_{k,\\mathrm{H_2O}} \\right] - \\left[ \\nu_{\\mathrm{CH_4}}^{\\mathrm{react}} a_{k,\\mathrm{CH_4}} + \\nu_{\\mathrm{C_2H_6}}^{\\mathrm{react}} a_{k,\\mathrm{C_2H_6}} + \\nu_{\\mathrm{O_2}}^{\\mathrm{react}} a_{k,\\mathrm{O_2}} \\right]\n$$\nThe integral of $\\Delta c_p(T')$ from $T_1$ to $T_2$ within a single polynomial region is:\n$$\n\\int_{T_1}^{T_2} \\Delta c_p(T') \\, \\mathrm{d}T' = \\int_{T_1}^{T_2} R(\\Delta a_1 + \\Delta a_2 T') \\, \\mathrm{d}T' = R \\left[ \\Delta a_1 T' + \\frac{1}{2}\\Delta a_2 (T')^2 \\right]_{T_1}^{T_2} = R \\left( \\Delta a_1 (T_2-T_1) + \\frac{1}{2}\\Delta a_2 (T_2^2 - T_1^2) \\right)\n$$\nThe coefficients are piecewise, with a change at $T_{mid} = 1000$ K. The calculation of the integral term depends on the target temperature $T$:\n- If $T \\le 1000$ K: The integration is performed from $T_0 = 298$ K to $T$ using the low-temperature coefficient set ($\\{a_{k,i}^{\\mathrm{low}}\\}$).\n$$\n\\int_{T_0}^{T} \\Delta c_p(T') \\, \\mathrm{d}T' = R \\left( \\Delta a_1^{\\mathrm{low}} (T-T_0) + \\frac{1}{2}\\Delta a_2^{\\mathrm{low}} (T^2 - T_0^2) \\right)\n$$\n- If $T > 1000$ K: The integral is split into two parts: from $T_0$ to $T_{mid}=1000$ K using low-temperature coefficients, and from $T_{mid}$ to $T$ using high-temperature coefficients ($\\{a_{k,i}^{\\mathrm{high}}\\}$).\n$$\n\\int_{T_0}^{T} \\Delta c_p(T') \\, \\mathrm{d}T' = R \\left( \\Delta a_1^{\\mathrm{low}} (T_{mid}-T_0) + \\frac{1}{2}\\Delta a_2^{\\mathrm{low}} (T_{mid}^2-T_0^2) \\right) + R \\left( \\Delta a_1^{\\mathrm{high}} (T-T_{mid}) + \\frac{1}{2}\\Delta a_2^{\\mathrm{high}} (T^2-T_{mid}^2) \\right)\n$$\n\n**Step 4: Final Calculation**\nThe heat of combustion $\\Delta H_c(T) = \\Delta H_{\\mathrm{rxn}}(T)$ is the sum of the standard enthalpy of reaction and the sensible enthalpy change integral. A conversion factor of $1000$ is needed to align units of kJ and J. The universal gas constant $R$ is $8.314462618$ $\\mathrm{J/(mol \\cdot K)}$.\n$$\n\\Delta H_c(T) = \\Delta H^\\circ_{\\mathrm{rxn}}(T_0) + \\frac{1}{1000} \\int_{T_0}^{T} \\Delta c_p(T') \\, \\mathrm{d}T' \\quad [\\mathrm{kJ/mol-mixture}]\n$$\nThis provides the complete algorithm for calculating $\\Delta H_c(T)$ for any given fuel mixture composition $(x_{\\mathrm{CH_4}}, x_{\\mathrm{C_2H_6}})$ and temperature $T$. The implementation will follow this logic for each test case.\n- For cases $1$ and $2$, $T=T_0=298$ K, so the integral term is zero. The result is just $\\Delta H^\\circ_{\\mathrm{rxn}}(T_0)$, and the problem asks for the absolute deviation from the provided reference values.\n- For cases $3$, $4$, and $5$, the full calculation is performed at $T=300$ K, $T=1000$ K, and $T=1500$ K, respectively.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the temperature-dependent heat of combustion for a CH4/C2H6 fuel mixture.\n    \"\"\"\n\n    # --- Givens from the problem statement ---\n    R = 8.314462618  # Universal gas constant, J/(mol.K)\n    T0 = 298.0  # Standard reference temperature, K\n    T_MID = 1000.0 # Temperature breakpoint for NASA polynomials, K\n    \n    # Standard molar enthalpies of formation at T0 (kJ/mol)\n    H_f_0 = {\n        'CH4': -74.85,\n        'C2H6': -84.00,\n        'CO2': -393.52,\n        'H2O': -241.826, # Water vapor\n        'O2': 0.0,\n        'N2': 0.0\n    }\n\n    # Reference lower heating values at T0 (kJ/mol) for validation\n    H_c_ref = {\n        'CH4': -802.322,\n        'C2H6': -1428.518\n    }\n\n    # Dimensionless NASA polynomial coefficients for c_p/R = a1 + a2*T + ...\n    # We only need a1 and a2 as a3, a4, a5 are zero.\n    coeffs = {\n        # Low-temperature range (200-1000 K)\n        'low': {\n            'CH4':  [4.210, 0.0022], 'C2H6': [6.250, 0.0040],\n            'O2':   [3.500, 0.0007], 'N2':   [3.500, 0.0007],\n            'CO2':  [4.400, 0.0013], 'H2O':  [4.080, 0.0009],\n        },\n        # High-temperature range (1000-6000 K)\n        'high': {\n            'CH4':  [5.700, 0.0010], 'C2H6': [7.500, 0.0020],\n            'O2':   [3.600, 0.0007], 'N2':   [3.600, 0.0007],\n            'CO2':  [4.700, 0.0011], 'H2O':  [4.200, 0.0006],\n        }\n    }\n    \n    def calculate_delta_H_c(x_ch4, x_c2h6, T):\n        \"\"\"\n        Calculates the heat of combustion for a given mixture and temperature.\n\n        Args:\n            x_ch4 (float): Mole fraction of CH4 in the fuel mixture.\n            x_c2h6 (float): Mole fraction of C2H6 in the fuel mixture.\n            T (float): Target temperature in Kelvin.\n\n        Returns:\n            float: Heat of combustion (enthalpy of reaction) in kJ/mol of fuel mixture.\n        \"\"\"\n\n        # 1. Stoichiometric coefficients per mole of fuel mixture\n        nu = {\n            'react': {\n                'CH4': x_ch4,\n                'C2H6': x_c2h6,\n                'O2': x_ch4 * 2.0 + x_c2h6 * 3.5,\n            },\n            'prod': {\n                'CO2': x_ch4 * 1.0 + x_c2h6 * 2.0,\n                'H2O': x_ch4 * 2.0 + x_c2h6 * 3.0,\n            }\n        }\n        \n        # 2. Calculate standard heat of reaction at T0 using Hess's Law\n        H_prod_0 = nu['prod']['CO2'] * H_f_0['CO2'] + nu['prod']['H2O'] * H_f_0['H2O']\n        H_react_0 = nu['react']['CH4'] * H_f_0['CH4'] + nu['react']['C2H6'] * H_f_0['C2H6']\n        delta_H_rxn_0 = H_prod_0 - H_react_0\n        \n        # 3. Calculate the integral term from Kirchhoff's Law\n        integral_term_J_mol = 0.0\n\n        if T != T0:\n            # Calculate delta-coefficients for the cp polynomial\n            def get_delta_a(coeff_set):\n                delta_a = [0.0, 0.0] # [delta_a1, delta_a2]\n                \n                # Products\n                delta_a[0] += nu['prod']['CO2'] * coeff_set['CO2'][0]\n                delta_a[1] += nu['prod']['CO2'] * coeff_set['CO2'][1]\n                delta_a[0] += nu['prod']['H2O'] * coeff_set['H2O'][0]\n                delta_a[1] += nu['prod']['H2O'] * coeff_set['H2O'][1]\n\n                # Reactants\n                delta_a[0] -= nu['react']['CH4'] * coeff_set['CH4'][0]\n                delta_a[1] -= nu['react']['CH4'] * coeff_set['CH4'][1]\n                delta_a[0] -= nu['react']['C2H6'] * coeff_set['C2H6'][0]\n                delta_a[1] -= nu['react']['C2H6'] * coeff_set['C2H6'][1]\n                delta_a[0] -= nu['react']['O2'] * coeff_set['O2'][0]\n                delta_a[1] -= nu['react']['O2'] * coeff_set['O2'][1]\n                \n                return delta_a\n\n            # Define the analytical integral of DeltaCp*dT\n            def integrate_delta_cp(delta_a, T1, T2):\n                term1 = delta_a[0] * (T2 - T1)\n                term2 = 0.5 * delta_a[1] * (T2**2 - T1**2)\n                return R * (term1 + term2)\n\n            if T <= T_MID:\n                # Integrate from T0 to T using low-T coefficients\n                delta_a_low = get_delta_a(coeffs['low'])\n                integral_term_J_mol = integrate_delta_cp(delta_a_low, T0, T)\n            else: # T > T_MID\n                # Part 1: Integrate from T0 to T_MID using low-T coefficients\n                delta_a_low = get_delta_a(coeffs['low'])\n                integral_part1 = integrate_delta_cp(delta_a_low, T0, T_MID)\n                \n                # Part 2: Integrate from T_MID to T using high-T coefficients\n                delta_a_high = get_delta_a(coeffs['high'])\n                integral_part2 = integrate_delta_cp(delta_a_high, T_MID, T)\n                \n                integral_term_J_mol = integral_part1 + integral_part2\n\n        # 4. Final heat of combustion\n        # Convert integral term from J/mol to kJ/mol\n        delta_H_c_T = delta_H_rxn_0 + integral_term_J_mol / 1000.0\n        \n        return delta_H_c_T\n\n    # Define the test cases from the problem statement.\n    # Format: (x_CH4, x_C2H6, T_in_K)\n    test_cases = [\n        (1.0, 0.0, 298.0),\n        (0.0, 1.0, 298.0),\n        (0.7, 0.3, 300.0),\n        (0.7, 0.3, 1000.0),\n        (0.7, 0.3, 1500.0),\n    ]\n\n    results = []\n    # Case 1: Pure CH4 at 298 K, calculate deviation\n    case1_params = test_cases[0]\n    computed_h_c_ch4 = calculate_delta_H_c(*case1_params)\n    deviation1 = abs(computed_h_c_ch4 - H_c_ref['CH4'])\n    results.append(deviation1)\n    \n    # Case 2: Pure C2H6 at 298 K, calculate deviation\n    case2_params = test_cases[1]\n    computed_h_c_c2h6 = calculate_delta_H_c(*case2_params)\n    deviation2 = abs(computed_h_c_c2h6 - H_c_ref['C2H6'])\n    results.append(deviation2)\n    \n    # Cases 3, 4, 5: Mixture at different temperatures\n    for case in test_cases[2:]:\n        result = calculate_delta_H_c(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A primary application of the heat of combustion is to determine the maximum possible product temperature in an adiabatic system—the adiabatic flame temperature, $T_{ad}$, a critical parameter in engine and furnace design. This exercise uses the First Law of Thermodynamics, balancing the heat released, $Q = -\\Delta H_c(T)$, against the increase in the products' sensible enthalpy. By implementing a numerical solver with accurate temperature-dependent heat capacities, $C_p(T)$, and comparing it to simplified approximations, you will gain direct experience in quantifying model error, a vital skill for developing and validating predictive combustion simulations. ",
            "id": "4029768",
            "problem": "You are asked to quantify, for a canonical complete combustion case, the bias introduced by using a constant isobaric specific heat capacity $c_p$ instead of temperature-dependent $C_p(T)$ for computing the adiabatic flame temperature $T_{\\mathrm{ad}}$ of the product mixture. The setting is a stoichiometric methane–air reaction at standard conditions, with water in the vapor phase. You must derive from first principles the governing energy balance, implement a computational procedure to obtain $T_{\\mathrm{ad}}$ with temperature-dependent $C_p(T)$ modeled by well-tested polynomials, then compute the approximation bias when using a constant $c_p$ chosen at various representative temperatures, and assess whether the approximation is acceptable.\n\nFundamental base to use:\n- The First Law of Thermodynamics for a steady, adiabatic, single-inlet, single-outlet reactive flow with negligible shaft work, kinetic energy, and potential energy changes states an enthalpy balance: the total molar enthalpy of products equals the total molar enthalpy of reactants. For complete combustion at constant pressure and adiabatic conditions, this reduces to\n$$\n\\sum_{j \\in \\text{products}} n_j \\, h_j(T_{\\mathrm{ad}}) \\;=\\; \\sum_{i \\in \\text{reactants}} n_i \\, h_i(T_0) \\,,\n$$\nwhere $n_k$ denotes stoichiometric molar coefficients and $h_k(T)$ denotes molar enthalpy at temperature $T$.\n- Decompose $h_k(T)$ into standard formation enthalpy at a reference temperature $T_{\\mathrm{ref}}$ and sensible enthalpy due to heating from $T_{\\mathrm{ref}}$ to $T$: \n$$\nh_k(T) \\;=\\; h_k^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} C_{p,k}(T')\\, dT' \\,.\n$$\n- Define the standard molar heat of reaction at $T_{\\mathrm{ref}}$ as\n$$\n\\Delta H_{\\mathrm{rxn}}^\\circ(T_{\\mathrm{ref}}) \\;=\\; \\sum_{j \\in \\text{products}} n_j \\, h_j^\\circ(T_{\\mathrm{ref}}) \\;-\\; \\sum_{i \\in \\text{reactants}} n_i \\, h_i^\\circ(T_{\\mathrm{ref}}) \\,.\n$$\nFor complete combustion of methane to carbon dioxide and water vapor at $T_{\\mathrm{ref}} = T_0$, this quantity is negative, and the heat release magnitude is \n$$\nQ \\;=\\; -\\Delta H_{\\mathrm{rxn}}^\\circ(T_{\\mathrm{ref}}) \\,,\n$$\na positive number.\n\nDerivation target:\n- Starting from the above fundamentals, show that when $T_{\\mathrm{ref}} = T_0$ and reactants enter at $T_0$, the adiabatic flame temperature $T_{\\mathrm{ad}}$ satisfies \n$$\n\\sum_{j \\in \\text{products}} n_j \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' \\;=\\; Q \\,.\n$$\n- In the constant-$c_p$ approximation where each product is assumed to have constant specific heat independent of $T$, the balance reduces to \n$$\n\\left( \\sum_{j \\in \\text{products}} n_j \\, c_{p,j}^{\\mathrm{const}} \\right) \\, (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0) \\;=\\; Q \\,,\n$$\nfrom which \n$$\nT_{\\mathrm{ad}}^{\\mathrm{const}} \\;=\\; T_0 + \\frac{Q}{\\sum_{j \\in \\text{products}} n_j \\, c_{p,j}^{\\mathrm{const}}} \\,.\n$$\n\nCombustion system specifications:\n- Stoichiometric methane–air reaction at constant pressure, neglecting dissociation and minor species formation:\n$$\n\\mathrm{CH_4} + 2\\,\\mathrm{O_2} + 7.52\\,\\mathrm{N_2} \\;\\to\\; \\mathrm{CO_2} + 2\\,\\mathrm{H_2O} + 7.52\\,\\mathrm{N_2} \\,.\n$$\n- Reference and inlet temperature: $T_{\\mathrm{ref}} = T_0 = 300$ K.\n- Standard molar heat of reaction to water vapor at $T_{\\mathrm{ref}}$: $\\Delta H_{\\mathrm{rxn}}^\\circ(T_{\\mathrm{ref}}) = -802340$ J/mol of $\\mathrm{CH_4}$, giving $Q = 802340$ J/mol of $\\mathrm{CH_4}$.\n- Product stoichiometric molar coefficients per mole of $\\mathrm{CH_4}$: $n_{\\mathrm{CO_2}} = 1$, $n_{\\mathrm{H_2O}} = 2$, $n_{\\mathrm{N_2}} = 7.52$.\n\nThermochemical property model:\n- Ideal gas mixture; product $C_{p,j}(T)$ for $j \\in \\{\\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{N_2}\\}$ modeled by the five-term temperature-dependent polynomial form widely used in the NASA seven-coefficient thermodynamic polynomials:\n$$\n\\frac{C_{p,j}(T)}{R} \\;=\\; a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\,,\n$$\nwith the universal gas constant $R = 8.314462618$ J/(mol·K) and species-dependent coefficients $\\{a_m\\}$ specified piecewise over temperature ranges. The sensible enthalpy change over a temperature interval $[T_1, T_2]$ is obtained by integrating $C_{p,j}(T)$:\n$$\n\\Delta h_j(T_1 \\to T_2) \\;=\\; \\int_{T_1}^{T_2} C_{p,j}(T)\\, dT \\;=\\; R \\left[ a_1 (T_2 - T_1) + \\frac{a_2}{2} (T_2^2 - T_1^2) + \\frac{a_3}{3} (T_2^3 - T_1^3) + \\frac{a_4}{4} (T_2^4 - T_1^4) + \\frac{a_5}{5} (T_2^5 - T_1^5) \\right] \\,,\n$$\napplied piecewise with continuity at range boundaries.\n\nPiecewise coefficients to use (valid ranges in Kelvin):\n- $\\mathrm{N_2}$:\n  - Low ($200 \\le T \\le 1000$): $a_1 = 3.53100528$, $a_2 = -1.23660987\\times 10^{-4}$, $a_3 = -5.02999437\\times 10^{-7}$, $a_4 = 2.43530612\\times 10^{-9}$, $a_5 = -1.40881235\\times 10^{-12}$.\n  - High ($1000 \\le T \\le 6000$): $a_1 = 2.95257626$, $a_2 = 1.39690040\\times 10^{-3}$, $a_3 = -4.92631603\\times 10^{-7}$, $a_4 = 7.86010367\\times 10^{-11}$, $a_5 = -4.60755321\\times 10^{-15}$.\n- $\\mathrm{CO_2}$:\n  - Low ($300 \\le T \\le 1200$): $a_1 = 2.35677352$, $a_2 = 8.98459677\\times 10^{-3}$, $a_3 = -7.12356269\\times 10^{-6}$, $a_4 = 2.45919022\\times 10^{-9}$, $a_5 = -1.43699548\\times 10^{-13}$.\n  - High ($1200 \\le T \\le 6000$): $a_1 = 3.85796028$, $a_2 = 4.41437026\\times 10^{-3}$, $a_3 = -2.21481404\\times 10^{-6}$, $a_4 = 5.23490188\\times 10^{-10}$, $a_5 = -4.72084164\\times 10^{-14}$.\n- $\\mathrm{H_2O}$:\n  - Low ($300 \\le T \\le 1700$): $a_1 = 3.38684249$, $a_2 = 3.47498246\\times 10^{-3}$, $a_3 = -6.35469639\\times 10^{-6}$, $a_4 = 6.96858127\\times 10^{-9}$, $a_5 = -2.50658847\\times 10^{-12}$.\n  - High ($1700 \\le T \\le 6000$): $a_1 = 2.67214561$, $a_2 = 3.05629289\\times 10^{-3}$, $a_3 = -8.73026011\\times 10^{-7}$, $a_4 = 1.20099639\\times 10^{-10}$, $a_5 = -6.39161884\\times 10^{-15}$.\n\nComputational tasks:\n1. Implement a solver for $T_{\\mathrm{ad}}$ by satisfying \n$$\n\\sum_{j \\in \\{\\mathrm{CO_2},\\mathrm{H_2O},\\mathrm{N_2}\\}} n_j \\, \\Delta h_j(T_0 \\to T_{\\mathrm{ad}}) \\;=\\; Q \\,,\n$$\nwith $T_0 = 300$ K and $Q = 802340$ J/mol. Solve for $T_{\\mathrm{ad}}$ using a robust bracketed root-finding method over $[1000, 3500]$ K, assuming monotonic increase of $\\sum_j n_j \\Delta h_j$ with $T$ under the given model and neglecting dissociation.\n2. For the constant-$c_p$ approximation, define \n$$\nc_{p,j}^{\\mathrm{const}} \\;=\\; C_{p,j}(T_{\\mathrm{const}}) \\,,\n$$\nwith $T_{\\mathrm{const}}$ provided per test case, and compute \n$$\nT_{\\mathrm{ad}}^{\\mathrm{const}} \\;=\\; T_0 + \\frac{Q}{\\sum_j n_j \\, c_{p,j}^{\\mathrm{const}}} \\,.\n$$\n3. Compute the absolute bias\n$$\n\\Delta T \\;=\\; T_{\\mathrm{ad}}^{\\mathrm{const}} - T_{\\mathrm{ad}} \\,,\n$$\nexpressed in Kelvin, and the relative bias\n$$\n\\delta \\;=\\; \\frac{|\\Delta T|}{T_{\\mathrm{ad}}} \\,,\n$$\nexpressed as a decimal.\n4. Assess acceptability using the criterion that the approximation is acceptable if both $|\\Delta T| \\le 40$ K and $\\delta \\le 0.02$.\n\nPhysical units and output specifications:\n- Report temperature biases $\\Delta T$ in Kelvin, rounded to $3$ decimal places.\n- The acceptability indicator is a boolean.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain, for each test case in order, the rounded temperature bias followed by the boolean acceptability indicator.\n\nTest suite:\n- Use $4$ test cases with $T_{\\mathrm{const}} \\in \\{800, 1200, 1600, 2200\\}$ K.\n- These cases probe the approximation at substantially sub-adiabatic, near-midrange, near-adiabatic, and super-adiabatic representative temperatures.\n\nFinal output format:\n- Your program must print a single line in the form\n`[\\Delta T_1,accept_1,\\Delta T_2,accept_2,\\Delta T_3,accept_3,\\Delta T_4,accept_4]`\nwhere each $\\Delta T_k$ is rounded to $3$ decimal places (in Kelvin) and each $\\mathrm{accept}_k$ is either $\\mathrm{True}$ or $\\mathrm{False}$.",
            "solution": "The problem requires us to quantify the error in calculating the adiabatic flame temperature, $T_{\\mathrm{ad}}$, of a stoichiometric methane-air mixture when using a constant specific heat capacity, $c_p$, versus a temperature-dependent polynomial model, $C_p(T)$. This analysis proceeds in three stages: first, a formal derivation of the governing energy balance equations from first principles; second, the implementation of a numerical solver for the accurate $T_{\\mathrm{ad}}$ using the polynomial model; and third, the computation of the approximate temperature, $T_{\\mathrm{ad}}^{\\mathrm{const}}$, and the resulting bias for several choices of constant $c_p$.\n\n### Principle-Based Derivation\n\nWe begin with the First Law of Thermodynamics for a steady, adiabatic, open-system reactor where changes in kinetic and potential energy and shaft work are negligible. The energy balance reduces to an enthalpy balance: the total molar enthalpy of the products leaving the system equals the total molar enthalpy of the reactants entering.\n$$\n\\sum_{j \\in \\text{products}} n_j \\, h_j(T_{\\mathrm{ad}}) = \\sum_{i \\in \\text{reactants}} n_i \\, h_i(T_0)\n$$\nHere, $n_k$ are the stoichiometric coefficients, $h_k(T)$ is the molar enthalpy of species $k$ at temperature $T$, $T_0$ is the initial temperature of reactants, and $T_{\\mathrm{ad}}$ is the final adiabatic flame temperature of the products.\n\nThe molar enthalpy $h_k(T)$ is expressed as the sum of the standard molar enthalpy of formation at a reference temperature $T_{\\mathrm{ref}}$, $h_k^\\circ(T_{\\mathrm{ref}})$, and the sensible enthalpy change from $T_{\\mathrm{ref}}$ to $T$:\n$$\nh_k(T) = h_k^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} C_{p,k}(T')\\, dT'\n$$\nBy selecting the reference temperature to be the same as the reactant inlet temperature, $T_{\\mathrm{ref}} = T_0 = 300 \\, \\mathrm{K}$, the enthalpy balance becomes:\n$$\n\\sum_{j \\in \\text{products}} n_j \\left( h_j^\\circ(T_0) + \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' \\right) = \\sum_{i \\in \\text{reactants}} n_i \\left( h_i^\\circ(T_0) + \\int_{T_0}^{T_0} C_{p,i}(T')\\, dT' \\right)\n$$\nThe integral for the reactants vanishes as the integration interval is zero. Rearranging the equation to group the enthalpies of formation gives:\n$$\n\\sum_{j \\in \\text{products}} n_j \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' = \\sum_{i \\in \\text{reactants}} n_i h_i^\\circ(T_0) - \\sum_{j \\in \\text{products}} n_j h_j^\\circ(T_0)\n$$\nThe right-hand side is the negative of the standard heat of reaction at $T_0$, which is defined as $\\Delta H_{\\mathrm{rxn}}^\\circ(T_0) = \\sum_{j} n_j h_j^\\circ(T_0) - \\sum_{i} n_i h_i^\\circ(T_0)$. The heat released by the exothermic reaction, $Q$, is $Q = -\\Delta H_{\\mathrm{rxn}}^\\circ(T_0)$. This leads to the first target equation, which governs the \"true\" adiabatic flame temperature:\n$$\n\\sum_{j \\in \\text{products}} n_j \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' = Q\n$$\nThis equation physically states that the total heat released by the reaction ($Q$) is completely absorbed by the product gases, raising their temperature from $T_0$ to $T_{\\mathrm{ad}}$.\n\nFor the constant specific heat approximation, we assume $C_{p,j}(T) = c_{p,j}^{\\mathrm{const}}$ for each product species $j$. The integral simplifies significantly:\n$$\n\\int_{T_0}^{T_{\\mathrm{ad}}^{\\mathrm{const}}} c_{p,j}^{\\mathrm{const}}\\, dT' = c_{p,j}^{\\mathrm{const}} (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0)\n$$\nSubstituting this into the energy balance yields:\n$$\n\\sum_{j \\in \\text{products}} n_j c_{p,j}^{\\mathrm{const}} (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0) = Q\n$$\nFactoring out the common temperature difference term $(T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0)$ gives:\n$$\n\\left( \\sum_{j \\in \\text{products}} n_j c_{p,j}^{\\mathrm{const}} \\right) (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0) = Q\n$$\nSolving for the approximate adiabatic flame temperature, $T_{\\mathrm{ad}}^{\\mathrm{const}}$, provides the second target equation:\n$$\nT_{\\mathrm{ad}}^{\\mathrm{const}} = T_0 + \\frac{Q}{\\sum_{j \\in \\text{products}} n_j c_{p,j}^{\\mathrm{const}}}\n$$\nThis completes the required derivation.\n\n### Computational Procedure\n\nThe core of the task is to solve the nonlinear equation $\\sum_{j} n_j \\Delta h_j(T_0 \\to T_{\\mathrm{ad}}) - Q = 0$ for $T_{\\mathrm{ad}}$.\n\n1.  **Thermochemical Data Representation**: The species-specific polynomial coefficients for $C_p(T)$ are stored in a nested dictionary structure. This allows for efficient lookup of the appropriate coefficient set based on species name and temperature. Key constants like the universal gas constant $R$, initial temperature $T_0$, heat release $Q$, and stoichiometric coefficients $n_j$ for the products ($\\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{N_2}$) are defined.\n\n2.  **Specific Heat and Enthalpy Functions**:\n    - A function `cp_species(T, species)` is implemented to calculate the molar specific heat $C_{p,j}(T)$ for a given species $j$ at temperature $T$. It first identifies the correct set of polynomial coefficients $\\{a_m\\}$ based on $T$ falling into the low- or high-temperature range, then evaluates the polynomial $C_{p,j}(T) = R \\sum_{m=1}^{5} a_m T^{m-1}$.\n    - A function `delta_h_species(T_start, T_end, species)` calculates the sensible enthalpy change $\\Delta h_j = \\int_{T_{\\mathrm{start}}}^{T_{\\mathrm{end}}} C_{p,j}(T') dT'$. This function correctly handles piecewise integration. If the interval $[T_{\\mathrm{start}}, T_{\\mathrm{end}}]$ crosses the temperature boundary where the coefficients change, the integral is split into two parts, each using the appropriate set of coefficients. The integral itself is calculated using the analytical formula: $\\Delta h_j = R \\sum_{m=1}^{5} \\frac{a_m}{m} (T_{\\mathrm{end}}^m - T_{\\mathrm{start}}^m)$.\n\n3.  **Root-Finding for $T_{\\mathrm{ad}}$**:\n    - A function `f_root(T)` representing the energy balance residual, $f(T) = \\left( \\sum_{j} n_j \\Delta h_j(T_0 \\to T) \\right) - Q$, is defined. The true adiabatic flame temperature $T_{\\mathrm{ad}}$ is the root of this function, i.e., where $f(T_{\\mathrm{ad}}) = 0$.\n    - Since the total sensible enthalpy of the products is a monotonically increasing function of temperature (as all $C_p>0$), the function $f(T)$ will have a unique root. We employ a robust bracketed root-finding algorithm, `scipy.optimize.brentq`, to solve for $T_{\\mathrm{ad}}$ within the specified interval $[1000, 3500]\\,\\mathrm{K}$.\n\n4.  **Bias Analysis**:\n    - After determining the accurate $T_{\\mathrm{ad}}$, we iterate through the given test cases for the representative temperature $T_{\\mathrm{const}} \\in \\{800, 1200, 1600, 2200\\}\\,\\mathrm{K}$.\n    - For each $T_{\\mathrm{const}}$, the constant specific heat for each product species, $c_{p,j}^{\\mathrm{const}} = C_{p,j}(T_{\\mathrm{const}})$, is calculated using the `cp_species` function.\n    - The total heat capacity of the product mixture is computed as $\\sum_j n_j c_{p,j}^{\\mathrm{const}}$.\n    - The approximate flame temperature $T_{\\mathrm{ad}}^{\\mathrm{const}}$ is calculated using its derived explicit formula.\n    - The absolute bias $\\Delta T = T_{\\mathrm{ad}}^{\\mathrm{const}} - T_{\\mathrm{ad}}$ and relative bias $\\delta = |\\Delta T|/T_{\\mathrm{ad}}$ are computed.\n    - An acceptability check is performed based on the criteria $|\\Delta T| \\le 40\\,\\mathrm{K}$ and $\\delta \\le 0.02$.\n\n5.  **Output Generation**: The results for each test case, comprising the rounded temperature bias and the boolean acceptability indicator, are collected into a list and printed in the required single-line format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the adiabatic flame temperature for stoichiometric methane-air combustion\n    and analyzes the bias from using constant specific heat approximations.\n    \"\"\"\n    # 1. Define constants, stoichiometry, and thermochemical data\n    R = 8.314462618  # Universal gas constant, J/(mol·K)\n    T0 = 300.0       # Initial and reference temperature, K\n    Q = 802340.0     # Heat release per mole of CH4, J/mol\n\n    # Stoichiometric coefficients of products per mole of CH4\n    n_prod = {'CO2': 1.0, 'H2O': 2.0, 'N2': 7.52}\n\n    # NASA polynomial coefficients for Cp/R = a1 + a2*T + a3*T^2 + a4*T^3 + a5*T^4\n    # Structure: {species: {'low'/'high': ([coeffs], T_min, T_max)}}\n    coeffs_data = {\n        'N2': {\n            'low':  ([3.53100528, -1.23660987e-4, -5.02999437e-7, 2.43530612e-9, -1.40881235e-12], 200.0, 1000.0),\n            'high': ([2.95257626, 1.39690040e-3, -4.92631603e-7, 7.86010367e-11, -4.60755321e-15], 1000.0, 6000.0)\n        },\n        'CO2': {\n            'low':  ([2.35677352, 8.98459677e-3, -7.12356269e-6, 2.45919022e-9, -1.43699548e-13], 300.0, 1200.0),\n            'high': ([3.85796028, 4.41437026e-3, -2.21481404e-6, 5.23490188e-10, -4.72084164e-14], 1200.0, 6000.0)\n        },\n        'H2O': {\n            'low':  ([3.38684249, 3.47498246e-3, -6.35469639e-6, 6.96858127e-9, -2.50658847e-12], 300.0, 1700.0),\n            'high': ([2.67214561, 3.05629289e-3, -8.73026011e-7, 1.20099639e-10, -6.39161884e-15], 1700.0, 6000.0)\n        }\n    }\n\n    # 2. Implement helper functions for thermochemical properties\n    def get_coeffs_for_T(T, species):\n        \"\"\"Returns the appropriate polynomial coefficient set for a given temperature.\"\"\"\n        low_coeffs, _, T_low_max = coeffs_data[species]['low']\n        high_coeffs, T_high_min, _ = coeffs_data[species]['high']\n        # The ranges are inclusive. T at the boundary can use either set.\n        if T <= T_low_max:\n            return low_coeffs\n        else: # T > T_low_max, must be in high range\n            return high_coeffs\n\n    def cp_species(T, species):\n        \"\"\"Computes molar specific heat Cp for a species at temperature T.\"\"\"\n        a = get_coeffs_for_T(T, species)\n        T_powers = np.array([1.0, T, T**2, T**3, T**4])\n        return R * np.dot(a, T_powers)\n\n    def h_integral_poly(T1, T2, coeffs_list):\n        \"\"\"Computes the definite integral of Cp(T) from T1 to T2 using a single polynomial.\"\"\"\n        a = np.array(coeffs_list)\n        p = np.arange(1, 6)\n        term2 = np.sum(a * (T2**p) / p)\n        term1 = np.sum(a * (T1**p) / p)\n        return R * (term2 - term1)\n\n    def delta_h_species(T_start, T_end, species):\n        \"\"\"Computes sensible enthalpy change, handling piecewise polynomials.\"\"\"\n        low_coeffs, _, T_boundary = coeffs_data[species]['low']\n        high_coeffs, _, _ = coeffs_data[species]['high']\n\n        if T_end <= T_boundary:\n            return h_integral_poly(T_start, T_end, low_coeffs)\n        elif T_start >= T_boundary:\n            return h_integral_poly(T_start, T_end, high_coeffs)\n        else: # Interval crosses the boundary T_start < T_boundary < T_end\n            h_low_part = h_integral_poly(T_start, T_boundary, low_coeffs)\n            h_high_part = h_integral_poly(T_boundary, T_end, high_coeffs)\n            return h_low_part + h_high_part\n\n    # 3. Define the root function for the energy balance\n    def f_root(T):\n        \"\"\"\n        Energy balance residual: Total sensible enthalpy of products minus heat release.\n        The root of this function is the adiabatic flame temperature.\n        \"\"\"\n        total_h_products = sum(n * delta_h_species(T0, T, species) for species, n in n_prod.items())\n        return total_h_products - Q\n\n    # 4. Solve for the accurate adiabatic flame temperature T_ad\n    T_ad_bracket = [1000.0, 3500.0]\n    # Check if the root is bracketed\n    # assert f_root(T_ad_bracket[0]) < 0 and f_root(T_ad_bracket[1]) > 0\n    T_ad = brentq(f_root, T_ad_bracket[0], T_ad_bracket[1], xtol=1e-8)\n\n    # 5. Process test cases to evaluate the constant Cp approximation\n    test_cases_T_const = [800.0, 1200.0, 1600.0, 2200.0]\n    results = []\n\n    for T_const in test_cases_T_const:\n        # a) Compute total mixture heat capacity using the constant Cp approximation\n        sum_n_cp_const = sum(n * cp_species(T_const, species) for species, n in n_prod.items())\n\n        # b) Compute approximate adiabatic flame temperature\n        T_ad_const = T0 + Q / sum_n_cp_const\n        \n        # c) Compute biases\n        delta_T = T_ad_const - T_ad\n        delta_rel = abs(delta_T) / T_ad\n        \n        # d) Assess acceptability based on given criteria\n        is_acceptable = (abs(delta_T) <= 40.0) and (delta_rel <= 0.02)\n        \n        results.append(round(delta_T, 3))\n        results.append(is_acceptable)\n        \n    # 6. Format and print final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}