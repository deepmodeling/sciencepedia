{
    "hands_on_practices": [
        {
            "introduction": "在选择高效的求解器之前，分析源自离散化偏微分方程的矩阵 $A$ 是关键的第一步。本练习  将运用盖尔圆定理（Gershgorin's Circle Theorem）来探究一个对流-扩散方程所产生的矩阵结构。通过此练习，你将揭示物理参数如何塑造矩阵的数学性质，例如对角占优性，而这些性质对迭代方法的收敛性至关重要。",
            "id": "4036826",
            "problem": "考虑一个具有恒定物性的预混气体混合物中的一维组分输运，该过程由以下偏微分方程 (PDE) 建模：\n$$\n\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^{2} Y}{\\partial x^{2}},\n$$\n其中 $Y(x,t)$ 是组分的质量分数，$u>0$ 是恒定的对流速度，$D>0$ 是恒定的分子扩散系数。假设在有限区间上采用狄利克雷边界条件。在间距为 $\\Delta x$ 的均匀网格上对空间进行离散，并使用时间步长为 $\\Delta t$ 的后向欧拉法对时间进行离散。对流项采用一阶迎风格式，扩散项采用二阶中心差分格式，所有项均在新的时间层上进行计算。这会产生一个线性系统\n$$\nA \\mathbf{y}^{n+1} = \\mathbf{y}^{n},\n$$\n其中 $A$ 是一个三对角矩阵，其内部行的系数为\n$$\na_{i,i} = \\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}, \\quad a_{i,i-1} = -\\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right), \\quad a_{i,i+1} = -\\frac{D}{\\Delta x^{2}}.\n$$\n定义无量纲的对流和扩散度量\n$$\nC = \\frac{u \\Delta t}{\\Delta x}, \\qquad S = \\frac{D \\Delta t}{\\Delta x^{2}}.\n$$\n使用盖尔圆定理和矩阵 $A$ 的结构，推导内部行对应的 $A$ 的特征值的界，并解释这些界如何体现对角占优性以及与定常线性求解器稳定性的关系。然后，考虑应用于 $A \\mathbf{y} = \\mathbf{b}$ 的雅可比迭代，其迭代矩阵为 $T_{J} = D^{-1}(L+U)$，其中 $D$ 是 $A$ 的对角部分，$L$ 和 $U$ 分别是其严格下三角和上三角部分。使用盖尔圆定理和范数界，求出 $T_{J}$ 谱半径的一个闭式上界，该上界仅用 $C$ 和 $S$ 表示。将此上界作为你的最终答案。无需进行数值计算。如果引入任何角度，请以弧度表示。由于最终答案是符号形式，因此没有舍入要求。",
            "solution": "问题陈述经评估有效。就所提问题而言，该问题具有科学依据、提法恰当、客观且内部一致。问题涉及一维对流扩散方程标准有限差分离散的数值分析。尽管所述线性系统存在一个微小的不一致（右侧应按 $1/\\Delta t$ 进行缩放），但这不影响矩阵 $A$ 或其相关的雅可比迭代矩阵 $T_J$ 的性质，而它们正是本分析的主体。因此，所提出的问题可以得到严格的解答。\n\n让我们开始分析矩阵 $A$。问题要求对离散化产生的矩阵 $A$ 应用盖尔圆定理。该定理指出，一个方阵 $M$ 的每个特征值 $\\lambda$ 都位于复平面中至少一个盖尔圆盘 $G_i$ 内，其中 $G_i = \\{ z \\in \\mathbb{C} : |z - m_{i,i}| \\le R_i \\}$，$m_{i,i}$ 是第 $i$ 行的对角元素，$R_i = \\sum_{j \\neq i} |m_{i,j}|$ 是该行非对角元素绝对值之和。\n\n对于矩阵 $A$ 的一个内部行 $i$，其系数由下式给出：\n$$\na_{i,i} = \\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\n$$\n$$\na_{i,i-1} = -\\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right)\n$$\n$$\na_{i,i+1} = -\\frac{D}{\\Delta x^{2}}\n$$\n盖尔圆盘 $G_i$ 的圆心是对角元素 $a_{i,i}$。半径 $R_i$ 是第 $i$ 行非对角元素绝对值之和：\n$$\nR_i = |a_{i,i-1}| + |a_{i,i+1}| = \\left|-\\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right)\\right| + \\left|-\\frac{D}{\\Delta x^{2}}\\right|\n$$\n由于 $u > 0$，$D > 0$ 且 $\\Delta x > 0$，绝对值内的项为正，因此：\n$$\nR_i = \\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right) + \\frac{D}{\\Delta x^{2}} = \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\n$$\n如果对于所有行 $i$ 都有 $|a_{i,i}| > \\sum_{j \\neq i} |a_{i,j}|$，则矩阵是行严格对角占优的。让我们检查一下 $A$ 的内部行是否满足此条件。由于 $u$, $D$, $\\Delta t$, $\\Delta x$ 均为正数，$a_{i,i}$ 也是正数，所以 $|a_{i,i}| = a_{i,i}$。\n$$\n|a_{i,i}| - R_i = \\left(\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right) - \\left(\\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right) = \\frac{1}{\\Delta t}\n$$\n由于 $\\Delta t > 0$，我们有 $|a_{i,i}| - R_i = \\frac{1}{\\Delta t} > 0$，这意味着 $|a_{i,i}| > R_i$。因此，矩阵 $A$ 的内部行是严格对角占优的。这个性质如果对所有行都成立（对于带有狄利克雷边界条件的此类离散化来说是典型情况），则保证了 $A$ 是可逆的。此外，它还保证了诸如雅可比和高斯-赛德尔等定常迭代法在应用于系统 $A\\mathbf{x} = \\mathbf{b}$ 时会收敛。对角占优的“程度”（由比率 $R_i/|a_{i,i}|$ 量化）会影响这些求解器的收敛速度。\n\n盖尔圆定理提供了 $A$ 的特征值 $\\lambda$ 的界。对于任意特征值 $\\lambda$，存在一个行 $i$ 使得 $|\\lambda - a_{i,i}| \\le R_i$。这意味着 $\\lambda$ 的实部被界定为 $a_{i,i} - R_i \\le \\text{Re}(\\lambda) \\le a_{i,i} + R_i$。使用内部行的结果，我们发现：\n$$\n\\lambda_{\\text{min, bound}} = a_{i,i} - R_i = \\frac{1}{\\Delta t}\n$$\n$$\n\\lambda_{\\text{max, bound}} = a_{i,i} + R_i = \\frac{1}{\\Delta t} + \\frac{2u}{\\Delta x} + \\frac{4D}{\\Delta x^{2}}\n$$\n由于所有圆盘都以正实轴为中心，且其半径小于圆心值，因此所有特征值都必须有正实部。事实上，由于 $A$ 是一个具有非正非对角元素、正对角元素且严格对角占优的实矩阵，它是一个 M-矩阵，其所有特征值都是实数且为正。最小特征值的下界为 $\\lambda_{\\min} \\ge \\frac{1}{\\Delta t} > 0$。\n\n接下来，我们分析求解 $A\\mathbf{y} = \\mathbf{b}$ 的雅可比迭代。矩阵 $A$ 被分解为其对角部分 $D_{A}$、严格下三角部分 $L_{A}$ 和严格上三角部分 $U_{A}$，使得 $A = D_{A} - L_{A} - U_{A}$。问题中使用了符号 $D$, $L$, $U$，但为避免与扩散系数 $D$ 混淆，我们使用下标。问题陈述 $T_J = D^{-1}(L+U)$，这对应于 $A = D-(L+U)$，因此 $L_{A}$ 和 $U_{A}$ 被定义为具有正元素（即 $A$ 的非对角元素的相反数）。\n雅可比迭代矩阵是 $T_J = D_{A}^{-1}(L_{A} + U_{A})$。如果 $T_J$ 的谱半径（记为 $\\rho(T_J)$）小于 1，则雅可比方法的收敛性得到保证。我们可以使用矩阵范数来找到 $\\rho(T_J)$ 的一个上界，因为对于任何相容的矩阵范数，都有 $\\rho(T_J) \\le \\|T_J\\|$。我们使用无穷范数 $\\|T_J\\|_{\\infty}$，即最大绝对行和。\n$T_J$ 的元素由 $(T_J)_{ij} = -a_{ij}/a_{ii}$（当 $i \\neq j$ 时）和 $(T_J)_{ii} = 0$ 给出。对于一个内部行 $i$，其非零元素为：\n$$\n(T_J)_{i, i-1} = \\frac{-a_{i,i-1}}{a_{i,i}} = \\frac{\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}\n$$\n$$\n(T_J)_{i, i+1} = \\frac{-a_{i,i+1}}{a_{i,i}} = \\frac{\\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}\n$$\n对于一个内部行 $i$ 的绝对行和是：\n$$\n\\sum_{j}|(T_J)_{ij}| = |(T_J)_{i, i-1}| + |(T_J)_{i, i+1}| = \\frac{\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}} + \\frac{\\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}} = \\frac{\\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}\n$$\n这也等于以 0 为中心的 $T_J$ 第 $i$ 行的盖尔圆盘半径。\n\n问题要求这个界用无量纲的库朗数 $C = \\frac{u \\Delta t}{\\Delta x}$ 和扩散数 $S = \\frac{D \\Delta t}{\\Delta x^{2}}$ 来表示。我们可以通过将分子和分母同乘以 $\\Delta t$ 来重写行和：\n$$\n\\frac{\\Delta t \\left(\\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right)}{\\Delta t \\left(\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right)} = \\frac{\\frac{u \\Delta t}{\\Delta x} + \\frac{2D \\Delta t}{\\Delta x^{2}}}{1 + \\frac{u \\Delta t}{\\Delta x} + \\frac{2D \\Delta t}{\\Delta x^{2}}} = \\frac{C + 2S}{1 + C + 2S}\n$$\n系统中第一个和最后一个内部行（行 $i=1$ 和 $i=N-1$）的行和将小于此值，因此这个内部行的行和表达式代表了整个矩阵 $T_J$ 的最大绝对行和。\n因此，$\\|T_J\\|_{\\infty} = \\frac{C + 2S}{1 + C + 2S}$。这为谱半径提供了一个上界：\n$$\n\\rho(T_J) \\le \\|T_J\\|_{\\infty} = \\frac{C + 2S}{1 + C + 2S}\n$$\n由于 $C > 0$ 且 $S > 0$，分子 $C+2S$ 严格小于分母 $1+C+2S$。这意味着对于任何物理和数值参数的选择，都有 $\\rho(T_J) < 1$，这保证了雅可比迭代对于此问题总是收敛的。这种无条件收敛是由隐式时间离散格式建立的严格对角占优性的直接结果。最终所求的答案就是这个谱半径的上界。",
            "answer": "$$\n\\boxed{\\frac{C + 2S}{1 + C + 2S}}\n$$"
        },
        {
            "introduction": "在计算燃烧学中，许多重要的物理问题会产生奇异的线性系统，例如在低马赫数流动中强制执行质量守恒。本练习  将处理一个典型案例：带有纯诺伊曼（Neumann）边界条件的压力泊松方程。此练习将引导你诊断这种奇异性，理解其物理含义（压力仅在相差一个常数的情况下是确定的），并实现一种稳健的数学修正方法以获得唯一的解。",
            "id": "4036855",
            "problem": "在计算燃烧学中典型的低马赫数反应流中，速度场通过投影法推进，该方法通过压力修正来强制执行质量守恒。考虑速度更新的示意性写法 $\\,\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\star}-\\Delta t\\,\\nabla p\\,$，其中 $\\,\\boldsymbol{u}^{\\star}\\,$ 是从对流、扩散和体积源项得到的临时速度。对低马赫数公式强制执行质量守恒的离散形式，会得到一个形如 $\\,\\nabla^{2}p=g\\,$ 的压力泊松方程，并在所有不可穿透边界上具有齐次诺伊曼边界条件 $\\,\\partial p/\\partial n=0\\,$。在此背景下：\n- 从质量守恒要求 $\\,\\nabla\\cdot\\boldsymbol{u}^{n+1}=0\\,$ 和速度更新出发，推导压力泊松方程，并证明纯诺伊曼边界条件意味着 $\\,p\\,$ 的非唯一性。在连续层面上识别其零空间，并推导源项 $\\,g\\,$ 的相关相容性条件。\n- 使用包含 $\\,N=3\\,$ 个控制体积的均匀、单元中心有限体积网格，在区间 $[0,1]$ 上离散化该一维问题，并在两端采用齐次诺伊曼边界条件。令 $\\,\\boldsymbol{p}=(p_{1},p_{2},p_{3})^{T}\\,$ 表示单元中心的压力未知数，并将离散算子写为（在将网格间距的缩放因子吸收到右侧项后）\n$$\nA=\\begin{pmatrix}\n-1  1  0\\\\\n1  -2  1\\\\\n0  1  -1\n\\end{pmatrix},\\qquad \\text{使得}\\qquad A\\,\\boldsymbol{p}=\\boldsymbol{b}.\n$$\n证明 $\\,A\\,$ 是秩亏的，并识别其零空间以及关于 $\\,\\boldsymbol{b}\\,$ 的离散相容性条件。\n- 解释如何通过对 $\\,\\boldsymbol{p}\\,$ 施加与均匀单元体积一致的零均值约束来恢复可解性和唯一性，并写出强制执行 $\\,\\sum_{i=1}^{3}p_{i}=0\\,$ 的相应增广鞍点系统。\n- 最后，对于特定的右侧项 $\\,\\boldsymbol{b}=(2,-1,-1)^{T}\\,$，求解该增广系统并报告中心单元的压力 $\\,p_{2}\\,$。给出精确值，形式为一个纯数（无量纲），不带单位，也无需四舍五入。",
            "solution": "该问题分为四个部分。我们将按顺序逐一解答。\n\n首先，我们推导压力泊松方程，并在连续层面上分析其性质。\n新时间步的速度场 $\\boldsymbol{u}^{n+1}$ 由以下更新公式给出：\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla p\n$$\n其中 $\\boldsymbol{u}^{\\star}$ 是一个临时速度，$p$ 是压力修正。这个新的速度场必须满足低马赫数流的质量守恒要求，该要求表示为无散度条件：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0\n$$\n为了推导 $p$ 的方程，我们对速度更新方程取散度：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot (\\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla p)\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla \\cdot (\\nabla p)\n$$\n使用恒等式 $\\nabla \\cdot (\\nabla p) = \\nabla^2 p$（$p$ 的拉普拉斯算子），并强制执行质量守恒条件 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$，我们得到：\n$$\n0 = \\nabla \\cdot \\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla^2 p\n$$\n重排此方程，得到压力泊松方程：\n$$\n\\nabla^2 p = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\star}\n$$\n这是 $\\nabla^2 p = g$ 的形式，其中源项 $g$ 被确定为 $g = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\star}$。\n\n接下来，我们证明在纯齐次诺伊曼边界条件 $\\frac{\\partial p}{\\partial n} = 0$ 下，解 $p$ 的非唯一性。设 $p(\\boldsymbol{x})$ 是问题的一个解。考虑一个新函数 $\\tilde{p}(\\boldsymbol{x}) = p(\\boldsymbol{x}) + C$，其中 $C$ 是任意常数。\n1.  $\\tilde{p}$ 的泊松方程为 $\\nabla^2 \\tilde{p} = \\nabla^2(p + C) = \\nabla^2 p + \\nabla^2 C = \\nabla^2 p + 0 = g$。因此，$\\tilde{p}$ 满足泊松方程。\n2.  $\\tilde{p}$ 的边界条件为 $\\frac{\\partial \\tilde{p}}{\\partial n} = \\frac{\\partial (p+C)}{\\partial n} = \\frac{\\partial p}{\\partial n} + \\frac{\\partial C}{\\partial n} = 0 + 0 = 0$。因此，$\\tilde{p}$ 满足齐次诺伊曼边界条件。\n因为对于任何常数 $C$，$\\tilde{p} = p+C$ 也是一个解，所以解不是唯一的；它只在相差一个加性常数的意义下是确定的。在这些边界条件下，拉普拉斯算子的零空间是其拉普拉斯算子为零的函数集合，即调和函数。加上法向导数在边界上为零的额外约束，唯一可能的函数是常数函数。因此，零空间是所有常数函数的集合。\n\n为了推导相容性条件，我们在整个区域 $\\Omega$ 上对泊松方程进行积分：\n$$\n\\int_{\\Omega} \\nabla^2 p \\, dV = \\int_{\\Omega} g \\, dV\n$$\n对左侧应用散度定理，我们将拉普拉斯算子（梯度的散度）的体积积分转换成梯度通量的面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla p) \\, dV = \\oint_{\\partial\\Omega} (\\nabla p) \\cdot \\boldsymbol{n} \\, dS\n$$\n其中 $\\partial\\Omega$ 是区域的边界，$\\boldsymbol{n}$ 是向外的单位法向量。项 $(\\nabla p) \\cdot \\boldsymbol{n}$ 是法线方向的方向导数 $\\frac{\\partial p}{\\partial n}$。问题指定了在所有边界上都有齐次诺伊曼边界条件 $\\frac{\\partial p}{\\partial n} = 0$。因此，面积分为零：\n$$\n\\oint_{\\partial\\Omega} \\frac{\\partial p}{\\partial n} \\, dS = \\oint_{\\partial\\Omega} 0 \\, dS = 0\n$$\n这意味着积分后的泊松方程的右侧也必须为零。这就给出了相容性条件：\n$$\n\\int_{\\Omega} g \\, dV = 0\n$$\n要使解存在，源项在整个区域上的积分必须为零。\n\n第二，我们分析离散的一维问题。系统为 $A\\boldsymbol{p} = \\boldsymbol{b}$，其中矩阵 $A$ 如下所示：\n$$\nA = \\begin{pmatrix} -1  1  0 \\\\ 1  -2  1 \\\\ 0  1  -1 \\end{pmatrix}\n$$\n为了证明 $A$ 是秩亏的，我们可以计算它的行列式：\n$$\n\\det(A) = -1 \\cdot ((-2)(-1) - (1)(1)) - 1 \\cdot ((1)(-1) - (1)(0)) + 0 = -1(1) - 1(-1) = -1 + 1 = 0\n$$\n由于行列式为零，该矩阵是奇异的，因此是秩亏的。$A$ 的秩小于 $3$。\n为了识别零空间，我们寻找一个非零向量 $\\boldsymbol{v}=(v_1, v_2, v_3)^T$ 使得 $A\\boldsymbol{v} = \\boldsymbol{0}$：\n$$\n\\begin{pmatrix} -1  1  0 \\\\ 1  -2  1 \\\\ 0  1  -1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了方程组：\n1. $-v_1 + v_2 = 0 \\implies v_1 = v_2$\n2. $v_1 - 2v_2 + v_3 = 0$\n3. $v_2 - v_3 = 0 \\implies v_2 = v_3$\n从这些方程中，我们得到 $v_1 = v_2 = v_3$。因此，零空间中的任何向量都是向量 $\\boldsymbol{1}=(1, 1, 1)^T$ 的标量倍。零空间是 $\\text{span}(\\{(1, 1, 1)^T\\})$，这是常数函数空间的离散模拟。\n\n对于奇异系统 $A\\boldsymbol{p} = \\boldsymbol{b}$ 要存在解，右侧向量 $\\boldsymbol{b}$ 必须与 $A^T$ 的零空间正交。由于 $A$ 是对称的（$A=A^T$），它的零空间和左零空间是相同的。相容性条件是 $\\boldsymbol{b}$ 必须与 $A$ 的零空间正交。令 $\\boldsymbol{v}_{\\text{null}} = (1, 1, 1)^T$ 为零空间的基向量。条件是：\n$$\n\\boldsymbol{v}_{\\text{null}}^T \\boldsymbol{b} = 0 \\implies (1, 1, 1) \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix} = 0 \\implies b_1 + b_2 + b_3 = 0\n$$\n这是离散相容性条件，类似于 $\\int g \\, dV = 0$。\n\n第三，我们解释如何恢复可解性和唯一性。$A$ 的奇异性导致没有唯一解。我们可以通过对 $\\boldsymbol{p}$ 施加一个额外的约束来获得唯一解。问题建议了一个零均值约束，$\\sum_{i=1}^3 p_i = 0$。这个条件消除了解中的任意加性常数。组合起来的问题是在 $\\boldsymbol{1}^T \\boldsymbol{p} = 0$ 的约束下求解 $A\\boldsymbol{p} = \\boldsymbol{b}$。这可以通过引入一个拉格朗日乘子 $\\lambda$ 来构造成一个增广鞍点系统。该系统是：\n$$\n\\begin{pmatrix} A  \\boldsymbol{1} \\\\ \\boldsymbol{1}^T  0 \\end{pmatrix} \\begin{pmatrix} \\boldsymbol{p} \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} \\boldsymbol{b} \\\\ 0 \\end{pmatrix}\n$$\n代入给定的矩阵 $A$ 和向量 $\\boldsymbol{1}=(1, 1, 1)^T$，增广系统为：\n$$\n\\begin{pmatrix}\n-1  1  0  1 \\\\\n1  -2  1  1 \\\\\n0  1  -1  1 \\\\\n1  1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\np_1 \\\\ p_2 \\\\ p_3 \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_1 \\\\ b_2 \\\\ b_3 \\\\ 0\n\\end{pmatrix}\n$$\n这个增广矩阵是非奇异的，并且该系统对于 $(\\boldsymbol{p}, \\lambda)$ 有唯一解。\n\n最后，我们针对特定的右侧项 $\\boldsymbol{b} = (2, -1, -1)^T$ 求解这个增广系统。首先，我们检查相容性条件：$b_1+b_2+b_3 = 2 + (-1) + (-1) = 0$。条件满足，因此解存在。方程组为：\n$$\n\\begin{pmatrix}\n-1  1  0  1 \\\\\n1  -2  1  1 \\\\\n0  1  -1  1 \\\\\n1  1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\np_1 \\\\ p_2 \\\\ p_3 \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 \\\\ -1 \\\\ -1 \\\\ 0\n\\end{pmatrix}\n$$\n这代表四个线性方程：\n1. $-p_1 + p_2 + \\lambda = 2$\n2. $p_1 - 2p_2 + p_3 + \\lambda = -1$\n3. $p_2 - p_3 + \\lambda = -1$\n4. $p_1 + p_2 + p_3 = 0$\n\n将前三个方程相加得到：\n$(-p_1+p_1) + (p_2-2p_2+p_2) + (p_3-p_3) + 3\\lambda = 2-1-1$\n$0 + 0 + 0 + 3\\lambda = 0 \\implies \\lambda=0$。\n出现这种简化是因为满足了对 $\\boldsymbol{b}$ 的相容性条件。当 $\\lambda = 0$ 时，系统简化为：\n1. $-p_1 + p_2 = 2$\n2. $p_1 - 2p_2 + p_3 = -1$\n3. $p_2 - p_3 = -1$\n4. $p_1 + p_2 + p_3 = 0$\n\n从方程 (4) 中，我们将 $p_3$ 表示为 $p_3 = -p_1 - p_2$。\n将此代入方程 (2)：\n$p_1 - 2p_2 + (-p_1 - p_2) = -1$\n$-3p_2 = -1 \\implies p_2 = \\frac{1}{3}$。\n我们也可以将 $p_3$ 代入方程 (3)：\n$p_2 - (-p_1 - p_2) = -1$\n$p_1 + 2p_2 = -1$。\n现在，将 $p_2 = 1/3$ 的值代入此方程：\n$p_1 + 2(\\frac{1}{3}) = -1 \\implies p_1 = -1 - \\frac{2}{3} = -\\frac{5}{3}$。\n我们也可以使用方程 (1) 进行验证：\n$-p_1 + p_2 = -(-\\frac{5}{3}) + \\frac{1}{3} = \\frac{5}{3} + \\frac{1}{3} = \\frac{6}{3} = 2$。 这是一致的。\n最后，我们求出 $p_3$：\n$p_3 = -p_1 - p_2 = -(-\\frac{5}{3}) - (\\frac{1}{3}) = \\frac{5}{3} - \\frac{1}{3} = \\frac{4}{3}$。\n压力的完整解为 $\\boldsymbol{p} = (-\\frac{5}{3}, \\frac{1}{3}, \\frac{4}{3})^T$。\n问题要求的是中心单元的压力，即 $p_2$。\n$$\np_2 = \\frac{1}{3}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$"
        },
        {
            "introduction": "对于大规模模拟，显式地构建和存储雅可比矩阵 $A$ 在内存上是极其昂贵的。现代迭代求解器，尤其是克雷洛夫（Krylov）子空间方法，仅需要矩阵与向量的乘积运算（即 $y = Ax$）。本练习  演示了“无矩阵”（matrix-free）技术，它是现代迭代求解器的基石，你将学习如何即时计算矩阵向量乘积，从而高效地求解庞大的线性系统。",
            "id": "4036875",
            "problem": "考虑计算燃烧学中的一维无量纲反应标量的对流-扩散-反应平衡。设未知增量场为 $x_i$，定义在间距为 $\\Delta x$ 的均匀周期性网格的网格中心 $i \\in \\{0,1,\\dots,N-1\\}$ 上。通量定义在网格 $i$ 和 $i+1$ 之间的网格面 $i+\\tfrac{1}{2}$ 上，采用周期性环绕索引。保守有限体积离散化的离散残差由网格面通量和局部反应项构成。目标是实现线性化离散算子 $A$ 的免矩阵应用，使得 $y = A x$ 通过通量差分和反应贡献来计算，而无需显式组装矩阵 $A$。\n\n从一维控制体中物种质量分数的守恒出发，网格 $i$ 处的典型有限体积残差定义为总通量的散度加上一个反应源项，\n$$\n\\mathcal{R}_i(Y) \\equiv \\frac{F_{i+\\tfrac{1}{2}}(Y) - F_{i-\\tfrac{1}{2}}(Y)}{\\Delta x} + \\omega(Y_i),\n$$\n其中 $F_{i+\\tfrac{1}{2}}(Y)$ 是网格面 $i+\\tfrac{1}{2}$ 处的总通量，由对流通量贡献和扩散通量贡献组成，\n$$\nF_{i+\\tfrac{1}{2}}(Y) = F^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(Y) + F^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(Y).\n$$\n假设对流通量为基于网格面法向速度 $u_{i+\\tfrac{1}{2}}$ 符号的迎风格式，扩散通量为基于菲克扩散的中心格式，其网格面扩散系数为 $D_{i+\\tfrac{1}{2}}$，\n$$\nF^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(Y) =\n\\begin{cases}\nu_{i+\\tfrac{1}{2}}\\, Y_i,  \\text{if } u_{i+\\tfrac{1}{2}} > 0, \\\\\nu_{i+\\tfrac{1}{2}}\\, Y_{i+1},  \\text{if } u_{i+\\tfrac{1}{2}} \\le 0,\n\\end{cases}\n\\qquad\nF^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(Y) = - D_{i+\\tfrac{1}{2}}\\, \\frac{Y_{i+1} - Y_i}{\\Delta x}.\n$$\n我们考虑一种适用于克雷洛夫子空间方法（如广义最小残差（GMRES）方法）的免矩阵线性化。设反应项围绕给定基态 $Y^{\\star}$ 进行线性化，得到局部雅可比 $k_i = \\left.\\dfrac{d\\omega}{dY}\\right|_{Y^{\\star}_i}$，因此对于一个扰动 $x$，线性化的反应贡献为 $k_i\\, x_i$。那么，离散算子 $A$ 对 $x$ 的免矩阵应用可以通过在上述线性通量公式中用 $x$ 替换 $Y$ 来计算通量：\n$$\nF^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x) =\n\\begin{cases}\nu_{i+\\tfrac{1}{2}}\\, x_i,  \\text{if } u_{i+\\tfrac{1}{2}} > 0, \\\\\nu_{i+\\tfrac{1}{2}}\\, x_{i+1},  \\text{if } u_{i+\\tfrac{1}{2}} \\le 0,\n\\end{cases}\n\\qquad\nF^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x) = - D_{i+\\tfrac{1}{2}}\\, \\frac{x_{i+1} - x_i}{\\Delta x},\n$$\n然后\n$$\ny_i \\equiv (A x)_i = \\frac{F_{i+\\tfrac{1}{2}}(x) - F_{i-\\tfrac{1}{2}}(x)}{\\Delta x} + k_i\\, x_i,\n\\quad \\text{with } F_{i+\\tfrac{1}{2}}(x) = F^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x) + F^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x).\n$$\n所有量均为无量纲。通过将索引按模 $N$ 解释来施加周期性边界条件，即 $x_{-1} \\equiv x_{N-1}$ 和 $x_{N} \\equiv x_{0}$。\n\n你的任务是使用上述通量计算来实现免矩阵运算 $y = A x$，而无需组装 $A$。然后，对于下面的测试套件，计算并报告所得的 $y$ 向量。\n\n测试套件（每个案例指定了 $N$、$\\Delta x$、网格面速度 $u_{i+\\tfrac{1}{2}}$、网格面扩散系数 $D_{i+\\tfrac{1}{2}}$、网格反应系数 $k_i$ 和输入向量 $x$）：\n\n- 案例1（纯对流，均匀正速度）：\n  - $N = 6$, $\\Delta x = 1.0$,\n  - $u_{i+\\tfrac{1}{2}} = 2.0$ 对于所有网格面 $i$,\n  - $D_{i+\\tfrac{1}{2}} = 0.0$ 对于所有网格面 $i$,\n  - $k_i = 0.0$ 对于所有网格 $i$,\n  - $x = [1.0, 0.0, -1.0, 2.0, -2.0, 0.5]$.\n\n- 案例2（混合对流、扩散和反应，速度符号变化）：\n  - $N = 6$, $\\Delta x = 1.0$,\n  - $u_{i+\\tfrac{1}{2}} = [1.0, -1.0, 1.0, -1.0, 1.0, -1.0]$,\n  - $D_{i+\\tfrac{1}{2}} = 0.5$ 对于所有网格面 $i$,\n  - $k = [0.2, 0.0, 0.4, 0.0, 0.6, 0.0]$,\n  - $x = [0.3, -0.1, 0.5, -0.2, 0.0, 0.4]$.\n\n- 案例3（纯扩散，无对流，无反应）：\n  - $N = 5$, $\\Delta x = 0.5$,\n  - $u_{i+\\tfrac{1}{2}} = 0.0$ 对于所有网格面 $i$,\n  - $D_{i+\\tfrac{1}{2}} = 1.0$ 对于所有网格面 $i$,\n  - $k_i = 0.0$ 对于所有网格 $i$,\n  - $x = [1.0, -1.0, 2.0, -2.0, 0.5]$.\n\n- 案例4（仅反应，空间变化的线性化反应）：\n  - $N = 4$, $\\Delta x = 1.0$,\n  - $u_{i+\\tfrac{1}{2}} = 0.0$ 对于所有网格面 $i$,\n  - $D_{i+\\tfrac{1}{2}} = 0.0$ 对于所有网格面 $i$,\n  - $k = [10.0, 1.0, 5.0, 0.1]$,\n  - $x = [0.01, 1.0, -0.2, 0.5]$.\n\n最终输出格式：您的程序应生成单行输出，其中包含上述案例的四个结果向量 $y$，格式为用方括号括起来的、无空格的、逗号分隔的列表的列表，例如 $[[y^{(1)}],[y^{(2)}],[y^{(3)}],[y^{(4)}]]$，其中 $[y^{(c)}]$ 表示案例 c 的向量 $y$ 的列表表示形式。",
            "solution": "该问题是有效的，因为它以计算流体动力学原理为科学基础，提供了所有必要信息，是适定的，并且其表述是客观的。它描述了从对流-扩散-反应方程派生出的离散化线性算子的标准免矩阵实现，这是科学计算中的一项常见任务。\n\n目标是计算矩阵-向量乘积 $y = A x$ 的结果，而无需显式构造矩阵 $A$。向量 $y$ 在一维周期性网格上为每个网格 $i$ 逐分量定义：\n$$\ny_i \\equiv (A x)_i = \\frac{F_{i+\\tfrac{1}{2}}(x) - F_{i-\\tfrac{1}{2}}(x)}{\\Delta x} + k_i\\, x_i\n$$\n其中 $i \\in \\{0, 1, \\dots, N-1\\}$。所有索引都按模 $N$ 处理，以强制施加周期性边界条件。项 $k_i x_i$ 是来自线性化反应源的贡献。涉及 $F$ 的项代表流入网格 $i$ 的净通量。\n\n网格面 $i+\\tfrac{1}{2}$ 处的总通量 $F_{i+\\tfrac{1}{2}}(x)$ 是对流通量 $F^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x)$ 和扩散通量 $F^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x)$ 的和。\n\n对流通量由一阶迎风格式给出，该格式根据网格面速度 $u_{i+\\tfrac{1}{2}}$ 的符号从“上游”网格中选择 $x$ 的值：\n$$\nF^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x) =\n\\begin{cases}\nu_{i+\\tfrac{1}{2}}\\, x_i,  \\text{if } u_{i+\\tfrac{1}{2}} > 0, \\\\\nu_{i+\\tfrac{1}{2}}\\, x_{i+1},  \\text{if } u_{i+\\tfrac{1}{2}} \\le 0.\n\\end{cases}\n$$\n\n扩散通量由菲克定律的中心差分近似给出：\n$$\nF^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x) = - D_{i+\\tfrac{1}{2}}\\, \\frac{x_{i+1} - x_i}{\\Delta x}\n$$\n其中 $D_{i+\\tfrac{1}{2}}$ 是网格面扩散系数。\n\n为高效实现运算 $y = A x$，我们可以使用一种向量化方法，该方法避免了对网格单元的显式循环，并且非常适合像 NumPy 这样的库。该策略包括以下步骤：\n\n1.  **将场表示为数组**：网格变量 $x$、$k$ 以及基于网格面的量 $u$、$D$ 表示为长度为 $N$ 的一维 NumPy 数组。\n\n2.  **处理周期性**：网格的周期性意味着网格 $i+1$ 是网格 $i$ 的右邻居，对于 $i=N-1$，右邻居是网格 $0$。类似地，网格 $0$ 的左邻居是网格 $N-1$。这种索引的“环绕”可以使用 `np.roll()` 高效实现。\n    - `np.roll(x, -1)` 创建一个数组，其中第 $i$ 个元素是 $x_{i+1}$。\n    - `np.roll(x, 1)` 创建一个数组，其中第 $i$ 个元素是 $x_{i-1}$。\n\n3.  **向量化计算网格面通量**：我们可以同时计算所有 $N$ 个网格面通量 $F_{i+\\tfrac{1}{2}}$。\n    - 令 `x_p1 = np.roll(x, -1)`。该数组包含值 $\\{x_1, x_2, \\dots, x_{N-1}, x_0\\}$。\n    - 所有网格面的对流通量可以使用 `np.where()` 在单行中计算：\n      `F_adv = u * np.where(u > 0, x, x_p1)`\n    - 所有网格面的扩散通量也是一个简单的向量化操作：\n      `F_diff = -D / dx * (x_p1 - x)`\n    - 总通量向量 `F_total` 是 `F_adv` 和 `F_diff` 的和。`F_total` 的第 $i$ 个元素对应于通量 $F_{i+\\tfrac{1}{2}}$。\n\n4.  **计算通量散度**：网格 $i$ 的通量散度为 $\\frac{F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}}{\\Delta x}$。我们已经有了通量 $F_{i+\\tfrac{1}{2}}$ 的向量。要获得通量 $F_{i-\\tfrac{1}{2}}$ 的向量，我们可以简单地滚动 `F_total` 数组：\n    - 令 `F_total_m1 = np.roll(F_total, 1)`。该数组的第 $i$ 个元素是 $F_{(i-1)+\\tfrac{1}{2}} = F_{i-\\tfrac{1}{2}}$。\n    - 所有网格的散度变为：\n      `div_F = (F_total - F_total_m1) / dx`\n\n5.  **组装最终向量**：最后，通过加上反应项的贡献来获得结果向量 $y$：\n      `y = div_F + k * x`\n\n这个向量化过程在没有任何显式循环的情况下计算整个向量 $y$，利用了 NumPy 对数组操作的优化性能。这是该算子的免矩阵方法论的核心。提供的 Python 代码实现了这个确切的算法来解决这些测试案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef matrix_vector_product(N: int, dx: float, u: list, D: list, k: list, x: list) -> list:\n    \"\"\"\n    Computes the matrix-free application y = Ax for a 1D advection-diffusion-reaction operator.\n\n    Args:\n        N: Number of cells.\n        dx: Grid spacing.\n        u: List of face velocities u_{i+1/2}.\n        D: List of face diffusivities D_{i+1/2}.\n        k: List of cell-centered linearized reaction coefficients k_i.\n        x: Input vector x.\n\n    Returns:\n        The resulting vector y as a list of floats.\n    \"\"\"\n    # Ensure inputs are NumPy arrays for vectorized operations.\n    u_arr = np.asarray(u)\n    D_arr = np.asarray(D)\n    k_arr = np.asarray(k)\n    x_arr = np.asarray(x)\n\n    # Create periodic-shifted versions of the vector x.\n    # x_p1[i] corresponds to x_{i+1} (value from the right neighbor).\n    x_p1 = np.roll(x_arr, -1)\n\n    # 1. Compute advective fluxes at all faces i + 1/2.\n    # The upwind value of x is chosen based on the sign of the velocity u.\n    upwind_x = np.where(u_arr > 0, x_arr, x_p1)\n    F_adv_face = u_arr * upwind_x\n\n    # 2. Compute diffusive fluxes at all faces i + 1/2.\n    F_diff_face = -D_arr / dx * (x_p1 - x_arr)\n\n    # 3. Sum fluxes to get the total flux at faces i + 1/2.\n    # F_total_face[i] corresponds to F_{i+1/2}(x).\n    F_total_face = F_adv_face + F_diff_face\n\n    # 4. Get fluxes at faces i - 1/2 by rolling the total flux array.\n    # F_total_face_m1[i] corresponds to F_{i-1/2}(x).\n    F_total_face_m1 = np.roll(F_total_face, 1)\n\n    # 5. Compute the flux divergence term for each cell i.\n    div_F = (F_total_face - F_total_face_m1) / dx\n\n    # 6. Add the local reaction term to get the final result y = Ax.\n    y = div_F + k_arr * x_arr\n\n    return y.tolist()\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the matrix-vector product,\n    then prints the results in the specified format.\n    \"\"\"\n    test_cases = [\n        # Case 1 (pure advection, uniform positive velocity)\n        {\n            \"N\": 6, \"dx\": 1.0, \"u\": [2.0] * 6, \"D\": [0.0] * 6, \"k\": [0.0] * 6,\n            \"x\": [1.0, 0.0, -1.0, 2.0, -2.0, 0.5]\n        },\n        # Case 2 (mixed advection, diffusion, and reaction with sign-changing velocity)\n        {\n            \"N\": 6, \"dx\": 1.0, \"u\": [1.0, -1.0, 1.0, -1.0, 1.0, -1.0],\n            \"D\": [0.5] * 6, \"k\": [0.2, 0.0, 0.4, 0.0, 0.6, 0.0],\n            \"x\": [0.3, -0.1, 0.5, -0.2, 0.0, 0.4]\n        },\n        # Case 3 (pure diffusion, no advection, no reaction)\n        {\n            \"N\": 5, \"dx\": 0.5, \"u\": [0.0] * 5, \"D\": [1.0] * 5, \"k\": [0.0] * 5,\n            \"x\": [1.0, -1.0, 2.0, -2.0, 0.5]\n        },\n        # Case 4 (reaction only, spatially varying linearized reaction)\n        {\n            \"N\": 4, \"dx\": 1.0, \"u\": [0.0] * 4, \"D\": [0.0] * 4,\n            \"k\": [10.0, 1.0, 5.0, 0.1], \"x\": [0.01, 1.0, -0.2, 0.5]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        y_vector = matrix_vector_product(\n            case[\"N\"], case[\"dx\"], case[\"u\"], case[\"D\"], case[\"k\"], case[\"x\"]\n        )\n        results.append(y_vector)\n\n    # Format the final output string as a list of lists with no spaces.\n    # e.g., [[val1,val2],[val3,val4]] -> \"[[val1,val2],[val3,val4]]\"\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}