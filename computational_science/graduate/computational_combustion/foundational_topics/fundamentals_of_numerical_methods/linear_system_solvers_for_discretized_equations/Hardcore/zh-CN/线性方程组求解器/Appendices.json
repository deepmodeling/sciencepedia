{
    "hands_on_practices": [
        {
            "introduction": "要有效求解一个线性系统，首要步骤是理解其底层矩阵的性质。物理守恒定律（如对流-扩散方程）的离散化过程往往会产生具有特定结构的矩阵。通过运用格什戈林圆盘定理等分析工具，我们可以揭示这些性质，例如对角占优性，这对于预测迭代求解器（如雅可比法）的收敛性至关重要。这项练习将通过分析一个典型的一维对流-扩散问题，展示如何从离散格式推导矩阵属性，并将其与求解器的稳定性和性能直接联系起来 。",
            "id": "4036826",
            "problem": "考虑在性质恒定的预混气体混合物中的一维物种输运，该过程由以下偏微分方程 (PDE) 建模\n$$\n\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^{2} Y}{\\partial x^{2}},\n$$\n其中 $Y(x,t)$ 是物种质量分数，$u>0$ 是恒定的平流速度，$D>0$ 是恒定的分子扩散率。假设在有限区间上采用Dirichlet边界条件。在间距为 $\\Delta x$ 的均匀网格上对空间进行离散，并使用后向欧拉方法以时间步长 $\\Delta t$ 对时间进行离散，其中对流项采用一阶迎风格式，扩散项采用二阶中心差分格式，所有项均在新时间层上计算。这将得到一个线性系统\n$$\nA \\mathbf{y}^{n+1} = \\mathbf{y}^{n},\n$$\n其中 $A$ 是一个三对角矩阵，其内部行的系数为\n$$\na_{i,i} = \\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}, \\quad a_{i,i-1} = -\\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right), \\quad a_{i,i+1} = -\\frac{D}{\\Delta x^{2}}.\n$$\n定义无量纲的平流和扩散度量\n$$\nC = \\frac{u \\Delta t}{\\Delta x}, \\qquad S = \\frac{D \\Delta t}{\\Delta x^{2}}.\n$$\n利用Gershgorin圆盘定理和矩阵 $A$ 的结构，推导 $A$ 的内部行对应特征值的界，并解释这些界如何体现对角占优性以及如何与定常线性求解器的稳定性相关。然后，考虑应用于 $A \\mathbf{y} = \\mathbf{b}$ 的Jacobi迭代，其迭代矩阵为 $T_{J} = D^{-1}(L+U)$，其中 $D$ 是 $A$ 的对角部分，$L$ 和 $U$ 分别是其严格下三角和上三角部分。使用Gershgorin定理和范数界，获得一个仅用 $C$ 和 $S$ 表示的 $T_{J}$ 谱半径的闭式上界。请将此上界作为最终答案。不需要进行数值计算。如果引入任何角度，请以弧度表示。由于最终答案是符号形式，因此没有舍入要求。",
            "solution": "经评估，该问题陈述是有效的。对于所提问题而言，它是科学严谨、适定、客观且内部一致的。该问题涉及一维平流扩散方程的标准有限差分离散的数值分析。尽管所给的线性系统中存在一个微小的不一致（右侧项应乘以 $1/\\Delta t$），但这不影响矩阵 $A$ 或其相关的Jacobi迭代矩阵 $T_J$ 的性质，而这些正是本分析的主题。因此，所提出的问题可以被严格地回答。\n\n让我们开始分析矩阵 $A$。问题要求将Gershgorin圆盘定理应用于离散化后得到的矩阵 $A$。该定理指出，一个方阵 $M$ 的每个特征值 $\\lambda$ 都位于复平面上的至少一个Gershgorin圆盘 $G_i$ 内，其中 $G_i = \\{ z \\in \\mathbb{C} : |z - m_{i,i}| \\le R_i \\}$，$m_{i,i}$ 是第 $i$ 行的对角元，$R_i = \\sum_{j \\neq i} |m_{i,j}|$ 是该行非对角元绝对值之和。\n\n对于矩阵 $A$ 的一个内部行 $i$，其系数如下：\n$$\na_{i,i} = \\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\n$$\n$$\na_{i,i-1} = -\\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right)\n$$\n$$\na_{i,i+1} = -\\frac{D}{\\Delta x^{2}}\n$$\nGershgorin圆盘 $G_i$ 的圆心是对角元 $a_{i,i}$。其半径 $R_i$ 是第 $i$ 行非对角元绝对值之和：\n$$\nR_i = |a_{i,i-1}| + |a_{i,i+1}| = \\left|-\\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right)\\right| + \\left|-\\frac{D}{\\Delta x^{2}}\\right|\n$$\n由于 $u > 0$，$D > 0$ 且 $\\Delta x > 0$，绝对值内的项均为正，因此：\n$$\nR_i = \\left(\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}\\right) + \\frac{D}{\\Delta x^{2}} = \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\n$$\n如果对于所有行 $i$ 都有 $|a_{i,i}| > \\sum_{j \\neq i} |a_{i,j}|$，则该矩阵是行严格对角占优的。我们来检验矩阵 $A$ 的内部行是否满足此条件。由于 $u$、$D$、$\\Delta t$、$\\Delta x$ 均为正值，$a_{i,i}$ 也是正值，所以 $|a_{i,i}| = a_{i,i}$。\n$$\n|a_{i,i}| - R_i = \\left(\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right) - \\left(\\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right) = \\frac{1}{\\Delta t}\n$$\n因为 $\\Delta t > 0$，我们有 $|a_{i,i}| - R_i = \\frac{1}{\\Delta t} > 0$，这意味着 $|a_{i,i}| > R_i$。因此，矩阵 $A$ 对其内部行是严格对角占优的。这个性质如果对所有行都成立（这对于带有Dirichlet边界条件的此类离散化是典型情况），则保证了 $A$ 是可逆的。此外，它还保证了诸如Jacobi和Gauss-Seidel方法之类的定常迭代法在应用于系统 $A\\mathbf{x} = \\mathbf{b}$ 时将会收敛。对角占优的‘程度’，由比率 $R_i/|a_{i,i}|$ 来量化，影响了这些求解器的收敛速率。\n\nGershgorin圆盘定理给出了 $A$ 的特征值 $\\lambda$ 的界。对于任意特征值 $\\lambda$，存在某行 $i$ 使得 $|\\lambda - a_{i,i}| \\le R_i$。这意味着 $\\lambda$ 的实部被界定在 $a_{i,i} - R_i \\le \\text{Re}(\\lambda) \\le a_{i,i} + R_i$ 之间。使用内部行的结果，我们发现：\n$$\n\\lambda_{\\text{min, bound}} = a_{i,i} - R_i = \\frac{1}{\\Delta t}\n$$\n$$\n\\lambda_{\\text{max, bound}} = a_{i,i} + R_i = \\frac{1}{\\Delta t} + \\frac{2u}{\\Delta x} + \\frac{4D}{\\Delta x^{2}}\n$$\n由于所有圆盘的圆心都在正实轴上，且其半径小于圆心值，因此所有特征值必有正实部。事实上，由于 $A$ 是一个具有非正非对角元且对角元为正的严格对角占优实矩阵，它是一个M-矩阵，其所有特征值均为实数且为正。最小特征值的下界为 $\\lambda_{min} \\ge \\frac{1}{\\Delta t} > 0$。\n\n接下来，我们分析用于求解 $A\\mathbf{y} = \\mathbf{b}$ 的Jacobi迭代法。矩阵 $A$ 被分解为其对角部分 $D_{A}$、严格下三角部分 $L_{A}$ 和严格上三角部分 $U_{A}$，使得 $A = D_{A} - L_{A} - U_{A}$。问题中使用了符号 $D$、$L$、$U$，但为了避免与扩散率 $D$ 混淆，我们使用了下标。问题陈述 $T_J = D^{-1}(L+U)$，这对应于 $A = D-(L+U)$，因此 $L_{A}$ 和 $U_{A}$ 的定义带有正项（即 $A$ 的非对角元的相反数）。\nJacobi迭代矩阵为 $T_J = D_{A}^{-1}(L_{A} + U_{A})$。如果 $T_J$ 的谱半径（记为 $\\rho(T_J)$）小于1，则Jacobi方法的收敛性得到保证。我们可以使用矩阵范数来找到 $\\rho(T_J)$ 的一个上界，因为对于任何相容的矩阵范数，都有 $\\rho(T_J) \\le \\|T_J\\|$。我们使用无穷范数 $\\|T_J\\|_{\\infty}$，即最大绝对行和。\n$T_J$ 的元素由 $(T_J)_{ij} = -a_{ij}/a_{ii}$（当 $i \\neq j$ 时）和 $(T_J)_{ii} = 0$ 给出。\n对于一个内部行 $i$，非零元素为：\n$$\n(T_J)_{i, i-1} = \\frac{-a_{i,i-1}}{a_{i,i}} = \\frac{\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}\n$$\n$$\n(T_J)_{i, i+1} = \\frac{-a_{i,i+1}}{a_{i,i}} = \\frac{\\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}\n$$\n一个内部行 $i$ 的绝对行和为：\n$$\n\\sum_{j}|(T_J)_{ij}| = |(T_J)_{i, i-1}| + |(T_J)_{i, i+1}| = \\frac{\\frac{u}{\\Delta x} + \\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}} + \\frac{\\frac{D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}} = \\frac{\\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}{\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}}\n$$\n这也是 $T_J$ 的第 $i$ 行对应的Gershgorin圆盘的半径，该圆盘以0为中心。\n\n问题要求此界用无量纲的Courant数 $C = \\frac{u \\Delta t}{\\Delta x}$ 和扩散数 $S = \\frac{D \\Delta t}{\\Delta x^{2}}$ 来表示。我们可以通过分子分母同乘 $\\Delta t$ 来重写行和：\n$$\n\\frac{\\Delta t \\left(\\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right)}{\\Delta t \\left(\\frac{1}{\\Delta t} + \\frac{u}{\\Delta x} + \\frac{2D}{\\Delta x^{2}}\\right)} = \\frac{\\frac{u \\Delta t}{\\Delta x} + \\frac{2D \\Delta t}{\\Delta x^{2}}}{1 + \\frac{u \\Delta t}{\\Delta x} + \\frac{2D \\Delta t}{\\Delta x^{2}}} = \\frac{C + 2S}{1 + C + 2S}\n$$\n系统的第一行和最后一行的行和将小于此值，因此这个内部行的行和表达式代表了整个矩阵 $T_J$ 的最大绝对行和。\n因此，$\\|T_J\\|_{\\infty} = \\frac{C + 2S}{1 + C + 2S}$。\n这为谱半径提供了一个上界：\n$$\n\\rho(T_J) \\le \\|T_J\\|_{\\infty} = \\frac{C + 2S}{1 + C + 2S}\n$$\n由于 $C > 0$ 且 $S > 0$，分子 $C+2S$ 严格小于分母 $1+C+2S$。这意味着对于任何物理和数值参数的选择，都有 $\\rho(T_J) < 1$，这保证了对于此问题Jacobi迭代总是收敛的。这种无条件收敛是隐式时间离散格式所建立的严格对角占优性的直接结果。最终要求的答案就是这个谱半径的上界。",
            "answer": "$$\n\\boxed{\\frac{C + 2S}{1 + C + 2S}}\n$$"
        },
        {
            "introduction": "在计算燃烧学中，并非所有线性系统都像前一个例子那样是良态可逆的。一个典型的挑战来自于求解压力泊松方程，它在执行低马赫数流动的质量守恒约束时出现。由于物理上的不确定性（压力仅能被确定到一个任意常数），该方程在纯诺伊曼边界条件下是奇异的。这项练习旨在揭示这种奇异性的根源，并演示如何通过施加额外的数学约束（例如零均值条件）来恢复系统的唯一可解性，这是处理不可压缩流或低马赫数流求解器时的一项核心技能 。",
            "id": "4036855",
            "problem": "在计算燃烧学中典型的低马赫数反应流中，速度场通过投影法进行推进，该方法通过压力修正来强制执行质量守恒。考虑示意性地写为 $\\,\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\star}-\\Delta t\\,\\nabla p\\,$ 的速度更新，其中 $\\,\\boldsymbol{u}^{\\star}\\,$ 是从平流、扩散和体积源项中获得的临时速度。对低马赫数公式的质量守恒离散形式强制执行，会得到一个形式为 $\\,\\nabla^{2}p=g\\,$ 的压力泊松方程，在所有不可穿透边界上具有齐次诺伊曼边界条件 $\\,\\partial p/\\partial n=0\\,$。在此背景下：\n- 从质量守恒要求 $\\,\\nabla\\cdot\\boldsymbol{u}^{n+1}=0\\,$ 和速度更新出发，推导压力泊松方程，并证明纯诺伊曼边界条件意味着 $\\,p\\,$ 的非唯一性。在连续层面上识别其零空间，并推导源项 $\\,g\\,$ 的相关相容性条件。\n- 使用一个包含 $\\,N=3\\,$ 个控制体的均匀、单元中心的有限体积网格，在区间 $[0,1]$ 上对一维问题进行离散化，并在两端施加齐次诺伊曼边界条件。令 $\\,\\boldsymbol{p}=(p_{1},p_{2},p_{3})^{T}\\,$ 表示单元中心的压力未知数，并令离散算子（在将网格间距缩放吸收进右侧项后）写为\n$$\nA=\\begin{pmatrix}\n-1  1  0\\\\\n1  -2  1\\\\\n0  1  -1\n\\end{pmatrix},\\qquad \\text{使得}\\qquad A\\,\\boldsymbol{p}=\\boldsymbol{b}.\n$$\n证明 $\\,A\\,$ 是秩亏的，并识别其零空间以及右端项 $\\,\\boldsymbol{b}\\,$ 的离散相容性条件。\n- 解释如何通过对 $\\,\\boldsymbol{p}\\,$ 施加一个与均匀单元体积一致的零均值约束来恢复可解性和唯一性，并写出强制执行 $\\,\\sum_{i=1}^{3}p_{i}=0\\,$ 的相应增广鞍点系统。\n- 最后，对于特定的右端项 $\\,\\boldsymbol{b}=(2,-1,-1)^{T}\\,$，求解该增广系统并报告中心单元的压力 $\\,p_{2}\\,$。给出精确值，该值应为纯数（无量纲），不带单位且不进行四舍五入。",
            "solution": "该问题分为四个部分。我们将按顺序进行解答。\n\n首先，我们推导压力泊松方程，并在连续层面上分析其性质。\n在新的时间步长，速度场 $\\boldsymbol{u}^{n+1}$ 由以下更新公式给出：\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla p\n$$\n其中 $\\boldsymbol{u}^{\\star}$ 是一个临时速度，$p$ 是压力修正。这个新的速度场必须满足低马赫数流动的质量守恒要求，该要求表示为无散条件：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0\n$$\n为了推导 $p$ 的方程，我们对速度更新方程取散度：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot (\\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla p)\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla \\cdot (\\nabla p)\n$$\n使用恒等式 $\\nabla \\cdot (\\nabla p) = \\nabla^2 p$（$p$ 的拉普拉斯算子），并强制执行质量守恒条件 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$，我们得到：\n$$\n0 = \\nabla \\cdot \\boldsymbol{u}^{\\star} - \\Delta t \\, \\nabla^2 p\n$$\n重新整理此方程可得到压力泊松方程：\n$$\n\\nabla^2 p = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\star}\n$$\n该方程的形式为 $\\nabla^2 p = g$，其中源项 $g$ 被确定为 $g = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\star}$。\n\n接下来，我们证明在纯齐次诺伊曼边界条件 $\\frac{\\partial p}{\\partial n} = 0$ 下解 $p$ 的非唯一性。设 $p(\\boldsymbol{x})$ 是该问题的一个解。考虑一个新函数 $\\tilde{p}(\\boldsymbol{x}) = p(\\boldsymbol{x}) + C$，其中 $C$ 是一个任意常数。\n1.  $\\tilde{p}$ 的泊松方程是 $\\nabla^2 \\tilde{p} = \\nabla^2(p + C) = \\nabla^2 p + \\nabla^2 C = \\nabla^2 p + 0 = g$。所以，$\\tilde{p}$ 满足泊松方程。\n2.  $\\tilde{p}$ 的边界条件是 $\\frac{\\partial \\tilde{p}}{\\partial n} = \\frac{\\partial (p+C)}{\\partial n} = \\frac{\\partial p}{\\partial n} + \\frac{\\partial C}{\\partial n} = 0 + 0 = 0$。所以，$\\tilde{p}$ 满足齐次诺伊曼边界条件。\n由于对于任何常数 $C$，$\\tilde{p} = p+C$ 也是一个解，因此解不是唯一的；它仅在相差一个加性常数的意义下是确定的。在这些边界条件下，拉普拉斯算子的零空间是其拉普拉斯值为零的函数集合，即调和函数。加上边界上法向导数为零的额外约束，唯一可能的函数是常数函数。因此，零空间是所有常数函数的集合。\n\n为了推导相容性条件，我们在整个域 $\\Omega$ 上对泊松方程进行积分：\n$$\n\\int_{\\Omega} \\nabla^2 p \\, dV = \\int_{\\Omega} g \\, dV\n$$\n对左侧应用散度定理，我们将拉普拉斯算子（梯度的散度）的体积分转换成梯度通量的面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla p) \\, dV = \\oint_{\\partial\\Omega} (\\nabla p) \\cdot \\boldsymbol{n} \\, dS\n$$\n其中 $\\partial\\Omega$ 是域的边界，$\\boldsymbol{n}$ 是向外的单位法向量。项 $(\\nabla p) \\cdot \\boldsymbol{n}$ 是法线方向的方向导数 $\\frac{\\partial p}{\\partial n}$。问题指定在所有边界上都有齐次诺伊曼边界条件 $\\frac{\\partial p}{\\partial n} = 0$。因此，面积分为零：\n$$\n\\oint_{\\partial\\Omega} \\frac{\\partial p}{\\partial n} \\, dS = \\oint_{\\partial\\Omega} 0 \\, dS = 0\n$$\n这意味着积分后的泊松方程的右侧也必须为零。这就给出了相容性条件：\n$$\n\\int_{\\Omega} g \\, dV = 0\n$$\n为了使解存在，源项在整个域上的积分必须为零。\n\n第二，我们分析离散一维问题。该系统为 $A\\boldsymbol{p} = \\boldsymbol{b}$，其中矩阵 $A$ 如下所示：\n$$\nA = \\begin{pmatrix} -1  1  0 \\\\ 1  -2  1 \\\\ 0  1  -1 \\end{pmatrix}\n$$\n为了证明 $A$ 是秩亏的，我们可以计算其行列式：\n$$\n\\det(A) = -1 \\cdot ((-2)(-1) - (1)(1)) - 1 \\cdot ((1)(-1) - (1)(0)) + 0 = -1(1) - 1(-1) = -1 + 1 = 0\n$$\n由于行列式为零，该矩阵是奇异的，因此是秩亏的。$A$ 的秩小于 $3$。\n为了识别零空间，我们寻找一个非零向量 $\\boldsymbol{v}=(v_1, v_2, v_3)^T$ 使得 $A\\boldsymbol{v} = \\boldsymbol{0}$：\n$$\n\\begin{pmatrix} -1  1  0 \\\\ 1  -2  1 \\\\ 0  1  -1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了方程组：\n1. $-v_1 + v_2 = 0 \\implies v_1 = v_2$\n2. $v_1 - 2v_2 + v_3 = 0$\n3. $v_2 - v_3 = 0 \\implies v_2 = v_3$\n从这些方程中，我们得到 $v_1 = v_2 = v_3$。因此，零空间中的任何向量都是向量 $\\boldsymbol{1}=(1, 1, 1)^T$ 的标量倍数。零空间是 $\\text{span}(\\{(1, 1, 1)^T\\})$，这是常数函数空间的离散类比。\n\n为了使奇异系统 $A\\boldsymbol{p} = \\boldsymbol{b}$ 有解，右端项向量 $\\boldsymbol{b}$ 必须与 $A^T$ 的零空间正交。由于 $A$ 是对称的（$A=A^T$），其零空间和左零空间是相同的。相容性条件是 $\\boldsymbol{b}$ 必须与 $A$ 的零空间正交。设 $\\boldsymbol{v}_{\\text{null}} = (1, 1, 1)^T$ 是零空间的基向量。该条件是：\n$$\n\\boldsymbol{v}_{\\text{null}}^T \\boldsymbol{b} = 0 \\implies (1, 1, 1) \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix} = 0 \\implies b_1 + b_2 + b_3 = 0\n$$\n这是离散相容性条件，类似于 $\\int g \\, dV = 0$。\n\n第三，我们解释如何恢复可解性和唯一性。$A$ 的奇异性导致解不唯一。我们可以通过对 $\\boldsymbol{p}$ 施加一个额外约束来获得唯一解。问题建议使用零均值约束 $\\sum_{i=1}^3 p_i = 0$。这个条件消除了解中的任意加性常数。组合起来的问题是在约束 $\\boldsymbol{1}^T \\boldsymbol{p} = 0$ 下求解 $A\\boldsymbol{p} = \\boldsymbol{b}$。这可以通过引入一个拉格朗日乘子 $\\lambda$ 来构造一个增广鞍点系统。该系统是：\n$$\n\\begin{pmatrix} A  \\boldsymbol{1} \\\\ \\boldsymbol{1}^T  0 \\end{pmatrix} \\begin{pmatrix} \\boldsymbol{p} \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} \\boldsymbol{b} \\\\ 0 \\end{pmatrix}\n$$\n代入给定的矩阵 $A$ 和向量 $\\boldsymbol{1}=(1, 1, 1)^T$，增广系统为：\n$$\n\\begin{pmatrix}\n-1  1  0  1 \\\\\n1  -2  1  1 \\\\\n0  1  -1  1 \\\\\n1  1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\np_1 \\\\ p_2 \\\\ p_3 \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_1 \\\\ b_2 \\\\ b_3 \\\\ 0\n\\end{pmatrix}\n$$\n这个增广矩阵是非奇异的，因此系统对 $(\\boldsymbol{p}, \\lambda)$ 有唯一解。\n\n最后，我们对特定的右端项 $\\boldsymbol{b} = (2, -1, -1)^T$ 求解此增广系统。首先，我们检查相容性条件：$b_1+b_2+b_3 = 2 + (-1) + (-1) = 0$。条件满足，因此解存在。方程组为：\n$$\n\\begin{pmatrix}\n-1  1  0  1 \\\\\n1  -2  1  1 \\\\\n0  1  -1  1 \\\\\n1  1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\np_1 \\\\ p_2 \\\\ p_3 \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 \\\\ -1 \\\\ -1 \\\\ 0\n\\end{pmatrix}\n$$\n这代表了四个线性方程：\n1. $-p_1 + p_2 + \\lambda = 2$\n2. $p_1 - 2p_2 + p_3 + \\lambda = -1$\n3. $p_2 - p_3 + \\lambda = -1$\n4. $p_1 + p_2 + p_3 = 0$\n\n将前三个方程相加得到：\n$(-p_1+p_1) + (p_2-2p_2+p_2) + (p_3-p_3) + 3\\lambda = 2-1-1$\n$0 + 0 + 0 + 3\\lambda = 0 \\implies \\lambda=0$。\n出现这种简化是因为 $\\boldsymbol{b}$ 的相容性条件得到了满足。当 $\\lambda = 0$ 时，系统简化为：\n1. $-p_1 + p_2 = 2$\n2. $p_1 - 2p_2 + p_3 = -1$\n3. $p_2 - p_3 = -1$\n4. $p_1 + p_2 + p_3 = 0$\n\n从方程(4)中，我们将 $p_3$ 表示为 $p_3 = -p_1 - p_2$。\n将其代入方程(2)：\n$p_1 - 2p_2 + (-p_1 - p_2) = -1$\n$-3p_2 = -1 \\implies p_2 = \\frac{1}{3}$。\n我们也可以将 $p_3$ 代入方程(3)：\n$p_2 - (-p_1 - p_2) = -1$\n$p_1 + 2p_2 = -1$。\n现在，将 $p_2 = 1/3$ 的值代入此方程：\n$p_1 + 2(\\frac{1}{3}) = -1 \\implies p_1 = -1 - \\frac{2}{3} = -\\frac{5}{3}$。\n我们也可以使用方程(1)来验证：\n$-p_1 + p_2 = -(-\\frac{5}{3}) + \\frac{1}{3} = \\frac{5}{3} + \\frac{1}{3} = \\frac{6}{3} = 2$。这是吻合的。\n最后，我们求得 $p_3$：\n$p_3 = -p_1 - p_2 = -(-\\frac{5}{3}) - (\\frac{1}{3}) = \\frac{5}{3} - \\frac{1}{3} = \\frac{4}{3}$。\n压力的完整解是 $\\boldsymbol{p} = (-\\frac{5}{3}, \\frac{1}{3}, \\frac{4}{3})^T$。\n问题要求的是中心单元的压力，即 $p_2$。\n$$\np_2 = \\frac{1}{3}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$"
        },
        {
            "introduction": "对于实际的大规模燃烧模拟，显式地构建和存储雅可比矩阵在内存和计算成本上往往是不可行的。幸运的是，许多先进的迭代求解器，特别是Krylov子空间方法（如GMRES），并不需要矩阵的完整信息，而只需要一个能够计算矩阵与给定向量之乘积（即 $Ax$）的函数。这项核心技术被称为“免矩阵”方法。本实践练习将指导你通过编程实现这样一个免矩阵算子，直接利用单元交界面上的通量计算来完成矩阵向量乘法，从而掌握开发高效、可扩展求解器的关键实践技能 。",
            "id": "4036875",
            "problem": "考虑计算燃烧学中反应标量的一维无量纲对流-扩散-反应平衡。设未知增量场为 $x_i$，定义在间距为 $\\Delta x$ 的均匀周期性网格的网格中心 $i \\in \\{0,1,\\dots,N-1\\}$ 上。通量定义在网格单元 $i$ 和 $i+1$ 之间的网格面 $i+\\tfrac{1}{2}$ 上，索引采用周期性环绕方式。守恒有限体积离散化的离散残差由面通量和局部反应项构成。目标是实现线性化离散算子 $A$ 的免矩阵应用，使得 $y = A x$ 通过通量差分和反应贡献来计算，而无需显式组装矩阵 $A$。\n\n从一维控制体中物种质量分数的守恒出发，网格单元 $i$ 处的典型有限体积残差定义为总通量的散度加上一个反应源项，\n$$\n\\mathcal{R}_i(Y) \\equiv \\frac{F_{i+\\tfrac{1}{2}}(Y) - F_{i-\\tfrac{1}{2}}(Y)}{\\Delta x} + \\omega(Y_i),\n$$\n其中 $F_{i+\\tfrac{1}{2}}(Y)$ 是网格面 $i+\\tfrac{1}{2}$ 上的总通量，由对流通量贡献和扩散通量贡献组成，\n$$\nF_{i+\\tfrac{1}{2}}(Y) = F^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(Y) + F^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(Y).\n$$\n假设对流通量为基于面法向速度 $u_{i+\\tfrac{1}{2}}$ 符号的迎风格式，扩散通量为基于菲克扩散的中心格式，其面扩散系数为 $D_{i+\\tfrac{1}{2}}$，\n$$\nF^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(Y) =\n\\begin{cases}\nu_{i+\\tfrac{1}{2}}\\, Y_i,  \\text{if } u_{i+\\tfrac{1}{2}} > 0, \\\\\nu_{i+\\tfrac{1}{2}}\\, Y_{i+1},  \\text{if } u_{i+\\tfrac{1}{2}} \\le 0,\n\\end{cases}\n\\qquad\nF^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(Y) = - D_{i+\\tfrac{1}{2}}\\, \\frac{Y_{i+1} - Y_i}{\\Delta x}.\n$$\n我们考虑一种适用于克雷洛夫子空间方法（如广义最小残差(GMRES)方法）的免矩阵线性化。设反应项在给定基态 $Y^{\\star}$ 附近进行线性化，得到局部雅可比 $k_i = \\left.\\dfrac{d\\omega}{dY}\\right|_{Y^{\\star}_i}$，因此对于一个扰动 $x$，线性化的反应贡献为 $k_i\\, x_i$。那么，离散算子 $A$ 对 $x$ 的免矩阵应用可以通过将上述线性通量公式中的 $Y$ 替换为 $x$ 来计算通量：\n$$\nF^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x) =\n\\begin{cases}\nu_{i+\\tfrac{1}{2}}\\, x_i,  \\text{if } u_{i+\\tfrac{1}{2}} > 0, \\\\\nu_{i+\\tfrac{1}{2}}\\, x_{i+1},  \\text{if } u_{i+\\tfrac{1}{2}} \\le 0,\n\\end{cases}\n\\qquad\nF^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x) = - D_{i+\\tfrac{1}{2}}\\, \\frac{x_{i+1} - x_i}{\\Delta x},\n$$\n然后\n$$\ny_i \\equiv (A x)_i = \\frac{F_{i+\\tfrac{1}{2}}(x) - F_{i-\\tfrac{1}{2}}(x)}{\\Delta x} + k_i\\, x_i,\n\\quad \\text{with } F_{i+\\tfrac{1}{2}}(x) = F^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x) + F^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x).\n$$\n所有物理量都是无量纲的。通过将索引解释为模 $N$（即 $x_{-1} \\equiv x_{N-1}$ 和 $x_{N} \\equiv x_{0}$）来施加周期性边界条件。\n\n你的任务是使用上述通量计算来实现免矩阵运算 $y = A x$，而无需组装 $A$。然后，对于下面的测试套件，计算并报告生成的 $y$ 向量。\n\n测试套件（每个案例指定了 $N$、$\\Delta x$、面速度 $u_{i+\\tfrac{1}{2}}$、面扩散系数 $D_{i+\\tfrac{1}{2}}$、网格反应系数 $k_i$ 和输入向量 $x$）：\n\n- 案例 1（纯对流，均匀正速度）：\n  - $N = 6$，$\\Delta x = 1.0$，\n  - 对所有面 $i$，$u_{i+\\tfrac{1}{2}} = 2.0$，\n  - 对所有面 $i$，$D_{i+\\tfrac{1}{2}} = 0.0$，\n  - 对所有单元 $i$，$k_i = 0.0$，\n  - $x = [1.0, 0.0, -1.0, 2.0, -2.0, 0.5]$。\n\n- 案例 2（混合对流、扩散和反应，速度符号变化）：\n  - $N = 6$，$\\Delta x = 1.0$，\n  - $u_{i+\\tfrac{1}{2}} = [1.0, -1.0, 1.0, -1.0, 1.0, -1.0]$，\n  - 对所有面 $i$，$D_{i+\\tfrac{1}{2}} = 0.5$，\n  - $k = [0.2, 0.0, 0.4, 0.0, 0.6, 0.0]$，\n  - $x = [0.3, -0.1, 0.5, -0.2, 0.0, 0.4]$。\n\n- 案例 3（纯扩散，无对流，无反应）：\n  - $N = 5$，$\\Delta x = 0.5$，\n  - 对所有面 $i$，$u_{i+\\tfrac{1}{2}} = 0.0$，\n  - 对所有面 $i$，$D_{i+\\tfrac{1}{2}} = 1.0$，\n  - 对所有单元 $i$，$k_i = 0.0$，\n  - $x = [1.0, -1.0, 2.0, -2.0, 0.5]$。\n\n- 案例 4（仅反应，空间变化的线性化反应）：\n  - $N = 4$，$\\Delta x = 1.0$，\n  - 对所有面 $i$，$u_{i+\\tfrac{1}{2}} = 0.0$，\n  - 对所有面 $i$，$D_{i+\\tfrac{1}{2}} = 0.0$，\n  - $k = [10.0, 1.0, 5.0, 0.1]$，\n  - $x = [0.01, 1.0, -0.2, 0.5]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含上述案例的四个结果向量 $y$，格式为方括号括起来的、以逗号分隔的列表的列表，不含空格，例如 $[[y^{(1)}],[y^{(2)}],[y^{(3)}],[y^{(4)}]]$，其中 $[y^{(c)}]$ 表示案例 $c$ 的向量 $y$ 的列表表示。",
            "solution": "该问题是有效的，因为它以计算流体动力学原理为科学基础，提供了所有必要信息，是适定的，并且其表述是客观的。它描述了从对流-扩散-反应方程派生出的离散线性算子的标准免矩阵实现，这是科学计算中的一项常见任务。\n\n目标是计算矩阵-向量乘积 $y = A x$ 的结果，而无需显式地构建矩阵 $A$。向量 $y$ 在一维周期性网格上为每个网格单元 $i$ 按分量定义：\n$$\ny_i \\equiv (A x)_i = \\frac{F_{i+\\tfrac{1}{2}}(x) - F_{i-\\tfrac{1}{2}}(x)}{\\Delta x} + k_i\\, x_i\n$$\n其中 $i \\in \\{0, 1, \\dots, N-1\\}$。所有索引都按模 $N$ 处理，以强制施加周期性边界条件。项 $k_i x_i$ 是来自线性化反应源的贡献。涉及 $F$ 的项表示流入网格单元 $i$ 的净通量。\n\n网格面上的总通量 $F_{i+\\tfrac{1}{2}}(x)$ 是对流通量 $F^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x)$ 和扩散通量 $F^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x)$ 的和。\n\n对流通量由一阶迎风格式给出，该格式根据面速度 $u_{i+\\tfrac{1}{2}}$ 的符号从“迎风”单元中选择 $x$ 的值：\n$$\nF^{\\mathrm{adv}}_{i+\\tfrac{1}{2}}(x) =\n\\begin{cases}\nu_{i+\\tfrac{1}{2}}\\, x_i,  \\text{if } u_{i+\\tfrac{1}{2}} > 0, \\\\\nu_{i+\\tfrac{1}{2}}\\, x_{i+1},  \\text{if } u_{i+\\tfrac{1}{2}} \\le 0.\n\\end{cases}\n$$\n\n扩散通量由菲克定律的中心差分近似给出：\n$$\nF^{\\mathrm{diff}}_{i+\\tfrac{1}{2}}(x) = - D_{i+\\tfrac{1}{2}}\\, \\frac{x_{i+1} - x_i}{\\Delta x}\n$$\n其中 $D_{i+\\tfrac{1}{2}}$ 是面扩散系数。\n\n为了高效地实现运算 $y = A x$，我们可以使用一种矢量化方法，它避免了对网格单元的显式循环，并且非常适合像 NumPy 这样的库。该策略包括以下步骤：\n\n1.  **将场表示为数组**：网格变量 $x$、$k$ 以及基于面的量 $u$、$D$ 表示为长度为 $N$ 的一维 NumPy 数组。\n\n2.  **处理周期性**：网格的周期性意味着单元 $i+1$ 是单元 $i$ 的右邻居，对于 $i=N-1$，右邻居是单元 $0$。类似地，单元 $0$ 的左邻居是单元 $N-1$。这种索引的“环绕”可以使用 `np.roll()` 高效实现。\n    - `np.roll(x, -1)` 创建一个数组，其中第 $i$ 个元素是 $x_{i+1}$。\n    - `np.roll(x, 1)` 创建一个数组，其中第 $i$ 个元素是 $x_{i-1}$。\n\n3.  **矢量化计算面通量**：我们可以同时计算所有 $N$ 个面通量 $F_{i+\\tfrac{1}{2}}$。\n    - 令 `x_p1 = np.roll(x, -1)`。这个数组包含值 $\\{x_1, x_2, \\dots, x_{N-1}, x_0\\}$。\n    - 所有面的对流通量可以使用 `np.where()` 在一行中计算：\n      `F_adv = u * np.where(u > 0, x, x_p1)`\n    - 所有面的扩散通量也是一个简单的矢量化操作：\n      `F_diff = -D / dx * (x_p1 - x)`\n    - 总通量向量 `F_total` 是 `F_adv` 和 `F_diff` 的和。 `F_total` 的第 $i$ 个元素对应于通量 $F_{i+\\tfrac{1}{2}}$。\n\n4.  **计算通量散度**：单元 $i$ 的通量散度是 $\\frac{F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}}{\\Delta x}$。我们已经有了通量向量 $F_{i+\\tfrac{1}{2}}$。要获得通量向量 $F_{i-\\tfrac{1}{2}}$，我们只需对 `F_total` 数组进行滚动操作：\n    - 令 `F_total_m1 = np.roll(F_total, 1)`。该数组的第 $i$ 个元素是 $F_{(i-1)+\\tfrac{1}{2}} = F_{i-\\tfrac{1}{2}}$。\n    - 所有单元的散度变为：\n      `div_F = (F_total - F_total_m1) / dx`\n\n5.  **组装最终向量**：最后，通过加上反应项的贡献来获得结果向量 $y$：\n      `y = div_F + k * x`\n\n这个矢量化过程无需任何显式循环即可计算整个向量 $y$，利用了 NumPy 对数组操作的优化性能。这是该算子免矩阵方法论的核心。所提供的 Python 代码实现了这个确切的算法来解决这些测试案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef matrix_vector_product(N: int, dx: float, u: list, D: list, k: list, x: list) -> list:\n    \"\"\"\n    Computes the matrix-free application y = Ax for a 1D advection-diffusion-reaction operator.\n\n    Args:\n        N: Number of cells.\n        dx: Grid spacing.\n        u: List of face velocities u_{i+1/2}.\n        D: List of face diffusivities D_{i+1/2}.\n        k: List of cell-centered linearized reaction coefficients k_i.\n        x: Input vector x.\n\n    Returns:\n        The resulting vector y as a list of floats.\n    \"\"\"\n    # Ensure inputs are NumPy arrays for vectorized operations.\n    u_arr = np.asarray(u)\n    D_arr = np.asarray(D)\n    k_arr = np.asarray(k)\n    x_arr = np.asarray(x)\n\n    # Create periodic-shifted versions of the vector x.\n    # x_p1[i] corresponds to x_{i+1} (value from the right neighbor).\n    x_p1 = np.roll(x_arr, -1)\n\n    # 1. Compute advective fluxes at all faces i + 1/2.\n    # The upwind value of x is chosen based on the sign of the velocity u.\n    upwind_x = np.where(u_arr > 0, x_arr, x_p1)\n    F_adv_face = u_arr * upwind_x\n\n    # 2. Compute diffusive fluxes at all faces i + 1/2.\n    F_diff_face = -D_arr / dx * (x_p1 - x_arr)\n\n    # 3. Sum fluxes to get the total flux at faces i + 1/2.\n    # F_total_face[i] corresponds to F_{i+1/2}(x).\n    F_total_face = F_adv_face + F_diff_face\n\n    # 4. Get fluxes at faces i - 1/2 by rolling the total flux array.\n    # F_total_face_m1[i] corresponds to F_{i-1/2}(x).\n    F_total_face_m1 = np.roll(F_total_face, 1)\n\n    # 5. Compute the flux divergence term for each cell i.\n    div_F = (F_total_face - F_total_face_m1) / dx\n\n    # 6. Add the local reaction term to get the final result y = Ax.\n    y = div_F + k_arr * x_arr\n\n    return y.tolist()\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the matrix-vector product,\n    then prints the results in the specified format.\n    \"\"\"\n    test_cases = [\n        # Case 1 (pure advection, uniform positive velocity)\n        {\n            \"N\": 6, \"dx\": 1.0, \"u\": [2.0] * 6, \"D\": [0.0] * 6, \"k\": [0.0] * 6,\n            \"x\": [1.0, 0.0, -1.0, 2.0, -2.0, 0.5]\n        },\n        # Case 2 (mixed advection, diffusion, and reaction with sign-changing velocity)\n        {\n            \"N\": 6, \"dx\": 1.0, \"u\": [1.0, -1.0, 1.0, -1.0, 1.0, -1.0],\n            \"D\": [0.5] * 6, \"k\": [0.2, 0.0, 0.4, 0.0, 0.6, 0.0],\n            \"x\": [0.3, -0.1, 0.5, -0.2, 0.0, 0.4]\n        },\n        # Case 3 (pure diffusion, no advection, no reaction)\n        {\n            \"N\": 5, \"dx\": 0.5, \"u\": [0.0] * 5, \"D\": [1.0] * 5, \"k\": [0.0] * 5,\n            \"x\": [1.0, -1.0, 2.0, -2.0, 0.5]\n        },\n        # Case 4 (reaction only, spatially varying linearized reaction)\n        {\n            \"N\": 4, \"dx\": 1.0, \"u\": [0.0] * 4, \"D\": [0.0] * 4,\n            \"k\": [10.0, 1.0, 5.0, 0.1], \"x\": [0.01, 1.0, -0.2, 0.5]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        y_vector = matrix_vector_product(\n            case[\"N\"], case[\"dx\"], case[\"u\"], case[\"D\"], case[\"k\"], case[\"x\"]\n        )\n        results.append(y_vector)\n\n    # Format the final output string as a list of lists with no spaces.\n    # e.g., [[val1,val2],[val3,val4]] -> \"[[val1,val2],[val3,val4]]\"\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}