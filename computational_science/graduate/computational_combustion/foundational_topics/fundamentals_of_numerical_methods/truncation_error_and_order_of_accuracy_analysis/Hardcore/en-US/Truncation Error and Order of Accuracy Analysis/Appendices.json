{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of numerical analysis is understanding how discretization choices introduce errors. This exercise provides a foundational \"pencil-and-paper\" practice using Fourier analysis, a powerful tool for examining how a numerical scheme handles different length scales in a solution. By analyzing the simple linear advection equation, you will learn to isolate and quantify the phase speed errors originating separately from spatial and temporal discretizations, a critical skill for developing and debugging schemes for wave propagation phenomena common in combustion.",
            "id": "4074159",
            "problem": "Consider the one-dimensional linear advection equation for a smooth passive scalar representative of a mixture fraction in a reacting flow, a canonical building block in computational combustion,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\nwith constant advection speed $a0$ on a uniform grid of spacing $\\Delta x$. Let the exact solution be the single Fourier mode\n$$\nu(x,t) = \\sin(k(x - at)),\n$$\nwith wavenumber $k0$, so that its nondimensional grid wavenumber is $\\theta = k \\Delta x$. Consider a fully discrete method that uses second-order central differences for the spatial derivative and a third-order Strong Stability Preserving Runge–Kutta (SSP-RK3) method for time integration with time step $\\Delta t$, at Courant–Friedrichs–Lewy (CFL) number $\\nu = a \\Delta t / \\Delta x = 0.5$. Using Fourier (von Neumann) analysis and small-$\\theta$ asymptotics, define the fractional phase speed error $\\delta$ by $c_{\\text{num}} = a (1 + \\delta)$, where $c_{\\text{num}}$ is the numerical phase speed.\n\nDerive, to leading nonvanishing orders in $\\theta$ up to and including $\\mathcal{O}(\\theta^{4})$, the separate contributions to $\\delta$ from:\n- spatial discretization alone (assuming exact time integration), and\n- temporal discretization alone (assuming the exact spatial derivative).\n\nExpress your final answer as a row matrix containing the two fractional errors in terms of $\\theta$ for the specified CFL number, with the first entry corresponding to the spatial contribution and the second entry to the temporal contribution. No rounding is required, and the quantities are dimensionless. Do not include units in your final expressions.",
            "solution": "The problem asks for an analysis of the fractional phase speed error, $\\delta$, for a numerical scheme solving the one-dimensional linear advection equation, $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$. The analysis is to be performed using Fourier modes, $u(x,t) \\propto e^{ik(x-at)}$, and small wavenumber asymptotics. The contributions from spatial and temporal discretization are to be determined separately.\n\nFirst, we consider the contribution from the spatial discretization alone, assuming time integration is exact. This corresponds to analyzing the semi-discretized problem. The spatial derivative $\\frac{\\partial u}{\\partial x}$ is approximated by a second-order central difference operator, $\\delta_x^{(2)}$. For a grid point $x_j$, the scheme is:\n$$\n\\frac{d u_j}{d t} = -a \\delta_x^{(2)} u_j = -a \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}\n$$\nWe analyze the behavior of this scheme on a single Fourier mode, $u_j(t) = \\hat{u}(t) e^{i k x_j}$. Substituting this into the semi-discretized equation gives an ODE for the Fourier amplitude $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{u}}{dt} = -a \\hat{u} \\frac{e^{i k \\Delta x} - e^{-i k \\Delta x}}{2 \\Delta x} = -i \\frac{a}{\\Delta x} \\sin(k \\Delta x) \\hat{u}\n$$\nThis ODE is of the form $\\frac{d\\hat{u}}{dt} = -i \\omega_{\\text{num,space}} \\hat{u}$, where $\\omega_{\\text{num,space}} = \\frac{a}{\\Delta x} \\sin(k \\Delta x)$ is the numerical frequency. The numerical phase speed is $c_{\\text{num}} = \\omega_{\\text{num}}/k$. Thus, for the spatial discretization:\n$$\nc_{\\text{num,space}} = \\frac{\\omega_{\\text{num,space}}}{k} = \\frac{a \\sin(k \\Delta x)}{k \\Delta x}\n$$\nUsing the non-dimensional grid wavenumber $\\theta = k \\Delta x$, this becomes $c_{\\text{num,space}} = a \\frac{\\sin(\\theta)}{\\theta}$. The fractional phase speed error $\\delta_{\\text{space}}$ is defined by $c_{\\text{num,space}} = a(1 + \\delta_{\\text{space}})$. Therefore:\n$$\n\\delta_{\\text{space}} = \\frac{c_{\\text{num,space}}}{a} - 1 = \\frac{\\sin(\\theta)}{\\theta} - 1\n$$\nTo find the leading orders of this error for small $\\theta$, we use the Taylor series expansion for $\\sin(\\theta) = \\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\mathcal{O}(\\theta^7)$:\n$$\n\\delta_{\\text{space}} = \\left(1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{120} - \\mathcal{O}(\\theta^6)\\right) - 1 = -\\frac{1}{6}\\theta^2 + \\frac{1}{120}\\theta^4\n$$\n\nNext, we consider the contribution from the temporal discretization alone, assuming the spatial derivative is computed exactly. For a Fourier mode, the exact spatial derivative is $\\frac{\\partial u}{\\partial x} = iku$. The advection equation becomes an ODE for the time evolution of the Fourier amplitude: $\\frac{d u}{d t} = -iak u$. This is of the form $\\frac{d\\phi}{dt} = \\lambda \\phi$, with $\\lambda = -iak$. The SSP-RK3 method approximates the exact evolution factor $G_{\\text{exact}} = e^{\\lambda \\Delta t}$ with a polynomial amplification factor $G_{\\text{num,time}}(z) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3$, where $z = \\lambda \\Delta t$.\n\nThe parameter $z$ is expressed in terms of the CFL number $\\nu = a \\Delta t / \\Delta x$ and $\\theta = k \\Delta x$:\n$$\nz = -iak \\Delta t = -i \\left(a \\frac{\\Delta t}{\\Delta x}\\right) (k \\Delta x) = -i\\nu\\theta\n$$\nThe exact amplification factor is $G_{\\text{exact}} = e^{-i\\nu\\theta}$. The numerical amplification factor is a complex number $G_{\\text{num,time}} = |G|e^{-i\\phi_{\\text{num}}}$, where $\\phi_{\\text{num}}$ is the numerical phase change over one time step. The exact phase change is $\\phi_{\\text{exact}} = \\nu\\theta$. The fractional phase speed error is $\\delta_{\\text{time}} = \\frac{\\phi_{\\text{num}}}{\\phi_{\\text{exact}}} - 1$. To find $\\phi_{\\text{num}}$, we analyze the argument of $G_{\\text{num,time}}$:\n$$\nG_{\\text{num,time}}(-i\\nu\\theta) = \\left(1 - \\frac{(\\nu\\theta)^2}{2}\\right) - i\\left(\\nu\\theta - \\frac{(\\nu\\theta)^3}{6}\\right)\n$$\nThe numerical phase is $\\phi_{\\text{num}} = \\arctan\\left(\\frac{\\text{Im}(G_{\\text{num,time}})}{\\text{Re}(G_{\\text{num,time}})}\\right)$. For a small argument $X = \\nu\\theta$, a careful Taylor expansion of the arctangent of the ratio yields:\n$$\n\\phi_{\\text{num}} = \\nu\\theta + \\frac{(\\nu\\theta)^5}{30} + \\mathcal{O}((\\nu\\theta)^7)\n$$\nThe phase error is $\\Delta\\phi = \\phi_{\\text{num}} - \\phi_{\\text{exact}} = \\frac{(\\nu\\theta)^5}{30}$. The fractional phase speed error from time integration is:\n$$\n\\delta_{\\text{time}} = \\frac{\\Delta\\phi}{\\phi_{\\text{exact}}} = \\frac{(\\nu\\theta)^5/30}{\\nu\\theta} = \\frac{\\nu^4\\theta^4}{30}\n$$\nFor the specified CFL number $\\nu=0.5$:\n$$\n\\delta_{\\text{time}} = \\frac{(0.5)^4 \\theta^4}{30} = \\frac{(1/16) \\theta^4}{30} = \\frac{1}{480}\\theta^4\n$$\nCombining the results, the first contribution due to spatial discretization is $\\delta_{\\text{space}} = -\\frac{1}{6}\\theta^2 + \\frac{1}{120}\\theta^4$, and the second contribution due to temporal discretization is $\\delta_{\\text{time}} = \\frac{1}{480}\\theta^4$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{6}\\theta^{2} + \\frac{1}{120}\\theta^{4}  \\frac{1}{480}\\theta^{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While analytical methods are invaluable, we often rely on numerical experiments to verify the accuracy of codes for complex, nonlinear problems like reacting flows. This practice shifts the focus from derivation to interpretation, a crucial skill for any computational scientist. Based on simulated error data from a flame problem, you will diagnose the convergence behavior, distinguish asymptotic from pre-asymptotic regimes, and understand why different error norms ($L_2$ vs. $L_\\infty$) can tell different stories about accuracy, especially in the presence of sharp gradients.",
            "id": "4074168",
            "problem": "Consider a one-dimensional planar premixed flame modeled, at leading order, by the steady advection–diffusion–reaction balance for a progress variable $c(x)$ on a domain $x \\in [0,L]$,\n$$\nu\\,\\frac{\\mathrm{d} c}{\\mathrm{d} x} \\;=\\; D\\,\\frac{\\mathrm{d}^2 c}{\\mathrm{d} x^2} \\;+\\; \\omega(c),\n$$\nwhere $u$ is the streamwise velocity, $D$ is the molecular diffusivity, and $\\omega(c)$ is the chemical source term. In the reaction zone, a distinguished internal-layer length scale emerges from diffusion–reaction balance, given by $\\delta \\sim \\sqrt{D/k}$ when $\\omega(c)$ is locally characterized by a rate constant $k$ and a normalized reaction function. This internal layer sets the spatial scale of large gradients, and hence it controls the magnitude of truncation error coefficients that depend on higher spatial derivatives.\n\nA second-order finite-volume spatial discretization (nominal order $p=2$) is used to solve for $c(x)$ on a sequence of uniform grids with spacing $h$, while time discretization is absent (steady problem) and boundary conditions anchor the flame location. The discretization error is measured against a highly resolved reference solution obtained on a grid with spacing $h_{\\mathrm{ref}}$ such that $h_{\\mathrm{ref}}/\\delta = 1/128$, and reported in the discrete $L_2$ and $L_\\infty$ norms as functions of $h$. Three grids are considered, with $h/\\delta \\in \\{0.25,\\,0.125,\\,0.0625\\}$, corresponding respectively to $h_0$, $h_1$, and $h_2$. The observed errors are:\n- $L_2$ norm: $E_{L_2}(h_0) = 1.6\\times 10^{-2}$, $E_{L_2}(h_1) = 6.97\\times 10^{-3}$, $E_{L_2}(h_2) = 1.868\\times 10^{-3}$.\n- $L_\\infty$ norm: $E_{L_\\infty}(h_0) = 5.0\\times 10^{-2}$, $E_{L_\\infty}(h_1) = 2.6\\times 10^{-2}$, $E_{L_\\infty}(h_2) = 1.4\\times 10^{-2}$.\n\nWithin the framework of truncation error analysis, asymptotic order studies assume that for sufficiently small $h$, the discretization error behaves like $E(h)\\approx \\alpha\\,h^p$, where $\\alpha$ is a coefficient determined by the solution’s regularity and local derivatives, and $p$ is the nominal order of the scheme. In reacting flows, pre-asymptotic behavior can persist if $h$ is not small relative to the smallest physical length scales (e.g., $\\delta$), or if other effects (e.g., grid-alignment errors of an internal layer) dominate some error norms.\n\nBased on the data above and first-principles reasoning about truncation error in internal layers in reacting flows, which of the following statements are mathematically justified for detecting pre-asymptotic behavior and for identifying pitfalls in order studies?\n\nA. The non-integer apparent order inferred from successive halving of $h$ in the $L_2$ norm increases from approximately $1.2$ to approximately $1.9$ as $h/\\delta$ decreases from $0.25$ to $0.0625$. This monotonic increase toward the nominal order $p=2$ indicates pre-asymptotic contamination at coarser grids, hence the two coarser grids are pre-asymptotic.\n\nB. Because the errors decrease monotonically with refinement in both $L_2$ and $L_\\infty$, the study is already in the asymptotic regime; monotone decrease is sufficient to certify asymptotic order behavior.\n\nC. Using the internal-layer scale $\\delta=\\sqrt{D/k}$ as the controlling feature, a practical grid-resolution criterion for asymptotics is $h/\\delta \\ll 1$. With $h/\\delta = 0.25,\\,0.125,\\,0.0625$, only the finest grid plausibly satisfies this, warning of pre-asymptotic behavior on the two coarser grids.\n\nD. The discrepancy between apparent orders extracted from $L_2$ and $L_\\infty$ (about $1.9$ versus about $0.9$ on the finest pair) is consistent with grid-alignment errors of the flame location dominating the $L_\\infty$ norm; this norm sensitivity is a robust diagnostic of pre-asymptotic behavior in internal-layer problems.\n\nE. Performing two-grid Richardson extrapolation on the two finest grids removes pre-asymptotic effects and guarantees an exact asymptotic order, regardless of internal layers; therefore it is sufficient to certify second-order accuracy.\n\nSelect all that apply.",
            "solution": "The central task is to analyze the convergence behavior of the numerical scheme using the provided error data. The expected asymptotic behavior of the error for a scheme with nominal order $p$ is $E(h) \\approx \\alpha h^p$. For a sequence of grids where the spacing is halved ($r=2$), the apparent order of accuracy, $p_{\\text{app}}$, can be calculated between two successive grids as:\n$$\np_{\\text{app}} = \\log_2\\left(\\frac{E(h_i)}{E(h_{i+1})}\\right)\n$$\nIn the asymptotic regime, $p_{\\text{app}}$ should be constant and equal to the nominal order $p$. Deviations from this indicate pre-asymptotic behavior.\n\nFirst, we calculate the apparent orders for both error norms from the given data.\n\n**For the $L_2$ norm:**\n-   Between grids $h_0$ and $h_1$:\n    $p_{\\text{app}, L_2, 01} = \\log_2\\left(\\frac{1.6 \\times 10^{-2}}{6.97 \\times 10^{-3}}\\right) \\approx \\log_2(2.2955) \\approx 1.20$\n-   Between grids $h_1$ and $h_2$:\n    $p_{\\text{app}, L_2, 12} = \\log_2\\left(\\frac{6.97 \\times 10^{-3}}{1.868 \\times 10^{-3}}\\right) \\approx \\log_2(3.7313) \\approx 1.90$\n\n**For the $L_\\infty$ norm:**\n-   Between grids $h_0$ and $h_1$:\n    $p_{\\text{app}, L_\\infty, 01} = \\log_2\\left(\\frac{5.0 \\times 10^{-2}}{2.6 \\times 10^{-2}}\\right) \\approx \\log_2(1.9231) \\approx 0.94$\n-   Between grids $h_1$ and $h_2$:\n    $p_{\\text{app}, L_\\infty, 12} = \\log_2\\left(\\frac{2.6 \\times 10^{-2}}{1.4 \\times 10^{-2}}\\right) \\approx \\log_2(1.8571) \\approx 0.89$\n\nWith these calculations, we can evaluate each statement.\n\n**A. The non-integer apparent order inferred from successive halving of $h$ in the $L_2$ norm increases from approximately $1.2$ to approximately $1.9$ as $h/\\delta$ decreases from $0.25$ to $0.0625$. This monotonic increase toward the nominal order $p=2$ indicates pre-asymptotic contamination at coarser grids, hence the two coarser grids are pre-asymptotic.**\n\nOur calculations show that the apparent order for the $L_2$ norm, $p_{\\text{app}, L_2}$, increases from $\\approx 1.20$ to $\\approx 1.90$. This matches the values given in the statement. The nominal order of the scheme is $p=2$. An apparent order that is lower than the nominal order but increases towards it upon grid refinement is the classic signature of pre-asymptotic behavior. This occurs when the grid spacing $h$ is not yet small enough for the leading-order term of the truncation error, $\\alpha h^p$, to dominate the total error. The grids $h_0$ and $h_1$ are clearly not exhibiting second-order convergence, and the trend suggests they are in the pre-asymptotic regime. The logic and the conclusion are sound.\n\n**Verdict: Correct**\n\n**B. Because the errors decrease monotonically with refinement in both $L_2$ and $L_\\infty$, the study is already in the asymptotic regime; monotone decrease is sufficient to certify asymptotic order behavior.**\n\nThe error data does indeed show a monotonic decrease with grid refinement for both norms. However, monotonic decrease in error is a necessary condition for convergence, but it is not a sufficient condition for being in the *asymptotic* regime. The asymptotic regime is defined by the error decreasing at a specific rate, i.e., $E(h) \\approx \\alpha h^p$. Our calculations show that the rate of decrease (the apparent order) is not constant and is significantly different from the nominal order of $p=2$. Therefore, the study is demonstrably *not* in the asymptotic regime. The statement's central claim is false.\n\n**Verdict: Incorrect**\n\n**C. Using the internal-layer scale $\\delta=\\sqrt{D/k}$ as the controlling feature, a practical grid-resolution criterion for asymptotics is $h/\\delta \\ll 1$. With $h/\\delta = 0.25,\\,0.125,\\,0.0625$, only the finest grid plausibly satisfies this, warning of pre-asymptotic behavior on the two coarser grids.**\n\nThis statement presents a first-principles argument based on physical scales. To accurately capture the behavior of a function, the sampling points (grid points) must be dense enough relative to the length scale over which the function changes rapidly. For this problem, that scale is the internal layer thickness $\\delta$. The criterion $h/\\delta \\ll 1$ is a standard rule of thumb for ensuring that the grid is fine enough to resolve the feature and for the numerical solution to enter the asymptotic regime of convergence. The grid resolutions considered are $h_0/\\delta = 1/4$, $h_1/\\delta = 1/8$, and $h_2/\\delta = 1/16$. Resolutions of $4$ and $8$ cells per characteristic thickness are widely considered insufficient for asymptotic convergence in problems with sharp layers. A resolution of $16$ cells ($h_2/\\delta=0.0625$) is beginning to be plausible, though often more are required. Therefore, reasoning that the two coarser grids are too coarse to expect asymptotic behavior is a sound and practical judgment. This a priori reasoning provides a \"warning\" that is confirmed by the a posteriori data analysis in A.\n\n**Verdict: Correct**\n\n**D. The discrepancy between apparent orders extracted from $L_2$ and $L_\\infty$ (about $1.9$ versus about $0.9$ on the finest pair) is consistent with grid-alignment errors of the flame location dominating the $L_\\infty$ norm; this norm sensitivity is a robust diagnostic of pre-asymptotic behavior in internal-layer problems.**\n\nOur calculations for the finest grid pair ($h_1, h_2$) show $p_{\\text{app}, L_2, 12} \\approx 1.90$ and $p_{\\text{app}, L_\\infty, 12} \\approx 0.89$. This confirms the numerical discrepancy cited in the statement. The underlying theory is also correct. The $L_\\infty$ norm measures the maximum pointwise error. In problems with sharp features like a flame front, a small misalignment (or \"phase error\") of the numerical solution's front relative to the exact solution's front can cause a large local error, which is then picked up by the $L_\\infty$ norm. This phase error often scales as $O(h)$, leading to an apparent order of $\\approx 1$, regardless of the formal order of the discretization scheme for the smooth parts of the solution. The $L_2$ norm, being an integral measure, is less sensitive to such localized phase errors and often reflects an order of accuracy closer to the nominal one. The observed difference between the $L_2$ and $L_\\infty$ convergence rates is therefore a well-known and robust indicator of unresolved internal layers and the associated pre-asymptotic behavior.\n\n**Verdict: Correct**\n\n**E. Performing two-grid Richardson extrapolation on the two finest grids removes pre-asymptotic effects and guarantees an exact asymptotic order, regardless of internal layers; therefore it is sufficient to certify second-order accuracy.**\n\nRichardson extrapolation is a technique for accelerating convergence or estimating errors. The standard formula, e.g., for the error on the fine grid $E_2 \\approx (S_2 - S_1)/(r^p-1)$, explicitly depends on the asymptotic order $p$. The entire derivation of the method assumes that the error is of the form $E(h) = \\alpha h^p + O(h^{p+q})$ with $q  0$, and that the $h^p$ term is dominant. If the problem is in the pre-asymptotic regime, this assumption is false. Applying Richardson extrapolation in such a case, especially with the nominal order $p=2$ when the apparent order is $\\approx 1.9$ or $\\approx 0.9$, will not yield an accurate error estimate and will not \"remove\" pre-asymptotic effects. The claim that it works \"regardless of internal layers\" and \"guarantees\" an exact order is a gross overstatement and fundamentally misunderstands the prerequisites for the method's validity.\n\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "This final practice brings together theory and implementation in a complete verification workflow. You will use the Method of Manufactured Solutions to create a test problem with a known exact solution, a standard technique for rigorous code verification. By implementing a finite volume solver and applying a three-grid Richardson extrapolation procedure, you will numerically estimate your code's order of accuracy and leading error constant, providing concrete, quantitative evidence that your implementation matches its theoretical design.",
            "id": "4074120",
            "problem": "Consider a one-dimensional, steady advection–diffusion–reaction model representative of scalar transport in computational combustion. On the spatial domain $x \\in [0,1]$, the unknown scalar field $u(x)$ satisfies the boundary value problem\n$$\n- \\frac{d}{dx} \\left( D \\frac{d u}{dx} \\right) + v \\frac{d u}{dx} + k u = s(x),\n$$\nwith Dirichlet boundary conditions $u(0) = u_0$ and $u(1) = u_1$. Here, $D$ is the diffusion coefficient, $v$ is the advection velocity (assume $v \\ge 0$), $k$ is a linear reaction rate, and $s(x)$ is a manufactured source defined so that a chosen smooth function $u_{\\mathrm{exact}}(x)$ is the exact solution to the continuous equation: \n$$\ns(x) = - D \\frac{d^2 u_{\\mathrm{exact}}}{dx^2}(x) + v \\frac{d u_{\\mathrm{exact}}}{dx}(x) + k\\, u_{\\mathrm{exact}}(x).\n$$\nThe Finite Volume Method (FVM) on a uniform grid with $N$ cells and mesh spacing $h = 1/N$ is used to discretize the governing equation at cell centers aligned with nodes $x_i = i h$ for $i = 0,1,\\dots,N$. Assuming constant $D$, $v$, and $k$, and using a second-order central approximation for the diffusion term, a first-order upwind approximation for the advection term (valid for $v  0$), and a pointwise reaction term at the nodes, the discrete interior equations for $i = 1,2,\\dots,N-1$ take the form\n$$\n- D \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2} + v \\frac{u_i - u_{i-1}}{h} + k u_i = s(x_i),\n$$\nwith $u_0 = u_{\\mathrm{exact}}(0)$ and $u_N = u_{\\mathrm{exact}}(1)$ prescribed at the boundaries.\n\nLet the grid be refined by an integer ratio $r \\ge 2$, producing three nested grids with $N_1$, $N_2 = r N_1$, and $N_3 = r N_2$ cells, corresponding to mesh sizes $h_1$, $h_2 = h_1/r$, and $h_3 = h_2/r$. On each grid, after solving the discrete system, define a scalar Quantity of Interest (QoI) $Q(h)$ as the discrete solution value at the midpoint $x = 0.5$, which is a grid node when $N$ is even. Suppose the discrete QoI admits an asymptotic error expansion\n$$\nQ(h) = Q^\\star + C h^p + \\mathcal{O}(h^{p+1}),\n$$\nwhere $Q^\\star$ is the grid-independent limit, $p  0$ is the order of accuracy, and $C$ is the asymptotic error constant. The goal is to construct a Richardson extrapolation framework using the three nested grids to estimate $p$ and $C$.\n\nYour task is to:\n- Implement the FVM discretization described above to solve for $u(x)$ on three nested grids for each test case.\n- Using only the three discrete QoIs $Q(h_1)$, $Q(h_2)$, and $Q(h_3)$ and the refinement ratio $r$, derive and implement a procedure that estimates $p$ and $C$ based on the asymptotic error model and algebraic elimination of the unknown $Q^\\star$.\n- Ensure that the algorithm is robust to moderate pre-asymptotic effects by using the information from all three grids in your estimates.\n\nAll variables in your derivation must be treated mathematically, with explicit use of the asymptotic error definition and standard properties of logarithms as needed, without using any shortcut formulas provided by the problem statement.\n\nThe program must execute the following test suite, solving the above problem for each case and outputting the estimated order $p$ and constant $C$ for each case:\n\n- Test Case 1 (diffusion–reaction, second-order expected):\n    - $D = 0.1$, $v = 0$, $k = 1$, $u_{\\mathrm{exact}}(x) = \\sin(\\pi x)$, $N_1 = 16$, $r = 2$.\n- Test Case 2 (advection-dominated, first-order upwind expected):\n    - $D = 0.005$, $v = 3$, $k = 0.5$, $u_{\\mathrm{exact}}(x) = \\sin(2\\pi x)$, $N_1 = 32$, $r = 2$.\n- Test Case 3 (diffusion–reaction with nonbinary refinement):\n    - $D = 0.01$, $v = 0$, $k = 2$, $u_{\\mathrm{exact}}(x) = e^{x}$, $N_1 = 12$, $r = 3$.\n- Test Case 4 (mixed regime with significant reaction, upwind advection):\n    - $D = 0.02$, $v = 1$, $k = 10$, $u_{\\mathrm{exact}}(x) = \\cosh(2(x - 0.5))$, $N_1 = 18$, $r = 2$.\n\nFor each test case, $u_0$ and $u_1$ must be set to $u_{\\mathrm{exact}}(0)$ and $u_{\\mathrm{exact}}(1)$, respectively. Angles used in trigonometric functions must be in radians. No physical units are required because the problem is posed in nondimensional form.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list $[p, C]$ with floating-point values for the corresponding test case. For example, a valid output format is:\n$$\n[[p_1,C_1],[p_2,C_2],[p_3,C_3],[p_4,C_4]].\n$$",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the numerical solution of boundary value problems using the Finite Volume Method (FVM) and the verification of the numerical scheme's accuracy via the method of manufactured solutions and Richardson extrapolation. All parameters, equations, and objectives are clearly defined. No inconsistencies, ambiguities, or factual errors are present. Therefore, the problem is valid, and a solution is provided.\n\nThe solution is developed in three stages. First, we formalize the FVM discretization into a linear algebraic system. Second, we derive the estimators for the order of accuracy $p$ and the leading error constant $C$. Third, we outline the computational algorithm to solve the problem for the given test cases.\n\n### 1. Finite Volume Discretization and Linear System Formulation\n\nThe governing one-dimensional advection–diffusion–reaction equation is:\n$$\n- \\frac{d}{dx} \\left( D \\frac{d u}{dx} \\right) + v \\frac{d u}{dx} + k u = s(x)\n$$\nAssuming a constant diffusion coefficient $D$, this simplifies to:\n$$\n-D \\frac{d^2 u}{dx^2} + v \\frac{d u}{dx} + k u = s(x)\n$$\nThe problem specifies a finite-difference-like discretization on a uniform grid of $N$ cells, with $N+1$ nodes $x_i = i h$ for $i=0, 1, \\dots, N$, where $h=1/N$. The discrete equation for the interior nodes $i=1, 2, \\dots, N-1$ is given as:\n$$\n- D \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2} + v \\frac{u_i - u_{i-1}}{h} + k u_i = s(x_i)\n$$\nHere, $u_i \\approx u(x_i)$. The equation uses a second-order central difference for the diffusion term and a first-order upwind difference for the advection term (assuming $v \\ge 0$).\n\nTo solve for the unknown values $u_1, u_2, \\dots, u_{N-1}$, we rearrange the equation to group terms by their spatial index:\n$$\n\\left(-\\frac{D}{h^2} - \\frac{v}{h}\\right) u_{i-1} + \\left(\\frac{2D}{h^2} + \\frac{v}{h} + k\\right) u_i + \\left(-\\frac{D}{h^2}\\right) u_{i+1} = s(x_i)\n$$\nThis structure defines a system of $N-1$ linear equations for the $N-1$ unknown interior nodal values. We can write this system in matrix form as $A \\mathbf{u} = \\mathbf{b}$, where $\\mathbf{u} = [u_1, u_2, \\dots, u_{N-1}]^T$. The matrix $A$ is a tridiagonal matrix of size $(N-1) \\times (N-1)$. For a general row $i$ (corresponding to equation for $u_i$), the non-zero entries are:\n-   Lower diagonal, $A_{i, i-1} = -\\frac{D}{h^2} - \\frac{v}{h}$\n-   Main diagonal, $A_{i, i} = \\frac{2D}{h^2} + \\frac{v}{h} + k$\n-   Upper diagonal, $A_{i, i+1} = -\\frac{D}{h^2}$\n\nThe Dirichlet boundary conditions are $u(0) = u_0$ and $u(1) = u_N$, where $u_0$ and $u_N$ are known values. These boundary values affect the first and last equations of the system.\n\nFor the first interior node, $i=1$:\n$$\n\\left(\\frac{2D}{h^2} + \\frac{v}{h} + k\\right) u_1 - \\frac{D}{h^2} u_2 = s(x_1) - \\left(-\\frac{D}{h^2} - \\frac{v}{h}\\right) u_0\n$$\nFor the last interior node, $i=N-1$:\n$$\n\\left(-\\frac{D}{h^2} - \\frac{v}{h}\\right) u_{N-2} + \\left(\\frac{2D}{h^2} + \\frac{v}{h} + k\\right) u_{N-1} = s(x_{N-1}) - \\left(-\\frac{D}{h^2}\\right) u_N\n$$\nThe right-hand side vector $\\mathbf{b}$ is therefore:\n$$\nb_i = \n\\begin{cases} \ns(x_1) + \\left(\\frac{D}{h^2} + \\frac{v}{h}\\right) u_0  \\text{if } i=1 \\\\\ns(x_i)  \\text{if } 1  i  N-1 \\\\\ns(x_{N-1}) + \\left(\\frac{D}{h^2}\\right) u_N  \\text{if } i=N-1\n\\end{cases}\n$$\nwhere the indices of $\\mathbf{b}$ run from $1$ to $N-1$. This tridiagonal linear system can be solved efficiently for the vector of unknowns $\\mathbf{u}$.\n\n### 2. Derivation of Estimators for Order of Accuracy $(p)$ and Error Constant $(C)$\n\nThe problem assumes that the discrete Quantity of Interest (QoI), $Q(h)$, which is the solution at $x=0.5$, admits the asymptotic error expansion:\n$$\nQ(h) = Q^\\star + C h^p + \\mathcal{O}(h^{p+1})\n$$\nwhere $Q^\\star$ is the exact QoI, $p$ is the order of accuracy, and $C$ is the leading error constant. We are given three solutions on nested grids with sizes $h_1$, $h_2 = h_1/r$, and $h_3 = h_2/r = h_1/r^2$. Let the corresponding QoI values be $Q_1$, $Q_2$, and $Q_3$. Neglecting the higher-order terms, we have:\n$$\n\\begin{align}\nQ_1  \\approx Q^\\star + C h_1^p \\quad (1) \\\\\nQ_2  \\approx Q^\\star + C h_2^p = Q^\\star + C (h_1/r)^p = Q^\\star + C \\frac{h_1^p}{r^p} \\quad (2) \\\\\nQ_3  \\approx Q^\\star + C h_3^p = Q^\\star + C (h_1/r^2)^p = Q^\\star + C \\frac{h_1^p}{r^{2p}} \\quad (3)\n\\end{align}\n$$\nWe have three equations and three unknowns ($Q^\\star$, $C$, $p$). We can find $p$ and $C$ by algebraically eliminating $Q^\\star$.\n\nSubtracting equation $(2)$ from $(1)$:\n$$\nQ_1 - Q_2 \\approx \\left(Q^\\star + C h_1^p\\right) - \\left(Q^\\star + C \\frac{h_1^p}{r^p}\\right) = C h_1^p \\left(1 - \\frac{1}{r^p}\\right) \\quad (4)\n$$\nSubtracting equation $(3)$ from $(2)$:\n$$\nQ_2 - Q_3 \\approx \\left(Q^\\star + C \\frac{h_1^p}{r^p}\\right) - \\left(Q^\\star + C \\frac{h_1^p}{r^{2p}}\\right) = C \\frac{h_1^p}{r^p} \\left(1 - \\frac{1}{r^p}\\right) \\quad (5)\n$$\nNow, we can eliminate $C$ and $h_1$ by taking the ratio of equation $(4)$ to equation $(5)$:\n$$\n\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{C h_1^p \\left(1 - \\frac{1}{r^p}\\right)}{C \\frac{h_1^p}{r^p} \\left(1 - \\frac{1}{r^p}\\right)} = r^p\n$$\nTo solve for $p$, we take the natural logarithm of both sides:\n$$\n\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right) \\approx \\ln(r^p) = p \\ln(r)\n$$\nThis gives the estimator for the order of accuracy:\n$$\np \\approx \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)}\n$$\nThis formula robustly uses information from all three grids.\n\nTo estimate $C$, we can rearrange equation $(4)$:\n$$\nQ_1 - Q_2 \\approx C (h_1^p - h_2^p)\n$$\nSolving for $C$ and using the estimated value of $p$:\n$$\nC \\approx \\frac{Q_1 - Q_2}{h_1^p - h_2^p}\n$$\nwhere $p$ in the denominator is the value estimated in the previous step.\n\n### 3. Algorithm for Test Case Execution\n\nFor each test case, the following procedure is implemented:\n1.  Define the physical parameters $D, v, k$, the refinement ratio $r$, and the initial grid cell count $N_1$.\n2.  Define the manufactured solution $u_{\\mathrm{exact}}(x)$ and its first and second derivatives, $u'_{\\mathrm{exact}}(x)$ and $u''_{\\mathrm{exact}}(x)$.\n3.  Define the source term function $s(x) = -D u''_{\\mathrm{exact}}(x) + v u'_{\\mathrm{exact}}(x) + k u_{\\mathrm{exact}}(x)$.\n4.  Calculate the grid sizes for the three nested grids: $N_1$, $N_2 = r N_1$, and $N_3 = r N_2$.\n5.  For each grid size $N_j$ (where $j=1,2,3$):\n    a.  Calculate the mesh spacing $h_j = 1/N_j$.\n    b.  Construct the $(N_j-1) \\times (N_j-1)$ tridiagonal matrix $A$ and the right-hand side vector $\\mathbf{b}$ of length $N_j-1$ as derived above. The boundary values $u_0 = u_{\\mathrm{exact}}(0)$ and $u_{N_j} = u_{\\mathrm{exact}}(1)$ are used in constructing $\\mathbf{b}$.\n    c.  Solve the linear system $A\\mathbf{u}=\\mathbf{b}$ to find the interior solution $\\mathbf{u}$.\n    d.  Extract the QoI, which is the solution at $x=0.5$. The index for this node is $i = 0.5 / h_j = N_j/2$. Since the vector $\\mathbf{u}$ stores $u_1, \\dots, u_{N_j-1}$, the required value is at index $(N_j/2) - 1$ of the computed solution vector. This value is stored as $Q_j$.\n6.  Using the collected QoIs ($Q_1, Q_2, Q_3$), the mesh sizes ($h_1, h_2$), and the refinement ratio $r$, compute the estimated order $p$ and constant $C$ using the derived formulas.\n7.  The pair $[p, C]$ is stored for the current test case.\n8.  After iterating through all test cases, the final results are formatted into the specified string format.",
            "answer": "```python\nimport numpy as np\n\ndef solve_fvm(params, N):\n    \"\"\"\n    Solves the 1D advection-diffusion-reaction BVP using the specified FVM.\n\n    Args:\n        params (dict): A dictionary containing D, v, k, and functions for\n                       u_exact, u_exact_deriv1, u_exact_deriv2.\n        N (int): The number of cells in the grid.\n\n    Returns:\n        float: The discrete solution value at x = 0.5 (the QoI).\n    \"\"\"\n    D = params['D']\n    v = params['v']\n    k = params['k']\n    u_exact_func = params['u_exact_func']\n    u_exact_deriv1 = params['u_exact_deriv1']\n    u_exact_deriv2 = params['u_exact_deriv2']\n\n    h = 1.0 / N\n    x_nodes = np.linspace(0.0, 1.0, N + 1)\n    \n    # Manufactured source term\n    s_func = lambda x: -D * u_exact_deriv2(x) + v * u_exact_deriv1(x) + k * u_exact_func(x)\n    \n    dim = N - 1\n    if dim = 0:\n        return np.nan\n\n    # Setup the linear system Au = b for interior nodes u_1, ..., u_{N-1}\n    A = np.zeros((dim, dim))\n    b = np.zeros(dim)\n    \n    # Coefficients from the discrete equation\n    coeff_im1 = -D / h**2 - v / h\n    coeff_i   = 2 * D / h**2 + v / h + k\n    coeff_ip1 = -D / h**2\n    \n    # Fill the tridiagonal matrix A\n    np.fill_diagonal(A, coeff_i)\n    if dim  1:\n        np.fill_diagonal(A[1:], coeff_im1)\n        np.fill_diagonal(A[:, 1:], coeff_ip1)\n\n    # Fill the RHS vector b, including source term and BCs\n    for i in range(1, N):\n        idx = i - 1\n        b[idx] = s_func(x_nodes[i])\n        \n    u0 = u_exact_func(0.0)\n    uN = u_exact_func(1.0)\n    \n    b[0] -= coeff_im1 * u0\n    if dim  1:\n        b[dim - 1] -= coeff_ip1 * uN\n\n    # Solve the system\n    u_internal = np.linalg.solve(A, b)\n    \n    # Extract the Quantity of Interest (QoI), u(x=0.5)\n    # The index for x=0.5 is i = 0.5 / h = N/2.\n    # The unknowns u_internal are u_1, ..., u_{N-1}.\n    # The index in u_internal for u_i is i-1.\n    qoi_node_idx = N // 2\n    qoi_vec_idx = qoi_node_idx - 1\n    \n    qoi = u_internal[qoi_vec_idx]\n    \n    return qoi\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        {\n            'D': 0.1, 'v': 0.0, 'k': 1.0, 'r': 2, 'N1': 16,\n            'u_exact_func': lambda x: np.sin(np.pi * x),\n            'u_exact_deriv1': lambda x: np.pi * np.cos(np.pi * x),\n            'u_exact_deriv2': lambda x: -np.pi**2 * np.sin(np.pi * x),\n        },\n        # Test Case 2\n        {\n            'D': 0.005, 'v': 3.0, 'k': 0.5, 'r': 2, 'N1': 32,\n            'u_exact_func': lambda x: np.sin(2 * np.pi * x),\n            'u_exact_deriv1': lambda x: 2 * np.pi * np.cos(2 * np.pi * x),\n            'u_exact_deriv2': lambda x: -4 * np.pi**2 * np.sin(2 * np.pi * x),\n        },\n        # Test Case 3\n        {\n            'D': 0.01, 'v': 0.0, 'k': 2.0, 'r': 3, 'N1': 12,\n            'u_exact_func': lambda x: np.exp(x),\n            'u_exact_deriv1': lambda x: np.exp(x),\n            'u_exact_deriv2': lambda x: np.exp(x),\n        },\n        # Test Case 4\n        {\n            'D': 0.02, 'v': 1.0, 'k': 10.0, 'r': 2, 'N1': 18,\n            'u_exact_func': lambda x: np.cosh(2 * (x - 0.5)),\n            'u_exact_deriv1': lambda x: 2 * np.sinh(2 * (x - 0.5)),\n            'u_exact_deriv2': lambda x: 4 * np.cosh(2 * (x - 0.5)),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        N1 = case['N1']\n        r = case['r']\n        N2 = r * N1\n        N3 = r * N2\n\n        # Solve on the three nested grids\n        Q1 = solve_fvm(case, N1)\n        Q2 = solve_fvm(case, N2)\n        Q3 = solve_fvm(case, N3)\n\n        # Estimate order of accuracy p\n        # p = ln((Q1-Q2)/(Q2-Q3)) / ln(r)\n        ratio_of_diffs = (Q1 - Q2) / (Q2 - Q3)\n        # Handle cases where differences might be zero or negative, returning NaN\n        if ratio_of_diffs = 0:\n            p_est = np.nan\n        else:\n            p_est = np.log(ratio_of_diffs) / np.log(r)\n        \n        # Estimate leading error constant C\n        # C = (Q1 - Q2) / (h1^p - h2^p)\n        h1 = 1.0 / N1\n        h2 = 1.0 / N2\n        \n        if np.isnan(p_est) or (Q1 - Q2) == 0:\n            C_est = np.nan\n        else:\n            C_est = (Q1 - Q2) / (h1**p_est - h2**p_est)\n\n        results.append([p_est, C_est])\n\n    # Format the final output string\n    output_str = f\"[{','.join(f'[{p},{c}]' for p, c in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}