{
    "hands_on_practices": [
        {
            "introduction": "为了精确捕捉火焰结构等复杂现象，计算网格很少是均匀的。本练习  旨在解决将 CFL 条件应用于具有变化流动特性的非均匀网格这一基本挑战。通过计算每个单元的局部稳定性极限，您将理解为何全局显式时间步长 $\\Delta t$ 必须受整个区域内最严格条件的限制，以防止数值不稳定性。",
            "id": "4045894",
            "problem": "考虑一个一维、可压缩、反应流，其代表了在分层温度场中的预混燃烧。该流动通过质量、动量和能量的守恒欧拉方程以及物种输运方程进行建模，方程以在有限体积单元上的积分形式写出。通过算子分裂忽略化学源项，平流-声学子系统的显式有限体积更新在双曲对流通量的作用下演化守恒状态变量。线性化双曲子系统的局部特征波速是通量雅可比矩阵的特征值，而最大波速决定了显式方法稳定性的时间步长限制。\n\n在空间非均匀网格上使用一个时间上统一的全局时间步长，该网格的单元宽度为$\\Delta x_{i}$，且由于热梯度和组分变化，流速$u_{i}$和声速$c_{i}$在空间上变化。网格和状态如下：\n- 单元 $i=1$：$\\Delta x_{1}=6.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{1}=-20\\,\\mathrm{m/s}$，$c_{1}=720\\,\\mathrm{m/s}$。\n- 单元 $i=2$：$\\Delta x_{2}=4.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{2}=35\\,\\mathrm{m/s}$，$c_{2}=680\\,\\mathrm{m/s}$。\n- 单元 $i=3$：$\\Delta x_{3}=1.0\\times 10^{-3}\\,\\mathrm{m}$，$u_{3}=50\\,\\mathrm{m/s}$，$c_{3}=900\\,\\mathrm{m/s}$。\n- 单元 $i=4$：$\\Delta x_{4}=8.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{4}=10\\,\\mathrm{m/s}$，$c_{4}=800\\,\\mathrm{m/s}$。\n- 单元 $i=5$：$\\Delta x_{5}=5.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{5}=-5\\,\\mathrm{m/s}$，$c_{5}=750\\,\\mathrm{m/s}$。\n- 单元 $i=6$：$\\Delta x_{6}=7.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{6}=40\\,\\mathrm{m/s}$，$c_{6}=850\\,\\mathrm{m/s}$。\n\n使用 Courant–Friedrichs–Lewy (CFL) 数为 $0.9$，完成以下任务：\n1. 从双曲守恒律和显式有限体积稳定性的第一性原理出发，推导单元 $i$ 中的局部时间步长限制，其为 $\\Delta x_{i}$ 和局部特征速度最大值的函数。对于平流-声学欧拉子系统，用 $u_{i}$ 和 $c_{i}$ 来确定该最大速度。\n2. 对于上述数据，计算每个单元中的局部稳定时间步长 $\\Delta t_{i}$。\n3. 基于依赖域论证和显式格式的线性稳定性，解释为什么全局统一时间步长必须满足最严格的局部条件，因此必须是所有局部时间步长 $i$ 中的最小值。\n4. 提供全局统一时间步长，其为等于 $\\min_{i}\\Delta t_{i}$ 的单个数值。将您的最终答案四舍五入到三位有效数字，并以 $\\mathrm{\\mu s}$（微秒）表示。",
            "solution": "该问题被认为是有效的，因为它在科学上基于计算流体动力学的原理，特别是双曲守恒律数值方法的稳定性。该问题设定良好、客观，并包含获得唯一解所需的所有信息。我们按顺序处理四个要求的任务来进行求解。\n\n**1. 局部时间步长限制的推导**\n\n对于双曲型偏微分方程，显式时间推进格式的稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定。该条件源于对依赖域的考量。点 $(x, t_0+\\Delta t)$ 的物理依赖域是 $t_0$ 时刻能够影响该点解的所有点的集合。对于双曲系统，信息以有限的特征波速传播。其中最快的速度 $S_{max}$ 决定了此依赖域的边界。\n\n在有限体积法中，单元 $i$ 在 $n+1$ 时刻的更新值 $U_i^{n+1}$ 是使用单元 $i$ 及其在 $n$ 时刻的直接邻居单元的值计算得出的。因此，在一个时间步长 $\\Delta t$ 内，单元 $i$ 中平均值的数值依赖域是这些邻居单元所覆盖的空间区域。为保证格式稳定，单元 $i$ 的物理依赖域必须是其数值依赖域的子集。\n\n考虑一个宽度为 $\\Delta x_i$ 的单元 $i$。在此单元内，物理信息波的最快移动速度为 $S_{max, i}$。在时间间隔 $\\Delta t$ 内，该波传播的距离为 $S_{max, i} \\Delta t$。对于一个仅使用相邻单元的简单显式格式，数值格式只能获取大约 $\\Delta x_i$ 距离内的信息。为确保没有任何物理信号传播的距离超过数值格式所能“看到”的范围，我们必须要求最快波传播的距离小于或等于单元宽度：\n$$S_{max, i} \\Delta t \\le \\Delta x_i$$\n这意味着对时间步长的限制：\n$$\\Delta t \\le \\frac{\\Delta x_i}{S_{max, i}}$$\n这个不等式是 CFL 条件的核心。通常的做法是引入一个安全因子，即 CFL 数 $C$，对于一个简单的一阶格式，为保证稳定性，$C \\le 1$。因此，局部最大允许时间步长 $\\Delta t_i$ 由下式给出：\n$$\\Delta t_i = C \\frac{\\Delta x_i}{S_{max, i}}$$\n接下来，我们必须确定一维欧拉方程的最大特征速度 $S_{max, i}$。欧拉方程通量雅可比矩阵的特征值对应于特征波速。在一维空间中，这些特征值为 $\\lambda_1 = u$、$\\lambda_2 = u+c$ 和 $\\lambda_3 = u-c$，其中 $u$ 是局部流体速度，$c$ 是局部声速。这些对应于以速度 $u$ 移动的熵波/接触波，以及相对于静止坐标系以速度 $u+c$ 和 $u-c$ 移动的两个声波。\n\n信号传播的速度是这些速度的大小。因此，局部最大特征速度 $S_{max, i}$ 是单元 $i$ 中这些特征值绝对值的最大值：\n$$S_{max, i} = \\max(|u_i|, |u_i+c_i|, |u_i-c_i|)$$\n由于声速 $c_i$ 总是正的，我们可以简化这个表达式。根据三角不等式，项 $|u_i|+c_i$ 总是大于或等于 $|u_i+c_i|$ 和 $|u_i-c_i| = |c_i-u_i|$。此外，由于 $c_i > 0$，所以 $|u_i|+c_i > |u_i|$。因此，最大值总是由绝对流速和声速之和给出：\n$$S_{max, i} = |u_i| + c_i$$\n将此代入时间步长公式，我们得到每个单元 $i$ 的局部时间步长限制：\n$$\\Delta t_i = C \\frac{\\Delta x_i}{|u_i| + c_i}$$\n\n**2. 局部稳定时间步长的计算**\n\n使用推导出的公式，给定的 CFL 数 $C=0.9$ 以及每个单元的数据：\n\n- **单元 $i=1$**：\n$S_{max, 1} = |u_1| + c_1 = |-20\\,\\mathrm{m/s}| + 720\\,\\mathrm{m/s} = 740\\,\\mathrm{m/s}$\n$\\Delta t_1 = 0.9 \\times \\frac{6.0\\times 10^{-4}\\,\\mathrm{m}}{740\\,\\mathrm{m/s}} = \\frac{5.4 \\times 10^{-4}}{740}\\,\\mathrm{s} \\approx 7.297 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=2$**：\n$S_{max, 2} = |u_2| + c_2 = |35\\,\\mathrm{m/s}| + 680\\,\\mathrm{m/s} = 715\\,\\mathrm{m/s}$\n$\\Delta t_2 = 0.9 \\times \\frac{4.0\\times 10^{-4}\\,\\mathrm{m}}{715\\,\\mathrm{m/s}} = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=3$**：\n$S_{max, 3} = |u_3| + c_3 = |50\\,\\mathrm{m/s}| + 900\\,\\mathrm{m/s} = 950\\,\\mathrm{m/s}$\n$\\Delta t_3 = 0.9 \\times \\frac{1.0\\times 10^{-3}\\,\\mathrm{m}}{950\\,\\mathrm{m/s}} = \\frac{9.0 \\times 10^{-4}}{950}\\,\\mathrm{s} \\approx 9.474 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=4$**：\n$S_{max, 4} = |u_4| + c_4 = |10\\,\\mathrm{m/s}| + 800\\,\\mathrm{m/s} = 810\\,\\mathrm{m/s}$\n$\\Delta t_4 = 0.9 \\times \\frac{8.0\\times 10^{-4}\\,\\mathrm{m}}{810\\,\\mathrm{m/s}} = \\frac{7.2 \\times 10^{-4}}{810}\\,\\mathrm{s} \\approx 8.889 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=5$**：\n$S_{max, 5} = |u_5| + c_5 = |-5\\,\\mathrm{m/s}| + 750\\,\\mathrm{m/s} = 755\\,\\mathrm{m/s}$\n$\\Delta t_5 = 0.9 \\times \\frac{5.0\\times 10^{-4}\\,\\mathrm{m}}{755\\,\\mathrm{m/s}} = \\frac{4.5 \\times 10^{-4}}{755}\\,\\mathrm{s} \\approx 5.960 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=6$**：\n$S_{max, 6} = |u_6| + c_6 = |40\\,\\mathrm{m/s}| + 850\\,\\mathrm{m/s} = 890\\,\\mathrm{m/s}$\n$\\Delta t_6 = 0.9 \\times \\frac{7.0\\times 10^{-4}\\,\\mathrm{m}}{890\\,\\mathrm{m/s}} = \\frac{6.3 \\times 10^{-4}}{890}\\,\\mathrm{s} \\approx 7.079 \\times 10^{-7}\\,\\mathrm{s}$\n\n**3. 全局时间步长的理由**\n\n问题指定使用“时间上统一的全局时间步长”，我们将其表示为 $\\Delta t_{global}$。这意味着在每次迭代中，计算域中的所有单元都向前推进相同的时间量 $\\Delta t_{global}$。\n\n为使整个模拟数值稳定，CFL 条件必须在域中的每一个单元都得到满足。这产生了一个不等式系统，每个单元 $i$ 对应一个不等式：\n$$\\Delta t_{global} \\le \\Delta t_i \\quad \\text{对于所有 } i \\in \\{1, 2, 3, 4, 5, 6\\}$$\n为了同时满足所有这些条件，$\\Delta t_{global}$ 必须小于或等于所有局部最大允许时间步长中的最小值。如果选择的 $\\Delta t_{global}$ 大于 $\\Delta t_i$ 值的最小值，那么域中将至少有一个单元违反了局部的 CFL 条件。在那个“临界”单元（$\\Delta t_i$ 最小的那个）中，物理波信号将在单个时间步内传播到单元边界之外，但显式数值格式将无法计入其影响。这种对因果关系的违背会导致非物理振荡的增长，从而引发数值不稳定性，并迅速破坏整个计算域的解。\n\n因此，全局时间步长必须受限于局部稳定时间步长的最小值：\n$$\\Delta t_{global} \\le \\min_{i} \\{\\Delta t_i\\}$$\n为了在保证稳定性的同时最大化计算效率（通过采用尽可能大的时间步长），我们选择等式：\n$$\\Delta t_{global} = \\min_{i} \\{\\Delta t_i\\}$$\n\n**4. 全局统一时间步长的计算**\n\n我们必须找到在第2部分计算的局部时间步长的最小值。\n$\\Delta t_{global} = \\min(\\Delta t_1, \\Delta t_2, \\Delta t_3, \\Delta t_4, \\Delta t_5, \\Delta t_6)$\n$\\Delta t_{global} = \\min(7.297, 5.035, 9.474, 8.889, 5.960, 7.079) \\times 10^{-7}\\,\\mathrm{s}$\n最小值为 $\\Delta t_2 \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$。\n\n我们现在精确计算这个值并将其转换为所需单位。\n$$\\Delta t_{global} = \\Delta t_2 = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.03496503... \\times 10^{-7}\\,\\mathrm{s}$$\n问题要求答案以微秒（$\\mathrm{\\mu s}$）为单位。换算关系是 $1\\,\\mathrm{s} = 10^6\\,\\mathrm{\\mu s}$。\n$$\\Delta t_{global} = (5.03496503... \\times 10^{-7}) \\times 10^6\\,\\mathrm{\\mu s} = 0.503496503...\\,\\mathrm{\\mu s}$$\n四舍五入到三位有效数字，我们得到 $0.503\\,\\mathrm{\\mu s}$。",
            "answer": "$$\\boxed{0.503}$$"
        },
        {
            "introduction": "自适应网格加密（AMR）是有效解析局部特征的强大技术，但它引入了必须仔细处理的多个网格尺度。本练习  探讨了 CFL 条件在 AMR 背景下的应用，展示了时间步长必须如何随网格加密比进行缩放。您将为一个多层级网格推导出一个稳定的时间步进方案，这是使用现代基于 AMR 的求解器的核心技能。",
            "id": "4045869",
            "problem": "使用带有两个层级（标记为 $\\ell=0$ (粗网格) 和 $\\ell=1$ (细网格)）的自适应网格加密 (AMR) 技术，计算一个一维反应流，以输运一个代表混合分数的被动标量穿过一个预混区域。该双曲输运由标量场 $u(x,t)$ 的线性平流方程 $u_t + a u_x = 0$ 控制，其中 $a$ 是一个有界特征速度，代表流场中的最大对流信号速度。在每个层级上，双曲算子通过守恒有限体积一阶迎风通量和前向欧拉时间积分进行离散化。AMR 配置的加密比为 $r=4$，因此 $\\Delta x_1 = \\Delta x_0/r$，其中 $\\Delta x_\\ell$ 表示层级 $\\ell$ 上的空间步长。显式时间积分使用子循环，因此细网格层级在每个粗网格步长内执行 $r$ 个子步长。\n\n从线性平流方程和离散一阶迎风格式出发，推导该格式的 Courant–Friedrichs–Lewy (CFL) 条件所施加的时间步长稳定性约束。然后，在给定最大信号速度 $a_{\\max} = 15\\,\\mathrm{m/s}$、粗网格空间步长 $\\Delta x_0 = 2\\times 10^{-3}\\,\\mathrm{m}$ 和加密比 $r=4$ 的条件下，使用与该约束一致的最大稳定时间步长，为两个 AMR 层级计算一个稳定的时间步长方案 $(\\Delta t_0, \\Delta t_1)$。将每个时间步长四舍五入到四位有效数字。以秒为单位报告数组 $(\\Delta t_0, \\Delta t_1)$。",
            "solution": "合适的出发点是一维线性平流方程 $u_t + a u_x = 0$，它模拟了在特征速度为 $a$ 的流中一个标量的输运。针对该双曲方程，一个广泛使用的显式有限体积格式是带前向欧拉时间积分的一阶迎风法。在间距为 $\\Delta x$ 的均匀网格上，对于 $a>0$，时间层 $n$ 上的单元平均值 $u_i^n$ 的半离散更新可以写为\n$$\nu_i^{n+1} = u_i^n - C\\left(u_i^n - u_{i-1}^n\\right),\n$$\n其中库朗数 $C$ 定义为\n$$\nC \\equiv \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\n为了确定稳定性约束，我们进行 von Neumann (傅里叶) 稳定性分析。假设一个傅里叶模 $u_i^n = \\hat{u}^n \\exp\\!\\left(i k x_i\\right)$，其中 $x_i = i\\,\\Delta x$。将 $\\hat{u}^{n+1}$ 与 $\\hat{u}^{n}$ 联系起来的放大因子 $G$ 通过将傅里叶代入离散更新中得到：\n$$\nG = 1 - C\\left(1 - \\exp\\!\\left(-i k \\Delta x\\right)\\right).\n$$\n对于带迎风空间离散的前向欧拉方法，绝对稳定性要求对所有波数 $k$ 都有 $|G|\\leq 1$。计算 $|G|$，\n$$\n|G|^2 = \\left(1 - C + C\\cos(k\\Delta x)\\right)^2 + \\left(C\\sin(k\\Delta x)\\right)^2.\n$$\n展开并简化，\n$$\n|G|^2 = \\left(1 - C\\right)^2 + 2C\\left(1 - C\\right)\\cos(k\\Delta x) + C^2\\left(\\cos^2(k\\Delta x)+\\sin^2(k\\Delta x)\\right),\n$$\n并且由于 $\\cos^2(\\theta)+\\sin^2(\\theta)=1$，我们得到\n$$\n|G|^2 = \\left(1 - C\\right)^2 + 2C\\left(1 - C\\right)\\cos(k\\Delta x) + C^2 = 1 - 2C + 2C^2 + 2C\\left(1 - C\\right)\\cos(k\\Delta x).\n$$\n$|G|$ 对 $k$ 的最大值出现在 $\\cos(k\\Delta x)$ 的极值处，即 $\\cos(k\\Delta x)=\\pm 1$。在 $\\cos(k\\Delta x)=1$ 处计算，\n$$\n|G|^2_{\\max,\\,\\cos=1} = 1 - 2C + 2C^2 + 2C\\left(1 - C\\right) = 1,\n$$\n并在 $\\cos(k\\Delta x)=-1$ 处计算，\n$$\n|G|^2_{\\max,\\,\\cos=-1} = 1 - 2C + 2C^2 - 2C\\left(1 - C\\right) = \\left(1 - 2C\\right)^2.\n$$\n因此，对所有 $k$ 成立的条件 $|G|\\leq 1$ 等价于\n$$\n\\left|1 - 2C\\right| \\leq 1,\n$$\n这就得到\n$$\n0 \\leq C \\leq 1.\n$$\n因此，一阶迎风显式格式的最大稳定时间步长由 Courant–Friedrichs–Lewy (CFL) 条件确定\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{a_{\\max}},\n$$\n在稳定性极限处 $C=1$。\n\n在具有两个层级和加密比 $r=4$ 的 AMR 设置中，细网格层级的间距满足\n$$\n\\Delta x_1 = \\frac{\\Delta x_0}{r}.\n$$\n为了在保持稳定的同时最大化显式时间步长，我们选择\n$$\n\\Delta t_0 = \\frac{\\Delta x_0}{a_{\\max}}, \\qquad \\Delta t_1 = \\frac{\\Delta x_1}{a_{\\max}} = \\frac{\\Delta x_0}{r\\,a_{\\max}} = \\frac{\\Delta t_0}{r}.\n$$\n代入给定值 $\\Delta x_0 = 2\\times 10^{-3}\\,\\mathrm{m}$，$a_{\\max} = 15\\,\\mathrm{m/s}$ 和 $r=4$，\n$$\n\\Delta t_0 = \\frac{2\\times 10^{-3}}{15}\\,\\mathrm{s} = \\left(\\frac{2}{15}\\right)\\times 10^{-3}\\,\\mathrm{s} = 1.333\\ldots \\times 10^{-4}\\,\\mathrm{s},\n$$\n并且\n$$\n\\Delta t_1 = \\frac{\\Delta t_0}{4} = 3.333\\ldots \\times 10^{-5}\\,\\mathrm{s}.\n$$\n将每个值四舍五入到四位有效数字，得到\n$$\n\\Delta t_0 = 1.333\\times 10^{-4}\\,\\mathrm{s}, \\qquad \\Delta t_1 = 3.333\\times 10^{-5}\\,\\mathrm{s}.\n$$\n这些结果满足 $r=4$ 的子循环，并达到了所选显式格式的 CFL 稳定性极限。",
            "answer": "$$\\boxed{\\begin{pmatrix}1.333\\times 10^{-4} & 3.333\\times 10^{-5}\\end{pmatrix}}$$"
        }
    ]
}