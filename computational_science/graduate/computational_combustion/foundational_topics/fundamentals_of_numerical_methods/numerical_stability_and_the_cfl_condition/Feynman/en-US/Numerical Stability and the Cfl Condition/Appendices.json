{
    "hands_on_practices": [
        {
            "introduction": "The Courant-Friedrichs-Lewy (CFL) condition is a cornerstone of stability for explicit numerical methods. In real-world combustion simulations, flow properties like velocity $u$ and sound speed $c$ are rarely uniform, and adaptive meshing leads to varying cell sizes $\\Delta x$. This exercise guides you through the practical application of the CFL condition in such a heterogeneous environment, a common scenario when modeling phenomena like stratified combustion. By calculating local stable time steps for different cells and then determining the single required global step, you will solidify your understanding of why the \"weakest link\"—the cell with the most restrictive time step—governs the entire simulation's stability.",
            "id": "4045894",
            "problem": "Consider a one-dimensional, compressible, reactive flow representative of premixed combustion in a stratified temperature field, modeled by the conservative Euler equations for mass, momentum, and energy with species transport, written in integral form over a finite volume cell. An explicit finite-volume update of the advective–acoustic subsystem, ignoring chemical source terms via operator splitting, evolves the conservative state variables under the hyperbolic convective fluxes. The local characteristic wave speeds of the linearized hyperbolic subsystem are the eigenvalues of the flux Jacobian, and the maximum wave speed governs the time step restriction for stability in an explicit method.\n\nA uniform-in-time global time step is used over a spatially nonuniform mesh with cell widths $\\Delta x_{i}$ and spatially varying flow speed $u_{i}$ and speed of sound $c_{i}$ due to thermal gradients and composition changes. The mesh and state are:\n- Cell $i=1$: $\\Delta x_{1}=6.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{1}=-20\\,\\mathrm{m/s}$, $c_{1}=720\\,\\mathrm{m/s}$.\n- Cell $i=2$: $\\Delta x_{2}=4.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{2}=35\\,\\mathrm{m/s}$, $c_{2}=680\\,\\mathrm{m/s}$.\n- Cell $i=3$: $\\Delta x_{3}=1.0\\times 10^{-3}\\,\\mathrm{m}$, $u_{3}=50\\,\\mathrm{m/s}$, $c_{3}=900\\,\\mathrm{m/s}$.\n- Cell $i=4$: $\\Delta x_{4}=8.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{4}=10\\,\\mathrm{m/s}$, $c_{4}=800\\,\\mathrm{m/s}$.\n- Cell $i=5$: $\\Delta x_{5}=5.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{5}=-5\\,\\mathrm{m/s}$, $c_{5}=750\\,\\mathrm{m/s}$.\n- Cell $i=6$: $\\Delta x_{6}=7.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{6}=40\\,\\mathrm{m/s}$, $c_{6}=850\\,\\mathrm{m/s}$.\n\nUsing a Courant–Friedrichs–Lewy (CFL) number of $0.9$, perform the following:\n1. From first principles of hyperbolic conservation laws and explicit finite-volume stability, derive the local time step restriction in cell $i$ as a function of $\\Delta x_{i}$ and the maximum magnitude of the local characteristic speed. Identify that maximum speed in terms of $u_{i}$ and $c_{i}$ for the advective–acoustic Euler subsystem.\n2. Compute the local stable time step $\\Delta t_{i}$ in each cell for the data above.\n3. Explain, based on the domain-of-dependence argument and linear stability of explicit schemes, why a global uniform time step must satisfy the most restrictive local condition and thus be the minimum over $i$ of the local time steps.\n4. Provide the global uniform time step as a single numerical value equal to $\\min_{i}\\Delta t_{i}$. Round your final answer to three significant figures and express the final time step in $\\mathrm{\\mu s}$ (microseconds).",
            "solution": "The problem is found to be valid as it is scientifically grounded in the principles of computational fluid dynamics, specifically the stability of numerical methods for hyperbolic conservation laws. It is well-posed, objective, and contains all necessary information for a unique solution. We proceed with the solution, addressing the four required tasks sequentially.\n\n**1. Derivation of the Local Time Step Restriction**\n\nThe stability of explicit time-marching schemes for hyperbolic partial differential equations is governed by the Courant–Friedrichs–Lewy (CFL) condition. This condition arises from a consideration of the domains of dependence. The physical domain of dependence of a point $(x, t_0+\\Delta t)$ is the set of points at time $t_0$ that can influence the solution at $(x, t_0+\\Delta t)$. For a hyperbolic system, information propagates at finite characteristic wave speeds. The fastest such speed, $S_{max}$, determines the boundary of this domain.\n\nIn a finite-volume method, the updated value in a cell $i$ at time $n+1$, denoted $U_i^{n+1}$, is computed using the values in cell $i$ and its immediate neighbors at time $n$. The numerical domain of dependence for the average value in cell $i$ over one time step $\\Delta t$ is therefore the spatial region covered by these neighboring cells. For the scheme to be stable, the physical domain of dependence of cell $i$ must be a subset of its numerical domain of dependence.\n\nConsider a single cell $i$ with width $\\Delta x_i$. The fastest-moving physical information wave within this cell has a speed of $S_{max, i}$. In a time interval $\\Delta t$, this wave travels a distance of $S_{max, i} \\Delta t$. For a simple explicit scheme that uses only adjacent cells, the numerical scheme can only access information within a distance of approximately $\\Delta x_i$. To ensure that no physical signal travels farther than the numerical scheme can \"see,\" we must require that the distance traveled by the fastest wave is less than or equal to the cell width:\n$$S_{max, i} \\Delta t \\le \\Delta x_i$$\nThis implies a restriction on the time step:\n$$\\Delta t \\le \\frac{\\Delta x_i}{S_{max, i}}$$\nThis inequality is the core of the CFL condition. It is standard practice to introduce a safety factor, the CFL number $C$, where for stability $C \\le 1$ for a simple first-order scheme. The local maximum allowable time step $\\Delta t_i$ is then given by:\n$$\\Delta t_i = C \\frac{\\Delta x_i}{S_{max, i}}$$\nNext, we must identify the maximum characteristic speed, $S_{max, i}$, for the one-dimensional Euler equations. The eigenvalues of the flux Jacobian matrix for the Euler equations correspond to the characteristic wave speeds. In one spatial dimension, these eigenvalues are $\\lambda_1 = u$, $\\lambda_2 = u+c$, and $\\lambda_3 = u-c$, where $u$ is the local fluid velocity and $c$ is the local speed of sound. These correspond to an entropy/contact wave moving at speed $u$ and two acoustic waves moving at speeds $u+c$ and $u-c$ relative to a stationary frame.\n\nThe speed of signal propagation is the magnitude of these velocities. Therefore, the maximum local characteristic speed, $S_{max, i}$, is the maximum of the absolute values of these eigenvalues in cell $i$:\n$$S_{max, i} = \\max(|u_i|, |u_i+c_i|, |u_i-c_i|)$$\nSince the speed of sound $c_i$ is always positive, we can simplify this expression. The term $|u_i|+c_i$ is always greater than or equal to both $|u_i+c_i|$ (by the triangle inequality) and $|u_i-c_i| = |c_i-u_i|$. Also, since $c_i > 0$, $|u_i|+c_i > |u_i|$. Thus, the maximum is always given by the sum of the absolute fluid velocity and the speed of sound:\n$$S_{max, i} = |u_i| + c_i$$\nSubstituting this into the time step formula, we obtain the local time step restriction for each cell $i$:\n$$\\Delta t_i = C \\frac{\\Delta x_i}{|u_i| + c_i}$$\n\n**2. Computation of Local Stable Time Steps**\n\nUsing the derived formula with the given CFL number $C=0.9$ and the data for each cell:\n\n- **Cell $i=1$**:\n$S_{max, 1} = |u_1| + c_1 = |-20\\,\\mathrm{m/s}| + 720\\,\\mathrm{m/s} = 740\\,\\mathrm{m/s}$\n$\\Delta t_1 = 0.9 \\times \\frac{6.0\\times 10^{-4}\\,\\mathrm{m}}{740\\,\\mathrm{m/s}} = \\frac{5.4 \\times 10^{-4}}{740}\\,\\mathrm{s} \\approx 7.297 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=2$**:\n$S_{max, 2} = |u_2| + c_2 = |35\\,\\mathrm{m/s}| + 680\\,\\mathrm{m/s} = 715\\,\\mathrm{m/s}$\n$\\Delta t_2 = 0.9 \\times \\frac{4.0\\times 10^{-4}\\,\\mathrm{m}}{715\\,\\mathrm{m/s}} = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=3$**:\n$S_{max, 3} = |u_3| + c_3 = |50\\,\\mathrm{m/s}| + 900\\,\\mathrm{m/s} = 950\\,\\mathrm{m/s}$\n$\\Delta t_3 = 0.9 \\times \\frac{1.0\\times 10^{-3}\\,\\mathrm{m}}{950\\,\\mathrm{m/s}} = \\frac{9.0 \\times 10^{-4}}{950}\\,\\mathrm{s} \\approx 9.474 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=4$**:\n$S_{max, 4} = |u_4| + c_4 = |10\\,\\mathrm{m/s}| + 800\\,\\mathrm{m/s} = 810\\,\\mathrm{m/s}$\n$\\Delta t_4 = 0.9 \\times \\frac{8.0\\times 10^{-4}\\,\\mathrm{m}}{810\\,\\mathrm{m/s}} = \\frac{7.2 \\times 10^{-4}}{810}\\,\\mathrm{s} \\approx 8.889 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=5$**:\n$S_{max, 5} = |u_5| + c_5 = |-5\\,\\mathrm{m/s}| + 750\\,\\mathrm{m/s} = 755\\,\\mathrm{m/s}$\n$\\Delta t_5 = 0.9 \\times \\frac{5.0\\times 10^{-4}\\,\\mathrm{m}}{755\\,\\mathrm{m/s}} = \\frac{4.5 \\times 10^{-4}}{755}\\,\\mathrm{s} \\approx 5.960 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=6$**:\n$S_{max, 6} = |u_6| + c_6 = |40\\,\\mathrm{m/s}| + 850\\,\\mathrm{m/s} = 890\\,\\mathrm{m/s}$\n$\\Delta t_6 = 0.9 \\times \\frac{7.0\\times 10^{-4}\\,\\mathrm{m}}{890\\,\\mathrm{m/s}} = \\frac{6.3 \\times 10^{-4}}{890}\\,\\mathrm{s} \\approx 7.079 \\times 10^{-7}\\,\\mathrm{s}$\n\n**3. Justification for the Global Time Step**\n\nThe problem specifies the use of a \"uniform-in-time global time step,\" which we will denote as $\\Delta t_{\\text{global}}$. This means that all cells in the computational domain are advanced forward in time by the same amount, $\\Delta t_{\\text{global}}$, in each iteration.\n\nFor the entire simulation to be numerically stable, the CFL condition must be satisfied in every single cell of the domain. This yields a system of inequalities, one for each cell $i$:\n$$\\Delta t_{\\text{global}} \\le \\Delta t_i \\quad \\text{for all } i \\in \\{1, 2, 3, 4, 5, 6\\}$$\nTo satisfy all these conditions simultaneously, $\\Delta t_{\\text{global}}$ must be less than or equal to the smallest of all the local maximum allowable time steps. If $\\Delta t_{\\text{global}}$ were chosen to be larger than the minimum of the $\\Delta t_i$ values, there would be at least one cell in the domain for which the local CFL condition is violated. In that \"critical\" cell (the one with the smallest $\\Delta t_i$), a physical wave signal would propagate beyond the cell's boundary within a single time step, but the explicit numerical scheme would fail to account for its influence. This violation of causality leads to the growth of non-physical oscillations, causing a numerical instability that quickly corrupts the solution across the entire domain.\n\nTherefore, the global time step must be bounded by the minimum of the local stable time steps:\n$$\\Delta t_{\\text{global}} \\le \\min_{i} \\{\\Delta t_i\\}$$\nTo ensure stability while also maximizing computational efficiency (by taking the largest possible time step), one selects the equality:\n$$\\Delta t_{\\text{global}} = \\min_{i} \\{\\Delta t_i\\}$$\n\n**4. Calculation of the Global Uniform Time Step**\n\nWe must find the minimum of the local time steps computed in part 2.\n$\\Delta t_{\\text{global}} = \\min(\\Delta t_1, \\Delta t_2, \\Delta t_3, \\Delta t_4, \\Delta t_5, \\Delta t_6)$\n$\\Delta t_{\\text{global}} = \\min(7.297, 5.035, 9.474, 8.889, 5.960, 7.079) \\times 10^{-7}\\,\\mathrm{s}$\nThe minimum value is $\\Delta t_2 \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$.\n\nWe now compute this value precisely and convert it to the required units.\n$$\\Delta t_{\\text{global}} = \\Delta t_2 = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.03496503... \\times 10^{-7}\\,\\mathrm{s}$$\nThe problem asks for the answer in microseconds ($\\mathrm{\\mu s}$). The conversion is $1\\,\\mathrm{s} = 10^6\\,\\mathrm{\\mu s}$.\n$$\\Delta t_{\\text{global}} = (5.03496503... \\times 10^{-7}) \\times 10^6\\,\\mathrm{\\mu s} = 0.503496503...\\,\\mathrm{\\mu s}$$\nRounding to three significant figures, we get $0.503\\,\\mathrm{\\mu s}$.",
            "answer": "$$\\boxed{0.503}$$"
        },
        {
            "introduction": "To efficiently resolve thin flame fronts or boundary layers, combustion simulations often employ anisotropic meshes where grid cells are stretched significantly in one or more directions (e.g., $\\Delta x \\ll \\Delta y$). This geometric choice has profound implications for the stability of explicit time-stepping schemes. This practice extends the one-dimensional CFL condition to a multi-dimensional transport problem, allowing you to explore its behavior on an anisotropic grid. Through this derivation and calculation, you will gain a crucial insight: the stable time step is often dominated by the time it takes for a wave to traverse the smallest grid spacing, a key principle in designing efficient and stable multi-dimensional simulations.",
            "id": "4045928",
            "problem": "Consider a two-dimensional convective transport of a conserved scalar field $Y(x,y,t)$ representative of a mixture fraction in a premixed flame, governed by the linear advection equation $ \\frac{\\partial Y}{\\partial t} + a_{x}\\frac{\\partial Y}{\\partial x} + a_{y}\\frac{\\partial Y}{\\partial y} = 0$, where $a_{x}$ and $a_{y}$ are constant advection speeds along the $x$- and $y$-directions. The domain is discretized using a uniform Cartesian mesh with spacings $\\Delta x$ and $\\Delta y$, and the evolution is computed using an explicit first-order conservative finite volume method (FVM) with an upwind numerical flux for each face. The Courant–Friedrichs–Lewy (CFL) condition for stability in explicit schemes is tied to the requirement that the discrete domain of dependence includes the continuous domain of dependence of the hyperbolic equation. \n\nStarting from the conservation law and the discrete upwind flux construction, derive the multi-dimensional stability restriction that links the time step $\\Delta t$ to the wave speeds and the mesh spacings. Use your derivation to explain, in the asymptotic regime $\\Delta x \\ll \\Delta y$, why the stability bound on $\\Delta t$ is constrained primarily by the smallest spacing, even when $a_{x} \\neq a_{y}$. Then, for a computational combustion simulation with an anisotropic mesh and anisotropic advection, compute the largest stable time step using the following parameters: $a_{x} = 12\\,\\text{m}\\,\\text{s}^{-1}$, $a_{y} = 4\\,\\text{m}\\,\\text{s}^{-1}$, $\\Delta x = 5 \\times 10^{-5}\\,\\text{m}$, $\\Delta y = 2 \\times 10^{-3}\\,\\text{m}$, and a chosen Courant number $C_{\\text{CFL}} = 0.8$. Express your final answer in seconds and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation of the multi-dimensional stability condition for a linear advection equation discretized with a first-order upwind finite volume method (FVM), an explanation of the behavior in an anisotropic mesh regime, and a calculation of the maximum stable time step for a given set of parameters.\n\nThe governing partial differential equation (PDE) is the two-dimensional linear advection equation for a scalar field $Y(x,y,t)$:\n$$\n\\frac{\\partial Y}{\\partial t} + a_{x}\\frac{\\partial Y}{\\partial x} + a_{y}\\frac{\\partial Y}{\\partial y} = 0\n$$\nwhere $a_{x}$ and $a_{y}$ are constant advection speeds. This equation can be written in conservation law form as:\n$$\n\\frac{\\partial Y}{\\partial t} + \\nabla \\cdot \\mathbf{F} = 0\n$$\nwhere the flux vector is $\\mathbf{F} = (a_x Y, a_y Y)$.\n\nWe consider a uniform Cartesian grid with cell spacings $\\Delta x$ and $\\Delta y$. Let a control volume (cell) be denoted by $\\Omega_{i,j} = [x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}]$, with area $A = \\Delta x \\Delta y$. Integrating the conservation law over this cell gives:\n$$\n\\iint_{\\Omega_{i,j}} \\frac{\\partial Y}{\\partial t} \\,dx\\,dy + \\iint_{\\Omega_{i,j}} \\nabla \\cdot \\mathbf{F} \\,dx\\,dy = 0\n$$\nUsing the divergence theorem on the second term, we get:\n$$\n\\frac{d}{dt} \\iint_{\\Omega_{i,j}} Y \\,dx\\,dy + \\oint_{\\partial\\Omega_{i,j}} \\mathbf{F} \\cdot \\mathbf{n} \\,ds = 0\n$$\nLet $\\bar{Y}_{i,j}(t) = \\frac{1}{\\Delta x \\Delta y} \\iint_{\\Omega_{i,j}} Y(x,y,t) \\,dx\\,dy$ be the cell-averaged value of $Y$. The equation becomes:\n$$\n\\Delta x \\Delta y \\frac{d\\bar{Y}_{i,j}}{dt} + \\int_{y_{j-1/2}}^{y_{j+1/2}} (a_x Y)_{i+1/2,y} \\,dy - \\int_{y_{j-1/2}}^{y_{j+1/2}} (a_x Y)_{i-1/2,y} \\,dy + \\int_{x_{i-1/2}}^{x_{i+1/2}} (a_y Y)_{x,j+1/2} \\,dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} (a_y Y)_{x,j-1/2} \\,dx = 0\n$$\nDiscretizing in time using an explicit forward Euler scheme and approximating the spatial integrals, we get the finite volume update equation:\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\left[ F_{x, i+1/2,j}^* - F_{x, i-1/2,j}^* \\right] - \\frac{\\Delta t}{\\Delta y} \\left[ F_{y, i,j+1/2}^* - F_{y, i,j-1/2}^* \\right]\n$$\nwhere $F^*$ represents the numerical flux at the cell faces. For the first-order upwind scheme, the numerical flux is determined by the sign of the advection velocity. For simplicity, let's assume $a_x > 0$ and $a_y > 0$. The value of $Y$ at the face is taken from the upwind cell.\nThe numerical fluxes are:\n$F_{x, i+1/2,j}^* = a_x \\bar{Y}_{i,j}^n$\n$F_{x, i-1/2,j}^* = a_x \\bar{Y}_{i-1,j}^n$\n$F_{y, i,j+1/2}^* = a_y \\bar{Y}_{i,j}^n$\n$F_{y, i,j-1/2}^* = a_y \\bar{Y}_{i,j-1}^n$\n\nSubstituting these into the update equation:\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( a_x \\bar{Y}_{i,j}^n - a_x \\bar{Y}_{i-1,j}^n \\right) - \\frac{\\Delta t}{\\Delta y} \\left( a_y \\bar{Y}_{i,j}^n - a_y \\bar{Y}_{i,j-1}^n \\right)\n$$\nLet's define the directional Courant numbers $C_x = \\frac{a_x \\Delta t}{\\Delta x}$ and $C_y = \\frac{a_y \\Delta t}{\\Delta y}$. The equation becomes:\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - C_x (\\bar{Y}_{i,j}^n - \\bar{Y}_{i-1,j}^n) - C_y (\\bar{Y}_{i,j}^n - \\bar{Y}_{i,j-1}^n)\n$$\nRearranging the terms to group coefficients of the cell values at time level $n$:\n$$\n\\bar{Y}_{i,j}^{n+1} = (1 - C_x - C_y) \\bar{Y}_{i,j}^{n} + C_x \\bar{Y}_{i-1,j}^n + C_y \\bar{Y}_{i,j-1}^n\n$$\nFor the scheme to be stable (and for this specific scheme, to be monotone or positivity-preserving), all coefficients on the right-hand side must be non-negative. Since $a_x, a_y, \\Delta t, \\Delta x, \\Delta y$ are all positive, $C_x \\ge 0$ and $C_y \\ge 0$ are satisfied. The remaining condition is for the coefficient of $\\bar{Y}_{i,j}^{n}$:\n$$\n1 - C_x - C_y \\ge 0 \\implies C_x + C_y \\le 1\n$$\nThis derivation assumes $a_x > 0$ and $a_y > 0$. If we generalize to arbitrary signs of $a_x$ and $a_y$, the upwind scheme takes values from the appropriate neighboring cells, and the resulting stability condition uses the absolute values of the velocities:\n$$\n\\frac{|a_x| \\Delta t}{\\Delta x} + \\frac{|a_y| \\Delta t}{\\Delta y} \\le 1\n$$\nThis is the multi-dimensional stability restriction for the first-order upwind scheme, often called the Courant–Friedrichs–Lewy (CFL) condition. It links the time step $\\Delta t$ to the wave speeds $|a_x|, |a_y|$ and the mesh spacings $\\Delta x, \\Delta y$. We can isolate $\\Delta t$:\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y}}\n$$\nNow, we explain the behavior in the asymptotic regime $\\Delta x \\ll \\Delta y$. The stability bound on $\\Delta t$ is determined by the denominator of the fraction, which is the sum of two terms: $\\frac{|a_x|}{\\Delta x}$ and $\\frac{|a_y|}{\\Delta y}$. When $\\Delta x$ is much smaller than $\\Delta y$, the term $\\frac{1}{\\Delta x}$ is much larger than $\\frac{1}{\\Delta y}$. Assuming $|a_x|$ and $|a_y|$ are of comparable magnitude (as in the given problem), the term $\\frac{|a_x|}{\\Delta x}$ will be significantly larger than $\\frac{|a_y|}{\\Delta y}$. Consequently, the sum is dominated by the first term:\n$$\n\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y} \\approx \\frac{|a_x|}{\\Delta x}\n$$\nThe stability bound on the time step thus becomes approximately:\n$$\n\\Delta t \\lesssim \\frac{1}{\\frac{|a_x|}{\\Delta x}} = \\frac{\\Delta x}{|a_x|}\n$$\nThis demonstrates that in an anisotropic mesh with one dimension having a much smaller spacing, the stability of the explicit scheme is primarily constrained by the Courant number condition in that dimension. The physical interpretation is that the time step must be small enough to prevent information from propagating across the smallest cell in a single step. The time required for a wave to cross the small cell dimension, $\\Delta x / |a_x|$, is much less than the time to cross the larger dimension, $\\Delta y / |a_y|$, making it the limiting factor.\n\nFinally, we compute the largest stable time step, $\\Delta t_{\\text{max}}$, for the given parameters. In practical applications, a safety factor, the Courant number $C_{\\text{CFL}}$, is used, such that the stability condition is written as:\n$$\n\\frac{|a_x| \\Delta t}{\\Delta x} + \\frac{|a_y| \\Delta t}{\\Delta y} \\le C_{\\text{CFL}}\n$$\nThe largest stable time step corresponds to the equality:\n$$\n\\Delta t_{\\text{max}} = \\frac{C_{\\text{CFL}}}{\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y}}\n$$\nGiven parameters: $a_{x} = 12\\,\\text{m}\\,\\text{s}^{-1}$, $a_{y} = 4\\,\\text{m}\\,\\text{s}^{-1}$, $\\Delta x = 5 \\times 10^{-5}\\,\\text{m}$, $\\Delta y = 2 \\times 10^{-3}\\,\\text{m}$, and $C_{\\text{CFL}} = 0.8$.\nFirst, calculate the two terms in the denominator:\n$$\n\\frac{|a_x|}{\\Delta x} = \\frac{12}{5 \\times 10^{-5}} = \\frac{12}{5} \\times 10^{5} = 2.4 \\times 10^{5} \\, \\text{s}^{-1}\n$$\n$$\n\\frac{|a_y|}{\\Delta y} = \\frac{4}{2 \\times 10^{-3}} = 2 \\times 10^{3} = 2000 \\, \\text{s}^{-1}\n$$\nAs expected, the term corresponding to the $x$-direction is much larger. Now, we sum them:\n$$\n\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y} = 2.4 \\times 10^{5} + 2000 = 240000 + 2000 = 242000 \\, \\text{s}^{-1} = 2.42 \\times 10^{5} \\, \\text{s}^{-1}\n$$\nNow we compute $\\Delta t_{\\text{max}}$:\n$$\n\\Delta t_{\\text{max}} = \\frac{0.8}{2.42 \\times 10^{5}} \\, \\text{s} \\approx 0.3305785... \\times 10^{-5} \\, \\text{s} = 3.305785... \\times 10^{-6} \\, \\text{s}\n$$\nRounding the answer to four significant figures, we get:\n$$\n\\Delta t_{\\text{max}} \\approx 3.306 \\times 10^{-6} \\, \\text{s}\n$$",
            "answer": "$$\n\\boxed{3.306 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "Modern computational engines do not use a fixed time step but rather adapt it dynamically to balance efficiency with the stringent demands of accuracy and stability. This is especially critical in combustion, where a robust control system must juggle competing time step constraints arising from fast-moving advection, rapid diffusion across small cells, and extremely stiff chemical reaction kinetics. This problem moves beyond simple, fixed-step analysis to the advanced and practical topic of adaptive time-step control. By evaluating several control strategies for a representative advection-diffusion-reaction system, you will learn to identify the essential components of a robust algorithm that can navigate multiple physical constraints without introducing numerical oscillations.",
            "id": "4045927",
            "problem": "Consider a one-dimensional reacting flow representative of premixed flame propagation, governed by the conservation of a generic species mass fraction $Y(x,t)$ with advection, diffusion, and reaction, \n$$\\frac{\\partial Y}{\\partial t} + u(x,t)\\frac{\\partial Y}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(D(x,t)\\frac{\\partial Y}{\\partial x}\\right) + \\omega(Y,T),$$\ndiscretized on a uniform grid of spacing $\\Delta x$ using an explicit second-order Strong Stability Preserving Runge–Kutta (SSP RK2) method for all terms. The Courant–Friedrichs–Lewy (CFL) condition imposes constraints on the time step $\\Delta t$ for the advective and diffusive operators, and the linearized reaction operator imposes a constraint via the largest (in magnitude) eigenvalue of the Jacobian. The local truncation error is estimated by an embedded error estimator and normalized against a target tolerance to provide an accuracy indicator.\n\nAt a particular time level $t_k$, the solver has the following observed bounds:\n- Maximum advection speed $u_{\\max} = 15\\,\\mathrm{m/s}$,\n- Grid spacing $\\Delta x = 1\\times 10^{-4}\\,\\mathrm{m}$,\n- Maximum diffusion coefficient $D_{\\max} = 1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$,\n- Largest real negative eigenvalue magnitude of the reaction Jacobian $|\\lambda_{\\max}| = 2000\\,\\mathrm{s}^{-1}$,\n- Current time step $\\Delta t_k = 2\\times 10^{-7}\\,\\mathrm{s}$,\n- Normalized local error estimate $e_k = 0.4$ with target tolerance $\\tau = 0.5$.\n\nTreat the advective CFL limit for SSP RK2 with a first-order upwind spatial discretization as order-unity on the real axis, the diffusive explicit stability limit in one spatial dimension as $\\Delta t \\le \\Delta x^2/(2D_{\\max})$, and the reaction stability restriction for SSP RK2 as $|\\lambda|\\Delta t \\le 2$ along the negative real axis of the linear test equation. Define the stability margin $m_k$ as the ratio of the most restrictive allowable time step to the current time step, and interpret $e_k$ and $\\tau$ as accuracy indicators tied to local truncation error scaling for a second-order method.\n\nWhich option best justifies adaptive $\\Delta t$ increase and decrease rules based on these stability margins and accuracy indicators and explains how to avoid oscillatory time-step changes?\n\nA. Compute the allowable stability-limited time step as $\\Delta t_{\\mathrm{stab}} = \\min\\left(\\frac{\\Delta x}{u_{\\max}},\\,\\frac{\\Delta x^2}{2D_{\\max}},\\,\\frac{2}{|\\lambda_{\\max}|}\\right)$ and the stability margin $m_k = \\Delta t_{\\mathrm{stab}}/\\Delta t_k$. Update using a Proportional–Integral (PI) controller that combines accuracy and stability, $\\Delta t_{k+1} = \\Delta t_k \\left(\\frac{\\tau}{e_k}\\right)^{\\alpha} m_k^{\\beta}$, with small exponents $0<\\alpha,\\beta<1$ and hard limits on per-step change (e.g., $\\Delta t_{k+1}/\\Delta t_k \\in [0.5,\\,1.3]$). Impose hysteresis: only increase if $m_k > 1+\\delta$ and $e_k < \\tau(1-\\eta)$, and only decrease if $m_k < 1$ or $e_k > \\tau$, with $\\delta,\\eta>0$ small. Also enforce monotonicity guards such as not allowing an increase immediately after a decrease. This combines margins and error in a filtered way to avoid flip–flop.\n\nB. Set $\\Delta t_{k+1} = \\Delta t_{\\mathrm{stab}}$ whenever $e_k \\le \\tau$ and set $\\Delta t_{k+1} = \\Delta t_k/2$ whenever $e_k > \\tau$. This uses the most permissive stability limit whenever the error is acceptable and rapidly halves the time step otherwise, ensuring aggressive utilization of stability.\n\nC. Drive $\\Delta t$ solely by the error indicator via $\\Delta t_{k+1} = \\Delta t_k \\left(\\frac{\\tau}{e_k}\\right)$ without stability margins, because the SSP RK2 method is robust, and the error estimator reflects both stability and accuracy. Oscillations are unlikely when the tolerance is moderate.\n\nD. Use only the advective CFL to constrain the time step, $\\Delta t \\le \\Delta x/u_{\\max}$, and adjust by doubling when $\\Delta x/u_{\\max} > \\Delta t_k$ and halving when $\\Delta x/u_{\\max}  \\Delta t_k$, because advection dominates transport in premixed flames; diffusion and reaction are secondary and can be ignored in the controller.\n\nE. Choose the allowable time step for stability as the maximum among the three constraints, $\\Delta t_{\\max} = \\max\\left(\\frac{\\Delta x}{u_{\\max}},\\,\\frac{\\Delta x^2}{2D_{\\max}},\\,\\frac{2}{|\\lambda_{\\max}|}\\right)$, and use a square-root accuracy controller, $\\Delta t_{k+1} = \\Delta t_k \\left(\\frac{\\tau}{e_k}\\right)^{1/2}$, to be conservative. Oscillation can be avoided by always increasing $\\Delta t$ when $e_k\\tau$ and decreasing otherwise.",
            "solution": "The problem is scientifically grounded, well-posed, and objective. It presents a realistic scenario in advanced computational science: designing a robust adaptive time-step controller for a stiff advection-diffusion-reaction system. All necessary data and stability criteria are provided to evaluate the proposed strategies.\n\nA robust adaptive time-step controller must achieve four main goals:\n1.  **Ensure Stability**: The time step $\\Delta t$ must satisfy all physical stability constraints simultaneously.\n2.  **Control Accuracy**: The time step should be adjusted so the local error estimate $e_k$ remains close to the target tolerance $\\tau$.\n3.  **Maximize Efficiency**: The time step should be as large as possible while satisfying the stability and accuracy requirements.\n4.  **Avoid Oscillation**: The controller should prevent rapid, inefficient fluctuations (\"flip-flopping\") in the time step size.\n\nFirst, we calculate the individual stability limits based on the provided data:\n-   **Advective limit** ($\\Delta t_a$): Based on the problem's guideline, $\\Delta t_a \\le \\frac{\\Delta x}{u_{\\max}}$.\n    $\\Delta t_a = \\frac{1\\times 10^{-4}\\,\\mathrm{m}}{15\\,\\mathrm{m/s}} \\approx 6.67 \\times 10^{-6}\\,\\mathrm{s}$.\n-   **Diffusive limit** ($\\Delta t_d$): The problem states $\\Delta t_d \\le \\frac{\\Delta x^2}{2D_{\\max}}$.\n    $\\Delta t_d = \\frac{(1\\times 10^{-4}\\,\\mathrm{m})^2}{2 \\times (1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s})} = \\frac{1\\times 10^{-8}}{2\\times 10^{-4}}\\,\\mathrm{s} = 5.0 \\times 10^{-5}\\,\\mathrm{s}$.\n-   **Reaction limit** ($\\Delta t_r$): For SSP RK2, the problem gives the criterion $|\\lambda|\\Delta t \\le 2$.\n    $\\Delta t_r = \\frac{2}{|\\lambda_{\\max}|} = \\frac{2}{2000\\,\\mathrm{s}^{-1}} = 1.0 \\times 10^{-3}\\,\\mathrm{s}$.\n\nThe overall stability-limited time step, $\\Delta t_{\\mathrm{stab}}$, must be the minimum of these to satisfy all constraints:\n$$ \\Delta t_{\\mathrm{stab}} = \\min(\\Delta t_a, \\Delta t_d, \\Delta t_r) = \\min(6.67 \\times 10^{-6}\\,\\mathrm{s}, 5.0 \\times 10^{-5}\\,\\mathrm{s}, 1.0 \\times 10^{-3}\\,\\mathrm{s}) = 6.67 \\times 10^{-6}\\,\\mathrm{s} $$\nThe advection constraint is the most restrictive.\n\nNow, we evaluate the current state at time step $t_k$:\n-   Current time step: $\\Delta t_k = 2\\times 10^{-7}\\,\\mathrm{s}$.\n-   Stability margin: $m_k = \\frac{\\Delta t_{\\mathrm{stab}}}{\\Delta t_k} \\approx \\frac{6.67 \\times 10^{-6}}{2 \\times 10^{-7}} \\approx 33.4$. Since $m_k \\gg 1$, the current step is far from the stability limit.\n-   Accuracy: $e_k = 0.4$ and $\\tau = 0.5$. Since $e_k  \\tau$, the step is more accurate than required.\n\nGiven that the current step is both overly cautious for stability and more accurate than needed, a good controller should increase the time step.\n\n**Analysis of Options:**\n\n**A. Correct.** This option describes a state-of-the-art robust control strategy.\n-   **Stability**: It correctly computes $\\Delta t_{\\mathrm{stab}}$ as the `min` of all constraints.\n-   **Accuracy  Stability Integration**: It uses a combined formula $\\Delta t_{k+1} = \\Delta t_k \\left(\\frac{\\tau}{e_k}\\right)^{\\alpha} m_k^{\\beta}$ that incorporates both the accuracy requirement (via $e_k/\\tau$) and the stability margin ($m_k$). Using small exponents provides damping.\n-   **Oscillation Avoidance**: It explicitly lists several crucial techniques: hard limits on step change (e.g., factor of $1.3$), hysteresis (separate, non-overlapping conditions for increasing and decreasing $\\Delta t$), and monotonicity guards. These are exactly the features needed to prevent oscillations.\n\n**B. Incorrect.** This describes a \"bang-bang\" controller. If $e_k \\le \\tau$, it jumps aggressively to $\\Delta t_{\\mathrm{stab}}$. If $e_k > \\tau$, it halves the step. This aggressive switching is a classic cause of time-step oscillation. For instance, a step at $\\Delta t_{\\mathrm{stab}}$ might yield $e_k > \\tau$, causing the next step to be $\\Delta t_{\\mathrm{stab}}/2$, which would likely yield $e_{k+1} \\ll \\tau$, causing the controller to jump back to $\\Delta t_{\\mathrm{stab}}$, and so on.\n\n**C. Incorrect.** This strategy is fatally flawed because it ignores the explicit stability constraints. An accuracy controller alone cannot guarantee stability for an explicit method. A new step $\\Delta t_{k+1}$ calculated from this rule could easily exceed $\\Delta t_{\\mathrm{stab}}$, causing the simulation to crash. The claim that the error estimator reflects stability is only partially true and cannot be relied upon to enforce a hard stability limit.\n\n**D. Incorrect.** This strategy is incomplete and naive. It correctly identifies the advective limit as dominant for these specific parameters but wrongly assumes this is always true. In a diffusion- or reaction-dominated regime, ignoring those constraints would lead to instability. It also lacks any accuracy control and uses a crude doubling/halving logic that is prone to oscillation.\n\n**E. Incorrect.** This option contains multiple fundamental errors.\n-   It incorrectly chooses the `max` of the stability constraints instead of the `min`. This would immediately violate the two most restrictive limits (advection and diffusion) and cause instability.\n-   The controller $\\Delta t_{k+1} = \\Delta t_k \\left(\\frac{\\tau}{e_k}\\right)^{1/2}$ has an exponent of $1/2$, which is appropriate for a first-order method, not the second-order method stated in the problem (for which the exponent would theoretically be $1/3$).\n-   The proposed method for avoiding oscillation (\"always increasing $\\Delta t$ when $e_k  \\tau$ and decreasing otherwise\") is precisely the mechanism that *causes* oscillation, as it lacks any damping or hysteresis.\n\n**Conclusion:**\nOption A is the only one that provides a comprehensive, correct, and robust justification for an adaptive time-step controller, correctly balancing stability and accuracy while actively preventing numerical oscillations.",
            "answer": "$$\n\\boxed{A}\n$$"
        }
    ]
}