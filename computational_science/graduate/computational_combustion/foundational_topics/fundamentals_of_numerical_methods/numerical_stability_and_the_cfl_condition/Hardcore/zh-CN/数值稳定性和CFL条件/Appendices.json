{
    "hands_on_practices": [
        {
            "introduction": "实践是检验理论的唯一标准。本节的第一个练习将CFL条件的基本原理应用于一个常见的计算燃烧场景：在非均匀网格上模拟可压缩反应流。在真实世界的模拟中，由于温度和组分的梯度，声速和流速在空间上不断变化，同时网格尺寸也可能不同。这个练习将指导你计算每个网格单元的局部稳定时间步长，并理解为什么全局时间步长必须由最苛刻的局部条件决定。",
            "id": "4045894",
            "problem": "考虑一个一维、可压缩、反应流，它代表了分层温度场中的预混燃烧。该流动由质量、动量和能量的守恒欧拉方程以及组分输运方程来模拟，这些方程以在有限体积单元上的积分形式写出。通过算子分裂忽略化学源项，对平流-声学子系统进行显式有限体积更新，从而在双曲对流通量的作用下演化守恒状态变量。线性化双曲子系统的局部特征波速是通量雅可比矩阵的特征值，最大波速决定了显式方法稳定性的时间步长限制。\n\n在空间非均匀网格上使用时间上一致的全局时间步长，该网格具有单元宽度$\\Delta x_{i}$，并且由于温度梯度和成分变化，流速$u_{i}$和声速$c_{i}$在空间上变化。网格和状态如下：\n- 单元 $i=1$：$\\Delta x_{1}=6.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{1}=-20\\,\\mathrm{m/s}$，$c_{1}=720\\,\\mathrm{m/s}$。\n- 单元 $i=2$：$\\Delta x_{2}=4.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{2}=35\\,\\mathrm{m/s}$，$c_{2}=680\\,\\mathrm{m/s}$。\n- 单元 $i=3$：$\\Delta x_{3}=1.0\\times 10^{-3}\\,\\mathrm{m}$，$u_{3}=50\\,\\mathrm{m/s}$，$c_{3}=900\\,\\mathrm{m/s}$。\n- 单元 $i=4$：$\\Delta x_{4}=8.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{4}=10\\,\\mathrm{m/s}$，$c_{4}=800\\,\\mathrm{m/s}$。\n- 单元 $i=5$：$\\Delta x_{5}=5.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{5}=-5\\,\\mathrm{m/s}$，$c_{5}=750\\,\\mathrm{m/s}$。\n- 单元 $i=6$：$\\Delta x_{6}=7.0\\times 10^{-4}\\,\\mathrm{m}$，$u_{6}=40\\,\\mathrm{m/s}$，$c_{6}=850\\,\\mathrm{m/s}$。\n\n使用库朗-弗里德里希斯-列维（CFL）数 $0.9$，完成以下任务：\n1. 从双曲守恒律和显式有限体积稳定性的第一性原理出发，推导单元 $i$ 中的局部时间步长限制，该限制是 $\\Delta x_{i}$ 和局部特征速度最大值的函数。对于平流-声学欧拉子系统，确定该最大速度（用 $u_{i}$ 和 $c_{i}$ 表示）。\n2. 根据以上数据，计算每个单元中的局部稳定时间步长 $\\Delta t_{i}$。\n3. 基于依赖域论证和显式格式的线性稳定性，解释为什么全局统一时间步长必须满足最严格的局部条件，因此必须是所有局部时间步长 $i$ 中的最小值。\n4. 提供全局统一时间步长，其为一个等于 $\\min_{i}\\Delta t_{i}$ 的单一数值。将最终答案四舍五入到三位有效数字，并以 $\\mathrm{\\mu s}$（微秒）表示。",
            "solution": "经检验，该问题是有效的，因为它在科学上基于计算流体动力学的原理，特别是双曲守恒律数值方法的稳定性。该问题是适定的、客观的，并包含唯一解所需的所有必要信息。我们按顺序处理这四个要求的任务来给出解答。\n\n**1. 局部时间步长限制的推导**\n\n对于双曲偏微分方程，显式时间推进格式的稳定性由库朗-弗里德里希斯-列维（CFL）条件决定。该条件源于对依赖域的考虑。点 $(x, t_0+\\Delta t)$ 的物理依赖域是在时间 $t_0$ 时能够影响点 $(x, t_0+\\Delta t)$ 处解的点的集合。对于双曲系统，信息以有限的特征波速传播。最快的波速 $S_{max}$ 决定了这个域的边界。\n\n在有限体积法中，时间步 $n+1$ 时单元 $i$ 中的更新值（记为 $U_i^{n+1}$）是使用时间步 $n$ 时单元 $i$ 及其紧邻单元的值计算的。因此，对于一个时间步长 $\\Delta t$，单元 $i$ 中平均值的数值依赖域是这些相邻单元所覆盖的空间区域。为使格式稳定，单元 $i$ 的物理依赖域必须是其数值依赖域的子集。\n\n考虑一个宽度为 $\\Delta x_i$ 的单元 $i$。此单元内移动最快的物理信息波的速度为 $S_{max, i}$。在时间间隔 $\\Delta t$ 内，此波传播的距离为 $S_{max, i} \\Delta t$。对于一个只使用相邻单元的简单显式格式，数值格式只能获取大约 $\\Delta x_i$ 距离内的信息。为确保没有任何物理信号传播的距离超过数值格式所能“看到”的范围，我们必须要求最快波传播的距离小于或等于单元宽度：\n$$S_{max, i} \\Delta t \\le \\Delta x_i$$\n这意味着对时间步长的限制：\n$$\\Delta t \\le \\frac{\\Delta x_i}{S_{max, i}}$$\n这个不等式是 CFL 条件的核心。通常做法是引入一个安全因子，即 CFL 数 $C$。对于简单的一阶格式，为保证稳定性，$C \\le 1$。于是，局部最大允许时间步长 $\\Delta t_i$ 由下式给出：\n$$\\Delta t_i = C \\frac{\\Delta x_i}{S_{max, i}}$$\n接下来，我们必须确定一维欧拉方程的最大特征速度 $S_{max, i}$。欧拉方程通量雅可比矩阵的特征值对应于特征波速。在一维空间中，这些特征值为 $\\lambda_1 = u$、$\\lambda_2 = u+c$ 和 $\\lambda_3 = u-c$，其中 $u$ 是局部流体速度，$c$ 是局部声速。这些对应于一个以速度 $u$ 移动的熵波/接触波，以及两个相对于静止坐标系以速度 $u+c$ 和 $u-c$ 移动的声波。\n\n信号传播的速度是这些速度的大小。因此，局部最大特征速度 $S_{max, i}$ 是单元 $i$ 中这些特征值绝对值的最大值：\n$$S_{max, i} = \\max(|u_i|, |u_i+c_i|, |u_i-c_i|)$$\n由于声速 $c_i$ 总是正的，我们可以简化这个表达式。项 $|u_i|+c_i$ 总是大于或等于 $|u_i+c_i|$（根据三角不等式）和 $|u_i-c_i| = |c_i-u_i|$。并且，由于 $c_i > 0$，所以 $|u_i|+c_i > |u_i|$。因此，最大值总是由绝对流速与声速之和给出：\n$$S_{max, i} = |u_i| + c_i$$\n将此代入时间步长公式，我们得到每个单元 $i$ 的局部时间步长限制：\n$$\\Delta t_i = C \\frac{\\Delta x_i}{|u_i| + c_i}$$\n\n**2. 局部稳定时间步长的计算**\n\n使用推导出的公式，以及给定的 CFL 数 $C=0.9$ 和每个单元的数据：\n\n- **单元 $i=1$**：\n$S_{max, 1} = |u_1| + c_1 = |-20\\,\\mathrm{m/s}| + 720\\,\\mathrm{m/s} = 740\\,\\mathrm{m/s}$\n$\\Delta t_1 = 0.9 \\times \\frac{6.0\\times 10^{-4}\\,\\mathrm{m}}{740\\,\\mathrm{m/s}} = \\frac{5.4 \\times 10^{-4}}{740}\\,\\mathrm{s} \\approx 7.297 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=2$**：\n$S_{max, 2} = |u_2| + c_2 = |35\\,\\mathrm{m/s}| + 680\\,\\mathrm{m/s} = 715\\,\\mathrm{m/s}$\n$\\Delta t_2 = 0.9 \\times \\frac{4.0\\times 10^{-4}\\,\\mathrm{m}}{715\\,\\mathrm{m/s}} = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=3$**：\n$S_{max, 3} = |u_3| + c_3 = |50\\,\\mathrm{m/s}| + 900\\,\\mathrm{m/s} = 950\\,\\mathrm{m/s}$\n$\\Delta t_3 = 0.9 \\times \\frac{1.0\\times 10^{-3}\\,\\mathrm{m}}{950\\,\\mathrm{m/s}} = \\frac{9.0 \\times 10^{-4}}{950}\\,\\mathrm{s} \\approx 9.474 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=4$**：\n$S_{max, 4} = |u_4| + c_4 = |10\\,\\mathrm{m/s}| + 800\\,\\mathrm{m/s} = 810\\,\\mathrm{m/s}$\n$\\Delta t_4 = 0.9 \\times \\frac{8.0\\times 10^{-4}\\,\\mathrm{m}}{810\\,\\mathrm{m/s}} = \\frac{7.2 \\times 10^{-4}}{810}\\,\\mathrm{s} \\approx 8.889 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=5$**：\n$S_{max, 5} = |u_5| + c_5 = |-5\\,\\mathrm{m/s}| + 750\\,\\mathrm{m/s} = 755\\,\\mathrm{m/s}$\n$\\Delta t_5 = 0.9 \\times \\frac{5.0\\times 10^{-4}\\,\\mathrm{m}}{755\\,\\mathrm{m/s}} = \\frac{4.5 \\times 10^{-4}}{755}\\,\\mathrm{s} \\approx 5.960 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **单元 $i=6$**：\n$S_{max, 6} = |u_6| + c_6 = |40\\,\\mathrm{m/s}| + 850\\,\\mathrm{m/s} = 890\\,\\mathrm{m/s}$\n$\\Delta t_6 = 0.9 \\times \\frac{7.0\\times 10^{-4}\\,\\mathrm{m}}{890\\,\\mathrm{m/s}} = \\frac{6.3 \\times 10^{-4}}{890}\\,\\mathrm{s} \\approx 7.079 \\times 10^{-7}\\,\\mathrm{s}$\n\n**3. 全局时间步长的理由**\n\n问题指定使用“时间上一致的全局时间步长”，我们将其表示为 $\\Delta t_{global}$。这意味着在每次迭代中，计算域中的所有单元都以相同的时间增量 $\\Delta t_{global}$ 向前推进。\n\n为使整个模拟在数值上保持稳定，必须在域中的每一个单元内都满足 CFL 条件。这产生了一个不等式组，每个单元 $i$ 对应一个不等式：\n$$\\Delta t_{global} \\le \\Delta t_i \\quad \\text{对于所有 } i \\in \\{1, 2, 3, 4, 5, 6\\}$$\n为了同时满足所有这些条件，$\\Delta t_{global}$ 必须小于或等于所有局部最大允许时间步长中的最小值。如果选择的 $\\Delta t_{global}$ 大于 $\\Delta t_i$ 值的最小值，那么域中将至少有一个单元违反了局部的 CFL 条件。在那个“临界”单元（即 $\\Delta t_i$ 最小的单元）中，物理波信号将在单个时间步内传播到单元边界之外，但显式数值格式将无法计入其影响。这种对因果律的违反会导致非物理振荡的增长，从而迅速破坏整个域的解，引起数值不稳定性。\n\n因此，全局时间步长必须受限于局部稳定时间步长的最小值：\n$$\\Delta t_{global} \\le \\min_{i} \\{\\Delta t_i\\}$$\n为了在保证稳定性的同时最大化计算效率（通过采用尽可能大的时间步长），我们选择等号：\n$$\\Delta t_{global} = \\min_{i} \\{\\Delta t_i\\}$$\n\n**4. 全局统一时间步长的计算**\n\n我们必须找到在第2部分计算出的局部时间步长的最小值。\n$\\Delta t_{global} = \\min(\\Delta t_1, \\Delta t_2, \\Delta t_3, \\Delta t_4, \\Delta t_5, \\Delta t_6)$\n$\\Delta t_{global} = \\min(7.297, 5.035, 9.474, 8.889, 5.960, 7.079) \\times 10^{-7}\\,\\mathrm{s}$\n最小值为 $\\Delta t_2 \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$。\n\n现在我们精确计算此值并将其转换为所需单位。\n$$\\Delta t_{global} = \\Delta t_2 = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.03496503... \\times 10^{-7}\\,\\mathrm{s}$$\n问题要求答案以微秒（$\\mathrm{\\mu s}$）为单位。换算关系为 $1\\,\\mathrm{s} = 10^6\\,\\mathrm{\\mu s}$。\n$$\\Delta t_{global} = (5.03496503... \\times 10^{-7}) \\times 10^6\\,\\mathrm{\\mu s} = 0.503496503...\\,\\mathrm{\\mu s}$$\n四舍五入到三位有效数字，我们得到 $0.503\\,\\mathrm{\\mu s}$。",
            "answer": "$$\\boxed{0.503}$$"
        },
        {
            "introduction": "将一维概念推广到多维是计算科学中的关键一步。这个练习将探讨CFL条件在二维非均匀（各向异性）网格上的应用，这种情况在为了高效解析特定方向（如火焰锋面或边界层）的精细结构而拉伸网格时非常普遍。通过推导二维平流方程的稳定性约束，你将亲身体会到，即使在某个方向上的对流速度较小，该方向上极小的网格间距也可能成为限制整个模拟时间步长的决定性因素。",
            "id": "4045928",
            "problem": "考虑一个二维对流输运问题，其中守恒标量场 $Y(x,y,t)$ 代表预混火焰中的混合分数，其控制方程为线性平流方程 $\\frac{\\partial Y}{\\partial t} + a_{x}\\frac{\\partial Y}{\\partial x} + a_{y}\\frac{\\partial Y}{\\partial y} = 0$，其中 $a_{x}$ 和 $a_{y}$ 分别是沿 $x$ 和 $y$ 方向的恒定平流速度。该区域使用间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格进行离散化，其演化过程采用显式一阶守恒有限体积法 (FVM) 计算，每个面上使用迎风格式数值通量。显式格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件与离散依赖域必须包含双曲型方程的连续依赖域这一要求相关。\n\n从守恒律和离散迎风通量构造出发，推导将时间步长 $\\Delta t$ 与波速和网格间距联系起来的多维稳定性限制条件。在 $\\Delta x \\ll \\Delta y$ 的渐近情况下，利用你的推导解释为什么 $\\Delta t$ 的稳定性界限主要由最小间距决定，即使当 $a_{x} \\neq a_{y}$ 时也是如此。然后，对于一个具有各向异性网格和非各向同性平流的计算燃烧模拟，使用以下参数计算最大稳定时间步长：$a_{x} = 12\\,\\mathrm{m\\,s^{-1}}$，$a_{y} = 4\\,\\mathrm{m\\,s^{-1}}$，$\\Delta x = 5 \\times 10^{-5}\\,\\mathrm{m}$，$\\Delta y = 2 \\times 10^{-3}\\,\\mathrm{m}$，以及选定的库朗数 $C_{\\text{CFL}} = 0.8$。最终答案以秒为单位表示，并四舍五入至四位有效数字。",
            "solution": "本题要求推导采用一阶迎风有限体积法 (FVM) 离散的线性平流方程的多维稳定性条件，解释其在各向异性网格情况下的行为，并根据给定参数计算最大稳定时间步长。\n\n控制偏微分方程 (PDE) 是关于标量场 $Y(x,y,t)$ 的二维线性平流方程：\n$$\n\\frac{\\partial Y}{\\partial t} + a_{x}\\frac{\\partial Y}{\\partial x} + a_{y}\\frac{\\partial Y}{\\partial y} = 0\n$$\n其中 $a_{x}$ 和 $a_{y}$ 是恒定的平流速度。该方程可以写成守恒律形式：\n$$\n\\frac{\\partial Y}{\\partial t} + \\nabla \\cdot \\mathbf{F} = 0\n$$\n其中通量矢量为 $\\mathbf{F} = (a_x Y, a_y Y)$。\n\n我们考虑一个单元间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格。设一个控制体（单元）表示为 $\\Omega_{i,j} = [x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}]$，其面积为 $A = \\Delta x \\Delta y$。将守恒律在该单元上积分，得到：\n$$\n\\iint_{\\Omega_{i,j}} \\frac{\\partial Y}{\\partial t} \\,dx\\,dy + \\iint_{\\Omega_{i,j}} \\nabla \\cdot \\mathbf{F} \\,dx\\,dy = 0\n$$\n对第二项使用散度定理，我们得到：\n$$\n\\frac{d}{dt} \\iint_{\\Omega_{i,j}} Y \\,dx\\,dy + \\oint_{\\partial\\Omega_{i,j}} \\mathbf{F} \\cdot \\mathbf{n} \\,ds = 0\n$$\n令 $\\bar{Y}_{i,j}(t) = \\frac{1}{\\Delta x \\Delta y} \\iint_{\\Omega_{i,j}} Y(x,y,t) \\,dx\\,dy$ 为 $Y$ 的单元平均值。方程变为：\n$$\n\\Delta x \\Delta y \\frac{d\\bar{Y}_{i,j}}{dt} + \\int_{y_{j-1/2}}^{y_{j+1/2}} (a_x Y)_{i+1/2,y} \\,dy - \\int_{y_{j-1/2}}^{y_{j+1/2}} (a_x Y)_{i-1/2,y} \\,dy + \\int_{x_{i-1/2}}^{x_{i+1/2}} (a_y Y)_{x,j+1/2} \\,dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} (a_y Y)_{x,j-1/2} \\,dx = 0\n$$\n使用显式前向欧拉格式对时间进行离散，并对空间积分进行近似，我们得到有限体积更新方程：\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\left[ F_{x, i+1/2,j}^* - F_{x, i-1/2,j}^* \\right] - \\frac{\\Delta t}{\\Delta y} \\left[ F_{y, i,j+1/2}^* - F_{y, i,j-1/2}^* \\right]\n$$\n其中 $F^*$ 代表单元面上的数值通量。对于一阶迎风格式，数值通量由平流速度的符号决定。为简单起见，我们假设 $a_x > 0$ 和 $a_y > 0$。单元面上的 $Y$ 值取自迎风单元。\n数值通量为：\n$F_{x, i+1/2,j}^* = a_x \\bar{Y}_{i,j}^n$\n$F_{x, i-1/2,j}^* = a_x \\bar{Y}_{i-1,j}^n$\n$F_{y, i,j+1/2}^* = a_y \\bar{Y}_{i,j}^n$\n$F_{y, i,j-1/2}^* = a_y \\bar{Y}_{i,j-1}^n$\n\n将这些代入更新方程：\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( a_x \\bar{Y}_{i,j}^n - a_x \\bar{Y}_{i-1,j}^n \\right) - \\frac{\\Delta t}{\\Delta y} \\left( a_y \\bar{Y}_{i,j}^n - a_y \\bar{Y}_{i,j-1}^n \\right)\n$$\n我们定义方向库朗数 $C_x = \\frac{a_x \\Delta t}{\\Delta x}$ 和 $C_y = \\frac{a_y \\Delta t}{\\Delta y}$。方程变为：\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - C_x (\\bar{Y}_{i,j}^n - \\bar{Y}_{i-1,j}^n) - C_y (\\bar{Y}_{i,j}^n - \\bar{Y}_{i,j-1}^n)\n$$\n重排各项，将时间层 $n$ 上各单元值的系数组合在一起：\n$$\n\\bar{Y}_{i,j}^{n+1} = (1 - C_x - C_y) \\bar{Y}_{i,j}^{n} + C_x \\bar{Y}_{i-1,j}^n + C_y \\bar{Y}_{i,j-1}^n\n$$\n为使格式稳定（对于此特定格式，也为保证其单调性或保正性），右侧的所有系数必须为非负。由于 $a_x, a_y, \\Delta t, \\Delta x, \\Delta y$ 均为正数，所以 $C_x \\ge 0$ 和 $C_y \\ge 0$ 得到满足。剩下的条件是针对 $\\bar{Y}_{i,j}^{n}$ 的系数：\n$$\n1 - C_x - C_y \\ge 0 \\implies C_x + C_y \\le 1\n$$\n此推导假设了 $a_x > 0$ 和 $a_y > 0$。如果推广到 $a_x$ 和 $a_y$ 的任意符号，迎风格式会从相应的相邻单元取值，得到的稳定性条件将使用速度的绝对值：\n$$\n\\frac{|a_x| \\Delta t}{\\Delta x} + \\frac{|a_y| \\Delta t}{\\Delta y} \\le 1\n$$\n这就是一阶迎风格式的多维稳定性限制，通常称为 Courant–Friedrichs–Lewy (CFL) 条件。它将时间步长 $\\Delta t$ 与波速 $|a_x|, |a_y|$ 及网格间距 $\\Delta x, \\Delta y$ 联系起来。我们可以分离出 $\\Delta t$：\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y}}\n$$\n现在，我们来解释在 $\\Delta x \\ll \\Delta y$ 的渐近区域中的行为。$\\Delta t$ 的稳定性界限由分数的分母决定，该分母是两项之和：$\\frac{|a_x|}{\\Delta x}$ 和 $\\frac{|a_y|}{\\Delta y}$。当 $\\Delta x$ 远小于 $\\Delta y$ 时，项 $\\frac{1}{\\Delta x}$ 就远大于 $\\frac{1}{\\Delta y}$。假设 $|a_x|$ 和 $|a_y|$ 的量级相当（如本题所给），则 $\\frac{|a_x|}{\\Delta x}$ 项将显著大于 $\\frac{|a_y|}{\\Delta y}$ 项。因此，它们的和主要由第一项主导：\n$$\n\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y} \\approx \\frac{|a_x|}{\\Delta x}\n$$\n因此，时间步长的稳定性界限近似变为：\n$$\n\\Delta t \\lesssim \\frac{1}{\\frac{|a_x|}{\\Delta x}} = \\frac{\\Delta x}{|a_x|}\n$$\n这表明，在某个维度网格间距远小于其他维度的各向异性网格中，显式格式的稳定性主要受到该维度上库朗数条件的限制。其物理意义是，时间步长必须足够小，以防止信息在单个时间步内传播穿过最小的单元。波穿过小单元维度所需的时间 $\\Delta x / |a_x|$ 远小于穿过大单元维度所需的时间 $\\Delta y / |a_y|$，因此成为限制性因素。\n\n最后，我们计算给定参数下的最大稳定时间步长 $\\Delta t_{\\text{max}}$。在实际应用中，会使用一个安全因子，即库朗数 $C_{\\text{CFL}}$，此时稳定性条件写为：\n$$\n\\frac{|a_x| \\Delta t}{\\Delta x} + \\frac{|a_y| \\Delta t}{\\Delta y} \\le C_{\\text{CFL}}\n$$\n最大稳定时间步长对应于等式成立的情况：\n$$\n\\Delta t_{\\text{max}} = \\frac{C_{\\text{CFL}}}{\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y}}\n$$\n给定参数：$a_{x} = 12\\,\\mathrm{m\\,s^{-1}}$，$a_{y} = 4\\,\\mathrm{m\\,s^{-1}}$，$\\Delta x = 5 \\times 10^{-5}\\,\\mathrm{m}$，$\\Delta y = 2 \\times 10^{-3}\\,\\mathrm{m}$，以及 $C_{\\text{CFL}} = 0.8$。\n首先，计算分母中的两项：\n$$\n\\frac{|a_x|}{\\Delta x} = \\frac{12}{5 \\times 10^{-5}} = \\frac{12}{5} \\times 10^{5} = 2.4 \\times 10^{5} \\, \\text{s}^{-1}\n$$\n$$\n\\frac{|a_y|}{\\Delta y} = \\frac{4}{2 \\times 10^{-3}} = 2 \\times 10^{3} = 2000 \\, \\text{s}^{-1}\n$$\n正如预期的那样，$x$ 方向对应的项要大得多。现在，我们将它们相加：\n$$\n\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y} = 2.4 \\times 10^{5} + 2000 = 240000 + 2000 = 242000 \\, \\text{s}^{-1} = 2.42 \\times 10^{5} \\, \\text{s}^{-1}\n$$\n现在我们计算 $\\Delta t_{\\text{max}}$：\n$$\n\\Delta t_{\\text{max}} = \\frac{0.8}{2.42 \\times 10^{5}} \\, \\text{s} \\approx 0.3305785... \\times 10^{-5} \\, \\text{s} = 3.305785... \\times 10^{-6} \\, \\text{s}\n$$\n将答案四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{\\text{max}} \\approx 3.306 \\times 10^{-6} \\, \\text{s}\n$$",
            "answer": "$$\n\\boxed{3.306 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "燃烧模拟的复杂性不仅来自多维空间和非均匀网格，更源于多种物理过程的耦合。这个练习引入了除对流之外的另一个核心输运过程：分子扩散。你将使用冯·诺依曼稳定性分析这一强大的工具，来推导线性对流-扩散方程在使用中心差分格式时的稳定性条件。这个过程将揭示一个深刻的结论：数值稳定性不仅仅是一个简单的CFL数限制，而是对流、扩散以及离散格式三者之间相互作用的复杂结果，它为理解和处理刚性问题提供了重要洞见。",
            "id": "4045897",
            "problem": "在一维计算燃烧学中，考虑一个代表预混反应混合分数的被动标量的线性输运，该过程由对流-扩散方程 $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$ 控制，其中 $a$ 是恒定的对流速度，$\\nu$ 是恒定的分子扩散率。在间距为 $\\Delta x$ 的均匀网格上，半离散空间算子由二阶中心差分 $D_{x} u_{j} = \\dfrac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$ 和 $D_{xx} u_{j} = \\dfrac{u_{j+1} - 2 u_{j} + u_{j-1}}{\\Delta x^{2}}$ 定义。使用时间步长为 $\\Delta t$ 的前向欧拉时间离散，全离散更新方程为 $u^{n+1}_{j} = u^{n}_{j} + \\Delta t\\left(-a\\,D_{x} u^{n}_{j} + \\nu\\,D_{xx} u^{n}_{j}\\right)$。进行线性傅里叶模态稳定性分析，并推导关于时间步长 $\\Delta t$ 的组合 Courant–Friedrichs–Lewy (CFL) 条件，该条件保证了网格所支持的所有离散傅里叶波数的稳定性。将最终答案表示为关于 $a$、$\\nu$ 和 $\\Delta x$ 的 $\\Delta t$ 的单个闭式解析表达式。无需进行数值计算，也无需四舍五入。",
            "solution": "该问题要求推导应用于一维对流-扩散方程的数值格式的稳定性条件。将使用 von Neumann (或傅里叶模态) 方法进行分析。\n\n控制偏微分方程 (PDE) 是线性对流-扩散方程：\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx}\n$$\n其中 $u$ 是一个被动标量，$a$ 是恒定的对流速度，$\\nu$ 是恒定的分子扩散率。假设 $a$ 和 $\\nu$ 都是实常数，且 $\\nu \\ge 0$。\n\n该问题指定了时间导数使用前向欧拉格式，空间导数使用二阶中心差分。在网格点 $j$ 和时间步 $n$ 的全离散有限差分方程由下式给出：\n$$\nu^{n+1}_{j} = u^{n}_{j} + \\Delta t\\left(-a\\,D_{x} u^{n}_{j} + \\nu\\,D_{xx} u^{n}_{j}\\right)\n$$\n代入中心差分算子 $D_{x}$ 和 $D_{xx}$ 的定义：\n$$\nu^{n+1}_{j} = u^{n}_{j} + \\Delta t\\left(-a\\left(\\frac{u^{n}_{j+1} - u^{n}_{j-1}}{2\\,\\Delta x}\\right) + \\nu\\left(\\frac{u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1}}{\\Delta x^{2}}\\right)\\right)\n$$\n该方程可以重新排列为：\n$$\nu^{n+1}_{j} = u^{n}_{j} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1}\\right)\n$$\n\n对于 von Neumann 稳定性分析，我们考虑在时间层 $n$ 的解的单个傅里叶模态：\n$$\nu^{n}_{j} = \\hat{u}^{n}(k) e^{i k x_{j}}\n$$\n其中 $x_j = j\\,\\Delta x$ 是网格点 $j$ 的空间坐标，$k$ 是波数，$i$ 是虚数单位，$\\hat{u}^{n}(k)$ 是在时间 $n$ 的模态振幅。下一个时间步的解由下式给出：\n$$\nu^{n+1}_{j} = \\hat{u}^{n+1}(k) e^{i k x_{j}} = G(k) \\hat{u}^{n}(k) e^{i k x_{j}}\n$$\n其中 $G(k) = \\frac{\\hat{u}^{n+1}(k)}{\\hat{u}^{n}(k)}$ 是波数为 $k$ 的模态的放大因子。为使格式稳定，对于所有可能的波数，放大因子的模都不能超过 1，即 $|G(k)| \\le 1$。\n\n将傅里叶模态代入离散方程：\n$u^{n}_{j \\pm 1} = \\hat{u}^{n}(k) e^{i k (j \\pm 1)\\Delta x} = \\hat{u}^{n}(k) e^{i k j \\Delta x} e^{\\pm i k \\Delta x}$。\n将这些表达式代入全离散格式，并除以公因子 $\\hat{u}^{n}(k) e^{i k j \\Delta x}$，得到放大因子 $G$ 的表达式：\n$$\nG = 1 - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(e^{i k \\Delta x} - e^{-i k \\Delta x}\\right) + \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(e^{i k \\Delta x} - 2 + e^{-i k \\Delta x}\\right)\n$$\n令 $\\phi = k\\,\\Delta x$ 为无量纲波数或每网格单元的相角。使用欧拉恒等式 $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$ 和 $e^{i\\phi} + e^{-i\\phi} - 2 = 2\\cos(\\phi) - 2 = -2(1-\\cos(\\phi))$，我们可以简化 $G$ 的表达式：\n$$\nG = 1 - \\frac{a\\,\\Delta t}{2\\,\\Delta x}(2i\\sin\\phi) + \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}(-2(1-\\cos\\phi))\n$$\n我们定义对流库朗数 $C_a = \\frac{a\\,\\Delta t}{\\Delta x}$ 和扩散库朗数 (或扩散数) $d = \\frac{\\nu\\,\\Delta t}{\\Delta x^2}$。放大因子变为：\n$$\nG(\\phi) = 1 - i C_a \\sin(\\phi) - 2d(1-\\cos\\phi)\n$$\n$G(\\phi)$ 是一个复数，可以写成 $G(\\phi) = \\text{Re}(G) + i\\,\\text{Im}(G)$，其中：\n$$\n\\text{Re}(G) = 1 - 2d(1-\\cos\\phi)\n$$\n$$\n\\text{Im}(G) = -C_a \\sin(\\phi)\n$$\n稳定性条件是对于所有 $\\phi \\in [-\\pi, \\pi]$，$|G(\\phi)|^2 \\le 1$。\n$$\n|G(\\phi)|^2 = \\left(1 - 2d(1-\\cos\\phi)\\right)^2 + \\left(-C_a \\sin(\\phi)\\right)^2 \\le 1\n$$\n展开各项：\n$$\n1 - 4d(1-\\cos\\phi) + 4d^2(1-\\cos\\phi)^2 + C_a^2 \\sin^2(\\phi) \\le 1\n$$\n两边减去 $1$ 并使用 $\\sin^2(\\phi) = 1-\\cos^2(\\phi) = (1-\\cos\\phi)(1+\\cos\\phi)$：\n$$\n-4d(1-\\cos\\phi) + 4d^2(1-\\cos\\phi)^2 + C_a^2 (1-\\cos\\phi)(1+\\cos\\phi) \\le 0\n$$\n我们可以提出非负项 $(1-\\cos\\phi)$。如果 $\\phi=0$，那么 $1-\\cos\\phi=0$，不等式变为 $0 \\le 0$，这是满足的（对应于 $G(0)=1$）。对于 $\\phi \\ne 0$，我们可以除以 $(1-\\cos\\phi)$：\n$$\n-4d + 4d^2(1-\\cos\\phi) + C_a^2 (1+\\cos\\phi) \\le 0\n$$\n这个不等式必须对网格支持的所有波数都成立，即对所有 $\\phi \\in [-\\pi, \\pi]$ 成立。令 $\\xi = \\cos(\\phi)$，其范围为 $-1$ 到 $1$。该不等式变为关于 $\\xi$ 的线性函数：\n$$\nf(\\xi) = -4d + 4d^2(1-\\xi) + C_a^2 (1+\\xi) \\le 0 \\quad \\forall \\xi \\in [-1, 1]\n$$\n由于 $f(\\xi)$ 是关于 $\\xi$ 的线性函数，其在区间 $[-1, 1]$ 上的最大值必然出现在端点 $\\xi=-1$ 或 $\\xi=1$ 处。我们必须在两个端点都强制该条件成立。\n\n情况 1：$\\xi = 1$（长波极限，$\\phi \\to 0$）\n$$\nf(1) = -4d + 4d^2(1-1) + C_a^2 (1+1) = -4d + 2C_a^2 \\le 0\n$$\n$$\n2C_a^2 \\le 4d \\implies C_a^2 \\le 2d\n$$\n代入 $C_a$ 和 $d$ 的定义：\n$$\n\\left(\\frac{a\\,\\Delta t}{\\Delta x}\\right)^2 \\le 2\\left(\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\right) \\implies \\frac{a^2\\,\\Delta t^2}{\\Delta x^2} \\le \\frac{2\\nu\\,\\Delta t}{\\Delta x^2}\n$$\n假设 $\\Delta t > 0$，我们可以除以 $\\Delta t$ 并乘以 $\\Delta x^2$：\n$$\na^2\\,\\Delta t \\le 2\\nu \\implies \\Delta t \\le \\frac{2\\nu}{a^2}\n$$\n这是由中心差分对流和物理扩散之间的相互作用产生的稳定性约束。它通常用单元佩克莱数 $Pe_{\\Delta x} = \\frac{|a|\\Delta x}{\\nu}$ 表示为 $\\frac{|a|\\Delta t}{\\Delta x} \\le \\frac{2}{|Pe_{\\Delta x}|}$。\n\n情况 2：$\\xi = -1$（短波极限，$\\phi = \\pi$）\n$$\nf(-1) = -4d + 4d^2(1-(-1)) + C_a^2 (1-1) = -4d + 8d^2 \\le 0\n$$\n$$\n4d(2d - 1) \\le 0\n$$\n由于 $d = \\frac{\\nu\\,\\Delta t}{\\Delta x^2} \\ge 0$（因为 $\\nu, \\Delta t, \\Delta x^2$ 都是非负的），这个不等式要求 $2d-1 \\le 0$：\n$$\n2d \\le 1 \\implies d \\le \\frac{1}{2}\n$$\n代入 $d$ 的定义：\n$$\n\\frac{\\nu\\,\\Delta t}{\\Delta x^2} \\le \\frac{1}{2} \\implies \\Delta t \\le \\frac{\\Delta x^2}{2\\nu}\n$$\n这是一维扩散方程显式 (FTCS) 离散化的标准稳定性限制。\n\n为确保对所有波数都稳定，两个条件必须同时满足。因此，时间步长 $\\Delta t$ 的选择必须满足：\n$$\n\\Delta t \\le \\frac{2\\nu}{a^2} \\quad \\text{和} \\quad \\Delta t \\le \\frac{\\Delta x^2}{2\\nu}\n$$\n这等效于要求 $\\Delta t$ 小于或等于两个上限中的最小值：\n$$\n\\Delta t \\le \\min\\left(\\frac{\\Delta x^2}{2\\nu}, \\frac{2\\nu}{a^2}\\right)\n$$\n问题要求给出一个关于 $\\Delta t$ 的单个闭式解析表达式。这被解释为最大允许时间步长 $\\Delta t_{\\text{max}}$，即不等式的右侧。\n因此，稳定性限制的最终表达式是扩散时间尺度限制和对流-扩散相互作用限制的最小值。",
            "answer": "$$\n\\boxed{\\min\\left(\\frac{\\Delta x^{2}}{2\\,\\nu}, \\frac{2\\,\\nu}{a^{2}}\\right)}\n$$"
        }
    ]
}