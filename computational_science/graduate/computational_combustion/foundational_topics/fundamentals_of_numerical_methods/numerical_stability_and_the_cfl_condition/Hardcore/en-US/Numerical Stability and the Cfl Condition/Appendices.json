{
    "hands_on_practices": [
        {
            "introduction": "The stability of any explicit numerical scheme for hyperbolic equations, like those governing fluid dynamics, is fundamentally tied to the Courant-Friedrichs-Lewy (CFL) condition. This exercise  grounds this principle in a practical scenario involving a non-uniform mesh, where flow properties vary from cell to cell. By calculating the local stability limit in each cell, you will develop a first-principles understanding of why a single, global time step must be constrained by the most restrictive region in the entire computational domain.",
            "id": "4045894",
            "problem": "Consider a one-dimensional, compressible, reactive flow representative of premixed combustion in a stratified temperature field, modeled by the conservative Euler equations for mass, momentum, and energy with species transport, written in integral form over a finite volume cell. An explicit finite-volume update of the advective–acoustic subsystem, ignoring chemical source terms via operator splitting, evolves the conservative state variables under the hyperbolic convective fluxes. The local characteristic wave speeds of the linearized hyperbolic subsystem are the eigenvalues of the flux Jacobian, and the maximum wave speed governs the time step restriction for stability in an explicit method.\n\nA uniform-in-time global time step is used over a spatially nonuniform mesh with cell widths $\\Delta x_{i}$ and spatially varying flow speed $u_{i}$ and speed of sound $c_{i}$ due to thermal gradients and composition changes. The mesh and state are:\n- Cell $i=1$: $\\Delta x_{1}=6.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{1}=-20\\,\\mathrm{m\\,s^{-1}}$, $c_{1}=720\\,\\mathrm{m\\,s^{-1}}$.\n- Cell $i=2$: $\\Delta x_{2}=4.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{2}=35\\,\\mathrm{m\\,s^{-1}}$, $c_{2}=680\\,\\mathrm{m\\,s^{-1}}$.\n- Cell $i=3$: $\\Delta x_{3}=1.0\\times 10^{-3}\\,\\mathrm{m}$, $u_{3}=50\\,\\mathrm{m\\,s^{-1}}$, $c_{3}=900\\,\\mathrm{m\\,s^{-1}}$.\n- Cell $i=4$: $\\Delta x_{4}=8.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{4}=10\\,\\mathrm{m\\,s^{-1}}$, $c_{4}=800\\,\\mathrm{m\\,s^{-1}}$.\n- Cell $i=5$: $\\Delta x_{5}=5.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{5}=-5\\,\\mathrm{m\\,s^{-1}}$, $c_{5}=750\\,\\mathrm{m\\,s^{-1}}$.\n- Cell $i=6$: $\\Delta x_{6}=7.0\\times 10^{-4}\\,\\mathrm{m}$, $u_{6}=40\\,\\mathrm{m\\,s^{-1}}$, $c_{6}=850\\,\\mathrm{m\\,s^{-1}}$.\n\nUsing a Courant–Friedrichs–Lewy (CFL) number of $0.9$, perform the following:\n1. From first principles of hyperbolic conservation laws and explicit finite-volume stability, derive the local time step restriction in cell $i$ as a function of $\\Delta x_{i}$ and the maximum magnitude of the local characteristic speed. Identify that maximum speed in terms of $u_{i}$ and $c_{i}$ for the advective–acoustic Euler subsystem.\n2. Compute the local stable time step $\\Delta t_{i}$ in each cell for the data above.\n3. Explain, based on the domain-of-dependence argument and linear stability of explicit schemes, why a global uniform time step must satisfy the most restrictive local condition and thus be the minimum over $i$ of the local time steps.\n4. Provide the global uniform time step as a single numerical value equal to $\\min_{i}\\Delta t_{i}$. Round your final answer to three significant figures and express the final time step in $\\mathrm{\\mu s}$ (microseconds).",
            "solution": "The problem is found to be valid as it is scientifically grounded in the principles of computational fluid dynamics, specifically the stability of numerical methods for hyperbolic conservation laws. It is well-posed, objective, and contains all necessary information for a unique solution. We proceed with the solution, addressing the four required tasks sequentially.\n\n**1. Derivation of the Local Time Step Restriction**\n\nThe stability of explicit time-marching schemes for hyperbolic partial differential equations is governed by the Courant–Friedrichs–Lewy (CFL) condition. This condition arises from a consideration of the domains of dependence. The physical domain of dependence of a point $(x, t_0+\\Delta t)$ is the set of points at time $t_0$ that can influence the solution at $(x, t_0+\\Delta t)$. For a hyperbolic system, information propagates at finite characteristic wave speeds. The fastest such speed, $S_{max}$, determines the boundary of this domain.\n\nIn a finite-volume method, the updated value in a cell $i$ at time $n+1$, denoted $U_i^{n+1}$, is computed using the values in cell $i$ and its immediate neighbors at time $n$. The numerical domain of dependence for the average value in cell $i$ over one time step $\\Delta t$ is therefore the spatial region covered by these neighboring cells. For the scheme to be stable, the physical domain of dependence of cell $i$ must be a subset of its numerical domain of dependence.\n\nConsider a single cell $i$ with width $\\Delta x_i$. The fastest-moving physical information wave within this cell has a speed of $S_{max, i}$. In a time interval $\\Delta t$, this wave travels a distance of $S_{max, i} \\Delta t$. For a simple explicit scheme that uses only adjacent cells, the numerical scheme can only access information within a distance of approximately $\\Delta x_i$. To ensure that no physical signal travels farther than the numerical scheme can \"see,\" we must require that the distance traveled by the fastest wave is less than or equal to the cell width:\n$$S_{max, i} \\Delta t \\le \\Delta x_i$$\nThis implies a restriction on the time step:\n$$\\Delta t \\le \\frac{\\Delta x_i}{S_{max, i}}$$\nThis inequality is the core of the CFL condition. It is standard practice to introduce a safety factor, the CFL number $C$, where for stability $C \\le 1$ for a simple first-order scheme. The local maximum allowable time step $\\Delta t_i$ is then given by:\n$$\\Delta t_i = C \\frac{\\Delta x_i}{S_{max, i}}$$\nNext, we must identify the maximum characteristic speed, $S_{max, i}$, for the one-dimensional Euler equations. The eigenvalues of the flux Jacobian matrix for the Euler equations correspond to the characteristic wave speeds. In one spatial dimension, these eigenvalues are $\\lambda_1 = u$, $\\lambda_2 = u+c$, and $\\lambda_3 = u-c$, where $u$ is the local fluid velocity and $c$ is the local speed of sound. These correspond to an entropy/contact wave moving at speed $u$ and two acoustic waves moving at speeds $u+c$ and $u-c$ relative to a stationary frame.\n\nThe speed of signal propagation is the magnitude of these velocities. Therefore, the maximum local characteristic speed, $S_{max, i}$, is the maximum of the absolute values of these eigenvalues in cell $i$:\n$$S_{max, i} = \\max(|u_i|, |u_i+c_i|, |u_i-c_i|)$$\nSince the speed of sound $c_i$ is always positive, we can simplify this expression. The term $|u_i|+c_i$ is always greater than or equal to both $|u_i+c_i|$ (by the triangle inequality) and $|u_i-c_i| = |c_i-u_i|$. Also, since $c_i > 0$, $|u_i|+c_i > |u_i|$. Thus, the maximum is always given by the sum of the absolute fluid velocity and the speed of sound:\n$$S_{max, i} = |u_i| + c_i$$\nSubstituting this into the time step formula, we obtain the local time step restriction for each cell $i$:\n$$\\Delta t_i = C \\frac{\\Delta x_i}{|u_i| + c_i}$$\n\n**2. Computation of Local Stable Time Steps**\n\nUsing the derived formula with the given CFL number $C=0.9$ and the data for each cell:\n\n- **Cell $i=1$**:\n$S_{max, 1} = |u_1| + c_1 = |-20\\,\\mathrm{m\\,s^{-1}}| + 720\\,\\mathrm{m\\,s^{-1}} = 740\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta t_1 = 0.9 \\times \\frac{6.0\\times 10^{-4}\\,\\mathrm{m}}{740\\,\\mathrm{m\\,s^{-1}}} = \\frac{5.4 \\times 10^{-4}}{740}\\,\\mathrm{s} \\approx 7.297 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=2$**:\n$S_{max, 2} = |u_2| + c_2 = |35\\,\\mathrm{m\\,s^{-1}}| + 680\\,\\mathrm{m\\,s^{-1}} = 715\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta t_2 = 0.9 \\times \\frac{4.0\\times 10^{-4}\\,\\mathrm{m}}{715\\,\\mathrm{m\\,s^{-1}}} = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=3$**:\n$S_{max, 3} = |u_3| + c_3 = |50\\,\\mathrm{m\\,s^{-1}}| + 900\\,\\mathrm{m\\,s^{-1}} = 950\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta t_3 = 0.9 \\times \\frac{1.0\\times 10^{-3}\\,\\mathrm{m}}{950\\,\\mathrm{m\\,s^{-1}}} = \\frac{9.0 \\times 10^{-4}}{950}\\,\\mathrm{s} \\approx 9.474 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=4$**:\n$S_{max, 4} = |u_4| + c_4 = |10\\,\\mathrm{m\\,s^{-1}}| + 800\\,\\mathrm{m\\,s^{-1}} = 810\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta t_4 = 0.9 \\times \\frac{8.0\\times 10^{-4}\\,\\mathrm{m}}{810\\,\\mathrm{m\\,s^{-1}}} = \\frac{7.2 \\times 10^{-4}}{810}\\,\\mathrm{s} \\approx 8.889 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=5$**:\n$S_{max, 5} = |u_5| + c_5 = |-5\\,\\mathrm{m\\,s^{-1}}| + 750\\,\\mathrm{m\\,s^{-1}} = 755\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta t_5 = 0.9 \\times \\frac{5.0\\times 10^{-4}\\,\\mathrm{m}}{755\\,\\mathrm{m\\,s^{-1}}} = \\frac{4.5 \\times 10^{-4}}{755}\\,\\mathrm{s} \\approx 5.960 \\times 10^{-7}\\,\\mathrm{s}$\n\n- **Cell $i=6$**:\n$S_{max, 6} = |u_6| + c_6 = |40\\,\\mathrm{m\\,s^{-1}}| + 850\\,\\mathrm{m\\,s^{-1}} = 890\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta t_6 = 0.9 \\times \\frac{7.0\\times 10^{-4}\\,\\mathrm{m}}{890\\,\\mathrm{m\\,s^{-1}}} = \\frac{6.3 \\times 10^{-4}}{890}\\,\\mathrm{s} \\approx 7.079 \\times 10^{-7}\\,\\mathrm{s}$\n\n**3. Justification for the Global Time Step**\n\nThe problem specifies the use of a \"uniform-in-time global time step,\" which we will denote as $\\Delta t_{global}$. This means that all cells in the computational domain are advanced forward in time by the same amount, $\\Delta t_{global}$, in each iteration.\n\nFor the entire simulation to be numerically stable, the CFL condition must be satisfied in every single cell of the domain. This yields a system of inequalities, one for each cell $i$:\n$$\\Delta t_{global} \\le \\Delta t_i \\quad \\text{for all } i \\in \\{1, 2, 3, 4, 5, 6\\}$$\nTo satisfy all these conditions simultaneously, $\\Delta t_{global}$ must be less than or equal to the smallest of all the local maximum allowable time steps. If $\\Delta t_{global}$ were chosen to be larger than the minimum of the $\\Delta t_i$ values, there would be at least one cell in the domain for which the local CFL condition is violated. In that \"critical\" cell (the one with the smallest $\\Delta t_i$), a physical wave signal would propagate beyond the cell's boundary within a single time step, but the explicit numerical scheme would fail to account for its influence. This violation of causality leads to the growth of non-physical oscillations, causing a numerical instability that quickly corrupts the solution across the entire domain.\n\nTherefore, the global time step must be bounded by the minimum of the local stable time steps:\n$$\\Delta t_{global} \\le \\min_{i} \\{\\Delta t_i\\}$$\nTo ensure stability while also maximizing computational efficiency (by taking the largest possible time step), one selects the equality:\n$$\\Delta t_{global} = \\min_{i} \\{\\Delta t_i\\}$$\n\n**4. Calculation of the Global Uniform Time Step**\n\nWe must find the minimum of the local time steps computed in part 2.\n$\\Delta t_{global} = \\min(\\Delta t_1, \\Delta t_2, \\Delta t_3, \\Delta t_4, \\Delta t_5, \\Delta t_6)$\n$\\Delta t_{global} = \\min(7.297, 5.035, 9.474, 8.889, 5.960, 7.079) \\times 10^{-7}\\,\\mathrm{s}$\nThe minimum value is $\\Delta t_2 \\approx 5.035 \\times 10^{-7}\\,\\mathrm{s}$.\n\nWe now compute this value precisely and convert it to the required units.\n$$\\Delta t_{global} = \\Delta t_2 = \\frac{3.6 \\times 10^{-4}}{715}\\,\\mathrm{s} \\approx 5.03496503... \\times 10^{-7}\\,\\mathrm{s}$$\nThe problem asks for the answer in microseconds ($\\mathrm{\\mu s}$). The conversion is $1\\,\\mathrm{s} = 10^6\\,\\mathrm{\\mu s}$.\n$$\\Delta t_{global} = (5.03496503... \\times 10^{-7}) \\times 10^6\\,\\mathrm{\\mu s} = 0.503496503...\\,\\mathrm{\\mu s}$$\nRounding to three significant figures, we get $0.503\\,\\mathrm{\\mu s}$.",
            "answer": "$$\\boxed{0.503}$$"
        },
        {
            "introduction": "Moving from one to multiple dimensions adds another layer of complexity to stability analysis, especially on anisotropic meshes where cell dimensions can differ by orders of magnitude. This practice  explores how the CFL condition is formulated for a two-dimensional problem and reveals why the smallest grid spacing often dominates the time-step constraint. Understanding this behavior is critical for designing efficient meshes for problems with sharp gradients in one direction, such as boundary layers or thin flame fronts.",
            "id": "4045928",
            "problem": "Consider a two-dimensional convective transport of a conserved scalar field $Y(x,y,t)$ representative of a mixture fraction in a premixed flame, governed by the linear advection equation $ \\frac{\\partial Y}{\\partial t} + a_{x}\\frac{\\partial Y}{\\partial x} + a_{y}\\frac{\\partial Y}{\\partial y} = 0$, where $a_{x}$ and $a_{y}$ are constant advection speeds along the $x$- and $y$-directions. The domain is discretized using a uniform Cartesian mesh with spacings $\\Delta x$ and $\\Delta y$, and the evolution is computed using an explicit first-order conservative finite volume method (FVM) with an upwind numerical flux for each face. The Courant–Friedrichs–Lewy (CFL) condition for stability in explicit schemes is tied to the requirement that the discrete domain of dependence includes the continuous domain of dependence of the hyperbolic equation. \n\nStarting from the conservation law and the discrete upwind flux construction, derive the multi-dimensional stability restriction that links the time step $\\Delta t$ to the wave speeds and the mesh spacings. Use your derivation to explain, in the asymptotic regime $\\Delta x \\ll \\Delta y$, why the stability bound on $\\Delta t$ is constrained primarily by the smallest spacing, even when $a_{x} \\neq a_{y}$. Then, for a computational combustion simulation with anisotropic mesh and non-isotropic advection, compute the largest stable time step using the following parameters: $a_{x} = 12\\,\\mathrm{m\\,s^{-1}}$, $a_{y} = 4\\,\\mathrm{m\\,s^{-1}}$, $\\Delta x = 5 \\times 10^{-5}\\,\\mathrm{m}$, $\\Delta y = 2 \\times 10^{-3}\\,\\mathrm{m}$, and a chosen Courant number $C_{\\text{CFL}} = 0.8$. Express your final answer in seconds and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation of the multi-dimensional stability condition for a linear advection equation discretized with a first-order upwind finite volume method (FVM), an explanation of the behavior in an anisotropic mesh regime, and a calculation of the maximum stable time step for a given set of parameters.\n\nThe governing partial differential equation (PDE) is the two-dimensional linear advection equation for a scalar field $Y(x,y,t)$:\n$$\n\\frac{\\partial Y}{\\partial t} + a_{x}\\frac{\\partial Y}{\\partial x} + a_{y}\\frac{\\partial Y}{\\partial y} = 0\n$$\nwhere $a_{x}$ and $a_{y}$ are constant advection speeds. This equation can be written in conservation law form as:\n$$\n\\frac{\\partial Y}{\\partial t} + \\nabla \\cdot \\mathbf{F} = 0\n$$\nwhere the flux vector is $\\mathbf{F} = (a_x Y, a_y Y)$.\n\nWe consider a uniform Cartesian grid with cell spacings $\\Delta x$ and $\\Delta y$. Let a control volume (cell) be denoted by $\\Omega_{i,j} = [x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}]$, with area $A = \\Delta x \\Delta y$. Integrating the conservation law over this cell gives:\n$$\n\\iint_{\\Omega_{i,j}} \\frac{\\partial Y}{\\partial t} \\,dx\\,dy + \\iint_{\\Omega_{i,j}} \\nabla \\cdot \\mathbf{F} \\,dx\\,dy = 0\n$$\nUsing the divergence theorem on the second term, we get:\n$$\n\\frac{d}{dt} \\iint_{\\Omega_{i,j}} Y \\,dx\\,dy + \\oint_{\\partial\\Omega_{i,j}} \\mathbf{F} \\cdot \\mathbf{n} \\,ds = 0\n$$\nLet $\\bar{Y}_{i,j}(t) = \\frac{1}{\\Delta x \\Delta y} \\iint_{\\Omega_{i,j}} Y(x,y,t) \\,dx\\,dy$ be the cell-averaged value of $Y$. The equation becomes:\n$$\n\\Delta x \\Delta y \\frac{d\\bar{Y}_{i,j}}{dt} + \\int_{y_{j-1/2}}^{y_{j+1/2}} (a_x Y)_{i+1/2,y} \\,dy - \\int_{y_{j-1/2}}^{y_{j+1/2}} (a_x Y)_{i-1/2,y} \\,dy + \\int_{x_{i-1/2}}^{x_{i+1/2}} (a_y Y)_{x,j+1/2} \\,dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} (a_y Y)_{x,j-1/2} \\,dx = 0\n$$\nDiscretizing in time using an explicit forward Euler scheme and approximating the spatial integrals, we get the finite volume update equation:\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\left[ F_{x, i+1/2,j}^* - F_{x, i-1/2,j}^* \\right] - \\frac{\\Delta t}{\\Delta y} \\left[ F_{y, i,j+1/2}^* - F_{y, i,j-1/2}^* \\right]\n$$\nwhere $F^*$ represents the numerical flux at the cell faces. For the first-order upwind scheme, the numerical flux is determined by the sign of the advection velocity. For simplicity, let's assume $a_x > 0$ and $a_y > 0$. The value of $Y$ at the face is taken from the upwind cell.\nThe numerical fluxes are:\n$F_{x, i+1/2,j}^* = a_x \\bar{Y}_{i,j}^n$\n$F_{x, i-1/2,j}^* = a_x \\bar{Y}_{i-1,j}^n$\n$F_{y, i,j+1/2}^* = a_y \\bar{Y}_{i,j}^n$\n$F_{y, i,j-1/2}^* = a_y \\bar{Y}_{i,j-1}^n$\n\nSubstituting these into the update equation:\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( a_x \\bar{Y}_{i,j}^n - a_x \\bar{Y}_{i-1,j}^n \\right) - \\frac{\\Delta t}{\\Delta y} \\left( a_y \\bar{Y}_{i,j}^n - a_y \\bar{Y}_{i,j-1}^n \\right)\n$$\nLet's define the directional Courant numbers $C_x = \\frac{a_x \\Delta t}{\\Delta x}$ and $C_y = \\frac{a_y \\Delta t}{\\Delta y}$. The equation becomes:\n$$\n\\bar{Y}_{i,j}^{n+1} = \\bar{Y}_{i,j}^{n} - C_x (\\bar{Y}_{i,j}^n - \\bar{Y}_{i-1,j}^n) - C_y (\\bar{Y}_{i,j}^n - \\bar{Y}_{i,j-1}^n)\n$$\nRearranging the terms to group coefficients of the cell values at time level $n$:\n$$\n\\bar{Y}_{i,j}^{n+1} = (1 - C_x - C_y) \\bar{Y}_{i,j}^{n} + C_x \\bar{Y}_{i-1,j}^n + C_y \\bar{Y}_{i,j-1}^n\n$$\nFor the scheme to be stable (and for this specific scheme, to be monotone or positivity-preserving), all coefficients on the right-hand side must be non-negative. Since $a_x, a_y, \\Delta t, \\Delta x, \\Delta y$ are all positive, $C_x \\ge 0$ and $C_y \\ge 0$ are satisfied. The remaining condition is for the coefficient of $\\bar{Y}_{i,j}^{n}$:\n$$\n1 - C_x - C_y \\ge 0 \\implies C_x + C_y \\le 1\n$$\nThis derivation assumes $a_x > 0$ and $a_y > 0$. If we generalize to arbitrary signs of $a_x$ and $a_y$, the upwind scheme takes values from the appropriate neighboring cells, and the resulting stability condition uses the absolute values of the velocities:\n$$\n\\frac{|a_x| \\Delta t}{\\Delta x} + \\frac{|a_y| \\Delta t}{\\Delta y} \\le 1\n$$\nThis is the multi-dimensional stability restriction for the first-order upwind scheme, often called the Courant–Friedrichs–Lewy (CFL) condition. It links the time step $\\Delta t$ to the wave speeds $|a_x|, |a_y|$ and the mesh spacings $\\Delta x, \\Delta y$. We can isolate $\\Delta t$:\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y}}\n$$\nNow, we explain the behavior in the asymptotic regime $\\Delta x \\ll \\Delta y$. The stability bound on $\\Delta t$ is determined by the denominator of the fraction, which is the sum of two terms: $\\frac{|a_x|}{\\Delta x}$ and $\\frac{|a_y|}{\\Delta y}$. When $\\Delta x$ is much smaller than $\\Delta y$, the term $\\frac{1}{\\Delta x}$ is much larger than $\\frac{1}{\\Delta y}$. Assuming $|a_x|$ and $|a_y|$ are of comparable magnitude (as in the given problem), the term $\\frac{|a_x|}{\\Delta x}$ will be significantly larger than $\\frac{|a_y|}{\\Delta y}$. Consequently, the sum is dominated by the first term:\n$$\n\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y} \\approx \\frac{|a_x|}{\\Delta x}\n$$\nThe stability bound on the time step thus becomes approximately:\n$$\n\\Delta t \\lesssim \\frac{1}{\\frac{|a_x|}{\\Delta x}} = \\frac{\\Delta x}{|a_x|}\n$$\nThis demonstrates that in an anisotropic mesh with one dimension having a much smaller spacing, the stability of the explicit scheme is primarily constrained by the Courant number condition in that dimension. The physical interpretation is that the time step must be small enough to prevent information from propagating across the smallest cell in a single step. The time required for a wave to cross the small cell dimension, $\\Delta x / |a_x|$, is much less than the time to cross the larger dimension, $\\Delta y / |a_y|$, making it the limiting factor.\n\nFinally, we compute the largest stable time step, $\\Delta t_{\\text{max}}$, for the given parameters. In practical applications, a safety factor, the Courant number $C_{\\text{CFL}}$, is used, such that the stability condition is written as:\n$$\n\\frac{|a_x| \\Delta t}{\\Delta x} + \\frac{|a_y| \\Delta t}{\\Delta y} \\le C_{\\text{CFL}}\n$$\nThe largest stable time step corresponds to the equality:\n$$\n\\Delta t_{\\text{max}} = \\frac{C_{\\text{CFL}}}{\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y}}\n$$\nGiven parameters: $a_{x} = 12\\,\\mathrm{m\\,s^{-1}}$, $a_{y} = 4\\,\\mathrm{m\\,s^{-1}}$, $\\Delta x = 5 \\times 10^{-5}\\,\\mathrm{m}$, $\\Delta y = 2 \\times 10^{-3}\\,\\mathrm{m}$, and $C_{\\text{CFL}} = 0.8$.\nFirst, calculate the two terms in the denominator:\n$$\n\\frac{|a_x|}{\\Delta x} = \\frac{12}{5 \\times 10^{-5}} = \\frac{12}{5} \\times 10^{5} = 2.4 \\times 10^{5} \\, \\mathrm{s}^{-1}\n$$\n$$\n\\frac{|a_y|}{\\Delta y} = \\frac{4}{2 \\times 10^{-3}} = 2 \\times 10^{3} = 2000 \\, \\mathrm{s}^{-1}\n$$\nAs expected, the term corresponding to the $x$-direction is much larger. Now, we sum them:\n$$\n\\frac{|a_x|}{\\Delta x} + \\frac{|a_y|}{\\Delta y} = 2.4 \\times 10^{5} + 2000 = 240000 + 2000 = 242000 \\, \\mathrm{s}^{-1} = 2.42 \\times 10^{5} \\, \\mathrm{s}^{-1}\n$$\nNow we compute $\\Delta t_{\\text{max}}$:\n$$\n\\Delta t_{\\text{max}} = \\frac{0.8}{2.42 \\times 10^{5}} \\, \\mathrm{s} \\approx 0.3305785... \\times 10^{-5} \\, \\mathrm{s} = 3.305785... \\times 10^{-6} \\, \\mathrm{s}\n$$\nRounding the answer to four significant figures, we get:\n$$\n\\Delta t_{\\text{max}} \\approx 3.306 \\times 10^{-6} \\, \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{3.306 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "The previous exercises demonstrated that a global time step is limited by the smallest, fastest cells, which can be computationally inefficient. This problem  introduces a powerful technique to overcome this bottleneck: Adaptive Mesh Refinement (AMR) with subcycling. You will derive and apply a time-stepping schedule for a multi-level grid, illustrating how fine-grid regions can be advanced with smaller time steps, while coarse-grid regions take larger steps, dramatically improving overall simulation efficiency.",
            "id": "4045869",
            "problem": "A one-dimensional reacting flow is computed using Adaptive Mesh Refinement (AMR) with two levels, labeled $\\ell=0$ (coarse) and $\\ell=1$ (fine), to advect a passive scalar representative of mixture fraction through a premixed region. The hyperbolic transport is governed by the linear advection equation $u_t + a u_x = 0$ for a scalar field $u(x,t)$, where $a$ is a bounded characteristic speed representing the maximal convective signal speed in the flow. The hyperbolic operator is discretized by a conservative finite-volume first-order upwind flux with forward Euler time integration on each level. The AMR is configured with a refinement ratio $r=4$, so that $\\Delta x_1 = \\Delta x_0/r$, where $\\Delta x_\\ell$ denotes the spatial step on level $\\ell$. The explicit time integration uses subcycling so that the fine level takes $r$ substeps per coarse step.\n\nStarting from the linear advection equation and the discrete first-order upwind scheme, derive the stability restriction on the time step imposed by the Courant–Friedrichs–Lewy (CFL) condition for this scheme. Then, using the largest stable time step consistent with that restriction, compute a stable schedule of the time steps $(\\Delta t_0, \\Delta t_1)$ for the two AMR levels given the maximal signal speed $a_{\\max} = 15\\,\\mathrm{m\\,s^{-1}}$ and the coarse spatial step $\\Delta x_0 = 2\\times 10^{-3}\\,\\mathrm{m}$ with refinement ratio $r=4$. Round each time step to four significant figures. Report the pair $(\\Delta t_0, \\Delta t_1)$ in seconds.",
            "solution": "The appropriate starting point is the one-dimensional linear advection equation $u_t + a u_x = 0$, which models the transport of a scalar quantity in a flow with characteristic speed $a$. A widely used explicit finite-volume scheme for this hyperbolic equation is the first-order upwind method with forward Euler time integration. On a uniform grid with spacing $\\Delta x$, the semi-discrete update for cell averages $u_i^n$ at time level $n$ can be written, for $a>0$, as\n$$\nu_i^{n+1} = u_i^n - C\\left(u_i^n - u_{i-1}^n\\right),\n$$\nwhere the Courant number $C$ is defined by\n$$\nC \\equiv \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\nTo determine the stability restriction, we perform a von Neumann (Fourier) stability analysis. Assume a Fourier mode $u_i^n = \\hat{u}^n \\exp\\!\\left(i k x_i\\right)$, with $x_i = i\\,\\Delta x$. The amplification factor $G$ linking $\\hat{u}^{n+1}$ to $\\hat{u}^{n}$ is obtained by substituting the Fourier ansatz into the discrete update:\n$$\nG = 1 - C\\left(1 - \\exp\\!\\left(-i k \\Delta x\\right)\\right).\n$$\nAbsolute stability for forward Euler with the upwind spatial discretization requires that $|G|\\leq 1$ for all wavenumbers $k$. Evaluating $|G|$,\n$$\n|G|^2 = \\left(1 - C + C\\cos(k\\Delta x)\\right)^2 + \\left(C\\sin(k\\Delta x)\\right)^2.\n$$\nExpanding and simplifying,\n$$\n|G|^2 = \\left(1 - C\\right)^2 + 2C\\left(1 - C\\right)\\cos(k\\Delta x) + C^2\\left(\\cos^2(k\\Delta x)+\\sin^2(k\\Delta x)\\right),\n$$\nand since $\\cos^2(\\theta)+\\sin^2(\\theta)=1$, we obtain\n$$\n|G|^2 = \\left(1 - C\\right)^2 + 2C\\left(1 - C\\right)\\cos(k\\Delta x) + C^2 = 1 - 2C + 2C^2 + 2C\\left(1 - C\\right)\\cos(k\\Delta x).\n$$\nThe maximum of $|G|$ over $k$ occurs at the extremal values of $\\cos(k\\Delta x)$, namely $\\cos(k\\Delta x)=\\pm 1$. Evaluating at $\\cos(k\\Delta x)=1$,\n$$\n|G|^2_{\\max,\\,\\cos=1} = 1 - 2C + 2C^2 + 2C\\left(1 - C\\right) = 1,\n$$\nand at $\\cos(k\\Delta x)=-1$,\n$$\n|G|^2_{\\max,\\,\\cos=-1} = 1 - 2C + 2C^2 - 2C\\left(1 - C\\right) = \\left(1 - 2C\\right)^2.\n$$\nThus the condition $|G|\\leq 1$ for all $k$ is equivalent to\n$$\n\\left|1 - 2C\\right| \\leq 1,\n$$\nwhich gives\n$$\n0 \\leq C \\leq 1.\n$$\nTherefore, the largest stable time step for the first-order upwind explicit scheme is determined by the Courant–Friedrichs–Lewy (CFL) condition\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{a_{\\max}},\n$$\nwith $C=1$ at the stability limit.\n\nIn the AMR setting with two levels and refinement ratio $r=4$, the fine-level spacing satisfies\n$$\n\\Delta x_1 = \\frac{\\Delta x_0}{r}.\n$$\nTo maximize the explicit time step while remaining stable, we choose\n$$\n\\Delta t_0 = \\frac{\\Delta x_0}{a_{\\max}}, \\qquad \\Delta t_1 = \\frac{\\Delta x_1}{a_{\\max}} = \\frac{\\Delta x_0}{r\\,a_{\\max}} = \\frac{\\Delta t_0}{r}.\n$$\nSubstituting the given values $\\Delta x_0 = 2\\times 10^{-3}\\,\\mathrm{m}$, $a_{\\max} = 15\\,\\mathrm{m\\,s^{-1}}$, and $r=4$,\n$$\n\\Delta t_0 = \\frac{2\\times 10^{-3}\\,\\mathrm{m}}{15\\,\\mathrm{m\\,s^{-1}}} = \\left(\\frac{2}{15}\\right)\\times 10^{-3}\\,\\mathrm{s} = 1.333\\ldots \\times 10^{-4}\\,\\mathrm{s},\n$$\nand\n$$\n\\Delta t_1 = \\frac{\\Delta t_0}{4} = 3.333\\ldots \\times 10^{-5}\\,\\mathrm{s}.\n$$\nRounding each to four significant figures yields\n$$\n\\Delta t_0 = 1.333\\times 10^{-4}\\,\\mathrm{s}, \\qquad \\Delta t_1 = 3.333\\times 10^{-5}\\,\\mathrm{s}.\n$$\nThese satisfy subcycling with $r=4$ and saturate the CFL stability limit for the chosen explicit scheme.",
            "answer": "$$\\boxed{\\begin{pmatrix}1.333\\times 10^{-4} & 3.333\\times 10^{-5}\\end{pmatrix}}$$"
        }
    ]
}