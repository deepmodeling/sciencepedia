{
    "hands_on_practices": [
        {
            "introduction": "The interaction of a fluid with a solid wall is a fundamental aspect of virtually all computational fluid dynamics simulations. In the context of cell-centered finite-volume methods, these interactions are modeled by setting values in fictitious 'ghost cells' that lie outside the computational domain. This exercise provides direct practice in translating physical principles—such as impermeability, no-slip, and specific thermal conditions—into the precise ghost-cell values required to accurately enforce them, a core skill for any CFD practitioner .",
            "id": "4032103",
            "problem": "You are asked to implement physically consistent wall boundary condition treatments in the Finite Volume Method (FVM) for Computational Fluid Dynamics (CFD) applied to combustion flows. The focus is on a planar wall boundary with unit normal and the consistent construction of ghost-cell values that enforce physically correct behavior for velocity and temperature fields. The task must be solved from first principles: impermeability and slip versus no-slip behavior for velocity, and adiabatic versus isothermal behavior for temperature. You must formalize and compute ghost-cell values that ensure the correct wall constraints for the solution of compressible flows. You must not rely on any shortcut or pre-stated formulas; instead, your solution must derive what is needed from fundamental laws. Your final program must compute ghost-cell values of tangential velocity and ghost-cell temperatures for a set of specified cases.\n\nThe physical setting is a two-dimensional Cartesian uniform grid with a planar wall aligned arbitrarily. Let the wall be represented locally by a unit normal vector $\\,\\mathbf{n}\\,$ in the plane. Let the fluid velocity at the first interior cell center adjacent to the wall be denoted by $\\,\\mathbf{u}_0\\,$ with components in $\\mathrm{m/s}$, and the temperature at that center be $\\,T_0\\,$ in $\\mathrm{K}$. Let the wall temperature for isothermal cases be $\\,T_w\\,$ in $\\mathrm{K}$. For numerical enforcement in a cell-centered finite-volume discretization, assume the wall lies at the midpoint between the first interior cell center and the ghost cell center along the wall-normal direction. You must compute the ghost-cell values consistent with the following physically defined boundary types:\n\n1. Impermeable wall: the normal velocity at the wall satisfies $\\,\\mathbf{u}\\cdot\\mathbf{n} = 0\\,$.\n2. Slip wall (inviscid): the shear stress vanishes at the wall, which implies zero normal gradient of tangential velocity along the wall-normal direction.\n3. No-slip wall (viscous): both the normal velocity and tangential velocity at the wall must be zero.\n4. Adiabatic wall: the normal heat flux satisfies $\\,\\mathbf{q}\\cdot\\mathbf{n} = 0\\,$, where $\\,\\mathbf{q} = -k\\,\\nabla T\\,$ is the conductive heat flux, implying zero normal temperature gradient at the wall.\n5. Isothermal wall: the temperature at the wall is prescribed and equals $\\,T_w\\,$.\n\nYou must project the interior velocity $\\,\\mathbf{u}_0\\,$ onto the wall-normal and wall-tangential directions, enforce the appropriate wall constraints to determine the ghost-cell values, and then report the scalar tangential component of the ghost-cell velocity and the ghost-cell temperature. You must interpret velocities in $\\mathrm{m/s}$ and temperatures in $\\mathrm{K}$.\n\nYour program must implement the above for the following test suite, where each case specifies the wall normal $\\,\\mathbf{n}\\,$, the interior velocity $\\,\\mathbf{u}_0\\,$, the interior temperature $\\,T_0\\,$, the type of velocity boundary (slip or no-slip), and the type of thermal boundary (adiabatic or isothermal, with a specified $\\,T_w\\,$ where appropriate). The unit normal must be treated generally, and the tangential direction must be chosen orthonormal to the normal.\n\nTest Suite:\n- Case $\\,1\\,$: $\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (1.5,-2.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 800\\,$ $\\mathrm{K}$, slip and adiabatic.\n- Case $\\,2\\,$: $\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (3.0,4.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 1100\\,$ $\\mathrm{K}$, slip and isothermal with $\\,T_w = 1000\\,$ $\\mathrm{K}$.\n- Case $\\,3\\,$: $\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (0.5,1.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 1200\\,$ $\\mathrm{K}$, no-slip and adiabatic.\n- Case $\\,4\\,$: $\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (-0.2,-0.8)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 400\\,$ $\\mathrm{K}$, no-slip and isothermal with $\\,T_w = 350\\,$ $\\mathrm{K}$.\n- Case $\\,5\\,$: $\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (2.0,0.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 900\\,$ $\\mathrm{K}$, slip and adiabatic.\n- Case $\\,6\\,$: $\\,\\mathbf{n} = \\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\,$, $\\,\\mathbf{u}_0 = (1.0,2.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 850\\,$ $\\mathrm{K}$, slip and isothermal with $\\,T_w = 800\\,$ $\\mathrm{K}$.\n\nFor each case, compute and return:\n- The scalar tangential component of the ghost-cell velocity (in $\\mathrm{m/s}$), defined with respect to a unit tangential direction orthonormal to $\\,\\mathbf{n}\\,$.\n- The ghost-cell temperature (in $\\mathrm{K}$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list $\\,\\big[\\text{ghost tangential velocity}, \\text{ghost temperature}\\big]\\,$. For example, a valid overall format is $\\,\\big[ [a_1,b_1], [a_2,b_2], \\dots \\big]\\,$. Report all numeric values as plain floats without units in the output. Internally, all velocities must be treated in $\\mathrm{m/s}$ and all temperatures in $\\mathrm{K}$.",
            "solution": "We begin from general principles in fluid mechanics and heat transfer. Consider a planar wall in a two-dimensional domain. Let the unit normal be $\\,\\mathbf{n}\\,$ and define a unit tangential direction $\\,\\mathbf{t}\\,$ such that $\\,\\mathbf{t}\\cdot\\mathbf{n} = 0\\,$ and $\\,\\|\\mathbf{t}\\| = 1\\,$. A convenient construction in two dimensions is $\\,\\mathbf{t} = (-n_y, n_x)\\,$ when $\\,\\mathbf{n} = (n_x,n_y)\\,$, followed by normalization in case of numerical round-off.\n\nThe interior velocity at the cell center adjacent to the wall is $\\,\\mathbf{u}_0\\,$. Decompose $\\,\\mathbf{u}_0\\,$ into normal and tangential scalar components via orthogonal projection:\n$$\nu_{n,0} = \\mathbf{u}_0 \\cdot \\mathbf{n}, \\quad u_{t,0} = \\mathbf{u}_0 \\cdot \\mathbf{t}.\n$$\nThe vector form is $\\,\\mathbf{u}_0 = u_{n,0}\\,\\mathbf{n} + u_{t,0}\\,\\mathbf{t}\\,$.\n\nWe now impose the wall physics in the framework of a cell-centered Finite Volume Method (FVM). The ghost cell center is placed symmetrically across the wall at the same distance normal to the wall as the interior cell center, so the wall face lies midway between these two centers. This symmetric placement implies second-order accuracy for linear reconstructions when boundary values are enforced by odd or even reflection consistent with the wall constraints.\n\nVelocity boundary types:\n1. Impermeable wall. The condition $\\,\\mathbf{u}\\cdot\\mathbf{n} = 0\\,$ at the wall must be enforced. In a second-order symmetric ghost-cell placement, the odd reflection about the wall face enforces the wall-face value of the normal velocity to be zero. Denote the ghost-cell normal component as $\\,u_{n,g}\\,$ and the interior as $\\,u_{n,0}\\,$. By odd reflection, the ghost must satisfy\n$$\nu_{n,g} = -\\,u_{n,0}.\n$$\nThis ensures the face value is zero when interpolating linearly between the interior and ghost centers, making the impermeability constraint hold at the wall.\n\n2. Slip wall (inviscid). The wall shear stress vanishes, which means the normal derivative of tangential velocity is zero:\n$$\n\\frac{\\partial u_t}{\\partial n} = 0 \\quad \\text{on the wall}.\n$$\nUnder symmetric placement of interior and ghost centers about the wall, this is enforced by even reflection of the tangential component: the ghost tangential scalar equals the interior tangential scalar,\n$$\nu_{t,g} = u_{t,0}.\n$$\nTogether with $\\,u_{n,g} = -u_{n,0}\\,$, the ghost velocity vector is then\n$$\n\\mathbf{u}_g = u_{n,g}\\,\\mathbf{n} + u_{t,g}\\,\\mathbf{t} = (-u_{n,0})\\,\\mathbf{n} + (u_{t,0})\\,\\mathbf{t}.\n$$\n\n3. No-slip wall (viscous). The velocity at the wall is zero, meaning both normal and tangential components vanish at the wall face. Symmetric ghost-cell placement implies odd reflection for both components:\n$$\nu_{n,g} = -\\,u_{n,0}, \\quad u_{t,g} = -\\,u_{t,0}.\n$$\nThis enforces zero velocity at the wall when interpolated to the face.\n\nThermal boundary types:\n1. Adiabatic wall. The normal heat flux vanishes, $\\,\\mathbf{q}\\cdot\\mathbf{n} = 0\\,$, where $\\,\\mathbf{q} = -k\\nabla T\\,$ and $\\,k\\,$ is the thermal conductivity. Consequently,\n$$\n\\frac{\\partial T}{\\partial n} = 0 \\quad \\text{on the wall}.\n$$\nUnder symmetric placement, this is enforced by even reflection of temperature:\n$$\nT_g = T_0,\n$$\nwhere $\\,T_g\\,$ is the ghost-cell temperature and $\\,T_0\\,$ is the adjacent interior temperature.\n\n2. Isothermal wall. The temperature at the wall face is prescribed as $\\,T_w\\,$. With symmetric placement and linear interpolation to the wall face located midway between interior and ghost centers, the face temperature equals the average of interior and ghost values. Enforcing the wall face to be $\\,T_w\\,$ gives\n$$\n\\frac{T_0 + T_g}{2} = T_w \\quad \\Rightarrow \\quad T_g = 2\\,T_w - T_0.\n$$\n\nAlgorithmic steps for each case:\n1. Normalize the given wall normal $\\,\\mathbf{n}\\,$ to ensure unit length:\n$$\n\\mathbf{n} \\leftarrow \\frac{\\mathbf{n}}{\\|\\mathbf{n}\\|}.\n$$\n2. Construct and normalize the tangential direction $\\,\\mathbf{t}\\,$ as $\\,\\mathbf{t} = (-n_y, n_x)\\,$, then normalize $\\,\\mathbf{t}\\,$ to unit length.\n3. Compute the scalar projections $\\,u_{n,0} = \\mathbf{u}_0 \\cdot \\mathbf{n}\\,$ and $\\,u_{t,0} = \\mathbf{u}_0 \\cdot \\mathbf{t}\\,$.\n4. Apply the velocity boundary condition:\n   - For slip: $\\,u_{n,g} = -u_{n,0}\\,$, $\\,u_{t,g} = u_{t,0}\\,$.\n   - For no-slip: $\\,u_{n,g} = -u_{n,0}\\,$, $\\,u_{t,g} = -u_{t,0}\\,$.\n   The required output for velocity is the scalar $\\,u_{t,g}\\,$.\n5. Apply the thermal boundary condition:\n   - For adiabatic: $\\,T_g = T_0\\,$.\n   - For isothermal: $\\,T_g = 2\\,T_w - T_0\\,$.\n6. Report the pair $\\,\\big[u_{t,g},\\,T_g\\big]\\,$ for each case, interpreting the first as $\\mathrm{m/s}$ and the second as $\\mathrm{K}$, and output all results in a single list-of-lists on one line.\n\nApplying these steps to the specified test suite:\n- Case $\\,1\\,$ (slip, adiabatic) with $\\,\\mathbf{n}=(1,0)\\,$ and $\\,\\mathbf{t}=(0,1)\\,$ yields $\\,u_{t,0} = -2.0\\,$ and hence $\\,u_{t,g} = -2.0\\,$; temperature $\\,T_g = 800\\,$.\n- Case $\\,2\\,$ (slip, isothermal) yields $\\,u_{t,g} = 4.0\\,$; temperature $\\,T_g = 2\\cdot 1000 - 1100 = 900\\,$.\n- Case $\\,3\\,$ (no-slip, adiabatic) yields $\\,u_{t,g} = -1.0\\,$; temperature $\\,T_g = 1200\\,$.\n- Case $\\,4\\,$ (no-slip, isothermal) yields $\\,u_{t,g} = 0.8\\,$; temperature $\\,T_g = 2\\cdot 350 - 400 = 300\\,$.\n- Case $\\,5\\,$ (slip, adiabatic) yields $\\,u_{t,g} = 0.0\\,$; temperature $\\,T_g = 900\\,$.\n- Case $\\,6\\,$ (slip, isothermal) with $\\,\\mathbf{n}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\,$ and $\\,\\mathbf{t}=\\left(-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\,$ yields $\\,u_{t,0} = \\mathbf{u}_0\\cdot\\mathbf{t} = \\frac{-1+2}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}}\\,$, hence $\\,u_{t,g} = \\frac{1}{\\sqrt{2}}\\,$; temperature $\\,T_g = 2\\cdot 800 - 850 = 750\\,$.\n\nThe final program must compute these results generically from the inputs and print a single line containing a list of two-element lists $\\,\\big[u_{t,g},\\,T_g\\big]\\,$ for all cases, with numeric values as plain floats.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef normalize(vec):\n    \"\"\"Return the normalized vector; if norm is zero, return zero vector.\"\"\"\n    v = np.array(vec, dtype=float)\n    nrm = np.linalg.norm(v)\n    if nrm == 0.0:\n        return v\n    return v / nrm\n\ndef tangential_from_normal(n):\n    \"\"\"Construct a unit tangential vector orthonormal to the unit normal n in 2D.\"\"\"\n    # For n = (nx, ny), a perpendicular vector is t = (-ny, nx)\n    t = np.array([-n[1], n[0]], dtype=float)\n    return normalize(t)\n\ndef ghost_tangential_and_temperature(n, u0, T0, slip, adiabatic, Tw=None):\n    \"\"\"\n    Compute ghost-cell tangential velocity component and temperature.\n    n: wall normal vector (2D), will be normalized.\n    u0: interior velocity vector (2D) in m/s.\n    T0: interior temperature in K.\n    slip: boolean, True for slip wall, False for no-slip wall.\n    adiabatic: boolean, True for adiabatic wall, False for isothermal wall.\n    Tw: wall temperature in K if isothermal; ignored for adiabatic.\n    Returns (u_t_ghost, T_ghost).\n    \"\"\"\n    n_hat = normalize(n)\n    t_hat = tangential_from_normal(n_hat)\n    u0_vec = np.array(u0, dtype=float)\n\n    # Decompose interior velocity\n    u_n0 = float(np.dot(u0_vec, n_hat))\n    u_t0 = float(np.dot(u0_vec, t_hat))\n\n    # Apply velocity boundary condition\n    u_ng = -u_n0  # impermeability always enforced\n    if slip:\n        u_tg = u_t0  # zero gradient of tangential velocity at slip wall\n    else:\n        u_tg = -u_t0  # no-slip: zero wall tangential velocity\n\n    # Apply thermal boundary condition\n    if adiabatic:\n        T_g = float(T0)\n    else:\n        # isothermal: require Tw provided\n        if Tw is None:\n            raise ValueError(\"Isothermal wall requires Tw.\")\n        T_g = float(2.0 * Tw - T0)\n\n    return (u_tg, T_g)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: dict with keys 'n', 'u0', 'T0', 'slip', 'adiabatic', 'Tw' (optional)\n    test_cases = [\n        # Case 1: n=(1,0), u0=(1.5,-2.0), T0=800, slip and adiabatic\n        {\"n\": (1.0, 0.0), \"u0\": (1.5, -2.0), \"T0\": 800.0, \"slip\": True,  \"adiabatic\": True,  \"Tw\": None},\n        # Case 2: n=(1,0), u0=(3.0,4.0), T0=1100, slip and isothermal Tw=1000\n        {\"n\": (1.0, 0.0), \"u0\": (3.0, 4.0),  \"T0\": 1100.0, \"slip\": True,  \"adiabatic\": False, \"Tw\": 1000.0},\n        # Case 3: n=(1,0), u0=(0.5,1.0), T0=1200, no-slip and adiabatic\n        {\"n\": (1.0, 0.0), \"u0\": (0.5, 1.0),  \"T0\": 1200.0, \"slip\": False, \"adiabatic\": True,  \"Tw\": None},\n        # Case 4: n=(1,0), u0=(-0.2,-0.8), T0=400, no-slip and isothermal Tw=350\n        {\"n\": (1.0, 0.0), \"u0\": (-0.2, -0.8), \"T0\": 400.0, \"slip\": False, \"adiabatic\": False, \"Tw\": 350.0},\n        # Case 5: n=(1,0), u0=(2.0,0.0), T0=900, slip and adiabatic\n        {\"n\": (1.0, 0.0), \"u0\": (2.0, 0.0),  \"T0\": 900.0, \"slip\": True,  \"adiabatic\": True,  \"Tw\": None},\n        # Case 6: n=(1/sqrt(2),1/sqrt(2)), u0=(1.0,2.0), T0=850, slip and isothermal Tw=800\n        {\"n\": (1.0/np.sqrt(2.0), 1.0/np.sqrt(2.0)), \"u0\": (1.0, 2.0), \"T0\": 850.0, \"slip\": True, \"adiabatic\": False, \"Tw\": 800.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        u_tg, T_g = ghost_tangential_and_temperature(\n            n=case[\"n\"],\n            u0=case[\"u0\"],\n            T0=case[\"T0\"],\n            slip=case[\"slip\"],\n            adiabatic=case[\"adiabatic\"],\n            Tw=case[\"Tw\"]\n        )\n        # Optional rounding for neat output\n        u_tg_round = round(u_tg, 6)\n        T_g_round = round(T_g, 6)\n        results.append([u_tg_round, T_g_round])\n\n    # Final print statement in the exact required format: single line, list of lists.\n    # Ensure no extra text is printed.\n    print(f\"[{','.join(str(item) for item in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from solid walls to fluid boundaries like inlets and outlets introduces a new layer of complexity: determining how many physical quantities to specify versus how many should be computed from the domain interior. For the hyperbolic systems of equations governing compressible flow, this question is answered rigorously through characteristic analysis, which identifies the direction of information propagation. This problem delves into this crucial concept, challenging you to ensure a subsonic inlet is physically and numerically well-posed by relating the desired flow properties to the required number of incoming characteristics .",
            "id": "4032117",
            "problem": "A one-dimensional reacting inflow of an unburnt premixed gas enters a computational combustor at the left boundary of a domain that extends in the positive $x$ direction. The solver uses characteristic-based boundary conditions under the inviscid hyperbolic approximation of the Euler equations to ensure well-posedness. The sound speed in the unburnt mixture is modeled by $a=\\sqrt{\\gamma(T)\\,R\\,T}$, where $R$ is the mixture gas constant and $\\gamma(T)$ is the temperature-dependent ratio of specific heats. At a subsonic inflow, exactly two characteristics must enter the domain, which is achieved when the inlet Mach number satisfies $0  M_{\\text{in}}  1$.\n\nSuppose the unburnt mixture is such that\n- the ratio of specific heats is modeled by $\\gamma(T)=\\gamma_{0}+\\dfrac{k}{T}$ with constants $\\gamma_{0}$ and $k$,\n- the mixture gas constant is $R$,\n- the desired unburnt sound speed at the inlet is $a_{\\text{des}}$,\n- the imposed inlet streamwise velocity is $U_{\\text{in}}$ directed into the domain.\n\nStarting from the characteristic wave speeds of the one-dimensional Euler equations and the definition of the sound speed for a calorically imperfect gas, determine the inlet static temperature $T_{\\text{in}}$ that achieves the desired unburnt sound speed while ensuring that the number of incoming characteristics at the inlet is appropriate for a subsonic inflow.\n\nUse the following numerically specified and physically plausible data:\n- $\\gamma_{0}=1.20$,\n- $k=51$,\n- $R=287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- $a_{\\text{des}}=520\\ \\mathrm{m\\,s^{-1}}$,\n- $U_{\\text{in}}=120\\ \\mathrm{m\\,s^{-1}}$.\n\nExpress the final temperature in Kelvin and round your answer to four significant figures.",
            "solution": "The problem statement is first subjected to a validation process to ascertain its scientific and logical integrity.\n\n### Step 1: Extract Givens\n- **System**: A one-dimensional reacting inflow of an unburnt premixed gas into a computational combustor.\n- **Domain**: Extends in the positive $x$ direction.\n- **Solver details**: Uses characteristic-based boundary conditions based on the inviscid hyperbolic approximation of the Euler equations.\n- **Sound speed model**: $a=\\sqrt{\\gamma(T)\\,R\\,T}$.\n- **Gas properties**:\n    - $R$: mixture gas constant.\n    - $\\gamma(T)$: temperature-dependent ratio of specific heats, modeled as $\\gamma(T)=\\gamma_{0}+\\dfrac{k}{T}$.\n- **Inlet conditions**:\n    - Subsonic inflow, corresponding to an inlet Mach number $M_{\\text{in}}$ where $0  M_{\\text{in}}  1$, which requires exactly two characteristics to enter the domain.\n    - Desired unburnt sound speed at the inlet: $a_{\\text{des}}$.\n    - Imposed inlet streamwise velocity: $U_{\\text{in}}$.\n- **Objective**: Determine the inlet static temperature $T_{\\text{in}}$ that achieves the desired sound speed while satisfying the subsonic inflow condition.\n- **Numerical data**:\n    - $\\gamma_{0}=1.20$\n    - $k=51$ (units must be Kelvin for $\\frac{k}{T}$ to be dimensionless)\n    - $R=287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n    - $a_{\\text{des}}=520\\ \\mathrm{m\\,s^{-1}}$\n    - $U_{\\text{in}}=120\\ \\mathrm{m\\,s^{-1}}$\n- **Output format**: Express the final temperature in Kelvin, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of compressible fluid dynamics and computational combustion. The use of characteristic-based boundary conditions for the Euler equations is a standard and rigorous technique in computational fluid dynamics (CFD).\n\nThe characteristic speeds (eigenvalues) of the one-dimensional Euler equations are $\\lambda_1 = u - a$, $\\lambda_2 = u$, and $\\lambda_3 = u + a$, where $u$ is the fluid velocity and $a$ is the local sound speed. At an inlet boundary ($x=0$) where flow enters the domain in the positive $x$ direction, $u  0$. Characteristics are considered \"incoming\" if their speed is positive, meaning they propagate information into the computational domain.\n- $\\lambda_3 = u + a$ is always positive for $u  0$ and $a  0$.\n- $\\lambda_2 = u$ is positive for an inflow.\n- $\\lambda_1 = u - a$ can be positive, negative, or zero.\n\nThe problem states that for a subsonic inflow, exactly two characteristics must enter the domain. This corresponds to the condition $u  a$, or Mach number $M = u/a  1$. In this case, $\\lambda_1 = u - a  0$, so this characteristic wave propagates information out of the domain. The other two characteristics, $\\lambda_2=u$ and $\\lambda_3=u+a$, have positive speeds and are incoming. Thus, for a subsonic inlet, there are exactly two incoming characteristics, consistent with the problem statement. The physical quantities associated with these incoming characteristics must be specified at the boundary, while the quantity associated with the outgoing characteristic must be computed from the domain interior.\n\nLet's verify the subsonic condition using the provided data. The inlet Mach number is $M_{\\text{in}} = \\frac{U_{\\text{in}}}{a_{\\text{des}}}$.\n$$\nM_{\\text{in}} = \\frac{120\\ \\mathrm{m\\,s^{-1}}}{520\\ \\mathrm{m\\,s^{-1}}} \\approx 0.2307\n$$\nSince $0  M_{\\text{in}}  1$, the flow is indeed subsonic, and the premise of the problem is self-consistent and physically realistic. The problem is well-posed, objective, and contains all necessary information for a unique solution.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be derived.\n\n### Solution Derivation\nThe objective is to find the inlet temperature $T_{\\text{in}}$ that results in a sound speed of $a_{\\text{des}}$. The relationship between sound speed and temperature is given by:\n$$\na = \\sqrt{\\gamma(T)\\,R\\,T}\n$$\nThe ratio of specific heats, $\\gamma$, is temperature-dependent and is modeled as:\n$$\n\\gamma(T) = \\gamma_{0} + \\frac{k}{T}\n$$\nWe substitute the expression for $\\gamma(T)$ into the sound speed equation. At the inlet, $T = T_{\\text{in}}$ and we require $a = a_{\\text{des}}$.\n$$\na_{\\text{des}} = \\sqrt{\\left(\\gamma_{0} + \\frac{k}{T_{\\text{in}}}\\right) R T_{\\text{in}}}\n$$\nTo solve for $T_{\\text{in}}$, we first square both sides of the equation:\n$$\na_{\\text{des}}^2 = \\left(\\gamma_{0} + \\frac{k}{T_{\\text{in}}}\\right) R T_{\\text{in}}\n$$\nNext, we distribute the term $R T_{\\text{in}}$ on the right-hand side:\n$$\na_{\\text{des}}^2 = \\gamma_{0} R T_{\\text{in}} + \\frac{k}{T_{\\text{in}}} R T_{\\text{in}}\n$$\nThe $T_{\\text{in}}$ term in the fraction cancels out:\n$$\na_{\\text{des}}^2 = \\gamma_{0} R T_{\\text{in}} + k R\n$$\nThis is a linear equation for $T_{\\text{in}}$. We can now isolate $T_{\\text{in}}$ by rearranging the terms:\n$$\n\\gamma_{0} R T_{\\text{in}} = a_{\\text{des}}^2 - k R\n$$\nFinally, dividing by $\\gamma_{0} R$ yields the symbolic expression for the inlet temperature:\n$$\nT_{\\text{in}} = \\frac{a_{\\text{des}}^2 - k R}{\\gamma_{0} R}\n$$\nNow, we substitute the given numerical values into this expression. The units must be consistent. $R$ is in $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, which is equivalent to $\\mathrm{m^2\\,s^{-2}\\,K^{-1}}$. $a_{\\text{des}}$ is in $\\mathrm{m\\,s^{-1}}$. $k$ is in $\\mathrm{K}$, and $\\gamma_{0}$ is dimensionless.\n- $\\gamma_{0} = 1.20$\n- $k = 51\\ \\mathrm{K}$\n- $R = 287\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}}$\n- $a_{\\text{des}} = 520\\ \\mathrm{m\\,s^{-1}}$\n\nFirst, calculate the terms in the numerator:\n$$\na_{\\text{des}}^2 = (520)^2 = 270400\\ \\mathrm{m^2\\,s^{-2}}\n$$\n$$\nk R = 51\\ \\mathrm{K} \\times 287\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}} = 14637\\ \\mathrm{m^2\\,s^{-2}}\n$$\nThe numerator is:\n$$\na_{\\text{des}}^2 - k R = 270400 - 14637 = 255763\\ \\mathrm{m^2\\,s^{-2}}\n$$\nNext, calculate the denominator:\n$$\n\\gamma_{0} R = 1.20 \\times 287\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}} = 344.4\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}}\n$$\nNow, compute the value of $T_{\\text{in}}$:\n$$\nT_{\\text{in}} = \\frac{255763\\ \\mathrm{m^2\\,s^{-2}}}{344.4\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}}} \\approx 742.633565621...\\ \\mathrm{K}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nT_{\\text{in}} \\approx 742.6\\ \\mathrm{K}\n$$\nThis temperature ensures the desired sound speed is achieved while satisfying the condition for a well-posed subsonic inflow boundary condition as verified earlier.",
            "answer": "$$\\boxed{742.6}$$"
        },
        {
            "introduction": "Once the appropriate number of variables for an inlet is determined, their specified values must be physically consistent, a critical detail in reacting flow simulations where mixture properties are paramount. User-provided or interpolated species mass fractions, for instance, might not sum to unity or could contain unphysical negative values due to numerical noise. This practice addresses this common implementation challenge by guiding you through the design of a robust normalization scheme that not only enforces mass conservation but also preserves the mixture's sensible enthalpy by adjusting the inlet temperature, ensuring the simulation's energy balance remains correct from the outset .",
            "id": "4032089",
            "problem": "You are modeling an inlet boundary condition for a reacting perfect-gas mixture in a computational combustion simulation. The inflow species mass fractions may be inconsistent with mass conservation at the inlet, which requires that the species mass fractions sum to unity. You must design and implement a boundary correction and enthalpy-preserving normalization scheme.\n\nAssume the following foundational facts, which you should use as the base of your derivation and design:\n- For a mixture, mass fractions satisfy the identity $\\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k = 1$, where $Y_k$ are species mass fractions and $N_{\\mathrm{sp}}$ is the number of species.\n- The sensible enthalpy of species $k$ is defined relative to a reference temperature $T_{\\mathrm{ref}}$ as $h_k^{\\mathrm{sens}}(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(T')\\, \\mathrm{d}T'$. In this problem, model $c_{p,k}$ as constant for each species, so $h_k^{\\mathrm{sens}}(T) = c_{p,k}\\,(T - T_{\\mathrm{ref}})$.\n- The mixture sensible enthalpy is $h^{\\mathrm{sens}}(T, \\boldsymbol{Y}) = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k\\, h_k^{\\mathrm{sens}}(T)$.\n\nYour task is to:\n1. Compute the mass conservation discrepancy at the inlet, defined as $\\varepsilon = 1 - \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{in}}$, where $Y_k^{\\mathrm{in}}$ are the provided inflow mass fractions.\n2. Correct the species mass fractions by:\n   - Enforcing non-negativity: any $Y_k^{\\mathrm{in}}  0$ must be clipped to $0$ prior to normalization.\n   - Renormalizing the clipped inflow mass fractions to obtain corrected mass fractions $\\tilde{Y}_k$ that satisfy $\\sum_{k} \\tilde{Y}_k = 1$.\n3. Preserve the inflow mixture sensible enthalpy across this correction by adjusting the static temperature from $T_{\\mathrm{in}}$ to a corrected value $\\tilde{T}$ such that $h^{\\mathrm{sens}}(T_{\\mathrm{in}}, \\boldsymbol{Y}^{\\mathrm{clip}}) = h^{\\mathrm{sens}}(\\tilde{T}, \\tilde{\\boldsymbol{Y}})$, where $\\boldsymbol{Y}^{\\mathrm{clip}}$ are the clipped (non-negative) inflow mass fractions used to define the target enthalpy. Use the constant-specific-heat model to derive and compute $\\tilde{T}$ exactly.\n\nAll temperatures must be expressed in Kelvin ($\\mathrm{K}$). The reference temperature is $T_{\\mathrm{ref}} = 298.15$ $\\mathrm{K}$. Specific heats at constant pressure $c_{p,k}$ are constant and given in $\\mathrm{J}\\, \\mathrm{kg}^{-1}\\, \\mathrm{K}^{-1}$ for the five-species set $\\{ \\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{CH_4}, \\mathrm{CO_2}, \\mathrm{H_2O} \\}$ as:\n- $\\mathrm{N_2}$: $c_{p,\\mathrm{N_2}} = 1040.0$\n- $\\mathrm{O_2}$: $c_{p,\\mathrm{O_2}} = 918.0$\n- $\\mathrm{CH_4}$: $c_{p,\\mathrm{CH_4}} = 2220.0$\n- $\\mathrm{CO_2}$: $c_{p,\\mathrm{CO_2}} = 846.0$\n- $\\mathrm{H_2O}$: $c_{p,\\mathrm{H_2O}} = 1850.0$\n\nImplement the above using the following test suite of inlet states. Each test case provides $T_{\\mathrm{in}}$ and the inflow mass fractions in the species order $\\{ \\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{CH_4}, \\mathrm{CO_2}, \\mathrm{H_2O} \\}$:\n\n- Test case A (general case with sum greater than unity): $T_{\\mathrm{in}} = 900.0$ $\\mathrm{K}$, $\\boldsymbol{Y}^{\\mathrm{in}} = [0.75, 0.21, 0.03, 0.02, 0.0]$.\n- Test case B (general case with sum less than unity): $T_{\\mathrm{in}} = 1200.0$ $\\mathrm{K}$, $\\boldsymbol{Y}^{\\mathrm{in}} = [0.70, 0.19, 0.06, 0.03, 0.01]$.\n- Test case C (negative entry due to numerical noise): $T_{\\mathrm{in}} = 800.0$ $\\mathrm{K}$, $\\boldsymbol{Y}^{\\mathrm{in}} = [0.77, 0.23, -0.01, 0.01, 0.0]$.\n- Test case D (mild overspecification): $T_{\\mathrm{in}} = 1000.0$ $\\mathrm{K}$, $\\boldsymbol{Y}^{\\mathrm{in}} = [0.78, 0.22, 0.01, 0.0, 0.0]$.\n\nYour program must:\n- For each test case, compute and return the triple consisting of the discrepancy $\\varepsilon$, the corrected temperature $\\tilde{T}$ that preserves sensible enthalpy, and the corrected mass fraction vector $\\tilde{\\boldsymbol{Y}}$ after clipping and normalization, all rounded to six decimal places.\n- Produce a single line of output containing a list of these triples for the four test cases, as a comma-separated list enclosed in square brackets. Within each triple, the corrected mass fractions must appear as a sub-list in the species order $\\{ \\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{CH_4}, \\mathrm{CO_2}, \\mathrm{H_2O} \\}$.\n\nFor example, the final output format must be:\n$[ [\\varepsilon_A, \\tilde{T}_A, [\\tilde{Y}_{A,\\mathrm{N_2}}, \\tilde{Y}_{A,\\mathrm{O_2}}, \\tilde{Y}_{A,\\mathrm{CH_4}}, \\tilde{Y}_{A,\\mathrm{CO_2}}, \\tilde{Y}_{A,\\mathrm{H_2O}}]], [\\varepsilon_B, \\tilde{T}_B, [\\dots]], [\\varepsilon_C, \\tilde{T}_C, [\\dots]], [\\varepsilon_D, \\tilde{T}_D, [\\dots]] ]$\nwhere all numeric entries are decimal numbers in Kelvin for temperatures and dimensionless for mass fractions and discrepancy, each rounded to six decimal places.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of thermodynamics and mass conservation, is well-posed with a clear and complete set of givens, and is expressed in objective, formal language. A unique and meaningful solution can be derived and computed.\n\nThe task is to design and implement a numerical scheme for correcting inlet boundary conditions for a reacting gas mixture. The scheme must ensure mass conservation and preserve the mixture's sensible enthalpy by adjusting the inlet temperature. The process involves three sequential steps: computing the mass conservation error, correcting the species mass fractions, and adjusting the temperature.\n\n### 1. Mass Conservation Discrepancy\n\nThe fundamental principle of mass conservation for a multi-species mixture requires that the sum of all species mass fractions, $Y_k$, equals unity.\n$$\n\\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k = 1\n$$\nwhere $N_{\\mathrm{sp}}$ is the total number of species. The provided inflow mass fractions, denoted $Y_k^{\\mathrm{in}}$, may violate this condition. The discrepancy, $\\varepsilon$, is defined as the deviation from unity of this sum:\n$$\n\\varepsilon = 1 - \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{in}}\n$$\n\n### 2. Mass Fraction Correction Scheme\n\nA physically valid set of mass fractions must satisfy two conditions: non-negativity ($Y_k \\ge 0$ for all $k$) and the sum-to-one constraint. The correction is performed in two sub-steps.\n\n#### 2.1. Non-negativity Enforcement (Clipping)\n\nNumerical errors or user input can lead to small negative mass fractions. These are unphysical and must be eliminated. Each inflow mass fraction $Y_k^{\\mathrm{in}}$ is clipped to zero if it is negative. The resulting clipped mass fractions, $Y_k^{\\mathrm{clip}}$, are defined as:\n$$\nY_k^{\\mathrm{clip}} = \\max(0, Y_k^{\\mathrm{in}})\n$$\n\n#### 2.2. Normalization\n\nAfter clipping, the sum of the mass fractions, $S^{\\mathrm{clip}} = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{clip}}$, may not be equal to $1$. To enforce the sum-to-one constraint, the clipped mass fractions are normalized. The final, corrected mass fractions, $\\tilde{Y}_k$, are obtained by dividing each $Y_k^{\\mathrm{clip}}$ by their sum $S^{\\mathrm{clip}}$:\n$$\n\\tilde{Y}_k = \\frac{Y_k^{\\mathrm{clip}}}{S^{\\mathrm{clip}}} = \\frac{Y_k^{\\mathrm{clip}}}{\\sum_{j=1}^{N_{\\mathrm{sp}}} Y_j^{\\mathrm{clip}}}\n$$\nThis operation guarantees that $\\sum_{k=1}^{N_{\\mathrm{sp}}} \\tilde{Y}_k = 1$, provided that $S^{\\mathrm{clip}}  0$. For the given test cases, this condition is met.\n\n### 3. Enthalpy-Preserving Temperature Correction\n\nThe correction of mass fractions alters the composition of the inflow mixture. To maintain the original energy content of the flow, the inlet temperature must be adjusted. This is achieved by preserving the mixture sensible enthalpy.\n\nThe sensible enthalpy of species $k$, $h_k^{\\mathrm{sens}}$, under the constant specific heat assumption, is given by:\n$$\nh_k^{\\mathrm{sens}}(T) = c_{p,k}(T - T_{\\mathrm{ref}})\n$$\nwhere $c_{p,k}$ is the constant-pressure specific heat of species $k$, $T$ is the static temperature, and $T_{\\mathrm{ref}}$ is the reference temperature for enthalpy, given as $298.15 \\, \\mathrm{K}$.\n\nThe mixture sensible enthalpy, $h^{\\mathrm{sens}}$, is the mass-fraction-weighted sum of the species enthalpies:\n$$\nh^{\\mathrm{sens}}(T, \\boldsymbol{Y}) = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k h_k^{\\mathrm{sens}}(T) = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k c_{p,k} (T - T_{\\mathrm{ref}}) = (T - T_{\\mathrm{ref}}) \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k c_{p,k}\n$$\n\nThe problem requires that the sensible enthalpy of the mixture defined by the clipped mass fractions $\\boldsymbol{Y}^{\\mathrm{clip}}$ at the original inlet temperature $T_{\\mathrm{in}}$ is equal to the sensible enthalpy of the mixture with corrected mass fractions $\\tilde{\\boldsymbol{Y}}$ at a new, corrected temperature $\\tilde{T}$. This conservation principle is expressed as:\n$$\nh^{\\mathrm{sens}}(T_{\\mathrm{in}}, \\boldsymbol{Y}^{\\mathrm{clip}}) = h^{\\mathrm{sens}}(\\tilde{T}, \\tilde{\\boldsymbol{Y}})\n$$\n\nSubstituting the definition of mixture sensible enthalpy gives:\n$$\n(T_{\\mathrm{in}} - T_{\\mathrm{ref}}) \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{clip}} c_{p,k} = (\\tilde{T} - T_{\\mathrm{ref}}) \\sum_{k=1}^{N_{\\mathrm{sp}}} \\tilde{Y}_k c_{p,k}\n$$\n\nWe introduce the mixture specific heat $c_{p, \\mathrm{mix}}(\\boldsymbol{Y}) = \\sum_k Y_k c_{p,k}$. The equation becomes:\n$$\n(T_{\\mathrm{in}} - T_{\\mathrm{ref}}) \\, c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}}) = (\\tilde{T} - T_{\\mathrm{ref}}) \\, c_{p, \\mathrm{mix}}(\\tilde{\\boldsymbol{Y}})\n$$\n\nFrom the normalization step, we have $\\tilde{Y}_k = Y_k^{\\mathrm{clip}} / S^{\\mathrm{clip}}$. Therefore, the corrected mixture specific heat can be related to the clipped mixture specific heat:\n$$\nc_{p, \\mathrm{mix}}(\\tilde{\\boldsymbol{Y}}) = \\sum_{k=1}^{N_{\\mathrm{sp}}} \\tilde{Y}_k c_{p,k} = \\sum_{k=1}^{N_{\\mathrm{sp}}} \\frac{Y_k^{\\mathrm{clip}}}{S^{\\mathrm{clip}}} c_{p,k} = \\frac{1}{S^{\\mathrm{clip}}} \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{clip}} c_{p,k} = \\frac{c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}})}{S^{\\mathrm{clip}}}\n$$\n\nSubstituting this relationship back into the enthalpy conservation equation:\n$$\n(T_{\\mathrm{in}} - T_{\\mathrm{ref}}) \\, c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}}) = (\\tilde{T} - T_{\\mathrm{ref}}) \\, \\frac{c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}})}{S^{\\mathrm{clip}}}\n$$\n\nAssuming $c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}})  0$, which is true as all $c_{p,k}  0$ and at least one $Y_k^{\\mathrm{clip}}  0$, we can cancel this term from both sides:\n$$\nT_{\\mathrm{in}} - T_{\\mathrm{ref}} = \\frac{\\tilde{T} - T_{\\mathrm{ref}}}{S^{\\mathrm{clip}}}\n$$\n\nSolving for the corrected temperature $\\tilde{T}$ yields the final, exact expression:\n$$\n\\tilde{T} = T_{\\mathrm{ref}} + S^{\\mathrm{clip}} (T_{\\mathrm{in}} - T_{\\mathrm{ref}})\n$$\nThis elegant result shows that the temperature correction factor is simply the sum of the clipped mass fractions, $S^{\\mathrm{clip}}$. The entire procedure can now be implemented algorithmically.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes boundary condition corrections for reacting flow inlets.\n\n    For each test case, the function calculates:\n    1. The mass conservation discrepancy (epsilon).\n    2. The corrected mass fractions (Y_tilde) by clipping negative values and normalizing.\n    3. The corrected temperature (T_tilde) that preserves the mixture sensible enthalpy.\n    \"\"\"\n    \n    # Foundational constants and definitions\n    T_ref = 298.15  # K\n    species = ['N2', 'O2', 'CH4', 'CO2', 'H2O']\n    # Specific heats at constant pressure [J kg^-1 K^-1] for the species set\n    cp_k = np.array([1040.0, 918.0, 2220.0, 846.0, 1850.0])\n\n    # Test suite of inlet states\n    # Each case: (T_in [K], Y_in list)\n    test_cases = [\n        # Test case A\n        (900.0, [0.75, 0.21, 0.03, 0.02, 0.0]),\n        # Test case B\n        (1200.0, [0.70, 0.19, 0.06, 0.03, 0.01]),\n        # Test case C\n        (800.0, [0.77, 0.23, -0.01, 0.01, 0.0]),\n        # Test case D\n        (1000.0, [0.78, 0.22, 0.01, 0.0, 0.0]),\n    ]\n\n    # List to store the string representation of each case's result\n    formatted_results = []\n\n    for T_in, Y_in_list in test_cases:\n        Y_in = np.array(Y_in_list)\n\n        # 1. Compute the mass conservation discrepancy\n        epsilon = 1.0 - np.sum(Y_in)\n\n        # 2. Correct the species mass fractions\n        # 2.1. Enforce non-negativity (clipping)\n        Y_clip = np.maximum(0.0, Y_in)\n\n        # 2.2. Renormalize to obtain corrected mass fractions\n        S_clip = np.sum(Y_clip)\n        \n        if S_clip  0:\n            Y_tilde = Y_clip / S_clip\n        else:\n            # Handle edge case where all mass fractions are zero or negative.\n            # In this case, mass fractions remain zero and no normalization is possible.\n            # Temperature is not adjusted as enthalpy is zero.\n            Y_tilde = np.zeros_like(Y_in)\n            \n        # 3. Preserve enthalpy by correcting the temperature\n        if S_clip  0:\n             # The derivation simplifies to T_tilde = T_ref + S_clip * (T_in - T_ref)\n            T_tilde = T_ref + S_clip * (T_in - T_ref)\n        else:\n            T_tilde = T_in\n\n        # Format results to six decimal places as required by the problem statement.\n        eps_str = f\"{epsilon:.6f}\"\n        T_tilde_str = f\"{T_tilde:.6f}\"\n        \n        # Format the mass fraction vector as a string list\n        y_tilde_str_list = [f\"{y:.6f}\" for y in Y_tilde]\n        y_tilde_list_str = f\"[{','.join(y_tilde_str_list)}]\"\n        \n        # Combine into the final string format for the current test case\n        case_result_str = f\"[{eps_str},{T_tilde_str},{y_tilde_list_str}]\"\n        formatted_results.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}