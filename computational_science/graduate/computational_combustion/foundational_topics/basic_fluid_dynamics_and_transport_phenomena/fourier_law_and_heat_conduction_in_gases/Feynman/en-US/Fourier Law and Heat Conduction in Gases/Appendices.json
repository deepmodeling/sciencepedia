{
    "hands_on_practices": [
        {
            "introduction": "We begin with a foundational problem that explores heat conduction through a simple planar gas layer. This exercise reinforces the direct application of Fourier's law and the energy conservation principle to derive temperature profiles and heat flux. By first assuming constant thermal conductivity and then progressing to a more realistic temperature-dependent model, you will develop a deeper physical intuition for how material properties shape thermal transport .",
            "id": "4028184",
            "problem": "A dilute, single-component gas occupies a stationary planar layer between two infinite parallel isothermal walls at positions $x=0$ and $x=L$. The wall at $x=0$ is maintained at temperature $T_{0}$ and the wall at $x=L$ at temperature $T_{L}$. The gas is at rest (no bulk flow), there is no volumetric heat release, and radiation is negligible. Mean free path effects are negligible compared to $L$ (continuum limit), and the system has reached steady state. This setting is representative of a conduction-controlled subproblem encountered in computational combustion when isolating the thermal diffusion contribution to the energy equation in a gas mixture. \n\n(a) Starting from steady one-dimensional energy conservation (no volumetric sources) and a constitutive relation consistent with linear irreversible thermodynamics for a dilute gas in the hydrodynamic limit, derive the expressions for the spatial temperature field $T(x)$ and the uniform conductive heat flux $q^{\\prime\\prime}$ for the case of constant thermal conductivity $k=k_{0}$, subject to the boundary conditions $T(0)=T_{0}$ and $T(L)=T_{L}$. Express your final formulas in closed form in terms of $T_{0}$, $T_{L}$, $L$, and $k_{0}$.\n\n(b) Now suppose the thermal conductivity varies with temperature according to a power law $k(T)=k_{0}\\left(T/T_{\\mathrm{ref}}\\right)^{n}$, where $k_{0}>0$, $T_{\\mathrm{ref}}>0$, and $n$ is a real constant. Using the same starting point as in part (a), derive an analytic expression for the constant heat flux $q^{\\prime\\prime}$ in terms of $T_{0}$, $T_{L}$, $L$, $k_{0}$, $T_{\\mathrm{ref}}$, and $n$. Then, without computing a numerical value, discuss qualitatively how the steady temperature profile $T(x)$ deviates from linearity for $n>0$ versus $n<0$, and provide a physical interpretation relevant to gases encountered in combustion (for example, the tendency $k(T)\\propto T^{1/2}$ for monatomic gases over moderate temperature ranges).\n\nAnswer specification: Provide your final answer as a single composite of the constant-$k$ heat flux $q^{\\prime\\prime}$ and the constant-$k$ temperature profile $T(x)$, each as closed-form expressions. No numerical evaluation is required, and no units should be included in the final boxed answer.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. We may proceed with a solution.\n\nThe fundamental physical principle governing this problem is the conservation of energy. For a one-dimensional, steady-state system with no bulk flow and no volumetric heat sources, the energy equation simplifies to:\n$$ \\frac{d q^{\\prime\\prime}}{dx} = 0 $$\nwhere $q^{\\prime\\prime}$ is the conductive heat flux in the $x$-direction. This equation implies that the heat flux $q^{\\prime\\prime}$ must be constant throughout the gas layer, from $x=0$ to $x=L$.\n\nThe constitutive relation connecting heat flux to the temperature gradient is Fourier's law of heat conduction, which in one dimension is given by:\n$$ q^{\\prime\\prime} = -k \\frac{dT}{dx} $$\nwhere $k$ is the thermal conductivity of the gas and $T$ is the temperature.\n\nWe now address the two parts of the problem.\n\n(a) Case of constant thermal conductivity, $k=k_0$.\n\nWith constant thermal conductivity $k_0$, and knowing that $q^{\\prime\\prime}$ is constant, Fourier's law becomes an ordinary differential equation with a constant right-hand side:\n$$ \\frac{dT}{dx} = -\\frac{q^{\\prime\\prime}}{k_0} $$\nWe can integrate this equation with respect to $x$ from the boundary at $x=0$ to an arbitrary position $x$ within the layer:\n$$ \\int_{T(0)}^{T(x)} dT' = \\int_{0}^{x} \\left(-\\frac{q^{\\prime\\prime}}{k_0}\\right) dx' $$\nUsing the boundary condition $T(0)=T_0$, the integration yields the temperature profile as a function of $x$ and the unknown constant heat flux $q^{\\prime\\prime}$:\n$$ T(x) - T_0 = -\\frac{q^{\\prime\\prime}}{k_0} x $$\n$$ T(x) = T_0 - \\frac{q^{\\prime\\prime}}{k_0} x $$\nThis shows that the temperature profile is linear for constant thermal conductivity.\n\nTo determine the heat flux $q^{\\prime\\prime}$, we apply the second boundary condition at $x=L$, where $T(L)=T_L$:\n$$ T_L = T_0 - \\frac{q^{\\prime\\prime}}{k_0} L $$\nSolving for $q^{\\prime\\prime}$:\n$$ \\frac{q^{\\prime\\prime}}{k_0} L = T_0 - T_L $$\n$$ q^{\\prime\\prime} = \\frac{k_0(T_0 - T_L)}{L} $$\nThis is the expression for the constant conductive heat flux. A positive $q^{\\prime\\prime}$ corresponds to heat flow from the hot wall to the cold wall, which occurs if $T_0 > T_L$.\n\nFinally, we substitute the expression for $q^{\\prime\\prime}$ back into the equation for $T(x)$ to obtain the temperature profile solely in terms of the given parameters:\n$$ T(x) = T_0 - \\frac{1}{k_0} \\left( \\frac{k_0(T_0 - T_L)}{L} \\right) x $$\n$$ T(x) = T_0 - (T_0 - T_L) \\frac{x}{L} $$\nThis expression can be rearranged into a more symmetric form:\n$$ T(x) = T_0 \\left(1 - \\frac{x}{L}\\right) + T_L \\frac{x}{L} $$\n\n(b) Case of temperature-dependent thermal conductivity, $k(T)=k_{0}\\left(T/T_{\\mathrm{ref}}\\right)^{n}$.\n\nThe governing equations remain the same: $q^{\\prime\\prime}$ is constant, and Fourier's law is $q^{\\prime\\prime} = -k(T) \\frac{dT}{dx}$. Substituting the given form for $k(T)$:\n$$ q^{\\prime\\prime} = -k_0 \\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)^n \\frac{dT}{dx} $$\nTo find the constant heat flux $q^{\\prime\\prime}$, we separate variables and integrate across the entire domain.\n$$ q^{\\prime\\prime} dx = -k_0 \\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)^n dT $$\nIntegrating the left side from $x=0$ to $x=L$ and the right side from the corresponding temperatures $T=T_0$ to $T=T_L$:\n$$ \\int_{0}^{L} q^{\\prime\\prime} dx = \\int_{T_0}^{T_L} -k_0 \\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)^n dT $$\n$$ q^{\\prime\\prime} [x]_0^L = -\\frac{k_0}{T_{\\mathrm{ref}}^n} \\int_{T_0}^{T_L} T^n dT $$\n$$ q^{\\prime\\prime} L = -\\frac{k_0}{T_{\\mathrm{ref}}^n} \\int_{T_0}^{T_L} T^n dT $$\nThe integral depends on the value of $n$. For the general case where $n \\neq -1$:\n$$ \\int_{T_0}^{T_L} T^n dT = \\left[ \\frac{T^{n+1}}{n+1} \\right]_{T_0}^{T_L} = \\frac{T_L^{n+1} - T_0^{n+1}}{n+1} $$\nSubstituting this result back:\n$$ q^{\\prime\\prime} L = -\\frac{k_0}{T_{\\mathrm{ref}}^n} \\left( \\frac{T_L^{n+1} - T_0^{n+1}}{n+1} \\right) $$\nSolving for $q^{\\prime\\prime}$:\n$$ q^{\\prime\\prime} = \\frac{k_0}{(n+1) L T_{\\mathrm{ref}}^n} (T_0^{n+1} - T_L^{n+1}) $$\nFor the special case $n = -1$:\n$$ \\int_{T_0}^{T_L} T^{-1} dT = [\\ln(T)]_{T_0}^{T_L} = \\ln(T_L) - \\ln(T_0) = \\ln\\left(\\frac{T_L}{T_0}\\right) $$\nAnd the heat flux becomes:\n$$ q^{\\prime\\prime} L = -k_0 T_{\\mathrm{ref}} \\ln\\left(\\frac{T_L}{T_0}\\right) \\implies q^{\\prime\\prime} = \\frac{k_0 T_{\\mathrm{ref}}}{L} \\ln\\left(\\frac{T_0}{T_L}\\right) $$\n\nNext, we discuss the shape of the temperature profile $T(x)$. The curvature of the profile is given by the second derivative, $\\frac{d^2T}{dx^2}$. We start with Fourier's law, $q^{\\prime\\prime} = -k(T) \\frac{dT}{dx}$, and differentiate with respect to $x$, remembering that $q^{\\prime\\prime}$ is constant:\n$$ \\frac{d q^{\\prime\\prime}}{dx} = 0 = \\frac{d}{dx}\\left(-k(T(x)) \\frac{dT}{dx}\\right) = - \\left[ \\frac{dk}{dT} \\left(\\frac{dT}{dx}\\right)^2 + k(T) \\frac{d^2T}{dx^2} \\right] $$\nSolving for the second derivative:\n$$ \\frac{d^2T}{dx^2} = -\\frac{1}{k(T)} \\frac{dk}{dT} \\left(\\frac{dT}{dx}\\right)^2 $$\nFor $k(T) = k_0 (T/T_{\\mathrm{ref}})^n$, we have $\\frac{dk}{dT} = n k_0 T_{\\mathrm{ref}}^{-n} T^{n-1} = n \\frac{k(T)}{T}$. Substituting this into the expression for the curvature:\n$$ \\frac{d^2T}{dx^2} = -\\frac{1}{k(T)} \\left(n \\frac{k(T)}{T}\\right) \\left(\\frac{dT}{dx}\\right)^2 = -\\frac{n}{T} \\left(\\frac{dT}{dx}\\right)^2 $$\nSince temperature $T$ must be positive (absolute scale) and $\\left(\\frac{dT}{dx}\\right)^2 \\ge 0$, the sign of the curvature is determined entirely by the sign of $-n$.\n\nCase $n > 0$: The curvature $\\frac{d^2T}{dx^2}$ is negative. This means the temperature profile $T(x)$ is concave down.\nPhysical interpretation: If $n > 0$, the thermal conductivity $k(T)$ increases with temperature. The gas is more conductive at higher temperatures and less conductive at lower temperatures. A constant heat flux $q^{\\prime\\prime}$ must be maintained across the layer. From $|dT/dx| = |q^{\\prime\\prime}|/k(T)$, a smaller conductivity requires a larger temperature gradient magnitude. Therefore, the temperature gradient will be steepest in the colder regions and gentlest in the hotter regions. The profile bends away from the linear profile towards the colder boundary temperature. In combustion, gases often exhibit $k(T)$ increasing with $T$ (e.g., simple kinetic theory suggests $n \\approx 1/2$), so this concave-down profile is typical.\n\nCase $n < 0$: The curvature $\\frac{d^2T}{dx^2}$ is positive. This means the temperature profile $T(x)$ is concave up.\nPhysical interpretation: If $n < 0$, the thermal conductivity $k(T)$ decreases with increasing temperature. The gas is less conductive at higher temperatures. To maintain constant $q^{\\prime\\prime}$, the temperature gradient magnitude $|dT/dx|$ must now be larger in the hotter regions. The profile bends away from the linear profile towards the hotter boundary temperature.\n\nCase $n = 0$: The curvature $\\frac{d^2T}{dx^2}$ is zero. The temperature profile is linear, recovering the result from part (a).",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{k_0(T_0-T_L)}{L} & T_0 \\left(1 - \\frac{x}{L}\\right) + T_L \\frac{x}{L} \\end{pmatrix}} $$"
        },
        {
            "introduction": "In reacting flows and multicomponent gas mixtures, energy transport is not limited to heat conduction alone. This practice problem demonstrates the significant role of enthalpy diffusion, where diffusing species carry energy with them. By analyzing a hydrogen-nitrogen mixture, you will quantify this effect—which can be a dominant mode of energy transfer—and compare it to the standard Fourier heat flux, revealing why it is a critical consideration in modeling flames, particularly those involving light fuels .",
            "id": "4028164",
            "problem": "A steady, one-dimensional counterflow flame in a binary mixture of hydrogen ($\\mathrm{H_2}$) and nitrogen ($\\mathrm{N_2}$) is observed at a location $x_0$ where the local temperature is $T = 1500\\ \\mathrm{K}$. The flow is at atmospheric pressure and the mixture is treated as an ideal gas. At $x_0$, steep gradients typical of the stagnation plane region are measured: a hydrogen mass fraction gradient of magnitude $|\\nabla Y_{\\mathrm{H_2}}| = 1.2 \\times 10^{3}\\ \\mathrm{m^{-1}}$ and a temperature gradient of magnitude $|\\nabla T| = 1.8 \\times 10^{6}\\ \\mathrm{K/m}$. The local properties (assumed constant over the gradients) are: density $\\rho = 0.20\\ \\mathrm{kg/m^3}$, thermal conductivity $k = 0.22\\ \\mathrm{W/(m\\cdot K)}$, and binary diffusion coefficient for hydrogen in nitrogen $D_{\\mathrm{H_2-N_2}} = 2.5 \\times 10^{-4}\\ \\mathrm{m^2/s}$. The molar heat capacities at constant pressure, approximately valid over $300\\ \\mathrm{K}$ to $1500\\ \\mathrm{K}$, are $c_{p,m,\\mathrm{H_2}} = 29.1\\ \\mathrm{J/(mol\\cdot K)}$ and $c_{p,m,\\mathrm{N_2}} = 35.7\\ \\mathrm{J/(mol\\cdot K)}$. The molar masses are $M_{\\mathrm{H_2}} = 2.016 \\times 10^{-3}\\ \\mathrm{kg/mol}$ and $M_{\\mathrm{N_2}} = 28.0134 \\times 10^{-3}\\ \\mathrm{kg/mol}$. Assume negligible barodiffusion, negligible thermal diffusion (Soret effect), negligible body forces, and refer sensible enthalpy to $T_{\\mathrm{ref}} = 300\\ \\mathrm{K}$.\n\nStarting from first principles appropriate to multicomponent gas mixtures in combustion (the first law of thermodynamics for a continuum, Fourier’s law of heat conduction, and the definition of diffusive species flux relative to the mass-average velocity for a binary ideal-gas mixture), derive an expression for the Dufour heat flux caused by the composition gradient and the Fourier heat flux caused by the temperature gradient at $x_0$. Using the provided data, compute the magnitude ratio\n$$R = \\frac{|q_{\\mathrm{Dufour}}|}{|q_{\\mathrm{Fourier}}|}.$$\nExpress the final answer as a single dimensionless number. Round your answer to three significant figures.",
            "solution": "The problem asks for the ratio of the magnitudes of the Dufour heat flux to the Fourier heat flux in a binary gas mixture at a specific location within a counterflow flame.\n\nStep 1: Problem Validation\nAll given data are extracted and listed below:\n- System: Steady, one-dimensional counterflow flame.\n- Mixture: Binary, hydrogen ($\\mathrm{H_2}$) and nitrogen ($\\mathrm{N_2}$), ideal gas.\n- Location: $x_0$.\n- Temperature: $T = 1500\\ \\mathrm{K}$.\n- Pressure: Atmospheric.\n- Hydrogen mass fraction gradient magnitude: $|\\nabla Y_{\\mathrm{H_2}}| = 1.2 \\times 10^{3}\\ \\mathrm{m^{-1}}$.\n- Temperature gradient magnitude: $|\\nabla T| = 1.8 \\times 10^{6}\\ \\mathrm{K/m}$.\n- Density: $\\rho = 0.20\\ \\mathrm{kg/m^3}$.\n- Thermal conductivity: $k = 0.22\\ \\mathrm{W/(m\\cdot K)}$.\n- Binary diffusion coefficient: $D_{\\mathrm{H_2-N_2}} = 2.5 \\times 10^{-4}\\ \\mathrm{m^2/s}$.\n- Molar heat capacity of $\\mathrm{H_2}$: $c_{p,m,\\mathrm{H_2}} = 29.1\\ \\mathrm{J/(mol\\cdot K)}$.\n- Molar heat capacity of $\\mathrm{N_2}$: $c_{p,m,\\mathrm{N_2}} = 35.7\\ \\mathrm{J/(mol\\cdot K)}$.\n- Molar mass of $\\mathrm{H_2}$: $M_{\\mathrm{H_2}} = 2.016 \\times 10^{-3}\\ \\mathrm{kg/mol}$.\n- Molar mass of $\\mathrm{N_2}$: $M_{\\mathrm{N_2}} = 28.0134 \\times 10^{-3}\\ \\mathrm{kg/mol}$.\n- Sensible enthalpy reference temperature: $T_{\\mathrm{ref}} = 300\\ \\mathrm{K}$.\n- Assumptions: Negligible barodiffusion, thermal diffusion (Soret effect), and body forces.\n\nThe problem is scientifically grounded in the principles of continuum mechanics and transport phenomena applied to combustion. The data are physically plausible for a hydrogen flame. The objective is clearly stated and all necessary information is provided. The problem is well-posed and valid.\n\nStep 2: Derivation from First Principles\nThe total heat flux vector, $\\boldsymbol{q}$, in a multicomponent mixture is the sum of the heat conduction flux (Fourier's law) and the flux of energy transported by diffusing species.\n$$ \\boldsymbol{q} = -k \\nabla T + \\sum_{i=1}^{N} h_i \\boldsymbol{j}_i $$\nwhere $k$ is the mixture thermal conductivity, $T$ is the temperature, $h_i$ is the specific enthalpy of species $i$, and $\\boldsymbol{j}_i$ is the diffusive mass flux vector of species $i$.\n\nThe first term, $\\boldsymbol{q}_{\\mathrm{Fourier}} = -k \\nabla T$, represents the heat flux due to the temperature gradient, as described by Fourier's law.\n\nThe second term, $\\sum_{i=1}^{N} h_i \\boldsymbol{j}_i$, represents the transport of enthalpy due to the relative motion of species. The problem asks for the \"Dufour heat flux\". In the context of irreversible thermodynamics, the Dufour effect is the heat flux generated by a concentration gradient, which is the Onsager reciprocal of the Soret effect (mass flux generated by a temperature gradient). The problem explicitly states to neglect the Soret effect. Due to Onsager reciprocity, neglecting the Soret effect implies that the rigorous Dufour effect must also be zero. Therefore, the problem's use of \"Dufour heat flux\" must refer to the entire energy transport term associated with mass diffusion, $\\sum h_i \\boldsymbol{j}_i$, as is common practice in many engineering combustion models. We define $\\boldsymbol{q}_{\\mathrm{Dufour}} \\equiv \\sum_{i=1}^{N} h_i \\boldsymbol{j}_i$.\n\nFor a binary mixture of hydrogen (species $1$) and nitrogen (species $2$), the sum becomes:\n$$ \\boldsymbol{q}_{\\mathrm{Dufour}} = h_1 \\boldsymbol{j}_1 + h_2 \\boldsymbol{j}_2 $$\nBy definition of diffusive mass fluxes, their sum is zero: $\\boldsymbol{j}_1 + \\boldsymbol{j}_2 = 0$, which implies $\\boldsymbol{j}_2 = -\\boldsymbol{j}_1$. Substituting this into the expression gives:\n$$ \\boldsymbol{q}_{\\mathrm{Dufour}} = h_1 \\boldsymbol{j}_1 - h_2 \\boldsymbol{j}_1 = (h_1 - h_2) \\boldsymbol{j}_1 $$\nThe diffusive mass flux $\\boldsymbol{j}_1$ is related to the gradient of the mass fraction $Y_1$ by Fick's law. Since thermal diffusion (Soret effect) and pressure diffusion are neglected, Fick's law for a binary mixture simplifies to:\n$$ \\boldsymbol{j}_1 = -\\rho D_{12} \\nabla Y_1 $$\nwhere $\\rho$ is the mixture density and $D_{12}$ is the binary diffusion coefficient.\nSubstituting this into the expression for $\\boldsymbol{q}_{\\mathrm{Dufour}}$:\n$$ \\boldsymbol{q}_{\\mathrm{Dufour}} = -(h_1 - h_2) \\rho D_{12} \\nabla Y_1 $$\n\nStep 3: Calculation of Heat Flux Magnitudes\nThe magnitude of the Fourier heat flux is:\n$$ |\\boldsymbol{q}_{\\mathrm{Fourier}}| = k |\\nabla T| $$\nThe magnitude of the Dufour heat flux is:\n$$ |\\boldsymbol{q}_{\\mathrm{Dufour}}| = |h_1 - h_2| \\rho D_{12} |\\nabla Y_1| $$\n\nTo evaluate $|h_1 - h_2|$, we first find the specific enthalpies. The sensible enthalpy of a species $i$ is given by $h_i(T) = \\int_{T_{\\mathrm{ref}}}^T c_{p,i}(T') dT'$, where $c_{p,i}$ is the specific heat at constant pressure. Since standard enthalpies of formation for $\\mathrm{H_2}$ and $\\mathrm{N_2}$ are zero, they do not contribute to the enthalpy difference. The problem provides constant molar heat capacities, $c_{p,m,i}$. The specific heat is $c_{p,i} = c_{p,m,i} / M_i$.\nWith constant specific heats, the enthalpy difference is:\n$$ h_1 - h_2 = (c_{p,1} - c_{p,2})(T - T_{\\mathrm{ref}}) = \\left(\\frac{c_{p,m,1}}{M_1} - \\frac{c_{p,m,2}}{M_2}\\right)(T - T_{\\mathrm{ref}}) $$\nLet species $1$ be $\\mathrm{H_2}$ and species $2$ be $\\mathrm{N_2}$.\n\nStep 4: Numerical Computation\nFirst, calculate the specific heat capacities:\n$$ c_{p,\\mathrm{H_2}} = \\frac{c_{p,m,\\mathrm{H_2}}}{M_{\\mathrm{H_2}}} = \\frac{29.1\\ \\mathrm{J/(mol\\cdot K)}}{2.016 \\times 10^{-3}\\ \\mathrm{kg/mol}} \\approx 14434.52\\ \\mathrm{J/(kg\\cdot K)} $$\n$$ c_{p,\\mathrm{N_2}} = \\frac{c_{p,m,\\mathrm{N_2}}}{M_{\\mathrm{N_2}}} = \\frac{35.7\\ \\mathrm{J/(mol\\cdot K)}}{28.0134 \\times 10^{-3}\\ \\mathrm{kg/mol}} \\approx 1274.39\\ \\mathrm{J/(kg\\cdot K)} $$\nThe difference in specific heats is:\n$$ c_{p,\\mathrm{H_2}} - c_{p,\\mathrm{N_2}} \\approx 14434.52 - 1274.39 = 13160.13\\ \\mathrm{J/(kg\\cdot K)} $$\nThe temperature difference is:\n$$ T - T_{\\mathrm{ref}} = 1500\\ \\mathrm{K} - 300\\ \\mathrm{K} = 1200\\ \\mathrm{K} $$\nThe enthalpy difference is:\n$$ h_{\\mathrm{H_2}} - h_{\\mathrm{N_2}} \\approx (13160.13\\ \\mathrm{J/(kg\\cdot K)}) \\times (1200\\ \\mathrm{K}) = 15792156\\ \\mathrm{J/kg} $$\n\nNow, compute the magnitude of each heat flux:\n$$ |\\boldsymbol{q}_{\\mathrm{Fourier}}| = (0.22\\ \\mathrm{W/(m\\cdot K)}) \\times (1.8 \\times 10^{6}\\ \\mathrm{K/m}) = 396000\\ \\mathrm{W/m^2} $$\n$$ |\\boldsymbol{q}_{\\mathrm{Dufour}}| = (15792156\\ \\mathrm{J/kg}) \\times (0.20\\ \\mathrm{kg/m^3}) \\times (2.5 \\times 10^{-4}\\ \\mathrm{m^2/s}) \\times (1.2 \\times 10^{3}\\ \\mathrm{m^{-1}}) $$\n$$ |\\boldsymbol{q}_{\\mathrm{Dufour}}| = 15792156 \\times 0.20 \\times 0.3 = 947529.36\\ \\mathrm{W/m^2} $$\n\nStep 5: Compute the Ratio\nThe required ratio is:\n$$ R = \\frac{|\\boldsymbol{q}_{\\mathrm{Dufour}}|}{|\\boldsymbol{q}_{\\mathrm{Fourier}}|} = \\frac{947529.36}{396000} \\approx 2.39275 $$\nRounding to three significant figures, we get:\n$$ R \\approx 2.39 $$\nThis result, being greater than $1$, highlights that for mixtures with light species like hydrogen, energy transport by mass diffusion can be more significant than thermal conduction. This is a key feature of hydrogen combustion.",
            "answer": "$$\n\\boxed{2.39}\n$$"
        },
        {
            "introduction": "Analytical solutions are rare for realistic combustion problems, making numerical methods essential. However, how can we trust our code? This hands-on coding exercise introduces the Method of Manufactured Solutions (MMS), a powerful technique for verifying the accuracy of a numerical solver. You will implement a discretization for the heat conduction equation and use MMS to rigorously confirm its theoretical order of accuracy, building a foundational skill for any computational scientist .",
            "id": "4028167",
            "problem": "Consider steady one-dimensional heat conduction in a quiescent gas with spatially varying thermal conductivity. Begin from the conservation of energy and Fourier’s law of heat conduction. The base equations are: (i) conservation of energy in steady state in one dimension, $\\dfrac{d q_x}{d x} + S(x) = 0$, where $q_x$ is the conductive heat flux and $S(x)$ is a volumetric heat source, and (ii) Fourier’s law $q_x = - k(x) \\dfrac{d T}{d x}$, where $k(x)$ is the thermal conductivity and $T(x)$ is the temperature field. Eliminating $q_x$ yields the second-order differential operator for conduction, $\\dfrac{d}{d x} \\left( k(x) \\dfrac{d T}{d x} \\right) = S(x)$. You will use the Method of Manufactured Solutions (MMS) to verify second-order accuracy of a conservative discretization of this operator on curvilinear grids with a spatially varying $k(x)$, a scenario common in computational combustion where gas properties depend on position or temperature.\n\nManufacture a smooth exact solution and conductivity:\n- Temperature: $T_{\\text{ex}}(x) = \\sin\\!\\left( 2 \\pi x \\right) + x^2$ for $x \\in [0,1]$.\n- Conductivity: $k(x) = 1 + \\dfrac{1}{2} \\sin\\!\\left( 2 \\pi x \\right)$.\n\nFrom the governing equation, the exact source term must be $S(x) = \\dfrac{d}{d x} \\left( k(x) \\dfrac{d T_{\\text{ex}}}{d x} \\right)$, which is to be derived analytically from the chosen $T_{\\text{ex}}(x)$ and $k(x)$.\n\nTo test curvilinear effects, define a computational coordinate $\\xi \\in [0,1]$ with mappings $x(\\xi)$ and Jacobian $J(\\xi) = \\dfrac{d x}{d \\xi}$:\n- Case A (uniform grid): $x(\\xi) = \\xi$, $J(\\xi) = 1$.\n- Case B (mild sinusoidal stretching): $x(\\xi) = \\xi + \\dfrac{a}{2\\pi} \\sin\\!\\left( 2 \\pi \\xi \\right)$ with $a = 0.3$, so $J(\\xi) = 1 + a \\cos\\!\\left( 2 \\pi \\xi \\right)$.\n- Case C (stronger oscillatory stretching): $x(\\xi) = \\xi + \\dfrac{a}{2\\pi} \\sin\\!\\left( 4 \\pi \\xi \\right)$ with $a = 0.4$, so $J(\\xi) = 1 + 2 a \\cos\\!\\left( 4 \\pi \\xi \\right)$.\n\nUsing the chain rule, the strong form of the conduction operator in the computational coordinate must be derived from first principles. Show that it has the structure\n$\\dfrac{d}{d x} \\left( k(x) \\dfrac{d T}{d x} \\right) = \\dfrac{1}{J(\\xi)} \\dfrac{d}{d \\xi} \\left( \\dfrac{k(x(\\xi))}{J(\\xi)} \\dfrac{d T}{d \\xi} \\right)$.\nOn a uniform grid in $\\xi$ of $N$ nodes with spacing $\\Delta \\xi = \\dfrac{1}{N-1}$, construct a conservative, second-order accurate discretization based on flux differences that is consistent with this divergence form and uses centered differences and centered face interpolation of the composite coefficient. Apply this discrete operator to the exact temperature sampled at the grid nodes, and compare against the exact $S(x)$ evaluated at the corresponding physical locations $x(\\xi)$.\n\nTo assess accuracy, compute the discrete $\\mathcal{L}^2$ error over interior nodes $i = 1,\\dots,N-2$ using quadrature weights corresponding to physical cell sizes. If $e_i$ denotes the pointwise difference between the discrete operator applied to the exact temperature and the exact source at node $i$, and if $\\Delta x_{i\\pm \\frac{1}{2}} = x_{i\\pm 1} - x_i$, define the nodal weight $w_i = \\dfrac{1}{2} \\left( \\Delta x_{i+\\frac{1}{2}} + \\Delta x_{i-\\frac{1}{2}} \\right)$ and the error norm $E = \\sqrt{ \\sum_{i=1}^{N-2} e_i^2 \\, w_i }$. Let the refinement parameter be $h = \\Delta \\xi$. Using three or more refinements, estimate the observed order of accuracy $p$ by a least-squares fit of $\\log E$ versus $\\log h$.\n\nImplement the Method of Manufactured Solutions (MMS) verification with the following test suite:\n- Grid sizes $N \\in \\{ 33, 65, 129, 257 \\}$, so that $h \\in \\left\\{ \\dfrac{1}{32}, \\dfrac{1}{64}, \\dfrac{1}{128}, \\dfrac{1}{256} \\right\\}$.\n- Mapping cases: Case A, Case B, and Case C as defined above.\n\nFor each mapping case, compute the observed order $p$ from the sequence of errors across the specified $N$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC]\"), where each entry is the observed order $p$ for the corresponding mapping case, rounded to six decimal places. The outputs are dimensionless numbers, so no physical units are required. Angles must be interpreted in radians. Percentages must not be used; any fraction must be expressed as a decimal number.",
            "solution": "The task is to verify the second-order accuracy of a conservative finite-difference discretization for the one-dimensional heat conduction equation with spatially varying thermal conductivity on curvilinear grids. This verification will be performed using the Method of Manufactured Solutions (MMS). The process involves several steps: deriving an exact source term from a manufactured solution, transforming the governing equation into a computational coordinate system, discretizing the transformed operator, and finally, measuring the convergence rate of the numerical error under grid refinement.\n\nThe governing equation in physical space $x$ is given by the conservation of energy:\n$$\n\\dfrac{d}{d x} \\left( k(x) \\dfrac{d T}{d x} \\right) = S(x)\n$$\nwhere $T(x)$ is the temperature, $k(x)$ is the thermal conductivity, and $S(x)$ is a volumetric heat source term.\n\nFirst, we establish the analytical foundation for the MMS test.\n\n**1. Manufactured Solution and Exact Source Term Derivation**\n\nWe are given a manufactured temperature field and a spatially varying thermal conductivity on the domain $x \\in [0,1]$:\n- Temperature: $T_{\\text{ex}}(x) = \\sin(2 \\pi x) + x^2$\n- Conductivity: $k(x) = 1 + \\dfrac{1}{2} \\sin(2 \\pi x)$\n\nTo ensure these functions satisfy the governing equation, we must derive the corresponding exact source term $S_{\\text{ex}}(x) = \\frac{d}{dx} \\left( k(x) \\frac{d T_{\\text{ex}}}{dx} \\right)$.\n\nFirst, we compute the temperature gradient:\n$$\n\\dfrac{d T_{\\text{ex}}}{d x} = \\dfrac{d}{d x} \\left( \\sin(2 \\pi x) + x^2 \\right) = 2 \\pi \\cos(2 \\pi x) + 2x\n$$\nNext, we multiply by the conductivity $k(x)$ to get the negative of the heat flux, $-q_x(x)$:\n$$\nk(x) \\dfrac{d T_{\\text{ex}}}{d x} = \\left( 1 + \\dfrac{1}{2} \\sin(2 \\pi x) \\right) \\left( 2 \\pi \\cos(2 \\pi x) + 2x \\right)\n$$\nFinally, we differentiate this product with respect to $x$ to find $S_{\\text{ex}}(x)$:\n$$\nS_{\\text{ex}}(x) = \\dfrac{d}{d x} \\left[ \\left( 1 + \\dfrac{1}{2} \\sin(2 \\pi x) \\right) \\left( 2 \\pi \\cos(2 \\pi x) + 2x \\right) \\right]\n$$\nUsing the product rule $(uv)' = u'v + uv'$ with $u(x) = 1 + \\frac{1}{2}\\sin(2\\pi x)$ and $v(x) = 2\\pi\\cos(2\\pi x) + 2x$:\n$$\n\\begin{aligned}\nu'(x) &= \\pi \\cos(2 \\pi x) \\\\\nv'(x) &= -4 \\pi^2 \\sin(2 \\pi x) + 2\n\\end{aligned}\n$$\nSo, the source term is:\n$$\n\\begin{aligned}\nS_{\\text{ex}}(x) &= \\left( \\pi \\cos(2 \\pi x) \\right) \\left( 2 \\pi \\cos(2 \\pi x) + 2x \\right) + \\left( 1 + \\dfrac{1}{2} \\sin(2 \\pi x) \\right) \\left( -4 \\pi^2 \\sin(2 \\pi x) + 2 \\right) \\\\\n&= 2 \\pi^2 \\cos^2(2 \\pi x) + 2 \\pi x \\cos(2 \\pi x) - 4 \\pi^2 \\sin(2 \\pi x) + 2 - 2 \\pi^2 \\sin^2(2 \\pi x) + \\sin(2 \\pi x) \\\\\n&= 2 \\pi^2 \\left( \\cos^2(2 \\pi x) - \\sin^2(2 \\pi x) \\right) + 2 \\pi x \\cos(2 \\pi x) + (1 - 4 \\pi^2) \\sin(2 \\pi x) + 2\n\\end{aligned}\n$$\nUsing the double angle identity $\\cos(2\\theta) = \\cos^2\\theta - \\sin^2\\theta$, we obtain the final analytical expression for the source term:\n$$\nS_{\\text{ex}}(x) = 2 \\pi^2 \\cos(4 \\pi x) + 2 \\pi x \\cos(2 \\pi x) + (1 - 4 \\pi^2) \\sin(2 \\pi x) + 2\n$$\nThis analytical source term will serve as the benchmark against which our numerical approximation is compared.\n\n**2. Coordinate Transformation**\nTo handle curvilinear grids, we introduce a mapping from a uniform computational coordinate $\\xi \\in [0,1]$ to the physical coordinate $x \\in [0,1]$, denoted by $x(\\xi)$. The Jacobian of this transformation is $J(\\xi) = \\frac{dx}{d\\xi}$. Using the chain rule, the spatial derivative operator transforms as:\n$$\n\\dfrac{d}{dx} = \\dfrac{d\\xi}{dx} \\dfrac{d}{d\\xi} = \\dfrac{1}{J(\\xi)} \\dfrac{d}{d\\xi}\n$$\nApplying this to the governing equation:\n$$\n\\dfrac{1}{J(\\xi)} \\dfrac{d}{d\\xi} \\left( k(x(\\xi)) \\left[ \\dfrac{1}{J(\\xi)} \\dfrac{dT}{d\\xi} \\right] \\right) = S(x(\\xi))\n$$\nThis simplifies to the strong conservation law form in the computational coordinate:\n$$\n\\dfrac{1}{J(\\xi)} \\dfrac{d}{d\\xi} \\left( \\dfrac{k(x(\\xi))}{J(\\xi)} \\dfrac{dT}{d\\xi} \\right) = S(x(\\xi))\n$$\nThis is the equation we will discretize.\n\n**3. Numerical Discretization**\nWe discretize the domain $\\xi \\in [0,1]$ using $N$ nodes, creating a uniform grid $\\xi_i = i \\Delta\\xi$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $\\Delta\\xi = \\frac{1}{N-1}$. The physical grid nodes are $x_i = x(\\xi_i)$.\n\nThe operator $L(T) = \\frac{1}{J} \\frac{d}{d\\xi} \\left( \\Gamma(\\xi) \\frac{dT}{d\\xi} \\right)$, where $\\Gamma(\\xi) = \\frac{k(x(\\xi))}{J(\\xi)}$, is discretized at each interior node $\\xi_i$ ($i=1, \\dots, N-2$) using a second-order accurate conservative finite-difference scheme. The divergence form suggests approximating the outer derivative using flux differences at cell faces, located at $\\xi_{i \\pm 1/2}$:\n$$\n\\left[ \\dfrac{d}{d\\xi} \\left( \\Gamma \\dfrac{dT}{d\\xi} \\right) \\right]_i \\approx \\dfrac{1}{\\Delta\\xi} \\left[ \\left( \\Gamma \\dfrac{dT}{d\\xi} \\right)_{i+1/2} - \\left( \\Gamma \\dfrac{dT}{d\\xi} \\right)_{i-1/2} \\right]\n$$\nThe terms at the cell faces are approximated using centered differences for the gradient and centered interpolation for the coefficient $\\Gamma$, as specified:\n- Flux at face $i+1/2$: $\\left( \\Gamma \\dfrac{dT}{d\\xi} \\right)_{i+1/2} \\approx \\Gamma_{i+1/2} \\left( \\dfrac{T_{i+1} - T_i}{\\Delta\\xi} \\right)$\n- Flux at face $i-1/2$: $\\left( \\Gamma \\dfrac{dT}{d\\xi} \\right)_{i-1/2} \\approx \\Gamma_{i-1/2} \\left( \\dfrac{T_i - T_{i-1}}{\\Delta\\xi} \\right)$\n- Interfacial coefficient: $\\Gamma_{i \\pm 1/2} \\approx \\dfrac{\\Gamma_i + \\Gamma_{i \\pm 1}}{2}$, where $\\Gamma_i = \\Gamma(\\xi_i)$.\n\nCombining these, the discrete operator $(L_h T)_i$ at node $i$ becomes:\n$$\n(L_h T)_i = \\dfrac{1}{J_i \\Delta\\xi} \\left[ \\left( \\dfrac{\\Gamma_{i+1}+\\Gamma_i}{2} \\right) \\left( \\dfrac{T_{i+1}-T_i}{\\Delta\\xi} \\right) - \\left( \\dfrac{\\Gamma_i+\\Gamma_{i-1}}{2} \\right) \\left( \\dfrac{T_i-T_{i-1}}{\\Delta\\xi} \\right) \\right]\n$$\n$$\n(L_h T)_i = \\dfrac{1}{2 J_i (\\Delta\\xi)^2} \\left[ (\\Gamma_{i+1}+\\Gamma_i)(T_{i+1}-T_i) - (\\Gamma_i+\\Gamma_{i-1})(T_i-T_{i-1}) \\right]\n$$\nwhere $J_i = J(\\xi_i)$, $\\Gamma_i = k(x_i)/J_i$, and $T_i = T(x_i)$.\n\n**4. Error Analysis and Order of Accuracy**\nThe purpose of the MMS is to compute the truncation error of the discretization. The pointwise error at node $i$ is the difference between the discrete operator acting on the exact solution and the exact source term evaluated at that node:\n$$\ne_i = (L_h T_{\\text{ex}})_i - S_{\\text{ex}}(x_i)\n$$\nWe quantify the total error using a discrete $\\mathcal{L}^2$ norm, which accounts for non-uniform cell sizes in physical space. The norm is defined as:\n$$\nE = \\sqrt{ \\sum_{i=1}^{N-2} e_i^2 w_i }\n$$\nThe summation is over all interior nodes. The quadrature weight $w_i$ represents the volume (or length in 1D) of the control volume associated with node $i$:\n$$\nw_i = \\dfrac{1}{2}((x_{i+1}-x_i) + (x_i-x_{i-1})) = \\dfrac{1}{2}(x_{i+1}-x_{i-1})\n$$\nThe theoretical convergence rate for a second-order scheme is given by $E \\approx C h^p$, where $h = \\Delta\\xi$ is the grid spacing parameter and $p$ is the order of accuracy. We expect $p \\approx 2$. To find the observed order of accuracy, we take the logarithm:\n$$\n\\log(E) \\approx \\log(C) + p \\log(h)\n$$\nThis shows a linear relationship between $\\log(E)$ and $\\log(h)$, where the slope is $p$. We compute the errors $E$ for a sequence of refined grids ($N \\in \\{33, 65, 129, 257\\}$) and then perform a linear least-squares fit to the points $(\\log(h_j), \\log(E_j))$ to determine the slope $p$.\n\nThe procedure is implemented for three grid mapping cases: a uniform grid (Case A), a mildly stretched grid (Case B), and a more strongly oscillated grid (Case C). The successful recovery of $p \\approx 2$ for all cases will verify that the chosen discretization is indeed second-order accurate on these curvilinear grids.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Method of Manufactured Solutions (MMS) to verify the second-order\n    accuracy of a finite-difference scheme for 1D heat conduction on\n    curvilinear grids.\n    \"\"\"\n\n    # --- 1. Define Analytical Functions & Test Cases ---\n\n    # Manufactured temperature solution\n    # T_ex(x) = sin(2*pi*x) + x^2\n    def t_ex(x):\n        return np.sin(2 * np.pi * x) + x**2\n\n    # Manufactured thermal conductivity\n    # k(x) = 1 + 0.5*sin(2*pi*x)\n    def k(x):\n        return 1.0 + 0.5 * np.sin(2 * np.pi * x)\n\n    # Exact source term S(x) derived from T_ex and k\n    # S(x) = 2*pi^2*cos(4*pi*x) + 2*pi*x*cos(2*pi*x) + (1-4*pi^2)*sin(2*pi*x) + 2\n    def s_ex(x):\n        pi2 = np.pi**2\n        term1 = 2 * pi2 * np.cos(4 * np.pi * x)\n        term2 = 2 * np.pi * x * np.cos(2 * np.pi * x)\n        term3 = (1 - 4 * pi2) * np.sin(2 * np.pi * x)\n        return term1 + term2 + term3 + 2.0\n\n    # Grid mapping cases from computational (xi) to physical (x) space\n    test_cases = [\n        {\n            \"name\": \"Case A: Uniform\",\n            \"x_map\": lambda xi: xi,\n            \"J_map\": lambda xi: np.ones_like(xi)\n        },\n        {\n            \"name\": \"Case B: Mild Sinusoidal Stretching\",\n            \"a\": 0.3,\n            \"x_map\": lambda xi, a=0.3: xi + (a / (2 * np.pi)) * np.sin(2 * np.pi * xi),\n            \"J_map\": lambda xi, a=0.3: 1 + a * np.cos(2 * np.pi * xi)\n        },\n        {\n            \"name\": \"Case C: Strong Oscillatory Stretching\",\n            \"a\": 0.4,\n            \"x_map\": lambda xi, a=0.4: xi + (a / (2 * np.pi)) * np.sin(4 * np.pi * xi),\n            \"J_map\": lambda xi, a=0.4: 1 + 2 * a * np.cos(4 * np.pi * xi)\n        }\n    ]\n\n    grid_sizes_N = [33, 65, 129, 257]\n    observed_orders = []\n\n    # --- 2. Main Loop for MMS Verification ---\n\n    for case in test_cases:\n        log_h_vals = []\n        log_E_vals = []\n\n        for N in grid_sizes_N:\n            # --- 2a. Grid and Data Generation ---\n            h = 1.0 / (N - 1)  # Grid spacing in computational space (delta_xi)\n            xi_nodes = np.linspace(0.0, 1.0, N)\n\n            # Map to physical grid and compute Jacobian\n            x_nodes = case[\"x_map\"](xi_nodes)\n            J_nodes = case[\"J_map\"](xi_nodes)\n\n            # Evaluate exact solution, properties, and source on the grid\n            T_ex_nodes = t_ex(x_nodes)\n            k_nodes = k(x_nodes)\n            S_ex_nodes = s_ex(x_nodes)\n            \n            # Composite coefficient Gamma = k(x)/J(xi)\n            Gamma_nodes = k_nodes / J_nodes\n\n            # --- 2b. Apply Discrete Operator ---\n            # We compute for interior nodes i = 1, ..., N-2\n            # Python slices are T[1:-1] for T_i, T[2:] for T_{i+1}, T[:-2] for T_{i-1}\n            J_interior = J_nodes[1:-1]\n            Gamma_interior = Gamma_nodes[1:-1]\n            Gamma_plus_1 = Gamma_nodes[2:]\n            Gamma_minus_1 = Gamma_nodes[:-2]\n            \n            T_interior = T_ex_nodes[1:-1]\n            T_plus_1 = T_ex_nodes[2:]\n            T_minus_1 = T_ex_nodes[:-2]\n\n            # The discrete operator L_h(T)\n            # 1/(2*J_i*h^2) * [ (G_{i+1}+G_i)(T_{i+1}-T_i) - (G_i+G_{i-1})(T_i-T_{i-1}) ]\n            term_plus = (Gamma_plus_1 + Gamma_interior) * (T_plus_1 - T_interior)\n            term_minus = (Gamma_interior + Gamma_minus_1) * (T_interior - T_minus_1)\n            \n            S_num_interior = (1.0 / (2.0 * J_interior * h**2)) * (term_plus - term_minus)\n\n            # --- 2c. Error Calculation ---\n            # Pointwise error\n            e_interior = S_num_interior - S_ex_nodes[1:-1]\n\n            # Quadrature weights for L2 norm\n            # w_i = 0.5 * (x_{i+1} - x_{i-1})\n            weights_interior = 0.5 * (x_nodes[2:] - x_nodes[:-2])\n            \n            # Discrete L2 error norm\n            error_norm_E = np.sqrt(np.sum(e_interior**2 * weights_interior))\n            \n            log_h_vals.append(np.log(h))\n            log_E_vals.append(np.log(error_norm_E))\n\n        # --- 2d. Compute Order of Accuracy ---\n        # Fit a line to (log(h), log(E)) points. The slope is the order p.\n        p, _ = np.polyfit(log_h_vals, log_E_vals, 1)\n        observed_orders.append(p)\n    \n    # --- 3. Format and Print Final Output ---\n    formatted_results = [f\"{p:.6f}\" for p in observed_orders]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}