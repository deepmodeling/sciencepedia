{
    "hands_on_practices": [
        {
            "introduction": "反应气体混合物的输运特性，如扩散，并非纯粹的经验值，而是源于分子层面的基本相互作用。本练习将指导您从第一性原理（Chapman-Enskog理论和Lennard-Jones势）出发，计算二元扩散系数，从而加深您对微观世界与宏观现象之间联系的理解。通过比较精确模型与简化模型，您还将体会到碰撞积分在输运理论中的关键作用。",
            "id": "4073507",
            "problem": "您的任务是利用气体动理论和 Chapman–Enskog 展开的原理，推导并实现一个用于稀薄反应气体混合物的二元扩散系数的计算模型。具体来说，考虑氢气 $\\mathrm{H_2}$ 和氮气 $\\mathrm{N_2}$ 这一对物质，它们各自的特征由 Lennard–Jones 参数描述：碰撞直径 $\\sigma$（单位为埃，Ångström）和除以 Boltzmann 常数的势阱深度 $\\epsilon/k_B$（单位为开尔文）。使用物理上合理的值，设列表参数为 $\\sigma_{\\mathrm{H_2}} = 2.827$ Å, $(\\epsilon/k_B)_{\\mathrm{H_2}} = 38.0$ K, $\\sigma_{\\mathrm{N_2}} = 3.621$ Å, 以及 $(\\epsilon/k_B)_{\\mathrm{N_2}} = 97.0$ K。采用二元相互作用的标准组合规则：$\\sigma_{\\mathrm{H_2,N_2}} = (\\sigma_{\\mathrm{H_2}} + \\sigma_{\\mathrm{N_2}})/2$ 和 $(\\epsilon/k_B)_{\\mathrm{H_2,N_2}} = \\sqrt{(\\epsilon/k_B)_{\\mathrm{H_2}} \\cdot (\\epsilon/k_B)_{\\mathrm{N_2}}}$。设摩尔质量为 $M_{\\mathrm{H_2}} = 2.01588$ g/mol 和 $M_{\\mathrm{N_2}} = 28.0134$ g/mol。\n\n从一个有效的理论基础出发，即专门针对二元稀薄气体的多组分扩散的 Maxwell–Stefan 描述，以及使用 Lennard–Jones $12$-$6$ 势的 Chapman–Enskog 一阶表达式，推导出二元扩散系数 $D_{\\mathrm{H_2,N_2}}(T,p)$ 作为绝对温度 $T$（单位为开尔文）和压力 $p$（单位为帕斯卡）的函数。您的推导必须基于定义和经过充分检验的事实，例如 Boltzmann 常数 $k_B$、Avogadro 数 $N_A$、折合质量以及与温度相关的扩散碰撞积分。不要使用任何预先提供的简化公式；相反，应在此框架内从第一性原理推导出可计算实现的表达式，并指明任何必要的量纲转换，以确保返回的 $D_{\\mathrm{H_2,N_2}}$ 单位为 $\\mathrm{m^2/s}$。\n\n对于 Lennard–Jones $12$-$6$ 势的扩散碰撞积分 $\\Omega_D$，设 $\\Omega_D$ 是约化温度 $T^\\star = T / ((\\epsilon/k_B)_{\\mathrm{H_2,N_2}})$ 的函数，并在参考实现中，假设使用 CHEMKIN（CHEMical KINetics 软件包）所使用的标准拟合。为了进行比较，还需实现一个 $\\Omega_D$ 的简化近似，只保留领头的逆幂项，并省略指数修正项。使用完整拟合和简化近似计算 $D_{\\mathrm{H_2,N_2}}(T,p)$ 的两个值，并求出它们的比值，以量化该近似与 CHEMKIN 式参考的偏差。\n\n物理单位要求：所有最终的扩散系数均以 $\\mathrm{m^2/s}$ 表示。输入压力以帕斯卡为单位；任何到其他单位（例如，大气压）的内部转换都必须明确且一致地处理。\n\n角度单位不适用于此问题。\n\n您的程序必须评估以下 $(T,p)$ 值的测试套件：\n- 测试用例 1（正常路径）：$T = 300.0$ K, $p = 101325.0$ Pa。\n- 测试用例 2（高温）：$T = 1000.0$ K, $p = 101325.0$ Pa。\n- 测试用例 3（高温高压）：$T = 1000.0$ K, $p = 10 \\times 101325.0$ Pa。\n- 测试用例 4（高温、亚大气压）：$T = 2500.0$ K, $p = 0.5 \\times 101325.0$ Pa。\n- 测试用例 5（低压边缘情况）：$T = 400.0$ K, $p = 1000.0$ Pa。\n\n对于每个测试用例，计算比率 $R = D_{\\mathrm{approx}}(T,p)/D_{\\mathrm{CHEMKIN}}(T,p)$，其中 $D_{\\mathrm{approx}}$ 使用扩散碰撞积分的简化近似，而 $D_{\\mathrm{CHEMKIN}}$ 使用扩散碰撞积分的完整 CHEMKIN 式拟合。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的比率列表（例如，“[r1,r2,r3,r4,r5]”），每个 $r_i$ 都是一个十进制浮点数。",
            "solution": "该问题要求基于 Chapman–Enskog 理论，为氢气 ($\\mathrm{H_2}$) 和氮气 ($\\mathrm{N_2}$) 的稀薄气体混合物推导并实现一个二元扩散系数 $D_{ij}$ 的模型。然后，我们必须计算该系数的简化近似值与基于标准 CHEMKIN 式碰撞积分拟合的更完整值之间的比率。\n\n### 第 1 步：问题陈述的验证\n\n在尝试解决方案之前，该问题需经过严格的验证过程。\n\n**1.1. 提取给定条件：**\n- **物质**：氢气 ($\\mathrm{H_2}$) 和氮气 ($\\mathrm{N_2}$)\n- **$\\mathrm{H_2}$ 的 Lennard-Jones 参数**：\n  - 碰撞直径：$\\sigma_{\\mathrm{H_2}} = 2.827$ Å\n  - 势阱深度参数：$(\\epsilon/k_B)_{\\mathrm{H_2}} = 38.0$ K\n- **$\\mathrm{N_2}$ 的 Lennard-Jones 参数**：\n  - 碰撞直径：$\\sigma_{\\mathrm{N_2}} = 3.621$ Å\n  - 势阱深度参数：$(\\epsilon/k_B)_{\\mathrm{N_2}} = 97.0$ K\n- **摩尔质量**：\n  - $M_{\\mathrm{H_2}} = 2.01588$ g/mol\n  - $M_{\\mathrm{N_2}} = 28.0134$ g/mol\n- **二元相互作用的组合规则**：\n  - $\\sigma_{\\mathrm{H_2,N_2}} = (\\sigma_{\\mathrm{H_2}} + \\sigma_{\\mathrm{N_2}})/2$\n  - $(\\epsilon/k_B)_{\\mathrm{H_2,N_2}} = \\sqrt{(\\epsilon/k_B)_{\\mathrm{H_2}} \\cdot (\\epsilon/k_B)_{\\mathrm{N_2}}}$\n- **理论框架**：使用 Lennard–Jones $12$-$6$ 势的二元扩散系数 $D_{\\mathrm{H_2,N_2}}(T,p)$ 的一阶 Chapman–Enskog 表达式。\n- **碰撞积分模型**：\n  - 基于标准 CHEMKIN 实现的、作为约化温度 $T^\\star$ 函数的扩散碰撞积分 $\\Omega_D$ 的完整拟合。\n  - 一个仅使用领头逆幂项的 $\\Omega_D$ 的简化近似。\n- **要求输出**：对于一组给定的测试用例，计算比率 $R = D_{\\mathrm{approx}}(T,p)/D_{\\mathrm{CHEMKIN}}(T,p)$。\n- **测试用例 $(T, p)$**：\n  1. $T = 300.0$ K, $p = 101325.0$ Pa。\n  2. $T = 1000.0$ K, $p = 101325.0$ Pa。\n  3. $T = 1000.0$ K, $p = 10 \\times 101325.0$ Pa。\n  4. $T = 2500.0$ K, $p = 0.5 \\times 101325.0$ Pa。\n  5. $T = 400.0$ K, $p = 1000.0$ Pa。\n\n**1.2. 根据标准进行验证：**\n- **科学依据**：该问题牢固地建立在气体动理论之上，这是物理化学和统计力学的基石。Chapman–Enskog 理论、Lennard-Jones 势及相关概念都是标准且科学合理的。提供的物理参数是现实的。\n- **良构性**：问题明确了所有必要的输入、物理模型（或对标准模型的引用，例如“CHEMKIN 式拟合”），以及一个明确定义的目标。这种结构允许为每个测试用例计算出唯一且有意义的数值结果。\n- **客观性**：问题以精确、技术性的语言陈述，没有歧义或主观性陈述。\n\n该问题没有明确指定“CHEMKIN 式拟合”的具体函数形式和系数。然而，这是燃烧和输运现象领域中一个标准且广泛发表的模型，可以合理地期望该领域的从业者知道或能够查阅到它。这被认为是预期的领域知识，而不是不完整性的缺陷。因此，该问题被认为是有效的。\n\n**1.3. 结论与行动：**\n问题有效。将提供解决方案。\n\n### 第 2 步：推导与算法设计\n\n主要目标是计算比率 $R = D_{\\mathrm{approx}}/D_{\\mathrm{CHEMKIN}}$。我们首先推导物质对 $i$ 和 $j$ 的二元扩散系数 $D_{ij}$ 的表达式。\n\n**2.1. 二元扩散系数的基本表达式**\n根据稀薄气体混合物通过 Lennard-Jones 势相互作用的一阶 Chapman–Enskog 理论，二元扩散系数 $D_{ij}$ 由以下公式给出：\n$$\nD_{ij} = \\frac{3}{16} \\frac{\\sqrt{2 \\pi k_B^3 T^3 / \\mu_{ij}}}{p \\pi \\sigma_{ij}^2 \\Omega_D(T_{ij}^*)}\n$$\n为确保输出的 $D_{ij}$ 以国际单位制（SI）单位（$\\mathrm{m^2/s}$）表示，所有输入量必须使用国际单位制基本单位：\n- $k_B$：Boltzmann 常数 ($1.380649 \\times 10^{-23}$ J/K)\n- $T$：绝对温度，单位为开尔文 (K)\n- $p$：绝对压力，单位为帕斯卡 (Pa)\n- $\\mu_{ij}$：相互作用对的折合质量，单位为千克 (kg)\n- $\\sigma_{ij}$：物质对的碰撞直径，单位为米 (m)\n- $\\Omega_D$：无量纲的扩散碰撞积分，是约化温度 $T_{ij}^*$ 的函数。\n\n**2.2. 相互作用参数的计算**\n物质 $i$ 和 $j$ 之间二元相互作用的参数，使用指定的组合规则从纯物质参数计算得出：\n- **碰撞直径**：$\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$\n- **势阱深度参数**：$(\\epsilon/k_B)_{ij} = \\sqrt{(\\epsilon/k_B)_i \\cdot (\\epsilon/k_B)_j}$\n\n所需的物质参数，转换为国际单位制单位后为：\n- $\\sigma_{\\mathrm{H_2}} = 2.827 \\times 10^{-10}$ m\n- $(\\epsilon/k_B)_{\\mathrm{H_2}} = 38.0$ K\n- $\\sigma_{\\mathrm{N_2}} = 3.621 \\times 10^{-10}$ m\n- $(\\epsilon/k_B)_{\\mathrm{N_2}} = 97.0$ K\n\n这产生了 H₂-N₂ 对的二元相互作用参数：\n- $\\sigma_{\\mathrm{H_2,N_2}} = (2.827 + 3.621)/2 \\times 10^{-10} = 3.224 \\times 10^{-10}$ m\n- $(\\epsilon/k_B)_{\\mathrm{H_2,N_2}} = \\sqrt{38.0 \\cdot 97.0} = \\sqrt{3686} \\approx 60.712$ K\n\n**2.3. 折合质量和约化温度**\n- **折合质量** $\\mu_{ij}$ 定义为 $\\mu_{ij} = (m_i m_j) / (m_i + m_j)$，其中 $m_i$ 是单个分子的质量，由摩尔质量 $M_i$ 和 Avogadro 数 $N_A$ ($6.02214076 \\times 10^{23}$ mol⁻¹) 计算得出，即 $m_i = M_i / N_A$。\n- **约化温度** $T_{ij}^*$ 是一个无量纲量，定义为 $T_{ij}^* = T / (\\epsilon/k_B)_{ij}$。\n\n**2.4. 碰撞积分模型**\n扩散碰撞积分 $\\Omega_D$ 修正了刚性球模型，以反映分子间力的真实性质。我们将为 $\\Omega_D(T_{ij}^*)$ 实现两个模型。\n\n- **CHEMKIN 式拟合 ($\\Omega_{D, \\text{CHEMKIN}}$)**：这是一个对 Lennard-Jones 势碰撞积分的列表值的标准经验拟合。\n$$\n\\Omega_{D, \\text{CHEMKIN}}(T^*) = \\frac{A}{(T^*)^B} + \\frac{C}{\\exp(D T^*)} + \\frac{E}{\\exp(F T^*)} + \\frac{G}{\\exp(H T^*)}\n$$\n其标准系数为：$A = 1.06036$, $B = 0.15610$, $C = 0.19300$, $D = 0.47635$, $E = 1.03587$, $F = 1.52996$, $G = 1.76474$, $H = 3.89411$。\n\n- **简化近似 ($\\Omega_{D, \\text{approx}}$)**：根据问题陈述，该模型仅保留完整拟合的领头逆幂项。\n$$\n\\Omega_{D, \\text{approx}}(T^*) = \\frac{A}{(T^*)^B} = \\frac{1.06036}{(T^*)^{0.15610}}\n$$\n\n**2.5. 比率 $R$ 的推导**\n问题要求计算比率 $R = D_{\\mathrm{approx}}/D_{\\mathrm{CHEMKIN}}$。我们定义一个预因子 $C(T, p)$，它包含 $D_{ij}$ 表达式中除碰撞积分外的所有项：\n$$\nC(T, p) = \\frac{3}{16} \\frac{\\sqrt{2 \\pi k_B^3 T^3 / \\mu_{\\mathrm{H_2,N_2}}}}{p \\pi \\sigma_{\\mathrm{H_2,N_2}}^2}\n$$\n然后，两种模型的扩散系数可以写成：\n- $D_{\\mathrm{CHEMKIN}}(T,p) = C(T, p) / \\Omega_{D, \\text{CHEMKIN}}(T_{\\mathrm{H_2,N_2}}^*)$\n- $D_{\\mathrm{approx}}(T,p) = C(T, p) / \\Omega_{D, \\text{approx}}(T_{\\mathrm{H_2,N_2}}^*)$\n\n因此，比率 $R$ 为：\n$$\nR = \\frac{D_{\\mathrm{approx}}(T,p)}{D_{\\mathrm{CHEMKIN}}(T,p)} = \\frac{C(T, p) / \\Omega_{D, \\text{approx}}(T_{\\mathrm{H_2,N_2}}^*)}{C(T, p) / \\Omega_{D, \\text{CHEMKIN}}(T_{\\mathrm{H_2,N_2}}^*)}\n$$\n预因子 $C(T, p)$ 被消去，从而得到一个显著的简化：\n$$\nR = \\frac{\\Omega_{D, \\text{CHEMKIN}}(T_{\\mathrm{H_2,N_2}}^*)}{\\Omega_{D, \\text{approx}}(T_{\\mathrm{H_2,N_2}}^*)}\n$$\n这个结果表明，比率 $R$ 仅依赖于温度 $T$（通过约化温度 $T^*$），而与压力 $p$、碰撞直径 $\\sigma_{\\mathrm{H_2,N_2}}$ 和折合质量 $\\mu_{\\mathrm{H_2,N_2}}$ 无关。\n\n**2.6. 计算算法**\n计算所需比率的算法如下：\n1. 定义物质参数 $(\\epsilon/k_B)_{\\mathrm{H_2}} = 38.0$ K 和 $(\\epsilon/k_B)_{\\mathrm{N_2}} = 97.0$ K。\n2. 计算二元相互作用参数 $(\\epsilon/k_B)_{\\mathrm{H_2,N_2}} = \\sqrt{38.0 \\cdot 97.0}$。\n3. 对于每个测试用例的温度 $T$：\n    a. 计算约化温度 $T^* = T / (\\epsilon/k_B)_{\\mathrm{H_2,N_2}}$。\n    b. 使用完整拟合表达式计算 $\\Omega_{D, \\text{CHEMKIN}}(T^*)$。\n    c. 使用简化表达式计算 $\\Omega_{D, \\text{approx}}(T^*)$。\n    d. 计算比率 $R = \\Omega_{D, \\text{CHEMKIN}}(T^*) / \\Omega_{D, \\text{approx}}(T^*)$。\n4. 收集所有计算出的比率，并将它们格式化为指定的输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of an approximated binary diffusion coefficient to a\n    CHEMKIN-style reference coefficient for a H2-N2 mixture.\n    The ratio R = D_approx / D_CHEMKIN simplifies to R = Omega_D_CHEMKIN / Omega_D_approx.\n    \"\"\"\n\n    # Lennard-Jones parameters (epsilon/kB in Kelvin)\n    # These are the only parameters needed to calculate the reduced temperature T*,\n    # which is the only variable in the final ratio calculation.\n    eps_k_h2 = 38.0  # K\n    eps_k_n2 = 97.0  # K\n\n    # Apply standard combining rule for the binary interaction well depth\n    eps_k_12 = np.sqrt(eps_k_h2 * eps_k_n2)\n\n    # Test cases: tuples of (Temperature in K, Pressure in Pa)\n    # The pressure is not needed for the ratio calculation but is kept for fidelity\n    # to the problem statement structure.\n    test_cases = [\n        (300.0, 101325.0),\n        (1000.0, 101325.0),\n        (1000.0, 10.0 * 101325.0),\n        (2500.0, 0.5 * 101325.0),\n        (400.0, 1000.0),\n    ]\n\n    # Coefficients for the standard CHEMKIN-style fit of the diffusion collision integral\n    # Omega_D(T*) = A/T*^B + C/exp(D*T*) + E/exp(F*T*) + G/exp(H*T*)\n    A = 1.06036\n    B = 0.15610\n    C = 0.19300\n    D = 0.47635\n    E = 1.03587\n    F = 1.52996\n    G = 1.76474\n    H = 3.89411\n\n    def omega_d_chemkin(t_star):\n        \"\"\"\n        Calculates the diffusion collision integral using the full CHEMKIN-style fit.\n        \"\"\"\n        term1 = A / (t_star**B)\n        term2 = C / np.exp(D * t_star)\n        term3 = E / np.exp(F * t_star)\n        term4 = G / np.exp(H * t_star)\n        return term1 + term2 + term3 + term4\n\n    def omega_d_approx(t_star):\n        \"\"\"\n        Calculates the diffusion collision integral using the simplified approximation\n        (leading inverse-power term only).\n        \"\"\"\n        return A / (t_star**B)\n\n    results = []\n    for temp, pressure in test_cases:\n        # Calculate the dimensionless reduced temperature T*\n        t_star = temp / eps_k_12\n\n        # Calculate the collision integral using both models\n        omega_chemkin_val = omega_d_chemkin(t_star)\n        omega_approx_val = omega_d_approx(t_star)\n\n        # The ratio R = D_approx / D_CHEMKIN simplifies to Omega_CHEMKIN / Omega_approx\n        ratio = omega_chemkin_val / omega_approx_val\n        results.append(ratio)\n\n    # Format the output as a comma-separated list of floating-point numbers\n    # enclosed in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在火焰等真实反应系统中，我们面对的是多组分混合物，而非纯净物。混合物的性质以一种非平凡的方式依赖于其组分的性质和浓度。本练习将演示如何使用广泛应用的半经验模型——Wilke法则，来估算多组分气体混合物的粘度。通过将其结果与简单的摩尔分数加权平均值进行比较，您将更深刻地理解分子间相互作用对混合物性质的决定性影响。",
            "id": "4073544",
            "problem": "一种代表高温下氢氧燃烧产物的、发生化学反应的理想气体混合物包含三种组分：氢分子 $\\mathrm{H_2}$、水蒸气 $\\mathrm{H_2O}$ 和氧分子 $\\mathrm{O_2}$。在均匀温度 $T = 1200\\,\\mathrm{K}$ 和压力 $p = 1\\,\\mathrm{atm}$下，瞬时摩尔分数分别为 $x_{\\mathrm{H_2}} = 0.15$，$x_{\\mathrm{H_2O}} = 0.55$ 和 $x_{\\mathrm{O_2}} = 0.30$。在温度 $T$ 下，各纯组分的动力粘度分别为 $\\mu_{\\mathrm{H_2}} = 4.40 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$，$\\mu_{\\mathrm{H_2O}} = 3.20 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$ 和 $\\mu_{\\mathrm{O_2}} = 4.00 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$。摩尔质量分别为 $M_{\\mathrm{H_2}} = 2.016\\,\\mathrm{g/mol}$，$M_{\\mathrm{H_2O}} = 18.015\\,\\mathrm{g/mol}$ 和 $M_{\\mathrm{O_2}} = 31.998\\,\\mathrm{g/mol}$。\n\n假设为理想气体混合物，只考虑双分子碰撞，并且除了对纯组分粘度的影响外，不考虑内部自由度的耦合。在多组分气体的标准 Wilke 混合粘度模型假设下，使用 Wilke 法则计算混合物粘度，并计算通过简单摩尔分数平均获得的简单加权粘度。然后求出无量纲比值 $R = \\mu_{\\text{Wilke}} / \\mu_{\\text{simple}}$。将最终报告的 $R$ 值四舍五入到四位有效数字。$R$ 不需要单位。",
            "solution": "用户要求使用两种不同的模型计算三组分气体混合物的粘度，然后计算所得粘度的比值。该问题定义明确且科学上合理，提供了执行计算所需的所有数据。\n\n气体混合物由三种组分组成，我们将其索引如下：\n$1 = \\mathrm{H_2}$ (氢分子)\n$2 = \\mathrm{H_2O}$ (水蒸气)\n$3 = \\mathrm{O_2}$ (氧分子)\n\n所提供的数据如下：\n温度 $T = 1200\\,\\mathrm{K}$ 和压力 $p = 1\\,\\mathrm{atm}$。\n摩尔分数：$x_1 = 0.15$，$x_2 = 0.55$，$x_3 = 0.30$。\n纯组分动力粘度：\n$\\mu_1 = 4.40 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n$\\mu_2 = 3.20 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n$\\mu_3 = 4.00 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n摩尔质量：\n$M_1 = 2.016\\,\\mathrm{g/mol}$\n$M_2 = 18.015\\,\\mathrm{g/mol}$\n$M_3 = 31.998\\,\\mathrm{g/mol}$\n\n首先，我们计算通过简单摩尔分数平均获得的简单加权粘度 $\\mu_{\\text{simple}}$。公式为：\n$$ \\mu_{\\text{simple}} = \\sum_{i=1}^{3} x_i \\mu_i = x_1 \\mu_1 + x_2 \\mu_2 + x_3 \\mu_3 $$\n代入给定值：\n$$ \\mu_{\\text{simple}} = (0.15)(4.40 \\times 10^{-5}) + (0.55)(3.20 \\times 10^{-5}) + (0.30)(4.00 \\times 10^{-5}) $$\n$$ \\mu_{\\text{simple}} = (0.66 \\times 10^{-5}) + (1.76 \\times 10^{-5}) + (1.20 \\times 10^{-5}) $$\n$$ \\mu_{\\text{simple}} = 3.620 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s} $$\n\n接下来，我们使用 Wilke 法则计算混合物粘度 $\\mu_{\\text{Wilke}}$。公式为：\n$$ \\mu_{\\text{Wilke}} = \\sum_{i=1}^{3} \\frac{x_i \\mu_i}{\\sum_{j=1}^{3} x_j \\Phi_{ij}} $$\n其中相互作用系数 $\\Phi_{ij}$ 定义为：\n$$ \\Phi_{ij} = \\frac{\\left[1 + \\left(\\frac{\\mu_i}{\\mu_j}\\right)^{1/2} \\left(\\frac{M_j}{M_i}\\right)^{1/4}\\right]^2}{\\sqrt{8} \\left(1 + \\frac{M_i}{M_j}\\right)^{1/2}} $$\n注意，当 $i=j$ 时，$\\Phi_{ii}=1$。我们必须计算 $i \\neq j$ 时的六个非对角系数 $\\Phi_{ij}$。\n\n计算 $\\Phi_{12}$ ($i=1, j=2$):\n$\\frac{M_1}{M_2} = \\frac{2.016}{18.015} \\approx 0.11191$, $\\frac{M_2}{M_1} = \\frac{18.015}{2.016} \\approx 8.9360$\n$\\frac{\\mu_1}{\\mu_2} = \\frac{4.40}{3.20} = 1.375$\n$$ \\Phi_{12} = \\frac{\\left[1 + \\left(1.375\\right)^{1/2} \\left(8.9360\\right)^{1/4}\\right]^2}{\\sqrt{8} \\left(1 + 0.11191\\right)^{1/2}} \\approx \\frac{\\left[1 + (1.1726)(1.7285)\\right]^2}{2.8284 \\left(1.0545\\right)} \\approx 3.0754 $$\n\n计算 $\\Phi_{21}$ ($i=2, j=1$):\n$\\frac{\\mu_2}{\\mu_1} = \\frac{3.20}{4.40} \\approx 0.72727$\n$$ \\Phi_{21} = \\frac{\\left[1 + \\left(0.72727\\right)^{1/2} \\left(0.11191\\right)^{1/4}\\right]^2}{\\sqrt{8} \\left(1 + 8.9360\\right)^{1/2}} \\approx \\frac{\\left[1 + (0.8528)(0.5785)\\right]^2}{2.8284 \\left(3.1521\\right)} \\approx 0.2500 $$\n\n计算 $\\Phi_{13}$ ($i=1, j=3$):\n$\\frac{M_1}{M_3} = \\frac{2.016}{31.998} \\approx 0.06300$, $\\frac{M_3}{M_1} = \\frac{31.998}{2.016} \\approx 15.872$\n$\\frac{\\mu_1}{\\mu_3} = \\frac{4.40}{4.00} = 1.10$\n$$ \\Phi_{13} = \\frac{\\left[1 + \\left(1.10\\right)^{1/2} \\left(15.872\\right)^{1/4}\\right]^2}{\\sqrt{8} \\left(1 + 0.06300\\right)^{1/2}} \\approx \\frac{\\left[1 + (1.0488)(1.9960)\\right]^2}{2.8284 \\left(1.0310\\right)} \\approx 3.2836 $$\n\n计算 $\\Phi_{31}$ ($i=3, j=1$):\n$\\frac{\\mu_3}{\\mu_1} = \\frac{4.00}{4.40} \\approx 0.90909$\n$$ \\Phi_{31} = \\frac{\\left[1 + \\left(0.90909\\right)^{1/2} \\left(0.06300\\right)^{1/4}\\right]^2}{\\sqrt{8} \\left(1 + 15.872\\right)^{1/2}} \\approx \\frac{\\left[1 + (0.9535)(0.5010)\\right]^2}{2.8284 \\left(4.1076\\right)} \\approx 0.1880 $$\n\n计算 $\\Phi_{23}$ ($i=2, j=3$):\n$\\frac{M_2}{M_3} = \\frac{18.015}{31.998} \\approx 0.5630$, $\\frac{M_3}{M_2} = \\frac{31.998}{18.015} \\approx 1.7762$\n$\\frac{\\mu_2}{\\mu_3} = \\frac{3.20}{4.00} = 0.80$\n$$ \\Phi_{23} = \\frac{\\left[1 + \\left(0.80\\right)^{1/2} \\left(1.7762\\right)^{1/4}\\right]^2}{\\sqrt{8} \\left(1 + 0.5630\\right)^{1/2}} \\approx \\frac{\\left[1 + (0.8944)(1.1543)\\right]^2}{2.8284 \\left(1.2502\\right)} \\approx 1.1685 $$\n\n计算 $\\Phi_{32}$ ($i=3, j=2$):\n$\\frac{\\mu_3}{\\mu_2} = \\frac{4.00}{3.20} = 1.25$\n$$ \\Phi_{32} = \\frac{\\left[1 + \\left(1.25\\right)^{1/2} \\left(0.5630\\right)^{1/4}\\right]^2}{\\sqrt{8} \\left(1 + 1.7762\\right)^{1/2}} \\approx \\frac{\\left[1 + (1.1180)(0.8661)\\right]^2}{2.8284 \\left(1.6662\\right)} \\approx 0.8212 $$\n\n现在，我们计算 Wilke 求和公式中的分母项 $\\phi_i = \\sum_{j=1}^{3} x_j \\Phi_{ij}$：\n$$ \\phi_1 = x_1 \\Phi_{11} + x_2 \\Phi_{12} + x_3 \\Phi_{13} = (0.15)(1) + (0.55)(3.0754) + (0.30)(3.2836) \\approx 2.8265 $$\n$$ \\phi_2 = x_1 \\Phi_{21} + x_2 \\Phi_{22} + x_3 \\Phi_{23} = (0.15)(0.2500) + (0.55)(1) + (0.30)(1.1685) \\approx 0.9381 $$\n$$ \\phi_3 = x_1 \\Phi_{31} + x_2 \\Phi_{32} + x_3 \\Phi_{33} = (0.15)(0.1880) + (0.55)(0.8212) + (0.30)(1) \\approx 0.7799 $$\n\n现在我们可以计算 $\\mu_{\\text{Wilke}}$：\n$$ \\mu_{\\text{Wilke}} = \\frac{x_1 \\mu_1}{\\phi_1} + \\frac{x_2 \\mu_2}{\\phi_2} + \\frac{x_3 \\mu_3}{\\phi_3} $$\n$$ \\mu_{\\text{Wilke}} = \\frac{0.15 \\times 4.40 \\times 10^{-5}}{2.8265} + \\frac{0.55 \\times 3.20 \\times 10^{-5}}{0.9381} + \\frac{0.30 \\times 4.00 \\times 10^{-5}}{0.7799} $$\n$$ \\mu_{\\text{Wilke}} = \\left( \\frac{0.66}{2.8265} + \\frac{1.76}{0.9381} + \\frac{1.20}{0.7799} \\right) \\times 10^{-5} $$\n$$ \\mu_{\\text{Wilke}} \\approx (0.23351 + 1.87613 + 1.53866) \\times 10^{-5} \\approx 3.6483 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s} $$\n\n最后，我们计算无量纲比值 $R = \\mu_{\\text{Wilke}} / \\mu_{\\text{simple}}$：\n$$ R = \\frac{3.6483 \\times 10^{-5}}{3.620 \\times 10^{-5}} \\approx 1.007817 $$\n将结果四舍五入到四位有效数字，得到：\n$$ R \\approx 1.008 $$\n这个结果表明，对于这种特定的混合物和条件，与更复杂的 Wilke 模型相比，简单的摩尔分数平均法低估了粘度不到 $1\\%$。",
            "answer": "$$\\boxed{1.008}$$"
        },
        {
            "introduction": "在火焰中，能量不仅通过热传导传递，还通过携带自身焓的化学物质的扩散来传递。理解质量输运和能量输运之间的耦合，对于精确模拟燃烧过程至关重要。本计算练习将要求您量化火焰区域内的扩散焓通量，并将其与传导热通量进行比较，从而具体地理解质量输运是如何直接影响火焰的能量平衡与结构的。",
            "id": "4073526",
            "problem": "给定一个多组分反应气体混合物的一维预混火焰场景。在忽略压力功、忽略杜福尔效应（热扩散能量通量）以及无辐射传热的假设下，穿过火焰的总能量通量简化为热传导和组分扩散的贡献。目标是针对指定条件，计算扩散焓通量，并评估其相对于传导的大小。\n\n从基本定义出发，组分 $k$ 的显比焓定义为\n$$\nh_k(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(T')\\, dT',\n$$\n其中 $T$ 是局部温度（单位：$\\mathrm{K}$），$T_{\\mathrm{ref}}$ 是参考温度（单位：$\\mathrm{K}$），$c_{p,k}(T)$ 是组分的定压比热（单位：$\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$）。假设每个组分的比热都与温度相关，并可用一个二次多项式建模：\n$$\nc_{p,k}(T) = a_k + b_k T + c_k T^2,\n$$\n其中 $(a_k,b_k,c_k)$ 是组分 $k$ 在所研究温度范围内的常数系数。\n\n扩散焓通量定义为\n$$\nq_{\\mathrm{diff}}(T,\\{J_k\\}) = \\sum_{k} h_k(T)\\, J_k,\n$$\n其中 $J_k$ 是组分 $k$ 的质量扩散通量（单位：$\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$），该通量相对于混合物的质量平均速度，因此满足 $\\sum_k J_k = 0$。传导热通量（傅里叶定律）为\n$$\nq_{\\mathrm{cond}} = -\\lambda\\, \\frac{\\partial T}{\\partial x},\n$$\n其中 $\\lambda$ 是热导率（单位：$\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$），$\\partial T/\\partial x$ 是温度梯度（单位：$\\mathrm{K}\\,\\mathrm{m}^{-1}$）。\n\n你的任务是实现一个程序，为测试套件中的每个测试用例计算：\n1. 使用 $c_{p,k}(T)$ 的多项式模型和积分定义，计算组分的显比焓 $h_k(T)$。使用 $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$。\n2. 扩散焓通量 $q_{\\mathrm{diff}}$（单位：$\\mathrm{W}\\,\\mathrm{m}^{-2}$）。\n3. 传导热通量的大小 $\\lvert q_{\\mathrm{cond}}\\rvert$（单位：$\\mathrm{W}\\,\\mathrm{m}^{-2}$）。\n4. 比率\n$$\nr = \\frac{\\lvert q_{\\mathrm{diff}}\\rvert}{\\lvert q_{\\mathrm{cond}}\\rvert}.\n$$\n\n将比率 $r$ 表示为四舍五入到四位小数的浮点数。如果 $\\lvert q_{\\mathrm{cond}}\\rvert = 0$ 且 $\\lvert q_{\\mathrm{diff}}\\rvert > 0$，则返回 IEEE 浮点无穷大值；如果 $\\lvert q_{\\mathrm{cond}}\\rvert = 0$ 且 $\\lvert q_{\\mathrm{diff}}\\rvert = 0$，则返回 $0.0$。\n\n使用以下组分集和比热多项式系数，其中 $a_k$ 的单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$b_k$ 的单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$，$c_k$ 的单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$：\n- 氢气 $\\mathrm{H_2}$：$a_{\\mathrm{H_2}} = 14000$，$b_{\\mathrm{H_2}} = 1.2$，$c_{\\mathrm{H_2}} = 1\\times 10^{-6}$。\n- 水蒸气 $\\mathrm{H_2O}$：$a_{\\mathrm{H_2O}} = 1900$，$b_{\\mathrm{H_2O}} = 0.5$，$c_{\\mathrm{H_2O}} = 1\\times 10^{-6}$。\n- 氧气 $\\mathrm{O_2}$：$a_{\\mathrm{O_2}} = 900$，$b_{\\mathrm{O_2}} = 0.2$，$c_{\\mathrm{O_2}} = 5\\times 10^{-7}$。\n- 氮气 $\\mathrm{N_2}$：$a_{\\mathrm{N_2}} = 1000$，$b_{\\mathrm{N_2}} = 0.2$，$c_{\\mathrm{N_2}} = 5\\times 10^{-7}$。\n- 二氧化碳 $\\mathrm{CO_2}$：$a_{\\mathrm{CO_2}} = 850$，$b_{\\mathrm{CO_2}} = 0.15$，$c_{\\mathrm{CO_2}} = 1\\times 10^{-6}$。\n\n使用以下测试用例套件。每个案例指定局部温度 $T$（单位：$\\mathrm{K}$）、一维温度梯度 $\\partial T/\\partial x$（单位：$\\mathrm{K}\\,\\mathrm{m}^{-1}$）、热导率 $\\lambda$（单位：$\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$）以及质量扩散通量矢量 $\\{J_k\\}$（单位：$\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$），顺序为 $[\\mathrm{H_2},\\mathrm{H_2O},\\mathrm{O_2},\\mathrm{N_2},\\mathrm{CO_2}]$：\n- 案例 1（代表性火焰区）：$T = 1800$，$\\partial T/\\partial x = 2.5\\times 10^{6}$，$\\lambda = 0.12$，$\\{J_k\\} = [0.004, 0.015, -0.008, -0.012, 0.001]$。\n- 案例 2（预热区，较低温度 $T$）：$T = 800$，$\\partial T/\\partial x = 1.5\\times 10^{6}$，$\\lambda = 0.09$，$\\{J_k\\} = [0.0045, 0.006, -0.004, -0.007, 0.0005]$。\n- 案例 3（靠近已燃气体，弱梯度）：$T = 2200$，$\\partial T/\\partial x = 1.0\\times 10^{5}$，$\\lambda = 0.10$，$\\{J_k\\} = [0.0012, 0.003, -0.002, -0.0025, 0.0003]$。\n- 案例 4（等温界面，零传导）：$T = 1500$，$\\partial T/\\partial x = 0$，$\\lambda = 0.12$，$\\{J_k\\} = [0.0018, 0.004, -0.003, -0.003, 0.0002]$。\n- 案例 5（强传导，中等扩散）：$T = 1700$，$\\partial T/\\partial x = 5.0\\times 10^{6}$，$\\lambda = 0.15$，$\\{J_k\\} = [0.003, 0.010, -0.007, -0.006, 0.0]$。\n\n你的程序应生成单行输出，其中包含五个案例的比率 $r$，格式为方括号内以逗号分隔的列表，有限值四舍五入到四位小数，顺序与测试案例相同（例如，$[r_1,r_2,r_3,r_4,r_5]$）。",
            "solution": "该问题要求在几个指定条件下，计算多组分气体混合物的扩散焓通量与传导热通量之比。解决方案的制定过程是：首先根据提供的基本定义推导出必要的解析表达式，然后实现一个数值算法来计算所需量。\n\n### 1. 比焓 $h_k(T)$ 的解析表达式\n显比焓 $h_k(T)$ 定义为定压比热 $c_{p,k}(T')$ 从参考温度 $T_{\\mathrm{ref}}$ 到局部温度 $T$ 的积分。比热由一个二次多项式给出：\n$$\nc_{p,k}(T') = a_k + b_k T' + c_k T'^2\n$$\n我们可以对该表达式进行解析积分，以获得 $h_k(T)$ 的闭式解：\n$$\nh_k(T) = \\int_{T_{\\mathrm{ref}}}^{T} (a_k + b_k T' + c_k T'^2) \\, dT'\n$$\n执行定积分可得：\n$$\nh_k(T) = \\left[ a_k T' + \\frac{b_k}{2} T'^2 + \\frac{c_k}{3} T'^3 \\right]_{T_{\\mathrm{ref}}}^{T}\n$$\n$$\nh_k(T) = \\left( a_k T + \\frac{b_k}{2} T^2 + \\frac{c_k}{3} T^3 \\right) - \\left( a_k T_{\\mathrm{ref}} + \\frac{b_k}{2} T_{\\mathrm{ref}}^2 + \\frac{c_k}{3} T_{\\mathrm{ref}}^3 \\right)\n$$\n在给定参考温度 $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$ 和各组分特定的多项式系数 $(a_k, b_k, c_k)$ 的情况下，此方程可用于直接计算任意组分 $k$ 在温度 $T$ 下的 $h_k(T)$。\n\n### 2. 通量及其比率的计算\n在建立 $h_k(T)$ 的表达式后，通过对每个组分的质量扩散通量 $J_k$ 所输运的焓求和，来计算扩散焓通量 $q_{\\mathrm{diff}}$：\n$$\nq_{\\mathrm{diff}} = \\sum_{k=1}^{N_s} h_k(T)\\, J_k\n$$\n其中 $N_s=5$ 是混合物中的组分数量。\n\n传导热通量 $q_{\\mathrm{cond}}$ 由傅里叶热传导定律给出：\n$$\nq_{\\mathrm{cond}} = -\\lambda\\, \\frac{\\partial T}{\\partial x}\n$$\n其中 $\\lambda$ 是热导率，$\\partial T/\\partial x$ 是局部温度梯度。\n\n最终目标是计算这两个通量大小的比率 $r$：\n$$\nr = \\frac{\\lvert q_{\\mathrm{diff}}\\rvert}{\\lvert q_{\\mathrm{cond}}\\rvert}\n$$\n\n### 3. 算法设计与实现\n每个测试用例的计算过程结构如下：\n\na. 对于一个案例，给定局部温度 $T$，使用步骤 1 中推导的解析公式为所有 $N_s=5$ 个组分计算显比焓矢量 $[h_1(T), \\dots, h_{N_s}(T)]$。\n\nb. 扩散焓通量 $q_{\\mathrm{diff}}$ 通过步骤 (a) 中得到的焓矢量与给定的质量扩散通量矢量 $[J_1, \\dots, J_{N_s}]$ 的标量（点）积来计算。\n\nc. 传导热通量 $q_{\\mathrm{cond}}$ 通过使用给定的 $\\lambda$ 和 $\\partial T/\\partial x$ 值直接相乘来计算。\n\nd. 比率 $r$ 通过取 $q_{\\mathrm{diff}}$ 和 $q_{\\mathrm{cond}}$ 绝对值的商来确定。问题中指定的特殊条件会进行显式处理：\n   - 如果 $\\lvert q_{\\mathrm{cond}}\\rvert = 0$ 且 $\\lvert q_{\\mathrm{diff}}\\rvert > 0$，则比率设为 IEEE 浮点无穷大。这种物理情况对应于通过扩散跨越一个等温平面（零传导）的有限焓输运。\n   - 如果 $\\lvert q_{\\mathrm{cond}}\\rvert = 0$ 且 $\\lvert q_{\\mathrm{diff}}\\rvert = 0$，则比率为 $0.0$。这表示两种输运机制都导致净能量通量为零的状态。\n   - 对于所有其他情况，比率是一个有限正数，按要求四舍五入到四位小数。\n\n利用 `NumPy` 库的矢量化实现对于解决此问题非常高效。它能够同时计算所有组分的焓，并使用单个矢量点积来计算扩散通量，从而形成一个简洁且高性能的算法。以下程序实现了这个明确定义的科学计算过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the ratio of diffusive enthalpy flux to conductive heat flux\n    for a series of test cases in a reacting gas mixture.\n    \"\"\"\n    # Define reference temperature as per the problem statement\n    T_ref = 298.0  # K\n\n    # Define species specific heat polynomial coefficients (a_k, b_k, c_k).\n    # Units: a_k [J/kg/K], b_k [J/kg/K^2], c_k [J/kg/K^3]\n    # The order of species is fixed: H2, H2O, O2, N2, CO2\n    species_coeffs = np.array([\n        [14000.0, 1.2,   1.0e-6],  # H2\n        [1900.0,  0.5,   1.0e-6],  # H2O\n        [900.0,   0.2,   5.0e-7],  # O2\n        [1000.0,  0.2,   5.0e-7],  # N2\n        [850.0,   0.15,  1.0e-6],  # CO2\n    ])\n\n    # Define the test suite. Each case is a tuple containing:\n    # T (K), grad_T (K/m), lambda (W/m/K), and the mass diffusion flux vector J_k (kg/m^2/s)\n    test_cases = [\n        (1800.0, 2.5e6, 0.12, np.array([0.004, 0.015, -0.008, -0.012, 0.001])),\n        (800.0,  1.5e6, 0.09, np.array([0.0045, 0.006, -0.004, -0.007, 0.0005])),\n        (2200.0, 1.0e5, 0.10, np.array([0.0012, 0.003, -0.002, -0.0025, 0.0003])),\n        (1500.0, 0.0,   0.12, np.array([0.0018, 0.004, -0.003, -0.003, 0.0002])),\n        (1700.0, 5.0e6, 0.15, np.array([0.003, 0.010, -0.007, -0.006, 0.0])),\n    ]\n\n    # Pre-calculate the integrated specific heat term at the reference temperature.\n    # This term, I(T_ref), is constant for all calculations.\n    # I(T) = a*T + (b/2)*T^2 + (c/3)*T^3\n    I_ref = (species_coeffs[:, 0] * T_ref +\n             species_coeffs[:, 1] / 2.0 * T_ref**2 +\n             species_coeffs[:, 2] / 3.0 * T_ref**3)\n\n    results = []\n    for T, grad_T, lambda_val, Jk_vector in test_cases:\n        # Step 1: Calculate the species sensible enthalpy h_k(T)\n        # h_k(T) = I(T) - I(T_ref)\n        I_T = (species_coeffs[:, 0] * T +\n               species_coeffs[:, 1] / 2.0 * T**2 +\n               species_coeffs[:, 2] / 3.0 * T**3)\n        h_k_vector = I_T - I_ref\n\n        # Step 2: Calculate the diffusive enthalpy flux q_diff\n        # q_diff = sum(h_k * J_k)\n        q_diff = np.dot(h_k_vector, Jk_vector)\n\n        # Step 3: Calculate the conductive heat flux q_cond\n        # q_cond = -lambda * (dT/dx)\n        q_cond = -lambda_val * grad_T\n\n        # Step 4: Calculate the ratio r with special case handling\n        abs_q_cond = abs(q_cond)\n        abs_q_diff = abs(q_diff)\n        \n        ratio = 0.0\n        if abs_q_cond == 0.0:\n            if abs_q_diff  0.0:\n                ratio = float('inf')\n            else:\n                # If both fluxes are zero, ratio is 0.0 as per problem statement\n                ratio = 0.0\n        else:\n            ratio = abs_q_diff / abs_q_cond\n\n        results.append(ratio)\n\n    # Format the final output string as specified\n    formatted_results = []\n    for r in results:\n        if r == float('inf'):\n            formatted_results.append('inf')\n        elif r == 0.0:\n            formatted_results.append('0.0')\n        else:\n            # Format finite, non-zero values to four decimal places\n            formatted_results.append(f\"{r:.4f}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}