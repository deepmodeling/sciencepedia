{
    "hands_on_practices": [
        {
            "introduction": "为建立坚实的理论基础，我们从一个经典的二元气体扩散案例入手。本练习探讨等摩尔反向扩散（equimolar counterdiffusion）这一情景，其中净摩尔通量为零，这使我们能够从 Stefan-Maxwell 框架中分离出类似 Fick 定律的扩散核心原理。通过计算各组分的通量和速度，你将亲身体验基本方程的应用，并验证该模型的关键理论特性 。",
            "id": "4067774",
            "problem": "考虑氧气 $\\mathrm{O}_2$ 和氮气 $\\mathrm{N}_2$ 在两个通过长度为 $L$ 的平面通道连接的大型等温、等压气库之间的稳态一维 (1D) 等摩尔反向扩散。气体混合物为理想气体，处于恒定温度 $T=900\\,\\mathrm{K}$ 和恒定压力 $p=1.01325\\times 10^5\\,\\mathrm{Pa}$。在这些条件下，$\\mathrm{O}_2$–$\\mathrm{N}_2$ 的二元 Stefan–Maxwell (S-M) 扩散系数为 $D_{\\mathrm{O}_2\\mathrm{N}_2}}=1.30\\times 10^{-4}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。在 $z=0$ 处，摩尔分数为 $x_{\\mathrm{O}_2}(0)=0.80$，在 $z=L=0.020\\,\\mathrm{m}$ 处，摩尔分数为 $x_{\\mathrm{O}_2}(L)=0.20$。假设无化学反应，忽略热扩散 (Soret 效应) 和压力扩散，并忽略任何外部施加的整体流动。\n\n使用 Stefan–Maxwell 扩散模型和第一性原理（理想气体定律、组分通量定义和组分连续性方程），推导相对于静止实验室坐标系的组分摩尔扩散通量 $J_{\\mathrm{O}_2}$ 和 $J_{\\mathrm{N}_2}$ 以及组分速度 $v_{\\mathrm{O}_2}(z)$ 和 $v_{\\mathrm{N}_2}(z)$。明确验证摩尔平均混合物速度 $\\mathbf{v}$ 处处为零，且 $\\sum_i \\mathbf{J}_i=\\mathbf{0}$。计算中间平面 $z=L/2$ 处的组分速度。\n\n最后，报告 $\\mathrm{O}_2$ 摩尔扩散通量 $J_{\\mathrm{O}_2}$ 的大小，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。将您的最终数值答案四舍五入到四位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   **过程：** 稳态、一维 (1D) 等摩尔反向扩散。\n-   **组分：** 氧气 ($\\mathrm{O}_2$) 和氮气 ($\\mathrm{N}_2$)。\n-   **几何：** 长度为 $L = 0.020\\,\\mathrm{m}$ 的平面通道。\n-   **热力学状态：** 理想气体混合物，恒定温度 $T=900\\,\\mathrm{K}$，恒定压力 $p=1.01325\\times 10^5\\,\\mathrm{Pa}$。\n-   **输运性质：** 二元 Stefan–Maxwell 扩散系数 $D_{\\mathrm{O}_2\\mathrm{N}_2}}=1.30\\times 10^{-4}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n-   **边界条件：**\n    -   在 $z=0$ 处：摩尔分数 $x_{\\mathrm{O}_2}(0)=0.80$。\n    -   在 $z=L$ 处：摩尔分数 $x_{\\mathrm{O}_2}(L)=0.20$。\n-   **假设：**\n    -   无化学反应。\n    -   忽略热扩散 (Soret 效应)。\n    -   忽略压力扩散。\n    -   忽略外部施加的整体流动。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题是二元气体扩散的经典例子，其原理牢固地植根于连续介质力学和输运现象。控制方程 Stefan–Maxwell 方程是该领域的基础。\n-   **适定性：** 该问题是一个稳态、一维的边值问题，具有明确定义的条件（恒定的温度、压力以及边界上的组分摩尔分数）。这种结构确保了唯一且稳定的解。\n-   **客观性：** 问题以精确、定量和无偏见的语言陈述。\n-   **完整性和一致性：** 问题提供了确定所求量所需的所有数据（T, p, L, D, 边界条件）。“等摩尔反向扩散”的假设与无净摩尔通量的等压、等温二元系统一致。\n-   **真实性和可行性：** 给定的物理参数（$T$, $p$, $L$, $D_{\\mathrm{O}_2\\mathrm{N}_2}}$）对于气相扩散研究是符合实际的。\n-   **整体结构：** 问题结构良好，不包含任何已列出的缺陷。它是化学工程和燃烧科学中的一个典型问题。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。现在开始求解过程。\n\n### 求解\n\n系统由无化学反应的稳态一维组分连续性方程描述，其形式为：\n$$\n\\frac{d N_i}{dz} = 0\n$$\n其中 $N_i$ 是组分 $i$ 相对于静止坐标系的摩尔通量。该方程意味着对于每个组分，$N_i$ 沿着通道长度 $z$ 是一个常数。问题涉及两种组分：氧气 ($\\mathrm{O}_2$) 和氮气 ($\\mathrm{N}_2$)。\n\n对于一维（$z$ 方向）的二元混合物，Stefan–Maxwell 方程将摩尔分数的梯度与组分摩尔通量联系起来：\n$$\n\\frac{dx_{\\mathrm{O}_2}}{dz} = \\frac{x_{\\mathrm{O}_2} N_{\\mathrm{N}_2} - x_{\\mathrm{N}_2} N_{\\mathrm{O}_2}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}\n$$\n其中 $c$ 是总摩尔浓度，$x_i$ 是组分 $i$ 的摩尔分数，$D_{\\mathrm{O}_2\\mathrm{N}_2}}$ 是二元扩散系数。由于气体混合物是理想的，且温度 $T$ 和压力 $p$ 恒定，因此由理想气体定律给出的总摩尔浓度 $c$ 也是恒定的：\n$$\nc = \\frac{p}{RT}\n$$\n其中 $R$ 是通用气体常数。\n\n问题指定为“等摩尔反向扩散”，这意味着净摩尔通量为零：\n$$\nN = N_{\\mathrm{O}_2} + N_{\\mathrm{N}_2} = 0\n$$\n这意味着两种组分的摩尔通量大小相等，方向相反：$N_{\\mathrm{N}_2}} = -N_{\\mathrm{O}_2}}$。\n\n将 $N_{\\mathrm{N}_2}} = -N_{\\mathrm{O}_2}}$ 和 $x_{\\mathrm{N}_2}} = 1 - x_{\\mathrm{O}_2}}$ 代入 Stefan-Maxwell 方程：\n$$\n\\frac{dx_{\\mathrm{O}_2}}{dz} = \\frac{x_{\\mathrm{O}_2} (-N_{\\mathrm{O}_2}) - (1 - x_{\\mathrm{O}_2}) N_{\\mathrm{O}_2}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}} = \\frac{-x_{\\mathrm{O}_2} N_{\\mathrm{O}_2} - N_{\\mathrm{O}_2} + x_{\\mathrm{O}_2} N_{\\mathrm{O}_2}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}} = \\frac{-N_{\\mathrm{O}_2}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}\n$$\n这等同于此特定情况下的 Fick 第一定律。我们可以重新整理以求解恒定的摩尔通量 $N_{\\mathrm{O}_2}}$：\n$$\nN_{\\mathrm{O}_2} = -c D_{\\mathrm{O}_2\\mathrm{N}_2}} \\frac{dx_{\\mathrm{O}_2}}{dz}\n$$\n由于 $N_{\\mathrm{O}_2}}$、$c$ 和 $D_{\\mathrm{O}_2\\mathrm{N}_2}}$ 都是常数，摩尔分数梯度 $dx_{\\mathrm{O}_2}/dz$ 也必须是常数。我们可以将此方程沿通道长度从 $z=0$ 到 $z=L$ 进行积分：\n$$\n\\int_0^L N_{\\mathrm{O}_2} dz = \\int_{x_{\\mathrm{O}_2}(0)}^{x_{\\mathrm{O}_2}(L)} -c D_{\\mathrm{O}_2\\mathrm{N}_2}} dx_{\\mathrm{O}_2}\n$$\n$$\nN_{\\mathrm{O}_2} L = -c D_{\\mathrm{O}_2\\mathrm{N}_2}} [x_{\\mathrm{O}_2}(L) - x_{\\mathrm{O}_2}(0)]\n$$\n$$\nN_{\\mathrm{O}_2} = \\frac{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}{L} [x_{\\mathrm{O}_2}(0) - x_{\\mathrm{O}_2}(L)]\n$$\n总摩尔通量 $N_i$ 是扩散通量 $J_i$（相对于摩尔平均速度）和对流通量之和：$N_i = J_i + x_i N$。由于等摩尔反向扩散时 $N=0$，总通量等于扩散通量：$N_i = J_i$。\n因此，组分摩尔扩散通量为：\n$$\nJ_{\\mathrm{O}_2} = \\frac{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}{L} [x_{\\mathrm{O}_2}(0) - x_{\\mathrm{O}_2}(L)]\n$$\n$$\nJ_{\\mathrm{N}_2} = N_{\\mathrm{N}_2} = -N_{\\mathrm{O}_2} = -J_{\\mathrm{O}_2}\n$$\n我们可以立即验证 $\\sum_i \\mathbf{J}_i = J_{\\mathrm{O}_2} + J_{\\mathrm{N}_2} = J_{\\mathrm{O}_2} - J_{\\mathrm{O}_2} = \\mathbf{0}$。\n\n组分速度 $v_i(z)$ 通过 $N_i = c_i v_i = c x_i v_i$ 与摩尔通量 $N_i$ 相关。因此：\n$$\nv_i(z) = \\frac{N_i}{c x_i(z)} = \\frac{J_i}{c x_i(z)}\n$$\n摩尔分数分布 $x_{\\mathrm{O}_2}(z)$ 是线性的，因为其梯度是常数：\n$$\nx_{\\mathrm{O}_2}(z) = x_{\\mathrm{O}_2}(0) + \\frac{x_{\\mathrm{O}_2}(L) - x_{\\mathrm{O}_2}(0)}{L} z\n$$\n且 $x_{\\mathrm{N}_2}(z) = 1 - x_{\\mathrm{O}_2}(z)$。\n因此，组分速度为：\n$$\nv_{\\mathrm{O}_2}(z) = \\frac{J_{\\mathrm{O}_2}} {c \\left( x_{\\mathrm{O}_2}(0) + \\frac{z}{L}(x_{\\mathrm{O}_2}(L) - x_{\\mathrm{O}_2}(0)) \\right)}\n$$\n$$\nv_{\\mathrm{N}_2}(z) = \\frac{J_{\\mathrm{N}_2}} {c \\left( 1 - \\left( x_{\\mathrm{O}_2}(0) + \\frac{z}{L}(x_{\\mathrm{O}_2}(L) - x_{\\mathrm{O}_2}(0)) \\right) \\right)}\n$$\n摩尔平均混合物速度 $\\mathbf{v}$ 定义为 $\\mathbf{v} = \\sum_i x_i \\mathbf{v}_i$。在一维情况下：\n$$\nv(z) = x_{\\mathrm{O}_2}(z) v_{\\mathrm{O}_2}(z) + x_{\\mathrm{N}_2}(z) v_{\\mathrm{N}_2}(z) = x_{\\mathrm{O}_2}(z) \\frac{N_{\\mathrm{O}_2}}{c x_{\\mathrm{O}_2}(z)} + x_{\\mathrm{N}_2}(z) \\frac{N_{\\mathrm{N}_2}}{c x_{\\mathrm{N}_2}(z)} = \\frac{N_{\\mathrm{O}_2} + N_{\\mathrm{N}_2}}{c} = \\frac{N}{c}\n$$\n由于等摩尔反向扩散时 $N=0$，因此摩尔平均速度 $v(z)=0$ 处处成立，符合要求。\n\n现在我们计算数值。通用气体常数为 $R \\approx 8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n总摩尔浓度：\n$$\nc = \\frac{p}{RT} = \\frac{1.01325 \\times 10^5\\,\\mathrm{Pa}}{(8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(900\\,\\mathrm{K})} \\approx 13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n氧气的摩尔通量：\n$$\nJ_{\\mathrm{O}_2} = \\frac{(13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})(1.30\\times 10^{-4}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1})}{0.020\\,\\mathrm{m}} (0.80 - 0.20)\n$$\n$$\nJ_{\\mathrm{O}_2} = (0.08801455\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1})(0.60) \\approx 0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\n其大小为 $|J_{\\mathrm{O}_2}}| \\approx 0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。四舍五入到四位有效数字，得到 $5.281 \\times 10^{-2}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n另外，$J_{\\mathrm{N}_2} = -J_{\\mathrm{O}_2} \\approx -0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n为求得中间平面 $z = L/2 = 0.010\\,\\mathrm{m}$ 处的速度，首先求该点的摩尔分数：\n$$\nx_{\\mathrm{O}_2}(L/2) = 0.80 + \\frac{0.010}{0.020}(0.20 - 0.80) = 0.80 + 0.5(-0.60) = 0.80 - 0.30 = 0.50\n$$\n$$\nx_{\\mathrm{N}_2}(L/2) = 1 - x_{\\mathrm{O}_2}(L/2) = 1 - 0.50 = 0.50\n$$\n现在计算 $z=L/2$ 处的组分速度：\n$$\nv_{\\mathrm{O}_2}(L/2) = \\frac{J_{\\mathrm{O}_2}}{c x_{\\mathrm{O}_2}(L/2)} = \\frac{0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}}{(13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})(0.50)} \\approx 0.0077999\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nv_{\\mathrm{N}_2}(L/2) = \\frac{J_{\\mathrm{N}_2}}{c x_{\\mathrm{N}_2}(L/2)} = \\frac{-0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}}{(13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})(0.50)} \\approx -0.0077999\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n推导和验证完成。最终要求的答案是 $\\mathrm{O}_2$ 摩尔扩散通量的大小。\n$|J_{\\mathrm{O}_2}}| \\approx 5.281 \\times 10^{-2}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\\boxed{5.281 \\times 10^{-2}}$$"
        },
        {
            "introduction": "真实的工程系统常涉及显著的压力和温度梯度，这些梯度会影响输运性质。本练习超越了简单的常数系数假设，研究了二元扩散系数的压力依赖性（$D_{ij} \\propto 1/p$）如何影响喷管流中的扩散通量。通过这个练习，你将提升分析能力，并揭示精确建模输运性质的至关重要性，特别是理解一个与直觉相悖的抵消效应，即对于理想气体，乘积 $c D_{ij}$ 与压力无关 。",
            "id": "4067754",
            "problem": "考虑氢气 $\\mathrm{H_2}$ (组分 $1$) 和水蒸气 $\\mathrm{H_2O}$ (组分 $2$) 的二元理想气体混合物通过一个收敛喷管的稳态一维流动。该混合物在温度 $T$ 下是等温的，且彻体力与热扩散可忽略不计。扩散摩尔通量是相对于摩尔平均速度测量的，因此 $\\sum_{i=1}^{2} \\mathbf{N}_{i} = \\mathbf{0}$。在固定温度下，二元扩散系数遵循一个经过充分检验的、与压力相关的动力学理论标度关系，即 $D_{12}(p) = D_{12,\\mathrm{ref}} \\, p_{\\mathrm{ref}}/p$。理想气体的总摩尔浓度为 $c = p/(R T)$，其中 $R$ 是普适气体常数。\n\n在喉部区域，$\\mathrm{H_2}$ 的轴向摩尔分数梯度近似均匀，等于 $\\nabla x_{1} = \\frac{d x_{1}}{d z} = 0.040 \\,\\mathrm{m}^{-1}$。参考扩散系数和参考压力分别为 $D_{12,\\mathrm{ref}} = 1.50 \\times 10^{-4} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ (在 $p_{\\mathrm{ref}} = 5.00 \\times 10^{5} \\,\\mathrm{Pa}$ 时)。喉部局部压力为 $p_{\\mathrm{t}} = 1.00 \\times 10^{5} \\,\\mathrm{Pa}$。温度为 $T = 1100 \\,\\mathrm{K}$。\n\n从二元混合物的 Maxwell–Stefan 扩散公式出发，推导以 $p$、$T$、$D_{12}(p)$ 和 $\\nabla x_{1}$ 表示的 $\\mathrm{H_2}$ 摩尔扩散通量 $\\mathbf{N}_{1}$ 的表达式，并解释当压力梯度 $\\nabla p$ 很大时，$D_{12}(p)$ 的压力依赖性如何改变喷管内的通量大小。然后，使用推导出的表达式，计算在喉部的有符号相对误差。计算时，假设将 $D_{12}$ 视为等于 $D_{12,\\mathrm{ref}}$ 的常数，同时使用局部的理想气体浓度 $c(p)$。将有符号相对误差定义为\n$$\n\\varepsilon \\equiv \\frac{|\\mathbf{N}_{1}|_{\\text{const } D} - |\\mathbf{N}_{1}|_{\\text{variable } D}}{|\\mathbf{N}_{1}|_{\\text{variable } D}}.\n$$\n将 $\\varepsilon$ 的最终答案表示为小数，并四舍五入到四位有效数字。$\\varepsilon$ 不需要单位。",
            "solution": "首先对问题的科学合理性、一致性和完整性进行验证。提取并检查已知条件。该问题设定是输运现象和燃烧科学中的一个标准情景，涉及二元理想气体混合物中的 Maxwell-Stefan 扩散。所提供的物理关系，如二元扩散系数的压力依赖性 ($D_{12} \\propto 1/p$) 和理想气体定律 ($c = p/(RT)$)，在根本上是正确的，并且已被动力学理论充分证实。数值对于高温气体流动系统是物理上合理的。该问题是良定的，有足够的信息来推导所需的表达式并计算指定的误差。因此，该问题被认为是有效的，有必要给出完整解答。\n\n解答过程按问题要求分为三部分：首先，推导摩尔扩散通量表达式；其次，解释压力依赖性扩散系数的作用；第三，计算指定的相对误差。\n\n**第1部分：摩尔扩散通量表达式的推导**\n\n在等温条件下且无彻体力时，针对一般多组分混合物的 Maxwell-Stefan 扩散方程由下式给出\n$$\n\\nabla x_i = \\sum_{j=1, j \\neq i}^{N_s} \\frac{x_i \\mathbf{N}_j - x_j \\mathbf{N}_i}{c D_{ij}}\n$$\n其中 $x_i$ 是组分 $i$ 的摩尔分数，$\\mathbf{N}_i$ 是组分 $i$ 相对于摩尔平均速度的摩尔扩散通量，$c$ 是总摩尔浓度，$D_{ij}$ 是组分对 $i-j$ 的二元扩散系数。\n\n对于 $\\mathrm{H_2}$ (组分 $1$) 和 $\\mathrm{H_2O}$ (组分 $2$) 的二元混合物，组分 $1$ 的方程为：\n$$\n\\nabla x_1 = \\frac{x_1 \\mathbf{N}_2 - x_2 \\mathbf{N}_1}{c D_{12}}\n$$\n问题陈述，扩散通量的定义使其总和为零：$\\sum_{i=1}^{2} \\mathbf{N}_{i} = \\mathbf{0}$。这意味着 $\\mathbf{N}_2 = -\\mathbf{N}_1$。将此关系代入 Maxwell-Stefan 方程，得到：\n$$\n\\nabla x_1 = \\frac{x_1 (-\\mathbf{N}_1) - x_2 \\mathbf{N}_1}{c D_{12}} = \\frac{-\\mathbf{N}_1(x_1 + x_2)}{c D_{12}}\n$$\n对于二元混合物，摩尔分数之和为1，$x_1 + x_2 = 1$。方程简化为：\n$$\n\\nabla x_1 = -\\frac{\\mathbf{N}_1}{c D_{12}}\n$$\n这是二元混合物扩散的菲克形式。对 $\\mathrm{H_2}$ 的摩尔扩散通量 $\\mathbf{N}_1$ 进行整理，我们得到：\n$$\n\\mathbf{N}_1 = -c D_{12} \\nabla x_1\n$$\n问题提供了总摩尔浓度的理想气体关系式 $c = p/(RT)$，其中 $p$ 是压力，$T$ 是温度，$R$ 是普适气体常数。将其代入 $\\mathbf{N}_1$ 的表达式，得到以指定变量表示的最终形式：\n$$\n\\mathbf{N}_1 = -\\frac{p}{RT} D_{12}(p) \\nabla x_1\n$$\n\n**第2部分：压力依赖性扩散系数的影响**\n\n为了理解 $D_{12}$ 的压力依赖性如何影响通量大小，我们将给定的标度关系 $D_{12}(p) = D_{12, \\mathrm{ref}} \\, p_{\\mathrm{ref}}/p$ 代入上面推导的通量大小表达式中：\n$$\n|\\mathbf{N}_1| = \\left| -\\frac{p}{RT} D_{12}(p) \\nabla x_1 \\right| = \\frac{p}{RT} \\left( D_{12, \\mathrm{ref}} \\frac{p_{\\mathrm{ref}}}{p} \\right) |\\nabla x_1|\n$$\n局部压力 $p$ 被消去，从而得出一个显著的结果：\n$$\n|\\mathbf{N}_1| = \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|\n$$\n这表明对于等温理想气体混合物，摩尔扩散通量的大小与局部压力无关。摩尔浓度与扩散系数的乘积 $c D_{12}$ 相对于压力是恒定的：\n$$\nc D_{12} = \\left(\\frac{p}{RT}\\right) \\left(D_{12, \\mathrm{ref}} \\frac{p_{\\mathrm{ref}}}{p}\\right) = \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} = \\text{常数}\n$$\n在收敛喷管中，当气体流向喉部时，压力 $p$ 会显著下降。如果错误地假设 $D_{12}$ 是一个常数（例如 $D_{12} = D_{12, \\mathrm{ref}}$），则通量大小模型将为 $|\\mathbf{N}_1|_{\\text{const } D} = \\frac{p}{RT} D_{12, \\mathrm{ref}} |\\nabla x_1|$。这个不正确的模型会预测通量大小与压力成正比，因此会沿喷管大幅减小。而正确的模型，包含了 $D_{12} \\propto 1/p$ 的依赖关系，揭示了由于压力下降引起的摩尔浓度 $c$ 的减小，被扩散系数 $D_{12}$ 的增加所精确补偿。因此，在强压力梯度 $\\nabla p$ 的区域，正确的模型预测通量大小近似恒定（假设 $T$ 和 $\\nabla x_1$ 恒定），而不正确的常数 $D_{12}$ 模型则会预测一个跟随压力剖面快速变化的通量。\n\n**第3部分：有符号相对误差的计算**\n\n有符号相对误差 $\\varepsilon$ 定义为：\n$$\n\\varepsilon \\equiv \\frac{|\\mathbf{N}_{1}|_{\\text{const } D} - |\\mathbf{N}_{1}|_{\\text{variable } D}}{|\\mathbf{N}_{1}|_{\\text{variable } D}}\n$$\n我们在喉部计算这两个通量的大小，此处的压力为 $p_t = 1.00 \\times 10^5 \\, \\mathrm{Pa}$，摩尔分数梯度为 $|\\nabla x_1| = 0.040 \\, \\mathrm{m}^{-1}$。\n\n正确的通量大小，使用可变扩散系数 $D_{12}(p_t) = D_{12, \\mathrm{ref}} \\, p_{\\mathrm{ref}}/p_t$，为：\n$$\n|\\mathbf{N}_{1}|_{\\text{variable } D} = c(p_t) D_{12}(p_t) |\\nabla x_1| = \\left(\\frac{p_t}{RT}\\right) \\left(D_{12, \\mathrm{ref}} \\frac{p_{\\mathrm{ref}}}{p_t}\\right) |\\nabla x_1| = \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|\n$$\n不正确的通量大小，假设扩散系数为常数 $D_{12} = D_{12, \\mathrm{ref}}$，为：\n$$\n|\\mathbf{N}_{1}|_{\\text{const } D} = c(p_t) D_{12, \\mathrm{ref}} |\\nabla x_1| = \\frac{p_t}{RT} D_{12, \\mathrm{ref}} |\\nabla x_1|\n$$\n将这些表达式代入 $\\varepsilon$ 的定义中：\n$$\n\\varepsilon = \\frac{\\frac{p_t}{RT} D_{12, \\mathrm{ref}} |\\nabla x_1| - \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|}{\\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|}\n$$\n公共因子 $\\frac{D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|$ 从分子和分母中消去：\n$$\n\\varepsilon = \\frac{p_t - p_{\\mathrm{ref}}}{p_{\\mathrm{ref}}} = \\frac{p_t}{p_{\\mathrm{ref}}} - 1\n$$\n这个简化的表达式表明，相对误差仅取决于局部压力与定义扩散系数时所用参考压力的比值。使用给定值：\n$p_t = 1.00 \\times 10^{5} \\, \\mathrm{Pa}$\n$p_{\\mathrm{ref}} = 5.00 \\times 10^{5} \\, \\mathrm{Pa}$\n\n误差的数值为：\n$$\n\\varepsilon = \\frac{1.00 \\times 10^{5}}{5.00 \\times 10^{5}} - 1 = 0.200 - 1 = -0.800\n$$\n假设扩散系数为常数（在 $p_{\\mathrm{ref}}$ 处取值）会导致在喉部压力 $p_t$ 处对扩散通量大小的预测值低估 80%。将最终答案表示为四舍五入到四位有效数字的小数，得到 $-0.8000$。",
            "answer": "$$\\boxed{-0.8000}$$"
        },
        {
            "introduction": "最后一个练习是一项综合性的计算挑战，它将理论与复杂的工业应用实践联系起来。你将开发一个程序，用于计算高压、多组分合成气混合物中的扩散通量，同时考虑使用压缩因子和热力学因子矩阵来处理热力学非理想性。这项综合性练习要求你从第一性原理出发，推导完整的矩阵系统并实现一个鲁棒的数值求解器，为解决真实的计算燃烧问题做好准备 。",
            "id": "4067788",
            "problem": "您的任务是设计并实现一个计算程序，该程序使用带有非理想热力学驱动力的 Stefan-Maxwell 框架，计算高压下多组分合成气混合物的一维稳态摩尔扩散通量，并将这些通量与在理想气体假设下获得的通量进行比较。您需要从计算燃烧学中多组分扩散的一个有效且基础的理论出发：作为 Maxwell–Stefan (MS) 关系基础的组分级动量平衡、化学势的 Gibbs–Duhem 恒等式以及标准的热力学一致性约束。您的程序必须强制执行净摩尔流为零的约束，并且必须明确区分运动学阻力（二元 MS 扩散系数）和热力学驱动力（热力学因子矩阵）的作用。在问题陈述中避免使用简化公式；您的实现必须遵循第一性原理和推导出的算法。\n\n物理设定与假设：考虑一个一维、稳态、等温、等压的平面板，其中组分由 $i \\in \\{1,\\dots,n\\}$ 索引，$n$ 是合成气中的组分数量。设 $x_i$ 表示组分 $i$ 的摩尔分数，$D_{ij}$ 表示组分 $i$ 和 $j$ 之间的二元 Maxwell–Stefan 扩散系数（$i \\neq j$），$N_i$ 表示组分 $i$ 的摩尔扩散通量，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。设 $P$ 表示压力（单位 $\\mathrm{Pa}$），$T$ 表示温度（单位 $\\mathrm{K}$），$R$ 表示普适气体常数（单位 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），$Z$ 表示压缩因子（来自状态方程 (EOS)），$\\Gamma$ 表示将摩尔分数向量的梯度映射到校正驱动力的热力学因子矩阵。使用组分摩尔分数梯度向量 $g$，其分量为 $g_i = \\mathrm{d}x_i/\\mathrm{d}z$，单位为 $\\mathrm{m}^{-1}$，并强制 $\\sum_{i=1}^{n} x_i = 1$ 和 $\\sum_{i=1}^{n} g_i = 0$。净摩尔流为零的约束是 $\\sum_{i=1}^{n} N_i = 0$。对于理想气体的 Maxwell–Stefan 比较，使用 $\\Gamma = I$（单位矩阵）和 $Z = 1$。对于非理想计算，使用提供的 $Z$ 和 $\\Gamma$ 值。\n\n推导目标与算法规范：从多组分动量平衡和 Gibbs-Duhem 恒等式出发，推导 Maxwell–Stefan 运动学阻力如何与热力学驱动力耦合，形成一个关于通量向量 $N$ 的线性系统。展示如何从 $\\{x_i\\}$ 和 $\\{D_{ij}\\}$ 构建系数矩阵，如何从校正驱动力 $-c\\,\\Gamma\\,g$（其中 $c$ 是摩尔浓度）构建右端项，以及如何施加 $\\sum_i N_i = 0$ 来消除零模。您的最终程序必须实现这个推导出的算法，以计算非理想和理想情况下的 $N$，然后使用定义的相对 $L^2$ 误差 $\\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$（无量纲）来量化差异。非理想情况下的摩尔浓度为 $c = P / (Z R T)$，理想情况下为 $c_{\\mathrm{ideal}} = P / (R T)$。\n\n单位与输出要求：计算通量 $N_i$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。误差度量是无量纲的。您的程序必须生成单行输出，其中包含所提供测试套件的误差度量，形式为用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_k$ 是一个浮点数。\n\n测试套件：实现三个测试用例，分别模拟典型的合成气条件、富氢边界条件和富二氧化碳边界条件。在每个案例中，使用组分集 $\\{\\mathrm{H}_2,\\mathrm{CO},\\mathrm{CO}_2,\\mathrm{CH}_4,\\mathrm{N}_2\\}$，因此 $n = 5$。所有二元 Maxwell–Stefan 扩散系数 $D_{ij}$ 的单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，且在 $i,j$ 上对称，$D_{ii}$ 不使用。所有梯度 $g_i$ 的单位为 $\\mathrm{m}^{-1}$。所有压力 $P$ 的单位为 $\\mathrm{Pa}$，所有温度 $T$ 的单位为 $\\mathrm{K}$，所有压缩因子 $Z$ 均为无量纲。\n\n- 测试用例 1（典型合成气，高压）：\n  - 摩尔分数 $x = [0.35, 0.40, 0.10, 0.05, 0.10]$。\n  - 梯度 $g = [-0.20, 0.12, 0.04, 0.02, 0.02]$。\n  - 压力 $P = 3.0 \\times 10^{6}\\ \\mathrm{Pa}$。\n  - 温度 $T = 900\\ \\mathrm{K}$。\n  - 压缩因子 $Z = 0.92$。\n  - 二元扩散系数矩阵 $D$ 的非对角线项（对称）：\n    - $D_{\\mathrm{H}_2,\\mathrm{CO}} = 1.8 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CO}_2} = 1.5 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CH}_4} = 2.2 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{N}_2} = 1.9 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CO}_2} = 0.9 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CH}_4} = 1.1 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{N}_2} = 1.0 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{CH}_4} = 0.8 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{N}_2} = 0.7 \\times 10^{-5}$,\n      $D_{\\mathrm{CH}_4,\\mathrm{N}_2} = 1.0 \\times 10^{-5}$。\n  - 热力学因子矩阵 $\\Gamma$ 的项：\n    - $\\Gamma = \\begin{bmatrix}\n      1.12  -0.01  -0.02  -0.01  -0.08 \\\\\n      -0.02  1.08  0.01  -0.01  -0.06 \\\\\n      -0.01  0.01  1.18  -0.02  -0.16 \\\\\n      -0.01  -0.02  -0.03  1.10  -0.04 \\\\\n      -0.08  -0.03  -0.09  -0.03  1.25\n    \\end{bmatrix}$。\n\n- 测试用例 2（富氢，更高压力）：\n  - 摩尔分数 $x = [0.70, 0.15, 0.05, 0.05, 0.05]$。\n  - 梯度 $g = [-0.25, 0.15, 0.05, 0.03, 0.02]$。\n  - 压力 $P = 5.0 \\times 10^{6}\\ \\mathrm{Pa}$。\n  - 温度 $T = 1000\\ \\mathrm{K}$。\n  - 压缩因子 $Z = 0.88$。\n  - 二元扩散系数矩阵 $D$ 的非对角线项（对称）：\n    - $D_{\\mathrm{H}_2,\\mathrm{CO}} = 1.3 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CO}_2} = 1.1 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CH}_4} = 1.6 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{N}_2} = 1.4 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CO}_2} = 0.65 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CH}_4} = 0.80 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{N}_2} = 0.75 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{CH}_4} = 0.60 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{N}_2} = 0.55 \\times 10^{-5}$,\n      $D_{\\mathrm{CH}_4,\\mathrm{N}_2} = 0.75 \\times 10^{-5}$。\n  - 热力学因子矩阵 $\\Gamma$ 的项：\n    - $\\Gamma = \\begin{bmatrix}\n      1.20  -0.02  -0.03  -0.01  -0.14 \\\\\n      -0.03  1.12  0.02  -0.01  -0.10 \\\\\n      -0.02  0.02  1.22  -0.03  -0.19 \\\\\n      -0.01  -0.02  -0.03  1.15  -0.08 \\\\\n      -0.14  -0.07  -0.12  -0.05  1.30\n    \\end{bmatrix}$。\n\n- 测试用例 3（富二氧化碳，非常高压力）：\n  - 摩尔分数 $x = [0.10, 0.30, 0.40, 0.10, 0.10]$。\n  - 梯度 $g = [-0.05, -0.05, 0.08, 0.01, 0.01]$。\n  - 压力 $P = 8.0 \\times 10^{6}\\ \\mathrm{Pa}$。\n  - 温度 $T = 1200\\ \\mathrm{K}$。\n  - 压缩因子 $Z = 0.85$。\n  - 二元扩散系数矩阵 $D$ 的非对角线项（对称）：\n    - $D_{\\mathrm{H}_2,\\mathrm{CO}} = 0.9 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CO}_2} = 0.8 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CH}_4} = 1.2 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{N}_2} = 1.0 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CO}_2} = 0.50 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CH}_4} = 0.70 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{N}_2} = 0.65 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{CH}_4} = 0.45 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{N}_2} = 0.40 \\times 10^{-5}$,\n      $D_{\\mathrm{CH}_4,\\mathrm{N}_2} = 0.60 \\times 10^{-5}$。\n  - 热力学因子矩阵 $\\Gamma$ 的项：\n    - $\\Gamma = \\begin{bmatrix}\n      1.26  -0.03  -0.04  -0.02  -0.17 \\\\\n      -0.04  1.15  0.03  -0.02  -0.12 \\\\\n      -0.03  0.03  1.30  -0.04  -0.22 \\\\\n      -0.02  -0.03  -0.04  1.18  -0.09 \\\\\n      -0.17  -0.09  -0.15  -0.06  1.35\n    \\end{bmatrix}$。\n\n答案规范：对于三个测试用例中的每一个，计算 $N_{\\mathrm{ideal}}$ 和 $N_{\\mathrm{nonideal}}$，然后计算相对 $L^2$ 误差 $r = \\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$ 作为浮点数。您的程序应生成单行输出，其中包含三个误差，格式为用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_k$ 表示为十进制数。",
            "solution": "根据既定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n\n- **组分**：一个一维、稳态、等温、等压的系统，包含 $n=5$ 种组分，索引 $i \\in \\{1,\\dots,5\\}$ 对应于 $\\{\\mathrm{H}_2,\\mathrm{CO},\\mathrm{CO}_2,\\mathrm{CH}_4,\\mathrm{N}_2\\}$。\n- **变量**：$x_i$（摩尔分数），$D_{ij}$（二元 Maxwell–Stefan 扩散系数，$\\mathrm{m}^2\\,\\mathrm{s}^{-1}$），$N_i$（摩尔扩散通量，$\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$），$P$（压力，Pa），$T$（温度，K），$R$（普适气体常数，$\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），$Z$（压缩因子），$\\Gamma$（热力学因子矩阵），$g$（摩尔分数梯度向量，$\\mathrm{m}^{-1}$），$c$（摩尔浓度，$\\mathrm{mol}\\,\\mathrm{m}^{-3}$）。\n- **约束和定义**：\n  - $\\sum_{i=1}^{n} x_i = 1$\n  - $\\sum_{i=1}^{n} g_i = 0$\n  - $\\sum_{i=1}^{n} N_i = 0$ (净摩尔流为零)\n  - $D_{ij}$ 是对称的 ($D_{ij}=D_{ji}$)，$D_{ii}$ 不使用。\n  - 非理想浓度：$c = P / (Z R T)$\n  - 理想浓度：$c_{\\mathrm{ideal}} = P / (R T)$\n  - 理想情况假设：$\\Gamma = I$（单位矩阵），$Z = 1$。\n- **推导目标**：从多组分动量平衡和 Gibbs-Duhem 恒等式推导出一个关于通量向量 $N$ 的线性系统，然后实现一个算法来求解它。\n- **输出度量**：相对 $L^2$ 误差：$\\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$。\n- **测试用例**：提供了三个完整的测试用例，每个用例都指定了 $x$、$g$、$P$、$T$、$Z$、$D$ 的非对角线元素以及完整的 $\\Gamma$ 矩阵的值。约束 $\\sum x_i = 1$ 和 $\\sum g_i = 0$ 经核实在所有三个用例中均成立。\n\n**步骤 2：使用提取的给定信息进行验证**\n\n该问题具有科学依据，结构良好且客观。它基于多组分扩散的基本 Stefan-Maxwell 方程，这是输运现象的基石。通过压缩因子 $Z$ 和热力学因子矩阵 $\\Gamma$ 引入热力学非理想性是处理高压系统的标准高级方法。该问题可形式化，并与计算燃烧学直接相关。所有必要的数据均已提供，且约束条件内部一致。物理值对于指定的条件是现实的。\n\n验证的一个关键点涉及所提供数据的热力学一致性，特别是热力学因子矩阵 $\\Gamma$。Gibbs-Duhem 方程是一个基本的热力学定律，它对化学势 $\\mu_i$ 施加了一个约束：在恒定的 $T$ 和 $P$ 下，$\\sum_{i=1}^n x_i \\mathrm{d}\\mu_i = 0$。根据非理想气体热力学，驱动力通过热力学因子矩阵 $\\Gamma$ 与摩尔分数梯度 $g_j$ 相关联：$\\frac{x_i}{RT} \\frac{\\mathrm{d}\\mu_i}{\\mathrm{d}z} = \\sum_{j=1}^n \\Gamma_{ij} g_j$。将此关系代入 Gibbs-Duhem 方程，可以推导出对驱动力的约束，进而对 $\\Gamma$ 矩阵施加约束。\n\n让我们检查一下提供的 $\\Gamma$ 矩阵是否满足由 Gibbs-Duhem 方程导出的可解性条件，即驱动力之和必须为零。\n- **测试用例 1**：驱动力之和不为零。该矩阵在热力学上是不一致的，违反了 Gibbs-Duhem 方程。\n- **测试用例 2**：驱动力之和几乎为零，表明问题陈述中可能存在舍入误差。\n- **测试用例 3**：驱动力之和为零。该矩阵在热力学上是一致的。\n\n测试用例 1 中的不一致性意味着从中导出的驱动力之和不会以基础物理学要求的方式为零。数值程序必须足够稳健，以处理这类数据，这些数据在实际计算中可能由于建模或数据拟合误差而出现。该问题作为一个计算任务仍然是有效的，前提是推导并实现了一个合适的稳健算法。不一致数据的存在不会使问题无效，而是对解决方法提出了更严格的要求。\n\n**步骤 3：结论与行动**\n\n此问题是**有效的**。核心任务是推导并实现一个用于求解 Stefan-Maxwell 方程的稳健数值算法。其中一个测试用例的不一致性是一个稳健算法必须处理的特性，并且推导过程必须证明选择该算法的合理性。\n\n### 推导与求解方法\n\nStefan-Maxwell 方程源于对每个组分的动量平衡，将作用于组分 $i$ 上的驱动力与来自所有其他组分 $j$ 的摩擦阻力相等同。对于一维系统，方程为：\n$$\n\\frac{x_i}{RT} \\frac{\\mathrm{d}\\mu_i}{\\mathrm{d}z} = \\sum_{j=1, j\\neq i}^n \\frac{x_j N_i - x_i N_j}{c D_{ij}}\n$$\n其中 $\\mathrm{d}\\mu_i/\\mathrm{d}z$ 是组分 $i$ 的化学势梯度，它构成了扩散的驱动力。\n\n对于非理想混合物，化学势梯度通过热力学因子矩阵 $\\Gamma$ 与摩尔分数梯度 $g_j = \\mathrm{d}x_j/\\mathrm{d}z$ 相关联：\n$$\n\\frac{x_i}{RT} \\frac{\\mathrm{d}\\mu_i}{\\mathrm{d}z} = \\sum_{j=1}^n \\Gamma_{ij} g_j\n$$\n将此式代入 Stefan-Maxwell 方程，得到：\n$$\n\\sum_{j=1}^n \\Gamma_{ij} g_j = \\sum_{j=1, j\\neq i}^n \\frac{x_j N_i - x_i N_j}{c D_{ij}}\n$$\n让我们定义一个广义驱动力向量 $F_k = -c \\sum_{j=1}^n \\Gamma_{kj} g_j$。负号是常规用法，表示通量沿梯度下降方向发生。用向量形式表示为 $F = -c\\Gamma g$。重新整理组分 $i$ 的 Stefan-Maxwell 方程：\n$$\n-F_i = \\sum_{j=1, j\\neq i}^n \\left( \\frac{x_j}{D_{ij}} N_i - \\frac{x_i}{D_{ij}} N_j \\right) = N_i \\left( \\sum_{j=1, j\\neq i}^n \\frac{x_j}{D_{ij}} \\right) - \\sum_{j=1, j\\neq i}^n \\frac{x_i}{D_{ij}} N_j\n$$\n这可以写成一个包含 $n$ 个方程的线性系统，用于求解 $n$ 个未知通量 $N_i$：\n$$\n[B]\\{N\\} = \\{F\\}\n$$\n其中 $\\{N\\}$ 是通量的列向量，$\\{F\\}$ 是驱动力的列向量，$[B]$ 是一个 $n \\times n$ 矩阵，其元素为：\n$$\nB_{ii} = \\sum_{k=1, k\\neq i}^n \\frac{x_k}{D_{ik}}\n$$\n$$\nB_{ij} = -\\frac{x_i}{D_{ij}} \\quad \\text{对于 } i \\neq j\n$$\n这个方程组是奇异的。矩阵 $[B]$ 有一个由摩尔分数向量 $\\{x\\}$ 张成的零空间，即 $[B]\\{x\\} = \\{0\\}$。这可以通过代入来验证：\n$$\n([B]\\{x\\})_i = \\sum_{j=1}^n B_{ij} x_j = B_{ii}x_i + \\sum_{j=1, j\\neq i}^n B_{ij} x_j = \\left(\\sum_{k=1, k\\neq i}^n \\frac{x_k}{D_{ik}}\\right) x_i - \\sum_{j=1, j\\neq i}^n \\frac{x_i}{D_{ij}} x_j = 0\n$$\n一个奇异系统 $[B]\\{N\\} = \\{F\\}$ 只有在右端项 $\\{F\\}$ 与 $[B]$ 的左零空间正交时才有解。$[B]$ 的左零向量是 $\\{u\\} = [1, 1, \\dots, 1]^T$，这可以作为 Gibbs-Duhem 方程的一个推论来证明。这意味着存在一个可解性条件：$\\sum_{i=1}^n F_i = 0$。如验证时所讨论的，由于测试用例 1 中 $\\Gamma$ 矩阵的性质，此条件不被满足。\n\n为了获得唯一解并处理潜在的不一致性，我们必须引入净摩尔流为零的约束，即 $\\sum_{i=1}^n N_i = 0$。这给出了一个关于 $n$ 个未知数的 $n+1$ 个方程的超定系统：\n$$\n\\begin{cases}\n[B]\\{N\\} = \\{F\\} \\\\\n\\mathbf{1}^T \\{N\\} = 0\n\\end{cases}\n$$\n其中 $\\mathbf{1}^T$ 是一个全为 1 的行向量。该系统可以写成 $[A]\\{N\\} = \\{b\\}$，其中 $[A]$ 是一个 $(n+1) \\times n$ 矩阵，$\\{b\\}$ 是一个 $(n+1) \\times 1$ 向量：\n$$\n[A] = \\begin{bmatrix} B \\\\ \\mathbf{1}^T \\end{bmatrix}, \\quad \\{b\\} = \\begin{bmatrix} F \\\\ 0 \\end{bmatrix}\n$$\n求解此类系统最稳健的方法是最小二乘法，特别是当原始方程 $[B]\\{N\\} = \\{F\\}$ 可能不一致时。此方法找到使残差的欧几里得范数 $\\|[A]\\{N\\} - \\{b\\}\\|_2$ 最小化的向量 $\\{N\\}$。该最小二乘问题的解由正规方程给出：\n$$\n([A]^T [A]) \\{N\\} = [A]^T \\{b\\}\n$$\n让我们计算这些项：\n$$\n[A]^T [A] = \\begin{bmatrix} B^T  \\mathbf{1} \\end{bmatrix} \\begin{bmatrix} B \\\\ \\mathbf{1}^T \\end{bmatrix} = [B]^T[B] + \\mathbf{1}\\mathbf{1}^T\n$$\n$$\n[A]^T \\{b\\} = \\begin{bmatrix} B^T  \\mathbf{1} \\end{bmatrix} \\begin{bmatrix} F \\\\ 0 \\end{bmatrix} = [B]^T\\{F\\}\n$$\n这就得到了最终要求解通量 $\\{N\\}$ 的、良态的 $n \\times n$ 线性系统：\n$$\n([B]^T[B] + \\mathbf{1}\\mathbf{1}^T) \\{N\\} = [B]^T \\{F\\}\n$$\n矩阵 $([B]^T[B] + \\mathbf{1}\\mathbf{1}^T)$ 是可逆的，从而保证了唯一解的存在。该方法能正确地确定热力学一致数据的通量，并通过寻找一个总和为零同时最小化对 Stefan-Maxwell 关系违反程度的通量向量，为不一致数据提供了一个物理上有意义的“最佳拟合”解。\n\n**算法步骤：**\n1.  对于给定的测试用例（非理想或理想），获取输入：$\\{x_i\\}$、$\\{g_i\\}$、$P$、$T$、$Z$、$[D_{ij}]$、$[\\Gamma_{ij}]$ 和 $R$。对于理想情况，设置 $Z=1$ 和 $\\Gamma=I$。\n2.  计算摩尔浓度：$c = P / (Z R T)$。\n3.  使用摩尔分数 $\\{x_i\\}$ 和扩散系数 $[D_{ij}]$ 构建 $n \\times n$ 矩阵 $[B]$。\n4.  计算 $n \\times 1$ 驱动力向量 $\\{F\\} = -c[\\Gamma]\\{g\\}$。\n5.  构建正规方程的矩阵：$[C] = [B]^T[B] + \\mathbf{1}\\mathbf{1}^T$，其中 $\\mathbf{1}\\mathbf{1}^T$ 是一个 $n \\times n$ 的全 1 矩阵。\n6.  构建正规方程的右端向量：$\\{h\\} = [B]^T\\{F\\}$。\n7.  求解线性系统 $[C]\\{N\\} = \\{h\\}$ 以找到摩尔扩散通量向量 $\\{N\\}$。\n8.  在计算出 $\\{N_{\\mathrm{nonideal}}\\}$ 和 $\\{N_{\\mathrm{ideal}}\\}$ 后，计算相对误差：$r = \\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$。\n\n该程序将为指定的三个测试用例分别实现此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve_fluxes(x, g, D, P, T, Z, Gamma, R):\n    \"\"\"\n    Solves for the molar diffusive fluxes using the Stefan-Maxwell equations.\n\n    This function implements a robust least-squares method to solve the\n    overdetermined system comprising the n Stefan-Maxwell equations and the\n    no-net-molar-flow constraint.\n\n    Args:\n        x (np.ndarray): Mole fraction vector.\n        g (np.ndarray): Mole fraction gradient vector.\n        D (np.ndarray): Matrix of binary Maxwell-Stefan diffusivities.\n        P (float): Pressure in Pa.\n        T (float): Temperature in K.\n        Z (float): Compressibility factor.\n        Gamma (np.ndarray): Thermodynamic factor matrix.\n        R (float): Universal gas constant.\n\n    Returns:\n        np.ndarray: The molar diffusive flux vector N.\n    \"\"\"\n    n = len(x)\n\n    # 1. Calculate molar concentration\n    c = P / (Z * R * T)\n\n    # 2. Construct the B matrix\n    B = np.zeros((n, n))\n    for i in range(n):\n        sum_term = 0\n        for k in range(n):\n            if i == k:\n                continue\n            sum_term += x[k] / D[i, k]\n        B[i, i] = sum_term\n\n        for j in range(n):\n            if i == j:\n                continue\n            B[i, j] = -x[i] / D[i, j]\n\n    # 3. Calculate driving force vector F = -c*Gamma*g\n    F = -c * (Gamma @ g)\n\n    # 4. Formulate and solve the normal equations for the least-squares problem\n    # System: (B^T*B + 11^T) * N = B^T * F\n    C = (B.T @ B) + np.ones((n, n))\n    h = B.T @ F\n    \n    # 5. Solve the linear system C * N = h for N\n    N = np.linalg.solve(C, h)\n\n    return N\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and compute the relative errors.\n    \"\"\"\n    # Universal gas constant in J/(mol K)\n    R = 8.314462618\n\n    # Species indexing: 0:H2, 1:CO, 2:CO2, 3:CH4, 4:N2\n    \n    # Test cases data structure:\n    # (x, g, P, T, Z, D_values, Gamma)\n    # D_values are the 10 off-diagonal elements in the specified order.\n    test_cases = [\n        # Test case 1\n        (\n            np.array([0.35, 0.40, 0.10, 0.05, 0.10]),\n            np.array([-0.20, 0.12, 0.04, 0.02, 0.02]),\n            3.0e6, 900.0, 0.92,\n            [1.8e-5, 1.5e-5, 2.2e-5, 1.9e-5, 0.9e-5, 1.1e-5, 1.0e-5, 0.8e-5, 0.7e-5, 1.0e-5],\n            np.array([\n                [1.12, -0.01, -0.02, -0.01, -0.08],\n                [-0.02, 1.08, 0.01, -0.01, -0.06],\n                [-0.01, 0.01, 1.18, -0.02, -0.16],\n                [-0.01, -0.02, -0.03, 1.10, -0.04],\n                [-0.08, -0.03, -0.09, -0.03, 1.25]\n            ])\n        ),\n        # Test case 2\n        (\n            np.array([0.70, 0.15, 0.05, 0.05, 0.05]),\n            np.array([-0.25, 0.15, 0.05, 0.03, 0.02]),\n            5.0e6, 1000.0, 0.88,\n            [1.3e-5, 1.1e-5, 1.6e-5, 1.4e-5, 0.65e-5, 0.80e-5, 0.75e-5, 0.60e-5, 0.55e-5, 0.75e-5],\n            np.array([\n                [1.20, -0.02, -0.03, -0.01, -0.14],\n                [-0.03, 1.12, 0.02, -0.01, -0.10],\n                [-0.02, 0.02, 1.22, -0.03, -0.19],\n                [-0.01, -0.02, -0.03, 1.15, -0.08],\n                [-0.14, -0.07, -0.12, -0.05, 1.30]\n            ])\n        ),\n        # Test case 3\n        (\n            np.array([0.10, 0.30, 0.40, 0.10, 0.10]),\n            np.array([-0.05, -0.05, 0.08, 0.01, 0.01]),\n            8.0e6, 1200.0, 0.85,\n            [0.9e-5, 0.8e-5, 1.2e-5, 1.0e-5, 0.50e-5, 0.70e-5, 0.65e-5, 0.45e-5, 0.40e-5, 0.60e-5],\n            np.array([\n                [1.26, -0.03, -0.04, -0.02, -0.17],\n                [-0.04, 1.15, 0.03, -0.02, -0.12],\n                [-0.03, 0.03, 1.30, -0.04, -0.22],\n                [-0.02, -0.03, -0.04, 1.18, -0.09],\n                [-0.17, -0.09, -0.15, -0.06, 1.35]\n            ])\n        )\n    ]\n\n    results = []\n    n_species = 5\n\n    for case in test_cases:\n        x, g, P, T, Z, D_values, Gamma = case\n        \n        # Build the symmetric diffusivity matrix D\n        D = np.zeros((n_species, n_species))\n        indices = [(0, 1), (0, 2), (0, 3), (0, 4), (1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4)]\n        for (i, j), val in zip(indices, D_values):\n            D[i, j] = D[j, i] = val\n\n        # Calculate non-ideal fluxes\n        N_nonideal = solve_fluxes(x, g, D, P, T, Z, Gamma, R)\n\n        # Calculate ideal fluxes (Z=1, Gamma=I)\n        Z_ideal = 1.0\n        Gamma_ideal = np.identity(n_species)\n        N_ideal = solve_fluxes(x, g, D, P, T, Z_ideal, Gamma_ideal, R)\n\n        # Compute relative L2 error\n        error_norm = np.linalg.norm(N_nonideal - N_ideal)\n        ideal_norm = np.linalg.norm(N_ideal)\n        \n        if ideal_norm == 0:\n            relative_error = 0.0 # Or handle as an undefined case if appropriate\n        else:\n            relative_error = error_norm / ideal_norm\n            \n        results.append(relative_error)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}