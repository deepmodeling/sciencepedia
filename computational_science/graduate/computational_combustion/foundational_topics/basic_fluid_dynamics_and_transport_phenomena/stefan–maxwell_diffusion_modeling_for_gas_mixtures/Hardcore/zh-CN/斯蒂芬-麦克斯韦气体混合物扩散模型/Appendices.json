{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨了二元气体扩散的经典教科书案例——等摩尔反向扩散。通过从第一性原理出发，您将运用 Stefan-Maxwell 方程来推导和计算物质通量与速度，从而巩固对摩尔平均速度以及扩散通量和为零等基本概念的理解。这是将理论付诸实践的关键第一步 ()。",
            "id": "4067774",
            "problem": "考虑氧气 $\\mathrm{O}_2$ 和氮气 $\\mathrm{N}_2$ 在两个通过长度为 $L$ 的平面通道相连的大型等温、等压储库之间的稳态、一维 (1D) 等摩尔反向扩散。该气体混合物为理想气体，处于恒定温度 $T=900\\,\\mathrm{K}$ 和恒定压力 $p=1.01325\\times 10^5\\,\\mathrm{Pa}$。在这些条件下，$\\mathrm{O}_2$–$\\mathrm{N}_2$ 的二元Stefan–Maxwell (S-M) 扩散系数为 $D_{\\mathrm{O}_2\\mathrm{N}_2}}=1.30\\times 10^{-4}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。在 $z=0$ 处，摩尔分数为 $x_{\\mathrm{O}_2}(0)=0.80$；在 $z=L=0.020\\,\\mathrm{m}$ 处，摩尔分数为 $x_{\\mathrm{O}_2}(L)=0.20$。假设无化学反应，忽略热扩散 (Soret 效应) 和压力扩散，并忽略任何外部施加的整体流动。\n\n使用 Stefan–Maxwell 扩散模型和第一性原理（理想气体定律、组分通量定义和组分连续性），推导相对于静止实验室参考系的组分摩尔扩散通量 $J_{\\mathrm{O}_2}}$ 和 $J_{\\mathrm{N}_2}}$ 以及组分速度 $v_{\\mathrm{O}_2}}(z)$ 和 $v_{\\mathrm{N}_2}}(z)$。明确验证摩尔平均混合物速度 $\\mathbf{v}$ 处处为零，且 $\\sum_i \\mathbf{J}_i=\\mathbf{0}$。计算中间平面 $z=L/2$ 处的组分速度。\n\n最后，报告 $\\mathrm{O}_2$ 摩尔扩散通量 $J_{\\mathrm{O}_2}}$ 的大小，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。将最终数值答案四舍五入至四位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n-   **过程：**稳态、一维 (1D) 等摩尔反向扩散。\n-   **组分：**氧气 ($\\mathrm{O}_2$) 和氮气 ($\\mathrm{N}_2$)。\n-   **几何：**长度为 $L = 0.020\\,\\mathrm{m}$ 的平面通道。\n-   **热力学状态：**理想气体混合物，恒定温度 $T=900\\,\\mathrm{K}$，恒定压力 $p=1.01325\\times 10^5\\,\\mathrm{Pa}$。\n-   **输运性质：**二元 Stefan–Maxwell 扩散系数 $D_{\\mathrm{O}_2\\mathrm{N}_2}}=1.30\\times 10^{-4}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n-   **边界条件：**\n    -   在 $z=0$ 处：摩尔分数 $x_{\\mathrm{O}_2}(0)=0.80$。\n    -   在 $z=L$ 处：摩尔分数 $x_{\\mathrm{O}_2}(L)=0.20$。\n-   **假设：**\n    -   无化学反应。\n    -   可忽略的热扩散 (Soret 效应)。\n    -   可忽略的压力扩散。\n    -   可忽略的外部施加的整体流动。\n\n**第2步：使用提取的已知条件进行验证**\n-   **科学依据：**该问题是二元气体扩散的经典示例，其原理牢固地植根于连续介质力学和输运现象。控制方程 Stefan–Maxwell 方程是该领域的基础。\n-   **适定性：**该问题是一个稳态、一维边值问题，具有明确定义的条件（恒定的温度、压力以及边界处的组分摩尔分数）。这种结构确保了唯一、稳定的解。\n-   **客观性：**问题陈述使用了精确、定量和无偏的语言。\n-   **完整性与一致性：**问题提供了所有必要的数据（T, p, L, D, 边界条件）以确定所求量。“等摩尔反向扩散”的假设与无净摩尔通量的等压、等温二元系统是一致的。\n-   **现实性与可行性：**给定的物理参数（$T$, $p$, $L$, $D_{\\mathrm{O}_2\\mathrm{N}_2}}$）对于气相扩散研究是现实的。\n-   **总体结构：**问题结构良好，不包含任何已列出的缺陷。这是化学工程和燃烧科学中的一个经典问题。\n\n**第3步：结论与行动**\n该问题被判定为**有效**。现在开始求解过程。\n\n### 求解过程\n\n该系统由无化学反应的稳态一维组分连续性方程描述，其形式如下：\n$$\n\\frac{d N_i}{dz} = 0\n$$\n其中 $N_i$ 是组分 $i$ 相对于静止坐标系的摩尔通量。该方程意味着对于每个组分，$N_i$ 沿着通道长度 $z$ 是一个常数。该问题涉及两种组分：氧气 ($\\mathrm{O}_2$) 和氮气 ($\\mathrm{N}_2$）。\n\n对于一维（$z$方向）的二元混合物，Stefan–Maxwell 方程将摩尔分数的梯度与组分摩尔通量联系起来：\n$$\n\\frac{dx_{\\mathrm{O}_2}}{dz} = \\frac{x_{\\mathrm{O}_2} N_{\\mathrm{N}_2} - x_{\\mathrm{N}_2} N_{\\mathrm{O}_2}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}\n$$\n其中 $c$ 是总摩尔浓度，$x_i$ 是组分 $i$ 的摩尔分数，$D_{\\mathrm{O}_2\\mathrm{N}_2}}$ 是二元扩散系数。由于气体混合物是理想的，并且处于恒定温度 $T$ 和压力 $p$ 下，由理想气体定律可知，总摩尔浓度 $c$ 也是恒定的：\n$$\nc = \\frac{p}{RT}\n$$\n其中 $R$ 是普适气体常数。\n\n问题指明了“等摩尔反向扩散”，这意味着净摩尔通量为零：\n$$\nN = N_{\\mathrm{O}_2} + N_{\\mathrm{N}_2} = 0\n$$\n这意味着两种组分的摩尔通量大小相等，方向相反：$N_{\\mathrm{N}_2}} = -N_{\\mathrm{O}_2}}$。\n\n将 $N_{\\mathrm{N}_2}} = -N_{\\mathrm{O}_2}}$ 和 $x_{\\mathrm{N}_2}} = 1 - x_{\\mathrm{O}_2}}$ 代入 Stefan-Maxwell 方程：\n$$\n\\frac{dx_{\\mathrm{O}_2}}{dz} = \\frac{x_{\\mathrm{O}_2} (-N_{\\mathrm{O}_2}}) - (1 - x_{\\mathrm{O}_2}}) N_{\\mathrm{O}_2}}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}} = \\frac{-x_{\\mathrm{O}_2} N_{\\mathrm{O}_2}} - N_{\\mathrm{O}_2}} + x_{\\mathrm{O}_2}} N_{\\mathrm{O}_2}}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}} = \\frac{-N_{\\mathrm{O}_2}}}{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}\n$$\n这等同于此特定情况下的 Fick 第一定律。我们可以重新整理以求解恒定的摩尔通量 $N_{\\mathrm{O}_2}}$：\n$$\nN_{\\mathrm{O}_2}} = -c D_{\\mathrm{O}_2\\mathrm{N}_2}} \\frac{dx_{\\mathrm{O}_2}}{dz}\n$$\n由于 $N_{\\mathrm{O}_2}}$、$c$ 和 $D_{\\mathrm{O}_2\\mathrm{N}_2}}$ 都是常数，摩尔分数梯度 $dx_{\\mathrm{O}_2}}/dz$ 也必定是常数。我们可以将此方程沿通道长度从 $z=0$ 到 $z=L$ 进行积分：\n$$\n\\int_0^L N_{\\mathrm{O}_2}} dz = \\int_{x_{\\mathrm{O}_2}}(0)}^{x_{\\mathrm{O}_2}}(L)} -c D_{\\mathrm{O}_2\\mathrm{N}_2}} dx_{\\mathrm{O}_2}}\n$$\n$$\nN_{\\mathrm{O}_2}} L = -c D_{\\mathrm{O}_2\\mathrm{N}_2}} [x_{\\mathrm{O}_2}}(L) - x_{\\mathrm{O}_2}}(0)]\n$$\n$$\nN_{\\mathrm{O}_2}} = \\frac{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}{L} [x_{\\mathrm{O}_2}}(0) - x_{\\mathrm{O}_2}}(L)]\n$$\n总摩尔通量 $N_i$ 是扩散通量 $J_i$（相对于摩尔平均速度）和对流通量之和：$N_i = J_i + x_i N$。由于等摩尔反向扩散时 $N=0$，总通量等于扩散通量：$N_i = J_i$。\n因此，组分摩尔扩散通量为：\n$$\nJ_{\\mathrm{O}_2}} = \\frac{c D_{\\mathrm{O}_2\\mathrm{N}_2}}}{L} [x_{\\mathrm{O}_2}}(0) - x_{\\mathrm{O}_2}}(L)]\n$$\n$$\nJ_{\\mathrm{N}_2}} = N_{\\mathrm{N}_2}} = -N_{\\mathrm{O}_2}} = -J_{\\mathrm{O}_2}}\n$$\n我们可以立即验证 $\\sum_i \\mathbf{J}_i = J_{\\mathrm{O}_2}} + J_{\\mathrm{N}_2}} = J_{\\mathrm{O}_2}} - J_{\\mathrm{O}_2}} = \\mathbf{0}$。\n\n组分速度 $v_i(z)$ 通过 $N_i = c_i v_i = c x_i v_i$ 与摩尔通量 $N_i$ 相关。因此：\n$$\nv_i(z) = \\frac{N_i}{c x_i(z)} = \\frac{J_i}{c x_i(z)}\n$$\n摩尔分数分布 $x_{\\mathrm{O}_2}}(z)$ 是线性的，因为其梯度是恒定的：\n$$\nx_{\\mathrm{O}_2}}(z) = x_{\\mathrm{O}_2}}(0) + \\frac{x_{\\mathrm{O}_2}}(L) - x_{\\mathrm{O}_2}}(0)}{L} z\n$$\n并且 $x_{\\mathrm{N}_2}}(z) = 1 - x_{\\mathrm{O}_2}}(z)$。\n因此，组分速度为：\n$$\nv_{\\mathrm{O}_2}}(z) = \\frac{J_{\\mathrm{O}_2}}} {c \\left( x_{\\mathrm{O}_2}}(0) + \\frac{z}{L}(x_{\\mathrm{O}_2}}(L) - x_{\\mathrm{O}_2}}(0)) \\right)}\n$$\n$$\nv_{\\mathrm{N}_2}}(z) = \\frac{J_{\\mathrm{N}_2}}} {c \\left( 1 - \\left( x_{\\mathrm{O}_2}}(0) + \\frac{z}{L}(x_{\\mathrm{O}_2}}(L) - x_{\\mathrm{O}_2}}(0)) \\right) \\right)}\n$$\n摩尔平均混合物速度 $\\mathbf{v}$ 定义为 $\\mathbf{v} = \\sum_i x_i \\mathbf{v}_i$。在一维情况下：\n$$\nv(z) = x_{\\mathrm{O}_2}}(z) v_{\\mathrm{O}_2}}(z) + x_{\\mathrm{N}_2}}(z) v_{\\mathrm{N}_2}}(z) = x_{\\mathrm{O}_2}}(z) \\frac{N_{\\mathrm{O}_2}}}{c x_{\\mathrm{O}_2}}(z)} + x_{\\mathrm{N}_2}}(z) \\frac{N_{\\mathrm{N}_2}}}{c x_{\\mathrm{N}_2}}(z)} = \\frac{N_{\\mathrm{O}_2}} + N_{\\mathrm{N}_2}}}{c} = \\frac{N}{c}\n$$\n由于等摩尔反向扩散时 $N=0$，摩尔平均速度 $v(z)=0$ 处处成立，符合要求。\n\n现在我们计算数值。普适气体常数为 $R \\approx 8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n总摩尔浓度：\n$$\nc = \\frac{p}{RT} = \\frac{1.01325 \\times 10^5\\,\\mathrm{Pa}}{(8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(900\\,\\mathrm{K})} \\approx 13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n氧气的摩尔通量：\n$$\nJ_{\\mathrm{O}_2}} = \\frac{(13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})(1.30\\times 10^{-4}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1})}{0.020\\,\\mathrm{m}} (0.80 - 0.20)\n$$\n$$\nJ_{\\mathrm{O}_2}} = (0.08801455\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1})(0.60) \\approx 0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\n其大小为 $|J_{\\mathrm{O}_2}}| \\approx 0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。四舍五入到四位有效数字得到 $5.281 \\times 10^{-2}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n同时，$J_{\\mathrm{N}_2}} = -J_{\\mathrm{O}_2}} \\approx -0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n为了求出中间平面 $z = L/2 = 0.010\\,\\mathrm{m}$ 处的速度，首先求出该点的摩尔分数：\n$$\nx_{\\mathrm{O}_2}}(L/2) = 0.80 + \\frac{0.010}{0.020}(0.20 - 0.80) = 0.80 + 0.5(-0.60) = 0.80 - 0.30 = 0.50\n$$\n$$\nx_{\\mathrm{N}_2}}(L/2) = 1 - x_{\\mathrm{O}_2}}(L/2) = 1 - 0.50 = 0.50\n$$\n现在计算 $z=L/2$ 处的组分速度：\n$$\nv_{\\mathrm{O}_2}}(L/2) = \\frac{J_{\\mathrm{O}_2}}}{c x_{\\mathrm{O}_2}}(L/2)} = \\frac{0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}}{(13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})(0.50)} \\approx 0.0077999\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nv_{\\mathrm{N}_2}}(L/2) = \\frac{J_{\\mathrm{N}_2}}}{c x_{\\mathrm{N}_2}}(L/2)} = \\frac{-0.0528087\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}}{(13.5407\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})(0.50)} \\approx -0.0077999\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n推导和验证已完成。最终要求的答案是 $\\mathrm{O}_2$ 摩尔扩散通量的大小。\n$|J_{\\mathrm{O}_2}}| \\approx 5.281 \\times 10^{-2}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\\boxed{5.281 \\times 10^{-2}}$$"
        },
        {
            "introduction": "本练习在基础案例之上更进一步，旨在探讨 Stefan-Maxwell 方程如何精确地描述理想气体中摩尔浓度 ($c \\propto p$) 与扩散系数 ($D_{ij} \\propto 1/p$) 之间的相互作用。通过这个练习 ()，您将揭示一个重要且略带反直觉的结论：在等温条件下，摩尔扩散通量的大小与局部压力无关。这对于模拟喷管或发动机等具有大压力梯度的流动至关重要。",
            "id": "4067754",
            "problem": "考虑氢气 $\\mathrm{H_2}$（组分 $1$）和水蒸气 $\\mathrm{H_2O}$（组分 $2$）的二元理想气体混合物通过一个收缩喷管的稳态一维流动。该混合物处于等温状态，温度为 $T$，且体积力和热扩散可忽略不计。扩散摩尔通量是相对于摩尔平均速度测量的，因此 $\\sum_{i=1}^{2} \\mathbf{N}_{i} = \\mathbf{0}$。在固定温度下，二元扩散系数遵循一个经过充分检验的、与压力相关的动力学理论标度关系，即 $D_{12}(p) = D_{12,\\mathrm{ref}} \\, p_{\\mathrm{ref}}/p$，而理想气体的总摩尔浓度为 $c = p/(R T)$，其中 $R$ 是普适气体常数。\n\n在喉部区域，$\\mathrm{H_2}$ 的轴向摩尔分数梯度近似均匀，等于 $\\nabla x_{1} = \\frac{d x_{1}}{d x} = 0.040 \\,\\mathrm{m}^{-1}$。参考扩散系数和参考压力分别为 $D_{12,\\mathrm{ref}} = 1.50 \\times 10^{-4} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$（在 $p_{\\mathrm{ref}} = 5.00 \\times 10^{5} \\,\\mathrm{Pa}$ 时）。局部喉部压力为 $p_{\\mathrm{t}} = 1.00 \\times 10^{5} \\,\\mathrm{Pa}$。温度为 $T = 1100 \\,\\mathrm{K}$。\n\n从二元混合物的 Maxwell–Stefan 扩散公式出发，推导以 $p$、$T$、$D_{12}(p)$ 和 $\\nabla x_{1}$ 表示的 $\\mathrm{H_2}$ 摩尔扩散通量 $\\mathbf{N}_{1}$ 的表达式，并解释当压力梯度 $\\nabla p$ 很强时，$D_{12}(p)$ 的压力依赖性如何改变喷管内的通量大小。然后，使用推导出的表达式，计算在喉部，如果将 $D_{12}$ 视为等于 $D_{12,\\mathrm{ref}}$ 的常数，同时使用局部的理想气体浓度 $c(p)$，所产生的有符号相对误差。有符号相对误差定义为\n$$\n\\varepsilon \\equiv \\frac{|\\mathbf{N}_{1}|_{\\text{const } D} - |\\mathbf{N}_{1}|_{\\text{variable } D}}{|\\mathbf{N}_{1}|_{\\text{variable } D}}.\n$$\n将您最终的 $\\varepsilon$ 答案表示为十进制数，并四舍五入到四位有效数字。$\\varepsilon$ 无需单位。",
            "solution": "首先验证问题的科学合理性、一致性和完整性。提取并检查已知条件。该问题设定是输运现象和燃烧科学中的一个标准场景，涉及二元理想气体混合物中的 Maxwell-Stefan 扩散。所提供的物理关系，例如二元扩散系数的压力依赖性（$D_{12} \\propto 1/p$）和理想气体定律（$c = p/(RT)$），在根本上是正确的，并已由动力学理论充分证实。数值对于高温气体流动系统是物理上合理的。问题是适定的，有足够的信息来推导所需的表达式并计算指定的误差。因此，该问题被认为是有效的，有必要给出完整解。\n\n按照问题的要求，解答分为三个部分：首先，推导摩尔扩散通量表达式；其次，解释压力依赖性扩散系数的作用；第三，计算指定的相对误差。\n\n**第一部分：摩尔扩散通量表达式的推导**\n\n在等温条件下且无体积力时，一般多组分混合物的 Maxwell-Stefan 扩散方程由下式给出\n$$\n\\nabla x_i = \\sum_{j=1, j \\neq i}^{N_s} \\frac{x_i \\mathbf{N}_j - x_j \\mathbf{N}_i}{c D_{ij}}\n$$\n其中 $x_i$ 是组分 $i$ 的摩尔分数，$\\mathbf{N}_i$ 是组分 $i$ 相对于摩尔平均速度的摩尔扩散通量，$c$ 是总摩尔浓度，$D_{ij}$ 是 $i-j$ 对的二元扩散系数。\n\n对于 $\\mathrm{H_2}$（组分 $1$）和 $\\mathrm{H_2O}$（组分 $2$）的二元混合物，组分 $1$ 的方程为：\n$$\n\\nabla x_1 = \\frac{x_1 \\mathbf{N}_2 - x_2 \\mathbf{N}_1}{c D_{12}}\n$$\n问题指出，扩散通量的定义使其总和为零：$\\sum_{i=1}^{2} \\mathbf{N}_{i} = \\mathbf{0}$。这意味着 $\\mathbf{N}_2 = -\\mathbf{N}_1$。将此关系代入 Maxwell-Stefan 方程，得到：\n$$\n\\nabla x_1 = \\frac{x_1 (-\\mathbf{N}_1) - x_2 \\mathbf{N}_1}{c D_{12}} = \\frac{-\\mathbf{N}_1(x_1 + x_2)}{c D_{12}}\n$$\n对于二元混合物，摩尔分数之和为一，$x_1 + x_2 = 1$。方程简化为：\n$$\n\\nabla x_1 = -\\frac{\\mathbf{N}_1}{c D_{12}}\n$$\n这是二元混合物中扩散的菲克形式。对 $\\mathrm{H_2}$ 的摩尔扩散通量 $\\mathbf{N}_1$ 进行整理，我们得到：\n$$\n\\mathbf{N}_1 = -c D_{12} \\nabla x_1\n$$\n问题提供了总摩尔浓度的理想气体关系式，$c = p/(RT)$，其中 $p$ 是压力，$T$ 是温度，$R$ 是普适气体常数。将此代入 $\\mathbf{N}_1$ 的表达式，得到以指定变量表示的最终形式：\n$$\n\\mathbf{N}_1 = -\\frac{p}{RT} D_{12}(p) \\nabla x_1\n$$\n\n**第二部分：压力依赖性扩散系数的影响**\n\n为了理解 $D_{12}$ 的压力依赖性如何影响通量大小，我们将给定的标度关系 $D_{12}(p) = D_{12, \\mathrm{ref}} \\, p_{\\mathrm{ref}}/p$ 代入上面推导出的通量大小表达式中：\n$$\n|\\mathbf{N}_1| = \\left| -\\frac{p}{RT} D_{12}(p) \\nabla x_1 \\right| = \\frac{p}{RT} \\left( D_{12, \\mathrm{ref}} \\frac{p_{\\mathrm{ref}}}{p} \\right) |\\nabla x_1|\n$$\n局部压力 $p$ 被消去，从而得出一个显著的结果：\n$$\n|\\mathbf{N}_1| = \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|\n$$\n这表明，对于等温理想气体混合物，摩尔扩散通量的大小与局部压力无关。摩尔浓度和扩散系数的乘积 $c D_{12}$ 相对于压力是恒定的：\n$$\nc D_{12} = \\left(\\frac{p}{RT}\\right) \\left(D_{12, \\mathrm{ref}} \\frac{p_{\\mathrm{ref}}}{p}\\right) = \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} = \\text{constant}\n$$\n在收缩喷管中，当气体流向喉部时，压力 $p$ 会显著下降。如果有人错误地假设 $D_{12}$ 是一个常数（例如，$D_{12} = D_{12, \\mathrm{ref}}$），那么通量大小的模型将是 $|\\mathbf{N}_1|_{\\text{const } D} = \\frac{p}{RT} D_{12, \\mathrm{ref}} |\\nabla x_1|$。这个不正确的模型会预测通量大小与压力成正比，因此会沿着喷管显著减小。而正确的模型，包含了 $D_{12} \\propto 1/p$ 的依赖关系，揭示了由于压力下降引起的摩尔浓度 $c$ 的减小，恰好被扩散系数 $D_{12}$ 的增加所补偿。因此，在压力梯度 $\\nabla p$ 强的区域，正确的模型预测通量大小几乎是恒定的（假设 $T$ 和 $\\nabla x_1$ 恒定），而不正确的常数 $D_{12}$ 模型则会预测一个跟随压力剖面快速变化的通量。\n\n**第三部分：有符号相对误差的计算**\n\n有符号相对误差 $\\varepsilon$ 定义为：\n$$\n\\varepsilon \\equiv \\frac{|\\mathbf{N}_{1}|_{\\text{const } D} - |\\mathbf{N}_{1}|_{\\text{variable } D}}{|\\mathbf{N}_{1}|_{\\text{variable } D}}\n$$\n我们在喉部计算这两个通量的大小，此处的压力为 $p_t = 1.00 \\times 10^5 \\, \\mathrm{Pa}$，摩尔分数梯度为 $|\\nabla x_1| = 0.040 \\, \\mathrm{m}^{-1}$。\n\n使用可变扩散系数 $D_{12}(p_t) = D_{12, \\mathrm{ref}} \\, p_{\\mathrm{ref}}/p_t$ 的正确通量大小为：\n$$\n|\\mathbf{N}_{1}|_{\\text{variable } D} = c(p_t) D_{12}(p_t) |\\nabla x_1| = \\left(\\frac{p_t}{RT}\\right) \\left(D_{12, \\mathrm{ref}} \\frac{p_{\\mathrm{ref}}}{p_t}\\right) |\\nabla x_1| = \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|\n$$\n假设扩散系数为常数 $D_{12} = D_{12, \\mathrm{ref}}$ 的不正确通量大小为：\n$$\n|\\mathbf{N}_{1}|_{\\text{const } D} = c(p_t) D_{12, \\mathrm{ref}} |\\nabla x_1| = \\frac{p_t}{RT} D_{12, \\mathrm{ref}} |\\nabla x_1|\n$$\n将这些表达式代入 $\\varepsilon$ 的定义中：\n$$\n\\varepsilon = \\frac{\\frac{p_t}{RT} D_{12, \\mathrm{ref}} |\\nabla x_1| - \\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|}{\\frac{p_{\\mathrm{ref}} D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|}\n$$\n公共因子 $\\frac{D_{12, \\mathrm{ref}}}{RT} |\\nabla x_1|$ 从分子和分母中消去：\n$$\n\\varepsilon = \\frac{p_t - p_{\\mathrm{ref}}}{p_{\\mathrm{ref}}} = \\frac{p_t}{p_{\\mathrm{ref}}} - 1\n$$\n这个简化的表达式表明，相对误差仅取决于局部压力与定义扩散系数时所用参考压力的比值。使用给定的值：\n$p_t = 1.00 \\times 10^{5} \\, \\mathrm{Pa}$\n$p_{\\mathrm{ref}} = 5.00 \\times 10^{5} \\, \\mathrm{Pa}$\n\n误差的数值为：\n$$\n\\varepsilon = \\frac{1.00 \\times 10^{5}}{5.00 \\times 10^{5}} - 1 = 0.200 - 1 = -0.800\n$$\n假设扩散系数为常数（在 $p_{\\mathrm{ref}}$ 处取值）会导致在喉部压力 $p_t$ 处对扩散通量大小的预测值低估了 $80\\%$。将最终答案表示为十进制数并四舍五入到四位有效数字，得到 $-0.8000$。",
            "answer": "$$\\boxed{-0.8000}$$"
        },
        {
            "introduction": "这项综合性练习将带您进入实用计算建模的前沿，解决高压合成气反应器等真实世界系统中的扩散问题。您需要将 Stefan-Maxwell 框架扩展至包含热力学非理想性（通过热力学因子矩阵 $\\Gamma$），并为生成的多组分系统实现一个稳健的数值求解器 ()。此练习展示了 Stefan-Maxwell 模型在处理实际工程应用时的全部功能和复杂性。",
            "id": "4067788",
            "problem": "您的任务是设计并实现一个计算程序，该程序使用带有非理想热力学驱动力的 Stefan–Maxwell 框架，计算高压下多组分合成气混合物的一维稳态摩尔扩散通量，并将这些通量与在理想气体假设下获得的通量进行比较。请从计算燃烧学中多组分扩散的有效基本原理出发：作为 Maxwell–Stefan (MS) 关系式基础的组分级动量平衡、化学势的 Gibbs–Duhem 恒等式以及标准的热力学一致性约束。您的程序必须强制执行净摩尔流为零的约束，并且必须明确区分运动学阻力（二元 MS 扩散系数）和热力学驱动力（热力学因子矩阵）的作用。请避免在问题陈述中使用简便公式；您的实现必须遵循第一性原理和推导出的算法。\n\n物理设定和假设：考虑一个一维、稳态、等温、等压的平面板，其中组分由 $i \\in \\{1,\\dots,n\\}$ 索引，$n$ 是合成气中的组分数量。设 $x_i$ 表示组分 $i$ 的摩尔分数，$D_{ij}$ 表示组分 $i$ 和 $j$ 之间的二元 Maxwell–Stefan 扩散系数（$i \\neq j$），$N_i$ 表示组分 $i$ 的摩尔扩散通量，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。设 $P$ 为压力（单位 $\\mathrm{Pa}$），$T$ 为温度（单位 $\\mathrm{K}$），$R$ 为通用气体常数（单位 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），$Z$ 为压缩因子（来自状态方程 (EOS)），$\\Gamma$ 为将摩尔分数向量的梯度映射到修正后驱动力的热力学因子矩阵。使用组分摩尔分数梯度向量 $g$，其分量为 $g_i = \\mathrm{d}x_i/\\mathrm{d}z$（单位 $\\mathrm{m}^{-1}$），并强制 $\\sum_{i=1}^{n} x_i = 1$ 和 $\\sum_{i=1}^{n} g_i = 0$。净摩尔流为零的约束是 $\\sum_{i=1}^{n} N_i = 0$。对于理想气体的 Maxwell–Stefan 比较，使用 $\\Gamma = I$（单位矩阵）和 $Z = 1$。对于非理想计算，使用提供的 $Z$ 和 $\\Gamma$ 值。\n\n推导目标和算法规范：从多组分动量平衡和 Gibbs–Duhem 恒等式出发，推导出 Maxwell–Stefan 运动学阻力如何与热力学驱动力耦合，形成一个关于通量向量 $N$ 的线性系统。展示如何从 $\\{x_i\\}$ 和 $\\{D_{ij}\\}$ 构建系数矩阵，如何从修正后的驱动力 $-c\\,\\Gamma\\,g$（其中 $c$ 是摩尔浓度）构建右侧项，以及如何施加 $\\sum_i N_i = 0$ 来消除零模。您的最终程序必须实现这个推导出的算法，以计算非理想和理想情况下的 $N$，然后使用定义的相对 $L^2$ 误差 $\\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$（无量纲）来量化差异。非理想情况下的摩尔浓度为 $c = P / (Z R T)$，理想情况下的摩尔浓度为 $c_{\\mathrm{ideal}} = P / (R T)$。\n\n单位和输出要求：计算通量 $N_i$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。误差度量是无量纲的。您的程序必须生成单行输出，其中包含所提供测试套件的误差度量，形式为用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_k$ 是一个浮点数。\n\n测试套件：实现三个测试用例，分别涵盖典型的合成气条件、富氢边界条件和富二氧化碳边界条件。在每个用例中，使用组分集 $\\{\\mathrm{H}_2,\\mathrm{CO},\\mathrm{CO}_2,\\mathrm{CH}_4,\\mathrm{N}_2\\}$，因此 $n = 5$。所有二元 Maxwell–Stefan 扩散系数 $D_{ij}$ 的单位均为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，且对 $i,j$ 对称，$D_{ii}$ 不使用。所有梯度 $g_i$ 的单位均为 $\\mathrm{m}^{-1}$。所有压力 $P$ 的单位均为 $\\mathrm{Pa}$，所有温度 $T$ 的单位均为 $\\mathrm{K}$，所有压缩因子 $Z$ 均为无量纲。\n\n- 测试用例 1（典型合成气，高压）：\n  - 摩尔分数 $x = [0.35, 0.40, 0.10, 0.05, 0.10]$。\n  - 梯度 $g = [-0.20, 0.12, 0.04, 0.02, 0.02]$。\n  - 压力 $P = 3.0 \\times 10^{6}\\ \\mathrm{Pa}$。\n  - 温度 $T = 900\\ \\mathrm{K}$。\n  - 压缩因子 $Z = 0.92$。\n  - 二元扩散系数矩阵 $D$ 的非对角线项（对称）：\n    - $D_{\\mathrm{H}_2,\\mathrm{CO}} = 1.8 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CO}_2} = 1.5 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CH}_4} = 2.2 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{N}_2} = 1.9 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CO}_2} = 0.9 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CH}_4} = 1.1 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{N}_2} = 1.0 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{CH}_4} = 0.8 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{N}_2} = 0.7 \\times 10^{-5}$,\n      $D_{\\mathrm{CH}_4,\\mathrm{N}_2} = 1.0 \\times 10^{-5}$。\n  - 热力学因子矩阵 $\\Gamma$ 的项：\n    - $\\Gamma = \\begin{bmatrix}\n      1.12  & -0.01  & -0.02  & -0.01  & -0.08 \\\\\n      -0.02 &  1.08  & 0.01  & -0.01  & -0.06 \\\\\n      -0.01 &  0.01  & 1.18  & -0.02  & -0.16 \\\\\n      -0.01 & -0.02  & -0.03  & 1.10  & -0.04 \\\\\n      -0.08 & -0.03  & -0.09  & -0.03  & 1.25\n    \\end{bmatrix}$。\n\n- 测试用例 2（富氢，更高压力）：\n  - 摩尔分数 $x = [0.70, 0.15, 0.05, 0.05, 0.05]$。\n  - 梯度 $g = [-0.25, 0.15, 0.05, 0.03, 0.02]$。\n  - 压力 $P = 5.0 \\times 10^{6}\\ \\mathrm{Pa}$。\n  - 温度 $T = 1000\\ \\mathrm{K}$。\n  - 压缩因子 $Z = 0.88$。\n  - 二元扩散系数矩阵 $D$ 的非对角线项（对称）：\n    - $D_{\\mathrm{H}_2,\\mathrm{CO}} = 1.3 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CO}_2} = 1.1 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CH}_4} = 1.6 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{N}_2} = 1.4 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CO}_2} = 0.65 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CH}_4} = 0.80 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{N}_2} = 0.75 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{CH}_4} = 0.60 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{N}_2} = 0.55 \\times 10^{-5}$,\n      $D_{\\mathrm{CH}_4,\\mathrm{N}_2} = 0.75 \\times 10^{-5}$。\n  - 热力学因子矩阵 $\\Gamma$ 的项：\n    - $\\Gamma = \\begin{bmatrix}\n      1.20  & -0.02  & -0.03  & -0.01  & -0.14 \\\\\n      -0.03 &  1.12  & 0.02  & -0.01  & -0.10 \\\\\n      -0.02 &  0.02  & 1.22  & -0.03  & -0.19 \\\\\n      -0.01 & -0.02  & -0.03  & 1.15  & -0.08 \\\\\n      -0.14 & -0.07  & -0.12  & -0.05  & 1.30\n    \\end{bmatrix}$。\n\n- 测试用例 3（富二氧化碳，极高压力）：\n  - 摩尔分数 $x = [0.10, 0.30, 0.40, 0.10, 0.10]$。\n  - 梯度 $g = [-0.05, -0.05, 0.08, 0.01, 0.01]$。\n  - 压力 $P = 8.0 \\times 10^{6}\\ \\mathrm{Pa}$。\n  - 温度 $T = 1200\\ \\mathrm{K}$。\n  - 压缩因子 $Z = 0.85$。\n  - 二元扩散系数矩阵 $D$ 的非对角线项（对称）：\n    - $D_{\\mathrm{H}_2,\\mathrm{CO}} = 0.9 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CO}_2} = 0.8 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{CH}_4} = 1.2 \\times 10^{-5}$,\n      $D_{\\mathrm{H}_2,\\mathrm{N}_2} = 1.0 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CO}_2} = 0.50 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{CH}_4} = 0.70 \\times 10^{-5}$,\n      $D_{\\mathrm{CO},\\mathrm{N}_2} = 0.65 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{CH}_4} = 0.45 \\times 10^{-5}$,\n      $D_{\\mathrm{CO}_2,\\mathrm{N}_2} = 0.40 \\times 10^{-5}$,\n      $D_{\\mathrm{CH}_4,\\mathrm{N}_2} = 0.60 \\times 10^{-5}$。\n  - 热力学因子矩阵 $\\Gamma$ 的项：\n    - $\\Gamma = \\begin{bmatrix}\n      1.26  & -0.03  & -0.04  & -0.02  & -0.17 \\\\\n      -0.04 &  1.15  & 0.03  & -0.02  & -0.12 \\\\\n      -0.03 &  0.03  & 1.30  & -0.04  & -0.22 \\\\\n      -0.02 & -0.03  & -0.04  & 1.18  & -0.09 \\\\\n      -0.17 & -0.09  & -0.15  & -0.06  & 1.35\n    \\end{bmatrix}$。\n\n答案规范：对于三个测试用例中的每一个，计算 $N_{\\mathrm{ideal}}$ 和 $N_{\\mathrm{nonideal}}$，然后计算相对 $L^2$ 误差 $r = \\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$（浮点数）。您的程序应生成单行输出，其中包含三个误差，形式为用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_k$ 表示为十进制数。",
            "solution": "该问题根据既定标准进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **组分**：一个一维、稳态、等温、等压的系统，有 $n=5$ 个组分，索引为 $i \\in \\{1,\\dots,5\\}$，对应于 $\\{\\mathrm{H}_2,\\mathrm{CO},\\mathrm{CO}_2,\\mathrm{CH}_4,\\mathrm{N}_2\\}$。\n- **变量**：$x_i$（摩尔分数），$D_{ij}$（二元 Maxwell–Stefan 扩散系数，$\\mathrm{m}^2\\,\\mathrm{s}^{-1}$），$N_i$（摩尔扩散通量，$\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$），$P$（压力，Pa），$T$（温度，K），$R$（通用气体常数，$\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），$Z$（压缩因子），$\\Gamma$（热力学因子矩阵），$g$（摩尔分数梯度向量，$\\mathrm{m}^{-1}$），$c$（摩尔浓度，$\\mathrm{mol}\\,\\mathrm{m}^{-3}$）。\n- **约束和定义**：\n  - $\\sum_{i=1}^{n} x_i = 1$\n  - $\\sum_{i=1}^{n} g_i = 0$\n  - $\\sum_{i=1}^{n} N_i = 0$（净摩尔流为零）\n  - $D_{ij}$ 是对称的（$D_{ij}=D_{ji}$），$D_{ii}$ 不使用。\n  - 非理想浓度：$c = P / (Z R T)$\n  - 理想浓度：$c_{\\mathrm{ideal}} = P / (R T)$\n  - 理想情况假设：$\\Gamma = I$（单位矩阵），$Z = 1$。\n- **推导目标**：从多组分动量平衡和 Gibbs-Duhem 恒等式推导出一个关于通量向量 $N$ 的线性系统，然后实现一个算法来求解它。\n- **输出度量**：相对 $L^2$ 误差：$\\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$。\n- **测试用例**：提供了三个完整的测试用例，每个都指定了 $x$, $g$, $P$, $T$, $Z$ 的值，$D$ 的非对角线元素，以及完整的矩阵 $\\Gamma$。经验证，所有三个用例都满足约束 $\\sum x_i = 1$ 和 $\\sum g_i = 0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题具有科学依据，设定良好且客观。它基于多组分扩散的基本 Stefan-Maxwell 方程，这是输运现象的基石。通过压缩因子 $Z$ 和热力学因子矩阵 $\\Gamma$ 引入热力学非理想性是处理高压系统的标准高级方法。该问题是可形式化的，并且与计算燃烧学直接相关。所有必要的数据都已提供，并且约束条件在内部是一致的。物理值对于指定的条件是现实的。\n\n验证的一个关键点涉及所提供数据的热力学一致性，特别是热力学因子矩阵 $\\Gamma$。Gibbs-Duhem 方程是一个基本的热力学定律，它对化学势 $\\mu_i$ 施加了约束：在恒定 $T$ 和 $P$ 下，$\\sum_{i=1}^n x_i \\mathrm{d}\\mu_i = 0$。化学势梯度通过矩阵 $\\Gamma$ 与摩尔分数梯度相关：$\\nabla \\mu_i = (RT/x_i) \\sum_j (\\Gamma_{ij}/x_j) \\nabla x_j$。应用 Gibbs-Duhem 关系可得出对 $\\Gamma$ 的约束。然而，一个更直接的约束来自于驱动力之和必须为零，这是 Gibbs-Duhem 的一个直接后果。如果驱动力 $d_i = \\nabla \\mu_i$，则 $\\sum x_i d_i = 0$。这并不直接限制 $\\Gamma$ 的列和。尽管如此，在许多标准模型中，$\\Gamma$ 矩阵确实表现出近似的列和恒定性。让我们检查一下所提供的矩阵：\n- **测试用例 1**：列和为 $[1.00, 1.03, 1.05, 1.03, 0.91]$。这些值不相等。\n- **测试用例 2**：列和为 $[1.00, 1.00, 1.01, 1.00, 1.00]$。这些值几乎相等。\n- **测试用例 3**：列和为 $[1.00, 1.00, 1.00, 1.00, 1.00]$。该矩阵是一致的。\n\n测试用例 1 中的不一致性意味着从中导出的广义驱动力之和不严格为零，这与基础物理学相悖。数值程序必须足够稳健，以处理此类数据，这些数据在实际计算中可能由于建模或数据拟合误差而出现。作为一个计算任务，该问题仍然是有效的，前提是推导并实现了一个合适的稳健算法。不一致数据的存在不会使问题无效，反而对求解方法提出了更严格的要求。\n\n**步骤 3：结论与措施**\n\n该问题是**有效的**。核心任务是推导并实现一个用于求解 Stefan-Maxwell 方程的稳健数值算法。其中一个测试用例中的不一致性是一个稳健算法必须处理的特性，并且推导过程必须证明选择这样一种算法的合理性。\n\n### 推导与求解方法\n\nStefan-Maxwell 方程源于对每个组分的动量平衡，将作用于组分 $i$ 的驱动力与来自所有其他组分 $j$ 的摩擦阻力相等。对于一维系统，方程为：\n$$\n\\frac{x_i}{RT} \\frac{\\mathrm{d}\\mu_i}{\\mathrm{d}z} = \\sum_{j=1, j\\neq i}^n \\frac{x_j N_i - x_i N_j}{c D_{ij}}\n$$\n其中 $\\mathrm{d}\\mu_i/\\mathrm{d}z$ 是组分 $i$ 的化学势梯度，它构成了扩散的驱动力。\n\n对于非理想混合物，化学势梯度通过热力学因子矩阵 $\\Gamma$ 与摩尔分数梯度 $g_j = \\mathrm{d}x_j/\\mathrm{d}z$ 相关：\n$$\n\\frac{x_i}{RT} \\frac{\\mathrm{d}\\mu_i}{\\mathrm{d}z} = \\sum_{j=1}^n \\Gamma_{ij} g_j\n$$\n将此代入 Stefan-Maxwell 方程得到：\n$$\n\\sum_{j=1}^n \\Gamma_{ij} g_j = \\sum_{j=1, j\\neq i}^n \\frac{x_j N_i - x_i N_j}{c D_{ij}}\n$$\n让我们定义一个广义驱动力向量 $F_k = -c \\sum_{j=1}^n \\Gamma_{kj} g_j$。负号是惯例，表示通量沿梯度下降方向发生。以向量形式表示，$F = -c\\Gamma g$。重新整理组分 $i$ 的 Stefan-Maxwell 方程：\n$$\n-F_i = \\sum_{j=1, j\\neq i}^n \\left( \\frac{x_j}{D_{ij}} N_i - \\frac{x_i}{D_{ij}} N_j \\right) = N_i \\left( \\sum_{j=1, j\\neq i}^n \\frac{x_j}{D_{ij}} \\right) - \\sum_{j=1, j\\neq i}^n \\frac{x_i}{D_{ij}} N_j\n$$\n这可以写成一个包含 $n$ 个方程的线性系统，用于求解 $n$ 个未知通量 $N_i$：\n$$\n[B]\\{N\\} = \\{F\\}\n$$\n其中 $\\{N\\}$ 是通量列向量，$\\{F\\}$ 是驱动力列向量，$[B]$ 是一个 $n \\times n$ 矩阵，其元素为：\n$$\nB_{ii} = \\sum_{k=1, k\\neq i}^n \\frac{x_k}{D_{ik}}\n$$\n$$\nB_{ij} = -\\frac{x_i}{D_{ij}} \\quad \\text{for } i \\neq j\n$$\n这个方程组是奇异的。矩阵 $[B]$ 有一个由摩尔分数向量 $\\{x\\}$ 张成的零空间，即 $[B]\\{x\\} = \\{0\\}$。这可以通过代入来验证：\n$$\n([B]\\{x\\})_i = \\sum_{j=1}^n B_{ij} x_j = B_{ii}x_i + \\sum_{j=1, j\\neq i}^n B_{ij} x_j = \\left(\\sum_{k=1, k\\neq i}^n \\frac{x_k}{D_{ik}}\\right) x_i - \\sum_{j=1, j\\neq i}^n \\frac{x_i}{D_{ij}} x_j = 0\n$$\n奇异系统 $[B]\\{N\\} = \\{F\\}$ 只有在右侧项 $\\{F\\}$ 与 $[B]$ 的左零空间正交时才有解。$[B]$ 的左零向量是 $\\{u\\} = [1, 1, \\dots, 1]^T$。这意味着存在一个可解性条件：$\\sum_{i=1}^n F_i = 0$。如验证时所讨论的，测试用例 1 可能不满足此条件。\n\n为了获得唯一解并处理潜在的不一致性，我们必须引入净摩尔流为零的约束，$\\sum_{i=1}^n N_i = 0$。这给出了一个包含 $n+1$ 个方程和 $n$ 个未知数的超定系统：\n$$\n\\begin{cases}\n[B]\\{N\\} = \\{F\\} \\\\\n\\mathbf{1}^T \\{N\\} = 0\n\\end{cases}\n$$\n其中 $\\mathbf{1}^T$ 是一个全为1的行向量。该系统可以写成 $[A]\\{N\\} = \\{b\\}$，其中 $[A]$ 是一个 $(n+1) \\times n$ 矩阵，$\\{b\\}$ 是一个 $(n+1) \\times 1$ 向量：\n$$\n[A] = \\begin{bmatrix} B \\\\ \\mathbf{1}^T \\end{bmatrix}, \\quad \\{b\\} = \\begin{bmatrix} F \\\\ 0 \\end{bmatrix}\n$$\n解决这样一个系统最稳健的方法是最小二乘法，特别是当原始方程 $[B]\\{N\\} = \\{F\\}$ 可能不一致时。该方法找到使残差的欧几里得范数 $\\|[A]\\{N\\} - \\{b\\}\\|_2$ 最小化的向量 $\\{N\\}$。这个最小二乘问题的解由正规方程组给出：\n$$\n([A]^T [A]) \\{N\\} = [A]^T \\{b\\}\n$$\n让我们计算这些项：\n$$\n[A]^T [A] = \\begin{bmatrix} B^T & \\mathbf{1} \\end{bmatrix} \\begin{bmatrix} B \\\\ \\mathbf{1}^T \\end{bmatrix} = [B]^T[B] + \\mathbf{1}\\mathbf{1}^T\n$$\n$$\n[A]^T \\{b\\} = \\begin{bmatrix} B^T & \\mathbf{1} \\end{bmatrix} \\begin{bmatrix} F \\\\ 0 \\end{bmatrix} = [B]^T\\{F\\}\n$$\n这就得到了最终的、良定的 $n \\times n$ 线性系统，用于求解通量 $\\{N\\}$：\n$$\n([B]^T[B] + \\mathbf{1}\\mathbf{1}^T) \\{N\\} = [B]^T \\{F\\}\n$$\n矩阵 $([B]^T[B] + \\mathbf{1}\\mathbf{1}^T)$ 是可逆的，因此保证了唯一解。该方法能正确确定热力学一致数据的通量，并通过找到一个总和为零同时最小程度违反 Stefan-Maxwell 关系的通量向量，为不一致数据提供了一个物理上有意义的“最佳拟合”解。\n\n**算法步骤：**\n1.  对于给定的测试用例（非理想或理想），获取输入：$\\{x_i\\}$，$\\{g_i\\}$，$P$，$T$，$Z$，$ [D_{ij}]$，$[\\Gamma_{ij}]$ 和 $R$。对于理想情况，设置 $Z=1$ 和 $\\Gamma=I$。\n2.  计算摩尔浓度：$c = P / (Z R T)$。\n3.  使用摩尔分数 $\\{x_i\\}$ 和扩散系数 $[D_{ij}]$ 构建 $n \\times n$ 矩阵 $[B]$。\n4.  计算 $n \\times 1$ 驱动力向量 $\\{F\\} = -c[\\Gamma]\\{g\\}$。\n5.  构建正规方程组的矩阵：$[C] = [B]^T[B] + \\mathbf{1}\\mathbf{1}^T$，其中 $\\mathbf{1}\\mathbf{1}^T$ 是一个 $n \\times n$ 的全一矩阵。\n6.  构建正规方程组的右侧向量：$\\{h\\} = [B]^T\\{F\\}$。\n7.  求解线性系统 $[C]\\{N\\} = \\{h\\}$ 以找到摩尔扩散通量向量 $\\{N\\}$。\n8.  计算出 $\\{N_{\\mathrm{nonideal}}\\}$ 和 $\\{N_{\\mathrm{ideal}}\\}$ 后，计算相对误差：$r = \\|N_{\\mathrm{nonideal}} - N_{\\mathrm{ideal}}\\|_2 / \\|N_{\\mathrm{ideal}}\\|_2$。\n\n对指定的三个测试用例中的每一个都实施此程序。",
            "answer": "```python\nimport numpy as np\n\ndef solve_fluxes(x, g, D, P, T, Z, Gamma, R):\n    \"\"\"\n    Solves for the molar diffusive fluxes using the Stefan-Maxwell equations.\n\n    This function implements a robust least-squares method to solve the\n    overdetermined system comprising the n Stefan-Maxwell equations and the\n    no-net-molar-flow constraint.\n\n    Args:\n        x (np.ndarray): Mole fraction vector.\n        g (np.ndarray): Mole fraction gradient vector.\n        D (np.ndarray): Matrix of binary Maxwell-Stefan diffusivities.\n        P (float): Pressure in Pa.\n        T (float): Temperature in K.\n        Z (float): Compressibility factor.\n        Gamma (np.ndarray): Thermodynamic factor matrix.\n        R (float): Universal gas constant.\n\n    Returns:\n        np.ndarray: The molar diffusive flux vector N.\n    \"\"\"\n    n = len(x)\n\n    # 1. Calculate molar concentration\n    c = P / (Z * R * T)\n\n    # 2. Construct the B matrix\n    B = np.zeros((n, n))\n    for i in range(n):\n        sum_term = 0\n        for k in range(n):\n            if i == k:\n                continue\n            sum_term += x[k] / D[i, k]\n        B[i, i] = sum_term\n\n        for j in range(n):\n            if i == j:\n                continue\n            B[i, j] = -x[i] / D[i, j]\n\n    # 3. Calculate driving force vector F = -c*Gamma*g\n    F = -c * (Gamma @ g)\n\n    # 4. Formulate and solve the normal equations for the least-squares problem\n    # System: (B^T*B + 11^T) * N = B^T * F\n    C = (B.T @ B) + np.ones((n, n))\n    h = B.T @ F\n    \n    # 5. Solve the linear system C * N = h for N\n    N = np.linalg.solve(C, h)\n\n    return N\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and compute the relative errors.\n    \"\"\"\n    # Universal gas constant in J/(mol K)\n    R = 8.314462618\n\n    # Species indexing: 0:H2, 1:CO, 2:CO2, 3:CH4, 4:N2\n    \n    # Test cases data structure:\n    # (x, g, P, T, Z, D_values, Gamma)\n    # D_values are the 10 off-diagonal elements in the specified order.\n    test_cases = [\n        # Test case 1\n        (\n            np.array([0.35, 0.40, 0.10, 0.05, 0.10]),\n            np.array([-0.20, 0.12, 0.04, 0.02, 0.02]),\n            3.0e6, 900.0, 0.92,\n            [1.8e-5, 1.5e-5, 2.2e-5, 1.9e-5, 0.9e-5, 1.1e-5, 1.0e-5, 0.8e-5, 0.7e-5, 1.0e-5],\n            np.array([\n                [1.12, -0.01, -0.02, -0.01, -0.08],\n                [-0.02, 1.08, 0.01, -0.01, -0.06],\n                [-0.01, 0.01, 1.18, -0.02, -0.16],\n                [-0.01, -0.02, -0.03, 1.10, -0.04],\n                [-0.08, -0.03, -0.09, -0.03, 1.25]\n            ])\n        ),\n        # Test case 2\n        (\n            np.array([0.70, 0.15, 0.05, 0.05, 0.05]),\n            np.array([-0.25, 0.15, 0.05, 0.03, 0.02]),\n            5.0e6, 1000.0, 0.88,\n            [1.3e-5, 1.1e-5, 1.6e-5, 1.4e-5, 0.65e-5, 0.80e-5, 0.75e-5, 0.60e-5, 0.55e-5, 0.75e-5],\n            np.array([\n                [1.20, -0.02, -0.03, -0.01, -0.14],\n                [-0.03, 1.12, 0.02, -0.01, -0.10],\n                [-0.02, 0.02, 1.22, -0.03, -0.19],\n                [-0.01, -0.02, -0.03, 1.15, -0.08],\n                [-0.14, -0.07, -0.12, -0.05, 1.30]\n            ])\n        ),\n        # Test case 3\n        (\n            np.array([0.10, 0.30, 0.40, 0.10, 0.10]),\n            np.array([-0.05, -0.05, 0.08, 0.01, 0.01]),\n            8.0e6, 1200.0, 0.85,\n            [0.9e-5, 0.8e-5, 1.2e-5, 1.0e-5, 0.50e-5, 0.70e-5, 0.65e-5, 0.45e-5, 0.40e-5, 0.60e-5],\n            np.array([\n                [1.26, -0.03, -0.04, -0.02, -0.17],\n                [-0.04, 1.15, 0.03, -0.02, -0.12],\n                [-0.03, 0.03, 1.30, -0.04, -0.22],\n                [-0.02, -0.03, -0.04, 1.18, -0.09],\n                [-0.17, -0.09, -0.15, -0.06, 1.35]\n            ])\n        )\n    ]\n\n    results = []\n    n_species = 5\n\n    for case in test_cases:\n        x, g, P, T, Z, D_values, Gamma = case\n        \n        # Build the symmetric diffusivity matrix D\n        D = np.zeros((n_species, n_species))\n        indices = [(0, 1), (0, 2), (0, 3), (0, 4), (1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4)]\n        for (i, j), val in zip(indices, D_values):\n            D[i, j] = D[j, i] = val\n\n        # Calculate non-ideal fluxes\n        N_nonideal = solve_fluxes(x, g, D, P, T, Z, Gamma, R)\n\n        # Calculate ideal fluxes (Z=1, Gamma=I)\n        Z_ideal = 1.0\n        Gamma_ideal = np.identity(n_species)\n        N_ideal = solve_fluxes(x, g, D, P, T, Z_ideal, Gamma_ideal, R)\n\n        # Compute relative L2 error\n        error_norm = np.linalg.norm(N_nonideal - N_ideal)\n        ideal_norm = np.linalg.norm(N_ideal)\n        \n        if ideal_norm == 0:\n            relative_error = 0.0 # Or handle as an undefined case if appropriate\n        else:\n            relative_error = error_norm / ideal_norm\n            \n        results.append(relative_error)\n\n    print(f\"[{results[0]},{results[1]},{results[2]}]\")\n\nsolve()\n```"
        }
    ]
}