{
    "hands_on_practices": [
        {
            "introduction": "此练习旨在巩固我们对多组分输运中基本定义的理解。通过分析一个来自直接模拟蒙特卡洛（DSMC）的假设性快照，我们将发现一个控制扩散速度的关键代数恒等式，从而加深对质量平均参考系的理解。这个练习强调了在进行数值计算之前，从第一性原理出发的重要性 。",
            "id": "4043170",
            "problem": "在某个瞬时，从一次直接模拟蒙特卡洛 (DSMC) 计算中，对一个反应混合物内的小立方控制体进行采样。该混合物包含三种组分：氢气 ($\\mathrm{H_2}$)、氮气 ($\\mathrm{N_2}$) 和水蒸气 ($\\mathrm{H_2O}$)。获得了该单元的以下数据：\n- 摩尔质量 (单位 $\\mathrm{kg/mol}$): $M_{\\mathrm{H_2}} = 2.016 \\times 10^{-3}$，$M_{\\mathrm{N_2}} = 28.014 \\times 10^{-3}$，$M_{\\mathrm{H_2O}} = 18.015 \\times 10^{-3}$。\n- 数密度 (单位 $\\mathrm{m^{-3}}$): $n_{\\mathrm{H_2}} = 3.0 \\times 10^{25}$，$n_{\\mathrm{N_2}} = 1.0 \\times 10^{25}$，$n_{\\mathrm{H_2O}} = 0.5 \\times 10^{25}$。\n- 组分平均速度 (单位 $\\mathrm{m/s}$): $\\mathbf{v}_{\\mathrm{H_2}} = \\begin{pmatrix}12.0 \\\\ -8.0 \\\\ 5.0\\end{pmatrix}$，$\\mathbf{v}_{\\mathrm{N_2}} = \\begin{pmatrix}2.0 \\\\ -1.0 \\\\ 0.5\\end{pmatrix}$，$\\mathbf{v}_{\\mathrm{H_2O}} = \\begin{pmatrix}-4.0 \\\\ 3.0 \\\\ -2.0\\end{pmatrix}$。\n\n从计算燃烧学中适用于多组分输运的基本连续介质定义出发：\n- 质心（质量平均）速度 $\\mathbf{u}$。\n- 组分 $i$ 的扩散速度 $\\mathbf{V}_i$。\n- 质量分数 $Y_i$。\n\n仅使用这些定义以及数密度、摩尔质量和质量密度之间的基本关系，计算每个组分的 $\\mathbf{u}$ 和 $\\mathbf{V}_i$。然后，通过评估以下无量纲一致性度量，来评估该快照与 Maxwell–Stefan 质量约束的一致性：\n$$\n\\varepsilon \\equiv \\frac{\\left\\|\\sum_{i} Y_i \\,\\mathbf{V}_i\\right\\|_2}{\\sum_{i} Y_i \\,\\|\\mathbf{V}_i\\|_2},\n$$\n其中 $\\|\\cdot\\|_2$ 表示欧几里得范数。将 $\\varepsilon$ 的值报告为一个纯数（无单位）。如果你的最终数值答案需要四舍五入，请保留四位有效数字。否则，报告你的推导所蕴含的精确值。为清晰起见，任何中间矢量均以 $\\mathrm{m/s}$ 表示，但最终报告的 $\\varepsilon$ 必须是无量纲的。",
            "solution": "该问题要求针对一次直接模拟蒙特卡洛 (DSMC) 计算中的气体混合物快照，计算一个无量纲一致性度量 $\\varepsilon$。评估必须基于质量平均速度、扩散速度和质量分数的基本连续介质定义。\n\n首先，我们陈述包含 $N$ 个组分的多组分混合物的相关定义。\n组分 $i$ 的质量密度用 $\\rho_i$ 表示，混合物的总质量密度为 $\\rho = \\sum_{i=1}^{N} \\rho_i$。\n组分 $i$ 的质量分数 $Y_i$ 定义为其质量密度与总质量密度的比值：\n$$\nY_i \\equiv \\frac{\\rho_i}{\\rho}\n$$\n根据此定义，质量分数的和必须为1：$\\sum_{i=1}^{N} Y_i = 1$。\n\n每个组分的平均速度 $\\mathbf{v}_i$ 是已知的。混合物的质心（质量平均）速度 $\\mathbf{u}$ 定义为组分速度的质量分数加权平均值：\n$$\n\\mathbf{u} \\equiv \\frac{\\sum_{i=1}^{N} \\rho_i \\mathbf{v}_i}{\\sum_{i=1}^{N} \\rho_i} = \\frac{\\sum_{i=1}^{N} \\rho_i \\mathbf{v}_i}{\\rho} = \\sum_{i=1}^{N} \\left(\\frac{\\rho_i}{\\rho}\\right) \\mathbf{v}_i = \\sum_{i=1}^{N} Y_i \\mathbf{v}_i\n$$\n\n组分 $i$ 的扩散速度 $\\mathbf{V}_i$ 定义为该组分相对于质心速度 $\\mathbf{u}$ 的速度：\n$$\n\\mathbf{V}_i \\equiv \\mathbf{v}_i - \\mathbf{u}\n$$\n\n问题要求评估一致性度量 $\\varepsilon$：\n$$\n\\varepsilon \\equiv \\frac{\\left\\|\\sum_{i} Y_i \\,\\mathbf{V}_i\\right\\|_2}{\\sum_{i} Y_i \\,\\|\\mathbf{V}_i\\|_2}\n$$\n让我们分析这个表达式的分子。分子中的矢量和，我们称之为 $\\mathbf{S}$，是 $\\mathbf{S} = \\sum_{i} Y_i \\mathbf{V}_i$。我们可以将扩散速度 $\\mathbf{V}_i$ 的定义代入此和式中：\n$$\n\\mathbf{S} = \\sum_{i} Y_i (\\mathbf{v}_i - \\mathbf{u})\n$$\n使用和的分配律，我们可以将其分成两项：\n$$\n\\mathbf{S} = \\sum_{i} Y_i \\mathbf{v}_i - \\sum_{i} Y_i \\mathbf{u}\n$$\n第一项 $\\sum_{i} Y_i \\mathbf{v}_i$ 根据定义就是质心速度 $\\mathbf{u}$。\n对于第二项，质心速度 $\\mathbf{u}$ 是一个相对于组分索引 $i$ 的求和而言的常矢量。因此，它可以从和式中提出来：\n$$\n\\sum_{i} Y_i \\mathbf{u} = \\left(\\sum_{i} Y_i\\right) \\mathbf{u}\n$$\n根据质量分数的定义，它们的和为1：$\\sum_{i} Y_i = 1$。\n将这些结果代回 $\\mathbf{S}$ 的表达式中：\n$$\n\\mathbf{S} = \\mathbf{u} - (1) \\mathbf{u} = \\mathbf{u} - \\mathbf{u} = \\mathbf{0}\n$$\n这个结果 $\\sum_{i} Y_i \\mathbf{V}_i = \\mathbf{0}$ 是一个基本恒等式，基于质心速度、扩散速度和质量分数的标准定义，它由构造可知其必然成立。它不依赖于 DSMC 快照中密度或速度的具体数值；它是这些定义本身的代数推论。该恒等式表示，在质量平均参考系中测量时，由扩散引起的净质量通量为零。\n\n度量 $\\varepsilon$ 的分子是此矢量和的欧几里得范数：\n$$\n\\left\\|\\sum_{i} Y_i \\,\\mathbf{V}_i\\right\\|_2 = \\|\\mathbf{S}\\|_2 = \\|\\mathbf{0}\\|_2 = 0\n$$\n现在，我们必须考虑分母以确保其不为零，这样分数才是有定义的。分母是 $D = \\sum_{i} Y_i \\,\\|\\mathbf{V}_i\\|_2$。\n质量分数 $Y_i$ 由 $Y_i = \\rho_i/\\rho$ 给出。质量密度 $\\rho_i$ 可以通过给定的数密度 $n_i$ 和摩尔质量 $M_i$ 以及 Avogadro 常数 $N_A$ 计算得出，即 $\\rho_i = n_i M_i / N_A$。由于所有给定的 $n_i$ 和 $M_i$ 均为正值，每个 $\\rho_i$ 也为正值，总密度 $\\rho$ 为正值，因此每个质量分数 $Y_i$ 都严格为正。\n分母 $D$ 是非负项之和，因为 $Y_i  0$ 且 $\\|\\mathbf{V}_i\\|_2 \\ge 0$。和 $D$ 仅在每一项都为零时才可能为零，这意味着对所有组分 $i$，都有 $\\|\\mathbf{V}_i\\|_2 = 0$。这将意味着对所有 $i$，都有 $\\mathbf{V}_i = \\mathbf{0}$，这又意味着对所有 $i$，都有 $\\mathbf{v}_i = \\mathbf{u}$。换句话说，所有组分都必须以相同的速度运动，即质心速度。\n让我们检查给定的组分速度数据：\n$\\mathbf{v}_{\\mathrm{H_2}} = \\begin{pmatrix}12.0 \\\\ -8.0 \\\\ 5.0\\end{pmatrix} \\mathrm{m/s}$\n$\\mathbf{v}_{\\mathrm{N_2}} = \\begin{pmatrix}2.0 \\\\ -1.0 \\\\ 0.5\\end{pmatrix} \\mathrm{m/s}$\n$\\mathbf{v}_{\\mathrm{H_2O}} = \\begin{pmatrix}-4.0 \\\\ 3.0 \\\\ -2.0\\end{pmatrix} \\mathrm{m/s}$\n这些速度显然不完全相等。因此，所有的扩散速度 $\\mathbf{V}_i = \\mathbf{v}_i - \\mathbf{u}$ 不可能都是零矢量。因此，至少有一个 $\\|\\mathbf{V}_i\\|_2$ 必须严格为正。由于所有的 $Y_i  0$，分母 $D = \\sum_{i} Y_i \\,\\|\\mathbf{V}_i\\|_2$ 必须严格为正。\n\n分子精确为 $0$ 而分母不为零，度量 $\\varepsilon$ 的值明确为：\n$$\n\\varepsilon = \\frac{0}{D} = 0\n$$\n因此，该问题旨在检验对多组分输运基本定义的理解。直接数值计算所有中间量将是繁琐的，并且由于有限精度算术，可能会产生一个小的非零结果，这在数值上是假象，在数学上是不正确的。解析推导表明，对于使用这些定义处理的数据，质量约束是由构造可知其得到满足的。因此，一旦经过连续介质定义的处理，DSMC 快照的数据事后就与 Maxwell–Stefan 质量约束完全一致。最终答案精确为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "虽然简单的菲克定律将扩散与浓度梯度联系起来，但更高级的模型（如麦克斯韦-斯特凡方程）揭示了其他的驱动力。本练习将深入探讨压力扩散（baro-diffusion），这是一种由压力梯度驱动的现象，并要求您在一个真实的火焰场景中，量化其相对于普通扩散的重要性。这项技能对于判断何时可以使用简化的输运模型至关重要 。",
            "id": "4043171",
            "problem": "考虑一个甲烷-空气系统中的稳态、等温压缩逆流火焰段，其中局部气体混合物可被视为理想气体混合物。取轴向坐标为 $y$， $y$ 值的增加方向为从燃料流指向氧化剂流。在某一特定轴向位置，当地的摩尔分数为\n$$\nx_{\\mathrm{H_2}} = 0.04,\\quad x_{\\mathrm{H_2O}} = 0.16,\\quad x_{\\mathrm{CO_2}} = 0.09,\\quad x_{\\mathrm{CO}} = 0.02,\\quad x_{\\mathrm{N_2}} = 0.67,\\quad x_{\\mathrm{O_2}} = 0.02,\n$$\n当地的静压及其梯度为\n$$\np = 3.03975 \\times 10^{5}\\ \\mathrm{Pa},\\quad \\frac{\\partial p}{\\partial y} = 1.000 \\times 10^{5}\\ \\mathrm{Pa/m}.\n$$\n氢气摩尔分数的轴向梯度为\n$$\n\\frac{\\partial x_{\\mathrm{H_2}}}{\\partial y} = -25\\ \\mathrm{m}^{-1}.\n$$\n假设温度在空间上是均匀的，因此热扩散（也称为 Soret 效应）可以忽略不计。除了流体动力学所隐含的力之外，不存在其他外部体积力。各组分的分子量为\n$$\nM_{\\mathrm{H_2}} = 2,\\ M_{\\mathrm{H_2O}} = 18,\\ M_{\\mathrm{CO_2}} = 44,\\ M_{\\mathrm{CO}} = 28,\\ M_{\\mathrm{N_2}} = 28,\\ M_{\\mathrm{O_2}} = 32\\ \\mathrm{g/mol}.\n$$\n\n从理想气体混合物的 Maxwell–Stefan 多组分扩散描述出发，在质量平均参考系中，推导 $\\mathrm{H_2}$ 组分的扩散驱动力形式，该形式将浓度梯度引起的贡献与压力梯度（压致扩散）引起的贡献分离开。利用这些基本原理，计算在指定位置，$\\mathrm{H_2}$ 组分的压致扩散贡献的量值与浓度扩散贡献的量值之比（一个无量纲数）。将最终答案表示为一个四舍五入到四位有效数字的小数，不带单位。",
            "solution": "本问题要求从 Maxwell–Stefan 方程推导 $\\mathrm{H_2}$ 组分的扩散驱动力，并随后计算压致扩散贡献与浓度扩散贡献之比。该系统是一个稳态、等温的一维逆流火焰。\n\nMaxwell–Stefan 多组分扩散理论体系提供了混合物中作用于各组分的力与它们之间产生的相对运动之间的基本关系。对于理想气体混合物，按题设忽略外部体积力和热扩散（Soret 效应），组分 $i$ 的广义扩散驱动力（记为 $\\mathbf{d}_i$）由下式给出：\n$$\n\\mathbf{d}_i = \\nabla x_i + (x_i - Y_i) \\frac{\\nabla p}{p}\n$$\n此处，$x_i$ 是组分 $i$ 的摩尔分数，$Y_i$ 是其质量分数，$p$ 是静压，而 $\\nabla$ 是梯度算子。这个向量 $\\mathbf{d}_i$ 代表驱动组分 $i$ 扩散的、作用于每摩尔混合物的净热力学力。这个力与混合物中其他组分施加的摩擦阻力相平衡。\n\n问题指定了一个一维系统，其轴向坐标用 $y$ 表示。因此，梯度算子简化为 $\\nabla = \\frac{d}{dy}\\hat{\\mathbf{y}}$，其中 $\\hat{\\mathbf{y}}$ 是 $y$ 方向的单位向量。$\\mathrm{H_2}$ 组分在 $y$ 方向上的标量驱动力分量 $d_{\\mathrm{H_2}}$ 为：\n$$\nd_{\\mathrm{H_2}} = \\frac{d x_{\\mathrm{H_2}}}{dy} + (x_{\\mathrm{H_2}} - Y_{\\mathrm{H_2}}) \\frac{1}{p} \\frac{dp}{dy}\n$$\n根据问题要求，此表达式将总驱动力分为两个不同的物理贡献：\n1. 项 $F_{\\text{conc}} = \\frac{d x_{\\mathrm{H_2}}}{dy}$ 代表由 $\\mathrm{H_2}$ 摩尔分数梯度引起的驱动力。这是普通的浓度扩散，它驱动组分从高浓度区域向低浓度区域扩散。\n2. 项 $F_{\\text{baro}} = (x_{\\mathrm{H_2}} - Y_{\\mathrm{H_2}}) \\frac{1}{p} \\frac{dp}{dy}$ 代表由压力梯度引起的驱动力。这种现象被称为压致扩散或压力扩散。它使组分因响应压力梯度而扩散。扩散的方向取决于项 $(x_i - Y_i)$ 的符号。\n\n问题要求计算 $\\mathrm{H_2}$ 组分的压致扩散贡献量值与浓度扩散贡献量值之间的无量纲比率。该比率为：\n$$\n\\text{Ratio} = \\frac{|F_{\\text{baro}}|}{|F_{\\text{conc}}|} = \\frac{\\left| (x_{\\mathrm{H_2}} - Y_{\\mathrm{H_2}}) \\frac{1}{p} \\frac{dp}{dy} \\right|}{\\left| \\frac{d x_{\\mathrm{H_2}}}{dy} \\right|}\n$$\n为计算此比率，我们必须首先计算氢的质量分数 $Y_{\\mathrm{H_2}}$。质量分数 $Y_i$ 通过以下方程与摩尔分数 $x_i$ 相关：\n$$\nY_i = \\frac{x_i M_i}{M}\n$$\n其中 $M_i$ 是组分 $i$ 的摩尔质量，$M$ 是混合物的平均摩尔质量，定义为 $M = \\sum_j x_j M_j$。\n\n使用给定的摩尔分数和摩尔质量（单位为 $\\mathrm{g/mol}$）：\n$x_{\\mathrm{H_2}} = 0.04$, $M_{\\mathrm{H_2}} = 2$\n$x_{\\mathrm{H_2O}} = 0.16$, $M_{\\mathrm{H_2O}} = 18$\n$x_{\\mathrm{CO_2}} = 0.09$, $M_{\\mathrm{CO_2}} = 44$\n$x_{\\mathrm{CO}} = 0.02$, $M_{\\mathrm{CO}} = 28$\n$x_{\\mathrm{N_2}} = 0.67$, $M_{\\mathrm{N_2}} = 28$\n$x_{\\mathrm{O_2}} = 0.02$, $M_{\\mathrm{O_2}} = 32$\n\n平均摩尔质量 $M$ 计算如下：\n$$\nM = (0.04)(2) + (0.16)(18) + (0.09)(44) + (0.02)(28) + (0.67)(28) + (0.02)(32)\n$$\n$$\nM = 0.08 + 2.88 + 3.96 + 0.56 + 18.76 + 0.64 = 26.88\\ \\mathrm{g/mol}\n$$\n现在，我们可以计算氢的质量分数 $Y_{\\mathrm{H_2}}$：\n$$\nY_{\\mathrm{H_2}} = \\frac{x_{\\mathrm{H_2}} M_{\\mathrm{H_2}}}{M} = \\frac{(0.04)(2)}{26.88} = \\frac{0.08}{26.88}\n$$\n项 $(x_{\\mathrm{H_2}} - Y_{\\mathrm{H_2}})$ 变为：\n$$\nx_{\\mathrm{H_2}} - Y_{\\mathrm{H_2}} = 0.04 - \\frac{0.08}{26.88} = \\frac{0.04 \\times 26.88 - 0.08}{26.88} = \\frac{1.0752 - 0.08}{26.88} = \\frac{0.9952}{26.88}\n$$\n我们已知以下数值：\n$\\frac{d x_{\\mathrm{H_2}}}{dy} = -25\\ \\mathrm{m}^{-1}$\n$p = 3.03975 \\times 10^{5}\\ \\mathrm{Pa}$\n$\\frac{dp}{dy} = 1.000 \\times 10^{5}\\ \\mathrm{Pa/m}$\n\n现在我们将这些值代入比率表达式中。\n浓度扩散贡献的量值为：\n$$\n|F_{\\text{conc}}| = \\left| \\frac{d x_{\\mathrm{H_2}}}{dy} \\right| = |-25\\ \\mathrm{m}^{-1}| = 25\\ \\mathrm{m}^{-1}\n$$\n压致扩散贡献的量值为：\n$$\n|F_{\\text{baro}}| = \\left| \\left( \\frac{0.9952}{26.88} \\right) \\frac{1}{3.03975 \\times 10^{5}} (1.000 \\times 10^{5}) \\right| = \\left( \\frac{0.9952}{26.88} \\right) \\frac{1.000}{3.03975}\\ \\mathrm{m}^{-1}\n$$\n计算 $|F_{\\text{baro}}|$ 的值：\n$$\n|F_{\\text{baro}}| = \\frac{0.9952}{26.88 \\times 3.03975} \\approx \\frac{0.9952}{81.714} \\approx 0.01217909\\ \\mathrm{m}^{-1}\n$$\n最后，我们计算比率：\n$$\n\\text{Ratio} = \\frac{|F_{\\text{baro}}|}{|F_{\\text{conc}}|} = \\frac{0.01217909...}{25} \\approx 0.00048716...\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\text{Ratio} \\approx 0.0004872\n$$\n此结果表明，对于此特定情况，压致扩散对氢的总扩散驱动力的贡献远小于浓度梯度的贡献。",
            "answer": "$$\n\\boxed{0.0004872}\n$$"
        },
        {
            "introduction": "为了连接理论与实践，本练习将指导您为一个典型的一维扩散问题建立一个数值求解器。您将推导控制方程——菲克扩散方程，应用有限差分法进行求解，并根据已知的解析解来验证您的代码。这项综合性练习旨在培养计算输运现象中的核心技能，涵盖从物理建模到数值验证的全过程 。",
            "id": "4043180",
            "problem": "考虑一个一维、等温、等压的二元气体混合物，其中氢气 $\\mathrm{H_2}$ 沿空间坐标 $x \\in [0,L]$ 扩散到氮气 $\\mathrm{N_2}$ 中。假设混合物是静止的，因此宏观对流可以忽略不计，总质量密度 $\\rho$ 是均匀的，并且二元扩散系数 $D_{\\mathrm{H_2,N_2}}$ 是一个常数。在 $x=0$ 处的壁面被瞬时设定并维持在固定的氢气质量分数 $Y_{\\mathrm{H_2}}(x=0,t)=Y_s$，而该区域初始不含氢气，即对于 $x0$ 有 $Y_{\\mathrm{H_2}}(x,0)=0$。远端边界 $x=L$ 处保持 $Y_{\\mathrm{H_2}}(x=L,t)=0$，因此在所关心的时间范围内，有限区域可近似为一个半无限半空间。\n\n从基本组分守恒定律和适用于二元混合物的扩散通量本构关系（源自 Maxwell–Stefan 方程）出发，证明在所述假设下，氢气质量分数遵循一个扩散方程。然后，您将实现一个数值求解器来计算剖面 $Y_{\\mathrm{H_2}}(x,t)$，并使用可以用互补误差函数表示的解析解对其进行验证。\n\n您的程序必须：\n- 在 $x \\in [0,L]$ 的均匀网格上推导出一个显式有限差分时间步进格式，用于将 $Y_{\\mathrm{H_2}}$ 从 $t=0$ 推进到指定的最终时间 $t_{\\text{end}}$，其中边界条件为狄利克雷边界条件 $Y_{\\mathrm{H_2}}(0,t)=Y_s$ 和 $Y_{\\mathrm{H_2}}(L,t)=0$，初始条件为 $Y_{\\mathrm{H_2}}(x,0)=0$。\n- 通过选择与扩散系数和网格间距相符的时间步长 $\\Delta t$ 来遵守显式格式的稳定性条件。\n- 在 $t=t_{\\text{end}}$ 时刻，计算可通过互补误差函数表示的解析参考剖面，该剖面适用于在 $x=0$ 处维持 $Y_s$ 且初始不含氢气的半无限区域。\n- 对于每个测试用例，返回在 $t=t_{\\text{end}}$ 时刻，数值解与解析解的氢气质量分数在整个空间网格上的均方根误差。该误差是无量纲的，因为它基于质量分数。\n\n使用以下一套科学上合理的参数进行测试，所有参数均在 $\\mathrm{T} \\approx \\mathrm{300\\,K}$ 和 $\\mathrm{p} \\approx \\mathrm{1\\,atm}$ 条件下，其中 $D_{\\mathrm{H_2,N_2}} \\approx 7.8 \\times 10^{-5}\\,\\mathrm{m^2/s}$：\n- 案例 A (一般情况): $D = 7.8 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $L = 0.05\\,\\mathrm{m}$, $N_x = 201$ 个网格点, $Y_s = 0.1$ (无量纲), $t_{\\text{end}} = 0.2\\,\\mathrm{s}$, 显式稳定性比率因子 $r=0.4$ 使得 $\\Delta t = r \\,\\Delta t_{\\max}$，其中 $\\Delta t_{\\max} = \\tfrac{1}{2}\\,\\Delta x^2/D$。\n- 案例 B (早期边界层): $D = 7.8 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $L = 0.05\\,\\mathrm{m}$, $N_x = 201$, $Y_s = 0.1$, $t_{\\text{end}} = 0.005\\,\\mathrm{s}$, $r=0.4$。\n- 案例 C (接近稳定性的显式时间步长): $D = 7.8 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $L = 0.05\\,\\mathrm{m}$, $N_x = 201$, $Y_s = 0.1$, $t_{\\text{end}} = 0.1\\,\\mathrm{s}$, $r=0.49$。\n- 案例 D (粗糙空间分辨率): $D = 7.8 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $L = 0.05\\,\\mathrm{m}$, $N_x = 51$, $Y_s = 0.1$, $t_{\\text{end}} = 0.2\\,\\mathrm{s}$, $r=0.4$。\n- 案例 E (不同给定质量分数): $D = 7.8 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $L = 0.05\\,\\mathrm{m}$, $N_x = 201$, $Y_s = 0.05$, $t_{\\text{end}} = 0.2\\,\\mathrm{s}$, $r=0.4$。\n\n物理单位：\n- 报告 $D$ 的单位为 $\\mathrm{m^2/s}$，$L$ 和 $x$ 的单位为 $\\mathrm{m}$，$t$ 的单位为 $\\mathrm{s}$，$Y_{\\mathrm{H_2}}$ 是无量纲的（质量分数）。\n- 最终结果是质量分数的均方根误差，为无量纲浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按 A 到 E 的顺序给出各个案例的结果，例如 $\\left[\\text{error}_A,\\text{error}_B,\\text{error}_C,\\text{error}_D,\\text{error}_E\\right]$。",
            "solution": "用户提供的问题经评估被判定为**有效**。这是一个在输运现象和计算方法领域内提法恰当、具有科学依据的问题。它自成体系，提供了所有必需的参数、初始条件和边界条件。其所依据的菲克扩散物理原理陈述正确，而推导控制方程、实现标准数值格式并与已知解析解进行验证的要求，构成了计算科学领域一项标准且有意义的练习。\n\n**1. 控制方程的推导**\n\n出发点是化学物种 $i$ 在多组分混合物中的通用守恒方程：\n$$\n\\frac{\\partial (\\rho Y_i)}{\\partial t} + \\nabla \\cdot (\\rho Y_i \\mathbf{v}) = -\\nabla \\cdot \\mathbf{J}_i + \\dot{\\omega}_i\n$$\n在此，$\\rho$ 是总质量密度，$Y_i$ 是物种 $i$ 的质量分数，$t$ 是时间，$\\mathbf{v}$ 是流体宏观速度矢量，$\\mathbf{J}_i$ 是物种 $i$ 的扩散质量通量矢量，$\\dot{\\omega}_i$ 是由化学反应引起的物种 $i$ 的质量生成率。\n\n该问题陈述了几个简化假设，我们依次应用它们：\n1.  混合物是静止的，因此宏观对流可以忽略。这意味着 $\\mathbf{v} = \\mathbf{0}$。\n2.  过程是无反应的，因此质量生成率为零：$\\dot{\\omega}_i = 0$。\n3.  扩散是一维的，沿坐标 $x$ 方向，因此散度算子简化为：$\\nabla \\cdot \\rightarrow \\frac{\\partial}{\\partial x}$。\n4.  总质量密度 $\\rho$ 是均匀且恒定的。\n\n将这些假设应用于通用守恒方程，得到：\n$$\n\\frac{\\partial (\\rho Y_i)}{\\partial t} = -\\frac{\\partial J_{i,x}}{\\partial x}\n$$\n由于 $\\rho$ 是常数，它可以从时间导数中提出：\n$$\n\\rho \\frac{\\partial Y_i}{\\partial t} = -\\frac{\\partial J_{i,x}}{\\partial x} \\implies \\frac{\\partial Y_i}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial J_{i,x}}{\\partial x}\n$$\n该问题指定了一个氢气 ($\\mathrm{H_2}$) 和氮气 ($\\mathrm{N_2}$) 的二元混合物。对于这种混合物，扩散通量可以用菲克第一定律建模，这是 Maxwell-Stefan 方程在这些条件下的简化。物种 $i$ 相对于质量平均速度（此处为零）的质量通量由下式给出：\n$$\n\\mathbf{J}_i = -\\rho D_{ij} \\nabla Y_i\n$$\n对于氢气 ($\\mathrm{H_2}$) 向氮气 ($\\mathrm{N_2}$) 的一维扩散，我们将通量分量 $J_{\\mathrm{H_2},x}$ 写为：\n$$\nJ_{\\mathrm{H_2},x} = -\\rho D_{\\mathrm{H_2,N_2}} \\frac{\\partial Y_{\\mathrm{H_2}}}{\\partial x}\n$$\n其中 $D_{\\mathrm{H_2,N_2}}$ 是二元扩散系数。\n\n将此通量的本构关系代入简化的守恒方程，得到：\n$$\n\\frac{\\partial Y_{\\mathrm{H_2}}}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial}{\\partial x} \\left( -\\rho D_{\\mathrm{H_2,N_2}} \\frac{\\partial Y_{\\mathrm{H_2}}}{\\partial x} \\right)\n$$\n问题进一步假设扩散系数 $D_{\\mathrm{H_2,N_2}}$ 是恒定的。由于 $\\rho$ 和 $D_{\\mathrm{H_2,N_2}}$ 都是常数，它们可以从空间导数中移出：\n$$\n\\frac{\\partial Y_{\\mathrm{H_2}}}{\\partial t} = \\frac{\\rho D_{\\mathrm{H_2,N_2}}}{\\rho} \\frac{\\partial^2 Y_{\\mathrm{H_2}}}{\\partial x^2}\n$$\n这简化为一维线性扩散方程：\n$$\n\\frac{\\partial Y_{\\mathrm{H_2}}}{\\partial t} = D_{\\mathrm{H_2,N_2}} \\frac{\\partial^2 Y_{\\mathrm{H_2}}}{\\partial x^2}\n$$\n令 $Y(x,t)$ 表示 $Y_{\\mathrm{H_2}}(x,t)$，$D$ 表示 $D_{\\mathrm{H_2,N_2}}$，我们得到需要求解的最终偏微分方程（PDE）。\n\n**2. 解析解**\n\n问题定义在 $x \\in [0, L]$ 上，边界条件为 $Y(0,t)=Y_s$ 和 $Y(L,t)=0$，初始条件为 $Y(x,0)=0$。问题指出，在所关心的时间段内，有限区域可近似为一个半无限半空间 ($x \\in [0, \\infty)$)。对于边界条件为 $Y(0,t)=Y_s$ 和 $\\lim_{x\\to\\infty} Y(x,t)=0$ 的半无限情况，扩散方程的解析解由下式给出：\n$$\nY_{\\text{analytical}}(x,t) = Y_s \\cdot \\text{erfc}\\left( \\frac{x}{2\\sqrt{Dt}} \\right)\n$$\n其中 $\\text{erfc}(z)$ 是互补误差函数，定义为 $\\text{erfc}(z) = 1 - \\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_z^\\infty e^{-\\xi^2} d\\xi$。该解将作为验证数值结果的参考。只要与 $\\sqrt{Dt}$ 成正比的扩散长度远小于区域长度 $L$，从而确保 $Y(L,t) \\approx 0$，该近似就有效。\n\n**3. 数值格式：显式有限差分法**\n\n我们将区域在空间和时间上进行离散化。均匀空间网格由点 $x_j = j \\cdot \\Delta x$ 定义，其中 $j=0, 1, \\dots, N_x-1$，网格间距为 $\\Delta x = L / (N_x - 1)$。时间被离散为步长 $t_n = n \\cdot \\Delta t$。我们将 $Y(x_j, t_n)$ 的数值近似表示为 $Y_j^n$。\n\n该偏微分方程使用有限差分进行近似：\n- 时间导数用一阶向前差分近似：$\\frac{\\partial Y}{\\partial t} \\approx \\frac{Y_j^{n+1} - Y_j^n}{\\Delta t}$。\n- 空间二阶导数用二阶中心差分近似：$\\frac{\\partial^2 Y}{\\partial x^2} \\approx \\frac{Y_{j+1}^n - 2Y_j^n + Y_{j-1}^n}{\\Delta x^2}$。\n\n将这些代入偏微分方程，得到前向时间中心空间（FTCS）格式：\n$$\n\\frac{Y_j^{n+1} - Y_j^n}{\\Delta t} = D \\left( \\frac{Y_{j+1}^n - 2Y_j^n + Y_{j-1}^n}{\\Delta x^2} \\right)\n$$\n求解 $Y_j^{n+1}$ 得到内部网格点（$j=1, \\dots, N_x-2$）的显式更新规则：\n$$\nY_j^{n+1} = Y_j^n + \\alpha \\left( Y_{j+1}^n - 2Y_j^n + Y_{j-1}^n \\right)\n$$\n其中 $\\alpha = \\frac{D \\Delta t}{\\Delta x^2}$ 是无量纲扩散数。\n\nFTCS 格式是条件稳定的。稳定性要求 $\\alpha \\le \\frac{1}{2}$，这对时间步长施加了约束：$\\Delta t \\le \\frac{\\Delta x^2}{2D}$。问题定义了 $\\Delta t_{\\max} = \\frac{\\Delta x^2}{2D}$ 并将时间步长指定为 $\\Delta t = r \\cdot \\Delta t_{\\max}$，其中稳定性比率因子 $r  1$（例如，$r=0.4$ 或 $r=0.49$）。这给出的扩散数为 $\\alpha = \\frac{D (r \\cdot \\Delta x^2 / (2D))}{\\Delta x^2} = \\frac{r}{2}$。由于 $r1$，稳定性条件 $\\alpha  1/2$ 总是被满足的。\n\n**4. 算法实现**\n\n数值解的计算过程如下：\n1.  对于每个测试用例，指定参数 $D, L, N_x, Y_s, t_{\\text{end}}, r$。\n2.  计算空间网格间距 $\\Delta x = L / (N_x - 1)$ 和时间步长 $\\Delta t = r \\frac{\\Delta x^2}{2D}$。\n3.  总时间步数由 $N_t = \\lceil t_{\\text{end}} / \\Delta t \\rceil$ 确定，以确保模拟运行至 $t_{\\text{end}}$ 或略微超过它。数值模拟的最终时间为 $t_{\\text{final}} = N_t \\Delta t$。\n4.  初始化一个大小为 $N_x$ 的一维数组 `Y` 来表示质量分数剖面。通过设置 $Y_0 = Y_s$ 和对于 $j > 0$ 设置 $Y_j=0$ 来施加初始条件 $Y(x,0)=0$（对于 $x>0$）和 $Y(0,t)=Y_s$（对于 $t \\ge 0$）。远场边界条件为 $Y_{N_x-1}=0$。\n5.  一个时间步进循环迭代 $N_t$ 次。在每次迭代中，使用 FTCS 更新规则根据当前时间步的值计算下一个时间步的 `Y` 值。这通过对内部点使用向量化数组操作来高效执行。在整个模拟过程中，$j=0$ 和 $j=N_x-1$ 处的边界值保持不变。\n6.  循环完成后，数组 `Y` 包含在时间 $t_{\\text{final}}$ 的数值解 $Y_{\\text{numerical}}(x_j)$。\n7.  为了进行一致的比较，在每个网格点 $x_j$ 和相同的最终时间 $t_{\\text{final}}$ 计算解析解 $Y_{\\text{analytical}}(x_j)$。\n8.  计算数值解和解析解之间的均方根误差（RMSE）：\n$$\n\\text{RMSE} = \\sqrt{ \\frac{1}{N_x} \\sum_{j=0}^{N_x-1} \\left( Y_{\\text{numerical}}(x_j) - Y_{\\text{analytical}}(x_j) \\right)^2 }\n$$\n9.  对所提供的每个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Solves the 1D diffusion equation for H2 in N2 using an explicit\n    finite-difference scheme and validates it against the analytical solution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (D, L, Nx, Ys, t_end, r)\n    # D: Diffusion coefficient (m^2/s)\n    # L: Domain length (m)\n    # Nx: Number of grid points\n    # Ys: Hydrogen mass fraction at x=0\n    # t_end: Final simulation time (s)\n    # r: Stability ratio factor for time step calculation\n    test_cases = [\n        # Case A: general case\n        (7.8e-5, 0.05, 201, 0.1, 0.2, 0.4),\n        # Case B: early-time boundary layer\n        (7.8e-5, 0.05, 201, 0.1, 0.005, 0.4),\n        # Case C: near-stability explicit time step\n        (7.8e-5, 0.05, 201, 0.1, 0.1, 0.49),\n        # Case D: coarse spatial resolution\n        (7.8e-5, 0.05, 51, 0.1, 0.2, 0.4),\n        # Case E: different imposed mass fraction\n        (7.8e-5, 0.05, 201, 0.05, 0.2, 0.4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        D, L, Nx, Ys, t_end, r = case\n\n        # --- 1. Grid and Time Step Setup ---\n        # Spatial grid\n        x = np.linspace(0, L, Nx)\n        dx = L / (Nx - 1)\n\n        # Time step calculation based on stability criteria\n        # The stability limit for FTCS is dt = dx^2 / (2*D).\n        # We use a factor r to stay safely below this limit.\n        dt_max = 0.5 * dx**2 / D\n        dt = r * dt_max\n        \n        # Diffusion number alpha = D * dt / dx^2\n        alpha = D * dt / dx**2\n\n        # Number of time steps to reach or exceed t_end\n        num_steps = int(np.ceil(t_end / dt))\n        final_t = num_steps * dt\n\n        # --- 2. Initialization ---\n        # Initialize mass fraction array Y\n        # IC: Y(x, 0) = 0 for x > 0\n        # BC: Y(0, t) = Ys is applied at t=0\n        Y = np.zeros(Nx)\n        Y[0] = Ys\n        # BC: Y(L, t) = 0 is implicitly handled by Y[-1] = 0\n\n        # --- 3. Time Marching Loop (Numerical Solution) ---\n        for _ in range(num_steps):\n            # Use a copy of Y to compute the next step, ensuring an explicit scheme\n            Y_old = Y.copy()\n            # Update interior points using a vectorized FTCS scheme\n            # Y_new[j] = Y_old[j] + alpha * (Y_old[j+1] - 2*Y_old[j] + Y_old[j-1])\n            Y[1:-1] = Y_old[1:-1] + alpha * (Y_old[2:] - 2*Y_old[1:-1] + Y_old[:-2])\n            # Boundary conditions are Dirichlet, so Y[0] and Y[-1] are not updated.\n            # They were set at initialization and remain fixed.\n\n        # At this point, Y is the numerical solution at time final_t\n\n        # --- 4. Analytical Solution ---\n        # The analytical solution for a semi-infinite domain is Ys * erfc(x / (2*sqrt(D*t)))\n        # We evaluate it at the final numerical time for a consistent comparison.\n        # To avoid division by zero if final_t is zero, add a small epsilon.\n        # In this problem, t_end > 0, so final_t will also be > 0.\n        denominator = 2.0 * np.sqrt(D * final_t)\n        # Handle the case x=0, t>0, where the argument is 0. erfc(0)=1.\n        # np.divide handles x/0 correctly for our purposes.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            arg = x / denominator\n        \n        # When x=0 and t>0, arg=0. When x>0 and t->0, arg->inf.\n        # erfc(0) = 1, erfc(inf) = 0.\n        # A special case for t=0 is Y=Ys at x=0 and Y=0 elsewhere.\n        # Our final_t is always > 0.\n        Y_analytical = Ys * erfc(arg)\n\n        # --- 5. Error Calculation ---\n        # Calculate Root-Mean-Square Error (RMSE) between numerical and analytical solutions\n        rmse = np.sqrt(np.mean((Y - Y_analytical)**2))\n        results.append(rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.10f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}