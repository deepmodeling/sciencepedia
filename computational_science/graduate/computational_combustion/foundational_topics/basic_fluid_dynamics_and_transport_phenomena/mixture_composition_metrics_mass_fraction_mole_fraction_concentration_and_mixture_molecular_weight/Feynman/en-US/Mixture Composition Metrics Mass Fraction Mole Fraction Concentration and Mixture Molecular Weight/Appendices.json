{
    "hands_on_practices": [
        {
            "introduction": "This exercise will solidify your understanding of the fundamental metrics used to describe mixture composition. You will derive two distinct, yet equivalent, expressions for species molar concentration: one based on mass fractions and density, and the other on mole fractions and the ideal gas law. By proving their equivalence mathematically and verifying it numerically, you will gain a practical command of the essential relationships that bridge the mass-based and mole-based descriptions of a gas mixture, a critical skill in both theoretical analysis and computational practice .",
            "id": "4040326",
            "problem": "You are to design and implement a complete algorithmic workflow that computes species molar concentrations in gas mixtures from fundamental definitions and laws relevant to computational combustion. The aim is to derive expressions for species concentration from different composition metrics and to prove their equivalence under specified conditions, then verify this equivalence numerically on a test suite.\n\nStarting point and definitions:\n- Let $i$ index chemical species. Let $n_i$ denote the number of moles of species $i$, $m_i$ its mass, and $W_i$ its molecular weight in $\\mathrm{kg/mol}$. Let $n = \\sum_i n_i$ and $m = \\sum_i m_i$ denote the total moles and total mass of the mixture, respectively. Let $V$ denote the total volume of the mixture in $\\mathrm{m^3}$, $\\rho$ its mass density in $\\mathrm{kg/m^3}$, $p$ its pressure in $\\mathrm{Pa}$, and $T$ its temperature in $\\mathrm{K}$. The universal gas constant is $R_u$ in $\\mathrm{J/(mol\\cdot K)}$.\n- Mass fraction is defined by $Y_i = m_i/m$.\n- Mole fraction is defined by $X_i = n_i/n$.\n- Species molar concentration is defined by $c_i = n_i/V$ in $\\mathrm{mol/m^3}$.\n- Mixture molecular weight is defined by $\\bar{W} = m/n$.\n- Under ideal-gas conditions, the Ideal Gas Law holds: $pV = n R_u T$.\n\nTasks:\n1. Starting from the above definitions of $Y_i$, $X_i$, $c_i$, $\\rho$, $\\bar{W}$, $m_i=n_i W_i$, and the ideal-gas law, derive an expression for $c_i$ in terms of $Y_i$, $\\rho$, and $W_i$. Separately, derive an expression for $c_i$ in terms of $X_i$, $p$, and $T$ under ideal-gas conditions. Prove rigorously that these expressions are equivalent when the mixture obeys the ideal-gas law and the definitions of $Y_i$, $X_i$, and $\\bar{W}$ are consistently applied.\n2. Design and implement an algorithm with clear steps that:\n   - Converts between mass fractions $Y_i$ and mole fractions $X_i$ using the definitions.\n   - Computes mixture molecular weight $\\bar{W}$ from $X_i$ and $W_i$.\n   - Computes $\\rho$ from $p$, $T$, and $\\bar{W}$ under ideal-gas conditions.\n   - Computes $c_i$ from $\\rho$ and $Y_i$ using only the fundamental definitions.\n   - Computes $c_i$ from $X_i$, $p$, and $T$ using the ideal-gas law.\n   - Validates the numerical equivalence of the two $c_i$ computations by reporting the maximum absolute discrepancy across species for each test case.\n\nPhysical units and reporting:\n- Molecular weights $W_i$ and mixture molecular weight $\\bar{W}$ must be handled in $\\mathrm{kg/mol}$.\n- Pressure $p$ must be in $\\mathrm{Pa}$, temperature $T$ in $\\mathrm{K}$, density $\\rho$ in $\\mathrm{kg/m^3}$, and concentration $c_i$ in $\\mathrm{mol/m^3}$.\n- Your program must compute and report, for each test case, a single real number equal to the maximum absolute difference $\\max_i |c_i^{(\\text{mass})} - c_i^{(\\text{mole})}|$ in $\\mathrm{mol/m^3}$.\n\nTest suite:\nUse the following scientifically consistent test cases. For each case, the mixture is ideal, and you must construct all necessary quantities internally from the provided parameters.\n\n- Case A (multicomponent methane–air-like mixture):\n  - Species: $\\mathrm{CH_4}$, $\\mathrm{O_2}$, $\\mathrm{N_2}$\n  - $W_i$: $[0.016043, 0.031998, 0.0280134]$ $\\mathrm{kg/mol}$\n  - Mole fractions $X_i$: $[0.05, 0.21, 0.74]$\n  - $p = 101325$ $\\mathrm{Pa}$, $T = 1000$ $\\mathrm{K}$\n- Case B (single-species oxygen):\n  - Species: $\\mathrm{O_2}$\n  - $W_i$: $[0.031998]$ $\\mathrm{kg/mol}$\n  - Mole fractions $X_i$: $[1.0]$\n  - $p = 5 \\times 101325$ $\\mathrm{Pa}$, $T = 300$ $\\mathrm{K}$\n- Case C (trace hydrogen in air at low pressure and high temperature):\n  - Species: $\\mathrm{H_2}$, $\\mathrm{O_2}$, $\\mathrm{N_2}$\n  - $W_i$: $[0.00201588, 0.031998, 0.0280134]$ $\\mathrm{kg/mol}$\n  - Mole fractions $X_i$: $[10^{-6}, 0.21, 0.789999]$\n  - $p = 50000$ $\\mathrm{Pa}$, $T = 1500$ $\\mathrm{K}$\n- Case D (combustion products mixture):\n  - Species: $\\mathrm{CO_2}$, $\\mathrm{H_2O}$\n  - $W_i$: $[0.0440095, 0.01801528]$ $\\mathrm{kg/mol}$\n  - Mole fractions $X_i$: $[0.3, 0.7]$\n  - $p = 2 \\times 101325$ $\\mathrm{Pa}$, $T = 2300$ $\\mathrm{K}$\n\nAnswer specification:\n- For each case, compute both sets of species concentrations and then output a single float equal to the maximum absolute difference across species, in $\\mathrm{mol/m^3}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, preserving the order of the cases as listed: for example, $[r_A,r_B,r_C,r_D]$, where each $r_\\cdot$ is a real number.\n\nNo user input is permitted; all data must be hard-coded as above. Your code must be a complete, runnable program that implements all steps and prints only the specified final line.",
            "solution": "The problem statement has been meticulously reviewed and is determined to be valid. It is scientifically grounded, well-posed, objective, and provides a complete and consistent set of definitions and data. We may therefore proceed with a full solution.\n\nThe core of this problem consists of two parts: a theoretical derivation and proof of equivalence for two methods of calculating species molar concentration, followed by the design and implementation of an algorithm to numerically verify this equivalence.\n\n### Task 1: Theoretical Derivations and Proof of Equivalence\n\nWe are tasked with deriving two distinct expressions for the molar concentration of species $i$, denoted $c_i$, and then proving their equivalence under ideal-gas conditions.\n\n**Derivation 1: Concentration from Mass Fraction, Density, and Molecular Weight**\n\nThis derivation, which we shall use to calculate $c_i^{(\\text{mass})}$, proceeds from the fundamental definitions provided.\n\n1.  The definition of species molar concentration is $c_i = n_i / V$, where $n_i$ is the number of moles of species $i$ and $V$ is the total volume of the mixture.\n2.  The mass of species $i$, $m_i$, is related to its molar quantity $n_i$ and molecular weight $W_i$ by the formula $m_i = n_i W_i$. This can be rearranged to express $n_i$ as $n_i = m_i / W_i$.\n3.  Substituting this expression for $n_i$ into the definition of $c_i$ yields:\n    $$c_i = \\frac{(m_i / W_i)}{V} = \\frac{m_i}{V W_i}$$\n4.  The mass fraction of species $i$, $Y_i$, is defined as $Y_i = m_i / m$, where $m$ is the total mass of the mixture. This can be rearranged to express $m_i$ as $m_i = Y_i m$.\n5.  Substituting this for $m_i$ into our expression for $c_i$:\n    $$c_i = \\frac{Y_i m}{V W_i} = \\frac{Y_i}{W_i} \\left(\\frac{m}{V}\\right)$$\n6.  The term $(m/V)$ is the definition of the mixture's mass density, $\\rho$.\n7.  Therefore, we arrive at the first expression for species molar concentration:\n    $$c_i^{(\\text{mass})} = \\frac{\\rho Y_i}{W_i}$$\n\n**Derivation 2: Concentration from Mole Fraction, Pressure, and Temperature (Ideal Gas)**\n\nThis second derivation, which we will use to calculate $c_i^{(\\text{mole})}$, incorporates the ideal-gas law.\n\n1.  We again begin with the definition of molar concentration, $c_i = n_i / V$.\n2.  The mole fraction of species $i$, $X_i$, is defined as $X_i = n_i / n$, where $n$ is the total number of moles in the mixture. This can be rearranged as $n_i = X_i n$.\n3.  Substituting this expression for $n_i$ into the definition of $c_i$:\n    $$c_i = \\frac{X_i n}{V} = X_i \\left(\\frac{n}{V}\\right)$$\n4.  For a mixture behaving as an ideal gas, the ideal-gas law states $pV = n R_u T$, where $p$ is the pressure, $T$ is the temperature, and $R_u$ is the universal gas constant.\n5.  We can rearrange the ideal-gas law to solve for the term $(n/V)$, which represents the total molar concentration of the mixture:\n    $$\\frac{n}{V} = \\frac{p}{R_u T}$$\n6.  Substituting this result into our expression for $c_i$ yields the second required formula:\n    $$c_i^{(\\text{mole})} = X_i \\frac{p}{R_u T}$$\n\n**Proof of Equivalence**\n\nTo prove that $c_i^{(\\text{mass})} = c_i^{(\\text{mole})}$ under ideal-gas conditions, we must demonstrate that $\\rho Y_i / W_i = X_i p / (R_u T)$ by consistently applying the given definitions. We will start with the expression for $c_i^{(\\text{mass})}$ and show that it can be transformed into the expression for $c_i^{(\\text{mole})}$.\n\n1.  Start with the expression for $c_i^{(\\text{mass})}$:\n    $$c_i^{(\\text{mass})} = \\frac{\\rho Y_i}{W_i}$$\n2.  We need to express the mass-based quantities $\\rho$ and $Y_i$ in terms of mole-based quantities and state variables ($p$, $T$).\n3.  First, let's establish the relationship between mass fraction $Y_i$ and mole fraction $X_i$.\n    -   By definition, $Y_i = m_i / m$.\n    -   Substituting $m_i = n_i W_i$ and $m = \\sum_j m_j = \\sum_j (n_j W_j)$:\n        $$Y_i = \\frac{n_i W_i}{\\sum_j n_j W_j}$$\n    -   Dividing both the numerator and the denominator by the total moles $n = \\sum_j n_j$:\n        $$Y_i = \\frac{(n_i/n) W_i}{\\sum_j (n_j/n) W_j} = \\frac{X_i W_i}{\\sum_j X_j W_j}$$\n    -   The denominator, $\\sum_j X_j W_j$, is the definition of the mean molecular weight of the mixture, $\\bar{W}$. This can be shown from the primary definition $\\bar{W} = m/n$: $\\bar{W} = (\\sum_j m_j)/n = (\\sum_j n_j W_j)/n = \\sum_j (n_j/n) W_j = \\sum_j X_j W_j$.\n    -   Thus, the conversion formula is $Y_i = (X_i W_i)/\\bar{W}$.\n4.  Next, let's express the mixture density $\\rho$ for an ideal gas.\n    -   By definition, $\\rho = m/V$.\n    -   Using the ideal-gas law $V = n R_u T / p$:\n        $$\\rho = \\frac{m}{n R_u T / p} = \\frac{m}{n} \\frac{p}{R_u T}$$\n    -   Recognizing that $\\bar{W} = m/n$, we find the equation of state for density: $\\rho = \\bar{W} p / (R_u T)$.\n5.  Now, substitute the derived expressions for $Y_i$ and $\\rho$ back into the formula for $c_i^{(\\text{mass})}$:\n    $$c_i^{(\\text{mass})} = \\left( \\frac{\\bar{W} p}{R_u T} \\right) \\left( \\frac{X_i W_i}{\\bar{W}} \\right) \\left( \\frac{1}{W_i} \\right)$$\n6.  The mixture molecular weight $\\bar{W}$ in the numerator and denominator cancels out. The species molecular weight $W_i$ also cancels out.\n    $$c_i^{(\\text{mass})} = \\frac{p}{R_u T} X_i$$\n7.  This final expression is identical to the expression for $c_i^{(\\text{mole})}$. This completes the proof:\n    $$c_i^{(\\text{mass})} = c_i^{(\\text{mole})}$$\nThis rigorous proof confirms that both formulations are theoretically equivalent for any gas mixture that obeys the ideal-gas law.\n\n### Task 2: Algorithmic Workflow for Numerical Verification\n\nThe theoretical equivalence will now be numerically verified. The algorithm proceeds as follows for each test case provided. The inputs for each case are the set of species molecular weights $\\{W_i\\}$, the set of species mole fractions $\\{X_i\\}$, the mixture pressure $p$, and the mixture temperature $T$. The universal gas constant $R_u = 8.314462618 \\, \\mathrm{J/(mol \\cdot K)}$ is a required physical constant.\n\n**Step 1: Calculate Concentrations via the Mole Fraction Path**\nThis is the most direct calculation.\n- Compute the total molar concentration of the mixture, $c = p / (R_u T)$.\n- Compute the concentration of each species $i$ using the formula derived previously: $c_i^{(\\text{mole})} = X_i \\cdot c = X_i (p / (R_u T))$.\n\n**Step 2: Calculate Concentrations via the Mass Fraction Path**\nThis path involves several intermediate calculations.\n- **2(a) Compute Mixture Molecular Weight ($\\bar{W}$):** Calculate the mean molecular weight of the mixture as the mole-fraction-weighted average of the species molecular weights:\n  $$\\bar{W} = \\sum_i X_i W_i$$\n- **2(b) Convert Mole Fractions to Mass Fractions ($\\{X_i\\} \\to \\{Y_i\\}$):** For each species, compute its mass fraction using the conversion formula:\n  $$Y_i = \\frac{X_i W_i}{\\bar{W}}$$\n- **2(c) Compute Mixture Density ($\\rho$):** Use the ideal-gas equation of state to find the mixture mass density from the pressure, temperature, and mixture molecular weight:\n  $$\\rho = \\frac{p \\bar{W}}{R_u T}$$\n- **2(d) Compute Species Concentrations ($c_i^{(\\text{mass})}$):** Calculate the concentration for each species using the mass-based formula:\n  $$c_i^{(\\text{mass})} = \\frac{\\rho Y_i}{W_i}$$\n\n**Step 3: Compare Results and Report Discrepancy**\n- For each test case, a set of concentrations $\\{c_i^{(\\text{mole})}\\}$ and $\\{c_i^{(\\text{mass})}\\}$ has been computed.\n- Calculate the element-wise absolute difference between these two sets: $\\Delta c_i = |c_i^{(\\text{mass})} - c_i^{(\\text{mole})}|$.\n- The final result for the test case is the maximum value found in the set of absolute differences:\n  $$\\text{Discrepancy} = \\max_i(\\Delta c_i)$$\nThis discrepancy should be close to zero, limited only by the finite precision of floating-point arithmetic. The implementation of this algorithm is provided in the final answer.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and validates species molar concentrations in gas mixtures.\n\n    This function implements the algorithmic workflow to:\n    1. Calculate species molar concentrations from mole fractions, pressure, and temperature.\n    2. Calculate the same concentrations via an alternative path involving mass fractions\n       and density.\n    3. Numerically validate the equivalence of the two methods by computing the maximum\n       absolute difference in the results for several test cases.\n    \"\"\"\n    # Universal gas constant in J/(mol·K)\n    R_u = 8.31446261815324\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary containing species names, molecular weights (W_i),\n    # mole fractions (X_i), pressure (p), and temperature (T).\n    test_cases = [\n        {\n            \"name\": \"Case A (methane–air-like mixture)\",\n            \"species\": [\"CH4\", \"O2\", \"N2\"],\n            \"W_i\": np.array([0.016043, 0.031998, 0.0280134]),  # kg/mol\n            \"X_i\": np.array([0.05, 0.21, 0.74]),\n            \"p\": 101325.0,  # Pa\n            \"T\": 1000.0,  # K\n        },\n        {\n            \"name\": \"Case B (single-species oxygen)\",\n            \"species\": [\"O2\"],\n            \"W_i\": np.array([0.031998]),  # kg/mol\n            \"X_i\": np.array([1.0]),\n            \"p\": 5.0 * 101325.0,  # Pa\n            \"T\": 300.0,  # K\n        },\n        {\n            \"name\": \"Case C (trace hydrogen in air)\",\n            \"species\": [\"H2\", \"O2\", \"N2\"],\n            \"W_i\": np.array([0.00201588, 0.031998, 0.0280134]),  # kg/mol\n            \"X_i\": np.array([1e-6, 0.21, 0.789999]),\n            \"p\": 50000.0,  # Pa\n            \"T\": 1500.0,  # K\n        },\n        {\n            \"name\": \"Case D (combustion products)\",\n            \"species\": [\"CO2\", \"H2O\"],\n            \"W_i\": np.array([0.0440095, 0.01801528]),  # kg/mol\n            \"X_i\": np.array([0.3, 0.7]),\n            \"p\": 2.0 * 101325.0,  # Pa\n            \"T\": 2300.0,  # K\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        W_i = case[\"W_i\"]\n        X_i = case[\"X_i\"]\n        p = case[\"p\"]\n        T = case[\"T\"]\n\n        # --- Calculation Path 1: Mole Fraction Based ---\n        # c_i = X_i * (p / (R_u * T))\n        total_molar_concentration = p / (R_u * T)\n        c_i_mole = X_i * total_molar_concentration\n\n        # --- Calculation Path 2: Mass Fraction Based ---\n        # 1. Compute mixture molecular weight (W_mixture)\n        # W_mixture = sum(X_i * W_i)\n        W_mixture = np.dot(X_i, W_i)\n\n        # 2. Convert mole fractions (X_i) to mass fractions (Y_i)\n        # Y_i = X_i * W_i / W_mixture\n        # Adding a small epsilon to W_mixture to avoid division by zero in edge cases,\n        # although not strictly necessary with the given test data.\n        Y_i = (X_i * W_i) / (W_mixture + 1e-30)\n\n        # 3. Compute mixture density (rho) using the ideal gas law\n        # rho = p * W_mixture / (R_u * T)\n        rho_mixture = p * W_mixture / (R_u * T)\n\n        # 4. Compute species concentrations (c_i) from mass-based quantities\n        # c_i = rho * Y_i / W_i\n        c_i_mass = (rho_mixture * Y_i) / (W_i + 1e-30)\n\n        # --- Validation ---\n        # Compute the maximum absolute difference between the two computed concentration vectors.\n        # This value should be near machine precision (~0.0).\n        max_abs_diff = np.max(np.abs(c_i_mass - c_i_mole))\n        results.append(max_abs_diff)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Numerical simulations are subject to floating-point errors, which can cause computed mass fractions to violate fundamental physical laws, such as summing to one and remaining non-negative. This practice introduces a rigorous and elegant method to correct these inconsistencies by projecting the erroneous data onto the valid state space, known as the standard simplex . By implementing this optimization-based normalization, you will learn a powerful technique to ensure your computational models remain physically meaningful, a crucial step in developing robust and reliable simulation software.",
            "id": "4040311",
            "problem": "You are given a finite set of chemical species indexed by $i \\in \\{1,\\dots,n\\}$ in a reacting mixture. The mass fraction of species $i$ is denoted by $Y_i$, the mole fraction is denoted by $X_i$, and the molecular weight (mass per mole) of species $i$ is denoted by $W_i$. Due to floating-point roundoff and algorithmic truncation in numerical combustion simulations, one often obtains a vector of perturbed mass fractions $\\tilde{Y} \\in \\mathbb{R}^n$ that may fail to satisfy the two core constraints of mass fractions, namely $\\sum_{i=1}^n Y_i = 1$ and $Y_i \\ge 0$ for all $i$. The mixture molecular weight $\\bar{W}_{\\mathrm{mix}}$ is defined in terms of the mass fractions and molecular weights by $$\\bar{W}_{\\mathrm{mix}} = \\left(\\sum_{i=1}^n \\frac{Y_i}{W_i}\\right)^{-1},$$ which is well-defined when $Y_i \\ge 0$, $\\sum_i Y_i = 1$, and $W_i > 0$ for all $i$. Your task is to derive, from first principles, a normalization strategy that takes any $\\tilde{Y}$ produced by floating-point computation and returns a corrected vector $Y^\\star$ satisfying the mass-fraction constraints with the smallest possible perturbation measured in an appropriate metric. You must begin from the fundamental constraints of mass conservation for mass fractions (nonnegativity and unit-sum), and the basic optimization principle of minimizing a physically meaningful deviation from $\\tilde{Y}$, and reason to a concrete algorithm. Then, you must prove that the strategy is feasible on the simplex $$\\Delta^{n-1} = \\left\\{Y \\in \\mathbb{R}^n \\;\\middle|\\; \\sum_{i=1}^n Y_i = 1,\\; Y_i \\ge 0 \\;\\forall i\\right\\}.$$ In your proof, you should establish existence, uniqueness, and that the constructed $Y^\\star$ lies in $\\Delta^{n-1}$, together with an argument that the perturbation is minimal in the chosen metric.\n\nProgrammatic requirements: Implement your normalization strategy in a program and apply it to the test suite below. For each test case, compute the corrected mass fractions $Y^\\star$ and the corresponding mixture molecular weight $\\bar{W}_{\\mathrm{mix}}$ using the corrected $Y^\\star$. The mass fraction is dimensionless, while the molecular weights must be treated in units of $\\mathrm{kg}/\\mathrm{mol}$, and your program must report $\\bar{W}_{\\mathrm{mix}}$ in $\\mathrm{kg}/\\mathrm{mol}$. You must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result should itself be a two-element list whose first element is the list of corrected mass fractions $Y^\\star$ (in the same species order as given) and whose second element is the scalar $\\bar{W}_{\\mathrm{mix}}$ in $\\mathrm{kg}/\\mathrm{mol}$. The final output must have the form $$\\left[\\left[Y^\\star_{(1)}, \\bar{W}_{\\mathrm{mix},(1)}\\right], \\left[Y^\\star_{(2)}, \\bar{W}_{\\mathrm{mix},(2)}\\right], \\dots \\right],$$ where $Y^\\star_{(k)}$ is a list of $n$ floats and $\\bar{W}_{\\mathrm{mix},(k)}$ is a float.\n\nFundamental bases permitted for derivation:\n- The mass fraction constraints $\\sum_{i=1}^n Y_i = 1$ and $Y_i \\ge 0$ for all $i$.\n- The principle of minimizing deviation according to a norm-induced distance in $\\mathbb{R}^n$ (choose and justify an appropriate norm from first principles in this context).\n- The definition of mixture molecular weight $\\bar{W}_{\\mathrm{mix}}$ in terms of mass fractions and molecular weights.\n\nTest suite:\n- Species and molecular weights: Consider $n = 5$ species with molecular weights (in $\\mathrm{kg}/\\mathrm{mol}$) in the following fixed order: nitrogen ($\\mathrm{N}_2$) $W_1 = 0.0280134$, oxygen ($\\mathrm{O}_2$) $W_2 = 0.0319988$, carbon dioxide ($\\mathrm{CO}_2$) $W_3 = 0.0440095$, water ($\\mathrm{H}_2\\mathrm{O}$) $W_4 = 0.01801528$, methane ($\\mathrm{CH}_4$) $W_5 = 0.01604246$.\n- Test cases specify $\\tilde{Y}$ as follows in the same species order:\n    1. Happy-path perturbation: $\\tilde{Y}^{(1)} = [0.755, 0.205, 0.001, 0.039, 0.0009]$.\n    2. Tiny negative entry due to roundoff with near-unit sum: $\\tilde{Y}^{(2)} = [0.7000000001, 0.2099999999, -10^{-12}, 0.09, 0]$.\n    3. Extreme rounding collapse (boundary stress test): $\\tilde{Y}^{(3)} = [0, 0, 0, 0, 0]$.\n    4. Already near-feasible with tiny sum error: $\\tilde{Y}^{(4)} = [0.7800000000001, 0.2099999999999, 0, 0.01, 0]$.\n    5. Highly skewed with a tiny negative entry: $\\tilde{Y}^{(5)} = [1 + 10^{-9}, -10^{-9}, 0, 0, 0]$.\n\nAnswer specification:\n- For each test case, return the corrected $Y^\\star$ and the resulting $\\bar{W}_{\\mathrm{mix}}$ as described above. All numbers must be reported as plain decimal floats without units in the output line, but your derivation and program must treat $W_i$ in $\\mathrm{kg}/\\mathrm{mol}$ and interpret $\\bar{W}_{\\mathrm{mix}}$ in $\\mathrm{kg}/\\mathrm{mol}$.\n- Your program must produce exactly one line containing the list $$\\left[\\left[Y^\\star_{(1)}, \\bar{W}_{\\mathrm{mix},(1)}\\right],\\left[Y^\\star_{(2)}, \\bar{W}_{\\mathrm{mix},(2)}\\right],\\left[Y^\\star_{(3)}, \\bar{W}_{\\mathrm{mix},(3)}\\right],\\left[Y^\\star_{(4)}, \\bar{W}_{\\mathrm{mix},(4)}\\right],\\left[Y^\\star_{(5)}, \\bar{W}_{\\mathrm{mix},(5)}\\right]\\right].$$\n\nFeasibility and coverage:\n- Your test suite includes a general case, cases with small negative entries, a boundary case of total collapse, and a highly skewed case. You must ensure your normalization strategy returns valid mass fractions $Y^\\star$ in all cases with $\\sum_i Y^\\star_i = 1$ and $Y^\\star_i \\ge 0$.\n- The output for each test case must be a list consisting of a list of floats and a float, as specified, ensuring that each test case’s answer is quantifiable and automatically verifiable.",
            "solution": "The problem of correcting a perturbed vector of mass fractions $\\tilde{Y} \\in \\mathbb{R}^n$ to satisfy physical constraints is a classic problem in computational modeling, particularly in fields like combustion where mass conservation is paramount. The goal is to find a corrected vector $Y^\\star$ that adheres to the constraints defining the standard simplex, $\\Delta^{n-1}$, while being as \"close\" as possible to the original perturbed vector $\\tilde{Y}$.\n\nThe constraints for a vector of mass fractions $Y = [Y_1, \\dots, Y_n]^T$ are:\n1.  Sum-to-one constraint: $\\sum_{i=1}^n Y_i = 1$.\n2.  Non-negativity constraint: $Y_i \\ge 0$ for all $i \\in \\{1, \\dots, n\\}$.\n\nThe task is to find a vector $Y^\\star$ that minimizes the deviation from $\\tilde{Y}$ subject to these constraints. This can be formally expressed as an optimization problem.\n\nFirst, we must choose a metric to quantify the deviation $\\|Y^\\star - \\tilde{Y}\\|$. The most natural and mathematically convenient choice is the standard Euclidean distance (or $L_2$ norm). Minimizing the distance $\\|Y^\\star - \\tilde{Y}\\|_2$ is equivalent to minimizing its square, $\\|Y^\\star - \\tilde{Y}\\|_2^2$. This choice is justified because it yields a strictly convex quadratic objective function, which guarantees a unique solution. It treats perturbations in all species fractions equally, without introducing any arbitrary weighting.\n\nThe optimization problem is therefore to find the Euclidean projection of $\\tilde{Y}$ onto the simplex $\\Delta^{n-1}$:\n$$\n\\begin{align*}\n\\underset{Y^\\star \\in \\mathbb{R}^n}{\\text{minimize}}  \\quad f(Y^\\star) = \\frac{1}{2} \\|Y^\\star - \\tilde{Y}\\|_2^2 = \\frac{1}{2} \\sum_{i=1}^n (Y^\\star_i - \\tilde{Y}_i)^2 \\\\\n\\text{subject to}  \\quad \\sum_{i=1}^n Y^\\star_i = 1 \\\\\n \\quad Y^\\star_i \\ge 0 \\quad \\text{for } i = 1, \\dots, n\n\\end{align*}\n$$\nThe factor of $\\frac{1}{2}$ is included for algebraic convenience when taking derivatives. This is a convex optimization problem (a quadratic program) as the objective function is strictly convex and the constraint set is convex.\n\nWe solve this using the Karush-Kuhn-Tucker (KKT) conditions. The Lagrangian $\\mathcal{L}$ for this problem is:\n$$ \\mathcal{L}(Y^\\star, \\mu, \\lambda) = \\frac{1}{2} \\sum_{i=1}^n (Y^\\star_i - \\tilde{Y}_i)^2 - \\mu \\left( \\sum_{i=1}^n Y^\\star_i - 1 \\right) - \\sum_{i=1}^n \\lambda_i Y^\\star_i $$\nwhere $\\mu$ is the Lagrange multiplier for the equality constraint and $\\lambda_i$ are the multipliers for the non-negativity inequality constraints.\n\nThe KKT conditions for optimality are:\n1.  **Stationarity:** $\\frac{\\partial \\mathcal{L}}{\\partial Y^\\star_i} = Y^\\star_i - \\tilde{Y}_i - \\mu - \\lambda_i = 0$ for all $i \\in \\{1,\\dots,n\\}$. This implies $Y^\\star_i = \\tilde{Y}_i + \\mu + \\lambda_i$.\n2.  **Primal Feasibility:** $\\sum_{i=1}^n Y^\\star_i = 1$ and $Y^\\star_i \\ge 0$ for all $i$.\n3.  **Dual Feasibility:** $\\lambda_i \\ge 0$ for all $i$.\n4.  **Complementary Slackness:** $\\lambda_i Y^\\star_i = 0$ for all $i$.\n\nFrom the complementary slackness condition, for each species $i$, either $\\lambda_i=0$ or $Y^\\star_i=0$.\n- If $Y^\\star_i > 0$, then we must have $\\lambda_i = 0$. The stationarity condition simplifies to $Y^\\star_i = \\tilde{Y}_i + \\mu$. The condition $Y^\\star_i > 0$ implies $\\tilde{Y}_i + \\mu > 0$.\n- If $Y^\\star_i = 0$, then $\\lambda_i \\ge 0$. The stationarity condition gives $0 = \\tilde{Y}_i+\\mu+\\lambda_i$. Since $\\lambda_i \\ge 0$, this requires $\\tilde{Y}_i + \\mu \\le 0$.\n\nCombining these two cases gives a compact expression for the solution $Y^\\star_i$:\n$$ Y^\\star_i = \\max(0, \\tilde{Y}_i + \\mu) $$\nThis elegant result shows that the solution is obtained by a simple uniform shift of the original vector $\\tilde{Y}$ by a value $\\mu$, followed by clipping at zero. The only unknown is the Lagrange multiplier $\\mu$.\n\nTo find $\\mu$, we enforce the primal feasibility constraint $\\sum_{i=1}^n Y^\\star_i = 1$:\n$$ \\sum_{i=1}^n \\max(0, \\tilde{Y}_i + \\mu) = 1 $$\nLet's define a function $g(\\mu) = \\sum_{i=1}^n \\max(0, \\tilde{Y}_i + \\mu)$. We need to find the root of $g(\\mu) = 1$. The function $g(\\mu)$ is continuous, piecewise linear, and monotonically non-decreasing. This guarantees that a unique solution for $\\mu$ exists.\n\nTo solve for $\\mu$ efficiently, let us sort the components of $\\tilde{Y}$ in descending order: $u_1 \\ge u_2 \\ge \\dots \\ge u_n$. The condition $\\tilde{Y}_i + \\mu > 0$ will hold for the components with the largest values of $\\tilde{Y}_i$. Let $\\rho$ be the number of elements for which this condition holds. These $\\rho$ elements form the \"active set\" whose values will be positive in the final solution. For these $\\rho$ elements, $Y^\\star_i = u_i + \\mu$, and for the remaining $n-\\rho$ elements, $Y^\\star_i = 0$.\n\nThe sum constraint becomes:\n$$ \\sum_{j=1}^\\rho (u_j + \\mu) = 1 \\implies \\left(\\sum_{j=1}^\\rho u_j\\right) + \\rho \\mu = 1 $$\nSolving for $\\mu$ yields:\n$$ \\mu = \\frac{1 - \\sum_{j=1}^\\rho u_j}{\\rho} $$\nThe correct value of $\\rho$ is the one for which the active set is consistent, i.e., $u_j + \\mu > 0$ for $j \\le \\rho$ and $u_j + \\mu \\le 0$ for $j > \\rho$. The critical condition is at the boundary of the active set, $j=\\rho$. We need to find the largest $\\rho \\in \\{1, \\dots, n\\}$ such that:\n$$ u_\\rho + \\frac{1 - \\sum_{j=1}^\\rho u_j}{\\rho} > 0 $$\nThis inequality can be rewritten as $\\rho u_\\rho + 1 - \\sum_{j=1}^\\rho u_j > 0$, or $\\rho u_\\rho > \\left(\\sum_{j=1}^\\rho u_j\\right) - 1$.\n\nThis leads to the following algorithm:\n1.  Given the input vector $\\tilde{Y} \\in \\mathbb{R}^n$.\n2.  Sort $\\tilde{Y}$ in descending order to get a new vector $u = [u_1, u_2, \\dots, u_n]$.\n3.  Compute the cumulative sums of $u$, $S_j = \\sum_{i=1}^j u_i$.\n4.  Find the largest integer $\\rho \\in \\{1,\\dots,n\\}$ that satisfies the condition $j u_j > S_j - 1$ for $j=1, \\dots, \\rho$.\n5.  With this $\\rho$, calculate the shift parameter $\\mu = (1 - S_\\rho) / \\rho$.\n6.  The final corrected vector $Y^\\star$ is then computed element-wise as $Y^\\star_i = \\max(0, \\tilde{Y}_i + \\mu)$.\n\nA proof of this algorithm's correctness must establish existence, uniqueness, and feasibility of the solution $Y^\\star$.\n- **Existence and Uniqueness:** The objective function $f(Y^\\star)$ is strictly convex and continuous. The constraint set, the simplex $\\Delta^{n-1}$, is a non-empty, closed, and convex (and thus compact) subset of $\\mathbb{R}^n$. The Weierstrass extreme value theorem guarantees the existence of a minimum. The strict convexity of $f$ guarantees this minimum is unique.\n- **Feasibility:** By construction, $Y^\\star_i = \\max(0, \\tilde{Y}_i + \\mu)$ ensures $Y^\\star_i \\ge 0$. The sum is $\\sum_{i=1}^n Y^\\star_i = \\sum_{i=1}^n \\max(0, \\tilde{Y}_i + \\mu) = \\sum_{j=1}^\\rho (u_j + \\mu)$, where the second sum is over the elements of the sorted vector $u$ corresponding to the active set. This evaluates to $(\\sum_{j=1}^\\rho u_j) + \\rho \\mu = S_\\rho + \\rho \\frac{1 - S_\\rho}{\\rho} = S_\\rho + 1 - S_\\rho = 1$. Thus, the solution $Y^\\star$ lies on the simplex $\\Delta^{n-1}$.\n- **Optimality:** Since the optimization problem is convex, the KKT conditions are both necessary and sufficient for a global optimum. Our derivation found a unique solution that satisfies these conditions, hence it is the unique optimal solution.\n\nFinally, with the corrected mass fractions $Y^\\star$, the mixture molecular weight $\\bar{W}_\\mathrm{mix}$ is computed using its definition:\n$$ \\bar{W}_{\\mathrm{mix}} = \\left(\\sum_{i=1}^n \\frac{Y^\\star_i}{W_i}\\right)^{-1} $$\nwhere $W_i > 0$ are the molecular weights of the species. Since $Y^\\star_i \\ge 0$ and $\\sum_i Y^\\star_i=1$, and not all $Y^\\star_i$ can be $0$, the denominator is well-defined and positive, ensuring $\\bar{W}_\\mathrm{mix}$ is also well-defined and positive.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the mass fraction normalization problem for a suite of test cases.\n    \"\"\"\n\n    # Define the species molecular weights (kg/mol) in a fixed order.\n    # N2, O2, CO2, H2O, CH4\n    molecular_weights = np.array([\n        0.0280134,    # W_1 (N2)\n        0.0319988,    # W_2 (O2)\n        0.0440095,    # W_3 (CO2)\n        0.01801528,   # W_4 (H2O)\n        0.01604246    # W_5 (CH4)\n    ])\n\n    # Define the test cases for the perturbed mass fraction vector tilde_Y.\n    test_cases = [\n        # 1. Happy-path perturbation\n        np.array([0.755, 0.205, 0.001, 0.039, 0.0009]),\n        # 2. Tiny negative entry due to roundoff\n        np.array([0.7000000001, 0.2099999999, -1e-12, 0.09, 0.0]),\n        # 3. Extreme rounding collapse (boundary stress test)\n        np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n        # 4. Already near-feasible with tiny sum error\n        np.array([0.7800000000001, 0.2099999999999, 0.0, 0.01, 0.0]),\n        # 5. Highly skewed with a tiny negative entry\n        np.array([1.0 + 1e-9, -1e-9, 0.0, 0.0, 0.0])\n    ]\n\n    results = []\n    for y_tilde in test_cases:\n        # Normalize the mass fraction vector\n        y_star = _project_to_simplex(y_tilde)\n        \n        # Calculate the mixture molecular weight using the corrected mass fractions\n        # W_mix = (sum(Y_i / W_i))^-1\n        # To avoid division by zero if a W_i is zero (not the case here),\n        # we can filter. Since W_i are all > 0, this is robust.\n        # Likewise, if a Y_i is zero, its term is zero.\n        w_mix = 1.0 / np.sum(y_star / molecular_weights)\n        \n        # Store the results for this case. y_star is converted to a list for formatting.\n        results.append([y_star.tolist(), w_mix])\n\n    # Format the final output string exactly as specified in the problem statement.\n    # The format is [[Y*_1, W_mix_1], [Y*_2, W_mix_2], ...]\n    # where each Y* is a list of floats.\n    output_str = f\"[{','.join(f'[{str(y)},{w}]' for y, w in results)}]\"\n    print(output_str)\n\ndef _project_to_simplex(y_tilde: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Projects a vector onto the standard simplex using a fast projection algorithm.\n\n    This algorithm finds the Euclidean projection of a vector y_tilde onto the\n    simplex {x | sum(x) = 1, x_i >= 0}, which is equivalent to solving the\n    optimization problem:\n    \n    minimize   0.5 * ||x - y_tilde||^2\n    subject to sum(x) = 1, x_i >= 0\n    \n    Args:\n        y_tilde: A numpy array representing the vector to be projected.\n\n    Returns:\n        A numpy array representing the projected vector on the simplex.\n    \"\"\"\n    n = y_tilde.shape[0]\n    \n    # Sort the input vector in descending order.\n    u = np.sort(y_tilde)[::-1]\n    \n    # Calculate the cumulative sum of the sorted vector.\n    s = np.cumsum(u)\n    \n    # Find the largest index rho such that u_rho + (1 - s_rho) / rho > 0.\n    # This is implemented by finding all j that satisfy the condition and taking the max.\n    # The condition is vectorized as: u_j > (s_j - 1) / j for j=1...n\n    # Using 1-based indexing for j in the formula corresponds to 0-based index `j-1` in arrays.\n    j_indices = np.arange(1, n + 1)\n    condition = u > (s - 1) / j_indices\n    \n    # The set of indices j for which the condition holds is never empty because for j=1,\n    # u_1 > (u_1 - 1)/1 is 0 > -1, which is always true.\n    # So we can safely access the last element.\n    rho = np.where(condition)[0][-1] + 1\n    \n    # Calculate the Lagrange multiplier (the shift value mu).\n    # mu = (1 - s[rho-1]) / rho, where s[rho-1] is the sum of the top rho elements.\n    mu = (1 - s[rho - 1]) / rho\n    \n    # Apply the shift and clip at zero to get the projected vector.\n    y_star = np.maximum(0, y_tilde + mu)\n    \n    return y_star\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond simple conversions, a deep understanding of mixture metrics involves analyzing their sensitivity to one another, especially in the context of measurement or numerical error. This advanced exercise guides you through the derivation of the Jacobian matrix for the mass-to-mole fraction transformation, $\\frac{\\partial X_i}{\\partial Y_k}$ . Using this derivative, you will explore the important phenomenon of error propagation, revealing why small inaccuracies in the mass fraction of a heavy species can lead to large relative errors in the mole fraction of a light trace species, a critical insight for interpreting experimental data and simulation results.",
            "id": "4040305",
            "problem": "Consider a chemically inert gas mixture relevant to computational combustion consisting of $N$ species indexed by $i \\in \\{1,2,\\dots,N\\}$, each with fixed molecular weight $W_i$. Let $m_i$ and $n_i$ denote the mass and mole number of species $i$, respectively, and let $m = \\sum_{j=1}^{N} m_j$ and $n = \\sum_{j=1}^{N} n_j$ denote the total mass and total mole number of the mixture. The mass fraction of species $i$ is defined as $Y_i = m_i / m$ and the mole fraction of species $i$ is defined as $X_i = n_i / n$. The mixture molecular weight is defined by $\\bar{W} = m / n$. The species molecular weights $W_i$ relate mass and mole number by $m_i = W_i n_i$. Assume $\\sum_{i=1}^{N} Y_i = 1$ and $\\sum_{i=1}^{N} X_i = 1$, and treat $\\{Y_i\\}$ as the primary composition variables.\n\nStarting strictly from these definitions and identities and without invoking any pre-derived conversion formulas, derive the inverse mapping from mass fractions to mole fractions, $X_i(\\{Y_j\\},\\{W_j\\})$, and then compute the mixed partial derivative $\\partial X_i / \\partial Y_k$ in closed form for arbitrary $i$ and $k$. Express your final derivative in terms of $X_i$, $\\bar{W}$, the molecular weights, and Kronecker delta $\\delta_{ik}$ only.\n\nThen, using the derivative you obtain, reason about error propagation: explain why small absolute errors in the mass fraction of a heavy species (large $W_k$) can lead to disproportionately large relative errors in the mole fraction of a light trace species (small $W_i$ and $X_i \\ll 1$), even when the resulting absolute change in $X_i$ is small. Your explanation should rely solely on the structure and scaling of the derivative you derived, and should articulate the role of $\\bar{W}$ and $W_k$.\n\nProvide the final derivative as a single closed-form analytic expression. No numerical evaluation is required. The final expression should be free of units.",
            "solution": "This problem requires the derivation of the Jacobian matrix for the mass-to-mole fraction transformation, $\\partial X_i / \\partial Y_k$, followed by an analysis of error propagation based on its structure.\n\n### Derivation of the Inverse Mapping and its Derivative\n\n**1. Derive the mapping $X_i(\\{Y_j\\})$**\n\nWe begin from the fundamental definitions. The mole fraction of species $i$ is $X_i = n_i / n$. We can express the number of moles of species $i$, $n_i$, and the total number of moles, $n$, in terms of mass fractions.\n\n-   The number of moles of species $i$ is $n_i = m_i / W_i$. Since $m_i = m Y_i$, we have $n_i = m Y_i / W_i$.\n-   The total number of moles is $n = \\sum_j n_j = \\sum_j (m_j / W_j) = \\sum_j (m Y_j / W_j) = m \\sum_j (Y_j / W_j)$.\n\nSubstituting these into the definition of $X_i$:\n$$ X_i = \\frac{n_i}{n} = \\frac{m Y_i / W_i}{m \\sum_j (Y_j / W_j)} = \\frac{Y_i / W_i}{\\sum_j (Y_j / W_j)} $$\nThis is the required inverse mapping. The denominator is the reciprocal of the mixture molecular weight, $\\bar{W} = (\\sum_j Y_j / W_j)^{-1}$. This allows us to write the mapping in a more compact form that is useful for differentiation:\n$$ X_i = \\frac{Y_i}{W_i} \\bar{W} $$\n\n**2. Compute the partial derivative $\\partial X_i / \\partial Y_k$**\n\nWe differentiate the expression $X_i = (Y_i/W_i) \\bar{W}$ with respect to $Y_k$. Since $\\bar{W}$ is a function of all mass fractions $\\{Y_j\\}$, we must use the product rule:\n$$ \\frac{\\partial X_i}{\\partial Y_k} = \\frac{\\partial}{\\partial Y_k} \\left( \\frac{Y_i}{W_i} \\bar{W} \\right) = \\frac{1}{W_i} \\left[ \\frac{\\partial Y_i}{\\partial Y_k} \\bar{W} + Y_i \\frac{\\partial \\bar{W}}{\\partial Y_k} \\right] $$\nThe derivative $\\partial Y_i / \\partial Y_k$ is simply the Kronecker delta, $\\delta_{ik}$. We now need the derivative of $\\bar{W}$ with respect to $Y_k$:\n$$ \\frac{\\partial \\bar{W}}{\\partial Y_k} = \\frac{\\partial}{\\partial Y_k} \\left( \\sum_j \\frac{Y_j}{W_j} \\right)^{-1} $$\nUsing the chain rule, this becomes:\n$$ \\frac{\\partial \\bar{W}}{\\partial Y_k} = -1 \\cdot \\left( \\sum_j \\frac{Y_j}{W_j} \\right)^{-2} \\cdot \\frac{\\partial}{\\partial Y_k}\\left( \\sum_j \\frac{Y_j}{W_j} \\right) = -(\\bar{W})^2 \\cdot \\frac{1}{W_k} = -\\frac{\\bar{W}^2}{W_k} $$\nSubstituting this back into the expression for $\\partial X_i / \\partial Y_k$:\n$$ \\frac{\\partial X_i}{\\partial Y_k} = \\frac{1}{W_i} \\left[ \\delta_{ik} \\bar{W} - Y_i \\frac{\\bar{W}^2}{W_k} \\right] = \\frac{\\bar{W}}{W_i}\\delta_{ik} - \\frac{Y_i \\bar{W}^2}{W_i W_k} $$\nTo express the result in the desired terms, we substitute $Y_i = X_i W_i / \\bar{W}$:\n$$ \\frac{\\partial X_i}{\\partial Y_k} = \\frac{\\bar{W}}{W_i}\\delta_{ik} - \\frac{(X_i W_i / \\bar{W}) \\bar{W}^2}{W_i W_k} = \\frac{\\bar{W}}{W_i}\\delta_{ik} - \\frac{X_i \\bar{W}}{W_k} $$\nThis is the final closed-form expression for the partial derivative.\n\n### Analysis of Error Propagation\n\nThe derived Jacobian provides the first-order sensitivity of mole fractions to perturbations in mass fractions. A set of physically consistent errors $\\{\\Delta Y_k\\}$ must sum to zero, $\\sum_k \\Delta Y_k = 0$, to preserve the unity of mass fractions. The total change in a given mole fraction $X_i$ is given by the total differential:\n$$ \\Delta X_i \\approx \\sum_k \\frac{\\partial X_i}{\\partial Y_k} \\Delta Y_k $$\nSubstituting our derivative:\n$$ \\Delta X_i \\approx \\sum_k \\left( \\frac{\\bar{W}}{W_i}\\delta_{ik} - \\frac{X_i \\bar{W}}{W_k} \\right) \\Delta Y_k = \\frac{\\bar{W}}{W_i} \\Delta Y_i - X_i \\bar{W} \\sum_k \\frac{\\Delta Y_k}{W_k} $$\nThe relative error in $X_i$ is therefore:\n$$ \\frac{\\Delta X_i}{X_i} \\approx \\frac{\\bar{W}}{X_i W_i}\\Delta Y_i - \\bar{W} \\sum_k \\frac{\\Delta Y_k}{W_k} $$\nLet's analyze the scenario from the prompt: we are interested in the error in a light trace species $i$ (small $W_i$, $X_i \\ll 1$) resulting from an error in a heavy species $k$ (large $W_k$). As this is an off-diagonal effect ($i \\ne k$), we can assume $\\Delta Y_i = 0$. The expression for the relative error simplifies to:\n$$ \\frac{\\Delta X_i}{X_i} \\approx - \\bar{W} \\sum_k \\frac{\\Delta Y_k}{W_k} $$\nNow, consider a realistic error scenario: a small error $\\Delta Y_k = \\epsilon$ in the measured mass fraction of a heavy species $k$ is compensated for primarily by an opposite error in a very light species $b$ (e.g., hydrogen), so $\\Delta Y_b \\approx -\\epsilon$. Other errors $\\Delta Y_j$ are negligible. The sum becomes:\n$$ \\sum_k \\frac{\\Delta Y_k}{W_k} \\approx \\frac{\\Delta Y_k}{W_k} + \\frac{\\Delta Y_b}{W_b} = \\epsilon \\left( \\frac{1}{W_k} - \\frac{1}{W_b} \\right) $$\nSince species $k$ is heavy ($W_k$ is large) and species $b$ is light ($W_b$ is small), we have $1/W_k \\ll 1/W_b$. The sum is dominated by the light species term:\n$$ \\sum_k \\frac{\\Delta Y_k}{W_k} \\approx -\\frac{\\epsilon}{W_b} = -\\frac{\\Delta Y_k}{W_b} $$\nSubstituting this back into the relative error expression for species $i$:\n$$ \\frac{\\Delta X_i}{X_i} \\approx - \\bar{W} \\left( -\\frac{\\Delta Y_k}{W_b} \\right) = \\left( \\frac{\\bar{W}}{W_b} \\right) \\Delta Y_k $$\nThis equation reveals the mechanism for disproportionate error propagation. The factor $\\bar{W} / W_b$ acts as an amplification factor. This ratio can be large if the average molecular weight of the mixture $\\bar{W}$ (often dominated by bulk species like $\\text{N}_2$ or $\\text{CO}_2$) is much larger than the molecular weight $W_b$ of the light species that numerically or experimentally absorbs the balancing error. For instance, in an air-like mixture ($\\bar{W} \\approx 0.029\\,\\text{kg/mol}$) where an error is balanced by hydrogen ($W_b \\approx 0.002\\,\\text{kg/mol}$), the amplification factor is approximately 14.5. A small 0.1% absolute error in a heavy species mass fraction could thus cause a ~1.5% relative error in the mole fraction of any other trace species.\n\nCrucially, even with this large relative error, the absolute change $\\Delta X_i = X_i (\\Delta X_i/X_i)$ remains small because $X_i \\ll 1$ for a trace species. This explains the entire phenomenon described in the problem.",
            "answer": "$$ \\boxed{ \\frac{\\partial X_i}{\\partial Y_k} = \\frac{\\bar{W}}{W_i}\\delta_{ik} - \\frac{X_i \\bar{W}}{W_k} } $$"
        }
    ]
}