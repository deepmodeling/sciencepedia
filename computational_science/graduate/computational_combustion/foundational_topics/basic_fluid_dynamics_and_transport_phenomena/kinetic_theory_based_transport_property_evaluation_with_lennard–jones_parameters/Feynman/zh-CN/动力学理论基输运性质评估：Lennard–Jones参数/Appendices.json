{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的计算模型之前，理解其输出如何依赖于输入参数至关重要。本练习利用对数敏感性分析来剖析双组分扩散系数的一阶Chapman–Enskog公式，从而揭示压力（$p$）、分子尺寸（$\\sigma_{AB}$）和相互作用能（$\\epsilon_{AB}$）各自扮演的独特角色。掌握这种分析方法对于不确定性量化和模型简化至关重要。",
            "id": "4034004",
            "problem": "在与计算燃烧学相关的稀薄二元气体混合物中，组分A和B的二元扩散系数 (BDC) $D_{AB}$ 是根据玻尔兹曼方程的 Chapman–Enskog (CE) 一阶解从气体动理论中求得的。分子间相互作用由 Lennard–Jones (LJ) $12$–$6$ 势建模，其非相似对参数为 $\\sigma_{AB}$ 和 $\\epsilon_{AB}$。用于扩散的约化碰撞积分，记作 $\\Omega^{(1,1)}(T^{*})$，仅取决于约化温度 $T^{*}$，其中 $T^{*} \\equiv k_{B} T / \\epsilon_{AB}$ 且 $k_{B}$ 是玻尔兹曼常数。假设稀薄混合物处于总压 $p$、固定的绝对温度 $T$、固定的组分和固定的分子质量下，因此约化质量是恒定的。将 $\\sigma_{AB}$ 和 $\\epsilon_{AB}$ 视为独立的交叉参数。\n\n从稀薄气体的基本气体动理论标度关系出发——即输运系数与数密度成反比，涉及由 $\\sigma_{AB}$ 决定的碰撞截面，并且球对称势与硬球行为的实际偏差由无量纲碰撞积分捕捉——推导对数灵敏度的显式表达式：\n$$\nS_{x} \\equiv \\left.\\frac{\\partial \\ln D_{AB}}{\\partial \\ln x}\\right|_{T}\n$$\n关于 $x \\in \\{p,\\ \\sigma_{AB},\\ \\epsilon_{AB}\\}$，保持 $T$ 固定，并将所有其他未明确变化的参数视为常数。将你的最终答案以 $\\big(S_{p},\\ S_{\\sigma_{AB}},\\ S_{\\epsilon_{AB}}\\big)$ 的顺序表示为一个 $1 \\times 3$ 的行向量，形式为符号表达式。不要代入任何数值。最终表达式中不需要单位。",
            "solution": "该问题要求推导二元扩散系数 $D_{AB}$ 关于总压 $p$、Lennard-Jones (LJ) 尺寸参数 $\\sigma_{AB}$ 和 LJ 能量参数 $\\epsilon_{AB}$ 的对数灵敏度。灵敏度定义为 $S_{x} \\equiv \\left.\\frac{\\partial \\ln D_{AB}}{\\partial \\ln x}\\right|_{T}$。\n\n出发点是稀薄气体混合物中二元扩散系数的 Chapman–Enskog 一阶表达式：\n$$\nD_{AB} = \\frac{3}{16} \\frac{\\sqrt{2\\pi k_{B}^{3} T^{3} / m_{AB}}}{p \\pi \\sigma_{AB}^{2} \\Omega^{(1,1)}(T^{*})}\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度，$m_{AB}$ 是 A-B 对的约化质量，$p$ 是总压，$\\sigma_{AB}$ 是非相似对相互作用的 LJ 尺寸参数，而 $\\Omega^{(1,1)}(T^{*})$ 是扩散的约化碰撞积分。碰撞积分是约化温度 $T^{*}$ 的函数，其定义为：\n$$\nT^{*} \\equiv \\frac{k_{B} T}{\\epsilon_{AB}}\n$$\n其中 $\\epsilon_{AB}$ 是非相似对相互作用的 LJ 能量参数。\n\n为了进行此灵敏度分析，我们保持温度 $T$ 恒定。分子质量以及因此的约化质量 $m_{AB}$ 也是固定的。项 $k_{B}$ 是一个普适常数。因此，我们可以将本次分析中所有恒定的项归并为一个常数 $C$：\n$$\nD_{AB} = \\frac{C}{p \\sigma_{AB}^{2} \\Omega^{(1,1)}(T^{*})}\n$$\n其中 $C$ 是一个相对于 $p$、$\\sigma_{AB}$ 和 $\\epsilon_{AB}$ 的常数。\n\n为计算对数灵敏度，我们首先对 $D_{AB}$ 的表达式取自然对数：\n$$\n\\ln D_{AB} = \\ln C - \\ln p - \\ln(\\sigma_{AB}^{2}) - \\ln(\\Omega^{(1,1)}(T^{*}))\n$$\n利用性质 $\\ln(x^{a}) = a \\ln x$，上式简化为：\n$$\n\\ln D_{AB} = \\ln C - \\ln p - 2\\ln \\sigma_{AB} - \\ln(\\Omega^{(1,1)}(T^{*}))\n$$\n现在我们可以通过对此表达式进行偏微分来计算所需的灵敏度。对数灵敏度 $S_x$ 等价于 $\\ln D_{AB}$ 关于 $\\ln x$ 的偏导数。\n\n**1. 关于压力的灵敏度，$S_{p}$**\n我们计算 $\\ln D_{AB}$ 关于 $\\ln p$ 的偏导数，同时保持所有其他变量为常数。\n$$\nS_{p} = \\frac{\\partial (\\ln D_{AB})}{\\partial (\\ln p)} = \\frac{\\partial}{\\partial (\\ln p)} \\left( \\ln C - \\ln p - 2\\ln \\sigma_{AB} - \\ln(\\Omega^{(1,1)}(T^{*})) \\right)\n$$\n当对 $p$ 求导时，参数 $\\sigma_{AB}$ 和 $\\epsilon_{AB}$ (以及因此的 $T^{*}$) 保持不变。因此，右侧的所有项都是常数，除了 $-\\ln p$。\n$$\nS_{p} = \\frac{\\partial(-\\ln p)}{\\partial(\\ln p)} = -1\n$$\n\n**2. 关于 LJ 尺寸参数的灵敏度，$S_{\\sigma_{AB}}$**\n我们计算 $\\ln D_{AB}$ 关于 $\\ln \\sigma_{AB}$ 的偏导数，同时保持所有其他变量为常数。\n$$\nS_{\\sigma_{AB}} = \\frac{\\partial (\\ln D_{AB})}{\\partial (\\ln \\sigma_{AB})} = \\frac{\\partial}{\\partial (\\ln \\sigma_{AB})} \\left( \\ln C - \\ln p - 2\\ln \\sigma_{AB} - \\ln(\\Omega^{(1,1)}(T^{*})) \\right)\n$$\n当对 $\\sigma_{AB}$ 求导时，参数 $p$ 和 $\\epsilon_{AB}$ (以及因此的 $T^{*}$) 保持不变。唯一依赖于 $\\sigma_{AB}$ 的项是 $-2\\ln \\sigma_{AB}$。\n$$\nS_{\\sigma_{AB}} = \\frac{\\partial(-2\\ln \\sigma_{AB})}{\\partial(\\ln \\sigma_{AB})} = -2\n$$\n\n**3. 关于 LJ 能量参数的灵敏度，$S_{\\epsilon_{AB}}$**\n这是最复杂的计算，因为 $\\epsilon_{AB}$ 出现在碰撞积分函数 $\\Omega^{(1,1)}$ 的自变量中。我们计算 $\\ln D_{AB}$ 关于 $\\ln \\epsilon_{AB}$ 的偏导数。\n$$\nS_{\\epsilon_{AB}} = \\frac{\\partial (\\ln D_{AB})}{\\partial (\\ln \\epsilon_{AB})} = \\frac{\\partial}{\\partial (\\ln \\epsilon_{AB})} \\left( \\ln C - \\ln p - 2\\ln \\sigma_{AB} - \\ln(\\Omega^{(1,1)}(T^{*})) \\right)\n$$\n唯一依赖于 $\\epsilon_{AB}$ 的项是 $-\\ln(\\Omega^{(1,1)}(T^{*}))$。\n$$\nS_{\\epsilon_{AB}} = - \\frac{\\partial (\\ln(\\Omega^{(1,1)}(T^{*})))}{\\partial (\\ln \\epsilon_{AB})}\n$$\n我们应用链式法则。设函数为 $f(g(x)) = \\ln(\\Omega^{(1,1)}(T^{*}(\\epsilon_{AB})))$。关于 $\\ln \\epsilon_{AB}$ 的导数是：\n$$\nS_{\\epsilon_{AB}} = - \\frac{d (\\ln \\Omega^{(1,1)})}{d T^{*}} \\frac{\\partial T^{*}}{\\partial (\\ln \\epsilon_{AB})}\n$$\n我们必须计算项 $\\frac{\\partial T^{*}}{\\partial (\\ln \\epsilon_{AB})}$。令 $u = \\ln \\epsilon_{AB}$，这意味着 $\\epsilon_{AB} = \\exp(u)$。$T^{*}$ 的定义是 $T^{*} = k_{B} T / \\epsilon_{AB}$。代入 $\\epsilon_{AB}$ 得到 $T^{*} = k_{B} T \\exp(-u)$。由于导数是在常数 $T$ 下求的，我们有：\n$$\n\\frac{\\partial T^{*}}{\\partial (\\ln \\epsilon_{AB})} = \\frac{\\partial T^{*}}{\\partial u} = \\frac{d}{du} \\left( k_{B} T \\exp(-u) \\right) = -k_{B} T \\exp(-u) = - \\frac{k_{B} T}{\\epsilon_{AB}} = - T^{*}\n$$\n将此代回 $S_{\\epsilon_{AB}}$ 的表达式中：\n$$\nS_{\\epsilon_{AB}} = - \\frac{d (\\ln \\Omega^{(1,1)})}{d T^{*}} (-T^{*}) = T^{*} \\frac{d (\\ln \\Omega^{(1,1)})}{d T^{*}}\n$$\n这个表达式可以更紧凑地写成对数导数的定义。算子 $\\frac{d}{d(\\ln x)}$ 等价于 $x \\frac{d}{dx}$。因此，$T^{*} \\frac{d}{d T^{*}}$ 等价于 $\\frac{d}{d(\\ln T^{*})}$。\n$$\nS_{\\epsilon_{AB}} = \\frac{d \\ln(\\Omega^{(1,1)}(T^{*}))}{d \\ln T^{*}}\n$$\n这是关于 $\\epsilon_{AB}$ 的灵敏度的最终符号形式。它表示碰撞积分关于约化温度的对数斜率。\n\n最终答案是行向量 $(S_{p}, S_{\\sigma_{AB}}, S_{\\epsilon_{AB}})$。\n$$\nS_{p} = -1\n$$\n$$\nS_{\\sigma_{AB}} = -2\n$$\n$$\nS_{\\epsilon_{AB}} = \\frac{d \\ln(\\Omega^{(1,1)}(T^{*}))}{d \\ln T^{*}}\n$$\n将这些组合成一个 $1 \\times 3$ 的行向量，得到最终结果。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1 & -2 & \\frac{d \\ln(\\Omega^{(1,1)}(T^{*}))}{d \\ln T^{*}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "将理论知识转化为实际的计算代码是计算科学的核心挑战之一。在大型模拟中，直接从第一性原理计算碰撞积分的成本过高，因此我们通常依赖于经验拟合或插值方法。本练习将通过量化多项式拟合与三次样条插值这两种常用近似方法的误差，来探讨它们的优劣，这是开发高效、可靠科学计算软件的一项基本技能。",
            "id": "4034013",
            "problem": "考虑在计算燃烧学中进行输运性质计算时，近似求解气体动理论中的折合碰撞积分所产生的插值误差。对于一对指数 $(l,s)$，折合碰撞积分 $\\Omega^{(l,s)}(T^*)$ 是折合温度 $T^*$ 的一个无量纲函数，其中 $T^* = k_{\\mathrm{B}} T / \\epsilon$，$ \\epsilon$ 是 Lennard-Jones 势阱深度。在与燃烧相关的工况下，对于可用 Lennard-Jones 势描述的单原子或简单多原子气体，通常使用经过充分验证的经验关联式来评估 $\\Omega^{(l,s)}(T^*)$。\n\n从折合温度的核心定义 $T^* = k_{\\mathrm{B}} T / \\epsilon$（其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数）出发，考虑以下针对 $(l,s) = (1,1)$ 和 $(l,s) = (2,2)$ 的折合碰撞积分的经验证关联式：\n- 对于 $(l,s) = (1,1)$:\n$$\n\\Omega^{(1,1)}(T^*) = \\frac{1.06036}{(T^*)^{0.15610}} + 0.19300 \\, e^{-0.47635 \\, T^*} + 1.03587 \\, e^{-1.52996 \\, T^*} + 1.76474 \\, e^{-3.89411 \\, T^*}\n$$\n- 对于 $(l,s) = (2,2)$:\n$$\n\\Omega^{(2,2)}(T^*) = \\frac{1.16145}{(T^*)^{0.14874}} + 0.52487 \\, e^{-0.77320 \\, T^*} + 2.16178 \\, e^{-2.43787 \\, T^*}\n$$\n\nLennard-Jones 参数 $(\\epsilon/k_{\\mathrm{B}}, \\sigma)$ 取决于物质种类，其中 $\\epsilon/k_{\\mathrm{B}}$ 的单位是开尔文，$\\sigma$ 是一个尺寸参数，单位是埃。为解决此问题，仅需要 $\\epsilon/k_{\\mathrm{B}}$ 来计算 $T^*$。\n\n您需要实现一个程序，该程序能够：\n- 对于每种物质，使用 $T^* = T / (\\epsilon/k_{\\mathrm{B}})$ 将物理温度范围 $T \\in [300\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$ 转换为 $T^*$ 值的精细网格，并在此网格上计算 $\\Omega^{(l,s)}(T^*)$ 的参考（基准）值。\n- 在特定于物质的 $T^*$ 范围内构造 $\\Omega^{(l,s)}(T^*)$ 的两个近似函数：\n    1. 一个5次多项式拟合 $p(T^*)$，通过对由 $T \\in [300\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$ 导出的 $T^*$ 范围内的12个均匀间隔训练点进行最小二乘法得到。\n    2. 一个三次样条插值 $s(T^*)$，使用默认的“非扭结”边界条件，并在相同的12个点上进行训练。\n- 在 $T^*$ 上的一个包含200个点的均匀评估网格上，评估最大相对插值误差：\n$$\nE_{\\mathrm{rel}} = \\max_{T^* \\in \\mathcal{G}} \\left| \\frac{\\widehat{\\Omega}^{(l,s)}(T^*) - \\Omega^{(l,s)}(T^*)}{\\Omega^{(l,s)}(T^*)} \\right|\n$$\n其中 $\\widehat{\\Omega}^{(l,s)}(T^*)$ 是多项式近似或样条近似，$\\mathcal{G}$ 是评估网格。\n\n使用以下包含 Lennard-Jones 参数 $\\epsilon/k_{\\mathrm{B}}$（单位：开尔文）值的物质测试套件，这些物质是燃烧混合物的代表：\n- 物质1：氮气，其 $\\epsilon/k_{\\mathrm{B}} = 97.0$。\n- 物质2：氢气，其 $\\epsilon/k_{\\mathrm{B}} = 38.0$。\n- 物质3：水，其 $\\epsilon/k_{\\mathrm{B}} = 809.1$。\n\n对于每种物质和每个 $(l,s) \\in \\{(1,1),(2,2)\\}$ 的 $\\Omega^{(l,s)}$，计算两个误差指标：\n- 5次多项式拟合的最大相对误差，以小数值表示。\n- 三次样条拟合的最大相对误差，以小数值表示。\n\n因此，总共有12个输出，按物质和碰撞积分排序：\n- 物质1：$\\Omega^{(1,1)}$ 多项式误差，$\\Omega^{(1,1)}$ 样条误差，$\\Omega^{(2,2)}$ 多项式误差，$\\Omega^{(2,2)}$ 样条误差。\n- 物质2：顺序相同。\n- 物质3：顺序相同。\n\n实现要求：\n- 物理温度范围为 $T \\in [300\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$；必须使用此范围来定义每种物质对应的 $T^*$ 范围。\n- 误差必须表示为无量纲小数，并四舍五入到6位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序如上所述。例如，输出格式必须严格符合 $[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_{12}]$ 的形式，其中每个 $\\text{result}_i$ 是一个四舍五入到6位小数的小数。\n\n设计考量：\n- 从气体动理论中折合温度 $T^* = k_{\\mathrm{B}} T / \\epsilon$ 的定义和作为充分验证基础的 $\\Omega^{(l,s)}(T^*)$ 经验关联式出发。\n- 仅使用在特定物质的 $T^*$ 范围内均匀间隔的 $T^*$ 点上采样的 $\\Omega^{(l,s)}(T^*)$ 值来构造多项式和样条近似。\n- 对于给定的 $\\epsilon/k_{\\mathrm{B}}$ 值，确保在由 $T \\in [300\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$ 导出的整个 $T^*$ 范围内数值的稳定性。",
            "solution": "该问题要求评估两种常见的近似方法——多项式最小二乘拟合和三次样条插值——应用于折合碰撞积分时的插值误差。折合碰撞积分是气体动理论中的基本量。整个过程基于计算物理和数值分析的既定原则。\n\n### 科学与理论基础\n\n气体动理论提供了一个框架，用于根据气体组分分子的微观相互作用来计算其宏观输运性质（黏度、热导率、扩散系数）。对于分子间相互作用可用球对称势（如 Lennard-Jones 势）建模的气体，Chapman-Enskog 理论将这些输运性质表示为一组称为折合碰撞积分的无量纲函数，记为 $\\Omega^{(l,s)}(T^*)$。\n\n这些积分依赖于折合温度 $T^*$，其定义为热能与分子相互作用特征势能之比：\n$$\nT^* = \\frac{k_{\\mathrm{B}} T}{\\epsilon}\n$$\n其中 $T$ 是绝对温度，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\epsilon$ 是 Lennard-Jones 模型中势阱的深度。问题提供了特定于物质的 $\\epsilon/k_{\\mathrm{B}}$ 值，其单位为温度（开尔文），从而可以简化计算为 $T^* = T / (\\epsilon/k_{\\mathrm{B}})$。\n\n直接计算 $\\Omega^{(l,s)}(T^*)$ 涉及对经典散射角在一系列碰撞参数和相对动能上进行复杂的数值积分。为避免这种计算开销，实践中广泛使用经过充分验证的经验关联式。本问题为此提供了 $\\Omega^{(1,1)}(T^*)$ 和 $\\Omega^{(2,2)}(T^*)$ 的关联式，它们分别是计算扩散和黏度/热导率最关键的量。这些关联式作为我们的“基准”参考函数。\n- 对于 $(l,s) = (1,1)$:\n$$\n\\Omega^{(1,1)}(T^*) = \\frac{1.06036}{(T^*)^{0.15610}} + 0.19300 \\, e^{-0.47635 \\, T^*} + 1.03587 \\, e^{-1.52996 \\, T^*} + 1.76474 \\, e^{-3.89411 \\, T^*}\n$$\n- 对于 $(l,s) = (2,2)$:\n$$\n\\Omega^{(2,2)}(T^*) = \\frac{1.16145}{(T^*)^{0.14874}} + 0.52487 \\, e^{-0.77320 \\, T^*} + 2.16178 \\, e^{-2.43787 \\, T^*}\n$$\n\n### 数值近似与误差分析\n\n核心任务是在与燃烧应用相关的有限 $T^*$ 范围（$T \\in [300\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$）内，用更简单的函数形式来近似这些连续的非多项式函数 $\\Omega^{(l,s)}(T^*)$。我们评估两种标准的数值近似技术：\n\n1.  **5次多项式最小二乘拟合**：构造一个5次的近似函数 $p(T^*)$。由于拟合基于12个训练点，多于多项式系数的数量（$5+1=6$），因此系数通过最小二乘法确定。该方法找到唯一的多项式，使得其在训练点上的误差平方和最小。这是一种在区间上创建全局近似的稳健方法。\n\n2.  **三次样条插值**：构造一个样条近似函数 $s(T^*)$。该方法创建一个分段函数，由在12个训练点（节点）处平滑连接的三次多项式组成。按规定，“非扭结”（not-a-knot）边界条件通过强制三阶导数在第二个和倒数第二个节点处连续，为样条提供了自然的端点处理。样条插值非常出色，因为它避免了困扰高阶全局多项式插值的振荡行为（Runge 现象）。\n\n这些近似的准确性通过在密集评估网格 $\\mathcal{G}$ 上的最大相对误差来量化：\n$$\nE_{\\mathrm{rel}} = \\max_{T^* \\in \\mathcal{G}} \\left| \\frac{\\widehat{\\Omega}^{(l,s)}(T^*) - \\Omega^{(l,s)}(T^*)}{\\Omega^{(l,s)}(T^*)} \\right|\n$$\n其中 $\\widehat{\\Omega}^{(l,s)}(T^*)$ 代表多项式 $p(T^*)$ 或样条 $s(T^*)$。相对误差是一种类似百分比的度量，它通过真实函数的大小来归一化绝对误差，这使其成为一个对于在其定义域上变化显著的函数更有意义的指标。\n\n### 算法实现\n\n该解决方案通过对3种物质和2种碰撞积分中的每一种都遵循系统化的步骤来实现。\n\n1.  **定义特定于物质的 $T^*$ 范围**：对于每种物质，使用其给定的 $\\epsilon/k_{\\mathrm{B}}$ 值，将物理温度范围 $T \\in [300\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$ 映射到特定于该物质的折合温度范围 $[T^*_{\\min}, T^*_{\\max}]$。\n\n2.  **生成网格**：在区间 $[T^*_{\\min}, T^*_{\\max}]$ 上建立两个均匀网格：\n    - 一个包含12个点的稀疏训练网格，用于构建近似函数。\n    - 一个包含200个点的密集评估网格，用于计算基准函数并准确估计近似函数的最大误差。\n\n3.  **构造近似函数**：对于每个碰撞积分函数 $\\Omega^{(l,s)}(T^*)$：\n    - 在12个训练点上计算真实函数值。\n    - 使用这些训练对 $(T^*, \\Omega^{(l,s)}(T^*))$，通过 `numpy.polyfit` 构建5次多项式拟合，并通过 `scipy.interpolate.CubicSpline` 构建三次样条。\n\n4.  **评估误差**：\n    - 在包含200个点的密集网格上评估真实函数和两个近似函数。\n    - 对多项式和样条，在网格的每个点上计算相对误差。\n    - 确定每个近似函数的最大相对误差值，从而得出最终的误差指标。\n\n5.  **汇总结果**：为6个物质和碰撞积分的组合中的每一个计算两个误差指标（多项式和样条），得到12个最终值。将这些值按指定顺序收集并格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import CubicSpline\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating interpolation error for reduced collision integrals.\n    \"\"\"\n\n    # Define the empirical correlations for the reduced collision integrals.\n    def omega_11(T_star):\n        \"\"\"Calculates Omega^(1,1)(T*)\"\"\"\n        term1 = 1.06036 / (T_star**0.15610)\n        term2 = 0.19300 * np.exp(-0.47635 * T_star)\n        term3 = 1.03587 * np.exp(-1.52996 * T_star)\n        term4 = 1.76474 * np.exp(-3.89411 * T_star)\n        return term1 + term2 + term3 + term4\n\n    def omega_22(T_star):\n        \"\"\"Calculates Omega^(2,2)(T*)\"\"\"\n        term1 = 1.16145 / (T_star**0.14874)\n        term2 = 0.52487 * np.exp(-0.77320 * T_star)\n        term3 = 2.16178 * np.exp(-2.43787 * T_star)\n        return term1 + term2 + term3\n\n    def calculate_errors(eps_k, omega_func):\n        \"\"\"\n        Calculates the max relative error for polynomial and spline approximations.\n\n        Args:\n            eps_k (float): The Lennard-Jones parameter epsilon/k_B in Kelvin.\n            omega_func (callable): The function for the collision integral Omega(T*).\n\n        Returns:\n            tuple: (max_rel_err_poly, max_rel_err_spline)\n        \"\"\"\n        # Problem-defined constants\n        T_min = 300.0  # K\n        T_max = 3000.0 # K\n        n_train = 12\n        n_eval = 200\n        poly_deg = 5\n\n        # 1. Define the species-specific reduced temperature range\n        T_star_min = T_min / eps_k\n        T_star_max = T_max / eps_k\n\n        # 2. Generate training and evaluation grids\n        T_star_train = np.linspace(T_star_min, T_star_max, n_train)\n        T_star_eval = np.linspace(T_star_min, T_star_max, n_eval)\n\n        # 3. Calculate \"ground truth\" values\n        omega_train = omega_func(T_star_train)\n        omega_eval_true = omega_func(T_star_eval)\n\n        # 4. Construct and evaluate the degree-5 polynomial fit\n        poly_coeffs = np.polyfit(T_star_train, omega_train, poly_deg)\n        p = np.poly1d(poly_coeffs)\n        omega_eval_poly = p(T_star_eval)\n\n        # 5. Construct and evaluate the cubic spline fit\n        s = CubicSpline(T_star_train, omega_train, bc_type='not-a-knot')\n        omega_eval_spline = s(T_star_eval)\n\n        # 6. Calculate maximum relative errors\n        rel_err_poly = np.abs((omega_eval_poly - omega_eval_true) / omega_eval_true)\n        max_rel_err_poly = np.max(rel_err_poly)\n\n        rel_err_spline = np.abs((omega_eval_spline - omega_eval_true) / omega_eval_true)\n        max_rel_err_spline = np.max(rel_err_spline)\n\n        return max_rel_err_poly, max_rel_err_spline\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (species_name, eps_k value)\n        (\"N2\", 97.0),\n        (\"H2\", 38.0),\n        (\"H2O\", 809.1),\n    ]\n\n    omega_functions = [omega_11, omega_22]\n    \n    results = []\n    \n    # Iterate through each species\n    for _, eps_k_val in test_cases:\n        # Iterate through each collision integral function\n        for func in omega_functions:\n            poly_error, spline_error = calculate_errors(eps_k_val, func)\n            results.append(poly_error)\n            results.append(spline_error)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在评估了数值实现的准确性之后，我们必须进一步审视理论模型本身的保真度。广泛使用的一阶Chapman–Enskog近似有其局限性，尤其是在要求高精度的场景中。本练习将深入探讨扩散系数的二阶近似，让你能够亲手计算修正因子的大小，并培养出何时必须考虑高阶效应（例如在高温燃烧模拟中）的物理直觉。",
            "id": "4033983",
            "problem": "一种与稀薄预混燃烧相关的二元气体混合物由氮气和氧气组成。假设气体足够稀薄，使得玻尔兹曼方程适用，并且分子间的相互作用可以很好地用由尺寸参数 $\\sigma$ 和势阱深度 $\\epsilon$ 表征的 Lennard-Jones 势来表示。\n\n对于氮气 ($\\mathrm{N_2}$) 和氧气 ($\\mathrm{O_2}$)，取以下 Lennard-Jones 参数：\n- $\\mathrm{N_2}$: $\\sigma_A = 3.798 \\times 10^{-10}\\ \\mathrm{m}$，$\\epsilon_A/k_B = 71.4\\ \\mathrm{K}$。\n- $\\mathrm{O_2}$: $\\sigma_B = 3.467 \\times 10^{-10}\\ \\mathrm{m}$，$\\epsilon_B/k_B = 106.7\\ \\mathrm{K}$。\n\n使用 Lorentz-Berthelot 组合规则来构建交叉相互作用参数\n$$\n\\sigma_{AB} = \\frac{\\sigma_A + \\sigma_B}{2}, \n\\qquad\n\\frac{\\epsilon_{AB}}{k_B} = \\sqrt{\\frac{\\epsilon_A}{k_B}\\,\\frac{\\epsilon_B}{k_B}},\n$$\n和约化温度\n$$\nT^{*} = \\frac{T}{\\epsilon_{AB}/k_B}.\n$$\n\n考虑在温度 $T = 1800\\ \\mathrm{K}$ 和压力 $p = 1\\ \\mathrm{atm}$ 下的典型高温燃烧条件。在 Chapman-Enskog 框架内（线性化玻尔兹曼方程在局部平衡附近的 Sonine 多项式展开的前两项），二元扩散系数 $D_{AB}$ 可以用碰撞括号积分表示。用 $L_{ij}$ 表示与二元扩散问题的前两个 Sonine 基函数相关的碰撞括号矩阵元素。对于给定的 $(\\mathrm{N_2}, \\mathrm{O_2})$ 对，在对应的约化温度 $T^{*}$ 下的 Lennard-Jones 势，假设已计算出以下无量纲的约化碰撞括号：\n$$\nL_{11}^{*} = 1.013,\\qquad L_{12}^{*} = 0.480,\\qquad L_{22}^{*} = 11.75.\n$$\n此处，$L_{ij}^{*}$ 表示由基于 $\\sigma_{AB}$、$\\epsilon_{AB}$ 和 $T$ 的常规 Lennard-Jones 标度无量纲化的 $L_{ij}$；在下面要求的比率中，总的比例因子会抵消。\n\n从玻尔兹曼方程和用于二元扩散的 Chapman-Enskog 程序出发，推导 Chapman-Enskog 二次近似修正因子 $f_D$ 的表达式，该因子乘以一次近似二元扩散系数 $D_{AB}^{(1)}$ 得到二次近似值 $D_{AB}^{(2)}$，然后使用提供的 $L_{ij}^{*}$ 数值计算 $f_D$。将您的答案四舍五入到四位有效数字。以无量纲数的形式表示您的最终答案。",
            "solution": "该问题要求推导和评估在高温下氮气 ($\\mathrm{N_2}$) 和氧气 ($\\mathrm{O_2}$) 之间的二元扩散系数 $D_{AB}$ 的二次近似修正因子 $f_D$。其理论基础是玻尔兹曼方程的 Chapman-Enskog 解。\n\n问题陈述已经过验证，被确定为科学上合理、提法得当且客观。它包含了所有必要信息，没有矛盾或含糊之处。因此，我们可以着手求解。\n\nChapman-Enskog 方法通过将速度分布函数展开为正交多项式级数（特别是 Sonine 多项式）来求解玻尔兹曼方程。对于二元扩散问题，对分布函数的相关扰动在 Sonine 多项式基 $S_{3/2}^{(p)}(W^2)$ 中展开，其中 $W$ 是无量纲的奇特速度。输运系数的二次近似利用了前两个基函数，对应于 $p=0$ 和 $p=1$。\n\n这个展开导致了一个关于展开系数的线性代数方程组。对于二次近似，这是一个 $2 \\times 2$ 的系统。设展开系数为 $c_0$ 和 $c_1$。该系统可以写成矩阵形式：\n$$\n\\begin{pmatrix} L_{11} & L_{12} \\\\ L_{21} & L_{22} \\end{pmatrix}\n\\begin{pmatrix} c_0 \\\\ c_1 \\end{pmatrix}\n=\n\\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}\n$$\n此处，矩阵元素 $L_{ij}$ 是问题陈述中提供的碰撞括号积分。这些元素表示线性化碰撞算子在所选 Sonine 多项式基中的矩阵。碰撞算子的自伴性确保了 $L_{12} = L_{21}$。右侧的项 $\\alpha$ 是一个非零量，与扩散驱动力（即摩尔分数梯度）成正比，其确切形式对于确定修正因子不是必需的。\n\n二元扩散系数 $D_{AB}$ 与主展开系数 $c_0$ 成正比。\n$$ D_{AB} \\propto c_0 $$\n\n我们现在可以确定 $D_{AB}$ 的一次和二次近似。\n\n一次近似 $D_{AB}^{(1)}$ 只考虑第一个基函数 ($p=0$)。这将问题简化为一个 $1 \\times 1$ 系统：\n$$ L_{11} c_0^{(1)} = \\alpha $$\n主系数的解是：\n$$ c_0^{(1)} = \\frac{\\alpha}{L_{11}} $$\n因此，一次近似扩散系数与 $1/L_{11}$ 成正比：\n$$ D_{AB}^{(1)} \\propto \\frac{1}{L_{11}} $$\n\n二次近似 $D_{AB}^{(2)}$ 考虑了两个基函数 ($p=0$ 和 $p=1$)，需要解完整的 $2 \\times 2$ 系统。我们可以使用克莱姆法则找到系数 $c_0^{(2)}$：\n$$ c_0^{(2)} = \\frac{\\det \\begin{pmatrix} \\alpha & L_{12} \\\\ 0 & L_{22} \\end{pmatrix}}{\\det \\begin{pmatrix} L_{11} & L_{12} \\\\ L_{21} & L_{22} \\end{pmatrix}} = \\frac{\\alpha L_{22}}{L_{11} L_{22} - L_{12} L_{21}} $$\n使用属性 $L_{12} = L_{21}$，我们有：\n$$ c_0^{(2)} = \\frac{\\alpha L_{22}}{L_{11} L_{22} - L_{12}^2} $$\n因此，二次近似扩散系数与 $c_0^{(2)}$ 的这个表达式除以 $\\alpha$ 后的结果成正比：\n$$ D_{AB}^{(2)} \\propto \\frac{L_{22}}{L_{11} L_{22} - L_{12}^2} $$\n\n修正因子 $f_D$ 由关系式 $D_{AB}^{(2)} = f_D D_{AB}^{(1)}$ 定义。我们现在可以通过取 $D_{AB}^{(2)}$ 和 $D_{AB}^{(1)}$ 的比例表达式的比值来推导其表达式：\n$$ f_D = \\frac{D_{AB}^{(2)}}{D_{AB}^{(1)}} = \\frac{k \\cdot \\frac{L_{22}}{L_{11} L_{22} - L_{12}^2}}{k \\cdot \\frac{1}{L_{11}}} $$\n其中 $k$ 是比例常数，它被消掉了。\n$$ f_D = \\frac{L_{11} L_{22}}{L_{11} L_{22} - L_{12}^2} $$\n这个表达式可以重新排列成一个更常见和更有洞察力的形式：\n$$ f_D = \\frac{1}{1 - \\frac{L_{12}^2}{L_{11} L_{22}}} $$\n这就是所需的二元扩散系数二次近似修正因子的解析表达式。\n\n为了数值计算 $f_D$，我们使用提供的无量纲约化碰撞括号：$L_{11}^{*} = 1.013$，$L_{12}^{*} = 0.480$ 和 $L_{22}^{*} = 11.75$。由于 $f_D$ 是具有相同量纲的项的无量纲比值，任何标度因子都会抵消，我们可以直接使用无量纲的 $L_{ij}^{*}$ 值：\n$$ f_D = \\frac{1}{1 - \\frac{(L_{12}^*)^2}{L_{11}^* L_{22}^*}} $$\n代入数值：\n$$ f_D = \\frac{1}{1 - \\frac{(0.480)^2}{(1.013)(11.75)}} $$\n首先，我们计算分母中的乘积和平方：\n$$ (0.480)^2 = 0.2304 $$\n$$ (1.013)(11.75) = 11.90275 $$\n接下来，我们计算分母中的比率：\n$$ \\frac{0.2304}{11.90275} \\approx 0.019356906 $$\n现在我们计算分母：\n$$ 1 - 0.019356906 = 0.980643094 $$\n最后，我们计算 $f_D$：\n$$ f_D = \\frac{1}{0.980643094} \\approx 1.0197389 $$\n问题要求将答案四舍五入到四位有效数字。结果的前四位有效数字是 $1$、$0$、$1$ 和 $9$。第五位有效数字是 $7$，大于或等于 $5$，所以我们必须将第四位有效数字向上取整。这种取整会向前传播，得到 $f_D \\approx 1.020$。",
            "answer": "$$\\boxed{1.020}$$"
        }
    ]
}