{
    "hands_on_practices": [
        {
            "introduction": "化学计量混合分数 $Z_{st}$ 是非预混燃烧分析的基石，它精确定位了燃料和氧化剂达到完美平衡的位置。本练习提供了从燃料和氧化剂流的元素组成计算 $Z_{st}$ 的基础实践，这是任何 Shvab-Zeldovich 分析中至关重要的第一步。通过应用元素守恒原理，您将巩固对混合分数空间如何定义和使用的理解 。",
            "id": "4062754",
            "problem": "在纯甲烷燃料流和干燥空气氧化剂流之间，于大气条件下形成了一个稳态的非预混混合层。用于非预混火焰的 Shvab–Zel’dovich 公式使用了一个守恒标量——混合分数，该标量基于元素守恒和相等的扩散系数（单位刘易斯数）构建，并通过施加净氧化剂需求为零的条件来评估化学计量。考虑完全氧化反应 $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$，并假设以下入口组分：\n- 燃料流：纯甲烷，元素质量分数为 $Y_{C,F} = \\frac{12}{16}$，$Y_{H,F} = \\frac{4}{16}$ 及 $Y_{O,F} = 0$。\n- 氧化剂流：干燥空气，近似为仅含 $\\mathrm{O_2}$ 和 $\\mathrm{N_2}$，其中 $Y_{\\mathrm{O_2},O} = 0.233$，$Y_{\\mathrm{N_2},O} = 0.767$，因此元素质量分数为 $Y_{C,O} = 0$，$Y_{H,O} = 0$ 及 $Y_{O,O} = 0.233$。\n使用原子量 $W_C = 12$，$W_H = 1$ 及 $W_O = 16$。\n\n在 Shvab–Zel’dovich 公式下，采用由元素摩尔丰度的守恒线性组合定义的元素摩尔耗氧量标量，\n$$\\beta \\equiv 2\\,\\frac{Y_C}{W_C} + \\frac{1}{2}\\,\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O},$$\n通过在化学计量比下施加净耗氧量为零的条件以及利用守恒标量的混合线性关系，仅基于入口流组分推导出化学计量混合分数 $Z_{st}$ 的表达式。然后，对于流场中混合分数为 $Z = 0.08$ 的一个位置，判断其状态是贫燃料（$Z  Z_{st}$）还是富燃料（$Z > Z_{st}$）。\n\n将您的 $Z_{st}$ 值四舍五入到四位有效数字，并将混合分数视为无量纲。将您的最终答案以双元素行矩阵 $\\begin{pmatrix} Z_{st}  s \\end{pmatrix}$ 的形式给出，其中 $s = \\operatorname{sgn}(Z - Z_{st})$ 且 $s \\in \\{-1, 0, 1\\}$，并约定 $s = -1$ 表示贫燃料，$s = +1$ 表示富燃料，$s = 0$ 表示恰好为化学计量比。",
            "solution": "用户希望使用 Shvab–Zel’dovich 公式解决一个燃烧问题。\n\n### 步骤1：问题验证\n\n**1. 提取已知条件：**\n-   **反应：** $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$\n-   **燃料流（用下标F表示）：** 纯甲烷（$\\mathrm{CH_4}$），对应于混合分数 $Z=1$。元素质量分数为 $Y_{C,F} = \\frac{12}{16}$，$Y_{H,F} = \\frac{4}{16}$ 及 $Y_{O,F} = 0$。\n-   **氧化剂流（用下标O表示）：** 干燥空气，对应于混合分数 $Z=0$。组分为 $Y_{\\mathrm{O_2},O} = 0.233$ 和 $Y_{\\mathrm{N_2},O} = 0.767$。元素质量分数为 $Y_{C,O} = 0$，$Y_{H,O} = 0$ 及 $Y_{O,O} = 0.233$。\n-   **原子量：** $W_C = 12$，$W_H = 1$ 及 $W_O = 16$。\n-   **守恒标量定义：** 定义一个元素摩尔耗氧量标量 $\\beta$ 为 $\\beta \\equiv 2\\,\\frac{Y_C}{W_C} + \\frac{1}{2}\\,\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O}$，其中 $Y_C$、$Y_H$ 和 $Y_O$ 分别是碳、氢和氧的局部元素质量分数。\n-   **化学计量条件：** 化学计量条件由 $\\beta_{st} = 0$ 定义。\n-   **目标位置：** 流场中混合分数为 $Z = 0.08$ 的一个点。\n-   **要求输出：**\n    1.  化学计量混合分数 $Z_{st}$ 的值，四舍五入到四位有效数字。\n    2.  判断 $Z=0.08$ 处的状态是贫燃料还是富燃料，用 $s = \\operatorname{sgn}(Z - Z_{st})$ 表示，其中 $s=-1$ 代表贫燃料，$s=+1$ 代表富燃料，$s=0$ 代表化学计量比。\n    3.  最终答案必须以矩阵形式 $\\begin{pmatrix} Z_{st}  s \\end{pmatrix}$ 给出。\n\n**2. 使用提取的已知条件进行验证：**\n-   **科学依据：** 该问题深深植根于经典燃烧理论。Shvab–Zel’dovich 公式、守恒标量和混合分数的概念是非预混火焰研究中的标准和基础课题。给定的化学反应和组分是甲烷-空气燃烧的标准表示方法。标量 $\\beta$ 的构建是应用元素守恒原理来定义化学计量的一个有效方法。该问题在科学上是合理的。\n-   **适定性：** 问题陈述是完整的，提供了所有必需的定义、常数和边界条件，以唯一确定所需的值。任务是具体且可解的。\n-   **客观性：** 问题以精确、定量且明确的科学语言陈述。没有主观或基于观点的内容。\n\n**3. 结论与行动：**\n该问题被认为是**有效的**。这是一个来自计算燃烧学领域的适定的、有科学依据的问题。将提供一个完整的解。\n\n### 步骤2：推导与求解\n\n在所有物种扩散系数相等（刘易斯数为单位1）的假设下，Shvab–Zel’dovich 公式的核心原理是，任何一个守恒标量都是任何其他守恒标量的线性函数。根据定义，混合分数 $Z$ 是一个守恒标量，其值在燃料流中为 $Z=1$，在氧化剂流中为 $Z=0$。标量 $\\beta$ 是守恒的元素质量分数的线性组合，因此它也是一个守恒标量。\n\n因此，$\\beta$ 必须是 $Z$ 的线性函数：\n$$ \\beta(Z) = (\\beta_F - \\beta_O)Z + \\beta_O $$\n其中 $\\beta_F$ 和 $\\beta_O$ 分别是 $\\beta$ 在纯燃料流和纯氧化剂流中的值。\n\n首先，我们计算燃料流（$Z=1$）的 $\\beta_F$，其中 $Y_{C,F} = \\frac{12}{16}$，$Y_{H,F} = \\frac{4}{16}$ 及 $Y_{O,F} = 0$。\n$$ \\beta_F = 2\\,\\frac{Y_{C,F}}{W_C} + \\frac{1}{2}\\,\\frac{Y_{H,F}}{W_H} - \\frac{Y_{O,F}}{W_O} $$\n$$ \\beta_F = 2 \\left( \\frac{12/16}{12} \\right) + \\frac{1}{2} \\left( \\frac{4/16}{1} \\right) - \\frac{0}{16} $$\n$$ \\beta_F = 2 \\left( \\frac{1}{16} \\right) + \\frac{1}{2} \\left( \\frac{4}{16} \\right) = \\frac{2}{16} + \\frac{2}{16} = \\frac{4}{16} = \\frac{1}{4} $$\n\n接下来，我们计算氧化剂流（$Z=0$）的 $\\beta_O$，其中 $Y_{C,O} = 0$，$Y_{H,O} = 0$ 及 $Y_{O,O} = 0.233$。\n$$ \\beta_O = 2\\,\\frac{Y_{C,O}}{W_C} + \\frac{1}{2}\\,\\frac{Y_{H,O}}{W_H} - \\frac{Y_{O,O}}{W_O} $$\n$$ \\beta_O = 2 \\left( \\frac{0}{12} \\right) + \\frac{1}{2} \\left( \\frac{0}{1} \\right) - \\frac{0.233}{16} $$\n$$ \\beta_O = - \\frac{0.233}{16} $$\n\n化学计量定义为恰好有足够的氧化剂来完全消耗燃料的条件，这对应于 $\\beta = 0$。我们将此条件下的混合分数记为 $Z_{st}$。我们可以通过在线性关系中令 $\\beta(Z_{st}) = 0$ 来求得 $Z_{st}$。\n$$ 0 = (\\beta_F - \\beta_O)Z_{st} + \\beta_O $$\n求解 $Z_{st}$：\n$$ Z_{st} = \\frac{-\\beta_O}{\\beta_F - \\beta_O} $$\n代入计算出的 $\\beta_F$ 和 $\\beta_O$ 的值：\n$$ Z_{st} = \\frac{- \\left( - \\frac{0.233}{16} \\right)}{\\frac{1}{4} - \\left( - \\frac{0.233}{16} \\right)} = \\frac{\\frac{0.233}{16}}{\\frac{4}{16} + \\frac{0.233}{16}} $$\n$$ Z_{st} = \\frac{\\frac{0.233}{16}}{\\frac{4 + 0.233}{16}} = \\frac{0.233}{4.233} $$\n现在，我们计算其数值：\n$$ Z_{st} \\approx 0.0550437042... $$\n根据问题陈述的要求，四舍五入到四位有效数字，得到：\n$$ Z_{st} \\approx 0.05504 $$\n\n接着，问题要求判断混合分数为 $Z = 0.08$ 的位置的状态是贫燃料还是富燃料。\n混合物：\n-   如果 $Z  Z_{st}$，则为贫燃料（氧化剂过量）\n-   如果 $Z > Z_{st}$，则为富燃料（燃料过量）\n-   如果 $Z = Z_{st}$，则为化学计量比\n\n将给定值 $Z=0.08$ 与计算出的化学计量值 $Z_{st} \\approx 0.05504$进行比较：\n$$ 0.08 > 0.05504 $$\n由于 $Z > Z_{st}$，该混合物为富燃料。\n\n我们还必须计算 $s = \\operatorname{sgn}(Z - Z_{st})$。\n$$ Z - Z_{st} = 0.08 - 0.05504 = 0.02496 $$\n由于 $Z - Z_{st} > 0$，符号函数给出：\n$$ s = \\operatorname{sgn}(0.02496) = 1 $$\n\n最终答案应以双元素行矩阵 $\\begin{pmatrix} Z_{st}  s \\end{pmatrix}$ 的形式给出。\n这两个元素是 $Z_{st} = 0.05504$ 和 $s = 1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.05504  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管基础模型通常假设干空气为氧化剂，但真实的燃烧系统必须考虑环境条件，包括湿度。氧化剂流中水蒸气的存在会取代氧气，从而改变化学计量混合物。本练习演示了如何针对湿空气调整 Shvab-Zeldovich 公式，要求您将热力学原理与化学计量计算相结合，以确定一个更符合实际的 $Z_{st}$ 值 。",
            "id": "4062721",
            "problem": "考虑在 Shvab–Zel’dovich (SZ) 公式下分析的稳态、双股流、非预混火焰。在 SZ 框架中，混合分数 $Z$ 是一个根据元素质量守恒构建的守恒标量，其在燃料流中 $Z=1$，在氧化剂流中 $Z=0$。火焰面出现在化学计量混合分数 $Z_{st}$ 处，在此处局部混合比恰好提供了完全氧化燃料所需的氧气。\n\n假设燃料流为纯甲烷 $\\mathrm{CH_4}$，氧化剂流为温度 $T=298\\,\\mathrm{K}$、压力 $P=101{,}325\\,\\mathrm{Pa}$ 的湿空气。相对湿度为 $\\phi=0.60$。在 $298\\,\\mathrm{K}$ 时，水的饱和蒸气压为 $p_{\\mathrm{sat}}=3168\\,\\mathrm{Pa}$。干空气的摩尔组成为 $y_{\\mathrm{O_2}}^{\\mathrm{dry}}=0.21$ 和 $y_{\\mathrm{N_2}}^{\\mathrm{dry}}=0.79$，忽略氩气和二氧化碳。使用摩尔质量 $W_{\\mathrm{CH_4}}=16.043\\,\\mathrm{kg/kmol}$、$W_{\\mathrm{O_2}}=31.998\\,\\mathrm{kg/kmol}$、$W_{\\mathrm{N_2}}=28.014\\,\\mathrm{kg/kmol}$ 和 $W_{\\mathrm{H_2O}}=18.015\\,\\mathrm{kg/kmol}$。完全氧化反应为 $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\to \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$。\n\n从以下两点出发：\n- 元素守恒以及在双股流 SZ 公式中 $Z$ 作为源自燃料的质量分数的定义，以及\n- 相对湿度的热力学定义，以确定存在水蒸气时的氧化剂成分，\n\n推导出一个用氧化剂中氧气的质量分数 $Y_{\\mathrm{O_2,ox}}$ 和单位质量燃料所需的化学计量氧气量 $L_s$ 表示的修正后化学计量混合分数 $Z_{st}$ 的通用表达式。然后，计算在给定条件下的调整后 $Z_{st}$。将最终值四舍五入至四位有效数字，并以无量纲数的形式表示。",
            "solution": "该问题经核实具有科学依据，提法明确，客观且自成体系。这是一个燃烧理论中的标准问题，需要应用热力学和化学计量的原理。所有必要数据均已提供，任务定义清晰。我们可以开始求解。\n\n化学计量混合分数 $Z_{st}$ 表示混合分数 $Z$ 的一个特定值，在该值下燃料和氧化剂以精确的化学计量比例混合，从而实现完全燃烧，且没有任何反应物过量。混合分数 $Z$ 定义为给定流体微团中源自燃料流的物质的质量分数。因此，$(1-Z)$ 是源自氧化剂流的物质的质量分数。\n\n设在一个总质量为 $m_{total} = m_F + m_O$ 的混合物中，$m_F$ 是源自燃料流的质量，$m_O$ 是源自氧化剂流的质量。混合分数为 $Z = m_F / m_{total}$。\n设 $Y_{F,fuel}$ 为燃料流中燃料的质量分数，$Y_{\\mathrm{O_2,ox}}$ 为氧化剂流中氧气的质量分数。\n混合物中可用的燃料质量为 $m_f = Y_{F,fuel} m_F = Y_{F,fuel} Z m_{total}$。\n混合物中可用的氧气质量为 $m_{O_2} = Y_{\\mathrm{O_2,ox}} m_O = Y_{\\mathrm{O_2,ox}} (1-Z) m_{total}$。\n\n化学计量关系由化学计量的氧燃质量比 $L_s$ 定义，即完全燃烧单位质量燃料所需的氧气质量。在火焰位置，即 $Z = Z_{st}$ 处，可用的氧气质量恰好是可用燃料质量的 $L_s$ 倍：\n$$m_{O_2} = L_s \\cdot m_f$$\n代入以 $Z$ 表示的表达式并消去 $m_{total}$：\n$$Y_{\\mathrm{O_2,ox}} (1-Z_{st}) = L_s \\cdot Y_{F,fuel} Z_{st}$$\n求解此方程以得到 $Z_{st}$：\n$$Y_{\\mathrm{O_2,ox}} - Y_{\\mathrm{O_2,ox}} Z_{st} = L_s Y_{F,fuel} Z_{st}$$\n$$Y_{\\mathrm{O_2,ox}} = (L_s Y_{F,fuel} + Y_{\\mathrm{O_2,ox}}) Z_{st}$$\n$$Z_{st} = \\frac{Y_{\\mathrm{O_2,ox}}}{L_s Y_{F,fuel} + Y_{\\mathrm{O_2,ox}}}$$\n这可以改写为：\n$$Z_{st} = \\frac{1}{1 + \\frac{L_s Y_{F,fuel}}{Y_{\\mathrm{O_2,ox}}}}$$\n在此特定问题中，燃料流是纯甲烷 ($\\mathrm{CH_4}$)，因此燃料流中燃料的质量分数为 $Y_{F,fuel} = 1$。该表达式简化为：\n$$Z_{st} = \\frac{1}{1 + \\frac{L_s}{Y_{\\mathrm{O_2,ox}}}}$$\n这是对于纯燃料流的 $Z_{st}$ 的通用表达式。现在，我们必须计算 $L_s$ 和 $Y_{\\mathrm{O_2,ox}}$ 的值。\n\n首先，我们计算甲烷的化学计量氧燃质量比 $L_s$。完全氧化反应为：\n$$\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\to \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$$\n这表明 $1$ 摩尔的 $\\mathrm{CH_4}$ 与 $2$ 摩尔的 $\\mathrm{O_2}$ 反应。使用给定的摩尔质量 $W_{\\mathrm{CH_4}}=16.043\\,\\mathrm{kg/kmol}$ 和 $W_{\\mathrm{O_2}}=31.998\\,\\mathrm{kg/kmol}$：\n$$L_s = \\frac{\\text{mass of } \\mathrm{O_2}}{\\text{mass of } \\mathrm{CH_4}} = \\frac{2 \\cdot W_{\\mathrm{O_2}}}{1 \\cdot W_{\\mathrm{CH_4}}} = \\frac{2 \\times 31.998\\,\\mathrm{kg/kmol}}{1 \\times 16.043\\,\\mathrm{kg/kmol}} = \\frac{63.996}{16.043} \\approx 3.98903$$\n\n接下来，我们确定氧化剂流中氧气的质量分数 $Y_{\\mathrm{O_2,ox}}$。氧化剂是相对湿度为 $\\phi=0.60$、温度为 $T=298\\,\\mathrm{K}$、压力为 $P=101325\\,\\mathrm{Pa}$ 的湿空气。在此温度下，水的饱和压力为 $p_{\\mathrm{sat}}=3168\\,\\mathrm{Pa}$。\n水蒸气的分压 $p_{\\mathrm{H_2O}}$ 由相对湿度的定义给出：\n$$p_{\\mathrm{H_2O}} = \\phi \\cdot p_{\\mathrm{sat}} = 0.60 \\times 3168\\,\\mathrm{Pa} = 1900.8\\,\\mathrm{Pa}$$\n根据道尔顿定律，氧化剂流中水蒸气的摩尔分数 $y_{\\mathrm{H_2O}}$ 为：\n$$y_{\\mathrm{H_2O}} = \\frac{p_{\\mathrm{H_2O}}}{P} = \\frac{1900.8}{101325} \\approx 0.018759$$\n混合物的其余部分是干空气，因此其摩尔分数为 $y_{\\mathrm{dry\\,air}} = 1 - y_{\\mathrm{H_2O}}$。湿空气中氧气 ($y_{\\mathrm{O_2}}$) 和氮气 ($y_{\\mathrm{N_2}}$) 的摩尔分数可以通过缩放它们在干空气中的摩尔分数 ($y_{\\mathrm{O_2}}^{\\mathrm{dry}}=0.21$, $y_{\\mathrm{N_2}}^{\\mathrm{dry}}=0.79$) 来找到：\n$$y_{\\mathrm{O_2}} = y_{\\mathrm{O_2}}^{\\mathrm{dry}} (1 - y_{\\mathrm{H_2O}}) = 0.21 \\left(1 - \\frac{1900.8}{101325}\\right) = 0.21 \\left(\\frac{99424.2}{101325}\\right) = \\frac{20879.082}{101325} \\approx 0.20606$$\n$$y_{\\mathrm{N_2}} = y_{\\mathrm{N_2}}^{\\mathrm{dry}} (1 - y_{\\mathrm{H_2O}}) = 0.79 \\left(1 - \\frac{1900.8}{101325}\\right) = 0.79 \\left(\\frac{99424.2}{101325}\\right) = \\frac{78545.118}{101325} \\approx 0.77518$$\n为了将这些摩尔分数转换为质量分数，我们首先计算湿空气（氧化剂）的平均摩尔质量 $W_{\\text{ox}}$：\n$$W_{\\text{ox}} = y_{\\mathrm{O_2}}W_{\\mathrm{O_2}} + y_{\\mathrm{N_2}}W_{\\mathrm{N_2}} + y_{\\mathrm{H_2O}}W_{\\mathrm{H_2O}}$$\n使用给定的摩尔质量 $W_{\\mathrm{O_2}}=31.998\\,\\mathrm{kg/kmol}$、$W_{\\mathrm{N_2}}=28.014\\,\\mathrm{kg/kmol}$ 和 $W_{\\mathrm{H_2O}}=18.015\\,\\mathrm{kg/kmol}$：\n$$W_{\\text{ox}} = \\left(\\frac{20879.082}{101325}\\right)(31.998) + \\left(\\frac{78545.118}{101325}\\right)(28.014) + \\left(\\frac{1900.8}{101325}\\right)(18.015)$$\n$$W_{\\text{ox}} \\approx (0.20606)(31.998) + (0.77518)(28.014) + (0.018759)(18.015)$$\n$$W_{\\text{ox}} \\approx 6.59353 + 21.71536 + 0.33792 \\approx 28.6468\\,\\mathrm{kg/kmol}$$\n氧化剂流中氧气的质量分数 $Y_{\\mathrm{O_2,ox}}$ 为：\n$$Y_{\\mathrm{O_2,ox}} = \\frac{y_{\\mathrm{O_2}} W_{\\mathrm{O_2}}}{W_{\\text{ox}}} = \\frac{(0.2060606...) \\times 31.998}{28.6468} \\approx \\frac{6.59353}{28.6468} \\approx 0.230167$$\n现在我们有了 $L_s$ 和 $Y_{\\mathrm{O_2,ox}}$。我们可以计算 $Z_{st}$：\n$$Z_{st} = \\frac{1}{1 + \\frac{L_s}{Y_{\\mathrm{O_2,ox}}}} = \\frac{1}{1 + \\frac{3.98903}{0.230167}}$$\n$$Z_{st} = \\frac{1}{1 + 17.33085} = \\frac{1}{18.33085} \\approx 0.0545525$$\n将最终值四舍五入到四位有效数字，我们得到：\n$$Z_{st} \\approx 0.05455$$\n此值为无量纲数，符合质量分数的要求。空气中湿度的存在轻微地取代了氧气，导致与干空气 ($Y_{\\mathrm{O_2,dry}} \\approx 0.2329$) 相比，氧气的质量分数略低。这反过来又使得化学计量混合分数比使用干空气时的情况 ($Z_{st,dry} \\approx 0.0550$) 略低。",
            "answer": "$$\\boxed{0.05455}$$"
        },
        {
            "introduction": "Shvab-Zeldovich 公式的真正威力在于其能够将复杂的多维问题简化为一维框架，从而导出火焰面方程。这项高级计算实践要求您对非定常火焰面方程进行数值求解，以研究火焰点火等瞬态现象。通过实现一个数值求解器，您将弥合理论与计算实践之间的差距，获得模拟非预混火焰动态行为的实践经验 。",
            "id": "4062835",
            "problem": "考虑在以下假设下的非预混火焰的非稳态 Shvab–Zel’dovich 列式：密度恒定、组分扩散系数相等且恒定（Lewis 数为 1）、压力梯度可忽略。令 $Z \\in [0,1]$ 表示守恒混合分数。定义一个归一化进程变量 $C(Z,t)$，它在新鲜反应物中为 $0$，在完全反应的产物中趋近于 $1$。从非稳态组分守恒方程和混合分数的定义出发，使用 Shvab–Zel’dovich 变量变换，将控制方程转换到混合分数空间。在所述假设下，推导一个通用标量 $\\phi(Z,t)$ 的非稳态小火焰方程，其形式为\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\chi(Z,t)}{2}\\,\\frac{\\partial^2 \\phi}{\\partial Z^2} + S_{\\phi}(Z,t),\n$$\n其中 $\\chi(Z,t)$ 是标量耗散率，$S_{\\phi}(Z,t)$ 是一个源项。然后，将其特化为一个单步反应的降阶模型，其中标量是进程变量 $C(Z,t)$，标量耗散率在 $Z$ 空间上均匀，并在时间 $t=0$ 时突然减小，化学源项由一个具有化学计量中心 $Z_{\\mathrm{st}}$ 的局部、有界、自催化形式给出：\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\chi(t)}{2}\\,\\frac{\\partial^2 C}{\\partial Z^2} + \\mathrm{Da}\\,G(Z;Z_{\\mathrm{st}},\\sigma_R)\\,C\\,(1-C),\n$$\n其狄利克雷边界条件为 $C(0,t)=0$ 和 $C(1,t)=0$，初始条件代表一个近乎熄灭的状态，\n$$\nC(Z,0) = \\varepsilon\\,G(Z;Z_{\\mathrm{st}},\\sigma_R),\n$$\n其中 $\\varepsilon \\ll 1$，$\\mathrm{Da}  0$ 是一个 Damköhler 数，$\\sigma_R  0$ 是反应区的局部化宽度，且\n$$\nG(Z;Z_{\\mathrm{st}},\\sigma_R) = \\exp\\!\\left(-\\frac{(Z-Z_{\\mathrm{st}})^2}{2\\,\\sigma_R^2}\\right).\n$$\n假设标量耗散率在 $Z$ 空间上均匀，且在时间上是分段常数，\n$$\n\\chi(t) = \\begin{cases}\n\\chi_{\\mathrm{hi}},  t  0, \\\\\n\\chi_{\\mathrm{lo}},  t \\ge 0,\n\\end{cases}\n$$\n并且系统在 $t=0$ 时从上述近乎熄灭的初始条件开始。你需要分析在 $t=0$ 时 $\\chi_{\\mathrm{hi}} \\to \\chi_{\\mathrm{lo}}$ 突然减小后，$Z$ 空间中的点火瞬态过程。\n\n你的任务是实现一个数值求解器，用于求解在无量纲单位下 $Z \\in [0,1]$ 和 $t \\ge 0$ 上的初边值问题。使用方法线法：在 $Z$ 空间上，使用拉普拉斯算子的二阶中心有限差分近似并结合狄利克雷边界条件进行离散化；在时间上，使用刚性常微分方程求解器进行积分。通过刚性求解器隐式处理扩散项，并逐点计算非线性源项。\n\n通过以下方式定义一个点火指标\n$$\nI(t) = \\max_{Z \\in [0,1]} C(Z,t).\n$$\n将点火时间 $t_{\\mathrm{ign}}$ 定义为使得 $I(t)$ 达到或超过指定阈值 $\\theta \\in (0,1)$ 的第一个时间 $t \\ge 0$，即\n$$\nt_{\\mathrm{ign}} = \\inf \\left\\{ t \\ge 0 \\,:\\, I(t) \\ge \\theta \\right\\}.\n$$\n如果在指定的最大模拟时间 $t_{\\max}$ 内，$I(t)$ 未能达到 $\\theta$，则报告 $t_{\\mathrm{ign}}=-1$。\n\n所有时间均以无量纲单位表示。你的程序必须对所有测试用例应用相同的均匀空间网格，并对初始条件使用 $\\varepsilon=10^{-4}$。\n\n实现你的求解器并计算以下四个测试用例的 $t_{\\mathrm{ign}}$，每个用例以参数元组 $(\\mathrm{Da},\\chi_{\\mathrm{hi}},\\chi_{\\mathrm{lo}},Z_{\\mathrm{st}},\\sigma_R,\\theta,t_{\\max})$ 的形式提供：\n\n- 用例 A (标称点火): $(150.0,\\,8.0,\\,0.8,\\,0.5,\\,0.05,\\,0.5,\\,5.0)$\n- 用例 B (时限内未点火): $(30.0,\\,8.0,\\,3.0,\\,0.5,\\,0.05,\\,0.5,\\,5.0)$\n- 用例 C (窄反应区快速点火): $(200.0,\\,12.0,\\,0.5,\\,0.5,\\,0.03,\\,0.6,\\,3.0)$\n- 用例 D (临界点火): $(80.0,\\,10.0,\\,1.5,\\,0.5,\\,0.05,\\,0.4,\\,5.0)$\n\n你的程序应生成单行输出，其中包含四个测试用例的点火时间，格式为方括号内以逗号分隔的浮点数列表，顺序为 A、B、C、D。以无量纲单位报告 $t_{\\mathrm{ign}}$，每个用例保留五位小数。如果在 $t_{\\max}$ 之前没有发生点火，则该用例报告 $-1.00000$。\n\n你的实现必须是自包含的，且不得要求任何用户输入。数值方法必须在整个测试套件的参数变化中保持稳健，同时遵守所述的假设和模型选择。",
            "solution": "该问题要求对一个简化的非稳态小火焰方程进行数值求解，该方程是一个一维抛物型偏微分方程 (PDE)，目的是为几组物理参数确定点火时间。\n\n首先，我们验证控制方程的来源和形式。问题从流体中化学组分质量分数 $Y_i$ 的通用守恒方程开始。在密度 $\\rho$ 恒定和组分扩散系数 $D_i=D$ 相等（意味着 Lewis 数为 1）的假设下，组分输运方程为：\n$$\n\\rho \\frac{\\partial Y_i}{\\partial t} + \\rho \\mathbf{v} \\cdot \\nabla Y_i = -\\nabla \\cdot \\mathbf{j}_i + \\dot{\\omega}_i\n$$\n使用 Fick 定律表示扩散通量 $\\mathbf{j}_i = -\\rho D \\nabla Y_i$，并在密度恒定的情况下，该方程简化为：\n$$\n\\frac{\\partial Y_i}{\\partial t} + \\mathbf{v} \\cdot \\nabla Y_i = D \\nabla^2 Y_i + \\frac{\\dot{\\omega}_i}{\\rho}\n$$\nShvab–Zel’dovich 列式引入了一个守恒标量，即混合分数 $Z$，它没有源项，并由以下方程控制：\n$$\n\\frac{\\partial Z}{\\partial t} + \\mathbf{v} \\cdot \\nabla Z = D \\nabla^2 Z\n$$\n应用从物理坐标 $(\\mathbf{x}, t)$ 到混合分数坐标 $(Z, t)$ 的坐标变换。对于任何表示为 $Z$ 和 $t$ 函数的标量 $\\phi$，其输运方程 $\\frac{\\partial \\phi}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\phi = D \\nabla^2 \\phi + S_\\phi$ 可以被变换。使用链式法则，导数如下：\n$$\n\\frac{\\partial \\phi}{\\partial t}\\bigg|_{\\mathbf{x}} = \\frac{\\partial \\phi}{\\partial t}\\bigg|_{Z} + \\frac{\\partial \\phi}{\\partial Z}\\frac{\\partial Z}{\\partial t}\\bigg|_{\\mathbf{x}}\n$$\n$$\n\\nabla \\phi = \\frac{\\partial \\phi}{\\partial Z} \\nabla Z\n$$\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial Z^2} (\\nabla Z \\cdot \\nabla Z) + \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z = \\frac{\\partial^2 \\phi}{\\partial Z^2} |\\nabla Z|^2 + \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z\n$$\n将这些代入 $\\phi$ 的输运方程，得到：\n$$\n\\left( \\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial \\phi}{\\partial Z}\\frac{\\partial Z}{\\partial t} \\right) + \\mathbf{v} \\cdot \\left( \\frac{\\partial \\phi}{\\partial Z} \\nabla Z \\right) = D \\left( \\frac{\\partial^2 \\phi}{\\partial Z^2} |\\nabla Z|^2 + \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z \\right) + S_\\phi\n$$\n重新整理并使用 $Z$ 的输运方程来替换项 $\\frac{\\partial Z}{\\partial t} + \\mathbf{v} \\cdot \\nabla Z$：\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial \\phi}{\\partial Z} \\left( D \\nabla^2 Z \\right) = D \\frac{\\partial^2 \\phi}{\\partial Z^2} |\\nabla Z|^2 + D \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z + S_\\phi\n$$\n涉及 $\\nabla^2 Z$ 的项相互抵消，剩下：\n$$\n\\frac{\\partial \\phi}{\\partial t} = D |\\nabla Z|^2 \\frac{\\partial^2 \\phi}{\\partial Z^2} + S_\\phi\n$$\n通过将标量耗散率定义为 $\\chi(Z,t) = 2D |\\nabla Z|^2$，我们得到非稳态小火焰方程的一般形式：\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\chi(Z,t)}{2}\\,\\frac{\\partial^2 \\phi}{\\partial Z^2} + S_{\\phi}(Z,t)\n$$\n此推导证实了问题中所提供模型的理论合理性。\n\n待求解的具体问题是此方程在区域 $Z \\in [0,1]$ 上针对进程变量 $C(Z,t)$ 的一个特例：\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\chi(t)}{2}\\,\\frac{\\partial^2 C}{\\partial Z^2} + \\mathrm{Da}\\,G(Z;Z_{\\mathrm{st}},\\sigma_R)\\,C\\,(1-C)\n$$\n边界条件为 $C(0,t)=0$，$C(1,t)=0$，初始条件为 $C(Z,0) = \\varepsilon\\,G(Z;Z_{\\mathrm{st}},\\sigma_R)$。对于从 $t=0$ 开始的模拟，标量耗散率是常数 $\\chi(t) = \\chi_{\\mathrm{lo}}$。参数 $\\chi_{\\mathrm{hi}}$ 涉及 $t=0$ 之前的系统状态，在 $t \\ge 0$ 的模拟中不使用。\n\n我们使用方法线法求解这个偏微分方程。空间域 $Z \\in [0,1]$ 被离散化为 $N_Z$ 个均匀分布的点 $Z_j = j \\cdot \\Delta Z$，其中 $j=0, 1, \\dots, N_Z-1$，$\\Delta Z = 1/(N_Z-1)$。令 $C_j(t)$ 表示 $C(Z_j, t)$ 的数值近似。内部网格点（$j=1, \\dots, N_Z-2$）的二阶空间导数（拉普拉斯算子）使用二阶中心有限差分格式来近似：\n$$\n\\left.\\frac{\\partial^2 C}{\\partial Z^2}\\right|_{Z_j} \\approx \\frac{C_{j+1}(t) - 2C_j(t) + C_{j-1}(t)}{(\\Delta Z)^2}\n$$\n这种离散化将单个偏微分方程转换为一个由 $N_Z-2$ 个针对内部点的耦合常微分方程组 (ODEs) 构成的系统。每个 $C_j(t)$ 的常微分方程为：\n$$\n\\frac{dC_j}{dt} = \\frac{\\chi_{\\mathrm{lo}}}{2} \\left( \\frac{C_{j+1} - 2C_j + C_{j-1}}{(\\Delta Z)^2} \\right) + \\mathrm{Da}\\,G(Z_j)\\,C_j\\,(1-C_j)\n$$\n狄利克雷边界条件 $C_0(t)=0$ 和 $C_{N_Z-1}(t)=0$ 在 $C_1$ 和 $C_{N_Z-2}$ 的方程中被直接强制执行。\n\n由于离散化扩散项引入的强耦合，该常微分方程组是刚性的，尤其是在细网格（小 $\\Delta Z$）上。我们使用一个合适的刚性常微分方程求解器，即 `scipy.integrate.solve_ivp` 及其 `BDF` (后向差分公式) 方法，来对系统在时间上从 $t=0$ 积分到 $t=t_{\\max}$。\n\n点火时间 $t_{\\mathrm{ign}}$ 被定义为点火指标 $I(t) = \\max_{Z \\in [0,1]} C(Z,t)$ 达到给定阈值 $\\theta$ 的第一个时间 $t \\ge 0$。这是通过使用常微分方程求解器的事件检测功能来实现的。我们定义一个事件函数 $e(t, \\mathbf{C}) = \\max(\\mathbf{C}) - \\theta$，其中 $\\mathbf{C}$ 是内部 $C_j$ 值的向量。求解器被配置为寻找此函数的根（即 $e=0$ 的地方）并终止积分。此事件发生的时间即为 $t_{\\mathrm{ign}}$。如果积分在达到 $t_{\\max}$ 前事件未发生，则表示点火失败，报告 $t_{\\mathrm{ign}}$ 为 -1。\n\n在数值实现中，使用一个具有 $N_Z=401$ 个点的足够精细的网格，以确保对狭窄反应区的解析度，尤其是在用例 C 中。初始条件在该网格上使用规定的值 $\\varepsilon=10^{-4}$ 进行评估。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the unsteady flamelet equation for ignition transients.\n    \"\"\"\n    test_cases = [\n        # (Da, chi_hi, chi_lo, Z_st, sigma_R, theta, t_max)\n        (150.0, 8.0, 0.8, 0.5, 0.05, 0.5, 5.0),    # Case A\n        (30.0, 8.0, 3.0, 0.5, 0.05, 0.5, 5.0),    # Case B\n        (200.0, 12.0, 0.5, 0.5, 0.03, 0.6, 3.0),    # Case C\n        (80.0, 10.0, 1.5, 0.5, 0.05, 0.4, 5.0),    # Case D\n    ]\n\n    # Shared numerical parameters as per problem description\n    N_Z = 401\n    epsilon = 1e-4\n\n    # Set up the uniform spatial grid for all cases\n    Z_grid = np.linspace(0.0, 1.0, N_Z)\n    dZ = Z_grid[1] - Z_grid[0]\n    Z_interior = Z_grid[1:-1]\n\n    results = []\n\n    for case in test_cases:\n        Da, chi_hi, chi_lo, Z_st, sigma_R, theta, t_max = case\n        \n        # Pre-calculate the Gaussian part of the source term and initial condition\n        G_Z = np.exp(-(Z_grid - Z_st)**2 / (2.0 * sigma_R**2))\n        G_interior = G_Z[1:-1]\n        \n        # Initial condition for the progress variable C at t=0\n        C0 = epsilon * G_Z\n        y0 = C0[1:-1]  # State vector for interior points\n\n        def rhs(t, y):\n            \"\"\"\n            Right-hand side of the ODE system from method-of-lines.\n            y is the vector of C values at the interior grid points.\n            \"\"\"\n            # Reconstruct the full vector C including boundaries\n            C_full = np.concatenate(([0.0], y, [0.0]))\n            \n            # 1. Diffusion term (discretized Laplacian)\n            laplacian = (C_full[2:] - 2.0 * C_full[1:-1] + C_full[:-2]) / (dZ**2)\n            diffusion_term = (chi_lo / 2.0) * laplacian\n            \n            # 2. Source term\n            source_term = Da * G_interior * y * (1.0 - y)\n            \n            return diffusion_term + source_term\n\n        def ignition_event(t, y):\n            \"\"\"\n            Event function to detect ignition.\n            Triggers when max(C) reaches the threshold theta.\n            \"\"\"\n            return np.max(y) - theta\n        \n        ignition_event.terminal = True  # Stop integration when event occurs\n        ignition_event.direction = 1    # Trigger only when value increases past zero\n\n        # Solve the initial value problem\n        sol = solve_ivp(\n            fun=rhs,\n            t_span=(0, t_max),\n            y0=y0,\n            method='BDF',  # Stiff solver\n            events=ignition_event,\n            dense_output=True, # For accurate event location\n            rtol=1e-6,\n            atol=1e-9\n        )\n\n        # Determine ignition time from a successful event detection\n        # sol.status == 1 means an event terminated the integration.\n        if sol.status == 1 and sol.t_events[0].size > 0:\n            t_ign = sol.t_events[0][0]\n        else:\n            # No ignition within t_max or solver failed\n            t_ign = -1.0\n        \n        results.append(t_ign)\n\n    # Format output to 5 decimal places as required\n    formatted_results = [f\"{r:.5f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```"
        }
    ]
}