{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex simulations, it is crucial to correctly formulate the mathematical problem. This first exercise  challenges you to distinguish the setup for a burner-stabilized flame from that of a freely propagating flame. Understanding this difference—why one is a boundary-value problem with a specified mass flow and the other is an eigenvalue problem that solves for the flame speed—is the bedrock of computational flame modeling.",
            "id": "4010680",
            "problem": "A one-dimensional, steady premixed flame can be modeled in two canonical configurations used in computational combustion: a burner-stabilized flame anchored on a solid burner and a freely propagating flame without a solid anchoring surface. Both are governed by conservation of mass, species, and energy for a reacting multicomponent mixture. Let $x$ denote the axial coordinate, $\\rho$ the density, $u$ the axial velocity, $Y_k$ the mass fraction of species $k$, $J_k$ the diffusive mass flux of species $k$, $\\dot{\\omega}_k$ the chemical production rate of species $k$, $T$ the temperature, $\\lambda$ the thermal conductivity, $h$ a heat transfer coefficient, $T_w$ a burner wall temperature, $T_u$ the unburned-gas temperature, and $S_L$ the laminar burning velocity. In both configurations, the steady conservation equations reduce, under a mixture-averaged closure for diffusion, to the following form along $x$: mass conservation $d(\\rho u)/dx = 0$; species conservation $\\rho u \\, dY_k/dx + dJ_k/dx = \\dot{\\omega}_k$; and energy conservation $\\rho u \\, c_p \\, dT/dx - d(\\lambda \\, dT/dx)/dx = -\\sum_k h_k \\dot{\\omega}_k + \\text{diffusive enthalpy terms}$, with $c_p$ the specific heat at constant pressure and $h_k$ the specific enthalpy of species $k$.\n\nSelect the option that correctly and completely contrasts the appropriate boundary conditions and the stabilization or propagation criteria for these two configurations, expressed in physically consistent mathematical form.\n\nA. Burner-stabilized flame: finite domain $x \\in [0,L]$ with a solid burner at $x=0$. Impose a thermal boundary at the burner by either a Dirichlet condition $T(0)=T_w$ or a Robin condition $-\\lambda \\, \\frac{dT}{dx}\\big|_{x=0} = h \\, [\\,T(0)-T_w\\,]$. Impose zero normal species flux at the burner, $J_k(0)=0$ for all $k$. Specify the inflow by fixing the mass flux via $u(0)=u_{\\text{in}}$ so $m=\\rho u$ is determined by $d(\\rho u)/dx=0$. At the outflow $x=L$, apply open boundaries $\\frac{dT}{dx}(L)=0$ and $\\frac{dY_k}{dx}(L)=0$ so the solution exits smoothly. Stabilization criterion: the flame is stationary in the laboratory frame when the imposed convective inflow matches the mixture’s effective burning capability under the loss and strain environment, i.e., $u_{\\text{in}} = S_L^{\\text{eff}}$; if $u_{\\text{in}} < S_L^{\\text{eff}}$ the flame flashes back, whereas if $u_{\\text{in}} > S_L^{\\text{eff}}$ it blows off. Freely propagating flame: infinite or sufficiently large domain in a frame moving at unknown speed $S_L$. Upstream far-field Dirichlet conditions at $x \\to -\\infty$: $T(-\\infty)=T_u$ and $Y_k(-\\infty)=Y_{k,u}$. Downstream far-field approach-to-equilibrium with vanishing gradients at $x \\to +\\infty$: $\\frac{dT}{dx}(+\\infty)=0$ and $\\frac{dY_k}{dx}(+\\infty)=0$. Propagation criterion: $S_L$ is an eigenvalue that emerges from satisfying both far-field conditions simultaneously with $d(\\rho u)/dx=0$.\n\nB. Freely propagating flame: finite domain with a cold wall at $x=0$ satisfying $T(0)=T_w$ and $J_k(0)=0$ and a prescribed inlet $u(0)=u_{\\text{in}}$, while $S_L$ is computed a posteriori from $m=\\rho u$. Burner-stabilized flame: modeled in a moving frame with unknown $S_L$, with upstream Dirichlet unburned conditions and downstream zero-gradient conditions.\n\nC. Burner-stabilized flame: impose Dirichlet species composition at the wall, $Y_k(0)=Y_{k,u}$, and an adiabatic wall $-\\lambda \\frac{dT}{dx}\\big|_{x=0}=0$; the flame is stationary when the upstream temperature gradient vanishes, $\\frac{dT}{dx}(0)=0$. Freely propagating flame: impose burned-state Dirichlet values $Y_k(+\\infty)=Y_{k,b}$ and $T(+\\infty)=T_b$ downstream, and take $S_L = u_{\\text{in}}$ as known from the inflow.\n\nD. Freely propagating flame: impose Dirichlet conditions at both upstream and downstream, $T(-\\infty) = T_u$, $Y_k(-\\infty)=Y_{k,u}$, $T(+\\infty)=T_b$, $Y_k(+\\infty)=Y_{k,b}$, and specify $S_L$ as $S_L = m/\\rho_u$ where $\\rho_u$ is the upstream density. Burner-stabilized flame: impose zero-gradient conditions at the burner, $\\frac{dT}{dx}(0)=0$ and $\\frac{dY_k}{dx}(0)=0$, with an unknown inflow $u(0)$ adjusted so the flame remains at $x=0$.",
            "solution": "The problem statement is evaluated to be **valid**. It is scientifically grounded, well-posed, objective, and presents a standard, non-trivial problem in computational combustion theory. The governing equations and physical scenarios described—the burner-stabilized flame and the freely propagating flame—are canonical models. The question asks for a clear and precise distinction between the mathematical formulations of these two problems, which is a fundamental concept in the field. The provided information is self-contained and sufficient to answer the question.\n\nThe core of the problem is to distinguish the mathematical setup for two fundamental one-dimensional ($1$D) premixed flame models.\n\n**1. Burner-Stabilized Flame**\n\nThis configuration models a flame that is held stationary in the laboratory frame by a solid object, typically a porous plug burner through which a premixed fuel-oxidizer mixture flows.\n\n*   **Governing Equations and Frame of Reference**: The problem is solved in a stationary (laboratory) frame of reference. The flame is located at a fixed position relative to the burner, which is placed at a boundary, say $x=0$. The governing equations for mass, species, and energy are solved on a finite domain, $x \\in [0, L]$.\n*   **Key Parameter**: The mass flow rate per unit area, $m = \\rho u$, is a constant throughout the domain since $d(\\rho u)/dx = 0$. In this configuration, $m$ is a *prescribed input parameter*. The experimenter or computational scientist sets the inflow velocity, $u_{\\text{in}}$, and mixture properties, which fixes $m$.\n*   **Boundary Conditions**:\n    *   At the inflow/burner surface ($x=0$): a) The velocity is specified, $u(0)=u_{\\text{in}}$. b) A thermal boundary condition is required to account for heat transfer between the gas and the solid burner. This can be a Dirichlet condition, specifying the temperature $T(0)=T_w$, or more generally, a Robin condition that models heat loss, such as $-\\lambda \\frac{dT}{dx}\\big|_{x=0} = h (T(0) - T_w)$, where $h$ is a heat transfer coefficient and $T_w$ is the burner coolant temperature. The adiabatic case, $\\frac{dT}{dx}\\big|_{x=0} = 0$, is a special case where there is no heat loss. c) Species boundary conditions must be set. For an inert, non-catalytic, impermeable burner surface, the net flux of each species to the wall is zero. A common and physically reasonable boundary condition is to set the diffusive mass flux to zero, $J_k(0) = 0$ for all species $k$.\n    *   At the outflow ($x=L$): The computational domain must be long enough for the combustion to be complete (or nearly so). To prevent the boundary from artificially influencing the solution, \"open\" or \"soft\" boundary conditions are applied. These are typically zero-gradient (Neumann) conditions: $\\frac{dT}{dx}(L)=0$ and $\\frac{dY_k}{dx}(L)=0$.\n*   **Stabilization Criterion**: The problem is a boundary-value problem. For a given set of parameters (inflow mass flux $m$, unburned mixture properties, burner thermal properties), one solves for the steady-state profiles $T(x)$ and $Y_k(x)$. A physically stable flame corresponds to the existence of a steady solution. The stabilization is physically understood as a balance between the imposed flow speed and the flame's tendency to propagate. For a given mixture, there's a range of flow rates for which a stable flame exists. If the flow is too slow, the flame flashes back (propagates upstream); if it's too fast, it blows off (is convected away).\n\n**2. Freely Propagating Flame**\n\nThis configuration models an idealized, planar flame propagating freely into a quiescent, uniform unburned mixture, far from any walls or restraining surfaces.\n\n*   **Governing Equations and Frame of Reference**: The problem is most conveniently solved in a frame of reference moving with the flame front. In this frame, the flame is stationary, and the unburned gas flows towards it from $x \\to -\\infty$ at a speed $S_L$, the laminar burning velocity. The burned products flow away towards $x \\to +\\infty$. The domain is theoretically infinite, $x \\in (-\\infty, +\\infty)$.\n*   **Key Parameter**: The mass flow rate, $m = \\rho u$, is again constant. However, in this configuration, $m$ is not a prescribed parameter. It is an *unknown eigenvalue* of the problem. The laminar burning velocity is then determined from this eigenvalue as $S_L = m/\\rho_u$, where $\\rho_u$ is the density of the unburned gas.\n*   **Boundary Conditions**:\n    *   At the upstream far-field ($x \\to -\\infty$): The flow is the unburned mixture. Dirichlet conditions are applied: $T(-\\infty)=T_u$ and $Y_k(-\\infty)=Y_{k,u}$.\n    *   At the downstream far-field ($x \\to +\\infty$): The combustion is complete, and the gas is in chemical equilibrium. All gradients must vanish. Neumann conditions are applied: $\\frac{dT}{dx}(+\\infty)=0$ and $\\frac{dY_k}{dx}(+\\infty)=0$.\n*   **Propagation Criterion**: The system of governing ordinary differential equations, subject to the two-point boundary conditions at $\\pm\\infty$, constitutes a non-linear eigenvalue problem. A non-trivial solution (i.e., a flame profile) exists only for a unique, specific value of the mass flux $m$. Finding this eigenvalue is the primary goal of the computation, as it determines the fundamental property of the mixture, the laminar burning velocity $S_L$.\n\nBased on this analysis, we evaluate the options.\n\n**Option A**\n*   **Burner-stabilized flame description**: Correctly identifies the finite domain $[0,L]$ with a burner at $x=0$. It correctly lists the standard thermal boundary conditions (Dirichlet $T(0)=T_w$ or Robin $-\\lambda \\frac{dT}{dx}|_{x=0} = h[T(0)-T_w]$) and a standard species condition ($J_k(0)=0$). It correctly states that the mass flux $m$ is determined by a fixed inflow $u(0)=u_{\\text{in}}$. It correctly identifies the outflow conditions as zero-gradient, $\\frac{dT}{dx}(L)=0$ and $\\frac{dY_k}{dx}(L)=0$. The physical interpretation of stabilization is also correct.\n*   **Freely propagating flame description**: Correctly identifies the moving frame and infinite domain. It correctly specifies the upstream Dirichlet conditions ($T(-\\infty)=T_u$, $Y_k(-\\infty)=Y_{k,u}$) and downstream zero-gradient conditions ($\\frac{dT}{dx}(+\\infty)=0$, $\\frac{dY_k}{dx}(+\\infty)=0$). Critically, it correctly identifies $S_L$ (via the mass flux $m$) as an eigenvalue that emerges from satisfying the boundary conditions.\n*   **Verdict**: This option accurately and completely contrasts the two configurations. **Correct**.\n\n**Option B**\n*   This option incorrectly swaps the descriptions of the two flame types. It attributes a \"cold wall\" and a \"prescribed inlet\" to the freely propagating flame, which by definition has no walls. It attributes the \"moving frame with unknown $S_L$\" to the burner-stabilized flame, which is incorrect.\n*   **Verdict**: **Incorrect**.\n\n**Option C**\n*   **Burner-stabilized flame description**: It incorrectly proposes imposing Dirichlet species composition $Y_k(0)=Y_{k,u}$, which is a possible but less general and physically problematic condition. It restricts the thermal condition to only the adiabatic case, which is not general. Its stabilization criterion, $\\frac{dT}{dx}(0)=0$, is merely the adiabatic boundary condition itself, not a criterion for stabilization.\n*   **Freely propagating flame description**: It incorrectly proposes imposing Dirichlet conditions for the burned state temperature $T_b$ and composition $Y_{k,b}$ downstream. This over-constrains the problem; the burned state is a result of the calculation, not an input. It also incorrectly states that $S_L$ is a known quantity.\n*   **Verdict**: **Incorrect**.\n\n**Option D**\n*   **Freely propagating flame description**: As with option C, it incorrectly imposes Dirichlet conditions at the downstream boundary, which is a fundamental error. It also incorrectly implies that $S_L$ or $m$ is a specified quantity.\n*   **Burner-stabilized flame description**: It incorrectly states that zero-gradient conditions are imposed at the burner; a non-adiabatic burner, which is the general case, has a non-zero temperature gradient. It also incorrectly claims the inflow $u(0)$ is unknown and adjusted; in the standard formulation, the inflow mass flux is a fixed input parameter.\n*   **Verdict**: **Incorrect**.\n\nIn conclusion, Option A is the only one that presents a physically and mathematically sound contrast between the two canonical flame models.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "With the mathematical framework established, we can now analyze the flame's internal structure. This practice  guides you through a scaling analysis to estimate the characteristic thicknesses of the preheat and reaction zones. By applying this analysis, you will investigate how heat loss to the burner—a defining feature of this configuration—can thicken the reaction zone, revealing the physical conditions under which the widely used 'thin-flame' approximation breaks down.",
            "id": "4010715",
            "problem": "Consider a one-dimensional, steady, burner-stabilized premixed flame established above a cooled porous burner at position $x=0$. The gaseous mixture enters with uniform velocity $u$ and unburned temperature $T_u$, and the wall is maintained at a temperature $T_w<T_u$. The thermal conductivity is $k$, the mass density is $\\rho$, the constant-pressure specific heat is $c_p$, and the mass diffusivity of the deficient reactant is $D$. Assume constant properties and planar symmetry.\n\nStarting from first principles, use the steady conservation of energy and species for the dominant reactant, respectively,\n$$\n\\rho c_p u \\frac{dT}{dx} = \\frac{d}{dx}\\left(k\\frac{dT}{dx}\\right) - \\sum_i h_i \\omega_i,\n\\qquad\n\\rho u \\frac{dY}{dx} = \\frac{d}{dx}\\left(\\rho D\\frac{dY}{dx}\\right) + \\omega,\n$$\nto obtain scaling estimates for two characteristic thicknesses in the near-wall flame structure:\n- the thermal boundary layer thickness $\\delta_T$, controlled by the balance of convection and conduction near the cooled wall, and\n- the reaction zone thickness $\\delta_R$, controlled by the balance of molecular diffusion and chemical reaction in the neighborhood of the flame where the reactant is consumed.\n\nTreat the dominant chemical source of the reactant as effectively first order with a temperature-dependent rate constant $k_\\omega(T)$ so that, locally, $\\omega \\sim \\rho k_\\omega(T)\\, Y$. For scaling, focus on balances between the leading terms indicated by the equations.\n\nThen, using the following representative property values for a near-atmospheric hydrocarbon-air flame:\n$$\n\\rho = 1.2\\,\\mathrm{kg/m^3},\\quad c_p = 1200\\,\\mathrm{J/(kg\\cdot K)},\\quad k=0.08\\,\\mathrm{W/(m\\cdot K)},\\quad D=5.0\\times 10^{-5}\\,\\mathrm{m^2/s},\\quad u=0.50\\,\\mathrm{m/s},\n$$\nevaluate and compare the ratio $\\Xi \\equiv \\delta_R/\\delta_T$ in two cases:\n1) an adiabatic-flame-temperature case where $k_\\omega(T_f)=2.0\\times 10^4\\,\\mathrm{s^{-1}}$,\n2) a strong-heat-loss case where wall cooling lowers the local peak temperature sufficiently that $k_\\omega(T_f)=3.0\\times 10^3\\,\\mathrm{s^{-1}}$.\n\nBased on your derivation and numerical estimates, select the most accurate statement about when the thin-flame approximation (flame treated as an infinitely thin sheet with discontinuities in scalar fields) fails in burner-stabilized flames due to strong heat loss, and interpret the example in terms of the relation between $\\delta_R$ and $\\delta_T$:\n\n- A. The thin-flame approximation fails when $\\delta_R/\\delta_T \\gtrsim 1$, i.e., when the reaction zone thickness becomes comparable to or exceeds the thermal boundary layer thickness because heat loss reduces $k_\\omega(T)$ and broadens the reaction zone; in the strong-heat-loss case above, this condition is met.\n\n- B. The thin-flame approximation fails when $\\delta_R/\\delta_T \\ll 1$, because the flame is too sharp to resolve; the strong-heat-loss case above illustrates this situation.\n\n- C. If the Lewis number (ratio of thermal to mass diffusivity, $\\mathrm{Le}\\equiv \\alpha/D$ with $\\alpha=k/(\\rho c_p)$) is unity, the thin-flame approximation remains valid regardless of heat loss, so failure cannot be attributed to heat loss.\n\n- D. Failure of the thin-flame approximation requires $T_w=T_u$; otherwise, heat loss cannot induce failure even if the reaction zone thickens.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It describes a canonical problem in combustion science—a one-dimensional burner-stabilized flame—and provides standard conservation equations and realistic physical parameters. The questions posed are precise and can be answered through a standard scaling analysis of the provided equations. The problem is valid.\n\nWe will proceed with the derivation as requested. The problem asks for scaling estimates for two characteristic lengths: the thermal boundary layer thickness, $\\delta_T$, and the reaction zone thickness, $\\delta_R$.\n\n**1. Scaling for the Thermal Boundary Layer Thickness ($\\delta_T$)**\n\nThe thermal boundary layer, or preheat zone, is the region near the burner where heat from the flame is conducted upstream, balancing the convective flow of the unburned mixture. In this region, chemical reactions are negligible. The steady-state energy conservation equation, neglecting the reaction term, is:\n$$ \\rho c_p u \\frac{dT}{dx} = \\frac{d}{dx}\\left(k\\frac{dT}{dx}\\right) $$\nAssuming constant properties ($k$, $\\rho$, $c_p$), this simplifies to:\n$$ \\rho c_p u \\frac{dT}{dx} = k \\frac{d^2T}{dx^2} $$\nTo find the characteristic thickness $\\delta_T$ of this layer, we perform a scaling analysis. Let the characteristic length scale be $x \\sim \\delta_T$. The derivatives are scaled as:\n$$ \\frac{dT}{dx} \\sim \\frac{\\Delta T}{\\delta_T} \\quad \\text{and} \\quad \\frac{d^2T}{dx^2} \\sim \\frac{\\Delta T}{\\delta_T^2} $$\nwhere $\\Delta T$ is a characteristic temperature difference across the layer.\nSubstituting these scales into the energy equation gives the balance between the convective and conductive terms:\n$$ \\rho c_p u \\frac{\\Delta T}{\\delta_T} \\sim k \\frac{\\Delta T}{\\delta_T^2} $$\nSolving for $\\delta_T$, we get:\n$$ \\delta_T \\sim \\frac{k}{\\rho c_p u} $$\nThis can also be expressed using the thermal diffusivity, $\\alpha = k/(\\rho c_p)$:\n$$ \\delta_T \\sim \\frac{\\alpha}{u} $$\n\n**2. Scaling for the Reaction Zone Thickness ($\\delta_R$)**\n\nThe reaction zone is a thin region within the flame where the fuel is consumed. The problem asks to determine its thickness, $\\delta_R$, by balancing molecular diffusion and chemical reaction. The governing equation for the mass fraction $Y$ of the deficient reactant is:\n$$ \\rho u \\frac{dY}{dx} = \\frac{d}{dx}\\left(\\rho D\\frac{dY}{dx}\\right) + \\omega $$\nThe reaction source term is given as $\\omega \\sim \\rho k_\\omega(T) Y$. In the thin reaction zone of a premixed flame (a concept formalized in large activation energy asymptotics), the diffusive flux is balanced by the consumption rate. Convection is typically a smaller effect within this layer. Following the problem's directive, we balance the diffusion and reaction terms.\nAssuming constant properties, the diffusion term is $\\frac{d}{dx}\\left(\\rho D\\frac{dY}{dx}\\right) = \\rho D \\frac{d^2Y}{dx^2}$.\nLet the characteristic length be $x \\sim \\delta_R$ and the characteristic mass fraction be $Y \\sim Y_u$, where $Y_u$ is the unburned reactant mass fraction. The scaling for the terms is:\n$$ \\text{Diffusion} \\sim \\rho D \\frac{d^2Y}{dx^2} \\sim \\rho D \\frac{Y_u}{\\delta_R^2} $$\n$$ \\text{Reaction} \\sim \\omega \\sim \\rho k_\\omega Y_u $$\nEquating these two terms:\n$$ \\rho D \\frac{Y_u}{\\delta_R^2} \\sim \\rho k_\\omega Y_u $$\nSolving for $\\delta_R$:\n$$ \\delta_R^2 \\sim \\frac{D}{k_\\omega} \\implies \\delta_R \\sim \\sqrt{\\frac{D}{k_\\omega}} $$\n\n**3. Numerical Evaluation**\n\nWe are given the following property values:\n$\\rho = 1.2\\,\\mathrm{kg/m^3}$\n$c_p = 1200\\,\\mathrm{J/(kg\\cdot K)}$\n$k = 0.08\\,\\mathrm{W/(m\\cdot K)}$\n$D = 5.0\\times 10^{-5}\\,\\mathrm{m^2/s}$\n$u = 0.50\\,\\mathrm{m/s}$\n\nFirst, we calculate the thermal boundary layer thickness $\\delta_T$:\n$$ \\delta_T \\sim \\frac{k}{\\rho c_p u} = \\frac{0.08}{1.2 \\times 1200 \\times 0.50} = \\frac{0.08}{720} \\approx 1.11 \\times 10^{-4}\\,\\mathrm{m} $$\n\nNext, we calculate the reaction zone thickness $\\delta_R$ for the two cases.\n\nCase 1: Adiabatic-flame-temperature case, $k_\\omega = 2.0\\times 10^4\\,\\mathrm{s^{-1}}$.\n$$ \\delta_{R,1} \\sim \\sqrt{\\frac{D}{k_\\omega}} = \\sqrt{\\frac{5.0 \\times 10^{-5}\\,\\mathrm{m^2/s}}{2.0 \\times 10^4\\,\\mathrm{s^{-1}}}} = \\sqrt{2.5 \\times 10^{-9}\\,\\mathrm{m^2}} = 5.0 \\times 10^{-5}\\,\\mathrm{m} $$\n\nCase 2: Strong-heat-loss case, $k_\\omega = 3.0\\times 10^3\\,\\mathrm{s^{-1}}$.\n$$ \\delta_{R,2} \\sim \\sqrt{\\frac{D}{k_\\omega}} = \\sqrt{\\frac{5.0 \\times 10^{-5}\\,\\mathrm{m^2/s}}{3.0 \\times 10^3\\,\\mathrm{s^{-1}}}} \\approx \\sqrt{1.67 \\times 10^{-8}\\,\\mathrm{m^2}} \\approx 1.29 \\times 10^{-4}\\,\\mathrm{m} $$\n\nFinally, we evaluate the ratio $\\Xi \\equiv \\delta_R/\\delta_T$ for both cases:\n\nCase 1:\n$$ \\Xi_1 = \\frac{\\delta_{R,1}}{\\delta_T} \\approx \\frac{5.0 \\times 10^{-5}\\,\\mathrm{m}}{1.11 \\times 10^{-4}\\,\\mathrm{m}} \\approx 0.45 $$\n\nCase 2:\n$$ \\Xi_2 = \\frac{\\delta_{R,2}}{\\delta_T} \\approx \\frac{1.29 \\times 10^{-4}\\,\\mathrm{m}}{1.11 \\times 10^{-4}\\,\\mathrm{m}} \\approx 1.16 $$\n\n**4. Interpretation and Option Analysis**\n\nThe thin-flame approximation (or flame-sheet model) is predicated on the assumption that the reaction zone is asymptotically thin compared to the preheat zone, i.e., $\\delta_R \\ll \\delta_T$. Our results show that in the high-temperature (near-adiabatic) case, $\\Xi_1 \\approx 0.45$, so the reaction zone is thinner than the preheat zone, and the approximation is reasonably valid.\n\nHowever, in the strong-heat-loss case, the flame temperature is reduced. Chemical reaction rates are highly sensitive to temperature (typically following an Arrhenius law, $k_\\omega \\propto \\exp(-E_a/RT)$). The significant reduction in $k_\\omega$ from $2.0 \\times 10^4\\,\\mathrm{s^{-1}}$ to $3.0 \\times 10^3\\,\\mathrm{s^{-1}}$ reflects this. As shown by the scaling $\\delta_R \\sim 1/\\sqrt{k_\\omega}$, a slower reaction leads to a thicker reaction zone. Our calculation shows $\\delta_R$ increases from $5.0 \\times 10^{-5}\\,\\mathrm{m}$ to $1.29 \\times 10^{-4}\\,\\mathrm{m}$.\n\nIn this strong-heat-loss case, the ratio becomes $\\Xi_2 \\approx 1.16$, which means $\\delta_R \\gtrsim \\delta_T$. The reaction zone is now as thick as, or even thicker than, the thermal boundary layer. When this occurs, the flame can no longer be idealized as a thin sheet. The reactions are distributed over a wide region, and the fundamental assumption of the thin-flame model breaks down. This phenomenon is characteristic of flames approaching their quenching limit due to excessive heat loss.\n\n- **A. The thin-flame approximation fails when $\\delta_R/\\delta_T \\gtrsim 1$, i.e., when the reaction zone thickness becomes comparable to or exceeds the thermal boundary layer thickness because heat loss reduces $k_\\omega(T)$ and broadens the reaction zone; in the strong-heat-loss case above, this condition is met.**\nThis statement accurately summarizes the physics. The failure condition is correctly identified as $\\delta_R/\\delta_T \\gtrsim 1$. The causal chain—heat loss reduces temperature, which reduces $k_\\omega$, which broadens $\\delta_R$—is correct. The numerical results confirm that this condition is met in the strong-heat-loss case. This statement is **Correct**.\n\n- **B. The thin-flame approximation fails when $\\delta_R/\\delta_T \\ll 1$, because the flame is too sharp to resolve; the strong-heat-loss case above illustrates this situation.**\nThe condition $\\delta_R/\\delta_T \\ll 1$ is the requirement for the *validity* of the thin-flame approximation, not its failure. Furthermore, the strong-heat-loss case leads to $\\delta_R/\\delta_T \\approx 1.16$, which contradicts the condition $\\delta_R/\\delta_T \\ll 1$. This statement is **Incorrect**.\n\n- **C. If the Lewis number (ratio of thermal to mass diffusivity, $\\mathrm{Le}\\equiv \\alpha/D$ with $\\alpha=k/(\\rho c_p)$) is unity, the thin-flame approximation remains valid regardless of heat loss, so failure cannot be attributed to heat loss.**\nThe ratio of thicknesses is $\\Xi \\sim (u/\\sqrt{D k_\\omega}) / \\sqrt{\\mathrm{Le}}$. Even if $\\mathrm{Le}=1$, the ratio $\\Xi$ still depends on $k_\\omega$ as $1/\\sqrt{k_\\omega}$. Strong heat loss will decrease the flame temperature and thus $k_\\omega$, causing $\\Xi$ to increase. At a sufficiently small $k_\\omega$ (near quenching), $\\Xi$ will become large, and the thin-flame approximation will fail. Therefore, the Lewis number being unity does not prevent this failure mode. This statement is **Incorrect**.\n\n- **D. Failure of the thin-flame approximation requires $T_w=T_u$; otherwise, heat loss cannot induce failure even if the reaction zone thickens.**\nThe condition $T_w=T_u$ can correspond to a zero temperature gradient at the burner for a flame stabilized away from it, which implies an adiabatic flame with no heat loss to the burner. This is the ideal case where the thin-flame approximation is *most* valid, as the flame temperature and reaction rate are maximized, making the reaction zone thinnest. Failure is induced by strong heat loss, which requires a significant temperature difference between the flame and the cooled wall ($T_w \\ll T_{flame}$). The problem setup with a cooled burner is designed to study the effects of heat loss, which causes the failure. This statement is the opposite of the correct physical reasoning. This statement is **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The final practice moves from theory to implementation, a core skill in computational combustion. Here , you will develop a numerical solver for the species conservation equations in a burner-stabilized flame using the finite difference method. Beyond just obtaining a solution, the exercise emphasizes a critical step in all numerical modeling: verification, ensuring that your discrete solution accurately upholds the fundamental conservation laws it is meant to represent.",
            "id": "4010716",
            "problem": "Consider a one-dimensional, steady, burner-stabilized, planar premixed flame of constant cross-sectional area, modeled along the axial coordinate $x \\in [0,L]$ with $L$ in meters. Assume constant density $\\rho$ and mixture-averaged Fickian diffusion for each species $k$, with constant binary-diffusion-like effective diffusivity $D_k$. Let the axial velocity be $u(x)$ in meters per second. Define the species mass fraction $Y_k(x)$, the diffusive mass flux $J_k(x)$ (positive in the $+x$ direction), and the net volumetric mass source $\\dot{\\omega}_k(x)$ in kilograms per cubic meter per second. The species conservation equation at steady state is\n$$\n\\frac{d}{dx}\\left(\\rho\\,u(x)\\,Y_k(x) - J_k(x)\\right) = \\dot{\\omega}_k(x),\n$$\nwith the mixture-averaged diffusion closure\n$$\nJ_k(x) = -\\rho\\,D_k\\,\\frac{dY_k}{dx}.\n$$\nImpose the boundary conditions $Y_k(0)=Y_{k,\\text{in}}$ (Dirichlet inlet) and $\\frac{dY_k}{dx}(L)=0$ (Neumann outlet, zero gradient). The integral statement of conservation for each species over the domain is\n$$\n\\left[\\rho\\,u(L)\\,Y_k(L) - J_k(L)\\right] - \\left[\\rho\\,u(0)\\,Y_k(0) - J_k(0)\\right] = \\int_0^L \\dot{\\omega}_k(x)\\,dx.\n$$\nEquivalently,\n$$\n\\underbrace{\\left(\\rho\\,u(0)\\,Y_k(0) - J_k(0)\\right) - \\left(\\rho\\,u(L)\\,Y_k(L) - J_k(L)\\right)}_{\\text{inflow minus outflow in } \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}} = -\\int_0^L \\dot{\\omega}_k(x)\\,dx.\n$$\n\nYou are to verify this integral conservation numerically for the fuel and major products in a single-step reaction representative of hydrogen combustion,\n$$\n\\mathrm{H}_2 + \\tfrac{1}{2}\\,\\mathrm{O}_2 \\to \\mathrm{H}_2\\mathrm{O},\n$$\nusing a prescribed molar reaction rate profile $r(x)$ in moles per cubic meter per second and converting to mass source terms via molar masses. Use the following molar masses: $W_{\\mathrm{H}_2} = 0.002\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$, $W_{\\mathrm{O}_2} = 0.032\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$, and $W_{\\mathrm{H}_2\\mathrm{O}} = 0.018\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$. The species mass source terms are\n$$\n\\dot{\\omega}_{\\mathrm{H}_2}(x) = -1\\cdot W_{\\mathrm{H}_2}\\,r(x),\\quad\n\\dot{\\omega}_{\\mathrm{O}_2}(x) = -\\tfrac{1}{2}\\cdot W_{\\mathrm{O}_2}\\,r(x),\\quad\n\\dot{\\omega}_{\\mathrm{H}_2\\mathrm{O}}(x) = +1\\cdot W_{\\mathrm{H}_2\\mathrm{O}}\\,r(x),\n$$\nso that $\\dot{\\omega}_{\\mathrm{H}_2}(x)+\\dot{\\omega}_{\\mathrm{O}_2}(x)+\\dot{\\omega}_{\\mathrm{H}_2\\mathrm{O}}(x)=0$ pointwise.\n\nDiscretize the boundary value problem\n$$\n\\rho\\,u(x)\\,\\frac{dY_k}{dx} + \\rho\\,D_k\\,\\frac{d^2 Y_k}{dx^2} = \\dot{\\omega}_k(x)\n$$\non a uniform grid using second-order central differences for the interior and enforce $Y_k(0)=Y_{k,\\text{in}}$ and $\\frac{dY_k}{dx}(L)=0$ at the boundaries. Compute $J_k(x)$, and evaluate the boundary fluxes $\\rho\\,u(0)\\,Y_k(0)-J_k(0)$ and $\\rho\\,u(L)\\,Y_k(L)-J_k(L)$, both in kilograms per square meter per second. Numerically evaluate $-\\int_0^L \\dot{\\omega}_k(x)\\,dx$ using the trapezoidal rule. For each species $k\\in\\{\\mathrm{H}_2,\\mathrm{O}_2,\\mathrm{H}_2\\mathrm{O}\\}$, verify whether inflow minus outflow equals the net consumption/production to within a numerical tolerance.\n\nUnits: All fluxes must be in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, diffusivities in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, density in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and velocity in $\\mathrm{m}\\,\\mathrm{s}^{-1}$. Angles are not used. The numerical verification output must be boolean values.\n\nTest Suite: Implement the following three cases. In each case, the molar reaction rate is a Gaussian profile\n$$\nr(x) = r_0\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\,\\sigma^2}\\right),\n$$\nwith specified parameters.\n\n- Case $1$ (baseline, steady uniform flow):\n  - $L = 0.020$ $\\mathrm{m}$, $N = 401$ grid points, $\\rho = 1.000$ $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n  - $u(x) = 0.050$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$ (constant).\n  - $D_{\\mathrm{H}_2} = 7.0\\times 10^{-5}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $D_{\\mathrm{O}_2} = 3.0\\times 10^{-5}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $D_{\\mathrm{H}_2\\mathrm{O}} = 4.0\\times 10^{-5}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n  - $Y_{\\mathrm{H}_2,\\text{in}} = 0.080$, $Y_{\\mathrm{O}_2,\\text{in}} = 0.200$, $Y_{\\mathrm{H}_2\\mathrm{O},\\text{in}} = 0.000$.\n  - $r_0 = 15.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $x_0 = 0.010$ $\\mathrm{m}$, $\\sigma = 0.002$ $\\mathrm{m}$.\n\n- Case $2$ (edge case, no reaction):\n  - Same $L$, $N$, $\\rho$, $u(x)$, $D_k$, and $Y_{k,\\text{in}}$ as Case $1$.\n  - $r_0 = 0.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $x_0 = 0.010$ $\\mathrm{m}$, $\\sigma = 0.002$ $\\mathrm{m}$.\n\n- Case $3$ (variable velocity and diffusivities):\n  - $L = 0.015$ $\\mathrm{m}$, $N = 301$ grid points, $\\rho = 1.100$ $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n  - $u(x) = 0.040 + 0.040\\,x/L$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$ (linearly increasing).\n  - $D_{\\mathrm{H}_2} = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $D_{\\mathrm{O}_2} = 4.0\\times 10^{-5}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $D_{\\mathrm{H}_2\\mathrm{O}} = 5.0\\times 10^{-5}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n  - $Y_{\\mathrm{H}_2,\\text{in}} = 0.060$, $Y_{\\mathrm{O}_2,\\text{in}} = 0.220$, $Y_{\\mathrm{H}_2\\mathrm{O},\\text{in}} = 0.000$.\n  - $r_0 = 20.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $x_0 = 0.012$ $\\mathrm{m}$, $\\sigma = 0.0015$ $\\mathrm{m}$.\n\nFor each case and each species, compute a boolean indicating whether\n$$\n\\left(\\rho\\,u(0)\\,Y_k(0) - J_k(0)\\right) - \\left(\\rho\\,u(L)\\,Y_k(L) - J_k(L)\\right)\n$$\nequals\n$$\n-\\int_0^L \\dot{\\omega}_k(x)\\,dx\n$$\nwithin a tolerance of relative error $10^{-6}$ and absolute error $10^{-9}$ in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\text{Case }1:\\ \\mathrm{H}_2,\\ \\mathrm{O}_2,\\ \\mathrm{H}_2\\mathrm{O},\\ \\text{Case }2:\\ \\mathrm{H}_2,\\ \\mathrm{O}_2,\\ \\mathrm{H}_2\\mathrm{O},\\ \\text{Case }3:\\ \\mathrm{H}_2,\\ \\mathrm{O}_2,\\ \\mathrm{H}_2\\mathrm{O}],\n$$\nfor example, $[{\\tt True},{\\tt False},\\dots]$.",
            "solution": "The problem statement is valid. It presents a scientifically grounded and well-posed boundary value problem from the field of computational combustion. All necessary data and conditions are provided, and no contradictions or ambiguities are present. The task is to numerically solve a set of linear ordinary differential equations and verify that the numerical solution satisfies the integral form of the original conservation law, which is a standard verification procedure in numerical analysis.\n\nThe core of the problem is to solve the steady, one-dimensional species transport equation for each species $k \\in \\{\\mathrm{H}_2, \\mathrm{O}_2, \\mathrm{H}_2\\mathrm{O}\\}$. By substituting the Fickian diffusion law $J_k(x) = -\\rho D_k \\frac{dY_k}{dx}$ into the general conservation equation, we obtain a second-order linear ordinary differential equation (ODE) for the mass fraction $Y_k(x)$:\n$$\n\\rho D_k \\frac{d^2 Y_k}{dx^2} + \\rho u(x) \\frac{d Y_k}{dx} = \\dot{\\omega}_k(x)\n$$\nThis ODE is a boundary value problem (BVP) on the domain $x \\in [0, L]$, subject to the boundary conditions:\n$$\nY_k(0) = Y_{k,\\text{in}} \\quad (\\text{Dirichlet inlet})\n$$\n$$\n\\frac{dY_k}{dx}(L) = 0 \\quad (\\text{Neumann outlet})\n$$\n\nTo solve this BVP numerically, we employ the finite difference method on a uniform grid of $N$ points $x_i = i \\cdot \\Delta x$ for $i=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L/(N-1)$. Let $Y_{k,i}$ be the numerical approximation of $Y_k(x_i)$.\n\nAt an interior grid point $x_i$ (for $i=1, \\dots, N-2$), the first and second derivatives are approximated using second-order central difference schemes:\n$$\n\\frac{dY_k}{dx}\\bigg|_{x_i} \\approx \\frac{Y_{k,i+1} - Y_{k,i-1}}{2\\Delta x}\n$$\n$$\n\\frac{d^2 Y_k}{dx^2}\\bigg|_{x_i} \\approx \\frac{Y_{k,i+1} - 2Y_{k,i} + Y_{k,i-1}}{(\\Delta x)^2}\n$$\nSubstituting these into the governing ODE yields a linear algebraic equation at each interior point:\n$$\n\\rho D_k \\left( \\frac{Y_{k,i+1} - 2Y_{k,i} + Y_{k,i-1}}{(\\Delta x)^2} \\right) + \\rho u(x_i) \\left( \\frac{Y_{k,i+1} - Y_{k,i-1}}{2\\Delta x} \\right) = \\dot{\\omega}_k(x_i)\n$$\nRearranging terms for the unknowns $Y_{k,i-1}, Y_{k,i}, Y_{k,i+1}$:\n$$\n\\left( \\frac{\\rho D_k}{(\\Delta x)^2} - \\frac{\\rho u_i}{2\\Delta x} \\right) Y_{k,i-1} + \\left( -\\frac{2\\rho D_k}{(\\Delta x)^2} \\right) Y_{k,i} + \\left( \\frac{\\rho D_k}{(\\Delta x)^2} + \\frac{\\rho u_i}{2\\Delta x} \\right) Y_{k,i+1} = \\dot{\\omega}_{k,i}\n$$\n\nThe boundary conditions are handled as follows:\n1.  **Inlet at $x_0=0$:** The Dirichlet condition $Y_k(0) = Y_{k,\\text{in}}$ directly sets the value $Y_{k,0}$. This value becomes a known quantity in the equation for the first interior point, $i=1$.\n2.  **Outlet at $x_{N-1}=L$:** The Neumann condition $\\frac{dY_k}{dx}(L)=0$ is implemented using a \"ghost point\" $x_N = L+\\Delta x$ to maintain second-order accuracy. A central difference centered at $x_{N-1}$ gives $\\frac{Y_{k,N} - Y_{k,N-2}}{2\\Delta x} = 0$, which implies $Y_{k,N} = Y_{k,N-2}$. The governing ODE is then discretized at $x_{N-1}$, and $Y_{k,N}$ is replaced by $Y_{k,N-2}$. This yields the final equation for the unknown $Y_{k,N-1}$:\n    $$\n    \\left( \\frac{2\\rho D_k}{(\\Delta x)^2} \\right) Y_{k,N-2} - \\left( \\frac{2\\rho D_k}{(\\Delta x)^2} \\right) Y_{k,N-1} = \\dot{\\omega}_{k,N-1}\n    $$\n\nThis process results in a system of $N-1$ linear equations for the $N-1$ unknown mass fractions $Y_{k,1}, \\dots, Y_{k,N-1}$. The system can be written in matrix form $A \\vec{Y}_k = \\vec{b}$, where $A$ is a tridiagonal matrix, and solved using a standard linear algebra solver.\n\nOnce the profile $Y_k(x_i)$ is computed, the numerical verification is performed. We must check if the inflow minus outflow equals the net production:\n$$\n\\underbrace{\\left(\\rho u(0)Y_k(0) - J_k(0)\\right) - \\left(\\rho u(L)Y_k(L) - J_k(L)\\right)}_{\\text{LHS}} = \\underbrace{-\\int_0^L \\dot{\\omega}_k(x)dx}_{\\text{RHS}}\n$$\nThe two sides are computed numerically:\n-   **RHS:** The integral of the source term is calculated using the trapezoidal rule on the discretized $\\dot{\\omega}_k(x_i)$ profile.\n-   **LHS:** The fluxes at the boundaries are computed. The total flux is $F_k(x) = \\rho u(x) Y_k(x) - J_k(x) = \\rho u(x) Y_k(x) + \\rho D_k \\frac{dY_k}{dx}$.\n    -   At the inlet ($x=0$), the derivative $\\frac{dY_k}{dx}(0)$ is approximated using a second-order accurate forward difference formula: $\\frac{dY_k}{dx}(0) \\approx \\frac{-3Y_{k,0} + 4Y_{k,1} - Y_{k,2}}{2\\Delta x}$.\n    -   At the outlet ($x=L$), the boundary condition states $\\frac{dY_k}{dx}(L)=0$, so the diffusive flux $J_k(L)=0$. The total flux is purely convective: $F_k(L) = \\rho u(L) Y_k(L)$.\n    The LHS is then $F_k(0) - F_k(L)$.\n\nFinally, the equality is checked using the specified relative tolerance $\\epsilon_r = 10^{-6}$ and absolute tolerance $\\epsilon_a = 10^{-9}$ by confirming if $|\\text{LHS} - \\text{RHS}| \\le \\epsilon_a + \\epsilon_r |\\text{RHS}|$. This procedure is applied for each species and each of the three test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the burner-stabilized flame problem and verifies mass conservation.\n    \"\"\"\n\n    def solve_and_verify(case_params):\n        \"\"\"\n        Solves the BVP for a given case and verifies conservation for all species.\n        \"\"\"\n        L = case_params['L']\n        N = case_params['N']\n        rho = case_params['rho']\n        u_params = case_params['u_params']\n        reaction_params = case_params['reaction']\n        species_data = case_params['species_data']\n\n        def u_func(x_coords, length):\n            if u_params['type'] == 'constant':\n                return u_params['val'] * np.ones_like(x_coords)\n            elif u_params['type'] == 'linear':\n                c0, c1_factor = u_params['coeffs']\n                return c0 + c1_factor * x_coords / length\n\n        x = np.linspace(0, L, N)\n        dx = x[1] - x[0]\n        u = u_func(x, L)\n\n        r0, x0, sigma = reaction_params\n        r = r0 * np.exp(-(x - x0)**2 / (2 * sigma**2))\n\n        results_case = []\n        for species_name in ['H2', 'O2', 'H2O']:\n            Dk, Yk_in, Wk, nu_k = species_data[species_name]\n            \n            omega_k = nu_k * Wk * r\n\n            # Assemble the linear system A*y = b for unknowns y = [Y_1, ..., Y_{N-1}]\n            M = N - 1\n            A = np.zeros((M, M))\n            b = np.zeros(M)\n            \n            # Equations for interior points i = 1, ..., N-2\n            # These correspond to matrix rows j = 0, ..., N-3\n            for i in range(1, N - 1):\n                j = i - 1  # Matrix row index\n                \n                # Check for variable u\n                u_i = u[i] if isinstance(u, np.ndarray) else u\n                \n                c_low = rho * Dk / dx**2 - rho * u_i / (2 * dx)\n                c_diag = -2 * rho * Dk / dx**2\n                c_high = rho * Dk / dx**2 + rho * u_i / (2 * dx)\n\n                b[j] = omega_k[i]\n                \n                if i == 1: # First row, j=0\n                    A[j, j] = c_diag\n                    A[j, j + 1] = c_high\n                    b[j] -= c_low * Yk_in\n                else: # Interior rows\n                    A[j, j - 1] = c_low\n                    A[j, j] = c_diag\n                    A[j, j + 1] = c_high\n\n            # Equation for outlet point i=N-1 (matrix row j=N-2)\n            # Implements dY/dx=0 using a ghost point and central difference at i=N-1\n            # giving rho*Dk*(Y_{N-2}-2Y_{N-1}+Y_N)/dx^2 + rho*u_{N-1}*(Y_N-Y_{N-2})/(2*dx) = omega_{N-1}\n            # with Y_N = Y_{N-2} from dY/dx=0\n            # rho*Dk*(2*Y_{N-2}-2Y_{N-1})/dx^2 = omega_{N-1}\n            j = N - 2\n            A[j, j - 1] = 2 * rho * Dk / dx**2\n            A[j, j] = -2 * rho * Dk / dx**2\n            b[j] = omega_k[N-1]\n            \n            # Solve for unknown Y values\n            Y_unknowns = np.linalg.solve(A, b)\n            Yk = np.concatenate(([Yk_in], Y_unknowns))\n\n            # Perform verification\n            # RHS: - integral(omega_k) dx\n            rhs = -np.trapz(omega_k, x)\n\n            # LHS: (inflow flux) - (outflow flux)\n            # Flux F_k = rho*u*Y_k - J_k = rho*u*Y_k + rho*D_k*dY_k/dx\n            \n            # Inlet flux at x=0\n            # Use 2nd-order forward difference for dYk/dx(0)\n            dYdx_0 = (-3 * Yk[0] + 4 * Yk[1] - Yk[2]) / (2 * dx)\n            u_0 = u[0] if isinstance(u, np.ndarray) else u\n            flux_in = rho * u_0 * Yk[0] + rho * Dk * dYdx_0\n\n            # Outlet flux at x=L\n            # dYk/dx(L) = 0, so J_k(L) = 0\n            u_L = u[-1] if isinstance(u, np.ndarray) else u\n            flux_out = rho * u_L * Yk[-1]\n            \n            lhs = flux_in - flux_out\n\n            # Check for conservation within tolerances\n            atol = 1e-9\n            rtol = 1e-6\n            is_conserved = np.isclose(lhs, rhs, rtol=rtol, atol=atol)\n            results_case.append(is_conserved.item())\n            \n        return results_case\n\n    # Molar masses in kg/mol\n    W_H2 = 0.002\n    W_O2 = 0.032\n    W_H2O = 0.018\n\n    # --- Test Case 1 ---\n    case1 = {\n        'L': 0.020, 'N': 401, 'rho': 1.000,\n        'u_params': {'type': 'constant', 'val': 0.050},\n        'reaction': (15.0, 0.010, 0.002),\n        'species_data': {\n            'H2':  (7.0e-5, 0.080, W_H2, -1.0),\n            'O2':  (3.0e-5, 0.200, W_O2, -0.5),\n            'H2O': (4.0e-5, 0.000, W_H2O, 1.0)\n        }\n    }\n    \n    # --- Test Case 2 ---\n    case2 = {\n        'L': 0.020, 'N': 401, 'rho': 1.000,\n        'u_params': {'type': 'constant', 'val': 0.050},\n        'reaction': (0.0, 0.010, 0.002),\n        'species_data': {\n            'H2':  (7.0e-5, 0.080, W_H2, -1.0),\n            'O2':  (3.0e-5, 0.200, W_O2, -0.5),\n            'H2O': (4.0e-5, 0.000, W_H2O, 1.0)\n        }\n    }\n\n    # --- Test Case 3 ---\n    case3 = {\n        'L': 0.015, 'N': 301, 'rho': 1.100,\n        'u_params': {'type': 'linear', 'coeffs': (0.040, 0.040)},\n        'reaction': (20.0, 0.012, 0.0015),\n        'species_data': {\n            'H2':  (1.0e-4, 0.060, W_H2, -1.0),\n            'O2':  (4.0e-5, 0.220, W_O2, -0.5),\n            'H2O': (5.0e-5, 0.000, W_H2O, 1.0)\n        }\n    }\n\n    all_results = []\n    all_results.extend(solve_and_verify(case1))\n    all_results.extend(solve_and_verify(case2))\n    all_results.extend(solve_and_verify(case3))\n    \n    # Format the final output string exactly as requested\n    output_str = f\"[{','.join(str(r).capitalize() for r in all_results)}]\"\n    print(output_str.replace(\"True\", \"True\").replace(\"False\", \"False\"))\n\nsolve()\n```"
        }
    ]
}