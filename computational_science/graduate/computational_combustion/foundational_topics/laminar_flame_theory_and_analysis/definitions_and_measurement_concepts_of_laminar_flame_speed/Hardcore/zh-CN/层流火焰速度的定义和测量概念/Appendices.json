{
    "hands_on_practices": [
        {
            "introduction": "确定无拉伸层流燃烧速率 $S_L^0$ 是燃烧研究中的一项基本任务。外向传播的球形火焰是一种经典的实验方法，但这种火焰本质上是存在拉伸的。本练习将通过处理模拟的实验数据，为您提供第一手实践经验，学习如何校正系统偏差并应用基本的线性外推法来消除火焰拉伸的影响，从而获得固有的火焰特性 $S_L^0$ 。",
            "id": "4016490",
            "problem": "一个恒压燃烧容器被用于记录在环境条件下，预混氢气-空气混合物中向外传播的球形火焰锋面。零拉伸层流燃烧速度，记为 $S_{L}^{0}$，定义为未拉伸的平面火焰相对于未燃混合物的法向传播速度。实验采用高速成像技术，曝光时间为 $T_{\\text{exp}} = 0.2\\,\\text{ms}$，每个记录的时间戳对应于曝光的开始时刻。由于一个已知的校准问题，测量的半径被一个0.3%的乘性尺度偏差放大了；将此偏差视为一个必须校正的确定性因素。\n\n三帧图像给出了原始的火焰半径和时间戳：\n- $t_{1} = 1.2\\,\\text{ms}$，$r_{\\text{raw},1} = 12.35\\,\\text{mm}$，\n- $t_{2} = 1.6\\,\\text{ms}$，$r_{\\text{raw},2} = 14.21\\,\\text{mm}$，\n- $t_{3} = 2.0\\,\\text{ms}$，$r_{\\text{raw},3} = 16.02\\,\\text{mm}$。\n\n假设每帧记录的锋面位置对应于曝光时间的中点 $t_{i} + T_{\\text{exp}}/2$。将每个相邻区间中点的位移速度视为近似恒定。火焰拉伸率由基于面积的运动学关系 $\\kappa \\equiv (1/A)\\,\\mathrm{d}A/\\mathrm{d}t$ 定义，对于半径为 $r$ 的球形锋面，其面积为 $A = 4\\pi r^{2}$。局部法向位移速度为 $S_{d} \\equiv \\mathrm{d}r/\\mathrm{d}t$。在零拉伸附近，将 $S_{d}$ 对 $\\kappa$ 的依赖关系建模为 $\\kappa$ 的一阶关系，并使用线性外推法，从非零 $\\kappa$ 的测量值得到 $\\kappa = 0$ 时的 $S_{L}^{0}$。\n\n任务：\n1. 针对已知的0.3%尺度偏差校正半径。\n2. 使用相邻的数据对 $(t_{1},r_{1})$ 和 $(t_{2},r_{2})$，以及 $(t_{2},r_{2})$ 和 $(t_{3},r_{3})$，计算两个中点数据对 $\\big(\\kappa, S_{d}\\big)$。其中，$S_{d}$ 由 $r$ 在相应时间差上的有限差分近似得到，而 $\\kappa$ 由定义 $\\kappa = (1/A)\\,\\mathrm{d}A/\\mathrm{d}t$（其中 $A = 4\\pi r^{2}$）得出，计算时使用中点半径和相同的有限差分 $\\mathrm{d}r/\\mathrm{d}t$。\n3. 对 $S_{d}$ 与 $\\kappa$ 的关系进行线性外推至 $\\kappa = 0$，以确定 $S_{L}^{0}$。\n\n将 $S_{L}^{0}$ 的最终值以 $\\text{m}\\,\\text{s}^{-1}$ 为单位表示，并将答案四舍五入到三位有效数字。对于中心估计值，忽略随机不确定性，但要精确地考虑所述的确定性偏差校正。",
            "solution": "该问题要求根据球形传播火焰的实验数据确定未拉伸层流燃烧速度 $S_{L}^{0}$。这涉及到校正原始数据，计算两个时间间隔内的位移速度 $S_{d}$ 和拉伸率 $\\kappa$，然后将 $S_{d}$ 对 $\\kappa$ 的关系线性外推到未拉伸条件 $\\kappa=0$。\n\n首先，我们整理给定的参数和数据：\n-   曝光时间：$T_{\\text{exp}} = 0.2\\,\\text{ms} = 2 \\times 10^{-4}\\,\\text{s}$。\n-   乘性尺度偏差：0.3%的放大，对应于因子 $1 + 0.003 = 1.003$。\n-   原始数据点 $(t_{i}, r_{\\text{raw},i})$：\n    -   $t_{1} = 1.2\\,\\text{ms}$，$r_{\\text{raw},1} = 12.35\\,\\text{mm}$\n    -   $t_{2} = 1.6\\,\\text{ms}$，$r_{\\text{raw},2} = 14.21\\,\\text{mm}$\n    -   $t_{3} = 2.0\\,\\text{ms}$，$r_{\\text{raw},3} = 16.02\\,\\text{mm}$\n\n解题过程如问题陈述中所述，分为三个步骤。\n\n**步骤1：数据校正**\n\n我们必须同时校正时间戳和测量的半径。\n每次测量的有效时间对应于曝光间隔的中点。校正后的时间 $t'_{i}$ 由下式给出：\n$$t'_{i} = t_{i} + \\frac{T_{\\text{exp}}}{2}$$\n由于 $T_{\\text{exp}} = 0.2\\,\\text{ms}$，时间校正量为 $0.1\\,\\text{ms}$。\n$$t'_{1} = 1.2\\,\\text{ms} + 0.1\\,\\text{ms} = 1.3\\,\\text{ms}$$\n$$t'_{2} = 1.6\\,\\text{ms} + 0.1\\,\\text{ms} = 1.7\\,\\text{ms}$$\n$$t'_{3} = 2.0\\,\\text{ms} + 0.1\\,\\text{ms} = 2.1\\,\\text{ms}$$\n\n原始半径 $r_{\\text{raw},i}$ 被放大了0.3%。真实半径 $r_i$ 通过将原始半径除以偏差因子 $1.003$ 得到。\n$$r_{i} = \\frac{r_{\\text{raw},i}}{1.003}$$\n$$r_{1} = \\frac{12.35\\,\\text{mm}}{1.003}$$\n$$r_{2} = \\frac{14.21\\,\\text{mm}}{1.003}$$\n$$r_{3} = \\frac{16.02\\,\\text{mm}}{1.003}$$\n在中间计算中，为避免过早的舍入误差，审慎的做法是保留这些值的分数形式。\n\n**步骤2：计算中点数据对 $(\\kappa, S_{d})$**\n\n我们计算两对 $(\\kappa, S_{d})$，一对用于区间 $(t'_{1}, r_{1})$ 和 $(t'_{2}, r_{2})$ 之间，另一对用于区间 $(t'_{2}, r_{2})$ 和 $(t'_{3}, r_{3})$ 之间。\n\n对于第一个区间（用下标 $12$ 表示）：\n时间差为 $\\Delta t_{12} = t'_{2} - t'_{1} = 1.7\\,\\text{ms} - 1.3\\,\\text{ms} = 0.4\\,\\text{ms}$。\n位移速度 $S_{d,12}$ 通过有限差分近似为：\n$$S_{d,12} = \\frac{r_{2} - r_{1}}{\\Delta t_{12}} = \\frac{(14.21 - 12.35)/1.003\\,\\text{mm}}{0.4\\,\\text{ms}} = \\frac{1.86/1.003}{0.4}\\,\\frac{\\text{mm}}{\\text{ms}} = \\frac{1.86}{0.4012}\\,\\frac{\\text{m}}{\\text{s}} \\approx 4.63609\\,\\frac{\\text{m}}{\\text{s}}$$\n注意，单位 $\\text{mm}/\\text{ms}$ 在数值上等同于 $\\text{m}/\\text{s}$。\n\n球形火焰的拉伸率为 $\\kappa = (1/A)(\\mathrm{d}A/\\mathrm{d}t)$。当 $A = 4\\pi r^2$ 时，该式变为 $\\kappa = (1/(4\\pi r^2))(8\\pi r (\\mathrm{d}r/\\mathrm{d}t)) = (2/r)(\\mathrm{d}r/\\mathrm{d}t)$。我们使用中点半径和有限差分速度来计算这个值。\n中点半径为 $r_{12} = (r_{1}+r_{2})/2$。\n$$r_{12} = \\frac{(12.35 + 14.21)/1.003}{2}\\,\\text{mm} = \\frac{26.56}{2.006}\\,\\text{mm}$$\n拉伸率为 $\\kappa_{12}$：\n$$\\kappa_{12} = \\frac{2 S_{d,12}}{r_{12}} = \\frac{2 \\cdot \\frac{r_2-r_1}{\\Delta t_{12}}}{\\frac{r_1+r_2}{2}} = \\frac{4(r_2-r_1)}{\\Delta t_{12}(r_1+r_2)}$$\n将 $r_i$ 用 $r_{\\text{raw},i}$ 的表达式代入：\n$$\\kappa_{12} = \\frac{4(r_{\\text{raw},2} - r_{\\text{raw},1})/1.003}{\\Delta t_{12}(r_{\\text{raw},1} + r_{\\text{raw},2})/1.003} = \\frac{4(r_{\\text{raw},2} - r_{\\text{raw},1})}{\\Delta t_{12}(r_{\\text{raw},1} + r_{\\text{raw},2})}$$\n对于 $\\kappa$ 的计算，偏差校正项相互抵消。\n$$\\kappa_{12} = \\frac{4(14.21 - 12.35)\\,\\text{mm}}{0.4\\,\\text{ms} \\cdot (12.35 + 14.21)\\,\\text{mm}} = \\frac{4(1.86)}{0.4(26.56)}\\,\\text{ms}^{-1} = \\frac{7.44}{10.624}\\,\\text{ms}^{-1} \\approx 0.70030\\,\\text{ms}^{-1}$$\n转换为国际单位制（SI），$\\kappa_{12} \\approx 700.30\\,\\text{s}^{-1}$。\n\n对于第二个区间（用下标 $23$ 表示）：\n时间差为 $\\Delta t_{23} = t'_{3} - t'_{2} = 2.1\\,\\text{ms} - 1.7\\,\\text{ms} = 0.4\\,\\text{ms}$。\n位移速度 $S_{d,23}$ 为：\n$$S_{d,23} = \\frac{r_{3} - r_{2}}{\\Delta t_{23}} = \\frac{(16.02 - 14.21)/1.003\\,\\text{mm}}{0.4\\,\\text{ms}} = \\frac{1.81/1.003}{0.4}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{1.81}{0.4012}\\,\\frac{\\text{m}}{\\text{s}} \\approx 4.51147\\,\\frac{\\text{m}}{\\text{s}}$$\n拉伸率 $\\kappa_{23}$ 为：\n$$\\kappa_{23} = \\frac{4(r_{\\text{raw},3} - r_{\\text{raw},2})}{\\Delta t_{23}(r_{\\text{raw},2} + r_{\\text{raw},3})} = \\frac{4(16.02 - 14.21)\\,\\text{mm}}{0.4\\,\\text{ms} \\cdot (14.21 + 16.02)\\,\\text{mm}} = \\frac{4(1.81)}{0.4(30.23)}\\,\\text{ms}^{-1} = \\frac{7.24}{12.092}\\,\\text{ms}^{-1} \\approx 0.59874\\,\\text{ms}^{-1}$$\n转换为国际单位制（SI），$\\kappa_{23} \\approx 598.74\\,\\text{s}^{-1}$。\n\n因此我们得到两个点 $(\\kappa, S_d)$：\n点 A：$(\\kappa_A, S_{d,A}) = (700.30\\,\\text{s}^{-1}, 4.63609\\,\\text{m/s})$\n点 B：$(\\kappa_B, S_{d,B}) = (598.74\\,\\text{s}^{-1}, 4.51147\\,\\text{m/s})$\n\n**步骤3：线性外推至 $\\kappa=0$**\n\n我们将 $S_d$ 和 $\\kappa$ 之间的关系建模为线性关系：$S_d(\\kappa) = m\\kappa + c$。未拉伸层流燃烧速度 $S_L^0$ 是 $S_d$ 在 $\\kappa=0$ 时的值，即截距 $c$。\n给定两点 $(\\kappa_A, S_{d,A})$ 和 $(\\kappa_B, S_{d,B})$，经过这两点的直线的截距 $S_L^0$ 由下式给出：\n$$S_{L}^{0} = \\frac{S_{d,B}\\kappa_A - S_{d,A}\\kappa_B}{\\kappa_A - \\kappa_B}$$\n代入计算出的值：\n$$S_{L}^{0} = \\frac{(4.51147\\,\\text{m/s})(700.30\\,\\text{s}^{-1}) - (4.63609\\,\\text{m/s})(598.74\\,\\text{s}^{-1})}{700.30\\,\\text{s}^{-1} - 598.74\\,\\text{s}^{-1}}$$\n$$S_{L}^{0} = \\frac{3159.40 - 2775.83}{101.56}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{383.57}{101.56}\\,\\frac{\\text{m}}{\\text{s}} \\approx 3.7767\\,\\frac{\\text{m}}{\\text{s}}$$\n使用未舍入的中间值进行更精确的计算可得：\n$\\kappa_A = 700.3011... \\,\\text{s}^{-1}$\n$\\kappa_B = 598.7429... \\,\\text{s}^{-1}$\n$S_{d,A} = 4.6360917... \\,\\text{m/s}$\n$S_{d,B} = 4.5114656... \\,\\text{m/s}$\n$$S_{L}^{0} = \\frac{(4.5114656)(700.3011) - (4.6360917)(598.7429)}{700.3011 - 598.7429}\\,\\frac{\\text{m}}{\\text{s}}$$\n$$S_{L}^{0} = \\frac{3159.400 - 2775.833}{101.5582}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{383.567}{101.5582}\\,\\frac{\\text{m}}{\\text{s}} \\approx 3.77666\\,\\frac{\\text{m}}{\\text{s}}$$\n问题要求最终答案四舍五入到三位有效数字。\n$$S_{L}^{0} \\approx 3.78\\,\\frac{\\text{m}}{\\text{s}}$$",
            "answer": "$$\n\\boxed{3.78}\n$$"
        },
        {
            "introduction": "除了 $S_L^0$ 本身，量化火焰对拉伸的敏感性也至关重要，该特性由马克斯坦长度 $L_M$ 表征。对冲流火焰是施加精确控制的应变率以测量此敏感性的标准配置。本练习要求您批判性地评估几种用于测量 $L_M$ 的数值程序，旨在锻炼您在实验和计算设计中辨别严谨科学方法与有缺陷近似法的关键能力 。",
            "id": "4077909",
            "problem": "要求您采用计算对冲流配置，并遵循 Zeldovich–Frank-Kamenetskii 预混火焰理论，来确定层流预混火焰的马克斯坦长度 $L_M$。考虑一个气态、单步反应混合物的轴对称双射流对冲流，该混合物处于恒定的环境压力下，两侧入口的温度、组分和密度均相等。在合适的入口速度下，流场会在两入口之间大致中点处形成一个驻点平面，并在该平面附近形成一个平面预混火焰。假设混合物的路易斯数为1，并且模拟在绝热、无辐射条件下进行，同时采用详细的输运和化学反应模型。\n\n您的推理必须且只能基于以下基本原理：质量、组分和能量守恒；层流燃烧速度 $S_L$ 的定义，即火焰相对于未燃混合物的法向传播速度；物质表面的火焰拉伸率 $\\kappa$ 的定义，即 $\\kappa = \\frac{1}{A} \\frac{\\mathrm{d}A}{\\mathrm{d}t}$，等效地，$\\kappa = \\nabla_s \\cdot \\mathbf{u}_t$，其中 $\\nabla_s$ 是表面散度，$\\mathbf{u}_t$ 是沿火焰表面的速度切向分量；以及消耗速度 $S_c$ 的定义，该定义通过对火焰区域内的单位体积燃料消耗率进行积分，并用上游燃料质量分数和密度进行归一化，从组分守恒中获得。除了这些定义和守恒定律，您不得引用或假设任何简化公式。\n\n您的目标是通过在对冲流中施加可控的流体动力学应变，并在曲率效应可忽略（平面火焰）且不发生熄火的弱拉伸区内，拟合响应 $S_L(\\kappa)$ 来提取 $L_M$。以下哪种数值程序与此目标一致，并且能够得出科学上合理且无偏的 $L_M$ 估计值？\n\nA. 对于一组 $N \\geq 5$ 个稳态模拟，通过调整相等的入口速度来改变施加的对冲流应变，以覆盖一个小范围的应变率 $a$，使得火焰保持平面且不熄火。对于每种情况，通过在热释放峰值位置的未燃侧计算 $\\kappa = \\left(\\mathbf{I} - \\mathbf{n}\\mathbf{n}\\right) : \\nabla \\mathbf{u}$ 来计算火焰处的局部火焰拉伸率 $\\kappa$，其中 $\\mathbf{n}$ 是火焰的单位法向量，$\\nabla \\mathbf{u}$ 是速度梯度张量；验证曲率可以忽略，从而 $\\kappa \\approx a$。使用消耗速度的定义 $S_c = \\frac{1}{\\rho_u Y_{F,u}} \\int \\dot{\\omega}_F \\,\\mathrm{d}s_n$ 计算层流燃烧速度 $S_L$，其中 $\\rho_u$ 和 $Y_{F,u}$ 分别是上游未燃混合物的密度和燃料质量分数，$\\dot{\\omega}_F$ 是单位体积的燃料消耗率，$\\mathrm{d}s_n$ 沿火焰法向坐标积分。在可证明为线性的最小应变子集上拟合 $S_L(\\kappa)$（通过残差分析和排除具有明显预熄火曲率的案例来检查），并从最佳拟合线的斜率中确定 $L_M$。报告由网格和计算域加密以及拟合统计数据产生的不确定性。\n\nB. 保持入口组分和温度固定，对于 $M \\geq 3$ 种情况，仅改变入口速度 $U_{\\text{in}}$。将拉伸率估计为 $\\kappa \\approx U_{\\text{in}}/\\delta_L$，其中 $\\delta_L$ 是通过独立的的一维自由火焰计算测得的未拉伸火焰厚度。将 $S_L$ 计算为质量通量归一化的入口速度，$S_L \\approx U_{\\text{in}}$，因为火焰近似为平面。在直到接近熄火的整个 $\\kappa$ 范围内拟合 $S_L$ 与 $\\kappa$ 的关系以增加动态范围，并从斜率中获取 $L_M$。\n\nC. 在 $K \\geq 4$ 次模拟中，改变应变并记录由最大温度梯度位置定义的火焰轴向位置 $x_f$。由于较高的应变会将火焰对流到更靠近驻点平面的位置，因此拟合 $x_f$ 与施加的应变率 $a$ 的关系，并以 $\\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$ 作为 $L_M$，其单位是长度，因此直接代表马克斯坦长度。\n\nD. 使用中等应变下的单次高分辨率模拟，计算温度梯度大小的空间最大值 $\\max |\\nabla T|$，并使用比率 $S_L \\approx \\alpha \\, \\max |\\nabla T|$ 来近似燃烧速度，其中 $\\alpha$ 是未燃混合物的热扩散系数。然后轻微扰动应变，重新计算 $S_L$，并从 $S_L$ 对 $\\kappa$ 的有限差分斜率中获得 $L_M$。\n\nE. 对于一系列模拟，在驻点平面处测量应变率 $a = \\left.\\frac{\\partial u_x}{\\partial x}\\right|_{x=0}$，该测量与火焰位置无关。假设射流相等且对冲，且可压缩性效应可忽略，将 $S_L$ 计算为入口质量通量除以上游密度，$S_L \\approx \\frac{\\dot{m}_{\\text{in}}}{\\rho_u A}$。在包括非线性和近熄火区在内的宽范围内拟合 $S_L$ 与 $a$ 的关系，以从斜率中估计 $L_M$。\n\n选择唯一最佳选项。",
            "solution": "对问题陈述进行严格评估如下。\n\n### 第 1 步：提取已知条件\n- **物理系统：** 层流预混火焰。\n- **配置：** 气态、单步反应混合物的轴对称双射流对冲流的计算模拟。\n- **边界和初始条件：** 恒定环境压力；两个射流的入口温度、组分和密度均相等。\n- **产生的流场：** 在两入口之间中点附近形成一个驻点平面；在驻点平面附近形成一个平面预混火焰。\n- **混合物性质：** 路易斯数为1。\n- **模拟条件：** 绝热、无辐射，采用详细的输运和化学反应模型。\n- **基本原理：** 质量、组分和能量守恒。\n- **核心定义：**\n    1.  层流燃烧速度 $S_L$：火焰相对于未燃混合物的法向传播速度。\n    2.  火焰拉伸率 $\\kappa$：$\\kappa = \\frac{1}{A} \\frac{\\mathrm{d}A}{\\mathrm{d}t}$，其中 $A$ 是火焰表面积；等效地，$\\kappa = \\nabla_s \\cdot \\mathbf{u}_t$，其中 $\\nabla_s$ 是表面散度，$\\mathbf{u}_t$ 是沿火焰表面的速度切向分量。\n    3.  消耗速度 $S_c$：$S_c = \\frac{1}{\\rho_u Y_{F,u}} \\int \\dot{\\omega}_F \\,\\mathrm{d}s_n$，其中 $\\rho_u$ 和 $Y_{F,u}$ 分别是上游密度和燃料质量分数，$\\dot{\\omega}_F$ 是单位体积燃料消耗率，积分沿火焰法向坐标 $s_n$ 进行。\n- **目标：** 通过拟合层流燃烧速度 $S_L$ 对拉伸率 $\\kappa$ 的响应，即 $S_L(\\kappa)$，在曲率效应可忽略的弱拉伸区内确定马克斯坦长度 $L_M$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础：** 该问题牢固地植根于燃烧理论领域，特别是 Zeldovich–Frank-Kamenetskii (ZFK) 理论。使用对冲流配置研究拉伸火焰是一种标准且经过充分验证的实验和计算技术。所有提供的关于 $S_L$、$\\kappa$ 和 $S_c$ 的定义都是该领域的标准定义。该设置在科学上是合理的。\n- **适定性：** 问题是适定的。它要求找到从标准计算实验中确定一个明确定义的物理量 ($L_M$) 的正确程序。$S_L$ 和 $\\kappa$ 之间的关系为这种确定提供了清晰的基础。\n- **客观性：** 语言技术性强、精确，没有主观或含糊的陈述。\n- **结论：** 问题陈述未违反任何无效标准。它是科学上合理的、适定的、客观的、完整的和相关的。\n\n### 第 3 步：结论和行动\n问题陈述是有效的。将通过对照燃烧科学和数值方法的既定原则来分析所提出的程序，从而得出解决方案。\n\n确定马克斯坦长度 $L_M$ 的基本依据是从渐近火焰理论推导出的适用于弱拉伸区的线性关系：\n$$ S_L - S_L^0 = -L_M \\kappa $$\n其中 $S_L^0$ 是相应的未拉伸（$\\kappa = 0$）、平面火焰的层流燃烧速度。该方程表明，$L_M$ 与 $S_L$ 对 $\\kappa$ 曲线在 $\\kappa \\to 0$ 极限下的斜率的负值有关。因此，一个稳健的数值程序必须能够从一系列模拟中准确确定 $S_L$ 和 $\\kappa$，并执行适当的线性回归。\n\n### 逐项分析\n\n**A. 对于一组 $N \\geq 5$ 个稳态模拟，通过调整相等的入口速度来改变施加的对冲流应变，以覆盖一个小范围的应变率 $a$，使得火焰保持平面且不熄火。对于每种情况，通过在热释放峰值位置的未燃侧计算 $\\kappa = \\left(\\mathbf{I} - \\mathbf{n}\\mathbf{n}\\right) : \\nabla \\mathbf{u}$ 来计算火焰处的局部火焰拉伸率 $\\kappa$，其中 $\\mathbf{n}$ 是火焰的单位法向量，$\\nabla \\mathbf{u}$ 是速度梯度张量；验证曲率可以忽略，从而 $\\kappa \\approx a$。使用消耗速度的定义 $S_c = \\frac{1}{\\rho_u Y_{F,u}} \\int \\dot{\\omega}_F \\,\\mathrm{d}s_n$ 计算层流燃烧速度 $S_L$，其中 $\\rho_u$ 和 $Y_{F,u}$ 分别是上游未燃混合物的密度和燃料质量分数，$\\dot{\\omega}_F$ 是单位体积的燃料消耗率，$\\mathrm{d}s_n$ 沿火焰法向坐标积分。在可证明为线性的最小应变子集上拟合 $S_L(\\kappa)$（通过残差分析和排除具有明显预熄火曲率的案例来检查），并从最佳拟合线的斜率中确定 $L_M$。报告由网格和计算域加密以及拟合统计数据产生的不确定性。**\n\n该选项概述了一个方法论上无可挑剔的程序。\n1.  **改变应变和数据集：** 通过改变入口速度执行 $N \\geq 5$ 次模拟是生成数据集 $\\{(\\kappa_i, S_{L,i})\\}$ 的正确方法。保持在一个小的、不熄火的范围内，正确地针对了弱拉伸区。\n2.  **测量拉伸率 $\\kappa$：** 公式 $\\kappa = (\\mathbf{I} - \\mathbf{n}\\mathbf{n}) : \\nabla \\mathbf{u}$ 是表面上切向应变率的严格、坐标无关的定义。在火焰的未燃侧进行评估在理论上是正确的，因为火焰响应的是来流中的应变。热释放率峰值是火焰位置的一个标准且稳健的标记。\n3.  **测量燃烧速度 $S_L$：** 消耗速度的定义 $S_c$ 基于积分的组分消耗率，这是一个全局守恒量，因此为火焰的整体强度提供了一个稳健的度量。对于路易斯数为1的火焰，已经确定 $S_c$ 是 $S_L$ 的一个极好替代。这是一种最先进的方法。\n4.  **提取 $L_M$：** 仅在可证明为线性的、小应变子集上拟合 $S_L(\\kappa)$ 是应用线性理论的正确方法。排除非线性的、近熄火的数据至关重要。从该拟合的斜率中确定 $L_M$ 是定义方程的直接应用。\n5.  **不确定性量化：** 承认并报告数值（网格、计算域）和统计（拟合）不确定性是科学有效研究的标志。\n\n结论：**正确**。该选项代表了此类计算测量的黄金标准。\n\n**B. 保持入口组分和温度固定，对于 $M \\geq 3$ 种情况，仅改变入口速度 $U_{\\text{in}}$。将拉伸率估计为 $\\kappa \\approx U_{\\text{in}}/\\delta_L$，其中 $\\delta_L$ 是通过独立的的一维自由火焰计算测得的未拉伸火焰厚度。将 $S_L$ 计算为质量通量归一化的入口速度，$S_L \\approx U_{\\text{in}}$，因为火焰近似为平面。在直到接近熄火的整个 $\\kappa$ 范围内拟合 $S_L$ 与 $\\kappa$ 的关系以增加动态范围，并从斜率中获取 $L_M$。**\n\n该选项包含几个关键缺陷。\n1.  **对 $\\kappa$ 的粗略近似：** 表达式 $\\kappa \\approx U_{\\text{in}}/\\delta_L$ 是一个量纲尺度分析，而不是一个测量值。实际的拉伸率是火焰锋面处流场的局部属性，该近似无法准确捕捉。\n2.  **对 $S_L$ 的不正确近似：** 断言 $S_L \\approx U_{\\text{in}}$ 是根本错误的。在对冲流中，未燃气体在接近驻点平面时会减速。火焰速度 $S_L$ 是相对于其紧邻上游气体的速度，该速度显著小于入口速度 $U_{\\text{in}}$。\n3.  **不正确的拟合范围：** 使用直到熄火的整个 $\\kappa$ 范围是错误的。线性理论仅适用于弱拉伸。包含高度非线性的近熄火数据会破坏线性拟合，并产生一个无意义的斜率。\n\n结论：**不正确**。该程序依赖于有缺陷的近似和错误的方法论。\n\n**C. 在 $K \\geq 4$ 次模拟中，改变应变并记录由最大温度梯度位置定义的火焰轴向位置 $x_f$。由于较高的应变会将火焰对流到更靠近驻点平面的位置，因此拟合 $x_f$ 与施加的应变率 $a$ 的关系，并以 $\\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$ 作为 $L_M$，其单位是长度，因此直接代表马克斯坦长度。**\n\n该选项基于一个在物理上和量纲上都有缺陷的前提。\n1.  **量纲不一致：** 马克斯坦长度 $L_M$ 的单位是长度 $[L]$。应变率 $a$ 的单位是时间的倒数 $[T^{-1}]$。火焰位置 $x_f$ 的单位是长度 $[L]$。因此，所提出的导数 $\\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$ 的单位是 $[L] / [T^{-1}] = [L T]$，即长度乘以时间，而不是长度。\n2.  **物理上无效：** 火焰理论中没有理论基础支持 $L_M = \\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$ 的说法。马克斯坦长度由燃烧速度对拉伸的敏感性定义，而不是火焰位置对应变率的敏感性。\n\n结论：**不正确**。所提出的关系在量纲上不一致，在物理上没有根据。\n\n**D. 使用中等应变下的单次高分辨率模拟，计算温度梯度大小的空间最大值 $\\max |\\nabla T|$，并使用比率 $S_L \\approx \\alpha \\, \\max |\\nabla T|$ 来近似燃烧速度，其中 $\\alpha$ 是未燃混合物的热扩散系数。然后轻微扰动应变，重新计算 $S_L$，并从 $S_L$ 对 $\\kappa$ 的有限差分斜率中获得 $L_M$。**\n\n该程序的稳健性明显低于选项 A。\n1.  **两点估计：** 仅使用两个点（一个初始模拟和一个扰动后的模拟）来计算有限差分斜率，对数值噪声高度敏感，可能无法准确表示线性区域的真实斜率。在多个点（如A中的 $N \\geq 5$）上进行线性回归在统计上要优越得多。\n2.  **对 $S_L$ 的近似：** 关系式 $S_L \\approx \\alpha \\, \\max |\\nabla T|$ 是从简化的热火焰理论推导出的一个近似。虽然有用，但它不如消耗速度 $S_c$ 通用和稳健，后者是直接从组分守恒方程推导出来的，没有此类简化假设。\n\n结论：**不正确**。该方法在技术上可行，但在方法论上较差，准确性低于选项 A 中的程序。它依赖于对 $S_L$ 的近似和对导数的不良两点估计。\n\n**E. 对于一系列模拟，在驻点平面处测量应变率 $a = \\left.\\frac{\\partial u_x}{\\partial x}\\right|_{x=0}$，该测量与火焰位置无关。假设射流相等且对冲，且可压缩性效应可忽略，将 $S_L$ 计算为入口质量通量除以上游密度，$S_L \\approx \\frac{\\dot{m}_{\\text{in}}}{\\rho_u A}$。在包括非线性和近熄火区在内的宽范围内拟合 $S_L$ 与 $a$ 的关系，以从斜率中估计 $L_M$。**\n\n该选项结合了在其他错误选项中看到的几个缺陷。\n1.  **不精确的应变测量：** 在驻点平面（$x=0$）测量应变率是一个近似值。与火焰相关的应变率是它在其未燃侧所经历的应变率，这不一定与驻点平面的应变率相同，尤其是在物理性质变化显著的流场中。\n2.  **对 $S_L$ 的不正确近似：** 计算 $S_L \\approx \\frac{\\dot{m}_{\\text{in}}}{\\rho_u A}$ 等同于设置 $S_L \\approx U_{\\text{in}}$（假设 $\\rho_{\\text{in}} \\approx \\rho_u$），出于与选项 B 相同的原因，这是根本错误的。\n3.  **不正确的拟合范围：** 如同选项 B，在包括非线性近熄火区在内的宽范围内进行拟合，将产生错误的 $L_M$ 结果。\n\n结论：**不正确**。该程序对 $S_L$ 和相关拉伸率都使用了有缺陷的近似，并采用了不正确的拟合方法。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "随着直接数值模拟（DNS）等高保真度模拟技术的发展，我们能够生成关于火焰行为的丰富数据集。从模拟的褶皱火焰前沿，我们可以提取一系列局部燃烧速率 $S_L$ 和相应的曲率 $\\kappa$。本项高级计算实践将指导您完成一个完整的研究级数据分析流程：使用加权最小二乘法（WLS）将物理模型拟合到高保真数据，并应用“德尔塔方法”严格地传播不确定性，从而定量评估最终提取的马克斯坦数 $M_a$ 的置信度 。",
            "id": "4018368",
            "problem": "给定一项计算任务，其灵感来源于预混火焰的直接数值模拟（DNS），目标是从受控的火焰褶皱中提取马克斯坦数。预混火焰中的扩散-热不稳定性表现为局部法向燃烧速度对曲率和拉伸的敏感性。在切向应变可忽略的受控褶皱条件下，您的目标是通过拟合局部法向层流燃烧速度对曲率的依赖关系来估计马克斯坦数，并量化其不确定性。\n\n从适用于预混火焰薄反应区的第一性原理和扩散-热理论出发。法向层流燃烧速度（记为 $S_L$）和火焰锋面的局部平均曲率（记为 $\\kappa$，当朝向反应物为凸时 $\\kappa > 0$）是相关的可测量。在拉伸可忽略的小振幅褶皱下，$S_L$ 对 $\\kappa$ 在 $\\kappa = 0$ 附近的主导阶敏感性可以通过与内外匹配渐近分析一致的一阶泰勒展开来证明，无需假设任何特定的简化公式。马克斯坦长度（记为 $L_M$）被定义为关联 $S_L$ 对 $\\kappa$ 在 $\\kappa = 0$ 附近的一阶敏感性的系数。马克斯坦数（记为 $M_a$）定义为 $M_a = L_M / \\delta_L$，其中 $\\delta_L$ 是层流火焰厚度。所有量均为计算燃烧学中的标准量；请仔细定义和使用它们。\n\n您必须：\n- 从守恒定律和扩散-热考虑出发，推导出对于小曲率，$S_L(\\kappa)$ 在 $\\kappa = 0$ 附近的依赖关系可用一阶线性模型表示，该模型允许您以量纲一致的方式将 $L_M$ 确定为模型斜率与截距之比。\n- 设计一个统计上可靠的估计量，以将线性模型拟合到含噪声的类 DNS 数据，并提取马克斯坦长度 $L_M$ 和马克斯坦数 $M_a$，并对两者进行不确定性量化。使用加权最小二乘法（WLS），权重仅基于所报告的 $S_L$ 测量标准差。通过 Delta 方法传播参数协方差，以获得 $L_M$ 和 $M_a$ 的标准差。\n\n您的程序必须计算以下测试套件的估计值及其不确定性。褶皱在 $x$ 方向上是小振幅的正弦波，火焰锋面由 $y(x) = A \\sin(k x)$ 给出，其中 $A$ 是振幅，$k = 2\\pi/\\lambda$ 是波数。在小斜率极限下，$x$ 处的局部曲率为\n$$\n\\kappa(x) \\approx -A k^2 \\sin(k x).\n$$\n对于每个案例，构建 $N = 21$ 个样本点，其相位为 $\\phi_j = 2\\pi j/N$，$j = 0, 1, \\ldots, 20$，并设置 $x_j$ 使得 $k x_j = \\phi_j$（角度以弧度为单位）。测得的局部法向层流燃烧速度由以下确定性公式给出\n$$\nS_L^{\\mathrm{meas}}(\\phi_j) = S_L^0 - S_L^0 \\, L_M \\, \\kappa(\\phi_j) + \\epsilon_1 \\cos(2 \\phi_j) + \\epsilon_2 \\sin(3 \\phi_j),\n$$\n其中 $S_L^0$ 是基准平面层流燃烧速度，$L_M$ 是用于生成数据的真实马克斯坦长度，$\\epsilon_1$ 和 $\\epsilon_2$ 是固定的确定性测量偏差。每个样本点 $S_L$ 的报告测量标准差为\n$$\n\\sigma_S(\\phi_j) = \\sigma_0 + \\sigma_1 \\, |\\kappa(\\phi_j)|,\n$$\n并用作 WLS 的权重基础。在线性拟合时，假设 $\\kappa$ 的测量误差可以忽略不计。\n\n三个测试案例是：\n\n- 案例1（一般正敏感性）：\n  - 振幅 $A = 0.004~\\mathrm{m}$，波长 $\\lambda = 0.10~\\mathrm{m}$。\n  - 基准 $S_L^0 = 0.40~\\mathrm{m/s}$。\n  - 真实马克斯坦长度 $L_M = 0.0008~\\mathrm{m}$。\n  - 层流火焰厚度 $\\delta_L = 0.0005~\\mathrm{m}$。\n  - 偏差振幅 $\\epsilon_1 = 0.00035~\\mathrm{m/s}$，$\\epsilon_2 = 0.00015~\\mathrm{m/s}$。\n  - 报告的标准差参数 $\\sigma_0 = 0.0004~\\mathrm{m/s}$，$\\sigma_1 = 0.00001~\\mathrm{m^2/s}$。\n\n- 案例2（负敏感性，表示扩散-热不稳定性）：\n  - 振幅 $A = 0.006~\\mathrm{m}$，波长 $\\lambda = 0.08~\\mathrm{m}$。\n  - 基准 $S_L^0 = 0.35~\\mathrm{m/s}$。\n  - 真实马克斯坦长度 $L_M = -0.0003~\\mathrm{m}$。\n  - 层流火焰厚度 $\\delta_L = 0.0005~\\mathrm{m}$。\n  - 偏差振幅 $\\epsilon_1 = 0.00030~\\mathrm{m/s}$，$\\epsilon_2 = -0.00010~\\mathrm{m/s}$。\n  - 报告的标准差参数 $\\sigma_0 = 0.0005~\\mathrm{m/s}$，$\\sigma_1 = 0.00002~\\mathrm{m^2/s}$。\n\n- 案例3（边界情况，曲率振幅非常小）：\n  - 振幅 $A = 0.001~\\mathrm{m}$，波长 $\\lambda = 0.12~\\mathrm{m}$。\n  - 基准 $S_L^0 = 0.42~\\mathrm{m/s}$。\n  - 真实马克斯坦长度 $L_M = 0.0005~\\mathrm{m}$。\n  - 层流火焰厚度 $\\delta_L = 0.0004~\\mathrm{m}$。\n  - 偏差振幅 $\\epsilon_1 = 0.00050~\\mathrm{m/s}$，$\\epsilon_2 = 0.00020~\\mathrm{m/s}$。\n  - 报告的标准差参数 $\\sigma_0 = 0.0006~\\mathrm{m/s}$，$\\sigma_1 = 0.000005~\\mathrm{m^2/s}$。\n\n算法要求：\n- 对于每个案例，使用指定的单位构建数据集 $\\{(\\kappa(\\phi_j), S_L^{\\mathrm{meas}}(\\phi_j), \\sigma_S(\\phi_j))\\}_{j=0}^{20}$。\n- 使用加权最小二乘法拟合线性模型 $S_L(\\kappa) \\approx a + b \\kappa$，权重为 $w_j = 1/\\sigma_S(\\phi_j)^2$，并估计 $a$ 和 $b$ 以及 $2 \\times 2$ 参数协方差矩阵 $\\mathrm{Cov}([a,b])$。\n- 根据量纲分析和马克斯坦长度的一阶定义，计算 $L_M = -b/a$，然后计算 $M_a = L_M / \\delta_L$。\n- 使用 Delta 方法传播 $\\mathrm{Cov}([a,b])$，并计算 $L_M$ 和 $M_a$ 的标准差。\n\n单位和输出：\n- $S_L$ 和 $S_L^0$ 必须以 $\\mathrm{m/s}$ 为单位处理。\n- $\\kappa$ 必须以 $\\mathrm{m^{-1}}$ 为单位处理。\n- $L_M$ 必须以 $\\mathrm{m}$ 为单位返回。\n- $\\delta_L$ 必须以 $\\mathrm{m}$ 为单位处理。\n- $M_a$ 是无量纲的。\n- 您的程序应生成单行输出，其中包含所有案例的结果，格式为一个由方括号括起来的逗号分隔列表，每个案例的结果本身就是一个列表，顺序为 $[a, L_M, M_a, \\sigma_{L_M}, \\sigma_{M_a}]$。所有条目均为浮点数。例如：$[[\\ldots],[\\ldots],[\\ldots]]$。\n\n不允许外部输入；所有值必须根据给定的规范在内部计算。",
            "solution": "我们从预混火焰在薄反应区近似下的基本输运公式出发，其中火焰锋面被表示为一个以局部法向燃烧速度沿其自身法线方向传播的界面。设 $S_L$ 为局部法向层流燃烧速度，$n$ 为垂直于锋面的坐标。在弯曲的火焰中，物质和热量的扩散改变了穿过鋒面的梯度，而表面散度通过曲率 $\\kappa$ 和拉伸对输运产生影响。在受控褶皱下，我们假设切向应变可忽略不计，因此主要的几何效应是曲率。在此条件下，对于曲率大小远小于层流火焰厚度倒数的小振幅褶皱，渐近分析（在小参数 $\\epsilon = \\delta_L / R$ 中展开，其中 $R$ 是局部曲率半径）得出，由于曲率对 $S_L$ 的主导阶修正在 $\\kappa=0$ 附近是线性的。具体来说，如果 $S_L(\\kappa)$ 在 $\\kappa=0$ 附近是光滑的，那么一阶泰勒展开给出\n$$\nS_L(\\kappa) \\approx S_L^0 + \\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} \\kappa,\n$$\n其中 $S_L^0$ 是平面火焰速度。扩散-热理论将该导数与混合物输运和反应特性联系起来；根据马克斯坦长度 $L_M$ 的定义，一阶敏感性系数满足\n$$\n\\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} = - S_L^0 \\, L_M.\n$$\n这个定义在量纲上是一致的：$S_L^0$ 的单位是 $\\mathrm{m/s}$，$\\kappa$ 的单位是 $\\mathrm{m^{-1}}$，这意味着 $L_M$ 的单位是 $\\mathrm{m}$，并且乘积 $S_L^0 L_M \\kappa$ 的单位是 $\\mathrm{m/s}$。将泰勒展开与 $L_M$ 的定义相结合，主导阶模型变为\n$$\nS_L(\\kappa) \\approx S_L^0 - S_L^0 \\, L_M \\, \\kappa.\n$$\n引入线性回归参数\n$$\na := S_L^0, \\qquad b := \\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} = - S_L^0 \\, L_M,\n$$\n我们可以写成 $S_L(\\kappa) \\approx a + b \\kappa$。用 $a$ 和 $b$ 求解马克斯坦长度，得到\n$$\nL_M = -\\frac{b}{a}.\n$$\n马克斯坦数定义为\n$$\nM_a = \\frac{L_M}{\\delta_L},\n$$\n其中 $\\delta_L$ 是层流火焰厚度。\n\n接下来，我们使用加权最小二乘法 (WLS) 为 $a$ 和 $b$ 构建一个统计上可靠的估计量。假设我们有数据 $\\{(\\kappa_j, S_j, \\sigma_j)\\}_{j=1}^N$，其中 $S_j$ 是在曲率 $\\kappa_j$ 处测得的 $S_L$，$\\sigma_j$ 是报告的 $S_j$ 的标准差。我们构建设计矩阵\n$$\nX = \\begin{bmatrix}\n1  \\kappa_1 \\\\\n\\vdots  \\vdots \\\\\n1  \\kappa_N\n\\end{bmatrix}, \\quad\n\\mathbf{y} = \\begin{bmatrix} S_1 \\\\ \\vdots \\\\ S_N \\end{bmatrix}, \\quad\nW = \\mathrm{diag}\\left(\\frac{1}{\\sigma_1^2}, \\ldots, \\frac{1}{\\sigma_N^2}\\right).\n$$\n在假设 $S_j$ 的测量误差独立且方差为 $\\sigma_j^2$，并且 $\\kappa_j$ 的测量误差可以忽略不计的情况下，WLS 估计量为\n$$\n\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} \\hat{a} \\\\ \\hat{b} \\end{bmatrix}\n= \\left( X^\\top W X \\right)^{-1} X^\\top W \\mathbf{y}.\n$$\n参数协方差矩阵是\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\left( X^\\top W X \\right)^{-1},\n$$\n因为 $W = \\Sigma^{-1}$，其中 $\\Sigma = \\mathrm{diag}(\\sigma_1^2, \\ldots, \\sigma_N^2)$。\n\n从 $\\hat{a}$ 和 $\\hat{b}$ 我们计算估计的马克斯坦长度\n$$\n\\hat{L}_M = -\\frac{\\hat{b}}{\\hat{a}},\n$$\n和估计的马克斯坦数\n$$\n\\hat{M}_a = \\frac{\\hat{L}_M}{\\delta_L}.\n$$\n为了量化不确定性，我们使用 Delta 方法。设 $g(a,b) = -b/a$，因此 $L_M = g(a,b)$。$g$ 的梯度是\n$$\n\\nabla g(a,b) = \\begin{bmatrix}\n\\frac{\\partial g}{\\partial a} \\\\\n\\frac{\\partial g}{\\partial b}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{b}{a^2} \\\\\n-\\frac{1}{a}\n\\end{bmatrix}.\n$$\n那么，对于小的参数不确定性，$\\hat{L}_M$ 的方差近似为\n$$\n\\mathrm{Var}(\\hat{L}_M) \\approx \\nabla g(\\hat{a},\\hat{b})^\\top \\, \\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) \\, \\nabla g(\\hat{a},\\hat{b}),\n$$\n标准差为 $\\sigma_{L_M} = \\sqrt{\\mathrm{Var}(\\hat{L}_M)}$。由于在此估计中 $\\delta_L$ 被视为已知（非随机），$\\hat{M}_a$ 的方差为\n$$\n\\mathrm{Var}(\\hat{M}_a) \\approx \\frac{\\mathrm{Var}(\\hat{L}_M)}{\\delta_L^2},\n$$\n且 $\\sigma_{M_a} = \\sqrt{\\mathrm{Var}(\\hat{M}_a)}$。\n\n测试套件的数据构建遵循受控的褶皱几何形状。对于每个具有振幅 $A$ 和波长 $\\lambda$ 的案例，波数为 $k = 2\\pi/\\lambda$，相位为 $\\phi_j = 2\\pi j/N$（弧度），其中 $j = 0, 1, \\ldots, N-1$ 且 $N = 21$，曲率样本为\n$$\n\\kappa_j = -A k^2 \\sin(\\phi_j).\n$$\n每个样本的测量燃烧速度，单位为 $\\mathrm{m/s}$，是\n$$\nS_j = S_L^0 - S_L^0 \\, L_M \\, \\kappa_j + \\epsilon_1 \\cos(2 \\phi_j) + \\epsilon_2 \\sin(3 \\phi_j),\n$$\n用于 WLS 加权的报告标准差为\n$$\n\\sigma_j = \\sigma_0 + \\sigma_1 \\, |\\kappa_j|.\n$$\n这些公式确保了与几何控制的曲率和合理的异方差测量不确定性一致的确定性数据生成。\n\n程序中实现的算法步骤：\n1. 对于每个案例，使用指定的参数和单位计算 $k$、相位数组 $\\{\\phi_j\\}$、曲率数组 $\\{\\kappa_j\\}$、测量速度 $\\{S_j\\}$ 和标准差 $\\{\\sigma_j\\}$。\n2. 组装 $X$、$\\mathbf{y}$ 和 $W$。使用上述公式计算 $\\hat{\\boldsymbol{\\beta}}$、$\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}})$、$\\hat{L}_M$ 和 $\\hat{M}_a$。\n3. 通过 Delta 方法的协方差传播计算 $\\sigma_{L_M}$ 和 $\\sigma_{M_a}$。\n4. 对于每个案例，返回列表 $[\\hat{a}, \\hat{L}_M, \\hat{M}_a, \\sigma_{L_M}, \\sigma_{M_a}]$，其中 $\\hat{a}$ 的单位是 $\\mathrm{m/s}$，$\\hat{L}_M$ 的单位是 $\\mathrm{m}$，$\\hat{M}_a$ 是无量纲的。将三个结果聚合成一个单一的方括号列表并打印为单行。\n\n这种方法将扩散-热不稳定性的物理推理与统计上 principled 的估计和不确定性量化相结合，适用于从受控火焰褶皱下获得的类 DNS 数据中提取马克斯坦数。",
            "answer": "```python\nimport numpy as np\n\ndef weighted_linear_fit(kappa, S_meas, sigma_S):\n    \"\"\"\n    Perform weighted least squares fit of S = a + b * kappa.\n    Returns a, b, and covariance matrix of [a, b].\n    \"\"\"\n    # Design matrix X: first column ones (intercept), second column kappa\n    X = np.column_stack([np.ones_like(kappa), kappa])\n    # Weights: W = diag(1/sigma^2)\n    w = 1.0 / (sigma_S ** 2)\n    W = np.diag(w)\n    # Compute (X^T W X)^-1 and X^T W y\n    XT_W = X.T * w  # broadcasting weights across rows\n    XT_W_X = XT_W @ X\n    XT_W_y = XT_W @ S_meas\n    # Solve for beta = [a, b]\n    cov_beta = np.linalg.inv(XT_W_X)\n    beta = cov_beta @ XT_W_y\n    a, b = beta[0], beta[1]\n    return a, b, cov_beta\n\ndef delta_method_std_LM(a, b, cov_beta, delta_L):\n    \"\"\"\n    Compute standard deviations of L_M = -b/a and M_a = L_M / delta_L via delta method.\n    \"\"\"\n    # Gradient of L_M wrt [a, b]: [b/a^2, -1/a]\n    grad = np.array([b / (a**2), -1.0 / a])\n    var_LM = grad @ (cov_beta @ grad)\n    sigma_LM = np.sqrt(var_LM)\n    sigma_Ma = sigma_LM / delta_L\n    return sigma_LM, sigma_Ma\n\ndef construct_case(A, lam, SL0, LM_true, delta_L, eps1, eps2, sigma0, sigma1, N=21):\n    \"\"\"\n    Construct deterministic dataset based on sinusoidal wrinkling and specified parameters.\n    Returns kappa array, S_meas array, sigma_S array, and delta_L.\n    \"\"\"\n    k = 2.0 * np.pi / lam\n    j = np.arange(N)\n    phi = 2.0 * np.pi * j / N  # radians\n    # Small-slope curvature\n    kappa = -A * (k**2) * np.sin(phi)\n    # Measured S_L with deterministic biases\n    S_meas = SL0 - SL0 * LM_true * kappa + eps1 * np.cos(2.0 * phi) + eps2 * np.sin(3.0 * phi)\n    # Reported standard deviations (heteroskedastic by |kappa|)\n    sigma_S = sigma0 + sigma1 * np.abs(kappa)\n    return kappa, S_meas, sigma_S, delta_L\n\ndef solve():\n    # Define test cases with parameters as specified in the problem statement.\n    test_params = [\n        # Case 1\n        {\n            \"A\": 0.004, \"lam\": 0.10, \"SL0\": 0.40, \"LM_true\": 0.0008, \"delta_L\": 0.0005,\n            \"eps1\": 0.00035, \"eps2\": 0.00015, \"sigma0\": 0.0004, \"sigma1\": 0.00001\n        },\n        # Case 2\n        {\n            \"A\": 0.006, \"lam\": 0.08, \"SL0\": 0.35, \"LM_true\": -0.0003, \"delta_L\": 0.0005,\n            \"eps1\": 0.00030, \"eps2\": -0.00010, \"sigma0\": 0.0005, \"sigma1\": 0.00002\n        },\n        # Case 3\n        {\n            \"A\": 0.001, \"lam\": 0.12, \"SL0\": 0.42, \"LM_true\": 0.0005, \"delta_L\": 0.0004,\n            \"eps1\": 0.00050, \"eps2\": 0.00020, \"sigma0\": 0.0006, \"sigma1\": 0.000005\n        },\n    ]\n\n    results = []\n    for params in test_params:\n        kappa, S_meas, sigma_S, delta_L = construct_case(**params)\n        # Weighted least squares fit\n        a, b, cov_beta = weighted_linear_fit(kappa, S_meas, sigma_S)\n        # Markstein length and number\n        LM_est = -b / a\n        Ma_est = LM_est / delta_L\n        # Uncertainty via delta method\n        sigma_LM, sigma_Ma = delta_method_std_LM(a, b, cov_beta, delta_L)\n        # Collect results: [a (m/s), L_M (m), M_a (-), sigma_LM (m), sigma_Ma (-)]\n        results.append([a, LM_est, Ma_est, sigma_LM, sigma_Ma])\n\n    # Final print statement in the exact required format.\n    # Single line, comma-separated, enclosed in square brackets.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}