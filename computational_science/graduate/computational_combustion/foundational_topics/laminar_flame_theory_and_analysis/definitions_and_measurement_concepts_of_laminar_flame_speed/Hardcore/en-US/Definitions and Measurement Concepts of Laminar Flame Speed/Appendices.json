{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of combustion science is the determination of the unstretched laminar flame speed, $S_L^0$, a fundamental property of a reactive mixture. Since laboratory flames are almost always subject to stretch, this exercise  provides hands-on practice with the classic experimental technique of extrapolating data from a spherically expanding flame to the ideal unstretched condition. You will learn to process raw experimental data by correcting for measurement biases, calculating the local displacement speed $S_d$ and stretch rate $\\kappa$, and applying the linear extrapolation method to isolate the intrinsic value of $S_L^0$.",
            "id": "4016490",
            "problem": "A constant-pressure combustion vessel is used to record outwardly propagating spherical flame fronts in a premixed hydrogen–air mixture at ambient conditions. The laminar burning velocity at zero stretch, denoted $S_{L}^{0}$, is defined as the normal propagation speed of an unstretched planar flame relative to the unburned mixture. The experiment employs high-speed imaging with exposure time $T_{\\text{exp}} = 0.2\\,\\text{ms}$, and each recorded timestamp corresponds to the start of the exposure. Due to a known calibration issue, measured radii are inflated by a multiplicative scale bias of $0.3\\%$; treat this bias as a deterministic factor that must be corrected.\n\nThree frames yield raw flame radii and timestamps:\n- $t_{1} = 1.2\\,\\text{ms}$, $r_{\\text{raw},1} = 12.35\\,\\text{mm}$,\n- $t_{2} = 1.6\\,\\text{ms}$, $r_{\\text{raw},2} = 14.21\\,\\text{mm}$,\n- $t_{3} = 2.0\\,\\text{ms}$, $r_{\\text{raw},3} = 16.02\\,\\text{mm}$.\n\nAssume the front position recorded in each frame corresponds to the mid-exposure time $t_{i} + T_{\\text{exp}}/2$. Treat the displacement speed over each adjacent-interval midpoint as approximately constant. The flame stretch rate is defined by the area-based kinematic relation $\\kappa \\equiv (1/A)\\,\\mathrm{d}A/\\mathrm{d}t$, and for a spherical front of radius $r$ the area is $A = 4\\pi r^{2}$. The local displacement speed is $S_{d} \\equiv \\mathrm{d}r/\\mathrm{d}t$. Near zero stretch, model the dependence of $S_{d}$ on $\\kappa$ as first-order in $\\kappa$ and use linear extrapolation to obtain $S_{L}^{0}$ at $\\kappa = 0$ from measurements at nonzero $\\kappa$.\n\nTasks:\n1. Correct the radii for the known $0.3\\%$ scale bias.\n2. Using adjacent pairs $(t_{1},r_{1})$ and $(t_{2},r_{2})$, and $(t_{2},r_{2})$ and $(t_{3},r_{3})$, compute two midpoint pairs $\\big(\\kappa, S_{d}\\big)$, where $S_{d}$ is approximated by the finite difference of $r$ over the corresponding time difference, and $\\kappa$ is obtained from the definition $\\kappa = (1/A)\\,\\mathrm{d}A/\\mathrm{d}t$ with $A = 4\\pi r^{2}$ evaluated using the midpoint radius and the same finite-difference $\\mathrm{d}r/\\mathrm{d}t$.\n3. Perform a linear extrapolation of $S_{d}$ versus $\\kappa$ to $\\kappa = 0$ to determine $S_{L}^{0}$.\n\nExpress the final value of $S_{L}^{0}$ in $\\text{m}\\,\\text{s}^{-1}$ and round your answer to three significant figures. Ignore random uncertainties for the central estimate, but account for the stated deterministic bias correction exactly.",
            "solution": "The problem requires the determination of the unstretched laminar burning velocity, $S_{L}^{0}$, from experimental data of a spherically propagating flame. This involves correcting the raw data, calculating the displacement speed $S_{d}$ and stretch rate $\\kappa$ for two intervals, and then performing a linear extrapolation of $S_{d}$ versus $\\kappa$ to the unstretched condition, $\\kappa=0$.\n\nFirst, we establish the given parameters and data:\n-   Exposure time: $T_{\\text{exp}} = 0.2\\,\\text{ms} = 2 \\times 10^{-4}\\,\\text{s}$.\n-   Multiplicative scale bias: a $0.3\\%$ inflation, which corresponds to a factor of $1 + 0.003 = 1.003$.\n-   Raw data points $(t_{i}, r_{\\text{raw},i})$:\n    -   $t_{1} = 1.2\\,\\text{ms}$, $r_{\\text{raw},1} = 12.35\\,\\text{mm}$\n    -   $t_{2} = 1.6\\,\\text{ms}$, $r_{\\text{raw},2} = 14.21\\,\\text{mm}$\n    -   $t_{3} = 2.0\\,\\text{ms}$, $r_{\\text{raw},3} = 16.02\\,\\text{mm}$\n\nThe solution proceeds in three steps as outlined in the problem statement.\n\n**Step 1: Data Correction**\n\nWe must correct both the timestamps and the measured radii.\nThe effective time of each measurement corresponds to the midpoint of the exposure interval. The corrected time $t'_{i}$ is given by:\n$$t'_{i} = t_{i} + \\frac{T_{\\text{exp}}}{2}$$\nWith $T_{\\text{exp}} = 0.2\\,\\text{ms}$, the time correction is $0.1\\,\\text{ms}$.\n$$t'_{1} = 1.2\\,\\text{ms} + 0.1\\,\\text{ms} = 1.3\\,\\text{ms}$$\n$$t'_{2} = 1.6\\,\\text{ms} + 0.1\\,\\text{ms} = 1.7\\,\\text{ms}$$\n$$t'_{3} = 2.0\\,\\text{ms} + 0.1\\,\\text{ms} = 2.1\\,\\text{ms}$$\n\nThe raw radii $r_{\\text{raw},i}$ are inflated by $0.3\\%$. The true radius $r_i$ is found by dividing the raw radius by the bias factor $1.003$.\n$$r_{i} = \\frac{r_{\\text{raw},i}}{1.003}$$\n$$r_{1} = \\frac{12.35\\,\\text{mm}}{1.003}$$\n$$r_{2} = \\frac{14.21\\,\\text{mm}}{1.003}$$\n$$r_{3} = \\frac{16.02\\,\\text{mm}}{1.003}$$\nIt is prudent to keep these values in their fractional form during intermediate calculations to avoid premature rounding errors.\n\n**Step 2: Computation of Midpoint Pairs $(\\kappa, S_{d})$**\n\nWe compute two pairs of $(\\kappa, S_{d})$, one for the interval between $(t'_{1}, r_{1})$ and $(t'_{2}, r_{2})$, and another for the interval between $(t'_{2}, r_{2})$ and $(t'_{3}, r_{3})$.\n\nFor the first interval (denoted by subscript $12$):\nThe time difference is $\\Delta t_{12} = t'_{2} - t'_{1} = 1.7\\,\\text{ms} - 1.3\\,\\text{ms} = 0.4\\,\\text{ms}$.\nThe displacement speed $S_{d,12}$ is approximated by a finite difference:\n$$S_{d,12} = \\frac{r_{2} - r_{1}}{\\Delta t_{12}} = \\frac{(14.21 - 12.35)/1.003\\,\\text{mm}}{0.4\\,\\text{ms}} = \\frac{1.86/1.003}{0.4}\\,\\frac{\\text{mm}}{\\text{ms}} = \\frac{1.86}{0.4012}\\,\\frac{\\text{m}}{\\text{s}} \\approx 4.63609\\,\\frac{\\text{m}}{\\text{s}}$$\nNote that the unit $\\text{mm}/\\text{ms}$ is numerically equivalent to $\\text{m}/\\text{s}$.\n\nThe stretch rate for a spherical flame is $\\kappa = (1/A)(\\mathrm{d}A/\\mathrm{d}t)$. With $A = 4\\pi r^2$, this becomes $\\kappa = (1/(4\\pi r^2))(8\\pi r (\\mathrm{d}r/\\mathrm{d}t)) = (2/r)(\\mathrm{d}r/\\mathrm{d}t)$. We evaluate this using the midpoint radius and the finite-difference speed.\nThe midpoint radius is $r_{12} = (r_{1}+r_{2})/2$.\n$$r_{12} = \\frac{(12.35 + 14.21)/1.003}{2}\\,\\text{mm} = \\frac{26.56}{2.006}\\,\\text{mm}$$\nThe stretch rate is $\\kappa_{12}$:\n$$\\kappa_{12} = \\frac{2 S_{d,12}}{r_{12}} = \\frac{2 \\cdot \\frac{r_2-r_1}{\\Delta t_{12}}}{\\frac{r_1+r_2}{2}} = \\frac{4(r_2-r_1)}{\\Delta t_{12}(r_1+r_2)}$$\nSubstituting the expressions for $r_i$ in terms of $r_{\\text{raw},i}$:\n$$\\kappa_{12} = \\frac{4(r_{\\text{raw},2} - r_{\\text{raw},1})/1.003}{\\Delta t_{12}(r_{\\text{raw},1} + r_{\\text{raw},2})/1.003} = \\frac{4(r_{\\text{raw},2} - r_{\\text{raw},1})}{\\Delta t_{12}(r_{\\text{raw},1} + r_{\\text{raw},2})}$$\nThe bias correction cancels for $\\kappa$.\n$$\\kappa_{12} = \\frac{4(14.21 - 12.35)\\,\\text{mm}}{0.4\\,\\text{ms} \\cdot (12.35 + 14.21)\\,\\text{mm}} = \\frac{4(1.86)}{0.4(26.56)}\\,\\text{ms}^{-1} = \\frac{7.44}{10.624}\\,\\text{ms}^{-1} \\approx 0.70030\\,\\text{ms}^{-1}$$\nConverting to SI units, $\\kappa_{12} \\approx 700.30\\,\\text{s}^{-1}$.\n\nFor the second interval (denoted by subscript $23$):\nThe time difference is $\\Delta t_{23} = t'_{3} - t'_{2} = 2.1\\,\\text{ms} - 1.7\\,\\text{ms} = 0.4\\,\\text{ms}$.\nThe displacement speed $S_{d,23}$ is:\n$$S_{d,23} = \\frac{r_{3} - r_{2}}{\\Delta t_{23}} = \\frac{(16.02 - 14.21)/1.003\\,\\text{mm}}{0.4\\,\\text{ms}} = \\frac{1.81/1.003}{0.4}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{1.81}{0.4012}\\,\\frac{\\text{m}}{\\text{s}} \\approx 4.51147\\,\\frac{\\text{m}}{\\text{s}}$$\nThe stretch rate $\\kappa_{23}$ is:\n$$\\kappa_{23} = \\frac{4(r_{\\text{raw},3} - r_{\\text{raw},2})}{\\Delta t_{23}(r_{\\text{raw},2} + r_{\\text{raw},3})} = \\frac{4(16.02 - 14.21)\\,\\text{mm}}{0.4\\,\\text{ms} \\cdot (14.21 + 16.02)\\,\\text{mm}} = \\frac{4(1.81)}{0.4(30.23)}\\,\\text{ms}^{-1} = \\frac{7.24}{12.092}\\,\\text{ms}^{-1} \\approx 0.59874\\,\\text{ms}^{-1}$$\nConverting to SI units, $\\kappa_{23} \\approx 598.74\\,\\text{s}^{-1}$.\n\nSo we have two points $(\\kappa, S_d)$:\nPoint A: $(\\kappa_A, S_{d,A}) = (700.30\\,\\text{s}^{-1}, 4.63609\\,\\text{m/s})$\nPoint B: $(\\kappa_B, S_{d,B}) = (598.74\\,\\text{s}^{-1}, 4.51147\\,\\text{m/s})$\n\n**Step 3: Linear Extrapolation to $\\kappa=0$**\n\nWe model the relationship between $S_d$ and $\\kappa$ as linear: $S_d(\\kappa) = m\\kappa + c$. The unstretched laminar burning velocity $S_L^0$ is the value of $S_d$ at $\\kappa=0$, which is the intercept $c$.\nGiven two points $(\\kappa_A, S_{d,A})$ and $(\\kappa_B, S_{d,B})$, the intercept $S_L^0$ of the line passing through them is given by:\n$$S_{L}^{0} = \\frac{S_{d,B}\\kappa_A - S_{d,A}\\kappa_B}{\\kappa_A - \\kappa_B}$$\nSubstituting the calculated values:\n$$S_{L}^{0} = \\frac{(4.51147\\,\\text{m/s})(700.30\\,\\text{s}^{-1}) - (4.63609\\,\\text{m/s})(598.74\\,\\text{s}^{-1})}{700.30\\,\\text{s}^{-1} - 598.74\\,\\text{s}^{-1}}$$\n$$S_{L}^{0} = \\frac{3159.40 - 2775.83}{101.56}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{383.57}{101.56}\\,\\frac{\\text{m}}{\\text{s}} \\approx 3.7767\\,\\frac{\\text{m}}{\\text{s}}$$\nA more precise calculation using the unrounded intermediate values gives:\n$\\kappa_A = 700.3011... \\,\\text{s}^{-1}$\n$\\kappa_B = 598.7429... \\,\\text{s}^{-1}$\n$S_{d,A} = 4.6360917... \\,\\text{m/s}$\n$S_{d,B} = 4.5114656... \\,\\text{m/s}$\n$$S_{L}^{0} = \\frac{(4.5114656)(700.3011) - (4.6360917)(598.7429)}{700.3011 - 598.7429}\\,\\frac{\\text{m}}{\\text{s}}$$\n$$S_{L}^{0} = \\frac{3159.400 - 2775.833}{101.5582}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{383.567}{101.5582}\\,\\frac{\\text{m}}{\\text{s}} \\approx 3.77666\\,\\frac{\\text{m}}{\\text{s}}$$\nThe problem requires the final answer to be rounded to three significant figures.\n$$S_{L}^{0} \\approx 3.78\\,\\frac{\\text{m}}{\\text{s}}$$",
            "answer": "$$\n\\boxed{3.78}\n$$"
        },
        {
            "introduction": "Beyond the baseline flame speed, its sensitivity to local flame geometry is critical for understanding flame instabilities and turbulent flame dynamics. The Markstein length, $L_M$, and the corresponding Markstein number, $M_a$, quantify this sensitivity to flame curvature, a central concept in diffusive-thermal theory. This computational practice  challenges you to apply robust statistical methods, specifically Weighted Least Squares, to extract these parameters from simulated wrinkled flame data, complete with a rigorous uncertainty analysis—a core skill in the validation of modern combustion simulations.",
            "id": "4018368",
            "problem": "You are given a computational task inspired by Direct Numerical Simulation (DNS) of premixed flames to extract the Markstein number from controlled flame wrinkling. The diffusive–thermal instability in premixed flames manifests as a sensitivity of the local normal burning velocity to curvature and stretch. Under controlled wrinkling with negligible tangential strain, your goal is to estimate the Markstein number by fitting the curvature dependence of the local normal laminar burning velocity and quantifying uncertainty.\n\nStart from first principles appropriate to the thin reaction zone of a premixed flame and the diffusive–thermal theory. The normal laminar burning velocity, denoted by $S_L$, and the local mean curvature of the flame front, denoted by $\\kappa$ (with $\\kappa  0$ for convex towards reactants), are the relevant measurable quantities. Under small-amplitude wrinkling with negligible stretch, the leading-order sensitivity of $S_L$ to $\\kappa$ near $\\kappa = 0$ can be justified by a first-order Taylor expansion consistent with inner–outer matched asymptotic analysis, without assuming any specific shortcut formula. The Markstein length, denoted by $L_M$, is defined as the coefficient that relates the first-order sensitivity of $S_L$ to $\\kappa$ about $\\kappa = 0$. The Markstein number, denoted by $M_a$, is defined as $M_a = L_M / \\delta_L$, where $\\delta_L$ is the laminar flame thickness. All quantities are standard in computational combustion; please define and use them carefully.\n\nYou must:\n- Derive, from the conservation laws and diffusive–thermal considerations, that for small curvature the dependence $S_L(\\kappa)$ around $\\kappa = 0$ admits a first-order linear model that allows you to identify $L_M$ as a ratio of the model’s slope and intercept in a way that is dimensionally consistent.\n- Design a statistically sound estimator to fit the linear model to noisy DNS-like data and to extract the Markstein length $L_M$ and Markstein number $M_a$, with uncertainty quantification for both. Use Weighted Least Squares (WLS) with weights based on reported measurement standard deviations for $S_L$ only. Propagate parameter covariance by the delta method to obtain standard deviations of $L_M$ and $M_a$.\n\nYour program must compute the estimates and their uncertainties for the following test suite. The wrinkling is sinusoidal with small amplitude in the $x$-direction, with flame front given by $y(x) = A \\sin(k x)$, where $A$ is the amplitude and $k = 2\\pi/\\lambda$ is the wavenumber. The local curvature at $x$ in the small-slope limit is\n$$\n\\kappa(x) \\approx -A k^2 \\sin(k x).\n$$\nFor each case, construct $N = 21$ sample points with phases $\\phi_j = 2\\pi j/N$ for $j = 0, 1, \\ldots, 20$, and set $x_j$ such that $k x_j = \\phi_j$ (angles in radians). The measured local normal laminar burning velocity is given deterministically by\n$$\nS_L^{\\mathrm{meas}}(\\phi_j) = S_L^0 - S_L^0 \\, L_M \\, \\kappa(\\phi_j) + \\epsilon_1 \\cos(2 \\phi_j) + \\epsilon_2 \\sin(3 \\phi_j),\n$$\nwhere $S_L^0$ is the baseline planar laminar burning velocity, $L_M$ is the true Markstein length used to generate the data, and $\\epsilon_1$ and $\\epsilon_2$ are fixed deterministic measurement biases. The reported measurement standard deviation for $S_L$ at each sample is\n$$\n\\sigma_S(\\phi_j) = \\sigma_0 + \\sigma_1 \\, |\\kappa(\\phi_j)|,\n$$\nand is to be used as the weight basis for WLS. Assume negligible measurement error in $\\kappa$ for the purposes of linear fitting.\n\nThe three test cases are:\n\n- Case 1 (general positive sensitivity):\n  - Amplitude $A = 0.004~\\mathrm{m}$, wavelength $\\lambda = 0.10~\\mathrm{m}$.\n  - Baseline $S_L^0 = 0.40~\\mathrm{m/s}$.\n  - True Markstein length $L_M = 0.0008~\\mathrm{m}$.\n  - Laminar flame thickness $\\delta_L = 0.0005~\\mathrm{m}$.\n  - Bias amplitudes $\\epsilon_1 = 0.00035~\\mathrm{m/s}$, $\\epsilon_2 = 0.00015~\\mathrm{m/s}$.\n  - Reported standard deviation parameters $\\sigma_0 = 0.0004~\\mathrm{m/s}$, $\\sigma_1 = 0.00001~\\mathrm{m^2/s}$.\n\n- Case 2 (negative sensitivity indicating diffusive–thermal destabilization):\n  - Amplitude $A = 0.006~\\mathrm{m}$, wavelength $\\lambda = 0.08~\\mathrm{m}$.\n  - Baseline $S_L^0 = 0.35~\\mathrm{m/s}$.\n  - True Markstein length $L_M = -0.0003~\\mathrm{m}$.\n  - Laminar flame thickness $\\delta_L = 0.0005~\\mathrm{m}$.\n  - Bias amplitudes $\\epsilon_1 = 0.00030~\\mathrm{m/s}$, $\\epsilon_2 = -0.00010~\\mathrm{m/s}$.\n  - Reported standard deviation parameters $\\sigma_0 = 0.0005~\\mathrm{m/s}$, $\\sigma_1 = 0.00002~\\mathrm{m^2/s}$.\n\n- Case 3 (boundary case with very small curvature amplitude):\n  - Amplitude $A = 0.001~\\mathrm{m}$, wavelength $\\lambda = 0.12~\\mathrm{m}$.\n  - Baseline $S_L^0 = 0.42~\\mathrm{m/s}$.\n  - True Markstein length $L_M = 0.0005~\\mathrm{m}$.\n  - Laminar flame thickness $\\delta_L = 0.0004~\\mathrm{m}$.\n  - Bias amplitudes $\\epsilon_1 = 0.00050~\\mathrm{m/s}$, $\\epsilon_2 = 0.00020~\\mathrm{m/s}$.\n  - Reported standard deviation parameters $\\sigma_0 = 0.0006~\\mathrm{m/s}$, $\\sigma_1 = 0.000005~\\mathrm{m^2/s}$.\n\nAlgorithmic requirements:\n- For each case, form the dataset $\\{(\\kappa(\\phi_j), S_L^{\\mathrm{meas}}(\\phi_j), \\sigma_S(\\phi_j))\\}_{j=0}^{20}$ in the specified units.\n- Fit the linear model $S_L(\\kappa) \\approx a + b \\kappa$ using Weighted Least Squares with weights $w_j = 1/\\sigma_S(\\phi_j)^2$, and estimate $a$ and $b$ along with the $2 \\times 2$ parameter covariance matrix $\\mathrm{Cov}([a,b])$.\n- From dimensional analysis and the first-order definition of the Markstein length, compute $L_M = -b/a$, and then $M_a = L_M / \\delta_L$.\n- Use the delta method to propagate $\\mathrm{Cov}([a,b])$ and compute the standard deviation of $L_M$ and of $M_a$.\n\nUnits and output:\n- $S_L$ and $S_L^0$ must be treated in $\\mathrm{m/s}$.\n- $\\kappa$ must be treated in $\\mathrm{m^{-1}}$.\n- $L_M$ must be returned in $\\mathrm{m}$.\n- $\\delta_L$ must be treated in $\\mathrm{m}$.\n- $M_a$ is dimensionless.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, where each case’s result is itself a list in the order $[a, L_M, M_a, \\sigma_{L_M}, \\sigma_{M_a}]$. All entries are floats. For example: $[[\\ldots],[\\ldots],[\\ldots]]$.\n\nNo external input is allowed; all values must be computed internally from the given specifications.",
            "solution": "We begin from the fundamental transport formulation for premixed flames in the thin reaction zone approximation, where a flame front is represented as an interface propagating normal to itself with a local normal burning velocity. Let $S_L$ be the local normal laminar burning velocity and $n$ be the coordinate normal to the front. In a curved flame, species and heat diffusion alter gradients across the front, and the surface divergence contributes to the transport through the curvature $\\kappa$ and stretch. Under controlled wrinkling, we assume negligible tangential strain so that the primary geometric effect is curvature. In this regime and for small-amplitude wrinkling with a curvature magnitude small compared to the inverse of the laminar flame thickness, asymptotic analysis (expansion in the small parameter $\\epsilon = \\delta_L / R$, with $R$ a local radius of curvature) yields that the leading-order correction to $S_L$ due to curvature is linear in $\\kappa$ near $\\kappa = 0$. Specifically, if $S_L(\\kappa)$ is smooth near $\\kappa = 0$, then the first-order Taylor expansion gives\n$$\nS_L(\\kappa) \\approx S_L^0 + \\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} \\kappa,\n$$\nwhere $S_L^0$ is the planar flame speed. Diffusive–thermal theory connects the derivative to mixture transport and reaction properties; by definition of the Markstein length $L_M$, the coefficient of the first-order sensitivity satisfies\n$$\n\\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} = - S_L^0 \\, L_M.\n$$\nThis definition is dimensionally consistent: $S_L^0$ has units of $\\mathrm{m/s}$, $\\kappa$ has units of $\\mathrm{m^{-1}}$, which implies that $L_M$ has units of $\\mathrm{m}$, and the product $S_L^0 L_M \\kappa$ has units of $\\mathrm{m/s}$. Combining the Taylor expansion with the definition of $L_M$, the leading-order model becomes\n$$\nS_L(\\kappa) \\approx S_L^0 - S_L^0 \\, L_M \\, \\kappa.\n$$\nIntroducing the linear regression parameters\n$$\na := S_L^0, \\qquad b := \\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} = - S_L^0 \\, L_M,\n$$\nwe can write $S_L(\\kappa) \\approx a + b \\kappa$. Solving for the Markstein length in terms of $a$ and $b$ gives\n$$\nL_M = -\\frac{b}{a}.\n$$\nThe Markstein number is defined as\n$$\nM_a = \\frac{L_M}{\\delta_L},\n$$\nwhere $\\delta_L$ is the laminar flame thickness.\n\nWe next construct a statistically sound estimator for $a$ and $b$ using Weighted Least Squares (WLS). Suppose we have data $\\{(\\kappa_j, S_j, \\sigma_j)\\}_{j=1}^N$, where $S_j$ is the measured $S_L$ at curvature $\\kappa_j$, and $\\sigma_j$ is the reported standard deviation of $S_j$. We form the design matrix\n$$\nX = \\begin{bmatrix}\n1  \\kappa_1 \\\\\n\\vdots  \\vdots \\\\\n1  \\kappa_N\n\\end{bmatrix}, \\quad\n\\mathbf{y} = \\begin{bmatrix} S_1 \\\\ \\vdots \\\\ S_N \\end{bmatrix}, \\quad\nW = \\mathrm{diag}\\left(\\frac{1}{\\sigma_1^2}, \\ldots, \\frac{1}{\\sigma_N^2}\\right).\n$$\nUnder the assumption that measurement errors in $S_j$ are independent with variances $\\sigma_j^2$ and that $\\kappa_j$ is measured with negligible error, the WLS estimator is\n$$\n\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} \\hat{a} \\\\ \\hat{b} \\end{bmatrix}\n= \\left( X^\\top W X \\right)^{-1} X^\\top W \\mathbf{y}.\n$$\nThe parameter covariance matrix is\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\left( X^\\top W X \\right)^{-1},\n$$\nbecause $W = \\Sigma^{-1}$ with $\\Sigma = \\mathrm{diag}(\\sigma_1^2, \\ldots, \\sigma_N^2)$.\n\nFrom $\\hat{a}$ and $\\hat{b}$ we compute the estimated Markstein length\n$$\n\\hat{L}_M = -\\frac{\\hat{b}}{\\hat{a}},\n$$\nand the estimated Markstein number\n$$\n\\hat{M}_a = \\frac{\\hat{L}_M}{\\delta_L}.\n$$\nTo quantify uncertainty, we use the delta method. Let $g(a,b) = -b/a$ so that $L_M = g(a,b)$. The gradient of $g$ is\n$$\n\\nabla g(a,b) = \\begin{bmatrix}\n\\frac{\\partial g}{\\partial a} \\\\\n\\frac{\\partial g}{\\partial b}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{b}{a^2} \\\\\n-\\frac{1}{a}\n\\end{bmatrix}.\n$$\nThen, for small parameter uncertainty, the variance of $\\hat{L}_M$ is approximated by\n$$\n\\mathrm{Var}(\\hat{L}_M) \\approx \\nabla g(\\hat{a},\\hat{b})^\\top \\, \\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) \\, \\nabla g(\\hat{a},\\hat{b}),\n$$\nand the standard deviation is $\\sigma_{L_M} = \\sqrt{\\mathrm{Var}(\\hat{L}_M)}$. Since $\\delta_L$ is treated as known (non-random) in this estimation, the variance of $\\hat{M}_a$ is\n$$\n\\mathrm{Var}(\\hat{M}_a) \\approx \\frac{\\mathrm{Var}(\\hat{L}_M)}{\\delta_L^2},\n$$\nand $\\sigma_{M_a} = \\sqrt{\\mathrm{Var}(\\hat{M}_a)}$.\n\nData construction for the test suite follows the controlled wrinkling geometry. For each case with amplitude $A$ and wavelength $\\lambda$, the wavenumber is $k = 2\\pi/\\lambda$, the phases are $\\phi_j = 2\\pi j/N$ in radians for $j = 0, 1, \\ldots, N-1$ with $N = 21$, and the curvature samples are\n$$\n\\kappa_j = -A k^2 \\sin(\\phi_j).\n$$\nThe measured burning velocity at each sample, in $\\mathrm{m/s}$, is\n$$\nS_j = S_L^0 - S_L^0 \\, L_M \\, \\kappa_j + \\epsilon_1 \\cos(2 \\phi_j) + \\epsilon_2 \\sin(3 \\phi_j),\n$$\nand the reported standard deviation for WLS weighting is\n$$\n\\sigma_j = \\sigma_0 + \\sigma_1 \\, |\\kappa_j|.\n$$\nThese formulas ensure deterministic data generation consistent with geometrically controlled curvature and plausible, heteroskedastic measurement uncertainties.\n\nAlgorithmic steps implemented in the program:\n1. For each case, compute $k$, the phase array $\\{\\phi_j\\}$, the curvature array $\\{\\kappa_j\\}$, the measured velocities $\\{S_j\\}$, and the standard deviations $\\{\\sigma_j\\}$ using the specified parameters and units.\n2. Assemble $X$, $\\mathbf{y}$, and $W$. Compute $\\hat{\\boldsymbol{\\beta}}$, $\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}})$, $\\hat{L}_M$, and $\\hat{M}_a$ using the formulas above.\n3. Compute $\\sigma_{L_M}$ and $\\sigma_{M_a}$ by covariance propagation via the delta method.\n4. For each case, return the list $[\\hat{a}, \\hat{L}_M, \\hat{M}_a, \\sigma_{L_M}, \\sigma_{M_a}]$, where $\\hat{a}$ is in $\\mathrm{m/s}$, $\\hat{L}_M$ is in $\\mathrm{m}$, and $\\hat{M}_a$ is dimensionless. Aggregate the three results into a single bracketed list and print as a single line.\n\nThis approach integrates physical reasoning from diffusive–thermal instability with statistically principled estimation and uncertainty quantification, suitable for extracting the Markstein number from DNS-like data obtained under controlled flame wrinkling.",
            "answer": "```python\nimport numpy as np\n\ndef weighted_linear_fit(kappa, S_meas, sigma_S):\n    \"\"\"\n    Perform weighted least squares fit of S = a + b * kappa.\n    Returns a, b, and covariance matrix of [a, b].\n    \"\"\"\n    # Design matrix X: first column ones (intercept), second column kappa\n    X = np.column_stack([np.ones_like(kappa), kappa])\n    # Weights: W = diag(1/sigma^2)\n    w = 1.0 / (sigma_S ** 2)\n    W = np.diag(w)\n    # Compute (X^T W X)^-1 and X^T W y\n    XT_W = X.T * w  # broadcasting weights across rows\n    XT_W_X = XT_W @ X\n    XT_W_y = XT_W @ S_meas\n    # Solve for beta = [a, b]\n    cov_beta = np.linalg.inv(XT_W_X)\n    beta = cov_beta @ XT_W_y\n    a, b = beta[0], beta[1]\n    return a, b, cov_beta\n\ndef delta_method_std_LM(a, b, cov_beta, delta_L):\n    \"\"\"\n    Compute standard deviations of L_M = -b/a and M_a = L_M / delta_L via delta method.\n    \"\"\"\n    # Gradient of L_M wrt [a, b]: [b/a^2, -1/a]\n    grad = np.array([b / (a**2), -1.0 / a])\n    var_LM = grad @ (cov_beta @ grad)\n    sigma_LM = np.sqrt(var_LM)\n    sigma_Ma = sigma_LM / delta_L\n    return sigma_LM, sigma_Ma\n\ndef construct_case(A, lam, SL0, LM_true, delta_L, eps1, eps2, sigma0, sigma1, N=21):\n    \"\"\"\n    Construct deterministic dataset based on sinusoidal wrinkling and specified parameters.\n    Returns kappa array, S_meas array, sigma_S array, and delta_L.\n    \"\"\"\n    k = 2.0 * np.pi / lam\n    j = np.arange(N)\n    phi = 2.0 * np.pi * j / N  # radians\n    # Small-slope curvature\n    kappa = -A * (k**2) * np.sin(phi)\n    # Measured S_L with deterministic biases\n    S_meas = SL0 - SL0 * LM_true * kappa + eps1 * np.cos(2.0 * phi) + eps2 * np.sin(3.0 * phi)\n    # Reported standard deviations (heteroskedastic by |kappa|)\n    sigma_S = sigma0 + sigma1 * np.abs(kappa)\n    return kappa, S_meas, sigma_S, delta_L\n\ndef solve():\n    # Define test cases with parameters as specified in the problem statement.\n    test_params = [\n        # Case 1\n        {\n            \"A\": 0.004, \"lam\": 0.10, \"SL0\": 0.40, \"LM_true\": 0.0008, \"delta_L\": 0.0005,\n            \"eps1\": 0.00035, \"eps2\": 0.00015, \"sigma0\": 0.0004, \"sigma1\": 0.00001\n        },\n        # Case 2\n        {\n            \"A\": 0.006, \"lam\": 0.08, \"SL0\": 0.35, \"LM_true\": -0.0003, \"delta_L\": 0.0005,\n            \"eps1\": 0.00030, \"eps2\": -0.00010, \"sigma0\": 0.0005, \"sigma1\": 0.00002\n        },\n        # Case 3\n        {\n            \"A\": 0.001, \"lam\": 0.12, \"SL0\": 0.42, \"LM_true\": 0.0005, \"delta_L\": 0.0004,\n            \"eps1\": 0.00050, \"eps2\": 0.00020, \"sigma0\": 0.0006, \"sigma1\": 0.000005\n        },\n    ]\n\n    results = []\n    for params in test_params:\n        kappa, S_meas, sigma_S, delta_L = construct_case(**params)\n        # Weighted least squares fit\n        a, b, cov_beta = weighted_linear_fit(kappa, S_meas, sigma_S)\n        # Markstein length and number\n        LM_est = -b / a\n        Ma_est = LM_est / delta_L\n        # Uncertainty via delta method\n        sigma_LM, sigma_Ma = delta_method_std_LM(a, b, cov_beta, delta_L)\n        # Collect results: [a (m/s), L_M (m), M_a (-), sigma_LM (m), sigma_Ma (-)]\n        results.append([a, LM_est, Ma_est, sigma_LM, sigma_Ma])\n\n    # Final print statement in the exact required format.\n    # Single line, comma-separated, enclosed in square brackets.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The fundamental properties of laminar flames, including $S_L$, are crucial inputs for advanced turbulent combustion models. The accuracy of these models, therefore, depends directly on the quality of the input data. This problem  demonstrates this practical link by guiding you through an uncertainty propagation analysis within the context of a Flame Surface Density (FSD) model, where you will quantify how experimental errors in measured quantities propagate to affect the final prediction of the filtered reaction rate, a vital consideration for model validation and reliability.",
            "id": "4077662",
            "problem": "A premixed flame is modeled in a filtered framework where the filtered reaction rate of a progress variable is closed using the flame surface density concept. The filtered reaction rate is modeled by the relation $\\tilde{\\dot{\\omega}} = \\rho_{u} S_{L} |\\nabla \\tilde{c}| \\,\\Xi$, where $\\rho_{u}$ is the fresh-gas density, $S_{L}$ is the laminar flame speed, $|\\nabla \\tilde{c}|$ is the magnitude of the filtered progress-variable gradient, and $\\Xi$ is the wrinkling factor that accounts for unresolved flame surface. The Flame Surface Density (FSD), denoted $\\Sigma$, is defined by $\\Sigma = |\\nabla \\tilde{c}| \\,\\Xi$.\n\nSuppose the wrinkling factor $\\Xi$ is estimated from measurements of flame surface density and gradient, $\\Sigma_{m}$ and $g_{m}$, via $\\Xi_{m} = \\Sigma_{m} / g_{m}$. The filtered reaction rate is then estimated using the resolved (true) gradient magnitude $g$ combined with the measured wrinkling factor, $\\tilde{\\dot{\\omega}}_{m} = \\rho_{u} S_{L} g \\,\\Xi_{m}$. Assume small, independent, zero-mean relative standard uncertainties in the measured quantities such that $\\Sigma_{m} = \\Sigma (1 + \\varepsilon_{\\Sigma})$ and $g_{m} = g (1 + \\varepsilon_{g})$, where $\\varepsilon_{\\Sigma}$ and $\\varepsilon_{g}$ have standard deviations $u_{\\Sigma}$ and $u_{g}$, respectively, and are statistically independent.\n\nUsing first-order uncertainty propagation consistent with these definitions and assumptions, derive an expression for the propagated standard uncertainty $u_{\\tilde{\\dot{\\omega}}}$ of the estimated filtered reaction rate $\\tilde{\\dot{\\omega}}_{m}$ in terms of $\\rho_{u}$, $S_{L}$, $\\Sigma$, $u_{\\Sigma}$, and $u_{g}$. Evaluate this uncertainty for the following scientifically plausible parameter values: $\\rho_{u} = 0.28 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $S_{L} = 0.42 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $\\Sigma = 1800 \\,\\mathrm{m}^{-1}$, $u_{\\Sigma} = 0.12$, and $u_{g} = 0.08$. Express the final numerical value of $u_{\\tilde{\\dot{\\omega}}}$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ and round your answer to four significant figures. The final answer must be a single real-valued number.",
            "solution": "The objective is to derive an expression for the standard uncertainty, $u_{\\tilde{\\dot{\\omega}}}$, of the estimated filtered reaction rate, $\\tilde{\\dot{\\omega}}_{m}$, and then to compute its value.\n\nThe estimated filtered reaction rate is given by:\n$$ \\tilde{\\dot{\\omega}}_{m} = \\rho_{u} S_{L} g \\,\\Xi_{m} $$\nThe measured wrinkling factor, $\\Xi_{m}$, is defined as $\\Xi_{m} = \\Sigma_{m} / g_{m}$. Substituting this into the equation for $\\tilde{\\dot{\\omega}}_{m}$:\n$$ \\tilde{\\dot{\\omega}}_{m} = \\rho_{u} S_{L} g \\left( \\frac{\\Sigma_{m}}{g_{m}} \\right) $$\nThe measured quantities $\\Sigma_{m}$ and $g_{m}$ are related to their true values, $\\Sigma$ and $g$, through the given error models, $\\Sigma_{m} = \\Sigma (1 + \\varepsilon_{\\Sigma})$ and $g_{m} = g (1 + \\varepsilon_{g})$. Substituting these into the expression for $\\tilde{\\dot{\\omega}}_{m}$:\n$$ \\tilde{\\dot{\\omega}}_{m} = \\rho_{u} S_{L} g \\frac{\\Sigma (1 + \\varepsilon_{\\Sigma})}{g (1 + \\varepsilon_{g})} $$\nThe true gradient magnitude $g$ cancels out. Recognizing that the true filtered reaction rate is $\\tilde{\\dot{\\omega}}_{\\text{true}} = \\rho_{u} S_{L} \\Sigma$, we can write:\n$$ \\tilde{\\dot{\\omega}}_{m} = \\tilde{\\dot{\\omega}}_{\\text{true}} \\frac{1 + \\varepsilon_{\\Sigma}}{1 + \\varepsilon_{g}} $$\nSince the uncertainties are small, we can use a first-order Taylor series expansion for the term $(1 + \\varepsilon_{g})^{-1} \\approx 1 - \\varepsilon_{g}$. Substituting this approximation:\n$$ \\tilde{\\dot{\\omega}}_{m} \\approx \\tilde{\\dot{\\omega}}_{\\text{true}} (1 + \\varepsilon_{\\Sigma})(1 - \\varepsilon_{g}) $$\nExpanding the product and retaining only terms up to the first order in the small error quantities $\\varepsilon_{\\Sigma}$ and $\\varepsilon_{g}$ (i.e., neglecting the product term $\\varepsilon_{\\Sigma}\\varepsilon_{g}$):\n$$ \\tilde{\\dot{\\omega}}_{m} \\approx \\tilde{\\dot{\\omega}}_{\\text{true}} (1 + \\varepsilon_{\\Sigma} - \\varepsilon_{g}) $$\nThe absolute error in the estimation is $\\delta \\tilde{\\dot{\\omega}}_{m} = \\tilde{\\dot{\\omega}}_{m} - \\tilde{\\dot{\\omega}}_{\\text{true}} \\approx \\tilde{\\dot{\\omega}}_{\\text{true}} (\\varepsilon_{\\Sigma} - \\varepsilon_{g})$. The variance of $\\tilde{\\dot{\\omega}}_{m}$ is the expected value of the squared error:\n$$ \\text{Var}(\\tilde{\\dot{\\omega}}_{m}) \\approx E \\left[ (\\tilde{\\dot{\\omega}}_{\\text{true}} (\\varepsilon_{\\Sigma} - \\varepsilon_{g}))^2 \\right] = (\\tilde{\\dot{\\omega}}_{\\text{true}})^2 E \\left[ (\\varepsilon_{\\Sigma} - \\varepsilon_{g})^2 \\right] $$\nExpanding the squared term and using the given properties that $\\varepsilon_{\\Sigma}$ and $\\varepsilon_{g}$ are independent and have zero mean:\n$$ E \\left[ (\\varepsilon_{\\Sigma} - \\varepsilon_{g})^2 \\right] = E[\\varepsilon_{\\Sigma}^2] - 2E[\\varepsilon_{\\Sigma} \\varepsilon_{g}] + E[\\varepsilon_{g}^2] = u_{\\Sigma}^2 - 0 + u_{g}^2 = u_{\\Sigma}^2 + u_{g}^2 $$\nThe variance of $\\tilde{\\dot{\\omega}}_{m}$ is therefore:\n$$ \\text{Var}(\\tilde{\\dot{\\omega}}_{m}) \\approx (\\tilde{\\dot{\\omega}}_{\\text{true}})^2 (u_{\\Sigma}^2 + u_{g}^2) $$\nThe propagated standard uncertainty, $u_{\\tilde{\\dot{\\omega}}}$, is the square root of the variance. Substituting $\\tilde{\\dot{\\omega}}_{\\text{true}} = \\rho_{u} S_{L} \\Sigma$, we obtain the final symbolic expression:\n$$ u_{\\tilde{\\dot{\\omega}}} = (\\rho_{u} S_{L} \\Sigma) \\sqrt{u_{\\Sigma}^2 + u_{g}^2} $$\n\nWe now evaluate this expression using the given parameter values:\n- $\\rho_{u} = 0.28 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $S_{L} = 0.42 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $\\Sigma = 1800 \\,\\mathrm{m}^{-1}$\n- $u_{\\Sigma} = 0.12$\n- $u_{g} = 0.08$\n\nFirst, we calculate the true reaction rate term, $\\rho_{u} S_{L} \\Sigma$:\n$$ \\rho_{u} S_{L} \\Sigma = (0.28 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}) \\times (0.42 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (1800 \\,\\mathrm{m}^{-1}) = 211.68 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\nNext, we calculate the combined relative uncertainty term, $\\sqrt{u_{\\Sigma}^2 + u_{g}^2}$:\n$$ \\sqrt{u_{\\Sigma}^2 + u_{g}^2} = \\sqrt{(0.12)^2 + (0.08)^2} = \\sqrt{0.0144 + 0.0064} = \\sqrt{0.0208} \\approx 0.14422205 $$\nFinally, we multiply the two parts to find the uncertainty $u_{\\tilde{\\dot{\\omega}}}$:\n$$ u_{\\tilde{\\dot{\\omega}}} = (211.68) \\times (\\sqrt{0.0208}) \\approx (211.68) \\times (0.14422205) \\approx 30.526900 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\nRounding the answer to four significant figures gives:\n$$ u_{\\tilde{\\dot{\\omega}}} \\approx 30.53 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\nThis is the final numerical value for the propagated standard uncertainty of the estimated filtered reaction rate.",
            "answer": "$$\\boxed{30.53}$$"
        }
    ]
}