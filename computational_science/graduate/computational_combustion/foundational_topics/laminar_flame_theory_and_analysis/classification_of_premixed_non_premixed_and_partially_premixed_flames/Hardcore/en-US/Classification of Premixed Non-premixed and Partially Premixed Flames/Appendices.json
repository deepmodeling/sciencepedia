{
    "hands_on_practices": [
        {
            "introduction": "To understand complex flames, we must first master the fundamentals. This exercise guides you through the derivation of the Burke–Schumann solution, a cornerstone of combustion theory that describes an idealized non-premixed (or diffusion) flame. By assuming infinitely fast chemistry, we can isolate the role of transport and derive analytical expressions for the flame's location and thickness, providing a powerful baseline for analyzing more complex systems. ",
            "id": "4012508",
            "problem": "Consider two parallel, coflowing, isothermal streams forming a planar mixing layer aligned with the streamwise coordinate $x$ and varying only in the cross-stream coordinate $y$. The upper stream ($y0$) is a pure fuel with fuel mass fraction $Y_{F}=1$ and oxidizer mass fraction $Y_{O}=0$, while the lower stream ($y0$) is a pure oxidizer with $Y_{O}=1$ and $Y_{F}=0$. Both streams have uniform density, constant transport properties, and equal species diffusivities, and they flow at the same uniform speed $u$ in the $x$-direction. The flow is steady, and the Reynolds number is sufficiently high that axial diffusion is negligible relative to axial convection. Molecular diffusion in the $y$-direction controls transverse mixing. The chemical reaction between fuel and oxidizer is assumed to be infinitely fast, such that the Burke–Schumann approximation (reaction confined to a sheet where stoichiometry is met) is valid. The stoichiometric oxidizer-to-fuel mass ratio is $s0$ and species Lewis numbers are unity.\n\nUnder these assumptions, the mixture fraction $Z(y,x)$ is a conserved scalar obeying the one-dimensional steady convection–diffusion equation\n$$\nu\\,\\frac{\\partial Z}{\\partial x} \\;=\\; D\\,\\frac{\\partial^{2} Z}{\\partial y^{2}},\n$$\nfor $-\\inftyy\\infty$, $x0$, where $D$ is the constant molecular diffusivity. The inflow at $x=0$ is a sharp contact: $Z(y,0)=1$ for $y0$ and $Z(y,0)=0$ for $y0$. In the Burke–Schumann limit with pure streams, the stoichiometric mixture fraction is $Z_{st}=1/(1+s)$, defining the reaction sheet by $Z(y_{st}(x),x)=Z_{st}$. In a non-premixed flame, the flame thickness can be characterized by the local mixture-fraction gradient scale at the sheet,\n$$\n\\delta_{f}(x)\\;=\\;\\left|\\frac{\\partial Z}{\\partial y}\\bigg|_{y=y_{st}(x)}\\right|^{-1},\n$$\nwhich measures the cross-stream length over which $Z$ varies by an $O(1)$ amount near the flame sheet. The maximum temperature in the Burke–Schumann model coincides with the reaction sheet, so the peak location of the temperature field aligns with $y_{st}(x)$.\n\nStarting from the governing equation for $Z(y,x)$ and appropriate initial/boundary conditions, derive the Burke–Schumann solution for the planar diffusion flame in this mixing layer. Then, obtain closed-form analytic expressions for the flame-sheet location $y_{st}(x)$ and the non-premixed flame thickness $\\delta_{f}(x)$ defined above, in terms of $D$, $u$, $x$, and $s$.\n\nExpress the final flame-sheet location and thickness in meters. Provide your final answer as a single row matrix containing, in order, $y_{st}(x)$ and $\\delta_{f}(x)$, each as a closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The user wants me to solve a problem in computational combustion.\n\nHere's my plan:\n1.  **Validate the Problem**:\n    *   **Step 1: Extract Givens**: I'll list all the information provided in the problem statement.\n        *   Geometry: Two parallel, coflowing, isothermal streams. Planar mixing layer.\n        *   Coordinate system: $x$ is streamwise, $y$ is cross-stream.\n        *   Upper stream ($y0$): Pure fuel, $Y_F=1$, $Y_O=0$.\n        *   Lower stream ($y0$): Pure oxidizer, $Y_O=1$, $Y_F=0$.\n        *   Flow properties: Uniform density, constant transport properties, equal species diffusivities ($Le=1$).\n        *   Velocity: Uniform speed $u$ in the $x$-direction for both streams.\n        *   Flow regime: Steady flow, high Reynolds number (axial diffusion negligible).\n        *   Mixing mechanism: Molecular diffusion in the $y$-direction.\n        *   Chemistry: Infinitely fast reaction (Burke–Schumann approximation). Reaction occurs at the stoichiometric sheet.\n        *   Stoichiometry: Stoichiometric oxidizer-to-fuel mass ratio is $s  0$.\n        *   Governing Equation for mixture fraction $Z(y,x)$: $u\\,\\frac{\\partial Z}{\\partial x} \\;=\\; D\\,\\frac{\\partial^{2} Z}{\\partial y^{2}}$ for $-\\inftyy\\infty$, $x0$.\n        *   Initial condition at $x=0$: $Z(y,0)=1$ for $y0$ and $Z(y,0)=0$ for $y0$. This is a step function.\n        *   Definition of stoichiometric mixture fraction: $Z_{st} = 1/(1+s)$.\n        *   Definition of flame-sheet location $y_{st}(x)$: $Z(y_{st}(x), x) = Z_{st}$.\n        *   Definition of flame thickness $\\delta_f(x)$: $\\delta_f(x) = |\\frac{\\partial Z}{\\partial y}|_{y=y_{st}(x)}|^{-1}$.\n        *   Goal: Derive the solution for $Z(y,x)$, then find $y_{st}(x)$ and $\\delta_f(x)$.\n\n    *   **Step 2: Validate Using Extracted Givens**:\n        *   **Scientifically Grounded**: The problem describes a classic model in combustion theory: the Burke–Schumann diffusion flame. The governing equation is a standard convection-diffusion equation, often used to model boundary layers or mixing layers. The assumptions (constant properties, Le=1, infinite-rate chemistry) are standard simplifications to make the problem analytically tractable. The physics is sound.\n        *   **Well-Posed**: The problem provides a parabolic partial differential equation with a well-defined initial condition at $x=0$ and implicit boundary conditions at $y \\to \\pm\\infty$. The domain is specified. The quantities to be derived are clearly defined. A unique, stable solution is expected.\n        *   **Objective**: The language is precise and technical. No subjective statements.\n        *   **No other flaws**: The problem is complete, consistent, realistic within its modeling framework, and not trivial. It requires solving a PDE and then performing some calculations based on that solution. It is directly related to the classification of non-premixed flames.\n\n    *   **Step 3: Verdict and Action**: The problem is valid. I will proceed to solve it.\n\n2.  **Solve the Problem**:\n    *   **Part 1: Solve the PDE for $Z(y,x)$**.\n        *   The PDE is $u \\frac{\\partial Z}{\\partial x} = D \\frac{\\partial^2 Z}{\\partial y^2}$.\n        *   This equation is analogous to the 1D transient heat conduction equation, $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial y^2}$, if we make the substitution $t = x/u$ and $\\alpha = D$.\n        *   The initial condition is $Z(y,0) = H(y)$, where $H(y)$ is the Heaviside step function ($1$ for $y0$, $0$ for $y0$).\n        *   The boundary conditions are $Z(y \\to \\infty, x) = 1$ and $Z(y \\to -\\infty, x) = 0$.\n        *   The standard solution to the heat equation for an initial step function is given by the error function.\n        *   Let's introduce a similarity variable $\\eta = y / \\sqrt{4Dx/u}$.\n        *   The PDE can be transformed into an ODE. Let's try this. Assume $Z(y,x) = f(\\eta)$.\n        *   $\\frac{\\partial Z}{\\partial x} = \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial x} = f'(\\eta) \\cdot y \\left(-\\frac{1}{2}\\right) (4Dx/u)^{-3/2} (4D/u) = f'(\\eta) \\cdot \\frac{\\eta \\sqrt{4Dx/u}}{\\sqrt{4Dx/u}} \\left(-\\frac{1}{2}\\right) \\frac{1}{x} = -f'(\\eta) \\frac{\\eta}{2x}$.\n        *   $\\frac{\\partial Z}{\\partial y} = \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial y} = f'(\\eta) \\frac{1}{\\sqrt{4Dx/u}}$.\n        *   $\\frac{\\partial^2 Z}{\\partial y^2} = f''(\\eta) \\frac{1}{4Dx/u}$.\n        *   Substitute into the PDE: $u \\left( -f'(\\eta) \\frac{\\eta}{2x} \\right) = D \\left( f''(\\eta) \\frac{u}{4Dx} \\right)$.\n        *   $-u f'(\\eta) \\frac{\\eta}{2x} = D f''(\\eta) \\frac{u}{4Dx}$.\n        *   Multiply by $4Dx/u$: $-2D \\eta f'(\\eta) = D f''(\\eta)$.\n        *   $f''(\\eta) + 2\\eta f'(\\eta) = 0$.\n        *   This is a second-order linear ODE for $f(\\eta)$.\n        *   Let $g(\\eta) = f'(\\eta)$. The equation becomes $g' + 2\\eta g = 0$.\n        *   This is separable: $\\frac{dg}{g} = -2\\eta d\\eta$.\n        *   Integrate: $\\ln(g) = -\\eta^2 + C_1$.\n        *   $g(\\eta) = A \\exp(-\\eta^2)$, where $A = \\exp(C_1)$.\n        *   So, $f'(\\eta) = A \\exp(-\\eta^2)$.\n        *   Integrate again: $f(\\eta) = \\int A \\exp(-\\eta^2) d\\eta + B$.\n        *   The integral of $\\exp(-\\eta^2)$ is related to the error function, $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-t^2) dt$.\n        *   So, $\\int \\exp(-\\eta^2) d\\eta = \\frac{\\sqrt{\\pi}}{2} \\text{erf}(\\eta) + C_2$.\n        *   $f(\\eta) = A \\frac{\\sqrt{\\pi}}{2} \\text{erf}(\\eta) + B$. Let's rename constants: $f(\\eta) = C_1 \\text{erf}(\\eta) + C_2$.\n        *   Now apply boundary conditions in terms of $\\eta$.\n        *   At $y \\to \\infty$, $\\eta \\to \\infty$. We must have $Z \\to 1$.\n        *   So, $1 = C_1 \\text{erf}(\\infty) + C_2 = C_1(1) + C_2$.\n        *   At $y \\to -\\infty$, $\\eta \\to -\\infty$. We must have $Z \\to 0$.\n        *   So, $0 = C_1 \\text{erf}(-\\infty) + C_2 = C_1(-1) + C_2$.\n        *   We have a system of two equations:\n            1.  $C_1 + C_2 = 1$\n            2.  $-C_1 + C_2 = 0 \\implies C_1 = C_2$.\n        *   Substitute $C_1 = C_2$ into the first equation: $2C_1 = 1 \\implies C_1 = 1/2$.\n        *   So, $C_1 = C_2 = 1/2$.\n        *   The solution is $f(\\eta) = \\frac{1}{2} \\text{erf}(\\eta) + \\frac{1}{2} = \\frac{1}{2} [1 + \\text{erf}(\\eta)]$.\n        *   Substituting back $\\eta = y / \\sqrt{4Dx/u}$, we get the solution for the mixture fraction:\n            $$ Z(y,x) = \\frac{1}{2} \\left[ 1 + \\text{erf}\\left(\\frac{y}{\\sqrt{4Dx/u}}\\right) \\right] $$\n        *   Let's check the initial condition. As $x \\to 0^+$, for $y0$, the argument of erf goes to $+\\infty$, so erf $\\to 1$, $Z \\to \\frac{1}{2}(1+1)=1$. For $y0$, the argument goes to $-\\infty$, so erf $\\to -1$, $Z \\to \\frac{1}{2}(1-1)=0$. This matches the initial condition. This is the correct solution.\n\n    *   **Part 2: Find the flame-sheet location $y_{st}(x)$**.\n        *   The flame-sheet is defined by $Z(y_{st}(x), x) = Z_{st}$.\n        *   $Z_{st}$ is given as $1/(1+s)$.\n        *   So, we set our solution equal to $Z_{st}$:\n            $$ \\frac{1}{1+s} = \\frac{1}{2} \\left[ 1 + \\text{erf}\\left(\\frac{y_{st}(x)}{\\sqrt{4Dx/u}}\\right) \\right] $$\n        *   Now, solve for $y_{st}(x)$.\n        *   $\\frac{2}{1+s} = 1 + \\text{erf}\\left(\\frac{y_{st}(x)}{\\sqrt{4Dx/u}}\\right)$.\n        *   $\\text{erf}\\left(\\frac{y_{st}(x)}{\\sqrt{4Dx/u}}\\right) = \\frac{2}{1+s} - 1 = \\frac{2 - (1+s)}{1+s} = \\frac{1-s}{1+s}$.\n        *   Apply the inverse error function, $\\text{erf}^{-1}$ or $\\text{arcerf}$.\n        *   $\\frac{y_{st}(x)}{\\sqrt{4Dx/u}} = \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$.\n        *   Finally, isolate $y_{st}(x)$:\n            $$ y_{st}(x) = \\sqrt{\\frac{4Dx}{u}} \\, \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right) $$\n        *   This is the expression for the flame-sheet location. The argument of $\\text{erf}^{-1}$ is between $-1$ and $1$ as long as $s  0$. If $s=1$ (stoichiometric ratio of 1), the argument is 0, $\\text{erf}^{-1}(0)=0$, so $y_{st}=0$. This makes sense: equal mass stoichiometry means the flame sits at the centerline. If $s  1$ (more oxidizer needed), argument is negative, $y_{st}0$ (flame moves into oxidizer stream). If $s  1$ (less oxidizer needed), argument is positive, $y_{st}0$ (flame moves into fuel stream). This is physically consistent.\n\n    *   **Part 3: Find the flame thickness $\\delta_f(x)$**.\n        *   The definition is $\\delta_f(x) = |\\frac{\\partial Z}{\\partial y}|_{y=y_{st}(x)}|^{-1}$.\n        *   First, we need to calculate the derivative $\\frac{\\partial Z}{\\partial y}$.\n        *   $Z(y,x) = \\frac{1}{2} \\left[ 1 + \\text{erf}\\left(\\frac{y}{\\sqrt{4Dx/u}}\\right) \\right]$.\n        *   Let $\\xi = \\frac{y}{\\sqrt{4Dx/u}}$.\n        *   $\\frac{\\partial Z}{\\partial y} = \\frac{\\partial Z}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial y}$.\n        *   $\\frac{d}{dz} \\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\exp(-z^2)$.\n        *   $\\frac{\\partial Z}{\\partial \\xi} = \\frac{1}{2} \\frac{d}{d\\xi} \\text{erf}(\\xi) = \\frac{1}{2} \\frac{2}{\\sqrt{\\pi}} \\exp(-\\xi^2) = \\frac{1}{\\sqrt{\\pi}} \\exp(-\\xi^2)$.\n        *   $\\frac{\\partial \\xi}{\\partial y} = \\frac{1}{\\sqrt{4Dx/u}}$.\n        *   So, $\\frac{\\partial Z}{\\partial y} = \\frac{1}{\\sqrt{\\pi}} \\exp\\left(-\\left(\\frac{y}{\\sqrt{4Dx/u}}\\right)^2\\right) \\cdot \\frac{1}{\\sqrt{4Dx/u}}$.\n        *   $\\frac{\\partial Z}{\\partial y} = \\frac{1}{\\sqrt{4\\pi Dx/u}} \\exp\\left(-\\frac{y^2 u}{4Dx}\\right)$.\n        *   Now, we need to evaluate this derivative at $y=y_{st}(x)$.\n        *   At the flame sheet, we know that $\\frac{y_{st}(x)}{\\sqrt{4Dx/u}} = \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$.\n        *   Let's call $C_s = \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$.\n        *   Then $\\frac{y_{st}^2 u}{4Dx} = \\left(\\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)\\right)^2 = C_s^2$.\n        *   Substitute this into the expression for the derivative:\n            $$ \\left.\\frac{\\partial Z}{\\partial y}\\right|_{y=y_{st}} = \\frac{1}{\\sqrt{4\\pi Dx/u}} \\exp\\left( - \\left[\\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)\\right]^2 \\right) $$\n        * The problem defines $\\delta_f(x)$ as the inverse of the absolute value of this quantity. Since the expression is always positive (exponential of a real number is positive, square root is positive), the absolute value is redundant.\n            $$ \\delta_f(x) = \\left( \\frac{1}{\\sqrt{4\\pi Dx/u}} \\exp\\left( - \\left[\\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)\\right]^2 \\right) \\right)^{-1} $$\n        *   Inverting this gives:\n            $$ \\delta_f(x) = \\sqrt{\\frac{4\\pi Dx}{u}} \\exp\\left( \\left[\\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)\\right]^2 \\right) $$\n        *   This is the expression for the flame thickness.\n\n3.  **Finalize the Answer**:\n    *   The problem asks for $y_{st}(x)$ and $\\delta_f(x)$ as a single row matrix.\n    *   $y_{st}(x) = \\sqrt{\\frac{4Dx}{u}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$.\n    *   The problem asks to express the final answer in meters. The given variables are $D$ (m²/s), $u$ (m/s), $x$ (m). The combination $\\sqrt{Dx/u}$ has units of $\\sqrt{(m^2/s) \\cdot m / (m/s)} = \\sqrt{m^2} = m$. The inverse error function is dimensionless. So $y_{st}$ is in meters. The factor $\\sqrt{4\\pi D x / u}$ also has units of meters. The exponential term is dimensionless. So $\\delta_f$ is in meters. The units are already correct.\n    *   The prompt specifies using standard LaTeX notation, specifically `\\arcerf` is not a standard LaTeX function. I will use `\\text{erf}^{-1}`. The problem statement itself used `erf^{-1}` in the prompt's `internal thought` block, but the problem's own text does not specify. I will check the rules in the prompt. \"Inverse Trigonometric Functions: Use `\\arcsin`, `\\arccos`, `\\arctan`, etc.\" and \"Inverse Hyperbolic Functions: Use `\\arcsinh`, `\\arccosh`, `\\arctanh`.\" This suggests an `arc` prefix is preferred. However, `arcerf` is not universally standard. `erf^{-1}` is unambiguous. Let me stick to `\\text{erf}^{-1}` as it's clear and was used in the problem statement itself, in my scratchpad area. This seems safer than inventing a command. The prompt's example is for trig/hyperbolic functions. Let's write it as `\\text{erf}^{-1}`. This is a textual operator.\n\n    *   The final answer should be in a `pmatrix`.\n    *   First element: $y_{st}(x) = 2\\sqrt{\\frac{Dx}{u}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$.\n    *   Second element: $\\delta_f(x) = 2\\sqrt{\\frac{\\pi Dx}{u}} \\exp\\left( \\left(\\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)\\right)^2 \\right)$.\n    *   The prompt asks to express the final flame-sheet location and thickness in meters. The derived expressions are already dimensionally correct as meters, assuming the input variables $D, x, u$ are in SI units. No numerical values are given, so the answer must be symbolic.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 2\\sqrt{\\frac{Dx}{u}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)  2\\sqrt{\\frac{\\pi Dx}{u}} \\exp\\left(\\left(\\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)\\right)^{2}\\right) \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Real-world combustion is rarely as simple as the Burke–Schumann model suggests, especially when heat and mass diffuse at different rates. This practice delves into the crucial concept of preferential diffusion ($Le_i \\neq 1$) by examining its effect on a triple flame, a complex structure where premixed and non-premixed branches coexist. By reasoning through the asymmetric behavior of the flame's wings, you will develop a deeper appreciation for how transport properties influence flame shape and why sophisticated diagnostic tools are needed to classify partially premixed regimes. ",
            "id": "4012500",
            "problem": "A two-dimensional, low-Mach-number computational simulation is performed of a steady mixing layer between a fuel stream and an oxidizer stream, yielding a stable triple flame composed of a central diffusion branch and two premixed wings. The fuel stream enters from $x0$ with mass fraction $Y_F \\approx 1$ and negligible oxidizer, and the oxidizer stream enters from $x0$ with oxidizer mass fraction $Y_{O_2} \\approx 0.23$ and negligible fuel. The temperature of both streams is $T_0$ and the pressure is approximately constant. The mixture fraction $z$ is computed using a standard linear combination of species (Bilger mixture fraction). The stoichiometric mixture fraction is $z_{st} \\in (0,1)$, and the local scalar dissipation rate is moderate, such that a triple flame exists.\n\nPreferential diffusion is present: the fuel has Lewis number $Le_F = \\alpha/D_F = 0.8$ and the oxidizer has Lewis number $Le_O = \\alpha/D_O = 1.4$, where $\\alpha$ is thermal diffusivity and $D_i$ is the species mass diffusivity. The premixed wings are observed on the fuel-lean side ($\\phi  1$) and fuel-rich side ($\\phi  1$) of the diffusion branch. A progress variable $c$ is defined from products and reactants to parameterize the reaction progress, with $c \\in [0,1]$.\n\nStarting from the species transport equations, the energy equation, and the definitions of $Le_i$, $z$, $z_{st}$, and $c$, reason about the influence of differential species diffusivities on the curvature of the premixed wings and their attachment relative to the $z=z_{st}$ surface. Furthermore, consider how these effects impact the classification of the triple flame’s branches as premixed versus diffusion-dominated within a computational framework that uses $z$ and $c$ fields for diagnostics.\n\nWhich of the following statements are correct?\n\nA. With $Le_F  1$ and $Le_O  1$, the fuel-lean premixed wing tends to experience an increased local burning velocity under positive curvature and stretch, leading to a wing that curves convex toward the oxidizer stream and attaches upstream of the $z=z_{st}$ surface relative to the flow, while the diffusion branch remains near $z=z_{st}$.\n\nB. Under the same $Le_F  1$ and $Le_O  1$ conditions, enhanced diffusion of fuel relative to heat causes the fuel-rich premixed wing to curve strongly toward the fuel stream and attach upstream of $z=z_{st}$, because the rich wing’s burning rate is boosted by preferential fuel transport.\n\nC. In the special case $Le_F = Le_O = 1$, differential diffusion effects vanish; the triple flame’s premixed wings exhibit approximately symmetric curvature and attachment distances on the lean and rich sides, and the diffusion branch aligns closely with $z=z_{st}$, simplifying branch identification.\n\nD. When $Le_O \\gg 1$ and $Le_F \\ll 1$, the diffusion branch can masquerade as a premixed branch on the oxidizer side because heat diffuses faster than oxygen, so identifying branches using only the $z$ field always fails, even if additional progress-variable information $c$ is available.\n\nE. If $Le_F \\ne Le_O$, the Bilger mixture fraction $z$ is not strictly a conserved scalar of the reactive-diffusive system, so locating the diffusion branch by $z=z_{st}$ alone can be biased; a robust computational classification compares the orientation of gradients, with the diffusion branch characterized by $\\nabla c$ approximately colinear with $\\nabla z$ near peak heat release, whereas the premixed wings have reaction zones where $c$ varies significantly away from $z=z_{st}$ and $\\nabla c$ is not aligned with $\\nabla z$.",
            "solution": "The problem statement is a valid description of a scenario in computational combustion. It is scientifically grounded, well-posed, objective, and contains sufficient information for a conceptual analysis.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- Simulation: Two-dimensional ($2$D), low-Mach-number computational simulation.\n- Flow: Steady mixing layer between a fuel stream and an oxidizer stream.\n- Flame Structure: Stable triple flame composed of a central diffusion branch and two premixed wings.\n- Inlet Conditions:\n    - Fuel stream: for $x0$, mass fraction $Y_F \\approx 1$, negligible oxidizer.\n    - Oxidizer stream: for $x0$, oxidizer mass fraction $Y_{O_2} \\approx 0.23$, negligible fuel.\n    - Temperature of streams: $T_0$.\n    - Pressure: Approximately constant.\n- Definitions  Parameters:\n    - Mixture fraction: $z$, Bilger definition.\n    - Stoichiometric mixture fraction: $z_{st} \\in (0,1)$.\n    - Scalar dissipation rate: moderate.\n    - Preferential diffusion is present.\n    - Fuel Lewis number: $Le_F = \\alpha/D_F = 0.8$.\n    - Oxidizer Lewis number: $Le_O = \\alpha/D_O = 1.4$.\n    - $\\alpha$ is thermal diffusivity, $D_i$ is species mass diffusivity.\n    - Premixed wings are on the fuel-lean side ($\\phi  1$) and fuel-rich side ($\\phi  1$).\n    - Progress variable: $c \\in [0,1]$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically sound. The concept of a triple flame in a mixing layer is a cornerstone of combustion theory. The use of mixture fraction ($z$), progress variable ($c$), Lewis numbers ($Le_i$), and scalar dissipation rate are standard in the analysis of non-premixed and partially premixed combustion. The provided Lewis numbers ($Le_F = 0.8$ for a light fuel, $Le_O = 1.4$ for oxygen) are physically realistic. The problem is well-posed for a conceptual analysis, asking for reasoning based on established physical principles rather than a numerical solution. The language is objective and the setup is self-contained.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to the solution.\n\n**Derivation from First Principles**\n\nThe problem addresses the structure of a triple flame under conditions of preferential diffusion ($Le_i \\neq 1$) and its classification in a computational context.\n\n1.  **Triple Flame Structure**: A triple flame consists of three branches meeting at a \"triple point\": a fuel-rich premixed wing, a fuel-lean premixed wing, and a trailing diffusion flame. The premixed wings propagate into the unburnt mixture, initiating combustion, while the diffusion flame consumes the remaining reactants in the wake.\n\n2.  **Lewis Number and Preferential Diffusion**: The Lewis number, $Le_i = \\alpha/D_i$, compares heat diffusion to mass diffusion of species $i$. Its effect is most pronounced on premixed flames subjected to stretch and curvature. The relevant Lewis number is that of the deficient reactant.\n    - If $Le_{deficient}  1$, the deficient reactant diffuses faster than heat. In regions of positive curvature (flame convex toward reactants), the reactant focuses into the reaction zone more effectively than heat diffuses out. This leads to a super-adiabatic flame temperature, increasing the local burning velocity.\n    - If $Le_{deficient}  1$, the deficient reactant diffuses slower than heat. Positive curvature leads to a sub-adiabatic temperature and a decreased burning velocity.\n\n3.  **Application to the Premixed Wings**:\n    - **Fuel-Lean Wing ($\\phi  1$)**: The deficient reactant is fuel. Given $Le_F = 0.8  1$. This wing will be strengthened by positive curvature and stretch. Its propagation speed will increase, allowing it to move further upstream into the flow.\n    - **Fuel-Rich Wing ($\\phi  1$)**: The deficient reactant is oxidizer. Given $Le_O = 1.4  1$. This wing will be weakened by positive curvature and stretch. Its propagation speed will decrease, causing it to be pushed downstream relative to the lean wing.\n    - This results in an asymmetric triple flame, with the lean wing leading and the rich wing trailing.\n\n4.  **Mixture Fraction ($z$) and Progress Variable ($c$)**:\n    - The mixture fraction $z$ is a measure of the local fuel-to-oxidizer ratio, originating from the unburnt streams. Its transport equation is $\\rho \\frac{Dz}{Dt} = \\nabla \\cdot (\\rho D \\nabla z)$. For this to be a conserved scalar (no source term), all species must have the same mass diffusivity $D$. When $Le_i \\neq 1$, it implies $D_i \\neq \\alpha$, and typically $D_F \\neq D_O$. The Bilger mixture fraction definition minimizes chemical source terms, but a diffusive source term remains if Lewis numbers are not all unity. Consequently, $z$ is not a strictly conserved scalar.\n    - The progress variable $c$ tracks the conversion from reactants ($c=0$) to products ($c=1$). The reaction zone is characterized by a large gradient, $\\nabla c$.\n    - **Flame Classification**: The relationship between the gradients of $z$ and $c$ provides a robust diagnostic.\n        - In a **diffusion flame**, reaction occurs along the mixing interface where $z \\approx z_{st}$. Reactants diffuse towards this interface. The gradient of mixture fraction, $\\nabla z$, is normal to this interface. The reaction progress also occurs across this interface, so $\\nabla c$ is also normal to it. Thus, $\\nabla z$ and $\\nabla c$ are largely colinear.\n        - In a **premixed flame**, the reaction front propagates into a mixture of uniform composition. Therefore, $z$ is nearly constant across the front, meaning $\\nabla z \\approx 0$. The reaction progresses across the front, so $\\nabla c$ is large. In this case, $\\nabla z$ and $\\nabla c$ are not aligned (they are nearly orthogonal).\n\n**Option-by-Option Analysis**\n\n**A. With $Le_F  1$ and $Le_O  1$, the fuel-lean premixed wing tends to experience an increased local burning velocity under positive curvature and stretch, leading to a wing that curves convex toward the oxidizer stream and attaches upstream of the $z=z_{st}$ surface relative to the flow, while the diffusion branch remains near $z=z_{st}$.**\nThe fuel-lean wing is deficient in fuel. With $Le_F=0.8  1$, its burning velocity is indeed increased by the positive curvature (convex towards reactants, i.e., the oxidizer stream) characteristic of a V-flame tip. This increased propagation speed causes the entire flame structure, including the triple point, to stabilize further upstream in the flow compared to a case with $Le_F=1$. The description of the flame curving convexly toward the oxidizer stream is the correct geometry. The claim that the diffusion branch remains \"near\" $z=z_{st}$ is a reasonable approximation, though small deviations are expected. The core physical description of the lean wing's behavior is accurate.\n**Verdict: Correct.**\n\n**B. Under the same $Le_F  1$ and $Le_O  1$ conditions, enhanced diffusion of fuel relative to heat causes the fuel-rich premixed wing to curve strongly toward the fuel stream and attach upstream of $z=z_{st}$, because the rich wing’s burning rate is boosted by preferential fuel transport.**\nThe fuel-rich wing ($\\phi  1$) is deficient in oxidizer, not fuel. Its behavior is primarily governed by the oxidizer Lewis number, $Le_O = 1.4  1$. Since $Le_O  1$, the burning rate of the rich wing is *decreased* by positive curvature and stretch, not boosted. The reasoning provided is flawed as it references the Lewis number of the excess reactant (fuel) rather than the deficient one (oxidizer).\n**Verdict: Incorrect.**\n\n**C. In the special case $Le_F = Le_O = 1$, differential diffusion effects vanish; the triple flame’s premixed wings exhibit approximately symmetric curvature and attachment distances on the lean and rich sides, and the diffusion branch aligns closely with $z=z_{st}$, simplifying branch identification.**\nIf all Lewis numbers are unity, all species diffuse at the same rate as heat. This is the definition of vanishing differential diffusion. In this idealized case, the primary source of thermal-diffusive asymmetry between the lean and rich wings is eliminated. This leads to approximately symmetric flame behavior, assuming the underlying chemical kinetics do not introduce a strong asymmetry. Furthermore, with $Le_i=1$, the mixture fraction $z$ becomes a truly conserved scalar, and the peak reaction rate of the diffusion branch is expected to align precisely with the $z=z_{st}$ isosurface. This statement accurately describes the standard theoretical baseline case.\n**Verdict: Correct.**\n\n**D. When $Le_O \\gg 1$ and $Le_F \\ll 1$, the diffusion branch can masquerade as a premixed branch on the oxidizer side because heat diffuses faster than oxygen, so identifying branches using only the $z$ field always fails, even if additional progress-variable information $c$ is available.**\nA diffusion branch is structurally defined by the simultaneous mixing and reaction of fuel and oxidizer. A premixed branch involves the propagation of a flame into a pre-existing mixture. Extreme Lewis numbers will distort the flame structure but will not change a diffusion branch into a premixed branch. The claim that identification \"always fails\" even when both $z$ and $c$ are available is false. The combined use of $z$ and $c$ fields, particularly an analysis of their gradients as described in option E, provides a robust method for distinguishing between these modes of combustion, regardless of Lewis number effects.\n**Verdict: Incorrect.**\n\n**E. If $Le_F \\ne Le_O$, the Bilger mixture fraction $z$ is not strictly a conserved scalar of the reactive-diffusive system, so locating the diffusion branch by $z=z_{st}$ alone can be biased; a robust computational classification compares the orientation of gradients, with the diffusion branch characterized by $\\nabla c$ approximately colinear with $\\nabla z$ near peak heat release, whereas the premixed wings have reaction zones where $c$ varies significantly away from $z=z_{st}$ and $\\nabla c$ is not aligned with $\\nabla z$.**\nThis statement is a precise and accurate summary of advanced flame diagnostics. When $Le_i \\neq 1$, the mixture fraction is not conserved, and the flame's location can deviate from the $z=z_{st}$ isosurface. The proposed classification method based on the relative orientation of the gradients $\\nabla c$ and $\\nabla z$ is a standard, physically-grounded technique in computational combustion. It correctly captures the fundamental distinction: in diffusion flames, reaction and mixing are spatially coupled (colinear gradients), while in premixed flames, reaction occurs across a front of relatively uniform mixture (orthogonal gradients). This provides a robust way to partition the flame into its constituent branches.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "Bridging theory and large-scale simulation requires powerful modeling techniques, and the laminar flamelet model is chief among them. In this final practice, you will move from conceptual analysis to computational implementation by building and using a steady laminar flamelet manifold. This hands-on exercise involves numerically solving the fundamental reaction-diffusion balance to generate a look-up table, which you will then use to classify local burning regimes based on mixture fraction $Z$, progress variable $c$, and scalar dissipation rate $\\chi$, mirroring advanced practices in computational fluid dynamics. ",
            "id": "4012490",
            "problem": "You are tasked with constructing a simplified but scientifically consistent steady laminar flamelet manifold for methane–air in mixture-fraction space and then using this manifold to classify local burning regimes based on the mixture fraction and a progress variable. Work entirely in the mixture fraction coordinate $Z \\in [0,1]$ and assume unity Lewis number and constant density. The objective is to reason from fundamental definitions and the steady flamelet balance to design a numerically robust algorithm that is implementable and testable.\n\nFundamental base and core definitions to use:\n- The Bilger mixture fraction $Z$ is a conserved scalar that parameterizes local composition between pure oxidizer ($Z=0$) and pure fuel ($Z=1$). For methane–air, the stoichiometric mixture fraction is approximately $Z_{st} = 0.055$.\n- The progress variable $c$ is a bounded scalar, $c \\in [0,1]$, that monotonically increases with conversion of reactants to products. A common definition in combustion modeling is $c = (Y_{CO_2} + Y_{H_2O} + Y_{CO}) / (Y_{CO_2}^{eq} + Y_{H_2O}^{eq} + Y_{CO}^{eq})$, but here you will model $c$ via a reaction-diffusion balance in mixture-fraction space.\n- The steady flamelet equation in mixture-fraction coordinates for unity Lewis number and constant density is a second-order balance between diffusion and chemistry,\n$$\n\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z) = 0,\n$$\nwhere $\\chi$ is the scalar dissipation rate (with units of $\\text{s}^{-1}$) that quantifies molecular mixing intensity along $Z$, and $\\dot{\\omega}_c$ is a source term representing chemical conversion.\n\nModeling assumptions to make the problem computationally tractable while remaining scientifically plausible:\n- Use a localized reaction source centered at $Z_{st}$ to represent the methane–air diffusion flame reaction zone,\n$$\n\\dot{\\omega}_c(c,Z;\\chi) = k_0 \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma^2}\\right) \\, c(1-c) \\, \\max\\!\\left(0, 1 - \\frac{\\chi}{\\chi_{crit}}\\right),\n$$\nwith $k_0$ an effective chemical rate constant, $\\sigma$ the width of the reaction zone in mixture-fraction space, and $\\chi_{crit}$ the critical scalar dissipation rate above which the non-premixed flamelet extinguishes. Assume $Z_{st} = 0.055$, $k_0 = 60$ (in $\\text{s}^{-1}$), $\\sigma = 0.02$ (dimensionless in $Z$), and $\\chi_{crit} = 25$ (in $\\text{s}^{-1}$).\n- Impose Dirichlet boundary conditions $c(0) = 0$ and $c(1) = 0$, representing pure-oxidizer and pure-fuel streams with zero progress at the boundaries.\n- To connect $c$ to temperature for physical plausibility, use an adiabatic mapping\n$$\nT(Z,c) = T_u + c \\left[T_b(Z) - T_u\\right], \\quad T_b(Z) = T_u + \\Delta T_{max} \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma_T^2}\\right),\n$$\nwith $T_u = 300$ (Kelvin), $\\Delta T_{max} = 1920$ (Kelvin), and $\\sigma_T = 0.04$. This temperature is not required in the final output but is part of the physically grounded manifold.\n\nNumerical construction of the manifold:\n- For each scalar dissipation rate in the set $\\{\\chi_1, \\chi_2, \\chi_3\\} = \\{5, 10, 30\\}$ (in $\\text{s}^{-1}$), solve the steady flamelet equation on a uniform grid in $Z \\in [0,1]$ by pseudo-time marching to steady state using an implicit treatment of diffusion and an explicit treatment of reaction. Let the spatial grid have at least $N = 201$ points, and time-march with a stable step until the infinity norm of the update is below $10^{-8}$ or until a maximum iteration count is reached. The resulting manifold is $c(Z;\\chi)$ tabulated across $Z$ for each $\\chi$.\n\nClassification task based on the manifold:\n- For a set of local states characterized by $(\\chi, Z, c_{meas})$, where $c_{meas}$ is a measured or predicted local progress variable, classify the burning regime using the manifold value $c_{ref} = c(Z;\\chi)$ evaluated by interpolation. Use the following thresholds and tolerances:\n  - Progress threshold $c_{th} = 0.05$,\n  - Stoichiometric proximity $\\delta_Z = 0.02$,\n  - Consistency tolerance $tol_c = 0.10$.\n- The categorical classification rules are:\n  1. If $c_{ref}  c_{th}$ and $\\chi \\ge \\chi_{crit}$ and $c_{meas}  c_{th}$, classify as code $4$ (extinguished non-premixed flamelet).\n  2. Else if $c_{ref} \\ge c_{th}$ and $|c_{meas} - c_{ref}| \\le tol_c$ and $|Z - Z_{st}| \\le \\delta_Z$, classify as code $1$ (non-premixed flamelet burning).\n  3. Else if $c_{meas} \\ge c_{th}$ and $|Z - Z_{st}| \\le \\delta_Z$, classify as code $2$ (partially premixed burning).\n  4. Else if $c_{meas} \\ge c_{th}$ and $|Z - Z_{st}|  \\delta_Z$, classify as code $3$ (premixed burning).\n  5. Else classify as code $0$ (unburnt or inert mixture).\n- These rules embody the physical idea that a non-premixed flame burns near $Z_{st}$ and matches the flamelet manifold, partially premixed burning occurs near $Z_{st}$ but deviates from the non-premixed flamelet value, and premixed burning occurs away from $Z_{st}$ with significant progress.\n\nTest suite:\nUse the following seven test cases, each a triple $(\\chi, Z, c_{meas})$ with $\\chi$ in $\\text{s}^{-1}$ and dimensionless $Z$ and $c_{meas}$:\n- Case A: $(\\chi, Z, c_{meas}) = (10, 0.055, 0.80)$,\n- Case B: $(\\chi, Z, c_{meas}) = (10, 0.10, 0.60)$,\n- Case C: $(\\chi, Z, c_{meas}) = (10, 0.070, 0.40)$,\n- Case D: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.00)$,\n- Case E: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.50)$,\n- Case F: $(\\chi, Z, c_{meas}) = (5, 0.00, 0.00)$,\n- Case G: $(\\chi, Z, c_{meas}) = (5, 1.00, 0.00)$.\n\nFinal output format:\nYour program should produce a single line of output containing the classification codes for the seven cases as a comma-separated list enclosed in square brackets (for example, $\"[1,3,2,4,3,0,0]\"$). No additional text should be printed. All physical units have been specified in their respective definitions; the output itself is dimensionless integer codes.",
            "solution": "The problem statement is subjected to a rigorous validation procedure before a solution is attempted.\n\n### Step 1: Extract Givens\n\n- **Scalar Variables and Coordinates**:\n  - Mixture fraction: $Z \\in [0,1]$\n  - Progress variable: $c \\in [0,1]$\n- **Physical Constants and Parameters**:\n  - Stoichiometric mixture fraction: $Z_{st} = 0.055$\n  - Effective chemical rate constant: $k_0 = 60 \\text{ s}^{-1}$\n  - Reaction zone width in $Z$-space: $\\sigma = 0.02$\n  - Critical scalar dissipation rate: $\\chi_{crit} = 25 \\text{ s}^{-1}$\n  - Scalar dissipation rate test set: $\\{\\chi_1, \\chi_2, \\chi_3\\} = \\{5, 10, 30\\} \\text{ s}^{-1}$\n  - Temperature mapping parameters: $T_u = 300 \\text{ K}$, $\\Delta T_{max} = 1920 \\text{ K}$, $\\sigma_T = 0.04$\n- **Governing Equation (Steady Laminar Flamelet)**:\n  - $\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z) = 0$\n- **Reaction Source Term Model**:\n  - $\\dot{\\omega}_c(c,Z;\\chi) = k_0 \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma^2}\\right) \\, c(1-c) \\, \\max\\!\\left(0, 1 - \\frac{\\chi}{\\chi_{crit}}\\right)$\n- **Boundary Conditions**:\n  - Dirichlet conditions: $c(0) = 0$ and $c(1) = 0$\n- **Numerical Parameters**:\n  - Spatial grid points: $N \\ge 201$\n  - Convergence tolerance for pseudo-time marching: infinity norm of update $ 10^{-8}$\n- **Classification Parameters**:\n  - Progress threshold: $c_{th} = 0.05$\n  - Stoichiometric proximity: $\\delta_Z = 0.02$\n  - Consistency tolerance: $tol_c = 0.10$\n- **Classification Rules**:\n  1. If $c_{ref}  c_{th}$ and $\\chi \\ge \\chi_{crit}$ and $c_{meas}  c_{th}$, classify as code $4$.\n  2. Else if $c_{ref} \\ge c_{th}$ and $|c_{meas} - c_{ref}| \\le tol_c$ and $|Z - Z_{st}| \\le \\delta_Z$, classify as code $1$.\n  3. Else if $c_{meas} \\ge c_{th}$ and $|Z - Z_{st}| \\le \\delta_Z$, classify as code $2$.\n  4. Else if $c_{meas} \\ge c_{th}$ and $|Z - Z_{st}|  \\delta_Z$, classify as code $3$.\n  5. Else classify as code $0$.\n- **Test Suite**:\n  - Case A: $(\\chi, Z, c_{meas}) = (10, 0.055, 0.80)$\n  - Case B: $(\\chi, Z, c_{meas}) = (10, 0.10, 0.60)$\n  - Case C: $(\\chi, Z, c_{meas}) = (10, 0.070, 0.40)$\n  - Case D: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.00)$\n  - Case E: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.50)$\n  - Case F: $(\\chi, Z, c_{meas}) = (5, 0.00, 0.00)$\n  - Case G: $(\\chi, Z, c_{meas}) = (5, 1.00, 0.00)$\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is assessed against the validation criteria:\n\n- **Scientifically Grounded**: The problem is built upon the laminar flamelet model, a cornerstone of turbulent combustion theory. The governing equation is a simplified but standard representation of reaction-diffusion balance in mixture fraction space. The assumptions (unity Lewis number, constant density) are common for creating tractable yet informative models. The source term, while phenomenological, correctly captures the localization of reaction near stoichiometry, its dependence on reactant/product concentration (via $c(1-c)$), and the physical phenomenon of flame extinction at high scalar dissipation rates. The problem is scientifically consistent and plausible as a computational exercise in combustion modeling.\n- **Well-Posed**: The core task is to solve a one-dimensional, second-order, nonlinear boundary value problem (BVP). With the specified Dirichlet boundary conditions $c(0)=0$ and $c(1)=0$, the problem is well-posed. The suggested numerical method, pseudo-time marching with a semi-implicit scheme, is a standard and robust technique for solving such BVPs. The classification rules are provided as a complete and deterministic set of `if-elif-else` conditions, guaranteeing a unique classification for any input.\n- **Objective**: All parameters, equations, and rules are defined with mathematical precision. There are no subjective or ambiguous statements.\n- **Completeness and Consistency**: The problem is self-contained. All necessary constants, equations, boundary conditions, and numerical and classification parameters are provided. The units are consistent throughout (e.g., $k_0$ and $\\chi$ are both in $\\text{s}^{-1}$). There are no internal contradictions.\n- **Other Flaws**: The problem is not unrealistic, ill-posed, trivial, or unverifiable. It represents a standard numerical task in computational science.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. It is a well-posed, scientifically grounded, and precisely defined computational task. The solution process may proceed.\n\n### Solution\n\nThe solution is a two-stage process: first, the numerical construction of the laminar flamelet manifold $c(Z;\\chi)$, and second, the classification of local combustion states using this manifold.\n\n**1. Construction of the Flamelet Manifold**\n\nThe foundation of the analysis is the steady-state laminar flamelet equation, which describes a balance between molecular diffusion and chemical reaction for the progress variable $c$ in the mixture fraction $Z$ coordinate system:\n$$\n\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z;\\chi) = 0\n$$\nThis is a nonlinear, second-order ordinary differential equation with boundary conditions $c(Z=0)=0$ and $c(Z=1)=0$. We solve this equation numerically for each specified scalar dissipation rate $\\chi \\in \\{5, 10, 30\\} \\, \\text{s}^{-1}$.\n\nA robust method for solving this type of equation is pseudo-time marching, where the steady-state equation is reformulated as a time-dependent problem whose solution converges to the desired steady state:\n$$\n\\frac{\\partial c}{\\partial t} = \\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z;\\chi)\n$$\nWe discretize the spatial domain $Z \\in [0,1]$ into $N=201$ uniformly spaced grid points $Z_i = i \\Delta Z$ where $\\Delta Z = 1/(N-1)$. The spatial derivative is approximated using a second-order central difference scheme:\n$$\n\\frac{\\partial^2 c}{\\partial Z^2}\\bigg|_{Z_i} \\approx \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta Z)^2}\n$$\nFor temporal discretization, a semi-implicit scheme is employed as suggested, treating the stiff diffusion term implicitly and the nonlinear reaction term explicitly. Using an implicit Euler scheme for diffusion and an explicit Euler scheme for reaction at time step $n$ to find the solution at $n+1$:\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = \\chi \\left( \\frac{c_{i+1}^{n+1} - 2c_i^{n+1} + c_{i-1}^{n+1}}{(\\Delta Z)^2} \\right) + \\dot{\\omega}_c(c_i^n, Z_i; \\chi)\n$$\nRearranging the terms gathers all the unknown values $c^{n+1}$ on the left-hand side:\n$$\n-\\alpha c_{i-1}^{n+1} + (1 + 2\\alpha) c_i^{n+1} - \\alpha c_{i+1}^{n+1} = c_i^n + \\Delta t \\cdot \\dot{\\omega}_c(c_i^n, Z_i; \\chi)\n$$\nwhere $\\alpha = \\chi \\Delta t / (\\Delta Z)^2$. This equation holds for all interior grid points $i=1, \\dots, N-2$. This forms a tridiagonal system of linear equations, $A \\mathbf{c}^{n+1} = \\mathbf{b}^n$, which can be solved efficiently at each time step. The process is initiated with $c(Z, t=0)=0$ and iterated until the change between successive solutions, $\\|\\mathbf{c}^{n+1} - \\mathbf{c}^n\\|_{\\infty}$, falls below the convergence tolerance of $10^{-8}$.\n\nFor the case where $\\chi \\ge \\chi_{crit}$, the term $\\max(0, 1-\\chi/\\chi_{crit})$ becomes $0$, making the reaction source $\\dot{\\omega}_c \\equiv 0$. The governing equation simplifies to the diffusion equation $\\chi \\frac{\\partial^2 c}{\\partial Z^2} = 0$ with boundary conditions $c(0)=0$ and $c(1)=0$. The unique solution to this is the trivial solution $c(Z) = 0$, representing a chemically extinguished state. This analytical result is used directly for $\\chi=30 \\, \\text{s}^{-1}$.\n\nThe procedure results in three distinct flamelet profiles, $c(Z; \\chi=5)$, $c(Z; \\chi=10)$, and $c(Z; \\chi=30)$, which collectively form the flamelet manifold.\n\n**2. Classification of Burning Regimes**\n\nWith the flamelet manifold computed, we can classify the local state $(\\chi, Z_{meas}, c_{meas})$ for each test case. The core of the classification is to compare the measured progress variable, $c_{meas}$, with a reference value from the flamelet manifold, $c_{ref} = c(Z_{meas}; \\chi)$. This reference value is obtained by linearly interpolating the appropriate pre-computed profile $c(Z;\\chi)$ at the location $Z_{meas}$.\n\nThe classification then proceeds by systematically applying the given set of hierarchical rules:\n1.  **Code 4 (Extinguished Non-premixed Flamelet)**: This applies if the scalar dissipation rate $\\chi$ is at or above the critical value $\\chi_{crit}$, and both the reference and measured progress variables are below the ignition threshold $c_{th}$. This identifies a state where mixing is too intense for a non-premixed flame to sustain itself.\n2.  **Code 1 (Non-premixed Flamelet Burning)**: This state is identified when the local conditions are close to stoichiometric ($|Z - Z_{st}| \\le \\delta_Z$), there is significant reaction progress ($c_{ref} \\ge c_{th}$), and the measured progress variable $c_{meas}$ is consistent with the flamelet manifold prediction ($|c_{meas} - c_{ref}| \\le tol_c$). This represents canonical non-premixed combustion.\n3.  **Code 2 (Partially Premixed Burning)**: This rule captures states that are near stoichiometric and show significant reaction, but where the progress variable $c_{meas}$ deviates from the non-premixed flamelet value. This deviation suggests that the local mixture composition does not originate from pure, unburnt fuel and oxidizer streams, indicating prior partial premixing.\n4.  **Code 3 (Premixed Burning)**: This code is assigned to states with significant reaction progress ($c_{meas} \\ge c_{th}$) that occur far from the stoichiometric mixture fraction ($|Z - Z_{st}|  \\delta_Z$). This identifies flames burning in the lean or rich premixed regime.\n5.  **Code 0 (Unburnt or Inert)**: This is the default classification for any state that does not meet the criteria for burning or extinction, typically corresponding to regions with negligible reaction progress ($c_{meas}  c_{th}$).\n\nThe final implementation will compute the manifold and then apply this classification logic to each of the seven test cases to produce the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the computational combustion problem by first constructing a flamelet\n    manifold and then using it to classify burning regimes.\n    \"\"\"\n\n    # --- Givens: Constants and Parameters ---\n    # Model parameters\n    Z_st = 0.055       # Stoichiometric mixture fraction\n    k_0 = 60.0         # Rate constant (1/s)\n    sigma = 0.02       # Reaction zone width\n    chi_crit = 25.0    # Critical scalar dissipation rate (1/s)\n\n    # Numerical parameters\n    N = 201                      # Number of grid points\n    max_iter = 20000             # Max iterations for time marching\n    conv_tol = 1e-8              # Convergence tolerance\n    dt = 1e-4                    # Pseudo-time step (s)\n\n    # Classification parameters\n    c_th = 0.05        # Progress threshold\n    delta_Z = 0.02     # Stoichiometric proximity\n    tol_c = 0.10       # Consistency tolerance\n\n    # Chi values for manifold computation\n    chi_values = [5.0, 10.0, 30.0]\n\n    # Test cases: (chi, Z_meas, c_meas)\n    test_cases = [\n        (10.0, 0.055, 0.80), # A\n        (10.0, 0.10, 0.60),  # B\n        (10.0, 0.070, 0.40),  # C\n        (30.0, 0.055, 0.00),  # D\n        (30.0, 0.055, 0.50),  # E\n        (5.0, 0.00, 0.00),   # F\n        (5.0, 1.00, 0.00),   # G\n    ]\n\n    # --- Stage 1: Compute Flamelet Manifold ---\n    Z_grid = np.linspace(0, 1, N)\n    dZ = Z_grid[1] - Z_grid[0]\n    \n    manifold_profiles = {}\n\n    for chi in chi_values:\n        # If chi = chi_crit, flame is extinguished, c(Z) = 0\n        if chi = chi_crit:\n            manifold_profiles[chi] = np.zeros(N)\n            continue\n        \n        # Initialize progress variable profile\n        c = np.zeros(N)\n        \n        # --- Set up the tridiagonal system for implicit diffusion ---\n        # A * c_new = b\n        # A is tridiagonal: [diag_lower, diag_main, diag_upper]\n        alpha = chi * dt / (dZ**2)\n        \n        # Banded matrix representation for scipy.linalg.solve_banded\n        # (l=1, u=1) - 3 rows\n        # Row 0: super-diagonal (u)\n        # Row 1: main diagonal\n        # Row 2: sub-diagonal (l)\n        A_banded = np.zeros((3, N - 2))\n        A_banded[0, 1:] = -alpha  # Super-diagonal\n        A_banded[1, :] = 1.0 + 2.0 * alpha # Main diagonal\n        A_banded[2, :-1] = -alpha # Sub-diagonal\n\n        # --- Pseudo-time marching loop ---\n        for _ in range(max_iter):\n            c_old = c.copy()\n            \n            # Calculate reaction source term (explicit)\n            reaction_gaussian = np.exp(-((Z_grid - Z_st)**2) / (2 * sigma**2))\n            extinction_term = max(0, 1 - chi / chi_crit)\n            omega_c = k_0 * reaction_gaussian * c * (1 - c) * extinction_term\n            \n            # Right-hand side of the linear system\n            rhs = c + dt * omega_c\n            \n            # Solve the tridiagonal system A*c = b for interior points\n            # Dirichlet BCs c[0]=0, c[N-1]=0 are handled implicitly as they\n            # don't appear in the (N-2)x(N-2) system.\n            c[1:-1] = solve_banded((1, 1), A_banded, rhs[1:-1])\n\n            # Check for convergence\n            if np.linalg.norm(c - c_old, np.inf)  conv_tol:\n                break\n        \n        manifold_profiles[chi] = c\n\n    # --- Stage 2: Classify Test Cases ---\n    results = []\n    for chi_meas, Z_meas, c_meas in test_cases:\n        # Get the corresponding flamelet profile\n        c_profile = manifold_profiles[chi_meas]\n        \n        # Interpolate to find reference progress variable c_ref\n        c_ref = np.interp(Z_meas, Z_grid, c_profile)\n        \n        # Apply classification rules\n        code = 0 # Default classification\n        \n        # Rule 1: Extinguished non-premixed\n        if c_ref  c_th and chi_meas = chi_crit and c_meas  c_th:\n            code = 4\n        # Rule 2: Non-premixed flamelet burning\n        elif c_ref = c_th and abs(c_meas - c_ref) = tol_c and abs(Z_meas - Z_st) = delta_Z:\n            code = 1\n        # Rule 3: Partially premixed burning\n        elif c_meas = c_th and abs(Z_meas - Z_st) = delta_Z:\n            code = 2\n        # Rule 4: Premixed burning\n        elif c_meas = c_th and abs(Z_meas - Z_st)  delta_Z:\n            code = 3\n        # Rule 5: Unburnt or inert (default else case)\n        else:\n            code = 0\n\n        results.append(code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}