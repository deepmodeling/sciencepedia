{
    "hands_on_practices": [
        {
            "introduction": "为了扎实地理解非预混燃烧，我们首先从一个经典的解析模型——Burke-Schumann扩散火焰开始。这个练习将指导你推导在一个理想化的混合层中混合物分数场的解析解 。通过求解这个基础方程，我们将能够为火焰的结构（如其位置和厚度）推导出具体的数学表达式，为后续更复杂场景的分析提供一个清晰的物理和数学基准。",
            "id": "4012508",
            "problem": "考虑两股平行的、同向流动的、等温的流体，它们形成一个与流向坐标 $x$ 对齐的平面混合层，并且只在横向坐标 $y$ 上有变化。上游（$y>0$）是纯燃料，其燃料质量分数为 $Y_{F}=1$，氧化剂质量分数为 $Y_{O}=0$；而下游（$y0$）是纯氧化剂，其 $Y_{O}=1$，$Y_{F}=0$。两股流体密度均匀，输运性质恒定，物种扩散系数相等，并以相同的匀速 $u$ 沿 $x$ 方向流动。流动是稳态的，雷诺数足够高，以至于轴向扩散相对于轴向对流可以忽略不计。$y$ 方向的分子扩散控制着横向混合。燃料和氧化剂之间的化学反应被假定为无限快，因此 Burke–Schumann 近似（反应局限于满足化学计量的薄片上）是有效的。化学计量的氧化剂与燃料质量比为 $s>0$，且各物种的路易斯数均为1。\n\n在这些假设下，混合分数 $Z(y,x)$ 是一个守恒标量，遵循一维稳态对流-扩散方程\n$$\nu\\,\\frac{\\partial Z}{\\partial x} \\;=\\; D\\,\\frac{\\partial^{2} Z}{\\partial y^{2}},\n$$\n对于 $x > 0, -\\infty  y  \\infty$，边界条件为 $Z(x, y\\to\\infty) = 1$ 和 $Z(x, y\\to-\\infty) = 0$，初始条件在 $x=0$ 处为阶跃函数：$Z(0,y) = 1$ for $y>0$ 和 $Z(0,y) = 0$ for $y0$。\n\n您的任务是：（1）推导火焰面位置 $y_f(x)$ 的解析表达式，该位置由 $Z(y_f, x) = Z_{st} = \\frac{1}{1+s}$ 定义。（2）推导反应区厚度 $\\delta_f(x)$ 的解析表达式，该厚度定义为在火焰面位置处混合分数梯度的倒数，即 $\\delta_f(x) \\equiv (|\\partial Z/\\partial y|_{y=y_f})^{-1}$。将您的答案表示为一个包含两个元素的元组 $(y_f, \\delta_f)$。",
            "solution": "用户要求我解决一个计算燃烧学中的问题。\n\n这是我的计划：\n1.  **验证问题**：\n    *   **第1步：提取已知条件**：我将列出问题陈述中提供的所有信息。\n        *   几何：两股平行的、同向流动的、等温的流体。平面混合层。\n        *   坐标系：$x$ 是流向， $y$ 是横向。\n        *   上游（$y>0$）：纯燃料，$Y_F=1$, $Y_O=0$。\n        *   下游（$y0$）：纯氧化剂，$Y_O=1$, $Y_F=0$。\n        *   流动性质：密度均匀，输运性质恒定，物种扩散系数相等（$Le=1$）。\n        *   速度：两股流体沿 $x$ 方向的速度均为匀速 $u$。\n        *   流动状态：稳态流，高雷诺数（轴向扩散可忽略）。\n        *   混合机理：$y$ 方向的分子扩散。\n        *   化学：无限快反应（Burke–Schumann 近似）。反应发生在化学计量片上。\n        *   化学计量：化学计量的氧化剂与燃料质量比为 $s > 0$。\n        *   混合分数 $Z(y,x)$ 的控制方程：$u\\,\\frac{\\partial Z}{\\partial x} \\;=\\; D\\,\\frac{\\partial^{2} Z}{\\partial y^{2}}$，对于 $x > 0, -\\infty  y  \\infty$。\n        *   边界条件：$Z(x, y\\to\\infty) = 1$, $Z(x, y\\to-\\infty) = 0$。\n        *   初始条件：$Z(0,y)=1$ for $y>0$, $Z(0,y)=0$ for $y0$。\n        *   目标：推导火焰面位置 $y_f(x)$ 和厚度 $\\delta_f(x) = (|\\partial Z/\\partial y|_{y=y_f})^{-1}$。\n    *   **第2步：问题有效性验证**：该问题是热与物质传递领域中一个经典的相似性解问题，常被称为格劳尔特-拉茨问题，适用于燃烧领域。它具有充分的科学依据，定义明确，并且是一个可以解析求解的标准问题。语言客观且精确，所有必要的条件都已提供。\n2.  **制定解决方案**：\n    *   **第1步：相似性变换**：引入相似变量 $\\eta = y / \\sqrt{Dx/u}$ 来将偏微分方程（PDE）转化为常微分方程（ODE）。\n    *   **第2步：求解ODE**：求解关于 $\\eta$ 的ODE，并应用变换后的边界条件来确定积分常数。解将以误差函数（erf）的形式出现。\n    *   **第3步：求解火焰位置 $y_f(x)$**：将 $Z = Z_{st} = 1/(1+s)$ 代入解中，并求解 $y_f$。\n    *   **第4步：求解火焰厚度 $\\delta_f(x)$**：计算解 $\\partial Z/\\partial y$，在 $y=y_f$ 处对其求值，然后取其倒数。\n3.  **最终答案**：以指定格式组合最终结果。",
            "answer": "$$\n\\boxed{\n\\left( 2\\sqrt{\\frac{Dx}{u}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right) , 2\\sqrt{\\frac{\\pi Dx}{u}} \\exp\\left(\\left(\\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)\\right)^{2}\\right) \\right)\n}\n$$"
        },
        {
            "introduction": "在掌握了理想模型后，我们将进入一个更接近实际的计算实践，引入有限速率化学反应的概念。这个练习将模拟剪切层中的燃烧，通过一个点火延迟时间模型来探索自燃等关键现象 。你将通过编写程序来比较化学时间尺度和流动时间尺度，这是在实际系统中对燃烧状态进行分类的一种基本而强大的方法，帮助我们区分非预混、部分预混和预混燃烧区域。",
            "id": "4012540",
            "problem": "您的任务是设计并实现一个计算程序，使用一个基于科学原理的详细化学反应替代模型，来对典型非预混剪切层沿线的局部火焰形态进行分类，并识别易自燃区域。这项工作必须基于第一性原理进行构建，并最终形成一个完整的、可运行的程序，该程序能为指定的测试套件输出数值结果。物理背景是由两股流体（一股燃料流和一股氧化剂流）形成的平面剪切层。分类目标是区分预混、非预混和部分预混火焰，而自燃分析则通过比较停留时间与点火延迟时间，来研究举升火焰的稳定性。\n\n基本定义和建模假设：\n- 两股流体之间的混合物由 Bilger 混合分数 $Z$ 表示，其中 $Z=0$ 表示纯氧化剂，$Z=1$ 表示纯燃料。甲烷-空气的化学当量混合分数取为 $Z_{\\mathrm{st}} = 0.055$。\n- 局部混合物温度通过两股流体的绝热、等压混合来建模，使用凸组合 $T(Z) = Z \\, T_F + (1-Z)\\, T_O$，其中 $T_F$ 是燃料流温度，$T_O$ 是氧化剂流温度。所有温度必须以开尔文（Kelvin）为单位提供和解释。\n- 压力假定为恒定，点火延迟由一个阿伦尼乌斯定律建模，该定律通过一个惩罚偏离化学计量比的组分敏感性因子进行增强。具体来说，点火延迟为\n$$\n\\tau_{\\mathrm{ign}}(Z) = A \\,\\exp\\!\\left(\\frac{E/R}{T(Z)}\\right)\\, g(Z),\n$$\n其中\n$$\ng(Z) = 1 + \\alpha\\left(\\frac{Z}{Z_{\\mathrm{st}}} + \\frac{Z_{\\mathrm{st}}}{Z} - 2\\right),\n$$\n根据算术平均-几何平均不等式（AM-GM），该式在 $Z=Z_{\\mathrm{st}}$ 时达到最小值。参数为 $A=10^{-7}\\,\\mathrm{s}$，$E/R=12000\\,\\mathrm{K}$ 和 $\\alpha=3$，选择这些参数是为了在指定温度范围内产生与甲烷-空气动力学趋势一致的点火延迟。为避免除以零，在 $Z$ 出现在有理表达式内的任何地方，计算中必须使用有效混合分数 $Z_{\\mathrm{eff}} = \\max(\\min(Z,1-10^{-5}),10^{-5})$。\n- 剪切层坐标 $s$ 跨越区间 $[0,L_s]$，层内的混合分数分布建模为\n$$\nZ(s) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{s - L_s/2}{w}\\right)\\right],\n$$\n其中 $L_s$ 是跨度长度，$w$ 控制过渡区的厚度。坐标 $s$ 被均匀离散化为 $N$ 个点。\n- 停留时间通过对流估算建模\n$$\nt_{\\mathrm{res}} = \\frac{L_{\\mathrm{ref}}}{U},\n$$\n其中 $L_{\\mathrm{ref}}$ 是到潜在稳定区域的参考轴向长度，$U$ 是特征对流速度，单位分别为 $\\mathrm{m}$ 和 $\\mathrm{m/s}$，最终 $t_{\\mathrm{res}}$ 的单位为 $\\mathrm{s}$。\n- 混合时间通过扩散时间尺度定义\n$$\nt_{\\mathrm{mix}} = \\frac{\\lambda^2}{D},\n$$\n其中 $\\lambda$ 是特征剪切层厚度，$D$ 是代表性组分扩散系数，最终 $t_{\\mathrm{mix}}$ 的单位为 $\\mathrm{s}$。\n\n易自燃区域识别：\n- 在每个离散位置 $s_i$，计算 $\\tau_{\\mathrm{ign}}(Z(s_i))$ 并与 $t_{\\mathrm{res}}$ 进行比较。如果 $\\tau_{\\mathrm{ign}}(Z(s_i)) \\le t_{\\mathrm{res}}$，则位置 $s_i$ 被视为易自燃。\n\n火焰形态分类：\n- 使用比率\n$$\nP = \\frac{t_{\\mathrm{mix}}}{\\min_i \\tau_{\\mathrm{ign}}(Z(s_i))},\n$$\n根据以下规则对测试案例的形态进行分类：\n    - 非预混：$P \\ge 3$。\n    - 部分预混：$0.3  P  3$。\n    - 预混：$P \\le 0.3$。\n对于输出编码，使用整数：非预混 $=0$，部分预混 $=1$，预混 $=2$。\n\n单位：\n- 所有长度必须以 $\\mathrm{m}$ 为单位处理和报告，速度以 $\\mathrm{m/s}$ 为单位，温度以 $\\mathrm{K}$ 为单位，时间以 $\\mathrm{s}$ 为单位，输出必须是无单位的整数和整数列表，如指定。\n\n程序输出规范：\n- 您的程序必须生成单行输出，其中包含所有测试案例的结果，格式为一个逗号分隔的列表，并用方括号括起来。每个测试案例的结果必须是 `[c,[i_1,i_2,\\dots]]` 形式的双元素列表，其中 $c$ 是为整个测试案例定义的分类代码整数，$[i_1,i_2,\\dots]$ 是易自燃位置 $s_i$ 的整数索引列表，按升序排列。如果没有索引满足自燃标准，则使用空列表 $[]$。\n- 程序输出中不允许包含除此单行列表之外的任何额外文本或格式。\n\n测试套件：\n为确保科学覆盖性，请使用给定的参数评估以下三个案例。所有常数必须完全按所列使用，所有数字必须按上述单位解释。\n\n- 案例 1（热伴流，高速射流，较厚混合层，预计在 $Z_{\\mathrm{st}}$ 附近发生非预混自燃）：\n    - $T_F = 300$, $T_O = 1400$, $U = 50$, $L_{\\mathrm{ref}} = 0.1$, $\\lambda = 0.001$, $D = 1\\times 10^{-4}$, $L_s = 0.02$, $w = 0.002$, $N = 51$。\n- 案例 2（冷伴流，高速射流，薄混合层，预计不发生自燃）：\n    - $T_F = 300$, $T_O = 800$, $U = 50$, $L_{\\mathrm{ref}} = 0.1$, $\\lambda = 0.0005$, $D = 1\\times 10^{-4}$, $L_s = 0.02$, $w = 0.002$, $N = 51$。\n- 案例 3（中等预热，低速射流，中等厚度混合层，预计为部分预混并带有自燃区）：\n    - $T_F = 300$, $T_O = 1100$, $U = 5$, $L_{\\mathrm{ref}} = 0.1$, $\\lambda = 0.0009$, $D = 1\\times 10^{-4}$, $L_s = 0.02$, $w = 0.0015$, $N = 51$。\n\n您的程序必须计算每个案例的分类代码和易自燃索引列表，并按上述说明打印单行聚合输出，例如格式为 `[[c_1,[i_{1,1},\\dots]],[c_2,[\\dots]],[c_3,[\\dots]]]`。",
            "solution": "用户提供了一个需要开发计算程序的问题，该程序用于对典型非预混剪切层中的火焰形态进行分类并识别易自燃区域。该问题具有科学依据，定义明确，并提供了所有必要的参数和模型。验证过程确认了其有效性。\n\n### 步骤1：提取给定信息\n\n**物理常数和模型参数：**\n-   甲烷-空气的化学当量混合分数：$Z_{\\mathrm{st}} = 0.055$。\n-   点火延迟指前因子：$A = 10^{-7}\\,\\mathrm{s}$。\n-   归一化活化能：$E/R = 12000\\,\\mathrm{K}$。\n-   点火延迟的组分敏感性因子：$\\alpha = 3$。\n\n**数学模型：**\n-   温度作为混合分数 $Z$ 的函数：$T(Z) = Z \\, T_F + (1-Z)\\, T_O$，其中 $T_F$ 是燃料流温度，$T_O$ 是氧化剂流温度。\n-   点火延迟作为混合分数 $Z$ 的函数：\n    $$\n    \\tau_{\\mathrm{ign}}(Z) = A \\,\\exp\\!\\left(\\frac{E/R}{T(Z)}\\right)\\, g(Z)\n    $$\n    其中组分依赖项为\n    $$\n    g(Z) = 1 + \\alpha\\left(\\frac{Z}{Z_{\\mathrm{st}}} + \\frac{Z_{\\mathrm{st}}}{Z} - 2\\right).\n    $$\n-   用于数值稳定性的有效混合分数：$Z_{\\mathrm{eff}} = \\max(\\min(Z,1-10^{-5}),10^{-5})$，用于有理表达式中的 $Z$。\n-   剪切层在坐标 $s \\in [0, L_s]$ 上的混合分数分布：\n    $$\n    Z(s) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{s - L_s/2}{w}\\right)\\right],\n    $$\n    其中 $L_s$ 是跨度长度，$w$ 是厚度参数。坐标 $s$ 被离散化为 $N$ 个点。\n-   对流停留时间：$t_{\\mathrm{res}} = L_{\\mathrm{ref}}/U$，其中 $L_{\\mathrm{ref}}$ 是参考长度，$U$ 是特征速度。\n-   扩散混合时间：$t_{\\mathrm{mix}} = \\lambda^2/D$，其中 $\\lambda$ 是特征厚度，$D$ 是扩散系数。\n\n**分类和识别标准：**\n-   易自燃区域：如果 $\\tau_{\\mathrm{ign}}(Z(s_i)) \\le t_{\\mathrm{res}}$，则位置 $s_i$ 易于自燃。\n-   火焰形态分类参数：$P = \\frac{t_{\\mathrm{mix}}}{\\min_i \\tau_{\\mathrm{ign}}(Z(s_i))}$。\n    -   非预混：$P \\ge 3$ (编码为 $0$)。\n    -   部分预混：$0.3  P  3$ (编码为 $1$)。\n    -   预混：$P \\le 0.3$ (编码为 $2$)。\n\n**测试套件数据：**\n-   **案例 1：** $T_F = 300\\,\\mathrm{K}$, $T_O = 1400\\,\\mathrm{K}$, $U = 50\\,\\mathrm{m/s}$, $L_{\\mathrm{ref}} = 0.1\\,\\mathrm{m}$, $\\lambda = 0.001\\,\\mathrm{m}$, $D = 1\\times 10^{-4}\\,\\mathrm{m^2/s}$, $L_s = 0.02\\,\\mathrm{m}$, $w = 0.002\\,\\mathrm{m}$, $N = 51$。\n-   **案例 2：** $T_F = 300\\,\\mathrm{K}$, $T_O = 800\\,\\mathrm{K}$, $U = 50\\,\\mathrm{m/s}$, $L_{\\mathrm{ref}} = 0.1\\,\\mathrm{m}$, $\\lambda = 0.0005\\,\\mathrm{m}$, $D = 1\\times 10^{-4}\\,\\mathrm{m^2/s}$, $L_s = 0.02\\,\\mathrm{m}$, $w = 0.002\\,\\mathrm{m}$, $N = 51$。\n-   **案例 3：** $T_F = 300\\,\\mathrm{K}$, $T_O = 1100\\,\\mathrm{K}$, $U = 5\\,\\mathrm{m/s}$, $L_{\\mathrm{ref}} = 0.1\\,\\mathrm{m}$, $\\lambda = 0.0009\\,\\mathrm{m}$, $D = 1\\times 10^{-4}\\,\\mathrm{m^2/s}$, $L_s = 0.02\\,\\mathrm{m}$, $w = 0.0015\\,\\mathrm{m}$, $N = 51$。\n\n### 步骤2：使用提取的给定信息进行验证\n\n该问题具有科学依据，采用了燃烧理论中的标准概念，如混合分数、阿伦尼乌斯动力学和特征时间尺度（Damköhler数分析）。这些模型虽然简化（例如，线性温度分布，单步动力学替代模型），但对于基于第一性原理的计算分析是合适的，并且公式正确。使用 $Z_{\\mathrm{eff}}$ 是处理潜在奇异点的标准数值技术。基于混合时间与化学时间之比（$P$）的火焰形态分类标准是燃烧分区图的基石。自燃标准是直接应用点火延迟与停留时间的比较。该问题定义明确，为每个测试案例指定了所有必要的参数，并且计算任务的定义清晰无误。语言客观而精确。\n\n### 步骤3：结论与行动\n此问题是**有效的**。现在将开发一个计算解决方案。\n\n### 基于原理的解决方案设计\n\n该解决方案将以Python程序的形式实现，该程序系统地处理问题陈述中定义的每个测试案例。每个案例的总体逻辑如下，遵循指定的物理模型和计算程序。\n\n**1. 剪切层的离散化：**\n剪切层定义在从 $0$ 到 $L_s$ 的空间坐标 $s$ 上。该域被离散化为 $N$ 个均匀间隔的点，表示为集合 $\\{s_i\\}_{i=0}^{N-1}$。\n$$\ns_i = i \\frac{L_s}{N-1} \\quad \\text{for } i = 0, 1, \\dots, N-1.\n$$\n\n**2. 混合分数和温度分布：**\n对于离散域中的每个点 $s_i$，我们首先使用提供的双曲正切函数分布计算局部混合分数 $Z(s_i)$：\n$$\nZ(s_i) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{s_i - L_s/2}{w}\\right)\\right].\n$$\n随后，使用线性混合法则确定局部温度 $T(Z(s_i))$：\n$$\nT(Z(s_i)) = Z(s_i) \\, T_F + (1-Z(s_i))\\, T_O.\n$$\n\n**3. 点火延迟计算：**\n在每个点 $s_i$ 计算点火延迟 $\\tau_{\\mathrm{ign}}$。这需要计算与组分相关的项 $g(Z)$ 和阿伦尼乌斯项。为了数值稳定性，在 $g(Z)$ 内的有理表达式中的 $Z$ 被替换为 $Z_{\\mathrm{eff}}$：\n$$\nZ_{\\mathrm{eff}}(s_i) = \\max(\\min(Z(s_i),1-10^{-5}),10^{-5}).\n$$\n函数 $g(Z(s_i))$ 随后为：\n$$\ng(Z(s_i)) = 1 + \\alpha\\left(\\frac{Z_{\\mathrm{eff}}(s_i)}{Z_{\\mathrm{st}}} + \\frac{Z_{\\mathrm{st}}}{Z_{\\mathrm{eff}}(s_i)} - 2\\right).\n$$\n点火延迟分布 $\\tau_{\\mathrm{ign}}(Z(s_i))$ 最终计算为：\n$$\n\\tau_{\\mathrm{ign}}(Z(s_i)) = A \\,\\exp\\!\\left(\\frac{E/R}{T(Z(s_i))}\\right)\\, g(Z(s_i)).\n$$\n\n**4. 特征时间尺度：**\n为每个测试案例计算两个全局特征时间：对流停留时间 $t_{\\mathrm{res}}$ 和扩散混合时间 $t_{\\mathrm{mix}}$。\n$$\nt_{\\mathrm{res}} = \\frac{L_{\\mathrm{ref}}}{U} \\quad \\text{和} \\quad t_{\\mathrm{mix}} = \\frac{\\lambda^2}{D}.\n$$\n\n**5. 自燃区域识别：**\n在每个离散点 $s_i$ 评估自燃标准 $\\tau_{\\mathrm{ign}}(Z(s_i)) \\le t_{\\mathrm{res}}$。满足此条件的整数索引集合 $\\{i\\}$ 构成了易自燃区域。这些索引将按升序收集到一个列表中。\n\n**6. 火焰形态分类：**\n火焰形态由参数 $P$ 决定。首先，找到整个剪切层上的最小点火延迟 $\\tau_{\\mathrm{ign,min}}$：\n$$\n\\tau_{\\mathrm{ign,min}} = \\min_{i} \\tau_{\\mathrm{ign}}(Z(s_i)).\n$$\n然后，参数 $P$ 计算为混合时间与此最小化学时间之比：\n$$\nP = \\frac{t_{\\mathrm{mix}}}{\\tau_{\\mathrm{ign,min}}}.\n$$\n根据 $P$ 的值对形态进行分类：\n-   如果 $P \\ge 3$，分类代码为 $c=0$ (非预混)。\n-   如果 $0.3  P  3$，分类代码为 $c=1$ (部分预混)。\n-   如果 $P \\le 0.3$，分类代码为 $c=2$ (预混)。\n\n**7. 最终输出生成：**\n对于每个测试案例，结果被编译成一个双元素列表：`[分类代码, 自燃索引列表]`。所有测试案例的最终输出是表示这些结果列表的单个字符串，格式如指定。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the computational combustion problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: hot coflow, fast jet, thicker mixing\n        {\n            \"T_F\": 300, \"T_O\": 1400, \"U\": 50, \"L_ref\": 0.1, \"lambda\": 0.001,\n            \"D\": 1e-4, \"L_s\": 0.02, \"w\": 0.002, \"N\": 51\n        },\n        # Case 2: cold coflow, fast jet, thin mixing\n        {\n            \"T_F\": 300, \"T_O\": 800, \"U\": 50, \"L_ref\": 0.1, \"lambda\": 0.0005,\n            \"D\": 1e-4, \"L_s\": 0.02, \"w\": 0.002, \"N\": 51\n        },\n        # Case 3: moderate preheat, slow jet, intermediate mixing\n        {\n            \"T_F\": 300, \"T_O\": 1100, \"U\": 5, \"L_ref\": 0.1, \"lambda\": 0.0009,\n            \"D\": 1e-4, \"L_s\": 0.02, \"w\": 0.0015, \"N\": 51\n        }\n    ]\n    \n    # Foundational constants\n    Z_st = 0.055\n    A = 1e-7\n    E_over_R = 12000\n    alpha = 3.0\n\n    all_results = []\n    \n    for params in test_cases:\n        # Unpack parameters for the current case\n        T_F = params[\"T_F\"]\n        T_O = params[\"T_O\"]\n        U = params[\"U\"]\n        L_ref = params[\"L_ref\"]\n        lambda_mix = params[\"lambda\"]\n        D = params[\"D\"]\n        L_s = params[\"L_s\"]\n        w = params[\"w\"]\n        N = params[\"N\"]\n\n        # 1. Discretization of the shear layer\n        s = np.linspace(0, L_s, N)\n        \n        # 2. Mixture fraction and temperature profiles\n        Z = 0.5 * (1 + np.tanh((s - L_s / 2) / w))\n        T = Z * T_F + (1 - Z) * T_O\n        \n        # 3. Ignition delay calculation\n        # Use effective Z to avoid division by zero\n        Z_eff = np.clip(Z, 1e-5, 1 - 1e-5)\n        g_Z = 1 + alpha * (Z_eff / Z_st + Z_st / Z_eff - 2)\n        tau_ign = A * np.exp(E_over_R / T) * g_Z\n        \n        # 4. Characteristic timescales\n        t_res = L_ref / U\n        t_mix = lambda_mix**2 / D\n        \n        # 5. Autoignition zone identification\n        autoignition_indices = np.where(tau_ign = t_res)[0].tolist()\n        \n        # 6. Flame regime classification\n        tau_ign_min = np.min(tau_ign)\n        P = t_mix / tau_ign_min\n        \n        if P >= 3:\n            classification_code = 0  # Non-premixed\n        elif P > 0.3:\n            classification_code = 1  # Partially premixed\n        else:\n            classification_code = 2  # Premixed\n            \n        all_results.append([classification_code, autoignition_indices])\n\n    def format_case_result(case_result):\n        \"\"\"Custom formatter to produce output string with no spaces.\"\"\"\n        class_code, indices = case_result\n        indices_str = f\"[{','.join(map(str, indices))}]\"\n        return f\"[{class_code},{indices_str}]\"\n\n    # Final print statement in the exact required format.\n    formatted_results = [format_case_result(res) for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本章的最后一个练习将引导你接触湍流燃烧建模中的一项前沿技术：层流火焰面方法。在这个综合性的计算任务中，你将通过数值求解反应-扩散平衡方程来构建一个火焰面数据库（或称“流形”）。随后，你将利用这个强大的工具，根据给定的混合物分数和反应进度变量，对复杂的燃烧状态进行诊断和分类，从而将燃烧理论与计算流体动力学（CFD）的实际分析紧密联系起来。",
            "id": "4012490",
            "problem": "您的任务是为甲烷-空气在混合分数空间中构建一个简化但科学上一致的稳态层流火焰面数据库，然后使用该数据库根据混合分数和反应进度变量对局部燃烧模式进行分类。所有工作均在混合分数坐标 $Z \\in [0,1]$ 中进行，并假设刘易斯数为1且密度恒定。目标是基于基本定义和稳态火焰面平衡进行推理，设计一个数值上稳健、可实现且可测试的算法。\n\n使用的基本和核心定义：\n- Bilger混合分数 $Z$ 是一个守恒标量，它参数化了纯氧化剂（$Z=0$）和纯燃料（$Z=1$）之间的局部组分。对于甲烷-空气混合物，化学计量混合分数约为 $Z_{st} = 0.055$。\n- 反应进度变量 $c$ 是一个有界标量，$c \\in [0,1]$，它随着反应物向生成物的转化而单调增加。在燃烧模拟中，一个常见的定义是 $c = (Y_{CO_2} + Y_{H_2O} + Y_{CO}) / (Y_{CO_2}^{eq} + Y_{H_2O}^{eq} + Y_{CO}^{eq})$，但在这里您将通过混合分数空间中的反应-扩散平衡来对 $c$ 进行建模。\n- 在单位刘易斯数和恒定密度条件下，混合分数坐标系中的稳态火焰面方程是扩散和化学反应之间的二阶平衡，\n$$\n\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z) = 0,\n$$\n其中 $\\chi$ 是标量耗散率（单位为 $\\text{s}^{-1}$），用于量化沿 $Z$ 的分子混合强度，而 $\\dot{\\omega}_c$ 是代表化学转化的源项。\n\n为使问题在计算上易于处理同时保持科学合理性而做的模型假设：\n- 使用一个以 $Z_{st}$ 为中心的局部反应源项来表示甲烷-空气扩散火焰反应区，\n$$\n\\dot{\\omega}_c(c,Z;\\chi) = k_0 \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma^2}\\right) \\, c(1-c) \\, \\max\\!\\left(0, 1 - \\frac{\\chi}{\\chi_{crit}}\\right),\n$$\n其中 $k_0$ 是有效化学反应速率常数，$\\sigma$ 是混合分数空间中反应区的宽度，$\\chi_{crit}$ 是临界标量耗散率，高于此值非预混火焰面将熄灭。假设 $Z_{st} = 0.055$，$k_0 = 60$ (单位 $\\text{s}^{-1}$)，$\\sigma = 0.02$ (在 $Z$ 中为无量纲)，以及 $\\chi_{crit} = 25$ (单位 $\\text{s}^{-1}$)。\n- 施加狄利克雷边界条件 $c(0) = 0$ 和 $c(1) = 0$，表示在边界处的纯氧化剂和纯燃料流的反应进度为零。\n- 为了物理上的合理性，使用绝热映射将 $c$ 与温度关联起来，\n$$\nT(Z,c) = T_u + c \\left[T_b(Z) - T_u\\right], \\quad T_b(Z) = T_u + \\Delta T_{max} \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma_T^2}\\right),\n$$\n其中 $T_u = 300$ (开尔文)，$\\Delta T_{max} = 1920$ (开尔文)，以及 $\\sigma_T = 0.04$。最终输出中不需要此温度，但它是基于物理的数据库的一部分。\n\n数据库的数值构建：\n- 对于集合 $\\{\\chi_1, \\chi_2, \\chi_3\\} = \\{5, 10, 30\\}$ (单位 $\\text{s}^{-1}$) 中的每个标量耗散率，在 $Z \\in [0,1]$ 的均匀网格上，通过伪时间推进方法求解稳态火焰面方程直至达到稳态，其中扩散项采用隐式处理，反应项采用显式处理。设空间网格至少有 $N = 201$ 个点，并以稳定的步长进行时间推进，直到更新量的无穷范数低于 $10^{-8}$ 或达到最大迭代次数。生成的数据库是针对每个 $\\chi$ 值，在 $Z$ 上制表的 $c(Z;\\chi)$。\n\n基于数据库的分类任务：\n- 对于一组由 $(\\chi, Z, c_{meas})$ 表征的局部状态，其中 $c_{meas}$ 是测量或预测的局部反应进度变量，使用通过插值计算的数据库值 $c_{ref} = c(Z;\\chi)$ 来对燃烧模式进行分类。使用以下阈值和容差：\n  - 反应进度阈值 $c_{th} = 0.05$，\n  - 化学计量比邻近度 $\\delta_Z = 0.02$，\n  - 一致性容差 $tol_c = 0.10$。\n- 分类规则如下：\n  1. 如果 $c_{ref}  c_{th}$ 且 $\\chi \\ge \\chi_{crit}$ 且 $c_{meas}  c_{th}$，则分类为代码 $4$ (熄火的非预混火焰面)。\n  2. 否则，如果 $c_{ref} \\ge c_{th}$ 且 $|c_{meas} - c_{ref}| \\le tol_c$ 且 $|Z - Z_{st}| \\le \\delta_Z$，则分类为代码 $1$ (非预混火焰面燃烧)。\n  3. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| \\le \\delta_Z$，则分类为代码 $2$ (部分预混燃烧)。\n  4. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| > \\delta_Z$，则分类为代码 $3$ (预混燃烧)。\n  5. 否则分类为代码 $0$ (未燃或惰性混合物)。\n- 这些规则体现了这样一种物理思想：非预混火焰在 $Z_{st}$ 附近燃烧并与火焰面数据库匹配，部分预混燃烧发生在 $Z_{st}$ 附近但偏离非预混火焰面值，而预混燃烧则在远离 $Z_{st}$ 的地方发生且反应进度显著。\n\n测试套件：\n使用以下七个测试用例，每个用例都是一个三元组 $(\\chi, Z, c_{meas})$，其中 $\\chi$ 的单位是 $\\text{s}^{-1}$，$Z$ 和 $c_{meas}$ 是无量纲的：\n- 用例 A: $(\\chi, Z, c_{meas}) = (10, 0.055, 0.80)$，\n- 用例 B: $(\\chi, Z, c_{meas}) = (10, 0.10, 0.60)$，\n- 用例 C: $(\\chi, Z, c_{meas}) = (10, 0.070, 0.40)$，\n- 用例 D: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.00)$，\n- 用例 E: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.50)$，\n- 用例 F: $(\\chi, Z, c_{meas}) = (5, 0.00, 0.00)$，\n- 用例 G: $(\\chi, Z, c_{meas}) = (5, 1.00, 0.00)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含七个案例的分类代码，形式为方括号内以逗号分隔的列表（例如 `\"[1,3,2,4,3,0,0]\"`）。不应打印任何其他文本。所有物理单位已在其各自的定义中指定；输出本身是无量纲的整数代码。",
            "solution": "在尝试求解之前，对问题陈述进行了严格的验证过程。\n\n### 步骤1：提取已知条件\n\n- **标量变量与坐标**：\n  - 混合分数: $Z \\in [0,1]$\n  - 反应进度变量: $c \\in [0,1]$\n- **物理常数与参数**：\n  - 化学计量混合分数: $Z_{st} = 0.055$\n  - 有效化学反应速率常数: $k_0 = 60 \\text{ s}^{-1}$\n  - Z空间中的反应区宽度: $\\sigma = 0.02$\n  - 临界标量耗散率: $\\chi_{crit} = 25 \\text{ s}^{-1}$\n  - 标量耗散率测试集: $\\{\\chi_1, \\chi_2, \\chi_3\\} = \\{5, 10, 30\\} \\text{ s}^{-1}$\n  - 温度映射参数: $T_u = 300 \\text{ K}$，$\\Delta T_{max} = 1920 \\text{ K}$，$\\sigma_T = 0.04$\n- **控制方程（稳态层流火焰面）**：\n  - $\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z) = 0$\n- **反应源项模型**：\n  - $\\dot{\\omega}_c(c,Z;\\chi) = k_0 \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma^2}\\right) \\, c(1-c) \\, \\max\\!\\left(0, 1 - \\frac{\\chi}{\\chi_{crit}}\\right)$\n- **边界条件**：\n  - 狄利克雷条件: $c(0) = 0$ 和 $c(1) = 0$\n- **数值参数**：\n  - 空间网格点数: $N \\ge 201$\n  - 伪时间推进的收敛容差: 更新量的无穷范数  $10^{-8}$\n- **分类参数**：\n  - 反应进度阈值: $c_{th} = 0.05$\n  - 化学计量比邻近度: $\\delta_Z = 0.02$\n  - 一致性容差: $tol_c = 0.10$\n- **分类规则**：\n  1. 如果 $c_{ref}  c_{th}$ 且 $\\chi \\ge \\chi_{crit}$ 且 $c_{meas}  c_{th}$，分类为代码 $4$。\n  2. 否则，如果 $c_{ref} \\ge c_{th}$ 且 $|c_{meas} - c_{ref}| \\le tol_c$ 且 $|Z - Z_{st}| \\le \\delta_Z$，分类为代码 $1$。\n  3. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| \\le \\delta_Z$，分类为代码 $2$。\n  4. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| > \\delta_Z$，分类为代码 $3$。\n  5. 否则分类为代码 $0$。\n- **测试套件**：\n  - 用例 A: $(\\chi, Z, c_{meas}) = (10, 0.055, 0.80)$\n  - 用例 B: $(\\chi, Z, c_{meas}) = (10, 0.10, 0.60)$\n  - 用例 C: $(\\chi, Z, c_{meas}) = (10, 0.070, 0.40)$\n  - 用例 D: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.00)$\n  - 用例 E: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.50)$\n  - 用例 F: $(\\chi, Z, c_{meas}) = (5, 0.00, 0.00)$\n  - 用例 G: $(\\chi, Z, c_{meas}) = (5, 1.00, 0.00)$\n\n### 步骤2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估：\n\n- **科学依据**：该问题建立在层流火焰面模型之上，这是湍流燃烧理论的基石。控制方程是混合分数空间中反应-扩散平衡的简化但标准化的表示。所做的假设（单位刘易斯数、恒定密度）是为了创建易于处理但信息丰富的模型而常做的。源项虽然是唯象的，但正确地捕捉了化学反应在化学计量比附近的局部性、其对反应物/生成物浓度的依赖性（通过 $c(1-c)$），以及在高标量耗散率下火焰熄灭的物理现象。作为一个燃烧模拟的计算练习，该问题在科学上是一致且合理的。\n- **适定性**：核心任务是求解一个一维、二阶、非线性的边界值问题（BVP）。在指定的狄利克雷边界条件 $c(0)=0$ 和 $c(1)=0$ 下，该问题是适定的。建议的数值方法，即采用半隐式格式的伪时间推进法，是解决此类边界值问题的标准且稳健的技术。分类规则以一套完整且确定性的`if-elif-else`条件给出，保证了对任何输入都有唯一的分类。\n- **客观性**：所有参数、方程和规则都经过了精确的数学定义。没有主观或含糊不清的陈述。\n- **完整性与一致性**：问题是自洽的。所有必需的常数、方程、边界条件以及数值和分类参数都已提供。单位在整个问题中是一致的（例如，$k_0$ 和 $\\chi$ 的单位都是 $\\text{s}^{-1}$）。没有内部矛盾。\n- **其他缺陷**：该问题并非不切实际、不适定、微不足道或无法验证。它代表了计算科学中的一个标准数值任务。\n\n### 步骤3：结论与行动\n\n该问题是**有效的**。它是一个适定的、有科学依据且精确定义的计算任务。可以开始求解过程。\n\n### 解法\n\n求解过程分为两个阶段：首先，数值构建层流火焰面数据库 $c(Z;\\chi)$；其次，使用该数据库对局部燃烧状态进行分类。\n\n**1. 火焰面数据库的构建**\n\n分析的基础是稳态层流火焰面方程，它描述了在混合分数 $Z$ 坐标系中，反应进度变量 $c$ 的分子扩散与化学反应之间的平衡：\n$$\n\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z;\\chi) = 0\n$$\n这是一个非线性的二阶常微分方程，边界条件为 $c(Z=0)=0$ 和 $c(Z=1)=0$。我们对每个指定的标量耗散率 $\\chi \\in \\{5, 10, 30\\} \\, \\text{s}^{-1}$ 数值求解此方程。\n\n求解此类方程的一种稳健方法是伪时间推进法，其中稳态方程被重新表述为一个瞬态问题，其解会收敛到所期望的稳态解：\n$$\n\\frac{\\partial c}{\\partial t} = \\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z;\\chi)\n$$\n我们将空间域 $Z \\in [0,1]$ 离散化为 $N=201$ 个均匀分布的网格点 $Z_i = i \\Delta Z$，其中 $\\Delta Z = 1/(N-1)$。空间导数使用二阶中心差分格式进行近似：\n$$\n\\frac{\\partial^2 c}{\\partial Z^2}\\bigg|_{Z_i} \\approx \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta Z)^2}\n$$\n对于时间离散化，如建议所言，采用半隐式格式，对刚性的扩散项进行隐式处理，对非线性的反应项进行显式处理。在时间步长 $n$ 使用隐式欧拉格式处理扩散项，显式欧拉格式处理反应项，以求得在 $n+1$ 时的解：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = \\chi \\left( \\frac{c_{i+1}^{n+1} - 2c_i^{n+1} + c_{i-1}^{n+1}}{(\\Delta Z)^2} \\right) + \\dot{\\omega}_c(c_i^n, Z_i; \\chi)\n$$\n重新整理各项，将所有未知值 $c^{n+1}$ 聚集在等式左侧：\n$$\n-\\alpha c_{i-1}^{n+1} + (1 + 2\\alpha) c_i^{n+1} - \\alpha c_{i+1}^{n+1} = c_i^n + \\Delta t \\cdot \\dot{\\omega}_c(c_i^n, Z_i; \\chi)\n$$\n其中 $\\alpha = \\chi \\Delta t / (\\Delta Z)^2$。此方程对所有内部网格点 $i=1, \\dots, N-2$ 均成立。这就形成了一个三对角线性方程组 $A \\mathbf{c}^{n+1} = \\mathbf{b}^n$，可以在每个时间步长高效求解。该过程从 $c(Z, t=0)=0$ 开始，并进行迭代，直到连续解之间的变化量 $\\|\\mathbf{c}^{n+1} - \\mathbf{c}^n\\|_{\\infty}$ 小于收敛容差 $10^{-8}$。\n\n对于 $\\chi \\ge \\chi_{crit}$ 的情况，项 $\\max(0, 1-\\chi/\\chi_{crit})$ 变为 $0$，使得反应源项 $\\dot{\\omega}_c \\equiv 0$。控制方程简化为扩散方程 $\\chi \\frac{\\partial^2 c}{\\partial Z^2} = 0$，边界条件为 $c(0)=0$ 和 $c(1)=0$。其唯一解是平凡解 $c(Z) = 0$，代表化学熄火状态。这个解析结果直接用于 $\\chi=30 \\, \\text{s}^{-1}$。\n\n该过程最终得到三个不同的火焰面剖面，$c(Z; \\chi=5)$、$c(Z; \\chi=10)$ 和 $c(Z; \\chi=30)$，它们共同构成了火焰面数据库。\n\n**2. 燃烧模式的分类**\n\n计算出火焰面数据库后，我们就可以为每个测试用例的局部状态 $(\\chi, Z_{meas}, c_{meas})$ 进行分类。分类的核心是将测量的反应进度变量 $c_{meas}$ 与来自火焰面数据库的参考值 $c_{ref} = c(Z_{meas}; \\chi)$ 进行比较。该参考值是通过在 $Z_{meas}$ 位置对预先计算的相应剖面 $c(Z;\\chi)$ 进行线性插值得到的。\n\n然后通过系统地应用给定的分层规则集进行分类：\n1.  **代码4 (熄火的非预混火焰面)**：适用于标量耗散率 $\\chi$ 大于或等于临界值 $\\chi_{crit}$，且参考和测量的反应进度变量都低于点火阈值 $c_{th}$ 的情况。这标识了一种混合过于剧烈以致非预混火焰无法维持的状态。\n2.  **代码1 (非预混火焰面燃烧)**：当局部条件接近化学计量比（$|Z - Z_{st}| \\le \\delta_Z$），有显著的反应进度（$c_{ref} \\ge c_{th}$），并且测量的反应进度变量 $c_{meas}$ 与火焰面数据库的预测值一致（$|c_{meas} - c_{ref}| \\le tol_c$）时，识别为该状态。这代表了典型的非预混燃烧。\n3.  **代码2 (部分预混燃烧)**：此规则捕捉了那些接近化学计量比且显示出显著反应，但反应进度变量 $c_{meas}$ 偏离非预混火焰面值的状态。这种偏差表明局部混合物的组分并非源于纯粹的未燃燃料和氧化剂流，暗示了事先存在部分预混。\n4.  **代码3 (预混燃烧)**：该代码分配给那些具有显著反应进度（$c_{meas} \\ge c_{th}$）但发生在远离化学计量混合分数（$|Z - Z_{st}| > \\delta_Z$）的状态。这标识了在贫燃或富燃预混状态下燃烧的火焰。\n5.  **代码0 (未燃或惰性)**：这是对任何不满足燃烧或熄火标准的状态的默认分类，通常对应于反应进度可忽略不计（$c_{meas}  c_{th}$）的区域。\n\n最终的实现将计算该数据库，然后将此分类逻辑应用于七个测试用例中的每一个，以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the computational combustion problem by first constructing a flamelet\n    manifold and then using it to classify burning regimes.\n    \"\"\"\n\n    # --- Givens: Constants and Parameters ---\n    # Model parameters\n    Z_st = 0.055       # Stoichiometric mixture fraction\n    k_0 = 60.0         # Rate constant (1/s)\n    sigma = 0.02       # Reaction zone width\n    chi_crit = 25.0    # Critical scalar dissipation rate (1/s)\n\n    # Numerical parameters\n    N = 201                      # Number of grid points\n    max_iter = 20000             # Max iterations for time marching\n    conv_tol = 1e-8              # Convergence tolerance\n    dt = 1e-4                    # Pseudo-time step (s)\n\n    # Classification parameters\n    c_th = 0.05        # Progress threshold\n    delta_Z = 0.02     # Stoichiometric proximity\n    tol_c = 0.10       # Consistency tolerance\n\n    # Chi values for manifold computation\n    chi_values = [5.0, 10.0, 30.0]\n\n    # Test cases: (chi, Z_meas, c_meas)\n    test_cases = [\n        (10.0, 0.055, 0.80), # A\n        (10.0, 0.10, 0.60),  # B\n        (10.0, 0.070, 0.40),  # C\n        (30.0, 0.055, 0.00),  # D\n        (30.0, 0.055, 0.50),  # E\n        (5.0, 0.00, 0.00),   # F\n        (5.0, 1.00, 0.00),   # G\n    ]\n\n    # --- Stage 1: Compute Flamelet Manifold ---\n    Z_grid = np.linspace(0, 1, N)\n    dZ = Z_grid[1] - Z_grid[0]\n    \n    manifold_profiles = {}\n\n    for chi in chi_values:\n        # If chi >= chi_crit, flame is extinguished, c(Z) = 0\n        if chi >= chi_crit:\n            manifold_profiles[chi] = np.zeros(N)\n            continue\n        \n        # Initialize progress variable profile\n        c = np.zeros(N)\n        \n        # --- Set up the tridiagonal system for implicit diffusion ---\n        # A * c_new = b\n        # A is tridiagonal: [diag_lower, diag_main, diag_upper]\n        alpha = chi * dt / (dZ**2)\n        \n        # Banded matrix representation for scipy.linalg.solve_banded\n        # (l=1, u=1) -> 3 rows\n        # Row 0: super-diagonal (u)\n        # Row 1: main diagonal\n        # Row 2: sub-diagonal (l)\n        A_banded = np.zeros((3, N - 2))\n        A_banded[0, 1:] = -alpha  # Super-diagonal\n        A_banded[1, :] = 1.0 + 2.0 * alpha # Main diagonal\n        A_banded[2, :-1] = -alpha # Sub-diagonal\n\n        # --- Pseudo-time marching loop ---\n        for _ in range(max_iter):\n            c_old = c.copy()\n            \n            # Calculate reaction source term (explicit)\n            reaction_gaussian = np.exp(-((Z_grid - Z_st)**2) / (2 * sigma**2))\n            extinction_term = max(0, 1 - chi / chi_crit)\n            omega_c = k_0 * reaction_gaussian * c * (1 - c) * extinction_term\n            \n            # Right-hand side of the linear system\n            rhs = c + dt * omega_c\n            \n            # Solve the tridiagonal system A*c = b for interior points\n            # Dirichlet BCs c[0]=0, c[N-1]=0 are handled implicitly as they\n            # don't appear in the (N-2)x(N-2) system.\n            c[1:-1] = solve_banded((1, 1), A_banded, rhs[1:-1])\n\n            # Check for convergence\n            if np.linalg.norm(c - c_old, np.inf)  conv_tol:\n                break\n        \n        manifold_profiles[chi] = c\n\n    # --- Stage 2: Classify Test Cases ---\n    results = []\n    for chi_meas, Z_meas, c_meas in test_cases:\n        # Get the corresponding flamelet profile\n        c_profile = manifold_profiles[chi_meas]\n        \n        # Interpolate to find reference progress variable c_ref\n        c_ref = np.interp(Z_meas, Z_grid, c_profile)\n        \n        # Apply classification rules\n        code = 0 # Default classification\n        \n        # Rule 1: Extinguished non-premixed\n        if c_ref  c_th and chi_meas >= chi_crit and c_meas  c_th:\n            code = 4\n        # Rule 2: Non-premixed flamelet burning\n        elif c_ref >= c_th and abs(c_meas - c_ref) = tol_c and abs(Z_meas - Z_st) = delta_Z:\n            code = 1\n        # Rule 3: Partially premixed burning\n        elif c_meas >= c_th and abs(Z_meas - Z_st) = delta_Z:\n            code = 2\n        # Rule 4: Premixed burning\n        elif c_meas >= c_th and abs(Z_meas - Z_st) > delta_Z:\n            code = 3\n        # Rule 5: Unburnt or inert (default else case)\n        else:\n            code = 0\n\n        results.append(code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}