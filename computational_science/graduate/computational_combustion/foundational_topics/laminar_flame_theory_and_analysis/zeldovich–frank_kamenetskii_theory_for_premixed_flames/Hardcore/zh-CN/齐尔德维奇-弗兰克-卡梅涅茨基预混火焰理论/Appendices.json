{
    "hands_on_practices": [
        {
            "introduction": "ZFK理论的核心在于大活化能的假设，即化学反应对温度的敏感性极强。为了量化这一假设，我们引入了两个关键的无量纲参数：Zeldovich数（$Ze$）和无量纲活化能（$\\beta$）。本练习旨在通过计算真实火焰（氢气-空气火焰）的$Ze$和$\\beta$值，将这些抽象概念具体化，并评估在此情况下应用大活化能渐近法的合理性。",
            "id": "4077905",
            "problem": "考虑一个由单步阿伦尼乌斯反应描述的化学计量的氢气-空气平面绝热预混火焰，其活化能为$E$，普适气体常数为$R$。未燃气体温度为$T_u$，已燃气体（绝热火焰）温度为$T_b$。在用于预混火焰的 Zeldovich–Frank-Kamenetskii (ZFK) 框架中，高活化能渐近 (HAEA) 方法通过在 $T_b$ 附近对 $1/T$ 进行线性化来近似阿伦尼乌斯指数项的温度敏感性，并定义了依赖于 $E$、$R$、$T_u$ 和 $T_b$ 的无量纲温度敏感性度量。\n\n从阿伦尼乌斯形式 $\\exp\\!\\big(-E/(R T)\\big)$ 和 $1/T$ 在 $T_b$ 附近的线性化出发，推导泽尔多维奇数 $\\Ze$ 和无量纲活化能 $\\beta$ 关于 $E$、$R$、$T_u$ 和 $T_b$ 的表达式。然后，对于具有以下数值的氢气-空气混合物：\n- $E = 2.0 \\times 10^{5}\\ \\mathrm{J\\,mol^{-1}}$,\n- $R = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n- $T_u = 300\\ \\mathrm{K}$,\n- $T_b = 2200\\ \\mathrm{K}$,\n\n计算 $\\Ze$ 和 $\\beta$ 的数值。将您的数值结果四舍五入到三位有效数字。以无量纲数的形式表示最终答案。根据您获得的数值大小，简要评论高活化能渐近法对于该火焰是否合理。",
            "solution": "单步反应速率的阿伦尼乌斯温度依赖性可以写为 $\\exp\\!\\big(-E/(R T)\\big)$，其中 $E$ 是活化能，$R$ 是普适气体常数。在 Zeldovich–Frank-Kamenetskii (ZFK) 框架中，高活化能渐近 (HAEA) 假设指数形式的温度敏感性占主导地位，并使用 $1/T$ 在已燃温度 $T_b$ 附近的线性化：\n\n$$\n\\frac{1}{T} \\approx \\frac{1}{T_b} - \\frac{T - T_b}{T_b^{2}}.\n$$\n\n将此代入阿伦尼乌斯指数项，得到\n\n$$\n\\exp\\!\\left(-\\frac{E}{R T}\\right) \\approx \\exp\\!\\left(-\\frac{E}{R T_b}\\right)\\,\\exp\\!\\left(\\frac{E}{R}\\,\\frac{T - T_b}{T_b^{2}}\\right).\n$$\n\n这表明在 $T_b$ 附近的温度波动引起的指数敏感性由因子 $(E/R)/T_b^{2}$ 控制。通常可以提取出两个无量纲度量：\n\n1. 无量纲活化能，\n\n$$\n\\beta \\equiv \\frac{E}{R T_b},\n$$\n\n它将活化能与已燃温度下的热能进行比较。\n\n2. 泽尔多维奇数，它量化了阿伦尼乌斯指数在火焰中从 $T_u$ 到 $T_b$ 的净变化，\n\n$$\n\\Ze \\equiv \\frac{E}{R}\\,\\frac{T_b - T_u}{T_b^{2}} = \\beta\\,\\left(1 - \\frac{T_u}{T_b}\\right).\n$$\n\n这些是通过使用线性化的 $1/T$ 在 $T_u$ 和 $T_b$ 之间评估指数的变化直接得出的。\n\n我们现在用给定的值计算 $\\beta$ 和 $\\Ze$。在最终数值计算之前，保持所有量为符号形式：\n\n$$\n\\beta = \\frac{E}{R T_b}, \\qquad \\Ze = \\beta\\left(1 - \\frac{T_u}{T_b}\\right).\n$$\n\n代入 $E = 2.0 \\times 10^{5}\\ \\mathrm{J\\,mol^{-1}}$，$R = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$T_u = 300\\ \\mathrm{K}$ 和 $T_b = 2200\\ \\mathrm{K}$：\n\n$$\n\\beta = \\frac{2.0 \\times 10^{5}}{8.314 \\times 2200},\n$$\n\n\n$$\n\\frac{T_u}{T_b} = \\frac{300}{2200},\n\\qquad\n\\Ze = \\beta\\left(1 - \\frac{300}{2200}\\right).\n$$\n\n计算 $\\beta$：\n\n$$\n8.314 \\times 2200 = 18290.8,\n\\qquad\n\\beta = \\frac{200000}{18290.8} \\approx 10.9349.\n$$\n\n计算温度比和 $\\Ze$：\n\n$$\n\\frac{300}{2200} \\approx 0.13636,\n\\qquad\n1 - \\frac{300}{2200} \\approx 0.86364,\n$$\n\n\n$$\n\\Ze \\approx 10.9349 \\times 0.86364 \\approx 9.4440。\n$$\n\n四舍五入到三位有效数字：\n\n$$\n\\beta \\approx 10.9, \\qquad \\Ze \\approx 9.44.\n$$\n\n\n关于HAEA合理性的评论：高活化能渐近法基于 $\\beta \\gg 1$ 的前提，这确保了指数形式的温度敏感性占主导地位，并且在 $T_b$ 附近的线性化能够捕捉到主导阶行为。在这里，$\\beta \\approx 10.9$ 比 1 大一个数量级，而 $\\Ze \\approx 9.44$ 表明整个火焰具有很强的温度敏感性。这些数值通常被认为足以使 ZFK HAEA 对氢气-空气火焰具有中等程度的合理性，尽管并非渐近极端情况；因此，主导阶 HAEA 结果在定性上应是可靠的，但可能需要修正以进行精确的定量预测。",
            "answer": "$$\\boxed{\\begin{pmatrix}9.44  10.9\\end{pmatrix}}$$"
        },
        {
            "introduction": "ZFK理论不仅能预测火焰传播速度，还能揭示火焰的内部结构。在薄薄的内部反应区内，温度和反应物浓度共同决定了化学反应速率。本练习将引导你深入分析反应区的内部，推导并确定反应速率达到峰值的位置，这有助于你理解温度升高和反应物消耗之间的微妙平衡。",
            "id": "4077926",
            "problem": "考虑一个稳态、平面、层流、化学计量的预混火焰，其刘易斯数 $\\Le=1$，热物理性质恒定，且热损失可忽略不计。燃料质量分数 $Y$ 的化学源项由单步 Arrhenius 定律 $\\omega(T,Y) = A\\,Y\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)$ 建模，其中 $A$ 是指前因子，$E$ 是活化能，$R$ 是普适气体常数，$T$ 是当地温度。未燃和已燃温度分别为 $T_u$ 和 $T_b$，且 $T_b  T_u$，未燃燃料质量分数为 $Y_u$。在适用于预混火焰的 Zeldovich–Frank-Kamenetskii (ZFK) 理论的大活化能渐近极限下进行分析，并使用温度倒数在已燃温度 $T_b$ 附近的一阶 Frank-Kamenetskii 展开。在内反应区内，利用刘易斯数为 1 时的能量和组分守恒，将燃料质量分数 $Y$ 与当地温度 $T$ 联系起来，然后确定依赖于温度的源项 $\\omega(T)$。\n\n基于这些基础，完成以下任务：\n- 推导内反应区中峰值源项 $\\omega_{\\max}$ 的解析表达式，该表达式仅用 $A$、$E$、$R$、$T_u$、$T_b$ 和 $Y_u$ 表示。\n- 通过给出峰值出现时的温差 $\\Delta T_{\\text{peak}} = T_b - T_{\\text{peak}}$，估算该峰值相对于温度最大值的位置，同样仅用 $A$、$E$、$R$、$T_u$、$T_b$ 和 $Y_u$ 表示。\n\n将你的最终答案以包含两个条目 $\\omega_{\\max}$ 和 $\\Delta T_{\\text{peak}}$ 的行矩阵形式报告。反应速率以 $\\text{s}^{-1}$ 为单位，温差以 $\\text{K}$ 为单位表示。不需要提供数值；请提供封闭形式的表达式。如果引入任何缩写词，请在首次使用时写出其全称。",
            "solution": "该问题要求采用 Zeldovich–Frank-Kamenetskii (ZFK) 理论，推导预混火焰内反应区中的峰值化学源项及其位置。该分析在稳态、平面、一维火焰、刘易斯数 $\\Le=1$、热物理性质恒定以及单步 Arrhenius 反应机理的假设下进行。\n\n首先，我们建立燃料质量分数 $Y$ 和当地温度 $T$ 之间的关系。问题指明刘易斯数 $\\Le=1$，即 $\\Le = \\frac{\\alpha}{D} = 1$，其中 $\\alpha$ 是热扩散率，$D$ 是质量扩散率。对于单步不可逆反应（燃料 $\\rightarrow$ 产物），在这些假设下，组分和能量守恒方程可以结合起来，得到 $Y$ 和 $T$ 之间的线性关系。这被称为 Shvab-Zeldovich 耦合关系。我们为温度和质量分数定义归一化变量。令归一化温度为 $\\theta = \\frac{T - T_u}{T_b - T_u}$，其中 $T_u$ 和 $T_b$ 分别是未燃和已燃气体温度。令归一化燃料质量分数为 $y = \\frac{Y}{Y_u}$，其中 $Y_u$ 是未燃混合物中的燃料质量分数。在未燃状态下（$T=T_u$, $Y=Y_u$），我们有 $\\theta=0$ 和 $y=1$。在完全燃烧状态下（$T=T_b$, $Y=0$），我们有 $\\theta=1$ 和 $y=0$。对于 $\\Le=1$ 的耦合关系由下式给出：\n$$ \\theta + y = 1 $$\n根据这个关系，我们可以将燃料质量分数 $Y$ 表示为温度 $T$ 的函数：\n$$ \\frac{Y}{Y_u} = 1 - \\theta = 1 - \\frac{T - T_u}{T_b - T_u} = \\frac{(T_b - T_u) - (T - T_u)}{T_b - T_u} $$\n$$ Y(T) = Y_u \\left( \\frac{T_b - T}{T_b - T_u} \\right) $$\n该表达式在整个火焰结构中都成立。\n\n接下来，我们构建依赖于温度的化学源项 $\\omega(T)$。源项由 Arrhenius 定律给出：\n$$ \\omega(T,Y) = A\\,Y\\,\\exp\\left(-\\frac{E}{R\\,T}\\right) $$\n将 $Y(T)$ 的表达式代入 Arrhenius 定律，得到仅作为温度函数的源项：\n$$ \\omega(T) = A \\left( Y_u \\frac{T_b - T}{T_b - T_u} \\right) \\exp\\left(-\\frac{E}{R\\,T}\\right) $$\n\nZFK 理论基于大活化能渐近分析，该分析假设化学反应仅在温度接近最终已燃温度 $T_b$ 的一个非常狭窄的区域内才显著。在此区域，我们对指数项中的温度倒数 $1/T$ 进行一阶 Frank-Kamenetskii 展开。我们定义一个小的温差 $\\tau = T_b - T$，使得 $T = T_b - \\tau$。对于 $\\tau \\ll T_b$，展开式为：\n$$ \\frac{1}{T} = \\frac{1}{T_b - \\tau} = \\frac{1}{T_b(1 - \\tau/T_b)} \\approx \\frac{1}{T_b}\\left(1 + \\frac{\\tau}{T_b}\\right) = \\frac{1}{T_b} + \\frac{T_b - T}{T_b^2} $$\n将此代入源项的指数部分，得到：\n$$ \\exp\\left(-\\frac{E}{R\\,T}\\right) \\approx \\exp\\left[-\\frac{E}{R}\\left(\\frac{1}{T_b} + \\frac{T_b - T}{T_b^2}\\right)\\right] = \\exp\\left(-\\frac{E}{R\\,T_b}\\right) \\exp\\left(-\\frac{E (T_b - T)}{R T_b^2}\\right) $$\n现在，将此近似代回 $\\omega(T)$ 的表达式，我们得到在内反应区内有效的源项：\n$$ \\omega(T) \\approx A Y_u \\left( \\frac{T_b - T}{T_b - T_u} \\right) \\exp\\left(-\\frac{E}{R\\,T_b}\\right) \\exp\\left(-\\frac{E (T_b - T)}{R T_b^2}\\right) $$\n\n为了找到峰值源项 $\\omega_{\\max}$，我们必须找到使 $\\omega(T)$ 达到最大值时的温度 $T_{\\text{peak}}$。我们可以通过对 $\\omega(T)$ 关于 $T$ 求导并将结果设为零来实现。为了简化，我们定义一个变量 $x = T_b - T$。$\\omega$ 的表达式变为 $x$ 的函数：\n$$ \\omega(x) \\approx \\left[ \\frac{A Y_u}{T_b - T_u} \\exp\\left(-\\frac{E}{R\\,T_b}\\right) \\right] x \\exp\\left(-\\frac{E x}{R T_b^2}\\right) $$\n令 $C_1 = \\frac{A Y_u}{T_b - T_u} \\exp\\left(-\\frac{E}{R\\,T_b}\\right)$ 且 $C_2 = \\frac{E}{R T_b^2}$。需要最大化的函数是 $\\omega(x) = C_1 x \\exp(-C_2 x)$。对 $x$ 求导：\n$$ \\frac{d\\omega}{dx} = C_1 \\left( \\exp(-C_2 x) - C_2 x \\exp(-C_2 x) \\right) = C_1 \\exp(-C_2 x) (1 - C_2 x) $$\n将导数设为零，由于 $C_1 > 0$ 且 $\\exp(-C_2 x) > 0$，我们必须有：\n$$ 1 - C_2 x = 0 \\implies x = \\frac{1}{C_2} $$\n这个 $x$ 的值对应于峰值处的温差 $\\Delta T_{\\text{peak}} = T_b - T_{\\text{peak}}$。将 $C_2$ 的表达式代回：\n$$ \\Delta T_{\\text{peak}} = \\frac{1}{C_2} = \\frac{R T_b^2}{E} $$\n这是峰值源项的位置，表示为与已燃气体温度的温差。此结果依赖于 $R$、$T_b$ 和 $E$。\n\n最后，我们通过将 $x_{\\text{peak}} = 1/C_2$ 代回 $\\omega(x)$ 的表达式来计算峰值源项 $\\omega_{\\max}$：\n$$ \\omega_{\\max} = \\omega(x_{\\text{peak}}) = C_1 x_{\\text{peak}} \\exp(-C_2 x_{\\text{peak}}) $$\n由于 $C_2 x_{\\text{peak}} = 1$，这简化为：\n$$ \\omega_{\\max} = \\frac{C_1}{e C_2} $$\n代入 $C_1$ 和 $C_2$ 的表达式：\n$$ \\omega_{\\max} = \\frac{\\frac{A Y_u}{T_b - T_u} \\exp\\left(-\\frac{E}{R\\,T_b}\\right)}{e \\left(\\frac{E}{R T_b^2}\\right)} $$\n$$ \\omega_{\\max} = \\frac{A Y_u R T_b^2}{e E (T_b - T_u)} \\exp\\left(-\\frac{E}{R\\,T_b}\\right) $$\n这个最大反应速率 $\\omega_{\\max}$ 的表达式依赖于所有要求的参数：$A$、$Y_u$、$R$、$T_b$、$T_u$ 和 $E$。\n\n因此，所需的两个量被推导为封闭形式的表达式。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{A Y_u R T_b^2}{e E (T_b - T_u)} \\exp\\left(-\\frac{E}{R T_b}\\right)  \\frac{R T_b^2}{E} \\end{pmatrix} } $$"
        },
        {
            "introduction": "真实燃烧过程涉及复杂的详细化学反应机理，而ZFK理论则采用了一个高度简化的单步反应模型。一个关键问题是：这个单步模型的有效动力学参数（如活化能$E_{\\text{eff}}$）如何从更真实的化学模型中获得？本练习提供了一个计算实践，通过对合成的“详细”动力学数据进行回归分析，来确定单步模型的有效参数，从而展示ZFK理论作为模型降阶工具的实际应用价值。",
            "id": "4077944",
            "problem": "您需要实现一个程序，该程序针对一组代表预混火焰详细机理推导出的内区数据的综合基准案例，确定一个有效活化能，并根据基准反应速率剖面对单步 Zeldovich–Frank-Kamenetskii (ZFK) 拟合进行验证。用于预混火焰的 ZFK 理论（Zeldovich–Frank-Kamenetskii）考虑了一个大活化能渐近极限，其中内部反应区主要受温度敏感性的控制，从而能够用一个有效的单步 Arrhenius 形式来描述反应速率。您的任务是构建并解决一个回归问题，从综合的“详细”内区数据中估算有效活化能，并量化单步拟合的质量。\n\n从以下基本定律和经过充分检验的公式开始：\n- 基元反应速率常数的 Arrhenius 定律：$k(T)=A T^{n} \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$，其中 $A$ 是指前因子，$n$ 是温度指数，$E$ 是活化能，$R$ 是通用气体常数，$T$ 是以 K 为单位的绝对温度。\n- 在预混火焰 ZFK 理论的大活化能渐近分析中，内区的反应速率主要由温度敏感性决定，这启发我们在一个有限的内区温度区间内，使用一个简化的一步模型 $\\hat{\\omega}(T) = A_{\\text{eff}} \\exp\\!\\left(-\\dfrac{E_{\\text{eff}}}{R T}\\right)$，在该区间内组分变化是次要的。\n\n为了在保持科学基础的同时避免对外部机理文件的依赖，“详细”的内区速率被合成为\n$$\n\\omega_{\\text{det}}(T) = A_0 \\left(\\frac{T}{T_{\\text{ref}}}\\right)^{n} \\exp\\!\\left(-\\frac{E_0}{R T}\\right)\\,\\phi(T),\n$$\n其中 $A_0$、$n$ 和 $E_0$ 是底层详细动力学的参数，而\n$$\n\\phi(T) = \\left[\\frac{1}{1+\\exp\\!\\left(\\dfrac{T-T_{\\text{mid}}}{\\Delta T}\\right)}\\right]^{s}\n$$\n将内区组分消耗模拟为一个平滑的乘法因子，其形状参数为 $s$、$T_{\\text{mid}}$ 和 $\\Delta T$。通用气体常数为 $R=8.314\\,\\mathrm{J/(mol\\cdot K)}$。所有温度 $T$、$T_{\\text{mid}}$、$\\Delta T$、$T_{\\text{ref}}$、$T_u$ 和 $T_b$ 都必须以 K 为单位，所有活化能 $E_0$ 和 $E_{\\text{eff}}$ 在内部必须以 $\\mathrm{J/mol}$ 处理。您必须以 $\\mathrm{kJ/mol}$ 为单位报告 $E_{\\text{eff}}$。\n\n对于每个测试用例，构建一个内区温度区间 $[T_1,T_2]$，其中\n$$\nT_1 = T_u + 0.6\\,(T_b - T_u), \\qquad T_2 = T_u + 0.9\\,(T_b - T_u),\n$$\n在此区间内均匀采样 $N$ 个温度点（使用 $N=241$），计算基准值 $\\omega_{\\text{det}}(T_i)$，并确定常数 $A_{\\text{eff}}$ 和 $E_{\\text{eff}}$，以最小化 $\\ln \\omega_{\\text{det}}(T_i)$ 和 $\\ln \\hat{\\omega}(T_i)$ 之间的平方偏差之和，其中\n$$\n\\ln \\hat{\\omega}(T) = \\ln A_{\\text{eff}} - \\frac{E_{\\text{eff}}}{R} \\frac{1}{T}.\n$$\n这是一个关于变量 $\\ln A_{\\text{eff}}$ 和 $-\\dfrac{E_{\\text{eff}}}{R}$ 的线性最小二乘拟合。\n\n验证：在获得 $A_{\\text{eff}}$ 和 $E_{\\text{eff}}$ 后，计算\n- 对数空间中的决定系数，\n$$\nR^2_{\\log} = 1 - \\frac{\\sum_i\\left(\\ln \\omega_{\\text{det}}(T_i)-\\ln \\hat{\\omega}(T_i)\\right)^2}{\\sum_i\\left(\\ln \\omega_{\\text{det}}(T_i)-\\overline{\\ln \\omega_{\\text{det}}}\\right)^2},\n$$\n其中 $\\overline{\\ln \\omega_{\\text{det}}}$ 是 $\\ln \\omega_{\\text{det}}(T_i)$ 的样本均值。\n- 线性空间中的相对 $\\ell_2$ 误差，\n$$\n\\varepsilon_{\\text{rel}} = \\sqrt{\\frac{\\sum_i\\left(\\omega_{\\text{det}}(T_i)-\\hat{\\omega}(T_i)\\right)^2}{\\sum_i \\omega_{\\text{det}}(T_i)^2}}.\n$$\n\n测试套件：使用以下四个测试用例，每个用例由 $(T_u, T_b, E_0, A_0, n, s, T_{\\text{mid}}, \\Delta T, T_{\\text{ref}})$ 描述，单位如上所述：\n- 用例 1：$(300,\\,2200,\\,140000,\\,2.0\\times 10^{12},\\,0.0,\\,0.0,\\,1820,\\,40,\\,1000)$。\n- 用例 2：$(350,\\,2000,\\,130000,\\,5.0\\times 10^{11},\\,1.5,\\,0.0,\\,1720,\\,40,\\,1000)$。\n- 用例 3：$(300,\\,2100,\\,150000,\\,1.0\\times 10^{12},\\,0.5,\\,2.0,\\,1740,\\,30,\\,1000)$。\n- 用例 4：$(300,\\,1600,\\,60000,\\,8.0\\times 10^{10},\\,1.0,\\,1.0,\\,1210,\\,25,\\,1000)$。\n\n您的程序必须：\n- 对每个用例，在指定的内区区间上生成 $\\omega_{\\text{det}}(T)$，并执行最小二乘拟合以确定 $E_{\\text{eff}}$ 和 $A_{\\text{eff}}$。\n- 对每个用例，报告一个包含三个值的列表：以 $\\mathrm{kJ/mol}$ 表示的 $E_{\\text{eff}}$、$R^2_{\\log}$ 和 $\\varepsilon_{\\text{rel}}$。所有三个值都必须四舍五入到 $6$ 位小数。\n- 生成单行输出，其中包含结果，格式为一个逗号分隔的列表，包含四个用例的结果，每个用例的结果本身是一个列表，所有内容都用方括号括起来。例如：$[[e_1,r_1,\\varepsilon_1],[e_2,r_2,\\varepsilon_2],[e_3,r_3,\\varepsilon_3],[e_4,r_4,\\varepsilon_4]]$。\n\n角度单位不适用。确保报告的 $E_{\\text{eff}}$ 以 $\\mathrm{kJ/mol}$ 为单位，并且 $R^2_{\\log}$ 和 $\\varepsilon_{\\text{rel}}$ 都是无单位的小数。预期的输出是浮点数列表，每个测试用例一个列表，汇总成一个打印在单行上的顶级列表。",
            "solution": "该问题要求通过对一个综合的、但物理上具有代表性的详细反应速率剖面进行拟合，来确定预混火焰的有效单步 Arrhenius 动力学参数。在燃烧学中，这项任务对于降阶模型的开发至关重要。在这些模型中，涉及数百种物质和数千个反应的复杂化学过程被简化为几个全局步骤，以便在大型计算流体动力学模拟中使用。Zeldovich–Frank-Kamenetskii (ZFK) 理论提供了理论基础，它假设在大活化能极限下，火焰的薄内反应区主要由反应速率的温度敏感性控制。\n\n问题的核心是执行线性最小二乘回归。反应速率的单步模型 $\\hat{\\omega}(T)$ 由 Arrhenius 定律给出：\n$$\n\\hat{\\omega}(T) = A_{\\text{eff}} \\exp\\left(-\\frac{E_{\\text{eff}}}{R T}\\right)\n$$\n其中 $A_{\\text{eff}}$ 是有效指前因子，$E_{\\text{eff}}$ 是有效活化能，$R$ 是通用气体常数 ($8.314\\,\\mathrm{J/(mol\\cdot K)}$)，$T$ 是温度。这个方程在其参数上是非线性的。然而，通过取自然对数，我们可以将其线性化：\n$$\n\\ln \\hat{\\omega}(T) = \\ln A_{\\text{eff}} - \\frac{E_{\\text{eff}}}{R} \\frac{1}{T}\n$$\n该方程的形式为 $y = c + m x$，其中因变量是 $y = \\ln \\hat{\\omega}(T)$，自变量是 $x = 1/T$，截距是 $c = \\ln A_{\\text{eff}}$，斜率是 $m = -E_{\\text{eff}}/R$。\n\n综合的“详细”反应速率 $\\omega_{\\text{det}}(T)$ 作为基准数据。其定义如下：\n$$\n\\omega_{\\text{det}}(T) = A_0 \\left(\\frac{T}{T_{\\text{ref}}}\\right)^{n} \\exp\\left(-\\frac{E_0}{R T}\\right) \\phi(T)\n$$\n其中组分消耗因子为：\n$$\n\\phi(T) = \\left[\\frac{1}{1+\\exp\\left(\\frac{T-T_{\\text{mid}}}{\\Delta T}\\right)}\\right]^{s}\n$$\n这种形式捕捉了简单的单步模型中不存在的两个关键物理效应：指前因子的温度依赖性（通过 $T^n$ 项）和高温下反应物的消耗（通过 $\\phi(T)$ 项）。\n\n每个测试用例的步骤如下：\n\n1.  **定义温度域**：根据未燃气体温度 $T_u$ 和绝热火焰温度 $T_b$ 建立一个内区温度区间 $[T_1, T_2]$：\n    $$\n    T_1 = T_u + 0.6(T_b - T_u), \\qquad T_2 = T_u + 0.9(T_b - T_u)\n    $$\n    该区间用 $N=241$ 个均匀间隔的温度点 $\\{T_i\\}$进行采样。\n\n2.  **生成基准数据**：对于采样区间中的每个温度 $T_i$，计算相应的详细速率 $\\omega_{\\text{det}}(T_i)$。然后计算这些速率的自然对数 $\\ln \\omega_{\\text{det}}(T_i)$，为线性回归准备数据。\n\n3.  **执行线性回归**：我们寻找参数 $m$ 和 $c$，以最小化线性化模型与数据之间的残差平方和：\n    $$\n    \\underset{m, c}{\\text{minimize}} \\sum_{i=1}^{N} \\left( \\ln \\omega_{\\text{det}}(T_i) - (c + m x_i) \\right)^2 \\quad \\text{其中 } x_i = \\frac{1}{T_i}\n    $$\n    这是一个标准的普通最小二乘问题，可以高效求解。从得到的最优斜率 $m$ 和截距 $c$ 中，可以恢复出有效的动力学参数：\n    $$\n    E_{\\text{eff}} = -m R\n    $$\n    $$\n    A_{\\text{eff}} = \\exp(c)\n    $$\n    活化能 $E_{\\text{eff}}$ 以 $\\mathrm{J/mol}$ 为单位计算，然后转换为 $\\mathrm{kJ/mol}$ 进行报告。\n\n4.  **验证拟合**：使用两个指标来评估单步模型作为详细速率近似的质量：\n    a.  **对数空间中的决定系数**，$R^2_{\\log}$。该指标量化了执行回归的对数空间中的拟合优度。接近 1 的值表明线性模型解释了对数速率数据中的大部分方差。\n        $$\n        R^2_{\\log} = 1 - \\frac{\\sum_i\\left(\\ln \\omega_{\\text{det}}(T_i)-\\ln \\hat{\\omega}(T_i)\\right)^2}{\\sum_i\\left(\\ln \\omega_{\\text{det}}(T_i)-\\overline{\\ln \\omega_{\\text{det}}}\\right)^2}\n        $$\n    b.  **线性空间中的相对 $\\ell_2$ 误差**，$\\varepsilon_{\\text{rel}}$。该指标衡量反应速率原始物理空间中的误差，提供了对 ZFK 模型预测实际速率值的准确性的更直接评估。\n        $$\n        \\varepsilon_{\\text{rel}} = \\sqrt{\\frac{\\sum_i\\left(\\omega_{\\text{det}}(T_i)-\\hat{\\omega}(T_i)\\right)^2}{\\sum_i \\omega_{\\text{det}}(T_i)^2}}\n        $$\n\n将此完整过程应用于四个指定的测试用例中的每一个。最终输出汇总了每个用例计算出的三元组 $(E_{\\text{eff}}, R^2_{\\log}, \\varepsilon_{\\text{rel}})$，其值按要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ZFK effective parameter fitting problem for a set of test cases.\n    \"\"\"\n    R = 8.314  # Universal gas constant, J/(mol.K)\n    N = 241    # Number of sample points\n\n    # Test cases: (Tu, Tb, E0, A0, n, s, T_mid, Delta_T, T_ref)\n    test_cases = [\n        (300.0, 2200.0, 140000.0, 2.0e12, 0.0, 0.0, 1820.0, 40.0, 1000.0),\n        (350.0, 2000.0, 130000.0, 5.0e11, 1.5, 0.0, 1720.0, 40.0, 1000.0),\n        (300.0, 2100.0, 150000.0, 1.0e12, 0.5, 2.0, 1740.0, 30.0, 1000.0),\n        (300.0, 1600.0, 60000.0, 8.0e10, 1.0, 1.0, 1210.0, 25.0, 1000.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Tu, Tb, E0, A0, n, s, T_mid, Delta_T, T_ref = case\n\n        # 1. Define the temperature domain\n        T1 = Tu + 0.6 * (Tb - Tu)\n        T2 = Tu + 0.9 * (Tb - Tu)\n        T_samples = np.linspace(T1, T2, N)\n\n        # 2. Generate benchmark data (detailed rate)\n        # Composition depletion factor phi(T)\n        phi_T = (1.0 / (1.0 + np.exp((T_samples - T_mid) / Delta_T))) ** s\n        \n        # Detailed rate omega_det(T)\n        omega_det_T = A0 * ((T_samples / T_ref) ** n) * np.exp(-E0 / (R * T_samples)) * phi_T\n\n        # Prepare data for linear regression\n        x = 1.0 / T_samples\n        y = np.log(omega_det_T)\n\n        # 3. Perform linear regression: y = m*x + c\n        # np.polyfit returns [slope, intercept] for degree 1\n        m, c = np.polyfit(x, y, 1)\n\n        # Recover effective parameters\n        E_eff = -m * R  # in J/mol\n        A_eff = np.exp(c)\n        \n        # Convert E_eff to kJ/mol for reporting\n        E_eff_kjmol = E_eff / 1000.0\n\n        # 4. Validate the fit\n        # Predicted log rate\n        log_omega_hat_T = c + m * x\n        \n        # Coefficient of determination in log-space\n        y_mean = np.mean(y)\n        ss_res_log = np.sum((y - log_omega_hat_T) ** 2)\n        ss_tot_log = np.sum((y - y_mean) ** 2)\n        R2_log = 1.0 - (ss_res_log / ss_tot_log)\n        \n        # Predicted rate in linear space\n        omega_hat_T = A_eff * np.exp(-E_eff / (R * T_samples))\n        \n        # Relative l2 error in linear space\n        ss_res_lin = np.sum((omega_det_T - omega_hat_T) ** 2)\n        ss_tot_lin = np.sum(omega_det_T ** 2)\n        eps_rel = np.sqrt(ss_res_lin / ss_tot_lin)\n        \n        # Store rounded results for the current case\n        all_results.append([E_eff_kjmol, R2_log, eps_rel])\n\n    # Format the final output string as specified\n    case_results_str = []\n    for res in all_results:\n        # Round to 6 decimal places and format\n        case_str = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        case_results_str.append(case_str)\n        \n    final_output_str = f\"[{','.join(case_results_str)}]\"\n\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}