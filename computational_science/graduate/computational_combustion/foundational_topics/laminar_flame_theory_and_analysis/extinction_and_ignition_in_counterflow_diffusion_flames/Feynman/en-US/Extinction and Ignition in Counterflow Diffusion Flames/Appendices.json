{
    "hands_on_practices": [
        {
            "introduction": "Before tackling the complexities of finite-rate chemistry, it is essential to master the idealized structure of a diffusion flame. This exercise  guides you through the classic Burke-Schumann model, where chemistry is assumed to be infinitely fast. By applying the concept of conserved scalars and the mixture fraction ($Z$), you will derive the piecewise linear profiles for species and temperature, culminating in the calculation of the adiabatic flame temperature at the infinitesimally thin \"flame sheet.\" This practice builds the fundamental analytical framework upon which more advanced flamelet models are built.",
            "id": "4024507",
            "problem": "Consider a steady, laminar counterflow diffusion flame between a pure methane fuel stream and a pure oxygen oxidizer stream in the Burke–Schumann (BS) limit of infinitely fast chemistry, with unity Lewis numbers and adiabatic, nonradiative conditions. Let the reaction be $\\text{CH}_4 + 2\\text{O}_2 \\to \\text{CO}_2 + 2\\text{H}_2\\text{O}$, and define the stoichiometric oxidizer-to-fuel mass ratio as $s$, so that $s = 4$ for these pure streams. The mixture fraction $Z$ is defined as the conserved scalar representing the mass fraction of material originating from the fuel stream, so $Z = 1$ on the fuel boundary and $Z = 0$ on the oxidizer boundary. Assume constant and equal mixture specific heat $c_p$ for all species and temperatures, and take $c_p$, the Lower Heating Value (LHV) of methane per unit mass of fuel $q$, and the stream temperatures $T_F$ and $T_O$ as given.\n\nStarting from the conservation of mass, species, and enthalpy under the BS model, and using the definition of the stoichiometric mixture fraction $Z_{\\mathrm{st}}$, perform the following:\n\n1. Derive the piecewise species mass fraction fields $Y_F(Z)$, $Y_O(Z)$, and $Y_P(Z)$ for fuel-limited ($Z  Z_{\\mathrm{st}}$) and oxidizer-limited ($Z > Z_{\\mathrm{st}}$) sides, where the inert “products” lump the post-reaction mixture ($\\text{CO}_2$ and $\\text{H}_2\\text{O}$) as a single aggregate.\n2. Enforce conservation of total enthalpy (sensible plus chemical) across the flame sheet to construct the piecewise temperature field $T(Z)$ in terms of $T_F$, $T_O$, $q$, $c_p$, $s$, and $Z$.\n3. Evaluate the adiabatic flame temperature at $Z = Z_{\\mathrm{st}}$.\n\nUse the following numerically specified parameters: $T_F = 300\\,\\mathrm{K}$, $T_O = 1000\\,\\mathrm{K}$, $c_p = 3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1}$, $q = 5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$, and $s = 4$. Express the final adiabatic flame temperature in Kelvin, and round your final numerical answer to four significant figures.",
            "solution": "The problem describes a steady, one-dimensional counterflow diffusion flame under the Burke–Schumann (BS) or infinite-rate chemistry approximation. Key assumptions include unity Lewis numbers for all species, constant and equal specific heats $c_p$, and adiabatic, nonradiative conditions. We are asked to derive the species and temperature fields as functions of the mixture fraction $Z$ and then calculate the adiabatic flame temperature.\n\nThe mixture fraction $Z$ is a conserved scalar that tracks the mass originating from the fuel stream. It is defined to be $Z=1$ in the pure fuel stream and $Z=0$ in the pure oxidizer stream. Under the given assumptions, any conserved scalar $\\psi$ (i.e., a quantity with no net source or sink term in its conservation equation) is a linear function of $Z$:\n$$ \\psi(Z) = \\psi(Z=0) + [\\psi(Z=1) - \\psi(Z=0)] Z $$\n\n**1. Derivation of Species Mass Fraction Fields**\n\nThe chemical reaction is given as $\\text{CH}_4 + 2 \\text{O}_2 \\to \\text{CO}_2 + 2\\text{H}_2\\text{O}$. On a mass basis, this is $1\\,\\mathrm{kg}$ of fuel reacting with $s=4\\,\\mathrm{kg}$ of oxidizer to produce $(1+s)=5\\,\\mathrm{kg}$ of products. The species are fuel (F), oxidizer (O), and products (P).\n\nWe can construct a conserved scalar variable (a Shvab-Zeldovich variable) from the fuel and oxidizer mass fractions, $Y_F$ and $Y_O$:\n$$ \\beta = Y_O - s Y_F $$\nLet the mass source term due to reaction be $\\dot{\\omega}_F$ for the fuel and $\\dot{\\omega}_O$ for the oxidizer. From stoichiometry, the mass of oxidizer consumed is $s$ times the mass of fuel consumed, so their source terms are related by $\\dot{\\omega}_O = s \\dot{\\omega}_F$. The source term for $\\beta$ is thus $\\dot{\\omega}_O - s \\dot{\\omega}_F = s \\dot{\\omega}_F - s \\dot{\\omega}_F = 0$, making $\\beta$ a conserved scalar.\n\nWe evaluate $\\beta$ at the boundaries:\n- At the oxidizer boundary ($Z=0$): $Y_O = 1$, $Y_F = 0$. Thus, $\\beta_0 = 1 - s(0) = 1$.\n- At the fuel boundary ($Z=1$): $Y_O = 0$, $Y_F = 1$. Thus, $\\beta_1 = 0 - s(1) = -s$.\n\nSince $\\beta$ is a linear function of $Z$:\n$$ \\beta(Z) = \\beta_0 + (\\beta_1 - \\beta_0) Z = 1 + (-s-1)Z = 1 - (s+1)Z $$\nSo, we have the relation:\n$$ Y_O(Z) - s Y_F(Z) = 1 - (s+1)Z $$\nIn the Burke–Schumann model, the reaction is infinitely fast, so fuel and oxidizer cannot coexist. They react in an infinitesimally thin \"flame sheet\" located at the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$.\n- On the fuel-lean side ($Z  Z_{\\mathrm{st}}$), there is an excess of oxidizer, so all fuel is consumed: $Y_F(Z) = 0$.\n- On the fuel-rich side ($Z > Z_{\\mathrm{st}}$), there is an excess of fuel, so all oxidizer is consumed: $Y_O(Z) = 0$.\n\nAt the flame sheet ($Z=Z_{\\mathrm{st}}$), both reactants are depleted: $Y_F(Z_{\\mathrm{st}}) = 0$ and $Y_O(Z_{\\mathrm{st}}) = 0$. Using our expression for $\\beta(Z)$, this means:\n$$ 0 - s(0) = 1 - (s+1)Z_{\\mathrm{st}} \\implies Z_{\\mathrm{st}} = \\frac{1}{s+1} $$\nWith $s=4$, the stoichiometric mixture fraction is $Z_{\\mathrm{st}} = \\frac{1}{4+1} = \\frac{1}{5} = 0.2$.\n\nNow we can determine the piecewise expressions for $Y_F(Z)$ and $Y_O(Z)$:\nFor $Z \\le Z_{\\mathrm{st}}$: $Y_F(Z) = 0$. The oxidizer mass fraction is $Y_O(Z) - 0 = 1 - (s+1)Z$.\nFor $Z > Z_{\\mathrm{st}}$: $Y_O(Z) = 0$. The fuel mass fraction is $0 - s Y_F(Z) = 1 - (s+1)Z \\implies Y_F(Z) = \\frac{(s+1)Z - 1}{s}$.\n\nSo, the piecewise fields for the reactants are:\n$$ Y_F(Z) = \\begin{cases} 0  \\text{for } Z \\le Z_{\\mathrm{st}} \\\\ \\frac{(s+1)Z - 1}{s}  \\text{for } Z > Z_{\\mathrm{st}} \\end{cases} $$\n$$ Y_O(Z) = \\begin{cases} 1 - (s+1)Z  \\text{for } Z  Z_{\\mathrm{st}} \\\\ 0  \\text{for } Z \\ge Z_{\\mathrm{st}} \\end{cases} $$\nThe total mass fraction must sum to unity: $Y_F + Y_O + Y_P = 1$. Thus, the product mass fraction is $Y_P(Z) = 1 - Y_F(Z) - Y_O(Z)$.\nFor $Z \\le Z_{\\mathrm{st}}$: $Y_P(Z) = 1 - 0 - (1-(s+1)Z) = (s+1)Z$.\nFor $Z > Z_{\\mathrm{st}}$: $Y_P(Z) = 1 - \\frac{(s+1)Z - 1}{s} - 0 = \\frac{s - (s+1)Z + 1}{s} = \\frac{(s+1)(1-Z)}{s}$.\nThe resulting piecewise field for the products is:\n$$ Y_P(Z) = \\begin{cases} (s+1)Z  \\text{for } Z \\le Z_{\\mathrm{st}} \\\\ \\frac{(s+1)(1-Z)}{s}  \\text{for } Z > Z_{\\mathrm{st}} \\end{cases} $$\n\n**2. Derivation of the Temperature Field**\n\nUnder the assumptions of unity Lewis numbers and adiabatic conditions, a specific total enthalpy is conserved. We define this total enthalpy as:\n$$ h_T = c_p T + Y_F q $$\nwhere $T$ is the local mixture temperature and $q$ is the lower heating value (LHV) of the fuel per unit mass of fuel. The conservation of $h_T$ can be shown by combining the energy and fuel species conservation equations, where the source terms cancel out due to the unity Lewis number assumption.\n\nSince $h_T$ is a conserved scalar, it is a linear function of $Z$. We evaluate $h_T$ at the boundaries:\n- At the oxidizer boundary ($Z=0$): $T = T_O$, $Y_F = 0$. Thus, $h_{T,0} = c_p T_O + 0 \\cdot q = c_p T_O$.\n- At the fuel boundary ($Z=1$): $T = T_F$, $Y_F = 1$. Thus, $h_{T,1} = c_p T_F + 1 \\cdot q = c_p T_F + q$.\n\nThe linear relationship for $h_T(Z)$ is:\n$$ h_T(Z) = h_{T,0} + (h_{T,1} - h_{T,0})Z = c_p T_O + (c_p T_F + q - c_p T_O)Z $$\nWe can now find the temperature $T(Z)$ by rearranging its definition:\n$$ T(Z) = \\frac{h_T(Z) - Y_F(Z) q}{c_p} = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z - Y_F(Z)\\frac{q}{c_p} $$\nSubstituting the piecewise expression for $Y_F(Z)$:\nFor $Z \\le Z_{\\mathrm{st}}$ ($Y_F=0$):\n$$ T(Z) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z $$\nFor $Z > Z_{\\mathrm{st}}$ ($Y_F(Z) = \\frac{(s+1)Z - 1}{s}$):\n$$ T(Z) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z - \\left(\\frac{(s+1)Z - 1}{s}\\right)\\frac{q}{c_p} $$\n$$ T(Z) = T_O + \\frac{q}{sc_p} + Z\\left(T_F - T_O + \\frac{q}{c_p} - \\frac{(s+1)q}{sc_p}\\right) $$\n$$ T(Z) = T_O + \\frac{q}{sc_p} + Z\\left(T_F - T_O - \\frac{q}{sc_p}\\right) $$\nThe temperature field is piecewise linear, with its maximum at the flame sheet, $Z=Z_{\\mathrm{st}}$.\n\n**3. Evaluation of the Adiabatic Flame Temperature**\n\nThe adiabatic flame temperature, $T_{ad}$, is the temperature at the flame sheet, $T(Z_{\\mathrm{st}})$. We can use the simpler fuel-lean side expression for $T(Z)$ and substitute $Z=Z_{\\mathrm{st}} = \\frac{1}{s+1}$:\n$$ T_{ad} = T(Z_{\\mathrm{st}}) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z_{\\mathrm{st}} $$\n$$ T_{ad} = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)\\frac{1}{s+1} $$\n$$ T_{ad} = \\frac{T_O(s+1) + T_F - T_O}{s+1} + \\frac{q}{c_p(s+1)} $$\n$$ T_{ad} = \\frac{sT_O + T_F}{s+1} + \\frac{q}{c_p(s+1)} $$\nThis expression shows that the flame temperature consists of two parts: the temperature from inert mixing of the two streams evaluated at $Z_{\\mathrm{st}}$, and the temperature rise due to the release of chemical energy.\n\nNow, we substitute the given numerical values:\n$T_F = 300\\,\\mathrm{K}$\n$T_O = 1000\\,\\mathrm{K}$\n$c_p = 3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1}$\n$q = 5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$\n$s = 4$\n\nFirst, calculate the inert mixing temperature term:\n$$ \\frac{sT_O + T_F}{s+1} = \\frac{4 \\times 1000\\,\\mathrm{K} + 300\\,\\mathrm{K}}{4+1} = \\frac{4300\\,\\mathrm{K}}{5} = 860\\,\\mathrm{K} $$\nNext, calculate the temperature rise from combustion:\n$$ \\frac{q}{c_p(s+1)} = \\frac{5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}}{(3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1})(4+1)} = \\frac{5.0 \\times 10^7}{3.6 \\times 10^3 \\times 5}\\,\\mathrm{K} = \\frac{5.0 \\times 10^7}{1.8 \\times 10^4}\\,\\mathrm{K} \\approx 2777.78\\,\\mathrm{K} $$\nThe adiabatic flame temperature is the sum of these two terms:\n$$ T_{ad} = 860\\,\\mathrm{K} + 2777.77... \\,\\mathrm{K} = 3637.77... \\,\\mathrm{K} $$\nRounding to four significant figures, we get:\n$$ T_{ad} = 3638\\,\\mathrm{K} $$",
            "answer": "$$\\boxed{3638}$$"
        },
        {
            "introduction": "The idealized flame-sheet model provides a structural baseline but cannot predict extinction, as it assumes chemistry is always fast enough to keep up with mixing. This practice  introduces finite-rate Arrhenius chemistry, forcing a competition between the mixing timescale, characterized by the scalar dissipation rate $\\chi_{st}$, and the chemical timescale. By numerically solving the flamelet equations, you will generate the iconic \"S-curve,\" which plots flame temperature against $\\chi_{st}$ and explicitly reveals the ignition and extinction turning points that define a flame's stability limits.",
            "id": "4024497",
            "problem": "You are given a steady, unity-Lewis-number counterflow diffusion flamelet model for a one-step irreversible reaction in the mixture-fraction coordinate $Z \\in [0,1]$. The fuel mass fraction $Y_F(Z)$, oxidizer mass fraction $Y_O(Z)$, and temperature $T(Z)$ satisfy the ordinary differential equations derived from conservation of species and energy and the definition of scalar dissipation rate:\n$$\n-\\frac{\\chi}{2}\\frac{d^2 Y_F}{dZ^2} = \\frac{\\omega_F}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 Y_O}{dZ^2} = \\frac{\\omega_O}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 T}{dZ^2} = \\frac{\\dot{q}}{\\rho c_p},\n$$\nwhere $\\chi$ is the scalar dissipation rate assumed equal to the stoichiometric scalar dissipation rate $\\chi_{st}$ for this simplified model, $\\rho$ is the density, $c_p$ is the constant-pressure specific heat, $\\omega_F$ and $\\omega_O$ are the volumetric source terms for fuel and oxidizer (negative for consumption), and $\\dot{q}$ is the volumetric heat release rate.\n\nAssume a one-step Arrhenius model with reaction rate per unit volume\n$$\n\\omega_r(Z) = \\rho\\,k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T(Z)}\\right)\\,[Y_F(Z)]^a [Y_O(Z)]^b,\n$$\nand species source terms\n$$\n\\omega_F(Z) = -\\,\\omega_r(Z),\\qquad \\omega_O(Z) = -\\,s\\,\\omega_r(Z),\n$$\nwith stoichiometric mass consumption factor $s>0$. The volumetric heat release rate is\n$$\n\\dot{q}(Z) = q\\,\\omega_r(Z),\n$$\nwhere $q$ is the specific heat release per unit mass of fuel consumed. The boundary conditions represent the fuel and oxidizer streams:\n$$\nY_F(0) = 0,\\quad Y_O(0) = Y_{O,u},\\quad T(0) = T_u,\\qquad\nY_F(1) = Y_{F,u},\\quad Y_O(1) = 0,\\quad T(1) = T_u,\n$$\nwith $Y_{F,u} > 0$, $Y_{O,u} > 0$, and $T_u$ the upstream temperature.\n\nUsing these definitions and constants\n- $\\rho = 1.0$ $\\mathrm{kg/m^3}$,\n- $c_p = 1000$ $\\mathrm{J/(kg\\cdot K)}$,\n- $q = 5.0\\times 10^7$ $\\mathrm{J/kg}$,\n- $k_0 = 20.0$ $\\mathrm{s^{-1}}$,\n- $E_a = 1.2\\times 10^5$ $\\mathrm{J/mol}$,\n- $R = 8.314$ $\\mathrm{J/(mol\\cdot K)}$,\n- $a = 1$, $b = 1$,\n- $s = 4$,\n- $Y_{F,u} = 0.1$, $Y_{O,u} = 0.23$,\n- $T_u = 300$ $\\mathrm{K}$,\n- $D = 1.0\\times 10^{-4}$ $\\mathrm{m^2/s}$,\n\nand assuming a constant scalar dissipation rate $\\chi = \\chi_{st}$, you must:\n\n1. Formulate the boundary value problem in first-order form and solve it numerically over $Z \\in [0,1]$ for each specified $\\chi_{st}$.\n2. Compute the maximum temperature\n$$\nT_{\\max} = \\max_{Z \\in [0,1]} T(Z),\n$$\nexpressed in $\\mathrm{K}$.\n3. Compute the integrated heat release per unit area across the flame\n$$\n\\mathcal{I}(\\chi_{st}) = \\int_0^1 \\dot{q}(Z)\\,\\frac{ds}{dZ}\\,dZ = \\sqrt{\\frac{2D}{\\chi_{st}}}\\,\\int_0^1 q\\,\\omega_r(Z)\\,dZ,\n$$\nexpressed in $\\mathrm{W/m^2}$, using the relation $\\chi = 2D\\left(\\frac{dZ}{ds}\\right)^2$ under the assumption of one-dimensional variation normal to the flame.\n4. Identify the onset of steep decline near extinction with the following criteria applied to the ordered sequence of $\\chi_{st}$ values:\n   - For temperature: find the smallest index $i>0$ such that $\\displaystyle \\frac{T_{\\max}(\\chi_{st,i})}{T_{\\max}(\\chi_{st,i-1})}  0.90$. If none exists, report $-1$.\n   - For integrated heat release: find the smallest index $i>0$ such that $\\displaystyle \\frac{\\mathcal{I}(\\chi_{st,i})}{\\mathcal{I}(\\chi_{st,i-1})}  0.50$. If none exists, report $-1$.\n\nThe required units are:\n- Temperature in $\\mathrm{K}$.\n- Integrated heat release per unit area in $\\mathrm{W/m^2}$.\n\nYour program must implement the numerical solution using the above constants and produce results for the following scalar dissipation rate test suite (in $\\mathrm{s^{-1}}$):\n- Happy path: $\\chi_{st} = 5.0$,\n- Moderately diffusive: $\\chi_{st} = 15.0$,\n- Near-extinction regime: $\\chi_{st} = 30.0$,\n- Strongly diffusive: $\\chi_{st} = 60.0$,\n- Extreme diffusion, edge case: $\\chi_{st} = 100.0$.\n\nThe final program output must be a single line containing a comma-separated list enclosed in square brackets of the form\n$$\n\\big[ [T_{\\max,1}, T_{\\max,2}, T_{\\max,3}, T_{\\max,4}, T_{\\max,5}],\\ [\\mathcal{I}_1, \\mathcal{I}_2, \\mathcal{I}_3, \\mathcal{I}_4, \\mathcal{I}_5],\\ i_T,\\ i_I \\big],\n$$\nwhere $T_{\\max,k}$ and $\\mathcal{I}_k$ are the values for the $k$-th $\\chi_{st}$ in the order given above, $i_T$ is the onset index for temperature decline, and $i_I$ is the onset index for integrated heat release decline. All numerical outputs must be real numbers (floats) for $T_{\\max,k}$ and $\\mathcal{I}_k$, and integers for $i_T$ and $i_I$.",
            "solution": "The user's request is to solve a boundary value problem (BVP) representing a steady, one-dimensional counterflow diffusion flame, a canonical problem in computational combustion. The solution requires numerically solving a system of coupled, nonlinear, second-order ordinary differential equations (ODEs).\n\n### Step 1: Problem Validation\n\nThe givens are extracted and validated as per the requirements.\n\n**1.1. Extracted Givens**\n\n- **Governing Equations**:\n$$-\\frac{\\chi}{2}\\frac{d^2 Y_F}{dZ^2} = \\frac{\\omega_F}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 Y_O}{dZ^2} = \\frac{\\omega_O}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 T}{dZ^2} = \\frac{\\dot{q}}{\\rho c_p}$$\n- **Volumetric Reaction Rate**:\n$$\\omega_r(Z) = \\rho\\,k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T(Z)}\\right)\\,[Y_F(Z)]^a\\,[Y_O(Z)]^b$$\n- **Species and Heat Source Terms**:\n$$\\omega_F(Z) = -\\,\\omega_r(Z),\\qquad \\omega_O(Z) = -\\,s\\,\\omega_r(Z),\\qquad \\dot{q}(Z) = q\\,\\omega_r(Z)$$\n- **Boundary Conditions on $Z \\in [0,1]$**:\n$$Y_F(0) = 0,\\quad Y_O(0) = Y_{O,u},\\quad T(0) = T_u$$\n$$Y_F(1) = Y_{F,u},\\quad Y_O(1) = 0,\\quad T(1) = T_u$$\n- **Physical and Chemical Constants**:\n  - $\\rho = 1.0$ $\\mathrm{kg/m^3}$\n  - $c_p = 1000$ $\\mathrm{J/(kg\\cdot K)}$\n  - $q = 5.0\\times 10^7$ $\\mathrm{J/kg}$\n  - $k_0 = 20.0$ $\\mathrm{s^{-1}}$\n  - $E_a = 1.2\\times 10^5$ $\\mathrm{J/mol}$\n  - $R = 8.314$ $\\mathrm{J/(mol\\cdot K)}$\n  - $a = 1$, $b = 1$\n  - $s = 4$\n  - $Y_{F,u} = 0.1$\n  - $Y_{O,u} = 0.23$\n  - $T_u = 300$ $\\mathrm{K}$\n  - $D = 1.0\\times 10^{-4}$ $\\mathrm{m^2/s}$\n- **Assumption**: The scalar dissipation rate $\\chi$ is constant and equal to $\\chi_{st}$.\n- **Computational Tasks**:\n  1. For each $\\chi_{st}$ in the test suite $\\{5.0, 15.0, 30.0, 60.0, 100.0\\}$ $\\mathrm{s^{-1}}$, solve the BVP.\n  2. Compute the maximum temperature $T_{\\max} = \\max_{Z \\in [0,1]} T(Z)$.\n  3. Compute the integrated heat release per unit area $\\mathcal{I}(\\chi_{st}) = \\sqrt{\\frac{2D}{\\chi_{st}}}\\,\\int_0^1 q\\,\\omega_r(Z)\\,dZ$.\n  4. Find the smallest index $i>0$ where $\\frac{T_{\\max}(\\chi_{st,i})}{T_{\\max}(\\chi_{st,i-1})}  0.90$ (denoted $i_T$), or $-1$ if none exists.\n  5. Find the smallest index $i>0$ where $\\frac{\\mathcal{I}(\\chi_{st,i})}{\\mathcal{I}(\\chi_{st,i-1})}  0.50$ (denoted $i_I$), or $-1$ if none exists.\n\n**1.2. Validation Verdict**\n\n- **Scientifically Grounded**: The problem is a standard formulation of the flamelet equations, a fundamental model in combustion science. All equations and concepts are based on established principles of chemical kinetics and transport phenomena. (Status: **Valid**)\n- **Well-Posed**: The problem is a well-defined nonlinear boundary value problem. All necessary parameters, boundary conditions, and constraints are provided to specify a numerical solution procedure. (Status: **Valid**)\n- **Objective**: All definitions and requirements are stated in precise, quantitative, and unambiguous mathematical terms. (Status: **Valid**)\n- **Completeness and Consistency**: The problem is fully specified and self-contained. There are no contradictions between the provided information. (Status: **Valid**)\n\nThe problem is valid and can be solved as stated.\n\n### Step 2: Solution Formulation\n\nThe problem is a BVP for a system of second-order ODEs. To solve it using standard numerical solvers like `scipy.integrate.solve_bvp`, we must first convert the system into first-order form.\n\n**2.1. First-Order System**\n\nLet the state vector be $y(Z) = [y_0, y_1, y_2, y_3, y_4, y_5]^T$, where:\n- $y_0(Z) = Y_F(Z)$\n- $y_1(Z) = \\frac{dY_F}{dZ}$\n- $y_2(Z) = Y_O(Z)$\n- $y_3(Z) = \\frac{dY_O}{dZ}$\n- $y_4(Z) = T(Z)$\n- $y_5(Z) = \\frac{dT}{dZ}$\n\nThe system of first-order ODEs is $\\frac{dy}{dZ} = f(Z, y)$:\n- $\\frac{dy_0}{dZ} = y_1$\n- $\\frac{dy_1}{dZ} = \\frac{d^2Y_F}{dZ^2} = -\\frac{2}{\\chi_{st}}\\frac{\\omega_F}{\\rho} = \\frac{2}{\\chi_{st}}\\frac{\\omega_r}{\\rho}$\n- $\\frac{dy_2}{dZ} = y_3$\n- $\\frac{dy_3}{dZ} = \\frac{d^2Y_O}{dZ^2} = -\\frac{2}{\\chi_{st}}\\frac{\\omega_O}{\\rho} = \\frac{2s}{\\chi_{st}}\\frac{\\omega_r}{\\rho}$\n- $\\frac{dy_4}{dZ} = y_5$\n- $\\frac{dy_5}{dZ} = \\frac{d^2T}{dZ^2} = -\\frac{2}{\\chi_{st}}\\frac{\\dot{q}}{\\rho c_p} = -\\frac{2q}{\\chi_{st} c_p}\\frac{\\omega_r}{\\rho}$\n\nSubstituting the expressions for $\\omega_r$, and with $\\rho=1$, $a=1$, $b=1$:\n$$\\omega_r = k_0 \\exp\\left(-\\frac{E_a}{R y_4}\\right) y_0 y_2$$\nNote that during numerical iteration, $y_0$ and $y_2$ may become negative, which is unphysical. They are clamped to $0$ in the reaction rate calculation.\n\n**2.2. Boundary Conditions**\n\nThe six boundary conditions in terms of the state vector $y$ are:\n- At $Z=0$: $y_0(0) = 0$, $y_2(0) = Y_{O,u}$, $y_4(0) = T_u$\n- At $Z=1$: $y_0(1) = Y_{F,u}$, $y_2(1) = 0$, $y_4(1) = T_u$\n\n**2.3. Numerical Strategy**\n\n1.  **BVP Solver**: The `scipy.integrate.solve_bvp` function is used.\n2.  **Initial Guess**: A good initial guess is essential for convergence of the nonlinear solver. We construct a guess based on linear profiles for mass fractions and a parabolic profile for temperature, which assumes a single reaction zone.\n    - $Y_F(Z) \\approx Y_{F,u} Z$\n    - $Y_O(Z) \\approx Y_{O,u} (1-Z)$\n    - $T(Z) \\approx T_u + (T_{peak,guess} - T_u) (4Z(1-Z))$\n3.  **Continuation Method**: The problem is solved for a sequence of increasing $\\chi_{st}$. For each value of $\\chi_{st}$ after the first one, the converged solution from the previous, smaller $\\chi_{st}$ is used as the initial guess. This enhances robustness and convergence speed, especially as the flame approaches extinction at high $\\chi_{st}$.\n4.  **Extinction Handling**: If `solve_bvp` fails to converge, it is interpreted as extinction of the flame. In this case, the only stable solution is the non-reacting (trivial) one, where $T(Z) = T_u$ everywhere, and consequently, $\\omega_r = 0$. For such cases, $T_{\\max}$ is set to $T_u$ and $\\mathcal{I}$ is set to $0$.\n5.  **Post-Processing**: After obtaining a successful solution `sol`, the profiles are evaluated on a fine grid.\n    - $T_{\\max}$ is found by taking the maximum of the temperature profile `sol.y[4,:]`.\n    - $\\mathcal{I}$ is calculated by first computing the integrand $q\\,\\omega_r(Z)$ on the fine grid using the solved profiles for $Y_F$, $Y_O$, and $T$, then numerically integrating using `numpy.trapz`, and finally multiplying by the pre-factor $\\sqrt{2D/\\chi_{st}}$.\n6.  **Index Identification**: The final lists of $T_{\\max}$ and $\\mathcal{I}$ values are processed to find the indices $i_T$ and $i_I$ according to the specified drop-off criteria.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Solves the counterflow diffusion flamelet equations for a series of scalar dissipation rates,\n    calculates maximum temperature and integrated heat release, and identifies extinction indices.\n    \"\"\"\n    # Define physical and chemical constants from the problem statement\n    rho = 1.0       # kg/m^3\n    cp = 1000.0     # J/(kg*K)\n    q = 5.0e7       # J/kg\n    k0 = 20.0       # s^-1\n    Ea = 1.2e5      # J/mol\n    R = 8.314       # J/(mol*K)\n    a = 1.0         # Reaction order for fuel\n    b = 1.0         # Reaction order for oxidizer\n    s = 4.0         # Stoichiometric mass ratio\n    Y_F_u = 0.1     # Fuel mass fraction in fuel stream\n    Y_O_u = 0.23    # Oxidizer mass fraction in oxidizer stream\n    T_u = 300.0     # K\n    D = 1.0e-4      # m^2/s\n\n    # Define the test cases for the stoichiometric scalar dissipation rate\n    chi_st_values = [5.0, 15.0, 30.0, 60.0, 100.0]\n\n    def ode_fun(Z, y, chi_st):\n        \"\"\"\n        Defines the system of first-order ODEs for the flamelet model.\n        State vector y = [Y_F, Y_F', Y_O, Y_O', T, T']\n        \"\"\"\n        # Clamp concentrations and temperature to be physical\n        YF = np.maximum(y[0], 0.0)\n        YO = np.maximum(y[2], 0.0)\n        T = np.maximum(y[4], T_u)\n\n        # Volumetric reaction rate (rho=1)\n        reaction_rate = k0 * np.exp(-Ea / (R * T)) * (YF**a) * (YO**b)\n\n        # Second derivatives\n        d2YF_dZ2 = (2.0 / chi_st) * reaction_rate\n        d2YO_dZ2 = (2.0 * s / chi_st) * reaction_rate\n        d2T_dZ2 = -(2.0 * q / (cp * chi_st)) * reaction_rate\n\n        # Return derivatives of the state vector\n        return np.vstack((y[1], d2YF_dZ2, y[3], d2YO_dZ2, y[5], d2T_dZ2))\n\n    def bc_fun(ya, yb):\n        \"\"\"\n        Defines the boundary conditions at Z=0 (ya) and Z=1 (yb).\n        \"\"\"\n        return np.array([\n            ya[0] - 0.0,      # YF(0) = 0\n            ya[2] - Y_O_u,    # YO(0) = Y_O_u\n            ya[4] - T_u,      # T(0) = T_u\n            yb[0] - Y_F_u,    # YF(1) = Y_F_u\n            yb[2] - 0.0,      # YO(1) = 0\n            yb[4] - T_u,      # T(1) = T_u\n        ])\n\n    T_max_results = []\n    I_results = []\n    \n    sol_prev = None\n    Z_mesh = np.linspace(0, 1, 201)\n\n    for chi_st in chi_st_values:\n        if sol_prev is None:\n            # For the first run, create an analytical guess\n            y_guess = np.zeros((6, Z_mesh.size))\n            T_peak_guess = 2500.0\n            \n            y_guess[0, :] = Y_F_u * Z_mesh                 # YF profile\n            y_guess[1, :] = Y_F_u                          # YF' profile\n            y_guess[2, :] = Y_O_u * (1 - Z_mesh)           # YO profile\n            y_guess[3, :] = -Y_O_u                         # YO' profile\n            y_guess[4, :] = T_u + (T_peak_guess - T_u) * 4 * Z_mesh * (1 - Z_mesh) # T profile\n            y_guess[5, :] = (T_peak_guess - T_u) * 4 * (1 - 2 * Z_mesh)           # T' profile\n        else:\n            # Use the previous successful solution as guess (continuation)\n            y_guess = sol_prev.sol(Z_mesh)\n\n        # Solve the BVP\n        sol = solve_bvp(lambda Z, y: ode_fun(Z, y, chi_st),\n                        bc_fun,\n                        Z_mesh,\n                        y_guess,\n                        tol=1e-5,\n                        max_nodes=5000)\n\n        if not sol.success:\n            # If solver fails, assume extinction: trivial non-reacting solution\n            current_T_max = T_u\n            current_I = 0.0\n            sol_prev = None # Reset continuation\n        else:\n            # Store solution for next step in continuation\n            sol_prev = sol\n            \n            # Evaluate solution on a fine grid for accurate post-processing\n            Z_fine = np.linspace(0, 1, 1001)\n            y_fine = sol.sol(Z_fine)\n\n            # Task 2: Compute maximum temperature\n            T_profile = y_fine[4, :]\n            current_T_max = np.max(T_profile)\n\n            # Task 3: Compute integrated heat release\n            YF_fine = np.maximum(y_fine[0, :], 0.0)\n            YO_fine = np.maximum(y_fine[2, :], 0.0)\n            T_fine = y_fine[4, :]\n\n            omega_r_profile = rho * k0 * np.exp(-Ea / (R * T_fine)) * (YF_fine**a) * (YO_fine**b)\n            integral_q_omega_r = np.trapz(q * omega_r_profile, x=Z_fine)\n            \n            pre_factor = np.sqrt(2 * D / chi_st)\n            current_I = pre_factor * integral_q_omega_r\n\n        T_max_results.append(current_T_max)\n        I_results.append(current_I)\n\n    # Task 4: Identify onset indices for extinction\n    i_T = -1\n    for i in range(1, len(T_max_results)):\n        if T_max_results[i-1]  T_u and (T_max_results[i] / T_max_results[i-1])  0.90:\n            i_T = i\n            break\n            \n    i_I = -1\n    for i in range(1, len(I_results)):\n        if I_results[i-1]  1e-9 and (I_results[i] / I_results[i-1])  0.50:\n            i_I = i\n            break\n\n    # Format final output string\n    t_max_str = ','.join(map(str, T_max_results))\n    i_val_str = ','.join(map(str, I_results))\n    \n    print(f\"[[{t_max_str}],[{i_val_str}],{i_T},{i_I}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The S-curve you simulated reveals three possible solutions for a given range of scalar dissipation rates, yet only two are physically observed: a stable burning state and a stable extinguished state. This exercise  delves into the mathematical reason for this by using a simplified dynamical model that captures the flame's bifurcation behavior near the turning points. By performing a linear stability analysis on this model, you will determine the stability of each branch of the S-curve, proving that the intermediate solution is inherently unstable and thus not a physically realizable steady state.",
            "id": "4024486",
            "problem": "Consider a counterflow diffusion flame near the stoichiometric surface, modeled in mixture-fraction space. Begin from the conservation of energy with one-step Arrhenius heat release and diffusive transport, using the standard flamelet assumption that the spatial structure is slaved to the mixture fraction and that the stoichiometric scalar dissipation rate is a control parameter. Near the ignition and extinction criticalities, the system admits a one-dimensional center manifold reduction for the order-parameter amplitude of the thermal-progress perturbation relative to the non-reactive mixing state. In the vicinity of the cusp-type bifurcation that organizes ignition/extinction, this amplitude obeys a cubic normal form with a linear control by the stoichiometric scalar dissipation rate. In fully nondimensional variables, let the amplitude be denoted by $\\,\\theta\\,$ and the control parameter be the nondimensional stoichiometric scalar dissipation rate $\\,\\chi_{st}\\,$. The reduced-order dynamics are given by\n$$\n\\frac{d\\theta}{dt} \\;=\\; A\\,\\theta \\;-\\; B\\,\\theta^{3} \\;+\\; C \\;-\\; \\chi_{st},\n$$\nwith fixed positive parameters $\\,A=2.0\\,$, $\\,B=1.0\\,$, and $\\,C=1.2\\,$. All quantities are dimensionless.\n\nA steady state $\\,\\theta^\\star\\,$ satisfies\n$$\n-B\\,(\\theta^\\star)^{3} \\;+\\; A\\,\\theta^\\star \\;+\\; (C-\\chi_{st}) \\;=\\; 0.\n$$\nThe linear growth rate of small perturbations about a steady state is given by the eigenvalue of the linearization of the right-hand side at $\\,\\theta^\\star\\,$:\n$$\n\\lambda(\\theta^\\star;\\chi_{st}) \\;=\\; \\left.\\frac{d}{d\\theta}\\Big(A\\,\\theta - B\\,\\theta^3 + C - \\chi_{st}\\Big)\\right|_{\\theta=\\theta^\\star} \\;=\\; A \\;-\\; 3B\\,(\\theta^\\star)^2.\n$$\nA steady state is linearly stable if and only if $\\,\\lambda(\\theta^\\star;\\chi_{st})0\\,$, and unstable if and only if $\\,\\lambda(\\theta^\\star;\\chi_{st})0\\,$. At turning points of the S-curve, $\\,\\lambda(\\theta^\\star;\\chi_{st})=0\\,$.\n\nTask. Write a program that:\n- For each prescribed value of $\\,\\chi_{st}\\,$, computes all real steady states $\\,\\theta^\\star\\,$ of the cubic equation above.\n- For each such $\\,\\theta^\\star\\,$, computes the corresponding linear growth rate $\\,\\lambda(\\theta^\\star;\\chi_{st})\\,$.\n- Sorts the steady states in ascending order of $\\,\\theta^\\star\\,$ and outputs the corresponding list of $\\,\\lambda\\,$ values in that order. The sign of each $\\,\\lambda\\,$ identifies the stability of the associated S-curve branch.\n\nUse the following test suite of $\\,\\chi_{st}\\,$ values to probe different regions of the S-curve:\n- A lower-fold boundary case, a value within the three-solution regime, a mid-range value within the three-solution regime, an upper-range value within the three-solution regime, an upper-fold boundary case, and a value beyond the upper fold such that only one steady state remains.\n\nConcretely, use:\n$$\n\\chi_{st} \\in \\{\\,0.111338,\\; 0.2,\\; 1.0,\\; 2.0,\\; 2.288992,\\; 3.0\\,\\}.\n$$\n\nNumerical requirements:\n- Treat a root $\\,\\theta\\,$ as real if its imaginary part has magnitude strictly less than $\\,10^{-10}\\,$.\n- Remove duplicate steady states that differ by less than $\\,10^{-7}\\,$ in value, retaining a single representative.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists of floating-point numbers, each inner list being the ordered growth rates $\\,\\lambda\\,$ for one test value of $\\,\\chi_{st}\\,$. For example: \"[[lambda_set_for_case_1],[lambda_set_for_case_2],...]\" with no extra spaces or text.\n- All outputs are dimensionless numbers. No physical units are required or permitted in the output.",
            "solution": "The problem statement is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equation:** The dynamics of the nondimensional amplitude $\\,\\theta\\,$ are given by the ordinary differential equation:\n$$\n\\frac{d\\theta}{dt} \\;=\\; A\\,\\theta \\;-\\; B\\,\\theta^{3} \\;+\\; C \\;-\\; \\chi_{st}\n$$\n- **Parameters:** The fixed positive constants are $\\,A=2.0\\,$, $\\,B=1.0\\,$, and $\\,C=1.2\\,$.\n- **Control Variable:** The nondimensional stoichiometric scalar dissipation rate is $\\,\\chi_{st}\\,$.\n- **Steady State Condition:** A steady state $\\,\\theta^\\star\\,$ must satisfy the algebraic equation:\n$$\n-B\\,(\\theta^\\star)^{3} \\;+\\; A\\,\\theta^\\star \\;+\\; (C-\\chi_{st}) \\;=\\; 0\n$$\n- **Stability Condition:** The linear stability of a steady state $\\,\\theta^\\star\\,$ is determined by the sign of the eigenvalue $\\,\\lambda(\\theta^\\star;\\chi_{st})\\,$.\n- **Eigenvalue Formula:**\n$$\n\\lambda(\\theta^\\star;\\chi_{st}) \\;=\\; A \\;-\\; 3B\\,(\\theta^\\star)^2\n$$\n- **Stability Criteria:** A steady state is stable for $\\,\\lambda0\\,$ and unstable for $\\,\\lambda0\\,$. The condition $\\,\\lambda=0\\,$ corresponds to a turning point (bifurcation).\n- **Task:** For each value in a given set of $\\,\\chi_{st}\\,$, find all real steady states $\\,\\theta^\\star\\,$, compute their corresponding eigenvalues $\\,\\lambda\\,$, and output the list of $\\,\\lambda\\,$ values, ordered according to their corresponding $\\,\\theta^\\star\\,$ values sorted in ascending order.\n- **Test Suite:** The prescribed values for the control parameter are $\\,\\chi_{st} \\in \\{\\,0.111338,\\; 0.2,\\; 1.0,\\; 2.0,\\; 2.288992,\\; 3.0\\,\\}$.\n- **Numerical Tolerances:**\n  - A root is considered real if $\\,\\left|\\text{Im}(\\theta)\\right|  10^{-10}\\,$.\n  - Roots differing by less than $\\,10^{-7}\\,$ are considered duplicates.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is scientifically grounded, deriving from established principles in combustion theory (flamelet models) and dynamical systems (bifurcation theory, specifically the cusp catastrophe normal form). The physical scenario—ignition and extinction in a counterflow diffusion flame represented by the S-shaped response curve—is a canonical problem in the field. The provided equations and parameters are consistent and sufficient to perform the requested calculations. The problem is well-posed, as a cubic equation with real coefficients has a defined set of roots, and the subsequent steps are deterministic. The language is objective and precise. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### Solution\n\nThe task is to find the steady states of a dynamical system and analyze their linear stability for a given set of control parameters. The steady states $\\,\\theta^\\star\\,$ are the real roots of a cubic polynomial, and their stability is determined by the sign of an eigenvalue $\\,\\lambda\\,$.\n\n**1. Steady-State Equation**\n\nThe steady states are the roots of the equation:\n$$\n-B\\,(\\theta^\\star)^{3} \\;+\\; A\\,\\theta^\\star \\;+\\; (C-\\chi_{st}) \\;=\\; 0\n$$\nSubstituting the given parameter values $\\,A=2.0\\,$, $\\,B=1.0\\,$, and $\\,C=1.2\\,$, and rearranging into a standard polynomial form, we get:\n$$\n(\\theta^\\star)^3 - 2\\theta^\\star + (\\chi_{st} - 1.2) = 0\n$$\nThis is a depressed cubic equation of the form $\\,x^3 + px + q = 0\\,$, where the coefficients depend on the control parameter $\\,\\chi_{st}\\,$. For each value of $\\,\\chi_{st}\\,$ from the test suite, we will find the roots of this polynomial.\n\n**2. Numerical Root Finding**\n\nWe will employ a numerical polynomial root-finding algorithm, such as the one available in the `numpy` library, to compute the three (potentially complex) roots of the cubic equation for each $\\,\\chi_{st}\\,$. The coefficients of the polynomial $\\,p(x) = c_3 x^3 + c_2 x^2 + c_1 x + c_0\\,$ are $\\,c_3=1\\,$, $\\,c_2=0\\,$, $\\,c_1=-2\\,$, and $\\,c_0 = \\chi_{st} - 1.2\\,$.\n\n**3. Filtering and Sorting Roots**\n\nThe roots returned by the numerical solver may be complex. According to the problem specification, we are only interested in real steady states. A root $\\,\\theta\\,$ is considered real if the magnitude of its imaginary part is less than $\\,10^{-10}\\,$. We will filter the roots based on this criterion and retain only their real parts.\n\nThe problem also specifies that roots that are very close to each other should be treated as a single root. This is particularly relevant at the turning points of the S-curve, where two roots coalesce into a double root. After identifying the real roots, we will sort them in ascending order. Then, we will iterate through the sorted list and remove any duplicates, defined as roots that differ by less than $\\,10^{-7}\\,$. This process yields an ordered list of unique real steady states $\\,\\theta^\\star\\,$.\n\n**4. Stability Analysis**\n\nFor each unique real steady state $\\,\\theta^\\star\\,$, we calculate the corresponding linear growth rate (eigenvalue) $\\,\\lambda\\,$ using the provided formula:\n$$\n\\lambda(\\theta^\\star) = A - 3B(\\theta^\\star)^2\n$$\nSubstituting $\\,A=2.0\\,$ and $\\,B=1.0\\,$:\n$$\n\\lambda(\\theta^\\star) = 2 - 3(\\theta^\\star)^2\n$$\nThe sign of $\\,\\lambda\\,$ determines the stability:\n- $\\,\\lambda  0\\,$: The steady state is stable (e.g., a steadily burning or extinguished state).\n- $\\,\\lambda  0\\,$: The steady state is unstable (e.g., an intermediate state that is not physically realizable).\n- $\\,\\lambda = 0\\,$: The steady state is marginally stable, marking a bifurcation point (ignition or extinction).\n\nSince the list of $\\,\\theta^\\star\\,$ values has already been sorted, the resulting list of calculated $\\,\\lambda\\,$ values will be in the required order.\n\n**5. Algorithm Implementation**\n\nThe overall algorithm is as follows:\n- Initialize an empty list to store the final results.\n- For each $\\,\\chi_{st}\\,$ value in the test suite:\n  - Define the coefficients of the cubic polynomial.\n  - Compute the roots of the polynomial.\n  - Filter the roots to retain only the real ones, based on the imaginary part tolerance.\n  - Sort the real roots in ascending order.\n  - Filter the sorted list to remove duplicates based on the value difference tolerance.\n  - For each unique, sorted root $\\,\\theta^\\star\\,$, calculate the corresponding eigenvalue $\\,\\lambda\\,$.\n  - Append the resulting list of eigenvalues to the final results list.\n- Format the final list of lists into the specified string format for output.\nThis procedure systematically maps each control parameter value to the stability properties of all corresponding physical states of the system.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and analyzes the steady states of a flamelet model near criticality.\n\n    The function iterates through a set of nondimensional scalar dissipation rates (chi_st)\n    and for each, solves for the steady-state thermal amplitudes (theta). It then\n    calculates the linear stability eigenvalue (lambda) for each steady state.\n    \"\"\"\n\n    # Define the model parameters from the problem statement.\n    A = 2.0\n    B = 1.0\n    C = 1.2\n\n    # Define the test suite of chi_st values.\n    # These values probe the S-curve response of the system, including\n    # the lower fold, the bistable region, the upper fold, and the\n    # single-solution (extinguished) region.\n    test_cases_chi_st = [0.111338, 0.2, 1.0, 2.0, 2.288992, 3.0]\n\n    # Define numerical tolerances as per the problem requirements.\n    IMAG_TOLERANCE = 1e-10  # Tolerance for treating a root as real.\n    DUPLICATE_TOLERANCE = 1e-7  # Tolerance for identifying duplicate roots.\n\n    all_lambda_results = []\n\n    for chi_st in test_cases_chi_st:\n        # The steady-state equation is B*theta^3 - A*theta - (C - chi_st) = 0.\n        # Rearranging into standard form x^3 + px + q = 0 gives:\n        # theta^3 - (A/B)*theta + (chi_st - C)/B = 0.\n        # With A=2.0, B=1.0, C=1.2, the coefficients for numpy.roots are:\n        # [1, 0, -A/B, (chi_st - C)/B]\n        poly_coeffs = [B, 0, -A, C - chi_st]\n        \n        # In this specific problem B=1, so we can write it as:\n        # [1, 0, -A, C - chi_st]\n        # or, to match the form x^3+px+q=0 used in the solution text:\n        # theta^3 - 2*theta + (chi_st - 1.2) = 0\n        # coeffs are [1, 0, -2, chi_st - 1.2]\n        \n        # Find all roots of the cubic polynomial.\n        roots = np.roots([1, 0, -A, chi_st - C])\n\n        # Filter for real roots based on the magnitude of the imaginary part.\n        real_thetas = [r.real for r in roots if abs(r.imag)  IMAG_TOLERANCE]\n\n        # Sort the real roots in ascending order.\n        real_thetas.sort()\n\n        # Remove duplicate roots based on the specified tolerance.\n        unique_thetas = []\n        if real_thetas:\n            unique_thetas.append(real_thetas[0])\n            for i in range(1, len(real_thetas)):\n                if abs(real_thetas[i] - unique_thetas[-1])  DUPLICATE_TOLERANCE:\n                    unique_thetas.append(real_thetas[i])\n        \n        # For each unique steady state theta, calculate the linear growth rate lambda.\n        # The list of thetas is already sorted, so the resulting lambdas will be\n        # in the required order.\n        # lambda = A - 3*B*theta^2\n        lambdas = [A - 3 * B * (theta**2) for theta in unique_thetas]\n\n        all_lambda_results.append(lambdas)\n\n    # Format the final output as a comma-separated list of lists, with no spaces.\n    outer_list_str = []\n    for lambda_list in all_lambda_results:\n        # Format each inner list of floats.\n        inner_list_str = f\"[{','.join(f'{l:.16g}' for l in lambda_list)}]\"\n        outer_list_str.append(inner_list_str)\n    \n    final_output_string = f\"[{','.join(outer_list_str)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}