{
    "hands_on_practices": [
        {
            "introduction": "为了理解复杂的火焰现象，我们通常从一个理想化的模型开始。本练习将介绍Burke-Schumann极限，即化学反应速率无限快的情景。通过解析推导，学生将练习掌握混合分数（$Z$）、化学计量表面（$Z_{\\mathrm{st}}$）和绝热火焰温度（$T_{ad}$）等核心概念，为理解理想扩散火焰中的温度和组分分布奠定坚实的基础。这个练习是后续更复杂模型分析的起点 。",
            "id": "4024507",
            "problem": "考虑在 Burke–Schumann (BS) 极限（无限快化学反应）、单位刘易斯数以及绝热无辐射条件下，纯甲烷燃料流和纯氧气氧化剂流之间的稳态层流逆流扩散火焰。设反应为 CH$_4$ $+$ $2$ O$_2$ $\\to$ CO$_2$ $+$ $2$H$_2$O，并将化学计量氧化剂与燃料的质量比定义为 $s$，因此对于这些纯净流，$s = 4$。混合分数 $Z$ 被定义为代表源自燃料流的物质质量分数的守恒标量，因此在燃料边界处 $Z = 1$，在氧化剂边界处 $Z = 0$。假设所有组分和温度下的混合物比热 $c_p$ 恒定且相等，并将 $c_p$、单位质量燃料的甲烷低热值 (LHV) $q$ 以及股流温度 $T_F$ 和 $T_O$ 视为已知。\n\n从 BS 模型下的质量、组分和焓守恒出发，并使用化学计量混合分数 $Z_{\\mathrm{st}}$ 的定义，完成以下任务：\n\n1.  推导燃料受限侧 ($Z  Z_{\\mathrm{st}}$) 和氧化剂受限侧 ($Z > Z_{\\mathrm{st}}$) 的分段组分质量分数场 $Y_F(Z)$、$Y_O(Z)$ 和 $Y_P(Z)$，其中惰性“产物”将反应后混合物（CO$_2$ 和 H$_2$O）集总为单一聚集体。\n2.  在火焰面两侧强制总焓（显焓加化学焓）守恒，以构建分段温度场 $T(Z)$，用 $T_F$、$T_O$、$q$、$c_p$、$s$ 和 $Z$ 表示。\n3.  计算在 $Z = Z_{\\mathrm{st}}$ 处的绝热火焰温度。\n\n使用以下给定的数值参数：$T_F = 300\\,\\mathrm{K}$，$T_O = 1000\\,\\mathrm{K}$，$c_p = 3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1}$，$q = 5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$，$s = 4$。以开尔文表示最终的绝热火焰温度，并将您的最终数值答案四舍五入到四位有效数字。",
            "solution": "该问题描述了一个在 Burke–Schumann (BS) 或无限速率化学反应近似下的稳态一维逆流扩散火焰。关键假设包括所有组分的刘易斯数均为单位1，比热 $c_p$ 恒定且相等，以及绝热无辐射条件。我们被要求推导组分和温度场作为混合分数 $Z$ 的函数，然后计算绝热火焰温度。\n\n混合分数 $Z$ 是一个守恒标量，用于追踪源自燃料流的质量。它被定义为在纯燃料流中 $Z=1$，在纯氧化剂流中 $Z=0$。在给定的假设下，任何守恒标量 $\\psi$（即在其守恒方程中没有净源项或汇项的量）都是 $Z$ 的线性函数：\n$$ \\psi(Z) = \\psi(Z=0) + [\\psi(Z=1) - \\psi(Z=0)] Z $$\n\n**1. 组分质量分数场的推导**\n\n化学反应式为 $\\text{CH}_4 + 2 \\text{O}_2 \\to \\text{CO}_2 + 2\\text{H}_2\\text{O}$。以质量为基础，这是 $1\\,\\mathrm{kg}$ 的燃料与 $s=4\\,\\mathrm{kg}$ 的氧化剂反应，生成 $(1+s)=5\\,\\mathrm{kg}$ 的产物。组分为燃料 (F)、氧化剂 (O) 和产物 (P)。\n\n我们可以从燃料和氧化剂的质量分数 $Y_F$ 和 $Y_O$ 构建一个守恒标量（一个 Shvab-Zeldovich 变量）：\n$$ \\beta = Y_O - s Y_F $$\n$Y_F$ 的源项是 $\\dot{\\omega}_F$，$Y_O$ 的源项是 $s \\dot{\\omega}_F$，其中 $\\dot{\\omega}_F$ 是单位体积燃料的质量消耗率。$\\beta$ 的源项是 $s \\dot{\\omega}_F - s(\\dot{\\omega}_F) = 0$，所以 $\\beta$ 是一个守恒标量。\n\n我们在边界处计算 $\\beta$：\n- 在氧化剂边界 ($Z=0$)：$Y_O = 1$，$Y_F = 0$。因此，$\\beta_0 = 1 - s(0) = 1$。\n- 在燃料边界 ($Z=1$)：$Y_O = 0$，$Y_F = 1$。因此，$\\beta_1 = 0 - s(1) = -s$。\n\n由于 $\\beta$ 是 $Z$ 的线性函数：\n$$ \\beta(Z) = \\beta_0 + (\\beta_1 - \\beta_0) Z = 1 + (-s-1)Z = 1 - (s+1)Z $$\n因此，我们有关系式：\n$$ Y_O(Z) - s Y_F(Z) = 1 - (s+1)Z $$\n在 Burke–Schumann 模型中，反应速率无限快，因此燃料和氧化剂不能共存。它们在位于化学计量混合分数 $Z_{\\mathrm{st}}$ 处的无限薄的“火焰面”中反应。\n- 在贫燃料侧 ($Z  Z_{\\mathrm{st}}$)，氧化剂过量，因此所有燃料都被消耗：$Y_F(Z) = 0$。\n- 在富燃料侧 ($Z > Z_{\\mathrm{st}}$)，燃料过量，因此所有氧化剂都被消耗：$Y_O(Z) = 0$。\n\n在火焰面 ($Z=Z_{\\mathrm{st}}$) 处，两种反应物都耗尽：$Y_F(Z_{\\mathrm{st}}) = 0$ 和 $Y_O(Z_{\\mathrm{st}}) = 0$。使用我们关于 $\\beta(Z)$ 的表达式，这意味着：\n$$ 0 - s(0) = 1 - (s+1)Z_{\\mathrm{st}} \\implies Z_{\\mathrm{st}} = \\frac{1}{s+1} $$\n当 $s=4$ 时，化学计量混合分数为 $Z_{\\mathrm{st}} = \\frac{1}{4+1} = \\frac{1}{5} = 0.2$。\n\n现在我们可以确定 $Y_F(Z)$ 和 $Y_O(Z)$ 的分段表达式：\n对于 $Z \\le Z_{\\mathrm{st}}$：$Y_F(Z) = 0$。氧化剂质量分数为 $Y_O(Z) - 0 = 1 - (s+1)Z$。\n对于 $Z > Z_{\\mathrm{st}}$：$Y_O(Z) = 0$。燃料质量分数为 $0 - s Y_F(Z) = 1 - (s+1)Z \\implies Y_F(Z) = \\frac{(s+1)Z - 1}{s}$。\n\n所以，反应物的分段场为：\n$$ Y_F(Z) = \\begin{cases} 0  \\text{当 } Z \\le Z_{\\mathrm{st}} \\\\ \\frac{(s+1)Z - 1}{s}  \\text{当 } Z > Z_{\\mathrm{st}} \\end{cases} $$\n$$ Y_O(Z) = \\begin{cases} 1 - (s+1)Z  \\text{当 } Z \\le Z_{\\mathrm{st}} \\\\ 0  \\text{当 } Z \\ge Z_{\\mathrm{st}} \\end{cases} $$\n总质量分数之和必须为1：$Y_F + Y_O + Y_P = 1$。因此，产物质量分数为 $Y_P(Z) = 1 - Y_F(Z) - Y_O(Z)$。\n对于 $Z \\le Z_{\\mathrm{st}}$：$Y_P(Z) = 1 - 0 - (1-(s+1)Z) = (s+1)Z$。\n对于 $Z > Z_{\\mathrm{st}}$：$Y_P(Z) = 1 - \\frac{(s+1)Z - 1}{s} - 0 = \\frac{s - (s+1)Z + 1}{s} = \\frac{(s+1)(1-Z)}{s}$。\n得到的产物分段场为：\n$$ Y_P(Z) = \\begin{cases} (s+1)Z  \\text{当 } Z \\le Z_{\\mathrm{st}} \\\\ \\frac{(s+1)(1-Z)}{s}  \\text{当 } Z > Z_{\\mathrm{st}} \\end{cases} $$\n\n**2. 温度场的推导**\n\n在单位刘易斯数和绝热条件的假设下，比总焓是守恒的。我们将此总焓定义为：\n$$ h_T = c_p T + Y_F q $$\n其中 $T$ 是局部混合物温度，$q$ 是单位质量燃料的低热值 (LHV)。通过结合能量和燃料组分守恒方程，可以证明 $h_T$ 的守恒性，其中由于单位刘易斯数的假设，源项相互抵消。\n\n由于 $h_T$ 是一个守恒标量，它是 $Z$ 的线性函数。我们在边界处计算 $h_T$：\n- 在氧化剂边界 ($Z=0$)：$T = T_O$，$Y_F = 0$。因此，$h_{T,0} = c_p T_O + 0 \\cdot q = c_p T_O$。\n- 在燃料边界 ($Z=1$)：$T = T_F$，$Y_F = 1$。因此，$h_{T,1} = c_p T_F + 1 \\cdot q = c_p T_F + q$。\n\n$h_T(Z)$ 的线性关系为：\n$$ h_T(Z) = h_{T,0} + (h_{T,1} - h_{T,0})Z = c_p T_O + (c_p T_F + q - c_p T_O)Z $$\n现在我们可以通过重新整理其定义来找到温度 $T(Z)$：\n$$ T(Z) = \\frac{h_T(Z) - Y_F(Z) q}{c_p} = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z - Y_F(Z)\\frac{q}{c_p} $$\n代入 $Y_F(Z)$ 的分段表达式：\n对于 $Z \\le Z_{\\mathrm{st}}$ ($Y_F=0$)：\n$$ T(Z) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z $$\n对于 $Z > Z_{\\mathrm{st}}$ ($Y_F(Z) = \\frac{(s+1)Z - 1}{s}$):\n$$ T(Z) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z - \\left(\\frac{(s+1)Z - 1}{s}\\right)\\frac{q}{c_p} $$\n$$ T(Z) = T_O + \\frac{q}{sc_p} + Z\\left(T_F - T_O + \\frac{q}{c_p} - \\frac{(s+1)q}{sc_p}\\right) $$\n$$ T(Z) = T_O + \\frac{q}{sc_p} + Z\\left(T_F - T_O - \\frac{q}{sc_p}\\right) $$\n温度场是分段线性的，其最大值出现在火焰面 $Z=Z_{\\mathrm{st}}$ 处。\n\n**3. 绝热火焰温度的计算**\n\n绝热火焰温度 $T_{ad}$ 是火焰面处的温度 $T(Z_{\\mathrm{st}})$。我们可以使用较简单的贫燃料侧 $T(Z)$ 表达式，并代入 $Z=Z_{\\mathrm{st}} = \\frac{1}{s+1}$：\n$$ T_{ad} = T(Z_{\\mathrm{st}}) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z_{\\mathrm{st}} $$\n$$ T_{ad} = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)\\frac{1}{s+1} $$\n$$ T_{ad} = \\frac{T_O(s+1) + T_F - T_O}{s+1} + \\frac{q}{c_p(s+1)} $$\n$$ T_{ad} = \\frac{sT_O + T_F}{s+1} + \\frac{q}{c_p(s+1)} $$\n该表达式表明，火焰温度由两部分组成：在 $Z_{\\mathrm{st}}$ 处评估的两种流股惰性混合的温度，以及由于化学能释放引起的温升。\n\n现在，我们代入给定的数值：\n$T_F = 300\\,\\mathrm{K}$\n$T_O = 1000\\,\\mathrm{K}$\n$c_p = 3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1}$\n$q = 5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$\n$s = 4$\n\n首先，计算惰性混合温度项：\n$$ \\frac{sT_O + T_F}{s+1} = \\frac{4 \\times 1000\\,\\mathrm{K} + 300\\,\\mathrm{K}}{4+1} = \\frac{4300\\,\\mathrm{K}}{5} = 860\\,\\mathrm{K} $$\n接下来，计算燃烧引起的温升：\n$$ \\frac{q}{c_p(s+1)} = \\frac{5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}}{(3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1})(4+1)} = \\frac{5.0 \\times 10^7}{3.6 \\times 10^3 \\times 5}\\,\\mathrm{K} = \\frac{5.0 \\times 10^7}{1.8 \\times 10^4}\\,\\mathrm{K} \\approx 2777.78\\,\\mathrm{K} $$\n绝热火焰温度是这两项之和：\n$$ T_{ad} = 860\\,\\mathrm{K} + 2777.77... \\,\\mathrm{K} = 3637.77... \\,\\mathrm{K} $$\n四舍五入到四位有效数字，我们得到：\n$$ T_{ad} = 3638\\,\\mathrm{K} $$",
            "answer": "$$\\boxed{3638}$$"
        },
        {
            "introduction": "在Burke-Schumann模型的基础上，我们现在转向更符合实际的有限速率化学反应情景。这引入了化学反应时间与混合时间（由标量耗散率 $\\chi$ 表征）之间的竞争。本练习要求学生通过数值求解一维对冲火焰的火焰面方程，绘制出著名的“S-曲线”，即最高火焰温度随标量耗散率的变化关系，从而直观地揭示点火和熄火现象的本质 。",
            "id": "4024497",
            "problem": "给定一个稳态、Lewis数为1的对冲扩散火焰面模型，用于描述在混合分数坐标 $Z \\in [0,1]$ 中的单步不可逆反应。燃料质量分数 $Y_F(Z)$、氧化剂质量分数 $Y_O(Z)$ 和温度 $T(Z)$ 满足从组分与能量守恒以及标量耗散率定义中导出的常微分方程：\n$$\n-\\frac{\\chi}{2}\\frac{d^2 Y_F}{dZ^2} = \\frac{\\omega_F}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 Y_O}{dZ^2} = \\frac{\\omega_O}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 T}{dZ^2} = \\frac{\\dot{q}}{\\rho c_p},\n$$\n其中，$\\chi$ 是标量耗散率，在此简化模型中假定等于化学计量标量耗散率 $\\chi_{st}$，$\\rho$ 是密度，$c_p$ 是定压比热，$\\omega_F$ 和 $\\omega_O$ 分别是燃料和氧化剂的体积源项（消耗时为负值），$\\dot{q}$ 是体积放热率。\n\n假设采用单步Arrhenius模型，单位体积反应速率为\n$$\n\\omega_r(Z) = \\rho\\,k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T(Z)}\\right)\\,[Y_F(Z)]^a\\,[Y_O(Z)]^b,\n$$\n组分源项为\n$$\n\\omega_F(Z) = -\\,\\omega_r(Z),\\qquad \\omega_O(Z) = -\\,s\\,\\omega_r(Z),\n$$\n其中化学计量质量消耗因子 $s>0$。体积放热率为\n$$\n\\dot{q}(Z) = q\\,\\omega_r(Z),\n$$\n其中 $q$ 是单位质量燃料消耗的比放热量。边界条件代表燃料流和氧化剂流：\n$$\nY_F(0) = 0,\\quad Y_O(0) = Y_{O,u},\\quad T(0) = T_u,\\qquad\nY_F(1) = Y_{F,u},\\quad Y_O(1) = 0,\\quad T(1) = T_u,\n$$\n其中 $Y_{F,u} > 0$，$Y_{O,u} > 0$，且 $T_u$ 为上游温度。\n\n使用这些定义和以下常数：\n- $\\rho = 1.0$ $\\mathrm{kg/m^3}$,\n- $c_p = 1000$ $\\mathrm{J/(kg\\cdot K)}$,\n- $q = 5.0\\times 10^7$ $\\mathrm{J/kg}$,\n- $k_0 = 20.0$ $\\mathrm{s^{-1}}$,\n- $E_a = 1.2\\times 10^5$ $\\mathrm{J/mol}$,\n- $R = 8.314$ $\\mathrm{J/(mol\\cdot K)}$,\n- $a = 1$, $b = 1$,\n- $s = 4$,\n- $Y_{F,u} = 0.1$, $Y_{O,u} = 0.23$,\n- $T_u = 300$ $\\mathrm{K}$,\n- $D = 1.0\\times 10^{-4}$ $\\mathrm{m^2/s}$,\n\n并假设标量耗散率 $\\chi$ 为常数且等于 $\\chi_{st}$，您必须：\n\n1.  将边值问题表述为一阶形式，并针对每个指定的 $\\chi_{st}$，在 $Z \\in [0,1]$ 上进行数值求解。\n2.  计算最高温度\n$$\nT_{\\max} = \\max_{Z \\in [0,1]} T(Z),\n$$\n以 $\\mathrm{K}$ 为单位表示。\n3.  计算穿过火焰的单位面积积分放熱量\n$$\n\\mathcal{I}(\\chi_{st}) = \\int_0^1 \\dot{q}(Z)\\,\\frac{ds}{dZ}\\,dZ = \\sqrt{\\frac{2D}{\\chi_{st}}}\\,\\int_0^1 q\\,\\omega_r(Z)\\,dZ,\n$$\n以 $\\mathrm{W/m^2}$ 为单位表示，这里使用了在火焰法向一维变化的假设下的关系式 $\\chi = 2D\\left(\\frac{dZ}{ds}\\right)^2$。\n4.  根据应用于 $\\chi_{st}$ 值有序序列的以下准则，识别接近熄火时的急剧下降起点：\n   - 对于温度：找到满足 $\\displaystyle \\frac{T_{\\max}(\\chi_{st,i})}{T_{\\max}(\\chi_{st,i-1})}  0.90$ 的最小索引 $i>0$。如果不存在，则报告-1。\n   - 对于积分放热量：找到满足 $\\displaystyle \\frac{\\mathcal{I}(\\chi_{st,i})}{\\mathcal{I}(\\chi_{st,i-1})}  0.50$ 的最小索引 $i>0$。如果不存在，则报告-1。\n\n要求的单位是：\n- 温度，单位为 $\\mathrm{K}$。\n- 单位面积积分放熱量，单位为 $\\mathrm{W/m^2}$。\n\n您的程序必须使用上述常数实现数值解，并为以下标量耗散率测试集（单位为 $\\mathrm{s^{-1}}$）生成结果：\n- 理想路径：$\\chi_{st} = 5.0$,\n- 中等扩散：$\\chi_{st} = 15.0$,\n- 近熄火区：$\\chi_{st} = 30.0$,\n- 强扩散：$\\chi_{st} = 60.0$,\n- 极端扩散，边缘情况：$\\chi_{st} = 100.0$。\n\n最终的程序输出必须是单行，包含一个用方括号括起来的逗号分隔列表，格式如下：\n$$\n\\big[ [T_{\\max,1}, T_{\\max,2}, T_{\\max,3}, T_{\\max,4}, T_{\\max,5}],\\ [\\mathcal{I}_1, \\mathcal{I}_2, \\mathcal{I}_3, \\mathcal{I}_4, \\mathcal{I}_5],\\ i_T,\\ i_I \\big],\n$$\n其中 $T_{\\max,k}$ 和 $\\mathcal{I}_k$ 是按上述顺序排列的第 $k$ 个 $\\chi_{st}$ 的值，$i_T$ 是温度下降的起始索引，$i_I$ 是积分放热量下降的起始索引。所有数值输出中，$T_{\\max,k}$ 和 $\\mathcal{I}_k$ 必须是实数（浮点数），$i_T$ 和 $i_I$ 必须是整数。",
            "solution": "用户的要求是求解一个代表稳态一维对冲扩散火焰的边值问题（BVP），这是计算燃烧学中的一个典型问题。该求解过程需要数值求解一个耦合的、非线性的二阶常微分方程（ODEs）组。\n\n### 步骤1：问题验证\n\n根据要求提取并验证已知条件。\n\n**1.1. 提取的已知条件**\n\n- **控制方程**：\n$$-\\frac{\\chi}{2}\\frac{d^2 Y_F}{dZ^2} = \\frac{\\omega_F}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 Y_O}{dZ^2} = \\frac{\\omega_O}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 T}{dZ^2} = \\frac{\\dot{q}}{\\rho c_p}$$\n- **体积反应速率**：\n$$\\omega_r(Z) = \\rho\\,k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T(Z)}\\right)\\,[Y_F(Z)]^a\\,[Y_O(Z)]^b$$\n- **组分和热源项**：\n$$\\omega_F(Z) = -\\,\\omega_r(Z),\\qquad \\omega_O(Z) = -\\,s\\,\\omega_r(Z),\\qquad \\dot{q}(Z) = q\\,\\omega_r(Z)$$\n- **在 $Z \\in [0,1]$ 上的边界条件**：\n$$Y_F(0) = 0,\\quad Y_O(0) = Y_{O,u},\\quad T(0) = T_u$$\n$$Y_F(1) = Y_{F,u},\\quad Y_O(1) = 0,\\quad T(1) = T_u$$\n- **物理和化学常数**：\n  - $\\rho = 1.0$ $\\mathrm{kg/m^3}$\n  - $c_p = 1000$ $\\mathrm{J/(kg\\cdot K)}$\n  - $q = 5.0\\times 10^7$ $\\mathrm{J/kg}$\n  - $k_0 = 20.0$ $\\mathrm{s^{-1}}$\n  - $E_a = 1.2\\times 10^5$ $\\mathrm{J/mol}$\n  - $R = 8.314$ $\\mathrm{J/(mol\\cdot K)}$\n  - $a = 1$, $b = 1$\n  - $s = 4$\n  - $Y_{F,u} = 0.1$\n  - $Y_{O,u} = 0.23$\n  - $T_u = 300$ $\\mathrm{K}$\n  - $D = 1.0\\times 10^{-4}$ $\\mathrm{m^2/s}$\n- **假设**：标量耗散率 $\\chi$ 为常数且等于 $\\chi_{st}$。\n- **计算任务**：\n  1. 对于测试集 $\\{5.0, 15.0, 30.0, 60.0, 100.0\\}$ $\\mathrm{s^{-1}}$ 中的每个 $\\chi_{st}$，求解该BVP。\n  2. 计算最高温度 $T_{\\max} = \\max_{Z \\in [0,1]} T(Z)$。\n  3. 计算单位面积积分放熱量 $\\mathcal{I}(\\chi_{st}) = \\sqrt{\\frac{2D}{\\chi_{st}}}\\,\\int_0^1 q\\,\\omega_r(Z)\\,dZ$。\n  4. 找到满足 $\\frac{T_{\\max}(\\chi_{st,i})}{T_{\\max}(\\chi_{st,i-1})}  0.90$ 的最小索引 $i>0$（记为 $i_T$），若不存在则为-1。\n  5. 找到满足 $\\frac{\\mathcal{I}(\\chi_{st,i})}{\\mathcal{I}(\\chi_{st,i-1})}  0.50$ 的最小索引 $i>0$（记为 $i_I$），若不存在则为-1。\n\n**1.2. 验证结论**\n\n- **科学性**：该问题是火焰面方程的标准形式，是燃烧科学中的一个基本模型。所有方程和概念都基于化学动力学和输运现象的既定原理。（状态：**有效**）\n- **适定性**：该问题是一个定义明确的非线性边值问题。提供了所有必要的参数、边界条件和约束来指定数值求解程序。（状态：**有效**）\n- **客观性**：所有定义和要求都以精确、定量和明确的数学术语表述。（状态：**有效**）\n- **完整性和一致性**：问题是完全指定且自洽的。所提供的信息之间没有矛盾。（状态：**有效**）\n\n该问题有效，可以按所述方式求解。\n\n### 步骤2：求解方案构建\n\n该问题是一个二阶常微分方程组的BVP。为了使用像 `scipy.integrate.solve_bvp` 这样的标准数值求解器来求解，我们必须首先将该方程组转换为一阶形式。\n\n**2.1. 一阶系统**\n\n设状态向量为 $y(Z) = [y_0, y_1, y_2, y_3, y_4, y_5]^T$，其中：\n- $y_0(Z) = Y_F(Z)$\n- $y_1(Z) = \\frac{dY_F}{dZ}$\n- $y_2(Z) = Y_O(Z)$\n- $y_3(Z) = \\frac{dY_O}{dZ}$\n- $y_4(Z) = T(Z)$\n- $y_5(Z) = \\frac{dT}{dZ}$\n\n一阶常微分方程组为 $\\frac{dy}{dZ} = f(Z, y)$:\n- $\\frac{dy_0}{dZ} = y_1$\n- $\\frac{dy_1}{dZ} = \\frac{d^2Y_F}{dZ^2} = -\\frac{2}{\\chi_{st}}\\frac{\\omega_F}{\\rho} = \\frac{2}{\\chi_{st}}\\frac{\\omega_r}{\\rho}$\n- $\\frac{dy_2}{dZ} = y_3$\n- $\\frac{dy_3}{dZ} = \\frac{d2Y_O}{dZ^2} = -\\frac{2}{\\chi_{st}}\\frac{\\omega_O}{\\rho} = \\frac{2s}{\\chi_{st}}\\frac{\\omega_r}{\\rho}$\n- $\\frac{dy_4}{dZ} = y_5$\n- $\\frac{dy_5}{dZ} = \\frac{d^2T}{dZ^2} = -\\frac{2}{\\chi_{st}}\\frac{\\dot{q}}{\\rho c_p} = -\\frac{2q}{\\chi_{st} c_p}\\frac{\\omega_r}{\\rho}$\n\n代入 $\\omega_r$ 的表达式，且 $\\rho=1$, $a=1$, $b=1$:\n$$\\omega_r = k_0 \\exp\\left(-\\frac{E_a}{R y_4}\\right) y_0 y_2$$\n注意，在数值迭代过程中，$y_0$ 和 $y_2$ 可能会变为负值，这是不符合物理实际的。在反应速率计算中，它们被限制为0。\n\n**2.2. 边界条件**\n\n用状态向量 $y$ 表示的六个边界条件是：\n- 在 $Z=0$ 处：$y_0(0) = 0$, $y_2(0) = Y_{O,u}$, $y_4(0) = T_u$\n- 在 $Z=1$ 处：$y_0(1) = Y_{F,u}$, $y_2(1) = 0$, $y_4(1) = T_u$\n\n**2.3. 数值策略**\n\n1.  **BVP求解器**：使用 `scipy.integrate.solve_bvp` 函数。\n2.  **初始猜测**：一个好的初始猜测对于非线性求解器的收敛至关重要。我们基于质量分数的线性剖面和温度的抛物线剖面构建一个猜测，这假设了单个反应区。\n    - $Y_F(Z) \\approx Y_{F,u} Z$\n    - $Y_O(Z) \\approx Y_{O,u} (1-Z)$\n    - $T(Z) \\approx T_u + (T_{peak,guess} - T_u) (4Z(1-Z))$\n3.  **延拓法**：针对一系列递增的 $\\chi_{st}$ 求解该问题。对于第一个 $\\chi_{st}$ 值之后的每一个值，都使用前一个较小 $\\chi_{st}$ 的收敛解作为初始猜测。这增强了鲁棒性和收敛速度，尤其是在高 $\\chi_{st}$ 下火焰接近熄火时。\n4.  **熄火处理**：如果 `solve_bvp` 未能收敛，则将其解释为火焰熄火。在这种情况下，唯一稳定的解是无反应（平凡）解，其中处处 $T(Z) = T_u$，因此 $\\omega_r = 0$。对于这种情况，$T_{\\max}$ 设为 $T_u$，$\\mathcal{I}$ 设为0。\n5.  **后处理**：获得成功解 `sol` 后，在细网格上评估剖面。\n    - $T_{\\max}$ 通过取温度剖面 `sol.y[4,:]` 的最大值得到。\n    - $\\mathcal{I}$ 的计算方法是：首先使用求解出的 $Y_F$、$Y_O$ 和 $T$ 剖面在细网格上计算被积函数 $q\\,\\omega_r(Z)$，然后使用 `numpy.trapz` 进行数值积分，最后乘以预因子 $\\sqrt{2D/\\chi_{st}}$。\n6.  **索引识别**：处理最终的 $T_{\\max}$ 和 $\\mathcal{I}$ 值列表，根据指定的下降准则找到索引 $i_T$ 和 $i_I$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Solves the counterflow diffusion flamelet equations for a series of scalar dissipation rates,\n    calculates maximum temperature and integrated heat release, and identifies extinction indices.\n    \"\"\"\n    # Define physical and chemical constants from the problem statement\n    rho = 1.0       # kg/m^3\n    cp = 1000.0     # J/(kg*K)\n    q = 5.0e7       # J/kg\n    k0 = 20.0       # s^-1\n    Ea = 1.2e5      # J/mol\n    R = 8.314       # J/(mol*K)\n    a = 1.0         # Reaction order for fuel\n    b = 1.0         # Reaction order for oxidizer\n    s = 4.0         # Stoichiometric mass ratio\n    Y_F_u = 0.1     # Fuel mass fraction in fuel stream\n    Y_O_u = 0.23    # Oxidizer mass fraction in oxidizer stream\n    T_u = 300.0     # K\n    D = 1.0e-4      # m^2/s\n\n    # Define the test cases for the stoichiometric scalar dissipation rate\n    chi_st_values = [5.0, 15.0, 30.0, 60.0, 100.0]\n\n    def ode_fun(Z, y, chi_st):\n        \"\"\"\n        Defines the system of first-order ODEs for the flamelet model.\n        State vector y = [Y_F, Y_F', Y_O, Y_O', T, T']\n        \"\"\"\n        # Clamp concentrations and temperature to be physical\n        YF = np.maximum(y[0], 0.0)\n        YO = np.maximum(y[2], 0.0)\n        T = np.maximum(y[4], T_u)\n\n        # Volumetric reaction rate (rho=1)\n        reaction_rate = k0 * np.exp(-Ea / (R * T)) * (YF**a) * (YO**b)\n\n        # Second derivatives\n        d2YF_dZ2 = (2.0 / chi_st) * reaction_rate\n        d2YO_dZ2 = (2.0 * s / chi_st) * reaction_rate\n        d2T_dZ2 = -(2.0 * q / (cp * chi_st)) * reaction_rate\n\n        # Return derivatives of the state vector\n        return np.vstack((y[1], d2YF_dZ2, y[3], d2YO_dZ2, y[5], d2T_dZ2))\n\n    def bc_fun(ya, yb):\n        \"\"\"\n        Defines the boundary conditions at Z=0 (ya) and Z=1 (yb).\n        \"\"\"\n        return np.array([\n            ya[0] - 0.0,      # YF(0) = 0\n            ya[2] - Y_O_u,    # YO(0) = Y_O_u\n            ya[4] - T_u,      # T(0) = T_u\n            yb[0] - Y_F_u,    # YF(1) = Y_F_u\n            yb[2] - 0.0,      # YO(1) = 0\n            yb[4] - T_u,      # T(1) = T_u\n        ])\n\n    T_max_results = []\n    I_results = []\n    \n    sol_prev = None\n    Z_mesh = np.linspace(0, 1, 201)\n\n    for chi_st in chi_st_values:\n        if sol_prev is None:\n            # For the first run, create an analytical guess\n            y_guess = np.zeros((6, Z_mesh.size))\n            T_peak_guess = 2500.0\n            \n            y_guess[0, :] = Y_F_u * Z_mesh                 # YF profile\n            y_guess[1, :] = Y_F_u                          # YF' profile\n            y_guess[2, :] = Y_O_u * (1 - Z_mesh)           # YO profile\n            y_guess[3, :] = -Y_O_u                         # YO' profile\n            y_guess[4, :] = T_u + (T_peak_guess - T_u) * 4 * Z_mesh * (1 - Z_mesh) # T profile\n            y_guess[5, :] = (T_peak_guess - T_u) * 4 * (1 - 2 * Z_mesh)           # T' profile\n        else:\n            # Use the previous successful solution as guess (continuation)\n            y_guess = sol_prev.sol(Z_mesh)\n\n        # Solve the BVP\n        sol = solve_bvp(lambda Z, y: ode_fun(Z, y, chi_st),\n                        bc_fun,\n                        Z_mesh,\n                        y_guess,\n                        tol=1e-5,\n                        max_nodes=5000)\n\n        if not sol.success:\n            # If solver fails, assume extinction: trivial non-reacting solution\n            current_T_max = T_u\n            current_I = 0.0\n            sol_prev = None # Reset continuation\n        else:\n            # Store solution for next step in continuation\n            sol_prev = sol\n            \n            # Evaluate solution on a fine grid for accurate post-processing\n            Z_fine = np.linspace(0, 1, 1001)\n            y_fine = sol.sol(Z_fine)\n\n            # Task 2: Compute maximum temperature\n            T_profile = y_fine[4, :]\n            current_T_max = np.max(T_profile)\n\n            # Task 3: Compute integrated heat release\n            YF_fine = np.maximum(y_fine[0, :], 0.0)\n            YO_fine = np.maximum(y_fine[2, :], 0.0)\n            T_fine = y_fine[4, :]\n\n            omega_r_profile = rho * k0 * np.exp(-Ea / (R * T_fine)) * (YF_fine**a) * (YO_fine**b)\n            integral_q_omega_r = np.trapz(q * omega_r_profile, x=Z_fine)\n            \n            pre_factor = np.sqrt(2 * D / chi_st)\n            current_I = pre_factor * integral_q_omega_r\n\n        T_max_results.append(current_T_max)\n        I_results.append(current_I)\n\n    # Task 4: Identify onset indices for extinction\n    i_T = -1\n    for i in range(1, len(T_max_results)):\n        if T_max_results[i-1]  T_u and (T_max_results[i] / T_max_results[i-1])  0.90:\n            i_T = i\n            break\n            \n    i_I = -1\n    for i in range(1, len(I_results)):\n        if I_results[i-1]  1e-9 and (I_results[i] / I_results[i-1])  0.50:\n            i_I = i\n            break\n\n    # Format final output string\n    t_max_str = ','.join(map(str, T_max_results))\n    i_val_str = ','.join(map(str, I_results))\n    \n    print(f\"[[{t_max_str}],[{i_val_str}],{i_T},{i_I}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "通过数值计算得到S-曲线后，一个关键问题随之而来：S-曲线上哪些状态在物理上是可实现的？本练习利用一个简化的数学模型（范式方程）来深入探讨S-曲线不同分支的动态稳定性。通过分析每个稳态解的稳定性，学生将理解为什么中间分支是不稳定的，以及为什么系统在点火和熄火过程中表现出迟滞现象，从而对火焰的动态行为获得更深刻的理论认识 。",
            "id": "4024486",
            "problem": "考虑在混合分数空间中建模的、位于化学计量表面附近的对冲扩散火焰。从包含单步阿伦尼乌斯热释放和扩散输运的能量守恒方程出发，采用标准的火焰面假设，即空间结构受混合分数的支配，且化学计量标量耗散率是一个控制参数。在点火和熄火临界点附近，相对于非反应混合状态，该系统允许对热过程扰动的序参数振幅进行一维中心流形降维。在组织点火/熄火的尖点型分岔附近，该振幅遵循一个三次范式，并受化学计量标量耗散率的线性控制。在完全无量纲化的变量中，设振幅表示为 $\\,\\theta\\,$，控制参数为无量纲化学计量标量耗散率 $\\,\\chi_{st}\\,$。降阶动力学由下式给出\n$$\n\\frac{d\\theta}{dt} \\;=\\; A\\,\\theta \\;-\\; B\\,\\theta^{3} \\;+\\; C \\;-\\; \\chi_{st},\n$$\n其中参数为固定的正数 $\\,A=2.0\\,$, $\\,B=1.0\\,$ 和 $\\,C=1.2\\,$。所有量均为无量纲。\n\n稳态 $\\,\\theta^\\star\\,$ 满足\n$$\n-B\\,(\\theta^\\star)^{3} \\;+\\; A\\,\\theta^\\star \\;+\\; (C-\\chi_{st}) \\;=\\; 0.\n$$\n关于稳态的小扰动的线性增长率由右侧在 $\\,\\theta^\\star\\,$ 处的线性化的特征值给出：\n$$\n\\lambda(\\theta^\\star;\\chi_{st}) \\;=\\; \\left.\\frac{d}{d\\theta}\\Big(A\\,\\theta - B\\,\\theta^3 + C - \\chi_{st}\\Big)\\right|_{\\theta=\\theta^\\star} \\;=\\; A \\;-\\; 3B\\,(\\theta^\\star)^2.\n$$\n当且仅当 $\\,\\lambda(\\theta^\\star;\\chi_{st})0\\,$ 时，稳态是线性稳定的；当且仅当 $\\,\\lambda(\\theta^\\star;\\chi_{st})>0\\,$ 时，稳态是不稳定的。在S形曲线的转折点处，$\\,\\lambda(\\theta^\\star;\\chi_{st})=0\\,$。\n\n任务。编写一个程序：\n- 对于每个给定的 $\\,\\chi_{st}\\,$ 值，计算上述三次方程的所有实数稳态 $\\,\\theta^\\star\\,$。\n- 对于每个这样的 $\\,\\theta^\\star\\,$，计算相应的线性增长率 $\\,\\lambda(\\theta^\\star;\\chi_{st})\\,$。\n- 按 $\\,\\theta^\\star\\,$ 的升序对稳态进行排序，并按该顺序输出相应的 $\\,\\lambda\\,$ 值列表。每个 $\\,\\lambda\\,$ 的符号标识了相关S形曲线分支的稳定性。\n\n使用以下 $\\,\\chi_{st}\\,$ 值的测试套件来探测S形曲线的不同区域：\n- 一个下折叠边界情况，一个三解区内的值，一个三解区内的中程值，一个三解区内的上程值，一个上折叠边界情况，以及一个超出上折叠使得只剩下一个稳态的值。\n\n具体来说，使用：\n$$\n\\chi_{st} \\in \\{\\,0.111338,\\; 0.2,\\; 1.0,\\; 2.0,\\; 2.288992,\\; 3.0\\,\\}.\n$$\n\n数值要求：\n- 如果根 $\\,\\theta\\,$ 的虚部绝对值严格小于 $\\,10^{-10}\\,$，则将其视为实数根。\n- 移除数值差异小于 $\\,10^{-7}\\,$ 的重复稳态，保留一个代表值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的浮点数列表的列表。每个内部列表是针对一个 $\\,\\chi_{st}\\,$ 测试值的有序增长率 $\\,\\lambda\\,$。例如：“[[lambda_set_for_case_1],[lambda_set_for_case_2],...]”，不含多余空格或文本。\n- 所有输出均为无量纲数。输出中不需要也不允许使用物理单位。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 问题验证\n\n**第1步：提取给定条件**\n\n- **控制方程：** 无量纲振幅 $\\,\\theta\\,$ 的动力学由以下常微分方程给出：\n$$\n\\frac{d\\theta}{dt} \\;=\\; A\\,\\theta \\;-\\; B\\,\\theta^{3} \\;+\\; C \\;-\\; \\chi_{st}\n$$\n- **参数：** 固定的正常数为 $\\,A=2.0\\,$, $\\,B=1.0\\,$ 和 $\\,C=1.2\\,$。\n- **控制变量：** 无量纲化学计量标量耗散率为 $\\,\\chi_{st}\\,$。\n- **稳态条件：** 稳态 $\\,\\theta^\\star\\,$ 必须满足以下代数方程：\n$$\n-B\\,(\\theta^\\star)^{3} \\;+\\; A\\,\\theta^\\star \\;+\\; (C-\\chi_{st}) \\;=\\; 0\n$$\n- **稳定性条件：** 稳态 $\\,\\theta^\\star\\,$ 的线性稳定性由特征值 $\\,\\lambda(\\theta^\\star;\\chi_{st})\\,$ 的符号决定。\n- **特征值公式：**\n$$\n\\lambda(\\theta^\\star;\\chi_{st}) \\;=\\; A \\;-\\; 3B\\,(\\theta^\\star)^2\n$$\n- **稳定性判据：** 对于 $\\,\\lambda0\\,$，稳态是稳定的；对于 $\\,\\lambda>0\\,$，稳态是不稳定的。条件 $\\,\\lambda=0\\,$ 对应于一个转折点（分岔）。\n- **任务：** 对于给定集合中的每个 $\\,\\chi_{st}\\,$ 值，找到所有实数稳态 $\\,\\theta^\\star\\,$，计算它们对应的特征值 $\\,\\lambda\\,$，并根据其对应的 $\\,\\theta^\\star\\,$ 值按升序排序输出 $\\,\\lambda\\,$ 值的列表。\n- **测试套件：** 控制参数的规定值为 $\\,\\chi_{st} \\in \\{\\,0.111338,\\; 0.2,\\; 1.0,\\; 2.0,\\; 2.288992,\\; 3.0\\,\\}$。\n- **数值公差：**\n  - 如果根的虚部 $\\,\\left|\\text{Im}(\\theta)\\right|  10^{-10}\\,$，则该根被认为是实数根。\n  - 差异小于 $\\,10^{-7}\\,$ 的根被视为重复根。\n\n**第2步：使用提取的给定条件进行验证**\n\n该问题具有科学依据，源于燃烧理论（火焰面模型）和动力系统（分岔理论，特别是尖点灾变范式）的既定原理。其物理情景——由S形响应曲线表示的对冲扩散火焰中的点火和熄火——是该领域的典型问题。所提供的方程和参数是一致的，足以执行所要求的计算。该问题是适定的，因为具有实系数的三次方程有一组确定的根，并且后续步骤是确定性的。语言客观而精确。该问题不违反任何无效性标准。\n\n**第3步：结论与行动**\n\n该问题是**有效的**。将提供一个解决方案。\n\n### 解法\n\n任务是找到一个动力系统的稳态，并为一组给定的控制参数分析其线性稳定性。稳态 $\\,\\theta^\\star\\,$ 是一个三次多项式的实数根，其稳定性由特征值 $\\,\\lambda\\,$ 的符号决定。\n\n**1. 稳态方程**\n\n稳态是以下方程的根：\n$$\n-B\\,(\\theta^\\star)^{3} \\;+\\; A\\,\\theta^\\star \\;+\\; (C-\\chi_{st}) \\;=\\; 0\n$$\n代入给定的参数值 $\\,A=2.0\\,$, $\\,B=1.0\\,$ 和 $\\,C=1.2\\,$，并重新整理成标准多项式形式，我们得到：\n$$\n(\\theta^\\star)^3 - 2\\theta^\\star + (\\chi_{st} - 1.2) = 0\n$$\n这是一个形式为 $\\,x^3 + px + q = 0\\,$ 的降次三次方程，其中系数取决于控制参数 $\\,\\chi_{st}\\,$。对于测试套件中的每个 $\\,\\chi_{st}\\,$ 值，我们将找到该多项式的根。\n\n**2. 数值求根**\n\n我们将采用数值多项式求根算法，例如 `numpy` 库中提供的算法，来计算每个 $\\,\\chi_{st}\\,$ 对应的三次方程的三个（可能是复数）根。多项式 $\\,p(x) = c_3 x^3 + c_2 x^2 + c_1 x + c_0\\,$ 的系数为 $\\,c_3=1\\,$, $\\,c_2=0\\,$, $\\,c_1=-2\\,$ 和 $\\,c_0 = \\chi_{st} - 1.2\\,$。\n\n**3. 根的筛选与排序**\n\n数值求解器返回的根可能是复数。根据问题说明，我们只关心实数稳态。如果根 $\\,\\theta\\,$ 的虚部绝对值小于 $\\,10^{-10}\\,$，则该根被认为是实数根。我们将根据此标准筛选根，并仅保留其实部。\n\n问题还规定，彼此非常接近的根应被视为单个根。这在S形曲线的转折点处尤其重要，因为在该点两个根合并成一个二重根。在识别出实数根后，我们将它们按升序排序。然后，我们将遍历排序后的列表，并移除任何重复项，重复项定义为数值差异小于 $\\,10^{-7}\\,$ 的根。此过程产生一个有序的唯一实数稳态 $\\,\\theta^\\star\\,$ 列表。\n\n**4. 稳定性分析**\n\n对于每个唯一的实数稳态 $\\,\\theta^\\star\\,$，我们使用提供的公式计算相应的线性增长率（特征值）$\\,\\lambda\\,$：\n$$\n\\lambda(\\theta^\\star) = A - 3B(\\theta^\\star)^2\n$$\n代入 $\\,A=2.0\\,$ 和 $\\,B=1.0\\,$：\n$$\n\\lambda(\\theta^\\star) = 2 - 3(\\theta^\\star)^2\n$$\n$\\,\\lambda\\,$ 的符号决定了稳定性：\n- $\\,\\lambda  0\\,$: 稳态是稳定的（例如，稳定燃烧或熄灭状态）。\n- $\\,\\lambda > 0\\,$: 稳态是不稳定的（例如，一个物理上不可实现的中间状态）。\n- $\\,\\lambda = 0\\,$: 稳态是临界稳定的，标志着一个分岔点（点火或熄火）。\n\n由于 $\\,\\theta^\\star\\,$ 值的列表已经排序，计算出的 $\\,\\lambda\\,$ 值列表将按要求的顺序排列。\n\n**5. 算法实现**\n\n总体算法如下：\n- 初始化一个空列表来存储最终结果。\n- 对于测试套件中的每个 $\\,\\chi_{st}\\,$ 值：\n  - 定义三次多项式的系数。\n  - 计算多项式的根。\n  - 根据虚部公差筛选根，只保留实数根。\n  - 将实数根按升序排序。\n  - 根据数值差异公差筛选排序后的列表以移除重复项。\n  - 对于每个唯一的、已排序的根 $\\,\\theta^\\star\\,$，计算相应的特征值 $\\,\\lambda\\,$。\n  - 将得到的特征值列表追加到最终结果列表中。\n- 将最终的列表的列表格式化为指定的字符串格式以供输出。\n该过程系统地将每个控制参数值映射到系统所有相应物理状态的稳定性属性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and analyzes the steady states of a flamelet model near criticality.\n\n    The function iterates through a set of nondimensional scalar dissipation rates (chi_st)\n    and for each, solves for the steady-state thermal amplitudes (theta). It then\n    calculates the linear stability eigenvalue (lambda) for each steady state.\n    \"\"\"\n\n    # Define the model parameters from the problem statement.\n    A = 2.0\n    B = 1.0\n    C = 1.2\n\n    # Define the test suite of chi_st values.\n    # These values probe the S-curve response of the system, including\n    # the lower fold, the bistable region, the upper fold, and the\n    # single-solution (extinguished) region.\n    test_cases_chi_st = [0.111338, 0.2, 1.0, 2.0, 2.288992, 3.0]\n\n    # Define numerical tolerances as per the problem requirements.\n    IMAG_TOLERANCE = 1e-10  # Tolerance for treating a root as real.\n    DUPLICATE_TOLERANCE = 1e-7  # Tolerance for identifying duplicate roots.\n\n    all_lambda_results = []\n\n    for chi_st in test_cases_chi_st:\n        # The steady-state equation is B*theta^3 - A*theta - (C - chi_st) = 0.\n        # Rearranging into standard form x^3 + px + q = 0 gives:\n        # theta^3 - (A/B)*theta + (chi_st - C)/B = 0.\n        # With A=2.0, B=1.0, C=1.2, the coefficients for numpy.roots are:\n        # [1, 0, -A/B, (chi_st - C)/B]\n        poly_coeffs = [B, 0, -A, C - chi_st]\n        \n        # In this specific problem B=1, so we can write it as:\n        # [1, 0, -A, C - chi_st]\n        # or, to match the form x^3+px+q=0 used in the solution text:\n        # theta^3 - 2*theta + (chi_st - 1.2) = 0\n        # coeffs are [1, 0, -2, chi_st - 1.2]\n        \n        # Find all roots of the cubic polynomial.\n        roots = np.roots([1, 0, -A, chi_st - C])\n\n        # Filter for real roots based on the magnitude of the imaginary part.\n        real_thetas = [r.real for r in roots if abs(r.imag)  IMAG_TOLERANCE]\n\n        # Sort the real roots in ascending order.\n        real_thetas.sort()\n\n        # Remove duplicate roots based on the specified tolerance.\n        unique_thetas = []\n        if real_thetas:\n            unique_thetas.append(real_thetas[0])\n            for i in range(1, len(real_thetas)):\n                if abs(real_thetas[i] - unique_thetas[-1])  DUPLICATE_TOLERANCE:\n                    unique_thetas.append(real_thetas[i])\n        \n        # For each unique steady state theta, calculate the linear growth rate lambda.\n        # The list of thetas is already sorted, so the resulting lambdas will be\n        # in the required order.\n        # lambda = A - 3*B*theta^2\n        lambdas = [A - 3 * B * (theta**2) for theta in unique_thetas]\n\n        all_lambda_results.append(lambdas)\n\n    # Format the final output as a comma-separated list of lists, with no spaces.\n    outer_list_str = []\n    for lambda_list in all_lambda_results:\n        # Format each inner list of floats.\n        inner_list_str = f\"[{','.join(f'{l:.16g}' for l in lambda_list)}]\"\n        outer_list_str.append(inner_list_str)\n    \n    final_output_string = f\"[{','.join(outer_list_str)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}