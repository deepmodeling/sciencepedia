{
    "hands_on_practices": [
        {
            "introduction": "The heart of Newton's method lies in linearizing the governing equations. For flame problems, the greatest challenge comes from the stiff and highly nonlinear chemical source terms. This practice focuses on the analytical core of this linearization by deriving the partial derivatives of an Arrhenius reaction rate with respect to temperature and species concentrations . Mastering this fundamental calculus is the first step toward correctly constructing the Jacobian matrix required by the solver.",
            "id": "4057801",
            "problem": "Consider a steady, planar, one-dimensional premixed flame at constant pressure, modeled as a boundary-value problem (BVP) in the spatial coordinate $x \\in [0,L]$. The mixture consists of a fuel $F$, an oxidizer $O$, and products $P$ undergoing a single-step irreversible reaction with stoichiometry $\\nu_{F} F + \\nu_{O} O \\rightarrow \\nu_{P} P$. Assume the following:\n\n- The mass flux $m$ is constant, the thermal conductivity $\\lambda$ is constant, and the species diffusivity $D$ is constant with unity Lewis numbers (equal thermal and mass diffusivities for simplicity).\n- The specific heat at constant pressure $c_{p}$ is constant.\n- The density $\\rho$ follows the ideal-gas relation at constant pressure with an effectively constant mixture molecular weight $\\bar{W}$, so $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$ where $R_{u}$ is the universal gas constant and $\\bar{p}$ is the constant pressure.\n- The heat release is represented by a constant effective heat of reaction $Q$ such that the chemical source term in the energy equation is $- \\sum_{k} h_{k} \\omega_{k} = Q\\,\\dot{\\omega}$ with $Q > 0$ for an exothermic reaction.\n- Define the positive stoichiometric mass factors $s_{F} = \\nu_{F} W_{F}$, $s_{O} = \\nu_{O} W_{O}$, and $s_{P} = \\nu_{P} W_{P}$, where $W_{k}$ are species molecular weights. Then the species mass production rates satisfy $\\omega_{F} = - s_{F}\\,\\dot{\\omega}$, $\\omega_{O} = - s_{O}\\,\\dot{\\omega}$, and $\\omega_{P} = s_{P}\\,\\dot{\\omega}$.\n- The reaction progress rate per unit volume is given by a single-step Arrhenius law\n$$\n\\dot{\\omega}(Y_{F},Y_{O},T) \\;=\\; A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp\\!\\big(-E/(R_{u} T)\\big)\n$$\nwith $A>0$, activation energy $E>0$, order $a>0$ in the fuel and $b>0$ in the oxidizer, and mass fractions $Y_{F}$ and $Y_{O}$.\n\nStarting strictly from the one-dimensional steady conservation laws for species and energy, and the ideal-gas density model above:\n\n1) Write the explicit BVP differential equations for the fuel mass fraction $Y_{F}(x)$, oxidizer mass fraction $Y_{O}(x)$, and temperature $T(x)$, including convection, diffusion, and the chemical source terms expressed via $\\dot{\\omega}$. State reasonable upstream and downstream boundary conditions to complete the BVP.\n\n2) For use in a Newton method (Newton–Raphson) applied to the discretized BVP residuals for $(Y_{F},Y_{O},T)$, derive the analytical expressions for the local partial derivatives of the reaction-source contributions to the residual vector $\\boldsymbol{R}(Y_{F},Y_{O},T) = \\big(R_{F},R_{O},R_{T}\\big)$ with respect to the variables $(Y_{F},Y_{O},T)$. Assume the residuals are assembled in the standard form\n$$\nR_{F} \\;=\\; m\\,\\frac{d Y_{F}}{dx} \\;-\\; \\frac{d}{dx}\\!\\Big(\\rho D\\,\\frac{d Y_{F}}{dx}\\Big) \\;-\\; \\omega_{F}, \\qquad\nR_{O} \\;=\\; m\\,\\frac{d Y_{O}}{dx} \\;-\\; \\frac{d}{dx}\\!\\Big(\\rho D\\,\\frac{d Y_{O}}{dx}\\Big) \\;-\\; \\omega_{O},\n$$\n$$\nR_{T} \\;=\\; m\\,c_{p}\\,\\frac{d T}{dx} \\;-\\; \\frac{d}{dx}\\!\\Big(\\lambda\\,\\frac{d T}{dx}\\Big) \\;-\\; Q\\,\\dot{\\omega},\n$$\nso that the reaction-source contributions to the Jacobian are the local derivatives of $(-\\omega_{F}, -\\omega_{O}, -Q\\,\\dot{\\omega})$ with respect to $(Y_{F},Y_{O},T)$. Incorporate the dependence $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$ in the derivative with respect to $T$, and keep the result in closed analytic form in terms of $(A,E,R_{u},\\rho,Y_{F},Y_{O},T,a,b,s_{F},s_{O},Q)$.\n\nReport your final answer as a single row matrix containing the nine partial derivatives in the order\n$$\n\\bigg(\\frac{\\partial R_{F}}{\\partial Y_{F}},\\;\\frac{\\partial R_{F}}{\\partial Y_{O}},\\;\\frac{\\partial R_{F}}{\\partial T},\\;\\frac{\\partial R_{O}}{\\partial Y_{F}},\\;\\frac{\\partial R_{O}}{\\partial Y_{O}},\\;\\frac{\\partial R_{O}}{\\partial T},\\;\\frac{\\partial R_{T}}{\\partial Y_{F}},\\;\\frac{\\partial R_{T}}{\\partial Y_{O}},\\;\\frac{\\partial R_{T}}{\\partial T}\\bigg).\n$$\n\nExpress the final answer as a closed-form analytic expression. No numerical evaluation or rounding is required.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **System:** Steady, planar, one-dimensional premixed flame.\n- **Spatial Domain:** The spatial coordinate is $x \\in [0,L]$.\n- **Chemical Scheme:** A single-step irreversible reaction $\\nu_{F} F + \\nu_{O} O \\rightarrow \\nu_{P} P$ involving fuel $F$, oxidizer $O$, and products $P$.\n- **Physical Constants and Properties:**\n    - Mass flux $m$ is constant.\n    - Thermal conductivity $\\lambda$ is constant.\n    - Species diffusivity $D$ is constant.\n    - Lewis numbers are unity.\n    - Specific heat at constant pressure $c_{p}$ is constant.\n    - Heat release is characterized by a constant effective heat of reaction $Q > 0$.\n- **State and Rate Models:**\n    - Density follows $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$, with pressure $\\bar{p}$, mean molecular weight $\\bar{W}$, and universal gas constant $R_{u}$ all constant.\n    - Energy source term: $- \\sum_{k} h_{k} \\omega_{k} = Q\\,\\dot{\\omega}$.\n    - Species mass production rates: $\\omega_{F} = - s_{F}\\,\\dot{\\omega}$, $\\omega_{O} = - s_{O}\\,\\dot{\\omega}$, $\\omega_{P} = s_{P}\\,\\dot{\\omega}$, where $s_{F} = \\nu_{F} W_{F}$ and $s_{O} = \\nu_{O} W_{O}$ are positive stoichiometric mass factors.\n    - Reaction progress rate: $\\dot{\\omega}(Y_{F},Y_{O},T) = A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp(-E/(R_{u} T))$, with pre-exponential factor $A>0$, activation energy $E>0$, and reaction orders $a>0$, $b>0$.\n- **Governing Residuals for Newton's Method:**\n    - $R_{F} = m\\,\\frac{d Y_{F}}{dx} - \\frac{d}{dx}(\\rho D\\,\\frac{d Y_{F}}{dx}) - \\omega_{F}$\n    - $R_{O} = m\\,\\frac{d Y_{O}}{dx} - \\frac{d}{dx}(\\rho D\\,\\frac{d Y_{O}}{dx}) - \\omega_{O}$\n    - $R_{T} = m\\,c_{p}\\,\\frac{d T}{dx} - \\frac{d}{dx}(\\lambda\\,\\frac{d T}{dx}) - Q\\,\\dot{\\omega}$\n- **Task:**\n    1.  Write the explicit BVP differential equations for $Y_{F}(x)$, $Y_{O}(x)$, and $T(x)$ and state reasonable boundary conditions.\n    2.  Derive the nine analytical partial derivatives of the reaction-source contributions to the Jacobian matrix, defined as the derivatives of $(-\\omega_{F}, -\\omega_{O}, -Q\\,\\dot{\\omega})$ with respect to $(Y_{F},Y_{O},T)$. The final answer should be a row matrix of these nine derivatives.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding:** The problem describes a simplified but standard and fundamental model of a one-dimensional premixed flame. The governing equations are based on the conservation of mass and energy, and the Arrhenius rate law is a cornerstone of chemical kinetics. The assumptions (constant properties, unity Lewis number, single-step reaction) are common idealizations used to render the problem analytically and computationally tractable. The model is scientifically sound.\n- **Well-Posedness:** The problem is well-posed. It requests the formulation of a BVP, which is a standard task, and the calculation of well-defined partial derivatives. The structure is clear and leads to a unique, meaningful result.\n- **Objectivity:** The problem is stated using precise, objective, and formal mathematical language. There are no subjective or ambiguous terms.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, self-contained exercise in computational combustion theory. The solution process may proceed.\n\n---\n\n### Solution\n\nThe solution is presented in two parts as requested by the problem statement.\n\n#### 1. Boundary-Value Problem (BVP) Formulation\n\nThe governing equations for a steady, one-dimensional reacting flow are derived from the conservation principles for species and energy. For a system with constant mass flux $m$, the conservation of a species with mass fraction $Y_k$ and diffusion velocity $V_k$ is given by $\\frac{d}{dx}(m Y_k + \\rho Y_k V_k) = \\omega_k$. Using Fick's law for mass diffusion, $\\rho Y_k V_k = -\\rho D_k \\frac{dY_k}{dx}$, and expanding the convective term, we get $m\\frac{dY_k}{dx} - \\frac{d}{dx}(\\rho D_k \\frac{dY_k}{dx}) = \\omega_k$. A similar derivation for energy conservation leads to the temperature equation.\n\nApplying the problem's specific assumptions—constant diffusivity $D$ for all species (due to unity Lewis number assumption implying $D_k = D = \\lambda/(\\rho c_p)$), constant thermal conductivity $\\lambda$, and constant specific heat $c_p$—and substituting the given source term expressions, we obtain the system of differential equations. The condition for a steady-state solution is that the residuals $R_F$, $R_O$, and $R_T$ are zero.\n\nThe BVP is therefore defined by the following system of second-order ordinary differential equations for $Y_F(x)$, $Y_O(x)$, and $T(x)$:\n\n1.  **Fuel Mass Fraction Equation:**\n    $$m\\,\\frac{d Y_{F}}{dx} - \\frac{d}{dx}\\!\\left(\\rho D\\,\\frac{d Y_{F}}{dx}\\right) = \\omega_{F} = -s_{F}\\,\\dot{\\omega}$$\n\n2.  **Oxidizer Mass Fraction Equation:**\n    $$m\\,\\frac{d Y_{O}}{dx} - \\frac{d}{dx}\\!\\left(\\rho D\\,\\frac{d Y_{O}}{dx}\\right) = \\omega_{O} = -s_{O}\\,\\dot{\\omega}$$\n\n3.  **Temperature Equation:**\n    $$m\\,c_{p}\\,\\frac{d T}{dx} - \\frac{d}{dx}\\!\\left(\\lambda\\,\\frac{d T}{dx}\\right) = Q\\,\\dot{\\omega}$$\n\nwhere $\\dot{\\omega} = A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp(-E/(R_{u} T))$ and $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$.\n\nReasonable boundary conditions for this BVP on the domain $x \\in [0,L]$ are:\n-   **Upstream (unburnt mixture at $x=0$):** We specify the composition and temperature of the fresh, unreacted mixture. These are Dirichlet conditions.\n    $$Y_{F}(0) = Y_{F,u}, \\quad Y_{O}(0) = Y_{O,u}, \\quad T(0) = T_{u}$$\n-   **Downstream (burnt products at $x=L$):** For a sufficiently long domain $L$, the flame is complete, and the system approaches chemical equilibrium and thermal uniformity. This is represented by setting the gradients of all variables to zero. These are homogeneous Neumann conditions.\n    $$\\frac{d Y_{F}}{dx}\\bigg|_{x=L} = 0, \\quad \\frac{d Y_{O}}{dx}\\bigg|_{x=L} = 0, \\quad \\frac{d T}{dx}\\bigg|_{x=L} = 0$$\n\n#### 2. Derivation of Jacobian Contributions from Reaction Sources\n\nThe task is to find the partial derivatives of the vector $(-\\omega_{F}, -\\omega_{O}, -Q\\,\\dot{\\omega})$ with respect to the variables $(Y_{F}, Y_{O}, T)$.\nUsing the given relations, the functions to be differentiated are:\n-   For the $R_{F}$ residual: $-\\omega_{F} = -(-s_{F}\\,\\dot{\\omega}) = s_{F}\\,\\dot{\\omega}$\n-   For the $R_{O}$ residual: $-\\omega_{O} = -(-s_{O}\\,\\dot{\\omega}) = s_{O}\\,\\dot{\\omega}$\n-   For the $R_{T}$ residual: $-Q\\,\\dot{\\omega}$\n\nThe central task is to compute the partial derivatives of the reaction rate $\\dot{\\omega}$ with respect to $Y_{F}$, $Y_{O}$, and $T$. The reaction rate is:\n$$\\dot{\\omega} = A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp\\!\\left(-\\frac{E}{R_{u} T}\\right)$$\n\n**Partial Derivative with respect to $Y_{F}$:**\n$$\\frac{\\partial \\dot{\\omega}}{\\partial Y_{F}} = A\\,\\rho(T)\\,(a\\,Y_{F}^{a-1})\\,Y_{O}^{b}\\,\\exp\\!\\left(-\\frac{E}{R_{u} T}\\right) = \\frac{a}{Y_{F}}\\dot{\\omega}$$\n\n**Partial Derivative with respect to $Y_{O}$:**\nBy symmetry with the $Y_F$ derivative:\n$$\\frac{\\partial \\dot{\\omega}}{\\partial Y_{O}} = A\\,\\rho(T)\\,Y_{F}^{a}\\,(b\\,Y_{O}^{b-1})\\,\\exp\\!\\left(-\\frac{E}{R_{u} T}\\right) = \\frac{b}{Y_{O}}\\dot{\\omega}$$\n\n**Partial Derivative with respect to $T$:**\nThis derivative involves both $\\rho(T)$ and the exponential term. We use logarithmic differentiation for an elegant derivation.\n$$\\ln(\\dot{\\omega}) = \\ln(A) + \\ln(\\rho(T)) + a\\ln(Y_{F}) + b\\ln(Y_{O}) - \\frac{E}{R_{u} T}$$\nGiven $\\rho(T) = \\frac{\\bar{p}\\bar{W}}{R_u T}$, we have $\\ln(\\rho(T)) = \\ln(\\frac{\\bar{p}\\bar{W}}{R_u}) - \\ln(T)$. Differentiating $\\ln(\\dot{\\omega})$ with respect to $T$ yields:\n$$\\frac{1}{\\dot{\\omega}}\\frac{\\partial \\dot{\\omega}}{\\partial T} = \\frac{d}{dT}(-\\ln(T)) - \\frac{d}{dT}\\left(\\frac{E}{R_{u} T}\\right) = -\\frac{1}{T} - \\left(-\\frac{E}{R_{u} T^2}\\right) = \\frac{E}{R_{u} T^2} - \\frac{1}{T}$$\nThus, the partial derivative is:\n$$\\frac{\\partial \\dot{\\omega}}{\\partial T} = \\dot{\\omega} \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$$\n\nNow, we construct the nine required partial derivatives. The results are expressed without using the shorthand $\\dot{\\omega}$, as per the problem instructions.\n\n1.  $\\frac{\\partial (-\\omega_{F})}{\\partial Y_{F}} = \\frac{\\partial (s_{F}\\dot{\\omega})}{\\partial Y_{F}} = s_{F} \\frac{a}{Y_{F}}\\dot{\\omega} = a s_{F} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T})$\n2.  $\\frac{\\partial (-\\omega_{F})}{\\partial Y_{O}} = \\frac{\\partial (s_{F}\\dot{\\omega})}{\\partial Y_{O}} = s_{F} \\frac{b}{Y_{O}}\\dot{\\omega} = b s_{F} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T})$\n3.  $\\frac{\\partial (-\\omega_{F})}{\\partial T} = \\frac{\\partial (s_{F}\\dot{\\omega})}{\\partial T} = s_{F}\\dot{\\omega}\\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) = s_{F} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$\n4.  $\\frac{\\partial (-\\omega_{O})}{\\partial Y_{F}} = \\frac{\\partial (s_{O}\\dot{\\omega})}{\\partial Y_{F}} = s_{O} \\frac{a}{Y_{F}}\\dot{\\omega} = a s_{O} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T})$\n5.  $\\frac{\\partial (-\\omega_{O})}{\\partial Y_{O}} = \\frac{\\partial (s_{O}\\dot{\\omega})}{\\partial Y_{O}} = s_{O} \\frac{b}{Y_{O}}\\dot{\\omega} = b s_{O} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T})$\n6.  $\\frac{\\partial (-\\omega_{O})}{\\partial T} = \\frac{\\partial (s_{O}\\dot{\\omega})}{\\partial T} = s_{O}\\dot{\\omega}\\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) = s_{O} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$\n7.  $\\frac{\\partial (-Q\\dot{\\omega})}{\\partial Y_{F}} = -Q \\frac{a}{Y_{F}}\\dot{\\omega} = -a Q A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T})$\n8.  $\\frac{\\partial (-Q\\dot{\\omega})}{\\partial Y_{O}} = -Q \\frac{b}{Y_{O}}\\dot{\\omega} = -b Q A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T})$\n9.  $\\frac{\\partial (-Q\\dot{\\omega})}{\\partial T} = -Q\\dot{\\omega}\\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) = -Q A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$\n\nThese nine expressions are collected into a single row matrix for the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\na s_{F} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) &\nb s_{F} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T}) &\ns_{F} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) &\na s_{O} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) &\nb s_{O} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T}) &\ns_{O} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) &\n-a Q A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) &\n-b Q A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T}) &\n-Q A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After deriving the analytical derivatives, the next step is to translate the continuous boundary-value problem into a system of algebraic equations that a computer can solve. This is achieved by discretizing the spatial domain onto a grid and approximating the derivatives. This exercise guides you through using finite differences to build the discrete residual equations and, crucially, to see how the continuous Jacobian translates into a large, sparse, block-structured matrix . Understanding this structure is essential for implementing efficient numerical solvers.",
            "id": "4057871",
            "problem": "Consider a steady, planar, one-dimensional boundary-value premixed flame model in the frame of the flame where advection, diffusion, and a single-step reaction couple two species: fuel and oxidizer. Assume constant density, constant properties, and an isothermal approximation so that the reaction rate depends only on the species. The governing species conservation equations are the following steady one-dimensional ordinary differential equations (ODEs), written for fuel mass fraction $Y_{F}(x)$ and oxidizer mass fraction $Y_{O}(x)$ on $x \\in [0,L]$:\n$$\n0 \\;=\\; D_{F}\\,\\frac{d^{2}Y_{F}}{dx^{2}} \\;-\\; u\\,\\frac{dY_{F}}{dx} \\;-\\; \\nu_{F}\\,\\omega(Y_{F},Y_{O}),\n$$\n$$\n0 \\;=\\; D_{O}\\,\\frac{d^{2}Y_{O}}{dx^{2}} \\;-\\; u\\,\\frac{dY_{O}}{dx} \\;-\\; \\nu_{O}\\,\\omega(Y_{F},Y_{O}),\n$$\nwhere $D_{F}$ and $D_{O}$ are species diffusivities, $u$ is a constant advection velocity, $\\nu_{F} > 0$ and $\\nu_{O} > 0$ are stoichiometric consumption coefficients, and the one-step isothermal reaction rate is given by\n$$\n\\omega(Y_{F},Y_{O}) \\;=\\; k\\,Y_{F}\\,Y_{O},\n$$\nwith $k>0$ a constant.\n\nDiscretize the domain with $N$ interior points $\\{x_{i}\\}_{i=1}^{N}$ uniformly spaced with grid spacing $\\Delta x = L/(N+1)$, and impose Dirichlet boundary conditions at $x=0$ and $x=L$:\n$$\nY_{F}(0) = Y_{F,L},\\quad Y_{O}(0) = Y_{O,L},\\quad Y_{F}(L) = Y_{F,R},\\quad Y_{O}(L) = Y_{O,R},\n$$\nwhere $Y_{F,L}$, $Y_{O,L}$, $Y_{F,R}$, and $Y_{O,R}$ are known constants. Use second-order central differences for both the first and second derivatives on a three-point stencil at interior nodes. Form the discrete residuals $R_{F,i}(Y_{F,i-1},Y_{F,i},Y_{F,i+1},Y_{O,i})$ and $R_{O,i}(Y_{O,i-1},Y_{O,i},Y_{O,i+1},Y_{F,i})$ at each interior grid point $i \\in \\{1,\\dots,N\\}$, where $Y_{F,i}$ and $Y_{O,i}$ denote the unknowns at node $i$ and boundary values at $i=0$ and $i=N+1$ are treated as known.\n\nLet the global unknown vector be ordered lexicographically by node, with species grouped per node:\n$$\n\\mathbf{U} \\;=\\; \\big( Y_{F,1},\\,Y_{O,1},\\,Y_{F,2},\\,Y_{O,2},\\,\\dots,\\,Y_{F,N},\\,Y_{O,N} \\big)^{\\mathsf{T}}.\n$$\nDefine the global residual $\\mathbf{R}(\\mathbf{U})$ accordingly by stacking species residuals per node.\n\nUsing the Newton method for nonlinear systems, construct the Jacobian matrix $\\mathbf{J} = \\partial \\mathbf{R}/\\partial \\mathbf{U}$ by computing the required partial derivatives that appear in the three-point stencil. Explicitly write:\n- The analytic partial derivatives at an interior node $i$ needed to populate the diagonal $2\\times 2$ block coupling $(Y_{F,i},Y_{O,i})$,\n- The analytic partial derivatives that populate the off-diagonal $2\\times 2$ blocks coupling node $i$ to nodes $i-1$ and $i+1$,\n- The sparsity pattern of the global Jacobian $\\mathbf{J}$, described in terms of the nonzero positions that arise from the three-point stencil with Dirichlet boundaries.\n\nFinally, compute the total number of nonzero entries in the global Jacobian $\\mathbf{J}$ as a function of the number of interior points $N$. Express the final answer as a single exact symbolic expression in $N$ with no units.",
            "solution": "The problem has been validated and is determined to be a well-posed, scientifically grounded problem in computational combustion. It contains all necessary information and is free from contradictions or ambiguities.\n\nWe begin by establishing the discrete residual equations for the system. The domain $x \\in [0,L]$ is discretized into $N$ interior points $\\{x_i\\}_{i=1}^{N}$ with uniform spacing $\\Delta x = L/(N+1)$. The nodes $x_0=0$ and $x_{N+1}=L$ are boundary points. Let $Y_{F,i} \\approx Y_F(x_i)$ and $Y_{O,i} \\approx Y_O(x_i)$.\n\nUsing second-order central difference schemes for the first and second derivatives at an interior node $i$:\n$$\n\\frac{dY}{dx}\\bigg|_{i} \\approx \\frac{Y_{i+1} - Y_{i-1}}{2\\Delta x}\n$$\n$$\n\\frac{d^{2}Y}{dx^{2}}\\bigg|_{i} \\approx \\frac{Y_{i+1} - 2Y_{i} + Y_{i-1}}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the governing equations yields the discrete residual equations for each interior node $i \\in \\{1, \\dots, N\\}$.\n\nFor the fuel mass fraction $Y_F$:\n$$\nR_{F,i}(Y_{F,i-1}, Y_{F,i}, Y_{F,i+1}, Y_{O,i}) = D_{F}\\,\\left(\\frac{Y_{F,i+1} - 2Y_{F,i} + Y_{F,i-1}}{(\\Delta x)^{2}}\\right) - u\\,\\left(\\frac{Y_{F,i+1} - Y_{F,i-1}}{2\\Delta x}\\right) - \\nu_{F}\\,k\\,Y_{F,i}\\,Y_{O,i}\n$$\nFor the oxidizer mass fraction $Y_O$:\n$$\nR_{O,i}(Y_{O,i-1}, Y_{O,i}, Y_{O,i+1}, Y_{F,i}) = D_{O}\\,\\left(\\frac{Y_{O,i+1} - 2Y_{O,i} + Y_{O,i-1}}{(\\Delta x)^{2}}\\right) - u\\,\\left(\\frac{Y_{O,i+1} - Y_{O,i-1}}{2\\Delta x}\\right) - \\nu_{O}\\,k\\,Y_{F,i}\\,Y_{O,i}\n$$\nThe values at the boundaries, $Y_{F,0}=Y_{F,L}$, $Y_{O,0}=Y_{O,L}$, $Y_{F,N+1}=Y_{F,R}$, and $Y_{O,N+1}=Y_{O,R}$, are known constants.\n\nThe Newton method requires the Jacobian matrix $\\mathbf{J} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{U}}$, where the global unknown vector is $\\mathbf{U} = (Y_{F,1}, Y_{O,1}, \\dots, Y_{F,N}, Y_{O,N})^{\\mathsf{T}}$ and the global residual vector is $\\mathbf{R} = (R_{F,1}, R_{O,1}, \\dots, R_{F,N}, R_{O,N})^{\\mathsf{T}}$. The Jacobian is a $(2N) \\times (2N)$ block matrix. A generic block element $\\mathbf{J}_{ij}$ is a $2\\times 2$ matrix given by:\n$$\n\\mathbf{J}_{ij} = \\frac{\\partial (R_{F,i}, R_{O,i})}{\\partial (Y_{F,j}, Y_{O,j})} = \\begin{pmatrix} \\frac{\\partial R_{F,i}}{\\partial Y_{F,j}} & \\frac{\\partial R_{F,i}}{\\partial Y_{O,j}} \\\\ \\frac{\\partial R_{O,i}}{\\partial Y_{F,j}} & \\frac{\\partial R_{O,i}}{\\partial Y_{O,j}} \\end{pmatrix}\n$$\nDue to the three-point stencil, the residuals at node $i$ depend only on unknowns at nodes $i-1$, $i$, and $i+1$. Thus, $\\mathbf{J}_{ij}$ is zero for $|i-j|>1$, and the Jacobian $\\mathbf{J}$ is block-tridiagonal.\n\nThe problem asks for the explicit partial derivatives that form the blocks.\n\n**1. Diagonal Block Derivatives (coupling node $i$ to itself, $j=i$)**\nThese derivatives form the $2 \\times 2$ diagonal blocks $\\mathbf{J}_{ii}$. We differentiate the residuals $R_{F,i}$ and $R_{O,i}$ with respect to the unknowns $Y_{F,i}$ and $Y_{O,i}$:\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{F,i}} = \\frac{-2D_{F}}{(\\Delta x)^{2}} - \\nu_{F}\\,k\\,Y_{O,i}\n$$\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{O,i}} = -\\nu_{F}\\,k\\,Y_{F,i}\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{F,i}} = -\\nu_{O}\\,k\\,Y_{O,i}\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{O,i}} = \\frac{-2D_{O}}{(\\Delta x)^{2}} - \\nu_{O}\\,k\\,Y_{F,i}\n$$\n\n**2. Off-Diagonal Block Derivatives (coupling node $i$ to $i-1$ and $i+1$)**\nThese derivatives populate the off-diagonal blocks $\\mathbf{J}_{i,i-1}$ and $\\mathbf{J}_{i,i+1}$.\n\nFor the lower off-diagonal blocks $\\mathbf{J}_{i,i-1}$ (where $i \\in \\{2, \\dots, N\\}$), we differentiate with respect to $Y_{F,i-1}$ and $Y_{O,i-1}$:\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{F,i-1}} = \\frac{D_{F}}{(\\Delta x)^{2}} + \\frac{u}{2\\Delta x}\n$$\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{O,i-1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{F,i-1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{O,i-1}} = \\frac{D_{O}}{(\\Delta x)^{2}} + \\frac{u}{2\\Delta x}\n$$\nFor the upper off-diagonal blocks $\\mathbf{J}_{i,i+1}$ (where $i \\in \\{1, \\dots, N-1\\}$), we differentiate with respect to $Y_{F,i+1}$ and $Y_{O,i+1}$:\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{F,i+1}} = \\frac{D_{F}}{(\\Delta x)^{2}} - \\frac{u}{2\\Delta x}\n$$\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{O,i+1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{F,i+1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{O,i+1}} = \\frac{D_{O}}{(\\Delta x)^{2}} - \\frac{u}{2\\Delta x}\n$$\n\n**3. Sparsity Pattern of the Global Jacobian $\\mathbf{J}$**\nThe global Jacobian matrix $\\mathbf{J}$ is a $(2N) \\times (2N)$ matrix. As established, it has a block-tridiagonal structure:\n$$\n\\mathbf{J} = \\begin{pmatrix}\n\\mathbf{A}_1 & \\mathbf{C}_1 & & & \\mathbf{0} \\\\\n\\mathbf{B}_2 & \\mathbf{A}_2 & \\mathbf{C}_2 & & \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & \\mathbf{B}_{N-1} & \\mathbf{A}_{N-1} & \\mathbf{C}_{N-1} \\\\\n\\mathbf{0} & & & \\mathbf{B}_N & \\mathbf{A}_N\n\\end{pmatrix}\n$$\nwhere $\\mathbf{A}_i=\\mathbf{J}_{ii}$, $\\mathbf{B}_i=\\mathbf{J}_{i,i-1}$, and $\\mathbf{C}_i=\\mathbf{J}_{i,i+1}$ are $2 \\times 2$ blocks.\n- The diagonal blocks, $\\mathbf{A}_i$, are generally dense, containing four non-zero entries resulting from the coupling of $Y_{F,i}$ and $Y_{O,i}$ in the reaction term and the second derivative stencil.\n- The off-diagonal blocks, $\\mathbf{B}_i$ and $\\mathbf{C}_i$, are diagonal matrices. Each contains two non-zero entries, as the fuel equation at node $i$ does not depend on the oxidizer at neighboring nodes (and vice versa) for this model.\n\n**4. Total Number of Nonzero Entries**\nTo find the total number of nonzero entries, we sum the contributions from each type of block.\n- There are $N$ diagonal blocks ($\\mathbf{A}_i$). Each contributes $4$ nonzero entries. Total from diagonal blocks: $4N$.\n- There are $N-1$ lower off-diagonal blocks ($\\mathbf{B}_i$). Each contributes $2$ nonzero entries. Total from lower blocks: $2(N-1)$.\n- There are $N-1$ upper off-diagonal blocks ($\\mathbf{C}_i$). Each contributes $2$ nonzero entries. Total from upper blocks: $2(N-1)$.\n\nThe total number of nonzero entries in the Jacobian matrix $\\mathbf{J}$ is the sum of these contributions:\n$$\n\\text{Total nonzeros} = 4N + 2(N-1) + 2(N-1) = 4N + 2N - 2 + 2N - 2 = 8N - 4\n$$",
            "answer": "$$\\boxed{8N - 4}$$"
        },
        {
            "introduction": "A \"pure\" Newton's method requires a good initial guess to converge, which is often not available for complex flame problems. To create a robust solver, we must \"damp\" the Newton step to prevent divergent iterations. This hands-on coding practice demonstrates a vital globalization strategy: the backtracking line search, which ensures that each step makes progress by sufficiently reducing a merit function . This exercise integrates the Jacobian calculation into a complete, working algorithm, bridging the gap between theory and a practical, robust implementation.",
            "id": "4057815",
            "problem": "Consider a dimensionless, one-dimensional, steady premixed boundary-value flame model for a scalar reaction-progress variable $y(x)$ on the domain $x \\in [0,1]$, where $y(x)$ satisfies Dirichlet boundary conditions $y(0)=1$ and $y(1)=0$. In the simplest reaction-diffusion approximation, the governing ordinary differential equation (ODE) arising from conservation of species and Fourier/Fick-type diffusion is\n$$\n-D \\frac{d^2 y}{dx^2} + \\mathrm{Da}\\, f(y) = 0,\n$$\nwhere $D>0$ is a constant dimensionless diffusion coefficient, $\\mathrm{Da}>0$ is the Damköhler number (reaction-to-transport rate ratio), and $f(y)$ is a smooth nonlinear reaction source. In this problem, use\n$$\nf(y) = y\\,(1-y)\\, e^{\\beta y},\n$$\nwhere $\\beta \\ge 0$ is a dimensionless activation parameter.\n\nDiscretize the ODE on a uniform grid with $N$ nodes, indexed by $i=0,1,\\dots,N-1$, grid spacing $\\Delta x = \\frac{1}{N-1}$, and unknown vector $U=\\mathbf{y} \\in \\mathbb{R}^{N}$ collecting the nodal values $y_i \\approx y(x_i)$ with $x_i=i\\Delta x$. Impose the Dirichlet boundary conditions via residual equations. Define the discrete residual $F(U) \\in \\mathbb{R}^{N}$ by\n- boundary residuals: $F_0(U) = y_0 - 1$ and $F_{N-1}(U) = y_{N-1} - 0$,\n- interior residuals for $i=1,\\dots,N-2$:\n$$\nF_i(U) = -D\\,\\frac{y_{i-1} - 2 y_i + y_{i+1}}{\\Delta x^2} + \\mathrm{Da}\\, f(y_i).\n$$\n\nThe Newton method for solving $F(U)=0$ is based on linearizing $F$ around the current iterate $U$, assembling the Jacobian $J(U)=\\frac{\\partial F}{\\partial U}$, solving the linear system $J(U)\\,p = -F(U)$ for the Newton step $p$, and updating $U_{\\text{new}} = U + \\alpha p$ with a step length $\\alpha \\in (0,1]$. To improve global convergence and robustness for highly nonlinear flame problems, damping via line search on the merit function is required.\n\nLet the merit function be\n$$\n\\phi(U) = \\frac{1}{2} \\|F(U)\\|_2^2,\n$$\nwith gradient $\\nabla \\phi(U) = J(U)^\\top F(U)$. A sufficient decrease condition (often called an Armijo condition) for selecting $\\alpha$ is\n$$\n\\phi(U + \\alpha p) \\le \\phi(U) + c_1 \\alpha\\, \\nabla \\phi(U)^\\top p,\n$$\nwhere $c_1 \\in (0,1)$ is a fixed parameter.\n\nTask:\n- Starting from the steady conservation law and the given discretization, derive the expressions needed to implement a Newton method with a backtracking line search that enforces sufficient decrease in the merit function $\\phi(U)=\\frac{1}{2}\\|F(U)\\|_2^2$.\n- Construct the Jacobian $J(U)$ explicitly for the discretized residual $F(U)$.\n- Implement a Newton iteration that computes $p$ from $J(U)p=-F(U)$ and performs a backtracking line search on $\\alpha$ to enforce the Armijo condition with a fixed $c_1$.\n- Use the following test suite of parameter sets and initial guesses:\n    - Case $1$ (happy path): $N=64$, $D=1$, $\\mathrm{Da}=10$, $\\beta=5$, initial guess $y_i^{(0)} = 1 - x_i$.\n    - Case $2$ (strong reaction nonlinearity): $N=64$, $D=1$, $\\mathrm{Da}=100$, $\\beta=10$, initial guess $y_i^{(0)} = 1 - x_i$.\n    - Case $3$ (stiffer edge case): $N=128$, $D=1$, $\\mathrm{Da}=300$, $\\beta=20$, initial guess $y_i^{(0)} = 1 - x_i$.\n- In each case, perform exactly one Newton linearization at the initial guess, compute the Newton step $p$, and apply the backtracking line search starting from $\\alpha_0=1$ with $c_1=10^{-4}$, halving $\\alpha$ repeatedly until the Armijo condition is satisfied. Record the accepted $\\alpha$ after the line search terminates for that first Newton step. If the Armijo condition is not satisfied within $50$ halvings, return the last tested $\\alpha$.\n- Your program should produce a single line of output containing the accepted step lengths for the three test cases as a comma-separated list enclosed in square brackets (e.g., $[0.5,0.25,1.0]$). The outputs are unitless dimensionless numbers and should be printed as Python floating-point literals.\n\nYour implementation must be a complete, runnable program. It must not read input. It must implement the Newton step and the Armijo backtracking line search using the definitions above. The test suite covers a general case (Case $1$), a strongly nonlinear case likely requiring damping (Case $2$), and a stiffer edge case expected to require more aggressive damping (Case $3$). The final answers for each case are floats representing the accepted step length $\\alpha$ after enforcing the sufficient decrease condition on $\\phi$ for the first Newton step only. The final output format must be a single line: a list of three floats in square brackets, separated by commas, with no spaces.",
            "solution": "The problem statement poses a well-defined numerical task in the field of computational combustion, requiring the implementation of a single Newton step with a backtracking line search for a discretized one-dimensional boundary-value flame problem. The problem is scientifically grounded, mathematically consistent, and provides all necessary information for its solution. Therefore, it is deemed valid. We proceed with the derivation and implementation.\n\nThe core of the problem is to find an approximate solution to the system of nonlinear algebraic equations $F(U)=0$, where $U \\in \\mathbb{R}^N$ is the vector of unknown nodal values of the reaction-progress variable, $y_i$, and $F(U) \\in \\mathbb{R}^N$ is the discrete residual vector. The solution method is Newton's method, which requires the Jacobian matrix of the residual, $J(U) = \\frac{\\partial F}{\\partial U}$.\n\nFirst, we derive the entries of the Jacobian matrix $J_{ij} = \\frac{\\partial F_i}{\\partial y_j}$. The residual vector $F(U)$ is defined component-wise.\n\nFor the boundary conditions, the residuals are:\n1.  At $x_0=0$: $F_0(U) = y_0 - 1$.\n2.  At $x_{N-1}=1$: $F_{N-1}(U) = y_{N-1} - 0$.\n\nThe partial derivatives for these rows are straightforward:\n- For row $i=0$: $\\frac{\\partial F_0}{\\partial y_0} = 1$, and $\\frac{\\partial F_0}{\\partial y_j} = 0$ for $j \\neq 0$.\n- For row $i=N-1$: $\\frac{\\partial F_{N-1}}{\\partial y_{N-1}} = 1$, and $\\frac{\\partial F_{N-1}}{\\partial y_j} = 0$ for $j \\neq N-1$.\n\nFor the interior nodes, $i \\in \\{1, 2, \\dots, N-2\\}$, the residual is given by the discretized governing equation:\n$$\nF_i(U) = -D\\,\\frac{y_{i-1} - 2 y_i + y_{i+1}}{\\Delta x^2} + \\mathrm{Da}\\, f(y_i)\n$$\nwhere $\\Delta x = \\frac{1}{N-1}$ is the grid spacing and $f(y) = y(1-y)e^{\\beta y}$.\n\nThe partial derivatives of $F_i$ for an interior node $i$ depend only on $y_{i-1}$, $y_i$, and $y_{i+1}$, making the Jacobian matrix tridiagonal for these rows.\n- The partial derivative with respect to $y_{i-1}$ is:\n$$\nJ_{i, i-1} = \\frac{\\partial F_i}{\\partial y_{i-1}} = -D\\,\\frac{1}{\\Delta x^2}\n$$\n- The partial derivative with respect to $y_{i+1}$ is:\n$$\nJ_{i, i+1} = \\frac{\\partial F_i}{\\partial y_{i+1}} = -D\\,\\frac{1}{\\Delta x^2}\n$$\n- The partial derivative with respect to $y_i$ involves the derivative of the reaction source term, $f'(y) = \\frac{df}{dy}$:\n$$\nJ_{i, i} = \\frac{\\partial F_i}{\\partial y_i} = -D\\,\\frac{-2}{\\Delta x^2} + \\mathrm{Da}\\, \\frac{d}{dy_i} [f(y_i)] = \\frac{2D}{\\Delta x^2} + \\mathrm{Da}\\,f'(y_i)\n$$\nTo complete this expression, we compute the derivative of $f(y)$:\n$$\nf(y) = (y-y^2)e^{\\beta y}\n$$\nUsing the product rule, we find:\n$$\nf'(y) = \\frac{d}{dy}(y-y^2) \\cdot e^{\\beta y} + (y-y^2) \\cdot \\frac{d}{dy}(e^{\\beta y}) = (1-2y)e^{\\beta y} + (y-y^2)(\\beta e^{\\beta y})\n$$\n$$\nf'(y) = (1 - 2y + \\beta y - \\beta y^2)e^{\\beta y}\n$$\nThe Jacobian matrix $J(U)$ is thus an $N \\times N$ matrix with a `1` on the diagonal for the first and last rows, and a tridiagonal structure for the interior rows, as derived above.\n\nThe Newton iteration involves two main stages:\n1.  **Solving for the Newton step $p$**: Given the current iterate $U$, we compute the residual $F(U)$ and the Jacobian $J(U)$, then solve the linear system $J(U)p = -F(U)$.\n2.  **Line search for the step length $\\alpha$**: We find a step length $\\alpha \\in (0, 1]$ that ensures a sufficient decrease in a merit function. Here, the merit function is $\\phi(U) = \\frac{1}{2}\\|F(U)\\|_2^2$. The sufficient decrease (Armijo) condition is:\n$$\n\\phi(U + \\alpha p) \\le \\phi(U) + c_1 \\alpha\\, \\nabla \\phi(U)^\\top p\n$$\nThe gradient of the merit function is $\\nabla \\phi(U) = J(U)^\\top F(U)$. Substituting this and the Newton equation $J(U)p = -F(U)$ simplifies the directional derivative term:\n$$\n\\nabla \\phi(U)^\\top p = (J(U)^\\top F(U))^\\top p = F(U)^\\top J(U) p = F(U)^\\top (-F(U)) = -\\|F(U)\\|_2^2\n$$\nThe Armijo condition thus simplifies to:\n$$\n\\frac{1}{2}\\|F(U + \\alpha p)\\|_2^2 \\le \\frac{1}{2}\\|F(U)\\|_2^2 - c_1 \\alpha \\|F(U)\\|_2^2\n$$\nThis form is computationally efficient as it avoids the explicit formation of $J^\\top F$.\n\nThe algorithm for each test case is as follows:\n1.  Initialize parameters ($N$, $D$, $\\mathrm{Da}$, $\\beta$) and grid properties ($\\Delta x$, $x_i$).\n2.  Define the initial guess $U^{(0)}$ as $y_i^{(0)} = 1 - x_i$.\n3.  Compute the initial residual $F(U^{(0)})$ and Jacobian $J(U^{(0)})$.\n4.  Solve the linear system $J(U^{(0)})p = -F(U^{(0)})$ for the Newton step $p$.\n5.  Compute the initial merit function value $\\phi(U^{(0)})$ and the squared L2-norm of the residual $\\|F(U^{(0)})\\|_2^2$.\n6.  Perform a backtracking line search:\n    a. Start with $\\alpha = 1$.\n    b. In a loop, test the current $\\alpha$.\n    c. If the simplified Armijo condition is met, accept the current $\\alpha$ and terminate the search.\n    d. If the condition is not met, reduce $\\alpha$ by halving it ($\\alpha \\leftarrow \\alpha/2$) and repeat the test.\n    e. This process is repeated for a maximum of $50$ halvings (i.e., $51$ total tests for $\\alpha = 1, 0.5, \\dots, 2^{-50}$). If the condition is not met after the final test, the last tested value of $\\alpha$ is recorded.\n7.  The final accepted (or last-tested) $\\alpha$ is recorded for the case.\n\nThe implementation will follow this procedure for the three specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the backtracking line search step length alpha for three test cases\n    of a 1D boundary-value flame problem discretized with finite differences.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (N, D, Da, beta)\n        (64, 1.0, 10.0, 5.0),\n        # Case 2: (N, D, Da, beta)\n        (64, 1.0, 100.0, 10.0),\n        # Case 3: (N, D, Da, beta)\n        (128, 1.0, 300.0, 20.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, D, Da, beta = case\n        \n        # --- Helper Functions for Reaction Kinetics ---\n        def f_reaction(y, beta_val):\n            \"\"\"Reaction source term f(y) = y(1-y)exp(beta*y)\"\"\"\n            return y * (1.0 - y) * np.exp(beta_val * y)\n\n        def df_reaction_dy(y, beta_val):\n            \"\"\"Derivative of the reaction source term, f'(y)\"\"\"\n            return (1.0 - 2.0 * y + beta_val * y - beta_val * y**2) * np.exp(beta_val * y)\n\n        # --- Functions to build the discrete residual and Jacobian ---\n        def compute_residual(U, n_nodes, D_val, Da_val, beta_val, dx):\n            \"\"\"Computes the residual vector F(U)\"\"\"\n            F = np.zeros(n_nodes)\n            # Boundary conditions\n            F[0] = U[0] - 1.0\n            F[n_nodes - 1] = U[n_nodes - 1] - 0.0\n            \n            # Interior nodes\n            dx2 = dx**2\n            for i in range(1, n_nodes - 1):\n                laplacian = (U[i-1] - 2.0 * U[i] + U[i+1]) / dx2\n                F[i] = -D_val * laplacian + Da_val * f_reaction(U[i], beta_val)\n            return F\n\n        def compute_jacobian(U, n_nodes, D_val, Da_val, beta_val, dx):\n            \"\"\"Computes the Jacobian matrix J(U)\"\"\"\n            J = np.zeros((n_nodes, n_nodes))\n            # Boundary conditions derivatives\n            J[0, 0] = 1.0\n            J[n_nodes - 1, n_nodes - 1] = 1.0\n            \n            # Interior nodes derivatives\n            dx2 = dx**2\n            d_val = -D_val / dx2\n            for i in range(1, n_nodes - 1):\n                # Off-diagonal elements (from diffusion term)\n                J[i, i-1] = d_val\n                J[i, i+1] = d_val\n                # Diagonal element (from diffusion and reaction)\n                J[i, i] = -2.0 * d_val + Da_val * df_reaction_dy(U[i], beta_val)\n            return J\n\n        # --- Main Logic for a Single Case ---\n        \n        # 1. Setup grid and initial guess\n        dx = 1.0 / (N - 1)\n        x = np.linspace(0, 1, N)\n        U0 = 1.0 - x  # Initial guess U^(0)\n\n        # 2. Perform one Newton step\n        #    a. Compute residual and Jacobian at U0\n        F0 = compute_residual(U0, N, D, Da, beta, dx)\n        J0 = compute_jacobian(U0, N, D, Da, beta, dx)\n        \n        #    b. Solve for the Newton step 'p' from J*p = -F\n        p = np.linalg.solve(J0, -F0)\n\n        # 3. Perform backtracking line search for alpha\n        c1 = 1e-4\n        max_halvings = 50\n        \n        # Pre-compute terms for Armijo condition\n        norm_F0_sq = np.dot(F0, F0)\n        phi0 = 0.5 * norm_F0_sq\n        \n        alpha = 1.0\n        # Loop for up to 50 halvings (51 total tests)\n        for i in range(max_halvings + 1):\n            U_trial = U0 + alpha * p\n            F_trial = compute_residual(U_trial, N, D, Da, beta, dx)\n            phi_trial = 0.5 * np.dot(F_trial, F_trial)\n            \n            # Armijo sufficient decrease condition\n            if phi_trial <= phi0 - c1 * alpha * norm_F0_sq:\n                # Accepted alpha, break the search\n                break\n            \n            # If condition not met, halve alpha for the next iteration\n            # The problem states to return the *last tested alpha* if it never passes.\n            # This loop structure ensures that if the condition never passes,\n            # 'alpha' holds the value from the last test (i=50).\n            if i < max_halvings:\n                alpha /= 2.0\n                \n        results.append(alpha)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}