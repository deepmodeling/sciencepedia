{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的火焰求解器之前，理解燃烧化学中固有的数值挑战至关重要。本练习将介绍化学刚性 (chemical stiffness) 的概念，即系统中存在着尺度迥异的反应时间尺度。通过一个简化的反应模型，我们将揭示最快的化学反应如何决定显式时间积分方法的稳定步长上限，从而阐明在实际计算中采用隐式方法的必要性 。",
            "id": "4073140",
            "problem": "考虑通过时间推进法计算一维预混火焰以达到稳态解。在固定轴向位置的极早期瞬态过程中，忽略输运过程，并将局部化学反应建模为空间均匀动力学。在这段短暂的时间内，混合物是等温的且密度恒定。一个刚性的两步全局机理将燃料转化为中间产物，然后转化为产物：\n- 步骤1：燃料 $\\mathrm{F}$ 和氧化剂 $\\mathrm{O}$ 反应生成中间产物 $\\mathrm{I}$，速率为 $r_{1} = k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}$。\n- 步骤2：中间产物 $\\mathrm{I}$ 分解为产物 $\\mathrm{P}$，速率为 $r_{2} = k_{2} C_{\\mathrm{I}}$。\n\n此处 $C_{\\mathrm{F}}$ 和 $C_{\\mathrm{I}}$ 表示摩尔浓度，单位为 $\\mathrm{mol/m^{3}}$。在早期瞬态过程中，假设氧化剂浓度近似恒定，等于其初始值 $C_{\\mathrm{O}}$，并假设混合物遵循理想气体行为。状态向量为 $y = \\begin{pmatrix} C_{\\mathrm{F}} \\\\ C_{\\mathrm{I}} \\end{pmatrix}$，局部源项为 $S(y) = \\begin{pmatrix} -k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} \\\\ k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}} \\end{pmatrix}$。初始条件为 $C_{\\mathrm{F}}(0) = 1.0$ 和 $C_{\\mathrm{I}}(0) = 0$（单位为 $\\mathrm{mol/m^{3}}$）。\n\n您将分析初始状态下的局部化学雅可比矩阵及其特征值，并将其与用于稳态一维火焰伪瞬态方法的均匀动力学显式前向欧拉时间积分的容许时间步长联系起来。\n\n给定参数：\n- $k_{1} = 1.0 \\times 10^{4} \\ \\mathrm{m^{3}/(mol \\, s)}$,\n- $k_{2} = 2.0 \\times 10^{2} \\ \\mathrm{s^{-1}}$,\n- 压力 $p = 1.01325 \\times 10^{5} \\ \\mathrm{Pa}$,\n- 温度 $T = 300 \\ \\mathrm{K}$,\n- 氧气摩尔分数 $X_{\\mathrm{O}} = 0.21$,\n- 普适气体常数 $R = 8.314462618 \\ \\mathrm{J/(mol \\, K)}$。\n\n任务：\n1. 从质量作用定律和雅可比矩阵的定义 $J(y) = \\partial S/\\partial y$ 出发，推导在 $C_{\\mathrm{O}}$ 被视为常数时的初始状态下的化学雅可比矩阵。\n2. 用 $k_{1}$、$k_{2}$ 和 $C_{\\mathrm{O}}$ 符号化地计算该雅可比矩阵的特征值。\n3. 应用于线性化系统 $\\dot{y} = J y$ 的显式前向欧拉方法的线性稳定性理论，确定在早期瞬态期间保证两种特征模式稳定性的最大时间步长 $\\Delta t_{\\max}$，首先用闭式解表示结果，然后进行数值计算。\n4. 通过理想气体定律 $C_{\\text{tot}} = p/(R T)$ 和 $C_{\\mathrm{O}} = X_{\\mathrm{O}} C_{\\text{tot}}$ 计算 $C_{\\mathrm{O}}$，然后计算 $\\Delta t_{\\max}$ 的数值。\n\n将 $\\Delta t_{\\max}$ 的最终数值答案四舍五入到四位有效数字，并以秒为单位表示。最终答案必须是一个实数。",
            "solution": "该问题要求分析应用于简化刚性化学动力学模型的显式时间积分方案的稳定性限制时间步长，该模型与一维预混火焰的伪瞬态计算相关。分析分为四个步骤：推导化学雅可比矩阵，求其特征值，确定符号化的稳定性约束，最后计算最大允许时间步长的数值。\n\n**步骤1：推导化学雅可比矩阵**\n\n控制局部均匀动力学的常微分方程组（ODEs）由 $\\frac{dy}{dt} = S(y)$ 给出，其中状态向量 $y$ 和源项 $S(y)$ 定义如下：\n$$\ny = \\begin{pmatrix} C_{\\mathrm{F}} \\\\ C_{\\mathrm{I}} \\end{pmatrix}\n$$\n$$\nS(y) = \\begin{pmatrix} S_1 \\\\ S_2 \\end{pmatrix} = \\begin{pmatrix} -k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} \\\\ k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}} \\end{pmatrix}\n$$\n问题指明氧化剂浓度 $C_{\\mathrm{O}}$ 被视为常数。化学雅可比矩阵 $J$ 定义为源项向量相对于状态向量各分量的偏导数矩阵：\n$$\nJ(y) = \\frac{\\partial S}{\\partial y} = \\begin{pmatrix} \\frac{\\partial S_1}{\\partial C_{\\mathrm{F}}}  \\frac{\\partial S_1}{\\partial C_{\\mathrm{I}}} \\\\ \\frac{\\partial S_2}{\\partial C_{\\mathrm{F}}}  \\frac{\\partial S_2}{\\partial C_{\\mathrm{I}}} \\end{pmatrix}\n$$\n我们计算雅可比矩阵的每个元素：\n- $\\frac{\\partial S_1}{\\partial C_{\\mathrm{F}}} = \\frac{\\partial}{\\partial C_{\\mathrm{F}}} (-k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}) = -k_{1} C_{\\mathrm{O}}$\n- $\\frac{\\partial S_1}{\\partial C_{\\mathrm{I}}} = \\frac{\\partial}{\\partial C_{\\mathrm{I}}} (-k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}) = 0$\n- $\\frac{\\partial S_2}{\\partial C_{\\mathrm{F}}} = \\frac{\\partial}{\\partial C_{\\mathrm{F}}} (k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}}) = k_{1} C_{\\mathrm{O}}$\n- $\\frac{\\partial S_2}{\\partial C_{\\mathrm{I}}} = \\frac{\\partial}{\\partial C_{\\mathrm{I}}} (k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}}) = -k_{2}$\n\n将这些分量组合起来，得到雅可比矩阵：\n$$\nJ = \\begin{pmatrix} -k_{1} C_{\\mathrm{O}}  0 \\\\ k_{1} C_{\\mathrm{O}}  -k_{2} \\end{pmatrix}\n$$\n由于源项 $S(y)$ 是 $y$ 各分量的线性函数（因为 $C_{\\mathrm{O}}$ 是常数），雅可比矩阵 $J$ 是常数，不依赖于状态 $y$。因此，在所述假设下，这就是初始状态以及所有后续时间的雅可比矩阵。\n\n**步骤2：雅可比矩阵的特征值**\n\n矩阵的特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根。然而，雅可比矩阵 $J$ 是一个下三角矩阵。三角矩阵的一个基本性质是其特征值就是其主对角线上的元素。\n因此，$J$ 的特征值为：\n$$\n\\lambda_{1} = -k_{1} C_{\\mathrm{O}}\n$$\n$$\n\\lambda_{2} = -k_{2}\n$$\n\n**步骤3：前向欧拉法的稳定性极限**\n\n前向欧拉法是一种显式时间积分格式，由 $y^{n+1} = y^n + \\Delta t S(y^n)$ 给出。对于线性系统 $\\dot{y} = Jy$，该格式变为 $y^{n+1} = y^n + \\Delta t J y^n = (I + \\Delta t J)y^n$。为使数值解保持稳定，放大矩阵 $G = I + \\Delta t J$ 的特征值的模必须不大于1。$G$ 的特征值为 $1 + \\Delta t \\lambda_i$，其中 $\\lambda_i$ 是 $J$ 的特征值。\n因此，稳定性条件为：\n$$\n|1 + \\Delta t \\lambda_i| \\le 1 \\quad \\text{for all } i\n$$\n在我们的情况下，速率常数 $k_{1}$ 和 $k_{2}$ 为正，浓度 $C_{\\mathrm{O}}$ 也为正。因此，特征值 $\\lambda_1 = -k_1 C_{\\mathrm{O}}$ 和 $\\lambda_2 = -k_2$ 都是实数且为负。对于一个实的负特征值 $\\lambda$，稳定性条件 $|1 + \\Delta t \\lambda| \\le 1$ 展开为：\n$$\n-1 \\le 1 + \\Delta t \\lambda \\le 1\n$$\n不等式的右侧 $1 + \\Delta t \\lambda \\le 1$ 意味着 $\\Delta t \\lambda \\le 0$，这对于 $\\Delta t > 0$ 和 $\\lambda  0$ 总是成立的。\n不等式的左侧 $-1 \\le 1 + \\Delta t \\lambda$ 意味着 $-2 \\le \\Delta t \\lambda$，可以重新排列得到时间步长的约束条件：\n$$\n\\Delta t \\le -\\frac{2}{\\lambda}\n$$\n为确保整个系统的稳定性，时间步长 $\\Delta t$ 必须对所有特征值都满足此条件。这意味着 $\\Delta t$ 必须小于最严格的限制：\n$$\n\\Delta t \\le \\min\\left(-\\frac{2}{\\lambda_1}, -\\frac{2}{\\lambda_2}\\right) = \\min\\left(\\frac{2}{k_{1} C_{\\mathrm{O}}}, \\frac{2}{k_{2}}\\right)\n$$\n可能的最大时间步长 $\\Delta t_{\\max}$ 是使上式成为等式的值。这可以用分母中的最大值函数来表示：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\max(k_{1} C_{\\mathrm{O}}, k_{2})}\n$$\n这就是最大稳定时间步长的闭式表达式。\n\n**步骤4：时间步长的数值计算**\n\n为了找到 $\\Delta t_{\\max}$ 的数值，我们必须首先计算 $C_{\\mathrm{O}}$。假设混合物表现为理想气体，总摩尔浓度 $C_{\\text{tot}}$ 由理想气体定律 $p = C_{\\text{tot}} R T$ 给出：\n$$\nC_{\\text{tot}} = \\frac{p}{RT}\n$$\n使用给定值 $p = 1.01325 \\times 10^{5} \\ \\mathrm{Pa}$，$R = 8.314462618 \\ \\mathrm{J/(mol \\, K)}$ 和 $T = 300 \\ \\mathrm{K}$：\n$$\nC_{\\text{tot}} = \\frac{1.01325 \\times 10^{5} \\ \\mathrm{Pa}}{(8.314462618 \\ \\mathrm{J/(mol \\, K)}) (300 \\ \\mathrm{K})} \\approx 40.6215 \\ \\mathrm{mol/m^3}\n$$\n氧化剂浓度 $C_{\\mathrm{O}}$ 是其摩尔分数 $X_{\\mathrm{O}}$ 乘以总浓度：\n$$\nC_{\\mathrm{O}} = X_{\\mathrm{O}} C_{\\text{tot}} = 0.21 \\times 40.6215 \\ \\mathrm{mol/m^3} \\approx 8.5305 \\ \\mathrm{mol/m^3}\n$$\n现在我们计算 $\\Delta t_{\\max}$ 表达式分母中的两项：\n- 第一项是 $k_{1} C_{\\mathrm{O}}$。给定 $k_{1} = 1.0 \\times 10^{4} \\ \\mathrm{m^{3}/(mol \\, s)}$：\n$$\nk_{1} C_{\\mathrm{O}} = (1.0 \\times 10^{4}) \\times 8.5305 \\ \\mathrm{s^{-1}} \\approx 8.5305 \\times 10^{4} \\ \\mathrm{s^{-1}}\n$$\n- 第二项是 $k_{2}$，给定为 $k_{2} = 2.0 \\times 10^{2} \\ \\mathrm{s^{-1}}$。\n\n比较这两个时间尺度的倒数：\n$$\n\\max(k_{1} C_{\\mathrm{O}}, k_{2}) = \\max(8.5305 \\times 10^{4}, 2.0 \\times 10^{2}) = 8.5305 \\times 10^{4} \\ \\mathrm{s^{-1}}\n$$\n最快的化学过程，即燃料的消耗，决定了稳定性极限。我们现在可以计算 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{2}{k_{1} C_{\\mathrm{O}}} = \\frac{2}{k_{1} X_{\\mathrm{O}} (p/RT)} = \\frac{2RT}{k_{1} X_{\\mathrm{O}} p}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2 \\times (8.314462618) \\times (300)}{(1.0 \\times 10^{4}) \\times (0.21) \\times (1.01325 \\times 10^{5})} \\ \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{4988.67757}{2.127825 \\times 10^{8}} \\ \\mathrm{s} \\approx 2.344550 \\times 10^{-5} \\ \\mathrm{s}\n$$\n按照要求四舍五入到四位有效数字：\n$$\n\\Delta t_{\\max} \\approx 2.345 \\times 10^{-5} \\ \\mathrm{s}\n$$\n这个极小的时间步长凸显了化学动力学中数值刚性的挑战，其中显式方法受到最快反应时间尺度的严格限制，即使人们关心的是发生在慢得多的时间尺度上的现象。",
            "answer": "$$\\boxed{2.345 \\times 10^{-5}}$$"
        },
        {
            "introduction": "在理解了化学刚性带来的挑战之后，我们进入核心任务：构建一个可用的求解器。本练习通过对控制方程进行时间积分直至达到稳态，来模拟一维非预混层流小火焰 (non-premixed flamelet) 的结构。此过程将采用一种半隐式方法，以高效地处理刚性的扩散项和反应项，为计算火焰分析提供坚实的基础 。",
            "id": "4073136",
            "problem": "要求您构建一个瞬态计算程序，以在固定的标量耗散率下恢复稳态一维小火焰解。其控制描述基于混合分数坐标系中的组分和能量守恒，并假设Lewis数为1且物性恒定。目标是积分非稳态小火焰方程直至达到稳态，然后报告在几个不同标量耗散率下稳态剖面的定量特征。\n\n从以下基本原理出发：\n- 在一维坐标系中，考虑扩散和反应的组分守恒：对于每个质量分数为 $Y$ 的反应物种，$$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial \\zeta^2} + S_Y,$$ 其中 $D$ 是有效扩散系数，$S_Y$ 是化学源项。\n- 考虑热传导和热释放的能量守恒：对于温度 $T$，$$\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial \\zeta^2} + S_T,$$ 其中 $S_T$ 是热释放源项。\n- 在Lewis数为1的小火焰坐标系中，有效扩散系数由标量耗散率 $\\chi$ 控制，即 $D = \\chi/2$。\n\n假设一个单步不可逆反应，燃料与氧气反应生成产物：$$F + O \\rightarrow P,$$ 其反应速率采用由活化温度建模的类Arrhenius速率模型。在此模型下，\n- 组分和温度方程为\n$$\\frac{\\partial Y_F}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_F}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_O}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_O}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_P}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_P}{\\partial \\zeta^2} + \\omega,$$\n$$\\frac{\\partial T}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 T}{\\partial \\zeta^2} + H \\,\\omega,$$\n其中 $\\omega$ 是反应速率，$H$ 是单位质量的有效热释放除以比热容，单位为开尔文。\n- 使用以下反应速率模型：\n$$\\omega(\\zeta,t) = k_0 \\,\\exp\\!\\left(-\\frac{\\Theta}{T(\\zeta,t)}\\right)\\, Y_F(\\zeta,t)\\, Y_O(\\zeta,t),$$\n其中 $k_0$ 是指前因子，单位为秒的倒数，$\\Theta$ 是活化温度，单位为开尔文。\n\n在混合分数域的两端施加与纯净流对应的Dirichlet边界条件：\n- 在 $\\zeta = 0$ 处：$Y_F = Y_{F,0}$，$Y_O = 0$，$Y_P = 0$，$T = T_0$。\n- 在 $\\zeta = 1$ 处：$Y_F = 0$，$Y_O = Y_{O,1}$，$Y_P = 0$，$T = T_1$。\n使用无反应的线性混合剖面对场进行初始化：\n$$Y_F(\\zeta,0) = Y_{F,0}\\,(1-\\zeta), \\quad Y_O(\\zeta,0) = Y_{O,1}\\,\\zeta, \\quad Y_P(\\zeta,0)=0, \\quad T(\\zeta,0) = T_0.$$\n\n将空间域 $\\zeta \\in [0,1]$ 离散化为包含 $N$ 个点的均匀网格。采用数值稳定的方法对时间进行积分，直至解达到稳态：使用后向Euler法隐式处理扩散项，并显式处理反应源项。对于隐式离散扩散算子，使用 $\\partial^2/\\partial \\zeta^2$ 的标准二阶中心差分近似和Dirichlet边界条件，从而在每个时间步为内部点生成一个三对角线性系统。对于内部索引为 $j$ 的每个变量 $u \\in \\{Y_F,Y_O,Y_P,T\\}$，在时间步 $n \\to n+1$ 的半隐式时间离散为\n$$(1 + 2r)\\,u_j^{n+1} - r\\,u_{j-1}^{n+1} - r\\,u_{j+1}^{n+1} = u_j^n + \\Delta t\\,S_u^n + r\\,u_{\\text{left}}^{n+1}\\,\\delta_{j,1} + r\\,u_{\\text{right}}^{n+1}\\,\\delta_{j,M},$$\n其中 $r = \\Delta t\\,(\\chi/2)/\\Delta \\zeta^2$，$M$ 是最后一个内部点的索引，$\\delta_{j,k}$ 是克罗内克δ函数，$u_{\\text{left}}$ 和 $u_{\\text{right}}$ 分别是 $\\zeta=0$ 和 $\\zeta=1$ 处的边界值。显式源项为 $S_{Y_F}^n = -\\omega^n$、$S_{Y_O}^n = -\\omega^n$、$S_{Y_P}^n = +\\omega^n$、$S_T^n = H\\,\\omega^n$，使用 $Y_F^n$、$Y_O^n$ 和 $T^n$ 进行计算。\n\n使用以下参数值（已注明物理单位）：\n- 标量耗散率 $\\chi$ (单位：秒⁻¹) 将因测试用例而异。\n- 指前因子 $k_0 = 500$ (单位：秒⁻¹)，活化温度 $\\Theta = 2000$ (单位：开尔文)，热释放参数 $H = 1500$ (单位：开尔文)。\n- 边界条件：$Y_{F,0} = 0.8$ (无量纲质量分数)，$Y_{O,1} = 0.21$ (无量纲质量分数)，$T_0 = 300$ (单位：开尔文)，$T_1 = 300$ (单位：开尔文)。\n- 空间网格大小 $N = 128$ (无量纲计数)，均匀间距 $\\Delta \\zeta = 1/(N-1)$；时间步长 $\\Delta t = 0.002$ (单位：秒)。\n- 收敛标准：当连续时间步之间的最大绝对变化满足 $\\max\\{\\lVert Y_F^{n+1}-Y_F^n\\rVert_\\infty,\\lVert Y_O^{n+1}-Y_O^n\\rVert_\\infty,\\lVert Y_P^{n+1}-Y_P^n\\rVert_\\infty\\}  10^{-8}$ 且 $\\lVert T^{n+1}-T^n\\rVert_\\infty  10^{-6}$ 时，或达到最大时间步数 $6000$ 时，宣告达到稳态，以先满足者为准。\n\n测试套件：\n针对以下标量耗散率（单位：秒⁻¹）评估程序：\n- 用例 1：$\\chi = 0.5$ (低耗散率，理想情况)。\n- 用例 2：$\\chi = 10.0$ (中等耗散率)。\n- 用例 3：$\\chi = 80.0$ (高耗散率，接近熄火行为)。\n\n对于每个用例，在收敛后，计算以下三个输出：\n- 最高温度 $T_{\\max}$ (单位：开尔文)，四舍五入到三位小数。\n- 最高温度的位置 $\\zeta_{\\max T}$（在 $[0,1]$ 范围内），四舍五入到三位小数。\n- 产物质量分数在整个域上的积分 $\\int_0^1 Y_P(\\zeta)\\,d\\zeta$（无量纲），通过梯形法则计算并四舍五入到三位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$[T_{\\max}^{(1)}, \\zeta_{\\max T}^{(1)}, I_P^{(1)}, T_{\\max}^{(2)}, \\zeta_{\\max T}^{(2)}, I_P^{(2)}, T_{\\max}^{(3)}, \\zeta_{\\max T}^{(3)}, I_P^{(3)}],$$\n其中上标 $(k)$ 表示测试套件中的用例 $k$。$T_{\\max}$ 以开尔文表示，$\\zeta_{\\max T}$ 为无量纲量，$I_P$ 为无量纲量。不应打印任何其他文本。",
            "solution": "推导始于针对Lewis数为1的混合分数坐标系下的守恒定律，该定律将所有标量的扩散与标量耗散率联系起来。在用于小火焰描述的一维坐标 $\\zeta$ 中，有效扩散系数为 $D = \\chi/2$，其中 $\\chi$ 是标量耗散率，单位为秒的倒数。组分质量分数 $Y$ 的守恒方程为\n$$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial \\zeta^2} + S_Y,$$\n温度 $T$ 的守恒方程为\n$$\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial \\zeta^2} + S_T,$$\n其中 $S_Y$ 和 $S_T$ 分别代表化学反应和热释放产生的源项。对于通过活化温度表示的类Arrhenius速率的单步反应 $F + O \\rightarrow P$，其反应速率建模为\n$$\\omega(\\zeta,t) = k_0 \\,\\exp\\!\\left(-\\frac{\\Theta}{T(\\zeta,t)}\\right)\\, Y_F(\\zeta,t)\\, Y_O(\\zeta,t),$$\n其中 $k_0$ 为指前因子，$\\Theta$ 为活化温度。在Lewis数为1和物性恒定的条件下，组分和能量方程变为\n$$\\frac{\\partial Y_F}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_F}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_O}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_O}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_P}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_P}{\\partial \\zeta^2} + \\omega,$$\n$$\\frac{\\partial T}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 T}{\\partial \\zeta^2} + H \\,\\omega,$$\n其中 $H = Q/c_p$ 是单位反应进程的有效温升，Q是单位质量燃料消耗的热释放，$c_p$是比热容。\n\n与对冲混合下的小火焰问题一致的边界条件，作为Dirichlet条件施加：\n- 在 $\\zeta = 0$ (燃料侧)：$Y_F = Y_{F,0}$，$Y_O = 0$，$Y_P = 0$，$T = T_0$。\n- 在 $\\zeta = 1$ (氧化剂侧)：$Y_F = 0$，$Y_O = Y_{O,1}$，$Y_P = 0$，$T = T_1$。\n这些条件代表了从两端进入的纯净流。初始条件是采用线性插值的无反应混合剖面：\n$$Y_F(\\zeta,0) = Y_{F,0}\\,(1-\\zeta),\\quad Y_O(\\zeta,0) = Y_{O,1}\\,\\zeta,\\quad Y_P(\\zeta,0)=0,\\quad T(\\zeta,0)=T_0.$$\n\n为了通过时间积分计算稳态解，我们将 $\\zeta \\in [0,1]$ 离散化为 $N$ 个均匀间隔的点，点间距为 $\\Delta \\zeta = 1/(N-1)$，并采用时间步长 $\\Delta t$。扩散算子采用二阶导数的二阶中心有限差分进行近似。对于内部点 $j = 1,\\dots,N-2$，通用场 $u$ 的 $\\partial^2 u/\\partial \\zeta^2$ 的空间离散为\n$$\\left.\\frac{\\partial^2 u}{\\partial \\zeta^2}\\right|_j \\approx \\frac{u_{j-1} - 2 u_j + u_{j+1}}{\\Delta \\zeta^2}。$$\n我们隐式处理扩散项以确保在较大的 $\\chi$ 值下保持稳定，并显式处理反应源项以避免求解非线性系统。对于内部点 $j$，带显式源项的后向Euler格式得出：\n$$(1 + 2r)\\,u_j^{n+1} - r\\,u_{j-1}^{n+1} - r\\,u_{j+1}^{n+1} = u_j^n + \\Delta t\\,S_u^n,$$\n其中\n$$r = \\frac{\\Delta t}{\\Delta \\zeta^2}\\frac{\\chi}{2}。$$\n通过将已知的边界值移到右侧，Dirichlet边界条件被纳入到第一个和最后一个内部点的方程中：\n$$(1 + 2r)\\,u_1^{n+1} - r\\,u_0^{n+1} - r\\,u_2^{n+1} = u_1^n + \\Delta t\\,S_u^n \\quad\\Rightarrow\\quad (1 + 2r)\\,u_1^{n+1} - r\\,u_2^{n+1} = u_1^n + \\Delta t\\,S_u^n + r\\,u_{\\text{left}},$$\n$$(1 + 2r)\\,u_{M}^{n+1} - r\\,u_{M-1}^{n+1} - r\\,u_{M+1}^{n+1} = u_{M}^n + \\Delta t\\,S_u^n \\quad\\Rightarrow\\quad (1 + 2r)\\,u_{M}^{n+1} - r\\,u_{M-1}^{n+1} = u_{M}^n + \\Delta t\\,S_u^n + r\\,u_{\\text{right}},$$\n其中 $M = N-2$ 是最后一个内部点的索引，$u_{\\text{left}}$ 和 $u_{\\text{right}}$ 分别是 $\\zeta=0$ 和 $\\zeta=1$ 处的Dirichlet边界值，且 $u_0^{n+1} = u_{\\text{left}}$，$u_{N-1}^{n+1} = u_{\\text{right}}$。\n\n这在每个时间步为每个场 $u \\in \\{Y_F, Y_O, Y_P, T\\}$ 产生一个三对角线性系统：\n$$\n\\begin{bmatrix}\n1+2r  -r  0  \\cdots  0 \\\\\n-r  1+2r  -r  \\cdots  0 \\\\\n0  -r  1+2r  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  -r \\\\\n0  0  0  -r  1+2r\n\\end{bmatrix}\n\\begin{bmatrix}\nu_1^{n+1} \\\\ u_2^{n+1} \\\\ u_3^{n+1} \\\\ \\vdots \\\\ u_{M}^{n+1}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nu_1^n + \\Delta t\\,S_{u,1}^n + r\\,u_{\\text{left}} \\\\\nu_2^n + \\Delta t\\,S_{u,2}^n \\\\\nu_3^n + \\Delta t\\,S_{u,3}^n \\\\\n\\vdots \\\\\nu_{M}^n + \\Delta t\\,S_{u,M}^n + r\\,u_{\\text{right}}\n\\end{bmatrix}.\n$$\n由于在给定用例中系数矩阵不变（$\\chi$、$\\Delta t$、$\\Delta \\zeta$ 固定），因此用于三对角系统的标准Thomas算法是高效且稳定的。\n\n反应源项在时间层 $n$ 使用以下公式显式计算\n$$\\omega_j^n = k_0 \\exp\\!\\left(-\\frac{\\Theta}{T_j^n}\\right) Y_{F,j}^n Y_{O,j}^n,$$\n每个场的源项为\n$$S_{Y_F,j}^n = - \\omega_j^n,\\quad S_{Y_O,j}^n = - \\omega_j^n,\\quad S_{Y_P,j}^n = + \\omega_j^n,\\quad S_{T,j}^n = H\\, \\omega_j^n.$$\n在求解扩散隐式更新后，精确施加Dirichlet边界条件：\n$$Y_F^{n+1}(0) = Y_{F,0},\\quad Y_F^{n+1}(1) = 0,\\quad Y_O^{n+1}(0) = 0,\\quad Y_O^{n+1}(1) = Y_{O,1},$$\n$$Y_P^{n+1}(0) = 0,\\quad Y_P^{n+1}(1) = 0,\\quad T^{n+1}(0) = T_0,\\quad T^{n+1}(1) = T_1.$$\n将质量分数裁剪到物理允许范围内，以避免由显式反应更新引起的微小负值偏差：\n$$Y_F^{n+1} \\leftarrow \\max(Y_F^{n+1}, 0),\\quad Y_O^{n+1} \\leftarrow \\max(Y_O^{n+1}, 0),\\quad Y_P^{n+1} \\leftarrow \\max(Y_P^{n+1}, 0).$$\n\n通过监测内部点每个时间步的最大绝对变化来评估是否收敛到稳态：\n$$\\Delta_Y^n = \\max\\left\\{ \\lVert Y_F^{n+1}-Y_F^n \\rVert_\\infty,\\, \\lVert Y_O^{n+1}-Y_O^n \\rVert_\\infty,\\, \\lVert Y_P^{n+1}-Y_P^n \\rVert_\\infty \\right\\},$$\n$$\\Delta_T^n = \\lVert T^{n+1}-T^n \\rVert_\\infty.$$\n当 $\\Delta_Y^n  10^{-8}$ 且 $\\Delta_T^n  10^{-6}$ 时，或迭代次数达到规定的最大值时停止。\n\n在每个测试用例的 $\\chi$ 值下达到稳态后，计算所要求的输出：\n- 最高温度 $T_{\\max}$ 为\n$$T_{\\max} = \\max_j T_j,$$\n其位置（在由网格点近似的连续坐标中）为\n$$\\zeta_{\\max T} = \\zeta_{\\arg\\max_j T_j}。$$\n- 产物质量分数在整个域上的积分使用梯形法则计算\n$$I_P = \\int_0^1 Y_P(\\zeta)\\,d\\zeta \\approx \\sum_{j=0}^{N-2} \\frac{Y_{P,j} + Y_{P,j+1}}{2} \\,\\Delta \\zeta。$$\n\n最后，按指定顺序汇总三个测试用例的结果。所有温度单位均为开尔文，标量耗散率单位为秒的倒数，质量分数为无量纲。程序按照指示，将九个数字按精确顺序打印在单行上\n$$[T_{\\max}^{(1)}, \\zeta_{\\max T}^{(1)}, I_P^{(1)}, T_{\\max}^{(2)}, \\zeta_{\\max T}^{(2)}, I_P^{(2)}, T_{\\max}^{(3)}, \\zeta_{\\max T}^{(3)}, I_P^{(3)}],$$\n并四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef thomas_algorithm(lower, diag, upper, rhs):\n    \"\"\"\n    Solve a tridiagonal system Ax = rhs where A has 'lower' subdiagonal,\n    'diag' main diagonal, and 'upper' superdiagonal using the Thomas algorithm.\n    All arrays are 1D; lengths: len(diag)=n, len(lower)=n-1, len(upper)=n-1.\n    \"\"\"\n    n = len(diag)\n    # Copy to avoid modifying inputs\n    c_prime = np.empty(n-1, dtype=float)\n    d_prime = np.empty(n, dtype=float)\n\n    # Forward sweep\n    c_prime[0] = upper[0] / diag[0]\n    d_prime[0] = rhs[0] / diag[0]\n    for i in range(1, n-1):\n        denom = diag[i] - lower[i-1] * c_prime[i-1]\n        c_prime[i] = upper[i] / denom\n        d_prime[i] = (rhs[i] - lower[i-1] * d_prime[i-1]) / denom\n    denom_last = diag[n-1] - lower[n-2] * c_prime[n-2]\n    d_prime[n-1] = (rhs[n-1] - lower[n-2] * d_prime[n-2]) / denom_last\n\n    # Back substitution\n    x = np.empty(n, dtype=float)\n    x[n-1] = d_prime[n-1]\n    for i in range(n-2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i+1]\n    return x\n\ndef run_case(chi, N=128, dt=0.002, max_steps=6000,\n             YF_left=0.8, YO_right=0.21, T_left=300.0, T_right=300.0,\n             Theta=2000.0, k0=500.0, H=1500.0,\n             tol_species=1e-8, tol_temp=1e-6):\n    \"\"\"\n    Integrate the unsteady flamelet equations to steady state for a given chi.\n    Returns Tmax (K), zeta_at_Tmax, integral of YP over domain.\n    \"\"\"\n    # Grid\n    zeta = np.linspace(0.0, 1.0, N)\n    dz = zeta[1] - zeta[0]\n    # Initial conditions: non-reacting mixing\n    YF = YF_left * (1.0 - zeta)\n    YO = YO_right * zeta\n    YP = np.zeros_like(zeta)\n    T = np.full_like(zeta, T_left)\n\n    # Dirichlet boundary values\n    YF_bL, YF_bR = YF_left, 0.0\n    YO_bL, YO_bR = 0.0, YO_right\n    YP_bL, YP_bR = 0.0, 0.0\n    T_bL, T_bR = T_left, T_right\n\n    # Precompute tridiagonal coefficients for implicit diffusion\n    r = dt * (chi / 2.0) / (dz * dz)\n    M = N - 2  # number of interior points\n    if M = 0:\n        raise ValueError(\"Grid must have at least 3 points.\")\n    lower = np.full(M-1, -r, dtype=float)\n    upper = np.full(M-1, -r, dtype=float)\n    diag = np.full(M, 1.0 + 2.0 * r, dtype=float)\n\n    # Time integration loop\n    for step in range(max_steps):\n        # Compute reaction rate omega (explicit) using current fields\n        # Prevent division by zero or overflow in exp by clipping temperature\n        T_eff = np.clip(T, 1e-6, 1e6)\n        omega = k0 * np.exp(-Theta / T_eff) * YF * YO\n\n        # Prepare RHS for each field (interior points only)\n        # Index mapping: interior j corresponds to full index i = j+1\n        # YF\n        rhs_YF = YF[1:-1] + dt * (-omega[1:-1])\n        rhs_YF[0] += r * YF_bL\n        rhs_YF[-1] += r * YF_bR\n        # YO\n        rhs_YO = YO[1:-1] + dt * (-omega[1:-1])\n        rhs_YO[0] += r * YO_bL\n        rhs_YO[-1] += r * YO_bR\n        # YP\n        rhs_YP = YP[1:-1] + dt * (+omega[1:-1])\n        rhs_YP[0] += r * YP_bL\n        rhs_YP[-1] += r * YP_bR\n        # T\n        rhs_T = T[1:-1] + dt * (H * omega[1:-1])\n        rhs_T[0] += r * T_bL\n        rhs_T[-1] += r * T_bR\n\n        # Solve tridiagonal systems\n        YF_new_interior = thomas_algorithm(lower, diag, upper, rhs_YF)\n        YO_new_interior = thomas_algorithm(lower, diag, upper, rhs_YO)\n        YP_new_interior = thomas_algorithm(lower, diag, upper, rhs_YP)\n        T_new_interior = thomas_algorithm(lower, diag, upper, rhs_T)\n\n        # Assemble full fields and enforce boundaries\n        YF_new = np.empty_like(YF)\n        YO_new = np.empty_like(YO)\n        YP_new = np.empty_like(YP)\n        T_new = np.empty_like(T)\n\n        YF_new[0] = YF_bL\n        YF_new[-1] = YF_bR\n        YF_new[1:-1] = YF_new_interior\n\n        YO_new[0] = YO_bL\n        YO_new[-1] = YO_bR\n        YO_new[1:-1] = YO_new_interior\n\n        YP_new[0] = YP_bL\n        YP_new[-1] = YP_bR\n        YP_new[1:-1] = YP_new_interior\n\n        T_new[0] = T_bL\n        T_new[-1] = T_bR\n        T_new[1:-1] = T_new_interior\n\n        # Clip mass fractions to [0, 1] for numerical sanity\n        YF_new = np.clip(YF_new, 0.0, 1.0)\n        YO_new = np.clip(YO_new, 0.0, 1.0)\n        YP_new = np.clip(YP_new, 0.0, 1.0)\n\n        # Check convergence\n        delta_species = max(\n            np.max(np.abs(YF_new - YF)),\n            np.max(np.abs(YO_new - YO)),\n            np.max(np.abs(YP_new - YP))\n        )\n        delta_temp = np.max(np.abs(T_new - T))\n        # Update fields\n        YF, YO, YP, T = YF_new, YO_new, YP_new, T_new\n\n        if delta_species  tol_species and delta_temp  tol_temp:\n            break\n\n    # Compute requested outputs\n    Tmax = float(np.max(T))\n    idx_max = int(np.argmax(T))\n    zeta_at_Tmax = float(zeta[idx_max])\n    IP = float(np.trapz(YP, zeta))\n\n    # Round as specified\n    Tmax = round(Tmax, 3)\n    zeta_at_Tmax = round(zeta_at_Tmax, 3)\n    IP = round(IP, 3)\n\n    return Tmax, zeta_at_Tmax, IP\n\ndef solve():\n    # Define the test cases from the problem statement (chi values in s^-1).\n    test_cases = [\n        0.5,   # Case 1: low dissipation\n        10.0,  # Case 2: moderate dissipation\n        80.0   # Case 3: high dissipation\n    ]\n\n    results = []\n    for chi in test_cases:\n        Tmax, zeta_max, IP = run_case(chi=chi)\n        results.extend([Tmax, zeta_max, IP])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "本章的最后一个练习将重点放在模拟的最终目的：从数据中提取有意义的物理量。计算模拟的原始输出往往包含数值或物理上的非理想因素，例如本例中的热量损失。本练习将演示如何应用基本物理定律（热力学第一定律）对控制体进行分析，以校正计算出的层流燃烧速度 ($S_L$)，从而架起计算结果与精确物理测量之间的桥梁 。",
            "id": "4073117",
            "problem": "一个长通道中的一维平面预混火焰随时间演化，直到其统计量在火焰固定坐标系中达到稳定。为了估算层流燃烧速度 $S_L$，构建一个完全包围火焰区的控制体，并使用在足够长的时间窗口内的时间平均量应用能量平衡。在存在对壁面的轻微热损失的情况下，直接将总化学热释放与对流显焓升相等会使 $S_L$ 产生偏差。利用火焰区上的控制体能量平衡来校正此偏差。\n\n假设以下科学上一致的模型和测量值：\n- 上游混合物是均匀的，其密度为 $\\rho_u = 1.20 \\ \\mathrm{kg/m^3}$，温度为 $T_u = 300 \\ \\mathrm{K}$。\n- 在控制体内测得的下游火焰后混合物温度为 $T_b = 2050 \\ \\mathrm{K}$。\n- 在整个温升范围内，混合物平均定压比热可近似为 $c_p = 1100 \\ \\mathrm{J/(kg \\cdot K)}$。\n- 在控制体上积分并按横截面积归一化的时间平均总化学热释放率为 $\\dot{q}''_{\\mathrm{chem}} = 1.00 \\times 10^{6} \\ \\mathrm{W/m^2}$。\n- 对壁面的时间平均总热损失（净向外热通量），按横截面积归一化后为 $\\dot{q}''_{\\mathrm{loss}} = 7.60 \\times 10^{4} \\ \\mathrm{W/m^2}$。\n\n从控制体的热力学第一定律的积分形式出发，并引用火焰固定坐标系中的一维稳态输运，推导出考虑热损失的校正后层流燃烧速度 $S_L$。将 $S_L$ 以 $\\mathrm{m/s}$ 为单位表示，并将最终数值答案四舍五入至四位有效数字。",
            "solution": "该问题在科学和数学上是有效的。它提出了一个基于基本热力学原理的燃烧物理学中适定的情景，并提供了一组一致的数据。\n\n我们首先将热力学第一定律应用于一个完全包围稳定一维火焰的控制体。对于稳态稳流过程，一个开放系统的能量平衡由下式给出：\n$$\n\\dot{E}_{in} - \\dot{E}_{out} = 0\n$$\n其中 $\\dot{E}$ 表示穿过控制体边界的能量输运速率。将其展开为热、功和流动质量能量的各项：\n$$\n\\dot{Q}_{cv} - \\dot{W}_{cv} + \\sum_{in} \\dot{m}_{in} \\left(h_{in} + \\frac{v_{in}^2}{2} + gz_{in}\\right) = \\sum_{out} \\dot{m}_{out} \\left(h_{out} + \\frac{v_{out}^2}{2} + gz_{out}\\right)\n$$\n此处，$\\dot{Q}_{cv}$ 是传入控制体的净传热速率，$\\dot{W}_{cv}$ 是控制体所做的净功速率，$\\dot{m}$ 是质量流率，$h$ 是比焓，$v$ 是速度，$z$ 是海拔高度。\n\n对于一维火焰的特定问题：\n$1$. 该过程是稳态的，因此时间导数为零。\n$2$. 有一个入口（未燃混合物，下标为 $u$）和一个出口（已燃产物，下标为 $b$）。根据质量守恒，质量流率是恒定的：$\\dot{m}_{in} = \\dot{m}_{out} = \\dot{m}$。\n$3$. 没有轴功产生，因此 $\\dot{W}_{cv} = 0$。\n$4$. 与燃烧引起的大量焓变相比，穿过火焰的动能和势能变化可以忽略不计。因此，我们可以忽略 $\\frac{v^2}{2}$ 和 $gz$ 项。\n\n能量方程简化为：\n$$\n\\dot{Q}_{cv} = \\dot{m} (h_b - h_u)\n$$\n净传热速率 $\\dot{Q}_{cv}$ 是控制体内化学反应产生的热量 $\\dot{Q}_{\\mathrm{chem}}$ 与散失到周围环境（壁面）的热量 $\\dot{Q}_{\\mathrm{loss}}$ 之和。由于 $\\dot{Q}_{\\mathrm{loss}}$ 表示向外的通量（一种损失），它在平衡式中以负号计入：\n$$\n\\dot{Q}_{cv} = \\dot{Q}_{\\mathrm{chem}} - \\dot{Q}_{\\mathrm{loss}}\n$$\n设 $A$ 为通道的横截面积。质量流率 $\\dot{m}$ 与上游性质和层流燃烧速度 $S_L$ 相关。在火焰固定坐标系中，未燃混合物以速度 $S_L$ 进入控制体。因此：\n$$\n\\dot{m} = \\rho_u A S_L\n$$\n假设平均比热 $c_p$ 为常数，比焓的变化为：\n$$\nh_b - h_u = c_p (T_b - T_u)\n$$\n将这些表达式代回简化的能量方程：\n$$\n\\dot{Q}_{\\mathrm{chem}} - \\dot{Q}_{\\mathrm{loss}} = (\\rho_u A S_L) c_p (T_b - T_u)\n$$\n问题提供了按横截面积 $A$ 归一化的量。我们定义热通量项为 $\\dot{q}''_{\\mathrm{chem}} = \\frac{\\dot{Q}_{\\mathrm{chem}}}{A}$ 和 $\\dot{q}''_{\\mathrm{loss}} = \\frac{\\dot{Q}_{\\mathrm{loss}}}{A}$。将整个方程除以 $A$ 得到以通量表示的能量平衡：\n$$\n\\dot{q}''_{\\mathrm{chem}} - \\dot{q}''_{\\mathrm{loss}} = \\rho_u S_L c_p (T_b - T_u)\n$$\n这个方程表示校正后的能量平衡，其中火焰提供的净能量（$\\dot{q}''_{\\mathrm{chem}} - \\dot{q}''_{\\mathrm{loss}}$）等于流过它的气体的显焓升（$\\rho_u S_L c_p (T_b - T_u)$）。问题中提到的“偏差”指的是忽略 $\\dot{q}''_{\\mathrm{loss}}$ 项，这将导致对 $S_L$ 的高估。\n\n我们现在求解校正后的层流燃烧速度 $S_L$：\n$$\nS_L = \\frac{\\dot{q}''_{\\mathrm{chem}} - \\dot{q}''_{\\mathrm{loss}}}{\\rho_u c_p (T_b - T_u)}\n$$\n我们代入给定的数值：\n-   $\\rho_u = 1.20 \\ \\mathrm{kg/m^3}$\n-   $c_p = 1100 \\ \\mathrm{J/(kg \\cdot K)}$\n-   $T_u = 300 \\ \\mathrm{K}$\n-   $T_b = 2050 \\ \\mathrm{K}$\n-   $\\dot{q}''_{\\mathrm{chem}} = 1.00 \\times 10^{6} \\ \\mathrm{W/m^2}$\n-   $\\dot{q}''_{\\mathrm{loss}} = 7.60 \\times 10^{4} \\ \\mathrm{W/m^2}$\n\n温差为 $\\Delta T = T_b - T_u = 2050 \\ \\mathrm{K} - 300 \\ \\mathrm{K} = 1750 \\ \\mathrm{K}$。\n净热通量为 $\\Delta \\dot{q}'' = \\dot{q}''_{\\mathrm{chem}} - \\dot{q}''_{\\mathrm{loss}} = 1.00 \\times 10^{6} \\ \\mathrm{W/m^2} - 7.60 \\times 10^{4} \\ \\mathrm{W/m^2} = 9.24 \\times 10^{5} \\ \\mathrm{W/m^2}$。\n\n将这些值代入 $S_L$ 的表达式中：\n$$\nS_L = \\frac{9.24 \\times 10^{5} \\ \\mathrm{W/m^2}}{ (1.20 \\ \\mathrm{kg/m^3}) \\times (1100 \\ \\mathrm{J/(kg \\cdot K)}) \\times (1750 \\ \\mathrm{K})}\n$$\n首先，我们计算分母：\n$$\n\\text{分母} = 1.20 \\times 1100 \\times 1750 = 1320 \\times 1750 = 2,310,000 \\ \\frac{\\mathrm{J}}{\\mathrm{m^3}}\n$$\n现在，我们计算 $S_L$ 的值：\n$$\nS_L = \\frac{924,000 \\ \\mathrm{W/m^2}}{2,310,000 \\ \\mathrm{J/m^3}} = \\frac{924,000 \\ \\mathrm{J/(s \\cdot m^2)}}{2,310,000 \\ \\mathrm{J/m^3}} = 0.4 \\ \\mathrm{m/s}\n$$\n问题要求最终答案四舍五入至四位有效数字。因此，我们将结果表示为 $0.4000 \\ \\mathrm{m/s}$。",
            "answer": "$$\n\\boxed{0.4000}\n$$"
        }
    ]
}