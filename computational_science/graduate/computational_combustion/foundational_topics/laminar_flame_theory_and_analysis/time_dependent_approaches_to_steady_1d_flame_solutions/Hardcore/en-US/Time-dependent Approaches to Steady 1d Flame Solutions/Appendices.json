{
    "hands_on_practices": [
        {
            "introduction": "Successfully simulating flames requires confronting the challenge of chemical stiffness, where reaction timescales can be many orders of magnitude smaller than flow or diffusion timescales. This exercise  provides a crucial first-principles look at this issue by analyzing a simple, yet representative, two-step chemical mechanism. By calculating the eigenvalues of the chemical Jacobian, you will directly quantify the fastest chemical timescale and determine the restrictive stability limit it imposes on explicit time-integration methods, motivating the use of the implicit techniques central to this topic.",
            "id": "4073140",
            "problem": "Consider a one-dimensional premixed flame being computed via time marching toward a steady solution. During the very early transient at a fixed axial location, neglect transport and model the local chemistry as spatially homogeneous kinetics. The mixture is isothermal and of constant density over this short time. A stiff two-step global mechanism converts fuel to an intermediate and then to products:\n- Step 1: Fuel $\\mathrm{F}$ and oxidizer $\\mathrm{O}$ react to form intermediate $\\mathrm{I}$ with rate $r_{1} = k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}$.\n- Step 2: Intermediate $\\mathrm{I}$ decays to products $\\mathrm{P}$ with rate $r_{2} = k_{2} C_{\\mathrm{I}}$.\n\nHere $C_{\\mathrm{F}}$ and $C_{\\mathrm{I}}$ denote molar concentrations $\\mathrm{mol/m^{3}}$. During the early transient, take the oxidizer concentration to be approximately constant, equal to its initial value $C_{\\mathrm{O}}$, and assume ideal-gas behavior for the mixture. The state vector is $y = \\begin{pmatrix} C_{\\mathrm{F}} \\\\ C_{\\mathrm{I}} \\end{pmatrix}$, and the local source term is $S(y) = \\begin{pmatrix} -k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} \\\\ k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}} \\end{pmatrix}$. The initial conditions are $C_{\\mathrm{F}}(0) = 1.0$ and $C_{\\mathrm{I}}(0) = 0$ (in $\\mathrm{mol/m^{3}}$).\n\nYou will analyze the local chemical Jacobian and its eigenvalues at the initial state and relate them to the admissible timestep for explicit forward Euler time integration of the homogeneous kinetics used in the pseudo-transient approach to steady one-dimensional flames.\n\nGiven parameters:\n- $k_{1} = 1.0 \\times 10^{4} \\ \\mathrm{m^{3}/(mol \\, s)}$,\n- $k_{2} = 2.0 \\times 10^{2} \\ \\mathrm{s^{-1}}$,\n- Pressure $p = 1.01325 \\times 10^{5} \\ \\mathrm{Pa}$,\n- Temperature $T = 300 \\ \\mathrm{K}$,\n- Oxygen mole fraction $X_{\\mathrm{O}} = 0.21$,\n- Universal gas constant $R = 8.314462618 \\ \\mathrm{J/(mol \\, K)}$.\n\nTasks:\n1. Starting from the law of mass action and the definition of the Jacobian $J(y) = \\partial S/\\partial y$, derive the chemical Jacobian at the initial state where $C_{\\mathrm{O}}$ is treated as constant.\n2. Compute the eigenvalues of this Jacobian symbolically in terms of $k_{1}$, $k_{2}$, and $C_{\\mathrm{O}}$.\n3. Using linear stability for the explicit forward Euler method applied to the linearized system $\\dot{y} = J y$, determine the largest timestep $\\Delta t_{\\max}$ that guarantees stability of both eigenmodes during the early transient, expressing your result first in closed form and then numerically.\n4. Compute $C_{\\mathrm{O}}$ from the ideal-gas law via $C_{\\text{tot}} = p/(R T)$ and $C_{\\mathrm{O}} = X_{\\mathrm{O}} C_{\\text{tot}}$, and then evaluate the numerical value of $\\Delta t_{\\max}$.\n\nRound your final numerical answer for $\\Delta t_{\\max}$ to four significant figures and express it in seconds. The final answer must be a single real number.",
            "solution": "The problem asks for an analysis of the stability-limited timestep for an explicit time integration scheme applied to a simplified, stiff chemical kinetics model relevant to the pseudo-transient computation of a one-dimensional premixed flame. The analysis proceeds in four steps: deriving the chemical Jacobian, finding its eigenvalues, determining the symbolic stability constraint, and finally, calculating the numerical value of the maximum permissible timestep.\n\n**Step 1: Derivation of the Chemical Jacobian**\n\nThe system of ordinary differential equations (ODEs) governing the local, homogeneous kinetics is given by $\\frac{dy}{dt} = S(y)$, where the state vector $y$ and the source term $S(y)$ are defined as:\n$$\ny = \\begin{pmatrix} C_{\\mathrm{F}} \\\\ C_{\\mathrm{I}} \\end{pmatrix}\n$$\n$$\nS(y) = \\begin{pmatrix} S_1 \\\\ S_2 \\end{pmatrix} = \\begin{pmatrix} -k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} \\\\ k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}} \\end{pmatrix}\n$$\nThe problem specifies that the oxidizer concentration $C_{\\mathrm{O}}$ is treated as a constant. The chemical Jacobian matrix, $J$, is defined as the matrix of partial derivatives of the source term vector with respect to the state vector components:\n$$\nJ(y) = \\frac{\\partial S}{\\partial y} = \\begin{pmatrix} \\frac{\\partial S_1}{\\partial C_{\\mathrm{F}}}  \\frac{\\partial S_1}{\\partial C_{\\mathrm{I}}} \\\\ \\frac{\\partial S_2}{\\partial C_{\\mathrm{F}}}  \\frac{\\partial S_2}{\\partial C_{\\mathrm{I}}} \\end{pmatrix}\n$$\nWe compute each element of the Jacobian matrix:\n- $\\frac{\\partial S_1}{\\partial C_{\\mathrm{F}}} = \\frac{\\partial}{\\partial C_{\\mathrm{F}}} (-k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}) = -k_{1} C_{\\mathrm{O}}$\n- $\\frac{\\partial S_1}{\\partial C_{\\mathrm{I}}} = \\frac{\\partial}{\\partial C_{\\mathrm{I}}} (-k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}) = 0$\n- $\\frac{\\partial S_2}{\\partial C_{\\mathrm{F}}} = \\frac{\\partial}{\\partial C_{\\mathrm{F}}} (k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}}) = k_{1} C_{\\mathrm{O}}$\n- $\\frac{\\partial S_2}{\\partial C_{\\mathrm{I}}} = \\frac{\\partial}{\\partial C_{\\mathrm{I}}} (k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}}) = -k_{2}$\n\nAssembling these components gives the Jacobian matrix:\n$$\nJ = \\begin{pmatrix} -k_{1} C_{\\mathrm{O}}  0 \\\\ k_{1} C_{\\mathrm{O}}  -k_{2} \\end{pmatrix}\n$$\nSince the source term $S(y)$ is linear in the components of $y$ (because $C_{\\mathrm{O}}$ is constant), the Jacobian matrix $J$ is constant and does not depend on the state $y$. Therefore, this is the Jacobian at the initial state and for all subsequent times under the stated assumptions.\n\n**Step 2: Eigenvalues of the Jacobian**\n\nThe eigenvalues, $\\lambda$, of a matrix are the roots of the characteristic equation $\\det(J - \\lambda I) = 0$. However, the Jacobian matrix $J$ is a lower triangular matrix. A fundamental property of triangular matrices is that their eigenvalues are simply the entries on their main diagonal.\nTherefore, the eigenvalues of $J$ are:\n$$\n\\lambda_{1} = -k_{1} C_{\\mathrm{O}}\n$$\n$$\n\\lambda_{2} = -k_{2}\n$$\n\n**Step 3: Stability Limit for the Forward Euler Method**\n\nThe forward Euler method is an explicit time integration scheme given by $y^{n+1} = y^n + \\Delta t S(y^n)$. For a linear system $\\dot{y} = Jy$, this becomes $y^{n+1} = y^n + \\Delta t J y^n = (I + \\Delta t J)y^n$. For the numerical solution to remain stable, the eigenvalues of the amplification matrix $G = I + \\Delta t J$ must have a magnitude no greater than $1$. The eigenvalues of $G$ are $1 + \\Delta t \\lambda_i$, where $\\lambda_i$ are the eigenvalues of $J$.\nThe stability condition is therefore:\n$$\n|1 + \\Delta t \\lambda_i| \\le 1 \\quad \\text{for all } i\n$$\nIn our case, the rate constants $k_{1}$ and $k_{2}$ are positive, as is the concentration $C_{\\mathrm{O}}$. Thus, the eigenvalues $\\lambda_1 = -k_1 C_{\\mathrm{O}}$ and $\\lambda_2 = -k_2$ are both real and negative. For a real, negative eigenvalue $\\lambda$, the stability condition $|1 + \\Delta t \\lambda| \\le 1$ expands to:\n$$\n-1 \\le 1 + \\Delta t \\lambda \\le 1\n$$\nThe right side of the inequality, $1 + \\Delta t \\lambda \\le 1$, implies $\\Delta t \\lambda \\le 0$, which is always satisfied for $\\Delta t > 0$ and $\\lambda  0$.\nThe left side of the inequality, $-1 \\le 1 + \\Delta t \\lambda$, implies $-2 \\le \\Delta t \\lambda$, which can be rearranged to give the timestep constraint:\n$$\n\\Delta t \\le -\\frac{2}{\\lambda}\n$$\nTo ensure stability for the entire system, the timestep $\\Delta t$ must satisfy this condition for all eigenvalues. This means $\\Delta t$ must be smaller than the most restrictive limit:\n$$\n\\Delta t \\le \\min\\left(-\\frac{2}{\\lambda_1}, -\\frac{2}{\\lambda_2}\\right) = \\min\\left(\\frac{2}{k_{1} C_{\\mathrm{O}}}, \\frac{2}{k_{2}}\\right)\n$$\nThe largest possible timestep, $\\Delta t_{\\max}$, is the value that makes this an equality. This can be expressed using the maximum function in the denominator:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\max(k_{1} C_{\\mathrm{O}}, k_{2})}\n$$\nThis is the closed-form expression for the maximum stable timestep.\n\n**Step 4: Numerical Evaluation of the Timestep**\n\nTo find the numerical value of $\\Delta t_{\\max}$, we must first compute $C_{\\mathrm{O}}$. Assuming the mixture behaves as an ideal gas, the total molar concentration $C_{\\text{tot}}$ is given by the ideal gas law, $p = C_{\\text{tot}} R T$:\n$$\nC_{\\text{tot}} = \\frac{p}{RT}\n$$\nUsing the given values $p = 1.01325 \\times 10^{5} \\ \\mathrm{Pa}$, $R = 8.314462618 \\ \\mathrm{J/(mol \\, K)}$, and $T = 300 \\ \\mathrm{K}$:\n$$\nC_{\\text{tot}} = \\frac{1.01325 \\times 10^{5} \\ \\mathrm{Pa}}{(8.314462618 \\ \\mathrm{J/(mol \\, K)}) (300 \\ \\mathrm{K})} \\approx 40.6215 \\ \\mathrm{mol/m^3}\n$$\nThe oxidizer concentration $C_{\\mathrm{O}}$ is its mole fraction $X_{\\mathrm{O}}$ times the total concentration:\n$$\nC_{\\mathrm{O}} = X_{\\mathrm{O}} C_{\\text{tot}} = 0.21 \\times 40.6215 \\ \\mathrm{mol/m^3} \\approx 8.5305 \\ \\mathrm{mol/m^3}\n$$\nNow we evaluate the two terms in the denominator of the $\\Delta t_{\\max}$ expression:\n- The first term is $k_{1} C_{\\mathrm{O}}$. Given $k_{1} = 1.0 \\times 10^{4} \\ \\mathrm{m^{3}/(mol \\, s)}$:\n$$\nk_{1} C_{\\mathrm{O}} = (1.0 \\times 10^{4}) \\times 8.5305 \\ \\mathrm{s^{-1}} \\approx 8.5305 \\times 10^{4} \\ \\mathrm{s^{-1}}\n$$\n- The second term is $k_{2}$, given as $k_{2} = 2.0 \\times 10^{2} \\ \\mathrm{s^{-1}}$.\n\nComparing the two timescale-inverses:\n$$\n\\max(k_{1} C_{\\mathrm{O}}, k_{2}) = \\max(8.5305 \\times 10^{4}, 2.0 \\times 10^{2}) = 8.5305 \\times 10^{4} \\ \\mathrm{s^{-1}}\n$$\nThe fastest chemical process, the consumption of fuel, dictates the stability limit. We can now compute $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{2}{k_{1} C_{\\mathrm{O}}} = \\frac{2}{k_{1} X_{\\mathrm{O}} (p/RT)} = \\frac{2RT}{k_{1} X_{\\mathrm{O}} p}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2 \\times (8.314462618) \\times (300)}{(1.0 \\times 10^{4}) \\times (0.21) \\times (1.01325 \\times 10^{5})} \\ \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{4988.67757}{2.127825 \\times 10^{8}} \\ \\mathrm{s} \\approx 2.344550 \\times 10^{-5} \\ \\mathrm{s}\n$$\nRounding to four significant figures as requested:\n$$\n\\Delta t_{\\max} \\approx 2.345 \\times 10^{-5} \\ \\mathrm{s}\n$$\nThis extremely small timestep highlights the challenge of numerical stiffness in chemical kinetics, where explicit methods are severely constrained by the fastest reaction timescale, even if one is interested in phenomena occurring on much slower timescales.",
            "answer": "$$\\boxed{2.345 \\times 10^{-5}}$$"
        },
        {
            "introduction": "Having understood the numerical challenges posed by stiffness, we now move to implementation. This practice  guides you through building a time-dependent solver for the steady 1D flamelet equations, a cornerstone model in turbulent combustion. You will implement a semi-implicit numerical scheme—treating the stiff diffusion term implicitly for stability while handling the nonlinear reaction term explicitly for simplicity—a common and effective strategy in computational combustion. This hands-on coding experience will solidify your understanding of how to translate the governing partial differential equations into a functioning numerical tool.",
            "id": "4073136",
            "problem": "You are asked to construct a time-dependent computational procedure to recover steady one-dimensional flamelet solutions under a fixed scalar dissipation rate. The governing description is based on conservation of species and energy in the mixture fraction coordinate, assuming unity Lewis number and constant properties. The objective is to integrate the unsteady flamelet equations until a steady state is reached and then report quantitative characteristics of the steady profiles for several scalar dissipation rates.\n\nStart from the following fundamental base:\n- Species conservation in a one-dimensional coordinate with diffusion and reaction: for each reacting species with mass fraction $Y$, $$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial \\zeta^2} + S_Y,$$ where $D$ is an effective diffusivity and $S_Y$ is the chemical source term.\n- Energy conservation with heat conduction and heat release: for temperature $T$, $$\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial \\zeta^2} + S_T,$$ where $S_T$ is the heat release source term.\n- In the flamelet coordinate with unity Lewis number, the effective diffusion coefficient is governed by the scalar dissipation rate $\\chi$, yielding $D = \\chi/2$.\n\nAssume a single-step irreversible reaction converting fuel to product using oxygen: $$F + O \\rightarrow P,$$ with an Arrhenius-like rate modeled by an activation temperature. Under this model,\n- Species and temperature equations are\n$$\\frac{\\partial Y_F}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_F}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_O}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_O}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_P}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_P}{\\partial \\zeta^2} + \\omega,$$\n$$\\frac{\\partial T}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 T}{\\partial \\zeta^2} + H \\,\\omega,$$\nwhere $\\omega$ is the reaction rate and $H$ is the effective heat release per unit mass divided by specific heat capacity, with units of Kelvin.\n- Use the following reaction rate model:\n$$\\omega(\\zeta,t) = k_0 \\,\\exp\\!\\left(-\\frac{\\Theta}{T(\\zeta,t)}\\right)\\, Y_F(\\zeta,t)\\, Y_O(\\zeta,t),$$\nwhere $k_0$ is a pre-exponential factor with units of inverse seconds and $\\Theta$ is the activation temperature in Kelvin.\n\nImpose Dirichlet boundary conditions corresponding to pure streams at the ends of the mixture fraction domain:\n- At $\\zeta = 0$: $Y_F = Y_{F,0}$, $Y_O = 0$, $Y_P = 0$, $T = T_0$.\n- At $\\zeta = 1$: $Y_F = 0$, $Y_O = Y_{O,1}$, $Y_P = 0$, $T = T_1$.\nInitialize the fields with a non-reacting linear mixing profile:\n$$Y_F(\\zeta,0) = Y_{F,0}\\,(1-\\zeta), \\quad Y_O(\\zeta,0) = Y_{O,1}\\,\\zeta, \\quad Y_P(\\zeta,0)=0, \\quad T(\\zeta,0) = T_0.$$\n\nDiscretize the spatial domain $\\zeta \\in [0,1]$ into a uniform grid of $N$ points. Time integrate the equations until the solution reaches steady state using a numerically stable approach: treat diffusion implicitly with backward Euler and the reaction source term explicitly. For the implicit discrete diffusion operator, use the standard second-order centered approximation of $\\partial^2/\\partial \\zeta^2$ with Dirichlet boundary conditions, yielding a tridiagonal linear system at each time step for interior points. For each variable $u \\in \\{Y_F,Y_O,Y_P,T\\}$ at interior index $j$, the semi-implicit time discretization at time step $n \\to n+1$ is\n$$(1 + 2r)\\,u_j^{n+1} - r\\,u_{j-1}^{n+1} - r\\,u_{j+1}^{n+1} = u_j^n + \\Delta t\\,S_u^n + r\\,u_{\\text{left}}^{n+1}\\,\\delta_{j,1} + r\\,u_{\\text{right}}^{n+1}\\,\\delta_{j,M},$$\nwhere $r = \\Delta t\\,(\\chi/2)/\\Delta \\zeta^2$, $M$ is the index of the last interior point, $\\delta_{j,k}$ is the Kronecker delta, and $u_{\\text{left}}$ and $u_{\\text{right}}$ are boundary values at $\\zeta=0$ and $\\zeta=1$ respectively. The explicit source terms are $S_{Y_F}^n = -\\omega^n$, $S_{Y_O}^n = -\\omega^n$, $S_{Y_P}^n = +\\omega^n$, $S_T^n = H\\,\\omega^n$ evaluated using $Y_F^n$, $Y_O^n$, and $T^n$.\n\nUse the following parameter values with physical units specified:\n- Scalar dissipation rate $\\chi$ (in seconds$^{-1}$) will vary by test case.\n- Pre-exponential factor $k_0 = 500$ (in seconds$^{-1}$), activation temperature $\\Theta = 2000$ (in Kelvin), heat release parameter $H = 1500$ (in Kelvin).\n- Boundary conditions: $Y_{F,0} = 0.8$ (dimensionless mass fraction), $Y_{O,1} = 0.21$ (dimensionless mass fraction), $T_0 = 300$ (in Kelvin), $T_1 = 300$ (in Kelvin).\n- Spatial grid size $N = 128$ (dimensionless count), uniform spacing $\\Delta \\zeta = 1/(N-1)$; time step $\\Delta t = 0.002$ (in seconds).\n- Convergence criteria: declare steady state when the maximum absolute change between successive time steps satisfies $\\max\\{\\lVert Y_F^{n+1}-Y_F^n\\rVert_\\infty,\\lVert Y_O^{n+1}-Y_O^n\\rVert_\\infty,\\lVert Y_P^{n+1}-Y_P^n\\rVert_\\infty\\}  10^{-8}$ and $\\lVert T^{n+1}-T^n\\rVert_\\infty  10^{-6}$, or a maximum of $6000$ time steps is reached, whichever comes first.\n\nTest Suite:\nEvaluate the program for the following scalar dissipation rates (in seconds$^{-1}$):\n- Case $1$: $\\chi = 0.5$ (low dissipation, happy path).\n- Case $2$: $\\chi = 10.0$ (moderate dissipation).\n- Case $3$: $\\chi = 80.0$ (high dissipation, near-extinction behavior).\n\nFor each case, after convergence, compute the following three outputs:\n- The maximum temperature $T_{\\max}$ (in Kelvin), rounded to three decimal places.\n- The location $\\zeta_{\\max T}$ of the maximum temperature within $[0,1]$, rounded to three decimal places.\n- The integral of the product mass fraction over the domain, $\\int_0^1 Y_P(\\zeta)\\,d\\zeta$ (dimensionless), computed by the trapezoidal rule and rounded to three decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n$$[T_{\\max}^{(1)}, \\zeta_{\\max T}^{(1)}, I_P^{(1)}, T_{\\max}^{(2)}, \\zeta_{\\max T}^{(2)}, I_P^{(2)}, T_{\\max}^{(3)}, \\zeta_{\\max T}^{(3)}, I_P^{(3)}],$$\nwhere superscript $(k)$ denotes Case $k$ in the test suite. Express $T_{\\max}$ in Kelvin, $\\zeta_{\\max T}$ dimensionless, and $I_P$ dimensionless. No other text should be printed.",
            "solution": "The derivation begins with conservation laws tailored to the mixture fraction coordinate under unity Lewis number, which ties the diffusion of all scalars to the scalar dissipation rate. In a one-dimensional coordinate $\\zeta$ for the flamelet description, the effective diffusion coefficient is $D = \\chi/2$, where $\\chi$ is the scalar dissipation rate with units of inverse seconds. The conservation of a species mass fraction $Y$ is\n$$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial \\zeta^2} + S_Y,$$\nand the conservation of temperature $T$ is\n$$\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial \\zeta^2} + S_T,$$\nwhere $S_Y$ and $S_T$ represent source terms from chemical reaction and heat release, respectively. For a single-step reaction $F + O \\rightarrow P$ with an Arrhenius-like rate represented through an activation temperature, the reaction rate is modeled as\n$$\\omega(\\zeta,t) = k_0 \\,\\exp\\!\\left(-\\frac{\\Theta}{T(\\zeta,t)}\\right)\\, Y_F(\\zeta,t)\\, Y_O(\\zeta,t),$$\nwith $k_0$ a pre-exponential factor and $\\Theta$ an activation temperature. Under unity Lewis number and constant properties, the species and energy equations become\n$$\\frac{\\partial Y_F}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_F}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_O}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_O}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_P}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_P}{\\partial \\zeta^2} + \\omega,$$\n$$\\frac{\\partial T}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 T}{\\partial \\zeta^2} + H \\,\\omega,$$\nwhere $H = Q/c_p$ is the effective temperature rise per unit reaction progress, with $Q$ the heat release per unit mass of fuel consumed and $c_p$ the specific heat capacity.\n\nBoundary conditions consistent with the flamelet problem under counterflow mixing are imposed as Dirichlet conditions:\n- At $\\zeta = 0$ (fuel side): $Y_F = Y_{F,0}$, $Y_O = 0$, $Y_P = 0$, $T = T_0$.\n- At $\\zeta = 1$ (oxidizer side): $Y_F = 0$, $Y_O = Y_{O,1}$, $Y_P = 0$, $T = T_1$.\nThese represent pure streams entering each end. The initial condition is a non-reacting mixing profile with linear interpolation:\n$$Y_F(\\zeta,0) = Y_{F,0}\\,(1-\\zeta),\\quad Y_O(\\zeta,0) = Y_{O,1}\\,\\zeta,\\quad Y_P(\\zeta,0)=0,\\quad T(\\zeta,0)=T_0.$$\n\nTo compute the steady solution via time integration, we discretize $\\zeta \\in [0,1]$ with $N$ uniformly spaced points, spacing $\\Delta \\zeta = 1/(N-1)$, and employ a time step $\\Delta t$. The diffusion operator is approximated with a second-order centered finite difference for the second derivative. For interior points $j = 1,\\dots,N-2$, the spatial discretization of $\\partial^2 u/\\partial \\zeta^2$ for a generic field $u$ is\n$$\\left.\\frac{\\partial^2 u}{\\partial \\zeta^2}\\right|_j \\approx \\frac{u_{j-1} - 2 u_j + u_{j+1}}{\\Delta \\zeta^2}.$$\nWe treat diffusion implicitly to ensure stability at large $\\chi$, and treat the reaction source terms explicitly to avoid solving nonlinear systems. The backward Euler scheme with explicit source yields, for interior point $j$,\n$$(1 + 2r)\\,u_j^{n+1} - r\\,u_{j-1}^{n+1} - r\\,u_{j+1}^{n+1} = u_j^n + \\Delta t\\,S_u^n,$$\nwhere\n$$r = \\frac{\\Delta t}{\\Delta \\zeta^2}\\frac{\\chi}{2}.$$\nDirichlet boundary conditions enter the interior equations at the first and last interior points by shifting known boundary values to the right-hand side:\n$$(1 + 2r)\\,u_1^{n+1} - r\\,u_0^{n+1} - r\\,u_2^{n+1} = u_1^n + \\Delta t\\,S_u^n \\quad\\Rightarrow\\quad (1 + 2r)\\,u_1^{n+1} - r\\,u_2^{n+1} = u_1^n + \\Delta t\\,S_u^n + r\\,u_{\\text{left}},$$\n$$(1 + 2r)\\,u_{M}^{n+1} - r\\,u_{M-1}^{n+1} - r\\,u_{M+1}^{n+1} = u_{M}^n + \\Delta t\\,S_u^n \\quad\\Rightarrow\\quad (1 + 2r)\\,u_{M}^{n+1} - r\\,u_{M-1}^{n+1} = u_{M}^n + \\Delta t\\,S_u^n + r\\,u_{\\text{right}},$$\nwhere $M = N-2$ is the last interior index, $u_{\\text{left}}$ and $u_{\\text{right}}$ are the Dirichlet boundary values at $\\zeta=0$ and $\\zeta=1$ respectively, and $u_0^{n+1} = u_{\\text{left}}$, $u_{N-1}^{n+1} = u_{\\text{right}}$.\n\nThis yields a tridiagonal linear system for each field $u \\in \\{Y_F, Y_O, Y_P, T\\}$ at each time step:\n$$\n\\begin{bmatrix}\n1+2r  -r  0  \\cdots  0 \\\\\n-r  1+2r  -r  \\cdots  0 \\\\\n0  -r  1+2r  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  -r \\\\\n0  0  0  -r  1+2r\n\\end{bmatrix}\n\\begin{bmatrix}\nu_1^{n+1} \\\\ u_2^{n+1} \\\\ u_3^{n+1} \\\\ \\vdots \\\\ u_{M}^{n+1}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nu_1^n + \\Delta t\\,S_{u,1}^n + r\\,u_{\\text{left}} \\\\\nu_2^n + \\Delta t\\,S_{u,2}^n \\\\\nu_3^n + \\Delta t\\,S_{u,3}^n \\\\\n\\vdots \\\\\nu_{M}^n + \\Delta t\\,S_{u,M}^n + r\\,u_{\\text{right}}\n\\end{bmatrix}.\n$$\nBecause the coefficient matrix does not change within a given case (fixed $\\chi$, $\\Delta t$, $\\Delta \\zeta$), a standard Thomas algorithm for tridiagonal systems is efficient and stable.\n\nThe reaction sources are computed explicitly at time level $n$ using\n$$\\omega_j^n = k_0 \\exp\\!\\left(-\\frac{\\Theta}{T_j^n}\\right) Y_{F,j}^n Y_{O,j}^n,$$\nand the sources for each field are\n$$S_{Y_F,j}^n = - \\omega_j^n,\\quad S_{Y_O,j}^n = - \\omega_j^n,\\quad S_{Y_P,j}^n = + \\omega_j^n,\\quad S_{T,j}^n = H\\, \\omega_j^n.$$\nAfter solving the diffusion-implicit update, enforce the Dirichlet boundary conditions exactly:\n$$Y_F^{n+1}(0) = Y_{F,0},\\quad Y_F^{n+1}(1) = 0,\\quad Y_O^{n+1}(0) = 0,\\quad Y_O^{n+1}(1) = Y_{O,1},$$\n$$Y_P^{n+1}(0) = 0,\\quad Y_P^{n+1}(1) = 0,\\quad T^{n+1}(0) = T_0,\\quad T^{n+1}(1) = T_1.$$\nClip mass fractions to the physically admissible range to avoid minor negative excursions from explicit reaction updates:\n$$Y_F^{n+1} \\leftarrow \\max(Y_F^{n+1}, 0),\\quad Y_O^{n+1} \\leftarrow \\max(Y_O^{n+1}, 0),\\quad Y_P^{n+1} \\leftarrow \\max(Y_P^{n+1}, 0).$$\n\nConvergence to steady state is assessed by monitoring the maximum absolute change per time step across interior points:\n$$\\Delta_Y^n = \\max\\left\\{ \\lVert Y_F^{n+1}-Y_F^n \\rVert_\\infty,\\, \\lVert Y_O^{n+1}-Y_O^n \\rVert_\\infty,\\, \\lVert Y_P^{n+1}-Y_P^n \\rVert_\\infty \\right\\},$$\n$$\\Delta_T^n = \\lVert T^{n+1}-T^n \\rVert_\\infty.$$\nStop when $\\Delta_Y^n  10^{-8}$ and $\\Delta_T^n  10^{-6}$, or the iteration count reaches the prescribed maximum.\n\nAfter reaching steady state for each test-case value of $\\chi$, compute the requested outputs:\n- The maximum temperature $T_{\\max}$ is\n$$T_{\\max} = \\max_j T_j,$$\nand its location (in the continuous coordinate approximated by the grid point) is\n$$\\zeta_{\\max T} = \\zeta_{\\arg\\max_j T_j}.$$\n- The integral of the product mass fraction over the domain uses the trapezoidal rule\n$$I_P = \\int_0^1 Y_P(\\zeta)\\,d\\zeta \\approx \\sum_{j=0}^{N-2} \\frac{Y_{P,j} + Y_{P,j+1}}{2} \\,\\Delta \\zeta.$$\n\nFinally, aggregate the results across the three test cases in the order specified. All temperatures are in Kelvin, scalar dissipation rates are in inverse seconds, and mass fractions are dimensionless. The program prints the single required line with the nine numbers in the exact order\n$$[T_{\\max}^{(1)}, \\zeta_{\\max T}^{(1)}, I_P^{(1)}, T_{\\max}^{(2)}, \\zeta_{\\max T}^{(2)}, I_P^{(2)}, T_{\\max}^{(3)}, \\zeta_{\\max T}^{(3)}, I_P^{(3)}],$$\nrounded to three decimal places as instructed.",
            "answer": "```python\nimport numpy as np\n\ndef thomas_algorithm(lower, diag, upper, rhs):\n    \"\"\"\n    Solve a tridiagonal system Ax = rhs where A has 'lower' subdiagonal,\n    'diag' main diagonal, and 'upper' superdiagonal using the Thomas algorithm.\n    All arrays are 1D; lengths: len(diag)=n, len(lower)=n-1, len(upper)=n-1.\n    \"\"\"\n    n = len(diag)\n    # Copy to avoid modifying inputs\n    c_prime = np.empty(n-1, dtype=float)\n    d_prime = np.empty(n, dtype=float)\n\n    # Forward sweep\n    c_prime[0] = upper[0] / diag[0]\n    d_prime[0] = rhs[0] / diag[0]\n    for i in range(1, n-1):\n        denom = diag[i] - lower[i-1] * c_prime[i-1]\n        c_prime[i] = upper[i] / denom\n        d_prime[i] = (rhs[i] - lower[i-1] * d_prime[i-1]) / denom\n    denom_last = diag[n-1] - lower[n-2] * c_prime[n-2]\n    d_prime[n-1] = (rhs[n-1] - lower[n-2] * d_prime[n-2]) / denom_last\n\n    # Back substitution\n    x = np.empty(n, dtype=float)\n    x[n-1] = d_prime[n-1]\n    for i in range(n-2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i+1]\n    return x\n\ndef run_case(chi, N=128, dt=0.002, max_steps=6000,\n             YF_left=0.8, YO_right=0.21, T_left=300.0, T_right=300.0,\n             Theta=2000.0, k0=500.0, H=1500.0,\n             tol_species=1e-8, tol_temp=1e-6):\n    \"\"\"\n    Integrate the unsteady flamelet equations to steady state for a given chi.\n    Returns Tmax (K), zeta_at_Tmax, integral of YP over domain.\n    \"\"\"\n    # Grid\n    zeta = np.linspace(0.0, 1.0, N)\n    dz = zeta[1] - zeta[0]\n    # Initial conditions: non-reacting mixing\n    YF = YF_left * (1.0 - zeta)\n    YO = YO_right * zeta\n    YP = np.zeros_like(zeta)\n    T = np.full_like(zeta, T_left)\n\n    # Dirichlet boundary values\n    YF_bL, YF_bR = YF_left, 0.0\n    YO_bL, YO_bR = 0.0, YO_right\n    YP_bL, YP_bR = 0.0, 0.0\n    T_bL, T_bR = T_left, T_right\n\n    # Precompute tridiagonal coefficients for implicit diffusion\n    r = dt * (chi / 2.0) / (dz * dz)\n    M = N - 2  # number of interior points\n    if M = 0:\n        raise ValueError(\"Grid must have at least 3 points.\")\n    lower = np.full(M-1, -r, dtype=float)\n    upper = np.full(M-1, -r, dtype=float)\n    diag = np.full(M, 1.0 + 2.0 * r, dtype=float)\n\n    # Time integration loop\n    for step in range(max_steps):\n        # Compute reaction rate omega (explicit) using current fields\n        # Prevent division by zero or overflow in exp by clipping temperature\n        T_eff = np.clip(T, 1e-6, 1e6)\n        omega = k0 * np.exp(-Theta / T_eff) * YF * YO\n\n        # Prepare RHS for each field (interior points only)\n        # Index mapping: interior j corresponds to full index i = j+1\n        # YF\n        rhs_YF = YF[1:-1] + dt * (-omega[1:-1])\n        rhs_YF[0] += r * YF_bL\n        rhs_YF[-1] += r * YF_bR\n        # YO\n        rhs_YO = YO[1:-1] + dt * (-omega[1:-1])\n        rhs_YO[0] += r * YO_bL\n        rhs_YO[-1] += r * YO_bR\n        # YP\n        rhs_YP = YP[1:-1] + dt * (+omega[1:-1])\n        rhs_YP[0] += r * YP_bL\n        rhs_YP[-1] += r * YP_bR\n        # T\n        rhs_T = T[1:-1] + dt * (H * omega[1:-1])\n        rhs_T[0] += r * T_bL\n        rhs_T[-1] += r * T_bR\n\n        # Solve tridiagonal systems\n        YF_new_interior = thomas_algorithm(lower, diag, upper, rhs_YF)\n        YO_new_interior = thomas_algorithm(lower, diag, upper, rhs_YO)\n        YP_new_interior = thomas_algorithm(lower, diag, upper, rhs_YP)\n        T_new_interior = thomas_algorithm(lower, diag, upper, rhs_T)\n\n        # Assemble full fields and enforce boundaries\n        YF_new = np.empty_like(YF)\n        YO_new = np.empty_like(YO)\n        YP_new = np.empty_like(YP)\n        T_new = np.empty_like(T)\n\n        YF_new[0] = YF_bL\n        YF_new[-1] = YF_bR\n        YF_new[1:-1] = YF_new_interior\n\n        YO_new[0] = YO_bL\n        YO_new[-1] = YO_bR\n        YO_new[1:-1] = YO_new_interior\n\n        YP_new[0] = YP_bL\n        YP_new[-1] = YP_bR\n        YP_new[1:-1] = YP_new_interior\n\n        T_new[0] = T_bL\n        T_new[-1] = T_bR\n        T_new[1:-1] = T_new_interior\n\n        # Clip mass fractions to [0, 1] for numerical sanity\n        YF_new = np.clip(YF_new, 0.0, 1.0)\n        YO_new = np.clip(YO_new, 0.0, 1.0)\n        YP_new = np.clip(YP_new, 0.0, 1.0)\n\n        # Check convergence\n        delta_species = max(\n            np.max(np.abs(YF_new - YF)),\n            np.max(np.abs(YO_new - YO)),\n            np.max(np.abs(YP_new - YP))\n        )\n        delta_temp = np.max(np.abs(T_new - T))\n        # Update fields\n        YF, YO, YP, T = YF_new, YO_new, YP_new, T_new\n\n        if delta_species  tol_species and delta_temp  tol_temp:\n            break\n\n    # Compute requested outputs\n    Tmax = float(np.max(T))\n    idx_max = int(np.argmax(T))\n    zeta_at_Tmax = float(zeta[idx_max])\n    IP = float(np.trapz(YP, zeta))\n\n    # Round as specified\n    Tmax = round(Tmax, 3)\n    zeta_at_Tmax = round(zeta_at_Tmax, 3)\n    IP = round(IP, 3)\n\n    return Tmax, zeta_at_Tmax, IP\n\ndef solve():\n    # Define the test cases from the problem statement (chi values in s^-1).\n    test_cases = [\n        0.5,   # Case 1: low dissipation\n        10.0,  # Case 2: moderate dissipation\n        80.0   # Case 3: high dissipation\n    ]\n\n    results = []\n    for chi in test_cases:\n        Tmax, zeta_max, IP = run_case(chi=chi)\n        results.extend([Tmax, zeta_max, IP])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A successful simulation is only as valuable as the accuracy of the physical quantities extracted from its results. This final practice  shifts our focus from numerical implementation to post-processing and physical interpretation. By applying a control-volume energy balance to a simulated flame with heat loss, you will learn how to derive a corrected estimate for a key physical parameter, the laminar burning velocity $S_L$. This exercise underscores the importance of using fundamental thermodynamic laws to account for non-ideal effects and avoid systematic errors in analyzing computational data.",
            "id": "4073117",
            "problem": "A one-dimensional, planar, premixed flame in a long channel is advanced in time until its statistics are steady in the flame-fixed frame. To estimate the laminar burning velocity $S_L$, a control volume that fully encloses the flame zone is constructed, and the energy balance is applied using time-averaged quantities over a sufficiently long window. In the presence of slight heat losses to the walls, directly equating total chemical heat release to the convected sensible enthalpy rise biases $S_L$. Use a control-volume energy balance over the flame zone to correct this bias.\n\nAssume the following scientifically consistent model and measurements:\n- The upstream mixture is uniform with density $\\rho_u = 1.20 \\ \\mathrm{kg/m^3}$ and temperature $T_u = 300 \\ \\mathrm{K}$.\n- The downstream, post-flame mixture temperature measured within the control volume is $T_b = 2050 \\ \\mathrm{K}$.\n- The mixture-averaged constant-pressure specific heat can be approximated over the temperature rise by $c_p = 1100 \\ \\mathrm{J/(kg \\cdot K)}$.\n- The time-averaged total chemical heat release rate integrated over the control volume, normalized by cross-sectional area, is $\\dot{q}''_{\\mathrm{chem}} = 1.00 \\times 10^{6} \\ \\mathrm{W/m^2}$.\n- The time-averaged total heat loss to the walls (net outward heat flux), normalized by cross-sectional area, is $\\dot{q}''_{\\mathrm{loss}} = 7.60 \\times 10^{4} \\ \\mathrm{W/m^2}$.\n\nStarting from the integral form of the First Law of Thermodynamics for a control volume and invoking one-dimensional steady transport in the flame-fixed frame, derive the corrected laminar burning velocity $S_L$ that accounts for the heat loss. Express $S_L$ in $\\mathrm{m/s}$ and round your final numerical answer to four significant figures.",
            "solution": "The problem requires deriving the laminar burning velocity $S_L$ from an energy balance on a control volume enclosing a steady flame, accounting for heat loss.\n\n**1. Integral Energy Balance**\n\nWe apply the First Law of Thermodynamics for a steady-state, steady-flow open system (a control volume):\n$$\n\\dot{E}_{\\text{in}} - \\dot{E}_{\\text{out}} = 0\n$$\nThe rate of energy transport includes mass flow and heat transfer. For a control volume with one inlet (unburned, subscript $u$) and one outlet (burned, subscript $b$), the balance is:\n$$\n\\dot{Q}_{cv} + \\dot{m} h_u = \\dot{m} h_b\n$$\nHere, $\\dot{Q}_{cv}$ is the net rate of heat added to the control volume, $\\dot{m}$ is the constant mass flow rate ($\\dot{m}_{in} = \\dot{m}_{out}$), and $h$ is the specific enthalpy. We neglect changes in kinetic and potential energy as they are small compared to the chemical energy release.\n\n**2. Decomposing the Heat Transfer**\n\nThe net heat transfer, $\\dot{Q}_{cv}$, consists of heat generated by chemical reactions within the volume, $\\dot{Q}_{\\text{chem}}$, and heat lost from the volume to the surroundings (walls), $\\dot{Q}_{\\text{loss}}$. Since $\\dot{Q}_{\\text{loss}}$ is defined as a loss (outward flux), it enters the balance with a negative sign:\n$$\n\\dot{Q}_{cv} = \\dot{Q}_{\\text{chem}} - \\dot{Q}_{\\text{loss}}\n$$\nSubstituting this into the energy balance gives:\n$$\n\\dot{Q}_{\\text{chem}} - \\dot{Q}_{\\text{loss}} = \\dot{m} (h_b - h_u)\n$$\n\n**3. Relating Terms to Flame Properties**\n\nThe problem provides quantities normalized by the channel's cross-sectional area, $A$. We define the heat fluxes (rate per unit area) as $\\dot{q}''_{\\text{chem}} = \\dot{Q}_{\\text{chem}}/A$ and $\\dot{q}''_{\\text{loss}} = \\dot{Q}_{\\text{loss}}/A$. Dividing the energy equation by $A$:\n$$\n\\dot{q}''_{\\text{chem}} - \\dot{q}''_{\\text{loss}} = \\frac{\\dot{m}}{A} (h_b - h_u)\n$$\nThe mass flow rate per unit area, $\\dot{m}/A$, is the mass flux. In a flame-fixed frame, the unburned gas enters the control volume at the laminar burning velocity, $S_L$. Therefore, the mass flux is:\n$$\n\\frac{\\dot{m}}{A} = \\rho_u S_L\n$$\nThe change in specific enthalpy, for a gas with an average constant-pressure specific heat $c_p$, is:\n$$\nh_b - h_u = c_p (T_b - T_u)\n$$\nSubstituting these relations into the energy balance:\n$$\n\\dot{q}''_{\\text{chem}} - \\dot{q}''_{\\text{loss}} = \\rho_u S_L c_p (T_b - T_u)\n$$\n\n**4. Solving for the Laminar Burning Velocity ($S_L$)**\n\nWe can now algebraically solve for $S_L$:\n$$\nS_L = \\frac{\\dot{q}''_{\\text{chem}} - \\dot{q}''_{\\text{loss}}}{\\rho_u c_p (T_b - T_u)}\n$$\nThis is the corrected expression for the laminar burning velocity that accounts for heat loss.\n\n**5. Numerical Calculation**\n\nWe substitute the given values into the derived formula:\n-   $\\dot{q}''_{\\text{chem}} = 1.00 \\times 10^{6} \\ \\mathrm{W/m^2}$\n-   $\\dot{q}''_{\\text{loss}} = 7.60 \\times 10^{4} \\ \\mathrm{W/m^2}$\n-   $\\rho_u = 1.20 \\ \\mathrm{kg/m^3}$\n-   $c_p = 1100 \\ \\mathrm{J/(kg \\cdot K)}$\n-   $T_b = 2050 \\ \\mathrm{K}$\n-   $T_u = 300 \\ \\mathrm{K}$\n\nFirst, calculate the terms in the numerator and denominator:\n-   Net heat flux: $\\Delta \\dot{q}'' = \\dot{q}''_{\\text{chem}} - \\dot{q}''_{\\text{loss}} = 1,000,000 - 76,000 = 924,000 \\ \\mathrm{W/m^2}$.\n-   Temperature difference: $\\Delta T = T_b - T_u = 2050 - 300 = 1750 \\ \\mathrm{K}$.\n-   Denominator product: $\\rho_u c_p \\Delta T = (1.20 \\ \\mathrm{kg/m^3}) \\times (1100 \\ \\mathrm{J/(kg \\cdot K)}) \\times (1750 \\ \\mathrm{K}) = 2,310,000 \\ \\mathrm{J/m^3}$.\n\nFinally, compute $S_L$:\n$$\nS_L = \\frac{924,000 \\ \\mathrm{W/m^2}}{2,310,000 \\ \\mathrm{J/m^3}} = \\frac{924,000 \\ \\mathrm{J/(s \\cdot m^2)}}{2,310,000 \\ \\mathrm{J/m^3}} = 0.4 \\ \\mathrm{m/s}\n$$\nRounding to four significant figures as requested, the result is $0.4000 \\ \\mathrm{m/s}$.",
            "answer": "$$\n\\boxed{0.4000}\n$$"
        }
    ]
}