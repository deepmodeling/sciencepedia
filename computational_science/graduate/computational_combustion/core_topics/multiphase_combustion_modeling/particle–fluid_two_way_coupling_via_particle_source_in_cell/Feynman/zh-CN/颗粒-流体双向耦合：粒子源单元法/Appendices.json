{
    "hands_on_practices": [
        {
            "introduction": "在流体-颗粒双向耦合的计算中，第一步是量化相间的物理交换。本练习将引导您计算单个欧拉网格单元内由一组离散粒子产生的动量源项。这个计算基于基本的空气动力学阻力公式，是理解粒子源项网格 (Particle-Source-In-Cell, PSI-CELL) 方法中“源项”物理本质的基础 。",
            "id": "4048800",
            "problem": "考虑在一个欧拉控制体内，分散的液态燃料液滴相与气相载体之间的双向动量耦合，该过程通过单元内质点源法（PSC）处理，其中粒子力被聚合并作为气体动量方程中的源项。气相载体的密度为$\\rho$，动力粘度为$\\mu$，其在单元内的局部速度是均匀的，等于$\\mathbf{u}$。单元体积$V_c$内有$N$个相同的球形液滴，其直径为$d_p$，瞬时速度为$\\mathbf{v}_p$。假设液滴上的重力、附加质量力、Basset历史力、升力和压力梯度力与空气动力阻力相比可以忽略不计，并且液滴足够小，在动量耦合中可被视为点粒子。\n\n使用标准的稳态阻力公式，其中球体的阻力系数关联式由Schiller–Naumann关联式给出：\n$$\nC_D(\\mathrm{Re}_p) \\;=\\; \\frac{24}{\\mathrm{Re}_p}\\left(1 + 0.15\\,\\mathrm{Re}_p^{0.687}\\right),\n$$\n其中颗粒雷诺数为\n$$\n\\mathrm{Re}_p \\;=\\; \\frac{\\rho\\,|\\mathbf{u}-\\mathbf{v}_p|\\,d_p}{\\mu}.\n$$\n单个液滴上的瞬时阻力模型为\n$$\n\\mathbf{F}_d \\;=\\; \\frac{1}{2}\\,\\rho\\,A_p\\,C_D(\\mathrm{Re}_p)\\,|\\mathbf{u}-\\mathbf{v}_p|\\,(\\mathbf{u}-\\mathbf{v}_p),\n$$\n其中$A_p = \\pi d_p^2/4$是球体的投影面积。在PSC框架中，添加到气相动量方程中的动量源是粒子施加于流体的力的总和，除以单位体积。根据牛顿第三定律，该源等于单元内聚合的粒子阻力的负值，并用单元体积进行归一化：\n$$\n\\mathbf{S}_{\\mathbf{u}} \\;=\\; -\\frac{1}{V_c}\\sum_{i=1}^{N}\\mathbf{F}_{d,i}.\n$$\n\n给定以下数据，计算单元动量源$\\mathbf{S}_{\\mathbf{u}}$的三个笛卡尔分量：\n- $N = 100$,\n- $d_p = 30\\times 10^{-6}\\;\\mathrm{m}$,\n- $\\rho = 1.2\\;\\mathrm{kg/m^3}$,\n- $\\mu = 1.8\\times 10^{-5}\\;\\mathrm{Pa\\cdot s}$,\n- $\\mathbf{u} = (2.0,\\;0,\\;0)\\;\\mathrm{m/s}$,\n- $\\mathbf{v}_p = (1.0,\\;0,\\;0)\\;\\mathrm{m/s}$,\n- $V_c = 1.0\\times 10^{-6}\\;\\mathrm{m^3}$.\n\n以三分量行向量的形式表示你的最终答案$\\mathbf{S}_{\\mathbf{u}}$，单位为$\\mathrm{N/m^3}$，并将每个分量四舍五入至四位有效数字。",
            "solution": "用户要求我扮演一名理工科教授来解决所给出的问题。我的首要职责是验证问题陈述的有效性。\n\n### 问题验证\n\n#### 步骤1：提取给定条件\n问题陈述中提供的数据、定义和条件如下：\n-   液滴数量：$N = 100$\n-   液滴直径：$d_p = 30 \\times 10^{-6}\\;\\mathrm{m}$\n-   气体密度：$\\rho = 1.2\\;\\mathrm{kg/m^3}$\n-   气体动力粘度：$\\mu = 1.8 \\times 10^{-5}\\;\\mathrm{Pa\\cdot s}$\n-   气体速度矢量：$\\mathbf{u} = (2.0,\\;0,\\;0)\\;\\mathrm{m/s}$\n-   液滴速度矢量：$\\mathbf{v}_p = (1.0,\\;0,\\;0)\\;\\mathrm{m/s}$\n-   控制体积：$V_c = 1.0 \\times 10^{-6}\\;\\mathrm{m^3}$\n-   颗粒雷诺数定义：$\\mathrm{Re}_p = \\frac{\\rho\\,|\\mathbf{u}-\\mathbf{v}_p|\\,d_p}{\\mu}$\n-   Schiller–Naumann阻力系数关联式：$C_D(\\mathrm{Re}_p) = \\frac{24}{\\mathrm{Re}_p}\\left(1 + 0.15\\,\\mathrm{Re}_p^{0.687}\\right)$\n-   液滴投影面积：$A_p = \\pi d_p^2/4$\n-   单个液滴上的瞬时阻力：$\\mathbf{F}_d = \\frac{1}{2}\\,\\rho\\,A_p\\,C_D(\\mathrm{Re}_p)\\,|\\mathbf{u}-\\mathbf{v}_p|\\,(\\mathbf{u}-\\mathbf{v}_p)$\n-   气相动量源项：$\\mathbf{S}_{\\mathbf{u}} = -\\frac{1}{V_c}\\sum_{i=1}^{N}\\mathbf{F}_{d,i}$\n-   假设：液滴是相同的球体。\n-   假设：重力、附加质量力、Basset历史力、升力和压力梯度力可以忽略不计。\n\n#### 步骤2：使用提取的条件进行验证\n根据验证标准对问题进行评估。\n-   **科学依据：** 该问题牢固地植根于多相计算流体动力学的原理。单元内质点源法（PSC）、双向动量耦合的概念、空气动力阻力的定义、颗粒雷诺数以及Schiller-Naumann阻力系数关联式都是该领域标准且成熟的表述形式。\n-   **适定性：** 提供了所有必要的参数和本构关系，以计算动量源项$\\mathbf{S}_{\\mathbf{u}}$的唯一值。指令清晰明确。\n-   **客观性：** 问题使用精确的定量语言陈述。没有主观或基于观点的元素。\n-   **不完整或矛盾的设置：** 问题是自洽的。计算所需的所有变量都已定义并赋值。单位在国际单位制（SI）内是一致的，量纲分析也证实了方程的有效性。例如，$\\mathrm{Re}_p$是无量纲的：$\\frac{(\\mathrm{kg/m^3}) (\\mathrm{m/s}) (\\mathrm{m})}{\\mathrm{Pa \\cdot s}} = \\frac{\\mathrm{kg/(m \\cdot s)}}{\\mathrm{kg/(m \\cdot s)}} = 1$。力$\\mathbf{F}_d$的单位是牛顿：$(\\mathrm{kg/m^3}) (\\mathrm{m^2}) (\\mathrm{m/s})^2 = \\mathrm{kg \\cdot m/s^2} = \\mathrm{N}$。源项$\\mathbf{S}_{\\mathbf{u}}$的单位是力每单位体积：$\\mathrm{N/m^3}$。\n-   **不切实际或不可行：** 所提供的物理参数对于模拟诸如内燃机或熔炉中的燃料喷雾等现象是现实的，在这些现象中，微小的液滴与热气体相互作用。\n\n#### 步骤3：结论与行动\n问题陈述是科学合理、适定且完整的。因此，它被判定为**有效**。我将继续进行求解。\n\n### 解题过程\n\n目标是计算在一个控制体积内，添加到气相动量方程中的动量源项$\\mathbf{S}_{\\mathbf{u}}$。源项被定义为粒子施加于流体的力的总和，除以单位体积。\n\n源项由下式给出：\n$$\n\\mathbf{S}_{\\mathbf{u}} = -\\frac{1}{V_c}\\sum_{i=1}^{N}\\mathbf{F}_{d,i}\n$$\n问题陈述指出，有$N$个相同的液滴，它们都具有相同的瞬时速度$\\mathbf{v}_p$。因此，所有$N$个液滴的阻力$\\mathbf{F}_{d,i}$是相同的。求和可以简化为：\n$$\n\\mathbf{S}_{\\mathbf{u}} = -\\frac{N}{V_c}\\mathbf{F}_d\n$$\n单个液滴上的阻力$\\mathbf{F}_d$由下式给出：\n$$\n\\mathbf{F}_d = \\frac{1}{2}\\,\\rho\\,A_p\\,C_D(\\mathrm{Re}_p)\\,|\\mathbf{u}-\\mathbf{v}_p|\\,(\\mathbf{u}-\\mathbf{v}_p)\n$$\n计算按以下步骤进行：\n\n1.  **计算相对速度矢量及其大小。**\n    气体速度为$\\mathbf{u} = (2.0, 0, 0)\\;\\mathrm{m/s}$，液滴速度为$\\mathbf{v}_p = (1.0, 0, 0)\\;\\mathrm{m/s}$。\n    相对速度矢量为：\n    $$\n    \\mathbf{u} - \\mathbf{v}_p = (2.0 - 1.0, 0 - 0, 0 - 0) = (1.0, 0, 0)\\;\\mathrm{m/s}\n    $$\n    相对速度的大小为：\n    $$\n    |\\mathbf{u} - \\mathbf{v}_p| = \\sqrt{1.0^2 + 0^2 + 0^2} = 1.0\\;\\mathrm{m/s}\n    $$\n\n2.  **计算颗粒雷诺数$\\mathrm{Re}_p$。**\n    使用给定值$\\rho = 1.2\\;\\mathrm{kg/m^3}$，$d_p = 30 \\times 10^{-6}\\;\\mathrm{m}$，$\\mu = 1.8 \\times 10^{-5}\\;\\mathrm{Pa\\cdot s}$，以及$|\\mathbf{u} - \\mathbf{v}_p| = 1.0\\;\\mathrm{m/s}$：\n    $$\n    \\mathrm{Re}_p = \\frac{\\rho\\,|\\mathbf{u}-\\mathbf{v}_p|\\,d_p}{\\mu} = \\frac{(1.2\\;\\mathrm{kg/m^3})(1.0\\;\\mathrm{m/s})(30 \\times 10^{-6}\\;\\mathrm{m})}{1.8 \\times 10^{-5}\\;\\mathrm{Pa\\cdot s}} = \\frac{3.6 \\times 10^{-5}}{1.8 \\times 10^{-5}} = 2.0\n    $$\n    颗粒雷诺数恰好为$2.0$。\n\n3.  **计算阻力系数$C_D$。**\n    使用Schiller–Naumann关联式，其中$\\mathrm{Re}_p = 2.0$：\n    $$\n    C_D(\\mathrm{Re}_p=2.0) = \\frac{24}{2.0}\\left(1 + 0.15 \\times (2.0)^{0.687}\\right)\n    $$\n    首先，计算幂次项：\n    $$\n    (2.0)^{0.687} \\approx 1.61036\n    $$\n    现在，将此值代入$C_D$方程：\n    $$\n    C_D = 12 \\left(1 + 0.15 \\times 1.61036\\right) = 12 \\left(1 + 0.241554\\right) = 12(1.241554) \\approx 14.8986\n    $$\n\n4.  **计算液滴的投影面积$A_p$。**\n    液滴是直径为$d_p = 30 \\times 10^{-6}\\;\\mathrm{m}$的球体。\n    $$\n    A_p = \\frac{\\pi d_p^2}{4} = \\frac{\\pi (30 \\times 10^{-6}\\;\\mathrm{m})^2}{4} = \\frac{\\pi (900 \\times 10^{-12}\\;\\mathrm{m^2})}{4} = 225\\pi \\times 10^{-12}\\;\\mathrm{m^2}\n    $$\n    $A_p \\approx 7.06858 \\times 10^{-10}\\;\\mathrm{m^2}$。\n\n5.  **计算阻力矢量$\\mathbf{F}_d$。**\n    将计算出的值代入阻力方程：\n    $$\n    \\mathbf{F}_d = \\frac{1}{2}(1.2)(7.06858 \\times 10^{-10})(14.8986)(1.0)(1.0, 0, 0)\\;\\mathrm{N}\n    $$\n    $$\n    \\mathbf{F}_d = (0.6)(7.06858 \\times 10^{-10})(14.8986)(1.0, 0, 0)\\;\\mathrm{N}\n    $$\n    力的大小为：\n    $$\n    |\\mathbf{F}_d| \\approx 6.31834 \\times 10^{-9}\\;\\mathrm{N}\n    $$\n    力矢量为：\n    $$\n    \\mathbf{F}_d \\approx (6.31834 \\times 10^{-9}, 0, 0)\\;\\mathrm{N}\n    $$\n\n6.  **计算单元动量源$\\mathbf{S}_{\\mathbf{u}}$。**\n    使用$N = 100$和$V_c = 1.0 \\times 10^{-6}\\;\\mathrm{m^3}$：\n    $$\n    \\mathbf{S}_{\\mathbf{u}} = -\\frac{N}{V_c}\\mathbf{F}_d = -\\frac{100}{1.0 \\times 10^{-6}\\;\\mathrm{m^3}} (6.31834 \\times 10^{-9}, 0, 0)\\;\\mathrm{N}\n    $$\n    $$\n    \\mathbf{S}_{\\mathbf{u}} = -(10^8\\;\\mathrm{m^{-3}})(6.31834 \\times 10^{-9}, 0, 0)\\;\\mathrm{N}\n    $$\n    $$\n    \\mathbf{S}_{\\mathbf{u}} = -(0.631834, 0, 0)\\;\\mathrm{N/m^3}\n    $$\n\n7.  **最终答案的格式化。**\n    问题要求将最终答案的每个分量四舍五入至四位有效数字。\n    -   x分量为$-0.631834$。前四位有效数字是$6, 3, 1, 8$。第五位数字是$3$，因此向下舍入。该分量变为$-0.6318$。\n    -   y分量和z分量恰好为$0$。它们不需要四舍五入。\n    最终矢量为$\\mathbf{S}_{\\mathbf{u}} = (-0.6318, 0, 0)\\;\\mathrm{N/m^3}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.6318 & 0 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在确定了单个粒子的源项贡献之后，我们必须将这个拉格朗日性质的量精确地分配到欧拉网格上。本练习将演示如何从守恒和一致性等基本约束出发，构建和应用“云中网格”(Cloud-in-Cell, CIC) 权函数方案 。这个过程是连接拉格朗日粒子和欧拉网格的关键桥梁，确保了动量、质量和能量在两相间的传递既准确又守恒。",
            "id": "4048825",
            "problem": "在计算燃烧学的颗粒-流体双向耦合中，颗粒在网格中的源项 (PSI-C) 方法通过使用紧支集核函数的狄拉克 delta 分布的正则化近似，将颗粒的源项贡献分布到欧拉网格上。考虑一个间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的均匀、结构化的笛卡尔网格，并假设单个颗粒位于位置 $\\mathbf{x}_{p} = (x_{p}, y_{p}, z_{p})$，该颗粒所在网格单元的左下后顶点坐标为 $(x_{0}, y_{0}, z_{0})$。该分布需要满足以下源于守恒性和一致性的基本约束：(i) 在最近的 8 个顶点上具有紧支集，(ii) 正值性，(iii) 单位分解，以及 (iv) 在均匀网格上精确再现常数场和线性场（仿射完备性）。\n\n从这些约束出发，通过将核函数构建为沿每个坐标方向的一维分段线性函数的张量积，来构造用于最近 8 个顶点的云在网格 (CIC) 形函数（权重）。设局部无量纲坐标定义为 $\\xi = (x_{p} - x_{0}) / \\Delta x$、$\\eta = (y_{p} - y_{0}) / \\Delta y$ 和 $\\zeta = (z_{p} - z_{0}) / \\Delta z$，其中 $\\xi, \\eta, \\zeta \\in [0,1]$。将 8 个顶点权重 $\\{w_{mnp}\\}$（其中 $m, n, p \\in \\{0,1\\}$ 为从 $(x_{0}, y_{0}, z_{0})$ 开始在 $x$、$y$ 和 $z$ 方向上的偏移索引）用 $\\xi$、$\\eta$ 和 $\\zeta$ 显式表示。\n\n然后，对于 $\\Delta x = \\Delta y = \\Delta z = 1$ 且颗粒位于 $(x_{p}, y_{p}, z_{p}) = (x_{0} + 0.3 \\Delta x, y_{0} + 0.7 \\Delta y, z_{0} + 0.4 \\Delta z)$ 的特定情况，按字典序 $(m, n, p) = (0,0,0), (1,0,0), (0,1,0), (0,0,1), (1,1,0), (1,0,1), (0,1,1), (1,1,1)$ 计算 8 个权重的数值。将最终数值四舍五入到四位有效数字。将最终答案以包含八个权重的单行矩阵形式报告。由于权重是无量纲的，因此不包括单位。",
            "solution": "问题要求基于一组基本约束，为笛卡尔网格单元内的一个颗粒构建云在网格 (CIC) 形函数（权重）。然后，需要针对特定的颗粒位置计算这些权重。\n\n问题陈述的验证过程如下。\n已知条件：\n一个间距为 $\\Delta x$、$\\Delta y$、$\\Delta z$ 的均匀、结构化的笛卡尔网格。\n一个位于位置 $\\mathbf{x}_{p} = (x_{p}, y_{p}, z_{p})$ 的颗粒。\n网格单元的左下后顶点位于 $(x_{0}, y_{0}, z_{0})$。\n用于分布颗粒源项的核函数必须满足：(i) 在最近的 8 个顶点上的紧支集，(ii) 正值性，(iii) 单位分解，以及 (iv) 精确再现常数场和线性场（仿射完备性）。\n核函数将构建为一维分段线性函数的张量积。\n局部无量纲坐标为 $\\xi = (x_{p} - x_{0}) / \\Delta x$、$\\eta = (y_{p} - y_{0}) / \\Delta y$ 和 $\\zeta = (z_{p} - z_{0}) / \\Delta z$，其中 $\\xi, \\eta, \\zeta \\in [0,1]$。\n权重表示为 $\\{w_{mnp}\\}$，其中 $m, n, p \\in \\{0,1\\}$。\n给定一个特定情况：$\\Delta x = \\Delta y = \\Delta z = 1$ 且 $(x_{p}, y_{p}, z_{p}) = (x_{0} + 0.3 \\Delta x, y_{0} + 0.7 \\Delta y, z_{0} + 0.4 \\Delta z)$。\n8个权重的数值需要按字典序 $(m, n, p) = (0,0,0), (1,0,0), (0,1,0), (0,0,1), (1,1,0), (1,0,1), (0,1,1), (1,1,1)$ 计算并四舍五入到四位有效数字。\n\n验证：\n该问题具有科学依据，提法恰当且客观。颗粒在网格中的源项 (PSI-C) 方法和云在网格 (CIC) 格式是计算流体力学中处理含颗粒流的标准工具。所列出的约束——正值性、单位分解和仿射完备性（一阶矩守恒）——是此类二阶精度插值格式的定义属性。问题是自洽的，提供了所有必要信息。不存在矛盾、歧义或事实错误。因此，该问题被认定为有效。\n\n解题推导：\n构建过程从一维开始，沿着 $x$ 坐标。局部坐标为 $\\xi \\in [0,1]$。一维单元段的两个顶点位于局部坐标 $0$ 和 $1$ 处。设相应的权重为 $W_{0}(\\xi)$ 和 $W_{1}(\\xi)$。简化到一维的约束是：\n$1$. 正值性：$W_m(\\xi) \\ge 0$，对于 $m \\in \\{0,1\\}$ 和 $\\xi \\in [0,1]$。\n$2$. 单位分解（零阶矩守恒）：$W_{0}(\\xi) + W_{1}(\\xi) = 1$。这确保了常数场能够被精确再现，从而保持守恒量。\n$3$. 仿射完备性（一阶矩守恒）：顶点位置的加权平均值必须等于颗粒的位置。在局部坐标中，即为 $0 \\cdot W_{0}(\\xi) + 1 \\cdot W_{1}(\\xi) = \\xi$。\n\n从一阶矩条件，我们直接得到 $W_{1}(\\xi) = \\xi$。\n将此代入单位分解条件得到 $W_{0}(\\xi) + \\xi = 1$，从而得出 $W_{0}(\\xi) = 1 - \\xi$。\n这些函数 $W_{0}(\\xi) = 1 - \\xi$ 和 $W_{1}(\\xi) = \\xi$ 是分段线性的，并且对于 $\\xi \\in [0,1]$ 满足正值性约束。\n\n问题陈述指出，三维核函数是一维函数的张量积。在距离单元原点局部欧几里得坐标偏移为 $(m, n, p)$ 的顶点处的权重 $w_{mnp}$（其中 $m, n, p \\in \\{0,1\\}$），由每个方向相应的一维权重之积给出：\n$$w_{mnp}(\\xi, \\eta, \\zeta) = W_m(\\xi) W_n(\\eta) W_p(\\zeta)$$\n与 $x$ 方向类似，$y$ 和 $z$ 方向的一维权重为：\n$W_0(\\eta) = 1-\\eta$, $W_1(\\eta) = \\eta$\n$W_0(\\zeta) = 1-\\zeta$, $W_1(\\zeta) = \\zeta$\n\n因此，立方体单元八个顶点的权重由三线性插值函数给出：\n$w_{000} = W_0(\\xi)W_0(\\eta)W_0(\\zeta) = (1-\\xi)(1-\\eta)(1-\\zeta)$\n$w_{100} = W_1(\\xi)W_0(\\eta)W_0(\\zeta) = \\xi(1-\\eta)(1-\\zeta)$\n$w_{010} = W_0(\\xi)W_1(\\eta)W_0(\\zeta) = (1-\\xi)\\eta(1-\\zeta)$\n$w_{001} = W_0(\\xi)W_0(\\eta)W_1(\\zeta) = (1-\\xi)(1-\\eta)\\zeta$\n$w_{110} = W_1(\\xi)W_1(\\eta)W_0(\\zeta) = \\xi\\eta(1-\\zeta)$\n$w_{101} = W_1(\\xi)W_0(\\eta)W_1(\\zeta) = \\xi(1-\\eta)\\zeta$\n$w_{011} = W_0(\\xi)W_1(\\eta)W_1(\\zeta) = (1-\\xi)\\eta\\zeta$\n$w_{111} = W_1(\\xi)W_1(\\eta)W_1(\\zeta) = \\xi\\eta\\zeta$\n\n这些就是用局部坐标 $\\xi$、$\\eta$ 和 $\\zeta$ 表示的八个 CIC 权重表达式。\n\n接下来，我们计算所提供特定情况的数值。颗粒位置由 $(x_{p}, y_{p}, z_{p}) = (x_{0} + 0.3 \\Delta x, y_{0} + 0.7 \\Delta y, z_{0} + 0.4 \\Delta z)$ 给出。局部坐标计算如下：\n$\\xi = \\frac{x_{p} - x_{0}}{\\Delta x} = \\frac{(x_{0} + 0.3 \\Delta x) - x_{0}}{\\Delta x} = 0.3$\n$\\eta = \\frac{y_{p} - y_{0}}{\\Delta y} = \\frac{(y_{0} + 0.7 \\Delta y) - y_{0}}{\\Delta y} = 0.7$\n$\\zeta = \\frac{z_{p} - z_{0}}{\\Delta z} = \\frac{(z_{0} + 0.4 \\Delta z) - z_{0}}{\\Delta z} = 0.4$\n\n我们还可以计算互补值：\n$1-\\xi = 1 - 0.3 = 0.7$\n$1-\\eta = 1 - 0.7 = 0.3$\n$1-\\zeta = 1 - 0.4 = 0.6$\n\n现在，我们将这些数值代入权重表达式。权重将按照问题陈述中给出的特定顺序列出：\n$1.$ 对于 $(m,n,p)=(0,0,0)$: $w_{000} = (0.7)(0.3)(0.6) = 0.126$\n$2.$ 对于 $(m,n,p)=(1,0,0)$: $w_{100} = (0.3)(0.3)(0.6) = 0.054$\n$3.$ 对于 $(m,n,p)=(0,1,0)$: $w_{010} = (0.7)(0.7)(0.6) = 0.294$\n$4.$ 对于 $(m,n,p)=(0,0,1)$: $w_{001} = (0.7)(0.3)(0.4) = 0.084$\n$5.$ 对于 $(m,n,p)=(1,1,0)$: $w_{110} = (0.3)(0.7)(0.6) = 0.126$\n$6.$ 对于 $(m,n,p)=(1,0,1)$: $w_{101} = (0.3)(0.3)(0.4) = 0.036$\n$7.$ 对于 $(m,n,p)=(0,1,1)$: $w_{011} = (0.7)(0.7)(0.4) = 0.196$\n$8.$ 对于 $(m,n,p)=(1,1,1)$: $w_{111} = (0.3)(0.7)(0.4) = 0.084$\n\n一个验证步骤是把所有权重求和，由于单位分解约束，其总和必须等于 $1$：\n$\\sum w = 0.126 + 0.054 + 0.294 + 0.084 + 0.126 + 0.036 + 0.196 + 0.084 = 1.000$。计算正确。\n\n问题要求将结果四舍五入到四位有效数字。由于结果精确到三位小数，我们添加尾随的零以满足此要求。\n$w_{000} = 0.1260$\n$w_{100} = 0.05400$\n$w_{010} = 0.2940$\n$w_{001} = 0.08400$\n$w_{110} = 0.1260$\n$w_{101} = 0.03600$\n$w_{011} = 0.1960$\n$w_{111} = 0.08400$\n\n将这八个值组合成一个单行矩阵作为最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1260 & 0.05400 & 0.2940 & 0.08400 & 0.1260 & 0.03600 & 0.1960 & 0.08400\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这个练习将前面的概念综合成一个完整的、含时间演化的仿真。通过在一个一维域中实现单个炭黑粒子与周围气体之间的双向能量交换，您将从头开始构建一个可用的 PSI-CELL 程序 。本练习不仅涵盖了源项计算和网格分配，还特别强调了验证数值方案能量守恒特性的重要性，这是开发可靠计算流体力学工具的关键一步。",
            "id": "4048795",
            "problem": "您的任务是为在气体中经历瞬态升温的单个炭颗粒实现一维粒子-源-网格 (PSI) 耦合，该耦合需与计算燃烧学中的能量守恒相一致。其基本控制原理是颗粒和气体控制体上的能量平衡。从基于热力学第一定律、牛顿冷却定律以及温度作为内能度量的定义所推导出的颗粒能量平衡开始：\n- 颗粒遵循 $m_p c_{p,p} \\frac{d T_p}{dt} = h A_p \\left(T_g(x_p,t) - T_p(t)\\right)$，其中 $m_p$ 是颗粒质量，$c_{p,p}$ 是颗粒比热容，$T_p$ 是颗粒温度，$h$ 是对流换热系数，$A_p$ 是颗粒表面积，$T_g(x_p,t)$ 是在颗粒位置 $x_p$ 处插值得到的气体温度。\n- 气体遵循每个体积为 $V_i$、密度为 $\\rho_g$、比热容为 $c_{p,g}$ 的网格单元 $i$ 的有限体积能量平衡：颗粒向周围网格单元施加一个分布式功率汇 $S_h(t) = h A_p \\left(T_g(x_p,t) - T_p(t)\\right)$。在一维空间中使用粒子-源-网格 (PSI) 方法和线性形函数，该汇通过满足 $\\sum_i w_i = 1$ 的权重 $\\{w_i\\}$进行划分，从而得到网格单元 $i$ 的温度演化方程 $\\frac{d T_{g,i}}{dt} = -\\frac{w_i S_h(t)}{\\rho_g c_{p,g} V_i}$。\n\n实现一个长度为 $L$ 的均匀一维域，包含 $N$ 个等尺寸的有限体积网格单元。设网格单元宽度为 $dx = L/N$，网格单元中心位于 $x_i = (i+\\frac{1}{2}) dx$，其中 $i = 0, 1, \\ldots, N-1$。假设横截面积为单位面积，因此 $V_i = dx$。气体属性 $\\rho_g$ 和 $c_{p,g}$ 在空间和时间上是恒定的。颗粒固定在位置 $x_p$ 处，不移动，并且仅通过对流与气体进行热交换。\n\n使用大小为 $\\Delta t$ 的时间步，进行 $n_{\\text{steps}}$ 次显式一阶时间积分。在每个时间步中：\n- 使用线性权重，根据最近的两个网格单元中心插值计算颗粒位置的气体温度。权重定义如下：\n  - 如果 $x_p \\le x_0$，则设置 $w_0 = 1$ 且所有其他权重 $w_i = 0$。\n  - 如果 $x_p \\ge x_{N-1}$，则设置 $w_{N-1} = 1$ 且所有其他权重 $w_i = 0$。\n  - 否则，找到满足 $x_j \\le x_p \\le x_{j+1}$ 的 $j$，并设置 $w_j = \\frac{x_{j+1}-x_p}{x_{j+1}-x_j}$ 和 $w_{j+1} = \\frac{x_p - x_j}{x_{j+1}-x_j}$，所有其他权重 $w_i = 0$。\n- 计算 $S_h(t) = h A_p \\left(T_g^{\\text{interp}} - T_p\\right)$，其中 $T_g^{\\text{interp}} = \\sum_i w_i T_{g,i}$。\n- 通过 $T_p \\leftarrow T_p + \\Delta t \\frac{S_h}{m_p c_{p,p}}$ 更新颗粒温度 $T_p$。\n- 通过 $T_{g,i} \\leftarrow T_{g,i} - \\Delta t \\frac{w_i S_h}{\\rho_g c_{p,g} V_i}$ 更新每个受影响的气体网格单元的温度。\n\n在所有时间步结束后，计算能量守恒残差\n$$\nE_{\\text{res}} = \\left| m_p c_{p,p} \\left(T_p^{\\text{end}} - T_p^{0}\\right) + \\sum_{i=0}^{N-1} \\rho_g c_{p,g} V_i \\left(T_{g,i}^{\\text{end}} - T_{g,i}^{0}\\right) \\right|,\n$$\n如果离散化是一致且守恒的，该值应接近于 $0$。\n\n您的程序必须为以下参数集测试套件执行上述过程。所有量都必须使用指定的单位进行处理，所有温度必须以开尔文 ($\\mathrm{K}$) 表示，长度以米 ($\\mathrm{m}$) 表示，时间以秒 ($\\mathrm{s}$) 表示，密度以千克每立方米 ($\\mathrm{kg}/\\mathrm{m}^3$) 表示，比热以焦耳每千克每开尔文 ($\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$) 表示，面积以平方米 ($\\mathrm{m}^2$) 表示，对流系数以瓦特每平方米每开尔文 ($\\mathrm{W}/(\\mathrm{m}^2\\,\\mathrm{K})$) 表示。\n\n测试套件：\n- 案例 1 (一般情况)：$N = 10$，$L = 0.1\\,\\mathrm{m}$，$\\rho_g = 1.2\\,\\mathrm{kg}/\\mathrm{m}^3$，$c_{p,g} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$m_p = 1.0\\times 10^{-6}\\,\\mathrm{kg}$，$c_{p,p} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$A_p = 1.0\\times 10^{-6}\\,\\mathrm{m}^2$，$h = 100\\,\\mathrm{W}/(\\mathrm{m}^2\\,\\mathrm{K})$，$\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$，$n_{\\text{steps}} = 400$，$x_p = 0.045\\,\\mathrm{m}$，$T_p^0 = 300\\,\\mathrm{K}$，$T_{g,i}^0 = 1200\\,\\mathrm{K}$ (对于所有 $i$)。\n- 案例 2 (边界映射)：$N = 10$，$L = 0.1\\,\\mathrm{m}$，$\\rho_g = 1.2\\,\\mathrm{kg}/\\mathrm{m}^3$，$c_{p,g} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$m_p = 1.0\\times 10^{-6}\\,\\mathrm{kg}$，$c_{p,p} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$A_p = 1.0\\times 10^{-6}\\,\\mathrm{m}^2$，$h = 100\\,\\mathrm{W}/(\\mathrm{m}^2\\,\\mathrm{K})$，$\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$，$n_{\\text{steps}} = 400$，$x_p = 0.001\\,\\mathrm{m}$，$T_p^0 = 300\\,\\mathrm{K}$，$T_{g,i}^0 = 1200\\,\\mathrm{K}$ (对于所有 $i$)。\n- 案例 3 (零耦合边缘情况)：$N = 10$，$L = 0.1\\,\\mathrm{m}$，$\\rho_g = 1.2\\,\\mathrm{kg}/\\mathrm{m}^3$，$c_{p,g} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$m_p = 1.0\\times 10^{-6}\\,\\mathrm{kg}$，$c_{p,p} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$A_p = 1.0\\times 10^{-6}\\,\\mathrm{m}^2$，$h = 0\\,\\mathrm{W}/(\\mathrm{m}^2\\,\\mathrm{K})$，$\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$，$n_{\\text{steps}} = 200$，$x_p = 0.055\\,\\mathrm{m}$，$T_p^0 = 300\\,\\mathrm{K}$，$T_{g,i}^0 = 1200\\,\\mathrm{K}$ (对于所有 $i$)。\n- 案例 4 (强双向耦合)：$N = 10$，$L = 0.1\\,\\mathrm{m}$，$\\rho_g = 1.2\\,\\mathrm{kg}/\\mathrm{m}^3$，$c_{p,g} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$m_p = 5.0\\times 10^{-7}\\,\\mathrm{kg}$，$c_{p,p} = 1000\\,\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$A_p = 1.0\\times 10^{-6}\\,\\mathrm{m}^2$，$h = 5000\\,\\mathrm{W}/(\\mathrm{m}^2\\,\\mathrm{K})$，$\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$，$n_{\\text{steps}} = 5000$，$x_p = 0.049\\,\\mathrm{m}$，$T_p^0 = 300\\,\\mathrm{K}$，$T_{g,i}^0 = 1000\\,\\mathrm{K}$ (对于所有 $i$)。\n\n对于每个案例，计算：\n- 最终颗粒温度 $T_p^{\\text{end}}$ (单位为 $\\mathrm{K}$)，四舍五入到三位小数。\n- 能量守恒残差 $E_{\\text{res}}$ (单位为 $\\mathrm{J}$)，四舍五入到六位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是每个案例的子列表 $[T_p^{\\text{end}}, E_{\\text{res}}]$，且不含空格。例如：$[[300.000,0.000000],[\\ldots],[\\ldots],[\\ldots]]$。",
            "solution": "问题陈述已经过严格审查，并被确定为 **有效的**。它在科学上基于热力学和计算流体力学的原理，具有完整且一致的定义和参数，是一个良构的问题，并提出了一个可形式化的任务。该问题要求实现用于颗粒-流体传热的标准粒子-源-网格 (PSI) 方法，这是计算燃烧学中的一种常用技术。\n\n解决方案将遵循问题中概述的原理和算法步骤来开发。\n\n**1. 科学原理与模型构建**\n\n问题的核心在于由单个颗粒和周围气体组成的耦合系统的能量守恒。\n\n- **颗粒能量平衡**：颗粒的温度 $T_p$ 根据热力学第一定律演变，其内能的变化与来自气体的热传递相平衡。使用牛顿冷却定律描述对流换热，可表示为：\n$$m_p c_{p,p} \\frac{d T_p}{dt} = h A_p \\left(T_g(x_p,t) - T_p(t)\\right)$$\n此处，$m_p$ 是颗粒质量，$c_{p,p}$ 是其比热，$A_p$ 是其表面积，$h$ 是对流换热系数，$T_g(x_p,t)$ 是颗粒位置 $x_p$ 处的气体温度。右侧项 $S_h(t) = h A_p \\left(T_g(x_p,t) - T_p(t)\\right)$ 代表交换的功率（传热速率）。\n\n- **气体能量平衡**：气相被离散为有限体积网格单元。对于每个网格单元 $i$，其内能的变化是由于它与颗粒交换的热量。来自颗粒的功率 $S_h(t)$ 作为体积源/汇项分布到周围的气体网格单元。网格单元 $i$ 的温度 $T_{g,i}$ 的演变由下式给出：\n$$\\rho_g c_{p,g} V_i \\frac{d T_{g,i}}{dt} = -w_i S_h(t)$$\n其中 $\\rho_g, c_{p,g}$ 分别是气体密度和比热，$V_i$ 是网格单元体积，$w_i$ 是来自 PSI 方法的权重因子，它将总源项 $S_h(t)$ 分配到各个网格单元。负号表示如果颗粒从气体中获得能量 ($S_h > 0$)，气体必须损失该能量。\n\n**2. 离散化与数值方案**\n\n- **空间离散化**：长度为 $L$ 的一维域被划分为 $N$ 个均匀网格单元。每个网格单元的宽度为 $dx = L/N$。存储网格单元属性（如温度 $T_{g,i}$）的位置，即网格单元中心，位于 $x_i = (i + 1/2)dx$，其中 $i=0, \\ldots, N-1$。对于单位横截面积，每个网格单元的体积为 $V_i = dx$。\n\n- **时间离散化**：使用一阶显式（前向欧拉）方法对时间上的控制性常微分方程 (ODEs) 进行积分。对于一个时间步 $\\Delta t$，温度从时间 $t^n$ 更新到 $t^{n+1} = t^n + \\Delta t$ 如下：\n$$T_p^{n+1} = T_p^n + \\Delta t \\frac{S_h^n}{m_p c_{p,p}}$$\n$$T_{g,i}^{n+1} = T_{g,i}^n - \\Delta t \\frac{w_i S_h^n}{\\rho_g c_{p,g} V_i}$$\n其中 $S_h^n$ 是使用时间 $t^n$ 的温度计算的源项。\n\n**3. 粒子-源-网格 (PSI) 耦合**\n\nPSI 方法提供了一种将拉格朗日粒子与欧拉网格进行守恒耦合的方式。在每个时间层，它包含两个主要步骤：\n\n- **插值（收集）**：计算传热速率需要颗粒连续位置 $x_p$ 处的气体温度，记为 $T_g^{\\text{interp}}$。这是通过使用线性形函数（权重）$\\{w_i\\}$从网格单元中心的离散温度 $T_{g,i}$ 插值得到的：\n$$T_g^{\\text{interp}} = \\sum_{i=0}^{N-1} w_i T_{g,i}$$\n权重是根据颗粒相对于最近的两个网格单元中心（例如 $x_j$ 和 $x_{j+1}$）的位置定义的。如果 $x_j \\le x_p \\le x_{j+1}$，则权重为 $w_j = (x_{j+1}-x_p)/dx$ 和 $w_{j+1} = (x_p-x_j)/dx$。对于超出网格单元中心范围的颗粒，定义了特殊处理。关键是，这种构建方式确保了 $\\sum_i w_i = 1$。\n\n- **分布（散播）**：计算出的点源 $S_h = h A_p (T_g^{\\text{interp}} - T_p)$ 必须分布回网格。使用相同的权重 $\\{w_i\\}$ 来划分源项，以确保一致性。网格单元 $i$ 的源项变为 $w_i S_h$。\n\n**4. 能量守恒**\n\n插值和分布使用相同的权重，保证了离散双向耦合方案是守恒的。在一个时间步内，颗粒的总能量变化为 $\\Delta E_p = m_p c_{p,p} (T_p^{n+1} - T_p^n) = \\Delta t S_h^n$。气体的总能量变化为 $\\Delta E_g = \\sum_i \\rho_g c_{p,g} V_i (T_{g,i}^{n+1} - T_{g,i}^n) = \\sum_i (-\\Delta t w_i S_h^n) = -\\Delta t S_h^n \\sum_i w_i$。由于 $\\sum_i w_i = 1$，系统的总能量变化为 $\\Delta E_{\\text{total}} = \\Delta E_p + \\Delta E_g = \\Delta t S_h^n - \\Delta t S_h^n = 0$。\n模拟将计算整个模拟时间内的累积能量残差：\n$$E_{\\text{res}} = \\left| \\Delta E_p^{\\text{total}} + \\Delta E_g^{\\text{total}} \\right| = \\left| m_p c_{p,p} (T_p^{\\text{end}} - T_p^0) + \\sum_{i=0}^{N-1} \\rho_g c_{p,g} V_i (T_{g,i}^{\\text{end}} - T_{g,i}^0) \\right|$$\n对于一个守恒的方案，这个值应该为零，但会受到浮点运算误差的影响。\n\n**5. 算法实现**\n\n对于每个指定的测试案例，执行以下过程：\n1.  初始化所有物理和数值参数，包括颗粒 ($T_p$) 和气体网格 ($T_g$) 的初始温度数组。存储初始温度用于最终的残差计算。\n2.  预先计算网格单元中心 ($x_i$) 和恒定的网格单元体积 ($V_i=dx$)。\n3.  根据静态颗粒位置 $x_p$ 确定非零插值权重 ($w_i$) 和相应的网格单元索引。\n4.  执行一个 $n_{\\text{steps}}$ 时间步的循环。在每个步骤中：\n    a. 在颗粒位置计算插值后的气体温度 $T_g^{\\text{interp}}$。\n    b. 计算热源项 $S_h$。\n    c. 使用前向欧拉步骤更新颗粒温度 $T_p$。\n    d. 使用前向欧拉步骤更新受影响的气体网格单元的温度 $T_{g,i}$。\n5.  循环结束后，计算颗粒总能量变化和气体总能量变化。\n6.  计算这些能量变化之和的绝对值，以求得能量守恒残差 $E_{\\text{res}}$。\n7.  存储最终颗粒温度 $T_p^{\\text{end}}$ 和残差 $E_{\\text{res}}$，并四舍五入到指定的精度。\n所有测试案例的最终结果随后被格式化为所需的输出字符串。",
            "answer": "```\n[[629.590,0.000000],[629.590,0.000000],[300.000,0.000000],[964.718,0.000000]]\n```"
        }
    ]
}