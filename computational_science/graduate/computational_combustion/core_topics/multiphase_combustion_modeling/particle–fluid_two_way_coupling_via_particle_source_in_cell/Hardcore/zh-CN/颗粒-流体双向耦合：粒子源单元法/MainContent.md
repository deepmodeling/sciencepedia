## 引言
在燃烧、喷雾和众多工业过程中，离散颗粒与周围连续流体之间的复杂相互作用决定了系统的宏观行为。精确预测这些[多相流](@entry_id:146480)动现象是现代工程设计和科学研究的核心挑战。一种高效的模拟策略是采用混合[欧拉-拉格朗日方法](@entry_id:1124678)，其中流体在固定的欧拉网格上求解，而数以百万计的颗粒则被单独追踪。然而，这种方法的关键难点在于如何精确且守恒地耦合这两个在数学和物理描述上截然不同的框架。

本文旨在系统性地阐释网格中颗粒源项法（Particle-Source-in-Cell, PSI-CELL），这是一种被广泛用于解决上述耦合问题的强大数值技术。我们将深入探讨该方法如何弥合离散颗粒与连续流场之间的鸿沟，实现两者间的双向信息交换。通过学习本文，您将掌握从基本物理原理到复杂工程应用的全过程。

在接下来的章节中，我们将首先在“原理与机制”中剖析PSI-CELL方法的核心思想，包括不同耦合机制的分类、守恒性原理以及质量、动量和能量源项的具体构建。随后，在“应用与跨学科连接”部分，我们将展示该方法在[计算燃烧学](@entry_id:1122776)等前沿领域的实际应用，探讨其如何与湍流模型、化学反应和边界条件等复杂物理相结合。最后，“动手实践”部分将提供具体的计算练习，帮助您将理论知识转化为实践技能。让我们从理解PSI-CELL方法的基本构件开始。

## 原理与机制

在燃烧等许多工程和自然现象中，离散的颗粒（如液滴、煤粉或烟尘）与周围的连续流体（气体）之间的相互作用至关重要。为了在计算上模拟这些多相系统，通常采用一种[混合方法](@entry_id:163463)，即流体相在[欧拉框架](@entry_id:749109)下求解，而颗粒相则在[拉格朗日框架](@entry_id:751113)下追踪。本章深入探讨了在这种混合框架下实现流体与颗粒[双向耦合](@entry_id:178809)的核心原理与机制，重点介绍一种强大而广泛使用的方法：网格中颗粒源项法（Particle-Source-in-Cell, PSI-CELL）。

### 耦合的基础：相互作用机制与分类

在颗粒-流体系统中，相互作用的强度和性质并非一成不变，而是取决于颗粒相的相对重要性。我们可以通过几个关键的无量纲参数来对不同的耦合机制进行分类，从而为选择合适的物理模型和数值方法提供指导。

首先，**[质量负载](@entry_id:751706)率**（mass loading ratio）$\phi_m$ 定义为特定控制体积内离散相的总质量与连续相质量之比。它量化了颗粒相在系统总质量中的占比。其次，**[体积分数](@entry_id:756566)**（volume fraction）$\epsilon_p$ 指的是颗粒占据的体积与总体积之比，它直接关系到颗粒之间的平均距离。

基于这些参数，我们可以区分以下几种主要的耦合机制 ：

1.  **[单向耦合](@entry_id:752919) (One-Way Coupling)**：当颗粒非常稀疏，[质量负载](@entry_id:751706)率极低时（即 $\phi_m \ll 1$），颗粒的存在对流体流场的影响可以忽略不计。在这种情况下，流体运动单方面地影响颗粒的轨迹（例如通过曳力），但颗粒的[反作用](@entry_id:203910)力小到可以被忽略。此时，颗粒被视为被动的“示踪物”。这种机制的另一个前提是颗粒[体积分数](@entry_id:756566)非常小（例如 $\epsilon_p \ll 10^{-3}$），以至于颗粒间的碰撞可以完全忽略。在燃烧应用中，火焰中生成的烟尘颗粒通常处于[单向耦合](@entry_id:752919)机制下，其体积分数极低（$\epsilon_p \sim 10^{-6}$）。

2.  **双向耦合 (Two-Way Coupling)**：当[质量负载](@entry_id:751706)率达到不可忽略的水平时（即 $\phi_m = \mathcal{O}(1)$），即使[体积分数](@entry_id:756566)仍然很小（$\epsilon_p \lesssim 10^{-3}$），颗粒相的集体效应也会显著改变流体的动量、能量和质量分布。此时，不仅流体作用于颗粒，颗粒的累积反作用力也同样作用于流体。这是一个双向的反馈回路。例如，液体燃料[喷雾燃烧](@entry_id:1132216)就是典型的[双向耦合](@entry_id:178809)问题。[液滴蒸发](@entry_id:748678)会改变局部气体组分和温度，而液滴与气体间的速度差产生的曳力会改变气相动量场。然而，由于体积分数仍然较低，液滴间的直接碰撞通常可以忽略不计。

3.  **四向耦合 (Four-Way Coupling)**：当颗粒浓度进一步增加，体积分数达到临界值（通常为 $\epsilon_p \gtrsim 10^{-3}$）时，颗粒间的碰撞变得频繁且重要。此时，除了流体-颗粒间的双向作用外，还必须考虑颗粒-颗粒间的相互作用（碰撞）。这种机制被称为四向耦合。浓相的煤粉燃烧或[流化床反应器](@entry_id:185877)是四向耦合的典型例子，其中颗粒碰撞是动量和能量传递的重要机制。

PSI-CELL 方法主要用于精确高效地模拟双向耦合现象，本章的讨论也将集中于此。

### PSI-CELL方法的核心思想

PSI-CELL方法是连接拉格朗日颗粒与欧拉网格的桥梁。其核心思想是，将离散颗粒对连续流体产生的物理效应——即质量、动量和能量的交换——表达为流体控制方程中的**体积源项**（volumetric source terms）。

想象一个在流体中运动的颗粒。它受到流体的曳力作用而减速。根据[牛顿第三定律](@entry_id:166652)，颗粒必然会对流体施加一个大小相等、方向相反的力。这个力是一个作用于颗粒所在位置的“点力”。然而，在离散的欧拉网格上，将这个力完全施加到单个网格点或单元上会导致严重的数值问题，例如当颗粒穿越网格边界时，源项会发生突变，从而产生非物理的振荡和噪声 。

为了解决这个问题，PSI-CELL引入了一个**分布[核函数](@entry_id:145324)**（distribution kernel）或**形函数**（shape function），通常记为 $W$。这个[核函数](@entry_id:145324)是一个空间分布函数，其作用是将位于 $\mathbf{x}_p$ 处的单个颗粒的点源贡献“平滑地”分布到其周围的欧拉网格节点上。对于一个通用[守恒量](@entry_id:161475) $\phi$（如动量或能量），其源项场 $S_{\phi}(\mathbf{x})$ 可以表示为所有颗粒贡献的总和 ：

$$
S_{\phi}(\mathbf{x}) = \sum_{p} s_{\phi,p} W(\mathbf{x} - \mathbf{x}_{p})
$$

其中，$s_{\phi,p}$ 是单个颗粒 $p$ 的总源项强度（例如，单位时间内传递的总能量），$W(\mathbf{x} - \mathbf{x}_{p})$ 是以颗粒位置 $\mathbf{x}_p$ 为中心的[核函数](@entry_id:145324)。这个公式优雅地将离散的拉格朗日信息转换为了连续的欧拉场。

### 守恒性原理：从颗粒到网格的精确映射

在[数值模拟](@entry_id:146043)中，严格遵守[质量、动量和能量守恒](@entry_id:1122905)定律至关重要。PSI-CELL方法通过对[核函数](@entry_id:145324)的适当设计来确保这一点。

#### 全局守恒

为了保证全局守恒，即所有颗粒释放的总量应精确地等于流体接收的总量，[核函数](@entry_id:145324) $W$ 必须是**归一化的**。这意味着其在整个空间上的积分为1：

$$
\int_{\mathbb{R}^3} W(\mathbf{r})\,\mathrm{d}\mathbf{r} = 1
$$

有了这个属性，我们可以验证源项场的全局积分 ：
$$
\int_{\Omega} S_{\phi}(\mathbf{x})\,\mathrm{d}\mathbf{x} = \int_{\Omega} \sum_{p} s_{\phi,p} W(\mathbf{x} - \mathbf{x}_{p}) \,\mathrm{d}\mathbf{x} = \sum_{p} s_{\phi,p} \int_{\Omega} W(\mathbf{x} - \mathbf{x}_{p}) \,\mathrm{d}\mathbf{x} \approx \sum_{p} s_{\phi,p}
$$
这表明，通过使用归一化[核函数](@entry_id:145324)，系统总体的[守恒量](@entry_id:161475)得到了精确的保证。在离散形式中，这意味着分配到网格单元的权重之和必须为1，即 $\sum_j w_j(\mathbf{x}_p) = 1$，其中 $w_j$ 是颗粒 $p$ 对单元 $j$ 的贡献权重 。如果一个光滑的[核函数](@entry_id:145324)（如[高斯函数](@entry_id:261394)）被截断而没有重新归一化，就会导致数值上的动量或能量“泄漏”，从而违反[离散守恒](@entry_id:1123819)律。

#### 离散作用力与[反作用](@entry_id:203910)力对称性

守恒性的另一个关键层面是确保数值方案本身不会人为地产生或耗散动量和能量。这要求流体作用于颗粒的计算（“聚集”操作，即从网格插值到颗粒）与颗粒反作用于流体的计算（“散播”操作，即将源项分布到网格）在数值上是共轭的。

实现这一点的最直接方法是，对聚集和散播**使用相同的[核函数](@entry_id:145324)（或权重）** 。例如，如果流体速度通过加权平均插值到颗粒位置 $\tilde{\mathbf{u}}_p = \sum_j w_j(\mathbf{x}_p)\,\mathbf{u}_j$，那么颗粒施加的力 $\mathbf{F}_p$ 也应使用相同的权重 $w_j(\mathbf{x}_p)$ 分配回网格单元 $j$。这种对称性确保了在一个时间步内，颗粒-流体系统内部相互作用的总功为零，从而避免了虚假的能量产生或耗散 。

### 质量、动量和能量的源项机制

现在我们来构建应用于[可压缩反应流](@entry_id:1122760)的欧拉方程的具体源项。这些方程的[守恒形式](@entry_id:1122899)如下，其中明确标示了来自颗粒相的源项 ：

-   **总[质量守恒](@entry_id:204015)**:
    $$
    \frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = S_{\rho}
    $$
-   **组分质量守恒**:
    $$
    \frac{\partial (\rho Y_k)}{\partial t} + \nabla \cdot (\rho Y_k \mathbf{u}) = -\nabla \cdot \mathbf{J}_k + \dot{\omega}_k + S_{\rho Y_k}
    $$
-   **动量守恒**:
    $$
    \frac{\partial (\rho \mathbf{u})}{\partial t} + \nabla \cdot (\rho \mathbf{u} \otimes \mathbf{u} + p\mathbf{I}) = \nabla \cdot \boldsymbol{\tau} + S_{\rho\mathbf{u}}
    $$
-   **总能量守恒**:
    $$
    \frac{\partial (\rho E)}{\partial t} + \nabla \cdot ((\rho E + p) \mathbf{u}) = \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{u}) - \nabla \cdot \mathbf{q} + \text{...} + S_{\rho E}
    $$

这里的 $S_{\rho}$, $S_{\rho Y_k}$, $S_{\rho\mathbf{u}}$ 和 $S_{\rho E}$ 分别是单位体积、单位时间内的质量、组分质量、动量和总能量源项。它们通过PSI-CELL方法根据颗粒的状态进行计算。

#### 动量交换

颗粒的运动由牛顿第二定律决定：$m_p \frac{d\mathbf{v}_p}{dt} = \sum \mathbf{F}_i$。作用在颗粒上的力 $\mathbf{F}_i$ 包括多种物理机制 ：

-   **曳力 (Drag Force, $\mathbf{F}_D$)**: 由颗粒与流体的[相对运动](@entry_id:169798)产生，是动量交换的主要形式。其通用表达式为 $\mathbf{F}_D = \frac{1}{2} C_D \rho_g A_p |\mathbf{u} - \mathbf{v}_p| (\mathbf{u} - \mathbf{v}_p)$，其中 $C_D$ 是依赖于颗粒雷诺数 $Re_p$ 的曳力系数。
-   **重力与[浮力](@entry_id:154088) (Gravity and Buoyancy, $\mathbf{F}_G$)**: 颗粒受到的净重力为 $(\rho_p - \rho_g) V_p \mathbf{g}$。
-   **[热泳力](@entry_id:148073) (Thermophoretic Force, $\mathbf{F}_{th}$)**: 在存在温度梯度的流场中，高温侧的分子撞击比低温侧更剧烈，推动颗粒朝向冷区。该力正比于 $-\nabla T_g$。

根据[牛顿第三定律](@entry_id:166652)，颗粒对流体的反作用力等于流体施加于颗粒的相互作用力之和的负值。一个至关重要的细节是，**体积力（如重力）不应包含在源项中** 。流体的重力项 $\rho_g \mathbf{g}$ 已经存在于其自身的动量方程中，它自然地产生了[静压](@entry_id:275419)梯度和[浮力](@entry_id:154088)效应。如果在源项中再次计入颗粒所受[浮力](@entry_id:154088)的[反作用](@entry_id:203910)力，将导致重复计算。因此，[动量源项](@entry_id:1128121)仅包含界面作用力（如曳力、[热泳力](@entry_id:148073)）的反作用力。

此外，如果颗粒向流体释放质量（如蒸发），这部分质量也携带自身的动量。因此，[动量源项](@entry_id:1128121)的完整形式为 ：

$$
S_{\rho\mathbf{u}, c} = \frac{1}{V_c} \sum_{p} W(\mathbf{x}_c - \mathbf{x}_p) \left[ \mathbf{F}_{p\to g} + \dot{m}_{p\to g} \mathbf{u}_{in,p} \right]
$$

其中，$\mathbf{F}_{p\to g} = -(\mathbf{F}_D + \mathbf{F}_{th} + \dots)$ 是[界面力](@entry_id:184024)之和，$\dot{m}_{p\to g}$ 是质量释放速率，$\mathbf{u}_{in,p}$ 是释放物质进入流体时的速度。

例如，考虑一个体积为 $V_c = (10^{-2} \text{ m})^3 = 10^{-6} \text{ m}^3$ 的网格单元，其中包含三个经历斯托克斯曳力 $\mathbf{F}_{\text{drag},p} = 3\pi\mu d_p(\mathbf{u}_f - \mathbf{u}_p)$ 的颗粒。流体对颗粒的作用力为 $\mathbf{F}_{f\to p} = \mathbf{F}_{\text{drag},p}$，则颗粒对流体的反作用力为 $\mathbf{F}_{p\to f} = -\mathbf{F}_{\text{drag},p}$。该单元的[动量源项](@entry_id:1128121)即为 $\mathbf{S}_{\mathbf{u},c} = \frac{1}{V_c} \sum_{p=1}^3 \mathbf{F}_{p\to f}$。通过代入具体的颗粒直径、速度和流体粘性，我们可以精确计算出传递给该单元的动量 。

#### 质量与组分交换

在[喷雾燃烧](@entry_id:1132216)等应用中，[液滴蒸发](@entry_id:748678)是关键的质量交换过程。单个液滴的蒸发速率 $\dot{m}_p$ 可以通过基于薄[膜理论](@entry_id:184090)的模型来描述。该模型考虑了对流和“[斯特凡流](@entry_id:150772)”（由蒸发本身引起的向外物质流动）对质量传递的综合影响 。蒸发速率 $\dot{m}_p$ 通常表示为：

$$
\dot{m}_{p} = \pi d_{p} \rho_{g} D_{g} Sh \ln(1 + B_{M})
$$

其中 $D_g$ 是蒸气在[气体中的扩散](@entry_id:140992)系数。这里的两个关键[无量纲数](@entry_id:260863)是：
-   **[舍伍德数](@entry_id:155437) (Sherwood Number, $Sh$)**: 表征[对流传质](@entry_id:154702)相对于纯扩散[传质](@entry_id:151908)的增强程度，是颗粒雷诺数 $Re_p$ 和[施密特数](@entry_id:141441) $Sc$ 的函数，例如 $Sh = 2 + 0.6 Re_p^{1/2} Sc^{1/3}$。
-   **[斯伯丁传质数](@entry_id:149698) (Spalding Mass Transfer Number, $B_M$)**: $B_M = (Y_{v,s} - Y_{v,\infty})/(1 - Y_{v,s})$，它量化了由液滴表面与远场之间的蒸气质量分数差异驱动的[传质](@entry_id:151908)强度，并修正了[斯特凡流](@entry_id:150772)的影响。

一旦计算出 $\dot{m}_p$，相应的组分源项和总质量源项就可以确定 ：

$$
S_{\rho Y_k, c} = \frac{1}{V_c} \sum_{p} W(\mathbf{x}_c - \mathbf{x}_p) \left[ \dot{m}_{p\to g} z_{k,p} \right]
$$
$$
S_{\rho} = \sum_k S_{\rho Y_k}
$$
其中 $z_{k,p}$ 是从颗粒 $p$ 释放的物质中组分 $k$ 的质量分数。

#### 能量交换

能量交换是这三个过程中最复杂的，因为它涉及多种机制的耦合。单个颗粒的温度演化遵循[热力学第一定律](@entry_id:146485) ：

$$
m_p c_{p,p} \frac{dT_p}{dt} = \dot{Q}_{\text{conv}} + \dot{Q}_{\text{rad}} - \dot{m}_p L_v
$$

等式右边依次为：
-   **对流换热 ($\dot{Q}_{\text{conv}}$)**: $\dot{Q}_{\text{conv}} = h A_p (T_g - T_p)$，其中换热系数 $h$ 通过努塞尔数 $Nu$ (例如，Ranz-Marshall 关联式 $\mathrm{Nu} = 2 + 0.6 \mathrm{Re}_{p}^{1/2} \mathrm{Pr}^{1/3}$) 得到。
-   **辐射换热 ($\dot{Q}_{\text{rad}}$)**: 颗粒与周围环境（如火焰、壁面）的辐射能量交换，例如 $q_{\text{rad}} = \varepsilon_p \sigma A_p (T_r^4 - T_p^4)$。
-   **相变潜热**：蒸发过程需要吸收的能量，其中 $L_v$ 是[汽化潜热](@entry_id:142174)。

相应地，流体相接收的能量源项必须考虑所有这些过程的[反作用](@entry_id:203910)。总能量源项 $S_{\rho E}$ 包括三个主要部分 ：

1.  **热量传递**: 流体通过对流传递给颗粒的热量的[反作用](@entry_id:203910)，即 $-\dot{Q}_{\text{conv}}$。辐射通常被视为颗粒与远场环境的交换，除非气体是参与性介质，否则不直接计入气-粒界面交换项。
2.  **界面做功**: [界面力](@entry_id:184024)对流体做的功，即 $\mathbf{F}_{p\to g} \cdot \mathbf{u}|_{\mathbf{x}_p}$。这是流体动能方程的一部分，最终贡献给总能量。
3.  **质量携带的能量**: 蒸发出的物质携带的总能量，包括其自身的焓 $h_{in,p}$ 和动能 $\frac{1}{2}|\mathbf{u}_{in,p}|^2$。注意，这里的焓 $h_{in,p}$ 包含了蒸气的显焓和化学能，而汽化潜热 $L_v$ 代表了克服液体内聚力所需的能量，两者在能量守恒中共同作用。

综合起来，总能量源项为：
$$
S_{\rho E, c} = \frac{1}{V_c} \sum_{p} W(\mathbf{x}_c - \mathbf{x}_p) \left[ \dot{Q}_{p\to g} + \mathbf{F}_{p\to g} \cdot \mathbf{u}|_{\mathbf{x}_p} + \dot{m}_{p\to g} \left( h_{in,p} + \frac{1}{2}|\mathbf{u}_{in,p}|^2 \right) \right]
$$
在一个具体的计算示例中 ，我们可以通过给定颗粒和流体的状态参数，一步步计算 $Re_p$、$Nu$、$h$，然后得到[对流换热](@entry_id:151349)和相变潜热的贡献，最终计算出施加于网格单元的总能量源项 $S_{E,g}$。同样，另一个示例  演示了如何根据[蒸发速率](@entry_id:148562) $\dot{m}_p$ 和蒸发物质的焓来计算能量源项，这两种方法在本质上是等效的，只是能量守恒的不同表达形式。

### 点颗粒模型的有效性范围

最后，作为严谨的科学工具，我们必须认识到PSI-CELL点颗粒模型的应用边界和内在假设。该模型的准确性依赖于一系列尺度分离和物理条件的满足 ：

-   **[尺度分离](@entry_id:270204) ($d_p \ll \Delta$)**: 点颗粒近似的核心前提是颗粒尺寸 $d_p$ 远小于流场求解的最小尺度，即欧拉网格尺寸 $\Delta$。一个常用的准则是 $d_p/\Delta \le 0.1$。这确保了颗粒周围的流动扰动（如边界层和近场尾迹）是真正的“亚格子”现象，可以被模型而不是网格所描述。

-   **连续介质流 ($Kn \ll 1$)**: 标准的曳力和传热/[传质关联式](@entry_id:148027)（如 Ranz-Marshall）均基于连续介质假设。这要求气体分子平均自由程 $\lambda$ 远小于颗粒直径 $d_p$，即克努森数 $Kn = \lambda/d_p \ll 1$。若此条件不满足，则需引入[稀薄气体动力学](@entry_id:144408)的修正。

-   **亚格子尾迹 ($Re_p \lesssim 100$)**: 即使颗粒本身是亚格子的，其产生的尾迹也必须是亚格子的。随着颗粒雷诺数 $Re_p$ 的增加，尾迹会变得更长，并在 $Re_p \approx 200$ 左右开始变得不稳定并脱落涡街。如果这些尾迹结构的尺度与网格尺度相当或更大，点源模型就无法准确描述其对解析流场的影响。因此，为了保证模型的有效性，$Re_p$ 应被限制在一个适度的范围内。

-   **稀疏流动 ($\phi_v \lesssim 10^{-3}$)**: PSI-CELL 的标准形式处理的是[双向耦合](@entry_id:178809)，忽略了颗粒间的直接相互作用。这要求流动是稀疏的，即颗粒体积分数 $\phi_v$ 非常小。

-   **[集总参数模型](@entry_id:1127530) ($Bi \ll 0.1$)**: 在模拟颗粒内部温度时，常假设颗粒内部温度均匀（[集总参数模型](@entry_id:1127530)）。此假设的有效性由毕渥数 $Bi = h d_p / (2k_s)$ 判断，它表示颗粒表面对流热阻与内部导热热阻之比。只有当 $Bi \ll 0.1$ 时，内部导热足够快，温度才能近似均匀。否则，必须求解颗粒内部的传导方程。

综上所述，PSI-CELL方法为模拟颗粒-流体[双向耦合](@entry_id:178809)提供了一个既物理严谨又计算高效的框架。然而，其成功应用的前提是深刻理解其背后的[守恒原理](@entry_id:1122907)、源项机制以及模型成立的物理条件。