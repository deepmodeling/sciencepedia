{
    "hands_on_practices": [
        {
            "introduction": "To effectively model droplet breakup, we must first understand the fundamental forces at play. This practice focuses on the Ohnesorge number ($Oh$), a crucial dimensionless parameter that measures the relative strength of internal viscous forces against the restorative force of surface tension. By deriving $Oh$ from characteristic timescales , you will develop a deeper physical intuition for how liquid properties influence a droplet's resistance to deformation and fragmentation.",
            "id": "4054172",
            "problem": "A spherical liquid fuel droplet of diameter $D=100\\,\\mu\\mathrm{m}$, liquid density $\\rho_{\\ell}=800\\,\\mathrm{kg/m^{3}}$, surface tension $\\sigma=0.02\\,\\mathrm{N/m}$, and dynamic viscosity $\\mu_{\\ell}=3\\,\\mathrm{mPa\\cdot s}$ is injected into a gaseous crossflow typical of combustor conditions. In computational combustion models of primary breakup (near-nozzle ligament formation) and secondary breakup (aerodynamic fragmentation of droplets), regime boundaries are commonly organized by the Weber number $We$ in the low-viscosity limit $Oh \\ll 0.1$, where $Oh$ is the Ohnesorge number.\n\nStarting from first principles, use the definitions of the Ohnesorge number $Oh$ and the characteristic capillary and viscous timescales to determine how finite viscosity modifies the competition between capillary restoration and aerodynamic forcing in droplet deformation. Specifically:\n\n- Derive the expression for the Ohnesorge number $Oh$ in terms of $\\mu_{\\ell}$, $\\rho_{\\ell}$, $\\sigma$, and $D$, using timescale arguments based on the capillary time $t_{\\sigma}$ and the viscous diffusion time $t_{\\mu}$.\n- Compute $Oh$ for the given droplet, carefully converting units.\n- Using your timescale analysis, explain qualitatively how a finite $Oh$ is expected to shift breakup regime boundaries (i.e., the critical $We$ for the onset of deformation and fragmentation) compared to the inviscid benchmark $Oh \\ll 0.1$. State explicitly whether the boundaries shift toward larger or smaller $We$, and justify your conclusion from the scaling arguments.\n\nExpress the computed Ohnesorge number $Oh$ as a dimensionless value rounded to $3$ significant figures.",
            "solution": "The problem requires a three-part analysis concerning the influence of viscosity on liquid droplet breakup, quantified by the Ohnesorge number, $Oh$. The analysis will proceed by first deriving the expression for $Oh$ from fundamental timescales, then calculating its value for the given droplet, and finally explaining its physical implications for breakup regime boundaries.\n\nFirst, we derive the expression for the Ohnesorge number, $Oh$, by considering the competition between capillary and viscous effects. As stipulated, this will be based on characteristic timescales.\n\nThe first relevant timescale is the capillary time, $t_{\\sigma}$, which characterizes the time required for surface tension to restore a deformed droplet to its equilibrium spherical shape against its own inertia. A disturbance of characteristic length scale equal to the droplet diameter, $D$, induces a capillary pressure of order $p_{\\sigma} \\sim \\sigma/D$. This pressure acts on the liquid of density $\\rho_{\\ell}$, accelerating it. Applying Newton's second law to an element of fluid of mass $m \\sim \\rho_{\\ell} D^3$ with a force $F \\sim p_{\\sigma} D^2 \\sim \\sigma D$, the acceleration is $a \\sim F/m \\sim \\sigma D / (\\rho_{\\ell} D^3) = \\sigma / (\\rho_{\\ell} D^2)$. The time to traverse a distance $D$ under this acceleration would be $t$ such that $D \\sim \\frac{1}{2} a t^2$, which gives $t^2 \\sim D/a \\sim D / (\\sigma / (\\rho_{\\ell} D^2)) = \\rho_{\\ell} D^3 / \\sigma$. This timescale represents the period of the fundamental mode of capillary-inertial oscillation.\n$$t_{\\sigma} = \\sqrt{\\frac{\\rho_{\\ell} D^{3}}{\\sigma}}$$\nThe second relevant timescale is the viscous diffusion time, $t_{\\mu}$, which is the characteristic time for momentum to diffuse across the droplet via viscous action. This is the timescale over which viscous forces dissipate the kinetic energy of internal fluid motion. For a viscous diffusion process, the time $t$ to diffuse over a length $L$ is given by $t \\sim L^2/\\nu$, where $\\nu$ is the kinematic viscosity. For the droplet, the length scale is $D$ and the kinematic viscosity is $\\nu_{\\ell} = \\mu_{\\ell} / \\rho_{\\ell}$. Therefore, the viscous diffusion time is:\n$$t_{\\mu} = \\frac{D^{2}}{\\nu_{\\ell}} = \\frac{\\rho_{\\ell} D^{2}}{\\mu_{\\ell}}$$\nThe Ohnesorge number, $Oh$, is a dimensionless parameter that quantifies the ratio of viscous forces to the combined effects of inertia and surface tension. In terms of timescales, it represents the ratio of the capillary-inertial response time to the viscous damping time. A large ratio implies that viscous damping is rapid compared to capillary restoration.\n$$Oh \\equiv \\frac{t_{\\sigma}}{t_{\\mu}} = \\frac{\\sqrt{\\frac{\\rho_{\\ell} D^{3}}{\\sigma}}}{\\frac{\\rho_{\\ell} D^{2}}{\\mu_{\\ell}}} = \\sqrt{\\frac{\\rho_{\\ell} D^{3}}{\\sigma}} \\cdot \\frac{\\mu_{\\ell}}{\\rho_{\\ell} D^{2}} = \\frac{\\mu_{\\ell} \\sqrt{\\rho_{\\ell}} D^{3/2}}{\\rho_{\\ell} D^{2} \\sqrt{\\sigma}} = \\frac{\\mu_{\\ell}}{\\sqrt{\\rho_{\\ell}} D^{1/2} \\sqrt{\\sigma}}$$\nThis yields the standard definition for the Ohnesorge number:\n$$Oh = \\frac{\\mu_{\\ell}}{\\sqrt{\\rho_{\\ell} \\sigma D}}$$\nSecond, we compute the value of $Oh$ for the given fuel droplet. The provided parameters must first be converted to a consistent set of SI units.\nGiven:\n- Diameter: $D = 100\\,\\mu\\mathrm{m} = 100 \\times 10^{-6}\\,\\mathrm{m} = 1.0 \\times 10^{-4}\\,\\mathrm{m}$\n- Liquid density: $\\rho_{\\ell} = 800\\,\\mathrm{kg/m^{3}}$\n- Surface tension: $\\sigma = 0.02\\,\\mathrm{N/m}$\n- Liquid dynamic viscosity: $\\mu_{\\ell} = 3\\,\\mathrm{mPa\\cdot s} = 3 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s} = 3 \\times 10^{-3}\\,\\mathrm{kg/(m\\cdot s)}$\n\nWe substitute these values into the derived expression for $Oh$:\n$$Oh = \\frac{3 \\times 10^{-3}\\,\\mathrm{kg/(m\\cdot s)}}{\\sqrt{(800\\,\\mathrm{kg/m^{3}}) \\cdot (0.02\\,\\mathrm{N/m}) \\cdot (1.0 \\times 10^{-4}\\,\\mathrm{m})}}$$\nFirst, we evaluate the term inside the square root:\n$$\\rho_{\\ell} \\sigma D = 800 \\times 0.02 \\times 1.0 \\times 10^{-4} = 16 \\times 1.0 \\times 10^{-4} = 1.6 \\times 10^{-3}$$\nThe units are $(\\mathrm{kg/m^{3}}) \\cdot (\\mathrm{N/m}) \\cdot (\\mathrm{m}) = (\\mathrm{kg/m^{3}}) \\cdot ((\\mathrm{kg\\cdot m/s^{2}})/\\mathrm{m}) \\cdot (\\mathrm{m}) = \\mathrm{kg^{2}/(m^{2}\\cdot s^{2})}$.\nThe square root of this term is:\n$$\\sqrt{1.6 \\times 10^{-3}\\,\\mathrm{kg^{2}/(m^{2}\\cdot s^{2})}} = \\sqrt{16 \\times 10^{-4}\\,\\mathrm{kg^{2}/(m^{2}\\cdot s^{2})}} = 4 \\times 10^{-2}\\,\\mathrm{kg/(m\\cdot s)}$$\nNow, we can compute the final value for $Oh$:\n$$Oh = \\frac{3 \\times 10^{-3}\\,\\mathrm{kg/(m\\cdot s)}}{4 \\times 10^{-2}\\,\\mathrm{kg/(m\\cdot s)}} = \\frac{3}{40} = 0.075$$\nAs a dimensionless value rounded to $3$ significant figures, $Oh = 0.0750$.\n\nThird, we explain qualitatively how a finite $Oh$ affects breakup regime boundaries. Droplet breakup is the result of a competition between destabilizing aerodynamic forces and stabilizing forces within the droplet. The Weber number, $We = \\rho_g U^2 D / \\sigma$ (where $\\rho_g$ is gas density and $U$ is relative velocity), compares the aerodynamic pressure to the stabilizing capillary pressure. Breakup occurs when $We$ exceeds a critical value, $We_{crit}$.\n\nIn the inviscid limit ($Oh \\ll 0.1$), the only force resisting deformation is surface tension. The droplet's internal viscosity is negligible.\n\nWhen $Oh$ is finite, as in our case where $Oh = 0.0750$, viscosity is no longer negligible. Viscosity acts as a damping mechanism, resisting the internal fluid motion required for the droplet to deform and break apart. It dissipates the kinetic energy imparted to the droplet by the aerodynamic forces. Therefore, viscosity is an additional stabilizing force, supplementing surface tension.\n\nOur timescale analysis showed that $Oh = t_{\\sigma}/t_{\\mu}$. For a finite $Oh$, the viscous damping time $t_{\\mu}$ is not infinitely long compared to the capillary oscillation time $t_{\\sigma}$. This means that before the droplet can undergo significant deformation leading to breakup (a process governed by capillary-inertial dynamics over time $t_{\\sigma}$), viscous forces have sufficient time to act and damp out the deforming motions.\n\nTo achieve breakup in a more viscous droplet (higher $Oh$), the destabilizing aerodynamic forces must be stronger to overcome the combined resistance of both surface tension and viscosity. A stronger aerodynamic force requires a larger relative velocity $U$ or gas density $\\rho_g$. This means that the critical Weber number, $We_{crit}$, required for the onset of any given breakup regime (e.g., vibrational, bag, or shear breakup) must increase.\n\nIn conclusion, a finite Ohnesorge number signifies the importance of viscous damping. This added stabilization makes the droplet more resistant to aerodynamic fragmentation. Consequently, the breakup regime boundaries, which are defined by critical Weber numbers, shift toward larger values of $We$ as $Oh$ increases from the inviscid limit.",
            "answer": "$$\\boxed{0.0750}$$"
        },
        {
            "introduction": "With a grasp of the key physical parameters, we can now construct a dynamic model of droplet deformation. The Taylor Analogy Breakup (TAB) model is a cornerstone of spray simulations, simplifying the complex physics of droplet oscillation into a tractable forced, damped harmonic oscillator problem . This exercise will guide you through deriving the TAB equation of motion and solving it to predict the characteristic breakup time, a key outcome for any spray model.",
            "id": "4054104",
            "problem": "A spherical liquid droplet of initial radius $R_0$ and liquid properties density $\\rho_{\\ell}$, dynamic viscosity $\\mu_{\\ell}$, and surface tension $\\sigma$ is suddenly subjected at time $t=0$ to a uniform gas crossflow of density $\\rho_{g}$ and relative speed $U$. In the Taylor Analogy Breakup (TAB) framework (Taylor Analogy Breakup (TAB)), the small-amplitude, axisymmetric ($\\ell=2$) shape deformation is modeled by the generalized coordinate $a(t)$, defined by the perturbation of the droplet surface $r(\\theta,t)=R_0+a(t)P_2(\\cos\\theta)$, and the nondimensional deformation parameter $y(t)=a(t)/R_0$. The aerodynamic load is idealized as a step forcing proportional to the dynamic pressure, with a modal projection coefficient that remains constant in time after $t=0$.\n\nUsing only the following well-tested facts as a starting point:\n- The inviscid Rayleigh–Lamb natural frequency for the $\\ell=2$ mode of a spherical droplet is $\\omega_2^2=8\\sigma/(\\rho_{\\ell}R_0^3)$.\n- The viscous decay rate for the $\\ell=2$ mode is $\\gamma=5\\mu_{\\ell}/(\\rho_{\\ell}R_0^2)$.\n- The aerodynamic pressure scale associated with the crossflow is proportional to $\\rho_{g}U^2$.\n\nDerive the TAB equation of motion for $y(t)$ under a step aerodynamic load that turns on at $t=0$ and is proportional to $\\rho_{g}U^2$, keeping the proportionality constants that arise from the modal projection explicit and symbolic. Nondimensionalize time using the capillary-oscillation time scale associated with $\\omega_2$, and express the forced, damped oscillator in canonical nondimensional form. Then, in the low-Ohnesorge-number (negligible viscous damping) limit, solve the initial-value problem with $y(0)=0$ and $\\dot{y}(0)=0$ to obtain an explicit, closed-form expression for the dimensional breakup time $t_b$ at which $y(t)$ first reaches a given critical threshold $y_c$.\n\nLet the step forcing amplitude be represented by a constant $\\kappa$ multiplying the gas Weber number $\\mathrm{We}=\\rho_{g}U^2R_0/\\sigma$ in the nondimensional equation. Express your final result for the dimensional breakup time $t_b$ (in seconds) as a single, closed-form analytic expression in terms of $\\rho_{\\ell}$, $\\sigma$, $R_0$, $y_c$, $\\kappa$, and $\\mathrm{We}$. Assume the aerodynamic load is sufficiently strong that the threshold is reachable within the first half-cycle of the undamped response, and neglect droplet translation–deformation coupling beyond the constant step load. The final answer must be a single expression; do not provide an inequality.",
            "solution": "The problem requires the derivation of the breakup time of a liquid droplet subjected to a step aerodynamic load, based on the Taylor Analogy Breakup (TAB) model. The process involves formulating and solving the equation of motion for the droplet's deformation.\n\n**Step 1: Derivation of the Equation of Motion**\n\nThe deformation of the droplet is modeled as a forced, damped harmonic oscillator. The governing equation for the nondimensional deformation, $y(t)$, can be assembled from the provided physical principles. The general form is:\n$$\n\\frac{d^2y}{dt^2} + (\\text{Damping Term}) + (\\text{Spring Term}) = (\\text{Forcing Term})\n$$\nThe \"spring\" term coefficient is the square of the natural frequency of oscillation, which is given as $\\omega_2^2$. This term represents the restoring effect of surface tension.\n$$\n\\omega_2^2 = \\frac{8\\sigma}{\\rho_{\\ell}R_0^3}\n$$\nThe damping term is related to the viscous decay rate, $\\gamma$. For a linear oscillator, the velocity-proportional damping coefficient is $2\\gamma$. Using the given expression for $\\gamma$:\n$$\n2\\gamma = 2 \\left( \\frac{5\\mu_{\\ell}}{\\rho_{\\ell}R_0^2} \\right) = \\frac{10\\mu_{\\ell}}{\\rho_{\\ell}R_0^2}\n$$\nThe forcing term arises from the aerodynamic pressure. For the nondimensional displacement $y$, the forcing term has units of $s^{-2}$ and is proportional to $\\rho_g U^2$. Based on a modal analysis of the aerodynamic forces, the forcing term in the equation for $y(t)$ is correctly formulated as $C \\frac{\\rho_g U^2}{\\rho_{\\ell} R_0^2}$ for some constant $C$.\n\nCombining these parts, the dimensional equation of motion for $y(t)$ is:\n$$\n\\frac{d^2y}{dt^2} + \\frac{10\\mu_{\\ell}}{\\rho_{\\ell} R_0^2} \\frac{dy}{dt} + \\frac{8\\sigma}{\\rho_{\\ell} R_0^3} y = C \\frac{\\rho_g U^2}{\\rho_{\\ell} R_0^2} \\quad \\text{for } t > 0\n$$\n\n**Step 2: Nondimensionalization**\n\nWe nondimensionalize time using the capillary-oscillation time scale $\\tau_{cap} = 1/\\omega_2$. Let $t^* = t/\\tau_{cap} = t\\omega_2$. The derivatives with respect to $t$ become:\n$$\n\\frac{d}{dt} = \\omega_2 \\frac{d}{dt^*} \\quad \\text{and} \\quad \\frac{d^2}{dt^2} = \\omega_2^2 \\frac{d^2}{dt^{*2}}\n$$\nSubstituting these into the equation of motion:\n$$\n\\omega_2^2 \\frac{d^2y}{dt^{*2}} + \\left(\\frac{10\\mu_{\\ell}}{\\rho_{\\ell} R_0^2}\\right) \\omega_2 \\frac{dy}{dt^*} + \\omega_2^2 y = C \\frac{\\rho_g U^2}{\\rho_{\\ell} R_0^2}\n$$\nDividing by $\\omega_2^2 = 8\\sigma/(\\rho_{\\ell}R_0^3)$:\n$$\n\\frac{d^2y}{dt^{*2}} + \\left(\\frac{10\\mu_{\\ell}}{\\omega_2 \\rho_{\\ell} R_0^2}\\right) \\frac{dy}{dt^*} + y = \\frac{C}{\\omega_2^2} \\frac{\\rho_g U^2}{\\rho_{\\ell} R_0^2}\n$$\nThe forcing term on the right-hand side is simplified:\n$$\n\\frac{C}{\\omega_2^2} \\frac{\\rho_g U^2}{\\rho_{\\ell} R_0^2} = C \\left(\\frac{\\rho_{\\ell}R_0^3}{8\\sigma}\\right) \\frac{\\rho_g U^2}{\\rho_{\\ell} R_0^2} = \\frac{C}{8} \\left(\\frac{\\rho_g U^2 R_0}{\\sigma}\\right) = \\frac{C}{8} \\mathrm{We}\n$$\nThe problem specifies that this nondimensional forcing term is equal to $\\kappa \\mathrm{We}$, which defines the constant $\\kappa = C/8$.\nThe damping coefficient can be expressed in terms of the Ohnesorge number, $\\mathrm{Oh} = \\mu_{\\ell}/\\sqrt{\\rho_{\\ell}\\sigma R_0}$:\n$$\n\\frac{10\\mu_{\\ell}}{\\omega_2 \\rho_{\\ell} R_0^2} = \\frac{10\\mu_{\\ell}}{\\sqrt{8\\sigma/(\\rho_{\\ell}R_0^3)} \\rho_{\\ell} R_0^2} = \\frac{10\\mu_{\\ell}}{\\sqrt{8 \\rho_{\\ell} \\sigma R_0}} = \\frac{10}{2\\sqrt{2}}\\mathrm{Oh} = \\frac{5}{\\sqrt{2}}\\mathrm{Oh}\n$$\nThe canonical nondimensional equation is thus:\n$$\n\\frac{d^2y}{dt^{*2}} + \\frac{5}{\\sqrt{2}}\\mathrm{Oh} \\frac{dy}{dt^*} + y = \\kappa \\mathrm{We}\n$$\n\n**Step 3: Solution in the Low-Ohnesorge-Number Limit**\n\nIn the low-Ohnesorge-number limit ($\\mathrm{Oh} \\to 0$), the viscous damping term is negligible. The equation simplifies to that of an undamped, forced harmonic oscillator:\n$$\n\\frac{d^2y}{dt^{*2}} + y = \\kappa \\mathrm{We}\n$$\nThe general solution is the sum of the homogeneous solution, $y_h(t^*) = A\\cos(t^*) + B\\sin(t^*)$, and a particular solution. For a constant forcing term, the particular solution is a constant, $y_p(t^*) = \\kappa \\mathrm{We}$.\nSo, $y(t^*) = A\\cos(t^*) + B\\sin(t^*) + \\kappa \\mathrm{We}$.\n\nWe apply the initial conditions $y(0) = 0$ and $\\dot{y}(0) = 0$. The latter implies $\\frac{dy}{dt^*}(0)=0$ since $\\omega_2 \\neq 0$.\n1.  Apply $y(0) = 0$:\n    $y(0) = A\\cos(0) + B\\sin(0) + \\kappa \\mathrm{We} = A + \\kappa \\mathrm{We} = 0 \\implies A = -\\kappa \\mathrm{We}$.\n2.  Apply $\\frac{dy}{dt^*}(0) = 0$:\n    $\\frac{dy}{dt^*} = -A\\sin(t^*) + B\\cos(t^*)$.\n    $\\frac{dy}{dt^*}(0) = -A\\sin(0) + B\\cos(0) = B = 0$.\n\nThe solution to the initial value problem is:\n$$\ny(t^*) = -\\kappa \\mathrm{We} \\cos(t^*) + \\kappa \\mathrm{We} = \\kappa \\mathrm{We} (1 - \\cos(t^*))\n$$\n\n**Step 4: Calculation of the Breakup Time**\n\nBreakup occurs at the time $t_b$ when the deformation $y(t)$ first reaches the critical threshold $y_c$. Let $t_b^*$ be the corresponding nondimensional time.\n$$\ny_c = \\kappa \\mathrm{We} (1 - \\cos(t_b^*))\n$$\nSolving for $\\cos(t_b^*)$:\n$$\n1 - \\cos(t_b^*) = \\frac{y_c}{\\kappa \\mathrm{We}} \\implies \\cos(t_b^*) = 1 - \\frac{y_c}{\\kappa \\mathrm{We}}\n$$\nThe problem states that the threshold is reached within the first half-cycle of the response, so $t_b^* \\in [0, \\pi]$. In this interval, the arccosine function is uniquely defined.\n$$\nt_b^* = \\arccos\\left(1 - \\frac{y_c}{\\kappa \\mathrm{We}}\\right)\n$$\nThis is the nondimensional breakup time. To find the dimensional time $t_b$, we convert back using the relation $t_b = t_b^*/\\omega_2$.\n$$\nt_b = \\frac{1}{\\omega_2} \\arccos\\left(1 - \\frac{y_c}{\\kappa \\mathrm{We}}\\right)\n$$\nSubstituting the expression for $\\omega_2$:\n$$\nt_b = \\sqrt{\\frac{\\rho_{\\ell}R_0^3}{8\\sigma}} \\arccos\\left(1 - \\frac{y_c}{\\kappa \\mathrm{We}}\\right)\n$$\nThis is the final closed-form expression for the dimensional breakup time in terms of the specified parameters.",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{\\rho_{\\ell}R_0^3}{8\\sigma}} \\arccos\\left(1 - \\frac{y_c}{\\kappa \\mathrm{We}}\\right)}\n$$"
        },
        {
            "introduction": "Analytical models provide physical insight, but their value in computational combustion depends on their accurate numerical implementation. This final practice bridges the gap between continuous theory and discrete computation, a critical step for any CFD practitioner . You will analyze the numerical error introduced when calculating the Weber number within a simulation time-step and explore how a more sophisticated predictor-corrector scheme can improve the accuracy of the breakup decision.",
            "id": "4054156",
            "problem": "Consider a spherical liquid droplet moving relative to a gaseous environment in a Lagrangian spray simulation within Computational Fluid Dynamics (CFD). The droplet has diameter $d$ (in $\\mathrm{m}$), liquid density $\\rho_{\\ell}$ (in $\\mathrm{kg}/\\mathrm{m}^3$), and surface tension $\\sigma$ (in $\\mathrm{N}/\\mathrm{m}$). The gas has density $\\rho_{g}$ (in $\\mathrm{kg}/\\mathrm{m}^3$). The relative slip speed magnitude between the droplet and the gas is $U(t)$ (in $\\mathrm{m}/\\mathrm{s}$). Assume $U(t) \\ge 0$ and that $U(t)$ is governed by quadratic drag with constant drag coefficient $C_{D}$ (dimensionless), spherical projected area, and constant diameter over a single time-step. Over a time-step of duration $\\Delta t$ (in $\\mathrm{s}$), the equation of motion for the slip speed magnitude is\n$$\n\\frac{dU}{dt} \\;=\\; -k\\,U^{2}, \\quad \\text{where} \\quad k \\;=\\; \\frac{3\\,C_{D}\\,\\rho_{g}}{4\\,\\rho_{\\ell}\\,d}.\n$$\nThe Weber number is defined as\n$$\nWe(t) \\;=\\; \\frac{\\rho_{g}\\,U(t)^{2}\\,d}{\\sigma}.\n$$\nIn many breakup models, primary and secondary breakup decisions are made by comparing the computed Weber number against regime-specific critical thresholds. In this problem, assume the following decision logic within a single time-step:\n- Primary breakup is triggered if $We \\ge We_{\\mathrm{crit,p}}$, with $We_{\\mathrm{crit,p}}$ dimensionless.\n- Secondary breakup is triggered if $We \\ge We_{\\mathrm{crit,s}}$, with $We_{\\mathrm{crit,s}}$ dimensionless.\n\nThe task is to quantify and reduce the error introduced by treating $U$ as a fixed constant over a time-step (that is, using $U(t_{n})$) when computing $We$ for breakup decisions.\n\nYour tasks:\n\n1. Starting from Newton’s second law and the quadratic drag model above, derive the exact analytical expression for $U(t)$ with initial condition $U(0) = U_{0}$ over a single time-step of duration $\\Delta t$. Using this expression, derive closed-form expressions for the end-of-step Weber number $We_{\\mathrm{true,end}} = We(\\Delta t)$ and the time-step average Weber number\n$$\n\\overline{We}_{\\mathrm{true}} \\;=\\; \\frac{1}{\\Delta t}\\int_{0}^{\\Delta t} We(t)\\,dt.\n$$\n2. Define the fixed-$U$ approximation $We_{\\mathrm{fixed}} = \\rho_{g}\\,U_{0}^{2}\\,d/\\sigma$. Derive the end-of-step relative error\n$$\n\\varepsilon_{\\mathrm{end}}^{\\mathrm{fixed}} \\;=\\; \\frac{We_{\\mathrm{fixed}} - We_{\\mathrm{true,end}}}{We_{\\mathrm{true,end}}},\n$$\nand the time-average relative error\n$$\n\\varepsilon_{\\mathrm{avg}}^{\\mathrm{fixed}} \\;=\\; \\frac{We_{\\mathrm{fixed}} - \\overline{We}_{\\mathrm{true}}}{\\overline{We}_{\\mathrm{true}}},\n$$\nexpressed in terms of $k$, $U_{0}$, and $\\Delta t$. Then, provide the leading-order term of each error as $\\Delta t \\to 0$.\n3. Propose a second-order predictor–corrector scheme (Heun’s method) for $U$ over one time-step. Using $f(U) = -k\\,U^{2}$, define the predictor $U^{\\ast} = U_{0} + \\Delta t\\,f(U_{0})$ and the corrector\n$$\nU_{\\mathrm{pc}} \\;=\\; U_{0} + \\frac{\\Delta t}{2}\\left[f(U_{0}) + f(U^{\\ast})\\right].\n$$\nDefine $We_{\\mathrm{pc}} = \\rho_{g}\\,U_{\\mathrm{pc}}^{2}\\,d/\\sigma$ and derive the end-of-step relative error\n$$\n\\varepsilon_{\\mathrm{end}}^{\\mathrm{pc}} \\;=\\; \\frac{We_{\\mathrm{pc}} - We_{\\mathrm{true,end}}}{We_{\\mathrm{true,end}}},\n$$\ngiving the leading-order term as $\\Delta t \\to 0$.\n4. Using $We_{\\mathrm{fixed}}$ and $We_{\\mathrm{pc}}$ respectively, state the primary and secondary breakup decisions for each method using the decision thresholds $We_{\\mathrm{crit,p}} = 12$ and $We_{\\mathrm{crit,s}} = 20$ (dimensionless). A decision is a boolean that is true if the corresponding inequality holds and false otherwise.\n5. Implement a program that, for each provided test case, computes $\\varepsilon_{\\mathrm{end}}^{\\mathrm{fixed}}$, $\\varepsilon_{\\mathrm{end}}^{\\mathrm{pc}}$, and the four breakup decisions $\\{D_{\\mathrm{p}}^{\\mathrm{fixed}}, D_{\\mathrm{p}}^{\\mathrm{pc}}, D_{\\mathrm{s}}^{\\mathrm{fixed}}, D_{\\mathrm{s}}^{\\mathrm{pc}}\\}$, in that order. All outputs must be dimensionless, and errors must be reported as decimal numbers. No angles or percentages appear in this problem.\n\nUse the following test suite, with all parameters expressed in the International System of Units (SI):\n- Case $1$: $d = 1.0\\times 10^{-4}\\ \\mathrm{m}$, $\\rho_{\\ell} = 1.0\\times 10^{3}\\ \\mathrm{kg}/\\mathrm{m}^{3}$, $\\rho_{g} = 1.2\\ \\mathrm{kg}/\\mathrm{m}^{3}$, $\\sigma = 7.2\\times 10^{-2}\\ \\mathrm{N}/\\mathrm{m}$, $C_{D} = 1.0$, $U_{0} = 3.0\\times 10^{1}\\ \\mathrm{m}/\\mathrm{s}$, $\\Delta t = 1.0\\times 10^{-4}\\ \\mathrm{s}$.\n- Case $2$: same as Case $1$ except $\\Delta t = 1.0\\times 10^{-6}\\ \\mathrm{s}$.\n- Case $3$: same as Case $1$ except $U_{0} = 0.0\\ \\mathrm{m}/\\mathrm{s}$.\n- Case $4$: same as Case $1$ except $\\Delta t = 5.0\\times 10^{-3}\\ \\mathrm{s}$.\n- Case $5$: $d = 5.0\\times 10^{-5}\\ \\mathrm{m}$, $\\rho_{\\ell} = 1.0\\times 10^{3}\\ \\mathrm{kg}/\\mathrm{m}^{3}$, $\\rho_{g} = 1.0\\times 10^{1}\\ \\mathrm{kg}/\\mathrm{m}^{3}$, $\\sigma = 7.2\\times 10^{-2}\\ \\mathrm{N}/\\mathrm{m}$, $C_{D} = 1.0$, $U_{0} = 5.0\\times 10^{1}\\ \\mathrm{m}/\\mathrm{s}$, $\\Delta t = 1.0\\times 10^{-4}\\ \\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, append the six values in the order $[\\varepsilon_{\\mathrm{end}}^{\\mathrm{fixed}}, \\varepsilon_{\\mathrm{end}}^{\\mathrm{pc}}, D_{\\mathrm{p}}^{\\mathrm{fixed}}, D_{\\mathrm{p}}^{\\mathrm{pc}}, D_{\\mathrm{s}}^{\\mathrm{fixed}}, D_{\\mathrm{s}}^{\\mathrm{pc}}]$, then concatenate all five cases into one flat list. The final output should therefore contain $30$ entries on one line.",
            "solution": "**1. Derivation of the Exact Analytical Solution**\n\nThe governing ordinary differential equation (ODE) for the slip speed magnitude $U(t)$ is given as:\n$$\n\\frac{dU}{dt} = -k\\,U^2\n$$\nwith the initial condition $U(0) = U_0$. This is a separable ODE. For $U_0 > 0$, we can separate variables:\n$$\n\\frac{dU}{U^2} = -k\\,dt\n$$\nIntegrating both sides from the initial state $(t=0, U=U_0)$ to a later state $(t, U(t))$:\n$$\n\\int_{U_0}^{U(t)} \\frac{d\\tilde{U}}{\\tilde{U}^2} = \\int_{0}^{t} -k\\,d\\tilde{t}\n$$\n$$\n\\left[ -\\frac{1}{\\tilde{U}} \\right]_{U_0}^{U(t)} = \\left[ -k\\tilde{t} \\right]_{0}^{t}\n$$\n$$\n-\\frac{1}{U(t)} + \\frac{1}{U_0} = -k\\,t\n$$\nSolving for $U(t)$:\n$$\n\\frac{1}{U(t)} = \\frac{1}{U_0} + k\\,t = \\frac{1 + k\\,U_0\\,t}{U_0}\n$$\n$$\nU(t) = \\frac{U_0}{1 + k\\,U_0\\,t}\n$$\nThis solution also holds for the trivial case $U_0 = 0$, which gives $U(t)=0$ for all $t \\ge 0$.\n\nThe Weber number is defined as $We(t) = \\frac{\\rho_g\\,U(t)^2\\,d}{\\sigma}$. The exact end-of-step Weber number, $We_{\\mathrm{true,end}}$, is evaluated at $t = \\Delta t$:\n$$\nWe_{\\mathrm{true,end}} = We(\\Delta t) = \\frac{\\rho_g\\,d}{\\sigma}\\,U(\\Delta t)^2 = \\frac{\\rho_g\\,d}{\\sigma} \\left( \\frac{U_0}{1 + k\\,U_0\\,\\Delta t} \\right)^2\n$$\n\nThe exact time-step average Weber number, $\\overline{We}_{\\mathrm{true}}$, is:\n$$\n\\overline{We}_{\\mathrm{true}} = \\frac{1}{\\Delta t} \\int_{0}^{\\Delta t} We(t)\\,dt = \\frac{1}{\\Delta t} \\int_{0}^{\\Delta t} \\frac{\\rho_g\\,d}{\\sigma} \\left( \\frac{U_0}{1 + k\\,U_0\\,t} \\right)^2 dt\n$$\n$$\n\\overline{We}_{\\mathrm{true}} = \\frac{\\rho_g\\,d\\,U_0^2}{\\sigma\\,\\Delta t} \\int_{0}^{\\Delta t} \\frac{1}{(1 + k\\,U_0\\,t)^2} dt\n$$\nTo solve the integral, let $u = 1 + k\\,U_0\\,t$, so $du = k\\,U_0\\,dt$. The integral becomes:\n$$\n\\int_{1}^{1+k\\,U_0\\,\\Delta t} u^{-2} \\frac{du}{k\\,U_0} = \\frac{1}{k\\,U_0} \\left[ -\\frac{1}{u} \\right]_{1}^{1+k\\,U_0\\,\\Delta t} = \\frac{1}{k\\,U_0} \\left( -\\frac{1}{1+k\\,U_0\\,\\Delta t} + 1 \\right) = \\frac{1}{k\\,U_0} \\left( \\frac{k\\,U_0\\,\\Delta t}{1+k\\,U_0\\,\\Delta t} \\right) = \\frac{\\Delta t}{1+k\\,U_0\\,\\Delta t}\n$$\nSubstituting this back into the expression for $\\overline{We}_{\\mathrm{true}}$:\n$$\n\\overline{We}_{\\mathrm{true}} = \\frac{\\rho_g\\,d\\,U_0^2}{\\sigma\\,\\Delta t} \\left( \\frac{\\Delta t}{1+k\\,U_0\\,\\Delta t} \\right) = \\frac{\\rho_g\\,d\\,U_0^2}{\\sigma\\,(1+k\\,U_0\\,\\Delta t)}\n$$\n\n**2. Fixed-U Approximation Error Analysis**\n\nThe fixed-U approximation uses $U_0$ for the entire step, so $We_{\\mathrm{fixed}} = \\frac{\\rho_g\\,U_0^2\\,d}{\\sigma}$.\n\nThe end-of-step relative error $\\varepsilon_{\\mathrm{end}}^{\\mathrm{fixed}}$ is:\n$$\n\\varepsilon_{\\mathrm{end}}^{\\mathrm{fixed}} = \\frac{We_{\\mathrm{fixed}} - We_{\\mathrm{true,end}}}{We_{\\mathrm{true,end}}} = \\frac{We_{\\mathrm{fixed}}}{We_{\\mathrm{true,end}}} - 1\n$$\n$$\n\\frac{We_{\\mathrm{fixed}}}{We_{\\mathrm{true,end}}} = \\frac{\\frac{\\rho_g\\,U_0^2\\,d}{\\sigma}}{\\frac{\\rho_g\\,d}{\\sigma} \\left( \\frac{U_0}{1 + k\\,U_0\\,\\Delta t} \\right)^2} = \\frac{U_0^2}{U_0^2 / (1 + k\\,U_0\\,\\Delta t)^2} = (1 + k\\,U_0\\,\\Delta t)^2\n$$\nThus, the error is an exact expression:\n$$\n\\varepsilon_{\\mathrm{end}}^{\\mathrm{fixed}} = (1 + k\\,U_0\\,\\Delta t)^2 - 1 = 1 + 2\\,k\\,U_0\\,\\Delta t + (k\\,U_0\\,\\Delta t)^2 - 1 = 2\\,k\\,U_0\\,\\Delta t + (k\\,U_0\\,\\Delta t)^2\n$$\nThe leading-order term as $\\Delta t \\to 0$ is the term with the lowest power of $\\Delta t$, which is $\\mathbf{2\\,k\\,U_0\\,\\Delta t}$. The error is first-order, $O(\\Delta t)$.\n\nThe time-average relative error $\\varepsilon_{\\mathrm{avg}}^{\\mathrm{fixed}}$ is:\n$$\n\\varepsilon_{\\mathrm{avg}}^{\\mathrm{fixed}} = \\frac{We_{\\mathrm{fixed}} - \\overline{We}_{\\mathrm{true}}}{\\overline{We}_{\\mathrm{true}}} = \\frac{We_{\\mathrm{fixed}}}{\\overline{We}_{\\mathrm{true}}} - 1\n$$\n$$\n\\frac{We_{\\mathrm{fixed}}}{\\overline{We}_{\\mathrm{true}}} = \\frac{\\frac{\\rho_g\\,U_0^2\\,d}{\\sigma}}{\\frac{\\rho_g\\,d\\,U_0^2}{\\sigma\\,(1+k\\,U_0\\,\\Delta t)}} = 1 + k\\,U_0\\,\\Delta t\n$$\nThus, the error is:\n$$\n\\varepsilon_{\\mathrm{avg}}^{\\mathrm{fixed}} = (1 + k\\,U_0\\,\\Delta t) - 1 = k\\,U_0\\,\\Delta t\n$$\nThe leading-order term as $\\Delta t \\to 0$ is $\\mathbf{k\\,U_0\\,\\Delta t}$. The error is first-order, $O(\\Delta t)$.\n\n**3. Predictor-Corrector Scheme Error Analysis**\n\nThe predictor-corrector (Heun's) scheme for $U' = f(U) = -k\\,U^2$ is:\nPredictor: $U^{\\ast} = U_0 + \\Delta t\\,f(U_0) = U_0 - k\\,U_0^2\\,\\Delta t = U_0(1 - k\\,U_0\\,\\Delta t)$.\nCorrector: $U_{\\mathrm{pc}} = U_0 + \\frac{\\Delta t}{2}\\left[f(U_0) + f(U^{\\ast})\\right] = U_0 + \\frac{\\Delta t}{2}\\left[-k\\,U_0^2 - k\\,(U^{\\ast})^2\\right]$.\nSubstituting the expression for $U^{\\ast}$:\n$$\nU_{\\mathrm{pc}} = U_0 - \\frac{k\\,\\Delta t}{2} \\left[ U_0^2 + (U_0(1-k\\,U_0\\,\\Delta t))^2 \\right] = U_0 - \\frac{k\\,\\Delta t\\,U_0^2}{2} \\left[ 1 + (1-k\\,U_0\\,\\Delta t)^2 \\right]\n$$\nThe corresponding Weber number is $We_{\\mathrm{pc}} = \\frac{\\rho_g\\,d}{\\sigma}U_{\\mathrm{pc}}^2$. The end-of-step relative error is:\n$$\n\\varepsilon_{\\mathrm{end}}^{\\mathrm{pc}} = \\frac{We_{\\mathrm{pc}} - We_{\\mathrm{true,end}}}{We_{\\mathrm{true,end}}} = \\frac{U_{\\mathrm{pc}}^2}{U(\\Delta t)^2} - 1\n$$\nLet's find a closed-form expression for the ratio $\\frac{U_{\\mathrm{pc}}}{U(\\Delta t)}$. Let $x = k\\,U_0\\,\\Delta t$.\n$$\n\\frac{U_{\\mathrm{pc}}}{U_0} = 1 - \\frac{k\\,\\Delta t\\,U_0}{2} \\left[ 1 + (1-k\\,U_0\\,\\Delta t)^2 \\right] = 1 - \\frac{x}{2} \\left[ 1 + (1-x)^2 \\right]\n$$\nAnd $\\frac{U(\\Delta t)}{U_0} = \\frac{1}{1+x}$. So,\n$$\n\\frac{U_{\\mathrm{pc}}}{U(\\Delta t)} = (1+x) \\left( 1 - \\frac{x}{2}[1+(1-x)^2] \\right) = (1+x) \\left( 1 - \\frac{x}{2}[2 - 2x + x^2] \\right)\n$$\n$$\n= (1+x) (1 - x + x^2 - \\frac{x^3}{2}) = (1 - x + x^2 - \\frac{x^3}{2}) + (x - x^2 + x^3 - \\frac{x^4}{2}) = 1 + \\frac{x^3}{2} - \\frac{x^4}{2}\n$$\nThis is an exact algebraic identity. Therefore, we can write $\\varepsilon_{\\mathrm{end}}^{\\mathrm{pc}}$ exactly as:\n$$\n\\varepsilon_{\\mathrm{end}}^{\\mathrm{pc}} = \\left( 1 + \\frac{1}{2}(k\\,U_0\\,\\Delta t)^3 - \\frac{1}{2}(k\\,U_0\\,\\Delta t)^4 \\right)^2 - 1\n$$\nTo find the leading-order term as $\\Delta t \\to 0$, we expand this expression:\n$$\n\\varepsilon_{\\mathrm{end}}^{\\mathrm{pc}} = \\left(1 + (k\\,U_0\\,\\Delta t)^3 + \\dots \\right) - 1 = (k\\,U_0\\,\\Delta t)^3 + O(\\Delta t^4)\n$$\nThe leading-order term is $\\mathbf{(k\\,U_0\\,\\Delta t)^3 = k^3\\,U_0^3\\,\\Delta t^3}$. The error is third-order, $O(\\Delta t^3)$, a significant improvement over the first-order fixed-$U$ method.\n\n**4. Breakup Decision Logic**\n\nThe critical Weber numbers for primary and secondary breakup are given as $We_{\\mathrm{crit,p}} = 12$ and $We_{\\mathrm{crit,s}} = 20$, respectively. The decision for each method is a boolean value based on these thresholds.\n\nFor the fixed-$U$ method:\n- Primary breakup decision $D_{\\mathrm{p}}^{\\mathrm{fixed}}$ is true if $We_{\\mathrm{fixed}} \\ge 12$, and false otherwise.\n- Secondary breakup decision $D_{\\mathrm{s}}^{\\mathrm{fixed}}$ is true if $We_{\\mathrm{fixed}} \\ge 20$, and false otherwise.\n\nFor the predictor-corrector method:\n- Primary breakup decision $D_{\\mathrm{p}}^{\\mathrm{pc}}$ is true if $We_{\\mathrm{pc}} \\ge 12$, and false otherwise.\n- Secondary breakup decision $D_{\\mathrm{s}}^{\\mathrm{pc}}$ is true if $We_{\\mathrm{pc}} \\ge 20$, and false otherwise.\n\nThese rules will be implemented in the final program to evaluate the breakup criteria for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the droplet breakup problem for a suite of test cases.\n\n    This function iterates through predefined test cases, calculating:\n    1. The relative error of the end-of-step Weber number for a fixed-U approximation.\n    2. The relative error of the end-of-step Weber number for a predictor-corrector scheme.\n    3. Breakup decisions (primary and secondary) for both the fixed-U and predictor-corrector methods.\n\n    The results are aggregated into a single flat list and printed in the required format.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (d, rho_l, rho_g, sigma, C_D, U_0, delta_t)\n    test_cases = [\n        (1.0e-4, 1.0e3, 1.2, 7.2e-2, 1.0, 30.0, 1.0e-4), # Case 1\n        (1.0e-4, 1.0e3, 1.2, 7.2e-2, 1.0, 30.0, 1.0e-6), # Case 2\n        (1.0e-4, 1.0e3, 1.2, 7.2e-2, 1.0, 0.0, 1.0e-4),  # Case 3\n        (1.0e-4, 1.0e3, 1.2, 7.2e-2, 1.0, 30.0, 5.0e-3), # Case 4\n        (5.0e-5, 1.0e3, 10.0, 7.2e-2, 1.0, 50.0, 1.0e-4),# Case 5\n    ]\n\n    # Critical Weber numbers for breakup decisions\n    we_crit_p = 12.0\n    we_crit_s = 20.0\n\n    all_results = []\n    for case in test_cases:\n        d, rho_l, rho_g, sigma, C_D, U_0, delta_t = case\n\n        # Calculate the drag parameter k\n        k = (3.0 * C_D * rho_g) / (4.0 * rho_l * d)\n\n        # Handle the U_0 = 0 case separately to avoid division by zero in We calculations,\n        # although the derived error formulas are robust.\n        if U_0 == 0.0:\n            eps_end_fixed = 0.0\n            eps_end_pc = 0.0\n            we_fixed = 0.0\n            we_pc = 0.0\n        else:\n            # Dimensionless group x = k * U_0 * delta_t\n            x = k * U_0 * delta_t\n\n            # Calculate relative errors using the exact derived formulas\n            # These are algebraically exact and robust for all x.\n            eps_end_fixed = (1.0 + x)**2 - 1.0\n            eps_end_pc = (1.0 + 0.5 * x**3 - 0.5 * x**4)**2 - 1.0\n\n            # Calculate Weber numbers for breakup decisions\n            # We_fixed\n            we_fixed = (rho_g * U_0**2 * d) / sigma\n\n            # U_pc from Heun's method\n            # U_pc = U_0 - (k*delta_t*U_0**2 / 2.0) * (1 + (1 - k*U_0*delta_t)**2)\n            # which simplifies to using x:\n            U_pc = U_0 - (x * U_0 / 2.0) * (1.0 + (1.0 - x)**2)\n            \n            # We_pc\n            we_pc = (rho_g * U_pc**2 * d) / sigma\n\n        # Make breakup decisions\n        D_p_fixed = we_fixed >= we_crit_p\n        D_p_pc = we_pc >= we_crit_p\n        D_s_fixed = we_fixed >= we_crit_s\n        D_s_pc = we_pc >= we_crit_s\n        \n        case_results = [\n            eps_end_fixed,\n            eps_end_pc,\n            D_p_fixed,\n            D_p_pc,\n            D_s_fixed,\n            D_s_pc\n        ]\n        all_results.extend(case_results)\n\n    # Format the final output string\n    # E.g., Booleans become \"True\" or \"False\", floats are converted to string representation.\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}