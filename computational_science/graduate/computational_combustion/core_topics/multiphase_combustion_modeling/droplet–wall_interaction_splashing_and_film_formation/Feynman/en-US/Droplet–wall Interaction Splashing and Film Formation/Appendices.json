{
    "hands_on_practices": [
        {
            "introduction": "This practice guides you through one of the most fundamental techniques in fluid dynamics: dimensional analysis. By nondimensionalizing the Navier-Stokes equations, you will derive the key dimensionless numbers that govern droplet impact dynamics, such as the Reynolds number $Re$ and Weber number $We$. This exercise is crucial for understanding how to compare different impact scenarios and for using empirical correlations to predict outcomes like splashing or deposition .",
            "id": "4022603",
            "problem": "A single-component Newtonian hydrocarbon fuel droplet of diameter $D$ impacts a smooth, dry, isothermal solid wall at normal incidence with speed $U$. The fluid has density $\\rho$, dynamic viscosity $\\mu$, and surface tension $\\gamma$. Evaporation, phase change, and gas-phase effects are negligible during the short impact time, and gravity is negligible over the inertial impact timescale. Starting from the incompressible Navier–Stokes equations with capillarity at the liquid–gas interface,\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t}+\\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)=-\\nabla p+\\mu \\nabla^{2}\\boldsymbol{u},\\quad \\nabla\\cdot \\boldsymbol{u}=0,\n$$\nand the capillary normal-stress jump condition $\\Delta p=\\gamma \\kappa$ at the interface, nondimensionalize the equations using the characteristic scales $D$ for length, $U$ for velocity, $D/U$ for time, and $\\rho U^{2}$ for pressure. Identify, in terms of $(\\rho,\\mu,\\gamma,U,D)$, the four canonical dimensionless groups governing droplet impact and interfacial dynamics in this setting: the Reynolds number, the Weber number, the Ohnesorge number, and the Capillary number. Explain their origin from the nondimensionalized equations and interface condition.\n\nThen, for a droplet with $D=100\\,\\mu\\mathrm{m}$, $U=10\\,\\mathrm{m/s}$, $\\rho=800\\,\\mathrm{kg/m^3}$, $\\mu=2\\,\\mathrm{mPa\\,s}$, and $\\gamma=0.025\\,\\mathrm{N/m}$, compute numerical values of these four dimensionless numbers. Using a widely reported splashing threshold correlation for normal impact on smooth dry surfaces of the form $K=We^{1/2}Re^{1/4}$ with a critical value $K_{\\mathrm{crit}}=57.7$, classify the likely outcome as splash or deposition by defining an outcome indicator $S$ that equals $1$ if $KK_{\\mathrm{crit}}$ (splashing likely) and $0$ otherwise (deposition likely).\n\nReport your final answer as a single row matrix $\\begin{pmatrix}Re  We  Oh  Ca  S\\end{pmatrix}$. Round each of $Re$, $We$, $Oh$, and $Ca$ to four significant figures. Report $S$ as an integer $0$ or $1$. All reported quantities are dimensionless.",
            "solution": "The problem is first validated to be scientifically grounded, well-posed, objective, and complete. All necessary data, equations, and conditions are provided, and they conform to established principles of fluid dynamics. The numerical values are physically realistic for a hydrocarbon fuel droplet. The problem is a standard exercise in dimensional analysis and its application to a practical engineering correlation.\n\nThe first step is to nondimensionalize the governing equations and the interface condition to identify the canonical dimensionless groups. The provided characteristic scales are length $D$, velocity $U$, time $D/U$, and pressure $\\rho U^2$. We define the following dimensionless variables, denoted by a superscript asterisk:\n$$\n\\boldsymbol{x}^* = \\frac{\\boldsymbol{x}}{D}, \\quad \\boldsymbol{u}^* = \\frac{\\boldsymbol{u}}{U}, \\quad t^* = \\frac{t}{D/U}, \\quad p^* = \\frac{p}{\\rho U^2}\n$$\nThe differential operators in terms of the dimensionless coordinates are:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{U}{D}\\frac{\\partial}{\\partial t^*}, \\quad \\nabla = \\frac{1}{D}\\nabla^*, \\quad \\nabla^2 = \\frac{1}{D^2}\\nabla^{*2}\n$$\nWe substitute these into the incompressible Navier-Stokes momentum equation:\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t}+\\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)=-\\nabla p+\\mu \\nabla^{2}\\boldsymbol{u}\n$$\nSubstituting the scaled variables and operators yields:\n$$\n\\rho\\left(\\frac{U}{D}\\frac{\\partial (U\\boldsymbol{u}^*)}{\\partial t^*} + (U\\boldsymbol{u}^*)\\cdot\\left(\\frac{1}{D}\\nabla^*\\right)(U\\boldsymbol{u}^*)\\right) = -\\left(\\frac{1}{D}\\nabla^*\\right)(\\rho U^2 p^*) + \\mu \\left(\\frac{1}{D^2}\\nabla^{*2}\\right)(U\\boldsymbol{u}^*)\n$$\nFactoring out the dimensional coefficients:\n$$\n\\frac{\\rho U^2}{D}\\left(\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^*\\right) = -\\frac{\\rho U^2}{D}\\nabla^* p^* + \\frac{\\mu U}{D^2}\\nabla^{*2} \\boldsymbol{u}^*\n$$\nTo make the equation dimensionless, we divide all terms by the coefficient of the inertial terms, $\\rho U^2/D$:\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^* = -\\nabla^* p^* + \\left(\\frac{\\mu U/D^2}{\\rho U^2/D}\\right)\\nabla^{*2} \\boldsymbol{u}^*\n$$\nThe dimensionless group that appears as the coefficient of the viscous term is simplified as:\n$$\n\\frac{\\mu U D}{\\rho U^2 D^2} = \\frac{\\mu}{\\rho U D}\n$$\nThis group is the inverse of the **Reynolds number**, $Re$. Therefore, $Re = \\frac{\\rho U D}{\\mu}$. The dimensionless momentum equation is:\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^* = -\\nabla^* p^* + \\frac{1}{Re}\\nabla^{*2} \\boldsymbol{u}^*\n$$\nThe Reynolds number, $Re$, originates from the ratio of inertial forces to viscous forces in the momentum equation.\n\nNext, we nondimensionalize the capillary normal-stress jump condition at the liquid-gas interface, $\\Delta p=\\gamma \\kappa$. The curvature $\\kappa$ has units of inverse length, so its dimensionless form is $\\kappa^* = \\kappa D$.\n$$\n\\Delta p = \\gamma \\kappa \\implies \\Delta(p^* \\rho U^2) = \\gamma \\frac{\\kappa^*}{D}\n$$\n$$\n(\\rho U^2) \\Delta p^* = \\frac{\\gamma}{D}\\kappa^*\n$$\nRearranging for the dimensionless pressure jump, $\\Delta p^*$:\n$$\n\\Delta p^* = \\left(\\frac{\\gamma}{\\rho U^2 D}\\right) \\kappa^*\n$$\nThis dimensionless group is the inverse of the **Weber number**, $We$. Therefore, $We = \\frac{\\rho U^2 D}{\\gamma}$. The dimensionless interface condition is $\\Delta p^* = \\frac{1}{We}\\kappa^*$. The Weber number, $We$, originates from the ratio of inertial forces (or dynamic pressure) to forces due to surface tension.\n\nThe **Ohnesorge number**, $Oh$, and the **Capillary number**, $Ca$, are derived from $Re$ and $We$. The Ohnesorge number is constructed to be independent of velocity $U$, thus characterizing the fluid and length scale alone. It is defined as:\n$$\nOh = \\frac{\\sqrt{We}}{Re} = \\frac{\\sqrt{\\rho U^2 D/\\gamma}}{\\rho U D/\\mu} = \\frac{U\\sqrt{\\rho D/\\gamma}}{U(\\rho D/\\mu)} = \\frac{\\mu}{\\sqrt{\\rho \\gamma D}}\n$$\nThe Ohnesorge number relates viscous forces to the geometric mean of inertial and surface tension forces.\n\nThe Capillary number relates viscous forces to surface tension forces and is defined as:\n$$\nCa = \\frac{We}{Re} = \\frac{\\rho U^2 D/\\gamma}{\\rho U D/\\mu} = \\frac{\\mu U}{\\gamma}\n$$\n\nNow, we compute the numerical values of these four dimensionless numbers for a droplet with $D=100\\,\\mu\\mathrm{m} = 1 \\times 10^{-4}\\,\\mathrm{m}$, $U=10\\,\\mathrm{m/s}$, $\\rho=800\\,\\mathrm{kg/m^3}$, $\\mu=2\\,\\mathrm{mPa\\,s} = 2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$, and $\\gamma=0.025\\,\\mathrm{N/m}$.\n\nThe Reynolds number is:\n$$\nRe = \\frac{\\rho U D}{\\mu} = \\frac{(800\\,\\mathrm{kg/m^3}) (10\\,\\mathrm{m/s}) (1 \\times 10^{-4}\\,\\mathrm{m})}{2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}} = \\frac{0.8}{0.002} = 400\n$$\nRounded to four significant figures, $Re = 400.0$.\n\nThe Weber number is:\n$$\nWe = \\frac{\\rho U^2 D}{\\gamma} = \\frac{(800\\,\\mathrm{kg/m^3}) (10\\,\\mathrm{m/s})^2 (1 \\times 10^{-4}\\,\\mathrm{m})}{0.025\\,\\mathrm{N/m}} = \\frac{800 \\times 100 \\times 10^{-4}}{0.025} = \\frac{8}{0.025} = 320\n$$\nRounded to four significant figures, $We = 320.0$.\n\nThe Ohnesorge number is:\n$$\nOh = \\frac{\\mu}{\\sqrt{\\rho \\gamma D}} = \\frac{2 \\times 10^{-3}}{\\sqrt{(800)(0.025)(1 \\times 10^{-4})}} = \\frac{2 \\times 10^{-3}}{\\sqrt{0.002}} = \\frac{2 \\times 10^{-3}}{0.0447213...} \\approx 0.0447213...\n$$\nRounded to four significant figures, $Oh = 0.04472$.\n\nThe Capillary number is:\n$$\nCa = \\frac{\\mu U}{\\gamma} = \\frac{(2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}) (10\\,\\mathrm{m/s})}{0.025\\,\\mathrm{N/m}} = \\frac{0.02}{0.025} = 0.8\n$$\nRounded to four significant figures, $Ca = 0.8000$.\n\nFinally, we classify the impact outcome using the splashing correlation $K=We^{1/2}Re^{1/4}$ with a critical value $K_{\\mathrm{crit}}=57.7$. The outcome indicator $S$ equals $1$ for splashing ($K  K_{\\mathrm{crit}}$) and $0$ for deposition ($K \\le K_{\\mathrm{crit}}$).\nWe calculate the splashing parameter $K$:\n$$\nK = We^{1/2}Re^{1/4} = (320)^{1/2}(400)^{1/4}\n$$\nWe can write this as $K = (\\sqrt{320})(\\sqrt[4]{400}) = (\\sqrt{64 \\times 5})(\\sqrt[4]{4 \\times 100}) = (8\\sqrt{5})(\\sqrt{2}\\sqrt{10}) = (8\\sqrt{5})(\\sqrt{2}\\sqrt{2}\\sqrt{5}) = (8\\sqrt{5})(2\\sqrt{5}) = 16 \\times 5 = 80$.\nThe calculated value is $K=80$. We compare this to the critical value:\n$$\nK = 80  K_{\\mathrm{crit}} = 57.7\n$$\nSince $K$ is greater than $K_{\\mathrm{crit}}$, the likely outcome is splashing. Therefore, the outcome indicator is $S=1$.\n\nThe final results are $Re = 400.0$, $We = 320.0$, $Oh = 0.04472$, $Ca = 0.8000$, and $S=1$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 400.0  320.0  0.04472  0.8000  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building on the fundamentals, this exercise delves into the more complex physics of droplet spreading on a heated surface, a common scenario in combustion applications. You will use scaling analysis to derive a dimensionless group, the Marangoni number, which quantifies the strength of thermocapillary forces driven by temperature-induced surface tension gradients. This practice demonstrates how to isolate and analyze competing physical effects to understand and model advanced phenomena in multiphase flows .",
            "id": "4022588",
            "problem": "A single-component hydrocarbon fuel droplet impacts a heated, smooth wall in quiescent gas. Immediately after impact, an axisymmetric lamella forms and spreads radially. Owing to the temperature variation along the lamella surface, the surface tension varies and drives thermocapillary (Marangoni) stresses that modify the spreading dynamics. Starting from first principles, formulate a dimensionless group that quantifies the strength of thermocapillary-driven spreading relative to viscous resistance and thermal diffusion in the lamella, and then evaluate it for the conditions below.\n\nAssume the lamella has a uniform thickness and that the interfacial temperature decreases approximately linearly from the hot near-wall region to the lamella rim. Use the interfacial tangential stress balance and the advection–diffusion balance along the lamella to construct your dimensionless measure. The thermal diffusivity is defined as $\\alpha = k/(\\rho c_{p})$.\n\nFuel properties evaluated at a representative lamella temperature are:\n- Dynamic viscosity: $\\mu = 7.5 \\times 10^{-4}\\ \\mathrm{Pa\\cdot s}$.\n- Thermal conductivity: $k = 0.14\\ \\mathrm{W/(m\\cdot K)}$.\n- Density: $\\rho = 680\\ \\mathrm{kg/m^{3}}$.\n- Specific heat at constant pressure: $c_{p} = 2.20 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)}$.\n- Surface tension temperature coefficient: $\\partial \\sigma / \\partial T = -1.20 \\times 10^{-4}\\ \\mathrm{N/(m\\cdot K)}$.\n\nLamella geometry and thermal data at a short time after impact:\n- Lamella thickness: $h = 5.0 \\times 10^{-5}\\ \\mathrm{m}$.\n- Interfacial temperature drop along the lamella: $\\Delta T = 20\\ \\mathrm{K}$.\n\nExpress your final answer as a dimensionless number and round to three significant figures. Do not include units in your final numerical answer.",
            "solution": "The problem requires the formulation and evaluation of a dimensionless group that quantifies the strength of thermocapillary-driven spreading relative to viscous resistance and thermal diffusion. The derivation will be based on first principles, specifically the interfacial tangential stress balance and the advection–diffusion balance for heat within the liquid lamella.\n\nFirst, we establish the interfacial tangential stress balance. The driving force for the spreading is the thermocapillary or Marangoni stress, $\\tau_M$, which arises from the gradient of surface tension, $\\sigma$, along the lamella surface. This stress is balanced by the resisting viscous shear stress, $\\tau_v$, within the liquid. The balance is expressed as $\\tau_M \\approx \\tau_v$.\n\nThe Marangoni stress is the gradient of surface tension, $\\tau_M = \\frac{\\partial \\sigma}{\\partial r}$. Since the surface tension $\\sigma$ is a function of temperature $T$, we can use the chain rule: $\\frac{\\partial \\sigma}{\\partial r} = \\frac{\\partial \\sigma}{\\partial T} \\frac{\\partial T}{\\partial r}$. We are given that the temperature drops by $\\Delta T$ over the lamella. Let the characteristic radial length of the lamella be $L$. The temperature gradient can be scaled as $\\frac{\\partial T}{\\partial r} \\sim \\frac{\\Delta T}{L}$. Let $\\sigma_T = |\\frac{\\partial \\sigma}{\\partial T}|$ be the magnitude of the surface tension temperature coefficient. The scale of the Marangoni stress is then:\n$$\n\\tau_M \\sim \\sigma_T \\frac{\\Delta T}{L}\n$$\n\nThe viscous shear stress in the liquid is given by $\\tau_v = \\mu \\frac{\\partial u_r}{\\partial z}$, where $\\mu$ is the dynamic viscosity, $u_r$ is the radial velocity, and $z$ is the coordinate normal to the wall. Assuming a no-slip condition at the wall ($u_r=0$ at $z=0$) and a characteristic spreading velocity $U$ at the free surface ($z=h$), the velocity gradient can be scaled as $\\frac{\\partial u_r}{\\partial z} \\sim \\frac{U-0}{h} = \\frac{U}{h}$. Thus, the viscous stress is:\n$$\n\\tau_v \\sim \\mu \\frac{U}{h}\n$$\n\nEquating the Marangoni and viscous stresses gives a relationship for the characteristic spreading velocity $U$:\n$$\n\\sigma_T \\frac{\\Delta T}{L} \\sim \\mu \\frac{U}{h} \\implies U \\sim \\frac{\\sigma_T \\Delta T h}{\\mu L}\n$$\n\nNext, we consider the advection–diffusion balance for heat transport in the lamella, as specified. The temperature field is established by a balance between heat being advected radially outwards by the flow and heat diffusing from the hot wall vertically into the fluid. The energy equation is $\\rho c_p (\\mathbf{u} \\cdot \\nabla T) = \\nabla \\cdot (k \\nabla T)$, where $\\rho$ is density, $c_p$ is specific heat, and $k$ is thermal conductivity.\n\nThe radial advection term scales as $\\rho c_p u_r \\frac{\\partial T}{\\partial r} \\sim \\rho c_p U \\frac{\\Delta T}{L}$.\nThe dominant diffusion term is in the direction of the steepest temperature gradients, which is the vertical direction (normal to the wall), as heat enters the thin lamella from the wall. This term scales as $k \\frac{\\partial^2 T}{\\partial z^2} \\sim k \\frac{\\Delta T}{h^2}$.\nBalancing these two terms gives:\n$$\n\\rho c_p U \\frac{\\Delta T}{L} \\sim k \\frac{\\Delta T}{h^2}\n$$\nBy using the definition of thermal diffusivity, $\\alpha = k/(\\rho c_p)$, this simplifies to:\n$$\n\\frac{U}{L} \\sim \\frac{\\alpha}{h^2}\n$$\nThis relation connects the kinematic properties of the flow ($U, L$) to the thermal properties of the fluid ($\\alpha$) and the geometry ($h$). It states that the characteristic time for advection over the length $L$, which is $L/U$, is on the order of the time for heat to diffuse across the thickness $h$, which is $h^2/\\alpha$.\n\nWe now have a system of two scaling relations involving the unknown scales $U$ and $L$:\n1. $U \\sim \\frac{\\sigma_T \\Delta T h}{\\mu L}$\n2. $L \\sim \\frac{U h^2}{\\alpha}$\n\nTo formulate a dimensionless group using only the given parameters, we eliminate $U$ and $L$. Substituting the expression for $L$ from (2) into (1):\n$$\nU \\sim \\frac{\\sigma_T \\Delta T h}{\\mu \\left( \\frac{U h^2}{\\alpha} \\right)} = \\frac{\\sigma_T \\Delta T \\alpha}{\\mu U h}\n$$\nRearranging for $U^2$ gives a scale for the square of the Marangoni-driven velocity:\n$$\nU^2 \\sim \\frac{\\sigma_T \\Delta T \\alpha}{\\mu h}\n$$\nThis expression combines thermocapillary driving forces ($\\sigma_T \\Delta T$), viscous resistance ($\\mu$), and thermal diffusion ($\\alpha$). To make it a dimensionless group, we can normalize it by a relevant velocity scale squared. A natural velocity scale in this problem is the velocity of thermal diffusion across the film thickness $h$, defined as $V_{th} = \\alpha/h$.\nThe desired dimensionless group, which we denote $M_S$, is the ratio of these squared velocities:\n$$\nM_S = \\frac{U^2}{V_{th}^2} \\sim \\frac{\\left( \\frac{\\sigma_T \\Delta T \\alpha}{\\mu h} \\right)}{\\left( \\frac{\\alpha}{h} \\right)^2} = \\frac{\\sigma_T \\Delta T \\alpha}{\\mu h} \\frac{h^2}{\\alpha^2} = \\frac{\\sigma_T \\Delta T h}{\\mu \\alpha}\n$$\nThis dimensionless group, a form of the surface Marangoni number, quantifies the strength of thermocapillary convection relative to viscous and thermal dissipation, as requested.\n\nNow, we evaluate this number using the provided data.\nFirst, we calculate the thermal diffusivity $\\alpha$:\n$\\rho = 680\\ \\mathrm{kg/m^{3}}$\n$c_{p} = 2.20 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)}$\n$k = 0.14\\ \\mathrm{W/(m\\cdot K)}$\n$$\n\\alpha = \\frac{k}{\\rho c_p} = \\frac{0.14\\ \\mathrm{W/(m\\cdot K)}}{(680\\ \\mathrm{kg/m^{3}}) \\times (2.20 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)})} = \\frac{0.14}{1.496 \\times 10^6}\\ \\mathrm{m^2/s} \\approx 9.358289 \\times 10^{-8}\\ \\mathrm{m^2/s}\n$$\nNext, we substitute all values into the expression for $M_S$.\n$\\sigma_T = |\\partial \\sigma / \\partial T| = |-1.20 \\times 10^{-4}| = 1.20 \\times 10^{-4}\\ \\mathrm{N/(m\\cdot K)}$\n$\\Delta T = 20\\ \\mathrm{K}$\n$h = 5.0 \\times 10^{-5}\\ \\mathrm{m}$\n$\\mu = 7.5 \\times 10^{-4}\\ \\mathrm{Pa\\cdot s}$\n$$\nM_S = \\frac{\\sigma_T \\Delta T h}{\\mu \\alpha} = \\frac{(1.20 \\times 10^{-4}\\ \\mathrm{N/(m\\cdot K)}) \\times (20\\ \\mathrm{K}) \\times (5.0 \\times 10^{-5}\\ \\mathrm{m})}{(7.5 \\times 10^{-4}\\ \\mathrm{Pa\\cdot s}) \\times (9.358289 \\times 10^{-8}\\ \\mathrm{m^2/s})}\n$$\nCalculating the numerator:\n$$\n\\text{Numerator} = (1.20 \\times 20 \\times 5.0) \\times 10^{-4} \\times 10^{-5} = 120 \\times 10^{-9} = 1.2 \\times 10^{-7}\\ \\mathrm{N}\n$$\nCalculating the denominator:\n$$\n\\text{Denominator} = (7.5 \\times 9.358289) \\times 10^{-4} \\times 10^{-8} = 70.18717 \\times 10^{-12} = 7.018717 \\times 10^{-11}\\ \\mathrm{N}\n$$\nThe units of $\\mathrm{Pa \\cdot s \\cdot m^2/s} = \\mathrm{(N/m^2) \\cdot s \\cdot m^2/s} = \\mathrm{N}$, so the group is dimensionless.\nFinally, we compute the ratio:\n$$\nM_S = \\frac{1.2 \\times 10^{-7}}{7.018717 \\times 10^{-11}} \\approx 1709.725\n$$\nRounding to three significant figures, the value of the dimensionless group is $1710$, or $1.71 \\times 10^3$.",
            "answer": "$$\n\\boxed{1.71 \\times 10^3}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between theoretical analysis and computational modeling, a core skill for a computational scientist. You will implement the Ghost Fluid Method (GFM), a powerful numerical technique for capturing the pressure discontinuity at fluid interfaces due to surface tension. By verifying your implementation against a static droplet test case, you will gain hands-on experience with a foundational algorithm used in modern multiphase flow solvers .",
            "id": "4022595",
            "problem": "Implement a two-dimensional Ghost Fluid Method (GFM) to impose a pressure jump across a material interface due to surface tension and verify accuracy using a static droplet test. Consider a square computational domain of side length $L$ in meters, discretized on a Cartesian grid of $N \\times N$ nodes with uniform spacing $\\Delta x = \\Delta y = L/(N-1)$. A circular droplet of radius $R$ (in meters) is centered at $\\left(x_c, y_c\\right)=\\left(L/2,L/2\\right)$. Let $\\phi(x,y)$ be the signed distance level-set function, $\\phi(x,y) = \\sqrt{(x-x_c)^2+(y-y_c)^2} - R$, with $\\phi \\lt 0$ inside the droplet and $\\phi \\gt 0$ outside.\n\nAssume static equilibrium in each phase, so the pressure field $p(x,y)$ is piecewise harmonic: $\\nabla^2 p = 0$ in both regions, with a jump at the interface given by the Young–Laplace condition $\\Delta p = \\gamma \\kappa$, where $\\gamma$ is the surface tension (in $\\mathrm{N/m}$) and $\\kappa$ is the curvature (in $\\mathrm{m^{-1}}$). For a two-dimensional circular interface representing a planar cross-section of a cylindrical droplet, the curvature is $\\kappa = 1/R$. Impose homogeneous Dirichlet boundary conditions $p=0$ on the domain boundary to represent a reference ambient pressure. Use the five-point finite-difference stencil for the discrete Laplacian and implement the Ghost Fluid Method to enforce the jump condition across grid edges cut by the interface.\n\nGhost Fluid Method directive: For a grid node $(i,j)$, write the discrete Laplace equation as $4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = b_{i,j}$. For each neighbor $(i',j')$ of $(i,j)$ such that $\\phi_{i,j}\\cdot\\phi_{i',j'} \\lt 0$ (the interface crosses the edge), add a jump contribution to the right-hand side:\n- If $\\phi_{i,j} \\lt 0$ and $\\phi_{i',j'} \\gt 0$, then $b_{i,j} \\leftarrow b_{i,j} + \\Delta p$.\n- If $\\phi_{i,j} \\gt 0$ and $\\phi_{i',j'} \\lt 0$, then $b_{i,j} \\leftarrow b_{i,j} - \\Delta p$.\nHere $\\Delta p = \\gamma \\kappa$ with $\\kappa = 1/R$. Apply $p=0$ strongly on the domain boundary nodes.\n\nVerification metric: For each test case, compute the infinity-norm error away from the interface as follows. Define inside mask $\\mathcal{M}^{-} = \\{(i,j): \\phi_{i,j} \\lt -\\tau\\}$ and outside mask $\\mathcal{M}^{+} = \\{(i,j): \\phi_{i,j} \\gt \\tau\\}$ with buffer $\\tau = 1.5 \\Delta x$. Let $p_{\\text{th}}^{-} = \\Delta p$ and $p_{\\text{th}}^{+} = 0$. Compute $E^{-}_{\\infty} = \\max_{(i,j)\\in \\mathcal{M}^{-}} \\left| p_{i,j} - p_{\\text{th}}^{-} \\right|$ and $E^{+}_{\\infty} = \\max_{(i,j)\\in \\mathcal{M}^{+}} \\left| p_{i,j} - p_{\\text{th}}^{+} \\right|$. Report $E_{\\infty} = \\max(E^{-}_{\\infty}, E^{+}_{\\infty})$.\n\nPhysical units requirement: Express all errors $E_{\\infty}$ in pascals (Pa) as floating-point numbers.\n\nTest suite: Use the following parameter sets to exercise the method:\n1. $L=0.01$ m, $N=64$, $R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$.\n2. $L=0.01$ m, $N=32$ (coarse grid), $R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$.\n3. $L=0.01$ m, $N=128$ (fine grid), $R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$.\n4. $L=0.01$ m, $N=128$, $R=0.0005$ m (small droplet), $\\gamma=0.072$ $\\mathrm{N/m}$.\n5. $L=0.01$ m, $N=128$, $R=0.0015$ m, $\\gamma=0.050$ $\\mathrm{N/m}$.\n\nFinal output format: Your program should produce a single line of output containing the errors for all five test cases as a comma-separated list enclosed in square brackets (e.g., \"[e1,e2,e3,e4,e5]\"), where each $e_k$ is a float in pascals (Pa).",
            "solution": "The user has provided a valid, well-posed, and scientifically grounded problem statement. The problem requires the implementation and verification of a two-dimensional Ghost Fluid Method (GFM) for a static droplet test case. The core of the problem is to solve for a piecewise harmonic pressure field with a sharp jump at a circular interface, governed by the Young-Laplace equation.\n\nThe problem is to find the pressure field $p(x,y)$ in a square domain of side length $L$. The domain contains a circular droplet of a different fluid, centered at $(L/2, L/2)$ with radius $R$. The interface between the two fluids is represented by the zero-contour of a signed distance function, $\\phi(x,y) = \\sqrt{(x-L/2)^2 + (y-L/2)^2} - R$, where $\\phi \\lt 0$ is inside the droplet and $\\phi \\gt 0$ is outside. In static equilibrium and neglecting body forces, the pressure in each fluid is constant, which satisfies the condition of being harmonic, $\\nabla^2 p = 0$. At the interface, there is a pressure jump dictated by the Young-Laplace equation, $\\Delta p = p_{\\text{inside}} - p_{\\text{outside}} = \\gamma \\kappa$. Here, $\\gamma$ is the surface tension and $\\kappa$ is the interface curvature. For a two-dimensional circular-cross section, the curvature is $\\kappa = 1/R$. The pressure on the domain boundary is fixed at a reference value of $p=0$. The theoretical solution is therefore a piecewise constant pressure field: $p(x,y) = \\Delta p$ for $\\phi  0$ and $p(x,y) = 0$ for $\\phi  0$.\n\nThe problem is discretized on a uniform $N \\times N$ Cartesian grid with spacing $\\Delta x = \\Delta y = L/(N-1)$. The Laplace operator is approximated using the standard five-point finite-difference stencil:\n$$\n\\nabla^2 p \\approx \\frac{p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4 p_{i,j}}{\\Delta x^2}\n$$\nThe problem specifies a rearrangement of this stencil into the form of a linear equation for each grid node $(i,j)$:\n$$\n4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = b_{i,j}\n$$\nThis is equivalent to setting $-\\Delta x^2 (\\nabla^2_h p)_{i,j} = b_{i,j}$, where $\\nabla^2_h$ is the discrete Laplacian. For nodes away from the interface, the governing equation is $\\nabla^2 p = 0$, so the right-hand side $b_{i,j}$ is $0$. The pressure jump condition is enforced by defining non-zero values for $b_{i,j}$ for nodes adjacent to the interface, which is the essence of this particular Ghost Fluid Method.\n\nThe GFM models the pressure discontinuity by adding source terms to the right-hand side of the discrete equations for nodes whose stencils cross the interface. The directive states that for a node $(i,j)$ and its neighbor $(i',j')$, if the interface lies between them (i.e., $\\phi_{i,j} \\cdot \\phi_{i',j'}  0$), a contribution is added to $b_{i,j}$.\nLet us analyze this directive. Consider a node $(i,j)$ in the liquid phase ($\\phi_{i,j}  0$) and its neighbor $(i+1,j)$ in the gas phase ($\\phi_{i+1,j}  0$). A rigorous GFM would define a ghost pressure at the location of $(i+1,j)$ by extrapolating from the gas-phase pressure. A first-order GFM defines this ghost pressure as $p_{i+1,j}^{\\text{ghost}} = p_{i+1,j} + \\Delta p$, where $p_{i+1,j}$ is the real pressure at the neighboring node. Substituting this into the stencil for node $(i,j)$:\n$$\n4 p_{i,j} - p_{i+1,j}^{\\text{ghost}} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = 0\n$$\n$$\n4 p_{i,j} - (p_{i+1,j} + \\Delta p) - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = 0\n$$\nRearranging this to match the problem's specified form gives:\n$$\n4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = \\Delta p\n$$\nThis implies that for node $(i,j)$, the RHS term $b_{i,j}$ should receive a contribution of $+\\Delta p$. This matches the directive: if $\\phi_{i,j}  0$ and $\\phi_{i',j'}  0$, $b_{i,j}$ is increased by $\\Delta p$.\nConversely, for the gas-phase node $(i+1,j)$, the jump is $p_{\\text{inside}} - p_{\\text{outside}} = \\Delta p$, which means $p_{\\text{outside}} - p_{\\text{inside}} = -\\Delta p$. The ghost pressure at the location of node $(i,j)$ is $p_{i,j}^{\\text{ghost}} = p_{i,j} - \\Delta p$. The stencil at $(i+1,j)$ becomes:\n$$\n4 p_{i+1,j} - p_{i+2,j} - p_{i,j}^{\\text{ghost}} - p_{i+1,j+1} - p_{i+1,j-1} = 0\n$$\n$$\n4 p_{i+1,j} - p_{i+2,j} - (p_{i,j} - \\Delta p) - p_{i+1,j+1} - p_{i+1,j-1} = 0\n$$\nThis gives a RHS contribution of $-\\Delta p$ for node $(i+1,j)$, which also matches the directive. The total RHS value $b_{i,j}$ for any node is the sum of contributions from all of its neighbors that are across the interface.\n\nThe complete set of discrete equations for all $N \\times N$ nodes forms a large, sparse linear system of the form $A \\mathbf{p} = \\mathbf{b}$. The vector $\\mathbf{p}$ contains the unknown pressure values, flattened from the 2D grid. The matrix $A$ is the coefficient matrix. For an internal node $(i,j)$, row $k=iN+j$ of $A$ contains the coefficients of the 5-point stencil: $4$ on the diagonal, and $-1$ for its four neighbors. For a boundary node, the Dirichlet condition $p=0$ is enforced strongly by setting the corresponding row of $A$ to be an identity row (i.e., $A_{k,k}=1$, $A_{k,l}=0$ for $l \\ne k$) and setting $b_k=0$. The vector $\\mathbf{b}$ contains the GFM source terms, which are non-zero only for nodes adjacent to the interface.\n\nThis sparse linear system is solved to obtain the numerical pressure field $p_{i,j}$. To verify accuracy, the numerical solution is compared against the known theoretical solution ($p_{\\text{th}}^{-} = \\Delta p$, $p_{\\text{th}}^{+} = 0$). The error is quantified using the infinity norm, computed away from the interface in regions defined by a buffer distance $\\tau = 1.5 \\Delta x$. The inside error $E^{-}_{\\infty} = \\max |p_{i,j} - p_{\\text{th}}^{-}|$ is computed for all nodes where $\\phi_{i,j}  -\\tau$, and the outside error $E^{+}_{\\infty} = \\max |p_{i,j} - p_{\\text{th}}^{+}|$ is computed for all nodes where $\\phi_{i,j}  \\tau$. The final reported error is $E_{\\infty} = \\max(E^{-}_{\\infty}, E^{+}_{\\infty})$.\n\nThe algorithm is implemented in Python. Grid and field data are stored in `numpy` arrays. The large, sparse matrix $A$ is constructed using `scipy.sparse.lil_matrix` and the linear system is solved efficiently using `scipy.sparse.linalg.spsolve`. The procedure is executed for each of the five test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (L, N, R, gamma)\n        (0.01, 64, 0.002, 0.072),\n        (0.01, 32, 0.002, 0.072),\n        (0.01, 128, 0.002, 0.072),\n        (0.01, 128, 0.0005, 0.072),\n        (0.01, 128, 0.0015, 0.050),\n    ]\n\n    results = []\n    for L, N, R, gamma in test_cases:\n        error = solve_one_case(L, N, R, gamma)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_one_case(L, N, R, gamma):\n    \"\"\"\n    Implements the Ghost Fluid Method for a single static droplet test case.\n\n    Args:\n        L (float): Domain side length in meters.\n        N (int): Number of grid nodes in each dimension.\n        R (float): Droplet radius in meters.\n        gamma (float): Surface tension in N/m.\n\n    Returns:\n        float: The infinity-norm error E_inf in Pascals.\n    \"\"\"\n    # 1. Grid and Level-Set Setup\n    dx = L / (N - 1)\n    x = np.linspace(0, L, N)\n    y = np.linspace(0, L, N)\n    xx, yy = np.meshgrid(x, y)\n    \n    xc, yc = L / 2.0, L / 2.0\n    phi = np.sqrt((xx - xc)**2 + (yy - yc)**2) - R\n    \n    # 2. System Assembly (A p = b)\n    n_nodes = N * N\n    A = lil_matrix((n_nodes, n_nodes), dtype=np.float64)\n    b = np.zeros(n_nodes, dtype=np.float64)\n    \n    # Pressure jump and theoretical pressures\n    delta_p = gamma / R\n\n    # Iterate over all grid points to build matrix A and vector b\n    for i in range(N):\n        for j in range(N):\n            k = i * N + j  # Flattened 1D index\n\n            # Strong enforcement of Dirichlet boundary conditions p=0\n            if i == 0 or i == N - 1 or j == 0 or j == N - 1:\n                A[k, k] = 1.0\n                b[k] = 0.0\n                continue\n\n            # Internal nodes: 5-point stencil for the Laplacian\n            A[k, k] = 4.0\n            A[k, k + 1] = -1.0  # Neighbor (i, j+1)\n            A[k, k - 1] = -1.0  # Neighbor (i, j-1)\n            A[k, k + N] = -1.0  # Neighbor (i+1, j)\n            A[k, k - N] = -1.0  # Neighbor (i-1, j)\n\n            # GFM: Add source terms to RHS for nodes adjacent to the interface\n            # Check right neighbor (i, j+1)\n            if phi[i, j] * phi[i, j + 1]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n            \n            # Check left neighbor (i, j-1)\n            if phi[i, j] * phi[i, j - 1]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n            \n            # Check top neighbor (i+1, j)\n            if phi[i, j] * phi[i + 1, j]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n\n            # Check bottom neighbor (i-1, j)\n            if phi[i, j] * phi[i - 1, j]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n    \n    # 3. Solve the Linear System\n    # Convert matrix to a more efficient format for solving\n    A_csc = A.tocsc()\n    p_flat = spsolve(A_csc, b)\n    p_sol = p_flat.reshape((N, N))\n\n    # 4. Error Verification\n    tau = 1.5 * dx\n    p_th_minus = delta_p\n    p_th_plus = 0.0\n\n    mask_inside = phi  -tau\n    mask_outside = phi  tau\n\n    p_values_inside = p_sol[mask_inside]\n    p_values_outside = p_sol[mask_outside]\n\n    err_inside = 0.0\n    if p_values_inside.size  0:\n        err_inside = np.max(np.abs(p_values_inside - p_th_minus))\n\n    err_outside = 0.0\n    if p_values_outside.size  0:\n        err_outside = np.max(np.abs(p_values_outside - p_th_plus))\n        \n    E_inf = max(err_inside, err_outside)\n    \n    return E_inf\n\nsolve()\n\n```"
        }
    ]
}