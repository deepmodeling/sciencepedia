{
    "hands_on_practices": [
        {
            "introduction": "In modeling spray-wall interactions, accurately predicting the evaporation rate of the liquid film is paramount for determining fuel-air mixture formation. The overall rate of this complex process is often governed by the slowest link in a chain of transport phenomena: either the conduction of heat through the liquid to the surface or the diffusion of vapor away from the surface. This exercise guides you through a fundamental timescale analysis to derive and compute a dimensionless ratio, analogous to a Damköhler number, which allows you to determine whether the evaporation process is heat-limited or diffusion-limited under a given set of conditions. ",
            "id": "4066782",
            "problem": "Consider a thin hydrocarbon fuel wall film formed by a spray–wall impingement event inside an internal combustion engine cylinder. Following impingement, the film interacts with the hot wall and the turbulent near-wall gas. In many computational combustion sub-models for spray–wall impingement and film interaction, the limiting mechanism for evaporation is determined by comparing a heat-transfer timescale across the liquid film with a species-diffusion timescale across the gas-side boundary layer. Define a Damköhler-like ratio $R$ as the ratio of the characteristic heat-transfer timescale across the liquid film to the characteristic mass-diffusion timescale across the gas boundary layer adjacent to the film.\n\nStarting from fundamental transport equations, namely Fourier’s law and the transient heat equation in the liquid film, and Fick’s law and the transient species diffusion equation in the gas boundary layer, derive an expression for $R$ in terms of the liquid thermal conductivity $k_{l}$, liquid density $\\rho_{l}$, liquid specific heat at constant pressure $c_{p,l}$, vapor binary diffusivity in the gas $D_{v}$, film thickness $\\delta_{f}$, and gas-side boundary-layer thickness $\\delta_{g}$. Then, using the derived expression, compute $R$ for the following properties representative of a gasoline-like fuel at elevated but subcritical engine conditions:\n- $k_{l} = 0.13 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$,\n- $\\rho_{l} = 750 \\ \\mathrm{kg \\ m^{-3}}$,\n- $c_{p,l} = 2000 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$,\n- $D_{v} = 1.5 \\times 10^{-5} \\ \\mathrm{m^{2} \\ s^{-1}}$,\n- $\\delta_{f} = 5.0 \\times 10^{-5} \\ \\mathrm{m}$,\n- $\\delta_{g} = 4.0 \\times 10^{-4} \\ \\mathrm{m}$.\n\nAssume one-dimensional transport normal to the wall in both phases and that the film and the gas boundary layer are laminar in the normal direction over the timescale of interest. Based on the magnitude of $R$, discuss whether evaporation is heat-limited ($R \\gg 1$) or diffusion-limited ($R \\ll 1$). Round your numerical answer for $R$ to three significant figures. Express your answer as a pure number (dimensionless).",
            "solution": "The problem requires the derivation of a Damköhler-like ratio, $R$, defined as the ratio of the characteristic heat-transfer timescale across a liquid film, $\\tau_{heat}$, to the characteristic mass-diffusion timescale across an adjacent gas boundary layer, $\\tau_{diff}$. This ratio is a key parameter in computational sub-models for spray-wall interaction, as it determines the rate-limiting mechanism for fuel film evaporation.\n\nFirst, we derive the characteristic heat-transfer timescale, $\\tau_{heat}$, for the liquid film. The process is governed by transient heat conduction. Assuming one-dimensional transport normal to the wall (coordinate $y$) and constant fluid properties, the governing partial differential equation is the transient heat equation, also known as Fourier's second law:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha_l \\frac{\\partial^2 T}{\\partial y^2} $$\nHere, $T$ is the temperature, $t$ is time, and $\\alpha_l$ is the thermal diffusivity of the liquid. The thermal diffusivity is defined in terms of the liquid's thermal conductivity $k_l$, density $\\rho_l$, and specific heat at constant pressure $c_{p,l}$ as:\n$$ \\alpha_l = \\frac{k_l}{\\rho_l c_{p,l}} $$\nA characteristic timescale for this diffusive process can be obtained through dimensional analysis of the governing equation. The left-hand side, representing the rate of change of temperature, scales as $\\Delta T / \\tau_{heat}$, where $\\Delta T$ is a characteristic temperature difference and $\\tau_{heat}$ is the characteristic time. The right-hand side, representing the diffusion of heat, scales as $\\alpha_l \\Delta T / \\delta_f^2$, where $\\delta_f$ is the characteristic length scale, corresponding to the film thickness. Equating the scales of these two terms gives:\n$$ \\frac{1}{\\tau_{heat}} \\sim \\frac{\\alpha_l}{\\delta_f^2} $$\nTherefore, the characteristic timescale for heat to diffuse across the liquid film is:\n$$ \\tau_{heat} = \\frac{\\delta_f^2}{\\alpha_l} = \\frac{\\rho_l c_{p,l} \\delta_f^2}{k_l} $$\n\nNext, we derive the characteristic mass-diffusion timescale, $\\tau_{diff}$, for the fuel vapor in the gas-side boundary layer. This process is governed by transient species diffusion. Assuming one-dimensional transport and constant properties, the governing equation is Fick's second law:\n$$ \\frac{\\partial Y_v}{\\partial t} = D_v \\frac{\\partial^2 Y_v}{\\partial y^2} $$\nHere, $Y_v$ is the mass fraction of the fuel vapor and $D_v$ is its binary diffusion coefficient in the gas. Following the same dimensional analysis procedure, the temporal term scales as $\\Delta Y_v / \\tau_{diff}$ and the spatial diffusion term scales as $D_v \\Delta Y_v / \\delta_g^2$, where $\\delta_g$ is the characteristic thickness of the gas-side boundary layer. Equating these scales yields:\n$$ \\frac{1}{\\tau_{diff}} \\sim \\frac{D_v}{\\delta_g^2} $$\nThus, the characteristic timescale for mass to diffuse across the gas boundary layer is:\n$$ \\tau_{diff} = \\frac{\\delta_g^2}{D_v} $$\n\nThe Damköhler-like ratio $R$ is defined as the ratio of these two timescales:\n$$ R = \\frac{\\tau_{heat}}{\\tau_{diff}} $$\nSubstituting the derived expressions for $\\tau_{heat}$ and $\\tau_{diff}$ gives:\n$$ R = \\frac{\\left( \\frac{\\rho_l c_{p,l} \\delta_f^2}{k_l} \\right)}{\\left( \\frac{\\delta_g^2}{D_v} \\right)} $$\nSimplifying this expression, we obtain the final form for $R$ in terms of the specified properties:\n$$ R = \\frac{\\rho_l c_{p,l} D_v \\delta_f^2}{k_l \\delta_g^2} $$\n\nNow, we compute the numerical value of $R$ using the provided data:\n- Liquid thermal conductivity: $k_{l} = 0.13 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$\n- Liquid density: $\\rho_{l} = 750 \\ \\mathrm{kg \\ m^{-3}}$\n- Liquid specific heat: $c_{p,l} = 2000 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$\n- Vapor diffusivity: $D_{v} = 1.5 \\times 10^{-5} \\ \\mathrm{m^{2} \\ s^{-1}}$\n- Film thickness: $\\delta_{f} = 5.0 \\times 10^{-5} \\ \\mathrm{m}$\n- Gas boundary-layer thickness: $\\delta_{g} = 4.0 \\times 10^{-4} \\ \\mathrm{m}$\n\nSubstituting these values into the expression for $R$:\n$$ R = \\frac{(750) (2000) (1.5 \\times 10^{-5}) (5.0 \\times 10^{-5})^2}{(0.13) (4.0 \\times 10^{-4})^2} $$\n$$ R = \\frac{(1.5 \\times 10^6) (1.5 \\times 10^{-5}) (25.0 \\times 10^{-10})}{(0.13) (16.0 \\times 10^{-8})} $$\n$$ R = \\frac{(22.5) (25.0 \\times 10^{-10})}{2.08 \\times 10^{-8}} $$\n$$ R = \\frac{5.625 \\times 10^{-8}}{2.08 \\times 10^{-8}} $$\n$$ R \\approx 2.7043269... $$\nRounding the result to three significant figures, we get:\n$$ R \\approx 2.70 $$\n\nThe physical interpretation of this result is as follows. The ratio $R = \\tau_{heat} / \\tau_{diff} \\approx 2.70$ indicates that the characteristic time for heat transfer through the liquid film is approximately $2.7$ times longer than the characteristic time for mass diffusion of the vapor away from the film surface. The overall evaporation rate is limited by the slowest process in the sequence. Since $R > 1$, the slower process is heat transfer. The condition for strongly heat-limited evaporation is typically stated as $R \\gg 1$, while diffusion-limited evaporation corresponds to $R \\ll 1$. Although our calculated value is of order unity, it is clearly greater than $1$, which implies that the evaporation process is heat-transfer-limited. The rate at which the film evaporates is constrained not by how fast the vapor can be transported away, but by how fast the required latent heat of vaporization can be conducted through the liquid film to its surface.",
            "answer": "$$\\boxed{2.70}$$"
        },
        {
            "introduction": "The behavior of a liquid film is critically dependent on the boundary conditions applied at its edges. At the three-phase contact line where liquid, gas, and solid meet, the physics is more complex than a single, ideal contact angle suggests. This practice delves into the concept of contact angle hysteresis, a real-world effect where the contact line can remain \"pinned\" to the surface across a range of angles, powerfully influencing film spreading and stability. By starting with the Young-Laplace equation, you will derive a quantitative criterion for when a film edge will remain pinned versus when it will slide, providing a crucial piece of the puzzle for realistic film modeling in CFD. ",
            "id": "4066749",
            "problem": "In computational film models for spray–wall impingement in computational fluid dynamics (CFD), the dynamic contact angle at the liquid–gas contact line on the wall is commonly used as a boundary condition for the free-surface shape and motion. In the presence of contact angle hysteresis, the apparent contact angle can vary between a receding angle $\\theta_{r}$ and an advancing angle $\\theta_{a}$ without contact line motion (pinning). When an imposed capillary forcing requires an apparent angle outside this interval, the contact line slides (advances or recedes). Consider a locally axisymmetric micro-groove on the wall that can be idealized as a cylindrical capillary of radius $a$ through which the film edge meniscus is pinned. The liquid–gas surface tension is $\\sigma$, and the liquid pressure exceeds the gas pressure by a local capillary pressure $\\Delta p$.\n\nStarting from the Young–Laplace relation $\\Delta p = \\sigma \\kappa$ for the pressure jump across a curved interface, and the definition of contact angle hysteresis as a set-valued boundary condition on the dynamic contact angle $\\theta$ at the contact line, derive from first principles how hysteresis modifies the effective boundary condition at the contact line. Then, for the cylindrical capillary geometry, derive a criterion for pinning versus sliding expressed in terms of $\\Delta p$, $\\theta_{a}$, and $\\theta_{r}$. Finally, evaluate the quantitative width of the capillary pressure window that sustains pinning, defined as the difference between the maximum and minimum $\\Delta p$ consistent with $\\theta \\in [\\theta_{r}, \\theta_{a}]$, for the following parameters:\n- liquid–gas surface tension $\\sigma = 2.0 \\times 10^{-2}\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$,\n- cylindrical micro-groove radius $a = 2.0 \\times 10^{-5}\\ \\mathrm{m}$,\n- advancing contact angle $\\theta_{a} = 80^{\\circ}$,\n- receding contact angle $\\theta_{r} = 40^{\\circ}$.\n\nExpress your final numerical answer for the pinning window width in $\\mathrm{Pa}$ and round to four significant figures. If you perform any trigonometric evaluations, state clearly whether you use radians or degrees, and be consistent.",
            "solution": "The problem asks for three components: first, a derivation of how contact angle hysteresis modifies the contact line boundary condition; second, a specific criterion for pinning versus sliding in an idealized cylindrical capillary; and third, a quantitative evaluation of the pressure window for pinning given specific parameters.\n\nFirst, we address the modification of the boundary condition due to contact angle hysteresis. In the absence of hysteresis, the three-phase contact line (liquid-gas-solid) is characterized by a single, unique equilibrium contact angle, $\\theta_e$, given by Young's equation. At a macroscopic level, any deviation from this angle induced by flow or pressure changes would cause the contact line to move until the angle $\\theta_e$ is restored. The boundary condition is thus a single-valued Dirichlet condition on the angle, $\\theta = \\theta_e$.\n\nContact angle hysteresis introduces a significant modification. Due to surface roughness, chemical heterogeneity, or other physical effects, the contact line can remain stationary, or \"pinned,\" even as the apparent contact angle $\\theta$ varies. This pinning occurs for any contact angle within a specific range, bounded by the receding contact angle, $\\theta_{r}$, and the advancing contact angle, $\\theta_{a}$. The condition for a pinned contact line is therefore not an equation but an inequality:\n$$\n\\theta_{r} \\leq \\theta \\leq \\theta_{a}\n$$\nThe contact line will only move (slide) when the forces acting on the meniscus, such as capillary pressure, attempt to drive the apparent contact angle outside of this range. If the required angle to maintain equilibrium becomes greater than $\\theta_{a}$, the contact line advances and the dynamic contact angle is typically modeled as $\\theta = \\theta_{a}$. If the required angle becomes less than $\\theta_{r}$, the contact line recedes and the dynamic contact angle is modeled as $\\theta = \\theta_{r}$. Thus, hysteresis transforms the boundary condition from a single value into a set-valued condition for pinning, coupled with two limit conditions for the onset of motion.\n\nNext, we derive the criterion for pinning versus sliding for the specified cylindrical capillary geometry. The starting point is the Young-Laplace equation, which relates the pressure difference across a curved liquid-gas interface, $\\Delta p$, to the surface tension, $\\sigma$, and the mean curvature of the interface, $\\kappa$:\n$$\n\\Delta p = \\sigma \\kappa\n$$\nThe problem defines $\\Delta p = p_{liquid} - p_{gas}$. The sign of the curvature $\\kappa$ depends on convention. We adopt the convention that curvature is positive for an interface that is convex as viewed from the liquid phase. In this convention, the pressure is higher on the side of the center of curvature, and the Young-Laplace equation is written as $\\Delta p = \\sigma \\kappa$. For the idealized geometry, the meniscus is a spherical cap. A sphere of radius $R$ has a constant mean curvature $\\kappa = \\frac{2}{R}$ (if convex) or $\\kappa = -\\frac{2}{R}$ (if concave).\n\nLet's establish the relationship between the capillary radius $a$, the contact angle $\\theta$, and the radius of curvature of the meniscus $R$. By drawing a cross-section of the capillary, a right triangle can be formed with vertices at the center of curvature, the contact point on the wall, and the projection of the center of curvature onto the capillary wall. The geometry reveals the relation $a = |R \\cos(\\theta)|$. A more rigorous sign-consistent derivation is as follows. Let the normal to the interface point from liquid to gas.\n- If $\\theta < \\frac{\\pi}{2}$ ($90^{\\circ}$), the meniscus is concave from the liquid side. The center of curvature is in the gas. The curvature is negative, $\\kappa = -\\frac{2}{R}$. The geometric relation is $a = R \\cos(\\theta)$. Thus, $\\Delta p = p_{liquid} - p_{gas} = \\sigma \\kappa = -\\frac{2\\sigma}{R} = -\\frac{2\\sigma \\cos(\\theta)}{a}$.\n- If $\\theta > \\frac{\\pi}{2}$ ($90^{\\circ}$), the meniscus is convex from the liquid side. The center of curvature is in the liquid. The curvature is positive, $\\kappa = \\frac{2}{R}$. The geometric relation is $a = R \\cos(\\pi - \\theta) = -R \\cos(\\theta)$. Thus, $\\Delta p = p_{liquid} - p_{gas} = \\sigma \\kappa = \\frac{2\\sigma}{R} = \\frac{2\\sigma}{-a/\\cos(\\theta)} = -\\frac{2\\sigma \\cos(\\theta)}{a}$.\nIn both cases, we arrive at the same robust relation:\n$$\n\\Delta p = -\\frac{2\\sigma}{a} \\cos(\\theta)\n$$\nThis equation links the imposed capillary pressure $\\Delta p$ to the resulting apparent contact angle $\\theta$.\n\nThe contact line remains pinned as long as this angle $\\theta$ is within the hysteretic range, $\\theta_{r} \\leq \\theta \\leq \\theta_{a}$. We can translate this condition on $\\theta$ into a condition on $\\Delta p$. First, we solve for $\\cos(\\theta)$:\n$$\n\\cos(\\theta) = -\\frac{a \\Delta p}{2\\sigma}\n$$\nThe cosine function is monotonically decreasing on the interval $[0, \\pi]$, which encompasses all physically relevant contact angles. Therefore, the inequality for $\\theta$ is reversed for $\\cos(\\theta)$:\n$$\n\\cos(\\theta_{r}) \\geq \\cos(\\theta) \\geq \\cos(\\theta_{a})\n$$\nSubstituting the expression for $\\cos(\\theta)$ in terms of $\\Delta p$:\n$$\n\\cos(\\theta_{r}) \\geq -\\frac{a \\Delta p}{2\\sigma} \\geq \\cos(\\theta_{a})\n$$\nTo isolate $\\Delta p$, we multiply the inequality by $-\\frac{2\\sigma}{a}$. Since this is a negative quantity, the inequalities are reversed again:\n$$\n-\\frac{2\\sigma}{a} \\cos(\\theta_{r}) \\leq \\Delta p \\leq -\\frac{2\\sigma}{a} \\cos(\\theta_{a})\n$$\nThis is the criterion for contact line pinning. The contact line slides if $\\Delta p$ falls outside this closed interval. Let's define $\\Delta p_{min} = -\\frac{2\\sigma}{a} \\cos(\\theta_{r})$ and $\\Delta p_{max} = -\\frac{2\\sigma}{a} \\cos(\\theta_{a})$. Sliding (receding) occurs for $\\Delta p < \\Delta p_{min}$, and sliding (advancing) occurs for $\\Delta p > \\Delta p_{max}$.\n\nFinally, we evaluate the quantitative width of the capillary pressure window that sustains pinning. This width, $\\Delta P_{window}$, is the difference between the maximum and minimum pressures consistent with pinning:\n$$\n\\Delta P_{window} = \\Delta p_{max} - \\Delta p_{min}\n$$\n$$\n\\Delta P_{window} = \\left(-\\frac{2\\sigma}{a} \\cos(\\theta_{a})\\right) - \\left(-\\frac{2\\sigma}{a} \\cos(\\theta_{r})\\right)\n$$\n$$\n\\Delta P_{window} = \\frac{2\\sigma}{a} (\\cos(\\theta_{r}) - \\cos(\\theta_{a}))\n$$\nWe are given the following parameters:\n- $\\sigma = 2.0 \\times 10^{-2}\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$\n- $a = 2.0 \\times 10^{-5}\\ \\mathrm{m}$\n- $\\theta_{a} = 80^{\\circ}$\n- $\\theta_{r} = 40^{\\circ}$\n\nThe term $\\frac{2\\sigma}{a}$ evaluates to:\n$$\n\\frac{2 \\times (2.0 \\times 10^{-2}\\ \\mathrm{N}\\,\\mathrm{m}^{-1})}{2.0 \\times 10^{-5}\\ \\mathrm{m}} = 2.0 \\times 10^{3}\\ \\mathrm{N}\\,\\mathrm{m}^{-2} = 2000\\ \\mathrm{Pa}\n$$\nThe trigonometric functions are evaluated using degrees as specified in the angles:\n$$\n\\cos(\\theta_{r}) = \\cos(40^{\\circ}) \\approx 0.7660444\n$$\n$$\n\\cos(\\theta_{a}) = \\cos(80^{\\circ}) \\approx 0.1736482\n$$\nSubstituting these values into the expression for the window width:\n$$\n\\Delta P_{window} = 2000\\ \\mathrm{Pa} \\times (0.7660444 - 0.1736482)\n$$\n$$\n\\Delta P_{window} = 2000\\ \\mathrm{Pa} \\times (0.5923962)\n$$\n$$\n\\Delta P_{window} \\approx 1184.7924\\ \\mathrm{Pa}\n$$\nRounding the result to four significant figures as requested gives $1185\\ \\mathrm{Pa}$.",
            "answer": "$$\\boxed{1.185 \\times 10^{3}}$$"
        },
        {
            "introduction": "Building on fundamental physical principles, the ultimate goal of computational modeling is to simulate the dynamic evolution of the system. This practice provides a capstone experience where you will develop a transient, one-dimensional solver for the thickness of a liquid film subjected to continuous mass deposition and shear-driven flow. By implementing a finite-volume scheme to solve the governing conservation equation, you will gain direct, hands-on insight into how these competing physical processes interact to govern the film's growth, spread, and eventual stabilization into a steady state. ",
            "id": "4066813",
            "problem": "You are given an axisymmetric impinging spray that deposits mass onto a horizontal wall, forming a thin liquid film. The film evolves under the combined influence of a spatially distributed mass source and shear-driven radial outflow. Your task is to compute the transient film thickness field and determine the time at which the film reaches a statistically steady thickness profile.\n\nStart from the conservation of mass applied to a thin film in cylindrical coordinates under axisymmetry. Let the film thickness be $h(r,t)$, the mass source per unit area be $S_m(r)$, the liquid density be $\\rho$, and the depth-averaged radial volumetric flux be $q(r,t)$. Under the lubrication approximation and negligible pressure gradients, the radial velocity profile in the film is driven by an interfacial shear stress $\\tau_w(r)$ from the impinging spray. For a Newtonian liquid of dynamic viscosity $\\mu$, this yields a linear velocity profile with depth-averaged velocity proportional to film thickness and interfacial shear. As a result, the volumetric flux can be modeled as $q(r,t) = k(r)\\,h(r,t)^2$, where $k(r) = \\tau_w(r)/(2\\mu)$. The conservation of mass for the thin film then becomes\n$$\n\\frac{\\partial h}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}\\big(r\\,q(r,t)\\big) = \\frac{S_m(r)}{\\rho}.\n$$\n\nImplement a Computational Fluid Dynamics (CFD) solver using a one-dimensional radial finite-volume scheme with axisymmetric geometry. Discretize the radial domain $r \\in [0,R]$ using $N$ uniformly spaced control volumes of width $\\Delta r$. Place cell centers at $r_i = (i+\\tfrac{1}{2})\\Delta r$ for $i=0,1,\\dots,N-1$, and faces at $r_{i+\\tfrac{1}{2}} = (i+1)\\Delta r$ for $i=-1,0,\\dots,N-1$, with $r_{-1/2} = 0$. Use an explicit time-stepping scheme with time step $\\Delta t$. Impose the symmetry condition $q(0,t) = 0$ at the axis $r=0$, and allow outflow at the outer boundary $r=R$ via upwind flux evaluation. Initialize the film thickness to a small uniform value $h(r,0) = h_0$, where $h_0$ is a positive constant.\n\nDefine the source and shear profiles as\n$$\nS_m(r) = S_0 \\exp\\left(-\\left(\\frac{r}{r_g}\\right)^2\\right), \\quad \\tau_w(r) = \\tau_0 \\exp\\left(-\\left(\\frac{r}{r_t}\\right)^2\\right).\n$$\n\nUse an upwind numerical flux for $q$ at faces, consistent with outward radial flow. At each time step, update $h$ in each cell using a conservative discretization of the divergence term:\n$$\nh_i^{n+1} = h_i^n - \\Delta t \\left[\\frac{1}{r_i}\\frac{r_{i+\\tfrac{1}{2}}q_{i+\\tfrac{1}{2}}^n - r_{i-\\tfrac{1}{2}}q_{i-\\tfrac{1}{2}}^n}{\\Delta r}\\right] + \\Delta t\\,\\frac{S_m(r_i)}{\\rho}.\n$$\n\nDetect statistical steady state by monitoring the maximum absolute rate of change of film thickness across the domain,\n$$\n\\max_i \\left|\\frac{h_i^{n+1} - h_i^n}{\\Delta t}\\right|,\n$$\nand declare the solution statistically steady if this quantity remains strictly below a tolerance $\\varepsilon_{\\text{steady}}$ for at least $N_{\\text{win}}$ consecutive time steps. If the steady criterion is met, record the first time $t$ at which this occurs; if not met by a specified maximum simulation time $T_{\\max}$, return $-1$.\n\nExpress the returned time in seconds.\n\nYour program must implement the above algorithm and apply it to the following test suite. For each test case, use the specified parameters, and report the detected steady time in seconds as a floating-point number. If steady is not reached by $T_{\\max}$, report $-1$.\n\nCommon numerical settings for all test cases:\n- Spatial discretization: $R$ and $\\Delta r$ define $N = R/\\Delta r$ cells.\n- Initial thickness: $h_0 = 10^{-7}\\,\\text{m}$.\n- Upwind flux in the outward radial direction.\n- Clip thickness to be non-negative at all times.\n\nTest suite:\n1. Baseline case (moderate shear and source):\n   - $R = 0.02\\,\\text{m}$, $\\Delta r = 5\\times 10^{-4}\\,\\text{m}$, $\\Delta t = 2\\times 10^{-5}\\,\\text{s}$, $T_{\\max} = 0.6\\,\\text{s}$,\n   - $\\mu = 1.2\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 830\\,\\text{kg}\\cdot\\text{m}^{-3}$,\n   - $S_0 = 0.4\\,\\text{kg}\\cdot\\text{m}^{-2}\\cdot\\text{s}^{-1}$, $r_g = 0.006\\,\\text{m}$,\n   - $\\tau_0 = 3.0\\,\\text{Pa}$, $r_t = 0.008\\,\\text{m}$,\n   - $\\varepsilon_{\\text{steady}} = 3\\times 10^{-6}\\,\\text{m}\\cdot\\text{s}^{-1}$, $N_{\\text{win}} = 150$.\n2. Source-dominated, low shear (short horizon):\n   - $R = 0.02\\,\\text{m}$, $\\Delta r = 5\\times 10^{-4}\\,\\text{m}$, $\\Delta t = 2\\times 10^{-5}\\,\\text{s}$, $T_{\\max} = 0.2\\,\\text{s}$,\n   - $\\mu = 1.2\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 830\\,\\text{kg}\\cdot\\text{m}^{-3}$,\n   - $S_0 = 1.5\\,\\text{kg}\\cdot\\text{m}^{-2}\\cdot\\text{s}^{-1}$, $r_g = 0.006\\,\\text{m}$,\n   - $\\tau_0 = 0.2\\,\\text{Pa}$, $r_t = 0.010\\,\\text{m}$,\n   - $\\varepsilon_{\\text{steady}} = 3\\times 10^{-6}\\,\\text{m}\\cdot\\text{s}^{-1}$, $N_{\\text{win}} = 150$.\n3. High shear, low source (fast stabilization):\n   - $R = 0.02\\,\\text{m}$, $\\Delta r = 5\\times 10^{-4}\\,\\text{m}$, $\\Delta t = 2\\times 10^{-5}\\,\\text{s}$, $T_{\\max} = 0.4\\,\\text{s}$,\n   - $\\mu = 1.2\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 830\\,\\text{kg}\\cdot\\text{m}^{-3}$,\n   - $S_0 = 0.2\\,\\text{kg}\\cdot\\text{m}^{-2}\\cdot\\text{s}^{-1}$, $r_g = 0.005\\,\\text{m}$,\n   - $\\tau_0 = 5.0\\,\\text{Pa}$, $r_t = 0.006\\,\\text{m}$,\n   - $\\varepsilon_{\\text{steady}} = 3\\times 10^{-6}\\,\\text{m}\\cdot\\text{s}^{-1}$, $N_{\\text{win}} = 150$.\n\nFinal output format:\n- Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, in seconds, with each floating-point value formatted using standard Python string conversion (no extra spaces), for example, \"[0.123456,-1,0.098765]\".",
            "solution": "The problem requires the development of a one-dimensional transient solver for the thickness of a thin liquid film, $h(r,t)$, formed by an impinging spray on a flat wall. The solution is derived by applying the finite-volume method to the governing conservation of mass equation in axisymmetric cylindrical coordinates.\n\nThe fundamental principle is the conservation of mass applied to the liquid film. The governing partial differential equation (PDE) is given as:\n$$\n\\frac{\\partial h}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}\\big(r\\,q(r,t)\\big) = \\frac{S_m(r)}{\\rho}\n$$\nwhere $h$ is the film thickness, $t$ is time, $r$ is the radial coordinate, $\\rho$ is the liquid density, $S_m(r)$ is the spatially-distributed mass source per unit area from the spray, and $q(r,t)$ is the depth-averaged radial volumetric flux. The flux is modeled based on shear-driven flow under the lubrication approximation, resulting in $q(r,t) = k(r)h(r,t)^2$, with $k(r) = \\tau_w(r)/(2\\mu)$. Here, $\\tau_w(r)$ is the interfacial shear stress and $\\mu$ is the dynamic viscosity.\n\nTo solve this equation numerically, we employ a finite-volume method. The radial domain $r \\in [0, R]$ is discretized into $N$ control volumes (CVs) of uniform width $\\Delta r$. The $i$-th CV has its center at $r_i = (i+\\frac{1}{2})\\Delta r$ and is bounded by faces at $r_{i-\\frac{1}{2}} = i\\Delta r$ and $r_{i+\\frac{1}{2}} = (i+1)\\Delta r$.\n\nWe integrate the governing PDE over the $i$-th control volume, from $r_{i-\\frac{1}{2}}$ to $r_{i+\\frac{1}{2}}$, and multiply by the area element $2\\pi r dr$:\n$$\n\\int_{r_{i-\\tfrac{1}{2}}}^{r_{i+\\tfrac{1}{2}}} \\left( \\frac{\\partial h}{\\partial t} + \\frac{1}{r}\\frac{\\partial(rq)}{\\partial r} - \\frac{S_m}{\\rho} \\right) 2\\pi r \\, dr = 0\n$$\nAssuming the cell-averaged thickness is $h_i(t) = \\frac{1}{A_i}\\int_{CV_i} h \\, dA$, where the cell area is $A_i = \\pi(r_{i+\\frac{1}{2}}^2 - r_{i-\\frac{1}{2}}^2) = 2\\pi r_i \\Delta r$, the time-derivative term becomes $\\frac{dh_i}{dt}A_i$. Applying the divergence theorem to the flux term, we get the net flux across the cell faces:\n$$\n\\frac{dh_i}{dt} (2\\pi r_i \\Delta r) + \\left[ 2\\pi r q \\right]_{r_{i-\\tfrac{1}{2}}}^{r_{i+\\tfrac{1}{2}}} = \\frac{S_m(r_i)}{\\rho} (2\\pi r_i \\Delta r)\n$$\nDividing by $2\\pi r_i \\Delta r$ yields the semi-discrete form:\n$$\n\\frac{dh_i}{dt} + \\frac{r_{i+\\frac{1}{2}}q_{i+\\frac{1}{2}} - r_{i-\\frac{1}{2}}q_{i-\\frac{1}{2}}}{r_i \\Delta r} = \\frac{S_m(r_i)}{\\rho}\n$$\nHere, $q_{i\\pm\\frac{1}{2}}$ represent the numerical fluxes at the cell faces. For time integration, we use an explicit forward Euler scheme with step size $\\Delta t$. This yields the fully discrete update equation:\n$$\nh_i^{n+1} = h_i^n - \\Delta t \\left[ \\frac{r_{i+\\frac{1}{2}}q_{i+\\frac{1}{2}}^n - r_{i-\\frac{1}{2}}q_{i-\\frac{1}{2}}^n}{r_i \\Delta r} \\right] + \\Delta t \\frac{S_m(r_i)}{\\rho}\n$$\nThe problem specifies an upwind scheme for the numerical flux, consistent with outward radial flow. Since $q=kh^2$ is always non-negative, the flow is always outward. The upwind value for the flux at a face is determined by the state in the cell immediately upstream (i.e., at a smaller radius). Therefore, the flux at the right face of cell $i$, located at $r_{i+\\frac{1}{2}}$, is computed using the thickness $h_i$ from cell $i$:\n$$\nq_{i+\\frac{1}{2}}^n = k(r_{i+\\frac{1}{2}}) (h_i^n)^2\n$$\nSimilarly, the flux at the left face of cell $i$, located at $r_{i-\\frac{1}{2}}$, is $q_{i-\\frac{1}{2}}^n = k(r_{i-\\frac{1}{2}}) (h_{i-1}^n)^2$.\n\nThe boundary conditions are implemented as follows:\n- At the axis of symmetry ($r=0$, face $r_{-1/2}$), the flux is zero: $r_{-1/2}q_{-1/2}^n = 0$.\n- At the outer boundary ($r=R$), outflow is handled naturally by the upwind flux scheme, as the flux at the last face $r_{N-\\frac{1}{2}}$ is computed using the state in the last cell, $h_{N-1}$.\n\nThe algorithm proceeds as follows:\n1.  Initialize the grid, parameters, and the film thickness array $h$ to a uniform small value $h_0$. Pre-compute time-independent arrays for the source term $S_m(r_i)$ and the shear parameter $k(r_{i\\pm\\frac{1}{2}})$.\n2.  Begin the time-stepping loop, which continues until the maximum simulation time $T_{\\max}$ is reached or a steady state is detected.\n3.  In each step, store the current thickness profile $h^n$.\n4.  Calculate the numerical fluxes $q^n_{i+\\frac{1}{2}}$ at all cell faces using the upwind formula and the thickness profile $h^n$.\n5.  Use the fully discrete update equation to compute the new thickness profile $h^{n+1}$.\n6.  Enforce the physical constraint that film thickness must be non-negative by clipping any negative values to zero.\n7.  Check for statistical steady state. This is done by computing the maximum absolute rate of change of thickness across all cells, $\\max_i |(h_i^{n+1}-h_i^n)/\\Delta t|$. If this value is less than a tolerance $\\varepsilon_{\\text{steady}}$, a counter is incremented. If it exceeds the tolerance, the counter is reset.\n8.  If the counter reaches a specified window size $N_{\\text{win}}$, the solution is deemed steady. The time recorded is the time at the beginning of this consecutive window of steady steps, calculated as $t_{\\text{steady}} = (n+1-N_{\\text{win}})\\Delta t$, where $n$ is the current step index. The simulation then terminates.\n9.  If the loop completes without meeting the steady-state criterion, a value of $-1$ is returned.\n\nThis procedure is implemented in Python using the `numpy` library for efficient vectorized array operations, which significantly accelerates the computation of fluxes and the update step across the entire spatial domain.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef run_simulation(R, dr, dt, T_max, mu, rho, S0, rg, tau0, rt, epsilon_steady, N_win, h0):\n    \"\"\"\n    Runs a single simulation case for the film thickness evolution using a\n    finite-volume scheme.\n\n    Args:\n        R (float): Domain radius [m].\n        dr (float): Cell width [m].\n        dt (float): Time step [s].\n        T_max (float): Maximum simulation time [s].\n        mu (float): Dynamic viscosity [Pa.s].\n        rho (float): Liquid density [kg/m^3].\n        S0 (float): Peak mass source [kg/m^2/s].\n        rg (float): Characteristic radius for source [m].\n        tau0 (float): Peak shear stress [Pa].\n        rt (float): Characteristic radius for shear [m].\n        epsilon_steady (float): Tolerance for steady state [m/s].\n        N_win (int): Number of consecutive steps for steady state.\n        h0 (float): Initial film thickness [m].\n\n    Returns:\n        float: The time at which steady state is reached, or -1.0 if not reached.\n    \"\"\"\n    # 1. Discretization and Grid Setup\n    N = int(R / dr)\n    r_c = np.arange(N) * dr + 0.5 * dr  # Cell centers r_i\n    r_f = np.arange(N) * dr + dr       # Right cell faces r_{i+1/2}\n\n    # 2. Pre-compute spatially varying terms\n    # Source term at cell centers, scaled by rho and dt\n    S_m_vec = S0 * np.exp(-(r_c / rg)**2)\n    source_term = (S_m_vec / rho) * dt\n\n    # Shear-driven flux coefficient k(r) at face locations\n    tau_w_f = tau0 * np.exp(-(r_f /rt)**2)\n    k_f = tau_w_f / (2.0 * mu)\n\n    # Pre-compute parts of the divergence term for vectorization\n    divergence_coeffs = dt / (r_c * dr)\n\n    # 3. Initialization\n    h = np.full(N, h0, dtype=np.float64)\n    step_count = 0\n    consecutive_steady_steps = 0\n    steady_time = -1.0\n\n    # 4. Main Time Loop\n    max_steps = int(np.ceil(T_max / dt))\n    for n in range(max_steps):\n        h_old = h.copy()\n\n        # Calculate volumetric flux q at faces (upwind scheme for outward flow)\n        # q_{i+1/2} = k(r_{i+1/2}) * h_i^2\n        q_at_faces = k_f * h_old**2\n\n        # Calculate the divergence term r*q at faces\n        r_q_at_faces = r_f * q_at_faces\n\n        # Vectorized calculation of flux divergence\n        # Create array of fluxes at left faces by shifting the right face flux array\n        # This handles the r_{i-1/2}*q_{i-1/2} term.\n        # Boundary condition q(-1/2)=0 is handled by initializing with zeros.\n        r_q_left = np.zeros(N, dtype=np.float64)\n        r_q_left[1:] = r_q_at_faces[:-1]\n        \n        flux_divergence = r_q_at_faces - r_q_left\n\n        # Update h using the vectorized finite-volume equation\n        h = h_old - divergence_coeffs * flux_divergence + source_term\n\n        # Impose non-negativity constraint\n        h = np.maximum(h, 0.0)\n\n        # 5. Check for Steady State\n        rate_of_change = np.abs(h - h_old) / dt\n        max_rate = np.max(rate_of_change)\n\n        if max_rate  epsilon_steady:\n            consecutive_steady_steps += 1\n        else:\n            consecutive_steady_steps = 0\n\n        if consecutive_steady_steps >= N_win:\n            # Steady state is confirmed. The window of N_win steps just ended.\n            # The first time step in this window was (n + 1 - N_win).\n            # The time at the beginning of that step is (n + 1 - N_win) * dt.\n            steady_time = (n + 1 - N_win) * dt\n            break\n            \n    return steady_time\n\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run simulations, and print results.\n    \"\"\"\n    # Common numerical settings\n    h0 = 1e-7\n\n    # Test suite from the problem statement.\n    test_cases = [\n        # 1. Baseline case\n        {\n            \"R\": 0.02, \"dr\": 5e-4, \"dt\": 2e-5, \"T_max\": 0.6,\n            \"mu\": 1.2e-3, \"rho\": 830,\n            \"S0\": 0.4, \"rg\": 0.006,\n            \"tau0\": 3.0, \"rt\": 0.008,\n            \"epsilon_steady\": 3e-6, \"N_win\": 150\n        },\n        # 2. Source-dominated, low shear\n        {\n            \"R\": 0.02, \"dr\": 5e-4, \"dt\": 2e-5, \"T_max\": 0.2,\n            \"mu\": 1.2e-3, \"rho\": 830,\n            \"S0\": 1.5, \"rg\": 0.006,\n            \"tau0\": 0.2, \"rt\": 0.010,\n            \"epsilon_steady\": 3e-6, \"N_win\": 150\n        },\n        # 3. High shear, low source\n        {\n            \"R\": 0.02, \"dr\": 5e-4, \"dt\": 2e-5, \"T_max\": 0.4,\n            \"mu\": 1.2e-3, \"rho\": 830,\n            \"S0\": 0.2, \"rg\": 0.005,\n            \"tau0\": 5.0, \"rt\": 0.006,\n            \"epsilon_steady\": 3e-6, \"N_win\": 150\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(\n            R=params[\"R\"], dr=params[\"dr\"], dt=params[\"dt\"], T_max=params[\"T_max\"],\n            mu=params[\"mu\"], rho=params[\"rho\"],\n            S0=params[\"S0\"], rg=params[\"rg\"],\n            tau0=params[\"tau0\"], rt=params[\"rt\"],\n            epsilon_steady=params[\"epsilon_steady\"], N_win=params[\"N_win\"],\n            h0=h0\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}