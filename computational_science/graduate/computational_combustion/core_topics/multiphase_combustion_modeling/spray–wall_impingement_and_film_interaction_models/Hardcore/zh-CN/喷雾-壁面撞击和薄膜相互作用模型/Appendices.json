{
    "hands_on_practices": [
        {
            "introduction": "在发动机中，理解壁膜蒸发的速率限制步骤对于准确预测油气混合物的形成至关重要。本练习引入一个类丹姆科勒数（Damköhler-like ratio），用以定量比较液体内部的热传递时间尺度和气体中的质量扩散时间尺度。通过推导和计算该比率，您将深入了解蒸发过程是由热量输运还是由蒸气输运所控制。",
            "id": "4066782",
            "problem": "考虑在内燃机气缸内由喷雾-壁面撞击事件形成的薄碳氢燃料壁膜。撞击后，该液膜与热壁面以及壁面附近的湍流气体相互作用。在许多用于喷雾-壁面撞击和液膜相互作用的计算燃烧子模型中，蒸发的限制机制是通过比较穿过液膜的传热时间尺度与穿过气相侧边界层的物质扩散时间尺度来确定的。定义一个类丹科勒数比 $R$，其值为穿过液膜的特征传热时间尺度与邻近液膜的气体边界层的特征质量扩散时间尺度之比。\n\n从基本输运方程出发，即液膜中的傅里叶定律和瞬态热方程，以及气体边界层中的菲克定律和瞬态物质扩散方程，推导一个用液体导热系数 $k_{l}$、液体密度 $\\rho_{l}$、液体定压比热 $c_{p,l}$、气体中蒸汽的二元扩散系数 $D_{v}$、液膜厚度 $\\delta_{f}$ 和气相侧边界层厚度 $\\delta_{g}$ 表示的 $R$ 的表达式。然后，使用推导出的表达式，根据以下代表高温但亚临界发动机工况下类汽油燃料的属性计算 $R$：\n- $k_{l} = 0.13 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$，\n- $\\rho_{l} = 750 \\ \\mathrm{kg \\ m^{-3}}$，\n- $c_{p,l} = 2000 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$，\n- $D_{v} = 1.5 \\times 10^{-5} \\ \\mathrm{m^{2} \\ s^{-1}}$，\n- $\\delta_{f} = 5.0 \\times 10^{-5} \\ \\mathrm{m}$，\n- $\\delta_{g} = 4.0 \\times 10^{-4} \\ \\mathrm{m}$。\n\n假设在两相中输运均为垂直于壁面的一维输运，并且在所关心的时间尺度上，液膜和气体边界层在法向是层流。根据 $R$ 的大小，讨论蒸发是热量受限 ($R \\gg 1$) 还是扩散受限 ($R \\ll 1$)。将您的 $R$ 的数值答案四舍五入到三位有效数字。以纯数（无量纲）形式表示您的答案。",
            "solution": "本问题要求推导一个类丹科勒数比 $R$，其定义为穿过液膜的特征传热时间尺度 $\\tau_{heat}$ 与邻近的气体边界层的特征质量扩散时间尺度 $\\tau_{diff}$ 之比。该比率是喷雾-壁面相互作用计算子模型中的一个关键参数，因为它决定了燃料膜蒸发的限速机制。\n\n首先，我们推导液膜的特征传热时间尺度 $\\tau_{heat}$。该过程由瞬态热传导控制。假设垂直于壁面的一维输运（坐标为 $y$）和流体性质恒定，则控制偏微分方程为瞬态热方程，也称为傅里叶第二定律：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha_l \\frac{\\partial^2 T}{\\partial y^2} $$\n这里，$T$ 是温度，$t$ 是时间，$\\alpha_l$ 是液体的热扩散率。热扩散率由液体的导热系数 $k_l$、密度 $\\rho_l$ 和定压比热 $c_{p,l}$ 定义为：\n$$ \\alpha_l = \\frac{k_l}{\\rho_l c_{p,l}} $$\n该扩散过程的特征时间尺度可以通过对控制方程进行量纲分析得到。表示温度变化率的左侧项，其尺度为 $\\Delta T / \\tau_{heat}$，其中 $\\Delta T$ 是特征温差，$\\tau_{heat}$ 是特征时间。表示热量扩散的右侧项，其尺度为 $\\alpha_l \\Delta T / \\delta_f^2$，其中 $\\delta_f$ 是特征长度尺度，对应于液膜厚度。令这两项的尺度相等，可得：\n$$ \\frac{1}{\\tau_{heat}} \\sim \\frac{\\alpha_l}{\\delta_f^2} $$\n因此，热量穿过液膜扩散的特征时间尺度为：\n$$ \\tau_{heat} = \\frac{\\delta_f^2}{\\alpha_l} = \\frac{\\rho_l c_{p,l} \\delta_f^2}{k_l} $$\n\n接下来，我们推导气相侧边界层中燃料蒸汽的特征质量扩散时间尺度 $\\tau_{diff}$。该过程由瞬态物质扩散控制。假设一维输运和性质恒定，则控制方程为菲克第二定律：\n$$ \\frac{\\partial Y_v}{\\partial t} = D_v \\frac{\\partial^2 Y_v}{\\partial y^2} $$\n这里，$Y_v$ 是燃料蒸汽的质量分数，$D_v$ 是其在气体中的二元扩散系数。遵循相同的量纲分析步骤，时间项的尺度为 $\\Delta Y_v / \\tau_{diff}$，空间扩散项的尺度为 $D_v \\Delta Y_v / \\delta_g^2$，其中 $\\delta_g$ 是气相侧边界层的特征厚度。令这些尺度相等，可得：\n$$ \\frac{1}{\\tau_{diff}} \\sim \\frac{D_v}{\\delta_g^2} $$\n因此，质量穿过气体边界层扩散的特征时间尺度为：\n$$ \\tau_{diff} = \\frac{\\delta_g^2}{D_v} $$\n\n类丹科勒数比 $R$ 定义为这两个时间尺度之比：\n$$ R = \\frac{\\tau_{heat}}{\\tau_{diff}} $$\n代入推导出的 $\\tau_{heat}$ 和 $\\tau_{diff}$ 的表达式，可得：\n$$ R = \\frac{\\left( \\frac{\\rho_l c_{p,l} \\delta_f^2}{k_l} \\right)}{\\left( \\frac{\\delta_g^2}{D_v} \\right)} $$\n简化此表达式，我们得到用指定属性表示的 $R$ 的最终形式：\n$$ R = \\frac{\\rho_l c_{p,l} D_v \\delta_f^2}{k_l \\delta_g^2} $$\n\n现在，我们使用所提供的数据计算 $R$ 的数值：\n- 液体导热系数: $k_{l} = 0.13 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$\n- 液体密度: $\\rho_{l} = 750 \\ \\mathrm{kg \\ m^{-3}}$\n- 液体比热: $c_{p,l} = 2000 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$\n- 蒸汽扩散系数: $D_{v} = 1.5 \\times 10^{-5} \\ \\mathrm{m^{2} \\ s^{-1}}$\n- 液膜厚度: $\\delta_{f} = 5.0 \\times 10^{-5} \\ \\mathrm{m}$\n- 气体边界层厚度: $\\delta_{g} = 4.0 \\times 10^{-4} \\ \\mathrm{m}$\n\n将这些值代入 $R$ 的表达式中：\n$$ R = \\frac{(750) (2000) (1.5 \\times 10^{-5}) (5.0 \\times 10^{-5})^2}{(0.13) (4.0 \\times 10^{-4})^2} $$\n$$ R = \\frac{(1.5 \\times 10^6) (1.5 \\times 10^{-5}) (2.5 \\times 10^{-9})}{(0.13) (1.6 \\times 10^{-7})} $$\n$$ R = \\frac{5.625 \\times 10^{-8}}{2.08 \\times 10^{-8}} $$\n$$ R \\approx 2.7043269... $$\n将结果四舍五入到三位有效数字，我们得到：\n$$ R \\approx 2.70 $$\n\n该结果的物理解释如下。比值 $R = \\tau_{heat} / \\tau_{diff} \\approx 2.70$ 表明，热量穿过液膜传递的特征时间大约是蒸汽从液膜表面扩散出去的特征时间的 $2.7$ 倍。总蒸发速率受该序列中最慢过程的限制。由于 $R > 1$，较慢的过程是传热。强热量受限蒸发的条件通常表述为 $R \\gg 1$，而扩散受限蒸发对应于 $R \\ll 1$。虽然我们计算出的值在1的数量级，但它明显大于1，这意味着蒸发过程是传热受限的。液膜的蒸发速率不是受限于蒸汽能以多快的速度被输运走，而是受限于所需的汽化潜热能以多快的速度通过液膜传导到其表面。",
            "answer": "$$\\boxed{2.70}$$"
        },
        {
            "introduction": "液膜边缘（即接触线）的行为显著影响其铺展和稳定性。本实践探讨了接触角滞后这一微观尺度现象，该现象导致接触线“钉扎”在表面上。您将基于杨-拉普拉斯方程（Young–Laplace equation）推导接触线保持钉扎或开始滑动的判据，这是计算流体动力学（CFD）液膜模型中一个基本的边界条件。",
            "id": "4066749",
            "problem": "在计算流体动力学（CFD）的喷雾-壁面撞击的计算液膜模型中，壁面上液-气接触线的动态接触角通常被用作自由表面形状和运动的边界条件。在存在接触角滞后的情况下，表观接触角可以在后退角 $\\theta_{r}$ 和前进角 $\\theta_{a}$ 之间变化，而接触线不发生运动（钉扎）。当施加的毛细作用力要求的表观角超出此区间时，接触线会滑动（前进或后退）。考虑壁面上一个局部轴对称的微沟槽，可理想化为半径为 $a$ 的圆柱形毛细管，液膜边缘的弯液面被钉扎于其中。液-气表面张力为 $\\sigma$，且液体压力超过气体压力的部分为局部毛细压力 $\\Delta p$。\n\n从弯曲界面上的压力跳跃的Young-Laplace关系式 $\\Delta p = \\sigma \\kappa$ 和接触角滞后作为接触线上动态接触角 $\\theta$ 的集值边界条件的定义出发，从第一性原理推导滞后如何修正接触线上的有效边界条件。然后，对于圆柱形毛细管几何形状，推导出一个以 $\\Delta p$、$\\theta_{a}$ 和 $\\theta_{r}$ 表示的钉扎与滑动的判据。最后，对于以下参数，评估维持钉扎的毛细压力窗口的定量宽度，该宽度定义为与 $\\theta \\in [\\theta_{r}, \\theta_{a}]$ 一致的最大和最小 $\\Delta p$ 之间的差值：\n- 液-气表面张力 $\\sigma = 2.0 \\times 10^{-2}\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$，\n- 圆柱形微沟槽半径 $a = 2.0 \\times 10^{-5}\\ \\mathrm{m}$，\n- 前进接触角 $\\theta_{a} = 80^{\\circ}$，\n- 后退接触角 $\\theta_{r} = 40^{\\circ}$。\n\n将您的最终数值答案（钉扎窗口宽度）以 $\\mathrm{Pa}$ 为单位表示，并四舍五入至四位有效数字。如果您进行任何三角函数计算，请明确说明您使用的是弧度还是度，并保持一致。",
            "solution": "问题要求三个部分：首先，推导接触角滞后如何修正接触线边界条件；其次，在理想化的圆柱形毛细管中，推导钉扎与滑动的具体判据；第三，根据给定参数，对钉扎的压力窗口进行定量评估。\n\n首先，我们讨论由接触角滞后引起的边界条件的修正。在没有滞后的情况下，三相接触线（液-气-固）由一个单一、唯一的平衡接触角 $\\theta_e$ 表征，该角由Young方程给出。在宏观层面上，由流动或压力变化引起的任何偏离此角度的情况都会导致接触线移动，直到恢复到角度 $\\theta_e$。因此，边界条件是关于角度的单值Dirichlet条件，即 $\\theta = \\theta_e$。\n\n接触角滞后引入了一个显著的修正。由于表面粗糙度、化学异质性或其他物理效应，即使表观接触角 $\\theta$ 发生变化，接触线也可以保持静止，即“钉扎”。这种钉扎发生在由后退接触角 $\\theta_{r}$ 和前进接触角 $\\theta_{a}$ 界定的特定范围内的任何接触角。因此，钉扎接触线的条件不是一个方程，而是一个不等式：\n$$\n\\theta_{r} \\leq \\theta \\leq \\theta_{a}\n$$\n只有当作用在弯液面上的力（如毛细压力）试图将表观接触角驱动到此范围之外时，接触线才会移动（滑动）。如果维持平衡所需的角度变得大于 $\\theta_{a}$，接触线会前进，动态接触角通常被建模为 $\\theta = \\theta_{a}$。如果所需角度变得小于 $\\theta_{r}$，接触线会后退，动态接触角被建模为 $\\theta = \\theta_{r}$。因此，滞后将边界条件从一个单值条件转变为一个用于钉扎的集值条件，并与两个用于运动开始的极限条件相结合。\n\n接下来，我们为指定的圆柱形毛细管几何形状推导钉扎与滑动的判据。出发点是Young-Laplace方程，它将弯曲的液-气界面上的压力差 $\\Delta p$ 与表面张力 $\\sigma$ 和界面的平均曲率 $\\kappa$ 联系起来：\n$$\n\\Delta p = \\sigma \\kappa\n$$\n问题定义了 $\\Delta p = p_{liquid} - p_{gas}$。曲率 $\\kappa$ 的符号取决于约定。我们采用这样的约定：从液相看，对于凸界面，曲率为正。在此约定下，曲率中心一侧的压力更高，Young-Laplace方程写为 $\\Delta p = \\sigma \\kappa$。对于理想化的几何形状，弯液面是一个球冠。半径为 $R$ 的球体具有恒定的平均曲率 $\\kappa = \\frac{2}{R}$（如果为凸）或 $\\kappa = -\\frac{2}{R}$（如果为凹）。\n\n让我们建立毛细管半径 $a$、接触角 $\\theta$ 和弯液面曲率半径 $R$ 之间的关系。通过几何关系可以得到 $a = R |\\cos\\theta|$。一个更严谨的、符号一致的推导如下。设界面的法线从液相指向气相。\n- 如果 $\\theta  \\frac{\\pi}{2}$ ($90^{\\circ}$)，从液相看弯液面是凹的。曲率中心在气相中。曲率为负，$\\kappa = -\\frac{2}{R}$。几何关系是 $a = R \\cos(\\theta)$。因此，$\\Delta p = p_{liquid} - p_{gas} = \\sigma \\kappa = -\\frac{2\\sigma}{R} = -\\frac{2\\sigma \\cos(\\theta)}{a}$。\n- 如果 $\\theta > \\frac{\\pi}{2}$ ($90^{\\circ}$)，从液相看弯液面是凸的。曲率中心在液相中。曲率为正，$\\kappa = \\frac{2}{R}$。几何关系是 $a = R \\cos(\\pi - \\theta) = -R \\cos(\\theta)$。因此，$\\Delta p = p_{liquid} - p_{gas} = \\sigma \\kappa = \\frac{2\\sigma}{R} = \\frac{2\\sigma}{-a/\\cos(\\theta)} = -\\frac{2\\sigma \\cos(\\theta)}{a}$。\n在两种情况下，我们都得到了相同的稳健关系：\n$$\n\\Delta p = -\\frac{2\\sigma}{a} \\cos(\\theta)\n$$\n这个方程将施加的毛细压力 $\\Delta p$ 与产生的表观接触角 $\\theta$ 联系起来。\n\n只要此角度 $\\theta$ 在滞后范围 $\\theta_{r} \\leq \\theta \\leq \\theta_{a}$ 内，接触线就保持钉扎。我们可以将这个关于 $\\theta$ 的条件转换成关于 $\\Delta p$ 的条件。首先，我们求解 $\\cos(\\theta)$：\n$$\n\\cos(\\theta) = -\\frac{a \\Delta p}{2\\sigma}\n$$\n余弦函数在区间 $[0, \\pi]$上是单调递减的，该区间包含了所有物理上相关的接触角。因此，对于 $\\cos(\\theta)$，$\\theta$ 的不等式关系会反转：\n$$\n\\cos(\\theta_{r}) \\geq \\cos(\\theta) \\geq \\cos(\\theta_{a})\n$$\n将以 $\\Delta p$ 表示的 $\\cos(\\theta)$ 表达式代入：\n$$\n\\cos(\\theta_{r}) \\geq -\\frac{a \\Delta p}{2\\sigma} \\geq \\cos(\\theta_{a})\n$$\n为了分离出 $\\Delta p$，我们给不等式两边乘以 $-\\frac{2\\sigma}{a}$。由于这是一个负数，不等号再次反转：\n$$\n-\\frac{2\\sigma}{a} \\cos(\\theta_{r}) \\leq \\Delta p \\leq -\\frac{2\\sigma}{a} \\cos(\\theta_{a})\n$$\n这就是接触线钉扎的判据。如果 $\\Delta p$ 落在此闭区间之外，接触线就会滑动。我们定义 $\\Delta p_{min} = -\\frac{2\\sigma}{a} \\cos(\\theta_{r})$ 和 $\\Delta p_{max} = -\\frac{2\\sigma}{a} \\cos(\\theta_{a})$。当 $\\Delta p  \\Delta p_{min}$ 时发生滑动（后退），当 $\\Delta p > \\Delta p_{max}$ 时发生滑动（前进）。\n\n最后，我们评估维持钉扎的毛细压力窗口的定量宽度。这个宽度，$\\Delta P_{window}$，是与钉扎相符的最大和最小压力之差：\n$$\n\\Delta P_{window} = \\Delta p_{max} - \\Delta p_{min}\n$$\n$$\n\\Delta P_{window} = \\left(-\\frac{2\\sigma}{a} \\cos(\\theta_{a})\\right) - \\left(-\\frac{2\\sigma}{a} \\cos(\\theta_{r})\\right)\n$$\n$$\n\\Delta P_{window} = \\frac{2\\sigma}{a} (\\cos(\\theta_{r}) - \\cos(\\theta_{a}))\n$$\n给定以下参数：\n- $\\sigma = 2.0 \\times 10^{-2}\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$\n- $a = 2.0 \\times 10^{-5}\\ \\mathrm{m}$\n- $\\theta_{a} = 80^{\\circ}$\n- $\\theta_{r} = 40^{\\circ}$\n\n项 $\\frac{2\\sigma}{a}$ 的计算结果为：\n$$\n\\frac{2 \\times (2.0 \\times 10^{-2}\\ \\mathrm{N}\\,\\mathrm{m}^{-1})}{2.0 \\times 10^{-5}\\ \\mathrm{m}} = 2.0 \\times 10^{3}\\ \\mathrm{N}\\,\\mathrm{m}^{-2} = 2000\\ \\mathrm{Pa}\n$$\n三角函数的计算使用角度中指定的单位“度”：\n$$\n\\cos(\\theta_{r}) = \\cos(40^{\\circ}) \\approx 0.7660444\n$$\n$$\n\\cos(\\theta_{a}) = \\cos(80^{\\circ}) \\approx 0.1736482\n$$\n将这些值代入窗口宽度的表达式中：\n$$\n\\Delta P_{window} = 2000\\ \\mathrm{Pa} \\times (0.7660444 - 0.1736482)\n$$\n$$\n\\Delta P_{window} = 2000\\ \\mathrm{Pa} \\times (0.5923962)\n$$\n$$\n\\Delta P_{window} \\approx 1184.7924\\ \\mathrm{Pa}\n$$\n根据要求将结果四舍五入到四位有效数字，得到 $1185\\ \\mathrm{Pa}$。",
            "answer": "$$\\boxed{1.185 \\times 10^{3}}$$"
        },
        {
            "introduction": "从局部物理分析转向系统级理解，需要对整个液膜的演变进行模拟。这个编码实践将挑战您开发一个一维有限体积求解器，用以计算由撞击壁面的喷雾所形成的液膜的瞬态厚度。通过实施控制守恒方程，您将直接应用数值方法来模拟液膜在质量沉积和剪切力共同作用下的生长与扩展过程。",
            "id": "4066813",
            "problem": "给定一个轴对称撞击喷雾，它将质量沉积在水平壁面上，形成一层薄液膜。该液膜在空间分布的质量源和剪切驱动的径向外流的共同影响下演化。您的任务是计算瞬态膜厚场，并确定液膜达到统计稳态膜厚剖面的时间。\n\n从应用于轴对称柱坐标系下薄液膜的质量守恒开始。设膜厚为 $h(r,t)$，单位面积质量源为 $S_m(r)$，液体密度为 $\\rho$，深度平均的径向体积通量为 $q(r,t)$。在润滑近似和可忽略的压力梯度下，液膜中的径向速度剖面由撞击喷雾产生的界面剪切应力 $\\tau_w(r)$ 驱动。对于动力粘度为 $\\mu$ 的牛顿流体，这将产生一个线性的速度剖面，其深度平均速度与膜厚和界面剪切成正比。因此，体积通量可建模为 $q(r,t) = k(r)\\,h(r,t)^2$，其中 $k(r) = \\tau_w(r)/(2\\mu)$。薄液膜的质量守恒方程则变为\n$$\n\\frac{\\partial h}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}\\big(r\\,q(r,t)\\big) = \\frac{S_m(r)}{\\rho}.\n$$\n\n使用一维径向有限体积格式和轴对称几何，实现一个计算流体动力学 (CFD) 求解器。使用 $N$ 个宽度为 $\\Delta r$ 的均匀间隔控制体对径向域 $r \\in [0,R]$ 进行离散化。将网格中心置于 $r_i = (i+\\tfrac{1}{2})\\Delta r$（其中 $i=0,1,\\dots,N-1$），并将网格面置于 $r_{i+\\tfrac{1}{2}} = (i+1)\\Delta r$（其中 $i=-1,0,\\dots,N-1$），且 $r_{-1/2} = 0$。使用时间步长为 $\\Delta t$ 的显式时间步进格式。在轴线 $r=0$ 处施加对称条件 $q(0,t) = 0$，并在外边界 $r=R$ 处通过迎风格式通量计算允许流出。将膜厚初始化为一个小的均匀值 $h(r,0) = h_0$，其中 $h_0$ 是一个正常数。\n\n将源项和剪切剖面定义为\n$$\nS_m(r) = S_0 \\exp\\left(-\\left(\\frac{r}{r_g}\\right)^2\\right), \\quad \\tau_w(r) = \\tau_0 \\exp\\left(-\\left(\\frac{r}{r_t}\\right)^2\\right).\n$$\n\n在网格面上对 $q$ 使用与径向外流一致的迎风数值通量。在每个时间步，使用散度项的守恒离散化来更新每个网格中的 $h$：\n$$\nh_i^{n+1} = h_i^n - \\Delta t \\left[\\frac{1}{r_i}\\frac{r_{i+\\tfrac{1}{2}}q_{i+\\tfrac{1}{2}}^n - r_{i-\\tfrac{1}{2}}q_{i-\\tfrac{1}{2}}^n}{\\Delta r}\\right] + \\Delta t\\,\\frac{S_m(r_i)}{\\rho}.\n$$\n\n通过监测整个域上膜厚度的最大绝对变化率来检测统计稳态，\n$$\n\\max_i \\left|\\frac{h_i^{n+1} - h_i^n}{\\Delta t}\\right|,\n$$\n如果该量连续至少 $N_{\\text{win}}$ 个时间步严格低于容差 $\\varepsilon_{\\text{steady}}$，则宣布解达到统计稳态。如果满足稳态准则，记录第一次出现这种情况的时间 $t$；如果在指定的最大模拟时间 $T_{\\max}$ 前未满足，则返回 $-1$。\n\n返回的时间以秒为单位。\n\n您的程序必须实现上述算法并将其应用于以下测试套件。对于每个测试案例，使用指定的参数，并以浮点数形式报告检测到的稳态时间（单位为秒）。如果在 $T_{\\max}$ 前未达到稳态，则报告 $-1$。\n\n所有测试案例的通用数值设置：\n- 空间离散化：$R$ 和 $\\Delta r$ 定义了 $N = R/\\Delta r$ 个网格。\n- 初始厚度：$h_0 = 10^{-7}\\,\\text{m}$。\n- 径向外流方向采用迎风通量。\n- 在任何时候都将厚度裁剪为非负值。\n\n测试套件：\n1. 基准案例（中等剪切和源项）：\n   - $R = 0.02\\,\\text{m}$，$\\Delta r = 5\\times 10^{-4}\\,\\text{m}$，$\\Delta t = 2\\times 10^{-5}\\,\\text{s}$，$T_{\\max} = 0.6\\,\\text{s}$，\n   - $\\mu = 1.2\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 830\\,\\text{kg}\\cdot\\text{m}^{-3}$，\n   - $S_0 = 0.4\\,\\text{kg}\\cdot\\text{m}^{-2}\\cdot\\text{s}^{-1}$，$r_g = 0.006\\,\\text{m}$，\n   - $\\tau_0 = 3.0\\,\\text{Pa}$，$r_t = 0.008\\,\\text{m}$，\n   - $\\varepsilon_{\\text{steady}} = 3\\times 10^{-6}\\,\\text{m}\\cdot\\text{s}^{-1}$，$N_{\\text{win}} = 150$。\n2. 源项主导，低剪切（短时间范围）：\n   - $R = 0.02\\,\\text{m}$，$\\Delta r = 5\\times 10^{-4}\\,\\text{m}$，$\\Delta t = 2\\times 10^{-5}\\,\\text{s}$，$T_{\\max} = 0.2\\,\\text{s}$，\n   - $\\mu = 1.2\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 830\\,\\text{kg}\\cdot\\text{m}^{-3}$，\n   - $S_0 = 1.5\\,\\text{kg}\\cdot\\text{m}^{-2}\\cdot\\text{s}^{-1}$，$r_g = 0.006\\,\\text{m}$，\n   - $\\tau_0 = 0.2\\,\\text{Pa}$，$r_t = 0.010\\,\\text{m}$，\n   - $\\varepsilon_{\\text{steady}} = 3\\times 10^{-6}\\,\\text{m}\\cdot\\text{s}^{-1}$，$N_{\\text{win}} = 150$。\n3. 高剪切，低源项（快速稳定）：\n   - $R = 0.02\\,\\text{m}$，$\\Delta r = 5\\times 10^{-4}\\,\\text{m}$，$\\Delta t = 2\\times 10^{-5}\\,\\text{s}$，$T_{\\max} = 0.4\\,\\text{s}$，\n   - $\\mu = 1.2\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 830\\,\\text{kg}\\cdot\\text{m}^{-3}$，\n   - $S_0 = 0.2\\,\\text{kg}\\cdot\\text{m}^{-2}\\cdot\\text{s}^{-1}$，$r_g = 0.005\\,\\text{m}$，\n   - $\\tau_0 = 5.0\\,\\text{Pa}$，$r_t = 0.006\\,\\text{m}$，\n   - $\\varepsilon_{\\text{steady}} = 3\\times 10^{-6}\\,\\text{m}\\cdot\\text{s}^{-1}$，$N_{\\text{win}} = 150$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个结果，形式为方括号内以逗号分隔的列表，单位为秒，每个浮点值使用标准 Python 字符串转换格式化（无额外空格），例如，“[0.123456,-1,0.098765]”。",
            "solution": "该问题要求为由撞击喷雾在平坦壁面上形成的薄液膜厚度 $h(r,t)$ 开发一个一维瞬态求解器。该解是通过将有限体积法应用于轴对称柱坐标系下的质量守恒控制方程而得到的。\n\n其基本原理是应用于液膜的质量守恒。控制偏微分方程 (PDE) 如下所示：\n$$\n\\frac{\\partial h}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}\\big(r\\,q(r,t)\\big) = \\frac{S_m(r)}{\\rho}\n$$\n其中 $h$ 是膜厚，$t$ 是时间，$r$ 是径向坐标，$\\rho$ 是液体密度，$S_m(r)$ 是来自喷雾的单位面积空间分布质量源，$q(r,t)$ 是深度平均的径向体积通量。该通量基于润滑近似下的剪切驱动流进行建模，得到 $q(r,t) = k(r)h(r,t)^2$，其中 $k(r) = \\tau_w(r)/(2\\mu)$。这里，$\\tau_w(r)$ 是界面剪切应力，$\\mu$ 是动力粘度。\n\n为了数值求解该方程，我们采用有限体积法。将径向域 $r \\in [0, R]$ 离散为 $N$ 个宽度均匀的控制体 (CVs)，宽度为 $\\Delta r$。第 $i$ 个控制体的中心位于 $r_i = (i+\\frac{1}{2})\\Delta r$，其边界为位于 $r_{i-\\frac{1}{2}} = i\\Delta r$ 和 $r_{i+\\frac{1}{2}} = (i+1)\\Delta r$ 的网格面。\n\n我们将控制偏微分方程在第 $i$ 个控制体上（从 $r_{i-\\frac{1}{2}}$ 到 $r_{i+\\frac{1}{2}}$）积分，并乘以面积元 $2\\pi r dr$：\n$$\n\\int_{r_{i-\\tfrac{1}{2}}}^{r_{i+\\tfrac{1}{2}}} \\left( \\frac{\\partial h}{\\partial t} + \\frac{1}{r}\\frac{\\partial(rq)}{\\partial r} - \\frac{S_m}{\\rho} \\right) 2\\pi r \\, dr = 0\n$$\n假设网格平均厚度为 $h_i(t) = \\frac{1}{A_i}\\int_{CV_i} h \\, dA$，其中网格面积为 $A_i = \\pi(r_{i+\\frac{1}{2}}^2 - r_{i-\\frac{1}{2}}^2) = 2\\pi r_i \\Delta r$，则时间导数项变为 $\\frac{dh_i}{dt}A_i$。对通量项应用散度定理，我们得到穿过网格面的净通量：\n$$\n\\frac{dh_i}{dt} (2\\pi r_i \\Delta r) + \\left[ 2\\pi r q \\right]_{r_{i-\\tfrac{1}{2}}}^{r_{i+\\tfrac{1}{2}}} = \\frac{S_m(r_i)}{\\rho} (2\\pi r_i \\Delta r)\n$$\n除以 $2\\pi r_i \\Delta r$ 得到半离散形式：\n$$\n\\frac{dh_i}{dt} + \\frac{r_{i+\\frac{1}{2}}q_{i+\\frac{1}{2}} - r_{i-\\frac{1}{2}}q_{i-\\frac{1}{2}}}{r_i \\Delta r} = \\frac{S_m(r_i)}{\\rho}\n$$\n这里，$q_{i\\pm\\frac{1}{2}}$ 表示网格面上的数值通量。对于时间积分，我们使用步长为 $\\Delta t$ 的显式前向欧拉格式。这得到了全离散更新方程：\n$$\nh_i^{n+1} = h_i^n - \\Delta t \\left[ \\frac{r_{i+\\frac{1}{2}}q_{i+\\frac{1}{2}}^n - r_{i-\\frac{1}{2}}q_{i-\\frac{1}{2}}^n}{r_i \\Delta r} \\right] + \\Delta t \\frac{S_m(r_i)}{\\rho}\n$$\n问题指定了与径向外流一致的迎风格式用于数值通量。由于 $q=kh^2$ 始终为非负值，流动总是向外的。面上通量的迎风值由紧邻上游（即较小半径处）的网格状态决定。因此，位于 $r_{i+\\frac{1}{2}}$ 的第 $i$ 个网格右侧面上的通量，是使用第 $i$ 个网格的厚度 $h_i$ 计算的：\n$$\nq_{i+\\frac{1}{2}}^n = k(r_{i+\\frac{1}{2}}) (h_i^n)^2\n$$\n类似地，位于 $r_{i-\\frac{1}{2}}$ 的第 $i$ 个网格左侧面上的通量为 $q_{i-\\frac{1}{2}}^n = k(r_{i-\\frac{1}{2}}) (h_{i-1}^n)^2$。\n\n边界条件实现如下：\n- 在对称轴（$r=0$，面 $r_{-1/2}$）处，通量为零：$r_{-1/2}q_{-1/2}^n = 0$。\n- 在外边界（$r=R$）处，流出由迎风通量格式自然处理，因为最后一个面 $r_{N-\\frac{1}{2}}$ 的通量是使用最后一个网格 $h_{N-1}$ 的状态计算的。\n\n算法流程如下：\n1.  初始化网格、参数以及膜厚数组 $h$ 为一个小的均匀值 $h_0$。预计算不随时间变化的源项 $S_m(r_i)$ 和剪切参数 $k(r_{i\\pm\\frac{1}{2}})$ 的数组。\n2.  开始时间步循环，直到达到最大模拟时间 $T_{\\max}$ 或检测到稳态。\n3.  在每个步骤中，存储当前的厚度剖面 $h^n$。\n4.  使用迎风公式和厚度剖面 $h^n$ 计算所有网格面上的数值通量 $q^n_{i+\\frac{1}{2}}$。\n5.  使用全离散更新方程计算新的厚度剖面 $h^{n+1}$。\n6.  通过将任何负值裁剪为零来强制执行膜厚必须为非负的物理约束。\n7.  检查统计稳态。通过计算所有网格中厚度的最大绝对变化率 $\\max_i |(h_i^{n+1}-h_i^n)/\\Delta t|$ 来实现。如果该值小于容差 $\\varepsilon_{\\text{steady}}$，则计数器递增。如果超过容差，则重置计数器。\n8.  如果计数器达到指定的窗口大小 $N_{\\text{win}}$，则认为解是稳定的。记录的时间是这个连续稳定步窗口开始时的时间，计算为 $t_{\\text{steady}} = (n+1-N_{\\text{win}})\\Delta t$，其中 $n$ 是当前步的索引。然后模拟终止。\n9.  如果循环完成而未满足稳态准则，则返回 -1。\n\n该过程在 Python 中使用 `numpy` 库实现，以进行高效的向量化数组操作，这显著加快了整个空间域上通量计算和更新步骤的速度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef run_simulation(R, dr, dt, T_max, mu, rho, S0, rg, tau0, rt, epsilon_steady, N_win, h0):\n    \"\"\"\n    Runs a single simulation case for the film thickness evolution using a\n    finite-volume scheme.\n\n    Args:\n        R (float): Domain radius [m].\n        dr (float): Cell width [m].\n        dt (float): Time step [s].\n        T_max (float): Maximum simulation time [s].\n        mu (float): Dynamic viscosity [Pa.s].\n        rho (float): Liquid density [kg/m^3].\n        S0 (float): Peak mass source [kg/m^2/s].\n        rg (float): Characteristic radius for source [m].\n        tau0 (float): Peak shear stress [Pa].\n        rt (float): Characteristic radius for shear [m].\n        epsilon_steady (float): Tolerance for steady state [m/s].\n        N_win (int): Number of consecutive steps for steady state.\n        h0 (float): Initial film thickness [m].\n\n    Returns:\n        float: The time at which steady state is reached, or -1.0 if not reached.\n    \"\"\"\n    # 1. Discretization and Grid Setup\n    N = int(R / dr)\n    r_c = np.arange(N) * dr + 0.5 * dr  # Cell centers r_i\n    r_f = np.arange(N) * dr + dr       # Right cell faces r_{i+1/2}\n\n    # 2. Pre-compute spatially varying terms\n    # Source term at cell centers, scaled by rho and dt\n    S_m_vec = S0 * np.exp(-(r_c / rg)**2)\n    source_term = (S_m_vec / rho) * dt\n\n    # Shear-driven flux coefficient k(r) at face locations\n    tau_w_f = tau0 * np.exp(-(r_f /rt)**2)\n    k_f = tau_w_f / (2.0 * mu)\n\n    # Pre-compute parts of the divergence term for vectorization\n    divergence_coeffs = dt / (r_c * dr)\n\n    # 3. Initialization\n    h = np.full(N, h0, dtype=np.float64)\n    step_count = 0\n    consecutive_steady_steps = 0\n    steady_time = -1.0\n\n    # 4. Main Time Loop\n    max_steps = int(np.ceil(T_max / dt))\n    for n in range(max_steps):\n        h_old = h.copy()\n\n        # Calculate volumetric flux q at faces (upwind scheme for outward flow)\n        # q_{i+1/2} = k(r_{i+1/2}) * h_i^2\n        q_at_faces = k_f * h_old**2\n\n        # Calculate the divergence term r*q at faces\n        r_q_at_faces = r_f * q_at_faces\n\n        # Vectorized calculation of flux divergence\n        # Create array of fluxes at left faces by shifting the right face flux array\n        # This handles the r_{i-1/2}*q_{i-1/2} term.\n        # Boundary condition q(-1/2)=0 is handled by initializing with zeros.\n        r_q_left = np.zeros(N, dtype=np.float64)\n        r_q_left[1:] = r_q_at_faces[:-1]\n        \n        flux_divergence = r_q_at_faces - r_q_left\n\n        # Update h using the vectorized finite-volume equation\n        h = h_old - divergence_coeffs * flux_divergence + source_term\n\n        # Impose non-negativity constraint\n        h = np.maximum(h, 0.0)\n\n        # 5. Check for Steady State\n        rate_of_change = np.abs(h - h_old) / dt\n        max_rate = np.max(rate_of_change)\n\n        if max_rate  epsilon_steady:\n            consecutive_steady_steps += 1\n        else:\n            consecutive_steady_steps = 0\n\n        if consecutive_steady_steps >= N_win:\n            # Steady state is confirmed. The window of N_win steps just ended.\n            # The first time step in this window was (n + 1 - N_win).\n            # The time at the beginning of that step is (n + 1 - N_win) * dt.\n            steady_time = (n + 1 - N_win) * dt\n            break\n            \n    return steady_time\n\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run simulations, and print results.\n    \"\"\"\n    # Common numerical settings\n    h0 = 1e-7\n\n    # Test suite from the problem statement.\n    test_cases = [\n        # 1. Baseline case\n        {\n            \"R\": 0.02, \"dr\": 5e-4, \"dt\": 2e-5, \"T_max\": 0.6,\n            \"mu\": 1.2e-3, \"rho\": 830,\n            \"S0\": 0.4, \"rg\": 0.006,\n            \"tau0\": 3.0, \"rt\": 0.008,\n            \"epsilon_steady\": 3e-6, \"N_win\": 150\n        },\n        # 2. Source-dominated, low shear\n        {\n            \"R\": 0.02, \"dr\": 5e-4, \"dt\": 2e-5, \"T_max\": 0.2,\n            \"mu\": 1.2e-3, \"rho\": 830,\n            \"S0\": 1.5, \"rg\": 0.006,\n            \"tau0\": 0.2, \"rt\": 0.010,\n            \"epsilon_steady\": 3e-6, \"N_win\": 150\n        },\n        # 3. High shear, low source\n        {\n            \"R\": 0.02, \"dr\": 5e-4, \"dt\": 2e-5, \"T_max\": 0.4,\n            \"mu\": 1.2e-3, \"rho\": 830,\n            \"S0\": 0.2, \"rg\": 0.005,\n            \"tau0\": 5.0, \"rt\": 0.006,\n            \"epsilon_steady\": 3e-6, \"N_win\": 150\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(\n            R=params[\"R\"], dr=params[\"dr\"], dt=params[\"dt\"], T_max=params[\"T_max\"],\n            mu=params[\"mu\"], rho=params[\"rho\"],\n            S0=params[\"S0\"], rg=params[\"rg\"],\n            tau0=params[\"tau0\"], rt=params[\"rt\"],\n            epsilon_steady=params[\"epsilon_steady\"], N_win=params[\"N_win\"],\n            h0=h0\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}