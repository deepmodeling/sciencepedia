{
    "hands_on_practices": [
        {
            "introduction": "在流体体积法-分段线性界面重构(VOF-PLIC)方法中，其核心思想是在计算网格内用一个平面来近似相界面。本次实践将深入探讨体积分数 $\\alpha$、界面法向量 $\\mathbf{n}$ 和平面位置之间的基本几何关系。掌握这项计算是构建稳健的VOF求解器的第一步。",
            "id": "4076438",
            "problem": "使用分段线性界面重构 (PLIC) 的流体体积法 (VOF) 在一个边长为 $\\Delta$ 的立方计算单元内，通过方程为 $\\mathbf{n} \\cdot \\mathbf{x} = c$ 的平面来近似气液界面，其中 $\\mathbf{n}$ 是单位法向量，$c$ 是一个平面常数。规定液体占据单元内 $\\mathbf{n} \\cdot \\mathbf{x} \\le c$ 的半空间。设该单元坐标轴对齐，坐标 $\\mathbf{x} = (x,y,z)$ 从立方体的一个角点（原点）开始度量，因此单元域为 $[0,\\Delta] \\times [0,\\Delta] \\times [0,\\Delta]$。给定液体体积分数 $\\alpha = 0.3$ 和单位法向量 $\\mathbf{n} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$，请从第一性原理推导无量纲平面常数 $\\tilde{c} \\equiv \\frac{c}{\\Delta}$ 的表达式，该常数能在单元内得到正确的液体体积分数 $\\alpha$。请将你的最终答案表示为 $\\tilde{c}$ 的一个精确解析表达式（无需四舍五入）。",
            "solution": "该问题要求解一个立方单元内分段线性界面重构 (PLIC) 的无量纲平面常数 $\\tilde{c}$。给定了液体体积分数 $\\alpha$、单元几何形状以及界面法向量 $\\mathbf{n}$。求解过程通过将液体体积分数与由平面方程定义的液体区域的几何形状联系起来。\n\n计算单元是一个由域 $\\mathcal{C} = [0, \\Delta] \\times [0, \\Delta] \\times [0, \\Delta]$ 定义的立方体。其总体积为 $V_{cell} = \\Delta^3$。\n\n气液界面由平面 $\\mathbf{n} \\cdot \\mathbf{x} = c$ 近似。液体被定义为占据半空间 $\\mathbf{n} \\cdot \\mathbf{x} \\le c$。单元内的液体体积 $V_L$ 是区域 $\\{\\mathbf{x} \\in \\mathcal{C} \\mid \\mathbf{n} \\cdot \\mathbf{x} \\le c\\}$ 的体积。\n\n液体体积分数 $\\alpha$ 定义为液体体积与单元总体积之比：\n$$ \\alpha = \\frac{V_L}{V_{cell}} = \\frac{V_L}{\\Delta^3} $$\n给定 $\\alpha = 0.3$ 和单位法向量 $\\mathbf{n} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$。界面方程为：\n$$ \\frac{1}{\\sqrt{2}}x + \\frac{1}{\\sqrt{2}}y + 0z = c \\implies x+y = \\sqrt{2}c $$\n为了简化几何计算，我们引入无量纲坐标 $\\tilde{\\mathbf{x}} = (\\tilde{x}, \\tilde{y}, \\tilde{z})$，其中 $\\tilde{x}=x/\\Delta$，$\\tilde{y}=y/\\Delta$，$\\tilde{z}=z/\\Delta$。在这些坐标下，该单元是一个单位立方体 $\\tilde{\\mathcal{C}} = [0, 1] \\times [0, 1] \\times [0, 1]$。\n将 $\\mathbf{x} = \\Delta\\tilde{\\mathbf{x}}$ 代入液体区域的定义：\n$$ \\mathbf{n} \\cdot (\\Delta \\tilde{\\mathbf{x}}) \\le c \\implies \\mathbf{n} \\cdot \\tilde{\\mathbf{x}} \\le \\frac{c}{\\Delta} $$\n题目将无量纲平面常数定义为 $\\tilde{c} \\equiv c/\\Delta$。因此，单位立方体中的液体区域由 $\\mathbf{n} \\cdot \\tilde{\\mathbf{x}} \\le \\tilde{c}$ 定义。\n根据定义，体积分数 $\\alpha$ 是单位立方体内液体区域的体积：\n$$ \\alpha = \\text{Volume}(\\{\\tilde{\\mathbf{x}} \\in \\tilde{\\mathcal{C}} \\mid \\mathbf{n} \\cdot \\tilde{\\mathbf{x}} \\le \\tilde{c}\\}) $$\n代入给定的法向量：\n$$ \\frac{1}{\\sqrt{2}}\\tilde{x} + \\frac{1}{\\sqrt{2}}\\tilde{y} \\le \\tilde{c} $$\n定义界面的平面与 $\\tilde{z}$ 坐标无关，这意味着它是一个平行于 $\\tilde{z}$ 轴的垂直平面。因此，液体区域的体积是 $\\tilde{x}$-$\\tilde{y}$ 平面中二维液体区域的面积与立方体高度（为1）的乘积。\n所以，$\\alpha$ 等于单位正方形 $[0, 1] \\times [0, 1]$ 中由以下公式定义的区域 $A$ 的面积：\n$$ A = \\left\\{(\\tilde{x}, \\tilde{y}) \\in [0, 1]^2 \\mid \\frac{\\tilde{x}}{\\sqrt{2}} + \\frac{\\tilde{y}}{\\sqrt{2}} \\le \\tilde{c}\\right\\} $$\n这个不等式可以重写为 $\\tilde{x} + \\tilde{y} \\le \\sqrt{2}\\tilde{c}$。我们定义一个参数 $d = \\sqrt{2}\\tilde{c}$。问题简化为在单位正方形内求出区域 $\\tilde{x} + \\tilde{y} \\le d$ 的面积。\n\n这个区域的形状取决于 $d$ 的值。函数 $f(\\tilde{x}, \\tilde{y}) = \\tilde{x}+\\tilde{y}$ 在单位正方形内，于 $(\\tilde{x}, \\tilde{y})=(0,0)$ 处取到最小值0，于 $(\\tilde{x}, \\tilde{y})=(1,1)$ 处取到最大值2。因此，我们只需要考虑 $d \\in [0, 2]$。\n\n我们根据直线 $\\tilde{x} + \\tilde{y} = d$ 的位置区分两种情况：\n\n情况1：$0 \\le d \\le 1$。\n该直线与 $\\tilde{x}$ 轴相交于 $(\\tilde{x},0)=(d,0)$，与 $\\tilde{y}$ 轴相交于 $(0,\\tilde{y})=(0,d)$。两个交点都位于单位正方形的边上。区域 $\\tilde{x} + \\tilde{y} \\le d$ 形成一个顶点为 $(0,0)$、$(d,0)$ 和 $(0,d)$ 的直角三角形。该三角形的面积为：\n$$ \\alpha(d) = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} d \\cdot d = \\frac{1}{2}d^2 $$\n这种情况适用于体积分数 $\\alpha \\in [0, \\frac{1}{2}(1)^2]$，即 $\\alpha \\in [0, 0.5]$。\n\n情况2：$1  d \\le 2$。\n直线 $\\tilde{x} + \\tilde{y} = d$ 不再与原点形成一个简单的三角形。液体区域是一个五边形。更简单的方法是计算“气体”区域（即 $\\tilde{x} + \\tilde{y} > d$ 的区域）的面积，然后从正方形的总面积（为1）中减去它。气体区域是位于角点 $(1,1)$ 的一个三角形。其顶点为 $(d-1, 1)$、$(1, d-1)$ 和 $(1,1)$。该三角形沿正方形边的两条边的长度为 $1 - (d-1) = 2-d$。这个气体三角形的面积是 $\\frac{1}{2}(2-d)^2$。因此，液体面积（体积分数）为：\n$$ \\alpha(d) = 1 - \\frac{1}{2}(2-d)^2 $$\n这种情况适用于体积分数 $\\alpha \\in (0.5, 1]$。\n\n题目指定液体体积分数 $\\alpha = 0.3$。由于 $0 \\le 0.3 \\le 0.5$，我们属于情况1。我们使用公式 $\\alpha = \\frac{1}{2}d^2$。\n$$ 0.3 = \\frac{1}{2}d^2 $$\n$$ d^2 = 2 \\times 0.3 = 0.6 = \\frac{6}{10} = \\frac{3}{5} $$\n由于 $d$ 对应于一个几何构型，我们取正根：\n$$ d = \\sqrt{\\frac{3}{5}} $$\n最后，我们回顾 $d$ 用 $\\tilde{c}$ 表示的定义：\n$$ d = \\sqrt{2}\\tilde{c} $$\n求解 $\\tilde{c}$：\n$$ \\tilde{c} = \\frac{d}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}} \\sqrt{\\frac{3}{5}} = \\sqrt{\\frac{1}{2} \\cdot \\frac{3}{5}} = \\sqrt{\\frac{3}{10}} $$\n这就是无量纲平面常数 $\\tilde{c}$ 的精确解析表达式。",
            "answer": "$$ \\boxed{\\sqrt{\\frac{3}{10}}} $$"
        },
        {
            "introduction": "静态界面重构完成后，下一个关键步骤是计算流体体积在网格面上的平流输运。本练习将静态重构与动态输运联系起来，要求您精确计算在单个时间步内流向相邻网格的液体通量。这个计算是VOF平流算法的核心。",
            "id": "4076380",
            "problem": "考虑在流体体积（VOF）法中使用的二维笛卡尔网格单元中的不可压缩、不互溶的液-气界面，该界面通过分段线性界面重构（PLIC）进行重构。该单元在$(x,y)$坐标系下占据域$[0,1]\\times[0,1]$，并且是其右侧邻居单元的施主单元。VOF指示函数 $\\alpha$ 表示单元内液体的面积分数。在均匀向右的速度场下，经过一个显式平流步骤，液体穿过右侧面被输运。假设如下：\n\n- 重构的界面法向量为$\\mathbf{n}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)$，且单元内的液体区域为半平面$\\{\\mathbf{x}\\in\\mathbb{R}^{2}:\\,\\mathbf{n}\\cdot\\mathbf{x}\\geq d\\}$，其中$d\\in\\mathbb{R}$。\n- 施主单元的液体面积分数为 $\\alpha=0.18$，因此必须选择$d$使得单位正方形$[0,1]\\times[0,1]$与半平面$\\{\\mathbf{x}:\\,\\mathbf{n}\\cdot\\mathbf{x}\\geq d\\}$的交集面积等于 $\\alpha$。\n- 速度场是均匀向右的；在时间步长内，与右侧面相邻的平流板的宽度为$w=0.25$。因此，平流区域为矩形$\\mathcal{S}=\\{(x,y):\\,x\\in[1-w,1],\\,y\\in[0,1]\\}$。\n- 从施主单元到其右侧邻居单元的通量 $\\alpha$ 等于交集$\\mathcal{S}\\cap\\{\\mathbf{x}:\\,\\mathbf{n}\\cdot\\mathbf{x}\\geq d\\}$的面积除以单元面积。\n\n仅使用质量守恒、平流运动学以及几何PLIC重构前提（线性界面和半平面液体区域），通过计算平流板与重构的液体半平面之间的交集面积，来计算从施主单元到其右侧邻居单元的通量 $\\alpha$。将最终答案表示为无量纲数，并四舍五入到四位有效数字。",
            "solution": "问题提法恰当，有科学依据，并包含足够的信息以获得唯一解。我们首先验证问题陈述。\n\n### 步骤1：提取已知条件\n- **单元几何**：在域$[0,1] \\times [0,1]$上的二维笛卡尔网格单元。\n- **方法**：流体体积（VOF）法与分段线性界面重构（PLIC）。\n- **流体**：不可压缩、不互溶的液-气界面。\n- **VOF指示函数**：$\\alpha$ 是液体的面积分数。\n- **施主单元液体分数**：$\\alpha=0.18$。\n- **界面重构**：界面是由$\\mathbf{n} \\cdot \\mathbf{x} = d$定义的直线。液体区域是半平面$\\{\\mathbf{x} \\in \\mathbb{R}^2 : \\mathbf{n} \\cdot \\mathbf{x} \\geq d\\}$。\n- **界面法向量**：$\\mathbf{n} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right)$。\n- **平流**：均匀向右的速度场导致在单元右侧面上形成一个宽度为$w=0.25$的平流板。\n- **平流区域**：$\\mathcal{S} = \\{(x,y) : x \\in [1-w, 1], y \\in [0,1]\\} = [0.75, 1] \\times [0,1]$。\n- **目标**：计算通量 $\\alpha$，即液体区域与平流板$\\mathcal{S}$的交集面积除以总单元面积。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了VOF-PLIC方法在界面平流中的一个标准（尽管简化了）的应用。所有参数都已量化定义，物理和数学设置一致且无矛盾。这是一个基于计算流体力学原理的、定义明确的几何计算问题。因此，该问题被认为是有效的。\n\n### 步骤3：求解\n我们分两个主要步骤来解决问题：首先，我们确定界面的确切位置；其次，我们计算从单元中流出的液体面积。\n\n**第1部分：确定界面位置**\n\n界面由直线$\\mathbf{n} \\cdot \\mathbf{x} = d$描述。代入给定的法向量$\\mathbf{n} = (\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}})$和位置向量$\\mathbf{x}=(x,y)$，我们得到：\n$$\n\\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right) \\cdot (x,y) = d\n$$\n$$\n\\frac{x}{\\sqrt{2}} + \\frac{y}{\\sqrt{2}} = d\n$$\n这个方程可以简化为$x+y=c$，其中$c = d\\sqrt{2}$。液体区域由不等式$\\mathbf{n} \\cdot \\mathbf{x} \\geq d$定义，这等价于$x+y \\geq c$。\n\n必须选择常数$c$，使得单位单元$[0,1]\\times[0,1]$内的液体面积等于给定的液体分数 $\\alpha = 0.18$。我们必须计算由$\\{(x,y) \\in [0,1]^2 : x+y \\geq c\\}$定义的区域的面积。\n\n直线$x+y=c$的斜率为-1。我们分析不同$c$范围下的面积：\n- 如果$c \\le 1$，区域$x+y \\ge c$的面积为$1 - \\frac{1}{2}c^2$。令其等于$\\alpha=0.18$得到$1 - \\frac{1}{2}c^2 = 0.18$，所以$\\frac{1}{2}c^2 = 0.82$，即$c^2 = 1.64$。这意味着$c = \\sqrt{1.64} \\approx 1.28$，这与假设$c \\le 1$相矛盾。\n- 如果$1  c  2$，直线$x+y=c$在单位正方形的右上角切出一个小的三角形液体区域。该三角形的顶点是$(1, c-1)$、$(c-1, 1)$和$(1,1)$。这是一个直角三角形，直角边长为$1-(c-1) = 2-c$。这个液体三角形的面积是：\n$$\nA_{\\text{liquid}} = \\frac{1}{2} (\\text{base}) (\\text{height}) = \\frac{1}{2} (2-c)^2\n$$\n我们已知这个面积是 $\\alpha = 0.18$。\n$$\n\\frac{1}{2} (2-c)^2 = 0.18\n$$\n$$\n(2-c)^2 = 0.36\n$$\n对两边取平方根，我们得到$2-c = 0.6$（我们取正根，因为$2-c$代表物理长度且$c2$）。\n解出$c$：\n$$\nc = 2 - 0.6 = 1.4\n$$\n这个值$c=1.4$与条件$1  c  2$一致。因此，单元内重构的线性界面是直线$x+y=1.4$。\n\n**第2部分：计算通量面积**\n\n通量体积（在二维中为面积）对应于位于平流板$\\mathcal{S}$内的那部分液体。平流板是矩形区域$\\mathcal{S} = [0.75, 1] \\times [0,1]$。通量面积$A_{\\text{flux}}$是液体区域（$x+y \\geq 1.4$）和平流板$\\mathcal{S}$的交集面积。\n$$\nA_{\\text{flux}} = \\text{Area}(\\{(x,y) : 0.75 \\le x \\le 1, \\, 0 \\le y \\le 1, \\, \\text{and} \\, x+y \\ge 1.4 \\})\n$$\n条件$x+y \\ge 1.4$可以写成$y \\ge 1.4-x$。该区域的下界是直线$y=1.4-x$，上界是直线$y=1$。水平范围从$x=0.75$到$x=1$。我们可以用定积分来计算这个面积：\n$$\nA_{\\text{flux}} = \\int_{0.75}^{1} (y_{\\text{upper}} - y_{\\text{lower}}) \\, dx = \\int_{0.75}^{1} (1 - (1.4-x)) \\, dx\n$$\n$$\nA_{\\text{flux}} = \\int_{0.75}^{1} (x - 0.4) \\, dx\n$$\n计算积分：\n$$\nA_{\\text{flux}} = \\left[ \\frac{1}{2}x^2 - 0.4x \\right]_{0.75}^{1}\n$$\n$$\nA_{\\text{flux}} = \\left( \\frac{1}{2}(1)^2 - 0.4(1) \\right) - \\left( \\frac{1}{2}(0.75)^2 - 0.4(0.75) \\right)\n$$\n$$\nA_{\\text{flux}} = (0.5 - 0.4) - \\left( \\frac{1}{2}(0.5625) - 0.3 \\right)\n$$\n$$\nA_{\\text{flux}} = 0.1 - (0.28125 - 0.3)\n$$\n$$\nA_{\\text{flux}} = 0.1 - (-0.01875) = 0.11875\n$$\n问题将通量 $\\alpha$ 定义为此面积除以总单元面积。由于单元面积为$1 \\times 1 = 1$，通量 $\\alpha$ 在数值上等于$A_{\\text{flux}}$。\n$$\n\\text{Fluxed } \\alpha = \\frac{A_{\\text{flux}}}{A_{\\text{cell}}} = \\frac{0.11875}{1} = 0.11875\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\text{Fluxed } \\alpha \\approx 0.1188\n$$",
            "answer": "$$\n\\boxed{0.1188}\n$$"
        },
        {
            "introduction": "理想的数值方法应能完美再现物理定律，但在实践中，离散化会引入误差，并可能表现为非物理现象。这项高级实践要求您分析VOF模拟中常见的“伪电流”(spurious currents)现象，通过推导一个联系其强度、网格分辨率和流体物理性质的标度律。本练习旨在培养计算科学家必备的数值分析与验证等关键技能。",
            "id": "4076442",
            "problem": "静态液滴基准测试在计算燃烧学中被广泛用于流体体积（VOF）方法处理气液界面，以量化被称为伪电流的寄生速度。考虑一个不可压缩的两相系统，在一个静止的、周期性的方形域中，一个半径为 $R$ 的单个液滴初始静止并浸没在气体中。界面由VOF指示函数表示，表面张力通过连续表面力（CSF）模型进行建模。目标是推导一个用于伪电流的无量纲误差指标，并在不同网格细化程度上计算该指标。\n\n您必须基于以下已被充分验证的基础进行推导：\n- 在CSF框架下，用于具有表面张力的两相混合物的不可压缩Navier–Stokes方程：\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa \\nabla H\n$$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度， $p$ 是压力，$\\mu$ 是动力粘度，$\\sigma$ 是表面张力，$\\kappa$ 是平均曲率，$H$ 是VOF指示量的Heaviside函数；以及不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$。\n- 在静态液滴基准测试中，物理上正确的稳态解为 $\\mathbf{u}=\\mathbf{0}$，伴随一个Laplace压力跳跃 $\\Delta p = \\sigma \\kappa$；然而，数值曲率误差会引起伪速度。\n- L-无穷范数 $||\\mathbf{u}||_\\infty$ 是计算域上速度场的最大模，即 $||\\mathbf{u}||_\\infty = \\max_{\\mathbf{x}} ||\\mathbf{u}(\\mathbf{x})||$。\n\n假设：\n- 由离散化引起的曲率误差 $|\\varepsilon_\\kappa|$ 随网格间距的变化关系为 $|\\varepsilon_\\kappa| \\sim \\alpha \\left( \\frac{\\Delta x}{R} \\right)^p \\frac{1}{R}$，其中 $\\alpha$ 是一个由曲率重构方法决定的无量纲常数，$p$ 是关于 $\\Delta x$ 的精度阶数。\n- 在静态液滴测试的稳态、低雷诺数区域中，粘性扩散项与由曲率误差引起的（错误的）毛细作用力相平衡。\n\n任务：\n1. 基于上述基础，不引入未经检验的捷径，推导由下式定义的无量纲伪电流误差指标\n$$\n\\mathcal{M} \\equiv \\frac{||\\mathbf{u}||_\\infty}{\\sigma/\\mu},\n$$\n使其成为 $R$、$\\Delta x$、$\\alpha$ 和 $p$ 的函数。\n2. 基于您的推导，实现一个算法，对于给定的 $(R,\\Delta x,\\alpha,p,\\sigma,\\mu)$，计算 $\\mathcal{M}$ 并将其结果四舍五入到六位小数。程序不应计算角度。如果计算了任何中间物理量，请确保其单位一致性，但最终输出是无量纲的，因此没有单位。\n3. 使用以下具有物理上合理参数的测试套件，在不同网格细化程度上评估 $\\mathcal{M}$。对于每个测试，$R$ 和 $\\Delta x$ 以米为单位，$\\sigma$ 以牛顿/米为单位，$\\mu$ 以帕斯卡·秒为单位：\n   - 测试 1：$(R=\\;1.0\\times 10^{-3},\\;\\Delta x=\\;R/16,\\;\\alpha=\\;0.400,\\;p=\\;2,\\;\\sigma=\\;0.050,\\;\\mu=\\;1.0\\times 10^{-3})$。\n   - 测试 2：$(R=\\;5.0\\times 10^{-4},\\;\\Delta x=\\;R/64,\\;\\alpha=\\;0.060,\\;p=\\;1,\\;\\sigma=\\;0.072,\\;\\mu=\\;5.0\\times 10^{-4})$。\n   - 测试 3：$(R=\\;2.0\\times 10^{-3},\\;\\Delta x=\\;R,\\;\\alpha=\\;0.250,\\;p=\\;2,\\;\\sigma=\\;0.030,\\;\\mu=\\;2.0\\times 10^{-3})$。\n   - 测试 4：$(R=\\;7.5\\times 10^{-4},\\;\\Delta x=\\;R/128,\\;\\alpha=\\;1.100,\\;p=\\;3,\\;\\sigma=\\;0.072,\\;\\mu=\\;8.0\\times 10^{-4})$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是对应测试用例的 $\\mathcal{M}$ 的浮点数值，四舍五入到六位小数，并按上述测试的顺序排列（例如，`[0.025000,0.060000,0.250000,0.000067]`）。输出是无量纲的，并且必须严格按照此格式呈现。",
            "solution": "该问题要求推导无量纲伪电流误差指标 $\\mathcal{M}$，并为一组测试用例计算其值。推导过程必须基于所提供的物理原理和假设。\n\n推导过程如下。\n\n首先，我们从问题中提供的、通过连续表面力（CSF）模型建模的、用于两相混合物的不可压缩Navier-Stokes方程开始：\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_n \\nabla H\n$$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度， $t$ 是时间， $p$ 是压力，$\\mu$ 是动力粘度，$\\sigma$ 是表面张力，$\\kappa_n$ 是数值近似的曲率，$H$ 是表示体积分数的Heaviside函数。在 $\\kappa$ 上加上下标 $n$ 是为了强调，在数值模拟中，这是计算得到的曲率，而不是精确的解析曲率。\n\n问题指出，伪电流是在稳态、低雷诺数区域中进行分析的。\n“稳态”假设意味着时间导数项为零：$\\frac{\\partial \\mathbf{u}}{\\partial t} = \\mathbf{0}$。“低雷诺数”假设意味着惯性项 $\\rho(\\mathbf{u}\\cdot \\nabla \\mathbf{u})$ 与粘性扩散项 $\\mu \\nabla^2 \\mathbf{u}$ 相比可以忽略不计。\n应用这些假设，可将控制方程简化为压力、粘性力和表面张力之间的平衡：\n$$\n\\mathbf{0} \\approx -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_n \\nabla H\n$$\n\n伪电流 $\\mathbf{u} \\neq \\mathbf{0}$ 的产生是因为离散压力梯度 $\\nabla p$ 无法完全平衡数值计算出的表面张力 $\\sigma \\kappa_n \\nabla H$。当压力梯度与由精确曲率 $\\kappa_{exact}$ 产生的力相平衡时，即 $\\nabla p_{exact} = \\sigma \\kappa_{exact} \\nabla H$，存在精确解 $\\mathbf{u}=\\mathbf{0}$。曲率的数值误差 $\\varepsilon_\\kappa = \\kappa_n - \\kappa_{exact}$ 是驱动伪流动的不平衡残余力的来源。\n\n推导的核心在于所提供的假设：“粘性扩散与（错误的）毛细作用力相平衡。”我们通过量纲分析将此形式化。错误的毛细作用力密度 $\\mathbf{F}_{err}$ 是表面张力中驱动流动的部分，源于曲率误差 $\\varepsilon_\\kappa$：\n$$\n\\mathbf{F}_{err} \\sim \\sigma \\varepsilon_\\kappa \\nabla H\n$$\nHeaviside函数的梯度 $\\nabla H$ 仅在界面处非零，其作用类似于一个离散的delta函数。其量级与界面厚度的倒数成比例，而界面厚度与网格间距 $\\Delta x$ 成正比。因此， $||\\nabla H|| \\sim 1/\\Delta x$。所以，错误力密度的量级为：\n$$\n||\\mathbf{F}_{err}|| \\sim \\sigma |\\varepsilon_\\kappa| \\frac{1}{\\Delta x}\n$$\n粘性扩散项为 $\\mu \\nabla^2 \\mathbf{u}$。在量纲分析中，拉普拉斯算子 $\\nabla^2$ 的量级为 $1/L^2$，其中 $L$ 是速度场变化的特征长度尺度。对于在液滴周围形成的伪电流涡，最大的涡旋受液滴几何形状的约束。因此，全局流动结构的合适特征长度尺度是液滴半径 $R$。速度尺度取为最大速度模 $||\\mathbf{u}||_\\infty$。因此，粘性项的量级为：\n$$\n||\\mu \\nabla^2 \\mathbf{u}|| \\sim \\mu \\frac{||\\mathbf{u}||_\\infty}{R^2}\n$$\n根据平衡假设，我们令粘性项和错误的毛细作用项的量级相等：\n$$\n\\mu \\frac{||\\mathbf{u}||_\\infty}{R^2} \\sim \\sigma |\\varepsilon_\\kappa| \\frac{1}{\\Delta x}\n$$\n现在我们可以求解最大速度模 $||\\mathbf{u}||_\\infty$：\n$$\n||\\mathbf{u}||_\\infty \\sim \\frac{\\sigma}{\\mu} \\frac{R^2}{\\Delta x} |\\varepsilon_\\kappa|\n$$\n问题提供了一个离散化引起的曲率误差模型：\n$$\n|\\varepsilon_\\kappa| \\sim \\alpha \\left( \\frac{\\Delta x}{R} \\right)^p \\frac{1}{R}\n$$\n其中 $\\alpha$ 是一个无量纲常数，$p$ 是精度阶数。将此模型代入我们关于 $||\\mathbf{u}||_\\infty$ 的表达式中：\n$$\n||\\mathbf{u}||_\\infty \\sim \\frac{\\sigma}{\\mu} \\frac{R^2}{\\Delta x} \\left[ \\alpha \\left( \\frac{\\Delta x}{R} \\right)^p \\frac{1}{R} \\right]\n$$\n简化表达式：\n$$\n||\\mathbf{u}||_\\infty \\sim \\frac{\\sigma \\alpha}{\\mu} \\frac{R}{\\Delta x} \\left( \\frac{\\Delta x}{R} \\right)^p = \\frac{\\sigma \\alpha}{\\mu} \\left( \\frac{\\Delta x}{R} \\right)^{p-1}\n$$\n问题要求的是无量纲伪电流误差指标 $\\mathcal{M}$，其定义为：\n$$\n\\mathcal{M} \\equiv \\frac{||\\mathbf{u}||_\\infty}{\\sigma/\\mu}\n$$\n代入我们推导出的 $||\\mathbf{u}||_\\infty$ 表达式，我们得到 $\\mathcal{M}$ 的最终公式：\n$$\n\\mathcal{M} = \\frac{\\frac{\\sigma \\alpha}{\\mu} \\left( \\frac{\\Delta x}{R} \\right)^{p-1}}{\\sigma/\\mu} = \\alpha \\left( \\frac{\\Delta x}{R} \\right)^{p-1}\n$$\n这个关系式是无量纲的，因为 $\\alpha$ 和比率 $\\Delta x/R$ 都是无量纲的。该推导仅依赖于所提供的物理基础和标准量纲分析技术。请注意，虽然参数 $\\sigma$ 和 $\\mu$ 对于伪电流的存在在物理上是必不可少的，但它们从无量纲指标 $\\mathcal{M}$ 的最终表达式中被消去了。\n\n计算算法是该推导公式的直接实现。对于每个测试用例，我们都给定了 $R$、$\\Delta x$（作为 $R$ 的一部分）、$\\alpha$ 和 $p$ 的值。算法将使用上述公式计算 $\\mathcal{M}$，并将结果四舍五入到六位小数。\n\n例如，对于测试1：\n$R = 1.0\\times 10^{-3}$，$\\Delta x = R/16$，$\\alpha = 0.400$，$p=2$。\n比率 $\\Delta x/R = 1/16$。\n指数 $p-1 = 2-1 = 1$。\n$$\n\\mathcal{M} = 0.400 \\times \\left( \\frac{1}{16} \\right)^1 = \\frac{0.400}{16} = 0.025\n$$\n对所有测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the nondimensional spurious-current error indicator M for a series\n    of static droplet test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (R, dx_fraction, alpha, p, sigma, mu)\n    # dx_fraction is the denominator 'd' in dx = R/d. For dx=R, d=1.\n    test_cases = [\n        # Test 1: (R=1.0e-3, Δx=R/16, α=0.400, p=2, σ=0.050, μ=1.0e-3)\n        (1.0e-3, 16.0, 0.400, 2, 0.050, 1.0e-3),\n        # Test 2: (R=5.0e-4, Δx=R/64, α=0.060, p=1, σ=0.072, μ=5.0e-4)\n        (5.0e-4, 64.0, 0.060, 1, 0.072, 5.0e-4),\n        # Test 3: (R=2.0e-3, Δx=R, α=0.250, p=2, σ=0.030, μ=2.0e-3)\n        (2.0e-3, 1.0, 0.250, 2, 0.030, 2.0e-3),\n        # Test 4: (R=7.5e-4, Δx=R/128, α=1.100, p=3, σ=0.072, μ=8.0e-4)\n        (7.5e-4, 128.0, 1.100, 3, 0.072, 8.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        R, dx_divisor, alpha, p, sigma, mu = case\n        \n        # The derivation shows that M does not depend on R, sigma, or mu explicitly,\n        # but on the ratio dx/R.\n        # M = alpha * (dx/R)^(p-1)\n        \n        # Calculate the ratio dx/R\n        # dx = R / dx_divisor\n        # dx/R = 1 / dx_divisor\n        dx_over_R = 1.0 / dx_divisor\n        \n        # Calculate the exponent\n        exponent = p - 1\n        \n        # Calculate M\n        # Using np.power for robust floating-point exponentiation\n        m_indicator = alpha * np.power(dx_over_R, exponent)\n        \n        # Round the result to six decimal places\n        # Using string formatting for precise rounding\n        rounded_result = f\"{m_indicator:.6f}\"\n\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    # The example output in the problem statement is illustrative of the format.\n    # The correct results are generated based on the derived formula.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}