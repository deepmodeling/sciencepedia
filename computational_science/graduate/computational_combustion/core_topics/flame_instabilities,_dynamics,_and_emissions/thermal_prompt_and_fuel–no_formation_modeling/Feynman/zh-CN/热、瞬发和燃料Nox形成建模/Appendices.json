{
    "hands_on_practices": [
        {
            "introduction": "一项关键技能是将微观的化学产物生成速率（单位为 $kg/m^3/s$）转化为宏观且实用的度量，例如排放指数（单位为 $g/kg$ 燃料）。本练习  旨在演示在一个简化的反应器模型中如何建立这种联系。通过解决这个问题，您将把基础动力学原理与工程层面的排放量化直接联系起来。",
            "id": "4071194",
            "problem": "考虑一个长度为 $L$、直径为 $D$ 的稳态、绝热、非预混圆柱形燃烧室，其在均匀的高温区温度和流动条件下运行，使得一氧化氮 (NO) 主要在一个充分搅拌的反应区内形成。该燃烧室以恒定的质量流率 $\\dot{m}_{f}$ 供给甲烷燃料。一氧化氮 (NO) 通过三种动力学上不同的机理形成：热力型（扩展的 Zeldovich 机理）、快速型（碳氢自由基路径）和燃料氮型（燃料中束缚氮的氧化）。设由这些机理产生的 NO 的单位体积质量生成速率（按惯例为正）分别表示为 $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{th}}$、$\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{pr}}$ 和 $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{fn}}$，单位为 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。假设在整个高温反应区内，以下为科学上合理的、空间上均匀的数值：\n- $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{th}} = 6.0 \\times 10^{-4}$,\n- $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{pr}} = 2.5 \\times 10^{-4}$,\n- $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{fn}} = 2.1 \\times 10^{-4}$,\n以及几何和燃料供给数据：\n- $L = 0.60\\,\\mathrm{m}$,\n- $D = 0.10\\,\\mathrm{m}$,\n- $\\dot{m}_{f} = 2.0 \\times 10^{-3}\\,\\mathrm{kg\\,s^{-1}}$.\n\n从组分质量守恒定律和排放指数的定义出发，定义以克 NO 每千克燃料为单位的 NO 排放指数 (EI)（记为 $\\mathrm{EI_{NO}}$，单位为 $\\mathrm{g\\,NO/kg\\,fuel}$），并推导其与 NO 的体积分生成量和燃料质量流率之间的普适关系。在所述的均匀性假设下，使用您推导的关系式，根据给定的燃烧室和源项数据，计算 $\\mathrm{EI_{NO}}$ 的数值。将最终答案四舍五入至四位有效数字。以 $\\mathrm{g\\,NO/kg\\,fuel}$ 为单位表示最终值。",
            "solution": "问题陈述经评估是有效的。它在科学上基于化学动力学和输运现象在燃烧学中的应用原理，特别是关于 NOx 的形成。该问题提法恰当，为获得唯一解提供了所有必要的数据和定义。其语言客观，且诸如均匀的充分搅拌反应区等假设，在燃烧模拟中是标准且可接受的简化方法。\n\n主要任务是定义并计算一氧化氮的排放指数（$\\mathrm{EI_{NO}}$）。\n\n首先，我们建立基本原理。对于稳态下控制体积 $V$ 内的组分 $i$，其普适的组分质量守恒方程由下式给出：\n$$\n0 = - \\oint_{\\partial V} (\\rho Y_i \\mathbf{u}) \\cdot \\mathbf{n} \\, dA + \\oint_{\\partial V} (\\rho D_i \\nabla Y_i) \\cdot \\mathbf{n} \\, dA + \\int_V \\dot{\\omega}_i \\, dV\n$$\n其中，各项分别代表由平流、扩散和化学反应引起的质量变化的净速率。对于像充分搅拌反应器这样的整体流动系统，我们可以通过考虑入口和出口的质量流率来简化该方程。守恒方程变为：\n$$\n(\\text{组分 } i \\text{ 的出口质量流率}) - (\\text{组分 } i \\text{ 的入口质量流率}) = (\\text{体积 } V \\text{ 内组分 } i \\text{ 的总质量生成速率})\n$$\n用符号表示为：\n$$\n\\dot{m}_{i, \\text{out}} - \\dot{m}_{i, \\text{in}} = \\int_V \\dot{\\omega}_i \\, dV\n$$\n对于一氧化氮 ($\\mathrm{NO}$)，我们假设其不存在于进入的燃料或空气流中，因此 $\\dot{m}_{\\mathrm{NO, in}} = 0$。离开燃烧室的 NO 质量流率因此等于其在燃烧室体积内的总生成速率：\n$$\n\\dot{m}_{\\mathrm{NO, out}} = \\int_V \\dot{\\omega}_{\\mathrm{NO}} \\, dV\n$$\n\n接下来，我们按要求定义排放指数 ($\\mathrm{EI_{NO}}$)，单位为克 NO 每千克燃料。它是生成的 NO 质量与消耗的燃料质量的比值。对于稳态过程，这就是它们各自质量流率的比值：\n$$\n\\mathrm{EI_{NO}} = \\frac{\\text{生成的NO质量流率}}{\\text{消耗的燃料质量流率}} = \\frac{\\dot{m}_{\\mathrm{NO, out}}}{\\dot{m}_f}\n$$\n问题指定单位为 $\\mathrm{g\\,NO/kg\\,fuel}$，因此如果质量流率的单位是 $\\mathrm{kg\\,s^{-1}}$，将需要一个 $1000$ 的转换因子。\n\n结合这两个关系式，得到 $\\mathrm{EI_{NO}}$ 的普适公式：\n$$\n\\mathrm{EI_{NO}} = \\frac{1}{\\dot{m}_f} \\int_V \\dot{\\omega}_{\\mathrm{NO}} \\, dV\n$$\n这就是推导出的排放指数、体积分生成速率和燃料质量流率之间的普适关系。\n\nNO 的总单位体积质量生成速率 $\\dot{\\omega}_{\\mathrm{NO, total}}$ 是来自三个给定机理的速率之和：\n$$\n\\dot{\\omega}_{\\mathrm{NO, total}} = \\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{th}} + \\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{pr}} + \\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{fn}}\n$$\n问题陈述指出，这些速率在整个反应区（即燃烧室的整个体积）内是空间均匀的。因此，$\\dot{\\omega}_{\\mathrm{NO, total}}$ 可以被视为一个常数，并从积分中提出：\n$$\n\\int_V \\dot{\\omega}_{\\mathrm{NO, total}} \\, dV = \\dot{\\omega}_{\\mathrm{NO, total}} \\int_V dV = \\dot{\\omega}_{\\mathrm{NO, total}} \\cdot V\n$$\n圆柱形燃烧室的体积 $V$ 由下式给出：\n$$\nV = \\pi \\left(\\frac{D}{2}\\right)^2 L = \\frac{\\pi D^2 L}{4}\n$$\n将此代回 $\\mathrm{EI_{NO}}$ 的表达式中，得到适用于此问题的特定公式：\n$$\n\\mathrm{EI_{NO}} = \\frac{\\dot{\\omega}_{\\mathrm{NO, total}} \\cdot V}{\\dot{m}_f} = \\frac{(\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{th}} + \\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{pr}} + \\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{fn}}) \\left(\\frac{\\pi D^2 L}{4}\\right)}{\\dot{m}_f}\n$$\n\n我们现在代入给定的数值：\n- $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{th}} = 6.0 \\times 10^{-4}\\,\\mathrm{kg\\,m^{-3}\\,s^{-1}}$\n- $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{pr}} = 2.5 \\times 10^{-4}\\,\\mathrm{kg\\,m^{-3}\\,s^{-1}}$\n- $\\dot{\\omega}_{\\mathrm{NO}}^{\\mathrm{fn}} = 2.1 \\times 10^{-4}\\,\\mathrm{kg\\,m^{-3}\\,s^{-1}}$\n- $L = 0.60\\,\\mathrm{m}$\n- $D = 0.10\\,\\mathrm{m}$\n- $\\dot{m}_{f} = 2.0 \\times 10^{-3}\\,\\mathrm{kg\\,s^{-1}}$\n\n首先，计算总单位体积生成速率：\n$$\n\\dot{\\omega}_{\\mathrm{NO, total}} = (6.0 \\times 10^{-4}) + (2.5 \\times 10^{-4}) + (2.1 \\times 10^{-4}) \\,\\mathrm{kg\\,m^{-3}\\,s^{-1}} = 10.6 \\times 10^{-4}\\,\\mathrm{kg\\,m^{-3}\\,s^{-1}} = 1.06 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-3}\\,s^{-1}}\n$$\n接着，计算反应区的体积：\n$$\nV = \\frac{\\pi (0.10\\,\\mathrm{m})^2 (0.60\\,\\mathrm{m})}{4} = \\frac{\\pi (0.01\\,\\mathrm{m}^2) (0.60\\,\\mathrm{m})}{4} = \\frac{0.0060 \\pi}{4}\\,\\mathrm{m}^3 = 0.0015 \\pi\\,\\mathrm{m}^3\n$$\n现在，计算 NO 的总质量生成速率，即 $\\dot{m}_{\\mathrm{NO, out}}$：\n$$\n\\dot{m}_{\\mathrm{NO, out}} = \\dot{\\omega}_{\\mathrm{NO, total}} \\cdot V = (1.06 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-3}\\,s^{-1}}) (0.0015 \\pi\\,\\mathrm{m}^3) = 1.59 \\pi \\times 10^{-6}\\,\\mathrm{kg\\,s^{-1}}\n$$\n现在，我们计算无量纲排放指数 ($\\mathrm{kg\\,NO/kg\\,fuel}$):\n$$\n\\mathrm{EI_{NO}} = \\frac{\\dot{m}_{\\mathrm{NO, out}}}{\\dot{m}_f} = \\frac{1.59 \\pi \\times 10^{-6}\\,\\mathrm{kg\\,s^{-1}}}{2.0 \\times 10^{-3}\\,\\mathrm{kg\\,s^{-1}}} = 0.795 \\pi \\times 10^{-3}\n$$\n问题要求答案的单位为 $\\mathrm{g\\,NO/kg\\,fuel}$。我们通过乘以 $1000$ 进行单位转换：\n$$\n\\mathrm{EI_{NO}} [\\mathrm{g/kg}] = (0.795 \\pi \\times 10^{-3}) \\times 1000 = 0.795 \\pi\n$$\n计算数值：\n$$\n\\mathrm{EI_{NO}} \\approx 0.795 \\times 3.14159265... \\approx 2.4975661...\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\mathrm{EI_{NO}} \\approx 2.498\n$$\n因此最终答案是 $2.498\\,\\mathrm{g\\,NO/kg\\,fuel}$。",
            "answer": "$$\\boxed{2.498}$$"
        },
        {
            "introduction": "像Zeldovich机理这样的复杂反应网络，其整体速率通常由一个最慢的“瓶颈”反应所控制。本练习  将引导您应用准稳态近似（Quasi-Steady-State Approximation, QSSA）这一强大工具来分析热力型NO的生成机理。通过此练习，您不仅能识别其速率限制步骤，还能深刻理解为何热力型NO的生成对温度如此敏感。",
            "id": "4071212",
            "problem": "考虑在稀薄预混火焰中通过扩展的 Zeldovich 机理生成热力型一氧化氮 ($\\mathrm{NO}$)。基元反应如下：\n$$\n\\text{(1)}\\quad \\mathrm{N_2} + \\mathrm{O} \\to \\mathrm{NO} + \\mathrm{N},\\qquad\n\\text{(2)}\\quad \\mathrm{N} + \\mathrm{O_2} \\to \\mathrm{NO} + \\mathrm{O},\\qquad\n\\text{(3)}\\quad \\mathrm{N} + \\mathrm{OH} \\to \\mathrm{NO} + \\mathrm{H}.\n$$\n假设理想气体行为和质量作用动力学，其阿伦尼乌斯速率系数为\n$$\nk_i(T) \\;=\\; A_i\\,T^{n_i}\\,\\exp\\!\\left(-\\frac{E_{a,i}}{R_u\\,T}\\right),\n$$\n其中 $R_u$ 是通用气体常数。使用以下参数（以连贯的国际单位制给出）：\n$$\nA_1 \\;=\\; 1.8\\times 10^{2}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad n_1 \\;=\\; 0,\\quad \\frac{E_{a,1}}{R_u} \\;=\\; 38370\\ \\mathrm{K},\n$$\n$$\nA_2 \\;=\\; 6.4\\times 10^{3}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad n_2 \\;=\\; 0,\\quad E_{a,2} \\;=\\; 0,\n$$\n$$\nA_3 \\;=\\; 3.8\\times 10^{7}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad n_3 \\;=\\; 0,\\quad E_{a,3} \\;=\\; 0,\n$$\n以及 $R_u \\;=\\; 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。火焰后状态的温度为 $T \\;=\\; 2000\\ \\mathrm{K}$，压力为 $p \\;=\\; 10\\ \\mathrm{atm}$，摩尔分数为 $X_{\\mathrm{N_2}} \\;=\\; 0.75$，$X_{\\mathrm{O_2}} \\;=\\; 0.05$，$X_{\\mathrm{O}} \\;=\\; 1.0\\times 10^{-5}$，以及 $X_{\\mathrm{OH}} \\;=\\; 1.0\\times 10^{-3}$。令 $C_{\\mathrm{tot}} \\;=\\; p/(R_u T)$ 且 $[\\cdot] \\;=\\; X_{\\cdot}\\,C_{\\mathrm{tot}}$ 表示摩尔浓度。\n\n使用对原子氮 ($\\mathrm{N}$) 的准稳态近似，计算反应 (1)–(3) 的正向体积反应速率 $\\dot{\\omega}_1$、$\\dot{\\omega}_2$ 和 $\\dot{\\omega}_3$，并确定限速反应的索引 $i \\in \\{1,2,3\\}$。限速反应定义为在这些条件下控制总的热力型一氧化氮生成时间尺度的基元步骤。最终答案以无单位的整数 $i$ 表示。中间数值计算至少保留三位有效数字；对最终的整数没有舍入要求。",
            "solution": "该问题要求在指定的火焰后条件下，确定扩展的 Zeldovich 机理中生成热力型 $\\mathrm{NO}$ 的限速反应。这涉及到对原子氮 ($\\mathrm{N}$) 应用准稳态近似 (QSSA)。\n\n首先，我们确定热力学状态并计算总摩尔浓度。给定压力为 $p = 10\\ \\mathrm{atm}$。为使用连贯的国际单位制，我们将其转换为帕斯卡：\n$$\np = 10\\ \\mathrm{atm} \\times 101325\\ \\mathrm{Pa\\,atm^{-1}} = 1.01325 \\times 10^6\\ \\mathrm{Pa}\n$$\n温度为 $T = 2000\\ \\mathrm{K}$，通用气体常数为 $R_u = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。总摩尔浓度 $C_{\\mathrm{tot}}$ 由理想气体定律给出：\n$$\nC_{\\mathrm{tot}} = \\frac{p}{R_u T} = \\frac{1.01325 \\times 10^6\\ \\mathrm{Pa}}{(8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (2000\\ \\mathrm{K})} \\approx 60.938\\ \\mathrm{mol\\,m^{-3}}\n$$\n接下来，我们使用给定的摩尔分数 $X_{\\cdot}$ 和关系式 $[\\cdot] = X_{\\cdot}C_{\\mathrm{tot}}$ 计算相关物种的摩尔浓度：\n\\begin{align*}\n[\\mathrm{N_2}] = X_{\\mathrm{N_2}} C_{\\mathrm{tot}} = 0.75 \\times 60.938\\ \\mathrm{mol\\,m^{-3}} \\approx 45.704\\ \\mathrm{mol\\,m^{-3}} \\\\\n[\\mathrm{O_2}] = X_{\\mathrm{O_2}} C_{\\mathrm{tot}} = 0.05 \\times 60.938\\ \\mathrm{mol\\,m^{-3}} \\approx 3.047\\ \\mathrm{mol\\,m^{-3}} \\\\\n[\\mathrm{O}] = X_{\\mathrm{O}} C_{\\mathrm{tot}} = 1.0 \\times 10^{-5} \\times 60.938\\ \\mathrm{mol\\,m^{-3}} \\approx 6.094 \\times 10^{-4}\\ \\mathrm{mol\\,m^{-3}} \\\\\n[\\mathrm{OH}] = X_{\\mathrm{OH}} C_{\\mathrm{tot}} = 1.0 \\times 10^{-3} \\times 60.938\\ \\mathrm{mol\\,m^{-3}} \\approx 6.094 \\times 10^{-2}\\ \\mathrm{mol\\,m^{-3}}\n\\end{align*}\n\n现在，我们计算在 $T = 2000\\ \\mathrm{K}$ 时的阿伦尼乌斯速率系数 $k_i$：\n对于反应 (1)：\n$$\nk_1 = A_1 T^{n_1} \\exp\\left(-\\frac{E_{a,1}}{R_u T}\\right) = (1.8 \\times 10^{2}) \\times (2000)^0 \\times \\exp\\left(-\\frac{38370}{2000}\\right)\n$$\n$$\nk_1 = (1.8 \\times 10^{2}) \\exp(-19.185) \\approx (1.8 \\times 10^{2}) \\times (4.646 \\times 10^{-9}) \\approx 8.363 \\times 10^{-7}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}\n$$\n对于反应 (2)，其中 $E_{a,2} = 0$ 且 $n_2=0$：\n$$\nk_2 = A_2 = 6.4 \\times 10^{3}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}\n$$\n对于反应 (3)，其中 $E_{a,3} = 0$ 且 $n_3=0$：\n$$\nk_3 = A_3 = 3.8 \\times 10^{7}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}\n$$\n我们对原子氮自由基 $\\mathrm{N}$ 应用准稳态近似。原子氮在反应 (1) 中生成，在反应 (2) 和 (3) 中消耗。准稳态近似假设这种高活性中间体的浓度净变化率约等于零。按照初始 $\\mathrm{NO}$ 生成的标准，只考虑正向反应：\n$$\n\\frac{d[\\mathrm{N}]}{dt} = \\dot{\\omega}_1 - \\dot{\\omega}_2 - \\dot{\\omega}_3 \\approx 0\n$$\n其中 $\\dot{\\omega}_i$ 是正向体积反应速率：\n\\begin{align*}\n\\dot{\\omega}_1 = k_1 [\\mathrm{N_2}] [\\mathrm{O}] \\\\\n\\dot{\\omega}_2 = k_2 [\\mathrm{N}] [\\mathrm{O_2}] \\\\\n\\dot{\\omega}_3 = k_3 [\\mathrm{N}] [\\mathrm{OH}]\n\\end{align*}\n因此，准稳态近似关系为 $\\dot{\\omega}_1 \\approx \\dot{\\omega}_2 + \\dot{\\omega}_3$。\n由此，我们可以求解原子氮的准稳态浓度 $[\\mathrm{N}]_{\\mathrm{qss}}$：\n$$\nk_1 [\\mathrm{N_2}] [\\mathrm{O}] = k_2 [\\mathrm{N}]_{\\mathrm{qss}} [\\mathrm{O_2}] + k_3 [\\mathrm{N}]_{\\mathrm{qss}} [\\mathrm{OH}]\n$$\n$$\n[\\mathrm{N}]_{\\mathrm{qss}} = \\frac{k_1 [\\mathrm{N_2}] [\\mathrm{O}]}{k_2 [\\mathrm{O_2}] + k_3 [\\mathrm{OH}]}\n$$\n现在我们可以计算所需的速率。首先，我们计算 $\\dot{\\omega}_1$，即 $\\mathrm{N}$ 原子的生成速率：\n$$\n\\dot{\\omega}_1 = (8.363 \\times 10^{-7}) \\times (45.704) \\times (6.094 \\times 10^{-4}) \\approx 2.327 \\times 10^{-8}\\ \\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\n现在我们计算 $[\\mathrm{N}]_{\\mathrm{qss}}$ 表达式的分母，它代表了 $\\mathrm{N}$ 的总消耗频率：\n\\begin{align*}\nk_2 [\\mathrm{O_2}] \\approx (6.4 \\times 10^{3}) \\times (3.047) \\approx 1.950 \\times 10^{4}\\ \\mathrm{s^{-1}} \\\\\nk_3 [\\mathrm{OH}] \\approx (3.8 \\times 10^{7}) \\times (6.094 \\times 10^{-2}) \\approx 2.316 \\times 10^{6}\\ \\mathrm{s^{-1}}\n\\end{align*}\n分母为 $1.950 \\times 10^{4} + 2.316 \\times 10^{6} \\approx 2.336 \\times 10^{6}\\ \\mathrm{s^{-1}}$。\n$\\mathrm{N}$ 的准稳态浓度为：\n$$\n[\\mathrm{N}]_{\\mathrm{qss}} = \\frac{2.327 \\times 10^{-8}\\ \\mathrm{mol\\,m^{-3}\\,s^{-1}}}{2.336 \\times 10^{6}\\ \\mathrm{s^{-1}}} \\approx 9.961 \\times 10^{-15}\\ \\mathrm{mol\\,m^{-3}}\n$$\n利用 $[\\mathrm{N}]_{\\mathrm{qss}}$，我们可以计算消耗速率 $\\dot{\\omega}_2$ 和 $\\dot{\\omega}_3$：\n$$\n\\dot{\\omega}_2 = k_2 [\\mathrm{N}]_{\\mathrm{qss}} [\\mathrm{O_2}] = (1.950 \\times 10^{4}) \\times (9.961 \\times 10^{-15}) \\approx 1.942 \\times 10^{-10}\\ \\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\n$$\n\\dot{\\omega}_3 = k_3 [\\mathrm{N}]_{\\mathrm{qss}} [\\mathrm{OH}] = (2.316 \\times 10^{6}) \\times (9.961 \\times 10^{-15}) \\approx 2.307 \\times 10^{-8}\\ \\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\n（作为验证：$\\dot{\\omega}_2 + \\dot{\\omega}_3 \\approx 1.942 \\times 10^{-10} + 2.307 \\times 10^{-8} \\approx 2.326 \\times 10^{-8}$，这与 $\\dot{\\omega}_1$ 相符）。\n\n问题将限速反应定义为控制总生成时间尺度的步骤。$\\mathrm{NO}$ 的净生成速率是其在所有三个反应中生成速率的总和：\n$$\n\\frac{d[\\mathrm{NO}]}{dt} = \\dot{\\omega}_1 + \\dot{\\omega}_2 + \\dot{\\omega}_3\n$$\n将准稳态近似条件 $\\dot{\\omega}_2 + \\dot{\\omega}_3 \\approx \\dot{\\omega}_1$ 代入 $\\mathrm{NO}$ 的速率方程：\n$$\n\\frac{d[\\mathrm{NO}]}{dt} = \\dot{\\omega}_1 + (\\dot{\\omega}_1) = 2\\dot{\\omega}_1\n$$\nZeldovich 机理的这个基本结果表明，$\\mathrm{NO}$ 的总生成速率与反应 (1) 的反应速率成正比。$\\mathrm{NO}$ 的生成时间尺度与此速率成反比。因此，反应 (1) 是控制时间尺度的步骤；它是限速反应。\n\n从物理上讲，这是因为反应 (1) 具有非常高的活化能 ($E_{a,1}/R_u = 38370\\ \\mathrm{K}$)，使其速率系数 $k_1$ 在典型的燃烧温度下极小。这个反应涉及断裂 $\\mathrm{N_2}$ 的强三键，是限制 $\\mathrm{N}$ 原子供应的瓶颈。消耗高活性 $\\mathrm{N}$ 原子的后续反应 (2) 和 (3) 要快得多（在此模型中活化能为零）。\n\n计算值表明，$\\dot{\\omega}_2$ 比 $\\dot{\\omega}_1$ 和 $\\dot{\\omega}_3$ 小两个数量级。这并不意味着反应 (2) 是整个过程的限速步骤。它表明，在这些条件下，反应 (3) 是 $\\mathrm{N}$ 原子的主要消耗路径，其速率大约是反应 (2) 的 100 倍。然而，整个反应序列的进行速度不能快于 $\\mathrm{N}$ 原子生成的缓慢初始步骤。\n\n因此，限速反应是反应 (1)。索引为 $i=1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在真实的火焰中，多种NO生成途径（如热力型、快速型、NNH型等）同时存在并相互竞争。这个高级练习  将向您介绍路径通量分析（Path Flux Analysis, PFA），这是一种用于定量确定各途径贡献的计算技术。完成此练习将让您亲身体验现代计算燃烧学研究中用于解析复杂化学反应网络的实用方法。",
            "id": "4071217",
            "problem": "您的任务是使用路径通量分析 (Path Flux Analysis, PFA) 来模拟常压下化学计量甲烷-空气火焰中的一氧化氮 (NO) 生成路径。目标是计算在火焰中 NO 产生率最大的点上，三种路径——热力型、快速型和 $\\mathrm{NNH}$ 型——对净 NO 生成速率的分数贡献。计算必须使用基元反应的质量作用动力学、Arrhenius 速率常数和理想气体定律进行。\n\n从以下基本原理出发：\n- 基元反应的质量作用动力学：反应速率为 $r = k(T)\\prod_j [X_j]^{\\nu_j}$，其中 $k(T)$ 是与温度相关的速率常数，$[X_j]$ 是摩尔浓度（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$），$\\nu_j$ 是反应物的化学计量级数。\n- Arrhenius 速率常数定律：$k(T) = A\\,T^n\\,\\exp\\!\\left(-E_a / (R\\,T)\\right)$，其中 $A$ 是指前因子，$n$ 是温度指数，$E_a$ 是活化能（单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$），$R$ 是通用气体常数，$T$ 是温度（单位为 $\\mathrm{K}$）。\n- 用于总摩尔浓度的理想气体定律：$C_{\\mathrm{tot}} = p / (R\\,T)$，其中 $p$ 是压力（单位为 $\\mathrm{Pa}$），$R$ 是通用气体常数（单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），$T$ 是温度（单位为 $\\mathrm{K}$）；物种的摩尔浓度为 $[X_i] = X_i\\,C_{\\mathrm{tot}}$，其中 $X_i$ 是物种 $i$ 的摩尔分数。\n\n使用以下捕捉了这三种路径的简化化学反应集：\n\n热力型氮氧化物 (NO) 机理 (Zel’dovich)：\n- $\\mathrm{N_2} + \\mathrm{O} \\rightarrow \\mathrm{NO} + \\mathrm{N}$，参数为 $A_1 = 6.4\\times 10^{3}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$，$n_1 = 0$，$E_{a,1} = 3.18\\times 10^{5}\\,\\mathrm{J\\,mol^{-1}}$。\n- $\\mathrm{N} + \\mathrm{O_2} \\rightarrow \\mathrm{NO} + \\mathrm{O}$，参数为 $A_2 = 1.8\\times 10^{4}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$，$n_2 = 0$，$E_{a,2} = 7.0\\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$。\n- $\\mathrm{N} + \\mathrm{OH} \\rightarrow \\mathrm{NO} + \\mathrm{H}$，参数为 $A_3 = 3.8\\times 10^{4}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$，$n_3 = 0$，$E_{a,3} = 0\\,\\mathrm{J\\,mol^{-1}}$。\n\n快速型氮氧化物 (NO) 机理 (Fenimore；燃料自由基攻击 $\\mathrm{N_2}$ 产生燃料氮，最终生成 NO)：\n- $\\mathrm{CH} + \\mathrm{N_2} \\rightarrow \\mathrm{HCN} + \\mathrm{N}$，参数为 $A_4 = 3.0\\times 10^{6}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$，$n_4 = 0$，$E_{a,4} = 0\\,\\mathrm{J\\,mol^{-1}}$。\n在此简化模型中，通过快速路径生成的 NO 被认为是源自燃料自由基对 $\\mathrm{N_2}$ 攻击所产生的 $\\mathrm{N}$ 原子生成的那部分 NO；该部分通过在 $\\mathrm{N}$ 的来源之间划分其在 NO 生成反应中的消耗速率来确定。\n\n$\\mathrm{NNH}$ 路径：\n- $\\mathrm{NNH} + \\mathrm{O} \\rightarrow \\mathrm{NH} + \\mathrm{NO}$，参数为 $A_5 = 7.0\\times 10^{4}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$，$n_5 = 0$，$E_{a,5} = 0\\,\\mathrm{J\\,mol^{-1}}$。\n\n令通用气体常数为 $R = 8.3145\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，且所有情况下的压力均为 $p = 101325\\,\\mathrm{Pa}$。对于每个火焰，您会得到沿火焰的一系列状态，并指定了温度和物种摩尔分数。将一个状态下的净 NO 生成速率定义为所列出的四个 NO 生成反应（$\\mathrm{N_2} + \\mathrm{O}$、$\\mathrm{N} + \\mathrm{O_2}$、$\\mathrm{N} + \\mathrm{OH}$ 和 $\\mathrm{NNH} + \\mathrm{O}$）的生成速率之和。确定净 NO 生成速率最大的状态，并计算来自以下路径的 NO 分数贡献：\n- 热力型路径：来自 $\\mathrm{N_2} + \\mathrm{O}$ 的直接 NO，加上来自 $\\mathrm{N} + \\mathrm{O_2}$ 和 $\\mathrm{N} + \\mathrm{OH}$ 的 NO 中可归因于源自热力型步骤 $\\mathrm{N_2} + \\mathrm{O}$ 的 $\\mathrm{N}$ 的那部分。\n- 快速型路径：来自 $\\mathrm{N} + \\mathrm{O_2}$ 和 $\\mathrm{N} + \\mathrm{OH}$ 的 NO 中可归因于源自 $\\mathrm{CH} + \\mathrm{N_2}$ 的 $\\mathrm{N}$ 的那部分。\n- $\\mathrm{NNH}$ 路径：来自 $\\mathrm{NNH} + \\mathrm{O}$ 的直接 NO。\n\n假设在所选状态下，通过相对来源速率，$\\mathrm{N}$ 原子池达到准稳态划分：\n- $\\mathrm{N}$ 的热力型来源：$\\mathrm{N_2} + \\mathrm{O}$。\n- $\\mathrm{N}$ 的快速型来源：$\\mathrm{CH} + \\mathrm{N_2}$。\n将 $\\mathrm{N}$ 在 NO 生成反应（$\\mathrm{N} + \\mathrm{O_2}$ 和 $\\mathrm{N} + \\mathrm{OH}$）中的消耗速率按比例分配给这些来源速率。\n\n将最终的分数贡献表示为四舍五入到四位小数的浮点数。不涉及角度。物理量必须以国际单位制 (SI) 计算，摩尔浓度单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，温度单位为 $\\mathrm{K}$，压力单位为 $\\mathrm{Pa}$，速率单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n\n测试套件：\n提供三个测试用例。每个测试用例包含三个火焰状态；对于每个状态，都给出了温度和物种摩尔分数。对于本问题，未列出的物种摩尔分数为零。对于每个测试用例，确定净 NO 生成速率最大的状态并输出分数贡献。\n\n- 测试用例 $1$（常压下基准化学计量甲烷-空气火焰）：\n  - 状态 A：$T = 1700\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.780, X_{\\mathrm{O_2}} = 0.050, X_{\\mathrm{O}} = 1.0\\times 10^{-5}, X_{\\mathrm{OH}} = 5.0\\times 10^{-5}, X_{\\mathrm{H}} = 2.0\\times 10^{-5}, X_{\\mathrm{CH}} = 1.0\\times 10^{-7}, X_{\\mathrm{HCN}} = 1.0\\times 10^{-7}, X_{\\mathrm{CN}} = 5.0\\times 10^{-8}, X_{\\mathrm{NNH}} = 1.0\\times 10^{-7}, X_{\\mathrm{N}} = 1.0\\times 10^{-8}\\}$。\n  - 状态 B：$T = 2000\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.770, X_{\\mathrm{O_2}} = 0.020, X_{\\mathrm{O}} = 5.0\\times 10^{-5}, X_{\\mathrm{OH}} = 2.0\\times 10^{-4}, X_{\\mathrm{H}} = 1.0\\times 10^{-4}, X_{\\mathrm{CH}} = 5.0\\times 10^{-7}, X_{\\mathrm{HCN}} = 5.0\\times 10^{-7}, X_{\\mathrm{CN}} = 2.0\\times 10^{-7}, X_{\\mathrm{NNH}} = 5.0\\times 10^{-7}, X_{\\mathrm{N}} = 5.0\\times 10^{-7}\\}$。\n  - 状态 C：$T = 2200\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.760, X_{\\mathrm{O_2}} = 0.010, X_{\\mathrm{O}} = 8.0\\times 10^{-5}, X_{\\mathrm{OH}} = 3.0\\times 10^{-4}, X_{\\mathrm{H}} = 2.0\\times 10^{-4}, X_{\\mathrm{CH}} = 2.0\\times 10^{-7}, X_{\\mathrm{HCN}} = 1.0\\times 10^{-6}, X_{\\mathrm{CN}} = 3.0\\times 10^{-7}, X_{\\mathrm{NNH}} = 3.0\\times 10^{-7}, X_{\\mathrm{N}} = 2.0\\times 10^{-6}\\}$。\n\n- 测试用例 $2$（极低的 $\\mathrm{CH}$ 导致快速型贡献可忽略的边界条件）：\n  - 状态 A：$T = 1800\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.780, X_{\\mathrm{O_2}} = 0.030, X_{\\mathrm{O}} = 2.0\\times 10^{-5}, X_{\\mathrm{OH}} = 1.0\\times 10^{-4}, X_{\\mathrm{H}} = 5.0\\times 10^{-5}, X_{\\mathrm{CH}} = 1.0\\times 10^{-9}, X_{\\mathrm{NNH}} = 2.0\\times 10^{-7}, X_{\\mathrm{N}} = 1.0\\times 10^{-7}\\}$。\n  - 状态 B：$T = 2000\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.770, X_{\\mathrm{O_2}} = 0.015, X_{\\mathrm{O}} = 4.0\\times 10^{-5}, X_{\\mathrm{OH}} = 2.5\\times 10^{-4}, X_{\\mathrm{H}} = 1.5\\times 10^{-4}, X_{\\mathrm{CH}} = 5.0\\times 10^{-10}, X_{\\mathrm{NNH}} = 4.0\\times 10^{-7}, X_{\\mathrm{N}} = 5.0\\times 10^{-7}\\}$。\n  - 状态 C：$T = 2150\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.760, X_{\\mathrm{O_2}} = 0.010, X_{\\mathrm{O}} = 7.0\\times 10^{-5}, X_{\\mathrm{OH}} = 2.8\\times 10^{-4}, X_{\\mathrm{H}} = 1.8\\times 10^{-4}, X_{\\mathrm{CH}} = 1.0\\times 10^{-9}, X_{\\mathrm{NNH}} = 3.0\\times 10^{-7}, X_{\\mathrm{N}} = 1.5\\times 10^{-6}\\}$。\n\n- 测试用例 $3$（无 $\\mathrm{NNH}$ 导致 $\\mathrm{NNH}$ 贡献为零的边缘情况）：\n  - 状态 A：$T = 1900\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.780, X_{\\mathrm{O_2}} = 0.025, X_{\\mathrm{O}} = 2.5\\times 10^{-5}, X_{\\mathrm{OH}} = 1.2\\times 10^{-4}, X_{\\mathrm{H}} = 6.0\\times 10^{-5}, X_{\\mathrm{CH}} = 3.0\\times 10^{-7}, X_{\\mathrm{NNH}} = 0.0, X_{\\mathrm{N}} = 2.0\\times 10^{-7}\\}$。\n  - 状态 B：$T = 2050\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.770, X_{\\mathrm{O_2}} = 0.012, X_{\\mathrm{O}} = 5.5\\times 10^{-5}, X_{\\mathrm{OH}} = 2.2\\times 10^{-4}, X_{\\mathrm{H}} = 1.2\\times 10^{-4}, X_{\\mathrm{CH}} = 2.0\\times 10^{-7}, X_{\\mathrm{NNH}} = 0.0, X_{\\mathrm{N}} = 8.0\\times 10^{-7}\\}$。\n  - 状态 C：$T = 2250\\,\\mathrm{K}$，摩尔分数 $\\{X_{\\mathrm{N_2}} = 0.760, X_{\\mathrm{O_2}} = 0.010, X_{\\mathrm{O}} = 9.0\\times 10^{-5}, X_{\\mathrm{OH}} = 3.5\\times 10^{-4}, X_{\\mathrm{H}} = 2.2\\times 10^{-4}, X_{\\mathrm{CH}} = 1.0\\times 10^{-7}, X_{\\mathrm{NNH}} = 0.0, X_{\\mathrm{N}} = 2.5\\times 10^{-6}\\}$。\n\n您的程序应生成单行输出，其中包含每个测试用例在最大 NO 产生状态下的三个浮点数列表 $[\\text{thermal}, \\text{prompt}, \\text{NNH}]$，代表分数贡献，所有数值四舍五入到四位小数，并聚合到一个顶层列表中。例如，一个有效的输出格式是 $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$。",
            "solution": "该问题是有效的，因为它科学地基于化学动力学和燃烧建模的原理，问题陈述清晰，提供了所有必要的数据和明确的指令，并以客观、正式的语言表达。我们可以着手解决。\n\n问题的核心是对火焰中一氧化氮 ($\\mathrm{NO}$) 生成的简化化学机理进行路径通量分析 (PFA)。我们必须首先从一系列给定的火焰状态中确定 $\\mathrm{NO}$ 产生率最大的点，然后在该特定状态下，确定热力型、快速型和 $\\mathrm{NNH}$ 路径对总 $\\mathrm{NO}$ 生成速率的分数贡献。\n\n解决方案按以下步骤展开：\n\n**1. 计算摩尔浓度**\n问题以摩尔分数 ($X_i$) 的形式在给定的温度 ($T$) 和压力 ($p$) 下提供物种数据。要使用质量作用动力学，我们必须使用摩尔浓度 ($[X_i]$)。根据理想气体定律，气体混合物的总摩尔浓度 $C_{\\mathrm{tot}}$ 由下式给出：\n$$\nC_{\\mathrm{tot}} = \\frac{p}{R T}\n$$\n其中 $p$ 是压力（单位为 $\\mathrm{Pa}$），$T$ 是温度（单位为 $\\mathrm{K}$），$R$ 是通用气体常数 ($R = 8.3145\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$)。然后，单个物种 $i$ 的摩尔浓度为：\n$$\n[X_i] = X_i \\cdot C_{\\mathrm{tot}}\n$$\n所有浓度的单位均为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n**2. 计算反应速率**\n基元反应的速率由质量作用动力学确定。对于一般的双分子反应 $R_1 + R_2 \\rightarrow \\text{Products}$，速率 $r$ 为：\n$$\nr = k(T) [R_1] [R_2]\n$$\n与温度相关的速率常数 $k(T)$ 由 Arrhenius 定律给出：\n$$\nk(T) = A\\,T^n\\,\\exp\\!\\left(-\\frac{E_a}{R T}\\right)\n$$\n其中 $A$ 是指前因子，$n$ 是温度指数，$E_a$ 是活化能。\n\n使用提供的动力学参数，我们计算简化机理中五个基元反应的速率：\n- (R1) $\\mathrm{N_2} + \\mathrm{O} \\rightarrow \\mathrm{NO} + \\mathrm{N}$: $r_1 = k_1(T) [\\mathrm{N_2}] [\\mathrm{O}]$\n- (R2) $\\mathrm{N} + \\mathrm{O_2} \\rightarrow \\mathrm{NO} + \\mathrm{O}$: $r_2 = k_2(T) [\\mathrm{N}] [\\mathrm{O_2}]$\n- (R3) $\\mathrm{N} + \\mathrm{OH} \\rightarrow \\mathrm{NO} + \\mathrm{H}$: $r_3 = k_3(T) [\\mathrm{N}] [\\mathrm{OH}]$\n- (R4) $\\mathrm{CH} + \\mathrm{N_2} \\rightarrow \\mathrm{HCN} + \\mathrm{N}$: $r_4 = k_4(T) [\\mathrm{CH}] [\\mathrm{N_2}]$\n- (R5) $\\mathrm{NNH} + \\mathrm{O} \\rightarrow \\mathrm{NH} + \\mathrm{NO}$: $r_5 = k_5(T) [\\mathrm{NNH}] [\\mathrm{O}]$\n\n**3. 确定最大产生状态**\n$\\mathrm{NO}$ 的净生成速率，记为 $\\omega_{\\mathrm{NO,net}}$，是所有产生 $\\mathrm{NO}$ 的反应速率之和。在此机理中，这些是反应 R1、R2、R3 和 R5。\n$$\n\\omega_{\\mathrm{NO,net}} = r_1 + r_2 + r_3 + r_5\n$$\n对于每个测试用例，我们为每个提供的火焰状态计算 $\\omega_{\\mathrm{NO,net}}$。$\\omega_{\\mathrm{NO,net}}$ 值最高的状态被确定为 $\\mathrm{NO}$ 产量最大的点。后续分析将使用在此特定状态下计算的反应速率，我们用星号 ($r_i^*$) 表示。\n\n**4. NO 生成的路径通量分析 (PFA)**\n在 $\\mathrm{NO}$ 产生率最大的状态下，我们将总 $\\mathrm{NO}$ 生成速率 $\\omega_{\\mathrm{NO,net}}^*$ 分解为三个已定义路径的贡献。这需要分析关键中间物种——氮原子 ($\\mathrm{N}$)——的产生和消耗。\n\n- **氮原子 ($\\mathrm{N}$) 的来源：**\n在此机理中，N 原子由热力型路径 (R1) 和快速型路径 (R4) 产生。\n  - 热力型来源速率：$S_{\\mathrm{N,th}} = r_1^*$\n  - 快速型来源速率：$S_{\\mathrm{N,pr}} = r_4^*$\nN 原子的总来源速率为 $S_{\\mathrm{N,tot}} = S_{\\mathrm{N,th}} + S_{\\mathrm{N,pr}} = r_1^* + r_4^*$。\n\n- **N 原子通量的划分：**\n产生的 N 原子在反应 R2 和 R3 中被消耗以生成 $\\mathrm{NO}$。我们假设 N 原子处于准稳态，并根据每个来源对总 N 原子池的分数贡献来划分此消耗。\n  - 来自热力型路径的 N 原子分数：$f_{\\mathrm{N,th}} = \\frac{S_{\\mathrm{N,th}}}{S_{\\mathrm{N,tot}}} = \\frac{r_1^*}{r_1^* + r_4^*}$\n  - 来自快速型路径的 N 原子分数：$f_{\\mathrm{N,pr}} = \\frac{S_{\\mathrm{N,pr}}}{S_{\\mathrm{N,tot}}} = \\frac{r_4^*}{r_1^* + r_4^*}$\n如果 $S_{\\mathrm{N,tot}} = 0$，则两个分数均取为 $0$。\n\n- **按路径划分的 $\\mathrm{NO}$ 生成速率：**\n我们现在可以定义归因于每个路径的 $\\mathrm{NO}$ 生成速率。\n  - **热力型路径 ($\\omega_{\\mathrm{NO,th}}$)：** 这包括来自 R1 的直接 $\\mathrm{NO}$ 生成，加上来自 R2 和 R3 的 $\\mathrm{NO}$ 中源自热力型产生的 N 原子的部分。\n    $$\n    \\omega_{\\mathrm{NO,th}} = r_1^* + f_{\\mathrm{N,th}}(r_2^* + r_3^*)\n    $$\n  - **快速型路径 ($\\omega_{\\mathrm{NO,pr}}$)：** 这是来自 R2 和 R3 的 $\\mathrm{NO}$ 中源自快速型产生的 N 原子的部分。\n    $$\n    \\omega_{\\mathrm{NO,pr}} = f_{\\mathrm{N,pr}}(r_2^* + r_3^*)\n    $$\n  - **NNH 路径 ($\\omega_{\\mathrm{NO,NNH}}$)：** 这是来自 R5 的直接 $\\mathrm{NO}$ 生成。\n    $$\n    \\omega_{\\mathrm{NO,NNH}} = r_5^*\n    $$\n这些路径速率之和等于净 $\\mathrm{NO}$ 生成速率：$\\omega_{\\mathrm{NO,th}} + \\omega_{\\mathrm{NO,pr}} + \\omega_{\\mathrm{NO,NNH}} = \\omega_{\\mathrm{NO,net}}^*$。\n\n**5. 计算分数贡献**\n最后，每个路径的分数贡献是其特定生成速率与分析点总净 $\\mathrm{NO}$ 生成速率之比。\n- 热力型分数：$F_{\\mathrm{th}} = \\frac{\\omega_{\\mathrm{NO,th}}}{\\omega_{\\mathrm{NO,net}}^*}$\n- 快速型分数：$F_{\\mathrm{pr}} = \\frac{\\omega_{\\mathrm{NO,pr}}}{\\omega_{\\mathrm{NO,net}}^*}$\n- NNH 分数：$F_{\\mathrm{NNH}} = \\frac{\\omega_{\\mathrm{NO,NNH}}}{\\omega_{\\mathrm{NO,net}}^*}$\n\n这三个分数四舍五入到四位小数，构成了每个测试用例的最终答案。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fractional contributions of thermal, prompt, and NNH pathways to\n    NO formation in a stoichiometric methane-air flame.\n    \"\"\"\n    R = 8.3145  # Universal gas constant in J/(mol K)\n    P = 101325  # Pressure in Pa\n\n    kinetics_params = {\n        'R1': {'A': 6.4e3, 'n': 0.0, 'Ea': 3.18e5},  # N2 + O -> NO + N\n        'R2': {'A': 1.8e4, 'n': 0.0, 'Ea': 7.0e4},   # N + O2 -> NO + O\n        'R3': {'A': 3.8e4, 'n': 0.0, 'Ea': 0.0},      # N + OH -> NO + H\n        'R4': {'A': 3.0e6, 'n': 0.0, 'Ea': 0.0},      # CH + N2 -> HCN + N\n        'R5': {'A': 7.0e4, 'n': 0.0, 'Ea': 0.0},      # NNH + O -> NH + NO\n    }\n\n    test_cases = [\n        # Test Case 1\n        [\n            {'T': 1700, 'X': {'N2': 0.780, 'O2': 0.050, 'O': 1.0e-5, 'OH': 5.0e-5, 'H': 2.0e-5, 'CH': 1.0e-7, 'HCN': 1.0e-7, 'CN': 5.0e-8, 'NNH': 1.0e-7, 'N': 1.0e-8}},\n            {'T': 2000, 'X': {'N2': 0.770, 'O2': 0.020, 'O': 5.0e-5, 'OH': 2.0e-4, 'H': 1.0e-4, 'CH': 5.0e-7, 'HCN': 5.0e-7, 'CN': 2.0e-7, 'NNH': 5.0e-7, 'N': 5.0e-7}},\n            {'T': 2200, 'X': {'N2': 0.760, 'O2': 0.010, 'O': 8.0e-5, 'OH': 3.0e-4, 'H': 2.0e-4, 'CH': 2.0e-7, 'HCN': 1.0e-6, 'CN': 3.0e-7, 'NNH': 3.0e-7, 'N': 2.0e-6}},\n        ],\n        # Test Case 2\n        [\n            {'T': 1800, 'X': {'N2': 0.780, 'O2': 0.030, 'O': 2.0e-5, 'OH': 1.0e-4, 'H': 5.0e-5, 'CH': 1.0e-9, 'NNH': 2.0e-7, 'N': 1.0e-7}},\n            {'T': 2000, 'X': {'N2': 0.770, 'O2': 0.015, 'O': 4.0e-5, 'OH': 2.5e-4, 'H': 1.5e-4, 'CH': 5.0e-10, 'NNH': 4.0e-7, 'N': 5.0e-7}},\n            {'T': 2150, 'X': {'N2': 0.760, 'O2': 0.010, 'O': 7.0e-5, 'OH': 2.8e-4, 'H': 1.8e-4, 'CH': 1.0e-9, 'NNH': 3.0e-7, 'N': 1.5e-6}},\n        ],\n        # Test Case 3\n        [\n            {'T': 1900, 'X': {'N2': 0.780, 'O2': 0.025, 'O': 2.5e-5, 'OH': 1.2e-4, 'H': 6.0e-5, 'CH': 3.0e-7, 'NNH': 0.0, 'N': 2.0e-7}},\n            {'T': 2050, 'X': {'N2': 0.770, 'O2': 0.012, 'O': 5.5e-5, 'OH': 2.2e-4, 'H': 1.2e-4, 'CH': 2.0e-7, 'NNH': 0.0, 'N': 8.0e-7}},\n            {'T': 2250, 'X': {'N2': 0.760, 'O2': 0.010, 'O': 9.0e-5, 'OH': 3.5e-4, 'H': 2.2e-4, 'CH': 1.0e-7, 'NNH': 0.0, 'N': 2.5e-6}},\n        ]\n    ]\n\n    def calculate_rates_for_state(state):\n        T = state['T']\n        X = state['X']\n        C_tot = P / (R * T)\n\n        # Molar concentrations in mol/m^3\n        conc = {sp: X.get(sp, 0.0) * C_tot for sp in ['N2', 'O', 'N', 'O2', 'OH', 'CH', 'NNH']}\n\n        # Rate constants k(T)\n        k = {}\n        for name, params in kinetics_params.items():\n            A, n, Ea = params['A'], params['n'], params['Ea']\n            k[name] = A * (T**n) * np.exp(-Ea / (R * T))\n\n        # Reaction rates in mol/m^3/s\n        rates = {}\n        rates['r1'] = k['R1'] * conc['N2'] * conc['O']\n        rates['r2'] = k['R2'] * conc['N'] * conc['O2']\n        rates['r3'] = k['R3'] * conc['N'] * conc['OH']\n        rates['r4'] = k['R4'] * conc['CH'] * conc['N2']\n        rates['r5'] = k['R5'] * conc['NNH'] * conc['O']\n\n        net_NO_rate = rates['r1'] + rates['r2'] + rates['r3'] + rates['r5']\n        return rates, net_NO_rate\n\n    results = []\n    for case_states in test_cases:\n        max_net_rate = -1.0\n        best_rates = None\n\n        for state in case_states:\n            rates, net_rate = calculate_rates_for_state(state)\n            if net_rate > max_net_rate:\n                max_net_rate = net_rate\n                best_rates = rates\n\n        r1_s, r2_s, r3_s, r4_s, r5_s = best_rates['r1'], best_rates['r2'], best_rates['r3'], best_rates['r4'], best_rates['r5']\n        \n        # Path Flux Analysis\n        S_N_th = r1_s\n        S_N_pr = r4_s\n        S_N_tot = S_N_th + S_N_pr\n\n        f_N_th, f_N_pr = 0.0, 0.0\n        if S_N_tot > 0:\n            f_N_th = S_N_th / S_N_tot\n            f_N_pr = S_N_pr / S_N_tot\n\n        # NO formation rates by pathway\n        w_NO_th = r1_s + f_N_th * (r2_s + r3_s)\n        w_NO_pr = f_N_pr * (r2_s + r3_s)\n        w_NO_NNH = r5_s\n        \n        w_NO_net_check = w_NO_th + w_NO_pr + w_NO_NNH\n\n        # Fractional contributions\n        F_th, F_pr, F_NNH = 0.0, 0.0, 0.0\n        if w_NO_net_check > 0:\n            F_th = w_NO_th / w_NO_net_check\n            F_pr = w_NO_pr / w_NO_net_check\n            F_NNH = w_NO_NNH / w_NO_net_check\n\n        results.append([round(F_th, 4), round(F_pr, 4), round(F_NNH, 4)])\n\n    # Format output as a single list of lists\n    formatted_results = '[' + ','.join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]) + ']'\n    print(formatted_results)\n\nsolve()\n```"
        }
    ]
}