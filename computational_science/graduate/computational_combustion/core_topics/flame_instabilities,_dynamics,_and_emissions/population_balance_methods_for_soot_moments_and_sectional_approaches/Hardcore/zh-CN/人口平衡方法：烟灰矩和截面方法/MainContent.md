## 引言
在[内燃机](@entry_id:200042)、航空发动机和工业锅炉等燃烧系统中，烟尘（soot）的生成是一个普遍存在且影响深远的现象。它不仅降低了燃烧效率，其排放的颗粒物还对人类健康和全球气候构成严重威胁。因此，准确预测和控制烟尘的[生成对](@entry_id:906691)于设计更清洁、更高效的燃烧设备至关重要。然而，烟尘是由数以万亿计的纳米级颗粒组成的复杂群体，其尺寸、形态和数量在毫秒级的时空尺度上剧烈变化，这给直接模拟带来了难以逾越的[计算障碍](@entry_id:898044)。群体平衡方法（Population Balance Methods）为这一挑战提供了强大的理论框架，它通过追踪颗粒尺寸分布的统计特性而非单个颗粒，实现了对烟尘动力学过程的有效建模。

尽管群体[平衡方程](@entry_id:172166)（PBE）为描述颗粒群演化提供了普适性的数学描述，但其本身的复杂性（[非线性](@entry_id:637147)积[微分形式](@entry_id:146747)）使得求解成为核心难题。这催生了多种数值求解策略，但每种方法都有其[适用范围](@entry_id:636189)和局限性，在精度、计算成本和[表示能力](@entry_id:636759)之间存在着复杂的权衡。本文旨在系统性地梳理和解析这些主流方法，填补从理论方程到实际应用的知识鸿沟，帮助研究人员和工程师根据具体问题选择和实施最合适的烟尘模型。

为了实现这一目标，本文将分为三个核心部分展开。在“原理与机制”一章中，我们将深入剖析群体[平衡方程](@entry_id:172166)的构成，并详细介绍求解该方程的两种基石方法——矩方法（MOM）与[分段法](@entry_id:1131362)（SM），同时引出更先进的求积矩方法（QMOM）以克服传统方法的局限。随后的“应用与交叉学科联系”一章将展示这些模型如何与[计算流体动力学](@entry_id:142614)（CFD）相结合，如何扩展以描述烟尘的复杂形态与组分，并探讨其与实验验证及不确定性量化的紧密联系。最后，在“动手实践”部分，我们将通过具体的编程练习，加深对关键算法（如矩方程推导和矩反演）的理解。现在，让我们从构建这一切的基础——群体[平衡方程](@entry_id:172166)的原理与机制开始。

## 原理与机制

本章深入探讨了用于模拟 soot（烟尘）的群体平衡方法的核心原理和关键机制。我们将从描述粒子群体演化的普适控制方程——群体[平衡方程](@entry_id:172166)（Population Balance Equation, PBE）——入手，系统地阐述其各项物理过程。随后，我们将详细介绍求解此复杂方程的两种主要数值策略：[矩方法](@entry_id:277025)（Method of Moments, MOM）和[分段法](@entry_id:1131362)（Sectional Method, SM）。我们将特别关注[矩方法](@entry_id:277025)中的核心挑战，即封闭问题，并引出更先进的、基于求积的[矩方法](@entry_id:277025)（Quadrature-based Moment Methods），如 QMOM 和 DQMOM。最后，我们将对这些方法进行对比分析，并讨论在具体应用中如何根据物理问题、精度要求和计算预算来选择最合适的模型。

### 群体[平衡方程](@entry_id:172166)（PBE）

描述一个由大量离散粒子组成的群体，其在物理空间和内部坐标空间（如粒子体积、表面积或[化学成分](@entry_id:138867)）中演化的最通用框架是**群体[平衡方程](@entry_id:172166) (Population Balance Equation, PBE)**。对于 soot 模拟，我们通常关心的是**[数密度](@entry_id:895657)函数 (number density function)** $n(v, \mathbf{x}, t)$，它表示在时间 $t$、物理位置 $\mathbf{x}$ 处，单位物理体积内，粒子体积在 $v$ 附近的单位体积区间内的粒子数量。因此，$n(v, \mathbf{x}, t) \, \mathrm{d}v \, \mathrm{d}\mathbf{x}$ 给出了在控制体积 $\mathrm{d}\mathbf{x}$ 内，粒子体积介于 $v$ 和 $v+\mathrm{d}v$ 之间的粒子总数。

一个完整的 PBE 考虑了所有改变[数密度](@entry_id:895657)函数的物理和化学过程，可以写成如下的守恒形式 ：
$$
\frac{\partial n}{\partial t} + \nabla_{\mathbf{x}} \cdot (\mathbf{u} n) = \nabla_{\mathbf{x}} \cdot (D \nabla_{\mathbf{x}} n) - \frac{\partial}{\partial v}(G n) + S_{\text{nuc}} + \mathcal{C}[n]
$$
其中，$\mathcal{C}[n]$ 代表聚并（coagulation）项。让我们逐一剖析方程中的各项。

**时间变化与物理输运**:
-   $\frac{\partial n}{\partial t}$ 是数密度函数在固定点的[瞬时变化率](@entry_id:141382)。
-   $\nabla_{\mathbf{x}} \cdot (\mathbf{u} n)$ 是**对流 (convection)** 项，描述了粒子被流体速度场 $\mathbf{u}$ 输运的过程。
-   $\nabla_{\mathbf{x}} \cdot (D \nabla_{\mathbf{x}} n)$ 是**扩散 (diffusion)** 项，描述了粒子由于布朗运动或其他随机运动（在[湍流](@entry_id:151300)中可能包括湍流扩散）导致的输运，其中 $D$ 是扩散系数。
在空间上，输运项仅重新分布粒子，而不改变封闭系统内的总粒子数。

**内部坐标空间输运：[表面过程](@entry_id:192310)**:
-   $-\frac{\partial}{\partial v}(G n)$ 描述了粒子在体积坐标 $v$ 上的“漂移”。这里的 $G(v, \mathbf{x}, t) = \mathrm{d}v/\mathrm{d}t$ 是单个粒子的确定性体积变化率。它包含了**表面增长 (surface growth)**（$G>0$，例如通过气体分子在粒子表面的化学反应）和**氧化 (oxidation)**（$G0$，例如粒子与氧化剂反应导致质量损失）。此项在形式上与对流项类似，但作用于内部坐标空间。重要的是，在体积区间 $(0, \infty)$ 内部，[表面过程](@entry_id:192310)本身不产生或消灭粒子，它只是将粒子从一个尺寸“移动”到另一个尺寸。因此，该项对总粒子数 $N = \int_0^\infty n \, \mathrm{d}v$ 的影响仅通过边界通量体现。例如，强烈的氧化可能导致粒子体积收缩至零 ($v=0$) 而消失，从而构成一个粒子数的汇。

**源项：生成与消亡**:
-   $S_{\text{nuc}}$ 是**成核 (nucleation)** 或初始粒子生成项，代表了气相前驱体分子通过化学反应形成最初的凝聚相粒子的过程。它通常被建模为在极小体积处（例如，对应于几个PAH[分子尺寸](@entry_id:752128)）的一个源项，是粒子数的直接来源。
-   $\mathcal{C}[n]$ 是**聚并 (coagulation)** 算子，描述了两个粒子碰撞并合并成一个更大粒子的过程。它包含一个“生成”项和一个“消亡”项：
    $$
    \mathcal{C}[n] = \underbrace{\frac{1}{2} \int_{0}^{v} K(v-v', v') n(v-v') n(v') \, \mathrm{d}v'}_{\text{生成 (Birth)}} - \underbrace{n(v) \int_{0}^{\infty} K(v, v') n(v') \, \mathrm{d}v'}_{\text{消亡 (Death)}}
    $$
    生成项表示一个体积为 $v$ 的粒子由两个更小的粒子（体积分别为 $v'$ 和 $v-v'$）碰撞形成，因子 $\frac{1}{2}$ 用于避免重复计数。消亡项表示体积为 $v$ 的粒子与任何其他体积为 $v'$ 的[粒子碰撞](@entry_id:160531)而消失。$K(v, v')$ 是**聚并核函数 (coagulation kernel)**，它量化了体积为 $v$ 和 $v'$ 的两个粒子碰撞的速率。聚并过程的净效应是减少总粒子数 $N$，因为每次碰撞事件都使粒子总数减一，但它在没有相变成气相的情况下守恒总[粒子质量](@entry_id:156313)（或体积）。

### 源项的物理模型

PBE 的预测能力在很大程度上取决于其中物理模型（如 $G$ 和 $K$）的准确性。

**聚并[核函数](@entry_id:145324) (Coagulation Kernel)**
对于 soot 模拟，聚并核函数 $K(v,v')$ 必须考虑粒子的尺寸和形态。
-   **球形粒子的布朗聚并**: 在分子平均自由程远小于粒子直径的**连续区 (continuum regime)**，两个球形粒子的布朗聚并[核函数](@entry_id:145324)可以通过 Smoluchowski 扩散捕获理论和 Stokes-Einstein 关系推导得出 。结果表明，核函数与温度 $T$ 成正比，与气体[动力粘度](@entry_id:268228) $\mu$ 成反比：
    $$
    K(v, v') = \frac{2 k_B T}{3 \mu} \left[ 2 + \left(\frac{v}{v'}\right)^{1/3} + \left(\frac{v'}{v}\right)^{1/3} \right]
    $$
    其中 $k_B$ 是玻尔兹曼常数。这里的指数 $1/3$ 直接来源于球形几何中体积 $v$ 与直径 $d_p$ 的关系 ($v \propto d_p^3$)。

-   **分形聚集体的聚并**: 真实的 soot 粒子通常是由许多原生小球（primary spherules）组成的松散聚集体，其形态可以用**分形维数 (fractal dimension)** $D_f$ 来描述（对于 soot 聚集体，通常 $D_f \approx 1.7-1.8$）。分形形态改变了粒子的[流体动力学半径](@entry_id:273011)和碰撞截面。通过引入分形标度关系，可以推导出修正后的聚并核函数 ：
    $$
    K(v, v'; D_f) = \frac{2 k_B T}{3 \mu} \frac{C_c}{C_h} \left[ 2 + \left(\frac{v}{v'}\right)^{1/D_f} + \left(\frac{v'}{v}\right)^{1/D_f} \right]
    $$
    其中，指数 $1/3$ 被 $1/D_f$ 替代，反映了分形几何中[标度关系](@entry_id:273705)的变化。$C_c$ 和 $C_h$ 是与形态相关的常数，分别与碰撞半径和[流体动力学半径](@entry_id:273011)有关。这个表达式更准确地描述了真实 soot 聚集体的碰撞行为。

**表面增长率 (Surface Growth Rate)**
表面增长率 $G(v)$ 取决于气相物质的浓度、温度以及粒子的可用表面积。对于紧凑的球形粒子，表面积 $S$ 与体积 $v$ 的关系是 $S \propto v^{2/3}$。因此，如果表面反应速率与表面积成正比，那么增长率也应如此，即 $G(v) \propto v^{2/3}$ 。这一标度关系对于理解矩方法的封闭问题至关重要。

### 矩方法 (The Method of Moments, MOM)

PBE 是一个复杂的[非线性](@entry_id:637147)积[微分](@entry_id:158422)方程，直接求解成本高昂。[矩方法](@entry_id:277025)是一种广泛应用的[降维技术](@entry_id:169164)，其核心思想是放弃追踪完整的[数密度](@entry_id:895657)函数 $n(v,t)$，转而追踪其几个低阶的**矩 (moments)**。

**矩的定义与物理解释**
第 $k$ 阶（原始）矩 $M_k$ 定义为：
$$
M_k = \int_{0}^{\infty} v^k n(v) \, \mathrm{d}v
$$
低阶矩具有明确的物理意义 ：
-   **$M_0$ (零阶矩)**: $M_0 = \int v^0 n(v) \, \mathrm{d}v = \int n(v) \, \mathrm{d}v = N$，即**总粒子[数密度](@entry_id:895657)**。
-   **$M_1$ (一阶矩)**: $M_1 = \int v^1 n(v) \, \mathrm{d}v = V_T$，即**总粒子体积分数**，它与总质量浓度成正比（$C_m = \rho_s M_1$，其中 $\rho_s$ 是 soot 材料密度）。
-   **$M_{2/3}$ (分数阶矩)**: 对于球形粒子，总表面积浓度 $A_T$ 与 $M_{2/3}$ 成正比，$A_T = (36\pi)^{1/3} M_{2/3}$。这说明分数阶矩对于预测依赖于表面积的物理过程（如辐射传热）至关重要。

通过将 PBE 乘以 $v^k$ 并对整个体积域积分，可以推导出关于矩 $M_k$ 的[输运方程](@entry_id:174281)。这个过程将原始的积[微分](@entry_id:158422)方程转化为一个关于矩的常微分方程组（对于空间均匀问题）或偏微分方程组。

**封闭问题 (The Closure Problem)**
[矩方法](@entry_id:277025)的优雅之处在于其[降维](@entry_id:142982)能力，但这种[降维](@entry_id:142982)并非没有代价。在推导[矩方程](@entry_id:149666)时，我们会发现右侧的源项通常无法仅用被追踪的有限个矩来表示。这就是所谓的**封闭问题 (closure problem)**，它是矩方法的核心挑战 。
-   **聚并导致的封闭**: 聚并项对 $M_k$ 的贡献是一个复杂的双重积分。即使对于最简单的核函数，这个积分通常也不是被追踪矩（如 $M_0, M_1, M_2, \dots$）的简单函数。
-   **表面增长导致的封闭**: 如前所述，对于物理上合理的表面增长率 $G(v) \propto v^{2/3}$，第 $k$ 阶矩方程的增长项将依赖于一个未知的**分数阶矩** $M_{k-1+2/3}$：
    $$
    \left(\frac{\mathrm{d}M_k}{\mathrm{d}t}\right)_{\text{growth}} = k \int_0^\infty v^{k-1} G(v) n(v) \, \mathrm{d}v \propto k M_{k-1+2/3}
    $$
    如果只追踪整数阶矩，那么这个分数阶矩就是未知的。

为了解决封闭问题，传统的矩方法通常**假设一个特定的函数形式**来表示 $n(v,t)$，例如[对数正态分布](@entry_id:261888)。一旦假设了分布形状，所有矩（包括分数阶和[高阶矩](@entry_id:266936)）都可以用被追踪的几个低阶矩来表示，从而封闭方程组。然而，这种方法的缺点是，如果真实的粒子尺寸分布（PSD）偏离了假设的形状（例如，呈现出双峰形态），模型的预测精度就会显著下降。

### [分段法](@entry_id:1131362) (The Sectional Method, SM)

[分段法](@entry_id:1131362)是另一种主流的 PBE 求解方法，它采用更直接的离散化策略。

**核心思想与方程构建**
[分段法](@entry_id:1131362)的核心是将粒子体积坐标轴 $[v_{\min}, v_{\max}]$ 划分为 $J$ 个不重叠的**分段 (sections)** 或“箱子” $[v_j, v_{j+1}]$。该方法不追踪矩，而是追踪每个分段内的**粒子总数** $N_j(t) = \int_{v_j}^{v_{j+1}} n(v,t) \, \mathrm{d}v$（或总质量）。

通过对每个分段积分 PBE，并采用[有限体积法](@entry_id:141374)的思想，可以得到关于 $N_j$ 的[常微分方程组](@entry_id:907499) 。
$$
\frac{\mathrm{d}N_j}{\mathrm{d}t} = \text{Flux}_{\text{in}, j} - \text{Flux}_{\text{out}, j} + S_j
$$
-   **表面增长**: 表面增长项被处理为跨越分段边界的粒子数通量。这在数学上是一个平流（advection）过程，其中 $G(v)$ 是平流速度。为了保证数值解的稳定性和物理上的[正定性](@entry_id:149643)（粒子数不能为负），必须采用**迎风格式 (upwind scheme)** 来计算这些通量。例如，当 $G>0$（增长）时，从分段 $j$ 流出到分段 $j+1$ 的通量取决于分段 $j$ 内的粒子密度，而流入分段 $j$ 的通量则取决于上游分段 $j-1$ 的粒子密度。
-   **聚并与成核**: 成核直接作为源项添加到对应尺寸的分段中。聚并则被离散化为粒子在不同分段之间的转移。例如，一个来自 $i$ 分段的粒子和一个来自 $j$ 分段的粒子聚并后，会从这两个分段中移除，并根据其新生成的体积，添加到一个新的 $k$ 分段中。直接计算所有分段对之间的相互作用导致计算成本随分段数 $N_s$ 的平方增长，即 $O(N_s^2)$。

[分段法](@entry_id:1131362)的主要优点是它不依赖于任何关于分布形状的假设，因此能够灵活地表示任意形状的分布，包括多峰分布。其缺点是计算成本较高，并且表面增长项的离散化会引入数值扩散，可能导致分布的尖锐特征被平滑掉。

### 高级[矩方法](@entry_id:277025)：求积矩方法

为了克服传统[矩方法](@entry_id:277025)对分布形状假设的限制，同时保持比[分段法](@entry_id:1131362)更低的计算成本，**求积[矩方法](@entry_id:277025) (Quadrature Method of Moments, QMOM)** 应运而生。

**QMOM 的原理**
QMOM 的核心思想是用一个**加权狄拉克 $\delta$ 函数之和**来近似[数密度](@entry_id:895657)函数 $n(v,t)$，这在数学上等价于一个离散的[求积法则](@entry_id:753909)（quadrature rule） ：
$$
n(v,t) \approx \sum_{i=1}^{N} w_i(t) \delta(v - x_i(t))
$$
其中，$N$ 是求积节点的数量，$x_i$ 是节点的位置（**横坐标**），$w_i$ 是对应的**权重**。这意味着粒子群体被近似为 $N$ 个离散的类别，每个类别中的粒子都具有相同的体积 $x_i$，其[数密度](@entry_id:895657)为 $w_i$。

利用这个近似，任何关于 $n(v,t)$ 的积分都可以被替换为一个求和：
$$
\int_{0}^{\infty} \phi(v) n(v,t) \, \mathrm{d}v \approx \sum_{i=1}^{N} w_i(t) \phi(x_i(t))
$$
这巧妙地解决了封闭问题。例如，表面增长项中的分数阶矩可以被精确计算为 $M_{k-1+2/3} \approx \sum w_i x_i^{k-1+2/3}$。同样，聚并的双重积分也被替换为双[重求和](@entry_id:275405)。

QMOM 的算法流程如下：
1.  **输运矩**: 求解 $2N$ 个矩（通常是 $M_0$ 到 $M_{2N-1}$）的[输运方程](@entry_id:174281)。
2.  **矩反演**: 在每个时间步和每个网格单元，通过求解一个[非线性](@entry_id:637147)[代数方程](@entry_id:272665)组，从已知的 $2N$ 个矩中反演出 $N$ 个权重 $w_i$ 和 $N$ 个横坐标 $x_i$。这个过程通常基于**乘积-差分算法 (Product-Difference Algorithm)**。
3.  **计算源项**: 使用求得的 $\{w_i, x_i\}$ 来计算下一时间步的矩方程源项。

QMOM 的强大之处在于它能够在不预设分布形状的情况下封闭[矩方程](@entry_id:149666)，并且能够通过调整节点数 $N$ 来表示多峰分布（例如，一个[双峰分布](@entry_id:166376)可以用 $N \ge 2$ 的 QMOM 来近似）。

**DQMOM 与可实现性问题**
-   **直接求积矩方法 (DQMOM)**: QMOM 的一个主要计算瓶颈是矩反演步骤，它可能很耗时且数值上不稳定。DQMOM (Direct Quadrature Method of Moments) 通过直接推导并求解关于权重 $w_i$ 和横坐标 $x_i$ 的[输运方程](@entry_id:174281)，完全避免了矩反演步骤，从而提高了计算效率和鲁棒性 。

-   **可实现性 (Realizability)**: 一个关键的理论和实践问题是**可实现性** 。一个矩集被称为“可实现的”，当且仅当它对应于一个物理上可能的（即非负的）[数密度](@entry_id:895657)函数。在数值计算中，由于离散化误差，输运后的矩集可能变得“不可实现”，导致矩反演过程产生无意义的结果，如负的权重 $w_i$ 或负的/复数的体积 $x_i$。负权重意味着存在某个多项式 $p(v)$，其平方对分布的积分 $\int p(v)^2 n(v) dv$ 为负，这在物理上是不可能的。处理这个问题的方法包括：
    1.  **预防策略**: 设计保证[可实现性](@entry_id:193701)的数值格式，如使用**强保稳 (SSP) [时间积分格式](@entry_id:165373)**和保持正定性的空间离散格式。
    2.  **修正策略**: 如果不可实现的矩已经产生，可以通过数学方法将其“投影”回可实现矩集所构成的[凸锥](@entry_id:635652)上（这是一个[凸优化](@entry_id:137441)问题），或者采用更简单的方法，如将小的负权重剪裁为零，并重新归一化以保证低阶矩的守恒。

### 方法比较与选择

在为特定的燃烧问题选择 soot 模型时，需要在精度、计算成本和实现复杂性之间进行权衡。下表总结了各种方法的特点 。

| 特性 | 传统矩方法 (MOM) | [分段法](@entry_id:1131362) (SM) | 求积[矩方法](@entry_id:277025) (QMOM/DQMOM) |
| :--- | :--- | :--- | :--- |
| **[表示能力](@entry_id:636759)** | 差 (仅限单峰) | 优 (可表示任意形状) | 好 (可通过增加节点数表示多峰) |
| **被追踪变量** | $N_m$ 个矩 | $N_s$ 个分段粒子数 | $2N$ 个矩 (QMOM) 或 $2N$ 个权重/横坐标 (DQMOM) |
| **计算成本 (聚并)** | 低 | 高 ($O(N_s^2)$) | 中等 ($O(N^2)$) |
| **数值扩散** | 无 (无体积网格) | 有 (在增长项中) | 无 (无体积网格) |
| **主要挑战** | [封闭假设](@entry_id:1122504)的准确性 | 计算成本高，数值扩散 | 矩反演的鲁棒性，可实现性问题 |

**应用实例：[湍流火焰](@entry_id:1133508)的 LES 模拟**
考虑一个大型的三维[湍流火焰](@entry_id:1133508)的大涡模拟 (LES)，其中有 $10^6$ 个网格单元，并且需要精确预测辐射传热（它对 soot 的质量和表面积都很敏感）。由于持续的成核，soot 呈现出[双峰分布](@entry_id:166376)。计算预算限制每个单元只能增加最多 10 个额外的标量。

-   **[分段法](@entry_id:1131362)** 不可行，因为它需要远超 10 个分段才能解析[双峰分布](@entry_id:166376)。
-   **传统[矩方法](@entry_id:277025)** (如对数正态假设) 也不可行，因为它无法捕捉[双峰分布](@entry_id:166376)，导致对表面积和辐射的预测产生严重偏差。
-   **QMOM** 是最合适的选择。例如，使用 $N=4$ 个节点，需要输运 $2N=8$ 个矩，这在预算之内。$N=4$ 的 QMOM 能够很好地近似[双峰分布](@entry_id:166376)，并且由于它不依赖于形状假设，可以准确计算辐射所需的（分数阶）矩。虽然其单步成本高于传统 MOM，但在可接受的范围内，为[大规模并行计算](@entry_id:268183)提供了精度和效率的最佳平衡 。

总之，从基本的 PBE 概念到先进的数值求解技术，soot 的群体平衡建模提供了一个丰富而强大的工具集。方法的选择取决于对物理现象的理解、对预测精度的要求以及可用的计算资源，而求积矩方法正是在这种多重约束下，为复杂燃烧环境中的 soot 预测提供了一条兼顾准确性与效率的途径。