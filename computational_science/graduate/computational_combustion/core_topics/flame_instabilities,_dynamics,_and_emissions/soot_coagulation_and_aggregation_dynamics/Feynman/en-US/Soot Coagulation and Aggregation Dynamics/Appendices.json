{
    "hands_on_practices": [
        {
            "introduction": "The rate of soot aggregation is fundamentally determined by the coagulation kernel, which quantifies the collision frequency between particles. This first exercise  guides you through the derivation of the classic Brownian coagulation kernel in the continuum regime from first principles of diffusion. By also calculating the kernel's sensitivity to particle size, you will gain insight into how measurement uncertainties propagate in coagulation models, a crucial aspect of practical simulation.",
            "id": "4064690",
            "problem": "In a high-pressure, soot-laden combustion environment where the Knudsen number is small, consider Brownian coagulation between two soot particle populations labeled $i$ and $j$. The particles are characterized by their mobility diameters $d_{m,i}$ and $d_{m,j}$, and their independently measured translational diffusion coefficients in the carrier gas, $D_i$ and $D_j$. Assume the continuum diffusion limit applies and that Brownian coagulation is entirely diffusion-limited, with collisions occurring upon encounter. \n\nStarting from conservation of diffusive flux and steady-state diffusion to absorbing spherical sinks motivated by kinetic theory and Fickian transport, model the pairwise capture process in the relative frame between two spheres of radii consistent with their mobility diameters. Derive the expression for the Brownian coagulation kernel $K_{ij}$ as a function of $D_i$, $D_j$, $d_{m,i}$, and $d_{m,j}$. Then, assuming $D_i$ and $D_j$ are known exactly from independent measurements, and the only uncertain inputs are the mobility diameters with independent small relative uncertainties, define and derive the first-order relative sensitivity of $K_{ij}$ to $d_{m,i}$, \n$$\nS_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}.\n$$\n\nUse the following measured properties, representative of soot aggregates in a gas at elevated pressure:\n- $d_{m,i} = 80\\,\\mathrm{nm}$,\n- $d_{m,j} = 120\\,\\mathrm{nm}$,\n- $D_i = 4.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$,\n- $D_j = 3.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$.\n\nEvaluate both the kernel $K_{ij}$ and the sensitivity coefficient $S_i$ at these values. Report only the numerical value of $S_i$ as your final answer. Round your reported $S_i$ to four significant figures. Express $K_{ij}$, if you compute it, in $\\mathrm{m^3\\,s^{-1}}$. Treat $S_i$ as a dimensionless number.",
            "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Two soot particle populations, labeled $i$ and $j$.\n- Knudsen number is small, continuum diffusion limit applies.\n- Brownian coagulation is diffusion-limited.\n- Mobility diameters: $d_{m,i}$ and $d_{m,j}$.\n- Translational diffusion coefficients: $D_i$ and $D_j$.\n- Collision occurs upon encounter (absorbing spheres).\n- Task 1: Derive the Brownian coagulation kernel $K_{ij}$ as a function of $D_i$, $D_j$, $d_{m,i}$, and $d_{m,j}$.\n- Task 2: Define and derive the first-order relative sensitivity of $K_{ij}$ to $d_{m,i}$: $S_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}$.\n- Measured properties:\n  - $d_{m,i} = 80\\,\\mathrm{nm}$\n  - $d_{m,j} = 120\\,\\mathrm{nm}$\n  - $D_i = 4.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$\n  - $D_j = 3.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$\n- Task 3: Evaluate $S_i$ numerically and round to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a classic problem in aerosol science (Smoluchowski coagulation in the continuum regime) using standard terminology and physical principles. All necessary information is provided, the data are physically consistent (the smaller particle has a higher diffusion coefficient), and the objectives are clearly defined.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Brownian Coagulation Kernel $K_{ij}$**\n\nThe process of Brownian coagulation between two particles is modeled by considering one particle (e.g., of type $j$) to be stationary, while the other (of type $i$) diffuses towards it. The relative motion is governed by the relative diffusion coefficient, which is the sum of the individual diffusion coefficients:\n$$\nD_{ij} = D_i + D_j\n$$\nThe problem is equivalent to the diffusion of a point-like particle with diffusion coefficient $D_{ij}$ towards a stationary absorbing sphere. The radius of this sphere, known as the collision radius $R_{ij}$, is the sum of the radii of the two colliding particles. The particle radii are half of their mobility diameters: $r_i = d_{m,i}/2$ and $r_j = d_{m,j}/2$.\n$$\nR_{ij} = r_i + r_j = \\frac{d_{m,i} + d_{m,j}}{2}\n$$\nThe concentration $n(r)$ of the diffusing particles at a distance $r$ from the center of the stationary absorbing sphere is described by the steady-state diffusion equation in spherical coordinates. Assuming spherical symmetry, this is Laplace's equation for $n(r)$:\n$$\n\\nabla^2 n(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dn}{dr} \\right) = 0\n$$\nThe boundary conditions are set by the physics of the problem:\n1.  The sphere is a perfect sink, so the concentration at its surface is zero: $n(r=R_{ij}) = 0$.\n2.  Far from the sphere, the concentration is the undisturbed bulk concentration of particles of type $i$, which we denote as $n_i$: $n(r \\to \\infty) = n_i$.\n\nIntegrating the differential equation twice yields the general solution:\n$$\nn(r) = -\\frac{C_1}{r} + C_2\n$$\nwhere $C_1$ and $C_2$ are integration constants. Applying the boundary conditions:\n- From $n(\\infty) = n_i$, we find $C_2 = n_i$.\n- From $n(R_{ij}) = 0$, we have $0 = -C_1/R_{ij} + n_i$, which gives $C_1 = n_i R_{ij}$.\nThe concentration profile surrounding the absorbing sphere is thus:\n$$\nn(r) = n_i \\left( 1 - \\frac{R_{ij}}{r} \\right)\n$$\nThe rate of collisions is found by calculating the total diffusive flux of particles onto the surface of the sphere. The diffusive flux vector is given by Fick's first law, $\\mathbf{J} = -D_{ij} \\nabla n$. The magnitude of the flux at the surface $r=R_{ij}$ is:\n$$\nJ = -D_{ij} \\left. \\frac{dn}{dr} \\right|_{r=R_{ij}}\n$$\nThe concentration gradient is $\\frac{dn}{dr} = n_i \\frac{R_{ij}}{r^2}$. At the surface, this is $\\left. \\frac{dn}{dr} \\right|_{r=R_{ij}} = \\frac{n_i}{R_{ij}}$.\nThe flux at the surface is therefore $J = D_{ij} \\frac{n_i}{R_{ij}}$. The total rate of particles colliding with a single stationary particle $j$ is this flux multiplied by the surface area of the absorbing sphere, $A = 4\\pi R_{ij}^2$:\n$$\n\\text{Collision Rate per particle } j = J \\cdot A = \\left(D_{ij} \\frac{n_i}{R_{ij}}\\right) (4\\pi R_{ij}^2) = 4\\pi D_{ij} R_{ij} n_i\n$$\nThe bimolecular coagulation rate equation is defined as $dN_{ij}/dt = K_{ij} n_i n_j$, where $K_{ij}$ is the coagulation kernel and $N_{ij}$ is the number concentration of collision events. The total collision rate per unit volume is the rate per particle $j$ multiplied by the concentration of particles $j$, $n_j$.\n$$\n\\frac{dN_{ij}}{dt} = (4\\pi D_{ij} R_{ij} n_i) n_j\n$$\nBy comparing this to the definition, we identify the coagulation kernel $K_{ij}$:\n$$\nK_{ij} = 4\\pi D_{ij} R_{ij}\n$$\nSubstituting the expressions for $D_{ij}$ and $R_{ij}$ in terms of the given variables:\n$$\nK_{ij} = 4\\pi (D_i + D_j) \\left( \\frac{d_{m,i} + d_{m,j}}{2} \\right)\n$$\n$$\nK_{ij} = 2\\pi (D_i + D_j)(d_{m,i} + d_{m,j})\n$$\nThis is the required expression for the continuum regime Brownian coagulation kernel.\n\n**Derivation of the Sensitivity Coefficient $S_i$**\n\nThe sensitivity coefficient $S_i$ is defined as:\n$$\nS_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}\n$$\nUsing the chain rule for logarithmic derivatives, this can be written as:\n$$\nS_i = \\frac{d_{m,i}}{K_{ij}} \\left( \\frac{\\partial K_{ij}}{\\partial d_{m,i}} \\right)\n$$\nThe partial derivative is evaluated holding $D_i$ and $D_j$ constant, as specified in the problem statement.\nLet's compute the partial derivative of $K_{ij}$ with respect to $d_{m,i}$:\n$$\n\\frac{\\partial K_{ij}}{\\partial d_{m,i}} = \\frac{\\partial}{\\partial d_{m,i}} \\left[ 2\\pi (D_i + D_j)(d_{m,i} + d_{m,j}) \\right]\n$$\nSince $D_i$, $D_j$, and $d_{m,j}$ are treated as constants for this differentiation, the term $2\\pi(D_i+D_j)$ is a constant factor.\n$$\n\\frac{\\partial K_{ij}}{\\partial d_{m,i}} = 2\\pi (D_i + D_j) \\frac{\\partial}{\\partial d_{m,i}}(d_{m,i} + d_{m,j}) = 2\\pi (D_i + D_j) (1) = 2\\pi (D_i + D_j)\n$$\nNow, substitute this result and the expression for $K_{ij}$ back into the formula for $S_i$:\n$$\nS_i = \\frac{d_{m,i}}{2\\pi (D_i + D_j)(d_{m,i} + d_{m,j})} \\left[ 2\\pi (D_i + D_j) \\right]\n$$\nThe term $2\\pi (D_i + D_j)$ cancels from the numerator and denominator, yielding a simplified expression for the sensitivity coefficient:\n$$\nS_i = \\frac{d_{m,i}}{d_{m,i} + d_{m,j}}\n$$\n\n**Numerical Evaluation of $S_i$**\n\nThe problem provides the following numerical values:\n- $d_{m,i} = 80\\,\\mathrm{nm}$\n- $d_{m,j} = 120\\,\\mathrm{nm}$\n\nSubstituting these values into the derived expression for $S_i$:\n$$\nS_i = \\frac{80\\,\\mathrm{nm}}{80\\,\\mathrm{nm} + 120\\,\\mathrm{nm}} = \\frac{80}{200}\n$$\nThe units of nanometers cancel, leaving a dimensionless quantity as expected.\n$$\nS_i = \\frac{8}{20} = \\frac{2}{5} = 0.4\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nS_i = 0.4000\n$$\nThe problem also asks to evaluate $K_{ij}$. This is an intermediate step.\n$K_{ij} = 2\\pi (4.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}} + 3.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}})(80 \\times 10^{-9}\\,\\mathrm{m} + 120 \\times 10^{-9}\\,\\mathrm{m})$\n$K_{ij} = 2\\pi (7.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}})(200 \\times 10^{-9}\\,\\mathrm{m})$\n$K_{ij} = 2\\pi (1400 \\times 10^{-18}\\,\\mathrm{m^3\\,s^{-1}}) = 2800\\pi \\times 10^{-18}\\,\\mathrm{m^3\\,s^{-1}} \\approx 8.796 \\times 10^{-15}\\,\\mathrm{m^3\\,s^{-1}}$.\nThe final answer is only the value of $S_i$.",
            "answer": "$$\n\\boxed{0.4000}\n$$"
        },
        {
            "introduction": "While the continuum model provides a solid foundation, real combustion environments often involve particles small enough that the surrounding gas can no longer be treated as a continuous fluid. This practice  delves into the transition regime, where gas slip effects become significant and must be accounted for using corrections like the Cunningham factor. By comparing the continuum kernel to the more accurate transition-regime kernel, you will directly quantify the error introduced by neglecting these crucial physical effects.",
            "id": "4064717",
            "problem": "Consider two identical soot aggregates formed in a laminar ethylene-air flame. Each aggregate is approximated by a mobility-equivalent sphere of diameter $d_{m} = 160\\,\\text{nm}$ and radius $r = d_{m}/2$. The gas temperature is $T = 1700\\,\\text{K}$, the gas dynamic viscosity is $\\mu = 7.0 \\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$, and the mean free path of the gas is $\\lambda_{g} = 80\\,\\text{nm}$. The Knudsen number is defined as $Kn_{d} = \\lambda_{g} / d_{m}$, consistent with the main text. Assume the soot aggregates are compact enough that the mobility-equivalent diameter is appropriate for Stokes-Einstein diffusion.\n\nStarting from the fluctuation-dissipation relation and kinetic theory, define the continuum Brownian coagulation kernel for two identical spheres and the transition-regime kernel using Fuchs-Sutugin (FS) flux-matching interpolation. In the continuum regime, use the Stokes-Einstein diffusivity. In the transition regime, incorporate the slip correction to the particle diffusivity via the Cunningham correction factor $C_{c}(Kn_{d})$, where\n$$\nC_{c}(Kn_{d}) = 1 + Kn_{d} \\left( A + B \\exp\\!\\left( -\\frac{C}{Kn_{d}} \\right) \\right),\n$$\nwith $A = 1.257$, $B = 0.4$, and $C = 1.1$. Let the Boltzmann constant be $k_{B}$.\n\nDefine the pure continuum kernel as $K_{c}$ and the FS-interpolated transition-regime kernel as $K_{t}$. Compute the fractional error $E$ introduced by using the pure continuum kernel instead of the transition-regime kernel,\n$$\nE = \\frac{|K_{t} - K_{c}|}{K_{t}},\n$$\nas a single real number. Express your final answer as a dimensionless decimal and round your answer to four significant figures. No units should be included in the final numerical answer.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- Two identical soot aggregates, approximated as mobility-equivalent spheres.\n- Sphere diameter: $d_{m} = 160\\,\\text{nm}$.\n- Sphere radius: $r = d_{m}/2 = 80\\,\\text{nm}$.\n- Gas temperature: $T = 1700\\,\\text{K}$.\n- Gas dynamic viscosity: $\\mu = 7.0 \\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$.\n- Mean free path of the gas: $\\lambda_{g} = 80\\,\\text{nm}$.\n- Knudsen number definition: $Kn_{d} = \\lambda_{g} / d_{m}$.\n- Cunningham correction factor: $C_{c}(Kn_{d}) = 1 + Kn_{d} \\left( A + B \\exp\\left( -\\frac{C}{Kn_{d}} \\right) \\right)$.\n- Constants for $C_c$: $A = 1.257$, $B = 0.4$, $C = 1.1$.\n- Boltzmann constant: $k_{B}$.\n- Task 1: Define the continuum Brownian coagulation kernel, $K_c$.\n- Task 2: Define the transition-regime kernel, $K_t$.\n- Task 3: Compute the fractional error $E = \\frac{|K_{t} - K_{c}|}{K_{t}}$.\n- Task 4: Round the final answer to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is based on standard principles of aerosol physics. The physical parameters are realistic for a high-temperature combustion environment. The Knudsen number is calculated as $Kn_d = \\lambda_g / d_m = (80\\,\\text{nm}) / (160\\,\\text{nm}) = 0.5$. This value is in the transition regime, consistent with the problem's context. All necessary data, constants, and equations are provided for a unique solution.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe solution begins with the fluctuation-dissipation theorem, which connects the particle diffusivity, $D$, to the thermal energy, $k_B T$, and the friction factor, $f$, via the Stokes-Einstein equation:\n$$D = \\frac{k_B T}{f}$$\n\n**1. Continuum Brownian Coagulation Kernel ($K_c$)**\n\nIn the continuum regime ($Kn_d \\ll 1$), the friction factor for a spherical particle of radius $r$ is given by Stokes' law:\n$$f_c = 6 \\pi \\mu r$$\nThe corresponding continuum diffusivity, $D_c$, is:\n$$D_c = \\frac{k_B T}{f_c} = \\frac{k_B T}{6 \\pi \\mu r}$$\nThe Brownian coagulation kernel for two identical particles is given by $K = 16 \\pi r D$. For the continuum case:\n$$K_c = 16 \\pi r D_c = 16 \\pi r \\left( \\frac{k_B T}{6 \\pi \\mu r} \\right) = \\frac{8 k_B T}{3 \\mu}$$\nThis is the classic expression for the continuum Brownian coagulation kernel for identical spheres.\n\n**2. Transition-Regime Coagulation Kernel ($K_t$)**\n\nIn the transition regime ($Kn_d \\sim 1$), the particle mobility is higher than predicted by Stokes' law due to gas slip at the particle surface. This effect is quantified by the Cunningham slip correction factor, $C_c(Kn_d)$. The friction factor is corrected as:\n$$f_t = \\frac{f_c}{C_c(Kn_d)} = \\frac{6 \\pi \\mu r}{C_c(Kn_d)}$$\nConsequently, the particle diffusivity in the transition regime, $D_t$, is increased:\n$$D_t = \\frac{k_B T}{f_t} = \\frac{k_B T C_c(Kn_d)}{6 \\pi \\mu r} = D_c \\cdot C_c(Kn_d)$$\nThe transition-regime kernel, $K_t$, is found by using this slip-corrected diffusivity in the kernel formula:\n$$K_t = 16 \\pi r D_t = 16 \\pi r (D_c \\cdot C_c(Kn_d)) = \\left( \\frac{8 k_B T}{3 \\mu} \\right) C_c(Kn_d)$$\nTherefore, the transition-regime kernel is related to the continuum kernel by:\n$$K_t = K_c \\cdot C_c(Kn_d)$$\n\n**3. Calculation of Fractional Error ($E$)**\n\nThe fractional error $E$ is defined as:\n$$E = \\frac{|K_t - K_c|}{K_t}$$\nSubstituting $K_t = K_c \\cdot C_c(Kn_d)$:\n$$E = \\frac{|K_c \\cdot C_c(Kn_d) - K_c|}{K_c \\cdot C_c(Kn_d)} = \\frac{K_c |C_c(Kn_d) - 1|}{K_c C_c(Kn_d)}$$\nSince $C_c(Kn_d) \\ge 1$ for any non-negative Knudsen number, the absolute value can be removed:\n$$E = \\frac{C_c(Kn_d) - 1}{C_c(Kn_d)} = 1 - \\frac{1}{C_c(Kn_d)}$$\nThis shows the fractional error depends only on the Cunningham correction factor.\n\nFirst, we calculate the Knudsen number using the provided data and definition:\n$$Kn_d = \\frac{\\lambda_g}{d_m} = \\frac{80\\,\\text{nm}}{160\\,\\text{nm}} = 0.5$$\nNext, we calculate the Cunningham correction factor $C_c$ for $Kn_d = 0.5$ using the given formula and constants $A = 1.257$, $B = 0.4$, and $C = 1.1$:\n$$C_c(0.5) = 1 + 0.5 \\cdot \\left( A + B \\exp\\left(-\\frac{C}{0.5}\\right) \\right)$$\n$$C_c(0.5) = 1 + 0.5 \\cdot \\left( 1.257 + 0.4 \\exp(-2.2) \\right)$$\nUsing the value $\\exp(-2.2) \\approx 0.110803$:\n$$C_c(0.5) \\approx 1 + 0.5 \\cdot (1.257 + 0.4 \\times 0.110803)$$\n$$C_c(0.5) \\approx 1 + 0.5 \\cdot (1.257 + 0.0443212)$$\n$$C_c(0.5) \\approx 1 + 0.5 \\cdot (1.3013212)$$\n$$C_c(0.5) \\approx 1 + 0.6506606 = 1.6506606$$\nNow, we can compute the fractional error $E$:\n$$E = 1 - \\frac{1}{C_c(0.5)} \\approx 1 - \\frac{1}{1.6506606}$$\n$$E \\approx 1 - 0.605818$$\n$$E \\approx 0.394182$$\nRounding the result to four significant figures as requested:\n$$E \\approx 0.3942$$\nThis result indicates that using the pure continuum kernel under these transition-regime conditions would lead to an underestimation of the coagulation rate by approximately $39.42 \\%$.",
            "answer": "$$\\boxed{0.3942}$$"
        },
        {
            "introduction": "Understanding the collision kernel is the first step; the next is to predict the evolution of the entire particle population over time using the Smoluchowski Population Balance Equation (PBE). This final exercise  is a computational practice where you will solve for the time evolution of the total particle number density for specific, analytically tractable kernels. This task directly connects the microscopic physics of collision to the macroscopic, observable changes in the aerosol system, forming the basis of predictive coagulation modeling.",
            "id": "4064732",
            "problem": "Consider the Smoluchowski population balance for soot particle coagulation in a spatially uniform system. Let the number-based mass distribution be $n(m,t)$, where $m$ is the particle mass in $\\mathrm{kg}$ and $t$ is time in $\\mathrm{s}$. The total number density is $N(t) = \\int_{0}^{\\infty} n(m,t) \\, dm$ with units $\\mathrm{m}^{-3}$. The initial distribution is specified as $n(m,0) = N_0 \\, p(m)$, where $N_0$ is the initial total number density and $p(m)$ is a lognormal probability density in mass,\n$$\np(m) = \\frac{1}{m \\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(\\ln m - \\mu)^2}{2\\sigma^2}\\right),\n$$\nwith parameters $\\mu$ (dimensionless) and $\\sigma$ (dimensionless). The lognormal mean mass is $\\mathbb{E}[m] = \\exp(\\mu + \\tfrac{1}{2}\\sigma^2)$, and the initial mass density (the first moment) is $M_1(0) = \\int_0^\\infty m \\, n(m,0) \\, dm = N_0 \\, \\mathbb{E}[m]$, in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n\nThe coagulation dynamics follow the Smoluchowski population balance equation,\n$$\n\\frac{\\partial n(m,t)}{\\partial t} = \\frac{1}{2}\\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' - n(m,t) \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm',\n$$\nwhere $K(m,m')$ is the symmetric coagulation kernel with units $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$. The total number density evolves according to integrating the above equation over $m$.\n\nYour task is to compute $N(t)$ for the following test suite using kernels chosen to be idealized but dimensionally consistent with soot coagulation, and to aggregate the output as specified. You must use the specified units and produce outputs as floats in scientific notation. The program must implement the correct physics-based reasoning for $N(t)$ using the lognormal initial distribution and the chosen kernels:\n\n- Test Case 1 (general constant-kernel case, realistic magnitude and long time): Kernel $K(m,m') = K_0$ (constant) with $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $N_0 = 1.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$, $\\mu = -44.0$, $\\sigma = 0.4$, final time $t = 10000\\ \\mathrm{s}$.\n- Test Case 2 (additive-mass kernel with moderate decay over realistic time): Kernel $K(m,m') = \\alpha (m + m')$ with $\\alpha = 100.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$, $N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$, $\\mu = -40.9334$, $\\sigma = 0.6$, final time $t = 1000\\ \\mathrm{s}$.\n- Test Case 3 (boundary condition: very short time under constant kernel): Kernel $K(m,m') = K_0$ with $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$, $\\mu = -43.0$, $\\sigma = 0.5$, final time $t = 1\\ \\mathrm{s}$.\n- Test Case 4 (edge case: zero additive kernel, no decay): Kernel $K(m,m') = \\alpha (m + m')$ with $\\alpha = 0.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$, $N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$, $\\mu = -42.0$, $\\sigma = 0.7$, final time $t = 3600\\ \\mathrm{s}$.\n\nScientific realism requirements:\n- For pure coagulation without sources or sinks other than aggregation, total mass density $M_1(t)$ is conserved in time, i.e., $M_1(t) = M_1(0)$.\n- Units must be consistent: $N(t)$ in $\\mathrm{m}^{-3}$, $t$ in $\\mathrm{s}$, $m$ in $\\mathrm{kg}$, $K_0$ in $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $\\alpha$ in $\\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$.\n\nYour program must compute $N(t)$ at the specified final times, for each test case, using only the information provided and fundamental derivations starting from the Smoluchowski population balance equation. Express the final number densities in $\\mathrm{m}^{-3}$ as scientific-notation decimal floats with six digits after the decimal point.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases. For example, \"[value1,value2,value3,value4]\".\n\nThe expected outputs are floats. Design the algorithm to be robust with respect to the boundary and edge cases by correctly handling the conservation of mass and zero-kernel behavior without numerical instability.",
            "solution": "The problem requires the computation of the total particle number density, $N(t)$, at a specified final time $t$ for different coagulation kernels and initial conditions. The evolution of the number-based mass distribution, $n(m,t)$, is governed by the Smoluchowski population balance equation. We can find an ordinary differential equation (ODE) for $N(t)$ by integrating the Smoluchowski equation over all particle masses $m$.\n\nThe total number density is defined as $N(t) = \\int_{0}^{\\infty} n(m,t) \\, dm$. Its time derivative is:\n$$\n\\frac{dN(t)}{dt} = \\int_{0}^{\\infty} \\frac{\\partial n(m,t)}{\\partial t} \\, dm\n$$\nSubstituting the Smoluchowski equation for $\\frac{\\partial n(m,t)}{\\partial t}$:\n$$\n\\frac{dN(t)}{dt} = \\int_{0}^{\\infty} \\left[ \\frac{1}{2}\\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' - n(m,t) \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm' \\right] dm\n$$\nThe first term represents the rate of formation of particles of any mass, and the second term represents the rate of loss. Let's analyze these two terms. The loss term integral is:\n$$\nL = - \\int_0^\\infty n(m,t) \\left( \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm' \\right) dm = - \\int_0^\\infty \\int_0^\\infty K(m, m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\nThe formation term integral is:\n$$\nP = \\frac{1}{2} \\int_0^\\infty \\left( \\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' \\right) dm\n$$\nBy changing variables to $u=m'$ and $v=m-m'$, the region of integration $0 \\le m' \\le m < \\infty$ becomes $u \\ge 0, v \\ge 0$. The Jacobian of this transformation is $1$. The term becomes:\n$$\nP = \\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K(u,v) \\, n(u,t) \\, n(v,t) \\, du \\, dv\n$$\nCombining the formation and loss terms, and noting that the integration variables are dummy variables, we get:\n$$\n\\frac{dN(t)}{dt} = \\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K(u,v) n(u,t) n(v,t) \\, du \\, dv - \\int_0^\\infty \\int_0^\\infty K(u,v) n(u,t) n(v,t) \\, du \\, dv\n$$\n$$\n\\frac{dN(t)}{dt} = -\\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K(m,m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\nThis general equation for the rate of change of the total number density depends on the specific form of the coagulation kernel $K(m,m')$. We analyze the two kernels provided in the test cases.\n\n**Case A: Constant Kernel, $K(m,m') = K_0$**\nFor a constant kernel, the general equation simplifies significantly.\n$$\n\\frac{dN(t)}{dt} = -\\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K_0 \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n$$\n\\frac{dN(t)}{dt} = -\\frac{K_0}{2} \\left[ \\int_0^\\infty n(m,t) \\, dm \\right] \\left[ \\int_0^\\infty n(m',t) \\, dm' \\right] = -\\frac{K_0}{2} N(t)^2\n$$\nThis is a separable ODE: $\\frac{dN}{N^2} = -\\frac{K_0}{2} dt$. Integrating from $t=0$ to $t$ with the initial condition $N(0)=N_0$:\n$$\n\\int_{N_0}^{N(t)} \\frac{dN}{N^2} = \\int_0^t -\\frac{K_0}{2} dt \\implies \\left[-\\frac{1}{N}\\right]_{N_0}^{N(t)} = -\\frac{K_0}{2} t\n$$\n$$\n-\\frac{1}{N(t)} + \\frac{1}{N_0} = -\\frac{K_0 t}{2} \\implies \\frac{1}{N(t)} = \\frac{1}{N_0} + \\frac{K_0 t}{2}\n$$\nThe solution for the total number density is:\n$$\nN(t) = \\frac{1}{\\frac{1}{N_0} + \\frac{K_0 t}{2}} = \\frac{N_0}{1 + \\frac{N_0 K_0 t}{2}}\n$$\nThis solution depends only on $N_0$, $K_0$, and $t$. The details of the initial mass distribution, such as $\\mu$ and $\\sigma$, are not required for this kernel.\n\n**Case B: Additive Kernel, $K(m,m') = \\alpha (m + m')$**\nFor the additive kernel, the general equation becomes:\n$$\n\\frac{dN(t)}{dt} = -\\frac{1}{2} \\int_0^\\infty \\int_0^\\infty \\alpha (m+m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n$$\n\\frac{dN(t)}{dt} = -\\frac{\\alpha}{2} \\left[ \\int_0^\\infty m \\, n(m,t) dm \\int_0^\\infty n(m',t) dm' + \\int_0^\\infty n(m,t) dm \\int_0^\\infty m' \\, n(m',t) dm' \\right]\n$$\nThe integrals represent the first moment (total mass density) $M_1(t) = \\int_0^\\infty m \\, n(m,t) \\, dm$ and the zeroth moment (total number density) $N(t)$.\n$$\n\\frac{dN(t)}{dt} = -\\frac{\\alpha}{2} \\left[ M_1(t) N(t) + N(t) M_1(t) \\right] = -\\alpha M_1(t) N(t)\n$$\nAs stated in the problem (and verifiable from the PBE), total mass is conserved in a pure coagulation process, so $M_1(t) = M_1(0)$. The initial mass density is given by $M_1(0) = N_0 \\, \\mathbb{E}[m]$, where the mean mass $\\mathbb{E}[m]$ of the initial lognormal distribution is $\\mathbb{E}[m] = \\exp(\\mu + \\sigma^2/2)$.\nThe ODE becomes:\n$$\n\\frac{dN(t)}{dt} = -\\alpha M_1(0) N(t)\n$$\nThis is a separable linear ODE: $\\frac{dN}{N} = -\\alpha M_1(0) dt$. Integrating from $t=0$ to $t$:\n$$\n\\int_{N_0}^{N(t)} \\frac{dN}{N} = \\int_0^t -\\alpha M_1(0) dt \\implies \\ln\\left(\\frac{N(t)}{N_0}\\right) = -\\alpha M_1(0) t\n$$\nThe solution is:\n$$\nN(t) = N_0 \\exp(-\\alpha M_1(0) t) = N_0 \\exp(-\\alpha N_0 \\exp(\\mu + \\sigma^2/2) t)\n$$\n\nWe now apply these derived formulae to the specific test cases.\n\n**Test Case 1:** Constant kernel with $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $N_0 = 1.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$, and $t = 10000\\ \\mathrm{s}$.\n$$\nN(10000) = \\frac{1.0 \\times 10^{12}}{1 + \\frac{(1.0 \\times 10^{12})(2.0 \\times 10^{-16})(10000)}{2}} = \\frac{1.0 \\times 10^{12}}{1 + \\frac{2.0 \\times 10^{0}}{2}} = \\frac{1.0 \\times 10^{12}}{1+1} = 5.0 \\times 10^{11}\\ \\mathrm{m}^{-3}\n$$\n\n**Test Case 2:** Additive kernel with $\\alpha = 100.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$, $N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$, $\\mu = -40.9334$, $\\sigma = 0.6$, and $t = 1000\\ \\mathrm{s}$.\nFirst, we compute the initial mass density $M_1(0)$:\n$$\nM_1(0) = N_0 \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right) = (5.0 \\times 10^{12}) \\exp\\left(-40.9334 + \\frac{0.6^2}{2}\\right)\n$$\n$$\nM_1(0) = (5.0 \\times 10^{12}) \\exp(-40.9334 + 0.18) = (5.0 \\times 10^{12}) \\exp(-40.7534) \\approx 5.000001 \\times 10^{-6}\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\nNow we compute $N(t)$:\n$$\nN(1000) = N_0 \\exp(-\\alpha M_1(0) t) = (5.0 \\times 10^{12}) \\exp(-(100.0)(5.000001 \\times 10^{-6})(1000))\n$$\n$$\nN(1000) = (5.0 \\times 10^{12}) \\exp(-0.5000001) \\approx 3.032653 \\times 10^{12}\\ \\mathrm{m}^{-3}\n$$\n\n**Test Case 3:** Constant kernel with $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$, and $t = 1\\ \\mathrm{s}$.\n$$\nN(1) = \\frac{5.0 \\times 10^{12}}{1 + \\frac{(5.0 \\times 10^{12})(2.0 \\times 10^{-16})(1)}{2}} = \\frac{5.0 \\times 10^{12}}{1 + 5.0 \\times 10^{-4}} = \\frac{5.0 \\times 10^{12}}{1.0005} \\approx 4.997501 \\times 10^{12}\\ \\mathrm{m}^{-3}\n$$\n\n**Test Case 4:** Additive kernel with $\\alpha = 0.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$, $N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$, and $t = 3600\\ \\mathrm{s}$.\nSince $\\alpha=0$, the kernel $K(m,m')$ is identically zero. This implies no coagulation occurs.\n$$\nN(t) = N_0 \\exp(-\\alpha M_1(0) t) = N_0 \\exp(0) = N_0\n$$\nTherefore, $N(3600) = N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$. The number density remains constant.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the total particle number density N(t) for soot coagulation\n    based on the Smoluchowski population balance equation for different\n    kernels and initial conditions.\n    \"\"\"\n    \n    # Test cases are provided as a list of dictionaries.\n    # 'kernel_type' is either 'constant' or 'additive'.\n    test_cases = [\n        # Test Case 1: constant-kernel\n        {'kernel_type': 'constant', 'K0': 2.0e-16, 'N0': 1.0e12, 't': 10000.0, 'mu': -44.0, 'sigma': 0.4},\n        # Test Case 2: additive-mass kernel\n        {'kernel_type': 'additive', 'alpha': 100.0, 'N0': 5.0e12, 't': 1000.0, 'mu': -40.9334, 'sigma': 0.6},\n        # Test Case 3: constant-kernel, short time\n        {'kernel_type': 'constant', 'K0': 2.0e-16, 'N0': 5.0e12, 't': 1.0, 'mu': -43.0, 'sigma': 0.5},\n        # Test Case 4: additive-mass kernel, zero alpha\n        {'kernel_type': 'additive', 'alpha': 0.0, 'N0': 1.0e13, 't': 3600.0, 'mu': -42.0, 'sigma': 0.7},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N0 = case['N0']\n        t = case['t']\n        \n        if case['kernel_type'] == 'constant':\n            # For a constant kernel K(m,m') = K0, the solution is:\n            # N(t) = N0 / (1 + (N0 * K0 * t) / 2)\n            K0 = case['K0']\n            \n            denominator = 1.0 + (N0 * K0 * t) / 2.0\n            N_t = N0 / denominator\n            \n        elif case['kernel_type'] == 'additive':\n            # For an additive kernel K(m,m') = alpha*(m+m'), the solution is:\n            # N(t) = N0 * exp(-alpha * M1_0 * t)\n            # where M1_0 is the initial mass density.\n            # M1_0 = N0 * E[m] = N0 * exp(mu + sigma^2 / 2)\n            alpha = case['alpha']\n            mu = case['mu']\n            sigma = case['sigma']\n            \n            # Handle the edge case where alpha is zero, which means no coagulation.\n            if alpha == 0.0:\n                N_t = N0\n            else:\n                # Calculate initial mass density M1(0)\n                mean_mass = np.exp(mu + (sigma**2) / 2.0)\n                M1_0 = N0 * mean_mass\n                \n                # Calculate N(t)\n                exponent = -alpha * M1_0 * t\n                N_t = N0 * np.exp(exponent)\n        \n        else:\n            # This case should not be reached with the given problem statement.\n            raise ValueError(f\"Unknown kernel type: {case['kernel_type']}\")\n\n        # Format the result to scientific notation with 6 decimal places.\n        results.append(f\"{N_t:.6e}\")\n\n    # The final output must be a single line: a comma-separated list in brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}