{
    "hands_on_practices": [
        {
            "introduction": "动手实践的第一步是掌握描述颗粒碰撞的基本物理原理。在许多燃烧环境中，纳米级烟尘颗粒的运动由布朗运动主导，它们的碰撞聚集是粒径分布演化的核心机制。这项练习将指导你推导连续介质区域内经典的布朗凝聚核，并量化其对输入参数不确定性的敏感性，这是评估模型预测可靠性的关键一步。",
            "id": "4064690",
            "problem": "在一个努森数很小的高压、富含烟炱的燃烧环境中，考虑标记为 $i$ 和 $j$ 的两个烟炱颗粒群之间的布朗凝聚。这些颗粒的特征在于它们的迁移率直径 $d_{m,i}$ 和 $d_{m,j}$，以及它们在载气中独立测量的平动扩散系数 $D_i$ 和 $D_j$。假设适用连续区扩散极限，且布朗凝聚完全受扩散限制，碰撞在相遇时发生。\n\n从扩散通量守恒和由动力学理论及菲克传输（Fickian transport）所启发的向吸收性球形汇的稳态扩散出发，在两个半径与其迁移率直径一致的球体之间的相对坐标系中，对成对捕获过程进行建模。推导布朗凝聚核 $K_{ij}$ 作为 $D_i$、$D_j$、$d_{m,i}$ 和 $d_{m,j}$ 的函数的表达式。然后，假设 $D_i$ 和 $D_j$ 通过独立测量精确已知，唯一不确定的输入是具有独立小相对不确定性的迁移率直径，定义并推导 $K_{ij}$ 对 $d_{m,i}$ 的一阶相对灵敏度，\n$$\nS_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}.\n$$\n\n使用以下测量属性，这些属性代表了高压气体中烟炱聚集体的典型值：\n- $d_{m,i} = 80\\,\\mathrm{nm}$，\n- $d_{m,j} = 120\\,\\mathrm{nm}$，\n- $D_i = 4.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$，\n- $D_j = 3.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$。\n\n在这些值下，评估凝聚核 $K_{ij}$ 和灵敏度系数 $S_i$。仅报告 $S_i$ 的数值作为最终答案。将报告的 $S_i$ 四舍五入到四位有效数字。如果计算 $K_{ij}$，请以 $\\mathrm{m^3\\,s^{-1}}$ 为单位表示。将 $S_i$ 视为无量纲数。",
            "solution": "**布朗凝聚核 $K_{ij}$ 的推导**\n\n两个颗粒之间的布朗凝聚过程通过将一个颗粒（例如，类型 $j$）视为静止，而另一个颗粒（类型 $i$）向其扩散来建模。相对运动由相对扩散系数决定，该系数是各个扩散系数之和：\n$$\nD_{ij} = D_i + D_j\n$$\n该问题等效于一个扩散系数为 $D_{ij}$ 的点状颗粒向一个静止的吸收性球体扩散。这个球体的半径，称为碰撞半径 $R_{ij}$，是两个碰撞颗粒的半径之和。颗粒半径是其迁移率直径的一半：$r_i = d_{m,i}/2$ 和 $r_j = d_{m,j}/2$。\n$$\nR_{ij} = r_i + r_j = \\frac{d_{m,i} + d_{m,j}}{2}\n$$\n在距静止吸收球体中心距离为 $r$ 处，扩散颗粒的浓度 $n(r)$ 由球坐标系中的稳态扩散方程描述。假设球面对称，这就是 $n(r)$ 的拉普拉斯方程：\n$$\n\\nabla^2 n(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dn}{dr} \\right) = 0\n$$\n边界条件由问题的物理性质设定：\n1.  球体是一个完美的汇，因此其表面的浓度为零：$n(r=R_{ij}) = 0$。\n2.  远离球体处，浓度是未受扰动的类型 $i$ 颗粒的体相浓度，我们记为 $n_i$：$n(r \\to \\infty) = n_i$。\n\n对微分方程积分两次，得到通解：\n$$\nn(r) = -\\frac{C_1}{r} + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是积分常数。应用边界条件：\n- 从 $n(\\infty) = n_i$，我们得到 $C_2 = n_i$。\n- 从 $n(R_{ij}) = 0$，我们有 $0 = -C_1/R_{ij} + n_i$，这给出 $C_1 = n_i R_{ij}$。\n因此，吸收球体周围的浓度分布为：\n$$\nn(r) = n_i \\left( 1 - \\frac{R_{ij}}{r} \\right)\n$$\n碰撞速率通过计算颗粒到球体表面的总扩散通量来求得。扩散通量矢量由菲克第一定律给出，$\\mathbf{J} = -D_{ij} \\nabla n$。在表面 $r=R_{ij}$ 处的通量大小为：\n$$\nJ = -D_{ij} \\left. \\frac{dn}{dr} \\right|_{r=R_{ij}}\n$$\n浓度梯度为 $\\frac{dn}{dr} = n_i \\frac{R_{ij}}{r^2}$。在表面处，梯度为 $\\left. \\frac{dn}{dr} \\right|_{r=R_{ij}} = \\frac{n_i}{R_{ij}}$。\n因此，表面的通量为 $J = D_{ij} \\frac{n_i}{R_{ij}}$。与单个静止颗粒 $j$ 碰撞的颗粒总速率是该通量乘以吸收球体的表面积 $A = 4\\pi R_{ij}^2$：\n$$\n\\text{每个颗粒 } j \\text{ 的碰撞速率} = J \\cdot A = \\left(D_{ij} \\frac{n_i}{R_{ij}}\\right) (4\\pi R_{ij}^2) = 4\\pi D_{ij} R_{ij} n_i\n$$\n双分子凝聚速率方程定义为 $dN_{ij}/dt = K_{ij} n_i n_j$，其中 $K_{ij}$ 是凝聚核，$N_{ij}$ 是碰撞事件的数浓度。每单位体积的总碰撞速率是每个颗粒 $j$ 的碰撞速率乘以颗粒 $j$ 的浓度 $n_j$。\n$$\n\\frac{dN_{ij}}{dt} = (4\\pi D_{ij} R_{ij} n_i) n_j\n$$\n通过与定义进行比较，我们确定凝聚核 $K_{ij}$：\n$$\nK_{ij} = 4\\pi D_{ij} R_{ij}\n$$\n将 $D_{ij}$ 和 $R_{ij}$ 的表达式代入给定变量：\n$$\nK_{ij} = 4\\pi (D_i + D_j) \\left( \\frac{d_{m,i} + d_{m,j}}{2} \\right)\n$$\n$$\nK_{ij} = 2\\pi (D_i + D_j)(d_{m,i} + d_{m,j})\n$$\n这就是所要求的连续区布朗凝聚核的表达式。\n\n**灵敏度系数 $S_i$ 的推导**\n\n灵敏度系数 $S_i$ 定义为：\n$$\nS_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}\n$$\n使用对数导数的链式法则，可以写成：\n$$\nS_i = \\frac{d_{m,i}}{K_{ij}} \\left( \\frac{\\partial K_{ij}}{\\partial d_{m,i}} \\right)\n$$\n偏导数的计算是根据问题陈述的要求，将 $D_i$ 和 $D_j$ 保持为常数。\n让我们计算 $K_{ij}$ 对 $d_{m,i}$ 的偏导数：\n$$\n\\frac{\\partial K_{ij}}{\\partial d_{m,i}} = \\frac{\\partial}{\\partial d_{m,i}} \\left[ 2\\pi (D_i + D_j)(d_{m,i} + d_{m,j}) \\right]\n$$\n由于在此微分中 $D_i$、$D_j$ 和 $d_{m,j}$ 被视为常数，因此项 $2\\pi(D_i+D_j)$ 是一个常数因子。\n$$\n\\frac{\\partial K_{ij}}{\\partial d_{m,i}} = 2\\pi (D_i + D_j) \\frac{\\partial}{\\partial d_{m,i}}(d_{m,i} + d_{m,j}) = 2\\pi (D_i + D_j) (1) = 2\\pi (D_i + D_j)\n$$\n现在，将此结果和 $K_{ij}$ 的表达式代回 $S_i$ 的公式中：\n$$\nS_i = \\frac{d_{m,i}}{2\\pi (D_i + D_j)(d_{m,i} + d_{m,j})} \\left[ 2\\pi (D_i + D_j) \\right]\n$$\n项 $2\\pi (D_i + D_j)$ 在分子和分母中被约去，得到灵敏度系数的简化表达式：\n$$\nS_i = \\frac{d_{m,i}}{d_{m,i} + d_{m,j}}\n$$\n\n**$S_i$ 的数值计算**\n\n问题提供了以下数值：\n- $d_{m,i} = 80\\,\\mathrm{nm}$\n- $d_{m,j} = 120\\,\\mathrm{nm}$\n\n将这些值代入推导出的 $S_i$ 表达式中：\n$$\nS_i = \\frac{80\\,\\mathrm{nm}}{80\\,\\mathrm{nm} + 120\\,\\mathrm{nm}} = \\frac{80}{200}\n$$\n纳米单位被约去，如预期一样留下一个无量纲的量。\n$$\nS_i = \\frac{8}{20} = \\frac{2}{5} = 0.4\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nS_i = 0.4000\n$$",
            "answer": "$$\n\\boxed{0.4000}\n$$"
        },
        {
            "introduction": "在确定了单个碰撞事件的速率之后，下一步是理解这些微观事件如何共同影响整个颗粒群体的宏观演化。这项练习通过求解特定（且可解析）凝聚核下的总颗粒数浓度 $N(t)$ 的演化，搭建了从理论性的 Smoluchowski 方程到实际计算的桥梁。掌握这些解析解不仅能加深对凝聚动力学的理解，也为验证更复杂的数值模拟结果提供了基准。",
            "id": "4064732",
            "problem": "考虑一个空间均匀系统中的烟尘颗粒凝聚的斯摩棱霍夫斯基布居平衡。令基于数量的质量分布为 $n(m,t)$，其中 $m$ 是以 $\\mathrm{kg}$ 为单位的颗粒质量，$t$ 是以 $\\mathrm{s}$ 为单位的时间。总数密度为 $N(t) = \\int_{0}^{\\infty} n(m,t) \\, dm$，单位为 $\\mathrm{m}^{-3}$。初始分布指定为 $n(m,0) = N_0 \\, p(m)$，其中 $N_0$ 是初始总数密度，$p(m)$ 是质量的对数正态概率密度，\n$$\np(m) = \\frac{1}{m \\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(\\ln m - \\mu)^2}{2\\sigma^2}\\right),\n$$\n其参数为 $\\mu$（无量纲）和 $\\sigma$（无量纲）。对数正态平均质量为 $\\mathbb{E}[m] = \\exp(\\mu + \\tfrac{1}{2}\\sigma^2)$，初始质量密度（一阶矩）为 $M_1(0) = \\int_0^\\infty m \\, n(m,0) \\, dm = N_0 \\, \\mathbb{E}[m]$，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n\n凝聚动力学遵循斯摩棱霍夫斯基布居平衡方程，\n$$\n\\frac{\\partial n(m,t)}{\\partial t} = \\frac{1}{2}\\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' - n(m,t) \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm',\n$$\n其中 $K(m,m')$ 是对称凝聚核函数，单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$。总数密度通过对上述方程关于 $m$ 积分来演化。\n\n你的任务是，对于以下测试套件，使用理想化但与烟尘凝聚量纲一致的核函数来计算 $N(t)$，并按规定汇总输出。你必须使用指定的单位，并以科学记数法表示的浮点数形式生成输出。程序必须基于对数正态初始分布和所选核函数，实现对 $N(t)$ 的正确物理推理：\n\n- 测试用例1（通用常数核函数情况，实际量级和长时间）：核函数 $K(m,m') = K_0$（常数），其中 $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 1.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -44.0$，$\\sigma = 0.4$，最终时间 $t = 10000\\ \\mathrm{s}$。\n- 测试用例2（加性质量核函数，在实际时间内中等程度衰减）：核函数 $K(m,m') = \\alpha (m + m')$，其中 $\\alpha = 100.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -40.9334$，$\\sigma = 0.6$，最终时间 $t = 1000\\ \\mathrm{s}$。\n- 测试用例3（边界条件：常数核函数下的极短时间）：核函数 $K(m,m') = K_0$，其中 $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -43.0$，$\\sigma = 0.5$，最终时间 $t = 1\\ \\mathrm{s}$。\n- 测试用例4（边缘情况：零加性核函数，无衰减）：核函数 $K(m,m') = \\alpha (m + m')$，其中 $\\alpha = 0.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$，$\\mu = -42.0$，$\\sigma = 0.7$，最终时间 $t = 3600\\ \\mathrm{s}$。\n\n科学真实性要求：\n- 对于除了聚集之外没有源或汇的纯凝聚过程，总质量密度 $M_1(t)$ 不随时间改变，即 $M_1(t) = M_1(0)$。\n- 单位必须一致：$N(t)$ 的单位为 $\\mathrm{m}^{-3}$，$t$ 的单位为 $\\mathrm{s}$，$m$ 的单位为 $\\mathrm{kg}$，$K_0$ 的单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$\\alpha$ 的单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$。\n\n你的程序必须仅使用提供的信息和从斯摩棱霍夫斯基布居平衡方程出发的基本推导，为每个测试用例计算指定最终时间的 $N(t)$。将最终的数密度以 $\\mathrm{m}^{-3}$ 为单位，表示为小数点后有六位数字的科学记数法十进制浮点数。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的、按测试用例顺序列出的逗号分隔的结果列表。例如，“[value1,value2,value3,value4]”。\n\n预期输出为浮点数。设计算法时，应通过正确处理质量守恒和零核函数行为来确保其对边界和边缘情况具有鲁棒性，避免数值不稳定性。",
            "solution": "该问题要求针对不同的凝聚核函数和初始条件，计算在指定最终时间 $t$ 的总颗粒数密度 $N(t)$。基于数量的质量分布 $n(m,t)$ 的演化由斯摩棱霍夫斯基布居平衡方程控制。我们可以通过将斯摩棱霍夫斯基方程对所有颗粒质量 $m$ 进行积分，得到关于 $N(t)$ 的常微分方程（ODE）。\n\n总数密度定义为 $N(t) = \\int_{0}^{\\infty} n(m,t) \\, dm$。其时间导数为：\n$$\n\\frac{dN(t)}{dt} = \\int_{0}^{\\infty} \\frac{\\partial n(m,t)}{\\partial t} \\, dm\n$$\n将斯摩棱霍夫斯基方程代入 $\\frac{\\partial n(m,t)}{\\partial t}$：\n$$\n\\frac{dN(t)}{dt} = \\int_{0}^{\\infty} \\left[ \\frac{1}{2}\\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' - n(m,t) \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm' \\right] dm\n$$\n通过对生成项和损失项进行积分，并利用核函数的对称性，可以证明总数密度的变化率遵循以下通用方程：\n$$\n\\frac{dN(t)}{dt} = -\\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K(m,m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n这个通用方程可以针对具体的凝聚核函数 $K(m,m')$ 进行求解。\n\n**情况A：常数核函数，$K(m,m') = K_0$**\n对于常数核函数，积分可以分离：\n$$\n\\frac{dN(t)}{dt} = -\\frac{K_0}{2} \\left[ \\int_0^\\infty n(m,t) \\, dm \\right] \\left[ \\int_0^\\infty n(m',t) \\, dm' \\right] = -\\frac{K_0}{2} N(t)^2\n$$\n这是一个可分离的常微分方程。在初始条件 $N(0)=N_0$ 下积分，得到解：\n$$\nN(t) = \\frac{N_0}{1 + \\frac{N_0 K_0 t}{2}}\n$$\n该解仅取决于 $N_0$、$K_0$ 和 $t$。对于此核函数，不需要初始质量分布的细节，如 $\\mu$ 和 $\\sigma$。\n\n**情况B：加性核函数，$K(m,m') = \\alpha (m + m')$**\n对于加性核函数，积分变为：\n$$\n\\frac{dN(t)}{dt} = -\\frac{\\alpha}{2} \\int_0^\\infty \\int_0^\\infty (m+m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n$$\n\\frac{dN(t)}{dt} = -\\frac{\\alpha}{2} \\left[ \\int_0^\\infty m \\, n(m,t) dm \\int_0^\\infty n(m',t) dm' + \\int_0^\\infty n(m,t) dm \\int_0^\\infty m' \\, n(m',t) dm' \\right]\n$$\n这些积分代表一阶矩（总质量密度）$M_1(t) = \\int_0^\\infty m \\, n(m,t) \\, dm$ 和零阶矩（总数密度）$N(t)$。\n$$\n\\frac{dN(t)}{dt} = -\\frac{\\alpha}{2} \\left[ M_1(t) N(t) + N(t) M_1(t) \\right] = -\\alpha M_1(t) N(t)\n$$\n在纯凝聚过程中总质量是守恒的，因此 $M_1(t) = M_1(0)$。初始质量密度由 $M_1(0) = N_0 \\, \\mathbb{E}[m]$ 给出，其中初始对数正态分布的平均质量 $\\mathbb{E}[m]$ 为 $\\mathbb{E}[m] = \\exp(\\mu + \\sigma^2/2)$。\n该常微分方程变为一个可分离的线性常微分方程：$\\frac{dN}{N} = -\\alpha M_1(0) dt$。积分后得到解：\n$$\nN(t) = N_0 \\exp(-\\alpha M_1(0) t) = N_0 \\exp(-\\alpha N_0 \\exp(\\mu + \\sigma^2/2) t)\n$$\n\n现在我们将这些推导出的公式应用于具体的测试用例。\n\n**测试用例1：** 常数核函数，$K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 1.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，以及 $t = 10000\\ \\mathrm{s}$。\n$N(10000) = \\frac{1.0 \\times 10^{12}}{1 + \\frac{(1.0 \\times 10^{12})(2.0 \\times 10^{-16})(10000)}{2}} = 5.0 \\times 10^{11}\\ \\mathrm{m}^{-3}$。\n\n**测试用例2：** 加性核函数，$\\alpha = 100.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -40.9334$，$\\sigma = 0.6$，以及 $t = 1000\\ \\mathrm{s}$。\n$M_1(0) = (5.0 \\times 10^{12}) \\exp(-40.9334 + 0.6^2/2) \\approx 5.000001 \\times 10^{-6}\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n$N(1000) = (5.0 \\times 10^{12}) \\exp(-(100.0)(5.000001 \\times 10^{-6})(1000)) \\approx 3.032653 \\times 10^{12}\\ \\mathrm{m}^{-3}$。\n\n**测试用例3：** 常数核函数，$K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，以及 $t = 1\\ \\mathrm{s}$。\n$N(1) = \\frac{5.0 \\times 10^{12}}{1 + \\frac{(5.0 \\times 10^{12})(2.0 \\times 10^{-16})(1)}{2}} \\approx 4.997501 \\times 10^{12}\\ \\mathrm{m}^{-3}$。\n\n**测试用例4：** 加性核函数，$\\alpha = 0.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$，以及 $t = 3600\\ \\mathrm{s}$。\n由于 $\\alpha=0$，核函数 $K(m,m')$ 恒等于零。因此没有凝聚发生，$N(t)$ 保持不变。\n$N(3600) = N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the total particle number density N(t) for soot coagulation\n    based on the Smoluchowski population balance equation for different\n    kernels and initial conditions.\n    \"\"\"\n    \n    # Test cases are provided as a list of dictionaries.\n    # 'kernel_type' is either 'constant' or 'additive'.\n    test_cases = [\n        # Test Case 1: constant-kernel\n        {'kernel_type': 'constant', 'K0': 2.0e-16, 'N0': 1.0e12, 't': 10000.0, 'mu': -44.0, 'sigma': 0.4},\n        # Test Case 2: additive-mass kernel\n        {'kernel_type': 'additive', 'alpha': 100.0, 'N0': 5.0e12, 't': 1000.0, 'mu': -40.9334, 'sigma': 0.6},\n        # Test Case 3: constant-kernel, short time\n        {'kernel_type': 'constant', 'K0': 2.0e-16, 'N0': 5.0e12, 't': 1.0, 'mu': -43.0, 'sigma': 0.5},\n        # Test Case 4: additive-mass kernel, zero alpha\n        {'kernel_type': 'additive', 'alpha': 0.0, 'N0': 1.0e13, 't': 3600.0, 'mu': -42.0, 'sigma': 0.7},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N0 = case['N0']\n        t = case['t']\n        \n        if case['kernel_type'] == 'constant':\n            # For a constant kernel K(m,m') = K0, the solution is:\n            # N(t) = N0 / (1 + (N0 * K0 * t) / 2)\n            K0 = case['K0']\n            \n            denominator = 1.0 + (N0 * K0 * t) / 2.0\n            N_t = N0 / denominator\n            \n        elif case['kernel_type'] == 'additive':\n            # For an additive kernel K(m,m') = alpha*(m+m'), the solution is:\n            # N(t) = N0 * exp(-alpha * M1_0 * t)\n            # where M1_0 is the initial mass density.\n            # M1_0 = N0 * E[m] = N0 * exp(mu + sigma^2 / 2)\n            alpha = case['alpha']\n            mu = case['mu']\n            sigma = case['sigma']\n            \n            # Handle the edge case where alpha is zero, which means no coagulation.\n            if alpha == 0.0:\n                N_t = N0\n            else:\n                # Calculate initial mass density M1(0)\n                mean_mass = np.exp(mu + (sigma**2) / 2.0)\n                M1_0 = N0 * mean_mass\n                \n                # Calculate N(t)\n                exponent = -alpha * M1_0 * t\n                N_t = N0 * np.exp(exponent)\n        \n        else:\n            # This case should not be reached with the given problem statement.\n            raise ValueError(f\"Unknown kernel type: {case['kernel_type']}\")\n\n        # Format the result to scientific notation with 6 decimal places.\n        results.append(f\"{N_t:.6e}\")\n\n    # The final output must be a single line: a comma-separated list in brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实燃烧过程中的凝聚核函数通常非常复杂，难以获得解析解，因此必须依赖数值方法。这项练习将引导你进入计算烟尘建模的核心：连续群体平衡方程的离散化。你将推导一种分段法的控制方程，学习如何将连续的凝聚物理过程转化为离散的数值格式，并在此过程中确保质量守恒这一基本物理定律得到精确满足。",
            "id": "4064699",
            "problem": "考虑一个含碳烟的反应流，其中布朗凝聚主导颗粒质量分布的演化。对于颗粒质量 $m0$ 和时间 $t \\ge 0$，设单位质量的碳烟聚集体的连续数密度为 $n(m,t)$。在连续尺度上，凝聚动力学由 Smoluchowski 凝聚布居平衡方程 (PBE) 控制，\n$$\n\\frac{\\partial n(m,t)}{\\partial t}\n=\n\\frac{1}{2}\\int_{0}^{m} K(m',m-m')\\, n(m',t)\\, n(m-m',t)\\, \\mathrm{d}m'\n-\nn(m,t)\\int_{0}^{\\infty} K(m,m')\\, n(m',t)\\, \\mathrm{d}m',\n$$\n其中 $K(m,m')$ 是一个对称的非负凝聚核函数，反映了质量为 $m$ 和 $m'$ 的颗粒之间的成对碰撞频率。\n\n为了在计算燃烧环境中模拟此过程，构建一个具有对数等距质量分段的分段离散化，其边界为\n$$\nb_{i} = m_{0}\\, r^{\\,i-1}, \\quad i = 1,2,\\dots,S+1,\n$$\n其中 $m_{0}0$ 是参考质量，$r1$ 是公比，$S$ 是分段数。采用固定枢轴法，其中离散数浓度 $N_{i}(t)$ 与枢轴质量 $b_{i}$ 相关联（对于 $i=1,2,\\dots,S$），并假设在枢轴处有一个通用的对称核函数 $K(b_{p},b_{q})$。\n\n当两个质量为 $b_{p}$ 和 $b_{q}$ 的颗粒发生凝聚时，产物质量为 $m_{pq}=b_{p}+b_{q}$。为确保离散系统中一阶质量矩的精确守恒，使用同时保持数量和离散质量守恒的权重，将产物的生成分配到界于 $m_{pq}$ 的两个相邻枢轴之间：\n$$\nw_{i}(m) + w_{i+1}(m) = 1, \\qquad w_{i}(m)\\, b_{i} + w_{i+1}(m)\\, b_{i+1} = m,\n$$\n每当 $m \\in [b_{i},b_{i+1})$ 时，有 $w_{i}(m) = \\dfrac{b_{i+1}-m}{b_{i+1}-b_{i}}$ 和 $w_{i+1}(m) = \\dfrac{m-b_{i}}{b_{i+1}-b_{i}}$。使用指示函数 $\\chi_{[a,b)}(x)$ 来形式化地表示这种界定关系，当 $x \\in [a,b)$ 时，该函数等于 $1$，否则等于 $0$。\n\n从连续的 Smoluchowski PBE 和上述分段框架出发，推导对于内部质量分段索引 $i \\in \\{2,3,\\dots,S\\}$ 的数浓度 $N_{i}(t)$ 的时间变化率的离散凝聚贡献，包括生成项和消失项，并以 $b_{i}$, $m_{0}$, $r$, $K(b_{p},b_{q})$, $N_{p}(t)$, $N_{q}(t)$ 和 $\\chi_{[a,b)}(\\cdot)$ 的闭合形式表示。通过上述指定的分段分裂权重，显式地强制执行精确的离散质量守恒。\n\n仅使用已引入的符号，将您对 $\\dfrac{\\mathrm{d}N_{i}}{\\mathrm{d}t}$ 的凝聚贡献的最终答案表示为单个解析表达式。无需进行数值计算。",
            "solution": "第 $i$ 段中数浓度 $N_i(t)$ 的时间变化率是其形成速率（生成）和其移除速率（消失）之间的差值。\n$$ \\frac{\\mathrm{d}N_i(t)}{\\mathrm{d}t} = (\\text{生成速率})_i - (\\text{消失速率})_i $$\n\n**消失项**\n当具有枢轴质量 $b_i$ 的颗粒与系统中的任何其他颗粒（包括来自第 $i$ 段的其他颗粒）发生凝聚时，它们会从第 $i$ 段中消失。来自第 $i$ 段的颗粒与来自第 $q$ 段的颗粒之间的凝聚事件速率与其数浓度之积 $N_i(t)N_q(t)$ 以及凝聚核函数 $K(b_i,b_q)$ 成正比。第 $i$ 段颗粒的总损失速率是与所有分段 $q=1, \\dots, S$ 中的颗粒碰撞所造成损失的总和。\n$$ (\\text{消失速率})_i = N_i(t) \\sum_{q=1}^{S} K(b_i, b_q) N_q(t) $$\n\n**生成项**\n当来自第 $p$ 段和第 $q$ 段的两个较小颗粒凝聚形成质量为 $m_{pq} = b_p+b_q$ 的新颗粒时，颗粒会在第 $i$ 段中生成。这个新颗粒通常不位于枢轴质量上，必须分配到相邻的枢轴上以保持质量守恒。\n总凝聚事件速率通过对所有唯一的分段对 $(p,q)$ 求和得到，即 $\\frac{1}{2}\\sum_{p=1}^{S}\\sum_{q=1}^{S} K(b_p,b_q)N_p(t)N_q(t)$。对于每个此类事件，会产生一个质量为 $m_{pq}$ 的颗粒。\n根据固定枢轴分裂方案，一个新颗粒通过两种方式对第 $i$ 段做出贡献：\n1.  如果新质量 $m_{pq}$ 落在区间 $[b_{i-1}, b_i)$ 内，则新形成的颗粒的一部分被分配到枢轴 $b_i$。此种情况发生当且仅当 $\\chi_{[b_{i-1}, b_i)}(m_{pq}) = 1$，分配到枢轴 $b_i$ 的分数由权重 $w_i(m_{pq}) = \\frac{m_{pq}-b_{i-1}}{b_i-b_{i-1}}$ 给出。\n2.  如果新质量 $m_{pq}$ 落在区间 $[b_i, b_{i+1})$ 内，则新形成的颗粒的一部分被分配到枢轴 $b_i$。此种情况发生当且仅当 $\\chi_{[b_i, b_{i+1})}(m_{pq}) = 1$，分配到枢轴 $b_i$ 的分数由权重 $w_i(m_{pq}) = \\frac{b_{i+1}-m_{pq}}{b_{i+1}-b_i}$ 给出。\n\n进入第 $i$ 段的总生成速率是所有可能的凝聚对 $(p,q)$ 贡献的总和，并由适当的分裂分数加权：\n$$ (\\text{生成速率})_i = \\frac{1}{2} \\sum_{p=1}^{S} \\sum_{q=1}^{S} K(b_p, b_q) N_p(t) N_q(t) \\left[ \\frac{b_p+b_q-b_{i-1}}{b_i-b_{i-1}}\\chi_{[b_{i-1}, b_i)}(b_p+b_q) + \\frac{b_{i+1}-(b_p+b_q)}{b_{i+1}-b_i}\\chi_{[b_i, b_{i+1})}(b_p+b_q) \\right] $$\n\n**最终表达式**\n结合生成项和消失项，并利用对数网格关系 $b_{i-1}=b_i/r$ 和 $b_{i+1}=b_i r$，权重分数可以重写。$N_i(t)$ 变化率的完整表达式为：\n$$ \\frac{\\mathrm{d}N_i(t)}{\\mathrm{d}t} = \\frac{1}{2} \\sum_{p=1}^{S} \\sum_{q=1}^{S} K(b_p, b_q) N_p(t) N_q(t) \\left[ \\frac{r(b_p+b_q) - b_i}{b_i(r-1)} \\chi_{[b_i/r, b_i)}(b_p+b_q) + \\frac{b_i r - (b_p+b_q)}{b_i(r-1)} \\chi_{[b_i, b_ir)}(b_p+b_q) \\right] - N_i(t) \\sum_{q=1}^{S} K(b_i, b_q) N_q(t) $$\n这就是对于内部质量分段 $i \\in \\{2, \\dots, S\\}$ 的所求表达式。",
            "answer": "$$ \\boxed{ \\frac{1}{2}\\sum_{p=1}^{S} \\sum_{q=1}^{S} K(b_p, b_q) N_p(t) N_q(t) \\left[ \\frac{r(b_p+b_q) - b_i}{b_i(r-1)} \\chi_{[b_i/r, b_i)}(b_p+b_q) + \\frac{b_i r - (b_p+b_q)}{b_i(r-1)} \\chi_{[b_i, b_ir)}(b_p+b_q) \\right] - N_i(t) \\sum_{q=1}^{S} K(b_i, b_q) N_q(t) } $$"
        }
    ]
}