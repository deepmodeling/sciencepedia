{
    "hands_on_practices": [
        {
            "introduction": "The Interaction by Exchange with the Mean (IEM) model is a foundational closure for micro-mixing in PDF methods, describing how scalar fluctuations decay as individual realizations relax towards the ensemble mean. This exercise provides an analytical window into this process, helping you build intuition for how mixing models homogenize a scalar field over time . By tracking the evolution of a simple bimodal distribution, you will derive the characteristic exponential decay of scalar variance inherent to the IEM model.",
            "id": "4068250",
            "problem": "Consider homogeneous turbulent mixing of a conserved mixture fraction $Z$ in a statistically stationary, spatially uniform reactor with no sources, sinks, or mean-flow gradients. The Probability Density Function (PDF) of $Z$ at initial time $t=0$ is bimodal and consists of a convex combination of two Dirac delta distributions,\n$$\nP(Z,0) \\;=\\; w_1\\,\\delta\\!\\left(Z - z_1\\right) \\;+\\; w_2\\,\\delta\\!\\left(Z - z_2\\right),\n$$\nwhere $w_10$, $w_20$, $w_1+w_2=1$, and $z_1 \\neq z_2$. Mixing is modeled using the Interaction by Exchange with the Mean (IEM) model, whose micro-mixing law for any realization $Z(t)$ is\n$$\n\\frac{dZ}{dt} \\;=\\; -\\,\\frac{1}{\\tau_m}\\,\\bigl(Z(t) - \\widetilde{Z}(t)\\bigr),\n$$\nwhere $\\tau_m0$ is a constant micro-mixing timescale, and $\\widetilde{Z}(t)$ is the ensemble mean of $Z$ at time $t$. Assume the mean $\\widetilde{Z}(t)$ is determined self-consistently from the evolving PDF, and the system is closed and homogeneous so that conservation laws apply.\n\nStarting from the fundamental conservation of the mean for a conserved scalar under homogeneous IEM mixing and the deterministic Liouville transport of PDFs under the drift $\\dot{Z} = -(Z - \\widetilde{Z})/\\tau_m$, derive the time evolution of the PDF, $P(Z,t)$, for $t0$ and show explicitly how the two delta peaks move in time. Then, define the bimodality index\n$$\nB(t) \\;=\\; \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|},\n$$\nwhere $z_1(t)$ and $z_2(t)$ denote the instantaneous peak locations at time $t$, and compute $B(t)$ in closed form.\n\nProvide your final answer as a single closed-form symbolic expression for $B(t)$. No rounding is required. The bimodality index $B(t)$ is dimensionless; do not include units in your final answer.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Initial Probability Density Function (PDF) of mixture fraction $Z$: $P(Z,0) = w_1\\,\\delta(Z - z_1) + w_2\\,\\delta(Z - z_2)$.\n- Conditions on weights: $w_1  0$, $w_2  0$, $w_1+w_2=1$.\n- Initial peak locations: $z_1 \\neq z_2$.\n- Mixing Model: Interaction by Exchange with the Mean (IEM).\n- IEM Law: $\\frac{dZ}{dt} = -\\frac{1}{\\tau_m}(Z(t) - \\widetilde{Z}(t))$.\n- Micro-mixing timescale: $\\tau_m0$ is a constant.\n- Ensemble Mean: $\\widetilde{Z}(t) = \\int_{-\\infty}^{\\infty} \\xi P(\\xi, t) d\\xi$.\n- System properties: Homogeneous, statistically stationary, closed, no sources or sinks, $Z$ is a conserved scalar.\n- Bimodality Index Definition: $B(t) = \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|}$, where $z_1(t)$ and $z_2(t)$ are the peak locations at time $t$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard model (IEM) for scalar mixing in turbulence, which is a core topic in computational combustion. It is well-posed, providing a clear initial value problem for the evolution of a PDF. The language is objective and uses standard terminology. The statement that $Z$ is a conserved scalar in a closed, homogeneous system implies that its mean value $\\widetilde{Z}(t)$ must be constant. This can be verified by taking the time derivative of the definition of the mean and using the Liouville transport equation for the PDF, $\\frac{\\partial P}{\\partial t} + \\frac{\\partial}{\\partial Z}(\\dot{Z}P)=0$, where $\\dot{Z}$ is the IEM mixing law. This leads to $\\frac{d\\widetilde{Z}}{dt} = \\int \\dot{Z}P\\,dZ = \\int -\\frac{1}{\\tau_m}(Z - \\widetilde{Z})P\\,dZ = -\\frac{1}{\\tau_m}(\\widetilde{Z} - \\widetilde{Z}) = 0$. Thus, $\\widetilde{Z}(t)$ is indeed constant. The problem is self-consistent and contains all necessary information.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be provided.\n\nThe problem requires the derivation of the time evolution of the PDF, $P(Z,t)$, and the bimodality index, $B(t)$.\n\nFirst, we establish the value of the constant ensemble mean, $\\widetilde{Z}$. Since $\\widetilde{Z}(t)$ is constant for all $t \\ge 0$, we can compute it at $t=0$ using the given initial PDF, $P(Z,0)$.\n$$\n\\widetilde{Z} = \\widetilde{Z}(0) = \\int_{-\\infty}^{\\infty} Z \\, P(Z,0) \\, dZ\n$$\nSubstituting the expression for $P(Z,0)$:\n$$\n\\widetilde{Z} = \\int_{-\\infty}^{\\infty} Z \\, \\left[ w_1\\,\\delta(Z - z_1) + w_2\\,\\delta(Z - z_2) \\right] \\, dZ\n$$\nUsing the sifting property of the Dirac delta distribution, $\\int f(x)\\delta(x-a)dx = f(a)$, we get:\n$$\n\\widetilde{Z} = w_1 z_1 + w_2 z_2\n$$\nThis is the constant mean value of the mixture fraction for all time $t \\ge 0$.\n\nNext, we analyze the evolution of any single realization, $Z(t)$, governed by the IEM model. The IEM law is a first-order linear ordinary differential equation (ODE):\n$$\n\\frac{dZ}{dt} = -\\frac{1}{\\tau_m}\\left(Z(t) - \\widetilde{Z}\\right)\n$$\nThis equation can be solved by separation of variables or by identifying it as a standard linear ODE form. Let $Y(t) = Z(t) - \\widetilde{Z}$. Then $\\frac{dY}{dt} = \\frac{dZ}{dt}$. The ODE becomes:\n$$\n\\frac{dY}{dt} = -\\frac{1}{\\tau_m}Y(t)\n$$\nThe solution to this homogeneous ODE is $Y(t) = Y(0)\\,\\exp(-t/\\tau_m)$. Substituting back for $Z(t)$:\n$$\nZ(t) - \\widetilde{Z} = \\left(Z(0) - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\nThis can be rearranged to give the trajectory of any point $Z(0)$ in the scalar space:\n$$\nZ(t) = \\widetilde{Z} + \\left(Z(0) - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\nThis equation describes a deterministic mapping from the scalar value at $t=0$ to the scalar value at time $t$.\n\nThe evolution of the PDF, $P(Z,t)$, under this deterministic mapping is found by transporting the initial PDF along these trajectories. The initial PDF is composed of two Dirac delta distributions located at $Z=z_1$ and $Z=z_2$. Each delta function will move according to the trajectory equation derived above.\n\nLet $z_1(t)$ be the position of the peak that was initially at $z_1 \\equiv z_1(0)$. Using the trajectory equation with $Z(0)=z_1$:\n$$\nz_1(t) = \\widetilde{Z} + \\left(z_1 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\nSimilarly, for the peak initially at $z_2 \\equiv z_2(0)$, its position $z_2(t)$ is given by:\n$$\nz_2(t) = \\widetilde{Z} + \\left(z_2 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\nSince the weights $w_1$ and $w_2$ represent conserved probabilities (or mass fractions of the delta distributions), they remain constant. Therefore, the PDF at any time $t0$ is given by the sum of the two transported delta distributions:\n$$\nP(Z,t) = w_1\\,\\delta(Z - z_1(t)) + w_2\\,\\delta(Z - z_2(t))\n$$\nThis explicitly shows how the two delta peaks move in time, relaxing exponentially towards the mean $\\widetilde{Z}$.\n\nNow, we compute the bimodality index, $B(t)$, defined as:\n$$\nB(t) = \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|}\n$$\nThe denominator is simply $|z_2 - z_1|$. For the numerator, we compute the difference $z_2(t) - z_1(t)$:\n$$\nz_2(t) - z_1(t) = \\left[ \\widetilde{Z} + \\left(z_2 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\right] - \\left[ \\widetilde{Z} + \\left(z_1 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\right]\n$$\n$$\nz_2(t) - z_1(t) = \\left[ (z_2 - \\widetilde{Z}) - (z_1 - \\widetilde{Z}) \\right] \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n$$\nz_2(t) - z_1(t) = (z_2 - z_1) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\nTaking the absolute value of this difference:\n$$\n|z_2(t) - z_1(t)| = \\left|(z_2 - z_1) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\\right|\n$$\nSince $t \\ge 0$ and $\\tau_m  0$, the exponential term $\\exp(-t/\\tau_m)$ is always non-negative. Thus:\n$$\n|z_2(t) - z_1(t)| = |z_2 - z_1| \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\nFinally, we substitute this result into the definition of $B(t)$:\n$$\nB(t) = \\frac{|z_2 - z_1| \\exp\\left(-\\frac{t}{\\tau_m}\\right)}{|z_2 - z_1|}\n$$\nGiven that $z_1 \\neq z_2$, the term $|z_2 - z_1|$ is non-zero and can be cancelled from the numerator and denominator. This yields the closed-form expression for the bimodality index:\n$$\nB(t) = \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\nThis result shows that the distance between the two modes of the PDF decays exponentially with a characteristic time equal to the micro-mixing timescale $\\tau_m$, which is the expected physical behavior of the IEM model.",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{t}{\\tau_m}\\right)}$$"
        },
        {
            "introduction": "Moving from theory to practice requires verifying that a numerical implementation correctly solves the governing equations, a process essential for building confidence in simulation results. This practice guides you through the crucial process of code verification for an Eulerian Stochastic Field (ESF) solver by comparing its predictions against a known analytical solution . You will first derive the exact evolution of the mean and variance for a system with linear reaction and IEM mixing, and then write a simple numerical solver to confirm that your code reproduces these analytical benchmarks.",
            "id": "4068263",
            "problem": "Consider a spatially homogeneous, one-dimensional scalar in a homogeneous reactor for computational combustion, where the scalar field is represented by an ensemble of Eulerian Stochastic Fields (ESF). The scalar concentration is denoted by $\\,\\phi\\,$ and is dimensionless. The evolution is driven by a linear reaction and small-scale mixing. The linear reaction is given by $\\,d\\phi/dt=-\\lambda\\,\\phi\\,$, where $\\,\\lambda\\,$ is a constant reaction rate with unit $\\,\\mathrm{s}^{-1}\\,$. The mixing is modeled by Interaction by Exchange with the Mean (IEM), which relaxes each field toward the instantaneous mean at a constant mixing frequency $\\,\\gamma\\,$ with unit $\\,\\mathrm{s}^{-1}\\,$. Let there be $\\,M\\,$ ESF fields $\\,\\{\\phi_k(t)\\}_{k=1}^M\\,$ with sample mean $\\,\\bar{\\phi}(t)=(1/M)\\sum_{k=1}^M \\phi_k(t)\\,$ and sample variance $\\,\\mathcal{V}(t)=(1/M)\\sum_{k=1}^M \\left(\\phi_k(t)-\\bar{\\phi}(t)\\right)^2\\,$. The ESF evolution for each field is defined by the ordinary differential equation\n$$\n\\frac{d\\phi_k}{dt} \\;=\\; -\\,\\lambda\\,\\phi_k \\;+\\; \\gamma\\,\\big(\\,\\bar{\\phi}\\;-\\;\\phi_k\\,\\big),\n$$\nwhere $\\,\\lambda \\ge 0\\,$ and $\\,\\gamma \\ge 0\\,$ are constants, and $\\,t\\,$ is time in $\\,\\mathrm{s}\\,$.\n\nYour tasks:\n- Starting from the field evolution equation, derive evolution equations for the ensemble mean $\\,\\bar{\\phi}(t)\\,$ and the variance $\\,\\mathcal{V}(t)\\,$. Use only fundamental operations such as linearity of differentiation and averaging, and the definition of variance for an ensemble. Do not assume any pre-known closed-form expressions; derive them from first principles.\n- Solve the derived mean and variance evolution equations in time to obtain closed-form analytical expressions for $\\,\\bar{\\phi}(t)\\,$ and $\\,\\mathcal{V}(t)\\,$ as functions of $\\,\\bar{\\phi}(0)\\,$, $\\,\\mathcal{V}(0)\\,$, $\\,\\lambda\\,$, $\\,\\gamma\\,$, and $\\,t\\,$.\n- Implement an ESF solver using the explicit Euler time-integration method with a uniform time step $\\,\\Delta t\\,$ to advance the $\\,M\\,$ fields, compute the sample mean and variance at a specified final time $\\,t_{\\mathrm{end}}\\,$, and compare the ESF-computed mean and variance to the analytical expressions you derived. Report the maximum absolute deviation between the numerical and analytical values at $\\,t_{\\mathrm{end}}\\,$.\n\nPhysical units: $\\,\\lambda\\,$ and $\\,\\gamma\\,$ are in $\\,\\mathrm{s}^{-1}\\,$, $\\,t\\,$ and $\\,\\Delta t\\,$ are in $\\,\\mathrm{s}\\,$. The scalar $\\,\\phi\\,$ is dimensionless. The final outputs are absolute errors in the scalar values and are therefore dimensionless. Express angles, if any, in radians. No angles are needed in this problem.\n\nNumerical method requirement: Use explicit Euler for time integration, i.e., for each time step update\n$$\n\\phi_k^{n+1} \\;=\\; \\phi_k^n \\;+\\; \\Delta t\\,\\Big(-\\lambda\\,\\phi_k^n + \\gamma\\,(\\bar{\\phi}^n - \\phi_k^n)\\Big),\n$$\nwhere $\\,\\bar{\\phi}^n\\,$ is the sample mean at time step $\\,n\\,$.\n\nTest suite: Implement and run the following five test cases. For each case, the initial field values $\\{\\phi_k(0)\\}$ are given explicitly, along with $\\,\\lambda\\,$, $\\,\\gamma\\,$, $\\,t_{\\mathrm{end}}\\,$, and $\\,\\Delta t\\,$. For each case, compute the ESF mean and variance at $\\,t_{\\mathrm{end}}\\,$, compute the analytical mean and variance at $\\,t_{\\mathrm{end}}\\,$ using your derived formulas, and return the maximum absolute deviation between the two pairs.\n\n- Case $\\,1\\,$ (reaction only): $\\lambda=1.0\\,\\mathrm{s}^{-1}$, $\\gamma=0.0\\,\\mathrm{s}^{-1}$, $t_{\\mathrm{end}}=1.0\\,\\mathrm{s}$, $\\Delta t=1.0\\times 10^{-4}\\,\\mathrm{s}$, $\\{\\phi_k(0)\\}=[-1.0,\\,-0.5,\\,0.0,\\,0.5,\\,1.0]$.\n- Case $\\,2\\,$ (mixing only): $\\lambda=0.0\\,\\mathrm{s}^{-1}$, $\\gamma=3.0\\,\\mathrm{s}^{-1}$, $t_{\\mathrm{end}}=0.5\\,\\mathrm{s}$, $\\Delta t=1.0\\times 10^{-4}\\,\\mathrm{s}$, $\\{\\phi_k(0)\\}=[1.0,\\,2.0,\\,3.0,\\,4.0]$.\n- Case $\\,3\\,$ (reaction and mixing): $\\lambda=0.7\\,\\mathrm{s}^{-1}$, $\\gamma=1.3\\,\\mathrm{s}^{-1}$, $t_{\\mathrm{end}}=0.8\\,\\mathrm{s}$, $\\Delta t=1.0\\times 10^{-4}\\,\\mathrm{s}$, $\\{\\phi_k(0)\\}=[0.2,\\,1.1,\\,-0.4,\\,2.0,\\,-1.2,\\,0.0]$.\n- Case $\\,4\\,$ (single field edge case): $\\lambda=2.0\\,\\mathrm{s}^{-1}$, $\\gamma=10.0\\,\\mathrm{s}^{-1}$, $t_{\\mathrm{end}}=0.3\\,\\mathrm{s}$, $\\Delta t=1.0\\times 10^{-4}\\,\\mathrm{s}$, $\\{\\phi_k(0)\\}=[3.0]$.\n- Case $\\,5\\,$ (zero-time boundary): $\\lambda=0.3\\,\\mathrm{s}^{-1}$, $\\gamma=0.9\\,\\mathrm{s}^{-1}$, $t_{\\mathrm{end}}=0.0\\,\\mathrm{s}$, $\\Delta t=1.0\\times 10^{-3}\\,\\mathrm{s}$, $\\{\\phi_k(0)\\}=[0.7,\\,-0.2,\\,0.5]$.\n\nFinal output format: Your program should produce a single line of output containing the five maximum absolute deviations (one per test case) as a comma-separated list enclosed in square brackets, for example $\\,\\,[e_1,e_2,e_3,e_4,e_5]\\,\\,$, where each $\\,e_i\\,$ is a floating-point number (dimensionless).",
            "solution": "The problem requires the derivation of analytical solutions for the mean and variance of an ensemble of Eulerian Stochastic Fields (ESF) and a comparison with a numerical solution. The evolution of each field $\\phi_k$ is governed by a linear ordinary differential equation (ODE) that models reaction and mixing.\n\nFirst, we derive the evolution equation for the ensemble mean, $\\bar{\\phi}(t)$. The mean is defined as:\n$$\n\\bar{\\phi}(t) = \\frac{1}{M} \\sum_{k=1}^{M} \\phi_k(t)\n$$\nwhere $M$ is the number of stochastic fields. We differentiate $\\bar{\\phi}(t)$ with respect to time $t$. Due to the linearity of differentiation and summation, we can exchange the order of these operations:\n$$\n\\frac{d\\bar{\\phi}}{dt} = \\frac{d}{dt} \\left( \\frac{1}{M} \\sum_{k=1}^{M} \\phi_k \\right) = \\frac{1}{M} \\sum_{k=1}^{M} \\frac{d\\phi_k}{dt}\n$$\nNow, we substitute the given evolution equation for each field, $\\frac{d\\phi_k}{dt} = -\\lambda\\phi_k + \\gamma(\\bar{\\phi}-\\phi_k)$:\n$$\n\\frac{d\\bar{\\phi}}{dt} = \\frac{1}{M} \\sum_{k=1}^{M} \\left[ -\\lambda\\phi_k + \\gamma(\\bar{\\phi}-\\phi_k) \\right]\n$$\nWe can split the summation:\n$$\n\\frac{d\\bar{\\phi}}{dt} = \\frac{1}{M} \\sum_{k=1}^{M} (-\\lambda\\phi_k) + \\frac{1}{M} \\sum_{k=1}^{M} \\gamma(\\bar{\\phi}-\\phi_k)\n$$\nUsing the linearity of the summation operator and pulling out constants:\n$$\n\\frac{d\\bar{\\phi}}{dt} = -\\lambda \\left( \\frac{1}{M} \\sum_{k=1}^{M} \\phi_k \\right) + \\gamma \\left( \\frac{1}{M} \\sum_{k=1}^{M} (\\bar{\\phi}-\\phi_k) \\right)\n$$\nThe first term contains the definition of the mean, $\\bar{\\phi} = \\frac{1}{M}\\sum\\phi_k$. The second term simplifies to zero:\n$$\n\\frac{1}{M} \\sum_{k=1}^{M} (\\bar{\\phi}-\\phi_k) = \\frac{1}{M} \\left( \\sum_{k=1}^{M} \\bar{\\phi} - \\sum_{k=1}^{M} \\phi_k \\right) = \\frac{1}{M} (M\\bar{\\phi} - M\\bar{\\phi}) = 0\n$$\nThus, the evolution equation for the mean is:\n$$\n\\frac{d\\bar{\\phi}}{dt} = -\\lambda\\bar{\\phi}\n$$\nThis is a first-order linear homogeneous ODE. With the initial condition $\\bar{\\phi}(0)$, the solution is obtained by separation of variables, yielding:\n$$\n\\bar{\\phi}(t) = \\bar{\\phi}(0) e^{-\\lambda t}\n$$\n\nNext, we derive the evolution equation for the ensemble variance, $\\mathcal{V}(t)$. The variance is defined as:\n$$\n\\mathcal{V}(t) = \\frac{1}{M} \\sum_{k=1}^{M} (\\phi_k(t) - \\bar{\\phi}(t))^2\n$$\nDifferentiating with respect to time $t$ and applying the chain rule:\n$$\n\\frac{d\\mathcal{V}}{dt} = \\frac{d}{dt} \\left( \\frac{1}{M} \\sum_{k=1}^{M} (\\phi_k - \\bar{\\phi})^2 \\right) = \\frac{1}{M} \\sum_{k=1}^{M} 2(\\phi_k - \\bar{\\phi}) \\frac{d}{dt}(\\phi_k - \\bar{\\phi})\n$$\nThe derivative term is $\\frac{d}{dt}(\\phi_k - \\bar{\\phi}) = \\frac{d\\phi_k}{dt} - \\frac{d\\bar{\\phi}}{dt}$. We substitute the expressions for $\\frac{d\\phi_k}{dt}$ and the just-derived $\\frac{d\\bar{\\phi}}{dt}$:\n$$\n\\frac{d}{dt}(\\phi_k - \\bar{\\phi}) = \\left[ -\\lambda\\phi_k + \\gamma(\\bar{\\phi}-\\phi_k) \\right] - \\left[ -\\lambda\\bar{\\phi} \\right]\n$$\nRearranging the terms:\n$$\n\\frac{d}{dt}(\\phi_k - \\bar{\\phi}) = -\\lambda\\phi_k + \\gamma\\bar{\\phi} - \\gamma\\phi_k + \\lambda\\bar{\\phi} = -\\lambda(\\phi_k-\\bar{\\phi}) - \\gamma(\\phi_k-\\bar{\\phi}) = -(\\lambda+\\gamma)(\\phi_k-\\bar{\\phi})\n$$\nNow, substitute this result back into the equation for $\\frac{d\\mathcal{V}}{dt}$:\n$$\n\\frac{d\\mathcal{V}}{dt} = \\frac{1}{M} \\sum_{k=1}^{M} 2(\\phi_k - \\bar{\\phi}) \\left[ -(\\lambda+\\gamma)(\\phi_k-\\bar{\\phi}) \\right]\n$$\nSimplifying the expression and pulling constants out of the summation:\n$$\n\\frac{d\\mathcal{V}}{dt} = -2(\\lambda+\\gamma) \\left( \\frac{1}{M} \\sum_{k=1}^{M} (\\phi_k - \\bar{\\phi})^2 \\right)\n$$\nThe term in the parenthesis is the definition of the variance, $\\mathcal{V}$. Therefore, the evolution equation for the variance is:\n$$\n\\frac{d\\mathcal{V}}{dt} = -2(\\lambda+\\gamma)\\mathcal{V}\n$$\nThis is another first-order linear homogeneous ODE. Given the initial variance $\\mathcal{V}(0)$, the solution is:\n$$\n\\mathcal{V}(t) = \\mathcal{V}(0) e^{-2(\\lambda+\\gamma)t}\n$$\n\nTo solve the problem, we will implement a Python script. This script will perform two calculations for each test case. First, it will compute the analytical mean and variance at time $t_{\\mathrm{end}}$ using the derived formulas $\\bar{\\phi}(t) = \\bar{\\phi}(0) e^{-\\lambda t}$ and $\\mathcal{V}(t) = \\mathcal{V}(0) e^{-2(\\lambda+\\gamma)t}$, where $\\bar{\\phi}(0)$ and $\\mathcal{V}(0)$ are computed from the given initial fields $\\{\\phi_k(0)\\}$. Second, it will perform a numerical time integration of the $M$ stochastic fields from $t=0$ to $t=t_{\\mathrm{end}}$ using the explicit Euler method with the given time step $\\Delta t$. The numerical update rule for each field at each time step $n$ is:\n$$\n\\phi_k^{n+1} = \\phi_k^n + \\Delta t\\,\\Big(-\\lambda\\,\\phi_k^n + \\gamma\\,(\\bar{\\phi}^n - \\phi_k^n)\\Big)\n$$\nwhere $\\bar{\\phi}^n$ is the sample mean of the fields at time step $n$. After the integration, the numerical sample mean and variance are computed from the final field values $\\{\\phi_k(t_{\\mathrm{end}})\\}$. Finally, the maximum absolute deviation between the analytical and numerical results for the mean and variance is calculated as $\\max(|\\bar{\\phi}_{\\text{numerical}} - \\bar{\\phi}_{\\text{analytical}}|, |\\mathcal{V}_{\\text{numerical}} - \\mathcal{V}_{\\text{analytical}}|)$. This process is repeated for all five test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ESF problem for five test cases, comparing numerical and analytical solutions.\n    \"\"\"\n    test_cases = [\n        {\n            \"lambda_val\": 1.0,\n            \"gamma_val\": 0.0,\n            \"t_end\": 1.0,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [-1.0, -0.5, 0.0, 0.5, 1.0],\n        },\n        {\n            \"lambda_val\": 0.0,\n            \"gamma_val\": 3.0,\n            \"t_end\": 0.5,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [1.0, 2.0, 3.0, 4.0],\n        },\n        {\n            \"lambda_val\": 0.7,\n            \"gamma_val\": 1.3,\n            \"t_end\": 0.8,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [0.2, 1.1, -0.4, 2.0, -1.2, 0.0],\n        },\n        {\n            \"lambda_val\": 2.0,\n            \"gamma_val\": 10.0,\n            \"t_end\": 0.3,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [3.0],\n        },\n        {\n            \"lambda_val\": 0.3,\n            \"gamma_val\": 0.9,\n            \"t_end\": 0.0,\n            \"dt\": 1.0e-3,\n            \"phi_initial\": [0.7, -0.2, 0.5],\n        },\n    ]\n\n    max_deviations = []\n\n    for case in test_cases:\n        lambda_val = case[\"lambda_val\"]\n        gamma_val = case[\"gamma_val\"]\n        t_end = case[\"t_end\"]\n        dt = case[\"dt\"]\n        phi_initial = np.array(case[\"phi_initial\"], dtype=np.float64)\n\n        # --- Analytical Solution ---\n        mean_initial = np.mean(phi_initial)\n        var_initial = np.var(phi_initial)  # ddof=0 is default, matches problem definition\n\n        mean_analytical = mean_initial * np.exp(-lambda_val * t_end)\n        var_analytical = var_initial * np.exp(-2 * (lambda_val + gamma_val) * t_end)\n\n        # --- Numerical Solution (Explicit Euler) ---\n        phi_current = phi_initial.copy()\n        \n        # Using np.round to handle potential floating-point inaccuracies in division\n        num_steps = int(np.round(t_end / dt))\n\n        for _ in range(num_steps):\n            mean_current = np.mean(phi_current)\n            # Vectorized Euler step for all fields\n            rhs = -lambda_val * phi_current + gamma_val * (mean_current - phi_current)\n            phi_current += dt * rhs\n\n        mean_numerical = np.mean(phi_current)\n        var_numerical = np.var(phi_current)\n\n        # --- Comparison ---\n        error_mean = np.abs(mean_numerical - mean_analytical)\n        error_var = np.abs(var_numerical - var_analytical)\n        \n        max_deviation = np.max([error_mean, error_var])\n        max_deviations.append(max_deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{d:.12e}' for d in max_deviations])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While stochastic models approximate physical processes, their numerical implementation must rigorously preserve fundamental physical laws, such as the positivity of species mass fractions. The mathematical structure of a model and its numerical discretization determine whether these physical bounds are automatically respected, and violations can lead to catastrophic simulation failures. This exercise challenges you to critically analyze the properties of common mixing models and numerical schemes, a crucial skill for developing robust and reliable computational solvers .",
            "id": "4068331",
            "problem": "Consider a turbulent reacting flow modeled with a Probability Density Function (PDF) transport approach in computational combustion, where species mass fractions are treated as stochastic variables. Let the vector of species mass fractions be denoted by $\\boldsymbol{Y} = (Y_1, Y_2, \\dots, Y_{N_s})$ with the physical constraints $Y_k \\ge 0$ for all $k$, $Y_k \\le 1$ for all $k$, and $\\sum_{k=1}^{N_s} Y_k = 1$. Two widely used micro-mixing closures are Interaction by Exchange with the Mean (IEM) and Euclidean Minimum Spanning Tree (EMST).\n\nIn a particle Monte Carlo solver, the IEM model represents micro-mixing by linear relaxation of each particle’s composition toward an appropriate mean (e.g., unconditional or conditional mean in mixture fraction space) with a characteristic time scale $\\tau_{\\mathrm{mix}}$, while EMST effects composition changes through pairwise conservative exchanges along edges of the minimum spanning tree in composition space. In Eulerian stochastic fields, the IEM-like source appears as a local relaxation term in the stochastic field equations, and additional transport terms (advection and diffusion) are discretized on a computational mesh.\n\nYou are tasked with analyzing when these models preserve the species bounds and positivity and proposing principled corrections when numerical discretization or model application violates physical constraints. Assume the following setup:\n\n- For particle IEM, an explicit Euler time integration is used for the relaxation ordinary differential equation with time step $\\Delta t$, and the mean composition used in the relaxation is computed as a convex combination of valid particle compositions at the current time.\n- For EMST, pairwise updates between particles $i$ and $j$ along tree edges are computed as convex linear exchanges controlled by a mixing coefficient $\\beta_{ij}$ per interaction, applied componentwise to all species.\n- For Eulerian stochastic fields, consider that the micro-mixing operator may appear either as a local relaxation source (IEM-like) or as a diffusion-like operator depending on the chosen stochastic field formulation and that transport terms are discretized with a finite-volume method.\n\nWhich of the following statements are correct regarding positivity and boundedness preservation and viable corrections?\n\nA. In particle IEM with explicit Euler time stepping, if the ratio $\\alpha = \\Delta t / \\tau_{\\mathrm{mix}}$ satisfies $0 \\le \\alpha \\le 1$ and the mean composition at the current time is a convex combination of valid particle states, then the update of each species $Y_k$ is a convex combination of two valid states, thereby preserving $0 \\le Y_k \\le 1$ and maintaining $\\sum_k Y_k = 1$.\n\nB. For particle IEM, using the exact analytical solution of the linear relaxation ordinary differential equation over a finite time step $\\Delta t$ yields weights that are nonnegative and sum to one for any $\\Delta t \\ge 0$, thus preserving positivity and species bounds without a time step restriction.\n\nC. In EMST, positivity and boundedness of species are preserved even if $\\beta_{ij}  1$, because pairwise exchanges still average two states and any overshoot can be cured by clipping negative values after the update.\n\nD. In Eulerian stochastic fields, discretizing the IEM relaxation source term implicitly guarantees positivity of $Y_k$ regardless of the discretizations used for advection, diffusion, and chemical source terms, because implicit schemes are unconditionally stable and monotone.\n\nE. If a solver produces small negative values in $\\boldsymbol{Y}$ due to numerical noise, a principled correction is to project $\\boldsymbol{Y}$ onto the Gibbs simplex $\\mathcal{S} = \\{\\boldsymbol{y} \\in \\mathbb{R}^{N_s}: y_k \\ge 0, \\ \\sum_k y_k = 1\\}$ by solving the minimal Euclidean distance problem $\\min_{\\boldsymbol{y} \\in \\mathcal{S}} \\|\\boldsymbol{y} - \\boldsymbol{Y}\\|_2$, which restores non-negativity and the sum-to-one constraint while minimally perturbing the state.\n\nF. In EMST with pairwise convex exchanges $Y_{i,k}^{\\text{new}} = (1 - \\beta_{ij}) Y_{i,k}^{\\text{old}} + \\beta_{ij} Y_{j,k}^{\\text{old}}$ using $0 \\le \\beta_{ij} \\le 1$, positivity can still be violated unless an additional mass-fraction rescaling is applied after each pairwise update to enforce bounds.\n\nG. For Eulerian stochastic fields where micro-mixing is represented by a diffusion-like operator, a monotone finite-volume discretization with nonnegative coefficients and a Courant–Friedrichs–Lewy (CFL) type time step restriction ensures positivity of the discrete solution for the mixing term; without such monotonicity and time step control, spurious negativity can arise.\n\nSelect all correct statements.",
            "solution": "The problem statement has been validated and is determined to be a valid, well-posed problem grounded in the principles of computational combustion and numerical analysis. I shall now proceed with a detailed derivation and evaluation of each option.\n\nThe core of the problem lies in analyzing whether various numerical schemes for micro-mixing models, used in Probability Density Function (PDF) methods, preserve the physical constraints on species mass fractions $\\boldsymbol{Y} = (Y_1, Y_2, \\dots, Y_{N_s})$. These constraints define a convex set in $\\mathbb{R}^{N_s}$, known as the Gibbs simplex: $\\mathcal{S} = \\{\\boldsymbol{y} \\in \\mathbb{R}^{N_s} : y_k \\ge 0 \\text{ for } k=1,\\dots,N_s, \\text{ and } \\sum_{k=1}^{N_s} y_k = 1\\}$. A key mathematical principle is that a convex combination of points within a convex set will itself lie within that set. A convex combination of points $\\boldsymbol{v}_1, \\dots, \\boldsymbol{v}_m$ is a linear combination $\\sum_{j=1}^m w_j \\boldsymbol{v}_j$ where the weights $w_j$ are non-negative ($w_j \\ge 0$) and sum to unity ($\\sum_{j=1}^m w_j = 1$).\n\n**Analysis of Option A**\n\nThe Interaction by Exchange with the Mean (IEM) model is described by the Ordinary Differential Equation (ODE) for a particle $p$:\n$$ \\frac{d\\boldsymbol{Y}_p}{dt} = -\\frac{1}{\\tau_{\\mathrm{mix}}} (\\boldsymbol{Y}_p - \\langle \\boldsymbol{Y} \\rangle) $$\nwhere $\\boldsymbol{Y}_p$ is the composition vector of the particle, $\\langle \\boldsymbol{Y} \\rangle$ is a mean composition, and $\\tau_{\\mathrm{mix}}$ is the mixing timescale.\n\nUsing an explicit Euler scheme with time step $\\Delta t$, the update from the old state $\\boldsymbol{Y}_p^{\\text{old}}$ to the new state $\\boldsymbol{Y}_p^{\\text{new}}$ is:\n$$ \\boldsymbol{Y}_p^{\\text{new}} = \\boldsymbol{Y}_p^{\\text{old}} - \\frac{\\Delta t}{\\tau_{\\mathrm{mix}}} (\\boldsymbol{Y}_p^{\\text{old}} - \\langle \\boldsymbol{Y} \\rangle) $$\nLet $\\alpha = \\Delta t / \\tau_{\\mathrm{mix}}$. We can rearrange the equation as:\n$$ \\boldsymbol{Y}_p^{\\text{new}} = (1 - \\alpha) \\boldsymbol{Y}_p^{\\text{old}} + \\alpha \\langle \\boldsymbol{Y} \\rangle $$\nThis shows that the new state $\\boldsymbol{Y}_p^{\\text{new}}$ is a linear combination of the particle's old state $\\boldsymbol{Y}_p^{\\text{old}}$ and the mean state $\\langle \\boldsymbol{Y} \\rangle$. The statement provides two conditions:\n1. $0 \\le \\alpha \\le 1$. This implies that the weights $(1-\\alpha)$ and $\\alpha$ are both non-negative.\n2. The sum of the weights is $(1 - \\alpha) + \\alpha = 1$.\nTherefore, the update is a convex combination.\n\nThe statement also specifies that $\\boldsymbol{Y}_p^{\\text{old}}$ is a valid state (i.e., $\\boldsymbol{Y}_p^{\\text{old}} \\in \\mathcal{S}$) and $\\langle \\boldsymbol{Y} \\rangle$ is a convex combination of valid particle states. Since the Gibbs simplex $\\mathcal{S}$ is a convex set, any convex combination of points within it\n(like $\\langle \\boldsymbol{Y} \\rangle$) also lies within it. Thus, both $\\boldsymbol{Y}_p^{\\text{old}}$ and $\\langle \\boldsymbol{Y} \\rangle$ are in $\\mathcal{S}$.\n\nBecause $\\boldsymbol{Y}_p^{\\text{new}}$ is a convex combination of two points in the convex set $\\mathcal{S}$, $\\boldsymbol{Y}_p^{\\text{new}}$ must also lie in $\\mathcal{S}$. This means for each species $k$, $0 \\le Y_{p,k}^{\\text{new}} \\le 1$, and $\\sum_k Y_{p,k}^{\\text{new}} = 1$. The constraints are preserved.\n\nVerdict: **Correct**.\n\n**Analysis of Option B**\n\nThis option considers the exact analytical solution to the IEM ODE, assuming the mean composition $\\langle \\boldsymbol{Y} \\rangle$ is constant over the time step $\\Delta t$. The ODE is a first-order linear system. Its solution is:\n$$ \\boldsymbol{Y}_p(t_0+\\Delta t) = \\langle \\boldsymbol{Y} \\rangle + (\\boldsymbol{Y}_p(t_0) - \\langle \\boldsymbol{Y} \\rangle) e^{-\\Delta t / \\tau_{\\mathrm{mix}}} $$\nLetting $\\boldsymbol{Y}_p^{\\text{new}} = \\boldsymbol{Y}_p(t_0+\\Delta t)$ and $\\boldsymbol{Y}_p^{\\text{old}} = \\boldsymbol{Y}_p(t_0)$, we can rearrange this as:\n$$ \\boldsymbol{Y}_p^{\\text{new}} = (1 - e^{-\\Delta t / \\tau_{\\mathrm{mix}}}) \\langle \\boldsymbol{Y} \\rangle + (e^{-\\Delta t / \\tau_{\\mathrm{mix}}}) \\boldsymbol{Y}_p^{\\text{old}} $$\nThis expresses the new state as a linear combination of $\\langle \\boldsymbol{Y} \\rangle$ and $\\boldsymbol{Y}_p^{\\text{old}}$. Let's examine the weights for any $\\Delta t \\ge 0$ (and $\\tau_{\\mathrm{mix}}  0$):\n- The weight for $\\boldsymbol{Y}_p^{\\text{old}}$ is $w_1 = e^{-\\Delta t / \\tau_{\\mathrm{mix}}}$. Since the exponent is non-positive, $0  w_1 \\le 1$.\n- The weight for $\\langle \\boldsymbol{Y} \\rangle$ is $w_2 = 1 - e^{-\\Delta t / \\tau_{\\mathrm{mix}}}$. Since $0  e^{-\\Delta t / \\tau_{\\mathrm{mix}}} \\le 1$, we have $0 \\le w_2  1$.\n- The sum of the weights is $w_1 + w_2 = e^{-\\Delta t / \\tau_{\\mathrm{mix}}} + 1 - e^{-\\Delta t / \\tau_{\\mathrm{mix}}} = 1$.\n\nSince the weights are non-negative and sum to one, the update is a convex combination for any physical time step $\\Delta t \\ge 0$. As established in the analysis of option A, a convex combination of valid states (which $\\boldsymbol{Y}_p^{\\text{old}}$ and $\\langle \\boldsymbol{Y} \\rangle$ are assumed to be) produces a valid state. No time step restriction is required for the analytical solution to preserve the bounds, unlike the explicit Euler scheme.\n\nVerdict: **Correct**.\n\n**Analysis of Option C**\n\nThe EMST model performs pairwise exchanges. The statement suggests using a mixing coefficient $\\beta_{ij}  1$. The update for particle $i$ would be $\\boldsymbol{Y}_i^{\\text{new}} = (1-\\beta_{ij})\\boldsymbol{Y}_i^{\\text{old}} + \\beta_{ij}\\boldsymbol{Y}_j^{\\text{old}}$. If $\\beta_{ij}  1$, the coefficient $(1-\\beta_{ij})$ is negative. This is not a convex combination but an extrapolation. Extrapolating from two points inside a convex set can easily lead to a point outside the set.\n\nFor example, consider a single species $k$ where $Y_{i,k}^{\\text{old}} = 0.8$ and $Y_{j,k}^{\\text{old}} = 0.1$. Let $\\beta_{ij} = 1.2$.\n$$ Y_{i,k}^{\\text{new}} = (1 - 1.2) Y_{i,k}^{\\text{old}} + 1.2 Y_{j,k}^{\\text{old}} = -0.2 \\times 0.8 + 1.2 \\times 0.1 = -0.16 + 0.12 = -0.04 $$\nThis clearly violates positivity ($Y_{i,k}^{\\text{new}}  0$). The claim that \"pairwise exchanges still average two states\" is false for $\\beta_{ij}1$. The proposal to \"cure\" this by \"clipping negative values\" is an ad-hoc, non-conservative modification. It is not an inherent property of the model. Such clipping would violate mass conservation for the pair of particles, a fundamental requirement of a mixing model. A physically sound mixing model must be bound-preserving by its formulation.\n\nVerdict: **Incorrect**.\n\n**Analysis of Option D**\n\nThe full transport equation for an Eulerian stochastic field $\\phi_k$ (representing $Y_k$) involves advection, diffusion, a micro-mixing source term, and a chemical source term. The statement claims that treating the IEM source term implicitly guarantees positivity, regardless of the other terms.\nAn implicit discretization of the full equation at a grid point $j$ would have a general form:\n$$ A(\\boldsymbol{\\phi}^{n+1}) = B(\\boldsymbol{\\phi}^n) $$\nwhere $A$ and $B$ are operators representing the discretization of all terms. Positivity requires that if all components of $\\boldsymbol{\\phi}^n$ are non-negative, then all components of $\\boldsymbol{\\phi}^{n+1}$ must also be non-negative.\nThis property depends on the structure of the entire discretized system, not just one term. For example, if the advection term is discretized using a standard central-difference scheme, it is not monotone and can produce non-physical oscillations (undershoots), leading to negative values, regardless of how other terms are treated. Similarly, an explicit treatment of a fast, destructive chemical reaction can easily violate positivity if the time step condition is not met. While an implicit treatment of the IEM term is numerically stable and a good practice, it cannot by itself guarantee positivity for the entire system if other terms are discretized in a non-positivity-preserving manner.\n\nVerdict: **Incorrect**.\n\n**Analysis of Option E**\n\nNumerical errors (e.g., from round-off or non-monotone discretization schemes) can lead to a computed state $\\boldsymbol{Y}$ that slightly violates physical constraints, such as having small negative components. The statement proposes correcting this by projecting $\\boldsymbol{Y}$ onto the Gibbs simplex $\\mathcal{S}$. This is formulated as a constrained optimization problem:\n$$ \\min_{\\boldsymbol{y} \\in \\mathcal{S}} \\|\\boldsymbol{y} - \\boldsymbol{Y}\\|_2 $$\nwhere $\\mathcal{S} = \\{\\boldsymbol{y} \\in \\mathbb{R}^{N_s}: y_k \\ge 0, \\ \\sum_k y_k = 1\\}$. The Gibbs simplex $\\mathcal{S}$ is a closed convex set. Projecting a point onto a closed convex set is a well-posed problem that has a unique solution. This solution, $\\boldsymbol{y}^*$, is the point in $\\mathcal{S}$ that is closest to the unphysical state $\\boldsymbol{Y}$ in the Euclidean distance sense. This approach has a clear mathematical basis, in contrast to ad-hoc methods like simple clipping (which violates the sum-to-one constraint) or clipping followed by arbitrary rescaling. It is a standard and \"principled\" technique used in many algorithms that need to enforce such constraints, providing a correction that minimally perturbs the state in the L2-norm sense.\n\nVerdict: **Correct**.\n\n**Analysis of Option F**\n\nThe EMST update rule with $0 \\le \\beta_{ij} \\le 1$ is given as:\n$$ Y_{i,k}^{\\text{new}} = (1 - \\beta_{ij}) Y_{i,k}^{\\text{old}} + \\beta_{ij} Y_{j,k}^{\\text{old}} $$\nAs analyzed for option A, if $0 \\le \\beta_{ij} \\le 1$, the weights $(1-\\beta_{ij})$ and $\\beta_{ij}$ are non-negative and sum to one. This means the update is a convex combination. If the old states for particles $i$ and $j$ ($\\boldsymbol{Y}_{i}^{\\text{old}}$ and $\\boldsymbol{Y}_{j}^{\\text{old}}$) are valid (i.e., they are in the Gibbs simplex $\\mathcal{S}$), then their convex combination $\\boldsymbol{Y}_{i}^{\\text{new}}$ must also be in $\\mathcal{S}$. This automatically preserves positivity ($Y_{i,k}^{\\text{new}} \\ge 0$), boundedness ($Y_{i,k}^{\\text{new}} \\le 1$), and the sum-to-one constraint ($\\sum_k Y_{i,k}^{\\text{new}} = 1$). The statement's claim that positivity can still be violated and that rescaling is necessary is therefore false. The model is inherently bound-preserving under this condition.\n\nVerdict: **Incorrect**.\n\n**Analysis of Option G**\n\nThis option considers an Eulerian stochastic field where micro-mixing is modeled as a diffusion-like operator, e.g., $\\frac{\\partial \\phi}{\\partial t} = \\nabla \\cdot (D_{\\text{mix}} \\nabla \\phi)$. For a finite-volume discretization with an explicit time-stepping scheme, the updated value at cell $i$, $\\phi_i^{n+1}$, can be written as a linear combination of its own old value and the old values of its neighbors: $\\phi_i^{n+1} = c_i \\phi_i^n + \\sum_{j \\in \\text{neighbors}} c_j \\phi_j^n$.\nFor the scheme to be positivity-preserving (and monotone), all coefficients $c_i, c_j$ must be non-negative. For the standard explicit central-difference scheme for diffusion in 1D, the update is $\\phi_i^{n+1} = (1-2\\mu)\\phi_i^n + \\mu(\\phi_{i-1}^n + \\phi_{i+1}^n)$, where $\\mu = \\frac{D_{\\text{mix}}\\Delta t}{\\Delta x^2}$. The coefficients for the neighbors are positive ($\\mu  0$), but the coefficient for $\\phi_i^n$ is $(1-2\\mu)$. For this to be non-negative, we require $1-2\\mu \\ge 0$, which leads to the Courant–Friedrichs–Lewy (CFL) condition: $\\frac{D_{\\text{mix}}\\Delta t}{\\Delta x^2} \\le \\frac{1}{2}$.\nIf this CFL-type restriction is not satisfied, the coefficient becomes negative, the scheme is no longer monotone, and a large central value $\\phi_i^n$ and small neighbor values can lead to a negative $\\phi_i^{n+1}$. The statement correctly identifies that a monotone discretization (which implies non-negative coefficients) and an associated CFL-type time step restriction are necessary to guarantee positivity for such explicit schemes.\n\nVerdict: **Correct**.",
            "answer": "$$\\boxed{ABEG}$$"
        }
    ]
}