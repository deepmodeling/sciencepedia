{
    "hands_on_practices": [
        {
            "introduction": "To effectively model the mixture fraction $Z$, we must first grasp its physical meaning. This practice connects the abstract scalar $Z$ to the core concept of stoichiometry by deriving an expression for the stoichiometric mixture fraction, $Z_{st}$ . By completing this fundamental derivation, you will solidify your understanding of how $Z$ serves as a conserved scalar that maps the elemental composition of a non-premixed system.",
            "id": "4009873",
            "problem": "Consider a canonical nonpremixed combustion configuration involving two counterflowing streams used in presumed Beta Probability Density Function (PDF) modeling of the mixture fraction. Stream $1$ is the fuel-side stream and stream $2$ is the oxidizer-side stream. Let the mixture fraction $Z$ be defined as the mass fraction of material in the local mixture originating from stream $1$, so the elemental mass fractions in the mixture satisfy $W_{E}(Z)=Z\\,W_{E}^{(1)}+(1-Z)\\,W_{E}^{(2)}$ for each element $E\\in\\{C,H,O\\}$ under the usual assumption of equal diffusivities and non-reactive mixing up to the stoichiometric surface. Assume complete oxidation of fuel-bound carbon and hydrogen to carbon dioxide and water, and neglect the participation of nitrogen and minor species in the stoichiometric balance. Denote the atomic masses of carbon, hydrogen, and oxygen by $M_{C}$, $M_{H}$, and $M_{O}$, respectively.\n\nStarting from elemental conservation and the requirement that, at stoichiometry, the oxygen present in the mixed reactants exactly equals the oxygen needed to convert all carbon and hydrogen to fully oxidized products, derive a closed-form analytic expression for the stoichiometric mixture fraction $Z_{st}$ in terms of the elemental mass fractions $W_{C}^{(i)}$, $W_{H}^{(i)}$, and $W_{O}^{(i)}$ of streams $i=1,2$ and the atomic masses $M_{C}$, $M_{H}$, and $M_{O}$. Your final expression must be a single closed-form formula. Express the answer without numerical evaluation and without units.",
            "solution": "The problem requires the derivation of a closed-form expression for the stoichiometric mixture fraction, $Z_{st}$, based on elemental conservation principles. The problem is scientifically grounded, well-posed, and contains all necessary information for its resolution. We will proceed with the derivation.\n\nThe mixture fraction, $Z$, is defined as the mass fraction of material originating from the fuel stream (stream $1$). The elemental mass fraction $W_E$ of any element $E$ in the mixture is given by a linear combination of its mass fractions in the fuel stream, $W_E^{(1)}$, and the oxidizer stream, $W_E^{(2)}$:\n$$W_{E}(Z) = Z W_{E}^{(1)} + (1-Z) W_{E}^{(2)}$$\nThe elements considered are carbon ($C$), hydrogen ($H$), and oxygen ($O$).\n\nThe stoichiometric condition is defined as the state where the amount of oxygen present in the reactants is exactly what is required to completely oxidize all carbon to carbon dioxide ($CO_2$) and all hydrogen to water ($H_2O$). Let us express this condition mathematically.\n\nFirst, we determine the mass of oxygen required per unit mass of each fuel element.\n1.  For carbon ($C$): The complete oxidation reaction is $C + O_2 \\rightarrow CO_2$. On an atomic mass basis, one atom of carbon with mass $M_C$ reacts with two atoms of oxygen with total mass $2 M_O$. Therefore, the mass of oxygen required per unit mass of carbon is the ratio $\\frac{2 M_O}{M_C}$.\n\n2.  For hydrogen ($H$): The complete oxidation reaction is $2H + \\frac{1}{2}O_2 \\rightarrow H_2O$, which is equivalent to $4H + O_2 \\rightarrow 2H_2O$. On an atomic basis, two atoms of hydrogen with total mass $2 M_H$ react with one atom of oxygen with mass $M_O$. Thus, the mass of oxygen required per unit mass of hydrogen is the ratio $\\frac{M_O}{2 M_H}$.\n\nNow, consider a unit mass of the mixture at the stoichiometric condition, where the mixture fraction is $Z_{st}$. The mass fractions of carbon and hydrogen in this unit mass are $W_C(Z_{st})$ and $W_H(Z_{st})$, respectively. The total mass of oxygen required for complete combustion of the fuel elements within this unit mass of mixture is:\n$$m_{O, \\text{required}} = W_C(Z_{st}) \\left( \\frac{2 M_O}{M_C} \\right) + W_H(Z_{st}) \\left( \\frac{M_O}{2 M_H} \\right)$$\nThe mass of oxygen available in the reactants within the same unit mass of mixture is simply the elemental mass fraction of oxygen, $W_O(Z_{st})$:\n$$m_{O, \\text{available}} = W_O(Z_{st})$$\nAt stoichiometry, by definition, the available oxygen equals the required oxygen:\n$$m_{O, \\text{available}} = m_{O, \\text{required}}$$\n$$W_O(Z_{st}) = W_C(Z_{st}) \\left( \\frac{2 M_O}{M_C} \\right) + W_H(Z_{st}) \\left( \\frac{M_O}{2 M_H} \\right)$$\nThis equation can be rearranged to define the stoichiometric surface as the locus where a specific linear combination of elemental mass fractions is zero:\n$$W_C(Z_{st}) \\left( \\frac{2 M_O}{M_C} \\right) + W_H(Z_{st}) \\left( \\frac{M_O}{2 M_H} \\right) - W_O(Z_{st}) = 0$$\n\nNext, we substitute the definition of the elemental mass fractions in terms of $Z_{st}$ into this stoichiometric condition:\n$$\\left[ Z_{st}W_C^{(1)} + (1-Z_{st})W_C^{(2)} \\right] \\left( \\frac{2 M_O}{M_C} \\right) + \\left[ Z_{st}W_H^{(1)} + (1-Z_{st})W_H^{(2)} \\right] \\left( \\frac{M_O}{2 M_H} \\right) - \\left[ Z_{st}W_O^{(1)} + (1-Z_{st})W_O^{(2)} \\right] = 0$$\nTo solve for $Z_{st}$, we can group the terms associated with $Z_{st}$ and $(1-Z_{st})$:\n$$Z_{st} \\left[ W_C^{(1)} \\left( \\frac{2 M_O}{M_C} \\right) + W_H^{(1)} \\left( \\frac{M_O}{2 M_H} \\right) - W_O^{(1)} \\right] + (1-Z_{st}) \\left[ W_C^{(2)} \\left( \\frac{2 M_O}{M_C} \\right) + W_H^{(2)} \\left( \\frac{M_O}{2 M_H} \\right) - W_O^{(2)} \\right] = 0$$\nLet us define an auxiliary variable $\\Phi_i$ for each stream $i \\in \\{1, 2\\}$, which represents the stoichiometric oxygen demand (or surplus if negative) of that stream:\n$$\\Phi_i = W_C^{(i)} \\left( \\frac{2 M_O}{M_C} \\right) + W_H^{(i)} \\left( \\frac{M_O}{2 M_H} \\right) - W_O^{(i)}$$\nWith this definition, the stoichiometric condition simplifies to:\n$$Z_{st} \\Phi_1 + (1-Z_{st}) \\Phi_2 = 0$$\nThis is a linear equation in $Z_{st}$, which we can now solve:\n$$Z_{st} \\Phi_1 + \\Phi_2 - Z_{st} \\Phi_2 = 0$$\n$$Z_{st} (\\Phi_1 - \\Phi_2) = -\\Phi_2$$\n$$Z_{st} = \\frac{-\\Phi_2}{\\Phi_1 - \\Phi_2}$$\nFinally, we substitute the expressions for $\\Phi_1$ and $\\Phi_2$ back into this result to obtain the final closed-form expression for $Z_{st}$.\nThe numerator is:\n$$-\\Phi_2 = -\\left[ W_C^{(2)} \\left( \\frac{2 M_O}{M_C} \\right) + W_H^{(2)} \\left( \\frac{M_O}{2 M_H} \\right) - W_O^{(2)} \\right] = W_O^{(2)} - W_C^{(2)} \\left( \\frac{2 M_O}{M_C} \\right) - W_H^{(2)} \\left( \\frac{M_O}{2 M_H} \\right)$$\nThe denominator is:\n$$\\Phi_1 - \\Phi_2 = \\left[ W_C^{(1)} \\left( \\frac{2 M_O}{M_C} \\right) + W_H^{(1)} \\left( \\frac{M_O}{2 M_H} \\right) - W_O^{(1)} \\right] - \\left[ W_C^{(2)} \\left( \\frac{2 M_O}{M_C} \\right) + W_H^{(2)} \\left( \\frac{M_O}{2 M_H} \\right) - W_O^{(2)} \\right]$$\n$$= \\left( W_C^{(1)} - W_C^{(2)} \\right) \\left( \\frac{2 M_O}{M_C} \\right) + \\left( W_H^{(1)} - W_H^{(2)} \\right) \\left( \\frac{M_O}{2 M_H} \\right) - \\left( W_O^{(1)} - W_O^{(2)} \\right)$$\nCombining these gives the complete expression for the stoichiometric mixture fraction.",
            "answer": "$$\n\\boxed{\nZ_{st} = \\frac{W_O^{(2)} - W_C^{(2)} \\left( \\frac{2 M_O}{M_C} \\right) - W_H^{(2)} \\left( \\frac{M_O}{2 M_H} \\right)}{\\left( W_C^{(1)} - W_C^{(2)} \\right) \\left( \\frac{2 M_O}{M_C} \\right) + \\left( W_H^{(1)} - W_H^{(2)} \\right) \\left( \\frac{M_O}{2 M_H} \\right) - \\left( W_O^{(1)} - W_O^{(2)} \\right)}\n}\n$$"
        },
        {
            "introduction": "The central challenge in modeling turbulent combustion is averaging highly nonlinear chemical source terms. This exercise tackles the heart of this \"closure problem\" by using the Beta-PDF framework to compute the mean of an Arrhenius-type function . You will employ a small-variance approximation, a powerful analytical tool, to understand how turbulent fluctuations, represented by the variance $\\widetilde{Z''^2}$, impact the mean chemical activity.",
            "id": "4009901",
            "problem": "Consider a statistically stationary, incompressible, nonpremixed reacting flow in which the conserved scalar mixture fraction $Z \\in [0,1]$ is modeled by a Beta probability density function (PDF). Let the mean and variance of $Z$ be $\\tilde{Z}$ and $\\widetilde{Z''^2}$, respectively, and assume these moments are known from a transport calculation. In turbulent combustion modeling, chemistry often enters through an Arrhenius factor that depends on temperature. Suppose the local temperature is well approximated by an affine function of the mixture fraction,\n$$\nT(Z) = T_{u} + \\Delta T\\, Z,\n$$\nwhere $T_{u}$ is the unmixed stream temperature and $\\Delta T$ is a mixing-induced temperature increment. Consider the nonlinear function\n$$\nf(Z) = \\exp\\!\\left(-\\frac{E}{R\\,T(Z)}\\right),\n$$\nwhere $E$ is an activation energy and $R$ is the universal gas constant. The Favre-averaged evaluation of this chemical factor under the presumed-PDF approach is\n$$\n\\tilde{f(Z)} = \\int_{0}^{1} f(Z)\\,p(Z)\\,\\mathrm{d}Z,\n$$\nwhere $p(Z)$ is a Beta PDF on $[0,1]$ constrained by the given mean and variance of $Z$.\n\nUsing first principles, derive a small-variance asymptotic approximation for $\\tilde{f(Z)}$ that is consistent with a Beta PDF constrained by $\\tilde{Z}$ and $\\widetilde{Z''^2}$, retaining terms up to $\\mathcal{O}\\!\\left(\\widetilde{Z''^2}\\right)$ in the expansion. From this derivation, obtain the leading-order sensitivity of $\\tilde{f(Z)}$ to changes in the variance, defined as\n$$\nS \\equiv \\frac{\\partial \\tilde{f(Z)}}{\\partial \\widetilde{Z''^2}}\\Bigg|_{\\text{leading order}}.\n$$\n\nThen, evaluate numerically the approximation and the sensitivity for the following physically consistent parameter set:\n- $E = 1.20 \\times 10^{5}\\,\\mathrm{J/mol}$,\n- $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$,\n- $T_{u} = 1100\\,\\mathrm{K}$,\n- $\\Delta T = 600\\,\\mathrm{K}$,\n- $\\tilde{Z} = 0.30$,\n- $\\widetilde{Z''^2} = 0.010$.\n\nExpress the final numerical results as two dimensionless quantities $(\\tilde{f(Z)}, S)$ and round both to four significant figures. Provide the final answer as a single row vector using the LaTeX $\\mathrm{pmatrix}$ environment, as specified.",
            "solution": "The problem requires the derivation of a small-variance asymptotic approximation for the Favre-averaged chemical factor $\\tilde{f(Z)}$ and its sensitivity to the mixture fraction variance. The derivation proceeds by a Taylor series expansion of the nonlinear function $f(Z)$ around the mean mixture fraction $\\tilde{Z}$. The moments of the mixture fraction, specifically the mean $\\tilde{Z}$ and variance $\\widetilde{Z''^2}$, are presumed known. The probability density function $p(Z)$ is a Beta PDF, which is consistent with the given moments provided that the variance is sufficiently small, i.e., $\\widetilde{Z''^2}  \\tilde{Z}(1-\\tilde{Z})$. The analysis does not require the explicit form of the Beta PDF, as the expansion is truncated at an order that depends only on the first two moments.\n\nLet the function be $f(Z)$. We expand $f(Z)$ in a Taylor series about the mean mixture fraction $Z=\\tilde{Z}$:\n$$\nf(Z) = f(\\tilde{Z}) + (Z-\\tilde{Z})f'(\\tilde{Z}) + \\frac{1}{2}(Z-\\tilde{Z})^2 f''(\\tilde{Z}) + \\mathcal{O}((Z-\\tilde{Z})^3)\n$$\nwhere primes denote differentiation with respect to $Z$. The Favre-averaged value, $\\tilde{f(Z)}$, is the expectation of $f(Z)$ with respect to the PDF $p(Z)$:\n$$\n\\tilde{f(Z)} = \\int_{0}^{1} f(Z) p(Z) \\,\\mathrm{d}Z\n$$\nSubstituting the Taylor series into the integral and integrating term by term, we obtain:\n$$\n\\tilde{f(Z)} = \\int_{0}^{1} \\left[ f(\\tilde{Z}) + (Z-\\tilde{Z})f'(\\tilde{Z}) + \\frac{1}{2}(Z-\\tilde{Z})^2 f''(\\tilde{Z}) + \\dots \\right] p(Z) \\,\\mathrm{d}Z\n$$\nUsing the definitions of the mean $\\tilde{Z} = \\int_{0}^{1} Z p(Z) \\,\\mathrm{d}Z$ and variance $\\widetilde{Z''^2} = \\int_{0}^{1} (Z-\\tilde{Z})^2 p(Z) \\,\\mathrm{d}Z$, the integral simplifies. The integral of the first term is $f(\\tilde{Z})\\int_{0}^{1}p(Z)\\,\\mathrm{d}Z = f(\\tilde{Z})$. The integral of the second term is $f'(\\tilde{Z})\\int_{0}^{1}(Z-\\tilde{Z})p(Z)\\,\\mathrm{d}Z = f'(\\tilde{Z})(\\tilde{Z}-\\tilde{Z})=0$. The integral of the third term is $\\frac{1}{2}f''(\\tilde{Z})\\int_{0}^{1}(Z-\\tilde{Z})^2 p(Z)\\,\\mathrm{d}Z = \\frac{1}{2}f''(\\tilde{Z})\\widetilde{Z''^2}$.\n\nTruncating the series at this order provides the desired small-variance approximation, valid up to $\\mathcal{O}(\\widetilde{Z''^2})$:\n$$\n\\tilde{f(Z)} \\approx f(\\tilde{Z}) + \\frac{1}{2}\\widetilde{Z''^2} f''(\\tilde{Z})\n$$\nTo proceed, we must calculate the first and second derivatives of the function $f(Z) = \\exp\\left(-\\frac{E}{R\\,T(Z)}\\right)$ with $T(Z) = T_{u} + \\Delta T\\, Z$. Let $g(Z) = -\\frac{E}{R\\,T(Z)}$. Then $f(Z)=\\exp(g(Z))$.\n\nThe first derivative is found using the chain rule:\n$$\nf'(Z) = \\frac{\\mathrm{d}f}{\\mathrm{d}Z} = \\exp(g(Z)) g'(Z) = f(Z) g'(Z)\n$$\nwhere\n$$\ng'(Z) = \\frac{\\mathrm{d}}{\\mathrm{d}Z}\\left(-\\frac{E}{R(T_u + \\Delta T Z)}\\right) = - \\frac{E}{R} \\left( -(T_u + \\Delta T Z)^{-2} \\cdot \\Delta T \\right) = \\frac{E \\Delta T}{R(T_u + \\Delta T Z)^2} = \\frac{E \\Delta T}{R T(Z)^2}\n$$\nSo,\n$$\nf'(Z) = f(Z) \\frac{E \\Delta T}{R T(Z)^2}\n$$\nThe second derivative is found using the product rule on $f'(Z) = f(Z) g'(Z)$:\n$$\nf''(Z) = f'(Z)g'(Z) + f(Z)g''(Z) = \\left(f(Z)g'(Z)\\right)g'(Z) + f(Z)g''(Z) = f(Z)\\left[(g'(Z))^2 + g''(Z)\\right]\n$$\nWe need $g''(Z)$:\n$$\ng''(Z) = \\frac{\\mathrm{d}}{\\mathrm{d}Z}\\left(\\frac{E \\Delta T}{R} (T_u + \\Delta T Z)^{-2}\\right) = \\frac{E \\Delta T}{R} \\left( -2(T_u + \\Delta T Z)^{-3} \\cdot \\Delta T \\right) = -\\frac{2E(\\Delta T)^2}{R(T_u + \\Delta T Z)^3} = -\\frac{2E(\\Delta T)^2}{R T(Z)^3}\n$$\nSubstituting $g'(Z)$ and $g''(Z)$ into the expression for $f''(Z)$:\n$$\nf''(Z) = f(Z) \\left[ \\left(\\frac{E \\Delta T}{R T(Z)^2}\\right)^2 - \\frac{2E(\\Delta T)^2}{R T(Z)^3} \\right] = f(Z) \\frac{E(\\Delta T)^2}{R T(Z)^3} \\left[ \\frac{E}{R T(Z)} - 2 \\right]\n$$\nEvaluating the second derivative at the mean mixture fraction $Z = \\tilde{Z}$, we define $\\tilde{T} = T(\\tilde{Z}) = T_u + \\Delta T \\tilde{Z}$ and find:\n$$\nf''(\\tilde{Z}) = f(\\tilde{Z}) \\frac{E(\\Delta T)^2}{R \\tilde{T}^3} \\left[ \\frac{E}{R \\tilde{T}} - 2 \\right]\n$$\nSubstituting this into the approximation for $\\tilde{f(Z)}$:\n$$\n\\tilde{f(Z)} \\approx f(\\tilde{Z}) \\left[ 1 + \\frac{1}{2} \\widetilde{Z''^2} \\frac{E(\\Delta T)^2}{R \\tilde{T}^3} \\left( \\frac{E}{R \\tilde{T}} - 2 \\right) \\right]\n$$\nThe leading-order sensitivity of $\\tilde{f(Z)}$ to changes in the variance $\\widetilde{Z''^2}$ is defined as $S \\equiv \\frac{\\partial \\tilde{f(Z)}}{\\partial \\widetilde{Z''^2}}\\Big|_{\\text{leading order}}$. Differentiating our approximation for $\\tilde{f(Z)}$ with respect to $\\widetilde{Z''^2}$ (noting that $f(\\tilde{Z})$ and $f''(\\tilde{Z})$ are independent of $\\widetilde{Z''^2}$) gives:\n$$\nS = \\frac{1}{2} f''(\\tilde{Z}) = \\frac{1}{2} f(\\tilde{Z}) \\frac{E(\\Delta T)^2}{R \\tilde{T}^3} \\left( \\frac{E}{R \\tilde{T}} - 2 \\right)\n$$\nNow we evaluate these expressions numerically with the given parameters:\n- $E = 1.20 \\times 10^{5}\\,\\mathrm{J/mol}$\n- $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$\n- $T_{u} = 1100\\,\\mathrm{K}$\n- $\\Delta T = 600\\,\\mathrm{K}$\n- $\\tilde{Z} = 0.30$\n- $\\widetilde{Z''^2} = 0.010$\n\nFirst, calculate the temperature at the mean mixture fraction:\n$$\n\\tilde{T} = T(\\tilde{Z}) = 1100\\,\\mathrm{K} + (600\\,\\mathrm{K})(0.30) = 1100\\,\\mathrm{K} + 180\\,\\mathrm{K} = 1280\\,\\mathrm{K}\n$$\nNext, we compute the dimensionless activation energy, also known as the Zel'dovich number:\n$$\n\\beta \\equiv \\frac{E}{R\\tilde{T}} = \\frac{1.20 \\times 10^5\\,\\mathrm{J/mol}}{(8.314\\,\\mathrm{J/(mol\\cdot K)})(1280\\,\\mathrm{K})} \\approx 11.27607\n$$\nThe chemical factor evaluated at the mean is:\n$$\nf(\\tilde{Z}) = \\exp(-\\beta) \\approx \\exp(-11.27607) \\approx 1.26733 \\times 10^{-5}\n$$\nNow, we calculate the sensitivity $S$:\n$$\nS = \\frac{1}{2} f(\\tilde{Z}) \\frac{\\beta R \\tilde{T} (\\Delta T)^2}{R \\tilde{T}^3} (\\beta - 2) = \\frac{1}{2} f(\\tilde{Z}) \\frac{\\beta (\\Delta T)^2}{\\tilde{T}^2} (\\beta - 2)\n$$\n$$\nS \\approx \\frac{1}{2} (1.26733 \\times 10^{-5}) \\frac{(11.27607)(600\\,\\mathrm{K})^2}{(1280\\,\\mathrm{K})^2} (11.27607 - 2)\n$$\n$$\nS \\approx \\frac{1}{2} (1.26733 \\times 10^{-5}) \\frac{(11.27607)(360000)}{1638400} (9.27607)\n$$\n$$\nS \\approx \\frac{1}{2} (1.26733 \\times 10^{-5}) (2.47764) (9.27607) \\approx 1.45521 \\times 10^{-4}\n$$\nFinally, we compute the approximation for $\\tilde{f(Z)}$:\n$$\n\\tilde{f(Z)} \\approx f(\\tilde{Z}) + \\widetilde{Z''^2} S\n$$\n$$\n\\tilde{f(Z)} \\approx 1.26733 \\times 10^{-5} + (0.010)(1.45521 \\times 10^{-4})\n$$\n$$\n\\tilde{f(Z)} \\approx 1.26733 \\times 10^{-5} + 1.45521 \\times 10^{-6} \\approx 1.41285 \\times 10^{-5}\n$$\nRounding the results to four significant figures:\n- $\\tilde{f(Z)} \\approx 1.413 \\times 10^{-5}$\n- $S \\approx 1.455 \\times 10^{-4}$\n\nThe final result is the pair $(\\tilde{f(Z)}, S)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.413 \\times 10^{-5}  1.455 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In practice, evaluating the mean of thermochemical properties requires numerical integration against the Beta-PDF. This hands-on coding exercise guides you through the design of a highly efficient numerical quadrature scheme tailored for this exact task . By deriving and implementing a Gauss-Jacobi quadrature, you will learn how to handle the specific form of the Beta-PDF, including potential endpoint singularities, to achieve rapid and accurate results.",
            "id": "4009851",
            "problem": "Consider a conserved scalar mixture fraction $Z$ supported on the interval $[0,1]$ whose statistical variability in turbulent reacting flows is modeled by the Beta probability density function (PDF), with shape parameters $\\alpha \\in \\mathbb{R}_{0}$ and $\\beta \\in \\mathbb{R}_{0}$. The core numerical task in Beta-PDF modeling is the repeated evaluation of weighted integrals of the form\n$$\n\\int_{0}^{1} f(Z)\\,Z^{\\alpha-1}(1-Z)^{\\beta-1}\\,\\mathrm{d}Z,\n$$\nfor smooth functions $f$ that represent thermochemical property mappings, tabulated closures, or analytic functions. Your goal is to design a Gaussian-type quadrature scheme that exploits orthogonality under an appropriate weight to integrate the above expressions efficiently and accurately.\n\nStarting from the foundational definitions of orthogonal polynomials and Gaussian quadrature on a finite interval with a nonnegative weight function, and using only weight-preserving changes of variables and properties of polynomial exactness, derive an $n$-point quadrature tailored to the weight $w(Z)=Z^{\\alpha-1}(1-Z)^{\\beta-1}$ on $[0,1]$. Explain how the quadrature nodes and weights are determined by orthogonality, why this construction is efficient for Beta-weighted integrals, and how the interval mapping ensures numerical stability when $\\alpha$ and $\\beta$ vary over a wide range (including integrable endpoint singularities when $\\alpha1$ or $\\beta1$). Do not use or quote any pre-derived shortcut formulas in the problem statement; base your approach on first principles and well-tested facts about orthogonal polynomials.\n\nThen implement the derived scheme as a program that, for a specified test suite, computes the quadrature approximation of the integral for each case, compares it to a reference value, and returns the absolute error. For test cases where the exact integral is known by elementary properties of the Beta function $\\mathrm{B}(\\cdot,\\cdot)$, use that as the reference. Otherwise, use high-accuracy one-dimensional numerical integration to obtain a reference value on $[0,1]$ for the integrand $f(Z)\\,Z^{\\alpha-1}(1-Z)^{\\beta-1}$. When trigonometric functions appear, interpret angles in radians.\n\nImplement the following test suite, each case specified by $(\\alpha,\\beta,n,f)$, where $n$ is the quadrature order and $f$ is the integrand:\n- Case $1$: $(\\alpha,\\beta,n,f)=(2,5,3, f(Z)=1)$; reference is $\\mathrm{B}(2,5)$.\n- Case $2$: $(\\alpha,\\beta,n,f)=(0.7,1.3,2, f(Z)=Z^{3})$; reference is $\\mathrm{B}(0.7+3,1.3)$.\n- Case $3$: $(\\alpha,\\beta,n,f)=(3.5,4.0,8, f(Z)=\\exp(-7Z))$; use high-accuracy numerical integration.\n- Case $4$: $(\\alpha,\\beta,n,f)=(0.3,0.6,12, f(Z)=\\sqrt{Z})$; use high-accuracy numerical integration.\n- Case $5$: $(\\alpha,\\beta,n,f)=(50.0,50.0,16, f(Z)=\\sin(\\pi Z))$; use high-accuracy numerical integration with radian arguments.\n- Case $6$: $(\\alpha,\\beta,n,f)=(80.0,3.0,16, f(Z)=\\frac{Z^{2}}{0.1+Z})$; use high-accuracy numerical integration.\n\nYour program must produce a single line of output containing the absolute errors for the six test cases as a comma-separated list enclosed in square brackets (e.g., \"[e1,e2,e3,e4,e5,e6]\"). No physical units are involved, and all quantities are dimensionless. The program must be self-contained and must not read any input.",
            "solution": "The problem requires the derivation and implementation of a customized Gaussian quadrature scheme for integrals weighted by the Beta probability density function (PDF). The integral is of the form:\n$$\nI = \\int_{0}^{1} f(Z)\\,Z^{\\alpha-1}(1-Z)^{\\beta-1}\\,\\mathrm{d}Z\n$$\nwhere $Z^{\\alpha-1}(1-Z)^{\\beta-1}$ is the core of the Beta distribution's PDF, and $f(Z)$ is a smooth function.\n\nThe foundation of the solution lies in the theory of Gaussian quadrature. For an integral of the form $\\int_{a}^{b} g(x)w(x)\\,\\mathrm{d}x$ with a non-negative weight function $w(x)$, an $n$-point Gaussian quadrature provides an approximation:\n$$\n\\int_{a}^{b} g(x)w(x)\\,\\mathrm{d}x \\approx \\sum_{i=1}^{n} w_i g(x_i)\n$$\nThis quadrature rule is constructed to be exact for any function $g(x)$ that is a polynomial of degree up to $2n-1$. This maximal degree of exactness is achieved when the quadrature nodes $\\{x_i\\}_{i=1}^n$ are chosen as the roots of the $n$-th degree polynomial, $P_n(x)$, from a sequence of polynomials $\\{P_k(x)\\}_{k=0}^{\\infty}$ that are orthogonal with respect to the weight function $w(x)$ on the interval $[a,b]$. That is, they satisfy $\\int_{a}^{b} P_k(x)P_j(x)w(x)\\,\\mathrm{d}x = 0$ for $k \\neq j$. The weights $\\{w_i\\}_{i=1}^n$ are then uniquely determined by these nodes.\n\nIn our problem, the interval is $[0,1]$ and the weight function is $w(Z) = Z^{\\alpha-1}(1-Z)^{\\beta-1}$. The orthogonal polynomials associated with this weight function and interval are a form of shifted Jacobi polynomials. Standard Jacobi polynomials, denoted $P_n^{(a,b)}(x)$, are orthogonal on the interval $[-1,1]$ with respect to the weight function $(1-x)^a(1+x)^b$. To leverage well-established algorithms for computing the nodes and weights of Gauss-Jacobi quadrature, we perform a change of variables to map our integral from $[0,1]$ to $[-1,1]$.\n\nLet's apply the linear transformation $Z = \\frac{x+1}{2}$. This maps the interval $x \\in [-1,1]$ to $Z \\in [0,1]$. The differential element is $\\mathrm{d}Z = \\frac{1}{2}\\mathrm{d}x$. Substituting this into our integral $I$:\n$$\nI = \\int_{-1}^{1} f\\left(\\frac{x+1}{2}\\right) \\left(\\frac{x+1}{2}\\right)^{\\alpha-1} \\left(1-\\frac{x+1}{2}\\right)^{\\beta-1} \\frac{1}{2}\\,\\mathrm{d}x\n$$\nSimplifying the terms:\n$$\n1 - \\frac{x+1}{2} = \\frac{2 - (x+1)}{2} = \\frac{1-x}{2}\n$$\nThe integral becomes:\n$$\nI = \\int_{-1}^{1} f\\left(\\frac{x+1}{2}\\right) \\frac{(x+1)^{\\alpha-1}}{2^{\\alpha-1}} \\frac{(1-x)^{\\beta-1}}{2^{\\beta-1}} \\frac{1}{2}\\,\\mathrm{d}x\n$$\n$$\nI = \\frac{1}{2^{\\alpha+\\beta-1}} \\int_{-1}^{1} f\\left(\\frac{x+1}{2}\\right) (1-x)^{\\beta-1}(1+x)^{\\alpha-1}\\,\\mathrm{d}x\n$$\nThis transformed integral is now in a form suitable for standard Gauss-Jacobi quadrature on the interval $[-1,1]$. The function to be integrated is $g(x) = f\\left(\\frac{x+1}{2}\\right)$, and the weight function is $(1-x)^{\\beta-1}(1+x)^{\\alpha-1}$. This corresponds to the standard Jacobi weight $(1-x)^a(1+x)^b$ with parameters $a = \\beta-1$ and $b = \\alpha-1$.\n\nLet $\\{x_i^{\\text{GJ}}\\}_{i=1}^n$ be the nodes and $\\{w_i^{\\text{GJ}}\\}_{i=1}^n$ be the weights for the $n$-point Gauss-Jacobi quadrature with parameters $a=\\beta-1$ and $b=\\alpha-1$. The nodes $x_i^{\\text{GJ}}$ are the roots of the Jacobi polynomial $P_n^{(\\beta-1, \\alpha-1)}(x)$. The quadrature approximation for the integral over $[-1,1]$ is:\n$$\n\\int_{-1}^{1} g(x)(1-x)^{\\beta-1}(1+x)^{\\alpha-1}\\,\\mathrm{d}x \\approx \\sum_{i=1}^{n} w_i^{\\text{GJ}} g(x_i^{\\text{GJ}})\n$$\nSubstituting our function $g(x) = f\\left(\\frac{x+1}{2}\\right)$ and combining with the scaling factor, we get the approximation for our original integral $I$:\n$$\nI \\approx \\frac{1}{2^{\\alpha+\\beta-1}} \\sum_{i=1}^{n} w_i^{\\text{GJ}} f\\left(\\frac{x_i^{\\text{GJ}}+1}{2}\\right)\n$$\nThis formula provides a complete algorithm. However, it is conceptually cleaner to define a set of nodes $\\{Z_i\\}_{i=1}^n$ and weights $\\{w_i^{\\text{B}}\\}_{i=1}^n$ directly for the target interval $[0,1]$ and Beta-PDF weight. The nodes are simply the mapped Jacobi nodes:\n$$\nZ_i = \\frac{x_i^{\\text{GJ}}+1}{2}\n$$\nThe corresponding weights for the $[0,1]$ integration are the scaled Jacobi weights:\n$$\nw_i^{\\text{B}} = \\frac{w_i^{\\text{GJ}}}{2^{\\alpha+\\beta-1}}\n$$\nThis scaling ensures correctness. For example, for $f(Z)=1$, the integral is $\\mathrm{B}(\\alpha,\\beta)$. The sum of the standard Jacobi weights is $\\sum w_i^{\\text{GJ}} = \\int_{-1}^1 (1-x)^{\\beta-1}(1+x)^{\\alpha-1}\\,\\mathrm{d}x = 2^{\\alpha+\\beta-1}\\mathrm{B}(\\alpha,\\beta)$. Our quadrature gives $\\sum w_i^{\\text{B}} \\cdot 1 = \\frac{1}{2^{\\alpha+\\beta-1}}\\sum w_i^{\\text{GJ}} = \\mathrm{B}(\\alpha,\\beta)$, which is exact as required.\n\nThe resulting quadrature rule for the Beta-PDF weighted integral is:\n$$\n\\int_{0}^{1} f(Z)\\,Z^{\\alpha-1}(1-Z)^{\\beta-1}\\,\\mathrm{d}Z \\approx \\sum_{i=1}^{n} w_i^{\\text{B}} f(Z_i)\n$$\n\nThis construction is efficient because it leverages the high-degree polynomial exactness of Gaussian quadrature. The function $f(Z)$ in combustion models is typically smooth and well-approximated by a polynomial, leading to rapid convergence with increasing $n$. The method is particularly powerful because the weight function $w(Z)=Z^{\\alpha-1}(1-Z)^{\\beta-1}$, which may contain integrable singularities at the endpoints (if $\\alpha1$ or $\\beta1$), is handled analytically by the quadrature construction. The quadrature nodes and weights are inherently adapted to this weight, sampling $f(Z)$ most densely where the Beta-PDF has the most mass, without requiring the user to discretize the singularities.\n\nThe numerical stability of the scheme is excellent. Computing the roots and weights of orthogonal polynomials is a classic problem in numerical analysis. Modern libraries use stable algorithms, such as the Golub-Welsch algorithm, which relates the problem to finding the eigenvalues of a symmetric tridiagonal matrix (the Jacobi matrix). This is a well-conditioned computation. By relying on these robust routines for the canonical interval $[-1,1]$ and then applying a simple, non-pathological linear map to obtain the nodes for $[0,1]$, we inherit this stability. This ensures reliable computation even for large $n$ or for parameters $\\alpha, \\beta$ that lead to highly peaked or singular PDFs.\n\nThe implementation will proceed as follows:\n1. For a given set of parameters $(\\alpha, \\beta, n, f)$, set the Jacobi parameters to $a = \\beta-1$ and $b = \\alpha-1$.\n2. Use a standard library function (e.g., `scipy.special.roots_jacobi`) to compute the $n$ Gauss-Jacobi nodes $\\{x_i^{\\text{GJ}}\\}$ and weights $\\{w_i^{\\text{GJ}}\\}$ for the interval $[-1,1]$.\n3. Transform the nodes to the target interval $[0,1]$ via $Z_i = (x_i^{\\text{GJ}}+1)/2$.\n4. Scale the weights for the target interval via $w_i^{\\text{B}} = w_i^{\\text{GJ}} / 2^{\\alpha+\\beta-1}$.\n5. Evaluate the function $f$ at each node $Z_i$.\n6. Compute the integral approximation as the weighted sum $\\sum_{i=1}^{n} w_i^{\\text{B}} f(Z_i)$.\n7. Compare this result to a reference value (either exact via the Beta function or computed via high-accuracy generic numerical integration) to find the absolute error.\nThis procedure will be repeated for each specified test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_jacobi, beta\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Derives and applies a Gauss-Jacobi quadrature scheme for Beta-PDF weighted\n    integrals, and computes the absolute error against reference values\n    for a suite of test cases.\n    \"\"\"\n\n    def gauss_beta_quadrature(alpha, beta_param, n, f):\n        \"\"\"\n        Computes the integral of f(Z) * Z^(alpha-1) * (1-Z)^(beta-1) from 0 to 1\n        using an n-point custom Gaussian quadrature.\n\n        Args:\n            alpha (float): Shape parameter of the Beta distribution.\n            beta_param (float): Shape parameter of the Beta distribution.\n            n (int): Number of quadrature points.\n            f (callable): A vectorized function f(Z).\n\n        Returns:\n            float: The approximated integral value.\n        \"\"\"\n        # The integral on [0,1] with weight w(Z) = Z^(alpha-1)*(1-Z)^(beta-1)\n        # is transformed to an integral on [-1,1] with a standard Jacobi weight.\n        # The Jacobi polynomial P_n^(a,b)(x) is orthogonal with respect to\n        # the weight (1-x)^a * (1+x)^b.\n        # The transformation Z = (x+1)/2 maps our weight to a form proportional\n        # to (1-x)^(beta-1) * (1+x)^(alpha-1).\n        # Thus, the required Jacobi parameters are a = beta-1 and b = alpha-1.\n        a_jacobi = beta_param - 1\n        b_jacobi = alpha - 1\n\n        # Get the standard Gauss-Jacobi nodes and weights for the interval [-1, 1].\n        # scipy.special.roots_jacobi provides these for the integral\n        # integral_{-1}^{1} g(x) (1-x)^a (1+x)^b dx approx sum(w_jacobi * g(x_nodes))\n        x_nodes, w_jacobi = roots_jacobi(n, a_jacobi, b_jacobi)\n\n        # Map the nodes from [-1, 1] to the target interval [0, 1].\n        z_nodes = (x_nodes + 1.0) / 2.0\n\n        # As derived, the integral I = (1/2**(alpha+beta-1)) * sum(w_jacobi_i * f(Z_i)).\n        # We can define weights for the [0,1] interval as w_beta = w_jacobi / 2**(a+b+1).\n        # This gives I = sum(w_beta_i * f(Z_i)).\n        \n        # Evaluate the function f at the transformed nodes.\n        f_vals = f(z_nodes)\n\n        # Scale the weights and compute the final sum.\n        # The scaling factor is 2**(a_jacobi + b_jacobi + 1) = 2**(alpha + beta_param - 1)\n        scaling_factor = 2.0**(alpha + beta_param - 1.0)\n        \n        integral_approx = np.sum(w_jacobi * f_vals) / scaling_factor\n\n        return integral_approx\n\n    # Define the test suite\n    # Each case: (alpha, beta, n, f, reference_type, reference_calculator)\n    test_cases = [\n        (2.0, 5.0, 3, lambda Z: 1.0, \n         'exact', lambda a,b: beta(a, b)),\n        \n        (0.7, 1.3, 2, lambda Z: Z**3, \n         'exact', lambda a,b: beta(a + 3.0, b)),\n\n        (3.5, 4.0, 8, lambda Z: np.exp(-7.0 * Z), \n         'numerical', None),\n\n        (0.3, 0.6, 12, lambda Z: np.sqrt(Z),\n         'numerical', None),\n\n        (50.0, 50.0, 16, lambda Z: np.sin(np.pi * Z),\n         'numerical', None),\n\n        (80.0, 3.0, 16, lambda Z: Z**2 / (0.1 + Z),\n         'numerical', None),\n    ]\n\n    absolute_errors = []\n\n    for case in test_cases:\n        alpha, beta_param, n, f, ref_type, ref_func = case\n\n        # Calculate the integral using the derived quadrature scheme\n        approx_val = gauss_beta_quadrature(alpha, beta_param, n, f)\n\n        # Calculate the reference value\n        if ref_type == 'exact':\n            ref_val = ref_func(alpha, beta_param)\n        else:  # 'numerical'\n            integrand = lambda Z: f(Z) * (Z**(alpha - 1.0)) * ((1.0 - Z)**(beta_param - 1.0))\n            ref_val, _ = quad(integrand, 0, 1, epsabs=1e-15, epsrel=1e-15)\n        \n        # Compute the absolute error\n        error = np.abs(approx_val - ref_val)\n        absolute_errors.append(f\"{error:.16e}\")\n\n    # Print the final result in the required format\n    print(f\"[{','.join(absolute_errors)}]\")\n\nsolve()\n```"
        }
    ]
}