{
    "hands_on_practices": [
        {
            "introduction": "The mixture fraction, $Z$, is the foundational coordinate in flamelet theory, mapping the complex chemistry of a non-premixed flame onto a single scalar variable. At the heart of this framework lies the stoichiometric mixture fraction, $Z_{st}$, which pinpoints the location where fuel and oxidizer are in perfect balance for complete combustion. This exercise  will guide you through the fundamental calculation of $Z_{st}$ using Bilger's element-based definition, a rigorous approach that ensures conservation across the reaction zone.",
            "id": "4026226",
            "problem": "Consider a steady, laminar, non-premixed flamelet formed by mixing a methane-containing fuel stream with a humid oxidizer stream. The mixture fraction is defined following Bilger’s approach based on element conservation (carbon, hydrogen, oxygen). Let the fuel stream be a methane–nitrogen mixture with species mass fractions $Y_{\\mathrm{CH_4}} = 0.90$ and $Y_{\\mathrm{N_2}} = 0.10$. The oxidizer stream contains molecular oxygen, water vapor, and nitrogen, with species mass fractions $Y_{\\mathrm{O_2}} = 0.23$, $Y_{\\mathrm{H_2O}} = 0.03$, and $Y_{\\mathrm{N_2}} = 1 - Y_{\\mathrm{O_2}} - Y_{\\mathrm{H_2O}}$. Assume complete oxidation to carbon dioxide and water at stoichiometric conditions. Use atomic weights $W_C = 12$, $W_H = 1$, and $W_O = 16$.\n\nStarting from element conservation, define Bilger’s conserved scalar\n$$\\beta \\equiv 2\\,\\frac{Y_C}{W_C} + \\frac{1}{2}\\,\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O},$$\nand the Bilger mixture fraction\n$$Z \\equiv \\frac{\\beta - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}},$$\nwhere the subscripts $\\mathrm{f}$ and $\\mathrm{ox}$ denote properties evaluated in the pure fuel and pure oxidizer streams, respectively. The stoichiometric mixture fraction $Z_{\\mathrm{st}}$ is defined by the elemental balance at stoichiometry, which implies $\\beta(Z_{\\mathrm{st}}) = 0$.\n\nCompute $Z_{\\mathrm{st}}$ for this methane–air system using the given oxidizer composition $Y_{\\mathrm{O_2}}$ and the stated fuel stream conditions. Then verify, by explicit elemental accounting, that the location $Z = Z_{\\mathrm{st}}$ satisfies the balance between elemental oxygen and the oxygen required to completely oxidize the available carbon and hydrogen. Round your final value of $Z_{\\mathrm{st}}$ to four significant figures and express it as a dimensionless number.",
            "solution": "The problem requires the calculation of the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$, for a non-premixed methane flamelet and a subsequent verification of the elemental balance at this condition. The analysis begins with the provided definitions and stream compositions.\n\nThe Bilger mixture fraction is defined as:\n$$Z \\equiv \\frac{\\beta - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}}$$\nwhere $\\beta$ is a conserved scalar defined in terms of elemental mass fractions ($Y_C, Y_H, Y_O$) and atomic weights ($W_C, W_H, W_O$):\n$$\\beta \\equiv 2\\,\\frac{Y_C}{W_C} + \\frac{1}{2}\\,\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O}$$\nThe subscripts $\\mathrm{f}$ and $\\mathrm{ox}$ denote the pure fuel and pure oxidizer streams, respectively. The stoichiometric condition is defined by $\\beta = 0$, where the available oxygen is exactly consumed by the available fuel elements (carbon and hydrogen) to form complete combustion products ($\\mathrm{CO_2}$ and $\\mathrm{H_2O}$).\n\nSetting $\\beta = 0$ in the definition of $Z$ yields the expression for the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$:\n$$Z_{\\mathrm{st}} = \\frac{0 - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}} = \\frac{-\\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}}$$\nTo calculate $Z_{\\mathrm{st}}$, we must first determine the values of $\\beta_{\\mathrm{f}}$ and $\\beta_{\\mathrm{ox}}$, which requires calculating the elemental mass fractions in each stream. The given atomic weights are $W_C = 12$, $W_H = 1$, and $W_O = 16$.\n\n**1. Analysis of the Fuel Stream (subscript f)**\n\nThe fuel stream is a mixture of methane ($\\mathrm{CH_4}$) and nitrogen ($\\mathrm{N_2}$) with mass fractions $Y_{\\mathrm{CH_4, f}} = 0.90$ and $Y_{\\mathrm{N_2, f}} = 0.10$.\nThe molar mass of methane is $W_{\\mathrm{CH_4}} = W_C + 4W_H = 12 + 4(1) = 16$.\nThe elemental mass fractions in the fuel stream are:\n- Carbon (from $\\mathrm{CH_4}$): $Y_{C,f} = Y_{\\mathrm{CH_4, f}} \\times \\frac{W_C}{W_{\\mathrm{CH_4}}} = 0.90 \\times \\frac{12}{16} = 0.90 \\times 0.75 = 0.675$.\n- Hydrogen (from $\\mathrm{CH_4}$): $Y_{H,f} = Y_{\\mathrm{CH_4, f}} \\times \\frac{4W_H}{W_{\\mathrm{CH_4}}} = 0.90 \\times \\frac{4}{16} = 0.90 \\times 0.25 = 0.225$.\n- Oxygen: $Y_{O,f} = 0$, as there are no oxygen-containing species in the fuel stream.\n\nNow, we calculate $\\beta_{\\mathrm{f}}$:\n$$\\beta_{\\mathrm{f}} = 2\\,\\frac{Y_{C,f}}{W_C} + \\frac{1}{2}\\,\\frac{Y_{H,f}}{W_H} - \\frac{Y_{O,f}}{W_O} = 2\\,\\frac{0.675}{12} + \\frac{1}{2}\\,\\frac{0.225}{1} - \\frac{0}{16} = 0.1125 + 0.1125 - 0 = 0.225$$\nIn fractional form, $\\beta_{\\mathrm{f}} = \\frac{9}{40}$.\n\n**2. Analysis of the Oxidizer Stream (subscript ox)**\n\nThe oxidizer stream contains oxygen ($\\mathrm{O_2}$), water vapor ($\\mathrm{H_2O}$), and nitrogen ($\\mathrm{N_2}$) with mass fractions $Y_{\\mathrm{O_2, ox}} = 0.23$ and $Y_{\\mathrm{H_2O, ox}} = 0.03$.\nThe mass fraction of nitrogen is $Y_{\\mathrm{N_2, ox}} = 1 - Y_{\\mathrm{O_2, ox}} - Y_{\\mathrm{H_2O, ox}} = 1 - 0.23 - 0.03 = 0.74$.\nThe molar mass of water is $W_{\\mathrm{H_2O}} = 2W_H + W_O = 2(1) + 16 = 18$.\nThe elemental mass fractions in the oxidizer stream are:\n- Carbon: $Y_{C,ox} = 0$.\n- Hydrogen (from $\\mathrm{H_2O}$): $Y_{H,ox} = Y_{\\mathrm{H_2O, ox}} \\times \\frac{2W_H}{W_{\\mathrm{H_2O}}} = 0.03 \\times \\frac{2}{18} = \\frac{0.06}{18} = \\frac{1}{300}$.\n- Oxygen (from $\\mathrm{O_2}$ and $\\mathrm{H_2O}$): $Y_{O,ox} = Y_{\\mathrm{O_2, ox}} + Y_{\\mathrm{H_2O, ox}} \\times \\frac{W_O}{W_{\\mathrm{H_2O}}} = 0.23 + 0.03 \\times \\frac{16}{18} = \\frac{23}{100} + \\frac{3}{100} \\times \\frac{16}{18} = \\frac{23}{100} + \\frac{48}{1800} = \\frac{23}{100} + \\frac{4}{150} = \\frac{69+8}{300} = \\frac{77}{300}$.\n\nNow, we calculate $\\beta_{\\mathrm{ox}}$:\n$$\\beta_{\\mathrm{ox}} = 2\\,\\frac{Y_{C,ox}}{W_C} + \\frac{1}{2}\\,\\frac{Y_{H,ox}}{W_H} - \\frac{Y_{O,ox}}{W_O} = 2\\,\\frac{0}{12} + \\frac{1}{2}\\,\\frac{1/300}{1} - \\frac{77/300}{16} = \\frac{1}{600} - \\frac{77}{4800} = \\frac{8 - 77}{4800} = \\frac{-69}{4800} = -\\frac{23}{1600}$$\n\n**3. Calculation of the Stoichiometric Mixture Fraction, $Z_{\\mathrm{st}}$**\n\nWith $\\beta_{\\mathrm{f}} = 9/40$ and $\\beta_{\\mathrm{ox}} = -23/1600$, we can compute $Z_{\\mathrm{st}}$:\n$$Z_{\\mathrm{st}} = \\frac{-\\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}} = \\frac{-(-23/1600)}{(9/40) - (-23/1600)} = \\frac{23/1600}{(360/1600) + (23/1600)} = \\frac{23/1600}{383/1600} = \\frac{23}{383}$$\nNumerically, this is $Z_{\\mathrm{st}} \\approx 0.060052219...$.\nRounding to four significant figures, we get $Z_{\\mathrm{st}} = 0.06005$.\n\n**4. Verification of Elemental Balance at Stoichiometry**\n\nThe problem requires verification that at $Z = Z_{\\mathrm{st}}$, the available elemental oxygen mass fraction, $Y_O(Z_{\\mathrm{st}})$, equals the mass fraction of oxygen required to completely oxidize the available carbon and hydrogen, $Y_{O,req}(Z_{\\mathrm{st}})$.\n\nThe stoichiometric oxidation reactions are $\\mathrm{C} + \\mathrm{O_2} \\rightarrow \\mathrm{CO_2}$ and $2\\mathrm{H_2} + \\mathrm{O_2} \\rightarrow 2\\mathrm{H_2O}$. On a mass basis, $W_C$ units of carbon require $2W_O$ units of oxygen, and $2W_H$ units of hydrogen require $W_O$ units of oxygen.\nTherefore, the required oxygen mass fraction is:\n$$Y_{O,req} = Y_C \\left(\\frac{2W_O}{W_C}\\right) + Y_H \\left(\\frac{W_O}{2W_H}\\right) = Y_C \\left(\\frac{2 \\times 16}{12}\\right) + Y_H \\left(\\frac{16}{2 \\times 1}\\right) = \\frac{8}{3}Y_C + 8Y_H$$\nThe elemental mass fractions at any point $Z$ are found by linear interpolation between the fuel and oxidizer streams: $Y_k(Z) = ZY_{k,f} + (1-Z)Y_{k,ox}$.\nAt $Z_{\\mathrm{st}} = 23/383$:\n- $Y_C(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{C,f} + \\frac{360}{383} Y_{C,ox} = \\frac{23}{383}(0.675) + 0 = \\frac{23}{383} \\frac{27}{40} = \\frac{621}{15320}$.\n- $Y_H(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{H,f} + \\frac{360}{383} Y_{H,ox} = \\frac{23}{383}(0.225) + \\frac{360}{383}\\left(\\frac{1}{300}\\right) = \\frac{23}{383}\\frac{9}{40} + \\frac{360}{114900} = \\frac{207}{15320} + \\frac{48}{15320} = \\frac{255}{15320}$.\n- $Y_O(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{O,f} + \\frac{360}{383} Y_{O,ox} = 0 + \\frac{360}{383}\\left(\\frac{77}{300}\\right) = \\frac{360 \\times 77}{383 \\times 300} = \\frac{1.2 \\times 77}{383} = \\frac{92.4}{383} = \\frac{924}{3830} = \\frac{462}{1915}$. To match denominators, this is $\\frac{3696}{15320}$.\n\nNow we check if $Y_O(Z_{\\mathrm{st}}) = Y_{O,req}(Z_{\\mathrm{st}})$.\nThe available oxygen is $Y_{O,available} = Y_O(Z_{\\mathrm{st}}) = \\frac{3696}{15320}$.\nThe required oxygen is:\n$$Y_{O,req}(Z_{\\mathrm{st}}) = \\frac{8}{3}Y_C(Z_{\\mathrm{st}}) + 8Y_H(Z_{\\mathrm{st}}) = \\frac{8}{3}\\left(\\frac{621}{15320}\\right) + 8\\left(\\frac{255}{15320}\\right)$$\n$$Y_{O,req}(Z_{\\mathrm{st}}) = \\frac{8 \\times 207}{15320} + \\frac{2040}{15320} = \\frac{1656 + 2040}{15320} = \\frac{3696}{15320}$$\nSince $Y_{O,available} = Y_{O,req}$, the elemental balance is satisfied, which verifies the calculation. The derivation of $Z_{\\mathrm{st}}$ from the condition $\\beta=0$ inherently ensures this balance, and this explicit calculation confirms its correctness.\nThe final value for the stoichiometric mixture fraction, rounded to four significant figures, is $0.06005$.",
            "answer": "$$\\boxed{0.06005}$$"
        },
        {
            "introduction": "While the flamelet model provides a powerful simplification for turbulent combustion, its validity hinges on a crucial separation of scales: the chemical reactions must be fast and thin compared to the turbulent motions that stretch and contort the flame. This practice  challenges you to diagnose the combustion regime using key dimensionless parameters like the Damköhler ($Da$) and Karlovitz ($Ka$) numbers. Mastering this skill is essential for understanding the limits of the flamelet assumption and for correctly interpreting simulation and experimental data.",
            "id": "4026194",
            "problem": "Consider a statistically stationary, homogeneous and isotropic turbulent flow field into which a gaseous fuel and oxidizer are mixed, forming a non-premixed reaction zone. At a given location, you have measured the following dimensionless quantities that characterize local interaction between turbulence and chemistry: the Damköhler number $Da$, the Karlovitz number $Ka$, and the ratio of the measured local scalar thickness to the Kolmogorov length scale $r = \\delta_{s}/\\eta$, where $\\eta$ denotes the Kolmogorov length scale and $\\delta_{s}$ denotes the thickness of the local diffusion–reaction layer estimated from a conservative scalar (e.g., mixture fraction) profile. All three quantities are dimensionless. The measured values at this location are $Da = 1.8$, $Ka = 0.90$, and $r = 0.60$.\n\nStarting from first principles and core definitions in turbulence–chemistry interaction, use the notion of scale separation required by the flamelet concept to assess whether the local regime is consistent with a non-premixed flamelet assumption. Encode your conclusion as an indicator $I$ defined to be $I = 1$ if the local regime is consistent with the flamelet assumption and $I = 0$ otherwise. Report a single dimensionless number for $I$; do not include any units. No rounding is required.",
            "solution": "The problem asks to determine if a local state in a turbulent non-premixed reacting flow is consistent with the flamelet assumption, based on three measured dimensionless quantities: the Damköhler number, $Da$, the Karlovitz number, $Ka$, and the ratio of the scalar thickness to the Kolmogorov length scale, $r$. The conclusion is to be encoded in an indicator variable $I$.\n\nFirst, we must establish the physical principles underlying the non-premixed flamelet concept. The flamelet model posits that a turbulent flame can be viewed as an ensemble of thin, quasi-steady, one-dimensional laminar diffusion flame structures. These flamelets are advected, stretched, and strained by the turbulent flow but maintain their internal one-dimensional structure. The validity of this model hinges on a critical assumption of scale separation. Specifically, the characteristic length and time scales of the chemical reaction must be significantly smaller than the corresponding scales of the turbulent fluid motion.\n\nWe will assess the given data against the necessary conditions for the flamelet regime.\n\n1.  **Condition on Length Scales:**\n    The most fundamental requirement for the flamelet concept is that the reaction-diffusion layer must be thinner than the smallest scales of turbulence. The smallest turbulent length scale is the Kolmogorov microscale, denoted by $\\eta$. The thickness of the reaction-diffusion layer can be estimated from the profile of a conserved scalar (like the mixture fraction), denoted here as $\\delta_s$. For the flamelet's internal structure to be unaffected by turbulent eddies, it must be geometrically embedded within the smallest dissipative structures. This leads to the condition:\n    $$\n    \\delta_s  \\eta\n    $$\n    The problem provides a dimensionless ratio $r$ precisely for evaluating this condition:\n    $$\n    r = \\frac{\\delta_s}{\\eta}\n    $$\n    The measured value is $r = 0.60$. Since $0.60  1$, the condition $\\delta_s  \\eta$ is satisfied. This provides strong evidence that the reaction zone is sufficiently thin relative to the smallest turbulent eddies to maintain its structure.\n\n2.  **Conditions on Time Scales:**\n    The chemical processes must be fast enough to respond quasi-steadily to the changes imposed by the turbulent flow. This is typically assessed by comparing the chemical time scale, $\\tau_c$, to two different turbulent time scales.\n\n    a) **Comparison with the large-eddy time scale:** The Damköhler number, $Da$, compares the macroscopic turbulent time scale (the large-eddy turnover time, $\\tau_t$) to the characteristic chemical time scale, $\\tau_c$.\n    $$\n    Da = \\frac{\\tau_t}{\\tau_c}\n    $$\n    For chemistry to be considered \"fast\" relative to the overall turbulent mixing process, the Damköhler number must be large. The conventional criterion for entering the flamelet regime is $Da > 1$. The problem states that the measured value is $Da = 1.8$. Since $1.8 > 1$, this condition is met. This implies that the chemical reaction is completed faster than the time it takes for a large turbulent eddy to distort the flame sheet, allowing a flamelet structure to exist. While ideally one would expect $Da \\gg 1$ for a canonical flamelet, a value of $1.8$ is consistent with the regime.\n\n    b) **Comparison with the small-eddy time scale:** The Karlovitz number, $Ka$, compares the chemical time scale, $\\tau_c$, to the turbulent time scale at the Kolmogorov scale, $\\tau_k$.\n    $$\n    Ka = \\frac{\\tau_c}{\\tau_k}\n    $$\n    This number is critical for the flamelet's internal structure. If the chemical time is longer than the Kolmogorov time ($Ka > 1$), the smallest turbulent eddies can penetrate the reaction zone, disrupt the balance between diffusion and reaction, and potentially quench the flame. Therefore, the existence of a flamelet structure requires that chemical processes are faster than the dissipative processes at the smallest scales, which imposes the condition:\n    $$\n    Ka  1\n    $$\n    The measured value is $Ka = 0.90$. Since $0.90  1$, this crucial condition is satisfied. It indicates that the reaction layer is not being torn apart by the smallest scales of turbulence. The condition can also be interpreted in terms of length scales, as $Ka$ is related to the square of the ratio of a characteristic flame thickness $\\delta_L$ to the Kolmogorov scale $\\eta$, i.e., $Ka \\approx (\\delta_L/\\eta)^2$. Thus, $Ka  1$ is consistent with the length-scale separation condition $\\delta_L  \\eta$.\n\n**Conclusion Synthesis:**\nWe have examined the three provided dimensionless parameters against the established criteria for the non-premixed flamelet regime:\n-   The length scale condition, $r = \\delta_s/\\eta  1$, is met since $0.60  1$.\n-   The large-scale time condition, $Da > 1$, is met since $1.8 > 1$.\n-   The small-scale time condition, $Ka  1$, is met since $0.90  1$.\n\nAll three criteria are consistent with the assumptions of flamelet theory. The local state of the flow, as characterized by the given parameters, falls within the non-premixed flamelet combustion regime. Therefore, the indicator variable $I$, which is defined to be $1$ if the local regime is consistent with the flamelet assumption, must be assigned the value $1$.\n\nThe final answer is the value of the indicator $I$.\n$$\nI = 1\n$$",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "The celebrated \"S-curve\" is a cornerstone of flamelet theory, illustrating the multiple steady-state solutions for flame temperature as a function of the scalar dissipation rate, $\\chi_{st}$. This curve elegantly captures the phenomena of ignition and extinction. In this computational exercise , you will develop a model to solve for the flame temperature and visualize how factors like radiative heat loss can alter the S-curve, potentially leading to flame quenching. This practice provides a direct, hands-on understanding of flame stability.",
            "id": "4026206",
            "problem": "You are asked to formalize and compute the impact of heat loss on the maximum temperature of a steady non-premixed flamelet, and to update the corresponding scalar dissipation rate–temperature curve (the \"S-curve\"). The task must be carried out fully in the mixture fraction formalism with scientifically consistent closure assumptions. The solution must be implemented as a complete, runnable program.\n\nA simplified 0-D model for the energy balance at the flame's peak temperature (assumed to be at $Z=Z_{\\mathrm{st}}$) can be formulated by equating the chemical heat generation with the heat sinks from diffusion and radiation:\n$$\n\\dot{q}_{\\mathrm{reac}} = S_{\\mathrm{diff}} + q_{\\mathrm{rad}}\n$$\nAssume the following scientifically grounded modeling closures and definitions for each term:\n- The diffusive sink, $S_{\\mathrm{diff}}$, is modeled using the scalar dissipation rate as a characteristic inverse timescale for heat transport:\n$$ S_{\\mathrm{diff}}(T) = \\rho c_p \\chi_{\\mathrm{st}} (T - T_u) $$\nwhere $\\chi_{\\mathrm{st}}$ is the scalar dissipation rate at stoichiometry and $T_u$ is the unburned reference temperature.\n- The radiative loss at $Z_{\\mathrm{st}}$, $q_{\\mathrm{rad}}$, is given by its local value from the profile $q_{\\mathrm{rad}}(Z)$.\n- The heat release rate, $\\dot{q}_{\\mathrm{reac}}$, is modeled by a one-step Arrhenius form at $Z_{\\mathrm{st}}$:\n$$\n\\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right),\n$$\nwhere $Q_{\\mathrm{heat}}$ is the heat of reaction per unit mass of the reactive mixture, $A$ is the pre-exponential factor, $E$ is the activation energy, $R$ is the universal gas constant, and $T_{\\mathrm{eff}}$ is an effective temperature appearing in the reaction rate.\n- The enthalpy defect $h_{\\mathrm{def}}$ accounts for external heat loss in terms of missing sensible enthalpy, such that the reactive temperature in the source term is shifted as\n$$\nT_{\\mathrm{eff}} = T - \\frac{h_{\\mathrm{def}}}{c_p}.\n$$\n\nUsing these assumptions, the peak flamelet temperature $T_{\\max}$ at $Z_{\\mathrm{st}}$ is obtained by the largest physically admissible root of the steady balance at the temperature maximum. This results in an implicit scalar equation in $T$ whose solution set can be multi-valued in general (reflecting the classical S-curve structure). Your program must robustly identify all roots over a physically reasonable temperature interval and select $T_{\\max}$ as the largest root. If no root exists, set $T_{\\max} = T_u$.\n\nNumerical constants and units to be used:\n- $\\rho = 1.2$ in $\\mathrm{kg/m^3}$,\n- $c_p = 1000$ in $\\mathrm{J/(kg\\cdot K)}$,\n- $T_u = 300$ in $\\mathrm{K}$,\n- $Q_{\\mathrm{heat}} = 3.0\\times 10^{7}$ in $\\mathrm{J/kg}$,\n- $A = 5000$ in $\\mathrm{s^{-1}}$,\n- $E = 1.5\\times 10^{5}$ in $\\mathrm{J/mol}$,\n- $R = 8.314$ in $\\mathrm{J/(mol\\cdot K)}$,\n- $Z_{\\mathrm{st}} = 0.055$ (dimensionless mixture fraction),\n- For radiative loss profiles, use a Gaussian form\n$$\nq_{\\mathrm{rad}}(Z) = q_0 \\exp\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right),\n$$\nwith given amplitude $q_0$ in $\\mathrm{W/m^3}$ and width $\\sigma$ (dimensionless).\n\nRequired outputs:\n- For each given test case, compute the updated maximum flamelet temperature $T_{\\max}$ in Kelvin.\n- Express each $T_{\\max}$ in $\\mathrm{K}$, formatted to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").\n\nTest suite:\nProvide results for the following parameter sets. Each test case is a tuple describing $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0, \\sigma)$ where $h_{\\mathrm{def}}$ is in $\\mathrm{J/kg}$, $q_0$ is in $\\mathrm{W/m^3}$, and $\\sigma$ is dimensionless. If $h_{\\mathrm{def}}  0$, it applies; otherwise set $h_{\\mathrm{def}} = 0$. If $q_0  0$, use the specified Gaussian $q_{\\mathrm{rad}}(Z)$; otherwise set $q_{\\mathrm{rad}}(Z) \\equiv 0$.\n- Case 1 (adiabatic baseline, happy path): $(10.0, 0.0, 0.0, 0.01)$\n- Case 2 (moderate enthalpy defect): $(10.0, 1.0\\times 10^{5}, 0.0, 0.01)$\n- Case 3 (radiative Gaussian loss at stoichiometry): $(10.0, 0.0, 1.5\\times 10^{7}, 0.02)$\n- Case 4 (high scalar dissipation, adiabatic): $(80.0, 0.0, 0.0, 0.01)$\n- Case 5 (high scalar dissipation with radiative loss): $(80.0, 0.0, 2.0\\times 10^{7}, 0.02)$\n- Case 6 (strong enthalpy defect, potential extinction): $(80.0, 5.0\\times 10^{5}, 0.0, 0.01)$\n\nAngle units do not apply in this problem. Percentages are not used.\n\nImplementation constraints:\n- The final answer must be a complete, runnable program.\n- The program must not require user input.\n- The program must identify all real roots of the implicit steady balance over the interval $[T_u, 3500\\,\\mathrm{K}]$ and select $T_{\\max}$ as the largest root. If no roots exist, set $T_{\\max} = T_u$.\n- The final output must be a single line printing the list of $T_{\\max}$ for all six test cases, in Kelvin, each formatted to three decimal places.",
            "solution": "The user has provided a problem statement that successfully passes the validation phase.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The steady flamelet energy equation in the mixture fraction $Z$ coordinate for unity Lewis number is given as:\n$$\n\\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + \\dot{q}_{\\mathrm{reac}}(T,Z) - q_{\\mathrm{rad}}(Z) = 0\n$$\n- **Model for Diffusive Sink at $Z_{\\mathrm{st}}$**: The diffusive term is modeled as a linearized sink at the peak temperature location:\n$$\nS_{\\mathrm{diff}}(T) \\approx \\rho c_p \\chi_{\\mathrm{st}} \\left(T - T_u\\right)\n$$\n- **Model for Heat Release Rate at $Z_{\\mathrm{st}}$**: A one-step Arrhenius form is assumed:\n$$\n\\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right)\n$$\n- **Effective Temperature Definition**: The temperature in the reaction term is adjusted for enthalpy defect $h_{\\mathrm{def}}$:\n$$\nT_{\\mathrm{eff}} = T - \\frac{h_{\\mathrm{def}}}{c_p}\n$$\n- **Model for Radiative Loss**: A Gaussian profile is given:\n$$\nq_{\\mathrm{rad}}(Z) = q_0 \\exp\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right)\n$$\n- **Numerical Constants**:\n  - $\\rho = 1.2 \\, \\mathrm{kg/m^3}$\n  - $c_p = 1000 \\, \\mathrm{J/(kg\\cdot K)}$\n  - $T_u = 300 \\, \\mathrm{K}$\n  - $Q_{\\mathrm{heat}} = 3.0\\times 10^{7} \\, \\mathrm{J/kg}$\n  - $A = 5000 \\, \\mathrm{s^{-1}}$\n  - $E = 1.5\\times 10^{5} \\, \\mathrm{J/mol}$\n  - $R = 8.314 \\, \\mathrm{J/(mol\\cdot K)}$\n  - $Z_{\\mathrm{st}} = 0.055$\n- **Test Cases**: Six tuples of $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0, \\sigma)$.\n  - Case 1: $(10.0, 0.0, 0.0, 0.01)$\n  - Case 2: $(10.0, 1.0\\times 10^{5}, 0.0, 0.01)$\n  - Case 3: $(10.0, 0.0, 1.5\\times 10^{7}, 0.02)$\n  - Case 4: $(80.0, 0.0, 0.0, 0.01)$\n  - Case 5: $(80.0, 0.0, 2.0\\times 10^{7}, 0.02)$\n  - Case 6: $(80.0, 5.0\\times 10^{5}, 0.0, 0.01)$\n- **Constraints**:\n  - If $h_{\\mathrm{def}} \\le 0$, it is taken as $0$.\n  - If $q_0 \\le 0$, the radiative loss $q_{\\mathrm{rad}}(Z)$ is taken as $0$.\n  - Roots must be found in the interval $[T_u, 3500\\,\\mathrm{K}]$.\n  - $T_{\\max}$ is the largest root; if no roots exist, $T_{\\max} = T_u$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, relying on established flamelet theory and simplified, yet physically-based, models for reaction kinetics and transport. The models and constants are dimensionally consistent and physically reasonable. The problem is well-posed: it requires finding the roots of a well-defined nonlinear scalar equation and provides a clear rule for selecting the solution. The language is objective and the requirements are specific. The problem is therefore deemed **valid**.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe objective is to determine the maximum flamelet temperature, $T_{\\max}$, by establishing a steady-state energy balance at the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$, where the temperature is assumed to peak. At this peak, the heat generated by chemical reaction must balance the heat lost to the surroundings via diffusion and radiation.\n\nThe governing steady energy equation is rearranged to represent this balance:\n$$\n\\dot{q}_{\\mathrm{reac}}(T,Z) = - \\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + q_{\\mathrm{rad}}(Z)\n$$\nAt the location of maximum temperature $T = T_{\\max}$ (assumed to be at $Z = Z_{\\mathrm{st}}$), the left-hand side is the heat source, and the right-hand side represents the heat sinks. The problem provides specific models for these terms.\n\n1.  **Heat Source Term**: The heat release rate is given by the Arrhenius expression, evaluated using an effective temperature $T_{\\mathrm{eff}}$ that accounts for non-adiabaticity through an enthalpy defect $h_{\\mathrm{def}}$:\n    $$\n    \\text{Source}(T) = \\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right)\n    $$\n    where $T_{\\mathrm{eff}} = T - h_{\\mathrm{def}}/c_p$. Note that this term is physically meaningful only for temperatures $T > h_{\\mathrm{def}}/c_p$.\n\n2.  **Heat Sink Terms**: The total sink is the sum of the diffusive and radiative losses.\n    - The diffusive sink, representing heat transport away from the reaction zone, is modeled as:\n    $$\n    S_{\\mathrm{diff}}(T) = \\rho c_p \\chi_{\\mathrm{st}} (T - T_u)\n    $$\n    This term linearly increases with the temperature difference above the unburned reference temperature $T_u$.\n    - The radiative sink at $Z=Z_{\\mathrm{st}}$, from the given Gaussian profile, is simply its peak value:\n    $$\n    q_{\\mathrm{rad}}(Z_{\\mathrm{st}}) = q_0 \\exp\\left(-\\frac{(Z_{\\mathrm{st}} - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right) = q_0\n    $$\n\nEquating the source and sinks at $T = T_{\\max}$ yields the following implicit equation for $T$:\n$$\n\\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R (T - h_{\\mathrm{def}}/c_p)}\\right) = \\rho c_p \\chi_{\\mathrm{st}} (T - T_u) + q_0\n$$\nTo find the steady-state temperatures, we must find the roots of the function $f(T)$:\n$$\nf(T) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R (T - h_{\\mathrm{def}}/c_p)}\\right) - \\left( \\rho c_p \\chi_{\\mathrm{st}} (T - T_u) + q_0 \\right) = 0\n$$\nThe roots of this equation correspond to the intersection points of the heat generation curve (an S-shaped curve) and the heat loss curve (a line). There can be zero, one, two, or three roots in the physical domain. The largest of these roots corresponds to the stable, high-temperature burning solution, which we identify as $T_{\\max}$. The lowest root typically corresponds to a stable, non-burning state near $T_u$, and a middle root (if it exists) is unstable.\n\n### Numerical Solution Strategy\nThe solution is implemented by developing a program to find all real roots of $f(T)=0$ within the specified physical interval $[T_u, 3500\\,\\mathrm{K}]$.\n\n1.  For each test case, the parameters $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0)$ are used to define the specific instance of the function $f(T)$. The conditions on non-positive $h_{\\mathrm{def}}$ and $q_0$ are applied.\n2.  The physical domain for the search is established. The Arrhenius term is defined only for $T > T_{shift}$, where $T_{shift} = h_{\\mathrm{def}}/c_p$. Therefore, the search for roots is conducted in the interval $[\\max(T_u, T_{shift} + \\delta), 3500\\,\\mathrm{K}]$, where $\\delta$ is a small positive value to avoid the pole at $T=T_{shift}$.\n3.  A robust root-finding algorithm is employed. The search interval is discretized into a fine grid. By checking for changes in the sign of $f(T)$ between adjacent grid points, we can identify subintervals that are guaranteed to contain a root (by the Intermediate Value Theorem).\n4.  For each such subinterval $[T_i, T_{i+1}]$ where $f(T_i) \\cdot f(T_{i+1})  0$, a numerical solver, `scipy.optimize.brentq`, is used to find the precise location of the root.\n5.  All found roots are collected. The maximum temperature $T_{\\max}$ is then the largest value among these roots.\n6.  If no roots are found in the valid search domain, it signifies that the heat losses are too great for a stable flame to exist (extinction). In this scenario, the temperature is set to the unburned temperature, $T_{\\max} = T_u$, as per the problem's instructions.\n7.  This procedure is repeated for all six test cases, and the results are formatted and printed according to the specified output format.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the maximum flamelet temperature for several cases by solving the\n    steady-state energy balance equation for a non-premixed flamelet.\n    \"\"\"\n    \n    # Define physical and chemical constants\n    RHO = 1.2        # Density in kg/m^3\n    CP = 1000.0      # Specific heat in J/(kg*K)\n    TU = 300.0       # Unburned temperature in K\n    Q_HEAT = 3.0e7   # Heat of reaction in J/kg\n    A = 5000.0       # Pre-exponential factor in 1/s\n    E = 1.5e5        # Activation energy in J/mol\n    R = 8.314        # Universal gas constant in J/(mol*K)\n\n    # Define the test suite\n    # Each case is a tuple: (chi_st, h_def, q0, sigma)\n    test_cases = [\n        (10.0, 0.0, 0.0, 0.01),\n        (10.0, 1.0e5, 0.0, 0.01),\n        (10.0, 0.0, 1.5e7, 0.02),\n        (80.0, 0.0, 0.0, 0.01),\n        (80.0, 0.0, 2.0e7, 0.02),\n        (80.0, 5.0e5, 0.0, 0.01),\n    ]\n\n    results = []\n    \n    # Define the search interval for temperature roots\n    T_min_search = TU\n    T_max_search = 3500.0\n    N_grid = 20000  # Number of grid points for root bracketing\n\n    for case in test_cases:\n        chi_st, h_def, q0, sigma = case\n        \n        # Apply conditional logic for h_def and q0 as per problem statement\n        if h_def = 0:\n            h_def = 0.0\n        if q0 = 0:\n            q0 = 0.0\n\n        # Calculate the temperature shift due to enthalpy defect\n        T_shift = h_def / CP\n\n        def f(T):\n            \"\"\"\n            Represents the energy balance equation f(T) = source - sink = 0.\n            The roots of this function are the steady-state temperatures.\n            \"\"\"\n            # The reaction term is undefined for T = T_shift\n            if T = T_shift:\n                # Return a large negative value to prevent finding false roots in this region.\n                # The loss term is typically positive, so their difference is negative.\n                return -1e12\n\n            T_eff = T - T_shift\n            \n            # Heat release source term (W/m^3)\n            # Use a try-except block to handle potential overflow from np.exp\n            try:\n                q_reac = RHO * Q_HEAT * A * np.exp(-E / (R * T_eff))\n            except OverflowError:\n                q_reac = np.inf\n            \n            # Heat loss sink term (W/m^3)\n            q_loss = RHO * CP * chi_st * (T - TU) + q0\n            \n            return q_reac - q_loss\n\n        roots = []\n        \n        # Determine the valid search start temperature, avoiding the pole\n        T_start = max(T_min_search, T_shift + 1e-9)\n        \n        if T_start >= T_max_search:\n            # If the entire search range is invalid, no roots can exist\n            T_max = TU\n        else:\n            # Create a grid over the valid search interval\n            T_grid = np.linspace(T_start, T_max_search, N_grid)\n            \n            # Evaluate the function on the grid\n            f_grid = np.array([f(t) for t in T_grid])\n            \n            # Find intervals where a root exists (sign change)\n            for i in range(len(T_grid) - 1):\n                if np.sign(f_grid[i]) != np.sign(f_grid[i+1]):\n                    # A root is bracketed, find it precisely using brentq\n                    try:\n                        root = brentq(f, T_grid[i], T_grid[i+1])\n                        roots.append(root)\n                    except (ValueError, RuntimeError):\n                        # brentq might fail in edge cases, skip if so\n                        pass\n        \n            if roots:\n                # The maximum temperature is the largest root\n                T_max = max(roots)\n            else:\n                # If no roots are found, the solution is the unburned state\n                T_max = TU\n        \n        results.append(T_max)\n\n    # Format the results to three decimal places and print in the required format\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}