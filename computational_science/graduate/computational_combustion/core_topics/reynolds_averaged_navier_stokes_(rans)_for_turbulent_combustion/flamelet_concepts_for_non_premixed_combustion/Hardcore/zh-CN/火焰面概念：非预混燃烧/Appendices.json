{
    "hands_on_practices": [
        {
            "introduction": "在非预混燃烧的火焰面模型中，混合分数 $Z$ 是描述混合状态的核心自变量。其中，化学计量混合分数 $Z_{st}$ 标记了燃料和氧化剂恰好完全反应的理想位置，是分析火焰结构和特性的基石。本练习将通过 Bilger 基于元素守恒的定义，指导你从给定的燃料和氧化剂组分出发，亲手计算 $Z_{st}$，并验证其物理意义 。",
            "id": "4026226",
            "problem": "考虑一个由含甲烷的燃料流与潮湿的氧化剂流混合形成的稳定、层流、非预混小火焰。混合分数根据 Bilger 基于元素守恒（碳、氢、氧）的方法定义。设燃料流为甲烷-氮气混合物，其组分质量分数为 $Y_{\\mathrm{CH_4}} = 0.90$ 和 $Y_{\\mathrm{N_2}} = 0.10$。氧化剂流包含分子氧、水蒸气和氮气，其组分质量分数为 $Y_{\\mathrm{O_2}} = 0.23$、$Y_{\\mathrm{H_2O}} = 0.03$ 和 $Y_{\\mathrm{N_2}} = 1 - Y_{\\mathrm{O_2}} - Y_{\\mathrm{H_2O}}$。假设在化学计量条件下完全氧化为二氧化碳和水。使用原子量 $W_C = 12$、$W_H = 1$ 和 $W_O = 16$。\n\n从元素守恒出发，定义 Bilger 守恒标量\n$$\\beta \\equiv \\frac{Y_O}{W_O} - 2\\,\\frac{Y_C}{W_C} - \\frac{1}{2}\\,\\frac{Y_H}{W_H},$$\n以及 Bilger 混合分数\n$$Z \\equiv \\frac{\\beta - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}},$$\n其中下标 $\\mathrm{f}$ 和 $\\mathrm{ox}$ 分别表示在纯燃料流和纯氧化剂流中评估的属性。化学计量混合分数 $Z_{\\mathrm{st}}$ 由化学计量时的元素平衡定义，这意味着 $\\beta(Z_{\\mathrm{st}}) = 0$。\n\n使用给定的氧化剂成分 $Y_{\\mathrm{O_2}}$ 和所述的燃料流条件，计算此甲烷-空气系统的 $Z_{\\mathrm{st}}$。然后，通过显式的元素计算，验证 $Z = Z_{\\mathrm{st}}$ 的位置满足元素氧与完全氧化可用碳和氢所需氧气之间的平衡。将您的 $Z_{\\mathrm{st}}$ 最终值四舍五入到四位有效数字，并表示为一个无量纲数。",
            "solution": "该问题要求计算非预混甲烷小火焰的化学计量混合分数 $Z_{\\mathrm{st}}$，并随后验证在此条件下的元素平衡。分析从所提供的定义和流组分开始。\n\nBilger 混合分数的定义如下：\n$$Z \\equiv \\frac{\\beta - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}}$$\n其中 $\\beta$ 是一个守恒标量，根据元素质量分数（$Y_C, Y_H, Y_O$）和原子量（$W_C, W_H, W_O$）定义：\n$$\\beta \\equiv \\frac{Y_O}{W_O} - 2\\,\\frac{Y_C}{W_C} - \\frac{1}{2}\\,\\frac{Y_H}{W_H}$$\n下标 $\\mathrm{f}$ 和 $\\mathrm{ox}$ 分别表示纯燃料流和纯氧化剂流。化学计量条件由 $\\beta = 0$ 定义，此时可用的氧气被可用的燃料元素（碳和氢）完全消耗，形成完全燃烧产物（$\\mathrm{CO_2}$ 和 $\\mathrm{H_2O}$）。\n\n在 $Z$ 的定义中设置 $\\beta = 0$ 得到化学计量混合分数 $Z_{\\mathrm{st}}$ 的表达式：\n$$Z_{\\mathrm{st}} = \\frac{0 - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}} = \\frac{-\\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}}$$\n为了计算 $Z_{\\mathrm{st}}$，我们必须首先确定 $\\beta_{\\mathrm{f}}$ 和 $\\beta_{\\mathrm{ox}}$ 的值，这需要计算每个流中的元素质量分数。给定的原子量为 $W_C = 12$、$W_H = 1$ 和 $W_O = 16$。\n\n**1. 燃料流分析（下标 f）**\n\n燃料流是甲烷（$\\mathrm{CH_4}$）和氮气（$\\mathrm{N_2}$）的混合物，质量分数为 $Y_{\\mathrm{CH_4, f}} = 0.90$ 和 $Y_{\\mathrm{N_2, f}} = 0.10$。\n甲烷的摩尔质量为 $W_{\\mathrm{CH_4}} = W_C + 4W_H = 12 + 4(1) = 16$。\n燃料流中的元素质量分数为：\n- 碳（来自 $\\mathrm{CH_4}$）：$Y_{C,f} = Y_{\\mathrm{CH_4, f}} \\times \\frac{W_C}{W_{\\mathrm{CH_4}}} = 0.90 \\times \\frac{12}{16} = 0.90 \\times 0.75 = 0.675$。\n- 氢（来自 $\\mathrm{CH_4}$）：$Y_{H,f} = Y_{\\mathrm{CH_4, f}} \\times \\frac{4W_H}{W_{\\mathrm{CH_4}}} = 0.90 \\times \\frac{4}{16} = 0.90 \\times 0.25 = 0.225$。\n- 氧：$Y_{O,f} = 0$，因为燃料流中没有含氧物质。\n\n现在，我们计算 $\\beta_{\\mathrm{f}}$：\n$$\\beta_{\\mathrm{f}} = \\frac{Y_{O,f}}{W_O} - 2\\,\\frac{Y_{C,f}}{W_C} - \\frac{1}{2}\\,\\frac{Y_{H,f}}{W_H} = \\frac{0}{16} - 2\\,\\frac{0.675}{12} - \\frac{1}{2}\\,\\frac{0.225}{1} = 0 - 0.1125 - 0.1125 = -0.225$$\n以分数形式表示，$\\beta_{\\mathrm{f}} = -\\frac{9}{40}$。\n\n**2. 氧化剂流分析（下标 ox）**\n\n氧化剂流包含氧气（$\\mathrm{O_2}$）、水蒸气（$\\mathrm{H_2O}$）和氮气（$\\mathrm{N_2}$），质量分数为 $Y_{\\mathrm{O_2, ox}} = 0.23$ 和 $Y_{\\mathrm{H_2O, ox}} = 0.03$。\n氮气的质量分数为 $Y_{\\mathrm{N_2, ox}} = 1 - Y_{\\mathrm{O_2, ox}} - Y_{\\mathrm{H_2O, ox}} = 1 - 0.23 - 0.03 = 0.74$。\n水的摩尔质量为 $W_{\\mathrm{H_2O}} = 2W_H + W_O = 2(1) + 16 = 18$。\n氧化剂流中的元素质量分数为：\n- 碳：$Y_{C,ox} = 0$。\n- 氢（来自 $\\mathrm{H_2O}$）：$Y_{H,ox} = Y_{\\mathrm{H_2O, ox}} \\times \\frac{2W_H}{W_{\\mathrm{H_2O}}} = 0.03 \\times \\frac{2}{18} = \\frac{0.06}{18} = \\frac{1}{300}$。\n- 氧（来自 $\\mathrm{O_2}$ 和 $\\mathrm{H_2O}$）：$Y_{O,ox} = Y_{\\mathrm{O_2, ox}} + Y_{\\mathrm{H_2O, ox}} \\times \\frac{W_O}{W_{\\mathrm{H_2O}}} = 0.23 + 0.03 \\times \\frac{16}{18} = \\frac{23}{100} + \\frac{3}{100} \\times \\frac{16}{18} = \\frac{23}{100} + \\frac{48}{1800} = \\frac{23}{100} + \\frac{4}{150} = \\frac{69+8}{300} = \\frac{77}{300}$。\n\n现在，我们计算 $\\beta_{\\mathrm{ox}}$：\n$$\\beta_{\\mathrm{ox}} = \\frac{Y_{O,ox}}{W_O} - 2\\,\\frac{Y_{C,ox}}{W_C} - \\frac{1}{2}\\,\\frac{Y_{H,ox}}{W_H} = \\frac{77/300}{16} - 2\\,\\frac{0}{12} - \\frac{1}{2}\\,\\frac{1/300}{1} = \\frac{77}{4800} - \\frac{1}{600} = \\frac{77 - 8}{4800} = \\frac{69}{4800} = \\frac{23}{1600}$$\n\n**3. 化学计量混合分数 $Z_{\\mathrm{st}}$ 的计算**\n\n已知 $\\beta_{\\mathrm{f}} = -9/40$ 和 $\\beta_{\\mathrm{ox}} = 23/1600$，我们可以计算 $Z_{\\mathrm{st}}$：\n$$Z_{\\mathrm{st}} = \\frac{-\\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}} = \\frac{-(23/1600)}{(-9/40) - (23/1600)} = \\frac{-23/1600}{(-360/1600) - (23/1600)} = \\frac{-23/1600}{-383/1600} = \\frac{23}{383}$$\n数值上，这是 $Z_{\\mathrm{st}} \\approx 0.060052219...$。\n四舍五入到四位有效数字，我们得到 $Z_{\\mathrm{st}} = 0.06005$。\n\n**4. 化学计量下元素平衡的验证**\n\n问题要求验证在 $Z = Z_{\\mathrm{st}}$ 时，可用元素氧的质量分数 $Y_O(Z_{\\mathrm{st}})$ 等于完全氧化可用碳和氢所需的氧质量分数 $Y_{O,req}(Z_{\\mathrm{st}})$。\n\n化学计量氧化反应为 $\\mathrm{C} + \\mathrm{O_2} \\rightarrow \\mathrm{CO_2}$ 和 $2\\mathrm{H_2} + \\mathrm{O_2} \\rightarrow 2\\mathrm{H_2O}$。在质量基础上，$W_C$ 单位的碳需要 $2W_O$ 单位的氧气，$2W_H$ 单位的氢需要 $W_O$ 单位的氧气。\n因此，所需的氧质量分数为：\n$$Y_{O,req} = Y_C \\left(\\frac{2W_O}{W_C}\\right) + Y_H \\left(\\frac{W_O}{2W_H}\\right) = Y_C \\left(\\frac{2 \\times 16}{12}\\right) + Y_H \\left(\\frac{16}{2 \\times 1}\\right) = \\frac{8}{3}Y_C + 8Y_H$$\n在任意点 $Z$ 的元素质量分数可以通过在燃料流和氧化剂流之间进行线性插值得到：$Y_k(Z) = ZY_{k,f} + (1-Z)Y_{k,ox}$。\n在 $Z_{\\mathrm{st}} = 23/383$ 时：\n- $Y_C(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{C,f} + \\frac{360}{383} Y_{C,ox} = \\frac{23}{383}(0.675) + 0 = \\frac{23}{383} \\frac{27}{40} = \\frac{621}{15320}$。\n- $Y_H(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{H,f} + \\frac{360}{383} Y_{H,ox} = \\frac{23}{383}(0.225) + \\frac{360}{383}\\left(\\frac{1}{300}\\right) = \\frac{23}{383}\\frac{9}{40} + \\frac{360}{114900} = \\frac{207}{15320} + \\frac{48}{15320} = \\frac{255}{15320}$。\n- $Y_O(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{O,f} + \\frac{360}{383} Y_{O,ox} = 0 + \\frac{360}{383}\\left(\\frac{77}{300}\\right) = \\frac{360 \\times 77}{383 \\times 300} = \\frac{1.2 \\times 77}{383} = \\frac{92.4}{383} = \\frac{924}{3830} = \\frac{462}{1915}$。为了统一分母，这等于 $\\frac{3696}{15320}$。\n\n现在我们检查是否 $Y_O(Z_{\\mathrm{st}}) = Y_{O,req}(Z_{\\mathrm{st}})$。\n可用氧为 $Y_{O,available} = Y_O(Z_{\\mathrm{st}}) = \\frac{3696}{15320}$。\n所需氧为：\n$$Y_{O,req}(Z_{\\mathrm{st}}) = \\frac{8}{3}Y_C(Z_{\\mathrm{st}}) + 8Y_H(Z_{\\mathrm{st}}) = \\frac{8}{3}\\left(\\frac{621}{15320}\\right) + 8\\left(\\frac{255}{15320}\\right)$$\n$$Y_{O,req}(Z_{\\mathrm{st}}) = \\frac{8 \\times 207}{15320} + \\frac{2040}{15320} = \\frac{1656 + 2040}{15320} = \\frac{3696}{15320}$$\n由于 $Y_{O,available} = Y_{O,req}$，元素平衡得到满足，从而验证了计算结果。从条件 $\\beta=0$ 推导 $Z_{\\mathrm{st}}$ 本身就保证了这种平衡，而这个显式计算证实了其正确性。\n化学计量混合分数的最终值，四舍五入到四位有效数字，为 $0.06005$。",
            "answer": "$$\\boxed{0.06005}$$"
        },
        {
            "introduction": "火焰的温度和稳定性取决于化学反应生热与热量耗散（如扩散和辐射）之间的精妙平衡。这一平衡关系在火焰面理论中通过经典的“S曲线”来描述，它揭示了火焰存在点燃、稳定燃烧和熄火等多种状态。本练习将引导你通过编程求解一个包含热损失的火焰面能量平衡方程，从而计算出最高火焰温度，并直观地理解耗散率和热损失如何决定火焰的最终状态 。",
            "id": "4026206",
            "problem": "要求您形式化并计算热损失对稳定非预混小火焰最高温度的影响，并更新相应的标量耗散率-温度曲线（“S形曲线”）。此任务必须完全在混合分数形式体系中完成，并采用科学上一致的闭合假设。解决方案必须作为一个完整的、可运行的程序来实现。\n\n从混合分数坐标 $Z$ 中针对单位刘易斯数小火焰的稳态小火焰能量方程开始：\n$$\n\\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + \\dot{q}_{\\mathrm{reac}}(T,Z) - q_{\\mathrm{rad}}(Z) = 0,\n$$\n其中 $\\rho$ 是密度，$c_p$ 是定压比热，$\\chi(Z)$ 是标量耗散率，$T$ 是温度，$\\dot{q}_{\\mathrm{reac}}(T,Z)$ 是体积放热率，而 $q_{\\mathrm{rad}}(Z)$ 是体积辐射热损失剖面。\n\n假设以下具有科学依据的建模闭合和定义：\n- 峰值温度出现在化学计量混合分数 $Z_{\\mathrm{st}}$ 附近。\n- 在 $Z_{\\mathrm{st}}$ 附近，扩散汇可以通过一个线性化的曲率模型来近似：\n$$\nS_{\\mathrm{diff}}(T) \\approx \\rho c_p \\chi_{\\mathrm{st}} \\left(T - T_u\\right),\n$$\n其中 $\\chi_{\\mathrm{st}}$ 是在 $Z_{\\mathrm{st}}$ 处计算的标量耗散率，$T_u$ 是未燃参考温度。\n- 辐射损失剖面 $q_{\\mathrm{rad}}(Z)$ 是预设的，并在所有 $Z$ 处充当一个汇。特别地，在 $Z_{\\mathrm{st}}$ 处，它提供了局部辐射汇 $q_{\\mathrm{rad}}(Z_{\\mathrm{st}})$。\n- 在 $Z_{\\mathrm{st}}$ 处的放热率由单步阿伦尼乌斯形式建模：\n$$\n\\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right),\n$$\n其中 $Q_{\\mathrm{heat}}$ 是反应混合物单位质量的反应热，$A$ 是指前因子，$E$ 是活化能，$R$ 是普适气体常数，$T_{\\mathrm{eff}}$ 是出现在反应速率中的有效温度。\n- 焓亏 $h_{\\mathrm{def}}$ 以缺失的显焓来解释外部热损失，使得源项中的反应温度发生如下偏移：\n$$\nT_{\\mathrm{eff}} = T - \\frac{h_{\\mathrm{def}}}{c_p}。\n$$\n\n使用这些假设，在 $Z_{\\mathrm{st}}$ 处的峰值小火焰温度 $T_{\\max}$ 通过在温度最大值处的稳态平衡的最大物理可行根得到。这导致一个关于 $T$ 的隐式标量方程，其解集通常可以是多值的（反映了经典的S形曲线结构）。您的程序必须在物理上合理的温度区间内稳健地识别所有根，并选择 $T_{\\max}$ 作为最大的根。如果不存在根，则设置 $T_{\\max} = T_u$。\n\n要使用的数值常数和单位：\n- $\\rho = 1.2$ 单位 $\\mathrm{kg/m^3}$，\n- $c_p = 1000$ 单位 $\\mathrm{J/(kg\\cdot K)}$，\n- $T_u = 300$ 单位 $\\mathrm{K}$，\n- $Q_{\\mathrm{heat}} = 3.0\\times 10^{7}$ 单位 $\\mathrm{J/kg}$，\n- $A = 5000$ 单位 $\\mathrm{s^{-1}}$，\n- $E = 1.5\\times 10^{5}$ 单位 $\\mathrm{J/mol}$，\n- $R = 8.314$ 单位 $\\mathrm{J/(mol\\cdot K)}$，\n- $Z_{\\mathrm{st}} = 0.055$ (无量纲混合分数)，\n- 对于辐射损失剖面，使用高斯形式\n$$\nq_{\\mathrm{rad}}(Z) = q_0 \\exp\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right),\n$$\n其中给定的振幅 $q_0$ 单位为 $\\mathrm{W/m^3}$，宽度 $\\sigma$ 为无量纲。\n\n要求输出：\n- 对于每个给定的测试用例，计算更新后的最大小火焰温度 $T_{\\max}$（以开尔文为单位）。\n- 以 $\\mathrm{K}$ 为单位表示每个 $T_{\\max}$，格式化到三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，\"[result1,result2,...]\"）。\n\n测试套件：\n为以下参数集提供结果。每个测试用例是一个描述 $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0, \\sigma)$ 的元组，其中 $h_{\\mathrm{def}}$ 的单位是 $\\mathrm{J/kg}$，$q_0$ 的单位是 $\\mathrm{W/m^3}$，$\\sigma$ 是无量纲的。如果 $h_{\\mathrm{def}} > 0$，则应用它；否则设置 $h_{\\mathrm{def}} = 0$。如果 $q_0 > 0$，则使用指定的高斯 $q_{\\mathrm{rad}}(Z)$；否则设置 $q_{\\mathrm{rad}}(Z) \\equiv 0$。\n- 用例 1 (绝热基准情况，理想路径): $(10.0, 0.0, 0.0, 0.01)$\n- 用例 2 (中等焓亏): $(10.0, 1.0\\times 10^{5}, 0.0, 0.01)$\n- 用例 3 (化学计量比处的辐射高斯损失): $(10.0, 0.0, 1.5\\times 10^{7}, 0.02)$\n- 用例 4 (高标量耗散，绝热): $(80.0, 0.0, 0.0, 0.01)$\n- 用例 5 (高标量耗散伴随辐射损失): $(80.0, 0.0, 2.0\\times 10^{7}, 0.02)$\n- 用例 6 (强焓亏，可能熄火): $(80.0, 5.0\\times 10^{5}, 0.0, 0.01)$\n\n角度单位不适用于此问题。不使用百分比。\n\n实现约束：\n- 最终答案必须是一个完整的、可运行的程序。\n- 程序不得要求用户输入。\n- 程序必须在 $[T_u, 3500\\,\\mathrm{K}]$ 区间内识别隐式稳态平衡的所有实数根，并选择 $T_{\\max}$ 作为最大的根。如果不存在根，则设置 $T_{\\max} = T_u$。\n- 最终输出必须是打印所有六个测试用例的 $T_{\\max}$ 列表的单行，以开尔文为单位，每个都格式化到三位小数。",
            "solution": "用户提供了一个成功通过验证阶段的问题陈述。\n\n### 第1步：提取给定条件\n- **控制方程**：针对单位刘易斯数的混合分数 $Z$ 坐标系下的稳态小火焰能量方程为：\n$$\n\\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + \\dot{q}_{\\mathrm{reac}}(T,Z) - q_{\\mathrm{rad}}(Z) = 0\n$$\n- **$Z_{\\mathrm{st}}$ 处的扩散汇模型**：扩散项在峰值温度位置被建模为线性汇：\n$$\nS_{\\mathrm{diff}}(T) \\approx \\rho c_p \\chi_{\\mathrm{st}} \\left(T - T_u\\right)\n$$\n- **$Z_{\\mathrm{st}}$ 处的放热率模型**：假设采用单步阿伦尼乌斯形式：\n$$\n\\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right)\n$$\n- **有效温度定义**：反应项中的温度根据焓亏 $h_{\\mathrm{def}}$ 进行调整：\n$$\nT_{\\mathrm{eff}} = T - \\frac{h_{\\mathrm{def}}}{c_p}\n$$\n- **辐射损失模型**：给定一个高斯剖面：\n$$\nq_{\\mathrm{rad}}(Z) = q_0 \\exp\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right)\n$$\n- **数值常数**：\n  - $\\rho = 1.2 \\, \\mathrm{kg/m^3}$\n  - $c_p = 1000 \\, \\mathrm{J/(kg\\cdot K)}$\n  - $T_u = 300 \\, \\mathrm{K}$\n  - $Q_{\\mathrm{heat}} = 3.0\\times 10^{7} \\, \\mathrm{J/kg}$\n  - $A = 5000 \\, \\mathrm{s^{-1}}$\n  - $E = 1.5\\times 10^{5} \\, \\mathrm{J/mol}$\n  - $R = 8.314 \\, \\mathrm{J/(mol\\cdot K)}$\n  - $Z_{\\mathrm{st}} = 0.055$\n- **测试用例**：六个 $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0, \\sigma)$ 元组。\n  - 用例 1: $(10.0, 0.0, 0.0, 0.01)$\n  - 用例 2: $(10.0, 1.0\\times 10^{5}, 0.0, 0.01)$\n  - 用例 3: $(10.0, 0.0, 1.5\\times 10^{7}, 0.02)$\n  - 用例 4: $(80.0, 0.0, 0.0, 0.01)$\n  - 用例 5: $(80.0, 0.0, 2.0\\times 10^{7}, 0.02)$\n  - 用例 6: $(80.0, 5.0\\times 10^{5}, 0.0, 0.01)$\n- **约束**：\n  - 如果 $h_{\\mathrm{def}} \\le 0$，则取为 $0$。\n  - 如果 $q_0 \\le 0$，则辐射损失 $q_{\\mathrm{rad}}(Z)$ 取为 $0$。\n  - 必须在区间 $[T_u, 3500\\,\\mathrm{K}]$ 内找到根。\n  - $T_{\\max}$ 是最大的根；如果没有根存在，则 $T_{\\max} = T_u$。\n\n### 第2步：使用提取的给定条件进行验证\n该问题具有科学依据，依赖于已建立的小火焰理论和简化但基于物理的反应动力学和输运模型。模型和常数在量纲上一致且物理上合理。问题是适定的：它要求找到一个明确定义的非线性标量方程的根，并提供了选择解的清晰规则。语言客观，要求具体。因此，该问题被认为是**有效的**。\n\n### 第3步：结论与行动\n问题是有效的。将提供完整的解决方案。\n\n### 求解推导\n目标是通过在化学计量混合分数 $Z_{\\mathrm{st}}$（假定温度在此处达到峰值）处建立稳态能量平衡来确定最大小火焰温度 $T_{\\max}$。在此峰值处，化学反应产生的热量必须与通过扩散和辐射散失到环境的热量相平衡。\n\n将稳态能量控制方程重新排列以表示此平衡：\n$$\n\\dot{q}_{\\mathrm{reac}}(T,Z) = - \\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + q_{\\mathrm{rad}}(Z)\n$$\n在最高温度 $T = T_{\\max}$ 的位置（假定在 $Z = Z_{\\mathrm{st}}$），左侧是热源，右侧代表热汇。问题为这些项提供了具体模型。\n\n1.  **热源项**：放热率由阿伦尼乌斯表达式给出，使用有效温度 $T_{\\mathrm{eff}}$ 进行计算，该温度通过焓亏 $h_{\\mathrm{def}}$ 考虑了非绝热性：\n    $$\n    \\text{Source}(T) = \\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right)\n    $$\n    其中 $T_{\\mathrm{eff}} = T - h_{\\mathrm{def}}/c_p$。请注意，该项仅在温度 $T  h_{\\mathrm{def}}/c_p$ 时具有物理意义。\n\n2.  **热汇项**：总汇是扩散损失和辐射损失之和。\n    - 扩散汇代表从反应区传走的热量，模型为：\n    $$\n    S_{\\mathrm{diff}}(T) = \\rho c_p \\chi_{\\mathrm{st}} (T - T_u)\n    $$\n    该项随着温度高于未燃参考温度 $T_u$ 的温差线性增加。\n    - 在 $Z=Z_{\\mathrm{st}}$ 处的辐射汇，根据给定的高斯剖面，就是其峰值：\n    $$\n    q_{\\mathrm{rad}}(Z_{\\mathrm{st}}) = q_0 \\exp\\left(-\\frac{(Z_{\\mathrm{st}} - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right) = q_0\n    $$\n\n在 $T = T_{\\max}$ 处使源项和汇项相等，得到关于 $T$ 的以下隐式方程：\n$$\n\\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R (T - h_{\\mathrm{def}}/c_p)}\\right) = \\rho c_p \\chi_{\\mathrm{st}} (T - T_u) + q_0\n$$\n为了找到稳态温度，我们必须找到函数 $f(T)$ 的根：\n$$\nf(T) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R (T - h_{\\mathrm{def}}/c_p)}\\right) - \\left( \\rho c_p \\chi_{\\mathrm{st}} (T - T_u) + q_0 \\right) = 0\n$$\n该方程的根对应于产热曲线（一条S形曲线）和散热曲线（一条直线）的交点。在物理域内可以有零个、一个、两个或三个根。这些根中最大的一个对应于稳定的高温燃烧解，我们将其确定为 $T_{\\max}$。最小的根通常对应于接近 $T_u$ 的稳定非燃烧状态，而中间的根（如果存在）是不稳定的。\n\n### 数值求解策略\n该解决方案通过开发一个程序来找到在指定的物理区间 $[T_u, 3500\\,\\mathrm{K}]$ 内 $f(T)=0$ 的所有实数根来实现。\n\n1.  对于每个测试用例，使用参数 $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0)$ 来定义函数 $f(T)$ 的具体实例。应用关于非正 $h_{\\mathrm{def}}$ 和 $q_0$ 的条件。\n2.  建立搜索的物理域。阿伦尼乌斯项仅在 $T  T_{shift}$ 时有定义，其中 $T_{shift} = h_{\\mathrm{def}}/c_p$。因此，在区间 $[\\max(T_u, T_{shift} + \\delta), 3500\\,\\mathrm{K}]$ 内进行根的搜索，其中 $\\delta$ 是一个小的正值，以避免在 $T=T_{shift}$ 处的极点。\n3.  采用稳健的求根算法。将搜索区间离散化为一个精细的网格。通过检查相邻网格点之间 $f(T)$ 的符号变化，我们可以识别出保证包含根的子区间（根据介值定理）。\n4.  对于每个这样的子区间 $[T_i, T_{i+1}]$，其中 $f(T_i) \\cdot f(T_{i+1})  0$，使用数值求解器 `scipy.optimize.brentq` 来找到根的精确位置。\n5.  收集所有找到的根。然后，最大温度 $T_{\\max}$ 是这些根中的最大值。\n6.  如果在有效搜索域内没有找到根，这表示热损失太大，无法维持稳定的火焰（熄火）。在这种情况下，根据问题的指示，将温度设置为未燃温度 $T_{\\max} = T_u$。\n7.  对所有六个测试用例重复此过程，并根据指定的输出格式格式化和打印结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the maximum flamelet temperature for several cases by solving the\n    steady-state energy balance equation for a non-premixed flamelet.\n    \"\"\"\n    \n    # Define physical and chemical constants\n    RHO = 1.2        # Density in kg/m^3\n    CP = 1000.0      # Specific heat in J/(kg*K)\n    TU = 300.0       # Unburned temperature in K\n    Q_HEAT = 3.0e7   # Heat of reaction in J/kg\n    A = 5000.0       # Pre-exponential factor in 1/s\n    E = 1.5e5        # Activation energy in J/mol\n    R = 8.314        # Universal gas constant in J/(mol*K)\n\n    # Define the test suite\n    # Each case is a tuple: (chi_st, h_def, q0, sigma)\n    test_cases = [\n        (10.0, 0.0, 0.0, 0.01),\n        (10.0, 1.0e5, 0.0, 0.01),\n        (10.0, 0.0, 1.5e7, 0.02),\n        (80.0, 0.0, 0.0, 0.01),\n        (80.0, 0.0, 2.0e7, 0.02),\n        (80.0, 5.0e5, 0.0, 0.01),\n    ]\n\n    results = []\n    \n    # Define the search interval for temperature roots\n    T_min_search = TU\n    T_max_search = 3500.0\n    N_grid = 20000  # Number of grid points for root bracketing\n\n    for case in test_cases:\n        chi_st, h_def, q0, sigma = case\n        \n        # Apply conditional logic for h_def and q0 as per problem statement\n        if h_def = 0:\n            h_def = 0.0\n        if q0 = 0:\n            q0 = 0.0\n\n        # Calculate the temperature shift due to enthalpy defect\n        T_shift = h_def / CP\n\n        def f(T):\n            \"\"\"\n            Represents the energy balance equation f(T) = source - sink = 0.\n            The roots of this function are the steady-state temperatures.\n            \"\"\"\n            # The reaction term is undefined for T = T_shift\n            if T = T_shift:\n                # Return a large negative value to prevent finding false roots in this region.\n                # The loss term is typically positive, so their difference is negative.\n                return -1e12\n\n            T_eff = T - T_shift\n            \n            # Heat release source term (W/m^3)\n            # Use a try-except block to handle potential overflow from np.exp\n            try:\n                q_reac = RHO * Q_HEAT * A * np.exp(-E / (R * T_eff))\n            except OverflowError:\n                q_reac = np.inf\n            \n            # Heat loss sink term (W/m^3)\n            q_loss = RHO * CP * chi_st * (T - TU) + q0\n            \n            return q_reac - q_loss\n\n        roots = []\n        \n        # Determine the valid search start temperature, avoiding the pole\n        T_start = max(T_min_search, T_shift + 1e-9)\n        \n        if T_start >= T_max_search:\n            # If the entire search range is invalid, no roots can exist\n            T_max = TU\n        else:\n            # Create a grid over the valid search interval\n            T_grid = np.linspace(T_start, T_max_search, N_grid)\n            \n            # Evaluate the function on the grid\n            f_grid = np.array([f(t) for t in T_grid])\n            \n            # Find intervals where a root exists (sign change)\n            for i in range(len(T_grid) - 1):\n                if np.sign(f_grid[i]) != np.sign(f_grid[i+1]):\n                    # A root is bracketed, find it precisely using brentq\n                    try:\n                        root = brentq(f, T_grid[i], T_grid[i+1])\n                        roots.append(root)\n                    except (ValueError, RuntimeError):\n                        # brentq might fail in edge cases, skip if so\n                        pass\n        \n            if roots:\n                # The maximum temperature is the largest root\n                T_max = max(roots)\n            else:\n                # If no roots are found, the solution is the unburned state\n                T_max = TU\n        \n        results.append(T_max)\n\n    # Format the results to three decimal places and print in the required format\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "S曲线的“拐点”具有明确的物理意义：它代表了火焰能够维持稳定燃烧的极限。当外部应变或热损失超过此临界点时，火焰将无法维持，发生熄火现象。本练习基于一个简化的火焰面模型，要求你通过寻找S曲线的数学极值点，来计算火焰的熄火应变率 $a_{\\mathrm{ext}}$，从而将抽象的理论模型与重要的工程参数直接联系起来 。",
            "id": "4026228",
            "problem": "给定一个用于层流逆流非预混火焰的简化小火焰模型，该模型基于小火焰概念、化学计量混合分数下的标量耗散率（SDR）以及全局单步阿伦尼乌斯化学反应。目标是通过定位小火焰S形曲线上的折叠点来计算熄火应变率。\n\n基本原理和建模假设：\n- 化学计量混合分数下的标量耗散率，记为 $\\chi_{\\mathrm{st}}$，表示火焰处的混合和扩散强度，对于平面驻点逆流，假设其与施加的应变率 $a$ 成正比变化。该关系建模为 $\\chi_{\\mathrm{st}}(a) = k a$，其中 $k$ 是一个由混合分数场和输运性质决定的正常数， $a$ 是应变率，单位为 $\\mathrm{s}^{-1}$。\n- 全局单步化学反应由阿伦尼乌斯速率表示，其温度依赖性由活化能和通用气体常数决定，放热控制着小火焰的温升。设 $c \\in [0,1]$ 为归一化的反应进度变量。温度建模为 $T(c) = T_u + \\beta c$，其中 $T_u$ 是未燃温度，单位为 $\\mathrm{K}$，$\\beta$ 是单位进度下的绝热温升，单位为 $\\mathrm{K}$。\n- 简化的稳态小火焰S形曲线被建模为参数化函数\n$$\n\\chi_{\\mathrm{st}}(c) = C \\exp(\\gamma c)\\,\\frac{1 - c}{1 + \\Lambda c},\n$$\n其中\n$$\nC = A \\exp\\!\\left(-\\frac{E}{R T_u}\\right), \\quad \\gamma = \\frac{E}{R}\\,\\frac{\\beta}{T_u(T_u+\\beta)},\n$$\n并且 $A$ 是指前因子，单位为 $\\mathrm{s}^{-1}$，$E$ 是活化能，单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$R$ 是通用气体常数，单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$\\Lambda \\ge 0$ 是一个无量纲热损失参数，随着 $c$ 的增加，它会增加扩散-传导损失。S形曲线的折叠点对应于 $\\chi_{\\mathrm{st}}(c)$ 在区间 $[0,1]$ 上相对于 $c$ 的最大值，这是物理上相关的转折点，用于区分自持火焰解与熄火状态。\n\n任务：\n- 使用上述模型，通过以下步骤为每个指定的参数集计算熄火应变率 $a_{\\mathrm{ext}}$：\n  1. 定位折叠点 $c^\\star \\in [0,1]$，使得 $\\chi_{\\mathrm{st}}(c^\\star)$ 是在 $c \\in [0,1]$ 上的全局最大值。\n  2. 计算相应的最大值 $\\chi_{\\mathrm{ext}} = \\chi_{\\mathrm{st}}(c^\\star)$。\n  3. 反转逆流关系以获得 $a_{\\mathrm{ext}} = \\chi_{\\mathrm{ext}} / k$，单位为 $\\mathrm{s}^{-1}$。\n\n科学真实性要求：\n- 您的推理应基于小火焰概念、反应与扩散之间的稳态平衡以及阿伦尼乌斯温度依赖性。除了所提供的定义之外，不要假定任何快捷公式；通过在 $[0,1]$ 上最大化 $\\chi_{\\mathrm{st}}(c)$ 来明确地定位折叠点。\n\n角度单位规范：不适用。\n\n物理单位规范：\n- 以浮点数形式报告熄火应变率 $a_{\\mathrm{ext}}$，单位为 $\\mathrm{s}^{-1}$。\n\n测试套件：\n- 使用以下参数集，每个参数集由元组 $(A, E, R, T_u, \\beta, \\Lambda, k)$ 定义，单位如上所述：\n  - 情况 $1$：$(A, E, R, T_u, \\beta, \\Lambda, k) = (10^{13}, 8.0\\times 10^{4}, 8.314, 300, 1200, 0.5, 50)$。\n  - 情况 $２$：$(A, E, R, T_u, \\beta, \\Lambda, k) = (5.0\\times 10^{12}, 1.2\\times 10^{5}, 8.314, 300, 1000, 0.7, 70)$。\n  - 情况 $３$：$(A, E, R, T_u, \\beta, \\Lambda, k) = (8.0\\times 10^{12}, 9.0\\times 10^{4}, 8.314, 350, 900, 3.0, 60)$。\n这些情况旨在测试：\n  - 具有中等热损失和活化能的典型“理想路径”小火焰（情况1）。\n  - 具有更高活化能和更强温度敏感性的情景（情况2）。\n  - 将最大值推向较低反应进度变量值的高热损失边界情况（情况3）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三种情况的熄火应变率，格式为方括号内的逗号分隔列表，按情况1到3的顺序排列，例如，$\\texttt{[a1,a2,a3]}$，其中每个 $a_i$ 是一个浮点数，单位为 $\\mathrm{s}^{-1}$。",
            "solution": "该问题是有效的。它在科学上基于非预混燃烧的小火焰理论，在数学上是适定的，并且所有参数和条件都得到了明确的提供。任务是通过确定代表稳态标量耗散率的给定函数的最大值来找到熄火应变率。\n\n该问题要求我们通过识别S形曲线的转折点来计算熄火应变率 $a_{\\mathrm{ext}}$，该转折点对应于化学计量条件下标量耗散率 $\\chi_{\\mathrm{st}}$ 的最大值。这个最大值 $\\chi_{\\mathrm{ext}}$ 通过假定的线性关系 $a_{\\mathrm{ext}} = \\chi_{\\mathrm{ext}} / k$ 与熄火应变率相关。\n\nS形曲线的控制方程以反应进度变量 $c \\in [0,1]$ 的参数函数形式给出：\n$$\n\\chi_{\\mathrm{st}}(c) = C \\exp(\\gamma c)\\,\\frac{1 - c}{1 + \\Lambda c}\n$$\n其中常数 $C$ 和 $\\gamma$ 定义为：\n$$\nC = A \\exp\\!\\left(-\\frac{E}{R T_u}\\right), \\quad \\gamma = \\frac{E}{R}\\,\\frac{\\beta}{T_u(T_u+\\beta)}\n$$\n为了找到 $\\chi_{\\mathrm{st}}(c)$ 在区间 $c \\in [0,1]$ 上的最大值，我们必须通过将其关于 $c$ 的导数设为零来找到临界点。在分析上，处理 $\\chi_{\\mathrm{st}}(c)$ 的自然对数更为方便，因为对于 $\\chi_{\\mathrm{st}}(c) > 0$，其导数的根与 $\\chi_{\\mathrm{st}}(c)$ 导数的根相同。设 $f(c) = \\ln(\\chi_{\\mathrm{st}}(c))$：\n$$\nf(c) = \\ln(C) + \\gamma c + \\ln(1 - c) - \\ln(1 + \\Lambda c)\n$$\n对 $c$ 求导可得：\n$$\n\\frac{df}{dc} = \\gamma - \\frac{1}{1 - c} - \\frac{\\Lambda}{1 + \\Lambda c}\n$$\n将导数设为零，$\\frac{df}{dc} = 0$，得到临界点 $c^\\star$ 的条件：\n$$\n\\gamma = \\frac{1}{1 - c^\\star} + \\frac{\\Lambda}{1 + \\Lambda c^\\star}\n$$\n我们来分析这个方程的右侧。设 $g(c) = \\frac{1}{1 - c} + \\frac{\\Lambda}{1 + \\Lambda c}$。它在 $c=0$ 处的值是 $g(0) = 1 + \\Lambda$。其导数为 $g'(c) = \\frac{1}{(1 - c)^2} + \\frac{\\Lambda^2}{(1 + \\Lambda c)^2}$，对于 $c \\in [0,1)$，该导数是严格为正的。因此，$g(c)$ 在 $[0,1)$ 上是一个单调递增函数，从 $g(0)=1+\\Lambda$ 开始，并在 $c \\to 1^-$ 时趋近于 $+\\infty$。\n方程 $\\gamma = g(c)$ 在 $(0,1)$ 内有解 $c^\\star$ 的充要条件是 $\\gamma > g(0)$，即条件 $\\gamma > 1+\\Lambda$。\n如果 $\\gamma \\le 1+\\Lambda$，则对于所有 $c \\in [0,1)$，都有 $\\gamma - g(c) \\le 0$，这意味着 $\\frac{d\\chi_{\\mathrm{st}}}{dc} \\le 0$。该函数是单调递减的，其在 $[0,1]$ 上的最大值出现在边界 $c=0$ 处。在这种情况下，$c^\\star = 0$。\n\n如果 $\\gamma > 1+\\Lambda$，则存在一个唯一的内部最大值点 $c^\\star \\in (0,1)$。为了找到它，我们将条件 $\\gamma = g(c^\\star)$ 重新整理成关于 $c^\\star$ 的多项式方程：\n$$\n\\gamma = \\frac{(1 + \\Lambda c^\\star) + \\Lambda(1 - c^\\star)}{(1 - c^\\star)(1 + \\Lambda c^\\star)} = \\frac{1+\\Lambda}{1 + (\\Lambda-1)c^\\star - \\Lambda (c^\\star)^2}\n$$\n$$\n\\gamma (1 + (\\Lambda-1)c^\\star - \\Lambda (c^\\star)^2) = 1+\\Lambda\n$$\n整理成标准二次方程形式 $a_q(c^\\star)^2 + b_q c^\\star + c_q = 0$：\n$$\n\\gamma\\Lambda (c^\\star)^2 - \\gamma(\\Lambda-1)c^\\star + (1+\\Lambda - \\gamma) = 0\n$$\n或\n$$\n\\gamma\\Lambda (c^\\star)^2 + \\gamma(1-\\Lambda)c^\\star + (1+\\Lambda - \\gamma) = 0\n$$\n这个二次方程可以求解 $c^\\star$。系数为 $a_q = \\gamma\\Lambda$，$b_q = \\gamma(1-\\Lambda)$ 和 $c_q = 1+\\Lambda-\\gamma$。因为 $\\gamma > 1+\\Lambda$，所以 $c_q$ 是负的。两根之积 $c_q/a_q$ 为负，意味着一个根是正的，另一个是负的。具有物理意义的解必须是正根，由下式给出：\n$$\nc^\\star = \\frac{-b_q + \\sqrt{b_q^2 - 4 a_q c_q}}{2 a_q}\n$$\n一旦确定了 $c^\\star$（无论是0还是二次方程的解），就可以通过将 $c^\\star$ 代入原始函数来计算熄火标量耗散率 $\\chi_{\\mathrm{ext}}$：\n$$\n\\chi_{\\mathrm{ext}} = \\chi_{\\mathrm{st}}(c^\\star) = C \\exp(\\gamma c^\\star)\\,\\frac{1 - c^\\star}{1 + \\Lambda c^\\star}\n$$\n最后，通过反转逆流关系找到熄火应变率 $a_{\\mathrm{ext}}$：\n$$\na_{\\mathrm{ext}} = \\frac{\\chi_{\\mathrm{ext}}}{k}\n$$\n每个测试用例的计算过程如下：\n1.  根据给定的参数 $E, R, T_u, \\beta$ 计算 $\\gamma$。\n2.  将 $\\gamma$ 与 $1+\\Lambda$ 进行比较。\n3.  如果 $\\gamma > 1+\\Lambda$，求解二次方程得到正根 $c^\\star \\in (0,1)$。\n4.  如果 $\\gamma \\le 1+\\Lambda$，则设 $c^\\star = 0$。\n5.  计算 $C = A \\exp(-E/(RT_u))$。\n6.  计算 $\\chi_{\\mathrm{ext}} = \\chi_{\\mathrm{st}}(c^\\star)$。\n7.  计算 $a_{\\mathrm{ext}} = \\chi_{\\mathrm{ext}} / k$。\n此过程将应用于所提供的三个参数集中的每一个。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the extinction strain rate for a reduced flamelet model.\n    The solution involves finding the maximum of the scalar dissipation rate function chi_st(c)\n    by solving for the critical point where its derivative is zero, which leads to a\n    quadratic equation for the progress variable c.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: (A, E, R, Tu, beta, Lambda, k)\n        (1.0e13, 8.0e4, 8.314, 300, 1200, 0.5, 50),\n        # Case 2:\n        (5.0e12, 1.2e5, 8.314, 300, 1000, 0.7, 70),\n        # Case 3:\n        (8.0e12, 9.0e4, 8.314, 350, 900, 3.0, 60),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, E, R, Tu, beta, Lambda, k = case\n\n        # Calculate the dimensionless parameter gamma\n        # gamma = (E/R) * (beta / (Tu * (Tu + beta)))\n        gamma = (E / R) * (beta / (Tu * (Tu + beta)))\n\n        # Determine the progress variable at the fold point, c_star.\n        # A fold point c_star in (0, 1) exists if and only if gamma  1 + Lambda.\n        # If this condition is not met, the maximum of chi_st(c) occurs at c = 0.\n        if gamma > 1.0 + Lambda:\n            # Solve the quadratic equation for c_star:\n            # aq*c^2 + bq*c + cq = 0\n            aq = gamma * Lambda\n            bq = gamma * (1.0 - Lambda)\n            cq = 1.0 + Lambda - gamma\n\n            # The discriminant of the quadratic equation\n            discriminant = bq**2 - 4.0 * aq * cq\n\n            # The product of roots cq/aq is negative, so one root is positive and one is negative.\n            # We take the positive root, which corresponds to the physical solution.\n            c_star = (-bq + np.sqrt(discriminant)) / (2.0 * aq)\n        else:\n            # If gamma = 1 + Lambda, the function is monotonically decreasing,\n            # so the maximum is at c = 0.\n            c_star = 0.0\n\n        # Calculate the pre-exponential constant C for the chi_st equation\n        C = A * np.exp(-E / (R * Tu))\n\n        # Calculate the extinction scalar dissipation rate chi_ext\n        if c_star == 0.0:\n            # At c=0, chi_st(0) = C\n            chi_ext = C\n        else:\n            # For c_star  0, use the full expression\n            chi_ext = C * np.exp(gamma * c_star) * ((1.0 - c_star) / (1.0 + Lambda * c_star))\n\n        # Calculate the extinction strain rate a_ext\n        a_ext = chi_ext / k\n        results.append(a_ext)\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}