{
    "hands_on_practices": [
        {
            "introduction": "在非预混燃烧中，混合分数 $Z$ 是描述混合状态和火焰结构的主坐标。化学计量混合分数 $Z_{st}$ 是一个尤为关键的参数，它标记了燃料和氧化剂恰好完全反应的理论位置，即火焰锋面的核心区域。这个练习将引导你基于元素守恒的第一性原理，使用Bilger的定义来计算 $Z_{st}$，该定义对于包含惰性气体或水蒸气的复杂燃料和氧化剂混合物依然稳健。",
            "id": "4026226",
            "problem": "考虑一个由含甲烷的燃料流与潮湿的氧化剂流混合形成的稳态、层流、非预混小火焰。混合分数根据Bilger基于元素守恒（碳、氢、氧）的方法定义。设燃料流为甲烷-氮气混合物，其组分质量分数为 $Y_{\\mathrm{CH_4}} = 0.90$ 和 $Y_{\\mathrm{N_2}} = 0.10$。氧化剂流包含氧气分子、水蒸气和氮气，其组分质量分数为 $Y_{\\mathrm{O_2}} = 0.23$、$Y_{\\mathrm{H_2O}} = 0.03$ 和 $Y_{\\mathrm{N_2}} = 1 - Y_{\\mathrm{O_2}} - Y_{\\mathrm{H_2O}}$。假设在化学计量条件下完全氧化为二氧化碳和水。使用原子量 $W_C = 12$、$W_H = 1$ 和 $W_O = 16$。\n\n从元素守恒出发，定义Bilger守恒标量\n$$\\beta \\equiv \\frac{Y_O}{W_O} - 2\\,\\frac{Y_C}{W_C} - \\frac{1}{2}\\,\\frac{Y_H}{W_H},$$\n以及Bilger混合分数\n$$Z \\equiv \\frac{\\beta - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}},$$\n其中下标 $\\mathrm{f}$ 和 $\\mathrm{ox}$ 分别表示在纯燃料流和纯氧化剂流中评估的性质。化学计量混合分数 $Z_{\\mathrm{st}}$ 由化学计量下的元素平衡定义，这意味着 $\\beta(Z_{\\mathrm{st}}) = 0$。\n\n使用给定的氧化剂组分 $Y_{\\mathrm{O_2}}$ 和所述的燃料流条件，计算该甲烷-空气系统的 $Z_{\\mathrm{st}}$。然后，通过明确的元素核算，验证位置 $Z = Z_{\\mathrm{st}}$ 满足可用元素氧与完全氧化可用碳和氢所需的氧之间的平衡。将 $Z_{\\mathrm{st}}$ 的最终值四舍五入到四位有效数字，并将其表示为一个无量纲数。",
            "solution": "该问题要求计算非预混甲烷小火焰的化学计量混合分数 $Z_{\\mathrm{st}}$，并随后验证在此条件下的元素平衡。分析从给出的定义和流组分开始。\n\nBilger混合分数定义为：\n$$Z \\equiv \\frac{\\beta - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}}$$\n其中 $\\beta$ 是一个守恒标量，用元素质量分数（$Y_C, Y_H, Y_O$）和原子量（$W_C, W_H, W_O$）定义：\n$$\\beta \\equiv \\frac{Y_O}{W_O} - 2\\,\\frac{Y_C}{W_C} - \\frac{1}{2}\\,\\frac{Y_H}{W_H}$$\n下标 $\\mathrm{f}$ 和 $\\mathrm{ox}$ 分别表示纯燃料流和纯氧化剂流。化学计量条件由 $\\beta = 0$ 定义，此时可用氧恰好被可用燃料元素（碳和氢）消耗，生成完全燃烧产物（$\\mathrm{CO_2}$ 和 $\\mathrm{H_2O}$）。\n\n在 $Z$ 的定义中令 $\\beta = 0$，得到化学计量混合分数 $Z_{\\mathrm{st}}$ 的表达式：\n$$Z_{\\mathrm{st}} = \\frac{0 - \\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}} = \\frac{-\\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}}$$\n为计算 $Z_{\\mathrm{st}}$，我们必须首先确定 $\\beta_{\\mathrm{f}}$ 和 $\\beta_{\\mathrm{ox}}$ 的值，这需要计算每个流中的元素质量分数。给定的原子量为 $W_C = 12$、$W_H = 1$ 和 $W_O = 16$。\n\n**1. 燃料流分析 (下标 f)**\n\n燃料流是甲烷（$\\mathrm{CH_4}$）和氮气（$\\mathrm{N_2}$）的混合物，其质量分数为 $Y_{\\mathrm{CH_4, f}} = 0.90$ 和 $Y_{\\mathrm{N_2, f}} = 0.10$。\n甲烷的摩尔质量为 $W_{\\mathrm{CH_4}} = W_C + 4W_H = 12 + 4(1) = 16$。\n燃料流中的元素质量分数为：\n- 碳（来自 $\\mathrm{CH_4}$）：$Y_{C,f} = Y_{\\mathrm{CH_4, f}} \\times \\frac{W_C}{W_{\\mathrm{CH_4}}} = 0.90 \\times \\frac{12}{16} = 0.90 \\times 0.75 = 0.675$。\n- 氢（来自 $\\mathrm{CH_4}$）：$Y_{H,f} = Y_{\\mathrm{CH_4, f}} \\times \\frac{4W_H}{W_{\\mathrm{CH_4}}} = 0.90 \\times \\frac{4}{16} = 0.90 \\times 0.25 = 0.225$。\n- 氧：$Y_{O,f} = 0$，因为燃料流中没有含氧物质。\n\n现在，我们计算 $\\beta_{\\mathrm{f}}$：\n$$\\beta_{\\mathrm{f}} = \\frac{Y_{O,f}}{W_O} - 2\\,\\frac{Y_{C,f}}{W_C} - \\frac{1}{2}\\,\\frac{Y_{H,f}}{W_H} = \\frac{0}{16} - 2\\,\\frac{0.675}{12} - \\frac{1}{2}\\,\\frac{0.225}{1} = 0 - 0.1125 - 0.1125 = -0.225$$\n以分数形式表示，$\\beta_{\\mathrm{f}} = -\\frac{9}{40}$。\n\n**2. 氧化剂流分析 (下标 ox)**\n\n氧化剂流包含氧气（$\\mathrm{O_2}$）、水蒸气（$\\mathrm{H_2O}$）和氮气（$\\mathrm{N_2}$），其质量分数为 $Y_{\\mathrm{O_2, ox}} = 0.23$ 和 $Y_{\\mathrm{H_2O, ox}} = 0.03$。\n氮气的质量分数为 $Y_{\\mathrm{N_2, ox}} = 1 - Y_{\\mathrm{O_2, ox}} - Y_{\\mathrm{H_2O, ox}} = 1 - 0.23 - 0.03 = 0.74$。\n水的摩尔质量为 $W_{\\mathrm{H_2O}} = 2W_H + W_O = 2(1) + 16 = 18$。\n氧化剂流中的元素质量分数为：\n- 碳：$Y_{C,ox} = 0$。\n- 氢（来自 $\\mathrm{H_2O}$）：$Y_{H,ox} = Y_{\\mathrm{H_2O, ox}} \\times \\frac{2W_H}{W_{\\mathrm{H_2O}}} = 0.03 \\times \\frac{2}{18} = \\frac{0.06}{18} = \\frac{1}{300}$。\n- 氧（来自 $\\mathrm{O_2}$ 和 $\\mathrm{H_2O}$）：$Y_{O,ox} = Y_{\\mathrm{O_2, ox}} + Y_{\\mathrm{H_2O, ox}} \\times \\frac{W_O}{W_{\\mathrm{H_2O}}} = 0.23 + 0.03 \\times \\frac{16}{18} = \\frac{23}{100} + \\frac{3}{100} \\times \\frac{16}{18} = \\frac{23}{100} + \\frac{48}{1800} = \\frac{23}{100} + \\frac{4}{150} = \\frac{69+8}{300} = \\frac{77}{300}$。\n\n现在，我们计算 $\\beta_{\\mathrm{ox}}$：\n$$\\beta_{\\mathrm{ox}} = \\frac{Y_{O,ox}}{W_O} - 2\\,\\frac{Y_{C,ox}}{W_C} - \\frac{1}{2}\\,\\frac{Y_{H,ox}}{W_H} = \\frac{77/300}{16} - 2\\,\\frac{0}{12} - \\frac{1}{2}\\,\\frac{1/300}{1} = \\frac{77}{4800} - \\frac{1}{600} = \\frac{77 - 8}{4800} = \\frac{69}{4800} = \\frac{23}{1600}$$\n\n**3. 计算化学计量混合分数 $Z_{\\mathrm{st}}$**\n\n已知 $\\beta_{\\mathrm{f}} = -9/40$ 和 $\\beta_{\\mathrm{ox}} = 23/1600$，我们可以计算 $Z_{\\mathrm{st}}$：\n$$Z_{\\mathrm{st}} = \\frac{-\\beta_{\\mathrm{ox}}}{\\beta_{\\mathrm{f}} - \\beta_{\\mathrm{ox}}} = \\frac{-(23/1600)}{(-9/40) - (23/1600)} = \\frac{-23/1600}{(-360/1600) - (23/1600)} = \\frac{-23/1600}{-383/1600} = \\frac{23}{383}$$\n其数值为 $Z_{\\mathrm{st}} \\approx 0.060052219...$。\n四舍五入到四位有效数字，我们得到 $Z_{\\mathrm{st}} = 0.06005$。\n\n**4. 验证化学计量下的元素平衡**\n\n问题要求验证在 $Z = Z_{\\mathrm{st}}$ 时，可用元素氧的质量分数 $Y_O(Z_{\\mathrm{st}})$ 等于完全氧化可用碳和氢所需的氧的质量分数 $Y_{O,req}(Z_{\\mathrm{st}})$。\n\n化学计量氧化反应为 $\\mathrm{C} + \\mathrm{O_2} \\rightarrow \\mathrm{CO_2}$ 和 $2\\mathrm{H_2} + \\mathrm{O_2} \\rightarrow 2\\mathrm{H_2O}$。在质量基础上，$W_C$ 单位的碳需要 $2W_O$ 单位的氧，而 $2W_H$ 单位的氢需要 $W_O$ 单位的氧。\n因此，所需氧的质量分数为：\n$$Y_{O,req} = Y_C \\left(\\frac{2W_O}{W_C}\\right) + Y_H \\left(\\frac{W_O}{2W_H}\\right) = Y_C \\left(\\frac{2 \\times 16}{12}\\right) + Y_H \\left(\\frac{16}{2 \\times 1}\\right) = \\frac{8}{3}Y_C + 8Y_H$$\n在任意点 $Z$ 的元素质量分数通过在燃料流和氧化剂流之间进行线性插值得到：$Y_k(Z) = ZY_{k,f} + (1-Z)Y_{k,ox}$。\n在 $Z_{\\mathrm{st}} = 23/383$ 处：\n- $Y_C(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{C,f} + \\frac{360}{383} Y_{C,ox} = \\frac{23}{383}(0.675) + 0 = \\frac{23}{383} \\frac{27}{40} = \\frac{621}{15320}$。\n- $Y_H(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{H,f} + \\frac{360}{383} Y_{H,ox} = \\frac{23}{383}(0.225) + \\frac{360}{383}\\left(\\frac{1}{300}\\right) = \\frac{23}{383}\\frac{9}{40} + \\frac{360}{114900} = \\frac{207}{15320} + \\frac{48}{15320} = \\frac{255}{15320}$。\n- $Y_O(Z_{\\mathrm{st}}) = \\frac{23}{383} Y_{O,f} + \\frac{360}{383} Y_{O,ox} = 0 + \\frac{360}{383}\\left(\\frac{77}{300}\\right) = \\frac{360 \\times 77}{383 \\times 300} = \\frac{1.2 \\times 77}{383} = \\frac{92.4}{383} = \\frac{924}{3830} = \\frac{462}{1915}$。为统一分母，此值为 $\\frac{3696}{15320}$。\n\n现在我们检查是否 $Y_O(Z_{\\mathrm{st}}) = Y_{O,req}(Z_{\\mathrm{st}})$。\n可用氧为 $Y_{O,available} = Y_O(Z_{\\mathrm{st}}) = \\frac{3696}{15320}$。\n所需氧为：\n$$Y_{O,req}(Z_{\\mathrm{st}}) = \\frac{8}{3}Y_C(Z_{\\mathrm{st}}) + 8Y_H(Z_{\\mathrm{st}}) = \\frac{8}{3}\\left(\\frac{621}{15320}\\right) + 8\\left(\\frac{255}{15320}\\right)$$\n$$Y_{O,req}(Z_{\\mathrm{st}}) = \\frac{8 \\times 207}{15320} + \\frac{2040}{15320} = \\frac{1656 + 2040}{15320} = \\frac{3696}{15320}$$\n由于 $Y_{O,available} = Y_{O,req}$，元素平衡得到满足，这验证了计算结果。从条件 $\\beta=0$ 推导 $Z_{\\mathrm{st}}$ 的过程本身就保证了这种平衡，而这个明确的计算证实了其正确性。\n化学计量混合分数的最终值，四舍五入到四位有效数字，是 $0.06005$。",
            "answer": "$$\\boxed{0.06005}$$"
        },
        {
            "introduction": "火焰面模型是分析非预混湍流燃烧的有力工具，但其应用有明确的物理边界。该模型的有效性取决于湍流尺度与化学反应尺度之间存在明显的分离，即化学反应必须比最小的湍流涡更快、更薄。这个练习将帮助你运用关键的无量纲数，如丹柯勒数 ($Da$) 和卡洛维兹数 ($Ka$)，来建立对燃烧区的直观判断。通过评估这些参数，你可以确定局部条件是否支持一个薄而结构清晰的火焰面的存在。",
            "id": "4026194",
            "problem": "考虑一个统计定常、均匀且各向同性的湍流场，其中气态燃料和氧化剂混合，形成一个非预混反应区。在给定位置，您测量了以下表征湍流与化学局部相互作用的无量纲量：Damköhler数$Da$、Karlovitz数$Ka$，以及测得的局域标量厚度与Kolmogorov长度尺度的比值 $r = \\delta_{s}/\\eta$，其中$\\eta$表示Kolmogorov长度尺度，$\\delta_{s}$表示根据守恒标量（例如，混合分数）剖面估算的局域扩散-反应层厚度。这三个量均为无量纲。在该位置测得的值为 $Da = 1.8$、$Ka = 0.90$ 和 $r = 0.60$。\n\n从湍流-化学相互作用的第一性原理和核心定义出发，利用火焰面概念所要求的尺度分离思想，评估该局部状态是否与非预混火焰面假设一致。将您的结论编码为一个指示符$I$，定义为：如果局部状态与火焰面假设一致，则$I = 1$；否则$I = 0$。报告$I$的单个无量纲数值；不要包含任何单位。无需四舍五入。",
            "solution": "问题要求根据三个测得的无量纲量——Damköhler数$Da$、Karlovitz数$Ka$以及标量厚度与Kolmogorov长度尺度的比值$r$——来判断湍流非预混反应流中的一个局部状态是否与火焰面假设一致。结论需要编码为一个指示变量$I$。\n\n首先，我们必须阐明非预混火焰面概念背后的物理原理。火焰面模型假定，湍流火焰可以被看作是一系列薄的、准稳态的、一维的层流扩散火焰结构的集合。这些火焰面单元被湍流平流、拉伸和应变，但其内部的一维结构得以保持。该模型的有效性取决于一个关键的尺度分离假设。具体来说，化学反应的特征长度和时间尺度必须远小于湍流流体运动的相应尺度。\n\n我们将根据火焰面状态的必要条件来评估给定的数据。\n\n1.  **长度尺度条件：**\n    火焰面概念最基本的要求是，反应-扩散层必须比最小的湍流尺度更薄。最小的湍流长度尺度是Kolmogorov微尺度，用$\\eta$表示。反应-扩散层的厚度可以从守恒标量（如混合分数）的剖面估算得出，此处记为$\\delta_s$。为使火焰面的内部结构不受湍流涡的影响，它必须在几何上嵌入到最小的耗散结构中。这导出以下条件：\n    $$\n    \\delta_s  \\eta\n    $$\n    问题恰好提供了一个无量纲比值$r$用于评估此条件：\n    $$\n    r = \\frac{\\delta_s}{\\eta}\n    $$\n    测得的值为 $r = 0.60$。由于 $0.60  1$，条件 $\\delta_s  \\eta$ 得到满足。这提供了强有力的证据，表明反应区相对于最小的湍流涡足够薄，能够保持其结构。\n\n2.  **时间尺度条件：**\n    化学过程必须足够快，才能对湍流施加的变化做出准稳态响应。这通常通过将化学时间尺度$\\tau_c$与两种不同的湍流时间尺度进行比较来评估。\n\n    a) **与大涡时间尺度的比较：** Damköhler数$Da$比较了宏观湍流时间尺度（大涡翻转时间$\\tau_t$）与特征化学时间尺度$\\tau_c$。\n    $$\n    Da = \\frac{\\tau_t}{\\tau_c}\n    $$\n    要使化学反应相对于整个湍流混合过程被认为是“快的”，Damköhler数必须很大。进入火焰面状态的常规判据是 $Da > 1$。问题中指出测得的值为 $Da = 1.8$。由于 $1.8 > 1$，该条件得到满足。这意味着化学反应的完成速度快于一个大湍流涡扭曲火焰面的时间，从而允许火焰面结构的存在。尽管对于典型的火焰面，理想情况下期望 $Da \\gg 1$，但 $1.8$ 的值与该状态是一致的。\n\n    b) **与小涡时间尺度的比较：** Karlovitz数$Ka$比较了化学时间尺度$\\tau_c$与Kolmogorov尺度上的湍流时间尺度$\\tau_k$。\n    $$\n    Ka = \\frac{\\tau_c}{\\tau_k}\n    $$\n    这个数对于火焰面的内部结构至关重要。如果化学时间长于Kolmogorov时间（$Ka > 1$），最小的湍流涡就能穿透反应区，破坏扩散与反应之间的平衡，并可能导致火焰猝灭。因此，火焰面结构的存在要求化学过程比最小尺度上的耗散过程更快，这施加了以下条件：\n    $$\n    Ka  1\n    $$\n    测得的值为 $Ka = 0.90$。由于 $0.90  1$，这个关键条件得到满足。这表明反应层没有被最小尺度的湍流撕裂。该条件也可以从长度尺度的角度来解释，因为$Ka$与特征火焰厚度$\\delta_L$与Kolmogorov尺度$\\eta$之比的平方有关，即 $Ka \\approx (\\delta_L/\\eta)^2$。因此，$Ka  1$ 与长度尺度分离条件 $\\delta_L  \\eta$ 是一致的。\n\n**结论综合：**\n我们已经根据非预混火焰面状态的既定判据，检验了所提供的三个无量纲参数：\n-   长度尺度条件 $r = \\delta_s/\\eta  1$ 得到满足，因为 $0.60  1$。\n-   大尺度时间条件 $Da > 1$ 得到满足，因为 $1.8 > 1$。\n-   小尺度时间条件 $Ka  1$ 得到满足，因为 $0.90  1$。\n\n所有三个判据都与火焰面理论的假设一致。由给定参数表征的流场局部状态，属于非预混火焰面燃烧状态。因此，如果局部状态与火焰面假设一致，指示变量$I$定义为1，故其必须赋值为1。\n\n最终答案是指示符$I$的值。\n$$\nI = 1\n$$",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在理解了火焰面的基本参数和适用范围后，我们可以进一步模拟火焰面对其环境的响应。著名的“S形曲线”描绘了火焰温度与应变率（由标量耗散率 $\\chi_{st}$ 表示）之间的非线性关系，揭示了稳定的燃烧、不稳定的中间态和熄灭状态。这项编程练习让你能够亲手构建S形曲线的一部分，并观察热损失等因素如何降低火焰温度，甚至导致火焰熄灭，从而对火焰稳定性与淬熄现象获得切实的体验。",
            "id": "4026206",
            "problem": "要求您形式化并计算热损失对稳定非预混小火焰最大温度的影响，并更新相应的标量耗散率-温度曲线（“S曲线”）。此任务必须完全在混合分数形式体系下，并使用科学上一致的闭合假设来完成。解决方案必须实现为一个完整的、可运行的程序。\n\n从单位刘易斯数小火焰在混合分数坐标 $Z$ 下的稳态小火焰能量方程开始：\n$$\n\\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + \\dot{q}_{\\mathrm{reac}}(T,Z) - q_{\\mathrm{rad}}(Z) = 0,\n$$\n其中 $\\rho$ 是密度，$c_p$ 是定压比热，$\\chi(Z)$ 是标量耗散率，$T$ 是温度，$\\dot{q}_{\\mathrm{reac}}(T,Z)$ 是体积放热率，$q_{\\mathrm{rad}}(Z)$ 是体积辐射热损失剖面。\n\n假设以下具有科学依据的建模闭合和定义：\n- 峰值温度出现在化学计量混合分数 $Z_{\\mathrm{st}}$ 附近。\n- 在 $Z_{\\mathrm{st}}$ 附近，扩散汇可以通过线性化曲率模型来近似：\n$$\nS_{\\mathrm{diff}}(T) \\approx \\rho c_p \\chi_{\\mathrm{st}} \\left(T - T_u\\right),\n$$\n其中 $\\chi_{\\mathrm{st}}$ 是在 $Z_{\\mathrm{st}}$ 处评估的标量耗散率，$T_u$ 是未燃参考温度。\n- 辐射损失剖面 $q_{\\mathrm{rad}}(Z)$ 是预先设定的，并在所有 $Z$ 处充当一个汇。特别地，在 $Z_{\\mathrm{st}}$ 处，它提供了局部辐射汇 $q_{\\mathrm{rad}}(Z_{\\mathrm{st}})$。\n- 在 $Z_{\\mathrm{st}}$ 处的放热率通过一步阿伦尼乌斯形式建模：\n$$\n\\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right),\n$$\n其中 $Q_{\\mathrm{heat}}$ 是单位质量反应混合物的反应热，$A$ 是指前因子，$E$ 是活化能，$R$ 是通用气体常数，$T_{\\mathrm{eff}}$ 是出现在反应速率中的有效温度。\n- 焓亏 $h_{\\mathrm{def}}$ 解释了外部热损失，以缺失的显焓表示，使得源项中的反应温度发生如下偏移：\n$$\nT_{\\mathrm{eff}} = T - \\frac{h_{\\mathrm{def}}}{c_p}.\n$$\n\n使用这些假设，在 $Z_{\\mathrm{st}}$ 处的峰值小火焰温度 $T_{\\max}$ 由温度最大值处稳态平衡的最大物理可行根得到。这产生一个关于 $T$ 的隐式标量方程，其解集通常可以是多值的（反映了经典的S曲线结构）。您的程序必须在物理上合理的温度区间内稳健地识别所有根，并选择 $T_{\\max}$ 作为最大的根。如果不存在根，则设置 $T_{\\max} = T_u$。\n\n要使用的数值常数和单位：\n- $\\rho = 1.2$ 单位 $\\mathrm{kg/m^3}$，\n- $c_p = 1000$ 单位 $\\mathrm{J/(kg\\cdot K)}$，\n- $T_u = 300$ 单位 $\\mathrm{K}$，\n- $Q_{\\mathrm{heat}} = 3.0\\times 10^{7}$ 单位 $\\mathrm{J/kg}$，\n- $A = 5000$ 单位 $\\mathrm{s^{-1}}$，\n- $E = 1.5\\times 10^{5}$ 单位 $\\mathrm{J/mol}$，\n- $R = 8.314$ 单位 $\\mathrm{J/(mol\\cdot K)}$，\n- $Z_{\\mathrm{st}} = 0.055$ (无量纲混合分数)，\n- 对于辐射损失剖面，使用高斯形式\n$$\nq_{\\mathrm{rad}}(Z) = q_0 \\exp\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right),\n$$\n其中给定的振幅 $q_0$ 单位为 $\\mathrm{W/m^3}$，宽度 $\\sigma$ 为无量纲。\n\n要求输出：\n- 对于每个给定的测试用例，计算更新后的最大小火焰温度 $T_{\\max}$，单位为开尔文。\n- 将每个 $T_{\\max}$ 以 $\\mathrm{K}$ 为单位表示，格式化为三位小数。\n- 您的程序应产生单行输出，包含一个用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,...]”）。\n\n测试套件：\n为以下参数集提供结果。每个测试用例是一个描述 $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0, \\sigma)$ 的元组，其中 $h_{\\mathrm{def}}$ 的单位是 $\\mathrm{J/kg}$，$q_0$ 的单位是 $\\mathrm{W/m^3}$，$\\sigma$ 是无量纲的。如果 $h_{\\mathrm{def}} > 0$，则应用它；否则设置 $h_{\\mathrm{def}} = 0$。如果 $q_0 > 0$，则使用指定的高斯 $q_{\\mathrm{rad}}(Z)$；否则设置 $q_{\\mathrm{rad}}(Z) \\equiv 0$。\n- 用例1（绝热基线，理想情况）：$(10.0, 0.0, 0.0, 0.01)$\n- 用例2（中等焓亏）：$(10.0, 1.0\\times 10^{5}, 0.0, 0.01)$\n- 用例3（化学计量比处的高斯辐射损失）：$(10.0, 0.0, 1.5\\times 10^{7}, 0.02)$\n- 用例4（高标量耗散，绝热）：$(80.0, 0.0, 0.0, 0.01)$\n- 用例5（高标量耗散伴有辐射损失）：$(80.0, 0.0, 2.0\\times 10^{7}, 0.02)$\n- 用例6（强焓亏，可能熄火）：$(80.0, 5.0\\times 10^{5}, 0.0, 0.01)$\n\n此问题不涉及角度单位。不使用百分比。\n\n实现约束：\n- 最终答案必须是一个完整的、可运行的程序。\n- 程序不得要求用户输入。\n- 程序必须在区间 $[T_u, 3500\\,\\mathrm{K}]$ 内识别隐式稳态平衡的所有实根，并选择 $T_{\\max}$ 作为最大的根。如果不存在根，则设置 $T_{\\max} = T_u$。\n- 最终输出必须是单行打印所有六个测试用例的 $T_{\\max}$ 列表，单位为开尔文，每个都格式化为三位小数。",
            "solution": "用户提供了一个成功通过验证阶段的问题陈述。\n\n### 步骤1：提取给定信息\n- **控制方程**：单位刘易斯数下，混合分数 $Z$ 坐标中的稳态小火焰能量方程为：\n$$\n\\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + \\dot{q}_{\\mathrm{reac}}(T,Z) - q_{\\mathrm{rad}}(Z) = 0\n$$\n- **$Z_{\\mathrm{st}}$ 处的扩散汇模型**：扩散项在峰值温度位置被建模为线性化汇：\n$$\nS_{\\mathrm{diff}}(T) \\approx \\rho c_p \\chi_{\\mathrm{st}} \\left(T - T_u\\right)\n$$\n- **$Z_{\\mathrm{st}}$ 处的放热率模型**：假设采用一步阿伦尼乌斯形式：\n$$\n\\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right)\n$$\n- **有效温度定义**：反应项中的温度根据焓亏 $h_{\\mathrm{def}}$ 进行调整：\n$$\nT_{\\mathrm{eff}} = T - \\frac{h_{\\mathrm{def}}}{c_p}\n$$\n- **辐射损失模型**：给定高斯剖面：\n$$\nq_{\\mathrm{rad}}(Z) = q_0 \\exp\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right)\n$$\n- **数值常数**：\n  - $\\rho = 1.2 \\, \\mathrm{kg/m^3}$\n  - $c_p = 1000 \\, \\mathrm{J/(kg\\cdot K)}$\n  - $T_u = 300 \\, \\mathrm{K}$\n  - $Q_{\\mathrm{heat}} = 3.0\\times 10^{7} \\, \\mathrm{J/kg}$\n  - $A = 5000 \\, \\mathrm{s^{-1}}$\n  - $E = 1.5\\times 10^{5} \\, \\mathrm{J/mol}$\n  - $R = 8.314 \\, \\mathrm{J/(mol\\cdot K)}$\n  - $Z_{\\mathrm{st}} = 0.055$\n- **测试用例**：六个 $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0, \\sigma)$ 元组。\n  - 用例1：$(10.0, 0.0, 0.0, 0.01)$\n  - 用例2：$(10.0, 1.0\\times 10^{5}, 0.0, 0.01)$\n  - 用例3：$(10.0, 0.0, 1.5\\times 10^{7}, 0.02)$\n  - 用例4：$(80.0, 0.0, 0.0, 0.01)$\n  - 用例5：$(80.0, 0.0, 2.0\\times 10^{7}, 0.02)$\n  - 用例6：$(80.0, 5.0\\times 10^{5}, 0.0, 0.01)$\n- **约束**：\n  - 如果 $h_{\\mathrm{def}} \\le 0$，则取为 $0$。\n  - 如果 $q_0 \\le 0$，则辐射损失 $q_{\\mathrm{rad}}(Z)$ 取为 $0$。\n  - 必须在区间 $[T_u, 3500\\,\\mathrm{K}]$ 内找到根。\n  - $T_{\\max}$ 是最大的根；如果没有根，则 $T_{\\max} = T_u$。\n\n### 步骤2：使用提取的给定信息进行验证\n该问题具有科学依据，依赖于已建立的小火焰理论和简化的、但基于物理的反应动力学和输运模型。模型和常数在量纲上一致且物理上合理。问题是适定的：它要求找到一个明确定义的非线性标量方程的根，并为选择解提供了清晰的规则。语言客观，要求具体。因此，该问题被认为是**有效的**。\n\n### 步骤3：结论与行动\n问题是有效的。将提供完整的解决方案。\n\n### 求解推导\n目标是通过在假定温度达到峰值的化学计量混合分数 $Z_{\\mathrm{st}}$ 处建立稳态能量平衡来确定最大小火焰温度 $T_{\\max}$。在此峰值处，化学反应产生的热量必须与通过扩散和辐射散失到周围环境的热量相平衡。\n\n将稳态能量控制方程重新排列以表示此平衡：\n$$\n\\dot{q}_{\\mathrm{reac}}(T,Z) = - \\rho c_p \\chi(Z) \\frac{d^2 T}{dZ^2} + q_{\\mathrm{rad}}(Z)\n$$\n在最大温度 $T = T_{\\max}$ 的位置（假定在 $Z = Z_{\\mathrm{st}}$），左侧是热源，右侧表示热汇。问题为这些项提供了具体的模型。\n\n1.  **热源项**：放热率由阿伦尼乌斯表达式给出，使用考虑了通过焓亏 $h_{\\mathrm{def}}$ 产生的非绝热性的有效温度 $T_{\\mathrm{eff}}$ 进行评估：\n    $$\n    \\text{Source}(T) = \\dot{q}_{\\mathrm{reac}}(T_{\\mathrm{eff}}) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R T_{\\mathrm{eff}}}\\right)\n    $$\n    其中 $T_{\\mathrm{eff}} = T - h_{\\mathrm{def}}/c_p$。请注意，该项仅在温度 $T > h_{\\mathrm{def}}/c_p$ 时具有物理意义。\n\n2.  **热汇项**：总汇是扩散损失和辐射损失的总和。\n    - 扩散汇代表从反应区传走的热量，模型为：\n    $$\n    S_{\\mathrm{diff}}(T) = \\rho c_p \\chi_{\\mathrm{st}} (T - T_u)\n    $$\n    该项随着温度与未燃参考温度 $T_u$ 之差线性增加。\n    - 根据给定的高斯剖面，在 $Z=Z_{\\mathrm{st}}$ 处的辐射汇就是其峰值：\n    $$\n    q_{\\mathrm{rad}}(Z_{\\mathrm{st}}) = q_0 \\exp\\left(-\\frac{(Z_{\\mathrm{st}} - Z_{\\mathrm{st}})^2}{2\\sigma^2}\\right) = q_0\n    $$\n\n将 $T = T_{\\max}$ 时的源和汇相等，得到以下关于 $T$ 的隐式方程：\n$$\n\\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R (T - h_{\\mathrm{def}}/c_p)}\\right) = \\rho c_p \\chi_{\\mathrm{st}} (T - T_u) + q_0\n$$\n为了找到稳态温度，我们必须找到函数 $f(T)$ 的根：\n$$\nf(T) = \\rho Q_{\\mathrm{heat}} A \\exp\\left(-\\frac{E}{R (T - h_{\\mathrm{def}}/c_p)}\\right) - \\left( \\rho c_p \\chi_{\\mathrm{st}} (T - T_u) + q_0 \\right) = 0\n$$\n该方程的根对应于产热曲线（S形曲线）和散热曲线（一条直线）的交点。在物理域中可以有零个、一个、两个或三个根。这些根中的最大者对应于稳定的高温燃烧解，我们将其确定为 $T_{\\max}$。最低的根通常对应于接近 $T_u$ 的稳定非燃烧状态，而中间的根（如果存在）是不稳定的。\n\n### 数值求解策略\n通过开发一个程序来寻找在指定的物理区间 $[T_u, 3500\\,\\mathrm{K}]$ 内 $f(T)=0$ 的所有实根来实现该解。\n\n1.  对于每个测试用例，使用参数 $(\\chi_{\\mathrm{st}}, h_{\\mathrm{def}}, q_0)$ 来定义函数 $f(T)$ 的具体实例。应用关于非正 $h_{\\mathrm{def}}$ 和 $q_0$ 的条件。\n2.  建立搜索的物理域。阿伦尼乌斯项仅在 $T > T_{shift}$ 时有定义，其中 $T_{shift} = h_{\\mathrm{def}}/c_p$。因此，在区间 $[\\max(T_u, T_{shift} + \\delta), 3500\\,\\mathrm{K}]$ 中进行根的搜索，其中 $\\delta$ 是一个小的正值，以避免在 $T=T_{shift}$ 处的极点。\n3.  采用一个鲁棒的求根算法。将搜索区间离散化为一个精细的网格。通过检查相邻网格点之间 $f(T)$ 的符号变化，我们可以识别出保证包含根的子区间（根据介值定理）。\n4.  对于每个这样的子区间 $[T_i, T_{i+1}]$，其中 $f(T_i) \\cdot f(T_{i+1})  0$，使用数值求解器 `scipy.optimize.brentq` 来精确找到根的位置。\n5.  收集所有找到的根。然后，最大温度 $T_{\\max}$ 是这些根中的最大值。\n6.  如果在有效搜索域中没有找到根，这表示热损失太大，无法维持稳定的火焰（熄火）。在这种情况下，根据问题的指示，将温度设置为未燃温度 $T_{\\max} = T_u$。\n7.  对所有六个测试用例重复此过程，并根据指定的输出格式对结果进行格式化和打印。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the maximum flamelet temperature for several cases by solving the\n    steady-state energy balance equation for a non-premixed flamelet.\n    \"\"\"\n    \n    # Define physical and chemical constants\n    RHO = 1.2        # Density in kg/m^3\n    CP = 1000.0      # Specific heat in J/(kg*K)\n    TU = 300.0       # Unburned temperature in K\n    Q_HEAT = 3.0e7   # Heat of reaction in J/kg\n    A = 5000.0       # Pre-exponential factor in 1/s\n    E = 1.5e5        # Activation energy in J/mol\n    R = 8.314        # Universal gas constant in J/(mol*K)\n\n    # Define the test suite\n    # Each case is a tuple: (chi_st, h_def, q0, sigma)\n    test_cases = [\n        (10.0, 0.0, 0.0, 0.01),\n        (10.0, 1.0e5, 0.0, 0.01),\n        (10.0, 0.0, 1.5e7, 0.02),\n        (80.0, 0.0, 0.0, 0.01),\n        (80.0, 0.0, 2.0e7, 0.02),\n        (80.0, 5.0e5, 0.0, 0.01),\n    ]\n\n    results = []\n    \n    # Define the search interval for temperature roots\n    T_min_search = TU\n    T_max_search = 3500.0\n    N_grid = 20000  # Number of grid points for root bracketing\n\n    for case in test_cases:\n        chi_st, h_def, q0, sigma = case\n        \n        # Apply conditional logic for h_def and q0 as per problem statement\n        if h_def = 0:\n            h_def = 0.0\n        if q0 = 0:\n            q0 = 0.0\n\n        # Calculate the temperature shift due to enthalpy defect\n        T_shift = h_def / CP\n\n        def f(T):\n            \"\"\"\n            Represents the energy balance equation f(T) = source - sink = 0.\n            The roots of this function are the steady-state temperatures.\n            \"\"\"\n            # The reaction term is undefined for T == T_shift\n            if T == T_shift:\n                # Return a large negative value to prevent finding false roots in this region.\n                # The loss term is typically positive, so their difference is negative.\n                return -1e12\n\n            T_eff = T - T_shift\n            \n            # Heat release source term (W/m^3)\n            # Use a try-except block to handle potential overflow from np.exp\n            try:\n                q_reac = RHO * Q_HEAT * A * np.exp(-E / (R * T_eff))\n            except OverflowError:\n                q_reac = np.inf\n            \n            # Heat loss sink term (W/m^3)\n            q_loss = RHO * CP * chi_st * (T - TU) + q0\n            \n            return q_reac - q_loss\n\n        roots = []\n        \n        # Determine the valid search start temperature, avoiding the pole\n        T_start = max(T_min_search, T_shift + 1e-9)\n        \n        if T_start >= T_max_search:\n            # If the entire search range is invalid, no roots can exist\n            T_max = TU\n        else:\n            # Create a grid over the valid search interval\n            T_grid = np.linspace(T_start, T_max_search, N_grid)\n            \n            # Evaluate the function on the grid\n            f_grid = np.array([f(t) for t in T_grid])\n            \n            # Find intervals where a root exists (sign change)\n            for i in range(len(T_grid) - 1):\n                if np.sign(f_grid[i]) != np.sign(f_grid[i+1]):\n                    # A root is bracketed, find it precisely using brentq\n                    try:\n                        root = brentq(f, T_grid[i], T_grid[i+1])\n                        roots.append(root)\n                    except (ValueError, RuntimeError):\n                        # brentq might fail in edge cases, skip if so\n                        pass\n        \n            if roots:\n                # The maximum temperature is the largest root\n                T_max = max(roots)\n            else:\n                # If no roots are found, the solution is the unburned state\n                T_max = TU\n        \n        results.append(T_max)\n\n    # Format the results to three decimal places and print in the required format\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}