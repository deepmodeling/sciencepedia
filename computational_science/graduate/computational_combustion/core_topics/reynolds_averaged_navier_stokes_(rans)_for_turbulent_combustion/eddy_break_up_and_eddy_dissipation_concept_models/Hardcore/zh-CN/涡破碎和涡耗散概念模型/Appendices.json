{
    "hands_on_practices": [
        {
            "introduction": "在湍流燃烧模拟中，一个核心挑战是根据火焰的具体物理特性选择合适的模型。本练习将引导您运用丹柯勒数（Damköhler number, $Da$）这一关键的无量纲参数，它通过比较湍流混合时间尺度与化学反应时间尺度，为模型选择提供了定量依据。您将学习如何从基本的湍流参数（$k, \\epsilon$）和给定的化学时间尺度出发，计算$Da$值，并据此在快化学假说（如涡破碎模型，EBU）和考虑有限速率化学反应的模型（如涡耗散概念模型，EDC）之间做出明智的抉择。",
            "id": "4022767",
            "problem": "在实验室条件下，一股甲烷-空气射流火焰喷入伴流环境中。在火焰锋区中的雷诺平均纳维-斯托克斯（RANS）测量，得到了一个代表性位置的湍动能 $k$ 和耗散率 $\\epsilon$。此外，还独立估算了在当地热化学状态下，主要甲烷氧化路径的化学时间尺度 $\\tau_{\\mathrm{chem}}$。\n\n使用基本定义和标度律论证，推导丹科勒数 $Da$ 的表达式。该数是特征湍流混合时间与化学时间尺度之比，并用 $k$ 和 $\\epsilon$ 表示。然后，利用给定数据计算 $Da$ 的值，并根据其大小判断在该位置哪种模拟假设更为合适：涡破碎（EBU）模型（该模型假定燃烧由混合控制且化学反应速率极快），还是涡耗散概念（EDC）模型（该模型考虑了湍流精细结构内的有限速率化学反应）。\n\n数据：\n- 湍动能：$k = 0.8\\,\\mathrm{m^2/s^2}$\n- 耗散率：$\\epsilon = 40\\,\\mathrm{m^2/s^3}$\n- 化学时间尺度：$\\tau_{\\mathrm{chem}} = 5 \\times 10^{-4}\\,\\mathrm{s}$\n\n要求：\n- 使用推导出的表达式计算丹科勒数 $Da$，并将数值结果四舍五入至三位有效数字。将 $Da$ 表示为一个无单位的纯数。\n- 将模型选择编码为 $M$，如果涡破碎（EBU）模型合适，则 $M = 0$；如果涡耗散概念（EDC）模型合适，则 $M = 1$。\n- 以包含两个条目 $\\big[Da \\;\\; M\\big]$ 的行矩阵形式提供最终答案。",
            "solution": "该问题要求推导丹科勒数 $Da$ 的表达式，对其进行数值计算，并随后根据给定条件决定合适的燃烧模型。\n\n首先，我们进行推导。丹科勒数定义为特征湍流混合时间 $\\tau_{\\text{turb}}$ 与化学时间尺度 $\\tau_{\\text{chem}}$ 之比。\n$$\nDa = \\frac{\\tau_{\\text{turb}}}{\\tau_{\\text{chem}}}\n$$\n该问题背景为雷诺平均纳维-斯托克斯（RANS）模拟，其中的湍流由湍动能 $k$ 及其耗散率 $\\epsilon$ 来表征。湍动能 $k$ 的单位是速度的平方 $[\\mathrm{L}^2 \\mathrm{T}^{-2}]$，代表大尺度含能湍涡中单位质量所含的能量。耗散率 $\\epsilon$ 的单位是单位质量单位时间的能量 $[\\mathrm{L}^2 \\mathrm{T}^{-3}]$，代表在最小尺度涡中 $k$ 因粘性力作用而耗散成热的速率。\n\n可以通过量纲分析，由 $k$ 和 $\\epsilon$ 构建出控制湍流混合速率的大涡特征时间尺度。我们寻求一个 $k$ 和 $\\epsilon$ 的组合，使其单位为时间 $[\\mathrm{T}]$。\n$$\n\\frac{[k]}{[\\epsilon]} = \\frac{[\\mathrm{L}^2 \\mathrm{T}^{-2}]}{[\\mathrm{L}^2 \\mathrm{T}^{-3}]} = [\\mathrm{T}]\n$$\n这表明湍流混合时间与比值 $k/\\epsilon$ 成正比。在大涡翻转时间的背景下，比例常数取为1。因此，我们将特征湍流混合时间定义为：\n$$\n\\tau_{\\text{turb}} = \\frac{k}{\\epsilon}\n$$\n将此表达式代入丹科勒数的定义，即可得到用 $k$、$\\epsilon$ 和 $\\tau_{\\text{chem}}$ 表示的所需表达式：\n$$\nDa = \\frac{k/\\epsilon}{\\tau_{\\text{chem}}} = \\frac{k}{\\epsilon \\tau_{\\text{chem}}}\n$$\n接下来，我们使用所提供的数据来计算该表达式的值：\n- 湍动能：$k = 0.8\\,\\mathrm{m^2/s^2}$\n- 耗散率：$\\epsilon = 40\\,\\mathrm{m^2/s^3}$\n- 化学时间尺度：$\\tau_{\\text{chem}} = 5 \\times 10^{-4}\\,\\mathrm{s}$\n\n将这些值代入推导出的 $Da$ 公式中：\n$$\nDa = \\frac{0.8\\,\\mathrm{m^2/s^2}}{(40\\,\\mathrm{m^2/s^3})(5 \\times 10^{-4}\\,\\mathrm{s})}\n$$\n首先，计算分母的值：\n$$\n(40) \\times (5 \\times 10^{-4}) = 200 \\times 10^{-4} = 0.02\n$$\n分母中的单位是 $(\\mathrm{m^2/s^3}) \\cdot \\mathrm{s} = \\mathrm{m^2/s^2}$，与分子的单位相匹配，这证实了 $Da$ 是一个无量纲量。\n现在，我们计算 $Da$ 的最终值：\n$$\nDa = \\frac{0.8}{0.02} = \\frac{80}{2} = 40\n$$\n问题要求将该值四舍五入至三位有效数字。因此，$Da = 40.0$。\n\n最后，我们必须根据 $Da$ 的大小选择合适的燃烧模型。丹科勒数比较了流体混合的时间尺度与化学反应的时间尺度。\n- 如果 $Da \\gg 1$，则 $\\tau_{\\text{turb}} \\gg \\tau_{\\text{chem}}$。这表明化学反应相对于湍流混合过程非常快。因此，总燃烧速率受限于反应物的混合速率。这就是“快化学”区，涡破碎（EBU）模型就是为此设计的。\n- 如果 $Da \\approx 1$ 或 $Da \\ll 1$，则 $\\tau_{\\text{turb}}$ 与 $\\tau_{\\text{chem}}$ 处于同一数量级或更小。这意味着化学动力学速率并非快到可以忽略不计，并可能成为速率限制步骤。在这种“有限速率化学”区，需要使用像涡耗散概念（EDC）这样的模型，该模型考虑了湍流与化学反应之间的相互作用。\n\n在我们的情况下，$Da = 40.0$。由于 $40.0 \\gg 1$，化学反应比湍流混合快得多。该位置的燃烧过程由混合控制。因此，基于快化学假设的涡破碎（EBU）模型是更合适的建模选择。\n\n问题为模型选择 $M$ 指定了编码，其中EBU模型对应 $M=0$，EDC模型对应 $M=1$。根据我们的分析，EBU模型是合适的，这对应于：\n$$\nM = 0\n$$\n最终答案应以行矩阵 $[Da \\;\\; M]$ 的形式呈现。\n计算出的值为 $Da = 40.0$ 和 $M=0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40.0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在我们确定了何时应使用涡耗散概念（EDC）模型之后，下一步便是深入理解其工作原理。本练习旨在揭示EDC模型中“有限速率化学”部分的核心机制，它将湍流中的精细结构理想化为微型化学反应器。通过亲手编写程序来求解一个精细结构反应器内的组分演化常微分方程，您将把抽象的理论转化为具体的计算，从而深刻理解EDC模型是如何将复杂的化学动力学与湍流混合过程耦合起来的。",
            "id": "4022728",
            "problem": "考虑一个湍流反应流中的理想搅拌精细结构单元，该单元由涡耗散概念模型（EDC）建模。根据EDC假设，反应精细结构被视为具有有限停留时间的理想、充分混合的反应器，反应物从周围的非反应流体中进入，其质量分数与宏观（粗网格）值相匹配。在本问题中，您将为一个代表甲烷氧化的两步、顺序、伪一级反应机理：$\\mathrm{CH_4} \\to \\mathrm{CO} \\to \\mathrm{CO_2}$，通过在指定的停留时间 $\\tau^*$ 内对物种守恒常微分方程进行积分，来计算精细结构质量分数 $Y_i^*$。\n\n从以下基本原理出发：\n- 在一个充分混合的反应器中，物种守恒意味着每个物种质量分数随时间的变化等于化学反应引起的净生成率，这表示为一个关于时间的常微分方程。\n- 当氧化剂在精细结构内大量过量时，精细结构中基元步骤的有效反应速率可以被建模为相对于反应物物种的伪一级反应。每个步骤的温度依赖性由阿伦尼乌斯动力学捕捉，速率常数由 $k_j(T) = A_j \\exp\\left(-\\dfrac{E_{a,j}}{R T}\\right)$ 给出（针对步骤 $j$），其中 $A_j$ 是指前因子，$E_{a,j}$ 是活化能，$R$ 是普适气体常数，$T$ 是绝对温度。\n- 精细结构停留时间 $\\tau^*$ 是精细结构在与周围流体交换其内容物之前进行化学演化的时间（在EDC建模的背景下，这与最小的湍流时间尺度成正比，但在这里它是预先设定的）。\n\n您的任务是：\n1. 针对顺序机理 $\\mathrm{CH_4} \\to \\mathrm{CO} \\to \\mathrm{CO_2}$，在具有阿伦尼乌斯速率常数 $k_1(T)$ 和 $k_2(T)$ 的伪一级假设下，建立物种守恒常微分方程。\n2. 从等于进入精细结构时的宏观质量分数的初始条件开始，在停留时间 $\\tau^*$ 内积分这些方程，以获得 $Y_{\\mathrm{CH_4}}^*$、$Y_{\\mathrm{CO}}^*$ 和 $Y_{\\mathrm{CO_2}}^*$。\n3. 通过计算多组参数下的最终值，展示 $Y_i^*$ 对温度 $T$ 和指前因子 $A_1$、$A_2$ 变化的敏感性。\n\n使用普适气体常数 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。将氧化剂浓度视为常数（大量过量），因此该机理对于所追踪的物种是伪一级的。温度以 $\\mathrm{K}$ 表示，速率常数以 $\\mathrm{s}^{-1}$ 表示，活化能以 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 表示，停留时间以 $\\mathrm{s}$ 表示，质量分数表示为无量纲小数。精细结构质量分数 $Y_i^*$ 必须报告并四舍五入到六位小数。\n\n实现一个完整、可运行的程序，通过对常微分方程进行数值积分来解决上述问题。使用以下参数集测试套件来探测正常情况、边界条件和边缘情况：\n\n- 测试用例1（基准）：$T = 1800\\,\\mathrm{K}$，$\\tau^* = 1.0\\times 10^{-4}\\,\\mathrm{s}$，$A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$，$E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$A_2 = 5.0\\times 10^{6}\\,\\mathrm{s}^{-1}$，$E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，初始质量分数 $[Y_{\\mathrm{CH_4}}(0), Y_{\\mathrm{CO}}(0), Y_{\\mathrm{CO_2}}(0)] = [0.05, 0.0, 0.0]$。\n- 测试用例2（边界 $\\tau^* = 0$）：与测试用例1参数相同，但 $\\tau^* = 0.0\\,\\mathrm{s}$。\n- 测试用例3（较低温度）：$T = 1200\\,\\mathrm{K}$，$\\tau^* = 1.0\\times 10^{-4}\\,\\mathrm{s}$，$A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$，$E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$A_2 = 5.0\\times 10^{6}\\,\\mathrm{s}^{-1}$，$E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，初始质量分数 $[0.05, 0.0, 0.0]$。\n- 测试用例4（较高的 $A_1$）：与测试用例1相同，但 $A_1 = 1.0\\times 10^{8}\\,\\mathrm{s}^{-1}$。\n- 测试用例5（较高温度，较短停留时间，较慢的第二步，非零中间产物）：$T = 2200\\,\\mathrm{K}$，$\\tau^* = 2.0\\times 10^{-5}\\,\\mathrm{s}$，$A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$，$E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$A_2 = 5.0\\times 10^{5}\\,\\mathrm{s}^{-1}$，$E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，初始质量分数 $[0.04, 0.01, 0.0]$。\n- 测试用例6（长停留时间，接近完全转化）：与测试用例1相同，但 $\\tau^* = 2.0\\times 10^{-3}\\,\\mathrm{s}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个测试用例的结果必须是三个最终质量分数 $[Y_{\\mathrm{CH_4}}^*, Y_{\\mathrm{CO}}^*, Y_{\\mathrm{CO_2}}^*]$ 的子列表，并四舍五入到六位小数。例如，输出格式必须为 $[[y_{11},y_{12},y_{13}],[y_{21},y_{22},y_{23}],\\dots]$ 的形式，其中每个 $y_{ij}$ 是小数点后有六位数的小数。",
            "solution": "所提出的问题是有效的。它在科学上基于化学动力学和反应工程的原理，特别是充分混合反应器的建模，这是湍流燃烧中涡耗散概念模型（EDC）的核心概念。该问题被恰当地表述为一个常微分方程组的初值问题，并提供了所有必要的参数和初始条件。它是客观的，不含任何非科学论断。\n\n求解过程首先建立控制方程，然后概述其数值求解方法，最后将此方法应用于指定的测试用例。\n\n### 1. 控制方程的建立\n\n问题描述了一个理想搅拌的精细结构单元内的化学演化，这在数学上等同于一个等温、等压的间歇式反应器。在此类系统中，对于质量分数为 $Y_i$ 的物种 $i$ 的守恒方程为：\n$$\n\\frac{dY_i}{dt} = \\frac{\\dot{\\omega}_i}{\\rho}\n$$\n其中 $t$ 是时间，$\\dot{\\omega}_i$ 是单位体积内物种 $i$ 的净质量生成率，$\\rho$ 是混合物密度。\n\n反应机理被指定为甲烷（$\\mathrm{CH_4}$）氧化的两步顺序路径：\n$$\n\\mathrm{CH_4} \\xrightarrow{k_1} \\mathrm{CO} \\xrightarrow{k_2} \\mathrm{CO_2}\n$$\n问题指出，这应被建模为一个伪一级过程。这是集总动力学模型中的一种常见简化，其中详细的化学计量和其他反应物（如过量的氧化剂）的作用被吸收到速率常数中。对此描述的一个直接且一致的解释是，应用于质量分数时，从一个物种到下一个物种的质量转化速率与反应物物种的质量分数成正比。这意味着追踪物种的总质量分数守恒，即 $\\frac{d}{dt}(Y_{\\mathrm{CH_4}} + Y_{\\mathrm{CO}} + Y_{\\mathrm{CO_2}}) = 0$。\n\n在此解释下，控制质量分数的常微分方程（ODE）组为：\n\n1.  对于在第一步中被消耗的甲烷（$\\mathrm{CH_4}$）：\n    $$\n    \\frac{dY_{\\mathrm{CH_4}}}{dt} = -k_1 Y_{\\mathrm{CH_4}}\n    $$\n2.  对于在第一步中生成、在第二步中消耗的一氧化碳（$\\mathrm{CO}$）：\n    $$\n    \\frac{dY_{\\mathrm{CO}}}{dt} = +k_1 Y_{\\mathrm{CH_4}} - k_2 Y_{\\mathrm{CO}}\n    $$\n3.  对于在第二步中生成的二氧化碳（$\\mathrm{CO_2}$）：\n    $$\n    \\frac{dY_{\\mathrm{CO_2}}}{dt} = +k_2 Y_{\\mathrm{CO}}\n    $$\n\n速率常数 $k_1$ 和 $k_2$ 依赖于温度，并由阿伦尼乌斯定律给出：\n$$\nk_j(T) = A_j \\exp\\left(-\\frac{E_{a,j}}{RT}\\right)\n$$\n其中，对于步骤 $j$，$A_j$ 是指前因子，$E_{a,j}$ 是活化能，$T$ 是绝对温度，$R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 是普适气体常数。对于每个测试用例，温度 $T$ 是恒定的，这使得速率常数 $k_1$ 和 $k_2$ 在整个积分过程中保持不变。\n\n### 2. 数值求解方法\n\n问题要求通过在时间区间 $[0, \\tau^*]$ 上求解该ODE系统来找到最终的质量分数 $Y_i^* = Y_i(\\tau^*)$。初始条件为给定的宏观质量分数 $Y_i(0)$。这构成了一个初值问题（IVP）。\n\n令状态向量为 $\\mathbf{Y}(t) = [Y_{\\mathrm{CH_4}}(t), Y_{\\mathrm{CO}}(t), Y_{\\mathrm{CO_2}}(t)]^T$。该ODE系统可以写成矩阵形式：\n$$\n\\frac{d\\mathbf{Y}}{dt} = \\mathbf{F}(\\mathbf{Y}) = \\begin{pmatrix} -k_1 & 0 & 0 \\\\ k_1 & -k_2 & 0 \\\\ 0 & k_2 & 0 \\end{pmatrix} \\mathbf{Y}\n$$\n尽管这个具有常系数的线性系统有闭式解析解，但问题要求使用数值积分方法，这种方法更通用，并能代表复杂反应流模拟中使用的方法。我们将采用一个标准的ODE数值求解器。SciPy库中的 `scipy.integrate.solve_ivp` 函数是一个合适且稳健的选择。它实现了多种自适应步长方法，可以高效、准确地求解初值问题。\n\n每个测试用例的求解步骤如下：\n1.  定义用例的参数：$T$、$\\tau^*$、$A_1$、$E_{a,1}$、$A_2$、$E_{a,2}$，以及初始质量分数 $\\mathbf{Y}(0) = [Y_{\\mathrm{CH_4}}(0), Y_{\\mathrm{CO}}(0), Y_{\\mathrm{CO_2}}(0)]$。\n2.  使用阿伦尼乌斯方程计算常数速率系数 $k_1$ 和 $k_2$。\n3.  处理停留时间 $\\tau^* = 0$ 的边缘情况。在这种平凡情况下，没有反应发生，最终质量分数与初始质量分数相同。\n4.  对于 $\\tau^* > 0$，定义一个函数来表示ODE系统的右侧 $\\mathbf{F}(\\mathbf{Y})$。\n5.  使用 `scipy.integrate.solve_ivp` 从 $t=0$ 到 $t=\\tau^*$ 对系统进行积分，使用给定的初始条件。\n6.  在 $t=\\tau^*$ 处的积分结果即为最终的精细结构质量分数 $\\mathbf{Y}^* = [Y_{\\mathrm{CH_4}}^*, Y_{\\mathrm{CO}}^*, Y_{\\mathrm{CO_2}}^*]$。\n7.  按要求将最终值四舍五入到六位小数。\n\n这种结构化的方法确保每个测试用例都能根据问题陈述中指定的物理模型和数值要求被正确求解。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the fine-structure mass fractions in an EDC model\n    by numerically integrating the species conservation ODEs for a\n    two-step sequential reaction.\n    \"\"\"\n    # Universal gas constant in J/(mol K)\n    R = 8.314\n\n    test_cases = [\n        # Test case 1 (baseline)\n        {'T': 1800.0, 'tau_star': 1.0e-4, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 2 (boundary tau* = 0)\n        {'T': 1800.0, 'tau_star': 0.0, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 3 (lower temperature)\n        {'T': 1200.0, 'tau_star': 1.0e-4, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 4 (higher A1)\n        {'T': 1800.0, 'tau_star': 1.0e-4, 'A1': 1.0e8, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 5 (higher temperature, shorter residence, slower second step, nonzero intermediate)\n        {'T': 2200.0, 'tau_star': 2.0e-5, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e5, 'Ea2': 6.0e4, 'Y0': [0.04, 0.01, 0.0]},\n        # Test case 6 (long residence time, near-complete conversion)\n        {'T': 1800.0, 'tau_star': 2.0e-3, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n    ]\n\n    # Function defining the system of ODEs\n    def odes(t, Y, k1, k2):\n        \"\"\"\n        System of ODEs for the sequential reaction CH4 -> CO -> CO2.\n        Y: array of mass fractions [Y_CH4, Y_CO, Y_CO2]\n        k1, k2: rate constants for the two steps\n        \"\"\"\n        Y_CH4, Y_CO, Y_CO2 = Y\n        dY_CH4_dt = -k1 * Y_CH4\n        dY_CO_dt = k1 * Y_CH4 - k2 * Y_CO\n        dY_CO2_dt = k2 * Y_CO\n        return [dY_CH4_dt, dY_CO_dt, dY_CO2_dt]\n\n    results = []\n    for params in test_cases:\n        T = params['T']\n        tau_star = params['tau_star']\n        A1, Ea1 = params['A1'], params['Ea1']\n        A2, Ea2 = params['A2'], params['Ea2']\n        Y0 = np.array(params['Y0'])\n\n        # Handle the trivial case of zero residence time\n        if tau_star == 0.0:\n            final_Y = Y0\n        else:\n            # Calculate Arrhenius rate constants\n            k1 = A1 * np.exp(-Ea1 / (R * T))\n            k2 = A2 * np.exp(-Ea2 / (R * T))\n\n            # Set up the integration\n            t_span = [0, tau_star]\n            \n            # Solve the initial value problem\n            # Using 'Radau' or 'BDF' is often good for stiff problems in chemical kinetics\n            solution = solve_ivp(\n                fun=odes,\n                t_span=t_span,\n                y0=Y0,\n                args=(k1, k2),\n                method='Radau',\n                rtol=1e-8,\n                atol=1e-12\n            )\n            \n            # The result is the state at the end of the time span\n            final_Y = solution.y[:, -1]\n\n        # Round the results to six decimal places\n        rounded_Y = np.round(final_Y, 6).tolist()\n        results.append(rounded_Y)\n    \n    # Format the output string as a list of lists.\n    # e.g., [[0.050000,0.000000,0.000000],[...]]\n    sublist_strings = [f\"[{y[0]:.6f},{y[1]:.6f},{y[2]:.6f}]\" for y in results]\n    final_output_string = f\"[{','.join(sublist_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "最后的这项综合性练习将前面学到的概念融入一个系统级的湍流射流火焰模拟中。您将构建一个简化的一维模型，该模型将宏观的湍流流动特性与EDC模型的关键参数联系起来，并最终预测火焰长度和污染物生成等宏观火焰特征。此练习不仅展示了EDC模型的实际应用，更重要的是，它揭示了模拟结果对模型常数（如$C_\\tau$和$C_\\xi$）的敏感性——这是任何计算模型开发者或使用者都必须具备的关键洞察力。",
            "id": "4022730",
            "problem": "您将使用湍流燃烧的涡耗散概念（Eddy Dissipation Concept, EDC），基于湍流射流中心线上的质量和组分守恒，实现一个敏感性分析。目标是量化精细结构时间尺度常数 $C_\\tau$ 和精细结构质量分数常数 $C_\\xi$ 的微小变化，如何改变湍流射流火焰中两个预测指标：火焰长度和氮氧化物生成量。您的程序必须针对一个指定的测试套件，计算火焰长度（单位为米）和累积到火焰长度处的氮氧化物摩尔分数（无量纲），并在一个聚合行中报告所有情况的结果。\n\n使用以下有科学依据的基础和定义，其中所有符号均已定义，所有常数均已指定：\n\n- 考虑一个稳态轴对称射流火焰，其中心线被视为一维对流-反应流线。令中心线速度随轴向距离 $x$ 衰减为\n$$U(x) = \\frac{U_0}{1 + a \\frac{x}{D}},$$\n其中 $U_0$ 是喷嘴出口速度，$D$ 是喷嘴直径，$a$ 是无量纲的扩散参数。\n\n- 使用自相似射流标度律对中心线上的湍动能和耗散率进行建模：\n$$k(x) = C_k U(x)^2,$$\n$$\\varepsilon(x) = C_\\varepsilon \\frac{U(x)^3}{D}.$$\n\n- 涡耗散概念（EDC）假定燃烧主要发生在湍流精细结构中。精细结构停留时间和质量分数建模为\n$$\\tau^\\ast(x) = C_\\tau \\sqrt{\\frac{\\nu}{\\varepsilon(x)}},$$\n$$\\xi(x) = C_\\xi \\left(\\frac{\\nu \\varepsilon(x)}{k(x)^2}\\right)^{1/4},$$\n其中 $\\nu$ 是运动粘度。这些是 EDC 中的标准操作定义，将湍流尺度与混合限制的反应速率联系起来。\n\n- 沿流线，对具有混合限制动力学的全局单步燃料消耗强制执行组分质量守恒，忽略逆向混合和与对流相反的扩散。燃料质量分数 $Y_f(x)$ 满足\n$$U(x)\\frac{dY_f}{dx} = - \\omega_f(x),$$\n其中混合限制的反应源项建模为\n$$\\omega_f(x) = C_r\\,\\xi(x)\\,\\frac{Y_f(x)}{\\tau^\\ast(x)},$$\n$C_r$ 是一个无量纲的全局反应参数，它综合了全局反应级数和化学计量效应。假设与入流相比，平衡燃料质量分数实际上为零，使得消耗量与 $Y_f$ 成正比。\n\n- 令温度从入流值开始，随反应进程成比例上升，\n$$T(x) = T_0 + \\Delta T\\left(1 - \\frac{Y_f(x)}{Y_{f,0}}\\right),$$\n其中 $T_0$ 是入流温度，$\\Delta T$ 是净绝热温升。对于此敏感性分析，假设密度变化不会反馈影响 $U(x)$ 或湍流标度律。\n\n- 将热力型氮氧化物的形成建模为对流产物，其与精细结构分数和一个具有有效活化能的阿伦尼乌斯项成正比：\n$$U(x)\\frac{dY_{\\mathrm{NO}}}{dx} = C_{\\mathrm{NO}}\\,\\xi(x)\\,\\exp\\left(-\\frac{E_{\\mathrm{NO}}}{R_u\\,T(x)}\\right),$$\n其中 $Y_{\\mathrm{NO}}$ 是氮氧化物摩尔分数，$C_{\\mathrm{NO}}$ 是一个标度常数，$E_{\\mathrm{NO}}$ 是一个有效活化能，$R_u$ 是通用气体常数。\n\n定义火焰长度 $L_f$ 为满足 $Y_f(x) \\le \\theta\\,Y_{f,0}$ 的最小 $x$，其中 $\\theta$ 是一个预设阈值。定义报告的氮氧化物值为 $Y_{\\mathrm{NO}}(L_f)$，即累积到火焰长度处的摩尔分数。\n\n您必须使用固定的步长和沿 $x$ 的前向欧拉时间步进法，对 $Y_f(x)$ 和 $Y_{\\mathrm{NO}}(x)$ 的耦合常微分方程进行数值积分，从\n$$Y_f(0) = Y_{f,0},\\quad Y_{\\mathrm{NO}}(0) = 0,$$\n开始，如果在域末端之前找到了火焰长度，则在 $x = L_f$ 处终止。如果在域限制 $x_{\\max}$ 内未达到阈值，则报告 $L_f = x_{\\max}$ 和相应的 $Y_{\\mathrm{NO}}(x_{\\max})$。\n\n在您的程序中使用以下常数和参数：\n- $U_0 = 50$ m/s (喷嘴出口速度)。\n- $D = 0.01$ m (喷嘴直径)。\n- $a = 0.12$ (速度衰减参数)。\n- $C_k = 0.02$ (湍动能系数)。\n- $C_\\varepsilon = 0.05$ (湍流耗散系数)。\n- $\\nu = 1.5\\times 10^{-5}$ m$^2$/s (运动粘度)。\n- $Y_{f,0} = 0.055$ (初始燃料质量分数)。\n- $\\theta = 0.01$ (用于定义火焰长度的阈值分数)。\n- $T_0 = 300$ K (入流温度)。\n- $\\Delta T = 1500$ K (绝热温升)。\n- $C_r = 0.01$ (燃料消耗的全局反应标度)。\n- $C_{\\mathrm{NO}} = 0.1$ (热力型氮氧化物标度)。\n- $E_{\\mathrm{NO}} = 7.5\\times 10^4$ J/mol (有效活化能)。\n- $R_u = 8.314$ J/(mol·K) (通用气体常数)。\n- $x_{\\max} = 5.0$ m (最大积分长度)。\n- $\\Delta x = 10^{-3}$ m (积分步长)。\n\n敏感性测试套件：\n- 基准: $(C_\\tau, C_\\xi) = (0.408, 2.0)$。\n- 情况1: $(C_\\tau, C_\\xi) = (0.408\\times 0.95, 2.0)$。\n- 情况2: $(C_\\tau, C_\\xi) = (0.408\\times 1.05, 2.0)$。\n- 情况3: $(C_\\tau, C_\\xi) = (0.408, 2.0\\times 0.95)$。\n- 情况4: $(C_\\tau, C_\\xi) = (0.408, 2.0\\times 1.05)$。\n- 情况5: $(C_\\tau, C_\\xi) = (0.408\\times 0.95, 2.0\\times 0.95)$。\n- 情况6: $(C_\\tau, C_\\xi) = (0.408\\times 1.05, 2.0\\times 1.05)$。\n\n要求与输出：\n- 实现上述模型，并为每种情况计算 $(L_f, Y_{\\mathrm{NO}}(L_f))$。\n- 火焰长度 $L_f$ 以米表示，氮氧化物摩尔分数 $Y_{\\mathrm{NO}}(L_f)$ 以无量纲浮点数表示。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表中的每个元素是对应一种情况的双元素列表，每个浮点数四舍五入到五位小数。例如：$[[L_1,Y_1],[L_2,Y_2],\\dots]$。\n\n此问题要求根据所提供的守恒定律和 EDC 定义推导并实现算法；请勿引入任何超出上述指定的公式或参数，并通过遵守给定的模型和常数来确保科学真实性。所有可能出现的角度（如有）必须以弧度处理；本问题未明确要求使用角度。所有测试用例的最终输出必须是指定的浮点数或浮点数列表。",
            "solution": "用户要求对一个湍流射流火焰模型进行敏感性分析。该分析需要数值求解一个耦合常微分方程组（ODEs），该方程组描述了沿射流中心线的组分守恒。该模型基于用于湍流-化学相互作用的涡耗散概念（EDC）。\n\n### **问题验证**\n\n**步骤 1：提取已知条件**\n\n-   **中心线速度**: $U(x) = \\frac{U_0}{1 + a \\frac{x}{D}}$\n-   **湍动能**: $k(x) = C_k U(x)^2$\n-   **湍流耗散率**: $\\varepsilon(x) = C_\\varepsilon \\frac{U(x)^3}{D}$\n-   **精细结构停留时间**: $\\tau^\\ast(x) = C_\\tau \\sqrt{\\nu / \\varepsilon(x)}$\n-   **精细结构质量分数**: $\\xi(x) = C_\\xi \\left(\\frac{\\nu \\varepsilon(x)}{k(x)^2}\\right)^{1/4}$\n-   **燃料质量分数 ODE**: $U(x)\\frac{dY_f}{dx} = - \\omega_f(x)$\n-   **燃料反应源项**: $\\omega_f(x) = C_r\\,\\xi(x)\\,\\frac{Y_f(x)}{\\tau^\\ast(x)}$\n-   **温度关系**: $T(x) = T_0 + \\Delta T\\left(1 - \\frac{Y_f(x)}{Y_{f,0}}\\right)$\n-   **氮氧化物摩尔分数 ODE**: $U(x)\\frac{dY_{\\mathrm{NO}}}{dx} = C_{\\mathrm{NO}}\\,\\xi(x)\\,\\exp\\left(-\\frac{E_{\\mathrm{NO}}}{R_u\\,T(x)}\\right)$\n-   **火焰长度定义**: $L_f$ 是满足 $Y_f(x) \\le \\theta\\,Y_{f,0}$ 的最小 $x$。\n-   **初始条件**: $Y_f(0) = Y_{f,0}$, $Y_{\\mathrm{NO}}(0) = 0$。\n-   **数值方法**: 前向欧拉法，步长 $\\Delta x$。\n-   **域限制**: 如果在 $x_{\\max}$ 之前未找到火焰长度，则 $L_f = x_{\\max}$，报告的 $Y_{\\mathrm{NO}}$ 为 $Y_{\\mathrm{NO}}(x_{\\max})$。\n-   **常数**: $U_0 = 50$ m/s, $D = 0.01$ m, $a = 0.12$, $C_k = 0.02$, $C_\\varepsilon = 0.05$, $\\nu = 1.5\\times 10^{-5}$ m$^2$/s, $Y_{f,0} = 0.055$, $\\theta = 0.01$, $T_0 = 300$ K, $\\Delta T = 1500$ K, $C_r = 0.01$, $C_{\\mathrm{NO}} = 0.1$, $E_{\\mathrm{NO}} = 7.5\\times 10^4$ J/mol, $R_u = 8.314$ J/(mol·K)。\n-   **积分参数**: $x_{\\max} = 5.0$ m, $\\Delta x = 10^{-3}$ m。\n-   **$(C_\\tau, C_\\xi)$ 的敏感性测试套件**: 基准 $(0.408, 2.0)$，以及六个带有 $\\pm 5\\%$ 变化的变体。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题具有科学依据，采用了湍流燃烧领域的标准模型（尽管有所简化），如自相似射流理论、EDC、阿伦尼乌斯动力学。问题定义良好，提供了一整套常微分方程、初始条件、常数和指定的数值方法，确保可以计算出唯一的解。语言客观、精确。问题是自包含的、可形式化的，并且计算上是可行的。不存在逻辑矛盾或事实错误。\n\n**步骤 3：结论与行动**\n\n问题有效。将提供一个合理的解法。\n\n### **基于原理的求解推导**\n\n核心任务是求解关于燃料质量分数 $Y_f(x)$ 和氮氧化物摩尔分数 $Y_{\\mathrm{NO}}(x)$ 沿轴向坐标 $x$ 的一个初值问题系统。\n\n**1. 控制方程**\n系统的状态由向量 $\\mathbf{Y}(x) = [Y_f(x), Y_{\\mathrm{NO}}(x)]^T$ 描述。该状态的演化由以下一阶常微分方程组控制：\n$$\n\\frac{dY_f}{dx} = -\\frac{1}{U(x)} \\omega_f(x)\n$$\n$$\n\\frac{dY_{\\mathrm{NO}}}{dx} = \\frac{1}{U(x)} C_{\\mathrm{NO}}\\,\\xi(x)\\,\\exp\\left(-\\frac{E_{\\mathrm{NO}}}{R_u\\,T(x)}\\right)\n$$\n这些方程表示了沿一维流线由于对流和化学反应引起的组分分数变化。\n\n**2. 模型分量公式化**\n为了求解常微分方程，右侧的所有项都必须表示为自变量 $x$ 和状态变量 $Y_f$ 及 $Y_{\\mathrm{NO}}$ 的函数。\n\n首先，我们定义仅依赖于轴向位置 $x$ 的量：\n-   中心线速度: $U(x) = \\frac{U_0}{1 + a x/D}$。\n-   湍动能: $k(x) = C_k U(x)^2$。\n-   湍流耗散率: $\\varepsilon(x) = C_\\varepsilon U(x)^3/D$。\n\n使用这些量，我们定义 EDC 模型参数，这些参数是反应模型的核心，并通过其常数 $C_\\tau$ 和 $C_\\xi$ 成为敏感性研究的对象：\n-   精细结构停留时间: $\\tau^\\ast(x) = C_\\tau \\sqrt{\\nu/\\varepsilon(x)}$。这代表了火焰精细结构内混合的特征时间。\n-   精细结构质量分数: $\\xi(x) = C_\\xi \\left(\\frac{\\nu \\varepsilon(x)}{k(x)^2}\\right)^{1/4}$。这是流体中被反应性精细结构占据的质量比例。\n\n接下来，我们定义依赖于状态变量 $Y_f$ 的项：\n-   温度: $T(x) = T_0 + \\Delta T\\left(1 - \\frac{Y_f(x)}{Y_{f,0}}\\right)$。这将局部温度与燃料消耗程度联系起来。\n-   燃料反应速率: $\\omega_f(x) = C_r\\,\\xi(x)\\,\\frac{Y_f(x)}{\\tau^\\ast(x)}$。这是一个混合限制的反应速率，与反应结构（质量分数 $\\xi$）中可用的燃料量 $Y_f$ 成正比，与混合时间 $\\tau^\\ast$ 成反比。\n\n**3. 数值积分算法**\n问题指定了前向欧拉法，这是一种求解常微分方程的一阶数值格式。对于一个泛型常微分方程 $\\frac{dy}{dx} = f(x, y)$，其更新规则为 $y_{i+1} = y_i + \\Delta x \\cdot f(x_i, y_i)$，其中 $x_i = i \\cdot \\Delta x$。\n\n将此方法应用于我们的系统，我们得到从步骤 $i$ 到 $i+1$ 的离散更新方程：\n$$\nY_{f,i+1} = Y_{f,i} - \\Delta x \\left( \\frac{\\omega_{f,i}}{U_i} \\right)\n$$\n$$\nY_{\\mathrm{NO},i+1} = Y_{\\mathrm{NO},i} + \\Delta x \\left( \\frac{C_{\\mathrm{NO}}\\,\\xi_i}{U_i} \\exp\\left(-\\frac{E_{\\mathrm{NO}}}{R_u\\,T_i}\\right) \\right)\n$$\n其中 $U_i = U(x_i)$，$\\xi_i = \\xi(x_i)$，$T_i = T(Y_{f,i})$，以及 $\\omega_{f,i} = \\omega_f(x_i, Y_{f,i})$。\n\n对于每个测试用例 $(C_\\tau, C_\\xi)$ 的整体算法如下：\n1.  根据提供的信息初始化参数和常数。\n2.  在 $x=0$ 处设置初始状态：$Y_f = Y_{f,0}$，$Y_{\\mathrm{NO}} = 0$。\n3.  计算用于检测火焰长度的燃料质量分数阈值：$Y_{f, \\text{crit}} = \\theta \\cdot Y_{f,0}$。\n4.  开始一个从 $x=0$ 到 $x_{\\max}$ 的离散空间步长循环，增量为 $\\Delta x$。\n5.  在位置 $x_i$ 的每个步骤 $i$ 开始时：\n    a. 检查火焰是否完成：如果 $Y_{f,i} \\le Y_{f, \\text{crit}}$，则火焰长度为 $L_f = x_i$。记录 $L_f$ 和当前的氮氧化物值 $Y_{\\mathrm{NO},i}$。终止本次积分，并继续下一个测试用例。\n    b. 如果火焰未完成，根据当前状态 $(x_i, Y_{f,i})$ 计算所有辅助量：$U_i, k_i, \\varepsilon_i, \\tau^\\ast_i, \\xi_i, T_i$。\n    c. 使用这些量来评估步骤 $i$ 处的导数 $dY_f/dx$ 和 $dY_{\\mathrm{NO}}/dx$。\n    d. 应用前向欧拉更新规则计算 $Y_{f,i+1}$ 和 $Y_{\\mathrm{NO},i+1}$。\n    e. 将状态推进到下一步。\n6.  如果循环完成而未满足火焰长度条件，则火焰延伸超出了计算域。在这种情况下，设置 $L_f = x_{\\max}$ 并记录在 $x_{\\max}$ 处的最终 $Y_{\\mathrm{NO}}$ 值。\n7.  存储当前测试用例的配对 $(L_f, Y_{\\mathrm{NO}}(L_f))$。\n8.  处理完所有测试用例后，根据指定的输出格式将收集到的结果格式化为单个字符串。\n\n这个结构化的过程确保了通过忠实地实现所提供的物理模型和数值指令来获得解。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes flame length and nitric oxide formation in a turbulent jet flame\n    using the Eddy Dissipation Concept (EDC) model. It performs a sensitivity\n    analysis for the EDC constants C_tau and C_xi.\n    \"\"\"\n    # Define physical and model constants\n    U0 = 50.0        # Nozzle exit velocity (m/s)\n    D = 0.01         # Nozzle diameter (m)\n    a = 0.12         # Velocity decay parameter (dimensionless)\n    Ck = 0.02        # Turbulent kinetic energy coefficient (dimensionless)\n    Ceps = 0.05      # Turbulence dissipation coefficient (dimensionless)\n    nu = 1.5e-5      # Kinematic viscosity (m^2/s)\n    Yf0 = 0.055      # Initial fuel mass fraction (dimensionless)\n    theta = 0.01     # Flame length threshold fraction (dimensionless)\n    T0 = 300.0       # Inflow temperature (K)\n    Delta_T = 1500.0 # Adiabatic temperature rise (K)\n    Cr = 0.01        # Global reaction scaling for fuel consumption (dimensionless)\n    C_NO = 0.1       # Thermal nitric oxide scaling (dimensionless)\n    E_NO = 7.5e4     # Effective activation energy for NO (J/mol)\n    Ru = 8.314       # Universal gas constant (J/(mol*K))\n\n    # Numerical integration parameters\n    x_max = 5.0      # Maximum integration length (m)\n    dx = 1e-3        # Integration step size (m)\n\n    # Define the sensitivity test suite for (C_tau, C_xi)\n    C_tau_base = 0.408\n    C_xi_base = 2.0\n    test_cases = [\n        (C_tau_base, C_xi_base),                          # Baseline\n        (C_tau_base * 0.95, C_xi_base),                   # Case 1\n        (C_tau_base * 1.05, C_xi_base),                   # Case 2\n        (C_tau_base, C_xi_base * 0.95),                   # Case 3\n        (C_tau_base, C_xi_base * 1.05),                   # Case 4\n        (C_tau_base * 0.95, C_xi_base * 0.95),            # Case 5\n        (C_tau_base * 1.05, C_xi_base * 1.05),            # Case 6\n    ]\n\n    results = []\n    Yf_threshold = theta * Yf0\n    num_steps = int(x_max / dx)\n\n    # Loop through each test case\n    for C_tau, C_xi in test_cases:\n        # Initialize state variables for the current case\n        Yf = Yf0\n        Yno = 0.0\n        Lf = x_max\n        Yno_at_Lf = 0.0\n        found_flame = False\n\n        # Perform numerical integration along x\n        for i in range(num_steps + 1):\n            current_x = i * dx\n            \n            if Yf = Yf_threshold and not found_flame:\n                Lf = current_x\n                Yno_at_Lf = Yno\n                found_flame = True\n                break\n\n            # Calculate auxiliary variables at the current step\n            U = U0 / (1.0 + a * current_x / D)\n            if U == 0: break\n            \n            k = Ck * U**2\n            eps = Ceps * U**3 / D\n            if k == 0 or eps == 0: break\n\n            # EDC model parameters with corrected tau_star\n            tau_star = C_tau * np.sqrt(nu / eps)\n            xi = C_xi * (nu * eps / k**2)**0.25\n\n            # Temperature\n            T = T0 + Delta_T * (1.0 - Yf / Yf0)\n\n            # Calculate derivatives for Forward Euler step\n            # Fuel consumption rate\n            if tau_star == 0:\n                omega_f = 0.0\n            else:\n                omega_f = Cr * xi * Yf / tau_star\n            dYf_dx = -omega_f / U\n\n            # NO formation rate\n            if T = 0:\n                dYno_dx = 0.0\n            else:\n                dYno_dx = (C_NO * xi / U) * np.exp(-E_NO / (Ru * T))\n\n            # Update state variables\n            Yf += dYf_dx * dx\n            Yno += dYno_dx * dx\n        \n        if not found_flame:\n            Lf = x_max\n            Yno_at_Lf = Yno\n\n        results.append([round(Lf, 5), round(Yno_at_Lf, 5)])\n\n    # Format the output string as a list of lists.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}