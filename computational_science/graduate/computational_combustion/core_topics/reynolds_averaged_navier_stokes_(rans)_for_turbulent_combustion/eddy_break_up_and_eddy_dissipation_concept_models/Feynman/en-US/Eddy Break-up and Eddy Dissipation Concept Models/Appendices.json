{
    "hands_on_practices": [
        {
            "introduction": "This first exercise grounds our study in the foundational Eddy Break-Up (EBU) model. Before tackling more complex scenarios, it is crucial to master the calculation of a mixing-limited reaction rate, which assumes chemistry is infinitely fast. This practice will guide you through calculating the fuel destruction rate based on local turbulence properties and identifying the limiting reactant, a core skill in analyzing non-premixed flames.",
            "id": "4022740",
            "problem": "A turbulent, nonpremixed methane–air flame is simulated under the mixing-controlled regime at large Damköhler number, where chemical time scales are much shorter than turbulent time scales. In the Eddy Break-Up (EBU) model, which is a mixing-limited closure consistent with the Eddy Dissipation Concept (EDC), the fuel destruction rate per unit volume, denoted by $\\dot{\\omega}_{F}$, is defined as the net production rate of fuel (negative for consumption). Assume:\n- The characteristic turbulent micromixing frequency is set by Kolmogorov scaling as the ratio of the turbulent kinetic energy dissipation rate to the turbulent kinetic energy, i.e., $\\epsilon/k$.\n- Stoichiometric coupling enforces that reactants are consumed in proportion to the stoichiometric oxygen-to-fuel mass ratio $s$, so that the amount of oxidizer that can react with fuel is limited by $Y_{O}/s$, and the reactant availability that controls the mixing-driven reaction events is the smaller of $Y_{F}$ and $Y_{O}/s$.\n- The proportionality between the fuel destruction rate and the turbulent mixing frequency is captured by a dimensionless EBU constant $A$.\n\nGiven methane–air with stoichiometric oxygen-to-fuel mass ratio $s=4$, mixture density $\\rho=1.2\\,\\mathrm{kg/m^3}$, turbulent kinetic energy $k=0.5\\,\\mathrm{m^2/s^2}$, dissipation rate $\\epsilon=25\\,\\mathrm{m^2/s^3}$, fuel mass fraction $Y_{F}=0.02$, oxidizer (oxygen) mass fraction $Y_{O}=0.20$, and the EBU constant $A=4.0$, derive an expression for $\\dot{\\omega}_{F}$ in terms of the given quantities based on the above principles, evaluate it numerically, and state which reactant is limiting under the EBU assumption.\n\nRound your numerical value of $\\dot{\\omega}_{F}$ to three significant figures and express it in $\\mathrm{kg/(m^3\\,s)}$.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Model:** Eddy Break-Up (EBU) model for a turbulent, nonpremixed flame in the mixing-controlled regime (large Damköhler number).\n- **Definition:** The fuel destruction rate per unit volume, $\\dot{\\omega}_{F}$, is the net production rate of fuel.\n- **Turbulent Mixing Frequency:** The characteristic turbulent micromixing frequency is given by the ratio $\\frac{\\epsilon}{k}$.\n- **Stoichiometry and Limiting Reactant:** Reactant availability is determined by the smaller of the fuel mass fraction, $Y_{F}$, and the stoichiometrically adjusted oxidizer mass fraction, $\\frac{Y_{O}}{s}$, where $s$ is the stoichiometric oxygen-to-fuel mass ratio.\n- **Proportionality Constant:** A dimensionless EBU constant, $A$.\n- **Values:**\n  - Stoichiometric oxygen-to-fuel mass ratio, $s = 4$.\n  - Mixture density, $\\rho = 1.2\\,\\mathrm{kg/m^3}$.\n  - Turbulent kinetic energy, $k = 0.5\\,\\mathrm{m^2/s^2}$.\n  - Turbulent kinetic energy dissipation rate, $\\epsilon = 25\\,\\mathrm{m^2/s^3}$.\n  - Fuel mass fraction, $Y_{F} = 0.02$.\n  - Oxidizer mass fraction, $Y_{O} = 0.20$.\n  - EBU constant, $A = 4.0$.\n- **Task:** Derive an expression for $\\dot{\\omega}_{F}$, evaluate it numerically to three significant figures, and identify the limiting reactant.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on the well-established Eddy Break-Up (EBU) model by Magnussen and Hjertager, a cornerstone of turbulent combustion modeling. The premises—mixing-limited reaction, large Damköhler number, and Kolmogorov scaling for the turbulent frequency ($\\frac{\\epsilon}{k}$)—are standard and physically sound assumptions for this regime. The stoichiometric relationship for methane-air combustion ($\\text{CH}_4 + 2\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\text{H}_2\\text{O}$) gives a mass ratio $s = \\frac{2 \\times M_{\\text{O}_2}}{M_{\\text{CH}_4}} = \\frac{2 \\times 32}{16} = 4$, which matches the given value. The problem is scientifically valid.\n2.  **Well-Posed:** All necessary constants and variables ($A, \\rho, k, \\epsilon, Y_{F}, Y_{O}, s$) are provided. The objective is clearly stated. A unique solution exists.\n3.  **Objective:** The problem is stated using precise, objective, scientific terminology.\n4.  **Consistency:** The units are dimensionally consistent. The reaction rate $\\dot{\\omega}_{F}$ is expected in $\\mathrm{kg/(m^3 s)}$. The proposed expression will have units of $(\\mathrm{kg/m^3}) \\times (\\mathrm{s^{-1}}) \\times (\\text{dimensionless}) = \\mathrm{kg/(m^3 s)}$. The provided numerical values are physically plausible for a turbulent flame.\n5.  **Conclusion:** The problem is valid, self-contained, scientifically sound, and well-posed.\n\n### Solution Derivation\nThe net production rate of fuel, $\\dot{\\omega}_{F}$, within the Eddy Break-Up (EBU) model framework is modeled as being proportional to the rate at which the limiting reactant is mixed at the molecular level. This rate is a function of the local mixture density, the turbulent mixing frequency, and the mass fraction of the limiting reactant.\n\nBased on the problem statement:\n1.  The turbulent mixing frequency is $\\frac{\\epsilon}{k}$.\n2.  The reaction rate is proportional to the mixture density $\\rho$.\n3.  The controlling concentration is that of the limiting reactant. To find the limiting reactant, we must compare the available fuel mass fraction, $Y_{F}$, with the stoichiometrically equivalent oxidizer mass fraction, $\\frac{Y_{O}}{s}$. The effective reactant mass fraction is therefore $\\min(Y_{F}, \\frac{Y_{O}}{s})$.\n4.  The proportionality constant is the EBU constant, $A$.\n5.  Since $\\dot{\\omega}_{F}$ is defined as the net *production* rate, and fuel is being consumed, the expression must carry a negative sign.\n\nCombining these elements, the general expression for the fuel net production rate is:\n$$ \\dot{\\omega}_{F} = - A \\rho \\frac{\\epsilon}{k} \\min\\left(Y_{F}, \\frac{Y_{O}}{s}\\right) $$\nThis is the required expression.\n\nNext, we must identify the limiting reactant by substituting the given values:\n- Fuel mass fraction: $Y_{F} = 0.02$.\n- Oxidizer mass fraction: $Y_{O} = 0.20$.\n- Stoichiometric mass ratio: $s = 4$.\n\nWe compute the stoichiometrically adjusted oxidizer mass fraction:\n$$ \\frac{Y_{O}}{s} = \\frac{0.20}{4} = 0.05 $$\nNow, we compare this value with the fuel mass fraction:\n$$ Y_{F} = 0.02 \\quad \\text{and} \\quad \\frac{Y_{O}}{s} = 0.05 $$\nSince $0.02  0.05$, we have $Y_{F}  \\frac{Y_{O}}{s}$.\nTherefore, **the fuel is the limiting reactant**.\n\nWith the limiting reactant identified, the expression for $\\dot{\\omega}_{F}$ simplifies to:\n$$ \\dot{\\omega}_{F} = - A \\rho \\frac{\\epsilon}{k} Y_{F} $$\nNow, we can substitute the numerical values to evaluate $\\dot{\\omega}_{F}$:\n- $A = 4.0$\n- $\\rho = 1.2\\,\\mathrm{kg/m^3}$\n- $\\epsilon = 25\\,\\mathrm{m^2/s^3}$\n- $k = 0.5\\,\\mathrm{m^2/s^2}$\n- $Y_{F} = 0.02$\n\nThe calculation proceeds as follows:\n$$ \\dot{\\omega}_{F} = - (4.0) \\times (1.2\\,\\mathrm{kg/m^3}) \\times \\left(\\frac{25\\,\\mathrm{m^2/s^3}}{0.5\\,\\mathrm{m^2/s^2}}\\right) \\times (0.02) $$\nFirst, calculate the turbulent frequency $\\frac{\\epsilon}{k}$:\n$$ \\frac{\\epsilon}{k} = \\frac{25}{0.5} = 50\\,\\mathrm{s^{-1}} $$\nSubstitute this back into the equation for $\\dot{\\omega}_{F}$:\n$$ \\dot{\\omega}_{F} = - (4.0) \\times (1.2) \\times (50) \\times (0.02)\\,\\mathrm{kg/(m^3\\,s)} $$\n$$ \\dot{\\omega}_{F} = - (4.8) \\times (1.0)\\,\\mathrm{kg/(m^3\\,s)} $$\n$$ \\dot{\\omega}_{F} = -4.8\\,\\mathrm{kg/(m^3\\,s)} $$\nThe problem requires the result to be rounded to three significant figures.\n$$ \\dot{\\omega}_{F} = -4.80\\,\\mathrm{kg/(m^3\\,s)} $$",
            "answer": "$$ \\boxed{-4.80} $$"
        },
        {
            "introduction": "The EBU model's assumption of infinitely fast chemistry is powerful but has its limits. This practice introduces the Damköhler number ($Da$), a critical dimensionless group that quantifies the ratio of turbulent mixing time to chemical reaction time. Calculating $Da$ is the fundamental diagnostic step for determining whether a simple mixing-limited model is appropriate or if the complexities of finite-rate chemistry, handled by models like the Eddy Dissipation Concept (EDC), must be considered.",
            "id": "4022767",
            "problem": "A methane–air jet flame issues into a coflowing ambient at laboratory conditions. Reynolds-Averaged Navier–Stokes (RANS) measurements in the flame brush yield a turbulent kinetic energy $k$ and a dissipation rate $\\epsilon$ at a representative location, and an independently estimated chemical time scale $\\tau_{\\mathrm{chem}}$ for the dominant methane oxidation pathway under the local thermochemical state.\n\nUsing fundamental definitions and scaling arguments, derive an expression for the Damköhler number $Da$ as the ratio of a characteristic turbulent mixing time to the chemical time scale, expressed in terms of $k$ and $\\epsilon$. Then evaluate $Da$ for the given data and use its magnitude to decide which modeling assumption is more appropriate at this location: the Eddy Break-Up (EBU) model, which presumes mixing-controlled combustion with effectively fast chemistry, or the Eddy Dissipation Concept (EDC), which accounts for finite-rate chemistry within turbulent fine structures.\n\nData:\n- Turbulent kinetic energy: $k = 0.8\\,\\mathrm{m^2/s^2}$\n- Dissipation rate: $\\epsilon = 40\\,\\mathrm{m^2/s^3}$\n- Chemical time scale: $\\tau_{\\mathrm{chem}} = 5 \\times 10^{-4}\\,\\mathrm{s}$\n\nInstructions:\n- Compute the Damköhler number $Da$ using the derived expression and round your numerical value to three significant figures. Express $Da$ as a pure number with no units.\n- Encode the model choice as $M$, where $M = 0$ if the Eddy Break-Up (EBU) model is appropriate and $M = 1$ if the Eddy Dissipation Concept (EDC) is appropriate.\n- Provide your final answer as a row matrix containing two entries $\\big[Da \\;\\; M\\big]$.",
            "solution": "The problem requires the derivation of an expression for the Damköhler number, $Da$, its numerical evaluation, and a subsequent decision on the appropriate combustion model for the given conditions.\n\nFirst, we address the derivation. The Damköhler number is defined as the ratio of a characteristic turbulent mixing time, $\\tau_{\\text{turb}}$, to the chemical time scale, $\\tau_{\\text{chem}}$.\n$$\nDa = \\frac{\\tau_{\\text{turb}}}{\\tau_{\\text{chem}}}\n$$\nThe problem is situated within the context of a Reynolds-Averaged Navier–Stokes (RANS) simulation, where turbulence is characterized by the turbulent kinetic energy, $k$, and its dissipation rate, $\\epsilon$. The turbulent kinetic energy, $k$, has units of velocity squared, $[\\mathrm{L}^2 \\mathrm{T}^{-2}]$, and represents the energy per unit mass contained in the large, energy-carrying turbulent eddies. The dissipation rate, $\\epsilon$, has units of energy per unit mass per unit time, $[\\mathrm{L}^2 \\mathrm{T}^{-3}]$, and represents the rate at which $k$ is dissipated into heat by viscous forces at the smallest eddies.\n\nA characteristic time scale for the large eddies, which governs the rate of turbulent mixing, can be constructed from $k$ and $\\epsilon$ through dimensional analysis. We seek a combination of $k$ and $\\epsilon$ that yields units of time, $[\\mathrm{T}]$.\n$$\n\\frac{[k]}{[\\epsilon]} = \\frac{[\\mathrm{L}^2 \\mathrm{T}^{-2}]}{[\\mathrm{L}^2 \\mathrm{T}^{-3}]} = [\\mathrm{T}]\n$$\nThis suggests that the turbulent mixing time is proportional to the ratio $k/\\epsilon$. In the context of large-eddy turnover time, the constant of proportionality is taken as unity. Therefore, we define the characteristic turbulent mixing time as:\n$$\n\\tau_{\\text{turb}} = \\frac{k}{\\epsilon}\n$$\nSubstituting this expression into the definition of the Damköhler number yields the required expression in terms of $k$, $\\epsilon$, and $\\tau_{\\text{chem}}$:\n$$\nDa = \\frac{k/\\epsilon}{\\tau_{\\text{chem}}} = \\frac{k}{\\epsilon \\tau_{\\text{chem}}}\n$$\nNext, we evaluate this expression using the provided data:\n- Turbulent kinetic energy: $k = 0.8\\,\\mathrm{m^2/s^2}$\n- Dissipation rate: $\\epsilon = 40\\,\\mathrm{m^2/s^3}$\n- Chemical time scale: $\\tau_{\\text{chem}} = 5 \\times 10^{-4}\\,\\mathrm{s}$\n\nSubstituting these values into the derived formula for $Da$:\n$$\nDa = \\frac{0.8\\,\\mathrm{m^2/s^2}}{(40\\,\\mathrm{m^2/s^3})(5 \\times 10^{-4}\\,\\mathrm{s})}\n$$\nFirst, calculate the value of the denominator:\n$$\n(40) \\times (5 \\times 10^{-4}) = 200 \\times 10^{-4} = 0.02\n$$\nThe units in the denominator are $(\\mathrm{m^2/s^3}) \\cdot \\mathrm{s} = \\mathrm{m^2/s^2}$, which matches the units of the numerator, confirming that $Da$ is a dimensionless quantity.\nNow, we compute the final value for $Da$:\n$$\nDa = \\frac{0.8}{0.02} = \\frac{80}{2} = 40\n$$\nThe problem instructs to round the value to three significant figures. Thus, $Da = 40.0$.\n\nFinally, we must choose the appropriate combustion model based on the magnitude of $Da$. The Damköhler number compares the time scale of fluid mixing to the time scale of chemical reaction.\n- If $Da \\gg 1$, then $\\tau_{\\text{turb}} \\gg \\tau_{\\text{chem}}$. This indicates that the chemical reactions are very fast compared to the turbulent mixing process. The overall rate of combustion is therefore limited by the rate at which reactants are mixed. This is the \"fast chemistry\" regime, for which the Eddy Break-Up (EBU) model is designed.\n- If $Da \\approx 1$ or $Da  1$, then $\\tau_{\\text{turb}}$ is on the same order as or smaller than $\\tau_{\\text{chem}}$. This means the chemical kinetics are not negligibly fast and can be a rate-limiting step. In this \"finite-rate chemistry\" regime, a model such as the Eddy Dissipation Concept (EDC), which accounts for the interaction between turbulence and chemistry, is required.\n\nIn our case, $Da = 40.0$. Since $40.0 \\gg 1$, the chemistry is much faster than the turbulent mixing. The combustion process at this location is mixing-controlled. Therefore, the Eddy Break-Up (EBU) model, which is based on the fast chemistry assumption, is the more appropriate modeling choice.\n\nThe problem specifies an encoding for the model choice, $M$, where $M=0$ for the EBU model and $M=1$ for the EDC model. Based on our analysis, the EBU model is appropriate, which corresponds to:\n$$\nM = 0\n$$\nThe final answer is to be presented as a row matrix $[Da \\;\\; M]$.\nThe computed values are $Da = 40.0$ and $M=0$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40.0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "When the Damköhler number indicates that chemical timescales are significant, we turn to the Eddy Dissipation Concept (EDC). The essence of the EDC model is to resolve chemical reactions within small, idealized reactors known as 'fine structures'. This computational exercise provides direct, hands-on experience with this concept by tasking you to simulate the chemical kinetics within a single fine structure, bridging the gap between abstract theory and practical implementation.",
            "id": "4022728",
            "problem": "Consider a perfectly stirred fine-structure element in a turbulent reacting flow as modeled by the Eddy Dissipation Concept (EDC). Under the EDC assumption, the reacting fine structures are treated as ideal, well-mixed reactors with a finite residence time, and reactants enter from the surrounding non-reacting fluid with mass fractions that match the bulk (coarse-grid) values. In this problem, you will compute the fine-structure mass fractions $Y_i^*$ by integrating species conservation ordinary differential equations over a specified residence time $\\tau^*$ for a two-step, sequential, pseudo-first-order mechanism representing methane oxidation: $\\text{CH}_4 \\to \\text{CO} \\to \\text{CO}_2$.\n\nStarting from the following fundamental base:\n- Species conservation in a well-mixed reactor implies that the temporal change of each species mass fraction is equal to the net production rate due to chemical reaction, expressed as an ordinary differential equation in time.\n- The effective reaction rates for elementary steps in the fine structure can be modeled as pseudo-first-order with respect to the reactant species when the oxidizer is in large excess inside the fine structures. The temperature dependence of each step is captured by Arrhenius kinetics, with rate constants given by $k_j(T) = A_j \\exp\\left(-\\dfrac{E_{a,j}}{R T}\\right)$ for step $j$, where $A_j$ is the preexponential factor, $E_{a,j}$ is the activation energy, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n- The fine-structure residence time $\\tau^*$ is the time over which the fine structure evolves chemically before its content is exchanged with the surrounding fluid (in the context of EDC modeling, this is proportional to the smallest turbulent time scales, but here it is prescribed).\n\nYour task is to:\n1. Formulate the species conservation ordinary differential equations for the sequential mechanism $\\text{CH}_4 \\to \\text{CO} \\to \\text{CO}_2$ under the pseudo-first-order assumption with Arrhenius rate constants $k_1(T)$ and $k_2(T)$.\n2. Integrate these equations over the residence time $\\tau^*$ starting from the initial conditions equal to the bulk mass fractions at the entrance to the fine structure to obtain $Y_{\\mathrm{CH_4}}^*$, $Y_{\\mathrm{CO}}^*$, and $Y_{\\mathrm{CO_2}}^*$.\n3. Demonstrate sensitivity of $Y_i^*$ to changes in temperature $T$ and preexponential factors $A_1$, $A_2$ by computing the final values under multiple parameter sets.\n\nUse the universal gas constant $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. Treat the oxidizer concentration as constant (large excess) so that the mechanism is pseudo-first-order in the tracked species. Express temperature in $\\mathrm{K}$, rate constants in $\\mathrm{s}^{-1}$, activation energies in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$, residence time in $\\mathrm{s}$, and mass fractions as dimensionless decimals. The fine-structure mass fractions $Y_i^*$ must be reported rounded to six decimal places.\n\nImplement a complete, runnable program that solves the above by numerical integration of the ordinary differential equations. Use the following test suite of parameter sets to probe the \"happy path\", boundary conditions, and edge cases:\n\n- Test case $1$ (baseline): $T = 1800\\,\\mathrm{K}$, $\\tau^* = 1.0\\times 10^{-4}\\,\\mathrm{s}$, $A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$, $E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $A_2 = 5.0\\times 10^{6}\\,\\mathrm{s}^{-1}$, $E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, initial mass fractions $[Y_{\\mathrm{CH_4}}(0), Y_{\\mathrm{CO}}(0), Y_{\\mathrm{CO_2}}(0)] = [0.05, 0.0, 0.0]$.\n- Test case $2$ (boundary $\\tau^* = 0$): same parameters as test case $1$, but $\\tau^* = 0.0\\,\\mathrm{s}$.\n- Test case $3$ (lower temperature): $T = 1200\\,\\mathrm{K}$, $\\tau^* = 1.0\\times 10^{-4}\\,\\mathrm{s}$, $A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$, $E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $A_2 = 5.0\\times 10^{6}\\,\\mathrm{s}^{-1}$, $E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, initial mass fractions $[0.05, 0.0, 0.0]$.\n- Test case $4$ (higher $A_1$): same as test case $1$ but with $A_1 = 1.0\\times 10^{8}\\,\\mathrm{s}^{-1}$.\n- Test case $5$ (higher temperature, shorter residence, slower second step, nonzero intermediate): $T = 2200\\,\\mathrm{K}$, $\\tau^* = 2.0\\times 10^{-5}\\,\\mathrm{s}$, $A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$, $E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $A_2 = 5.0\\times 10^{5}\\,\\mathrm{s}^{-1}$, $E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, initial mass fractions $[0.04, 0.01, 0.0]$.\n- Test case $6$ (long residence time, near-complete conversion): same as test case $1$ but with $\\tau^* = 2.0\\times 10^{-3}\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a sublist of the three final mass fractions $[Y_{\\mathrm{CH_4}}^*, Y_{\\mathrm{CO}}^*, Y_{\\mathrm{CO_2}}^*]$ rounded to six decimal places. For example, the output format must be of the form $[[y_{11},y_{12},y_{13}],[y_{21},y_{22},y_{23}],\\dots]$, where each $y_{ij}$ is a decimal with six digits after the decimal point.",
            "solution": "The problem presented is valid. It is scientifically grounded in the principles of chemical kinetics and reaction engineering, specifically the modeling of a well-mixed reactor, a concept central to the Eddy Dissipation Concept (EDC) in turbulent combustion. The problem is well-posed as an initial value problem for a system of ordinary differential equations, with all necessary parameters and initial conditions provided. It is objective and free of any non-scientific claims.\n\nThe solution proceeds by first formulating the governing equations, then outlining the numerical method for their solution, and finally applying this method to the specified test cases.\n\n### 1. Formulation of the Governing Equations\n\nThe problem describes the chemical evolution within a perfectly stirred fine-structure element, which is mathematically equivalent to an isothermal, isobaric batch reactor. The conservation equation for a species $i$ with mass fraction $Y_i$ in such a system is:\n$$\n\\frac{dY_i}{dt} = \\frac{\\dot{\\omega}_i}{\\rho}\n$$\nwhere $t$ is time, $\\dot{\\omega}_i$ is the net mass production rate of species $i$ per unit volume, and $\\rho$ is the mixture density.\n\nThe reaction mechanism is given as a two-step sequential pathway for methane ($\\mathrm{CH_4}$) oxidation:\n$$\n\\text{CH}_4 \\xrightarrow{k_1} \\text{CO} \\xrightarrow{k_2} \\text{CO}_2\n$$\nThe problem states that this should be modeled as a pseudo-first-order process. This is a common simplification in lumped kinetic models where the detailed stoichiometry and the role of other reactants (like an oxidizer in excess) are absorbed into the rate constants. A direct and consistent interpretation of this description, applied to mass fractions, is that the rate of conversion of mass from one species to the next is proportional to the mass fraction of the reactant species. This implies conservation of the total mass fraction of the tracked species, i.e., $\\frac{d}{dt}(Y_{\\mathrm{CH_4}} + Y_{\\mathrm{CO}} + Y_{\\mathrm{CO_2}}) = 0$.\n\nUnder this interpretation, the system of ordinary differential equations (ODEs) governing the mass fractions is:\n\n1.  For methane ($\\mathrm{CH_4}$), which is consumed in the first step:\n    $$\n    \\frac{dY_{\\mathrm{CH_4}}}{dt} = -k_1 Y_{\\mathrm{CH_4}}\n    $$\n2.  For carbon monoxide ($\\mathrm{CO}$), which is produced in the first step and consumed in the second:\n    $$\n    \\frac{dY_{\\mathrm{CO}}}{dt} = +k_1 Y_{\\mathrm{CH_4}} - k_2 Y_{\\mathrm{CO}}\n    $$\n3.  For carbon dioxide ($\\mathrm{CO_2}$), which is produced in the second step:\n    $$\n    \\frac{dY_{\\mathrm{CO_2}}}{dt} = +k_2 Y_{\\mathrm{CO}}\n    $$\n\nThe rate constants, $k_1$ and $k_2$, are temperature-dependent and given by the Arrhenius law:\n$$\nk_j(T) = A_j \\exp\\left(-\\frac{E_{a,j}}{RT}\\right)\n$$\nwhere for step $j$, $A_j$ is the pre-exponential factor, $E_{a,j}$ is the activation energy, $T$ is the absolute temperature, and $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ is the universal gas constant. For each test case, the temperature $T$ is constant, making the rate constants $k_1$ and $k_2$ constant throughout the integration.\n\n### 2. Numerical Solution Methodology\n\nThe problem is to find the final mass fractions $Y_i^* = Y_i(\\tau^*)$ by solving the system of ODEs over the time interval $[0, \\tau^*]$. The initial conditions are given as the bulk mass fractions, $Y_i(0)$. This constitutes an initial value problem (IVP).\n\nLet the state vector be $\\mathbf{Y}(t) = [Y_{\\mathrm{CH_4}}(t), Y_{\\mathrm{CO}}(t), Y_{\\mathrm{CO_2}}(t)]^T$. The system of ODEs can be written in matrix form as:\n$$\n\\frac{d\\mathbf{Y}}{dt} = \\mathbf{F}(\\mathbf{Y}) = \\begin{pmatrix} -k_1  0  0 \\\\ k_1  -k_2  0 \\\\ 0  k_2  0 \\end{pmatrix} \\mathbf{Y}\n$$\nAlthough this linear system with constant coefficients has a closed-form analytical solution, the problem requests a numerical integration approach, which is more general and representative of methods used in complex reactive flow simulations. We will employ a standard numerical solver for ODEs. The `scipy.integrate.solve_ivp` function from the SciPy library is a suitable and robust choice. It implements several adaptive-step-size methods to solve IVPs efficiently and accurately.\n\nThe procedure for each test case is as follows:\n1.  Define the parameters for the case: $T$, $\\tau^*$, $A_1$, $E_{a,1}$, $A_2$, $E_{a,2}$, and the initial mass fractions $\\mathbf{Y}(0) = [Y_{\\mathrm{CH_4}}(0), Y_{\\mathrm{CO}}(0), Y_{\\mathrm{CO_2}}(0)]$.\n2.  Calculate the constant rate coefficients $k_1$ and $k_2$ using the Arrhenius equation.\n3.  Handle the edge case where the residence time $\\tau^* = 0$. In this trivial case, no reaction occurs, and the final mass fractions are identical to the initial ones.\n4.  For $\\tau^*  0$, define a function that represents the right-hand side of the ODE system, $\\mathbf{F}(\\mathbf{Y})$.\n5.  Use `scipy.integrate.solve_ivp` to integrate the system from $t=0$ to $t=\\tau^*$ with the given initial conditions.\n6.  The result of the integration at $t=\\tau^*$ yields the final fine-structure mass fractions, $\\mathbf{Y}^* = [Y_{\\mathrm{CH_4}}^*, Y_{\\mathrm{CO}}^*, Y_{\\mathrm{CO_2}}^*]$.\n7.  The final values are rounded to six decimal places as required.\n\nThis structured approach ensures that each test case is solved correctly according to the physical model and numerical requirements specified in the problem statement.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the fine-structure mass fractions in an EDC model\n    by numerically integrating the species conservation ODEs for a\n    two-step sequential reaction.\n    \"\"\"\n    # Universal gas constant in J/(mol K)\n    R = 8.314\n\n    test_cases = [\n        # Test case 1 (baseline)\n        {'T': 1800.0, 'tau_star': 1.0e-4, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 2 (boundary tau* = 0)\n        {'T': 1800.0, 'tau_star': 0.0, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 3 (lower temperature)\n        {'T': 1200.0, 'tau_star': 1.0e-4, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 4 (higher A1)\n        {'T': 1800.0, 'tau_star': 1.0e-4, 'A1': 1.0e8, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 5 (higher temperature, shorter residence, slower second step, nonzero intermediate)\n        {'T': 2200.0, 'tau_star': 2.0e-5, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e5, 'Ea2': 6.0e4, 'Y0': [0.04, 0.01, 0.0]},\n        # Test case 6 (long residence time, near-complete conversion)\n        {'T': 1800.0, 'tau_star': 2.0e-3, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n    ]\n\n    # Function defining the system of ODEs\n    def odes(t, Y, k1, k2):\n        \"\"\"\n        System of ODEs for the sequential reaction CH4 -> CO -> CO2.\n        Y: array of mass fractions [Y_CH4, Y_CO, Y_CO2]\n        k1, k2: rate constants for the two steps\n        \"\"\"\n        Y_CH4, Y_CO, Y_CO2 = Y\n        dY_CH4_dt = -k1 * Y_CH4\n        dY_CO_dt = k1 * Y_CH4 - k2 * Y_CO\n        dY_CO2_dt = k2 * Y_CO\n        return [dY_CH4_dt, dY_CO_dt, dY_CO2_dt]\n\n    results = []\n    for params in test_cases:\n        T = params['T']\n        tau_star = params['tau_star']\n        A1, Ea1 = params['A1'], params['Ea1']\n        A2, Ea2 = params['A2'], params['Ea2']\n        Y0 = np.array(params['Y0'])\n\n        # Handle the trivial case of zero residence time\n        if tau_star == 0.0:\n            final_Y = Y0\n        else:\n            # Calculate Arrhenius rate constants\n            k1 = A1 * np.exp(-Ea1 / (R * T))\n            k2 = A2 * np.exp(-Ea2 / (R * T))\n\n            # Set up the integration\n            t_span = [0, tau_star]\n            \n            # Solve the initial value problem\n            # Using 'Radau' or 'BDF' is often good for stiff problems in chemical kinetics\n            solution = solve_ivp(\n                fun=odes,\n                t_span=t_span,\n                y0=Y0,\n                args=(k1, k2),\n                method='Radau',\n                rtol=1e-8,\n                atol=1e-12\n            )\n            \n            # The result is the state at the end of the time span\n            final_Y = solution.y[:, -1]\n\n        # Round the results to six decimal places\n        rounded_Y = np.round(final_Y, 6).tolist()\n        results.append(rounded_Y)\n    \n    # Format the output string as a list of lists.\n    # e.g., [[0.050000,0.000000,0.000000],[...]]\n    sublist_strings = [f\"[{y[0]:.6f},{y[1]:.6f},{y[2]:.6f}]\" for y in results]\n    final_output_string = f\"[{','.join(sublist_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}