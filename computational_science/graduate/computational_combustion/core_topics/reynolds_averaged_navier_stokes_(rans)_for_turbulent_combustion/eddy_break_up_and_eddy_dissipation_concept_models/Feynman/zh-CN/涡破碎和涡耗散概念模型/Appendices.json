{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握涡耗散（EBU）模型，我们从一个直接的计算开始。这个练习将演示如何应用 EBU 公式来确定在混合控制的湍流火焰中燃料的消耗速率，重点在于理解湍流混合频率和反应物化学计量比所扮演的角色。通过这个计算，您将具体地看到模型如何将宏观的湍流参数与局部的反应速率联系起来。",
            "id": "4022740",
            "problem": "在大丹姆科勒数下，对一个处于混合控制状态的湍流非预混甲烷-空气火焰进行模拟，其中化学时间尺度远小于湍流时间尺度。在与涡耗散概念（EDC）一致的混合限制封闭模型——涡耗散（EBU）模型中，单位体积的燃料破坏速率（记为 $\\dot{\\omega}_{F}$）被定义为燃料的净生成速率（消耗时为负值）。假设：\n- 特征湍流微观混合频率由柯尔莫哥洛夫尺度设定，为湍动能耗散率与湍动能之比，即 $\\epsilon/k$。\n- 化学计量耦合强制反应物按化学计量的氧气-燃料质量比 $s$ 成比例消耗，因此能与燃料反应的氧化剂的量受限于 $Y_{O}/s$，而控制混合驱动反应事件的反应物有效量是 $Y_{F}$ 和 $Y_{O}/s$ 中的较小值。\n- 燃料破坏速率与湍流混合频率之间的比例关系由一个无量纲的EBU常数 $A$ 表征。\n\n已知甲烷-空气混合物的化学计量氧气-燃料质量比 $s=4$，混合物密度 $\\rho=1.2\\,\\mathrm{kg/m^3}$，湍动能 $k=0.5\\,\\mathrm{m^2/s^2}$，耗散率 $\\epsilon=25\\,\\mathrm{m^2/s^3}$，燃料质量分数 $Y_{F}=0.02$，氧化剂（氧气）质量分数 $Y_{O}=0.20$，以及EBU常数 $A=4.0$。请基于上述原理，推导以给定物理量表示的 $\\dot{\\omega}_{F}$ 表达式，对其进行数值计算，并指出在EBU假设下哪种反应物是限制性反应物。\n\n将您的 $\\dot{\\omega}_{F}$ 数值结果四舍五入至三位有效数字，并以 $\\mathrm{kg/(m^3\\,s)}$ 为单位表示。",
            "solution": "### 步骤1：提取已知条件\n- **模型：** 用于混合控制状态下（大丹姆科勒数）的湍流非预混火焰的涡耗散（EBU）模型。\n- **定义：** 单位体积的燃料破坏速率 $\\dot{\\omega}_{F}$ 是燃料的净生成速率。\n- **湍流混合频率：** 特征湍流微观混合频率由比率 $\\frac{\\epsilon}{k}$ 给出。\n- **化学计量与限制性反应物：** 反应物有效量由燃料质量分数 $Y_{F}$ 和化学计量调整后的氧化剂质量分数 $\\frac{Y_{O}}{s}$ 中的较小者决定，其中 $s$ 是化学计量的氧气-燃料质量比。\n- **比例常数：** 一个无量纲的EBU常数 $A$。\n- **数值：**\n  - 化学计量氧气-燃料质量比, $s = 4$。\n  - 混合物密度, $\\rho = 1.2\\,\\mathrm{kg/m^3}$。\n  - 湍动能, $k = 0.5\\,\\mathrm{m^2/s^2}$。\n  - 湍动能耗散率, $\\epsilon = 25\\,\\mathrm{m^2/s^3}$。\n  - 燃料质量分数, $Y_{F} = 0.02$。\n  - 氧化剂质量分数, $Y_{O} = 0.20$。\n  - EBU常数, $A = 4.0$。\n- **任务：** 推导 $\\dot{\\omega}_{F}$ 的表达式，将其数值计算到三位有效数字，并确定限制性反应物。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于 Magnussen 和 Hjertager 提出的广为接受的涡耗散（EBU）模型，这是湍流燃烧模拟的基石。其前提——混合限制反应、大丹姆科勒数以及用于湍流频率的柯尔莫哥洛夫尺度（$\\frac{\\epsilon}{k}$）——是该状态下的标准且物理上合理的假设。甲烷-空气燃烧的化学计量关系（$CH_4 + 2O_2 \\rightarrow CO_2 + 2H_2O$）给出的质量比 $s = \\frac{2 \\times M_{O_2}}{M_{CH_4}} = \\frac{2 \\times 32}{16} = 4$，与给定值相符。该问题在科学上是有效的。\n2.  **适定性：** 所有必需的常数和变量（$A, \\rho, k, \\epsilon, Y_{F}, Y_{O}, s$）均已提供。目标陈述清晰。存在唯一解。\n3.  **客观性：** 问题使用精确、客观、科学的术语进行陈述。\n4.  **一致性：** 单位在量纲上是一致的。反应速率 $\\dot{\\omega}_{F}$ 的预期单位是 $\\mathrm{kg/(m^3 s)}$。所提议的表达式的单位将是 $(\\mathrm{kg/m^3}) \\times (\\mathrm{s^{-1}}) \\times (\\text{无量纲}) = \\mathrm{kg/(m^3 s)}$。所提供的数值对于湍流火焰是物理上合理的。\n5.  **结论：** 该问题是有效的、自洽的、科学合理的且适定的。\n\n### 解题推导\n在涡耗散（EBU）模型框架内，燃料的净生成速率 $\\dot{\\omega}_{F}$ 被建模为与限制性反应物在分子水平上混合的速率成正比。该速率是当地混合物密度、湍流混合频率和限制性反应物质量分数的函数。\n\n根据问题陈述：\n1.  湍流混合频率为 $\\frac{\\epsilon}{k}$。\n2.  反应速率与混合物密度 $\\rho$ 成正比。\n3.  控制浓度是限制性反应物的浓度。为了找到限制性反应物，我们必须比较可用的燃料质量分数 $Y_{F}$ 与化学计量当量的氧化剂质量分数 $\\frac{Y_{O}}{s}$。因此，有效反应物质量分数为 $\\min(Y_{F}, \\frac{Y_{O}}{s})$。\n4.  比例常数是EBU常数 $A$。\n5.  由于 $\\dot{\\omega}_{F}$ 被定义为净*生成*速率，而燃料正在被消耗，因此表达式必须带负号。\n\n综合这些要素，燃料净生成速率的一般表达式为：\n$$ \\dot{\\omega}_{F} = - A \\rho \\frac{\\epsilon}{k} \\min\\left(Y_{F}, \\frac{Y_{O}}{s}\\right) $$\n这就是所要求的表达式。\n\n接下来，我们必须通过代入给定值来确定限制性反应物：\n- 燃料质量分数: $Y_{F} = 0.02$。\n- 氧化剂质量分数: $Y_{O} = 0.20$。\n- 化学计量质量比: $s = 4$。\n\n我们计算化学计量调整后的氧化剂质量分数：\n$$ \\frac{Y_{O}}{s} = \\frac{0.20}{4} = 0.05 $$\n现在，我们将此值与燃料质量分数进行比较：\n$$ Y_{F} = 0.02 \\quad \\text{and} \\quad \\frac{Y_{O}}{s} = 0.05 $$\n由于 $0.02  0.05$，我们得到 $Y_{F}  \\frac{Y_{O}}{s}$。\n因此，**燃料是限制性反应物**。\n\n在确定了限制性反应物后，$\\dot{\\omega}_{F}$ 的表达式简化为：\n$$ \\dot{\\omega}_{F} = - A \\rho \\frac{\\epsilon}{k} Y_{F} $$\n现在，我们可以代入数值来计算 $\\dot{\\omega}_{F}$：\n- $A = 4.0$\n- $\\rho = 1.2\\,\\mathrm{kg/m^3}$\n- $\\epsilon = 25\\,\\mathrm{m^2/s^3}$\n- $k = 0.5\\,\\mathrm{m^2/s^2}$\n- $Y_{F} = 0.02$\n\n计算过程如下：\n$$ \\dot{\\omega}_{F} = - (4.0) \\times (1.2\\,\\mathrm{kg/m^3}) \\times \\left(\\frac{25\\,\\mathrm{m^2/s^3}}{0.5\\,\\mathrm{m^2/s^2}}\\right) \\times (0.02) $$\n首先，计算湍流频率 $\\frac{\\epsilon}{k}$：\n$$ \\frac{\\epsilon}{k} = \\frac{25}{0.5} = 50\\,\\mathrm{s^{-1}} $$\n将此结果代回 $\\dot{\\omega}_{F}$ 的方程中：\n$$ \\dot{\\omega}_{F} = - (4.0) \\times (1.2) \\times (50) \\times (0.02)\\,\\mathrm{kg/(m^3\\,s)} $$\n$$ \\dot{\\omega}_{F} = - (4.8) \\times (1.0)\\,\\mathrm{kg/(m^3\\,s)} $$\n$$ \\dot{\\omega}_{F} = -4.8\\,\\mathrm{kg/(m^3\\,s)} $$\n问题要求将结果四舍五入到三位有效数字。\n$$ \\dot{\\omega}_{F} = -4.80\\,\\mathrm{kg/(m^3\\,s)} $$",
            "answer": "$$ \\boxed{-4.80} $$"
        },
        {
            "introduction": "EBU 模型依赖于“快速化学反应”的假设，但我们如何判断这一假设何时成立呢？本练习引入了达姆克勒数 ($Da$)，这是一个关键的无量纲参数，用于比较湍流和化学反应的时间尺度。通过计算它，您将能够定量地判断是否可以使用像 EBU 这样的简单混合限制模型，还是需要像 EDC 这样考虑有限速率化学反应的更高级方法。",
            "id": "4022767",
            "problem": "在实验室条件下，一股甲烷-空气射流火焰喷入同向流动的环境气体中。在火焰锋面内进行的雷诺平均纳维-斯托克斯 (RANS) 测量，在一个代表性位置上得到了湍动能 $k$ 和耗散率 $\\epsilon$。此外，还独立估算了在当地热化学状态下，主导甲烷氧化路径的化学时间尺度 $\\tau_{\\mathrm{chem}}$。\n\n利用基本定义和标度律分析，推导丹柯勒数 $Da$ 的表达式。丹柯勒数是特征湍流混合时间与化学时间尺度之比，需用 $k$ 和 $\\epsilon$ 表示。然后，利用给定数据计算 $Da$ 的值，并根据其大小判断在该位置哪种模拟假设更为合适：涡破碎 (EBU) 模型（该模型假设燃烧由混合控制，化学反应速率无限快）或涡耗散概念 (EDC) 模型（该模型考虑了湍流精细结构内的有限速率化学反应）。\n\n数据：\n- 湍动能：$k = 0.8\\,\\mathrm{m^2/s^2}$\n- 耗散率：$\\epsilon = 40\\,\\mathrm{m^2/s^3}$\n- 化学时间尺度：$\\tau_{\\mathrm{chem}} = 5 \\times 10^{-4}\\,\\mathrm{s}$\n\n说明：\n- 使用推导的表达式计算丹柯勒数 $Da$，并将数值结果四舍五入至三位有效数字。将 $Da$ 表示为一个无单位的纯数。\n- 将模型选择编码为 $M$，其中如果涡破碎 (EBU) 模型适用，则 $M = 0$；如果涡耗散概念 (EDC) 模型适用，则 $M = 1$。\n- 以一个包含两个元素 $\\big[Da \\;\\; M\\big]$ 的行矩阵形式提供最终答案。",
            "solution": "本题要求推导丹柯勒数 $Da$ 的表达式，对其进行数值计算，并根据给定条件决定合适的燃烧模型。\n\n首先，我们进行推导。丹柯勒数定义为特征湍流混合时间 $\\tau_{\\text{turb}}$ 与化学时间尺度 $\\tau_{\\text{chem}}$ 之比。\n$$\nDa = \\frac{\\tau_{\\text{turb}}}{\\tau_{\\text{chem}}}\n$$\n本题的背景是雷诺平均纳维-斯托克斯 (RANS) 模拟，其中湍流由湍动能 $k$ 及其耗散率 $\\epsilon$ 来表征。湍动能 $k$ 的单位是速度的平方 $[\\mathrm{L}^2 \\mathrm{T}^{-2}]$，代表单位质量流体中包含在携带能量的大尺度湍涡中的能量。耗散率 $\\epsilon$ 的单位是单位质量单位时间的能量 $[\\mathrm{L}^2 \\mathrm{T}^{-3}]$，代表 $k$ 在最小尺度湍涡中因粘性力作用而耗散成热能的速率。\n\n一个表征大涡的特征时间尺度，它决定了湍流混合的速率，可以通过量纲分析由 $k$ 和 $\\epsilon$ 构建。我们寻求 $k$ 和 $\\epsilon$ 的一个组合，其量纲为时间 $[\\mathrm{T}]$。\n$$\n\\frac{[k]}{[\\epsilon]} = \\frac{[\\mathrm{L}^2 \\mathrm{T}^{-2}]}{[\\mathrm{L}^2 \\mathrm{T}^{-3}]} = [\\mathrm{T}]\n$$\n这表明湍流混合时间与比值 $k/\\epsilon$ 成正比。在大涡翻转时间的背景下，比例常数取为 1。因此，我们将特征湍流混合时间定义为：\n$$\n\\tau_{\\text{turb}} = \\frac{k}{\\epsilon}\n$$\n将此表达式代入丹柯勒数的定义，得到用 $k$、$\\epsilon$ 和 $\\tau_{\\text{chem}}$ 表示的所需表达式：\n$$\nDa = \\frac{k/\\epsilon}{\\tau_{\\text{chem}}} = \\frac{k}{\\epsilon \\tau_{\\text{chem}}}\n$$\n接下来，我们使用所提供的数据计算该表达式的值：\n- 湍动能：$k = 0.8\\,\\mathrm{m^2/s^2}$\n- 耗散率：$\\epsilon = 40\\,\\mathrm{m^2/s^3}$\n- 化学时间尺度：$\\tau_{\\text{chem}} = 5 \\times 10^{-4}\\,\\mathrm{s}$\n\n将这些值代入推导出的 $Da$ 公式中：\n$$\nDa = \\frac{0.8\\,\\mathrm{m^2/s^2}}{(40\\,\\mathrm{m^2/s^3})(5 \\times 10^{-4}\\,\\mathrm{s})}\n$$\n首先，计算分母的值：\n$$\n(40) \\times (5 \\times 10^{-4}) = 200 \\times 10^{-4} = 0.02\n$$\n分母中的单位是 $(\\mathrm{m^2/s^3}) \\cdot \\mathrm{s} = \\mathrm{m^2/s^2}$，与分子的单位相匹配，这证实了 $Da$ 是一个无量纲量。\n现在，我们计算 $Da$ 的最终值：\n$$\nDa = \\frac{0.8}{0.02} = \\frac{80}{2} = 40\n$$\n题目要求将该值四舍五入至三位有效数字。因此，$Da = 40.0$。\n\n最后，我们必须根据 $Da$ 的大小选择合适的燃烧模型。丹柯勒数比较了流体混合的时间尺度与化学反应的时间尺度。\n- 如果 $Da \\gg 1$，则 $\\tau_{\\text{turb}} \\gg \\tau_{\\text{chem}}$。这表明化学反应相对于湍流混合过程非常快。因此，总的燃烧速率受限于反应物的混合速率。这是“快化学”范畴，涡破碎 (EBU) 模型就是为此设计的。\n- 如果 $Da \\approx 1$ 或 $Da \\ll 1$，则 $\\tau_{\\text{turb}}$ 与 $\\tau_{\\text{chem}}$ 处于同一数量级或更小。这意味着化学动力学速率并非快到可以忽略不计，可能成为速率限制步骤。在这种“有限速率化学”范畴中，需要使用像涡耗散概念 (EDC) 这样的模型，该模型考虑了湍流与化学反应之间的相互作用。\n\n在我们的例子中，$Da = 40.0$。由于 $40.0 \\gg 1$，化学反应比湍流混合快得多。该位置的燃烧过程由混合控制。因此，基于快化学假设的涡破碎 (EBU) 模型是更合适的模型选择。\n\n题目规定了模型选择的编码 $M$，其中 EBU 模型对应 $M=0$，EDC 模型对应 $M=1$。根据我们的分析，EBU 模型是合适的，这对应于：\n$$\nM = 0\n$$\n最终答案应表示为行矩阵 $[Da \\;\\; M]$。\n计算出的值为 $Da = 40.0$ 和 $M=0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40.0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "当化学反应速率并非无限快时，涡耗散概念（EDC）模型就变得至关重要。本编程练习将深入探讨 EDC 模型的核心，通过模拟一个被视为理想反应器的湍流精细结构内的化学反应过程。您将通过实现并求解组分守恒方程，亲身体验 EDC 模型是如何整合有限速率化学动力学的，这是超越 EBU 模型的关键一步。",
            "id": "4022728",
            "problem": "考虑湍流反应流中一个完美搅拌的精细结构单元，该单元通过涡耗散概念（EDC）进行建模。在 EDC 假设下，反应精细结构被视为具有有限停留时间的理想、充分混合的反应器，反应物从周围的非反应流体进入，其质量分数与宏观（粗网格）值相匹配。在本问题中，您将通过在一个指定的停留时间 $\\tau^*$ 内对物种守恒常微分方程进行积分，来计算代表甲烷氧化过程的两步、顺序、伪一级反应机理：$\\mathrm{CH_4} \\to \\mathrm{CO} \\to \\mathrm{CO_2}$ 的精细结构质量分数 $Y_i^*$。\n\n从以下基本原理出发：\n- 在充分混合反应器中，物种守恒意味着每个物种质量分数的时间变化等于化学反应产生的净生成率，表示为一个关于时间的常微分方程。\n- 当精细结构内部氧化剂过量时，基元步骤的有效反应速率可以被建模为相对于反应物物种的伪一级反应。每个步骤的温度依赖性由阿伦尼乌斯动力学捕捉，第 $j$ 步的速率常数由 $k_j(T) = A_j \\exp\\left(-\\dfrac{E_{a,j}}{R T}\\right)$ 给出，其中 $A_j$ 是指前因子，$E_{a,j}$ 是活化能，$R$ 是通用气体常数，$T$ 是绝对温度。\n- 精细结构停留时间 $\\tau^*$ 是精细结构在与周围流体交换其内容物之前进行化学演化的时间（在 EDC 建模的背景下，这与最小的湍流时间尺度成正比，但在这里它是给定的）。\n\n您的任务是：\n1. 在伪一级反应假设下，为顺序机理 $\\mathrm{CH_4} \\to \\mathrm{CO} \\to \\mathrm{CO_2}$ 建立物种守恒常微分方程，其中速率常数 $k_1(T)$ 和 $k_2(T)$ 符合阿伦尼乌斯定律。\n2. 从等于精细结构入口处宏观质量分数的初始条件开始，在停留时间 $\\tau^*$ 内对这些方程进行积分，以获得 $Y_{\\mathrm{CH_4}}^*$、$Y_{\\mathrm{CO}}^*$ 和 $Y_{\\mathrm{CO_2}}^*$。\n3. 通过计算多组参数下的最终值，展示 $Y_i^*$ 对温度 $T$ 和指前因子 $A_1$, $A_2$ 变化的敏感性。\n\n使用通用气体常数 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。将氧化剂浓度视为恒定（大量过剩），因此该机理对于被追踪的物种是伪一级的。温度以 $\\mathrm{K}$ 表示，速率常数以 $\\mathrm{s}^{-1}$ 表示，活化能以 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 表示，停留时间以 $\\mathrm{s}$ 表示，质量分数以无量纲小数表示。精细结构质量分数 $Y_i^*$ 必须四舍五入到小数点后六位进行报告。\n\n实现一个完整的、可运行的程序，通过对常微分方程进行数值积分来解决上述问题。使用以下参数集测试套件来探测“理想路径”、边界条件和边缘情况：\n\n- 测试用例 1 (基准)：$T = 1800\\,\\mathrm{K}$，$\\tau^* = 1.0\\times 10^{-4}\\,\\mathrm{s}$，$A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$，$E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$A_2 = 5.0\\times 10^{6}\\,\\mathrm{s}^{-1}$，$E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，初始质量分数 $[Y_{\\mathrm{CH_4}}(0), Y_{\\mathrm{CO}}(0), Y_{\\mathrm{CO_2}}(0)] = [0.05, 0.0, 0.0]$。\n- 测试用例 2 (边界 $\\tau^* = 0$)：与测试用例 1 参数相同，但 $\\tau^* = 0.0\\,\\mathrm{s}$。\n- 测试用例 3 (较低温度)：$T = 1200\\,\\mathrm{K}$，$\\tau^* = 1.0\\times 10^{-4}\\,\\mathrm{s}$，$A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$，$E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$A_2 = 5.0\\times 10^{6}\\,\\mathrm{s}^{-1}$，$E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，初始质量分数 $[0.05, 0.0, 0.0]$。\n- 测试用例 4 (较高的 $A_1$)：与测试用例 1 相同，但 $A_1 = 1.0\\times 10^{8}\\,\\mathrm{s}^{-1}$。\n- 测试用例 5 (较高温度、较短停留时间、较慢的第二步、非零中间产物)：$T = 2200\\,\\mathrm{K}$，$\\tau^* = 2.0\\times 10^{-5}\\,\\mathrm{s}$，$A_1 = 1.0\\times 10^{7}\\,\\mathrm{s}^{-1}$，$E_{a,1} = 8.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$A_2 = 5.0\\times 10^{5}\\,\\mathrm{s}^{-1}$，$E_{a,2} = 6.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，初始质量分数 $[0.04, 0.01, 0.0]$。\n- 测试用例 6 (长停留时间、接近完全转化)：与测试用例 1 相同，但 $\\tau^* = 2.0\\times 10^{-3}\\,\\mathrm{s}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是三个最终质量分数 $[Y_{\\mathrm{CH_4}}^*, Y_{\\mathrm{CO}}^*, Y_{\\mathrm{CO_2}}^*]$ 的子列表，并四舍五入到小数点后六位。例如，输出格式必须为 $[[y_{11},y_{12},y_{13}],[y_{21},y_{22},y_{23}],\\dots]$ 的形式，其中每个 $y_{ij}$ 是小数点后有六位数字的小数。",
            "solution": "所提出的问题是有效的。它在科学上基于化学动力学和反应工程的原理，特别是充分混合反应器的建模，这是湍流燃烧中涡耗散概念（EDC）的核心概念。该问题作为一个常微分方程组的初值问题，提法恰当，所有必要的参数和初始条件都已提供。它是客观的，不包含任何非科学的主张。\n\n求解过程首先建立控制方程，然后概述求解这些方程的数值方法，最后将此方法应用于指定的测试用例。\n\n### 1. 控制方程的建立\n\n该问题描述了一个完美搅拌的精细结构单元内的化学演化，这在数学上等同于一个等温、等压的间歇式反应器。在此类系统中，对于质量分数为 $Y_i$ 的物种 $i$，其守恒方程为：\n$$\n\\frac{dY_i}{dt} = \\frac{\\dot{\\omega}_i}{\\rho}\n$$\n其中 $t$ 是时间，$\\dot{\\omega}_i$ 是单位体积内物种 $i$ 的净质量生成率，$\\rho$ 是混合物密度。\n\n反应机理被指定为甲烷（$\\mathrm{CH_4}$）氧化的两步顺序路径：\n$$\n\\mathrm{CH_4} \\xrightarrow{k_1} \\mathrm{CO} \\xrightarrow{k_2} \\mathrm{CO_2}\n$$\n问题指出，这应被建模为一个伪一级过程。这是集总动力学模型中一种常见的简化，其中详细的化学计量和其它反应物（如过量氧化剂）的作用被吸收到速率常数中。对该描述直接且一致的解释是，应用于质量分数时，从一个物种到下一个物种的质量转化率与反应物物种的质量分数成正比。这意味着被追踪物种的总质量分数守恒，即 $\\frac{d}{dt}(Y_{\\mathrm{CH_4}} + Y_{\\mathrm{CO}} + Y_{\\mathrm{CO_2}}) = 0$。\n\n根据这种解释，控制质量分数的常微分方程组（ODEs）为：\n\n1.  对于在第一步中被消耗的甲烷（$\\mathrm{CH_4}$）：\n    $$\n    \\frac{dY_{\\mathrm{CH_4}}}{dt} = -k_1 Y_{\\mathrm{CH_4}}\n    $$\n2.  对于在第一步中生成并在第二步中消耗的一氧化碳（$\\mathrm{CO}$）：\n    $$\n    \\frac{dY_{\\mathrm{CO}}}{dt} = +k_1 Y_{\\mathrm{CH_4}} - k_2 Y_{\\mathrm{CO}}\n    $$\n3.  对于在第二步中生成的二氧化碳（$\\mathrm{CO_2}$）：\n    $$\n    \\frac{dY_{\\mathrm{CO_2}}}{dt} = +k_2 Y_{\\mathrm{CO}}\n    $$\n\n速率常数 $k_1$ 和 $k_2$ 是温度依赖性的，由阿伦尼乌斯定律给出：\n$$\nk_j(T) = A_j \\exp\\left(-\\frac{E_{a,j}}{RT}\\right)\n$$\n其中对于步骤 $j$，$A_j$ 是指前因子，$E_{a,j}$ 是活化能，$T$ 是绝对温度，$R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 是通用气体常数。对于每个测试用例，温度 $T$ 是恒定的，这使得速率常数 $k_1$ 和 $k_2$ 在整个积分过程中保持不变。\n\n### 2. 数值求解方法\n\n问题在于通过求解时间区间 $[0, \\tau^*]$ 上的常微分方程组来找到最终质量分数 $Y_i^* = Y_i(\\tau^*)$。初始条件以宏观质量分数 $Y_i(0)$ 的形式给出。这构成了一个初值问题（IVP）。\n\n设状态向量为 $\\mathbf{Y}(t) = [Y_{\\mathrm{CH_4}}(t), Y_{\\mathrm{CO}}(t), Y_{\\mathrm{CO_2}}(t)]^T$。该常微分方程组可以写成矩阵形式：\n$$\n\\frac{d\\mathbf{Y}}{dt} = \\mathbf{F}(\\mathbf{Y}) = \\begin{pmatrix} -k_1  0  0 \\\\ k_1  -k_2  0 \\\\ 0  k_2  0 \\end{pmatrix} \\mathbf{Y}\n$$\n尽管这个具有常系数的线性系统有闭式解析解，但问题要求采用数值积分方法，这种方法更具通用性，并且代表了复杂反应流模拟中使用的方法。我们将采用标准的常微分方程数值求解器。SciPy 库中的 `scipy.integrate.solve_ivp` 函数是一个合适且稳健的选择。它实现了多种自适应步长方法，可以高效、准确地求解初值问题。\n\n每个测试用例的步骤如下：\n1.  定义用例的参数：$T$、$\\tau^*$、$A_1$、$E_{a,1}$、$A_2$、$E_{a,2}$，以及初始质量分数 $\\mathbf{Y}(0) = [Y_{\\mathrm{CH_4}}(0), Y_{\\mathrm{CO}}(0), Y_{\\mathrm{CO_2}}(0)]$。\n2.  使用阿伦尼乌斯方程计算恒定的速率系数 $k_1$ 和 $k_2$。\n3.  处理停留时间 $\\tau^* = 0$ 的边缘情况。在这个平凡的情况下，不发生反应，最终质量分数与初始质量分数相同。\n4.  对于 $\\tau^*  0$，定义一个表示常微分方程组右侧的函数 $\\mathbf{F}(\\mathbf{Y})$。\n5.  使用 `scipy.integrate.solve_ivp` 在给定初始条件下，将系统从 $t=0$ 积分到 $t=\\tau^*$。\n6.  在 $t=\\tau^*$ 处的积分结果即为最终的精细结构质量分数 $\\mathbf{Y}^* = [Y_{\\mathrm{CH_4}}^*, Y_{\\mathrm{CO}}^*, Y_{\\mathrm{CO_2}}^*]$。\n7.  按要求将最终值四舍五入到小数点后六位。\n\n这种结构化的方法确保了每个测试用例都根据问题陈述中指定的物理模型和数值要求得到正确求解。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the fine-structure mass fractions in an EDC model\n    by numerically integrating the species conservation ODEs for a\n    two-step sequential reaction.\n    \"\"\"\n    # Universal gas constant in J/(mol K)\n    R = 8.314\n\n    test_cases = [\n        # Test case 1 (baseline)\n        {'T': 1800.0, 'tau_star': 1.0e-4, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 2 (boundary tau* = 0)\n        {'T': 1800.0, 'tau_star': 0.0, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 3 (lower temperature)\n        {'T': 1200.0, 'tau_star': 1.0e-4, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 4 (higher A1)\n        {'T': 1800.0, 'tau_star': 1.0e-4, 'A1': 1.0e8, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n        # Test case 5 (higher temperature, shorter residence, slower second step, nonzero intermediate)\n        {'T': 2200.0, 'tau_star': 2.0e-5, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e5, 'Ea2': 6.0e4, 'Y0': [0.04, 0.01, 0.0]},\n        # Test case 6 (long residence time, near-complete conversion)\n        {'T': 1800.0, 'tau_star': 2.0e-3, 'A1': 1.0e7, 'Ea1': 8.0e4, 'A2': 5.0e6, 'Ea2': 6.0e4, 'Y0': [0.05, 0.0, 0.0]},\n    ]\n\n    # Function defining the system of ODEs\n    def odes(t, Y, k1, k2):\n        \"\"\"\n        System of ODEs for the sequential reaction CH4 -> CO -> CO2.\n        Y: array of mass fractions [Y_CH4, Y_CO, Y_CO2]\n        k1, k2: rate constants for the two steps\n        \"\"\"\n        Y_CH4, Y_CO, Y_CO2 = Y\n        dY_CH4_dt = -k1 * Y_CH4\n        dY_CO_dt = k1 * Y_CH4 - k2 * Y_CO\n        dY_CO2_dt = k2 * Y_CO\n        return [dY_CH4_dt, dY_CO_dt, dY_CO2_dt]\n\n    results = []\n    for params in test_cases:\n        T = params['T']\n        tau_star = params['tau_star']\n        A1, Ea1 = params['A1'], params['Ea1']\n        A2, Ea2 = params['A2'], params['Ea2']\n        Y0 = np.array(params['Y0'])\n\n        # Handle the trivial case of zero residence time\n        if tau_star == 0.0:\n            final_Y = Y0\n        else:\n            # Calculate Arrhenius rate constants\n            k1 = A1 * np.exp(-Ea1 / (R * T))\n            k2 = A2 * np.exp(-Ea2 / (R * T))\n\n            # Set up the integration\n            t_span = [0, tau_star]\n            \n            # Solve the initial value problem\n            # Using 'Radau' or 'BDF' is often good for stiff problems in chemical kinetics\n            solution = solve_ivp(\n                fun=odes,\n                t_span=t_span,\n                y0=Y0,\n                args=(k1, k2),\n                method='Radau',\n                rtol=1e-8,\n                atol=1e-12\n            )\n            \n            # The result is the state at the end of the time span\n            final_Y = solution.y[:, -1]\n\n        # Round the results to six decimal places\n        rounded_Y = np.round(final_Y, 6).tolist()\n        results.append(rounded_Y)\n    \n    # Format the output string as a list of lists.\n    # e.g., [[0.050000,0.000000,0.000000],[...]]\n    sublist_strings = [f\"[{y[0]:.6f},{y[1]:.6f},{y[2]:.6f}]\" for y in results]\n    final_output_string = f\"[{','.join(sublist_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}