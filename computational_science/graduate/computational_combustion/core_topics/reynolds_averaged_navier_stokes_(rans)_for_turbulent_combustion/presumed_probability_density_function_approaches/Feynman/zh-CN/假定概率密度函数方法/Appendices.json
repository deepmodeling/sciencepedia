{
    "hands_on_practices": [
        {
            "introduction": "在雷诺平均纳维-斯托克斯（RANS）或大涡模拟（LES）等计算流体力学（CFD）方法中，我们通常求解混合分数等标量的均值（$\\mu$）和方差（$\\sigma^2$）的输运方程。然而，为了封闭模型（例如，计算平均反应速率），我们需要完整的概率密度函数（PDF）。Beta-PDF 是一个常用的选择，但其形状参数 $\\alpha$ 和 $\\beta$ 并非直接可得。本练习  提供了一个关键步骤的动手实践：从求解器提供的矩（均值和方差）确定 PDF 的形状参数，并检验计算出的方差是否物理上可能（即可实现）。这一步是确保我们燃烧模型数学有效性的基础。",
            "id": "4053753",
            "problem": "在湍流非预混燃烧模型中，混合分数 $Z \\in [0,1]$ 通常通过假定概率密度函数 (PDF) 封闭方法来处理。一个常见的选择是在 $[0,1]$ 上具有正形状参数 $\\alpha$ 和 $\\beta$ 的 Beta 分布。考虑来自 Reynolds-Averaged Navier–Stokes (RANS) 模拟的单个计算单元，其中单元平均的混合分数均值和方差分别报告为 $\\mu$ 和 $\\sigma^{2}$。从 $[0,1]$ 上的 Beta 概率密度函数的定义出发，\n$$\np_{Z}(z;\\alpha,\\beta)=\\frac{z^{\\alpha-1}(1-z)^{\\beta-1}}{B(\\alpha,\\beta)}, \\quad 0 \\le z \\le 1, \\quad \\alpha>0,\\ \\beta>0,\n$$\n结合连续随机变量的均值和方差的标准定义，\n$$\n\\mu=\\mathbb{E}[Z]=\\int_{0}^{1} z\\,p_{Z}(z;\\alpha,\\beta)\\,dz, \\quad \\sigma^{2}=\\operatorname{Var}(Z)=\\int_{0}^{1} (z-\\mu)^{2}\\,p_{Z}(z;\\alpha,\\beta)\\,dz,\n$$\n推导 $\\alpha(\\mu,\\sigma^{2})$ 和 $\\beta(\\mu,\\sigma^{2})$ 的闭式表达式。根据您的表达式，得到一个关于 $\\sigma^{2}$ 的、仅用 $\\mu$ 表示的充分必要可容许性条件，该条件保证 $\\alpha>0$ 和 $\\beta>0$。\n\n然后，对于 RANS 报告的特定值 $\\mu=0.35$ 和 $\\sigma^{2}=0.040$，计算相应的形状参数 $\\alpha$ 和 $\\beta$。定义可容许性指标\n$$\nI=\\begin{cases}\n1,  \\text{如果对于给定的 }\\mu\\text{，方差在 Beta 假定 PDF 下是可容许的，}\\\\\n0,  \\text{否则}。\n\\end{cases}\n$$\n将最终结果报告为行向量 $\\big[\\alpha\\ \\ \\beta\\ \\ I\\big]$。将 $\\alpha$ 和 $\\beta$ 四舍五入到四位有效数字。混合分数是无量纲的；请将您的最终结果表示为无量纲数。",
            "solution": "题目要求根据 Beta 概率密度函数 (PDF) 的均值 $\\mu$ 和方差 $\\sigma^2$ 来推导其形状参数 $\\alpha$ 和 $\\beta$ 的表达式。随后，必须找到关于 $\\sigma^2$ 的可容许性条件，最后，需要为给定的 $\\mu$ 和 $\\sigma^2$ 计算 $\\alpha$、$\\beta$ 以及可容许性指标 $I$ 的数值。\n\n随机变量 $Z$ 在区间 $[0, 1]$ 上的 Beta PDF 如下所示：\n$$\np_{Z}(z;\\alpha,\\beta)=\\frac{z^{\\alpha-1}(1-z)^{\\beta-1}}{B(\\alpha,\\beta)}, \\quad 0 \\le z \\le 1, \\quad \\alpha>0,\\ \\beta>0\n$$\n其中 $B(\\alpha,\\beta)$ 是 Beta 函数，$B(\\alpha,\\beta) = \\int_{0}^{1} t^{\\alpha-1}(1-t)^{\\beta-1} dt$。Beta 函数通过 $B(\\alpha,\\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$ 与 Gamma 函数 $\\Gamma(x)$ 相关。Gamma 函数的一个关键性质是 $\\Gamma(x+1) = x\\Gamma(x)$。\n\n首先，我们使用均值的定义来推导其表达式 $\\mu = \\mathbb{E}[Z]$：\n$$\n\\mu = \\mathbb{E}[Z] = \\int_{0}^{1} z\\, p_{Z}(z;\\alpha,\\beta)\\,dz = \\frac{1}{B(\\alpha,\\beta)}\\int_{0}^{1} z \\cdot z^{\\alpha-1}(1-z)^{\\beta-1}\\,dz = \\frac{1}{B(\\alpha,\\beta)}\\int_{0}^{1} z^{\\alpha}(1-z)^{\\beta-1}\\,dz\n$$\n分子中的积分是 $B(\\alpha+1, \\beta)$ 的定义。因此，\n$$\n\\mu = \\frac{B(\\alpha+1, \\beta)}{B(\\alpha, \\beta)} = \\frac{\\Gamma(\\alpha+1)\\Gamma(\\beta)}{\\Gamma(\\alpha+1+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\n$$\n使用 Gamma 函数的性质 $\\Gamma(\\alpha+1) = \\alpha\\Gamma(\\alpha)$ 和 $\\Gamma(\\alpha+\\beta+1) = (\\alpha+\\beta)\\Gamma(\\alpha+\\beta)$，我们简化表达式：\n$$\n\\mu = \\frac{\\alpha\\Gamma(\\alpha)\\Gamma(\\beta)}{(\\alpha+\\beta)\\Gamma(\\alpha+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} = \\frac{\\alpha}{\\alpha+\\beta}\n$$\n\n接下来，我们推导方差 $\\sigma^2 = \\operatorname{Var}(Z) = \\mathbb{E}[Z^2] - (\\mathbb{E}[Z])^2$。我们首先计算二阶矩 $\\mathbb{E}[Z^2]$：\n$$\n\\mathbb{E}[Z^2] = \\int_{0}^{1} z^2 p_{Z}(z;\\alpha,\\beta)\\,dz = \\frac{1}{B(\\alpha,\\beta)}\\int_{0}^{1} z^2 \\cdot z^{\\alpha-1}(1-z)^{\\beta-1}\\,dz = \\frac{B(\\alpha+2, \\beta)}{B(\\alpha, \\beta)}\n$$\n使用 Gamma 函数表示法：\n$$\n\\mathbb{E}[Z^2] = \\frac{\\Gamma(\\alpha+2)\\Gamma(\\beta)}{\\Gamma(\\alpha+2+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} = \\frac{(\\alpha+1)\\alpha\\Gamma(\\alpha)\\Gamma(\\beta)}{(\\alpha+\\beta+1)(\\alpha+\\beta)\\Gamma(\\alpha+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} = \\frac{\\alpha(\\alpha+1)}{(\\alpha+\\beta)(\\alpha+\\beta+1)}\n$$\n现在，我们计算方差：\n$$\n\\sigma^2 = \\mathbb{E}[Z^2] - \\mu^2 = \\frac{\\alpha(\\alpha+1)}{(\\alpha+\\beta)(\\alpha+\\beta+1)} - \\left(\\frac{\\alpha}{\\alpha+\\beta}\\right)^2 = \\frac{\\alpha(\\alpha+1)(\\alpha+\\beta) - \\alpha^2(\\alpha+\\beta+1)}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}\n$$\n简化分子：\n$$\n\\alpha[(\\alpha+1)(\\alpha+\\beta) - \\alpha(\\alpha+\\beta+1)] = \\alpha[\\alpha^2 + \\alpha\\beta + \\alpha + \\beta - \\alpha^2 - \\alpha\\beta - \\alpha] = \\alpha\\beta\n$$\n因此，方差的表达式为：\n$$\n\\sigma^2 = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}\n$$\n为了找到 $\\alpha(\\mu, \\sigma^2)$ 和 $\\beta(\\mu, \\sigma^2)$ 的表达式，我们反演这些矩关系。我们引入一个中间变量来表示参数之和，$S = \\alpha + \\beta$。\n从均值的表达式 $\\mu = \\frac{\\alpha}{\\alpha+\\beta} = \\frac{\\alpha}{S}$，得到 $\\alpha = \\mu S$。\n类似地，从 $1-\\mu = 1 - \\frac{\\alpha}{\\alpha+\\beta} = \\frac{\\beta}{\\alpha+\\beta} = \\frac{\\beta}{S}$，得到 $\\beta = (1-\\mu)S$。\n我们可以用 $\\mu$ 和 $S$ 来重写方差的表达式：\n$$\n\\sigma^2 = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)} = \\left(\\frac{\\alpha}{\\alpha+\\beta}\\right)\\left(\\frac{\\beta}{\\alpha+\\beta}\\right)\\frac{1}{(\\alpha+\\beta)+1} = \\mu(1-\\mu)\\frac{1}{S+1}\n$$\n求解 $S$：\n$$\nS+1 = \\frac{\\mu(1-\\mu)}{\\sigma^2} \\implies S = \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1\n$$\n将 $S$ 的这个表达式代回到 $\\alpha$ 和 $\\beta$ 的关系式中，我们得到所需的闭式表达式：\n$$\n\\alpha(\\mu, \\sigma^2) = \\mu \\left( \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 \\right)\n$$\n$$\n\\beta(\\mu, \\sigma^2) = (1-\\mu) \\left( \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 \\right)\n$$\n可容许性条件要求形状参数是严格为正的：$\\alpha > 0$ 和 $\\beta > 0$。对于一个物理上现实的混合分数，均值必须在范围 $\\mu \\in [0, 1]$ 内。我们考虑非退化情况，即 $\\mu \\in (0, 1)$，此时 $\\mu$ 和 $1-\\mu$ 均为正数。在这种情况下，当且仅当公共因子为正时，条件 $\\alpha>0$ 和 $\\beta>0$ 才被满足：\n$$\n\\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 > 0\n$$\n$$\n\\frac{\\mu(1-\\mu)}{\\sigma^2} > 1\n$$\n对于一个非退化的分布，$\\sigma^2 > 0$。因此，我们可以乘以 $\\sigma^2$ 而不改变不等号的方向：\n$$\n\\sigma^2 \\lt \\mu(1-\\mu)\n$$\n这就是对于给定的 $\\mu \\in (0,1)$，关于 $\\sigma^2$ 的充分必要可容许性条件。方差必须在范围 $0 \\lt \\sigma^2 \\lt \\mu(1-\\mu)$ 内。\n\n现在，我们将这些结果应用于给定的 RANS 报告值：$\\mu=0.35$ 和 $\\sigma^{2}=0.040$。\n首先，我们检查可容许性条件。我们为此均值计算最大允许方差：\n$$ \\mu(1-\\mu) = 0.35 \\times (1 - 0.35) = 0.35 \\times 0.65 = 0.2275 $$\n给定 $\\sigma^2 = 0.040$。将给定方差与最大允许方差进行比较：\n$0.040 \\lt 0.2275$\n由于条件满足，给定方差对于 Beta 假定 PDF 是可容许的。因此，可容许性指标为 $I=1$。\n\n接下来，我们计算相应的形状参数 $\\alpha$ 和 $\\beta$。我们首先计算总和 $S$：\n$$ S = \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 = \\frac{0.2275}{0.040} - 1 = 5.6875 - 1 = 4.6875 $$\n现在我们计算 $\\alpha$ 和 $\\beta$：\n$$ \\alpha = \\mu S = 0.35 \\times 4.6875 = 1.640625 $$\n$$ \\beta = (1-\\mu) S = (1 - 0.35) \\times 4.6875 = 0.65 \\times 4.6875 = 3.046875 $$\n按照要求将这些值四舍五入到四位有效数字：\n$$ \\alpha \\approx 1.641 $$\n$$ \\beta \\approx 3.047 $$\n最终结果是包含计算值的行向量 $[\\alpha\\ \\ \\beta\\ \\ I]$。\n该向量是 $[1.641\\ \\ 3.047\\ \\ 1]$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 1.641  3.047  1 \\end{pmatrix}} $$"
        },
        {
            "introduction": "虽然单个 Beta-PDF 功能强大，但它可能无法捕捉湍流火焰结构的所有特征，例如离散的未燃反应物、完全燃烧的产物与连续的反应区并存的情况。本练习  挑战我们像模型开发者一样思考，探索更简单模型的局限性，并构建一个更复杂的“混合模型”。该模型将离散状态（使用狄拉克 $\\delta$ 函数）与连续分布（Beta-PDF）相结合，为复杂燃烧现象提供了更灵活、更符合物理实际的表示方法。",
            "id": "4053704",
            "problem": "在湍流反应流的假定概率密度函数 (PDF) 方法中，经过滤波的热化学量通过在一个假定的标量分布上对条件依赖性进行积分来封闭。考虑一个反应进程变量 $c \\in [0,1]$，它概括了反应进程（例如，物种质量分数或显焓的归一化线性组合）。对于 $c$ 的一个常用理想化模型是双狄拉克 PDF，它将所有概率质量置于未燃状态 $c=0$ 和完全燃烧状态 $c=1$。设该双狄拉克模型写作 $p(c) = w_0 \\, \\delta(c) + w_1 \\, \\delta(c-1)$，其中 $\\delta(\\cdot)$ 是狄拉克 delta 分布，$w_0 \\ge 0$，$w_1 \\ge 0$，且 $w_0 + w_1 = 1$。\n\n根据概率公理以及均值和方差的定义，这个双狄拉克模型意味着 $c$ 的均值 $\\mu$ 和方差 $\\sigma^2$ 之间存在单一的函数关系，并且为所有连续的中间状态 $c \\in (0,1)$ 分配了零概率。在许多湍流火焰中，实验或直接数值模拟 (DNS) 数据表明中间状态存在非零概率，并且对前两阶矩有独立的约束。假设一个假定的 $c$ 的 PDF 必须满足以下约束：\n-   在 $[0,1]$ 上归一化。\n-   已知的极端事件概率 $p_0$ 和 $p_1$，即 $\\mathbb{P}(c=0) = p_0$，$\\mathbb{P}(c=1) = p_1$，其中 $0 \\le p_0, p_1 \\le 1$ 且 $p_0 + p_1 \\lt 1$。\n-   为 $c$ 指定的均值 $\\mu \\in (0,1)$ 和方差 $\\sigma^2 \\in (0, 1/4)$，这些值与测量结果一致。\n-   在 $c \\in (0,1)$ 上具有非零的连续概率。\n\n从第一性原理出发，分析为什么当 $p_0 + p_1 \\lt 1$ 且必须存在连续中间区域时，双狄拉克模型无法表示这些约束。然后，提出了一个混合模型，该模型将 $c=0$ 和 $c=1$ 处的点质量与一个支撑集在 $[0,1]$ 上的连续分量相结合，并推导混合权重与连续分量参数之间为满足归一化、均值和方差约束所需的关系。该连续分量必须严格支撑在 $[0,1]$ 上，非负，并且其参数化方式应使其均值和方差可以匹配。\n\n哪个选项正确地指定了一个混合模型和参数关系，该模型和关系满足上述所有约束，并确保参数的可辨识性和正定性？\n\nA. 在 $[0,1]$ 上使用一个三分量混合模型：\n-   假定的 PDF 为 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + w_c \\, b(c;\\alpha,\\beta)$，其中 $w_c = 1 - p_0 - p_1$，而 $b(c;\\alpha,\\beta)$ 是贝塔密度 $b(c;\\alpha,\\beta) = \\dfrac{c^{\\alpha-1}(1-c)^{\\beta-1}}{B(\\alpha,\\beta)}$，其中 $B(\\alpha,\\beta) = \\dfrac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$，$\\alpha > 0$，$\\beta > 0$。\n-   混合均值为 $\\mu = p_1 + w_c \\, m_c$，其中 $m_c = \\dfrac{\\alpha}{\\alpha + \\beta}$，意味着 $m_c = \\dfrac{\\mu - p_1}{w_c}$。\n-   总方差由有限混合模型的方差分解公式给出：$\\sigma^2 = w_c \\, v_c + p_0 \\, (0 - \\mu)^2 + p_1 \\, (1 - \\mu)^2 + w_c \\, (m_c - \\mu)^2$，其中 $v_c = \\dfrac{\\alpha \\beta}{(\\alpha+\\beta)^2 (\\alpha+\\beta+1)}$ 是贝塔方差。解出 $v_c$ 得 $v_c = \\dfrac{\\sigma^2 - p_0 \\mu^2 - p_1 (1 - \\mu)^2 - w_c (m_c - \\mu)^2}{w_c}$。\n-   给定 $m_c$ 和 $v_c$，且 $0 \\lt v_c \\lt m_c(1-m_c)$，定义 $\\kappa = \\dfrac{m_c(1 - m_c)}{v_c} - 1$，并设置 $\\alpha = m_c \\, \\kappa$，$\\beta = (1 - m_c) \\, \\kappa$。\n-   约束条件：$0 \\le p_0, p_1 \\le 1$，$w_c > 0$，$0 \\lt m_c \\lt 1$，$0 \\lt v_c \\lt m_c(1-m_c)$，$\\alpha > 0$，$\\beta > 0$。\n\nB. 使用 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + w_c \\, b(c;\\alpha,\\beta)$，其中 $w_c = 1 - p_0 - p_1$，设置均值为 $\\mu = p_1 + w_c \\, \\dfrac{\\alpha}{\\alpha+\\beta}$，但通过 $\\sigma^2 \\approx w_c \\, \\dfrac{\\alpha \\beta}{(\\alpha+\\beta)^2 (\\alpha+\\beta+1)}$ 来近似总方差（忽略分量间的贡献）。然后仅通过求解均值和此近似方差的两个方程来选择 $\\alpha$ 和 $\\beta$。\n\nC. 使用 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + w_c \\, \\varphi(c;\\mu_c,\\sigma_c^2)$，其中 $\\varphi(c;\\mu_c,\\sigma_c^2)$ 是在 $\\mathbb{R}$ 上均值为 $\\mu_c$、方差为 $\\sigma_c^2$ 的高斯密度，$w_c = 1 - p_0 - p_1$，并选择 $\\mu_c$ 和 $\\sigma_c^2$ 使混合均值和方差等于 $\\mu$ 和 $\\sigma^2$。\n\nD. 保留一个纯离散混合模型 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + p_m \\, \\delta(c - \\theta)$，其中 $p_m = 1 - p_0 - p_1$，并选择 $\\theta \\in (0,1)$ 来匹配目标均值和方差。\n\n选择唯一能够满足归一化、支撑集、均值和方差约束，并使用能够表示中间状态的连续分量，同时确保参数正定性和可辨识性的最佳选项。",
            "solution": "### 第 1 步：提取已知条件\n\n问题陈述为反应进程变量 $c \\in [0,1]$ 的假定概率密度函数 (PDF) $p(c)$ 提供了以下定义和约束：\n1.  **定义域**：反应进程变量 $c$ 定义在闭区间 $[0,1]$ 上。\n2.  **双狄拉克模型**：给定的一个初始理想化模型是 $p(c) = w_0 \\, \\delta(c) + w_1 \\, \\delta(c-1)$，其中 $w_0 \\ge 0$，$w_1 \\ge 0$，且 $w_0 + w_1 = 1$。\n3.  **更通用模型的新约束**：\n    -   **归一化**：PDF 必须在 $[0,1]$ 上归一化，即 $\\int_0^1 p(c) \\, dc = 1$。\n    -   **已知的极端事件概率**：处于未燃状态 ($c=0$) 和完全燃烧状态 ($c=1$) 的概率被指定为 $\\mathbb{P}(c=0) = p_0$ 和 $\\mathbb{P}(c=1) = p_1$。\n    -   **极端概率的条件**：$0 \\le p_0, p_1 \\le 1$ 且 $p_0 + p_1 \\lt 1$。\n    -   **指定的矩**：$c$ 的均值 $\\mu$ 和方差 $\\sigma^2$ 是已知的，其中 $\\mu \\in (0,1)$ 且 $\\sigma^2 \\in (0, 1/4)$。\n    -   **连续性**：PDF 必须在开区间 $c \\in (0,1)$ 上有一个非零的连续概率分量。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n问题首先是分析双狄拉克模型的缺陷，然后构建一个满足所有上述约束的更通用的混合模型。\n\n-   **科学依据**：该问题在计算燃烧领域，特别是在湍流-化学相互作用建模方面有坚实的科学基础。假定 PDF 方法、反应进程变量概念以及混合模型（包括贝塔分布）的使用都是标准技术。其数学框架基于基础概率论。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。它指定了一系列清晰的数学约束，并要求推导出一个满足这些约束的模型。这些约束并不矛盾，并引导推导向一类特定的模型发展。问题是明确的，并寻求一个基于所提供框架的、唯一的、可验证的结果。\n-   **客观性**：问题以精确、客观的数学语言陈述。它不含任何主观或基于意见的断言。\n\n该问题没有任何列出的无效性标准所指出的缺陷。它是一个在应用数学和工程科学领域有效的、可解的问题。\n\n### 第 3 步：结论与操作\n\n问题陈述是**有效**的。现在开始推导解答。\n\n### 推导\n\n首先，我们分析为什么双狄拉克模型 $p(c) = w_0 \\, \\delta(c) + w_1 \\, \\delta(c-1)$ 是不足的。\n1.  **缺乏连续分量**：根据其定义，该模型对于任何 $c \\in (0,1)$ 的概率密度均为零，这直接与“在 $c \\in (0,1)$ 上具有非零连续概率”的约束相矛盾。\n2.  **归一化约束**：该模型要求 $w_0 + w_1 = 1$。而新的约束指定了点质量 $p_0$ 和 $p_1$ 满足 $p_0 + p_1 \\lt 1$。这两者是矛盾的。一个具有点质量 $p_0$ 和 $p_1$ 的模型，如果不包含额外的概率质量，就无法归一化到 1。\n3.  **矩的依赖性**：双狄拉克模型的均值是 $\\mu = E[c] = \\int_0^1 c(w_0 \\delta(c) + w_1 \\delta(c-1)) dc = w_1$。二阶矩是 $E[c^2] = \\int_0^1 c^2(w_0 \\delta(c) + w_1 \\delta(c-1)) dc = w_1$。方差是 $\\sigma^2 = E[c^2] - \\mu^2 = w_1 - w_1^2 = \\mu - \\mu^2 = \\mu(1-\\mu)$。这在方差和均值之间施加了一个刚性关系。问题指出 $\\mu$ 和 $\\sigma^2$ 是独立的“与测量结果一致”，这通常不会满足 $\\sigma^2 = \\mu(1-\\mu)$。\n\n为了解决这些缺点，我们按要求构建一个混合模型。该模型必须由 $c=0$ 和 $c=1$ 处的离散部分以及 $c \\in (0,1)$ 的连续部分组成。这样一个 PDF 的通用形式是：\n$$p(c) = P_0 \\, \\delta(c) + P_1 \\, \\delta(c-1) + w_c \\, p_c(c)$$\n其中 $p_c(c)$ 是一个支撑集在 $[0,1]$ 上的连续 PDF，并且在该区间外为零。\n\n1.  **点质量**：约束 $\\mathbb{P}(c=0) = p_0$ 意味着在 $c=0$ 处的狄拉克 delta 的权重是 $P_0 = p_0$。同样，$\\mathbb{P}(c=1) = p_1$ 意味着 $P_1 = p_1$。\n2.  **归一化**：为了使 $p(c)$ 成为一个有效的 PDF，它必须积分为 1：\n    $$ \\int_0^1 p(c) \\, dc = \\int_0^1 [p_0 \\delta(c) + p_1 \\delta(c-1) + w_c p_c(c)] \\, dc = 1 $$\n    $$ p_0 + p_1 + w_c \\int_0^1 p_c(c) \\, dc = 1 $$\n    由于 $p_c(c)$ 本身是一个 PDF，它在其支撑集上的积分为 1。因此，我们有 $p_0 + p_1 + w_c = 1$。这给出了连续分量的权重：\n    $$ w_c = 1 - p_0 - p_1 $$\n    问题约束 $p_0 + p_1 \\lt 1$ 确保了 $w_c > 0$，从而证实了连续分量的存在。所提出的模型是 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + (1-p_0-p_1) \\, p_c(c)$。\n\n3.  **均值**：混合模型的均值 $\\mu$ 是其各分量均值的加权平均。$\\delta(c)$ 的均值为 $0$，$\\delta(c-1)$ 的均值为 $1$，并设 $p_c(c)$ 的均值为 $m_c$。\n    $$ \\mu = E[c] = p_0 \\cdot 0 + p_1 \\cdot 1 + w_c \\cdot m_c = p_1 + w_c m_c $$\n    我们可以解出连续分量所需的均值 $m_c$：\n    $$ m_c = \\frac{\\mu - p_1}{w_c} = \\frac{\\mu - p_1}{1 - p_0 - p_1} $$\n    为了使 $p_c(c)$ 成为一个在 $[0,1]$ 上的有效 PDF，其均值 $m_c$ 必须在 $[0,1]$ 内。对于一个非平凡的连续分量，我们要求 $0 \\lt m_c \\lt 1$。\n\n4.  **方差**：混合模型的方差 $\\sigma^2$ 可以使用全方差公式或直接定义找到。一个由 $k$ 个分布组成的混合模型的方差是 $\\sigma^2 = \\sum_{i=1}^k w_i (\\sigma_i^2 + (\\mu_i - \\mu)^2)$，其中 $w_i, \\mu_i, \\sigma_i^2$ 分别是第 $i$ 个分量的权重、均值和方差。\n    -   分量 1: $\\delta(c)$，权重 $w_1 = p_0$，均值 $\\mu_1 = 0$，方差 $\\sigma_1^2 = 0$。\n    -   分量 2: $\\delta(c-1)$，权重 $w_2 = p_1$，均值 $\\mu_2 = 1$，方差 $\\sigma_2^2 = 0$。\n    -   分量 3: $p_c(c)$，权重 $w_3 = w_c$，均值 $\\mu_3 = m_c$，方差 $v_c$。\n    将这些代入总方差公式：\n    $$ \\sigma^2 = p_0(0 + (0-\\mu)^2) + p_1(0 + (1-\\mu)^2) + w_c(v_c + (m_c-\\mu)^2) $$\n    $$ \\sigma^2 = p_0 \\mu^2 + p_1(1-\\mu)^2 + w_c v_c + w_c(m_c-\\mu)^2 $$\n    这是总方差的精确分解。我们可以解出连续分量所需的方差 $v_c$：\n    $$ v_c = \\frac{\\sigma^2 - p_0 \\mu^2 - p_1(1-\\mu)^2 - w_c(m_c-\\mu)^2}{w_c} $$\n    为了使 $v_c$ 成为连续分布的有效方差，我们必须有 $v_c > 0$。\n\n5.  **连续 PDF 的选择**：连续分量 $p_c(c)$ 必须是 $[0,1]$ 上的一个双参数分布，以便匹配其均值 $m_c$ 和方差 $v_c$。贝塔分布 $b(c;\\alpha, \\beta)$ 是标准选择。\n    $$ b(c;\\alpha, \\beta) = \\frac{c^{\\alpha-1}(1-c)^{\\beta-1}}{B(\\alpha,\\beta)}, \\quad \\alpha > 0, \\beta > 0 $$\n    贝塔分布的均值和方差是：\n    $$ m_c = \\frac{\\alpha}{\\alpha+\\beta}, \\qquad v_c = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)} $$\n    我们需要根据给定的 $m_c$ 和 $v_c$ 解出 $\\alpha$ 和 $\\beta$。设 $S = \\alpha+\\beta$ 且 $\\kappa = S$。从均值公式得，$\\alpha = m_c S$。则 $\\beta = S - \\alpha = S(1-m_c)$。代入方差表达式：\n    $$ v_c = \\frac{(m_c S)(1-m_c)S}{S^2(S+1)} = \\frac{m_c(1-m_c)}{S+1} $$\n    解出 $S$：\n    $$ S+1 = \\frac{m_c(1-m_c)}{v_c} \\implies S = \\frac{m_c(1-m_c)}{v_c} - 1 $$\n    我们使用选项 A 中定义的变量 $\\kappa$，$\\kappa = \\frac{m_c(1-m_c)}{v_c} - 1$。所以 $S=\\kappa$。\n    贝塔分布的参数是：\n    $$ \\alpha = m_c S = m_c \\kappa $$\n    $$ \\beta = (1-m_c)S = (1-m_c)\\kappa $$\n    为了使 $\\alpha$ 和 $\\beta$ 为正，我们需要 $0 \\lt m_c \\lt 1$ 和 $\\kappa > 0$。条件 $\\kappa > 0$ 等价于 $v_c \\lt m_c(1-m_c)$，这是任何在 $[0,1]$ 上均值为 $m_c$ 的随机变量方差的理论上界。等号只在两点离散分布时成立，因此对于连续分布，不等式必须是严格的。\n\n### 逐项分析\n\n**A. 在 $[0,1]$ 上使用一个三分量混合模型：**\n-   提出的 PDF 为 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + w_c \\, b(c;\\alpha,\\beta)$，其中 $w_c = 1 - p_0 - p_1$。这个结构是正确的。\n-   混合均值关系 $\\mu = p_1 + w_c \\, m_c$ 是正确的。\n-   总方差表达式 $\\sigma^2 = w_c \\, v_c + p_0 \\, (0 - \\mu)^2 + p_1 \\, (1 - \\mu)^2 + w_c \\, (m_c - \\mu)^2$ 是此有限混合模型方差的正确公式。我的推导与此完全匹配。\n-   贝塔分布的参数反演，$\\alpha = m_c \\, \\kappa$ 和 $\\beta = (1 - m_c) \\, \\kappa$，其中 $\\kappa = \\frac{m_c(1 - m_c)}{v_c} - 1$，是标准且正确的矩估计方法。\n-   所列出的所有约束对于模型定义良好且具有物理意义是必要且充分的。\n-   结论：**正确**。此选项提供了一个完整且严谨的解决方案，满足所有问题约束。\n\n**B. 使用 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + w_c \\, b(c;\\alpha,\\beta)$ ... 但近似总方差**\n-   此选项提出了一个近似 $\\sigma^2 \\approx w_c \\, v_c$。这个近似忽略了“分量间”方差 $p_0 \\mu^2 + p_1 (1-\\mu)^2 + w_c(m_c-\\mu)^2$。这一项通常不可忽略，并且可能是总方差的重要组成部分。作为一个要求严格的教授，我必须拒绝任何基于这种不严谨近似的解法，尤其是在有现成的精确公式的情况下。\n-   结论：**不正确**。\n\n**C. 使用 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + w_c \\, \\varphi(c;\\mu_c,\\sigma_c^2)$，其中 $\\varphi$ 是高斯密度**\n-   反应进程变量 $c$ 在物理上是有界的，$c \\in [0,1]$。而高斯（正态）分布的支撑集是整个实线 $\\mathbb{R} = (-\\infty, \\infty)$。使用高斯 PDF 作为连续分量会为非物理值（$c \\lt 0$ 和 $c > 1$）分配非零概率，这违反了该变量的基本定义。问题要求模型支撑在 $[0,1]$ 上。\n-   结论：**不正确**。\n\n**D. 保留一个纯离散混合模型 $p(c) = p_0 \\, \\delta(c) + p_1 \\, \\delta(c-1) + p_m \\, \\delta(c - \\theta)$**\n-   该模型仅将概率质量分配到三个离散点。它不具有“在 $c \\in (0,1)$ 上的非零连续概率”。这直接违反了主要约束之一。\n-   此外，一旦 $p_m = 1-p_0-p_1$ 被固定，该模型只有一个自由参数 $\\theta$。均值为 $\\mu = p_1 + p_m \\theta$，这唯一地确定了 $\\theta = (\\mu-p_1)/p_m$。在 $\\theta$ 被固定的情况下，方差 $\\sigma^2 = p_0 \\mu^2 + p_1(1-\\mu)^2 + p_m(\\theta-\\mu)^2$ 也被完全确定。该模型不能独立地满足对均值和方差的任意约束。它不够灵活。\n-   结论：**不正确**。\n\n唯一在数学上严谨、物理上一致，并满足所有给定约束的选项是选项 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论最终需要落实到计算。一旦确定了假定 PDF（无论是简单的还是混合的），我们如何用它来计算诸如物种质量分数这类量的平均值？这些量通常只能以混合分数的复杂表格函数形式获得。本练习  深入探讨了假定 PDF 方法的数值核心，指导我们实现一种专为 Beta-PDF 定制的高效数值积分技术——高斯-雅可比求积法。这让我们得以一窥这些先进模型在真实 CFD 代码中的实现细节。",
            "id": "4053718",
            "problem": "给定一个以混合分数 $Z \\in [0,1]$ 为函数的表格化组分质量分数剖面 $Y_i(Z)$。在恒定密度的假设下，雷诺 (Reynolds) 滤波与密度加权 (Favre) 滤波重合，对于一个假定的混合分数概率密度函数 (PDF)，滤波后的组分质量分数 $\\tilde{Y_i}$ 定义为其期望值\n$$\n\\tilde{Y_i} \\;=\\; \\int_{0}^{1} Y_i(Z)\\, P(Z;\\alpha,\\beta)\\, \\mathrm{d}Z,\n$$\n其中 $P(Z;\\alpha,\\beta)$ 是形状参数为 $\\alpha>0$ 和 $\\beta>0$ 的 Beta PDF，由下式给出\n$$\nP(Z;\\alpha,\\beta) \\;=\\; \\frac{Z^{\\alpha-1}(1-Z)^{\\beta-1}}{B(\\alpha,\\beta)},\n$$\n且 $B(\\alpha,\\beta)$ 表示 Beta 函数。\n\n从 $\\tilde{Y_i}$ 的积分定义和在区间 $[-1,1]$ 上权重为 $(1-x)^{a}(1+x)^{b}$ 的高斯-雅可比 (Gauss–Jacobi) 求积的标准形式出发，推导一个算法，用于在 $Y_i(Z)$ 仅以 $Z \\in [0,1]$ 上的表格化函数形式提供时，计算 $\\tilde{Y_i}$。你的算法必须：\n- 选择一个合适的变量替换，将 $[0,1]$ 上的 Beta 加权积分映射到 $[-1,1]$ 上的高斯-雅可比求积。\n- 使用一个插值方案来计算表格化的 $Y_i(Z)$ 在映射到 $Z$ 空间中的求积节点处的值。\n- 对于给定的 $(\\alpha,\\beta)$ 和指定的求积节点数 $N \\in \\mathbb{N}$，生成 $\\tilde{Y_i}$ 的数值估计。\n\n为评估和讨论高斯-雅可比求积在此背景下的数值精度，你需要为一组测试用例计算高斯-雅可比估计值相对于一个高精度参考积分的绝对误差。对于每个测试用例，表格化的 $Y_i(Z)$ 必须通过在 $[0,1]$ 的均匀网格上对已知的解析剖面 $g(Z)$进行采样来创建，并且参考值必须通过在 $[0,1]$ 上对解析被积函数 $g(Z)\\,P(Z;\\alpha,\\beta)$ 进行自适应积分来计算，并使用严格的容差。插值和求积方案的设计应避免伪振荡，并在端点 $Z=0$ 和 $Z=1$ 附近保持稳定性，特别是对于 $\\alpha<1$ 或 $\\beta<1$ 的情况，此时 Beta PDF 是奇异但可积的。\n\n实现一个完整的程序，该程序：\n- 对于每个测试用例，使用 $[0,1]$ 上至少 $M=1001$ 个点的均匀网格，从解析函数 $g(Z)$ 构建表格化的 $Y_i(Z)$。\n- 使用 $N$ 个节点的高斯-雅可比求积，针对由 $(\\alpha,\\beta)$ 隐含的 Beta 权重，计算 $\\tilde{Y_i}$。\n- 通过在 $[0,1]$ 上直接对 $g(Z)\\,P(Z;\\alpha,\\beta)$ 进行积分，计算 $\\tilde{Y_i}$ 的高精度参考值，绝对和相对容差均设置为 $10^{-13}$。\n- 对于每个测试用例，以浮点数形式返回绝对误差 $|\\tilde{Y_i}^{\\text{GJ}}-\\tilde{Y_i}^{\\text{ref}}|$。\n\n测试套件：\n- 案例 1：$\\alpha=2.5$, $\\beta=3.5$, $g(Z)=Z^{3}$, $N=2$。\n- 案例 2：$\\alpha=4.0$, $\\beta=1.5$, $g(Z)=Z^{5}$, $N=3$。\n- 案例 3：$\\alpha=0.6$, $\\beta=0.7$, $g(Z)=\\exp(2Z)$, $N=12$。\n- 案例 4：$\\alpha=0.2$, $\\beta=5.0$, $g(Z)=\\sin(\\pi Z)$, $N=24$。\n- 案例 5：$\\alpha=10.0$, $\\beta=10.0$, $g(Z)=\\cos(3Z)$, $N=8$。\n\n所有量均为无量纲。当 $g(Z)$ 中存在角度时，使用弧度。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_k$ 是测试案例 $k$ 的绝对误差，表示为浮点数。不应产生其他输出。",
            "solution": "我们从混合分数 $Z \\in [0,1]$ 的假定概率密度函数 (PDF) 下的滤波后组分质量分数的定义开始，假设密度恒定，使得雷诺 (Reynolds) 滤波和法福 (Favre) 滤波重合：\n$$\n\\tilde{Y_i} \\;=\\; \\mathbb{E}\\left[ Y_i(Z) \\right] \\;=\\; \\int_0^1 Y_i(Z)\\, P(Z;\\alpha,\\beta)\\,\\mathrm{d}Z,\n$$\n使用 Beta PDF\n$$\nP(Z;\\alpha,\\beta) \\;=\\; \\frac{Z^{\\alpha-1}(1-Z)^{\\beta-1}}{B(\\alpha,\\beta)},\n$$\n其中 $B(\\alpha,\\beta)=\\dfrac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$。\n\n为应用高斯-雅可比求积，回想一下它近似于以下形式的积分\n$$\n\\int_{-1}^{1} (1-x)^{a}(1+x)^{b} f(x)\\,\\mathrm{d}x \\;\\approx\\; \\sum_{k=1}^{N} w_k f(x_k),\n$$\n其中 $\\{x_k\\}$ 和 $\\{w_k\\}$ 是指数为 $a>-1$ 和 $b>-1$ 的 N 点雅可比节点和权重。我们希望计算\n$$\nI \\;=\\; \\int_{0}^{1} Y_i(Z)\\, Z^{\\alpha-1}(1-Z)^{\\beta-1}\\, \\mathrm{d}Z,\n$$\n然后通过 Beta 函数进行归一化来获得 Beta 加权的期望值：\n$$\n\\tilde{Y_i} \\;=\\; \\frac{I}{B(\\alpha,\\beta)}.\n$$\n我们通过仿射变换 $Z=\\dfrac{x+1}{2}$（其中 $x\\in[-1,1]$）将 $Z$ 映射到 $x$。则 $\\mathrm{d}Z = \\dfrac{1}{2}\\mathrm{d}x$，$1-Z = \\dfrac{1-x}{2}$，以及 $Z = \\dfrac{1+x}{2}$。代入后，我们得到\n\\begin{align*}\nI \\;=\\; \\int_{-1}^{1} Y_i\\!\\left(\\frac{x+1}{2}\\right)\\,\\left(\\frac{1+x}{2}\\right)^{\\alpha-1}\\!\\left(\\frac{1-x}{2}\\right)^{\\beta-1}\\,\\frac{1}{2}\\,\\mathrm{d}x \\\\\n=\\; 2^{-(\\alpha+\\beta-1)} \\int_{-1}^{1} (1-x)^{\\beta-1} (1+x)^{\\alpha-1}\\, Y_i\\!\\left(\\frac{x+1}{2}\\right)\\,\\mathrm{d}x.\n\\end{align*}\n这正是具有指数\n$$\na \\;=\\; \\beta-1, \\qquad b \\;=\\; \\alpha-1,\n$$\n和被积函数\n$$\nf(x) \\;=\\; Y_i\\!\\left(\\frac{x+1}{2}\\right).\n$$\n的雅可比形式。因此，N 点高斯-雅可比求积近似为\n$$\nI \\;\\approx\\; 2^{-(\\alpha+\\beta-1)} \\sum_{k=1}^{N} w_k\\, Y_i\\!\\left(\\frac{x_k+1}{2}\\right),\n$$\n且所需的 Beta 加权期望值为\n$$\n\\tilde{Y_i}^{\\text{GJ}} \\;=\\; \\frac{2^{-(\\alpha+\\beta-1)}}{B(\\alpha,\\beta)} \\sum_{k=1}^{N} w_k\\, Y_i\\!\\left(\\frac{x_k+1}{2}\\right).\n$$\n\n因为 $Y_i(Z)$ 仅在 $Z\\in[0,1]$ 上以表格化函数的形式提供，我们必须在映射后的求积节点 $Z_k = \\dfrac{x_k+1}{2}$ 处计算 $Y_i$。为避免振荡并重现平滑行为，我们采用三次样条插值。自然或非结点 (not-a-knot) 三次样条是连续的，并具有连续的一阶和二阶导数，对平滑数据是稳定的，并且能精确重现任何三次多项式，这在测试多项式剖面时对精度有利。\n\n对于参考值，我们通过自适应求积计算\n$$\n\\tilde{Y_i}^{\\text{ref}} \\;=\\; \\int_{0}^{1} g(Z)\\, \\frac{Z^{\\alpha-1}(1-Z)^{\\beta-1}}{B(\\alpha,\\beta)}\\, \\mathrm{d}Z,\n$$\n其中 $g(Z)$ 是生成该表格的解析剖面，绝对和相对容差均设为 $10^{-13}$。由于参考值使用的是精确的解析函数，这将求积误差与插值误差尽可能地分离开来。\n\n算法步骤：\n1. 对每个测试用例，定义解析函数 $g(Z)$ 和参数 $(\\alpha,\\beta)$。\n2. 在 $[0,1]$ 上建立一个包含 $M=1001$ 个点的均匀网格 $\\{Z_j\\}_{j=0}^{M-1}$，并制表 $Y_j=g(Z_j)$。\n3. 从表格数据构建一个三次样条插值函数 $S(Z)$。\n4. 获取指数为 $a=\\beta-1$ 和 $b=\\alpha-1$ 的 N 点雅可比节点和权重 $\\{x_k,w_k\\}$。\n5. 映射 $x_k \\mapsto Z_k=(x_k+1)/2$ 并计算 $S(Z_k)$。\n6. 构成高斯-雅可比估计值\n   $$\n   \\tilde{Y_i}^{\\text{GJ}} \\;=\\; \\frac{2^{-(\\alpha+\\beta-1)}}{B(\\alpha,\\beta)} \\sum_{k=1}^{N} w_k\\, S(Z_k).\n   $$\n7. 通过在 $[0,1]$ 上以严格的容差自适应积分 $g(Z) P(Z;\\alpha,\\beta)$ 来计算参考值 $\\tilde{Y_i}^{\\text{ref}}$。\n8. 报告绝对误差 $|\\tilde{Y_i}^{\\text{GJ}}-\\tilde{Y_i}^{\\text{ref}}|$。\n\n精度讨论：\n- 对于形式为 $Z^{m}$ 的被积函数，如果被积函数在求积节点处被精确计算，则具有 $N$ 个节点的高斯-雅可比求积对于 $m \\le 2N-1$ 是精确的。使用三次样条插值对三次剖面保持了精确性，并且对于足够精细的表格，能为更高阶的多项式提供高精度。\n- 当 $\\alpha<1$ 或 $\\beta<1$ 时，Beta PDF 具有可积的端点奇点。对于这类指数，高斯-雅可比节点会在端点附近聚集，从而提高精度，因为该求积方法是针对权重 $(1-x)^{a}(1+x)^{b}$ 优化的。映射 $Z=(x+1)/2$ 保留了这种在 $Z=0$ 和 $Z=1$ 附近的聚集特性。\n- 主要的误差来源是插值误差（如果表格数据粗糙或函数变化迅速）和求积截断误差（有限的 $N$）。增加 $M$ 可以减少插值误差，增加 $N$ 可以减少求积误差。用严格容差计算的参考积分可作为精确期望值的一个代理。\n\n程序为指定的测试套件实现了上述过程，并以方括号内单个逗号分隔列表的形式输出绝对误差，适合自动验证。所有量均为无量纲，并且 $g(Z)$ 中的任何角度都以弧度为单位。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_jacobi, beta as beta_fn\nfrom scipy.integrate import quad\nfrom scipy.interpolate import CubicSpline\n\ndef gauss_jacobi_expectation_from_tabulation(z_grid, y_grid, alpha, beta, n_nodes):\n    \"\"\"\n    Compute E[Y(Z)] under Beta(alpha,beta) using Gauss-Jacobi quadrature,\n    where Y is given as tabulated values (z_grid, y_grid) on [0,1].\n    \"\"\"\n    # Jacobi parameters for weight (1-x)^(a) (1+x)^(b)\n    a_j = beta - 1.0\n    b_j = alpha - 1.0\n    # Obtain nodes and weights on [-1,1] for Jacobi(a_j, b_j)\n    x, w = roots_jacobi(n_nodes, a_j, b_j)\n    # Map nodes to Z in [0,1]\n    z_nodes = 0.5 * (x + 1.0)\n    # Interpolate Y at z_nodes using a cubic spline\n    spline = CubicSpline(z_grid, y_grid, bc_type='not-a-knot')\n    y_nodes = spline(z_nodes)\n    # Unnormalized weighted integral over [0,1]\n    scale = 2.0 ** (-(alpha + beta - 1.0))\n    I = scale * np.dot(w, y_nodes)\n    # Normalize by Beta function to get expectation\n    return I / beta_fn(alpha, beta)\n\ndef reference_expectation_analytic(func, alpha, beta):\n    \"\"\"\n    High-accuracy reference: integrate func(z) * BetaPDF(z; alpha,beta) over [0,1].\n    \"\"\"\n    B = beta_fn(alpha, beta)\n    def integrand(z):\n        return func(z) * (z**(alpha - 1.0)) * ((1.0 - z)**(beta - 1.0)) / B\n    # Handle potential endpoint singularities robustly\n    val, _ = quad(integrand, 0.0, 1.0, epsabs=1e-13, epsrel=1e-13, limit=100, points=[0.0, 1.0])\n    return val\n\ndef build_tabulation(func, M=1001):\n    \"\"\"\n    Build a uniform tabulation of func on [0,1] with M points.\n    \"\"\"\n    z = np.linspace(0.0, 1.0, M, dtype=float)\n    y = func(z)\n    return z, y\n\ndef solve():\n    # Define analytic profiles for test cases\n    def g1(z): return z**3\n    def g2(z): return z**5\n    def g3(z): return np.exp(2.0 * z)\n    def g4(z): return np.sin(np.pi * z)\n    def g5(z): return np.cos(3.0 * z)\n\n    test_cases = [\n        # (alpha, beta, function g(z), N nodes)\n        (2.5, 3.5, g1, 2),\n        (4.0, 1.5, g2, 3),\n        (0.6, 0.7, g3, 12),\n        (0.2, 5.0, g4, 24),\n        (10.0, 10.0, g5, 8),\n    ]\n\n    results = []\n    # Build a sufficiently fine tabulation to reduce interpolation error\n    M = 1001\n    for alpha, beta, g, n in test_cases:\n        z_grid, y_grid = build_tabulation(g, M=M)\n        gj_est = gauss_jacobi_expectation_from_tabulation(z_grid, y_grid, alpha, beta, n)\n        ref = reference_expectation_analytic(g, alpha, beta)\n        err = abs(gj_est - ref)\n        results.append(err)\n\n    # Format output as a single line with comma-separated floats (scientific notation), no spaces.\n    print(\"[\" + \",\".join(f\"{r:.12e}\" for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}