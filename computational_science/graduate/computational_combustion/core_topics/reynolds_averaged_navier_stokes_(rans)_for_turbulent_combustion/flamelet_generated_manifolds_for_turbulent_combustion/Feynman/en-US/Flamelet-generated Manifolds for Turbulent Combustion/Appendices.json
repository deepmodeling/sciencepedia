{
    "hands_on_practices": [
        {
            "introduction": "Before constructing a Flamelet-Generated Manifold, it is essential to understand the fundamental behavior of the laminar flamelets that serve as its foundation. The \"S-curve\" is a cornerstone of flamelet theory, plotting a measure of flame strength against the scalar dissipation rate, $\\chi_{st}$, which quantifies strain and mixing. This exercise provides hands-on experience in computing the S-curve's critical turning points, which represent ignition and extinction limits, thereby solidifying the physical concepts of flame stability that motivate the entire FGM approach .",
            "id": "4027184",
            "problem": "You are given a reduced steady-flamelet model intended for constructing a Flamelet-Generated Manifold (FGM) for turbulent non-premixed combustion. The goal is to numerically compute the steady flamelet S-curve as the stoichiometric scalar dissipation rate varies and to identify turning points on that curve.\n\nStarting point and assumptions are as follows.\n\n- Consider the mixture-fraction coordinate $Z \\in [0,1]$ under the unity Lewis number limit, quasi-isobaric flow, and counterflow configuration. The steady flamelet equation for a lumped progress variable $c(Z)$ can be derived from steady species and energy conservation in mixture-fraction space and is of the form\n$$\n0 \\;=\\; -\\rho\\,\\chi_{st}\\,\\frac{\\partial^2 c}{\\partial Z^2} \\;+\\; \\omega_c(c,T,Z),\n$$\nwhere $\\rho$ is the mass density, $\\chi_{st}$ is the stoichiometric scalar dissipation rate, and $\\omega_c$ is the chemical source for the progress variable. The scalar dissipation rate is defined as\n$$\n\\chi \\;=\\; 2\\,D_Z\\,|\\nabla Z|^2,\n$$\nwhere $D_Z$ is the mixture fraction diffusivity. In the flamelet framework, the steady S-curve relates a scalar measure of flame strength (e.g., peak temperature or progress variable) to $\\chi_{st}$.\n\n- At the stoichiometric surface $Z=Z_{st}$, adopt an effective zero-dimensional closure that balances reaction and diffusive destruction, yielding an algebraic steady-state relation\n$$\n0 \\;=\\; \\mathrm{Da}\\;R(c) \\;-\\; \\chi_{st}\\;D(c),\n$$\nwhere $\\mathrm{Da}$ is the Damköhler number, $R(c)$ is an effective reaction term, and $D(c)$ is an effective diffusive destruction term. This approximation is commonly used to construct reduced models and interprets the local steady state at $Z_{st}$ as a balance between heat release and dissipative transport.\n\n- To capture chain-branching, heat-release saturation at high $c$, and non-adiabatic losses, use the following phenomenological yet scientifically plausible forms:\n$$\nR(c) \\;=\\; c\\,(1-c)\\,\\exp\\!\\Big(-\\frac{\\beta}{c+\\varepsilon}\\Big) \\;-\\; s\\,c^3, \\quad D(c) \\;=\\; c \\;+\\; \\gamma,\n$$\nwith constants $\\beta>0$ (activation parameter), $\\varepsilon>0$ (regularization parameter), $s>0$ (lumped heat-loss strength), and $\\gamma>0$ (diffusive offset modeling non-vanishing scalar transport). The S-curve is obtained parametrically from\n$$\n\\chi_{st}(c) \\;=\\; \\frac{\\mathrm{Da}\\,R(c)}{D(c)}, \\quad c \\in (0,1),\n$$\nand turning points are defined by the fold condition\n$$\n\\frac{d\\chi_{st}}{dc} \\;=\\; 0 \\;\\;\\Longleftrightarrow\\;\\; R'(c)\\,D(c) \\;-\\; R(c)\\,D'(c) \\;=\\; 0,\n$$\nwhere $R'(c)$ and $D'(c)$ denote derivatives with respect to $c$.\n\nYour task is to implement a complete, runnable program that:\n\n1. Computes the turning points $c^\\star \\in (0,1)$ by finding all roots of\n$$\nN(c) \\;\\equiv\\; R'(c)\\,D(c) \\;-\\; R(c)\\,D'(c) \\;=\\; 0,\n$$\nusing robust bracketing across $c \\in (0,1)$.\n\n2. Maps these turning points to the corresponding stoichiometric scalar dissipation rates\n$$\n\\chi_{st}^{\\star} \\;=\\; \\frac{\\mathrm{Da}\\,R(c^\\star)}{D(c^\\star)}.\n$$\n\n3. Returns only physically admissible turning points where $R(c^\\star) > 0$ and $\\chi_{st}^{\\star} > 0$.\n\n4. Expresses each reported $\\chi_{st}^{\\star}$ in $\\mathrm{s}^{-1}$, rounded to $6$ decimal places.\n\nDefinitions that appear in this problem include Flamelet-Generated Manifold (FGM), Damköhler number (Da), and the scalar dissipation rate $\\chi$. The implementation must not rely on any external data files or inputs and should be self-contained.\n\nTest Suite:\n\nFor each parameter set $(\\mathrm{Da},\\beta,\\varepsilon,\\gamma,s)$ below, compute the list of turning-point scalar dissipation rates $\\chi_{st}^{\\star}$.\n\n- Case $1$ (general happy path): $\\mathrm{Da}=15$, $\\beta=5$, $\\varepsilon=10^{-3}$, $\\gamma=0.02$, $s=0.20$.\n- Case $2$ (low reactivity, likely no folds): $\\mathrm{Da}=3$, $\\beta=5$, $\\varepsilon=10^{-3}$, $\\gamma=0.02$, $s=0.20$.\n- Case $3$ (high activation, modified losses): $\\mathrm{Da}=20$, $\\beta=12$, $\\varepsilon=10^{-3}$, $\\gamma=0.02$, $s=0.15$.\n\nFinal Output Specification:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must be a list of floating-point numbers (each rounded to $6$ decimal places) representing the $\\chi_{st}^{\\star}$ values in $\\mathrm{s}^{-1}$ for that case, ordered by increasing $c^\\star$. For example, if Case $1$ has two turning points and Case $2$ has none, and Case $3$ has one, then the output format must be\n$$\n[\\,[\\chi_{st,1}^{\\star},\\chi_{st,2}^{\\star}],\\,[\\,],\\,[\\chi_{st,3}^{\\star}]\\,].\n$$",
            "solution": "The user provides a phenomenological model for the steady-state of a non-premixed flamelet, situated at the stoichiometric mixture fraction $Z_{st}$. The model is presented as an algebraic balance between chemical reaction and diffusive transport, which is a common simplification in computational combustion for generating Flamelet-Generated Manifolds (FGM). The objective is to find the turning points of the flamelet \"S-curve\", which plots a measure of flame strength against the stoichiometric scalar dissipation rate, $\\chi_{st}$. These turning points correspond to critical phenomena such as ignition and extinction.\n\nThe governing algebraic equation is given as:\n$$\n0 \\;=\\; \\mathrm{Da}\\,R(c) \\;-\\; \\chi_{st}\\;D(c)\n$$\nHere, $c \\in (0,1)$ is a progress variable, $\\mathrm{Da}$ is the Damköhler number, $R(c)$ is the effective reaction rate, and $D(c)$ is the effective diffusive destruction rate. The stoichiometric scalar dissipation rate, $\\chi_{st}$, is treated as a bifurcation parameter.\n\nThe specified forms for $R(c)$ and $D(c)$ are:\n$$\nR(c) \\;=\\; c\\,(1-c)\\,\\exp\\!\\Big(-\\frac{\\beta}{c+\\varepsilon}\\Big) \\;-\\; s\\,c^3\n$$\n$$\nD(c) \\;=\\; c \\;+\\; \\gamma\n$$\nwhere $\\beta$, $\\varepsilon$, $s$, and $\\gamma$ are positive constants that model activation, regularization, heat loss, and diffusive offset, respectively.\n\nFrom the governing equation, the S-curve is parametrically defined by $\\chi_{st}$ as a function of $c$:\n$$\n\\chi_{st}(c) \\;=\\; \\frac{\\mathrm{Da}\\,R(c)}{D(c)}, \\quad c \\in (0,1)\n$$\nThe turning points, which are local extrema on the curve of $\\chi_{st}$ versus $c$, are found by setting the derivative of $\\chi_{st}(c)$ with respect to $c$ to zero:\n$$\n\\frac{d\\chi_{st}}{dc} \\;=\\; 0\n$$\nApplying the quotient rule for differentiation to the expression for $\\chi_{st}(c)$:\n$$\n\\frac{d\\chi_{st}}{dc} \\;=\\; \\mathrm{Da} \\cdot \\frac{R'(c)D(c) - R(c)D'(c)}{[D(c)]^2} \\;=\\; 0\n$$\nwhere $R'(c) = \\frac{dR}{dc}$ and $D'(c) = \\frac{dD}{dc}$. Since $\\mathrm{Da}$ is a positive constant and $D(c) = c+\\gamma$ is strictly positive for $c \\in (0,1)$ and $\\gamma>0$, the condition for a turning point simplifies to finding the roots of the numerator:\n$$\nN(c) \\;\\equiv\\; R'(c)D(c) - R(c)D'(c) \\;=\\; 0\n$$\nTo solve this equation, we first need the derivatives of $R(c)$ and $D(c)$.\nThe derivative of $D(c)$ is straightforward:\n$$\nD'(c) \\;=\\; \\frac{d}{dc}(c + \\gamma) \\;=\\; 1\n$$\nTo find $R'(c)$, we differentiate $R(c)$ term by term. Let $E(c) = \\exp\\left(-\\frac{\\beta}{c+\\varepsilon}\\right)$.\n$$\nR(c) \\;=\\; (c-c^2)E(c) - sc^3\n$$\nUsing the product rule and chain rule:\n$$\nR'(c) \\;=\\; \\frac{d}{dc}\\left((c-c^2)E(c)\\right) - \\frac{d}{dc}(sc^3)\n$$\n$$\n\\frac{d}{dc}\\left((c-c^2)E(c)\\right) \\;=\\; (1-2c)E(c) + (c-c^2)E'(c)\n$$\n$$\nE'(c) \\;=\\; \\exp\\left(-\\frac{\\beta}{c+\\varepsilon}\\right) \\cdot \\frac{d}{dc}\\left(-\\frac{\\beta}{c+\\varepsilon}\\right) \\;=\\; E(c) \\cdot \\frac{\\beta}{(c+\\varepsilon)^2}\n$$\nSubstituting $E'(c)$ back, and differentiating the loss term:\n$$\nR'(c) \\;=\\; (1-2c)E(c) + (c-c^2)\\frac{\\beta E(c)}{(c+\\varepsilon)^2} - 3sc^2\n$$\n$$\nR'(c) \\;=\\; \\left[ (1-2c) + \\frac{\\beta c(1-c)}{(c+\\varepsilon)^2} \\right] \\exp\\left(-\\frac{\\beta}{c+\\varepsilon}\\right) - 3sc^2\n$$\nWith these derivatives, the turning point condition becomes finding the roots $c^\\star$ of the function:\n$$\nN(c) \\;=\\; \\left( \\left[ (1-2c) + \\frac{\\beta c(1-c)}{(c+\\varepsilon)^2} \\right] E(c) - 3sc^2 \\right)(c+\\gamma) - \\left( (c-c^2)E(c) - sc^3 \\right) \\;=\\; 0\n$$\nThe problem is now reduced to a numerical root-finding problem for the function $N(c)$ over the interval $c \\in (0,1)$. A robust algorithm for this task is as follows:\n1.  Discretize the interval $c \\in (0,1)$ into a fine grid of points. A small padding is used to avoid the boundaries, e.g., $c \\in [10^{-6}, 1-10^{-6}]$.\n2.  Iterate through the grid, searching for pairs of adjacent points $(c_i, c_{i+1})$ where the function $N(c)$ changes sign, i.e., $N(c_i) \\cdot N(c_{i+1}) < 0$. Each such pair brackets a root.\n3.  For each bracketed interval, use a reliable numerical solver, such as Brent's method, to find the root $c^\\star$ to high accuracy.\n\nAfter finding all roots $c^\\star$, we must filter for physically admissible solutions. The problem specifies two conditions: $R(c^\\star) > 0$ and $\\chi_{st}^\\star > 0$. The scalar dissipation rate $\\chi_{st}^\\star$ is calculated as:\n$$\n\\chi_{st}^\\star \\;=\\; \\frac{\\mathrm{Da}\\,R(c^\\star)}{D(c^\\star)}\n$$\nGiven that $\\mathrm{Da} > 0$ and $D(c^\\star) = c^\\star+\\gamma > 0$ for $c^\\star \\in (0,1)$, the condition $\\chi_{st}^\\star > 0$ is equivalent to $R(c^\\star) > 0$. Thus, we only need to check if the net reaction rate is positive at the turning point.\n\nThe final algorithm for each test case is:\n1.  Define the function $N(c)$ for the given set of parameters $(\\beta, \\varepsilon, \\gamma, s)$.\n2.  Numerically find all roots $c^\\star \\in (0,1)$ of $N(c)=0$.\n3.  For each root $c^\\star$, check if $R(c^\\star) > 0$.\n4.  If the root is admissible, compute the corresponding turning-point scalar dissipation rate $\\chi_{st}^\\star$ using the given $\\mathrm{Da}$.\n5.  Collect all admissible pairs $(c^\\star, \\chi_{st}^\\star)$ and sort them in order of increasing $c^\\star$.\n6.  The final result for the test case is the list of $\\chi_{st}^\\star$ values, rounded to $6$ decimal places, corresponding to the sorted $c^\\star$ values.\nThis procedure is implemented for each of the provided parameter sets.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the turning points of the flamelet S-curve for given sets of parameters.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: (Da, beta, eps, gamma, s)\n        (15.0, 5.0, 1e-3, 0.02, 0.20),\n        # Case 2\n        (3.0, 5.0, 1e-3, 0.02, 0.20),\n        # Case 3\n        (20.0, 12.0, 1e-3, 0.02, 0.15),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        Da, beta, eps, gamma, s = params\n\n        def R(c, beta_p=beta, eps_p=eps, s_p=s):\n            \"\"\"Calculates the reaction term R(c).\"\"\"\n            if c <= 0.0 or c >= 1.0:\n                return 0.0\n            exp_term = np.exp(-beta_p / (c + eps_p))\n            return c * (1.0 - c) * exp_term - s_p * c**3\n\n        def N(c, beta_p=beta, eps_p=eps, gamma_p=gamma, s_p=s):\n            \"\"\"\n            Calculates the numerator function N(c) = R'(c)D(c) - R(c)D'(c)\n            whose roots are the turning points. Since D'(c) = 1, N(c) = R'(c)D(c) - R(c).\n            \"\"\"\n            # Domain check for safety, though bracketing is within (0,1)\n            if c <= 1e-9 or c >= 1.0 - 1e-9:\n                return np.nan\n\n            exp_term = np.exp(-beta_p / (c + eps_p))\n            \n            # Derivative of E(c) = exp(-beta/(c+eps))\n            # E_prime = exp_term * beta_p / (c + eps_p)**2\n            \n            # Derivative of R(c) = (c-c^2)E(c) - s*c^3\n            # R_prime = (1-2c)E(c) + (c-c^2)E_prime(c) - 3sc^2\n            Rp_term_in_brackets = (1.0 - 2.0*c) + c * (1.0 - c) * beta_p / (c + eps_p)**2\n            Rp = Rp_term_in_brackets * exp_term - 3.0 * s_p * c**2\n            \n            Rc = c * (1.0 - c) * exp_term - s_p * c**3\n            Dc = c + gamma_p\n            \n            return Rp * Dc - Rc\n\n        # Use a fine grid to bracket roots for N(c) = 0 in (0,1)\n        c_grid = np.linspace(1e-6, 1.0 - 1e-6, 10001)\n        roots = []\n        \n        y_grid = np.array([N(c) for c in c_grid])\n\n        for i in range(len(c_grid) - 1):\n            c1, c2 = c_grid[i], c_grid[i+1]\n            y1, y2 = y_grid[i], y_grid[i+1]\n            \n            if not (np.isnan(y1) or np.isnan(y2)):\n                if np.sign(y1) != np.sign(y2):\n                    try:\n                        root = brentq(N, c1, c2)\n                        # Add if not a duplicate of the last found root\n                        if not roots or not np.isclose(root, roots[-1]):\n                            roots.append(root)\n                    except (ValueError, RuntimeError):\n                        # brentq can fail if the function is strange, though unlikely here\n                        pass\n        \n        # Filter for admissible turning points and calculate chi_st\n        admissible_points = []\n        for c_star in roots:\n            Rc_star = R(c_star)\n            if Rc_star > 0.0:\n                Dc_star = c_star + gamma\n                chi_st_star = Da * Rc_star / Dc_star\n                admissible_points.append((c_star, chi_st_star))\n\n        # Sort results based on increasing c_star, as per problem specification\n        admissible_points.sort(key=lambda x: x[0])\n        \n        # Extract chi_st values and round to 6 decimal places\n        final_chi_st = [round(chi, 6) for c, chi in admissible_points]\n        all_results.append(final_chi_st)\n\n    # Format the final output string to be compact and without spaces\n    case_strings = []\n    for res_list in all_results:\n        case_strings.append(\"[\" + \",\".join(map(str, res_list)) + \"]\")\n    \n    final_output_string = \"[\" + \",\".join(case_strings) + \"]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "A Flamelet-Generated Manifold (FGM) simplifies complex chemistry by mapping thermochemical states onto a low-dimensional space. A crucial step in this process is defining the coordinates for this space. Alongside the conserved mixture fraction, $Z$, a reaction progress variable, $c$, is required to distinguish between unburnt, partially reacted, and fully burnt states. This practice explores the practical implications of this modeling choice by requiring the implementation and comparison of two common definitions for $c$—one based on product species and another on temperature—a foundational skill in FGM construction .",
            "id": "4027192",
            "problem": "You are given a one-dimensional flamelet parameterization by the mixture fraction $Z$, where $Z\\in[0,1]$ is a conserved scalar. For a Flamelet-Generated Manifold (FGM) representation of turbulent combustion, a reaction progress variable $c(Z)$ is often used to map the thermochemical state as a function of $Z$. Your task is to compute $c(Z)$ using two definitions that are grounded in the species and temperature fields of the flamelet, and then to quantify their difference over $Z\\in[0,1]$ via a norm.\n\nFundamental basis for the task:\n- The mixture fraction $Z$ is a conserved scalar that parameterizes a laminar flamelet solution, so species mass fractions $Y_i(Z)$ and temperature $T(Z)$ can be treated as functions on the interval $Z\\in[0,1]$.\n- Species conservation and energy conservation in laminar flamelets imply smooth, physically plausible profiles of major product species and temperature as functions of $Z$.\n\nDefinitions to be implemented without using any shortcuts:\n- Species-based progress variable: For each $Z$, form a signal from the four major product species, namely $\\mathrm{CO}_2$, $\\mathrm{H}_2\\mathrm{O}$, $\\mathrm{CO}$, and $\\mathrm{H}_2$. Combine their mass fractions in a way that yields a single scalar signal at each $Z$, and then normalize this signal by its maximal value over $Z\\in[0,1]$ so that the result lies in the interval $[0,1]$. If the maximal value is $0$, define the species-based progress variable to be $0$ for all $Z$.\n- Temperature-based progress variable: For each $Z$, subtract a prescribed unburnt temperature $T_u$ from the local temperature $T(Z)$, and normalize the result by the maximal temperature rise over $Z\\in[0,1]$ so that the result lies in the interval $[0,1]$. If the maximal temperature rise is $0$, define the temperature-based progress variable to be $0$ for all $Z$.\n\nNorm to quantify the difference:\n- Use the $L^2$ norm over $Z\\in[0,1]$ of the difference between the two progress variables. Implement a numerical approximation of the integral by the trapezoidal rule on a uniform grid of $N$ points over $[0,1]$, where $N$ is specified in the test suite. The output of the norm must be expressed as a unitless float.\n\nInput construction for each test case:\n- The species profiles and temperature are generated analytically to represent plausible flamelet behavior. For each test case, you are given parameters that define the product species mass fractions as smooth Gaussian functions centered near a stoichiometric-like mixture fraction $Z_{\\mathrm{st}}$ and a temperature field correlated to the total product signal. All species mass fractions are dimensionless, and temperature is in Kelvin (K). For any symbol appearing below, ensure it is treated as a mathematical entity.\n- For each species $i\\in\\{\\mathrm{CO}_2, \\mathrm{H}_2\\mathrm{O}, \\mathrm{CO}, \\mathrm{H}_2\\}$, the mass fraction profile is defined as a Gaussian\n$$\nY_i(Z)=A_i\\exp\\left(-\\frac{\\left(Z-\\mu_i\\right)^2}{2\\sigma_i^2}\\right),\n$$\nwhere $A_i$ is an amplitude, $\\mu_i$ is the center, and $\\sigma_i$ is the width. The centers are specified by $Z_{\\mathrm{st}}$ plus species-dependent shifts.\n- The temperature field is defined as\n$$\nT(Z)=T_u+T_{\\mathrm{peak}}\\left(S(Z)\\right)^\\alpha,\n$$\nwhere $S(Z)$ is the normalized total product signal constructed from the four product species used in the species-based progress variable definition, $T_u$ is the unburnt temperature, $T_{\\mathrm{peak}}$ is the maximal temperature rise parameter, and $\\alpha$ is an exponent controlling the sharpness. If the normalized signal is identically zero, the temperature profile reduces to $T(Z)=T_u$.\n\nNumerical details:\n- Use a uniform grid of $N$ points over $Z\\in[0,1]$.\n- Approximate the integral in the $L^2$ norm by the trapezoidal rule.\n- The final outputs are unitless floats.\n\nTest suite:\n- Case $1$ (general physically plausible flamelet):\n    - $N=1001$, $Z_{\\mathrm{st}}=0.08$, $T_u=300\\,\\mathrm{K}$, $T_{\\mathrm{peak}}=1600\\,\\mathrm{K}$, $\\alpha=1.0$.\n    - Species parameters:\n        - $\\mathrm{CO}_2$: $A_{\\mathrm{CO}_2}=0.12$, $\\mu_{\\mathrm{CO}_2}=Z_{\\mathrm{st}}$, $\\sigma_{\\mathrm{CO}_2}=0.03$.\n        - $\\mathrm{H}_2\\mathrm{O}$: $A_{\\mathrm{H}_2\\mathrm{O}}=0.10$, $\\mu_{\\mathrm{H}_2\\mathrm{O}}=Z_{\\mathrm{st}}$, $\\sigma_{\\mathrm{H}_2\\mathrm{O}}=0.035$.\n        - $\\mathrm{CO}$: $A_{\\mathrm{CO}}=0.02$, $\\mu_{\\mathrm{CO}}=Z_{\\mathrm{st}}+0.01$, $\\sigma_{\\mathrm{CO}}=0.015$.\n        - $\\mathrm{H}_2$: $A_{\\mathrm{H}_2}=0.005$, $\\mu_{\\mathrm{H}_2}=Z_{\\mathrm{st}}+0.04$, $\\sigma_{\\mathrm{H}_2}=0.06$.\n- Case $2$ (degenerate no-reaction case):\n    - $N=1001$, $Z_{\\mathrm{st}}=0.08$, $T_u=300\\,\\mathrm{K}$, $T_{\\mathrm{peak}}=0\\,\\mathrm{K}$, $\\alpha=1.0$.\n    - Species parameters:\n        - $\\mathrm{CO}_2$: $A_{\\mathrm{CO}_2}=0$, $\\mu_{\\mathrm{CO}_2}=Z_{\\mathrm{st}}$, $\\sigma_{\\mathrm{CO}_2}=0.03$.\n        - $\\mathrm{H}_2\\mathrm{O}$: $A_{\\mathrm{H}_2\\mathrm{O}}=0$, $\\mu_{\\mathrm{H}_2\\mathrm{O}}=Z_{\\mathrm{st}}$, $\\sigma_{\\mathrm{H}_2\\mathrm{O}}=0.035$.\n        - $\\mathrm{CO}$: $A_{\\mathrm{CO}}=0$, $\\mu_{\\mathrm{CO}}=Z_{\\mathrm{st}}+0.01$, $\\sigma_{\\mathrm{CO}}=0.015$.\n        - $\\mathrm{H}_2$: $A_{\\mathrm{H}_2}=0$, $\\mu_{\\mathrm{H}_2}=Z_{\\mathrm{st}}+0.04$, $\\sigma_{\\mathrm{H}_2}=0.06$.\n- Case $3$ (species formation without temperature rise):\n    - $N=1001$, $Z_{\\mathrm{st}}=0.06$, $T_u=300\\,\\mathrm{K}$, $T_{\\mathrm{peak}}=0\\,\\mathrm{K}$, $\\alpha=1.0$.\n    - Species parameters:\n        - $\\mathrm{CO}_2$: $A_{\\mathrm{CO}_2}=0.07$, $\\mu_{\\mathrm{CO}_2}=Z_{\\mathrm{st}}$, $\\sigma_{\\mathrm{CO}_2}=0.025$.\n        - $\\mathrm{H}_2\\mathrm{O}$: $A_{\\mathrm{H}_2\\mathrm{O}}=0.09$, $\\mu_{\\mathrm{H}_2\\mathrm{O}}=Z_{\\mathrm{st}}$, $\\sigma_{\\mathrm{H}_2\\mathrm{O}}=0.03$.\n        - $\\mathrm{CO}$: $A_{\\mathrm{CO}}=0.03$, $\\mu_{\\mathrm{CO}}=Z_{\\mathrm{st}}+0.008$, $\\sigma_{\\mathrm{CO}}=0.012$.\n        - $\\mathrm{H}_2$: $A_{\\mathrm{H}_2}=0.01$, $\\mu_{\\mathrm{H}_2}=Z_{\\mathrm{st}}+0.03$, $\\sigma_{\\mathrm{H}_2}=0.05$.\n\nYour program must:\n- Construct $Z$ on a uniform grid over $[0,1]$ of $N$ points for each case.\n- Generate the species profiles and temperature fields from the provided parameters.\n- Implement the species-based and temperature-based progress variables as described above.\n- Compute the $L^2$ norm of their difference over $Z\\in[0,1]$ using the trapezoidal rule.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each float rounded to six decimal places, for the three test cases in order, for example $[x_1,x_2,x_3]$.",
            "solution": "The problem requires the computation and comparison of two distinct definitions for a reaction progress variable, $c$, within the framework of Flamelet-Generated Manifolds (FGM) for turbulent combustion. The comparison is quantified by the $L^2$ norm of the difference between the two progress variables, evaluated over the domain of the mixture fraction, $Z \\in [0,1]$. The solution is developed by first constructing the necessary thermochemical fields (species mass fractions and temperature) from provided analytical models, then defining the progress variables, and finally computing the norm using numerical integration.\n\nThe computational domain for the mixture fraction, $Z$, is discretized into a uniform grid of $N$ points, denoted as $Z_k$ for $k=0, 1, \\dots, N-1$. The grid points are given by $Z_k = k \\cdot \\Delta Z$, where the grid spacing is $\\Delta Z = 1/(N-1)$.\n\nFirst, the mass fraction profiles for the four major product species, $i \\in \\{\\mathrm{CO}_2, \\mathrm{H}_2\\mathrm{O}, \\mathrm{CO}, \\mathrm{H}_2\\}$, are generated as functions of $Z$. According to the problem statement, each species profile $Y_i(Z)$ is modeled as a Gaussian function:\n$$\nY_i(Z)=A_i\\exp\\left(-\\frac{\\left(Z-\\mu_i\\right)^2}{2\\sigma_i^2}\\right)\n$$\nHere, $A_i$ is the amplitude, $\\mu_i$ is the center of the peak, and $\\sigma_i$ is the standard deviation (width). The parameters $\\{A_i, \\mu_i, \\sigma_i\\}$ are provided for each species in each test case. These functions are evaluated on the discrete grid $Z_k$ to obtain the arrays $Y_i(Z_k)$.\n\nWith the species profiles established, the first definition of the progress variable, which is based on species mass fractions, can be formulated. Let us denote this progress variable as $c_Y(Z)$. It is constructed from a signal representing the total mass fraction of the specified product species. This signal, $Y_{\\mathrm{prod}}(Z)$, is the sum of the individual mass fractions:\n$$\nY_{\\mathrm{prod}}(Z) = Y_{\\mathrm{CO}_2}(Z) + Y_{\\mathrm{H}_2\\mathrm{O}}(Z) + Y_{\\mathrm{CO}}(Z) + Y_{\\mathrm{H}_2}(Z)\n$$\nThis combined signal is then normalized by its maximum value over the entire mixture fraction space to ensure that the progress variable is bounded, $c_Y(Z) \\in [0, 1]$. Let $Y_{\\mathrm{prod,max}} = \\max_{Z \\in [0,1]} Y_{\\mathrm{prod}}(Z)$. The species-based progress variable is defined as:\n$$\nc_Y(Z) = \\begin{cases} \\frac{Y_{\\mathrm{prod}}(Z)}{Y_{\\mathrm{prod,max}}} & \\text{if } Y_{\\mathrm{prod,max}} > 0 \\\\ 0 & \\text{if } Y_{\\mathrm{prod,max}} = 0 \\end{cases}\n$$\nThe second case handles non-reactive scenarios where no products are formed.\n\nNext, the temperature-based progress variable, $c_T(Z)$, is formulated. This definition relies on the temperature field, $T(Z)$, which is itself defined in relation to the species-based signal. The temperature profile is given by:\n$$\nT(Z)=T_u+T_{\\mathrm{peak}}\\left(S(Z)\\right)^\\alpha\n$$\nwhere $T_u$ is the unburnt temperature, $T_{\\mathrm{peak}}$ is a parameter for the maximum temperature rise, $\\alpha$ is an exponent, and $S(Z)$ is the normalized total product signal. Per the problem statement, $S(Z)$ is constructed identically to the species-based progress variable, so we identify $S(Z) \\equiv c_Y(Z)$. The expression for temperature therefore becomes:\n$$\nT(Z)=T_u+T_{\\mathrm{peak}}\\left(c_Y(Z)\\right)^\\alpha\n$$\nThe temperature-based progress variable is defined as the local temperature rise, $T(Z) - T_u$, normalized by the maximum temperature rise over the domain, $\\Delta T_{\\mathrm{max}} = \\max_{Z \\in [0,1]} (T(Z) - T_u)$. The local temperature rise is directly $\\Delta T(Z) = T_{\\mathrm{peak}}(c_Y(Z))^\\alpha$. The maximum temperature rise is $\\Delta T_{\\mathrm{max}} = \\max_Z [T_{\\mathrm{peak}}(c_Y(Z))^\\alpha]$. Since $c_Y(Z) \\in [0,1]$, its maximum value is $1$ (unless it is identically zero). Thus, for a reactive case where $Y_{\\mathrm{prod,max}} > 0$ and $T_{\\mathrm{peak}} > 0$, we have $\\Delta T_{\\mathrm{max}} = T_{\\mathrm{peak}} \\cdot (1)^\\alpha = T_{\\mathrm{peak}}$. The temperature-based progress variable simplifies to:\n$$\nc_T(Z) = \\frac{T(Z) - T_u}{\\Delta T_{\\mathrm{max}}} = \\frac{T_{\\mathrm{peak}}\\left(c_Y(Z)\\right)^\\alpha}{T_{\\mathrm{peak}}} = \\left(c_Y(Z)\\right)^\\alpha\n$$\nSpecial care is taken for cases where the maximum temperature rise is zero. If $T_{\\mathrm{peak}}=0$, then $T(Z)=T_u$ for all $Z$, so $\\Delta T_{\\mathrm{max}}=0$, and by definition, $c_T(Z) = 0$. This aligns with the provided problem constraints.\n\nThe final step is to quantify the difference between $c_Y(Z)$ and $c_T(Z)$ using the $L^2$ norm, defined as:\n$$\n||c_Y - c_T||_{L^2} = \\sqrt{\\int_0^1 \\left(c_Y(Z) - c_T(Z)\\right)^2 dZ}\n$$\nThis integral is computed numerically using the trapezoidal rule on the discrete grid. Let $f(Z) = (c_Y(Z) - c_T(Z))^2$. The integral $I = \\int_0^1 f(Z) dZ$ is approximated as:\n$$\nI \\approx \\sum_{k=0}^{N-2} \\frac{f(Z_k) + f(Z_{k+1})}{2} \\Delta Z = \\Delta Z \\left( \\frac{f(Z_0) + f(Z_{N-1})}{2} + \\sum_{k=1}^{N-2} f(Z_k) \\right)\n$$\nThe $L^2$ norm is then $\\sqrt{I}$.\n\nThe procedure is applied to each test case:\n- **Case 1:** $\\alpha=1.0$ and $T_{\\mathrm{peak}} > 0$. This leads to $c_T(Z) = c_Y(Z)$. The difference is identically zero, so the $L^2$ norm is $0$.\n- **Case 2:** All species amplitudes $A_i=0$, so $Y_{\\mathrm{prod}}(Z)=0$ and consequently $c_Y(Z)=0$. Also, $T_{\\mathrm{peak}}=0$, so $c_T(Z)=0$. The difference is identically zero, and the norm is $0$.\n- **Case 3:** Species amplitudes $A_i > 0$, so $c_Y(Z)$ is a non-trivial function. However, $T_{\\mathrm{peak}}=0$, which means $T(Z)=T_u$ and $\\Delta T_{\\mathrm{max}}=0$. By definition, $c_T(Z)=0$. The norm to be computed is therefore $||c_Y(Z) - 0||_{L^2} = ||c_Y(Z)||_{L^2} = \\sqrt{\\int_0^1 (c_Y(Z))^2 dZ}$, which requires numerical evaluation.\n\nThis principled, step-by-step implementation ensures that all conditions and definitions from the problem statement are correctly translated into a computational algorithm.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the FGM progress variable comparison problem\n    for a given set of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"N\": 1001, \"Z_st\": 0.08, \"T_u\": 300.0, \"T_peak\": 1600.0, \"alpha\": 1.0,\n            \"species_params\": {\n                \"CO2\": {\"A\": 0.12, \"mu_shift\": 0.0, \"sigma\": 0.03},\n                \"H2O\": {\"A\": 0.10, \"mu_shift\": 0.0, \"sigma\": 0.035},\n                \"CO\": {\"A\": 0.02, \"mu_shift\": 0.01, \"sigma\": 0.015},\n                \"H2\": {\"A\": 0.005, \"mu_shift\": 0.04, \"sigma\": 0.06},\n            },\n        },\n        {\n            \"N\": 1001, \"Z_st\": 0.08, \"T_u\": 300.0, \"T_peak\": 0.0, \"alpha\": 1.0,\n            \"species_params\": {\n                \"CO2\": {\"A\": 0.0, \"mu_shift\": 0.0, \"sigma\": 0.03},\n                \"H2O\": {\"A\": 0.0, \"mu_shift\": 0.0, \"sigma\": 0.035},\n                \"CO\": {\"A\": 0.0, \"mu_shift\": 0.01, \"sigma\": 0.015},\n                \"H2\": {\"A\": 0.0, \"mu_shift\": 0.04, \"sigma\": 0.06},\n            },\n        },\n        {\n            \"N\": 1001, \"Z_st\": 0.06, \"T_u\": 300.0, \"T_peak\": 0.0, \"alpha\": 1.0,\n            \"species_params\": {\n                \"CO2\": {\"A\": 0.07, \"mu_shift\": 0.0, \"sigma\": 0.025},\n                \"H2O\": {\"A\": 0.09, \"mu_shift\": 0.0, \"sigma\": 0.03},\n                \"CO\": {\"A\": 0.03, \"mu_shift\": 0.008, \"sigma\": 0.012},\n                \"H2\": {\"A\": 0.01, \"mu_shift\": 0.03, \"sigma\": 0.05},\n            },\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = calculate_norm(params)\n        results.append(result)\n\n    # Format the final output as specified.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\n\ndef calculate_norm(params):\n    \"\"\"\n    Calculates the L2 norm of the difference between species-based and\n    temperature-based progress variables.\n    \n    Args:\n        params (dict): A dictionary containing all parameters for a single test case.\n        \n    Returns:\n        float: The computed L2 norm.\n    \"\"\"\n    N = params[\"N\"]\n    Z_st = params[\"Z_st\"]\n    T_peak = params[\"T_peak\"]\n    alpha = params[\"alpha\"]\n    species_params = params[\"species_params\"]\n\n    # Step 1: Create the mixture fraction grid\n    Z_grid = np.linspace(0.0, 1.0, N)\n\n    # Step 2: Calculate species profiles\n    Y_prod = np.zeros(N)\n    for sp_name, sp_p in species_params.items():\n        A = sp_p[\"A\"]\n        if A > 0: # Optimization: skip zero-amplitude species\n            mu = Z_st + sp_p[\"mu_shift\"]\n            sigma = sp_p[\"sigma\"]\n            Y_i = A * np.exp(-((Z_grid - mu)**2) / (2 * sigma**2))\n            Y_prod += Y_i\n\n    # Step 3: Calculate species-based progress variable c_Y\n    Y_prod_max = np.max(Y_prod)\n    if not np.isclose(Y_prod_max, 0.0):\n        c_Y = Y_prod / Y_prod_max\n    else:\n        c_Y = np.zeros(N)\n\n    # Step 4: Calculate temperature-based progress variable c_T\n    # Based on the analysis T_max_rise equals T_peak if T_peak > 0\n    # and c_T = (c_Y)^alpha. If T_peak is 0, c_T is 0 by definition.\n    if not np.isclose(T_peak, 0.0):\n        c_T = c_Y**alpha\n    else:\n        c_T = np.zeros(N)\n\n    # Step 5: Calculate the L2 norm of the difference\n    integrand = (c_Y - c_T)**2\n    integral = np.trapz(integrand, x=Z_grid)\n    \n    # The norm is the square root of the integral.\n    # Handle potential small negative values from numerical precision issues.\n    norm = np.sqrt(max(0, integral))\n\n    return norm\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "The ultimate purpose of an FGM is to provide a closure for the filtered chemical source term in a turbulent combustion simulation, such as a Large Eddy Simulation (LES). This is achieved by coupling the pre-computed manifold with the subgrid-scale statistics of the turbulent flow field. The presumed Probability Density Function (PDF) method is the standard approach for this coupling, where the filtered source term is found by integrating the tabulated source term over the presumed joint PDF of the manifold variables. This final practice guides you through this critical step, demonstrating how to compute the filtered reaction rate using a Beta-PDF closure, which forms the essential link between the offline manifold and the online flow simulation .",
            "id": "4027222",
            "problem": "You are tasked with computing the filtered progress source term in a flamelet-generated manifold framework for turbulent premixed or nonpremixed combustion. Let the mixture fraction be denoted by $Z \\in [0,1]$ and the progress variable by $c \\in [0,1]$. The filtered reaction source term for progress is defined as the double integral\n$$\n\\widetilde{\\dot{\\omega}}_c \\;=\\; \\int_0^1 \\int_0^1 \\dot{\\omega}_c(Z,c)\\, \\mathcal{P}_{Z,c}(Z,c)\\, dZ\\, dc,\n$$\nwhere $\\dot{\\omega}_c(Z,c)$ is a tabulated reaction source term on a manifold, and $\\mathcal{P}_{Z,c}(Z,c)$ is the joint probability density function of $Z$ and $c$ conditioned on the resolved-scale turbulence and chemistry. Assume statistical independence so that $\\mathcal{P}_{Z,c}(Z,c) = \\mathcal{P}_Z(Z)\\, \\mathcal{P}_c(c)$, and assume that both marginals are Beta-distributions supported on $[0,1]$ whose parameters are consistent with given filtered means and variances.\n\nYou are given the following known, well-tested modeling bases and definitions to start from:\n- The filtered quantity definition $\\widetilde{\\phi} = \\int \\phi\\, \\mathcal{P}\\, d\\boldsymbol{\\xi}$ for an appropriate set of subgrid variables $\\boldsymbol{\\xi}$ and normalized $\\mathcal{P}$ over its support.\n- A physically standard presumed-PDF closure: both $\\mathcal{P}_Z$ and $\\mathcal{P}_c$ are Beta-distributions on $[0,1]$, each characterized by a mean and a variance consistent with their definitions, with independence between $Z$ and $c$.\n- A tabulated manifold $\\dot{\\omega}_c(Z,c)$ that is smooth and bounded on $[0,1]\\times[0,1]$.\n\nIn this problem, you shall:\n- Derive the Beta-distribution parameters for $\\mathcal{P}_Z$ and $\\mathcal{P}_c$ from the given filtered means and variances, using only the defining relationships of the Beta-distribution on $[0,1]$.\n- Construct a tabulated manifold on a uniform midpoint grid and numerically evaluate the double integral using a consistent quadrature.\n\nManifold construction:\n- Define a uniform midpoint grid with $N_Z$ points in $Z$ and $N_c$ points in $c$, with midpoints $Z_i = \\frac{i+\\tfrac{1}{2}}{N_Z}$ for $i \\in \\{0,1,\\dots,N_Z-1\\}$ and $c_j = \\frac{j+\\tfrac{1}{2}}{N_c}$ for $j \\in \\{0,1,\\dots,N_c-1\\}$.\n- On this grid, define the tabulated manifold values by\n$$\n\\dot{\\omega}_c(Z,c) \\;=\\; S_0\\, \\exp\\!\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\, \\sigma_Z^2}\\right)\\, c\\,(1-c)\\,\\left[1 + a_1\\, (2Z-1)\\,(2c-1)\\right],\n$$\nwith $S_0 = 1$, $Z_{\\mathrm{st}} = 0.055$, $\\sigma_Z = 0.08$, and $a_1 = 0.2$. Treat all quantities as nondimensional; your final answers must be expressed in nondimensional units.\n\nNumerical evaluation:\n- Use the midpoint rectangle rule for the double integral on the tabulated grid. If $\\mathcal{P}_Z$ and $\\mathcal{P}_c$ are evaluated at the midpoints, the numerical approximation is\n$$\n\\widetilde{\\dot{\\omega}}_c \\;\\approx\\; \\sum_{i=0}^{N_Z-1}\\sum_{j=0}^{N_c-1} \\dot{\\omega}_c(Z_i,c_j)\\, \\mathcal{P}_Z(Z_i)\\, \\mathcal{P}_c(c_j)\\, \\Delta Z\\, \\Delta c,\n$$\nwhere $\\Delta Z = 1/N_Z$ and $\\Delta c = 1/N_c$. Ensure $\\mathcal{P}_Z$ and $\\mathcal{P}_c$ are properly normalized over $[0,1]$ in the continuous sense; when implementing numerically, renormalization of the discrete weights to unit sum is required to control quadrature and roundoff errors.\n\nInput parameters and admissibility:\n- You are given $\\tilde{Z}$, $\\widetilde{Z''^2}$, $\\tilde{c}$, and $\\widetilde{c''^2}$. These correspond to the means and variances of $Z$ and $c$, respectively. For a Beta-distribution to exist with the given mean $m$ and variance $v$, it must hold that $0 < m < 1$ and $0 < v < m(1-m)$.\n- If any provided mean is outside $(0,1)$, clamp it into the open interval by replacing it with $\\max(\\varepsilon, \\min(1-\\varepsilon, m))$ for a small $\\varepsilon$.\n- If any provided variance $v$ is not strictly within $(0, m(1-m))$, clamp it to the open interval by replacing it with $\\min\\big(m(1-m) - \\delta, \\max(v_{\\min}, v)\\big)$, where $v_{\\min}$ and $\\delta$ are small positive numbers to avoid singular limits.\n\nBeta-distribution parameter derivation task:\n- From only the definitions of the Beta-distribution on $[0,1]$ (mean and variance in terms of its two positive shape parameters), derive the two shape parameters for $\\mathcal{P}_Z$ and $\\mathcal{P}_c$ that are consistent with the given means and variances.\n\nComputational task:\n- Implement the full procedure to compute $\\widetilde{\\dot{\\omega}}_c$ for each parameter set in the following test suite, using $N_Z = 361$ and $N_c = 361$, with $\\varepsilon = 10^{-9}$, $v_{\\min} = 10^{-6}$, and $\\delta = 10^{-6}$:\n    - Case $1$: $(\\tilde{Z}, \\widetilde{Z''^2}, \\tilde{c}, \\widetilde{c''^2}) = (0.20, 0.010, 0.60, 0.020)$.\n    - Case $2$: $(\\tilde{Z}, \\widetilde{Z''^2}, \\tilde{c}, \\widetilde{c''^2}) = (0.80, 0.0001, 0.10, 0.0001)$.\n    - Case $3$: $(\\tilde{Z}, \\widetilde{Z''^2}, \\tilde{c}, \\widetilde{c''^2}) = (0.50, 0.200, 0.50, 0.200)$.\n    - Case $4$: $(\\tilde{Z}, \\widetilde{Z''^2}, \\tilde{c}, \\widetilde{c''^2}) = (0.02, 0.0001, 0.98, 0.0001)$.\n    - Case $5$: $(\\tilde{Z}, \\widetilde{Z''^2}, \\tilde{c}, \\widetilde{c''^2}) = (0.35, 0.150, 0.70, 0.150)$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $5$. Each entry must be a floating-point number representing $\\widetilde{\\dot{\\omega}}_c$ in nondimensional units. For example, the output should look like $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$.\n\nYour implementation must be completely self-contained and must not require any external input. It must use only the specified libraries and environment. Ensure scientific realism and numerical stability by adhering to the admissibility and clamping rules. The computation must be general and universally applicable under the stated assumptions and definitions.",
            "solution": "The user-provided problem statement is critically evaluated and determined to be valid. It is scientifically grounded in the field of turbulent combustion modeling, mathematically well-posed, and objectively formulated. All necessary data, models, and numerical procedures are specified, allowing for a unique and meaningful solution. We may therefore proceed with the derivation and computational implementation.\n\nThe problem requires the computation of the filtered progress variable source term, $\\widetilde{\\dot{\\omega}}_c$, within a flamelet-generated manifold (FGM) framework. The core of the problem lies in coupling a tabulated chemical source term, $\\dot{\\omega}_c(Z,c)$, with the subgrid-scale statistics of the mixture fraction, $Z$, and the progress variable, $c$. The filtered source term is given by the integral:\n$$\n\\widetilde{\\dot{\\omega}}_c = \\int_0^1 \\int_0^1 \\dot{\\omega}_c(Z,c)\\, \\mathcal{P}_{Z,c}(Z,c)\\, dZ\\, dc\n$$\nWith the assumption of statistical independence, the joint probability density function (PDF), $\\mathcal{P}_{Z,c}(Z,c)$, is factored into its marginals: $\\mathcal{P}_{Z,c}(Z,c) = \\mathcal{P}_Z(Z)\\, \\mathcal{P}_c(c)$. Both marginal PDFs are presumed to be Beta-distributions, a standard and physically appropriate choice for scalar variables bounded on the interval $[0,1]$.\n\nThe first task is to derive the shape parameters, $\\alpha$ and $\\beta$, of a Beta-distribution from its mean, $\\mu$, and variance, $\\sigma^2$. A random variable $X \\sim \\text{Beta}(\\alpha, \\beta)$ supported on $[0,1]$ has the following mean and variance:\n$$\n\\mu = \\mathbb{E}[X] = \\frac{\\alpha}{\\alpha + \\beta}\n$$\n$$\n\\sigma^2 = \\text{Var}[X] = \\frac{\\alpha \\beta}{(\\alpha + \\beta)^2 (\\alpha + \\beta + 1)}\n$$\nOur goal is to solve this system of two equations for the two unknowns, $\\alpha$ and $\\beta$. From the mean equation, we can express the sum of the parameters as $\\alpha + \\beta = \\alpha / \\mu$. Substituting this into the variance equation:\n$$\n\\sigma^2 = \\frac{\\alpha \\beta}{(\\alpha/\\mu)^2 (\\alpha/\\mu + 1)} = \\frac{\\mu^2 \\beta}{\\alpha(\\alpha/\\mu + 1)}\n$$\nA more direct approach is to first recognize that the variance can be written in terms of the mean:\n$$\n\\sigma^2 = \\left(\\frac{\\alpha}{\\alpha + \\beta}\\right) \\left(\\frac{\\beta}{\\alpha + \\beta}\\right) \\frac{1}{\\alpha + \\beta + 1} = \\mu (1-\\mu) \\frac{1}{\\alpha + \\beta + 1}\n$$\nFrom this simplified relation, we can solve for the term $\\alpha + \\beta + 1$:\n$$\n\\alpha + \\beta + 1 = \\frac{\\mu(1-\\mu)}{\\sigma^2}\n$$\nLet us define a common factor $\\nu = \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1$. Then we have $\\alpha + \\beta = \\nu$. For $\\alpha$ and $\\beta$ to be positive, it is required that $\\nu > 0$, which implies $\\frac{\\mu(1-\\mu)}{\\sigma^2} > 1$, or $\\sigma^2 < \\mu(1-\\mu)$. This is the physical realizability condition specified in the problem statement.\nNow, we can solve for $\\alpha$ and $\\beta$. From the mean definition, $\\alpha = \\mu(\\alpha+\\beta) = \\mu \\nu$. Substituting this into the sum gives $\\beta = \\nu - \\alpha = \\nu - \\mu\\nu = \\nu(1-\\mu)$.\nThus, the shape parameters are given by:\n$$\n\\alpha = \\mu \\left( \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 \\right)\n$$\n$$\n\\beta = (1-\\mu) \\left( \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 \\right)\n$$\nThese formulae will be used to determine the parameters for both $\\mathcal{P}_Z(Z)$ from $(\\tilde{Z}, \\widetilde{Z''^2})$ and $\\mathcal{P}_c(c)$ from $(\\tilde{c}, \\widetilde{c''^2})$ after applying the specified clamping procedure to ensure the inputs $(\\mu, \\sigma^2)$ satisfy the conditions $0 < \\mu < 1$ and $0 < \\sigma^2 < \\mu(1-\\mu)$.\n\nThe computational procedure is as follows:\n1.  For each input set $(\\tilde{Z}, \\widetilde{Z''^2}, \\tilde{c}, \\widetilde{c''^2})$, apply clamping.\n    - Clamp the means $\\tilde{Z}$ and $\\tilde{c}$ to be within $[\\varepsilon, 1-\\varepsilon]$. Let the clamped means be $m_Z$ and $m_c$.\n    - Clamp the variances $\\widetilde{Z''^2}$ and $\\widetilde{c''^2}$. For a generic mean $m$ and variance $v$, the clamped variance $v'$ is found by $v' = \\min\\big(m(1-m) - \\delta, \\max(v_{\\min}, v)\\big)$. Let the clamped variances be $v_Z$ and $v_c$.\n\n2.  Calculate the Beta-distribution shape parameters $(\\alpha_Z, \\beta_Z)$ using the clamped $(m_Z, v_Z)$ and $(\\alpha_c, \\beta_c)$ using the clamped $(m_c, v_c)$, applying the derived formulae.\n\n3.  Construct the numerical grid and the source term manifold.\n    - Define the uniform midpoint grids: $Z_i = \\frac{i+0.5}{N_Z}$ for $i \\in \\{0, \\dots, N_Z-1\\}$ and $c_j = \\frac{j+0.5}{N_c}$ for $j \\in \\{0, \\dots, N_c-1\\}$. The step sizes are $\\Delta Z = 1/N_Z$ and $\\Delta c = 1/N_c$.\n    - Evaluate the source term $\\dot{\\omega}_c(Z_i, c_j)$ at each point on the $N_Z \\times N_c$ grid using the provided function:\n      $$\n      \\dot{\\omega}_c(Z,c) = S_0\\, \\exp\\!\\left(-\\frac{(Z - Z_{\\mathrm{st}})^2}{2\\, \\sigma_Z^2}\\right)\\, c\\,(1-c)\\,\\left[1 + a_1\\, (2Z-1)\\,(2c-1)\\right]\n      $$\n      with parameters $S_0 = 1$, $Z_{\\mathrm{st}} = 0.055$, $\\sigma_Z = 0.08$, and $a_1 = 0.2$.\n\n4.  Evaluate the PDFs on the grids.\n    - The Beta-PDF is $\\mathcal{P}(x; \\alpha, \\beta) = \\frac{x^{\\alpha-1}(1-x)^{\\beta-1}}{B(\\alpha, \\beta)}$, where $B(\\alpha, \\beta)$ is the Beta function.\n    - Evaluate $\\mathcal{P}_Z(Z_i)$ using parameters $(\\alpha_Z, \\beta_Z)$.\n    - Evaluate $\\mathcal{P}_c(c_j)$ using parameters $(\\alpha_c, \\beta_c)$.\n\n5.  Compute the double integral using the midpoint rule and apply normalization.\n    - The raw integral is approximated by the sum:\n      $$\n      I_{\\text{raw}} = \\sum_{i=0}^{N_Z-1}\\sum_{j=0}^{N_c-1} \\dot{\\omega}_c(Z_i,c_j)\\, \\mathcal{P}_Z(Z_i)\\, \\mathcal{P}_c(c_j)\\, \\Delta Z\\, \\Delta c\n      $$\n    - To correct for quadrature error in the PDF representation, we normalize by the numerical integrals of the PDFs themselves:\n      $$\n      N_Z^{\\text{norm}} = \\sum_{i=0}^{N_Z-1} \\mathcal{P}_Z(Z_i) \\Delta Z \\quad \\text{and} \\quad N_c^{\\text{norm}} = \\sum_{j=0}^{N_c-1} \\mathcal{P}_c(c_j) \\Delta c\n      $$\n    - The final normalized filtered source term is:\n      $$\n      \\widetilde{\\dot{\\omega}}_c = \\frac{I_{\\text{raw}}}{N_Z^{\\text{norm}} N_c^{\\text{norm}}}\n      $$\nThis procedure is implemented for each of the five test cases provided.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import beta as beta_dist\n\ndef solve():\n    \"\"\"\n    Computes the filtered progress source term in a flamelet-generated manifold framework.\n    \"\"\"\n\n    # --- Problem Constants and Parameters ---\n    # Manifold constants\n    S0 = 1.0\n    Z_st = 0.055\n    sigma_Z_manifold = 0.08\n    a1 = 0.2\n\n    # Numerical parameters\n    N_Z = 361\n    N_c = 361\n    \n    # Clamping parameters\n    epsilon = 1e-9\n    v_min = 1e-6\n    delta = 1e-6\n\n    # --- Test Cases ---\n    test_cases = [\n        # (Z_mean, Z_var, c_mean, c_var)\n        (0.20, 0.010, 0.60, 0.020),\n        (0.80, 0.0001, 0.10, 0.0001),\n        (0.50, 0.200, 0.50, 0.200),\n        (0.02, 0.0001, 0.98, 0.0001),\n        (0.35, 0.150, 0.70, 0.150),\n    ]\n\n    results = []\n\n    # --- Grid Generation ---\n    # Uniform midpoint grids for Z and c\n    dZ = 1.0 / N_Z\n    dc = 1.0 / N_c\n    Z_grid = (np.arange(N_Z) + 0.5) * dZ\n    c_grid = (np.arange(N_c) + 0.5) * dc\n\n    # --- Manifold Generation ---\n    # 2D grid for evaluating the manifold\n    Z_mesh, c_mesh = np.meshgrid(Z_grid, c_grid, indexing='ij')\n\n    # Evaluate the source term manifold omega_c(Z,c)\n    term_gauss = np.exp(-((Z_mesh - Z_st)**2) / (2 * sigma_Z_manifold**2))\n    term_c = c_mesh * (1.0 - c_mesh)\n    term_coupling = 1.0 + a1 * (2*Z_mesh - 1) * (2*c_mesh - 1)\n    omega_c_manifold = S0 * term_gauss * term_c * term_coupling\n\n    for case in test_cases:\n        Z_mean_in, Z_var_in, c_mean_in, c_var_in = case\n\n        # Helper function for parameter calculation process\n        def process_scalar(mean_in, var_in):\n            # Step 1: Clamp mean and variance\n            m = np.clip(mean_in, epsilon, 1.0 - epsilon)\n            v_max = m * (1.0 - m)\n            v = np.clip(var_in, v_min, v_max - delta)\n            \n            # Step 2: Derive Beta distribution parameters\n            # nu = m(1-m)/v - 1\n            # alpha = m * nu\n            # beta = (1-m) * nu\n            common_factor = m * (1.0 - m) / v - 1.0\n            alpha = m * common_factor\n            beta = (1.0 - m) * common_factor\n            return alpha, beta\n\n        # --- PDF Parameter Calculation ---\n        alpha_Z, beta_Z = process_scalar(Z_mean_in, Z_var_in)\n        alpha_c, beta_c = process_scalar(c_mean_in, c_var_in)\n\n        # --- PDF Evaluation ---\n        # Evaluate Beta PDFs on their respective grids\n        P_Z = beta_dist.pdf(Z_grid, alpha_Z, beta_Z)\n        P_c = beta_dist.pdf(c_grid, alpha_c, beta_c)\n\n        # --- Numerical Integration ---\n        # Combine terms for the integrand: omega_c(Z,c) * P(Z) * P(c)\n        # Using broadcasting for efficiency:\n        # P_Z shape: (N_Z,), P_c shape: (N_c,)\n        # Reshape to (N_Z, 1) and (1, N_c) for broadcasting with (N_Z, N_c) manifold\n        integrand = omega_c_manifold * P_Z[:, np.newaxis] * P_c[np.newaxis, :]\n        \n        # Perform summation and multiply by cell area (dZ * dc)\n        raw_integral = np.sum(integrand) * dZ * dc\n\n        # --- Normalization ---\n        # Normalize to correct for quadrature error of the PDFs\n        norm_Z = np.sum(P_Z) * dZ\n        norm_c = np.sum(P_c) * dc\n        \n        # Handle potential for zero normalization factor, although unlikely with clamping\n        if norm_Z * norm_c > 0:\n            filtered_omega_c = raw_integral / (norm_Z * norm_c)\n        else:\n            filtered_omega_c = 0.0\n\n        results.append(filtered_omega_c)\n\n    # --- Format and Print Output ---\n    # The output string must be a comma-separated list in brackets\n    output_str = \"[\" + \",\".join(f\"{res:.8f}\" for res in results) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}