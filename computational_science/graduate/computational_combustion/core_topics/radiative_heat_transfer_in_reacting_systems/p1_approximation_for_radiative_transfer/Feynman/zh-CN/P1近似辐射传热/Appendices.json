{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个动手实践旨在为P1近似奠定坚实的理论基础。通过从基本的辐射传输方程出发推导扩散方程，并进行无量纲分析 ，您将揭示出决定辐射场行为的关键无量纲群。这项练习对于培养深刻的物理直觉至关重要，帮助您理解辐射场在何种情况下由局部发射/吸收主导，又在何种情况下由非局部的扩散效应主导。",
            "id": "4047872",
            "problem": "一种高温、灰体、吸收-发射-散射的燃烧气体充满了一个特征长度为 $L$ 的均匀平板。辐射场由稳态的灰体介质中各向同性散射的辐射传递方程（RTE）控制，并且辐射通过基尔霍夫热辐射定律与局部热力学状态耦合。将辐射强度的零阶角矩定义为入射辐射 $G(\\mathbf{x})=\\int_{4\\pi} I(\\mathbf{x},\\mathbf{s})\\,\\mathrm{d}\\Omega$，辐射热流矢量定义为 $\\mathbf{q}_{r}(\\mathbf{x})=\\int_{4\\pi} \\mathbf{s} I(\\mathbf{x},\\mathbf{s})\\,\\mathrm{d}\\Omega$。采用一阶球谐函数（P1）近似以及与 $\\mathbf{q}_{r}$ 相关的扩散闭合，并假设为稳态条件且无外部辐射源。\n\n从 RTE 的矩方程和 P1 闭合出发，导出以消光系数 $\\beta$、单次散射反照率 $\\omega$ 和局部温度 $T(\\mathbf{x})$ 表示的 $G(\\mathbf{x})$ 的扩散形式方程。然后，使用特征长度 $L$、参考温度 $T_{0}$、斯特藩-玻尔兹曼常数 $\\sigma$ 以及以下定义将此方程无量纲化：\n- $g(\\mathbf{x}) = G(\\mathbf{x})/\\left(4\\sigma T_{0}^{4}\\right)$，\n- $\\theta(\\mathbf{x}) = T(\\mathbf{x})/T_{0}$，\n- $\\mathbf{x}'=\\mathbf{x}/L$，\n- 光学厚度 $\\tau = \\beta L$，\n- 单次散射反照率 $\\omega = \\sigma_{s}/\\beta$，其中 $\\sigma_{s}$ 是散射系数。\n\n在得到的无量纲方程中，找出乘以吸收-发射弛豫项的单个无量纲群，该无量纲群量化了反应（吸收-发射）与扩散的相对重要性。请以 $\\tau$ 和 $\\omega$ 的单个闭式解析表达式形式提供您的最终答案。无需进行数值计算。请将您的最终答案表示为一个无单位的纯数。如果您引入了任何辅助量纲量，它们必须在最终表达式中被消掉。",
            "solution": "用户希望我解决以下问题：\n一种高温、灰体、吸收-发射-散射的燃烧气体充满了一个特征长度为 $L$ 的均匀平板。辐射场由稳态的灰体介质中各向同性散射的辐射传递方程（RTE）控制，并且辐射通过基尔霍夫热辐射定律与局部热力学状态耦合。将辐射强度的零阶角矩定义为入射辐射 $G(\\mathbf{x})=\\int_{4\\pi} I(\\mathbf{x},\\mathbf{s})\\,\\mathrm{d}\\Omega$，辐射热流矢量定义为 $\\mathbf{q}_{r}(\\mathbf{x})=\\int_{4\\pi} \\mathbf{s} I(\\mathbf{x},\\mathbf{s})\\,\\mathrm{d}\\Omega$。采用一阶球谐函数（P1）近似以及与 $\\mathbf{q}_{r}$ 相关的扩散闭合，并假设为稳态条件且无外部辐射源。\n\n从 RTE 的矩方程和 P1 闭合出发，导出以消光系数 $\\beta$、单次散射反照率 $\\omega$ 和局部温度 $T(\\mathbf{x})$ 表示的 $G(\\mathbf{x})$ 的扩散形式方程。然后，使用特征长度 $L$、参考温度 $T_{0}$、斯特藩-玻尔兹曼常数 $\\sigma$ 以及以下定义将此方程无量纲化：\n- $g(\\mathbf{x}) = G(\\mathbf{x})/\\left(4\\sigma T_{0}^{4}\\right)$，\n- $\\theta(\\mathbf{x}) = T(\\mathbf{x})/T_{0}$，\n- $\\mathbf{x}'=\\mathbf{x}/L$，\n- 光学厚度 $\\tau = \\beta L$，\n- 单次散射反照率 $\\omega = \\sigma_{s}/\\beta$，其中 $\\sigma_{s}$ 是散射系数。\n\n在得到的无量纲方程中，找出乘以吸收-发射弛豫项的单个无量纲群，该无量纲群量化了反应（吸收-发射）与扩散的相对重要性。请以 $\\tau$ 和 $\\omega$ 的单个闭式解析表达式形式提供您的最终答案。无需进行数值计算。请将您的最终答案表示为一个无单位的纯数。如果您引入了任何辅助量纲量，它们必须在最终表达式中被消掉。\n\n### 第 1 步：提取已知条件\n- **系统**：高温、灰体、吸收-发射-散射的燃烧气体，位于特征长度为 $L$ 的均匀平板中。\n- **控制物理**：稳态的灰体介质中各向同性散射的辐射传递方程（RTE）。辐射通过基尔霍夫定律与局部热力学状态耦合。\n- **近似**：一阶球谐函数（P1）近似和 $\\mathbf{q}_r$ 的扩散闭合。\n- **条件**：稳态（$\\frac{\\partial}{\\partial t} = 0$），无外部辐射源。\n- **定义**：\n    - 入射辐射：$G(\\mathbf{x})=\\int_{4\\pi} I(\\mathbf{x},\\mathbf{s})\\,\\mathrm{d}\\Omega$\n    - 辐射热流：$\\mathbf{q}_{r}(\\mathbf{x})=\\int_{4\\pi} \\mathbf{s} I(\\mathbf{x},\\mathbf{s})\\,\\mathrm{d}\\Omega$\n    - 消光系数：$\\beta = \\kappa + \\sigma_s$，其中 $\\kappa$ 是吸收系数，$\\sigma_s$ 是散射系数。\n- **无量纲化参数**：\n    - 特征长度：$L$\n    - 参考温度：$T_{0}$\n    - 斯特藩-玻尔兹曼常数：$\\sigma$\n    - 无量纲入射辐射：$g(\\mathbf{x}) = G(\\mathbf{x})/\\left(4\\sigma T_{0}^{4}\\right)$\n    - 无量纲温度：$\\theta(\\mathbf{x}) = T(\\mathbf{x})/T_{0}$\n    - 无量纲位置：$\\mathbf{x}'=\\mathbf{x}/L$\n    - 光学厚度：$\\tau = \\beta L$\n    - 单次散射反照率：$\\omega = \\sigma_{s}/\\beta$\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题是辐射传热领域的标准教科书练习，具体涉及 P1 近似的推导和分析。\n- **科学基础**：该问题基于辐射传递、RTE、基尔霍夫定律以及公认的 P1 近似方法等基本原理。所有概念在物理学和工程学中都是标准的。\n- **适定性**：该问题要求进行具体推导并确定一个无量纲群。所提供的信息足以完成这些任务，从而得出一个唯一的解析表达式。\n- **客观性**：该问题以精确、技术性的语言陈述，没有主观或模糊的术语。\n- **完整性和一致性**：问题陈述是自洽的。所有必要的定义、变量和常数都已提供。没有内部矛盾。\n- **现实性**：该模型描述了一个简化但物理上有意义的情景，与燃烧室等高温系统相关。\n- **结构**：该问题结构逻辑清晰，引导求解者从基本方程到最终的无量纲形式。\n\n该问题满足所有适定、科学合理问题的标准，因此被认为是有效的。\n\n### 第 3 步：结论与行动\n问题有效。我现在将进行完整的推导和求解。\n\n推导始于稳态、灰体、吸收、发射和各向同性散射介质的辐射传递方程（RTE）。在没有外部源的情况下，RTE 如下所示：\n$$\n\\mathbf{s} \\cdot \\nabla I(\\mathbf{x}, \\mathbf{s}) = \\kappa I_b(T) - \\kappa I(\\mathbf{x}, \\mathbf{s}) - \\sigma_s I(\\mathbf{x}, \\mathbf{s}) + \\frac{\\sigma_s}{4\\pi} \\int_{4\\pi} I(\\mathbf{x}, \\mathbf{s}') \\, \\mathrm{d}\\Omega'\n$$\n在此，$I(\\mathbf{x}, \\mathbf{s})$ 是位置 $\\mathbf{x}$ 处方向为 $\\mathbf{s}$ 的辐射强度，$\\kappa$ 是吸收系数，$\\sigma_s$ 是散射系数，$I_b(T)$ 是局部温度 $T(\\mathbf{x})$ 下的黑体辐射强度。根据基尔霍夫定律和斯特藩-玻尔兹曼定律，$I_b(T) = \\frac{\\sigma T^4}{\\pi}$。\n使用消光系数 $\\beta = \\kappa + \\sigma_s$ 和入射辐射 $G(\\mathbf{x}) = \\int_{4\\pi} I(\\mathbf{x}, \\mathbf{s}) \\, \\mathrm{d}\\Omega$ 的定义，RTE 可写为：\n$$\n\\mathbf{s} \\cdot \\nabla I = -\\beta I + \\kappa \\frac{\\sigma T^4}{\\pi} + \\frac{\\sigma_s}{4\\pi} G\n$$\n为了导出扩散方程，我们取 RTE 的零阶和一阶角矩。\n\n通过对 RTE 在所有立体角 $\\Omega$ 上积分得到零阶矩：\n$$\n\\int_{4\\pi} (\\mathbf{s} \\cdot \\nabla I) \\, \\mathrm{d}\\Omega = \\int_{4\\pi} \\left( -\\beta I + \\kappa \\frac{\\sigma T^4}{\\pi} + \\frac{\\sigma_s}{4\\pi} G \\right) \\, \\mathrm{d}\\Omega\n$$\n左侧可以使用角积分的散度定理重写为 $\\nabla \\cdot \\left(\\int_{4\\pi} \\mathbf{s} I \\, \\mathrm{d}\\Omega\\right)$。根据定义，这等于 $\\nabla \\cdot \\mathbf{q}_r$。\n右侧计算如下：\n$$\n-\\beta \\int_{4\\pi} I \\, \\mathrm{d}\\Omega + \\frac{\\kappa \\sigma T^4}{\\pi} \\int_{4\\pi} \\, \\mathrm{d}\\Omega + \\frac{\\sigma_s G}{4\\pi} \\int_{4\\pi} \\, \\mathrm{d}\\Omega = -\\beta G + 4\\pi \\frac{\\kappa \\sigma T^4}{\\pi} + \\frac{\\sigma_s G}{4\\pi} (4\\pi)\n$$\n$$\n= -\\beta G + 4\\kappa \\sigma T^4 + \\sigma_s G = -(\\beta - \\sigma_s) G + 4\\kappa \\sigma T^4\n$$\n因为 $\\kappa = \\beta - \\sigma_s$，零阶矩方程变为：\n$$\n\\nabla \\cdot \\mathbf{q}_r = \\kappa(4\\sigma T^4 - G)\n$$\n该方程表示辐射能量守恒，其中辐射通量的散度等于由发射和吸收添加到辐射场中的净体积功率。\n\nP1 近似依赖于 RTE 的一阶矩来建立通量 $\\mathbf{q}_r$ 的闭合关系。通过将 RTE 乘以 $\\mathbf{s}$ 并在所有立体角上积分，得到一阶矩方程：\n$$\n\\int_{4\\pi} \\mathbf{s}(\\mathbf{s} \\cdot \\nabla I) \\, \\mathrm{d}\\Omega = \\int_{4\\pi} \\mathbf{s} \\left( -\\beta I + \\kappa \\frac{\\sigma T^4}{\\pi} + \\frac{\\sigma_s}{4\\pi} G \\right) \\, \\mathrm{d}\\Omega\n$$\n在右侧，不含 $I$ 的项的积分由于对称性而消失，即 $\\int_{4\\pi} \\mathbf{s} \\, \\mathrm{d}\\Omega = \\mathbf{0}$。剩余项为 $-\\beta \\int_{4\\pi} \\mathbf{s} I \\, \\mathrm{d}\\Omega = -\\beta \\mathbf{q}_r$。\n左侧为 $\\nabla \\cdot \\left(\\int_{4\\pi} (\\mathbf{s} \\otimes \\mathbf{s}) I \\, \\mathrm{d}\\Omega\\right)$。强度的 P1 近似是截断的球谐函数展开式，$I(\\mathbf{x}, \\mathbf{s}) \\approx \\frac{1}{4\\pi} G(\\mathbf{x}) + \\frac{3}{4\\pi} \\mathbf{q}_r(\\mathbf{x}) \\cdot \\mathbf{s}$。将此代入积分中得到：\n$$\n\\int_{4\\pi} (\\mathbf{s} \\otimes \\mathbf{s}) I \\, \\mathrm{d}\\Omega \\approx \\int_{4\\pi} (\\mathbf{s} \\otimes \\mathbf{s}) \\left( \\frac{G}{4\\pi} + \\frac{3}{4\\pi} \\mathbf{q}_r \\cdot \\mathbf{s} \\right) \\, \\mathrm{d}\\Omega\n$$\n涉及 $\\mathbf{q}_r$ 的项的积分是一个三阶张量积分，由于对称性而为零。第一项的计算结果为 $\\frac{G}{4\\pi} \\int_{4\\pi} (\\mathbf{s} \\otimes \\mathbf{s}) \\, \\mathrm{d}\\Omega = \\frac{G}{4\\pi} \\left( \\frac{4\\pi}{3} \\mathbf{U} \\right) = \\frac{G}{3} \\mathbf{U}$，其中 $\\mathbf{U}$ 是单位张量。\n因此，左侧变为 $\\nabla \\cdot \\left(\\frac{G}{3} \\mathbf{U}\\right) = \\frac{1}{3}\\nabla G$。\n所以一阶矩方程为：\n$$\n\\frac{1}{3}\\nabla G = -\\beta \\mathbf{q}_r\n$$\n这得到辐射热流的 P1 扩散闭合，也称为辐射的菲克定律：\n$$\n\\mathbf{q}_r = -\\frac{1}{3\\beta} \\nabla G\n$$\n现在，将此闭合关系代入零阶矩方程：\n$$\n\\nabla \\cdot \\left( -\\frac{1}{3\\beta} \\nabla G \\right) = \\kappa(4\\sigma T^4 - G)\n$$\n假设介质是均匀的，消光系数 $\\beta$ 在空间上是恒定的，因此可以移到散度算子之外：\n$$\n-\\frac{1}{3\\beta} \\nabla^2 G = \\kappa(4\\sigma T^4 - G)\n$$\n整理并代入 $\\kappa = \\beta - \\sigma_s = \\beta(1 - \\sigma_s/\\beta) = \\beta(1-\\omega)$，我们得到 $G$ 的扩散方程：\n$$\n\\nabla^2 G = -3\\beta\\kappa (4\\sigma T^4 - G) = 3\\beta\\kappa (G - 4\\sigma T^4)\n$$\n$$\n\\nabla^2 G = 3\\beta^2(1-\\omega)(G - 4\\sigma T^4)\n$$\n这就是所需的入射辐射 $G(\\mathbf{x})$ 的有量纲方程。\n\n接下来，我们使用所提供的定义对该方程进行无量纲化：\n- $\\mathbf{x} = L\\mathbf{x}' \\implies \\nabla = \\frac{1}{L}\\nabla'$ and $\\nabla^2 = \\frac{1}{L^2}\\nabla'^2$\n- $G = 4\\sigma T_0^4 g$\n- $T = T_0 \\theta \\implies T^4 = T_0^4 \\theta^4$\n\n将这些代入有量纲方程中：\n$$\n\\frac{1}{L^2} \\nabla'^2 (4\\sigma T_0^4 g) = 3\\beta^2(1-\\omega) (4\\sigma T_0^4 g - 4\\sigma T_0^4 \\theta^4)\n$$\n常数因子 $4\\sigma T_0^4$ 出现在两侧，可以消去。方程简化为：\n$$\n\\frac{1}{L^2} \\nabla'^2 g = 3\\beta^2(1-\\omega) (g - \\theta^4)\n$$\n两边乘以 $L^2$ 得到最终的无量纲形式：\n$$\n\\nabla'^2 g = 3\\beta^2 L^2 (1-\\omega) (g - \\theta^4)\n$$\n使用光学厚度 $\\tau = \\beta L$ 的定义，我们有 $\\tau^2 = \\beta^2 L^2$。方程为：\n$$\n\\nabla'^2 g = 3\\tau^2(1-\\omega) (g - \\theta^4)\n$$\n该方程描述了辐射能量的扩散（左侧，$\\nabla'^2 g$）与通过吸收和发射进行的净能量交换速率（右侧）之间的平衡。项 $(g - \\theta^4)$ 代表了与局部辐射平衡的偏离，作为吸收-发射“反应”的驱动势。问题要求找出乘以该弛豫项的无量纲群。\n\n从最终方程可知，项 $(g - \\theta^4)$ 乘以系数 $3\\tau^2(1-\\omega)$。这整个系数是一个单一的无量纲群，它量化了吸收-发射过程强度与辐射扩散强度的比率。当该群很大时，反应占主导地位，辐射场趋向于局部热力学平衡（$g \\approx \\theta^4$）。当它很小时，扩散占主导地位，辐射场是非局部的。这个群就是所求的无量纲参数。",
            "answer": "$$\n\\boxed{3 \\tau^{2} (1 - \\omega)}\n$$"
        },
        {
            "introduction": "在掌握了基本方程之后，这项实践将挑战您将P1模型应用于非平面几何结构——这是火焰管或圆柱形炉等工程系统中的常见情景 。您需要将控制方程转换为圆柱坐标，并使用恰当的Marshak边界条件来求解一个边值问题。这项练习将提升您在数学物理方面的技能，并展示P1近似作为一种扩散模型的多功能性。",
            "id": "4047903",
            "problem": "考虑一个稳定的、轴对称的、无散射的、吸收-发射参与性气体，该气体位于半径为 $R$ 的长圆柱形火焰管内，这是计算燃烧系统的典型特征。辐射场使用一阶球谐近似 (P1) 进行建模，即辐射传输方程 (RTE) 的 $P_1$ 近似。吸收系数 $\\kappa_a$ 和 P1 扩散系数 $D$ 在空间上是均匀且恒定的。气相黑体强度 $I_b$ 是均匀的，散射可以忽略不计。令 $G(\\mathbf{x})$ 表示入射辐射，其定义为 $G(\\mathbf{x}) = \\int_{4\\pi} I(\\mathbf{x},\\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega$，其中 $I(\\mathbf{x},\\boldsymbol{\\Omega})$ 是辐射强度。\n\n从 RTE 出发，通过 $P_1$ 球谐闭合，推导 $G$ 的控制扩散方程，并在轴对称和轴向均匀的假设下，用柱坐标 $\\left(r,\\theta,z\\right)$ 表示它，使得 $G = G(r)$ 仅是 $r$ 的函数。位于 $r = R$ 处的圆柱形火焰管壁是一个被真空包围的冷黑表面；在壁面处施加适用于 $P_1$ 近似的 Marshak 边界条件。在 $r=0$ 处强制正则性。\n\n获得 $G(r)$ 的一个闭式解析表达式，用 $r$、$R$、$D$、$\\kappa_a$ 和 $I_b$ 表示。将 $G(r)$ 的最终结果以 $\\mathrm{W\\, m^{-2}}$ 为单位表示。最终答案必须是单一的解析表达式。不需要进行数值计算或四舍五入。",
            "solution": "用户希望使用 $P_1$ 近似法解决圆柱形介质中的辐射传热问题。\n\n### 第 1 步：问题验证\n\n首先，对问题陈述进行严格验证。\n\n#### 提取的已知条件\n- **系统**：稳态、轴对称、无散射、吸收-发射参与性气体。\n- **几何**：半径为 $R$ 的长圆柱形火焰管。\n- **模型**：一阶球谐近似 ($P_1$)。\n- **变量和常数**：\n    - 吸收系数 $\\kappa_a$ 在空间上均匀且恒定。\n    - $P_1$ 扩散系数 $D$ 在空间上均匀且恒定。\n    - 气相黑体强度 $I_b$ 是均匀的。\n- **因变量**：入射辐射 $G(\\mathbf{x}) = \\int_{4\\pi} I(\\mathbf{x},\\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega$。\n- **坐标系与假设**：柱坐标 $(r,\\theta,z)$，具有轴对称性和轴向均匀性，因此 $G = G(r)$。\n- **边界条件**：\n    1.  中轴线 $r=0$ 处的正则性。\n    2.  $r=R$ 处的壁面是一个被真空包围的冷黑表面。使用 Marshak 边界条件。\n- **目标**：推导 $G(r)$ 的闭式解析表达式，用 $r$、$R$、$D$、$\\kappa_a$ 和 $I_b$ 表示。\n\n#### 验证\n- **科学依据**：该问题是 $P_1$ 近似在辐射传输方程 (RTE) 中的一个标准应用，这是传热和计算燃烧领域一个基础且成熟的方法。所有概念，包括 RTE、球谐展开、Marshak 边界条件和扩散近似，都是科学合理的。\n- **适定性**：该问题描述了一个二阶常微分方程，带有两个边界条件（$r=0$ 处的正则性和 $r=R$ 处的条件）。这构成了一个适定的边值问题，预期会有一个唯一且稳定的解。\n- **客观性**：问题使用精确的技术语言陈述，没有主观或含糊的术语。\n- **完整性与一致性**：所有必要的物理常数（$\\kappa_a, D, I_b$）、几何参数（$R$）和边界条件都已指定。所提供的数据与物理模型一致。\n\n#### 结论\n该问题是有效的，因为它具有科学依据、适定性且陈述客观。可以进行求解过程。\n\n### 第 2 步：推导与求解\n\n求解过程首先从辐射传输方程 (RTE) 出发，使用 $P_1$ 近似法推导了入射辐射 $G$ 的控制微分方程。\n\n对于吸收、发射且无散射的介质，其 RTE 为：\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla I(\\mathbf{x}, \\boldsymbol{\\Omega}) = \\kappa_a [I_b(\\mathbf{x}) - I(\\mathbf{x}, \\boldsymbol{\\Omega})] $$\n其中 $I$ 是辐射强度，$\\boldsymbol{\\Omega}$ 是方向矢量，$\\kappa_a$ 是吸收系数，$I_b$ 是气体的黑体强度。\n\n$P_1$ 近似将强度展开为：\n$$ I(\\mathbf{x}, \\boldsymbol{\\Omega}) \\approx \\frac{1}{4\\pi} G(\\mathbf{x}) + \\frac{3}{4\\pi} \\mathbf{q}(\\mathbf{x}) \\cdot \\boldsymbol{\\Omega} $$\n其中 $G(\\mathbf{x}) = \\int_{4\\pi} I \\, \\mathrm{d}\\Omega$ 是入射辐射，$\\mathbf{q}(\\mathbf{x}) = \\int_{4\\pi} I \\boldsymbol{\\Omega} \\, \\mathrm{d}\\Omega$ 是辐射热流矢量。\n\n对 RTE 取零阶矩（对所有立体角 $4\\pi$ 积分）得到：\n$$ \\nabla \\cdot \\mathbf{q} = \\kappa_a (4\\pi I_b - G) $$\n对 RTE 取一阶矩（乘以 $\\boldsymbol{\\Omega}$ 并对 $4\\pi$ 积分）并应用闭合关系，得到辐射的 Fick 定律：\n$$ \\mathbf{q} = -\\frac{1}{3\\kappa_a} \\nabla G $$\n问题将辐射扩散系数定义为 $D$，通常 $D = \\frac{1}{3\\kappa_a}$。因此，$\\mathbf{q} = -D \\nabla G$。\n\n将 $\\mathbf{q}$ 的表达式代入零阶矩方程，得到 $G$ 的 $P_1$ 扩散方程：\n$$ \\nabla \\cdot (-D \\nabla G) = \\kappa_a (4\\pi I_b - G) $$\n由于 $D$ 和 $\\kappa_a$ 是常数，这简化为 Helmholtz 方程：\n$$ \\nabla^2 G - \\frac{\\kappa_a}{D} G = -\\frac{\\kappa_a}{D} (4\\pi I_b) $$\n\n对于轴对称且轴向均匀的圆柱系统，$G$ 仅依赖于径向坐标 $r$，所以 $G = G(r)$。柱坐标系中的拉普拉斯算子简化为 $\\nabla^2 G = \\frac{1}{r}\\frac{d}{dr}(r\\frac{dG}{dr})$。控制方程变为一个常微分方程：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dG}{dr}\\right) - \\frac{\\kappa_a}{D} G = -\\frac{\\kappa_a}{D} (4\\pi I_b) $$\n这是一种修正的 Bessel 方程。令 $\\lambda^2 = \\frac{\\kappa_a}{D}$。方程为：\n$$ \\frac{d^2G}{dr^2} + \\frac{1}{r}\\frac{dG}{dr} - \\lambda^2 G = -\\lambda^2 (4\\pi I_b) $$\n通解是一个特解 $G_p$ 和齐次解 $G_h$ 的和。通过观察，一个特解是 $G_p(r) = 4\\pi I_b$。齐次方程是零阶修正 Bessel 方程，其通解为 $G_h(r) = C_1 I_0(\\lambda r) + C_2 K_0(\\lambda r)$，其中 $I_0$ 和 $K_0$ 分别是第一类和第二类的零阶修正 Bessel 函数。\n$G(r)$ 的完整通解是：\n$$ G(r) = C_1 I_0(\\lambda r) + C_2 K_0(\\lambda r) + 4\\pi I_b $$\n\n现在，我们应用边界条件来确定常数 $C_1$ 和 $C_2$。\n1.  **$r=0$ 处的正则性**：为使解在中轴线 $r=0$ 处保持有限，含有 $K_0(\\lambda r)$ 的项必须为零，因为当 $x \\to 0$ 时 $K_0(x) \\to \\infty$。这要求 $C_2 = 0$。解简化为：\n    $$ G(r) = C_1 I_0(\\lambda r) + 4\\pi I_b $$\n\n2.  **$r=R$ 处的 Marshak 边界条件**：Marshak 边界条件要求在一个冷黑（即完美吸收）壁面处，从介质射向壁面的半球辐射通量为零，因为壁面不发射也不反射。离开介质的半球通量（以 $\\mathbf{n}=\\mathbf{e}_r$ 为出射法向）可以用P1近似表示为 $q_{out} = \\frac{G}{4} + \\frac{\\mathbf{q}\\cdot\\mathbf{n}}{2}$。令 $q_{out}=0$ 得到 $\\mathbf{q}\\cdot\\mathbf{n} = -G/2$。由于 $\\mathbf{q} \\cdot \\mathbf{n} = q_r(R) = -D \\frac{dG}{dr}\\big|_{r=R}$，边界条件变为：\n    $$ -D \\frac{dG}{dr}\\bigg|_{r=R} = -\\frac{G(R)}{2} \\quad \\implies \\quad G(R) - 2D \\frac{dG}{dr}\\bigg|_{r=R} = 0 $$\n    我们需要 $G(r)$ 的导数：\n    $$ \\frac{dG}{dr} = C_1 \\frac{d}{dr}I_0(\\lambda r) = C_1 \\lambda I_1(\\lambda r) $$\n    这里我们使用了恒等式 $\\frac{d}{dx}I_0(x) = I_1(x)$。在 $r=R$ 处应用边界条件：\n    $$ \\left[C_1 I_0(\\lambda R) + 4\\pi I_b\\right] - 2D \\left[C_1 \\lambda I_1(\\lambda R)\\right] = 0 $$\n    现在，我们求解 $C_1$：\n    $$ C_1 \\left[I_0(\\lambda R) - 2D\\lambda I_1(\\lambda R)\\right] = -4\\pi I_b $$\n    $$ C_1 = -\\frac{4\\pi I_b}{I_0(\\lambda R) - 2D\\lambda I_1(\\lambda R)} $$\n    系数 $C_1$ 是负的，这在物理上是正确的，因为它确保了入射辐射从中心向冷壁方向减小。\n\n最后，我们将 $C_1$ 代回到 $G(r)$ 的表达式中：\n$$ G(r) = 4\\pi I_b - \\frac{4\\pi I_b}{I_0(\\lambda R) - 2D\\lambda I_1(\\lambda R)} I_0(\\lambda r) $$\n提出公因子 $4\\pi I_b$ 得到最终表达式：\n$$ G(r) = 4\\pi I_b \\left( 1 - \\frac{I_0(\\lambda r)}{I_0(\\lambda R) - 2D\\lambda I_1(\\lambda R)} \\right) $$\n为了用给定参数表示结果，我们代入 $\\lambda = \\sqrt{\\kappa_a/D}$。项 $2D\\lambda$ 变为 $2D\\sqrt{\\kappa_a/D} = 2\\sqrt{D\\kappa_a}$。\n入射辐射 $G(r)$ 的最终闭式表达式为：\n$$ G(r) = 4\\pi I_b \\left( 1 - \\frac{I_0\\left(r\\sqrt{\\frac{\\kappa_a}{D}}\\right)}{I_0\\left(R\\sqrt{\\frac{\\kappa_a}{D}}\\right) - 2\\sqrt{D\\kappa_a} I_1\\left(R\\sqrt{\\frac{\\kappa_a}{D}}\\right)} \\right) $$",
            "answer": "$$ \\boxed{4\\pi I_b \\left( 1 - \\frac{I_0\\left(r\\sqrt{\\frac{\\kappa_a}{D}}\\right)}{I_0\\left(R\\sqrt{\\frac{\\kappa_a}{D}}\\right) - 2\\sqrt{D\\kappa_a} I_1\\left(R\\sqrt{\\frac{\\kappa_a}{D}}\\right)} \\right)} $$"
        },
        {
            "introduction": "最后的这项实践将理论与实际工程模拟联系起来。真实的燃烧气体，如$CO_2$和$H_2O$，具有高度的非灰体辐射特性，可以使用灰气体加权和（WSGG）方法进行建模 。通过实施一个多谱带P1模型，您不仅能解决一个更接近现实的问题，还将评估计算结果对光谱模型精度的敏感性，这是现代计算燃烧分析中的一个关键环节。",
            "id": "4047817",
            "problem": "实现一种多谱带一阶球谐函数(P1)近似法，用于计算一个一维板式炉内由二氧化碳(CO$_2$)和水蒸气(H$_2$O)排放引起的辐射换热，并评估左壁辐射热通量对光谱带离散化选择的敏感性。气体板占据位置 $x \\in [0,L]$，其气体温度 $T_g$ 在空间上均匀分布。位于 $x=0$ 和 $x=L$ 的壁面为黑体漫射壁，温度分别为 $T_{w,0}$ 和 $T_{w,L}$。假设系统处于稳态，只考虑吸收-发射（无散射），强度各向同性，且谱带吸收系数在空间上均匀。P1近似法通过辐射亮度的零阶角矩、平均强度 $J(x)$ 以及用于辐射压力张量的 Eddington 近似来定义。\n\n从吸收-发射介质的辐射传输方程及其角矩出发。在一阶球谐函数闭合和各向同性发射的条件下，每个灰气体谱带 $b$ 内的谱带积分平均强度 $J_b(x)$ 满足一个关于 $x$ 的常系数二阶常微分方程，并伴有在两侧壁面上的 Marshak 边界条件。使用灰气体加权和(WSGG)模型将 CO$_2$/H$_2$O 的组合排放近似为一组 $N_b$ 个灰气体谱带，每个谱带 $b=1,\\dots,N_b$ 具有权重 $w_b$（总和为1）和灰体吸收系数 $\\kappa_b>0$。为了在扩散近似中保证数值稳健性，如果存在透明气体谱带，应使用一个小的正数下限来严格避免零吸收。\n\n令 $B_b(T)$ 为谱带黑体强度，定义为 $B_b(T) = w_b \\, \\sigma T^4 / \\pi$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。令 $D_b=1/(3\\kappa_b)$ 为谱带扩散系数。$J_b(x)$ 的控制方程和边界条件将作为求解过程的一部分，从第一性原理推导得出，然后进行解析求解以计算每个谱带的 $J_b(0)$。谱带 $b$ 对进入左壁的净辐射热通量的贡献为 $q_{w,0}^{(b)} = 2\\pi\\left(J_b(0) - B_b(T_{w,0})\\right)$，总左壁热通量为 $q_{w,0} = \\sum_b q_{w,0}^{(b)}$。所有热通量必须以 $\\mathrm{W/m^2}$ 为单位报告。\n\n对炉和光谱带使用以下科学上合理的参数，这些参数旨在代表大气压下具有中等到厚光学行为的典型 CO$_2$/H$_2$O 发射气体：\n\n- 气体板厚度 $L = 1\\,\\text{m}$。\n- 气体温度 $T_g = 1800\\,\\text{K}$。\n- 左壁温度 $T_{w,0} = 500\\,\\text{K}$。\n- 右壁温度 $T_{w,L} = 800\\,\\text{K}$。\n- 斯特藩-玻尔兹曼常数 $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n\n定义三个谱带选择集：\n\n- 粗糙集 $\\mathcal{C}_1$，其中 $N_b = 1$：权重 $w = [1.0]$，吸收系数 $\\kappa\\,(\\mathrm{m^{-1}}) = [0.4]$。\n- 中等集 $\\mathcal{C}_3$，其中 $N_b = 3$：权重 $w = [0.5,\\,0.35,\\,0.15]$，吸收系数 $\\kappa\\,(\\mathrm{m^{-1}}) = [0.1,\\,0.8,\\,2.0]$。\n- 精细集 $\\mathcal{C}_5$，其中 $N_b = 5$：权重 $w = [0.35,\\,0.25,\\,0.20,\\,0.12,\\,0.08]$，吸收系数 $\\kappa\\,(\\mathrm{m^{-1}}) = [0.05,\\,0.2,\\,0.7,\\,1.5,\\,3.0]$。\n\n通过将精细集 $\\mathcal{C}_5$ 的所有吸收系数乘以因子 $10^{-3}$ 来构建一个额外的近透明行为的边缘案例测试，并通过将两个壁温设置得与气体温度相等（即 $T_{w,0}=T_{w,L}=T_g$），使用精细集 $\\mathcal{C}_5$ 来构建另一个边界一致性测试。\n\n您的程序必须：\n- 推导并求解带有 Marshak 边界条件的谱带P1扩散方程，以解析地获得每个谱带 $b$ 的 $J_b(0)$。\n- 计算并报告以下情况的总左壁热通量 $q_{w,0}$：\n  - 情况 A：粗糙集 $\\mathcal{C}_1$。\n  - 情况 B：中等集 $\\mathcal{C}_3$。\n  - 情况 C：精细集 $\\mathcal{C}_5$。\n  - 情况 D：近透明精细集 $\\mathcal{C}_5$，其中 $\\kappa_b \\mapsto 10^{-3}\\kappa_b$。\n  - 情况 E：使用 $\\mathcal{C}_5$ 的等温边界，其中 $T_{w,0}=T_{w,L}=T_g$。\n- 此外，计算灵敏度指标，即粗糙集和中等集相对于精细集的相对偏差（以小数表示）：\n  - $\\delta_{\\mathcal{C}_1} = \\dfrac{q_{w,0}(\\mathcal{C}_1) - q_{w,0}(\\mathcal{C}_5)}{q_{w,0}(\\mathcal{C}_5)}$，\n  - $\\delta_{\\mathcal{C}_3} = \\dfrac{q_{w,0}(\\mathcal{C}_3) - q_{w,0}(\\mathcal{C}_5)}{q_{w,0}(\\mathcal{C}_5)}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序和单位排列：\n$[q_{w,0}(\\mathcal{C}_1),\\,q_{w,0}(\\mathcal{C}_3),\\,q_{w,0}(\\mathcal{C}_5),\\,\\delta_{\\mathcal{C}_1},\\,\\delta_{\\mathcal{C}_3}),\\,q_{w,0}(\\text{近透明 }\\mathcal{C}_5),\\,q_{w,0}(\\text{等温边界 }\\mathcal{C}_5)]$，其中每个 $q_{w,0}$ 的单位是 $\\mathrm{W/m^2}$，每个 $\\delta$ 是一个小数。\n\n所有角度量（如有）必须以弧度为单位，但此问题不需要明确的角度输入。最终输出必须是浮点数。\n\n不提供用户输入。在程序中硬编码指定的测试套件。",
            "solution": "经评估，问题陈述有效。该问题科学上基于辐射传热的既定原理，特别是一阶球谐函数(P1)近似和灰气体加权和(WSGG)模型。该问题是适定的，提供了推导唯一解析解所需的一整套物理参数、边界条件和模型定义。语言客观，任务可通过计算验证。\n\n求解过程首先从基本原理推导控制微分方程和边界条件，然后解析求解所得的边值问题。\n\n**1. P1控制方程的推导**\n\n该问题的基础是辐射传输方程(RTE)。对于一维、稳态、吸收-发射、非散射介质，光谱RTE为：\n$$\n\\mu \\frac{dI_\\nu(x, \\mu)}{dx} = \\kappa_\\nu [I_{b\\nu}(T) - I_\\nu(x, \\mu)]\n$$\n其中 $I_\\nu(x, \\mu)$ 是在位置 $x$、方向 $\\mu = \\cos\\theta$ 上的光谱辐射亮度，$\\kappa_\\nu$ 是光谱吸收系数，$I_{b\\nu}(T)$ 是温度 $T$ 下的 Planck 黑体函数。\n\nWSGG模型将非灰气体近似为 $N_b$ 个灰气体的总和，每个灰气体占据能量谱的一部分 $w_b$，并具有恒定的吸收系数 $\\kappa_b$。这使我们能够为每个谱带 $b$ 求解一个等效的灰气体RTE，然后将结果相加。单个谱带 $b$ 的RTE为：\n$$\n\\mu \\frac{dI_b(x, \\mu)}{dx} = \\kappa_b [B_b(T_g) - I_b(x, \\mu)]\n$$\n其中 $I_b(x, \\mu)$ 是谱带辐射亮度，$B_b(T_g) = w_b \\sigma T_g^4 / \\pi$ 是在均匀气体温度 $T_g$ 下谱带 $b$ 中的黑体强度分数。\n\nP1近似依赖于辐射亮度的零阶和一阶角矩。零阶矩与平均强度 $J_b(x)$ 相关，一阶矩是辐射热通量 $q_{r,b}(x)$：\n$$\nJ_b(x) = \\frac{1}{2}\\int_{-1}^{1} I_b(x, \\mu) d\\mu\n$$\n$$\nq_{r,b}(x) = 2\\pi \\int_{-1}^{1} I_b(x, \\mu) \\mu d\\mu\n$$\n\n取谱带RTE的零阶矩（对 $\\mu \\in [-1, 1]$ 积分）：\n$$\n\\frac{d}{dx} \\left( \\int_{-1}^{1} I_b(x, \\mu) \\mu d\\mu \\right) = \\kappa_b \\left[ B_b(T_g) \\int_{-1}^{1} d\\mu - \\int_{-1}^{1} I_b(x,\\mu) d\\mu \\right]\n$$\n$$\n\\frac{1}{2\\pi} \\frac{dq_{r,b}}{dx} = \\kappa_b [2 B_b(T_g) - 2 J_b(x)] \\implies \\frac{dq_{r,b}}{dx} = 4\\pi \\kappa_b [B_b(T_g) - J_b(x)]\n$$\n\n取谱带RTE的一阶矩（乘以 $\\mu$ 并对 $\\mu \\in [-1, 1]$ 积分）：\n$$\n\\frac{d}{dx} \\left( \\int_{-1}^{1} I_b(x, \\mu) \\mu^2 d\\mu \\right) = \\kappa_b \\left[ B_b(T_g) \\int_{-1}^{1} \\mu d\\mu - \\int_{-1}^{1} I_b(x, \\mu) \\mu d\\mu \\right]\n$$\n右侧第一项为零。这得到：\n$$\n\\frac{d}{dx} \\left( 2\\pi \\int_{-1}^{1} I_b(x, \\mu) \\mu^2 d\\mu \\right) = - \\kappa_b q_{r,b}(x)\n$$\n\nP1近似通过假设辐射亮度为线性各向异性形式来闭合此系统：$I_b(x, \\mu) \\approx J_b(x) + \\frac{3}{4\\pi} q_{r,b}(x) \\mu$。一阶矩方程中的积分变为：\n$$\n2\\pi \\int_{-1}^{1} \\left( J_b(x) + \\frac{3}{4\\pi} q_{r,b}(x) \\mu \\right) \\mu^2 d\\mu = 2\\pi J_b(x) \\int_{-1}^{1} \\mu^2 d\\mu = \\frac{4\\pi}{3} J_b(x)\n$$\n这就是 Eddington 近似。将其代入一阶矩方程，得到辐射的 Fick 定律：\n$$\n\\frac{d}{dx} \\left( \\frac{4\\pi}{3} J_b(x) \\right) = - \\kappa_b q_{r,b}(x) \\implies q_{r,b}(x) = -\\frac{4\\pi}{3\\kappa_b} \\frac{dJ_b}{dx}\n$$\n项 $D_b = 1/(3\\kappa_b)$ 是辐射扩散系数。\n\n将 $q_{r,b}(x)$ 的表达式代入零阶矩方程，得到 $J_b(x)$ 的P1扩散方程：\n$$\n\\frac{d}{dx} \\left( -\\frac{4\\pi}{3\\kappa_b} \\frac{dJ_b}{dx} \\right) = 4\\pi \\kappa_b [B_b(T_g) - J_b(x)]\n$$\n对于常数 $\\kappa_b$，这简化为一个常系数二阶常微分方程：\n$$\n\\frac{d^2J_b}{dx^2} - 3\\kappa_b^2 J_b(x) = -3\\kappa_b^2 B_b(T_g)\n$$\n\n**2. Marshak 边界条件的推导**\n\n对于温度为 $T_w$ 的漫射黑体壁，出射辐射亮度为 $I_b^+ = B_b(T_w)$。Marshak 边界条件使从介质到壁面的半球通量等于从壁面到介质的半球通量。\n在 $x=0$ 处，从介质到壁面的通量（入射通量，$\\mu  0$）为：\n$$\nq_{b}^{-}(0) = 2\\pi \\int_{-1}^{0} I_b(0, \\mu) |\\mu| d\\mu = 2\\pi \\int_{-1}^{0} \\left( J_b(0) + \\frac{3}{4\\pi} q_{r,b}(0) \\mu \\right) (-\\mu) d\\mu = \\pi J_b(0) - \\frac{1}{2} q_{r,b}(0)\n$$\n从温度为 $T_{w,0}$ 的黑体壁发出的通量为 $q_{b}^{+}(0) = \\pi B_b(T_{w,0})$。介质中的净通量为 $q_{r,b}(0) = q_{b}^{+}(0) - q_{b}^{-}(0)$。\n$$\nq_{r,b}(0) = \\pi B_b(T_{w,0}) - \\left( \\pi J_b(0) - \\frac{1}{2} q_{r,b}(0) \\right) \\implies \\frac{1}{2} q_{r,b}(0) = \\pi [B_b(T_{w,0}) - J_b(0)]\n$$\n代入 $q_{r,b}(0) = -\\frac{4\\pi}{3\\kappa_b} \\frac{dJ_b}{dx}|_{x=0}$ 得到 $x=0$ 处的边界条件：\n$$\nJ_b(0) - \\frac{2}{3\\kappa_b} \\frac{dJ_b}{dx}\\bigg|_{x=0} = B_b(T_{w,0})\n$$\n在 $x=L$ 处进行类似推导（其中外法线方向为 $+x$ 方向）得到：\n$$\nJ_b(L) + \\frac{2}{3\\kappa_b} \\frac{dJ_b}{dx}\\bigg|_{x=L} = B_b(T_{w,L})\n$$\n\n**3. 边值问题的解析解**\n\nODE $J_b'' - (3\\kappa_b^2) J_b = -3\\kappa_b^2 B_b(T_g)$ 的通解是一个特解 $J_{b,p}(x) = B_b(T_g)$ 和齐次解 $J_{b,h}(x) = C_1 e^{\\lambda_b x} + C_2 e^{-\\lambda_b x}$ 的和，其中 $\\lambda_b = \\sqrt{3}\\kappa_b$。\n完整解为 $J_b(x) = C_1 e^{\\lambda_b x} + C_2 e^{-\\lambda_b x} + B_b(T_g)$。其导数为 $\\frac{dJ_b}{dx} = \\lambda_b(C_1 e^{\\lambda_b x} - C_2 e^{-\\lambda_b x})$。\n\n应用边界条件求常数 $C_1$ 和 $C_2$：\n令 $\\gamma = \\frac{2}{3\\kappa_b}\\lambda_b = \\frac{2}{\\sqrt{3}}$，这是一个与谱带属性无关的常数。\n在 $x=0$ 处： $C_1(1-\\gamma) + C_2(1+\\gamma) = B_b(T_{w,0}) - B_b(T_g)$\n在 $x=L$ 处： $C_1 e^{\\lambda_b L}(1+\\gamma) + C_2 e^{-\\lambda_b L}(1-\\gamma) = B_b(T_{w,L}) - B_b(T_g)$\n\n这是一个关于 $C_1$ 和 $C_2$ 的 $2 \\times 2$ 线性系统。我们只需要 $J_b(0) = C_1 + C_2 + B_b(T_g)$ 来计算壁面热通量。通过对该系统求解 $C_1+C_2$ 可得：\n令 $S_{w0} = B_b(T_{w,0}) - B_b(T_g)$ 和 $S_{wL} = B_b(T_{w,L}) - B_b(T_g)$。\n$$\nC_1 + C_2 = \\frac{ S_{w0} [ (1-\\gamma)e^{-\\lambda_b L} - (1+\\gamma)e^{\\lambda_b L} ] - 2\\gamma S_{wL} }{ (1-\\gamma)^2 e^{-\\lambda_b L} - (1+\\gamma)^2 e^{\\lambda_b L} }\n$$\n因此，$J_b(0)$ 完全确定。\n\n**4. 壁面热通量计算**\n\n问题将进入左壁的谱带 $b$ 的净辐射热通量定义为 $q_{w,0}^{(b)} = 2\\pi\\left(J_b(0) - B_b(T_{w,0})\\right)$。这个定义与物理一致。在 $x=0$ 处*介质中*的通量是 $q_{r,b}(0)$。*进入壁面*的通量是 $q_{w,0}^{(b)}=-q_{r,b}(0)$。根据边界条件的推导，$q_{r,b}(0) = 2\\pi[B_b(T_{w,0}) - J_b(0)]$。因此，$q_{w,0}^{(b)} = -q_{r,b}(0) = 2\\pi[J_b(0) - B_b(T_{w,0})]$，与提供的公式相符。\n\n进入壁面的总热通量是 WSGG 模型中所有谱带的总和：\n$$\nq_{w,0} = \\sum_{b=1}^{N_b} q_{w,0}^{(b)}\n$$\n完整的算法包括为每个指定情况计算此总通量，首先需要找到每个谱带的 $J_b(0)$。对于等温情况，$T_g=T_{w,0}=T_{w,L}$，这意味着 $S_{w0}=S_{wL}=0$，导致 $C_1=C_2=0$ 且 $J_b(0)=B_b(T_g)$。在此极限下，热通量 $q_{w,0}$ 正确地为零。对于近透明情况（$\\kappa_b \\to 0$），解应趋近于两个平行黑体板之间的通量，$q_{w,0} = \\sigma (T_{w,L}^4 - T_{w,0}^4)$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a multi-band P1 approximation for radiative transfer in a 1D slab\n    and evaluates the sensitivity of wall heat flux to spectral band discretization.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    L = 1.0  # Slab thickness, m\n    T_g_base = 1800.0  # Gas temperature, K\n    T_w0_base = 500.0  # Left wall temperature, K\n    T_wL_base = 800.0  # Right wall temperature, K\n    sigma = 5.670374419e-8  # Stefan-Boltzmann constant, W m^-2 K^-4\n\n    # --- Band-Selection Sets ---\n    C1 = {\n        'w': np.array([1.0]),\n        'k': np.array([0.4])\n    }\n    C3 = {\n        'w': np.array([0.5, 0.35, 0.15]),\n        'k': np.array([0.1, 0.8, 2.0])\n    }\n    C5 = {\n        'w': np.array([0.35, 0.25, 0.20, 0.12, 0.08]),\n        'k': np.array([0.05, 0.2, 0.7, 1.5, 3.0])\n    }\n    C5_trans = {\n        'w': C5['w'],\n        'k': C5['k'] * 1e-3\n    }\n\n    def calculate_wall_flux(band_set, T_g, T_w0, T_wL):\n        \"\"\"\n        Calculates the total left-wall heat flux for a given set of parameters.\n        \"\"\"\n        total_q_w0 = 0.0\n        pi = np.pi\n        gamma = 2.0 / np.sqrt(3.0)\n\n        for w_b, kappa_b in zip(band_set['w'], band_set['k']):\n            # Ensure absorption coefficient is positive\n            if kappa_b == 0:\n                # In the transparent limit, the gas does not contribute to flux\n                # The wall-to-wall exchange is handled by summing over bands\n                # This logic assumes the problem statement's hint to use a floor\n                # but continues with the formula, which is stable for small kappa_b.\n                pass\n\n            # Blackbody intensity fractions for the band\n            B_b_g = w_b * sigma * T_g**4 / pi\n            B_b_w0 = w_b * sigma * T_w0**4 / pi\n            B_b_wL = w_b * sigma * T_wL**4 / pi\n\n            # Source terms for the ODE solution\n            S_w0 = B_b_w0 - B_b_g\n            S_wL = B_b_wL - B_b_g\n\n            # If isothermal, flux is zero, skip complex calculation\n            if S_w0 == 0.0 and S_wL == 0.0:\n                total_q_w0 += 0.0\n                continue\n            \n            # Solution constants\n            lambda_b = np.sqrt(3.0) * kappa_b\n            \n            exp_plus = np.exp(lambda_b * L)\n            exp_minus = np.exp(-lambda_b * L)\n\n            # Denominator of the solution for coefficients C1, C2\n            denom = (1.0 - gamma)**2 * exp_minus - (1.0 + gamma)**2 * exp_plus\n\n            # Numerator for the sum C1 + C2\n            c1_plus_c2_num = S_w0 * ((1.0 - gamma) * exp_minus - (1.0 + gamma) * exp_plus) \\\n                             - 2.0 * gamma * S_wL\n\n            c1_plus_c2 = c1_plus_c2_num / denom\n\n            # Mean intensity at the left wall (x=0)\n            J_b_0 = c1_plus_c2 + B_b_g\n            \n            # Net radiative heat flux into the wall for the band\n            q_b_w0 = 2.0 * pi * (J_b_0 - B_b_w0)\n            \n            total_q_w0 += q_b_w0\n            \n        return total_q_w0\n\n    # --- Calculations for all cases ---\n    # Case A: Coarse set C1\n    q_c1 = calculate_wall_flux(C1, T_g_base, T_w0_base, T_wL_base)\n    # Case B: Medium set C3\n    q_c3 = calculate_wall_flux(C3, T_g_base, T_w0_base, T_wL_base)\n    # Case C: Fine set C5\n    q_c5 = calculate_wall_flux(C5, T_g_base, T_w0_base, T_wL_base)\n\n    # Sensitivity metrics\n    delta_c1 = (q_c1 - q_c5) / q_c5 if q_c5 != 0 else 0.0\n    delta_c3 = (q_c3 - q_c5) / q_c5 if q_c5 != 0 else 0.0\n\n    # Case D: Near-transparent fine set\n    q_trans = calculate_wall_flux(C5_trans, T_g_base, T_w0_base, T_wL_base)\n\n    # Case E: Isothermal boundaries\n    q_iso = calculate_wall_flux(C5, T_g_base, T_g_base, T_g_base)\n\n    # --- Assemble and print results ---\n    results = [q_c1, q_c3, q_c5, delta_c1, delta_c3, q_trans, q_iso]\n    \n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}