## 引言
在内燃机、燃气轮机和工业锅炉等高温工程系统中，热辐射是至关重要的传热模式，它深刻影响着系统的效率、稳定性和污染物生成。然而，描述辐射传递过程的物理基础——辐射传递方程（RTE）——是一个复杂的积分-[微分](@entry_id:158422)方程，在包含非均匀气体和颗粒（如烟尘）的复杂[三维几何](@entry_id:176328)中，对其进行精确求解是一项巨大的计算挑战。传统数值方法在处理强烈的方[向性](@entry_id:144651)和光谱依赖性时常面临困难，这构成了辐射建模领域的一大知识鸿沟。

光子蒙特卡罗（Photon [Monte Carlo](@entry_id:144354), PMC）方法为应对这一挑战提供了强大而灵活的解决方案。它抛弃了对RTE的直接离散化，转而从第一性原理出发，通过模拟海量“[光子包](@entry_id:753418)”的随机生命历程来统计性地重构[辐射场](@entry_id:164265)。这种拉格朗日视角使其能够自然地处理任意复杂的几何结构和介质特性。

本文将系统性地引导读者深入理解PMC方法。在第一部分“原理和机制”中，我们将建立从确定性的RTE到概率性光子追踪的桥梁，详细阐述发射、传播、碰撞和边界交互的模拟细节。接下来，在“应用与跨学科联系”部分，我们将探讨该方法在计算燃烧学中的高级应用，如[湍流-辐射相互作用](@entry_id:1133488)和光谱建模，并展示其思想如何延伸至医学物理和核工程等多个领域。最后，通过“动手实践”部分，读者将有机会将理论知识应用于具体的编码练习，从而真正掌握这一前沿数值工具。

## 原理和机制

光子蒙特卡罗（Photon Monte Carlo, PMC）方法是一种强大的数值技术，用于求解参与性介质中的辐射传递方程（Radiative Transfer Equation, RTE）。与传统的基于离散化的方法（如离散坐标法或[有限体积法](@entry_id:141374)）不同，PMC 方法采用[拉格朗日视角](@entry_id:265471)，通过模拟大量离散能量包（即“[光子包](@entry_id:753418)”）在介质中从发射到吸收或逃逸的随机生命历程，来统计性地重构[辐射场](@entry_id:164265)。本章将从辐射传递的基本物理原理出发，系统地阐述 PMC 方法的核心机制，包括如何将确定性的 RTE 转化为一个等效的概率过程，以及如何在计算中处理复杂的物理现象，如[非均匀介质](@entry_id:750241)、光谱依赖性和边界相互作用。

### 辐射传递方程：物理基础

所有辐射传递分析的基石是辐射传递方程（RTE），它描述了[辐射强度](@entry_id:150179)沿特定路径的变化。**光[谱辐射强度](@entry_id:148916)** $I(\mathbf{x}, \hat{s}, \nu)$ 是一个基本量，定义为在位置 $\mathbf{x}$、沿方向 $\hat{s}$、单位频率间隔内，每单位时间、每单位[立体角](@entry_id:154756)、通过单位垂直面积的辐射能量。RTE 本质上是沿着一条射线对辐射能量进行的[微分](@entry_id:158422)平衡。

对于一个[稳态](@entry_id:139253)、不运动的参与性介质（例如燃烧室中的高温气体和颗粒混合物），光[谱辐射强度](@entry_id:148916)的变化由四个基本物理过程决定：沿路径的自由传播、介质的吸收、介质的发射以及介质的散射。我们可以通过分析一个沿方向 $\hat{s}$ 的[微分控制](@entry_id:270911)体来构建完整的 RTE。

1.  **流移项（Streaming Term）**：在没有与介质相互作用的情况下，[辐射强度](@entry_id:150179)仅因其在空间中的“流动”或传输而改变。这个变化由[方向导数](@entry_id:189133) $\hat{s} \cdot \nabla I(\mathbf{x}, \hat{s}, \nu)$ 描述。

2.  **衰减项（Extinction Term）**：当辐射穿过介质时，其强度会因与介质的相互作用而减弱。这种减弱，即**衰减**，由两种机制引起：
    *   **吸收（Absorption）**：辐射能量被介质吸收并转化为内能。吸收造成的强度损失与强度本身成正比，比例系数为**光谱吸收系数** $\kappa_\nu$。损失项为 $-\kappa_\nu I(\mathbf{x}, \hat{s}, \nu)$。
    *   **外散射（Out-scattering）**：辐射从原始方向 $\hat{s}$ 被散射到其他方向，导致该方向上的强度损失。该损失与强度成正比，比例系数为**光谱[散射系数](@entry_id:1131287)** $\sigma_{s, \nu}$。损失项为 $-\sigma_{s, \nu} I(\mathbf{x}, \hat{s}, \nu)$。
    这两种损失机制的总和构成了衰减。因此，总衰减项为 $-(\kappa_\nu + \sigma_{s, \nu}) I(\mathbf{x}, \hat{s}, \nu) = -\beta_\nu I(\mathbf{x}, \hat{s}, \nu)$，其中 $\beta_\nu = \kappa_\nu + \sigma_{s, \nu}$ 被定义为**光谱[衰减系数](@entry_id:920164)**。

3.  **增益项（Source/Gain Term）**：辐射强度也可以通过两种机制得到增强：
    *   **热发射（Thermal Emission）**：处于**[局部热力学平衡](@entry_id:147993)（Local Thermodynamic Equilibrium, LTE）**状态的介质会自发地发射热辐射。根据[基尔霍夫热辐射定律](@entry_id:144588)，介质的[光谱发射率](@entry_id:1132091)等于其光谱[吸收率](@entry_id:144520)（即 $\kappa_\nu$）。因此，热发射源项由 $\kappa_\nu B_\nu(T)$ 给出，其中 $B_\nu(T)$ 是在局部温度 $T(\mathbf{x})$ 下的**普朗克黑体辐射函数**。该发射是各向同性的，不依赖于入射[辐射强度](@entry_id:150179)。
    *   **内散射（In-scattering）**：从其他方向 $\hat{s}'$ 传入的辐射可以被散射到当前方向 $\hat{s}$。这个增益项是通过对所有入射方向的辐射强度进行积分得到的，并由[散射系数](@entry_id:1131287)和**[散射相函数](@entry_id:1131288)** $\Phi_\nu(\hat{s}', \hat{s})$ 加权。内散射源项为 $\sigma_{s, \nu} \int_{4\pi} \Phi_\nu(\hat{s}', \hat{s}) I(\mathbf{x}, \hat{s}', \nu) \, d\Omega'$。[相函数](@entry_id:1129581) $\Phi_\nu(\hat{s}', \hat{s})$ 描述了辐射从方向 $\hat{s}'$ 散射到方向 $\hat{s}$ 的概率分布。

将这些项组合起来，我们得到[稳态](@entry_id:139253)光谱辐射传递方程 ：
$$
\hat{s} \cdot \nabla I(\mathbf{x}, \hat{s}, \nu) = \kappa_\nu B_\nu(T) - \beta_\nu I(\mathbf{x}, \hat{s}, \nu) + \sigma_{s, \nu} \int_{4\pi} \Phi_\nu(\hat{s}', \hat{s}) I(\mathbf{x}, \hat{s}', \nu) \, d\Omega'
$$
这个方程是一个复杂的积分-[微分](@entry_id:158422)方程，对其进行解析求解通常是不可能的，尤其是在具有复杂几何、非均匀属性和光谱依赖性的燃烧系统中。这正是 PMC 方法发挥作用的地方。

### 概率解释：[光子包](@entry_id:753418)的生命历程

PMC 方法的核心思想是将确定性的 RTE 重新解释为一个概率过程。我们不再直接求解强度场 $I(\mathbf{x}, \hat{s}, \nu)$，而是模拟大量携带能量权重 $w$ 的离散“[光子包](@entry_id:753418)”的随机路径。每个[光子包](@entry_id:753418)的状态由其位置 $\mathbf{x}$、方向 $\hat{s}$、频率 $\nu$ 和能量权重 $w$ 描述。[光子包](@entry_id:753418)在其生命周期中的每一步都遵循与 RTE 各项相对应的概率规则。

#### 发射：[光子包](@entry_id:753418)的诞生

RTE 中的发射项 $\kappa_\nu B_\nu(T)$ 是辐射的来源。在 PMC 中，这对应于在计算域内创建新的[光子包](@entry_id:753418)。

一个体积微元 $dV$ 在单位时间内发射的总光谱功率是通过对所有方向（$4\pi$ 球形[立体角](@entry_id:154756)）积分定向发射系数 $j_\nu = \kappa_\nu B_\nu(T)$ 得到的。由于在 LTE 条件下发射是各向同性的，$j_\nu$ 与方向无关，因此单位体积的[光谱发射功率](@entry_id:148131)为 ：
$$
e_\nu = \int_{4\pi} j_\nu \, d\Omega = j_\nu \int_{4\pi} d\Omega = 4\pi \kappa_\nu B_\nu(T)
$$
这个 $4\pi$ 因子是连接定向物理量（如强度和发射系数）与体积物理量（如体积发射功率）的关键。在 PMC 模拟中，[光子包](@entry_id:753418)的初始位置、方向和频率是根据整个计算域的总体积发射功率 $ \int e_\nu \, dV \, d\nu $ 进行采样的。每个[光子包](@entry_id:753418)被赋予一个初始能量权重 $w_0$，该权重代表了从总发射功率中分配出来的一部分能量。

#### 自由程与相互作用：生命与遭遇

[光子包](@entry_id:753418)一旦发射，就会沿直线传播，直到与介质发生相互作用。两次相互作用之间行进的距离称为**自由程**。

自由程的统计规律由**衰减系数** $\beta_\nu$ 决定，$\beta_\nu$ 可被视为单位路径长度内发生相互作用的概率。对于**均匀介质**（$\beta_\nu$ 为常数），[光子包](@entry_id:753418)行进距离 $s$ 而不发生相互作用的生存概率遵循[比尔-朗伯定律](@entry_id:192870)，为 $\exp(-\beta_\nu s)$。这意味着自由程 $s$ 服从[指数分布](@entry_id:273894)，其[概率密度函数](@entry_id:140610)为 $p(s) = \beta_\nu \exp(-\beta_\nu s)$。我们可以通过[逆变换采样法](@entry_id:142402)生成一个自由程样本 ：
$$
s = -\frac{\ln(\xi)}{\beta_\nu}
$$
其中 $\xi$ 是一个在 $(0, 1]$ 区间内均匀分布的随机数。

然而，在燃烧等实际应用中，介质通常是**非均匀的**，即吸收和散射系数随空间位置 $\mathbf{x}$ 变化，$\beta_\nu = \beta_\nu(\mathbf{x})$。在这种情况下，自由程的概率分布不再是简单的指数分布。生存概率变为 $\exp(-\tau(s))$，其中 $\tau(s)$ 是沿路径累积的**光学厚度** ：
$$
\tau(s) = \int_0^s \beta_\nu(\mathbf{x}(s')) \, ds'
$$
其中 $\mathbf{x}(s')$ 是沿光子路径的位置。在 PMC 中，我们首先采样一个标准化的[光学厚度](@entry_id:150612) $\tau = -\ln(\xi)$，然后通过求解上述积分方程来确定对应的物理距离 $s$。由于 $\beta_\nu(\mathbf{x})$ 的复杂函数形式（例如，来自 CFD 模拟的离散数据），这个积分方程通常没有解析解，必须使用数值方法求解。常用的无偏采样技术包括**零碰撞法（delta-tracking）**或分段常数射线[步进法](@entry_id:203249)。

#### 碰撞事件：吸收或散射？

当[光子包](@entry_id:753418)行进了其自由程后，它在碰撞点与介质发生相互作用。相互作用的类型可以是吸收或散射。选择哪种类型的概率由各过程的相对速率决定。**[单次散射反照率](@entry_id:1131707)** $\omega_\nu$ 定义为散射事件发生的概率：
$$
\omega_\nu = \frac{\sigma_{s, \nu}}{\beta_\nu} = \frac{\sigma_{s, \nu}}{\kappa_\nu + \sigma_{s, \nu}}
$$
相应地，吸收事件发生的概率为 $1 - \omega_\nu = \kappa_\nu / \beta_\nu$ 。PMC 中有两种主要算法来处理这一选择：

1.  **模[拟蒙特卡罗](@entry_id:137172)（Analog Monte Carlo）**：这是一种直接模拟物理过程的方法。在每次碰撞时，生成一个随机数 $\xi \in [0, 1)$。如果 $\xi  \omega_\nu$，则事件被判定为散射。[光子包](@entry_id:753418)的能量权重 $w$ 保持不变，但其传播方向会改变。如果 $\xi \ge \omega_\nu$，则事件为吸收。[光子包](@entry_id:753418)的全部能量权重 $w$ 被沉积到碰撞点的介质中（计入局部辐射源项），并且该[光子包](@entry_id:753418)的追踪被终止  。

2.  **非模拟/隐式捕获（Non-analog / Implicit Capture）**：也称为生存加权。这是一种[方差缩减技术](@entry_id:141433)。在这种方案中，[光子包](@entry_id:753418)在每次碰撞时都被确定性地视为散射。为了弥补没有随机选择吸收，[光子包](@entry_id:753418)的权重会确定性地减少，以说明本应被吸收的能量部分。新权重 $w'$ 等于旧权重 $w$ 乘以散射概率 $\omega_\nu$：
    $$
    w' = w \cdot \omega_\nu = w \frac{\sigma_{s, \nu}}{\kappa_\nu + \sigma_{s, \nu}}
    $$
    同时，等于 $(1-\omega_\nu)w$ 的能量被沉积到介质中。[光子包](@entry_id:753418)以减小的权重继续传播。这种方法避免了[光子包](@entry_id:753418)的随机终止，从而减少了统计噪声，但代价是需要追踪大量低权重的[光子包](@entry_id:753418)，可能需要使用如“俄罗斯轮盘赌”等技术来终止权重过低的[光子包](@entry_id:753418)  。

#### 散射：方向的改变

如果碰撞事件是散射，[光子包](@entry_id:753418)的能量（在[弹性散射](@entry_id:152152)中）得以保留，但其传播方向会根据**[散射相函数](@entry_id:1131288)** $\Phi(\hat{s}', \hat{s})$ 给出的概率分布进行改变。该函数必须被归一化，使得在所有方向上的积分为 1，即 $\int_{4\pi} \Phi \, d\Omega = 1$。在燃烧应用中，常用的[相函数](@entry_id:1129581)包括 ：

*   **各向同性散射（Isotropic Scattering）**：散射到所有方向的概率均等。其相函数为常数：$\Phi(\mu) = \frac{1}{4\pi}$，其中 $\mu = \hat{s}' \cdot \hat{s}$ 是[散射角](@entry_id:171822)的余弦。
*   **瑞利散射（Rayleigh Scattering）**：适用于尺寸远小于辐射波长的粒子（如气体分子）。其归一化形式为 $\Phi(\mu) = \frac{3}{16\pi}(1 + \mu^2)$。
*   **[Henyey-Greenstein](@entry_id:750228) (HG) 相函数**：这是一个灵活的经验模型，广泛用于描述烟尘等大颗粒的前向或后向散射特性。其形式为：
    $$
    \Phi(\mu) = \frac{1 - g^2}{4\pi(1 + g^2 - 2g\mu)^{3/2}}
    $$
    其中 $g$ 是**不[对称因子](@entry_id:274828)**（$-1  g  1$），表示平均散射方向。$g > 0$ 表示前向散射占优（燃烧中的烟尘通常如此），$g  0$ 表示后向散射占优，$g = 0$ 则退化为各向同性散射。在 PMC 中，新的散射方向通过对相应[相函数](@entry_id:1129581)的[累积分布函数](@entry_id:143135)进行[逆变换采样](@entry_id:139050)来确定。

### 模拟真实世界的复杂性

为了将 PMC 方法应用于实际的燃烧系统，必须对介质的光谱特性和几何边界进行建模。

#### 燃烧介质的辐射特性

燃烧产物通常是气体（如 $\text{H}_2\text{O}$ 和 $\text{CO}_2$）和颗粒（如烟尘）的混合物。假设各组分独立作用，混合物的宏观辐射系数是各组分系数的简单加和 。例如，混合物的总吸收系数为：
$$
\kappa_\nu = \kappa_{\nu, \text{gas}} + \kappa_{\nu, \text{soot}}
$$
一个关键的复杂性在于这些系数的**光谱依赖性**。烟尘的[吸收系数](@entry_id:156541)在热辐射主要波段内通常变化平缓，可近似为“灰体”或具有简单的波长依赖关系。相比之下，气体分子的[吸收光谱](@entry_id:144611)由数千条离散的吸收线组成，导致其[吸收系数](@entry_id:156541)随波长发生剧烈变化，表现出强烈的“非灰体”行为。

#### 光谱模型

直接在每个波长上求解 RTE（即**逐线（Line-by-Line, LBL）**计算）在计算上是极其昂贵的，对于工程规模的 PMC 模拟通常不可行。因此，需要采用光谱模型来以可接受的计算成本近似光谱效应。这些模型构成了一个精度与成本的层级体系 ：

*   **灰体模型（Gray Model）**：最简单的模型，假设吸收系数 $\kappa_\lambda$ 与波长无关。仅在某些特定条件下（如光学厚或烟尘主导的系统）才能给出合理的总体传热结果 。

*   **[加权灰气体总和模型](@entry_id:1134141)（WSGG）**：将[非灰气体](@entry_id:1128788)的辐射特性近似为若干个具有不同[吸收系数](@entry_id:156541)和能量权重的虚构灰气体的总和。该模型在计算上高效，并且对于压力较高、谱线重叠严重的工业炉膛等场景非常有效。

*   **[宽带模型](@entry_id:150224)（Wideband Models）**：将光[谱划分](@entry_id:755180)为少数几个对应于主要分子振转带的宽波段。每个波段的辐射特性由经验关系式确定。它在计算成本和精度之间取得了平衡。

*   **[窄带模型](@entry_id:147937)（Narrow-Band Models）**：将光[谱划分](@entry_id:755180)为数百或数千个窄波段（通常宽度为 $5-25 \, \text{cm}^{-1}$）。在每个波段内，使用[统计模型](@entry_id:165873)（如 Goody 或 Malkmus 模型）和 k 分布方法来处理谱线结构，从而比[宽带模型](@entry_id:150224)和 WSGG 模型提供更高的精度。

*   **逐线模型（LBL）**：使用高分辨率光谱数据库（如 HITEMP）直接计算每个波长下的[吸收系数](@entry_id:156541)。它是最精确的方法，通常用作验证其他模型的基准，但其计算成本最高。

在 PMC 中，非灰体模型通常通过在[光子包](@entry_id:753418)发射时根据每个波段的黑体能量分数来采样其初始波段（或波长），然后使用该波段对应的[吸收系数](@entry_id:156541)（或 k 分布）来追踪其后续的相互作用。

#### 边界条件：[光子包](@entry_id:753418)的终点

当[光子包](@entry_id:753418)的路径与计算域的边界（如壁面）相交时，其生命历程可能终止或发生改变。这对应于 RTE 的边界条件。PMC 中常见的边界条件实现如下 ：

*   **真空或开放边界**：代表能量可以自由逃逸的出口。当[光子包](@entry_id:753418)到达此边界时，它被认为已逃离系统，其追踪被终止。其能量权重被计入[辐射损失](@entry_id:1130499)。

*   **黑体壁面**：一个理想的吸收体和发射体（吸收率 $\alpha_\lambda=1$，发射率 $\epsilon_\lambda=1$）。任何撞击到黑[体壁](@entry_id:272571)面的[光子包](@entry_id:753418)都会被完全吸收，其路径终止。壁面的热发射则通过从壁面位置独立地发射一组新的[光子包](@entry_id:753418)来模拟，其方向遵循[朗伯余弦定律](@entry_id:155661)。

*   **灰体漫反射壁面**：一个更真实的[壁面模型](@entry_id:756612)，具有与波长无关的发射率 $\epsilon$ 和[反射率](@entry_id:172768) $\rho = 1-\epsilon$。当[光子包](@entry_id:753418)撞击壁面时，使用“俄罗斯轮盘赌”决定其命运：以概率 $\epsilon$ 被吸收（路径终止），或以概率 $\rho$ 被反射。如果被反射，[光子包](@entry_id:753418)的权重保持不变，但其新的传播方向需从一个余弦加权的半球分布中采样，以模拟[漫反射](@entry_id:173213)。

*   **镜面反射壁面**：模拟光学光滑的表面，如金属插件。反射是确定性的，遵循[几何反射](@entry_id:635628)定律：反射角等于[入射角](@entry_id:192705)。[光子包](@entry_id:753418)的权重在反射后会乘以表面的[镜面反射](@entry_id:270785)率 $R_\lambda(\theta_i)$，该[反射率](@entry_id:172768)通常取决于材料、波长和入射角。被吸收的能量部分 $(1 - R_\lambda(\theta_i))w$ 则被计入壁面。

通过精确地模拟这些基本过程——发射、传播、碰撞和边界相互作用——光子蒙特卡罗方法能够以高保真度捕捉复杂燃烧环境中的[辐射传热](@entry_id:149271)现象，为工程设计和科学研究提供关键的洞察。