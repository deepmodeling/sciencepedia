{
    "hands_on_practices": [
        {
            "introduction": "Understanding the coupling of radiation with combustion begins with mastering its governing equation. This first practice guides you through the derivation of the formal solution to the Radiative Transfer Equation (RTE) for an idealized, one-dimensional system. By starting from first principles in a non-scattering, gray medium, you will build a foundational understanding of how incident radiation is attenuated and how the medium's own thermal emission contributes to the final intensity field.",
            "id": "4015145",
            "problem": "Consider a one-dimensional, plane-parallel, homogeneous combustion slab of thickness $L$ with constant temperature $T$ and uniform gray absorption coefficient $\\kappa$. The slab represents a participating medium produced by combustion (e.g., a soot-laden flame zone) in local thermodynamic equilibrium. There is no scattering. You are interested in the radiative intensity leaving the cold boundary of the slab. Let the coordinate $x$ run from the cold boundary at $x=0$ to the opposite boundary at $x=L$. For a ray that leaves the cold boundary at an angle $\\theta$ with respect to the slab normal (aligned with the $+x$ direction), define the direction cosine magnitude $\\mu = |\\cos\\theta| \\in (0,1]$. At the hot boundary $x=L$, the incoming boundary intensity directed toward the cold boundary along this ray is prescribed as $I_{\\text{in}}(\\mu)$ and is finite. Outside the cold boundary, the environment is non-emitting and does not contribute incoming radiation into the slab.\n\nStarting only from the conservation of radiative energy along a ray, the definition of the radiative transfer equation for a non-scattering medium, and Kirchhoff’s law of thermal radiation under local thermodynamic equilibrium, derive the formal solution for the emergent intensity at the cold boundary along the specified ray. Work in the spectrally averaged (gray) approximation, and use the frequency-integrated blackbody intensity per unit solid angle $B(T) = \\sigma T^{4}/\\pi$, where $\\sigma$ is the Stefan–Boltzmann constant. Express your final answer as a single closed-form analytic expression for the emergent intensity $I_{\\text{e}}(\\mu)$ in units of $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}$, as a function of $\\mu$, $\\kappa$, $L$, $T$, and $I_{\\text{in}}(\\mu)$. No numerical evaluation is required.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n-   **System**: A one-dimensional, plane-parallel, homogeneous combustion slab.\n-   **Thickness**: $L$.\n-   **Temperature**: Constant, $T$.\n-   **Absorption Coefficient**: Uniform and gray, $\\kappa$.\n-   **Thermodynamic State**: Local thermodynamic equilibrium (LTE).\n-   **Scattering**: No scattering.\n-   **Coordinate System**: $x$ points from the cold boundary at $x=0$ to the hot boundary at $x=L$. The slab normal is aligned with the $+x$ direction.\n-   **Ray Direction**: Defined by the direction cosine magnitude $\\mu = |\\cos\\theta| \\in (0,1]$, where $\\theta$ is the angle with respect to the $+x$ direction. The solution is for a ray leaving the cold boundary.\n-   **Boundary Condition at $x=L$**: The incoming intensity directed toward the cold boundary is a finite, prescribed function $I_{\\text{in}}(\\mu)$.\n-   **Boundary Condition at $x=0$**: The environment outside the slab is non-emitting and does not contribute incoming radiation.\n-   **Fundamental Principles**: The derivation must start from the conservation of radiative energy along a ray, the definition of the radiative transfer equation (RTE) for a non-scattering medium, and Kirchhoff’s law of thermal radiation under LTE.\n-   **Approximation**: Spectrally averaged (gray).\n-   **Blackbody Intensity**: The frequency-integrated blackbody intensity is given by $B(T) = \\frac{\\sigma T^{4}}{\\pi}$, where $\\sigma$ is the Stefan–Boltzmann constant.\n-   **Objective**: Derive the formal solution for the emergent intensity at the cold boundary, $I_{\\text{e}}(\\mu)$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a classic and fundamental exercise in radiative heat transfer. It is based on well-established physical principles: the radiative transfer equation, Kirchhoff's law, and the Stefan-Boltzmann law. The assumptions (1D, gray, homogeneous, non-scattering medium in LTE) are standard idealizations used to develop foundational understanding in this field. The problem is scientifically sound.\n-   **Well-Posed**: The problem provides all necessary information: the geometry ($L$), medium properties ($\\kappa$, $T$), and boundary conditions ($I_{\\text{in}}(\\mu)$ at $x=L$ and zero incoming radiation at $x=0$). The objective is clearly stated. A unique and meaningful solution for the emergent intensity exists.\n-   **Objective**: The problem is stated in precise, unambiguous, and objective language. All terms are standard in the field of thermal sciences.\n\n### Step 3: Verdict and Action\nThe problem statement is valid, scientifically grounded, well-posed, and objective. It contains no contradictions, ambiguities, or unsound premises. A solution will be derived as requested.\n\nThe derivation begins with the principle of conservation of radiative energy for a pencil of radiation of intensity $I$ traveling along a path $s$. The change in intensity, $dI$, over a differential path length $ds$ is the sum of gains from emission and losses from absorption.\n\nFor a non-scattering participating medium, the loss due to absorption is proportional to the local intensity $I$ and the absorption coefficient $\\kappa$, given by $-\\kappa I ds$. The gain due to emission, under the condition of local thermodynamic equilibrium (LTE), is described by Kirchhoff's law. The spectral emissivity is equal to the spectral absorptivity, and the emission source term is $\\kappa B(T) ds$, where $B(T)$ is the Planck function integrated over all frequencies, representing the blackbody intensity.\n\nCombining these terms gives the radiative transfer equation (RTE) in its differential form along the path $s$:\n$$\n\\frac{dI}{ds} = \\kappa B(T) - \\kappa I\n$$\nThe path length $ds$ is related to the spatial coordinate $x$ by the direction cosine, $dx = (\\cos\\theta) ds$. Let $\\theta$ be the angle between the ray's direction of propagation and the positive $x$-axis. The RTE can thus be written in terms of the spatial coordinate $x$:\n$$\n\\cos\\theta \\frac{dI}{dx} = \\kappa (B(T) - I)\n$$\nWe seek the intensity $I_{\\text{e}}(\\mu)$ that emerges at the cold boundary, $x=0$. This radiation must have originated either from within the slab or from the hot boundary at $x=L$. Therefore, the ray of interest is traveling from $x=L$ towards $x=0$. For such a ray, the direction of propagation is in the negative $x$-direction, which means the angle $\\theta$ is in the range $(\\pi/2, \\pi]$. Consequently, $\\cos\\theta$ is negative.\n\nThe problem defines the direction cosine magnitude as $\\mu = |\\cos\\theta|$. For the ray under consideration, we have $\\cos\\theta = -\\mu$, where $\\mu \\in (0, 1]$. Substituting this into the RTE gives:\n$$\n-\\mu \\frac{dI}{dx} = \\kappa (B(T) - I)\n$$\nRearranging for convenience yields:\n$$\n\\mu \\frac{dI}{dx} = \\kappa (I - B(T))\n$$\nThis is a first-order linear ordinary differential equation. To solve it, we can separate variables or use an integrating factor. Let's rewrite it as:\n$$\n\\frac{dI}{I - B(T)} = \\frac{\\kappa}{\\mu} dx\n$$\nSince the temperature $T$ is constant, the blackbody intensity $B(T)$ is also constant throughout the slab. We can integrate this equation along the ray's path from the hot boundary $x=L$ to the cold boundary $x=0$. The intensity at $x=L$ for this ray is the specified incoming intensity $I_{\\text{in}}(\\mu)$, and the intensity at $x=0$ is the emergent intensity $I_{\\text{e}}(\\mu)$ that we wish to find.\n$$\n\\int_{I_{\\text{in}}(\\mu)}^{I_{\\text{e}}(\\mu)} \\frac{dI}{I - B(T)} = \\int_{L}^{0} \\frac{\\kappa}{\\mu} dx\n$$\nEvaluating the integrals on both sides:\n$$\n\\left[ \\ln|I - B(T)| \\right]_{I_{\\text{in}}(\\mu)}^{I_{\\text{e}}(\\mu)} = \\frac{\\kappa}{\\mu} [x]_{L}^{0}\n$$\n$$\n\\ln|I_{\\text{e}}(\\mu) - B(T)| - \\ln|I_{\\text{in}}(\\mu) - B(T)| = \\frac{\\kappa}{\\mu} (0 - L) = -\\frac{\\kappa L}{\\mu}\n$$\n$$\n\\ln\\left(\\frac{|I_{\\text{e}}(\\mu) - B(T)|}{|I_{\\text{in}}(\\mu) - B(T)|}\\right) = -\\frac{\\kappa L}{\\mu}\n$$\nExponentiating both sides:\n$$\n\\frac{|I_{\\text{e}}(\\mu) - B(T)|}{|I_{\\text{in}}(\\mu) - B(T)|} = \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\nIn a purely absorbing-emitting medium, the intensity along any path will monotonically approach the blackbody intensity $B(T)$. Since the ray travels from $x=L$ to $x=0$, if $I_{\\text{in}}(\\mu) > B(T)$, the intensity will decrease towards $B(T)$, so $I_{\\text{e}}(\\mu) > B(T)$. If $I_{\\text{in}}(\\mu) < B(T)$, the intensity will increase towards $B(T)$, so $I_{\\text{e}}(\\mu) < B(T)$. In either case, the term $(I - B(T))$ does not change sign along the path. We can therefore remove the absolute value signs, provided we maintain the correct sign relationship.\n$$\nI_{\\text{e}}(\\mu) - B(T) = (I_{\\text{in}}(\\mu) - B(T)) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\nSolving for the emergent intensity $I_{\\text{e}}(\\mu)$:\n$$\nI_{\\text{e}}(\\mu) = B(T) + (I_{\\text{in}}(\\mu) - B(T)) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\n$$\nI_{\\text{e}}(\\mu) = B(T) + I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) - B(T) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\n$$\nI_{\\text{e}}(\\mu) = I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) + B(T) \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\n$$\nThis is the formal solution for the emergent intensity. The first term represents the incident radiation from the hot boundary, $I_{\\text{in}}(\\mu)$, attenuated by the optical thickness of the slab along the path, $\\kappa L/\\mu$. The second term represents the contribution from the thermal emission of the slab itself, which is the blackbody intensity $B(T)$ multiplied by the directional emissivity of the slab, $\\epsilon_\\mu = (1 - \\exp(-\\kappa L/\\mu))$.\n\nFinally, we substitute the given expression for the gray blackbody intensity, $B(T) = \\frac{\\sigma T^4}{\\pi}$:\n$$\nI_{\\text{e}}(\\mu) = I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) + \\frac{\\sigma T^{4}}{\\pi} \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\n$$\nThis is the final closed-form analytic expression for the emergent intensity at the cold boundary.",
            "answer": "$$\\boxed{I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) + \\frac{\\sigma T^{4}}{\\pi} \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)}$$"
        },
        {
            "introduction": "The Radiative Transfer Equation requires an absorption coefficient, but for real combustion products like water vapor and carbon dioxide, this property is a complex function of wavelength. This computational practice challenges you to bridge the gap between detailed spectroscopy and practical engineering models by computing the Planck mean absorption coefficient, $\\kappa_{P}$. Through numerical integration, you will learn how to average the detailed spectral behavior of a gas mixture into a single effective property, a crucial step for simplifying radiation calculations in combustion simulations.",
            "id": "4015090",
            "problem": "Consider a one-dimensional, non-scattering, participating gas medium consisting of water vapor and carbon dioxide, treated as isothermal at temperature $T = 1800\\,\\text{K}$ and at spatially uniform pressure $p$. The mixture-averaged spectral absorption coefficient is modeled as the sum of species contributions weighted by their mole fractions. The Planck mean absorption coefficient $\\kappa_{P}$ of the mixture is defined by the blackbody intensity weighting over wavelength according to\n$$\n\\kappa_{P}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda},\n$$\nwhere $\\kappa_{\\lambda}$ is the mixture spectral absorption coefficient and $I_{\\lambda}^{b}(T)$ is the blackbody spectral intensity at temperature $T$. The blackbody spectral intensity per unit wavelength is given by Planck’s law, a fundamental law of thermal radiation:\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right),\n$$\nwith $h$ the Planck constant, $c$ the speed of light in vacuum, and $k_{B}$ the Boltzmann constant. Kirchhoff’s law of thermal radiation (for local thermodynamic equilibrium) ensures that emission and absorption are linked, justifying the use of $I_{\\lambda}^{b}(T)$ as the weighting function for defining $\\kappa_{P}$.\n\nAssume the following scientifically grounded parametric model for the mixture’s spectral absorption coefficient:\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\chi_{\\mathrm{H_2O}} \\, A_{\\mathrm{H_2O}}(T,p) \\, g_{\\mathrm{H_2O}}(\\lambda) \\;+\\; \\chi_{\\mathrm{CO_2}} \\, A_{\\mathrm{CO_2}}(T,p) \\, g_{\\mathrm{CO_2}}(\\lambda),\n$$\nwhere $\\chi_{\\mathrm{H_2O}}$ and $\\chi_{\\mathrm{CO_2}}$ are the mole fractions of water vapor and carbon dioxide, respectively, $A_{i}(T,p)$ are species amplitude functions with units of inverse length, and $g_{i}(\\lambda)$ are unitless spectral shape functions representing the principal infrared bands. The amplitude functions scale with pressure and temperature as\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s},\n$$\nwith $p_{0} = 101325\\,\\text{Pa}$, $T_{0} = 1800\\,\\text{K}$, $s = 0.5$, and species baseline coefficients $\\alpha_{\\mathrm{H_2O}} = 4.0\\,\\text{m}^{-1}$, $\\alpha_{\\mathrm{CO_2}} = 3.0\\,\\text{m}^{-1}$. The spectral shape functions are prescribed as sums of Gaussian bands:\n$$\ng_{\\mathrm{H_2O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\mathrm{H_2O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{H_2O})}_{j}}{\\sigma^{(\\mathrm{H_2O})}_{j}}\\right)^{2} \\right),\n$$\nwith centers $\\lambda^{(\\mathrm{H_2O})}_{j} \\in \\{1.4\\times 10^{-6},\\, 2.7\\times 10^{-6},\\, 6.3\\times 10^{-6}\\}\\,\\text{m}$, weights $w^{(\\mathrm{H_2O})}_{j} \\in \\{0.5,\\, 0.3,\\, 0.2\\}$, and widths $\\sigma^{(\\mathrm{H_2O})}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.5\\times 10^{-6},\\, 1.2\\times 10^{-6}\\}\\,\\text{m}$. Similarly,\n$$\ng_{\\mathrm{CO_2}}(\\lambda) = \\sum_{j=1}^{2} w^{(\\mathrm{CO_2})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{CO_2})}_{j}}{\\sigma^{(\\mathrm{CO_2})}_{j}}\\right)^{2} \\right),\n$$\nwith centers $\\lambda^{(\\mathrm{CO_2})}_{j} \\in \\{2.0\\times 10^{-6},\\, 4.3\\times 10^{-6}\\}\\,\\text{m}$, weights $w^{(\\mathrm{CO_2})}_{j} \\in \\{0.4,\\, 0.6\\}$, and widths $\\sigma^{(\\mathrm{CO_2})}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.8\\times 10^{-6}\\}\\,\\text{m}$. The wavelength integration domain must be taken as $\\lambda \\in [2\\times 10^{-7},\\, 2\\times 10^{-5}]\\,\\text{m}$ to cover the relevant thermal spectrum at $T = 1800\\,\\text{K}$.\n\nDefine the optical thickness as\n$$\n\\tau = \\kappa_{P} \\, L,\n$$\nwhere $L$ is the medium thickness. In the context of gray approximations, regimes with $\\tau$ of order unity indicate neither optically thin nor optically thick behavior; a practical criterion for assessing gray-model applicability (without scattering and with dominant emission-absorption coupling) is\n$$\n\\text{gray\\_ok} = \\begin{cases}\n\\text{true}, & \\text{if } 0.3 \\le \\tau \\le 3.0,\\\\\n\\text{false}, & \\text{otherwise}.\n\\end{cases}\n$$\n\nTasks:\n- Compute $\\kappa_{P}$ and $\\tau$ for each test case below, using the definitions and models above.\n- Express $\\kappa_{P}$ in $\\text{m}^{-1}$ and $\\tau$ as a dimensionless quantity, both rounded to six decimal places.\n- For each test case, also output $\\text{gray\\_ok}$ as either the lowercase string $\\,\\text{true}\\,$ or $\\,\\text{false}\\,$.\n- Your program must carry out the wavelength integrations numerically over the specified domain.\n\nTest Suite:\n1. Case $1$: $T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.10$, $\\chi_{\\mathrm{CO_2}} = 0.10$, $L = 2.0\\,\\text{m}$.\n2. Case $2$: $T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.00$, $\\chi_{\\mathrm{CO_2}} = 0.20$, $L = 1.0\\,\\text{m}$.\n3. Case $3$: $T = 1800\\,\\text{K}$, $p = 5.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.20$, $\\chi_{\\mathrm{CO_2}} = 0.10$, $L = 1.0\\,\\text{m}$.\n4. Case $4$ (edge case, transparent medium): $T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.00$, $\\chi_{\\mathrm{CO_2}} = 0.00$, $L = 1.0\\,\\text{m}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list of per-case results. Each per-case result must be a three-element list of the form $[\\kappa_{P}, \\tau, \\text{gray\\_ok}]$ with no spaces, where $\\kappa_{P}$ is in $\\text{m}^{-1}$, $\\tau$ is dimensionless, both rounded to six decimal places, and $\\text{gray\\_ok}$ is the lowercase string $\\,\\text{true}\\,$ or $\\,\\text{false}\\,$. The overall output must be a comma-separated list of these per-case lists, enclosed in square brackets. For example, the format is $[[0.123456,0.654321,true],[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The problem requires the calculation of the Planck mean absorption coefficient, $\\kappa_{P}$, for a gas mixture of water vapor and carbon dioxide at specified thermodynamic conditions. From this, the optical thickness $\\tau$ and a gray-model applicability criterion are to be determined for several test cases.\n\nThe Planck mean absorption coefficient $\\kappa_{P}$ is defined as the spectral absorption coefficient $\\kappa_{\\lambda}$ weighted by the blackbody spectral intensity $I_{\\lambda}^{b}(T)$ and normalized by the total blackbody intensity. The formula is:\n$$\n\\kappa_{P}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda}\n$$\nFor numerical computation, the infinite integration domain is replaced by the specified range $\\lambda \\in [2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$, which captures the vast majority of the blackbody emissive power at the given temperature of $T=1800\\,\\text{K}$. Let the numerator be $N$ and the denominator be $D$.\n$$\nN = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\n$$\nD = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\nThen, $\\kappa_{P} = N/D$. The blackbody spectral intensity $I_{\\lambda}^{b}(T)$ is given by Planck's law:\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\nThe constant prefactor $2 h c^{2}$ appears in both the numerator $N$ and the denominator $D$ integrals and can thus be canceled out. This is advantageous for numerical computation, as it avoids handling very large or very small numbers. We can therefore use a simplified weighting function proportional to $I_{\\lambda}^{b}(T)$:\n$$\nw(\\lambda, T) = \\frac{1}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\n\nThe mixture spectral absorption coefficient $\\kappa_{\\lambda}$ is modeled as a linear combination of contributions from each species:\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\chi_{\\mathrm{H_2O}} \\, A_{\\mathrm{H_2O}}(T,p) \\, g_{\\mathrm{H_2O}}(\\lambda) \\;+\\; \\chi_{\\mathrm{CO_2}} \\, A_{\\mathrm{CO_2}}(T,p) \\, g_{\\mathrm{CO_2}}(\\lambda)\n$$\nThe amplitude function $A_{i}$ for each species $i \\in \\{\\mathrm{H_2O}, \\mathrm{CO_2}\\}$ depends on pressure $p$ and temperature $T$:\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s}\n$$\nwith given parameters $\\alpha_{i}$, $p_{0} = 101325\\,\\text{Pa}$, $T_{0} = 1800\\,\\text{K}$, and $s = 0.5$. Note that for all test cases, $T = T_0$, so the term $\\left(T/T_{0}\\right)^{s}$ is always equal to $1$. Pressure must be converted from atmospheres to Pascals using $1\\,\\text{atm} = 101325\\,\\text{Pa}$.\n\nThe spectral shape functions $g_{i}(\\lambda)$ are modeled as a sum of Gaussian functions, representing absorption bands:\n$$\ng_{\\mathrm{H_2O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\mathrm{H_2O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{H_2O})}_{j}}{\\sigma^{(\\mathrm{H_2O})}_{j}}\\right)^{2} \\right)\n$$\n$$\ng_{\\mathrm{CO_2}}(\\lambda) = \\sum_{j=1}^{2} w^{(\\mathrm{CO_2})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{CO_2})}_{j}}{\\sigma^{(\\mathrm{CO_2})}_{j}}\\right)^{2} \\right)\n$$\nThe parameters for these Gaussians (weights $w_j$, centers $\\lambda_j$, and widths $\\sigma_j$) are provided in the problem statement.\n\nThe algorithmic procedure for each test case is as follows:\n1.  Establish the case-specific parameters: $T$, $p$ (in atm), $\\chi_{\\mathrm{H_2O}}$, $\\chi_{\\mathrm{CO_2}}$, and $L$. The temperature $T=1800\\,\\text{K}$ is constant for all cases.\n2.  Calculate the amplitude functions $A_{\\mathrm{H_2O}}$ and $A_{\\mathrm{CO_2}}$ using the given model, making sure to use pressure in Pascals.\n3.  Construct the function for the spectral absorption coefficient $\\kappa_{\\lambda}(\\lambda)$ using the calculated amplitudes and the predefined spectral shape functions $g_{\\mathrm{H_2O}}(\\lambda)$ and $g_{\\mathrm{CO_2}}(\\lambda)$.\n4.  Define the numerator integrand, $\\kappa_{\\lambda}(\\lambda) w(\\lambda, T)$, and the denominator integrand, $w(\\lambda, T)$.\n5.  Numerically evaluate the integrals $N$ and $D$ over the wavelength range $[2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$. A high-quality numerical quadrature routine, such as `scipy.integrate.quad`, is suitable for this task. For the special case where both mole fractions $\\chi_{\\mathrm{H_2O}}$ and $\\chi_{\\mathrm{CO_2}}$ are zero, $\\kappa_{\\lambda}$ is identically zero, making the numerator $N=0$ and thus $\\kappa_{P}=0$ without need for integration.\n6.  Compute the Planck mean absorption coefficient: $\\kappa_{P} = N/D$.\n7.  Calculate the optical thickness: $\\tau = \\kappa_{P} \\, L$.\n8.  Apply the given criterion to determine the value of $\\text{gray\\_ok}$: it is $\\text{true}$ if $0.3 \\le \\tau \\le 3.0$, and $\\text{false}$ otherwise.\n9.  Format the calculated values ($\\kappa_P$ and $\\tau$ rounded to six decimal places, and the lowercase string for $\\text{gray\\_ok}$) as required.\n\nThis procedure is implemented for each test case provided in the problem statement to generate the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Calculates the Planck mean absorption coefficient, optical thickness,\n    and a gray-model applicability metric for a gas mixture.\n    \"\"\"\n    \n    # Define physical constants from SciPy\n    h = constants.h  # Planck constant (J.s)\n    c = constants.c  # Speed of light in vacuum (m/s)\n    k = constants.k  # Boltzmann constant (J/K)\n\n    # Define model parameters from the problem statement\n    # Reference conditions\n    p0 = 101325.0  # Reference pressure in Pa\n    T0 = 1800.0   # Reference temperature in K\n    s = 0.5       # Temperature exponent\n\n    # Species baseline coefficients\n    alpha_h2o = 4.0  # m^-1\n    alpha_co2 = 3.0  # m^-1\n\n    # Integration wavelength range\n    WAV_MIN, WAV_MAX = 2e-7, 2e-5 # m\n\n    # Spectral shape function parameters for H2O\n    H2O_BANDS = {\n        'weights': np.array([0.5, 0.3, 0.2]),\n        'centers': np.array([1.4e-6, 2.7e-6, 6.3e-6]),\n        'widths': np.array([0.4e-6, 0.5e-6, 1.2e-6])\n    }\n\n    # Spectral shape function parameters for CO2\n    CO2_BANDS = {\n        'weights': np.array([0.4, 0.6]),\n        'centers': np.array([2.0e-6, 4.3e-6]),\n        'widths': np.array([0.4e-6, 0.8e-6])\n    }\n\n    def planck_weight_function(wav, T):\n        \"\"\"\n        Calculates the wavelength-dependent part of the Planck function,\n        omitting the 2*h*c^2 constant which cancels out.\n        \"\"\"\n        C2_over_T = h * c / (k * T)\n        exponent = C2_over_T / wav\n        # np.exp(709.78) is a typical double-precision float limit\n        if exponent > 700:\n            return 0.0\n        return (1.0 / wav**5) / (np.exp(exponent) - 1.0)\n\n    def g_h2o(wav):\n        \"\"\"Calculates the spectral shape function for H2O.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(H2O_BANDS['weights'], H2O_BANDS['centers'], H2O_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def g_co2(wav):\n        \"\"\"Calculates the spectral shape function for CO2.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(CO2_BANDS['weights'], CO2_BANDS['centers'], CO2_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def calculate_k_p(T, p_atm, chi_h2o, chi_co2):\n        \"\"\"Calculates the Planck mean absorption coefficient.\"\"\"\n        # Handle the transparent medium case directly for efficiency and correctness.\n        if chi_h2o == 0.0 and chi_co2 == 0.0:\n            return 0.0\n\n        p_pa = p_atm * 101325.0\n        \n        # Calculate amplitude functions A_i\n        A_h2o = alpha_h2o * (p_pa / p0) * (T / T0)**s\n        A_co2 = alpha_co2 * (p_pa / p0) * (T / T0)**s\n\n        def kappa_lambda(wav):\n            \"\"\"Calculates the mixture spectral absorption coefficient.\"\"\"\n            return chi_h2o * A_h2o * g_h2o(wav) + chi_co2 * A_co2 * g_co2(wav)\n        \n        # Numerator integral: integral(kappa_lambda * I_lambda^b * d_lambda)\n        # We use planck_weight_function since the 2hc^2 constant cancels.\n        num_integrand = lambda wav: kappa_lambda(wav) * planck_weight_function(wav, T)\n        numerator, _ = integrate.quad(num_integrand, WAV_MIN, WAV_MAX)\n        \n        # Denominator integral: integral(I_lambda^b * d_lambda)\n        den_integrand = lambda wav: planck_weight_function(wav, T)\n        denominator, _ = integrate.quad(den_integrand, WAV_MIN, WAV_MAX)\n\n        if denominator == 0:\n            return 0.0\n        \n        return numerator / denominator\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T [K], p [atm], chi_H2O, chi_CO2, L [m])\n        (1800.0, 1.0, 0.10, 0.10, 2.0),\n        (1800.0, 1.0, 0.00, 0.20, 1.0),\n        (1800.0, 5.0, 0.20, 0.10, 1.0),\n        (1800.0, 1.0, 0.00, 0.00, 1.0),\n    ]\n\n    results_str_list = []\n    for T_case, p_case, chi_h2o_case, chi_co2_case, L_case in test_cases:\n        kappa_p = calculate_k_p(T_case, p_case, chi_h2o_case, chi_co2_case)\n        tau = kappa_p * L_case\n        gray_ok = \"true\" if 0.3 <= tau <= 3.0 else \"false\"\n        \n        # Format the result for this case as a string \"[k_p,tau,gray_ok]\"\n        case_result_str = f\"[{kappa_p:.6f},{tau:.6f},{gray_ok}]\"\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having established the tools to solve the RTE and model gas properties, we now apply them to quantify the impact of radiation on a combustion system. This exercise focuses on the direct coupling of radiation with the flame energy balance to determine the reduction in flame temperature due to radiative heat loss. By solving for the final temperature in a one-dimensional premixed flame using an optically thin radiation model, you will gain practical insight into why purely adiabatic calculations can be insufficient and how radiation shapes the thermal field in real flames.",
            "id": "4015157",
            "problem": "Consider a steady one-dimensional premixed methane–air flame represented by a control volume of thickness $L$ and unit cross-sectional area. The inflowing mixture has bulk speed $U$, pressure $p$, and inlet temperature $T_{\\mathrm{in}}$. In the adiabatic limit, the products reach the adiabatic flame temperature $T_{\\mathrm{ad}}$. When optically thin radiation is included, the products lose energy to the surroundings at temperature $T_{\\mathrm{env}}$, leading to a reduced exit temperature $T_{\\mathrm{rad}}$. You must compute the temperature reduction $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$.\n\nStart from fundamental laws:\n- Conservation of energy for a steady one-dimensional control volume implies that the net enthalpy rise equals the chemical heat release minus any heat losses. With adiabatic heat release denoted by $\\dot{m}\\,c_p\\,(T_{\\mathrm{ad}} - T_{\\mathrm{in}})$, the non-adiabatic exit temperature satisfies\n$$\n\\dot{m}\\,c_p\\,(T_{\\mathrm{rad}} - T_{\\mathrm{in}}) \\;=\\; \\dot{m}\\,c_p\\,(T_{\\mathrm{ad}} - T_{\\mathrm{in}}) \\;-\\; Q_{\\mathrm{rad}}(T_{\\mathrm{rad}}),\n$$\nwhich rearranges to the implicit equation\n$$\nT_{\\mathrm{ad}} - T_{\\mathrm{rad}} \\;=\\; \\frac{Q_{\\mathrm{rad}}(T_{\\mathrm{rad}})}{\\dot{m}\\,c_p},\n$$\nwhere $\\dot{m} = \\rho\\,U$ is the mass flux per unit area, $\\rho$ the product-gas density, and $c_p$ the specific heat at constant pressure. Take $c_p$ to be constant and equal to $1200\\ \\mathrm{J/(kg\\cdot K)}$ for the product mixture.\n\n- Under the optically thin approximation, the divergence of the radiative heat flux can be modeled by\n$$\n\\dot{q}_{\\mathrm{rad}}(T) \\;=\\; 4\\,\\sigma\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big),\n$$\nwhere $\\sigma$ is the Stefan–Boltzmann constant and $\\kappa_P(T)$ is a Planck-mean absorption coefficient of the participating gases. For a slab of thickness $L$ and approximately uniform product temperature $T$, the radiative loss per unit area is\n$$\nQ_{\\mathrm{rad}}(T) \\;=\\; \\dot{q}_{\\mathrm{rad}}(T)\\,L \\;=\\; 4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big).\n$$\n\n- Model $\\kappa_P(T)$ using the Weighted Sum of Gray Gases (WSGG) for water vapor and carbon dioxide. Let the product mole fractions (assumed fixed by stoichiometric methane–air chemistry) be $X_{\\mathrm{H_2O}} = 2/10.52$ and $X_{\\mathrm{CO_2}} = 1/10.52$, and the product mixture molar mass be\n$$\n\\bar{M} \\;=\\; 44\\,X_{\\mathrm{CO_2}} + 18\\,X_{\\mathrm{H_2O}} + 28\\,(1 - X_{\\mathrm{CO_2}} - X_{\\mathrm{H_2O}})\\ \\mathrm{g/mol}.\n$$\nUse the mixture gas constant $R_{\\mathrm{mix}} = R_u/\\bar{M}$ with $R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$ and convert pressure to atmospheres by $p_{\\mathrm{atm}} = p/101325$. Approximate the density at $T_{\\mathrm{ad}}$ by\n$$\n\\rho \\;=\\; \\frac{p}{R_{\\mathrm{mix}}\\,T_{\\mathrm{ad}}}.\n$$\n\nDefine three gray-gas absorption coefficients for each species (in $\\mathrm{m^{-1}\\,atm^{-1}}$):\n- For water vapor ($\\mathrm{H_2O}$): $k_{\\mathrm{H_2O},1} = 0.2$, $k_{\\mathrm{H_2O},2} = 1.5$, $k_{\\mathrm{H_2O},3} = 13.0$.\n- For carbon dioxide ($\\mathrm{CO_2}$): $k_{\\mathrm{CO_2},1} = 0.1$, $k_{\\mathrm{CO_2},2} = 0.8$, $k_{\\mathrm{CO_2},3} = 8.0$.\n\nLet the temperature-dependent WSGG weights (non-negative and summing to one) be\n$$\n\\begin{aligned}\na_{\\mathrm{H_2O},1}(T) &= 0.6 - 10^{-4}\\,(T - 1000),\\\\\na_{\\mathrm{H_2O},2}(T) &= 0.3 + 5\\times 10^{-5}\\,(T - 1000),\\\\\na_{\\mathrm{H_2O},3}(T) &= 0.1 + 5\\times 10^{-5}\\,(T - 1000),\n\\end{aligned}\n\\qquad\n\\begin{aligned}\na_{\\mathrm{CO_2},1}(T) &= 0.7 - 10^{-4}\\,(T - 1000),\\\\\na_{\\mathrm{CO_2},2}(T) &= 0.25 + 5\\times 10^{-5}\\,(T - 1000),\\\\\na_{\\mathrm{CO_2},3}(T) &= 0.05 + 5\\times 10^{-5}\\,(T - 1000),\n\\end{aligned}\n$$\nand the species-level Planck-mean absorption coefficients are\n$$\n\\kappa_{\\mathrm{H_2O}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{H_2O}}\\,\\sum_{m=1}^3 a_{\\mathrm{H_2O},m}(T)\\,k_{\\mathrm{H_2O},m},\n\\qquad\n\\kappa_{\\mathrm{CO_2}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{CO_2}}\\,\\sum_{m=1}^3 a_{\\mathrm{CO_2},m}(T)\\,k_{\\mathrm{CO_2},m},\n$$\nso that\n$$\n\\kappa_P(T) \\;=\\; \\kappa_{\\mathrm{H_2O}}(T) + \\kappa_{\\mathrm{CO_2}}(T).\n$$\n\nUsing these relations, compute $T_{\\mathrm{rad}}$ by solving\n$$\nf(T) \\;=\\; T_{\\mathrm{ad}} - T \\;-\\; \\frac{4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big)}{\\rho\\,U\\,c_p} \\;=\\; 0,\n$$\nfor $T\\in[T_{\\mathrm{env}},\\,T_{\\mathrm{ad}}]$, and report $\\Delta T = T_{\\mathrm{ad}} - T$.\n\nConstants and units:\n- Use $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$, $R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$, $p_0 = 101325\\ \\mathrm{Pa}$.\n- Express all temperatures in $\\mathrm{K}$, pressure in $\\mathrm{Pa}$, length in $\\mathrm{m}$, speed in $\\mathrm{m/s}$, density in $\\mathrm{kg/m^3}$, and heat in $\\mathrm{W/m^2}$.\n- Express the final temperature reductions $\\Delta T$ in $\\mathrm{K}$ as floats.\n\nTest suite:\nProvide the following four parameter sets $(T_{\\mathrm{ad}}, T_{\\mathrm{env}}, p, U, L, T_{\\mathrm{in}})$ to exercise typical, high-flow, high-pressure, and warm-surroundings cases:\n1. $(2220,\\ 300,\\ 101325,\\ 0.5,\\ 0.010,\\ 300)$\n2. $(2220,\\ 300,\\ 101325,\\ 5.0,\\ 0.010,\\ 300)$\n3. $(2200,\\ 500,\\ 5\\times 101325,\\ 1.0,\\ 0.020,\\ 300)$\n4. $(2300,\\ 800,\\ 101325,\\ 0.1,\\ 0.015,\\ 300)$\n\nFinal output format:\nYour program should produce a single line of output containing the four temperature reductions as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), each value being a float in $\\mathrm{K}$.",
            "solution": "The problem is evaluated to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard, albeit simplified, engineering model for calculating radiative heat loss from a one-dimensional flame. The governing equations are based on fundamental principles of energy conservation and established models for radiative heat transfer (the optically thin approximation and the Weighted-Sum-of-Gray-Gases model). All necessary physical constants, material properties, and parameters for the test cases are provided, and their units are consistent. The problem's structure is a non-linear algebraic equation for the temperature. The monotonicity of the objective function and the boundary conditions guarantee the existence of a unique solution. Therefore, the problem is considered valid.\n\nThe core task is to determine the temperature reduction $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$ due to radiative losses from a steady one-dimensional flame. The radiatively cooled exit temperature, $T_{\\mathrm{rad}}$, is the root of the following implicit equation derived from a control-volume energy balance:\n$$\nf(T) \\;=\\; T_{\\mathrm{ad}} - T \\;-\\; \\frac{Q_{\\mathrm{rad}}(T)}{\\rho\\,U\\,c_p} \\;=\\; 0\n$$\nwhere $T$ is the unknown product gas temperature, which we seek to find as $T_{\\mathrm{rad}}$. The solution must be found within the physical bounds $T \\in [T_{\\mathrm{env}}, T_{\\mathrm{ad}}]$.\n\nThe solution process involves several steps:\n$1$. Calculate the constant parameters for a given test case.\n$2$. Define the temperature-dependent functions for the radiative heat loss, $Q_{\\mathrm{rad}}(T)$, and the Planck-mean absorption coefficient, $\\kappa_P(T)$.\n$3$. Numerically solve the equation $f(T) = 0$ for $T_{\\mathrm{rad}}$.\n$4$. Compute the final temperature reduction $\\Delta T$.\n\nFirst, we calculate the parameters that do not depend on the unknown temperature $T$. The product gas mole fractions for stoichiometric methane-air combustion are given as $X_{\\mathrm{H_2O}} = 2/10.52$ and $X_{\\mathrm{CO_2}} = 1/10.52$. The average molar mass of the product mixture, $\\bar{M}$, is calculated as:\n$$\n\\bar{M} \\;=\\; 44\\,X_{\\mathrm{CO_2}} + 18\\,X_{\\mathrm{H_2O}} + 28\\,(1 - X_{\\mathrm{CO_2}} - X_{\\mathrm{H_2O}})\\ \\mathrm{g/mol}\n$$\nThe mixture-specific gas constant is $R_{\\mathrm{mix}} = R_u/\\bar{M}$, where $R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$ is the universal gas constant. Note that $\\bar{M}$ must be converted to $\\mathrm{kg/mol}$ for consistency. The product gas density, $\\rho$, is approximated using the ideal gas law at the adiabatic flame temperature, $T_{\\mathrm{ad}}$:\n$$\n\\rho \\;=\\; \\frac{p}{R_{\\mathrm{mix}}\\,T_{\\mathrm{ad}}}\n$$\nThe mass flux per unit area is $\\dot{m} = \\rho\\,U$. The denominator of the loss term is then $\\rho\\,U\\,c_p$, with $c_p = 1200\\ \\mathrm{J/(kg\\cdot K)}$.\n\nSecond, we formulate the radiative heat loss term, $Q_{\\mathrm{rad}}(T)$. Under the optically thin approximation for a slab of thickness $L$:\n$$\nQ_{\\mathrm{rad}}(T) \\;=\\; 4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big)\n$$\nwhere $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$ is the Stefan–Boltzmann constant. The Planck-mean absorption coefficient, $\\kappa_P(T)$, is modeled using the Weighted-Sum-of-Gray-Gases (WSGG) approach. It is the sum of contributions from water vapor and carbon dioxide:\n$$\n\\kappa_P(T) \\;=\\; \\kappa_{\\mathrm{H_2O}}(T) + \\kappa_{\\mathrm{CO_2}}(T)\n$$\nEach species-specific coefficient is a function of its partial pressure and temperature-dependent weights:\n$$\n\\kappa_{\\mathrm{H_2O}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{H_2O}}\\,\\sum_{m=1}^3 a_{\\mathrm{H_2O},m}(T)\\,k_{\\mathrm{H_2O},m}\n$$\n$$\n\\kappa_{\\mathrm{CO_2}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{CO_2}}\\,\\sum_{m=1}^3 a_{\\mathrm{CO_2},m}(T)\\,k_{\\mathrm{CO_2},m}\n$$\nHere, $p_{\\mathrm{atm}} = p/p_0$ is the total pressure in atmospheres, with $p_0=101325$ Pa. The terms $k_{\\mathrm{species},m}$ are the gray-gas absorption coefficients given in $\\mathrm{m^{-1}\\,atm^{-1}}$, and $a_{\\mathrm{species},m}(T)$ are the corresponding temperature-dependent weights. These weights are given as linear functions of temperature $T$ (in Kelvin):\n$$\n\\begin{aligned}\na_{\\mathrm{H_2O},1}(T) &= 0.6 - 10^{-4}\\,(T - 1000) \\\\\na_{\\mathrm{H_2O},2}(T) &= 0.3 + 5\\times 10^{-5}\\,(T - 1000) \\\\\na_{\\mathrm{H_2O},3}(T) &= 0.1 + 5\\times 10^{-5}\\,(T - 1000)\n\\end{aligned}\n\\qquad\n\\begin{aligned}\na_{\\mathrm{CO_2},1}(T) &= 0.7 - 10^{-4}\\,(T - 1000) \\\\\na_{\\mathrm{CO_2},2}(T) &= 0.25 + 5\\times 10^{-5}\\,(T - 1000) \\\\\na_{\\mathrm{CO_2},3}(T) &= 0.05 + 5\\times 10^{-5}\\,(T - 1000)\n\\end{aligned}\n$$\nThe function $\\kappa_P(T)$ is therefore a linear function of $T$.\n\nThird, we solve $f(T)=0$. Let's analyze the function $f(T)$ on the interval $[T_{\\mathrm{env}}, T_{\\mathrm{ad}}]$.\nAt the lower bound $T = T_{\\mathrm{env}}$, the radiative loss term is zero, so $f(T_{\\mathrm{env}}) = T_{\\mathrm{ad}} - T_{\\mathrm{env}}$. Since $T_{\\mathrm{ad}} > T_{\\mathrm{env}}$, $f(T_{\\mathrm{env}}) > 0$.\nAt the upper bound $T = T_{\\mathrm{ad}}$, the loss term is $Q_{\\mathrm{rad}}(T_{\\mathrm{ad}}) > 0$. Thus, $f(T_{\\mathrm{ad}}) = T_{\\mathrm{ad}} - T_{\\mathrm{ad}} - Q_{\\mathrm{rad}}(T_{\\mathrm{ad}})/(\\rho\\,U\\,c_p) = -Q_{\\mathrm{rad}}(T_{\\mathrm{ad}})/(\\rho\\,U\\,c_p) < 0$.\nThe derivative $f'(T)$ is given by:\n$$\nf'(T) \\;=\\; -1 \\;-\\; \\frac{4\\,\\sigma\\,L}{\\rho\\,U\\,c_p} \\left[ \\frac{d\\kappa_P(T)}{dT}\\big(T^4 - T_{\\mathrm{env}}^4\\big) + \\kappa_P(T)\\,(4T^3) \\right]\n$$\nThe term $d\\kappa_P(T)/dT$ is a positive constant, and all other terms in the bracket are positive for $T > T_{\\mathrm{env}}$. Therefore, $f'(T) < -1$ for all $T$ in the interval.\nSince $f(T)$ is continuous and strictly monotonically decreasing, and it changes sign over the interval $[T_{\\mathrm{env}}, T_{\\mathrm{ad}}]$, a unique root $T_{\\mathrm{rad}}$ is guaranteed to exist in $(T_{\\mathrm{env}}, T_{\\mathrm{ad}})$. This root can be found efficiently using a numerical root-finding algorithm, such as the Brent-Dekker method (`brentq` in SciPy).\n\nFinally, once $T_{\\mathrm{rad}}$ is found, the temperature reduction is calculated as $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$. This procedure is repeated for each of the four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Calculates the temperature reduction in a premixed flame due to\n    optically thin radiation, for a series of test cases.\n    \"\"\"\n    # Define constants\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant, W/(m^2*K^4)\n    RU = 8.314             # Universal gas constant, J/(mol*K)\n    P0 = 101325.0          # Standard pressure, Pa\n    CP = 1200.0            # Specific heat of products, J/(kg*K)\n\n    # WSGG model parameters\n    # Mole fractions\n    X_H2O = 2.0 / 10.52\n    X_CO2 = 1.0 / 10.52\n    \n    # Gray-gas absorption coefficients, m^-1*atm^-1\n    K_H2O = np.array([0.2, 1.5, 13.0])\n    K_CO2 = np.array([0.1, 0.8, 8.0])\n\n    # Test cases: (T_ad, T_env, p, U, L, T_in)\n    test_cases = [\n        (2220.0, 300.0, 101325.0, 0.5, 0.010, 300.0),\n        (2220.0, 300.0, 101325.0, 5.0, 0.010, 300.0),\n        (2200.0, 500.0, 5.0 * 101325.0, 1.0, 0.020, 300.0),\n        (2300.0, 800.0, 101325.0, 0.1, 0.015, 300.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T_ad, T_env, p, U, L, T_in = case\n\n        # --- 1. Calculate constant parameters ---\n        # Molar mass of product mixture, M_bar (kg/mol)\n        # Molar masses: CO2=44, H2O=18, N2=28 g/mol\n        m_bar_g = 44.0 * X_CO2 + 18.0 * X_H2O + 28.0 * (1.0 - X_CO2 - X_H2O)\n        m_bar_kg = m_bar_g / 1000.0 # Convert to kg/mol\n        \n        # Mixture-specific gas constant, R_mix (J/(kg*K))\n        R_mix = RU / m_bar_kg\n        \n        # Density of products at T_ad, rho (kg/m^3)\n        rho = p / (R_mix * T_ad)\n        \n        # Mass flux, m_dot (kg/(m^2*s))\n        m_dot = rho * U\n        \n        # Pressure in atmospheres (dimensionless)\n        p_atm = p / P0\n\n        # --- 2. Define temperature-dependent functions ---\n        def kappa_P(T):\n            \"\"\"Calculates the Planck-mean absorption coefficient kappa_P(T) in m^-1.\"\"\"\n            T_ref_diff = T - 1000.0\n            \n            # H2O WSGG weights\n            a_H2O_1 = 0.6 - 1e-4 * T_ref_diff\n            a_H2O_2 = 0.3 + 5e-5 * T_ref_diff\n            a_H2O_3 = 1.0 - a_H2O_1 - a_H2O_2 # Ensures sum is 1\n            a_H2O = np.array([a_H2O_1, a_H2O_2, a_H2O_3])\n            \n            # CO2 WSGG weights\n            a_CO2_1 = 0.7 - 1e-4 * T_ref_diff\n            a_CO2_2 = 0.25 + 5e-5 * T_ref_diff\n            a_CO2_3 = 1.0 - a_CO2_1 - a_CO2_2 # Ensures sum is 1\n            a_CO2 = np.array([a_CO2_1, a_CO2_2, a_CO2_3])\n\n            # Species-level absorption coefficients, kappa_i (m^-1)\n            # p_atm * X is the partial pressure in atm\n            kappa_H2O = p_atm * X_H2O * np.sum(a_H2O * K_H2O)\n            kappa_CO2 = p_atm * X_CO2 * np.sum(a_CO2 * K_CO2)\n            \n            return kappa_H2O + kappa_CO2\n\n        def f(T):\n            \"\"\"The function f(T) = 0 to be solved for T_rad.\"\"\"\n            # Radiative heat loss per unit area, Q_rad (W/m^2)\n            Q_rad = 4.0 * SIGMA * L * kappa_P(T) * (T**4 - T_env**4)\n            \n            # Energy balance equation\n            heat_loss_term = Q_rad / (m_dot * CP)\n            \n            return T_ad - T - heat_loss_term\n\n        # --- 3. Solve for T_rad ---\n        # The root is bracketed by T_env and T_ad\n        T_rad = brentq(f, a=T_env, b=T_ad)\n\n        # --- 4. Compute delta T ---\n        delta_T = T_ad - T_rad\n        results.append(delta_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}