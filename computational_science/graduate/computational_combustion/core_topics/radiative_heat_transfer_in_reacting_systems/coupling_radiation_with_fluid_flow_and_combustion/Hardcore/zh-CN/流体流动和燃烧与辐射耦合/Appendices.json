{
    "hands_on_practices": [
        {
            "introduction": "真实的燃烧产物（如 $H_2O$ 和 $CO_2$）具有极其复杂的光谱吸收特性。对于大规模模拟而言，直接进行逐线（line-by-line）计算通常会带来过高的计算成本。本练习  将指导您掌握一种至关重要的简化技术：计算平均吸收系数。您将通过数值积分来计算普朗克平均吸收系数（Planck mean absorption coefficient），该方法将复杂的光谱信息压缩为单个与温度相关的数值，这对于许多辐射模型至关重要。",
            "id": "4015090",
            "problem": "考虑一个一维、无散射的参与性气体介质，该介质由水蒸气和二氧化碳组成，被视为等温，温度为 $T = 1800\\,\\text{K}$，压力 $p$ 在空间上均匀。混合物的平均光谱吸收系数被建模为按摩尔分数加权的各组分贡献之和。混合物的 Planck 平均吸收系数 $\\kappa_{P}$ 由黑体强度对波长进行加权定义，具体如下：\n$$\n\\kappa_{P}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda},\n$$\n其中 $\\kappa_{\\lambda}$ 是混合物的光谱吸收系数，$I_{\\lambda}^{b}(T)$ 是温度为 $T$ 时的黑体光谱强度。单位波长的黑体光谱强度由热辐射的基本定律——Planck 定律给出：\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right),\n$$\n其中 $h$ 是 Planck 常数，$c$ 是真空中的光速，$k_{B}$ 是 Boltzmann 常数。Kirchhoff 的热辐射定律（适用于局部热力学平衡）确保了发射和吸收是相关的，这为使用 $I_{\\lambda}^{b}(T)$ 作为定义 $\\kappa_{P}$ 的权重函数提供了依据。\n\n假设混合物的光谱吸收系数采用以下具有科学依据的参数模型：\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\chi_{\\mathrm{H_2O}} \\, A_{\\mathrm{H_2O}}(T,p) \\, g_{\\mathrm{H_2O}}(\\lambda) \\;+\\; \\chi_{\\mathrm{CO_2}} \\, A_{\\mathrm{CO_2}}(T,p) \\, g_{\\mathrm{CO_2}}(\\lambda),\n$$\n其中 $\\chi_{\\mathrm{H_2O}}$ 和 $\\chi_{\\mathrm{CO_2}}$ 分别是水蒸气和二氧化碳的摩尔分数，$A_{i}(T,p)$ 是具有逆长度单位的组分振幅函数，$g_{i}(\\lambda)$ 是代表主要红外波段的无量纲光谱形状函数。振幅函数随压力和温度的变化关系如下：\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s},\n$$\n其中 $p_{0} = 101325\\,\\text{Pa}$，$T_{0} = 1800\\,\\text{K}$，$s = 0.5$，以及组分基线系数 $\\alpha_{\\mathrm{H_2O}} = 4.0\\,\\text{m}^{-1}$，$\\alpha_{\\mathrm{CO_2}} = 3.0\\,\\text{m}^{-1}$。光谱形状函数被规定为高斯波段之和：\n$$\ng_{\\mathrm{H_2O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\mathrm{H_2O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{H_2O})}_{j}}{\\sigma^{(\\mathrm{H_2O})}_{j}}\\right)^{2} \\right),\n$$\n中心波长为 $\\lambda^{(\\mathrm{H_2O})}_{j} \\in \\{1.4\\times 10^{-6},\\, 2.7\\times 10^{-6},\\, 6.3\\times 10^{-6}\\}\\,\\text{m}$，权重为 $w^{(\\mathrm{H_2O})}_{j} \\in \\{0.5,\\, 0.3,\\, 0.2\\}$，宽度为 $\\sigma^{(\\mathrm{H_2O})}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.5\\times 10^{-6},\\, 1.2\\times 10^{-6}\\}\\,\\text{m}$。类似地，\n$$\ng_{\\mathrm{CO_2}}(\\lambda) = \\sum_{j=1}^{2} w^{(\\mathrm{CO_2})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{CO_2})}_{j}}{\\sigma^{(\\mathrm{CO_2})}_{j}}\\right)^{2} \\right),\n$$\n中心波长为 $\\lambda^{(\\mathrm{CO_2})}_{j} \\in \\{2.0\\times 10^{-6},\\, 4.3\\times 10^{-6}\\}\\,\\text{m}$，权重为 $w^{(\\mathrm{CO_2})}_{j} \\in \\{0.4,\\, 0.6\\}$，宽度为 $\\sigma^{(\\mathrm{CO_2})}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.8\\times 10^{-6}\\}\\,\\text{m}$。波长积分区间必须取为 $\\lambda \\in [2\\times 10^{-7},\\, 2\\times 10^{-5}]\\,\\text{m}$，以覆盖在 $T = 1800\\,\\text{K}$ 时的相关热辐射光谱。\n\n定义光学厚度为\n$$\n\\tau = \\kappa_{P} \\, L,\n$$\n其中 $L$ 是介质厚度。在灰体近似的背景下，$\\tau$ 为 1 量级的区域表明其既非光学薄也非光学厚；一个用于评估灰体模型适用性（无散射且发射-吸收耦合占主导）的实用准则是\n$$\n\\text{gray\\_ok} = \\begin{cases}\n\\text{true},  \\text{if } 0.3 \\le \\tau \\le 3.0,\\\\\n\\text{false},  \\text{otherwise}.\n\\end{cases}\n$$\n\n任务：\n- 使用上述定义和模型，为下面的每个测试案例计算 $\\kappa_{P}$ 和 $\\tau$。\n- 将 $\\kappa_{P}$ 以 $\\text{m}^{-1}$ 为单位表示，$\\tau$ 为无量纲量，两者均四舍五入到六位小数。\n- 对于每个测试案例，还需输出 $\\text{gray\\_ok}$，其值为小写字符串 $\\,\\text{true}\\,$ 或 $\\,\\text{false}\\,$。\n- 您的程序必须在指定域上对波长进行数值积分。\n\n测试套件：\n1. 案例 1：$T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.10$, $\\chi_{\\mathrm{CO_2}} = 0.10$, $L = 2.0\\,\\text{m}$。\n2. 案例 2：$T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.00$, $\\chi_{\\mathrm{CO_2}} = 0.20$, $L = 1.0\\,\\text{m}$。\n3. 案例 3：$T = 1800\\,\\text{K}$, $p = 5.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.20$, $\\chi_{\\mathrm{CO_2}} = 0.10$, $L = 1.0\\,\\text{m}$。\n4. 案例 4（边缘情况，透明介质）：$T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\mathrm{H_2O}} = 0.00$, $\\chi_{\\mathrm{CO_2}} = 0.00$, $L = 1.0\\,\\text{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个案例结果列表。每个案例结果必须是 $[\\kappa_{P}, \\tau, \\text{gray\\_ok}]$ 形式的三元素列表，不含空格，其中 $\\kappa_{P}$ 的单位是 $\\text{m}^{-1}$，$\\tau$ 是无量纲量，两者都四舍五入到六位小数，而 $\\text{gray\\_ok}$ 是小写字符串 $\\,\\text{true}\\,$ 或 $\\,\\text{false}\\,$。总输出必须是这些案例列表的逗号分隔列表，并用方括号括起来。例如，格式为 $[[0.123456,0.654321,true],[\\dots],[\\dots],[\\dots]]$。",
            "solution": "该问题要求在指定的热力学条件下，计算水蒸气和二氧化碳气体混合物的 Planck 平均吸收系数 $\\kappa_{P}$。基于此，需要为几个测试案例确定光学厚度 $\\tau$ 和一个灰体模型适用性准则。\n\nPlanck 平均吸收系数 $\\kappa_{P}$ 定义为由黑体光谱强度 $I_{\\lambda}^{b}(T)$ 加权并由总黑体强度归一化的光谱吸收系数 $\\kappa_{\\lambda}$。其公式为：\n$$\n\\kappa_{P}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda}\n$$\n对于数值计算，无限积分域被替换为指定的范围 $\\lambda \\in [2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$，这个范围在给定温度 $T=1800\\,\\text{K}$ 下捕获了绝大部分的黑体发射功率。设分子为 $N$，分母为 $D$。\n$$\nN = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\n$$\nD = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\n那么，$\\kappa_{P} = N/D$。黑体光谱强度 $I_{\\lambda}^{b}(T)$ 由 Planck 定律给出：\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\n常数前置因子 $2 h c^{2}$ 同时出现在分子 $N$ 和分母 $D$ 的积分中，因此可以消去。这对于数值计算是有利的，因为它避免了处理非常大或非常小的数。因此，我们可以使用一个与 $I_{\\lambda}^{b}(T)$ 成正比的简化权重函数：\n$$\nw(\\lambda, T) = \\frac{1}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\n\n混合物光谱吸收系数 $\\kappa_{\\lambda}$ 被建模为每个组分贡献的线性组合：\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\chi_{\\mathrm{H_2O}} \\, A_{\\mathrm{H_2O}}(T,p) \\, g_{\\mathrm{H_2O}}(\\lambda) \\;+\\; \\chi_{\\mathrm{CO_2}} \\, A_{\\mathrm{CO_2}}(T,p) \\, g_{\\mathrm{CO_2}}(\\lambda)\n$$\n每个组分 $i \\in \\{\\mathrm{H_2O}, \\mathrm{CO_2}\\}$ 的振幅函数 $A_{i}$ 取决于压力 $p$ 和温度 $T$：\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s}\n$$\n给定参数为 $\\alpha_{i}$、$p_{0} = 101325\\,\\text{Pa}$、$T_{0} = 1800\\,\\text{K}$ 和 $s = 0.5$。请注意，对于所有测试案例，$T = T_0$，因此项 $\\left(T/T_{0}\\right)^{s}$ 始终等于 1。压力必须使用 $1\\,\\text{atm} = 101325\\,\\text{Pa}$ 从大气压转换为帕斯卡。\n\n光谱形状函数 $g_{i}(\\lambda)$ 被建模为高斯函数之和，代表吸收带：\n$$\ng_{\\mathrm{H_2O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\mathrm{H_2O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{H_2O})}_{j}}{\\sigma^{(\\mathrm{H_2O})}_{j}}\\right)^{2} \\right)\n$$\n$$\ng_{\\mathrm{CO_2}}(\\lambda) = \\sum_{j=1}^{2} w^{(\\mathrm{CO_2})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{CO_2})}_{j}}{\\sigma^{(\\mathrm{CO_2})}_{j}}\\right)^{2} \\right)\n$$\n这些高斯函数的参数（权重 $w_j$、中心 $\\lambda_j$ 和宽度 $\\sigma_j$）在问题陈述中已提供。\n\n每个测试案例的算法步骤如下：\n1.  确定案例特定的参数：$T$、$p$（单位为 atm）、$\\chi_{\\mathrm{H_2O}}$、$\\chi_{\\mathrm{CO_2}}$ 和 $L$。所有案例的温度 $T=1800\\,\\text{K}$ 是恒定的。\n2.  使用给定的模型计算振幅函数 $A_{\\mathrm{H_2O}}$ 和 $A_{\\mathrm{CO_2}}$，确保使用帕斯卡为单位的压力。\n3.  使用计算出的振幅和预定义的光谱形状函数 $g_{\\mathrm{H_2O}}(\\lambda)$ 和 $g_{\\mathrm{CO_2}}(\\lambda)$，构建光谱吸收系数函数 $\\kappa_{\\lambda}(\\lambda)$。\n4.  定义分子被积函数 $\\kappa_{\\lambda}(\\lambda) w(\\lambda, T)$ 和分母被积函数 $w(\\lambda, T)$。\n5.  在波长范围 $[2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$ 上对积分 $N$ 和 $D$ 进行数值评估。高质量的数值求积例程，如 `scipy.integrate.quad`，适合此任务。对于摩尔分数 $\\chi_{\\mathrm{H_2O}}$ 和 $\\chi_{\\mathrm{CO_2}}$ 均为零的特殊情况，$\\kappa_{\\lambda}$ 恒等于零，使得分子 $N=0$，因此无需积分即可得出 $\\kappa_{P}=0$。\n6.  计算 Planck 平均吸收系数：$\\kappa_{P} = N/D$。\n7.  计算光学厚度：$\\tau = \\kappa_{P} \\, L$。\n8.  应用给定的准则确定 $\\text{gray\\_ok}$ 的值：如果 $0.3 \\le \\tau \\le 3.0$，则为 $\\text{true}$，否则为 $\\text{false}$。\n9.  按要求格式化计算值（$\\kappa_P$ 和 $\\tau$ 四舍五入到六位小数，以及 $\\text{gray\\_ok}$ 的小写字符串）。\n\n对问题陈述中提供的每个测试案例实施此过程，以生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Calculates the Planck mean absorption coefficient, optical thickness,\n    and a gray-model applicability metric for a gas mixture.\n    \"\"\"\n    \n    # Define physical constants from SciPy\n    h = constants.h  # Planck constant (J.s)\n    c = constants.c  # Speed of light in vacuum (m/s)\n    k = constants.k  # Boltzmann constant (J/K)\n\n    # Define model parameters from the problem statement\n    # Reference conditions\n    p0 = 101325.0  # Reference pressure in Pa\n    T0 = 1800.0   # Reference temperature in K\n    s = 0.5       # Temperature exponent\n\n    # Species baseline coefficients\n    alpha_h2o = 4.0  # m^-1\n    alpha_co2 = 3.0  # m^-1\n\n    # Integration wavelength range\n    WAV_MIN, WAV_MAX = 2e-7, 2e-5 # m\n\n    # Spectral shape function parameters for H2O\n    H2O_BANDS = {\n        'weights': np.array([0.5, 0.3, 0.2]),\n        'centers': np.array([1.4e-6, 2.7e-6, 6.3e-6]),\n        'widths': np.array([0.4e-6, 0.5e-6, 1.2e-6])\n    }\n\n    # Spectral shape function parameters for CO2\n    CO2_BANDS = {\n        'weights': np.array([0.4, 0.6]),\n        'centers': np.array([2.0e-6, 4.3e-6]),\n        'widths': np.array([0.4e-6, 0.8e-6])\n    }\n\n    def planck_weight_function(wav, T):\n        \"\"\"\n        Calculates the wavelength-dependent part of the Planck function,\n        omitting the 2*h*c^2 constant which cancels out.\n        \"\"\"\n        C2_over_T = h * c / (k * T)\n        exponent = C2_over_T / wav\n        # np.exp(709.78) is a typical double-precision float limit\n        if exponent > 700:\n            return 0.0\n        return (1.0 / wav**5) / (np.exp(exponent) - 1.0)\n\n    def g_h2o(wav):\n        \"\"\"Calculates the spectral shape function for H2O.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(H2O_BANDS['weights'], H2O_BANDS['centers'], H2O_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def g_co2(wav):\n        \"\"\"Calculates the spectral shape function for CO2.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(CO2_BANDS['weights'], CO2_BANDS['centers'], CO2_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def calculate_k_p(T, p_atm, chi_h2o, chi_co2):\n        \"\"\"Calculates the Planck mean absorption coefficient.\"\"\"\n        # Handle the transparent medium case directly for efficiency and correctness.\n        if chi_h2o == 0.0 and chi_co2 == 0.0:\n            return 0.0\n\n        p_pa = p_atm * 101325.0\n        \n        # Calculate amplitude functions A_i\n        A_h2o = alpha_h2o * (p_pa / p0) * (T / T0)**s\n        A_co2 = alpha_co2 * (p_pa / p0) * (T / T0)**s\n\n        def kappa_lambda(wav):\n            \"\"\"Calculates the mixture spectral absorption coefficient.\"\"\"\n            return chi_h2o * A_h2o * g_h2o(wav) + chi_co2 * A_co2 * g_co2(wav)\n        \n        # Numerator integral: integral(kappa_lambda * I_lambda^b * d_lambda)\n        # We use planck_weight_function since the 2hc^2 constant cancels.\n        num_integrand = lambda wav: kappa_lambda(wav) * planck_weight_function(wav, T)\n        numerator, _ = integrate.quad(num_integrand, WAV_MIN, WAV_MAX)\n        \n        # Denominator integral: integral(I_lambda^b * d_lambda)\n        den_integrand = lambda wav: planck_weight_function(wav, T)\n        denominator, _ = integrate.quad(den_integrand, WAV_MIN, WAV_MAX)\n\n        if denominator == 0:\n            return 0.0\n        \n        return numerator / denominator\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T [K], p [atm], chi_H2O, chi_CO2, L [m])\n        (1800.0, 1.0, 0.10, 0.10, 2.0),\n        (1800.0, 1.0, 0.00, 0.20, 1.0),\n        (1800.0, 5.0, 0.20, 0.10, 1.0),\n        (1800.0, 1.0, 0.00, 0.00, 1.0),\n    ]\n\n    results_str_list = []\n    for T_case, p_case, chi_h2o_case, chi_co2_case, L_case in test_cases:\n        kappa_p = calculate_k_p(T_case, p_case, chi_h2o_case, chi_co2_case)\n        tau = kappa_p * L_case\n        gray_ok = \"true\" if 0.3 <= tau <= 3.0 else \"false\"\n        \n        # Format the result for this case as a string \"[k_p,tau,gray_ok]\"\n        case_result_str = f\"[{kappa_p:.6f},{tau:.6f},{gray_ok}]\"\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在确定了吸收系数后，下一步是选择一个光谱模型来预测辐射传热。简单的模型计算速度快但可能不准确，而复杂的模型保真度高但计算成本高昂。本练习  旨在探索这种权衡关系，要求您分别使用简单的灰体气体模型和多组分的加权灰体气体总和（WSGG）模型来计算壁面辐射热通量。通过将您的结果与高保真度的参考计算进行比较，您将能够量化每种模型的准确性，并深入了解它们的实际适用性。",
            "id": "4015147",
            "problem": "考虑一个厚度为 $L$ 的一维、平面平行、等温参与性气体层，该气体层被两个温度分别为 $T_{w,1}$ 和 $T_{w,2}$ 的等温黑体壁面所包围。气体处于均匀温度 $T_g$，吸收和发射辐射，但不发生散射。设局部光谱强度 $I_\\nu(s,\\mu)$ 满足非散射介质的辐射传递方程（RTE），该方程沿相对于壁面1外法线的方向余弦为 $\\mu \\in [-1,1]$ 的射线表示为：\n$$\n\\frac{d I_\\nu}{ds} = -\\kappa_\\nu I_\\nu + \\kappa_\\nu I_{b,\\nu}(T_g),\n$$\n其中，$\\kappa_\\nu$ 是光谱吸收系数，单位为 $\\mathrm{m}^{-1}$；$s$ 是路径长度坐标，单位为 $\\mathrm{m}$；$I_{b,\\nu}(T)$ 是温度为 $T$ 时的光谱黑体强度。在黑体壁面处的边界条件为：对于离开壁面1进入介质的辐射，$I_\\nu(0,\\mu > 0) = I_{b,\\nu}(T_{w,1})$；对于离开壁面2进入介质的辐射，$I_\\nu(L,\\mu  0) = I_{b,\\nu}(T_{w,2})$。\n\n定义壁面1上的半球入射辐射（对壁面1的辐照）为\n$$\nH_1 = \\int_{\\Omega^-} I(\\mathbf{x}_w,\\mathbf{s}) \\, \\left|\\mathbf{s}\\cdot \\mathbf{n}\\right| \\, d\\Omega,\n$$\n其中，$\\Omega^-$ 表示相对于壁面1的入射半球，$\\mathbf{n}$ 是壁面1的向外单位法向量（指向气体），$I(\\mathbf{x}_w,\\mathbf{s})$ 是在壁面位置 $\\mathbf{x}_w$ 沿方向 $\\mathbf{s}$ 的频率积分强度。对于黑体壁面，离开壁面1进入气体的净辐射热流密度为\n$$\nq''_1 = \\sigma T_{w,1}^4 - H_1,\n$$\n其中 $\\sigma$ 是斯特藩-玻尔兹曼常数，其值为 $\\sigma = 5.670374419\\times 10^{-8} \\,\\mathrm{W\\, m^{-2}\\, K^{-4}}$。\n\n在甲烷-空气炉的实际计算燃烧模拟中，需要使用光谱模型。此处考虑三种光谱吸收模型：\n\n1. 灰体模型，使用单一的有效吸收系数 $\\kappa_{\\text{gray}}$（单位 $\\mathrm{m}^{-1}$）。\n2. 四组分灰气体加权和（WSGG）模型，由四个吸收系数 $\\kappa_i$ 和对应的非负权重 $w_i$（$i \\in \\{1,2,3,4\\}$）指定。透明气体权重为 $w_0 = 1 - \\sum_{i=1}^{4} w_i$，对应的吸收系数为 $\\kappa_0 = 0$。\n3. 逐线（LBL）参考模型，提供为一组离散的光谱线或谱带，包含吸收系数 $\\kappa_j$ 和权重 $W_j$（$j \\in \\{1,\\dots,N\\}$），其中 $\\sum_{j=1}^N W_j = 1$，且某些条目可能具有 $\\kappa_j = 0$ 以表示透明窗口。\n\n所有模型均采用以下物理上一致的基础：\n- 频率积分的黑体强度为 $I_b(T) = \\sigma T^4 / \\pi$，单位为 $\\mathrm{W\\, m^{-2}\\, sr^{-1}}$。\n- 对于具有吸收系数 $\\kappa$ 的给定光谱子集，沿一条从内部指向壁面1且源于壁面2的射线，在等温、均匀介质中，辐射传递方程的形式解给出了到达壁面1的入射强度，该强度取决于 $\\kappa$、相对壁面的强度以及路径上的气体发射。\n- 入射辐射 $H_1$ 是通过对入射强度在半球上积分计算得出的，即对相对于壁面法线方向余弦为 $\\mu \\in (0,1)$ 的所有方向进行积分。\n\n您的任务是编写一个程序，为下面指定的每个测试用例计算：\n- 使用给定的 $\\{\\kappa_j, W_j\\}_{j=1}^N$ 计算LBL参考壁面热流密度 $q''_{1,\\mathrm{LBL}}$。\n- 使用 $\\kappa_{\\text{gray}}$ 计算灰体模型壁面热流密度 $q''_{1,\\mathrm{gray}}$。\n- 使用集合 $\\{(\\kappa_i, w_i)\\}_{i=1}^4$ 并补充透明气体组 $(\\kappa_0=0, w_0)$ 来计算四组分WSGG壁面热流密度 $q''_{1,\\mathrm{WSGG}}$。\n\n然后，为每个测试用例计算相对于LBL参考的两个误差度量：\n- 灰体模型的相对误差 $e_{\\mathrm{gray}} = \\left| q''_{1,\\mathrm{gray}} - q''_{1,\\mathrm{LBL}} \\right| / \\left| q''_{1,\\mathrm{LBL}} \\right|$。\n- WSGG的相对误差 $e_{\\mathrm{WSGG}} = \\left| q''_{1,\\mathrm{WSGG}} - q''_{1,\\mathrm{LBL}} \\right| / \\left| q''_{1,\\mathrm{LBL}} \\right|$。\n\n所有物理单位必须遵守：\n- 长度 $L$ 以 $\\mathrm{m}$ 为单位。\n- 吸收系数 $\\kappa$ 以 $\\mathrm{m}^{-1}$ 为单位。\n- 温度以 $\\mathrm{K}$ 为单位。\n- 热流密度 $q''$ 以 $\\mathrm{W\\, m^{-2}}$ 为单位。\n\n角度积分必须在入射半球上进行，单位为弧度。\n\n从基本定律和定义出发，根据辐射传递方程和所述的模型假设来一致地实现上述内容。不要引入任何与非散射、等温、平面平行假设相矛盾的闭合关系或公式。\n\n测试套件：\n为以下三个测试用例提供结果，每个用例表示为一组参数。在每个用例中，逐线集合是一个由数对 $(\\kappa_j, W_j)$ 组成的列表。\n\n- 用例 1 (光学薄趋势):\n  - $L = 0.1 \\,\\mathrm{m}$, $T_g = 1800 \\,\\mathrm{K}$, $T_{w,1} = 1600 \\,\\mathrm{K}$, $T_{w,2} = 1400 \\,\\mathrm{K}$。\n  - 灰体: $\\kappa_{\\text{gray}} = 0.05 \\,\\mathrm{m}^{-1}$。\n  - 四组分WSGG: $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.1, 0.15), (0.5, 0.15), (2.0, 0.07), (10.0, 0.03)\\}$, 透明气体权重 $w_0 = 0.60$。\n  - LBL集合 $\\{(\\kappa_j, W_j)\\}_{j=1}^{5} = \\{(0.0, 0.55), (0.05, 0.20), (0.5, 0.15), (3.0, 0.07), (15.0, 0.03)\\}$。\n\n- 用例 2 (中等光学厚度):\n  - $L = 1.0 \\,\\mathrm{m}$, $T_g = 1800 \\,\\mathrm{K}$, $T_{w,1} = 1500 \\,\\mathrm{K}$, $T_{w,2} = 1200 \\,\\mathrm{K}$。\n  - 灰体: $\\kappa_{\\text{gray}} = 0.3 \\,\\mathrm{m}^{-1}$。\n  - 四组分WSGG: $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.02, 0.20), (0.1, 0.30), (0.5, 0.35), (2.0, 0.10)\\}$, 透明气体权重 $w_0 = 0.05$。\n  - LBL集合 $\\{(\\kappa_j, W_j)\\}_{j=1}^{5} = \\{(0.0, 0.05), (0.02, 0.15), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20)\\}$。\n\n- 用例 3 (光学厚趋势):\n  - $L = 3.0 \\,\\mathrm{m}$, $T_g = 2000 \\,\\mathrm{K}$, $T_{w,1} = 1700 \\,\\mathrm{K}$, $T_{w,2} = 1300 \\,\\mathrm{K}$。\n  - 灰体: $\\kappa_{\\text{gray}} = 0.7 \\,\\mathrm{m}^{-1}$。\n  - 四组分WSGG: $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.1, 0.25), (0.5, 0.40), (2.0, 0.25), (8.0, 0.08)\\}$, 透明气体权重 $w_0 = 0.02$。\n  - LBL集合 $\\{(\\kappa_j, W_j)\\}_{j=1}^{6} = \\{(0.0, 0.02), (0.01, 0.08), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20), (10.0, 0.10)\\}$。\n\n最终输出格式：\n您的程序应生成单行输出，按以下顺序包含六个误差值\n$$\n[e_{\\mathrm{gray},1}, e_{\\mathrm{WSGG},1}, e_{\\mathrm{gray},2}, e_{\\mathrm{WSGG},2}, e_{\\mathrm{gray},3}, e_{\\mathrm{WSGG},3}],\n$$\n以逗号分隔的列表形式，并用方括号括起来。每个条目必须是四舍五入到六位有效数字的小数（可接受科学记数法或定点记数法）。无单位的误差必须以小数形式表示（不要使用百分号）。",
            "solution": "我们从平面平行板中非散射、等温介质的辐射传递方程（RTE）开始。设气体是均匀的，吸收系数为 $\\kappa$，温度为 $T_g$，由位于 $x=0$（壁面1，温度为 $T_{w,1}$）和 $x=L$（壁面2，温度为 $T_{w,2}$）的黑体壁面所包围。相对于壁面1外法线的方向余弦为 $\\mu = \\cos\\theta \\in [-1,1]$。\n\n沿射线的光谱RTE为\n$$\n\\frac{d I_\\nu(x,\\mu)}{ds} = -\\kappa_\\nu I_\\nu(x,\\mu) + \\kappa_\\nu I_{b,\\nu}(T_g),\n$$\n对于从内部射向壁面1的强度，其沿入射方向（即方向余弦为负，此处记为 $-\\mu$，其中 $\\mu \\in (0,1)$）的形式解，可通过从相对边界 $x=L$ 沿长度为 $L/\\mu$ 的路径向 $x=0$ 积分得到：\n$$\nI_\\nu(0, -\\mu) = I_{b,\\nu}(T_{w,2}) \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right) + \\int_{0}^{L/\\mu} \\kappa_\\nu I_{b,\\nu}(T_g) \\exp\\!\\left[-\\kappa_\\nu s\\right] \\, ds.\n$$\n由于气体是等温的，$I_{b,\\nu}(T_g)$ 沿路径为常数，积分计算结果为\n$$\n\\int_{0}^{L/\\mu} \\kappa_\\nu I_{b,\\nu}(T_g) \\exp(-\\kappa_\\nu s)\\, ds = I_{b,\\nu}(T_g)\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right)\\right].\n$$\n因此，壁面1处的入射光谱强度为\n$$\nI_\\nu(0, -\\mu) = I_{b,\\nu}(T_{w,2}) \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right) + I_{b,\\nu}(T_g)\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right)\\right].\n$$\n\n为获得频率积分强度，我们对所有光谱子集进行积分。对于将光谱离散为 $M$ 个组的模型，每个组由索引 $m$、吸收系数 $\\kappa_m$ 和权重 $w_m$（满足 $\\sum_{m=1}^M w_m = 1$）表示，假设每个组在其权重范围内表现为灰气体，且 $I_b(T) = \\sigma T^4/\\pi$，则入射的组平均强度为\n$$\nI_m(0, -\\mu) = \\frac{\\sigma T_{w,2}^4}{\\pi} \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) + \\frac{\\sigma T_g^4}{\\pi} \\left[1 - \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right)\\right].\n$$\n对于 $\\kappa=0$ 的透明气体组，该式简化为 $I_{\\text{clear}}(0,-\\mu) = \\frac{\\sigma T_{w,2}^4}{\\pi}$，且不发射辐射。\n\n壁面1上的半球入射辐射是对入射半球的积分：\n$$\nH_1 = \\int_{\\Omega^-} I(\\mathbf{x}_w,\\mathbf{s}) \\left|\\mathbf{s}\\cdot\\mathbf{n}\\right| d\\Omega = 2\\pi \\int_{0}^{1} \\left[ \\sum_{m=1}^{M} w_m \\, I_m(0,-\\mu) \\right] \\mu \\, d\\mu,\n$$\n其中，关于壁面法线的轴对称性允许将积分简化为关于 $\\mu$ 的一维积分，并带上因子 $2\\pi$。\n\n对于黑体壁面，离开壁面1的净辐射热流密度为其发射功率与入射辐射之差：\n$$\nq''_1 = \\sigma T_{w,1}^4 - H_1.\n$$\n\n现在我们将此框架应用于每个模型：\n- 对于灰体模型，只有一个组，即 $M=1$, $w_1=1$, 且 $\\kappa_1 = \\kappa_{\\text{gray}}$。\n- 对于四组分灰气体加权和（WSGG）模型，包括透明气体在内共有五个有效组：$M=5$，其中 $\\kappa_0 = 0$, $w_0 = 1 - \\sum_{i=1}^4 w_i$, 以及指定的 $\\{(\\kappa_i,w_i)\\}_{i=1}^4$。\n- 对于逐线（LBL）参考模型，离散的谱线或谱带直接用作分组：$M=N$, $\\kappa_m = \\kappa_j$, $w_m = W_j$。\n\n每个测试用例的算法步骤如下：\n1. 对 $T=T_g$ 和 $T=T_{w,2}$ 计算 $I_b(T) = \\sigma T^4 / \\pi$。\n2. 定义入射辐射的被积函数：\n   $$\n   \\Phi(\\mu) = \\mu \\sum_{m=1}^{M} w_m \\left[ \\frac{\\sigma T_{w,2}^4}{\\pi} \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) + \\frac{\\sigma T_g^4}{\\pi} \\left( 1 - \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) \\right) \\right].\n   $$\n3. 使用在 $\\mu \\in (0,1)$ 上的自适应求积法数值计算 $H_1 = 2\\pi \\int_0^1 \\Phi(\\mu) \\, d\\mu$；被积函数是良态的，因为当 $\\mu \\to 0^+$ 时，因子 $\\mu$ 与一个指数级小的项相乘，确保了可积性。\n4. 计算 $q''_1 = \\sigma T_{w,1}^4 - H_1$。\n5. 将上述步骤应用于LBL集合以获得 $q''_{1,\\mathrm{LBL}}$，应用于灰体集合以获得 $q''_{1,\\mathrm{gray}}$，并应用于WSGG集合（包括透明气体组）以获得 $q''_{1,\\mathrm{WSGG}}$。\n6. 计算相对误差：\n   $$\n   e_{\\mathrm{gray}} = \\frac{\\left| q''_{1,\\mathrm{gray}} - q''_{1,\\mathrm{LBL}} \\right|}{\\left| q''_{1,\\mathrm{LBL}} \\right|}, \\quad\n   e_{\\mathrm{WSGG}} = \\frac{\\left| q''_{1,\\mathrm{WSGG}} - q''_{1,\\mathrm{LBL}} \\right|}{\\left| q''_{1,\\mathrm{LBL}} \\right|}.\n   $$\n\n在每个步骤中都保持单位一致：$I_b$ 的单位是 $\\mathrm{W\\, m^{-2}\\, sr^{-1}}$，角度积分产生 $\\mathrm{W\\, m^{-2}}$，而 $q''_1$ 的单位是 $\\mathrm{W\\, m^{-2}}$。无量纲误差以小数形式报告。\n\n对于测试套件：\n- 用例1的特点是，在许多组中光学厚度因子 $\\kappa L$ 较小，接近于透射占主导的极限行为，此时 $q''_1 \\to \\sigma (T_{w,1}^4 - T_{w,2}^4)$。\n- 用例2表现出中等光学厚度，平衡了气体自发射和壁面间的透射。\n- 用例3在大多数组中是光学厚的，接近于类扩散极限，此时 $H_1 \\to \\sigma T_g^4$ 且 $q''_1 \\to \\sigma (T_{w,1}^4 - T_g^4)$。\n\n数值考虑：\n- 对于有限的 $\\kappa L$，被积函数 $\\Phi(\\mu)$ 在 $(0,1]$ 上是光滑的，并且当 $\\mu \\to 0^+$ 时趋于 $0$，因为 $\\mu \\exp(-\\kappa L/\\mu)$ 比任何代数速率都更快地趋于 $0$。\n- 使用绝对和相对容差在 $10^{-10}$ 数量级的自适应求积（例如，通过 $\\int_0^1$ 的实现方式使用高斯-克朗罗德方法）可确保准确性。\n\n该程序为三个指定的用例实现了这些步骤，并打印一行包含六个误差值 $[e_{\\mathrm{gray},1}, e_{\\mathrm{WSGG},1}, e_{\\mathrm{gray},2}, e_{\\mathrm{WSGG},2}, e_{\\mathrm{gray},3}, e_{\\mathrm{WSGG},3}]$ 的内容，每个值都四舍五入到六位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Stefan–Boltzmann constant (W/m^2/K^4)\nSIGMA = 5.670374419e-8\n\ndef blackbody_intensity(T):\n    \"\"\"Frequency-integrated blackbody intensity Ib = sigma*T^4/pi (W/m^2/sr).\"\"\"\n    return SIGMA * (T ** 4) / np.pi\n\ndef incident_radiation_on_wall(L, Tg, Tw2, kappas, weights):\n    \"\"\"\n    Compute hemispherical incident radiation H1 on wall 1 due to the gas and wall 2\n    for a set of spectral groups with absorption coefficients 'kappas' (1/m)\n    and corresponding weights 'weights' (sum to 1).\n    \"\"\"\n    Ib_g = blackbody_intensity(Tg)\n    Ib_w2 = blackbody_intensity(Tw2)\n\n    # Define integrand in mu for H1 = 2*pi * integral_0^1 [ Phi(mu) dmu ]\n    def phi(mu):\n        # Avoid mu=0 exactly; quad won't evaluate at endpoints by default.\n        # Contribution for each group m: w_m * [ Ib_w2 * exp(-kappa_m*L/mu) + Ib_g*(1 - exp(...)) ]\n        # Multiply by mu for projection.\n        s = 0.0\n        for kappa, w in zip(kappas, weights):\n            if kappa == 0.0:\n                # Clear gas: exp(0)=1, emission term zero\n                term = Ib_w2\n            else:\n                att = np.exp(- (kappa * L) / mu)\n                term = Ib_w2 * att + Ib_g * (1.0 - att)\n            s += w * term\n        return mu * s\n\n    # Perform the angular integration\n    H1, _ = quad(phi, 0.0, 1.0, epsabs=1e-10, epsrel=1e-10, limit=200)\n    H1 *= 2.0 * np.pi\n    return H1\n\ndef wall_heat_flux(L, Tg, Tw1, Tw2, kappas, weights):\n    \"\"\"Compute net radiative heat flux leaving wall 1: q1'' = sigma*Tw1^4 - H1.\"\"\"\n    H1 = incident_radiation_on_wall(L, Tg, Tw2, kappas, weights)\n    q = SIGMA * (Tw1 ** 4) - H1\n    return q\n\ndef compute_errors_for_case(case):\n    \"\"\"\n    Given a case dict with keys:\n        L, Tg, Tw1, Tw2, k_gray, wsgg_weights, wsgg_kappas, ref_lines (list of (kappa, weight))\n    compute the relative errors for gray and WSGG vs LBL reference.\n    \"\"\"\n    L = case['L']\n    Tg = case['Tg']\n    Tw1 = case['Tw1']\n    Tw2 = case['Tw2']\n\n    # Reference (LBL) flux\n    ref_pairs = case['ref_lines']\n    ref_kappas = np.array([p[0] for p in ref_pairs], dtype=float)\n    ref_weights = np.array([p[1] for p in ref_pairs], dtype=float)\n    ref_weights = ref_weights / np.sum(ref_weights)\n    q_ref = wall_heat_flux(L, Tg, Tw1, Tw2, ref_kappas, ref_weights)\n\n    # Gray model\n    k_gray = case['k_gray']\n    q_gray = wall_heat_flux(L, Tg, Tw1, Tw2, np.array([k_gray], dtype=float), np.array([1.0], dtype=float))\n\n    # WSGG model (include clear gas group)\n    wsgg_kappas = np.array(case['wsgg_kappas'], dtype=float)\n    wsgg_weights = np.array(case['wsgg_weights'], dtype=float)\n    w_clear = 1.0 - np.sum(wsgg_weights)\n    # Append clear gas group\n    wsgg_kappas_full = np.concatenate((np.array([0.0], dtype=float), wsgg_kappas))\n    wsgg_weights_full = np.concatenate((np.array([w_clear], dtype=float), wsgg_weights))\n    # Normalize defensively to handle any small rounding\n    wsgg_weights_full = wsgg_weights_full / np.sum(wsgg_weights_full)\n    q_wsgg = wall_heat_flux(L, Tg, Tw1, Tw2, wsgg_kappas_full, wsgg_weights_full)\n\n    # Relative errors\n    denom = abs(q_ref) if abs(q_ref)  0 else 1.0  # guard, though q_ref != 0 in these cases\n    e_gray = abs(q_gray - q_ref) / denom\n    e_wsgg = abs(q_wsgg - q_ref) / denom\n\n    return e_gray, e_wsgg\n\ndef format_float(x):\n    # Six significant digits; choose scientific notation to be consistent across magnitudes\n    return f\"{x:.6g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'L': 0.1,\n            'Tg': 1800.0,\n            'Tw1': 1600.0,\n            'Tw2': 1400.0,\n            'k_gray': 0.05,\n            'wsgg_kappas': [0.1, 0.5, 2.0, 10.0],\n            'wsgg_weights': [0.15, 0.15, 0.07, 0.03],  # sum 0.40, clear weight 0.60\n            'ref_lines': [(0.0, 0.55), (0.05, 0.20), (0.5, 0.15), (3.0, 0.07), (15.0, 0.03)],\n        },\n        {\n            'L': 1.0,\n            'Tg': 1800.0,\n            'Tw1': 1500.0,\n            'Tw2': 1200.0,\n            'k_gray': 0.3,\n            'wsgg_kappas': [0.02, 0.1, 0.5, 2.0],\n            'wsgg_weights': [0.20, 0.30, 0.35, 0.10],  # sum 0.95, clear weight 0.05\n            'ref_lines': [(0.0, 0.05), (0.02, 0.15), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20)],\n        },\n        {\n            'L': 3.0,\n            'Tg': 2000.0,\n            'Tw1': 1700.0,\n            'Tw2': 1300.0,\n            'k_gray': 0.7,\n            'wsgg_kappas': [0.1, 0.5, 2.0, 8.0],\n            'wsgg_weights': [0.25, 0.40, 0.25, 0.08],  # sum 0.98, clear weight 0.02\n            'ref_lines': [(0.0, 0.02), (0.01, 0.08), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20), (10.0, 0.10)],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        e_gray, e_wsgg = compute_errors_for_case(case)\n        results.extend([e_gray, e_wsgg])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(format_float(x) for x in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "该领域的真正挑战在于将辐射模型耦合回流体流动和燃烧的控制方程中。辐射热损失会显著改变火焰结构和温度，而温度是决定燃烧效率和污染物生成的关键参数。最后的这个练习  演示了这种耦合过程，要求您求解包含光学薄辐射损失项的火焰能量平衡方程。您将确定最终的火焰温度，并量化其相对于理想绝热情况的降低值，从而直接观察到辐射对燃烧系统的实际影响。",
            "id": "4015157",
            "problem": "考虑一个稳定的一维预混甲烷-空气火焰，其由厚度为 $L$、单位横截面积的控制体表示。流入的混合物的主流速度为 $U$，压力为 $p$，入口温度为 $T_{\\mathrm{in}}$。在绝热极限下，产物达到绝热火焰温度 $T_{\\mathrm{ad}}$。当包含光学薄辐射时，产物向温度为 $T_{\\mathrm{env}}$ 的环境损失能量，导致出口温度降低至 $T_{\\mathrm{rad}}$。您必须计算温降 $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$。\n\n从基本定律出发：\n- 对于稳定的一维控制体，能量守恒意味着净焓升等于化学放热减去任何热损失。绝热放热表示为 $m\\dot{}\\,c_p\\,(T_{\\mathrm{ad}} - T_{\\mathrm{in}})$，则非绝热出口温度满足\n$$\nm\\dot{}\\,c_p\\,(T_{\\mathrm{rad}} - T_{\\mathrm{in}}) \\;=\\; m\\dot{}\\,c_p\\,(T_{\\mathrm{ad}} - T_{\\mathrm{in}}) \\;-\\; Q_{\\mathrm{rad}}(T_{\\mathrm{rad}}),\n$$\n可重排为以下隐式方程\n$$\nT_{\\mathrm{ad}} - T_{\\mathrm{rad}} \\;=\\; \\frac{Q_{\\mathrm{rad}}(T_{\\mathrm{rad}})}{m\\dot{}\\,c_p},\n$$\n其中 $m\\dot{} = \\rho\\,U$ 是单位面积的质量通量，$\\rho$ 是产物气体密度，$c_p$ 是定压比热。对于产物混合物，$c_p$ 取为常数 $1200\\ \\mathrm{J/(kg\\cdot K)}$。\n\n- 在光学薄近似下，辐射热通量的散度可建模为\n$$\n\\dot{q}_{\\mathrm{rad}}(T) \\;=\\; 4\\,\\sigma\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big),\n$$\n其中 $\\sigma$ 是 Stefan–Boltzmann 常数，$\\kappa_P(T)$ 是参与气体的普朗克平均吸收系数。对于厚度为 $L$、产物温度 $T$ 近似均匀的平板，单位面积的辐射损失为\n$$\nQ_{\\mathrm{rad}}(T) \\;=\\; \\dot{q}_{\\mathrm{rad}}(T)\\,L \\;=\\; 4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big).\n$$\n\n- 使用水蒸气和二氧化碳的灰体气体加权和 (WSGG) 模型来为 $\\kappa_P(T)$ 建模。设产物的摩尔分数（假定由化学计量的甲烷-空气化学反应确定）为 $X_{\\mathrm{H_2O}} = 2/10.52$ 和 $X_{\\mathrm{CO_2}} = 1/10.52$，产物混合物的摩尔质量为\n$$\n\\bar{M} \\;=\\; 44\\,X_{\\mathrm{CO_2}} + 18\\,X_{\\mathrm{H_2O}} + 28\\,(1 - X_{\\mathrm{CO_2}} - X_{\\mathrm{H_2O}})\\ \\mathrm{g/mol}.\n$$\n使用混合气体常数 $R_{\\mathrm{mix}} = R_u/\\bar{M}$（其中 $R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$），并通过 $p_{\\mathrm{atm}} = p/101325$ 将压力转换为大气压。用以下公式近似 $T_{\\mathrm{ad}}$ 下的密度\n$$\n\\rho \\;=\\; \\frac{p}{R_{\\mathrm{mix}}\\,T_{\\mathrm{ad}}}.\n$$\n\n为每种组分定义三个灰体气体吸收系数（单位为 $\\mathrm{m^{-1}\\,atm^{-1}}$）：\n- 对于水蒸气 ($\\mathrm{H_2O}$)：$k_{\\mathrm{H_2O},1} = 0.2$, $k_{\\mathrm{H_2O},2} = 1.5$, $k_{\\mathrm{H_2O},3} = 13.0$。\n- 对于二氧化碳 ($\\mathrm{CO_2}$)：$k_{\\mathrm{CO_2},1} = 0.1$, $k_{\\mathrm{CO_2},2} = 0.8$, $k_{\\mathrm{CO_2},3} = 8.0$。\n\n设与温度相关的 WSGG 权重（非负且总和为一）为\n$$\n\\begin{aligned}\na_{\\mathrm{H_2O},1}(T) = 0.6 - 10^{-4}\\,(T - 1000),\\\\\na_{\\mathrm{H_2O},2}(T) = 0.3 + 5\\times 10^{-5}\\,(T - 1000),\\\\\na_{\\mathrm{H_2O},3}(T) = 0.1 + 5\\times 10^{-5}\\,(T - 1000),\n\\end{aligned}\n\\qquad\n\\begin{aligned}\na_{\\mathrm{CO_2},1}(T) = 0.7 - 10^{-4}\\,(T - 1000),\\\\\na_{\\mathrm{CO_2},2}(T) = 0.25 + 5\\times 10^{-5}\\,(T - 1000),\\\\\na_{\\mathrm{CO_2},3}(T) = 0.05 + 5\\times 10^{-5}\\,(T - 1000),\n\\end{aligned}\n$$\n组分层级的普朗克平均吸收系数为\n$$\n\\kappa_{\\mathrm{H_2O}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{H_2O}}\\,\\sum_{m=1}^3 a_{\\mathrm{H_2O},m}(T)\\,k_{\\mathrm{H_2O},m},\n\\qquad\n\\kappa_{\\mathrm{CO_2}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{CO_2}}\\,\\sum_{m=1}^3 a_{\\mathrm{CO_2},m}(T)\\,k_{\\mathrm{CO_2},m},\n$$\n使得\n$$\n\\kappa_P(T) \\;=\\; \\kappa_{\\mathrm{H_2O}}(T) + \\kappa_{\\mathrm{CO_2}}(T).\n$$\n\n使用这些关系，通过求解以下方程计算 $T_{\\mathrm{rad}}$\n$$\nf(T) \\;=\\; T_{\\mathrm{ad}} - T \\;-\\; \\frac{4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big)}{\\rho\\,U\\,c_p} \\;=\\; 0,\n$$\n对于 $T\\in[T_{\\mathrm{env}},\\,T_{\\mathrm{ad}}]$，并报告 $\\Delta T = T_{\\mathrm{ad}} - T$。\n\n常数和单位：\n- 使用 $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$，$R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$，$p_0 = 101325\\ \\mathrm{Pa}$。\n- 所有温度以 $\\mathrm{K}$ 表示，压力以 $\\mathrm{Pa}$ 表示，长度以 $\\mathrm{m}$ 表示，速度以 $\\mathrm{m/s}$ 表示，密度以 $\\mathrm{kg/m^3}$ 表示，热量以 $\\mathrm{W/m^2}$ 表示。\n- 最终的温降 $\\Delta T$ 以 K 为单位，表示为浮点数。\n\n测试套件：\n提供以下四个参数集 $(T_{\\mathrm{ad}}, T_{\\mathrm{env}}, p, U, L, T_{\\mathrm{in}})$，以演练典型、高流量、高压和高温环境的情况：\n1. $(2220,\\ 300,\\ 101325,\\ 0.5,\\ 0.010,\\ 300)$\n2. $(2220,\\ 300,\\ 101325,\\ 5.0,\\ 0.010,\\ 300)$\n3. $(2200,\\ 500,\\ 5\\times 101325,\\ 1.0,\\ 0.020,\\ 300)$\n4. $(2300,\\ 800,\\ 101325,\\ 0.1,\\ 0.015,\\ 300)$\n\n最终输出格式：\n你的程序应生成一行输出，其中包含四个温降值，形式为用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4]”），每个值都是一个以 K 为单位的浮点数。",
            "solution": "该问题被评估为具有科学依据、问题明确、客观且自洽。它提出了一个标准的、尽管简化的工程模型，用于计算一维火焰的辐射热损失。控制方程基于能量守恒的基本原理和已建立的辐射传热模型（光学薄近似和灰体气体加权和模型）。所有必要的物理常数、材料属性和测试用例参数都已提供，并且它们的单位是一致的。问题的结构是一个关于温度的非线性代数方程，其目标函数的单调性和边界条件保证了唯一解的存在。因此，该问题被认为是有效的。\n\n核心任务是确定由于稳定一维火焰的辐射损失引起的温降 $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$。经辐射冷却的出口温度 $T_{\\mathrm{rad}}$ 是从控制体能量平衡导出的以下隐式方程的根：\n$$\nf(T) \\;=\\; T_{\\mathrm{ad}} - T \\;-\\; \\frac{Q_{\\mathrm{rad}}(T)}{\\rho\\,U\\,c_p} \\;=\\; 0\n$$\n其中 $T$ 是未知的产物气体温度，我们要求解的即为 $T_{\\mathrm{rad}}$。解必须在物理边界 $T \\in [T_{\\mathrm{env}}, T_{\\mathrm{ad}}]$ 内找到。\n\n求解过程包括几个步骤：\n1. 计算给定测试用例的常数参数。\n2. 定义辐射热损失 $Q_{\\mathrm{rad}}(T)$ 和普朗克平均吸收系数 $\\kappa_P(T)$ 的温度相关函数。\n3. 数值求解方程 $f(T) = 0$ 以得到 $T_{\\mathrm{rad}}$。\n4. 计算最终的温降 $\\Delta T$。\n\n首先，我们计算不依赖于未知温度 $T$ 的参数。化学计量的甲烷-空气燃烧的产物气体摩尔分数为 $X_{\\mathrm{H_2O}} = 2/10.52$ 和 $X_{\\mathrm{CO_2}} = 1/10.52$。产物混合物的平均摩尔质量 $\\bar{M}$ 计算如下：\n$$\n\\bar{M} \\;=\\; 44\\,X_{\\mathrm{CO_2}} + 18\\,X_{\\mathrm{H_2O}} + 28\\,(1 - X_{\\mathrm{CO_2}} - X_{\\mathrm{H_2O}})\\ \\mathrm{g/mol}\n$$\n混合物的比气体常数是 $R_{\\mathrm{mix}} = R_u/\\bar{M}$，其中 $R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$ 是通用气体常数。注意，为保持一致性，$\\bar{M}$ 必须转换为 $\\mathrm{kg/mol}$。产物气体密度 $\\rho$ 使用理想气体定律在绝热火焰温度 $T_{\\mathrm{ad}}$下近似：\n$$\n\\rho \\;=\\; \\frac{p}{R_{\\mathrm{mix}}\\,T_{\\mathrm{ad}}}\n$$\n单位面积的质量通量是 $m\\dot{} = \\rho\\,U$。因此损失项的分母是 $\\rho\\,U\\,c_p$，其中 $c_p = 1200\\ \\mathrm{J/(kg\\cdot K)}$。\n\n其次，我们构建辐射热损失项 $Q_{\\mathrm{rad}}(T)$。在厚度为 $L$ 的平板的光学薄近似下：\n$$\nQ_{\\mathrm{rad}}(T) \\;=\\; 4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big)\n$$\n其中 $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$ 是 Stefan–Boltzmann 常数。普朗克平均吸收系数 $\\kappa_P(T)$ 使用灰体气体加权和 (WSGG) 方法建模。它是水蒸气和二氧化碳贡献的总和：\n$$\n\\kappa_P(T) \\;=\\; \\kappa_{\\mathrm{H_2O}}(T) + \\kappa_{\\mathrm{CO_2}}(T)\n$$\n每个组分的比系数是其分压和温度相关权重的函数：\n$$\n\\kappa_{\\mathrm{H_2O}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{H_2O}}\\,\\sum_{m=1}^3 a_{\\mathrm{H_2O},m}(T)\\,k_{\\mathrm{H_2O},m}\n$$\n$$\n\\kappa_{\\mathrm{CO_2}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\mathrm{CO_2}}\\,\\sum_{m=1}^3 a_{\\mathrm{CO_2},m}(T)\\,k_{\\mathrm{CO_2},m}\n$$\n此处，$p_{\\mathrm{atm}} = p/p_0$ 是以大气压为单位的总压力，$p_0=101325$ Pa。$k_{\\mathrm{species},m}$ 项是在 $\\mathrm{m^{-1}\\,atm^{-1}}$ 中给出的灰体气体吸收系数，$a_{\\mathrm{species},m}(T)$ 是相应的温度相关权重。这些权重以温度 $T$（单位为开尔文）的线性函数形式给出：\n$$\n\\begin{aligned}\na_{\\mathrm{H_2O},1}(T) = 0.6 - 10^{-4}\\,(T - 1000) \\\\\na_{\\mathrm{H_2O},2}(T) = 0.3 + 5\\times 10^{-5}\\,(T - 1000) \\\\\na_{\\mathrm{H_2O},3}(T) = 0.1 + 5\\times 10^{-5}\\,(T - 1000)\n\\end{aligned}\n\\qquad\n\\begin{aligned}\na_{\\mathrm{CO_2},1}(T) = 0.7 - 10^{-4}\\,(T - 1000) \\\\\na_{\\mathrm{CO_2},2}(T) = 0.25 + 5\\times 10^{-5}\\,(T - 1000) \\\\\na_{\\mathrm{CO_2},3}(T) = 0.05 + 5\\times 10^{-5}\\,(T - 1000)\n\\end{aligned}\n$$\n因此，函数 $\\kappa_P(T)$ 是 $T$ 的线性函数。\n\n第三，我们求解 $f(T)=0$。让我们分析区间 $[T_{\\mathrm{env}}, T_{\\mathrm{ad}}]$ 上的函数 $f(T)$。\n在下界 $T = T_{\\mathrm{env}}$ 处，辐射损失项为零，所以 $f(T_{\\mathrm{env}}) = T_{\\mathrm{ad}} - T_{\\mathrm{env}}$。因为 $T_{\\mathrm{ad}}  T_{\\mathrm{env}}$，所以 $f(T_{\\mathrm{env}})  0$。\n在上界 $T = T_{\\mathrm{ad}}$ 处，损失项 $Q_{\\mathrm{rad}}(T_{\\mathrm{ad}})  0$。因此，$f(T_{\\mathrm{ad}}) = T_{\\mathrm{ad}} - T_{\\mathrm{ad}} - Q_{\\mathrm{rad}}(T_{\\mathrm{ad}})/(\\rho\\,U\\,c_p) = -Q_{\\mathrm{rad}}(T_{\\mathrm{ad}})/(\\rho\\,U\\,c_p)  0$。\n导数 $f'(T)$ 由下式给出：\n$$\nf'(T) \\;=\\; -1 \\;-\\; \\frac{4\\,\\sigma\\,L}{\\rho\\,U\\,c_p} \\left[ \\frac{d\\kappa_P(T)}{dT}\\big(T^4 - T_{\\mathrm{env}}^4\\big) + \\kappa_P(T)\\,(4T^3) \\right]\n$$\n项 $d\\kappa_P(T)/dT$ 是一个正常数，并且对于 $T  T_{\\mathrm{env}}$，括号中的所有其他项都是正的。因此，对于区间内的所有 $T$，$f'(T)  -1$。\n由于 $f(T)$ 是连续且严格单调递减的，并且它在区间 $[T_{\\mathrm{env}}, T_{\\mathrm{ad}}]$ 上变号，因此保证在 $(T_{\\mathrm{env}}, T_{\\mathrm{ad}})$ 中存在唯一的根 $T_{\\mathrm{rad}}$。这个根可以使用数值求根算法高效地找到，例如 Brent-Dekker 方法（在 SciPy 中为 `brentq`）。\n\n最后，一旦找到 $T_{\\mathrm{rad}}$，温降就计算为 $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$。对四个测试用例中的每一个重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Calculates the temperature reduction in a premixed flame due to\n    optically thin radiation, for a series of test cases.\n    \"\"\"\n    # Define constants\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant, W/(m^2*K^4)\n    RU = 8.314             # Universal gas constant, J/(mol*K)\n    P0 = 101325.0          # Standard pressure, Pa\n    CP = 1200.0            # Specific heat of products, J/(kg*K)\n\n    # WSGG model parameters\n    # Mole fractions\n    X_H2O = 2.0 / 10.52\n    X_CO2 = 1.0 / 10.52\n    \n    # Gray-gas absorption coefficients, m^-1*atm^-1\n    K_H2O = np.array([0.2, 1.5, 13.0])\n    K_CO2 = np.array([0.1, 0.8, 8.0])\n\n    # Test cases: (T_ad, T_env, p, U, L, T_in)\n    test_cases = [\n        (2220.0, 300.0, 101325.0, 0.5, 0.010, 300.0),\n        (2220.0, 300.0, 101325.0, 5.0, 0.010, 300.0),\n        (2200.0, 500.0, 5.0 * 101325.0, 1.0, 0.020, 300.0),\n        (2300.0, 800.0, 101325.0, 0.1, 0.015, 300.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T_ad, T_env, p, U, L, T_in = case\n\n        # --- 1. Calculate constant parameters ---\n        # Molar mass of product mixture, M_bar (kg/mol)\n        # Molar masses: CO2=44, H2O=18, N2=28 g/mol\n        m_bar_g = 44.0 * X_CO2 + 18.0 * X_H2O + 28.0 * (1.0 - X_CO2 - X_H2O)\n        m_bar_kg = m_bar_g / 1000.0 # Convert to kg/mol\n        \n        # Mixture-specific gas constant, R_mix (J/(kg*K))\n        R_mix = RU / m_bar_kg\n        \n        # Density of products at T_ad, rho (kg/m^3)\n        rho = p / (R_mix * T_ad)\n        \n        # Mass flux, m_dot (kg/(m^2*s))\n        m_dot = rho * U\n        \n        # Pressure in atmospheres (dimensionless)\n        p_atm = p / P0\n\n        # --- 2. Define temperature-dependent functions ---\n        def kappa_P(T):\n            \"\"\"Calculates the Planck-mean absorption coefficient kappa_P(T) in m^-1.\"\"\"\n            T_ref_diff = T - 1000.0\n            \n            # H2O WSGG weights\n            a_H2O_1 = 0.6 - 1e-4 * T_ref_diff\n            a_H2O_2 = 0.3 + 5e-5 * T_ref_diff\n            a_H2O_3 = 1.0 - a_H2O_1 - a_H2O_2 # Ensures sum is 1\n            a_H2O = np.array([a_H2O_1, a_H2O_2, a_H2O_3])\n            \n            # CO2 WSGG weights\n            a_CO2_1 = 0.7 - 1e-4 * T_ref_diff\n            a_CO2_2 = 0.25 + 5e-5 * T_ref_diff\n            a_CO2_3 = 1.0 - a_CO2_1 - a_CO2_2 # Ensures sum is 1\n            a_CO2 = np.array([a_CO2_1, a_CO2_2, a_CO2_3])\n\n            # Species-level absorption coefficients, kappa_i (m^-1)\n            # p_atm * X is the partial pressure in atm\n            kappa_H2O = p_atm * X_H2O * np.sum(a_H2O * K_H2O)\n            kappa_CO2 = p_atm * X_CO2 * np.sum(a_CO2 * K_CO2)\n            \n            return kappa_H2O + kappa_CO2\n\n        def f(T):\n            \"\"\"The function f(T) = 0 to be solved for T_rad.\"\"\"\n            # Radiative heat loss per unit area, Q_rad (W/m^2)\n            Q_rad = 4.0 * SIGMA * L * kappa_P(T) * (T**4 - T_env**4)\n            \n            # Energy balance equation\n            heat_loss_term = Q_rad / (m_dot * CP)\n            \n            return T_ad - T - heat_loss_term\n\n        # --- 3. Solve for T_rad ---\n        # The root is bracketed by T_env and T_ad\n        T_rad = brentq(f, a=T_env, b=T_ad)\n\n        # --- 4. Compute delta T ---\n        delta_T = T_ad - T_rad\n        results.append(delta_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}