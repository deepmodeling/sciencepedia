{
    "hands_on_practices": [
        {
            "introduction": "在反应流中，温度变化范围可达数千开尔文，这使得材料属性（如热导率）随温度显著变化。此练习通过一个共轭传热问题，量化了在高温条件下使用恒定物性假设所带来的误差。通过推导和求解变物性与恒定物性两种模型下的壁面热流，您将深刻理解为何精确的物性建模对于燃烧系统中的预测性仿真是至关重要的 。",
            "id": "4014016",
            "problem": "高温反应气体流过一个冷却的金属壁。反应区离壁面足够远，因此在厚度为 $\\delta$ 的近壁区域内，没有均匀的热释放，穿过该流体膜的能量传递由稳态一维传导主导。膜外的气体温度为 $T_{b}$，壁面温度为 $T_{w}$，固体壁内表面的冷却剂温度为 $T_{c}$。该气体的热导率 $k(T)$ 随温度变化，其关系为 $k(T) = k_{0}\\left(\\frac{T}{T_{0}}\\right)^{n}$，其中 $n=1$。固体壁是一个厚度为 $L_{s}$、热导率为常数 $k_{s}$ 的平板，它将热量一维地传导至冷却剂。\n\n假设近壁膜内为稳态，无辐射，且粘性耗散可忽略不计。在这种共轭传热配置中，热通量 $q''$ 在流固界面上是连续的，壁面温度 $T_{w}$ 会自行调整以同时满足流体和固体的传导条件。从稳态一维能量方程和傅里叶定律出发，推导在变物性情况下（$k(T)$ 如指定）和常物性近似情况下（假设流体膜的 $k$ 等于参考值 $k_{0}$）联系 $q''$ 和 $T_{w}$ 的表达式。使用以下数据：\n- $T_{b} = 2200\\,\\text{K}$，\n- $T_{c} = 300\\,\\text{K}$，\n- $k_{0} = 0.12\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$，\n- $T_{0} = 1000\\,\\text{K}$，\n- $n = 1$，\n- $\\delta = 2.0\\times 10^{-4}\\,\\text{m}$，\n- $k_{s} = 15\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$，\n- $L_{s} = 5.0\\times 10^{-3}\\,\\text{m}$，\n\n计算由常物性假设引起的壁面热通量的相对偏差，定义为无量纲量\n$$\\varepsilon = \\frac{|q''_{\\text{const}} - q''_{\\text{var}}|}{q''_{\\text{var}}},$$\n其中 $q''_{\\text{var}}$ 是使用变物性公式 $k(T) = k_{0}\\left(\\frac{T}{T_{0}}\\right)$ 得到的壁面热通量，而 $q''_{\\text{const}}$ 是使用常物性近似 $k = k_{0}$ 得到的壁面热通量。\n\n将 $\\varepsilon$ 的最终答案表示为小数，并四舍五入到四位有效数字。由于 $\\varepsilon$ 是无量纲的，因此不需要单位。",
            "solution": "该场景是一个涉及反应气体的共轭传热问题，但近壁膜是无反应且稳态的。我们从控制热传导的基本定律开始。在流体膜中，无内部热源的稳态一维能量平衡得出\n$$\\frac{d}{dy}\\left(k(T)\\frac{dT}{dy}\\right) = 0,$$\n这意味着 $k(T)\\frac{dT}{dy}$ 在整个膜上是一个常数。根据傅里叶定律，壁面热通量 $q''$ 为\n$$q'' = -k(T)\\frac{dT}{dy}.$$\n因此，$k(T)\\frac{dT}{dy} = -q''$ 并且\n$$\\frac{dT}{dy} = -\\frac{q''}{k(T)}.$$\n分离变量并从壁面（$y=0$, $T=T_{w}$）积分到膜的边缘（$y=\\delta$, $T=T_{b}$），得到\n$$\\int_{0}^{\\delta} dy = \\int_{T_{w}}^{T_{b}} \\frac{k(T)}{q''}\\, dT,$$\n所以\n$$\\delta = \\frac{1}{q''}\\int_{T_{w}}^{T_{b}} k(T)\\, dT.$$\n这就得出了具有可变热导率的纯传导膜的一般关系式，\n$$q'' = \\frac{1}{\\delta}\\int_{T_{w}}^{T_{b}} k(T)\\, dT.$$\n\n在固体壁内，向冷却剂的一维稳态传导产生的热通量为\n$$q'' = \\frac{k_{s}}{L_{s}}(T_{w} - T_{c}),$$\n根据界面处的连续性，该热通量必须等于流体侧的热通量。\n\n变物性流体情况：当 $k(T) = k_{0}\\left(\\frac{T}{T_{0}}\\right)$ 时，积分为\n$$\\int_{T_{w}}^{T_{b}} k(T)\\, dT = \\int_{T_{w}}^{T_{b}} k_{0}\\frac{T}{T_{0}}\\, dT = \\frac{k_{0}}{T_{0}}\\left[\\frac{T^{2}}{2}\\right]_{T_{w}}^{T_{b}} = \\frac{k_{0}}{2 T_{0}}\\left(T_{b}^{2} - T_{w}^{2}\\right).$$\n因此，\n$$q''_{\\text{var}} = \\frac{k_{0}}{2 T_{0} \\delta}\\left(T_{b}^{2} - T_{w}^{2}\\right).$$\n与固体的共轭匹配条件给出\n$$\\frac{k_{0}}{2 T_{0} \\delta}\\left(T_{b}^{2} - T_{w}^{2}\\right) = \\frac{k_{s}}{L_{s}}(T_{w} - T_{c}).$$\n定义\n$$a = \\frac{k_{0}}{2 T_{0} \\delta}, \\quad b = \\frac{k_{s}}{L_{s}},$$\n因此方程变为\n$$a\\left(T_{b}^{2} - T_{w}^{2}\\right) = b\\left(T_{w} - T_{c}\\right).$$\n整理成关于 $T_{w}$ 的二次方程，\n$$a T_{w}^{2} + b T_{w} - \\left(a T_{b}^{2} + b T_{c}\\right) = 0.$$\n求解 $T_{w}$，\n$$T_{w,\\text{var}} = \\frac{-b + \\sqrt{b^{2} + 4 a\\left(a T_{b}^{2} + b T_{c}\\right)}}{2 a},$$\n其中取正分支以确保 $T_{w}$ 位于 $T_{c}$ 和 $T_{b}$ 之间。\n\n常物性流体情况：假设在整个膜内 $k(T) = k_{0}$。那么流体侧的热通量为\n$$q''_{\\text{const}} = \\frac{k_{0}}{\\delta}\\left(T_{b} - T_{w}\\right).$$\n与固体的共轭匹配条件给出\n$$\\frac{k_{0}}{\\delta}\\left(T_{b} - T_{w}\\right) = \\frac{k_{s}}{L_{s}}(T_{w} - T_{c}).$$\n求解 $T_{w}$，\n$$\\left(b + \\frac{k_{0}}{\\delta}\\right) T_{w} = \\frac{k_{0}}{\\delta} T_{b} + b T_{c},$$\n所以\n$$T_{w,\\text{const}} = \\frac{\\left(\\frac{k_{0}}{\\delta}\\right) T_{b} + b T_{c}}{b + \\frac{k_{0}}{\\delta}}.$$\n\n使用给定的参数，\n$$T_{b} = 2200,\\quad T_{c} = 300,\\quad k_{0} = 0.12,\\quad T_{0} = 1000,\\quad \\delta = 2.0\\times 10^{-4},\\quad k_{s} = 15,\\quad L_{s} = 5.0\\times 10^{-3},$$\n计算\n$$a = \\frac{0.12}{2 \\cdot 1000 \\cdot 2.0\\times 10^{-4}} = \\frac{0.12}{0.4} = 0.3,$$\n$$b = \\frac{15}{5.0\\times 10^{-3}} = 3000.$$\n\n变物性壁面温度：\n$$T_{w,\\text{var}} = \\frac{-3000 + \\sqrt{3000^{2} + 4 \\cdot 0.3\\left(0.3 \\cdot 2200^{2} + 3000 \\cdot 300\\right)}}{2 \\cdot 0.3}.$$\n计算内部各项：\n$$0.3 \\cdot 2200^{2} = 0.3 \\cdot 4{,}840{,}000 = 1{,}452{,}000,$$\n$$3000 \\cdot 300 = 900{,}000,$$\n$$a T_{b}^{2} + b T_{c} = 1{,}452{,}000 + 900{,}000 = 2{,}352{,}000,$$\n$$b^{2} + 4 a\\left(a T_{b}^{2} + b T_{c}\\right) = 9{,}000{,}000 + 4 \\cdot 0.3 \\cdot 2{,}352{,}000 = 9{,}000{,}000 + 2{,}822{,}400 = 11{,}822{,}400,$$\n$$\\sqrt{11{,}822{,}400} \\approx 3438.3715.$$\n因此，\n$$T_{w,\\text{var}} \\approx \\frac{-3000 + 3438.3715}{0.6} \\approx \\frac{438.3715}{0.6} \\approx 730.6192.$$\n\n通过固体传导计算的变物性热通量：\n$$q''_{\\text{var}} = b\\left(T_{w,\\text{var}} - T_{c}\\right) \\approx 3000 \\cdot (730.6192 - 300) \\approx 3000 \\cdot 430.6192 \\approx 1{,}291{,}858.7.$$\n\n常物性壁面温度：\n$$\\frac{k_{0}}{\\delta} = \\frac{0.12}{2.0\\times 10^{-4}} = 600,$$\n$$T_{w,\\text{const}} = \\frac{600 \\cdot 2200 + 3000 \\cdot 300}{3000 + 600} = \\frac{1{,}320{,}000 + 900{,}000}{3600} = \\frac{2{,}220{,}000}{3600} \\approx 616.6667.$$\n\n常物性热通量：\n$$q''_{\\text{const}} = b\\left(T_{w,\\text{const}} - T_{c}\\right) = 3000 \\cdot (616.6667 - 300) = 3000 \\cdot 316.6667 = 950{,}000.$$\n\n相对偏差：\n$$\\varepsilon = \\frac{|q''_{\\text{const}} - q''_{\\text{var}}|}{q''_{\\text{var}}} = \\frac{1{,}291{,}858.7 - 950{,}000}{1{,}291{,}858.7} \\approx \\frac{341{,}858.7}{1{,}291{,}858.7} \\approx 0.2646.$$\n\n四舍五入到四位有效数字，无量纲偏差为 $0.2646$。",
            "answer": "$$\\boxed{0.2646}$$"
        },
        {
            "introduction": "在建立物理模型后，我们需要对其进行数值求解。显式时间推进格式因其简单易于实现而被广泛使用，但其稳定性受到严格限制。本练习将指导您从离散方程出发，为共轭传热问题中的显式求解器推导对流项的Courant-Friedrichs-Lewy (CFL)条件以及扩散项的稳定性约束。这个练习对于计算流体力学从业者至关重要，它为选择稳定时间步长提供了理论基础，以确保数值解的收敛性 。",
            "id": "4013967",
            "problem": "一个含有反应气体的矩形通道与一个固体壁面处于共轭接触状态。在物性恒定和辐射交换可忽略的假设下，气体和固体的能量方程分别由能量守恒给出，其形式为：流体中为 $ \\rho c_{p} \\, \\frac{\\partial T}{\\partial t} + \\rho c_{p} \\, \\boldsymbol{u} \\cdot \\nabla T = \\nabla \\cdot \\left( k \\nabla T \\right) + \\dot{q}$，固体中为 $ \\rho_{s} c_{p,s} \\, \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left( k_{s} \\nabla T \\right)$。共轭界面强制要求温度和法向热通量的连续性。考虑在两个区域中使用时间上的一阶向前欧拉法对温度进行显式、单步、非分裂的更新。在流体中，对流项采用一阶迎风差分格式离散，扩散项采用二阶中心差分格式离散。在固体中，只存在扩散项，并采用相同的离散方式。为了进行此稳定性分析，假设化学源项 $ \\dot{q}$ 的处理方式不会比对流或扩散施加更严格的时间步长限制。\n\n从上述守恒陈述和给定的离散格式出发，推导在三维均匀笛卡尔网格上，为保证此显式共轭求解器稳定性所必须满足的 Courant–Friedrichs–Lewy (CFL) 对流约束和显式扩散约束。你的推导必须从向前欧拉法和空间离散所隐含的离散更新方程开始，并在不引用任何预先记忆的公式的情况下，证明这些约束的形式。\n\n然后，对于以下科学上合理的物性参数集和网格，计算同时满足这两个约束的最大允许时间步长。使用流体和固体区域中最严格的约束。\n\n流体区域：\n- 网格间距为 $ \\Delta x_{f} = 5.0 \\times 10^{-4} \\ \\mathrm{m}$，$ \\Delta y_{f} = 2.5 \\times 10^{-4} \\ \\mathrm{m}$ 和 $ \\Delta z_{f} = 1.0 \\times 10^{-3} \\ \\mathrm{m}$。\n- 速度分量为 $ u_{x} = 25 \\ \\mathrm{m/s}$，$ u_{y} = 2 \\ \\mathrm{m/s}$ 和 $ u_{z} = 0 \\ \\mathrm{m/s}$。\n- 热物理性质为 $ \\rho_{f} = 1.2 \\ \\mathrm{kg/m^{3}}$，$ c_{p,f} = 1.0 \\times 10^{3} \\ \\mathrm{J/(kg \\cdot K)}$ 和 $ k_{f} = 8.0 \\times 10^{-2} \\ \\mathrm{W/(m \\cdot K)}$。\n\n固体区域：\n- 网格间距为 $ \\Delta x_{s} = 2.5 \\times 10^{-4} \\ \\mathrm{m}$，$ \\Delta y_{s} = 2.5 \\times 10^{-4} \\ \\mathrm{m}$ 和 $ \\Delta z_{s} = 1.0 \\times 10^{-3} \\ \\mathrm{m}$。\n- 热物理性质为 $ \\rho_{s} = 8.0 \\times 10^{3} \\ \\mathrm{kg/m^{3}}$，$ c_{p,s} = 5.0 \\times 10^{2} \\ \\mathrm{J/(kg \\cdot K)}$ 和 $ k_{s} = 1.6 \\times 10^{1} \\ \\mathrm{W/(m \\cdot K)}$。\n- 固体是静止的，因此 $ \\boldsymbol{u}_{s} = \\boldsymbol{0}$。\n\n定义流体热扩散系数 $ \\alpha_{f} = \\frac{k_{f}}{\\rho_{f} c_{p,f}}$ 和固体热扩散系数 $ \\alpha_{s} = \\frac{k_{s}}{\\rho_{s} c_{p,s}}$，并计算每个区域在其各自网格上的限制稳定性的显式扩散约束。同样地，计算流体区域中的 CFL 对流约束。\n\n最后，将所有约束（流体对流和流体/固体扩散）中的最小值作为最大允许时间步长报告。将最终数值答案四舍五入到四位有效数字，并以秒为单位表示。",
            "solution": "该问题要求为一个应用于共轭传热问题的显式数值格式推导稳定性约束，然后根据给定的物理参数集计算最大稳定时间步长。推导必须从控制方程和指定的离散方法开始。\n\n首先，我们处理流体区域。其控制能量方程为：\n$$ \\rho_{f} c_{p,f} \\, \\frac{\\partial T}{\\partial t} + \\rho_{f} c_{p,f} \\, \\boldsymbol{u} \\cdot \\nabla T = \\nabla \\cdot \\left( k_{f} \\nabla T \\right) + \\dot{q} $$\n我们用 $ \\rho_{f} c_{p,f} $ 除以方程，引入热扩散系数 $ \\alpha_{f} = \\frac{k_{f}}{\\rho_{f} c_{p,f}} $:\n$$ \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T = \\alpha_{f} \\nabla^{2} T + \\frac{\\dot{q}}{\\rho_{f} c_{p,f}} $$\n问题指定了时间导数项使用向前欧拉格式，对流项 $ \\boldsymbol{u} \\cdot \\nabla T $ 使用一阶迎风格式，扩散项 $ \\alpha_{f} \\nabla^{2} T $ 使用二阶中心差分格式。令 $ T_{i,j,k}^{n} $ 表示在时间层 $ n $ 时网格点 $ (i,j,k) $ 处的温度。离散化的方程为：\n$$ \\frac{T_{i,j,k}^{n+1} - T_{i,j,k}^{n}}{\\Delta t} = -(\\boldsymbol{u} \\cdot \\nabla T)_{i,j,k}^{n} + (\\alpha_{f} \\nabla^{2} T)_{i,j,k}^{n} + \\frac{\\dot{q}_{i,j,k}^{n}}{\\rho_{f} c_{p,f}} $$\n空间项离散如下。对于对流项，在三维笛卡尔网格上使用一阶迎风差分（为简单起见，假设 $ u_x, u_y, u_z > 0 $，对于稳定性分析，使用绝对值的一般形式是等效的）：\n$$ (\\boldsymbol{u} \\cdot \\nabla T)_{i,j,k}^{n} \\approx u_{x} \\frac{T_{i,j,k}^{n} - T_{i-1,j,k}^{n}}{\\Delta x_{f}} + u_{y} \\frac{T_{i,j,k}^{n} - T_{i,j-1,k}^{n}}{\\Delta y_{f}} + u_{z} \\frac{T_{i,j,k}^{n} - T_{i,j,k-1}^{n}}{\\Delta z_{f}} $$\n对于扩散项，使用二阶中心差分：\n$$ (\\nabla^{2} T)_{i,j,k}^{n} \\approx \\frac{T_{i+1,j,k}^{n} - 2T_{i,j,k}^{n} + T_{i-1,j,k}^{n}}{(\\Delta x_{f})^{2}} + \\frac{T_{i,j+1,k}^{n} - 2T_{i,j,k}^{n} + T_{i,j-1,k}^{n}}{(\\Delta y_{f})^{2}} + \\frac{T_{i,j,k+1}^{n} - 2T_{i,j,k}^{n} + T_{i,j,k-1}^{n}}{(\\Delta z_{f})^{2}} $$\n将这些近似代入时间离散方程，并求解 $ T_{i,j,k}^{n+1} $：\n$$ T_{i,j,k}^{n+1} = T_{i,j,k}^{n} - \\Delta t \\left( u_{x} \\frac{T_{i,j,k}^{n} - T_{i-1,j,k}^{n}}{\\Delta x_{f}} + \\dots \\right) + \\Delta t \\, \\alpha_{f} \\left( \\frac{T_{i+1,j,k}^{n} - 2T_{i,j,k}^{n} + T_{i-1,j,k}^{n}}{(\\Delta x_{f})^{2}} + \\dots \\right) + \\Delta t \\frac{\\dot{q}_{i,j,k}^{n}}{\\rho_{f} c_{p,f}} $$\n为保证此显式格式的稳定性，右侧中心节点温度 $ T_{i,j,k}^{n} $ 的系数必须为非负。我们收集所有乘以 $ T_{i,j,k}^{n} $ 的项。注意对于任何速度方向，迎风格式都贡献一个项 $ \\frac{|u_{\\beta}|}{\\Delta \\beta_{f}} T_{i,j,k}^{n} $，其中 $ \\beta \\in \\{x,y,z\\} $。问题还假设源项 $ \\dot{q} $ 不会引入更严格的稳定性约束，因此我们将其视为与 $ T_{i,j,k}^{n} $ 无关。\n$ T_{i,j,k}^{n} $ 的系数为：\n$$ C_{f} = 1 - \\Delta t \\left( \\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}} \\right) - \\Delta t \\cdot 2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right) $$\n稳定性条件 $ C_{f} \\ge 0 $ 要求：\n$$ \\Delta t \\left[ \\left( \\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}} \\right) + 2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right) \\right] \\le 1 $$\n这一个条件意味着必须满足两个独立的约束。Courant-Friedrichs-Lewy (CFL) 对流约束是：\n$$ \\Delta t_{adv,f} \\le \\frac{1}{\\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}}} $$\n显式扩散约束是：\n$$ \\Delta t_{diff,f} \\le \\frac{1}{2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right)} $$\n\n接下来，我们处理固体区域。由于没有对流项或源项，其控制方程更简单：\n$$ \\rho_{s} c_{p,s} \\, \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left( k_{s} \\nabla T \\right) $$\n用 $ \\rho_{s} c_{p,s} $ 除以方程，引入固体热扩散系数 $ \\alpha_{s} = \\frac{k_{s}}{\\rho_{s} c_{p,s}} $:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha_{s} \\nabla^{2} T $$\n在时间上使用向前欧拉法，在空间上使用二阶中心差分进行离散，得到：\n$$ \\frac{T_{i,j,k}^{n+1} - T_{i,j,k}^{n}}{\\Delta t} = \\alpha_{s} \\left( \\frac{T_{i+1,j,k}^{n} - 2T_{i,j,k}^{n} + T_{i-1,j,k}^{n}}{(\\Delta x_{s})^{2}} + \\dots \\right) $$\n求解 $ T_{i,j,k}^{n+1} $ 并收集 $ T_{i,j,k}^{n} $ 的系数：\n$$ C_{s} = 1 - \\Delta t \\cdot 2\\alpha_{s} \\left( \\frac{1}{(\\Delta x_{s})^{2}} + \\frac{1}{(\\Delta y_{s})^{2}} + \\frac{1}{(\\Delta z_{s})^{2}} \\right) $$\n稳定性条件 $ C_{s} \\ge 0 $ 得到固体的扩散约束：\n$$ \\Delta t_{diff,s} \\le \\frac{1}{2\\alpha_{s} \\left( \\frac{1}{(\\Delta x_{s})^{2}} + \\frac{1}{(\\Delta y_{s})^{2}} + \\frac{1}{(\\Delta z_{s})^{2}} \\right)} $$\n对于静止的固体，没有对流约束。\n\n在推导出约束之后，我们现在使用所提供的数据计算最大允许时间步长。\n首先，我们计算热扩散系数。\n流体热扩散系数：\n$$ \\alpha_{f} = \\frac{k_{f}}{\\rho_{f} c_{p,f}} = \\frac{8.0 \\times 10^{-2} \\ \\mathrm{W/(m \\cdot K)}}{(1.2 \\ \\mathrm{kg/m^{3}}) \\cdot (1.0 \\times 10^{3} \\ \\mathrm{J/(kg \\cdot K)})} = \\frac{8.0 \\times 10^{-2}}{1.2 \\times 10^{3}} \\ \\mathrm{m^2/s} = \\frac{1}{15000} \\ \\mathrm{m^2/s} \\approx 6.667 \\times 10^{-5} \\ \\mathrm{m^2/s} $$\n固体热扩散系数：\n$$ \\alpha_{s} = \\frac{k_{s}}{\\rho_{s} c_{p,s}} = \\frac{1.6 \\times 10^{1} \\ \\mathrm{W/(m \\cdot K)}}{(8.0 \\times 10^{3} \\ \\mathrm{kg/m^{3}}) \\cdot (5.0 \\times 10^{2} \\ \\mathrm{J/(kg \\cdot K)})} = \\frac{16}{4.0 \\times 10^{6}} \\ \\mathrm{m^2/s} = 4.0 \\times 10^{-6} \\ \\mathrm{m^2/s} $$\n\n现在，我们评估时间步长约束。\n流体对流约束：\n$$ \\sum_{adv,f} = \\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}} = \\frac{25}{5.0 \\times 10^{-4}} + \\frac{2}{2.5 \\times 10^{-4}} + \\frac{0}{1.0 \\times 10^{-3}} $$\n$$ \\sum_{adv,f} = (5.0 \\times 10^{4}) + (0.8 \\times 10^{4}) + 0 = 5.8 \\times 10^{4} \\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{adv,f} \\le \\frac{1}{5.8 \\times 10^{4}} \\ \\mathrm{s} \\approx 1.7241 \\times 10^{-5} \\ \\mathrm{s} $$\n流体扩散约束：\n$$ \\sum_{diff,f} = 2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right) $$\n$$ \\sum_{diff,f} = 2 \\left( \\frac{1}{15000} \\right) \\left( \\frac{1}{(5.0 \\times 10^{-4})^{2}} + \\frac{1}{(2.5 \\times 10^{-4})^{2}} + \\frac{1}{(1.0 \\times 10^{-3})^{2}} \\right) $$\n$$ \\sum_{diff,f} = \\frac{2}{15000} \\left( 4.0 \\times 10^{6} + 16.0 \\times 10^{6} + 1.0 \\times 10^{6} \\right) = \\frac{2 \\times (21.0 \\times 10^{6})}{1.5 \\times 10^{4}} = 2800 \\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{diff,f} \\le \\frac{1}{2800} \\ \\mathrm{s} \\approx 3.5714 \\times 10^{-4} \\ \\mathrm{s} $$\n固体扩散约束：\n$$ \\sum_{diff,s} = 2\\alpha_{s} \\left( \\frac{1}{(\\Delta x_{s})^{2}} + \\frac{1}{(\\Delta y_{s})^{2}} + \\frac{1}{(\\Delta z_{s})^{2}} \\right) $$\n$$ \\sum_{diff,s} = 2(4.0 \\times 10^{-6}) \\left( \\frac{1}{(2.5 \\times 10^{-4})^{2}} + \\frac{1}{(2.5 \\times 10^{-4})^{2}} + \\frac{1}{(1.0 \\times 10^{-3})^{2}} \\right) $$\n$$ \\sum_{diff,s} = 8.0 \\times 10^{-6} \\left( 16.0 \\times 10^{6} + 16.0 \\times 10^{6} + 1.0 \\times 10^{6} \\right) = 8.0 \\times 10^{-6} (33.0 \\times 10^{6}) = 264 \\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{diff,s} \\le \\frac{1}{264} \\ \\mathrm{s} \\approx 3.7879 \\times 10^{-3} \\ \\mathrm{s} $$\n\n整个共轭系统的最大允许时间步长 $ \\Delta t_{max} $ 必须同时满足所有约束。因此，它是各个限制中的最小值：\n$$ \\Delta t_{max} = \\min(\\Delta t_{adv,f}, \\Delta t_{diff,f}, \\Delta t_{diff,s}) $$\n$$ \\Delta t_{max} = \\min(1.7241 \\times 10^{-5}, 3.5714 \\times 10^{-4}, 3.7879 \\times 10^{-3}) \\ \\mathrm{s} $$\n最严格的约束是流体区域中的对流限制。\n$$ \\Delta t_{max} = 1.7241 \\times 10^{-5} \\ \\mathrm{s} $$\n按要求四舍五入到四位有效数字，我们得到最终答案。\n$$ \\Delta t_{max} \\approx 1.724 \\times 10^{-5} \\ \\mathrm{s} $$",
            "answer": "$$\\boxed{1.724 \\times 10^{-5}}$$"
        },
        {
            "introduction": "显式方法虽然简单，但其苛刻的时间步长限制（尤其是在处理包含反应和传导的刚性问题时）可能导致计算成本过高。全耦合的隐式方法提供了一种更稳健、更高效的替代方案。本练习将引导您为一个包含反应源项的一维共轭传热问题，开发一个全耦合的牛顿法求解器。通过构建完整的残差向量和解析雅可比矩阵，您将掌握在隐式框架中强耦合流体与固体域的核心技术，这是解决复杂多物理场问题的先进方法 。",
            "id": "4013993",
            "problem": "您的任务是为邻近固体的反应流体实现一种全耦合整体牛顿法，用于求解其共轭传热问题。目标是在一维平板几何中离散化并求解稳态能量方程，施加物理上一致的界面条件，并推导出在界面处展现固体和流体未知数之间交叉导数的块雅可比结构。您必须编写一个完整的程序，使用解析雅可比矩阵求解非线性离散系统，并为指定的测试套件返回界面温度。所有涉及物理单位的量都必须使用下面指定的单位表示。\n\n考虑一个一维区域，由厚度为 $L_f$ 的流体层和厚度为 $L_s$ 的相邻固体层组成。令 $x \\in [0, L_f]$ 表示流体域，$x \\in [L_f, L_f + L_s]$ 表示固体域。稳态能量方程为：\n- 对于反应流体，\n$$ \\rho_f c_{p,f} u \\frac{\\partial T_f}{\\partial x} - \\frac{\\partial}{\\partial x}\\left(k_f \\frac{\\partial T_f}{\\partial x}\\right) + S_f(T_f) = 0, $$\n其中 $S_f(T_f) = Q_0 \\exp\\!\\left(-\\frac{E}{R T_f}\\right)$，$R$ 是普适气体常数。\n- 对于固体（无内部热源），\n$$ -\\frac{\\partial}{\\partial x}\\left(k_s \\frac{\\partial T_s}{\\partial x}\\right) = 0. $$\n\n边界条件为：\n- 在 $x=0$ 处的流体入口：$T_f(0) = T_{\\text{in}}$。\n- 在 $x = L_f + L_s$ 处的固体远端壁面：$T_s(L_f + L_s) = T_{\\text{wall}}$。\n\n在 $x = L_f$ 处的界面条件为：\n- 温度连续性：$T_f(L_f) = T_s(L_f)$。\n- 热通量连续性：$k_f \\left.\\frac{\\partial T_f}{\\partial x}\\right|_{x=L_f^-} = k_s \\left.\\frac{\\partial T_s}{\\partial x}\\right|_{x=L_f^+}$。\n\n使用 $N_f$ 个流体内部点和 $N_s$ 个固体内部点来离散化流体域和固体域。在流体中使用一阶迎风格式处理对流项，在两个域中均使用二阶中心差分处理扩散项，并在界面处使用单边差分来近似法向梯度。设流体内部点的均匀间距为 $\\Delta x_f = L_f/(N_f+1)$，固体内部点的均匀间距为 $\\Delta x_s = L_s/(N_s+1)$。引入离散未知数：\n- 流体内部温度 $T_{f,i}$，其中 $i = 1, \\dots, N_f$，\n- 固体内部温度 $T_{s,j}$，其中 $j = 1, \\dots, N_s$，\n- 流体侧界面温度 $T_{f,\\mathrm{int}} \\equiv T_f(L_f)$，\n- 固体侧界面温度 $T_{s,\\mathrm{int}} \\equiv T_s(L_f)$。\n\n为离散方程构建残差：\n- 对每个流体内部点 $i$，强制执行稳态能量平衡，其中对流热通量来自上游邻点（采用迎风格式），扩散热通量采用中心差分格式，并加上反应源项 $S_f(T_{f,i})$。\n- 对每个固体内部点 $j$，使用中心差分格式强制执行稳态扩散方程。\n- 在界面处，使用基于半网格的单边差分强制执行温度连续性和热通量连续性，即，在流体侧使用近似梯度 $(T_{f,\\mathrm{int}} - T_{f,N_f})/(\\Delta x_f/2)$，在固体侧使用近似梯度 $(T_{s,1} - T_{s,\\mathrm{int}})/(\\Delta x_s/2)$。\n\n推导整体残差向量的解析雅可比矩阵。将雅可比矩阵组织成一个块矩阵\n$$\n\\mathbf{J} = \\begin{bmatrix}\n\\mathbf{J}_{ff}  \\mathbf{J}_{fs} \\\\\n\\mathbf{J}_{sf}  \\mathbf{J}_{ss}\n\\end{bmatrix},\n$$\n其中 $\\mathbf{J}_{ff}$ 包含流体残差对流体未知数（包括 $T_{f,\\mathrm{int}}$）的导数，$\\mathbf{J}_{ss}$ 包含固体残差对固体未知数（包括 $T_{s,\\mathrm{int}}$）的导数，而 $\\mathbf{J}_{fs}$ 和 $\\mathbf{J}_{sf}$ 捕捉仅由界面条件产生的交叉导数。明确识别并推导由界面残差引起的 $\\mathbf{J}_{fs}$ 和 $\\mathbf{J}_{sf}$ 中的非零项。展示反应源项 $S_f(T)$ 如何通过其导数 $S_f'(T)$ 对 $\\mathbf{J}_{ff}$ 产生贡献。\n\n实现一个使用此解析雅可比矩阵同时求解所有未知数的整体牛顿法。如有需要，使用回溯线搜索以确保非线性迭代的稳健收敛。当残差向量的欧几里得范数低于某个容差或达到最大迭代次数时，算法必须停止。\n\n使用的常量和参数如下：\n- 普适气体常数 $R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$，\n- 流体密度 $\\rho_f = 1.0 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$，\n- 流体比热 $c_{p,f} = 1000 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$，\n- 流体导热系数 $k_f = 0.05 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}$，\n- 流体层厚度 $L_f = 0.1 \\ \\mathrm{m}$，\n- 固体层厚度 $L_s = 0.05 \\ \\mathrm{m}$，\n- 离散化点数 $N_f = 3$，$N_s = 2$，\n- 流体入口温度 $T_{\\text{in}} = 900 \\ \\mathrm{K}$，\n- 固体远端壁面温度 $T_{\\text{wall}} = 300 \\ \\mathrm{K}$。\n\n设计一个包含四组参数 $(u, k_s, Q_0, E)$ 的测试套件，用于检验不同工况：\n1. 中等对流，中等固体导热率，中等反应：$(0.5 \\ \\mathrm{m/s}, 15 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}, 5\\times 10^4 \\ \\mathrm{W} \\ \\mathrm{m}^{-3}, 2.0\\times 10^4 \\ \\mathrm{J/mol})$。\n2. 无对流无反应，扩散主导：$(0.0 \\ \\mathrm{m/s}, 15 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}, 0 \\ \\mathrm{W} \\ \\mathrm{m}^{-3}, 2.0\\times 10^4 \\ \\mathrm{J/mol})$。\n3. 强对流，较低固体导热率，较强反应：$(3.0 \\ \\mathrm{m/s}, 5 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}, 2\\times 10^5 \\ \\mathrm{W} \\ \\mathrm{m}^{-3}, 1.5\\times 10^4 \\ \\mathrm{J/mol})$。\n4. 中等对流，低固体导热率，中等反应：$(0.5 \\ \\mathrm{m/s}, 0.8 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}, 5\\times 10^4 \\ \\mathrm{W} \\ \\mathrm{m}^{-3}, 2.0\\times 10^4 \\ \\mathrm{J/mol})$。\n\n您的程序必须：\n- 为上述离散系统组装残差向量和解析雅可比矩阵。\n- 使用带有可选回溯的整体牛顿法求解非线性系统。\n- 对每个测试用例，报告以开尔文为单位的界面温度 $T_{f,\\mathrm{int}}$。\n\n答案规格：\n- 以开尔文为单位，将每个界面温度表示为浮点数。\n- 您的程序应生成单行输出，其中包含所有四个测试用例的结果，格式为方括号内的逗号分隔列表，每个温度四舍五入到六位小数（例如，“[800.123456,750.654321, ...]”）。\n\n在您的推导和实现中，请确保科学真实性和内部一致性。推导必须从基本的能量守恒和本构关系开始，必须详细说明离散化和雅可比块，并且不得使用跳过核心推理或推导步骤的快捷公式。最终程序必须是自包含的，并且不使用任何外部输入。",
            "solution": "该问题要求实现一个全耦合整体牛顿法，以解决涉及反应流体和相邻固体的一维稳态共轭传热问题。任务的核心是正确地离散化控制能量方程，在流固界面上施加物理条件，并为所得非线性系统推导解析雅可比矩阵，以在牛顿-拉弗森框架内使用。\n\n### 1. 问题公式化与离散化\n\n物理域由 $x \\in [0, L_f]$ 上的流体区域和 $x \\in [L_f, L_f + L_s]$ 上的固体区域组成。稳态控制能量方程为：\n- 流体域 ($x \\in [0, L_f]$):\n$$ \\rho_f c_{p,f} u \\frac{\\partial T_f}{\\partial x} - \\frac{\\partial}{\\partial x}\\left(k_f \\frac{\\partial T_f}{\\partial x}\\right) + S_f(T_f) = 0 $$\n其中阿伦尼乌斯源项为 $S_f(T_f) = Q_0 \\exp\\left(-\\frac{E}{R T_f}\\right)$。\n- 固体域 ($x \\in [L_f, L_f + L_s]$):\n$$ -\\frac{\\partial}{\\partial x}\\left(k_s \\frac{\\partial T_s}{\\partial x}\\right) = 0 $$\n边界条件为 $T_f(0) = T_{\\text{in}}$ 和 $T_s(L_f + L_s) = T_{\\text{wall}}$。在界面 $x=L_f$ 处，温度和热通量是连续的：$T_f(L_f) = T_s(L_f)$ 和 $k_f \\frac{\\partial T_f}{\\partial x} = k_s \\frac{\\partial T_s}{\\partial x}$。\n\n对于整体解法，所有未知温度都将同时求解。我们首先对区域进行离散化。流体域被离散为 $N_f+2$ 个点，间距为 $\\Delta x_f = L_f/(N_f+1)$，固体域被离散为 $N_s+2$ 个点，间距为 $\\Delta x_s = L_s/(N_s+1)$。这样就产生了 $N_f$ 个流体内部节点、$N_s$ 个固体内部节点以及共享的界面。为了显式地处理界面耦合，我们为界面温度引入了两个不同的未知数，$T_{f,\\mathrm{int}}$ 和 $T_{s,\\mathrm{int}}$，并将其相等作为方程系统的一部分来强制执行。\n\n完整的未知数集合被划分为一个流体向量 $\\mathbf{T}_f$ 和一个固体向量 $\\mathbf{T}_s$：\n- 流体未知数：$\\mathbf{T}_f = [T_{f,1}, \\dots, T_{f,N_f}, T_{f,\\mathrm{int}}]^T$，大小为 $N_f+1$。\n- 固体未知数：$\\mathbf{T}_s = [T_{s,1}, \\dots, T_{s,N_s}, T_{s,\\mathrm{int}}]^T$，大小为 $N_s+1$。\n全局状态向量为 $\\mathbf{U} = [\\mathbf{T}_f^T, \\mathbf{T}_s^T]^T$，是一个大小为 $N = N_f + N_s + 2$ 的向量。\n\n### 2. 离散残差方程组\n\n我们应用有限差分近似来形成一个包含 $N$ 个非线性代数方程的方程组 $\\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$。\n\n**流体内部残差 ($i=1, \\dots, N_f$):**\n对流项使用一阶迎风格式，扩散项使用二阶中心差分格式，内部流体节点 $T_{f,i}$ 的残差为：\n$$ F_{f,i} = \\rho_f c_{p,f} u \\frac{T_{f,i} - T_{f,i-1}}{\\Delta x_f} - \\frac{k_f}{\\Delta x_f^2} (T_{f,i+1} - 2T_{f,i} + T_{f,i-1}) + S_f(T_{f,i}) = 0 $$\n其中 $T_{f,0} \\equiv T_{\\text{in}}$ 且 $T_{f,N_f+1} \\equiv T_{f,\\mathrm{int}}$。\n\n**固体内部残差 ($j=1, \\dots, N_s$):**\n对扩散项使用二阶中心差分格式，内部固体节点 $T_{s,j}$ 的残差为：\n$$ F_{s,j} = -\\frac{k_s}{\\Delta x_s^2} (T_{s,j+1} - 2T_{s,j} + T_{s,j-1}) = 0 $$\n其中 $T_{s,0} \\equiv T_{s,\\mathrm{int}}$ 且 $T_{s,N_s+1} \\equiv T_{\\text{wall}}$。\n\n**界面残差：**\n两个方程用于强制执行 $x=L_f$ 处的界面条件。\n1.  **温度连续性：** 这是最简单的条件。\n    $$ F_{\\mathrm{int},T} = T_{f,\\mathrm{int}} - T_{s,\\mathrm{int}} = 0 $$\n2.  **热通量连续性：** 我们使用指定的基于半网格长度的单边差分。\n    $$ q_f = k_f \\left.\\frac{\\partial T_f}{\\partial x}\\right|_{x=L_f^-} \\approx k_f \\frac{T_{f,\\mathrm{int}} - T_{f,N_f}}{\\Delta x_f/2} $$\n    $$ q_s = k_s \\left.\\frac{\\partial T_s}{\\partial x}\\right|_{x=L_f^+} \\approx k_s \\frac{T_{s,1} - T_{s,\\mathrm{int}}}{\\Delta x_s/2} $$\n    通过令热通量相等 $q_f = q_s$ 来形成残差：\n    $$ F_{\\mathrm{int},q} = k_f \\frac{T_{f,\\mathrm{int}} - T_{f,N_f}}{\\Delta x_f/2} - k_s \\frac{T_{s,1} - T_{s,\\mathrm{int}}}{\\Delta x_s/2} = 0 $$\n\n为了匹配分块的状态向量 $\\mathbf{U}$，全局残差向量 $\\mathbf{F}$ 被划分为 $\\mathbf{F}_f$ 和 $\\mathbf{F}_s$：\n- 与流体相关的残差：$\\mathbf{F}_f = [F_{f,1}, \\dots, F_{f,N_f}, F_{\\mathrm{int},q}]^T$ (大小为 $N_f+1$)。\n- 与固体相关的残差：$\\mathbf{F}_s = [F_{s,1}, \\dots, F_{s,N_s}, F_{\\mathrm{int},T}]^T$ (大小为 $N_s+1$)。\n\n### 3. 解析雅可比矩阵推导\n\n牛顿法需要雅可比矩阵 $\\mathbf{J} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$。根据我们的分块方式，$\\mathbf{J}$ 具有一个 $2 \\times 2$ 的块结构：\n$$ \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial \\mathbf{F}_f}{\\partial \\mathbf{T}_f}  \\frac{\\partial \\mathbf{F}_f}{\\partial \\mathbf{T}_s} \\\\ \\frac{\\partial \\mathbf{F}_s}{\\partial \\mathbf{T}_f}  \\frac{\\partial \\mathbf{F}_s}{\\partial \\mathbf{T}_s} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{J}_{ff}  \\mathbf{J}_{fs} \\\\ \\mathbf{J}_{sf}  \\mathbf{J}_{ss} \\end{bmatrix} $$\n\n**对角块 $\\mathbf{J}_{ff}$：** 这个 $(N_f+1) \\times (N_f+1)$ 的块包含流体侧残差对流体侧未知数的导数。\n- 对于内部流体残差 $F_{f,i}$ ($i=1, \\dots, N_f$):\n    - $\\frac{\\partial F_{f,i}}{\\partial T_{f,i}} = \\frac{\\rho_f c_{p,f} u}{\\Delta x_f} + \\frac{2k_f}{\\Delta x_f^2} + S_f'(T_{f,i})$\n    - $\\frac{\\partial F_{f,i}}{\\partial T_{f,i-1}} = -\\frac{\\rho_f c_{p,f} u}{\\Delta x_f} - \\frac{k_f}{\\Delta x_f^2}$ (对于 $i>1$)\n    - $\\frac{\\partial F_{f,i}}{\\partial T_{f,i+1}} = -\\frac{k_f}{\\Delta x_f^2}$ (对于 $i  N_f$)\n    - 源项的导数为 $S_f'(T) = \\frac{dS_f}{dT} = S_f(T) \\frac{E}{RT^2}$。\n    - 对于 $i=N_f$，$T_{f,N_f+1}$ 是 $T_{f,\\mathrm{int}}$，得到 $\\frac{\\partial F_{f,N_f}}{\\partial T_{f,\\mathrm{int}}} = -\\frac{k_f}{\\Delta x_f^2}$。\n- 对于作为 $\\mathbf{F}_f$ 最后一行的热通量残差 $F_{\\mathrm{int},q}$：\n    - $\\frac{\\partial F_{\\mathrm{int},q}}{\\partial T_{f,N_f}} = -\\frac{2k_f}{\\Delta x_f}$\n    - $\\frac{\\partial F_{\\mathrm{int},q}}{\\partial T_{f,\\mathrm{int}}} = \\frac{2k_f}{\\Delta x_f}$\n\n**对角块 $\\mathbf{J}_{ss}$：** 这个 $(N_s+1) \\times (N_s+1)$ 的块包含固体侧残差对固体侧未知数的导数。\n- 对于内部固体残差 $F_{s,j}$ ($j=1, \\dots, N_s$):\n    - $\\frac{\\partial F_{s,j}}{\\partial T_{s,j}} = \\frac{2k_s}{\\Delta x_s^2}$\n    - $\\frac{\\partial F_{s,j}}{\\partial T_{s,j-1}} = -\\frac{k_s}{\\Delta x_s^2}$ (对于 $j1$)\n    - $\\frac{\\partial F_{s,j}}{\\partial T_{s,j+1}} = -\\frac{k_s}{\\Delta x_s^2}$ (对于 $j  N_s$)\n    - 对于 $j=1$，$T_{s,0}$ 是 $T_{s,\\mathrm{int}}$，得到 $\\frac{\\partial F_{s,1}}{\\partial T_{s,\\mathrm{int}}} = -\\frac{k_s}{\\Delta x_s^2}$。\n- 对于作为 $\\mathbf{F}_s$ 最后一行的温度连续性残差 $F_{\\mathrm{int},T}$：\n    - $\\frac{\\partial F_{\\mathrm{int},T}}{\\partial T_{s,\\mathrm{int}}} = -1$\n\n**非对角块 $\\mathbf{J}_{fs}$ 和 $\\mathbf{J}_{sf}$：** 这些块捕捉流体和固体域之间的耦合。\n- $\\mathbf{J}_{fs} = \\frac{\\partial \\mathbf{F}_f}{\\partial \\mathbf{T}_s}$：这个 $(N_f+1) \\times (N_s+1)$ 的块大部分为零，除了由热通量残差 $F_{\\mathrm{int},q}$ 引入的导数。\n    - $\\frac{\\partial F_{\\mathrm{int},q}}{\\partial T_{s,1}} = -\\frac{2k_s}{\\Delta x_s}$\n    - $\\frac{\\partial F_{\\mathrm{int},q}}{\\partial T_{s,\\mathrm{int}}} = \\frac{2k_s}{\\Delta x_s}$\n- $\\mathbf{J}_{sf} = \\frac{\\partial \\mathbf{F}_s}{\\partial \\mathbf{T}_f}$：这个 $(N_s+1) \\times (N_f+1)$ 的块也大部分为零，除了由温度连续性残差 $F_{\\mathrm{int},T}$ 引入的导数。\n    - $\\frac{\\partial F_{\\mathrm{int},T}}{\\partial T_{f,\\mathrm{int}}} = 1$\n\n所有其他雅可比矩阵项均为零。通过这些导数，$\\mathbf{J}_{ff}$、$\\mathbf{J}_{ss}$、$\\mathbf{J}_{fs}$ 和 $\\mathbf{J}_{sf}$ 的所有非零项都已明确定义，从而可以构建完整的雅可比矩阵。\n\n下面的 Python 代码实现了这个牛顿求解器，并为指定的测试套件计算了结果。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and prints the results.\n    \"\"\"\n\n    # Global constants\n    R = 8.314  # J/mol/K\n    rho_f = 1.0  # kg/m^3\n    cp_f = 1000.0  # J/kg/K\n    k_f = 0.05  # W/m/K\n    L_f = 0.1  # m\n    L_s = 0.05  # m\n    Nf = 3\n    Ns = 2\n    T_in = 900.0  # K\n    T_wall = 300.0 # K\n\n    # Test cases: (u, k_s, Q0, E)\n    test_cases = [\n        (0.5, 15.0, 5e4, 2.0e4),\n        (0.0, 15.0, 0.0, 2.0e4),\n        (3.0, 5.0, 2e5, 1.5e4),\n        (0.5, 0.8, 5e4, 2.0e4)\n    ]\n\n    results = []\n    for params in test_cases:\n        u, k_s, Q0, E = params\n        \n        # Assemble parameters into a dictionary for cleaner passing\n        config = {\n            'R': R, 'rho_f': rho_f, 'cp_f': cp_f, 'k_f': k_f,\n            'L_f': L_f, 'L_s': L_s, 'Nf': Nf, 'Ns': Ns,\n            'T_in': T_in, 'T_wall': T_wall,\n            'u': u, 'k_s': k_s, 'Q0': Q0, 'E': E\n        }\n        \n        T_interface = newton_solver(config)\n        results.append(f\"{T_interface:.6f}\")\n    \n    print(f\"[{','.join(results)}]\")\n\ndef build_residual_and_jacobian(T_vec, config):\n    \"\"\"\n    Assembles the residual vector F and the Jacobian matrix J.\n    \n    Args:\n        T_vec (np.ndarray): The current state vector of all unknown temperatures.\n        config (dict): A dictionary containing all physical and numerical parameters.\n\n    Returns:\n        tuple: A tuple containing the residual vector (F) and the Jacobian matrix (J).\n    \"\"\"\n    # Unpack configuration\n    R, rho_f, cp_f, k_f = config['R'], config['rho_f'], config['cp_f'], config['k_f']\n    L_f, L_s, Nf, Ns = config['L_f'], config['L_s'], config['Nf'], config['Ns']\n    T_in, T_wall = config['T_in'], config['T_wall']\n    u, k_s, Q0, E = config['u'], config['k_s'], config['Q0'], config['E']\n    \n    # Grid spacing\n    dx_f = L_f / (Nf + 1)\n    dx_s = L_s / (Ns + 1)\n    \n    # State vector size\n    num_unknowns = Nf + Ns + 2\n    F = np.zeros(num_unknowns)\n    J = np.zeros((num_unknowns, num_unknowns))\n\n    # Index mapping for clarity\n    # Fluid unknowns: T_f_1, ..., T_f_Nf, T_f_int\n    Tf = T_vec[0 : Nf + 1]\n    # Solid unknowns: T_s_1, ..., T_s_Ns, T_s_int\n    Ts = T_vec[Nf + 1 : num_unknowns]\n\n    # --- Fluid Residuals and Jacobian Contributions ---\n    # F[0]...F[Nf-1] are for fluid interior nodes\n    # F[Nf] is for flux continuity at interface\n    \n    # Coefficients\n    conv_coeff = rho_f * cp_f * u / dx_f\n    diff_f_coeff = k_f / dx_f**2\n\n    # Loop over interior fluid nodes\n    for i in range(Nf):\n        # Temperatures at i-1, i, i+1\n        T_im1 = T_in if i == 0 else Tf[i - 1]\n        T_i = Tf[i]\n        T_ip1 = Tf[i + 1] if i  Nf - 1 else Tf[Nf] # Tf[Nf] is T_f_int\n\n        # Source term and its derivative\n        source_term = Q0 * np.exp(-E / (R * T_i)) if T_i > 0 else 0.0\n        source_deriv = source_term * (E / (R * T_i**2)) if T_i > 0 else 0.0\n        \n        # Residual F_f,i\n        F[i] = conv_coeff * (T_i - T_im1) - diff_f_coeff * (T_ip1 - 2 * T_i + T_im1) + source_term\n\n        # Jacobian entries for F_f,i\n        if i > 0:\n            J[i, i - 1] = -conv_coeff - diff_f_coeff  # dF_i/dT_{i-1}\n        J[i, i] = conv_coeff + 2 * diff_f_coeff + source_deriv  # dF_i/dT_i\n        J[i, i + 1] = -diff_f_coeff  # dF_i/dT_{i+1}\n\n    # --- Solid Residuals and Jacobian Contributions ---\n    # F[Nf+1]...F[Nf+Ns] are for solid interior nodes\n    # F[Nf+Ns+1] is for temperature continuity at interface\n    \n    # Coefficient\n    diff_s_coeff = k_s / dx_s**2\n    \n    # Loop over interior solid nodes\n    for j in range(Ns):\n        # Node index in the global F and J matrices\n        row_idx = Nf + 1 + j\n        # Temperatures at j-1, j, j+1 (solid indexing)\n        T_jm1 = Ts[Ns] if j == 0 else Ts[j - 1] # Ts[Ns] is T_s_int\n        T_j = Ts[j]\n        T_jp1 = T_wall if j == Ns - 1 else Ts[j + 1]\n\n        # Residual F_s,j\n        F[row_idx] = -diff_s_coeff * (T_jp1 - 2 * T_j + T_jm1)\n\n        # Jacobian entries for F_s,j\n        # Indices in global T_vec: Ts[k] -> T_vec[Nf + 1 + k]\n        J[row_idx, Nf + 1 + j] = 2 * diff_s_coeff  # dF_j/dT_j\n        if j > 0:\n            J[row_idx, Nf + 1 + j - 1] = -diff_s_coeff # dF_j/dT_{j-1}\n        else: # j=0, dependency on T_s_int\n            J[row_idx, Nf + 1 + Ns] = -diff_s_coeff # dF_0/dT_s_int\n        if j  Ns - 1:\n            J[row_idx, Nf + 1 + j + 1] = -diff_s_coeff # dF_j/dT_{j+1}\n\n    # --- Interface Residuals and Jacobian Contributions ---\n    T_f_Nf = Tf[Nf - 1]\n    T_f_int = Tf[Nf]\n    T_s_1 = Ts[0]\n    T_s_int = Ts[Ns]\n\n    # Flux continuity residual, F_int,q (at F[Nf])\n    flux_f = k_f * (T_f_int - T_f_Nf) / (dx_f / 2)\n    flux_s = k_s * (T_s_1 - T_s_int) / (dx_s / 2)\n    F[Nf] = flux_f - flux_s\n\n    # Jacobian entries for F_int,q\n    # J_ff block contribution\n    J[Nf, Nf - 1] = -k_f / (dx_f / 2) # dF_q/dT_f_Nf\n    J[Nf, Nf] = k_f / (dx_f / 2)      # dF_q/dT_f_int\n    # J_fs block contribution (cross-derivatives)\n    J[Nf, Nf + 1] = -k_s / (dx_s / 2) # dF_q/dT_s_1\n    J[Nf, Nf + 1 + Ns] = k_s / (dx_s / 2) # dF_q/dT_s_int\n\n    # Temperature continuity residual, F_int,T (at F[num_unknowns-1])\n    F[num_unknowns - 1] = T_f_int - T_s_int\n\n    # Jacobian entries for F_int,T\n    # J_sf block contribution (cross-derivative)\n    J[num_unknowns - 1, Nf] = 1.0 # dF_T/dT_f_int\n    # J_ss block contribution\n    J[num_unknowns - 1, Nf + 1 + Ns] = -1.0 # dF_T/dT_s_int\n    \n    return F, J\n\ndef newton_solver(config):\n    \"\"\"\n    Solves the nonlinear system using a monolithic Newton-Raphson method\n    with backtracking line search.\n    \"\"\"\n    Nf, Ns = config['Nf'], config['Ns']\n    T_in, T_wall = config['T_in'], config['T_wall']\n    \n    num_unknowns = Nf + Ns + 2\n    \n    # Initial guess: linear interpolation in each domain\n    T_vec = np.zeros(num_unknowns)\n    T_guess_int = (T_in + T_wall) / 2.0\n    # Fluid part\n    T_vec[0:Nf] = np.linspace(T_in, T_guess_int, Nf + 2)[1:-1]\n    T_vec[Nf] = T_guess_int  # T_f_int\n    # Solid part\n    T_vec[Nf+1:Nf+1+Ns] = np.linspace(T_guess_int, T_wall, Ns + 2)[1:-1]\n    T_vec[Nf+1+Ns] = T_guess_int # T_s_int\n    \n    max_iter = 50\n    tol = 1e-8\n    alpha_min = 1e-4\n\n    for i in range(max_iter):\n        F, J = build_residual_and_jacobian(T_vec, config)\n        \n        res_norm = np.linalg.norm(F)\n        if res_norm  tol:\n            break\n        \n        # Solve the linear system J * dT = -F\n        try:\n            dT = np.linalg.solve(J, -F)\n        except np.linalg.LinAlgError:\n            return np.nan # Jacobian is singular\n\n        # Backtracking line search\n        alpha = 1.0\n        T_new = T_vec + alpha * dT\n        F_new, _ = build_residual_and_jacobian(T_new, config)\n        res_norm_new = np.linalg.norm(F_new)\n\n        while res_norm_new >= res_norm and alpha > alpha_min:\n            alpha /= 2.0\n            T_new = T_vec + alpha * dT\n            F_new, _ = build_residual_and_jacobian(T_new, config)\n            res_norm_new = np.linalg.norm(F_new)\n        \n        if alpha  alpha_min and res_norm_new >= res_norm:\n            # Failed to find a better solution\n            return np.nan\n\n        T_vec = T_new\n    \n    # Return the converged fluid-side interface temperature\n    return T_vec[Nf]\n\nif __name__ == '__main__':\n    solve()\n```",
            "answer": "[1134.819702,700.000000,1051.488094,1154.510619]"
        }
    ]
}