{
    "hands_on_practices": [
        {
            "introduction": "Before designing or implementing advanced numerical methods, it is crucial to master their foundational principles. This first exercise focuses on the core consistency conditions that ensure a Runge–Kutta method is accurate and behaves predictably. By analyzing a hypothetical method with a slight intentional flaw, you will gain a deeper, more intuitive understanding of why conditions like $A\\mathbf{1}=c$ are not just mathematical abstractions but have direct physical consequences for simulating autonomous systems like chemical kinetics .",
            "id": "4017903",
            "problem": "Consider a candidate diagonally implicit Runge–Kutta (DIRK) method for stiff chemical kinetics integration in computational combustion, applied to the autonomous ordinary differential equation (ODE) system for species mass fractions,\n$$\n\\frac{d\\mathbf{Y}}{dt}=\\boldsymbol{\\omega}(\\mathbf{Y},T),\n$$\nwhere $\\mathbf{Y}$ denotes the vector of species mass fractions and $T$ is the temperature. The method is specified by its Butcher tableau with $s=2$ stages:\n$$\nA=\\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix},\\quad\nc=\\begin{pmatrix}\n\\gamma \\\\\n0.999\n\\end{pmatrix},\\quad\nb^{\\top}=\\begin{pmatrix}\n0.5 & 0.5\n\\end{pmatrix},\n$$\nwith $\\gamma=0.2928932188134524$.\n\nUsing only the fundamental definition of Runge–Kutta methods for autonomous ODEs and their first-order consistency conditions, verify whether the internal consistency condition $A\\mathbf{1}=c$ and the weight-normalization condition $\\sum_{i=1}^{s} b_i=1$ hold for this tableau. Then, for this tableau, compute the scalar violation metric\n$$\nE=\\|A\\mathbf{1}-c\\|_{1}+\\left|\\sum_{i=1}^{s} b_i-1\\right|,\n$$\nwhere $\\|\\cdot\\|_{1}$ is the vector $1$-norm and $\\mathbf{1}$ is the vector in $\\mathbb{R}^{s}$ with all entries equal to $1$.\n\nFinally, interpret physically what each nonzero component of $A\\mathbf{1}-c$ and a nonzero value of $\\sum_{i=1}^{s} b_i-1$ would imply for integrating $\\frac{d\\mathbf{Y}}{dt}=\\boldsymbol{\\omega}(\\mathbf{Y},T)$ in stiff combustion kinetics. Your final reported value must be $E$ and must be rounded to four significant figures, expressed without units.",
            "solution": "We begin from the definition of a Runge–Kutta method for an autonomous ODE $\\frac{dy}{dt}=f(y)$ with step size $h>0$. A general $s$-stage Runge–Kutta scheme defines stage values $Y_i$ via\n$$\nY_i=y_n+h\\sum_{j=1}^{s} a_{ij} f(Y_j),\\quad i=1,\\dots,s,\n$$\nand advances the solution by\n$$\ny_{n+1}=y_n+h\\sum_{i=1}^{s} b_i f(Y_i).\n$$\nFor autonomous problems, the internal consistency condition $A\\mathbf{1}=c$ ensures that, when applied to the linear test problem with a constant right-hand side $f(y)=\\kappa$ for constant $\\kappa$, the stage increments align with the stage abscissae. Indeed, taking $f(y)=\\kappa$ yields\n$$\nY_i=y_n+h\\kappa\\sum_{j=1}^{s} a_{ij},\n$$\nwhile the exact solution at stage abscissa would be $y_n+h\\kappa c_i$. Therefore, internal consistency for autonomous ODEs requires\n$$\n\\sum_{j=1}^{s} a_{ij}=c_i,\\quad \\text{equivalently}\\quad A\\mathbf{1}=c.\n$$\nSimilarly, first-order accuracy for the step update applied to $f(y)=\\kappa$ requires\n$$\ny_{n+1}=y_n+h\\kappa\\sum_{i=1}^{s} b_i\\approx y_n+h\\kappa,\n$$\nwhich implies the weight-normalization condition\n$$\n\\sum_{i=1}^{s} b_i=1.\n$$\n\nWe now evaluate these conditions for the given tableau. Let\n$$\nA=\\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix},\\quad\nc=\\begin{pmatrix}\n\\gamma \\\\\n0.999\n\\end{pmatrix},\\quad\nb^{\\top}=\\begin{pmatrix}\n0.5 & 0.5\n\\end{pmatrix},\\quad\n\\mathbf{1}=\\begin{pmatrix}\n1\\\\\n1\n\\end{pmatrix}.\n$$\nCompute $A\\mathbf{1}$:\n$$\nA\\mathbf{1}=\\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix}\\begin{pmatrix}\n1\\\\\n1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\gamma\\cdot 1+0\\cdot 1\\\\\n(1-\\gamma)\\cdot 1+\\gamma\\cdot 1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\gamma\\\\\n1\n\\end{pmatrix}.\n$$\nTherefore,\n$$\nA\\mathbf{1}-c=\\begin{pmatrix}\n\\gamma\\\\\n1\n\\end{pmatrix}-\\begin{pmatrix}\n\\gamma\\\\\n0.999\n\\end{pmatrix}\n=\\begin{pmatrix}\n0\\\\\n1-0.999\n\\end{pmatrix}\n=\\begin{pmatrix}\n0\\\\\n0.001\n\\end{pmatrix}.\n$$\nIts vector $1$-norm is\n$$\n\\|A\\mathbf{1}-c\\|_{1}=|0|+|0.001|=0.001.\n$$\nNext, compute the sum of the weights:\n$$\n\\sum_{i=1}^{2} b_i=0.5+0.5=1.\n$$\nThus,\n$$\n\\left|\\sum_{i=1}^{2} b_i-1\\right|=|1-1|=0.\n$$\nThe violation metric is therefore\n$$\nE=\\|A\\mathbf{1}-c\\|_{1}+\\left|\\sum_{i=1}^{2} b_i-1\\right|=0.001+0=0.001.\n$$\nRounding $E$ to four significant figures yields\n$$\nE=1.000\\times 10^{-3}.\n$$\n\nPhysical interpretation for stiff combustion kinetics $\\frac{d\\mathbf{Y}}{dt}=\\boldsymbol{\\omega}(\\mathbf{Y},T)$:\n- A nonzero component of $A\\mathbf{1}-c$ indicates that the internal stage location $c_i$ does not equal the row sum $\\sum_{j=1}^{s} a_{ij}$. For autonomous kinetics, this misalignment implies that the stage state $\\mathbf{Y}_i$ accumulates increments inconsistent with its nominal stage abscissa. In practice, this can degrade stage order, distort the time-centering of reaction source-term evaluations $\\boldsymbol{\\omega}(\\mathbf{Y},T)$, and, in stiff regimes, exacerbate order reduction and bias the approach to chemical equilibrium.\n- A nonzero value of $\\sum_{i=1}^{s} b_i-1$ indicates failure to reproduce constant source terms exactly over one step. In chemical kinetics, this would mean that when $\\boldsymbol{\\omega}(\\mathbf{Y},T)$ is effectively constant over a step (e.g., in quasi-steady conditions), the method introduces a systematic drift in $\\mathbf{Y}$, potentially violating conservation constraints such as the unity sum of mass fractions and misrepresenting reaction progress.\n\nFor the given tableau, the computed $A\\mathbf{1}-c=\\begin{pmatrix}0\\\\0.001\\end{pmatrix}$ shows a small internal inconsistency in the second stage only, while the weight-normalization is exact. Consequently, $E=1.000\\times 10^{-3}$ quantifies a small but nonzero deviation confined to internal staging.",
            "answer": "$$\\boxed{1.000 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Moving from verification to creation, this practice guides you through the process of designing a numerical method tailored for stiffness. For problems in computational combustion, high formal order is insufficient; we require robust stability properties, such as L-stability, to correctly handle the vast range of time scales in chemical kinetics. This exercise demonstrates how to systematically construct a powerful, two-stage, L-stable SDIRK method by uniting algebraic order conditions with the practical constraint of stiff accuracy .",
            "id": "4017939",
            "problem": "Consider a homogeneous, isothermal reactor governed by chemical kinetics with species mass fractions collected in the vector $\\mathbf{Y}(t)$, whose evolution obeys the ordinary differential equation $\\frac{d\\mathbf{Y}}{dt} = \\boldsymbol{\\omega}(\\mathbf{Y})$, where $\\boldsymbol{\\omega}(\\mathbf{Y})$ is the reaction source term derived from mass-action kinetics. In computational combustion, such systems are stiff because the Jacobian $\\frac{\\partial \\boldsymbol{\\omega}}{\\partial \\mathbf{Y}}$ contains eigenvalues with large negative real parts. To integrate this system, you will construct a two-stage Singly Diagonally Implicit Runge–Kutta (SDIRK) method of order two and select its parameters to maximize linear stability for the linearized stiff kinetic modes.\n\nAssume a two-stage SDIRK method with a shared diagonal parameter $\\gamma$ in its coefficient matrix, stage abscissae $c_{1} = \\gamma$ and $c_{2} = 1$, and Butcher coefficients\n$$\nA = \\begin{pmatrix}\n\\gamma & 0 \\\\\na_{21} & \\gamma\n\\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix}\nb_{1} \\\\ b_{2}\n\\end{pmatrix}.\n$$\nThe stage abscissa constraint $c_{2} = 1$ enforces $a_{21} = 1 - \\gamma$ by definition. Using only the second-order accuracy requirements for Runge–Kutta methods applied to autonomous systems, construct the coefficients $a_{21}$ and $\\mathbf{b}$ as functions of $\\gamma$.\n\nThen, consider linear stability for the scalar linear test equation $\\frac{dy}{dt} = \\lambda y$ with $z = h \\lambda$ and $h > 0$, and define the amplification factor $R(z)$ as the ratio $y_{n+1}/y_{n}$ generated by your SDIRK method. In the stiff kinetics regime relevant to computational combustion, “maximizing linear stability” is taken in the precise sense of Linear stability (“L-stability”), namely that the amplification factor satisfies $\\lim_{z \\to -\\infty} R(z) = 0$ along the negative real axis. Enforce stiff accuracy, meaning the method’s weight vector equals the last row of $A$, i.e., $b_{1} = a_{21}$ and $b_{2} = \\gamma$, and impose the second-order accuracy conditions together with stiff accuracy to choose $\\gamma$ so that the method is L-stable.\n\nYour task:\n- Derive the second-order conditions for the two-stage Runge–Kutta method and solve for $a_{21}$ and $\\mathbf{b}$ in terms of $\\gamma$.\n- Construct $R(z)$ for the SDIRK method and explain how stiff accuracy enforces L-stability for stiff kinetic modes.\n- Using the second-order conditions together with stiff accuracy, determine the unique $\\gamma$ that yields an order-two, L-stable two-stage SDIRK method.\n\nExpress the final value of $\\gamma$ as a closed-form analytic expression. No rounding is required and no physical units should be reported in the answer.",
            "solution": "To determine the unique parameter $\\gamma$ for a two-stage, second-order, L-stable SDIRK method constrained by stiff accuracy, we proceed in three steps: deriving the coefficients from order conditions, constructing the stability function, and solving for $\\gamma$ by imposing all constraints simultaneously.\n\nFirst, we derive the coefficients of the Runge–Kutta method as functions of $\\gamma$ using the second-order accuracy conditions.\nA Runge–Kutta method is of order $p=2$ if it satisfies the following two conditions for autonomous systems:\n1.  Order 1 condition: $\\sum_{i=1}^{s} b_i = 1$\n2.  Order 2 condition: $\\sum_{i=1}^{s} b_i c_i = \\frac{1}{2}$\n\nFor the given two-stage ($s=2$) method, the Butcher tableau is characterized by:\n$$\nA = \\begin{pmatrix}\n\\gamma & 0 \\\\\na_{21} & \\gamma\n\\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix}\nb_{1} \\\\ b_{2}\n\\end{pmatrix}, \\quad\n\\mathbf{c} = \\begin{pmatrix}\nc_{1} \\\\ c_{2}\n\\end{pmatrix}\n$$\nThe problem specifies the stage abscissae $c_1 = \\gamma$ and $c_2 = 1$. The row-sum-to-$c_i$ condition, $c_i = \\sum_{j=1}^{s} a_{ij}$, for the second stage is $c_2 = a_{21} + a_{22}$, which gives $1 = a_{21} + \\gamma$. This confirms the provided constraint $a_{21} = 1 - \\gamma$.\n\nSubstituting $s=2$, $c_1 = \\gamma$, and $c_2 = 1$ into the order conditions yields a system of two linear equations for the weights $b_1$ and $b_2$:\n$$\nb_1 + b_2 = 1\n$$\n$$\nb_1 \\gamma + b_2 (1) = \\frac{1}{2}\n$$\nSubtracting the second equation from the first gives:\n$$\nb_1(1-\\gamma) = 1 - \\frac{1}{2} = \\frac{1}{2}\n$$\nAssuming $\\gamma \\neq 1$, we can solve for $b_1$:\n$$\nb_1 = \\frac{1}{2(1-\\gamma)}\n$$\nSubstituting this back into $b_1 + b_2 = 1$ gives $b_2$:\n$$\nb_2 = 1 - b_1 = 1 - \\frac{1}{2(1-\\gamma)} = \\frac{2(1-\\gamma) - 1}{2(1-\\gamma)} = \\frac{2 - 2\\gamma - 1}{2(1-\\gamma)} = \\frac{1-2\\gamma}{2(1-\\gamma)}\n$$\nThus, based solely on second-order accuracy, the coefficients are $a_{21}=1-\\gamma$, $b_1 = \\frac{1}{2(1-\\gamma)}$, and $b_2 = \\frac{1-2\\gamma}{2(1-\\gamma)}$.\n\nSecond, we construct the stability function $R(z)$ and analyze L-stability. A Runge–Kutta method applied to the scalar test equation $\\frac{dy}{dt} = \\lambda y$ yields $y_{n+1} = R(z) y_n$, where $z = h\\lambda$. The problem directs us to enforce stiff accuracy, which means the weights vector $\\mathbf{b}$ is identical to the last row of the matrix $A$. For our $s=2$ case, this means $b_1 = a_{21}$ and $b_2 = a_{22} = \\gamma$. This condition has a significant consequence: the final solution $y_{n+1}$ becomes identical to the last stage value, $Y_2$. The stability function is therefore $R(z) = Y_2/y_n$. Let's derive this.\nThe first stage gives:\n$$\nY_1 = y_n + h a_{11} \\lambda Y_1 \\implies Y_1(1-z\\gamma)=y_n \\implies \\frac{Y_1}{y_n} = \\frac{1}{1-z\\gamma}\n$$\nThe second stage gives:\n$$\nY_2 = y_n + h a_{21} \\lambda Y_1 + h a_{22} \\lambda Y_2 = y_n + z a_{21} Y_1 + z \\gamma Y_2\n$$\n$$\nY_2(1-z\\gamma) = y_n + z a_{21} Y_1 \\implies \\frac{Y_2}{y_n}(1-z\\gamma) = 1 + z a_{21} \\frac{Y_1}{y_n}\n$$\nSubstituting the expression for $Y_1/y_n$:\n$$\nR(z) = \\frac{Y_2}{y_n} = \\frac{1 + z a_{21} \\frac{1}{1-z\\gamma}}{1-z\\gamma} = \\frac{1-z\\gamma + z a_{21}}{(1-z\\gamma)^2}\n$$\nL-stability is the property that $\\lim_{z \\to -\\infty} R(z) = 0$. For our $R(z)$, we inspect the limit:\n$$\n\\lim_{z \\to -\\infty} R(z) = \\lim_{z \\to -\\infty} \\frac{1 + (a_{21}-\\gamma)z}{1 - 2z\\gamma + z^2\\gamma^2}\n$$\nThe numerator is a polynomial in $z$ of degree $1$, while the denominator is a polynomial of degree $2$. As long as $\\gamma \\neq 0$, the limit is $0$. Therefore, any SDIRK method with stiff accuracy is automatically L-stable. This is how stiff accuracy enforces L-stability: it ensures a rational stability function where the degree of the denominator polynomial is at least two greater than the degree of the numerator polynomial.\n\nThird, we determine the unique value of $\\gamma$ by imposing the second-order accuracy conditions and the stiff accuracy condition simultaneously.\nThe conditions are:\n1.  $b_1 + b_2 = 1$\n2.  $b_1 c_1 + b_2 c_2 = \\frac{1}{2}$\n3.  $b_1 = a_{21}$ (from stiff accuracy)\n4.  $b_2 = \\gamma$ (from stiff accuracy)\n5.  $a_{21} = 1 - \\gamma$ (from $c_2=a_{21}+\\gamma=1$)\n6.  $c_1 = \\gamma$\n7.  $c_2 = 1$\n\nCombining conditions (3), (4), and (5) into condition (1):\n$$\n(1-\\gamma) + \\gamma = 1 \\implies 1 = 1\n$$\nThis shows consistency, but does not constrain $\\gamma$.\n\nNow, we use condition (2), substituting all the others into it:\n$$\nb_1 c_1 + b_2 c_2 = (a_{21})(c_1) + (\\gamma)(c_2) = (1-\\gamma)(\\gamma) + (\\gamma)(1) = \\frac{1}{2}\n$$\nThis gives a quadratic equation for $\\gamma$:\n$$\n\\gamma - \\gamma^2 + \\gamma = \\frac{1}{2}\n$$\n$$\n2\\gamma - \\gamma^2 = \\frac{1}{2}\n$$\nMultiplying by $2$ and rearranging gives:\n$$\n4\\gamma - 2\\gamma^2 = 1 \\implies 2\\gamma^2 - 4\\gamma + 1 = 0\n$$\nSolving for $\\gamma$ using the quadratic formula, $\\gamma = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\n\\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16-8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4}\n$$\nThis yields two possible solutions for $\\gamma$:\n$$\n\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\quad \\text{and} \\quad \\gamma_2 = 1 + \\frac{\\sqrt{2}}{2}\n$$\nBoth solutions result in an order-two, L-stable SDIRK method. However, for applications in chemical kinetics, physical quantities like species mass fractions must remain non-negative. Numerical methods with negative coefficients ($a_{ij}$ or $b_i$) are known to be problematic for preserving positivity.\n\nLet's examine the coefficients for each value of $\\gamma$:\nCase 1: $\\gamma = \\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.2929$.\n$a_{21} = 1 - \\gamma_1 = 1 - (1 - \\frac{\\sqrt{2}}{2}) = \\frac{\\sqrt{2}}{2} > 0$.\nThe weights are $b_1 = a_{21} = \\frac{\\sqrt{2}}{2} > 0$ and $b_2 = \\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} > 0$.\nAll characteristic coefficients are positive.\n\nCase 2: $\\gamma = \\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1.7071$.\n$a_{21} = 1 - \\gamma_2 = 1 - (1 + \\frac{\\sqrt{2}}{2}) = -\\frac{\\sqrt{2}}{2} < 0$.\nThe weights are $b_1 = a_{21} = -\\frac{\\sqrt{2}}{2} < 0$ and $b_2 = \\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} > 0$.\nThis choice leads to negative coefficients, which can produce non-physical negative mass fractions.\n\nTherefore, for the intended application, only the first solution is physically and numerically desirable. The superior choice is $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$.",
            "answer": "$$ \\boxed{1 - \\frac{\\sqrt{2}}{2}} $$"
        },
        {
            "introduction": "This final practice bridges the gap between abstract theory and computational reality, challenging you to implement and analyze a DIRK method on a classic stiff test case. The theoretical stability function, $R(z)$, is a powerful predictor of a method's performance, where the eigenvalues $\\lambda_i$ of the system's Jacobian take on the role of $\\lambda$. By applying the L-stable method from the previous exercise to the Robertson kinetics problem, you will computationally verify its stability properties and see how the amplification factor $|R(h\\lambda_i)|$ dictates the damping of stiff modes in a real-world simulation .",
            "id": "4017946",
            "problem": "Consider the stiff chemical kinetics ordinary differential equation system known as the Robertson problem, which models a simplified reaction mechanism and is widely used in computational combustion as a prototype for stiffness. The system is defined by the time evolution of species concentrations $y_1(t)$, $y_2(t)$, and $y_3(t)$ under the law $dy/dt = f(y)$, where $y = [y_1, y_2, y_3]^T$ and $f(y)$ is constructed from mass-action kinetics. Let the reaction rate constants be $k_1 = 0.04$, $k_2 = 10^4$, and $k_3 = 3 \\times 10^7$ (all in $\\text{s}^{-1}$ units). The initial condition is $y(0) = [1, 0, 0]^T$. The right-hand side is\n$$\n\\frac{dy_1}{dt} = -k_1 y_1 + k_2 y_2 y_3, \\quad\n\\frac{dy_2}{dt} = k_1 y_1 - k_2 y_2 y_3 - k_3 y_2^2, \\quad\n\\frac{dy_3}{dt} = k_3 y_2^2,\n$$\nwhere the time $t$ is measured in seconds and the concentrations $y_i$ are nondimensionalized such that their sum remains $1$ for all $t$. The Jacobian matrix $J(y) = \\partial f / \\partial y$ of this system at a state $y$ is used for linearization, and its eigenvalues indicate the stiffness spectrum. In Diagonally Implicit Runge–Kutta (DIRK) methods, stability and stiffness handling can be analyzed via the linearized amplification factor, which for a linearized system $dy/dt = J y$ over a time step of size $h$ is determined by the stability function $R(z)$ evaluated at $z = h \\lambda$ for each eigenvalue $\\lambda$ of $J$.\n\nYour task is to implement and analyze the two-stage second-order Singly Diagonally Implicit Runge–Kutta method attributed to Alexander, which is known to be L-stable and A-stable in the literature, and is used in stiff kinetics integration. The method has a diagonal coefficient $\\gamma = 1 - 1/\\sqrt{2}$. For the scalar test equation $dy/dt = \\lambda y$, the DIRK one-step amplification factor is given by the method’s stability function $R(z)$, where $z = h \\lambda$. For the Alexander method, $R(z)$ is a rational function dependent on $\\gamma$, and it governs the magnitude of the amplification per step.\n\nStarting from the fundamental base that:\n- the local linearization of the nonlinear kinetics $dy/dt = f(y)$ about a state $y^\\star$ yields $dy/dt = J(y^\\star) y$, where $J(y^\\star)$ is the Jacobian matrix evaluated at $y^\\star$,\n- the stability of a Runge–Kutta method on the scalar linear test equation $dy/dt = \\lambda y$ is characterized by its stability function $R(z)$, and the matrix amplification for a linear system $dy/dt = J y$ is the rational function $R(h J)$ applied to the matrix $J$,\n- L-stability of a method means that $|R(z)| \\to 0$ as $z \\to -\\infty$ along the negative real axis, while A-stability means $|R(z)| \\le 1$ for all $z$ with $\\operatorname{Re}(z) \\le 0$,\n\nyou must implement the Alexander two-stage DIRK stability function and use it to:\n- verify L-stability by computing $|R(z)|$ for selected negative real values of $z$,\n- check A-stability on sample points from the imaginary axis,\n- compute the linearized amplification factor on the Robertson problem by evaluating $|R(h \\lambda_i)|$ for the eigenvalues $\\lambda_i$ of the Jacobian $J(y)$ at a physically relevant state $y$, specifically $y$ at $t = 1.0$ seconds obtained by numerically integrating the Robertson system from $t=0$ to $t=1$.\n\nYour program must do the following:\n- Integrate the Robertson system from $t = 0$ seconds to $t = 1.0$ seconds using a stiff solver to obtain $y(1.0)$.\n- Compute the Jacobian $J(y(1.0))$.\n- Implement the Alexander two-stage DIRK stability function $R(z)$ using the DIRK coefficients with diagonal parameter $\\gamma = 1 - 1/\\sqrt{2}$ and express $R(z)$ explicitly as a rational function.\n- Evaluate and report the magnitudes $|R(z)|$ for $z = -1$, $z = -10$, and $z = -100$.\n- Evaluate and report boolean values indicating whether $|R(z)| \\le 1$ for $z = i \\cdot 10$ and $z = i \\cdot 100$, respectively.\n- Compute the eigenvalues $\\lambda_i$ of $J(y(1.0))$, exclude any eigenvalues with $|\\lambda_i| < 10^{-8}$, then compute and report the maximum over $i$ of $|R(h \\lambda_i)|$ for step sizes $h = 10^{-4}$ seconds, $h = 10^{-2}$ seconds, $h = 10^{-1}$ seconds, and $h = 1.0$ seconds, only considering eigenvalues with $\\operatorname{Re}(\\lambda_i) < 0$.\n\nDesign a robust set of outputs that can be validated against the known published stability properties of the Alexander DIRK method (A-stability and L-stability). For numerical realism:\n- Time must be in seconds.\n- Concentrations are nondimensional.\n- Report magnitudes and booleans as specified, with no percentage signs.\n\nTest Suite and Final Output:\n- Use the following test suite parameters built into the program:\n    - Negative real axis points: $z = -1$, $z = -10$, $z = -100$.\n    - Imaginary axis points: $z = i \\cdot 10$, $z = i \\cdot 100$.\n    - Robertson final state time: $t = 1.0$ seconds.\n    - Step sizes: $h = 10^{-4}$ seconds, $h = 10^{-2}$ seconds, $h = 10^{-1}$ seconds, $h = 1.0$ seconds.\n    - Eigenvalue exclusion tolerance: $|\\lambda| < 10^{-8}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n    - The three floats $|R(-1)|$, $|R(-10)|$, $|R(-100)|$.\n    - The two booleans for $|R(i \\cdot 10)| \\le 1$ and $|R(i \\cdot 100)| \\le 1$.\n    - The four floats representing the maximum $|R(h \\lambda_i)|$ over the negative-real-part eigenvalues at $t = 1.0$ seconds for $h = 10^{-4}$, $10^{-2}$, $10^{-1}$, and $1.0$ seconds, respectively.\n\nThe final output must be exactly of the form $[r_1,r_2,r_3,b_1,b_2,a_1,a_2,a_3,a_4]$, where $r_j$ are floats, b_j$ are booleans, and a_j$ are floats.",
            "solution": "The solution involves several steps: defining the Robertson problem and its Jacobian, deriving the stability function for the specified Alexander SDIRK method, and then performing the numerical computations as requested.\n\n1.  **The Robertson Problem and Stiffness**\n    The Robertson problem models a simple three-species chemical reaction. It is a system of three nonlinear ODEs:\n    $$\n    \\begin{aligned}\n    \\frac{dy_1}{dt} &= -k_1 y_1 + k_2 y_2 y_3 \\\\\n    \\frac{dy_2}{dt} &= k_1 y_1 - k_2 y_2 y_3 - k_3 y_2^2 \\\\\n    \\frac{dy_3}{dt} &= k_3 y_2^2\n    \\end{aligned}\n    $$\n    with rate constants $k_1 = 0.04$, $k_2 = 10^4$, and $k_3 = 3 \\times 10^7$. The initial state is $y(0) = [1, 0, 0]^T$. The system exhibits stiffness, meaning the characteristic time scales of the dynamics differ by many orders of magnitude. The system conserves the total concentration, i.e., $\\frac{d}{dt}(y_1+y_2+y_3) = 0$, so $y_1(t)+y_2(t)+y_3(t) = 1$ for all $t \\ge 0$.\n\n2.  **System Jacobian**\n    The stability and local dynamics of the system are determined by its Jacobian matrix, $J(y) = \\partial f / \\partial y$. For the Robertson system, the components $J_{ij} = \\partial f_i / \\partial y_j$ are:\n    $$\n    J(y) = \\begin{pmatrix}\n    \\frac{\\partial f_1}{\\partial y_1} & \\frac{\\partial f_1}{\\partial y_2} & \\frac{\\partial f_1}{\\partial y_3} \\\\\n    \\frac{\\partial f_2}{\\partial y_1} & \\frac{\\partial f_2}{\\partial y_2} & \\frac{\\partial f_2}{\\partial y_3} \\\\\n    \\frac{\\partial f_3}{\\partial y_1} & \\frac{\\partial f_3}{\\partial y_2} & \\frac{\\partial f_3}{\\partial y_3}\n    \\end{pmatrix} =\n    \\begin{pmatrix}\n    -k_1 & k_2 y_3 & k_2 y_2 \\\\\n    k_1 & -k_2 y_3 - 2k_3 y_2 & -k_2 y_2 \\\\\n    0 & 2 k_3 y_2 & 0\n    \\end{pmatrix}\n    $$\n    The eigenvalues of $J(y)$ at a given state $y$ dictate the local behavior of solutions. Due to the mass conservation, one eigenvalue is always zero.\n\n3.  **The SDIRK Stability Function**\n    A single step of a Runge–Kutta method applied to the linear test equation $dy/dt = \\lambda y$ yields $y_{n+1} = R(z) y_n$, where $z = h\\lambda$. The function $R(z)$ is the stability function. The problem specifies the two-stage, second-order L-stable SDIRK method of Alexander (1977), which is stiffly accurate. Its Butcher tableau is:\n    $$\n    \\begin{array}{c|cc}\n    \\gamma & \\gamma & 0 \\\\\n    1 & 1-\\gamma & \\gamma \\\\\n    \\hline\n    & 1-\\gamma & \\gamma\n    \\end{array}\n    \\quad \\text{with} \\quad \\gamma = 1 - \\frac{1}{\\sqrt{2}}\n    $$\n    For a stiffly accurate SDIRK method, the stability function has the general form:\n    $$\n    R(z) = \\frac{1 + (1-2\\gamma)z}{(1-\\gamma z)^2}\n    $$\n    Substituting $\\gamma = 1 - 1/\\sqrt{2}$, we get $1-2\\gamma = 1 - 2(1 - 1/\\sqrt{2}) = \\sqrt{2}-1$. The explicit stability function is:\n    $$\n    R(z) = \\frac{1 + (\\sqrt{2}-1)z}{\\left(1 - \\left(1 - \\frac{1}{\\sqrt{2}}\\right)z\\right)^2}\n    $$\n\n4.  **Stability Analysis (A-stability and L-stability)**\n    - **A-stability** requires $|R(z)| \\le 1$ for all $z$ with $\\operatorname{Re}(z) \\le 0$. We verify this property for sample points on the imaginary axis, $z=10i$ and $z=100i$.\n    - **L-stability** requires A-stability and additionally that $|R(z)| \\to 0$ as $\\operatorname{Re}(z) \\to -\\infty$. We verify this by evaluating $|R(z)|$ for large negative real numbers $z = -1, -10, -100$. The magnitude should decrease towards zero.\n\n5.  **Numerical Implementation and Computation**\n    The procedure to obtain the required results is as follows:\n    a. Numerically integrate the Robertson ODE system from $t=0$ to $t=1.0$ using a stiff solver to find the state $y(1.0)$.\n    b. Compute the Jacobian matrix $J(y(1.0))$ using the derived formula and the state $y(1.0)$.\n    c. Implement the stability function $R(z)$ in code.\n    d. Evaluate $|R(z)|$ at $z \\in \\{-1, -10, -100\\}$ to check L-stability behavior.\n    e. Evaluate $|R(z)| \\le 1$ at $z \\in \\{10i, 100i\\}$ to check A-stability behavior.\n    f. Compute the eigenvalues $\\lambda_i$ of $J(y(1.0))$. Filter these eigenvalues, keeping only those with $\\operatorname{Re}(\\lambda_i) < 0$ and $|\\lambda_i| \\ge 10^{-8}$.\n    g. For each specified step size $h \\in \\{10^{-4}, 10^{-2}, 10^{-1}, 1.0\\}$, compute the set of amplification factors $|R(h\\lambda_i)|$ for all filtered eigenvalues.\n    h. Report the maximum value from this set for each $h$. This value determines the stability and damping of the numerical solution for the linearized system.\n    i. Combine all results into a single list as specified for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the specified numerical analysis problem involving the Robertson\n    problem and the Alexander SDIRK method.\n    \"\"\"\n    \n    # 1. Define constants and problem parameters\n    k1 = 0.04\n    k2 = 1.0e4\n    k3 = 3.0e7\n    \n    # Alexander SDIRK method parameter\n    gamma = 1.0 - 1.0 / np.sqrt(2)\n    \n    # Initial conditions and time span\n    y0 = np.array([1.0, 0.0, 0.0])\n    t_span = [0.0, 1.0]\n\n    # 2. Define ODE system and its Jacobian\n    def robertson_rhs(t, y):\n        \"\"\"Right-hand side of the Robertson ODE system.\"\"\"\n        dy1 = -k1 * y[0] + k2 * y[1] * y[2]\n        dy2 = k1 * y[0] - k2 * y[1] * y[2] - k3 * y[1]**2\n        dy3 = k3 * y[1]**2\n        return np.array([dy1, dy2, dy3])\n\n    def robertson_jac(t, y):\n        \"\"\"Jacobian of the Robertson ODE system.\"\"\"\n        J = np.zeros((3, 3))\n        # df1/dy\n        J[0, 0] = -k1\n        J[0, 1] = k2 * y[2]\n        J[0, 2] = k2 * y[1]\n        # df2/dy\n        J[1, 0] = k1\n        J[1, 1] = -k2 * y[2] - 2 * k3 * y[1]\n        J[1, 2] = -k2 * y[1]\n        # df3/dy\n        J[2, 1] = 2 * k3 * y[1]\n        return J\n        \n    # 3. Integrate the ODE system to find y(1.0)\n    sol = solve_ivp(\n        fun=robertson_rhs,\n        t_span=t_span,\n        y0=y0,\n        method='Radau', # A stiff solver\n        jac=robertson_jac,\n        rtol=1e-9,\n        atol=1e-12\n    )\n    y_final = sol.y[:, -1]\n    \n    # 4. Implement the Alexander SDIRK stability function R(z)\n    def stability_function_R(z, gamma_val):\n        \"\"\"Stability function for the Alexander SDIRK(2,2) method.\"\"\"\n        _1_minus_2gamma = 1.0 - 2.0 * gamma_val # This is sqrt(2) - 1\n        numerator = 1.0 + _1_minus_2gamma * z\n        denominator = (1.0 - gamma_val * z)**2\n        return numerator / denominator\n        \n    results = []\n\n    # 5. Task: Evaluate |R(z)| for z on the negative real axis\n    real_z_points = [-1.0, -10.0, -100.0]\n    for z in real_z_points:\n        R_val = stability_function_R(z, gamma)\n        results.append(np.abs(R_val))\n    \n    # 6. Task: Check A-stability for z on the imaginary axis\n    imag_z_points = [10.0j, 100.0j]\n    for z in imag_z_points:\n        R_val = stability_function_R(z, gamma)\n        results.append(np.abs(R_val) = 1.0)\n        \n    # 7. Task: Compute linearized amplification factors for the Robertson problem\n    \n    # Compute Jacobian and its eigenvalues at t=1.0\n    J_final = robertson_jac(t_span[1], y_final)\n    eigenvalues = np.linalg.eigvals(J_final)\n    \n    # Filter eigenvalues\n    eigenvalue_tol = 1e-8\n    filtered_eigenvalues = [\n        lam for lam in eigenvalues \n        if np.abs(lam) >= eigenvalue_tol and np.real(lam)  0\n    ]\n    \n    step_sizes_h = [1e-4, 1e-2, 1e-1, 1.0]\n    \n    for h in step_sizes_h:\n        if not filtered_eigenvalues:\n            # This case should not happen for Robertson problem\n            max_amplification = np.nan\n        else:\n            amplification_factors = [\n                np.abs(stability_function_R(h * lam, gamma))\n                for lam in filtered_eigenvalues\n            ]\n            max_amplification = np.max(amplification_factors)\n        results.append(max_amplification)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}