{
    "hands_on_practices": [
        {
            "introduction": "Before applying a sophisticated numerical method, it's crucial to verify its fundamental properties. This practice  focuses on the internal consistency conditions that every Runge–Kutta method must satisfy to be considered valid. You will analyze a given Butcher tableau to see if it meets these basic requirements and, more importantly, interpret what a failure to meet them would mean for simulating a stiff chemical kinetics system.",
            "id": "4017903",
            "problem": "Consider a candidate Diagonally Implicit Runge–Kutta (DIRK) method for stiff chemical kinetics integration in computational combustion, applied to the autonomous ordinary differential equation (ODE) system for species mass fractions,\n$$\n\\frac{dY}{dt}=\\omega(Y,T),\n$$\nwhere $Y$ denotes the vector of species mass fractions and $T$ is the temperature. The method is specified by its Butcher tableau with $s=2$ stages:\n$$\nA=\\begin{pmatrix}\n\\gamma  0 \\\\\n1-\\gamma  \\gamma\n\\end{pmatrix},\\quad\nc=\\begin{pmatrix}\n\\gamma \\\\\n0.999\n\\end{pmatrix},\\quad\nb^{\\top}=\\begin{pmatrix}\n0.5  0.5\n\\end{pmatrix},\n$$\nwith $\\gamma=0.2928932188134524$.\n\nUsing only the fundamental definition of Runge–Kutta methods for autonomous ODEs and their first-order consistency conditions, verify whether the internal consistency condition $A\\mathbf{1}=c$ and the weight-normalization condition $\\sum_{i=1}^{s} b_i=1$ hold for this tableau. Then, for this tableau, compute the scalar violation metric\n$$\nE=\\|A\\mathbf{1}-c\\|_{1}+\\left|\\sum_{i=1}^{s} b_i-1\\right|,\n$$\nwhere $\\|\\cdot\\|_{1}$ is the vector $1$-norm and $\\mathbf{1}$ is the vector in $\\mathbb{R}^{s}$ with all entries equal to $1$.\n\nFinally, interpret physically what each nonzero component of $A\\mathbf{1}-c$ and a nonzero value of $\\sum_{i=1}^{s} b_i-1$ would imply for integrating $\\frac{dY}{dt}=\\omega(Y,T)$ in stiff combustion kinetics. Your final reported value must be $E$ and must be rounded to four significant figures, expressed without units.",
            "solution": "We begin from the definition of a Runge–Kutta method for an autonomous ODE $\\frac{dy}{dt}=f(y)$ with step size $h0$. A general $s$-stage Runge–Kutta scheme defines stage values $Y_i$ via\n$$\nY_i=y_n+h\\sum_{j=1}^{s} a_{ij} f(Y_j),\\quad i=1,\\dots,s,\n$$\nand advances the solution by\n$$\ny_{n+1}=y_n+h\\sum_{i=1}^{s} b_i f(Y_i).\n$$\nFor autonomous problems, the internal consistency condition $A\\mathbf{1}=c$ ensures that, when applied to the linear test problem with a constant right-hand side $f(y)=\\kappa$ for constant $\\kappa$, the stage increments align with the stage abscissae. Indeed, taking $f(y)=\\kappa$ yields\n$$\nY_i=y_n+h\\kappa\\sum_{j=1}^{s} a_{ij},\n$$\nwhile the exact solution at stage abscissa would be $y_n+h\\kappa c_i$. Therefore, internal consistency for autonomous ODEs requires\n$$\n\\sum_{j=1}^{s} a_{ij}=c_i,\\quad \\text{equivalently}\\quad A\\mathbf{1}=c.\n$$\nSimilarly, first-order accuracy for the step update applied to $f(y)=\\kappa$ requires\n$$\ny_{n+1}=y_n+h\\kappa\\sum_{i=1}^{s} b_i\\approx y_n+h\\kappa,\n$$\nwhich implies the weight-normalization condition\n$$\n\\sum_{i=1}^{s} b_i=1.\n$$\n\nWe now evaluate these conditions for the given tableau. Let\n$$\nA=\\begin{pmatrix}\n\\gamma  0 \\\\\n1-\\gamma  \\gamma\n\\end{pmatrix},\\quad\nc=\\begin{pmatrix}\n\\gamma \\\\\n0.999\n\\end{pmatrix},\\quad\nb^{\\top}=\\begin{pmatrix}\n0.5  0.5\n\\end{pmatrix},\\quad\n\\mathbf{1}=\\begin{pmatrix}\n1\\\\\n1\n\\end{pmatrix}.\n$$\nCompute $A\\mathbf{1}$:\n$$\nA\\mathbf{1}=\\begin{pmatrix}\n\\gamma  0 \\\\\n1-\\gamma  \\gamma\n\\end{pmatrix}\\begin{pmatrix}\n1\\\\\n1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\gamma\\cdot 1+0\\cdot 1\\\\\n(1-\\gamma)\\cdot 1+\\gamma\\cdot 1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\gamma\\\\\n1\n\\end{pmatrix}.\n$$\nTherefore,\n$$\nA\\mathbf{1}-c=\\begin{pmatrix}\n\\gamma\\\\\n1\n\\end{pmatrix}-\\begin{pmatrix}\n\\gamma\\\\\n0.999\n\\end{pmatrix}\n=\\begin{pmatrix}\n0\\\\\n1-0.999\n\\end{pmatrix}\n=\\begin{pmatrix}\n0\\\\\n0.001\n\\end{pmatrix}.\n$$\nIts vector $1$-norm is\n$$\n\\|A\\mathbf{1}-c\\|_{1}=|0|+|0.001|=0.001.\n$$\nNext, compute the sum of the weights:\n$$\n\\sum_{i=1}^{2} b_i=0.5+0.5=1.\n$$\nThus,\n$$\n\\left|\\sum_{i=1}^{2} b_i-1\\right|=|1-1|=0.\n$$\nThe violation metric is therefore\n$$\nE=\\|A\\mathbf{1}-c\\|_{1}+\\left|\\sum_{i=1}^{2} b_i-1\\right|=0.001+0=0.001.\n$$\nRounding $E$ to four significant figures yields\n$$\nE=1.000\\times 10^{-3}.\n$$\n\nPhysical interpretation for stiff combustion kinetics $\\frac{dY}{dt}=\\omega(Y,T)$:\n- A nonzero component of $A\\mathbf{1}-c$ indicates that the internal stage location $c_i$ does not equal the row sum $\\sum_{j=1}^{s} a_{ij}$. For autonomous kinetics, this misalignment implies that the stage state $Y_i$ accumulates increments inconsistent with its nominal stage abscissa. In practice, this can degrade stage order, distort the time-centering of reaction source-term evaluations $\\omega(Y,T)$, and, in stiff regimes, exacerbate order reduction and bias the approach to chemical equilibrium.\n- A nonzero value of $\\sum_{i=1}^{s} b_i-1$ indicates failure to reproduce constant source terms exactly over one step. In chemical kinetics, this would mean that when $\\omega(Y,T)$ is effectively constant over a step (e.g., in quasi-steady conditions), the method introduces a systematic drift in $Y$, potentially violating conservation constraints such as the unity sum of mass fractions and misrepresenting reaction progress.\n\nFor the given tableau, the computed $A\\mathbf{1}-c=\\begin{pmatrix}0\\\\0.001\\end{pmatrix}$ shows a small internal inconsistency in the second stage only, while the weight-normalization is exact. Consequently, $E=1.000\\times 10^{-3}$ quantifies a small but nonzero deviation confined to internal staging.",
            "answer": "$$\\boxed{1.000 \\times 10^{-3}}$$"
        },
        {
            "introduction": "A powerful DIRK method is not chosen arbitrarily; it is carefully constructed to balance accuracy and stability. This exercise  guides you through the design process of a two-stage Singly Diagonally Implicit Runge–Kutta (SDIRK) method. By imposing conditions for both second-order accuracy and L-stability—a key property for stiff systems—you will derive the coefficients of a classic method used in computational combustion.",
            "id": "4017939",
            "problem": "Consider a homogeneous, isothermal reactor governed by chemical kinetics with species mass fractions collected in the vector $\\mathbf{Y}(t)$, whose evolution obeys the ordinary differential equation $\\frac{d\\mathbf{Y}}{dt} = \\boldsymbol{\\omega}(\\mathbf{Y})$, where $\\boldsymbol{\\omega}(\\mathbf{Y})$ is the reaction source term derived from mass-action kinetics. In computational combustion, such systems are stiff because the Jacobian $\\frac{\\partial \\boldsymbol{\\omega}}{\\partial \\mathbf{Y}}$ contains eigenvalues with large negative real parts. To integrate this system, you will construct a two-stage Singly Diagonally Implicit Runge–Kutta (SDIRK) method of order two and select its parameters to maximize linear stability for the linearized stiff kinetic modes.\n\nAssume a two-stage SDIRK method with a shared diagonal parameter $\\gamma$ in its coefficient matrix, stage abscissae $c_{1} = \\gamma$ and $c_{2} = 1$, and Butcher coefficients\n$$\nA = \\begin{pmatrix}\n\\gamma  0 \\\\\na_{21}  \\gamma\n\\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix}\nb_{1} \\\\ b_{2}\n\\end{pmatrix}.\n$$\nThe stage abscissa constraint $c_{2} = 1$ enforces $a_{21} = 1 - \\gamma$ by definition. Using only the second-order accuracy requirements for Runge–Kutta methods applied to autonomous systems, construct the coefficients $a_{21}$ and $\\mathbf{b}$ as functions of $\\gamma$.\n\nThen, consider linear stability for the scalar linear test equation $\\frac{dy}{dt} = \\lambda y$ with $z = h \\lambda$ and $h  0$, and define the amplification factor $R(z)$ as the ratio $y_{n+1}/y_{n}$ generated by your SDIRK method. In the stiff kinetics regime relevant to computational combustion, “maximizing linear stability” is taken in the precise sense of Linear stability (“L-stability”), namely that the amplification factor satisfies $\\lim_{z \\to -\\infty} R(z) = 0$ along the negative real axis. Enforce stiff accuracy, meaning the method’s weight vector equals the last row of $A$, i.e., $b_{1} = a_{21}$ and $b_{2} = \\gamma$, and impose the second-order accuracy conditions together with stiff accuracy to choose $\\gamma$ so that the method is L-stable.\n\nYour task:\n- Derive the second-order conditions for the two-stage Runge–Kutta method and solve for $a_{21}$ and $\\mathbf{b}$ in terms of $\\gamma$.\n- Construct $R(z)$ for the SDIRK method and explain how stiff accuracy enforces L-stability for stiff kinetic modes.\n- Using the second-order conditions together with stiff accuracy, determine the unique $\\gamma$ that yields an order-two, L-stable two-stage SDIRK method.\n\nExpress the final value of $\\gamma$ as a closed-form analytic expression. No rounding is required and no physical units should be reported in the answer.",
            "solution": "The task is to determine the unique parameter $\\gamma$ for a two-stage, second-order, L-stable SDIRK method constrained by stiff accuracy.\n\nFirst, we derive the coefficients of the Runge–Kutta method as functions of $\\gamma$ using the second-order accuracy conditions. A Runge–Kutta method is of order $p=2$ if it satisfies the following two conditions for autonomous systems:\n1.  Order 1 condition: $\\sum_{i=1}^{s} b_i = 1$\n2.  Order 2 condition: $\\sum_{i=1}^{s} b_i c_i = \\frac{1}{2}$\n\nFor the given two-stage ($s=2$) method, the Butcher tableau has stage abscissae $c_1 = \\gamma$ and $c_2 = 1$. The row-sum-to-$c_i$ condition for the second stage, $c_2 = a_{21} + a_{22}$, gives $1 = a_{21} + \\gamma$, confirming the constraint $a_{21} = 1 - \\gamma$.\nSubstituting $s=2$, $c_1 = \\gamma$, and $c_2 = 1$ into the order conditions yields a system for the weights $b_1$ and $b_2$:\n$$\nb_1 + b_2 = 1\n$$\n$$\nb_1 \\gamma + b_2 (1) = \\frac{1}{2}\n$$\nSolving this system gives $b_1 = \\frac{1}{2(1-\\gamma)}$ and $b_2 = \\frac{1-2\\gamma}{2(1-\\gamma)}$ (assuming $\\gamma \\neq 1$).\n\nSecond, we construct the stability function $R(z)$ and analyze L-stability. A Runge–Kutta method applied to the test equation $\\frac{dy}{dt} = \\lambda y$ yields $y_{n+1} = R(z) y_n$, where $z = h\\lambda$. The problem specifies stiff accuracy, meaning the weights vector $\\mathbf{b}$ is identical to the last row of the matrix $A$. For our $s=2$ case, this means $b_1 = a_{21}$ and $b_2 = a_{22} = \\gamma$. This implies the final solution is identical to the last stage value, $y_{n+1} = Y_2$.\nThe stage equations are:\n$$\nY_1 = y_n + h a_{11} \\lambda Y_1 \\implies \\frac{Y_1}{y_n} = \\frac{1}{1-z\\gamma}\n$$\n$$\nY_2 = y_n + h a_{21} \\lambda Y_1 + h a_{22} \\lambda Y_2 \\implies \\frac{Y_2}{y_n}(1-z\\gamma) = 1 + z a_{21} \\frac{Y_1}{y_n}\n$$\nSubstituting for $Y_1/y_n$ gives the stability function:\n$$\nR(z) = \\frac{Y_2}{y_n} = \\frac{1 + z a_{21} \\frac{1}{1-z\\gamma}}{1-z\\gamma} = \\frac{1-z\\gamma + z a_{21}}{(1-z\\gamma)^2}\n$$\nL-stability requires $\\lim_{z \\to -\\infty} R(z) = 0$. Since the numerator is a polynomial in $z$ of degree 1 and the denominator is degree 2 (for $\\gamma \\neq 0$), the limit is 0. Thus, any SDIRK method with stiff accuracy is L-stable.\n\nThird, we determine the unique value of $\\gamma$ by imposing both second-order accuracy and stiff accuracy.\nThe conditions are: $c_1=\\gamma$, $c_2=1$, $a_{21}=1-\\gamma$, $b_1=a_{21}=1-\\gamma$, and $b_2=\\gamma$.\nThe first order condition, $b_1 + b_2 = 1$, becomes $(1-\\gamma) + \\gamma = 1$, which is consistent.\nThe second order condition, $b_1 c_1 + b_2 c_2 = \\frac{1}{2}$, becomes:\n$$\n(1-\\gamma)(\\gamma) + (\\gamma)(1) = \\frac{1}{2}\n$$\nThis gives a quadratic equation for $\\gamma$:\n$$\n\\gamma - \\gamma^2 + \\gamma = \\frac{1}{2} \\implies 2\\gamma^2 - 4\\gamma + 1 = 0\n$$\nThe solutions are $\\gamma = \\frac{4 \\pm \\sqrt{16-8}}{4} = 1 \\pm \\frac{\\sqrt{2}}{2}$.\nThe two possible solutions are $\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.2929$ and $\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1.7071$.\nFor applications in chemical kinetics, it is desirable to have non-negative coefficients to help preserve the non-negativity of mass fractions.\n-   If $\\gamma = \\gamma_2 = 1 + \\frac{\\sqrt{2}}{2}$, then $a_{21} = 1-\\gamma_2 = -\\frac{\\sqrt{2}}{2}  0$. This is undesirable.\n-   If $\\gamma = \\gamma_1 = 1 - \\frac{\\sqrt{2}}{2}$, then all characteristic coefficients ($a_{21}$, $b_1$, $b_2$, $\\gamma$) are positive.\nTherefore, the desired value is $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$.",
            "answer": "$$ \\boxed{1 - \\frac{\\sqrt{2}}{2}} $$"
        },
        {
            "introduction": "Real-world computation is often about more than just formal accuracy; it is also about physical realism. This problem  challenges you to think critically about how to handle unphysical results, such as negative mass fractions, that can arise during a simulation. You will evaluate different modification strategies and learn why sophisticated limiter-based approaches are often preferred for preserving both positivity and high-order accuracy.",
            "id": "4017898",
            "problem": "Consider a spatially homogeneous reacting mixture with $N$ chemical species and mass fractions $\\mathbf{Y} = (Y_1,\\dots,Y_N)^T$, advancing in time according to the ordinary differential equation system\n$$\n\\frac{d \\mathbf{Y}}{dt} = \\boldsymbol{\\omega}(\\mathbf{Y},T), \\quad \\sum_{i=1}^N \\omega_i(\\mathbf{Y},T) = 0, \\quad Y_i \\ge 0,\n$$\nwhere $\\boldsymbol{\\omega}$ is the chemical source term at temperature $T$ and the constraint $\\sum_{i=1}^N \\omega_i = 0$ enforces conservation of total mass fraction. A Diagonally Implicit Runge–Kutta (DIRK) method with $s$ stages and formal order $p$ advances $\\mathbf{Y}^n \\approx \\mathbf{Y}(t^n)$ to $\\mathbf{Y}^{n+1}$ via stage solves of the form\n$$\n\\mathbf{Y}^{(k)} = \\mathbf{Y}^n + \\Delta t \\sum_{j=1}^k a_{kj} \\, \\boldsymbol{\\omega}\\big(\\mathbf{Y}^{(j)},T^{(j)}\\big), \\quad k=1,\\dots,s,\n$$\nwith $a_{kk}  0$, and then a final combination of stages. In stiff kinetics, the implicit stage solutions $\\mathbf{Y}^{(k)}$ can exhibit components slightly below $0$ due to solver tolerances or under-resolved time steps, which is unphysical.\n\nYou are asked to select the statement that correctly proposes a positivity-preserving modification to the DIRK stage update for mass fractions and accurately characterizes its effect on the formal order of accuracy.\n\nA. After each stage, apply species-wise clipping and renormalization: set $Y_i^{(k)} \\leftarrow \\max\\{0, Y_i^{(k)}\\}$ and then rescale all components so that $\\sum_{i=1}^N Y_i^{(k)} = 1$. This guarantees positivity and exact conservation for any $\\Delta t$, but it always reduces the overall DIRK method to first-order accuracy globally, even as $\\Delta t \\to 0$.\n\nB. After computing an unconstrained stage $\\mathbf{Y}^{(k),*}$, define a limiter coefficient\n$$\n\\theta^{(k)} = \\min\\Big\\{\\,1, \\; \\min_{i \\,:\\, Y_i^{(k),*}  0} \\frac{Y_i^n}{Y_i^n - Y_i^{(k),*}} \\Big\\},\n$$\nand replace the stage by the convex combination\n$$\n\\mathbf{Y}^{(k)} \\leftarrow \\theta^{(k)} \\,\\mathbf{Y}^{(k),*} + \\big(1-\\theta^{(k)}\\big)\\,\\mathbf{Y}^n.\n$$\nThis enforces $Y_i^{(k)} \\ge 0$ for all $i$ and preserves $\\sum_i Y_i^{(k)}$ when $\\sum_i Y_i^{(k),*} = \\sum_i Y_i^n$, while leaving the stage unchanged when $\\mathbf{Y}^{(k),*}$ is already nonnegative. The formal order $p$ of the DIRK method is therefore retained whenever the limiter is inactive (e.g., for sufficiently small $\\Delta t$ so that no negativity occurs), whereas local accuracy degrades toward first order only on stages where the limiter activates.\n\nC. Scale the entire source term by a global factor at each stage to enforce nonnegativity, i.e., replace $\\boldsymbol{\\omega}$ by $\\alpha^{(k)} \\boldsymbol{\\omega}$ with $\\alpha^{(k)} \\in (0,1]$ chosen so that all $Y_i^{(k)} \\ge 0$. Because this scaling is equivalent to a time rescaling, it preserves both positivity and the original DIRK order $p$ for any $\\Delta t$.\n\nD. Replace the diagonal DIRK coefficient by its absolute value, i.e., use $|a_{kk}|$ in place of $a_{kk}$ in the stage equation. This change ensures positivity of the implicit update without affecting the DIRK order conditions, so the original order $p$ is preserved.",
            "solution": "The problem requires us to assess different strategies for enforcing the positivity constraint $Y_i \\ge 0$ within the stages of a DIRK method and to characterize the effect of these modifications on the formal order of accuracy, $p$. A key property of the underlying DIRK method, derived from the mass conservation constraint $\\sum_{i=1}^N \\omega_i = 0$, is that the unmodified stages also conserve the sum of mass fractions: $\\sum_{i=1}^N Y_i^{(k)} = \\sum_{i=1}^N Y_i^n$. Any modification must be evaluated for its effect on this property and on accuracy.\n\n**A.** This option proposes clipping negative values to zero and then renormalizing the entire vector to sum to one. While this procedure guarantees positivity and mass conservation, the claim that it *always* reduces the accuracy to first order, *even as $\\Delta t \\to 0$*, is too strong. For a smooth solution where all components are positive, a convergent numerical method will also produce positive stage values for a sufficiently small time step $\\Delta t$. In this regime, the modification would not be activated, and the method's formal order $p$ would be retained. The modification only degrades accuracy when it is active. Therefore, the statement is imprecise.\n\n**B.** This option describes a sophisticated limiter that replaces an unconstrained stage $\\mathbf{Y}^{(k),*}$ with a convex combination of itself and the previous step's solution, $\\mathbf{Y}^{(k)} \\leftarrow \\theta^{(k)} \\,\\mathbf{Y}^{(k),*} + \\big(1-\\theta^{(k)}\\big)\\,\\mathbf{Y}^n$. Let's analyze its properties:\n- **Positivity:** The limiter coefficient $\\theta^{(k)}$ is constructed such that for any component $i$ where $Y_i^{(k),*}  0$, we have $\\theta^{(k)} \\le Y_i^n / (Y_i^n - Y_i^{(k),*})$. This inequality directly leads to the modified stage value $Y_i^{(k)}$ being non-negative. For components that were already non-negative, the new value is a convex combination of two non-negative numbers and thus remains non-negative. The method correctly enforces positivity.\n- **Conservation:** Since the unmodified stage is conservative ($\\sum_i Y_i^{(k),*} = \\sum_i Y_i^n$), the convex combination also preserves the sum: $\\sum_i Y_i^{(k)} = \\theta^{(k)} \\sum_i Y_i^{(k),*} + (1-\\theta^{(k)}) \\sum_i Y_i^n = \\theta^{(k)} \\sum_i Y_i^n + (1-\\theta^{(k)}) \\sum_i Y_i^n = \\sum_i Y_i^n$.\n- **Accuracy:** If the unconstrained stage is already positive, $\\theta^{(k)}=1$, the stage is unmodified, and the formal order $p$ is preserved. If the limiter is active ($\\theta^{(k)}  1$), the stage accuracy is locally degraded. This behavior—retaining the original high order when possible and applying a minimal correction only when necessary—is the design goal of modern high-resolution, constraint-preserving schemes. The characterization of its effect on accuracy is correct.\n\n**C.** This option suggests scaling the entire source term vector $\\boldsymbol{\\omega}$ by a factor $\\alpha^{(k)}$. The claim that this is \"equivalent to a time rescaling\" and preserves the original order $p$ is incorrect. High-order Runge–Kutta methods rely on a delicate cancellation of error terms based on specific coefficients ($a_{kj}$, $b_j$) that are valid only for the original ODE. Altering the ODE being solved at each stage by introducing a state-dependent factor $\\alpha^{(k)}$ disrupts these cancellations, generally reducing the method's accuracy to first order when the scaling is active.\n\n**D.** This option proposes replacing $a_{kk}$ with $|a_{kk}|$. Since the problem premise is that for a DIRK method $a_{kk} > 0$, this means $|a_{kk}| = a_{kk}$. The proposed \"modification\" makes no change to the algorithm. It therefore cannot introduce the property of positivity, which the original method lacks. The statement is nonsensical.\n\nBased on this analysis, statement B provides the only correct description of a valid positivity-preserving technique and its effect on accuracy.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}