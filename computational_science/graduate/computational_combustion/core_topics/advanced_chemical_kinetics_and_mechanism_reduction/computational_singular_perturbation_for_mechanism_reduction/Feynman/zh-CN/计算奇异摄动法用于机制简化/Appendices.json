{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在揭示准稳态近似（QSSA）的局限性。通过一个具体的双物种系统，我们将展示为何基于雅可比矩阵 $\\boldsymbol{J}$ 对角线元素的简单判据可能会错误地识别快物种。此练习突出了进行模态分析的必要性，并阐明了非对角线耦合项在决定真实系统动力学中的关键作用。",
            "id": "4013277",
            "problem": "考虑一个稳态附近的均相、等温反应器模型，其中组分质量分数向量 $\\boldsymbol{y}$ 遵循常微分方程 $\\frac{d \\boldsymbol{y}}{dt} = \\boldsymbol{\\omega}(\\boldsymbol{y}, T)$ 演化。在稳态 $(\\boldsymbol{y}^\\star, T^\\star)$ 附近进行线性化，得到 $\\frac{d \\boldsymbol{\\eta}}{dt} = \\boldsymbol{J} \\boldsymbol{\\eta}$，其中 $\\boldsymbol{\\eta} = \\boldsymbol{y} - \\boldsymbol{y}^\\star$，雅可比矩阵为 $\\boldsymbol{J} = \\left.\\frac{\\partial \\boldsymbol{\\omega}}{\\partial \\boldsymbol{y}}\\right|_{(\\boldsymbol{y}^\\star, T^\\star)}$。对于一个双组分亚系统，假设\n$$\n\\boldsymbol{J} = \\begin{bmatrix}\n-100  90 \\\\\n-5  -1\n\\end{bmatrix}\\ \\text{s}^{-1}.\n$$\n一个常见的准稳态近似（QSSA）判据是，当组分 $i$ 的表观对角弛豫时间 $\\tau_i^{\\mathrm{diag}} = |J_{ii}|^{-1}$ 远小于其他组分时，就将其判定为准稳态。与此相反，计算奇异摄动（CSP）方法利用 $\\boldsymbol{J}$ 的左右特征向量对源项进行模态分解，以分离快慢子空间。\n\n假设初始扰动与慢特征方向对齐，即 $\\boldsymbol{\\eta}(0) = \\boldsymbol{v}_s$，其中 $\\boldsymbol{v}_s$ 是与慢特征值相关联的 $\\boldsymbol{J}$ 的右特征向量。仅利用线性化、特征值和特征向量的基本定义以及所述的 QSSA 和 CSP 的含义，选择能正确提供以下内容的选项：\n- 对于给定的 $\\boldsymbol{J}$，一个因组分导数与快模态不对齐而导致 QSSA 失效的示例判据，以及\n- 一个关于 CSP 的模态分解如何解决这种错误分类的物理上合理的论证。\n\nA. QSSA 对角速率判据（$|J_{11}| \\gg |J_{22}|$）会因为 $|J_{11}| = 100$ 很大而将组分 1 归类为准稳态。当组分导数与慢特征模态对齐时（如对于 $\\boldsymbol{\\eta}(0) = \\boldsymbol{v}_s$），该判据会失效，使得尽管 $|J_{11}|$ 很大，$\\frac{dy_1}{dt}$ 仍由慢动态主导。CSP 通过使用双正交的左右特征向量将源项投影到慢、快子空间来解决这个问题；如果组分 1 源项的慢投影不可忽略，CSP 就不会将组分 1 标记为准稳态。\n\nB. QSSA 在此失效是因为 $y_1$ 的量级很小，而 CSP 通过缩放组分浓度以强制 $y_1$ 相对于 $y_2$ 的微小性来修正这个问题，这保证了与快子空间的对齐。\n\nC. QSSA 仅对非线性动力学失效；对于给定的线性 $\\boldsymbol{J}$，QSSA 是精确的。CSP 是不必要的，任何错误分类都可以通过将 $\\boldsymbol{J}$ 的非对角线元素置零来消除。\n\nD. QSSA 仅在 $\\boldsymbol{J}$ 具有复特征值时失效；由于这里的特征值是实数，QSSA 是正确的。CSP 无法解决任何错误分类，因为模态分解是基不变的，并且与对角判据相比没有优势。",
            "solution": "题目陈述是关于线性稳定性分析及其在化学动力学模型降阶技术中应用的一个有效练习，具体地，它将准稳态近似（QSSA）的简单对角判据与计算奇异摄动（CSP）的模态分析进行了对比。该问题在科学上是成立的、提法恰当且客观的。所有必要的数据，包括系统的雅可比矩阵和一个特定的初始条件，都已提供。\n\n我们首先分析该系统以及两种不同方法所带来的影响。系统的演化由线性化方程 $\\frac{d \\boldsymbol{\\eta}}{dt} = \\boldsymbol{J} \\boldsymbol{\\eta}$ 描述，给定的雅可比矩阵为：\n$$\n\\boldsymbol{J} = \\begin{bmatrix}\n-100  90 \\\\\n-5  -1\n\\end{bmatrix}\\ \\text{s}^{-1}\n$$\n\n**1. QSSA 判据分析**\n\n问题描述了一个基于表观对角弛豫时间 $\\tau_i^{\\mathrm{diag}} = |J_{ii}|^{-1}$ 的常见 QSSA 判据。如果组分 $i$ 的弛豫时间远小于其他组分，它就被判定为准稳态，这等价于其雅可比矩阵对角元素 $|J_{ii}|$ 远大于其他组分。\n\n对于给定的系统：\n- 对于组分 1：对角元素为 $J_{11} = -100$。其大小为 $|J_{11}| = 100\\ \\text{s}^{-1}$。表观弛豫时间为 $\\tau_1^{\\mathrm{diag}} = (100)^{-1} = 0.01\\ \\text{s}$。\n- 对于组分 2：对角元素为 $J_{22} = -1$。其大小为 $|J_{22}| = 1\\ \\text{s}^{-1}$。表观弛豫时间为 $\\tau_2^{\\mathrm{diag}} = (1)^{-1} = 1\\ \\text{s}$。\n\n由于 $|J_{11}| = 100 \\gg |J_{22}| = 1$ (或 $\\tau_1^{\\mathrm{diag}} \\ll \\tau_2^{\\mathrm{diag}}$)，这个 QSSA 判据会明确地将组分 1 归类为“快”组分或准稳态组分，而组分 2 则被认为是“慢”组分。这种近似隐含地假设，每个组分的动力学主要由其自相互作用项 $J_{ii}$ 控制，而非对角耦合项不那么重要。\n\n**2. 通过计算奇异摄动（CSP）/ 模态分析进行分析**\n\nCSP 方法基于系统的模态分解，这需要求解雅可比矩阵 $\\boldsymbol{J}$ 的特征值和特征向量。特征值代表了系统模态的真实时间尺度，而特征向量则定义了这些模态在组分相空间中的方向。\n\n特征方程为 $\\det(\\boldsymbol{J} - \\lambda\\boldsymbol{I}) = 0$。\n$$\n\\det \\begin{pmatrix} -100 - \\lambda  90 \\\\ -5  -1 - \\lambda \\end{pmatrix} = (-100 - \\lambda)(-1 - \\lambda) - (90)(-5) = 0\n$$\n$$\n(\\lambda + 100)(\\lambda + 1) + 450 = 0\n$$\n$$\n\\lambda^2 + 101\\lambda + 100 + 450 = 0\n$$\n$$\n\\lambda^2 + 101\\lambda + 550 = 0\n$$\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda = \\frac{-101 \\pm \\sqrt{101^2 - 4(1)(550)}}{2} = \\frac{-101 \\pm \\sqrt{10201 - 2200}}{2} = \\frac{-101 \\pm \\sqrt{8001}}{2}\n$$\n近似 $\\sqrt{8001} \\approx 89.45$，我们找到两个特征值：\n- 快特征值：$\\lambda_f = \\frac{-101 - 89.45}{2} \\approx -95.22\\ \\text{s}^{-1}$。快时间尺度是 $\\tau_f = |\\lambda_f|^{-1} \\approx 0.0105\\ \\text{s}$。\n- 慢特征值：$\\lambda_s = \\frac{-101 + 89.45}{2} \\approx -5.77\\ \\text{s}^{-1}$。慢时间尺度是 $\\tau_s = |\\lambda_s|^{-1} \\approx 0.173\\ \\text{s}$。\n\n该系统是刚性的，因为存在时间尺度的分离 ($|\\lambda_f| \\gg |\\lambda_s|$)。现在我们求解相应的右特征向量。\n\n- **对应于慢模态（$\\lambda_s \\approx -5.77$）的右特征向量 $\\boldsymbol{v}_s$：**\n  $(\\boldsymbol{J} - \\lambda_s \\boldsymbol{I})\\boldsymbol{v}_s = \\boldsymbol{0}$\n  $$\n  \\begin{pmatrix} -100 - (-5.77)  90 \\\\ -5  -1 - (-5.77) \\end{pmatrix} \\begin{pmatrix} v_{s1} \\\\ v_{s2} \\end{pmatrix} = \\begin{pmatrix} -94.23  90 \\\\ -5  4.77 \\end{pmatrix} \\begin{pmatrix} v_{s1} \\\\ v_{s2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n  $$\n  从第二行，$-5v_{s1} + 4.77v_{s2} = 0$，可得 $v_{s1} \\approx 0.954 v_{s2}$。\n  慢特征向量近似为 $\\boldsymbol{v}_s \\propto \\begin{pmatrix} 0.954 \\\\ 1 \\end{pmatrix}$。该向量在组分 1 和组分 2 上都有显著的分量。\n\n- **对应于快模态（$\\lambda_f \\approx -95.22$）的右特征向量 $\\boldsymbol{v}_f$：**\n  $(\\boldsymbol{J} - \\lambda_f \\boldsymbol{I})\\boldsymbol{v}_f = \\boldsymbol{0}$\n  $$\n  \\begin{pmatrix} -100 - (-95.22)  90 \\\\ -5  -1 - (-95.22) \\end{pmatrix} \\begin{pmatrix} v_{f1} \\\\ v_{f2} \\end{pmatrix} = \\begin{pmatrix} -4.78  90 \\\\ -5  94.22 \\end{pmatrix} \\begin{pmatrix} v_{f1} \\\\ v_{f2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n  $$\n  从第一行，$-4.78v_{f1} + 90v_{f2} = 0$，可得 $v_{f1} \\approx 18.83 v_{f2}$。\n  快特征向量近似为 $\\boldsymbol{v}_f \\propto \\begin{pmatrix} 18.83 \\\\ 1 \\end{pmatrix}$。\n\n**3. 协调 QSSA 和 CSP 的观点**\n\n题目陈述初始扰动与慢特征方向对齐，即 $\\boldsymbol{\\eta}(0) = \\boldsymbol{v}_s$。\n线性常微分方程的解为 $\\boldsymbol{\\eta}(t) = e^{\\boldsymbol{J}t}\\boldsymbol{\\eta}(0)$。由于 $\\boldsymbol{\\eta}(0)$ 是 $\\boldsymbol{J}$ 的一个特征向量，解可以简化为：\n$$\n\\boldsymbol{\\eta}(t) = e^{\\lambda_s t} \\boldsymbol{v}_s\n$$\n这意味着整个系统，包括两个扰动分量 $\\eta_1(t)$ 和 $\\eta_2(t)$，都只在慢时间尺度 $\\tau_s = |\\lambda_s|^{-1} \\approx 0.173\\ \\text{s}$ 上演化。在时间尺度 $\\tau_f \\approx 0.0105\\ \\text{s}$ 上衰减的快模态完全没有被激发。\n\n组分扰动的变化率为：\n$$\n\\frac{d\\boldsymbol{\\eta}}{dt} = \\frac{d}{dt}(e^{\\lambda_s t} \\boldsymbol{v}_s) = \\lambda_s e^{\\lambda_s t} \\boldsymbol{v}_s = \\lambda_s \\boldsymbol{\\eta}(t)\n$$\n具体到组分 1：\n$$\n\\frac{d\\eta_1}{dt} = \\lambda_s \\eta_1(t)\n$$\n组分 1 的动力学完全由慢特征值 $\\lambda_s$ 控制。这直接与 QSSA 对角判据得出的结论相矛盾，该判据将组分 1 标记为“快”组分。失效的原因是强大的非对角元素（$J_{12}=90, J_{21}=-5$），它们耦合了这些组分，并导致真实模态（特征向量）与组分坐标轴（标准基向量 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$）显著不对齐。\n\nCSP 解决了这个问题。通过将源项 $\\boldsymbol{\\omega} \\approx \\boldsymbol{J}\\boldsymbol{\\eta}$ 分解为其模态分量（即到快慢特征子空间的投影），CSP 确定了每个组分的变化率参与快慢动态的程度。在本例中，当 $\\boldsymbol{\\eta}(0)=\\boldsymbol{v}_s$ 时，源项为 $\\boldsymbol{J}\\boldsymbol{\\eta}(0) = \\lambda_s \\boldsymbol{v}_s$，其在快子空间上的投影为零。组分 1 的源项 $(\\boldsymbol{J}\\boldsymbol{\\eta})_1$ 在慢子空间上的投影是不可忽略的（它就是其源项的全部）。因此，CSP 会正确地识别出在这种条件下，组分 1 并不处于准稳态。\n\n**选项评估**\n\n**A.** 该选项正确地指出，基于 $|J_{11}| \\gg |J_{22}|$ 的 QSSA 判据会将组分 1 归类为准稳态。它正确地识别了失效机制：当状态（以及导数）与慢特征模态对齐时，尽管 $|J_{11}|$ 的值很大，组分 1 仍然演化得很慢。然后，它正确地描述了 CSP 如何通过使用投影来检查组分的源项在慢子空间中是否具有不可忽略的分量，从而解决了这个问题。这与我们的分析完全一致。**正确**。\n\n**B.** 该选项错误地将 QSSA 的失效归因于组分浓度 $y_1$ 的量级，而题目并未给出相关信息。问题在于雅可比矩阵内部的速率和耦合，而非浓度量级。它还将 CSP 错误地描述为一种缩放方法，并错误地描述了快特征向量的构成。**错误**。\n\n**C.** 该选项声称 QSSA 对于线性系统是精确的，这是错误的。整个线性常微分方程的刚性分析领域都表明，对角占优并不是精确简化的充分条件。本题中的反例（是线性的）证明了这一说法的错误。建议将非对角元素置零不是一种有效的方法，因为它改变了所研究系统的基本性质。**错误**。\n\n**D.** 该选项错误地声称 QSSA 仅在特征值为复数时才会失效。本题是 QSSA 在实特征值情况下失效的典型例子。它还作出了一个根本性错误断言，即模态分解与对角判据相比没有优势。在这种情况下，模态分解的全部目的就是转换到一个动力学解耦的基，从而揭示真实的系统模态，这相对于依赖于基的对角判据来说是一个决定性的优势。**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在理解了模态分析的重要性之后，本练习将指导您动手实现计算奇异摄动（CSP）方法的核心诊断算法。通过计算特征值、模态振幅和参与指数等关键指标，您将学会如何定量地识别出由快速动力学主导的物种，从而确定准稳态（QSS）物种的候选者。这个编程实践将深化您对CSP理论如何转化为实用模型简化工具的理解。",
            "id": "4013300",
            "problem": "考虑一个用于描述化学反应混合物中物种质量分数的无量纲自治常微分方程组，写作 $d\\mathbf{y}/dt = \\mathbf{f}(\\mathbf{y})$，其中 $\\mathbf{y} \\in \\mathbb{R}^n$，源项 $\\mathbf{f}: \\mathbb{R}^n \\to \\mathbb{R}^n$ 在一个工作点 $\\mathbf{y}^\\star$ 处可微。定义雅可比矩阵 $J = \\partial \\mathbf{f}/\\partial \\mathbf{y} \\big|_{\\mathbf{y}^\\star} \\in \\mathbb{R}^{n \\times n}$。在计算奇异摄动 (Computational Singular Perturbation, CSP) 方法中，雅可比矩阵 $J$ 被分解为其左右特征向量矩阵和特征值，源项被投影到模态振幅上，以评估快慢动力学。设 $R = [\\mathbf{r}_1,\\dots,\\mathbf{r}_n]$ 是以 $J$ 的右特征向量为列的矩阵，设 $W = [\\mathbf{w}_1,\\dots,\\mathbf{w}_n]$ 是以 $J$ 的左特征向量为列的矩阵，并设 $\\lambda_i$ 是与模态 $i$ 相关联的特征值。将左右特征向量进行归一化，使得 $\\mathbf{w}_i^\\dagger \\mathbf{r}_j = \\delta_{ij}$，其中 $\\dagger$ 表示复共轭转置，$\\delta_{ij}$ 是克罗内克δ函数。模态振幅定义为 $a_i = \\mathbf{w}_i^\\dagger \\mathbf{f}$，因此 $\\mathbf{f} = \\sum_{i=1}^n a_i \\mathbf{r}_i$。对于每个模态 $i$ 和物种 $j$，定义参与度指标 $p_{ij} = \\left|b_i^j a_i\\right|$，其中 $b_i^j$ 是第 $i$ 个右特征向量 $\\mathbf{r}_i$ 的第 $j$ 个分量。该指标量化了物种 $j$ 在模态 $i$ 中的参与程度。\n\n目标是：\n1. 对于给定的雅可比矩阵 $J$ 和源项 $\\mathbf{f}$，计算参与度指标 $p_{ij}$。\n2. 使用时间尺度 $\\tau_i = 1/\\left|\\operatorname{Re}(\\lambda_i)\\right|$ 将模态分为快模态和慢模态，约定如果 $\\operatorname{Re}(\\lambda_i) = 0$，则 $\\tau_i = +\\infty$。\n3. 对于每个物种 $j$，计算其源项中归因于快模态的比例，\n$$\n\\phi_j^{\\text{fast}} = \\frac{\\sum_{i \\in \\mathcal{F}} p_{ij}}{\\sum_{i=1}^n p_{ij}},\n$$\n其中 $\\mathcal{F}$ 是快模态的索引集合，由 $\\tau_i < \\tau_{\\text{thresh}}$ 定义，分母是物种 $j$ 的总绝对模态贡献。\n4. 将满足 $\\phi_j^{\\text{fast}} \\ge \\theta$ 和 $\\sum_{i=1}^n p_{ij} > \\varepsilon$（一个小的数值容差，以避免平凡的零源项情况）的物种 $j$ 识别为准稳态 (Quasi-Steady-State, QSS) 物种候选者。此准则遵循 CSP 的基本原理，即 QSS 物种主要由快动力学控制，慢模态的参与可以忽略不计。\n\n所有量均为无量纲。允许出现复数特征值和特征向量；在指定位置使用复数量的绝对值。在计算模态振幅之前，必须对左特征向量与右特征向量进行双正交归一化，以确保 $\\mathbf{w}_i^\\dagger \\mathbf{r}_j = \\delta_{ij}$。\n\n您的程序必须为以下测试套件实现此过程，并为每个测试用例生成 QSS 物种候选者的索引列表（从零开始）。将所有测试用例的结果汇总到单行输出中，该输出包含一个用方括号括起来的逗号分隔列表，其中每个元素本身是代表物种索引的整数列表（例如，\"[[0,2],[1],[]]\"）。\n\n测试套件：\n- 情况 A（良性分离的负特征值；三个物种）：\n  - $J = \\begin{bmatrix} -1.0  0.2  0.0 \\\\ 0.0  -10.0  1.0 \\\\ 0.0  -0.5  -100.0 \\end{bmatrix}$,\n  - $\\mathbf{f} = \\begin{bmatrix} 0.5 \\\\ -1.0 \\\\ 2.0 \\end{bmatrix}$,\n  - $\\tau_{\\text{thresh}} = 0.2$,\n  - $\\theta = 0.85$,\n  - $\\varepsilon = 10^{-12}$。\n- 情况 B（复共轭对；边界时间尺度；三个物种）：\n  - $J = \\begin{bmatrix} -5.0  -10.0  0.0 \\\\ 10.0  -5.0  0.0 \\\\ 0.1  0.0  -0.5 \\end{bmatrix}$,\n  - $\\mathbf{f} = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.1 \\end{bmatrix}$,\n  - $\\tau_{\\text{thresh}} = 0.2$,\n  - $\\theta = 0.80$,\n  - $\\varepsilon = 10^{-12}$。\n- 情况 C（近守恒方向；一个零特征值；三个物种）：\n  - $J = \\begin{bmatrix} 0.0  0.0  0.0 \\\\ 0.0  -2.0  0.0 \\\\ 0.0  0.5  -50.0 \\end{bmatrix}$,\n  - $\\mathbf{f} = \\begin{bmatrix} 0.0 \\\\ 0.1 \\\\ -0.2 \\end{bmatrix}$,\n  - $\\tau_{\\text{thresh}} = 0.05$,\n  - $\\theta = 0.90$,\n  - $\\varepsilon = 10^{-12}$。\n- 情况 D（小振幅边界情况；三个物种）：\n  - $J = \\begin{bmatrix} -1.0  0.0  0.0 \\\\ 0.0  -80.0  0.0 \\\\ 0.1  0.2  -5.0 \\end{bmatrix}$,\n  - $\\mathbf{f} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 10^{-8} \\end{bmatrix}$,\n  - $\\tau_{\\text{thresh}} = 0.1$,\n  - $\\theta = 0.70$,\n  - $\\varepsilon = 10^{-14}$。\n\n要求：\n- 使用经过归一化的左右特征向量进行分解，以满足对于每个 $i$ 有 $\\mathbf{w}_i^\\dagger \\mathbf{r}_i = 1$ 且对于 $i \\ne j$ 有 $\\mathbf{w}_i^\\dagger \\mathbf{r}_j = 0$（双正交归一化）。\n- 计算 $a_i = \\mathbf{w}_i^\\dagger \\mathbf{f}$。\n- 计算 $p_{ij} = \\left|b_i^j a_i\\right|$，其中 $b_i^j$ 是 $\\mathbf{r}_i$ 的第 $j$ 个分量。\n- 如果 $\\tau_i < \\tau_{\\text{thresh}}$，则将模态分类为快模态，否则为慢模态。\n- 对于每个物种 $j$，计算 $\\phi_j^{\\text{fast}}$ 并应用 QSS 准则 $\\phi_j^{\\text{fast}} \\ge \\theta$ 和 $\\sum_{i=1}^n p_{ij} > \\varepsilon$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素是对应测试用例的 QSS 物种候选者的从零开始的索引列表（例如，\"[[result_case_A],[result_case_B],[result_case_C],[result_case_D]]\"）。不应打印任何额外文本。",
            "solution": "该问题要求实现一个源自计算奇异摄动 (CSP) 理论的程序，用于识别化学反应系统中的准稳态 (QSS) 物种。该方法的核心是通过分解描述系统局部动力学的雅可比矩阵 $J$，将其分解为基本行为模态，从而进行分析。每个模态都与一个特征值 $\\lambda_i$ 和相应的左右特征向量 $\\mathbf{w}_i$ 和 $\\mathbf{r}_i$ 相关联。该过程通过一系列明确定义的步骤执行。\n\n常微分方程组由 $d\\mathbf{y}/dt = \\mathbf{f}(\\mathbf{y})$ 给出，其中 $\\mathbf{y} \\in \\mathbb{R}^n$ 是物种质量分数向量，$\\mathbf{f}(\\mathbf{y})$ 是净生成速率向量。\n\n步骤1：雅可比矩阵的特征分解\n第一步是在一个工作点 $\\mathbf{y}^\\star$ 对系统进行线性化，得到雅可比矩阵 $J = \\partial \\mathbf{f}/\\partial \\mathbf{y} \\big|_{\\mathbf{y}^\\star}$。系统的局部行为由 $J$ 的特征系统决定。我们计算特征值 $\\lambda_i$ 以及相应的右特征向量 $\\mathbf{r}_i$ 和左特征向量 $\\mathbf{w}_i$（对于 $i = 1, \\dots, n$）。它们满足以下关系：\n$$\nJ \\mathbf{r}_i = \\lambda_i \\mathbf{r}_i\n$$\n$$\n\\mathbf{w}_i^\\dagger J = \\lambda_i \\mathbf{w}_i^\\dagger\n$$\n其中 $\\dagger$ 表示复共轭转置。右特征向量 $\\mathbf{r}_i$ 表示状态空间中模态运动的方向，而左特征向量 $\\mathbf{w}_i$ 是特征分解流形的梯度。对于一个非亏损的实矩阵 $J$，如果 $\\lambda_i$ 是一个复数特征值，其共轭 $\\bar{\\lambda}_i$ 也是一个特征值，它们对应的特征向量也是复共轭的。\n\n步骤2：双正交归一化\n左右特征向量构成一个双正交基。此性质对于将源项向量 $\\mathbf{f}$ 唯一地投影到模态基上至关重要。标准的数值特征求解器通常将特征向量归一化为单位欧几里得范数，即 $\\|\\mathbf{r}_i\\|_2 = 1$ 和 $\\|\\mathbf{w}_i\\|_2 = 1$。有必要对它们进行重新缩放以满足双正交归一化条件：\n$$\n\\mathbf{w}_i^\\dagger \\mathbf{r}_j = \\delta_{ij}\n$$\n其中 $\\delta_{ij}$ 是克罗内克δ函数。如果我们从数值库中获得原始特征向量集 $R_{\\text{raw}}$ 和 $W_{\\text{raw}}$，对于每个模态 $i$，我们计算标量积 $d_i = \\mathbf{w}_{i, \\text{raw}}^\\dagger \\mathbf{r}_{i, \\text{raw}}$。然后，例如通过设置 $\\mathbf{r}_i = \\mathbf{r}_{i, \\text{raw}} / d_i$ 和 $\\mathbf{w}_i = \\mathbf{w}_{i, \\text{raw}}$ 来获得归一化的特征向量。这确保了 $\\mathbf{w}_i^\\dagger \\mathbf{r}_i = 1$，而对于 $i \\ne j$ 的正交性是不同特征值的固有属性。\n\n步骤3：模态振幅计算\n有了双正交基，源项向量 $\\mathbf{f}$ 可以精确地表示为右特征向量的线性组合：\n$$\n\\mathbf{f} = \\sum_{i=1}^n a_i \\mathbf{r}_i\n$$\n系数 $a_i$ 是模态振幅，通过将 $\\mathbf{f}$ 投影到左特征向量上计算得出：\n$$\na_i = \\mathbf{w}_i^\\dagger \\mathbf{f}\n$$\n每个 $a_i$ 量化了完整源项 $\\mathbf{f}$ 投影到或激发第 $i$ 个模态的程度。\n\n步骤4：参与度指标计算\n为了评估每个物种在每个模态中的参与程度，定义了一个参与度指标 $p_{ij}$。源项的第 $j$ 个分量 $f_j$ 可以写成 $f_j = \\sum_{i=1}^n a_i b_i^j$，其中 $b_i^j$ 是右特征向量 $\\mathbf{r}_i$ 的第 $j$ 个分量。项 $a_i b_i^j$ 表示模态 $i$ 对物种 $j$ 净生成速率的贡献。参与度指标是此贡献的量值：\n$$\np_{ij} = |a_i b_i^j|\n$$\n这将创建一个非负值矩阵，其中 $p_{ij}$ 表示模态 $i$ 和物种 $j$ 之间的耦合强度。\n\n步骤5：时间尺度分析与模态分类\n特征值 $\\lambda_i$ 决定了模态的时间尺度。对于一个稳定模态，$\\operatorname{Re}(\\lambda_i) < 0$，特征时间尺度为 $\\tau_i = 1/|\\operatorname{Re}(\\lambda_i)|$。$\\operatorname{Re}(\\lambda_i)$ 的大幅值对应于一个具有短时间尺度的快衰减模态。如果 $\\operatorname{Re}(\\lambda_i) = 0$，则该模态是无衰减的（或振荡的），其时间尺度被认为是无穷大。如果模态的时间尺度低于指定的阈值 $\\tau_{\\text{thresh}}$，则将其分类为“快模态”。快模态的索引集表示为 $\\mathcal{F}$：\n$$\n\\mathcal{F} = \\{ i \\mid \\tau_i < \\tau_{\\text{thresh}} \\}\n$$\n\n步骤6：准稳态物种的识别\n如果一个物种的浓度主要由快速化学反应之间的动态平衡所支配，则该物种被认为处于准稳态。在 CSP 框架中，这转化为该物种的源项主要由快模态的贡献所主导。我们使用其源项中归因于快模态的比例 $\\phi_j^{\\text{fast}}$ 来量化这种主导地位：\n$$\n\\phi_j^{\\text{fast}} = \\frac{\\sum_{i \\in \\mathcal{F}} p_{ij}}{\\sum_{i=1}^n p_{ij}}\n$$\n该比例范围从 0（无快模态参与）到 1（完全由快模态参与）。如果该比例超过阈值 $\\theta$，并且其总模态贡献不容忽视，则物种 $j$ 被识别为 QSS 候选者。后一个条件 $\\sum_{i=1}^n p_{ij} > \\varepsilon$ 可防止源项接近零的物种被分类，因为它们的动力学可以忽略不计。因此，QSS 准则为：\n$$\n\\phi_j^{\\text{fast}} \\ge \\theta \\quad \\text{且} \\quad \\sum_{i=1}^n p_{ij} > \\varepsilon\n$$\n最终输出是对于每个测试用例，满足这两个条件的物种的从零开始的索引列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print a single-line result.\n    \"\"\"\n    test_cases = [\n        # Case A (well-separated negative eigenvalues; three species)\n        {\n            \"J\": np.array([[-1.0, 0.2, 0.0], [0.0, -10.0, 1.0], [0.0, -0.5, -100.0]]),\n            \"f\": np.array([0.5, -1.0, 2.0]),\n            \"tau_thresh\": 0.2,\n            \"theta\": 0.85,\n            \"eps\": 1e-12\n        },\n        # Case B (complex-conjugate pair; boundary time-scale; three species)\n        {\n            \"J\": np.array([[-5.0, -10.0, 0.0], [10.0, -5.0, 0.0], [0.1, 0.0, -0.5]]),\n            \"f\": np.array([1.0, 0.0, 0.1]),\n            \"tau_thresh\": 0.2,\n            \"theta\": 0.80,\n            \"eps\": 1e-12\n        },\n        # Case C (near-conservation direction; one zero eigenvalue; three species)\n        {\n            \"J\": np.array([[0.0, 0.0, 0.0], [0.0, -2.0, 0.0], [0.0, 0.5, -50.0]]),\n            \"f\": np.array([0.0, 0.1, -0.2]),\n            \"tau_thresh\": 0.05,\n            \"theta\": 0.90,\n            \"eps\": 1e-12\n        },\n        # Case D (small amplitude edge case; three species)\n        {\n            \"J\": np.array([[-1.0, 0.0, 0.0], [0.0, -80.0, 0.0], [0.1, 0.2, -5.0]]),\n            \"f\": np.array([0.0, 0.0, 1e-8]),\n            \"tau_thresh\": 0.1,\n            \"theta\": 0.70,\n            \"eps\": 1e-14\n        }\n    ]\n\n    results = [find_qss_species(**case) for case in test_cases]\n    \n    # Format the output string to match \"[result_A],[result_B],...\"\n    results_as_str = []\n    for r in results:\n        results_as_str.append('[' + ','.join(map(str, r)) + ']')\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_as_str)}]\")\n\ndef find_qss_species(J, f, tau_thresh, theta, eps):\n    \"\"\"\n    Implements the CSP-based procedure to identify QSS species.\n    \"\"\"\n    n = J.shape[0]\n\n    # Step 1: Eigendecomposition\n    # Get eigenvalues, left eigenvectors (W_raw), and right eigenvectors (R_raw)\n    # Scipy returns eigenvectors as columns in the matrices.\n    lambdas, W_raw, R_raw = linalg.eig(J, left=True, right=True)\n\n    # Step 2: Biorthonormalization\n    # Normalize eigenvectors to satisfy W_dagger @ R = I\n    R_norm = np.zeros_like(R_raw, dtype=np.complex128)\n    for i in range(n):\n        # Compute dot product for normalization\n        d_i = W_raw[:, i].conj().T @ R_raw[:, i]\n        # Scale the right eigenvector\n        R_norm[:, i] = R_raw[:, i] / d_i\n    \n    # The normalized eigenvector matrices are W (W_raw) and R (R_norm)\n    W_norm = W_raw\n\n    # Step 3: Modal Amplitudes\n    f_vec = f.reshape(n, 1)\n    # a_i = w_i^dagger * f\n    a = W_norm.conj().T @ f_vec\n\n    # Step 4: Participation Metrics\n    # p_ij = |b_i^j * a_i|, where b_i^j is the j-th component of r_i\n    # R_norm is n x n (species x mode), a.T is 1 x n (mode)\n    # Broadcasting a.T results in element-wise multiplication\n    P = np.abs(R_norm * a.T) # P is n x n, P_ji (species j, mode i)\n    # Transpose to get P_ij (mode i, species j) for easier summation later\n    P = P.T\n\n    # Step 5: Time-Scale Analysis and Mode Classification\n    re_lambda = np.real(lambdas)\n    tau = np.full(n, np.inf)\n    non_zero_re = re_lambda != 0\n    tau[non_zero_re] = 1.0 / np.abs(re_lambda[non_zero_re])\n    \n    fast_mode_indices = np.where(tau < tau_thresh)[0]\n\n    # Step 6  7: Identify QSS Species\n    qss_species_indices = []\n    \n    # Sum over modes (axis=0) to get total value per species\n    total_participation_per_species = np.sum(P, axis=0)\n\n    if fast_mode_indices.size > 0:\n        fast_participation_per_species = np.sum(P[fast_mode_indices, :], axis=0)\n    else:\n        fast_participation_per_species = np.zeros(n)\n\n    for j in range(n):\n        total_p = total_participation_per_species[j]\n        \n        # Check against the trivial source term threshold\n        if total_p > eps:\n            if total_p > 0:\n                phi_j_fast = fast_participation_per_species[j] / total_p\n            else: # Should not happen due to the 'total_p > eps' check\n                phi_j_fast = 0.0\n\n            # Check against the QSS fraction threshold\n            if phi_j_fast >= theta:\n                qss_species_indices.append(j)\n\n    return qss_species_indices\n\nsolve()\n```"
        },
        {
            "introduction": "识别出准稳态物种是模型简化的第一步，而本练习则关注于如何利用这一信息构建实际的简化模型。我们将探讨在给定慢变量和温度的条件下，求解定义了慢不变流形的非线性代数方程组 $\\mathbf{h}(\\mathbf{y})=\\mathbf{0}$ 的数值方法。这个练习将帮助您掌握构建功能性简化动力学模型的关键数值技术，即牛顿迭代法及其在化学动力学中的稳健应用。",
            "id": "4013313",
            "problem": "考虑一个恒压下的均相理想气体反应器，其物种浓度由向量 $\\mathbf{c} \\in \\mathbb{R}^{N}$ 表示，温度为 $T$。有限速率化学反应由 $K$ 个基元反应描述，其净速率为 $\\mathbf{R}(\\mathbf{c},T) \\in \\mathbb{R}^{K}$，化学计量矩阵为 $\\mathbf{S} \\in \\mathbb{R}^{N \\times K}$，其中物种生成速率满足 $\\boldsymbol{\\omega}(\\mathbf{c},T) = \\mathbf{S} \\, \\mathbf{R}(\\mathbf{c},T)$。在质量作用动力学下，每个反应 $k$ 的净速率由 $R_{k}(\\mathbf{c},T) = k_{f,k}(T) \\prod_{i=1}^{N} c_{i}^{\\nu^{f}_{i,k}} - k_{r,k}(T) \\prod_{i=1}^{N} c_{i}^{\\nu^{r}_{i,k}}$ 给出，其中 $k_{f,k}(T)$ 和 $k_{r,k}(T)$ 是正向和逆向 Arrhenius 速率常数，$\\nu^{f}_{i,k}$ 和 $\\nu^{r}_{i,k}$ 是化学计量指数。将物种划分为一组慢（或保留）物种 $\\mathbf{z} \\in \\mathbb{R}^{N_{s}}$ 和一组准稳态（QSS）物种 $\\mathbf{y} \\in \\mathbb{R}^{m}$，其中 $N_{s} + m = N$，使得准稳态（QSS）条件通过将其生成速率设为零而施加于 QSS 子集上。用 $\\mathbf{S}_{\\mathrm{qss}} \\in \\mathbb{R}^{m \\times K}$ 表示包含 $\\mathbf{S}$ 中对应于 QSS 物种的行的化学计量子矩阵。对于固定的慢变量和温度 $(\\mathbf{z},T)$，为 QSS 物种定义非线性系统如下：\n$$\n\\mathbf{h}(\\mathbf{y};\\mathbf{z},T) \\equiv \\boldsymbol{\\omega}_{\\mathrm{qss}}(\\mathbf{z},\\mathbf{y},T) = \\mathbf{S}_{\\mathrm{qss}} \\, \\mathbf{R}(\\mathbf{c},T) = \\mathbf{0},\n$$\n其中 $\\mathbf{c} = [\\mathbf{z};\\mathbf{y}]$。在基于计算奇异摄动（CSP）的机理简化中，在每个 $(\\mathbf{z},T)$ 点求解 $\\mathbf{h}(\\mathbf{y};\\mathbf{z},T) = \\mathbf{0}$ 定义了用于消除快变量的 QSS 流形嵌入。\n\n仅使用化学源项的基本定义和经典的求根原理，回答以下问题。哪个选项正确地描述了用于求解 QSS 物种的方程 $\\mathbf{h}(\\mathbf{y};\\mathbf{z},T) = \\mathbf{0}$ 的 Newton 迭代，包括在固定 $(\\mathbf{z},T)$ 下对雅可比矩阵 $\\partial \\mathbf{h}/\\partial \\mathbf{y}$ 的有原则的构建方法，以及适合化学动力学约束的线搜索策略？\n\nA. 将雅可比矩阵构造为\n$$\n\\mathbf{J}(\\mathbf{y};\\mathbf{z},T) \\equiv \\frac{\\partial \\mathbf{h}}{\\partial \\mathbf{y}}(\\mathbf{y};\\mathbf{z},T) = \\mathbf{S}_{\\mathrm{qss}} \\, \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{y}}(\\mathbf{c},T),\n$$\n在 $\\mathbf{c} = [\\mathbf{z};\\mathbf{y}]$ 中保持 $\\mathbf{z}$ 和 $T$ 固定，其中对于质量作用动力学，矩阵元素满足\n$$\n\\frac{\\partial R_{k}}{\\partial y_{j}} = k_{f,k}(T) \\left( \\prod_{i=1}^{N} c_{i}^{\\nu^{f}_{i,k}} \\right) \\frac{\\nu^{f}_{j,k}}{y_{j}} \\;-\\; k_{r,k}(T) \\left( \\prod_{i=1}^{N} c_{i}^{\\nu^{r}_{i,k}} \\right) \\frac{\\nu^{r}_{j,k}}{y_{j}},\n$$\n对于 QSS 指数 $j$ 且 $y_{j} > 0$；当 $y_{j} = 0$ 时，使用类似的极限导数。在第 $n$ 次迭代中，求解线性系统\n$$\n\\mathbf{J}(\\mathbf{y}^{(n)};\\mathbf{z},T) \\, \\Delta \\mathbf{y}^{(n)} = -\\mathbf{h}(\\mathbf{y}^{(n)};\\mathbf{z},T),\n$$\n并使用回溯线搜索进行更新，该搜索强制执行非负性并确保残差范数的充分下降：通过对半法选择 $\\alpha^{(n)} \\in (0,1]$，直到 $\\mathbf{y}^{(n)} + \\alpha^{(n)} \\Delta \\mathbf{y}^{(n)} \\ge \\mathbf{0}$（分量式）和\n$$\n\\left\\| \\mathbf{h}\\!\\left(\\mathbf{y}^{(n)} + \\alpha^{(n)} \\Delta \\mathbf{y}^{(n)};\\mathbf{z},T\\right) \\right\\|_{2} \\le (1 - c \\, \\alpha^{(n)}) \\, \\left\\| \\mathbf{h}\\!\\left(\\mathbf{y}^{(n)};\\mathbf{z},T\\right) \\right\\|_{2},\n$$\n同时满足，对于某个 $c \\in (0,1)$，然后设置 $\\mathbf{y}^{(n+1)} = \\mathbf{y}^{(n)} + \\alpha^{(n)} \\Delta \\mathbf{y}^{(n)}$ 并迭代直到 $\\|\\mathbf{h}\\|_{2}$ 低于一个容差。\n\nB. 构建一个关于所有变量的全雅可比矩阵，\n$$\n\\tilde{\\mathbf{J}}(\\mathbf{y},\\mathbf{z},T) = \\begin{bmatrix} \\dfrac{\\partial \\mathbf{h}}{\\partial \\mathbf{y}}  \\dfrac{\\partial \\mathbf{h}}{\\partial \\mathbf{z}}  \\dfrac{\\partial \\mathbf{h}}{\\partial T} \\end{bmatrix},\n$$\n求解 $\\tilde{\\mathbf{J}} \\, [\\Delta \\mathbf{y}; \\Delta \\mathbf{z}; \\Delta T] = -\\mathbf{h}$，并通过 $\\mathbf{y}^{(n+1)} = \\mathbf{y}^{(n)} + \\Delta \\mathbf{y}$，$\\mathbf{z}^{(n+1)} = \\mathbf{z}^{(n)} + \\Delta \\mathbf{z}$，$T^{(n+1)} = T^{(n)} + \\Delta T$ 来更新所有变量，使用一种线搜索，该搜索增加步长以最大化残差范数，并忽略非负性约束。\n\nC. 用元素 $J_{jj} = \\partial h_{j}/\\partial y_{j} \\approx -\\omega_{j}(\\mathbf{z},\\mathbf{y},T)/y_{j}$ 形成雅可比矩阵的对角近似，在最速下降方向 $-\\nabla \\|\\mathbf{h}\\|_{2}^{2} = -\\mathbf{J}^{\\top} \\mathbf{h}$ 上取一个固定的单位步长 $\\alpha = 1$，并且即使某些 QSS 浓度变为负值也接受更新，因为下一个 Newton 步会修正它们。\n\nD. 通过对 $\\mathbf{y}$ 进行有限差分来计算 $\\mathbf{J}(\\mathbf{y};\\mathbf{z},T)$，同时保持 $(\\mathbf{z},T)$ 固定，求解 $\\mathbf{J} \\, \\Delta \\mathbf{y} = -\\mathbf{h}$，并使用一种“线搜索”，该搜索在单位步长后削去负分量，\n$$\n\\mathbf{y}^{(n+1)} = \\max\\!\\left( \\mathbf{y}^{(n)} + \\Delta \\mathbf{y}^{(n)}, \\, \\mathbf{0} \\right),\n$$\n而不检查 $\\|\\mathbf{h}\\|_{2}$ 是否有任何减小。\n\n根据控制定义以及适用于化学动力学和基于 CSP 的 QSS 流形计算的数值策略，选择正确的选项。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第 1 步：提取已知条件\n- **系统**：恒压下的均相理想气体反应器。\n- **状态向量**：物种浓度 $\\mathbf{c} \\in \\mathbb{R}^{N}$ 和温度 $T$。\n- **反应动力学**：$K$ 个基元反应，净速率为 $\\mathbf{R}(\\mathbf{c},T) \\in \\mathbb{R}^{K}$。\n- **化学计量矩阵**：$\\mathbf{S} \\in \\mathbb{R}^{N \\times K}$。\n- **物种生成速率**：$\\boldsymbol{\\omega}(\\mathbf{c},T) = \\mathbf{S} \\, \\mathbf{R}(\\mathbf{c},T)$。\n- **质量作用动力学**：反应 $k$ 的净速率为 $R_{k}(\\mathbf{c},T) = k_{f,k}(T) \\prod_{i=1}^{N} c_{i}^{\\nu^{f}_{i,k}} - k_{r,k}(T) \\prod_{i=1}^{N} c_{i}^{\\nu^{r}_{i,k}}$。$k_{f,k}(T)$ 和 $k_{r,k}(T)$ 是正向和逆向 Arrhenius 速率常数，$\\nu^{f}_{i,k}$、$\\nu^{r}_{i,k}$ 是化学计量指数。\n- **物种划分**：物种向量 $\\mathbf{c}$ 被划分为慢物种 $\\mathbf{z} \\in \\mathbb{R}^{N_{s}}$ 和准稳态 (QSS) 物种 $\\mathbf{y} \\in \\mathbb{R}^{m}$，其中 $N_{s} + m = N$。完整的浓度向量为 $\\mathbf{c} = [\\mathbf{z};\\mathbf{y}]$。\n- **QSS 条件**：QSS 物种的生成速率被设为零：$\\boldsymbol{\\omega}_{\\mathrm{qss}} = \\mathbf{0}$。\n- **QSS 化学计量子矩阵**：$\\mathbf{S}_{\\mathrm{qss}} \\in \\mathbb{R}^{m \\times K}$ 由 $\\mathbf{S}$ 中对应于 QSS 物种 $\\mathbf{y}$ 的行构成。\n- **非线性系统**：QSS 条件定义了一个关于 $\\mathbf{y}$ 的非线性方程组，以 $(\\mathbf{z},T)$ 为参数：\n$$\n\\mathbf{h}(\\mathbf{y};\\mathbf{z},T) \\equiv \\boldsymbol{\\omega}_{\\mathrm{qss}}(\\mathbf{z},\\mathbf{y},T) = \\mathbf{S}_{\\mathrm{qss}} \\, \\mathbf{R}(\\mathbf{c},T) = \\mathbf{0}.\n$$\n- **目标**：确定对求解 $\\mathbf{h}(\\mathbf{y};\\mathbf{z},T) = \\mathbf{0}$ 以获得 $\\mathbf{y}$ 的 Newton 迭代的正确描述，包括雅可比矩阵的构建和一个适合化学动力学的线搜索策略。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题陈述的有效性进行评估。\n- **科学依据**：该问题牢固地植根于化学动力学和数值分析的既定原则。准稳态近似（QSSA）是模型简化的标准技术，其在计算奇异摄动（CSP）框架内的表述是计算燃烧学中一个完善的学科。质量作用动力学、化学计量矩阵和 Newton 法的使用都是标准方法。\n- **适定性**：问题要求确定一个数值算法的正确表述，这是一个明确定义的任务。在物理现实条件下，寻找 QSS 流形的潜在数学问题通常是适定的。\n- **客观性**：语言是技术性的、精确的，没有主观或模糊的术语。\n- **完整性与一致性**：问题为构建 Newton-Raphson 方法提供了一套完整且自洽的定义。所有符号和关系都得到了明确定义。\n\n### 第 3 步：结论与行动\n问题陈述在科学上是合理的、适定的和完整的。它被验证为计算科学中的一个合法问题。可以继续求解过程。\n\n### 求解推导\n任务是找到非线性向量值函数 $\\mathbf{h}(\\mathbf{y}) = \\mathbf{0}$ 的根，其中为简化符号，对固定参数 $(\\mathbf{z}, T)$ 的依赖是隐式的。Newton-Raphson 迭代由以下步骤定义，从一个估计值 $\\mathbf{y}^{(n)}$ 开始：\n$1$. 通过在 $\\mathbf{y}^{(n)}$ 周围线性化 $\\mathbf{h}$，为更新步长 $\\Delta \\mathbf{y}^{(n)}$ 构建线性系统：\n$$\n\\mathbf{J}(\\mathbf{y}^{(n)}) \\, \\Delta \\mathbf{y}^{(n)} = -\\mathbf{h}(\\mathbf{y}^{(n)})\n$$\n其中 $\\mathbf{J}(\\mathbf{y}) \\equiv \\partial \\mathbf{h}/\\partial \\mathbf{y}$ 是 $\\mathbf{h}$ 关于 $\\mathbf{y}$ 的雅可比矩阵。\n$2$. 求解这个线性系统以得到 $\\Delta \\mathbf{y}^{(n)}$。\n$3$. 使用线搜索更新解：\n$$\n\\mathbf{y}^{(n+1)} = \\mathbf{y}^{(n)} + \\alpha^{(n)} \\Delta \\mathbf{y}^{(n)}\n$$\n其中步长 $\\alpha^{(n)} \\in (0,1]$ 被选择以确保朝向解的进展并满足物理约束。\n\n首先，我们推导雅可比矩阵 $\\mathbf{J}$。\n$$\n\\mathbf{J}(\\mathbf{y};\\mathbf{z},T) = \\frac{\\partial \\mathbf{h}}{\\partial \\mathbf{y}} = \\frac{\\partial}{\\partial \\mathbf{y}} \\left( \\mathbf{S}_{\\mathrm{qss}} \\, \\mathbf{R}(\\mathbf{c},T) \\right)\n$$\n由于 $\\mathbf{S}_{\\mathrm{qss}}$ 是一个常数矩阵，并且参数 $(\\mathbf{z},T)$ 保持固定，导数仅作用于 $\\mathbf{R}$，而 $\\mathbf{R}$ 通过 $\\mathbf{c}=[\\mathbf{z};\\mathbf{y}]$ 依赖于 $\\mathbf{y}$。\n$$\n\\mathbf{J}(\\mathbf{y};\\mathbf{z},T) = \\mathbf{S}_{\\mathrm{qss}} \\, \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{y}}(\\mathbf{c},T)\n$$\n项 $\\partial \\mathbf{R} / \\partial \\mathbf{y}$ 是一个矩阵，其 $(k,j)$ 元是 $\\partial R_k / \\partial y_j$。让我们计算这个元素。第 $j$ 个 QSS 物种的浓度 $y_j$ 是完整浓度向量 $\\mathbf{c}$ 的一个分量。设其为 $c_l$ 使得 $y_j=c_l$。\n反应 $k$ 的净速率是 $R_{k} = R_{k,f} - R_{k,r}$，其中 $R_{k,f} = k_{f,k}(T) \\prod_{i=1}^{N} c_{i}^{\\nu^{f}_{i,k}}$。\n当 $y_j > 0$ 时，对正向部分关于 $c_l$ (即 $y_j$) 求导：\n$$\n\\frac{\\partial R_{k,f}}{\\partial y_j} = \\frac{\\partial R_{k,f}}{\\partial c_l} = k_{f,k}(T) \\left( \\prod_{i \\neq l} c_{i}^{\\nu^{f}_{i,k}} \\right) \\nu^{f}_{l,k} c_l^{\\nu^{f}_{l,k}-1} = \\left( k_{f,k}(T) \\prod_{i=1}^{N} c_{i}^{\\nu^{f}_{i,k}} \\right) \\frac{\\nu^{f}_{l,k}}{c_l} = R_{k,f} \\frac{\\nu^{f}_{l,k}}{y_j}\n$$\n类似的推导也适用于逆向速率 $R_{k,r}$。将它们结合起来得到净速率的导数，其中我们将物种索引 $l$ 映射到 QSS 索引 $j$：\n$$\n\\frac{\\partial R_{k}}{\\partial y_{j}} = k_{f,k}(T) \\left( \\prod_{i=1}^{N} c_{i}^{\\nu^{f}_{i,k}} \\right) \\frac{\\nu^{f}_{j,k}}{y_{j}} - k_{r,k}(T) \\left( \\prod_{i=1}^{N} c_{i}^{\\nu^{r}_{i,k}} \\right) \\frac{\\nu^{r}_{j,k}}{y_{j}}\n$$\n这个表达式在 $y_j > 0$ 时有效。$y_j=0$ 的情况需要特别处理，通常涉及单边导数，但问题陈述正确地提到了这一点。\n\n接下来，我们考虑线搜索策略。对于化学动力学，物种浓度必须是非负的。一个完整的 Newton 步长（$\\alpha^{(n)}=1$）很容易导致负浓度，这在物理上是无意义的，并可能导致致命的数值错误。因此，线搜索必须强制执行非负性：\n$$\n\\mathbf{y}^{(n+1)} = \\mathbf{y}^{(n)} + \\alpha^{(n)} \\Delta \\mathbf{y}^{(n)} \\ge \\mathbf{0} \\quad \\text{(分量式)}\n$$\n此外，一个稳健的求解器必须确保每一步在减小残差范数 $\\|\\mathbf{h}\\|$ 方面取得足够的进展。回溯线搜索通过从 $\\alpha^{(n)}=1$ 开始并减小它（例如，通过对半法）直到满足一个充分下降条件（如 Armijo 条件）来实现这一点。对于求根问题，这个条件可以写成残差向量的范数：\n$$\n\\left\\| \\mathbf{h}(\\mathbf{y}^{(n+1)}) \\right\\| \\le (1 - c \\, \\alpha^{(n)}) \\left\\| \\mathbf{h}(\\mathbf{y}^{(n)}) \\right\\|\n$$\n对于某个常数 $c \\in (0,1)$，例如 $c=10^{-4}$。\n\n我们现在基于这个推导来评估给定的选项。\n\n### 逐项分析\n\n**A.**\n此选项将雅可比矩阵表示为 $\\mathbf{J} = \\mathbf{S}_{\\mathrm{qss}} (\\partial \\mathbf{R} / \\partial \\mathbf{y})$，其元素 $\\partial R_k / \\partial y_j$ 由上面推导的公式给出。这是**正确的**。它构建了标准的 Newton 线性系统 $\\mathbf{J} \\Delta \\mathbf{y} = -\\mathbf{h}$。这是**正确的**。它提出了一个回溯线搜索，通过减小 $\\alpha^{(n)}$ 直到满足两个条件：(1) 更新后浓度的非负性，$\\mathbf{y}^{(n)} + \\alpha^{(n)} \\Delta \\mathbf{y}^{(n)} \\ge \\mathbf{0}$，以及 (2) 残差 $L_2$-范数的充分下降（Armijo 型）条件，$\\| \\mathbf{h}(\\mathbf{y}^{(n+1)}) \\|_{2} \\le (1 - c \\, \\alpha^{(n)}) \\| \\mathbf{h}(\\mathbf{y}^{(n)}) \\|_{2}$。这两个条件对于为此类问题构建一个稳健的、物理上一致的求解器至关重要。整个描述是一个为化学动力学适当调整的阻尼 Newton 方法的教科书式实现。\n结论：**正确**。\n\n**B.**\n此选项建议计算关于所有变量 $(\\mathbf{y}, \\mathbf{z}, T)$ 的全雅可比矩阵并更新所有这些变量。这从根本上是错误的。问题是在*固定*的 $(\\mathbf{z}, T)$ 下求解 $\\mathbf{y}$。此选项将求解 QSS 流形上的一点与求解完整的微分代数方程组混为一谈。此外，其线搜索旨在*最大化*残差范数并忽略非负性，这对于此背景下的求根算法来说都是荒谬的。\n结论：**错误**。\n\n**C.**\n此选项建议对雅可比矩阵进行对角近似，这使其成为一个简化的 Newton 或类 Jacobi 方法，而不是“基本定义”所指定的真正的 Newton 方法。更重要的是，它在最速下降方向 $-\\mathbf{J}^{\\top} \\mathbf{h}$ 上使用一个步长，这属于对目标函数 $\\frac{1}{2}\\|\\mathbf{h}\\|_2^2$ 的梯度下降法，而不是使用方向 $-\\mathbf{J}^{-1} \\mathbf{h}$ 的 Newton-Raphson 方法。最后，它使用固定的单位步长并允许浓度变为负值。这两者都是一个非稳健且物理上无效的方法的标志。\n结论：**错误**。\n\n**D.**\n此选项正确地构建了 Newton 线性系统 $\\mathbf{J} \\Delta \\mathbf{y} = -\\mathbf{h}$。然而，其更新策略是有缺陷的。它采用一个完整步长（$\\alpha=1$），然后“削去”结果以强制执行非负性：$\\mathbf{y}^{(n+1)} = \\max(\\mathbf{y}^{(n)} + \\Delta \\mathbf{y}^{(n)}, \\mathbf{0})$。这种削波过程是一个破坏 Newton 步长性质的临时修复。更关键的是，它这样做“而不检查 $\\|\\mathbf{h}\\|_{2}$ 是否有任何减小”。这种缺乏充分下降条件意味着该算法不能保证收敛，并且很容易发散或振荡。一个恰当的线搜索，如选项 A 中所描述的，是一种更有原则、更稳健的方法。\n结论：**错误**。\n\n基于分析，只有选项 A 提供的描述与数值求根的基本原理和化学动力学的物理约束相一致。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}