{
    "hands_on_practices": [
        {
            "introduction": "在对复杂系统进行降维之前，我们必须首先理解限制系统状态的内在约束。本练习将引导您从质量守恒这一基本物理原理出发，推导出物种浓度必须遵循的严格线性约束。通过确定由此产生的可及组分空间的维度，您将掌握反应流中存在低维流形的理论基础()。",
            "id": "4032863",
            "problem": "考虑一个与计算燃烧学相关的化学反应混合物，其中包含 $N_s$ 种化学组分和 $M$ 种化学元素。设 $Y_i$ 表示组分 $i$ 的质量分数（$i \\in \\{1,\\dots,N_s\\}$），$a_{\\alpha i}$ 表示组分 $i$ 中元素 $\\alpha$ 的原子数（$\\alpha \\in \\{1,\\dots,M\\}$）。设 $W_{\\alpha}$ 为元素 $\\alpha$ 的原子量，$W_i$ 为组分 $i$ 的分子量。假设混合物是充分混合的封闭系统，因此只有化学反应在各组分之间重新分配质量，同时每种元素的质量守恒。\n\n从“单个组分的质量是其组成元素质量之和”这一物理定义出发，并利用混合物中每种元素总质量守恒的原理，推导出组分质量分数的线性元素守恒约束，其形式为 $E Y = b$。其中，$Y \\in \\mathbb{R}^{N_s}$ 包含 $(Y_1,\\dots,Y_{N_s})$，$b \\in \\mathbb{R}^{M}$ 包含元素质量分数 $(b_1,\\dots,b_M)$，而 $E \\in \\mathbb{R}^{M \\times N_s}$ 由化学计量和原子/分子量确定。证明归一化条件 $\\sum_{i=1}^{N_s} Y_i = 1$ 可由元素质量分数的定义导出，因此当 $b$ 代表混合物中的元素质量分数时，该条件不是一个独立的额外约束。然后，在施加非负性条件 $Y_i \\ge 0$（对所有 $i$）之后，用 $N_s$ 和 $E$ 的秩 $r$ 来量化与给定 $b$ 一致的 $Y$ 的容许组分空间的维度。\n\n你的最终答案应该是一个用 $N_s$ 和 $r$ 表示的封闭形式的解析表达式。不需要进行数值计算。该维度是本征低维流形（Intrinsic Low-Dimensional Manifolds, ILDM）中使用的降维组分模型的基础，并为燃烧动力学中主成分分析（Principal Component Analysis, PCA）的基选择提供信息。",
            "solution": "首先验证问题陈述，以确保其具有科学依据、问题适定，并包含足够的信息以得出严谨的解。\n\n**第 1 步：提取已知条件**\n- $N_s$：化学组分数量。\n- $M$：化学元素数量。\n- $Y_i$：组分 $i$ 的质量分数，其中 $i \\in \\{1, \\dots, N_s\\}$。\n- $a_{\\alpha i}$：组分 $i$ 的一个分子中元素 $\\alpha$ 的原子数，其中 $\\alpha \\in \\{1, \\dots, M\\}$。\n- $W_{\\alpha}$：元素 $\\alpha$ 的原子量。\n- $W_i$：组分 $i$ 的分子量。\n- 该系统是一个封闭、充分混合的化学混合物。\n- 每种元素的总质量守恒。\n- 最终状态向量 $Y$ 必须满足 $Y_i \\ge 0$（对所有 $i$）。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学合理性，因为它基于化学系统中质量守恒的基本原理。所用术语和变量在化学、化学工程和燃烧理论中均是标准的。任务是推导一组标准的线性约束，然后确定所得解空间的维度，这是一个适定的数学问题，与本征低维流形（ILDM）和主成分分析（PCA）等计算燃烧学主题直接相关。该问题是客观、自洽的，没有矛盾或歧义。\n\n**第 3 步：结论与行动**\n问题被判定为有效。将提供完整的解答。\n\n**元素守恒约束的推导**\n\n我们首先建立所提供各量之间的关系。组分 $i$ 的分子量 $W_i$ 是其构成原子质量的总和。这表示为：\n$$\nW_i = \\sum_{\\alpha=1}^{M} a_{\\alpha i} W_{\\alpha}\n$$\n在组分 $i$ 的一个分子中，元素 $\\alpha$ 的质量分数是该分子中元素 $\\alpha$ 的总质量与该分子总质量的比值。这由 $\\frac{a_{\\alpha i} W_{\\alpha}}{W_i}$ 给出。\n\n在总质量为 $m_{total}$ 的混合物中，组分 $i$ 的质量为 $m_i = Y_i m_{total}$。由组分 $i$ 贡献的元素 $\\alpha$ 的质量是组分 $i$ 的质量乘以该组分中元素 $\\alpha$ 的质量分数：\n$$\nm_{\\alpha,i} = \\left(\\frac{a_{\\alpha i} W_{\\alpha}}{W_i}\\right) m_i = \\left(\\frac{a_{\\alpha i} W_{\\alpha}}{W_i}\\right) Y_i m_{total}\n$$\n混合物中元素 $\\alpha$ 的总质量 $m_{\\alpha}$ 是通过对所有 $N_s$ 个组分的贡献求和得到的：\n$$\nm_{\\alpha} = \\sum_{i=1}^{N_s} m_{\\alpha,i} = \\sum_{i=1}^{N_s} \\left(\\frac{a_{\\alpha i} W_{\\alpha}}{W_i}\\right) Y_i m_{total}\n$$\n混合物中元素 $\\alpha$ 的元素质量分数（记为 $b_{\\alpha}$）定义为元素 $\\alpha$ 的总质量除以混合物的总质量，即 $b_{\\alpha} = \\frac{m_{\\alpha}}{m_{total}}$。代入 $m_{\\alpha}$ 的表达式：\n$$\nb_{\\alpha} = \\frac{1}{m_{total}} \\left( \\sum_{i=1}^{N_s} \\left(\\frac{a_{\\alpha i} W_{\\alpha}}{W_i}\\right) Y_i m_{total} \\right) = \\sum_{i=1}^{N_s} \\left(\\frac{a_{\\alpha i} W_{\\alpha}}{W_i}\\right) Y_i\n$$\n这对每个元素 $\\alpha \\in \\{1, \\dots, M\\}$ 都代表一个线性方程。我们可以将这 $M$ 个方程组合成一个矩阵-向量方程 $E Y = b$。组分质量分数向量为 $Y = [Y_1, Y_2, \\dots, Y_{N_s}]^T \\in \\mathbb{R}^{N_s}$。元素质量分数向量为 $b = [b_1, b_2, \\dots, b_M]^T \\in \\mathbb{R}^{M}$。矩阵 $E$ 是一个 $M \\times N_s$ 矩阵，其元素是 $Y_i$ 项的系数：\n$$\nE_{\\alpha i} = \\frac{a_{\\alpha i} W_{\\alpha}}{W_i}\n$$\n因此，我们推导出了线性元素守恒约束系统 $E Y = b$。\n\n**归一化约束的冗余性**\n\n问题接下来要求证明组分质量分数的归一化条件 $\\sum_{i=1}^{N_s} Y_i = 1$ 不是一个独立的约束。根据定义，混合物中所有元素质量分数的总和必须为1：\n$$\n\\sum_{\\alpha=1}^{M} b_{\\alpha} = 1\n$$\n让我们对系统 $E Y = b$ 中的 $M$ 个线性方程按索引 $\\alpha$ 求和：\n$$\n\\sum_{\\alpha=1}^{M} b_{\\alpha} = \\sum_{\\alpha=1}^{M} \\left( \\sum_{i=1}^{N_s} E_{\\alpha i} Y_i \\right)\n$$\n代入 $E_{\\alpha i}$ 的表达式并交换求和顺序：\n$$\n\\sum_{\\alpha=1}^{M} b_{\\alpha} = \\sum_{i=1}^{N_s} \\sum_{\\alpha=1}^{M} \\left(\\frac{a_{\\alpha i} W_{\\alpha}}{W_i}\\right) Y_i = \\sum_{i=1}^{N_s} Y_i \\left( \\frac{1}{W_i} \\sum_{\\alpha=1}^{M} a_{\\alpha i} W_{\\alpha} \\right)\n$$\n根据分子量的定义，括号中的项为 $\\frac{1}{W_i} (W_i) = 1$。因此，方程简化为：\n$$\n\\sum_{\\alpha=1}^{M} b_{\\alpha} = \\sum_{i=1}^{N_s} Y_i\n$$\n由于 $\\sum_{\\alpha=1}^{M} b_{\\alpha} = 1$，直接得出 $\\sum_{i=1}^{N_s} Y_i = 1$。这表明组分质量分数归一化是元素守恒方程的线性组合。因此，它是一个冗余约束，并且矩阵 $E$ 的行是线性相关的。这意味着 $E$ 的秩（记为 $r$）严格小于 $M$。\n\n**容许组分空间的维度**\n\n容许组分空间是满足系统物理约束的所有向量 $Y$ 的集合。这个集合，我们可以称之为 $\\mathcal{A}$，定义为：\n$$\n\\mathcal{A} = \\{ Y \\in \\mathbb{R}^{N_s} \\mid E Y = b \\text{ and } Y_i \\ge 0 \\text{ for } i=1, \\dots, N_s \\}\n$$\n组分构成向量 $Y$ 存在于 $N_s$ 维空间 $\\mathbb{R}^{N_s}$ 中。方程 $E Y = b$ 代表一个线性方程组。该系统的所有解的集合构成了 $\\mathbb{R}^{N_s}$ 的一个仿射子空间。设 $r = \\text{rank}(E)$ 是线性无关的元素守恒约束的数量。每个独立的线性约束使解空间的维度减少一。\n因此，由 $E Y = b$ 定义的仿射子空间的维度是环境空间的初始维度 $N_s$ 减去独立约束的数量 $r$。\n\n方程 $E Y = b$ 的解所构成的仿射子空间的维度由 $d = N_s - r$ 给出。这个结果也可以从秩-零度定理看出。该定理指出，对于由 $E: \\mathbb{R}^{N_s} \\to \\mathbb{R}^{M}$ 表示的线性映射，定义域的维度等于秩与核（零空间）的维度之和：$\\dim(\\mathbb{R}^{N_s}) = \\text{rank}(E) + \\dim(\\ker(E))$。核的维度 $\\dim(\\ker(E))$，也就是齐次方程 $EY=0$ 解空间的维度，是 $N_s - r$。非齐次方程 $EY=b$ 的解空间是这个核的一个平移，因此具有相同的维度 $N_s - r$。\n\n附加的约束条件 $Y_i \\ge 0$（对所有 $i$）将解空间限制在 $\\mathbb{R}^{N_s}$ 的非负象限内。仿射子空间与该象限的交集形成一个凸集（具体来说，是一个凸多胞体，因为它也因 $\\sum Y_i = 1$ 而有界）。凸集的维度定义为其仿射包的维度。假设混合物组分 $b$ 在物理上是可实现的，那么集合 $\\mathcal{A}$ 是非空的。在任何现实场景中，$\\mathcal{A}$ 都不是一个单点，而是一个连续的区域。$\\mathcal{A}$ 的仿射包就是由 $EY=b$ 本身定义的仿射子空间。因此，非负性约束定义了可及区域的边界（面），但不会改变其内在维度。\n\n因此，容许组分空间的维度就是由独立元素守恒方程定义的仿射子空间的维度，即 $N_s - r$。",
            "answer": "$$\\boxed{N_s - r}$$"
        },
        {
            "introduction": "主成分分析（PCA）是识别数据中低维结构的强大工具，但其效果常会受到测量噪声的干扰。本练习提供了一种关键技术，用于从传感器噪声污染中分离出真实的物理方差。您将学习如何推导并应用噪声校正协方差估计，这是从实验或模拟数据中构建稳健、具有物理意义的降阶模型的关键一步()。",
            "id": "4032850",
            "problem": "在计算燃烧学中，主成分分析（PCA）常被应用于热化学状态向量，以识别与本征低维流形（ILDM）对齐的主导方向。考虑一个在湍流预混火焰中测量的包含三个解析变量的中心化数据集：混合分数 $Z$、温度 $T$ 和一个反应进程变量 $c$。令真实的中心化状态向量表示为 $\\mathbf{x} \\in \\mathbb{R}^{3}$，测量的中心化向量表示为 $\\mathbf{y} \\in \\mathbb{R}^{3}$。由于共享电子设备和热漂移，测量值受到具有传感器间相关性的加性传感器噪声的干扰，其模型为\n$$\n\\mathbf{y} = \\mathbf{x} + \\boldsymbol{\\epsilon},\n$$\n其中噪声 $\\boldsymbol{\\epsilon}$ 与 $\\mathbf{x}$ 无关，为零均值，且服从具有已知协方差的联合高斯分布。\n\n您已获得测量数据的样本协方差，该协方差由足够大的样本计算得出，因此是 $\\mathbf{y}$ 的总体协方差的一致估计量，\n$$\nS_{y} = \\begin{pmatrix}\n7  1  0.5 \\\\\n1  5  0.3 \\\\\n0.5  0.3  2.2\n\\end{pmatrix},\n$$\n以及通过校准得出的传感器噪声协方差，\n$$\n\\Sigma_{\\epsilon} = \\begin{pmatrix}\n1  1  0.5 \\\\\n1  2  0.3 \\\\\n0.5  0.3  0.7\n\\end{pmatrix}.\n$$\n\n仅从上面给出的协方差、独立性和线性测量模型的定义出发，推导潜在熱化学状态的噪声校正协方差估计量，然后用它计算第一主成分所捕获的校正后方差的比例。具体来说，令校正后的协方差表示为 $S_{x}$，其有序特征值为 $\\lambda_{1} \\ge \\lambda_{2} \\ge \\lambda_{3}$。计算量\n$$\n\\frac{\\lambda_{1}}{\\operatorname{tr}(S_{x})}.\n$$\n\n将您的最终答案表示为保留四位有效数字的小数。该量无需单位。",
            "solution": "用户提供了一个在进行求解之前需要验证其前提的问题。\n\n### 步骤1：问题验证\n\n#### 提取已知条件\n问题陈述中给出的已知条件是：\n- 线性测量模型：$\\mathbf{y} = \\mathbf{x} + \\boldsymbol{\\epsilon}$，其中 $\\mathbf{x}, \\mathbf{y}, \\boldsymbol{\\epsilon} \\in \\mathbb{R}^{3}$ 是中心化随机向量。\n- 真实状态向量 $\\mathbf{x}$ 和噪声向量 $\\boldsymbol{\\epsilon}$ 是独立的。\n- 噪声向量 $\\boldsymbol{\\epsilon}$ 是零均值的，$E[\\boldsymbol{\\epsilon}] = \\mathbf{0}$。\n- 测量数据的样本协方差矩阵为 $S_{y} = \\begin{pmatrix} 7  1  0.5 \\\\ 1  5  0.3 \\\\ 0.5  0.3  2.2 \\end{pmatrix}$。假设这是一个对 $\\mathbf{y}$ 的总体协方差的一致估计量。\n- 传感器噪声协方差矩阵为 $\\Sigma_{\\epsilon} = \\begin{pmatrix} 1  1  0.5 \\\\ 1  2  0.3 \\\\ 0.5  0.3  0.7 \\end{pmatrix}$。\n- 任务是计算比率 $\\frac{\\lambda_{1}}{\\operatorname{tr}(S_{x})}$，其中 $S_x$ 是 $\\mathbf{x}$ 的噪声校正协方差估计量，$\\lambda_1$ 是其最大特征值。\n\n#### 验证\n1.  **科学或事实上的不合理性**：该问题在科学上和数学上是合理的。它描述了一种处理多变量数据中加性噪声的标准方法，这是实验科学和工程中的常见问题。线性加性噪声模型是信号处理和统计学中的一个基本概念。所提供的矩阵是对称的，这是协方差矩阵的要求。我们验证它们是否为半正定，这是有效协方差矩阵的必要条件。\n    - 对于 $\\Sigma_{\\epsilon}$，其顺序主子式为 $1 > 0$， $1 \\cdot 2 - 1^2 = 1 > 0$，且 $\\det(\\Sigma_{\\epsilon}) = 1(1.4 - 0.09) - 1(0.7 - 0.15) + 0.5(0.3 - 1.0) = 1.31 - 0.55 - 0.35 = 0.41 > 0$。根据西尔维斯特准则，$\\Sigma_{\\epsilon}$ 是正定的。\n    - 对于 $S_{y}$，其顺序主子式为 $7 > 0$， $7 \\cdot 5 - 1^2 = 34 > 0$，且 $\\det(S_{y}) = 7(11-0.09) - 1(2.2-0.15) + 0.5(0.3-2.5) = 76.37 - 2.05 - 1.1 = 73.22 > 0$。$S_{y}$ 也是正定的。\n    前提是有效的。\n\n2.  **适定性**：该问题是适定的。它提供了所有必要的信息和明确的目标。真实、测量和噪声协方差之间的关系可以从给定的假设中唯一地推导出来。计算是直接的。\n\n3.  **客观性**：该问题以客观、精确的语言陈述，没有主观性断言。\n\n基于此分析，该问题被认为是有效的。\n\n### 步骤2：推导与求解\n\n目标是计算噪声校正数据的第一主成分所捕获的方差比例。这首先需要推导真实状态的协方差矩阵 $S_x$ 的表达式，然后进行特征值分解。\n\n令 $\\Sigma_x$、$\\Sigma_y$ 和 $\\Sigma_\\epsilon$ 分别为随机向量 $\\mathbf{x}$、$\\mathbf{y}$ 和 $\\boldsymbol{\\epsilon}$ 的总体协方差矩阵。问题指出向量是中心化的，意味着它们的期望值是零向量。对于一个中心化的随机向量 $\\mathbf{v}$，其协方差矩阵定义为 $\\Sigma_v = E[\\mathbf{v}\\mathbf{v}^T]$。\n\n测量模型为 $\\mathbf{y} = \\mathbf{x} + \\boldsymbol{\\epsilon}$。\n测量向量 $\\mathbf{y}$ 的协方差为：\n$$\n\\Sigma_y = E[\\mathbf{y}\\mathbf{y}^T] = E[(\\mathbf{x} + \\boldsymbol{\\epsilon})(\\mathbf{x} + \\boldsymbol{\\epsilon})^T]\n$$\n展开乘积，我们得到：\n$$\n\\Sigma_y = E[\\mathbf{x}\\mathbf{x}^T + \\mathbf{x}\\boldsymbol{\\epsilon}^T + \\boldsymbol{\\epsilon}\\mathbf{x}^T + \\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T]\n$$\n根据期望算子的线性性：\n$$\n\\Sigma_y = E[\\mathbf{x}\\mathbf{x}^T] + E[\\mathbf{x}\\boldsymbol{\\epsilon}^T] + E[\\boldsymbol{\\epsilon}\\mathbf{x}^T] + E[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T]\n$$\n此表达式中的各项被识别为：\n- $E[\\mathbf{x}\\mathbf{x}^T] = \\Sigma_x$，真实状态的协方差。\n- $E[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T] = \\Sigma_\\epsilon$，噪声的协方差。\n\n$E[\\mathbf{x}\\boldsymbol{\\epsilon}^T]$ 和 $E[\\boldsymbol{\\epsilon}\\mathbf{x}^T]$ 这两项是互协方差矩阵。问题指出 $\\mathbf{x}$ 和 $\\boldsymbol{\\epsilon}$ 是独立的。对于独立的随机向量，它们的互协方差为零。为了证明这一点，考虑矩阵 $E[\\mathbf{x}\\boldsymbol{\\epsilon}^T]$ 的任意元素 $(i,j)$，即 $E[x_i \\epsilon_j]$。由于独立性，$E[x_i \\epsilon_j] = E[x_i]E[\\epsilon_j]$。因为 $\\mathbf{x}$ 是中心化的，所以 $E[x_i]=0$，且问题指出 $\\boldsymbol{\\epsilon}$ 是零均值的，所以 $E[\\epsilon_j]=0$。因此，$E[x_i \\epsilon_j] = 0 \\cdot 0 = 0$。这对所有 $i,j$ 均成立，所以 $E[\\mathbf{x}\\boldsymbol{\\epsilon}^T] = \\mathbf{0}$（零矩阵）。类似地，$E[\\boldsymbol{\\epsilon}\\mathbf{x}^T] = (E[\\mathbf{x}\\boldsymbol{\\epsilon}^T])^T = \\mathbf{0}$。\n\n将这些代回 $\\Sigma_y$ 的方程中：\n$$\n\\Sigma_y = \\Sigma_x + \\mathbf{0} + \\mathbf{0} + \\Sigma_\\epsilon = \\Sigma_x + \\Sigma_\\epsilon\n$$\n这就给出了总体协方差矩阵之间的基本关系。为了找到真实状态的协方差，我们可以重新整理这个方程：\n$$\n\\Sigma_x = \\Sigma_y - \\Sigma_\\epsilon\n$$\n问题为 $\\Sigma_y$ 提供了一致的样本估计量 $S_y$ 和已知的噪声协方差 $\\Sigma_\\epsilon$。因此，真实状态协方差的一致估计量，我们记为 $S_x$，由下式给出：\n$$\nS_x = S_y - \\Sigma_\\epsilon\n$$\n现在，我们可以代入给定的矩阵：\n$$\nS_x = \\begin{pmatrix} 7  1  0.5 \\\\ 1  5  0.3 \\\\ 0.5  0.3  2.2 \\end{pmatrix} - \\begin{pmatrix} 1  1  0.5 \\\\ 1  2  0.3 \\\\ 0.5  0.3  0.7 \\end{pmatrix}\n$$\n逐元素进行矩阵减法：\n$$\nS_x = \\begin{pmatrix} 7-1  1-1  0.5-0.5 \\\\ 1-1  5-2  0.3-0.3 \\\\ 0.5-0.5  0.3-0.3  2.2-0.7 \\end{pmatrix} = \\begin{pmatrix} 6  0  0 \\\\ 0  3  0 \\\\ 0  0  1.5 \\end{pmatrix}\n$$\n得到的噪声校正协方差矩阵 $S_x$ 是一个对角矩阵。对角矩阵的特征值是其对角线上的元素。因此，$S_x$ 的特征值是 $\\lambda_a=6$、$\\lambda_b=3$ 和 $\\lambda_c=1.5$。\n根据问题要求，特征值应按 $\\lambda_1 \\geq \\lambda_2 \\geq \\lambda_3$ 排序。因此，我们有：\n$$\n\\lambda_1 = 6\n$$\n$$\n\\lambda_2 = 3\n$$\n$$\n\\lambda_3 = 1.5\n$$\n问题要求计算量 $\\frac{\\lambda_{1}}{\\operatorname{tr}(S_{x})}$。矩阵的迹 $\\operatorname{tr}(S_x)$ 是其对角元素的和。\n$$\n\\operatorname{tr}(S_x) = 6 + 3 + 1.5 = 10.5\n$$\n注意，迹也是特征值的和：$\\operatorname{tr}(S_x) = \\lambda_1 + \\lambda_2 + \\lambda_3 = 6 + 3 + 1.5 = 10.5$。校正后数据的总方差由该迹给出。\n\n第一主成分所捕获的校正后总方差的比例是第一个特征值与协方差矩阵的迹之比：\n$$\n\\frac{\\lambda_{1}}{\\operatorname{tr}(S_{x})} = \\frac{6}{10.5}\n$$\n简化分数：\n$$\n\\frac{6}{10.5} = \\frac{6}{21/2} = \\frac{12}{21} = \\frac{4}{7}\n$$\n问题要求将此值表示为保留四位有效数字的小数。\n$$\n\\frac{4}{7} \\approx 0.57142857...\n$$\n保留四位有效数字得到 $0.5714$。",
            "answer": "$$\\boxed{0.5714}$$"
        },
        {
            "introduction": "构建低维流形后，在模拟中的一个关键操作是将任意热化学状态投影到该流形上。本练习将指导您构建并求解一个约束优化问题，以找到流形上的最近点。这是将降阶模型与计算流体动力学（CFD）求解器耦合的核心算法组件()。",
            "id": "4032855",
            "problem": "一个用于反应混合物的列表化本征低维流形 (ILDM) 是通过采样准稳态组分和热化学状态，然后应用主成分分析 (PCA) 来获得主导方向的正交归一基而构建的。在计算流体动力学 (CFD) 计算的某个给定单元格中，一个高维状态向量表示为 $y^{\\ast} \\in \\mathbb{R}^{n}$。该流形被参数化为局部仿射形式 $y(c) = y_{0} + U c$，其中 $y_{0} \\in \\mathbb{R}^{n}$ 是局部平均状态，$U \\in \\mathbb{R}^{n \\times r}$ 包含 $r$ 个主方向，$c \\in \\mathbb{R}^{r}$ 是降维坐标。为了比较具有不同物理单位的状态，通过一个对称正定权重 $W \\in \\mathbb{R}^{n \\times n}$ 定义了一个加权欧几里得度量，并且投影被表述为一个约束最小二乘问题，该问题通过线性等式约束来强制执行精确不变量（例如，混合分数）。\n\n从以下基本建模假设出发：(i) 在由 $W$ 导出的度量中的最近点投影最小化加权范数的平方 $\\|W\\,(y_{0} + U c - y^{\\ast})\\|_{2}^{2}$，以及 (ii) 诸如混合分数之类的不变量在向 ILDM 快速弛豫的过程中被精确保持，并表示为 $C\\,(y_{0} + U c) = d$ 形式的线性约束。请为以下具体实例推导并计算最优降维坐标。\n\n设状态向量排序为 $y = [Y_{1},\\,Y_{2},\\,\\tilde{h},\\,Z]^{\\top}$，其中 $Y_{1}$ 和 $Y_{2}$ 是两个集总物种的质量分数（无量纲），$\\tilde{h}$ 是一个无量纲化的显焓，$Z$ 是混合分数。PCA 导出的流形表示为\n$$\ny_{0} \\;=\\;\n\\begin{pmatrix}\n0.5\\\\\n0.5\\\\\n0\\\\\n0\n\\end{pmatrix},\n\\qquad\nU \\;=\\;\n\\begin{pmatrix}\n0.6  0\\\\\n-0.6  0\\\\\n0  1\\\\\n0.2  0.5\n\\end{pmatrix},\n\\qquad\nW \\;=\\; I_{4},\n$$\n从而仿射子空间 $y(c) = y_{0} + U c$ 自动强制 $Y_{1} + Y_{2} = 1$。待投影的 CFD 状态是\n$$\ny^{\\ast} \\;=\\;\n\\begin{pmatrix}\n0.7\\\\\n0.3\\\\\n0.4\\\\\n0.25\n\\end{pmatrix}.\n$$\n通过以下线性约束强制混合分数的精确不变性\n$$\nC\\,(y_{0} + U c) \\;=\\; d,\n\\qquad\nC \\;=\\;\n\\begin{pmatrix}\n0  0  0  1\n\\end{pmatrix},\n\\qquad\nd \\;=\\; Z^{\\ast} \\;=\\; 0.25,\n$$\n并确定求解以下问题的最优降维坐标 $c^{\\star} \\in \\mathbb{R}^{2}$\n$$\n\\min_{c \\in \\mathbb{R}^{2}} \\;\\big\\|W\\,(y_{0} + U c - y^{\\ast})\\big\\|_{2}^{2}\n\\quad\\text{subject to}\\quad\nC\\,(y_{0} + U c) = d.\n$$\n将您的最终答案表示为精确形式的行向量 $\\big(c_{1}^{\\star},\\,c_{2}^{\\star}\\big)$。无需四舍五入，也无需单位。",
            "solution": "用户提供了一个计算科学领域的适定问题，需要求解一个约束最小二乘优化。该问题具有科学依据，形式化指定清晰，并包含获得唯一解所需的所有数据。因此，该问题被认为是有效的。\n\n该问题要求找到最优降维坐标 $c^{\\star} \\in \\mathbb{R}^{2}$，以求解以下约束最小化问题：\n$$\n\\min_{c \\in \\mathbb{R}^{2}} \\;\\big\\|W\\,(y_{0} + U c - y^{\\ast})\\big\\|_{2}^{2}\n\\quad\\text{subject to}\\quad\nC\\,(y_{0} + U c) = d.\n$$\n这是一个带线性等式约束的二次规划问题。解决此类问题的标准方法是拉格朗日乘数法。\n\n首先，我们定义目标函数 $\\mathcal{J}(c)$ 和约束。\n目标函数为 $\\mathcal{J}(c) = \\|W(y(c) - y^{\\ast})\\|_{2}^{2}$，其中 $y(c) = y_0 + U c$。\n设 $\\Delta y = y^{\\ast} - y_0$。范数内的表达式是 $Uc - \\Delta y$。\n目标函数变为 $\\mathcal{J}(c) = \\|W(Uc - \\Delta y)\\|_{2}^{2}$。\n根据欧几里得范数平方的定义，这可以写成 $\\mathcal{J}(c) = (Uc - \\Delta y)^{\\top}W^{\\top}W(Uc - \\Delta y)$。\n问题给出 $W = I_{4}$，即 $4 \\times 4$ 的单位矩阵。因此，$W^{\\top}W = I_{4}^{\\top}I_{4} = I_{4}$。目标函数简化为标准的（无权重）最小二乘形式：\n$$\n\\mathcal{J}(c) = \\|Uc - \\Delta y\\|_{2}^{2} = (Uc - \\Delta y)^{\\top}(Uc - \\Delta y) = c^{\\top}U^{\\top}Uc - 2c^{\\top}U^{\\top}\\Delta y + \\Delta y^{\\top}\\Delta y.\n$$\n线性约束为 $C(y_0 + Uc) = d$，可以重新整理为：\n$$\nCUc - (d - Cy_0) = 0.\n$$\n我们通过将约束乘以一个拉格朗日乘子 $\\lambda \\in \\mathbb{R}^{1}$（因为只有一个标量约束）来构建拉格朗日函数 $\\Lambda(c, \\lambda)$：\n$$\n\\Lambda(c, \\lambda) = \\mathcal{J}(c) + \\lambda \\big(CUc - (d - Cy_0)\\big).\n$$\n最优坐标 $c^{\\star}$ 必须满足 Karush-Kuhn-Tucker (KKT) 条件。对于此问题，可以通过将拉格朗日函数关于 $c$ 和 $\\lambda$ 的梯度设为零来求得。\n\n关于 $c$ 的梯度是：\n$$\n\\nabla_{c} \\Lambda(c, \\lambda) = \\nabla_{c} \\left( c^{\\top}U^{\\top}Uc - 2c^{\\top}U^{\\top}\\Delta y + \\Delta y^{\\top}\\Delta y + \\lambda(CUc - (d - Cy_0)) \\right) = 0.\n$$\n使用标准矩阵微积分恒等式，我们得到：\n$$\n2U^{\\top}Uc - 2U^{\\top}\\Delta y + \\lambda(CU)^{\\top} = 0\n\\implies 2U^{\\top}Uc - 2U^{\\top}\\Delta y + \\lambda U^{\\top}C^{\\top} = 0.\n$$\n除以 $2$ 并令 $\\mu = \\lambda/2$，我们得到第一个方程：\n$$\n(U^{\\top}U)c + \\mu U^{\\top}C^{\\top} = U^{\\top}\\Delta y.\n$$\n关于 $\\lambda$ 的导数只是恢复了约束条件：\n$$\n\\frac{\\partial \\Lambda}{\\partial \\lambda} = CUc - (d - Cy_0) = 0 \\implies (CU)c = d - Cy_0.\n$$\n这两个方程构成了一个关于 $c$ 和 $\\mu$ 的线性方程组：\n$$\n\\begin{pmatrix} U^{\\top}U  U^{\\top}C^{\\top} \\\\ CU  0 \\end{pmatrix} \\begin{pmatrix} c \\\\ \\mu \\end{pmatrix} = \\begin{pmatrix} U^{\\top}\\Delta y \\\\ d - Cy_0 \\end{pmatrix}.\n$$\n现在我们为给定问题计算具体的矩阵和向量。\n给定的数据是：\n$$\ny_{0} = \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\\nU = \\begin{pmatrix} 0.6  0 \\\\ -0.6  0 \\\\ 0  1 \\\\ 0.2  0.5 \\end{pmatrix}, \\\ny^{\\ast} = \\begin{pmatrix} 0.7 \\\\ 0.3 \\\\ 0.4 \\\\ 0.25 \\end{pmatrix}, \\\nC = \\begin{pmatrix} 0  0  0  1 \\end{pmatrix}, \\\nd = 0.25.\n$$\n首先，计算向量 $\\Delta y = y^{\\ast} - y_0$：\n$$\n\\Delta y = \\begin{pmatrix} 0.7 - 0.5 \\\\ 0.3 - 0.5 \\\\ 0.4 - 0 \\\\ 0.25 - 0 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ -0.2 \\\\ 0.4 \\\\ 0.25 \\end{pmatrix}.\n$$\n接下来，我们计算分块矩阵系统的各个组成部分。\n$$\nU^{\\top}U = \\begin{pmatrix} 0.6  -0.6  0  0.2 \\\\ 0  0  1  0.5 \\end{pmatrix} \\begin{pmatrix} 0.6  0 \\\\ -0.6  0 \\\\ 0  1 \\\\ 0.2  0.5 \\end{pmatrix} = \\begin{pmatrix} 0.36 + 0.36 + 0.04  0.1 \\\\ 0.1  1 + 0.25 \\end{pmatrix} = \\begin{pmatrix} 0.76  0.1 \\\\ 0.1  1.25 \\end{pmatrix}.\n$$\n$$\nU^{\\top}C^{\\top} = \\begin{pmatrix} 0.6  -0.6  0  0.2 \\\\ 0  0  1  0.5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 0.5 \\end{pmatrix}.\n$$\n$$\nCU = \\begin{pmatrix} 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 0.6  0 \\\\ -0.6  0 \\\\ 0  1 \\\\ 0.2  0.5 \\end{pmatrix} = \\begin{pmatrix} 0.2  0.5 \\end{pmatrix}.\n$$\n$$\nU^{\\top}\\Delta y = \\begin{pmatrix} 0.6  -0.6  0  0.2 \\\\ 0  0  1  0.5 \\end{pmatrix} \\begin{pmatrix} 0.2 \\\\ -0.2 \\\\ 0.4 \\\\ 0.25 \\end{pmatrix} = \\begin{pmatrix} 0.12 + 0.12 + 0.05 \\\\ 0.4 + 0.125 \\end{pmatrix} = \\begin{pmatrix} 0.29 \\\\ 0.525 \\end{pmatrix}.\n$$\n$$\nCy_0 = \\begin{pmatrix} 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 0 \\\\ 0 \\end{pmatrix} = 0.\n$$\n$$\nd - Cy_0 = 0.25 - 0 = 0.25.\n$$\n设 $c = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。该方程组为：\n$$\n\\begin{pmatrix} 0.76  0.1  0.2 \\\\ 0.1  1.25  0.5 \\\\ 0.2  0.5  0 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ \\mu \\end{pmatrix} = \\begin{pmatrix} 0.29 \\\\ 0.525 \\\\ 0.25 \\end{pmatrix}.\n$$\n这代表以下三个线性方程：\n1. $0.76 c_1 + 0.1 c_2 + 0.2 \\mu = 0.29$\n2. $0.1 c_1 + 1.25 c_2 + 0.5 \\mu = 0.525$\n3. $0.2 c_1 + 0.5 c_2 = 0.25$\n\n为了保持精度，我们将其转换为分数：$0.76=\\frac{19}{25}$，$0.1=\\frac{1}{10}$，$0.2=\\frac{1}{5}$，$1.25=\\frac{5}{4}$，$0.5=\\frac{1}{2}$，$0.29=\\frac{29}{100}$，$0.525=\\frac{21}{40}$，$0.25=\\frac{1}{4}$。\n该系统为：\n1. $\\frac{19}{25} c_1 + \\frac{1}{10} c_2 + \\frac{1}{5} \\mu = \\frac{29}{100}$\n2. $\\frac{1}{10} c_1 + \\frac{5}{4} c_2 + \\frac{1}{2} \\mu = \\frac{21}{40}$\n3. $\\frac{1}{5} c_1 + \\frac{1}{2} c_2 = \\frac{1}{4}$\n\n从方程 (3) 中，我们可以用 $c_1$ 表示 $c_2$（反之亦然）。乘以 $10$ 得到 $2c_1 + 5c_2 = 2.5$，即 $4c_1 + 10c_2 = 5$。\n我们来消去 $\\mu$。将方程 (1) 乘以 $5$，方程 (2) 乘以 $2$：\n$5 \\times (1): \\frac{19}{5} c_1 + \\frac{1}{2} c_2 + \\mu = \\frac{29}{20}$\n$2 \\times (2): \\frac{1}{5} c_1 + \\frac{5}{2} c_2 + \\mu = \\frac{21}{20}$\n用第一个新方程减去第二个新方程：\n$$\n\\left(\\frac{19}{5} - \\frac{1}{5}\\right) c_1 + \\left(\\frac{1}{2} - \\frac{5}{2}\\right) c_2 = \\frac{29}{20} - \\frac{21}{20}\n$$\n$$\n\\frac{18}{5} c_1 - 2 c_2 = \\frac{8}{20} = \\frac{2}{5}\n$$\n乘以 $5$ 得到 $18 c_1 - 10 c_2 = 2$，简化为 $9 c_1 - 5 c_2 = 1$。\n我们现在得到一个关于 $c_1$ 和 $c_2$ 的二元方程组：\n(A) $9 c_1 - 5 c_2 = 1$\n(B) $\\frac{1}{5} c_1 + \\frac{1}{2} c_2 = \\frac{1}{4} \\implies 4 c_1 + 10 c_2 = 5$\n\n从 (A) 式得到 $5c_2 = 9c_1 - 1$。代入 (B) 式：\n$4 c_1 + 2(5 c_2) = 5$\n$4 c_1 + 2(9 c_1 - 1) = 5$\n$4 c_1 + 18 c_1 - 2 = 5$\n$22 c_1 = 7 \\implies c_1^{\\star} = \\frac{7}{22}$。\n\n现在将 $c_1^{\\star}$ 代回以求得 $c_2^{\\star}$：\n$5 c_2 = 9 \\left(\\frac{7}{22}\\right) - 1 = \\frac{63}{22} - \\frac{22}{22} = \\frac{41}{22}$。\n$c_2^{\\star} = \\frac{41}{22 \\times 5} = \\frac{41}{110}$。\n\n最优降维坐标为 $c^{\\star} = (c_1^{\\star}, c_2^{\\star}) = (\\frac{7}{22}, \\frac{41}{110})$。\n\n最后检验：必须满足约束条件。\n$0.2 c_1 + 0.5 c_2 = \\frac{1}{5}\\left(\\frac{7}{22}\\right) + \\frac{1}{2}\\left(\\frac{41}{110}\\right) = \\frac{7}{110} + \\frac{41}{220} = \\frac{14}{220} + \\frac{41}{220} = \\frac{55}{220} = \\frac{1}{4} = 0.25$。\n约束条件得到满足。解是正确的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{7}{22}  \\frac{41}{110}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}