{
    "hands_on_practices": [
        {
            "introduction": "“刚性”问题的核心在于不同时间尺度的共存对数值稳定性的影响。本练习通过一个简单但极具代表性的标量常微分方程 $\\frac{dy}{dt}=\\lambda y$，直观地揭示了显式和隐式方法在求解刚性系统时稳定性的巨大差异。理解这个基本模型的行为，对于认识为何在化学动力学模拟中隐式积分方法不可或缺至关重要。",
            "id": "4068055",
            "problem": "在化学反应混合物中，高活性中间体的弛豫过程通常可以局部线性化为一个标量常微分方程 (ODE)，其形式为 $\\frac{dy}{dt}=\\lambda y$，其中 $\\lambda$ 是在给定状态下由化学源项的雅可比矩阵产生的主导实特征值。考虑 $\\lambda=-10^{6}\\ \\text{s}^{-1}$ 的情况，这代表了计算燃烧学中典型的刚性化学动力学中的一种快速衰减模式。\n\n仅使用应用于线性检验方程 $\\frac{dy}{dt}=\\lambda y$ 的单步法绝对稳定性的定义，确定对于以下方法能够产生线性稳定数值积分的最大时间步长 $\\Delta t$：\n- 前向（显式）欧拉法，以及\n- 后向（隐式）欧拉法。\n\n假设 $\\Delta t \\geq 0$。用秒（s）表示两个最大稳定时间步长。如果最大稳定时间步长是无界的，用 $+\\infty$ 表示。以精确形式给出任何有限数值，不要四舍五入。最后，根据您的结果，简要说明这些稳定性界限对刚性化学动力学时间积分的意义。\n\n您的最终答案必须是数对 $\\left(\\Delta t_{\\text{FE,max}},\\ \\Delta t_{\\text{BE,max}}\\right)$，其中 $\\Delta t_{\\text{FE,max}}$ 是前向欧拉法的最大稳定步长，$\\Delta t_{\\text{BE,max}}$ 是后向欧拉法的最大稳定步长，单位为秒。",
            "solution": "该问题要求在给定刚性特征值 $\\lambda = -10^{6}\\ \\text{s}^{-1}$ 的情况下，确定当应用于线性检验方程 $\\frac{dy}{dt}=\\lambda y$ 时，前向和后向欧拉法的最大稳定时间步长 $\\Delta t$。此分析基于单步数值方法的绝对稳定性定义。\n\n应用于检验方程 $\\frac{dy}{dt}=\\lambda y$ 的通用单步法可以写成以下形式：\n$$y_{n+1} = G(z) y_n$$\n其中 $y_n$ 是解在时间 $t_n$ 的数值近似，$y_{n+1}$ 是在时间 $t_{n+1} = t_n + \\Delta t$ 的近似，$z = \\lambda \\Delta t$，而 $G(z)$ 是该方法的稳定性函数（或放大因子）。为了使数值解保持有界（即，为了使方法绝对稳定），放大因子的模不得超过 1：\n$$|G(z)| \\le 1$$\n满足此条件的所有复数 $z$ 的集合称为绝对稳定域。给定的特征值 $\\lambda = -10^{6}\\ \\text{s}^{-1}$ 是一个负实数。时间步长 $\\Delta t$ 假定为非负，$\\Delta t \\ge 0$。因此，乘积 $z = \\lambda \\Delta t$ 是一个非正实数。\n\n**前向（显式）欧拉法**\n\n前向欧拉法定义为：\n$$y_{n+1} = y_n + \\Delta t f(t_n, y_n)$$\n对于检验方程 $f(t,y) = \\lambda y$，这变为：\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_n) = (1 + \\lambda \\Delta t) y_n$$\n将其与通用形式 $y_{n+1} = G(z) y_n$ 进行比较，我们确定前向欧拉法的稳定性函数为：\n$$G_{\\text{FE}}(z) = 1 + z$$\n绝对稳定性的条件是 $|G_{\\text{FE}}(z)| \\le 1$，这可以转换为：\n$$|1 + \\lambda \\Delta t| \\le 1$$\n由于 $\\lambda \\Delta t$ 是一个非正实数，这个不等式等价于：\n$$-1 \\le 1 + \\lambda \\Delta t \\le 1$$\n这个复合不等式可以分为两部分：\n1. $1 + \\lambda \\Delta t \\le 1 \\implies \\lambda \\Delta t \\le 0$。因为 $\\lambda  0$ 且 $\\Delta t \\ge 0$，这个条件总是成立的。\n2. $-1 \\le 1 + \\lambda \\Delta t \\implies -2 \\le \\lambda \\Delta t$。\n由于 $\\lambda$ 是负数，除以 $\\lambda$ 时必须反转不等号：\n$$\\Delta t \\le \\frac{-2}{\\lambda}$$\n这个条件定义了时间步长的稳定性极限。因此，最大稳定时间步长 $\\Delta t_{\\text{FE,max}}$ 为：\n$$\\Delta t_{\\text{FE,max}} = \\frac{-2}{\\lambda}$$\n代入给定值 $\\lambda = -10^{6}\\ \\text{s}^{-1}$：\n$$\\Delta t_{\\text{FE,max}} = \\frac{-2}{-10^{6}\\ \\text{s}^{-1}} = 2 \\times 10^{-6}\\ \\text{s}$$\n\n**后向（隐式）欧拉法**\n\n后向欧拉法定义为：\n$$y_{n+1} = y_n + \\Delta t f(t_{n+1}, y_{n+1})$$\n对于检验方程，这变为：\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1})$$\n为了找到稳定性函数，我们必须首先求解 $y_{n+1}$：\n$$y_{n+1} - \\Delta t \\lambda y_{n+1} = y_n$$\n$$y_{n+1}(1 - \\lambda \\Delta t) = y_n$$\n$$y_{n+1} = \\frac{1}{1 - \\lambda \\Delta t} y_n$$\n后向欧拉法的稳定性函数是：\n$$G_{\\text{BE}}(z) = \\frac{1}{1 - z}$$\n绝对稳定性的条件是 $|G_{\\text{BE}}(z)| \\le 1$，这可以转换为：\n$$\\left|\\frac{1}{1 - \\lambda \\Delta t}\\right| \\le 1 \\implies |1 - \\lambda \\Delta t| \\ge 1$$\n如前所述，$\\lambda$ 是一个负实数且 $\\Delta t \\ge 0$，所以 $\\lambda \\Delta t \\le 0$。因此，$-\\lambda \\Delta t \\ge 0$。\n因此，绝对值内的项 $1 - \\lambda \\Delta t$ 总是大于或等于 $1$。绝对值是多余的，不等式变为：\n$$1 - \\lambda \\Delta t \\ge 1$$\n这可以简化为 $-\\lambda \\Delta t \\ge 0$。由于 $\\lambda  0$ 且 $\\Delta t \\ge 0$，这个条件对于所有非负的 $\\Delta t$ 值都满足。因此，对于此问题，后向欧拉法是无条件稳定的。最大稳定时间步长是无界的。\n$$\\Delta t_{\\text{BE,max}} = \\infty$$\n\n**对刚性化学动力学的意义**\n\n特征值 $\\lambda = -10^{6}\\ \\text{s}^{-1}$ 代表了一个非常快速的化学过程，其特征时间尺度为 $\\tau = 1/|\\lambda| = 10^{-6}\\ \\text{s}$。\n前向（显式）欧拉法的结果 $\\Delta t_{\\text{FE,max}} = 2 \\times 10^{-6}\\ \\text{s}$ 表明，时间步长受到系统中最快时间尺度的严格限制。为了保持稳定性，即使感兴趣的物理现象在慢得多的时间尺度上发展，数值积分也必须以极小的时间步长（量级为 $\\tau$）进行。这使得显式方法在计算上对于刚性系统来说成本过高。\n\n相反，后向（隐式）欧拉法的结果 $\\Delta t_{\\text{BE,max}} = \\infty$ 表明它是 A-稳定的。它的稳定性不受刚性特征值的限制。这允许使用大得多的时间步长，其大小仅受限于精确解析系统较慢动力学的需要，而非稳定性。这一特性使得像后向欧拉法这样的隐式方法，对于计算燃烧学中常见的刚性化学动力学系统的数值积分，变得至关重要且效率远高于显式方法。",
            "answer": "$$\n\\boxed{\n(2 \\times 10^{-6}, \\infty)\n}\n$$"
        },
        {
            "introduction": "在理解了单个刚性模式（如  中所探讨的）对数值稳定性的影响后，下一个关键问题是如何从一个具体的化学反应机理中识别出这些模式。本练习将引导你从一个简化的链式反应机理出发，推导其源项的雅可比矩阵 $\\boldsymbol{J}(\\boldsymbol{y})$，并计算其特征值以量化系统的局部刚性。通过这个实践，你将建立起从化学机理到数值分析中刚性度量的桥梁。",
            "id": "4068051",
            "problem": "考虑一个等温、恒密度的均相反应器，其简化的两步链支化和终止机理用质量作用定律表示。这两个反应是：\n1. 自催化链支化反应：$A + B \\rightarrow 2B$，速率为 $r_{1} = k_{1} [A][B]$。\n2. 自由基终止反应：$B \\rightarrow C$，速率为 $r_{2} = k_{2} [B]$。\n\n假设物种浓度向量为 $\\boldsymbol{y} = \\begin{pmatrix} [A] \\\\ [B] \\end{pmatrix}$，反应器是完美混合的，控制反应源项的常微分方程（ODEs）遵循化学计量和质量作用定律。雅可比矩阵 $\\boldsymbol{J}(\\boldsymbol{y})$ 定义为源项向量相对于 $\\boldsymbol{y}$ 的一阶偏导数矩阵。\n\n从质量作用定律的基本定义和各物种的化学计量平衡出发，推导该两步机理的解析雅可比矩阵 $\\boldsymbol{J}(\\boldsymbol{y})$。然后，在指定状态 $[A]^{\\ast} = 1.0 \\,\\text{mol}\\,\\text{m}^{-3}$ 和 $[B]^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{mol}\\,\\text{m}^{-3}$，以及动力学参数 $k_{1} = 2.0 \\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$ 和 $k_{2} = 5.0 \\times 10^{2} \\,\\text{s}^{-1}$ 下，计算 $\\boldsymbol{J}$。\n\n计算所求雅可比矩阵的特征值，并用它们通过比率 $$S = \\frac{|\\lambda_{\\text{fast}}|}{|\\lambda_{\\text{slow}}|},$$ 来量化局部刚度，其中 $|\\lambda_{\\text{fast}}|$ 是量值较大的特征值，而 $|\\lambda_{\\text{slow}}|$ 是量值较小的特征值。将您最终的 $S$ 值四舍五入到四位有效数字。最终答案以无量纲数表示。",
            "solution": "该问题要求推导给定两步化学动力学机理的雅可比矩阵，在特定状态下对其进行求值，并根据其特征值计算刚度比。\n\n第一步是建立控制物种 $A$ 和 $B$ 浓度的常微分方程（ODE）系统。物种向量为 $\\boldsymbol{y} = \\begin{pmatrix} [A] \\\\ [B] \\end{pmatrix}$。各物种浓度的变化率等于其净生成速率 $\\dot{\\omega}_i$。源项向量为 $\\boldsymbol{\\omega}(\\boldsymbol{y}) = \\frac{d\\boldsymbol{y}}{dt}$。\n\n反应如下：\n$1. \\quad A + B \\rightarrow 2B$，速率为 $r_{1} = k_{1} [A][B]$。\n$2. \\quad B \\rightarrow C$，速率为 $r_{2} = k_{2} [B]$。\n\n对于物种 $A$，它在反应1中被消耗。其净生成速率为：\n$$\\dot{\\omega}_A = \\frac{d[A]}{dt} = -r_1 = -k_1[A][B]$$\n\n对于物种 $B$，它在反应1中生成（消耗一摩尔 $B$，但生成两摩尔，净生成一摩尔），并在反应2中被消耗。其净生成速率为：\n$$\\dot{\\omega}_B = \\frac{d[B]}{dt} = +r_1 - r_2 = k_1[A][B] - k_2[B]$$\n\n因此，源项向量 $\\boldsymbol{\\omega}(\\boldsymbol{y})$ 为：\n$$\\boldsymbol{\\omega}(\\boldsymbol{y}) = \\begin{pmatrix} \\dot{\\omega}_A \\\\ \\dot{\\omega}_B \\end{pmatrix} = \\begin{pmatrix} -k_1[A][B] \\\\ k_1[A][B] - k_2[B] \\end{pmatrix}$$\n\n雅可比矩阵 $\\boldsymbol{J}(\\boldsymbol{y})$ 定义为源项向量相对于物种浓度的一阶偏导数矩阵：\n$$\\boldsymbol{J}(\\boldsymbol{y}) = \\frac{\\partial \\boldsymbol{\\omega}}{\\partial \\boldsymbol{y}} = \\begin{pmatrix} \\frac{\\partial \\dot{\\omega}_A}{\\partial [A]}  \\frac{\\partial \\dot{\\omega}_A}{\\partial [B]} \\\\ \\frac{\\partial \\dot{\\omega}_B}{\\partial [A]}  \\frac{\\partial \\dot{\\omega}_B}{\\partial [B]} \\end{pmatrix}$$\n\n我们计算雅可比矩阵的每个元素：\n$$J_{11} = \\frac{\\partial}{\\partial [A]}(-k_1[A][B]) = -k_1[B]$$\n$$J_{12} = \\frac{\\partial}{\\partial [B]}(-k_1[A][B]) = -k_1[A]$$\n$$J_{21} = \\frac{\\partial}{\\partial [A]}(k_1[A][B] - k_2[B]) = k_1[B]$$\n$$J_{22} = \\frac{\\partial}{\\partial [B]}(k_1[A][B] - k_2[B]) = k_1[A] - k_2$$\n\n解析雅可比矩阵为：\n$$\\boldsymbol{J}(\\boldsymbol{y}) = \\begin{pmatrix} -k_1[B]  -k_1[A] \\\\ k_1[B]  k_1[A] - k_2 \\end{pmatrix}$$\n\n接下来，我们在指定状态下计算该雅可比矩阵：$[A]^{\\ast} = 1.0 \\,\\text{mol}\\,\\text{m}^{-3}$，$[B]^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{mol}\\,\\text{m}^{-3}$，其中 $k_{1} = 2.0 \\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$ 且 $k_{2} = 5.0 \\times 10^{2} \\,\\text{s}^{-1}$。所有雅可比矩阵元素的单位均为 $\\text{s}^{-1}$。\n\n$$J^{\\ast}_{11} = - (2.0) \\times (1.0 \\times 10^{-3}) = -2.0 \\times 10^{-3}$$\n$$J^{\\ast}_{12} = - (2.0) \\times (1.0) = -2.0$$\n$$J^{\\ast}_{21} = (2.0) \\times (1.0 \\times 10^{-3}) = 2.0 \\times 10^{-3}$$\n$$J^{\\ast}_{22} = (2.0) \\times (1.0) - (5.0 \\times 10^2) = 2.0 - 500 = -498$$\n\n计算得到的雅可比矩阵 $\\boldsymbol{J}^{\\ast}$ 为：\n$$\\boldsymbol{J}^{\\ast} = \\begin{pmatrix} -2.0 \\times 10^{-3}  -2.0 \\\\ 2.0 \\times 10^{-3}  -498 \\end{pmatrix}$$\n\n$\\boldsymbol{J}^{\\ast}$ 的特征值 $\\lambda$ 是特征方程 $\\det(\\boldsymbol{J}^{\\ast} - \\lambda\\boldsymbol{I}) = 0$ 的根，其中 $\\boldsymbol{I}$ 是单位矩阵。该特征方程可以写为 $\\lambda^2 - \\text{Tr}(\\boldsymbol{J}^{\\ast})\\lambda + \\det(\\boldsymbol{J}^{\\ast}) = 0$。\n\n$\\boldsymbol{J}^{\\ast}$ 的迹为：\n$$\\text{Tr}(\\boldsymbol{J}^{\\ast}) = J^{\\ast}_{11} + J^{\\ast}_{22} = (-2.0 \\times 10^{-3}) + (-498) = -498.002$$\n\n$\\boldsymbol{J}^{\\ast}$ 的行列式为：\n$$\\det(\\boldsymbol{J}^{\\ast}) = J^{\\ast}_{11}J^{\\ast}_{22} - J^{\\ast}_{12}J^{\\ast}_{21} = (-2.0 \\times 10^{-3})(-498) - (-2.0)(2.0 \\times 10^{-3})$$\n$$\\det(\\boldsymbol{J}^{\\ast}) = 0.996 - (-0.004) = 1.0$$\n\n特征方程为：\n$$\\lambda^2 - (-498.002)\\lambda + 1.0 = 0$$\n$$\\lambda^2 + 498.002\\lambda + 1.0 = 0$$\n\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a=1$, $b=498.002$, $c=1.0$：\n$$\\lambda = \\frac{-498.002 \\pm \\sqrt{(498.002)^2 - 4(1)(1)}}{2}$$\n$$\\lambda = \\frac{-498.002 \\pm \\sqrt{248005.992004 - 4}}{2} = \\frac{-498.002 \\pm \\sqrt{248001.992004}}{2}$$\n$$\\lambda = \\frac{-498.002 \\pm 497.9979839}{2}$$\n\n两个特征值为：\n$$\\lambda_1 = \\frac{-498.002 + 497.9979839}{2} = \\frac{-0.0040161}{2} \\approx -0.002008$$\n$$\\lambda_2 = \\frac{-498.002 - 497.9979839}{2} = \\frac{-996.0}{2} = -498.0$$\n更精确地，使用迹的性质 $\\lambda_1 + \\lambda_2 = -498.002$，我们得到 $\\lambda_2 = -498.002 - \\lambda_1 \\approx -498.002 - (-0.002008) = -497.999992$。\n\n特征值表示当前状态扰动的衰减速率。量值较大的特征值对应于快时间尺度，而量值较小的特征值对应于慢时间尺度。\n$$|\\lambda_1| \\approx 0.002008 \\quad \\text{(慢尺度)}$$\n$$|\\lambda_2| \\approx 498.0 \\quad \\text{(快尺度)}$$\n所以，$\\lambda_{\\text{slow}} = \\lambda_1$ 且 $\\lambda_{\\text{fast}} = \\lambda_2$。\n\n刚度比 $S$ 定义为快、慢特征值量值的比率：\n$$S = \\frac{|\\lambda_{\\text{fast}}|}{|\\lambda_{\\text{slow}}|} = \\frac{|-497.999992|}{|-0.00200804|} \\approx \\frac{498.0}{0.002008}$$\n$$S \\approx 248003.99$$\n\n将结果四舍五入到四位有效数字：\n$$S \\approx 2.480 \\times 10^5$$\n刚度比是一个无量纲量，因为两个特征值的单位都是时间的倒数。",
            "answer": "$$\\boxed{2.480 \\times 10^{5}}$$"
        },
        {
            "introduction": "理论分析最终需要服务于实际的计算。这个综合性练习将前面学到的概念——如通过雅可比矩阵分析时间尺度  和评估稳定性限制——整合到一个实用的算法中。你将通过编写代码来模拟一个自适应求解器如何自动诊断系统的刚性、非正规性和不稳定性，并据此做出选择积分方法和步长的决策，这对于计算科学家来说是一项核心技能。",
            "id": "4068066",
            "problem": "在计算燃烧学中，给定一个由常微分方程组 $d\\mathbf{y}/dt = \\mathbf{f}(\\mathbf{y})$ 描述的局部线性化化学动力学系统，设雅可比矩阵为在给定状态 $\\mathbf{y}$ 下评估的 $\\mathbf{J}(\\mathbf{y}) = \\partial \\mathbf{f}/\\partial \\mathbf{y}$。考虑使用对角缩放矩阵 $\\mathbf{D} = \\mathrm{diag}(w_1,\\dots,w_n)$ 的缩放变量，其中对于一个小的正标量 $\\varepsilon$，$w_i = \\max(|y_i|,\\varepsilon)$。将缩放后的雅可比矩阵定义为 $\\mathbf{J}_s = \\mathbf{D}^{-1}\\mathbf{J}\\mathbf{D}$。状态 $\\mathbf{y}$ 附近的局部线性动力学由 $\\mathbf{J}_s$ 的特征值 $\\lambda_i$ 控制，其模态行为为 $e^{\\lambda_i t}$。当衰减或增长率 $-\\mathrm{Re}(\\lambda_i)$ 高度离散（时间尺度分离较大）时，系统出现刚性，并且刚性可能因非正规性而加剧。\n\n您的任务是根据给定的状态和雅可比矩阵计算刚性指标值，然后使用这些值来做出有原则的求解器选择决策（显式与隐式），并确定用于步长控制的推荐步长。所有计算必须源于以下基本依据：\n- 局部线性化 $d\\mathbf{y}/dt \\approx \\mathbf{J}_s \\mathbf{y}$ 和模态解 $e^{\\lambda_i t}$，意味着具有 $\\mathrm{Re}(\\lambda_i)  0$ 的模态以特征时间尺度 $1/(-\\mathrm{Re}(\\lambda_i))$ 衰减，而具有 $\\mathrm{Re}(\\lambda_i)  0$ 的模态以特征时间尺度 $1/\\mathrm{Re}(\\lambda_i)$ 增长。\n- 对于具有特征值 $\\lambda$ 的线性模态，前向欧拉稳定性判据要求对于时间步长 $h  0$，满足 $|1 + h \\lambda|  1$。对于复数 $\\lambda$，当 $\\mathrm{Re}(\\lambda)  0$ 时，这可以写成 $h  -2\\,\\mathrm{Re}(\\lambda)/|\\lambda|^2$。对于 $\\mathrm{Re}(\\lambda) \\ge 0$，没有正数 $h$ 满足该严格不等式。\n\n需要计算的定义和指标：\n- 衰减模态的时间尺度：对于每个特征值 $\\lambda_i$ 且 $\\mathrm{Re}(\\lambda_i)  0$，定义时间尺度 $\\tau_i = 1/(-\\mathrm{Re}(\\lambda_i))$，单位为秒。令 $\\tau_{\\min}$ 为所有此类 $\\tau_i$ 的最小值，$\\tau_{\\max}$ 为所有此类 $\\tau_i$ 的最大值。如果没有特征值具有负实部，则设 $\\tau_{\\min} = +\\infty$ 和 $\\tau_{\\max} = +\\infty$。\n- 刚性比：$R = \\tau_{\\max}/\\tau_{\\min}$，约定如果 $\\tau_{\\min} = +\\infty$，则 $R = +\\infty$。\n- 最大稳定前向欧拉步长：$h_{\\mathrm{FE},\\max} = \\min_{i:\\mathrm{Re}(\\lambda_i)  0} \\left(-\\dfrac{2\\,\\mathrm{Re}(\\lambda_i)}{|\\lambda_i|^2}\\right)$，单位为秒。如果没有特征值具有负实部，则设 $h_{\\mathrm{FE},\\max} = 0$。\n- 非正规性度量（偏离正规性的程度）：$D = \\dfrac{\\|\\mathbf{J}_s \\mathbf{J}_s^{*} - \\mathbf{J}_s^{*} \\mathbf{J}_s\\|_F}{\\|\\mathbf{J}_s\\|_F^2}$，其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数，$(\\cdot)^{*}$ 表示共轭转置。此 $D$ 无单位。\n\n求解器选择和步长控制：\n- 定义阈值 $R_{\\mathrm{th}} = 100$（无单位），$D_{\\mathrm{th}} = 0.3$（无单位），以及 $h_{\\min,\\mathrm{th}} = 10^{-4}$（秒）。\n- 如果任何特征值满足 $\\mathrm{Re}(\\lambda_i)  0$，则声明局部线性化系统不稳定，并倾向于使用隐式积分。否则，如果 $R  R_{\\mathrm{th}}$ 或 $D  D_{\\mathrm{th}}$ 或 $h_{\\mathrm{FE},\\max}  h_{\\min,\\mathrm{th}}$，则倾向于使用隐式；否则倾向于使用显式。\n- 推荐步长 $h_{\\mathrm{rec}}$：\n    - 如果倾向于显式：使用安全因子 $s_{\\mathrm{exp}} \\in (0,1)$ 和分辨率因子 $\\beta  0$，设置 $h_{\\mathrm{rec}} = \\min\\left(s_{\\mathrm{exp}}\\,h_{\\mathrm{FE},\\max}, \\beta\\,\\tau_{\\min}\\right)$，单位为秒。\n    - 如果倾向于隐式：\n        - 如果系统不稳定（某些 $\\mathrm{Re}(\\lambda_i)  0$），令 $\\tau_{\\mathrm{grow}} = 1/\\max_{i:\\mathrm{Re}(\\lambda_i)  0}\\mathrm{Re}(\\lambda_i)$ 并设置 $h_{\\mathrm{rec}} = \\beta_{\\mathrm{imp}}\\,\\tau_{\\mathrm{grow}}$。\n        - 如果系统稳定（所有 $\\mathrm{Re}(\\lambda_i) \\le 0$），设置 $h_{\\mathrm{rec}} = \\beta_{\\mathrm{imp}}\\,\\tau_{\\max}$，其中 $\\beta_{\\mathrm{imp}}  0$ 是一个面向精度的缩放因子。\n\n所有物理时间量必须以秒为单位表示，并为浮点数。刚性比和非正规性度量必须是浮点数。求解器偏好必须是整数：$0$ 表示显式，$1$ 表示隐式。\n\n测试套件和参数：\n使用 $\\varepsilon = 10^{-12}$ 进行缩放。对于每个案例，使用给定的 $\\mathbf{y}$、$\\mathbf{J}$（单位 $s^{-1}$）、$s_{\\mathrm{exp}}$、$\\beta$ 和 $\\beta_{\\mathrm{imp}}$ 进行计算：\n- 案例1（刚性，对角占优）：\n    - $\\mathbf{y} = (10^{-4}, 10^{-2}, 5\\times 10^{-1})$\n    - $\\mathbf{J} = \\begin{bmatrix} -1000  0  0 \\\\ 0  -10  0 \\\\ 0  0  -0.1 \\end{bmatrix}$\n    - $s_{\\mathrm{exp}} = 0.9$, $\\beta = 0.2$, $\\beta_{\\mathrm{imp}} = 2.0$\n- 案例2（非刚性，弱耦合）：\n    - $\\mathbf{y} = (10^{-3}, 2\\times 10^{-3}, 3\\times 10^{-3})$\n    - $\\mathbf{J} = \\begin{bmatrix} -1.0  0.2  0.0 \\\\ 0.0  -0.8  0.0 \\\\ 0.0  0.0  -0.5 \\end{bmatrix}$\n    - $s_{\\mathrm{exp}} = 0.9$, $\\beta = 0.5$, $\\beta_{\\mathrm{imp}} = 2.0$\n- 案例3（非正规，强上三角耦合）：\n    - $\\mathbf{y} = (10^{-6}, 10^{-6}, 10^{-1})$\n    - $\\mathbf{J} = \\begin{bmatrix} -2.0  10^{2}  0.0 \\\\ 0.0  -2.0  10^{2} \\\\ 0.0  0.0  -0.5 \\end{bmatrix}$\n    - $s_{\\mathrm{exp}} = 0.9$, $\\beta = 0.2$, $\\beta_{\\mathrm{imp}} = 1.0$\n- 案例4（存在不稳定模态）：\n    - $\\mathbf{y} = (10^{-1}, 2\\times 10^{-1}, 3\\times 10^{-1})$\n    - $\\mathbf{J} = \\begin{bmatrix} 0.01  0  0 \\\\ 0  -5.0  0 \\\\ 0  0  -50.0 \\end{bmatrix}$\n    - $s_{\\mathrm{exp}} = 0.9$, $\\beta = 0.1$, $\\beta_{\\mathrm{imp}} = 0.5$\n\n您的程序必须为每个案例生成一个列表 $[R, D, h_{\\mathrm{FE},\\max}, \\text{solver\\_choice}, h_{\\mathrm{rec}}]$，其中 $R$ 和 $D$ 是浮点数，$h_{\\mathrm{FE},\\max}$ 和 $h_{\\mathrm{rec}}$ 是以秒为单位的浮点数，而 $\\text{solver\\_choice}$ 是 $0$ 或 $1$。最终输出格式必须是单行，包含一个由方括号括起来的、按案例排列的列表的逗号分隔列表，且不含空格，例如：$[[r_1,d_1,h_1,s_1,h_1'],[r_2,d_2,h_2,s_2,h_2'],[r_3,d_3,h_3,s_3,h_3'],[r_4,d_4,h_4,s_4,h_4']]$，其中每个 $r_i$、$d_i$、$h_i$、$s_i$ 和 $h_i'$ 是为案例 $i$ 计算的值。",
            "solution": "所提出的问题是有效的，因为它在科学上基于常微分方程（ODE）数值分析的原理，特别是在化学动力学刚性问题的背景下。该问题是适定的，为获得唯一解提供了所有必要的定义、常数和数据。语言客观，要求可形式化。\n\n任务是分析由雅可比矩阵表示的化学动力学系统的局部动力学，以确定其刚性和稳定性特征。基于此分析，在显式和隐式数值积分方法之间做出决策，并计算推荐的时间步长。这个过程在计算科学中是基础性的，尤其在像燃烧这样的领域，其中系统经常表现出大范围的时间尺度。\n\n对于每个测试案例，总体流程包括以下步骤：\n\n1.  **缩放雅可比矩阵**：状态变量 $\\mathbf{y}$ 的量级可能差异巨大。为确保雅可比矩阵的特征值能以可比较的方式反映系统的特征时间尺度，我们使用缩放变量。问题定义了一个对角缩放矩阵 $\\mathbf{D} = \\mathrm{diag}(w_1,\\dots,w_n)$，其中 $w_i = \\max(|y_i|,\\varepsilon)$。缩放后的雅可比矩阵 $\\mathbf{J}_s$ 由相似性变换 $\\mathbf{J}_s = \\mathbf{D}^{-1}\\mathbf{J}\\mathbf{D}$ 给出。$\\mathbf{J}_s$ 的第 $(i,j)$ 个元素与原始雅可比矩阵元素的关系为 $(\\mathbf{J}_s)_{ij} = J_{ij} \\frac{w_j}{w_i}$。$\\mathbf{J}_s$ 的特征值决定了缩放系统的动力学。\n\n2.  **特征值计算**：系统 $d\\mathbf{y}/dt = \\mathbf{J}_s \\mathbf{y}$ 的局部行为由 $\\mathbf{J}_s$ 的特征值 $\\lambda_i$ 决定。每个特征值对应一个系统模态，其行为如 $e^{\\lambda_i t}$。实部 $\\mathrm{Re}(\\lambda_i)$ 决定了模态的增长或衰减，而虚部 $\\mathrm{Im}(\\lambda_i)$ 则决定了其振荡频率。\n    - 如果 $\\mathrm{Re}(\\lambda_i)  0$，模态以特征时间尺度 $\\tau_i = 1 / (-\\mathrm{Re}(\\lambda_i))$ 衰减。\n    - 如果 $\\mathrm{Re}(\\lambda_i)  0$，模态不稳定并以特征时间尺度 $\\tau_{\\mathrm{grow}, i} = 1 / \\mathrm{Re}(\\lambda_i)$ 增长。\n    - 如果 $\\mathrm{Re}(\\lambda_i) = 0$，模态是振荡的且中性稳定。\n\n3.  **刚性、稳定性和非正规性指标的计算**：\n    - **时间尺度和刚性比 ($R$)**：我们识别所有衰减模态（那些 $\\mathrm{Re}(\\lambda_i)  0$ 的模态）及其相关的时间尺度 $\\tau_i$。找到这些时间尺度的最小值和最大值，即 $\\tau_{\\min}$ 和 $\\tau_{\\max}$。刚性比 $R = \\tau_{\\max}/\\tau_{\\min}$ 量化了时间尺度的分离。大的 $R$ 表示一个刚性系统，其中一些模态比其他模态衰减得快得多。这对显式求解器构成了挑战，因为即使使用者只对解析最慢的（最大的 $\\tau_i$）动力学感兴趣，其步长也受到最快的（最小的 $\\tau_i$）时间尺度的限制。如果没有衰减模态，我们设 $\\tau_{\\min} = \\tau_{\\max} = +\\infty$，并按约定设 $R=+\\infty$。\n    - **最大稳定前向欧拉步长 ($h_{\\mathrm{FE},\\max}$)**：对于像前向欧拉这样的显式方法，时间步长 $h$ 受到稳定性的约束。对于每个具有特征值 $\\lambda_i$ 的模态，必须满足稳定性条件 $|1+h\\lambda_i|  1$。对于衰减模态（$\\mathrm{Re}(\\lambda_i)  0$），这对 $h$ 施加了一个上限，由 $h  -2\\mathrm{Re}(\\lambda_i)/|\\lambda_i|^2$ 给出。总步长受这些条件中最严格的一个限制，因此 $h_{\\mathrm{FE},\\max} = \\min_{i:\\mathrm{Re}(\\lambda_i)  0} \\left( -2\\mathrm{Re}(\\lambda_i)/|\\lambda_i|^2 \\right)$。如果没有衰减模态，显式方法在这方面不受稳定性约束，但不稳定模态的存在使其不适用。问题在这种情况下定义 $h_{\\mathrm{FE},\\max} = 0$。\n    - **非正规性度量 ($D$)**：如果雅可比矩阵 $\\mathbf{J}_s$ 是非正规的（即，它不与其共轭转置交换，$\\mathbf{J}_s \\mathbf{J}_s^* \\neq \\mathbf{J}_s^* \\mathbf{J}_s$），则仅靠特征值不能完全描述短期动力学。即使所有特征值的实部为负，非正规矩阵也可能表现出瞬态增长。这可能会误导仅基于特征值的稳定性分析。度量 $D = \\|\\mathbf{J}_s \\mathbf{J}_s^{*} - \\mathbf{J}_s^{*} \\mathbf{J}_s\\|_F / \\|\\mathbf{J}_s\\|_F^2$ 量化了这种对正规性的偏离。大的 $D$ 表明瞬态效应可能很显著，需要谨慎使用隐式方法。\n\n4.  **求解器选择逻辑**：基于计算出的指标和给定的阈值（$R_{\\mathrm{th}} = 100$，$D_{\\mathrm{th}} = 0.3$，$h_{\\min,\\mathrm{th}} = 10^{-4}$），选择一个求解器。\n    - 在以下情况下，首选隐式方法（选择 $1$）：\n        1.  系统局部不稳定（任何 $\\mathrm{Re}(\\lambda_i)  0$），因为隐式方法具有更好的稳定性。\n        2.  系统是刚性的（$R  R_{\\mathrm{th}}$）。\n        3.  系统是显著非正规的（$D  D_{\\mathrm{th}}$）。\n        4.  显式稳定性限制过小（$h_{\\mathrm{FE},\\max}  h_{\\min,\\mathrm{th}}$）。\n    - 否则，认为显式方法（选择 $0$）是可接受的。\n\n5.  **推荐步长 ($h_{\\mathrm{rec}}$)**：推荐的步长取决于所选的求解器。\n    - **显式**：步长必须遵守稳定性限制。一个安全因子 $s_{\\mathrm{exp}}$ 被应用于 $h_{\\mathrm{FE},\\max}$。步长还必须足够小，以精确解析最快的动力学，这通过一个分辨率因子 $\\beta$ 与 $\\tau_{\\min}$ 相关联。因此，$h_{\\mathrm{rec}} = \\min(s_{\\mathrm{exp}}\\,h_{\\mathrm{FE},\\max}, \\beta\\,\\tau_{\\min})$。\n    - **隐式**：隐式方法通常是A稳定的（或L稳定的），这意味着它们的稳定性不受快速衰减模态的限制。步长反而是为了精确解析感兴趣的动力学而选择的。\n        - 如果系统不稳定，步长应足够小以解析最快的增长模态：$h_{\\mathrm{rec}} = \\beta_{\\mathrm{imp}}\\,\\tau_{\\mathrm{grow}}$，其中 $\\tau_{\\mathrm{grow}} = 1/\\max_{i:\\mathrm{Re}(\\lambda_i)0}\\mathrm{Re}(\\lambda_i)$。\n        - 如果系统稳定，可以选择步长来解析最慢的衰减模态（长期行为）：$h_{\\mathrm{rec}} = \\beta_{\\mathrm{imp}}\\,\\tau_{\\max}$。\n\n现在将把这一系列计算应用于所提供的四个测试案例中的每一个。",
            "answer": "[[10000.000000,0.000000,0.002000,1.000000,20.000000],[2.000000,0.123438,2.000000,0.000000,0.500000],[4.000000,0.000000,1.000000,0.000000,0.100000],[10.000000,0.000000,0.040000,1.000000,50.000000]]"
        }
    ]
}