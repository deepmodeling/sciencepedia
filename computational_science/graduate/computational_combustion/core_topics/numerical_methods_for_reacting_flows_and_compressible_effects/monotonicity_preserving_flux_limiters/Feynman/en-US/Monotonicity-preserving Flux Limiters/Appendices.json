{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational understanding of how different flux limiters behave in practice. By applying several common limiters—minmod, Monotonized Central (MC), and van Leer—to a smooth, known function, we can directly observe their response to varying gradients and local extrema. This practice is crucial for developing an intuition for how these mathematical constructs translate into numerical accuracy and stability in simulations .",
            "id": "4042834",
            "problem": "Consider the one-dimensional linear advection of a passive scalar representative of a mixture fraction in a premixed flame, modeled by the scalar conservation law $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$. On a uniform grid with spacing $\\Delta x$ and nodes $x_{i} = i\\,\\Delta x$, a high-resolution Monotonic Upwind Scheme for Conservation Laws (MUSCL) reconstruction is used with a monotonicity-preserving Total Variation Diminishing (TVD) limiter. Define the discrete slope ratio\n$$\nr_{i} = \\frac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}},\n$$\nand the flux-limiter functions $\\phi(r)$ for three widely used limiters:\n- the minmod limiter $\\phi_{\\mathrm{mm}}(r) = \\max\\!\\big(0, \\min(1, r)\\big)$,\n- the Monotonized Central (MC) limiter $\\phi_{\\mathrm{MC}}(r) = \\max\\!\\big(0, \\min\\!\\big(\\tfrac{1+r}{2},\\, 2,\\, 2r\\big)\\big)$,\n- the van Leer limiter $\\phi_{\\mathrm{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$.\n\nAssume a smooth profile $u(x) = \\sin(x)$ sampled on the coarse grid $x_{i} = i\\,\\Delta x$ over the interval $[0, \\pi]$ in radians, with $\\Delta x = \\pi/6$. For the grid indices $i = 1$, $i = 3$, and $i = 5$, do the following:\n1. Compute $r_{i}$ and evaluate $\\phi_{\\mathrm{mm}}(r_{i})$, $\\phi_{\\mathrm{MC}}(r_{i})$, and $\\phi_{\\mathrm{VL}}(r_{i})$ exactly.\n2. Using a Taylor-series-based consistency argument for the MUSCL reconstruction with a positive advection speed $a$, estimate the local truncation error order $p_{i}$ at each of the three points.\n\nProvide the final results for the ordered tuple\n$$\n\\big(r_{1},\\, \\phi_{\\mathrm{mm}}(r_{1}),\\, \\phi_{\\mathrm{MC}}(r_{1}),\\, \\phi_{\\mathrm{VL}}(r_{1}),\\, p_{1},\\, r_{3},\\, \\phi_{\\mathrm{mm}}(r_{3}),\\, \\phi_{\\mathrm{MC}}(r_{3}),\\, \\phi_{\\mathrm{VL}}(r_{3}),\\, p_{3},\\, r_{5},\\, \\phi_{\\mathrm{mm}}(r_{5}),\\, \\phi_{\\mathrm{MC}}(r_{5}),\\, \\phi_{\\mathrm{VL}}(r_{5}),\\, p_{5}\\big).\n$$\nNo rounding is required; report exact analytical values. Angles are in radians, and all quantities are dimensionless.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the analysis of numerical methods for hyperbolic conservation laws, specifically focusing on the behavior of monotonicity-preserving flux limiters. All provided definitions, equations, and data are standard in the field of computational fluid dynamics and are free of contradiction or ambiguity. Therefore, the problem is valid, and a solution can be constructed.\n\nThe solution requires two main tasks: first, to compute the slope ratios $r_i$ and the corresponding limiter values $\\phi(r_i)$ at specified grid points; second, to determine the local order of accuracy $p_i$ at these points.\n\nFirst, we establish the discrete values of the function $u(x) = \\sin(x)$ on the uniform grid $x_i = i\\,\\Delta x$ with $\\Delta x = \\pi/6$. The required values for computing the slope ratios at $i \\in \\{1, 3, 5\\}$ are $u_0, u_1, u_2, u_3, u_4, u_5$, and $u_6$.\n$u_0 = \\sin(0 \\cdot \\pi/6) = \\sin(0) = 0$\n$u_1 = \\sin(1 \\cdot \\pi/6) = \\sin(\\pi/6) = 1/2$\n$u_2 = \\sin(2 \\cdot \\pi/6) = \\sin(\\pi/3) = \\sqrt{3}/2$\n$u_3 = \\sin(3 \\cdot \\pi/6) = \\sin(\\pi/2) = 1$\n$u_4 = \\sin(4 \\cdot \\pi/6) = \\sin(2\\pi/3) = \\sqrt{3}/2$\n$u_5 = \\sin(5 \\cdot \\pi/6) = \\sin(5\\pi/6) = 1/2$\n$u_6 = \\sin(6 \\cdot \\pi/6) = \\sin(\\pi) = 0$\n\nNow, we compute the required quantities for each index $i$.\n\n**Analysis for Grid Index $i=1$**\n\nThe slope ratio $r_1$ is defined as:\n$$\nr_1 = \\frac{u_1 - u_0}{u_2 - u_1} = \\frac{1/2 - 0}{\\sqrt{3}/2 - 1/2} = \\frac{1/2}{(\\sqrt{3}-1)/2} = \\frac{1}{\\sqrt{3}-1}\n$$\nRationalizing the denominator gives:\n$$\nr_1 = \\frac{1}{\\sqrt{3}-1} \\cdot \\frac{\\sqrt{3}+1}{\\sqrt{3}+1} = \\frac{\\sqrt{3}+1}{3-1} = \\frac{\\sqrt{3}+1}{2}\n$$\nSince $\\sqrt{3} \\approx 1.732$, $r_1 \\approx (1.732+1)/2 = 1.366$.\n\nNow we evaluate the flux limiters for $r_1$:\n1.  Minmod limiter: $\\phi_{\\mathrm{mm}}(r) = \\max(0, \\min(1, r))$.\n    Since $r_1 = \\frac{\\sqrt{3}+1}{2} > 1$, we have $\\min(1, r_1) = 1$.\n    $$\n    \\phi_{\\mathrm{mm}}(r_1) = \\max(0, 1) = 1\n    $$\n2.  Monotonized Central (MC) limiter: $\\phi_{\\mathrm{MC}}(r) = \\max(0, \\min(\\frac{1+r}{2}, 2, 2r))$.\n    We compute the arguments of the $\\min$ function:\n    $\\frac{1+r_1}{2} = \\frac{1 + (\\sqrt{3}+1)/2}{2} = \\frac{(2+\\sqrt{3}+1)/2}{2} = \\frac{3+\\sqrt{3}}{4}$.\n    $2r_1 = 2 \\cdot \\frac{\\sqrt{3}+1}{2} = \\sqrt{3}+1$.\n    We must compare $\\frac{3+\\sqrt{3}}{4}$, $2$, and $\\sqrt{3}+1$. Since $\\sqrt{3} \\approx 1.732$, $\\frac{3+\\sqrt{3}}{4} \\approx 1.183$, and $\\sqrt{3}+1 \\approx 2.732$.\n    Thus, $\\min(\\frac{3+\\sqrt{3}}{4}, 2, \\sqrt{3}+1) = \\frac{3+\\sqrt{3}}{4}$.\n    $$\n    \\phi_{\\mathrm{MC}}(r_1) = \\max\\left(0, \\frac{3+\\sqrt{3}}{4}\\right) = \\frac{3+\\sqrt{3}}{4}\n    $$\n3.  van Leer limiter: $\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$.\n    Since $r_1 > 0$, this simplifies to $\\phi_{\\mathrm{VL}}(r_1) = \\frac{2r_1}{1+r_1}$.\n    $$\n    \\phi_{\\mathrm{VL}}(r_1) = \\frac{2 \\cdot \\frac{\\sqrt{3}+1}{2}}{1 + \\frac{\\sqrt{3}+1}{2}} = \\frac{\\sqrt{3}+1}{(2+\\sqrt{3}+1)/2} = \\frac{2(\\sqrt{3}+1)}{3+\\sqrt{3}}\n    $$\n    Rationalizing the denominator:\n    $$\n    \\phi_{\\mathrm{VL}}(r_1) = \\frac{2(\\sqrt{3}+1)(3-\\sqrt{3})}{(3+\\sqrt{3})(3-\\sqrt{3})} = \\frac{2(3\\sqrt{3}-3+3-\\sqrt{3})}{9-3} = \\frac{2(2\\sqrt{3})}{6} = \\frac{2\\sqrt{3}}{3}\n    $$\n\n**Analysis for Grid Index $i=3$**\n\nThe slope ratio $r_3$ is:\n$$\nr_3 = \\frac{u_3 - u_2}{u_4 - u_3} = \\frac{1 - \\sqrt{3}/2}{\\sqrt{3}/2 - 1} = \\frac{-( \\sqrt{3}/2 - 1)}{\\sqrt{3}/2 - 1} = -1\n$$\nNow we evaluate the flux limiters for $r_3 = -1$:\n1.  Minmod limiter: $\\phi_{\\mathrm{mm}}(-1) = \\max(0, \\min(1, -1)) = \\max(0, -1) = 0$.\n2.  MC limiter: $\\phi_{\\mathrm{MC}}(-1) = \\max(0, \\min(\\frac{1+(-1)}{2}, 2, 2(-1))) = \\max(0, \\min(0, 2, -2)) = \\max(0, -2) = 0$.\n3.  van Leer limiter: $\\phi_{\\mathrm{VL}}(-1) = \\frac{-1 + |-1|}{1 + |-1|} = \\frac{-1+1}{1+1} = \\frac{0}{2} = 0$.\n$$\n\\phi_{\\mathrm{mm}}(r_3) = 0, \\quad \\phi_{\\mathrm{MC}}(r_3) = 0, \\quad \\phi_{\\mathrm{VL}}(r_3) = 0\n$$\n\n**Analysis for Grid Index $i=5$**\n\nThe slope ratio $r_5$ is:\n$$\nr_5 = \\frac{u_5 - u_4}{u_6 - u_5} = \\frac{1/2 - \\sqrt{3}/2}{0 - 1/2} = \\frac{(1-\\sqrt{3})/2}{-1/2} = \\sqrt{3}-1\n$$\nSince $\\sqrt{3} \\approx 1.732$, $r_5 \\approx 0.732$.\n\nNow we evaluate the flux limiters for $r_5$:\n1.  Minmod limiter: $\\phi_{\\mathrm{mm}}(r) = \\max(0, \\min(1, r))$.\n    Since $0 < r_5 < 1$, we have $\\min(1, r_5) = r_5 = \\sqrt{3}-1$.\n    $$\n    \\phi_{\\mathrm{mm}}(r_5) = \\max(0, \\sqrt{3}-1) = \\sqrt{3}-1\n    $$\n2.  MC limiter: $\\phi_{\\mathrm{MC}}(r) = \\max(0, \\min(\\frac{1+r}{2}, 2, 2r))$.\n    We compute the arguments of the $\\min$ function:\n    $\\frac{1+r_5}{2} = \\frac{1 + (\\sqrt{3}-1)}{2} = \\frac{\\sqrt{3}}{2}$.\n    $2r_5 = 2(\\sqrt{3}-1) = 2\\sqrt{3}-2$.\n    We must compare $\\frac{\\sqrt{3}}{2}$, $2$, and $2\\sqrt{3}-2$. Since $\\sqrt{3} \\approx 1.732$, $\\frac{\\sqrt{3}}{2} \\approx 0.866$, and $2\\sqrt{3}-2 \\approx 1.464$.\n    Thus, $\\min(\\frac{\\sqrt{3}}{2}, 2, 2\\sqrt{3}-2) = \\frac{\\sqrt{3}}{2}$.\n    $$\n    \\phi_{\\mathrm{MC}}(r_5) = \\max\\left(0, \\frac{\\sqrt{3}}{2}\\right) = \\frac{\\sqrt{3}}{2}\n    $$\n3.  van Leer limiter: $\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$.\n    Since $r_5 > 0$, this simplifies to $\\phi_{\\mathrm{VL}}(r_5) = \\frac{2r_5}{1+r_5}$.\n    $$\n    \\phi_{\\mathrm{VL}}(r_5) = \\frac{2(\\sqrt{3}-1)}{1 + (\\sqrt{3}-1)} = \\frac{2(\\sqrt{3}-1)}{\\sqrt{3}}\n    $$\n    Rationalizing the denominator:\n    $$\n    \\phi_{\\mathrm{VL}}(r_5) = \\frac{2(\\sqrt{3}-1)\\sqrt{3}}{\\sqrt{3}\\sqrt{3}} = \\frac{2(3-\\sqrt{3})}{3}\n    $$\n\n**Estimation of Local Truncation Error Order $p_i$**\n\nThe local order of accuracy $p_i$ of a MUSCL-type scheme depends on the local behavior of the solution. These schemes are designed to be high-resolution, which means they are second-order accurate ($p=2$) in smooth regions of the solution but revert to first-order accuracy ($p=1$) at local extrema to prevent the formation of spurious oscillations, thereby preserving monotonicity.\n\nThe character of the solution at a grid point $x_i$ can be determined by the first derivative of the continuous function, $u'(x_i)$. If $u'(x_i) \\neq 0$, the point is in a smooth, monotonic region. If $u'(x_i)=0$, the point is a local extremum.\n\nThe function is $u(x) = \\sin(x)$, so its derivative is $u'(x) = \\cos(x)$. We evaluate this at the points of interest:\n-   At $i=1$, $x_1 = \\pi/6$. $u'(x_1) = \\cos(\\pi/6) = \\sqrt{3}/2 \\neq 0$. This point is in a smooth region. Thus, the local truncation error is of second order.\n    $$\n    p_1 = 2\n    $$\n-   At $i=3$, $x_3 = 3\\pi/6 = \\pi/2$. $u'(x_3) = \\cos(\\pi/2) = 0$. This point corresponds to a local maximum of the function. To avoid oscillations, the limiter will enforce a locally first-order reconstruction. The calculated value $r_3 = -1$ and the resulting zero values for all limiters confirm this behavior (the scheme locally reverts to first-order upwind).\n    $$\n    p_3 = 1\n    $$\n-   At $i=5$, $x_5 = 5\\pi/6$. $u'(x_5) = \\cos(5\\pi/6) = -\\sqrt{3}/2 \\neq 0$. This point is also in a smooth region. Thus, the local truncation error is of second order.\n    $$\n    p_5 = 2\n    $$\n\nCombining all results into the specified ordered tuple gives:\n$\\big(r_{1},\\, \\phi_{\\mathrm{mm}}(r_{1}),\\, \\phi_{\\mathrm{MC}}(r_{1}),\\, \\phi_{\\mathrm{VL}}(r_{1}),\\, p_{1},\\, r_{3},\\, \\phi_{\\mathrm{mm}}(r_{3}),\\, \\phi_{\\mathrm{MC}}(r_{3}),\\, \\phi_{\\mathrm{VL}}(r_{3}),\\, p_{3},\\, r_{5},\\, \\phi_{\\mathrm{mm}}(r_{5}),\\, \\phi_{\\mathrm{MC}}(r_{5}),\\, \\phi_{\\mathrm{VL}}(r_{5}),\\, p_{5}\\big)$\n$= \\big(\\frac{\\sqrt{3}+1}{2}, 1, \\frac{3+\\sqrt{3}}{4}, \\frac{2\\sqrt{3}}{3}, 2, -1, 0, 0, 0, 1, \\sqrt{3}-1, \\sqrt{3}-1, \\frac{\\sqrt{3}}{2}, \\frac{2(3-\\sqrt{3})}{3}, 2\\big)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sqrt{3}+1}{2} & 1 & \\frac{3+\\sqrt{3}}{4} & \\frac{2\\sqrt{3}}{3} & 2 & -1 & 0 & 0 & 0 & 1 & \\sqrt{3}-1 & \\sqrt{3}-1 & \\frac{\\sqrt{3}}{2} & \\frac{2(3-\\sqrt{3})}{3} & 2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While smooth profiles are useful for analysis, the true test of a high-resolution scheme is its performance at sharp discontinuities, such as flame fronts or shock waves. This problem examines the behavior of limiters at a step-like feature, a scenario where lower-order schemes produce excessive smearing and unlimited high-order schemes produce unphysical oscillations. By calculating the update at the \"shoulder\" of a step, you will see how limiters act to preserve monotonicity precisely where it is most needed .",
            "id": "4042861",
            "problem": "Consider the one-dimensional linear advection of a bounded scalar field relevant to computational combustion, such as a reaction progress variable, governed by the conservation law $u_t + a\\,u_x = 0$ with $a>0$. Use a finite volume update over uniform cells of width $\\Delta x$ with cell averages $u_i^n$ at time $t^n$:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right),\n$$\nwhere the Courant–Friedrichs–Lewy (CFL) number is $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$. For $a>0$, employ a monotonicity-preserving Total Variation Diminishing (TVD) flux constructed by Godunov upwinding with piecewise linear reconstruction inside each cell:\n$$\nF_{i+\\frac{1}{2}}^n = a\\,u_{i+\\frac{1}{2}}^{-}, \\quad u_{i+\\frac{1}{2}}^{-} = u_i^n + \\frac{1}{2}s_i^n,\n$$\nwhere the limited slope $s_i^n$ is defined by\n$$\ns_i^n = \\phi(r_i^n)\\,\\Delta_{i+\\frac{1}{2}}^n,\\quad \\Delta_{i+\\frac{1}{2}}^n = u_{i+1}^n - u_i^n,\\quad r_i^n = \\frac{\\Delta_{i-\\frac{1}{2}}^n}{\\Delta_{i+\\frac{1}{2}}^n},\\quad \\Delta_{i-\\frac{1}{2}}^n = u_i^n - u_{i-1}^n.\n$$\nAdopt the limiter function $\\phi(r)$ as either the minmod limiter\n$$\n\\phi_{\\mathrm{minmod}}(r) = \\max\\!\\left(0,\\ \\min(1,\\ r)\\right),\n$$\nor the superbee limiter\n$$\n\\phi_{\\mathrm{superbee}}(r) = \\max\\!\\left(0,\\ \\min(2r,\\,1),\\ \\min(r,\\,2)\\right).\n$$\nAssume a right-moving unit step consistent with a combustion front at time $t^n$ localized around cell $i$, with\n$$\nu_{i-1}^n = 1,\\quad u_i^n = 1,\\quad u_{i+1}^n = 0,\n$$\nand further that the upstream state is uniform so that $u_{j}^n = 1$ for all $j \\leq i$ and $u_{j}^n = 0$ for all $j \\geq i+1$. Take $\\lambda = 0.5$. \n\nTasks:\n1. Compute the ratio $r_i^n$ at cell $i$.\n2. Compute the limited slope $s_i^n$ for the minmod and superbee limiters.\n3. Using the limited reconstruction, update $u_i$ by one time step to $u_i^{n+1}$ for each limiter.\n4. Assess monotonicity with respect to the immediate neighbors by determining whether $u_i^{n+1}$ lies within the interval $\\left[\\min(u_{i-1}^n,\\,u_{i+1}^n),\\ \\max(u_{i-1}^n,\\,u_{i+1}^n)\\right]$ for each limiter.\n\nExpress your final answer as a row matrix containing, in order, the values of $r_i^n$, $s_i^n$ with the minmod limiter, $s_i^n$ with the superbee limiter, $u_i^{n+1}$ with the minmod limiter, and $u_i^{n+1}$ with the superbee limiter. No rounding is required and no physical units are attached to these dimensionless quantities.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard exercise in the numerical solution of hyperbolic conservation laws using high-resolution finite volume methods, a core topic in computational science and engineering. All necessary definitions, equations, and data are provided.\n\nThe solution proceeds by addressing the four tasks in sequence.\n\nThe initial state of the scalar field at time $t^n$ around cell $i$ is given by:\n$u_{i-1}^n = 1$\n$u_i^n = 1$\n$u_{i+1}^n = 0$\nThe problem also states that $u_j^n = 1$ for all $j \\leq i$ and $u_j^n = 0$ for all $j \\geq i+1$. The Courant number is $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x} = 0.5$.\n\n**Task 1: Compute the ratio $r_i^n$ at cell $i$.**\n\nThe ratio $r_i^n$ is defined as $r_i^n = \\frac{\\Delta_{i-\\frac{1}{2}}^n}{\\Delta_{i+\\frac{1}{2}}^n}$. We first compute the successive differences, $\\Delta_{i-\\frac{1}{2}}^n$ and $\\Delta_{i+\\frac{1}{2}}^n$.\n\n$\\Delta_{i-\\frac{1}{2}}^n = u_i^n - u_{i-1}^n = 1 - 1 = 0$.\n$\\Delta_{i+\\frac{1}{2}}^n = u_{i+1}^n - u_i^n = 0 - 1 = -1$.\n\nNow, we can compute the ratio $r_i^n$:\n$$\nr_i^n = \\frac{\\Delta_{i-\\frac{1}{2}}^n}{\\Delta_{i+\\frac{1}{2}}^n} = \\frac{0}{-1} = 0.\n$$\n\n**Task 2: Compute the limited slope $s_i^n$ for the minmod and superbee limiters.**\n\nThe limited slope is given by $s_i^n = \\phi(r_i^n)\\,\\Delta_{i+\\frac{1}{2}}^n$. We use the value $r_i^n=0$ and $\\Delta_{i+\\frac{1}{2}}^n = -1$ computed above.\n\nFor the minmod limiter:\n$\\phi_{\\mathrm{minmod}}(r_i^n) = \\phi_{\\mathrm{minmod}}(0) = \\max\\!\\left(0,\\ \\min(1,\\ 0)\\right) = \\max(0, 0) = 0$.\nTherefore, the limited slope is:\n$$\ns_i^n (\\text{minmod}) = \\phi_{\\mathrm{minmod}}(0) \\cdot \\Delta_{i+\\frac{1}{2}}^n = 0 \\cdot (-1) = 0.\n$$\n\nFor the superbee limiter:\n$\\phi_{\\mathrm{superbee}}(r_i^n) = \\phi_{\\mathrm{superbee}}(0) = \\max\\!\\left(0,\\ \\min(2 \\cdot 0,\\,1),\\ \\min(0,\\,2)\\right) = \\max(0,\\ \\min(0,1),\\ \\min(0,2)) = \\max(0,0,0) = 0$.\nTherefore, the limited slope is:\n$$\ns_i^n (\\text{superbee}) = \\phi_{\\mathrm{superbee}}(0) \\cdot \\Delta_{i+\\frac{1}{2}}^n = 0 \\cdot (-1) = 0.\n$$\nIn this specific case, both limiters produce a zero slope at cell $i$.\n\n**Task 3: Update $u_i$ to $u_i^{n+1}$ for each limiter.**\n\nThe finite volume update formula is:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right).\n$$\nThe numerical fluxes are given by $F_{j+\\frac{1}{2}}^n = a \\, u_{j+\\frac{1}{2}}^{-}$, where $u_{j+\\frac{1}{2}}^{-} = u_j^n + \\frac{1}{2}s_j^n$.\nSubstituting the flux definition into the update formula and using $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$:\n$$\nu_i^{n+1} = u_i^n - \\frac{a\\,\\Delta t}{a\\,\\Delta x}\\left(a\\,u_{i+\\frac{1}{2}}^{-} - a\\,u_{i-\\frac{1}{2}}^{-}\\right) = u_i^n - \\lambda\\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right).\n$$\nWe need to compute the reconstructed values at the cell interfaces $u_{i+\\frac{1}{2}}^{-}$ and $u_{i-\\frac{1}{2}}^{-}$.\n\nFor the interface $i+\\frac{1}{2}$:\n$u_{i+\\frac{1}{2}}^{-} = u_i^n + \\frac{1}{2}s_i^n$.\nSince we found $s_i^n = 0$ for both limiters, this value is the same for both:\n$$\nu_{i+\\frac{1}{2}}^{-} = 1 + \\frac{1}{2}(0) = 1.\n$$\n\nFor the interface $i-\\frac{1}{2}$:\n$u_{i-\\frac{1}{2}}^{-} = u_{i-1}^n + \\frac{1}{2}s_{i-1}^n$.\nWe must compute the limited slope at cell $i-1$, which is $s_{i-1}^n = \\phi(r_{i-1}^n)\\,\\Delta_{i-\\frac{1}{2}}^n$.\nWe have already calculated $\\Delta_{i-\\frac{1}{2}}^n = u_i^n - u_{i-1}^n = 0$.\nTherefore, regardless of the value of the limiter function $\\phi(r_{i-1}^n)$:\n$$\ns_{i-1}^n = \\phi(r_{i-1}^n) \\cdot 0 = 0.\n$$\nThis holds for both minmod and superbee limiters.\nNow we compute the reconstructed value at the interface $i-\\frac{1}{2}$:\n$$\nu_{i-\\frac{1}{2}}^{-} = u_{i-1}^n + \\frac{1}{2}s_{i-1}^n = 1 + \\frac{1}{2}(0) = 1.\n$$\n\nFinally, we update the cell average $u_i^n$:\n$$\nu_i^{n+1} = u_i^n - \\lambda\\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right) = 1 - 0.5 \\cdot (1 - 1) = 1 - 0.5 \\cdot 0 = 1.\n$$\nThis result is identical for both the minmod and superbee limiters. Thus, $u_i^{n+1}(\\text{minmod}) = 1$ and $u_i^{n+1}(\\text{superbee}) = 1$.\n\n**Task 4: Assess monotonicity.**\n\nWe must check if the updated value $u_i^{n+1}$ lies within the range defined by its neighbors at time $t^n$. The condition is $u_i^{n+1} \\in \\left[\\min(u_{i-1}^n,\\,u_{i+1}^n),\\ \\max(u_{i-1}^n,\\,u_{i+1}^n)\\right]$.\nThe neighboring values are $u_{i-1}^n=1$ and $u_{i+1}^n=0$.\nThe interval is $\\left[\\min(1, 0),\\ \\max(1, 0)\\right] = [0, 1]$.\nThe updated value for both limiters is $u_i^{n+1} = 1$.\nSince $1$ is within the closed interval $[0, 1]$, the local monotonicity condition is satisfied for both schemes.\n\nThe final results for the five requested quantities are:\n1. $r_i^n = 0$\n2. $s_i^n$ (minmod) = $0$\n3. $s_i^n$ (superbee) = $0$\n4. $u_i^{n+1}$ (minmod) = $1$\n5. $u_i^{n+1}$ (superbee) = $1$\nThese are collected into a row matrix for the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & 1 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving beyond simple slope limiting, Flux-Corrected Transport (FCT) offers a more formal framework for guaranteeing that a numerical update will not create new, unphysical extrema. This hands-on problem walks you through a complete FCT cycle, from calculating low- and high-order fluxes to applying the Zalesak limiter to the antidiffusive fluxes. Completing this exercise will demystify the FCT algorithm and demonstrate a powerful technique for enforcing physical bounds in complex simulations .",
            "id": "4042837",
            "problem": "Consider a one-dimensional finite-volume discretization of the linear advection of a species mass fraction in a reacting flow, representative of computational combustion. The species mass fraction $Y(x,t)$ satisfies the conservation law $\\partial Y / \\partial t + u \\, \\partial Y / \\partial x = 0$ with a constant advective velocity $u>0$. Let the grid be uniform with cell width $\\Delta x$ and cell indices $i=1, 2, 3$ for the interior cells. You are to implement by hand one step of Flux-Corrected Transport (FCT), defined here as a convex combination of a low-order monotone scheme and a high-order scheme with antidiffusive fluxes limited to preserve monotonicity.\n\nUse the following scientifically consistent setup:\n- Advective velocity $u = 1.0 \\,\\mathrm{m/s}$, grid spacing $\\Delta x = 1.0 \\times 10^{-2} \\,\\mathrm{m}$, and time step $\\Delta t = 6.0 \\times 10^{-3} \\,\\mathrm{s}$ so that the Courant–Friedrichs–Lewy (CFL) number is $\\nu = u \\Delta t/\\Delta x = 0.6$.\n- Initial cell-averaged mass fractions (dimensionless): $Y_1^n = 0.2$, $Y_2^n = 0.8$, $Y_3^n = 0.4$.\n- Boundary treatment: at the left inflow boundary, prescribe a ghost-cell value $Y_0^n = 0.2$; at the right outflow boundary, take $Y_4^n = Y_3^n$ (zero-gradient outflow). Set antidiffusive fluxes at the domain boundaries to zero, i.e., $A_{0.5} = 0$ and $A_{3.5} = 0$.\n\nDefine the numerical fluxes at cell faces $i+1/2$ as follows:\n- Low-order flux (donor-cell upwind for $u>0$): $F^{\\mathrm{LO}}_{i+1/2} = u \\, Y_i^n$.\n- High-order flux (centered): $F^{\\mathrm{HO}}_{i+1/2} = u \\, (Y_i^n + Y_{i+1}^n)/2$.\n- Antidiffusive flux: $A_{i+1/2} = F^{\\mathrm{HO}}_{i+1/2} - F^{\\mathrm{LO}}_{i+1/2}$.\n\nLet the low-order update be $Y_i^{\\mathrm{LO}} = Y_i^n - (\\Delta t/\\Delta x)\\left(F^{\\mathrm{LO}}_{i+1/2} - F^{\\mathrm{LO}}_{i-1/2}\\right)$. To construct limiter coefficients for Flux-Corrected Transport (FCT), use the Zalesak flux limiter. For each cell $i$, define local bounds from the previous time level $n$ as $B_i^{\\min} = \\min\\left(Y_{i-1}^n, Y_i^n, Y_{i+1}^n\\right)$ and $B_i^{\\max} = \\max\\left(Y_{i-1}^n, Y_i^n, Y_{i+1}^n\\right)$, where at $i=1$ use $Y_0^n$ and at $i=3$ use $Y_4^n$ as neighbors. Define capacities $C_i^{+} = B_i^{\\max} - Y_i^{\\mathrm{LO}}$ and $C_i^{-} = Y_i^{\\mathrm{LO}} - B_i^{\\min}$, and the sums of antidiffusive influxes that would increase or decrease $Y_i$,\n$$\nP_i^{+} = \\max\\left(0, A_{i-1/2}\\right) + \\max\\left(0, -A_{i+1/2}\\right), \\quad\nP_i^{-} = \\max\\left(0, -A_{i-1/2}\\right) + \\max\\left(0, A_{i+1/2}\\right).\n$$\nThe limiter factors are\n$$\nr_i^{+} = \\begin{cases}\n1, & P_i^{+} = 0,\\\\\n\\min\\left(1, \\dfrac{C_i^{+}}{(\\Delta t/\\Delta x)\\, P_i^{+}}\\right), & P_i^{+} > 0,\n\\end{cases}\n\\quad\nr_i^{-} = \\begin{cases}\n1, & P_i^{-} = 0,\\\\\n\\min\\left(1, \\dfrac{C_i^{-}}{(\\Delta t/\\Delta x)\\, P_i^{-}}\\right), & P_i^{-} > 0.\n\\end{cases}\n$$\nLimit the antidiffusive flux at each interior face by\n$$\nA^{*}_{i+1/2} =\n\\begin{cases}\n\\min\\left(r_i^{-},\\, r_{i+1}^{+}\\right)\\, A_{i+1/2}, & A_{i+1/2} > 0,\\\\\n\\min\\left(r_i^{+},\\, r_{i+1}^{-}\\right)\\, A_{i+1/2}, & A_{i+1/2} < 0.\n\\end{cases}\n$$\nFinally, compute the FCT-corrected update for the middle cell,\n$$\nY_2^{n+1} = Y_2^{\\mathrm{LO}} - \\frac{\\Delta t}{\\Delta x}\\left(A^{*}_{2.5} - A^{*}_{1.5}\\right).\n$$\n\nImplement these steps by hand on the given three-cell stencil, and provide the numerical value of $Y_2^{n+1}$ as a dimensionless number. Round your answer to four significant figures. In addition, in your reasoning you must confirm that the corrected update introduces no new local extrema in the middle cell relative to the set $\\{Y_1^n, Y_2^n, Y_3^n\\}$.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. It describes a standard one-dimensional Flux-Corrected Transport (FCT) algorithm applied to the linear advection equation, which is a fundamental problem in computational physics and combustion. All necessary parameters, initial conditions, boundary conditions, and algorithmic definitions are provided without ambiguity or contradiction. We may therefore proceed with the solution.\n\nThe problem requires the calculation of the updated species mass fraction $Y_2^{n+1}$ in the central cell of a three-cell domain after one time step using the FCT method. The governing equation is $\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = 0$.\n\nThe given parameters are:\n- Advective velocity: $u = 1.0 \\,\\mathrm{m/s}$\n- Grid spacing: $\\Delta x = 1.0 \\times 10^{-2} \\,\\mathrm{m}$\n- Time step: $\\Delta t = 6.0 \\times 10^{-3} \\,\\mathrm{s}$\n- Courant number: $\\nu = \\frac{u \\Delta t}{\\Delta x} = \\frac{(1.0)(6.0 \\times 10^{-3})}{1.0 \\times 10^{-2}} = 0.6$\n- Initial and boundary cell-averaged values at time level $n$:\n  - $Y_0^n = 0.2$ (ghost cell)\n  - $Y_1^n = 0.2$\n  - $Y_2^n = 0.8$\n  - $Y_3^n = 0.4$\n  - $Y_4^n = Y_3^n = 0.4$ (ghost cell)\n\nThe calculation proceeds in several steps as defined by the FCT algorithm.\n\n**Step 1: Compute the Low-Order Solution, $Y_i^{\\mathrm{LO}}$**\nThe low-order scheme is first-order upwind (donor cell), for which the update equation is:\n$$Y_i^{\\mathrm{LO}} = Y_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F^{\\mathrm{LO}}_{i+1/2} - F^{\\mathrm{LO}}_{i-1/2}\\right)$$\nGiven $F^{\\mathrm{LO}}_{i+1/2} = u Y_i^n$ (since $u>0$), this simplifies to:\n$$Y_i^{\\mathrm{LO}} = Y_i^n - \\frac{u \\Delta t}{\\Delta x}\\left(Y_i^n - Y_{i-1}^n\\right) = Y_i^n - \\nu\\left(Y_i^n - Y_{i-1}^n\\right)$$\nWe apply this to the interior cells $i=1, 2, 3$:\n- For $i=1$: $Y_1^{\\mathrm{LO}} = Y_1^n - \\nu(Y_1^n - Y_0^n) = 0.2 - 0.6(0.2 - 0.2) = 0.2$.\n- For $i=2$: $Y_2^{\\mathrm{LO}} = Y_2^n - \\nu(Y_2^n - Y_1^n) = 0.8 - 0.6(0.8 - 0.2) = 0.8 - 0.6(0.6) = 0.8 - 0.36 = 0.44$.\n- For $i=3$: $Y_3^{\\mathrm{LO}} = Y_3^n - \\nu(Y_3^n - Y_2^n) = 0.4 - 0.6(0.4 - 0.8) = 0.4 - 0.6(-0.4) = 0.4 + 0.24 = 0.64$.\n\n**Step 2: Compute the Antidiffusive Fluxes, $A_{i+1/2}$**\nThe antidiffusive flux is the difference between the high-order (centered) and low-order (upwind) fluxes:\n$$A_{i+1/2} = F^{\\mathrm{HO}}_{i+1/2} - F^{\\mathrm{LO}}_{i+1/2} = u \\frac{Y_i^n + Y_{i+1}^n}{2} - u Y_i^n = \\frac{u}{2}\\left(Y_{i+1}^n - Y_i^n\\right)$$\nWe need these fluxes for the interior faces and the boundaries:\n- $A_{0.5} = 0$ (given).\n- $A_{1.5} = \\frac{1.0}{2}(Y_2^n - Y_1^n) = \\frac{1}{2}(0.8 - 0.2) = 0.3$.\n- $A_{2.5} = \\frac{1.0}{2}(Y_3^n - Y_2^n) = \\frac{1}{2}(0.4 - 0.8) = -0.2$.\n- $A_{3.5} = 0$ (given).\n\n**Step 3: Determine Local Bounds and Capacities**\nFor each cell $i$, we find the local extrema from the previous time step, $B_i^{\\min}$ and $B_i^{\\max}$, and then the capacities $C_i^+$ and $C_i^-$ based on the low-order solution.\n- **Cell $i=1$**:\n  - $B_1^{\\min} = \\min(Y_0^n, Y_1^n, Y_2^n) = \\min(0.2, 0.2, 0.8) = 0.2$.\n  - $B_1^{\\max} = \\max(Y_0^n, Y_1^n, Y_2^n) = \\max(0.2, 0.2, 0.8) = 0.8$.\n  - $C_1^{+} = B_1^{\\max} - Y_1^{\\mathrm{LO}} = 0.8 - 0.2 = 0.6$.\n  - $C_1^{-} = Y_1^{\\mathrm{LO}} - B_1^{\\min} = 0.2 - 0.2 = 0$.\n- **Cell $i=2$**:\n  - $B_2^{\\min} = \\min(Y_1^n, Y_2^n, Y_3^n) = \\min(0.2, 0.8, 0.4) = 0.2$.\n  - $B_2^{\\max} = \\max(Y_1^n, Y_2^n, Y_3^n) = \\max(0.2, 0.8, 0.4) = 0.8$.\n  - $C_2^{+} = B_2^{\\max} - Y_2^{\\mathrm{LO}} = 0.8 - 0.44 = 0.36$.\n  - $C_2^{-} = Y_2^{\\mathrm{LO}} - B_2^{\\min} = 0.44 - 0.2 = 0.24$.\n- **Cell $i=3$**:\n  - $B_3^{\\min} = \\min(Y_2^n, Y_3^n, Y_4^n) = \\min(0.8, 0.4, 0.4) = 0.4$.\n  - $B_3^{\\max} = \\max(Y_2^n, Y_3^n, Y_4^n) = \\max(0.8, 0.4, 0.4) = 0.8$.\n  - $C_3^{+} = B_3^{\\max} - Y_3^{\\mathrm{LO}} = 0.8 - 0.64 = 0.16$.\n  - $C_3^{-} = Y_3^{\\mathrm{LO}} - B_3^{\\min} = 0.64 - 0.4 = 0.24$.\n\n**Step 4: Compute Raw Antidiffusive Influx Sums, $P_i^{\\pm}$**\nThese sums represent the total antidiffusive flux that tends to increase ($P_i^+$) or decrease ($P_i^-$) the value in cell $i$.\n- **Cell $i=1$**: using $A_{0.5}=0$ and $A_{1.5}=0.3$.\n  - $P_1^{+} = \\max(0, A_{0.5}) + \\max(0, -A_{1.5}) = \\max(0, 0) + \\max(0, -0.3) = 0$.\n  - $P_1^{-} = \\max(0, -A_{0.5}) + \\max(0, A_{1.5}) = \\max(0, 0) + \\max(0, 0.3) = 0.3$.\n- **Cell $i=2$**: using $A_{1.5}=0.3$ and $A_{2.5}=-0.2$.\n  - $P_2^{+} = \\max(0, A_{1.5}) + \\max(0, -A_{2.5}) = \\max(0, 0.3) + \\max(0, -(-0.2)) = 0.3 + 0.2 = 0.5$.\n  - $P_2^{-} = \\max(0, -A_{1.5}) + \\max(0, A_{2.5}) = \\max(0, -0.3) + \\max(0, -0.2) = 0$.\n- **Cell $i=3$**: using $A_{2.5}=-0.2$ and $A_{3.5}=0$.\n  - $P_3^{+} = \\max(0, A_{2.5}) + \\max(0, -A_{3.5}) = \\max(0, -0.2) + \\max(0, 0) = 0$.\n  - $P_3^{-} = \\max(0, -A_{2.5}) + \\max(0, A_{3.5}) = \\max(0, -(-0.2)) + \\max(0, 0) = 0.2$.\n\n**Step 5: Compute Limiter Factors, $r_i^{\\pm}$**\nThe limiter factors are ratios of the cell capacities to the potential antidiffusive changes. We use $\\frac{\\Delta t}{\\Delta x}=0.6$.\n- **Cell $i=1$**:\n  - $P_1^{+} = 0 \\implies r_1^{+} = 1$.\n  - $r_1^{-} = \\min\\left(1, \\frac{C_1^{-}}{(\\Delta t/\\Delta x)P_1^{-}}\\right) = \\min\\left(1, \\frac{0}{0.6 \\times 0.3}\\right) = 0$.\n- **Cell $i=2$**:\n  - $r_2^{+} = \\min\\left(1, \\frac{C_2^{+}}{(\\Delta t/\\Delta x)P_2^{+}}\\right) = \\min\\left(1, \\frac{0.36}{0.6 \\times 0.5}\\right) = \\min\\left(1, \\frac{0.36}{0.3}\\right) = \\min(1, 1.2) = 1$.\n  - $P_2^{-} = 0 \\implies r_2^{-} = 1$.\n- **Cell $i=3$**:\n  - $P_3^{+} = 0 \\implies r_3^{+} = 1$.\n  - $r_3^{-} = \\min\\left(1, \\frac{C_3^{-}}{(\\Delta t/\\Delta x)P_3^{-}}\\right) = \\min\\left(1, \\frac{0.24}{0.6 \\times 0.2}\\right) = \\min\\left(1, \\frac{0.24}{0.12}\\right) = \\min(1, 2) = 1$.\n\n**Step 6: Compute Limited Antidiffusive Fluxes, $A^{*}_{i+1/2}$**\nThe antidiffusive flux across each face is limited by the minimum of the relevant limiter factors from the two adjacent cells.\n- **Face $i+1/2=1.5$**: $A_{1.5}=0.3 > 0$. The flux is limited by the \"giver\" cell $i=1$ ($r_1^-$) and the \"receiver\" cell $i=2$ ($r_2^+$).\n  - $A^{*}_{1.5} = \\min(r_1^-, r_2^+) A_{1.5} = \\min(0, 1) \\times 0.3 = 0 \\times 0.3 = 0$.\n- **Face $i+1/2=2.5$**: $A_{2.5}=-0.2 < 0$. The flux is limited by the \"receiver\" cell $i=2$ ($r_2^+$) and the \"giver\" cell $i=3$ ($r_3^-$).\n  - $A^{*}_{2.5} = \\min(r_2^+, r_3^-) A_{2.5} = \\min(1, 1) \\times (-0.2) = 1 \\times (-0.2) = -0.2$.\n\n**Step 7: Compute the Final FCT Update for $Y_2^{n+1}$**\nThe final updated value is the low-order solution corrected by the limited antidiffusive fluxes.\n$$Y_2^{n+1} = Y_2^{\\mathrm{LO}} - \\frac{\\Delta t}{\\Delta x}\\left(A^{*}_{2.5} - A^{*}_{1.5}\\right)$$\nSubstituting the calculated values:\n$$Y_2^{n+1} = 0.44 - 0.6\\left(-0.2 - 0\\right) = 0.44 - 0.6(-0.2) = 0.44 + 0.12 = 0.56$$\n\n**Monotonicity Confirmation**\nThe FCT method is designed to be monotonicity-preserving. This means the updated value $Y_i^{n+1}$ must lie within the bounds set by the local neighborhood at the previous time step, i.e., $B_i^{\\min} \\leq Y_i^{n+1} \\leq B_i^{\\max}$. For the middle cell, $i=2$, these bounds are $B_2^{\\min} = 0.2$ and $B_2^{\\max} = 0.8$.\nOur calculated value is $Y_2^{n+1} = 0.56$. We check the condition:\n$$0.2 \\leq 0.56 \\leq 0.8$$\nThe condition is satisfied. The initial profile in cells $\\{1,2,3\\}$ was $\\{0.2, 0.8, 0.4\\}$, which has a local maximum at cell $2$. The updated value $0.56$ is between the neighboring values at time $n$ ($0.2$ and $0.4$) and does not create a new local minimum or maximum. The monotonicity property is thus upheld by the calculation.\n\nThe final numerical value for $Y_2^{n+1}$, rounded to four significant figures as requested, is $0.5600$.",
            "answer": "$$\\boxed{0.5600}$$"
        }
    ]
}