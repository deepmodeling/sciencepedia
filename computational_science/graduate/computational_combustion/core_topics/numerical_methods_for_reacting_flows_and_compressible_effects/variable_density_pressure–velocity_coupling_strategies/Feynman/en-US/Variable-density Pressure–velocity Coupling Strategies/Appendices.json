{
    "hands_on_practices": [
        {
            "introduction": "A key departure from incompressible flow is that the velocity field in low-Mach-number reacting flows is not divergence-free. This first practice provides the theoretical foundation for this crucial concept by starting with the ideal-gas equation of state and the continuity equation. By deriving the relationship between volumetric expansion ($\\nabla\\cdot\\mathbf{u}$), temperature change, and composition change under the constraint of constant pressure, you will uncover the fundamental \"divergence constraint\" that forms the basis of all variable-density pressure-velocity coupling strategies .",
            "id": "4075911",
            "problem": "Consider a spatially homogeneous, variable-density, reacting ideal-gas mixture in a constant-pressure reactor used in computational combustion. The reactor is modeled under the low-Mach-number approximation with a velocity field that accommodates volumetric expansion or contraction, but thermodynamic fields are uniform in space and depend only on time. Let the pressure be $p_{0}(t)$ and suppose it is constrained to remain constant in time. The mixture is described by the Equation of State (EOS) for an ideal-gas mixture,\n$$\np_{0} \\;=\\; \\rho \\, R_{u} \\, T \\,\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}},\n$$\nwhere $\\rho$ is the density, $T$ is the temperature, $R_{u}$ is the Universal Gas Constant, $Y_{k}$ are the species mass fractions, $W_{k}$ are the species molecular weights, and $N$ is the number of species. The continuity equation in a spatially homogeneous reactor reduces to\n$$\n\\partial_{t}\\rho \\;+\\; \\rho \\,\\nabla\\cdot\\mathbf{u} \\;=\\; 0,\n$$\nwhere $\\nabla\\cdot\\mathbf{u}$ is the velocity divergence, which is uniform in space for the homogeneous reactor.\n\nStarting strictly from the continuity equation and the ideal-gas mixture EOS, and assuming that $p_{0}(t)$ is constant in time, derive the coupling relation between the time derivative of temperature $\\partial_{t} T$ and the velocity divergence $\\nabla\\cdot\\mathbf{u}$ that enforces constant pressure while allowing general time variation of composition $Y_{k}(t)$ due to chemical reactions. Express your final answer as a single closed-form analytic expression that shows how $\\nabla\\cdot\\mathbf{u}$ depends on $\\partial_{t} T$ and the time variation of the composition. Do not include units in your final expression.",
            "solution": "The problem has been validated and is deemed a well-posed, scientifically grounded problem in the field of computational combustion. The derivation of the pressure-velocity coupling constraint for a variable-density, low-Mach-number flow is a fundamental exercise.\n\nThe objective is to derive a relationship between the velocity divergence, $\\nabla\\cdot\\mathbf{u}$, the rate of change of temperature, $\\partial_{t} T$, and the rate of change of species composition, $\\partial_{t} Y_{k}$, under the constraint of constant pressure.\n\nWe begin with the two governing equations provided in the problem statement.\n\nFirst, the Equation of State (EOS) for an ideal-gas mixture at a constant pressure $p_{0}$:\n$$\np_{0} = \\rho \\, R_{u} \\, T \\,\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}\n$$\nwhere $\\rho(t)$, $T(t)$, and the species mass fractions $Y_{k}(t)$ are functions of time $t$. The Universal Gas Constant $R_{u}$ and the species molecular weights $W_{k}$ are constants.\n\nSecond, the continuity equation for a spatially homogeneous system:\n$$\n\\partial_{t}\\rho + \\rho \\,\\nabla\\cdot\\mathbf{u} = 0\n$$\n\nThe core constraint of the problem is that the pressure $p_{0}$ is constant in time. Therefore, its time derivative must be zero:\n$$\n\\partial_{t} p_{0} = 0\n$$\n\nTo enforce this constraint, we differentiate the EOS with respect to time. Since $p_{0}$ and $R_{u}$ are constants, we can write the EOS as $\\frac{p_{0}}{R_{u}} = \\rho \\, T \\,\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}$. Differentiating both sides with respect to time gives:\n$$\n\\partial_{t} \\left( \\frac{p_{0}}{R_{u}} \\right) = \\partial_{t} \\left( \\rho \\, T \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)\n$$\n$$\n0 = \\partial_{t} \\left( \\rho \\, T \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)\n$$\nThe right-hand side is a product of three time-dependent quantities: the density $\\rho(t)$, the temperature $T(t)$, and the compositional term $\\sum_{k=1}^{N} \\frac{Y_{k}(t)}{W_{k}}$. We apply the product rule for differentiation, $(fgh)' = f'gh + fg'h + fgh'$, where $f=\\rho$, $g=T$, and $h=\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}$. This yields:\n$$\n0 = (\\partial_{t}\\rho) \\left( T \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho \\left( (\\partial_{t}T) \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho \\left( T \\, \\partial_{t}\\left(\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}\\right) \\right)\n$$\nThe derivative of the summation term is the sum of the derivatives, as the $W_{k}$ are constants:\n$$\n\\partial_{t}\\left(\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}\\right) = \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}}\n$$\nSubstituting this back into the expanded derivative of the EOS gives:\n$$\n0 = (\\partial_{t}\\rho) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\nNow, we incorporate the continuity equation, which relates the time derivative of density to the velocity divergence. From $\\partial_{t}\\rho + \\rho \\,\\nabla\\cdot\\mathbf{u} = 0$, we find:\n$$\n\\partial_{t}\\rho = -\\rho \\,\\nabla\\cdot\\mathbf{u}\n$$\nWe substitute this expression for $\\partial_{t}\\rho$ into our differentiated EOS:\n$$\n0 = (-\\rho \\,\\nabla\\cdot\\mathbf{u}) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\nAssuming the density $\\rho$ is non-zero, we can divide the entire equation by $\\rho$:\n$$\n0 = -(\\nabla\\cdot\\mathbf{u}) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\nOur goal is to find an expression for $\\nabla\\cdot\\mathbf{u}$. We isolate the term containing $\\nabla\\cdot\\mathbf{u}$:\n$$\n(\\nabla\\cdot\\mathbf{u}) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) = (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\nFinally, we solve for $\\nabla\\cdot\\mathbf{u}$ by dividing by the coefficient on the left-hand side, $T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)$, assuming $T \\neq 0$ and the mixture exists (i.e., the sum is non-zero):\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{(\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)}{T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)}\n$$\nThis expression can be simplified by separating it into two fractions:\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{(\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)}{T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)} + \\frac{T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)}{T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)}\n$$\nCanceling common terms in each fraction leads to the final analytic expression for the velocity divergence:\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{1}{T} \\partial_{t}T + \\frac{\\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}}}{\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}}\n$$\nThis is the required coupling relation. It dictates the necessary volumetric expansion rate ($\\nabla\\cdot\\mathbf{u}$) to maintain constant pressure in response to changes in temperature and composition.",
            "answer": "$$\\boxed{\\frac{1}{T}\\partial_{t}T + \\frac{\\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}}}{\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}}}$$"
        },
        {
            "introduction": "When pressure and velocity are stored at the same locations on a grid (a collocated arrangement), a numerical instability known as \"checkerboarding\" can arise, leading to unphysical oscillations where the pressure gradient fails to influence the velocity field. The Rhie-Chow interpolation is a classic and powerful technique designed to prevent this decoupling. This exercise provides a deep dive into the mechanism of the Rhie-Chow strategy, specifically analyzing its ability to damp the checkerboard mode in the presence of strong, spatially varying density, which is a common challenge in combustion simulations .",
            "id": "4075909",
            "problem": "Consider a one-dimensional, uniform, collocated finite-volume discretization for a low-Mach reacting flow with variable density, representative of computational combustion. The grid has cell centers indexed by $i \\in \\mathbb{Z}$, with uniform cell width $\\Delta x$ and unit face area, so that each control volume has $V = \\Delta x$. Let the density field be spatially alternating due to compositional stratification: $\\rho_{i} = \\rho_{1}$ for odd $i$ and $\\rho_{i} = \\rho_{2}$ for even $i$, with $\\rho_{1} > 0$ and $\\rho_{2} > 0$. The unsteady momentum coefficient in cell $i$ is defined by $a_{i} = \\rho_{i} \\Delta x / \\Delta t$, where $\\Delta t > 0$ is a pseudo-time step used to stabilize the pressure–velocity coupling.\n\nPressure–velocity coupling is performed on the collocated grid using the Rhie–Chow (RC) interpolation strategy. In the pressure-driven part of the face velocity, introduce a dimensionless strength parameter $\\alpha \\in \\mathbb{R}$ multiplying the RC damping, and define the RC face velocity contribution between cells $i$ and $i+1$ by\n$$\nu^{p}_{i+\\frac{1}{2}} = - \\alpha \\, d_{i+\\frac{1}{2}} \\left( p_{i+1} - p_{i} \\right),\n$$\nwhere the face $i+\\frac{1}{2}$ momentum inverse coefficient is $d_{i+\\frac{1}{2}} = 1/a_{i+\\frac{1}{2}}$ and the face momentum coefficient $a_{i+\\frac{1}{2}}$ is the harmonic average of the adjacent cell coefficients,\n$$\na_{i+\\frac{1}{2}} = \\frac{2}{\\frac{1}{a_{i}} + \\frac{1}{a_{i+1}}}.\n$$\nLet the face density be the arithmetic average $\\rho_{i+\\frac{1}{2}} = (\\rho_{i} + \\rho_{i+1})/2$. The pressure-driven mass flux correction at face $i+\\frac{1}{2}$ is then $m^{p}_{i+\\frac{1}{2}} = \\rho_{i+\\frac{1}{2}} u^{p}_{i+\\frac{1}{2}}$. The discrete continuity residual in cell $i$ due solely to the pressure-driven RC velocity is\n$$\nR_{i} = m^{p}_{i+\\frac{1}{2}} - m^{p}_{i-\\frac{1}{2}}.\n$$\n\nStart from the discrete mass conservation law and the above RC definitions. Analyze the response of $R_{i}$ to the canonical checkerboard pressure mode $p_{i} = (-1)^{i} p_{0}$, with a nonzero constant amplitude $p_{0}$. Derive the closed-form expression for the dimensionless, density-normalized eigenvalue $\\hat{\\lambda}$ defined by the proportionality\n$$\nR_{i} = \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\, \\hat{\\lambda} \\, p_{i}\n$$\nwhen the RC interpolation uses the harmonic averaging for $a_{i+\\frac{1}{2}}$ and arithmetic averaging for $\\rho_{i+\\frac{1}{2}}$ under the alternating-density pattern specified above.\n\nYour final answer must be a single analytical expression for $\\hat{\\lambda}$ in terms of $\\alpha$ only. No units are required because $\\hat{\\lambda}$ is dimensionless by construction. In addition, explain the conditions under which the RC strategy eliminates the checkerboard pressure mode on such collocated grids with variable density, based on your derivation. Do not compute any numerical values. Provide the expression for $\\hat{\\lambda}$ as your final answer.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically the analysis of pressure–velocity coupling schemes. It is well-posed, with all necessary definitions and conditions provided to allow for a unique solution. The language is objective and the setup is internally consistent.\n\nThe objective is to derive the dimensionless eigenvalue $\\hat{\\lambda}$ from the relation for the continuity residual, $R_{i}$, under a checkerboard pressure mode. The derivation proceeds as follows.\n\nThe discrete continuity residual in cell $i$ is defined as the net pressure-driven mass flux:\n$$\nR_{i} = m^{p}_{i+\\frac{1}{2}} - m^{p}_{i-\\frac{1}{2}}\n$$\nThe pressure-driven mass flux at a face is given by $m^{p} = \\rho_{\\text{face}} u^{p}_{\\text{face}}$. The pressure-driven velocity contribution at face $i+\\frac{1}{2}$ is defined as:\n$$\nu^{p}_{i+\\frac{1}{2}} = - \\alpha \\, d_{i+\\frac{1}{2}} \\left( p_{i+1} - p_{i} \\right) = - \\alpha \\frac{1}{a_{i+\\frac{1}{2}}} \\left( p_{i+1} - p_{i} \\right)\n$$\nTherefore, the mass flux at face $i+\\frac{1}{2}$ is:\n$$\nm^{p}_{i+\\frac{1}{2}} = \\rho_{i+\\frac{1}{2}} u^{p}_{i+\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\left( p_{i+1} - p_{i} \\right)\n$$\nSimilarly, the mass flux at face $i-\\frac{1}{2}$ is:\n$$\nm^{p}_{i-\\frac{1}{2}} = \\rho_{i-\\frac{1}{2}} u^{p}_{i-\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} \\left( p_{i} - p_{i-1} \\right)\n$$\nWe now introduce the canonical checkerboard pressure mode, $p_{i} = (-1)^{i} p_{0}$, where $p_{0}$ is a non-zero constant amplitude. The pressure differences across the cell faces are:\n$$\np_{i+1} - p_{i} = (-1)^{i+1} p_{0} - (-1)^{i} p_{0} = -(-1)^{i} p_{0} - (-1)^{i} p_{0} = -2 (-1)^{i} p_{0} = -2 p_{i}\n$$\n$$\np_{i} - p_{i-1} = (-1)^{i} p_{0} - (-1)^{i-1} p_{0} = (-1)^{i} p_{0} - (-(-1)^{i} p_{0}) = 2 (-1)^{i} p_{0} = 2 p_{i}\n$$\nSubstituting these pressure differences back into the mass flux expressions:\n$$\nm^{p}_{i+\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} (-2 p_{i}) = 2 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}\n$$\n$$\nm^{p}_{i-\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} (2 p_{i}) = -2 \\alpha p_{i} \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}}\n$$\nThe continuity residual $R_{i}$ is then:\n$$\nR_{i} = m^{p}_{i+\\frac{1}{2}} - m^{p}_{i-\\frac{1}{2}} = \\left( 2 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\right) - \\left( -2 \\alpha p_{i} \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} \\right) = 2 \\alpha p_{i} \\left( \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} + \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} \\right)\n$$\nNext, we evaluate the face quantities using the specified alternating density field, $\\rho_{i} = \\rho_{1}$ for odd $i$ and $\\rho_{i} = \\rho_{2}$ for even $i$. The analysis is independent of whether cell $i$ is odd or even. Let's assume $i$ is an even index. Then $i+1$ and $i-1$ are odd indices.\n- Cell $i$: $\\rho_{i} = \\rho_{2}$\n- Cell $i+1$: $\\rho_{i+1} = \\rho_{1}$\n- Cell $i-1$: $\\rho_{i-1} = \\rho_{1}$\n\nThe cell momentum coefficients are $a_{k} = \\rho_{k} \\frac{\\Delta x}{\\Delta t}$. Let $K = \\frac{\\Delta x}{\\Delta t}$. Then $a_{i} = \\rho_{2} K$, $a_{i+1} = \\rho_{1} K$, and $a_{i-1} = \\rho_{1} K$.\n\nFor face $i+\\frac{1}{2}$ (between cells $i$ and $i+1$):\n- Arithmetic average of density: $\\rho_{i+\\frac{1}{2}} = \\frac{\\rho_{i} + \\rho_{i+1}}{2} = \\frac{\\rho_{2} + \\rho_{1}}{2}$.\n- Harmonic average of momentum coefficient:\n$$\na_{i+\\frac{1}{2}} = \\frac{2}{\\frac{1}{a_{i}} + \\frac{1}{a_{i+1}}} = \\frac{2}{\\frac{1}{\\rho_{2} K} + \\frac{1}{\\rho_{1} K}} = \\frac{2K}{\\frac{\\rho_{1} + \\rho_{2}}{\\rho_{1} \\rho_{2}}} = 2K \\frac{\\rho_{1} \\rho_{2}}{\\rho_{1} + \\rho_{2}}\n$$\n\nFor face $i-\\frac{1}{2}$ (between cells $i-1$ and $i$):\n- Arithmetic average of density: $\\rho_{i-\\frac{1}{2}} = \\frac{\\rho_{i-1} + \\rho_{i}}{2} = \\frac{\\rho_{1} + \\rho_{2}}{2}$.\n- Harmonic average of momentum coefficient:\n$$\na_{i-\\frac{1}{2}} = \\frac{2}{\\frac{1}{a_{i-1}} + \\frac{1}{a_{i}}} = \\frac{2}{\\frac{1}{\\rho_{1} K} + \\frac{1}{\\rho_{2} K}} = \\frac{2K}{\\frac{\\rho_{2} + \\rho_{1}}{\\rho_{1} \\rho_{2}}} = 2K \\frac{\\rho_{1} \\rho_{2}}{\\rho_{1} + \\rho_{2}}\n$$\nWe observe that $\\rho_{i+\\frac{1}{2}} = \\rho_{i-\\frac{1}{2}}$ and $a_{i+\\frac{1}{2}} = a_{i-\\frac{1}{2}}$. This is due to the symmetry of the averaging methods and the fact that both faces $i+\\frac{1}{2}$ and $i-\\frac{1}{2}$ span across cells with densities $\\rho_1$ and $\\rho_2$.\nTherefore, the ratio $\\frac{\\rho_{\\text{face}}}{a_{\\text{face}}}$ is identical for both faces:\n$$\n\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} = \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}}\n$$\nSubstituting this identity into the expression for $R_{i}$:\n$$\nR_{i} = 2 \\alpha p_{i} \\left( \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} + \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\right) = 4 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}\n$$\nThe problem defines the dimensionless eigenvalue $\\hat{\\lambda}$ through the proportionality:\n$$\nR_{i} = \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\, \\hat{\\lambda} \\, p_{i}\n$$\nBy comparing this definition with our derived expression for $R_{i}$, we can equate the two:\n$$\n\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\, \\hat{\\lambda} \\, p_{i} = 4 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}\n$$\nSince $p_{0} \\neq 0$, it follows that $p_{i} \\neq 0$. Also, since $\\rho_{1}, \\rho_{2}, \\Delta x, \\Delta t$ are all positive, the term $\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}$ is non-zero. We can therefore cancel these common factors from both sides, which yields the expression for $\\hat{\\lambda}$:\n$$\n\\hat{\\lambda} = 4\\alpha\n$$\nThis result is independent of the densities $\\rho_1$, $\\rho_2$, and the grid parameters $\\Delta x$, $\\Delta t$.\n\nThe Rhie-Chow (RC) strategy is designed to prevent pressure-velocity decoupling on a collocated grid, which manifests as unphysical checkerboard pressure oscillations. The strategy is successful if a checkerboard pressure mode produces a non-zero continuity residual $R_{i}$, which in turn drives a pressure correction that smooths the pressure field.\nThe scheme fails to eliminate the mode if $R_{i}=0$ for a non-zero checkerboard pressure field. From our derivation, $R_{i} = 4 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}$. Since $p_i \\neq 0$ and all physical quantities are positive, the term $\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}$ is strictly positive. Therefore, $R_i=0$ if and only if $4\\alpha=0$, which implies $\\alpha=0$.\nThe condition for the RC strategy to successfully eliminate the checkerboard pressure mode is $\\hat{\\lambda} \\neq 0$, which requires $\\alpha \\neq 0$. When $\\alpha=0$, the pressure-gradient term in the face velocity formula is nullified, leading to the classic decoupling problem on collocated grids. Any non-zero value for the strength parameter $\\alpha$ ensures that the checkerboard mode is properly damped. The dimensionless eigenvalue $\\hat{\\lambda}=4\\alpha$ indicates that, for this choice of averaging methods, the fundamental coupling strength is independent of the density ratio.",
            "answer": "$$\n\\boxed{4\\alpha}\n$$"
        },
        {
            "introduction": "After understanding the theoretical basis and the core numerical stabilization techniques, the final step is to verify that a complete implementation works correctly. This capstone practice utilizes the Method of Manufactured Solutions (MMS), a rigorous code verification standard. You will design a set of analytical fields for temperature, composition, and density, derive the corresponding divergence source term, and verify that a 2D variable-coefficient Poisson solver correctly projects a given velocity field to satisfy this divergence constraint, thereby confirming the integrity of the entire pressure-velocity coupling algorithm .",
            "id": "4075809",
            "problem": "Consider a two-dimensional periodic square domain with side length $L = 1$ and uniform grid spacing. You are asked to verify a variable-density pressure–velocity coupling strategy for low-Mach-number combustion using the Method of Manufactured Solutions (MMS). The governing base is conservation of mass and the ideal-gas Equation of State (EOS), and no external mass sources exist at the mixture level. The goal is to design manufactured temperature $T(\\mathbf{x})$, species mass fractions $Y_k(\\mathbf{x})$, and density $\\rho(\\mathbf{x})$ that produce a known divergence source $S(\\mathbf{x})$, and to use this source to verify a projection-based pressure–velocity coupling under variable density.\n\nFundamental base:\n- Conservation of mass: $$\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0.$$\n- Ideal-gas Equation of State: $$\\rho = \\frac{p_0 W}{R_u T},$$ where $p_0$ is the constant reference thermodynamic pressure, $W$ is the mixture molecular weight, and $R_u$ is the universal gas constant.\n- Mixture molecular weight: $$W = \\left(\\sum_{k} \\frac{Y_k}{W_k}\\right)^{-1},$$ for species index $k$ with species molecular weights $W_k$.\n\nIn the low-Mach-number limit with constant background pressure $p_0$, the velocity divergence $S(\\mathbf{x})$ is determined by the material density change implied by $T(\\mathbf{x})$ and $Y_k(\\mathbf{x})$ through the EOS. Your task is to:\n1. From the fundamental base above, derive the divergence constraint $$\\nabla \\cdot \\mathbf{u} = S(\\mathbf{x}).$$\n2. Starting from a manufactured, periodic predictor velocity $\\mathbf{u}^\\ast(\\mathbf{x})$ that does not necessarily satisfy the constraint, derive the variable-coefficient pressure Poisson equation that enforces the coupling, and show how the corrected velocity $\\mathbf{u}^{n+1}(\\mathbf{x})$ is obtained so that it satisfies the divergence constraint to within numerical tolerance.\n\nFor the manufactured fields, use the following periodic functions on the unit square $(x,y) \\in [0,1)^2$:\n- Temperature:\n  $$T(x,y) = T_0 \\left[1 + a_T \\sin(2\\pi x)\\cos(2\\pi y)\\right].$$\n- Species mass fractions for two-species mixture:\n  $$Y_1(x,y) = Y_m + a_Y \\cos(2\\pi x)\\sin(2\\pi y),\\quad Y_2(x,y) = 1 - Y_1(x,y),$$\n  with species molecular weights $W_1$ and $W_2$.\n- Mixture molecular weight:\n  $$W(x,y) = \\left(\\frac{Y_1(x,y)}{W_1} + \\frac{Y_2(x,y)}{W_2}\\right)^{-1}.$$\n- Density from EOS:\n  $$\\rho(x,y) = \\frac{p_0 W(x,y)}{R_u T(x,y)}.$$\n\nUse the manufactured, periodic predictor velocity\n$$\\mathbf{u}^\\ast(x,y) = \\begin{bmatrix}\\sin(2\\pi y) \\\\ \\cos(2\\pi x)\\end{bmatrix}.$$\n\nDefine the divergence source $S(\\mathbf{x})$ in terms of the material derivatives of $T$ and $W$ implied by the EOS and the velocity field. For this verification, assume time-independent manufactured fields so that the material derivative reduces to the convective derivative $D(\\cdot)/Dt = \\mathbf{u}\\cdot\\nabla(\\cdot)$.\n\nConstruct the variable-coefficient Poisson problem using a uniform time step $\\Delta t$,\n$$\\nabla \\cdot \\left(\\frac{\\Delta t}{\\rho} \\nabla \\phi\\right) = \\nabla \\cdot \\mathbf{u}^\\ast - S,$$\nand correct the velocity by\n$$\\mathbf{u}^{n+1} = \\mathbf{u}^\\ast - \\frac{\\Delta t}{\\rho} \\nabla \\phi,$$\nso that $\\nabla \\cdot \\mathbf{u}^{n+1} \\approx S$.\n\nAlgorithmic requirements:\n- Use a second-order central finite difference discretization on a uniform $N\\times N$ grid with periodic boundary conditions for spatial operators.\n- Discretize the operator $\\nabla \\cdot (\\alpha \\nabla \\phi)$ with $\\alpha = \\Delta t/\\rho$ using a conservative flux form with face-centered $\\alpha$ obtained by arithmetic averaging of adjacent cell-centered values.\n- Solve the linear system with a gauge fixing for $\\phi$ (e.g., set $\\phi$ to zero at one arbitrary grid point) to remove the nullspace due to periodic boundary conditions.\n\nVerification metric:\n- Compute the root-mean-square (RMS) error of the divergence constraint,\n  $$E = \\sqrt{\\frac{1}{N^2}\\sum_{i,j} \\left[\\left(\\nabla \\cdot \\mathbf{u}^{n+1}\\right)_{i,j} - S_{i,j}\\right]^2}.$$\n\nUnits:\n- All quantities can be treated as dimensionless in the final numerical verification. You may use physically consistent values for $p_0$, $R_u$, $W_k$, and $T_0$ as parameters within the program, but the final verification metric $E$ must be reported as a dimensionless float.\n\nTest suite:\nProvide the RMS error $E$ for the following four parameter sets, each representing a distinct coverage scenario:\n- Case A (happy path, moderate gradients): $N = 16$, $\\Delta t = 10^{-3}$, $T_0 = 1200$, $p_0 = 101325$, $W_1 = 28\\times 10^{-3}$, $W_2 = 18\\times 10^{-3}$, $Y_m = 0.5$, $a_T = 0.05$, $a_Y = 0.10$.\n- Case B (refined grid, stronger gradients): $N = 32$, $\\Delta t = 5\\times 10^{-4}$, $T_0 = 1500$, $p_0 = 101325$, $W_1 = 28\\times 10^{-3}$, $W_2 = 18\\times 10^{-3}$, $Y_m = 0.4$, $a_T = 0.20$, $a_Y = 0.20$.\n- Case C (edge case, zero source): $N = 8$, $\\Delta t = 10^{-2}$, $T_0 = 1000$, $p_0 = 101325$, $W_1 = 28\\times 10^{-3}$, $W_2 = 18\\times 10^{-3}$, $Y_m = 0.7$, $a_T = 0.0$, $a_Y = 0.0$.\n- Case D (intermediate grid, asymmetric gradients): $N = 24$, $\\Delta t = 2\\times 10^{-3}$, $T_0 = 1300$, $p_0 = 101325$, $W_1 = 28\\times 10^{-3}$, $W_2 = 18\\times 10^{-3}$, $Y_m = 0.6$, $a_T = 0.15$, $a_Y = 0.05$.\n\nFinal output format:\nYour program should produce a single line of output containing the RMS errors for the four cases as a comma-separated list enclosed in square brackets (e.g., \"[E_A,E_B,E_C,E_D]\"). Each entry must be a float.",
            "solution": "The problem statement presented is a well-posed Method of Manufactured Solutions (MMS) exercise for verifying a variable-density pressure-velocity coupling algorithm in computational combustion. It is scientifically grounded, self-contained, and provides all necessary information for a complete derivation and numerical implementation. The problem is deemed valid.\n\nHere, we present the step-by-step derivation and the design of the numerical solution.\n\n### 1. Derivation of the Divergence Constraint and Source Term\n\nThe analysis begins with the differential form of the conservation of mass equation, which is given as:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nwhere $\\rho$ is the fluid density and $\\mathbf{u}$ is the velocity vector. Using the vector calculus identity $\\nabla \\cdot (\\rho \\mathbf{u}) = \\mathbf{u} \\cdot \\nabla \\rho + \\rho \\nabla \\cdot \\mathbf{u}$, the mass conservation equation can be expanded to:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\rho + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\nThe first two terms constitute the material derivative of density, $\\frac{D\\rho}{Dt}$. This allows us to rewrite the equation as:\n$$\n\\frac{D\\rho}{Dt} + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\nIn low-Mach-number flows, the velocity field must satisfy a divergence constraint derived from the thermodynamic state of the fluid. By rearranging the above equation, we find the explicit form of this constraint:\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\nThis is the target divergence that the velocity field must satisfy, which we denote as the source term $S(\\mathbf{x})$:\n$$\nS(\\mathbf{x}) = \\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\nTo relate this to the given thermal and composition fields, we use the ideal-gas Equation of State (EOS) at constant background pressure $p_0$:\n$$\n\\rho = \\frac{p_0 W}{R_u T}\n$$\nwhere $W$ is the mixture molecular weight, $T$ is the temperature, and $R_u$ is the universal gas constant. By taking the natural logarithm of the EOS, we get $\\ln \\rho = \\ln(p_0/R_u) + \\ln W - \\ln T$. Applying the material derivative $D/Dt$ yields:\n$$\n\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = \\frac{1}{W}\\frac{DW}{Dt} - \\frac{1}{T}\\frac{DT}{Dt}\n$$\nSubstituting this into the expression for $S(\\mathbf{x})$ gives:\n$$\nS(\\mathbf{x}) = - \\left( \\frac{1}{W}\\frac{DW}{Dt} - \\frac{1}{T}\\frac{DT}{Dt} \\right) = \\frac{1}{T}\\frac{DT}{Dt} - \\frac{1}{W}\\frac{DW}{Dt}\n$$\nThe problem specifies that the manufactured fields are time-independent ($\\partial/\\partial t = 0$), so the material derivative simplifies to the convective derivative, e.g., $DT/Dt = \\mathbf{u} \\cdot \\nabla T$. The source term calculation requires a velocity field. In the context of a predictor-corrector algorithm, the source term is evaluated using the best available velocity estimate, which is the predictor velocity $\\mathbf{u}^\\ast$. Therefore, the manufactured source term is defined as:\n$$\nS(\\mathbf{x}) = \\frac{1}{T}(\\mathbf{u}^\\ast \\cdot \\nabla T) - \\frac{1}{W}(\\mathbf{u}^\\ast \\cdot \\nabla W)\n$$\nAll fields on the right-hand side ($T$, $W$, $\\mathbf{u}^\\ast$) are specified, thus $S(\\mathbf{x})$ is a known function.\n\n### 2. The Projection Method and the Pressure Poisson Equation\n\nThe core of the pressure-velocity coupling is a projection method. We start with a predictor velocity $\\mathbf{u}^\\ast$ that does not satisfy the divergence constraint. A correction is applied to obtain a new velocity field $\\mathbf{u}^{n+1}$ that does. The correction is defined in terms of the gradient of a scalar potential field $\\phi$:\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^\\ast - \\frac{\\Delta t}{\\rho} \\nabla \\phi\n$$\nHere, $\\phi$ is a pressure-like correction potential, and $\\Delta t$ is the time step. We enforce the divergence constraint on $\\mathbf{u}^{n+1}$:\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = S\n$$\nSubstituting the expression for $\\mathbf{u}^{n+1}$ into the constraint:\n$$\n\\nabla \\cdot \\left( \\mathbf{u}^\\ast - \\frac{\\Delta t}{\\rho} \\nabla \\phi \\right) = S\n$$\nBy the linearity of the divergence operator, we have:\n$$\n\\nabla \\cdot \\mathbf{u}^\\ast - \\nabla \\cdot \\left( \\frac{\\Delta t}{\\rho} \\nabla \\phi \\right) = S\n$$\nRearranging this equation yields the variable-coefficient Poisson equation for $\\phi$:\n$$\n\\nabla \\cdot \\left( \\frac{\\Delta t}{\\rho} \\nabla \\phi \\right) = \\nabla \\cdot \\mathbf{u}^\\ast - S\n$$\nSolving this elliptic partial differential equation for $\\phi$ allows for the correction of the velocity field via the update equation, ensuring that the resulting field $\\mathbf{u}^{n+1}$ satisfies the divergence constraint, i.e., $\\nabla \\cdot \\mathbf{u}^{n+1} = S$, to within the limits of numerical accuracy.\n\n### 3. Numerical Discretization and Solution\n\nThe problem is solved on a uniform $N \\times N$ Cartesian grid with spacing $h=1/N$. All scalar fields are located at cell centers $(x_i, y_j) = (ih, jh)$.\n\n**Spatial Operators**: All spatial derivatives are approximated using second-order central differences with periodic boundary conditions. For a generic scalar field $f_{i,j}$:\n$$\n\\left(\\frac{\\partial f}{\\partial x}\\right)_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2h}, \\quad \\left(\\frac{\\partial f}{\\partial y}\\right)_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2h}\n$$\nwhere indices are evaluated modulo $N$. These formulas are used to compute $\\nabla T$, $\\nabla W$, and subsequently the source term $S_{i,j}$. They are also used to compute the divergence of velocity fields. A crucial aspect of MMS is to use the same discrete operators for defining the source term and for verifying the solution.\n\n**Poisson Equation Discretization**: The variable-coefficient Poisson equation is discretized using a conservative finite-difference scheme. Let $\\alpha = \\Delta t / \\rho$. The operator $\\nabla \\cdot (\\alpha \\nabla \\phi)$ at grid point $(i,j)$ is discretized as:\n$$\n\\frac{1}{h^2} \\left[ \\alpha_{i+\\frac{1}{2},j}(\\phi_{i+1,j}-\\phi_{i,j}) - \\alpha_{i-\\frac{1}{2},j}(\\phi_{i,j}-\\phi_{i-1,j}) + \\alpha_{i,j+\\frac{1}{2}}(\\phi_{i,j+1}-\\phi_{i,j}) - \\alpha_{i,j-\\frac{1}{2}}(\\phi_{i,j}-\\phi_{i,j-1}) \\right] = R_{i,j}\n$$\nwhere $R_{i,j} = (\\nabla \\cdot \\mathbf{u}^\\ast)_{i,j} - S_{i,j}$. The coefficients $\\alpha$ at cell faces are computed by arithmetic mean of the neighboring cell-centered values, e.g., $\\alpha_{i+\\frac{1}{2},j} = (\\alpha_{i,j} + \\alpha_{i+1,j})/2$. This formulation leads to a symmetric 5-point stencil for each grid point, resulting in a large, sparse, symmetric linear system of equations $A\\mathbf{\\Phi} = \\mathbf{B}$ for the unknown vector of potentials $\\mathbf{\\Phi}$.\n\n**Linear System Solution**: The resulting matrix $A$ is singular due to the periodic boundary conditions (the constant vector is in its nullspace). This is consistent with the physics: the pressure correction is only defined up to an additive constant. To obtain a unique solution, we must apply a gauge fixing. A simple method is to set the potential at one grid point to zero, e.g., $\\phi_{0,0}=0$. This constraint removes the nullspace and makes the system solvable. The corrected linear system is then solved using a sparse linear algebra solver.\n\n**Verification**: After solving for $\\phi$, the gradient $\\nabla \\phi$ is computed using central differences. The corrected velocity $\\mathbf{u}^{n+1}$ is then calculated. Finally, its divergence $(\\nabla \\cdot \\mathbf{u}^{n+1})_{i,j}$ is computed and compared against the manufactured source $S_{i,j}$. The root-mean-square (RMS) error, $E$, over the entire grid provides the quantitative verification metric.\n$$\nE = \\sqrt{\\frac{1}{N^2}\\sum_{i,j} \\left[\\left(\\nabla \\cdot \\mathbf{u}^{n+1}\\right)_{i,j} - S_{i,j}\\right]^2}\n$$\nA small value of $E$ confirms that the pressure-velocity coupling algorithm correctly enforces the divergence constraint.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Universal gas constant, can be set to 1.0 as problem is dimensionless\n    # but using the physical value is also fine.\n    R_u = 8.314  # J/(mol K)\n\n    test_cases = [\n        # Case A: happy path, moderate gradients\n        {'N': 16, 'dt': 1e-3, 'T0': 1200, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.5, 'aT': 0.05, 'aY': 0.10, 'Ru': R_u},\n        # Case B: refined grid, stronger gradients\n        {'N': 32, 'dt': 5e-4, 'T0': 1500, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.4, 'aT': 0.20, 'aY': 0.20, 'Ru': R_u},\n        # Case C: edge case, zero source\n        {'N': 8, 'dt': 1e-2, 'T0': 1000, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.7, 'aT': 0.0, 'aY': 0.0, 'Ru': R_u},\n        # Case D: intermediate grid, asymmetric gradients\n        {'N': 24, 'dt': 2e-3, 'T0': 1300, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.6, 'aT': 0.15, 'aY': 0.05, 'Ru': R_u},\n    ]\n\n    results = [solve_case(**case) for case in test_cases]\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\ndef solve_case(N, dt, T0, p0, W1, W2, Ym, aT, aY, Ru):\n    \"\"\"\n    Solves a single instance of the manufactured solution problem.\n    \"\"\"\n    L = 1.0\n    h = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    xx, yy = np.meshgrid(x, x, indexing='ij')\n\n    # Define helper functions for periodic central differences\n    def grad(f, h):\n        gx = (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * h)\n        gy = (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * h)\n        return gx, gy\n\n    def div(vx, vy, h):\n        dvx_dx = (np.roll(vx, -1, axis=0) - np.roll(vx, 1, axis=0)) / (2 * h)\n        dvy_dy = (np.roll(vy, -1, axis=1) - np.roll(vy, 1, axis=1)) / (2 * h)\n        return dvx_dx + dvy_dy\n\n    # --- Step 1: Compute manufactured fields and source term S ---\n    \n    # Temperature field\n    T = T0 * (1 + aT * np.sin(2 * np.pi * xx) * np.cos(2 * np.pi * yy))\n\n    # Species and mixture molecular weight fields\n    Y1 = Ym + aY * np.cos(2 * np.pi * xx) * np.sin(2 * np.pi * yy)\n    Y2 = 1 - Y1\n    W = 1.0 / (Y1 / W1 + Y2 / W2)\n\n    # Density field from EOS\n    rho = (p0 * W) / (Ru * T)\n    \n    # Predictor velocity field\n    u_star = np.sin(2 * np.pi * yy)\n    v_star = np.cos(2 * np.pi * xx)\n\n    # Compute gradients of T and W numerically\n    grad_T_x, grad_T_y = grad(T, h)\n    grad_W_x, grad_W_y = grad(W, h)\n\n    # Compute material derivatives (convective part only)\n    DTDt = u_star * grad_T_x + v_star * grad_T_y\n    DWDt = u_star * grad_W_x + v_star * grad_W_y\n\n    # Compute divergence source term S\n    S = (1 / T) * DTDt - (1 / W) * DWDt\n\n    # --- Step 2: Set up and solve the Poisson equation ---\n    \n    # RHS of the Poisson equation: div(u*) - S\n    # Note: Analytical div(u*) is 0. Numerical will be close to zero.\n    div_u_star = div(u_star, v_star, h)\n    RHS = (div_u_star - S).flatten()\n\n    # Coefficient alpha = dt/rho\n    alpha = dt / rho\n\n    # Assemble the sparse matrix for the variable-coefficient Laplacian\n    A = sparse.lil_matrix((N*N, N*N))\n    \n    for i in range(N):\n        for j in range(N):\n            k = i + j * N\n            \n            # East face\n            ip1 = (i + 1) % N\n            alpha_e = 0.5 * (alpha[i, j] + alpha[ip1, j])\n            A[k, ip1 + j * N] += alpha_e / h**2\n            A[k, k] -= alpha_e / h**2\n\n            # West face\n            im1 = (i - 1 + N) % N\n            alpha_w = 0.5 * (alpha[i, j] + alpha[im1, j])\n            A[k, im1 + j * N] += alpha_w / h**2\n            A[k, k] -= alpha_w / h**2\n            \n            # North face\n            jp1 = (j + 1) % N\n            alpha_n = 0.5 * (alpha[i, j] + alpha[i, jp1])\n            A[k, i + jp1 * N] += alpha_n / h**2\n            A[k, k] -= alpha_n / h**2\n\n            # South face\n            jm1 = (j - 1 + N) % N\n            alpha_s = 0.5 * (alpha[i, j] + alpha[i, jm1])\n            A[k, i + jm1 * N] += alpha_s / h**2\n            A[k, k] -= alpha_s / h**2\n\n    # Apply gauge fixing: phi[0,0] = 0\n    k_fix = 0\n    A[k_fix, :] = 0\n    A[k_fix, k_fix] = 1.0\n    RHS[k_fix] = 0.0\n    \n    # Convert to CSC format for efficient solving\n    A = A.tocsc()\n    \n    # Solve the linear system for phi\n    phi_flat = spsolve(A, RHS)\n    phi = phi_flat.reshape((N, N))\n\n    # --- Step 3: Correct velocity and verify divergence ---\n\n    # Compute gradient of phi\n    grad_phi_x, grad_phi_y = grad(phi, h)\n    \n    # Compute corrected velocity u_n+1\n    u_np1 = u_star - alpha * grad_phi_x\n    v_np1 = v_star - alpha * grad_phi_y\n    \n    # Compute divergence of corrected velocity\n    div_u_np1 = div(u_np1, v_np1, h)\n    \n    # Compute the RMS error of the divergence constraint\n    error = np.sqrt(np.mean((div_u_np1 - S)**2))\n    \n    return error\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}