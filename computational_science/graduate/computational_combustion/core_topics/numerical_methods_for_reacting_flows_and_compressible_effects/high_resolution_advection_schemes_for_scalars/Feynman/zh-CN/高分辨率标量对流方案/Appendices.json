{
    "hands_on_practices": [
        {
            "introduction": "通量限制器是总变差减小（TVD）格式的核心，其作用是在平滑区域保持高精度，同时在间断处维持数值稳定性。本练习提供了一个具体的、分步的计算，使用单调中心（MC）限制器。通过处理一个给定的数据集 ，学习者将亲手体验限制器如何动态调整格式精度以防止非物理振荡，从而获得对高分辨率格式工作原理的直观理解。",
            "id": "4030707",
            "problem": "考虑一个与燃烧相关的被动标量（例如，混合分数）的一维标量平流方程，其形式为 $\\partial_{t} \\phi + u \\, \\partial_{x} \\phi = 0$。该方程建立在一个均匀的有限体积网格上，网格中心位于 $x_{i}$，网格宽度为 $\\Delta x$。为了防止伪振荡，使用受限制的分段线性剖面进行高分辨率通量重构。具体而言，使用单调中心 (MC) 限制器来定义网格斜率 $\\sigma_{i}$，其表达式为 $\\sigma_{i} = \\operatorname{minmod}\\!\\left( \\frac{\\phi_{i+1} - \\phi_{i-1}}{2}, \\, 2(\\phi_{i} - \\phi_{i-1}), \\, 2(\\phi_{i+1} - \\phi_{i}) \\right)$，其中 minmod 算子定义为 $\\operatorname{minmod}(a,b,c) = \\begin{cases} \\min\\{|a|,|b|,|c|\\} \\, \\operatorname{sign}(a),  \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b)=\\operatorname{sign}(c), \\\\ 0,  \\text{otherwise.} \\end{cases}$。受限制的分段线性重构得到界面状态 $\\phi_{i+1/2}^{L} = \\phi_{i} + \\frac{1}{2}\\sigma_{i}$ 和 $\\phi_{i+1/2}^{R} = \\phi_{i+1} - \\frac{1}{2}\\sigma_{i+1}$。\n\n给定一个离散数据集，该数据集包含光滑区域和不连续区域，代表了计算燃烧应用中的情况。网格间距均匀，为 $\\Delta x = 0.01$，平流速度为 $u = -1$。在索引 $i=-1,0,1,2,3,4$ 处，网格平均标量值分别为\n$\\phi_{-1} = 0.1800$，$\\phi_{0} = 0.2474$，$\\phi_{1} = 0.3120$，$\\phi_{2} = 0.3716$，$\\phi_{3} = 0.9000$ 和 $\\phi_{4} = 0.9000$。该数据集在 $i=0,1,2$ 上是光滑且单调递增的，并在 $i=2$ 和 $i=3$ 之间包含一个跳跃。\n\n从标量守恒定律和作为全变差递减 (TVD) 重构的 MC 限制器的定义出发，使用 MC 限制器计算在 $i=1$ 处的界面状态 $\\phi_{i+1/2}^{L}$ 和 $\\phi_{i+1/2}^{R}$。然后，在给定 $u0$（即通量中使用的迎风状态来自右侧）的情况下，评估此问题在界面 $x_{i+1/2}$ 处数值通量的局部精度阶 $p$。您的评估必须基于一个局部泰勒展开论证，该论证将限制器所做的选择与 $\\Delta x$ 中的截断误差缩放规律联系起来。\n\n将界面状态值四舍五入至五位有效数字。精度阶 $p$ 应以整数形式报告。将您的最终答案表示为一个行向量，按顺序包含 $\\phi_{i+1/2}^{L}$、$\\phi_{i+1/2}^{R}$ 和 $p$。标量值为无量纲。",
            "solution": "该问题要求计算被动标量 $\\phi$ 在 $i=1$ 的界面 $x_{i+1/2}$（即 $x_{3/2}$）处的重构界面状态，并随后确定该界面上数值通量的局部精度阶。流动由一维标量平流方程 $\\partial_{t} \\phi + u \\, \\partial_{x} \\phi = 0$ 控制，平流速度为常数 $u = -1$。通量重构使用分段线性剖面和单调中心 (MC) 限制器。\n\n任务分为两部分：首先，计算左、右界面状态 $\\phi_{3/2}^{L}$ 和 $\\phi_{3/2}^{R}$；其次，评估数值通量的局部精度阶 $p$。\n\n**第1部分：计算 $x_{3/2}$ 处的界面状态**\n\n界面状态由以下公式给出：\n$$ \\phi_{i+1/2}^{L} = \\phi_{i} + \\frac{1}{2}\\sigma_{i} $$\n$$ \\phi_{i+1/2}^{R} = \\phi_{i+1} - \\frac{1}{2}\\sigma_{i+1} $$\n对于 $i=1$ 处的界面，我们需要计算 $\\phi_{3/2}^{L}$ 和 $\\phi_{3/2}^{R}$。这需要计算受限斜率 $\\sigma_{1}$ 和 $\\sigma_{2}$。\n\n网格斜率 $\\sigma_i$ 由 MC 限制器确定：\n$$ \\sigma_{i} = \\operatorname{minmod}\\!\\left( \\frac{\\phi_{i+1} - \\phi_{i-1}}{2}, \\, 2(\\phi_{i} - \\phi_{i-1}), \\, 2(\\phi_{i+1} - \\phi_{i}) \\right) $$\n其中，如果所有参数符号相同，$\\operatorname{minmod}$ 算子返回绝对值最小的参数；否则返回0。\n\n给定的网格平均标量值为：\n$\\phi_{-1} = 0.1800$，$\\phi_{0} = 0.2474$，$\\phi_{1} = 0.3120$，$\\phi_{2} = 0.3716$，$\\phi_{3} = 0.9000$，以及 $\\phi_{4} = 0.9000$。\n\n首先，我们计算网格 $i=1$ 的斜率 $\\sigma_1$。$\\operatorname{minmod}$ 函数的参数为：\n1.  中心差分项：$a_1 = \\frac{\\phi_{2} - \\phi_{0}}{2} = \\frac{0.3716 - 0.2474}{2} = \\frac{0.1242}{2} = 0.0621$。\n2.  后向差分项（两倍）：$b_1 = 2(\\phi_{1} - \\phi_{0}) = 2(0.3120 - 0.2474) = 2(0.0646) = 0.1292$。\n3.  前向差分项（两倍）：$c_1 = 2(\\phi_{2} - \\phi_{1}) = 2(0.3716 - 0.3120) = 2(0.0596) = 0.1192$。\n\n所有三个参数 $a_1$、$b_1$ 和 $c_1$ 均为正。因此，$\\sigma_1$ 是它们绝对值的最小值：\n$$ \\sigma_1 = \\min\\{|0.0621|, |0.1292|, |0.1192|\\} = 0.0621 $$\n\n接下来，我们计算网格 $i=2$ 的斜率 $\\sigma_2$。参数为：\n1.  中心差分项：$a_2 = \\frac{\\phi_{3} - \\phi_{1}}{2} = \\frac{0.9000 - 0.3120}{2} = \\frac{0.5880}{2} = 0.2940$。\n2.  后向差分项（两倍）：$b_2 = 2(\\phi_{2} - \\phi_{1}) = 2(0.3716 - 0.3120) = 2(0.0596) = 0.1192$。\n3.  前向差分项（两倍）：$c_2 = 2(\\phi_{3} - \\phi_{2}) = 2(0.9000 - 0.3716) = 2(0.5284) = 1.0568$。\n\n所有三个参数 $a_2$、$b_2$ 和 $c_2$ 均为正。因此，$\\sigma_2$ 是它们绝对值的最小值：\n$$ \\sigma_2 = \\min\\{|0.2940|, |0.1192|, |1.0568|\\} = 0.1192 $$\n限制器选择了后向差分项 $2(\\phi_2 - \\phi_1)$，这表明由于向 $\\phi_3=0.9000$ 的跳跃，在网格 $2$ 前方的梯度正在变陡。\n\n现在我们可以计算 $x_{3/2}$ 处的界面状态：\n$$ \\phi_{3/2}^{L} = \\phi_{1} + \\frac{1}{2}\\sigma_{1} = 0.3120 + \\frac{1}{2}(0.0621) = 0.3120 + 0.03105 = 0.34305 $$\n$$ \\phi_{3/2}^{R} = \\phi_{2} - \\frac{1}{2}\\sigma_{2} = 0.3716 - \\frac{1}{2}(0.1192) = 0.3716 - 0.0596 = 0.3120 $$\n四舍五入到五位有效数字，界面状态为 $\\phi_{3/2}^{L} = 0.34305$ 和 $\\phi_{3/2}^{R} = 0.31200$。\n\n**第2部分：局部精度阶的评估**\n\n标量平流方程在界面 $x_{i+1/2}$ 处的数值通量为 $F_{i+1/2} = u \\phi_{i+1/2}^{\\text{upwind}}$。由于平流速度为负（$u = -1$），“迎风”方向来自右侧。因此，界面 $x_{3/2}$ 处的通量由右侧状态 $\\phi_{3/2}^{R}$ 确定：\n$$ F_{3/2} = u \\, \\phi_{3/2}^{R} $$\n通量的局部精度阶 $p$ 由重构状态的误差阶数确定，即 $(\\phi_{3/2}^{R} - \\phi(x_{3/2}))$ 如何随网格间距 $\\Delta x$ 缩放。这里，$\\phi(x_{3/2})$ 是界面处的精确解。\n\n根据我们的计算，我们得到 $\\phi_{3/2}^{R} = 0.3120$，这恰好是网格平均值 $\\phi_1$。这是因为限制器选择了 $\\sigma_2 = 2(\\phi_2 - \\phi_1)$，导致 $\\phi_{3/2}^{R} = \\phi_2 - \\frac{1}{2}(2(\\phi_2 - \\phi_1)) = \\phi_1$。\n\n因此，数值格式正在使用来自顺风网格（网格1）的网格平均值作为界面 $x_{3/2}$ 处通量计算的状态。我们现在分析与此选择相关的截断误差。\n\n让我们进行泰勒级数展开。网格中心是 $x_1$，界面位于 $x_{3/2} = x_1 + \\Delta x/2$。对于光滑解，网格平均值 $\\phi_1$ 与点值 $\\phi(x_1)$ 的关系为 $\\phi_1 = \\phi(x_1) + O(\\Delta x^2)$。界面处的精确值可以在 $x_1$ 附近展开：\n$$ \\phi(x_{3/2}) = \\phi(x_1 + \\Delta x/2) = \\phi(x_1) + \\frac{\\Delta x}{2}\\phi'(x_1) + \\frac{1}{2}\\left(\\frac{\\Delta x}{2}\\right)^2 \\phi''(x_1) + \\dots = \\phi(x_1) + \\frac{\\Delta x}{2}\\phi'(x_1) + O(\\Delta x^2) $$\n重构状态的误差为：\n$$ \\text{Error} = \\phi_{3/2}^{R} - \\phi(x_{3/2}) = \\phi_1 - \\phi(x_{3/2}) $$\n代入展开式：\n$$ \\text{Error} = (\\phi(x_1) + O(\\Delta x^2)) - \\left(\\phi(x_1) + \\frac{\\Delta x}{2}\\phi'(x_1) + O(\\Delta x^2)\\right) $$\n$$ \\text{Error} = -\\frac{\\Delta x}{2}\\phi'(x_1) + O(\\Delta x^2) $$\n误差中的主导项与 $\\Delta x^1$ 成正比。这表明通量的局部截断误差是一阶的。陡峭梯度的存在迫使 TVD 限制器局部降低格式的精度以防止伪振荡，导致在此特定界面处的通量为一阶精度。\n\n因此，局部精度阶为 $p=1$。\n\n需要报告的最终值为 $\\phi_{3/2}^{L}$、$\\phi_{3/2}^{R}$ 和 $p$。\n$\\phi_{3/2}^{L} = 0.34305$\n$\\phi_{3/2}^{R} = 0.31200$\n$p = 1$\n按要求将这些值排列成一个行向量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.34305  0.31200  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "一个稳定的空间离散格式本身并不足够；时间积分方法也必须保持其期望的性质，例如单调性。这正是强稳定性保持（SSP）时间积分方法的用武之地。本分析练习  深入探讨了应用广泛的TVD RK3方法的内部结构，让学习者能够推导出其SSP系数，并理解该系数如何决定整个数值格式所允许的最大稳定时间步长。",
            "id": "4030716",
            "problem": "考虑计算燃烧学中标量的一维线性平流问题，其控制方程为守恒律 $\\partial \\phi / \\partial t + a \\, \\partial \\phi / \\partial x = 0$，其中波速 $a  0$ 为常数。设空间离散化采用半离散守恒全变差递减 (TVD) 格式，得到半离散常微分方程组 $\\mathrm{d} \\boldsymbol{u} / \\mathrm{d} t = \\boldsymbol{L}(\\boldsymbol{u})$，其中 $\\boldsymbol{u}$ 汇集了网格平均的标量值，$\\boldsymbol{L}$ 是一个与通量限制上风离散化相关的 Lipschitz 连续单调算子。一个经过充分检验的事实是，前向欧拉时间步进格式 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n})$ 能够保持半离散格式的 TVD 性质，条件是 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a \\, \\Delta t / \\Delta x$ 满足 $\\nu \\le \\nu_{\\mathrm{FE}}$，并且对于这样的一维 TVD 空间离散化，$\\nu_{\\mathrm{FE}} = 1$。\n\n现在，使用被称为 TVD RK3 的强稳定性保持 (SSP) 三阶段三阶 Runge–Kutta 方法在时间上推进解。用 $\\boldsymbol{u}^{(k)}$ 表示阶段值，该方法如下：\n$$\n\\boldsymbol{u}^{(1)} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n}),\n$$\n$$\n\\boldsymbol{u}^{(2)} = \\frac{3}{4} \\, \\boldsymbol{u}^{n} + \\frac{1}{4} \\left( \\boldsymbol{u}^{(1)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)}) \\right),\n$$\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{(3)} = \\frac{1}{3} \\, \\boldsymbol{u}^{n} + \\frac{2}{3} \\left( \\boldsymbol{u}^{(2)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(2)}) \\right).\n$$\n\n仅使用 SSP 的基本原理——即，如果一个显式时间积分器可以表示为前向欧拉步的凸组合，那么它将保持前向欧拉方法的任何强稳定性性质——计算 TVD RK3 方法的 SSP 系数 $C$。然后，使用前向欧拉方法的界限 $\\nu_{\\mathrm{FE}} = 1$，说明当 TVD RK3 方法与给定的 TVD 空间离散化配对时，为保持单调性所允许的最大 CFL 数 $\\nu_{\\max}$ 是多少。以两个无量纲数的形式给出你的最终答案，顺序为 $C$ 和 $\\nu_{\\max}$。无需四舍五入，请给出精确值。",
            "solution": "问题要求我们确定给定的三阶段三阶 Runge-Kutta 方法 (TVD RK3) 的强稳定性保持 (SSP) 系数，记为 $C$；然后求出当该方法应用于一个半离散 TVD 格式时（对于该格式，前向欧拉方法在 $\\nu_{\\mathrm{FE}} = 1$ 时是稳定的）所允许的最大 Courant–Friedrichs–Lewy (CFL) 数 $\\nu_{\\max}$。\n\n首先，我们对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   控制偏微分方程为一维线性平流方程：$\\partial \\phi / \\partial t + a \\, \\partial \\phi / \\partial x = 0$，其中波速 $a  0$ 为常数。\n-   空间离散化采用半离散守恒全变差递减 (TVD) 格式，得到一个常微分方程组：$\\mathrm{d} \\boldsymbol{u} / \\mathrm{d} t = \\boldsymbol{L}(\\boldsymbol{u})$。\n-   算子 $\\boldsymbol{L}$ 是 Lipschitz 连续且单调的。\n-   前向欧拉时间步进格式 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n})$ 是 TVD 的，条件是 CFL 数 $\\nu = a \\, \\Delta t / \\Delta x$ 满足 $\\nu \\le \\nu_{\\mathrm{FE}}$。\n-   对于给定的空间离散化，前向欧拉方法的特定 CFL 极限为 $\\nu_{\\mathrm{FE}} = 1$。\n-   时间积分方法为 TVD RK3 格式：\n    $$\n    \\boldsymbol{u}^{(1)} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n})\n    $$\n    $$\n    \\boldsymbol{u}^{(2)} = \\frac{3}{4} \\, \\boldsymbol{u}^{n} + \\frac{1}{4} \\left( \\boldsymbol{u}^{(1)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)}) \\right)\n    $$\n    $$\n    \\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{(3)} = \\frac{1}{3} \\, \\boldsymbol{u}^{n} + \\frac{2}{3} \\left( \\boldsymbol{u}^{(2)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(2)}) \\right)\n    $$\n-   SSP 的基本原理陈述如下：如果一个显式时间积分器可以表示为前向欧拉步的凸组合，则该积分器是 SSP 的。\n-   任务是计算 SSP 系数 $C$ 以及由此产生的最大 CFL 数 $\\nu_{\\max}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。线性平流方程是双曲守恒律的基本模型。TVD 格式、通量限制器和 SSP Runge-Kutta 方法是计算流体动力学和数值分析中的标准、成熟的课题。TVD RK3 格式以标准且广泛使用的形式给出。问题是适定的，提供了所有必要信息且无矛盾之处。语言客观精确。该问题是偏微分方程数值方法分析中的一个标准练习。\n\n**步骤3：结论与行动**\n问题有效。我们着手解决它。\n\n**求解推导**\n“SSP 基本原理”指出，该方法必须能表示为前向欧拉步的凸组合。分析此问题的一种形式化和通用的方法是，将 Runge-Kutta 方法表示为 Shu-Osher 形式。设 $\\boldsymbol{u}^{(0)} = \\boldsymbol{u}^n$。一个通用的 $m$ 阶段 SSP Runge-Kutta 方法可写为：\n$$\n\\boldsymbol{u}^{(i)} = \\sum_{k=0}^{i-1} \\left( \\alpha_{ik} \\boldsymbol{u}^{(k)} + \\beta_{ik} \\Delta t \\boldsymbol{L}(\\boldsymbol{u}^{(k)}) \\right), \\quad \\text{for } i = 1, \\dots, m\n$$\n最终解为 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{(m)}$。为使该方法成为稳定步的凸组合，系数必须对每个阶段 $i$ 满足 $\\alpha_{ik} \\ge 0$，$\\beta_{ik} \\ge 0$，以及 $\\sum_{k=0}^{i-1} \\alpha_{ik} = 1$。\n\n我们重写给定的 TVD RK3 方法的每个阶段，以匹配此形式，并识别出系数 $\\alpha_{ik}$ 和 $\\beta_{ik}$。\n\n**阶段 1：**\n第一阶段给出为 $\\boldsymbol{u}^{(1)} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n})$。设 $\\boldsymbol{u}^{(0)} = \\boldsymbol{u}^n$，则该式变为：\n$$\n\\boldsymbol{u}^{(1)} = 1 \\cdot \\boldsymbol{u}^{(0)} + 1 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(0)})\n$$\n将此与 $i=1$ 的通用形式进行比较，我们识别出 $\\alpha_{10} = 1$ 和 $\\beta_{10} = 1$。条件得到满足：$\\alpha_{10} \\ge 0$ 且 $\\alpha$ 系数之和为 1。\n\n**阶段 2：**\n第二阶段为 $\\boldsymbol{u}^{(2)} = \\frac{3}{4} \\, \\boldsymbol{u}^{n} + \\frac{1}{4} \\left( \\boldsymbol{u}^{(1)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)}) \\right)$。我们可以将其写为：\n$$\n\\boldsymbol{u}^{(2)} = \\frac{3}{4} \\, \\boldsymbol{u}^{(0)} + \\frac{1}{4} \\, \\boldsymbol{u}^{(1)} + 0 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(0)}) + \\frac{1}{4} \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)})\n$$\n与 $i=2$ 的通用形式进行比较，我们识别出：\n$\\alpha_{20} = \\frac{3}{4}$, $\\alpha_{21} = \\frac{1}{4}$\n$\\beta_{20} = 0$, $\\beta_{21} = \\frac{1}{4}$\n条件得到满足：$\\alpha_{20}, \\alpha_{21} \\ge 0$ 且 $\\alpha_{20} + \\alpha_{21} = \\frac{3}{4} + \\frac{1}{4} = 1$。\n\n**阶段 3：**\n最终阶段为 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{(3)} = \\frac{1}{3} \\, \\boldsymbol{u}^{n} + \\frac{2}{3} \\left( \\boldsymbol{u}^{(2)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(2)}) \\right)$。我们将其重写为：\n$$\n\\boldsymbol{u}^{(3)} = \\frac{1}{3} \\, \\boldsymbol{u}^{(0)} + 0 \\cdot \\boldsymbol{u}^{(1)} + \\frac{2}{3} \\, \\boldsymbol{u}^{(2)} + 0 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(0)}) + 0 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)}) + \\frac{2}{3} \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(2)})\n$$\n与 $i=3$ 的通用形式进行比较，我们识别出：\n$\\alpha_{30} = \\frac{1}{3}$, $\\alpha_{31} = 0$, $\\alpha_{32} = \\frac{2}{3}$\n$\\beta_{30} = 0$, $\\beta_{31} = 0$, $\\beta_{32} = \\frac{2}{3}$\n条件得到满足：$\\alpha_{30}, \\alpha_{31}, \\alpha_{32} \\ge 0$ 且 $\\alpha_{30} + \\alpha_{31} + \\alpha_{32} = \\frac{1}{3} + 0 + \\frac{2}{3} = 1$。\n\nSSP 性质依赖于将每个阶段重写为前向欧拉步的凸组合。对于任何 $\\alpha_{ik}  0$ 的项，我们可以写出：\n$$\n\\alpha_{ik} \\boldsymbol{u}^{(k)} + \\beta_{ik} \\Delta t \\boldsymbol{L}(\\boldsymbol{u}^{(k)}) = \\alpha_{ik} \\left( \\boldsymbol{u}^{(k)} + \\frac{\\beta_{ik}}{\\alpha_{ik}} \\Delta t \\boldsymbol{L}(\\boldsymbol{u}^{(k)}) \\right)\n$$\n括号中的项是一个前向欧拉步，其有效时间步长为 $(\\beta_{ik}/\\alpha_{ik})\\Delta t$。为使强稳定性性质成立，每个这样的有效时间步长都不能大于前向欧拉方法本身的稳定时间步长 $\\Delta t_{\\mathrm{FE}}$。\n$$\n\\frac{\\beta_{ik}}{\\alpha_{ik}} \\Delta t \\le \\Delta t_{\\mathrm{FE}}\n$$\n这个条件必须对所有 $\\beta_{ik}  0$ 的配对 $(i, k)$ 成立。为确保该条件对整个格式都成立，时间步长 $\\Delta t$ 必须满足这些约束中最严格的一个：\n$$\n\\Delta t \\le \\min_{i,k | \\beta_{ik}0} \\left( \\frac{\\alpha_{ik}}{\\beta_{ik}} \\right) \\Delta t_{\\mathrm{FE}}\n$$\nSSP 系数 $C$ 定义为这个最小值。\n$$\nC = \\min_{i,k | \\beta_{ik}0} \\left( \\frac{\\alpha_{ik}}{\\beta_{ik}} \\right)\n$$\n现在我们使用已找到的系数来计算 TVD RK3 方法的这个值。$\\beta_{ik}0$ 的配对 $(i,k)$ 是 $(1,0)$, $(2,1)$ 和 $(3,2)$。\n- 对于 $(i,k)=(1,0)$: $\\frac{\\alpha_{10}}{\\beta_{10}} = \\frac{1}{1} = 1$。\n- 对于 $(i,k)=(2,1)$: $\\frac{\\alpha_{21}}{\\beta_{21}} = \\frac{1/4}{1/4} = 1$。\n- 对于 $(i,k)=(3,2)$: $\\frac{\\alpha_{32}}{\\beta_{32}} = \\frac{2/3}{2/3} = 1$。\n\n这些值的最小值为 1。因此，SSP 系数 $C=1$。\n\nSSP-RK 方法的稳定性条件是 $\\Delta t \\le C \\cdot \\Delta t_{\\mathrm{FE}}$。我们可以将其转化为关于 CFL 数 $\\nu = a \\Delta t / \\Delta x$ 的条件。前向欧拉方法的稳定性约束是 $\\nu_{\\mathrm{FE}} = a \\Delta t_{\\mathrm{FE}} / \\Delta x$。因此：\n$$\n\\frac{a \\Delta t}{\\Delta x} \\le C \\cdot \\frac{a \\Delta t_{\\mathrm{FE}}}{\\Delta x} \\implies \\nu \\le C \\cdot \\nu_{\\mathrm{FE}}\n$$\nSSP-RK 格式所允许的最大 CFL 数是 $\\nu_{\\max} = C \\cdot \\nu_{\\mathrm{FE}}$。\n鉴于 $\\nu_{\\mathrm{FE}} = 1$ 且我们已计算出 $C=1$，所允许的最大 CFL 数是：\n$$\n\\nu_{\\max} = 1 \\cdot 1 = 1\n$$\n所要求的两个无量纲数是 SSP 系数 $C$ 和所允许的最大 CFL 数 $\\nu_{\\max}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本章最后一个也是最全面的练习是构建并验证一个完整的高分辨率求解器。这个编程练习  采用了“人造解方法”（Method of Manufactured Solutions, MMS），这是一种用于量化数值程序准确性的强大标准技术。通过编写一个带有SSP-RK2积分器的MUSCL-TVD格式，并将其计算结果与一个已知的精确解进行比较，学习者将掌握代码验证这一关键技能，并确认其求解器达到了理论收敛精度。",
            "id": "4030747",
            "problem": "考虑一维周期性域 $x\\in[0,1]$，其中速度 $u\\in\\mathbb{R}$ 在空间上是均匀的。设标量场 $\\phi(x,t)$ 满足守恒律\n$$\n\\partial_t \\phi(x,t) + \\partial_x\\left(u\\,\\phi(x,t)\\right) = S(x,t),\n$$\n其中 $S(x,t)$ 是通过人造解方法 (Method of Manufactured Solutions, MMS) 构造的源项，以便得到一个已知的闭式精确解。定义人造解为\n$$\n\\phi_{\\mathrm{ex}}(x,t) = \\sin\\left(2\\pi x\\right)\\cos\\left(2\\pi t\\right) + \\frac{1}{4}\\,\\cos\\left(4\\pi x - t\\right),\n$$\n其中速度 $u$ 为常数，源项 $S(x,t)$ 的选择要确保当 $\\phi=\\phi_{\\mathrm{ex}}$ 时，该偏微分方程得到精确满足。具体来说，\n$$\nS(x,t) = \\partial_t \\phi_{\\mathrm{ex}}(x,t) + u\\,\\partial_x \\phi_{\\mathrm{ex}}(x,t).\n$$\n您必须实现一个适用于燃烧领域计算流体力学（计算燃烧学）的高分辨率平流求解器。使用带有 van Leer 总变差递减 (TVD) 斜率限制器的守恒律单调上游中心格式 (MUSCL) 对通量梯度进行空间离散化，并使用二阶强保稳 Runge-Kutta (SSP RK2) 方法进行时间积分。施加周期性边界条件。空间离散化必须使用受限斜率在界面处重构左右状态，并相应地计算迎风通量 $F_{i+1/2}=u\\,\\phi^{\\mathrm{upwind}}$。时间积分格式必须将解从 $t=0$ 推进到指定的最终时间 $T$。\n\n数值测试框架必须计算最终时间的离散 $\\ell^2$ 误差，\n$$\n\\mathcal{E} = \\left(\\Delta x\\,\\sum_{i=0}^{N_x-1} \\left(\\phi_i(T) - \\phi_{\\mathrm{ex}}(x_i,T)\\right)^2\\right)^{1/2},\n$$\n其中 $N_x$ 是均匀间隔的网格单元数，$\\Delta x = 1/N_x$，而 $x_i = \\left(i+\\frac{1}{2}\\right)\\Delta x$ 是网格中心。对于每个测试，使用 $\\phi(x,0) = \\phi_{\\mathrm{ex}}(x,0)$ 初始化，并用您的求解器将解推进到指定的 $T$。您可以假定使用无量纲变量；不需要物理单位。\n\n您的程序必须执行以下三组测试并汇总其结果：\n\n1. 空间收敛性研究（一般情况）：\n   - 使用恒定速度 $u = 0.7$，最终时间 $T = 0.2$，以及 Courant–Friedrichs–Lewy (CFL) 数 $\\mathrm{CFL} = 0.4$。\n   - 将时间步长计算为 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/|u|$ 以确保稳定性。\n   - 对 $N_x \\in \\{50,100,200,400\\}$ 进行运行，并计算每个 $N_x$ 在 $t=T$ 时的离散 $\\ell^2$ 误差 $\\mathcal{E}$。\n   - 报告观测到的空间阶数 $p$，其定义为在一组 $(\\Delta x,\\mathcal{E})$ 值上通过线性回归得到的 $\\log(\\mathcal{E})$ 对 $\\log(\\Delta x)$ 的斜率。\n\n2. 时间收敛性研究（关注时间精度）：\n   - 使用恒定速度 $u = 0.7$，最终时间 $T = 0.2$，以及精细的空间分辨率 $N_x = 800$。\n   - 设 $\\mathrm{CFL}_{\\max} = 0.9$，并计算最大稳定时间步长 $\\Delta t_{\\max} = \\mathrm{CFL}_{\\max}\\,\\Delta x/|u|$。\n   - 使用时间步长 $\\Delta t \\in \\{0.8\\,\\Delta t_{\\max},\\,0.4\\,\\Delta t_{\\max},\\,0.2\\,\\Delta t_{\\max},\\,0.1\\,\\Delta t_{\\max}\\}$ 进行运行，并计算每个 $\\Delta t$ 在 $t=T$ 时的离散 $\\ell^2$ 误差 $\\mathcal{E}$。\n   - 报告观测到的时间阶数 $q$，其定义为在一组 $(\\Delta t,\\mathcal{E})$ 值上通过线性回归得到的 $\\log(\\mathcal{E})$ 对 $\\log(\\Delta t)$ 的斜率。\n\n3. 边界情况（边界条件与退化情况检查）：\n   - 使用 $u = 0$，最终时间 $T = 0.2$，$N_x = 50$，以及时间步长 $\\Delta t = T/200$。\n   - 由于当 $u=0$ 时平流项消失，方程简化为 $\\partial_t \\phi = S$，您的 SSP RK2 积分器应使用人造解的精确源项来求解此方程。\n   - 计算离散 $\\ell^2$ 误差 $\\mathcal{E}$，并返回一个表示 $\\mathcal{E}  5\\times 10^{-6}$ 是否成立的布尔值。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，具体为 $[p,q,\\mathrm{edge}]$，其中 $p$ 和 $q$ 是实数（浮点数），$\\mathrm{edge}$ 是一个布尔值。\n\n实现所需的定义和提醒：\n- 守恒律的单调上游中心格式 (MUSCL)：使用受限斜率 $s_i$ 重构界面状态，使得 $\\phi^{L}_{i+1/2} = \\phi_i + \\frac{1}{2}s_i$ 且 $\\phi^{R}_{i+1/2} = \\phi_{i+1} - \\frac{1}{2}s_{i+1}$。\n- Van Leer 总变差递减 (TVD) 斜率限制器：对于连续差分 $\\Delta_{i-1/2} = \\phi_i - \\phi_{i-1}$ 和 $\\Delta_{i+1/2} = \\phi_{i+1} - \\phi_i$，定义\n$$\ns_i = \\begin{cases}\n\\dfrac{2\\,\\Delta_{i-1/2}\\,\\Delta_{i+1/2}}{\\Delta_{i-1/2} + \\Delta_{i+1/2}},  \\text{if } \\Delta_{i-1/2}\\,\\Delta_{i+1/2}  0,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n- 恒定速度 u 的线性平流的迎风通量：$F_{i+1/2} = u\\,\\phi^{\\mathrm{upwind}}$，其中如果 $u0$，则 $\\phi^{\\mathrm{upwind}} = \\phi^{L}_{i+1/2}$；如果 $u0$，则 $\\phi^{\\mathrm{upwind}} = \\phi^{R}_{i+1/2}$。\n- 强保稳 Runge-Kutta (SSP RK2) 方法：通过以下方式推进\n$$\n\\phi^{(1)} = \\phi^n + \\Delta t\\,\\mathcal{R}(\\phi^n,t^n),\\quad\n\\phi^{n+1} = \\frac{1}{2}\\phi^n + \\frac{1}{2}\\left[\\phi^{(1)} + \\Delta t\\,\\mathcal{R}(\\phi^{(1)},t^n+\\Delta t)\\right],\n$$\n其中 $\\mathcal{R}(\\phi,t) = S(\\cdot,t) - \\partial_x(u\\,\\phi)$ 是半离散右端项，其空间算子由 MUSCL-TVD 方法离散化。\n\n请完全按照规定实现求解器并运行这三项研究。您的最终程序输出必须是 $[p,q,\\mathrm{edge}]$ 格式的单行文本，包含两个实数和一个布尔值。",
            "solution": "用户提供的问题陈述经过严格验证，被确定为**有效**。它代表了计算流体力学领域一个适定的、有科学依据的、客观的问题，特别关注于标量平流的高分辨率数值格式的验证。问题任务定义清晰，控制方程和数值方法是标准的且规定正确，人造解方法 (MMS) 为评估求解器的精度提供了一个鲁棒的框架。\n\n我们着手提供一个完整、系统的解决方案。\n\n### 1. 控制方程与人造解\n\n该问题涉及周期性域 $x\\in[0,1]$ 上的一维线性平流方程：\n$$\n\\partial_t \\phi + u\\,\\partial_x \\phi = S(x,t)\n$$\n其中 $\\phi(x,t)$ 是一个标量场，$u$ 是一个恒定速度，$S(x,t)$ 是一个源项。\n\n采用人造解方法 (MMS)，为此预设了一个精确的解析解 $\\phi_{\\mathrm{ex}}(x,t)$，并导出源项 $S(x,t)$ 以确保 $\\phi_{\\mathrm{ex}}$ 能恒满足控制方程。人造解由下式给出：\n$$\n\\phi_{\\mathrm{ex}}(x,t) = \\sin\\left(2\\pi x\\right)\\cos\\left(2\\pi t\\right) + \\frac{1}{4}\\,\\cos\\left(4\\pi x - t\\right)\n$$\n因此，源项 $S(x,t)$ 被定义为 $S(x,t) = \\partial_t \\phi_{\\mathrm{ex}} + u\\,\\partial_x \\phi_{\\mathrm{ex}}$。所需的偏导数是：\n$$\n\\partial_t \\phi_{\\mathrm{ex}}(x,t) = -2\\pi \\sin(2\\pi x)\\sin(2\\pi t) + \\frac{1}{4} \\sin(4\\pi x - t)\n$$\n$$\n\\partial_x \\phi_{\\mathrm{ex}}(x,t) = 2\\pi \\cos(2\\pi x)\\cos(2\\pi t) - \\pi \\sin(4\\pi x - t)\n$$\n代入这些表达式可得源项的显式形式：\n$$\nS(x,t) = -2\\pi \\sin(2\\pi x)\\sin(2\\pi t) + \\frac{1}{4} \\sin(4\\pi x - t) + u \\left( 2\\pi \\cos(2\\pi x)\\cos(2\\pi t) - \\pi \\sin(4\\pi x - t) \\right)\n$$\n\n### 2. 数值离散化\n\n解在包含 $N_x$ 个网格单元的均匀网格上进行时间推进，网格单元宽度为 $\\Delta x = 1/N_x$，网格单元中心为 $x_i = (i+1/2)\\Delta x$，其中 $i=0, \\dots, N_x-1$。采用有限体积法，其中网格单元平均量 $\\phi_i(t) \\approx \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi(x,t)\\,dx$ 根据半离散方程演化：\n$$\n\\frac{d\\phi_i}{dt} + \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = S(x_i, t)\n$$\n这里，$F_{i\\pm 1/2}$ 是网格单元界面处的数值通量。此常微分方程组 (ODEs) 的右端项 $\\mathcal{R}_i(\\phi, t) = S(x_i, t) - (F_{i+1/2} - F_{i-1/2})/\\Delta x$ 将进行时间积分。\n\n#### 2.1. 空间离散化：MUSCL-TVD 格式\n\n为达到二阶空间精度并避免在陡峭梯度附近产生伪振荡，采用了守恒律的单调上游中心格式 (MUSCL)。该格式在每个网格单元内重构解的分段线性表示，从而确定网格单元界面处的值（$\\phi^L_{i+1/2}$ 和 $\\phi^R_{i+1/2}$）。\n\n关键步骤如下：\n\n1.  **斜率限制**：为确保总变差递减 (TVD) 特性，线性重构的斜率受到限制。问题规定使用 van Leer 限制器。对于每个网格单元 $i$，我们根据相邻网格单元的差分 $\\Delta_{i-1/2} = \\phi_i - \\phi_{i-1}$ 和 $\\Delta_{i+1/2} = \\phi_{i+1} - \\phi_i$ 计算一个受限差分，记为 $s_i$：\n    $$\n    s_i = \\begin{cases}\n    \\dfrac{2\\,\\Delta_{i-1/2}\\,\\Delta_{i+1/2}}{\\Delta_{i-1/2} + \\Delta_{i+1/2}},  \\text{if } \\Delta_{i-1/2}\\,\\Delta_{i+1/2} > 0,\\\\\n    0,  \\text{otherwise}.\n    \\end{cases}\n    $$\n    这个 $s_i$ 的公式对应于 $\\sigma_i \\Delta x$，其中 $\\sigma_i$ 是受限斜率。条件 $\\Delta_{i-1/2}\\,\\Delta_{i+1/2} > 0$ 将高阶重构限制在解是单调的区域，并在局部极值点将斜率设为零以防止振荡。周期性边界条件通过使用虚拟单元来处理，使得 $\\phi_{-1} = \\phi_{N_x-1}$ 和 $\\phi_{N_x} = \\phi_0$。\n\n2.  **界面重构**：使用受限差分 $s_i$ 来重构每个界面 $x_{i+1/2}$ 左右两侧的标量值：\n    $$\n    \\phi^{L}_{i+1/2} = \\phi_i + \\frac{1}{2}s_i\n    $$\n    $$\n    \\phi^{R}_{i+1/2} = \\phi_{i+1} - \\frac{1}{2}s_{i+1}\n    $$\n\n3.  **迎风通量**：数值通量 $F_{i+1/2}$ 根据恒定速度 $u$ 的符号，使用迎风准则计算：\n    $$\n    F_{i+1/2} = u\\,\\phi^{\\mathrm{upwind}}_{i+1/2} = \\begin{cases}\n    u\\,\\phi^{L}_{i+1/2},  \\text{if } u > 0, \\\\\n    u\\,\\phi^{R}_{i+1/2},  \\text{if } u  0, \\\\\n    0,  \\text{if } u = 0.\n    \\end{cases}\n    $$\n\n#### 2.2. 时间离散化：SSP RK2 格式\n\n该常微分方程组使用二阶强保稳 Runge-Kutta (SSP RK2) 方法进行时间积分。给定时间 $t^n$ 的解向量 $\\phi^n$，下一个时间步 $t^{n+1}$ 的解 $\\phi^{n+1}$ 通过两个阶段计算得出：\n$$\n\\phi^{(1)} = \\phi^n + \\Delta t\\,\\mathcal{R}(\\phi^n, t^n)\n$$\n$$\n\\phi^{n+1} = \\frac{1}{2}\\phi^n + \\frac{1}{2}\\left[\\phi^{(1)} + \\Delta t\\,\\mathcal{R}(\\phi^{(1)}, t^n + \\Delta t)\\right]\n$$\n其中 $\\mathcal{R}(\\phi, t)$ 是所有网格单元的半离散残差向量，$\\Delta t$ 是为满足 Courant-Friedrichs-Lewy (CFL) 稳定性条件而选择的时间步长。\n\n### 3. 验证与误差分析\n\n通过执行问题陈述中列出的三项研究来验证所实现的求解器。其精度由最终时间 $T$ 的离散 $\\ell^2$ 误差范数量化：\n$$\n\\mathcal{E} = \\left(\\Delta x\\,\\sum_{i=0}^{N_x-1} \\left(\\phi_i(T) - \\phi_{\\mathrm{ex}}(x_i,T)\\right)^2\\right)^{1/2}\n$$\n观测到的空间收敛阶 ($p$) 和时间收敛阶 ($q$) 分别通过对误差的对数与网格间距或时间步长的对数进行线性回归来计算。$u=0$ 的边界情况验证了源项积分的正确实现以及平流格式在零速度极限下的鲁棒性。",
            "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to run the three specified test cases and print the results.\n    \"\"\"\n\n    # Analytic helper functions for the Method of Manufactured Solutions\n    def phi_exact(x, t):\n        \"\"\"Computes the exact manufactured solution phi_ex(x, t).\"\"\"\n        term1 = np.sin(2 * np.pi * x) * np.cos(2 * np.pi * t)\n        term2 = 0.25 * np.cos(4 * np.pi * x - t)\n        return term1 + term2\n\n    def source_term_func(x, t, u):\n        \"\"\"Computes the source term S(x, t, u) for the manufactured solution.\"\"\"\n        dphi_dt = -2 * np.pi * np.sin(2 * np.pi * x) * np.sin(2 * np.pi * t) + \\\n                  0.25 * np.sin(4 * np.pi * x - t)\n        dphi_dx = 2 * np.pi * np.cos(2 * np.pi * x) * np.cos(2 * np.pi * t) - \\\n                  np.pi * np.sin(4 * np.pi * x - t)\n        return dphi_dt + u * dphi_dx\n\n    def calculate_rhs(phi, x_grid, t, u, dx, Nx):\n        \"\"\"\n        Calculates the right-hand-side (RHS) of the semi-discrete equation\n        using the MUSCL-TVD scheme.\n        RHS = S(x,t) - (F_{i+1/2} - F_{i-1/2}) / dx\n        \"\"\"\n        # Pad the solution array with 1 ghost cell on each side for periodic BCs\n        phi_padded = np.pad(phi, (1, 1), 'wrap')\n\n        # 1. Calculate limited slopes using the van Leer limiter\n        delta_m = phi_padded[1:-1] - phi_padded[0:-2] # phi_i - phi_{i-1}\n        delta_p = phi_padded[2:] - phi_padded[1:-1]   # phi_{i+1} - phi_i\n        \n        product = delta_m * delta_p\n        slopes = np.zeros(Nx)\n        mask = product > 0\n        \n        # Denominator is delta_m + delta_p. If it's zero, product = 0, so mask is False.\n        # This naturally avoids division by zero.\n        denominator = delta_m[mask] + delta_p[mask]\n        slopes[mask] = (2.0 * product[mask]) / denominator\n\n        # 2. Reconstruct interface values and compute upwind flux\n        slopes_padded = np.pad(slopes, (1, 1), 'wrap')\n\n        # Values at left side of interface i+1/2, from cell i\n        phi_L = phi + 0.5 * slopes\n        \n        # Values at right side of interface i+1/2, from cell i+1\n        phi_R = phi_padded[2:] - 0.5 * slopes_padded[2:]\n\n        if u > 0:\n            phi_upwind = phi_L\n        elif u  0:\n            phi_upwind = phi_R\n        else: # u == 0\n            phi_upwind = np.zeros(Nx)\n\n        fluxes = u * phi_upwind  # Fluxes F_{i+1/2} for i=0..Nx-1\n\n        # 3. Compute flux divergence\n        fluxes_left = np.roll(fluxes, 1) # Fluxes F_{i-1/2}\n        flux_divergence = (fluxes - fluxes_left) / dx\n\n        # 4. Compute source term\n        source = source_term_func(x_grid, t, u)\n\n        return source - flux_divergence\n\n    def run_solver(Nx, T, u, dt_specified=None, cfl=None):\n        \"\"\"\n        Core solver that integrates the PDE from t=0 to t=T.\n        \"\"\"\n        dx = 1.0 / Nx\n        x_grid = (np.arange(Nx) + 0.5) * dx\n        \n        phi = phi_exact(x_grid, 0.0)\n        \n        t = 0.0\n        \n        if dt_specified is not None:\n            dt = dt_specified\n        elif cfl is not None:\n            if u == 0:\n                # Fallback for u=0 case as CFL-based dt would be infinite\n                dt = T / 1000 \n            else:\n                dt = cfl * dx / np.abs(u)\n        else:\n            raise ValueError(\"Either dt_specified or cfl must be provided.\")\n\n        while t  T:\n            # Adjust final time step to land exactly on T\n            current_dt = min(dt, T - t)\n            \n            # SSP RK2 Time Integration\n            # Stage 1\n            rhs1 = calculate_rhs(phi, x_grid, t, u, dx, Nx)\n            phi1 = phi + current_dt * rhs1\n            \n            # Stage 2\n            rhs2 = calculate_rhs(phi1, x_grid, t + current_dt, u, dx, Nx)\n            phi = 0.5 * phi + 0.5 * (phi1 + current_dt * rhs2)\n            \n            t += current_dt\n\n        # Compute L2 error\n        phi_final_exact = phi_exact(x_grid, T)\n        error = np.sqrt(dx * np.sum((phi - phi_final_exact)**2))\n        return error\n\n    # --- Test Case 1: Spatial Convergence ---\n    def test_spatial_convergence():\n        u = 0.7\n        T = 0.2\n        cfl = 0.4\n        Nx_values = [50, 100, 200, 400]\n        \n        log_dx = []\n        log_err = []\n        \n        for Nx in Nx_values:\n            error = run_solver(Nx=Nx, T=T, u=u, cfl=cfl)\n            dx = 1.0 / Nx\n            log_dx.append(np.log(dx))\n            log_err.append(np.log(error))\n            \n        # Linear regression to find the order of convergence\n        slope, _, _, _, _ = stats.linregress(log_dx, log_err)\n        return slope\n\n    # --- Test Case 2: Temporal Convergence ---\n    def test_temporal_convergence():\n        u = 0.7\n        T = 0.2\n        Nx = 800\n        cfl_max = 0.9\n        dx = 1.0 / Nx\n        dt_max = cfl_max * dx / np.abs(u)\n        dt_factors = [0.8, 0.4, 0.2, 0.1]\n        \n        log_dt = []\n        log_err = []\n        \n        for factor in dt_factors:\n            dt = factor * dt_max\n            error = run_solver(Nx=Nx, T=T, u=u, dt_specified=dt)\n            log_dt.append(np.log(dt))\n            log_err.append(np.log(error))\n            \n        slope, _, _, _, _ = stats.linregress(log_dt, log_err)\n        return slope\n\n    # --- Test Case 3: Edge Case (u=0) ---\n    def test_edge_case():\n        u = 0.0\n        T = 0.2\n        Nx = 50\n        dt = T / 200.0  # 0.001\n        \n        error = run_solver(Nx=Nx, T=T, u=u, dt_specified=dt)\n        return error  5e-6\n\n    # Run tests and collect results\n    p = test_spatial_convergence()\n    q = test_temporal_convergence()\n    edge_result = test_edge_case()\n\n    results = [p, q, edge_result]\n    \n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}