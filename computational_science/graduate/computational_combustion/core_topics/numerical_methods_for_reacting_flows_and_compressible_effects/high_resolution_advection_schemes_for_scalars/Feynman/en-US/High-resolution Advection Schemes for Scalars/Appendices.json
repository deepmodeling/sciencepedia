{
    "hands_on_practices": [
        {
            "introduction": "At the heart of any high-resolution scheme is the flux limiter, which intelligently navigates the trade-off between accuracy in smooth regions and stability at sharp gradients. This first exercise provides a direct, hands-on look at this mechanism using the Monotonized Central (MC) limiter. By manually computing the interface states and assessing the local order of accuracy for a given scalar profile, you will see precisely how the limiter's logic switches from a higher-order to a first-order reconstruction to prevent spurious oscillations .",
            "id": "4030707",
            "problem": "Consider the one-dimensional scalar advection equation for a combustion-relevant passive scalar (e.g., mixture fraction) given by $\\partial_{t} \\phi + u \\, \\partial_{x} \\phi = 0$, posed on a uniform finite volume mesh with cell centers at $x_{i}$ and cell width $\\Delta x$. High-resolution flux reconstruction is performed using piecewise linear profiles limited to prevent spurious oscillations. Specifically, the Monotonized Central (MC) limiter is used to define the cellwise slope $\\sigma_{i}$ as $\\sigma_{i} = \\operatorname{minmod}\\!\\left( \\frac{\\phi_{i+1} - \\phi_{i-1}}{2}, \\, 2(\\phi_{i} - \\phi_{i-1}), \\, 2(\\phi_{i+1} - \\phi_{i}) \\right)$, where the minmod operator is defined by $\\operatorname{minmod}(a,b,c) = \\begin{cases} \\min\\{|a|,|b|,|c|\\} \\, \\operatorname{sign}(a),  \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b)=\\operatorname{sign}(c), \\\\ 0,  \\text{otherwise.} \\end{cases}$. The limited piecewise linear reconstruction yields interface states $\\phi_{i+1/2}^{L} = \\phi_{i} + \\frac{1}{2}\\sigma_{i}$ and $\\phi_{i+1/2}^{R} = \\phi_{i+1} - \\frac{1}{2}\\sigma_{i+1}$.\n\nYou are given a discrete dataset that contains both smooth and discontinuous regions representative of computational combustion applications, with uniform grid spacing $\\Delta x = 0.01$ and advection speed $u = -1$. At indices $i=-1,0,1,2,3,4$, the cell-averaged scalar values are\n$\\phi_{-1} = 0.1800$, $\\phi_{0} = 0.2474$, $\\phi_{1} = 0.3120$, $\\phi_{2} = 0.3716$, $\\phi_{3} = 0.9000$, and $\\phi_{4} = 0.9000$. This dataset is smooth and monotone increasing over $i=0,1,2$ and contains a jump between $i=2$ and $i=3$.\n\nStarting from the scalar conservation law and the definition of the MC limiter as a Total Variation Diminishing (TVD) reconstruction, compute the interface states $\\phi_{i+1/2}^{L}$ and $\\phi_{i+1/2}^{R}$ at $i=1$ using the MC limiter. Then, assess the local order of accuracy $p$ of the numerical flux at the interface $x_{i+1/2}$ for this problem given $u0$ (that is, the upwind state used in the flux comes from the right). Your assessment must be grounded in a local Taylor expansion argument that relates the choice made by the limiter to the truncation error scaling in $\\Delta x$.\n\nRound the interface state values to five significant figures. The order $p$ is to be reported as an integer. Express your final answer as a row vector containing $\\phi_{i+1/2}^{L}$, $\\phi_{i+1/2}^{R}$, and $p$ in that order. The scalar values are dimensionless.",
            "solution": "The problem requires the computation of the reconstructed interface states of a passive scalar $\\phi$ at the interface $x_{i+1/2}$ for $i=1$ (i.e., at $x_{3/2}$) and the subsequent determination of the local order of accuracy of the numerical flux at this interface. The flow is governed by the one-dimensional scalar advection equation, $\\partial_{t} \\phi + u \\, \\partial_{x} \\phi = 0$, with a constant advection velocity $u = -1$. The flux reconstruction uses a piecewise linear profile with the Monotonized Central (MC) limiter.\n\nThe task is divided into two parts: first, the calculation of the left and right interface states, $\\phi_{3/2}^{L}$ and $\\phi_{3/2}^{R}$; second, the assessment of the local order of accuracy, $p$, for the numerical flux.\n\n**Part 1: Computation of Interface States at $x_{3/2}$**\n\nThe interface states are given by the formulae:\n$$ \\phi_{i+1/2}^{L} = \\phi_{i} + \\frac{1}{2}\\sigma_{i} $$\n$$ \\phi_{i+1/2}^{R} = \\phi_{i+1} - \\frac{1}{2}\\sigma_{i+1} $$\nFor the interface at $i=1$, we need to compute $\\phi_{3/2}^{L}$ and $\\phi_{3/2}^{R}$. This requires the calculation of the limited slopes $\\sigma_{1}$ and $\\sigma_{2}$.\n\nThe cellwise slope $\\sigma_i$ is determined by the MC limiter:\n$$ \\sigma_{i} = \\operatorname{minmod}\\!\\left( \\frac{\\phi_{i+1} - \\phi_{i-1}}{2}, \\, 2(\\phi_{i} - \\phi_{i-1}), \\, 2(\\phi_{i+1} - \\phi_{i}) \\right) $$\nwhere the $\\operatorname{minmod}$ operator returns the argument with the smallest absolute value if all arguments have the same sign, and $0$ otherwise.\n\nThe given cell-averaged scalar values are:\n$\\phi_{-1} = 0.1800$, $\\phi_{0} = 0.2474$, $\\phi_{1} = 0.3120$, $\\phi_{2} = 0.3716$, $\\phi_{3} = 0.9000$, and $\\phi_{4} = 0.9000$.\n\nFirst, we compute the slope $\\sigma_1$ for cell $i=1$. The arguments for the $\\operatorname{minmod}$ function are:\n1. Centered difference term: $a_1 = \\frac{\\phi_{2} - \\phi_{0}}{2} = \\frac{0.3716 - 0.2474}{2} = \\frac{0.1242}{2} = 0.0621$.\n2. Backward difference term (doubled): $b_1 = 2(\\phi_{1} - \\phi_{0}) = 2(0.3120 - 0.2474) = 2(0.0646) = 0.1292$.\n3. Forward difference term (doubled): $c_1 = 2(\\phi_{2} - \\phi_{1}) = 2(0.3716 - 0.3120) = 2(0.0596) = 0.1192$.\n\nAll three arguments $a_1$, $b_1$, and $c_1$ are positive. Therefore, $\\sigma_1$ is the minimum of their absolute values:\n$$ \\sigma_1 = \\min\\{|0.0621|, |0.1292|, |0.1192|\\} = 0.0621 $$\n\nNext, we compute the slope $\\sigma_2$ for cell $i=2$. The arguments are:\n1. Centered difference term: $a_2 = \\frac{\\phi_{3} - \\phi_{1}}{2} = \\frac{0.9000 - 0.3120}{2} = \\frac{0.5880}{2} = 0.2940$.\n2. Backward difference term (doubled): $b_2 = 2(\\phi_{2} - \\phi_{1}) = 2(0.3716 - 0.3120) = 2(0.0596) = 0.1192$.\n3. Forward difference term (doubled): $c_2 = 2(\\phi_{3} - \\phi_{2}) = 2(0.9000 - 0.3716) = 2(0.5284) = 1.0568$.\n\nAll three arguments $a_2$, $b_2$, and $c_2$ are positive. Therefore, $\\sigma_2$ is the minimum of their absolute values:\n$$ \\sigma_2 = \\min\\{|0.2940|, |0.1192|, |1.0568|\\} = 0.1192 $$\nThe limiter has selected the backward difference term $2(\\phi_2 - \\phi_1)$, which is indicative of a steepening gradient ahead of cell $2$, caused by the jump to $\\phi_3=0.9000$.\n\nNow we can compute the interface states at $x_{3/2}$:\n$$ \\phi_{3/2}^{L} = \\phi_{1} + \\frac{1}{2}\\sigma_{1} = 0.3120 + \\frac{1}{2}(0.0621) = 0.3120 + 0.03105 = 0.34305 $$\n$$ \\phi_{3/2}^{R} = \\phi_{2} - \\frac{1}{2}\\sigma_{2} = 0.3716 - \\frac{1}{2}(0.1192) = 0.3716 - 0.0596 = 0.3120 $$\nRounding to five significant figures, the interface states are $\\phi_{3/2}^{L} = 0.34305$ and $\\phi_{3/2}^{R} = 0.31200$.\n\n**Part 2: Assessment of the Local Order of Accuracy**\n\nThe numerical flux for the scalar advection equation at an interface $x_{i+1/2}$ is $F_{i+1/2} = u \\phi_{i+1/2}^{\\text{upwind}}$. Since the advection velocity is negative ($u = -1$), the \"upwind\" direction is from the right. Thus, the flux at interface $x_{3/2}$ is determined by the right state, $\\phi_{3/2}^{R}$:\n$$ F_{3/2} = u \\, \\phi_{3/2}^{R} $$\nThe local order of accuracy $p$ of the flux is determined by the order of the error in the reconstructed state, i.e., how $(\\phi_{3/2}^{R} - \\phi(x_{3/2}))$ scales with the grid spacing $\\Delta x$. Here, $\\phi(x_{3/2})$ is the exact solution at the interface.\n\nFrom our calculation, we found $\\phi_{3/2}^{R} = 0.3120$, which is exactly the cell-averaged value $\\phi_1$. This occurred because the limiter chose $\\sigma_2 = 2(\\phi_2 - \\phi_1)$, leading to $\\phi_{3/2}^{R} = \\phi_2 - \\frac{1}{2}(2(\\phi_2 - \\phi_1)) = \\phi_1$.\n\nThe numerical scheme is therefore using the cell-averaged value from the downwind cell, cell $1$, as the state for the flux calculation at interface $x_{3/2}$. We now analyze the truncation error associated with this choice.\n\nLet's perform a Taylor series expansion. The cell center is $x_1$, and the interface is at $x_{3/2} = x_1 + \\Delta x/2$. The cell average $\\phi_1$ is related to the point value $\\phi(x_1)$ by $\\phi_1 = \\phi(x_1) + O(\\Delta x^2)$ for a smooth solution. The exact value at the interface can be expanded around $x_1$:\n$$ \\phi(x_{3/2}) = \\phi(x_1 + \\Delta x/2) = \\phi(x_1) + \\frac{\\Delta x}{2}\\phi'(x_1) + \\frac{1}{2}\\left(\\frac{\\Delta x}{2}\\right)^2 \\phi''(x_1) + \\dots = \\phi(x_1) + \\frac{\\Delta x}{2}\\phi'(x_1) + O(\\Delta x^2) $$\nThe error in the reconstructed state is:\n$$ \\text{Error} = \\phi_{3/2}^{R} - \\phi(x_{3/2}) = \\phi_1 - \\phi(x_{3/2}) $$\nSubstituting the expansions:\n$$ \\text{Error} = (\\phi(x_1) + O(\\Delta x^2)) - \\left(\\phi(x_1) + \\frac{\\Delta x}{2}\\phi'(x_1) + O(\\Delta x^2)\\right) $$\n$$ \\text{Error} = -\\frac{\\Delta x}{2}\\phi'(x_1) + O(\\Delta x^2) $$\nThe leading term in the error is proportional to $\\Delta x^1$. This indicates that the local truncation error of the flux is of the first order. The presence of a sharp gradient has forced the TVD limiter to reduce the scheme's accuracy locally to prevent spurious oscillations, resulting in a first-order accurate flux at this specific interface.\n\nTherefore, the local order of accuracy is $p=1$.\n\nFinal values to be reported are $\\phi_{3/2}^{L}$, $\\phi_{3/2}^{R}$, and $p$.\n$\\phi_{3/2}^{L} = 0.34305$\n$\\phi_{3/2}^{R} = 0.31200$\n$p = 1$\nThese are arranged in a row vector as requested.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.34305  0.31200  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Once a spatially non-oscillatory discretization is designed, it is crucial that the time-stepping method preserves this desirable property. This is the role of Strong Stability Preserving (SSP) time integrators. This practice guides you through the analysis of the popular third-order SSP Runge-Kutta scheme, demonstrating how its stability is tied to that of the simpler forward Euler method . By deriving the scheme's SSP coefficient, you will learn how to determine the maximum allowable time step that guarantees monotonicity, a critical parameter for any stable and efficient simulation.",
            "id": "4030716",
            "problem": "Consider the one-dimensional linear advection of a scalar in computational combustion, governed by the conservation law $\\partial \\phi / \\partial t + a \\, \\partial \\phi / \\partial x = 0$ with constant wave speed $a  0$. Let the spatial discretization be a semi-discrete conservative Total Variation Diminishing (TVD) scheme producing a semi-discrete ordinary differential equation $\\mathrm{d} \\boldsymbol{u} / \\mathrm{d} t = \\boldsymbol{L}(\\boldsymbol{u})$, where $\\boldsymbol{u}$ collects cell-averaged scalar values and $\\boldsymbol{L}$ is a Lipschitz continuous, monotone operator associated with a flux-limited upwind discretization. It is a well-tested fact that forward Euler time stepping, $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n})$, preserves the TVD property of the semi-discrete scheme provided the Courant–Friedrichs–Lewy (CFL) number $\\nu = a \\, \\Delta t / \\Delta x$ satisfies $\\nu \\le \\nu_{\\mathrm{FE}}$, with $\\nu_{\\mathrm{FE}} = 1$ for such TVD spatial discretizations in one space dimension.\n\nNow advance the solution in time using the Strong Stability Preserving (SSP) three-stage third-order Runge–Kutta method known as TVD RK3. Denote stage values by $\\boldsymbol{u}^{(k)}$ and let the method be\n$$\n\\boldsymbol{u}^{(1)} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n}),\n$$\n$$\n\\boldsymbol{u}^{(2)} = \\frac{3}{4} \\, \\boldsymbol{u}^{n} + \\frac{1}{4} \\left( \\boldsymbol{u}^{(1)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)}) \\right),\n$$\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{(3)} = \\frac{1}{3} \\, \\boldsymbol{u}^{n} + \\frac{2}{3} \\left( \\boldsymbol{u}^{(2)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(2)}) \\right).\n$$\n\nUsing only the foundational SSP principle—namely, that an explicit time integrator preserves any forward Euler strong stability property if it can be represented as a convex combination of forward Euler steps—compute the SSP coefficient $C$ of the TVD RK3 method. Then, using the forward Euler bound $\\nu_{\\mathrm{FE}} = 1$, state the resulting maximum allowable CFL number $\\nu_{\\max}$ that preserves monotonicity when the TVD RK3 method is paired with the given TVD spatial discretization. Provide your final answer as two dimensionless numbers in the order $C$ and $\\nu_{\\max}$. No rounding is required; give exact values.",
            "solution": "The problem requires us to determine the Strong Stability Preserving (SSP) coefficient, denoted by $C$, for the given three-stage third-order Runge-Kutta method (TVD RK3), and then to find the maximum allowable Courant–Friedrichs–Lewy (CFL) number, $\\nu_{\\max}$, for this method when applied to a semi-discrete TVD scheme for which the forward Euler method is stable for $\\nu_{\\mathrm{FE}} = 1$.\n\nThe \"foundational SSP principle\" states that the method must be expressible as a convex combination of forward Euler steps. A formal and general way to analyze this is to express the Runge-Kutta method in the Shu-Osher form. Let $\\boldsymbol{u}^{(0)} = \\boldsymbol{u}^n$. A general $m$-stage SSP Runge-Kutta method is written as:\n$$\n\\boldsymbol{u}^{(i)} = \\sum_{k=0}^{i-1} \\left( \\alpha_{ik} \\boldsymbol{u}^{(k)} + \\beta_{ik} \\Delta t \\boldsymbol{L}(\\boldsymbol{u}^{(k)}) \\right), \\quad \\text{for } i = 1, \\dots, m\n$$\nwith the final solution being $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{(m)}$. For the method to be a convex combination of stable steps, the coefficients must satisfy $\\alpha_{ik} \\ge 0$, $\\beta_{ik} \\ge 0$, and $\\sum_{k=0}^{i-1} \\alpha_{ik} = 1$ for each stage $i$.\n\nWe rewrite each stage of the given TVD RK3 method to match this form and identify the coefficients $\\alpha_{ik}$ and $\\beta_{ik}$.\n\n**Stage 1:**\nThe first stage is given as $\\boldsymbol{u}^{(1)} = \\boldsymbol{u}^{n} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{n})$. With $\\boldsymbol{u}^{(0)} = \\boldsymbol{u}^n$, this becomes:\n$$\n\\boldsymbol{u}^{(1)} = 1 \\cdot \\boldsymbol{u}^{(0)} + 1 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(0)})\n$$\nComparing this to the general form for $i=1$, we identify $\\alpha_{10} = 1$ and $\\beta_{10} = 1$. The conditions are met: $\\alpha_{10} \\ge 0$ and the sum of $\\alpha$'s is $1$.\n\n**Stage 2:**\nThe second stage is $\\boldsymbol{u}^{(2)} = \\frac{3}{4} \\, \\boldsymbol{u}^{n} + \\frac{1}{4} \\left( \\boldsymbol{u}^{(1)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)}) \\right)$. We can write this as:\n$$\n\\boldsymbol{u}^{(2)} = \\frac{3}{4} \\, \\boldsymbol{u}^{(0)} + \\frac{1}{4} \\, \\boldsymbol{u}^{(1)} + 0 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(0)}) + \\frac{1}{4} \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)})\n$$\nComparing to the general form for $i=2$, we identify:\n$\\alpha_{20} = \\frac{3}{4}$, $\\alpha_{21} = \\frac{1}{4}$\n$\\beta_{20} = 0$, $\\beta_{21} = \\frac{1}{4}$\nThe conditions are met: $\\alpha_{20}, \\alpha_{21} \\ge 0$ and $\\alpha_{20} + \\alpha_{21} = \\frac{3}{4} + \\frac{1}{4} = 1$.\n\n**Stage 3:**\nThe final stage is $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{(3)} = \\frac{1}{3} \\, \\boldsymbol{u}^{n} + \\frac{2}{3} \\left( \\boldsymbol{u}^{(2)} + \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(2)}) \\right)$. We rewrite this as:\n$$\n\\boldsymbol{u}^{(3)} = \\frac{1}{3} \\, \\boldsymbol{u}^{(0)} + 0 \\cdot \\boldsymbol{u}^{(1)} + \\frac{2}{3} \\, \\boldsymbol{u}^{(2)} + 0 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(0)}) + 0 \\cdot \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(1)}) + \\frac{2}{3} \\Delta t \\, \\boldsymbol{L}(\\boldsymbol{u}^{(2)})\n$$\nComparing to the general form for $i=3$, we identify:\n$\\alpha_{30} = \\frac{1}{3}$, $\\alpha_{31} = 0$, $\\alpha_{32} = \\frac{2}{3}$\n$\\beta_{30} = 0$, $\\beta_{31} = 0$, $\\beta_{32} = \\frac{2}{3}$\nThe conditions are met: $\\alpha_{30}, \\alpha_{31}, \\alpha_{32} \\ge 0$ and $\\alpha_{30} + \\alpha_{31} + \\alpha_{32} = \\frac{1}{3} + 0 + \\frac{2}{3} = 1$.\n\nThe SSP property relies on rewriting each stage as a convex combination of forward Euler steps. For any term where $\\alpha_{ik}  0$, we can write:\n$$\n\\alpha_{ik} \\boldsymbol{u}^{(k)} + \\beta_{ik} \\Delta t \\boldsymbol{L}(\\boldsymbol{u}^{(k)}) = \\alpha_{ik} \\left( \\boldsymbol{u}^{(k)} + \\frac{\\beta_{ik}}{\\alpha_{ik}} \\Delta t \\boldsymbol{L}(\\boldsymbol{u}^{(k)}) \\right)\n$$\nThe term in the parenthesis is a forward Euler step with an effective time step of $(\\beta_{ik}/\\alpha_{ik})\\Delta t$. For the strong stability property to hold, each of these effective time steps must be no larger than the stable time step of the forward Euler method itself, $\\Delta t_{\\mathrm{FE}}$.\n$$\n\\frac{\\beta_{ik}}{\\alpha_{ik}} \\Delta t \\le \\Delta t_{\\mathrm{FE}}\n$$\nThis must hold for all pairs $(i, k)$ where $\\beta_{ik}  0$. To ensure the condition holds for the entire scheme, the time step $\\Delta t$ must satisfy the most restrictive of these constraints:\n$$\n\\Delta t \\le \\min_{i,k | \\beta_{ik}0} \\left( \\frac{\\alpha_{ik}}{\\beta_{ik}} \\right) \\Delta t_{\\mathrm{FE}}\n$$\nThe SSP coefficient $C$ is defined as this minimum value.\n$$\nC = \\min_{i,k | \\beta_{ik}0} \\left( \\frac{\\alpha_{ik}}{\\beta_{ik}} \\right)\n$$\nWe now compute this value for the TVD RK3 method using the coefficients we found. The pairs $(i,k)$ with $\\beta_{ik}0$ are $(1,0)$, $(2,1)$, and $(3,2)$.\n- For $(i,k)=(1,0)$: $\\frac{\\alpha_{10}}{\\beta_{10}} = \\frac{1}{1} = 1$.\n- For $(i,k)=(2,1)$: $\\frac{\\alpha_{21}}{\\beta_{21}} = \\frac{1/4}{1/4} = 1$.\n- For $(i,k)=(3,2)$: $\\frac{\\alpha_{32}}{\\beta_{32}} = \\frac{2/3}{2/3} = 1$.\n\nThe minimum of these values is $1$. Therefore, the SSP coefficient is $C=1$.\n\nThe stability condition for the SSP-RK method is $\\Delta t \\le C \\cdot \\Delta t_{\\mathrm{FE}}$. We can translate this into a condition on the CFL number $\\nu = a \\Delta t / \\Delta x$. The forward Euler stability constraint is $\\nu_{\\mathrm{FE}} = a \\Delta t_{\\mathrm{FE}} / \\Delta x$. Thus:\n$$\n\\frac{a \\Delta t}{\\Delta x} \\le C \\cdot \\frac{a \\Delta t_{\\mathrm{FE}}}{\\Delta x} \\implies \\nu \\le C \\cdot \\nu_{\\mathrm{FE}}\n$$\nThe maximum allowable CFL number for the SSP-RK scheme is $\\nu_{\\max} = C \\cdot \\nu_{\\mathrm{FE}}$.\nGiven that $\\nu_{\\mathrm{FE}} = 1$ and we have calculated $C=1$, the maximum allowable CFL number is:\n$$\n\\nu_{\\max} = 1 \\cdot 1 = 1\n$$\nThe two dimensionless numbers requested are the SSP coefficient $C$ and the maximum allowable CFL number $\\nu_{\\max}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "High-resolution schemes are not perfect; their built-in safety mechanisms, like reducing to first-order at discontinuities, introduce numerical artifacts. This final exercise bridges theory with practical application by examining the physical consequence of this behavior: numerical diffusion. You will use scaling analysis to relate the numerical diffusion of a flux-limited scheme to the physical resolution of a diffusive layer . This practice cultivates a vital skill for any computational scientist: estimating the necessary grid resolution to ensure that numerical errors do not overwhelm the physical phenomena you aim to capture.",
            "id": "4030677",
            "problem": "Consider one-dimensional advection and molecular diffusion of a passive scalar, such as the mixture fraction, governed by the scalar advection–diffusion equation\n$$\n\\frac{\\partial Z}{\\partial t} + u \\frac{\\partial Z}{\\partial x} = D_{m} \\frac{\\partial^{2} Z}{\\partial x^{2}},\n$$\nwhere $Z$ is the scalar, $u$ is a constant advective speed, and $D_{m}$ is the constant molecular diffusivity. In computational combustion, high-resolution flux-limited Total Variation Diminishing (TVD) Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) reduce to first-order upwind in the vicinity of a contact discontinuity to avoid spurious oscillations. A well-tested modified-equation analysis shows that, in that limit, the spatial discretization introduces an equivalent numerical diffusion coefficient\n$$\nD_{\\mathrm{num}} = \\frac{1}{2} |u| \\Delta x,\n$$\nfor a semi-discrete formulation at Courant–Friedrichs–Lewy (CFL) number near unity, where $\\Delta x$ is the uniform grid spacing.\n\nA scalar contact discontinuity of amplitude $\\Delta Z$ convected at speed $u$ and smoothed by molecular diffusion has a characteristic physical shock thickness $\\delta_{\\mathrm{phys}}$ set by the balance between advection and diffusion. When the limiter-induced numerical diffusion is present, the effective diffusion becomes $D_{\\mathrm{eff}} = D_{m} + D_{\\mathrm{num}}$, which increases the effective shock thickness and reduces the peak gradient.\n\nLet the parameters be $u = 5\\,\\mathrm{m/s}$, $D_{m} = 2.0 \\times 10^{-5}\\,\\mathrm{m^{2}/s}$, and consider a minmod-type limiter that behaves as first-order upwind near the discontinuity. Using first principles (balance of advective and diffusive transport and the modified-equation perspective), relate the limiter-induced numerical diffusion to the shock thickness and derive an estimate for the minimum number of uniform computational cells required across the physical diffusive thickness to ensure that the leading-order relative error in the peak gradient magnitude is less than or equal to $\\varepsilon = 0.05$. Express your final answer as the minimum integer number of cells across the physical shock thickness (units: cells). No rounding to significant figures is needed; report the exact integer implied by your estimate.",
            "solution": "The problem requires finding the minimum number of computational cells, $N$, across the physical diffusive thickness, $\\delta_{\\mathrm{phys}}$, to satisfy a given error criterion on the peak gradient of a smoothed discontinuity.\n\nFirst, we must define the characteristic physical diffusive thickness, $\\delta_{\\mathrm{phys}}$. The problem states it is set by the balance between the advective term, $u \\frac{\\partial Z}{\\partial x}$, and the diffusive term, $D_{m} \\frac{\\partial^{2} Z}{\\partial x^{2}}$. Using scaling analysis, we can approximate the derivatives over the characteristic thickness $\\delta_{\\mathrm{phys}}$ with a total change in the scalar of $\\Delta Z$: $|\\frac{\\partial Z}{\\partial x}| \\sim \\frac{\\Delta Z}{\\delta_{\\mathrm{phys}}}$ and $|\\frac{\\partial^{2} Z}{\\partial x^{2}}| \\sim \\frac{\\Delta Z}{\\delta_{\\mathrm{phys}}^{2}}$.\nThe balance of magnitudes is:\n$$ |u| \\left| \\frac{\\partial Z}{\\partial x} \\right| \\sim D_{m} \\left| \\frac{\\partial^{2} Z}{\\partial x^{2}} \\right| $$\n$$ |u| \\frac{\\Delta Z}{\\delta_{\\mathrm{phys}}} \\sim D_{m} \\frac{\\Delta Z}{\\delta_{\\mathrm{phys}}^{2}} $$\nSolving for $\\delta_{\\mathrm{phys}}$ yields a definition based on first principles:\n$$ \\delta_{\\mathrm{phys}} = \\frac{D_{m}}{|u|} $$\nThis scale represents the width of the layer where diffusion and advection effects are of comparable magnitude.\n\nNext, we relate the peak gradient magnitude, $G = |\\frac{\\partial Z}{\\partial x}|_{\\mathrm{max}}$, to the diffusion coefficient. For a steady or quasi-steady diffusive layer of thickness $\\delta$, the peak gradient is inversely proportional to the thickness, $G \\sim \\Delta Z / \\delta$. Since the thickness $\\delta$ is proportional to the diffusion coefficient $D$ (i.e., $\\delta \\sim D/|u|$), the peak gradient is inversely proportional to the diffusion coefficient:\n$$ G \\propto \\frac{1}{D} $$\nThe physical profile is smoothed by molecular diffusion $D_m$, so its peak gradient $G_{\\mathrm{phys}}$ scales as:\n$$ G_{\\mathrm{phys}} \\propto \\frac{1}{D_{m}} $$\nIn the numerical simulation, the effective diffusion is $D_{\\mathrm{eff}} = D_{m} + D_{\\mathrm{num}}$. The numerically computed peak gradient, $G_{\\mathrm{num}}$, will scale as:\n$$ G_{\\mathrm{num}} \\propto \\frac{1}{D_{\\mathrm{eff}}} = \\frac{1}{D_{m} + D_{\\mathrm{num}}} $$\n\nThe relative error in the peak gradient magnitude is defined as:\n$$ \\varepsilon_{\\mathrm{rel}} = \\frac{G_{\\mathrm{phys}} - G_{\\mathrm{num}}}{G_{\\mathrm{phys}}} = 1 - \\frac{G_{\\mathrm{num}}}{G_{\\mathrm{phys}}} $$\nSubstituting the scaling relationships, the proportionality constant cancels out:\n$$ \\varepsilon_{\\mathrm{rel}} = 1 - \\frac{1/D_{\\mathrm{eff}}}{1/D_{m}} = 1 - \\frac{D_{m}}{D_{\\mathrm{eff}}} = \\frac{D_{\\mathrm{eff}} - D_{m}}{D_{\\mathrm{eff}}} = \\frac{D_{\\mathrm{num}}}{D_{m} + D_{\\mathrm{num}}} $$\nThe problem asks to constrain the \"leading-order relative error\". For cases where numerical diffusion is a small correction to physical diffusion ($D_{\\mathrm{num}} \\ll D_{m}$), we can expand the error expression:\n$$ \\varepsilon_{\\mathrm{rel}} = \\frac{D_{\\mathrm{num}}}{D_{m}(1 + D_{\\mathrm{num}}/D_{m})} = \\frac{D_{\\mathrm{num}}}{D_{m}} \\left(1 - \\frac{D_{\\mathrm{num}}}{D_{m}} + \\dots\\right) $$\nThe leading-order term of this error is $\\frac{D_{\\mathrm{num}}}{D_{m}}$. The problem constraint is thus applied to this term:\n$$ \\frac{D_{\\mathrm{num}}}{D_{m}} \\le \\varepsilon $$\nNow, we substitute the given expression for the numerical diffusion, $D_{\\mathrm{num}} = \\frac{1}{2} |u| \\Delta x$:\n$$ \\frac{\\frac{1}{2} |u| \\Delta x}{D_{m}} \\le \\varepsilon $$\nThis inequality sets an upper limit on the allowable grid spacing $\\Delta x$:\n$$ \\Delta x \\le \\frac{2 \\varepsilon D_{m}}{|u|} $$\n\nThe objective is to find the minimum number of computational cells, $N$, across the physical thickness $\\delta_{\\mathrm{phys}}$. The number of cells is given by $N = \\delta_{\\mathrm{phys}} / \\Delta x$. To find the minimum required $N$, we must use the smallest possible $\\Delta x$ that satisfies the error condition. Rearranging the inequality for $\\Delta x$:\n$$ \\frac{1}{\\Delta x} \\ge \\frac{|u|}{2 \\varepsilon D_{m}} $$\nTherefore, the number of cells $N$ must satisfy:\n$$ N = \\frac{\\delta_{\\mathrm{phys}}}{\\Delta x} \\ge \\delta_{\\mathrm{phys}} \\left( \\frac{|u|}{2 \\varepsilon D_{m}} \\right) $$\nSubstituting our derived expression for the physical thickness, $\\delta_{\\mathrm{phys}} = \\frac{D_{m}}{|u|}$:\n$$ N \\ge \\left( \\frac{D_{m}}{|u|} \\right) \\left( \\frac{|u|}{2 \\varepsilon D_{m}} \\right) $$\nThe terms $D_{m}$ and $|u|$ cancel, leading to a simple, universal requirement on the resolution:\n$$ N \\ge \\frac{1}{2\\varepsilon} $$\nUsing the given value $\\varepsilon = 0.05$:\n$$ N \\ge \\frac{1}{2 \\times 0.05} = \\frac{1}{0.1} = 10 $$\nThe number of cells $N$ must be an integer. The condition $N \\ge 10$ implies that the minimum integer number of cells required is $10$. This ensures that the numerical diffusion introduced by the first-order upwind scheme does not corrupt the peak gradient of the physical diffusive structure by more than approximately $5\\%$.\nThe specific values for $u$ and $D_m$ are not needed for the final result, but they confirm the physical context and allow for consistency checks. For instance, the condition $D_{\\mathrm{num}}/D_m \\le 0.05$ confirms that the leading-order approximation is self-consistent.",
            "answer": "$$\\boxed{10}$$"
        }
    ]
}