{
    "hands_on_practices": [
        {
            "introduction": "在构建任何黎曼求解器的通量之前，我们必须能够准确计算局部的热力学性质。声速是估算波速的关键参数，对于任何黎曼求解器都至关重要。本练习将引导您完成计算多组分气体混合物中声速的基本步骤，其中比热容是温度的函数——这是燃烧学中的常见情况。",
            "id": "4007463",
            "problem": "考虑反应流中的一个一维界面，其中一个近似黎曼求解器，例如 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器，需要当地声速来设定波速估计。假设一种具有冻结组分和热完美行为（基于质量的比热随温度变化）的二元理想气体混合物。该混合物的质量分数为 $Y_1=0.7$ 和 $Y_2=0.3$。各组分的定压质量比热由 $c_{p,1}(T)=a_1+b_1 T$ 和 $c_{p,2}(T)=a_2+b_2 T$ 给出，其中 $a_1=950\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$b_1=0.10\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$，$a_2=730\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$b_2=0.40\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$。各组分的摩尔质量为 $W_1=28.0134\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ 和 $W_2=44.01\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$。取普适气体常数为 $R_u=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。在某一特定状态下，混合物的密度和压力分别为 $\\rho=0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$ 和 $p=2.50\\times 10^{5}\\,\\mathrm{Pa}$。\n\n仅使用适用于冻结组分理想气体混合物的基本热力学关系，首先计算该状态下混合物的比热比 $\\gamma_{mix}=c_{p,mix}/c_{v,mix}$，然后评估在该状态下适用于近似黎曼求解器的当地声速 $a$。\n\n将 $a$ 的最终值四舍五入到四位有效数字。最终声速以 $\\mathrm{m}\\,\\mathrm{s}^{-1}$ 为单位表示。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。它提出了一个热力学和流体动力学中的标准问题，与计算反应流相关。所有必要的数据均已提供，所要求的量可以唯一确定。\n\n目标是计算一种具有冻结组分和热完美气体的二元理想气体混合物中的当地声速 $a$。在这种介质中，声速由以下公式给出：\n$$ a = \\sqrt{\\gamma_{mix} \\frac{p}{\\rho}} = \\sqrt{\\gamma_{mix} R_{mix} T} $$\n其中 $p$ 是压力，$\\rho$ 是密度，$T$ 是温度，$R_{mix}$ 是混合物的比气体常数，$\\gamma_{mix}$ 是混合物的比热比 $c_{p,mix}/c_{v,mix}$。由于比热是温度的函数，$\\gamma_{mix}$ 也是温度的函数。计算过程分以下几个步骤进行：\n$1$. 确定混合物的比气体常数 $R_{mix}$。\n$2$. 使用理想气体定律，根据给定状态 $(p, \\rho)$ 求出混合物的温度 $T$。\n$3$. 在温度 $T$ 下，计算混合物的比热 $c_{p,mix}$ 和 $c_{v,mix}$。\n$4$. 在温度 $T$ 下，计算比热比 $\\gamma_{mix}$。\n$5$. 计算声速 $a$。\n\n首先，我们使用给定的质量分数 $Y_i$ 和各组分的摩尔质量 $W_i$ 来计算混合物的平均摩尔质量 $W_{mix}$。其关系式为：\n$$ \\frac{1}{W_{mix}} = \\sum_{i=1}^{2} \\frac{Y_i}{W_i} = \\frac{Y_1}{W_1} + \\frac{Y_2}{W_2} $$\n给定值为 $Y_1=0.7$，$Y_2=0.3$，$W_1=28.0134 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ 和 $W_2=44.01 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$。\n$$ \\frac{1}{W_{mix}} = \\frac{0.7}{28.0134 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}} + \\frac{0.3}{44.01 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}} $$\n$$ \\frac{1}{W_{mix}} \\approx 24.98804\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1} + 6.81663\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1} \\approx 31.80467\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1} $$\n然后，使用普适气体常数 $R_u=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 来求混合物的比气体常数 $R_{mix}$。\n$$ R_{mix} = \\frac{R_u}{W_{mix}} = R_u \\left( \\frac{Y_1}{W_1} + \\frac{Y_2}{W_2} \\right) $$\n$$ R_{mix} \\approx (8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (31.80467\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}) \\approx 264.4363\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\n接下来，我们使用理想气体定律 $p = \\rho R_{mix} T$ 来确定混合物的温度。该状态由 $p=2.50 \\times 10^{5}\\,\\mathrm{Pa}$ 和 $\\rho=0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$ 定义。\n$$ T = \\frac{p}{\\rho R_{mix}} \\approx \\frac{2.50 \\times 10^{5}\\,\\mathrm{Pa}}{(0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}) \\times (264.4363\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})} \\approx 1196.736\\,\\mathrm{K} $$\n\n已知温度后，我们可以使用所提供的多项式表达式来计算各组分的定压质量比热 $c_{p,i}(T)$：\n$c_{p,1}(T) = a_1 + b_1 T$，其中 $a_1=950\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$b_1=0.10\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$。\n$$ c_{p,1}(1196.736\\,\\mathrm{K}) = 950 + 0.10 \\times 1196.736 \\approx 1069.674\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n$c_{p,2}(T) = a_2 + b_2 T$，其中 $a_2=730\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$b_2=0.40\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$。\n$$ c_{p,2}(1196.736\\,\\mathrm{K}) = 730 + 0.40 \\times 1196.736 \\approx 1208.694\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\n混合物的定压比热 $c_{p,mix}$ 是各组分比热的质量分数加权平均值：\n$$ c_{p,mix}(T) = \\sum_{i=1}^{2} Y_i c_{p,i}(T) = Y_1 c_{p,1}(T) + Y_2 c_{p,2}(T) $$\n$$ c_{p,mix}(1196.736\\,\\mathrm{K}) \\approx (0.7 \\times 1069.674) + (0.3 \\times 1208.694) \\approx 748.772 + 362.608 \\approx 1111.380\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\n混合物的定容比热 $c_{v,mix}$ 可通过理想气体混合物的 Mayer 关系式求得：\n$$ c_{p,mix} - c_{v,mix} = R_{mix} \\implies c_{v,mix} = c_{p,mix} - R_{mix} $$\n$$ c_{v,mix} \\approx 1111.380\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} - 264.4363\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\approx 846.944\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\n现在，我们可以计算在给定状态下混合物的比热比 $\\gamma_{mix}$：\n$$ \\gamma_{mix} = \\frac{c_{p,mix}}{c_{v,mix}} \\approx \\frac{1111.380}{846.944} \\approx 1.31222 $$\n\n最后，我们使用热完美气体混合物的基本关系式计算声速 $a$：\n$$ a = \\sqrt{\\gamma_{mix} \\frac{p}{\\rho}} $$\n$$ a \\approx \\sqrt{1.31222 \\times \\frac{2.50 \\times 10^{5}\\,\\mathrm{Pa}}{0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}} \\approx \\sqrt{1.31222 \\times 316455.7\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} $$\n$$ a \\approx \\sqrt{415260.2\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} \\approx 644.407\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\n根据要求将最终值四舍五入到四位有效数字，我们得到 $a = 644.4\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\n\\boxed{644.4}\n$$"
        },
        {
            "introduction": "掌握了计算局部声速的方法后，我们现在可以应用近似黎曼求解器的核心逻辑。本练习以Harten-Lax-van Leer (HLL) 求解器为例，估算爆轰波的边界波速。爆轰波是一种极具挑战性的反应流现象。通过这个练习，您将学会如何判断一个求解器的波扇是否足够稳健，能够捕捉到物理上正确的波速。",
            "id": "4007497",
            "problem": "考虑一个位于 $x=0$ 处的一维爆轰界面，它将上游的未燃混合物（左态）和下游的已燃混合物（右态）分开。该流动由反应流欧拉方程描述，两边的气体均遵循理想气体状态方程。针对此反应流的 Harten–Lax–van Leer (HLL) 近似黎曼求解器是通过界定反应流欧拉系统的齐次双曲部分中最快的向左和向右传播的信号速度来构建的。该齐次系统的声学特征是通量雅可比矩阵的特征值，这些特征值取决于局部流速和声速。\n\n给定以下上游（左）状态，代表在实验室坐标系中名义上静止的未燃燃料-氧化剂混合物：\n- 流速 $u_{L} = 0\\,\\mathrm{m/s}$，\n- 温度 $T_{L} = 300\\,\\mathrm{K}$，\n- 比热比 $\\gamma_{L} = 1.40$，\n- 有效混合气体常数 $R_{L} = 287\\,\\mathrm{J/(kg\\cdot K)}$。\n\n给定以下下游（右）状态，代表在实验室坐标系中对流的高温已燃产物混合物：\n- 流速 $u_{R} = 1500\\,\\mathrm{m/s}$，\n- 温度 $T_{R} = 2800\\,\\mathrm{K}$，\n- 比热比 $\\gamma_{R} = 1.25$，\n- 有效混合气体常数 $R_{R} = 287\\,\\mathrm{J/(kg\\cdot K)}$。\n\n反应激波（爆轰）在实验室坐标系中以速度 $D = 1950\\,\\mathrm{m/s}$ 传播，这与在可比条件下由 Zel’dovich–von Neumann–Döring (ZND) 理论计算出的近 Chapman–Jouguet 爆轰一致。\n\n从齐次反应流欧拉方程的特征结构和理想气体声速的定义出发，推导出两个 HLL 边界速度 $S_{L}$ 和 $S_{R}$ 关于给定状态变量的表达式，并用指定数据对其进行求值，然后计算诊断量\n$$\nm \\equiv \\min\\!\\big(D - S_{L},\\, S_{R} - D\\big),\n$$\n该量用于量化 HLL 波扇边界是否包含反应激波速度（正值表示包含，并给出到波扇边缘的最小余量）。请用 $\\mathrm{m/s}$ 作为单位表示 $m$ 的最终答案，并将结果四舍五入到四位有效数字。不要将任何中间值作为最终答案；只按要求报告 $m$ 的值。",
            "solution": "该问题要求计算一个诊断量 $m$，该量与应用于一维爆轰波的 Harten–Lax–van Leer (HLL) 近似黎曼求解器相关。首先对问题进行验证，发现其是适定的，有科学依据，并包含了所有必要的信息。\n\nHLL 求解器通过假设一个简化的波结构来近似黎曼问题的解，该结构由初始左态 (L)、一个恒定的中间状态和初始右态 (R) 组成，它们被两个以速度 $S_L$ 和 $S_R$ 传播的波分开。选择这些速度是为了界定真实解中最慢和最快移动波的速度范围。对于欧拉方程，特征速度由通量雅可比矩阵的特征值给出，即 $u-c$、$u$ 和 $u+c$，其中 $u$ 是局部流体速度，$c$ 是局部声速。\n\n对于 HLL 边界速度，一个标准且稳健的选择是取初始左、右状态的极值特征速度的最小值和最大值，这与问题描述中“界定最快的向左和向右传播的信号速度”一致。这导出以下 $S_L$ 和 $S_R$ 的表达式：\n$$\nS_L = \\min(u_L - c_L, u_R - c_R)\n$$\n$$\nS_R = \\max(u_L + c_L, u_R + c_R)\n$$\n这里，$u_L$ 和 $c_L$ 是上游（左）状态的速度和声速，$u_R$ 和 $c_R$ 是下游（右）状态的相应量。\n\n理想气体的声速 $c$ 由以下关系式定义：\n$$\nc = \\sqrt{\\gamma R T}\n$$\n其中 $\\gamma$ 是比热比，$R$ 是比气体常数，$T$ 是绝对温度。\n\n首先，我们计算上游（左）状态的声速 $c_L$。给定的参数是 $u_L = 0\\,\\mathrm{m/s}$，$T_L = 300\\,\\mathrm{K}$，$\\gamma_L = 1.40$ 和 $R_L = 287\\,\\mathrm{J/(kg \\cdot K)}$。\n$$\nc_L = \\sqrt{\\gamma_L R_L T_L} = \\sqrt{(1.40)(287\\,\\mathrm{J/(kg \\cdot K)})(300\\,\\mathrm{K})} = \\sqrt{120540\\,\\mathrm{m^2/s^2}} \\approx 347.1887\\,\\mathrm{m/s}\n$$\n\n接下来，我们计算下游（右）状态的声速 $c_R$。给定的参数是 $u_R = 1500\\,\\mathrm{m/s}$，$T_R = 2800\\,\\mathrm{K}$，$\\gamma_R = 1.25$ 和 $R_R = 287\\,\\mathrm{J/(kg \\cdot K)}$。\n$$\nc_R = \\sqrt{\\gamma_R R_R T_R} = \\sqrt{(1.25)(287\\,\\mathrm{J/(kg \\cdot K)})(2800\\,\\mathrm{K})} = \\sqrt{1004500\\,\\mathrm{m^2/s^2}} \\approx 1002.2475\\,\\mathrm{m/s}\n$$\n\n现在，我们可以计算两种状态的极值特征速度：\n对于左态：\n$$\nu_L - c_L = 0\\,\\mathrm{m/s} - 347.1887\\,\\mathrm{m/s} = -347.1887\\,\\mathrm{m/s}\n$$\n$$\nu_L + c_L = 0\\,\\mathrm{m/s} + 347.1887\\,\\mathrm{m/s} = 347.1887\\,\\mathrm{m/s}\n$$\n对于右态：\n$$\nu_R - c_R = 1500\\,\\mathrm{m/s} - 1002.2475\\,\\mathrm{m/s} = 497.7525\\,\\mathrm{m/s}\n$$\n$$\nu_R + c_R = 1500\\,\\mathrm{m/s} + 1002.2475\\,\\mathrm{m/s} = 2502.2475\\,\\mathrm{m/s}\n$$\n\n使用这些值，我们确定 HLL 边界速度 $S_L$ 和 $S_R$：\n$$\nS_L = \\min(-347.1887\\,\\mathrm{m/s}, 497.7525\\,\\mathrm{m/s}) = -347.1887\\,\\mathrm{m/s}\n$$\n$$\nS_R = \\max(347.1887\\,\\mathrm{m/s}, 2502.2475\\,\\mathrm{m/s}) = 2502.2475\\,\\mathrm{m/s}\n$$\n\n最后，我们计算诊断量 $m$，它衡量爆轰速度 $D$ 与 HLL 波扇速度之间的最小“间隙”。给定的爆轰速度为 $D = 1950\\,\\mathrm{m/s}$。\n$$\nm = \\min(D - S_L, S_R - D)\n$$\n我们计算 `min` 函数的两个参数：\n$$\nD - S_L = 1950\\,\\mathrm{m/s} - (-347.1887\\,\\mathrm{m/s}) = 2297.1887\\,\\mathrm{m/s}\n$$\n$$\nS_R - D = 2502.2475\\,\\mathrm{m/s} - 1950\\,\\mathrm{m/s} = 552.2475\\,\\mathrm{m/s}\n$$\n因此，$m$ 是这两个值中的较小者：\n$$\nm = \\min(2297.1887\\,\\mathrm{m/s}, 552.2475\\,\\mathrm{m/s}) = 552.2475\\,\\mathrm{m/s}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\nm \\approx 552.2\\,\\mathrm{m/s}\n$$\n$m$ 的正值表明，边界为 $[S_L, S_R]$ 的 HLL 波扇成功地将爆轰速度 $D$ 包含在内。",
            "answer": "$$\\boxed{552.2}$$"
        },
        {
            "introduction": "在低速（低马赫数）流动中，标准的黎曼求解器可能会引入过度的数值误差，而这种流动在许多燃烧应用中非常普遍。本练习将探讨这个问题，通过计算Harten-Lax-van Leer-Contact (HLLC) 求解器中一个物种的数值扩散来进行。您将比较标准求解器与“预处理”版本，亲身体验这种先进技术如何提高捕捉接触间断的准确性。",
            "id": "4007521",
            "problem": "考虑由欧拉方程和一个单一被动物种守恒方程控制的一维、无粘性、多组分反应流。守恒变量为 $\\rho$、$\\rho u$、$E$ 和 $\\rho Y_F$，其中 $\\rho$ 是质量密度（单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$），$u$ 是速度（单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$），$E$ 是总能量密度（单位为 $\\mathrm{J}\\,\\mathrm{m}^{-3}$），$Y_F$ 是燃料质量分数（无量纲）。假设燃料和氧化剂的二元理想气体混合物具有恒定的比热比 $\\gamma$ 和依赖于组分的比气体常数 $R(Y_F)$。通用气体常数为 $R_u$（单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），分子量分别为 $W_F$ 和 $W_O$（单位为 $\\mathrm{kg}\\,\\mathrm{mol}^{-1}$）。混合物的分子量为\n$$\nW(Y_F) = \\left(\\frac{Y_F}{W_F} + \\frac{1-Y_F}{W_O}\\right)^{-1},\n$$\n混合物的比气体常数为\n$$\nR(Y_F) = \\frac{R_u}{W(Y_F)}.\n$$\n对于热力学封闭，使用理想气体关系式 $p = \\rho R(Y_F) T$（其中压力 $p$ 的单位为 $\\mathrm{Pa}$，温度 $T$ 的单位为 $\\mathrm{K}$）以及总能量密度\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2.\n$$\n声速为 $c = \\sqrt{\\gamma R(Y_F) T}$，马赫数为 $M = \\frac{u}{c}$。\n\n您将计算在低马赫数下具有强组分梯度的单个界面上的 Harten-Lax-van Leer-Contact (HLLC) 近似黎曼通量，并比较预处理通量与非预处理通量在数值物种扩散方面的差异。预处理通过基于局部马赫数，使用因子 $\\alpha$ 对声学信号进行缩放来实现；具体来说，定义 $\\tilde{c} = \\alpha c$，其中 $\\alpha = \\max(|M|,\\varepsilon)$ 且 $\\varepsilon = 10^{-6}$ 以避免简并，并在黎曼求解器的所有波速估计中使用 $\\tilde{c}$。这种低马赫数预处理减少了过度的声学耗散，并广泛用于计算燃烧学中，以提高在 $M \\ll 1$ 时的精度。\n\n设左 ($L$) 和右 ($R$) 状态由 $(p_K, T_K, Y_{F,K})$ 给出，其中 $K \\in \\{L,R\\}$。构建 $\\rho_K = \\frac{p_K}{R(Y_{F,K}) T_K}$， $c_K = \\sqrt{\\gamma R(Y_{F,K}) T_K}$，并在两侧设置界面速度 $u_K = M c_L$，从而使界面马赫数参考左侧声速。使用带有预处理声学的 Davis 估计来定义 HLLC 波速：\n$$\nS_L = \\min(u_L - \\tilde{c}_L, u_R - \\tilde{c}_R), \\quad\nS_R = \\max(u_L + \\tilde{c}_L, u_R + \\tilde{c}_R),\n$$\n以及接触波速\n$$\nS_* = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)}.\n$$\n相应的星区的密度为\n$$\n\\rho_{*L} = \\rho_L \\frac{S_L - u_L}{S_L - S_*}, \\quad\n\\rho_{*R} = \\rho_R \\frac{S_R - u_R}{S_R - S_*}.\n$$\n将物种视为由 HLLC 接触波平流的被动标量，星区的物种质量为 $(\\rho Y_F)_{*L} = \\rho_{*L} Y_{F,L}$ 和 $(\\rho Y_F)_{*R} = \\rho_{*R} Y_{F,R}$。穿过界面的物种通量分量 $F_{\\rho Y_F}$ 则通过 HLLC 通量选择获得：\n- 如果 $0 \\le S_L$，那么 $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L}$，\n- 如果 $S_L  0 \\le S_*$，那么 $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L} + S_L\\left[(\\rho Y_F)_{*L} - \\rho_L Y_{F,L}\\right]$，\n- 如果 $S_*  0 \\le S_R$，那么 $F_{\\rho Y_F} = \\rho_R u_R Y_{F,R} + S_R\\left[(\\rho Y_F)_{*R} - \\rho_R Y_{F,R}\\right]$，\n- 如果 $S_R \\le 0$，那么 $F_{\\rho Y_F} = \\rho_R u_R Y_{F,R}$。\n\n将纯平流上风物种通量定义为\n$$\nF_{\\mathrm{adv}} = u_{\\mathrm{up}} \\rho_{\\mathrm{up}} Y_{F,\\mathrm{up}},\n$$\n其中上风状态由 $u$ 的符号选择（如果 $u \\ge 0$，则使用左侧状态，否则使用右侧状态）。将数值物种扩散量化为\n$$\n\\mathcal{D} = \\left|F_{\\rho Y_F} - F_{\\mathrm{adv}}\\right|,\n$$\n单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n针对以下每个科学上合理且内部一致的测试案例，计算预处理和非预处理 HLLC 通量的 $\\mathcal{D}$：\n\n- 案例 A（理想情况，强组分接触）：$p_L = 1.0\\times10^5\\,\\mathrm{Pa}$，$p_R = 1.0\\times10^5\\,\\mathrm{Pa}$，$T_L = T_R = 1000\\,\\mathrm{K}$，$Y_{F,L} = 0.99$，$Y_{F,R} = 0.01$，$M = +0.05$。\n- 案例 B（低马赫数下的小压力跳跃）：$p_L = 1.001\\times10^5\\,\\mathrm{Pa}$，$p_R = 0.999\\times10^5\\,\\mathrm{Pa}$，$T_L = T_R = 1000\\,\\mathrm{K}$，$Y_{F,L} = 0.99$，$Y_{F,R} = 0.01$，$M = +0.05$。\n- 案例 C（极低马赫数下的小压力跳跃）：$p_L = 1.0001\\times10^5\\,\\mathrm{Pa}$，$p_R = 0.9999\\times10^5\\,\\mathrm{Pa}$，$T_L = T_R = 1000\\,\\mathrm{K}$，$Y_{F,L} = 0.99$，$Y_{F,R} = 0.01$，$M = +0.001$。\n- 案例 D（负速度接触）：$p_L = 1.0\\times10^5\\,\\mathrm{Pa}$，$p_R = 1.0\\times10^5\\,\\mathrm{Pa}$，$T_L = T_R = 1000\\,\\mathrm{K}$，$Y_{F,L} = 0.99$，$Y_{F,R} = 0.01$，$M = -0.05$。\n\n使用 $\\gamma = 1.4$，$W_F = 16\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$（类甲烷燃料），$W_O = 32\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$（氧气），以及 $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。对于每个案例，计算预处理的数值扩散 $\\mathcal{D}_{\\mathrm{pre}}$（其中 $\\alpha = \\max(|M|,10^{-6})$）和非预处理的数值扩散 $\\mathcal{D}_{\\mathrm{un}}$（其中 $\\alpha = 1$）。所有通量和扩散量级均以 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 表示。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n[\\mathcal{D}_{\\mathrm{pre}}^{A}, \\mathcal{D}_{\\mathrm{un}}^{A}, \\mathcal{D}_{\\mathrm{pre}}^{B}, \\mathcal{D}_{\\mathrm{un}}^{B}, \\mathcal{D}_{\\mathrm{pre}}^{C}, \\mathcal{D}_{\\mathrm{un}}^{C}, \\mathcal{D}_{\\mathrm{pre}}^{D}, \\mathcal{D}_{\\mathrm{un}}^{D}],\n$$\n每个都是一个浮点数，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。",
            "solution": "该问题已经过验证，被认为是有效的。它在科学上基于计算流体动力学的原理，特别是针对带有被动标量的欧拉方程的 Harten-Lax-van Leer-Contact (HLLC) 近似黎曼求解器的构建。该问题是适定的，为获得唯一解提供了所有必要的参数、方程和边界条件。对于低马赫数燃烧场景，数值是物理上合理的。\n\n目标是量化被动物种（燃料质量分数 $Y_F$）穿过接触间断面的数值扩散，并比较标准 HLLC 求解器与低马赫数预处理变体的差异。数值扩散 $\\mathcal{D}$ 定义为 HLLC 物种通量 $F_{\\rho Y_F}$ 与参考的纯平流上风通量 $F_{\\mathrm{adv}}$ 之间的绝对差值。\n\n求解过程是对每个测试案例实施指定的算法，一次使用预处理，一次不使用。每次计算的核心步骤如下：\n\n1.  **状态初始化：** 对于界面的每一侧，即左侧（$L$）和右侧（$R$），使用原始变量 $(p_K, T_K, Y_{F,K})$ 来计算所需的热力学和气体动力学属性。\n    -   混合物分子量 $W_K$ 使用公式 $W(Y_{F,K}) = \\left(\\frac{Y_{F,K}}{W_F} + \\frac{1-Y_{F,K}}{W_O}\\right)^{-1}$ 计算。\n    -   混合物的比气体常数为 $R_K = R(Y_{F,K}) = \\frac{R_u}{W_K}$。\n    -   密度由理想气体定律得出：$\\rho_K = \\frac{p_K}{R_K T_K}$。\n    -   声速为 $c_K = \\sqrt{\\gamma R_K T_K}$。\n\n2.  **速度与预处理设置：**\n    -   速度在界面上设为均匀，由马赫数 $M$ 和左侧声速决定：$u_L = u_R = u = M c_L$。\n    -   确定预处理因子 $\\alpha$。对于非预处理情况，$\\alpha=1$。对于预处理情况，$\\alpha = \\max(|M|, \\varepsilon)$，其中 $\\varepsilon=10^{-6}$。\n    -   经声学缩放的声速则为 $\\tilde{c}_K = \\alpha c_K$。\n\n3.  **HLLC 波速估计：** 估计 HLLC 求解器的三个特征波速。\n    -   最快的左行和右行声波速度 $S_L$ 和 $S_R$ 使用带有（预处理）声速的 Davis 公式进行估计：\n        $$\n        S_L = \\min(u_L - \\tilde{c}_L, u_R - \\tilde{c}_R)\n        $$\n        $$\n        S_R = \\max(u_L + \\tilde{c}_L, u_R + \\tilde{c}_R)\n        $$\n    -   接触波速 $S_*$ 根据跨声波的跳跃条件计算：\n        $$\n        S_* = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)}\n        $$\n        一个关键的观察是，如果压力相等 ($p_L=p_R$) 且速度相等 ($u_L=u_R=u$)，则 $S_*$ 的表达式简化为 $S_*=u$。这发生在测试案例 A 和 D 中。\n\n4.  **HLLC 物种通量计算：** 界面（其中 $x/t=0$）处的物种通量 $F_{\\rho Y_F}$ 取决于由波速定义的四个区域中的哪一个包含该界面。\n    -   如果 $0 \\le S_L$：$F_{\\rho Y_F} = F_L = \\rho_L u_L Y_{F,L}$\n    -   如果 $S_L  0 \\le S_*$：$F_{\\rho Y_F} = F_L + S_L (U_{*L} - U_L) = \\rho_L u_L Y_{F,L} + S_L \\left(\\rho_L Y_{F,L} \\frac{S_*-u_L}{S_L-S_*} \\right)$\n    -   如果 $S_*  0 \\le S_R$：$F_{\\rho Y_F} = F_R + S_R (U_{*R} - U_R) = \\rho_R u_R Y_{F,R} + S_R \\left(\\rho_R Y_{F,R} \\frac{S_*-u_R}{S_R-S_*} \\right)$\n    -   如果 $S_R \\le 0$：$F_{\\rho Y_F} = F_R = \\rho_R u_R Y_{F,R}$\n    中间物种状态 $(\\rho Y_F)_{*K}$ 由 $(\\rho Y_F)_{*K} = \\rho_{*K} Y_{F,K}$ 导出，其中 $\\rho_{*K}$ 在问题中已定义。上述通量表达式是物种分量的简化形式。\n\n5.  **参考平流通量计算：** 理想的、非扩散的通量是简单的上风通量 $F_{\\mathrm{adv}}$。由于 $u_L=u_R=u$，上风状态的选择仅取决于 $u$ 的符号。\n    -   如果 $u \\ge 0$：$F_{\\mathrm{adv}} = \\rho_L u Y_{F,L}$\n    -   如果 $u  0$：$F_{\\mathrm{adv}} = \\rho_R u Y_{F,R}$\n\n6.  **数值扩散量化：** 数值扩散是 HLLC 通量与理想平流通量之差的绝对值：\n    $$\n    \\mathcal{D} = |F_{\\rho Y_F} - F_{\\mathrm{adv}}|\n    $$\n\n此过程被系统地应用于四个测试案例的预处理和非预处理情景。\n\n- **案例 A 和 D (等压接触)：** 在这些案例中，$p_L = p_R$，这导致 $S_* = u$。这意味着 HLLC 求解器正确地将接触波速识别为物质速度。对于 $u>0$（案例 A），这导致 $S_L  0 \\le S_*$。HLLC 物种通量简化为 $F_{\\rho Y_F} = \\rho_L u Y_{F,L}$，这恰好是 $F_{\\mathrm{adv}}$。对于 $u0$（案例 D），$S_*  0 \\le S_R$ 且通量简化为 $F_{\\rho Y_F} = \\rho_R u Y_{F,R}$，这也恰好是 $F_{\\mathrm{adv}}$。因此，对于预处理和非预处理求解器，案例 A 和 D 中的数值扩散 $\\mathcal{D}$ 均为零。这是一个预期的结果，因为一个构造良好的 HLLC 求解器应该能够完美地解析一个孤立的接触间断面。\n\n- **案例 B 和 C (非等压接触)：** 此处，$p_L \\neq p_R$，因此 $S_* \\neq u$。\n    -   对于**非预处理**求解器 ($\\alpha=1$)，声波速度 $S_L$ 和 $S_R$ 很大（数量级为 $c$）。$S_*$ 与 $u$ 的偏差在 HLLC 通量计算中引入了一个非零修正项，导致 $F_{\\rho Y_F} \\neq F_{\\mathrm{adv}}$，从而产生非零的数值扩散 $\\mathcal{D}_{\\mathrm{un}} > 0$。\n    -   对于**预处理**求解器，$\\alpha = |M|$，这是一个小值。这极大地减小了估计的声波速度 $\\tilde{c}_K$ 的量级。对于 $M>0$，我们发现预处理估计给出 $u_L - \\tilde{c}_L = M c_L - M c_L = 0$，导致 $S_L=0$。通量计算随后属于第一种情况 ($0 \\le S_L$)，给出 $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L} = F_{\\mathrm{adv}}$。因此，预处理的数值扩散为 $\\mathcal{D}_{\\mathrm{pre}} = 0$。\n\n该分析证明了低马赫数预处理的有效性。通过在低马赫数极限下按比例缩小声波速度，求解器能正确地将流场识别为平流主导，并避免引入与数值上很大但物理上很弱的声波相关的伪扩散。预处理有效地将物种输运与微小的压力波动解耦。\n\n以下 Python 程序实现了这些计算，以找出所有八个所需量的数值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the numerical species diffusion for preconditioned and unpreconditioned\n    HLLC fluxes for various low-Mach number test cases.\n    \"\"\"\n\n    # --- Constants and Physical Parameters ---\n    GAMMA = 1.4\n    W_F = 16.0e-3  # kg/mol (Methane-like)\n    W_O = 32.0e-3  # kg/mol (Oxygen-like)\n    R_U = 8.314462618  # J/(mol*K)\n    EPSILON = 1.0e-6\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A: Happy path, strong composition contact\n        {'pL': 1.0e5, 'pR': 1.0e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.05},\n        # Case B: Small pressure jump at low Mach\n        {'pL': 1.001e5, 'pR': 0.999e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.05},\n        # Case C: Extremely low Mach with small pressure jump\n        {'pL': 1.0001e5, 'pR': 0.9999e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.001},\n        # Case D: Negative velocity contact\n        {'pL': 1.0e5, 'pR': 1.0e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': -0.05},\n    ]\n\n    def calculate_diffusion(case, preconditioned):\n        \"\"\"\n        Calculates the numerical diffusion for a single case setup.\n        \"\"\"\n        # Extract parameters from the case dictionary\n        pL, pR = case['pL'], case['pR']\n        TL, TR = case['TL'], case['TR']\n        YFL, YFR = case['YFL'], case['YFR']\n        M = case['M']\n\n        # --- Step 1: State Initialization ---\n        # Left state\n        W_L = 1.0 / (YFL / W_F + (1.0 - YFL) / W_O)\n        R_L = R_U / W_L\n        rho_L = pL / (R_L * TL)\n        c_L = np.sqrt(GAMMA * R_L * TL)\n        \n        # Right state\n        W_R = 1.0 / (YFR / W_F + (1.0 - YFR) / W_O)\n        R_R = R_U / W_R\n        rho_R = pR / (R_R * TR)\n        c_R = np.sqrt(GAMMA * R_R * TR)\n\n        # --- Step 2: Velocity and Preconditioning ---\n        u = M * c_L\n        uL = uR = u\n\n        if preconditioned:\n            alpha = max(abs(M), EPSILON)\n        else:\n            alpha = 1.0\n        \n        tilde_c_L = alpha * c_L\n        tilde_c_R = alpha * c_R\n        \n        # --- Step 3: HLLC Wave Speed Estimation ---\n        SL = min(uL - tilde_c_L, uR - tilde_c_R)\n        SR = max(uL + tilde_c_L, uR + tilde_c_R)\n\n        num_S_star = pR - pL + rho_L * uL * (SL - uL) - rho_R * uR * (SR - uR)\n        den_S_star = rho_L * (SL - uL) - rho_R * (SR - uR)\n        \n        if abs(den_S_star)  1e-12: # Avoid division by zero, though not expected here\n             # This case mainly happens for pL=pR and uL=uR, where S* = u\n             S_star = u\n        else:\n             S_star = num_S_star / den_S_star\n\n        # --- Step 4: HLLC Species Flux Calculation ---\n        flux_YL = rho_L * uL * YFL\n        flux_YR = rho_R * uR * YFR\n        rhoYF_L = rho_L * YFL\n        rhoYF_R = rho_R * YFR\n\n        if 0.0 = SL:\n            F_rhoYF = flux_YL\n        elif SL  0.0 = S_star:\n            # Simplified form of F_L + S_L * (U*L - U_L) for the species component\n            # U*L_rhoYF = rho*L * YFL = rho_L * (SL-uL)/(SL-S_star) * YFL\n            F_rhoYF = flux_YL + SL * (rho_L * YFL * (SL - uL) / (SL - S_star) - rhoYF_L)\n        elif S_star  0.0 = SR:\n            # Simplified form of F_R + S_R * (U*R - U_R) for the species component\n            # U*R_rhoYF = rho*R * YFR = rho_R * (SR-uR)/(SR-S_star) * YFR\n            F_rhoYF = flux_YR + SR * (rho_R * YFR * (SR - uR) / (SR - S_star) - rhoYF_R)\n        else:  # SR  0.0\n            F_rhoYF = flux_YR\n\n        # --- Step 5: Reference Advective Flux ---\n        if u >= 0.0:\n            F_adv = flux_YL\n        else:\n            F_adv = flux_YR\n            \n        # --- Step 6: Numerical Diffusion ---\n        D = abs(F_rhoYF - F_adv)\n        return D\n\n    results = []\n    for case in test_cases:\n        D_pre = calculate_diffusion(case, preconditioned=True)\n        D_un = calculate_diffusion(case, preconditioned=False)\n        results.extend([D_pre, D_un])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}