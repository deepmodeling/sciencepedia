{
    "hands_on_practices": [
        {
            "introduction": "The characteristic wave speeds used by approximate Riemann solvers are directly dependent on the local speed of sound, $a$. Before we can model the complex dynamics of reactive flows, we must first be able to accurately calculate this fundamental property. This exercise  will guide you through the process of computing $a$ from first principles for a multi-component gas mixture with temperature-dependent specific heats, reinforcing the critical link between thermodynamics and computational fluid dynamics.",
            "id": "4007463",
            "problem": "Consider a one-dimensional interface in a reactive flow where an approximate Riemann solver, such as the Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solver, requires the local speed of sound to set wave speed estimates. Assume a binary ideal-gas mixture with frozen composition and thermally perfect behavior (temperature-dependent specific heats on a mass basis). The mixture has mass fractions $Y_1=0.7$ and $Y_2=0.3$. The species mass-based heat capacities at constant pressure are given by $c_{p,1}(T)=a_1+b_1 T$ and $c_{p,2}(T)=a_2+b_2 T$, with $a_1=950\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, $b_1=0.10\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$, $a_2=730\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, and $b_2=0.40\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$. The species molecular weights are $W_1=28.0134\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ and $W_2=44.01\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$. Take the universal gas constant as $R_u=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. At a particular state, the mixture density and pressure are $\\rho=0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$ and $p=2.50\\times 10^{5}\\,\\mathrm{Pa}$.\n\nUsing only fundamental thermodynamic relations appropriate to an ideal-gas mixture with frozen composition, first compute the mixture ratio of specific heats $\\gamma_{mix}=c_{p,mix}/c_{v,mix}$ at this state, and then evaluate the local speed of sound $a$ appropriate for use in an approximate Riemann solver at that state.\n\nRound your final value of $a$ to four significant figures. Express the final speed of sound in $\\mathrm{m}\\,\\mathrm{s}^{-1}$.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard problem in thermodynamics and fluid dynamics relevant to computational reactive flows. All necessary data are provided, and the requested quantities can be uniquely determined.\n\nThe objective is to compute the local speed of sound, $a$, in a binary ideal-gas mixture with frozen composition and thermally perfect gases. The speed of sound in such a medium is given by the formula:\n$$ a = \\sqrt{\\gamma_{mix} \\frac{p}{\\rho}} = \\sqrt{\\gamma_{mix} R_{mix} T} $$\nwhere $p$ is the pressure, $\\rho$ is the density, $T$ is the temperature, $R_{mix}$ is the specific gas constant of the mixture, and $\\gamma_{mix}$ is the ratio of specific heats of the mixture, $c_{p,mix}/c_{v,mix}$. Since the specific heats are temperature-dependent, $\\gamma_{mix}$ is also a function of temperature. The calculation proceeds in several steps:\n$1$. Determine the mixture's specific gas constant, $R_{mix}$.\n$2$. Use the ideal gas law to find the temperature, $T$, of the mixture at the given state $(p, \\rho)$.\n$3$. Evaluate the mixture's specific heats, $c_{p,mix}$ and $c_{v,mix}$, at temperature $T$.\n$4$. Calculate the ratio of specific heats, $\\gamma_{mix}$, at temperature $T$.\n$5$. Compute the speed of sound, $a$.\n\nFirst, we calculate the mean molecular weight of the mixture, $W_{mix}$, using the given mass fractions, $Y_i$, and species molecular weights, $W_i$. The relation is:\n$$ \\frac{1}{W_{mix}} = \\sum_{i=1}^{2} \\frac{Y_i}{W_i} = \\frac{Y_1}{W_1} + \\frac{Y_2}{W_2} $$\nThe given values are $Y_1=0.7$, $Y_2=0.3$, $W_1=28.0134 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$, and $W_2=44.01 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$.\n$$ \\frac{1}{W_{mix}} = \\frac{0.7}{28.0134 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}} + \\frac{0.3}{44.01 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}} $$\n$$ \\frac{1}{W_{mix}} \\approx 24.98804\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1} + 6.81663\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1} \\approx 31.80467\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1} $$\nThe mixture's specific gas constant, $R_{mix}$, is then found using the universal gas constant, $R_u=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n$$ R_{mix} = \\frac{R_u}{W_{mix}} = R_u \\left( \\frac{Y_1}{W_1} + \\frac{Y_2}{W_2} \\right) $$\n$$ R_{mix} \\approx (8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (31.80467\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}) \\approx 264.4363\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\nNext, we determine the temperature of the mixture using the ideal gas law, $p = \\rho R_{mix} T$. The state is defined by $p=2.50 \\times 10^{5}\\,\\mathrm{Pa}$ and $\\rho=0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n$$ T = \\frac{p}{\\rho R_{mix}} \\approx \\frac{2.50 \\times 10^{5}\\,\\mathrm{Pa}}{(0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}) \\times (264.4363\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})} \\approx 1196.736\\,\\mathrm{K} $$\n\nWith the temperature known, we can calculate the species' mass-based specific heats at constant pressure, $c_{p,i}(T)$, using the provided polynomial expressions:\n$c_{p,1}(T) = a_1 + b_1 T$, with $a_1=950\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ and $b_1=0.10\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$.\n$$ c_{p,1}(1196.736\\,\\mathrm{K}) = 950 + 0.10 \\times 1196.736 \\approx 1069.674\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n$c_{p,2}(T) = a_2 + b_2 T$, with $a_2=730\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ and $b_2=0.40\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$.\n$$ c_{p,2}(1196.736\\,\\mathrm{K}) = 730 + 0.40 \\times 1196.736 \\approx 1208.694\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\nThe mixture's specific heat at constant pressure, $c_{p,mix}$, is the mass-fraction-weighted average of the species' specific heats:\n$$ c_{p,mix}(T) = \\sum_{i=1}^{2} Y_i c_{p,i}(T) = Y_1 c_{p,1}(T) + Y_2 c_{p,2}(T) $$\n$$ c_{p,mix}(1196.736\\,\\mathrm{K}) \\approx (0.7 \\times 1069.674) + (0.3 \\times 1208.694) \\approx 748.772 + 362.608 \\approx 1111.380\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\nThe mixture's specific heat at constant volume, $c_{v,mix}$, is found using Mayer's relation for an ideal-gas mixture:\n$$ c_{p,mix} - c_{v,mix} = R_{mix} \\implies c_{v,mix} = c_{p,mix} - R_{mix} $$\n$$ c_{v,mix} \\approx 1111.380\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} - 264.4363\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\approx 846.944\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\nNow, we can compute the ratio of specific heats for the mixture, $\\gamma_{mix}$, at the given state:\n$$ \\gamma_{mix} = \\frac{c_{p,mix}}{c_{v,mix}} \\approx \\frac{1111.380}{846.944} \\approx 1.31222 $$\n\nFinally, we calculate the speed of sound, $a$, using the fundamental relation for a thermally perfect gas mixture:\n$$ a = \\sqrt{\\gamma_{mix} \\frac{p}{\\rho}} $$\n$$ a \\approx \\sqrt{1.31222 \\times \\frac{2.50 \\times 10^{5}\\,\\mathrm{Pa}}{0.790\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}} \\approx \\sqrt{1.31222 \\times 316455.7\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} $$\n$$ a \\approx \\sqrt{415260.2\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} \\approx 644.407\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\nRounding the final value to four significant figures as requested, we get $a = 644.4\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.",
            "answer": "$$\n\\boxed{644.4}\n$$"
        },
        {
            "introduction": "With the ability to determine the local sound speed, we can begin to construct an approximate Riemann solver. The Harten-Lax-van Leer (HLL) solver provides a robust framework by estimating the fastest left- and right-moving wave speeds, $S_L$ and $S_R$, to bound the solution. This practice  challenges you to apply this concept to a detonation wave, a canonical problem in reactive flow, and to assess whether the HLL wave structure is sufficient to capture the propagating reactive shock.",
            "id": "4007497",
            "problem": "Consider a one-dimensional detonation interface at $x=0$ separating an upstream unburned mixture (left state) and a downstream burned mixture (right state). The flow is modeled by the reactive Euler equations with an ideal-gas equation of state for each side. The approximate Riemann solver of Harten–Lax–van Leer (HLL) for this reactive flow is constructed by bounding the fastest left- and right-running signal speeds of the homogeneous hyperbolic part of the reactive Euler system. The acoustic characteristics of the homogeneous system are the eigenvalues of the flux Jacobian, and these depend on the local flow speed and the sound speed.\n\nYou are given the following upstream (left) state, representing an unburned fuel–oxidizer mixture nominally at rest in the laboratory frame:\n- Flow speed $u_{L} = 0\\,\\mathrm{m/s}$,\n- Temperature $T_{L} = 300\\,\\mathrm{K}$,\n- Ratio of specific heats $\\gamma_{L} = 1.40$,\n- Effective mixture gas constant $R_{L} = 287\\,\\mathrm{J/(kg\\cdot K)}$.\n\nYou are given the following downstream (right) state, representing a hot burned product mixture convecting in the laboratory frame:\n- Flow speed $u_{R} = 1500\\,\\mathrm{m/s}$,\n- Temperature $T_{R} = 2800\\,\\mathrm{K}$,\n- Ratio of specific heats $\\gamma_{R} = 1.25$,\n- Effective mixture gas constant $R_{R} = 287\\,\\mathrm{J/(kg\\cdot K)}$.\n\nThe reactive shock (detonation) propagates in the laboratory frame at speed $D = 1950\\,\\mathrm{m/s}$, consistent with a near-Chapman–Jouguet detonation computed by the Zel’dovich–von Neumann–Döring (ZND) theory under comparable conditions.\n\nStarting from the characteristic structure of the homogeneous reactive Euler equations and the ideal-gas sound speed definition, derive expressions for the two HLL bounding speeds $S_{L}$ and $S_{R}$ in terms of the given state variables, evaluate them for the specified data, and then compute the diagnostic quantity\n$$\nm \\equiv \\min\\!\\big(D - S_{L},\\, S_{R} - D\\big),\n$$\nwhich quantifies whether the HLL fan bounds encompass the reactive shock speed (positivity indicates inclusion and provides the minimum margin to a fan edge). Express your final answer for $m$ in $\\mathrm{m/s}$ and round your result to four significant figures. Do not provide any intermediate values as the final answer; only report $m$ as specified.",
            "solution": "The problem requires the calculation of a diagnostic quantity, $m$, related to the Harten–Lax–van Leer (HLL) approximate Riemann solver applied to a one-dimensional detonation wave. The problem is first validated and found to be well-posed, scientifically grounded, and containing all necessary information.\n\nThe HLL solver approximates the solution to a Riemann problem by assuming a simplified wave structure consisting of the initial left state (L), a constant intermediate state, and the initial right state (R), separated by two waves propagating at speeds $S_L$ and $S_R$. These speeds are chosen to bound the slowest- and fastest-moving waves of the true solution. For the Euler equations, the characteristic speeds are given by the eigenvalues of the flux Jacobian, which are $u-c$, $u$, and $u+c$, where $u$ is the local fluid velocity and $c$ is the local speed of sound.\n\nA standard and robust choice for the HLL bounding speeds, consistent with the problem's description of \"bounding the fastest left- and right-running signal speeds,\" is to take the minimum and maximum of the extremal characteristic speeds from the initial left and right states. This leads to the following expressions for $S_L$ and $S_R$:\n$$\nS_L = \\min(u_L - c_L, u_R - c_R)\n$$\n$$\nS_R = \\max(u_L + c_L, u_R + c_R)\n$$\nHere, $u_L$ and $c_L$ are the velocity and sound speed of the upstream (left) state, and $u_R$ and $c_R$ are the corresponding quantities for the downstream (right) state.\n\nThe speed of sound, $c$, for an ideal gas is defined by the relation:\n$$\nc = \\sqrt{\\gamma R T}\n$$\nwhere $\\gamma$ is the ratio of specific heats, $R$ is the specific gas constant, and $T$ is the absolute temperature.\n\nFirst, we calculate the sound speed for the upstream (left) state, $c_L$. The given parameters are $u_L = 0\\,\\mathrm{m/s}$, $T_L = 300\\,\\mathrm{K}$, $\\gamma_L = 1.40$, and $R_L = 287\\,\\mathrm{J/(kg \\cdot K)}$.\n$$\nc_L = \\sqrt{\\gamma_L R_L T_L} = \\sqrt{(1.40)(287\\,\\mathrm{J/(kg \\cdot K)})(300\\,\\mathrm{K})} = \\sqrt{120540\\,\\mathrm{m^2/s^2}} \\approx 347.1887\\,\\mathrm{m/s}\n$$\n\nNext, we calculate the sound speed for the downstream (right) state, $c_R$. The given parameters are $u_R = 1500\\,\\mathrm{m/s}$, $T_R = 2800\\,\\mathrm{K}$, $\\gamma_R = 1.25$, and $R_R = 287\\,\\mathrm{J/(kg \\cdot K)}$.\n$$\nc_R = \\sqrt{\\gamma_R R_R T_R} = \\sqrt{(1.25)(287\\,\\mathrm{J/(kg \\cdot K)})(2800\\,\\mathrm{K})} = \\sqrt{1004500\\,\\mathrm{m^2/s^2}} \\approx 1002.2475\\,\\mathrm{m/s}\n$$\n\nNow, we can compute the extremal characteristic speeds for both states:\nFor the left state:\n$$\nu_L - c_L = 0\\,\\mathrm{m/s} - 347.1887\\,\\mathrm{m/s} = -347.1887\\,\\mathrm{m/s}\n$$\n$$\nu_L + c_L = 0\\,\\mathrm{m/s} + 347.1887\\,\\mathrm{m/s} = 347.1887\\,\\mathrm{m/s}\n$$\nFor the right state:\n$$\nu_R - c_R = 1500\\,\\mathrm{m/s} - 1002.2475\\,\\mathrm{m/s} = 497.7525\\,\\mathrm{m/s}\n$$\n$$\nu_R + c_R = 1500\\,\\mathrm{m/s} + 1002.2475\\,\\mathrm{m/s} = 2502.2475\\,\\mathrm{m/s}\n$$\n\nUsing these values, we determine the HLL bounding speeds $S_L$ and $S_R$:\n$$\nS_L = \\min(-347.1887\\,\\mathrm{m/s}, 497.7525\\,\\mathrm{m/s}) = -347.1887\\,\\mathrm{m/s}\n$$\n$$\nS_R = \\max(347.1887\\,\\mathrm{m/s}, 2502.2475\\,\\mathrm{m/s}) = 2502.2475\\,\\mathrm{m/s}\n$$\n\nFinally, we compute the diagnostic quantity $m$, which measures the minimum \"gap\" between the detonation speed $D$ and the HLL wave fan speeds. The detonation speed is given as $D = 1950\\,\\mathrm{m/s}$.\n$$\nm = \\min(D - S_L, S_R - D)\n$$\nWe calculate the two arguments of the minimum function:\n$$\nD - S_L = 1950\\,\\mathrm{m/s} - (-347.1887\\,\\mathrm{m/s}) = 2297.1887\\,\\mathrm{m/s}\n$$\n$$\nS_R - D = 2502.2475\\,\\mathrm{m/s} - 1950\\,\\mathrm{m/s} = 552.2475\\,\\mathrm{m/s}\n$$\nTherefore, $m$ is the minimum of these two values:\n$$\nm = \\min(2297.1887\\,\\mathrm{m/s}, 552.2475\\,\\mathrm{m/s}) = 552.2475\\,\\mathrm{m/s}\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\nm \\approx 552.2\\,\\mathrm{m/s}\n$$\nThe positive value of $m$ indicates that the HLL wave fan, with boundaries $[S_L, S_R]$, successfully brackets the detonation speed $D$.",
            "answer": "$$\\boxed{552.2}$$"
        },
        {
            "introduction": "While standard approximate Riemann solvers are effective for highly compressible flows, they often introduce excessive numerical diffusion in low-Mach-number regimes common to combustion. This practice  explores a crucial advanced technique, low-Mach number preconditioning, applied to the Harten-Lax-van Leer-Contact (HLLC) solver. By quantifying the numerical diffusion at a species contact front, you will gain hands-on insight into how this modification dramatically improves the accuracy of simulations for advection-dominated reactive flows.",
            "id": "4007521",
            "problem": "Consider the one-dimensional, inviscid, multicomponent reactive flow governed by the Euler equations augmented by a single passive species conservation equation. The conserved variables are $\\rho$, $\\rho u$, $E$, and $\\rho Y_F$, where $\\rho$ is the mass density in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $u$ is the velocity in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $E$ is the total energy density in $\\mathrm{J}\\,\\mathrm{m}^{-3}$, and $Y_F$ is the fuel mass fraction (dimensionless). Assume a binary ideal-gas mixture of a fuel and an oxidizer with constant ratio of specific heats $\\gamma$ and composition-dependent specific gas constant $R(Y_F)$. The universal gas constant is $R_u$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and the molecular weights are $W_F$ and $W_O$ in $\\mathrm{kg}\\,\\mathrm{mol}^{-1}$. The mixture molecular weight is\n$$\nW(Y_F) = \\left(\\frac{Y_F}{W_F} + \\frac{1-Y_F}{W_O}\\right)^{-1},\n$$\nand the mixture specific gas constant is\n$$\nR(Y_F) = \\frac{R_u}{W(Y_F)}.\n$$\nFor thermodynamic closure, use the ideal-gas relation $p = \\rho R(Y_F) T$ with pressure $p$ in $\\mathrm{Pa}$ and temperature $T$ in $\\mathrm{K}$, and the total energy density\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2.\n$$\nThe speed of sound is $c = \\sqrt{\\gamma R(Y_F) T}$ and the Mach number is $M = \\frac{u}{c}$.\n\nYou will compute the Harten-Lax-van Leer-Contact (HLLC) approximate Riemann flux at a single interface with a strong composition gradient at low Mach number and compare the preconditioned versus unpreconditioned flux in terms of numerical species diffusion. Preconditioning is applied by scaling acoustic signals with a factor $\\alpha$ based on the local Mach number; specifically, define $\\tilde{c} = \\alpha c$ with $\\alpha = \\max(|M|,\\varepsilon)$ and $\\varepsilon = 10^{-6}$ to avoid degeneracy, and use $\\tilde{c}$ in all wave-speed estimates of the Riemann solver. This low-Mach preconditioning reduces excessive acoustic dissipation and is widely used in computational combustion to improve accuracy at $M \\ll 1$.\n\nLet left ($L$) and right ($R$) states be given by $(p_K, T_K, Y_{F,K})$ for $K \\in \\{L,R\\}$. Construct $\\rho_K = \\frac{p_K}{R(Y_{F,K}) T_K}$, $c_K = \\sqrt{\\gamma R(Y_{F,K}) T_K}$, and set the interface velocity $u_K = M c_L$ on both sides so that the interface Mach number is referenced to the left sound speed. Define the HLLC wave speeds using the Davis estimate with preconditioned acoustics:\n$$\nS_L = \\min(u_L - \\tilde{c}_L, u_R - \\tilde{c}_R), \\quad\nS_R = \\max(u_L + \\tilde{c}_L, u_R + \\tilde{c}_R),\n$$\nand the contact wave speed\n$$\nS_* = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)}.\n$$\nThe corresponding star-region densities are\n$$\n\\rho_{*L} = \\rho_L \\frac{S_L - u_L}{S_L - S_*}, \\quad\n\\rho_{*R} = \\rho_R \\frac{S_R - u_R}{S_R - S_*}.\n$$\nTreat the species as a passive scalar advected by the HLLC contact wave, with star-region species masses $(\\rho Y_F)_{*L} = \\rho_{*L} Y_{F,L}$ and $(\\rho Y_F)_{*R} = \\rho_{*R} Y_{F,R}$. The species flux component $F_{\\rho Y_F}$ across the interface is then obtained from the HLLC flux selection:\n- If $0 \\le S_L$, then $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L}$,\n- If $S_L  0 \\le S_*$, then $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L} + S_L\\left[(\\rho Y_F)_{*L} - \\rho_L Y_{F,L}\\right]$,\n- If $S_*  0 \\le S_R$, then $F_{\\rho Y_F} = \\rho_R u_R Y_{F,R} + S_R\\left[(\\rho Y_F)_{*R} - \\rho_R Y_{F,R}\\right]$,\n- If $S_R \\le 0$, then $F_{\\rho Y_F} = \\rho_R u_R Y_{F,R}$.\n\nDefine the pure advective upwind species flux by\n$$\nF_{\\mathrm{adv}} = u_{\\mathrm{up}} \\rho_{\\mathrm{up}} Y_{F,\\mathrm{up}},\n$$\nwhere the upwind state is selected by the sign of $u$ (use the left state if $u \\ge 0$, otherwise the right state). Quantify numerical species diffusion as\n$$\n\\mathcal{D} = \\left|F_{\\rho Y_F} - F_{\\mathrm{adv}}\\right|,\n$$\nwith units $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nCompute $\\mathcal{D}$ for both the preconditioned and unpreconditioned HLLC fluxes at the following test cases, each scientifically plausible and internally consistent:\n\n- Case A (happy path, strong composition contact): $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $p_R = 1.0\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = +0.05$.\n- Case B (small pressure jump at low Mach): $p_L = 1.001\\times10^5\\,\\mathrm{Pa}$, $p_R = 0.999\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = +0.05$.\n- Case C (extremely low Mach with small pressure jump): $p_L = 1.0001\\times10^5\\,\\mathrm{Pa}$, $p_R = 0.9999\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = +0.001$.\n- Case D (negative velocity contact): $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $p_R = 1.0\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = -0.05$.\n\nUse $\\gamma = 1.4$, $W_F = 16\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ (methane-like fuel), $W_O = 32\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ (oxygen), and $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. For each case, compute the preconditioned numerical diffusion $\\mathcal{D}_{\\mathrm{pre}}$ with $\\alpha = \\max(|M|,10^{-6})$ and the unpreconditioned numerical diffusion $\\mathcal{D}_{\\mathrm{un}}$ with $\\alpha = 1$. Express all fluxes and diffusion magnitudes in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\mathcal{D}_{\\mathrm{pre}}^{A}, \\mathcal{D}_{\\mathrm{un}}^{A}, \\mathcal{D}_{\\mathrm{pre}}^{B}, \\mathcal{D}_{\\mathrm{un}}^{B}, \\mathcal{D}_{\\mathrm{pre}}^{C}, \\mathcal{D}_{\\mathrm{un}}^{C}, \\mathcal{D}_{\\mathrm{pre}}^{D}, \\mathcal{D}_{\\mathrm{un}}^{D}],\n$$\neach a floating-point number in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.",
            "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically the formulation of the Harten-Lax-van Leer-Contact (HLLC) approximate Riemann solver for the Euler equations with a passive scalar. The problem is well-posed, with all necessary parameters, equations, and boundary conditions provided for a unique solution. The numerical values are physically plausible for low-Mach number combustion scenarios.\n\nThe objective is to quantify the numerical diffusion of a passive species (fuel mass fraction $Y_F$) across a contact discontinuity, comparing the standard HLLC solver with a low-Mach preconditioned variant. The numerical diffusion, $\\mathcal{D}$, is defined as the absolute difference between the HLLC species flux, $F_{\\rho Y_F}$, and a reference purely advective upwind flux, $F_{\\mathrm{adv}}$.\n\nThe solution proceeds by implementing the specified algorithm for each test case, once with preconditioning and once without. The core steps for each calculation are as follows:\n\n1.  **State Initialization:** For each side of the interface, left ($L$) and right ($R$), the primitive variables $(p_K, T_K, Y_{F,K})$ are used to compute the required thermodynamic and gas-dynamic properties.\n    -   The mixture molecular weight $W_K$ is calculated using the formula $W(Y_{F,K}) = \\left(\\frac{Y_{F,K}}{W_F} + \\frac{1-Y_{F,K}}{W_O}\\right)^{-1}$.\n    -   The mixture specific gas constant is $R_K = R(Y_{F,K}) = \\frac{R_u}{W_K}$.\n    -   The density is found from the ideal gas law: $\\rho_K = \\frac{p_K}{R_K T_K}$.\n    -   The speed of sound is $c_K = \\sqrt{\\gamma R_K T_K}$.\n\n2.  **Velocity and Preconditioning Setup:**\n    -   The velocity is set to be uniform across the interface, determined by the Mach number $M$ and the left-side sound speed: $u_L = u_R = u = M c_L$.\n    -   The preconditioning factor $\\alpha$ is determined. For the unpreconditioned case, $\\alpha=1$. For the preconditioned case, $\\alpha = \\max(|M|, \\varepsilon)$, where $\\varepsilon=10^{-6}$.\n    -   The acoustically scaled sound speeds are then $\\tilde{c}_K = \\alpha c_K$.\n\n3.  **HLLC Wave Speed Estimation:** The three characteristic wave speeds of the HLLC solver are estimated.\n    -   The fastest left- and right-propagating acoustic wave speeds, $S_L$ and $S_R$, are estimated using the Davis formulation with the (preconditioned) sound speeds:\n        $$\n        S_L = \\min(u_L - \\tilde{c}_L, u_R - \\tilde{c}_R)\n        $$\n        $$\n        S_R = \\max(u_L + \\tilde{c}_L, u_R + \\tilde{c}_R)\n        $$\n    -   The contact wave speed, $S_*$, is calculated from the jump conditions across the acoustic waves:\n        $$\n        S_* = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)}\n        $$\n        A crucial observation is that if the pressures are equal ($p_L=p_R$) and velocities are equal ($u_L=u_R=u$), the expression for $S_*$ simplifies to $S_*=u$. This occurs in test cases A and D.\n\n4.  **HLLC Species Flux Calculation:** The species flux $F_{\\rho Y_F}$ at the interface (where $x/t=0$) is determined by which of the four regions defined by the wave speeds contains the interface.\n    -   If $0 \\le S_L$: $F_{\\rho Y_F} = F_L = \\rho_L u_L Y_{F,L}$\n    -   If $S_L  0 \\le S_*$: $F_{\\rho Y_F} = F_L + S_L (U_{*L} - U_L) = \\rho_L u_L Y_{F,L} + S_L \\left(\\rho_L Y_{F,L} \\frac{S_*-u_L}{S_L-S_*} \\right)$\n    -   If $S_*  0 \\le S_R$: $F_{\\rho Y_F} = F_R + S_R (U_{*R} - U_R) = \\rho_R u_R Y_{F,R} + S_R \\left(\\rho_R Y_{F,R} \\frac{S_*-u_R}{S_R-S_*} \\right)$\n    -   If $S_R \\le 0$: $F_{\\rho Y_F} = F_R = \\rho_R u_R Y_{F,R}$\n    The intermediate species states $(\\rho Y_F)_{*K}$ are derived from $(\\rho Y_F)_{*K} = \\rho_{*K} Y_{F,K}$ with $\\rho_{*K}$ defined in the problem. The flux expressions above are simplified forms for the species component.\n\n5.  **Reference Advective Flux Calculation:** The ideal, non-diffusive flux is the simple upwind flux $F_{\\mathrm{adv}}$. Since $u_L=u_R=u$, the choice of upwind state depends only on the sign of $u$.\n    -   If $u \\ge 0$: $F_{\\mathrm{adv}} = \\rho_L u Y_{F,L}$\n    -   If $u  0$: $F_{\\mathrm{adv}} = \\rho_R u Y_{F,R}$\n\n6.  **Numerical Diffusion Quantification:** The numerical diffusion is the magnitude of the difference between the HLLC flux and the ideal advective flux:\n    $$\n    \\mathcal{D} = |F_{\\rho Y_F} - F_{\\mathrm{adv}}|\n    $$\n\nThis procedure is systematically applied to the four test cases for both preconditioned and unpreconditioned scenarios.\n\n- **Cases A and D (isobaric contact):** In these cases, $p_L = p_R$, which leads to $S_* = u$. This means the HLLC solver correctly identifies the contact wave speed as the material velocity. For $u>0$ (Case A), this results in $S_L0 \\le S_*$. The HLLC species flux simplifies to $F_{\\rho Y_F} = \\rho_L u Y_{F,L}$, which is exactly $F_{\\mathrm{adv}}$. For $u0$ (Case D), $S_*  0 \\le S_R$ and the flux simplifies to $F_{\\rho Y_F} = \\rho_R u Y_{F,R}$, which is also $F_{\\mathrm{adv}}$. Therefore, for both preconditioned and unpreconditioned solvers, the numerical diffusion $\\mathcal{D}$ is zero in Cases A and D. This is an expected result, as a well-constructed HLLC solver should perfectly resolve an isolated contact discontinuity.\n\n- **Cases B and C (non-isobaric contact):** Here, $p_L \\neq p_R$, so $S_* \\neq u$.\n    -   For the **unpreconditioned** solver ($\\alpha=1$), the acoustic wave speeds $S_L$ and $S_R$ are large (order $c$). The deviation of $S_*$ from $u$ introduces a non-zero correction term in the HLLC flux calculation, leading to $F_{\\rho Y_F} \\neq F_{\\mathrm{adv}}$ and thus a non-zero numerical diffusion $\\mathcal{D}_{\\mathrm{un}} > 0$.\n    -   For the **preconditioned** solver, $\\alpha = |M|$, which is small. This drastically reduces the magnitude of the estimated acoustic wave speeds $\\tilde{c}_K$. For $M>0$, we find that the preconditioned estimate gives $u_L - \\tilde{c}_L = M c_L - M c_L = 0$, and since $c_R$ is different from $c_L$, $u_R - \\tilde{c}_R = M(c_L - c_R) \\neq 0$. This leads to $S_L=0$ (or a value very close to it if $c_L  c_R$). The flux calculation then falls into the first case ($0 \\le S_L$), giving $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L} = F_{\\mathrm{adv}}$. Consequently, the preconditioned numerical diffusion is $\\mathcal{D}_{\\mathrm{pre}} = 0$.\n\nThis analysis demonstrates the efficacy of low-Mach preconditioning. By scaling down the acoustic wave speeds in the low-Mach limit, the solver correctly identifies the flow as advection-dominated and avoids introducing spurious diffusion associated with acoustic waves that are numerically large but physically weak. The preconditioning effectively decouples the species transport from the small pressure fluctuations.\n\nThe following Python program implements these calculations to find the numerical values for all eight required quantities.\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the numerical species diffusion for preconditioned and unpreconditioned\n    HLLC fluxes for various low-Mach number test cases.\n    \"\"\"\n\n    # --- Constants and Physical Parameters ---\n    GAMMA = 1.4\n    W_F = 16.0e-3  # kg/mol (Methane-like)\n    W_O = 32.0e-3  # kg/mol (Oxygen-like)\n    R_U = 8.314462618  # J/(mol*K)\n    EPSILON = 1.0e-6\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A: Happy path, strong composition contact\n        {'pL': 1.0e5, 'pR': 1.0e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.05},\n        # Case B: Small pressure jump at low Mach\n        {'pL': 1.001e5, 'pR': 0.999e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.05},\n        # Case C: Extremely low Mach with small pressure jump\n        {'pL': 1.0001e5, 'pR': 0.9999e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.001},\n        # Case D: Negative velocity contact\n        {'pL': 1.0e5, 'pR': 1.0e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': -0.05},\n    ]\n\n    def calculate_diffusion(case, preconditioned):\n        \"\"\"\n        Calculates the numerical diffusion for a single case setup.\n        \"\"\"\n        # Extract parameters from the case dictionary\n        pL, pR = case['pL'], case['pR']\n        TL, TR = case['TL'], case['TR']\n        YFL, YFR = case['YFL'], case['YFR']\n        M = case['M']\n\n        # --- Step 1: State Initialization ---\n        # Left state\n        W_L = 1.0 / (YFL / W_F + (1.0 - YFL) / W_O)\n        R_L = R_U / W_L\n        rho_L = pL / (R_L * TL)\n        c_L = np.sqrt(GAMMA * R_L * TL)\n        \n        # Right state\n        W_R = 1.0 / (YFR / W_F + (1.0 - YFR) / W_O)\n        R_R = R_U / W_R\n        rho_R = pR / (R_R * TR)\n        c_R = np.sqrt(GAMMA * R_R * TR)\n\n        # --- Step 2: Velocity and Preconditioning ---\n        u = M * c_L\n        uL = uR = u\n\n        if preconditioned:\n            alpha = max(abs(M), EPSILON)\n        else:\n            alpha = 1.0\n        \n        tilde_c_L = alpha * c_L\n        tilde_c_R = alpha * c_R\n        \n        # --- Step 3: HLLC Wave Speed Estimation ---\n        SL = min(uL - tilde_c_L, uR - tilde_c_R)\n        SR = max(uL + tilde_c_L, uR + tilde_c_R)\n\n        num_S_star = pR - pL + rho_L * uL * (SL - uL) - rho_R * uR * (SR - uR)\n        den_S_star = rho_L * (SL - uL) - rho_R * (SR - uR)\n        \n        if abs(den_S_star)  1e-12: # Avoid division by zero, though not expected here\n             # This case mainly happens for pL=pR and uL=uR, where S* = u\n             S_star = u\n        else:\n             S_star = num_S_star / den_S_star\n\n        # --- Step 4: HLLC Species Flux Calculation ---\n        flux_YL = rho_L * uL * YFL\n        flux_YR = rho_R * uR * YFR\n        rhoYF_L = rho_L * YFL\n        rhoYF_R = rho_R * YFR\n\n        if 0.0 = SL:\n            F_rhoYF = flux_YL\n        elif SL  0.0 = S_star:\n            F_rhoYF = flux_YL + SL * (rho_L * YFL * (SL - uL) / (SL - S_star) - rhoYF_L)\n        elif S_star  0.0 = SR:\n            F_rhoYF = flux_YR + SR * (rho_R * YFR * (SR - uR) / (SR - S_star) - rhoYF_R)\n        else:  # SR  0.0\n            F_rhoYF = flux_YR\n\n        # --- Step 5: Reference Advective Flux ---\n        if u >= 0.0:\n            F_adv = flux_YL\n        else:\n            F_adv = flux_YR\n            \n        # --- Step 6: Numerical Diffusion ---\n        D = abs(F_rhoYF - F_adv)\n        return D\n\n    results = []\n    for case in test_cases:\n        D_pre = calculate_diffusion(case, preconditioned=True)\n        D_un = calculate_diffusion(case, preconditioned=False)\n        results.extend([D_pre, D_un])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```",
            "answer": "[0.0,0.0,0.0,1.2185591136,0.0,0.048737678505,0.0,0.0]"
        }
    ]
}