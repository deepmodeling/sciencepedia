## 引言
模拟燃烧等[瞬态反应流](@entry_id:1133328)现象在能源、动力和安全领域具有至关重要的意义，但其数值求解极具挑战性。这些流动通常涉及[流体动力](@entry_id:750449)学、化学反应和热量传递之间复杂而紧密的耦合。特别是，在流速远低于声速（[低马赫数](@entry_id:1127478)）但密度因剧烈热释放而发生显著变化的场景中，如何高效、准确地求解压力与速度场的耦合成为一个核心难题。传统的不可压缩流或完全[可压缩流求解器](@entry_id:1122759)在此类问题上均面临效率或精度瓶颈。

为解决这一关键问题，压力隐式算子分裂（Pressure-Implicit with Splitting of Operators, PISO）算法应运而生。本文旨在系统性地剖析[PISO算法](@entry_id:155035)的理论、实现与应用。读者将通过本文学习到：

在 **“原理与机制”** 一章中，我们将从[低马赫数反应流](@entry_id:1127483)的控制方程出发，深入探讨[PISO算法](@entry_id:155035)的理论基础，特别是其如何通过压力修正来满足[变密度流](@entry_id:1133711)中的非零散度约束，并详细拆解其“预测-修正”的计算流程与关键数值技术。

接着，在 **“应用与跨学科联系”** 一章中，我们将视野扩展到实际工程问题，展示[PISO算法](@entry_id:155035)如何与湍流模型、[多相流](@entry_id:146480)模型相结合，并介绍其增强版PIMPLE算法在处理强[非线性](@entry_id:637147)耦合时的优势，揭示其在不同科学与工程领域的广泛适用性。

最后，**“动手实践”** 部分提供了一系列精心设计的计算问题，旨在帮助读者将理论知识转化为实践技能，加深对动量预测、[通量修正](@entry_id:1125150)以及[速度散度](@entry_id:264117)物理意义等核心概念的理解。

## 原理与机制

本章旨在深入探讨在[瞬态反应流](@entry_id:1133328)模拟中，压力隐式[算子分裂](@entry_id:634210)（Pressure-Implicit with Splitting of Operators, PISO）算法的核心原理与关键机制。作为一种为求解[瞬态流](@entry_id:756109)动问题而设计的非迭代压力-速度耦合算法，PISO 在计算燃烧学领域扮演着至关重要的角色。我们将从[低马赫数反应流](@entry_id:1127483)的控制方程出发，系统地阐述 PISO 算法的理论基础、实施步骤、以及在处理变密度和化学反应等复杂现象时所面临的独特挑战与解决方案。

### [低马赫数反应流](@entry_id:1127483)的控制方程

在深入 PISO 算法的数值细节之前，我们必须首先明确需要求解的物理模型。对于典型的燃烧问题，流体[马赫数](@entry_id:274014)（$M$）通常远小于 1，这意味着与声波传播相关的可压缩效应可以被忽略。这种 **[低马赫数近似](@entry_id:1127479)（low-Mach-number approximation）** 极大地简化了控制方程，因为它允许我们将压[力场](@entry_id:147325)分解为两部分：一个在空间上均匀但可能随时间变化的[热力学压力](@entry_id:1133073) $p_0(t)$，以及一个在空间上变化的[流体动力](@entry_id:750449)学扰动压力 $p'(\mathbf{x},t)$。总压力为 $p(\mathbf{x},t) = p_0(t) + p'(\mathbf{x},t)$。在这种近似下，声波被滤除，数值求解的时间步长不再受限于声速（CFL 条件），从而显著提高了[计算效率](@entry_id:270255)。

对于一个包含 $N_{\mathrm{s}}$ 个组分的变密度化学反应混合物，其控制方程组在[低马赫数](@entry_id:1127478)极限下可以写作以下守恒形式 ：

1.  **[质量守恒](@entry_id:204015)方程（连续性方程）**：即使密度 $\rho$ 由于热释放和组分变化而剧烈变化，总质量依然守恒。其守恒形式为：
    $$
    \frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0
    $$
    此方程的成立基于化学反应本身不产生或消灭质量，即所有组分的化学源项之和为零：$\sum_{k=1}^{N_{\mathrm{s}}} \dot{\omega}_k = 0$。

2.  **组分质量守恒方程**：对每个组分 $k$，其[质量守恒](@entry_id:204015)方程描述了对流、扩散和化学反应对其质量分数 $Y_k$ 的影响：
    $$
    \frac{\partial (\rho Y_k)}{\partial t} + \nabla \cdot (\rho \mathbf{u} Y_k) = -\nabla \cdot \mathbf{J}_k + \dot{\omega}_k
    $$
    其中 $\mathbf{J}_k$ 是组分 $k$ 的扩散质量通量，$\dot{\omega}_k$ 是其化学反应源项。在混合物平均扩散模型中，所有组分的[扩散通量](@entry_id:748422)之和为零：$\sum_{k=1}^{N_{\mathrm{s}}} \mathbf{J}_k = \mathbf{0}$。

3.  **动量守恒方程**：根据牛顿第二定律，[动量方程](@entry_id:197225)为：
    $$
    \frac{\partial (\rho \mathbf{u})}{\partial t} + \nabla \cdot (\rho \mathbf{u} \mathbf{u}) = -\nabla p' + \nabla \cdot \boldsymbol{\tau} + \rho \mathbf{g}
    $$
    值得注意的是，在动量方程中，只有流体动力学压力扰动 $p'$ 的梯度 $\nabla p'$ 被保留。这是因为空间均匀的[热力学压力](@entry_id:1133073) $p_0(t)$ 的梯度为零（$\nabla p_0 = \mathbf{0}$），因此它不对流体产生驱动力。$p'$ 的作用是作为一个力学约束，确保速度场 $\mathbf{u}$ 满足连续性方程所隐含的运动学约束。

4.  **能量守恒方程（显焓形式）**：在[低马赫数近似](@entry_id:1127479)下，与声学相关的压力功项（如 $p \nabla \cdot \mathbf{u}$）和动能项在能量方程中是高阶小量，可以忽略。因此，使用显焓 $h = \sum_{k=1}^{N_{\mathrm{s}}} Y_k h_k(T)$ 作为能量变量是自然且高效的选择，其中 $h_k(T)$ 包含了生成焓。能量方程的[守恒形式](@entry_id:1122899)为：
    $$
    \frac{\partial (\rho h)}{\partial t} + \nabla \cdot (\rho \mathbf{u} h) = \nabla \cdot (\lambda \nabla T) - \nabla \cdot \left(\sum_{k=1}^{N_{\mathrm{s}}} h_k \mathbf{J}_k\right) + \frac{Dp_0}{Dt} + \boldsymbol{\tau} : \nabla\mathbf{u}
    $$
    右侧各项分别代表：傅里叶[热传导](@entry_id:143509)、由组分扩散引起的焓输运、背景压力变化引起的做功项以及粘性耗散。在许多[低马赫数燃烧](@entry_id:1127480)模型中，后两项（压力功和[粘性耗散](@entry_id:143708)）的量级也远小于[化学热释放](@entry_id:1122340)，因此常常被忽略以进一步简化模型。

最后，通过[状态方程](@entry_id:274378)将[热力学变量](@entry_id:160587)联系起来。对于[理想气体混合物](@entry_id:149212)，[状态方程](@entry_id:274378)为 $\rho = \frac{p_0 \bar{W}}{R_u T}$，其中 $\bar{W}$ 是混合物平均分子量，依赖于组分[质量分数](@entry_id:161575) $Y_k$。这组方程构成了我们使用 PISO 算法求解的基础。

### [变密度流](@entry_id:1133711)中的散度约束

在经典的不可压缩流体中，密度 $\rho$ 为常数，[连续性方程](@entry_id:195013)简化为 $\nabla \cdot \mathbf{u} = 0$，即速度场是无散的。压[力场](@entry_id:147325)的作用就是确保这一约束得以满足。然而，在[反应流](@entry_id:190741)中，情况发生了根本性的变化。化学反应释放的热量导致温度急剧升高，进而引起密度的显著降低（热膨胀）。

为了更清晰地理解这一点，我们可以将[连续性方程](@entry_id:195013)改写为物质导数（material derivative）的形式。物质导数 $\frac{D\phi}{Dt} = \frac{\partial \phi}{\partial t} + \mathbf{u} \cdot \nabla\phi$ 描述了跟随流体微团移动时物理量 $\phi$ 的变化率。连续性方程 $\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0$ 可以展开为 $\frac{\partial \rho}{\partial t} + \mathbf{u} \cdot \nabla\rho + \rho \nabla \cdot \mathbf{u} = 0$，即：
$$
\frac{1}{\rho}\frac{D\rho}{Dt} + \nabla \cdot \mathbf{u} = 0
$$
这导出了一个至关重要的关系：
$$
\nabla \cdot \mathbf{u} = -\frac{1}{\rho}\frac{D\rho}{Dt}
$$
这个方程表明，在[变密度流](@entry_id:1133711)中，速度场不再是无散的。其散度由流体微团密度的相对变化率决定。在燃烧场（如火焰面）中，$\frac{D\rho}{Dt}$ 是一个很大的负值（密度急剧减小），因此速度场在该处具有一个很强的正散度，表现为流体向外膨胀。

我们可以进一步探究密度变化率的来源  。以[理想气体混合物](@entry_id:149212)为例，$\rho = \frac{p_0}{R(Y)T}$。对其取对数并求[物质导数](@entry_id:262900)，可得：
$$
\frac{1}{\rho}\frac{D\rho}{Dt} = \frac{1}{p_0}\frac{Dp_0}{Dt} - \frac{1}{T}\frac{DT}{Dt} - \frac{1}{R}\frac{DR}{Dt}
$$
其中 $R(Y)$ 是依赖于组分 $Y_k$ 的混合气体常数。由于 $p_0$ 仅随时间变化，$\frac{Dp_0}{Dt} = \frac{dp_0}{dt}$。因此，[速度散度](@entry_id:264117)约束最终可以写为：
$$
\nabla \cdot \mathbf{u} = \frac{1}{T}\frac{DT}{Dt} + \frac{1}{R}\sum_{k=1}^{N_{\mathrm{s}}} R_k \frac{DY_k}{Dt} - \frac{1}{p_0}\frac{dp_0}{dt}
$$
此表达式明确揭示了[速度散度](@entry_id:264117)的三个物理来源：(i) 温度变化（主要由热释放驱动），(ii) 组分变化（化学反应改变了混合物平均分子量），以及 (iii) 背景压力的变化。在 PISO 算法中，[压力修正方程](@entry_id:156602)的核心任务就是求解一个压[力场](@entry_id:147325)，以驱动速度场满足这个非零的散度约束。这个散度项，通常记为 $S_\rho = -\frac{1}{\rho}\frac{D\rho}{Dt}$，构成了压力泊松方程的源项。

### PISO 算法流程

PISO 算法通过一个“预测-修正”序列来[解耦](@entry_id:160890)并求解动量和连续性方程。对于从时间层 $n$ 到 $n+1$ 的一个时间步，其核心步骤如下 ：

1.  **动量预测步 (Momentum Predictor)**：首先，使用上一时间步或外推得到的压[力场](@entry_id:147325) $p^n$ 来求解动量方程，得到一个临时的、不满足连续性方程的速度场 $\mathbf{u}^*$。
    $$
    \mathcal{M}(\rho^{n+1})\,\mathbf{u}^{*} = \mathcal{R}(\mathbf{u}^{n}, \rho^{n+1}) - \nabla p^{n}
    $$
    其中，$\mathcal{M}$ 是一个包含了时间项和扩散项的线性化算子，$\mathcal{R}$ 包含了所有显式处理的项。在这一步之前，通常会先求解组分和能量方程，以得到新的时间步的密度 $\rho^{n+1}$。

2.  **[压力修正](@entry_id:753714)步 (Pressure Correction)**：此步的目的是找到一个[压力修正](@entry_id:753714)量 $p'$，使得修正后的速度场 $\mathbf{u}^{**}$ 满足 $n+1$ 时刻的离散[连续性方程](@entry_id:195013)。通过将速度修正关系（$\mathbf{u}^{**} \approx \mathbf{u}^* - C \nabla p'$）代入离散连续性方程，可以构建并求解一个关于 $p'$ 的泊松型方程。
    $$
    \nabla \cdot (C \rho^{n+1} \nabla p') = \nabla \cdot (\rho^{n+1} \mathbf{u}^*) + \frac{\rho^{n+1} - \rho^n}{\Delta t}
    $$
    等式右边代表了预测速度场导致的的质量不平衡量。

3.  **速度与[通量修正](@entry_id:1125150)步 (Velocity and Flux Correction)**：求解[压力修正方程](@entry_id:156602)得到 $p'$ 后，便可更新压[力场](@entry_id:147325) $p^{**} = p^n + p'$，并修正单元中心的预测速度场 $\mathbf{u}^{**} = \mathbf{u}^* + \mathbf{u}'(p')$。

4.  **额外修正循环 (Additional Corrector Loops)**：PISO 算法的精髓在于其包含一次或多次额外的修正循环。第一次修正后的速度场 $\mathbf{u}^{**}$ 虽然满足了连续性方程，但由于在推导压力方程时引入了近似（例如忽略了[动量方程](@entry_id:197225)中的邻近单元速度修正），它与新的压[力场](@entry_id:147325) $p^{**}$ 并不完全满足[动量方程](@entry_id:197225)。额外的修正循环通过重新计算和修正速度与压力来改善这种不一致性，但**无需**重新组合和求解耗费巨大的动量方程矩阵。这种分裂算子的思想使得 PISO 算法在保持瞬态精度的同时，每个时间步的计算成本相对较低。这与主要用于[稳态](@entry_id:139253)问题的 SIMPLE 算法形成对比，后者在每个“外循环”中仅进行一次[压力修正](@entry_id:753714)，并严重依赖欠[松弛因子](@entry_id:1130825)来保证收敛。

### 反应流 PISO 算法的关键实现细节

在将 PISO 算法应用于变密度[反应流](@entry_id:190741)时，几个关键的数值处理细节决定了其精度、稳定性和物理真实性。

#### 通过[状态方程](@entry_id:274378)的耦合

在分离式求解算法中，各个[输运方程](@entry_id:174281)是依次求解的。一个典型的时间步内，求解顺序可能是：首先求解组分 ($Y_k$) 和能量 ($h$) 方程，得到预测的 $Y_k^{n+1,*}$ 和 $T^{n+1,*}$。随后，通过[状态方程](@entry_id:274378) $\rho = \rho(p^*, T^*, Y_k^*)$ 计算出更新的密度场 $\rho^{n+1,*}$。这个更新的密度场接着被用于动量预测步和压力修正步 。

这种耦合是**间接的**。组分和能量方程的解通过[状态方程](@entry_id:274378)影响密度，而密度则直接出现在连续性和动量方程的系数中。值得注意的是，如果数值格式能够保证 $\sum Y_k=1$，并且扩散模型满足 $\sum \mathbf{J}_k = \mathbf{0}$，化学反应[质量守恒](@entry_id:204015) $\sum \dot{\omega}_k=0$，那么将所有组分方程相加将精确地恢复总质量[连续性方程](@entry_id:195013)。这意味着[组分输运](@entry_id:1132066)不会在连续性方程中引入任何直接的源项，其全部影响都通过状态方程对密度的改变来体现。例如，即使在恒温恒压下，化学反应（如 $\text{CH}_4 + 2\text{O}_2 \rightarrow \text{CO}_2 + 2\text{H}_2\text{O}$）也会因为改变了混合物的平均分子量而导致密度变化。

#### 质量[通量修正](@entry_id:1125150)与密度插值

连续性方程的守恒律是作用于**质量通量** $\rho\mathbf{u}$，而非速度 $\mathbf{u}$ 本身。因此，在[变密度流](@entry_id:1133711)中，仅仅修正速度是不足够的。[压力修正](@entry_id:753714)必须作用于整个质量通量 。这意味着在 PISO 的修正步骤中，我们必须使用与速度和压力相一致的、更新后的面心密度 $\rho_f$ 来构建面心质量通量 $\phi_f = \rho_f (\mathbf{u}_f \cdot \mathbf{S}_f)$。如果在修正过程中继续使用旧的或预测的密度，将导致严重的[质量守恒](@entry_id:204015)误差，尤其是在密度梯度剧烈的区域（如火焰面）。

如何获得面心密度 $\rho_f$ 是一个关键问题。简单的[线性插值](@entry_id:137092)（算术平均）在梯度剧烈的区域会产生非物理的过冲和下冲，可能导致密度为负，从而使计算崩溃。为了保证解的**有界性（boundedness）**和**单调性（monotonicity）**，必须采用高分辨率的插值格式，例如**[迎风格式](@entry_id:756378) (upwind scheme)** 或更先进的**总变差减小 (Total Variation Diminishing, TVD)** 限制器。这些格式可以有效抑制数值振荡，确保密度场的物理真实性。

#### 空间离散化与 Rhie-Chow 插值

在[有限体积法](@entry_id:141374)中，变量的存储位置分为两种基本类型：**交错网格 (staggered grid)** 和 **[同位网格](@entry_id:1122659) (collocated grid)** 。

*   在**交错网格**上，压力等标量存储在单元中心，而速度分量存储在单元的面上。这种布置方式使得驱动面速度的压力梯度（例如，面 $e$ 上的速度 $u_e$ 由相邻单元中心压力 $p_P$ 和 $p_E$ 的差值驱动）与连续性方程中需要的面速度天然地耦合在一起，从而有效避免了压[力场](@entry_id:147325)出现非物理的“棋盘格”振荡。

*   在**同位网格**上，所有变量（压力、速度、密度等）都存储在单元中心。这种方式在处理复杂几何和非结构网格时更为方便，已成为现代 CFD 软件的主流。然而，它也带来了一个严重的问题：[压力-速度解耦](@entry_id:167545)。如果简单地通过[线性插值](@entry_id:137092)得到面速度（如 $u_e = 0.5(u_P + u_E)$），这个面速度将对直接作用于其上的压力差 $(p_E - p_P)$ 不敏感，从而允许非物理的棋盘状压[力场](@entry_id:147325)作为方程的解存在。

为了解决[同位网格](@entry_id:1122659)上的[解耦](@entry_id:160890)问题，**Rhie-Chow 插值**被提出并广泛应用。其核心思想是，不直接插值速度，而是插值[动量方程](@entry_id:197225)本身。通过一种特殊的构造，使得面心速度表达式中显式地包含一个与该面两侧压力差相关的项。这样，当压[力场](@entry_id:147325)出现振荡时，面速度会做出正确响应，从而在[压力修正](@entry_id:753714)过程中将振荡抑制掉。即使在密度变化的[瞬态反应流](@entry_id:1133328)中，由 $\partial \rho / \partial t$ 带来的时间项也无法解决这种纯粹由空间离散化引起的[解耦](@entry_id:160890)问题，因此 Rhie-Chow 插值或类似的动量插值方法对于[同位网格](@entry_id:1122659)上的 PISO 算法是必不可少的。

### PISO 算法的高级议题

#### 多重修正循环的必要性

PISO 算法中为何需要多于一次的修正循环？这背后有深刻的数值原因 。

PISO 是一种**算子分裂**算法，它将紧密耦合的动量-连续性方程组分解为一系列易于求解的步骤。这种分解不可避免地会引入**[分裂误差](@entry_id:755244)（splitting error）**。在第一次[压力修正](@entry_id:753714)后，虽然速度场满足了[连续性方程](@entry_id:195013)，但这是基于一系列近似（例如，冻结了[动量方程](@entry_id:197225)中的某些系数，忽略了[压力修正](@entry_id:753714)对邻居速度的影响）得到的。对于[变密度流](@entry_id:1133711)，问题更为突出：
1.  **密度-通量不一致**：第一次[压力修正方程](@entry_id:156602)使用的是预测密度 $\rho^*$，但修正后的速度场 $\mathbf{u}^{**}$ 意味着一个新的质量通量分布。如果用这个新通量去求解能量和组分方程，会得到一个新的密度场 $\rho^{**}$，它与之前使用的 $\rho^*$ 并不同。
2.  **系数不一致**：[压力泊松方程](@entry_id:1129887)的系数本身也依赖于密度（例如 $\nabla \cdot (\frac{1}{\rho}\nabla p')$ 中的 $\rho$）。第一次修正使用的是旧的系数。

后续的修正循环正是为了减小这些不一致性。通过使用更新后的速度和密度场来重新评估和校正压[力场](@entry_id:147325)，PISO 算法逐步逼近了完全耦合系统的真实解，系统性地减小了[分裂误差](@entry_id:755244)，从而提高了时间步内的解的精度和一致性。

#### 二阶时间精度的恢复

一个令人惊讶且强大的特性是，即使 PISO 的预测步是低阶的（例如，使用前一时间步的压力，为[一阶精度](@entry_id:749410)），通过多次修正循环，整个算法仍然可以恢复**二阶时间精度** 。

这一点的关键在于，PISO 的修正循环可以被看作是一种**延迟修正（deferred correction）**迭代。它从一个一阶的压力猜测 ($p^n$) 开始，通过迭代求解，最终得到的压力 $p^{n+1}$ 和速度 $\mathbf{u}^{n+1}$ 能很好地逼近求解一个完全隐式的二阶时间离散格式（如 Crank-Nicolson 格式）所得到的结果。Crank-Nicolson 格式的卓越精度来源于它将所有项都中心化在时间中点 $t^{n+1/2}$。PISO 算法通过在 $t^{n+1}$ 时刻的迭代求解，有效地实现了这种时间上的中心化。

为了在变密度反应流中真正实现二阶精度，所有引入的项也必须以二阶精度处理。这包括：
*   对流、扩散等输运项应采用二阶格式（如 Crank-Nicolson）。
*   密度 $\rho$ 必须以某种方式在时间步中点进行评估。
*   化学反应源项、热释放等也必须在时间中点进行离散。

满足这些条件，并执行足够次数的修正循环（通常两次对于恢复二阶精度是足够的），PISO 算法就能在不进行全局矩阵迭代的情况下，获得高精度的瞬态解。

#### 关于欠松弛的讨论

熟悉[稳态](@entry_id:139253) CFD 算法（如 SIMPLE）的学习者可能会问：PISO 算法中是否需要**欠松弛（under-relaxation）**？答案是：通常不需要，但有时会谨慎使用 。

在 SIMPLE 算法中，由于没有时间导数项提供稳定性，必须对速度和压力等变量进行[欠松弛](@entry_id:756302)（即每次只采纳一部分的修正量）来防止迭代发散。但在 PISO 这样的瞬态算法中，离散的时间导数项（如 $\frac{\rho}{\Delta t} \mathbf{u}$）为[动量方程](@entry_id:197225)的对角线元素贡献了一个巨大的正值。只要时间步长 $\Delta t$ 不是过大，这个项就能确保矩阵的**[对角占优](@entry_id:748380)**，从而保证了[数值稳定性](@entry_id:175146)。因此，对于[压力-速度耦合](@entry_id:155962)本身，PISO 不需要欠松弛。

然而，在[反应流](@entry_id:190741)中，化学反应源项可能极度**[非线性](@entry_id:637147)**和**刚性（stiff）**。当对这些源项进行隐式处理时，其巨大的[雅可比矩阵](@entry_id:178326)元素可能破坏系统的[对角占优](@entry_id:748380)性，导致[非线性](@entry_id:637147)迭代（在一个时间步内[求解非线性方程](@entry_id:177343)组的迭代）发散。在这种特定情况下，可以对某些变量（如温度或组分）引入轻微的[欠松弛](@entry_id:756302)，作为一种稳定[非线性](@entry_id:637147)迭代的“减震器”。

但这种做法必须极其谨慎，因为它会严重损害瞬态精度。分析表明，对一个一阶时间精度的格式（如后向欧拉）应用一个小于 1 的欠[松弛因子](@entry_id:1130825) $\alpha$，会将格式的精度降为**零阶**。这意味着，即使时间步长趋于零，数值解也不会收敛到真实的瞬态物理过程。因此，在 PISO 算法中，[欠松弛](@entry_id:756302)应被视为一种处理极端[非线性](@entry_id:637147)问题的最后手段，而非常规工具。