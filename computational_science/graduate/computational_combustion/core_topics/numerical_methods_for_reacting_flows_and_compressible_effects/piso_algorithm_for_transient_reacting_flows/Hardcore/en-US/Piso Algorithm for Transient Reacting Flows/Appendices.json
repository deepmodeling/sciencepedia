{
    "hands_on_practices": [
        {
            "introduction": "In computational fluid dynamics, a key distinction for low-Mach-number solvers is whether the flow is treated as strictly incompressible, where $\\nabla \\cdot \\mathbf{u} = 0$, or if it allows for variable density. For reacting flows, heat release from chemical reactions causes significant thermal expansion, which means the velocity field is no longer divergence-free. This practice  bridges the gap between the abstract divergence constraint and the tangible physics of a flame, allowing you to estimate the magnitude of this effect from fundamental flame properties.",
            "id": "4050302",
            "problem": "Consider a one-dimensional, planar, stoichiometric methane–air laminar flamelet embedded in a low-Mach-number transient solver that uses the Pressure-Implicit with Splitting of Operators (PISO) algorithm. The flow is treated as quasi-isobaric. The upstream unburned mixture has temperature $T_{u} = 300\\,\\mathrm{K}$ and pressure $p_{0} = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$. The mixture gas constant is approximated as constant and equal to $\\bar{R} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ in both unburned and burned gases. The burned-gas temperature is $T_{b} = 1800\\,\\mathrm{K}$. The laminar burning velocity is $S_{L} = 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, and the thermal thickness of the reaction zone is $\\delta_{L} = 0.45\\,\\mathrm{mm}$. Assume:\n- Ideal-gas behavior and spatially uniform pressure ($p \\approx p_{0}$) across the flamelet.\n- A steady, one-dimensional profile in the flame-fixed frame so that the mass flux $m = \\rho u$ is constant and equal to $\\rho_{u} S_{L}$, where $\\rho_{u}$ is the upstream density.\n- Within the reaction zone of thickness $\\delta_{L}$, the streamwise velocity varies approximately linearly from $U_{u}$ to $U_{b}$ due to thermal expansion, where $U_{u}$ and $U_{b}$ are the upstream and downstream velocities, respectively.\n\nTasks:\n1. Starting from the variable-density continuity equation and the ideal-gas law, and using the quasi-isobaric assumption, derive the divergence constraint that the PISO algorithm enforces for the corrected velocity field in low-Mach reacting flows. Express the constraint in terms of the material derivative and thermodynamic variables.\n2. Using the ideal-gas law, compute the upstream and burned-gas densities $\\rho_{u}$ and $\\rho_{b}$ and the expansion factor $E = \\rho_{u}/\\rho_{b}$.\n3. Using mass conservation for a steady one-dimensional flamelet, determine $U_{u}$ and $U_{b}$, and estimate the divergence across the reaction zone as a constant gradient $\\nabla \\cdot \\mathbf{u} \\approx (U_{b} - U_{u})/\\delta_{L}$. State the expected sign and compute the magnitude.\n4. Verify that your estimate is consistent with the divergence constraint derived in Task 1 by showing the equivalence of the expressions under the given assumptions.\n\nRound your final numeric answer to $3$ significant figures. Express the final result in $\\mathrm{s}^{-1}$.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard problem in computational combustion theory, providing clear definitions, consistent data, and physically realistic assumptions for a laminar flamelet model. All criteria for a valid problem are met.\n\n**Task 1: Derivation of the Divergence Constraint**\n\nThe starting point is the continuity equation for a compressible fluid:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nwhere $\\rho$ is the density and $\\mathbf{u}$ is the velocity vector. Using the product rule for the divergence term, this can be expanded to:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\rho + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\nThe first two terms represent the material derivative of density, $\\frac{D\\rho}{Dt}$:\n$$\n\\frac{D\\rho}{Dt} + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\nThis equation can be rearranged to express the velocity divergence explicitly in terms of the density change following a fluid particle:\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\nTo express this in terms of thermodynamic variables, we use the ideal-gas law provided, $p = \\rho \\bar{R} T$, where $p$ is the pressure, $T$ is the temperature, and $\\bar{R}$ is the specific gas constant. The problem states the flow is quasi-isobaric, meaning pressure is spatially uniform, $p(\\mathbf{x}, t) \\approx p_0(t)$, but can vary slowly in time for transient cases. Thus, $\\rho = \\frac{p_0(t)}{\\bar{R} T}$.\n\nTo relate the material derivative of density to that of pressure and temperature, it is convenient to work with the logarithm of the state equation:\n$$\n\\ln(\\rho) = \\ln(p) - \\ln(\\bar{R}) - \\ln(T)\n$$\nTaking the material derivative of this expression (noting $\\bar{R}$ is constant):\n$$\n\\frac{D}{Dt}(\\ln \\rho) = \\frac{D}{Dt}(\\ln p) - \\frac{D}{Dt}(\\ln T)\n$$\nThis is equivalent to:\n$$\n\\frac{1}{\\rho} \\frac{D\\rho}{Dt} = \\frac{1}{p} \\frac{Dp}{Dt} - \\frac{1}{T} \\frac{DT}{Dt}\n$$\nSubstituting this back into the expression for the velocity divergence gives the desired constraint:\n$$\n\\nabla \\cdot \\mathbf{u} = - \\left( \\frac{1}{p} \\frac{Dp}{Dt} - \\frac{1}{T} \\frac{DT}{Dt} \\right) = \\frac{1}{T} \\frac{DT}{Dt} - \\frac{1}{p} \\frac{Dp}{Dt}\n$$\nThis is the divergence constraint that the PISO algorithm must enforce for the corrected velocity field. It links the kinematics of the flow ($\\nabla \\cdot \\mathbf{u}$) to the thermodynamic changes ($\\frac{DT}{Dt}$, $\\frac{Dp}{Dt}$) along fluid particle paths.\n\n**Task 2: Computation of Densities and Expansion Factor**\n\nThe upstream unburned gas density, $\\rho_u$, and the downstream burned gas density, $\\rho_b$, are calculated using the ideal-gas law, $p = \\rho \\bar{R} T$, under the assumption of uniform pressure $p = p_0 = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$.\n\nGiven values:\n$p_0 = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$\n$\\bar{R} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n$T_u = 300\\,\\mathrm{K}$\n$T_b = 1800\\,\\mathrm{K}$\n\nUpstream density:\n$$\n\\rho_u = \\frac{p_0}{\\bar{R} T_u} = \\frac{1.013 \\times 10^{5}\\,\\mathrm{Pa}}{(287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})(300\\,\\mathrm{K})} \\approx 1.1765\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\nDownstream density:\n$$\n\\rho_b = \\frac{p_0}{\\bar{R} T_b} = \\frac{1.013 \\times 10^{5}\\,\\mathrm{Pa}}{(287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})(1800\\,\\mathrm{K})} \\approx 0.19609\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\nThe expansion factor, $E$, is the ratio of the unburned to burned gas density:\n$$\nE = \\frac{\\rho_u}{\\rho_b} = \\frac{p_0 / (\\bar{R} T_u)}{p_0 / (\\bar{R} T_b)} = \\frac{T_b}{T_u} = \\frac{1800\\,\\mathrm{K}}{300\\,\\mathrm{K}} = 6\n$$\n\n**Task 3: Computation of Velocities and Divergence Estimate**\n\nThe problem specifies a steady, one-dimensional flamelet in a flame-fixed reference frame. The laminar burning velocity, $S_L$, is the speed at which the unburned mixture enters the flame front. Thus, the upstream velocity $U_u$ is equal to $S_L$.\n$$\nU_u = S_L = 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nMass conservation across the steady flame dictates that the mass flux $m = \\rho u$ is constant:\n$$\n\\rho_u U_u = \\rho_b U_b\n$$\nThe downstream velocity, $U_b$, can be calculated as:\n$$\nU_b = \\frac{\\rho_u}{\\rho_b} U_u = E \\cdot U_u = 6 \\times 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 2.28\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nThe divergence of velocity, $\\nabla \\cdot \\mathbf{u}$, in one dimension is $\\frac{du}{dx}$. The problem asks to estimate this as a constant gradient across the reaction zone of thickness $\\delta_L = 0.45\\,\\mathrm{mm} = 0.45 \\times 10^{-3}\\,\\mathrm{m}$.\n$$\n\\nabla \\cdot \\mathbf{u} \\approx \\frac{U_b - U_u}{\\delta_L}\n$$\nSince $U_b  U_u$, the divergence is positive, which is expected due to the thermal expansion of the gas as it burns. The magnitude is:\n$$\n\\nabla \\cdot \\mathbf{u} \\approx \\frac{2.28\\,\\mathrm{m}\\,\\mathrm{s}^{-1} - 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.45 \\times 10^{-3}\\,\\mathrm{m}} = \\frac{1.90}{0.45 \\times 10^{-3}}\\,\\mathrm{s}^{-1} \\approx 4222.2\\,\\mathrm{s}^{-1}\n$$\nRounding to three significant figures, the estimated divergence is $4.22 \\times 10^{3}\\,\\mathrm{s}^{-1}$.\n\n**Task 4: Verification of Consistency**\n\nWe must verify that the estimate $\\frac{U_b - U_u}{\\delta_L}$ from Task 3 is consistent with the divergence constraint from Task 1 under the problem's assumptions for a steady flamelet.\n\nFor a steady ($ \\frac{\\partial}{\\partial t} = 0 $), one-dimensional ($ \\nabla \\rightarrow \\frac{d}{dx} $, $ \\mathbf{u} \\rightarrow u $), isobaric ($ \\frac{Dp}{Dt} = u \\frac{dp}{dx} = 0 $) flow, the material derivative becomes $\\frac{D}{Dt} = u \\frac{d}{dx}$. The divergence constraint from Task 1 simplifies to:\n$$\n\\frac{du}{dx} = \\frac{1}{T} \\left( u \\frac{dT}{dx} \\right) \\implies \\frac{1}{u}\\frac{du}{dx} = \\frac{1}{T}\\frac{dT}{dx}\n$$\nThis is a differential equation relating the velocity and temperature profiles. Integrating it across the flame from the unburned side ($u=U_u, T=T_u$) to the burned side ($u=U_b, T=T_b$) yields:\n$$\n\\int_{U_u}^{U_b} \\frac{1}{u} du = \\int_{T_u}^{T_b} \\frac{1}{T} dT \\implies \\ln\\left(\\frac{U_b}{U_u}\\right) = \\ln\\left(\\frac{T_b}{T_u}\\right) \\implies \\frac{U_b}{U_u} = \\frac{T_b}{T_u}\n$$\nThis is consistent with our findings from mass conservation and the ideal-gas law in Task 2 and 3.\n\nNow, let's use the additional assumption that the velocity profile is linear within the reaction zone, $x \\in [0, \\delta_L]$:\n$$\nu(x) = U_u + (U_b - U_u) \\frac{x}{\\delta_L}\n$$\nWith this assumption, the velocity divergence is constant throughout the reaction zone:\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{du}{dx} = \\frac{U_b - U_u}{\\delta_L}\n$$\nThis means the \"estimate\" from Task 3 is the exact divergence under the linear velocity profile assumption. We must now show that the expression from Task 1 gives the same result.\nFrom the integrated relation $\\frac{u(x)}{U_u} = \\frac{T(x)}{T_u}$, we can find the temperature profile implied by the linear velocity profile:\n$$\nT(x) = T_u \\frac{u(x)}{U_u} = T_u \\left( 1 + \\frac{U_b - U_u}{U_u} \\frac{x}{\\delta_L} \\right)\n$$\nThe temperature gradient is therefore also constant:\n$$\n\\frac{dT}{dx} = T_u \\frac{U_b - U_u}{U_u \\delta_L}\n$$\nNow, substitute these profiles into the local divergence expression from Task 1, $\\frac{u}{T}\\frac{dT}{dx}$:\n$$\n\\frac{u(x)}{T(x)} \\frac{dT}{dx} = \\frac{u(x)}{T_u \\frac{u(x)}{U_u}} \\left( T_u \\frac{U_b - U_u}{U_u \\delta_L} \\right)\n$$\nThe terms $u(x)$, $T_u$, and $U_u$ cancel out:\n$$\n\\frac{u(x)}{T(x)} \\frac{dT}{dx} = \\frac{U_u}{T_u} \\left( \\frac{T_u}{U_u} \\frac{U_b - U_u}{\\delta_L} \\right) = \\frac{U_b - U_u}{\\delta_L}\n$$\nThis result is identical to the constant gradient computed from the linear velocity profile. Therefore, the estimate from Task 3 is not just an approximation but is fully consistent with and mathematically equivalent to the fundamental divergence constraint from Task 1, given the specific set of assumptions in the problem. The computed value is therefore verified.\nFinal numerical result from Task 3, rounded to 3 significant figures:\n$$\n\\frac{1.90}{0.45 \\times 10^{-3}} \\,\\mathrm{s}^{-1} \\approx 4220 \\,\\mathrm{s}^{-1} = 4.22 \\times 10^3 \\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\\boxed{4.22 \\times 10^{3}}$$"
        },
        {
            "introduction": "The PISO algorithm begins with a 'predictor' step, which calculates a provisional velocity field based on the momentum equations and the pressure field from the previous time step or iteration. This predicted field, denoted $\\mathbf{u}^*$, serves as a first guess but does not yet satisfy the continuity equation. This exercise  allows you to dissect this crucial first step, focusing on how the discrete momentum equation is formed and how different treatments of the pressure term can influence the predicted velocity.",
            "id": "4050273",
            "problem": "Consider a single control volume cell, labeled $P$, in a two-dimensional, low–Mach-number reacting gas flow advanced using the Pressure-Implicit with Splitting of Operators (PISO) algorithm. The momentum predictor step for the $x$-velocity component, $u$, is obtained by discretizing the integral form of the $x$-momentum equation over volume $V_P$ for a time step $\\Delta t$, with convection and diffusion linearized into neighbor-coupling coefficients and the pressure gradient retained as a volumetric source. Assume a collocated finite-volume arrangement with second-order central differencing for diffusion and first-order upwind for convection, and neglect density variation over the predictor during the current time step.\n\nYou are given the following data at time level $n$ for cell $P$ and its immediate neighbors $E$, $W$, $N$, and $S$:\n- Cell volume: $V_P = 8.0 \\times 10^{-6}\\ \\mathrm{m}^3$.\n- Time step: $\\Delta t = 1.0 \\times 10^{-5}\\ \\mathrm{s}$.\n- Mixture density over the predictor: $\\rho_P = 1.0\\ \\mathrm{kg/m}^3$.\n- Linearized neighbor coupling coefficients for convection–diffusion in the $x$-momentum equation: $a_E = 2.5\\ \\mathrm{kg/s}$, $a_W = 1.5\\ \\mathrm{kg/s}$, $a_N = 1.0\\ \\mathrm{kg/s}$, $a_S = 0.8\\ \\mathrm{kg/s}$.\n- Known neighbor velocities at time level $n$: $u_E^{n} = 3.0\\ \\mathrm{m/s}$, $u_W^{n} = 1.5\\ \\mathrm{m/s}$, $u_N^{n} = 0.5\\ \\mathrm{m/s}$, $u_S^{n} = 0.2\\ \\mathrm{m/s}$.\n- Cell-center velocity at the previous time level: $u_P^{n} = 1.0\\ \\mathrm{m/s}$.\n- Lumped source contribution (including body force and linearized reaction-induced momentum source) for the $x$-momentum equation over $V_P$: $b_P = 0.4\\ \\mathrm{N}$.\n- Old-level pressure gradient at time $n$: $\\left(\\partial p/\\partial x\\right)^{n} = 1.5 \\times 10^{3}\\ \\mathrm{Pa/m}$.\n- An extrapolated estimate of the new-level pressure gradient to be used for an implicit-in-pressure predictor: $\\left(\\partial p/\\partial x\\right)^{n+1,\\mathrm{est}} = 9.0 \\times 10^{2}\\ \\mathrm{Pa/m}$.\n\nStarting from the integral form of the $x$-momentum equation and standard finite-volume time integration and spatial linearization, derive the discrete predictor equation for $u_P^{*}$ in the PISO algorithm. Use this derivation to:\n\n1. Compute the diagonal coefficient $a_P$ for cell $P$ in the predictor equation.\n2. Compute the explicit-pressure predictor velocity $u_P^{*,\\mathrm{exp}}$ obtained by taking the pressure gradient at time level $n$.\n3. Compute the implicit-pressure predictor velocity $u_P^{*,\\mathrm{imp}}$ obtained by taking the pressure gradient as the extrapolated estimate $\\left(\\partial p/\\partial x\\right)^{n+1,\\mathrm{est}}$.\n4. Assess the effect of explicit versus implicit pressure-gradient treatment by computing the magnitude of the difference $\\left|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}\\right|$.\n\nExpress your final reported quantity in $\\mathrm{m/s}$ and round your final answer to four significant figures. Report as your final answer only the magnitude $\\left|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}\\right|$ (do not report intermediate results as the final answer).",
            "solution": "The problem statement is critically validated before proceeding to a solution.\n\n**Step 1: Extract Givens**\n- **Algorithm**: Pressure-Implicit with Splitting of Operators (PISO) for a 2D, low-Mach number reacting gas flow.\n- **Discretization**: Collocated finite-volume, second-order central differencing for diffusion, first-order upwind for convection.\n- **Cell**: Central cell $P$, neighbors $E$, $W$, $N$, $S$.\n- **Cell Volume**: $V_P = 8.0 \\times 10^{-6}\\ \\mathrm{m}^3$.\n- **Time Step**: $\\Delta t = 1.0 \\times 10^{-5}\\ \\mathrm{s}$.\n- **Mixture Density**: $\\rho_P = 1.0\\ \\mathrm{kg/m}^3$ (assumed constant for the predictor step).\n- **Linearized Neighbor Coefficients ($x$-momentum)**: $a_E = 2.5\\ \\mathrm{kg/s}$, $a_W = 1.5\\ \\mathrm{kg/s}$, $a_N = 1.0\\ \\mathrm{kg/s}$, $a_S = 0.8\\ \\mathrm{kg/s}$.\n- **Neighbor Velocities (time $n$)**: $u_E^{n} = 3.0\\ \\mathrm{m/s}$, $u_W^{n} = 1.5\\ \\mathrm{m/s}$, $u_N^{n} = 0.5\\ \\mathrm{m/s}$, $u_S^{n} = 0.2\\ \\mathrm{m/s}$.\n- **Cell Velocity (time $n$)**: $u_P^{n} = 1.0\\ \\mathrm{m/s}$.\n- **Lumped Source Term**: $b_P = 0.4\\ \\mathrm{N}$.\n- **Pressure Gradient (time $n$)**: $\\left(\\frac{\\partial p}{\\partial x}\\right)^{n} = 1.5 \\times 10^{3}\\ \\mathrm{Pa/m}$.\n- **Extrapolated Pressure Gradient (est. for $n+1$)**: $\\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} = 9.0 \\times 10^{2}\\ \\mathrm{Pa/m}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard numerical procedure (PISO) in computational fluid dynamics. It is well-posed, providing all necessary data to formulate and solve the discrete equations. The terminology is precise and objective. The provided numerical values and units are physically consistent and plausible for a micro-scale or fine-mesh simulation. The problem structure is clear and does not contain any contradictions, ambiguities, or logical flaws.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be provided.\n\n**Derivation of the Discrete Predictor Equation**\nThe integral form of the $x$-momentum equation over a control volume $V_P$ is:\n$$ \\frac{\\partial}{\\partial t}\\int_{V_P} \\rho u \\,dV + \\int_{\\partial V_P} \\rho u (\\mathbf{v} \\cdot \\mathbf{n}) \\,dS = \\int_{\\partial V_P} \\mu \\frac{\\partial u}{\\partial n} \\, dS - \\int_{V_P} \\frac{\\partial p}{\\partial x} \\, dV + \\int_{V_P} S_u \\,dV $$\nWe discretize this equation using a semi-implicit approach for the momentum predictor step. The time derivative is approximated using a first-order Euler scheme. The convection and diffusion terms are linearized, and for the predictor step, the influence of neighbor velocities is treated explicitly using values from time level $n$, while the cell's own velocity $u_P^*$ is treated implicitly. This decouples the system of equations for each cell. The contribution of the convection and diffusion fluxes at the cell faces is linearized into the provided neighbor coefficients $a_{nb}$.\n\nThe discretized momentum equation for the predictor velocity $u_P^*$ takes the form:\n$$ \\frac{\\rho_P V_P (u_P^* - u_P^n)}{\\Delta t} + \\mathcal{L}(u) = -V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\nwhere $\\mathcal{L}(u)$ represents the net convection-diffusion operator. It is linearized such that the diagonal contribution is implicit and off-diagonal is explicit:\n$$ \\mathcal{L}(u) \\approx \\left(\\sum_{nb} a_{nb}\\right) u_P^* - \\sum_{nb} a_{nb} u_{nb}^n $$\nHere, $\\sum_{nb} a_{nb}$ corresponds to the sum of the neighbor coefficients for neighbors $nb \\in \\{E, W, N, S\\}$. This is a standard linearization for stability. Substituting this into the time-discretized equation:\n$$ \\frac{\\rho_P V_P}{\\Delta t} (u_P^* - u_P^n) + \\left(\\sum_{nb} a_{nb}\\right) u_P^* - \\sum_{nb} a_{nb} u_{nb}^n = -V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\nRearranging the equation to group terms multiplying the unknown $u_P^*$ on the left-hand side gives the standard form $a_P u_P^* = \\text{RHS}$:\n$$ \\left( \\frac{\\rho_P V_P}{\\Delta t} + \\sum_{nb} a_{nb} \\right) u_P^* = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\nThis is the discrete predictor equation for $u_P^*$.\n\n**1. Computation of the Diagonal Coefficient $a_P$**\nFrom the derived equation, the diagonal coefficient $a_P$ is the term multiplying $u_P^*$:\n$$ a_P = \\frac{\\rho_P V_P}{\\Delta t} + \\sum_{nb} a_{nb} $$\nFirst, we compute the sum of the neighbor coefficients:\n$$ \\sum_{nb} a_{nb} = a_E + a_W + a_N + a_S = 2.5 + 1.5 + 1.0 + 0.8 = 5.8\\ \\mathrm{kg/s} $$\nNext, we compute the transient term coefficient:\n$$ \\frac{\\rho_P V_P}{\\Delta t} = \\frac{(1.0\\ \\mathrm{kg/m}^3)(8.0 \\times 10^{-6}\\ \\mathrm{m}^3)}{1.0 \\times 10^{-5}\\ \\mathrm{s}} = 0.8\\ \\mathrm{kg/s} $$\nTherefore, the diagonal coefficient $a_P$ is:\n$$ a_P = 0.8\\ \\mathrm{kg/s} + 5.8\\ \\mathrm{kg/s} = 6.6\\ \\mathrm{kg/s} $$\n\n**2. Computation of the Explicit-Pressure Predictor Velocity $u_P^{*,\\mathrm{exp}}$**\nFor the explicit-pressure predictor, we use the pressure gradient from time level $n$, $\\left(\\frac{\\partial p}{\\partial x}\\right)^n$. The right-hand side (RHS) of the predictor equation is:\n$$ \\text{RHS}_{\\mathrm{exp}} = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^n + b_P $$\nWe compute each term:\n$$ \\sum_{nb} a_{nb} u_{nb}^n = (2.5)(3.0) + (1.5)(1.5) + (1.0)(0.5) + (0.8)(0.2) = 7.5 + 2.25 + 0.5 + 0.16 = 10.41\\ \\mathrm{N} $$\n$$ \\frac{\\rho_P V_P}{\\Delta t} u_P^n = (0.8\\ \\mathrm{kg/s})(1.0\\ \\mathrm{m/s}) = 0.8\\ \\mathrm{N} $$\n$$ V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^n = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3)(1.5 \\times 10^{3}\\ \\mathrm{Pa/m}) = 12.0 \\times 10^{-3}\\ \\mathrm{N} = 0.012\\ \\mathrm{N} $$\nThe source term is given as $b_P = 0.4\\ \\mathrm{N}$.\nSumming these contributions for the RHS:\n$$ \\text{RHS}_{\\mathrm{exp}} = 10.41 + 0.8 - 0.012 + 0.4 = 11.598\\ \\mathrm{N} $$\nThe predicted velocity is then:\n$$ u_P^{*,\\mathrm{exp}} = \\frac{\\text{RHS}_{\\mathrm{exp}}}{a_P} = \\frac{11.598\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} \\approx 1.75727\\ \\mathrm{m/s} $$\n\n**3. Computation of the Implicit-Pressure Predictor Velocity $u_P^{*,\\mathrm{imp}}$**\nFor the implicit-pressure predictor, we use the extrapolated pressure gradient estimate, $\\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}}$. The RHS is:\n$$ \\text{RHS}_{\\mathrm{imp}} = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} + b_P $$\nThe only term that changes is the pressure term:\n$$ V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3)(9.0 \\times 10^{2}\\ \\mathrm{Pa/m}) = 7.2 \\times 10^{-3}\\ \\mathrm{N} = 0.0072\\ \\mathrm{N} $$\nThe RHS for the implicit case is:\n$$ \\text{RHS}_{\\mathrm{imp}} = 10.41 + 0.8 - 0.0072 + 0.4 = 11.6028\\ \\mathrm{N} $$\nThe predicted velocity is:\n$$ u_P^{*,\\mathrm{imp}} = \\frac{\\text{RHS}_{\\mathrm{imp}}}{a_P} = \\frac{11.6028\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} = 1.758\\ \\mathrm{m/s} $$\n\n**4. Computation of the Difference Magnitude $|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}|$**\nThe difference in the predicted velocities can be computed directly from the difference in the RHS terms, as $a_P$ is common to both calculations:\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} = \\frac{\\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}}}{a_P} $$\nThe difference in RHS is solely due to the pressure gradient term:\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = \\left(-V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}}\\right) - \\left(-V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n}\\right) $$\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = V_P \\left[ \\left(\\frac{\\partial p}{\\partial x}\\right)^{n} - \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} \\right] $$\nSubstituting the values:\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3) [1.5 \\times 10^{3} - 9.0 \\times 10^{2}] \\mathrm{Pa/m} $$\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = (8.0 \\times 10^{-6})(600)\\ \\mathrm{N} = 4.8 \\times 10^{-3}\\ \\mathrm{N} $$\nNow, we find the velocity difference:\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} = \\frac{4.8 \\times 10^{-3}\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} = \\frac{4.8}{6.6} \\times 10^{-3}\\ \\mathrm{m/s} = \\frac{8}{11} \\times 10^{-3}\\ \\mathrm{m/s} $$\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} \\approx 0.00072727... \\ \\mathrm{m/s} $$\nThe magnitude is $|0.00072727...| = 0.00072727... \\ \\mathrm{m/s}$.\nRounding to four significant figures, we get $0.0007273\\ \\mathrm{m/s}$. This can be expressed in scientific notation as $7.273 \\times 10^{-4}\\ \\mathrm{m/s}$.",
            "answer": "$$\\boxed{7.273 \\times 10^{-4}}$$"
        },
        {
            "introduction": "After the predictor step, the resulting velocity field generally does not conserve mass, creating a 'divergence error'. The core of the PISO method is the 'corrector' phase, where a pressure-correction equation is solved to eliminate this error. This hands-on practice  focuses on the final and most critical part of this correction, where you will use a given pressure-correction field to adjust the face fluxes and explicitly enforce discrete continuity for a control volume.",
            "id": "4050269",
            "problem": "A single hexahedral control volume in a transient, low-Mach-number reacting flow is advanced using the Pressure-Implicit with Splitting of Operators (PISO) algorithm. The face-normal volumetric fluxes are defined with respect to outward-pointing face normals and are denoted by $\\phi_{f}$, with $f \\in \\{W, E, S, N, B, T\\}$ corresponding to the west, east, south, north, bottom, and top faces, respectively. At a given sub-iteration, a predicted (non-divergence-free) flux field $\\phi_{f}^{*}$ has been obtained from the momentum predictor. The discrete continuity equation over the control volume requires the corrected fluxes to satisfy\n$$\\sum_{f} \\phi_{f} = 0.$$\nA pressure correction field $p'$ is available at the centers of the owner cell $P$ and each of its six face-neighbor cells. Assume that the linearized pressure–velocity coupling at each face is characterized by a known positive coefficient $D_{f}$ such that the pressure correction induces a face-normal flux correction that is linearly proportional to the pressure difference between neighbor and owner across that face. All quantities are given at the same algorithmic time level.\n\nData:\n- Predicted outward volumetric fluxes (units m$^3$/s): $\\phi_{W}^{*} = -1.000 \\times 10^{-5}$, $\\phi_{E}^{*} = 8.000 \\times 10^{-6}$, $\\phi_{S}^{*} = 6.000 \\times 10^{-6}$, $\\phi_{N}^{*} = 5.000 \\times 10^{-6}$, $\\phi_{B}^{*} = -2.500 \\times 10^{-6}$, $\\phi_{T}^{*} = -4.000 \\times 10^{-6}$.\n- Pressure correction at cell centers (units Pa): $p'_{P} = 0$, $p'_{W} = -1$, $p'_{E} = 2$, $p'_{S} = 3$, $p'_{N} = 1$, $p'_{B} = 0.5$, $p'_{T} = -2$.\n- Face coupling coefficients (units m$^3$/s/Pa): $D_{W} = 2.000 \\times 10^{-6}$, $D_{E} = 1.000 \\times 10^{-6}$, $D_{S} = 5.000 \\times 10^{-7}$, $D_{N} = 1.500 \\times 10^{-6}$, $D_{B} = 3.000 \\times 10^{-6}$, $D_{T} = 1.000 \\times 10^{-6}$.\n\nUsing first principles of the finite-volume method and pressure–velocity coupling in the PISO algorithm, derive the expression for the face flux correction in terms of $p'$ and $D_{f}$ that enforces the discrete continuity residual to zero for the control volume. Then compute the corrected outward face fluxes $\\phi_{f}$ for $f \\in \\{W, E, S, N, B, T\\}$ that exactly satisfy $\\sum_{f} \\phi_{f} = 0$.\n\nExpress your final answer as a single row matrix in the face order $[W, E, S, N, B, T]$, in units of m$^3$/s. Round each entry to four significant figures.",
            "solution": "We begin from the finite-volume discretization of the continuity equation over a control volume of volume $V$, with outward-pointing face normals:\n$$\\int_{V} \\nabla \\cdot \\mathbf{u} \\, dV = \\sum_{f} \\int_{A_{f}} \\mathbf{u} \\cdot \\mathbf{n}_{f} \\, dA \\approx \\sum_{f} \\phi_{f} = 0,$$\nwhere $\\phi_{f}$ denotes the outward volumetric flux through face $f$. In a predictor–corrector step of the Pressure-Implicit with Splitting of Operators (PISO) algorithm, the velocity (and hence the face fluxes) are first predicted from the momentum equations using a known pressure (or pressure-like) field, resulting in a predicted flux $\\phi_{f}^{*}$ that generally does not satisfy the discrete continuity equation. A pressure correction $p'$ is then introduced to adjust the velocity and fluxes such that the corrected fluxes $\\phi_{f} = \\phi_{f}^{*} + \\Delta \\phi_{f}$ satisfy\n$$\\sum_{f} \\phi_{f} = \\sum_{f} \\left( \\phi_{f}^{*} + \\Delta \\phi_{f} \\right) = 0.$$\n\nTo relate $\\Delta \\phi_{f}$ to the pressure correction $p'$, we start from the linearized, semi-discrete momentum equation used in the predictor step:\n$$a_{P} \\mathbf{u}_{P}^{*} = \\mathbf{H}_{P} - \\nabla p^{n},$$\nwhere $a_{P}  0$ is the diagonal coefficient from the discretization of the transient and diffusive terms, $\\mathbf{H}_{P}$ collects the known explicit contributions, and $p^{n}$ is the known pressure from the previous iteration/time level. The correction step introduces $\\mathbf{u} = \\mathbf{u}^{*} + \\mathbf{u}'$ with a pressure correction $p'$ such that the corrected momentum balance yields\n$$a_{P} \\mathbf{u}_{P} = \\mathbf{H}_{P} - \\nabla (p^{n} + p').$$\nSubtracting the predictor equation from the corrected equation gives the velocity correction relation\n$$a_{P} \\mathbf{u}'_{P} = - \\nabla p'.$$\nAssuming a standard linear interpolation of $a_{P}^{-1}$ from neighboring cell centers to the face and a centered difference for the normal pressure gradient at face $f$ along the line connecting the owner $P$ and neighbor $N(f)$, the face-normal component of the velocity correction leads to a volumetric flux correction of the form\n$$\\Delta \\phi_{f} \\equiv \\left( \\mathbf{u}' \\cdot \\mathbf{n}_{f} \\right) A_{f} = - D_{f} \\left( p'_{N(f)} - p'_{P} \\right),$$\nwhere $D_{f}  0$ is the given face pressure–velocity coupling coefficient that results from the interpolation of $a_{P}^{-1}$, the face area magnitude $A_{f} = |\\mathbf{S}_{f}|$, and the inverse of the owner–neighbor distance along the normal. The sign convention is consistent with the outward-pointing face normal; specifically, a positive $(p'_{N(f)} - p'_{P})$ induces a negative outward correction $\\Delta \\phi_{f}$, reducing the divergence.\n\nThe corrected outward flux on each face is therefore\n$$\\phi_{f} = \\phi_{f}^{*} - D_{f} \\left( p'_{N(f)} - p'_{P} \\right).$$\n\nWe now compute the required pressure differences and corrections for each face using the provided data. The owner cell pressure correction is $p'_{P} = 0$. The neighbor corrections are $p'_{W} = -1$, $p'_{E} = 2$, $p'_{S} = 3$, $p'_{N} = 1$, $p'_{B} = 0.5$, $p'_{T} = -2$, all in Pa. The face coefficients $D_{f}$ are given in m$^3$/s/Pa.\n\nCompute pressure differences $\\Delta p'_{f} \\equiv p'_{N(f)} - p'_{P}$:\n- West face: $\\Delta p'_{W} = p'_{W} - p'_{P} = -1 - 0 = -1$.\n- East face: $\\Delta p'_{E} = p'_{E} - p'_{P} = 2 - 0 = 2$.\n- South face: $\\Delta p'_{S} = p'_{S} - p'_{P} = 3 - 0 = 3$.\n- North face: $\\Delta p'_{N} = p'_{N} - p'_{P} = 1 - 0 = 1$.\n- Bottom face: $\\Delta p'_{B} = p'_{B} - p'_{P} = 0.5 - 0 = 0.5$.\n- Top face: $\\Delta p'_{T} = p'_{T} - p'_{P} = -2 - 0 = -2$.\n\nCompute flux corrections $\\Delta \\phi_{f} = - D_{f} \\, \\Delta p'_{f}$ (units m$^3$/s):\n- West: $\\Delta \\phi_{W} = - (2.000 \\times 10^{-6}) \\times (-1) = +2.000 \\times 10^{-6}$.\n- East: $\\Delta \\phi_{E} = - (1.000 \\times 10^{-6}) \\times (2) = -2.000 \\times 10^{-6}$.\n- South: $\\Delta \\phi_{S} = - (5.000 \\times 10^{-7}) \\times (3) = -1.500 \\times 10^{-6}$.\n- North: $\\Delta \\phi_{N} = - (1.500 \\times 10^{-6}) \\times (1) = -1.500 \\times 10^{-6}$.\n- Bottom: $\\Delta \\phi_{B} = - (3.000 \\times 10^{-6}) \\times (0.5) = -1.500 \\times 10^{-6}$.\n- Top: $\\Delta \\phi_{T} = - (1.000 \\times 10^{-6}) \\times (-2) = +2.000 \\times 10^{-6}$.\n\nCompute corrected fluxes $\\phi_{f} = \\phi_{f}^{*} + \\Delta \\phi_{f}$:\n- West: $\\phi_{W} = (-1.000 \\times 10^{-5}) + (2.000 \\times 10^{-6}) = -8.000 \\times 10^{-6}$ m$^3$/s.\n- East: $\\phi_{E} = (8.000 \\times 10^{-6}) + (-2.000 \\times 10^{-6}) = 6.000 \\times 10^{-6}$ m$^3$/s.\n- South: $\\phi_{S} = (6.000 \\times 10^{-6}) + (-1.500 \\times 10^{-6}) = 4.500 \\times 10^{-6}$ m$^3$/s.\n- North: $\\phi_{N} = (5.000 \\times 10^{-6}) + (-1.500 \\times 10^{-6}) = 3.500 \\times 10^{-6}$ m$^3$/s.\n- Bottom: $\\phi_{B} = (-2.500 \\times 10^{-6}) + (-1.500 \\times 10^{-6}) = -4.000 \\times 10^{-6}$ m$^3$/s.\n- Top: $\\phi_{T} = (-4.000 \\times 10^{-6}) + (2.000 \\times 10^{-6}) = -2.000 \\times 10^{-6}$ m$^3$/s.\n\nVerification of discrete continuity:\n$$\\sum_{f} \\phi_{f} = (-8.000 + 6.000 + 4.500 + 3.500 - 4.000 - 2.000) \\times 10^{-6} = 0,$$\nas required.\n\nTherefore, the corrected outward face flux vector in the order $[W, E, S, N, B, T]$ is\n$$\\left( -8.000 \\times 10^{-6}, \\; 6.000 \\times 10^{-6}, \\; 4.500 \\times 10^{-6}, \\; 3.500 \\times 10^{-6}, \\; -4.000 \\times 10^{-6}, \\; -2.000 \\times 10^{-6} \\right) \\text{ m}^3\\text{/s}.$$\n\nRounded to four significant figures, these values are already in the required form.",
            "answer": "$$\\boxed{\\begin{pmatrix}-8.000 \\times 10^{-6}  6.000 \\times 10^{-6}  4.500 \\times 10^{-6}  3.500 \\times 10^{-6}  -4.000 \\times 10^{-6}  -2.000 \\times 10^{-6}\\end{pmatrix}}$$"
        }
    ]
}