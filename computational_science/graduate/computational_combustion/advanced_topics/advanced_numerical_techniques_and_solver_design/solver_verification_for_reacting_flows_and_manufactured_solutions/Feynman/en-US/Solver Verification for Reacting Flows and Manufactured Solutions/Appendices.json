{
    "hands_on_practices": [
        {
            "introduction": "The core of the Method of Manufactured Solutions (MMS) is forcing a chosen analytic function to be an exact solution to a governing equation. This first exercise provides foundational practice in this process by tasking you with deriving the necessary source term for the compressible continuity equation . Mastering this step of substituting the manufactured fields into the governing partial differential equation and solving for the residual is essential for applying MMS to any conservation law.",
            "id": "4064345",
            "problem": "Consider a two-dimensional, compressible reacting flow of a single-phase mixture on a simply connected domain $\\Omega \\subset \\mathbb{R}^{2}$ with smooth boundary $\\partial \\Omega$. The governing principle is conservation of total mixture mass: the time rate of change of total mass in any material control volume is equal to the net mass flux through the boundary plus any volumetric mass sources due to modeling (for verification) or external mass injection. Assume smooth fields and neglect any singular sources, so the usual transformation to the local (differential) form is valid. In the Method of Manufactured Solutions (MMS), one chooses analytic fields and derives a forcing term that makes those fields satisfy the governing equation exactly. Let the manufactured density and velocity be\n$$\n\\rho(x,y,t) = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right],\n$$\n$$\nu(x,y,t) = U_{0}\\,\\cos(\\alpha x)\\,\\sin(\\beta y)\\,\\exp(\\mu t), \\quad v(x,y,t) = V_{0}\\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\nu t),\n$$\nwhere $(x,y)\\in\\Omega$, $t\\ge 0$, $\\rho_{0}>0$, $a\\in(0,1)$, $\\alpha>0$, $\\beta>0$, and $U_{0}$, $V_{0}$, $\\lambda$, $\\mu$, $\\nu$ are real constants. Define the velocity vector as $\\mathbf{u}=(u,v)$. Starting from the integral statement of conservation of mass and proceeding to its local differential form, derive the MMS source term $S_{\\rho}(x,y,t)$ for the continuity equation that enforces the above $\\rho(x,y,t)$ and $\\mathbf{u}(x,y,t)$ as an exact solution of the compressible continuity equation. Explicitly compute $S_{\\rho}(x,y,t)$ in closed form, in terms of $x$, $y$, $t$, and the given constants. Then, explain how the derived $S_{\\rho}$ forces exact balance in a compressible solver when these manufactured fields are substituted. Your final answer must be the single, closed-form analytical expression for $S_{\\rho}(x,y,t)$. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of fluid dynamics and the Method of Manufactured Solutions (MMS), a standard verification technique in computational science. The problem is well-posed, objective, and self-contained, with all necessary fields and constants defined to permit a unique, analytical derivation of the source term.\n\nThe objective is to find the source term $S_{\\rho}(x,y,t)$ that makes the given manufactured fields for density $\\rho(x,y,t)$ and velocity $\\mathbf{u}(x,y,t)$ an exact solution to the compressible continuity equation. The local, differential form of the continuity equation with a source term is:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}\n$$\nIn two-dimensional Cartesian coordinates, this equation is expressed as:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\partial (\\rho v)}{\\partial y} = S_{\\rho}\n$$\nBy definition in MMS, the source term $S_{\\rho}$ is the result of substituting the manufactured fields into the left-hand side of the equation. We will compute each term individually.\n\nThe given manufactured fields are:\n$$\n\\rho(x,y,t) = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right]\n$$\n$$\nu(x,y,t) = U_{0}\\,\\cos(\\alpha x)\\,\\sin(\\beta y)\\,\\exp(\\mu t)\n$$\n$$\nv(x,y,t) = V_{0}\\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\nu t)\n$$\n\nFirst, we compute the time derivative of the density, $\\frac{\\partial \\rho}{\\partial t}$:\n$$\n\\frac{\\partial \\rho}{\\partial t} = \\frac{\\partial}{\\partial t} \\left( \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right] \\right)\n$$\n$$\n\\frac{\\partial \\rho}{\\partial t} = \\rho_{0} \\left[ a \\,\\sin(\\alpha x)\\,\\cos(\\beta y) \\cdot \\lambda \\exp(\\lambda t) \\right]\n$$\n$$\n\\frac{\\partial \\rho}{\\partial t} = \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y)\n$$\n\nNext, we compute the divergence of the mass flux, $\\nabla \\cdot (\\rho \\mathbf{u}) = \\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\partial (\\rho v)}{\\partial y}$.\n\nWe start with the $x$-component of the mass flux, $\\rho u$:\n$$\n\\rho u = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right] \\cdot U_{0}\\,\\cos(\\alpha x)\\,\\sin(\\beta y)\\,\\exp(\\mu t)\n$$\n$$\n\\rho u = \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\beta y) \\left[ \\cos(\\alpha x) + a \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\alpha x)\\cos(\\beta y) \\right]\n$$\nNow, we differentiate with respect to $x$:\n$$\n\\frac{\\partial (\\rho u)}{\\partial x} = \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\beta y) \\frac{\\partial}{\\partial x} \\left[ \\cos(\\alpha x) + a \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\alpha x)\\cos(\\beta y) \\right]\n$$\nUsing the derivatives $\\frac{d}{d\\theta}(\\cos A\\theta) = -A\\sin A\\theta$ and $\\frac{d}{d\\theta}(\\sin A\\theta \\cos A\\theta) = \\frac{d}{d\\theta}(\\frac{1}{2}\\sin 2A\\theta) = A\\cos 2A\\theta$, we get:\n$$\n\\frac{\\partial (\\rho u)}{\\partial x} = \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\beta y) \\left[ -\\alpha \\sin(\\alpha x) + a \\exp(\\lambda t) (\\alpha \\cos(2\\alpha x))\\cos(\\beta y) \\right]\n$$\n$$\n\\frac{\\partial (\\rho u)}{\\partial x} = -\\alpha \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\alpha x) \\sin(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y)\n$$\n\nNext, we compute the $y$-component of the mass flux, $\\rho v$:\n$$\n\\rho v = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right] \\cdot V_{0}\\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\nu t)\n$$\n$$\n\\rho v = \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\left[ \\cos(\\beta y) + a \\exp(\\lambda t) \\sin(\\alpha x) \\cos^{2}(\\beta y) \\right]\n$$\nNow, we differentiate with respect to $y$:\n$$\n\\frac{\\partial (\\rho v)}{\\partial y} = \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\frac{\\partial}{\\partial y} \\left[ \\cos(\\beta y) + a \\exp(\\lambda t) \\sin(\\alpha x) \\cos^{2}(\\beta y) \\right]\n$$\nUsing the derivatives $\\frac{d}{d\\theta}(\\cos A\\theta) = -A\\sin A\\theta$ and $\\frac{d}{d\\theta}(\\cos^2 A\\theta) = 2\\cos A\\theta(-A\\sin A\\theta) = -A\\sin 2A\\theta$, we get:\n$$\n\\frac{\\partial (\\rho v)}{\\partial y} = \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\left[ -\\beta \\sin(\\beta y) + a \\exp(\\lambda t) \\sin(\\alpha x) (-\\beta \\sin(2\\beta y)) \\right]\n$$\n$$\n\\frac{\\partial (\\rho v)}{\\partial y} = -\\beta \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\sin(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y)\n$$\n\nFinally, we sum all the terms to obtain the source term $S_{\\rho}(x,y,t)$:\n$$\nS_{\\rho}(x,y,t) = \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\partial (\\rho v)}{\\partial y}\n$$\n$$\nS_{\\rho}(x,y,t) = \\left( \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y) \\right)\n$$\n$$\n+ \\left( -\\alpha \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\alpha x) \\sin(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y) \\right)\n$$\n$$\n+ \\left( -\\beta \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\sin(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y) \\right)\n$$\nGrouping terms provides a more structured expression:\n$$\nS_{\\rho}(x,y,t) = -\\rho_{0} (\\alpha U_{0} \\exp(\\mu t) + \\beta V_{0} \\exp(\\nu t)) \\sin(\\alpha x) \\sin(\\beta y) + \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y)\n$$\nThis is the closed-form analytical expression for the required source term.\n\nIn the context of solver verification, a numerical code would discretize the equation $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}$. The manufactured fields $\\rho(x,y,t)$ and $\\mathbf{u}(x,y,t)$ are specified at all grid points, along with the analytically derived source term $S_{\\rho}(x,y,t)$. The code then computes the numerical approximation of the left-hand side, which we may call $L_h$. The difference between the computed $L_h$ and the provided source term $S_{\\rho}$ is the discretization error of the solver. By design, the manufactured fields are an exact solution to the continuous PDE with the derived source term. Therefore, as the mesh and time step are refined, this error, $||L_h - S_{\\rho}||$, must decrease at a rate consistent with the theoretical order of accuracy of the numerical method. This process verifies that the solver correctly implements the physics represented by the continuity equation.",
            "answer": "$$\n\\boxed{-\\rho_{0} (\\alpha U_{0} \\exp(\\mu t) + \\beta V_{0} \\exp(\\nu t)) \\sin(\\alpha x) \\sin(\\beta y) + \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y)}\n$$"
        },
        {
            "introduction": "Real-world problems like combustion involve the tight coupling of multiple physical processes, including fluid flow, species transport, and heat transfer. This practice extends the fundamental MMS procedure to a system of coupled conservation equations for mass, species, and energy . By deriving source terms for this entire system, you will learn how to ensure that the manufactured solution satisfies all governing equations simultaneously, a crucial skill for verifying complex multi-physics solvers.",
            "id": "4064325",
            "problem": "Consider the Method of Manufactured Solutions (MMS) for verifying a reacting-flow solver in computational combustion. A binary mixture of two species is modeled with constant mixture density $\\rho$, constant viscosity (not used explicitly here), constant mass-diffusivity $D$ for mixture-averaged diffusion, constant thermal conductivity $k$, and constant specific heat at constant pressure $c_{p}$. Neglect chemical reaction ($\\omega_{k} = 0$ for $k = 1,2$), the Dufour and Soret effects, and assume equal species specific heats so that $\\sum_{k} h_{k} \\mathbf{J}_{k}$ vanishes, where $h_{k} = c_{p} T$. The governing steady conservation equations to be verified are:\n- Mass (continuity): $\\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}$.\n- Species $k$ (conservative form): $\\nabla \\cdot (\\rho Y_{k} \\mathbf{u} + \\mathbf{J}_{k}) = S_{k}$ for $k = 1,2$, with mixture-averaged diffusion flux $\\mathbf{J}_{1} = - \\rho D \\nabla Y_{1}$ and $\\mathbf{J}_{2} = - \\mathbf{J}_{1}$.\n- Thermal energy (conservative enthalpy form): $\\nabla \\cdot (\\rho c_{p} T \\mathbf{u}) = \\nabla \\cdot (k \\nabla T) + S_{T}$.\n\nOn a two-dimensional periodic domain in the coordinates $(x,y)$, the manufactured fields are prescribed as\n$$\n\\mathbf{u}(x,y) = \\big( U_{0} \\sin x \\cos y, \\, V_{0} \\cos x \\sin y \\big), \\quad\nT(x,y) = T_{0} + \\epsilon \\sin x \\sin y,\n$$\n$$\nY_{1}(x,y) = Y_{10} + \\epsilon \\cos x, \\quad Y_{2}(x,y) = 1 - Y_{1}(x,y),\n$$\nwhere $U_{0}$, $V_{0}$, $T_{0}$, $Y_{10}$, $\\epsilon$, $\\rho$, $D$, $k$, and $c_{p}$ are constants. Starting from the stated conservation laws and the mixture-averaged diffusion model, derive the steady MMS source terms $S_{\\rho}$, $S_{1}$, $S_{2}$, and $S_{T}$ that make the prescribed fields exact solutions of the respective equations. Your derivation must be based solely on the equations given and standard vector calculus identities. Express the final answer as closed-form analytic expressions in terms of $x$, $y$, and the listed constants. No rounding is required. Present your final answer as a single row matrix in the order $\\big[S_{\\rho}, \\, S_{1}, \\, S_{2}, \\, S_{T}\\big]$.",
            "solution": "The problem statement has been validated and is deemed valid. It is a well-posed problem in computational fluid dynamics, specifically concerning the Method of Manufactured Solutions (MMS) for code verification. All necessary equations, fields, and constants are provided, and there are no internal contradictions or scientific fallacies. We may proceed with the derivation of the source terms.\n\nThe objective is to find the source terms $S_{\\rho}$, $S_{1}$, $S_{2}$, and $S_{T}$ that make the prescribed manufactured fields exact solutions to the given steady-state conservation equations. This is achieved by substituting the given fields for velocity $\\mathbf{u}$, temperature $T$, and mass fraction $Y_1$ into the governing equations and evaluating the resulting expressions.\n\nThe manufactured fields are:\n$$\n\\mathbf{u}(x,y) = \\begin{pmatrix} u \\\\ v \\end{pmatrix} = \\begin{pmatrix} U_{0} \\sin x \\cos y \\\\ V_{0} \\cos x \\sin y \\end{pmatrix}\n$$\n$$\nT(x,y) = T_{0} + \\epsilon \\sin x \\sin y\n$$\n$$\nY_{1}(x,y) = Y_{10} + \\epsilon \\cos x\n$$\n$$\nY_{2}(x,y) = 1 - Y_{1}(x,y) = 1 - Y_{10} - \\epsilon \\cos x\n$$\nAll parameters $\\rho$, $D$, $k$, $c_p$, $U_0$, $V_0$, $T_0$, $Y_{10}$, and $\\epsilon$ are constants.\n\nWe will calculate each source term individually.\n\n**1. Mass Source Term ($S_{\\rho}$)**\n\nThe mass conservation (continuity) equation is:\n$$\nS_{\\rho} = \\nabla \\cdot (\\rho \\mathbf{u})\n$$\nSince the density $\\rho$ is constant, we can write:\n$$\nS_{\\rho} = \\rho (\\nabla \\cdot \\mathbf{u}) = \\rho \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right)\n$$\nWe compute the partial derivatives of the velocity components:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}(U_{0} \\sin x \\cos y) = U_{0} \\cos x \\cos y\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y}(V_{0} \\cos x \\sin y) = V_{0} \\cos x \\cos y\n$$\nSubstituting these into the expression for $S_{\\rho}$:\n$$\nS_{\\rho} = \\rho (U_{0} \\cos x \\cos y + V_{0} \\cos x \\cos y) = \\rho (U_{0} + V_{0}) \\cos x \\cos y\n$$\n\n**2. Species Source Term ($S_{1}$)**\n\nThe conservation equation for species $1$ is:\n$$\nS_{1} = \\nabla \\cdot (\\rho Y_{1} \\mathbf{u} + \\mathbf{J}_{1})\n$$\nThe diffusion flux is given by $\\mathbf{J}_{1} = - \\rho D \\nabla Y_{1}$. Substituting this into the species equation:\n$$\nS_{1} = \\nabla \\cdot (\\rho Y_{1} \\mathbf{u} - \\rho D \\nabla Y_{1})\n$$\nSince $\\rho$ and $D$ are constant:\n$$\nS_{1} = \\rho \\left[ \\nabla \\cdot (Y_{1} \\mathbf{u}) - D \\nabla \\cdot (\\nabla Y_{1}) \\right] = \\rho \\left[ \\nabla \\cdot (Y_{1} \\mathbf{u}) - D \\nabla^{2} Y_{1} \\right]\n$$\nUsing the vector identity $\\nabla \\cdot (f \\mathbf{A}) = f (\\nabla \\cdot \\mathbf{A}) + \\mathbf{A} \\cdot (\\nabla f)$, we expand the convective term:\n$$\n\\nabla \\cdot (Y_{1} \\mathbf{u}) = Y_{1} (\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot (\\nabla Y_{1})\n$$\nWe have already found $\\nabla \\cdot \\mathbf{u} = (U_{0} + V_{0}) \\cos x \\cos y$. Next, we find the gradient of $Y_{1}$:\n$$\n\\nabla Y_{1} = \\left( \\frac{\\partial Y_{1}}{\\partial x}, \\frac{\\partial Y_{1}}{\\partial y} \\right) = \\left( \\frac{\\partial}{\\partial x}(Y_{10} + \\epsilon \\cos x), \\frac{\\partial}{\\partial y}(Y_{10} + \\epsilon \\cos x) \\right) = (-\\epsilon \\sin x, 0)\n$$\nNow we compute the advection term $\\mathbf{u} \\cdot \\nabla Y_{1}$:\n$$\n\\mathbf{u} \\cdot \\nabla Y_{1} = (U_{0} \\sin x \\cos y)(-\\epsilon \\sin x) + (V_{0} \\cos x \\sin y)(0) = -U_{0} \\epsilon \\sin^{2} x \\cos y\n$$\nNext, we compute the Laplacian of $Y_1$, $\\nabla^{2} Y_{1}$:\n$$\n\\nabla^{2} Y_{1} = \\frac{\\partial^{2} Y_{1}}{\\partial x^{2}} + \\frac{\\partial^{2} Y_{1}}{\\partial y^{2}} = \\frac{\\partial}{\\partial x}(-\\epsilon \\sin x) + 0 = -\\epsilon \\cos x\n$$\nNow, we assemble all the pieces for $S_{1}$:\n$$\nS_{1} = \\rho \\left[ Y_{1} (\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot \\nabla Y_{1} - D \\nabla^{2} Y_{1} \\right]\n$$\n$$\nS_{1} = \\rho \\left[ (Y_{10} + \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y - U_{0} \\epsilon \\sin^{2} x \\cos y - D(-\\epsilon \\cos x) \\right]\n$$\n$$\nS_{1} = \\rho \\left[ (Y_{10} + \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y - U_{0} \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right]\n$$\n\n**3. Species Source Term ($S_{2}$)**\n\nThe mass fractions must sum to unity, $\\sum_{k} Y_k = Y_1 + Y_2 = 1$. Consequently, the sum of species conservation equations must be consistent with the overall mass conservation. Summing the two species equations:\n$$\nS_{1} + S_{2} = \\nabla \\cdot (\\rho Y_{1} \\mathbf{u} + \\mathbf{J}_{1}) + \\nabla \\cdot (\\rho Y_{2} \\mathbf{u} + \\mathbf{J}_{2}) = \\nabla \\cdot (\\rho (Y_{1}+Y_{2}) \\mathbf{u} + (\\mathbf{J}_{1}+\\mathbf{J}_{2}))\n$$\nUsing $Y_1+Y_2=1$ and $\\mathbf{J}_2 = -\\mathbf{J}_1$ (so $\\mathbf{J}_1+\\mathbf{J}_2=0$), this simplifies to:\n$$\nS_{1} + S_{2} = \\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}\n$$\nTherefore, we can find $S_{2}$ from $S_{2} = S_{\\rho} - S_{1}$.\n$$\nS_{2} = \\rho(U_{0} + V_{0}) \\cos x \\cos y - \\rho \\left[ (Y_{10} + \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y - U_{0} \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right]\n$$\n$$\nS_{2} = \\rho(U_{0} + V_{0}) \\cos x \\cos y \\left[ 1 - (Y_{10} + \\epsilon \\cos x) \\right] + \\rho U_{0} \\epsilon \\sin^2 x \\cos y - \\rho D \\epsilon \\cos x\n$$\nSince $1 - (Y_{10} + \\epsilon \\cos x) = 1 - Y_1 = Y_2$:\n$$\nS_{2} = \\rho Y_{2} (U_{0} + V_{0}) \\cos x \\cos y + \\rho U_{0} \\epsilon \\sin^2 x \\cos y - \\rho D \\epsilon \\cos x\n$$\nSubstituting the expression for $Y_{2}(x,y)$:\n$$\nS_{2} = \\rho \\left[ (1 - Y_{10} - \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y + U_{0} \\epsilon \\sin^2 x \\cos y - D \\epsilon \\cos x \\right]\n$$\n\n**4. Energy Source Term ($S_{T}$)**\n\nThe thermal energy equation is:\n$$\n\\nabla \\cdot (\\rho c_{p} T \\mathbf{u}) = \\nabla \\cdot (k \\nabla T) + S_{T}\n$$\nSolving for $S_{T}$:\n$$\nS_{T} = \\nabla \\cdot (\\rho c_{p} T \\mathbf{u}) - \\nabla \\cdot (k \\nabla T)\n$$\nSince $\\rho$, $c_p$, and $k$ are constants:\n$$\nS_{T} = \\rho c_{p} \\nabla \\cdot (T \\mathbf{u}) - k \\nabla^{2} T\n$$\nUsing the same vector identity as for the species equation:\n$$\nS_{T} = \\rho c_{p} \\left[ T(\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot \\nabla T \\right] - k \\nabla^{2} T\n$$\nWe need the gradient and Laplacian of the temperature field $T(x,y) = T_{0} + \\epsilon \\sin x \\sin y$.\nThe gradient is:\n$$\n\\nabla T = \\left( \\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y} \\right) = (\\epsilon \\cos x \\sin y, \\epsilon \\sin x \\cos y)\n$$\nThe dot product $\\mathbf{u} \\cdot \\nabla T$ is:\n$$\n\\mathbf{u} \\cdot \\nabla T = (U_{0} \\sin x \\cos y)(\\epsilon \\cos x \\sin y) + (V_{0} \\cos x \\sin y)(\\epsilon \\sin x \\cos y)\n$$\n$$\n\\mathbf{u} \\cdot \\nabla T = U_{0} \\epsilon \\sin x \\cos x \\sin y \\cos y + V_{0} \\epsilon \\sin x \\cos x \\sin y \\cos y = (U_{0} + V_{0}) \\epsilon \\sin x \\cos x \\sin y \\cos y\n$$\nThe Laplacian of $T$ is:\n$$\n\\frac{\\partial^{2} T}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}(\\epsilon \\cos x \\sin y) = -\\epsilon \\sin x \\sin y\n$$\n$$\n\\frac{\\partial^{2} T}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}(\\epsilon \\sin x \\cos y) = -\\epsilon \\sin x \\sin y\n$$\n$$\n\\nabla^{2} T = \\frac{\\partial^{2} T}{\\partial x^{2}} + \\frac{\\partial^{2} T}{\\partial y^{2}} = -2\\epsilon \\sin x \\sin y\n$$\nNow, assemble the terms for $S_{T}$:\n$$\nS_{T} = \\rho c_{p} \\left[ (T_{0} + \\epsilon \\sin x \\sin y)(U_{0} + V_{0})\\cos x \\cos y + (U_{0} + V_{0}) \\epsilon \\sin x \\cos x \\sin y \\cos y \\right] - k(-2\\epsilon \\sin x \\sin y)\n$$\nFactor out $(U_0+V_0)$ from the convective part:\n$$\nS_{T} = \\rho c_{p} (U_{0} + V_{0}) \\left[ T_{0} \\cos x \\cos y + \\epsilon \\sin x \\sin y \\cos x \\cos y + \\epsilon \\sin x \\cos x \\sin y \\cos y \\right] + 2k\\epsilon \\sin x \\sin y\n$$\n$$\nS_{T} = \\rho c_{p} (U_{0} + V_{0}) (T_{0} \\cos x \\cos y + 2 \\epsilon \\sin x \\cos x \\sin y \\cos y) + 2k\\epsilon \\sin x \\sin y\n$$\n\nSummary of the final expressions for the source terms:\n$$\nS_{\\rho} = \\rho(U_0 + V_0) \\cos x \\cos y\n$$\n$$\nS_{1} = \\rho \\left[ (Y_{10} + \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y - U_0 \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right]\n$$\n$$\nS_{2} = \\rho \\left[ (1 - Y_{10} - \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y + U_0 \\epsilon \\sin^2 x \\cos y - D \\epsilon \\cos x \\right]\n$$\n$$\nS_{T} = \\rho c_p (U_0+V_0) (T_0 \\cos x \\cos y + 2 \\epsilon \\sin x \\cos x \\sin y \\cos y) + 2k\\epsilon \\sin x \\sin y\n$$\nThese expressions are now ready for final formatting.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\rho(U_0 + V_0) \\cos x \\cos y & \\rho \\left[ (Y_{10} + \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y - U_0 \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right] & \\rho \\left[ (1 - Y_{10} - \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y + U_0 \\epsilon \\sin^2 x \\cos y - D \\epsilon \\cos x \\right] & \\rho c_p (U_0+V_0) (T_0 \\cos x \\cos y + 2 \\epsilon \\sin x \\cos x \\sin y \\cos y) + 2 k \\epsilon \\sin x \\sin y \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The ultimate goal of MMS is not just to create a problem with a known solution, but to use that solution to rigorously test a numerical solver's implementation. This final practice demonstrates the \"payoff\" phase of verification, where you analyze the error of a discrete numerical scheme by comparing it against the manufactured solution . By deriving the leading-order local truncation error using Taylor series expansions, you can predict the theoretical convergence rate, which can then be compared to observed rates from the code to confirm it is working as designed.",
            "id": "4064285",
            "problem": "Consider a one-dimensional, steady, nondimensional convection–diffusion–reaction balance for a reacting scalar $Y(x)$ representative of a species mass fraction in a premixed flame, posed on a periodic domain $x \\in [0, 2\\pi]$:\n$$\\mathrm{Pe}\\,\\frac{dY}{dx} \\;=\\; \\frac{d^{2}Y}{dx^{2}} \\;+\\; S(x),$$\nwhere $\\mathrm{Pe} > 0$ is the Péclet number, $S(x)$ is a nondimensional source term that aggregates reactive production and consumption, and the domain coordinate $x$ is nondimensional and measured in radians. Let a Manufactured Solution Method be used for solver verification, with the manufactured solution\n$$Y_{M}(x) \\;=\\; \\sin(m\\,x),$$\nfor a given positive integer mode number $m \\geq 1$. The source term $S(x)$ is to be chosen so that $Y_{M}(x)$ satisfies the continuous equation exactly.\n\nDiscretize the equation with a cell-centered finite-volume method on a uniform mesh of $N$ cells with spacing $\\Delta x = 2\\pi/N$, periodic boundaries, and the following face fluxes:\n- Convective flux evaluated with first-order upwinding (for $\\mathrm{Pe} > 0$), which produces in the cell balance the backward difference approximation $\\left(Y_{i} - Y_{i-1}\\right)/\\Delta x$ for $\\frac{dY}{dx}\\big|_{x_i}$.\n- Diffusive flux evaluated with second-order central differencing, which produces in the cell balance the second difference approximation $\\left(Y_{i+1} - 2Y_{i} + Y_{i-1}\\right)/\\Delta x^{2}$ for $\\frac{d^{2}Y}{dx^{2}}\\big|_{x_i}$.\n\nDefine the local truncation error $T_{h}(x)$ by substituting the exact manufactured solution $Y_{M}$ into the discrete operator and subtracting the exact continuous operator with the source $S(x)$ evaluated at cell centers. Derive $T_{h}(x)$ up to and including the leading-order term in $\\Delta x$ for the specified finite-volume scheme. Then, using this truncation error result and standard consistency–stability arguments for linear steady operators, predict the observed order of convergence $p$ in the maximum norm (Light Amplification by Stimulated Emission of Radiation (LASER) style acronym usage is not relevant here; the maximum norm is commonly denoted $L_{\\infty}$) of the solution error under mesh refinement.\n\nProvide your final answer as a two-entry row matrix, containing:\n1. The leading-order local truncation error function $T_{h}(x)$ expressed analytically in terms of $\\mathrm{Pe}$, $m$, $x$, and $\\Delta x$, keeping only the term of lowest order in $\\Delta x$.\n2. The predicted observed convergence rate $p$ in the $L_{\\infty}$ norm.\n\nNo numerical evaluation is required; report the analytic expression and the integer $p$. Do not include any units in your final answer.",
            "solution": "The governing equation is the nondimensional steady convection–diffusion–reaction balance\n$$\\mathrm{Pe}\\,\\frac{dY}{dx} \\;=\\; \\frac{d^{2}Y}{dx^{2}} \\;+\\; S(x),$$\nwith a Manufactured Solution Method choice $Y_{M}(x) = \\sin(m x)$ on $x \\in [0, 2\\pi]$.\n\nTo determine the source term $S(x)$ that makes $Y_{M}$ an exact solution, substitute $Y_{M}$ into the continuous operator:\n$$\\frac{dY_{M}}{dx} = m \\cos(m x), \\qquad \\frac{d^{2}Y_{M}}{dx^{2}} = -m^{2} \\sin(m x).$$\nThus the exact source required is\n$$S(x) = \\mathrm{Pe}\\,m \\cos(m x) + m^{2} \\sin(m x),$$\nso that the continuous equation is satisfied exactly:\n$$\\mathrm{Pe}\\,\\frac{dY_{M}}{dx} - \\frac{d^{2}Y_{M}}{dx^{2}} - S(x) \\equiv 0.$$\n\nNow consider the discrete finite-volume operator at a cell center $x_{i}$ with uniform grid spacing $\\Delta x = 2\\pi/N$ and periodic boundaries. The chosen flux discretizations yield the following discrete operator applied to a grid function $Y_{i}$:\n$$L_{h}(Y)_{i} \\;=\\; \\mathrm{Pe}\\,\\frac{Y_{i} - Y_{i-1}}{\\Delta x} \\;-\\; \\frac{Y_{i+1} - 2Y_{i} + Y_{i-1}}{\\Delta x^{2}} \\;-\\; S(x_{i}).$$\nBy definition, the local truncation error at $x_{i}$ for the manufactured solution is\n$$T_{h}(x_{i}) \\;=\\; L_{h}(Y_{M})_{i} \\;-\\; \\left[ \\mathrm{Pe}\\,\\frac{dY_{M}}{dx}(x_{i}) \\;-\\; \\frac{d^{2}Y_{M}}{dx^{2}}(x_{i}) \\;-\\; S(x_{i}) \\right].$$\nBecause $S(x)$ is evaluated at cell centers and precisely cancels the continuous operator on $Y_{M}$, we have\n$$T_{h}(x_{i}) \\;=\\; \\mathrm{Pe}\\left(\\frac{Y_{M,i} - Y_{M,i-1}}{\\Delta x} - \\frac{dY_{M}}{dx}(x_{i})\\right) \\;-\\; \\left(\\frac{Y_{M,i+1} - 2Y_{M,i} + Y_{M,i-1}}{\\Delta x^{2}} - \\frac{d^{2}Y_{M}}{dx^{2}}(x_{i})\\right).$$\n\nWe expand the discrete differences using Taylor series about $x_{i}$ for a smooth function $Y$:\n- Backward difference for the first derivative:\n$$\\frac{Y_{i} - Y_{i-1}}{\\Delta x} \\;=\\; \\frac{dY}{dx}(x_{i}) \\;-\\; \\frac{1}{2}\\frac{d^{2}Y}{dx^{2}}(x_{i})\\,\\Delta x \\;+\\; \\frac{1}{6}\\frac{d^{3}Y}{dx^{3}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3}).$$\n- Second difference for the second derivative:\n$$\\frac{Y_{i+1} - 2Y_{i} + Y_{i-1}}{\\Delta x^{2}} \\;=\\; \\frac{d^{2}Y}{dx^{2}}(x_{i}) \\;+\\; \\frac{1}{12}\\frac{d^{4}Y}{dx^{4}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{4}).$$\n\nApplying these to $Y_{M}$ and subtracting the exact derivatives, the truncation error becomes\n$$T_{h}(x_{i}) \\;=\\; \\mathrm{Pe}\\left[-\\frac{1}{2}\\frac{d^{2}Y_{M}}{dx^{2}}(x_{i})\\,\\Delta x \\;+\\; \\frac{1}{6}\\frac{d^{3}Y_{M}}{dx^{3}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3})\\right] \\;-\\; \\left[\\frac{1}{12}\\frac{d^{4}Y_{M}}{dx^{4}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{4})\\right].$$\n\nCompute the required derivatives of $Y_{M}(x) = \\sin(m x)$:\n$$\\frac{d^{2}Y_{M}}{dx^{2}} = -m^{2}\\sin(m x), \\qquad \\frac{d^{3}Y_{M}}{dx^{3}} = -m^{3}\\cos(m x), \\qquad \\frac{d^{4}Y_{M}}{dx^{4}} = m^{4}\\sin(m x).$$\nInsert these into the truncation error expansion:\n\\begin{align*}\nT_{h}(x_{i}) \\;&=\\; \\mathrm{Pe}\\left[\\frac{1}{2}m^{2}\\sin(m x_{i})\\,\\Delta x \\;-\\; \\frac{1}{6}m^{3}\\cos(m x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3})\\right] \\;-\\; \\left[\\frac{1}{12}m^{4}\\sin(m x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{4})\\right] \\\\\n&=\\; \\left(\\frac{1}{2}\\mathrm{Pe}\\,m^{2}\\sin(m x_{i})\\right)\\Delta x \\;+\\; \\left[-\\frac{1}{6}\\mathrm{Pe}\\,m^{3}\\cos(m x_{i}) \\;-\\; \\frac{1}{12}m^{4}\\sin(m x_{i})\\right]\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3}).\n\\end{align*}\nTherefore, the leading-order local truncation error function is\n$$T_{h}^{\\text{lead}}(x) \\;=\\; \\frac{1}{2}\\,\\mathrm{Pe}\\,m^{2}\\,\\sin(m x)\\,\\Delta x.$$\n\nTo predict the observed order of convergence in the maximum norm $L_{\\infty}$ for the solution error under mesh refinement, we appeal to the standard consistency–stability paradigm for linear steady operators. The discrete operator is consistent with the continuous operator, and its leading truncation error is $\\mathcal{O}(\\Delta x)$ due to the first-order upwind discretization of the convective term. For a stable solver of the steady linear problem, the solution error $\\|Y_{h} - Y_{M}\\|_{\\infty}$ reflects the order of the truncation error, yielding an observed convergence rate $p = 1$ in the $L_{\\infty}$ norm as $\\Delta x \\to 0$. The second-order diffusive contribution to the truncation error, proportional to $\\Delta x^{2}$, is asymptotically subdominant.\n\nThus, the requested pair consists of the leading-order truncation error function $T_{h}^{\\text{lead}}(x)$ and the predicted observed convergence rate $p = 1$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\tfrac{1}{2}\\,\\mathrm{Pe}\\,m^{2}\\,\\sin(m x)\\,\\Delta x & 1\\end{pmatrix}}$$"
        }
    ]
}