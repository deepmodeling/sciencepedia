{
    "hands_on_practices": [
        {
            "introduction": "在可压缩燃烧的模拟中，求解器更新的是守恒变量，例如总能量密度 $E$。然而，化学反应等物理过程却依赖于原始变量，如温度 $T$。本练习将指导你完成“封闭”方程组的关键一步：对于量热非完全气体混合物，推导从能量反解温度所需的热力学关系，这是构建任何高保真度燃烧求解器的一项基本技能。",
            "id": "4077046",
            "problem": "考虑一个使用加权基本不振荡（WENO）有限体积格式进行时间推进的一维可压缩反应流。其守恒更新需要一个与热不完全理想气体混合物相符的热力学封闭。该混合物由氮气和氧气两种组分组成，其质量分数分别为 $Y_{\\mathrm{N_2}} = 0.76$ 和 $Y_{\\mathrm{O_2}} = 0.24$。这些组分被建模为理想气体，其定压比热与温度相关，形式为 $c_{p,k}(T) = a_k + b_k T$，其中 $k \\in \\{\\mathrm{N_2}, \\mathrm{O_2}\\}$。参考温度为 $T_{\\mathrm{ref}} = 298 \\ \\mathrm{K}$，在 $T_{\\mathrm{ref}}$ 下的标准生成焓取为 $h_{f,\\mathrm{N_2}}(T_{\\mathrm{ref}}) = 0$ 和 $h_{f,\\mathrm{O_2}}(T_{\\mathrm{ref}}) = 0$。组分性质如下：\n- $a_{\\mathrm{N_2}} = 1000 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$, $b_{\\mathrm{N_2}} = 0.10 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-2}$,\n- $a_{\\mathrm{O_2}} = 900 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$, $b_{\\mathrm{O_2}} = 0.15 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-2}$,\n- $M_{\\mathrm{N_2}} = 0.0280134 \\ \\mathrm{kg} \\ \\mathrm{mol}^{-1}$, $M_{\\mathrm{O_2}} = 0.031998 \\ \\mathrm{kg} \\ \\mathrm{mol}^{-1}$,\n- $R_u = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$.\n\n测得混合物总比焓为 $h = 1.200 \\times 10^{6} \\ \\mathrm{J} \\ \\mathrm{kg}^{-1}$，混合物质量密度为 $\\rho = 0.50 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$。\n\n从适用于理想气体燃烧建模的组分层面热力学定义和混合法则出发，完成以下任务：\n1. 对于热不完全理想气体混合物，根据温度 $T$、组分质量分数 $Y_k$、组分函数 $c_{p,k}(T)$、参考温度 $T_{\\mathrm{ref}}$ 和生成焓 $h_{f,k}(T_{\\mathrm{ref}})$，推导混合物比焓 $h(T, Y_k)$ 的通用关系式。您的推导必须从组分焓定义和混合平均出发。\n2. 将您的结果应用于给定的线性 $c_{p,k}(T)$ 模型，并推导出混合物温度 $T$ 关于 $h$、$Y_k$、$a_k$、$b_k$ 和 $T_{\\mathrm{ref}}$ 的显式闭式表达式。\n3. 从组分性质出发，推导混合物的状态方程 (EOS) $p = \\rho R_{\\mathrm{mix}}(T) T$，其中 $R_{\\mathrm{mix}}(T) = \\sum_{k} Y_k R_k$ 且 $R_k = R_u / M_k$，并对给定混合物数值计算 $R_{\\mathrm{mix}}$。使用此 $R_{\\mathrm{mix}}$ 计算混合物压力 $p$。\n\n最终温度以 $\\mathrm{K}$ 为单位， $R_{\\mathrm{mix}}$ 以 $\\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$ 为单位， $p$ 以 $\\mathrm{Pa}$ 为单位表示。将您的数值答案四舍五入至四位有效数字。将最终结果按混合物温度 $T$、混合气体常数 $R_{\\mathrm{mix}}$ 和压力 $p$ 的顺序列于一个单行矩阵中报告。",
            "solution": "用户在热力学和计算燃烧学领域提供了一个适定且有科学依据的问题。该问题经验证有效，因为它包含一套完整且一致的给定条件，基于已建立的物理化学原理，并且其结构能够得出一个唯一且有意义的解。我们按要求分三部分进行求解。\n\n### 第一部分：混合物比焓的通用关系式\n\n单一组分 $k$ 在温度 $T$ 下的绝对比焓是相对于其在参考温度 $T_{\\mathrm{ref}}$ 下的标准态定义的。它是在 $T_{\\mathrm{ref}}$ 下的标准生成焓 $h_{f,k}(T_{\\mathrm{ref}})$ 与从 $T_{\\mathrm{ref}}$ 到 $T$ 的显焓变化之和。显焓通过对组分定压比热 $c_{p,k}(T)$ 在该温度范围内积分计算得出。\n组分 $k$ 的比焓定义为：\n$$\nh_k(T) = h_{f,k}(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(T') \\, dT'\n$$\n对于理想气体混合物，混合物的总比焓 $h$ 是单个组分比焓的质量加权平均值。权重因子是组分质量分数 $Y_k$。\n$$\nh(T, \\{Y_k\\}) = \\sum_{k=1}^{N_s} Y_k h_k(T)\n$$\n其中 $N_s$ 是混合物中的组分数量。\n\n结合这两个定义，我们得到混合物比焓作为温度和组分质量分数函数的通用关系式：\n$$\nh(T, \\{Y_k\\}) = \\sum_{k=1}^{N_s} Y_k \\left[ h_{f,k}(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(T') \\, dT' \\right]\n$$\n此表达式可以通过分离生成焓和显焓的贡献来重新排列：\n$$\nh(T, \\{Y_k\\}) = \\sum_{k=1}^{N_s} Y_k h_{f,k}(T_{\\mathrm{ref}}) + \\sum_{k=1}^{N_s} Y_k \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(T') \\, dT'\n$$\n这就是混合物比焓的通用关系式。\n\n### 第二部分：温度 $T$ 的表达式\n\n给定一个热不完全模型，其中组分比热是温度的线性函数：\n$$\nc_{p,k}(T) = a_k + b_k T\n$$\n我们还已知两种组分的标准生成焓均为零，$h_{f,\\mathrm{N_2}}(T_{\\mathrm{ref}}) = 0$ 和 $h_{f,\\mathrm{O_2}}(T_{\\mathrm{ref}}) = 0$。因此，通用焓关系式中的第一项为零：$\\sum_k Y_k h_{f,k}(T_{\\mathrm{ref}}) = 0$。\n\n首先，我们计算组分 $k$ 的显焓积分：\n$$\n\\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(T') \\, dT' = \\int_{T_{\\mathrm{ref}}}^{T} (a_k + b_k T') \\, dT' = \\left[ a_k T' + \\frac{1}{2} b_k (T')^2 \\right]_{T_{\\mathrm{ref}}}^{T}\n$$\n$$\n= (a_k T + \\frac{1}{2} b_k T^2) - (a_k T_{\\mathrm{ref}} + \\frac{1}{2} b_k T_{\\mathrm{ref}}^2) = a_k(T - T_{\\mathrm{ref}}) + \\frac{1}{2} b_k (T^2 - T_{\\mathrm{ref}}^2)\n$$\n将此结果代入混合物焓方程（生成焓为零）：\n$$\nh = \\sum_k Y_k \\left[ a_k(T - T_{\\mathrm{ref}}) + \\frac{1}{2} b_k (T^2 - T_{\\mathrm{ref}}^2) \\right]\n$$\n我们可以定义混合平均比热系数：\n$$\nA = \\sum_k Y_k a_k\n$$\n$$\nB = \\sum_k Y_k b_k\n$$\n混合物的定压比热则为 $c_p(T) = A + BT$。将这些定义代入焓方程：\n$$\nh = \\sum_k Y_k a_k (T - T_{\\mathrm{ref}}) + \\sum_k Y_k \\frac{1}{2} b_k (T^2 - T_{\\mathrm{ref}}^2)\n$$\n$$\nh = A(T - T_{\\mathrm{ref}}) + \\frac{1}{2} B(T^2 - T_{\\mathrm{ref}}^2)\n$$\n为了找到 $T$ 的显式表达式，我们将此方程重新排列成标准二次型 $c_2 T^2 + c_1 T + c_0 = 0$：\n$$\nh = AT - A T_{\\mathrm{ref}} + \\frac{1}{2} B T^2 - \\frac{1}{2} B T_{\\mathrm{ref}}^2\n$$\n$$\n\\left(\\frac{1}{2} B\\right) T^2 + (A) T + \\left(-h - A T_{\\mathrm{ref}} - \\frac{1}{2} B T_{\\mathrm{ref}}^2\\right) = 0\n$$\n应用二次方程求根公式 $T = \\frac{-c_1 \\pm \\sqrt{c_1^2 - 4 c_2 c_0}}{2 c_2}$，我们得到：\n$$\nT = \\frac{-A \\pm \\sqrt{A^2 - 4(\\frac{1}{2} B)(-h - A T_{\\mathrm{ref}} - \\frac{1}{2} B T_{\\mathrm{ref}}^2)}}{2(\\frac{1}{2} B)}\n$$\n$$\nT = \\frac{-A \\pm \\sqrt{A^2 + 2B(h + A T_{\\mathrm{ref}} + \\frac{1}{2} B T_{\\mathrm{ref}}^2)}}{B}\n$$\n$$\nT = \\frac{-A \\pm \\sqrt{A^2 + 2Bh + 2AB T_{\\mathrm{ref}} + B^2 T_{\\mathrm{ref}}^2}}{B}\n$$\n平方根下的项可以被识别为 $(A^2 + 2ABT_{\\mathrm{ref}} + B^2 T_{\\mathrm{ref}}^2) + 2Bh = (A + B T_{\\mathrm{ref}})^2 + 2Bh$。因此，$T$ 的表达式为：\n$$\nT = \\frac{-A \\pm \\sqrt{(A + B T_{\\mathrm{ref}})^2 + 2Bh}}{B}\n$$\n由于温度必须是正的物理量，并且对于正的 $c_p$，焓是温度的单调递增函数，我们必须选择能够产生物理上现实的温度的根。对于给定的正系数 $a_k$ 和 $b_k$， $A$ 和 $B$ 都是正数。平方根下的项是正数。由于平方根项将大于 $A$，我们必须选择正号以确保 $T > 0$。\n$$\nT = \\frac{-A + \\sqrt{(A + B T_{\\mathrm{ref}})^2 + 2Bh}}{B}\n$$\n这就是所求的混合物温度的闭式表达式。\n\n### 第三部分：状态方程和压力计算\n\n对于理想气体混合物，状态方程由道尔顿分压定律（Dalton's Law）给出。总压力 $p$ 是分压 $p_k$ 的总和，其中 $p_k = \\rho_k R_k T$。这里，$\\rho_k = \\rho Y_k$ 是组分 $k$ 的分密度， $R_k = R_u / M_k$ 是组分 $k$ 的比气体常数。\n$$\np = \\sum_k p_k = \\sum_k \\rho_k R_k T = T \\sum_k (\\rho Y_k) R_k = \\rho T \\sum_k Y_k R_k\n$$\n将混合气体常数 $R_{\\mathrm{mix}}$ 定义为组分气体常数的质量加权平均值：\n$$\nR_{\\mathrm{mix}} = \\sum_k Y_k R_k = \\sum_k Y_k \\frac{R_u}{M_k}\n$$\n混合物状态方程则为：\n$$\np = \\rho R_{\\mathrm{mix}} T\n$$\n我们现在进行数值评估。\n**给定数据：**\n$Y_{\\mathrm{N_2}} = 0.76$, $Y_{\\mathrm{O_2}} = 0.24$\n$a_{\\mathrm{N_2}} = 1000 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$, $b_{\\mathrm{N_2}} = 0.10 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-2}$\n$a_{\\mathrm{O_2}} = 900 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$, $b_{\\mathrm{O_2}} = 0.15 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-2}$\n$M_{\\mathrm{N_2}} = 0.0280134 \\ \\mathrm{kg} \\ \\mathrm{mol}^{-1}$, $M_{\\mathrm{O_2}} = 0.031998 \\ \\mathrm{kg} \\ \\mathrm{mol}^{-1}$\n$R_u = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$\n$T_{\\mathrm{ref}} = 298 \\ \\mathrm{K}$, $h = 1.200 \\times 10^{6} \\ \\mathrm{J} \\ \\mathrm{kg}^{-1}$, $\\rho = 0.50 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$。\n\n**计算混合物系数 $A$ 和 $B$：**\n$A = Y_{\\mathrm{N_2}} a_{\\mathrm{N_2}} + Y_{\\mathrm{O_2}} a_{\\mathrm{O_2}} = (0.76)(1000) + (0.24)(900) = 760 + 216 = 976 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$\n$B = Y_{\\mathrm{N_2}} b_{\\mathrm{N_2}} + Y_{\\mathrm{O_2}} b_{\\mathrm{O_2}} = (0.76)(0.10) + (0.24)(0.15) = 0.076 + 0.036 = 0.112 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-2}$\n\n**计算温度 $T$：**\n我们使用推导出的 $T$ 的公式：\n$T = \\frac{-976 + \\sqrt{(976 + (0.112)(298))^2 + 2(0.112)(1.200 \\times 10^{6})}}{0.112}$\n$T = \\frac{-976 + \\sqrt{(976 + 33.376)^2 + 268800}}{0.112}$\n$T = \\frac{-976 + \\sqrt{(1009.376)^2 + 268800}}{0.112}$\n$T = \\frac{-976 + \\sqrt{1018840.0156 + 268800}}{0.112}$\n$T = \\frac{-976 + \\sqrt{1287640.0156}}{0.112} = \\frac{-976 + 1134.74227}{0.112} = \\frac{158.74227}{0.112} = 1417.3417 \\ \\mathrm{K}$\n四舍五入至四位有效数字，$T = 1417 \\ \\mathrm{K}$。\n\n**计算混合气体常数 $R_{\\mathrm{mix}}$：**\n首先，计算组分气体常数：\n$R_{\\mathrm{N_2}} = \\frac{R_u}{M_{\\mathrm{N_2}}} = \\frac{8.314462618}{0.0280134} \\approx 296.793 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$\n$R_{\\mathrm{O_2}} = \\frac{R_u}{M_{\\mathrm{O_2}}} = \\frac{8.314462618}{0.031998} \\approx 259.842 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$\n现在计算混合气体常数：\n$R_{\\mathrm{mix}} = Y_{\\mathrm{N_2}} R_{\\mathrm{N_2}} + Y_{\\mathrm{O_2}} R_{\\mathrm{O_2}} = (0.76)(296.793) + (0.24)(259.842) = 225.563 + 62.362 = 287.925 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$\n四舍五入至四位有效数字，$R_{\\mathrm{mix}} = 287.9 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$。\n\n**计算压力 $p$：**\n使用混合物状态方程 $p = \\rho R_{\\mathrm{mix}} T$ 及未四舍五入的中间值以获得更高精度：\n$p = (0.50 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3})(287.925 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1})(1417.3417 \\ \\mathrm{K}) = 204001.9 \\ \\mathrm{Pa}$\n四舍五入至四位有效数字，$p = 204000 \\ \\mathrm{Pa}$，或 $2.040 \\times 10^{5} \\ \\mathrm{Pa}$。\n\n最终结果为混合物温度 $T$、混合气体常数 $R_{\\mathrm{mix}}$ 和压力 $p$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1417 & 287.9 & 2.040 \\times 10^5 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "对于像欧拉方程这样的方程组，WENO 格式的精度取决于一个关键的实现选择：对哪一套变量进行重构。由于原始变量（例如 $\\rho, u, p$）与守恒变量（例如 $\\rho, \\rho u, E$）之间的变换是非线性的，因此重构不同的变量集会产生不同的精度。本编程练习让你能够直接研究并量化这种差异，为优化你的求解器以处理光滑的反应流提供关键的洞察。",
            "id": "4077033",
            "problem": "考虑在周期性域 $x \\in [0,1]$ 上，一种反应性可压缩混合物的一维光滑场。设原始变量为密度 $\\rho(x)$（单位：千克/立方米，kg/m$^3$）、速度 $u(x)$（单位：米/秒，m/s）、压力 $p(x)$（单位：帕斯卡，Pa）以及代表反应进程的光滑进程变量 $c(x)$（无量纲）。该混合物具有空间变化的特定热比 $\\gamma(x) = \\gamma_0 - \\Delta\\gamma\\,c(x)$ 和均匀的单位质量热释放 $q$（单位：焦耳/千克，J/kg）。状态方程由比内能\n$$ e(x) = \\frac{p(x)}{(\\gamma(x)-1)\\,\\rho(x)} + q\\,c(x), $$\n和总能量密度\n$$ E(x) = \\rho(x)\\,e(x) + \\tfrac{1}{2}\\,\\rho(x)\\,u(x)^2 = \\frac{p(x)}{\\gamma(x)-1} + \\rho(x)\\,q\\,c(x) + \\tfrac{1}{2}\\,\\rho(x)\\,u(x)^2. $$\n定义守恒变量为 $U(x) = [\\rho(x),\\;\\rho(x)u(x),\\;E(x)]$。\n\n您将分析在具有可变 $\\gamma$ 和热释放 $q$ 的光滑测试用例中，对两种不同的变量集执行加权基本无振荡 (WENO) 重构所产生的重构误差：\n- 方法P：重构原始变量 $[\\rho, u, p, c]$ 以获得界面值，然后通过界面处的上述热力学关系将其映射到守恒变量 $[\\rho,\\rho u, E]$。\n- 方法C：直接重构守恒变量 $[\\rho,\\rho u, E]$ 以获得界面守恒值。\n\n使用具有 $N$ 个均匀网格单元和周期性边界条件的有限体积离散化方法。对于每个网格单元，通过对精确场在该单元上进行数值积分，计算原始变量和守恒变量的单元平均值。实现一个五阶有限体积WENO-JS (Jiang–Shu) 重构方法，该方法根据单元平均值在每个单元面 $x_{i+\\frac{1}{2}}$ 处生成左偏界面值。不要假设从原始变量到守恒变量的映射存在任何线性化；在方法P中，于界面处逐点应用非线性映射。对于方法C，独立重构每个守恒分量。\n\n所有测试用例均采用以下光滑精确场：\n- $\\rho(x) = 1 + 0.2\\,\\cos(2\\pi x)$（单位：kg/m$^3$），\n- $u(x) = 50 + 10\\,\\sin(2\\pi x + 0.1)$（单位：m/s），\n- $p(x) = 10^5 + 5\\times 10^3\\,\\cos(2\\pi x + 0.3)$（单位：Pa），\n- $c(x) = 0.5 + 0.1\\,\\sin(2\\pi x - 0.2)$（无量纲），\n- $\\gamma(x) = \\gamma_0 - \\Delta\\gamma\\,c(x)$（无量纲），并且处处满足 $\\gamma(x) > 1$。\n\n对于每个面 $x_{i+\\frac{1}{2}}$，通过在 $x_{i+\\frac{1}{2}}$ 处计算精确原始场并应用状态方程，来计算精确的守恒变量 $U^{\\mathrm{exact}}(x_{i+\\frac{1}{2}})$。使用方法P计算重构的界面守恒变量 $U^{\\mathrm{P}}(x_{i+\\frac{1}{2}})$，并使用方法C计算 $U^{\\mathrm{C}}(x_{i+\\frac{1}{2}})$。通过在所有界面和分量上的聚合相对 $L^2$ 误差来量化每种方法的重构误差：\n$$ \\varepsilon_{\\mathrm{P}} = \\frac{\\left(\\sum\\limits_{i} \\sum\\limits_{k=1}^{3} \\left(U^{\\mathrm{P}}_k(x_{i+\\frac{1}{2}}) - U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}{\\left(\\sum\\limits_{i} \\sum\\limits_{k=1}^{3} \\left(U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}, \\quad\n\\varepsilon_{\\mathrm{C}} = \\frac{\\left(\\sum\\limits_{i} \\sum\\limits_{k=1}^{3} \\left(U^{\\mathrm{C}}_k(x_{i+\\frac{1}{2}}) - U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}{\\left(\\sum\\limits_{i} \\sum\\limits_{k=1}^{3} \\left(U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}. $$\n对于每个测试用例，将元组 $[\\varepsilon_{\\mathrm{P}},\\;\\varepsilon_{\\mathrm{C}},\\;\\varepsilon_{\\mathrm{P}} - \\varepsilon_{\\mathrm{C}}]$ 报告为三个十进制浮点数。\n\n用于单元平均值的数值积分必须达到与重构阶数一致的精度；每个单元使用至少五个点的高斯求积法。在为WENO模板访问相邻单元时，将域视为周期性的。\n\n测试套件：\n- 用例1（理想路径）：$N=80$，$\\gamma_0=1.4$，$\\Delta\\gamma=0.2$， $q=3\\times 10^4$ J/kg。\n- 用例2（基线）：$N=80$，$\\gamma_0=1.4$，$\\Delta\\gamma=0$， $q=0$ J/kg。\n- 用例3（强变化）：$N=160$，$\\gamma_0=1.3$，$\\Delta\\gamma=0.25$， $q=8\\times 10^4$ J/kg。\n- 用例4（粗网格）：$N=40$，$\\gamma_0=1.4$，$\\Delta\\gamma=0.2$， $q=3\\times 10^4$ J/kg。\n\n所有量都将使用上述指定单位进行计算；最终报告的误差是无量纲的。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个子列表 $[\\varepsilon_{\\mathrm{P}},\\varepsilon_{\\mathrm{C}},\\varepsilon_{\\mathrm{P}} - \\varepsilon_{\\mathrm{C}}]$；例如，一个有效的输出格式是 $[[a,b,c],[d,e,f],[g,h,i],[j,k,l]]$。",
            "solution": "该问题要求对应用于反应性可压缩流模型的有限体积格式的两种方法进行重构误差比较。这两种方法涉及对原始变量（方法P）或守恒变量（方法C）执行五阶加权基本无振荡 (WENO) 重构。该分析是针对一个光滑的一维周期性问题进行的，该问题具有一个指定的状态方程，其中包括可变的比热比 $\\gamma(x)$ 和一个热释放项 $q$。\n\n解决方案通过以下步骤实现：\n1.  定义计算网格和所有流动变量的精确解析解。\n2.  通过在每个网格单元上对精确解进行数值积分，计算所需变量（方法P为原始变量，方法C为守恒变量）的单元平均值。\n3.  实现五阶WENO-JS重构算法，从单元平均值中获取单元界面处的左偏值。\n4.  应用两种方法计算每个单元界面处的守恒状态向量。\n5.  计算每个界面处的精确守恒状态向量以进行比较。\n6.  计算每种方法的聚合相对 $L^2$ 误差以量化其精度。\n7.  对所有指定的测试用例重复此过程。\n\n**1. 网格、精确解和状态变量**\n\n一维周期性域 $x \\in [0,1]$ 被离散化为 $N$ 个均匀网格单元 $C_i = [x_{i-1/2}, x_{i+1/2}]$，其中 $i=0, 1, \\dots, N-1$。单元宽度为 $\\Delta x = 1/N$，单元中心为 $x_i = (i+0.5)\\Delta x$，单元界面位于 $x_{i+1/2} = (i+1)\\Delta x$。\n\n问题为原始变量提供了精确、光滑的解析函数：密度 $\\rho(x)$、速度 $u(x)$、压力 $p(x)$ 和反应进程 $c(x)$。\n比热比 $\\gamma(x)$ 是进程变量的函数：$\\gamma(x) = \\gamma_0 - \\Delta\\gamma\\,c(x)$。\n守恒变量 $U(x) = [\\rho(x), \\rho(x)u(x), E(x)]^T$ 是使用热力学关系定义的。总能量密度 $E(x)$ 由下式给出：\n$$\nE(x) = \\frac{p(x)}{\\gamma(x)-1} + \\rho(x) q c(x) + \\frac{1}{2}\\rho(x) u(x)^2\n$$\n\n**2. 单元平均值的计算**\n\n对于一个通用函数 $f(x)$，其在单元 $C_i$ 上的单元平均值定义为 $\\bar{f}_i = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx$。为达到与五阶重构格式一致的精度，该积分使用5点高斯求积法则进行数值计算。对于每个单元 $C_i$，计算积分值，然后除以单元宽度 $\\Delta x$。此过程用于计算方法P的原始变量单元平均值 $\\{\\bar{\\rho}_i, \\bar{u}_i, \\bar{p}_i, \\bar{c}_i\\}$ 和方法C的守恒变量单元平均值 $\\{\\bar{\\rho}_i, \\overline{\\rho u}_i, \\bar{E}_i\\}$。\n\n**3. 五阶WENO-JS重构**\n\n该数值方法的核心是五阶有限体积WENO-JS格式。从一组给定的单元平均值 $\\bar{v}_i$ 出发，我们在界面 $x_{i+1/2}$ 处重构左偏值 $v_{i+1/2}^L$。该重构使用一个以单元 $i$ 为中心的5单元模板：$\\{C_{i-2}, C_{i-1}, C_{i}, C_{i+1}, C_{i+2}\\}$。由于是周期性域，索引按模 $N$ 处理。\n\nWENO重构是三个三阶重构的非线性组合，每个重构都基于一个3单元子模板。对于界面 $x_{i+1/2}$，候选值为：\n\\begin{align*}\nv_{i+1/2}^{(0)} &= \\frac{1}{3}\\bar{v}_{i-2} - \\frac{7}{6}\\bar{v}_{i-1} + \\frac{11}{6}\\bar{v}_{i} \\\\\nv_{i+1/2}^{(1)} &= -\\frac{1}{6}\\bar{v}_{i-1} + \\frac{5}{6}\\bar{v}_{i} + \\frac{1}{3}\\bar{v}_{i+1} \\\\\nv_{i+1/2}^{(2)} &= \\frac{1}{3}\\bar{v}_{i} + \\frac{5}{6}\\bar{v}_{i+1} - \\frac{1}{6}\\bar{v}_{i+2}\n\\end{align*}\n每个子模板上解的光滑度由光滑度指示子 $IS_k$ 衡量：\n\\begin{align*}\nIS_0 &= \\frac{13}{12}(\\bar{v}_{i-2} - 2\\bar{v}_{i-1} + \\bar{v}_i)^2 + \\frac{1}{4}(\\bar{v}_{i-2} - 4\\bar{v}_{i-1} + 3\\bar{v}_i)^2 \\\\\nIS_1 &= \\frac{13}{12}(\\bar{v}_{i-1} - 2\\bar{v}_i + \\bar{v}_{i+1})^2 + \\frac{1}{4}(\\bar{v}_{i-1} - \\bar{v}_{i+1})^2 \\\\\nIS_2 &= \\frac{13}{12}(\\bar{v}_i - 2\\bar{v}_{i+1} + \\bar{v}_{i+2})^2 + \\frac{1}{4}(3\\bar{v}_i - 4\\bar{v}_{i+1} + \\bar{v}_{i+2})^2\n\\end{align*}\n这些指示子用于计算非线性权重 $\\omega_k$。首先，使用最优线性权重（$d_0=0.1, d_1=0.6, d_2=0.3$）计算未归一化的权重 $\\alpha_k$：\n$$\n\\alpha_k = \\frac{d_k}{(\\varepsilon + IS_k)^2}, \\quad k = 0, 1, 2\n$$\n其中 $\\varepsilon$ 是一个小的正数（例如 $10^{-40}$），以防止在光滑区域出现除以零的情况。最终权重被归一化：$\\omega_k = \\alpha_k / \\sum_{j=0}^{2} \\alpha_j$。重构值是候选值的加权和：\n$$\nv_{i+1/2}^L = \\sum_{k=0}^{2} \\omega_k v_{i+1/2}^{(k)}\n$$\n\n**4. 重构方法学**\n\n- **方法P：** 将WENO-JS重构独立应用于每组原始变量的单元平均值：$\\{\\bar{\\rho}_i\\}, \\{\\bar{u}_i\\}, \\{\\bar{p}_i\\}, \\{\\bar{c}_i\\}$。这会产生界面值 $\\rho^L_{i+1/2}, u^L_{i+1/2}, p^L_{i+1/2}, c^L_{i+1/2}$。然后，通过将非线性状态方程应用于每个界面处的这些重构原始变量值，来计算守恒状态向量 $U^{\\mathrm{P}}(x_{i+1/2})$。\n\n- **方法C：** 将WENO-JS重构独立应用于每组守恒变量的单元平均值：$\\{\\bar{\\rho}_i\\}, \\{\\overline{\\rho u}_i\\}, \\{\\bar{E}_i\\}$。这直接产生守恒变量的界面值，构成状态向量 $U^{\\mathrm{C}}(x_{i+1/2})$。\n\n**5. 误差计算**\n\n对于每种方法，通过将界面处重构的守恒状态向量 $U^{\\mathrm{P}}$ 或 $U^{\\mathrm{C}}$ 与精确状态向量 $U^{\\mathrm{exact}}$ 进行比较来量化重构误差。每个界面 $x_{i+1/2}$ 处的精确向量是通过在 $x_{i+1/2}$ 处计算解析函数 $\\rho(x), u(x), p(x), c(x)$ 并应用状态方程得到的。误差使用聚合相对 $L^2$ 范数来衡量，其定义如下：\n$$\n\\varepsilon = \\frac{\\left( \\sum_{i=0}^{N-1} \\sum_{k=1}^{3} (U_k(x_{i+1/2}) - U^{\\mathrm{exact}}_k(x_{i+1/2}))^2 \\right)^{1/2}}{\\left( \\sum_{i=0}^{N-1} \\sum_{k=1}^{3} (U^{\\mathrm{exact}}_k(x_{i+1/2}))^2 \\right)^{1/2}}\n$$\n该公式用于计算 $\\varepsilon_{\\mathrm{P}}$（方法P）和 $\\varepsilon_{\\mathrm{C}}$（方法C）。也计算差值 $\\varepsilon_{\\mathrm{P}} - \\varepsilon_{\\mathrm{C}}$ 以直接比较这两种方法。对于光滑流，通常预期 $\\varepsilon_{\\mathrm{P}} < \\varepsilon_{\\mathrm{C}}$，因为原始变量通常更光滑，且重构算子与到守恒变量的非线性变换不可交换。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import fixed_quad\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the execution for all test cases.\n    \"\"\"\n\n    def weno5js_recon(v_bar):\n        \"\"\"\n        Performs 5th-order WENO-JS reconstruction for a 1D periodic domain.\n        Computes left-biased values at interfaces v_{i+1/2}^L.\n        This is a vectorized implementation for efficiency.\n        \"\"\"\n        eps = 1e-40\n        d0, d1, d2 = 0.1, 0.6, 0.3\n\n        # Stencil values shifted periodically\n        vm2 = np.roll(v_bar, 2)\n        vm1 = np.roll(v_bar, 1)\n        v0 = v_bar\n        vp1 = np.roll(v_bar, -1)\n        vp2 = np.roll(v_bar, -2)\n\n        # 3rd-order candidate reconstructions at i+1/2\n        v_rec0 = (1/3) * vm2 - (7/6) * vm1 + (11/6) * v0\n        v_rec1 = (-1/6) * vm1 + (5/6) * v0 + (1/3) * vp1\n        v_rec2 = (1/3) * v0 + (5/6) * vp1 - (1/6) * vp2\n\n        # Smoothness indicators\n        is0 = (13/12) * (vm2 - 2*vm1 + v0)**2 + (1/4) * (vm2 - 4*vm1 + 3*v0)**2\n        is1 = (13/12) * (vm1 - 2*v0 + vp1)**2 + (1/4) * (vm1 - vp1)**2\n        is2 = (13/12) * (v0 - 2*vp1 + vp2)**2 + (1/4) * (3*v0 - 4*vp1 + vp2)**2\n        \n        # Nonlinear weights\n        alpha0 = d0 / (eps + is0)**2\n        alpha1 = d1 / (eps + is1)**2\n        alpha2 = d2 / (eps + is2)**2\n        \n        sum_alpha = alpha0 + alpha1 + alpha2\n        \n        w0 = alpha0 / sum_alpha\n        w1 = alpha1 / sum_alpha\n        w2 = alpha2 / sum_alpha\n        \n        # Final reconstructed value\n        v_L = w0 * v_rec0 + w1 * v_rec1 + w2 * v_rec2\n        \n        return v_L\n\n    def compute_cell_avg(func, N):\n        \"\"\"\n        Computes cell averages of a function `func` over N uniform cells in [0,1]\n        using 5-point Gaussian quadrature for integration.\n        \"\"\"\n        dx = 1.0 / N\n        avg = np.zeros(N)\n        for i in range(N):\n            integral_val, _ = fixed_quad(func, i * dx, (i + 1) * dx, n=5)\n            avg[i] = integral_val / dx\n        return avg\n\n    def solve_case(N, gamma0, d_gamma, q):\n        \"\"\"\n        Solves the problem for a single test case.\n        \"\"\"\n        # 1. Setup Grid and Exact Functions\n        dx = 1.0 / N\n        x_interfaces = (np.arange(N) + 1.0) * dx\n        \n        # Exact primitive fields\n        rho_func = lambda x: 1.0 + 0.2 * np.cos(2 * np.pi * x)\n        u_func = lambda x: 50.0 + 10.0 * np.sin(2 * np.pi * x + 0.1)\n        p_func = lambda x: 1e5 + 5e3 * np.cos(2 * np.pi * x + 0.3)\n        c_func = lambda x: 0.5 + 0.1 * np.sin(2 * np.pi * x - 0.2)\n        gamma_func = lambda x: gamma0 - d_gamma * c_func(x)\n\n        # Exact conservative fields\n        rhou_func = lambda x: rho_func(x) * u_func(x)\n        E_func = lambda x: (p_func(x) / (gamma_func(x) - 1.0)\n                            + rho_func(x) * q * c_func(x)\n                            + 0.5 * rho_func(x) * u_func(x)**2)\n        \n        # 2. Compute Exact Interface Values\n        rho_exact_int = rho_func(x_interfaces)\n        u_exact_int = u_func(x_interfaces)\n        p_exact_int = p_func(x_interfaces)\n        c_exact_int = c_func(x_interfaces)\n        gamma_exact_int = gamma_func(x_interfaces)\n\n        U_exact_int = np.zeros((N, 3))\n        U_exact_int[:, 0] = rho_exact_int\n        U_exact_int[:, 1] = rho_exact_int * u_exact_int\n        U_exact_int[:, 2] = (p_exact_int / (gamma_exact_int - 1.0)\n                             + rho_exact_int * q * c_exact_int\n                             + 0.5 * rho_exact_int * u_exact_int**2)\n\n        # 3. Method P: Reconstruct primitives\n        rho_bar = compute_cell_avg(rho_func, N)\n        u_bar = compute_cell_avg(u_func, N)\n        p_bar = compute_cell_avg(p_func, N)\n        c_bar = compute_cell_avg(c_func, N)\n        \n        rho_L_p = weno5js_recon(rho_bar)\n        u_L_p = weno5js_recon(u_bar)\n        p_L_p = weno5js_recon(p_bar)\n        c_L_p = weno5js_recon(c_bar)\n        \n        gamma_L_p = gamma0 - d_gamma * c_L_p\n        \n        U_P_recon = np.zeros((N, 3))\n        U_P_recon[:, 0] = rho_L_p\n        U_P_recon[:, 1] = rho_L_p * u_L_p\n        U_P_recon[:, 2] = (p_L_p / (gamma_L_p - 1.0)\n                           + rho_L_p * q * c_L_p\n                           + 0.5 * rho_L_p * u_L_p**2)\n\n        # 4. Method C: Reconstruct conservatives\n        rhou_bar = compute_cell_avg(rhou_func, N)\n        E_bar = compute_cell_avg(E_func, N)\n        \n        U_C_recon = np.zeros((N, 3))\n        U_C_recon[:, 0] = weno5js_recon(rho_bar) # rho_bar is already computed\n        U_C_recon[:, 1] = weno5js_recon(rhou_bar)\n        U_C_recon[:, 2] = weno5js_recon(E_bar)\n        \n        # 5. Compute Errors\n        norm_exact_sq = np.sum(U_exact_int**2)\n        \n        err_P_sq = np.sum((U_P_recon - U_exact_int)**2)\n        eps_P = np.sqrt(err_P_sq / norm_exact_sq)\n        \n        err_C_sq = np.sum((U_C_recon - U_exact_int)**2)\n        eps_C = np.sqrt(err_C_sq / norm_exact_sq)\n\n        return [eps_P, eps_C, eps_P - eps_C]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, gamma0, d_gamma, q)\n        (80, 1.4, 0.2, 3e4),    # Case 1\n        (80, 1.4, 0.0, 0.0),    # Case 2\n        (160, 1.3, 0.25, 8e4),  # Case 3\n        (40, 1.4, 0.2, 3e4),     # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        N, gamma0, d_gamma, q = case\n        result = solve_case(N, gamma0, d_gamma, q)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "验证一个复杂的模拟程序是否正确是计算科学中的一个首要挑战。对于反应流这类通常不存在完整解析解的问题，我们依赖于半解析基准（semi-analytic benchmarks）。本练习将指导你为经典的反应 Sod 激波管问题构建这样一个基准，计算出诸如激波速度和激波后温度等关键特征，以便你的 WENO 求解器的输出结果可以与这些基准值进行对比。",
            "id": "4077048",
            "problem": "要求您为用于评估可压缩燃烧中加权基本无振荡（WENO）格式精度的一维反应黎曼问题（一个反应性Sod激波管）建立半解析验证特征的形式化表述。考虑具有单步化学反应和理想气体状态方程的量热完全气体的无粘反应欧拉方程。设左侧状态为 $(\\rho_L, u_L, p_L)$，右侧状态为 $(\\rho_R, u_R, p_R)$，比热比为 $\\gamma$，特定气体常数为 $R$（单位为 $\\mathrm{J}\\, \\mathrm{kg}^{-1}\\, \\mathrm{K}^{-1}$）。化学反应为一个单步不可逆反应，当反应进度变量从0变为1时，释放比热 $Q$（单位为 $\\mathrm{J}\\, \\mathrm{kg}^{-1}$）。其诱导期的阿伦尼乌斯速率为 $A \\exp(-E_{\\mathrm{a}}/(R_{\\mathrm{u}} T))$，其中 $A$ 的单位为 $\\mathrm{s}^{-1}$，$E_{\\mathrm{a}}$ 的单位为 $\\mathrm{J}\\, \\mathrm{mol}^{-1}$，$R_{\\mathrm{u}}$ 是普适气体常数（单位为 $\\mathrm{J}\\, \\mathrm{mol}^{-1}\\, \\mathrm{K}^{-1}$）。假设激波层是化学冻结的（穿过激波的反应可以忽略不计），并且激波后的热量释放在一段诱导延迟后准等压地发生。\n\n您的程序必须为每个测试用例计算以下用于验证加权基本无振荡（WENO）格式精度的半解析量：\n\n1. 激波速度 $S$（单位 $\\mathrm{m/s}$），定义为在经典Sod结构中出现的右行激波的速度。如果没有形成激波（退化的等状态边界情况），则设 $S = 0$。\n\n2. 紧邻右行激波后的即时波后（化学冻结）温度 $T_{\\mathrm{ps}}$（单位 $\\mathrm{K}$）。\n\n3. 在时间 $t$ 时的波后温度，记为 $T_{\\mathrm{react}}(t)$（单位 $\\mathrm{K}$），使用一个简单的诱导控制阶跃模型计算：\n   - 计算诱导时间 $\\tau_{\\mathrm{ind}} = \\left(A \\exp\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}} T_{\\mathrm{ps}}}\\right)\\right)^{-1}$（单位 $\\mathrm{s}$）。\n   - 如果 $t  \\tau_{\\mathrm{ind}}$，则设 $T_{\\mathrm{react}}(t) = T_{\\mathrm{ps}}$。\n   - 如果 $t \\ge \\tau_{\\mathrm{ind}}$，则设 $T_{\\mathrm{react}}(t) = T_{\\mathrm{ps}} + \\frac{Q}{c_p}$，其中 $c_p = \\frac{\\gamma R}{\\gamma - 1}$ 是定压比热（单位 $\\mathrm{J}\\, \\mathrm{kg}^{-1}\\, \\mathrm{K}^{-1}$）。\n\n4. 在时间 $t$ 时的激波位置 $x_s(t) = S t$（单位 $\\mathrm{m}$），假设激波在 $t = 0$ 时从 $x = 0$ 开始。\n\n半解析评估的基本依据和定义：\n\n- 带有理想气体假设以及在能量和组分/进度方程中包含源项的质量、动量和能量的无粘欧拉方程定义了反应流，但在穿过激波时化学反应是冻结的。理想气体状态方程为 $p = \\rho R T$。\n\n- 使用精确的非反应黎曼问题结构来确定星区中的压力 $p^\\star$ 和速度 $u^\\star$：左行波是稀疏波或激波，右行波是激波或稀疏波。对于 $p_L \\gg p_R$ 且 $u_L = u_R$ 的经典Sod结构，右行波是激波。精确解满足\n  $$ f_L(p^\\star) + f_R(p^\\star) + u_R - u_L = 0, $$\n  其中，对于每一侧 $k \\in \\{L,R\\}$,\n  - 在激波条件下，Rankine–Hugoniot 函数为\n    $$ f_k(p) = (p - p_k) \\sqrt{ \\frac{A_k}{p + B_k} }, \\quad A_k = \\frac{2}{(\\gamma + 1)\\rho_k}, \\quad B_k = \\frac{(\\gamma - 1)}{\\gamma + 1} p_k. $$\n  - 在稀疏波条件下，等熵波函数为\n    $$ f_k(p) = \\frac{2 c_k}{\\gamma - 1} \\left[ \\left( \\frac{p}{p_k} \\right)^{\\frac{\\gamma - 1}{2\\gamma}} - 1 \\right], \\quad c_k = \\sqrt{\\frac{\\gamma p_k}{\\rho_k}}. $$\n  那么星区速度为\n  $$ u^\\star = \\frac{1}{2} \\left( u_L + u_R + f_R(p^\\star) - f_L(p^\\star) \\right). $$\n\n- 对于右行激波，将其视为一个正激波，其上游状态为 $(\\rho_R, u_R, p_R)$，下游压力为 $p_2 = p^\\star$。令 $c_R = \\sqrt{\\gamma p_R/\\rho_R}$，并定义相对于激波的上游马赫数为\n  $$ M_1 = \\sqrt{ \\left( \\frac{p^\\star}{p_R} - 1 \\right) \\frac{\\gamma + 1}{2\\gamma} + 1 }.$$\n  那么在实验室坐标系中的激波速度为\n  $$ S = u_R + M_1 c_R.$$\n  激波后紧邻的下游密度由正激波关系式给出\n  $$ \\frac{\\rho_2}{\\rho_R} = \\frac{(\\gamma + 1) M_1^2}{(\\gamma - 1) M_1^2 + 2}, $$\n  由此，即时波后温度为\n  $$ T_{\\mathrm{ps}} = \\frac{p^\\star}{\\rho_2 R}.$$\n\n您必须实现上述步骤，为每个测试用例计算 $S$、$T_{\\mathrm{ps}}$、$T_{\\mathrm{react}}(t)$ 和 $x_s(t)$。以国际单位制（SI）作答。不使用角度。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例贡献一个包含四个浮点数的列表，顺序为 $[S, T_{\\mathrm{ps}}, T_{\\mathrm{react}}(t), x_s(t)]$。例如，包含两个测试用例的输出将如下所示\n$$ [ [s_1, T_{\\mathrm{ps},1}, T_{\\mathrm{react},1}, x_{s,1}], [s_2, T_{\\mathrm{ps},2}, T_{\\mathrm{react},2}, x_{s,2}] ]. $$\n\n使用以下测试套件，并视所有常数为国际单位制（SI）单位：\n\n- 测试用例1（非反应性顺利路径）：\n  - 左侧状态：$\\rho_L = 1.0$, $u_L = 0.0$, $p_L = 101325.0$。\n  - 右侧状态：$\\rho_R = 0.125$, $u_R = 0.0$, $p_R = 10000.0$。\n  - 气体：$\\gamma = 1.4$, $R = 287.0$。\n  - 化学：$Q = 0.0$, $A = 10^6$, $E_{\\mathrm{a}} = 1.5 \\times 10^5$, $R_{\\mathrm{u}} = 8.314$。\n  - 时间：$t = 1.0 \\times 10^{-3}$。\n\n- 测试用例2（慢化学反应，时间窗口内无燃烧）：\n  - 左侧状态：$\\rho_L = 1.0$, $u_L = 0.0$, $p_L = 101325.0$。\n  - 右侧状态：$\\rho_R = 0.125$, $u_R = 0.0$, $p_R = 10000.0$。\n  - 气体：$\\gamma = 1.4$, $R = 287.0$。\n  - 化学：$Q = 2.0 \\times 10^6$, $A = 10^3$, $E_{\\mathrm{a}} = 1.5 \\times 10^5$, $R_{\\mathrm{u}} = 8.314$。\n  - 时间：$t = 5.0 \\times 10^{-5}$。\n\n- 测试用例3（快化学反应，发生燃烧）：\n  - 左侧状态：$\\rho_L = 1.0$, $u_L = 0.0$, $p_L = 101325.0$。\n  - 右侧状态：$\\rho_R = 0.125$, $u_R = 0.0$, $p_R = 10000.0$。\n  - 气体：$\\gamma = 1.4$, $R = 287.0$。\n  - 化学：$Q = 2.0 \\times 10^6$, $A = 10^6$, $E_{\\mathrm{a}} = 8.0 \\times 10^4$, $R_{\\mathrm{u}} = 8.314$。\n  - 时间：$t = 1.0 \\times 10^{-3}$。\n\n- 测试用例4（退化的等状态边界情况，无激波形成）：\n  - 左侧状态：$\\rho_L = 1.0$, $u_L = 0.0$, $p_L = 101325.0$。\n  - 右侧状态：$\\rho_R = 1.0$, $u_R = 0.0$, $p_R = 101325.0$。\n  - 气体：$\\gamma = 1.4$, $R = 287.0$。\n  - 化学：$Q = 1.0 \\times 10^6$, $A = 10^6$, $E_{\\mathrm{a}} = 8.0 \\times 10^4$, $R_{\\mathrm{u}} = 8.314$。\n  - 时间：$t = 1.0 \\times 10^{-3}$。\n\n您的程序应生成单行输出，其中包含一个列表，该列表包含四个测试用例的四元素列表，顺序为 $[S, T_{\\mathrm{ps}}, T_{\\mathrm{react}}(t), x_s(t)]$，格式化为Python列表字面量，不带任何额外文本。",
            "solution": "该问题被认为是有效的，因为它在可压缩流体动力学和化学动力学原理上具有科学依据，是适定的，并为其求解提供了一套完整且一致的数据和方程。任务是为一个一维反应黎曼问题计算半解析验证特征，这是一维反应黎曼问题是计算燃烧学中的一个标准测试用例。\n\n求解过程首先确定从初始间断产生的左行波和右行波之间的“星区”状态。这通过求解精确的非反应黎曼问题来实现。一旦知道了星区状态的压力和速度，便使用Rankine-Hugoniot关系式计算右行激波的性质。最后，应用一个简化的波后化学反应模型来确定温度的演化。\n\n每个测试用例的总体步骤如下：\n\n首先，我们必须确定波间均匀区域的压力 $p^\\star$ 和速度 $u^\\star$。这可以通过求解非线性代数方程找到：\n$$\nF(p) = f_L(p) + f_R(p) + u_R - u_L = 0\n$$\n对于 $k \\in \\{L, R\\}$，函数 $f_k(p)$ 取决于进入区域 $k$ 的波是激波还是稀疏波。对于给定的测试用例（退化情况除外），我们有 $p_L > p_R$。这个压力比决定了左行波是稀疏波，而右行波是激波。这是经典Sod激波管问题的特征。因此，我们必须对左侧使用稀疏波函数，对右侧使用激波函数。\n\n左侧状态（$p  p_L$）的稀疏波函数是：\n$$\nf_L(p) = \\frac{2 c_L}{\\gamma - 1} \\left[ \\left( \\frac{p}{p_L} \\right)^{\\frac{\\gamma - 1}{2\\gamma}} - 1 \\right]\n$$\n其中 $c_L = \\sqrt{\\gamma p_L / \\rho_L}$ 是左侧的初始声速。\n\n右侧状态（$p > p_R$）的激波函数是：\n$$\nf_R(p) = (p - p_R) \\sqrt{ \\frac{A_R}{p + B_R} }\n$$\n其中 $A_R = \\frac{2}{(\\gamma + 1)\\rho_R}$ 且 $B_R = \\frac{(\\gamma - 1)}{\\gamma + 1} p_R$。\n\n必须对星区压力 $p^\\star$ 数值求解方程 $F(p^\\star)=0$。诸如二分法或割线法之类的求根算法是合适的。解 $p^\\star$ 保证存在且唯一，并介于 $p_R$ 和 $p_L$ 之间。\n\n对于左右状态相同的退化情况（$\\rho_L=\\rho_R, u_L=u_R, p_L=p_R$），不会产生波。流场保持静止。在这种情况下，$p^\\star=p_L=p_R$ 且 $u^\\star = u_L = u_R$。根据问题陈述，激波速度 $S$ 被设为0。\n\n一旦确定了 $p^\\star$，我们计算所需的量：\n\n1.  **激波速度 $S$**：对于非退化情况，确定右行激波的性质。未扰动的右侧状态中的声速为 $c_R = \\sqrt{\\gamma p_R / \\rho_R}$。流入激波的流体马赫数（在激波参考系中）由正激波压力比关系式给出：\n    $$\n    M_1 = \\sqrt{ \\left( \\frac{p^\\star}{p_R} - 1 \\right) \\frac{\\gamma + 1}{2\\gamma} + 1 }\n    $$\n    在实验室坐标系中，激波速度 $S$ 是其前方流体速度（$u_R$）与激波相对于该流体的传播速度（$M_1 c_R$）之和：\n    $$\n    S = u_R + M_1 c_R\n    $$\n    对于退化情况，$S=0$。\n\n2.  **即时波后温度 $T_{\\mathrm{ps}}$**：假设化学反应在穿过激波时是“冻结”的，这意味着跳跃条件仅由流体动力学控制。波后密度 $\\rho_2$ 可由正激波的Rankine-Hugoniot关系式求得：\n    $$\n    \\rho_2 = \\rho_R \\frac{(\\gamma + 1) M_1^2}{(\\gamma - 1) M_1^2 + 2}\n    $$\n    已知波后压力为 $p^\\star$，波后密度为 $\\rho_2$，则紧邻激波后的温度 $T_{\\mathrm{ps}}$ 可使用理想气体定律 $p=\\rho R T$ 计算得出：\n    $$\n    T_{\\mathrm{ps}} = \\frac{p^\\star}{\\rho_2 R}\n    $$\n    对于退化情况，不发生激波加热。因此，$M_1=1$，$\\rho_2=\\rho_R$，且 $p^\\star=p_R$，这导致 $T_{\\mathrm{ps}} = T_R = p_R / (\\rho_R R)$。\n\n3.  **反应温度 $T_{\\mathrm{react}}(t)$**：波后，气团的温度为 $T_{\\mathrm{ps}}$，压力为 $p^\\star$。反应模型包含一个诱导延迟 $\\tau_{\\mathrm{ind}}$，随后是瞬时热量释放。诱导时间基于波后温度，使用阿伦尼乌斯定律计算：\n    $$\n    \\tau_{\\mathrm{ind}} = \\left(A \\exp\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}} T_{\\mathrm{ps}}}\\right)\\right)^{-1}\n    $$\n    激波通过后，在时间 $t$ 的温度由一个阶跃函数确定：\n    $$\n    T_{\\mathrm{react}}(t) = \n    \\begin{cases} \n    T_{\\mathrm{ps}}  \\text{if } t  \\tau_{\\mathrm{ind}} \\\\\n    T_{\\mathrm{ps}} + \\frac{Q}{c_p}  \\text{if } t \\ge \\tau_{\\mathrm{ind}}\n    \\end{cases}\n    $$\n    假设热量释放是准等压的，因此温度升高量为 $\\Delta T = Q/c_p$，其中 $c_p$ 是定压比热，对于量热完全气体由下式给出：\n    $$\n    c_p = \\frac{\\gamma R}{\\gamma - 1}\n    $$\n\n4.  **激波位置 $x_s(t)$**：假设初始间断在 $t=0$ 时位于 $x=0$，激波以恒定速度 $S$ 移动。其在时间 $t$ 的位置是：\n    $$\n    x_s(t) = S t\n    $$\n\n将这些步骤应用于每个测试用例，以生成所需的一组四个验证量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the reactive Riemann problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (nonreactive happy path)\n        {\n            \"rho_L\": 1.0, \"u_L\": 0.0, \"p_L\": 101325.0,\n            \"rho_R\": 0.125, \"u_R\": 0.0, \"p_R\": 10000.0,\n            \"gamma\": 1.4, \"R\": 287.0,\n            \"Q\": 0.0, \"A\": 1e6, \"E_a\": 1.5e5, \"R_u\": 8.314,\n            \"t\": 1.0e-3\n        },\n        # Case 2 (slow chemistry, no burn)\n        {\n            \"rho_L\": 1.0, \"u_L\": 0.0, \"p_L\": 101325.0,\n            \"rho_R\": 0.125, \"u_R\": 0.0, \"p_R\": 10000.0,\n            \"gamma\": 1.4, \"R\": 287.0,\n            \"Q\": 2.0e6, \"A\": 1e3, \"E_a\": 1.5e5, \"R_u\": 8.314,\n            \"t\": 5.0e-5\n        },\n        # Case 3 (fast chemistry, burn)\n        {\n            \"rho_L\": 1.0, \"u_L\": 0.0, \"p_L\": 101325.0,\n            \"rho_R\": 0.125, \"u_R\": 0.0, \"p_R\": 10000.0,\n            \"gamma\": 1.4, \"R\": 287.0,\n            \"Q\": 2.0e6, \"A\": 1e6, \"E_a\": 8.0e4, \"R_u\": 8.314,\n            \"t\": 1.0e-3\n        },\n        # Case 4 (degenerate equal-state)\n        {\n            \"rho_L\": 1.0, \"u_L\": 0.0, \"p_L\": 101325.0,\n            \"rho_R\": 1.0, \"u_R\": 0.0, \"p_R\": 101325.0,\n            \"gamma\": 1.4, \"R\": 287.0,\n            \"Q\": 1.0e6, \"A\": 1e6, \"E_a\": 8.0e4, \"R_u\": 8.314,\n            \"t\": 1.0e-3\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho_L, u_L, p_L = case[\"rho_L\"], case[\"u_L\"], case[\"p_L\"]\n        rho_R, u_R, p_R = case[\"rho_R\"], case[\"u_R\"], case[\"p_R\"]\n        gamma = case[\"gamma\"]\n        R = case[\"R\"]\n        Q, A, E_a, R_u = case[\"Q\"], case[\"A\"], case[\"E_a\"], case[\"R_u\"]\n        t = case[\"t\"]\n\n        # Handle degenerate equal-state case\n        if p_L == p_R and rho_L == rho_R and u_L == u_R:\n            S = 0.0\n            p_star = p_R\n            T_R = p_R / (rho_R * R)\n            T_ps = T_R\n        else:\n            # Determine properties for the Riemann problem solver\n            c_L = np.sqrt(gamma * p_L / rho_L)\n            c_R = np.sqrt(gamma * p_R / rho_R)\n\n            # Function f_k for rarefaction\n            def f_rarefaction(p, p_k, rho_k):\n                if p  p_k: # Post-rarefaction pressure must be lower\n                    return (p - p_k)  # Invalid term to push solver away\n                c_k = np.sqrt(gamma * p_k / rho_k)\n                return (2 * c_k / (gamma - 1)) * ((p / p_k)**((gamma - 1) / (2 * gamma)) - 1)\n\n            # Function f_k for shock\n            def f_shock(p, p_k, rho_k):\n                if p  p_k: # Post-shock pressure must be higher\n                    return (p - p_k) # Invalid term\n                A_k = 2 / ((gamma + 1) * rho_k)\n                B_k = p_k * (gamma - 1) / (gamma + 1)\n                return (p - p_k) * np.sqrt(A_k / (p + B_k))\n\n            # Total function F(p) = 0 for the star-state pressure p_star\n            def F(p):\n                # Left-moving wave is a rarefaction (since p_L > p_R implies p_star  p_L)\n                fL = f_rarefaction(p, p_L, rho_L)\n                # Right-moving wave is a shock (since p_L > p_R implies p_star > p_R)\n                fR = f_shock(p, p_R, rho_R)\n                return fL + fR + u_R - u_L\n            \n            # Solve for star-region pressure p_star\n            # Bracket the root between p_R and p_L\n            p_star = optimize.brentq(F, p_R, p_L)\n            \n            # 1. Shock Speed S\n            M1 = np.sqrt(((p_star / p_R) - 1) * (gamma + 1) / (2 * gamma) + 1)\n            S = u_R + M1 * c_R\n            \n            # 2. Immediate Post-shock Temperature T_ps\n            rho2 = rho_R * ((gamma + 1) * M1**2) / ((gamma - 1) * M1**2 + 2)\n            T_ps = p_star / (rho2 * R)\n\n        # 3. Reactive Temperature T_react(t)\n        cp = gamma * R / (gamma - 1)\n        \n        # Avoid division by zero or overflow if T_ps is very low\n        if T_ps = 0:\n            tau_ind = float('inf')\n        else:\n            exponent = -E_a / (R_u * T_ps)\n            # Avoid underflow in exp for large negative exponents\n            if exponent  -700: # np.exp(-709) is ~1e-308\n                 tau_ind = float('inf')\n            else:\n                rate = A * np.exp(exponent)\n                if rate  0:\n                    tau_ind = 1.0 / rate\n                else:\n                    tau_ind = float('inf')\n        \n        if t  tau_ind:\n            T_react = T_ps\n        else:\n            T_react = T_ps + Q / cp\n            \n        # 4. Shock Position x_s(t)\n        x_s = S * t\n        \n        results.append([S, T_ps, T_react, x_s])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}