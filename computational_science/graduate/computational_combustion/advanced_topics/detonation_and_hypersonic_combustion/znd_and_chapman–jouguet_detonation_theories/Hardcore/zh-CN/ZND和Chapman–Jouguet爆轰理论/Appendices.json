{
    "hands_on_practices": [
        {
            "introduction": "ZND模型将爆轰波分解为一个前导的无反应激波和一个随后的反应区。理解气体在穿过这个前导激波（即冯·诺依曼峰）后的状态，是分析整个爆轰结构的第一步。本练习将通过应用基本的兰金-雨贡纽关系式，让你亲手推导出激波后的温度，从而加深对ZND模型物理起点的理解 ()。",
            "id": "4078300",
            "problem": "在泽尔多维奇-冯·诺伊曼-多林 (ZND) 模型中，一个平面爆轰波以恒定速度 $D$ 传播到初始处于热力学状态 $(p_{0},T_{0})$ 的静止理想气体混合物中。紧邻前导激波后方，化学组分被假设为不变（组分冻结），气体可被建模为具有恒定热容比 $\\gamma$ 和气体常数 $R$ 的理想气体。上游混合物在实验室坐标系中是静止的，激波速度满足 $D  \\sqrt{\\gamma R T_{0}}$，因此激波相对于上游状态是超声速的。\n\n从激波固定坐标系中的一维定常质量、动量和能量守恒律出发，结合理想气体状态方程 $p=\\rho R T$ 和定热容理想气体焓 $h=c_{p}T$（其中 $c_{p}=\\gamma R/(\\gamma-1)$），推导出一个关于 $(D,\\gamma,R,T_{0})$ 的下游温度 $T$（紧邻激波后方）的闭式表达式。不要使用任何预先推导的激波跳跃关系式；推导必须从基本平衡关系和给定的状态方程开始。\n\n清楚地陈述在泽尔多维奇-冯·诺伊曼-多林 (ZND) 模型中，组分在激波处保持冻结的物理假设。\n\n将最终温度以开尔文为单位，表示为关于 $(D,\\gamma,R,T_{0})$ 的单个解析表达式。不需要进行数值计算，也不需要四舍五入。",
            "solution": "泽尔多维奇-冯·诺伊曼-多林 (ZND) 模型假设一个前导流体动力学激波，其后跟随着一个诱导区和反应区。在激波本身处，化学源项可以忽略不计，因此流动由气体动力学守恒律和具有恒定热容比 $\\gamma$ 的理想气体状态方程控制。\n\n我们在激波固定坐标系中进行分析。设上游（状态 $0$）为以速度 $u_{0}=D$ 朝激波移动的静止气体，下游（状态 $1$）为激波后以速度 $u_{1}$ 远离激波的状态。一维定常朗肯-雨贡纽关系为：\n- 质量守恒：\n$$\\rho_{0} u_{0} = \\rho_{1} u_{1}.$$\n- 动量守恒：\n$$p_{0} + \\rho_{0} u_{0}^{2} = p_{1} + \\rho_{1} u_{1}^{2}.$$\n- 能量守恒：\n$$h_{0} + \\frac{u_{0}^{2}}{2} = h_{1} + \\frac{u_{1}^{2}}{2}.$$\n\n对于具有恒定 $\\gamma$ 的理想气体，我们有理想气体状态方程 $p=\\rho R T$ 和热力学关系 $h=c_{p}T$，其中 $c_{p}=\\gamma R/(\\gamma-1)$。上游声速为 $a_{0}=\\sqrt{\\gamma R T_{0}}$，上游马赫数为 $M_{0}=u_{0}/a_{0}=D/\\sqrt{\\gamma R T_{0}}$，根据假设 $M_{0}1$。\n\n我们引入速度比\n$$r \\equiv \\frac{u_{1}}{u_{0}}.$$\n根据质量守恒，\n$$\\frac{\\rho_{1}}{\\rho_{0}} = \\frac{u_{0}}{u_{1}} = \\frac{1}{r}.$$\n根据动量守恒，整理可得\n$$p_{1}-p_{0} = \\rho_{0} u_{0} (u_{0}-u_{1}).$$\n两边除以 $p_{0}$ 并使用 $p_{0}=\\rho_{0} a_{0}^{2}/\\gamma$ 可得\n$$\\frac{p_{1}}{p_{0}} - 1 = \\gamma \\frac{u_{0}(u_{0}-u_{1})}{a_{0}^{2}} = \\gamma \\left(\\frac{u_{0}}{a_{0}}\\right)^{2} \\left(1 - \\frac{u_{1}}{u_{0}}\\right) = \\gamma M_{0}^{2} (1 - r),$$\n所以\n$$\\frac{p_{1}}{p_{0}} = 1 + \\gamma M_{0}^{2} (1 - r).$$\n\n根据能量守恒，使用 $h=c_{p}T$ 和 $c_{p}=\\gamma R/(\\gamma-1)$，\n$$c_{p}(T_{1}-T_{0}) = \\frac{u_{0}^{2}-u_{1}^{2}}{2},$$\n因此\n$$\\frac{T_{1}}{T_{0}} - 1 = \\frac{u_{0}^{2}-u_{1}^{2}}{2 c_{p} T_{0}} = \\frac{u_{0}^{2}-u_{1}^{2}}{2} \\cdot \\frac{\\gamma - 1}{\\gamma R T_{0}}.$$\n利用 $a_{0}^{2}=\\gamma R T_{0}$，上式变为\n$$\\frac{T_{1}}{T_{0}} = 1 + \\frac{\\gamma - 1}{2} \\left(\\frac{u_{0}}{a_{0}}\\right)^{2} \\left[1 - \\left(\\frac{u_{1}}{u_{0}}\\right)^{2}\\right] = 1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2}).$$\n\n理想气体关系给出\n$$\\frac{p_{1}}{p_{0}} = \\frac{\\rho_{1} R T_{1}}{\\rho_{0} R T_{0}} = \\frac{\\rho_{1}}{\\rho_{0}} \\frac{T_{1}}{T_{0}} = \\frac{1}{r} \\frac{T_{1}}{T_{0}}.$$\n将此式与从动量方程推导出的 $p_{1}/p_{0}$ 表达式相等，得到\n$$\\frac{1}{r} \\left[1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2})\\right] = 1 + \\gamma M_{0}^{2} (1 - r).$$\n两边乘以 $r$ 得到一个关于 $r$ 的二次方程：\n$$1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2}) = r + \\gamma M_{0}^{2} r (1 - r).$$\n合并同类项，\n$$\\frac{\\gamma + 1}{2} M_{0}^{2} r^{2} - \\left[1 + \\gamma M_{0}^{2}\\right] r + \\left[1 + \\frac{\\gamma - 1}{2} M_{0}^{2}\\right] = 0.$$\n解此二次方程，物理上相关的（压缩激波）根是\n$$r = \\frac{(\\gamma - 1) M_{0}^{2} + 2}{(\\gamma + 1) M_{0}^{2}},$$\n而另一个根 $r=1$ 对应于平凡的无激波解。\n\n已知 $r$ 后，压力比为\n$$\\frac{p_{1}}{p_{0}} = 1 + \\frac{2 \\gamma}{\\gamma + 1} (M_{0}^{2} - 1),$$\n密度比为\n$$\\frac{\\rho_{1}}{\\rho_{0}} = \\frac{(\\gamma + 1) M_{0}^{2}}{(\\gamma - 1) M_{0}^{2} + 2}.$$\n因此温度比为\n$$\\frac{T_{1}}{T_{0}} = \\frac{p_{1}/p_{0}}{\\rho_{1}/\\rho_{0}} = \\left[1 + \\frac{2 \\gamma}{\\gamma + 1} (M_{0}^{2} - 1)\\right] \\left[\\frac{(\\gamma - 1) M_{0}^{2} + 2}{(\\gamma + 1) M_{0}^{2}}\\right].$$\n代入 $M_{0}^{2} = D^{2}/(\\gamma R T_{0})$ 得到紧邻激波后方的下游温度：\n$$T_{1} = T_{0} \\left( 1 + \\frac{2 \\gamma}{\\gamma + 1} \\left( \\frac{D^{2}}{\\gamma R T_{0}} - 1 \\right) \\right) \\left( \\frac{ (\\gamma - 1) \\frac{D^{2}}{\\gamma R T_{0}} + 2 }{ (\\gamma + 1) \\frac{D^{2}}{\\gamma R T_{0}} } \\right).$$\n这个 $T_{1}$ 就是在泽尔多维奇-冯·诺伊曼-多林 (ZND) 爆轰中，当组分穿过激波时保持冻结的条件下，紧邻前导激波后方的温度。\n\n在泽尔多维奇-冯·诺伊曼-多林 (ZND) 模型中，组分在激波处保持冻结的假设：\n- 激波厚度 $\\delta_{s}$ 是微观的，穿过激波的对流驻留时间 $\\tau_{s} \\sim \\delta_{s}/u_{0}$ 远小于特征化学诱导时间 $\\tau_{\\chi}$，因此基于激波的丹姆科勒数 $Da_{\\delta_{s}} \\equiv \\tau_{s}/\\tau_{\\chi}$ 满足 $Da_{\\delta_{s}} \\ll 1$；这等效于在穿越激波时化学源项可以忽略不计。\n- 在激波处，热化学状态由单一的平动-转动温度描述，振动和电子激发在 $\\tau_{s}$ 时间内不导致净组分变化；比热和 $\\gamma$ 在穿过激波时可被视为常数。\n- 在激波厚度范围内，没有外部热量添加、体积力或辐射；激波过程是绝热且一维的。\n- 上游混合物是均匀的，并且在激波过程中保持为单一理想气体相，因此 $p=\\rho R T$ 和 $h=c_{p} T$ 适用。\n- 前导激波是流体动力学的且非反应的；反应仅在下游的诱导区进行，该区域的温度和压力历史控制着激波后的点火。\n\n在这些假设下，紧邻激波后方的下游状态是上述给出的冻结正激波状态，它在泽尔多维奇-冯·诺伊曼-多林 (ZND) 爆轰结构中作为冯·诺伊曼状态。",
            "answer": "$$\\boxed{T_{0}\\left(1+\\frac{2\\gamma}{\\gamma+1}\\left(\\frac{D^{2}}{\\gamma R T_{0}}-1\\right)\\right)\\left(\\frac{(\\gamma-1)\\,\\frac{D^{2}}{\\gamma R T_{0}}+2}{(\\gamma+1)\\,\\frac{D^{2}}{\\gamma R T_{0}}}\\right)}$$"
        },
        {
            "introduction": "在确定了爆轰波内部的初始状态后，一个关键问题是：爆轰波会以何种速度传播？查普曼-茹盖（CJ）理论通过一个关键的声速条件，为预测稳定爆轰的唯一速度提供了有力的工具。这项练习要求你结合整个波阵面的守恒定律和反应区末端的CJ声速条件，推导出理想气体中的CJ爆轰速度公式，体验理论如何预测这一重要的宏观现象 ()。",
            "id": "4078265",
            "problem": "在理想气体燃烧的泽尔多维奇-冯·诺依曼-多灵 (Zeldovich–von Neumann–Döring, ZND) 模型中，一个平面、稳态的爆轰波在静止的预混气体中传播。该气体的已知初始压力为 $p_1$，密度为 $\\rho_1$，恒定比热比为 $\\gamma$。查普曼-茹盖 (Chapman–Jouguet, CJ) 状态由反应后流场相对于爆轰波前沿为声速的条件定义。假设理想气体定律始终成立，声速 $a$ 满足 $a^2 = \\gamma p / \\rho$，并且穿过反应区的单位质量化学能释放为一个正常数 $q$。在爆轰固定坐标系中，上游气体的速度为 $u_1 = D$，其中 $D$ 是爆轰速度。\n\n从穿过爆轰波的一维稳态质量、动量和能量守恒（包括热释放 $q$）以及理想气体热力学关系出发，结合反应雨贡纽线、瑞利线以及下游状态的 CJ 声速条件 $u_2 = a_2$，消去所有下游状态变量，获得一个关于 CJ 爆轰速度 $D_{CJ}$ 的单一代数方程。请明确说明你在推导过程中引入和消去的未知量集合。\n\n将你的最终答案表示为 $D_{CJ}^{2}$ 关于 $a_1^{2}$、$\\gamma$ 和 $q$ 的封闭形式解析表达式，其中 $a_1^{2} = \\gamma p_1 / \\rho_1$。如果进行数值计算，请将 $D_{CJ}^{2}$ 以国际单位制 $\\mathrm{m}^2/\\mathrm{s}^2$ 表示，将 $q$ 以 $\\mathrm{J}/\\mathrm{kg}$ 表示。无需进行数值代入；只需报告符号表达式。无需四舍五入。",
            "solution": "题目要求基于理想气体中平面、稳态、一维爆轰的基本守恒原理，推导查普曼-茹盖 (CJ) 爆轰速度的平方（记为 $D_{CJ}^2$）的表达式。\n\n我们首先陈述控制方程——朗肯-雨贡纽 (Rankine-Hugoniot) 方程，这些方程表达了穿过爆轰波的质量、动量和能量守恒，将上游状态（下标为 1）与下游状态（下标为 2）联系起来。参考系固定在爆轰波前沿上，因此上游气体速度为 $u_1 = D$，其中 $D$ 是爆轰速度。下游速度为 $u_2$。\n\n守恒方程如下：\n1.  质量守恒：\n    $$ \\rho_1 u_1 = \\rho_2 u_2 $$\n    代入 $u_1 = D$，我们得到：\n    $$ \\rho_1 D = \\rho_2 u_2 \\quad (1) $$\n2.  动量守恒：\n    $$ p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2 $$\n    代入 $u_1 = D$，我们得到：\n    $$ p_1 + \\rho_1 D^2 = p_2 + \\rho_2 u_2^2 \\quad (2) $$\n3.  能量守恒：\n    $$ h_1 + \\frac{1}{2} u_1^2 + q = h_2 + \\frac{1}{2} u_2^2 $$\n    其中 $h$ 是比焓，$q$ 是单位质量热释放。对于比热比 $\\gamma$ 为常数的理想气体，比焓由 $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$ 给出。代入此式和 $u_1=D$：\n    $$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 \\quad (3) $$\n\n该方程组由查普曼-茹盖条件封闭，该条件指出下游流场相对于爆轰波前沿是声速的。理想气体中的声速 $a$ 由 $a^2 = \\gamma p / \\rho$ 给出。因此，CJ 条件是：\n$$ u_2 = a_2 \\implies u_2^2 = a_2^2 = \\frac{\\gamma p_2}{\\rho_2} \\quad (4) $$\n\n目标是找到一个用初始状态性质 $p_1$、$\\rho_1$（或等效地 $a_1^2 = \\gamma p_1/\\rho_1$）、$\\gamma$ 和热释放 $q$ 表示的 $D_{CJ}^2$ 表达式。为此，我们必须消去未知的下游状态变量：压力 $p_2$、密度 $\\rho_2$ 和速度 $u_2$。\n\n首先，我们使用 CJ 条件 $(4)$ 来简化动量方程 $(2)$：\n$$ p_1 + \\rho_1 D^2 = p_2 + \\rho_2 \\left( \\frac{\\gamma p_2}{\\rho_2} \\right) = p_2 + \\gamma p_2 = p_2(1+\\gamma) $$\n由此，我们可以用 $D$ 和上游性质来表示下游压力 $p_2$：\n$$ p_2 = \\frac{p_1 + \\rho_1 D^2}{1+\\gamma} \\quad (5) $$\n\n接下来，我们使用方程 $(1)$ 和 $(4)$ 将 $\\rho_2$ 与其他变量联系起来。将质量守恒方程 $(1)$ 两边平方：\n$$ \\rho_1^2 D^2 = \\rho_2^2 u_2^2 $$\n代入 CJ 条件 $u_2^2 = \\gamma p_2/\\rho_2$：\n$$ \\rho_1^2 D^2 = \\rho_2^2 \\left( \\frac{\\gamma p_2}{\\rho_2} \\right) = \\gamma p_2 \\rho_2 $$\n这使我们能够将下游密度 $\\rho_2$ 表示为：\n$$ \\rho_2 = \\frac{\\rho_1^2 D^2}{\\gamma p_2} \\quad (6) $$\n\n现在我们有了用 $D$ 和彼此表示的 $p_2$ 和 $\\rho_2$ 的表达式。我们可以将它们组合起来求出比值 $p_2/\\rho_2$：\n$$ \\frac{p_2}{\\rho_2} = p_2 \\left( \\frac{1}{\\rho_2} \\right) = p_2 \\left( \\frac{\\gamma p_2}{\\rho_1^2 D^2} \\right) = \\frac{\\gamma p_2^2}{\\rho_1^2 D^2} $$\n代入 (5) 式中的 $p_2$ 表达式：\n$$ \\frac{p_2}{\\rho_2} = \\frac{\\gamma}{\\rho_1^2 D^2} \\left( \\frac{p_1 + \\rho_1 D^2}{1+\\gamma} \\right)^2 = \\frac{\\gamma (p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2 (1+\\gamma)^2} \\quad (7) $$\n\n最后一步是使用能量方程 $(3)$。我们可以利用 CJ 条件 $u_2^2 = \\gamma p_2/\\rho_2$ 来简化其右侧：\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}\\gamma\\frac{p_2}{\\rho_2} = \\left( \\frac{\\gamma}{\\gamma-1} + \\frac{\\gamma}{2} \\right) \\frac{p_2}{\\rho_2} $$\n$$ = \\left( \\frac{2\\gamma + \\gamma(\\gamma-1)}{2(\\gamma-1)} \\right) \\frac{p_2}{\\rho_2} = \\frac{\\gamma^2+\\gamma}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} $$\n因此能量方程变为：\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} \\quad (8) $$\n\n现在，我们将 (7) 式中的 $p_2/\\rho_2$ 表达式代入 (8) 式：\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\left[ \\frac{\\gamma (p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2 (1+\\gamma)^2} \\right] $$\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma-1)(1+\\gamma)} \\frac{(p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2} $$\n为简化起见，我们引入上游声速的平方 $a_1^2 = \\gamma p_1/\\rho_1$，这意味着 $p_1/\\rho_1 = a_1^2/\\gamma$。\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{a_1^2}{\\gamma} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma^2-1)} \\frac{(\\rho_1 a_1^2/\\gamma + \\rho_1 D^2)^2}{\\rho_1^2 D^2} $$\n$$ \\frac{a_1^2}{\\gamma-1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma^2-1)} \\frac{\\rho_1^2 (a_1^2/\\gamma + D^2)^2}{\\rho_1^2 D^2} = \\frac{1}{2(\\gamma^2-1)} \\frac{(a_1^2 + \\gamma D^2)^2}{D^2} $$\n这是一个关于 $D$ 的单一代数方程，也正是题目要求得到的。从现在起，$D$ 特指 CJ 速度 $D_{CJ}$。令 $X = D_{CJ}^2$。\n$$ \\frac{a_1^2}{\\gamma-1} + \\frac{X}{2} + q = \\frac{(a_1^2 + \\gamma X)^2}{2(\\gamma^2-1)X} $$\n为了解出 $X$，我们通过乘以 $2(\\gamma^2-1)X$ 来消去分母：\n$$ 2(\\gamma+1)X a_1^2 + (\\gamma^2-1)X^2 + 2(\\gamma^2-1)q X = (a_1^2 + \\gamma X)^2 $$\n$$ 2(\\gamma+1)X a_1^2 + (\\gamma^2-1)X^2 + 2(\\gamma^2-1)q X = (a_1^2)^2 + 2\\gamma a_1^2 X + \\gamma^2 X^2 $$\n整理成关于 $X$ 的二次方程的各项：\n$$ X^2(\\gamma^2-1-\\gamma^2) + X(2(\\gamma+1)a_1^2 + 2(\\gamma^2-1)q - 2\\gamma a_1^2) - a_1^4 = 0 $$\n$$ -X^2 + X(2\\gamma a_1^2 + 2a_1^2 + 2(\\gamma^2-1)q - 2\\gamma a_1^2) - a_1^4 = 0 $$\n$$ -X^2 + 2(a_1^2 + (\\gamma^2-1)q)X - a_1^4 = 0 $$\n$$ X^2 - 2[a_1^2 + (\\gamma^2-1)q]X + a_1^4 = 0 $$\n这就是所求的关于 $X = D_{CJ}^2$ 的二次方程。我们使用求根公式 $X = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 来求解：\n$$ D_{CJ}^2 = \\frac{2[a_1^2 + (\\gamma^2-1)q] \\pm \\sqrt{4[a_1^2 + (\\gamma^2-1)q]^2 - 4a_1^4}}{2} $$\n$$ D_{CJ}^2 = [a_1^2 + (\\gamma^2-1)q] \\pm \\sqrt{[a_1^2 + (\\gamma^2-1)q]^2 - a_1^4} $$\n展开平方根下的项：\n$$ \\sqrt{(a_1^4 + 2a_1^2(\\gamma^2-1)q + ((\\gamma^2-1)q)^2) - a_1^4} = \\sqrt{2a_1^2(\\gamma^2-1)q + ((\\gamma^2-1)q)^2} $$\n$$ = \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$\n这给出了 $D_{CJ}^2$ 的两个可能解：\n$$ D_{CJ}^2 = a_1^2 + (\\gamma^2-1)q \\pm \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$\n这两个解对应于“强”和“弱”（或病态的）CJ 爆轰分支。物理上可实现的、自持的爆轰对应于较高的速度，即由正号给出。在大热释放极限 ($q \\to \\infty$) 下，带负号的解会导致非物理结果。因此，我们选择正根。\n\n查普曼-茹盖爆轰速度平方的最终封闭形式表达式为：\n$$ D_{CJ}^2 = a_1^2 + (\\gamma^2-1)q + \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$",
            "answer": "$$\\boxed{a_1^2 + (\\gamma^2-1)q + \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]}}$$"
        },
        {
            "introduction": "虽然解析推导为我们提供了深刻的物理洞察，但它们通常局限于简化模型。为了处理更真实的化学反应动力学并获得爆轰波内部的详细结构，数值方法是必不可少的。本计算练习将指导你建立并求解描述反应区内流动状态演化的常微分方程组 (ODEs)，从而完整地构建出从冯·诺依曼峰到CJ声速点的ZND剖面 ()。",
            "id": "4078305",
            "problem": "考虑一个稳态一维反应流，其在波固定坐标系中由Zel'dovich–von Neumann–Döring (ZND) 模型描述，该气体为定压比热的量热完全气体。该流动由质量、动量和能量守恒定律控制，并与一个描述反应物质量分数的单步阿伦尼乌斯反应耦合。目标是推导适用于数值积分的半离散线方法，并实现带有事件检测的刚性常微分方程（ODE）积分器，事件检测点为马赫数等于1的查普曼-茹盖（CJ）声速点。\n\n从激波附加（波固定）坐标系中的基本稳态一维守恒定律出发，空间坐标用$x$表示：\n- 质量守恒：$d(\\rho u)/dx = 0$，其中 $\\rho$ 是密度，$u$ 是波固定坐标系中的流速。这表明存在一个恒定的质量通量 $m$，使得 $\\rho u = m$。\n- 动量守恒：$d(\\rho u^2 + p)/dx = 0$，其中 $p$ 是压力。这表明存在一个恒定的动量通量 $P$，使得 $\\rho u^2 + p = P$。\n- 包含化学势且总能量守恒的能量关系式：$d\\left(c_p T + \\frac{u^2}{2} + q Y\\right)/dx = 0$，其中 $c_p$ 是定压比热，$T$ 是温度，$q$ 是单位质量反应物释放的化学能，$Y$ 是反应物质量分数。\n\n假设理想气体状态方程为 $p = \\rho R T$，其中 $R$ 是比气体常数，以及单位体积的单步阿伦尼乌斯反应速率为 $\\dot{\\omega} = -\\rho k Y \\exp\\left(-E/(R T)\\right)$，其中 $k$ 是指前因子，$E$ 是单位质量的活化能。在稳态波固定坐标系中，组分输运方程为 $\\rho u \\, dY/dx = \\dot{\\omega}$。\n\n通过以下步骤推导状态向量 $\\mathbf{y}(x) = [u(x), Y(x)]^\\top$ 的半离散线方法ODE系统：\n1. 利用质量和动量不变量消去 $\\rho$ 和 $p$，将 $T$ 表示为 $u$ 的函数，并求得 $dT/du$。\n2. 利用能量关系式，得到以 $dY/dx$ 和 $u$ 表示的 $du/dx$。\n3. 利用组分方程，得到以 $u$、$Y$ 和 $T(u)$ 表示的 $dY/dx$。\n\n定义马赫数 $M(u) = u / a$，其中声速为 $a(u) = \\sqrt{\\gamma R T(u)}$，$\\gamma$ 是比热比。CJ声速点由事件 $M(u) = 1$ 定义。实现带有针对 $M(u) - 1 = 0$ 的事件检测的刚性ODE积分，并在CJ点或当反应物完全消耗（$Y = 0$）时终止积分。\n\n您的程序必须：\n- 实现推导出的ODE系统，并使用刚性方法进行积分，同时在 $M = 1$ 和 $Y = 0$ 处进行事件检测。\n- 对于每个测试用例，计算事件 $M = 1$ 发生的空间位置 $x_{\\text{sonic}}$（单位为米）。如果事件在积分域内未发生，则返回 $-1.0$。\n- 对每个测试用例使用以下参数化：$(\\gamma, R, p_0, T_0, u_0, q, k, E, x_{\\max})$，其中 $p_0$（帕斯卡）、$T_0$（开尔文）和 $u_0$（米/秒）是确定不变量 $m$ 和 $P$ 的激波后瞬时属性，$q$（焦耳/千克）是热释放量，$k$（1/秒）是指前因子，$E$（焦耳/千克）是活化能，$x_{\\max}$（米）是最大积分距离。\n- 对于量热完全气体，使用 $c_p = \\gamma R / (\\gamma - 1)$。\n- 对于数值解，最终答案以米为单位表示，并四舍五入到六位小数。\n\n测试套件：\n提供以下测试用例以评估求解器：\n1. 一般情况（预期会发生事件）：$\\gamma = 1.4$, $R = 287$, $p_0 = 10^6$, $T_0 = 1200$, $u_0 = 1500$, $q = 2.0 \\times 10^6$, $k = 2.0 \\times 10^6$, $E = 1.5 \\times 10^6$, $x_{\\max} = 0.2$。\n2. 边界情况（无热释放，预期不会发生事件）：$\\gamma = 1.4$, $R = 287$, $p_0 = 10^6$, $T_0 = 1200$, $u_0 = 1500$, $q = 0$, $k = 2.0 \\times 10^6$, $E = 1.5 \\times 10^6$, $x_{\\max} = 0.2$。\n3. 边缘情况（初始超声速，事件在 $x = 0$ 处发生）：$\\gamma = 1.4$, $R = 287$, $p_0 = 10^6$, $T_0 = 1200$, $u_0 = 900$, $q = 2.0 \\times 10^6$, $k = 2.0 \\times 10^6$, $E = 1.5 \\times 10^6$, $x_{\\max} = 0.2$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含三个测试用例的 $x_{\\text{sonic}}$ 值列表，格式为方括号内的逗号分隔列表，按上述顺序列出，并四舍五入到六位小数。例如，输出应类似于 $[x_1,x_2,x_3]$，其中每个 $x_i$ 是一个以米为单位、保留六位小数的浮点数，而 $-1.0$ 表示事件 $M = 1$ 在积分域内未发生。",
            "solution": "该问题要求对稳态一维爆轰波的Zel'dovich–von Neumann–Döring (ZND) 模型进行推导和数值求解。该问题在科学上是合理的，提法是适定的，并且所有必要的参数都已提供。\n\n求解过程首先涉及推导描述前导激波后方流动结构的常微分方程（ODE）系统，然后对该系统进行带有事件检测的数值积分，以找到查普曼-茹盖（CJ）声速点的位置。\n\n### ODE系统的推导\n\n目标是推导状态向量 $\\mathbf{y}(x) = [u(x), Y(x)]^\\top$ 的半离散线方法，这需要找到 $du/dx$ 和 $dY/dx$ 的表达式。\n\n**1. 代数关系和不变量**\n\n流动由稳态一维波固定坐标系中的质量和动量守恒定律控制。\n质量通量是恒定的：\n$$ \\rho u = m $$\n动量通量是恒定的：\n$$ \\rho u^2 + p = P $$\n$m$ 和 $P$ 的常数值由 $x=0$ 处的初始激波后条件确定，用下标 $0$ 表示：\n$$ m = \\rho_0 u_0 $$\n$$ P = \\rho_0 u_0^2 + p_0 = m u_0 + p_0 $$\n其中 $\\rho_0 = p_0 / (R T_0)$ 来自理想气体定律 $p = \\rho R T$。\n\n利用这些不变量，我们可以将压力 $p$ 和密度 $\\rho$ 表示为速度 $u$ 的函数：\n$$ \\rho(u) = \\frac{m}{u} $$\n$$ p(u) = P - \\rho u^2 = P - \\frac{m}{u} u^2 = P - mu $$\n现在，我们可以利用理想气体定律将温度 $T$ 表示为 $u$ 的函数：\n$$ T(u) = \\frac{p(u)}{\\rho(u) R} = \\frac{P - mu}{(m/u)R} = \\frac{u}{mR}(P - mu) $$\n该方程描述了瑞利线。\n\n**2. 组分守恒方程**\n\n在稳态波固定坐标系中，反应物质量分数 $Y$ 的组分输运方程为：\n$$ \\rho u \\frac{dY}{dx} = \\dot{\\omega} $$\n其中 $\\dot{\\omega}$ 是单位体积的反应速率。由于 $\\rho u = m$，该方程变为：\n$$ m \\frac{dY}{dx} = \\dot{\\omega} $$\n反应速率由单步阿伦尼乌斯定律给出：\n$$ \\dot{\\omega} = -\\rho k Y \\exp\\left(-\\frac{E}{R T}\\right) $$\n代入 $\\rho = m/u$，我们得到：\n$$ \\dot{\\omega} = -\\frac{m}{u} k Y \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n因此，反应物质量分数 $Y$ 的ODE为：\n$$ \\frac{dY}{dx} = \\frac{\\dot{\\omega}}{m} = -\\frac{k Y}{u} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n\n**3. 能量守恒和速度方程**\n\n能量守恒方程为：\n$$ \\frac{d}{dx}\\left(c_p T + \\frac{u^2}{2} + q Y\\right) = 0 $$\n对 $x$ 应用链式法则求导：\n$$ c_p \\frac{dT}{dx} + u \\frac{du}{dx} + q \\frac{dY}{dx} = 0 $$\n我们还有 $\\frac{dT}{dx} = \\frac{dT}{du} \\frac{du}{dx}$。将其代入能量方程得到：\n$$ \\left(c_p \\frac{dT}{du} + u\\right) \\frac{du}{dx} + q \\frac{dY}{dx} = 0 $$\n整理得到 $du/dx$：\n$$ \\frac{du}{dx} = \\frac{-q}{c_p \\frac{dT}{du} + u} \\frac{dY}{dx} $$\n为了简化分母，我们首先从 $T(u) = \\frac{Pu}{mR} - \\frac{u^2}{R}$ 求出 $dT/du$：\n$$ \\frac{dT}{du} = \\frac{P}{mR} - \\frac{2u}{R} = \\frac{1}{R}\\left(\\frac{P}{m} - 2u\\right) $$\n声速的平方是 $a^2 = \\gamma R T$。代入 $T(u)$ 得到：\n$$ a^2(u) = \\gamma R \\left(\\frac{u}{mR}(P-mu)\\right) = \\frac{\\gamma u}{m}(P-mu) $$\n分母项为 $c_p \\frac{dT}{du} + u$。使用 $c_p = \\frac{\\gamma R}{\\gamma - 1}$：\n$$ c_p \\frac{dT}{du} + u = \\frac{\\gamma R}{\\gamma - 1} \\frac{1}{R}\\left(\\frac{P}{m} - 2u\\right) + u = \\frac{\\gamma(P/m-2u) + (\\gamma-1)u}{\\gamma-1} = \\frac{\\gamma P/m - (\\gamma+1)u}{\\gamma-1} $$\n从 $a^2(u)$ 的表达式中，我们可以写出 $P = \\frac{ma^2}{\\gamma u} + mu$。将此 $P$ 的表达式代入前一个表达式的分子中，得到：\n$$ \\gamma \\left(\\frac{a^2}{\\gamma u} + u\\right) - (\\gamma+1)u = \\frac{a^2}{u} + \\gamma u - \\gamma u - u = \\frac{a^2 - u^2}{u} $$\n因此，分母简化为：\n$$ c_p \\frac{dT}{du} + u = \\frac{(a^2-u^2)/u}{\\gamma-1} = \\frac{a^2(u) - u^2}{u(\\gamma-1)} $$\n该分母与 $1 - M^2$ 成正比，其中 $M=u/a$ 是马赫数。它在声速点 $M=1$ 处变为零，这是ODE系统的一个奇点。\n\n将这个简化后的分母代回 $du/dx$ 的表达式中：\n$$ \\frac{du}{dx} = \\frac{-q u(\\gamma-1)}{a^2(u) - u^2} \\frac{dY}{dx} $$\n最后，通过代入 $dY/dx$ 的表达式，我们可以将 $du/dx$ 完全用状态变量 $(u, Y)$ 来表示：\n$$ \\frac{du}{dx} = \\frac{-q u(\\gamma-1)}{a^2(u) - u^2} \\left[ -\\frac{k Y}{u} \\exp\\left(-\\frac{E}{R T(u)}\\right) \\right] = \\frac{q (\\gamma-1) k Y}{a^2(u) - u^2} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n\n**4. 最终的ODE系统**\n\n系统的状态由 $\\mathbf{y}(x) = [u(x), Y(x)]^\\top$ 描述。控制ODE为：\n$$ \\frac{du}{dx} = \\frac{q (\\gamma-1) k Y}{a^2(u) - u^2} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n$$ \\frac{dY}{dx} = -\\frac{k Y}{u} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n其中 $T(u) = \\frac{u}{mR}(P-mu)$ 且 $a^2(u) = \\gamma R T(u)$。初始条件为 $u(0)=u_0$ 和 $Y(0)=1$。该系统是数值刚性的，尤其是在声速点附近，此时 $du/dx$ 的分母趋近于零。需要一个带有事件检测的刚性ODE求解器来找到由条件 $M(u)=1$（或等效地，$u^2 - a^2(u) = 0$）定义的CJ点。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the ZND problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (gamma, R, p0, T0, u0, q, k, E, x_max)\n        (1.4, 287.0, 1.0e6, 1200.0, 1500.0, 2.0e6, 2.0e6, 1.5e6, 0.2),\n        (1.4, 287.0, 1.0e6, 1200.0, 1500.0, 0.0, 2.0e6, 1.5e6, 0.2),\n        (1.4, 287.0, 1.0e6, 1200.0, 900.0, 2.0e6, 2.0e6, 1.5e6, 0.2),\n    ]\n\n    results = []\n    for params in test_cases:\n        x_sonic = solve_znd_case(params)\n        if x_sonic != -1.0:\n            results.append(f\"{x_sonic:.6f}\")\n        else:\n            results.append(\"-1.000000\")\n            \n    print(f\"[{','.join(results)}]\")\n\ndef solve_znd_case(params):\n    \"\"\"\n    Solves the ZND ODE system for a single parameter set.\n    \n    Args:\n        params (tuple): A tuple of physical and numerical parameters.\n    \n    Returns:\n        float: The spatial location x_sonic where M=1, or -1.0 if not found.\n    \"\"\"\n    gamma, R, p0, T0, u0, q, k, E, x_max = params\n\n    # Handle the trivial case of no heat release\n    if q == 0.0:\n        return -1.0\n\n    # Calculate flow invariants from post-shock conditions\n    rho0 = p0 / (R * T0)\n    m_flux = rho0 * u0\n    P_flux = m_flux * u0 + p0\n    \n    # Check if the initial state is already sonic\n    # T(u) = u/(m*R) * (P-m*u)\n    T_val_u0 = u0 * (P_flux - m_flux * u0) / (m_flux * R)\n    a_sq_u0 = gamma * R * T_val_u0\n    if np.isclose(u0**2, a_sq_u0):\n        return 0.0\n\n    # Define the ODE system dy/dx = f(x, y)\n    def odefunc(x, y):\n        u, Y = y[0], y[1]\n\n        # Stop integration if state becomes non-physical\n        if Y  0 or u = 0:\n            return [0.0, 0.0]\n        Y = max(Y, 0) # Clip Y to non-negative\n\n        # Algebraic relations for Temperature and speed of sound squared\n        T_val = u * (P_flux - m_flux * u) / (m_flux * R)\n        if T_val = 0:\n            return [0.0, 0.0]\n        \n        a_sq = gamma * R * T_val\n\n        # Reaction rate exponential term\n        # E is in J/kg, R is in J/kg-K, so E/(R*T) is dimensionless.\n        exp_term = np.exp(-E / (R * T_val))\n        \n        # dY/dx\n        dYdx = -k * Y / u * exp_term\n\n        # du/dx\n        denom = a_sq - u**2\n        if np.isclose(denom, 0.0):\n             # This part should not be reached if event detection works correctly.\n             # It's a safeguard against division by zero.\n             return [0.0, 0.0]\n        dudx = (q * (gamma - 1.0) / denom) * (u * dYdx)\n\n        return [dudx, dYdx]\n\n    # Event function for sonic condition (M=1)\n    def sonic_event(x, y):\n        u = y[0]\n        T_val = u * (P_flux - m_flux * u) / (m_flux * R)\n        if T_val = 0:\n             return 1.0 # Return a positive value to not trigger event\n        a_sq = gamma * R * T_val\n        # Event triggers when this function is zero\n        return u**2 - a_sq\n    sonic_event.terminal = True\n    sonic_event.direction = 0  # Find root regardless of crossing direction\n\n    # Event function for fuel depletion (Y=0)\n    def fuel_depletion_event(x, y):\n        return y[1]\n    fuel_depletion_event.terminal = True\n    fuel_depletion_event.direction = -1 # Trigger when Y decreases to 0\n\n    # Initial conditions at x=0\n    y0 = [u0, 1.0]\n    \n    # Solve the ODE system using a stiff integrator\n    sol = solve_ivp(\n        fun=odefunc,\n        t_span=(0, x_max),\n        y0=y0,\n        method='Radau',\n        events=[sonic_event, fuel_depletion_event],\n        atol=1e-9,  # Use tight tolerances for accuracy\n        rtol=1e-9,\n    )\n    \n    # Extract the result from the solver output\n    # `sol.status == 1` indicates a termination event occurred.\n    # `sol.t_events[0]` corresponds to `sonic_event`.\n    if sol.status == 1 and sol.t_events[0].size > 0:\n        return sol.t_events[0][0]\n\n    return -1.0\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}