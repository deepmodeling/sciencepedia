{
    "hands_on_practices": [
        {
            "introduction": "爆轰理论的核心问题之一是预测其传播速度。本练习将引导你从最基本的物理原理出发，推导出理想气体中Chapman-Jouguet (CJ) 爆轰速度的经典解析表达式。通过联立反应流的Hugoniot关系、Rayleigh线以及CJ声速条件，你将亲身体验如何仅凭热力学和守恒定律便可确定这一关键的爆轰参数，从而为更复杂的模型建立坚实的理论基础。",
            "id": "4078265",
            "problem": "在理想气体燃烧的Zeldovich–von Neumann–Döring (ZND) 模型中，一个平面、稳态的爆轰波在静止的预混气体中传播。已知该气体的初始压力为 $p_1$，密度为 $\\rho_1$，且具有恒定的比热比 $\\gamma$。Chapman–Jouguet (CJ) 状态的定义条件是，反应后的气流相对于爆轰前沿达到声速。假设整个过程中都遵循理想气体定律，声速 $a$ 满足 $a^2 = \\gamma p / \\rho$，并且穿过反应区的单位质量化学能释放为一个正常数 $q$。在爆轰固定坐标系中，上游气体的速度为 $u_1 = D$，其中 $D$ 是爆轰速度。\n\n从跨越爆轰波的一维稳态质量、动量和能量守恒（包括热释放 $q$）以及理想气体热力学关系出发，结合反应雨贡纽关系、瑞利线以及下游状态的CJ声速条件 $u_2 = a_2$，消去所有下游状态变量，从而得到一个关于CJ爆轰速度 $D_{CJ}$ 的单一的代数方程。在您的推导过程中，请明确说明您引入并消去的未知量集合。\n\n将您的最终答案表示为 $D_{CJ}^{2}$ 关于 $a_1^{2}$、$\\gamma$ 和 $q$ 的闭式解析表达式，其中 $a_1^{2} = \\gamma p_1 / \\rho_1$。如果进行数值计算，$D_{CJ}^{2}$ 的国际单位制单位应为 $\\mathrm{m}^2/\\mathrm{s}^2$，$q$ 的单位应为 $\\mathrm{J}/\\mathrm{kg}$。无需进行数值代入；仅报告符号表达式。无需四舍五入。",
            "solution": "该问题要求基于理想气体中平面、稳态、一维爆轰的基本守恒原理，推导Chapman-Jouguet (CJ) 爆轰速度的平方（记为 $D_{CJ}^2$）的表达式。\n\n我们首先陈述控制方程——兰金-雨贡纽方程，这些方程表达了跨越爆轰波的质量、动量和能量守恒，将上游状态（下标1）与下游状态（下标2）联系起来。参考坐标系固定在爆轰前沿上，因此上游气体速度为 $u_1 = D$，其中 $D$ 是爆轰速度。下游速度为 $u_2$。\n\n守恒方程如下：\n1.  质量守恒：\n    $$ \\rho_1 u_1 = \\rho_2 u_2 $$\n    代入 $u_1 = D$，我们得到：\n    $$ \\rho_1 D = \\rho_2 u_2 \\quad (1) $$\n2.  动量守恒：\n    $$ p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2 $$\n    代入 $u_1 = D$，我们得到：\n    $$ p_1 + \\rho_1 D^2 = p_2 + \\rho_2 u_2^2 \\quad (2) $$\n3.  能量守恒：\n    $$ h_1 + \\frac{1}{2} u_1^2 + q = h_2 + \\frac{1}{2} u_2^2 $$\n    其中 $h$ 是比焓，$q$ 是单位质量热释放。对于比热比 $\\gamma$ 为常数的理想气体，比焓由 $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$ 给出。代入此式以及 $u_1=D$：\n    $$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 \\quad (3) $$\n\n该方程组由Chapman-Jouguet条件封闭，该条件表明下游气流相对于爆轰前沿达到声速。理想气体中的声速 $a$ 由 $a^2 = \\gamma p / \\rho$ 给出。因此，CJ条件为：\n$$ u_2 = a_2 \\implies u_2^2 = a_2^2 = \\frac{\\gamma p_2}{\\rho_2} \\quad (4) $$\n\n目标是找到一个用初始状态性质 $p_1$、$\\rho_1$（或等效地用 $a_1^2 = \\gamma p_1/\\rho_1$）、$\\gamma$ 和热释放 $q$ 表示的 $D_{CJ}^2$ 表达式。为实现此目标，我们必须消去未知的下游状态变量：压力 $p_2$、密度 $\\rho_2$ 和速度 $u_2$。\n\n首先，我们使用CJ条件 $(4)$ 来简化动量方程 $(2)$：\n$$ p_1 + \\rho_1 D^2 = p_2 + \\rho_2 \\left( \\frac{\\gamma p_2}{\\rho_2} \\right) = p_2 + \\gamma p_2 = p_2(1+\\gamma) $$\n由此，我们可以用 $D$ 和上游性质来表示下游压力 $p_2$：\n$$ p_2 = \\frac{p_1 + \\rho_1 D^2}{1+\\gamma} \\quad (5) $$\n\n接下来，我们使用方程 $(1)$ 和 $(4)$ 将 $\\rho_2$ 与其他变量联系起来。将质量守恒方程 $(1)$ 平方：\n$$ \\rho_1^2 D^2 = \\rho_2^2 u_2^2 $$\n代入CJ条件 $u_2^2 = \\gamma p_2/\\rho_2$：\n$$ \\rho_1^2 D^2 = \\rho_2^2 \\left( \\frac{\\gamma p_2}{\\rho_2} \\right) = \\gamma p_2 \\rho_2 $$\n这使我们能够将下游密度 $\\rho_2$ 表示为：\n$$ \\rho_2 = \\frac{\\rho_1^2 D^2}{\\gamma p_2} \\quad (6) $$\n\n现在我们有了用 $D$ 和彼此表示的 $p_2$ 和 $\\rho_2$ 的表达式。我们可以将它们组合起来求出比值 $p_2/\\rho_2$：\n$$ \\frac{p_2}{\\rho_2} = p_2 \\left( \\frac{1}{\\rho_2} \\right) = p_2 \\left( \\frac{\\gamma p_2}{\\rho_1^2 D^2} \\right) = \\frac{\\gamma p_2^2}{\\rho_1^2 D^2} $$\n代入 $(5)$ 中的 $p_2$ 表达式：\n$$ \\frac{p_2}{\\rho_2} = \\frac{\\gamma}{\\rho_1^2 D^2} \\left( \\frac{p_1 + \\rho_1 D^2}{1+\\gamma} \\right)^2 = \\frac{\\gamma (p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2 (1+\\gamma)^2} \\quad (7) $$\n\n最后一步是使用能量方程 $(3)$。我们可以利用CJ条件 $u_2^2 = \\gamma p_2/\\rho_2$ 来简化其右侧：\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}\\gamma\\frac{p_2}{\\rho_2} = \\left( \\frac{\\gamma}{\\gamma-1} + \\frac{\\gamma}{2} \\right) \\frac{p_2}{\\rho_2} $$\n$$ = \\left( \\frac{2\\gamma + \\gamma(\\gamma-1)}{2(\\gamma-1)} \\right) \\frac{p_2}{\\rho_2} = \\frac{\\gamma^2+\\gamma}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} $$\n于是能量方程变为：\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} \\quad (8) $$\n\n现在，我们将 $(7)$ 中的 $p_2/\\rho_2$ 表达式代入 $(8)$：\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\left[ \\frac{\\gamma (p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2 (1+\\gamma)^2} \\right] $$\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma-1)(1+\\gamma)} \\frac{(p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2} $$\n为简化起见，我们引入上游声速的平方，$a_1^2 = \\gamma p_1/\\rho_1$，这意味着 $p_1/\\rho_1 = a_1^2/\\gamma$。\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{a_1^2}{\\gamma} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma^2-1)} \\frac{(\\rho_1 a_1^2/\\gamma + \\rho_1 D^2)^2}{\\rho_1^2 D^2} $$\n$$ \\frac{a_1^2}{\\gamma-1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma^2-1)} \\frac{\\rho_1^2 (a_1^2/\\gamma + D^2)^2}{\\rho_1^2 D^2} = \\frac{1}{2(\\gamma^2-1)} \\frac{(a_1^2 + \\gamma D^2)^2}{D^2} $$\n这是关于 $D$ 的一个单一的代数方程，也正是题目要求得到的。从现在起，$D$ 特指 CJ 速度 $D_{CJ}$。令 $X = D_{CJ}^2$。\n$$ \\frac{a_1^2}{\\gamma-1} + \\frac{X}{2} + q = \\frac{(a_1^2 + \\gamma X)^2}{2(\\gamma^2-1)X} $$\n为了求解 $X$，我们通过乘以 $2(\\gamma^2-1)X$ 来消去分母：\n$$ 2(\\gamma+1)X a_1^2 + (\\gamma^2-1)X^2 + 2(\\gamma^2-1)q X = (a_1^2 + \\gamma X)^2 $$\n$$ 2(\\gamma+1)X a_1^2 + (\\gamma^2-1)X^2 + 2(\\gamma^2-1)q X = (a_1^2)^2 + 2\\gamma a_1^2 X + \\gamma^2 X^2 $$\n整理关于 $X$ 的二次方程的各项：\n$$ X^2(\\gamma^2-1-\\gamma^2) + X(2(\\gamma+1)a_1^2 + 2(\\gamma^2-1)q - 2\\gamma a_1^2) - a_1^4 = 0 $$\n$$ -X^2 + X(2\\gamma a_1^2 + 2a_1^2 + 2(\\gamma^2-1)q - 2\\gamma a_1^2) - a_1^4 = 0 $$\n$$ -X^2 + 2(a_1^2 + (\\gamma^2-1)q)X - a_1^4 = 0 $$\n$$ X^2 - 2[a_1^2 + (\\gamma^2-1)q]X + a_1^4 = 0 $$\n这就是我们想要的关于 $X = D_{CJ}^2$ 的二次方程。我们使用二次方程求根公式 $X = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 来求解：\n$$ D_{CJ}^2 = \\frac{2[a_1^2 + (\\gamma^2-1)q] \\pm \\sqrt{4[a_1^2 + (\\gamma^2-1)q]^2 - 4a_1^4}}{2} $$\n$$ D_{CJ}^2 = [a_1^2 + (\\gamma^2-1)q] \\pm \\sqrt{[a_1^2 + (\\gamma^2-1)q]^2 - a_1^4} $$\n展开平方根下的项：\n$$ \\sqrt{(a_1^4 + 2a_1^2(\\gamma^2-1)q + ((\\gamma^2-1)q)^2) - a_1^4} = \\sqrt{2a_1^2(\\gamma^2-1)q + ((\\gamma^2-1)q)^2} $$\n$$ = \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$\n这给出了 $D_{CJ}^2$ 的两个可能解：\n$$ D_{CJ}^2 = a_1^2 + (\\gamma^2-1)q \\pm \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$\n这两个解对应于“强”CJ爆轰分支和“弱”（或病态的）CJ爆轰分支。物理上可实现的自持爆轰对应于较高的速度，即由正号给出。带有负号的解在大量热释放 ($q \\to \\infty$) 的极限情况下会导致非物理结果。因此，我们选择正根。\n\nChapman-Jouguet爆轰速度平方的最终闭式表达式为：\n$$ D_{CJ}^2 = a_1^2 + (\\gamma^2-1)q + \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$",
            "answer": "$$\\boxed{a_1^2 + (\\gamma^2-1)q + \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]}}$$"
        },
        {
            "introduction": "在确定了宏观爆轰速度后，我们转向Zeldovich-von Neumann-Döring (ZND) 模型所描述的微观波内结构。此练习聚焦于ZND结构的起点——前导激波。你将从基本守恒定律出发，推导并计算激波后（即von Neumann状态）的温度，此状态代表了整个爆轰波结构中的压力峰值，即著名的“冯诺依曼尖峰”，它为后续的化学反应区设定了初始条件。",
            "id": "4078300",
            "problem": "在 Zeldovich–von Neumann–Döring (ZND) 模型中，一个平面爆轰波以恒定速度 $D$ 传播进入一个初始热力学状态为 $(p_{0},T_{0})$ 的静止理想气体混合物中。紧随前导激波之后，假定化学组分不变（组分冻结），气体可被模拟为具有恒定热容比 $\\gamma$ 和气体常数 $R$ 的理想气体。上游混合物在实验室坐标系中是静止的，且激波速度满足 $D > \\sqrt{\\gamma R T_{0}}$，因此激波相对于上游状态是超声速的。\n\n从激波固定坐标系中的一维定常质量、动量和能量守恒定律出发，结合理想气体状态方程 $p=\\rho R T$ 和具有 $c_{p}=\\gamma R/(\\gamma-1)$ 的定热容理想气体焓关系式 $h=c_{p}T$，推导一个关于激波后瞬间下游温度 $T$ 的闭式表达式，该表达式应以 $(D,\\gamma,R,T_{0})$ 表示。请勿使用任何预先推导的激波跳跃关系式；推导过程必须从基本平衡方程和给定的状态方程开始。\n\n请明确陈述在 Zeldovich–von Neumann–Döring (ZND) 模型中，激波处组分保持冻结状态所依据的物理假设。\n\n请将最终温度以开尔文为单位，用包含 $(D,\\gamma,R,T_{0})$ 的单一解析表达式符号化表示。无需进行数值计算，也无需四舍五入。",
            "solution": "Zeldovich–von Neumann–Döring (ZND) 模型假设在一个前导流体动力学激波之后跟随着一个诱导区和反应区。在激波本身，化学源项是可忽略的，因此流动由气体动力学守恒定律和具有恒定热容比 $\\gamma$ 的理想气体状态方程所支配。\n\n我们在激波固定坐标系中进行分析。设上游（状态 $0$）为以速度 $u_{0}=D$ 朝向激波运动的静止气体，设下游（状态 $1$）为以速度 $u_{1}$ 离开激波的激波后状态。一维定常 Rankine–Hugoniot 条件如下：\n- 质量守恒：\n$$\\rho_{0} u_{0} = \\rho_{1} u_{1}。$$\n- 动量守恒：\n$$p_{0} + \\rho_{0} u_{0}^{2} = p_{1} + \\rho_{1} u_{1}^{2}。$$\n- 能量守恒：\n$$h_{0} + \\frac{u_{0}^{2}}{2} = h_{1} + \\frac{u_{1}^{2}}{2}。$$\n\n对于具有恒定 $\\gamma$ 的理想气体，我们有理想气体状态方程 $p=\\rho R T$ 和热容关系式 $h=c_{p}T$，其中 $c_{p}=\\gamma R/(\\gamma-1)$。上游声速为 $a_{0}=\\sqrt{\\gamma R T_{0}}$，上游马赫数为 $M_{0}=u_{0}/a_{0}=D/\\sqrt{\\gamma R T_{0}}$，根据假设 $M_{0}>1$。\n\n我们引入速度比\n$$r \\equiv \\frac{u_{1}}{u_{0}}。$$\n根据质量守恒，\n$$\\frac{\\rho_{1}}{\\rho_{0}} = \\frac{u_{0}}{u_{1}} = \\frac{1}{r}。$$\n根据动量守恒，整理得到\n$$p_{1}-p_{0} = \\rho_{0} u_{0} (u_{0}-u_{1})。$$\n两边同除以 $p_{0}$ 并使用 $p_{0}=\\rho_{0} a_{0}^{2}/\\gamma$ 可得\n$$\\frac{p_{1}}{p_{0}} - 1 = \\gamma \\frac{u_{0}(u_{0}-u_{1})}{a_{0}^{2}} = \\gamma \\left(\\frac{u_{0}}{a_{0}}\\right)^{2} \\left(1 - \\frac{u_{1}}{u_{0}}\\right) = \\gamma M_{0}^{2} (1 - r),$$\n因此\n$$\\frac{p_{1}}{p_{0}} = 1 + \\gamma M_{0}^{2} (1 - r)。$$\n\n根据能量守恒，使用 $h=c_{p}T$ 和 $c_{p}=\\gamma R/(\\gamma-1)$，\n$$c_{p}(T_{1}-T_{0}) = \\frac{u_{0}^{2}-u_{1}^{2}}{2},$$\n因此\n$$\\frac{T_{1}}{T_{0}} - 1 = \\frac{u_{0}^{2}-u_{1}^{2}}{2 c_{p} T_{0}} = \\frac{u_{0}^{2}-u_{1}^{2}}{2} \\cdot \\frac{\\gamma - 1}{\\gamma R T_{0}}。$$\n利用 $a_{0}^{2}=\\gamma R T_{0}$，上式变为\n$$\\frac{T_{1}}{T_{0}} = 1 + \\frac{\\gamma - 1}{2} \\left(\\frac{u_{0}}{a_{0}}\\right)^{2} \\left[1 - \\left(\\frac{u_{1}}{u_{0}}\\right)^{2}\\right] = 1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2})。$$\n\n理想气体关系式给出\n$$\\frac{p_{1}}{p_{0}} = \\frac{\\rho_{1} R T_{1}}{\\rho_{0} R T_{0}} = \\frac{\\rho_{1}}{\\rho_{0}} \\frac{T_{1}}{T_{0}} = \\frac{1}{r} \\frac{T_{1}}{T_{0}}。$$\n将此式与由动量方程推导出的 $p_{1}/p_{0}$ 表达式相等，得到\n$$\\frac{1}{r} \\left[1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2})\\right] = 1 + \\gamma M_{0}^{2} (1 - r)。$$\n两边乘以 $r$ 得到一个关于 $r$ 的二次方程：\n$$1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2}) = r + \\gamma M_{0}^{2} r (1 - r)。$$\n合并同类项，\n$$\\frac{\\gamma + 1}{2} M_{0}^{2} r^{2} - \\left[1 + \\gamma M_{0}^{2}\\right] r + \\left[1 + \\frac{\\gamma - 1}{2} M_{0}^{2}\\right] = 0。$$\n解这个二次方程，物理上相关的（压缩激波）根是\n$$r = \\frac{(\\gamma - 1) M_{0}^{2} + 2}{(\\gamma + 1) M_{0}^{2}},$$\n而另一个根 $r=1$ 对应于平凡的无激波解。\n\n在 $r$ 已知的情况下，压力比可得\n$$\\frac{p_{1}}{p_{0}} = 1 + \\frac{2 \\gamma}{\\gamma + 1} (M_{0}^{2} - 1),$$\n密度比为\n$$\\frac{\\rho_{1}}{\\rho_{0}} = \\frac{(\\gamma + 1) M_{0}^{2}}{(\\gamma - 1) M_{0}^{2} + 2}。$$\n因此温度比为\n$$\\frac{T_{1}}{T_{0}} = \\frac{p_{1}/p_{0}}{\\rho_{1}/\\rho_{0}} = \\left[1 + \\frac{2 \\gamma}{\\gamma + 1} (M_{0}^{2} - 1)\\right] \\left[\\frac{(\\gamma - 1) M_{0}^{2} + 2}{(\\gamma + 1) M_{0}^{2}}\\right]。$$\n将 $M_{0}^{2} = D^{2}/(\\gamma R T_{0})$ 代入，得到紧邻激波后的下游温度：\n$$T_{1} = T_{0} \\left( 1 + \\frac{2 \\gamma}{\\gamma + 1} \\left( \\frac{D^{2}}{\\gamma R T_{0}} - 1 \\right) \\right) \\left( \\frac{ (\\gamma - 1) \\frac{D^{2}}{\\gamma R T_{0}} + 2 }{ (\\gamma + 1) \\frac{D^{2}}{\\gamma R T_{0}} } \\right)。$$\n这个 $T_{1}$ 是 Zeldovich–von Neumann–Döring (ZND) 爆轰中，在激波前后组分冻结的假设下，紧邻前导激波后的温度。\n\n在 Zeldovich–von Neumann–Döring (ZND) 模型中，激波处组分保持冻结的物理假设如下：\n- 激波厚度 $\\delta_{s}$ 是微观尺度的，气体穿过激波的对流驻留时间 $\\tau_{s} \\sim \\delta_{s}/u_{0}$ 远小于特征化学诱导时间 $\\tau_{\\chi}$，因此基于激波的 Damköhler 数 $Da_{\\delta_{s}} \\equiv \\tau_{s}/\\tau_{\\chi}$ 满足 $Da_{\\delta_{s}} \\ll 1$；等价地说，在穿越激波的过程中化学源项可忽略不计。\n- 在激波处，热化学状态由单一的平动-转动温度描述，振动和电子激发在 $\\tau_{s}$ 时间内不会导致净组分变化；比热和 $\\gamma$ 在穿越激波过程中可被视为常数。\n- 在激波厚度范围内，没有外部热量添加、体积力或辐射；激波过程是绝热和一维的。\n- 混合物在上游是均匀的，并且在激波过程中保持单一理想气体相，因此 $p=\\rho R T$ 和 $h=c_{p} T$ 适用。\n- 前导激波是流体动力学的、非反应的；反应仅在下游的诱导区发生，在该区域中，激波后的温度和压力历史控制着点火过程。\n\n在这些假设下，紧邻激波后的下游状态是上文给出的冻结正激波状态，它在 Zeldovich–von Neumann–Döring (ZND) 爆轰结构中充当 von Neumann 状态。",
            "answer": "$$\\boxed{T_{0}\\left(1+\\frac{2\\gamma}{\\gamma+1}\\left(\\frac{D^{2}}{\\gamma R T_{0}}-1\\right)\\right)\\left(\\frac{(\\gamma-1)\\,\\frac{D^{2}}{\\gamma R T_{0}}+2}{(\\gamma+1)\\,\\frac{D^{2}}{\\gamma R T_{0}}}\\right)}$$"
        },
        {
            "introduction": "前述的解析推导为了简化问题，采用了理想化的假设。本练习将带你从理论走向实践，构建一个计算真实气体混合物CJ爆轰速度的数值程序。你将学习如何将守恒定律与复杂化学平衡计算相结合，通过迭代求解，确定包含多种组分（如氢气-空气）的预混气体的CJ状态和爆轰速度。这是计算燃烧学领域一项核心的工程计算技能。",
            "id": "4078289",
            "problem": "要求您实现一个程序，通过求解 Zeldovich–von Neumann–Döring (ZND) 稳态一维跳跃条件，并结合波后状态的化学平衡以及强制执行 Chapman–Jouguet 声速条件，来计算预混、多组分燃料-氧化剂系统的 Chapman–Jouguet (CJ) 爆轰速度。该实现必须使用一个简化但自洽的热化学模型和一个鲁棒的数值求解器。\n\n从以下基本基础和模型假设开始：\n\n- 理想气体混合物，每种组分的比热为冻结值，混合物性质通过质量分数平均获得。\n- 质量、动量和总焓在附着于爆轰波前的稳态平面控制体上守恒。\n- 下游状态的化学平衡由单一可逆反应的平衡常数确定，标准态压力为 $1\\ \\mathrm{bar}$。\n- Chapman–Jouguet (CJ) 条件实现为下游相对于波阵面的声速流动条件。\n- 上游气体在实验室坐标系中是静止的；因此，爆轰速度等于波固定坐标系中的上游流速。\n\n数学公式：\n\n1.  令上游状态由下标 $1$ 表示，下游平衡状态由下标 $2$ 表示。令质量通量为 $m$ (单位 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$)。在波固定坐标系中，上游速度为 $u_1 = m/\\rho_1$，下游速度为 $u_2 = m/\\rho_2$，其中 $\\rho$ 表示密度。\n\n2.  跨控制体的守恒关系得出：\n    -   质量：$m = \\rho_1 u_1 = \\rho_2 u_2$。\n    -   动量 (Rayleigh 线)：$p_2 - p_1 = m^2\\left(\\dfrac{1}{\\rho_1} - \\dfrac{1}{\\rho_2}\\right)$。\n    -   总焓：$h_2 - h_1 + \\dfrac{1}{2}\\left(u_2^2 - u_1^2\\right) = 0$。\n\n3.  CJ 声速条件为\n    $$u_2 = a_2,$$\n    其中 $a_2$ 是下游状态下平衡产物混合物的冻结声速，计算公式为\n    $$a_2 = \\sqrt{\\gamma_2 R_2 T_2},\\quad \\gamma_2 = \\dfrac{c_{p,2}}{c_{p,2} - R_2},$$\n    其中 $R_2$ 是混合物气体常数，$c_{p,2}$ 是混合物定压比热。\n\n4.  组分集限定为 $\\{\\mathrm{H_2},\\ \\mathrm{O_2},\\ \\mathrm{H_2O},\\ \\mathrm{N_2}\\}$。状态 $2$ 的化学平衡由单一可逆反应决定\n    $$\\mathrm{H_2} + \\dfrac{1}{2}\\,\\mathrm{O_2} \\rightleftharpoons \\mathrm{H_2O},$$\n    使用在标准压力 $p^\\circ = 1\\ \\mathrm{bar}$ 下的平衡常数 $K_p(T)$。定义反应进度 $\\xi$ (在选定的摩尔基础上，单位为摩尔)。给定每种组分 $k$ 的初始上游摩尔数 $n_k^0$，下游平衡摩尔数为\n    $$n_{\\mathrm{H_2}} = n_{\\mathrm{H_2}}^0 - \\xi,\\quad n_{\\mathrm{O_2}} = n_{\\mathrm{O_2}}^0 - \\dfrac{1}{2}\\xi,\\quad n_{\\mathrm{H_2O}} = n_{\\mathrm{H_2O}}^0 + \\xi,\\quad n_{\\mathrm{N_2}} = n_{\\mathrm{N_2}}^0,$$\n    其允许区间为 $0 \\le \\xi \\le \\min\\left(n_{\\mathrm{H_2}}^0, 2 n_{\\mathrm{O_2}}^0\\right)$。令 $y_i = n_i / \\sum_j n_j$ 为摩尔分数，令 $p$ 为总压力。平衡条件通过以下方式强制执行\n    $$K_p(T) = \\dfrac{y_{\\mathrm{H_2O}}}{y_{\\mathrm{H_2}}\\, y_{\\mathrm{O_2}}^{1/2}} \\left(\\dfrac{p}{p^\\circ}\\right)^{-1/2}。$$\n\n5.  热化学模型和常数：\n    -   普适气体常数 $R_u = 8.314462618\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，标准态压力 $p^\\circ = 1.0\\times 10^5\\ \\mathrm{Pa}$。\n    -   摩尔质量 (单位 $\\mathrm{kg}\\,\\mathrm{mol}^{-1}$)：$W_{\\mathrm{H_2}} = 2.01588\\times 10^{-3}$，$W_{\\mathrm{O_2}} = 3.1998\\times 10^{-2}$，$W_{\\mathrm{H_2O}} = 1.8015\\times 10^{-2}$，$W_{\\mathrm{N_2}} = 2.8013\\times 10^{-2}$。\n    -   恒定摩尔热容 $c_{p,k}$ (单位 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$)，假定与温度无关：$c_{p,\\mathrm{H_2}} = 28.84$，$c_{p,\\mathrm{O_2}} = 29.36$，$c_{p,\\mathrm{H_2O}} = 33.58$，$c_{p,\\mathrm{N_2}} = 29.12$。\n    -   在 $T^\\circ = 298\\ \\mathrm{K}$ 时的标准摩尔生成焓 (单位 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$)：$h_{f,\\mathrm{H_2}}^\\circ = 0$，$h_{f,\\mathrm{O_2}}^\\circ = 0$，$h_{f,\\mathrm{H_2O}}^\\circ = -2.41826\\times 10^5$，$h_{f,\\mathrm{N_2}}^\\circ = 0$。\n    -   在 $T^\\circ = 298\\ \\mathrm{K}$ 和 $p^\\circ$ 时的标准绝对摩尔熵 (单位 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$)：$S^\\circ_{\\mathrm{H_2}} = 130.68$，$S^\\circ_{\\mathrm{O_2}} = 205.152$，$S^\\circ_{\\mathrm{H_2O}} = 188.83$。\n    -   平衡常数通过恒定性质的 van ’t Hoff 模型进行评估，使用在 $T^\\circ$ 下的反应热化学：\n        $$\\Delta H^\\circ = h_{f,\\mathrm{H_2O}}^\\circ - h_{f,\\mathrm{H_2}}^\\circ - \\dfrac{1}{2}h_{f,\\mathrm{O_2}}^\\circ,$$\n        $$\\Delta S^\\circ = S^\\circ_{\\mathrm{H_2O}} - S^\\circ_{\\mathrm{H_2}} - \\dfrac{1}{2}S^\\circ_{\\mathrm{O_2}},$$\n        $$\\Delta G^\\circ(T) = \\Delta H^\\circ - T\\,\\Delta S^\\circ,\\quad K_p(T) = \\exp\\!\\left(-\\dfrac{\\Delta G^\\circ(T)}{R_u T}\\right)。$$\n    -   组分显焓建模为 $h_{s,k}(T) = c_{p,k}\\,(T - T^\\circ)$，从而得出基于质量的组分总比焓 $h_k(T) = \\dfrac{h_{f,k}^\\circ}{W_k} + \\dfrac{c_{p,k}}{W_k}\\,(T - T^\\circ)$。混合物性质使用质量分数平均值 $Y_k$。\n\n6.  混合物热力学关系：\n    -   混合物气体常数 $R = \\sum_k Y_k\\,R_k$，其中 $R_k = R_u/W_k$。\n    -   混合物热容 $c_p = \\sum_k Y_k\\,c_{p,k}/W_k$；然后 $c_v = c_p - R$ 且 $\\gamma = c_p / c_v$。\n    -   密度 $\\rho = \\dfrac{p}{R T}$。\n\n7.  通过与空气的当量比来指定上游混合物：令当量比为 $\\phi$。使用摩尔基准，其中 $n_{\\mathrm{H_2}}^0 = 1$，$n_{\\mathrm{O_2}}^0 = \\dfrac{1}{2\\phi}$，$n_{\\mathrm{N_2}}^0 = 3.76\\,n_{\\mathrm{O_2}}^0$，$n_{\\mathrm{H_2O}}^0 = 0$。这定义了用于计算在给定上游压力和温度下未反应上游混合物性质的组分。\n\n数值任务：\n\n-   对于每个测试用例，将未知数视为 $(p_2, T_2, m)$，并求解由动量方程、能量方程和 CJ 声速条件组成的耦合系统。在每次评估中，通过求解满足给定上游原子库存的平衡常数条件的反应进度 $\\xi$，来确定下游的平衡组分。使用此组分计算下游混合物性质并闭合守恒关系。爆轰速度为 $D = u_1 = m/\\rho_1$，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n测试套件：\n\n提供代码，使用上述模型和常数计算以下上游条件的 $D$。每个案例指定 $(p_1,\\ T_1,\\ \\phi)$。\n\n-   案例 A (化学计量氢气-空气)：$p_1 = 1.01325\\times 10^5\\ \\mathrm{Pa}$，$T_1 = 300\\ \\mathrm{K}$，$\\phi = 1.0$。\n-   案例 B (贫燃，氢气-空气)：$p_1 = 1.01325\\times 10^5\\ \\mathrm{Pa}$，$T_1 = 300\\ \\mathrm{K}$，$\\phi = 0.5$。\n-   案例 C (富燃，氢气-空气)：$p_1 = 1.01325\\times 10^5\\ \\mathrm{Pa}$，$T_1 = 300\\ \\mathrm{K}$，$\\phi = 1.5$。\n-   案例 D (化学计量，更冷)：$p_1 = 1.01325\\times 10^5\\ \\mathrm{Pa}$，$T_1 = 250\\ \\mathrm{K}$，$\\phi = 1.0$。\n\n所需输出：\n\n-   对于每个案例，返回 CJ 爆轰速度 $D$，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，四舍五入到一位小数。\n-   您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序为 [案例 A, 案例 B, 案例 C, 案例 D]，例如，\"[2000.0,1800.5,1900.2,1950.1]\"。",
            "solution": "该问题要求计算预混氢气-空气系统的 Chapman–Jouguet (CJ) 爆轰速度。这是通过求解稳态一维 Zeldovich–von Neumann–Döring (ZND) 守恒方程，并辅以化学平衡在下游状态的条件以及 CJ 声速流准则来实现的。热化学模型被简化，假设为具有恒定比热的理想气体。\n\n首先，整理给定的数据和常数。\n- **普适气体常数**: $R_u = 8.314462618\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- **标准态**: $p^\\circ = 1.0\\times 10^5\\ \\mathrm{Pa}$，$T^\\circ = 298\\ \\mathrm{K}$\n- **组分数据**: 组分集为 $\\{\\mathrm{H_2}, \\mathrm{O_2}, \\mathrm{H_2O}, \\mathrm{N_2}\\}$。提供了它们的摩尔质量 ($W_k$)、恒定摩尔热容 ($c_{p,k}$)、标准摩尔生成焓 ($h_{f,k}^\\circ$) 和标准绝对摩尔熵 ($S_k^\\circ$)。\n\n该问题是有效的，因为它在科学上基于已建立的燃烧理论，具有足够数量的方程来求解未知数，并且所有必要的数据都已客观定义。\n\n解决方法涉及为爆轰后状态构建一个非线性方程组并进行数值求解。\n\n**1. 控制方程的构建**\n令状态 $1$ 代表未反应的上游气体，状态 $2$ 代表反应后的下游平衡气体。跨越静止爆轰波的质量、动量和能量守恒由 Rankine–Hugoniot 跳跃条件给出：\n- **质量守恒**: 质量通量 $m$ 是恒定的。\n$$m = \\rho_1 u_1 = \\rho_2 u_2$$\n其中 $\\rho$ 是密度，$u$ 是波固定坐标系中的流速。\n- **动量守恒** (Rayleigh 线):\n$$p_2 - p_1 = m (u_1 - u_2)$$\n- **总焓守恒** (Hugoniot 关系式):\n$$h_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2$$\n其中 $p$ 是压力，$h$ 是比焓 (基于质量)。\n\n该系统通过 **Chapman–Jouguet (CJ) 条件**进行闭合，该条件假设下游状态的流动相对于波是声速的：\n$$u_2 = a_2$$\n其中 $a_2$ 是产物混合物中的冻结声速，定义为：\n$$a_2 = \\sqrt{\\gamma_2 R_2 T_2}$$\n这里，$T_2$ 是下游温度，$R_2$ 是混合物的比气体常数，$\\gamma_2$ 是状态 $2$ 时混合物的比热比。\n\n实验室坐标系中的爆轰速度 $D$ 等于波固定坐标系中的上游流速 $u_1$，因为上游气体是静止的。\n$$D = u_1 = \\frac{m}{\\rho_1}$$\n\n**2. 热化学状态与平衡**\n\n任何状态下气体混合物的性质（例如密度 $\\rho$、比焓 $h$、气体常数 $R$、比热比 $\\gamma$）都取决于其组分、温度和压力。\n\n**上游状态 (1)**: 组分由当量比 $\\phi$ 决定，对于反应 $\\mathrm{H_2} + \\frac{1}{2}\\mathrm{O_2} \\to \\mathrm{H_2O}$ 在空气中（近似为 $1\\,\\mathrm{O_2} : 3.76\\,\\mathrm{N_2}$）。以燃料为单位进行归一化的摩尔基础上，初始摩尔数 $n_k^0$ 为：\n$$n_{\\mathrm{H_2}}^0 = 1, \\quad n_{\\mathrm{O_2}}^0 = \\frac{1}{2\\phi}, \\quad n_{\\mathrm{N_2}}^0 = 3.76 \\times n_{\\mathrm{O_2}}^0 = \\frac{1.88}{\\phi}, \\quad n_{\\mathrm{H_2O}}^0 = 0$$\n给定上游压力 $p_1$ 和温度 $T_1$，未反应混合物的所有热力学性质（例如 $\\rho_1, h_1$）都可以直接计算。\n\n**下游状态 (2)**: 状态 $2$ 的组分由单一反应 $\\mathrm{H_2} + \\frac{1}{2}\\,\\mathrm{O_2} \\rightleftharpoons \\mathrm{H_2O}$ 的化学平衡决定。我们定义反应进度 $\\xi$ 为在初始摩尔基础上反应的 $\\mathrm{H_2}$ 的摩尔数。平衡时的摩尔数为：\n$$n_{\\mathrm{H_2}} = n_{\\mathrm{H_2}}^0 - \\xi, \\quad n_{\\mathrm{O_2}} = n_{\\mathrm{O_2}}^0 - \\frac{1}{2}\\xi, \\quad n_{\\mathrm{H_2O}} = n_{\\mathrm{H_2O}}^0 + \\xi, \\quad n_{\\mathrm{N_2}} = n_{\\mathrm{N_2}}^0$$\n平衡时的总摩尔数为 $N_2 = \\sum n_k = N_1 - \\frac{1}{2}\\xi$，其中 $N_1 = \\sum n_k^0$。摩尔分数为 $y_k = n_k/N_2$。\n平衡条件将摩尔分数与平衡常数 $K_p(T_2)$ 联系起来：\n$$K_p(T_2) = \\frac{y_{\\mathrm{H_2O}}}{y_{\\mathrm{H_2}} y_{\\mathrm{O_2}}^{1/2}} \\left(\\frac{p_2}{p^\\circ}\\right)^{-1/2}$$\n平衡常数通过具有恒定比热的 van 't Hoff 方程进行建模：\n$$K_p(T) = \\exp\\left(-\\frac{\\Delta G^\\circ(T)}{R_u T}\\right) = \\exp\\left(-\\frac{\\Delta H^\\circ - T\\Delta S^\\circ}{R_u T}\\right)$$\n其中 $\\Delta H^\\circ$ 和 $\\Delta S^\\circ$ 分别是标准反应焓和反应熵，根据给定的组分标准态性质计算得出。对于给定的 $(p_2, T_2)$ 对，摩尔分数 $y_k$ 取决于未知数 $\\xi$。因此，平衡方程成为一个关于 $\\xi$ 的非线性方程，必须进行数值求解。\n\n**3. 数值求解算法**\n\n问题简化为寻找状态 $(p_2, T_2)$ 和质量通量 $m$，使其同时满足守恒方程和 CJ 条件。我们为三个未知数 $\\mathbf{x} = [p_2, T_2, m]^T$ 建立一个包含三个非线性方程的系统。\n\n待求解的残差方程组为 $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$：\n$$F_1(p_2, T_2, m) = p_2 - p_1 - m^2\\left(\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2}\\right) = 0$$\n$$F_2(p_2, T_2, m) = h_2 - h_1 + \\frac{1}{2}\\left(\\left(\\frac{m}{\\rho_2}\\right)^2 - \\left(\\frac{m}{\\rho_1}\\right)^2\\right) = 0$$\n$$F_3(p_2, T_2, m) = \\frac{m}{\\rho_2} - a_2 = 0$$\n\n每个测试用例 $(p_1, T_1, \\phi)$ 的数值程序如下：\n1.  **初始化**: 根据初始条件计算上游状态 $1$ 的所有性质（例如组分、$\\rho_1, h_1$）。\n2.  **定义系统**: 构建残差函数 $\\mathbf{F}(\\mathbf{x})$。在试验状态 $\\mathbf{x} = [p_2, T_2, m]^T$ 下评估此函数需要一个内部计算：\n    a.  **平衡子问题**: 给定试验的 $(p_2, T_2)$，求解关于反应进度 $\\xi$ 的非线性平衡方程。这可以使用鲁棒的求根方法，如 Brent 方法 (`scipy.optimize.brentq`)，在区间 $0 \\le \\xi \\le \\min(n_{\\mathrm{H_2}}^0, 2n_{\\mathrm{O_2}}^0)$ 上进行。\n    b.  **下游性质**: 使用确定的 $\\xi$ 值，计算平衡组分（摩尔分数和质量分数），并随后计算下游状态 $2$ 的所有所需热力学性质（$\\rho_2, h_2, a_2$ 等）。\n    c.  **残差计算**: 将计算出的下游性质代入三个方程 $F_1, F_2, F_3$ 中，以获得残差向量。\n3.  **求根**: 使用多变量非线性求解器（例如 `scipy.optimize.root`）找到使残差向量 $\\mathbf{F}(\\mathbf{x})$ 为零的根 $\\mathbf{x}^* = [p_2^*, T_2^*, m^*]^T$。为求解器选择一个合适的初始猜测值对于收敛至关重要（例如，$p_2 \\approx 20 p_1$，$T_2 \\approx 3000\\ \\mathrm{K}$，$m \\approx 2000\\ \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）。\n4.  **最终计算**: 一旦求解器收敛到 $m^*$，使用质量通量和上游密度计算 CJ 爆轰速度：\n    $$D = \\frac{m^*}{\\rho_1}$$\n以下代码实现了此算法，以解决四个指定的测试用例。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root, brentq\n\ndef solve():\n    \"\"\"\n    Main function to compute CJ detonation speeds for the specified test cases.\n    \"\"\"\n\n    # --- Thermochemical Constants and Species Data ---\n    CONST = {\n        'R_u': 8.314462618,  # J/mol/K, Universal gas constant\n        'p_std': 1.0e5,      # Pa, Standard pressure\n        'T_std': 298.0,      # K, Standard temperature\n    }\n\n    SPECIES_DATA = {\n        # W: kg/mol, cp_mol: J/mol/K, h_f_mol: J/mol, S_std_mol: J/mol/K\n        'H2':  {'W': 2.01588e-3, 'cp_mol': 28.84, 'h_f_mol': 0.0,       'S_std_mol': 130.68},\n        'O2':  {'W': 3.1998e-2,  'cp_mol': 29.36, 'h_f_mol': 0.0,       'S_std_mol': 205.152},\n        'H2O': {'W': 1.8015e-2,  'cp_mol': 33.58, 'h_f_mol': -2.41826e5,'S_std_mol': 188.83},\n        'N2':  {'W': 2.8013e-2,  'cp_mol': 29.12, 'h_f_mol': 0.0,       'S_std_mol': 0.0},\n    }\n    \n    # Pre-calculate standard reaction enthalpy and entropy for H2 + 0.5 O2 -> H2O\n    h_f, S_std = SPECIES_DATA['H2O']['h_f_mol'], SPECIES_DATA['H2O']['S_std_mol']\n    h_f -= SPECIES_DATA['H2']['h_f_mol'] + 0.5 * SPECIES_DATA['O2']['h_f_mol']\n    S_std -= SPECIES_DATA['H2']['S_std_mol'] + 0.5 * SPECIES_DATA['O2']['S_std_mol']\n    CONST['delta_H_rxn_std'] = h_f\n    CONST['delta_S_rxn_std'] = S_std\n\n    species_list = ['H2', 'O2', 'H2O', 'N2']\n\n    def get_mixture_properties(p, T, moles, species_data, constants):\n        \"\"\"Calculates thermodynamic properties for a given mixture composition.\"\"\"\n        if np.sum(moles) = 0:\n            raise ValueError(\"Total moles must be positive.\")\n        \n        mole_fracs = moles / np.sum(moles)\n        \n        W_mix = np.sum(mole_fracs * np.array([species_data[k]['W'] for k in species_list]))\n        mass_fracs = mole_fracs * np.array([species_data[k]['W'] for k in species_list]) / W_mix\n        \n        R_mix = constants['R_u'] / W_mix\n        \n        cp_mix_mass = np.sum(mass_fracs * np.array([species_data[k]['cp_mol'] / species_data[k]['W'] for k in species_list]))\n        cv_mix_mass = cp_mix_mass - R_mix\n        gamma = cp_mix_mass / cv_mix_mass if cv_mix_mass > 0 else np.inf\n        \n        h_mix = 0.0\n        for i, sp in enumerate(species_list):\n            sd = species_data[sp]\n            h_k = sd['h_f_mol'] / sd['W'] + (sd['cp_mol'] / sd['W']) * (T - constants['T_std'])\n            h_mix += mass_fracs[i] * h_k\n            \n        rho = p / (R_mix * T)\n        sound_speed = np.sqrt(gamma * R_mix * T)\n        \n        return {\n            'rho': rho, 'h_mass': h_mix, 'a': sound_speed, 'R': R_mix, 'gamma': gamma,\n            'moles': moles, 'mole_fracs': mole_fracs, 'mass_fracs': mass_fracs, 'W_mix': W_mix\n        }\n\n    def compute_detonation(p1, T1, phi):\n        \"\"\"Computes the CJ detonation properties for a given upstream state.\"\"\"\n        \n        # 1. Upstream State Calculation\n        n0_H2 = 1.0\n        n0_O2 = 1.0 / (2.0 * phi)\n        n0_N2 = 3.76 * n0_O2\n        n0_H2O = 0.0\n        initial_moles = np.array([n0_H2, n0_O2, n0_H2O, n0_N2])\n        \n        upstream_state = get_mixture_properties(p1, T1, initial_moles, SPECIES_DATA, CONST)\n\n        def get_downstream_state(p2, T2):\n            \"\"\"Solves for equilibrium composition and properties at the downstream state.\"\"\"\n            # Define residual for equilibrium calculation\n            def equil_residual(xi):\n                # Calculate moles at extent of reaction xi\n                moles_eq = np.array([initial_moles[0] - xi, \n                                     initial_moles[1] - 0.5 * xi, \n                                     initial_moles[2] + xi, \n                                     initial_moles[3]])\n                \n                if np.any(moles_eq  0): return 1e9 # Penalize non-physical xi\n\n                total_moles_eq = np.sum(moles_eq)\n                y = moles_eq / total_moles_eq if total_moles_eq > 0 else np.zeros(4)\n\n                # Avoid division by zero or log of zero\n                if y[0] = 0 or y[1] = 0: return -1e9\n\n                # Kp from partial pressures\n                kp_mole_fracs = (y[2]) / (y[0] * np.sqrt(y[1]))\n                kp_calc = kp_mole_fracs * (p2 / CONST['p_std'])**(-0.5)\n                \n                # Kp from van't Hoff\n                delta_g = CONST['delta_H_rxn_std'] - T2 * CONST['delta_S_rxn_std']\n                kp_thermo = np.exp(-delta_g / (CONST['R_u'] * T2))\n                \n                return kp_thermo - kp_calc\n\n            # Solve for equilibrium extent of reaction xi\n            xi_max = min(initial_moles[0], 2 * initial_moles[1])\n            # Use a small epsilon to avoid issues at bounds\n            try:\n                xi_eq = brentq(equil_residual, 1e-12, xi_max - 1e-12, xtol=1e-12, rtol=1e-12)\n            except ValueError:\n                # If root is not bracketed, solver might fail. Return error state.\n                raise RuntimeError(\"Equilibrium solver failed to bracket the root.\")\n\n            moles_eq = np.array([initial_moles[0] - xi_eq, \n                                 initial_moles[1] - 0.5 * xi_eq, \n                                 initial_moles[2] + xi_eq, \n                                 initial_moles[3]])\n            \n            return get_mixture_properties(p2, T2, moles_eq, SPECIES_DATA, CONST)\n\n        # 2. Define residual function for the main CJ solver\n        def cj_residual(x):\n            p2, T2, m = x\n\n            if T2 = 0 or p2 = 0 or m = 0:\n                return [1e9, 1e9, 1e9]\n            \n            try:\n                downstream_state = get_downstream_state(p2, T2)\n            except (ValueError, RuntimeError, OverflowError):\n                return [1e9, 1e9, 1e9]\n                \n            rho1, h1 = upstream_state['rho'], upstream_state['h_mass']\n            rho2, h2, a2 = downstream_state['rho'], downstream_state['h_mass'], downstream_state['a']\n\n            u1 = m / rho1\n            u2 = m / rho2\n\n            # Conservation equations and CJ condition\n            res1 = p2 - p1 - m * (u1 - u2)\n            res2 = h2 - h1 + 0.5 * (u2**2 - u1**2)\n            res3 = u2 - a2\n            \n            return [res1, res2, res3]\n\n        # 3. Solve the system\n        # Initial guess: [p2 (Pa), T2 (K), m (kg/m^2/s)]\n        p2_guess = 18 * p1\n        T2_guess = 3000.0\n        m_guess = 2000.0 * upstream_state['rho']\n        initial_guess = [p2_guess, T2_guess, m_guess]\n        \n        sol = root(cj_residual, initial_guess, method='hybr', tol=1e-9)\n\n        if not sol.success:\n            raise RuntimeError(f\"CJ solver failed for p1={p1}, T1={T1}, phi={phi}: {sol.message}\")\n\n        # 4. Calculate detonation speed D\n        m_sol = sol.x[2]\n        D = m_sol / upstream_state['rho']\n        \n        return D\n\n    # --- Test Cases ---\n    test_cases = [\n        # (p1, T1, phi)\n        (1.01325e5, 300.0, 1.0), # Case A\n        (1.01325e5, 300.0, 0.5), # Case B\n        (1.01325e5, 300.0, 1.5), # Case C\n        (1.01325e5, 250.0, 1.0), # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        p1_case, T1_case, phi_case = case\n        D_cj = compute_detonation(p1_case, T1_case, phi_case)\n        results.append(f\"{D_cj:.1f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}