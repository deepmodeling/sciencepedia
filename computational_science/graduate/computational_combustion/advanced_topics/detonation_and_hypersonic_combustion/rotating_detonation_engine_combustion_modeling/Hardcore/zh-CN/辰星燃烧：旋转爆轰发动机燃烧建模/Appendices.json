{
    "hands_on_practices": [
        {
            "introduction": "任何精确的燃烧模拟都始于一个正确的热力学模型。本练习旨在利用NASA多项式来表示多组分气体混合物的能量，这是一种处理与温度相关的比热的标准方法。通过此练习，您将从标准焓数据中推导内能等基本性质，并计算驱动爆轰波的最终能量来源——热释放（$Q$），为任何RDE模拟中的能量方程奠定基础 。",
            "id": "4059708",
            "problem": "旋转爆轰发动机需要对多组分反应气体的能量方程进行精确闭合。考虑一种热学性质完美但量热学性质不完美的混合物，其中各组分的热力学性质由美国国家航空航天局（NASA）的七系数多项式拟合表示。设混合物的状态由温度 $T$ 和 $N$ 个组分的质量分数向量 $\\mathbf{Y} = (Y_{1}, Y_{2}, \\dots, Y_{N})$ 定义。通用气体常数为 $R_{u}$，组分 $k$ 的摩尔质量为 $W_{k}$（其中 $k = 1, \\dots, N$）。对于每个组分 $k$，无量纲摩尔焓的 NASA 多项式表示为\n$$\n\\frac{h_{k}(T)}{R_{u} T} = a_{1,k} + a_{2,k} \\frac{T}{2} + a_{3,k} \\frac{T^{2}}{3} + a_{4,k} \\frac{T^{3}}{4} + a_{5,k} \\frac{T^{4}}{5} + \\frac{a_{6,k}}{T} + a_{7,k},\n$$\n在适用于当前温度 $T$ 的相应温度区间内有效。\n\n任务1（推导）：从混合物比焓和内能的定义以及上述 NASA 多项式形式出发，推导混合物内能 $e(T,\\mathbf{Y})$ 关于 $T$、$\\mathbf{Y}$、$R_{u}$、$W_{k}$ 和 NASA 系数 $a_{i,k}$ 的闭合表达式。\n\n任务2（应用于热释放）：在参考温度 $T_{\\mathrm{ref}}$ 下，单位质量的入射反应物混合物的爆轰热释放定义为在该参考温度下反应过程中的放热焓降，\n$$\nQ \\equiv -\\Delta h_{\\mathrm{rxn}}(T_{\\mathrm{ref}}),\n$$\n其中 $\\Delta h_{\\mathrm{rxn}}(T_{\\mathrm{ref}})$ 是在参考温度 $T_{\\mathrm{ref}}$ 和相同参考压力下，所有组分均处于 $T_{\\mathrm{ref}}$ 时计算出的混合物比焓变（产物减去反应物）。对于化学计量的氢气-空气混合物，考虑以下反应\n$$\n2\\,\\mathrm{H_{2}} + 1\\,\\mathrm{O_{2}} + \\left(\\frac{79}{21}\\right)\\,\\mathrm{N_{2}} \\;\\to\\; 2\\,\\mathrm{H_{2}O}} + \\left(\\frac{79}{21}\\right)\\,\\mathrm{N_{2}},\n$$\n其中 $\\mathrm{N_{2}}$ 被视为惰性气体。使用 $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}$。取参考温度 $T_{\\mathrm{ref}}$ 下的标准摩尔生成热为 $h_{f}^{0}(\\mathrm{H_{2}O(g)}) = -241.826\\ \\mathrm{kJ/mol}$，$h_{f}^{0}(\\mathrm{H_{2}}) = 0$，$h_{f}^{0}(\\mathrm{O_{2}}) = 0$ 和 $h_{f}^{0}(\\mathrm{N_{2}}) = 0$，摩尔质量为 $W_{\\mathrm{H_{2}}} = 2.01588\\ \\mathrm{g/mol}$，$W_{\\mathrm{O_{2}}} = 31.998\\ \\mathrm{g/mol}$ 和 $W_{\\mathrm{N_{2}}} = 28.0134\\ \\mathrm{g/mol}$。计算单位质量入射反应物混合物的 $Q$ 值。最终的 $Q$ 值以 $\\mathrm{kJ/kg}$ 为单位表示，并四舍五入到四位有效数字。\n\n将任务1和任务2的最终结果以单行矩阵的形式提供，其中第一个条目是推导出的 $e(T,\\mathbf{Y})$ 的解析表达式，第二个条目是 $Q$ 的四舍五入后的数值。",
            "solution": "该问题经验证具有科学依据、提法明确且客观。它提出了两个任务：首先，基于给定的焓的多项式表示，推导混合物内能的解析表达式；其次，计算特定化学反应的热释放。\n\n### 任务1：混合物内能 $e(T,\\mathbf{Y})$ 的推导\n\n目标是推导混合物比内能 $e(T,\\mathbf{Y})$ 的表达式，它是温度 $T$ 和组分质量分数向量 $\\mathbf{Y}$ 的函数。\n\n混合物的比内能是其组成组分比内能的质量加权和：\n$$\ne(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_{k} e_{\\text{specific}, k}(T)\n$$\n其中 $Y_k$ 是组分 $k$ 的质量分数，$e_{\\text{specific}, k}(T)$ 是其比内能（单位质量的能量）。\n\n组分 $k$ 的比内能通过其摩尔质量 $W_k$ 与其摩尔内能 $e_k(T)$（每摩尔的能量）相关联：\n$$\ne_{\\text{specific}, k}(T) = \\frac{e_{k}(T)}{W_k}\n$$\n因此，混合物比内能可以写为：\n$$\ne(T,\\mathbf{Y}) = \\sum_{k=1}^{N} \\frac{Y_{k}}{W_k} e_{k}(T)\n$$\n\n对于热学性质完美的气体，每个组分 $k$ 的摩尔焓 $h_k(T)$ 和摩尔内能 $e_k(T)$ 通过通用气体常数 $R_u$ 相关联：\n$$\nh_k(T) = e_k(T) + R_u T\n$$\n这使我们能够用摩尔焓来表示摩尔内能：\n$$\ne_k(T) = h_k(T) - R_u T\n$$\n\n问题给出了组分 $k$ 的无量纲摩尔焓的 NASA 多项式表示：\n$$\n\\frac{h_{k}(T)}{R_{u} T} = a_{1,k} + a_{2,k} \\frac{T}{2} + a_{3,k} \\frac{T^{2}}{3} + a_{4,k} \\frac{T^{3}}{4} + a_{5,k} \\frac{T^{4}}{5} + \\frac{a_{6,k}}{T} + a_{7,k}\n$$\n由此，我们可以写出摩尔焓 $h_k(T)$ 的表达式：\n$$\nh_k(T) = R_{u} T \\left( a_{1,k} + a_{2,k} \\frac{T}{2} + a_{3,k} \\frac{T^{2}}{3} + a_{4,k} \\frac{T^{3}}{4} + a_{5,k} \\frac{T^{4}}{5} + \\frac{a_{6,k}}{T} + a_{7,k} \\right)\n$$\n展开此表达式得到：\n$$\nh_k(T) = R_u \\left( a_{1,k}T + a_{2,k}\\frac{T^2}{2} + a_{3,k}\\frac{T^3}{3} + a_{4,k}\\frac{T^4}{4} + a_{5,k}\\frac{T^5}{5} + a_{6,k} + a_{7,k}T \\right)\n$$\n关于 $T$ 的线性项可以合并：\n$$\nh_k(T) = R_u \\left( (a_{1,k} + a_{7,k})T + a_{2,k}\\frac{T^2}{2} + a_{3,k}\\frac{T^3}{3} + a_{4,k}\\frac{T^4}{4} + a_{5,k}\\frac{T^5}{5} + a_{6,k} \\right)\n$$\n\n现在，我们将 $h_k(T)$ 的这个表达式代入 $e_k(T)$ 的关系式中：\n$$\ne_k(T) = R_u \\left( (a_{1,k} + a_{7,k})T + a_{2,k}\\frac{T^2}{2} + a_{3,k}\\frac{T^3}{3} + a_{4,k}\\frac{T^4}{4} + a_{5,k}\\frac{T^5}{5} + a_{6,k} \\right) - R_u T\n$$\n提出公因子 $R_u$ 并合并含 $T$ 的项：\n$$\ne_k(T) = R_u \\left( (a_{1,k} + a_{7,k} - 1)T + a_{2,k}\\frac{T^2}{2} + a_{3,k}\\frac{T^3}{3} + a_{4,k}\\frac{T^4}{4} + a_{5,k}\\frac{T^5}{5} + a_{6,k} \\right)\n$$\n按 $T$ 的幂次重新排列各项：\n$$\ne_k(T) = R_u \\left( a_{6,k} + (a_{1,k} + a_{7,k} - 1)T + a_{2,k}\\frac{T^2}{2} + a_{3,k}\\frac{T^3}{3} + a_{4,k}\\frac{T^4}{4} + a_{5,k}\\frac{T^5}{5} \\right)\n$$\n\n最后，我们将 $e_k(T)$ 的这个表达式代入混合物比内能 $e(T,\\mathbf{Y})$ 的方程中：\n$$\ne(T,\\mathbf{Y}) = \\sum_{k=1}^{N} \\frac{Y_k}{W_k} R_u \\left( a_{6,k} + (a_{1,k} + a_{7,k} - 1)T + a_{2,k}\\frac{T^2}{2} + a_{3,k}\\frac{T^3}{3} + a_{4,k}\\frac{T^4}{4} + a_{5,k}\\frac{T^5}{5} \\right)\n$$\n通过提出公因子 $R_u$，可以更紧凑地写为：\n$$\ne(T,\\mathbf{Y}) = R_u \\sum_{k=1}^{N} \\frac{Y_k}{W_k} \\left( a_{6,k} + (a_{1,k} + a_{7,k} - 1)T + \\sum_{i=2}^{5} a_{i,k} \\frac{T^i}{i} \\right)\n$$\n这就是混合物比内能的闭合表达式。对于最终答案，我们呈现完全展开的多项式形式。\n\n### 任务2：热释放 $Q$ 的计算\n\n单位质量反应物混合物的热释放定义为 $Q \\equiv -\\Delta h_{\\mathrm{rxn}}(T_{\\mathrm{ref}})$，其中 $\\Delta h_{\\mathrm{rxn}}(T_{\\mathrm{ref}})$ 是在参考温度 $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}$ 下计算的比反应焓。\n\n比反应焓是摩尔反应焓 $\\Delta H_{\\mathrm{rxn}}$ 除以对应于摩尔化学计量的反应物总质量 $M_{\\mathrm{reactants}}$：\n$$\n\\Delta h_{\\mathrm{rxn}} = \\frac{\\Delta H_{\\mathrm{rxn}}}{M_{\\mathrm{reactants}}}\n$$\n\n氢气-空气燃烧的化学计量反应如下所示：\n$$\n2\\,\\mathrm{H_{2}} + 1\\,\\mathrm{O_{2}} + \\left(\\frac{79}{21}\\right)\\,\\mathrm{N_{2}} \\;\\to\\; 2\\,\\mathrm{H_{2}O} + \\left(\\frac{79}{21}\\right)\\,\\mathrm{N_{2}}\n$$\n在参考温度 $T_{\\mathrm{ref}}$ 下的摩尔反应焓是产物的标准摩尔生成热（$h_{f,k}^0$）之和减去反应物的标准摩尔生成热之和，并按其化学计量系数 $\\nu_k$ 加权：\n$$\n\\Delta H_{\\mathrm{rxn}}(T_{\\mathrm{ref}}) = \\sum_{\\text{products}} \\nu_k h_{f,k}^0 - \\sum_{\\text{reactants}} \\nu_k h_{f,k}^0\n$$\n使用在 $T_{\\mathrm{ref}}$ 下给定的生成热：\n$h_{f}^{0}(\\mathrm{H_{2}O(g)}) = -241.826\\ \\mathrm{kJ/mol}$\n$h_{f}^{0}(\\mathrm{H_{2}}) = 0\\ \\mathrm{kJ/mol}$\n$h_{f}^{0}(\\mathrm{O_{2}}) = 0\\ \\mathrm{kJ/mol}$\n$h_{f}^{0}(\\mathrm{N_{2}}) = 0\\ \\mathrm{kJ/mol}$\n\n$\\Delta H_{\\mathrm{rxn}}$ 的计算如下：\n$$\n\\Delta H_{\\mathrm{rxn}} = \\left[ 2 \\cdot h_{f}^0(\\mathrm{H_{2}O}) + \\frac{79}{21} \\cdot h_{f}^0(\\mathrm{N_{2}}) \\right] - \\left[ 2 \\cdot h_{f}^0(\\mathrm{H_{2}}) + 1 \\cdot h_{f}^0(\\mathrm{O_{2}}) + \\frac{79}{21} \\cdot h_{f}^0(\\mathrm{N_{2}}) \\right]\n$$\n由于 $\\mathrm{H_{2}}$、$\\mathrm{O_{2}}$ 和 $\\mathrm{N_{2}}$ 的 $h_{f}^{0}$ 均为零，上式可简化为：\n$$\n\\Delta H_{\\mathrm{rxn}} = 2 \\cdot h_{f}^0(\\mathrm{H_{2}O}) = 2\\ \\mathrm{mol} \\times (-241.826\\ \\mathrm{kJ/mol}) = -483.652\\ \\mathrm{kJ}\n$$\n\n接下来，我们根据反应方程式中的化学计量，计算入射反应物混合物的总质量 $M_{\\mathrm{reactants}}$。我们使用给定的摩尔质量：\n$W_{\\mathrm{H_{2}}} = 2.01588\\ \\mathrm{g/mol}$\n$W_{\\mathrm{O_{2}}} = 31.998\\ \\mathrm{g/mol}$\n$W_{\\mathrm{N_{2}}} = 28.0134\\ \\mathrm{g/mol}$\n\n$$\nM_{\\mathrm{reactants}} = \\left(2 \\cdot W_{\\mathrm{H_{2}}}\\right) + \\left(1 \\cdot W_{\\mathrm{O_{2}}}\\right) + \\left(\\frac{79}{21} \\cdot W_{\\mathrm{N_{2}}}\\right)\n$$\n$$\nM_{\\mathrm{reactants}} = (2 \\times 2.01588\\ \\mathrm{g}) + (1 \\times 31.998\\ \\mathrm{g}) + \\left(\\frac{79}{21} \\times 28.0134\\ \\mathrm{g}\\right)\n$$\n$$\nM_{\\mathrm{reactants}} = 4.03176\\ \\mathrm{g} + 31.998\\ \\mathrm{g} + 105.39592...\\ \\mathrm{g} = 141.42568...\\ \\mathrm{g}\n$$\n以千克为单位，$M_{\\mathrm{reactants}} = 0.14142568...\\ \\mathrm{kg}$。\n\n现在我们可以计算比反应焓：\n$$\n\\Delta h_{\\mathrm{rxn}} = \\frac{-483.652\\ \\mathrm{kJ}}{0.14142568...\\ \\mathrm{kg}} \\approx -3419.863\\ \\mathrm{kJ/kg}\n$$\n\n最后，我们计算热释放 $Q$：\n$$\nQ = -\\Delta h_{\\mathrm{rxn}} = -(-3419.863\\ \\mathrm{kJ/kg}) \\approx 3419.863\\ \\mathrm{kJ/kg}\n$$\n按要求四舍五入到四位有效数字：\n$$\nQ = 3420\\ \\mathrm{kJ/kg}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nR_u \\sum_{k=1}^{N} \\frac{Y_k}{W_k} \\left(a_{6,k} + (a_{1,k} + a_{7,k} - 1)T + a_{2,k} \\frac{T^2}{2} + a_{3,k} \\frac{T^3}{3} + a_{4,k} \\frac{T^4}{4} + a_{5,k} \\frac{T^5}{5} \\right)  3420\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在定义了物理模型之后，我们必须选择一种数值方法来随时间求解控制方程。本练习探讨了数值刚性这一概念，这是反应流模拟中的一个主要挑战，因为化学反应的时间尺度可能比流体流动的时间尺度小几个数量级。通过比较流体动力学的Courant–Friedrichs–Lewy (CFL) 条件与显式化学动力学稳定性极限所施加的时间步长约束，您将具体理解为何高效模拟爆轰必须采用专门的时间积分方案 。",
            "id": "4059682",
            "problem": "考虑一个旋转爆轰发动机环腔的一维周向计算模型，其控制方程为可压缩反应流欧拉方程，其中包含一个通过燃料质量分数 $Y_{F}$ 建模的单一反应进程变量。该系统的双曲部分的特征速度由流速 $u$ 和当地声速 $a$ 决定，$Y_{F}$ 的反应源项通过一个全局单步动力学模型来建模。计算域的周长为 $L = 1.0$ 米，并被均匀离散为 $N = 10000$ 个有限体积网格。在爆轰波波峰处，最大流速和声速的上限分别为 $|u|_{\\max} = 1100$ 米/秒和 $a_{\\max} = 1400$ 米/秒。双曲输运项的时间积分采用显式格式，给定的 Courant–Friedrichs–Lewy (CFL) 数为 $\\mathrm{CFL} = 0.5$。$Y_{F}$ 的反应源项为\n$$\n\\omega_{F} = - \\rho\\, K(T)\\, Y_{F}, \\quad K(T) = A \\exp\\!\\left(-\\frac{E}{R\\,T}\\right),\n$$\n其中 $A = 2.0 \\times 10^{13}$ s$^{-1}$，$E/R = 1.8 \\times 10^{4}$ K，爆轰后温度约为 $T = 2800$ K。假设采用算子分裂法，其中输运和反应分别进行推进，并且 $Y_{F}$ 的反应更新使用显式前向欧拉法。\n\n从双曲波传播和刚性常微分方程显式时间积分的线性稳定性的基本原理出发，计算最大稳定显式时间步长 $\\Delta t_{\\max}$，该步长需同时满足周向上的输运 CFL 约束和由线性化源项所隐含的显式化学反应稳定性约束。最终答案以秒为单位，并四舍五入至三位有效数字。",
            "solution": "该问题陈述具有科学依据、是适定的、客观的，并包含了得出唯一解所需的全部信息。因此，该问题被判定为有效。\n\n核心任务是确定求解反应流欧拉方程的数值模拟（采用算子分裂法）的最大稳定显式时间步长 $\\Delta t_{\\max}$。这需要满足两个独立的稳定性约束：一个源于质量、动量和能量的双曲输运，另一个源于刚性化学源项的显式积分。总的最大稳定时间步长是每个约束所允许的时间步长中的最小值。\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{transport}}, \\Delta t_{\\text{reaction}})\n$$\n\n首先，我们分析由双曲输运项施加的约束，该约束由 Courant–Friedrichs–Lewy (CFL) 条件决定。对于一维双曲系统，显式有限体积格式的 CFL 条件由下式给出：\n$$\n\\Delta t_{\\text{transport}} \\le \\mathrm{CFL} \\frac{\\Delta x}{|\\lambda|_{\\max}}\n$$\n其中 $\\mathrm{CFL}$ 是给定的 CFL 数，$\\Delta x$ 是空间网格尺寸，而 $|\\lambda|_{\\max}$ 是系统中传播最快的特征波的速率大小。\n\n计算域是一个周长为 $L = 1.0$ 米的一维环腔，被离散为 $N = 10000$ 个均匀网格。因此，网格尺寸 $\\Delta x$ 为：\n$$\n\\Delta x = \\frac{L}{N} = \\frac{1.0}{10000} = 1.0 \\times 10^{-4} \\text{ m}\n$$\n一维欧拉方程的特征速度（特征值）为 $u$、$u+a$ 和 $u-a$，其中 $u$ 是当地流速，$a$ 是当地声速。在计算域和所有时间点上的最大特征速度由 $|\\lambda|_{\\max} = |u| + a$ 给出。问题给出了这些量的全局上限：$|u|_{\\max} = 1100$ 米/秒和 $a_{\\max} = 1400$ 米/秒。输运的最严格条件出现在该速度最大的地方。\n$$\n|\\lambda|_{\\text{global max}} = |u|_{\\max} + a_{\\max} = 1100 \\, \\text{m/s} + 1400 \\, \\text{m/s} = 2500 \\, \\text{m/s}\n$$\n使用给定的 CFL 数 $\\mathrm{CFL} = 0.5$，我们可以计算出输运约束所允许的最大时间步长：\n$$\n\\Delta t_{\\text{transport}} = \\mathrm{CFL} \\frac{\\Delta x}{|u|_{\\max} + a_{\\max}} = 0.5 \\times \\frac{1.0 \\times 10^{-4} \\, \\text{m}}{2500 \\, \\text{m/s}} = \\frac{0.5 \\times 10^{-4}}{2.5 \\times 10^3} \\, \\text{s} = 0.2 \\times 10^{-7} \\, \\text{s} = 2.0 \\times 10^{-8} \\, \\text{s}\n$$\n\n接下来，我们分析由化学反应源项的显式积分施加的稳定性约束。问题指明，算子分裂中的反应部分采用显式前向欧拉格式处理。在反应子步中，燃料质量分数 $Y_F$ 的控制方程为：\n$$\n\\frac{d(\\rho Y_F)}{dt} = \\omega_F\n$$\n假设在此子步中密度 $\\rho$ 保持不变（这是算子分裂中的标准做法），我们可以将 $Y_F$ 的常微分方程（ODE）写为：\n$$\n\\rho \\frac{dY_F}{dt} = \\omega_F = -\\rho K(T) Y_F\n$$\n$$\n\\frac{dY_F}{dt} = -K(T) Y_F\n$$\n这是一个形如 $\\frac{dy}{dt} = \\lambda y$ 的线性常微分方程，其特征值为 $\\lambda = -K(T)$。对于显式前向欧拉法，$y_{n+1} = y_n + \\Delta t (\\lambda y_n) = (1 + \\lambda \\Delta t) y_n$，稳定性条件要求放大因子的模不大于1：$|1 + \\lambda \\Delta t| \\le 1$。由于 $\\lambda = -K(T)$ 是一个实数且为负值（因为 $K(T)0$），该不等式变为：\n$$\n-1 \\le 1 - K(T)\\Delta t \\le 1\n$$\n右侧不等式 $1 - K(T)\\Delta t \\le 1$ 意味着 $-K(T)\\Delta t \\le 0$，这对于 $\\Delta t  0$ 总是成立的。左侧不等式则给出了实际的约束条件：\n$$\n-1 \\le 1 - K(T)\\Delta t \\implies K(T)\\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{K(T)}\n$$\n这就定义了反应的最大稳定时间步长 $\\Delta t_{\\text{reaction}}$。在反应速率常数 $K(T)$ 最大处（即温度最高处），该约束最为严格。我们使用给定的爆轰后温度 $T = 2800$ K 和阿伦尼乌斯参数 $A = 2.0 \\times 10^{13}$ s$^{-1}$ 以及 $E/R = 1.8 \\times 10^{4}$ K。\n$$\nK(T) = A \\exp\\left(-\\frac{E}{RT}\\right) = (2.0 \\times 10^{13}) \\exp\\left(-\\frac{1.8 \\times 10^4}{2800}\\right) \\, \\text{s}^{-1}\n$$\n$$\nK(2800) = (2.0 \\times 10^{13}) \\exp\\left(-\\frac{45}{7}\\right) \\, \\text{s}^{-1}\n$$\n因此，反应时间步长的限制为：\n$$\n\\Delta t_{\\text{reaction}} = \\frac{2}{K(2800)} = \\frac{2}{(2.0 \\times 10^{13}) \\exp(-45/7)} \\, \\text{s} = 1.0 \\times 10^{-13} \\exp\\left(\\frac{45}{7}\\right) \\, \\text{s}\n$$\n数值上，$\\frac{45}{7} \\approx 6.42857$，所以 $\\exp(\\frac{45}{7}) \\approx 619.162$。\n$$\n\\Delta t_{\\text{reaction}} \\approx (1.0 \\times 10^{-13}) \\times 619.162 \\, \\text{s} \\approx 6.19162 \\times 10^{-11} \\, \\text{s}\n$$\n\n最后，我们比较这两个时间步长约束，以找到总的最大稳定时间步长：\n$$\n\\Delta t_{\\text{transport}} = 2.0 \\times 10^{-8} \\, \\text{s}\n$$\n$$\n\\Delta t_{\\text{reaction}} \\approx 6.19 \\times 10^{-11} \\, \\text{s}\n$$\n比较这些值，可以明显看出 $\\Delta t_{\\text{reaction}} \\ll \\Delta t_{\\text{transport}}$。化学动力学是极度刚性的，因此它决定了整个格式的稳定性极限。\n$$\n\\Delta t_{\\max} = \\min(2.0 \\times 10^{-8}, 6.19162 \\times 10^{-11}) = 6.19162 \\times 10^{-11} \\, \\text{s}\n$$\n按照要求将结果四舍五入至三位有效数字，我们得到最终答案。\n$$\n\\Delta t_{\\max} \\approx 6.19 \\times 10^{-11} \\, \\text{s}\n$$",
            "answer": "$$\n\\boxed{6.19 \\times 10^{-11}}\n$$"
        },
        {
            "introduction": "只有在量化了其数值精度后，计算结果才具有可信度。本练习介绍了使用理查森外推法进行网格收敛性分析，这是代码验证和解验证的基石。您将学习如何系统地评估模拟结果随网格分辨率的变化，估计数值格式的观测精度阶数，并得出一个高保真度的网格无关解的估计值，这是发表和捍卫计算研究的关键技能 。",
            "id": "4059670",
            "problem": "考虑一个周长为 $L$ 的旋转爆轰发动机环形通道，其中单个周向爆轰波前以平均速度 $D$ 旋转。在旋转爆轰发动机的计算燃烧模拟中，我们关注的物理量是网格收敛的平均爆轰速度 $D$（单位为米/秒）。通过有限体积法或有限差分法求解器对 $D$ 进行数值估计时，其表现出一个渐进的网格间距误差模型。对于足够精细的网格和相容的格式，该模型可以很好地用一个展开式近似：$D(h) = D^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$。其中 $D(h)$ 是在网格间距为 $h$ 的网格上测得的速度，$D^{\\ast}$ 是无穷分辨率极限，$C$ 是一个取决于物理问题和数值格式的常数，而 $p$ 是应用于诊断量 $D$ 的数值方法的理论精度阶。从可压缩反应流的质量、动量和能量基本守恒定律出发，旋转爆轟解可以被建模为围绕环形通道传播的准稳态行波。对这些定律进行相容的空间离散化后，得到的数值解其主阶截断误差与 $h^{p}$ 成比例，当从离散解中测量诊断量 $D(h)$ 时，该误差会传播到 $D(h)$ 中。\n\n你的任务是设计一个程序，针对每个测试用例，运行一系列在三个不同均匀网格分辨率下的模拟，构建在网格间距为 $h_{1}  h_{2}  h_{3}$ 且具有恒定加密比 $r = h_{1}/h_{2} = h_{2}/h_{3}$ 的网格上测得的速度 $D(h_{1})$、$D(h_{2})$ 和 $D(h_{3})$，然后使用 Richardson 外推法来估计观测精度阶 $p_{\\mathrm{obs}}$ 和无穷分辨率速度 $D^{\\ast}_{\\mathrm{ext}}$。推导必须从上述主阶网格误差模型开始，并且不得假设 $D^{\\ast}$ 的任何特定公式；你必须仅从这三个测得的速度值和加密比来推断 $p_{\\mathrm{obs}}$ 和 $D^{\\ast}_{\\mathrm{ext}}$。\n\n为确保科学真实性和自洽执行，你在此程序中运行的模拟应为代理数值实验，用以模拟旋转爆轰发动机中依赖于网格的速度 $D$ 的测量过程。每次代理模拟都会产生一个与主阶误差模型一致的测得速度 $D(h)$。这个代理模型反映了一个事实，即在实践中，从离散的可压缩反应流中测量波速会受到截断误差的影响，而在足够精细的分辨率下，该误差由 $h^{p}$ 项主导。\n\n你必须实现以下测试套件，它涵盖了用于探究算法不同方面的不同情景，其中环形通道周长 $L$ 以米为单位指定，报告的速度 $D$ 必须以 $\\mathrm{m/s}$ 表示：\n\n- 测试用例 1 (理想路径，一阶行为)：$L = 1.000000$ $\\mathrm{m}$，名义爆轰速度标度 $D_{0} = 2000.000000$ $\\mathrm{m/s}$，方法阶参数 $p_{\\mathrm{m}} = 1.000000$，主导误差系数 $\\kappa = 0.800000$，分辨率 $N_{1} = 128$、$N_{2} = 256$、$N_{3} = 512$，加密比 $r = 2.000000$。\n- 测试用例 2 (高阶行为，二阶)：$L = 0.750000$ $\\mathrm{m}$，名义爆轰速度标度 $D_{0} = 2400.000000$ $\\mathrm{m/s}$，方法阶参数 $p_{\\mathrm{m}} = 2.000000$，主导误差系数 $\\kappa = 1.500000$，分辨率 $N_{1} = 100$、$N_{2} = 200$、$N_{3} = 400$，加密比 $r = 2.000000$。\n- 测试用例 3 (非二次加密和非整数阶)：$L = 0.600000$ $\\mathrm{m}$，名义爆轰速度标度 $D_{0} = 2100.000000$ $\\mathrm{m/s}$，方法阶参数 $p_{\\mathrm{m}} = 1.300000$，主导误差系数 $\\kappa = 0.500000$，分辨率 $N_{1} = 180$、$N_{2} = 270$、$N_{3} = 405$，加密比 $r = 1.500000$。\n\n对于每个测试用例，程序必须：\n- 构建网格间距 $h_{i} = L/N_{i}$，其中 $i \\in \\{1,2,3\\}$。\n- 运行代理模拟以获得以 $\\mathrm{m/s}$ 为单位的测得速度 $D(h_{1})$、$D(h_{2})$、$D(h_{3})$。\n- 根据速度三元组 $(D(h_{1}), D(h_{2}), D(h_{3}))$ 和公共加密比 $r$，基于主阶网格误差模型，使用 Richardson 外推法推导观测精度阶 $p_{\\mathrm{obs}}$ 和外推的无穷分辨率速度 $D^{\\ast}_{\\mathrm{ext}}$。\n\n此问题不涉及角度单位。所有报告的速度都必须以 $\\mathrm{m/s}$ 为单位，最终答案必须四舍五入到 $6$ 位小数。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应测试用例的双元素列表 $[p_{\\mathrm{obs}}, D^{\\ast}_{\\mathrm{ext}}]$。例如，最终打印的行必须具有 $[[p_{1},D_{1}],[p_{2},D_{2}],[p_{3},D_{3}]]$ 的形式，其中每个 $p_{i}$ 和 $D_{i}$ 都按指定单位四舍五入到 $6$ 位小数。",
            "solution": "该问题要求设计一个程序，通过一系列三次代理数值模拟来估计观测精度阶 $p_{\\mathrm{obs}}$ 和网格-外推爆轰速度 $D^{\\ast}_{\\mathrm{ext}}$。此分析的基础是数值测量的爆轰速度 $D(h)$ 作为网格间距 $h$ 函数的渐进误差模型。\n\n分析从所提供的主阶误差模型开始，该模型描述了数值解与真实的无穷分辨率解 $D^{\\ast}$ 之间的偏差：\n$$\nD(h) = D^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})\n$$\n这里，$C$ 是一个与数值格式和解的高阶导数相关的常数，$p$ 是方法的理论精度阶。对于足够小的 $h$，高阶项 $\\mathcal{O}(h^{p+1})$ 可以被忽略，从而得到近似式：\n$$\nD(h) \\approx D^{\\ast} + C h^{p}\n$$\n我们获得了三次模拟的数据，其网格间距分别为 $h_1$、$h_2$ 和 $h_3$，它们通过一个恒定的加密比 $r  1$ 相关联，使得 $h_1  h_2  h_3$ 且 $r = h_1/h_2 = h_2/h_3$。设相应的测量速度为 $D_1 = D(h_1)$、$D_2 = D(h_2)$ 和 $D_3 = D(h_3)$。这给了我们一个包含三个未知数（$D^{\\ast}$、$C$ 和 $p$）的方程组：\n\\begin{align}\nD_1 \\approx D^{\\ast} + C h_1^p \\quad (1) \\\\\nD_2 \\approx D^{\\ast} + C h_2^p \\quad (2) \\\\\nD_3 \\approx D^{\\ast} + C h_3^p \\quad (3)\n\\end{align}\n我们的目标是解此方程组，求出 $p$（我们记为 $p_{\\mathrm{obs}}$）和 $D^{\\ast}$（我们记为 $D^{\\ast}_{\\mathrm{ext}}$）。\n\n首先，我们通过将方程两两相减来消去 $D^{\\ast}$：\n\\begin{align}\nD_1 - D_2 \\approx C(h_1^p - h_2^p) \\quad (4) \\\\\nD_2 - D_3 \\approx C(h_2^p - h_3^p) \\quad (5)\n\\end{align}\n为了消去常数 $C$，我们取这两个差值的比率：\n$$\n\\frac{D_1 - D_2}{D_2 - D_3} \\approx \\frac{h_1^p - h_2^p}{h_2^p - h_3^p}\n$$\n利用网格间距之间的关系 $h_1 = r h_2$ 和 $h_2 = r h_3$，右侧可以简化为：\n$$\n\\frac{h_1^p - h_2^p}{h_2^p - h_3^p} = \\frac{(r h_2)^p - h_2^p}{(r h_3)^p - h_3^p} = \\frac{h_2^p(r^p - 1)}{h_3^p(r^p - 1)} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p\n$$\n这就建立了一个确定观测精度阶 $p_{\\mathrm{obs}}$ 的直接关系：\n$$\nr^{p_{\\mathrm{obs}}} = \\frac{D_1 - D_2}{D_2 - D_3}\n$$\n对两边取自然对数求解 $p_{\\mathrm{obs}}$，得到：\n$$\np_{\\mathrm{obs}} = \\frac{\\ln\\left(\\frac{D_1 - D_2}{D_2 - D_3}\\right)}{\\ln(r)}\n$$\n确定了 $p_{\\mathrm{obs}}$ 后，我们现在可以找到外推值 $D^{\\ast}_{\\mathrm{ext}}$。这是 Richardson 外推法中的标准步骤。让我们使用 $h_1 = r h_2$ 重写方程 $(4)$：\n$$\nD_1 - D_2 \\approx C((rh_2)^p - h_2^p) = C h_2^p (r^p - 1)\n$$\n由此，我们可以表达出中等网格分辨率下的误差项 $C h_2^p$：\n$$\nE_2 = C h_2^p \\approx \\frac{D_1 - D_2}{r^p - 1}\n$$\n其中 $p$ 是我们现在计算出的 $p_{\\mathrm{obs}}$。通过从相应的测量值 $D_2$ 中减去这个估计误差，即可获得外推值 $D^{\\ast}_{\\mathrm{ext}}$：\n$$\nD^{\\ast}_{\\mathrm{ext}} = D_2 - E_2 \\approx D_2 - \\frac{D_2 - D_1}{r^{p_{\\mathrm{obs}}} - 1}\n$$\n注意分子与上一个方程相比发生了符号变化。一个便捷的代数重排给出了外推值的最终形式：\n$$\nD^{\\ast}_{\\mathrm{ext}} \\approx \\frac{D_2 (r^{p_{\\mathrm{obs}}} - 1) - (D_2 - D_1)}{r^{p_{\\mathrm{obs}}} - 1} = \\frac{r^{p_{\\mathrm{obs}}} D_2 - D_1}{r^{p_{\\mathrm{obs}}} - 1}\n$$\n在实现时，数值上最好先计算差值比，我们称之为 $R_{diff} = (D_1 - D_2) / (D_2 - D_3)$，它等于 $r^{p_{\\mathrm{obs}}}$。然后公式变为：\n\\begin{align}\np_{\\mathrm{obs}} = \\frac{\\ln(R_{diff})}{\\ln(r)} \\\\\nD^{\\ast}_{\\mathrm{ext}} = \\frac{R_{diff} D_2 - D_1}{R_{diff} - 1}\n\\end{align}\n这种方法避免了重新计算 $r^{p_{\\mathrm{obs}}}$ 的幂，并且在数值上是稳健的。\n\n程序将为每个测试用例实现这些步骤。对于每个用例，它将首先使用提供的参数和误差模型 $D(h_i) = D_0 + \\kappa h_i^{p_m}$（其中 $h_i = L/N_i$）生成 $D_1$、$D_2$ 和 $D_3$ 的代理数据。然后，它将应用推导出的公式来计算 $p_{\\mathrm{obs}}$ 和 $D^{\\ast}_{\\mathrm{ext}}$。如初步分析所示，这个过程应该能精确地恢复输入参数 $p_m$ 和 $D_0$，这反映了代理数据对主阶误差模型的完美遵循。最终结果按要求四舍五入到 $6$ 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the observed order of accuracy and extrapolated value for a series\n    of surrogate rotating detonation engine simulations using Richardson extrapolation.\n    \"\"\"\n\n    test_cases = [\n        {\n            'L': 1.000000,\n            'D0': 2000.000000,\n            'p_m': 1.000000,\n            'kappa': 0.800000,\n            'N': [128, 256, 512],\n            'r': 2.000000\n        },\n        {\n            'L': 0.750000,\n            'D0': 2400.000000,\n            'p_m': 2.000000,\n            'kappa': 1.500000,\n            'N': [100, 200, 400],\n            'r': 2.000000\n        },\n        {\n            'L': 0.600000,\n            'D0': 2100.000000,\n            'p_m': 1.300000,\n            'kappa': 0.500000,\n            'N': [180, 270, 405],\n            'r': 1.500000\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        L = case['L']\n        D0 = case['D0']\n        p_m = case['p_m']\n        kappa = case['kappa']\n        N1, N2, N3 = case['N']\n        r = case['r']\n\n        # Step 1: Construct grid spacings\n        h1 = L / N1\n        h2 = L / N2\n        h3 = L / N3\n\n        # Step 2: Run surrogate simulations to get measured speeds\n        # The model is D(h) = D* + C*h^p.\n        # We use D0 for D*, p_m for p, and kappa for C.\n        D1 = D0 + kappa * (h1 ** p_m)\n        D2 = D0 + kappa * (h2 ** p_m)\n        D3 = D0 + kappa * (h3 ** p_m)\n        \n        # Step 3: Derive p_obs and D*_ext using Richardson extrapolation\n        \n        # Calculate the ratio of differences in measured speeds.\n        # This term is equal to r^p_obs\n        # This will be very close to r**p_m due to the surrogate model used.\n        # To avoid potential division by zero if D2 == D3 (perfectly converged),\n        # handle this case, though it's unlikely with the given problem data.\n        diff_23 = D2 - D3\n        if abs(diff_23)  1e-15:\n            # If the solution is effectively converged, the order is indeterminate \n            # and the extrapolated value is simply the finest grid result.\n            # This path is not expected for the given test cases.\n            p_obs = np.inf\n            D_ext = D3\n        else:\n            diff_12 = D1 - D2\n            ratio_of_diffs = diff_12 / diff_23\n\n            # Calculate observed order of accuracy, p_obs\n            # p_obs = log(ratio_of_diffs) / log(r)\n            p_obs = np.log(ratio_of_diffs) / np.log(r)\n\n            # Calculate extrapolated infinite-resolution speed, D*_ext\n            # D*_ext = (r^p * D2 - D1) / (r^p - 1)\n            # which is (ratio_of_diffs * D2 - D1) / (ratio_of_diffs - 1)\n            D_ext = (ratio_of_diffs * D2 - D1) / (ratio_of_diffs - 1)\n\n        # Round results to 6 decimal places as required\n        p_obs_rounded = round(p_obs, 6)\n        D_ext_rounded = round(D_ext, 6)\n        \n        results.append([p_obs_rounded, D_ext_rounded])\n\n    # Format the final output string exactly as specified.\n    # Ex: [[p1,D1],[p2,D2],[p3,D3]]\n    formatted_results = [f\"[{p:.6f},{D:.6f}]\" for p, D in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}